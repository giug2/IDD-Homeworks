<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1806.07243] Learning Conditioned Graph Structures for Interpretable Visual Question Answering</title><meta property="og:description" content="Visual Question answering is a challenging problem requiring a combination of concepts from Computer Vision and Natural Language Processing. Most existing approaches use a two streams strategy, computing image and ques…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Learning Conditioned Graph Structures for Interpretable Visual Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Learning Conditioned Graph Structures for Interpretable Visual Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1806.07243">

<!--Generated on Sun Mar  3 03:47:27 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Learning Conditioned Graph Structures for Interpretable Visual Question Answering</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Will Norcliffe-Brown 
<br class="ltx_break">AimBrain Ltd.
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter">will.norcliffe@aimbrain.com</span> 
<br class="ltx_break"><span id="id2.2.id2" class="ltx_ERROR undefined">\And</span>Efstathios Vafeias 
<br class="ltx_break">AimBrain Ltd. 
<br class="ltx_break"><span id="id3.3.id3" class="ltx_text ltx_font_typewriter">stathis@aimbrain.com</span> 
<br class="ltx_break"><span id="id4.4.id4" class="ltx_ERROR undefined">\And</span>Sarah Parisot 
<br class="ltx_break">AimBrain Ltd. 
<br class="ltx_break"><span id="id5.5.id5" class="ltx_text ltx_font_typewriter">sarah@aimbrain.com</span> 
<br class="ltx_break">
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id6.id1" class="ltx_p">Visual Question answering is a challenging problem requiring a combination of concepts from Computer Vision and Natural Language Processing. Most existing approaches use a two streams strategy, computing image and question features that are consequently merged using a variety of techniques. Nonetheless, very few rely on higher level image representations, which can capture semantic and spatial relationships. In this paper, we propose a novel graph-based approach for Visual Question Answering. Our method combines a graph learner module, which learns a question specific graph representation of the input image, with the recent concept of graph convolutions, aiming to learn image representations that capture question specific interactions. We test our approach on the VQA v2 dataset using a simple baseline architecture enhanced by the proposed graph learner module. We obtain promising results with 66.18% accuracy and demonstrate the interpretability of the proposed method. Code can be found at <a target="_blank" href="https://github.com/aimbrain/vqa-project" title="" class="ltx_ref ltx_href">github.com/aimbrain/vqa-project</a>.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">Visual Question Answering (VQA) is an emerging topic that has received an increasing amount of attention in recent years <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. Its attractiveness lies in the fact that it combines two fields that are typically approached individually (Computer Vision and Natural Language Processing (NLP)). This allows researchers to look at both problems from a new perspective. Given an image and a question, the objective of VQA is to answer the question based on the information provided by the image.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">Understanding both the question and image, as well as modelling their interactions requires us to combine Computer Vision and NLP techniques. The problem is generally framed in terms of classification, such that the network learns to produce answers from a finite set of classes which facilitates training and evaluation. Most VQA methods follow a two-stream strategy, learning separate image and question embeddings from deep Convolutional Neural Networks (CNNs) and well known word embedding strategies respectively. Techniques to combine the two streams range from element-wise product to bilinear pooling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> as well as attention based approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">Recent computer vision works have been exploring higher level representation of images, notably using object detectors and graph-based structures for better semantic and spatial image understanding <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. Representing images as graphs allows one to explicitly model interactions, so as to seamlessly transfer information between graph items (e.g. objects in the image) through advanced graph processing techniques such as the emerging paradigm of graph CNNs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. Such graph based techniques have been the focus of recent VQA works, for abstract image understanding <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> or object counting <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, reaching state of the art performance. Nonetheless, an important drawback of the proposed techniques is the fact that the input graph structures are heavily engineered, image specific rather than question specific, and not easily transferable from abstract scenes to real images. Furthermore, very few approaches provide means to interpret the model’s behaviour, an essential aspect that is often lacking in deep learning models.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/1806.07243/assets/kid.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="538" height="359" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Epitome of our graph learning module’s ability to condition the bounding box connections based on the question. Two graph structures are learned from the same image but tailored to answer different questions. The thickness and opacity of graph nodes (bounding boxes) and edges (white lines) are determined by node degree and edge weights, showing the main objects and relationships of interest.</figcaption>
</figure>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p"><span id="S1.p4.1.1" class="ltx_text ltx_font_bold">Contributions.</span>
In this paper, we propose a novel, interpretable, graph-based approach for visual question answering. Most recent VQA approaches focus on creating new attention architectures of increasing complexity, but fail to model the semantic connections between objects in the scene. Here, we propose to address this issue by introducing a prior in the form of a scene structure, defined as a graph which is learned from observations according to the context of question.
Bounding box object detections are defined as graph nodes, while graph edges conditioned on the question are learned via an attention based module. This not only identifies the most relevant objects in the image associated to the question, but the most important interactions (e.g. relative position, similarities) without any handcrafted description of the structure of the graph. Learning a graph structure allows to learn question specific object representations that are influenced by relevant neighbours using graph convolutions. Our intuition is that learning a graph structure not only provides strong predictive power for the VQA task, but also interpretability of the model’s behaviour by inspecting the most important graph nodes and edges.
Experiments on the VQA v2 dataset confirm our hypothesis. Combined with a relatively simple baseline, our graph learner module achieves 66.18% accuracy on the test set and provides interpretable results via visualisation of the learned graph representations.
</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Graph Convolutional Neural Networks</h3>

<div id="S2.SS1.p1" class="ltx_para ltx_noindent">
<p id="S2.SS1.p1.1" class="ltx_p">Graph CNNs (GCNs) are a relatively new concept, aiming to generalise Convolutional Neural Networks (CNNs) to graph structured data. CNNs intrinsically exploit the regular grid-like structure of data defined on the euclidean domain (e.g. images). Extending this concept to non-regularly structured data (e.g. meshes, or social/brain networks) is non trivial. We distinguish graph CNNs defined in the spectral <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> and spatial <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> domains.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para ltx_noindent">
<p id="S2.SS1.p2.1" class="ltx_p">Spectral GCNs exploit concepts from graph signal processing <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, using analogies with the Euclidean domain to define a graph Fourier transform, allowing to perform convolutions in the spectral domain as multiplications. Spectral GCNs are the most principled and out of the box approach, however are limited by the requirement that the graph structure is the same for all training samples, as the trained filters are defined on the graph Laplacian’s basis.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para ltx_noindent">
<p id="S2.SS1.p3.1" class="ltx_p">Spatial GCNs tend to be more engineered as they require the definition of a node ordering and a patch operator. Several approaches have been defined specifically for regular meshes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. Monti et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> recently provided a general spatial GCN formulation, learning a patch operator as a mixture of Gaussians. Recently, Graph Attention Networks were proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, modelling the convolution operator as an attention operation on node neighbours, where the attention weights can be interpreted as graph edges. Similar to our work, both of these methods compute a type of attention to learn a graph structure. However, while these methods which learn a fixed graph structure, we aim to learn a dynamic graph that is conditioned on the context of a query. Accordingly, our approach extends the notion of an edge to be adaptive to the context.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Visual Question Answering</h3>

<div id="S2.SS2.p1" class="ltx_para ltx_noindent">
<p id="S2.SS2.p1.1" class="ltx_p">Explicit modelling of object interactions through graph representations has recently received growing interest. A graph based approach was notably proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, combining graph representations of questions and abstract images with graph neural networks. This approach beat the state of the art by a large margin, demonstrating the potential of graph based methods for VQA. This approach is however not easily applicable to natural images where the scene graph representation is not known a priori.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para ltx_noindent">
<p id="S2.SS2.p2.1" class="ltx_p">The decision to use object proposals as image features resulted in major improvements in VQA performance. This idea was first introduced in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, outperforming the state of the art with a relatively simple model. Such image representations have since been exploited to model interactions between objects through implicit and explicit graph structures <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, with a focus on counting. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> compute a graph based on the outer product of the attention weights of proposed features. The computed graph is altered with explicitly engineered features solely to improve their baseline model’s ability to count. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> propose an iterative approach relying on objects similarities to improve the models’ counting abilities and interpretability, which was only evaluated on counting questions. The main aim of both approaches is to eliminate duplicate object detections.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methods</h2>

<figure id="S3.F2" class="ltx_figure"><img src="/html/1806.07243/assets/model.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="152" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Overview of the proposed model architecture. We model the VQA problem as a classification problem, where each answer from the training set is a class. The core of our method is the graph learner, which takes as input a question encoding, and a set of object bounding boxes with corresponding image features. The graph learner module learns a graph representation of the image that is conditioned on the question, and models the relevant interactions between objects in the scene. We use this graph representation to learn image features that are influenced by their relevant neighbours using graph convolutions, followed by max-pooling, element-wise product and fully connected layers. </figcaption>
</figure>
<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.1" class="ltx_p">An overview of the method is shown in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3 Methods ‣ Learning Conditioned Graph Structures for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
We develop a deep neural network that combines spatial, image and textual features in a novel manner in order to answer a question about an image. Our model first computes a question representation using word embeddings and a Recurrent Neural Network (RNN), and a set of object descriptors comprising bounding box coordinates and image features vectors. Our graph learning module then learns an adjacency matrix of the image objects that is conditioned on a given question. This adjacency matrix enables the next layers - the spatial graph convolutions - to focus not only on the objects but also on the object relationships that are the most relevant to the question. Our convolved graph features are max-pooled, and combined with the question embedding using a simple element-wise product to predict a class pertaining to the answer of the given question.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Computing model inputs</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.2" class="ltx_p">The first stage of our model is to compute embeddings for both the input image and question. We convert a given image into a set of <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">K</annotation></semantics></math> visual features using an object detector. Object detections are essential for the subsequent step of our model, as each bounding box will constitute a node in the question specific graph representations we are learning. An embedding is produced for each proposed bounding box, which is the mean of the corresponding area of the convolutional feature map. Using such object features has been observed to yield a better performance in VQA tasks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, as this allows the model to focus on object-level features rather than a pure CNN which produces a grid of features. For each question, we use pre-trained word embeddings as suggested in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> to convert the question into a variable length sequence of embeddings. Then we use a dynamic RNN with a GRU cell <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, to encode the sequence of word embeddings as a single question embedding <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{q}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">𝐪</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝐪</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\mathbf{q}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Graph learner</h3>

<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.p1.1" class="ltx_p">In this section, we introduce the key element of our model and our main contribution: the graph learner module.
This novel module produces a graphical representation of an image conditioned on a question. It is general, easy to implement and, as we highlight in Section <a href="#S4.SS3" title="4.3 Results ‣ 4 Evaluation ‣ Learning Conditioned Graph Structures for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>, learns complex relationships between features that are interpretable and query dependent. The learned graph structure drives the spatial graph convolutions by defining node neighbourhoods, which in contrast to previous models such as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, allows unary and pairwise attention to be learned naturally as the adjacency matrix contains self loops.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.p2.13" class="ltx_p">We seek to construct an undirected graph <math id="S3.SS2.p2.1.m1.3" class="ltx_Math" alttext="\mathcal{G}=\{\mathcal{V},\mathcal{E},\mathbf{A}\}" display="inline"><semantics id="S3.SS2.p2.1.m1.3a"><mrow id="S3.SS2.p2.1.m1.3.4" xref="S3.SS2.p2.1.m1.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.1.m1.3.4.2" xref="S3.SS2.p2.1.m1.3.4.2.cmml">𝒢</mi><mo id="S3.SS2.p2.1.m1.3.4.1" xref="S3.SS2.p2.1.m1.3.4.1.cmml">=</mo><mrow id="S3.SS2.p2.1.m1.3.4.3.2" xref="S3.SS2.p2.1.m1.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS2.p2.1.m1.3.4.3.2.1" xref="S3.SS2.p2.1.m1.3.4.3.1.cmml">{</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">𝒱</mi><mo id="S3.SS2.p2.1.m1.3.4.3.2.2" xref="S3.SS2.p2.1.m1.3.4.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.1.m1.2.2" xref="S3.SS2.p2.1.m1.2.2.cmml">ℰ</mi><mo id="S3.SS2.p2.1.m1.3.4.3.2.3" xref="S3.SS2.p2.1.m1.3.4.3.1.cmml">,</mo><mi id="S3.SS2.p2.1.m1.3.3" xref="S3.SS2.p2.1.m1.3.3.cmml">𝐀</mi><mo stretchy="false" id="S3.SS2.p2.1.m1.3.4.3.2.4" xref="S3.SS2.p2.1.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.3b"><apply id="S3.SS2.p2.1.m1.3.4.cmml" xref="S3.SS2.p2.1.m1.3.4"><eq id="S3.SS2.p2.1.m1.3.4.1.cmml" xref="S3.SS2.p2.1.m1.3.4.1"></eq><ci id="S3.SS2.p2.1.m1.3.4.2.cmml" xref="S3.SS2.p2.1.m1.3.4.2">𝒢</ci><set id="S3.SS2.p2.1.m1.3.4.3.1.cmml" xref="S3.SS2.p2.1.m1.3.4.3.2"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝒱</ci><ci id="S3.SS2.p2.1.m1.2.2.cmml" xref="S3.SS2.p2.1.m1.2.2">ℰ</ci><ci id="S3.SS2.p2.1.m1.3.3.cmml" xref="S3.SS2.p2.1.m1.3.3">𝐀</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.3c">\mathcal{G}=\{\mathcal{V},\mathcal{E},\mathbf{A}\}</annotation></semantics></math>, where <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\mathcal{E}</annotation></semantics></math> is the set of graph edges to learn and <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="\mathbf{A}\in\mathbb{R}^{N\times N}" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><mrow id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">𝐀</mi><mo id="S3.SS2.p2.3.m3.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml"><mi id="S3.SS2.p2.3.m3.1.1.3.2" xref="S3.SS2.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p2.3.m3.1.1.3.3" xref="S3.SS2.p2.3.m3.1.1.3.3.cmml"><mi id="S3.SS2.p2.3.m3.1.1.3.3.2" xref="S3.SS2.p2.3.m3.1.1.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.3.m3.1.1.3.3.1" xref="S3.SS2.p2.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p2.3.m3.1.1.3.3.3" xref="S3.SS2.p2.3.m3.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><in id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1"></in><ci id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">𝐀</ci><apply id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.3.1.cmml" xref="S3.SS2.p2.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.3.2.cmml" xref="S3.SS2.p2.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS2.p2.3.m3.1.1.3.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3"><times id="S3.SS2.p2.3.m3.1.1.3.3.1.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3.1"></times><ci id="S3.SS2.p2.3.m3.1.1.3.3.2.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3.2">𝑁</ci><ci id="S3.SS2.p2.3.m3.1.1.3.3.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">\mathbf{A}\in\mathbb{R}^{N\times N}</annotation></semantics></math> the corresponding adjacency matrix. Each vertex <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="v\in\mathcal{V}" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><mrow id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2.cmml">v</mi><mo id="S3.SS2.p2.4.m4.1.1.1" xref="S3.SS2.p2.4.m4.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml">𝒱</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><in id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1"></in><ci id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2">𝑣</ci><ci id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3">𝒱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">v\in\mathcal{V}</annotation></semantics></math> with <math id="S3.SS2.p2.5.m5.1" class="ltx_Math" alttext="|\mathcal{V}|=N" display="inline"><semantics id="S3.SS2.p2.5.m5.1a"><mrow id="S3.SS2.p2.5.m5.1.2" xref="S3.SS2.p2.5.m5.1.2.cmml"><mrow id="S3.SS2.p2.5.m5.1.2.2.2" xref="S3.SS2.p2.5.m5.1.2.2.1.cmml"><mo stretchy="false" id="S3.SS2.p2.5.m5.1.2.2.2.1" xref="S3.SS2.p2.5.m5.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml">𝒱</mi><mo stretchy="false" id="S3.SS2.p2.5.m5.1.2.2.2.2" xref="S3.SS2.p2.5.m5.1.2.2.1.1.cmml">|</mo></mrow><mo id="S3.SS2.p2.5.m5.1.2.1" xref="S3.SS2.p2.5.m5.1.2.1.cmml">=</mo><mi id="S3.SS2.p2.5.m5.1.2.3" xref="S3.SS2.p2.5.m5.1.2.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><apply id="S3.SS2.p2.5.m5.1.2.cmml" xref="S3.SS2.p2.5.m5.1.2"><eq id="S3.SS2.p2.5.m5.1.2.1.cmml" xref="S3.SS2.p2.5.m5.1.2.1"></eq><apply id="S3.SS2.p2.5.m5.1.2.2.1.cmml" xref="S3.SS2.p2.5.m5.1.2.2.2"><abs id="S3.SS2.p2.5.m5.1.2.2.1.1.cmml" xref="S3.SS2.p2.5.m5.1.2.2.2.1"></abs><ci id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">𝒱</ci></apply><ci id="S3.SS2.p2.5.m5.1.2.3.cmml" xref="S3.SS2.p2.5.m5.1.2.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">|\mathcal{V}|=N</annotation></semantics></math> corresponds to a detected image object (bounding box coordinates and associated feature vector <math id="S3.SS2.p2.6.m6.1" class="ltx_Math" alttext="\mathbf{v}_{n}\in\mathbb{R}^{d}" display="inline"><semantics id="S3.SS2.p2.6.m6.1a"><mrow id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml"><msub id="S3.SS2.p2.6.m6.1.1.2" xref="S3.SS2.p2.6.m6.1.1.2.cmml"><mi id="S3.SS2.p2.6.m6.1.1.2.2" xref="S3.SS2.p2.6.m6.1.1.2.2.cmml">𝐯</mi><mi id="S3.SS2.p2.6.m6.1.1.2.3" xref="S3.SS2.p2.6.m6.1.1.2.3.cmml">n</mi></msub><mo id="S3.SS2.p2.6.m6.1.1.1" xref="S3.SS2.p2.6.m6.1.1.1.cmml">∈</mo><msup id="S3.SS2.p2.6.m6.1.1.3" xref="S3.SS2.p2.6.m6.1.1.3.cmml"><mi id="S3.SS2.p2.6.m6.1.1.3.2" xref="S3.SS2.p2.6.m6.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.p2.6.m6.1.1.3.3" xref="S3.SS2.p2.6.m6.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><apply id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1"><in id="S3.SS2.p2.6.m6.1.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1.1"></in><apply id="S3.SS2.p2.6.m6.1.1.2.cmml" xref="S3.SS2.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.1.1.2.1.cmml" xref="S3.SS2.p2.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.6.m6.1.1.2.2.cmml" xref="S3.SS2.p2.6.m6.1.1.2.2">𝐯</ci><ci id="S3.SS2.p2.6.m6.1.1.2.3.cmml" xref="S3.SS2.p2.6.m6.1.1.2.3">𝑛</ci></apply><apply id="S3.SS2.p2.6.m6.1.1.3.cmml" xref="S3.SS2.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.1.1.3.1.cmml" xref="S3.SS2.p2.6.m6.1.1.3">superscript</csymbol><ci id="S3.SS2.p2.6.m6.1.1.3.2.cmml" xref="S3.SS2.p2.6.m6.1.1.3.2">ℝ</ci><ci id="S3.SS2.p2.6.m6.1.1.3.3.cmml" xref="S3.SS2.p2.6.m6.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">\mathbf{v}_{n}\in\mathbb{R}^{d}</annotation></semantics></math>). We aim to learn the adjacency matrix <math id="S3.SS2.p2.7.m7.1" class="ltx_Math" alttext="\mathbf{A}" display="inline"><semantics id="S3.SS2.p2.7.m7.1a"><mi id="S3.SS2.p2.7.m7.1.1" xref="S3.SS2.p2.7.m7.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.1b"><ci id="S3.SS2.p2.7.m7.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.1c">\mathbf{A}</annotation></semantics></math> so that each edge <math id="S3.SS2.p2.8.m8.5" class="ltx_Math" alttext="(i,j,A_{i,j})\in\mathcal{E}" display="inline"><semantics id="S3.SS2.p2.8.m8.5a"><mrow id="S3.SS2.p2.8.m8.5.5" xref="S3.SS2.p2.8.m8.5.5.cmml"><mrow id="S3.SS2.p2.8.m8.5.5.1.1" xref="S3.SS2.p2.8.m8.5.5.1.2.cmml"><mo stretchy="false" id="S3.SS2.p2.8.m8.5.5.1.1.2" xref="S3.SS2.p2.8.m8.5.5.1.2.cmml">(</mo><mi id="S3.SS2.p2.8.m8.3.3" xref="S3.SS2.p2.8.m8.3.3.cmml">i</mi><mo id="S3.SS2.p2.8.m8.5.5.1.1.3" xref="S3.SS2.p2.8.m8.5.5.1.2.cmml">,</mo><mi id="S3.SS2.p2.8.m8.4.4" xref="S3.SS2.p2.8.m8.4.4.cmml">j</mi><mo id="S3.SS2.p2.8.m8.5.5.1.1.4" xref="S3.SS2.p2.8.m8.5.5.1.2.cmml">,</mo><msub id="S3.SS2.p2.8.m8.5.5.1.1.1" xref="S3.SS2.p2.8.m8.5.5.1.1.1.cmml"><mi id="S3.SS2.p2.8.m8.5.5.1.1.1.2" xref="S3.SS2.p2.8.m8.5.5.1.1.1.2.cmml">A</mi><mrow id="S3.SS2.p2.8.m8.2.2.2.4" xref="S3.SS2.p2.8.m8.2.2.2.3.cmml"><mi id="S3.SS2.p2.8.m8.1.1.1.1" xref="S3.SS2.p2.8.m8.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p2.8.m8.2.2.2.4.1" xref="S3.SS2.p2.8.m8.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p2.8.m8.2.2.2.2" xref="S3.SS2.p2.8.m8.2.2.2.2.cmml">j</mi></mrow></msub><mo stretchy="false" id="S3.SS2.p2.8.m8.5.5.1.1.5" xref="S3.SS2.p2.8.m8.5.5.1.2.cmml">)</mo></mrow><mo id="S3.SS2.p2.8.m8.5.5.2" xref="S3.SS2.p2.8.m8.5.5.2.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.8.m8.5.5.3" xref="S3.SS2.p2.8.m8.5.5.3.cmml">ℰ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m8.5b"><apply id="S3.SS2.p2.8.m8.5.5.cmml" xref="S3.SS2.p2.8.m8.5.5"><in id="S3.SS2.p2.8.m8.5.5.2.cmml" xref="S3.SS2.p2.8.m8.5.5.2"></in><vector id="S3.SS2.p2.8.m8.5.5.1.2.cmml" xref="S3.SS2.p2.8.m8.5.5.1.1"><ci id="S3.SS2.p2.8.m8.3.3.cmml" xref="S3.SS2.p2.8.m8.3.3">𝑖</ci><ci id="S3.SS2.p2.8.m8.4.4.cmml" xref="S3.SS2.p2.8.m8.4.4">𝑗</ci><apply id="S3.SS2.p2.8.m8.5.5.1.1.1.cmml" xref="S3.SS2.p2.8.m8.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.5.5.1.1.1.1.cmml" xref="S3.SS2.p2.8.m8.5.5.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.8.m8.5.5.1.1.1.2.cmml" xref="S3.SS2.p2.8.m8.5.5.1.1.1.2">𝐴</ci><list id="S3.SS2.p2.8.m8.2.2.2.3.cmml" xref="S3.SS2.p2.8.m8.2.2.2.4"><ci id="S3.SS2.p2.8.m8.1.1.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1.1.1">𝑖</ci><ci id="S3.SS2.p2.8.m8.2.2.2.2.cmml" xref="S3.SS2.p2.8.m8.2.2.2.2">𝑗</ci></list></apply></vector><ci id="S3.SS2.p2.8.m8.5.5.3.cmml" xref="S3.SS2.p2.8.m8.5.5.3">ℰ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m8.5c">(i,j,A_{i,j})\in\mathcal{E}</annotation></semantics></math> is conditioned on the question encoding <math id="S3.SS2.p2.9.m9.1" class="ltx_Math" alttext="\mathbf{q}" display="inline"><semantics id="S3.SS2.p2.9.m9.1a"><mi id="S3.SS2.p2.9.m9.1.1" xref="S3.SS2.p2.9.m9.1.1.cmml">𝐪</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m9.1b"><ci id="S3.SS2.p2.9.m9.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1">𝐪</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m9.1c">\mathbf{q}</annotation></semantics></math>. Intuitively, we need to model the similarities between feature vectors as well as their relevance to the given question. This is done by first concatenating the question embedding <math id="S3.SS2.p2.10.m10.1" class="ltx_Math" alttext="\mathbf{q}" display="inline"><semantics id="S3.SS2.p2.10.m10.1a"><mi id="S3.SS2.p2.10.m10.1.1" xref="S3.SS2.p2.10.m10.1.1.cmml">𝐪</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.m10.1b"><ci id="S3.SS2.p2.10.m10.1.1.cmml" xref="S3.SS2.p2.10.m10.1.1">𝐪</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m10.1c">\mathbf{q}</annotation></semantics></math> onto each of the <math id="S3.SS2.p2.11.m11.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS2.p2.11.m11.1a"><mi id="S3.SS2.p2.11.m11.1.1" xref="S3.SS2.p2.11.m11.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.11.m11.1b"><ci id="S3.SS2.p2.11.m11.1.1.cmml" xref="S3.SS2.p2.11.m11.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.11.m11.1c">N</annotation></semantics></math> visual features <math id="S3.SS2.p2.12.m12.1" class="ltx_Math" alttext="\mathbf{v}_{n}" display="inline"><semantics id="S3.SS2.p2.12.m12.1a"><msub id="S3.SS2.p2.12.m12.1.1" xref="S3.SS2.p2.12.m12.1.1.cmml"><mi id="S3.SS2.p2.12.m12.1.1.2" xref="S3.SS2.p2.12.m12.1.1.2.cmml">𝐯</mi><mi id="S3.SS2.p2.12.m12.1.1.3" xref="S3.SS2.p2.12.m12.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.12.m12.1b"><apply id="S3.SS2.p2.12.m12.1.1.cmml" xref="S3.SS2.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.12.m12.1.1.1.cmml" xref="S3.SS2.p2.12.m12.1.1">subscript</csymbol><ci id="S3.SS2.p2.12.m12.1.1.2.cmml" xref="S3.SS2.p2.12.m12.1.1.2">𝐯</ci><ci id="S3.SS2.p2.12.m12.1.1.3.cmml" xref="S3.SS2.p2.12.m12.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.12.m12.1c">\mathbf{v}_{n}</annotation></semantics></math>, which we write as <math id="S3.SS2.p2.13.m13.1" class="ltx_Math" alttext="[\mathbf{v}_{n}\|\mathbf{q}]" display="inline"><semantics id="S3.SS2.p2.13.m13.1a"><mrow id="S3.SS2.p2.13.m13.1.1.1" xref="S3.SS2.p2.13.m13.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p2.13.m13.1.1.1.2" xref="S3.SS2.p2.13.m13.1.1.2.1.cmml">[</mo><mrow id="S3.SS2.p2.13.m13.1.1.1.1" xref="S3.SS2.p2.13.m13.1.1.1.1.cmml"><msub id="S3.SS2.p2.13.m13.1.1.1.1.2" xref="S3.SS2.p2.13.m13.1.1.1.1.2.cmml"><mi id="S3.SS2.p2.13.m13.1.1.1.1.2.2" xref="S3.SS2.p2.13.m13.1.1.1.1.2.2.cmml">𝐯</mi><mi id="S3.SS2.p2.13.m13.1.1.1.1.2.3" xref="S3.SS2.p2.13.m13.1.1.1.1.2.3.cmml">n</mi></msub><mo id="S3.SS2.p2.13.m13.1.1.1.1.1" xref="S3.SS2.p2.13.m13.1.1.1.1.1.cmml">∥</mo><mi id="S3.SS2.p2.13.m13.1.1.1.1.3" xref="S3.SS2.p2.13.m13.1.1.1.1.3.cmml">𝐪</mi></mrow><mo stretchy="false" id="S3.SS2.p2.13.m13.1.1.1.3" xref="S3.SS2.p2.13.m13.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.13.m13.1b"><apply id="S3.SS2.p2.13.m13.1.1.2.cmml" xref="S3.SS2.p2.13.m13.1.1.1"><csymbol cd="latexml" id="S3.SS2.p2.13.m13.1.1.2.1.cmml" xref="S3.SS2.p2.13.m13.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS2.p2.13.m13.1.1.1.1.cmml" xref="S3.SS2.p2.13.m13.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p2.13.m13.1.1.1.1.1.cmml" xref="S3.SS2.p2.13.m13.1.1.1.1.1">conditional</csymbol><apply id="S3.SS2.p2.13.m13.1.1.1.1.2.cmml" xref="S3.SS2.p2.13.m13.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.13.m13.1.1.1.1.2.1.cmml" xref="S3.SS2.p2.13.m13.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.13.m13.1.1.1.1.2.2.cmml" xref="S3.SS2.p2.13.m13.1.1.1.1.2.2">𝐯</ci><ci id="S3.SS2.p2.13.m13.1.1.1.1.2.3.cmml" xref="S3.SS2.p2.13.m13.1.1.1.1.2.3">𝑛</ci></apply><ci id="S3.SS2.p2.13.m13.1.1.1.1.3.cmml" xref="S3.SS2.p2.13.m13.1.1.1.1.3">𝐪</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.13.m13.1c">[\mathbf{v}_{n}\|\mathbf{q}]</annotation></semantics></math>. We then compute a joint embedding as:</p>
</div>
<div id="S3.SS2.p3" class="ltx_para ltx_noindent">
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.6" class="ltx_Math" alttext="\mathbf{e}_{n}=F([\mathbf{v}_{n}\|\mathbf{q}]),\qquad n=1,2,...,N" display="block"><semantics id="S3.E1.m1.6a"><mrow id="S3.E1.m1.6.6.2" xref="S3.E1.m1.6.6.3.cmml"><mrow id="S3.E1.m1.5.5.1.1" xref="S3.E1.m1.5.5.1.1.cmml"><msub id="S3.E1.m1.5.5.1.1.3" xref="S3.E1.m1.5.5.1.1.3.cmml"><mi id="S3.E1.m1.5.5.1.1.3.2" xref="S3.E1.m1.5.5.1.1.3.2.cmml">𝐞</mi><mi id="S3.E1.m1.5.5.1.1.3.3" xref="S3.E1.m1.5.5.1.1.3.3.cmml">n</mi></msub><mo id="S3.E1.m1.5.5.1.1.2" xref="S3.E1.m1.5.5.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.5.5.1.1.1" xref="S3.E1.m1.5.5.1.1.1.cmml"><mi id="S3.E1.m1.5.5.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.5.5.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.5.5.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.5.5.1.1.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.5.5.1.1.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.5.5.1.1.1.1.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.2.2.cmml">𝐯</mi><mi id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.2.3.cmml">n</mi></msub><mo id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">∥</mo><mi id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.3.cmml">𝐪</mi></mrow><mo stretchy="false" id="S3.E1.m1.5.5.1.1.1.1.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2.1.cmml">]</mo></mrow><mo stretchy="false" id="S3.E1.m1.5.5.1.1.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="2.167em" id="S3.E1.m1.6.6.2.3" xref="S3.E1.m1.6.6.3a.cmml">,</mo><mrow id="S3.E1.m1.6.6.2.2" xref="S3.E1.m1.6.6.2.2.cmml"><mi id="S3.E1.m1.6.6.2.2.2" xref="S3.E1.m1.6.6.2.2.2.cmml">n</mi><mo id="S3.E1.m1.6.6.2.2.1" xref="S3.E1.m1.6.6.2.2.1.cmml">=</mo><mrow id="S3.E1.m1.6.6.2.2.3.2" xref="S3.E1.m1.6.6.2.2.3.1.cmml"><mn id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">1</mn><mo id="S3.E1.m1.6.6.2.2.3.2.1" xref="S3.E1.m1.6.6.2.2.3.1.cmml">,</mo><mn id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">2</mn><mo id="S3.E1.m1.6.6.2.2.3.2.2" xref="S3.E1.m1.6.6.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">…</mi><mo id="S3.E1.m1.6.6.2.2.3.2.3" xref="S3.E1.m1.6.6.2.2.3.1.cmml">,</mo><mi id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml">N</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.6b"><apply id="S3.E1.m1.6.6.3.cmml" xref="S3.E1.m1.6.6.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.3a.cmml" xref="S3.E1.m1.6.6.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.5.5.1.1.cmml" xref="S3.E1.m1.5.5.1.1"><eq id="S3.E1.m1.5.5.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.2"></eq><apply id="S3.E1.m1.5.5.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.3.1.cmml" xref="S3.E1.m1.5.5.1.1.3">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.3.2.cmml" xref="S3.E1.m1.5.5.1.1.3.2">𝐞</ci><ci id="S3.E1.m1.5.5.1.1.3.3.cmml" xref="S3.E1.m1.5.5.1.1.3.3">𝑛</ci></apply><apply id="S3.E1.m1.5.5.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1"><times id="S3.E1.m1.5.5.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.2"></times><ci id="S3.E1.m1.5.5.1.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.1.3">𝐹</ci><apply id="S3.E1.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.2.2">𝐯</ci><ci id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.2.3">𝑛</ci></apply><ci id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.3">𝐪</ci></apply></apply></apply></apply><apply id="S3.E1.m1.6.6.2.2.cmml" xref="S3.E1.m1.6.6.2.2"><eq id="S3.E1.m1.6.6.2.2.1.cmml" xref="S3.E1.m1.6.6.2.2.1"></eq><ci id="S3.E1.m1.6.6.2.2.2.cmml" xref="S3.E1.m1.6.6.2.2.2">𝑛</ci><list id="S3.E1.m1.6.6.2.2.3.1.cmml" xref="S3.E1.m1.6.6.2.2.3.2"><cn type="integer" id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">1</cn><cn type="integer" id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">2</cn><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">…</ci><ci id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4">𝑁</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.6c">\mathbf{e}_{n}=F([\mathbf{v}_{n}\|\mathbf{q}]),\qquad n=1,2,...,N</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p4" class="ltx_para ltx_noindent">
<p id="S3.SS2.p4.8" class="ltx_p">where <math id="S3.SS2.p4.1.m1.1" class="ltx_Math" alttext="F:\mathbb{R}^{d_{v}+d_{q}}\rightarrow\mathbb{R}^{d_{e}}" display="inline"><semantics id="S3.SS2.p4.1.m1.1a"><mrow id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml"><mi id="S3.SS2.p4.1.m1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.2.cmml">F</mi><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.p4.1.m1.1.1.1" xref="S3.SS2.p4.1.m1.1.1.1.cmml">:</mo><mrow id="S3.SS2.p4.1.m1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.3.cmml"><msup id="S3.SS2.p4.1.m1.1.1.3.2" xref="S3.SS2.p4.1.m1.1.1.3.2.cmml"><mi id="S3.SS2.p4.1.m1.1.1.3.2.2" xref="S3.SS2.p4.1.m1.1.1.3.2.2.cmml">ℝ</mi><mrow id="S3.SS2.p4.1.m1.1.1.3.2.3" xref="S3.SS2.p4.1.m1.1.1.3.2.3.cmml"><msub id="S3.SS2.p4.1.m1.1.1.3.2.3.2" xref="S3.SS2.p4.1.m1.1.1.3.2.3.2.cmml"><mi id="S3.SS2.p4.1.m1.1.1.3.2.3.2.2" xref="S3.SS2.p4.1.m1.1.1.3.2.3.2.2.cmml">d</mi><mi id="S3.SS2.p4.1.m1.1.1.3.2.3.2.3" xref="S3.SS2.p4.1.m1.1.1.3.2.3.2.3.cmml">v</mi></msub><mo id="S3.SS2.p4.1.m1.1.1.3.2.3.1" xref="S3.SS2.p4.1.m1.1.1.3.2.3.1.cmml">+</mo><msub id="S3.SS2.p4.1.m1.1.1.3.2.3.3" xref="S3.SS2.p4.1.m1.1.1.3.2.3.3.cmml"><mi id="S3.SS2.p4.1.m1.1.1.3.2.3.3.2" xref="S3.SS2.p4.1.m1.1.1.3.2.3.3.2.cmml">d</mi><mi id="S3.SS2.p4.1.m1.1.1.3.2.3.3.3" xref="S3.SS2.p4.1.m1.1.1.3.2.3.3.3.cmml">q</mi></msub></mrow></msup><mo stretchy="false" id="S3.SS2.p4.1.m1.1.1.3.1" xref="S3.SS2.p4.1.m1.1.1.3.1.cmml">→</mo><msup id="S3.SS2.p4.1.m1.1.1.3.3" xref="S3.SS2.p4.1.m1.1.1.3.3.cmml"><mi id="S3.SS2.p4.1.m1.1.1.3.3.2" xref="S3.SS2.p4.1.m1.1.1.3.3.2.cmml">ℝ</mi><msub id="S3.SS2.p4.1.m1.1.1.3.3.3" xref="S3.SS2.p4.1.m1.1.1.3.3.3.cmml"><mi id="S3.SS2.p4.1.m1.1.1.3.3.3.2" xref="S3.SS2.p4.1.m1.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS2.p4.1.m1.1.1.3.3.3.3" xref="S3.SS2.p4.1.m1.1.1.3.3.3.3.cmml">e</mi></msub></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><apply id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1"><ci id="S3.SS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1.1">:</ci><ci id="S3.SS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2">𝐹</ci><apply id="S3.SS2.p4.1.m1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3"><ci id="S3.SS2.p4.1.m1.1.1.3.1.cmml" xref="S3.SS2.p4.1.m1.1.1.3.1">→</ci><apply id="S3.SS2.p4.1.m1.1.1.3.2.cmml" xref="S3.SS2.p4.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.1.3.2.1.cmml" xref="S3.SS2.p4.1.m1.1.1.3.2">superscript</csymbol><ci id="S3.SS2.p4.1.m1.1.1.3.2.2.cmml" xref="S3.SS2.p4.1.m1.1.1.3.2.2">ℝ</ci><apply id="S3.SS2.p4.1.m1.1.1.3.2.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3.2.3"><plus id="S3.SS2.p4.1.m1.1.1.3.2.3.1.cmml" xref="S3.SS2.p4.1.m1.1.1.3.2.3.1"></plus><apply id="S3.SS2.p4.1.m1.1.1.3.2.3.2.cmml" xref="S3.SS2.p4.1.m1.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.1.3.2.3.2.1.cmml" xref="S3.SS2.p4.1.m1.1.1.3.2.3.2">subscript</csymbol><ci id="S3.SS2.p4.1.m1.1.1.3.2.3.2.2.cmml" xref="S3.SS2.p4.1.m1.1.1.3.2.3.2.2">𝑑</ci><ci id="S3.SS2.p4.1.m1.1.1.3.2.3.2.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3.2.3.2.3">𝑣</ci></apply><apply id="S3.SS2.p4.1.m1.1.1.3.2.3.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.1.3.2.3.3.1.cmml" xref="S3.SS2.p4.1.m1.1.1.3.2.3.3">subscript</csymbol><ci id="S3.SS2.p4.1.m1.1.1.3.2.3.3.2.cmml" xref="S3.SS2.p4.1.m1.1.1.3.2.3.3.2">𝑑</ci><ci id="S3.SS2.p4.1.m1.1.1.3.2.3.3.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3.2.3.3.3">𝑞</ci></apply></apply></apply><apply id="S3.SS2.p4.1.m1.1.1.3.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.p4.1.m1.1.1.3.3">superscript</csymbol><ci id="S3.SS2.p4.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.p4.1.m1.1.1.3.3.2">ℝ</ci><apply id="S3.SS2.p4.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.1.3.3.3.1.cmml" xref="S3.SS2.p4.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.p4.1.m1.1.1.3.3.3.2.cmml" xref="S3.SS2.p4.1.m1.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS2.p4.1.m1.1.1.3.3.3.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3.3.3.3">𝑒</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">F:\mathbb{R}^{d_{v}+d_{q}}\rightarrow\mathbb{R}^{d_{e}}</annotation></semantics></math> is a non-linear function and <math id="S3.SS2.p4.2.m2.1" class="ltx_Math" alttext="d_{v}" display="inline"><semantics id="S3.SS2.p4.2.m2.1a"><msub id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml"><mi id="S3.SS2.p4.2.m2.1.1.2" xref="S3.SS2.p4.2.m2.1.1.2.cmml">d</mi><mi id="S3.SS2.p4.2.m2.1.1.3" xref="S3.SS2.p4.2.m2.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><apply id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2">𝑑</ci><ci id="S3.SS2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">d_{v}</annotation></semantics></math>, <math id="S3.SS2.p4.3.m3.1" class="ltx_Math" alttext="d_{q}" display="inline"><semantics id="S3.SS2.p4.3.m3.1a"><msub id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml"><mi id="S3.SS2.p4.3.m3.1.1.2" xref="S3.SS2.p4.3.m3.1.1.2.cmml">d</mi><mi id="S3.SS2.p4.3.m3.1.1.3" xref="S3.SS2.p4.3.m3.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><apply id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.1.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p4.3.m3.1.1.2.cmml" xref="S3.SS2.p4.3.m3.1.1.2">𝑑</ci><ci id="S3.SS2.p4.3.m3.1.1.3.cmml" xref="S3.SS2.p4.3.m3.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">d_{q}</annotation></semantics></math>, <math id="S3.SS2.p4.4.m4.1" class="ltx_Math" alttext="d_{e}" display="inline"><semantics id="S3.SS2.p4.4.m4.1a"><msub id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml"><mi id="S3.SS2.p4.4.m4.1.1.2" xref="S3.SS2.p4.4.m4.1.1.2.cmml">d</mi><mi id="S3.SS2.p4.4.m4.1.1.3" xref="S3.SS2.p4.4.m4.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.1b"><apply id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.1.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p4.4.m4.1.1.2.cmml" xref="S3.SS2.p4.4.m4.1.1.2">𝑑</ci><ci id="S3.SS2.p4.4.m4.1.1.3.cmml" xref="S3.SS2.p4.4.m4.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.1c">d_{e}</annotation></semantics></math> are the dimensions of the image feature vectors, question encoding and joint embedding respectively. By concatenating the joint embeddings <math id="S3.SS2.p4.5.m5.1" class="ltx_Math" alttext="\mathbf{e_{n}}" display="inline"><semantics id="S3.SS2.p4.5.m5.1a"><msub id="S3.SS2.p4.5.m5.1.1" xref="S3.SS2.p4.5.m5.1.1.cmml"><mi id="S3.SS2.p4.5.m5.1.1.2" xref="S3.SS2.p4.5.m5.1.1.2.cmml">𝐞</mi><mi id="S3.SS2.p4.5.m5.1.1.3" xref="S3.SS2.p4.5.m5.1.1.3.cmml">𝐧</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.1b"><apply id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m5.1.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p4.5.m5.1.1.2.cmml" xref="S3.SS2.p4.5.m5.1.1.2">𝐞</ci><ci id="S3.SS2.p4.5.m5.1.1.3.cmml" xref="S3.SS2.p4.5.m5.1.1.3">𝐧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.1c">\mathbf{e_{n}}</annotation></semantics></math> together into a matrix <math id="S3.SS2.p4.6.m6.1" class="ltx_Math" alttext="\mathbf{E}\in\mathbb{R}^{N\times d_{e}}" display="inline"><semantics id="S3.SS2.p4.6.m6.1a"><mrow id="S3.SS2.p4.6.m6.1.1" xref="S3.SS2.p4.6.m6.1.1.cmml"><mi id="S3.SS2.p4.6.m6.1.1.2" xref="S3.SS2.p4.6.m6.1.1.2.cmml">𝐄</mi><mo id="S3.SS2.p4.6.m6.1.1.1" xref="S3.SS2.p4.6.m6.1.1.1.cmml">∈</mo><msup id="S3.SS2.p4.6.m6.1.1.3" xref="S3.SS2.p4.6.m6.1.1.3.cmml"><mi id="S3.SS2.p4.6.m6.1.1.3.2" xref="S3.SS2.p4.6.m6.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p4.6.m6.1.1.3.3" xref="S3.SS2.p4.6.m6.1.1.3.3.cmml"><mi id="S3.SS2.p4.6.m6.1.1.3.3.2" xref="S3.SS2.p4.6.m6.1.1.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p4.6.m6.1.1.3.3.1" xref="S3.SS2.p4.6.m6.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.p4.6.m6.1.1.3.3.3" xref="S3.SS2.p4.6.m6.1.1.3.3.3.cmml"><mi id="S3.SS2.p4.6.m6.1.1.3.3.3.2" xref="S3.SS2.p4.6.m6.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS2.p4.6.m6.1.1.3.3.3.3" xref="S3.SS2.p4.6.m6.1.1.3.3.3.3.cmml">e</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.6.m6.1b"><apply id="S3.SS2.p4.6.m6.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1"><in id="S3.SS2.p4.6.m6.1.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1.1"></in><ci id="S3.SS2.p4.6.m6.1.1.2.cmml" xref="S3.SS2.p4.6.m6.1.1.2">𝐄</ci><apply id="S3.SS2.p4.6.m6.1.1.3.cmml" xref="S3.SS2.p4.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.6.m6.1.1.3.1.cmml" xref="S3.SS2.p4.6.m6.1.1.3">superscript</csymbol><ci id="S3.SS2.p4.6.m6.1.1.3.2.cmml" xref="S3.SS2.p4.6.m6.1.1.3.2">ℝ</ci><apply id="S3.SS2.p4.6.m6.1.1.3.3.cmml" xref="S3.SS2.p4.6.m6.1.1.3.3"><times id="S3.SS2.p4.6.m6.1.1.3.3.1.cmml" xref="S3.SS2.p4.6.m6.1.1.3.3.1"></times><ci id="S3.SS2.p4.6.m6.1.1.3.3.2.cmml" xref="S3.SS2.p4.6.m6.1.1.3.3.2">𝑁</ci><apply id="S3.SS2.p4.6.m6.1.1.3.3.3.cmml" xref="S3.SS2.p4.6.m6.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p4.6.m6.1.1.3.3.3.1.cmml" xref="S3.SS2.p4.6.m6.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.p4.6.m6.1.1.3.3.3.2.cmml" xref="S3.SS2.p4.6.m6.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS2.p4.6.m6.1.1.3.3.3.3.cmml" xref="S3.SS2.p4.6.m6.1.1.3.3.3.3">𝑒</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.6.m6.1c">\mathbf{E}\in\mathbb{R}^{N\times d_{e}}</annotation></semantics></math>, it is then possible to define an adjacency matrix for an undirected graph with self loops as
<math id="S3.SS2.p4.7.m7.1" class="ltx_Math" alttext="\mathbf{A}=\mathbf{EE}^{T}" display="inline"><semantics id="S3.SS2.p4.7.m7.1a"><mrow id="S3.SS2.p4.7.m7.1.1" xref="S3.SS2.p4.7.m7.1.1.cmml"><mi id="S3.SS2.p4.7.m7.1.1.2" xref="S3.SS2.p4.7.m7.1.1.2.cmml">𝐀</mi><mo id="S3.SS2.p4.7.m7.1.1.1" xref="S3.SS2.p4.7.m7.1.1.1.cmml">=</mo><msup id="S3.SS2.p4.7.m7.1.1.3" xref="S3.SS2.p4.7.m7.1.1.3.cmml"><mi id="S3.SS2.p4.7.m7.1.1.3.2" xref="S3.SS2.p4.7.m7.1.1.3.2.cmml">𝐄𝐄</mi><mi id="S3.SS2.p4.7.m7.1.1.3.3" xref="S3.SS2.p4.7.m7.1.1.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.7.m7.1b"><apply id="S3.SS2.p4.7.m7.1.1.cmml" xref="S3.SS2.p4.7.m7.1.1"><eq id="S3.SS2.p4.7.m7.1.1.1.cmml" xref="S3.SS2.p4.7.m7.1.1.1"></eq><ci id="S3.SS2.p4.7.m7.1.1.2.cmml" xref="S3.SS2.p4.7.m7.1.1.2">𝐀</ci><apply id="S3.SS2.p4.7.m7.1.1.3.cmml" xref="S3.SS2.p4.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.7.m7.1.1.3.1.cmml" xref="S3.SS2.p4.7.m7.1.1.3">superscript</csymbol><ci id="S3.SS2.p4.7.m7.1.1.3.2.cmml" xref="S3.SS2.p4.7.m7.1.1.3.2">𝐄𝐄</ci><ci id="S3.SS2.p4.7.m7.1.1.3.3.cmml" xref="S3.SS2.p4.7.m7.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.7.m7.1c">\mathbf{A}=\mathbf{EE}^{T}</annotation></semantics></math>
so that <math id="S3.SS2.p4.8.m8.2" class="ltx_Math" alttext="A_{i,j}=\mathbf{e}_{i}^{T}\mathbf{e}_{j}" display="inline"><semantics id="S3.SS2.p4.8.m8.2a"><mrow id="S3.SS2.p4.8.m8.2.3" xref="S3.SS2.p4.8.m8.2.3.cmml"><msub id="S3.SS2.p4.8.m8.2.3.2" xref="S3.SS2.p4.8.m8.2.3.2.cmml"><mi id="S3.SS2.p4.8.m8.2.3.2.2" xref="S3.SS2.p4.8.m8.2.3.2.2.cmml">A</mi><mrow id="S3.SS2.p4.8.m8.2.2.2.4" xref="S3.SS2.p4.8.m8.2.2.2.3.cmml"><mi id="S3.SS2.p4.8.m8.1.1.1.1" xref="S3.SS2.p4.8.m8.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p4.8.m8.2.2.2.4.1" xref="S3.SS2.p4.8.m8.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p4.8.m8.2.2.2.2" xref="S3.SS2.p4.8.m8.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S3.SS2.p4.8.m8.2.3.1" xref="S3.SS2.p4.8.m8.2.3.1.cmml">=</mo><mrow id="S3.SS2.p4.8.m8.2.3.3" xref="S3.SS2.p4.8.m8.2.3.3.cmml"><msubsup id="S3.SS2.p4.8.m8.2.3.3.2" xref="S3.SS2.p4.8.m8.2.3.3.2.cmml"><mi id="S3.SS2.p4.8.m8.2.3.3.2.2.2" xref="S3.SS2.p4.8.m8.2.3.3.2.2.2.cmml">𝐞</mi><mi id="S3.SS2.p4.8.m8.2.3.3.2.2.3" xref="S3.SS2.p4.8.m8.2.3.3.2.2.3.cmml">i</mi><mi id="S3.SS2.p4.8.m8.2.3.3.2.3" xref="S3.SS2.p4.8.m8.2.3.3.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS2.p4.8.m8.2.3.3.1" xref="S3.SS2.p4.8.m8.2.3.3.1.cmml">​</mo><msub id="S3.SS2.p4.8.m8.2.3.3.3" xref="S3.SS2.p4.8.m8.2.3.3.3.cmml"><mi id="S3.SS2.p4.8.m8.2.3.3.3.2" xref="S3.SS2.p4.8.m8.2.3.3.3.2.cmml">𝐞</mi><mi id="S3.SS2.p4.8.m8.2.3.3.3.3" xref="S3.SS2.p4.8.m8.2.3.3.3.3.cmml">j</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.8.m8.2b"><apply id="S3.SS2.p4.8.m8.2.3.cmml" xref="S3.SS2.p4.8.m8.2.3"><eq id="S3.SS2.p4.8.m8.2.3.1.cmml" xref="S3.SS2.p4.8.m8.2.3.1"></eq><apply id="S3.SS2.p4.8.m8.2.3.2.cmml" xref="S3.SS2.p4.8.m8.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p4.8.m8.2.3.2.1.cmml" xref="S3.SS2.p4.8.m8.2.3.2">subscript</csymbol><ci id="S3.SS2.p4.8.m8.2.3.2.2.cmml" xref="S3.SS2.p4.8.m8.2.3.2.2">𝐴</ci><list id="S3.SS2.p4.8.m8.2.2.2.3.cmml" xref="S3.SS2.p4.8.m8.2.2.2.4"><ci id="S3.SS2.p4.8.m8.1.1.1.1.cmml" xref="S3.SS2.p4.8.m8.1.1.1.1">𝑖</ci><ci id="S3.SS2.p4.8.m8.2.2.2.2.cmml" xref="S3.SS2.p4.8.m8.2.2.2.2">𝑗</ci></list></apply><apply id="S3.SS2.p4.8.m8.2.3.3.cmml" xref="S3.SS2.p4.8.m8.2.3.3"><times id="S3.SS2.p4.8.m8.2.3.3.1.cmml" xref="S3.SS2.p4.8.m8.2.3.3.1"></times><apply id="S3.SS2.p4.8.m8.2.3.3.2.cmml" xref="S3.SS2.p4.8.m8.2.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p4.8.m8.2.3.3.2.1.cmml" xref="S3.SS2.p4.8.m8.2.3.3.2">superscript</csymbol><apply id="S3.SS2.p4.8.m8.2.3.3.2.2.cmml" xref="S3.SS2.p4.8.m8.2.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p4.8.m8.2.3.3.2.2.1.cmml" xref="S3.SS2.p4.8.m8.2.3.3.2">subscript</csymbol><ci id="S3.SS2.p4.8.m8.2.3.3.2.2.2.cmml" xref="S3.SS2.p4.8.m8.2.3.3.2.2.2">𝐞</ci><ci id="S3.SS2.p4.8.m8.2.3.3.2.2.3.cmml" xref="S3.SS2.p4.8.m8.2.3.3.2.2.3">𝑖</ci></apply><ci id="S3.SS2.p4.8.m8.2.3.3.2.3.cmml" xref="S3.SS2.p4.8.m8.2.3.3.2.3">𝑇</ci></apply><apply id="S3.SS2.p4.8.m8.2.3.3.3.cmml" xref="S3.SS2.p4.8.m8.2.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p4.8.m8.2.3.3.3.1.cmml" xref="S3.SS2.p4.8.m8.2.3.3.3">subscript</csymbol><ci id="S3.SS2.p4.8.m8.2.3.3.3.2.cmml" xref="S3.SS2.p4.8.m8.2.3.3.3.2">𝐞</ci><ci id="S3.SS2.p4.8.m8.2.3.3.3.3.cmml" xref="S3.SS2.p4.8.m8.2.3.3.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.8.m8.2c">A_{i,j}=\mathbf{e}_{i}^{T}\mathbf{e}_{j}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p5" class="ltx_para ltx_noindent">
<p id="S3.SS2.p5.5" class="ltx_p">Such definition does not impose any constraints on the graph sparsity, and could therefore yield a fully connected adjacency matrix. Not only is this a problem computationally, but the vast majority of VQA questions requires attending to only a small subset of the graph nodes. The learned graph structure will be the backbone of the subsequent graph convolution layers, where the objective is to learn a representation of object features that is conditioned on the most relevant, question-specific neighbours. This requires a sparse graph structure focusing on the most relevant aspects of the image. In order to learn a sparse neighbourhood system for each node, we adopt a ranking strategy as:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.2" class="ltx_Math" alttext="\mathcal{N}(i)=topm(\mathbf{a}_{i})" display="block"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml"><mrow id="S3.E2.m1.2.2.3" xref="S3.E2.m1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.2.3.2" xref="S3.E2.m1.2.2.3.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.3.1" xref="S3.E2.m1.2.2.3.1.cmml">​</mo><mrow id="S3.E2.m1.2.2.3.3.2" xref="S3.E2.m1.2.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.3.3.2.1" xref="S3.E2.m1.2.2.3.cmml">(</mo><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">i</mi><mo stretchy="false" id="S3.E2.m1.2.2.3.3.2.2" xref="S3.E2.m1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.2.2.2" xref="S3.E2.m1.2.2.2.cmml">=</mo><mrow id="S3.E2.m1.2.2.1" xref="S3.E2.m1.2.2.1.cmml"><mi id="S3.E2.m1.2.2.1.3" xref="S3.E2.m1.2.2.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.2" xref="S3.E2.m1.2.2.1.2.cmml">​</mo><mi id="S3.E2.m1.2.2.1.4" xref="S3.E2.m1.2.2.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.2a" xref="S3.E2.m1.2.2.1.2.cmml">​</mo><mi id="S3.E2.m1.2.2.1.5" xref="S3.E2.m1.2.2.1.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.2b" xref="S3.E2.m1.2.2.1.2.cmml">​</mo><mi id="S3.E2.m1.2.2.1.6" xref="S3.E2.m1.2.2.1.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.2c" xref="S3.E2.m1.2.2.1.2.cmml">​</mo><mrow id="S3.E2.m1.2.2.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.cmml">(</mo><msub id="S3.E2.m1.2.2.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.2.cmml">𝐚</mi><mi id="S3.E2.m1.2.2.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E2.m1.2.2.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2"><eq id="S3.E2.m1.2.2.2.cmml" xref="S3.E2.m1.2.2.2"></eq><apply id="S3.E2.m1.2.2.3.cmml" xref="S3.E2.m1.2.2.3"><times id="S3.E2.m1.2.2.3.1.cmml" xref="S3.E2.m1.2.2.3.1"></times><ci id="S3.E2.m1.2.2.3.2.cmml" xref="S3.E2.m1.2.2.3.2">𝒩</ci><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝑖</ci></apply><apply id="S3.E2.m1.2.2.1.cmml" xref="S3.E2.m1.2.2.1"><times id="S3.E2.m1.2.2.1.2.cmml" xref="S3.E2.m1.2.2.1.2"></times><ci id="S3.E2.m1.2.2.1.3.cmml" xref="S3.E2.m1.2.2.1.3">𝑡</ci><ci id="S3.E2.m1.2.2.1.4.cmml" xref="S3.E2.m1.2.2.1.4">𝑜</ci><ci id="S3.E2.m1.2.2.1.5.cmml" xref="S3.E2.m1.2.2.1.5">𝑝</ci><ci id="S3.E2.m1.2.2.1.6.cmml" xref="S3.E2.m1.2.2.1.6">𝑚</ci><apply id="S3.E2.m1.2.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.2">𝐚</ci><ci id="S3.E2.m1.2.2.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">\mathcal{N}(i)=topm(\mathbf{a}_{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p5.4" class="ltx_p">where <math id="S3.SS2.p5.1.m1.1" class="ltx_Math" alttext="topm" display="inline"><semantics id="S3.SS2.p5.1.m1.1a"><mrow id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml"><mi id="S3.SS2.p5.1.m1.1.1.2" xref="S3.SS2.p5.1.m1.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.1.m1.1.1.1" xref="S3.SS2.p5.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS2.p5.1.m1.1.1.3" xref="S3.SS2.p5.1.m1.1.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.1.m1.1.1.1a" xref="S3.SS2.p5.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS2.p5.1.m1.1.1.4" xref="S3.SS2.p5.1.m1.1.1.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.1.m1.1.1.1b" xref="S3.SS2.p5.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS2.p5.1.m1.1.1.5" xref="S3.SS2.p5.1.m1.1.1.5.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><apply id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1"><times id="S3.SS2.p5.1.m1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1.1"></times><ci id="S3.SS2.p5.1.m1.1.1.2.cmml" xref="S3.SS2.p5.1.m1.1.1.2">𝑡</ci><ci id="S3.SS2.p5.1.m1.1.1.3.cmml" xref="S3.SS2.p5.1.m1.1.1.3">𝑜</ci><ci id="S3.SS2.p5.1.m1.1.1.4.cmml" xref="S3.SS2.p5.1.m1.1.1.4">𝑝</ci><ci id="S3.SS2.p5.1.m1.1.1.5.cmml" xref="S3.SS2.p5.1.m1.1.1.5">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">topm</annotation></semantics></math> returns the indices of the <math id="S3.SS2.p5.2.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS2.p5.2.m2.1a"><mi id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b"><ci id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">m</annotation></semantics></math> largest values of an input vector, and <math id="S3.SS2.p5.3.m3.1" class="ltx_Math" alttext="\mathbf{a}_{i}" display="inline"><semantics id="S3.SS2.p5.3.m3.1a"><msub id="S3.SS2.p5.3.m3.1.1" xref="S3.SS2.p5.3.m3.1.1.cmml"><mi id="S3.SS2.p5.3.m3.1.1.2" xref="S3.SS2.p5.3.m3.1.1.2.cmml">𝐚</mi><mi id="S3.SS2.p5.3.m3.1.1.3" xref="S3.SS2.p5.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m3.1b"><apply id="S3.SS2.p5.3.m3.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.3.m3.1.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p5.3.m3.1.1.2.cmml" xref="S3.SS2.p5.3.m3.1.1.2">𝐚</ci><ci id="S3.SS2.p5.3.m3.1.1.3.cmml" xref="S3.SS2.p5.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.3.m3.1c">\mathbf{a}_{i}</annotation></semantics></math> denotes the <math id="S3.SS2.p5.4.m4.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S3.SS2.p5.4.m4.1a"><msup id="S3.SS2.p5.4.m4.1.1" xref="S3.SS2.p5.4.m4.1.1.cmml"><mi id="S3.SS2.p5.4.m4.1.1.2" xref="S3.SS2.p5.4.m4.1.1.2.cmml">i</mi><mrow id="S3.SS2.p5.4.m4.1.1.3" xref="S3.SS2.p5.4.m4.1.1.3.cmml"><mi id="S3.SS2.p5.4.m4.1.1.3.2" xref="S3.SS2.p5.4.m4.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.4.m4.1.1.3.1" xref="S3.SS2.p5.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p5.4.m4.1.1.3.3" xref="S3.SS2.p5.4.m4.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.4.m4.1b"><apply id="S3.SS2.p5.4.m4.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.4.m4.1.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1">superscript</csymbol><ci id="S3.SS2.p5.4.m4.1.1.2.cmml" xref="S3.SS2.p5.4.m4.1.1.2">𝑖</ci><apply id="S3.SS2.p5.4.m4.1.1.3.cmml" xref="S3.SS2.p5.4.m4.1.1.3"><times id="S3.SS2.p5.4.m4.1.1.3.1.cmml" xref="S3.SS2.p5.4.m4.1.1.3.1"></times><ci id="S3.SS2.p5.4.m4.1.1.3.2.cmml" xref="S3.SS2.p5.4.m4.1.1.3.2">𝑡</ci><ci id="S3.SS2.p5.4.m4.1.1.3.3.cmml" xref="S3.SS2.p5.4.m4.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.4.m4.1c">i^{th}</annotation></semantics></math> row of the adjacency matrix. In other words, the neighbourhood system of a given node will correspond to the nodes with which it has the strongest connections.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Spatial graph convolutions</h3>

<div id="S3.SS3.p1" class="ltx_para ltx_noindent">
<p id="S3.SS3.p1.1" class="ltx_p">Given a question specific graph structure, we then exploit a method of graph convolutions to learn new object representations that are informed by a neighbourhood system tailored to answer the given question. The graph vertices <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{V}" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">𝒱</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝒱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\mathcal{V}</annotation></semantics></math> (i.e. the bounding box and their corresponding features) are notably characterised by their location in the image, making the problem of modelling their interactions inherently spatial. Additionally, a lot of VQA questions require that the model has an awareness of the orientation and relative position of features in an image, an issue that many previous approaches have neglected.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para ltx_noindent">
<p id="S3.SS3.p2.11" class="ltx_p">As a result, we opt to use a graph CNN approach inspired by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, operating directly in the graph domain and heavily relying on spatial relationships.
Crucially, their method captures spatial information through the use of a pairwise pseudo-coordinate function <math id="S3.SS3.p2.1.m1.2" class="ltx_Math" alttext="\mathbf{u}(i,j)" display="inline"><semantics id="S3.SS3.p2.1.m1.2a"><mrow id="S3.SS3.p2.1.m1.2.3" xref="S3.SS3.p2.1.m1.2.3.cmml"><mi id="S3.SS3.p2.1.m1.2.3.2" xref="S3.SS3.p2.1.m1.2.3.2.cmml">𝐮</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.1.m1.2.3.1" xref="S3.SS3.p2.1.m1.2.3.1.cmml">​</mo><mrow id="S3.SS3.p2.1.m1.2.3.3.2" xref="S3.SS3.p2.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS3.p2.1.m1.2.3.3.2.1" xref="S3.SS3.p2.1.m1.2.3.3.1.cmml">(</mo><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">i</mi><mo id="S3.SS3.p2.1.m1.2.3.3.2.2" xref="S3.SS3.p2.1.m1.2.3.3.1.cmml">,</mo><mi id="S3.SS3.p2.1.m1.2.2" xref="S3.SS3.p2.1.m1.2.2.cmml">j</mi><mo stretchy="false" id="S3.SS3.p2.1.m1.2.3.3.2.3" xref="S3.SS3.p2.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.2b"><apply id="S3.SS3.p2.1.m1.2.3.cmml" xref="S3.SS3.p2.1.m1.2.3"><times id="S3.SS3.p2.1.m1.2.3.1.cmml" xref="S3.SS3.p2.1.m1.2.3.1"></times><ci id="S3.SS3.p2.1.m1.2.3.2.cmml" xref="S3.SS3.p2.1.m1.2.3.2">𝐮</ci><interval closure="open" id="S3.SS3.p2.1.m1.2.3.3.1.cmml" xref="S3.SS3.p2.1.m1.2.3.3.2"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝑖</ci><ci id="S3.SS3.p2.1.m1.2.2.cmml" xref="S3.SS3.p2.1.m1.2.2">𝑗</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.2c">\mathbf{u}(i,j)</annotation></semantics></math> which defines, for each vertex <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><mi id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">i</annotation></semantics></math>, a coordinate system centred at <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><mi id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><ci id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">i</annotation></semantics></math>, with <math id="S3.SS3.p2.4.m4.2" class="ltx_Math" alttext="\mathbf{u}(i,j)" display="inline"><semantics id="S3.SS3.p2.4.m4.2a"><mrow id="S3.SS3.p2.4.m4.2.3" xref="S3.SS3.p2.4.m4.2.3.cmml"><mi id="S3.SS3.p2.4.m4.2.3.2" xref="S3.SS3.p2.4.m4.2.3.2.cmml">𝐮</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.4.m4.2.3.1" xref="S3.SS3.p2.4.m4.2.3.1.cmml">​</mo><mrow id="S3.SS3.p2.4.m4.2.3.3.2" xref="S3.SS3.p2.4.m4.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS3.p2.4.m4.2.3.3.2.1" xref="S3.SS3.p2.4.m4.2.3.3.1.cmml">(</mo><mi id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml">i</mi><mo id="S3.SS3.p2.4.m4.2.3.3.2.2" xref="S3.SS3.p2.4.m4.2.3.3.1.cmml">,</mo><mi id="S3.SS3.p2.4.m4.2.2" xref="S3.SS3.p2.4.m4.2.2.cmml">j</mi><mo stretchy="false" id="S3.SS3.p2.4.m4.2.3.3.2.3" xref="S3.SS3.p2.4.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.2b"><apply id="S3.SS3.p2.4.m4.2.3.cmml" xref="S3.SS3.p2.4.m4.2.3"><times id="S3.SS3.p2.4.m4.2.3.1.cmml" xref="S3.SS3.p2.4.m4.2.3.1"></times><ci id="S3.SS3.p2.4.m4.2.3.2.cmml" xref="S3.SS3.p2.4.m4.2.3.2">𝐮</ci><interval closure="open" id="S3.SS3.p2.4.m4.2.3.3.1.cmml" xref="S3.SS3.p2.4.m4.2.3.3.2"><ci id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">𝑖</ci><ci id="S3.SS3.p2.4.m4.2.2.cmml" xref="S3.SS3.p2.4.m4.2.2">𝑗</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.2c">\mathbf{u}(i,j)</annotation></semantics></math> being the coordinates of vertex <math id="S3.SS3.p2.5.m5.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS3.p2.5.m5.1a"><mi id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><ci id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">j</annotation></semantics></math> in that system. Our pseudo-coordinate function <math id="S3.SS3.p2.6.m6.2" class="ltx_Math" alttext="\mathbf{u}(i,j)" display="inline"><semantics id="S3.SS3.p2.6.m6.2a"><mrow id="S3.SS3.p2.6.m6.2.3" xref="S3.SS3.p2.6.m6.2.3.cmml"><mi id="S3.SS3.p2.6.m6.2.3.2" xref="S3.SS3.p2.6.m6.2.3.2.cmml">𝐮</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.6.m6.2.3.1" xref="S3.SS3.p2.6.m6.2.3.1.cmml">​</mo><mrow id="S3.SS3.p2.6.m6.2.3.3.2" xref="S3.SS3.p2.6.m6.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS3.p2.6.m6.2.3.3.2.1" xref="S3.SS3.p2.6.m6.2.3.3.1.cmml">(</mo><mi id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml">i</mi><mo id="S3.SS3.p2.6.m6.2.3.3.2.2" xref="S3.SS3.p2.6.m6.2.3.3.1.cmml">,</mo><mi id="S3.SS3.p2.6.m6.2.2" xref="S3.SS3.p2.6.m6.2.2.cmml">j</mi><mo stretchy="false" id="S3.SS3.p2.6.m6.2.3.3.2.3" xref="S3.SS3.p2.6.m6.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.2b"><apply id="S3.SS3.p2.6.m6.2.3.cmml" xref="S3.SS3.p2.6.m6.2.3"><times id="S3.SS3.p2.6.m6.2.3.1.cmml" xref="S3.SS3.p2.6.m6.2.3.1"></times><ci id="S3.SS3.p2.6.m6.2.3.2.cmml" xref="S3.SS3.p2.6.m6.2.3.2">𝐮</ci><interval closure="open" id="S3.SS3.p2.6.m6.2.3.3.1.cmml" xref="S3.SS3.p2.6.m6.2.3.3.2"><ci id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">𝑖</ci><ci id="S3.SS3.p2.6.m6.2.2.cmml" xref="S3.SS3.p2.6.m6.2.2">𝑗</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.2c">\mathbf{u}(i,j)</annotation></semantics></math> returns a polar coordinate vector <math id="S3.SS3.p2.7.m7.2" class="ltx_Math" alttext="(\rho,\theta)" display="inline"><semantics id="S3.SS3.p2.7.m7.2a"><mrow id="S3.SS3.p2.7.m7.2.3.2" xref="S3.SS3.p2.7.m7.2.3.1.cmml"><mo stretchy="false" id="S3.SS3.p2.7.m7.2.3.2.1" xref="S3.SS3.p2.7.m7.2.3.1.cmml">(</mo><mi id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml">ρ</mi><mo id="S3.SS3.p2.7.m7.2.3.2.2" xref="S3.SS3.p2.7.m7.2.3.1.cmml">,</mo><mi id="S3.SS3.p2.7.m7.2.2" xref="S3.SS3.p2.7.m7.2.2.cmml">θ</mi><mo stretchy="false" id="S3.SS3.p2.7.m7.2.3.2.3" xref="S3.SS3.p2.7.m7.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.2b"><interval closure="open" id="S3.SS3.p2.7.m7.2.3.1.cmml" xref="S3.SS3.p2.7.m7.2.3.2"><ci id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1">𝜌</ci><ci id="S3.SS3.p2.7.m7.2.2.cmml" xref="S3.SS3.p2.7.m7.2.2">𝜃</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.2c">(\rho,\theta)</annotation></semantics></math>, describing the relative spatial positions of the centres of the bounding boxes associated with vertices <math id="S3.SS3.p2.8.m8.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p2.8.m8.1a"><mi id="S3.SS3.p2.8.m8.1.1" xref="S3.SS3.p2.8.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m8.1b"><ci id="S3.SS3.p2.8.m8.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m8.1c">i</annotation></semantics></math> and <math id="S3.SS3.p2.9.m9.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS3.p2.9.m9.1a"><mi id="S3.SS3.p2.9.m9.1.1" xref="S3.SS3.p2.9.m9.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.9.m9.1b"><ci id="S3.SS3.p2.9.m9.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m9.1c">j</annotation></semantics></math>. We considered both Cartesian and polar coordinates as input to the Gaussian kernels and observed that polar coordinates worked significantly better. We posit that this is because polar coordinates separate orientation (<math id="S3.SS3.p2.10.m10.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS3.p2.10.m10.1a"><mi id="S3.SS3.p2.10.m10.1.1" xref="S3.SS3.p2.10.m10.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.10.m10.1b"><ci id="S3.SS3.p2.10.m10.1.1.cmml" xref="S3.SS3.p2.10.m10.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.10.m10.1c">\theta</annotation></semantics></math>) and distance (<math id="S3.SS3.p2.11.m11.1" class="ltx_Math" alttext="\rho" display="inline"><semantics id="S3.SS3.p2.11.m11.1a"><mi id="S3.SS3.p2.11.m11.1.1" xref="S3.SS3.p2.11.m11.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.11.m11.1b"><ci id="S3.SS3.p2.11.m11.1.1.cmml" xref="S3.SS3.p2.11.m11.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.11.m11.1c">\rho</annotation></semantics></math>), providing two disentangled factors to represent spatial relationships.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para ltx_noindent">
<p id="S3.SS3.p3.5" class="ltx_p">An essential step and challenge of graph CNNs is the definition of a patch operator describing the influence of each neighbouring node that is robust to irregular neighbourhood structures. Monti et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> propose to do so using a set of <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><mi id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">K</annotation></semantics></math> Gaussian kernels of learnable means and covariances, where the mean is interpretable as a direction and distance in pseudo coordinates. We obtain a kernel weight <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="w_{k}(\mathbf{u})" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><mrow id="S3.SS3.p3.2.m2.1.2" xref="S3.SS3.p3.2.m2.1.2.cmml"><msub id="S3.SS3.p3.2.m2.1.2.2" xref="S3.SS3.p3.2.m2.1.2.2.cmml"><mi id="S3.SS3.p3.2.m2.1.2.2.2" xref="S3.SS3.p3.2.m2.1.2.2.2.cmml">w</mi><mi id="S3.SS3.p3.2.m2.1.2.2.3" xref="S3.SS3.p3.2.m2.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p3.2.m2.1.2.1" xref="S3.SS3.p3.2.m2.1.2.1.cmml">​</mo><mrow id="S3.SS3.p3.2.m2.1.2.3.2" xref="S3.SS3.p3.2.m2.1.2.cmml"><mo stretchy="false" id="S3.SS3.p3.2.m2.1.2.3.2.1" xref="S3.SS3.p3.2.m2.1.2.cmml">(</mo><mi id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">𝐮</mi><mo stretchy="false" id="S3.SS3.p3.2.m2.1.2.3.2.2" xref="S3.SS3.p3.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.2.cmml" xref="S3.SS3.p3.2.m2.1.2"><times id="S3.SS3.p3.2.m2.1.2.1.cmml" xref="S3.SS3.p3.2.m2.1.2.1"></times><apply id="S3.SS3.p3.2.m2.1.2.2.cmml" xref="S3.SS3.p3.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.2.2.1.cmml" xref="S3.SS3.p3.2.m2.1.2.2">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.2.2.2.cmml" xref="S3.SS3.p3.2.m2.1.2.2.2">𝑤</ci><ci id="S3.SS3.p3.2.m2.1.2.2.3.cmml" xref="S3.SS3.p3.2.m2.1.2.2.3">𝑘</ci></apply><ci id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">𝐮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">w_{k}(\mathbf{u})</annotation></semantics></math> for each <math id="S3.SS3.p3.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p3.3.m3.1a"><mi id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><ci id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">k</annotation></semantics></math>, such that the patch operator is defined at kernel <math id="S3.SS3.p3.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p3.4.m4.1a"><mi id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><ci id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">k</annotation></semantics></math> for node <math id="S3.SS3.p3.5.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p3.5.m5.1a"><mi id="S3.SS3.p3.5.m5.1.1" xref="S3.SS3.p3.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.1b"><ci id="S3.SS3.p3.5.m5.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.1c">i</annotation></semantics></math> as:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.10" class="ltx_Math" alttext="\mathbf{f}_{k}(i)=\sum_{j\in\mathcal{N}(i)}{w_{k}(\mathbf{u}(i,j))}\mathbf{v}_{j},\qquad k=1,2,...,K" display="block"><semantics id="S3.E3.m1.10a"><mrow id="S3.E3.m1.10.10.2" xref="S3.E3.m1.10.10.3.cmml"><mrow id="S3.E3.m1.9.9.1.1" xref="S3.E3.m1.9.9.1.1.cmml"><mrow id="S3.E3.m1.9.9.1.1.3" xref="S3.E3.m1.9.9.1.1.3.cmml"><msub id="S3.E3.m1.9.9.1.1.3.2" xref="S3.E3.m1.9.9.1.1.3.2.cmml"><mi id="S3.E3.m1.9.9.1.1.3.2.2" xref="S3.E3.m1.9.9.1.1.3.2.2.cmml">𝐟</mi><mi id="S3.E3.m1.9.9.1.1.3.2.3" xref="S3.E3.m1.9.9.1.1.3.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.9.9.1.1.3.1" xref="S3.E3.m1.9.9.1.1.3.1.cmml">​</mo><mrow id="S3.E3.m1.9.9.1.1.3.3.2" xref="S3.E3.m1.9.9.1.1.3.cmml"><mo stretchy="false" id="S3.E3.m1.9.9.1.1.3.3.2.1" xref="S3.E3.m1.9.9.1.1.3.cmml">(</mo><mi id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">i</mi><mo stretchy="false" id="S3.E3.m1.9.9.1.1.3.3.2.2" xref="S3.E3.m1.9.9.1.1.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E3.m1.9.9.1.1.2" xref="S3.E3.m1.9.9.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.9.9.1.1.1" xref="S3.E3.m1.9.9.1.1.1.cmml"><munder id="S3.E3.m1.9.9.1.1.1.2" xref="S3.E3.m1.9.9.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E3.m1.9.9.1.1.1.2.2" xref="S3.E3.m1.9.9.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.1.1.1.3.cmml">j</mi><mo id="S3.E3.m1.1.1.1.2" xref="S3.E3.m1.1.1.1.2.cmml">∈</mo><mrow id="S3.E3.m1.1.1.1.4" xref="S3.E3.m1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.1.1.4.2" xref="S3.E3.m1.1.1.1.4.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.4.1" xref="S3.E3.m1.1.1.1.4.1.cmml">​</mo><mrow id="S3.E3.m1.1.1.1.4.3.2" xref="S3.E3.m1.1.1.1.4.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.4.3.2.1" xref="S3.E3.m1.1.1.1.4.cmml">(</mo><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.E3.m1.1.1.1.4.3.2.2" xref="S3.E3.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></munder><mrow id="S3.E3.m1.9.9.1.1.1.1" xref="S3.E3.m1.9.9.1.1.1.1.cmml"><msub id="S3.E3.m1.9.9.1.1.1.1.3" xref="S3.E3.m1.9.9.1.1.1.1.3.cmml"><mi id="S3.E3.m1.9.9.1.1.1.1.3.2" xref="S3.E3.m1.9.9.1.1.1.1.3.2.cmml">w</mi><mi id="S3.E3.m1.9.9.1.1.1.1.3.3" xref="S3.E3.m1.9.9.1.1.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.9.9.1.1.1.1.2" xref="S3.E3.m1.9.9.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.9.9.1.1.1.1.1.1" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.9.9.1.1.1.1.1.1.2" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.9.9.1.1.1.1.1.1.1" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.9.9.1.1.1.1.1.1.1.2" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1.2.cmml">𝐮</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.9.9.1.1.1.1.1.1.1.1" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E3.m1.9.9.1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.E3.m1.9.9.1.1.1.1.1.1.1.3.2.1" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">i</mi><mo id="S3.E3.m1.9.9.1.1.1.1.1.1.1.3.2.2" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml">j</mi><mo stretchy="false" id="S3.E3.m1.9.9.1.1.1.1.1.1.1.3.2.3" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E3.m1.9.9.1.1.1.1.1.1.3" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E3.m1.9.9.1.1.1.1.2a" xref="S3.E3.m1.9.9.1.1.1.1.2.cmml">​</mo><msub id="S3.E3.m1.9.9.1.1.1.1.4" xref="S3.E3.m1.9.9.1.1.1.1.4.cmml"><mi id="S3.E3.m1.9.9.1.1.1.1.4.2" xref="S3.E3.m1.9.9.1.1.1.1.4.2.cmml">𝐯</mi><mi id="S3.E3.m1.9.9.1.1.1.1.4.3" xref="S3.E3.m1.9.9.1.1.1.1.4.3.cmml">j</mi></msub></mrow></mrow></mrow><mo rspace="2.167em" id="S3.E3.m1.10.10.2.3" xref="S3.E3.m1.10.10.3a.cmml">,</mo><mrow id="S3.E3.m1.10.10.2.2" xref="S3.E3.m1.10.10.2.2.cmml"><mi id="S3.E3.m1.10.10.2.2.2" xref="S3.E3.m1.10.10.2.2.2.cmml">k</mi><mo id="S3.E3.m1.10.10.2.2.1" xref="S3.E3.m1.10.10.2.2.1.cmml">=</mo><mrow id="S3.E3.m1.10.10.2.2.3.2" xref="S3.E3.m1.10.10.2.2.3.1.cmml"><mn id="S3.E3.m1.5.5" xref="S3.E3.m1.5.5.cmml">1</mn><mo id="S3.E3.m1.10.10.2.2.3.2.1" xref="S3.E3.m1.10.10.2.2.3.1.cmml">,</mo><mn id="S3.E3.m1.6.6" xref="S3.E3.m1.6.6.cmml">2</mn><mo id="S3.E3.m1.10.10.2.2.3.2.2" xref="S3.E3.m1.10.10.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.E3.m1.7.7" xref="S3.E3.m1.7.7.cmml">…</mi><mo id="S3.E3.m1.10.10.2.2.3.2.3" xref="S3.E3.m1.10.10.2.2.3.1.cmml">,</mo><mi id="S3.E3.m1.8.8" xref="S3.E3.m1.8.8.cmml">K</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.10b"><apply id="S3.E3.m1.10.10.3.cmml" xref="S3.E3.m1.10.10.2"><csymbol cd="ambiguous" id="S3.E3.m1.10.10.3a.cmml" xref="S3.E3.m1.10.10.2.3">formulae-sequence</csymbol><apply id="S3.E3.m1.9.9.1.1.cmml" xref="S3.E3.m1.9.9.1.1"><eq id="S3.E3.m1.9.9.1.1.2.cmml" xref="S3.E3.m1.9.9.1.1.2"></eq><apply id="S3.E3.m1.9.9.1.1.3.cmml" xref="S3.E3.m1.9.9.1.1.3"><times id="S3.E3.m1.9.9.1.1.3.1.cmml" xref="S3.E3.m1.9.9.1.1.3.1"></times><apply id="S3.E3.m1.9.9.1.1.3.2.cmml" xref="S3.E3.m1.9.9.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.1.1.3.2.1.cmml" xref="S3.E3.m1.9.9.1.1.3.2">subscript</csymbol><ci id="S3.E3.m1.9.9.1.1.3.2.2.cmml" xref="S3.E3.m1.9.9.1.1.3.2.2">𝐟</ci><ci id="S3.E3.m1.9.9.1.1.3.2.3.cmml" xref="S3.E3.m1.9.9.1.1.3.2.3">𝑘</ci></apply><ci id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2">𝑖</ci></apply><apply id="S3.E3.m1.9.9.1.1.1.cmml" xref="S3.E3.m1.9.9.1.1.1"><apply id="S3.E3.m1.9.9.1.1.1.2.cmml" xref="S3.E3.m1.9.9.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.1.1.1.2.1.cmml" xref="S3.E3.m1.9.9.1.1.1.2">subscript</csymbol><sum id="S3.E3.m1.9.9.1.1.1.2.2.cmml" xref="S3.E3.m1.9.9.1.1.1.2.2"></sum><apply id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><in id="S3.E3.m1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.2"></in><ci id="S3.E3.m1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.3">𝑗</ci><apply id="S3.E3.m1.1.1.1.4.cmml" xref="S3.E3.m1.1.1.1.4"><times id="S3.E3.m1.1.1.1.4.1.cmml" xref="S3.E3.m1.1.1.1.4.1"></times><ci id="S3.E3.m1.1.1.1.4.2.cmml" xref="S3.E3.m1.1.1.1.4.2">𝒩</ci><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑖</ci></apply></apply></apply><apply id="S3.E3.m1.9.9.1.1.1.1.cmml" xref="S3.E3.m1.9.9.1.1.1.1"><times id="S3.E3.m1.9.9.1.1.1.1.2.cmml" xref="S3.E3.m1.9.9.1.1.1.1.2"></times><apply id="S3.E3.m1.9.9.1.1.1.1.3.cmml" xref="S3.E3.m1.9.9.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.1.1.1.1.3.1.cmml" xref="S3.E3.m1.9.9.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.9.9.1.1.1.1.3.2.cmml" xref="S3.E3.m1.9.9.1.1.1.1.3.2">𝑤</ci><ci id="S3.E3.m1.9.9.1.1.1.1.3.3.cmml" xref="S3.E3.m1.9.9.1.1.1.1.3.3">𝑘</ci></apply><apply id="S3.E3.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.9.9.1.1.1.1.1.1"><times id="S3.E3.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1.1"></times><ci id="S3.E3.m1.9.9.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1.2">𝐮</ci><interval closure="open" id="S3.E3.m1.9.9.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1.3.2"><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">𝑖</ci><ci id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.4">𝑗</ci></interval></apply><apply id="S3.E3.m1.9.9.1.1.1.1.4.cmml" xref="S3.E3.m1.9.9.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.1.1.1.1.4.1.cmml" xref="S3.E3.m1.9.9.1.1.1.1.4">subscript</csymbol><ci id="S3.E3.m1.9.9.1.1.1.1.4.2.cmml" xref="S3.E3.m1.9.9.1.1.1.1.4.2">𝐯</ci><ci id="S3.E3.m1.9.9.1.1.1.1.4.3.cmml" xref="S3.E3.m1.9.9.1.1.1.1.4.3">𝑗</ci></apply></apply></apply></apply><apply id="S3.E3.m1.10.10.2.2.cmml" xref="S3.E3.m1.10.10.2.2"><eq id="S3.E3.m1.10.10.2.2.1.cmml" xref="S3.E3.m1.10.10.2.2.1"></eq><ci id="S3.E3.m1.10.10.2.2.2.cmml" xref="S3.E3.m1.10.10.2.2.2">𝑘</ci><list id="S3.E3.m1.10.10.2.2.3.1.cmml" xref="S3.E3.m1.10.10.2.2.3.2"><cn type="integer" id="S3.E3.m1.5.5.cmml" xref="S3.E3.m1.5.5">1</cn><cn type="integer" id="S3.E3.m1.6.6.cmml" xref="S3.E3.m1.6.6">2</cn><ci id="S3.E3.m1.7.7.cmml" xref="S3.E3.m1.7.7">…</ci><ci id="S3.E3.m1.8.8.cmml" xref="S3.E3.m1.8.8">𝐾</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.10c">\mathbf{f}_{k}(i)=\sum_{j\in\mathcal{N}(i)}{w_{k}(\mathbf{u}(i,j))}\mathbf{v}_{j},\qquad k=1,2,...,K</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p3.9" class="ltx_p">where <math id="S3.SS3.p3.6.m1.1" class="ltx_Math" alttext="\mathbf{f}_{n}(i)\in\mathbb{R}^{d_{v}}" display="inline"><semantics id="S3.SS3.p3.6.m1.1a"><mrow id="S3.SS3.p3.6.m1.1.2" xref="S3.SS3.p3.6.m1.1.2.cmml"><mrow id="S3.SS3.p3.6.m1.1.2.2" xref="S3.SS3.p3.6.m1.1.2.2.cmml"><msub id="S3.SS3.p3.6.m1.1.2.2.2" xref="S3.SS3.p3.6.m1.1.2.2.2.cmml"><mi id="S3.SS3.p3.6.m1.1.2.2.2.2" xref="S3.SS3.p3.6.m1.1.2.2.2.2.cmml">𝐟</mi><mi id="S3.SS3.p3.6.m1.1.2.2.2.3" xref="S3.SS3.p3.6.m1.1.2.2.2.3.cmml">n</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p3.6.m1.1.2.2.1" xref="S3.SS3.p3.6.m1.1.2.2.1.cmml">​</mo><mrow id="S3.SS3.p3.6.m1.1.2.2.3.2" xref="S3.SS3.p3.6.m1.1.2.2.cmml"><mo stretchy="false" id="S3.SS3.p3.6.m1.1.2.2.3.2.1" xref="S3.SS3.p3.6.m1.1.2.2.cmml">(</mo><mi id="S3.SS3.p3.6.m1.1.1" xref="S3.SS3.p3.6.m1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS3.p3.6.m1.1.2.2.3.2.2" xref="S3.SS3.p3.6.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p3.6.m1.1.2.1" xref="S3.SS3.p3.6.m1.1.2.1.cmml">∈</mo><msup id="S3.SS3.p3.6.m1.1.2.3" xref="S3.SS3.p3.6.m1.1.2.3.cmml"><mi id="S3.SS3.p3.6.m1.1.2.3.2" xref="S3.SS3.p3.6.m1.1.2.3.2.cmml">ℝ</mi><msub id="S3.SS3.p3.6.m1.1.2.3.3" xref="S3.SS3.p3.6.m1.1.2.3.3.cmml"><mi id="S3.SS3.p3.6.m1.1.2.3.3.2" xref="S3.SS3.p3.6.m1.1.2.3.3.2.cmml">d</mi><mi id="S3.SS3.p3.6.m1.1.2.3.3.3" xref="S3.SS3.p3.6.m1.1.2.3.3.3.cmml">v</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m1.1b"><apply id="S3.SS3.p3.6.m1.1.2.cmml" xref="S3.SS3.p3.6.m1.1.2"><in id="S3.SS3.p3.6.m1.1.2.1.cmml" xref="S3.SS3.p3.6.m1.1.2.1"></in><apply id="S3.SS3.p3.6.m1.1.2.2.cmml" xref="S3.SS3.p3.6.m1.1.2.2"><times id="S3.SS3.p3.6.m1.1.2.2.1.cmml" xref="S3.SS3.p3.6.m1.1.2.2.1"></times><apply id="S3.SS3.p3.6.m1.1.2.2.2.cmml" xref="S3.SS3.p3.6.m1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m1.1.2.2.2.1.cmml" xref="S3.SS3.p3.6.m1.1.2.2.2">subscript</csymbol><ci id="S3.SS3.p3.6.m1.1.2.2.2.2.cmml" xref="S3.SS3.p3.6.m1.1.2.2.2.2">𝐟</ci><ci id="S3.SS3.p3.6.m1.1.2.2.2.3.cmml" xref="S3.SS3.p3.6.m1.1.2.2.2.3">𝑛</ci></apply><ci id="S3.SS3.p3.6.m1.1.1.cmml" xref="S3.SS3.p3.6.m1.1.1">𝑖</ci></apply><apply id="S3.SS3.p3.6.m1.1.2.3.cmml" xref="S3.SS3.p3.6.m1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m1.1.2.3.1.cmml" xref="S3.SS3.p3.6.m1.1.2.3">superscript</csymbol><ci id="S3.SS3.p3.6.m1.1.2.3.2.cmml" xref="S3.SS3.p3.6.m1.1.2.3.2">ℝ</ci><apply id="S3.SS3.p3.6.m1.1.2.3.3.cmml" xref="S3.SS3.p3.6.m1.1.2.3.3"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m1.1.2.3.3.1.cmml" xref="S3.SS3.p3.6.m1.1.2.3.3">subscript</csymbol><ci id="S3.SS3.p3.6.m1.1.2.3.3.2.cmml" xref="S3.SS3.p3.6.m1.1.2.3.3.2">𝑑</ci><ci id="S3.SS3.p3.6.m1.1.2.3.3.3.cmml" xref="S3.SS3.p3.6.m1.1.2.3.3.3">𝑣</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m1.1c">\mathbf{f}_{n}(i)\in\mathbb{R}^{d_{v}}</annotation></semantics></math> and <math id="S3.SS3.p3.7.m2.1" class="ltx_Math" alttext="\mathcal{N}(i)" display="inline"><semantics id="S3.SS3.p3.7.m2.1a"><mrow id="S3.SS3.p3.7.m2.1.2" xref="S3.SS3.p3.7.m2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.7.m2.1.2.2" xref="S3.SS3.p3.7.m2.1.2.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.7.m2.1.2.1" xref="S3.SS3.p3.7.m2.1.2.1.cmml">​</mo><mrow id="S3.SS3.p3.7.m2.1.2.3.2" xref="S3.SS3.p3.7.m2.1.2.cmml"><mo stretchy="false" id="S3.SS3.p3.7.m2.1.2.3.2.1" xref="S3.SS3.p3.7.m2.1.2.cmml">(</mo><mi id="S3.SS3.p3.7.m2.1.1" xref="S3.SS3.p3.7.m2.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS3.p3.7.m2.1.2.3.2.2" xref="S3.SS3.p3.7.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m2.1b"><apply id="S3.SS3.p3.7.m2.1.2.cmml" xref="S3.SS3.p3.7.m2.1.2"><times id="S3.SS3.p3.7.m2.1.2.1.cmml" xref="S3.SS3.p3.7.m2.1.2.1"></times><ci id="S3.SS3.p3.7.m2.1.2.2.cmml" xref="S3.SS3.p3.7.m2.1.2.2">𝒩</ci><ci id="S3.SS3.p3.7.m2.1.1.cmml" xref="S3.SS3.p3.7.m2.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m2.1c">\mathcal{N}(i)</annotation></semantics></math> denotes the neighbourhood of vertex <math id="S3.SS3.p3.8.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p3.8.m3.1a"><mi id="S3.SS3.p3.8.m3.1.1" xref="S3.SS3.p3.8.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.8.m3.1b"><ci id="S3.SS3.p3.8.m3.1.1.cmml" xref="S3.SS3.p3.8.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.8.m3.1c">i</annotation></semantics></math> as described in Eq. <a href="#S3.E2" title="In 3.2 Graph learner ‣ 3 Methods ‣ Learning Conditioned Graph Structures for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Considering a given vertex <math id="S3.SS3.p3.9.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p3.9.m4.1a"><mi id="S3.SS3.p3.9.m4.1.1" xref="S3.SS3.p3.9.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.9.m4.1b"><ci id="S3.SS3.p3.9.m4.1.1.cmml" xref="S3.SS3.p3.9.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.9.m4.1c">i</annotation></semantics></math>, we can think of the output of the patch operator as a weighted sum of the neighbouring features, where the set of Gaussian kernels describe the influence of each neighbour on the output of the convolution operation.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para ltx_noindent">
<p id="S3.SS3.p4.1" class="ltx_p">We adjust the patch operator so that it includes an additional weighting factor conditioned on the produced graph edges:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.5" class="ltx_Math" alttext="\mathbf{f}_{k}(i)=\sum_{j\in\mathcal{N}(i)}{w_{k}(\mathbf{u}(i,j))}\mathbf{v}_{j}\alpha_{ij}" display="block"><semantics id="S3.E4.m1.5a"><mrow id="S3.E4.m1.5.5" xref="S3.E4.m1.5.5.cmml"><mrow id="S3.E4.m1.5.5.3" xref="S3.E4.m1.5.5.3.cmml"><msub id="S3.E4.m1.5.5.3.2" xref="S3.E4.m1.5.5.3.2.cmml"><mi id="S3.E4.m1.5.5.3.2.2" xref="S3.E4.m1.5.5.3.2.2.cmml">𝐟</mi><mi id="S3.E4.m1.5.5.3.2.3" xref="S3.E4.m1.5.5.3.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.5.5.3.1" xref="S3.E4.m1.5.5.3.1.cmml">​</mo><mrow id="S3.E4.m1.5.5.3.3.2" xref="S3.E4.m1.5.5.3.cmml"><mo stretchy="false" id="S3.E4.m1.5.5.3.3.2.1" xref="S3.E4.m1.5.5.3.cmml">(</mo><mi id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">i</mi><mo stretchy="false" id="S3.E4.m1.5.5.3.3.2.2" xref="S3.E4.m1.5.5.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E4.m1.5.5.2" xref="S3.E4.m1.5.5.2.cmml">=</mo><mrow id="S3.E4.m1.5.5.1" xref="S3.E4.m1.5.5.1.cmml"><munder id="S3.E4.m1.5.5.1.2" xref="S3.E4.m1.5.5.1.2.cmml"><mo movablelimits="false" id="S3.E4.m1.5.5.1.2.2" xref="S3.E4.m1.5.5.1.2.2.cmml">∑</mo><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.1.1.1.3.cmml">j</mi><mo id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.2.cmml">∈</mo><mrow id="S3.E4.m1.1.1.1.4" xref="S3.E4.m1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.4.2" xref="S3.E4.m1.1.1.1.4.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.4.1" xref="S3.E4.m1.1.1.1.4.1.cmml">​</mo><mrow id="S3.E4.m1.1.1.1.4.3.2" xref="S3.E4.m1.1.1.1.4.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.4.3.2.1" xref="S3.E4.m1.1.1.1.4.cmml">(</mo><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.E4.m1.1.1.1.4.3.2.2" xref="S3.E4.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></munder><mrow id="S3.E4.m1.5.5.1.1" xref="S3.E4.m1.5.5.1.1.cmml"><msub id="S3.E4.m1.5.5.1.1.3" xref="S3.E4.m1.5.5.1.1.3.cmml"><mi id="S3.E4.m1.5.5.1.1.3.2" xref="S3.E4.m1.5.5.1.1.3.2.cmml">w</mi><mi id="S3.E4.m1.5.5.1.1.3.3" xref="S3.E4.m1.5.5.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.5.5.1.1.2" xref="S3.E4.m1.5.5.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.5.5.1.1.1.1" xref="S3.E4.m1.5.5.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.5.5.1.1.1.1.2" xref="S3.E4.m1.5.5.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.5.5.1.1.1.1.1" xref="S3.E4.m1.5.5.1.1.1.1.1.cmml"><mi id="S3.E4.m1.5.5.1.1.1.1.1.2" xref="S3.E4.m1.5.5.1.1.1.1.1.2.cmml">𝐮</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.5.5.1.1.1.1.1.1" xref="S3.E4.m1.5.5.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E4.m1.5.5.1.1.1.1.1.3.2" xref="S3.E4.m1.5.5.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.E4.m1.5.5.1.1.1.1.1.3.2.1" xref="S3.E4.m1.5.5.1.1.1.1.1.3.1.cmml">(</mo><mi id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml">i</mi><mo id="S3.E4.m1.5.5.1.1.1.1.1.3.2.2" xref="S3.E4.m1.5.5.1.1.1.1.1.3.1.cmml">,</mo><mi id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml">j</mi><mo stretchy="false" id="S3.E4.m1.5.5.1.1.1.1.1.3.2.3" xref="S3.E4.m1.5.5.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E4.m1.5.5.1.1.1.1.3" xref="S3.E4.m1.5.5.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m1.5.5.1.1.2a" xref="S3.E4.m1.5.5.1.1.2.cmml">​</mo><msub id="S3.E4.m1.5.5.1.1.4" xref="S3.E4.m1.5.5.1.1.4.cmml"><mi id="S3.E4.m1.5.5.1.1.4.2" xref="S3.E4.m1.5.5.1.1.4.2.cmml">𝐯</mi><mi id="S3.E4.m1.5.5.1.1.4.3" xref="S3.E4.m1.5.5.1.1.4.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.5.5.1.1.2b" xref="S3.E4.m1.5.5.1.1.2.cmml">​</mo><msub id="S3.E4.m1.5.5.1.1.5" xref="S3.E4.m1.5.5.1.1.5.cmml"><mi id="S3.E4.m1.5.5.1.1.5.2" xref="S3.E4.m1.5.5.1.1.5.2.cmml">α</mi><mrow id="S3.E4.m1.5.5.1.1.5.3" xref="S3.E4.m1.5.5.1.1.5.3.cmml"><mi id="S3.E4.m1.5.5.1.1.5.3.2" xref="S3.E4.m1.5.5.1.1.5.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.5.5.1.1.5.3.1" xref="S3.E4.m1.5.5.1.1.5.3.1.cmml">​</mo><mi id="S3.E4.m1.5.5.1.1.5.3.3" xref="S3.E4.m1.5.5.1.1.5.3.3.cmml">j</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.5b"><apply id="S3.E4.m1.5.5.cmml" xref="S3.E4.m1.5.5"><eq id="S3.E4.m1.5.5.2.cmml" xref="S3.E4.m1.5.5.2"></eq><apply id="S3.E4.m1.5.5.3.cmml" xref="S3.E4.m1.5.5.3"><times id="S3.E4.m1.5.5.3.1.cmml" xref="S3.E4.m1.5.5.3.1"></times><apply id="S3.E4.m1.5.5.3.2.cmml" xref="S3.E4.m1.5.5.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.3.2.1.cmml" xref="S3.E4.m1.5.5.3.2">subscript</csymbol><ci id="S3.E4.m1.5.5.3.2.2.cmml" xref="S3.E4.m1.5.5.3.2.2">𝐟</ci><ci id="S3.E4.m1.5.5.3.2.3.cmml" xref="S3.E4.m1.5.5.3.2.3">𝑘</ci></apply><ci id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2">𝑖</ci></apply><apply id="S3.E4.m1.5.5.1.cmml" xref="S3.E4.m1.5.5.1"><apply id="S3.E4.m1.5.5.1.2.cmml" xref="S3.E4.m1.5.5.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.2.1.cmml" xref="S3.E4.m1.5.5.1.2">subscript</csymbol><sum id="S3.E4.m1.5.5.1.2.2.cmml" xref="S3.E4.m1.5.5.1.2.2"></sum><apply id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><in id="S3.E4.m1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.2"></in><ci id="S3.E4.m1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.3">𝑗</ci><apply id="S3.E4.m1.1.1.1.4.cmml" xref="S3.E4.m1.1.1.1.4"><times id="S3.E4.m1.1.1.1.4.1.cmml" xref="S3.E4.m1.1.1.1.4.1"></times><ci id="S3.E4.m1.1.1.1.4.2.cmml" xref="S3.E4.m1.1.1.1.4.2">𝒩</ci><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝑖</ci></apply></apply></apply><apply id="S3.E4.m1.5.5.1.1.cmml" xref="S3.E4.m1.5.5.1.1"><times id="S3.E4.m1.5.5.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.2"></times><apply id="S3.E4.m1.5.5.1.1.3.cmml" xref="S3.E4.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.3.1.cmml" xref="S3.E4.m1.5.5.1.1.3">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.3.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2">𝑤</ci><ci id="S3.E4.m1.5.5.1.1.3.3.cmml" xref="S3.E4.m1.5.5.1.1.3.3">𝑘</ci></apply><apply id="S3.E4.m1.5.5.1.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1"><times id="S3.E4.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.1"></times><ci id="S3.E4.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.2">𝐮</ci><interval closure="open" id="S3.E4.m1.5.5.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.3.2"><ci id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3">𝑖</ci><ci id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4">𝑗</ci></interval></apply><apply id="S3.E4.m1.5.5.1.1.4.cmml" xref="S3.E4.m1.5.5.1.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.4.1.cmml" xref="S3.E4.m1.5.5.1.1.4">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.4.2.cmml" xref="S3.E4.m1.5.5.1.1.4.2">𝐯</ci><ci id="S3.E4.m1.5.5.1.1.4.3.cmml" xref="S3.E4.m1.5.5.1.1.4.3">𝑗</ci></apply><apply id="S3.E4.m1.5.5.1.1.5.cmml" xref="S3.E4.m1.5.5.1.1.5"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.5.1.cmml" xref="S3.E4.m1.5.5.1.1.5">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.5.2.cmml" xref="S3.E4.m1.5.5.1.1.5.2">𝛼</ci><apply id="S3.E4.m1.5.5.1.1.5.3.cmml" xref="S3.E4.m1.5.5.1.1.5.3"><times id="S3.E4.m1.5.5.1.1.5.3.1.cmml" xref="S3.E4.m1.5.5.1.1.5.3.1"></times><ci id="S3.E4.m1.5.5.1.1.5.3.2.cmml" xref="S3.E4.m1.5.5.1.1.5.3.2">𝑖</ci><ci id="S3.E4.m1.5.5.1.1.5.3.3.cmml" xref="S3.E4.m1.5.5.1.1.5.3.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.5c">\mathbf{f}_{k}(i)=\sum_{j\in\mathcal{N}(i)}{w_{k}(\mathbf{u}(i,j))}\mathbf{v}_{j}\alpha_{ij}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.p5" class="ltx_para ltx_noindent">
<p id="S3.SS3.p5.3" class="ltx_p">with <math id="S3.SS3.p5.1.m1.1" class="ltx_Math" alttext="\alpha_{ij}=s(\mathbf{a}_{i})_{j}" display="inline"><semantics id="S3.SS3.p5.1.m1.1a"><mrow id="S3.SS3.p5.1.m1.1.1" xref="S3.SS3.p5.1.m1.1.1.cmml"><msub id="S3.SS3.p5.1.m1.1.1.3" xref="S3.SS3.p5.1.m1.1.1.3.cmml"><mi id="S3.SS3.p5.1.m1.1.1.3.2" xref="S3.SS3.p5.1.m1.1.1.3.2.cmml">α</mi><mrow id="S3.SS3.p5.1.m1.1.1.3.3" xref="S3.SS3.p5.1.m1.1.1.3.3.cmml"><mi id="S3.SS3.p5.1.m1.1.1.3.3.2" xref="S3.SS3.p5.1.m1.1.1.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.1.m1.1.1.3.3.1" xref="S3.SS3.p5.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S3.SS3.p5.1.m1.1.1.3.3.3" xref="S3.SS3.p5.1.m1.1.1.3.3.3.cmml">j</mi></mrow></msub><mo id="S3.SS3.p5.1.m1.1.1.2" xref="S3.SS3.p5.1.m1.1.1.2.cmml">=</mo><mrow id="S3.SS3.p5.1.m1.1.1.1" xref="S3.SS3.p5.1.m1.1.1.1.cmml"><mi id="S3.SS3.p5.1.m1.1.1.1.3" xref="S3.SS3.p5.1.m1.1.1.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.1.m1.1.1.1.2" xref="S3.SS3.p5.1.m1.1.1.1.2.cmml">​</mo><msub id="S3.SS3.p5.1.m1.1.1.1.1" xref="S3.SS3.p5.1.m1.1.1.1.1.cmml"><mrow id="S3.SS3.p5.1.m1.1.1.1.1.1.1" xref="S3.SS3.p5.1.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p5.1.m1.1.1.1.1.1.1.2" xref="S3.SS3.p5.1.m1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p5.1.m1.1.1.1.1.1.1.1" xref="S3.SS3.p5.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p5.1.m1.1.1.1.1.1.1.1.2" xref="S3.SS3.p5.1.m1.1.1.1.1.1.1.1.2.cmml">𝐚</mi><mi id="S3.SS3.p5.1.m1.1.1.1.1.1.1.1.3" xref="S3.SS3.p5.1.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS3.p5.1.m1.1.1.1.1.1.1.3" xref="S3.SS3.p5.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.SS3.p5.1.m1.1.1.1.1.3" xref="S3.SS3.p5.1.m1.1.1.1.1.3.cmml">j</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.1b"><apply id="S3.SS3.p5.1.m1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1"><eq id="S3.SS3.p5.1.m1.1.1.2.cmml" xref="S3.SS3.p5.1.m1.1.1.2"></eq><apply id="S3.SS3.p5.1.m1.1.1.3.cmml" xref="S3.SS3.p5.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p5.1.m1.1.1.3.1.cmml" xref="S3.SS3.p5.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS3.p5.1.m1.1.1.3.2.cmml" xref="S3.SS3.p5.1.m1.1.1.3.2">𝛼</ci><apply id="S3.SS3.p5.1.m1.1.1.3.3.cmml" xref="S3.SS3.p5.1.m1.1.1.3.3"><times id="S3.SS3.p5.1.m1.1.1.3.3.1.cmml" xref="S3.SS3.p5.1.m1.1.1.3.3.1"></times><ci id="S3.SS3.p5.1.m1.1.1.3.3.2.cmml" xref="S3.SS3.p5.1.m1.1.1.3.3.2">𝑖</ci><ci id="S3.SS3.p5.1.m1.1.1.3.3.3.cmml" xref="S3.SS3.p5.1.m1.1.1.3.3.3">𝑗</ci></apply></apply><apply id="S3.SS3.p5.1.m1.1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1.1"><times id="S3.SS3.p5.1.m1.1.1.1.2.cmml" xref="S3.SS3.p5.1.m1.1.1.1.2"></times><ci id="S3.SS3.p5.1.m1.1.1.1.3.cmml" xref="S3.SS3.p5.1.m1.1.1.1.3">𝑠</ci><apply id="S3.SS3.p5.1.m1.1.1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.1.m1.1.1.1.1.2.cmml" xref="S3.SS3.p5.1.m1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.p5.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p5.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p5.1.m1.1.1.1.1.1.1.1.2">𝐚</ci><ci id="S3.SS3.p5.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p5.1.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.SS3.p5.1.m1.1.1.1.1.3.cmml" xref="S3.SS3.p5.1.m1.1.1.1.1.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.1c">\alpha_{ij}=s(\mathbf{a}_{i})_{j}</annotation></semantics></math> where <math id="S3.SS3.p5.2.m2.1" class="ltx_math_unparsed" alttext="s(.)_{j}" display="inline"><semantics id="S3.SS3.p5.2.m2.1a"><mrow id="S3.SS3.p5.2.m2.1b"><mi id="S3.SS3.p5.2.m2.1.1">s</mi><msub id="S3.SS3.p5.2.m2.1.2"><mrow id="S3.SS3.p5.2.m2.1.2.2"><mo stretchy="false" id="S3.SS3.p5.2.m2.1.2.2.1">(</mo><mo lspace="0em" rspace="0.167em" id="S3.SS3.p5.2.m2.1.2.2.2">.</mo><mo stretchy="false" id="S3.SS3.p5.2.m2.1.2.2.3">)</mo></mrow><mi id="S3.SS3.p5.2.m2.1.2.3">j</mi></msub></mrow><annotation encoding="application/x-tex" id="S3.SS3.p5.2.m2.1c">s(.)_{j}</annotation></semantics></math> is the <math id="S3.SS3.p5.3.m3.1" class="ltx_Math" alttext="j^{th}" display="inline"><semantics id="S3.SS3.p5.3.m3.1a"><msup id="S3.SS3.p5.3.m3.1.1" xref="S3.SS3.p5.3.m3.1.1.cmml"><mi id="S3.SS3.p5.3.m3.1.1.2" xref="S3.SS3.p5.3.m3.1.1.2.cmml">j</mi><mrow id="S3.SS3.p5.3.m3.1.1.3" xref="S3.SS3.p5.3.m3.1.1.3.cmml"><mi id="S3.SS3.p5.3.m3.1.1.3.2" xref="S3.SS3.p5.3.m3.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.3.m3.1.1.3.1" xref="S3.SS3.p5.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p5.3.m3.1.1.3.3" xref="S3.SS3.p5.3.m3.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.3.m3.1b"><apply id="S3.SS3.p5.3.m3.1.1.cmml" xref="S3.SS3.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.3.m3.1.1.1.cmml" xref="S3.SS3.p5.3.m3.1.1">superscript</csymbol><ci id="S3.SS3.p5.3.m3.1.1.2.cmml" xref="S3.SS3.p5.3.m3.1.1.2">𝑗</ci><apply id="S3.SS3.p5.3.m3.1.1.3.cmml" xref="S3.SS3.p5.3.m3.1.1.3"><times id="S3.SS3.p5.3.m3.1.1.3.1.cmml" xref="S3.SS3.p5.3.m3.1.1.3.1"></times><ci id="S3.SS3.p5.3.m3.1.1.3.2.cmml" xref="S3.SS3.p5.3.m3.1.1.3.2">𝑡</ci><ci id="S3.SS3.p5.3.m3.1.1.3.3.cmml" xref="S3.SS3.p5.3.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.3.m3.1c">j^{th}</annotation></semantics></math> element of a scaling function (defined here as a softmax of the selected adjacency matrix elements). This more general form means that the strength of messages passed between vertices can be weighted by information in addition to spatial orientation. For our use case, this can be interpreted as how much attention the network should pay to the relationship between two nodes in terms of answering a question. Thus the network learns to attend on the visual features in a pairwise manner conditioned on the question.</p>
</div>
<div id="S3.SS3.p6" class="ltx_para ltx_noindent">
<p id="S3.SS3.p6.1" class="ltx_p">Finally, we define the output of the convolution operation at vertex <math id="S3.SS3.p6.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p6.1.m1.1a"><mi id="S3.SS3.p6.1.m1.1.1" xref="S3.SS3.p6.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.1.m1.1b"><ci id="S3.SS3.p6.1.m1.1.1.cmml" xref="S3.SS3.p6.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.1.m1.1c">i</annotation></semantics></math> as a concatenation over the K kernels:</p>
</div>
<div id="S3.SS3.p7" class="ltx_para ltx_noindent">
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.1" class="ltx_Math" alttext="\mathbf{h}_{i}=\bigparallel_{k=1}^{K}{\mathbf{G}_{k}\mathbf{f}_{k}(i)}" display="block"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.2" xref="S3.E5.m1.1.2.cmml"><msub id="S3.E5.m1.1.2.2" xref="S3.E5.m1.1.2.2.cmml"><mi id="S3.E5.m1.1.2.2.2" xref="S3.E5.m1.1.2.2.2.cmml">𝐡</mi><mi id="S3.E5.m1.1.2.2.3" xref="S3.E5.m1.1.2.2.3.cmml">i</mi></msub><mo id="S3.E5.m1.1.2.1" xref="S3.E5.m1.1.2.1.cmml">=</mo><mrow id="S3.E5.m1.1.2.3" xref="S3.E5.m1.1.2.3.cmml"><munderover id="S3.E5.m1.1.2.3.1" xref="S3.E5.m1.1.2.3.1.cmml"><mo fence="false" largeop="true" movablelimits="false" rspace="0.167em" stretchy="false" id="S3.E5.m1.1.2.3.1.2.2" xref="S3.E5.m1.1.2.3.1.2.2.cmml">‖</mo><mrow id="S3.E5.m1.1.2.3.1.2.3" xref="S3.E5.m1.1.2.3.1.2.3.cmml"><mi id="S3.E5.m1.1.2.3.1.2.3.2" xref="S3.E5.m1.1.2.3.1.2.3.2.cmml">k</mi><mo id="S3.E5.m1.1.2.3.1.2.3.1" xref="S3.E5.m1.1.2.3.1.2.3.1.cmml">=</mo><mn id="S3.E5.m1.1.2.3.1.2.3.3" xref="S3.E5.m1.1.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E5.m1.1.2.3.1.3" xref="S3.E5.m1.1.2.3.1.3.cmml">K</mi></munderover><mrow id="S3.E5.m1.1.2.3.2" xref="S3.E5.m1.1.2.3.2.cmml"><msub id="S3.E5.m1.1.2.3.2.2" xref="S3.E5.m1.1.2.3.2.2.cmml"><mi id="S3.E5.m1.1.2.3.2.2.2" xref="S3.E5.m1.1.2.3.2.2.2.cmml">𝐆</mi><mi id="S3.E5.m1.1.2.3.2.2.3" xref="S3.E5.m1.1.2.3.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.2.3.2.1" xref="S3.E5.m1.1.2.3.2.1.cmml">​</mo><msub id="S3.E5.m1.1.2.3.2.3" xref="S3.E5.m1.1.2.3.2.3.cmml"><mi id="S3.E5.m1.1.2.3.2.3.2" xref="S3.E5.m1.1.2.3.2.3.2.cmml">𝐟</mi><mi id="S3.E5.m1.1.2.3.2.3.3" xref="S3.E5.m1.1.2.3.2.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.2.3.2.1a" xref="S3.E5.m1.1.2.3.2.1.cmml">​</mo><mrow id="S3.E5.m1.1.2.3.2.4.2" xref="S3.E5.m1.1.2.3.2.cmml"><mo stretchy="false" id="S3.E5.m1.1.2.3.2.4.2.1" xref="S3.E5.m1.1.2.3.2.cmml">(</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">i</mi><mo stretchy="false" id="S3.E5.m1.1.2.3.2.4.2.2" xref="S3.E5.m1.1.2.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.2.cmml" xref="S3.E5.m1.1.2"><eq id="S3.E5.m1.1.2.1.cmml" xref="S3.E5.m1.1.2.1"></eq><apply id="S3.E5.m1.1.2.2.cmml" xref="S3.E5.m1.1.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.2.2.1.cmml" xref="S3.E5.m1.1.2.2">subscript</csymbol><ci id="S3.E5.m1.1.2.2.2.cmml" xref="S3.E5.m1.1.2.2.2">𝐡</ci><ci id="S3.E5.m1.1.2.2.3.cmml" xref="S3.E5.m1.1.2.2.3">𝑖</ci></apply><apply id="S3.E5.m1.1.2.3.cmml" xref="S3.E5.m1.1.2.3"><apply id="S3.E5.m1.1.2.3.1.cmml" xref="S3.E5.m1.1.2.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.2.3.1.1.cmml" xref="S3.E5.m1.1.2.3.1">superscript</csymbol><apply id="S3.E5.m1.1.2.3.1.2.cmml" xref="S3.E5.m1.1.2.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.2.3.1.2.1.cmml" xref="S3.E5.m1.1.2.3.1">subscript</csymbol><ci id="S3.E5.m1.1.2.3.1.2.2.cmml" xref="S3.E5.m1.1.2.3.1.2.2">‖</ci><apply id="S3.E5.m1.1.2.3.1.2.3.cmml" xref="S3.E5.m1.1.2.3.1.2.3"><eq id="S3.E5.m1.1.2.3.1.2.3.1.cmml" xref="S3.E5.m1.1.2.3.1.2.3.1"></eq><ci id="S3.E5.m1.1.2.3.1.2.3.2.cmml" xref="S3.E5.m1.1.2.3.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E5.m1.1.2.3.1.2.3.3.cmml" xref="S3.E5.m1.1.2.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E5.m1.1.2.3.1.3.cmml" xref="S3.E5.m1.1.2.3.1.3">𝐾</ci></apply><apply id="S3.E5.m1.1.2.3.2.cmml" xref="S3.E5.m1.1.2.3.2"><times id="S3.E5.m1.1.2.3.2.1.cmml" xref="S3.E5.m1.1.2.3.2.1"></times><apply id="S3.E5.m1.1.2.3.2.2.cmml" xref="S3.E5.m1.1.2.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.2.3.2.2.1.cmml" xref="S3.E5.m1.1.2.3.2.2">subscript</csymbol><ci id="S3.E5.m1.1.2.3.2.2.2.cmml" xref="S3.E5.m1.1.2.3.2.2.2">𝐆</ci><ci id="S3.E5.m1.1.2.3.2.2.3.cmml" xref="S3.E5.m1.1.2.3.2.2.3">𝑘</ci></apply><apply id="S3.E5.m1.1.2.3.2.3.cmml" xref="S3.E5.m1.1.2.3.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.2.3.2.3.1.cmml" xref="S3.E5.m1.1.2.3.2.3">subscript</csymbol><ci id="S3.E5.m1.1.2.3.2.3.2.cmml" xref="S3.E5.m1.1.2.3.2.3.2">𝐟</ci><ci id="S3.E5.m1.1.2.3.2.3.3.cmml" xref="S3.E5.m1.1.2.3.2.3.3">𝑘</ci></apply><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\mathbf{h}_{i}=\bigparallel_{k=1}^{K}{\mathbf{G}_{k}\mathbf{f}_{k}(i)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.p8" class="ltx_para ltx_noindent">
<p id="S3.SS3.p8.3" class="ltx_p">where each <math id="S3.SS3.p8.1.m1.1" class="ltx_Math" alttext="\mathbf{G}_{k}\in\mathbb{R}^{\frac{d_{h}}{K}\times d_{v}}" display="inline"><semantics id="S3.SS3.p8.1.m1.1a"><mrow id="S3.SS3.p8.1.m1.1.1" xref="S3.SS3.p8.1.m1.1.1.cmml"><msub id="S3.SS3.p8.1.m1.1.1.2" xref="S3.SS3.p8.1.m1.1.1.2.cmml"><mi id="S3.SS3.p8.1.m1.1.1.2.2" xref="S3.SS3.p8.1.m1.1.1.2.2.cmml">𝐆</mi><mi id="S3.SS3.p8.1.m1.1.1.2.3" xref="S3.SS3.p8.1.m1.1.1.2.3.cmml">k</mi></msub><mo id="S3.SS3.p8.1.m1.1.1.1" xref="S3.SS3.p8.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.p8.1.m1.1.1.3" xref="S3.SS3.p8.1.m1.1.1.3.cmml"><mi id="S3.SS3.p8.1.m1.1.1.3.2" xref="S3.SS3.p8.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p8.1.m1.1.1.3.3" xref="S3.SS3.p8.1.m1.1.1.3.3.cmml"><mfrac id="S3.SS3.p8.1.m1.1.1.3.3.2" xref="S3.SS3.p8.1.m1.1.1.3.3.2.cmml"><msub id="S3.SS3.p8.1.m1.1.1.3.3.2.2" xref="S3.SS3.p8.1.m1.1.1.3.3.2.2.cmml"><mi id="S3.SS3.p8.1.m1.1.1.3.3.2.2.2" xref="S3.SS3.p8.1.m1.1.1.3.3.2.2.2.cmml">d</mi><mi id="S3.SS3.p8.1.m1.1.1.3.3.2.2.3" xref="S3.SS3.p8.1.m1.1.1.3.3.2.2.3.cmml">h</mi></msub><mi id="S3.SS3.p8.1.m1.1.1.3.3.2.3" xref="S3.SS3.p8.1.m1.1.1.3.3.2.3.cmml">K</mi></mfrac><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p8.1.m1.1.1.3.3.1" xref="S3.SS3.p8.1.m1.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.p8.1.m1.1.1.3.3.3" xref="S3.SS3.p8.1.m1.1.1.3.3.3.cmml"><mi id="S3.SS3.p8.1.m1.1.1.3.3.3.2" xref="S3.SS3.p8.1.m1.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS3.p8.1.m1.1.1.3.3.3.3" xref="S3.SS3.p8.1.m1.1.1.3.3.3.3.cmml">v</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.1.m1.1b"><apply id="S3.SS3.p8.1.m1.1.1.cmml" xref="S3.SS3.p8.1.m1.1.1"><in id="S3.SS3.p8.1.m1.1.1.1.cmml" xref="S3.SS3.p8.1.m1.1.1.1"></in><apply id="S3.SS3.p8.1.m1.1.1.2.cmml" xref="S3.SS3.p8.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p8.1.m1.1.1.2.1.cmml" xref="S3.SS3.p8.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS3.p8.1.m1.1.1.2.2.cmml" xref="S3.SS3.p8.1.m1.1.1.2.2">𝐆</ci><ci id="S3.SS3.p8.1.m1.1.1.2.3.cmml" xref="S3.SS3.p8.1.m1.1.1.2.3">𝑘</ci></apply><apply id="S3.SS3.p8.1.m1.1.1.3.cmml" xref="S3.SS3.p8.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p8.1.m1.1.1.3.1.cmml" xref="S3.SS3.p8.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.p8.1.m1.1.1.3.2.cmml" xref="S3.SS3.p8.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS3.p8.1.m1.1.1.3.3.cmml" xref="S3.SS3.p8.1.m1.1.1.3.3"><times id="S3.SS3.p8.1.m1.1.1.3.3.1.cmml" xref="S3.SS3.p8.1.m1.1.1.3.3.1"></times><apply id="S3.SS3.p8.1.m1.1.1.3.3.2.cmml" xref="S3.SS3.p8.1.m1.1.1.3.3.2"><divide id="S3.SS3.p8.1.m1.1.1.3.3.2.1.cmml" xref="S3.SS3.p8.1.m1.1.1.3.3.2"></divide><apply id="S3.SS3.p8.1.m1.1.1.3.3.2.2.cmml" xref="S3.SS3.p8.1.m1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.p8.1.m1.1.1.3.3.2.2.1.cmml" xref="S3.SS3.p8.1.m1.1.1.3.3.2.2">subscript</csymbol><ci id="S3.SS3.p8.1.m1.1.1.3.3.2.2.2.cmml" xref="S3.SS3.p8.1.m1.1.1.3.3.2.2.2">𝑑</ci><ci id="S3.SS3.p8.1.m1.1.1.3.3.2.2.3.cmml" xref="S3.SS3.p8.1.m1.1.1.3.3.2.2.3">ℎ</ci></apply><ci id="S3.SS3.p8.1.m1.1.1.3.3.2.3.cmml" xref="S3.SS3.p8.1.m1.1.1.3.3.2.3">𝐾</ci></apply><apply id="S3.SS3.p8.1.m1.1.1.3.3.3.cmml" xref="S3.SS3.p8.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p8.1.m1.1.1.3.3.3.1.cmml" xref="S3.SS3.p8.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.p8.1.m1.1.1.3.3.3.2.cmml" xref="S3.SS3.p8.1.m1.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS3.p8.1.m1.1.1.3.3.3.3.cmml" xref="S3.SS3.p8.1.m1.1.1.3.3.3.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.1.m1.1c">\mathbf{G}_{k}\in\mathbb{R}^{\frac{d_{h}}{K}\times d_{v}}</annotation></semantics></math> is a matrix of learnable weights (the convolution filters), with <math id="S3.SS3.p8.2.m2.1" class="ltx_Math" alttext="d_{h}" display="inline"><semantics id="S3.SS3.p8.2.m2.1a"><msub id="S3.SS3.p8.2.m2.1.1" xref="S3.SS3.p8.2.m2.1.1.cmml"><mi id="S3.SS3.p8.2.m2.1.1.2" xref="S3.SS3.p8.2.m2.1.1.2.cmml">d</mi><mi id="S3.SS3.p8.2.m2.1.1.3" xref="S3.SS3.p8.2.m2.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.2.m2.1b"><apply id="S3.SS3.p8.2.m2.1.1.cmml" xref="S3.SS3.p8.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p8.2.m2.1.1.1.cmml" xref="S3.SS3.p8.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p8.2.m2.1.1.2.cmml" xref="S3.SS3.p8.2.m2.1.1.2">𝑑</ci><ci id="S3.SS3.p8.2.m2.1.1.3.cmml" xref="S3.SS3.p8.2.m2.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.2.m2.1c">d_{h}</annotation></semantics></math> as the chosen dimensionality of the outputted convolved features. This results in a convolved graph representation <math id="S3.SS3.p8.3.m3.1" class="ltx_Math" alttext="\mathbf{H}\in\mathbb{R}^{N\times d_{h}}" display="inline"><semantics id="S3.SS3.p8.3.m3.1a"><mrow id="S3.SS3.p8.3.m3.1.1" xref="S3.SS3.p8.3.m3.1.1.cmml"><mi id="S3.SS3.p8.3.m3.1.1.2" xref="S3.SS3.p8.3.m3.1.1.2.cmml">𝐇</mi><mo id="S3.SS3.p8.3.m3.1.1.1" xref="S3.SS3.p8.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS3.p8.3.m3.1.1.3" xref="S3.SS3.p8.3.m3.1.1.3.cmml"><mi id="S3.SS3.p8.3.m3.1.1.3.2" xref="S3.SS3.p8.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p8.3.m3.1.1.3.3" xref="S3.SS3.p8.3.m3.1.1.3.3.cmml"><mi id="S3.SS3.p8.3.m3.1.1.3.3.2" xref="S3.SS3.p8.3.m3.1.1.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p8.3.m3.1.1.3.3.1" xref="S3.SS3.p8.3.m3.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.p8.3.m3.1.1.3.3.3" xref="S3.SS3.p8.3.m3.1.1.3.3.3.cmml"><mi id="S3.SS3.p8.3.m3.1.1.3.3.3.2" xref="S3.SS3.p8.3.m3.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS3.p8.3.m3.1.1.3.3.3.3" xref="S3.SS3.p8.3.m3.1.1.3.3.3.3.cmml">h</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.3.m3.1b"><apply id="S3.SS3.p8.3.m3.1.1.cmml" xref="S3.SS3.p8.3.m3.1.1"><in id="S3.SS3.p8.3.m3.1.1.1.cmml" xref="S3.SS3.p8.3.m3.1.1.1"></in><ci id="S3.SS3.p8.3.m3.1.1.2.cmml" xref="S3.SS3.p8.3.m3.1.1.2">𝐇</ci><apply id="S3.SS3.p8.3.m3.1.1.3.cmml" xref="S3.SS3.p8.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p8.3.m3.1.1.3.1.cmml" xref="S3.SS3.p8.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.p8.3.m3.1.1.3.2.cmml" xref="S3.SS3.p8.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS3.p8.3.m3.1.1.3.3.cmml" xref="S3.SS3.p8.3.m3.1.1.3.3"><times id="S3.SS3.p8.3.m3.1.1.3.3.1.cmml" xref="S3.SS3.p8.3.m3.1.1.3.3.1"></times><ci id="S3.SS3.p8.3.m3.1.1.3.3.2.cmml" xref="S3.SS3.p8.3.m3.1.1.3.3.2">𝑁</ci><apply id="S3.SS3.p8.3.m3.1.1.3.3.3.cmml" xref="S3.SS3.p8.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p8.3.m3.1.1.3.3.3.1.cmml" xref="S3.SS3.p8.3.m3.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.p8.3.m3.1.1.3.3.3.2.cmml" xref="S3.SS3.p8.3.m3.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS3.p8.3.m3.1.1.3.3.3.3.cmml" xref="S3.SS3.p8.3.m3.1.1.3.3.3.3">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.3.m3.1c">\mathbf{H}\in\mathbb{R}^{N\times d_{h}}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Prediction layers</h3>

<div id="S3.SS4.p1" class="ltx_para ltx_noindent">
<p id="S3.SS4.p1.4" class="ltx_p">Our convolved graph representation <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{H}" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><mi id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">𝐇</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><ci id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">𝐇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">\mathbf{H}</annotation></semantics></math> is computed through L spatial graph convolution layers. We then compute a global vector representation of the graph <math id="S3.SS4.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{h}_{max}" display="inline"><semantics id="S3.SS4.p1.2.m2.1a"><msub id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml"><mi id="S3.SS4.p1.2.m2.1.1.2" xref="S3.SS4.p1.2.m2.1.1.2.cmml">𝐡</mi><mrow id="S3.SS4.p1.2.m2.1.1.3" xref="S3.SS4.p1.2.m2.1.1.3.cmml"><mi id="S3.SS4.p1.2.m2.1.1.3.2" xref="S3.SS4.p1.2.m2.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.2.m2.1.1.3.1" xref="S3.SS4.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.2.m2.1.1.3.3" xref="S3.SS4.p1.2.m2.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.2.m2.1.1.3.1a" xref="S3.SS4.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.2.m2.1.1.3.4" xref="S3.SS4.p1.2.m2.1.1.3.4.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><apply id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p1.2.m2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2">𝐡</ci><apply id="S3.SS4.p1.2.m2.1.1.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3"><times id="S3.SS4.p1.2.m2.1.1.3.1.cmml" xref="S3.SS4.p1.2.m2.1.1.3.1"></times><ci id="S3.SS4.p1.2.m2.1.1.3.2.cmml" xref="S3.SS4.p1.2.m2.1.1.3.2">𝑚</ci><ci id="S3.SS4.p1.2.m2.1.1.3.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3.3">𝑎</ci><ci id="S3.SS4.p1.2.m2.1.1.3.4.cmml" xref="S3.SS4.p1.2.m2.1.1.3.4">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">\mathbf{h}_{max}</annotation></semantics></math> via a max-pooling layer across the node dimension. This operation was chosen so as to get a permutation invariant output, and for its simplicity, so the focus is on the impact of the graph structure. This vector representation of the graph can be considered a highly non-linear compression of the graph, where the representation has been optimised for answering the question at hand. We then merge question <math id="S3.SS4.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{q}" display="inline"><semantics id="S3.SS4.p1.3.m3.1a"><mi id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml">𝐪</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><ci id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">𝐪</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">\mathbf{q}</annotation></semantics></math> and image <math id="S3.SS4.p1.4.m4.1" class="ltx_Math" alttext="\mathbf{h}_{max}" display="inline"><semantics id="S3.SS4.p1.4.m4.1a"><msub id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml"><mi id="S3.SS4.p1.4.m4.1.1.2" xref="S3.SS4.p1.4.m4.1.1.2.cmml">𝐡</mi><mrow id="S3.SS4.p1.4.m4.1.1.3" xref="S3.SS4.p1.4.m4.1.1.3.cmml"><mi id="S3.SS4.p1.4.m4.1.1.3.2" xref="S3.SS4.p1.4.m4.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.4.m4.1.1.3.1" xref="S3.SS4.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.4.m4.1.1.3.3" xref="S3.SS4.p1.4.m4.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.4.m4.1.1.3.1a" xref="S3.SS4.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.4.m4.1.1.3.4" xref="S3.SS4.p1.4.m4.1.1.3.4.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><apply id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS4.p1.4.m4.1.1.2.cmml" xref="S3.SS4.p1.4.m4.1.1.2">𝐡</ci><apply id="S3.SS4.p1.4.m4.1.1.3.cmml" xref="S3.SS4.p1.4.m4.1.1.3"><times id="S3.SS4.p1.4.m4.1.1.3.1.cmml" xref="S3.SS4.p1.4.m4.1.1.3.1"></times><ci id="S3.SS4.p1.4.m4.1.1.3.2.cmml" xref="S3.SS4.p1.4.m4.1.1.3.2">𝑚</ci><ci id="S3.SS4.p1.4.m4.1.1.3.3.cmml" xref="S3.SS4.p1.4.m4.1.1.3.3">𝑎</ci><ci id="S3.SS4.p1.4.m4.1.1.3.4.cmml" xref="S3.SS4.p1.4.m4.1.1.3.4">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">\mathbf{h}_{max}</annotation></semantics></math> encodings through a simple element-wise product. Finally, we compute classification logits through a 2-layer MLP with ReLU activations.</p>
</div>
</section>
<section id="S3.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Loss function</h3>

<div id="S3.SS5.p1" class="ltx_para ltx_noindent">
<p id="S3.SS5.p1.2" class="ltx_p">The VQA task is cast as a multi-class classification problem, where each class corresponds to one of the most common answers in the training set. Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, we use a sigmoid activation function with soft target scores, which has been shown to yield better predictions. The intuition behind this is that it allows to consider multiple correct answers per question and provides more information regarding the reliability of each answer.
Assuming each question is associated with <math id="S3.SS5.p1.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS5.p1.1.m1.1a"><mi id="S3.SS5.p1.1.m1.1.1" xref="S3.SS5.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.1.m1.1b"><ci id="S3.SS5.p1.1.m1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.1.m1.1c">n</annotation></semantics></math> valid provided answers, we compute the soft target score of each class as <math id="S3.SS5.p1.2.m2.1" class="ltx_Math" alttext="t=\frac{number\&gt;of\&gt;votes}{n}" display="inline"><semantics id="S3.SS5.p1.2.m2.1a"><mrow id="S3.SS5.p1.2.m2.1.1" xref="S3.SS5.p1.2.m2.1.1.cmml"><mi id="S3.SS5.p1.2.m2.1.1.2" xref="S3.SS5.p1.2.m2.1.1.2.cmml">t</mi><mo id="S3.SS5.p1.2.m2.1.1.1" xref="S3.SS5.p1.2.m2.1.1.1.cmml">=</mo><mfrac id="S3.SS5.p1.2.m2.1.1.3" xref="S3.SS5.p1.2.m2.1.1.3.cmml"><mrow id="S3.SS5.p1.2.m2.1.1.3.2" xref="S3.SS5.p1.2.m2.1.1.3.2.cmml"><mi id="S3.SS5.p1.2.m2.1.1.3.2.2" xref="S3.SS5.p1.2.m2.1.1.3.2.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.2.m2.1.1.3.2.1" xref="S3.SS5.p1.2.m2.1.1.3.2.1.cmml">​</mo><mi id="S3.SS5.p1.2.m2.1.1.3.2.3" xref="S3.SS5.p1.2.m2.1.1.3.2.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.2.m2.1.1.3.2.1a" xref="S3.SS5.p1.2.m2.1.1.3.2.1.cmml">​</mo><mi id="S3.SS5.p1.2.m2.1.1.3.2.4" xref="S3.SS5.p1.2.m2.1.1.3.2.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.2.m2.1.1.3.2.1b" xref="S3.SS5.p1.2.m2.1.1.3.2.1.cmml">​</mo><mi id="S3.SS5.p1.2.m2.1.1.3.2.5" xref="S3.SS5.p1.2.m2.1.1.3.2.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.2.m2.1.1.3.2.1c" xref="S3.SS5.p1.2.m2.1.1.3.2.1.cmml">​</mo><mi id="S3.SS5.p1.2.m2.1.1.3.2.6" xref="S3.SS5.p1.2.m2.1.1.3.2.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.2.m2.1.1.3.2.1d" xref="S3.SS5.p1.2.m2.1.1.3.2.1.cmml">​</mo><mi id="S3.SS5.p1.2.m2.1.1.3.2.7" xref="S3.SS5.p1.2.m2.1.1.3.2.7.cmml">r</mi><mo lspace="0.220em" rspace="0em" id="S3.SS5.p1.2.m2.1.1.3.2.1e" xref="S3.SS5.p1.2.m2.1.1.3.2.1.cmml">​</mo><mi id="S3.SS5.p1.2.m2.1.1.3.2.8" xref="S3.SS5.p1.2.m2.1.1.3.2.8.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.2.m2.1.1.3.2.1f" xref="S3.SS5.p1.2.m2.1.1.3.2.1.cmml">​</mo><mi id="S3.SS5.p1.2.m2.1.1.3.2.9" xref="S3.SS5.p1.2.m2.1.1.3.2.9.cmml">f</mi><mo lspace="0.220em" rspace="0em" id="S3.SS5.p1.2.m2.1.1.3.2.1g" xref="S3.SS5.p1.2.m2.1.1.3.2.1.cmml">​</mo><mi id="S3.SS5.p1.2.m2.1.1.3.2.10" xref="S3.SS5.p1.2.m2.1.1.3.2.10.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.2.m2.1.1.3.2.1h" xref="S3.SS5.p1.2.m2.1.1.3.2.1.cmml">​</mo><mi id="S3.SS5.p1.2.m2.1.1.3.2.11" xref="S3.SS5.p1.2.m2.1.1.3.2.11.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.2.m2.1.1.3.2.1i" xref="S3.SS5.p1.2.m2.1.1.3.2.1.cmml">​</mo><mi id="S3.SS5.p1.2.m2.1.1.3.2.12" xref="S3.SS5.p1.2.m2.1.1.3.2.12.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.2.m2.1.1.3.2.1j" xref="S3.SS5.p1.2.m2.1.1.3.2.1.cmml">​</mo><mi id="S3.SS5.p1.2.m2.1.1.3.2.13" xref="S3.SS5.p1.2.m2.1.1.3.2.13.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.2.m2.1.1.3.2.1k" xref="S3.SS5.p1.2.m2.1.1.3.2.1.cmml">​</mo><mi id="S3.SS5.p1.2.m2.1.1.3.2.14" xref="S3.SS5.p1.2.m2.1.1.3.2.14.cmml">s</mi></mrow><mi id="S3.SS5.p1.2.m2.1.1.3.3" xref="S3.SS5.p1.2.m2.1.1.3.3.cmml">n</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.2.m2.1b"><apply id="S3.SS5.p1.2.m2.1.1.cmml" xref="S3.SS5.p1.2.m2.1.1"><eq id="S3.SS5.p1.2.m2.1.1.1.cmml" xref="S3.SS5.p1.2.m2.1.1.1"></eq><ci id="S3.SS5.p1.2.m2.1.1.2.cmml" xref="S3.SS5.p1.2.m2.1.1.2">𝑡</ci><apply id="S3.SS5.p1.2.m2.1.1.3.cmml" xref="S3.SS5.p1.2.m2.1.1.3"><divide id="S3.SS5.p1.2.m2.1.1.3.1.cmml" xref="S3.SS5.p1.2.m2.1.1.3"></divide><apply id="S3.SS5.p1.2.m2.1.1.3.2.cmml" xref="S3.SS5.p1.2.m2.1.1.3.2"><times id="S3.SS5.p1.2.m2.1.1.3.2.1.cmml" xref="S3.SS5.p1.2.m2.1.1.3.2.1"></times><ci id="S3.SS5.p1.2.m2.1.1.3.2.2.cmml" xref="S3.SS5.p1.2.m2.1.1.3.2.2">𝑛</ci><ci id="S3.SS5.p1.2.m2.1.1.3.2.3.cmml" xref="S3.SS5.p1.2.m2.1.1.3.2.3">𝑢</ci><ci id="S3.SS5.p1.2.m2.1.1.3.2.4.cmml" xref="S3.SS5.p1.2.m2.1.1.3.2.4">𝑚</ci><ci id="S3.SS5.p1.2.m2.1.1.3.2.5.cmml" xref="S3.SS5.p1.2.m2.1.1.3.2.5">𝑏</ci><ci id="S3.SS5.p1.2.m2.1.1.3.2.6.cmml" xref="S3.SS5.p1.2.m2.1.1.3.2.6">𝑒</ci><ci id="S3.SS5.p1.2.m2.1.1.3.2.7.cmml" xref="S3.SS5.p1.2.m2.1.1.3.2.7">𝑟</ci><ci id="S3.SS5.p1.2.m2.1.1.3.2.8.cmml" xref="S3.SS5.p1.2.m2.1.1.3.2.8">𝑜</ci><ci id="S3.SS5.p1.2.m2.1.1.3.2.9.cmml" xref="S3.SS5.p1.2.m2.1.1.3.2.9">𝑓</ci><ci id="S3.SS5.p1.2.m2.1.1.3.2.10.cmml" xref="S3.SS5.p1.2.m2.1.1.3.2.10">𝑣</ci><ci id="S3.SS5.p1.2.m2.1.1.3.2.11.cmml" xref="S3.SS5.p1.2.m2.1.1.3.2.11">𝑜</ci><ci id="S3.SS5.p1.2.m2.1.1.3.2.12.cmml" xref="S3.SS5.p1.2.m2.1.1.3.2.12">𝑡</ci><ci id="S3.SS5.p1.2.m2.1.1.3.2.13.cmml" xref="S3.SS5.p1.2.m2.1.1.3.2.13">𝑒</ci><ci id="S3.SS5.p1.2.m2.1.1.3.2.14.cmml" xref="S3.SS5.p1.2.m2.1.1.3.2.14">𝑠</ci></apply><ci id="S3.SS5.p1.2.m2.1.1.3.3.cmml" xref="S3.SS5.p1.2.m2.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.2.m2.1c">t=\frac{number\&gt;of\&gt;votes}{n}</annotation></semantics></math>. If an answer is not in the top answers (i.e. the considered classes) then it has no corresponding element in the target vector. We then compute the multi-label soft loss which is simply the sum of the binary cross entropy losses for each element in the target vector.:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.2" class="ltx_math_unparsed" alttext="L(\mathbf{t},\mathbf{y})=\sum_{i}t_{i}\log(1/(1+exp(-y_{i}))+(1-t_{i})\log(exp(-y_{i})/(1+exp(-y_{i}))" display="block"><semantics id="S3.E6.m1.2a"><mrow id="S3.E6.m1.2b"><mi id="S3.E6.m1.2.3">L</mi><mrow id="S3.E6.m1.2.4"><mo stretchy="false" id="S3.E6.m1.2.4.1">(</mo><mi id="S3.E6.m1.1.1">𝐭</mi><mo id="S3.E6.m1.2.4.2">,</mo><mi id="S3.E6.m1.2.2">𝐲</mi><mo stretchy="false" id="S3.E6.m1.2.4.3">)</mo></mrow><mo rspace="0.111em" id="S3.E6.m1.2.5">=</mo><munder id="S3.E6.m1.2.6"><mo movablelimits="false" id="S3.E6.m1.2.6.2">∑</mo><mi id="S3.E6.m1.2.6.3">i</mi></munder><msub id="S3.E6.m1.2.7"><mi id="S3.E6.m1.2.7.2">t</mi><mi id="S3.E6.m1.2.7.3">i</mi></msub><mi id="S3.E6.m1.2.8">log</mi><mrow id="S3.E6.m1.2.9"><mo stretchy="false" id="S3.E6.m1.2.9.1">(</mo><mn id="S3.E6.m1.2.9.2">1</mn><mo id="S3.E6.m1.2.9.3">/</mo><mrow id="S3.E6.m1.2.9.4"><mo stretchy="false" id="S3.E6.m1.2.9.4.1">(</mo><mn id="S3.E6.m1.2.9.4.2">1</mn><mo id="S3.E6.m1.2.9.4.3">+</mo><mi id="S3.E6.m1.2.9.4.4">e</mi><mi id="S3.E6.m1.2.9.4.5">x</mi><mi id="S3.E6.m1.2.9.4.6">p</mi><mrow id="S3.E6.m1.2.9.4.7"><mo stretchy="false" id="S3.E6.m1.2.9.4.7.1">(</mo><mo lspace="0em" id="S3.E6.m1.2.9.4.7.2">−</mo><msub id="S3.E6.m1.2.9.4.7.3"><mi id="S3.E6.m1.2.9.4.7.3.2">y</mi><mi id="S3.E6.m1.2.9.4.7.3.3">i</mi></msub><mo stretchy="false" id="S3.E6.m1.2.9.4.7.4">)</mo></mrow><mo stretchy="false" id="S3.E6.m1.2.9.4.8">)</mo></mrow><mo id="S3.E6.m1.2.9.5">+</mo><mrow id="S3.E6.m1.2.9.6"><mo stretchy="false" id="S3.E6.m1.2.9.6.1">(</mo><mn id="S3.E6.m1.2.9.6.2">1</mn><mo id="S3.E6.m1.2.9.6.3">−</mo><msub id="S3.E6.m1.2.9.6.4"><mi id="S3.E6.m1.2.9.6.4.2">t</mi><mi id="S3.E6.m1.2.9.6.4.3">i</mi></msub><mo rspace="0.167em" stretchy="false" id="S3.E6.m1.2.9.6.5">)</mo></mrow><mi id="S3.E6.m1.2.9.7">log</mi><mrow id="S3.E6.m1.2.9.8"><mo stretchy="false" id="S3.E6.m1.2.9.8.1">(</mo><mi id="S3.E6.m1.2.9.8.2">e</mi><mi id="S3.E6.m1.2.9.8.3">x</mi><mi id="S3.E6.m1.2.9.8.4">p</mi><mrow id="S3.E6.m1.2.9.8.5"><mo stretchy="false" id="S3.E6.m1.2.9.8.5.1">(</mo><mo lspace="0em" id="S3.E6.m1.2.9.8.5.2">−</mo><msub id="S3.E6.m1.2.9.8.5.3"><mi id="S3.E6.m1.2.9.8.5.3.2">y</mi><mi id="S3.E6.m1.2.9.8.5.3.3">i</mi></msub><mo stretchy="false" id="S3.E6.m1.2.9.8.5.4">)</mo></mrow><mo id="S3.E6.m1.2.9.8.6">/</mo><mrow id="S3.E6.m1.2.9.8.7"><mo stretchy="false" id="S3.E6.m1.2.9.8.7.1">(</mo><mn id="S3.E6.m1.2.9.8.7.2">1</mn><mo id="S3.E6.m1.2.9.8.7.3">+</mo><mi id="S3.E6.m1.2.9.8.7.4">e</mi><mi id="S3.E6.m1.2.9.8.7.5">x</mi><mi id="S3.E6.m1.2.9.8.7.6">p</mi><mrow id="S3.E6.m1.2.9.8.7.7"><mo stretchy="false" id="S3.E6.m1.2.9.8.7.7.1">(</mo><mo lspace="0em" id="S3.E6.m1.2.9.8.7.7.2">−</mo><msub id="S3.E6.m1.2.9.8.7.7.3"><mi id="S3.E6.m1.2.9.8.7.7.3.2">y</mi><mi id="S3.E6.m1.2.9.8.7.7.3.3">i</mi></msub><mo stretchy="false" id="S3.E6.m1.2.9.8.7.7.4">)</mo></mrow><mo stretchy="false" id="S3.E6.m1.2.9.8.7.8">)</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S3.E6.m1.2c">L(\mathbf{t},\mathbf{y})=\sum_{i}t_{i}\log(1/(1+exp(-y_{i}))+(1-t_{i})\log(exp(-y_{i})/(1+exp(-y_{i}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS5.p1.3" class="ltx_p">where <math id="S3.SS5.p1.3.m1.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS5.p1.3.m1.1a"><mi id="S3.SS5.p1.3.m1.1.1" xref="S3.SS5.p1.3.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.3.m1.1b"><ci id="S3.SS5.p1.3.m1.1.1.cmml" xref="S3.SS5.p1.3.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.3.m1.1c">y</annotation></semantics></math> is the logit vector (i.e. the output of our model).</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Evaluation</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Dataset and preprocessing</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.1" class="ltx_p">We evaluate our model using the VQA 2.0 dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> which contains a total of 1,105,904 questions and about 204,721 images from the COCO dataset. The dataset is split up roughly into proportions of 40%, 20%, 40% for train, validation and test sets respectively. Each question in the dataset is associated with 10 different answers obtained by crowdsourcing. Accuracy on this dataset is computed so as to be robust to inter-human variability as:</p>
<table id="S4.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E7.m1.4" class="ltx_Math" alttext="acc(a)=\min\{\frac{\mbox{number of times a is chosen}}{3},1\}" display="block"><semantics id="S4.E7.m1.4a"><mrow id="S4.E7.m1.4.5" xref="S4.E7.m1.4.5.cmml"><mrow id="S4.E7.m1.4.5.2" xref="S4.E7.m1.4.5.2.cmml"><mi id="S4.E7.m1.4.5.2.2" xref="S4.E7.m1.4.5.2.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.4.5.2.1" xref="S4.E7.m1.4.5.2.1.cmml">​</mo><mi id="S4.E7.m1.4.5.2.3" xref="S4.E7.m1.4.5.2.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.4.5.2.1a" xref="S4.E7.m1.4.5.2.1.cmml">​</mo><mi id="S4.E7.m1.4.5.2.4" xref="S4.E7.m1.4.5.2.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.4.5.2.1b" xref="S4.E7.m1.4.5.2.1.cmml">​</mo><mrow id="S4.E7.m1.4.5.2.5.2" xref="S4.E7.m1.4.5.2.cmml"><mo stretchy="false" id="S4.E7.m1.4.5.2.5.2.1" xref="S4.E7.m1.4.5.2.cmml">(</mo><mi id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml">a</mi><mo stretchy="false" id="S4.E7.m1.4.5.2.5.2.2" xref="S4.E7.m1.4.5.2.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.4.5.1" xref="S4.E7.m1.4.5.1.cmml">=</mo><mrow id="S4.E7.m1.4.5.3.2" xref="S4.E7.m1.4.5.3.1.cmml"><mi id="S4.E7.m1.2.2" xref="S4.E7.m1.2.2.cmml">min</mi><mo id="S4.E7.m1.4.5.3.2a" xref="S4.E7.m1.4.5.3.1.cmml">⁡</mo><mrow id="S4.E7.m1.4.5.3.2.1" xref="S4.E7.m1.4.5.3.1.cmml"><mo stretchy="false" id="S4.E7.m1.4.5.3.2.1.1" xref="S4.E7.m1.4.5.3.1.cmml">{</mo><mfrac id="S4.E7.m1.3.3" xref="S4.E7.m1.3.3.cmml"><mtext id="S4.E7.m1.3.3.2" xref="S4.E7.m1.3.3.2a.cmml">number of times a is chosen</mtext><mn id="S4.E7.m1.3.3.3" xref="S4.E7.m1.3.3.3.cmml">3</mn></mfrac><mo id="S4.E7.m1.4.5.3.2.1.2" xref="S4.E7.m1.4.5.3.1.cmml">,</mo><mn id="S4.E7.m1.4.4" xref="S4.E7.m1.4.4.cmml">1</mn><mo stretchy="false" id="S4.E7.m1.4.5.3.2.1.3" xref="S4.E7.m1.4.5.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.4b"><apply id="S4.E7.m1.4.5.cmml" xref="S4.E7.m1.4.5"><eq id="S4.E7.m1.4.5.1.cmml" xref="S4.E7.m1.4.5.1"></eq><apply id="S4.E7.m1.4.5.2.cmml" xref="S4.E7.m1.4.5.2"><times id="S4.E7.m1.4.5.2.1.cmml" xref="S4.E7.m1.4.5.2.1"></times><ci id="S4.E7.m1.4.5.2.2.cmml" xref="S4.E7.m1.4.5.2.2">𝑎</ci><ci id="S4.E7.m1.4.5.2.3.cmml" xref="S4.E7.m1.4.5.2.3">𝑐</ci><ci id="S4.E7.m1.4.5.2.4.cmml" xref="S4.E7.m1.4.5.2.4">𝑐</ci><ci id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1">𝑎</ci></apply><apply id="S4.E7.m1.4.5.3.1.cmml" xref="S4.E7.m1.4.5.3.2"><min id="S4.E7.m1.2.2.cmml" xref="S4.E7.m1.2.2"></min><apply id="S4.E7.m1.3.3.cmml" xref="S4.E7.m1.3.3"><divide id="S4.E7.m1.3.3.1.cmml" xref="S4.E7.m1.3.3"></divide><ci id="S4.E7.m1.3.3.2a.cmml" xref="S4.E7.m1.3.3.2"><mtext id="S4.E7.m1.3.3.2.cmml" xref="S4.E7.m1.3.3.2">number of times a is chosen</mtext></ci><cn type="integer" id="S4.E7.m1.3.3.3.cmml" xref="S4.E7.m1.3.3.3">3</cn></apply><cn type="integer" id="S4.E7.m1.4.4.cmml" xref="S4.E7.m1.4.4">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.4c">acc(a)=\min\{\frac{\mbox{number of times a is chosen}}{3},1\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.2" class="ltx_p">We consider the 3000 most common answers in the train set as possible answers for our network to predict. Each question is tokenized and mapped into a sequence of 300-dimensional pre-trained GloVe word embeddings <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>. The COCO images are encoded as set of 36 object bounding boxes with corresponding 2048-dimensional feature vectors as described in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. We normalise the bounding box corners by the image height and width so they lie in the interval <math id="S4.SS1.p2.1.m1.2" class="ltx_Math" alttext="[0,1]" display="inline"><semantics id="S4.SS1.p2.1.m1.2a"><mrow id="S4.SS1.p2.1.m1.2.3.2" xref="S4.SS1.p2.1.m1.2.3.1.cmml"><mo stretchy="false" id="S4.SS1.p2.1.m1.2.3.2.1" xref="S4.SS1.p2.1.m1.2.3.1.cmml">[</mo><mn id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">0</mn><mo id="S4.SS1.p2.1.m1.2.3.2.2" xref="S4.SS1.p2.1.m1.2.3.1.cmml">,</mo><mn id="S4.SS1.p2.1.m1.2.2" xref="S4.SS1.p2.1.m1.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS1.p2.1.m1.2.3.2.3" xref="S4.SS1.p2.1.m1.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.2b"><interval closure="closed" id="S4.SS1.p2.1.m1.2.3.1.cmml" xref="S4.SS1.p2.1.m1.2.3.2"><cn type="integer" id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">0</cn><cn type="integer" id="S4.SS1.p2.1.m1.2.2.cmml" xref="S4.SS1.p2.1.m1.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.2c">[0,1]</annotation></semantics></math>. The bounding box corners, which provide absolute spatial information, are then concatenated onto the image feature vectors so they become 2052 dimensions <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="(d_{v}=2052)" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mrow id="S4.SS1.p2.2.m2.1.1.1" xref="S4.SS1.p2.2.m2.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p2.2.m2.1.1.1.2" xref="S4.SS1.p2.2.m2.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p2.2.m2.1.1.1.1" xref="S4.SS1.p2.2.m2.1.1.1.1.cmml"><msub id="S4.SS1.p2.2.m2.1.1.1.1.2" xref="S4.SS1.p2.2.m2.1.1.1.1.2.cmml"><mi id="S4.SS1.p2.2.m2.1.1.1.1.2.2" xref="S4.SS1.p2.2.m2.1.1.1.1.2.2.cmml">d</mi><mi id="S4.SS1.p2.2.m2.1.1.1.1.2.3" xref="S4.SS1.p2.2.m2.1.1.1.1.2.3.cmml">v</mi></msub><mo id="S4.SS1.p2.2.m2.1.1.1.1.1" xref="S4.SS1.p2.2.m2.1.1.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.2.m2.1.1.1.1.3" xref="S4.SS1.p2.2.m2.1.1.1.1.3.cmml">2052</mn></mrow><mo stretchy="false" id="S4.SS1.p2.2.m2.1.1.1.3" xref="S4.SS1.p2.2.m2.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><apply id="S4.SS1.p2.2.m2.1.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1.1"><eq id="S4.SS1.p2.2.m2.1.1.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1.1.1.1"></eq><apply id="S4.SS1.p2.2.m2.1.1.1.1.2.cmml" xref="S4.SS1.p2.2.m2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.1.1.1.1.2.1.cmml" xref="S4.SS1.p2.2.m2.1.1.1.1.2">subscript</csymbol><ci id="S4.SS1.p2.2.m2.1.1.1.1.2.2.cmml" xref="S4.SS1.p2.2.m2.1.1.1.1.2.2">𝑑</ci><ci id="S4.SS1.p2.2.m2.1.1.1.1.2.3.cmml" xref="S4.SS1.p2.2.m2.1.1.1.1.2.3">𝑣</ci></apply><cn type="integer" id="S4.SS1.p2.2.m2.1.1.1.1.3.cmml" xref="S4.SS1.p2.2.m2.1.1.1.1.3">2052</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">(d_{v}=2052)</annotation></semantics></math>. Pseudo-coordinates are computed as the polar coordinates of the bounding box centres and give the model relative spatial information.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Implementation</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.4" class="ltx_p">Our question encoder is a dynamic Gated Recurrent Unit (GRU) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> with a hidden state size of 1024 <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="(d_{q}=1024)" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.1.m1.1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.1.m1.1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.1.cmml"><msub id="S4.SS2.p1.1.m1.1.1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.1.1.2.cmml"><mi id="S4.SS2.p1.1.m1.1.1.1.1.2.2" xref="S4.SS2.p1.1.m1.1.1.1.1.2.2.cmml">d</mi><mi id="S4.SS2.p1.1.m1.1.1.1.1.2.3" xref="S4.SS2.p1.1.m1.1.1.1.1.2.3.cmml">q</mi></msub><mo id="S4.SS2.p1.1.m1.1.1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.1.m1.1.1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.1.1.3.cmml">1024</mn></mrow><mo stretchy="false" id="S4.SS2.p1.1.m1.1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1"><eq id="S4.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1"></eq><apply id="S4.SS2.p1.1.m1.1.1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.1.2.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.1.1.2.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.2.2">𝑑</ci><ci id="S4.SS2.p1.1.m1.1.1.1.1.2.3.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.2.3">𝑞</ci></apply><cn type="integer" id="S4.SS2.p1.1.m1.1.1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.3">1024</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">(d_{q}=1024)</annotation></semantics></math>. Our function <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="F" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">F</annotation></semantics></math> (see Eq. <a href="#S3.E1" title="In 3.2 Graph learner ‣ 3 Methods ‣ Learning Conditioned Graph Structures for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>), which learns the adjacency matrix, comprises two dense linear layers of size 512 <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="(d_{g}=512)" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.3.m3.1.1.1.2" xref="S4.SS2.p1.3.m3.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.3.m3.1.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.1.cmml"><msub id="S4.SS2.p1.3.m3.1.1.1.1.2" xref="S4.SS2.p1.3.m3.1.1.1.1.2.cmml"><mi id="S4.SS2.p1.3.m3.1.1.1.1.2.2" xref="S4.SS2.p1.3.m3.1.1.1.1.2.2.cmml">d</mi><mi id="S4.SS2.p1.3.m3.1.1.1.1.2.3" xref="S4.SS2.p1.3.m3.1.1.1.1.2.3.cmml">g</mi></msub><mo id="S4.SS2.p1.3.m3.1.1.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.3.m3.1.1.1.1.3" xref="S4.SS2.p1.3.m3.1.1.1.1.3.cmml">512</mn></mrow><mo stretchy="false" id="S4.SS2.p1.3.m3.1.1.1.3" xref="S4.SS2.p1.3.m3.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1"><eq id="S4.SS2.p1.3.m3.1.1.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.1"></eq><apply id="S4.SS2.p1.3.m3.1.1.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.1.1.2.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.1.1.2.2.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.2.2">𝑑</ci><ci id="S4.SS2.p1.3.m3.1.1.1.1.2.3.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.2.3">𝑔</ci></apply><cn type="integer" id="S4.SS2.p1.3.m3.1.1.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.3">512</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">(d_{g}=512)</annotation></semantics></math>. We use L=2 spatial graph convolution layers of dimensions 2048 and 1024 so that <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="(d_{h_{1}}=2048,d_{h_{2}}=1024)" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><mrow id="S4.SS2.p1.4.m4.1.1.1"><mo stretchy="false" id="S4.SS2.p1.4.m4.1.1.1.2">(</mo><mrow id="S4.SS2.p1.4.m4.1.1.1.1.2" xref="S4.SS2.p1.4.m4.1.1.1.1.3.cmml"><mrow id="S4.SS2.p1.4.m4.1.1.1.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.cmml"><msub id="S4.SS2.p1.4.m4.1.1.1.1.1.1.2" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.2.cmml"><mi id="S4.SS2.p1.4.m4.1.1.1.1.1.1.2.2" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.2.2.cmml">d</mi><msub id="S4.SS2.p1.4.m4.1.1.1.1.1.1.2.3" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.2.3.cmml"><mi id="S4.SS2.p1.4.m4.1.1.1.1.1.1.2.3.2" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.2.3.2.cmml">h</mi><mn id="S4.SS2.p1.4.m4.1.1.1.1.1.1.2.3.3" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.2.3.3.cmml">1</mn></msub></msub><mo id="S4.SS2.p1.4.m4.1.1.1.1.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.4.m4.1.1.1.1.1.1.3" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.3.cmml">2048</mn></mrow><mo id="S4.SS2.p1.4.m4.1.1.1.1.2.3" xref="S4.SS2.p1.4.m4.1.1.1.1.3a.cmml">,</mo><mrow id="S4.SS2.p1.4.m4.1.1.1.1.2.2" xref="S4.SS2.p1.4.m4.1.1.1.1.2.2.cmml"><msub id="S4.SS2.p1.4.m4.1.1.1.1.2.2.2" xref="S4.SS2.p1.4.m4.1.1.1.1.2.2.2.cmml"><mi id="S4.SS2.p1.4.m4.1.1.1.1.2.2.2.2" xref="S4.SS2.p1.4.m4.1.1.1.1.2.2.2.2.cmml">d</mi><msub id="S4.SS2.p1.4.m4.1.1.1.1.2.2.2.3" xref="S4.SS2.p1.4.m4.1.1.1.1.2.2.2.3.cmml"><mi id="S4.SS2.p1.4.m4.1.1.1.1.2.2.2.3.2" xref="S4.SS2.p1.4.m4.1.1.1.1.2.2.2.3.2.cmml">h</mi><mn id="S4.SS2.p1.4.m4.1.1.1.1.2.2.2.3.3" xref="S4.SS2.p1.4.m4.1.1.1.1.2.2.2.3.3.cmml">2</mn></msub></msub><mo id="S4.SS2.p1.4.m4.1.1.1.1.2.2.1" xref="S4.SS2.p1.4.m4.1.1.1.1.2.2.1.cmml">=</mo><mn id="S4.SS2.p1.4.m4.1.1.1.1.2.2.3" xref="S4.SS2.p1.4.m4.1.1.1.1.2.2.3.cmml">1024</mn></mrow></mrow><mo stretchy="false" id="S4.SS2.p1.4.m4.1.1.1.3">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.1.1.1.3.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.1.1.1.3a.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S4.SS2.p1.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1"><eq id="S4.SS2.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.1"></eq><apply id="S4.SS2.p1.4.m4.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.4.m4.1.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.2.2">𝑑</ci><apply id="S4.SS2.p1.4.m4.1.1.1.1.1.1.2.3.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.1.1.1.1.1.2.3.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.SS2.p1.4.m4.1.1.1.1.1.1.2.3.2.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.2.3.2">ℎ</ci><cn type="integer" id="S4.SS2.p1.4.m4.1.1.1.1.1.1.2.3.3.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><cn type="integer" id="S4.SS2.p1.4.m4.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.3">2048</cn></apply><apply id="S4.SS2.p1.4.m4.1.1.1.1.2.2.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.2.2"><eq id="S4.SS2.p1.4.m4.1.1.1.1.2.2.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.2.2.1"></eq><apply id="S4.SS2.p1.4.m4.1.1.1.1.2.2.2.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.1.1.1.2.2.2.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.SS2.p1.4.m4.1.1.1.1.2.2.2.2.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.2.2.2.2">𝑑</ci><apply id="S4.SS2.p1.4.m4.1.1.1.1.2.2.2.3.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.1.1.1.2.2.2.3.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.2.2.2.3">subscript</csymbol><ci id="S4.SS2.p1.4.m4.1.1.1.1.2.2.2.3.2.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.2.2.2.3.2">ℎ</ci><cn type="integer" id="S4.SS2.p1.4.m4.1.1.1.1.2.2.2.3.3.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.2.2.2.3.3">2</cn></apply></apply><cn type="integer" id="S4.SS2.p1.4.m4.1.1.1.1.2.2.3.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.2.2.3">1024</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">(d_{h_{1}}=2048,d_{h_{2}}=1024)</annotation></semantics></math>. All dense layers and convolutional layers are activated using Rectified Linear Unit (ReLU) activation functions. During training we use dropout on the image features and all but the final dense layers’ nodes with a 0.5 probability. We train for 35 epochs using batch size of 64 and the Adam optimizer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> with a learning rate of 0.0001 which we halve after the 30th epoch.
Parameters are chosen based on the performance on the validation set using the training set. The model is then trained on the training and validation sets using the chosen parameters for evaluation on the test set.</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/1806.07243/assets/parameter_study.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="278" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Results of parameter exploration. The VQA score for each question type is reported for a variety of settings of the number of kernels <math id="S4.F3.7.m1.1" class="ltx_Math" alttext="(K)" display="inline"><semantics id="S4.F3.7.m1.1b"><mrow id="S4.F3.7.m1.1.2.2"><mo stretchy="false" id="S4.F3.7.m1.1.2.2.1">(</mo><mi id="S4.F3.7.m1.1.1" xref="S4.F3.7.m1.1.1.cmml">K</mi><mo stretchy="false" id="S4.F3.7.m1.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.7.m1.1c"><ci id="S4.F3.7.m1.1.1.cmml" xref="S4.F3.7.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.7.m1.1d">(K)</annotation></semantics></math> and the neighbourhood size <math id="S4.F3.8.m2.1" class="ltx_Math" alttext="(m)" display="inline"><semantics id="S4.F3.8.m2.1b"><mrow id="S4.F3.8.m2.1.2.2"><mo stretchy="false" id="S4.F3.8.m2.1.2.2.1">(</mo><mi id="S4.F3.8.m2.1.1" xref="S4.F3.8.m2.1.1.cmml">m</mi><mo stretchy="false" id="S4.F3.8.m2.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.8.m2.1c"><ci id="S4.F3.8.m2.1.1.cmml" xref="S4.F3.8.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.8.m2.1d">(m)</annotation></semantics></math>. The left hand plot shows varying <math id="S4.F3.9.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S4.F3.9.m3.1b"><mi id="S4.F3.9.m3.1.1" xref="S4.F3.9.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.F3.9.m3.1c"><ci id="S4.F3.9.m3.1.1.cmml" xref="S4.F3.9.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.9.m3.1d">m</annotation></semantics></math> while keeping <math id="S4.F3.10.m4.1" class="ltx_Math" alttext="K=8" display="inline"><semantics id="S4.F3.10.m4.1b"><mrow id="S4.F3.10.m4.1.1" xref="S4.F3.10.m4.1.1.cmml"><mi id="S4.F3.10.m4.1.1.2" xref="S4.F3.10.m4.1.1.2.cmml">K</mi><mo id="S4.F3.10.m4.1.1.1" xref="S4.F3.10.m4.1.1.1.cmml">=</mo><mn id="S4.F3.10.m4.1.1.3" xref="S4.F3.10.m4.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.10.m4.1c"><apply id="S4.F3.10.m4.1.1.cmml" xref="S4.F3.10.m4.1.1"><eq id="S4.F3.10.m4.1.1.1.cmml" xref="S4.F3.10.m4.1.1.1"></eq><ci id="S4.F3.10.m4.1.1.2.cmml" xref="S4.F3.10.m4.1.1.2">𝐾</ci><cn type="integer" id="S4.F3.10.m4.1.1.3.cmml" xref="S4.F3.10.m4.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.10.m4.1d">K=8</annotation></semantics></math>, the right hand plot shows varying <math id="S4.F3.11.m5.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.F3.11.m5.1b"><mi id="S4.F3.11.m5.1.1" xref="S4.F3.11.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.F3.11.m5.1c"><ci id="S4.F3.11.m5.1.1.cmml" xref="S4.F3.11.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.11.m5.1d">K</annotation></semantics></math> while keeping <math id="S4.F3.12.m6.1" class="ltx_Math" alttext="m=16" display="inline"><semantics id="S4.F3.12.m6.1b"><mrow id="S4.F3.12.m6.1.1" xref="S4.F3.12.m6.1.1.cmml"><mi id="S4.F3.12.m6.1.1.2" xref="S4.F3.12.m6.1.1.2.cmml">m</mi><mo id="S4.F3.12.m6.1.1.1" xref="S4.F3.12.m6.1.1.1.cmml">=</mo><mn id="S4.F3.12.m6.1.1.3" xref="S4.F3.12.m6.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.12.m6.1c"><apply id="S4.F3.12.m6.1.1.cmml" xref="S4.F3.12.m6.1.1"><eq id="S4.F3.12.m6.1.1.1.cmml" xref="S4.F3.12.m6.1.1.1"></eq><ci id="S4.F3.12.m6.1.1.2.cmml" xref="S4.F3.12.m6.1.1.2">𝑚</ci><cn type="integer" id="S4.F3.12.m6.1.1.3.cmml" xref="S4.F3.12.m6.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.12.m6.1d">m=16</annotation></semantics></math>.</figcaption>
</figure>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>VQA 2.0 standard test set results - comparison with baselines and current state of the art methods</figcaption>
<table id="S4.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column">Answer type</th>
<th id="S4.T1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column">All</th>
<th id="S4.T1.1.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column">Y/N</th>
<th id="S4.T1.1.1.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column">Num.</th>
<th id="S4.T1.1.1.1.5" class="ltx_td ltx_align_left ltx_th ltx_th_column">Other</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.1.2.1" class="ltx_tr">
<td id="S4.T1.1.2.1.1" class="ltx_td ltx_align_left ltx_border_t">ReasonNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>
</td>
<td id="S4.T1.1.2.1.2" class="ltx_td ltx_align_left ltx_border_t">64.61</td>
<td id="S4.T1.1.2.1.3" class="ltx_td ltx_align_left ltx_border_t">78.86</td>
<td id="S4.T1.1.2.1.4" class="ltx_td ltx_align_left ltx_border_t">41.98</td>
<td id="S4.T1.1.2.1.5" class="ltx_td ltx_align_left ltx_border_t">57.39</td>
</tr>
<tr id="S4.T1.1.3.2" class="ltx_tr">
<td id="S4.T1.1.3.2.1" class="ltx_td ltx_align_left">Bottom-Up <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>
</td>
<td id="S4.T1.1.3.2.2" class="ltx_td ltx_align_left">65.67</td>
<td id="S4.T1.1.3.2.3" class="ltx_td ltx_align_left">82.20</td>
<td id="S4.T1.1.3.2.4" class="ltx_td ltx_align_left">43.90</td>
<td id="S4.T1.1.3.2.5" class="ltx_td ltx_align_left">56.26</td>
</tr>
<tr id="S4.T1.1.4.3" class="ltx_tr">
<td id="S4.T1.1.4.3.1" class="ltx_td ltx_align_left">Counting module <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>
</td>
<td id="S4.T1.1.4.3.2" class="ltx_td ltx_align_left">68.41</td>
<td id="S4.T1.1.4.3.3" class="ltx_td ltx_align_left">83.56</td>
<td id="S4.T1.1.4.3.4" class="ltx_td ltx_align_left">51.39</td>
<td id="S4.T1.1.4.3.5" class="ltx_td ltx_align_left">59.11</td>
</tr>
<tr id="S4.T1.1.5.4" class="ltx_tr">
<td id="S4.T1.1.5.4.1" class="ltx_td ltx_align_left ltx_border_t">kNN graph</td>
<td id="S4.T1.1.5.4.2" class="ltx_td ltx_align_left ltx_border_t">61.00</td>
<td id="S4.T1.1.5.4.3" class="ltx_td ltx_align_left ltx_border_t">79.35</td>
<td id="S4.T1.1.5.4.4" class="ltx_td ltx_align_left ltx_border_t">41.63</td>
<td id="S4.T1.1.5.4.5" class="ltx_td ltx_align_left ltx_border_t">49.70</td>
</tr>
<tr id="S4.T1.1.6.5" class="ltx_tr">
<td id="S4.T1.1.6.5.1" class="ltx_td ltx_align_left">Attention</td>
<td id="S4.T1.1.6.5.2" class="ltx_td ltx_align_left">61.90</td>
<td id="S4.T1.1.6.5.3" class="ltx_td ltx_align_left">79.87</td>
<td id="S4.T1.1.6.5.4" class="ltx_td ltx_align_left">42.48</td>
<td id="S4.T1.1.6.5.5" class="ltx_td ltx_align_left">50.95</td>
</tr>
<tr id="S4.T1.1.7.6" class="ltx_tr">
<td id="S4.T1.1.7.6.1" class="ltx_td ltx_align_left ltx_border_bb"><span id="S4.T1.1.7.6.1.1" class="ltx_text ltx_font_bold">Ours</span></td>
<td id="S4.T1.1.7.6.2" class="ltx_td ltx_align_left ltx_border_bb">66.18</td>
<td id="S4.T1.1.7.6.3" class="ltx_td ltx_align_left ltx_border_bb">82.91</td>
<td id="S4.T1.1.7.6.4" class="ltx_td ltx_align_left ltx_border_bb">47.13</td>
<td id="S4.T1.1.7.6.5" class="ltx_td ltx_align_left ltx_border_bb">56.22</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Results</h3>

<div id="S4.SS3.p1" class="ltx_para ltx_noindent">
<p id="S4.SS3.p1.11" class="ltx_p">We investigated the influence of our model’s main parameters on the classification accuracy, namely neighbourhood size (<math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mi id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">m</annotation></semantics></math>), and the number of Gaussian kernels (<math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><mi id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><ci id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">K</annotation></semantics></math>). We trained models for <math id="S4.SS3.p1.3.m3.1" class="ltx_Math" alttext="m\in 8-32" display="inline"><semantics id="S4.SS3.p1.3.m3.1a"><mrow id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml"><mi id="S4.SS3.p1.3.m3.1.1.2" xref="S4.SS3.p1.3.m3.1.1.2.cmml">m</mi><mo id="S4.SS3.p1.3.m3.1.1.1" xref="S4.SS3.p1.3.m3.1.1.1.cmml">∈</mo><mrow id="S4.SS3.p1.3.m3.1.1.3" xref="S4.SS3.p1.3.m3.1.1.3.cmml"><mn id="S4.SS3.p1.3.m3.1.1.3.2" xref="S4.SS3.p1.3.m3.1.1.3.2.cmml">8</mn><mo id="S4.SS3.p1.3.m3.1.1.3.1" xref="S4.SS3.p1.3.m3.1.1.3.1.cmml">−</mo><mn id="S4.SS3.p1.3.m3.1.1.3.3" xref="S4.SS3.p1.3.m3.1.1.3.3.cmml">32</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><apply id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1"><in id="S4.SS3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1.1"></in><ci id="S4.SS3.p1.3.m3.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1.2">𝑚</ci><apply id="S4.SS3.p1.3.m3.1.1.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3"><minus id="S4.SS3.p1.3.m3.1.1.3.1.cmml" xref="S4.SS3.p1.3.m3.1.1.3.1"></minus><cn type="integer" id="S4.SS3.p1.3.m3.1.1.3.2.cmml" xref="S4.SS3.p1.3.m3.1.1.3.2">8</cn><cn type="integer" id="S4.SS3.p1.3.m3.1.1.3.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3">32</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">m\in 8-32</annotation></semantics></math>, with a step of 4; and <math id="S4.SS3.p1.4.m4.5" class="ltx_Math" alttext="K\in\{2,4,8,16,32\}" display="inline"><semantics id="S4.SS3.p1.4.m4.5a"><mrow id="S4.SS3.p1.4.m4.5.6" xref="S4.SS3.p1.4.m4.5.6.cmml"><mi id="S4.SS3.p1.4.m4.5.6.2" xref="S4.SS3.p1.4.m4.5.6.2.cmml">K</mi><mo id="S4.SS3.p1.4.m4.5.6.1" xref="S4.SS3.p1.4.m4.5.6.1.cmml">∈</mo><mrow id="S4.SS3.p1.4.m4.5.6.3.2" xref="S4.SS3.p1.4.m4.5.6.3.1.cmml"><mo stretchy="false" id="S4.SS3.p1.4.m4.5.6.3.2.1" xref="S4.SS3.p1.4.m4.5.6.3.1.cmml">{</mo><mn id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml">2</mn><mo id="S4.SS3.p1.4.m4.5.6.3.2.2" xref="S4.SS3.p1.4.m4.5.6.3.1.cmml">,</mo><mn id="S4.SS3.p1.4.m4.2.2" xref="S4.SS3.p1.4.m4.2.2.cmml">4</mn><mo id="S4.SS3.p1.4.m4.5.6.3.2.3" xref="S4.SS3.p1.4.m4.5.6.3.1.cmml">,</mo><mn id="S4.SS3.p1.4.m4.3.3" xref="S4.SS3.p1.4.m4.3.3.cmml">8</mn><mo id="S4.SS3.p1.4.m4.5.6.3.2.4" xref="S4.SS3.p1.4.m4.5.6.3.1.cmml">,</mo><mn id="S4.SS3.p1.4.m4.4.4" xref="S4.SS3.p1.4.m4.4.4.cmml">16</mn><mo id="S4.SS3.p1.4.m4.5.6.3.2.5" xref="S4.SS3.p1.4.m4.5.6.3.1.cmml">,</mo><mn id="S4.SS3.p1.4.m4.5.5" xref="S4.SS3.p1.4.m4.5.5.cmml">32</mn><mo stretchy="false" id="S4.SS3.p1.4.m4.5.6.3.2.6" xref="S4.SS3.p1.4.m4.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.5b"><apply id="S4.SS3.p1.4.m4.5.6.cmml" xref="S4.SS3.p1.4.m4.5.6"><in id="S4.SS3.p1.4.m4.5.6.1.cmml" xref="S4.SS3.p1.4.m4.5.6.1"></in><ci id="S4.SS3.p1.4.m4.5.6.2.cmml" xref="S4.SS3.p1.4.m4.5.6.2">𝐾</ci><set id="S4.SS3.p1.4.m4.5.6.3.1.cmml" xref="S4.SS3.p1.4.m4.5.6.3.2"><cn type="integer" id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">2</cn><cn type="integer" id="S4.SS3.p1.4.m4.2.2.cmml" xref="S4.SS3.p1.4.m4.2.2">4</cn><cn type="integer" id="S4.SS3.p1.4.m4.3.3.cmml" xref="S4.SS3.p1.4.m4.3.3">8</cn><cn type="integer" id="S4.SS3.p1.4.m4.4.4.cmml" xref="S4.SS3.p1.4.m4.4.4">16</cn><cn type="integer" id="S4.SS3.p1.4.m4.5.5.cmml" xref="S4.SS3.p1.4.m4.5.5">32</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.5c">K\in\{2,4,8,16,32\}</annotation></semantics></math>. Results are reported in Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.2 Implementation ‣ 4 Evaluation ‣ Learning Conditioned Graph Structures for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Our results suggest that <math id="S4.SS3.p1.5.m5.1" class="ltx_Math" alttext="m=16" display="inline"><semantics id="S4.SS3.p1.5.m5.1a"><mrow id="S4.SS3.p1.5.m5.1.1" xref="S4.SS3.p1.5.m5.1.1.cmml"><mi id="S4.SS3.p1.5.m5.1.1.2" xref="S4.SS3.p1.5.m5.1.1.2.cmml">m</mi><mo id="S4.SS3.p1.5.m5.1.1.1" xref="S4.SS3.p1.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS3.p1.5.m5.1.1.3" xref="S4.SS3.p1.5.m5.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.1b"><apply id="S4.SS3.p1.5.m5.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1"><eq id="S4.SS3.p1.5.m5.1.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1.1"></eq><ci id="S4.SS3.p1.5.m5.1.1.2.cmml" xref="S4.SS3.p1.5.m5.1.1.2">𝑚</ci><cn type="integer" id="S4.SS3.p1.5.m5.1.1.3.cmml" xref="S4.SS3.p1.5.m5.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.1c">m=16</annotation></semantics></math> and <math id="S4.SS3.p1.6.m6.1" class="ltx_Math" alttext="K=8" display="inline"><semantics id="S4.SS3.p1.6.m6.1a"><mrow id="S4.SS3.p1.6.m6.1.1" xref="S4.SS3.p1.6.m6.1.1.cmml"><mi id="S4.SS3.p1.6.m6.1.1.2" xref="S4.SS3.p1.6.m6.1.1.2.cmml">K</mi><mo id="S4.SS3.p1.6.m6.1.1.1" xref="S4.SS3.p1.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS3.p1.6.m6.1.1.3" xref="S4.SS3.p1.6.m6.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.6.m6.1b"><apply id="S4.SS3.p1.6.m6.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1"><eq id="S4.SS3.p1.6.m6.1.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1.1"></eq><ci id="S4.SS3.p1.6.m6.1.1.2.cmml" xref="S4.SS3.p1.6.m6.1.1.2">𝐾</ci><cn type="integer" id="S4.SS3.p1.6.m6.1.1.3.cmml" xref="S4.SS3.p1.6.m6.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.6.m6.1c">K=8</annotation></semantics></math> are optimal parameters. Performance drops for <math id="S4.SS3.p1.7.m7.1" class="ltx_Math" alttext="m&lt;16" display="inline"><semantics id="S4.SS3.p1.7.m7.1a"><mrow id="S4.SS3.p1.7.m7.1.1" xref="S4.SS3.p1.7.m7.1.1.cmml"><mi id="S4.SS3.p1.7.m7.1.1.2" xref="S4.SS3.p1.7.m7.1.1.2.cmml">m</mi><mo id="S4.SS3.p1.7.m7.1.1.1" xref="S4.SS3.p1.7.m7.1.1.1.cmml">&lt;</mo><mn id="S4.SS3.p1.7.m7.1.1.3" xref="S4.SS3.p1.7.m7.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.7.m7.1b"><apply id="S4.SS3.p1.7.m7.1.1.cmml" xref="S4.SS3.p1.7.m7.1.1"><lt id="S4.SS3.p1.7.m7.1.1.1.cmml" xref="S4.SS3.p1.7.m7.1.1.1"></lt><ci id="S4.SS3.p1.7.m7.1.1.2.cmml" xref="S4.SS3.p1.7.m7.1.1.2">𝑚</ci><cn type="integer" id="S4.SS3.p1.7.m7.1.1.3.cmml" xref="S4.SS3.p1.7.m7.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.7.m7.1c">m&lt;16</annotation></semantics></math> and is stable for <math id="S4.SS3.p1.8.m8.1" class="ltx_Math" alttext="m&gt;16" display="inline"><semantics id="S4.SS3.p1.8.m8.1a"><mrow id="S4.SS3.p1.8.m8.1.1" xref="S4.SS3.p1.8.m8.1.1.cmml"><mi id="S4.SS3.p1.8.m8.1.1.2" xref="S4.SS3.p1.8.m8.1.1.2.cmml">m</mi><mo id="S4.SS3.p1.8.m8.1.1.1" xref="S4.SS3.p1.8.m8.1.1.1.cmml">&gt;</mo><mn id="S4.SS3.p1.8.m8.1.1.3" xref="S4.SS3.p1.8.m8.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.8.m8.1b"><apply id="S4.SS3.p1.8.m8.1.1.cmml" xref="S4.SS3.p1.8.m8.1.1"><gt id="S4.SS3.p1.8.m8.1.1.1.cmml" xref="S4.SS3.p1.8.m8.1.1.1"></gt><ci id="S4.SS3.p1.8.m8.1.1.2.cmml" xref="S4.SS3.p1.8.m8.1.1.2">𝑚</ci><cn type="integer" id="S4.SS3.p1.8.m8.1.1.3.cmml" xref="S4.SS3.p1.8.m8.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.8.m8.1c">m&gt;16</annotation></semantics></math>, while an optimal performance is seen for <math id="S4.SS3.p1.9.m9.1" class="ltx_Math" alttext="K=8" display="inline"><semantics id="S4.SS3.p1.9.m9.1a"><mrow id="S4.SS3.p1.9.m9.1.1" xref="S4.SS3.p1.9.m9.1.1.cmml"><mi id="S4.SS3.p1.9.m9.1.1.2" xref="S4.SS3.p1.9.m9.1.1.2.cmml">K</mi><mo id="S4.SS3.p1.9.m9.1.1.1" xref="S4.SS3.p1.9.m9.1.1.1.cmml">=</mo><mn id="S4.SS3.p1.9.m9.1.1.3" xref="S4.SS3.p1.9.m9.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.9.m9.1b"><apply id="S4.SS3.p1.9.m9.1.1.cmml" xref="S4.SS3.p1.9.m9.1.1"><eq id="S4.SS3.p1.9.m9.1.1.1.cmml" xref="S4.SS3.p1.9.m9.1.1.1"></eq><ci id="S4.SS3.p1.9.m9.1.1.2.cmml" xref="S4.SS3.p1.9.m9.1.1.2">𝐾</ci><cn type="integer" id="S4.SS3.p1.9.m9.1.1.3.cmml" xref="S4.SS3.p1.9.m9.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.9.m9.1c">K=8</annotation></semantics></math>, in particular for the number questions. In the remaining experiments, we therefore set <math id="S4.SS3.p1.10.m10.1" class="ltx_Math" alttext="K=8" display="inline"><semantics id="S4.SS3.p1.10.m10.1a"><mrow id="S4.SS3.p1.10.m10.1.1" xref="S4.SS3.p1.10.m10.1.1.cmml"><mi id="S4.SS3.p1.10.m10.1.1.2" xref="S4.SS3.p1.10.m10.1.1.2.cmml">K</mi><mo id="S4.SS3.p1.10.m10.1.1.1" xref="S4.SS3.p1.10.m10.1.1.1.cmml">=</mo><mn id="S4.SS3.p1.10.m10.1.1.3" xref="S4.SS3.p1.10.m10.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.10.m10.1b"><apply id="S4.SS3.p1.10.m10.1.1.cmml" xref="S4.SS3.p1.10.m10.1.1"><eq id="S4.SS3.p1.10.m10.1.1.1.cmml" xref="S4.SS3.p1.10.m10.1.1.1"></eq><ci id="S4.SS3.p1.10.m10.1.1.2.cmml" xref="S4.SS3.p1.10.m10.1.1.2">𝐾</ci><cn type="integer" id="S4.SS3.p1.10.m10.1.1.3.cmml" xref="S4.SS3.p1.10.m10.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.10.m10.1c">K=8</annotation></semantics></math> and <math id="S4.SS3.p1.11.m11.1" class="ltx_Math" alttext="m=16" display="inline"><semantics id="S4.SS3.p1.11.m11.1a"><mrow id="S4.SS3.p1.11.m11.1.1" xref="S4.SS3.p1.11.m11.1.1.cmml"><mi id="S4.SS3.p1.11.m11.1.1.2" xref="S4.SS3.p1.11.m11.1.1.2.cmml">m</mi><mo id="S4.SS3.p1.11.m11.1.1.1" xref="S4.SS3.p1.11.m11.1.1.1.cmml">=</mo><mn id="S4.SS3.p1.11.m11.1.1.3" xref="S4.SS3.p1.11.m11.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.11.m11.1b"><apply id="S4.SS3.p1.11.m11.1.1.cmml" xref="S4.SS3.p1.11.m11.1.1"><eq id="S4.SS3.p1.11.m11.1.1.1.cmml" xref="S4.SS3.p1.11.m11.1.1.1"></eq><ci id="S4.SS3.p1.11.m11.1.1.2.cmml" xref="S4.SS3.p1.11.m11.1.1.2">𝑚</ci><cn type="integer" id="S4.SS3.p1.11.m11.1.1.3.cmml" xref="S4.SS3.p1.11.m11.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.11.m11.1c">m=16</annotation></semantics></math>.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para ltx_noindent">
<p id="S4.SS3.p2.1" class="ltx_p">Table <a href="#S4.T1" title="Table 1 ‣ 4.2 Implementation ‣ 4 Evaluation ‣ Learning Conditioned Graph Structures for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows our results on the VQA 2.0 test set. We report results on a single version of our model and compare to recent state of the art VQA methods. We compare our model to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> (<em id="S4.SS3.p2.1.1" class="ltx_emph ltx_font_italic">ReasonNet</em>), the approach by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> (<em id="S4.SS3.p2.1.2" class="ltx_emph ltx_font_italic">Bottom-Up</em>) who won the 2017 VQA challenge <span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>http://www.visualqa.org/</span></span></span>, and the recent approach proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> (<em id="S4.SS3.p2.1.3" class="ltx_emph ltx_font_italic">Counting module</em>) which focuses on optimising counting questions. To highlight the importance of learning the graph structure, we also report results using a k-nearest neighbour graph (based on distances between bounding box centres) (<em id="S4.SS3.p2.1.4" class="ltx_emph ltx_font_italic">kNN graph</em>) as input to the graph convolution layers, and train a baseline model which replaces the graph learning and convolutions with a simple question to image attention (<em id="S4.SS3.p2.1.5" class="ltx_emph ltx_font_italic">Attention</em>). Even though it is simpler than our approach, the <em id="S4.SS3.p2.1.6" class="ltx_emph ltx_font_italic">Attention</em> model provides a good intuition of the advantage of using a graph structure.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para ltx_noindent">
<p id="S4.SS3.p3.1" class="ltx_p">Despite not being heavily engineered to optimise performance, our model’s performance is close to state of the art. It notably improves substantially on numeric questions (with the exception of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, which is specifically designed for this purpose). It should also be noted that both <em id="S4.SS3.p3.1.1" class="ltx_emph ltx_font_italic">Bottom-Up</em> and <em id="S4.SS3.p3.1.2" class="ltx_emph ltx_font_italic">Counting module</em> use the object detector with a variable number of objects per image, while we use a fixed number. Our method compares favourably with our baselines (<em id="S4.SS3.p3.1.3" class="ltx_emph ltx_font_italic">Attention</em>, <em id="S4.SS3.p3.1.4" class="ltx_emph ltx_font_italic">kNN graph</em>). This highlights not only the advantage of learning a graph structure, but also of using an attention based approach, as <em id="S4.SS3.p3.1.5" class="ltx_emph ltx_font_italic">kNN graph</em> is the only method without attention.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/1806.07243/assets/good_examples.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="371" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Visual examples of the learned graph structures for multiple images and questions per image. Boxes and edges thickness/opacity correspond to the strengths of the node degree and edge weight respectively, showing the most graph nodes and edges that were considered to be the most relevant to answer the question. </figcaption>
</figure>
<div id="S4.SS3.p4" class="ltx_para ltx_noindent">
<p id="S4.SS3.p4.1" class="ltx_p">Figures <a href="#S4.F4" title="Figure 4 ‣ 4.3 Results ‣ 4 Evaluation ‣ Learning Conditioned Graph Structures for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> and <a href="#S4.F5" title="Figure 5 ‣ 4.3 Results ‣ 4 Evaluation ‣ Learning Conditioned Graph Structures for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> show examples of learned graph structures for multiple questions and images. Figures <a href="#S4.F4" title="Figure 4 ‣ 4.3 Results ‣ 4 Evaluation ‣ Learning Conditioned Graph Structures for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> and <a href="#S4.F5" title="Figure 5 ‣ 4.3 Results ‣ 4 Evaluation ‣ Learning Conditioned Graph Structures for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> show the most important nodes and edges of each learned graph (largest node degree/number of connections and edge weights respectively). GraphCNNs learn feature representations of the graph nodes that are influenced by their closest neighbours in the graph. As a result, the most important nodes can be seen as the locations where the network is "looking", as they will strongly influence most feature representations. Edges represent the most important relationships between objects. As a result, one can identify whether the network focussed on the right objects by looking at the most relevant nodes, while edge weights inform of the relationships that were considered as the most relevant to answer the question.</p>
</div>
<div id="S4.SS3.p5" class="ltx_para ltx_noindent">
<p id="S4.SS3.p5.1" class="ltx_p">Figure <a href="#S4.F4" title="Figure 4 ‣ 4.3 Results ‣ 4 Evaluation ‣ Learning Conditioned Graph Structures for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> reports examples of graph structures learned leading to successful classification. We report results for multiple questions per image, highlighting how the learned graph is tailored to the question at hand. Figure <a href="#S4.F5" title="Figure 5 ‣ 4.3 Results ‣ 4 Evaluation ‣ Learning Conditioned Graph Structures for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows failure cases and allows to study the interpretability of the proposed model. Figures <a href="#S4.F5" title="Figure 5 ‣ 4.3 Results ‣ 4 Evaluation ‣ Learning Conditioned Graph Structures for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>-a,d show cases where the model looked at the wrong object, mistakes which can be attributed to missing detected objects (correct purse for Fig. <a href="#S4.F5" title="Figure 5 ‣ 4.3 Results ‣ 4 Evaluation ‣ Learning Conditioned Graph Structures for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>-a, man’s face for Fig. <a href="#S4.F5" title="Figure 5 ‣ 4.3 Results ‣ 4 Evaluation ‣ Learning Conditioned Graph Structures for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>-d). Figure <a href="#S4.F5" title="Figure 5 ‣ 4.3 Results ‣ 4 Evaluation ‣ Learning Conditioned Graph Structures for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>-b shows that while the focus is on all animals on the bed, the cat is considered to be the most relevant object, hence the answer. Finally, Fig. <a href="#S4.F5" title="Figure 5 ‣ 4.3 Results ‣ 4 Evaluation ‣ Learning Conditioned Graph Structures for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>-c shows a case that may not be adapted to bounding box based models.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/1806.07243/assets/bad_examples.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="298" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Visual examples of interpretable failures cases. Boxes and edges thickness/opacity correspond to the strengths of the node degree and edge weight respectively, showing the most graph nodes and edges that were considered to be the most relevant to answer the question.</figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Discussion</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p">In this paper, we propose a novel graph-based approach for Visual Question Answering. Our model learns a graph representation of the input image that is conditioned on the question at hand. It then exploits the learned graph structure to learn better image features that are conditioned on the most relevant neighbours, using the novel and powerful concept of graph convolutions. Experiments on the VQA v2 dataset yield promising results and demonstrate the relevance and interpretability of the learned graph structure.</p>
</div>
<div id="S5.p2" class="ltx_para ltx_noindent">
<p id="S5.p2.1" class="ltx_p">Several extensions and improvements could be considered. Our main objective was to show the potential and interpretability of learning a graph structure. We found with a fairly simple architecture the learned graph structure was very effective; further work might want to consider more complex architectures to refine the learned graph further. For example, scalar edge weights may not be able to capture the full complexity of the relationships between graph items and so producing vector edges could yield improvements. This could be implemented as an adjacency matrix per convolutional kernel. An important limitation of our approach is the use of an object detector as a preprocessing step. The performance of the model is highly dependent on the quality of the detector, which can yield duplicates or miss objects (as highlighted in the results section). Furthermore, our image features comprise a fixed number of detected objects per image, which can further enhance this problem. Finally, while the focus of this paper is the VQA problem, our approach could be adapted to more general problems, such as few-shots learning tasks where one could learn a graph structure from training samples.</p>
</div>
<div id="S5.p3" class="ltx_para ltx_noindent">
<p id="S5.p3.1" class="ltx_p">Performance on the VQA v2 dataset is still rather limited, which could be linked to issues within the dataset itself. Indeed, several questions are subjective and cannot be associated with a correct answer (e.g. "Would you want to fly in that plane?") <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. In addition, modelling the problem as multi-class classification is the most common approach in recent VQA methods, and can strongly limit performance. Questions often require answers that cannot be found in the predefined answers (e.g. "what time is it?"). This explains the low performance of "Number" questions, as it comprises several questions requiring answers absent from the training set.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Qi Wu, Damien Teney, Peng Wang, Chunhua Shen, Anthony Dick, and Anton van den
Hengel.

</span>
<span class="ltx_bibblock">Visual question answering: A survey of methods and datasets.

</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">Comput Vis Image Underst</span>, 163:21–40, 2017.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Akira Fukui, Dong Huk Park, Daylen Yang, Anna Rohrbach, Trevor Darrell, and
Marcus Rohrbach.

</span>
<span class="ltx_bibblock">Multimodal compact bilinear pooling for visual question answering and
visual grounding.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1606.01847, 2016.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Damien Teney, Peter Anderson, Xiaodong He, and Anton van den Hengel.

</span>
<span class="ltx_bibblock">Tips and tricks for visual question answering: Learnings from the
2017 challenge.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1708.02711</span>, 2017.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Jiasen Lu, Jianwei Yang, Dhruv Batra, and Devi Parikh.

</span>
<span class="ltx_bibblock">Hierarchical question-image co-attention for visual question
answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">NIPS</span>, pages 289–297. 2016.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Danfei Xu, Yuke Zhu, Christopher B Choy, and Li Fei-Fei.

</span>
<span class="ltx_bibblock">Scene graph generation by iterative message passing.

</span>
<span class="ltx_bibblock">In <span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">CVPR</span>, volume 2, 2017.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Thomas N. Kipf and Max Welling.

</span>
<span class="ltx_bibblock">Semi-supervised classification with graph convolutional networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1609.02907, 2016.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Yujia Li, Daniel Tarlow, Marc Brockschmidt, and Richard S. Zemel.

</span>
<span class="ltx_bibblock">Gated graph sequence neural networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1511.05493, 2015.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Federico Monti, Davide Boscaini, Jonathan Masci, Emanuele Rodolà, Jan
Svoboda, and Michael M. Bronstein.

</span>
<span class="ltx_bibblock">Geometric deep learning on graphs and manifolds using mixture model
cnns.

</span>
<span class="ltx_bibblock">In <span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">CVPR</span>, pages 5425–5434, 2017.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Petar Veličković, Guillem Cucurull, Arantxa Casanova, Adriana Romero,
Pietro Liò, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Graph attention networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">ICLR</span>, 2018.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Damien Teney, Lingqiao Liu, and Anton van den Hengel.

</span>
<span class="ltx_bibblock">Graph-structured representations for visual question answering.

</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">CoRR, abs/1609.05600</span>, 3, 2016.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Yan Zhang, Jonathon S. Hare, and Adam Prügel-Bennett.

</span>
<span class="ltx_bibblock">Learning to count objects in natural images for visual question
answering.

</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">ICLR</span>, 2018.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Michaël Defferrard, Xavier Bresson, and Pierre Vandergheynst.

</span>
<span class="ltx_bibblock">Convolutional neural networks on graphs with fast localized spectral
filtering.

</span>
<span class="ltx_bibblock">In <span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">NIPS</span>, pages 3844–3852, 2016.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Davide Boscaini, Jonathan Masci, Emanuele Rodolà, and Michael Bronstein.

</span>
<span class="ltx_bibblock">Learning shape correspondence with anisotropic convolutional neural
networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">NIPS</span>, pages 3189–3197, 2016.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
David I Shuman, Sunil K Narang, Pascal Frossard, Antonio Ortega, and Pierre
Vandergheynst.

</span>
<span class="ltx_bibblock">The emerging field of signal processing on graphs: Extending
high-dimensional data analysis to networks and other irregular domains.

</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">IEEE Signal Processing Magazine</span>, 30(3):83–98, 2013.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Peter Anderson, Xiaodong He, Chris Buehler, Damien Teney, Mark Johnson, Stephen
Gould, and Lei Zhang.

</span>
<span class="ltx_bibblock">Bottom-up and top-down attention for image captioning and visual
question answering.

</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1707.07998</span>, 2017.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Alexander Trott, Caiming Xiong, and Richard Socher.

</span>
<span class="ltx_bibblock">Interpretable counting for visual question answering.

</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">ICLR</span>, 2018.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Kyunghyun Cho, Bart van Merriënboer, Çaglar Gülçehre,
Dzmitry Bahdanau, Fethi Bougares, Holger Schwenk, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Learning phrase representations using rnn encoder–decoder for
statistical machine translation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">EMNLP</span>, pages 1724–1734, 2014.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Idan Schwartz, Alexander G. Schwing, and Tamir Hazan.

</span>
<span class="ltx_bibblock">High-order attention models for visual question answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">NIPS</span>, pages 3667–3677, 2017.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Ilija Ilievski and Jiashi Feng.

</span>
<span class="ltx_bibblock">Multimodal learning and reasoning for visual question answering.

</span>
<span class="ltx_bibblock">In I. Guyon, U. V. Luxburg, S. Bengio, H. Wallach, R. Fergus,
S. Vishwanathan, and R. Garnett, editors, <span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">NIPS</span>, pages 551–562. 2017.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Yash Goyal, Tejas Khot, Douglas Summers-Stay, Dhruv Batra, and Devi Parikh.

</span>
<span class="ltx_bibblock">Making the V in VQA matter: Elevating the role of image
understanding in Visual Question Answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2017.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Jeffrey Pennington, Richard Socher, and Christopher D. Manning.

</span>
<span class="ltx_bibblock">Glove: Global vectors for word representation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">EMNLP</span>, pages 1532–1543, 2014.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Diederik P Kingma and Jimmy Ba.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1412.6980</span>, 2014.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Kushal Kafle and Christopher Kanan.

</span>
<span class="ltx_bibblock">Visual question answering: Datasets, algorithms, and future
challenges.

</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">Computer Vision and Image Understanding</span>, 163:3–20, 2017.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>

<div id="A1.p1" class="ltx_para ltx_noindent">
<p id="A1.p1.1" class="ltx_p">We provide additional visual examples of learned graph structures for successful question answering (Figure <a href="#A1.F6" title="Figure 6 ‣ Appendix A Appendix ‣ Learning Conditioned Graph Structures for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>) and interpretable failure cases (Figure <a href="#A1.F7" title="Figure 7 ‣ Appendix A Appendix ‣ Learning Conditioned Graph Structures for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>). Figure <a href="#A1.F6" title="Figure 6 ‣ Appendix A Appendix ‣ Learning Conditioned Graph Structures for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> shows cases where relational information is required and where the graph structure allows these comparisons. For example, the top left image compares all instances of sheep in the image to verify whether they all are the same colour. Similarly the bottom right image compares the two women to identify which one has the black top and which one is in the back.</p>
</div>
<div id="A1.p2" class="ltx_para ltx_noindent">
<p id="A1.p2.1" class="ltx_p">Figure <a href="#A1.F7" title="Figure 7 ‣ Appendix A Appendix ‣ Learning Conditioned Graph Structures for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> highlights multiple failure cases. The first image (top left) shows how the classification setting, while helpful to facilitate training and evaluation, can limit the performance of the model. While the model finds the correct answer (one of the sheep is black), the correct explanation is not available amongst the possible classification outputs.</p>
</div>
<div id="A1.p3" class="ltx_para ltx_noindent">
<p id="A1.p3.1" class="ltx_p">The remaining examples show how the learned graph structure allows to interpret incorrect answers. Most of these cases are linked to failures from the object detectors, showing that our proposed method is sensitive to missing detections. In the second image (top right) the object detector fails to create a good bounding box around the mouse, possibly because it is out of focus in the background, and therefore only picks up keyboard keys.</p>
</div>
<figure id="A1.F6" class="ltx_figure"><img src="/html/1806.07243/assets/more_successes.png" id="A1.F6.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="598" height="792" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Visual examples of graph structures leading to successful question answering</figcaption>
</figure>
<div id="A1.p4" class="ltx_para ltx_noindent">
<p id="A1.p4.1" class="ltx_p">The middle left image shows that the model identifies all front facing persons on the image, but misses the person mostly hidden in the background. Once again, this can be linked to the fact that the person in the background is not detected.</p>
</div>
<div id="A1.p5" class="ltx_para ltx_noindent">
<p id="A1.p5.1" class="ltx_p">In the middle right image, the model identifies the person in the background as wearing a sweater as can shown by the highlighted bounding box.</p>
</div>
<div id="A1.p6" class="ltx_para ltx_noindent">
<p id="A1.p6.1" class="ltx_p">For the left bottom image, the model correctly counts all of the people visible on the image, but fails to acknowledge that none of them are on a bridge.</p>
</div>
<div id="A1.p7" class="ltx_para ltx_noindent">
<p id="A1.p7.1" class="ltx_p">In the right bottom image, we can easily see which player is missing from the model’s count based on the selected bounding boxes. Contrarily to the central person, the three men in the background are well detected, so the model focuses on these objects. While the central man was partly detected, this suggests that the model needs similar bounding box detections around each of the relevant objects to count accurately.</p>
</div>
<figure id="A1.F7" class="ltx_figure"><img src="/html/1806.07243/assets/more_failures.png" id="A1.F7.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="598" height="819" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Visual examples of graph structures leading to unsuccessful question answering</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1806.07242" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1806.07243" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1806.07243">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1806.07243" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1806.07244" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sun Mar  3 03:47:27 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
