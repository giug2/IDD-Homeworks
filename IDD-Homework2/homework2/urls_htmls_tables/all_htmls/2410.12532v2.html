<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration</title>
<!--Generated on Thu Oct 17 09:18:09 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.12532v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S1" title="In MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S2" title="In MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S2.SS1" title="In 2 Related Work ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>LLMs in Healthcare Domains</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S2.SS2" title="In 2 Related Work ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>LLM-based Multi-agent Collaboration</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S3" title="In MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S3.SS1" title="In 3 Methodology ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Query Rewriting</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S3.SS2" title="In 3 Methodology ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Intent Recognition</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S3.SS3" title="In 3 Methodology ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Agent Collaboration</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S4" title="In MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S4.SS1" title="In 4 Experiments ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Datasets and Implementation Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S4.SS2" title="In 4 Experiments ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Model Zoo</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S4.SS3" title="In 4 Experiments ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Comparision with SOTA Methods</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S4.SS4" title="In 4 Experiments ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Expert Doctor Evaluation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S4.SS5" title="In 4 Experiments ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Ablation Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S4.SS6" title="In 4 Experiments ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.6 </span>Intent Detection Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S4.SS7" title="In 4 Experiments ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.7 </span>Collaboration Framework Comparison</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S4.SS8" title="In 4 Experiments ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.8 </span>Response Visualization Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S4.SS9" title="In 4 Experiments ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.9 </span>Effect of Agent Number</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S5" title="In MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion and Future Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#A1" title="In MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Implementation Details</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#A1.SS1" title="In Appendix A Implementation Details ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Query Normalization and Parsing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#A1.SS2" title="In Appendix A Implementation Details ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Refined Query Construction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#A1.SS3" title="In Appendix A Implementation Details ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>Training Details of BioBert Encoder</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#A2" title="In MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Prompt Templates</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<h1 class="ltx_title ltx_title_document">
<span class="ltx_text ltx_font_smallcaps" id="id10.id1">MedAide</span>: Towards an Omni Medical Aide via Specialized 
<br class="ltx_break"/>LLM-based Multi-Agent Collaboration</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jinjie Wei<sup class="ltx_sup" id="id11.10.id1">1,2</sup><span class="ltx_note ltx_role_footnote" id="footnotex1"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>Equal contributions. <sup class="ltx_sup" id="footnotex1.1"><span class="ltx_text ltx_font_italic" id="footnotex1.1.1">§</span></sup>Corresponding authors.</span></span></span>   Dingkang Yang<sup class="ltx_sup" id="id12.11.id2">1,2</sup><span class="ltx_note ltx_role_footnote" id="footnotex2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>Equal contributions. <sup class="ltx_sup" id="footnotex2.1"><span class="ltx_text ltx_font_italic" id="footnotex2.1.1">§</span></sup>Corresponding authors.</span></span></span><span class="ltx_note ltx_role_footnotemark" id="footnotex3"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">4</span></span></span></span>   Yanshu Li<sup class="ltx_sup" id="id13.12.id3">3</sup><span class="ltx_note ltx_role_footnote" id="footnotex4"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>Equal contributions. <sup class="ltx_sup" id="footnotex4.1"><span class="ltx_text ltx_font_italic" id="footnotex4.1.1">§</span></sup>Corresponding authors.</span></span></span>   Qingyao Xu<sup class="ltx_sup" id="id14.13.id4">1,2</sup>
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="id7.7.4">Zhaoyu Chen<sup class="ltx_sup" id="id7.7.4.1">1</sup>   Mingcheng Li<sup class="ltx_sup" id="id7.7.4.2">1,2</sup>   Yue Jiang<sup class="ltx_sup" id="id7.7.4.3">1,2</sup>   Xiaolu Hou<sup class="ltx_sup" id="id7.7.4.4">1,2</sup>   Lihua Zhang<sup class="ltx_sup" id="id7.7.4.5">1,2</sup><span class="ltx_note ltx_role_footnotemark" id="footnotex5"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnotex5.1.1.1">4</span></span></span></span></span></span>
<br class="ltx_break"/><sup class="ltx_sup" id="id15.14.id5">1</sup>Academy for Engineering and Technology, Fudan University
<br class="ltx_break"/><sup class="ltx_sup" id="id16.15.id6">2</sup>Cognition and Intelligent Technology Laboratory, Fudan University
<br class="ltx_break"/><sup class="ltx_sup" id="id17.16.id7">3</sup>Brown University
<br class="ltx_break"/><math alttext="\{" class="ltx_Math" display="inline" id="id8.8.m4.1"><semantics id="id8.8.m4.1a"><mo id="id8.8.m4.1.1" stretchy="false" xref="id8.8.m4.1.1.cmml">{</mo><annotation-xml encoding="MathML-Content" id="id8.8.m4.1b"><ci id="id8.8.m4.1.1.cmml" xref="id8.8.m4.1.1">{</ci></annotation-xml><annotation encoding="application/x-tex" id="id8.8.m4.1c">\{</annotation><annotation encoding="application/x-llamapun" id="id8.8.m4.1d">{</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="id9.9.5">dkyang20, lihuazhang<math alttext="\}" class="ltx_Math" display="inline" id="id9.9.5.m1.1"><semantics id="id9.9.5.m1.1a"><mo id="id9.9.5.m1.1.1" stretchy="false" xref="id9.9.5.m1.1.1.cmml">}</mo><annotation-xml encoding="MathML-Content" id="id9.9.5.m1.1b"><ci id="id9.9.5.m1.1.1.cmml" xref="id9.9.5.m1.1.1">}</ci></annotation-xml><annotation encoding="application/x-tex" id="id9.9.5.m1.1c">\}</annotation><annotation encoding="application/x-llamapun" id="id9.9.5.m1.1d">}</annotation></semantics></math>@fudan.edu.cn, jjwei23@m.fudan.edu.cn, yanshu_li1@brown.edu</span>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id18.id1">Large Language Model (LLM)-driven interactive systems currently show potential promise in healthcare domains. Despite their remarkable capabilities, LLMs typically lack personalized recommendations and diagnosis analysis in sophisticated medical applications, causing hallucinations and performance bottlenecks.
To address these challenges, this paper proposes <span class="ltx_text ltx_font_smallcaps" id="id18.id1.1">MedAide</span>, an LLM-based omni medical multi-agent collaboration framework for specialized healthcare services. Specifically, <span class="ltx_text ltx_font_smallcaps" id="id18.id1.2">MedAide</span> first performs query rewriting through retrieval-augmented generation to accomplish accurate medical intent understanding.
Immediately, we devise a contextual encoder to obtain intent prototype embeddings, which are used to recognize fine-grained intents by similarity matching.
According to the intent relevance, the activated agents collaborate effectively to provide integrated decision analysis.
Extensive experiments are conducted on four medical benchmarks with composite intents. Experimental results from automated metrics and expert doctor evaluations show that <span class="ltx_text ltx_font_smallcaps" id="id18.id1.3">MedAide</span> outperforms current LLMs and improves their medical proficiency and strategic reasoning.</p>
</div>
<div class="ltx_para ltx_noindent" id="p1">
<div class="ltx_block ltx_align_bottom" id="p1.9">
<p class="ltx_p" id="p1.9.10"><span class="ltx_text ltx_font_smallcaps" id="p1.9.10.1">MedAide</span><span class="ltx_text ltx_font_bold" id="p1.9.10.2">: Towards an Omni Medical Aide via Specialized 
<br class="ltx_break"/>LLM-based Multi-Agent Collaboration</span></p>
<br class="ltx_break ltx_centering"/>
<p class="ltx_p ltx_align_center" id="p1.9.9" style="width:433.6pt;"><span class="ltx_text ltx_inline-block" id="p1.9.9.9" style="width:0.0pt;">
<span class="ltx_tabular ltx_align_top" id="p1.9.9.9.9">
<span class="ltx_tbody">
<span class="ltx_tr" id="p1.3.3.3.3.3">
<span class="ltx_td ltx_align_center" id="p1.3.3.3.3.3.3"><span class="ltx_text ltx_font_bold" id="p1.3.3.3.3.3.3.3">Jinjie Wei<sup class="ltx_sup" id="p1.3.3.3.3.3.3.3.1">1,2</sup><span class="ltx_note ltx_role_footnote" id="footnotex6"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnotex6.1.1.1">2</span></span>Equal contributions. <sup class="ltx_sup" id="footnotex6.5"><span class="ltx_text ltx_font_medium ltx_font_italic" id="footnotex6.5.1">§</span></sup>Corresponding authors.</span></span></span>   Dingkang Yang<sup class="ltx_sup" id="p1.3.3.3.3.3.3.3.2">1,2</sup><span class="ltx_note ltx_role_footnote" id="footnotex7"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnotex7.1.1.1">2</span></span>Equal contributions. <sup class="ltx_sup" id="footnotex7.5"><span class="ltx_text ltx_font_medium ltx_font_italic" id="footnotex7.5.1">§</span></sup>Corresponding authors.</span></span></span><span class="ltx_note ltx_role_footnotemark" id="footnotex8"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnotex8.1.1.1">4</span></span></span></span></span>   Yanshu Li<sup class="ltx_sup" id="p1.3.3.3.3.3.3.3.3">3</sup><span class="ltx_note ltx_role_footnote" id="footnotex9"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnotex9.1.1.1">2</span></span>Equal contributions. <sup class="ltx_sup" id="footnotex9.5"><span class="ltx_text ltx_font_medium ltx_font_italic" id="footnotex9.5.1">§</span></sup>Corresponding authors.</span></span></span>   Qingyao Xu<sup class="ltx_sup" id="p1.3.3.3.3.3.3.3.4">1,2</sup></span></span></span>
<span class="ltx_tr" id="p1.7.7.7.7.7">
<span class="ltx_td ltx_align_center" id="p1.7.7.7.7.7.4"><span class="ltx_text ltx_font_bold" id="p1.7.7.7.7.7.4.4">Zhaoyu Chen<sup class="ltx_sup" id="p1.7.7.7.7.7.4.4.1">1</sup>   Mingcheng Li<sup class="ltx_sup" id="p1.7.7.7.7.7.4.4.2">1,2</sup>   Yue Jiang<sup class="ltx_sup" id="p1.7.7.7.7.7.4.4.3">1,2</sup>   Xiaolu Hou<sup class="ltx_sup" id="p1.7.7.7.7.7.4.4.4">1,2</sup>   Lihua Zhang<sup class="ltx_sup" id="p1.7.7.7.7.7.4.4.5">1,2</sup><span class="ltx_note ltx_role_footnotemark" id="footnotex10"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnotex10.1.1.1">4</span></span></span></span></span></span></span></span>
<span class="ltx_tr" id="p1.9.9.9.9.10.1">
<span class="ltx_td ltx_align_center" id="p1.9.9.9.9.10.1.1"><sup class="ltx_sup" id="p1.9.9.9.9.10.1.1.1">1</sup>Academy for Engineering and Technology, Fudan University</span></span>
<span class="ltx_tr" id="p1.9.9.9.9.11.2">
<span class="ltx_td ltx_align_center" id="p1.9.9.9.9.11.2.1"><sup class="ltx_sup" id="p1.9.9.9.9.11.2.1.1">2</sup>Cognition and Intelligent Technology Laboratory, Fudan University</span></span>
<span class="ltx_tr" id="p1.9.9.9.9.12.3">
<span class="ltx_td ltx_align_center" id="p1.9.9.9.9.12.3.1"><sup class="ltx_sup" id="p1.9.9.9.9.12.3.1.1">3</sup>Brown University</span></span>
<span class="ltx_tr" id="p1.9.9.9.9.9">
<span class="ltx_td ltx_align_center" id="p1.9.9.9.9.9.2"><math alttext="\{" class="ltx_Math" display="inline" id="p1.8.8.8.8.8.1.m1.1"><semantics id="p1.8.8.8.8.8.1.m1.1a"><mo id="p1.8.8.8.8.8.1.m1.1.1" stretchy="false" xref="p1.8.8.8.8.8.1.m1.1.1.cmml">{</mo><annotation-xml encoding="MathML-Content" id="p1.8.8.8.8.8.1.m1.1b"><ci id="p1.8.8.8.8.8.1.m1.1.1.cmml" xref="p1.8.8.8.8.8.1.m1.1.1">{</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.8.8.8.8.8.1.m1.1c">\{</annotation><annotation encoding="application/x-llamapun" id="p1.8.8.8.8.8.1.m1.1d">{</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="p1.9.9.9.9.9.2.1">dkyang20, lihuazhang<math alttext="\}" class="ltx_Math" display="inline" id="p1.9.9.9.9.9.2.1.m1.1"><semantics id="p1.9.9.9.9.9.2.1.m1.1a"><mo id="p1.9.9.9.9.9.2.1.m1.1.1" stretchy="false" xref="p1.9.9.9.9.9.2.1.m1.1.1.cmml">}</mo><annotation-xml encoding="MathML-Content" id="p1.9.9.9.9.9.2.1.m1.1b"><ci id="p1.9.9.9.9.9.2.1.m1.1.1.cmml" xref="p1.9.9.9.9.9.2.1.m1.1.1">}</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.9.9.9.9.9.2.1.m1.1c">\}</annotation><annotation encoding="application/x-llamapun" id="p1.9.9.9.9.9.2.1.m1.1d">}</annotation></semantics></math>@fudan.edu.cn, jjwei23@m.fudan.edu.cn, yanshu_li1@brown.edu</span></span></span>
</span>
</span></span></p>
<br class="ltx_break ltx_centering"/>
</div>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Developing the goal-oriented conversation system <cite class="ltx_cite ltx_citemacro_cite">Lee et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib19" title="">2024</a>); Cheng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib10" title="">2023</a>)</cite> has received increasing attention in recent years. Advanced Large Language Models (LLMs) <cite class="ltx_cite ltx_citemacro_cite">OpenAI (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib24" title="">2022</a>); Achiam et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib3" title="">2023</a>); OpenAI (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib25" title="">2024</a>)</cite> have shown exceptional generalization capabilities in general scenarios for multiple purposes within human-machine interactions, such as negotiation <cite class="ltx_cite ltx_citemacro_cite">He et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib15" title="">2018</a>)</cite> and persuasion <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib30" title="">2019</a>)</cite>.
In this context, LLM-centered interactive medical assistants <cite class="ltx_cite ltx_citemacro_cite">Bao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib5" title="">2023</a>); Yang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib36" title="">2024a</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib38" title="">2023b</a>); Shi (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib28" title="">2023</a>); Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib9" title="">2023b</a>)</cite> have become research hotspots that promise to improve diagnosis efficiency and promote service automation.
Previous attempts infuse LLMs with healthcare-specific knowledge through relevant corpus construction (<span class="ltx_text ltx_font_italic" id="S1.p1.1.1">e.g.,</span> knowledge databases <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib23" title="">2023b</a>)</cite>) and multi-stage training procedures (<span class="ltx_text ltx_font_italic" id="S1.p1.1.2">e.g.,</span> supervised fine-tuning <cite class="ltx_cite ltx_citemacro_cite">Xiong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib33" title="">2023</a>)</cite>). Although these strategies stimulate the models’ comprehension of medically relevant intents, there are still bottlenecks when faced with real-world applications that require sophisticated reasoning.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Given the mimicking of learned feedback in human behaviors <cite class="ltx_cite ltx_citemacro_cite">Du et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib12" title="">2023</a>); Park et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib26" title="">2023</a>)</cite>, automated medical agent construction promises to enhance LLMs’ instruction following and logical profiling capabilities <cite class="ltx_cite ltx_citemacro_cite">Lee et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib19" title="">2024</a>)</cite>.
The collaboration among multiple agents to handle different patient inquiries and symptomatic caseloads facilitates accurate dialog goal fulfillment while accounting for individual differences <cite class="ltx_cite ltx_citemacro_cite">Fan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib14" title="">2024</a>); Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib21" title="">2024</a>)</cite>.
Despite significant advancements, current efforts focus primarily on medical education training <cite class="ltx_cite ltx_citemacro_cite">Wei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib31" title="">2024</a>)</cite> or selective question-answering <cite class="ltx_cite ltx_citemacro_cite">Tang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib29" title="">2024</a>)</cite>, lacking understanding of complicated intents behind user queries and giving hierarchical therapeutic recommendations.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">To address these issues, this paper proposes an LLM-based omni medical agent framework for real-world medical applications, called <span class="ltx_text ltx_font_smallcaps" id="S1.p3.1.1">MedAide</span>.
The core philosophy of <span class="ltx_text ltx_font_smallcaps" id="S1.p3.1.2">MedAide</span> lies in first complementing and decomposing multi-dimensional medical intents through query rewriting to enhance the model’s dissection of composite medical queries. Then, we introduce a contextual encoder to learn intent prototype embeddings from multifaceted instructions, which is utilized to specify fine-grained target intents via the similarity matching lemma.
In this case, different paramedical agents are correspondingly activated to provide personalized determinations with specialized medical expertise.
Ultimately, we formulate a decision analysis module with Chain-of-Thought (CoT) properties to summarize the responses of activated agents in a faithful manner to make integrated decisions.
The main contributions are summarized as follows:</p>
</div>
<div class="ltx_para" id="S1.p4">
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">To the best of our knowledge, we are the first to propose the omni multi-agent collaboration framework for real-world scenarios with composite healthcare intents, which shows potential for advancing interactive systems for personalized healthcare.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">Our <span class="ltx_text ltx_font_smallcaps" id="S1.I1.i2.p1.1.1">MedAide</span> effectively improves the strategic reasoning of LLMs under complicated dialog goals through feedback and collaboration of specialized paramedical agents.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Extensive experiments on seven medical benchmarks spanning 17 types of rich intents prove the effectiveness of <span class="ltx_text ltx_font_smallcaps" id="S1.I1.i3.p1.1.1">MedAide</span>. As a plug-and-play framework, <span class="ltx_text ltx_font_smallcaps" id="S1.I1.i3.p1.1.2">MedAide</span> can be readily combined with current LLMs and provides competitive improvements.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>LLMs in Healthcare Domains</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">The Large Language Models (LLMs) exemplified by ChatGPT <cite class="ltx_cite ltx_citemacro_citep">(OpenAI, <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib24" title="">2022</a>)</cite> and GPT-4 <cite class="ltx_cite ltx_citemacro_cite">Achiam et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib3" title="">2023</a>)</cite> demonstrate excellent performance in multidisciplinary applications.
Although current LLMs <cite class="ltx_cite ltx_citemacro_cite">Bai (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib1" title="">2023</a>); Yang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib35" title="">2023a</a>); AI (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib4" title="">2024</a>)</cite> with certain medical knowledge benefit from large-scale corpus support, they lack specialized medical proficiency and have significant performance bottlenecks in domain-specific scenarios.
Recently, several attempts <cite class="ltx_cite ltx_citemacro_cite">Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib9" title="">2023b</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib8" title="">a</a>); Xu (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib34" title="">2023</a>); Bao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib5" title="">2023</a>); Yang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib36" title="">2024a</a>)</cite> have begun to build medically customized LLM assistants to fulfill the diagnostic and consultative demands.
For instance, HuatuoGPT series <cite class="ltx_cite ltx_citemacro_cite">Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib39" title="">2023</a>); Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib8" title="">2023a</a>)</cite> have shown promising results in bridging generic-medical knowledge gaps by absorbing real doctor-patient conversations.
ZhongJing series <cite class="ltx_cite ltx_citemacro_cite">Yang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib38" title="">2023b</a>); Shi (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib28" title="">2023</a>)</cite> improve Chinese medical capabilities by introducing expert feedback and multi-round medical instructions.
In addition, PediatricsGPT <cite class="ltx_cite ltx_citemacro_cite">Yang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib36" title="">2024a</a>)</cite> proposes a systematic training framework to construct interactive healthcare systems for pediatric specialists and medical generalists. Unlike previous studies, our framework aims to more fully recognize medical intents and refine the models’ reasoning abilities in complex scenarios through the LLM-based multi-agent collaboration.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>LLM-based Multi-agent Collaboration</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">With the focus of researchers on sophisticated goal-oriented dialog generation <cite class="ltx_cite ltx_citemacro_cite">Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib32" title="">2023</a>); Fan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib14" title="">2024</a>); Jiang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib17" title="">2024</a>)</cite>, the inherent dilemmas of hallucinatory responses and weak comprehension <cite class="ltx_cite ltx_citemacro_cite">Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib7" title="">2024</a>); Yang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib37" title="">2024b</a>)</cite> in LLMs have been gradually exposed.
In this context, LLM-based automated agents are proposed to provide effective perception and decision-making skilfulness by incorporating external tools and databases <cite class="ltx_cite ltx_citemacro_cite">Cai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib6" title="">2023</a>); Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib22" title="">2023a</a>)</cite>.
By mimicking human behavioral logic, multiple agents perform feedback and collaboration to enhance diverse intent understanding tasks, including educational training <cite class="ltx_cite ltx_citemacro_cite">Lee et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib19" title="">2024</a>); Wei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib31" title="">2024</a>)</cite>, emotional comfort <cite class="ltx_cite ltx_citemacro_cite">Cheng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib10" title="">2023</a>)</cite>, and workflow integration <cite class="ltx_cite ltx_citemacro_cite">Hong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib16" title="">2023</a>)</cite>.
For example, MEDCO <cite class="ltx_cite ltx_citemacro_cite">Wei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib31" title="">2024</a>)</cite> enables LLMs to simulate patients and doctors to enhance the practice performance of virtual students in interactive environments. MedAgents <cite class="ltx_cite ltx_citemacro_cite">Tang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib29" title="">2024</a>)</cite> improves the performance of medical assistants in zero-shot settings through the role-playing strategy.
In comparison, the proposed <span class="ltx_text ltx_font_smallcaps" id="S2.SS2.p1.1.1">MedAide</span> focuses more on mining profound healthcare intents and moving towards robust healthcare practices.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S3.F1" title="Figure 1 ‣ 3 Methodology ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">1</span></a> presents the overall procedure of the proposed <span class="ltx_text ltx_font_smallcaps" id="S3.p1.1.1">MedAide</span>.
Here, we detail the systematic workflow procedure, including query rewriting, intent recognition, and agent collaboration.</p>
</div>
<figure class="ltx_figure" id="S3.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="328" id="S3.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Illustration of the proposed <span class="ltx_text ltx_font_smallcaps" id="S3.F1.6.1">MedAide</span> framework.
<span class="ltx_text ltx_font_smallcaps" id="S3.F1.7.2">MedAide</span> consists of three major phases: (i) <span class="ltx_text ltx_font_italic" id="S3.F1.8.3">query rewriting</span> aims to reformulate medical queries and mine user intents to ensure the system accurately understands the input requirement goals. Among the optimized queries, (ii) <span class="ltx_text ltx_font_italic" id="S3.F1.9.4">intent recognition</span> utilizes a designed contextual encoder to semantically match distinct medical intents to achieve accurate intent recognition. Based on the recognition results, (iii) <span class="ltx_text ltx_font_italic" id="S3.F1.10.5">agent collaboration</span> dynamically activates the corresponding paramedical agents. Then, a decision analysis module incorporates the outputs of multiple agents and generates integrated analysis results.
</figcaption>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Query Rewriting</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.7">In this phase, we first process the initial query through the query input processor.
The processor is based on a set of syntactic regularization algorithms that combine LLMs with a predefined ruleset <math alttext="R" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_R</annotation></semantics></math> (please refer to Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#A1.SS1" title="A.1 Query Normalization and Parsing ‣ Appendix A Implementation Details ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">A.1</span></a> for details). The core concept is to check, optimize, and normalize user input to <math alttext="Q_{std}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">Q</mi><mrow id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml"><mi id="S3.SS1.p1.2.m2.1.1.3.2" xref="S3.SS1.p1.2.m2.1.1.3.2.cmml">s</mi><mo id="S3.SS1.p1.2.m2.1.1.3.1" xref="S3.SS1.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.2.m2.1.1.3.3" xref="S3.SS1.p1.2.m2.1.1.3.3.cmml">t</mi><mo id="S3.SS1.p1.2.m2.1.1.3.1a" xref="S3.SS1.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.2.m2.1.1.3.4" xref="S3.SS1.p1.2.m2.1.1.3.4.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝑄</ci><apply id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3"><times id="S3.SS1.p1.2.m2.1.1.3.1.cmml" xref="S3.SS1.p1.2.m2.1.1.3.1"></times><ci id="S3.SS1.p1.2.m2.1.1.3.2.cmml" xref="S3.SS1.p1.2.m2.1.1.3.2">𝑠</ci><ci id="S3.SS1.p1.2.m2.1.1.3.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3.3">𝑡</ci><ci id="S3.SS1.p1.2.m2.1.1.3.4.cmml" xref="S3.SS1.p1.2.m2.1.1.3.4">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">Q_{std}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_Q start_POSTSUBSCRIPT italic_s italic_t italic_d end_POSTSUBSCRIPT</annotation></semantics></math>. Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#alg1" title="Algorithm 1 ‣ 3.1 Query Rewriting ‣ 3 Methodology ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">1</span></a> shows the corresponding program.
Then, a key element extractor distills critical information from <math alttext="Q_{std}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">Q</mi><mrow id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3.2" xref="S3.SS1.p1.3.m3.1.1.3.2.cmml">s</mi><mo id="S3.SS1.p1.3.m3.1.1.3.1" xref="S3.SS1.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.3.m3.1.1.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3.cmml">t</mi><mo id="S3.SS1.p1.3.m3.1.1.3.1a" xref="S3.SS1.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.3.m3.1.1.3.4" xref="S3.SS1.p1.3.m3.1.1.3.4.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝑄</ci><apply id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3"><times id="S3.SS1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.1"></times><ci id="S3.SS1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2">𝑠</ci><ci id="S3.SS1.p1.3.m3.1.1.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3">𝑡</ci><ci id="S3.SS1.p1.3.m3.1.1.3.4.cmml" xref="S3.SS1.p1.3.m3.1.1.3.4">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">Q_{std}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_Q start_POSTSUBSCRIPT italic_s italic_t italic_d end_POSTSUBSCRIPT</annotation></semantics></math>, such as symptoms, condition descriptions, and medical histories, to form the element set <math alttext="E_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">E</mi><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝐸</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">E_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. In the Retrieval-Augmented Generation (RAG), we build an indexed database of 1,095 expert-reviewed medical guidelines and retrieve documents related to these elements using a semantic retrieval method  <cite class="ltx_cite ltx_citemacro_cite">Lewis et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib20" title="">2021</a>)</cite>, forming the document set <math alttext="D_{ref}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><msub id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">D</mi><mrow id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml"><mi id="S3.SS1.p1.5.m5.1.1.3.2" xref="S3.SS1.p1.5.m5.1.1.3.2.cmml">r</mi><mo id="S3.SS1.p1.5.m5.1.1.3.1" xref="S3.SS1.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.5.m5.1.1.3.3" xref="S3.SS1.p1.5.m5.1.1.3.3.cmml">e</mi><mo id="S3.SS1.p1.5.m5.1.1.3.1a" xref="S3.SS1.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.5.m5.1.1.3.4" xref="S3.SS1.p1.5.m5.1.1.3.4.cmml">f</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝐷</ci><apply id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3"><times id="S3.SS1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS1.p1.5.m5.1.1.3.1"></times><ci id="S3.SS1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS1.p1.5.m5.1.1.3.2">𝑟</ci><ci id="S3.SS1.p1.5.m5.1.1.3.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3.3">𝑒</ci><ci id="S3.SS1.p1.5.m5.1.1.3.4.cmml" xref="S3.SS1.p1.5.m5.1.1.3.4">𝑓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">D_{ref}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_D start_POSTSUBSCRIPT italic_r italic_e italic_f end_POSTSUBSCRIPT</annotation></semantics></math>.
After that, the recall analysis module selects the conforming documents by prompting guidance, which is fed into the LLM-based query prompter along with <math alttext="Q_{std}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><msub id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">Q</mi><mrow id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml"><mi id="S3.SS1.p1.6.m6.1.1.3.2" xref="S3.SS1.p1.6.m6.1.1.3.2.cmml">s</mi><mo id="S3.SS1.p1.6.m6.1.1.3.1" xref="S3.SS1.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.6.m6.1.1.3.3" xref="S3.SS1.p1.6.m6.1.1.3.3.cmml">t</mi><mo id="S3.SS1.p1.6.m6.1.1.3.1a" xref="S3.SS1.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.6.m6.1.1.3.4" xref="S3.SS1.p1.6.m6.1.1.3.4.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝑄</ci><apply id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3"><times id="S3.SS1.p1.6.m6.1.1.3.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3.1"></times><ci id="S3.SS1.p1.6.m6.1.1.3.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2">𝑠</ci><ci id="S3.SS1.p1.6.m6.1.1.3.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3">𝑡</ci><ci id="S3.SS1.p1.6.m6.1.1.3.4.cmml" xref="S3.SS1.p1.6.m6.1.1.3.4">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">Q_{std}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_Q start_POSTSUBSCRIPT italic_s italic_t italic_d end_POSTSUBSCRIPT</annotation></semantics></math>.
The prompter optimizes the empirical information and efficient decomposition of composite intents. Eventually, we design a refined query constructor to merge and integrate the generated subqueries. It filters and reconstructs multiple subqueries <math alttext="Q_{gen}" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><msub id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><mi id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml">Q</mi><mrow id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml"><mi id="S3.SS1.p1.7.m7.1.1.3.2" xref="S3.SS1.p1.7.m7.1.1.3.2.cmml">g</mi><mo id="S3.SS1.p1.7.m7.1.1.3.1" xref="S3.SS1.p1.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.7.m7.1.1.3.3" xref="S3.SS1.p1.7.m7.1.1.3.3.cmml">e</mi><mo id="S3.SS1.p1.7.m7.1.1.3.1a" xref="S3.SS1.p1.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.7.m7.1.1.3.4" xref="S3.SS1.p1.7.m7.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2">𝑄</ci><apply id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3"><times id="S3.SS1.p1.7.m7.1.1.3.1.cmml" xref="S3.SS1.p1.7.m7.1.1.3.1"></times><ci id="S3.SS1.p1.7.m7.1.1.3.2.cmml" xref="S3.SS1.p1.7.m7.1.1.3.2">𝑔</ci><ci id="S3.SS1.p1.7.m7.1.1.3.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3.3">𝑒</ci><ci id="S3.SS1.p1.7.m7.1.1.3.4.cmml" xref="S3.SS1.p1.7.m7.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">Q_{gen}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">italic_Q start_POSTSUBSCRIPT italic_g italic_e italic_n end_POSTSUBSCRIPT</annotation></semantics></math> with a predefined ruleset (please refer to Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#A1.SS2" title="A.2 Refined Query Construction ‣ Appendix A Implementation Details ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">A.2</span></a> for details) to ensure semantically complete and formally uniform output.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> LLM-Based Input Standardization</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">  <span class="ltx_text ltx_font_bold" id="alg1.l1.1">Input:</span> User query <math alttext="Q_{input}" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><msub id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">Q</mi><mrow id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml"><mi id="alg1.l1.m1.1.1.3.2" xref="alg1.l1.m1.1.1.3.2.cmml">i</mi><mo id="alg1.l1.m1.1.1.3.1" xref="alg1.l1.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m1.1.1.3.3" xref="alg1.l1.m1.1.1.3.3.cmml">n</mi><mo id="alg1.l1.m1.1.1.3.1a" xref="alg1.l1.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m1.1.1.3.4" xref="alg1.l1.m1.1.1.3.4.cmml">p</mi><mo id="alg1.l1.m1.1.1.3.1b" xref="alg1.l1.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m1.1.1.3.5" xref="alg1.l1.m1.1.1.3.5.cmml">u</mi><mo id="alg1.l1.m1.1.1.3.1c" xref="alg1.l1.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m1.1.1.3.6" xref="alg1.l1.m1.1.1.3.6.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1">subscript</csymbol><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝑄</ci><apply id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3"><times id="alg1.l1.m1.1.1.3.1.cmml" xref="alg1.l1.m1.1.1.3.1"></times><ci id="alg1.l1.m1.1.1.3.2.cmml" xref="alg1.l1.m1.1.1.3.2">𝑖</ci><ci id="alg1.l1.m1.1.1.3.3.cmml" xref="alg1.l1.m1.1.1.3.3">𝑛</ci><ci id="alg1.l1.m1.1.1.3.4.cmml" xref="alg1.l1.m1.1.1.3.4">𝑝</ci><ci id="alg1.l1.m1.1.1.3.5.cmml" xref="alg1.l1.m1.1.1.3.5">𝑢</ci><ci id="alg1.l1.m1.1.1.3.6.cmml" xref="alg1.l1.m1.1.1.3.6">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">Q_{input}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_Q start_POSTSUBSCRIPT italic_i italic_n italic_p italic_u italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, Large Language Model <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">caligraphic_M</annotation></semantics></math>, Set of rules <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="alg1.l1.m3.1"><semantics id="alg1.l1.m3.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m3.1d">caligraphic_R</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l2">  <span class="ltx_text ltx_font_bold" id="alg1.l2.1">Output:</span> Standardized query <math alttext="Q_{std}" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><msub id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">Q</mi><mrow id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml"><mi id="alg1.l2.m1.1.1.3.2" xref="alg1.l2.m1.1.1.3.2.cmml">s</mi><mo id="alg1.l2.m1.1.1.3.1" xref="alg1.l2.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.3.3" xref="alg1.l2.m1.1.1.3.3.cmml">t</mi><mo id="alg1.l2.m1.1.1.3.1a" xref="alg1.l2.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.3.4" xref="alg1.l2.m1.1.1.3.4.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">subscript</csymbol><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑄</ci><apply id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3"><times id="alg1.l2.m1.1.1.3.1.cmml" xref="alg1.l2.m1.1.1.3.1"></times><ci id="alg1.l2.m1.1.1.3.2.cmml" xref="alg1.l2.m1.1.1.3.2">𝑠</ci><ci id="alg1.l2.m1.1.1.3.3.cmml" xref="alg1.l2.m1.1.1.3.3">𝑡</ci><ci id="alg1.l2.m1.1.1.3.4.cmml" xref="alg1.l2.m1.1.1.3.4">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">Q_{std}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_Q start_POSTSUBSCRIPT italic_s italic_t italic_d end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l3">  <span class="ltx_text ltx_font_bold" id="alg1.l3.1">Initialize:</span> <math alttext="Q_{cur}\leftarrow Q_{input}" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><msub id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml"><mi id="alg1.l3.m1.1.1.2.2" xref="alg1.l3.m1.1.1.2.2.cmml">Q</mi><mrow id="alg1.l3.m1.1.1.2.3" xref="alg1.l3.m1.1.1.2.3.cmml"><mi id="alg1.l3.m1.1.1.2.3.2" xref="alg1.l3.m1.1.1.2.3.2.cmml">c</mi><mo id="alg1.l3.m1.1.1.2.3.1" xref="alg1.l3.m1.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l3.m1.1.1.2.3.3" xref="alg1.l3.m1.1.1.2.3.3.cmml">u</mi><mo id="alg1.l3.m1.1.1.2.3.1a" xref="alg1.l3.m1.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l3.m1.1.1.2.3.4" xref="alg1.l3.m1.1.1.2.3.4.cmml">r</mi></mrow></msub><mo id="alg1.l3.m1.1.1.1" stretchy="false" xref="alg1.l3.m1.1.1.1.cmml">←</mo><msub id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml"><mi id="alg1.l3.m1.1.1.3.2" xref="alg1.l3.m1.1.1.3.2.cmml">Q</mi><mrow id="alg1.l3.m1.1.1.3.3" xref="alg1.l3.m1.1.1.3.3.cmml"><mi id="alg1.l3.m1.1.1.3.3.2" xref="alg1.l3.m1.1.1.3.3.2.cmml">i</mi><mo id="alg1.l3.m1.1.1.3.3.1" xref="alg1.l3.m1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l3.m1.1.1.3.3.3" xref="alg1.l3.m1.1.1.3.3.3.cmml">n</mi><mo id="alg1.l3.m1.1.1.3.3.1a" xref="alg1.l3.m1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l3.m1.1.1.3.3.4" xref="alg1.l3.m1.1.1.3.3.4.cmml">p</mi><mo id="alg1.l3.m1.1.1.3.3.1b" xref="alg1.l3.m1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l3.m1.1.1.3.3.5" xref="alg1.l3.m1.1.1.3.3.5.cmml">u</mi><mo id="alg1.l3.m1.1.1.3.3.1c" xref="alg1.l3.m1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l3.m1.1.1.3.3.6" xref="alg1.l3.m1.1.1.3.3.6.cmml">t</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><ci id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1">←</ci><apply id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.2.1.cmml" xref="alg1.l3.m1.1.1.2">subscript</csymbol><ci id="alg1.l3.m1.1.1.2.2.cmml" xref="alg1.l3.m1.1.1.2.2">𝑄</ci><apply id="alg1.l3.m1.1.1.2.3.cmml" xref="alg1.l3.m1.1.1.2.3"><times id="alg1.l3.m1.1.1.2.3.1.cmml" xref="alg1.l3.m1.1.1.2.3.1"></times><ci id="alg1.l3.m1.1.1.2.3.2.cmml" xref="alg1.l3.m1.1.1.2.3.2">𝑐</ci><ci id="alg1.l3.m1.1.1.2.3.3.cmml" xref="alg1.l3.m1.1.1.2.3.3">𝑢</ci><ci id="alg1.l3.m1.1.1.2.3.4.cmml" xref="alg1.l3.m1.1.1.2.3.4">𝑟</ci></apply></apply><apply id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.3.1.cmml" xref="alg1.l3.m1.1.1.3">subscript</csymbol><ci id="alg1.l3.m1.1.1.3.2.cmml" xref="alg1.l3.m1.1.1.3.2">𝑄</ci><apply id="alg1.l3.m1.1.1.3.3.cmml" xref="alg1.l3.m1.1.1.3.3"><times id="alg1.l3.m1.1.1.3.3.1.cmml" xref="alg1.l3.m1.1.1.3.3.1"></times><ci id="alg1.l3.m1.1.1.3.3.2.cmml" xref="alg1.l3.m1.1.1.3.3.2">𝑖</ci><ci id="alg1.l3.m1.1.1.3.3.3.cmml" xref="alg1.l3.m1.1.1.3.3.3">𝑛</ci><ci id="alg1.l3.m1.1.1.3.3.4.cmml" xref="alg1.l3.m1.1.1.3.3.4">𝑝</ci><ci id="alg1.l3.m1.1.1.3.3.5.cmml" xref="alg1.l3.m1.1.1.3.3.5">𝑢</ci><ci id="alg1.l3.m1.1.1.3.3.6.cmml" xref="alg1.l3.m1.1.1.3.3.6">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">Q_{cur}\leftarrow Q_{input}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">italic_Q start_POSTSUBSCRIPT italic_c italic_u italic_r end_POSTSUBSCRIPT ← italic_Q start_POSTSUBSCRIPT italic_i italic_n italic_p italic_u italic_t end_POSTSUBSCRIPT</annotation></semantics></math>,<math alttext="converged\leftarrow\text{False}" class="ltx_Math" display="inline" id="alg1.l3.m2.1"><semantics id="alg1.l3.m2.1a"><mrow id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml"><mrow id="alg1.l3.m2.1.1.2" xref="alg1.l3.m2.1.1.2.cmml"><mi id="alg1.l3.m2.1.1.2.2" xref="alg1.l3.m2.1.1.2.2.cmml">c</mi><mo id="alg1.l3.m2.1.1.2.1" xref="alg1.l3.m2.1.1.2.1.cmml">⁢</mo><mi id="alg1.l3.m2.1.1.2.3" xref="alg1.l3.m2.1.1.2.3.cmml">o</mi><mo id="alg1.l3.m2.1.1.2.1a" xref="alg1.l3.m2.1.1.2.1.cmml">⁢</mo><mi id="alg1.l3.m2.1.1.2.4" xref="alg1.l3.m2.1.1.2.4.cmml">n</mi><mo id="alg1.l3.m2.1.1.2.1b" xref="alg1.l3.m2.1.1.2.1.cmml">⁢</mo><mi id="alg1.l3.m2.1.1.2.5" xref="alg1.l3.m2.1.1.2.5.cmml">v</mi><mo id="alg1.l3.m2.1.1.2.1c" xref="alg1.l3.m2.1.1.2.1.cmml">⁢</mo><mi id="alg1.l3.m2.1.1.2.6" xref="alg1.l3.m2.1.1.2.6.cmml">e</mi><mo id="alg1.l3.m2.1.1.2.1d" xref="alg1.l3.m2.1.1.2.1.cmml">⁢</mo><mi id="alg1.l3.m2.1.1.2.7" xref="alg1.l3.m2.1.1.2.7.cmml">r</mi><mo id="alg1.l3.m2.1.1.2.1e" xref="alg1.l3.m2.1.1.2.1.cmml">⁢</mo><mi id="alg1.l3.m2.1.1.2.8" xref="alg1.l3.m2.1.1.2.8.cmml">g</mi><mo id="alg1.l3.m2.1.1.2.1f" xref="alg1.l3.m2.1.1.2.1.cmml">⁢</mo><mi id="alg1.l3.m2.1.1.2.9" xref="alg1.l3.m2.1.1.2.9.cmml">e</mi><mo id="alg1.l3.m2.1.1.2.1g" xref="alg1.l3.m2.1.1.2.1.cmml">⁢</mo><mi id="alg1.l3.m2.1.1.2.10" xref="alg1.l3.m2.1.1.2.10.cmml">d</mi></mrow><mo id="alg1.l3.m2.1.1.1" stretchy="false" xref="alg1.l3.m2.1.1.1.cmml">←</mo><mtext id="alg1.l3.m2.1.1.3" xref="alg1.l3.m2.1.1.3a.cmml">False</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><apply id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1"><ci id="alg1.l3.m2.1.1.1.cmml" xref="alg1.l3.m2.1.1.1">←</ci><apply id="alg1.l3.m2.1.1.2.cmml" xref="alg1.l3.m2.1.1.2"><times id="alg1.l3.m2.1.1.2.1.cmml" xref="alg1.l3.m2.1.1.2.1"></times><ci id="alg1.l3.m2.1.1.2.2.cmml" xref="alg1.l3.m2.1.1.2.2">𝑐</ci><ci id="alg1.l3.m2.1.1.2.3.cmml" xref="alg1.l3.m2.1.1.2.3">𝑜</ci><ci id="alg1.l3.m2.1.1.2.4.cmml" xref="alg1.l3.m2.1.1.2.4">𝑛</ci><ci id="alg1.l3.m2.1.1.2.5.cmml" xref="alg1.l3.m2.1.1.2.5">𝑣</ci><ci id="alg1.l3.m2.1.1.2.6.cmml" xref="alg1.l3.m2.1.1.2.6">𝑒</ci><ci id="alg1.l3.m2.1.1.2.7.cmml" xref="alg1.l3.m2.1.1.2.7">𝑟</ci><ci id="alg1.l3.m2.1.1.2.8.cmml" xref="alg1.l3.m2.1.1.2.8">𝑔</ci><ci id="alg1.l3.m2.1.1.2.9.cmml" xref="alg1.l3.m2.1.1.2.9">𝑒</ci><ci id="alg1.l3.m2.1.1.2.10.cmml" xref="alg1.l3.m2.1.1.2.10">𝑑</ci></apply><ci id="alg1.l3.m2.1.1.3a.cmml" xref="alg1.l3.m2.1.1.3"><mtext id="alg1.l3.m2.1.1.3.cmml" xref="alg1.l3.m2.1.1.3">False</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">converged\leftarrow\text{False}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m2.1d">italic_c italic_o italic_n italic_v italic_e italic_r italic_g italic_e italic_d ← False</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l4">  <span class="ltx_text ltx_font_bold" id="alg1.l4.1">while</span> not <math alttext="converged" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">c</mi><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">o</mi><mo id="alg1.l4.m1.1.1.1a" xref="alg1.l4.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.4" xref="alg1.l4.m1.1.1.4.cmml">n</mi><mo id="alg1.l4.m1.1.1.1b" xref="alg1.l4.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.5" xref="alg1.l4.m1.1.1.5.cmml">v</mi><mo id="alg1.l4.m1.1.1.1c" xref="alg1.l4.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.6" xref="alg1.l4.m1.1.1.6.cmml">e</mi><mo id="alg1.l4.m1.1.1.1d" xref="alg1.l4.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.7" xref="alg1.l4.m1.1.1.7.cmml">r</mi><mo id="alg1.l4.m1.1.1.1e" xref="alg1.l4.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.8" xref="alg1.l4.m1.1.1.8.cmml">g</mi><mo id="alg1.l4.m1.1.1.1f" xref="alg1.l4.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.9" xref="alg1.l4.m1.1.1.9.cmml">e</mi><mo id="alg1.l4.m1.1.1.1g" xref="alg1.l4.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.10" xref="alg1.l4.m1.1.1.10.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><times id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></times><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑐</ci><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">𝑜</ci><ci id="alg1.l4.m1.1.1.4.cmml" xref="alg1.l4.m1.1.1.4">𝑛</ci><ci id="alg1.l4.m1.1.1.5.cmml" xref="alg1.l4.m1.1.1.5">𝑣</ci><ci id="alg1.l4.m1.1.1.6.cmml" xref="alg1.l4.m1.1.1.6">𝑒</ci><ci id="alg1.l4.m1.1.1.7.cmml" xref="alg1.l4.m1.1.1.7">𝑟</ci><ci id="alg1.l4.m1.1.1.8.cmml" xref="alg1.l4.m1.1.1.8">𝑔</ci><ci id="alg1.l4.m1.1.1.9.cmml" xref="alg1.l4.m1.1.1.9">𝑒</ci><ci id="alg1.l4.m1.1.1.10.cmml" xref="alg1.l4.m1.1.1.10">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">converged</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_c italic_o italic_n italic_v italic_e italic_r italic_g italic_e italic_d</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l4.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l5">     <math alttext="converged\leftarrow\text{True}" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mrow id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml"><mi id="alg1.l5.m1.1.1.2.2" xref="alg1.l5.m1.1.1.2.2.cmml">c</mi><mo id="alg1.l5.m1.1.1.2.1" xref="alg1.l5.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.2.3" xref="alg1.l5.m1.1.1.2.3.cmml">o</mi><mo id="alg1.l5.m1.1.1.2.1a" xref="alg1.l5.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.2.4" xref="alg1.l5.m1.1.1.2.4.cmml">n</mi><mo id="alg1.l5.m1.1.1.2.1b" xref="alg1.l5.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.2.5" xref="alg1.l5.m1.1.1.2.5.cmml">v</mi><mo id="alg1.l5.m1.1.1.2.1c" xref="alg1.l5.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.2.6" xref="alg1.l5.m1.1.1.2.6.cmml">e</mi><mo id="alg1.l5.m1.1.1.2.1d" xref="alg1.l5.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.2.7" xref="alg1.l5.m1.1.1.2.7.cmml">r</mi><mo id="alg1.l5.m1.1.1.2.1e" xref="alg1.l5.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.2.8" xref="alg1.l5.m1.1.1.2.8.cmml">g</mi><mo id="alg1.l5.m1.1.1.2.1f" xref="alg1.l5.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.2.9" xref="alg1.l5.m1.1.1.2.9.cmml">e</mi><mo id="alg1.l5.m1.1.1.2.1g" xref="alg1.l5.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.2.10" xref="alg1.l5.m1.1.1.2.10.cmml">d</mi></mrow><mo id="alg1.l5.m1.1.1.1" stretchy="false" xref="alg1.l5.m1.1.1.1.cmml">←</mo><mtext id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3a.cmml">True</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><ci id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1">←</ci><apply id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2"><times id="alg1.l5.m1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.2.1"></times><ci id="alg1.l5.m1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.2.2">𝑐</ci><ci id="alg1.l5.m1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.2.3">𝑜</ci><ci id="alg1.l5.m1.1.1.2.4.cmml" xref="alg1.l5.m1.1.1.2.4">𝑛</ci><ci id="alg1.l5.m1.1.1.2.5.cmml" xref="alg1.l5.m1.1.1.2.5">𝑣</ci><ci id="alg1.l5.m1.1.1.2.6.cmml" xref="alg1.l5.m1.1.1.2.6">𝑒</ci><ci id="alg1.l5.m1.1.1.2.7.cmml" xref="alg1.l5.m1.1.1.2.7">𝑟</ci><ci id="alg1.l5.m1.1.1.2.8.cmml" xref="alg1.l5.m1.1.1.2.8">𝑔</ci><ci id="alg1.l5.m1.1.1.2.9.cmml" xref="alg1.l5.m1.1.1.2.9">𝑒</ci><ci id="alg1.l5.m1.1.1.2.10.cmml" xref="alg1.l5.m1.1.1.2.10">𝑑</ci></apply><ci id="alg1.l5.m1.1.1.3a.cmml" xref="alg1.l5.m1.1.1.3"><mtext id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">True</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">converged\leftarrow\text{True}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_c italic_o italic_n italic_v italic_e italic_r italic_g italic_e italic_d ← True</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l6">     <span class="ltx_text ltx_font_bold" id="alg1.l6.1">for</span> each rule <math alttext="r\in\mathcal{R}" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">r</mi><mo id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">ℛ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><in id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1"></in><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝑟</ci><ci id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">ℛ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">r\in\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_r ∈ caligraphic_R</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l6.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l7">        <math alttext="Q_{new}\leftarrow\mathcal{M}(Q_{cur},r)" class="ltx_Math" display="inline" id="alg1.l7.m1.2"><semantics id="alg1.l7.m1.2a"><mrow id="alg1.l7.m1.2.2" xref="alg1.l7.m1.2.2.cmml"><msub id="alg1.l7.m1.2.2.3" xref="alg1.l7.m1.2.2.3.cmml"><mi id="alg1.l7.m1.2.2.3.2" xref="alg1.l7.m1.2.2.3.2.cmml">Q</mi><mrow id="alg1.l7.m1.2.2.3.3" xref="alg1.l7.m1.2.2.3.3.cmml"><mi id="alg1.l7.m1.2.2.3.3.2" xref="alg1.l7.m1.2.2.3.3.2.cmml">n</mi><mo id="alg1.l7.m1.2.2.3.3.1" xref="alg1.l7.m1.2.2.3.3.1.cmml">⁢</mo><mi id="alg1.l7.m1.2.2.3.3.3" xref="alg1.l7.m1.2.2.3.3.3.cmml">e</mi><mo id="alg1.l7.m1.2.2.3.3.1a" xref="alg1.l7.m1.2.2.3.3.1.cmml">⁢</mo><mi id="alg1.l7.m1.2.2.3.3.4" xref="alg1.l7.m1.2.2.3.3.4.cmml">w</mi></mrow></msub><mo id="alg1.l7.m1.2.2.2" stretchy="false" xref="alg1.l7.m1.2.2.2.cmml">←</mo><mrow id="alg1.l7.m1.2.2.1" xref="alg1.l7.m1.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.2.2.1.3" xref="alg1.l7.m1.2.2.1.3.cmml">ℳ</mi><mo id="alg1.l7.m1.2.2.1.2" xref="alg1.l7.m1.2.2.1.2.cmml">⁢</mo><mrow id="alg1.l7.m1.2.2.1.1.1" xref="alg1.l7.m1.2.2.1.1.2.cmml"><mo id="alg1.l7.m1.2.2.1.1.1.2" stretchy="false" xref="alg1.l7.m1.2.2.1.1.2.cmml">(</mo><msub id="alg1.l7.m1.2.2.1.1.1.1" xref="alg1.l7.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l7.m1.2.2.1.1.1.1.2" xref="alg1.l7.m1.2.2.1.1.1.1.2.cmml">Q</mi><mrow id="alg1.l7.m1.2.2.1.1.1.1.3" xref="alg1.l7.m1.2.2.1.1.1.1.3.cmml"><mi id="alg1.l7.m1.2.2.1.1.1.1.3.2" xref="alg1.l7.m1.2.2.1.1.1.1.3.2.cmml">c</mi><mo id="alg1.l7.m1.2.2.1.1.1.1.3.1" xref="alg1.l7.m1.2.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l7.m1.2.2.1.1.1.1.3.3" xref="alg1.l7.m1.2.2.1.1.1.1.3.3.cmml">u</mi><mo id="alg1.l7.m1.2.2.1.1.1.1.3.1a" xref="alg1.l7.m1.2.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l7.m1.2.2.1.1.1.1.3.4" xref="alg1.l7.m1.2.2.1.1.1.1.3.4.cmml">r</mi></mrow></msub><mo id="alg1.l7.m1.2.2.1.1.1.3" xref="alg1.l7.m1.2.2.1.1.2.cmml">,</mo><mi id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">r</mi><mo id="alg1.l7.m1.2.2.1.1.1.4" stretchy="false" xref="alg1.l7.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.2b"><apply id="alg1.l7.m1.2.2.cmml" xref="alg1.l7.m1.2.2"><ci id="alg1.l7.m1.2.2.2.cmml" xref="alg1.l7.m1.2.2.2">←</ci><apply id="alg1.l7.m1.2.2.3.cmml" xref="alg1.l7.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.3.1.cmml" xref="alg1.l7.m1.2.2.3">subscript</csymbol><ci id="alg1.l7.m1.2.2.3.2.cmml" xref="alg1.l7.m1.2.2.3.2">𝑄</ci><apply id="alg1.l7.m1.2.2.3.3.cmml" xref="alg1.l7.m1.2.2.3.3"><times id="alg1.l7.m1.2.2.3.3.1.cmml" xref="alg1.l7.m1.2.2.3.3.1"></times><ci id="alg1.l7.m1.2.2.3.3.2.cmml" xref="alg1.l7.m1.2.2.3.3.2">𝑛</ci><ci id="alg1.l7.m1.2.2.3.3.3.cmml" xref="alg1.l7.m1.2.2.3.3.3">𝑒</ci><ci id="alg1.l7.m1.2.2.3.3.4.cmml" xref="alg1.l7.m1.2.2.3.3.4">𝑤</ci></apply></apply><apply id="alg1.l7.m1.2.2.1.cmml" xref="alg1.l7.m1.2.2.1"><times id="alg1.l7.m1.2.2.1.2.cmml" xref="alg1.l7.m1.2.2.1.2"></times><ci id="alg1.l7.m1.2.2.1.3.cmml" xref="alg1.l7.m1.2.2.1.3">ℳ</ci><interval closure="open" id="alg1.l7.m1.2.2.1.1.2.cmml" xref="alg1.l7.m1.2.2.1.1.1"><apply id="alg1.l7.m1.2.2.1.1.1.1.cmml" xref="alg1.l7.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l7.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg1.l7.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l7.m1.2.2.1.1.1.1.2">𝑄</ci><apply id="alg1.l7.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l7.m1.2.2.1.1.1.1.3"><times id="alg1.l7.m1.2.2.1.1.1.1.3.1.cmml" xref="alg1.l7.m1.2.2.1.1.1.1.3.1"></times><ci id="alg1.l7.m1.2.2.1.1.1.1.3.2.cmml" xref="alg1.l7.m1.2.2.1.1.1.1.3.2">𝑐</ci><ci id="alg1.l7.m1.2.2.1.1.1.1.3.3.cmml" xref="alg1.l7.m1.2.2.1.1.1.1.3.3">𝑢</ci><ci id="alg1.l7.m1.2.2.1.1.1.1.3.4.cmml" xref="alg1.l7.m1.2.2.1.1.1.1.3.4">𝑟</ci></apply></apply><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">𝑟</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.2c">Q_{new}\leftarrow\mathcal{M}(Q_{cur},r)</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.2d">italic_Q start_POSTSUBSCRIPT italic_n italic_e italic_w end_POSTSUBSCRIPT ← caligraphic_M ( italic_Q start_POSTSUBSCRIPT italic_c italic_u italic_r end_POSTSUBSCRIPT , italic_r )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l8">        <span class="ltx_text ltx_font_bold" id="alg1.l8.1">if</span> <math alttext="Q_{new}\neq Q_{cur}" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><msub id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml"><mi id="alg1.l8.m1.1.1.2.2" xref="alg1.l8.m1.1.1.2.2.cmml">Q</mi><mrow id="alg1.l8.m1.1.1.2.3" xref="alg1.l8.m1.1.1.2.3.cmml"><mi id="alg1.l8.m1.1.1.2.3.2" xref="alg1.l8.m1.1.1.2.3.2.cmml">n</mi><mo id="alg1.l8.m1.1.1.2.3.1" xref="alg1.l8.m1.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.2.3.3" xref="alg1.l8.m1.1.1.2.3.3.cmml">e</mi><mo id="alg1.l8.m1.1.1.2.3.1a" xref="alg1.l8.m1.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.2.3.4" xref="alg1.l8.m1.1.1.2.3.4.cmml">w</mi></mrow></msub><mo id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">≠</mo><msub id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml"><mi id="alg1.l8.m1.1.1.3.2" xref="alg1.l8.m1.1.1.3.2.cmml">Q</mi><mrow id="alg1.l8.m1.1.1.3.3" xref="alg1.l8.m1.1.1.3.3.cmml"><mi id="alg1.l8.m1.1.1.3.3.2" xref="alg1.l8.m1.1.1.3.3.2.cmml">c</mi><mo id="alg1.l8.m1.1.1.3.3.1" xref="alg1.l8.m1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.3.3.3" xref="alg1.l8.m1.1.1.3.3.3.cmml">u</mi><mo id="alg1.l8.m1.1.1.3.3.1a" xref="alg1.l8.m1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.3.3.4" xref="alg1.l8.m1.1.1.3.3.4.cmml">r</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><neq id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1"></neq><apply id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.2.1.cmml" xref="alg1.l8.m1.1.1.2">subscript</csymbol><ci id="alg1.l8.m1.1.1.2.2.cmml" xref="alg1.l8.m1.1.1.2.2">𝑄</ci><apply id="alg1.l8.m1.1.1.2.3.cmml" xref="alg1.l8.m1.1.1.2.3"><times id="alg1.l8.m1.1.1.2.3.1.cmml" xref="alg1.l8.m1.1.1.2.3.1"></times><ci id="alg1.l8.m1.1.1.2.3.2.cmml" xref="alg1.l8.m1.1.1.2.3.2">𝑛</ci><ci id="alg1.l8.m1.1.1.2.3.3.cmml" xref="alg1.l8.m1.1.1.2.3.3">𝑒</ci><ci id="alg1.l8.m1.1.1.2.3.4.cmml" xref="alg1.l8.m1.1.1.2.3.4">𝑤</ci></apply></apply><apply id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.3">subscript</csymbol><ci id="alg1.l8.m1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.3.2">𝑄</ci><apply id="alg1.l8.m1.1.1.3.3.cmml" xref="alg1.l8.m1.1.1.3.3"><times id="alg1.l8.m1.1.1.3.3.1.cmml" xref="alg1.l8.m1.1.1.3.3.1"></times><ci id="alg1.l8.m1.1.1.3.3.2.cmml" xref="alg1.l8.m1.1.1.3.3.2">𝑐</ci><ci id="alg1.l8.m1.1.1.3.3.3.cmml" xref="alg1.l8.m1.1.1.3.3.3">𝑢</ci><ci id="alg1.l8.m1.1.1.3.3.4.cmml" xref="alg1.l8.m1.1.1.3.3.4">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">Q_{new}\neq Q_{cur}</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_Q start_POSTSUBSCRIPT italic_n italic_e italic_w end_POSTSUBSCRIPT ≠ italic_Q start_POSTSUBSCRIPT italic_c italic_u italic_r end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l8.2">then</span>
</div>
<div class="ltx_listingline" id="alg1.l9">           <math alttext="Q_{cur}\leftarrow Q_{new}" class="ltx_Math" display="inline" id="alg1.l9.m1.1"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><msub id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml"><mi id="alg1.l9.m1.1.1.2.2" xref="alg1.l9.m1.1.1.2.2.cmml">Q</mi><mrow id="alg1.l9.m1.1.1.2.3" xref="alg1.l9.m1.1.1.2.3.cmml"><mi id="alg1.l9.m1.1.1.2.3.2" xref="alg1.l9.m1.1.1.2.3.2.cmml">c</mi><mo id="alg1.l9.m1.1.1.2.3.1" xref="alg1.l9.m1.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.2.3.3" xref="alg1.l9.m1.1.1.2.3.3.cmml">u</mi><mo id="alg1.l9.m1.1.1.2.3.1a" xref="alg1.l9.m1.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.2.3.4" xref="alg1.l9.m1.1.1.2.3.4.cmml">r</mi></mrow></msub><mo id="alg1.l9.m1.1.1.1" stretchy="false" xref="alg1.l9.m1.1.1.1.cmml">←</mo><msub id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"><mi id="alg1.l9.m1.1.1.3.2" xref="alg1.l9.m1.1.1.3.2.cmml">Q</mi><mrow id="alg1.l9.m1.1.1.3.3" xref="alg1.l9.m1.1.1.3.3.cmml"><mi id="alg1.l9.m1.1.1.3.3.2" xref="alg1.l9.m1.1.1.3.3.2.cmml">n</mi><mo id="alg1.l9.m1.1.1.3.3.1" xref="alg1.l9.m1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.3.3.3" xref="alg1.l9.m1.1.1.3.3.3.cmml">e</mi><mo id="alg1.l9.m1.1.1.3.3.1a" xref="alg1.l9.m1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.3.3.4" xref="alg1.l9.m1.1.1.3.3.4.cmml">w</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><ci id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1">←</ci><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.2">subscript</csymbol><ci id="alg1.l9.m1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.2.2">𝑄</ci><apply id="alg1.l9.m1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.2.3"><times id="alg1.l9.m1.1.1.2.3.1.cmml" xref="alg1.l9.m1.1.1.2.3.1"></times><ci id="alg1.l9.m1.1.1.2.3.2.cmml" xref="alg1.l9.m1.1.1.2.3.2">𝑐</ci><ci id="alg1.l9.m1.1.1.2.3.3.cmml" xref="alg1.l9.m1.1.1.2.3.3">𝑢</ci><ci id="alg1.l9.m1.1.1.2.3.4.cmml" xref="alg1.l9.m1.1.1.2.3.4">𝑟</ci></apply></apply><apply id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.3.2">𝑄</ci><apply id="alg1.l9.m1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.3.3"><times id="alg1.l9.m1.1.1.3.3.1.cmml" xref="alg1.l9.m1.1.1.3.3.1"></times><ci id="alg1.l9.m1.1.1.3.3.2.cmml" xref="alg1.l9.m1.1.1.3.3.2">𝑛</ci><ci id="alg1.l9.m1.1.1.3.3.3.cmml" xref="alg1.l9.m1.1.1.3.3.3">𝑒</ci><ci id="alg1.l9.m1.1.1.3.3.4.cmml" xref="alg1.l9.m1.1.1.3.3.4">𝑤</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">Q_{cur}\leftarrow Q_{new}</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">italic_Q start_POSTSUBSCRIPT italic_c italic_u italic_r end_POSTSUBSCRIPT ← italic_Q start_POSTSUBSCRIPT italic_n italic_e italic_w end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l10">           <math alttext="converged\leftarrow\text{False}" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mrow id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml"><mi id="alg1.l10.m1.1.1.2.2" xref="alg1.l10.m1.1.1.2.2.cmml">c</mi><mo id="alg1.l10.m1.1.1.2.1" xref="alg1.l10.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.2.3" xref="alg1.l10.m1.1.1.2.3.cmml">o</mi><mo id="alg1.l10.m1.1.1.2.1a" xref="alg1.l10.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.2.4" xref="alg1.l10.m1.1.1.2.4.cmml">n</mi><mo id="alg1.l10.m1.1.1.2.1b" xref="alg1.l10.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.2.5" xref="alg1.l10.m1.1.1.2.5.cmml">v</mi><mo id="alg1.l10.m1.1.1.2.1c" xref="alg1.l10.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.2.6" xref="alg1.l10.m1.1.1.2.6.cmml">e</mi><mo id="alg1.l10.m1.1.1.2.1d" xref="alg1.l10.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.2.7" xref="alg1.l10.m1.1.1.2.7.cmml">r</mi><mo id="alg1.l10.m1.1.1.2.1e" xref="alg1.l10.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.2.8" xref="alg1.l10.m1.1.1.2.8.cmml">g</mi><mo id="alg1.l10.m1.1.1.2.1f" xref="alg1.l10.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.2.9" xref="alg1.l10.m1.1.1.2.9.cmml">e</mi><mo id="alg1.l10.m1.1.1.2.1g" xref="alg1.l10.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.2.10" xref="alg1.l10.m1.1.1.2.10.cmml">d</mi></mrow><mo id="alg1.l10.m1.1.1.1" stretchy="false" xref="alg1.l10.m1.1.1.1.cmml">←</mo><mtext id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3a.cmml">False</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><ci id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1">←</ci><apply id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2"><times id="alg1.l10.m1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1.2.1"></times><ci id="alg1.l10.m1.1.1.2.2.cmml" xref="alg1.l10.m1.1.1.2.2">𝑐</ci><ci id="alg1.l10.m1.1.1.2.3.cmml" xref="alg1.l10.m1.1.1.2.3">𝑜</ci><ci id="alg1.l10.m1.1.1.2.4.cmml" xref="alg1.l10.m1.1.1.2.4">𝑛</ci><ci id="alg1.l10.m1.1.1.2.5.cmml" xref="alg1.l10.m1.1.1.2.5">𝑣</ci><ci id="alg1.l10.m1.1.1.2.6.cmml" xref="alg1.l10.m1.1.1.2.6">𝑒</ci><ci id="alg1.l10.m1.1.1.2.7.cmml" xref="alg1.l10.m1.1.1.2.7">𝑟</ci><ci id="alg1.l10.m1.1.1.2.8.cmml" xref="alg1.l10.m1.1.1.2.8">𝑔</ci><ci id="alg1.l10.m1.1.1.2.9.cmml" xref="alg1.l10.m1.1.1.2.9">𝑒</ci><ci id="alg1.l10.m1.1.1.2.10.cmml" xref="alg1.l10.m1.1.1.2.10">𝑑</ci></apply><ci id="alg1.l10.m1.1.1.3a.cmml" xref="alg1.l10.m1.1.1.3"><mtext id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">False</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">converged\leftarrow\text{False}</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">italic_c italic_o italic_n italic_v italic_e italic_r italic_g italic_e italic_d ← False</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l11">        <span class="ltx_text ltx_font_bold" id="alg1.l11.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l11.2">if</span>
</div>
<div class="ltx_listingline" id="alg1.l12">     <span class="ltx_text ltx_font_bold" id="alg1.l12.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l12.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l13">  <span class="ltx_text ltx_font_bold" id="alg1.l13.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l13.2">while</span>
</div>
<div class="ltx_listingline" id="alg1.l14">  <span class="ltx_text ltx_font_bold" id="alg1.l14.1">return</span> <math alttext="Q_{std}\leftarrow Q_{cur}" class="ltx_Math" display="inline" id="alg1.l14.m1.1"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><msub id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml"><mi id="alg1.l14.m1.1.1.2.2" xref="alg1.l14.m1.1.1.2.2.cmml">Q</mi><mrow id="alg1.l14.m1.1.1.2.3" xref="alg1.l14.m1.1.1.2.3.cmml"><mi id="alg1.l14.m1.1.1.2.3.2" xref="alg1.l14.m1.1.1.2.3.2.cmml">s</mi><mo id="alg1.l14.m1.1.1.2.3.1" xref="alg1.l14.m1.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l14.m1.1.1.2.3.3" xref="alg1.l14.m1.1.1.2.3.3.cmml">t</mi><mo id="alg1.l14.m1.1.1.2.3.1a" xref="alg1.l14.m1.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l14.m1.1.1.2.3.4" xref="alg1.l14.m1.1.1.2.3.4.cmml">d</mi></mrow></msub><mo id="alg1.l14.m1.1.1.1" stretchy="false" xref="alg1.l14.m1.1.1.1.cmml">←</mo><msub id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml"><mi id="alg1.l14.m1.1.1.3.2" xref="alg1.l14.m1.1.1.3.2.cmml">Q</mi><mrow id="alg1.l14.m1.1.1.3.3" xref="alg1.l14.m1.1.1.3.3.cmml"><mi id="alg1.l14.m1.1.1.3.3.2" xref="alg1.l14.m1.1.1.3.3.2.cmml">c</mi><mo id="alg1.l14.m1.1.1.3.3.1" xref="alg1.l14.m1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l14.m1.1.1.3.3.3" xref="alg1.l14.m1.1.1.3.3.3.cmml">u</mi><mo id="alg1.l14.m1.1.1.3.3.1a" xref="alg1.l14.m1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l14.m1.1.1.3.3.4" xref="alg1.l14.m1.1.1.3.3.4.cmml">r</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><ci id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1">←</ci><apply id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.2.1.cmml" xref="alg1.l14.m1.1.1.2">subscript</csymbol><ci id="alg1.l14.m1.1.1.2.2.cmml" xref="alg1.l14.m1.1.1.2.2">𝑄</ci><apply id="alg1.l14.m1.1.1.2.3.cmml" xref="alg1.l14.m1.1.1.2.3"><times id="alg1.l14.m1.1.1.2.3.1.cmml" xref="alg1.l14.m1.1.1.2.3.1"></times><ci id="alg1.l14.m1.1.1.2.3.2.cmml" xref="alg1.l14.m1.1.1.2.3.2">𝑠</ci><ci id="alg1.l14.m1.1.1.2.3.3.cmml" xref="alg1.l14.m1.1.1.2.3.3">𝑡</ci><ci id="alg1.l14.m1.1.1.2.3.4.cmml" xref="alg1.l14.m1.1.1.2.3.4">𝑑</ci></apply></apply><apply id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.3.1.cmml" xref="alg1.l14.m1.1.1.3">subscript</csymbol><ci id="alg1.l14.m1.1.1.3.2.cmml" xref="alg1.l14.m1.1.1.3.2">𝑄</ci><apply id="alg1.l14.m1.1.1.3.3.cmml" xref="alg1.l14.m1.1.1.3.3"><times id="alg1.l14.m1.1.1.3.3.1.cmml" xref="alg1.l14.m1.1.1.3.3.1"></times><ci id="alg1.l14.m1.1.1.3.3.2.cmml" xref="alg1.l14.m1.1.1.3.3.2">𝑐</ci><ci id="alg1.l14.m1.1.1.3.3.3.cmml" xref="alg1.l14.m1.1.1.3.3.3">𝑢</ci><ci id="alg1.l14.m1.1.1.3.3.4.cmml" xref="alg1.l14.m1.1.1.3.3.4">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">Q_{std}\leftarrow Q_{cur}</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.1d">italic_Q start_POSTSUBSCRIPT italic_s italic_t italic_d end_POSTSUBSCRIPT ← italic_Q start_POSTSUBSCRIPT italic_c italic_u italic_r end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Intent Recognition</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.4">After the query rewriting, the optimized query <math alttext="Q_{opt}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">Q</mi><mrow id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.2" xref="S3.SS2.p1.1.m1.1.1.3.2.cmml">o</mi><mo id="S3.SS2.p1.1.m1.1.1.3.1" xref="S3.SS2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.1.m1.1.1.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.cmml">p</mi><mo id="S3.SS2.p1.1.m1.1.1.3.1a" xref="S3.SS2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.1.m1.1.1.3.4" xref="S3.SS2.p1.1.m1.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝑄</ci><apply id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3"><times id="S3.SS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.1"></times><ci id="S3.SS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2">𝑜</ci><ci id="S3.SS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3">𝑝</ci><ci id="S3.SS2.p1.1.m1.1.1.3.4.cmml" xref="S3.SS2.p1.1.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">Q_{opt}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_Q start_POSTSUBSCRIPT italic_o italic_p italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is matched with a set of intent prototype embeddings <math alttext="E_{i}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">E</mi><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝐸</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">E_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> generated by a contextual encoder, which is designed to capture the semantic features of different medical intents.
The encoder is constructed on top of BioBERT <cite class="ltx_cite ltx_citemacro_cite">Lee et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib18" title="">2019</a>)</cite> to learn prototype representations by performing fine-grained intent classification.
We add a fully connected layer after the embedding layer with output dimensions aligned to the 17 medical intent categories and generate the corresponding probability distributions via a softmax activation function.
Specifically, the contextual encoder maps the optimized query together with the intent embeddings into a 768-dimensional embedding space. It computes the cosine similarity <math alttext="S_{ij}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">S</mi><mrow id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml"><mi id="S3.SS2.p1.3.m3.1.1.3.2" xref="S3.SS2.p1.3.m3.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p1.3.m3.1.1.3.1" xref="S3.SS2.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.3.m3.1.1.3.3" xref="S3.SS2.p1.3.m3.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝑆</ci><apply id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3"><times id="S3.SS2.p1.3.m3.1.1.3.1.cmml" xref="S3.SS2.p1.3.m3.1.1.3.1"></times><ci id="S3.SS2.p1.3.m3.1.1.3.2.cmml" xref="S3.SS2.p1.3.m3.1.1.3.2">𝑖</ci><ci id="S3.SS2.p1.3.m3.1.1.3.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">S_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_S start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> between the query and each intent embedding <math alttext="E_{i}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">E</mi><mi id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝐸</ci><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">E_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">italic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> with the following formula:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="S_{ij}=\frac{Q_{opt}\cdot E_{i}}{\left\|Q_{opt}\right\|\left\|E_{i}\right\|}." class="ltx_Math" display="block" id="S3.E1.m1.3"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><msub id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.1.2.cmml"><mi id="S3.E1.m1.3.3.1.1.2.2" xref="S3.E1.m1.3.3.1.1.2.2.cmml">S</mi><mrow id="S3.E1.m1.3.3.1.1.2.3" xref="S3.E1.m1.3.3.1.1.2.3.cmml"><mi id="S3.E1.m1.3.3.1.1.2.3.2" xref="S3.E1.m1.3.3.1.1.2.3.2.cmml">i</mi><mo id="S3.E1.m1.3.3.1.1.2.3.1" xref="S3.E1.m1.3.3.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.2.3.3" xref="S3.E1.m1.3.3.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.cmml">=</mo><mfrac id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml"><mrow id="S3.E1.m1.2.2.4" xref="S3.E1.m1.2.2.4.cmml"><msub id="S3.E1.m1.2.2.4.2" xref="S3.E1.m1.2.2.4.2.cmml"><mi id="S3.E1.m1.2.2.4.2.2" xref="S3.E1.m1.2.2.4.2.2.cmml">Q</mi><mrow id="S3.E1.m1.2.2.4.2.3" xref="S3.E1.m1.2.2.4.2.3.cmml"><mi id="S3.E1.m1.2.2.4.2.3.2" xref="S3.E1.m1.2.2.4.2.3.2.cmml">o</mi><mo id="S3.E1.m1.2.2.4.2.3.1" xref="S3.E1.m1.2.2.4.2.3.1.cmml">⁢</mo><mi id="S3.E1.m1.2.2.4.2.3.3" xref="S3.E1.m1.2.2.4.2.3.3.cmml">p</mi><mo id="S3.E1.m1.2.2.4.2.3.1a" xref="S3.E1.m1.2.2.4.2.3.1.cmml">⁢</mo><mi id="S3.E1.m1.2.2.4.2.3.4" xref="S3.E1.m1.2.2.4.2.3.4.cmml">t</mi></mrow></msub><mo id="S3.E1.m1.2.2.4.1" lspace="0.222em" rspace="0.222em" xref="S3.E1.m1.2.2.4.1.cmml">⋅</mo><msub id="S3.E1.m1.2.2.4.3" xref="S3.E1.m1.2.2.4.3.cmml"><mi id="S3.E1.m1.2.2.4.3.2" xref="S3.E1.m1.2.2.4.3.2.cmml">E</mi><mi id="S3.E1.m1.2.2.4.3.3" xref="S3.E1.m1.2.2.4.3.3.cmml">i</mi></msub></mrow><mrow id="S3.E1.m1.2.2.2" xref="S3.E1.m1.2.2.2.cmml"><mrow id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.2.cmml"><mo id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.1.cmml">‖</mo><msub id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.2.cmml">Q</mi><mrow id="S3.E1.m1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.3.2.cmml">o</mi><mo id="S3.E1.m1.1.1.1.1.1.1.3.1" xref="S3.E1.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E1.m1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.3.3.cmml">p</mi><mo id="S3.E1.m1.1.1.1.1.1.1.3.1a" xref="S3.E1.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E1.m1.1.1.1.1.1.1.3.4" xref="S3.E1.m1.1.1.1.1.1.1.3.4.cmml">t</mi></mrow></msub><mo id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="S3.E1.m1.2.2.2.3" xref="S3.E1.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E1.m1.2.2.2.2.1" xref="S3.E1.m1.2.2.2.2.2.cmml"><mo id="S3.E1.m1.2.2.2.2.1.2" xref="S3.E1.m1.2.2.2.2.2.1.cmml">‖</mo><msub id="S3.E1.m1.2.2.2.2.1.1" xref="S3.E1.m1.2.2.2.2.1.1.cmml"><mi id="S3.E1.m1.2.2.2.2.1.1.2" xref="S3.E1.m1.2.2.2.2.1.1.2.cmml">E</mi><mi id="S3.E1.m1.2.2.2.2.1.1.3" xref="S3.E1.m1.2.2.2.2.1.1.3.cmml">i</mi></msub><mo id="S3.E1.m1.2.2.2.2.1.3" xref="S3.E1.m1.2.2.2.2.2.1.cmml">‖</mo></mrow></mrow></mfrac></mrow><mo id="S3.E1.m1.3.3.1.2" lspace="0em" xref="S3.E1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1"><eq id="S3.E1.m1.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1"></eq><apply id="S3.E1.m1.3.3.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2">𝑆</ci><apply id="S3.E1.m1.3.3.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.3"><times id="S3.E1.m1.3.3.1.1.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.3.1"></times><ci id="S3.E1.m1.3.3.1.1.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.3.2">𝑖</ci><ci id="S3.E1.m1.3.3.1.1.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2"><divide id="S3.E1.m1.2.2.3.cmml" xref="S3.E1.m1.2.2"></divide><apply id="S3.E1.m1.2.2.4.cmml" xref="S3.E1.m1.2.2.4"><ci id="S3.E1.m1.2.2.4.1.cmml" xref="S3.E1.m1.2.2.4.1">⋅</ci><apply id="S3.E1.m1.2.2.4.2.cmml" xref="S3.E1.m1.2.2.4.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.4.2.1.cmml" xref="S3.E1.m1.2.2.4.2">subscript</csymbol><ci id="S3.E1.m1.2.2.4.2.2.cmml" xref="S3.E1.m1.2.2.4.2.2">𝑄</ci><apply id="S3.E1.m1.2.2.4.2.3.cmml" xref="S3.E1.m1.2.2.4.2.3"><times id="S3.E1.m1.2.2.4.2.3.1.cmml" xref="S3.E1.m1.2.2.4.2.3.1"></times><ci id="S3.E1.m1.2.2.4.2.3.2.cmml" xref="S3.E1.m1.2.2.4.2.3.2">𝑜</ci><ci id="S3.E1.m1.2.2.4.2.3.3.cmml" xref="S3.E1.m1.2.2.4.2.3.3">𝑝</ci><ci id="S3.E1.m1.2.2.4.2.3.4.cmml" xref="S3.E1.m1.2.2.4.2.3.4">𝑡</ci></apply></apply><apply id="S3.E1.m1.2.2.4.3.cmml" xref="S3.E1.m1.2.2.4.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.4.3.1.cmml" xref="S3.E1.m1.2.2.4.3">subscript</csymbol><ci id="S3.E1.m1.2.2.4.3.2.cmml" xref="S3.E1.m1.2.2.4.3.2">𝐸</ci><ci id="S3.E1.m1.2.2.4.3.3.cmml" xref="S3.E1.m1.2.2.4.3.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.2.2.2.cmml" xref="S3.E1.m1.2.2.2"><times id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.3"></times><apply id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2">𝑄</ci><apply id="S3.E1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3"><times id="S3.E1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.1"></times><ci id="S3.E1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2">𝑜</ci><ci id="S3.E1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.3">𝑝</ci><ci id="S3.E1.m1.1.1.1.1.1.1.3.4.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.4">𝑡</ci></apply></apply></apply><apply id="S3.E1.m1.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.1"><csymbol cd="latexml" id="S3.E1.m1.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.1.2">norm</csymbol><apply id="S3.E1.m1.2.2.2.2.1.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.1.1.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.1.1.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2">𝐸</ci><ci id="S3.E1.m1.2.2.2.2.1.1.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">S_{ij}=\frac{Q_{opt}\cdot E_{i}}{\left\|Q_{opt}\right\|\left\|E_{i}\right\|}.</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.3d">italic_S start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = divide start_ARG italic_Q start_POSTSUBSCRIPT italic_o italic_p italic_t end_POSTSUBSCRIPT ⋅ italic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG ∥ italic_Q start_POSTSUBSCRIPT italic_o italic_p italic_t end_POSTSUBSCRIPT ∥ ∥ italic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">Subsequently, the probability distribution <math alttext="\alpha_{ij}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">α</mi><mrow id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml"><mi id="S3.SS2.p2.1.m1.1.1.3.2" xref="S3.SS2.p2.1.m1.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p2.1.m1.1.1.3.1" xref="S3.SS2.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.1.m1.1.1.3.3" xref="S3.SS2.p2.1.m1.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝛼</ci><apply id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3"><times id="S3.SS2.p2.1.m1.1.1.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3.1"></times><ci id="S3.SS2.p2.1.m1.1.1.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2">𝑖</ci><ci id="S3.SS2.p2.1.m1.1.1.3.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\alpha_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_α start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> for each intent after the softmax is expressed as:</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\alpha_{ij}=\frac{\exp(S_{ij})}{\sum_{l=1}^{17}\exp(S_{il})}." class="ltx_Math" display="block" id="S3.E2.m1.5"><semantics id="S3.E2.m1.5a"><mrow id="S3.E2.m1.5.5.1" xref="S3.E2.m1.5.5.1.1.cmml"><mrow id="S3.E2.m1.5.5.1.1" xref="S3.E2.m1.5.5.1.1.cmml"><msub id="S3.E2.m1.5.5.1.1.2" xref="S3.E2.m1.5.5.1.1.2.cmml"><mi id="S3.E2.m1.5.5.1.1.2.2" xref="S3.E2.m1.5.5.1.1.2.2.cmml">α</mi><mrow id="S3.E2.m1.5.5.1.1.2.3" xref="S3.E2.m1.5.5.1.1.2.3.cmml"><mi id="S3.E2.m1.5.5.1.1.2.3.2" xref="S3.E2.m1.5.5.1.1.2.3.2.cmml">i</mi><mo id="S3.E2.m1.5.5.1.1.2.3.1" xref="S3.E2.m1.5.5.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E2.m1.5.5.1.1.2.3.3" xref="S3.E2.m1.5.5.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.E2.m1.5.5.1.1.1" xref="S3.E2.m1.5.5.1.1.1.cmml">=</mo><mfrac id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml"><mrow id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">exp</mi><mo id="S3.E2.m1.2.2.2.2a" xref="S3.E2.m1.2.2.2.3.cmml">⁡</mo><mrow id="S3.E2.m1.2.2.2.2.1" xref="S3.E2.m1.2.2.2.3.cmml"><mo id="S3.E2.m1.2.2.2.2.1.2" stretchy="false" xref="S3.E2.m1.2.2.2.3.cmml">(</mo><msub id="S3.E2.m1.2.2.2.2.1.1" xref="S3.E2.m1.2.2.2.2.1.1.cmml"><mi id="S3.E2.m1.2.2.2.2.1.1.2" xref="S3.E2.m1.2.2.2.2.1.1.2.cmml">S</mi><mrow id="S3.E2.m1.2.2.2.2.1.1.3" xref="S3.E2.m1.2.2.2.2.1.1.3.cmml"><mi id="S3.E2.m1.2.2.2.2.1.1.3.2" xref="S3.E2.m1.2.2.2.2.1.1.3.2.cmml">i</mi><mo id="S3.E2.m1.2.2.2.2.1.1.3.1" xref="S3.E2.m1.2.2.2.2.1.1.3.1.cmml">⁢</mo><mi id="S3.E2.m1.2.2.2.2.1.1.3.3" xref="S3.E2.m1.2.2.2.2.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S3.E2.m1.2.2.2.2.1.3" stretchy="false" xref="S3.E2.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S3.E2.m1.4.4.4" xref="S3.E2.m1.4.4.4.cmml"><msubsup id="S3.E2.m1.4.4.4.3" xref="S3.E2.m1.4.4.4.3.cmml"><mo id="S3.E2.m1.4.4.4.3.2.2" xref="S3.E2.m1.4.4.4.3.2.2.cmml">∑</mo><mrow id="S3.E2.m1.4.4.4.3.2.3" xref="S3.E2.m1.4.4.4.3.2.3.cmml"><mi id="S3.E2.m1.4.4.4.3.2.3.2" xref="S3.E2.m1.4.4.4.3.2.3.2.cmml">l</mi><mo id="S3.E2.m1.4.4.4.3.2.3.1" xref="S3.E2.m1.4.4.4.3.2.3.1.cmml">=</mo><mn id="S3.E2.m1.4.4.4.3.2.3.3" xref="S3.E2.m1.4.4.4.3.2.3.3.cmml">1</mn></mrow><mn id="S3.E2.m1.4.4.4.3.3" xref="S3.E2.m1.4.4.4.3.3.cmml">17</mn></msubsup><mrow id="S3.E2.m1.4.4.4.2.1" xref="S3.E2.m1.4.4.4.2.2.cmml"><mi id="S3.E2.m1.3.3.3.1" xref="S3.E2.m1.3.3.3.1.cmml">exp</mi><mo id="S3.E2.m1.4.4.4.2.1a" xref="S3.E2.m1.4.4.4.2.2.cmml">⁡</mo><mrow id="S3.E2.m1.4.4.4.2.1.1" xref="S3.E2.m1.4.4.4.2.2.cmml"><mo id="S3.E2.m1.4.4.4.2.1.1.2" stretchy="false" xref="S3.E2.m1.4.4.4.2.2.cmml">(</mo><msub id="S3.E2.m1.4.4.4.2.1.1.1" xref="S3.E2.m1.4.4.4.2.1.1.1.cmml"><mi id="S3.E2.m1.4.4.4.2.1.1.1.2" xref="S3.E2.m1.4.4.4.2.1.1.1.2.cmml">S</mi><mrow id="S3.E2.m1.4.4.4.2.1.1.1.3" xref="S3.E2.m1.4.4.4.2.1.1.1.3.cmml"><mi id="S3.E2.m1.4.4.4.2.1.1.1.3.2" xref="S3.E2.m1.4.4.4.2.1.1.1.3.2.cmml">i</mi><mo id="S3.E2.m1.4.4.4.2.1.1.1.3.1" xref="S3.E2.m1.4.4.4.2.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E2.m1.4.4.4.2.1.1.1.3.3" xref="S3.E2.m1.4.4.4.2.1.1.1.3.3.cmml">l</mi></mrow></msub><mo id="S3.E2.m1.4.4.4.2.1.1.3" stretchy="false" xref="S3.E2.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S3.E2.m1.5.5.1.2" lspace="0em" xref="S3.E2.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.5b"><apply id="S3.E2.m1.5.5.1.1.cmml" xref="S3.E2.m1.5.5.1"><eq id="S3.E2.m1.5.5.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1"></eq><apply id="S3.E2.m1.5.5.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.2.1.cmml" xref="S3.E2.m1.5.5.1.1.2">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.2.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2">𝛼</ci><apply id="S3.E2.m1.5.5.1.1.2.3.cmml" xref="S3.E2.m1.5.5.1.1.2.3"><times id="S3.E2.m1.5.5.1.1.2.3.1.cmml" xref="S3.E2.m1.5.5.1.1.2.3.1"></times><ci id="S3.E2.m1.5.5.1.1.2.3.2.cmml" xref="S3.E2.m1.5.5.1.1.2.3.2">𝑖</ci><ci id="S3.E2.m1.5.5.1.1.2.3.3.cmml" xref="S3.E2.m1.5.5.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4"><divide id="S3.E2.m1.4.4.5.cmml" xref="S3.E2.m1.4.4"></divide><apply id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2"><exp id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1"></exp><apply id="S3.E2.m1.2.2.2.2.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.1.1.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.2">𝑆</ci><apply id="S3.E2.m1.2.2.2.2.1.1.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.3"><times id="S3.E2.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1.3.1"></times><ci id="S3.E2.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.3.2">𝑖</ci><ci id="S3.E2.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.3.3">𝑗</ci></apply></apply></apply><apply id="S3.E2.m1.4.4.4.cmml" xref="S3.E2.m1.4.4.4"><apply id="S3.E2.m1.4.4.4.3.cmml" xref="S3.E2.m1.4.4.4.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.3.1.cmml" xref="S3.E2.m1.4.4.4.3">superscript</csymbol><apply id="S3.E2.m1.4.4.4.3.2.cmml" xref="S3.E2.m1.4.4.4.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.3.2.1.cmml" xref="S3.E2.m1.4.4.4.3">subscript</csymbol><sum id="S3.E2.m1.4.4.4.3.2.2.cmml" xref="S3.E2.m1.4.4.4.3.2.2"></sum><apply id="S3.E2.m1.4.4.4.3.2.3.cmml" xref="S3.E2.m1.4.4.4.3.2.3"><eq id="S3.E2.m1.4.4.4.3.2.3.1.cmml" xref="S3.E2.m1.4.4.4.3.2.3.1"></eq><ci id="S3.E2.m1.4.4.4.3.2.3.2.cmml" xref="S3.E2.m1.4.4.4.3.2.3.2">𝑙</ci><cn id="S3.E2.m1.4.4.4.3.2.3.3.cmml" type="integer" xref="S3.E2.m1.4.4.4.3.2.3.3">1</cn></apply></apply><cn id="S3.E2.m1.4.4.4.3.3.cmml" type="integer" xref="S3.E2.m1.4.4.4.3.3">17</cn></apply><apply id="S3.E2.m1.4.4.4.2.2.cmml" xref="S3.E2.m1.4.4.4.2.1"><exp id="S3.E2.m1.3.3.3.1.cmml" xref="S3.E2.m1.3.3.3.1"></exp><apply id="S3.E2.m1.4.4.4.2.1.1.1.cmml" xref="S3.E2.m1.4.4.4.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.2.1.1.1.1.cmml" xref="S3.E2.m1.4.4.4.2.1.1.1">subscript</csymbol><ci id="S3.E2.m1.4.4.4.2.1.1.1.2.cmml" xref="S3.E2.m1.4.4.4.2.1.1.1.2">𝑆</ci><apply id="S3.E2.m1.4.4.4.2.1.1.1.3.cmml" xref="S3.E2.m1.4.4.4.2.1.1.1.3"><times id="S3.E2.m1.4.4.4.2.1.1.1.3.1.cmml" xref="S3.E2.m1.4.4.4.2.1.1.1.3.1"></times><ci id="S3.E2.m1.4.4.4.2.1.1.1.3.2.cmml" xref="S3.E2.m1.4.4.4.2.1.1.1.3.2">𝑖</ci><ci id="S3.E2.m1.4.4.4.2.1.1.1.3.3.cmml" xref="S3.E2.m1.4.4.4.2.1.1.1.3.3">𝑙</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.5c">\alpha_{ij}=\frac{\exp(S_{ij})}{\sum_{l=1}^{17}\exp(S_{il})}.</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.5d">italic_α start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = divide start_ARG roman_exp ( italic_S start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_l = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 17 end_POSTSUPERSCRIPT roman_exp ( italic_S start_POSTSUBSCRIPT italic_i italic_l end_POSTSUBSCRIPT ) end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.2">If the probability <math alttext="\alpha_{ij}" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.1"><semantics id="S3.SS2.p4.1.m1.1a"><msub id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml"><mi id="S3.SS2.p4.1.m1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.2.cmml">α</mi><mrow id="S3.SS2.p4.1.m1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.3.cmml"><mi id="S3.SS2.p4.1.m1.1.1.3.2" xref="S3.SS2.p4.1.m1.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p4.1.m1.1.1.3.1" xref="S3.SS2.p4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.1.m1.1.1.3.3" xref="S3.SS2.p4.1.m1.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><apply id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2">𝛼</ci><apply id="S3.SS2.p4.1.m1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3"><times id="S3.SS2.p4.1.m1.1.1.3.1.cmml" xref="S3.SS2.p4.1.m1.1.1.3.1"></times><ci id="S3.SS2.p4.1.m1.1.1.3.2.cmml" xref="S3.SS2.p4.1.m1.1.1.3.2">𝑖</ci><ci id="S3.SS2.p4.1.m1.1.1.3.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">\alpha_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.1d">italic_α start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> of an intent <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.p4.2.m2.1"><semantics id="S3.SS2.p4.2.m2.1a"><mi id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><ci id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.2.m2.1d">italic_i</annotation></semantics></math> exceeds a predetermined threshold, the intent will be activated, triggering the corresponding agent:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Activated Intent}_{i}=\left\{\begin{array}[]{ll}1&amp;\text{if }\alpha_{ij}&gt;%
\text{Threshold},\\
0&amp;\text{otherwise}.\end{array}\right." class="ltx_Math" display="block" id="S3.E3.m1.2"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.3" xref="S3.E3.m1.2.3.cmml"><msub id="S3.E3.m1.2.3.2" xref="S3.E3.m1.2.3.2.cmml"><mtext id="S3.E3.m1.2.3.2.2" xref="S3.E3.m1.2.3.2.2a.cmml">Activated Intent</mtext><mi id="S3.E3.m1.2.3.2.3" xref="S3.E3.m1.2.3.2.3.cmml">i</mi></msub><mo id="S3.E3.m1.2.3.1" xref="S3.E3.m1.2.3.1.cmml">=</mo><mrow id="S3.E3.m1.2.3.3.2" xref="S3.E3.m1.2.3.3.1.cmml"><mo id="S3.E3.m1.2.3.3.2.1" xref="S3.E3.m1.2.3.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.E3.m1.2.2" rowspacing="0pt" xref="S3.E3.m1.2.2.cmml"><mtr id="S3.E3.m1.2.2a" xref="S3.E3.m1.2.2.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.2.2b" xref="S3.E3.m1.2.2.cmml"><mn id="S3.E3.m1.1.1.1.2.1" xref="S3.E3.m1.1.1.1.2.1.cmml">1</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.2.2c" xref="S3.E3.m1.2.2.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.2.cmml"><mtext id="S3.E3.m1.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2a.cmml">if </mtext><mo id="S3.E3.m1.1.1.1.1.1.1.1.2.1" xref="S3.E3.m1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S3.E3.m1.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.2.3.2" xref="S3.E3.m1.1.1.1.1.1.1.1.2.3.2.cmml">α</mi><mrow id="S3.E3.m1.1.1.1.1.1.1.1.2.3.3" xref="S3.E3.m1.1.1.1.1.1.1.1.2.3.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.2.3.3.2" xref="S3.E3.m1.1.1.1.1.1.1.1.2.3.3.2.cmml">i</mi><mo id="S3.E3.m1.1.1.1.1.1.1.1.2.3.3.1" xref="S3.E3.m1.1.1.1.1.1.1.1.2.3.3.1.cmml">⁢</mo><mi id="S3.E3.m1.1.1.1.1.1.1.1.2.3.3.3" xref="S3.E3.m1.1.1.1.1.1.1.1.2.3.3.3.cmml">j</mi></mrow></msub></mrow><mo id="S3.E3.m1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml">&gt;</mo><mtext id="S3.E3.m1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.3a.cmml">Threshold</mtext></mrow><mo id="S3.E3.m1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E3.m1.2.2d" xref="S3.E3.m1.2.2.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.2.2e" xref="S3.E3.m1.2.2.cmml"><mn id="S3.E3.m1.2.2.2.2.1" xref="S3.E3.m1.2.2.2.2.1.cmml">0</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.2.2f" xref="S3.E3.m1.2.2.cmml"><mrow id="S3.E3.m1.2.2.2.1.1.3" xref="S3.E3.m1.2.2.2.1.1.1a.cmml"><mtext id="S3.E3.m1.2.2.2.1.1.1" xref="S3.E3.m1.2.2.2.1.1.1.cmml">otherwise</mtext><mo id="S3.E3.m1.2.2.2.1.1.3.1" lspace="0em" xref="S3.E3.m1.2.2.2.1.1.1a.cmml">.</mo></mrow></mtd></mtr></mtable><mi id="S3.E3.m1.2.3.3.2.2" xref="S3.E3.m1.2.3.3.1.1.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.3.cmml" xref="S3.E3.m1.2.3"><eq id="S3.E3.m1.2.3.1.cmml" xref="S3.E3.m1.2.3.1"></eq><apply id="S3.E3.m1.2.3.2.cmml" xref="S3.E3.m1.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.2.1.cmml" xref="S3.E3.m1.2.3.2">subscript</csymbol><ci id="S3.E3.m1.2.3.2.2a.cmml" xref="S3.E3.m1.2.3.2.2"><mtext id="S3.E3.m1.2.3.2.2.cmml" xref="S3.E3.m1.2.3.2.2">Activated Intent</mtext></ci><ci id="S3.E3.m1.2.3.2.3.cmml" xref="S3.E3.m1.2.3.2.3">𝑖</ci></apply><apply id="S3.E3.m1.2.3.3.1.cmml" xref="S3.E3.m1.2.3.3.2"><csymbol cd="latexml" id="S3.E3.m1.2.3.3.1.1.cmml" xref="S3.E3.m1.2.3.3.2.1">cases</csymbol><matrix id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2"><matrixrow id="S3.E3.m1.2.2a.cmml" xref="S3.E3.m1.2.2"><cn id="S3.E3.m1.1.1.1.2.1.cmml" type="integer" xref="S3.E3.m1.1.1.1.2.1">1</cn><apply id="S3.E3.m1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><gt id="S3.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1"></gt><apply id="S3.E3.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2"><times id="S3.E3.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.1"></times><ci id="S3.E3.m1.1.1.1.1.1.1.1.2.2a.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2"><mtext id="S3.E3.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2">if </mtext></ci><apply id="S3.E3.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.3.2">𝛼</ci><apply id="S3.E3.m1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.3.3"><times id="S3.E3.m1.1.1.1.1.1.1.1.2.3.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.3.3.1"></times><ci id="S3.E3.m1.1.1.1.1.1.1.1.2.3.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.3.3.2">𝑖</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.2.3.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.3.3.3">𝑗</ci></apply></apply></apply><ci id="S3.E3.m1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.3"><mtext id="S3.E3.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.3">Threshold</mtext></ci></apply></matrixrow><matrixrow id="S3.E3.m1.2.2b.cmml" xref="S3.E3.m1.2.2"><cn id="S3.E3.m1.2.2.2.2.1.cmml" type="integer" xref="S3.E3.m1.2.2.2.2.1">0</cn><ci id="S3.E3.m1.2.2.2.1.1.1a.cmml" xref="S3.E3.m1.2.2.2.1.1.3"><mtext id="S3.E3.m1.2.2.2.1.1.1.cmml" xref="S3.E3.m1.2.2.2.1.1.1">otherwise</mtext></ci></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">\text{Activated Intent}_{i}=\left\{\begin{array}[]{ll}1&amp;\text{if }\alpha_{ij}&gt;%
\text{Threshold},\\
0&amp;\text{otherwise}.\end{array}\right.</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.2d">Activated Intent start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = { start_ARRAY start_ROW start_CELL 1 end_CELL start_CELL if italic_α start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT &gt; Threshold , end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL otherwise . end_CELL end_ROW end_ARRAY</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.p5">
<p class="ltx_p" id="S3.SS2.p5.1">In this way, our framework can automatically activate the most compliant medical intent based on the optimized query, directing it to the corresponding agent to perform subsequent operations.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Agent Collaboration</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">The corresponding agents are dynamically activated when the framework recognizes relevant and valid intents. Considering comprehensiveness and diversity, agent collaboration covers systematic healthcare services spanning pre-diagnosis, diagnosis, medicament, and post-diagnosis. Also, an LLM-based decision analysis module is employed for information integration and summarization.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">Specifically speaking, the pre-diagnosis agent equips the patient repository, which is a relational database <cite class="ltx_cite ltx_citemacro_cite">Codd (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib11" title="">1970</a>)</cite> for storing historical patient visit records. These records can be utilized for health assessments, identifying potential risks, and recommending appropriate departments to visit.</p>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.2">The diagnosis agent incorporates 506 high-quality cases provided in the medical record database <cite class="ltx_cite ltx_citemacro_cite">Fan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib14" title="">2024</a>)</cite>. We employ a hybrid retrieval scheme <cite class="ltx_cite ltx_citemacro_cite">Sawarkar et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib27" title="">2024</a>)</cite> to obtain demonstrations similar to the patient’s condition, thus providing reliable evidence regarding precise treatment recommendations in symptom analysis and etiological ranking intents.
The hybrid retrieval consists of two main components: keyword retrieval and vector retrieval. First, the framework extracts a subset of documents <math alttext="D_{\text{slice}}" class="ltx_Math" display="inline" id="S3.SS3.p3.1.m1.1"><semantics id="S3.SS3.p3.1.m1.1a"><msub id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><mi id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml">D</mi><mtext id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3a.cmml">slice</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2">𝐷</ci><ci id="S3.SS3.p3.1.m1.1.1.3a.cmml" xref="S3.SS3.p3.1.m1.1.1.3"><mtext id="S3.SS3.p3.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p3.1.m1.1.1.3">slice</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">D_{\text{slice}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.1.m1.1d">italic_D start_POSTSUBSCRIPT slice end_POSTSUBSCRIPT</annotation></semantics></math> containing the query keyword from the document collection <math alttext="D" class="ltx_Math" display="inline" id="S3.SS3.p3.2.m2.1"><semantics id="S3.SS3.p3.2.m2.1a"><mi id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><ci id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.2.m2.1d">italic_D</annotation></semantics></math> by the keyword retrieval of Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S3.E1" title="In 3.2 Intent Recognition ‣ 3 Methodology ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">1</span></a>):</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="D_{\text{slice}}=\{d\in D\mid\text{KeywordMatch}(Q,d)=True\}." class="ltx_Math" display="block" id="S3.E4.m1.3"><semantics id="S3.E4.m1.3a"><mrow id="S3.E4.m1.3.3.1" xref="S3.E4.m1.3.3.1.1.cmml"><mrow id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.1.cmml"><msub id="S3.E4.m1.3.3.1.1.4" xref="S3.E4.m1.3.3.1.1.4.cmml"><mi id="S3.E4.m1.3.3.1.1.4.2" xref="S3.E4.m1.3.3.1.1.4.2.cmml">D</mi><mtext id="S3.E4.m1.3.3.1.1.4.3" xref="S3.E4.m1.3.3.1.1.4.3a.cmml">slice</mtext></msub><mo id="S3.E4.m1.3.3.1.1.3" xref="S3.E4.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E4.m1.3.3.1.1.2.2" xref="S3.E4.m1.3.3.1.1.2.3.cmml"><mo id="S3.E4.m1.3.3.1.1.2.2.3" stretchy="false" xref="S3.E4.m1.3.3.1.1.2.3.1.cmml">{</mo><mrow id="S3.E4.m1.3.3.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.cmml"><mi id="S3.E4.m1.3.3.1.1.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.1.1.2.cmml">d</mi><mo id="S3.E4.m1.3.3.1.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.cmml">∈</mo><mi id="S3.E4.m1.3.3.1.1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.1.3.cmml">D</mi></mrow><mo fence="true" id="S3.E4.m1.3.3.1.1.2.2.4" lspace="0em" rspace="0em" xref="S3.E4.m1.3.3.1.1.2.3.1.cmml">∣</mo><mrow id="S3.E4.m1.3.3.1.1.2.2.2" xref="S3.E4.m1.3.3.1.1.2.2.2.cmml"><mrow id="S3.E4.m1.3.3.1.1.2.2.2.2" xref="S3.E4.m1.3.3.1.1.2.2.2.2.cmml"><mtext id="S3.E4.m1.3.3.1.1.2.2.2.2.2" xref="S3.E4.m1.3.3.1.1.2.2.2.2.2a.cmml">KeywordMatch</mtext><mo id="S3.E4.m1.3.3.1.1.2.2.2.2.1" xref="S3.E4.m1.3.3.1.1.2.2.2.2.1.cmml">⁢</mo><mrow id="S3.E4.m1.3.3.1.1.2.2.2.2.3.2" xref="S3.E4.m1.3.3.1.1.2.2.2.2.3.1.cmml"><mo id="S3.E4.m1.3.3.1.1.2.2.2.2.3.2.1" stretchy="false" xref="S3.E4.m1.3.3.1.1.2.2.2.2.3.1.cmml">(</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">Q</mi><mo id="S3.E4.m1.3.3.1.1.2.2.2.2.3.2.2" xref="S3.E4.m1.3.3.1.1.2.2.2.2.3.1.cmml">,</mo><mi id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">d</mi><mo id="S3.E4.m1.3.3.1.1.2.2.2.2.3.2.3" stretchy="false" xref="S3.E4.m1.3.3.1.1.2.2.2.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.3.3.1.1.2.2.2.1" xref="S3.E4.m1.3.3.1.1.2.2.2.1.cmml">=</mo><mrow id="S3.E4.m1.3.3.1.1.2.2.2.3" xref="S3.E4.m1.3.3.1.1.2.2.2.3.cmml"><mi id="S3.E4.m1.3.3.1.1.2.2.2.3.2" xref="S3.E4.m1.3.3.1.1.2.2.2.3.2.cmml">T</mi><mo id="S3.E4.m1.3.3.1.1.2.2.2.3.1" xref="S3.E4.m1.3.3.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.3.3.1.1.2.2.2.3.3" xref="S3.E4.m1.3.3.1.1.2.2.2.3.3.cmml">r</mi><mo id="S3.E4.m1.3.3.1.1.2.2.2.3.1a" xref="S3.E4.m1.3.3.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.3.3.1.1.2.2.2.3.4" xref="S3.E4.m1.3.3.1.1.2.2.2.3.4.cmml">u</mi><mo id="S3.E4.m1.3.3.1.1.2.2.2.3.1b" xref="S3.E4.m1.3.3.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.3.3.1.1.2.2.2.3.5" xref="S3.E4.m1.3.3.1.1.2.2.2.3.5.cmml">e</mi></mrow></mrow><mo id="S3.E4.m1.3.3.1.1.2.2.5" stretchy="false" xref="S3.E4.m1.3.3.1.1.2.3.1.cmml">}</mo></mrow></mrow><mo id="S3.E4.m1.3.3.1.2" lspace="0em" xref="S3.E4.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.3b"><apply id="S3.E4.m1.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1"><eq id="S3.E4.m1.3.3.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.3"></eq><apply id="S3.E4.m1.3.3.1.1.4.cmml" xref="S3.E4.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.4.1.cmml" xref="S3.E4.m1.3.3.1.1.4">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.4.2.cmml" xref="S3.E4.m1.3.3.1.1.4.2">𝐷</ci><ci id="S3.E4.m1.3.3.1.1.4.3a.cmml" xref="S3.E4.m1.3.3.1.1.4.3"><mtext id="S3.E4.m1.3.3.1.1.4.3.cmml" mathsize="70%" xref="S3.E4.m1.3.3.1.1.4.3">slice</mtext></ci></apply><apply id="S3.E4.m1.3.3.1.1.2.3.cmml" xref="S3.E4.m1.3.3.1.1.2.2"><csymbol cd="latexml" id="S3.E4.m1.3.3.1.1.2.3.1.cmml" xref="S3.E4.m1.3.3.1.1.2.2.3">conditional-set</csymbol><apply id="S3.E4.m1.3.3.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1"><in id="S3.E4.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1"></in><ci id="S3.E4.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.2">𝑑</ci><ci id="S3.E4.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.3">𝐷</ci></apply><apply id="S3.E4.m1.3.3.1.1.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2"><eq id="S3.E4.m1.3.3.1.1.2.2.2.1.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.1"></eq><apply id="S3.E4.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.2"><times id="S3.E4.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.2.1"></times><ci id="S3.E4.m1.3.3.1.1.2.2.2.2.2a.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.2.2"><mtext id="S3.E4.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.2.2">KeywordMatch</mtext></ci><interval closure="open" id="S3.E4.m1.3.3.1.1.2.2.2.2.3.1.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.2.3.2"><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝑄</ci><ci id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2">𝑑</ci></interval></apply><apply id="S3.E4.m1.3.3.1.1.2.2.2.3.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.3"><times id="S3.E4.m1.3.3.1.1.2.2.2.3.1.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.3.1"></times><ci id="S3.E4.m1.3.3.1.1.2.2.2.3.2.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.3.2">𝑇</ci><ci id="S3.E4.m1.3.3.1.1.2.2.2.3.3.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.3.3">𝑟</ci><ci id="S3.E4.m1.3.3.1.1.2.2.2.3.4.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.3.4">𝑢</ci><ci id="S3.E4.m1.3.3.1.1.2.2.2.3.5.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.3.5">𝑒</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.3c">D_{\text{slice}}=\{d\in D\mid\text{KeywordMatch}(Q,d)=True\}.</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.3d">italic_D start_POSTSUBSCRIPT slice end_POSTSUBSCRIPT = { italic_d ∈ italic_D ∣ KeywordMatch ( italic_Q , italic_d ) = italic_T italic_r italic_u italic_e } .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.5">Afterward, <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p4.5.1">MedAide</span> calculates the similarity <math alttext="S(Q,d)" class="ltx_Math" display="inline" id="S3.SS3.p4.1.m1.2"><semantics id="S3.SS3.p4.1.m1.2a"><mrow id="S3.SS3.p4.1.m1.2.3" xref="S3.SS3.p4.1.m1.2.3.cmml"><mi id="S3.SS3.p4.1.m1.2.3.2" xref="S3.SS3.p4.1.m1.2.3.2.cmml">S</mi><mo id="S3.SS3.p4.1.m1.2.3.1" xref="S3.SS3.p4.1.m1.2.3.1.cmml">⁢</mo><mrow id="S3.SS3.p4.1.m1.2.3.3.2" xref="S3.SS3.p4.1.m1.2.3.3.1.cmml"><mo id="S3.SS3.p4.1.m1.2.3.3.2.1" stretchy="false" xref="S3.SS3.p4.1.m1.2.3.3.1.cmml">(</mo><mi id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">Q</mi><mo id="S3.SS3.p4.1.m1.2.3.3.2.2" xref="S3.SS3.p4.1.m1.2.3.3.1.cmml">,</mo><mi id="S3.SS3.p4.1.m1.2.2" xref="S3.SS3.p4.1.m1.2.2.cmml">d</mi><mo id="S3.SS3.p4.1.m1.2.3.3.2.3" stretchy="false" xref="S3.SS3.p4.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.2b"><apply id="S3.SS3.p4.1.m1.2.3.cmml" xref="S3.SS3.p4.1.m1.2.3"><times id="S3.SS3.p4.1.m1.2.3.1.cmml" xref="S3.SS3.p4.1.m1.2.3.1"></times><ci id="S3.SS3.p4.1.m1.2.3.2.cmml" xref="S3.SS3.p4.1.m1.2.3.2">𝑆</ci><interval closure="open" id="S3.SS3.p4.1.m1.2.3.3.1.cmml" xref="S3.SS3.p4.1.m1.2.3.3.2"><ci id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">𝑄</ci><ci id="S3.SS3.p4.1.m1.2.2.cmml" xref="S3.SS3.p4.1.m1.2.2">𝑑</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.2c">S(Q,d)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.1.m1.2d">italic_S ( italic_Q , italic_d )</annotation></semantics></math> between the query <math alttext="Q" class="ltx_Math" display="inline" id="S3.SS3.p4.2.m2.1"><semantics id="S3.SS3.p4.2.m2.1a"><mi id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><ci id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.2.m2.1d">italic_Q</annotation></semantics></math> and the document <math alttext="d" class="ltx_Math" display="inline" id="S3.SS3.p4.3.m3.1"><semantics id="S3.SS3.p4.3.m3.1a"><mi id="S3.SS3.p4.3.m3.1.1" xref="S3.SS3.p4.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.1b"><ci id="S3.SS3.p4.3.m3.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.3.m3.1d">italic_d</annotation></semantics></math> according to Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S3.E2" title="In 3.2 Intent Recognition ‣ 3 Methodology ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">2</span></a>) by vector retrieval and retains the documents whose similarity is higher than a threshold set <math alttext="\tau" class="ltx_Math" display="inline" id="S3.SS3.p4.4.m4.1"><semantics id="S3.SS3.p4.4.m4.1a"><mi id="S3.SS3.p4.4.m4.1.1" xref="S3.SS3.p4.4.m4.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.1b"><ci id="S3.SS3.p4.4.m4.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m4.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.4.m4.1d">italic_τ</annotation></semantics></math>, forming a subset <math alttext="D_{\text{match}}" class="ltx_Math" display="inline" id="S3.SS3.p4.5.m5.1"><semantics id="S3.SS3.p4.5.m5.1a"><msub id="S3.SS3.p4.5.m5.1.1" xref="S3.SS3.p4.5.m5.1.1.cmml"><mi id="S3.SS3.p4.5.m5.1.1.2" xref="S3.SS3.p4.5.m5.1.1.2.cmml">D</mi><mtext id="S3.SS3.p4.5.m5.1.1.3" xref="S3.SS3.p4.5.m5.1.1.3a.cmml">match</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.5.m5.1b"><apply id="S3.SS3.p4.5.m5.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.5.m5.1.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p4.5.m5.1.1.2.cmml" xref="S3.SS3.p4.5.m5.1.1.2">𝐷</ci><ci id="S3.SS3.p4.5.m5.1.1.3a.cmml" xref="S3.SS3.p4.5.m5.1.1.3"><mtext id="S3.SS3.p4.5.m5.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p4.5.m5.1.1.3">match</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.5.m5.1c">D_{\text{match}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.5.m5.1d">italic_D start_POSTSUBSCRIPT match end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="S(Q,d)=\frac{E_{Q}\cdot E_{D}}{\|E_{Q}\|\|E_{D}\|}," class="ltx_Math" display="block" id="S3.E5.m1.5"><semantics id="S3.E5.m1.5a"><mrow id="S3.E5.m1.5.5.1" xref="S3.E5.m1.5.5.1.1.cmml"><mrow id="S3.E5.m1.5.5.1.1" xref="S3.E5.m1.5.5.1.1.cmml"><mrow id="S3.E5.m1.5.5.1.1.2" xref="S3.E5.m1.5.5.1.1.2.cmml"><mi id="S3.E5.m1.5.5.1.1.2.2" xref="S3.E5.m1.5.5.1.1.2.2.cmml">S</mi><mo id="S3.E5.m1.5.5.1.1.2.1" xref="S3.E5.m1.5.5.1.1.2.1.cmml">⁢</mo><mrow id="S3.E5.m1.5.5.1.1.2.3.2" xref="S3.E5.m1.5.5.1.1.2.3.1.cmml"><mo id="S3.E5.m1.5.5.1.1.2.3.2.1" stretchy="false" xref="S3.E5.m1.5.5.1.1.2.3.1.cmml">(</mo><mi id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml">Q</mi><mo id="S3.E5.m1.5.5.1.1.2.3.2.2" xref="S3.E5.m1.5.5.1.1.2.3.1.cmml">,</mo><mi id="S3.E5.m1.4.4" xref="S3.E5.m1.4.4.cmml">d</mi><mo id="S3.E5.m1.5.5.1.1.2.3.2.3" stretchy="false" xref="S3.E5.m1.5.5.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.5.5.1.1.1" xref="S3.E5.m1.5.5.1.1.1.cmml">=</mo><mfrac id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml"><mrow id="S3.E5.m1.2.2.4" xref="S3.E5.m1.2.2.4.cmml"><msub id="S3.E5.m1.2.2.4.2" xref="S3.E5.m1.2.2.4.2.cmml"><mi id="S3.E5.m1.2.2.4.2.2" xref="S3.E5.m1.2.2.4.2.2.cmml">E</mi><mi id="S3.E5.m1.2.2.4.2.3" xref="S3.E5.m1.2.2.4.2.3.cmml">Q</mi></msub><mo id="S3.E5.m1.2.2.4.1" lspace="0.222em" rspace="0.222em" xref="S3.E5.m1.2.2.4.1.cmml">⋅</mo><msub id="S3.E5.m1.2.2.4.3" xref="S3.E5.m1.2.2.4.3.cmml"><mi id="S3.E5.m1.2.2.4.3.2" xref="S3.E5.m1.2.2.4.3.2.cmml">E</mi><mi id="S3.E5.m1.2.2.4.3.3" xref="S3.E5.m1.2.2.4.3.3.cmml">D</mi></msub></mrow><mrow id="S3.E5.m1.2.2.2" xref="S3.E5.m1.2.2.2.cmml"><mrow id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.2.cmml"><mo id="S3.E5.m1.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.1.1.1.1.2.1.cmml">‖</mo><msub id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.2.cmml">E</mi><mi id="S3.E5.m1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.3.cmml">Q</mi></msub><mo id="S3.E5.m1.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="S3.E5.m1.2.2.2.3" xref="S3.E5.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E5.m1.2.2.2.2.1" xref="S3.E5.m1.2.2.2.2.2.cmml"><mo id="S3.E5.m1.2.2.2.2.1.2" stretchy="false" xref="S3.E5.m1.2.2.2.2.2.1.cmml">‖</mo><msub id="S3.E5.m1.2.2.2.2.1.1" xref="S3.E5.m1.2.2.2.2.1.1.cmml"><mi id="S3.E5.m1.2.2.2.2.1.1.2" xref="S3.E5.m1.2.2.2.2.1.1.2.cmml">E</mi><mi id="S3.E5.m1.2.2.2.2.1.1.3" xref="S3.E5.m1.2.2.2.2.1.1.3.cmml">D</mi></msub><mo id="S3.E5.m1.2.2.2.2.1.3" stretchy="false" xref="S3.E5.m1.2.2.2.2.2.1.cmml">‖</mo></mrow></mrow></mfrac></mrow><mo id="S3.E5.m1.5.5.1.2" xref="S3.E5.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.5b"><apply id="S3.E5.m1.5.5.1.1.cmml" xref="S3.E5.m1.5.5.1"><eq id="S3.E5.m1.5.5.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1"></eq><apply id="S3.E5.m1.5.5.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.2"><times id="S3.E5.m1.5.5.1.1.2.1.cmml" xref="S3.E5.m1.5.5.1.1.2.1"></times><ci id="S3.E5.m1.5.5.1.1.2.2.cmml" xref="S3.E5.m1.5.5.1.1.2.2">𝑆</ci><interval closure="open" id="S3.E5.m1.5.5.1.1.2.3.1.cmml" xref="S3.E5.m1.5.5.1.1.2.3.2"><ci id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3">𝑄</ci><ci id="S3.E5.m1.4.4.cmml" xref="S3.E5.m1.4.4">𝑑</ci></interval></apply><apply id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2"><divide id="S3.E5.m1.2.2.3.cmml" xref="S3.E5.m1.2.2"></divide><apply id="S3.E5.m1.2.2.4.cmml" xref="S3.E5.m1.2.2.4"><ci id="S3.E5.m1.2.2.4.1.cmml" xref="S3.E5.m1.2.2.4.1">⋅</ci><apply id="S3.E5.m1.2.2.4.2.cmml" xref="S3.E5.m1.2.2.4.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.4.2.1.cmml" xref="S3.E5.m1.2.2.4.2">subscript</csymbol><ci id="S3.E5.m1.2.2.4.2.2.cmml" xref="S3.E5.m1.2.2.4.2.2">𝐸</ci><ci id="S3.E5.m1.2.2.4.2.3.cmml" xref="S3.E5.m1.2.2.4.2.3">𝑄</ci></apply><apply id="S3.E5.m1.2.2.4.3.cmml" xref="S3.E5.m1.2.2.4.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.4.3.1.cmml" xref="S3.E5.m1.2.2.4.3">subscript</csymbol><ci id="S3.E5.m1.2.2.4.3.2.cmml" xref="S3.E5.m1.2.2.4.3.2">𝐸</ci><ci id="S3.E5.m1.2.2.4.3.3.cmml" xref="S3.E5.m1.2.2.4.3.3">𝐷</ci></apply></apply><apply id="S3.E5.m1.2.2.2.cmml" xref="S3.E5.m1.2.2.2"><times id="S3.E5.m1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.3"></times><apply id="S3.E5.m1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2">𝐸</ci><ci id="S3.E5.m1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3">𝑄</ci></apply></apply><apply id="S3.E5.m1.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.1"><csymbol cd="latexml" id="S3.E5.m1.2.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.1.2">norm</csymbol><apply id="S3.E5.m1.2.2.2.2.1.1.cmml" xref="S3.E5.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.1.1.1.cmml" xref="S3.E5.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E5.m1.2.2.2.2.1.1.2.cmml" xref="S3.E5.m1.2.2.2.2.1.1.2">𝐸</ci><ci id="S3.E5.m1.2.2.2.2.1.1.3.cmml" xref="S3.E5.m1.2.2.2.2.1.1.3">𝐷</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.5c">S(Q,d)=\frac{E_{Q}\cdot E_{D}}{\|E_{Q}\|\|E_{D}\|},</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.5d">italic_S ( italic_Q , italic_d ) = divide start_ARG italic_E start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT ⋅ italic_E start_POSTSUBSCRIPT italic_D end_POSTSUBSCRIPT end_ARG start_ARG ∥ italic_E start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT ∥ ∥ italic_E start_POSTSUBSCRIPT italic_D end_POSTSUBSCRIPT ∥ end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="D_{\text{match}}=\{d\in D\mid S(Q,d)&gt;\tau\}." class="ltx_Math" display="block" id="S3.E6.m1.3"><semantics id="S3.E6.m1.3a"><mrow id="S3.E6.m1.3.3.1" xref="S3.E6.m1.3.3.1.1.cmml"><mrow id="S3.E6.m1.3.3.1.1" xref="S3.E6.m1.3.3.1.1.cmml"><msub id="S3.E6.m1.3.3.1.1.4" xref="S3.E6.m1.3.3.1.1.4.cmml"><mi id="S3.E6.m1.3.3.1.1.4.2" xref="S3.E6.m1.3.3.1.1.4.2.cmml">D</mi><mtext id="S3.E6.m1.3.3.1.1.4.3" xref="S3.E6.m1.3.3.1.1.4.3a.cmml">match</mtext></msub><mo id="S3.E6.m1.3.3.1.1.3" xref="S3.E6.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E6.m1.3.3.1.1.2.2" xref="S3.E6.m1.3.3.1.1.2.3.cmml"><mo id="S3.E6.m1.3.3.1.1.2.2.3" stretchy="false" xref="S3.E6.m1.3.3.1.1.2.3.1.cmml">{</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.1.2.cmml">d</mi><mo id="S3.E6.m1.3.3.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.cmml">∈</mo><mi id="S3.E6.m1.3.3.1.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.1.3.cmml">D</mi></mrow><mo fence="true" id="S3.E6.m1.3.3.1.1.2.2.4" lspace="0em" rspace="0em" xref="S3.E6.m1.3.3.1.1.2.3.1.cmml">∣</mo><mrow id="S3.E6.m1.3.3.1.1.2.2.2" xref="S3.E6.m1.3.3.1.1.2.2.2.cmml"><mrow id="S3.E6.m1.3.3.1.1.2.2.2.2" xref="S3.E6.m1.3.3.1.1.2.2.2.2.cmml"><mi id="S3.E6.m1.3.3.1.1.2.2.2.2.2" xref="S3.E6.m1.3.3.1.1.2.2.2.2.2.cmml">S</mi><mo id="S3.E6.m1.3.3.1.1.2.2.2.2.1" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.cmml">⁢</mo><mrow id="S3.E6.m1.3.3.1.1.2.2.2.2.3.2" xref="S3.E6.m1.3.3.1.1.2.2.2.2.3.1.cmml"><mo id="S3.E6.m1.3.3.1.1.2.2.2.2.3.2.1" stretchy="false" xref="S3.E6.m1.3.3.1.1.2.2.2.2.3.1.cmml">(</mo><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">Q</mi><mo id="S3.E6.m1.3.3.1.1.2.2.2.2.3.2.2" xref="S3.E6.m1.3.3.1.1.2.2.2.2.3.1.cmml">,</mo><mi id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml">d</mi><mo id="S3.E6.m1.3.3.1.1.2.2.2.2.3.2.3" stretchy="false" xref="S3.E6.m1.3.3.1.1.2.2.2.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.3.3.1.1.2.2.2.1" xref="S3.E6.m1.3.3.1.1.2.2.2.1.cmml">&gt;</mo><mi id="S3.E6.m1.3.3.1.1.2.2.2.3" xref="S3.E6.m1.3.3.1.1.2.2.2.3.cmml">τ</mi></mrow><mo id="S3.E6.m1.3.3.1.1.2.2.5" stretchy="false" xref="S3.E6.m1.3.3.1.1.2.3.1.cmml">}</mo></mrow></mrow><mo id="S3.E6.m1.3.3.1.2" lspace="0em" xref="S3.E6.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.3b"><apply id="S3.E6.m1.3.3.1.1.cmml" xref="S3.E6.m1.3.3.1"><eq id="S3.E6.m1.3.3.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.3"></eq><apply id="S3.E6.m1.3.3.1.1.4.cmml" xref="S3.E6.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.4.1.cmml" xref="S3.E6.m1.3.3.1.1.4">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.4.2.cmml" xref="S3.E6.m1.3.3.1.1.4.2">𝐷</ci><ci id="S3.E6.m1.3.3.1.1.4.3a.cmml" xref="S3.E6.m1.3.3.1.1.4.3"><mtext id="S3.E6.m1.3.3.1.1.4.3.cmml" mathsize="70%" xref="S3.E6.m1.3.3.1.1.4.3">match</mtext></ci></apply><apply id="S3.E6.m1.3.3.1.1.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.2"><csymbol cd="latexml" id="S3.E6.m1.3.3.1.1.2.3.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.3">conditional-set</csymbol><apply id="S3.E6.m1.3.3.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1"><in id="S3.E6.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1"></in><ci id="S3.E6.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.2">𝑑</ci><ci id="S3.E6.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.3">𝐷</ci></apply><apply id="S3.E6.m1.3.3.1.1.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2"><gt id="S3.E6.m1.3.3.1.1.2.2.2.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.1"></gt><apply id="S3.E6.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2"><times id="S3.E6.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1"></times><ci id="S3.E6.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.2">𝑆</ci><interval closure="open" id="S3.E6.m1.3.3.1.1.2.2.2.2.3.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.3.2"><ci id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1">𝑄</ci><ci id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2">𝑑</ci></interval></apply><ci id="S3.E6.m1.3.3.1.1.2.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.3">𝜏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.3c">D_{\text{match}}=\{d\in D\mid S(Q,d)&gt;\tau\}.</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.3d">italic_D start_POSTSUBSCRIPT match end_POSTSUBSCRIPT = { italic_d ∈ italic_D ∣ italic_S ( italic_Q , italic_d ) &gt; italic_τ } .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p5">
<p class="ltx_p" id="S3.SS3.p5.3">Subsequently, the keyword matching results in <math alttext="D_{\text{slice}}" class="ltx_Math" display="inline" id="S3.SS3.p5.1.m1.1"><semantics id="S3.SS3.p5.1.m1.1a"><msub id="S3.SS3.p5.1.m1.1.1" xref="S3.SS3.p5.1.m1.1.1.cmml"><mi id="S3.SS3.p5.1.m1.1.1.2" xref="S3.SS3.p5.1.m1.1.1.2.cmml">D</mi><mtext id="S3.SS3.p5.1.m1.1.1.3" xref="S3.SS3.p5.1.m1.1.1.3a.cmml">slice</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.1b"><apply id="S3.SS3.p5.1.m1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.1.m1.1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p5.1.m1.1.1.2.cmml" xref="S3.SS3.p5.1.m1.1.1.2">𝐷</ci><ci id="S3.SS3.p5.1.m1.1.1.3a.cmml" xref="S3.SS3.p5.1.m1.1.1.3"><mtext id="S3.SS3.p5.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p5.1.m1.1.1.3">slice</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.1c">D_{\text{slice}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.1.m1.1d">italic_D start_POSTSUBSCRIPT slice end_POSTSUBSCRIPT</annotation></semantics></math>, and the vector retrieval results in <math alttext="D_{\text{match}}" class="ltx_Math" display="inline" id="S3.SS3.p5.2.m2.1"><semantics id="S3.SS3.p5.2.m2.1a"><msub id="S3.SS3.p5.2.m2.1.1" xref="S3.SS3.p5.2.m2.1.1.cmml"><mi id="S3.SS3.p5.2.m2.1.1.2" xref="S3.SS3.p5.2.m2.1.1.2.cmml">D</mi><mtext id="S3.SS3.p5.2.m2.1.1.3" xref="S3.SS3.p5.2.m2.1.1.3a.cmml">match</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.2.m2.1b"><apply id="S3.SS3.p5.2.m2.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.2.m2.1.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p5.2.m2.1.1.2.cmml" xref="S3.SS3.p5.2.m2.1.1.2">𝐷</ci><ci id="S3.SS3.p5.2.m2.1.1.3a.cmml" xref="S3.SS3.p5.2.m2.1.1.3"><mtext id="S3.SS3.p5.2.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p5.2.m2.1.1.3">match</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.2.m2.1c">D_{\text{match}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.2.m2.1d">italic_D start_POSTSUBSCRIPT match end_POSTSUBSCRIPT</annotation></semantics></math> are merged to obtain the final set of relevant documents <math alttext="D_{\text{final}}" class="ltx_Math" display="inline" id="S3.SS3.p5.3.m3.1"><semantics id="S3.SS3.p5.3.m3.1a"><msub id="S3.SS3.p5.3.m3.1.1" xref="S3.SS3.p5.3.m3.1.1.cmml"><mi id="S3.SS3.p5.3.m3.1.1.2" xref="S3.SS3.p5.3.m3.1.1.2.cmml">D</mi><mtext id="S3.SS3.p5.3.m3.1.1.3" xref="S3.SS3.p5.3.m3.1.1.3a.cmml">final</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.3.m3.1b"><apply id="S3.SS3.p5.3.m3.1.1.cmml" xref="S3.SS3.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.3.m3.1.1.1.cmml" xref="S3.SS3.p5.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p5.3.m3.1.1.2.cmml" xref="S3.SS3.p5.3.m3.1.1.2">𝐷</ci><ci id="S3.SS3.p5.3.m3.1.1.3a.cmml" xref="S3.SS3.p5.3.m3.1.1.3"><mtext id="S3.SS3.p5.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p5.3.m3.1.1.3">final</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.3.m3.1c">D_{\text{final}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.3.m3.1d">italic_D start_POSTSUBSCRIPT final end_POSTSUBSCRIPT</annotation></semantics></math>. These documents will provide empirical support for diagnostic recommendations:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="D_{\text{final}}=D_{\text{slice}}\cup D_{\text{match}}" class="ltx_Math" display="block" id="S3.E7.m1.1"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml"><msub id="S3.E7.m1.1.1.2" xref="S3.E7.m1.1.1.2.cmml"><mi id="S3.E7.m1.1.1.2.2" xref="S3.E7.m1.1.1.2.2.cmml">D</mi><mtext id="S3.E7.m1.1.1.2.3" xref="S3.E7.m1.1.1.2.3a.cmml">final</mtext></msub><mo id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.cmml">=</mo><mrow id="S3.E7.m1.1.1.3" xref="S3.E7.m1.1.1.3.cmml"><msub id="S3.E7.m1.1.1.3.2" xref="S3.E7.m1.1.1.3.2.cmml"><mi id="S3.E7.m1.1.1.3.2.2" xref="S3.E7.m1.1.1.3.2.2.cmml">D</mi><mtext id="S3.E7.m1.1.1.3.2.3" xref="S3.E7.m1.1.1.3.2.3a.cmml">slice</mtext></msub><mo id="S3.E7.m1.1.1.3.1" xref="S3.E7.m1.1.1.3.1.cmml">∪</mo><msub id="S3.E7.m1.1.1.3.3" xref="S3.E7.m1.1.1.3.3.cmml"><mi id="S3.E7.m1.1.1.3.3.2" xref="S3.E7.m1.1.1.3.3.2.cmml">D</mi><mtext id="S3.E7.m1.1.1.3.3.3" xref="S3.E7.m1.1.1.3.3.3a.cmml">match</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1"><eq id="S3.E7.m1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"></eq><apply id="S3.E7.m1.1.1.2.cmml" xref="S3.E7.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.2">subscript</csymbol><ci id="S3.E7.m1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.2.2">𝐷</ci><ci id="S3.E7.m1.1.1.2.3a.cmml" xref="S3.E7.m1.1.1.2.3"><mtext id="S3.E7.m1.1.1.2.3.cmml" mathsize="70%" xref="S3.E7.m1.1.1.2.3">final</mtext></ci></apply><apply id="S3.E7.m1.1.1.3.cmml" xref="S3.E7.m1.1.1.3"><union id="S3.E7.m1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.3.1"></union><apply id="S3.E7.m1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.3.2.1.cmml" xref="S3.E7.m1.1.1.3.2">subscript</csymbol><ci id="S3.E7.m1.1.1.3.2.2.cmml" xref="S3.E7.m1.1.1.3.2.2">𝐷</ci><ci id="S3.E7.m1.1.1.3.2.3a.cmml" xref="S3.E7.m1.1.1.3.2.3"><mtext id="S3.E7.m1.1.1.3.2.3.cmml" mathsize="70%" xref="S3.E7.m1.1.1.3.2.3">slice</mtext></ci></apply><apply id="S3.E7.m1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.3.3.1.cmml" xref="S3.E7.m1.1.1.3.3">subscript</csymbol><ci id="S3.E7.m1.1.1.3.3.2.cmml" xref="S3.E7.m1.1.1.3.3.2">𝐷</ci><ci id="S3.E7.m1.1.1.3.3.3a.cmml" xref="S3.E7.m1.1.1.3.3.3"><mtext id="S3.E7.m1.1.1.3.3.3.cmml" mathsize="70%" xref="S3.E7.m1.1.1.3.3.3">match</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">D_{\text{final}}=D_{\text{slice}}\cup D_{\text{match}}</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.1d">italic_D start_POSTSUBSCRIPT final end_POSTSUBSCRIPT = italic_D start_POSTSUBSCRIPT slice end_POSTSUBSCRIPT ∪ italic_D start_POSTSUBSCRIPT match end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p5.4">In this case, the diagnosis agent further interprets the ancillary examination results to help patients understand their health status. Meanwhile, it provides a second diagnostic opinion to minimize the risk of misdiagnosis.</p>
</div>
<div class="ltx_para" id="S3.SS3.p6">
<p class="ltx_p" id="S3.SS3.p6.1">The medicament agent utilizes 26,684 medication data extracted from the PubMed library <cite class="ltx_cite ltx_citemacro_cite">Pud (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib2" title="">2024</a>)</cite> and provides patients with comprehensive medication counseling through keyword and semantic hybrid retrieval. The holistic counseling includes drug usage, dosage recommendations, potential drug interactions, and contraindications assessments to ensure the safety and efficacy of the medication. In addition, it helps patients understand potential side effects and suggests the best timing for medication administration to optimize treatment outcomes.</p>
</div>
<div class="ltx_para" id="S3.SS3.p7">
<p class="ltx_p" id="S3.SS3.p7.1">The post-diagnosis agent focuses on providing personalized rehabilitation advice and emotional support. It tracks and manages the recovery process by updating the patient repository with patient information.</p>
</div>
<div class="ltx_para" id="S3.SS3.p8">
<p class="ltx_p" id="S3.SS3.p8.2">The Decision Analysis Module (DAM) with the CoT properties combines the output of specific activated agents with the patient’s medical histories to dynamically adjust the treatment protocols and formulate integrated rehabilitation plans.
The final answer generated by DAM based on <math alttext="D_{\text{final}}" class="ltx_Math" display="inline" id="S3.SS3.p8.1.m1.1"><semantics id="S3.SS3.p8.1.m1.1a"><msub id="S3.SS3.p8.1.m1.1.1" xref="S3.SS3.p8.1.m1.1.1.cmml"><mi id="S3.SS3.p8.1.m1.1.1.2" xref="S3.SS3.p8.1.m1.1.1.2.cmml">D</mi><mtext id="S3.SS3.p8.1.m1.1.1.3" xref="S3.SS3.p8.1.m1.1.1.3a.cmml">final</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.1.m1.1b"><apply id="S3.SS3.p8.1.m1.1.1.cmml" xref="S3.SS3.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p8.1.m1.1.1.1.cmml" xref="S3.SS3.p8.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p8.1.m1.1.1.2.cmml" xref="S3.SS3.p8.1.m1.1.1.2">𝐷</ci><ci id="S3.SS3.p8.1.m1.1.1.3a.cmml" xref="S3.SS3.p8.1.m1.1.1.3"><mtext id="S3.SS3.p8.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p8.1.m1.1.1.3">final</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.1.m1.1c">D_{\text{final}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.1.m1.1d">italic_D start_POSTSUBSCRIPT final end_POSTSUBSCRIPT</annotation></semantics></math>, the prompt, and the agent output <math alttext="A_{i}" class="ltx_Math" display="inline" id="S3.SS3.p8.2.m2.1"><semantics id="S3.SS3.p8.2.m2.1a"><msub id="S3.SS3.p8.2.m2.1.1" xref="S3.SS3.p8.2.m2.1.1.cmml"><mi id="S3.SS3.p8.2.m2.1.1.2" xref="S3.SS3.p8.2.m2.1.1.2.cmml">A</mi><mi id="S3.SS3.p8.2.m2.1.1.3" xref="S3.SS3.p8.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.2.m2.1b"><apply id="S3.SS3.p8.2.m2.1.1.cmml" xref="S3.SS3.p8.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p8.2.m2.1.1.1.cmml" xref="S3.SS3.p8.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p8.2.m2.1.1.2.cmml" xref="S3.SS3.p8.2.m2.1.1.2">𝐴</ci><ci id="S3.SS3.p8.2.m2.1.1.3.cmml" xref="S3.SS3.p8.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.2.m2.1c">A_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.2.m2.1d">italic_A start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is expressed as follows:</p>
</div>
<div class="ltx_para" id="S3.SS3.p9">
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Answer=\text{DAM}(A_{i},\text{prompt},D_{\text{final}})." class="ltx_Math" display="block" id="S3.E8.m1.2"><semantics id="S3.E8.m1.2a"><mrow id="S3.E8.m1.2.2.1" xref="S3.E8.m1.2.2.1.1.cmml"><mrow id="S3.E8.m1.2.2.1.1" xref="S3.E8.m1.2.2.1.1.cmml"><mrow id="S3.E8.m1.2.2.1.1.4" xref="S3.E8.m1.2.2.1.1.4.cmml"><mi id="S3.E8.m1.2.2.1.1.4.2" xref="S3.E8.m1.2.2.1.1.4.2.cmml">A</mi><mo id="S3.E8.m1.2.2.1.1.4.1" xref="S3.E8.m1.2.2.1.1.4.1.cmml">⁢</mo><mi id="S3.E8.m1.2.2.1.1.4.3" xref="S3.E8.m1.2.2.1.1.4.3.cmml">n</mi><mo id="S3.E8.m1.2.2.1.1.4.1a" xref="S3.E8.m1.2.2.1.1.4.1.cmml">⁢</mo><mi id="S3.E8.m1.2.2.1.1.4.4" xref="S3.E8.m1.2.2.1.1.4.4.cmml">s</mi><mo id="S3.E8.m1.2.2.1.1.4.1b" xref="S3.E8.m1.2.2.1.1.4.1.cmml">⁢</mo><mi id="S3.E8.m1.2.2.1.1.4.5" xref="S3.E8.m1.2.2.1.1.4.5.cmml">w</mi><mo id="S3.E8.m1.2.2.1.1.4.1c" xref="S3.E8.m1.2.2.1.1.4.1.cmml">⁢</mo><mi id="S3.E8.m1.2.2.1.1.4.6" xref="S3.E8.m1.2.2.1.1.4.6.cmml">e</mi><mo id="S3.E8.m1.2.2.1.1.4.1d" xref="S3.E8.m1.2.2.1.1.4.1.cmml">⁢</mo><mi id="S3.E8.m1.2.2.1.1.4.7" xref="S3.E8.m1.2.2.1.1.4.7.cmml">r</mi></mrow><mo id="S3.E8.m1.2.2.1.1.3" xref="S3.E8.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E8.m1.2.2.1.1.2" xref="S3.E8.m1.2.2.1.1.2.cmml"><mtext id="S3.E8.m1.2.2.1.1.2.4" xref="S3.E8.m1.2.2.1.1.2.4a.cmml">DAM</mtext><mo id="S3.E8.m1.2.2.1.1.2.3" xref="S3.E8.m1.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S3.E8.m1.2.2.1.1.2.2.2" xref="S3.E8.m1.2.2.1.1.2.2.3.cmml"><mo id="S3.E8.m1.2.2.1.1.2.2.2.3" stretchy="false" xref="S3.E8.m1.2.2.1.1.2.2.3.cmml">(</mo><msub id="S3.E8.m1.2.2.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.cmml">A</mi><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E8.m1.2.2.1.1.2.2.2.4" xref="S3.E8.m1.2.2.1.1.2.2.3.cmml">,</mo><mtext id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1a.cmml">prompt</mtext><mo id="S3.E8.m1.2.2.1.1.2.2.2.5" xref="S3.E8.m1.2.2.1.1.2.2.3.cmml">,</mo><msub id="S3.E8.m1.2.2.1.1.2.2.2.2" xref="S3.E8.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S3.E8.m1.2.2.1.1.2.2.2.2.2" xref="S3.E8.m1.2.2.1.1.2.2.2.2.2.cmml">D</mi><mtext id="S3.E8.m1.2.2.1.1.2.2.2.2.3" xref="S3.E8.m1.2.2.1.1.2.2.2.2.3a.cmml">final</mtext></msub><mo id="S3.E8.m1.2.2.1.1.2.2.2.6" stretchy="false" xref="S3.E8.m1.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m1.2.2.1.2" lspace="0em" xref="S3.E8.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.2b"><apply id="S3.E8.m1.2.2.1.1.cmml" xref="S3.E8.m1.2.2.1"><eq id="S3.E8.m1.2.2.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.3"></eq><apply id="S3.E8.m1.2.2.1.1.4.cmml" xref="S3.E8.m1.2.2.1.1.4"><times id="S3.E8.m1.2.2.1.1.4.1.cmml" xref="S3.E8.m1.2.2.1.1.4.1"></times><ci id="S3.E8.m1.2.2.1.1.4.2.cmml" xref="S3.E8.m1.2.2.1.1.4.2">𝐴</ci><ci id="S3.E8.m1.2.2.1.1.4.3.cmml" xref="S3.E8.m1.2.2.1.1.4.3">𝑛</ci><ci id="S3.E8.m1.2.2.1.1.4.4.cmml" xref="S3.E8.m1.2.2.1.1.4.4">𝑠</ci><ci id="S3.E8.m1.2.2.1.1.4.5.cmml" xref="S3.E8.m1.2.2.1.1.4.5">𝑤</ci><ci id="S3.E8.m1.2.2.1.1.4.6.cmml" xref="S3.E8.m1.2.2.1.1.4.6">𝑒</ci><ci id="S3.E8.m1.2.2.1.1.4.7.cmml" xref="S3.E8.m1.2.2.1.1.4.7">𝑟</ci></apply><apply id="S3.E8.m1.2.2.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.2"><times id="S3.E8.m1.2.2.1.1.2.3.cmml" xref="S3.E8.m1.2.2.1.1.2.3"></times><ci id="S3.E8.m1.2.2.1.1.2.4a.cmml" xref="S3.E8.m1.2.2.1.1.2.4"><mtext id="S3.E8.m1.2.2.1.1.2.4.cmml" xref="S3.E8.m1.2.2.1.1.2.4">DAM</mtext></ci><vector id="S3.E8.m1.2.2.1.1.2.2.3.cmml" xref="S3.E8.m1.2.2.1.1.2.2.2"><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2">𝐴</ci><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E8.m1.1.1a.cmml" xref="S3.E8.m1.1.1"><mtext id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1">prompt</mtext></ci><apply id="S3.E8.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E8.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E8.m1.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E8.m1.2.2.1.1.2.2.2.2.2">𝐷</ci><ci id="S3.E8.m1.2.2.1.1.2.2.2.2.3a.cmml" xref="S3.E8.m1.2.2.1.1.2.2.2.2.3"><mtext id="S3.E8.m1.2.2.1.1.2.2.2.2.3.cmml" mathsize="70%" xref="S3.E8.m1.2.2.1.1.2.2.2.2.3">final</mtext></ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.2c">Answer=\text{DAM}(A_{i},\text{prompt},D_{\text{final}}).</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.2d">italic_A italic_n italic_s italic_w italic_e italic_r = DAM ( italic_A start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , prompt , italic_D start_POSTSUBSCRIPT final end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<figure class="ltx_table" id="S3.T1">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T1.1" style="width:433.6pt;height:108.8pt;vertical-align:-0.9pt;"><span class="ltx_transformed_inner" style="transform:translate(-36.4pt,9.1pt) scale(0.856226164526361,0.856226164526361) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T1.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T1.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S3.T1.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.1.1">Models</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.1.2">BLEU-1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.1.3">BLEU-2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.1.4">ROUGE-1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.1.5">ROUGE-2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.1.6">ROUGE-L</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.1.7">GLEU</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.1.1.2.1.1">ZhongJing2/ + <span class="ltx_text ltx_font_smallcaps" id="S3.T1.1.1.2.1.1.1">MedAide</span>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.2.1.2">9.06/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.2.1.2.1">9.18</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.2.1.3">2.68/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.2.1.3.1">2.81</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.2.1.4">17.54/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.2.1.4.1">19.83</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.2.1.5">1.70/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.2.1.5.1">2.86</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.2.1.6">10.04/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.2.1.6.1">11.74</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.2.1.7">3.66/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.2.1.7.1">4.19</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.1.3.2.1">Meditron-7B/ + <span class="ltx_text ltx_font_smallcaps" id="S3.T1.1.1.3.2.1.1">MedAide</span>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.2.2">3.76/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.3.2.2.1">4.94</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.2.3">0.91/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.3.2.3.1">1.30</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.2.4">9.63/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.3.2.4.1">10.51</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.2.5">0.64/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.3.2.5.1">0.68</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.2.6">4.52/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.3.2.6.1">5.21</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.2.7">1.74/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.3.2.7.1">2.07</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.1.4.3.1">HuatuoGPT-II/ + <span class="ltx_text ltx_font_smallcaps" id="S3.T1.1.1.4.3.1.1">MedAide</span>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.3.2">14.6/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.4.3.2.1">15.18</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.3.3">5.87/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.4.3.3.1">6.63</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.3.4">26.81/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.4.3.4.1">31.84</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.3.5">5.26/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.4.3.5.1">9.88</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.3.6">13.57/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.4.3.6.1">19.04</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.3.7">6.43/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.4.3.7.1">7.25</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.1.1.5.4.1">Baichuan4/ + <span class="ltx_text ltx_font_smallcaps" id="S3.T1.1.1.5.4.1.1">MedAide</span>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.5.4.2">12.97/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.5.4.2.1">15.95</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.5.4.3">5.39/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.5.4.3.1">7.85</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.5.4.4">22.68/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.5.4.4.1">33.60</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.5.4.5">4.68/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.5.4.5.1">11.69</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.5.4.6">13.33/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.5.4.6.1">20.75</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.5.4.7">5.57/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.5.4.7.1">7.98</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.1.6.5.1">LLama-3.1-8B/ + <span class="ltx_text ltx_font_smallcaps" id="S3.T1.1.1.6.5.1.1">MedAide</span>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.6.5.2">10.95/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.6.5.2.1">15.36</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.6.5.3">2.13/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.6.5.3.1">6.78</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.6.5.4">22.47/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.6.5.4.1">32.54</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.6.5.5">2.62/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.6.5.5.1">9.41</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.6.5.6">11.45/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.6.5.6.1">19.29</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.6.5.7">4.37/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.6.5.7.1">6.45</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S3.T1.1.1.7.6.1">GPT-4o/ + <span class="ltx_text ltx_font_smallcaps" id="S3.T1.1.1.7.6.1.1">MedAide</span>
</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.7.6.2">15.28/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.7.6.2.1">15.93</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.7.6.3">6.33/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.7.6.3.1">7.56</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.7.6.4">26.89/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.7.6.4.1">30.78</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.7.6.5">5.95/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.7.6.5.1">8.65</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.7.6.6">14.15/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.7.6.6.1">17.64</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.7.6.7">6.34/<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.7.6.7.1">7.31</span>
</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Comparison results on the Pre-Diagnosis benchmark.</figcaption>
</figure>
<figure class="ltx_table" id="S3.T2">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T2.1" style="width:433.6pt;height:105.2pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-44.7pt,10.8pt) scale(0.828945457400934,0.828945457400934) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T2.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T2.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S3.T2.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.1.1.1">Models</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T2.1.1.1.1.2">BLEU-1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T2.1.1.1.1.3">BLEU-2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T2.1.1.1.1.4">ROUGE-1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T2.1.1.1.1.5">ROUGE-2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T2.1.1.1.1.6">ROUGE-L</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T2.1.1.1.1.7">GLEU</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T2.1.1.2.1.1">ZhongJing2/ + <span class="ltx_text ltx_font_smallcaps" id="S3.T2.1.1.2.1.1.1">MedAide</span>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.2.1.2">10.50/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.2.1.2.1">11.72</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.2.1.3">4.80/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.2.1.3.1">5.58</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.2.1.4">24.08/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.2.1.4.1">24.59</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.2.1.5">4.93/4.79</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.2.1.6">12.94/11.96</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.2.1.7">5.85/5.79</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T2.1.1.3.2.1">Meditron-7B/ + <span class="ltx_text ltx_font_smallcaps" id="S3.T2.1.1.3.2.1.1">MedAide</span>
</th>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.3.2.2">12.01/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.3.2.2.1">13.93</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.3.2.3">3.13/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.3.2.3.1">6.03</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.3.2.4">19.10/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.3.2.4.1">26.53</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.3.2.5">3.60/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.3.2.5.1">6.12</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.3.2.6">8.60/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.3.2.6.1">11.67</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.3.2.7">3.99/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.3.2.7.1">6.48</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T2.1.1.4.3.1">HuatuoGPT-II/ + <span class="ltx_text ltx_font_smallcaps" id="S3.T2.1.1.4.3.1.1">MedAide</span>
</th>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.4.3.2">22.65/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.4.3.2.1">25.26</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.4.3.3">10.21/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.4.3.3.1">12.11</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.4.3.4">34.51/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.4.3.4.1">40.32</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.4.3.5">8.36/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.4.3.5.1">11.73</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.4.3.6">15.77/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.4.3.6.1">19.11</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.4.3.7">8.95/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.4.3.7.1">10.65</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T2.1.1.5.4.1">Baichuan4/ + <span class="ltx_text ltx_font_smallcaps" id="S3.T2.1.1.5.4.1.1">MedAide</span>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.5.4.2">22.58/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.5.4.2.1">25.51</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.5.4.3">10.98/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.5.4.3.1">13.61</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.5.4.4">36.26/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.5.4.4.1">42.77</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.5.4.5">10.30/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.5.4.5.1">15.00</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.5.4.6">17.03/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.5.4.6.1">22.43</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.5.4.7">9.61/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.5.4.7.1">11.95</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T2.1.1.6.5.1">LLama-3.1-8B/ + <span class="ltx_text ltx_font_smallcaps" id="S3.T2.1.1.6.5.1.1">MedAide</span>
</th>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.6.5.2">16.92/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.6.5.2.1">22.75</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.6.5.3">6.56/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.6.5.3.1">9.97</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.6.5.4">26.39/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.6.5.4.1">38.52</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.6.5.5">4.78/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.6.5.5.1">10.41</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.6.5.6">12.79/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.6.5.6.1">18.68</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.6.5.7">6.21/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.6.5.7.1">8.94</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S3.T2.1.1.7.6.1">GPT-4o/ + <span class="ltx_text ltx_font_smallcaps" id="S3.T2.1.1.7.6.1.1">MedAide</span>
</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.1.7.6.2">21.67/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.7.6.2.1">26.80</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.1.7.6.3">9.73/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.7.6.3.1">14.56</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.1.7.6.4">32.67/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.7.6.4.1">44.11</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.1.7.6.5">7.95/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.7.6.5.1">15.81</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.1.7.6.6">16.20/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.7.6.6.1">23.67</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.1.7.6.7">8.41/<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.7.6.7.1">12.69</span>
</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Comparison results on the Diagnosis benchmark.</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Datasets and Implementation Details</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">All experiments are conducted in the zero-shot setting.
To reflect the real-world demands for healthcare services, we conduct four different benchmarks across 17 types of medical intents, including <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.1">Pre-Diagnosis</span>, <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.2">Diagnosis</span>, <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.3">Medicament</span>, and <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.4">Post-Diagnosis</span> benchmarks.
Each benchmark contains 500 composite intent instances. Please refer to Figures <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#A2.F7" title="Figure 7 ‣ Appendix B Prompt Templates ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">7</span></a>,  <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#A2.F8" title="Figure 8 ‣ Appendix B Prompt Templates ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">8</span></a>,  <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#A2.F9" title="Figure 9 ‣ Appendix B Prompt Templates ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">9</span></a>, and  <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#A2.F10" title="Figure 10 ‣ Appendix B Prompt Templates ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">10</span></a>. in the Appendix for the specific intent taxonomy.
For a comprehensive overview of the prompts used during the query rewriting and agent collaboration phases within <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p1.1.5">MedAide</span>, refer to Appendix  <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#A2" title="Appendix B Prompt Templates ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">B</span></a>. Additionally, to enable fine-grained medical intent recognition, we develop a contextual encoder training dataset consisting of 2,800 training samples, 300 validation samples, and 300 testing samples. Further configuration details can be found in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#A1.SS3" title="A.3 Training Details of BioBert Encoder ‣ Appendix A Implementation Details ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">A.3</span></a>.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T3.1" style="width:433.6pt;height:109.9pt;vertical-align:-0.9pt;"><span class="ltx_transformed_inner" style="transform:translate(-33.9pt,8.5pt) scale(0.864763848948508,0.864763848948508) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T3.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T3.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.1.1.1">Models</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.1.1.1.1.2">BLEU-1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.1.1.1.1.3">BLEU-2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.1.1.1.1.4">ROUGE-1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.1.1.1.1.5">ROUGE-2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.1.1.1.1.6">ROUGE-L</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.1.1.1.1.7">GLEU</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.1.1.2.1.1">ZhongJing2/ + <span class="ltx_text ltx_font_smallcaps" id="S4.T3.1.1.2.1.1.1">MedAide</span>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.2.1.2">11.83/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.2.1.2.1">11.91</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.2.1.3">4.48/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.2.1.3.1">4.57</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.2.1.4">21.61/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.2.1.4.1">24.23</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.2.1.5">4.65/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.2.1.5.1">5.91</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.2.1.6">13.55/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.2.1.6.1">14.75</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.2.1.7">5.32/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.2.1.7.1">6.38</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.1.1.3.2.1">Meditron-7B/ + <span class="ltx_text ltx_font_smallcaps" id="S4.T3.1.1.3.2.1.1">MedAide</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.3.2.2">5.76/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.3.2.2.1">19.43</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.3.2.3">2.04/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.3.2.3.1">17.50</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.3.2.4">12.29/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.3.2.4.1">34.84</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.3.2.5">2.12/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.3.2.5.1">29.43</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.3.2.6">6.31/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.3.2.6.1">32.57</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.3.2.7">2.79/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.3.2.7.1">24.47</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.1.1.4.3.1">HuatuoGPT-II/ + <span class="ltx_text ltx_font_smallcaps" id="S4.T3.1.1.4.3.1.1">MedAide</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.3.2">17.14/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.4.3.2.1">37.89</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.3.3">9.61/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.4.3.3.1">27.47</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.3.4">30.72/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.4.3.4.1">58.06</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.3.5">11.96/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.4.3.5.1">33.62</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.3.6">19.96/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.4.3.6.1">45.39</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.3.7">9.57/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.4.3.7.1">24.23</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.1.1.5.4.1">Baichuan4/ + <span class="ltx_text ltx_font_smallcaps" id="S4.T3.1.1.5.4.1.1">MedAide</span>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.5.4.2">14.64/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.5.4.2.1">44.63</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.5.4.3">7.12/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.5.4.3.1">36.34</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.5.4.4">26.26/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.5.4.4.1">62.11</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.5.4.5">8.09/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.5.4.5.1">42.56</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.5.4.6">15.47/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.5.4.6.1">49.91</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.5.4.7">7.08/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.5.4.7.1">35.99</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.1.1.6.5.1">LLama-3.1-8B/ + <span class="ltx_text ltx_font_smallcaps" id="S4.T3.1.1.6.5.1.1">MedAide</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.5.2">13.80/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.6.5.2.1">23.87</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.5.3">5.90/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.6.5.3.1">16.75</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.5.4">27.28/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.6.5.4.1">47.39</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.5.5">7.50/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.6.5.5.1">26.75</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.5.6">16.05/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.6.5.6.1">38.30</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.5.7">6.37/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.6.5.7.1">15.77</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T3.1.1.7.6.1">GPT-4o/ + <span class="ltx_text ltx_font_smallcaps" id="S4.T3.1.1.7.6.1.1">MedAide</span>
</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.7.6.2">16.23/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.7.6.2.1">45.13</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.7.6.3">8.16/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.7.6.3.1">38.96</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.7.6.4">29.24/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.7.6.4.1">65.09</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.7.6.5">9.78/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.7.6.5.1">40.53</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.7.6.6">17.53/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.7.6.6.1">52.71</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.7.6.7">8.61/<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.7.6.7.1">37.09</span>
</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Comparison results on the Medicament benchmark.</figcaption>
</figure>
<figure class="ltx_table" id="S4.T4">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T4.1" style="width:433.6pt;height:103.6pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-48.9pt,11.6pt) scale(0.81594682103636,0.81594682103636) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T4.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T4.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T4.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.1.1.1.1">Models</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.1.1.1.1.2">BLEU-1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.1.1.1.1.3">BLEU-2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.1.1.1.1.4">ROUGE-1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.1.1.1.1.5">ROUGE-2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.1.1.1.1.6">ROUGE-L</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.1.1.1.1.7">GLEU</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.1.1.2.1.1">ZhongJing2/ + <span class="ltx_text ltx_font_smallcaps" id="S4.T4.1.1.2.1.1.1">MedAide</span>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.2.1.2">12.97/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.2.1.2.1">19.91</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.2.1.3">4.86/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.2.1.3.1">6.86</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.2.1.4">25.31/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.2.1.4.1">31.98</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.2.1.5">4.21/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.2.1.5.1">4.48</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.2.1.6">12.44/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.2.1.6.1">15.00</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.2.1.7">5.63/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.2.1.7.1">7.22</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.1.1.3.2.1">Meditron-7B/ + <span class="ltx_text ltx_font_smallcaps" id="S4.T4.1.1.3.2.1.1">MedAide</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.3.2.2">8.72/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.3.2.2.1">12.78</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.3.2.3">2.46/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.3.2.3.1">3.06</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.3.2.4">18.75/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.3.2.4.1">20.21</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.3.2.5">1.77/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.3.2.5.1">4.32</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.3.2.6">7.28/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.3.2.6.1">8.58</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.3.2.7">3.84/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.3.2.7.1">4.40</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.1.1.4.3.1">HuatuoGPT-II/ + <span class="ltx_text ltx_font_smallcaps" id="S4.T4.1.1.4.3.1.1">MedAide</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.4.3.2">21.39/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.4.3.2.1">26.10</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.4.3.3">12.24/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.4.3.3.1">12.46</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.4.3.4">35.55/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.4.3.4.1">42.23</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.4.3.5">11.02/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.4.3.5.1">13.62</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.4.3.6">13.62/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.4.3.6.1">21.18</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.4.3.7">10.59/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.4.3.7.1">10.96</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.1.1.5.4.1">Baichuan4/ + <span class="ltx_text ltx_font_smallcaps" id="S4.T4.1.1.5.4.1.1">MedAide</span>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.5.4.2">15.89/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.5.4.2.1">26.10</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.5.4.3">7.06/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.5.4.3.1">13.92</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.5.4.4">27.69/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.5.4.4.1">44.55</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.5.4.5">6.92/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.5.4.5.1">13.05</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.5.4.6">14.86/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.5.4.6.1">21.35</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.5.4.7">6.59/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.5.4.7.1">11.61</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.1.1.6.5.1">LLama-3.1-8B/ + <span class="ltx_text ltx_font_smallcaps" id="S4.T4.1.1.6.5.1.1">MedAide</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.6.5.2">21.85/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.6.5.2.1">22.95</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.6.5.3">7.42/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.6.5.3.1">7.68</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.6.5.4">35.36/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.6.5.4.1">39.71</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.6.5.5">5.22/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.6.5.5.1">7.97</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.6.5.6">15.02/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.6.5.6.1">17.93</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.6.5.7">7.65/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.6.5.7.1">8.01</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T4.1.1.7.6.1">GPT-4o/ + <span class="ltx_text ltx_font_smallcaps" id="S4.T4.1.1.7.6.1.1">MedAide</span>
</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.1.7.6.2">19.27/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.7.6.2.1">26.83</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.1.7.6.3">9.28/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.7.6.3.1">11.54</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.1.7.6.4">30.72/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.7.6.4.1">40.83</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.1.7.6.5">8.64/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.7.6.5.1">8.71</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.1.7.6.6">16.22/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.7.6.6.1">18.12</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.1.7.6.7">8.41/<span class="ltx_text ltx_font_bold" id="S4.T4.1.1.7.6.7.1">9.89</span>
</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Comparison results on the Post-Diagnosis benchmark.</figcaption>
</figure>
<figure class="ltx_figure" id="S4.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="145" id="S4.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Response comparisons of <span class="ltx_text ltx_font_smallcaps" id="S4.F2.2.1">MedAide</span> with other baselines via doctor evaluation.
</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Model Zoo</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We compare a series of state-of-the-art (SOTA) models for comprehensive evaluations. Among medical LLMs, <span class="ltx_text ltx_font_bold" id="S4.SS2.p1.1.1">ZhongJing2</span> <cite class="ltx_cite ltx_citemacro_cite">Shi (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib28" title="">2023</a>)</cite> is a traditional Chinese medicine model based on Qwen-1.5-1.8B with complete training procedures.
<span class="ltx_text ltx_font_bold" id="S4.SS2.p1.1.2">Meditron-7B</span> <cite class="ltx_cite ltx_citemacro_cite">Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib9" title="">2023b</a>)</cite> performs medically relevant continuous pre-training on Llama-2-7B to extend the breadth and depth of the model in medical knowledge. <span class="ltx_text ltx_font_bold" id="S4.SS2.p1.1.3">HuatuoGPT-II (13B)</span> <cite class="ltx_cite ltx_citemacro_cite">Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib8" title="">2023a</a>)</cite> employs a one-stage unified approach for domain adaptation to improve medical expertise and model applicability.
In general-purpose models, <span class="ltx_text ltx_font_bold" id="S4.SS2.p1.1.4">Baichuan4</span> <cite class="ltx_cite ltx_citemacro_cite">AI (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib4" title="">2024</a>)</cite> optimizes long texts by scaling law and combines reinforcement learning techniques to improve reasoning ability. <span class="ltx_text ltx_font_bold" id="S4.SS2.p1.1.5">Llama-3.1-8B</span> <cite class="ltx_cite ltx_citemacro_cite">Dubey et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib13" title="">2024</a>)</cite> relies on the grouped query attention mechanism to enhance the inference efficiency and performs well on multilingual tasks.
<span class="ltx_text ltx_font_bold" id="S4.SS2.p1.1.6">GPT-4o</span> <cite class="ltx_cite ltx_citemacro_cite">OpenAI (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib25" title="">2024</a>)</cite> shows excellent language comprehension and generation capabilities and excels in handling complex tasks.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Comparision with SOTA Methods</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">As a plug-and-play framework, we combine <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p1.1.1">MedAide</span> with the baseline models to provide comprehensive evaluations by different metrics, including BLEU-1/2 (%), ROUGE-1/2/L (%), and GLEU (%). Comparison results on the four medical benchmarks are shown below.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p2.1.1">Results on Pre-Diagnosis Benchmark.</span>
As Table <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S3.T1" title="Table 1 ‣ 3.3 Agent Collaboration ‣ 3 Methodology ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">1</span></a> shows, our framework consistently improves the performance across metrics for all models.
(i) For instance, <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p2.1.2">MedAide</span>-based HuatuoGPT-II and Baichuan4 show significant relative improvements in ROUGE-L scores of 40.3% and 55.6%, respectively, suggesting multidimensional health risk assessments for patient cases.
(ii) In addition, <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p2.1.3">MedAide</span> helps general LLama-3.1-8B to enhance the diversity and precision of diagnostic content generation, as reflected in the average 79.15% increase of BLEU-1/2 relative to the vanilla baseline.
(iii) Despite the performance constraints of ZhongJing2 and Meditron-7B in tackling complex medical scenarios due to the scaling law, our framework still provides sustained performance gains.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p3.1.1">Results on Diagnosis Benchmark.</span>
Table <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S3.T2" title="Table 2 ‣ 3.3 Agent Collaboration ‣ 3 Methodology ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">2</span></a> shows the diagnosis task results containing six composite intent scenarios.
(i) Combined with our framework, Meditron-7B and HuatuoGPT-II outperform vanilla baselines in response accuracy and completeness, as evidenced by significant improvements across metrics. These gains show that <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p3.1.2">MedAide</span> assists medical LLMs in giving more comprehensive symptom analyses and treatment suggestions with enhanced hierarchical interpretation capabilities regarding examination results.
(ii) Meanwhile, the general models (<span class="ltx_text ltx_font_italic" id="S4.SS3.p3.1.3">e.g.,</span> LLama-3.1-8B and GPT-4o) equipped with <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p3.1.4">MedAide</span> enhance the specialization and adaptability in healthcare services.
(iii) We observe slight performance drops (less than 1%) in ZhongJing-2 on ROUGE-2/L and GLEU. The potential reason is that the model has difficulty in the query rewriting phase to grasp the multifaceted knowledge of the retrieval-augmented generation due to the limited capacity, causing sub-optimal prevention guidelines and second opinions.</p>
</div>
<figure class="ltx_table" id="S4.T5">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T5.1" style="width:433.6pt;height:87.4pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-53.5pt,10.7pt) scale(0.802153172174738,0.802153172174738) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T5.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T5.1.1.1.1">
<td class="ltx_td ltx_border_tt" id="S4.T5.1.1.1.1.1"></td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T5.1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.1.1.2.1">Pre-Diagnosis</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T5.1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.1.1.3.1">Diagnosis</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T5.1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.1.1.4.1">Medicament</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T5.1.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.1.1.5.1">Post-Diagnosis</span></th>
</tr>
<tr class="ltx_tr" id="S4.T5.1.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T5.1.1.2.2.1"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.2.2.1.1">Components</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.1.2.2.2">ROUGE-L</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.1.2.2.3">GLEU</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.1.2.2.4">ROUGE-L</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.1.2.2.5">GLEU</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.1.2.2.6">ROUGE-L</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.1.2.2.7">GLEU</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.1.2.2.8">ROUGE-L</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.1.2.2.9">GLEU</th>
</tr>
<tr class="ltx_tr" id="S4.T5.1.1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.1.3.3.1">Full <span class="ltx_text ltx_font_smallcaps" id="S4.T5.1.1.3.3.1.1">MedAide</span>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.1.3.3.2"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.3.3.2.1">17.64</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.1.3.3.3"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.3.3.3.1">7.31</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.1.3.3.4"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.3.3.4.1">23.67</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.1.3.3.5"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.3.3.5.1">12.69</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.1.3.3.6"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.3.3.6.1">52.71</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.1.3.3.7"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.3.3.7.1">37.09</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.1.3.3.8"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.3.3.8.1">18.12</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.1.3.3.9"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.3.3.9.1">9.89</span></th>
</tr>
<tr class="ltx_tr" id="S4.T5.1.1.4.4">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.4.4.1">w/o Query Rewriting</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.4.4.2">16.02</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.4.4.3">6.44</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.4.4.4">18.35</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.4.4.5">10.37</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.4.4.6">32.06</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.4.4.7">32.45</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.4.4.8">16.48</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.4.4.9">8.79</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.1.5.5">
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.5.5.1">w/ GPT-4o Recognition</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.5.5.2">16.58</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.5.5.3">6.73</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.5.5.4">22.98</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.5.5.5">12.34</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.5.5.6">44.72</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.5.5.7">34.10</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.5.5.8">17.56</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.5.5.9">9.02</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.1.6.6">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.1.6.6.1">w/o Decision Analysis</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.1.6.6.2">17.22</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.1.6.6.3">7.22</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.1.6.6.4">23.14</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.1.6.6.5">12.54</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.1.6.6.6">48.72</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.1.6.6.7">35.25</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.1.6.6.8">18.04</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.1.6.6.9">9.56</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Ablation study results on four benchmarks.“w/” and “w/o” are short for with and without, respectively.</figcaption>
</figure>
<figure class="ltx_table" id="S4.T6">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T6.1" style="width:433.6pt;height:171.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(80.6pt,-32.0pt) scale(1.59183195851763,1.59183195851763) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T6.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T6.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T6.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T6.1.1.1.1.1.1">Benchmarks</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T6.1.1.1.1.2"><span class="ltx_text ltx_font_smallcaps" id="S4.T6.1.1.1.1.2.1">MedAide</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T6.1.1.1.1.3">w/o QR</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T6.1.1.1.1.4">w/ GPT-4 R</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T6.1.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T6.1.1.2.1.1">Pre-Diagnosis</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T6.1.1.2.1.2"><span class="ltx_text ltx_font_bold" id="S4.T6.1.1.2.1.2.1">0.76</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T6.1.1.2.1.3">0.62</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.1.1.2.1.4">0.47</td>
</tr>
<tr class="ltx_tr" id="S4.T6.1.1.3.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.1.1.3.2.1">Diagnosis</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.1.1.3.2.2"><span class="ltx_text ltx_font_bold" id="S4.T6.1.1.3.2.2.1">0.83</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.1.1.3.2.3">0.61</td>
<td class="ltx_td ltx_align_center" id="S4.T6.1.1.3.2.4">0.49</td>
</tr>
<tr class="ltx_tr" id="S4.T6.1.1.4.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.1.1.4.3.1">Medicament</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.1.1.4.3.2"><span class="ltx_text ltx_font_bold" id="S4.T6.1.1.4.3.2.1">0.80</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.1.1.4.3.3">0.49</td>
<td class="ltx_td ltx_align_center" id="S4.T6.1.1.4.3.4">0.51</td>
</tr>
<tr class="ltx_tr" id="S4.T6.1.1.5.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.1.1.5.4.1">Post-Diagnosis</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.1.1.5.4.2"><span class="ltx_text ltx_font_bold" id="S4.T6.1.1.5.4.2.1">0.63</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.1.1.5.4.3">0.56</td>
<td class="ltx_td ltx_align_center" id="S4.T6.1.1.5.4.4">0.37</td>
</tr>
<tr class="ltx_tr" id="S4.T6.1.1.6.5">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T6.1.1.6.5.1">Intent Aggregation</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T6.1.1.6.5.2"><span class="ltx_text ltx_font_bold" id="S4.T6.1.1.6.5.2.1">0.86</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T6.1.1.6.5.3">0.60</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T6.1.1.6.5.4">0.60</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Comparison of F1 scores (%) across five benchmarks. “QR” means the Query Rewriting. “GPT-4o R” means the GPT-4o Recognition.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS3.p4">
<p class="ltx_p" id="S4.SS3.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p4.1.1">Results on Medicament Benchmark.</span>
Table <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S4.T3" title="Table 3 ‣ 4.1 Datasets and Implementation Details ‣ 4 Experiments ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">3</span></a> provides the exploration results of different models on composite medication intents.
(i) Attributed to the drug knowledge injection and prototype-guided embedding in <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p4.1.2">MedAide</span>, the reliability of medication counseling responses is consistently improved across all baselines.
(ii) In this case, Baichuan4 and GPT-4o demonstrate the most significant overall gains. For example, the GLEU scores separately increase 28.91% and 28.48%. This finding indicates that <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p4.1.3">MedAide</span> facilitates LLMs with large-window contexts to comprehend rich drug information and provide specialized dosage recommendations.
(iii) In the zero-shot reasoning pattern, Meditron-7B’s ROUGE-1/2/L remarkably enhances from 12.29/2.12/6.31% to 34.84/29.43/32.57%, verifying that our decision-analysis module provides favorable factual evidence in drug contraindication understanding.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p5">
<p class="ltx_p" id="S4.SS3.p5.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p5.1.1">Results on Post-Diagnosis Benchmark.</span>
(i) In the post-diagnosis applications from Table <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S4.T4" title="Table 4 ‣ 4.1 Datasets and Implementation Details ‣ 4 Experiments ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">4</span></a>, we observe that most <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p5.1.2">MedAide</span>-based models are superior to vanilla baselines by large margins.
(ii) GPT-4o performs even better in generating personalized rehabilitation recommendations, with a relative improvement of 39.23% in the BLEU-1 score, providing hopefully more reliable rehabilitation guidelines for patients.
(iii) Meanwhile, Baichuan4 improves on the ROUGE-L metric by 21.35%, revealing the <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p5.1.3">MedAide</span>-based version’s advantages in processing dynamic medical data and producing progress tracking reports.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Expert Doctor Evaluation</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">Expert evaluations play a key role in the practical applications of medical models. We invite 6 doctors (each paid $300) to select the winners of responses generated by different models before and after the introduction of <span class="ltx_text ltx_font_smallcaps" id="S4.SS4.p1.1.1">MedAide</span> by majority voting rule. The response content is holistically evaluated by considering factual accuracy, recommendation practicality, and humanistic care.
(i) As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S4.F2" title="Figure 2 ‣ 4.1 Datasets and Implementation Details ‣ 4 Experiments ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">2</span></a>, all the <span class="ltx_text ltx_font_smallcaps" id="S4.SS4.p1.1.2">MedAide</span>-based models exhibit more win rates in different benchmark tests, indicating the effectiveness and applicability of the proposed framework. (ii) <span class="ltx_text ltx_font_smallcaps" id="S4.SS4.p1.1.3">MedAide</span> not only improves the healthcare specialization of medical LLMs with different sizes, but also significantly enhances the coping ability of general-purpose models when dealing with complicated medical tasks.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Ablation Study</h3>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">We perform systematic ablation studies to explore the effects of different components in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S4.T5" title="Table 5 ‣ 4.3 Comparision with SOTA Methods ‣ 4 Experiments ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">5</span></a>.
GPT-4o is chosen as the baseline to combine <span class="ltx_text ltx_font_smallcaps" id="S4.SS5.p1.1.1">MedAide</span>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS5.p2">
<p class="ltx_p" id="S4.SS5.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS5.p2.1.1">Necessity of Query Rewriting.</span>
Firstly, we remove the query rewriting procedure to assess its impact on performance. (i) The observed significant declines in all metrics indicate that query rewriting is crucial for ensuring that the input information is accurately interpreted by downstream modules with respect to intents. (ii) Additionally, incorporating factual information as context enhances the model’s ability to accurately comprehend user queries, mitigating hallucinations and reducing the generation of ambiguous interpretations.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS5.p3">
<p class="ltx_p" id="S4.SS5.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS5.p3.1.1">Importance of Intent Recognition.</span>
We replace the learning-based contextual encoder with the prompt-based GPT-4o to explore the impact of different intent recognition strategies. (i) Despite the improvement over the vanilla baseline, GPT-4o recognition is a sub-optimal solution. We argue that the encoder trained with explicitly supervised information can align more purposefully to actual medical intents, producing more personalized and representative judgments than prompt engineering.
(ii) Also, our default strategy has better flexibility and extensibility, which can be dynamically optimized according to specific healthcare scenarios.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS5.p4">
<p class="ltx_p" id="S4.SS5.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS5.p4.1.1">Effectiveness of Decision Analysis.</span>
Furthermore, we directly assemble the different outputs produced by the activated agents to serve as an alternative candidate. The results from the bottom of Table <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S4.T5" title="Table 5 ‣ 4.3 Comparision with SOTA Methods ‣ 4 Experiments ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">5</span></a> show consistent performance drops of the model on different medical intent understandings, proving the effectiveness of our method.
A plausible explanation is that the decision analysis module not only summarizes the different agent outputs in an organized manner, but also provides comprehensive and accurate conclusions based on medical guidelines and patient histories.</p>
</div>
<figure class="ltx_table" id="S4.T7">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T7.1" style="width:433.6pt;height:167.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(100.5pt,-38.9pt) scale(1.86391563353817,1.86391563353817) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T7.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T7.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T7.1.1.1.1.1" style="padding-top:-0.5pt;padding-bottom:-0.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T7.1.1.1.1.1.1">Benchmarks</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T7.1.1.1.1.2" style="padding-top:-0.5pt;padding-bottom:-0.5pt;">
<span class="ltx_text ltx_font_smallcaps" id="S4.T7.1.1.1.1.2.1">MedAide</span> (Ours)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T7.1.1.1.1.3" style="padding-top:-0.5pt;padding-bottom:-0.5pt;">MedAgent</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T7.1.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T7.1.1.2.1.1" style="padding-top:-0.5pt;padding-bottom:-0.5pt;">Pre-Diagnosis</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T7.1.1.2.1.2" style="padding-top:-0.5pt;padding-bottom:-0.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T7.1.1.2.1.2.1">15.93/17.64</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.1.1.2.1.3" style="padding-top:-0.5pt;padding-bottom:-0.5pt;">14.33/15.26</td>
</tr>
<tr class="ltx_tr" id="S4.T7.1.1.3.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T7.1.1.3.2.1" style="padding-top:-0.5pt;padding-bottom:-0.5pt;">Diagnosis</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T7.1.1.3.2.2" style="padding-top:-0.5pt;padding-bottom:-0.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T7.1.1.3.2.2.1">27.80/23.67</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.1.3.2.3" style="padding-top:-0.5pt;padding-bottom:-0.5pt;">25.46/19.54</td>
</tr>
<tr class="ltx_tr" id="S4.T7.1.1.4.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T7.1.1.4.3.1" style="padding-top:-0.5pt;padding-bottom:-0.5pt;">Medicament</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T7.1.1.4.3.2" style="padding-top:-0.5pt;padding-bottom:-0.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T7.1.1.4.3.2.1">45.13/52.17</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.1.4.3.3" style="padding-top:-0.5pt;padding-bottom:-0.5pt;">28.69/36.07</td>
</tr>
<tr class="ltx_tr" id="S4.T7.1.1.5.4">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T7.1.1.5.4.1" style="padding-top:-0.5pt;padding-bottom:-0.5pt;">Post-Diagnosis</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T7.1.1.5.4.2" style="padding-top:-0.5pt;padding-bottom:-0.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T7.1.1.5.4.2.1">26.83/18.12</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T7.1.1.5.4.3" style="padding-top:-0.5pt;padding-bottom:-0.5pt;">25.45/16.69</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>Comparison of BLEU-1/ROUGE-L scores (%) between <span class="ltx_text ltx_font_smallcaps" id="S4.T7.3.1">MedAide</span> and MedAgent across benchmarks.</figcaption>
</figure>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="412" id="S4.F3.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Response visualization analysis on different models for the same user query.
</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6 </span>Intent Detection Analysis</h3>
<div class="ltx_para" id="S4.SS6.p1">
<p class="ltx_p" id="S4.SS6.p1.1">To further observe the intent detection performance, Table <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S4.T6" title="Table 6 ‣ 4.3 Comparision with SOTA Methods ‣ 4 Experiments ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">6</span></a> compares the F1 scores computed between the intents recognized by <span class="ltx_text ltx_font_smallcaps" id="S4.SS6.p1.1.1">MedAide</span> and ground truths under different strategies. We randomly sample 100 instances from each benchmark to compose a more challenging Intent Aggregation benchmark. The core observations are as follows.
(i) The complete framework achieves the best results, reaching even 86% performance on the Aggregation benchmark, exhibiting omni intent semantic understanding capabilities.
(ii) Significant performance deteriorations occur at “w/o QR” and “w/ GPT-4o R”, implying the effectiveness of fine-grained decomposition of medical queries and the development of our tailored intent recognition mechanism.</p>
</div>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="519" id="S4.F4.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>The effect of different agent numbers on performance across the four medical benchmarks.
</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.7 </span>Collaboration Framework Comparison</h3>
<div class="ltx_para" id="S4.SS7.p1">
<p class="ltx_p" id="S4.SS7.p1.1">Here, we compare the reproducible multi-agent framework MedAgent <cite class="ltx_cite ltx_citemacro_cite">Tang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#bib.bib29" title="">2024</a>)</cite>. This medical framework mainly sets up four department-specific experts, including pediatrics, cardiology, pulmonology, and neonatology. Each expert is based on the GPT-4o implementation and works together to collaboratively generate a unified report as the final result.
(i) From Table <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S4.T7" title="Table 7 ‣ 4.5 Ablation Study ‣ 4 Experiments ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">7</span></a>, our framework outperforms MedAgent on all four benchmarks. For instance, in the Medicament benchmark, <span class="ltx_text ltx_font_smallcaps" id="S4.SS7.p1.1.1">MedAide</span> beats MedAgent by large margins with absolute gains of 16.44/16.70% on the BLEU-1/ROUGE-L scores.
This strength comes from our specialized medication retrieval, which provides a refined context of drug information for the model.
(ii) Also, the benefits on Pre-Diagnosis and Post-Diagnosis tasks reflect that the proposed <span class="ltx_text ltx_font_smallcaps" id="S4.SS7.p1.1.2">MedAide</span> captures the key characteristics of diagnostic and nursing demands more efficiently.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS8">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.8 </span>Response Visualization Analysis</h3>
<div class="ltx_para" id="S4.SS8.p1">
<p class="ltx_p" id="S4.SS8.p1.1">To intuitively compare the response quality of the different models, we show in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S4.F3" title="Figure 3 ‣ 4.5 Ablation Study ‣ 4 Experiments ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">3</span></a> the generated results of <span class="ltx_text ltx_font_smallcaps" id="S4.SS8.p1.1.1">MedAide</span> and SOTA methods under the same user query.
HuatuoGPT-II provides extensive medical knowledge but lacks targeted recommendations. Although the MedAgent framework gives detailed treatment solutions through multidisciplinary perspectives, it falls short of coherent diagnostic reasoning.
In contrast, our framework interprets patient outcomes in detail and provides personalized diagnoses and subsequent treatments. <span class="ltx_text ltx_font_smallcaps" id="S4.SS8.p1.1.2">MedAide</span> shows favorable usefulness in electrolyte imbalance and cardiovascular risk management.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS9">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.9 </span>Effect of Agent Number</h3>
<div class="ltx_para" id="S4.SS9.p1">
<p class="ltx_p" id="S4.SS9.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#S4.F4" title="Figure 4 ‣ 4.6 Intent Detection Analysis ‣ 4 Experiments ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">4</span></a> illustrates the variation trend of model performance when the number of agents in the proposed <span class="ltx_text ltx_font_smallcaps" id="S4.SS9.p1.1.1">MedAide</span> changes.
When the agent number is increased from 2 to 4, there are progressive improvements in the results on all benchmarks, suggesting that multi-agent collaboration helps to improve the model’s performance in multi-tasking scenarios. Conversely, when the agent number exceeds 4 does not bring significant gains due to introducing too much information redundancy.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion and Future Work</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">This paper introduces <span class="ltx_text ltx_font_smallcaps" id="S5.p1.1.1">MedAide</span>, a multi-agent framework for complex medical scenarios. Leveraging query rewriting, intent recognition, and agent collaboration, <span class="ltx_text ltx_font_smallcaps" id="S5.p1.1.2">MedAide</span> enhances the model’s comprehension of medical intents and demonstrates effectiveness across multiple benchmarks.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p2">
<p class="ltx_p" id="S5.p2.1"><span class="ltx_text ltx_font_bold" id="S5.p2.1.1">Future Work.</span>
We plan to incorporate complementary modalities (<span class="ltx_text ltx_font_italic" id="S5.p2.1.2">e.g.,</span> medical imaging) in the future to improve the potential of <span class="ltx_text ltx_font_smallcaps" id="S5.p2.1.3">MedAide</span> in multimodal diagnostics and applications.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Limitations</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">The <span class="ltx_text ltx_font_smallcaps" id="Sx1.p1.1.1">MedAide</span> framework, while making significant strides in integrating large-scale medical agents with real clinical environments, has its limitations. Currently, the framework incorporates 26,684 drug samples and 506 genuine clinical case records. Despite this scope, it lacks comprehensive coverage, particularly in research on rare diseases and specialized medications. Furthermore, as the initial versions primarily emphasized linguistic processing, future research aims to extend into multimodal capabilities, particularly the integration of medical imaging data, to enhance the framework’s ability to process visual information in clinical diagnostics. The reliance on OpenAI’s API may pose potential operational challenges, suggesting that future studies should explore using more efficient open-source models as viable alternatives. Despite these limitations, the <span class="ltx_text ltx_font_smallcaps" id="Sx1.p1.1.2">MedAide</span> framework provides a solid foundation for advancing the integration of artificial intelligence in clinical diagnostics.</p>
</div>
</section>
<section class="ltx_section" id="Sx2">
<h2 class="ltx_title ltx_title_section">Ethics Consideration</h2>
<div class="ltx_para" id="Sx2.p1">
<p class="ltx_p" id="Sx2.p1.1">Ethical considerations are paramount in the application of medical agents to real-world clinical settings. We are fully aware of the potential impacts of our research and have taken deliberate actions to address these issues. To enhance transparency, we are committed to publicly making the drug data and medical records used in our study accessible. This will enable other researchers to validate our findings and build upon our work, fostering collaboration and advancement in this field.</p>
</div>
<div class="ltx_para" id="Sx2.p2">
<p class="ltx_p" id="Sx2.p2.1">We are acutely aware of the necessity for privacy and data protection. All data utilized has undergone thorough de-identification, with all sensitive information removed, and verified by a partnering medical institution.
We invite doctors to perform only evaluations of model responses without involving any form of human subject research. All participants are compensated $300 for their work, which strictly adheres to the minimum hourly rate for the region in which the work is performed.
For the utilization of healthcare-related data, we strictly follow the license agreements of publicly available databases. For the constructed data, we have undergone an internal ethical review by the ethics review board of our partnering medical institutions and are licensed and approved.</p>
</div>
</section>
<section class="ltx_section" id="Sx3">
<h2 class="ltx_title ltx_title_section">Acknowledgment</h2>
<div class="ltx_para" id="Sx3.p1">
<p class="ltx_p" id="Sx3.p1.1">This work is supported in part by the National Key R&amp;D Program of China under Grant 2021ZD0113502, in part by the Shanghai Municipal Science and Technology Major Project under Grant 2021SHZDZX0103, and in part by the Shanghai Municipal Science and Technology Committee of Shanghai Outstanding Academic Leaders Plan (No. 21XD1430300).</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai (2023)</span>
<span class="ltx_bibblock">
2023.

</span>
<span class="ltx_bibblock">Baichuan.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/baichuan-inc/Baichuan-13B" title="">https://github.com/baichuan-inc/Baichuan-13B</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pud (2024)</span>
<span class="ltx_bibblock">
2024.

</span>
<span class="ltx_bibblock">National library of medicine.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://pubmed.ncbi.nlm.nih.gov/" title="">https://pubmed.ncbi.nlm.nih.gov/</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Achiam et al. (2023)</span>
<span class="ltx_bibblock">
Josh Achiam, Steven Adler, Sandhini Agarwal, Lama Ahmad, Ilge Akkaya, Florencia Leoni Aleman, Diogo Almeida, Janko Altenschmidt, Sam Altman, Shyamal Anadkat, et al. 2023.

</span>
<span class="ltx_bibblock">Gpt-4 technical report.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">arXiv preprint arXiv:2303.08774</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">AI (2024)</span>
<span class="ltx_bibblock">
Baichuan AI. 2024.

</span>
<span class="ltx_bibblock">Introducing baichuan4.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://platform.baichuan-ai.com/homePage" title="">https://platform.baichuan-ai.com/homePage</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bao et al. (2023)</span>
<span class="ltx_bibblock">
Zhijie Bao, Wei Chen, Shengze Xiao, Kuang Ren, Jiaao Wu, Cheng Zhong, Jiajie Peng, Xuanjing Huang, and Zhongyu Wei. 2023.

</span>
<span class="ltx_bibblock">Disc-medllm: Bridging general large language models and real-world medical consultation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">arXiv preprint arXiv:2308.14346</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cai et al. (2023)</span>
<span class="ltx_bibblock">
Tianle Cai, Xuezhi Wang, Tengyu Ma, Xinyun Chen, and Denny Zhou. 2023.

</span>
<span class="ltx_bibblock">Large language models as tool makers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">arXiv preprint arXiv:2305.17126</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2024)</span>
<span class="ltx_bibblock">
Jiawei Chen, Dingkang Yang, Tong Wu, Yue Jiang, Xiaolu Hou, Mingcheng Li, Shunli Wang, Dongling Xiao, Ke Li, and Lihua Zhang. 2024.

</span>
<span class="ltx_bibblock">Detecting and evaluating medical hallucinations in large vision language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">arXiv preprint arXiv:2406.10185</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2023a)</span>
<span class="ltx_bibblock">
Junying Chen, Xidong Wang, Anningzhe Gao, Feng Jiang, Shunian Chen, Hongbo Zhang, Dingjie Song, Wenya Xie, Chuyi Kong, Jianquan Li, Xiang Wan, Haizhou Li, and Benyou Wang. 2023a.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://api.semanticscholar.org/CorpusID:265221365" title="">Huatuogpt-ii, one-stage training for medical adaption of llms</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">ArXiv</em>, abs/2311.09774.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2023b)</span>
<span class="ltx_bibblock">
Zeming Chen, Alejandro Hernández-Cano, Angelika Romanou, Antoine Bonnet, Kyle Matoba, Francesco Salvi, Matteo Pagliardini, Simin Fan, Andreas Köpf, Amirkeivan Mohtashami, Alexandre Sallinen, Alireza Sakhaeirad, Vinitra Swamy, Igor Krawczuk, Deniz Bayazit, Axel Marmet, Syrielle Montariol, Mary-Anne Hartley, Martin Jaggi, and Antoine Bosselut. 2023b.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2311.16079" title="">Meditron-70b: Scaling medical pretraining for large language models</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Preprint</em>, arXiv:2311.16079.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheng et al. (2023)</span>
<span class="ltx_bibblock">
Yi Cheng, Wenge Liu, Jian Wang, Chak Tou Leong, Yi Ouyang, Wenjie Li, Xian Wu, and Yefeng Zheng. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2312.11792" title="">Cooper: Coordinating specialized agents towards a complex dialogue goal</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Preprint</em>, arXiv:2312.11792.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Codd (1970)</span>
<span class="ltx_bibblock">
Edgar F Codd. 1970.

</span>
<span class="ltx_bibblock">A relational model of data for large shared data banks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Communications of the ACM</em>, 13(6):377–387.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Du et al. (2023)</span>
<span class="ltx_bibblock">
Yilun Du, Shuang Li, Antonio Torralba, Joshua B Tenenbaum, and Igor Mordatch. 2023.

</span>
<span class="ltx_bibblock">Improving factuality and reasoning in language models through multiagent debate.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">arXiv preprint arXiv:2305.14325</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dubey et al. (2024)</span>
<span class="ltx_bibblock">
Abhimanyu Dubey, Abhinav Jauhri, Abhinav Pandey, Abhishek Kadian, Ahmad Al-Dahle, Aiesha Letman, Akhil Mathur, Alan Schelten, Amy Yang, Angela Fan, et al. 2024.

</span>
<span class="ltx_bibblock">The llama 3 herd of models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:2407.21783</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fan et al. (2024)</span>
<span class="ltx_bibblock">
Zhihao Fan, Jialong Tang, Wei Chen, Siyuan Wang, Zhongyu Wei, Jun Xi, Fei Huang, and Jingren Zhou. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2402.09742" title="">Ai hospital: Benchmarking large language models in a multi-agent medical interaction simulator</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Preprint</em>, arXiv:2402.09742.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2018)</span>
<span class="ltx_bibblock">
He He, Derek Chen, Anusha Balakrishnan, and Percy Liang. 2018.

</span>
<span class="ltx_bibblock">Decoupling strategy and generation in negotiation dialogues.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">arXiv preprint arXiv:1808.09637</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hong et al. (2023)</span>
<span class="ltx_bibblock">
Sirui Hong, Mingchen Zhuge, Jonathan Chen, Xiawu Zheng, Yuheng Cheng, Jinlin Wang, Ceyao Zhang, Zili Wang, Steven Ka Shing Yau, Zijuan Lin, et al. 2023.

</span>
<span class="ltx_bibblock">Metagpt: Meta programming for a multi-agent collaborative framework.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">The Twelfth International Conference on Learning Representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2024)</span>
<span class="ltx_bibblock">
Yue Jiang, Jiawei Chen, Dingkang Yang, Mingcheng Li, Shunli Wang, Tong Wu, Ke Li, and Lihua Zhang. 2024.

</span>
<span class="ltx_bibblock">Medthink: Inducing medical large-scale visual language models to hallucinate less by thinking more.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">arXiv preprint arXiv:2406.11451</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. (2019)</span>
<span class="ltx_bibblock">
Jinhyuk Lee, Wonjin Yoon, Sungdong Kim, Donghyeon Kim, Sunkyu Kim, Chan Ho So, and Jaewoo Kang. 2019.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://api.semanticscholar.org/CorpusID:59291975" title="">Biobert: a pre-trained biomedical language representation model for biomedical text mining</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Bioinformatics</em>, 36:1234 – 1240.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. (2024)</span>
<span class="ltx_bibblock">
Unggi Lee, Sanghyeok Lee, Junbo Koh, Yeil Jeong, Haewon Jung, Gyuri Byun, Yunseo Lee, Jewoong Moon, Jieun Lim, and Hyeoncheol Kim. 2024.

</span>
<span class="ltx_bibblock">Generative agent for teacher training: Designing educational problem-solving simulations with large language model-based agents for pre-service teachers.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewis et al. (2021)</span>
<span class="ltx_bibblock">
Patrick Lewis, Ethan Perez, Aleksandra Piktus, Fabio Petroni, Vladimir Karpukhin, Naman Goyal, Heinrich Küttler, Mike Lewis, Wen tau Yih, Tim Rocktäschel, Sebastian Riedel, and Douwe Kiela. 2021.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2005.11401" title="">Retrieval-augmented generation for knowledge-intensive nlp tasks</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Preprint</em>, arXiv:2005.11401.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2024)</span>
<span class="ltx_bibblock">
Binxu Li, Tiankai Yan, Yuanting Pan, Zhe Xu, Jie Luo, Ruiyang Ji, Shilong Liu, Haoyu Dong, Zihao Lin, and Yixin Wang. 2024.

</span>
<span class="ltx_bibblock">Mmedagent: Learning to use medical tools with multi-modal agent.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">arXiv preprint arXiv:2407.02483</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023a)</span>
<span class="ltx_bibblock">
Guohao Li, Hasan Hammoud, Hani Itani, Dmitrii Khizbullin, and Bernard Ghanem. 2023a.

</span>
<span class="ltx_bibblock">Camel: Communicative agents for" mind" exploration of large language model society.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Advances in Neural Information Processing Systems</em>, 36:51991–52008.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023b)</span>
<span class="ltx_bibblock">
Yunxiang Li, Zihan Li, Kai Zhang, Ruilong Dan, Steve Jiang, and You Zhang. 2023b.

</span>
<span class="ltx_bibblock">Chatdoctor: A medical chat model fine-tuned on a large language model meta-ai (llama) using medical domain knowledge.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Cureus</em>, 15(6).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI (2022)</span>
<span class="ltx_bibblock">
OpenAI. 2022.

</span>
<span class="ltx_bibblock">Introducing chatgpt.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openai.com/blog/chatgpt" title="">https://openai.com/blog/chatgpt</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI (2024)</span>
<span class="ltx_bibblock">
OpenAI. 2024.

</span>
<span class="ltx_bibblock">Introducing o1.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openai.com/index/introducing-openai-o1-preview/" title="">https://openai.com/index/introducing-openai-o1-preview/</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Park et al. (2023)</span>
<span class="ltx_bibblock">
Joon Sung Park, Joseph O’Brien, Carrie Jun Cai, Meredith Ringel Morris, Percy Liang, and Michael S Bernstein. 2023.

</span>
<span class="ltx_bibblock">Generative agents: Interactive simulacra of human behavior.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Proceedings of the 36th annual acm symposium on user interface software and technology</em>, pages 1–22.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sawarkar et al. (2024)</span>
<span class="ltx_bibblock">
Kunal Sawarkar, Abhilasha Mangal, and Shivam Raj Solanki. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2404.07220" title="">Blended rag: Improving rag (retriever-augmented generation) accuracy with semantic search and hybrid query-based retrievers</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Preprint</em>, arXiv:2404.07220.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shi (2023)</span>
<span class="ltx_bibblock">
Liu Lin Ju Shi. 2023.

</span>
<span class="ltx_bibblock">Cmlm-zhongjing-2-1-8b: A state-of-the-art edge computing language model for traditional chinese medicine.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/pariskang/CMLM-ZhongJing" title="">https://github.com/pariskang/CMLM-ZhongJing</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang et al. (2024)</span>
<span class="ltx_bibblock">
Xiangru Tang, Anni Zou, Zhuosheng Zhang, Ziming Li, Yilun Zhao, Xingyao Zhang, Arman Cohan, and Mark Gerstein. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2311.10537" title="">Medagents: Large language models as collaborators for zero-shot medical reasoning</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Preprint</em>, arXiv:2311.10537.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2019)</span>
<span class="ltx_bibblock">
Xuewei Wang, Weiyan Shi, Richard Kim, Yoojung Oh, Sijia Yang, Jingwen Zhang, and Zhou Yu. 2019.

</span>
<span class="ltx_bibblock">Persuasion for good: Towards a personalized persuasive dialogue system for social good.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Proceedings of the 57th Annual Meeting of the Association for Computational Linguistics</em>, pages 5635–5649.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al. (2024)</span>
<span class="ltx_bibblock">
Hao Wei, Jianing Qiu, Haibao Yu, and Wu Yuan. 2024.

</span>
<span class="ltx_bibblock">Medco: Medical education copilots based on a multi-agent framework.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">arXiv preprint arXiv:2408.12496</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2023)</span>
<span class="ltx_bibblock">
Qingyun Wu, Gagan Bansal, Jieyu Zhang, Yiran Wu, Shaokun Zhang, Erkang Zhu, Beibin Li, Li Jiang, Xiaoyun Zhang, and Chi Wang. 2023.

</span>
<span class="ltx_bibblock">Autogen: Enabling next-gen llm applications via multi-agent conversation framework.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">arXiv preprint arXiv:2308.08155</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiong et al. (2023)</span>
<span class="ltx_bibblock">
Honglin Xiong, Sheng Wang, Yitao Zhu, Zihao Zhao, Yuxiao Liu, Linlin Huang, Qian Wang, and Dinggang Shen. 2023.

</span>
<span class="ltx_bibblock">Doctorglm: Fine-tuning your chinese doctor is not a herculean task.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">arXiv preprint arXiv:2304.01097</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu (2023)</span>
<span class="ltx_bibblock">
Ming Xu. 2023.

</span>
<span class="ltx_bibblock">Medicalgpt: Training medical gpt model.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/shibing624/MedicalGPT" title="">https://github.com/shibing624/MedicalGPT</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2023a)</span>
<span class="ltx_bibblock">
Aiyuan Yang, Bin Xiao, Bingning Wang, Borong Zhang, Ce Bian, Chao Yin, Chenxu Lv, Da Pan, Dian Wang, Dong Yan, et al. 2023a.

</span>
<span class="ltx_bibblock">Baichuan 2: Open large-scale language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">arXiv preprint arXiv:2309.10305</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2024a)</span>
<span class="ltx_bibblock">
Dingkang Yang, Jinjie Wei, Dongling Xiao, Shunli Wang, Tong Wu, Gang Li, Mingcheng Li, Shuaibing Wang, Jiawei Chen, Yue Jiang, et al. 2024a.

</span>
<span class="ltx_bibblock">Pediatricsgpt: Large language models as chinese medical assistants for pediatric applications.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">arXiv preprint arXiv:2405.19266</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2024b)</span>
<span class="ltx_bibblock">
Dingkang Yang, Dongling Xiao, Jinjie Wei, Mingcheng Li, Zhaoyu Chen, Ke Li, and Lihua Zhang. 2024b.

</span>
<span class="ltx_bibblock">Improving factuality in large language models via decoding-time hallucinatory and truthful comparators.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">arXiv preprint arXiv:2408.12325</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2023b)</span>
<span class="ltx_bibblock">
Songhua Yang, Hanjie Zhao, Senbin Zhu, Guangyu Zhou, Hongfei Xu, Yuxiang Jia, and Hongying Zan. 2023b.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2308.03549" title="">Zhongjing: Enhancing the chinese medical capabilities of large language model through expert feedback and real-world multi-turn dialogue</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Preprint</em>, arXiv:2308.03549.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2023)</span>
<span class="ltx_bibblock">
Hongbo Zhang, Junying Chen, Feng Jiang, Fei Yu, Zhihong Chen, Jianquan Li, Guiming Chen, Xiangbo Wu, Zhiyi Zhang, Qingying Xiao, et al. 2023.

</span>
<span class="ltx_bibblock">Huatuogpt, towards taming language model to be a doctor.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">arXiv preprint arXiv:2305.15075</em>.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Implementation Details</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Query Normalization and Parsing</h3>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.2.1.1">Algorithm 2</span> </span> Syntactic Parsing Algorithm</figcaption>
<div class="ltx_listing ltx_listing" id="alg2.3">
<div class="ltx_listingline" id="alg2.l0">
<span class="ltx_tag ltx_tag_listingline">0:</span>  Input query <math alttext="Q" class="ltx_Math" display="inline" id="alg2.l0.m1.1"><semantics id="alg2.l0.m1.1a"><mi id="alg2.l0.m1.1.1" xref="alg2.l0.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m1.1b"><ci id="alg2.l0.m1.1.1.cmml" xref="alg2.l0.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="alg2.l0.m1.1d">italic_Q</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l0a">
<span class="ltx_tag ltx_tag_listingline">0:</span>  Parsed syntactic tree <math alttext="T" class="ltx_Math" display="inline" id="alg2.l0a.m1.1"><semantics id="alg2.l0a.m1.1a"><mi id="alg2.l0a.m1.1.1" xref="alg2.l0a.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg2.l0a.m1.1b"><ci id="alg2.l0a.m1.1.1.cmml" xref="alg2.l0a.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0a.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="alg2.l0a.m1.1d">italic_T</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l1">  <span class="ltx_text ltx_font_bold" id="alg2.l1.1">Step 1: Tokenize the query</span>
</div>
<div class="ltx_listingline" id="alg2.l2">  Let <math alttext="Q=\{w_{1},w_{2},\dots,w_{n}\}" class="ltx_Math" display="inline" id="alg2.l2.m1.4"><semantics id="alg2.l2.m1.4a"><mrow id="alg2.l2.m1.4.4" xref="alg2.l2.m1.4.4.cmml"><mi id="alg2.l2.m1.4.4.5" xref="alg2.l2.m1.4.4.5.cmml">Q</mi><mo id="alg2.l2.m1.4.4.4" xref="alg2.l2.m1.4.4.4.cmml">=</mo><mrow id="alg2.l2.m1.4.4.3.3" xref="alg2.l2.m1.4.4.3.4.cmml"><mo id="alg2.l2.m1.4.4.3.3.4" stretchy="false" xref="alg2.l2.m1.4.4.3.4.cmml">{</mo><msub id="alg2.l2.m1.2.2.1.1.1" xref="alg2.l2.m1.2.2.1.1.1.cmml"><mi id="alg2.l2.m1.2.2.1.1.1.2" xref="alg2.l2.m1.2.2.1.1.1.2.cmml">w</mi><mn id="alg2.l2.m1.2.2.1.1.1.3" xref="alg2.l2.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="alg2.l2.m1.4.4.3.3.5" xref="alg2.l2.m1.4.4.3.4.cmml">,</mo><msub id="alg2.l2.m1.3.3.2.2.2" xref="alg2.l2.m1.3.3.2.2.2.cmml"><mi id="alg2.l2.m1.3.3.2.2.2.2" xref="alg2.l2.m1.3.3.2.2.2.2.cmml">w</mi><mn id="alg2.l2.m1.3.3.2.2.2.3" xref="alg2.l2.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="alg2.l2.m1.4.4.3.3.6" xref="alg2.l2.m1.4.4.3.4.cmml">,</mo><mi id="alg2.l2.m1.1.1" mathvariant="normal" xref="alg2.l2.m1.1.1.cmml">…</mi><mo id="alg2.l2.m1.4.4.3.3.7" xref="alg2.l2.m1.4.4.3.4.cmml">,</mo><msub id="alg2.l2.m1.4.4.3.3.3" xref="alg2.l2.m1.4.4.3.3.3.cmml"><mi id="alg2.l2.m1.4.4.3.3.3.2" xref="alg2.l2.m1.4.4.3.3.3.2.cmml">w</mi><mi id="alg2.l2.m1.4.4.3.3.3.3" xref="alg2.l2.m1.4.4.3.3.3.3.cmml">n</mi></msub><mo id="alg2.l2.m1.4.4.3.3.8" stretchy="false" xref="alg2.l2.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.4b"><apply id="alg2.l2.m1.4.4.cmml" xref="alg2.l2.m1.4.4"><eq id="alg2.l2.m1.4.4.4.cmml" xref="alg2.l2.m1.4.4.4"></eq><ci id="alg2.l2.m1.4.4.5.cmml" xref="alg2.l2.m1.4.4.5">𝑄</ci><set id="alg2.l2.m1.4.4.3.4.cmml" xref="alg2.l2.m1.4.4.3.3"><apply id="alg2.l2.m1.2.2.1.1.1.cmml" xref="alg2.l2.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.2.2.1.1.1.1.cmml" xref="alg2.l2.m1.2.2.1.1.1">subscript</csymbol><ci id="alg2.l2.m1.2.2.1.1.1.2.cmml" xref="alg2.l2.m1.2.2.1.1.1.2">𝑤</ci><cn id="alg2.l2.m1.2.2.1.1.1.3.cmml" type="integer" xref="alg2.l2.m1.2.2.1.1.1.3">1</cn></apply><apply id="alg2.l2.m1.3.3.2.2.2.cmml" xref="alg2.l2.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg2.l2.m1.3.3.2.2.2.1.cmml" xref="alg2.l2.m1.3.3.2.2.2">subscript</csymbol><ci id="alg2.l2.m1.3.3.2.2.2.2.cmml" xref="alg2.l2.m1.3.3.2.2.2.2">𝑤</ci><cn id="alg2.l2.m1.3.3.2.2.2.3.cmml" type="integer" xref="alg2.l2.m1.3.3.2.2.2.3">2</cn></apply><ci id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1">…</ci><apply id="alg2.l2.m1.4.4.3.3.3.cmml" xref="alg2.l2.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="alg2.l2.m1.4.4.3.3.3.1.cmml" xref="alg2.l2.m1.4.4.3.3.3">subscript</csymbol><ci id="alg2.l2.m1.4.4.3.3.3.2.cmml" xref="alg2.l2.m1.4.4.3.3.3.2">𝑤</ci><ci id="alg2.l2.m1.4.4.3.3.3.3.cmml" xref="alg2.l2.m1.4.4.3.3.3.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.4c">Q=\{w_{1},w_{2},\dots,w_{n}\}</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m1.4d">italic_Q = { italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_w start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_w start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math> be the sequence of words (tokens) in the query.

</div>
<div class="ltx_listingline" id="alg2.l3">  <span class="ltx_text ltx_font_bold" id="alg2.l3.1">Step 2: Initialize parsing</span>
</div>
<div class="ltx_listingline" id="alg2.l4">  Initialize an empty syntactic tree <math alttext="T=\emptyset" class="ltx_Math" display="inline" id="alg2.l4.m1.1"><semantics id="alg2.l4.m1.1a"><mrow id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml"><mi id="alg2.l4.m1.1.1.2" xref="alg2.l4.m1.1.1.2.cmml">T</mi><mo id="alg2.l4.m1.1.1.1" xref="alg2.l4.m1.1.1.1.cmml">=</mo><mi id="alg2.l4.m1.1.1.3" mathvariant="normal" xref="alg2.l4.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><apply id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1"><eq id="alg2.l4.m1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1"></eq><ci id="alg2.l4.m1.1.1.2.cmml" xref="alg2.l4.m1.1.1.2">𝑇</ci><emptyset id="alg2.l4.m1.1.1.3.cmml" xref="alg2.l4.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">T=\emptyset</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.m1.1d">italic_T = ∅</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg2.l5">  <span class="ltx_text ltx_font_bold" id="alg2.l5.1">Step 3: Apply CFG (Context-Free Grammar)</span>
</div>
<div class="ltx_listingline" id="alg2.l6">  <span class="ltx_text ltx_font_bold" id="alg2.l6.1">for</span> each non-terminal symbol <math alttext="A" class="ltx_Math" display="inline" id="alg2.l6.m1.1"><semantics id="alg2.l6.m1.1a"><mi id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><ci id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">A</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m1.1d">italic_A</annotation></semantics></math> in grammar <math alttext="G" class="ltx_Math" display="inline" id="alg2.l6.m2.1"><semantics id="alg2.l6.m2.1a"><mi id="alg2.l6.m2.1.1" xref="alg2.l6.m2.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="alg2.l6.m2.1b"><ci id="alg2.l6.m2.1.1.cmml" xref="alg2.l6.m2.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m2.1c">G</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m2.1d">italic_G</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.l6.2">do</span>
</div>
<div class="ltx_listingline" id="alg2.l7">     Find a rule <math alttext="A\rightarrow\alpha" class="ltx_Math" display="inline" id="alg2.l7.m1.1"><semantics id="alg2.l7.m1.1a"><mrow id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml"><mi id="alg2.l7.m1.1.1.2" xref="alg2.l7.m1.1.1.2.cmml">A</mi><mo id="alg2.l7.m1.1.1.1" stretchy="false" xref="alg2.l7.m1.1.1.1.cmml">→</mo><mi id="alg2.l7.m1.1.1.3" xref="alg2.l7.m1.1.1.3.cmml">α</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><apply id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1"><ci id="alg2.l7.m1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1">→</ci><ci id="alg2.l7.m1.1.1.2.cmml" xref="alg2.l7.m1.1.1.2">𝐴</ci><ci id="alg2.l7.m1.1.1.3.cmml" xref="alg2.l7.m1.1.1.3">𝛼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">A\rightarrow\alpha</annotation><annotation encoding="application/x-llamapun" id="alg2.l7.m1.1d">italic_A → italic_α</annotation></semantics></math>, where <math alttext="\alpha" class="ltx_Math" display="inline" id="alg2.l7.m2.1"><semantics id="alg2.l7.m2.1a"><mi id="alg2.l7.m2.1.1" xref="alg2.l7.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="alg2.l7.m2.1b"><ci id="alg2.l7.m2.1.1.cmml" xref="alg2.l7.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m2.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="alg2.l7.m2.1d">italic_α</annotation></semantics></math> is a string of terminals or non-terminals.

</div>
<div class="ltx_listingline" id="alg2.l8">     <span class="ltx_text ltx_font_bold" id="alg2.l8.1">if</span> <math alttext="A\rightarrow\alpha" class="ltx_Math" display="inline" id="alg2.l8.m1.1"><semantics id="alg2.l8.m1.1a"><mrow id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml"><mi id="alg2.l8.m1.1.1.2" xref="alg2.l8.m1.1.1.2.cmml">A</mi><mo id="alg2.l8.m1.1.1.1" stretchy="false" xref="alg2.l8.m1.1.1.1.cmml">→</mo><mi id="alg2.l8.m1.1.1.3" xref="alg2.l8.m1.1.1.3.cmml">α</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b"><apply id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1"><ci id="alg2.l8.m1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1">→</ci><ci id="alg2.l8.m1.1.1.2.cmml" xref="alg2.l8.m1.1.1.2">𝐴</ci><ci id="alg2.l8.m1.1.1.3.cmml" xref="alg2.l8.m1.1.1.3">𝛼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.1c">A\rightarrow\alpha</annotation><annotation encoding="application/x-llamapun" id="alg2.l8.m1.1d">italic_A → italic_α</annotation></semantics></math> matches a substring of <math alttext="Q" class="ltx_Math" display="inline" id="alg2.l8.m2.1"><semantics id="alg2.l8.m2.1a"><mi id="alg2.l8.m2.1.1" xref="alg2.l8.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="alg2.l8.m2.1b"><ci id="alg2.l8.m2.1.1.cmml" xref="alg2.l8.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m2.1c">Q</annotation><annotation encoding="application/x-llamapun" id="alg2.l8.m2.1d">italic_Q</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.l8.2">then</span>
</div>
<div class="ltx_listingline" id="alg2.l9">        Add this production rule to the tree <math alttext="T" class="ltx_Math" display="inline" id="alg2.l9.m1.1"><semantics id="alg2.l9.m1.1a"><mi id="alg2.l9.m1.1.1" xref="alg2.l9.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.1b"><ci id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="alg2.l9.m1.1d">italic_T</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg2.l10">        Replace the matched string with non-terminal <math alttext="A" class="ltx_Math" display="inline" id="alg2.l10.m1.1"><semantics id="alg2.l10.m1.1a"><mi id="alg2.l10.m1.1.1" xref="alg2.l10.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.1b"><ci id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.1c">A</annotation><annotation encoding="application/x-llamapun" id="alg2.l10.m1.1d">italic_A</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg2.l11">     <span class="ltx_text ltx_font_bold" id="alg2.l11.1">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l11.2">if</span>
</div>
<div class="ltx_listingline" id="alg2.l12">  <span class="ltx_text ltx_font_bold" id="alg2.l12.1">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l12.2">for</span>
</div>
<div class="ltx_listingline" id="alg2.l13">  <span class="ltx_text ltx_font_bold" id="alg2.l13.1">Step 4: Recursion</span>
</div>
<div class="ltx_listingline" id="alg2.l14">  <span class="ltx_text ltx_font_bold" id="alg2.l14.1">while</span> there are still non-terminals to be parsed <span class="ltx_text ltx_font_bold" id="alg2.l14.2">do</span>
</div>
<div class="ltx_listingline" id="alg2.l15">     Repeat step 3 until <math alttext="T" class="ltx_Math" display="inline" id="alg2.l15.m1.1"><semantics id="alg2.l15.m1.1a"><mi id="alg2.l15.m1.1.1" xref="alg2.l15.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.1b"><ci id="alg2.l15.m1.1.1.cmml" xref="alg2.l15.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="alg2.l15.m1.1d">italic_T</annotation></semantics></math> covers the entire query <math alttext="Q" class="ltx_Math" display="inline" id="alg2.l15.m2.1"><semantics id="alg2.l15.m2.1a"><mi id="alg2.l15.m2.1.1" xref="alg2.l15.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="alg2.l15.m2.1b"><ci id="alg2.l15.m2.1.1.cmml" xref="alg2.l15.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m2.1c">Q</annotation><annotation encoding="application/x-llamapun" id="alg2.l15.m2.1d">italic_Q</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg2.l16">  <span class="ltx_text ltx_font_bold" id="alg2.l16.1">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l16.2">while</span>
</div>
<div class="ltx_listingline" id="alg2.l17">  <span class="ltx_text ltx_font_bold" id="alg2.l17.1">Step 5: Output the syntactic tree</span>
</div>
<div class="ltx_listingline" id="alg2.l18">  <span class="ltx_text ltx_font_bold" id="alg2.l18.1">return</span>  <math alttext="T" class="ltx_Math" display="inline" id="alg2.l18.m1.1"><semantics id="alg2.l18.m1.1a"><mi id="alg2.l18.m1.1.1" xref="alg2.l18.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg2.l18.m1.1b"><ci id="alg2.l18.m1.1.1.cmml" xref="alg2.l18.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l18.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="alg2.l18.m1.1d">italic_T</annotation></semantics></math>
</div>
</div>
</figure>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#alg2" title="Algorithm 2 ‣ A.1 Query Normalization and Parsing ‣ Appendix A Implementation Details ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">2</span></a> first disambiguates the input query and divides the query into individual words or tokens. Next, the algorithm initializes an empty syntax tree and matches substrings in the query by Context-Free Grammar (CFG) rules, adding the conforming rules to the syntax tree. The algorithm keeps applying the rules recursively until the syntax tree covers the entire query and finally outputs the complete syntax tree.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Refined Query Construction</h3>
<div class="ltx_para" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1">In the refined query constructor, we implement a set of rules (as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#A1.F5" title="Figure 5 ‣ A.2 Refined Query Construction ‣ Appendix A Implementation Details ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">5</span></a>) to ensure that the generated subqueries are of high quality both semantically and formally. These rules encompass subquery filtering, semantic overlap removal, query consolidation, grammatical normalization, intent prioritization, and format standardization. Together, these processes streamline the output, optimize the query structure, and prioritize critical medical intents, ensuring the final query is both semantically coherent and structurally consistent.</p>
</div>
<figure class="ltx_figure" id="A1.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="291" id="A1.F5.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Illustration of the rule sets.
</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Training Details of BioBert Encoder</h3>
<div class="ltx_para" id="A1.SS3.p1">
<p class="ltx_p" id="A1.SS3.p1.1">For the medical intent classification, we use the BioBERT-based contextual encoder from the HuggingFace library<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">*</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">*</sup><span class="ltx_tag ltx_tag_note">*</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/dmis-lab/biobert-v1.1" title="">https://huggingface.co/dmis-lab/biobert-v1.1</a></span></span></span>. to map the input sentences to a 768-dimensional embedding space. For each intent classification task, we add a fully connected layer after the embedding layer with an output dimension of 17 and generate probability distributions corresponding to the 17 intents via a softmax activation function. To handle these tasks, we deploy four V100 32GB GPUs to provide sufficient computational resources and graphics memory. The Adam optimizer is used in the training process with an initial learning rate of 2e-5, a batch size of 32, and 5 training rounds, and a learning rate scheduling strategy is applied in the validation set for dynamic adjustment. The loss function is the cross-entropy loss function. We evaluate the model by accuracy, precision, recall, and F1 score to ensure the performance of the model on the validation set.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Prompt Templates</h2>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">This section provides an overview of the structured prompt templates employed across four distinct agents within our framework. Each prompt is designed to guide the language model in generating contextually relevant and accurate responses tailored to specific medical tasks. These templates are instrumental in ensuring that the interactions between the agents and users are effective and medically informative. Additionally, the prompt templates for the various components of the query rewriting phase are detailed in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#A2.F6" title="Figure 6 ‣ Appendix B Prompt Templates ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">6</span></a>. The specifics for each agent’s prompt templates are depicted in
Figures <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#A2.F7" title="Figure 7 ‣ Appendix B Prompt Templates ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">7</span></a>,  <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#A2.F8" title="Figure 8 ‣ Appendix B Prompt Templates ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">8</span></a>,  <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#A2.F9" title="Figure 9 ‣ Appendix B Prompt Templates ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">9</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2410.12532v2#A2.F10" title="Figure 10 ‣ Appendix B Prompt Templates ‣ MedAide: Towards an Omni Medical Aide via Specialized LLM-based Multi-Agent Collaboration"><span class="ltx_text ltx_ref_tag">10</span></a>.</p>
</div>
<figure class="ltx_figure" id="A2.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="467" id="A2.F6.g1" src="x6.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Illustration of the prompt template for the query rewriting.
</figcaption>
</figure>
<figure class="ltx_figure" id="A2.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="302" id="A2.F7.g1" src="x7.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Illustration of the prompt template for the Pre-Diagnosis.
</figcaption>
</figure>
<figure class="ltx_figure" id="A2.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="453" id="A2.F8.g1" src="x8.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Illustration of the prompt template for the Diagnosis.
</figcaption>
</figure>
<figure class="ltx_figure" id="A2.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="367" id="A2.F9.g1" src="x9.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Illustration of the prompt template for the Medicament.
</figcaption>
</figure>
<figure class="ltx_figure" id="A2.F10"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="315" id="A2.F10.g1" src="x10.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Illustration of the prompt template for the Post-Diagnosis.
</figcaption>
</figure>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Oct 17 09:18:09 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
