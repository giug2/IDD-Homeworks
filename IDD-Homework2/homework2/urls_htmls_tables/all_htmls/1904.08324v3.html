<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1904.08324] Question Guided Modular Routing Networks for Visual Question Answering</title><meta property="og:description" content="This paper studies the task of Visual Question Answering (VQA), which is topical in Multimedia community recently. Particularly, we explore two critical research problems existed in VQA: (1) efficiently fusing the visu…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Question Guided Modular Routing Networks for Visual Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Question Guided Modular Routing Networks for Visual Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1904.08324">

<!--Generated on Sat Mar  2 17:47:47 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Question Guided Modular Routing Networks for Visual Question Answering</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yanze Wu<sup id="id1.1.id1" class="ltx_sup">1</sup>,
Qiang Sun<sup id="id2.2.id2" class="ltx_sup">1</sup>,
Jianqi Ma<sup id="id3.3.id3" class="ltx_sup">1</sup>,
Bin Li<sup id="id4.4.id4" class="ltx_sup">1</sup>,
Yanwei Fu<sup id="id5.5.id5" class="ltx_sup">1</sup>,
Yao Peng<sup id="id6.6.id6" class="ltx_sup">2</sup>,
Xiangyang Xue<sup id="id7.7.id7" class="ltx_sup">1</sup>
<br class="ltx_break"><sup id="id8.8.id8" class="ltx_sup">1</sup>Fudan University,
<sup id="id9.9.id9" class="ltx_sup">2</sup>Qiniu Inc
<br class="ltx_break">{wuyanze123,sunqiang85}@gmail.com, {majq16,libin,yanweifu}@fudan.edu.cn, pengyao@qiniu.com, xyxue@fudan.edu.cn
<br class="ltx_break">
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id10.id1" class="ltx_p">This paper studies the task of Visual Question Answering (VQA), which is topical in Multimedia community recently. Particularly, we explore two critical research problems existed in VQA: (1) efficiently fusing the visual and textual modalities; (2) enabling the visual reasoning ability of VQA models in answering complex questions.
To address these challenging problems, a novel Question Guided Modular Routing Networks (QGMRN) has been proposed in this paper. Particularly,
The QGMRN is composed of visual, textual and routing network.
The visual and textual network serve as the backbones for the generic feature extractors of visual and textual modalities. QGMRN can fuse the visual and textual modalities at multiple semantic levels.
Typically, the visual reasoning is facilitated by the routing network in a discrete and stochastic way by using Gumbel-Softmax trick for module selection.
When the input reaches a certain modular layer, routing network newly proposed in this paper, dynamically selects a portion of modules from that layer to process the input depending on the question features generated by the textual network.
It can also learn to reason by routing between the generic modules without additional supervision information or expert knowledge. Benefiting from the dynamic routing mechanism, QGMRN can outperform the previous classical VQA methods by a large margin and achieve the competitive results against the state-of-the-art methods. Furthermore, attention mechanism is integrated into our QGMRN model and thus can further boost the model performance. Empirically, extensive experiments on the CLEVR and CLEVR-Humans datasets validate the effectiveness of our proposed model, and the state-of-the-art performance has been achieved.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Visual Question Answering (VQA) (<span id="S1.p1.1.1" class="ltx_text ltx_font_bold">?</span>) is a task that,
given an image and question pair, the model can reason and answer the question by visual information. It is a popular topic in recent years
that has connected the computer vision and natural language processing
(NLP). VQA faces two major challenges: 1) How to better
fuse the visual and textual modalities; 2) How to make the VQA model have the reasoning ability to answer more complex questions.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">For challenge (1), in order to fuse the visual and textual modalities, the most common
VQA paradigm is to first extract the visual features from a modern CNN (<span id="S1.p2.1.1" class="ltx_text ltx_font_italic">e.g.,</span> VGG (<span id="S1.p2.1.2" class="ltx_text ltx_font_bold">?</span>) or ResNet (<span id="S1.p2.1.3" class="ltx_text ltx_font_bold">?</span>)) and textual features from a RNN (<span id="S1.p2.1.4" class="ltx_text ltx_font_italic">e.g.,</span> LSTM (<span id="S1.p2.1.5" class="ltx_text ltx_font_bold">?</span>)
or GRU (<span id="S1.p2.1.6" class="ltx_text ltx_font_bold">?</span>)) separately, and then fuse them into a common
latent space (<span id="S1.p2.1.7" class="ltx_text ltx_font_bold">?</span>; <span id="S1.p2.1.8" class="ltx_text ltx_font_bold">?</span>; <span id="S1.p2.1.9" class="ltx_text ltx_font_bold">?</span>; <span id="S1.p2.1.10" class="ltx_text ltx_font_bold">?</span>; <span id="S1.p2.1.11" class="ltx_text ltx_font_bold">?</span>).
Feature fusion is explored from simple
concatenation operation (<span id="S1.p2.1.12" class="ltx_text ltx_font_bold">?</span>) to advanced joint embedding
techniques, such as MLB (<span id="S1.p2.1.13" class="ltx_text ltx_font_bold">?</span>), MCB (<span id="S1.p2.1.14" class="ltx_text ltx_font_bold">?</span>)
and MUTAN (<span id="S1.p2.1.15" class="ltx_text ltx_font_bold">?</span>), and attention mechanisms such as one-hop attention (<span id="S1.p2.1.16" class="ltx_text ltx_font_bold">?</span>), multi-hop attention (<span id="S1.p2.1.17" class="ltx_text ltx_font_bold">?</span>) and bottom-up attention (<span id="S1.p2.1.18" class="ltx_text ltx_font_bold">?</span>).
However, no matter how powerful these fusion methods are,
they can only fuse two modalities at a high semantic level, rather than multiple semantic levels, because the fused features (<span id="S1.p2.1.19" class="ltx_text ltx_font_italic">i.e.,</span> the extracted visual and textual features) are at a high semantic level.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">For challenge (2), to endow the VQA model with reasoning ability is difficult because although CNN (<span id="S1.p3.1.1" class="ltx_text ltx_font_italic">e.g.,</span> ResNet) is very powerful, it does not support reasoning natively.
To make the VQA model support reasoning, one important line of work (<span id="S1.p3.1.2" class="ltx_text ltx_font_bold">?</span>; <span id="S1.p3.1.3" class="ltx_text ltx_font_bold">?</span>; <span id="S1.p3.1.4" class="ltx_text ltx_font_bold">?</span>; <span id="S1.p3.1.5" class="ltx_text ltx_font_bold">?</span>; <span id="S1.p3.1.6" class="ltx_text ltx_font_bold">?</span>) builds upon the modular networks. By leveraging the compositional structure of neural language questions, these methods
first decompose the question into modular subquestions,
then pick out the modular networks that are designed for solving these subquestions,
and finally answer the question by executing these modular networks on the image according to the layout learned from the question.
These explicit methods have strong interpretability as the layout learned from the question reflects the answering and reasoning process. However, analyzing the subquestion set and designing corresponding modules need expert knowledge, most of these methods even require extra supervision information during their training process.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this paper, we show that even without expert knowledge and extra supervision information,
we can still make the model support visual reasoning. Specifically, we propose a novel model called Question Guided Modular Routing Networks (QGMRN) that consists of three sub-networks: <span id="S1.p4.1.1" class="ltx_text ltx_font_italic">visual network</span>, <span id="S1.p4.1.2" class="ltx_text ltx_font_italic">textual network</span> and <span id="S1.p4.1.3" class="ltx_text ltx_font_italic">routing network</span>. The visual network is based on a generic modular network that each layer of the network is composed of some generic modules, as the module granularity changes, different modular networks can be spawned. When the input reaches a certain layer, the visual network dynamically selects a portion of modules from that layer to process the input according to the binary gates generated by the routing network. We name the collection of all binary gates as a routing path.
Therefore, the routing network is responsible for receiving the question features generated by the textual network and mapping them to a discrete routing path. To encourage the model to explore more possible routing paths, the model generates the routing path in a discrete and stochastic way by adopting Gumbel-Softmax tricks. We claim that our proposed method can address both two before-mentioned challenges to some extent. First, the visual and textual modalities can be fully fused at multiple semantic levels because the routing network controls every layer of the visual network. Second, the routing mechanism makes the model have the ability for visual reasoning by executing different portion of modules. Especially we claim that the routing path represents the process of compositional reasoning and acts similar to the aforementioned module layout.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">To sum up, the contributions of this paper can be summarized as: (1) We for the first time successfully extend the line of work on routing models to the domain of VQA and multi-modal embedding, and the results are promising. (2) Our model can fuse the visual and textual modalities at multiple semantic levels, and is equipped with good reasoning ability. (3) Current modular network based VQA methods have great interpretability, but they also have the disadvantages of requiring expert knowledge or extra supervision information. Without having those disadvantages, we combine the routing mechanism with the modular network to obtain the modular routing network. The novel modular routing network can be applied to many off-the-shelf CNN models. (4) The proposed model has achieved state-of-the-art performances on the challenging CLEVR (<span id="S1.p5.1.1" class="ltx_text ltx_font_bold">?</span>) and CLEVR-Humans (<span id="S1.p5.1.2" class="ltx_text ltx_font_bold">?</span>) datasets.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Fusion Strategy of VQA</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Usually, the first step of most VQA methods is to extract high-level visual features from a modern CNN and textual features from an RNN separately. In order to combine the visual and textual modalities to produce the answer, many methods have been proposed to fuse the extracted visual and textual features.
Multimodal Low-rank Bilinear pooling (MLB) (<span id="S2.SS1.p1.1.1" class="ltx_text ltx_font_bold">?</span>) provides an efficient method to approximate the full bilinear pooling by forcing the weight matrix to be low-rank. Multimodal Compact Bilinear pooling (MCB) (<span id="S2.SS1.p1.1.2" class="ltx_text ltx_font_bold">?</span>) randomly projects the visual and textual features into a higher dimensional space, then processes them in Fast Fourier Transform space. Multimodal Tucker Fusion (MUTAN) (<span id="S2.SS1.p1.1.3" class="ltx_text ltx_font_bold">?</span>) proposes a general fusion method based on Tucker decomposition, which covers MLB and MCB.
Yang <em id="S2.SS1.p1.1.4" class="ltx_emph ltx_font_italic">et al.</em> (<span id="S2.SS1.p1.1.5" class="ltx_text ltx_font_bold">?</span>) propose a multi-hop spatial attention to fuse the visual and textual features so that the image regions related to the question will be focused. Anderson <em id="S2.SS1.p1.1.6" class="ltx_emph ltx_font_italic">et al.</em> (<span id="S2.SS1.p1.1.7" class="ltx_text ltx_font_bold">?</span>) propose a bottom-up model that combines the attention mechanism with object-level visual features, so that objects related to the question will be focused.
However, with only the high-level multi-modal features fused, these fusion methods do not fully utilized the multi-level interactions between two modalities.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">Another line of work proposes to fuse two modalities by using the question to predict the parameters of the visual network. Due to the large number of parameters in the visual network, only a small portion of parameters can be learned from the question feature. For example, Gao <em id="S2.SS1.p2.1.1" class="ltx_emph ltx_font_italic">et al.</em> (<span id="S2.SS1.p2.1.2" class="ltx_text ltx_font_bold">?</span>) propose the Question-guided Hybrid Convolution (QGHC) based on group convolution, which consists of question-dependent kernels and question-independent kernels; the parameters of batch-norm (<span id="S2.SS1.p2.1.3" class="ltx_text ltx_font_bold">?</span>) layers in MODERN (<span id="S2.SS1.p2.1.4" class="ltx_text ltx_font_bold">?</span>) are predicted by the question; FiLM (<span id="S2.SS1.p2.1.5" class="ltx_text ltx_font_bold">?</span>) implements the condition through a general feature-wise transformation. Although this kind of methods can fuse the visual and textual modalities in a multi-level and fine-grained way, these methods still have limitations. If too many parameters are learned from the question, that will make the model difficult to train, but if only a few parameters are learned from the question, that will constrain the model’s learning capacity. Another concern is about the flexibility. In particular, QGHC can only be applied in the ResNext (<span id="S2.SS1.p2.1.6" class="ltx_text ltx_font_bold">?</span>) architecture, MODERN can only be applied in CNN with the batch-norm layers.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.1" class="ltx_p">Our proposed model can fuse the two modalities at multiple semantic levels, and more importantly, our model is very flexible. When we adjust the granularity of the module to filter level, MODERN and FiLM are related to our model, yet with fundamental differences. First, they modulate the visual network at a feature level, but we modulate the visual network at a module level. Second, we route the modules in a discrete and stochastic way, which means that our approach can explore more routing paths and is a step towards discrete reasoning.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Visual Reasoning in VQA</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Judging whether a VQA model has reasoning ability is usually based on whether the model can well solve the CLEVR dataset, since the questions in CLEVR dataset are quite complicated that require reasoning to answer. There have been several prominent models that well solve the CLEVR dataset. Except for RN (<span id="S2.SS2.p1.1.1" class="ltx_text ltx_font_bold">?</span>) that supports reasoning explicitly by utilizing pairwise comparisons, most methods are based on the idea of compositional reasoning, implicitly (<span id="S2.SS2.p1.1.2" class="ltx_text ltx_font_bold">?</span>; <span id="S2.SS2.p1.1.3" class="ltx_text ltx_font_bold">?</span>) or explicitly (<span id="S2.SS2.p1.1.4" class="ltx_text ltx_font_bold">?</span>; <span id="S2.SS2.p1.1.5" class="ltx_text ltx_font_bold">?</span>; <span id="S2.SS2.p1.1.6" class="ltx_text ltx_font_bold">?</span>; <span id="S2.SS2.p1.1.7" class="ltx_text ltx_font_bold">?</span>; <span id="S2.SS2.p1.1.8" class="ltx_text ltx_font_bold">?</span>). The representative method of explicit compositional reasoning is Neural Module Networks (NMN) (<span id="S2.SS2.p1.1.9" class="ltx_text ltx_font_bold">?</span>) which is dynamically instantiated from a collection of reusable modules based on the compositional structure of the question. Although the function of each module is learned from training, the question parser and the mapping rules from the parsing tree node to the module must be pre-defined. The performance of the NMN model heavily relies on the quality of the question parser chosen. Further, Hu <em id="S2.SS2.p1.1.10" class="ltx_emph ltx_font_italic">et al.</em> (<span id="S2.SS2.p1.1.11" class="ltx_text ltx_font_bold">?</span>) proposes an End-to-End Module Network which predicts the module layout by an LSTM instead of an external question parser. Johnson <em id="S2.SS2.p1.1.12" class="ltx_emph ltx_font_italic">et al.</em> (<span id="S2.SS2.p1.1.13" class="ltx_text ltx_font_bold">?</span>) proposes a model combining with both program generator and execute engine based on neural module network. TbD-net (<span id="S2.SS2.p1.1.14" class="ltx_text ltx_font_bold">?</span>) combines neural modules and attention mechanism to achieve state-of-the-art accuracy on the CLEVR dataset. Different from above methods, NS-CL (<span id="S2.SS2.p1.1.15" class="ltx_text ltx_font_bold">?</span>) can achieve state-of-the-art performance even without extra supervision information.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">Although the NMN family has good interpretability, they usually require expert knowledge for designing the model and extra supervision information for training. Our method shares the concept of the module with the NMN family, however, the modules from our method are not dedicated-designed and no extra supervision information is required for training, we also combine the modular network with the routing mechanism.
Compared with the explicit reasoning models like FiLM (<span id="S2.SS2.p2.1.1" class="ltx_text ltx_font_bold">?</span>) and MAC (<span id="S2.SS2.p2.1.2" class="ltx_text ltx_font_bold">?</span>), our method uses a completely different routing mechanism to support reasoning.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Routing Models</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">The proposed modular routing network is related to conditional computation (CC) (<span id="S2.SS3.p1.1.1" class="ltx_text ltx_font_bold">?</span>; <span id="S2.SS3.p1.1.2" class="ltx_text ltx_font_bold">?</span>) and mixture-of-experts (MoE) (<span id="S2.SS3.p1.1.3" class="ltx_text ltx_font_bold">?</span>; <span id="S2.SS3.p1.1.4" class="ltx_text ltx_font_bold">?</span>; <span id="S2.SS3.p1.1.5" class="ltx_text ltx_font_bold">?</span>; <span id="S2.SS3.p1.1.6" class="ltx_text ltx_font_bold">?</span>). CC refers to the dynamic execution of a part of the model based on the input. Bengio <em id="S2.SS3.p1.1.7" class="ltx_emph ltx_font_italic">et al.</em> (<span id="S2.SS3.p1.1.8" class="ltx_text ltx_font_bold">?</span>) first propose the concept of CC and introduce four approaches to propagate gradients through stochastic neurons to support CC. Bengio <em id="S2.SS3.p1.1.9" class="ltx_emph ltx_font_italic">et al.</em> (<span id="S2.SS3.p1.1.10" class="ltx_text ltx_font_bold">?</span>) propose by using reinforcement learning as a tool to optimize CC, they also propose a regularization mechanism to encourage sparsity and diversity. MoE related research can be traced back to the 1990s (<span id="S2.SS3.p1.1.11" class="ltx_text ltx_font_bold">?</span>; <span id="S2.SS3.p1.1.12" class="ltx_text ltx_font_bold">?</span>), and usually, an expert is a whole model. Eigen <em id="S2.SS3.p1.1.13" class="ltx_emph ltx_font_italic">et al.</em> (<span id="S2.SS3.p1.1.14" class="ltx_text ltx_font_bold">?</span>) propose a deep learning model that is made up of two MoEs, Shazeer <em id="S2.SS3.p1.1.15" class="ltx_emph ltx_font_italic">et al.</em> (<span id="S2.SS3.p1.1.16" class="ltx_text ltx_font_bold">?</span>) introduce the sparsely-gated MoE by using a noisy gating method.
Kirsch <em id="S2.SS3.p1.1.17" class="ltx_emph ltx_font_italic">et al.</em> (<span id="S2.SS3.p1.1.18" class="ltx_text ltx_font_bold">?</span>) use generalized Viterbi EM to enable training without artificial regularization.
Routing model is equivalent to doing CC on MoE. Researchers have tried to apply routing models to multi-task learning (<span id="S2.SS3.p1.1.19" class="ltx_text ltx_font_bold">?</span>) and classification problems (<span id="S2.SS3.p1.1.20" class="ltx_text ltx_font_bold">?</span>; <span id="S2.SS3.p1.1.21" class="ltx_text ltx_font_bold">?</span>). However, these methods are either adopting small-scale models, experimenting on toy-dataset, or achieving little improvement on the basis of static models.</p>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<p id="S2.SS3.p2.1" class="ltx_p">As Ramachandran <em id="S2.SS3.p2.1.1" class="ltx_emph ltx_font_italic">et al.</em> said in their paper (<span id="S2.SS3.p2.1.2" class="ltx_text ltx_font_bold">?</span>), although routing models are a promising direction of research, there must be successful applications of routing models where static models struggle. In this paper, we find that VQA (especially those who need strong reasoning ability) is one of the successful applications, the static models (<span id="S2.SS3.p2.1.3" class="ltx_text ltx_font_italic">i.e.,</span> standard VQA methods) perform poorly on the VQA datasets that require reasoning, but the routing models outperform them by a large margin.</p>
</div>
<figure id="S2.F1" class="ltx_figure"><img src="/html/1904.08324/assets/x1.png" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="538" height="170" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Architecture of the proposed model. The model consists three sub-networks: a) Visual Network: a composite of <math id="S2.F1.3.m1.1" class="ltx_Math" alttext="L\times M" display="inline"><semantics id="S2.F1.3.m1.1b"><mrow id="S2.F1.3.m1.1.1" xref="S2.F1.3.m1.1.1.cmml"><mi id="S2.F1.3.m1.1.1.2" xref="S2.F1.3.m1.1.1.2.cmml">L</mi><mo lspace="0.222em" rspace="0.222em" id="S2.F1.3.m1.1.1.1" xref="S2.F1.3.m1.1.1.1.cmml">×</mo><mi id="S2.F1.3.m1.1.1.3" xref="S2.F1.3.m1.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.F1.3.m1.1c"><apply id="S2.F1.3.m1.1.1.cmml" xref="S2.F1.3.m1.1.1"><times id="S2.F1.3.m1.1.1.1.cmml" xref="S2.F1.3.m1.1.1.1"></times><ci id="S2.F1.3.m1.1.1.2.cmml" xref="S2.F1.3.m1.1.1.2">𝐿</ci><ci id="S2.F1.3.m1.1.1.3.cmml" xref="S2.F1.3.m1.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.3.m1.1d">L\times M</annotation></semantics></math> modules which are represented as <math id="S2.F1.4.m2.1" class="ltx_math_unparsed" alttext="f_{1..L,1..M}" display="inline"><semantics id="S2.F1.4.m2.1b"><msub id="S2.F1.4.m2.1.2"><mi id="S2.F1.4.m2.1.2.2">f</mi><mrow id="S2.F1.4.m2.1.1.1"><mn id="S2.F1.4.m2.1.1.1.1">1</mn><mo lspace="0em" rspace="0.0835em" id="S2.F1.4.m2.1.1.1.2">.</mo><mo lspace="0.0835em" rspace="0.167em" id="S2.F1.4.m2.1.1.1.3">.</mo><mi id="S2.F1.4.m2.1.1.1.4">L</mi><mo id="S2.F1.4.m2.1.1.1.5">,</mo><mn id="S2.F1.4.m2.1.1.1.6">1</mn><mo lspace="0em" rspace="0.0835em" id="S2.F1.4.m2.1.1.1.7">.</mo><mo lspace="0.0835em" rspace="0.167em" id="S2.F1.4.m2.1.1.1.8">.</mo><mi id="S2.F1.4.m2.1.1.1.9">M</mi></mrow></msub><annotation encoding="application/x-tex" id="S2.F1.4.m2.1c">f_{1..L,1..M}</annotation></semantics></math>, we can see that each module is followed by a “switch” which is controlled by the Routing Network, we call the states of the “switches” as a routing path. b) Textual Network: a GRU which takes a question and generates question features. c) Routing Network: which takes the question features sent from the textual network to generate a routing path.</figcaption>
</figure>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>METHODOLOGY</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">Our model contains three sub-networks, namely the <span id="S3.p1.1.1" class="ltx_text ltx_font_italic">visual network</span>, <span id="S3.p1.1.2" class="ltx_text ltx_font_italic">textual network</span> and <span id="S3.p1.1.3" class="ltx_text ltx_font_italic">routing network</span> as shown in Figure <a href="#S2.F1" title="Figure 1 ‣ 2.3 Routing Models ‣ 2 Related Work ‣ Question Guided Modular Routing Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
The textual network takes a question and generates question features;
the routing network converts the question features to a specific routing path;
the visual network takes the raw image and dynamically executes modules according to the routing path.
Finally, the extracted image features are sent to the classifier to predict the answer.
The whole model is differentiable with respect to the model parameters and can be trained end-to-end.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Textual Network</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.9" class="ltx_p">Given the question <math id="S3.SS1.p1.1.m1.4" class="ltx_Math" alttext="\mathbf{Q}=[\mathbf{w}_{1},\mathbf{w}_{2},\cdots,\mathbf{w}_{n}]" display="inline"><semantics id="S3.SS1.p1.1.m1.4a"><mrow id="S3.SS1.p1.1.m1.4.4" xref="S3.SS1.p1.1.m1.4.4.cmml"><mi id="S3.SS1.p1.1.m1.4.4.5" xref="S3.SS1.p1.1.m1.4.4.5.cmml">𝐐</mi><mo id="S3.SS1.p1.1.m1.4.4.4" xref="S3.SS1.p1.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS1.p1.1.m1.4.4.3.3" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS1.p1.1.m1.4.4.3.3.4" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">[</mo><msub id="S3.SS1.p1.1.m1.2.2.1.1.1" xref="S3.SS1.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.2.2.1.1.1.2" xref="S3.SS1.p1.1.m1.2.2.1.1.1.2.cmml">𝐰</mi><mn id="S3.SS1.p1.1.m1.2.2.1.1.1.3" xref="S3.SS1.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.1.m1.4.4.3.3.5" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.1.m1.3.3.2.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.1.m1.3.3.2.2.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2.cmml">𝐰</mi><mn id="S3.SS1.p1.1.m1.3.3.2.2.2.3" xref="S3.SS1.p1.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.1.m1.4.4.3.3.6" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">⋯</mi><mo id="S3.SS1.p1.1.m1.4.4.3.3.7" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.1.m1.4.4.3.3.3" xref="S3.SS1.p1.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS1.p1.1.m1.4.4.3.3.3.2" xref="S3.SS1.p1.1.m1.4.4.3.3.3.2.cmml">𝐰</mi><mi id="S3.SS1.p1.1.m1.4.4.3.3.3.3" xref="S3.SS1.p1.1.m1.4.4.3.3.3.3.cmml">n</mi></msub><mo stretchy="false" id="S3.SS1.p1.1.m1.4.4.3.3.8" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.4b"><apply id="S3.SS1.p1.1.m1.4.4.cmml" xref="S3.SS1.p1.1.m1.4.4"><eq id="S3.SS1.p1.1.m1.4.4.4.cmml" xref="S3.SS1.p1.1.m1.4.4.4"></eq><ci id="S3.SS1.p1.1.m1.4.4.5.cmml" xref="S3.SS1.p1.1.m1.4.4.5">𝐐</ci><list id="S3.SS1.p1.1.m1.4.4.3.4.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3"><apply id="S3.SS1.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1.2">𝐰</ci><cn type="integer" id="S3.SS1.p1.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2">𝐰</ci><cn type="integer" id="S3.SS1.p1.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">⋯</ci><apply id="S3.SS1.p1.1.m1.4.4.3.3.3.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3.3.2">𝐰</ci><ci id="S3.SS1.p1.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3.3.3">𝑛</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.4c">\mathbf{Q}=[\mathbf{w}_{1},\mathbf{w}_{2},\cdots,\mathbf{w}_{n}]</annotation></semantics></math> where <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{w}_{i}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">𝐰</mi><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝐰</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\mathbf{w}_{i}</annotation></semantics></math> is the one-hot representation of <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">i</annotation></semantics></math>th word and <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">n</annotation></semantics></math> is the length of the question, we first use a lookup layer to embed <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="\mathbf{Q}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\mathbf{Q}</annotation></semantics></math> into <math id="S3.SS1.p1.6.m6.4" class="ltx_Math" alttext="\mathbf{E}_{q}=[\mathbf{e}_{1},\mathbf{e}_{2},\cdots,\mathbf{e}_{n}]" display="inline"><semantics id="S3.SS1.p1.6.m6.4a"><mrow id="S3.SS1.p1.6.m6.4.4" xref="S3.SS1.p1.6.m6.4.4.cmml"><msub id="S3.SS1.p1.6.m6.4.4.5" xref="S3.SS1.p1.6.m6.4.4.5.cmml"><mi id="S3.SS1.p1.6.m6.4.4.5.2" xref="S3.SS1.p1.6.m6.4.4.5.2.cmml">𝐄</mi><mi id="S3.SS1.p1.6.m6.4.4.5.3" xref="S3.SS1.p1.6.m6.4.4.5.3.cmml">q</mi></msub><mo id="S3.SS1.p1.6.m6.4.4.4" xref="S3.SS1.p1.6.m6.4.4.4.cmml">=</mo><mrow id="S3.SS1.p1.6.m6.4.4.3.3" xref="S3.SS1.p1.6.m6.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS1.p1.6.m6.4.4.3.3.4" xref="S3.SS1.p1.6.m6.4.4.3.4.cmml">[</mo><msub id="S3.SS1.p1.6.m6.2.2.1.1.1" xref="S3.SS1.p1.6.m6.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.6.m6.2.2.1.1.1.2" xref="S3.SS1.p1.6.m6.2.2.1.1.1.2.cmml">𝐞</mi><mn id="S3.SS1.p1.6.m6.2.2.1.1.1.3" xref="S3.SS1.p1.6.m6.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.6.m6.4.4.3.3.5" xref="S3.SS1.p1.6.m6.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.6.m6.3.3.2.2.2" xref="S3.SS1.p1.6.m6.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.6.m6.3.3.2.2.2.2" xref="S3.SS1.p1.6.m6.3.3.2.2.2.2.cmml">𝐞</mi><mn id="S3.SS1.p1.6.m6.3.3.2.2.2.3" xref="S3.SS1.p1.6.m6.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.6.m6.4.4.3.3.6" xref="S3.SS1.p1.6.m6.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">⋯</mi><mo id="S3.SS1.p1.6.m6.4.4.3.3.7" xref="S3.SS1.p1.6.m6.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.6.m6.4.4.3.3.3" xref="S3.SS1.p1.6.m6.4.4.3.3.3.cmml"><mi id="S3.SS1.p1.6.m6.4.4.3.3.3.2" xref="S3.SS1.p1.6.m6.4.4.3.3.3.2.cmml">𝐞</mi><mi id="S3.SS1.p1.6.m6.4.4.3.3.3.3" xref="S3.SS1.p1.6.m6.4.4.3.3.3.3.cmml">n</mi></msub><mo stretchy="false" id="S3.SS1.p1.6.m6.4.4.3.3.8" xref="S3.SS1.p1.6.m6.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.4b"><apply id="S3.SS1.p1.6.m6.4.4.cmml" xref="S3.SS1.p1.6.m6.4.4"><eq id="S3.SS1.p1.6.m6.4.4.4.cmml" xref="S3.SS1.p1.6.m6.4.4.4"></eq><apply id="S3.SS1.p1.6.m6.4.4.5.cmml" xref="S3.SS1.p1.6.m6.4.4.5"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.4.4.5.1.cmml" xref="S3.SS1.p1.6.m6.4.4.5">subscript</csymbol><ci id="S3.SS1.p1.6.m6.4.4.5.2.cmml" xref="S3.SS1.p1.6.m6.4.4.5.2">𝐄</ci><ci id="S3.SS1.p1.6.m6.4.4.5.3.cmml" xref="S3.SS1.p1.6.m6.4.4.5.3">𝑞</ci></apply><list id="S3.SS1.p1.6.m6.4.4.3.4.cmml" xref="S3.SS1.p1.6.m6.4.4.3.3"><apply id="S3.SS1.p1.6.m6.2.2.1.1.1.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1.2">𝐞</ci><cn type="integer" id="S3.SS1.p1.6.m6.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.6.m6.3.3.2.2.2.cmml" xref="S3.SS1.p1.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.6.m6.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.6.m6.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.6.m6.3.3.2.2.2.2">𝐞</ci><cn type="integer" id="S3.SS1.p1.6.m6.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.6.m6.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">⋯</ci><apply id="S3.SS1.p1.6.m6.4.4.3.3.3.cmml" xref="S3.SS1.p1.6.m6.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.6.m6.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.6.m6.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.6.m6.4.4.3.3.3.2">𝐞</ci><ci id="S3.SS1.p1.6.m6.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.6.m6.4.4.3.3.3.3">𝑛</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.4c">\mathbf{E}_{q}=[\mathbf{e}_{1},\mathbf{e}_{2},\cdots,\mathbf{e}_{n}]</annotation></semantics></math> where <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="\mathbf{e}_{i}\in\mathbb{R}^{d}" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><mrow id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><msub id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml"><mi id="S3.SS1.p1.7.m7.1.1.2.2" xref="S3.SS1.p1.7.m7.1.1.2.2.cmml">𝐞</mi><mi id="S3.SS1.p1.7.m7.1.1.2.3" xref="S3.SS1.p1.7.m7.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.p1.7.m7.1.1.1" xref="S3.SS1.p1.7.m7.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml"><mi id="S3.SS1.p1.7.m7.1.1.3.2" xref="S3.SS1.p1.7.m7.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.p1.7.m7.1.1.3.3" xref="S3.SS1.p1.7.m7.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><in id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1"></in><apply id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.2.1.cmml" xref="S3.SS1.p1.7.m7.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.2.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2.2">𝐞</ci><ci id="S3.SS1.p1.7.m7.1.1.2.3.cmml" xref="S3.SS1.p1.7.m7.1.1.2.3">𝑖</ci></apply><apply id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.3.1.cmml" xref="S3.SS1.p1.7.m7.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.3.2.cmml" xref="S3.SS1.p1.7.m7.1.1.3.2">ℝ</ci><ci id="S3.SS1.p1.7.m7.1.1.3.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">\mathbf{e}_{i}\in\mathbb{R}^{d}</annotation></semantics></math> , <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">d</annotation></semantics></math> is the embedding size. Then we feed <math id="S3.SS1.p1.9.m9.1" class="ltx_Math" alttext="\mathbf{E}_{q}" display="inline"><semantics id="S3.SS1.p1.9.m9.1a"><msub id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml"><mi id="S3.SS1.p1.9.m9.1.1.2" xref="S3.SS1.p1.9.m9.1.1.2.cmml">𝐄</mi><mi id="S3.SS1.p1.9.m9.1.1.3" xref="S3.SS1.p1.9.m9.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><apply id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2">𝐄</ci><ci id="S3.SS1.p1.9.m9.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">\mathbf{E}_{q}</annotation></semantics></math> into Gated Recurrent Units (GRU) and use the final hidden state of GRU as the question features:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.1" class="ltx_Math" alttext="\mathbf{q}=\text{GRU}(\mathbf{E}_{q})" display="block"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml"><mi id="S3.E1.m1.1.1.3" xref="S3.E1.m1.1.1.3.cmml">𝐪</mi><mo id="S3.E1.m1.1.1.2" xref="S3.E1.m1.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.cmml"><mtext id="S3.E1.m1.1.1.1.3" xref="S3.E1.m1.1.1.1.3a.cmml">GRU</mtext><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.2.cmml">𝐄</mi><mi id="S3.E1.m1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.3.cmml">q</mi></msub><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1"><eq id="S3.E1.m1.1.1.2.cmml" xref="S3.E1.m1.1.1.2"></eq><ci id="S3.E1.m1.1.1.3.cmml" xref="S3.E1.m1.1.1.3">𝐪</ci><apply id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><times id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.2"></times><ci id="S3.E1.m1.1.1.1.3a.cmml" xref="S3.E1.m1.1.1.1.3"><mtext id="S3.E1.m1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.3">GRU</mtext></ci><apply id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2">𝐄</ci><ci id="S3.E1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3">𝑞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\mathbf{q}=\text{GRU}(\mathbf{E}_{q})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.11" class="ltx_p">where <math id="S3.SS1.p1.10.m1.1" class="ltx_Math" alttext="\mathbf{q}\in\mathbb{R}^{h}" display="inline"><semantics id="S3.SS1.p1.10.m1.1a"><mrow id="S3.SS1.p1.10.m1.1.1" xref="S3.SS1.p1.10.m1.1.1.cmml"><mi id="S3.SS1.p1.10.m1.1.1.2" xref="S3.SS1.p1.10.m1.1.1.2.cmml">𝐪</mi><mo id="S3.SS1.p1.10.m1.1.1.1" xref="S3.SS1.p1.10.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.10.m1.1.1.3" xref="S3.SS1.p1.10.m1.1.1.3.cmml"><mi id="S3.SS1.p1.10.m1.1.1.3.2" xref="S3.SS1.p1.10.m1.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.p1.10.m1.1.1.3.3" xref="S3.SS1.p1.10.m1.1.1.3.3.cmml">h</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m1.1b"><apply id="S3.SS1.p1.10.m1.1.1.cmml" xref="S3.SS1.p1.10.m1.1.1"><in id="S3.SS1.p1.10.m1.1.1.1.cmml" xref="S3.SS1.p1.10.m1.1.1.1"></in><ci id="S3.SS1.p1.10.m1.1.1.2.cmml" xref="S3.SS1.p1.10.m1.1.1.2">𝐪</ci><apply id="S3.SS1.p1.10.m1.1.1.3.cmml" xref="S3.SS1.p1.10.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m1.1.1.3.1.cmml" xref="S3.SS1.p1.10.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.10.m1.1.1.3.2.cmml" xref="S3.SS1.p1.10.m1.1.1.3.2">ℝ</ci><ci id="S3.SS1.p1.10.m1.1.1.3.3.cmml" xref="S3.SS1.p1.10.m1.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m1.1c">\mathbf{q}\in\mathbb{R}^{h}</annotation></semantics></math> and <math id="S3.SS1.p1.11.m2.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S3.SS1.p1.11.m2.1a"><mi id="S3.SS1.p1.11.m2.1.1" xref="S3.SS1.p1.11.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m2.1b"><ci id="S3.SS1.p1.11.m2.1.1.cmml" xref="S3.SS1.p1.11.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m2.1c">h</annotation></semantics></math> is the hidden size of GRU units.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Visual Network</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">To better illustrate our approach, we will first introduce the generic Modular Architecture and Modular Routing Architecture. Modular Architecture defines the granularity and organization structure of the modules. Module Routing Architecture defines how the routing path controls over the Modular Architecture. Then we will introduce two forms of implementations of the module routing architecture: <span id="S3.SS2.p1.1.1" class="ltx_text ltx_font_bold">FRN</span>, which is based on ResNet; <span id="S3.SS2.p1.1.2" class="ltx_text ltx_font_bold">BRN</span> (<span id="S3.SS2.p1.1.3" class="ltx_text ltx_font_bold">B</span>ranch <span id="S3.SS2.p1.1.4" class="ltx_text ltx_font_bold">R</span>outing <span id="S3.SS2.p1.1.5" class="ltx_text ltx_font_bold">N</span>etwork), which is based on ResNext (<span id="S3.SS2.p1.1.6" class="ltx_text ltx_font_bold">?</span>).</p>
</div>
<section id="S3.SS2.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Modular Architecture.</h4>

<div id="S3.SS2.SSSx1.p1" class="ltx_para">
<p id="S3.SS2.SSSx1.p1.11" class="ltx_p">We assume that a generic modular architecture is composed of <math id="S3.SS2.SSSx1.p1.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS2.SSSx1.p1.1.m1.1a"><mi id="S3.SS2.SSSx1.p1.1.m1.1.1" xref="S3.SS2.SSSx1.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSSx1.p1.1.m1.1b"><ci id="S3.SS2.SSSx1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSSx1.p1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSSx1.p1.1.m1.1c">L</annotation></semantics></math> modular layers, each modular layer is composed of <math id="S3.SS2.SSSx1.p1.2.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS2.SSSx1.p1.2.m2.1a"><mi id="S3.SS2.SSSx1.p1.2.m2.1.1" xref="S3.SS2.SSSx1.p1.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSSx1.p1.2.m2.1b"><ci id="S3.SS2.SSSx1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSSx1.p1.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSSx1.p1.2.m2.1c">M</annotation></semantics></math> modules<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>For convenience, we assume that the number of modules per modular layer is the same, but in fact they can be different.</span></span></span>, each module <math id="S3.SS2.SSSx1.p1.3.m3.6" class="ltx_Math" alttext="f_{l,m}(x;\theta_{l,m})" display="inline"><semantics id="S3.SS2.SSSx1.p1.3.m3.6a"><mrow id="S3.SS2.SSSx1.p1.3.m3.6.6" xref="S3.SS2.SSSx1.p1.3.m3.6.6.cmml"><msub id="S3.SS2.SSSx1.p1.3.m3.6.6.3" xref="S3.SS2.SSSx1.p1.3.m3.6.6.3.cmml"><mi id="S3.SS2.SSSx1.p1.3.m3.6.6.3.2" xref="S3.SS2.SSSx1.p1.3.m3.6.6.3.2.cmml">f</mi><mrow id="S3.SS2.SSSx1.p1.3.m3.2.2.2.4" xref="S3.SS2.SSSx1.p1.3.m3.2.2.2.3.cmml"><mi id="S3.SS2.SSSx1.p1.3.m3.1.1.1.1" xref="S3.SS2.SSSx1.p1.3.m3.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSSx1.p1.3.m3.2.2.2.4.1" xref="S3.SS2.SSSx1.p1.3.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS2.SSSx1.p1.3.m3.2.2.2.2" xref="S3.SS2.SSSx1.p1.3.m3.2.2.2.2.cmml">m</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSSx1.p1.3.m3.6.6.2" xref="S3.SS2.SSSx1.p1.3.m3.6.6.2.cmml">​</mo><mrow id="S3.SS2.SSSx1.p1.3.m3.6.6.1.1" xref="S3.SS2.SSSx1.p1.3.m3.6.6.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSSx1.p1.3.m3.6.6.1.1.2" xref="S3.SS2.SSSx1.p1.3.m3.6.6.1.2.cmml">(</mo><mi id="S3.SS2.SSSx1.p1.3.m3.5.5" xref="S3.SS2.SSSx1.p1.3.m3.5.5.cmml">x</mi><mo id="S3.SS2.SSSx1.p1.3.m3.6.6.1.1.3" xref="S3.SS2.SSSx1.p1.3.m3.6.6.1.2.cmml">;</mo><msub id="S3.SS2.SSSx1.p1.3.m3.6.6.1.1.1" xref="S3.SS2.SSSx1.p1.3.m3.6.6.1.1.1.cmml"><mi id="S3.SS2.SSSx1.p1.3.m3.6.6.1.1.1.2" xref="S3.SS2.SSSx1.p1.3.m3.6.6.1.1.1.2.cmml">θ</mi><mrow id="S3.SS2.SSSx1.p1.3.m3.4.4.2.4" xref="S3.SS2.SSSx1.p1.3.m3.4.4.2.3.cmml"><mi id="S3.SS2.SSSx1.p1.3.m3.3.3.1.1" xref="S3.SS2.SSSx1.p1.3.m3.3.3.1.1.cmml">l</mi><mo id="S3.SS2.SSSx1.p1.3.m3.4.4.2.4.1" xref="S3.SS2.SSSx1.p1.3.m3.4.4.2.3.cmml">,</mo><mi id="S3.SS2.SSSx1.p1.3.m3.4.4.2.2" xref="S3.SS2.SSSx1.p1.3.m3.4.4.2.2.cmml">m</mi></mrow></msub><mo stretchy="false" id="S3.SS2.SSSx1.p1.3.m3.6.6.1.1.4" xref="S3.SS2.SSSx1.p1.3.m3.6.6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSSx1.p1.3.m3.6b"><apply id="S3.SS2.SSSx1.p1.3.m3.6.6.cmml" xref="S3.SS2.SSSx1.p1.3.m3.6.6"><times id="S3.SS2.SSSx1.p1.3.m3.6.6.2.cmml" xref="S3.SS2.SSSx1.p1.3.m3.6.6.2"></times><apply id="S3.SS2.SSSx1.p1.3.m3.6.6.3.cmml" xref="S3.SS2.SSSx1.p1.3.m3.6.6.3"><csymbol cd="ambiguous" id="S3.SS2.SSSx1.p1.3.m3.6.6.3.1.cmml" xref="S3.SS2.SSSx1.p1.3.m3.6.6.3">subscript</csymbol><ci id="S3.SS2.SSSx1.p1.3.m3.6.6.3.2.cmml" xref="S3.SS2.SSSx1.p1.3.m3.6.6.3.2">𝑓</ci><list id="S3.SS2.SSSx1.p1.3.m3.2.2.2.3.cmml" xref="S3.SS2.SSSx1.p1.3.m3.2.2.2.4"><ci id="S3.SS2.SSSx1.p1.3.m3.1.1.1.1.cmml" xref="S3.SS2.SSSx1.p1.3.m3.1.1.1.1">𝑙</ci><ci id="S3.SS2.SSSx1.p1.3.m3.2.2.2.2.cmml" xref="S3.SS2.SSSx1.p1.3.m3.2.2.2.2">𝑚</ci></list></apply><list id="S3.SS2.SSSx1.p1.3.m3.6.6.1.2.cmml" xref="S3.SS2.SSSx1.p1.3.m3.6.6.1.1"><ci id="S3.SS2.SSSx1.p1.3.m3.5.5.cmml" xref="S3.SS2.SSSx1.p1.3.m3.5.5">𝑥</ci><apply id="S3.SS2.SSSx1.p1.3.m3.6.6.1.1.1.cmml" xref="S3.SS2.SSSx1.p1.3.m3.6.6.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSSx1.p1.3.m3.6.6.1.1.1.1.cmml" xref="S3.SS2.SSSx1.p1.3.m3.6.6.1.1.1">subscript</csymbol><ci id="S3.SS2.SSSx1.p1.3.m3.6.6.1.1.1.2.cmml" xref="S3.SS2.SSSx1.p1.3.m3.6.6.1.1.1.2">𝜃</ci><list id="S3.SS2.SSSx1.p1.3.m3.4.4.2.3.cmml" xref="S3.SS2.SSSx1.p1.3.m3.4.4.2.4"><ci id="S3.SS2.SSSx1.p1.3.m3.3.3.1.1.cmml" xref="S3.SS2.SSSx1.p1.3.m3.3.3.1.1">𝑙</ci><ci id="S3.SS2.SSSx1.p1.3.m3.4.4.2.2.cmml" xref="S3.SS2.SSSx1.p1.3.m3.4.4.2.2">𝑚</ci></list></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSSx1.p1.3.m3.6c">f_{l,m}(x;\theta_{l,m})</annotation></semantics></math> for <math id="S3.SS2.SSSx1.p1.4.m4.3" class="ltx_Math" alttext="l\in\{1,\cdots,L\}" display="inline"><semantics id="S3.SS2.SSSx1.p1.4.m4.3a"><mrow id="S3.SS2.SSSx1.p1.4.m4.3.4" xref="S3.SS2.SSSx1.p1.4.m4.3.4.cmml"><mi id="S3.SS2.SSSx1.p1.4.m4.3.4.2" xref="S3.SS2.SSSx1.p1.4.m4.3.4.2.cmml">l</mi><mo id="S3.SS2.SSSx1.p1.4.m4.3.4.1" xref="S3.SS2.SSSx1.p1.4.m4.3.4.1.cmml">∈</mo><mrow id="S3.SS2.SSSx1.p1.4.m4.3.4.3.2" xref="S3.SS2.SSSx1.p1.4.m4.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS2.SSSx1.p1.4.m4.3.4.3.2.1" xref="S3.SS2.SSSx1.p1.4.m4.3.4.3.1.cmml">{</mo><mn id="S3.SS2.SSSx1.p1.4.m4.1.1" xref="S3.SS2.SSSx1.p1.4.m4.1.1.cmml">1</mn><mo id="S3.SS2.SSSx1.p1.4.m4.3.4.3.2.2" xref="S3.SS2.SSSx1.p1.4.m4.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSSx1.p1.4.m4.2.2" xref="S3.SS2.SSSx1.p1.4.m4.2.2.cmml">⋯</mi><mo id="S3.SS2.SSSx1.p1.4.m4.3.4.3.2.3" xref="S3.SS2.SSSx1.p1.4.m4.3.4.3.1.cmml">,</mo><mi id="S3.SS2.SSSx1.p1.4.m4.3.3" xref="S3.SS2.SSSx1.p1.4.m4.3.3.cmml">L</mi><mo stretchy="false" id="S3.SS2.SSSx1.p1.4.m4.3.4.3.2.4" xref="S3.SS2.SSSx1.p1.4.m4.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSSx1.p1.4.m4.3b"><apply id="S3.SS2.SSSx1.p1.4.m4.3.4.cmml" xref="S3.SS2.SSSx1.p1.4.m4.3.4"><in id="S3.SS2.SSSx1.p1.4.m4.3.4.1.cmml" xref="S3.SS2.SSSx1.p1.4.m4.3.4.1"></in><ci id="S3.SS2.SSSx1.p1.4.m4.3.4.2.cmml" xref="S3.SS2.SSSx1.p1.4.m4.3.4.2">𝑙</ci><set id="S3.SS2.SSSx1.p1.4.m4.3.4.3.1.cmml" xref="S3.SS2.SSSx1.p1.4.m4.3.4.3.2"><cn type="integer" id="S3.SS2.SSSx1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSSx1.p1.4.m4.1.1">1</cn><ci id="S3.SS2.SSSx1.p1.4.m4.2.2.cmml" xref="S3.SS2.SSSx1.p1.4.m4.2.2">⋯</ci><ci id="S3.SS2.SSSx1.p1.4.m4.3.3.cmml" xref="S3.SS2.SSSx1.p1.4.m4.3.3">𝐿</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSSx1.p1.4.m4.3c">l\in\{1,\cdots,L\}</annotation></semantics></math> and <math id="S3.SS2.SSSx1.p1.5.m5.3" class="ltx_Math" alttext="m\in\{1,\cdots,M\}" display="inline"><semantics id="S3.SS2.SSSx1.p1.5.m5.3a"><mrow id="S3.SS2.SSSx1.p1.5.m5.3.4" xref="S3.SS2.SSSx1.p1.5.m5.3.4.cmml"><mi id="S3.SS2.SSSx1.p1.5.m5.3.4.2" xref="S3.SS2.SSSx1.p1.5.m5.3.4.2.cmml">m</mi><mo id="S3.SS2.SSSx1.p1.5.m5.3.4.1" xref="S3.SS2.SSSx1.p1.5.m5.3.4.1.cmml">∈</mo><mrow id="S3.SS2.SSSx1.p1.5.m5.3.4.3.2" xref="S3.SS2.SSSx1.p1.5.m5.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS2.SSSx1.p1.5.m5.3.4.3.2.1" xref="S3.SS2.SSSx1.p1.5.m5.3.4.3.1.cmml">{</mo><mn id="S3.SS2.SSSx1.p1.5.m5.1.1" xref="S3.SS2.SSSx1.p1.5.m5.1.1.cmml">1</mn><mo id="S3.SS2.SSSx1.p1.5.m5.3.4.3.2.2" xref="S3.SS2.SSSx1.p1.5.m5.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSSx1.p1.5.m5.2.2" xref="S3.SS2.SSSx1.p1.5.m5.2.2.cmml">⋯</mi><mo id="S3.SS2.SSSx1.p1.5.m5.3.4.3.2.3" xref="S3.SS2.SSSx1.p1.5.m5.3.4.3.1.cmml">,</mo><mi id="S3.SS2.SSSx1.p1.5.m5.3.3" xref="S3.SS2.SSSx1.p1.5.m5.3.3.cmml">M</mi><mo stretchy="false" id="S3.SS2.SSSx1.p1.5.m5.3.4.3.2.4" xref="S3.SS2.SSSx1.p1.5.m5.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSSx1.p1.5.m5.3b"><apply id="S3.SS2.SSSx1.p1.5.m5.3.4.cmml" xref="S3.SS2.SSSx1.p1.5.m5.3.4"><in id="S3.SS2.SSSx1.p1.5.m5.3.4.1.cmml" xref="S3.SS2.SSSx1.p1.5.m5.3.4.1"></in><ci id="S3.SS2.SSSx1.p1.5.m5.3.4.2.cmml" xref="S3.SS2.SSSx1.p1.5.m5.3.4.2">𝑚</ci><set id="S3.SS2.SSSx1.p1.5.m5.3.4.3.1.cmml" xref="S3.SS2.SSSx1.p1.5.m5.3.4.3.2"><cn type="integer" id="S3.SS2.SSSx1.p1.5.m5.1.1.cmml" xref="S3.SS2.SSSx1.p1.5.m5.1.1">1</cn><ci id="S3.SS2.SSSx1.p1.5.m5.2.2.cmml" xref="S3.SS2.SSSx1.p1.5.m5.2.2">⋯</ci><ci id="S3.SS2.SSSx1.p1.5.m5.3.3.cmml" xref="S3.SS2.SSSx1.p1.5.m5.3.3">𝑀</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSSx1.p1.5.m5.3c">m\in\{1,\cdots,M\}</annotation></semantics></math> is a function module that takes the input <math id="S3.SS2.SSSx1.p1.6.m6.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS2.SSSx1.p1.6.m6.1a"><mi id="S3.SS2.SSSx1.p1.6.m6.1.1" xref="S3.SS2.SSSx1.p1.6.m6.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSSx1.p1.6.m6.1b"><ci id="S3.SS2.SSSx1.p1.6.m6.1.1.cmml" xref="S3.SS2.SSSx1.p1.6.m6.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSSx1.p1.6.m6.1c">x</annotation></semantics></math> and generates an output tensor, <math id="S3.SS2.SSSx1.p1.7.m7.2" class="ltx_Math" alttext="\theta_{l,m}" display="inline"><semantics id="S3.SS2.SSSx1.p1.7.m7.2a"><msub id="S3.SS2.SSSx1.p1.7.m7.2.3" xref="S3.SS2.SSSx1.p1.7.m7.2.3.cmml"><mi id="S3.SS2.SSSx1.p1.7.m7.2.3.2" xref="S3.SS2.SSSx1.p1.7.m7.2.3.2.cmml">θ</mi><mrow id="S3.SS2.SSSx1.p1.7.m7.2.2.2.4" xref="S3.SS2.SSSx1.p1.7.m7.2.2.2.3.cmml"><mi id="S3.SS2.SSSx1.p1.7.m7.1.1.1.1" xref="S3.SS2.SSSx1.p1.7.m7.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSSx1.p1.7.m7.2.2.2.4.1" xref="S3.SS2.SSSx1.p1.7.m7.2.2.2.3.cmml">,</mo><mi id="S3.SS2.SSSx1.p1.7.m7.2.2.2.2" xref="S3.SS2.SSSx1.p1.7.m7.2.2.2.2.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSSx1.p1.7.m7.2b"><apply id="S3.SS2.SSSx1.p1.7.m7.2.3.cmml" xref="S3.SS2.SSSx1.p1.7.m7.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSSx1.p1.7.m7.2.3.1.cmml" xref="S3.SS2.SSSx1.p1.7.m7.2.3">subscript</csymbol><ci id="S3.SS2.SSSx1.p1.7.m7.2.3.2.cmml" xref="S3.SS2.SSSx1.p1.7.m7.2.3.2">𝜃</ci><list id="S3.SS2.SSSx1.p1.7.m7.2.2.2.3.cmml" xref="S3.SS2.SSSx1.p1.7.m7.2.2.2.4"><ci id="S3.SS2.SSSx1.p1.7.m7.1.1.1.1.cmml" xref="S3.SS2.SSSx1.p1.7.m7.1.1.1.1">𝑙</ci><ci id="S3.SS2.SSSx1.p1.7.m7.2.2.2.2.cmml" xref="S3.SS2.SSSx1.p1.7.m7.2.2.2.2">𝑚</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSSx1.p1.7.m7.2c">\theta_{l,m}</annotation></semantics></math> is the learnable parameter of <math id="S3.SS2.SSSx1.p1.8.m8.2" class="ltx_Math" alttext="f_{l,m}" display="inline"><semantics id="S3.SS2.SSSx1.p1.8.m8.2a"><msub id="S3.SS2.SSSx1.p1.8.m8.2.3" xref="S3.SS2.SSSx1.p1.8.m8.2.3.cmml"><mi id="S3.SS2.SSSx1.p1.8.m8.2.3.2" xref="S3.SS2.SSSx1.p1.8.m8.2.3.2.cmml">f</mi><mrow id="S3.SS2.SSSx1.p1.8.m8.2.2.2.4" xref="S3.SS2.SSSx1.p1.8.m8.2.2.2.3.cmml"><mi id="S3.SS2.SSSx1.p1.8.m8.1.1.1.1" xref="S3.SS2.SSSx1.p1.8.m8.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSSx1.p1.8.m8.2.2.2.4.1" xref="S3.SS2.SSSx1.p1.8.m8.2.2.2.3.cmml">,</mo><mi id="S3.SS2.SSSx1.p1.8.m8.2.2.2.2" xref="S3.SS2.SSSx1.p1.8.m8.2.2.2.2.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSSx1.p1.8.m8.2b"><apply id="S3.SS2.SSSx1.p1.8.m8.2.3.cmml" xref="S3.SS2.SSSx1.p1.8.m8.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSSx1.p1.8.m8.2.3.1.cmml" xref="S3.SS2.SSSx1.p1.8.m8.2.3">subscript</csymbol><ci id="S3.SS2.SSSx1.p1.8.m8.2.3.2.cmml" xref="S3.SS2.SSSx1.p1.8.m8.2.3.2">𝑓</ci><list id="S3.SS2.SSSx1.p1.8.m8.2.2.2.3.cmml" xref="S3.SS2.SSSx1.p1.8.m8.2.2.2.4"><ci id="S3.SS2.SSSx1.p1.8.m8.1.1.1.1.cmml" xref="S3.SS2.SSSx1.p1.8.m8.1.1.1.1">𝑙</ci><ci id="S3.SS2.SSSx1.p1.8.m8.2.2.2.2.cmml" xref="S3.SS2.SSSx1.p1.8.m8.2.2.2.2">𝑚</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSSx1.p1.8.m8.2c">f_{l,m}</annotation></semantics></math>. All modules in the <math id="S3.SS2.SSSx1.p1.9.m9.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS2.SSSx1.p1.9.m9.1a"><mi id="S3.SS2.SSSx1.p1.9.m9.1.1" xref="S3.SS2.SSSx1.p1.9.m9.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSSx1.p1.9.m9.1b"><ci id="S3.SS2.SSSx1.p1.9.m9.1.1.cmml" xref="S3.SS2.SSSx1.p1.9.m9.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSSx1.p1.9.m9.1c">l</annotation></semantics></math>th layer share the same input, and the output of the <math id="S3.SS2.SSSx1.p1.10.m10.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS2.SSSx1.p1.10.m10.1a"><mi id="S3.SS2.SSSx1.p1.10.m10.1.1" xref="S3.SS2.SSSx1.p1.10.m10.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSSx1.p1.10.m10.1b"><ci id="S3.SS2.SSSx1.p1.10.m10.1.1.cmml" xref="S3.SS2.SSSx1.p1.10.m10.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSSx1.p1.10.m10.1c">l</annotation></semantics></math>th layer <math id="S3.SS2.SSSx1.p1.11.m11.1" class="ltx_Math" alttext="y_{l}" display="inline"><semantics id="S3.SS2.SSSx1.p1.11.m11.1a"><msub id="S3.SS2.SSSx1.p1.11.m11.1.1" xref="S3.SS2.SSSx1.p1.11.m11.1.1.cmml"><mi id="S3.SS2.SSSx1.p1.11.m11.1.1.2" xref="S3.SS2.SSSx1.p1.11.m11.1.1.2.cmml">y</mi><mi id="S3.SS2.SSSx1.p1.11.m11.1.1.3" xref="S3.SS2.SSSx1.p1.11.m11.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSSx1.p1.11.m11.1b"><apply id="S3.SS2.SSSx1.p1.11.m11.1.1.cmml" xref="S3.SS2.SSSx1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSSx1.p1.11.m11.1.1.1.cmml" xref="S3.SS2.SSSx1.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS2.SSSx1.p1.11.m11.1.1.2.cmml" xref="S3.SS2.SSSx1.p1.11.m11.1.1.2">𝑦</ci><ci id="S3.SS2.SSSx1.p1.11.m11.1.1.3.cmml" xref="S3.SS2.SSSx1.p1.11.m11.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSSx1.p1.11.m11.1c">y_{l}</annotation></semantics></math> is:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.10" class="ltx_Math" alttext="y_{l}=\phi([f_{l,1}(y_{l-1};\theta_{l,1}),\cdots,f_{l,M}(y_{l-1};\theta_{l,M})])+y_{l-1}" display="block"><semantics id="S3.E2.m1.10a"><mrow id="S3.E2.m1.10.10" xref="S3.E2.m1.10.10.cmml"><msub id="S3.E2.m1.10.10.3" xref="S3.E2.m1.10.10.3.cmml"><mi id="S3.E2.m1.10.10.3.2" xref="S3.E2.m1.10.10.3.2.cmml">y</mi><mi id="S3.E2.m1.10.10.3.3" xref="S3.E2.m1.10.10.3.3.cmml">l</mi></msub><mo id="S3.E2.m1.10.10.2" xref="S3.E2.m1.10.10.2.cmml">=</mo><mrow id="S3.E2.m1.10.10.1" xref="S3.E2.m1.10.10.1.cmml"><mrow id="S3.E2.m1.10.10.1.1" xref="S3.E2.m1.10.10.1.1.cmml"><mi id="S3.E2.m1.10.10.1.1.3" xref="S3.E2.m1.10.10.1.1.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.10.10.1.1.2" xref="S3.E2.m1.10.10.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.10.10.1.1.1.1" xref="S3.E2.m1.10.10.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.10.10.1.1.1.1.2" xref="S3.E2.m1.10.10.1.1.cmml">(</mo><mrow id="S3.E2.m1.10.10.1.1.1.1.1.2" xref="S3.E2.m1.10.10.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.E2.m1.10.10.1.1.1.1.1.2.3" xref="S3.E2.m1.10.10.1.1.1.1.1.3.cmml">[</mo><mrow id="S3.E2.m1.10.10.1.1.1.1.1.1.1" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.10.10.1.1.1.1.1.1.1.4" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E2.m1.10.10.1.1.1.1.1.1.1.4.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.4.2.cmml">f</mi><mrow id="S3.E2.m1.2.2.2.4" xref="S3.E2.m1.2.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">l</mi><mo id="S3.E2.m1.2.2.2.4.1" xref="S3.E2.m1.2.2.2.3.cmml">,</mo><mn id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml">1</mn></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.10.10.1.1.1.1.1.1.1.3" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.2.3" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.3.cmml">(</mo><msub id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mrow id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.2.4" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.3.cmml">;</mo><msub id="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.2.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.2.2.2.cmml">θ</mi><mrow id="S3.E2.m1.4.4.2.4" xref="S3.E2.m1.4.4.2.3.cmml"><mi id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml">l</mi><mo id="S3.E2.m1.4.4.2.4.1" xref="S3.E2.m1.4.4.2.3.cmml">,</mo><mn id="S3.E2.m1.4.4.2.2" xref="S3.E2.m1.4.4.2.2.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.2.5" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.10.10.1.1.1.1.1.2.4" xref="S3.E2.m1.10.10.1.1.1.1.1.3.cmml">,</mo><mi mathvariant="normal" id="S3.E2.m1.9.9" xref="S3.E2.m1.9.9.cmml">⋯</mi><mo id="S3.E2.m1.10.10.1.1.1.1.1.2.5" xref="S3.E2.m1.10.10.1.1.1.1.1.3.cmml">,</mo><mrow id="S3.E2.m1.10.10.1.1.1.1.1.2.2" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.cmml"><msub id="S3.E2.m1.10.10.1.1.1.1.1.2.2.4" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.4.cmml"><mi id="S3.E2.m1.10.10.1.1.1.1.1.2.2.4.2" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.4.2.cmml">f</mi><mrow id="S3.E2.m1.6.6.2.4" xref="S3.E2.m1.6.6.2.3.cmml"><mi id="S3.E2.m1.5.5.1.1" xref="S3.E2.m1.5.5.1.1.cmml">l</mi><mo id="S3.E2.m1.6.6.2.4.1" xref="S3.E2.m1.6.6.2.3.cmml">,</mo><mi id="S3.E2.m1.6.6.2.2" xref="S3.E2.m1.6.6.2.2.cmml">M</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.10.10.1.1.1.1.1.2.2.3" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.3.cmml">​</mo><mrow id="S3.E2.m1.10.10.1.1.1.1.1.2.2.2.2" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.10.10.1.1.1.1.1.2.2.2.2.3" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.2.3.cmml">(</mo><msub id="S3.E2.m1.10.10.1.1.1.1.1.2.2.1.1.1" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.1.1.1.cmml"><mi id="S3.E2.m1.10.10.1.1.1.1.1.2.2.1.1.1.2" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.1.1.1.2.cmml">y</mi><mrow id="S3.E2.m1.10.10.1.1.1.1.1.2.2.1.1.1.3" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.cmml"><mi id="S3.E2.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.2" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.2.cmml">l</mi><mo id="S3.E2.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.1" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.1.cmml">−</mo><mn id="S3.E2.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.3" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E2.m1.10.10.1.1.1.1.1.2.2.2.2.4" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.2.3.cmml">;</mo><msub id="S3.E2.m1.10.10.1.1.1.1.1.2.2.2.2.2" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.2.2.2.cmml"><mi id="S3.E2.m1.10.10.1.1.1.1.1.2.2.2.2.2.2" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.2.2.2.2.cmml">θ</mi><mrow id="S3.E2.m1.8.8.2.4" xref="S3.E2.m1.8.8.2.3.cmml"><mi id="S3.E2.m1.7.7.1.1" xref="S3.E2.m1.7.7.1.1.cmml">l</mi><mo id="S3.E2.m1.8.8.2.4.1" xref="S3.E2.m1.8.8.2.3.cmml">,</mo><mi id="S3.E2.m1.8.8.2.2" xref="S3.E2.m1.8.8.2.2.cmml">M</mi></mrow></msub><mo stretchy="false" id="S3.E2.m1.10.10.1.1.1.1.1.2.2.2.2.5" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E2.m1.10.10.1.1.1.1.1.2.6" xref="S3.E2.m1.10.10.1.1.1.1.1.3.cmml">]</mo></mrow><mo stretchy="false" id="S3.E2.m1.10.10.1.1.1.1.3" xref="S3.E2.m1.10.10.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.10.10.1.2" xref="S3.E2.m1.10.10.1.2.cmml">+</mo><msub id="S3.E2.m1.10.10.1.3" xref="S3.E2.m1.10.10.1.3.cmml"><mi id="S3.E2.m1.10.10.1.3.2" xref="S3.E2.m1.10.10.1.3.2.cmml">y</mi><mrow id="S3.E2.m1.10.10.1.3.3" xref="S3.E2.m1.10.10.1.3.3.cmml"><mi id="S3.E2.m1.10.10.1.3.3.2" xref="S3.E2.m1.10.10.1.3.3.2.cmml">l</mi><mo id="S3.E2.m1.10.10.1.3.3.1" xref="S3.E2.m1.10.10.1.3.3.1.cmml">−</mo><mn id="S3.E2.m1.10.10.1.3.3.3" xref="S3.E2.m1.10.10.1.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.10b"><apply id="S3.E2.m1.10.10.cmml" xref="S3.E2.m1.10.10"><eq id="S3.E2.m1.10.10.2.cmml" xref="S3.E2.m1.10.10.2"></eq><apply id="S3.E2.m1.10.10.3.cmml" xref="S3.E2.m1.10.10.3"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.3.1.cmml" xref="S3.E2.m1.10.10.3">subscript</csymbol><ci id="S3.E2.m1.10.10.3.2.cmml" xref="S3.E2.m1.10.10.3.2">𝑦</ci><ci id="S3.E2.m1.10.10.3.3.cmml" xref="S3.E2.m1.10.10.3.3">𝑙</ci></apply><apply id="S3.E2.m1.10.10.1.cmml" xref="S3.E2.m1.10.10.1"><plus id="S3.E2.m1.10.10.1.2.cmml" xref="S3.E2.m1.10.10.1.2"></plus><apply id="S3.E2.m1.10.10.1.1.cmml" xref="S3.E2.m1.10.10.1.1"><times id="S3.E2.m1.10.10.1.1.2.cmml" xref="S3.E2.m1.10.10.1.1.2"></times><ci id="S3.E2.m1.10.10.1.1.3.cmml" xref="S3.E2.m1.10.10.1.1.3">italic-ϕ</ci><list id="S3.E2.m1.10.10.1.1.1.1.1.3.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.2"><apply id="S3.E2.m1.10.10.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1"><times id="S3.E2.m1.10.10.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.3"></times><apply id="S3.E2.m1.10.10.1.1.1.1.1.1.1.4.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E2.m1.10.10.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.4.2">𝑓</ci><list id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.4"><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑙</ci><cn type="integer" id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2">1</cn></list></apply><list id="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.2"><apply id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.2">𝑦</ci><apply id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.3"><minus id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2">𝑙</ci><cn type="integer" id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.2.2.2">𝜃</ci><list id="S3.E2.m1.4.4.2.3.cmml" xref="S3.E2.m1.4.4.2.4"><ci id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1.1">𝑙</ci><cn type="integer" id="S3.E2.m1.4.4.2.2.cmml" xref="S3.E2.m1.4.4.2.2">1</cn></list></apply></list></apply><ci id="S3.E2.m1.9.9.cmml" xref="S3.E2.m1.9.9">⋯</ci><apply id="S3.E2.m1.10.10.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2"><times id="S3.E2.m1.10.10.1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.3"></times><apply id="S3.E2.m1.10.10.1.1.1.1.1.2.2.4.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.1.1.1.1.1.2.2.4.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.4">subscript</csymbol><ci id="S3.E2.m1.10.10.1.1.1.1.1.2.2.4.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.4.2">𝑓</ci><list id="S3.E2.m1.6.6.2.3.cmml" xref="S3.E2.m1.6.6.2.4"><ci id="S3.E2.m1.5.5.1.1.cmml" xref="S3.E2.m1.5.5.1.1">𝑙</ci><ci id="S3.E2.m1.6.6.2.2.cmml" xref="S3.E2.m1.6.6.2.2">𝑀</ci></list></apply><list id="S3.E2.m1.10.10.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.2.2"><apply id="S3.E2.m1.10.10.1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.1.1.1">subscript</csymbol><ci id="S3.E2.m1.10.10.1.1.1.1.1.2.2.1.1.1.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.1.1.1.2">𝑦</ci><apply id="S3.E2.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.1.1.1.3"><minus id="S3.E2.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.1"></minus><ci id="S3.E2.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.2">𝑙</ci><cn type="integer" id="S3.E2.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.3.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E2.m1.10.10.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.10.10.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.2.2.2.2.2.2">𝜃</ci><list id="S3.E2.m1.8.8.2.3.cmml" xref="S3.E2.m1.8.8.2.4"><ci id="S3.E2.m1.7.7.1.1.cmml" xref="S3.E2.m1.7.7.1.1">𝑙</ci><ci id="S3.E2.m1.8.8.2.2.cmml" xref="S3.E2.m1.8.8.2.2">𝑀</ci></list></apply></list></apply></list></apply><apply id="S3.E2.m1.10.10.1.3.cmml" xref="S3.E2.m1.10.10.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.1.3.1.cmml" xref="S3.E2.m1.10.10.1.3">subscript</csymbol><ci id="S3.E2.m1.10.10.1.3.2.cmml" xref="S3.E2.m1.10.10.1.3.2">𝑦</ci><apply id="S3.E2.m1.10.10.1.3.3.cmml" xref="S3.E2.m1.10.10.1.3.3"><minus id="S3.E2.m1.10.10.1.3.3.1.cmml" xref="S3.E2.m1.10.10.1.3.3.1"></minus><ci id="S3.E2.m1.10.10.1.3.3.2.cmml" xref="S3.E2.m1.10.10.1.3.3.2">𝑙</ci><cn type="integer" id="S3.E2.m1.10.10.1.3.3.3.cmml" xref="S3.E2.m1.10.10.1.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.10c">y_{l}=\phi([f_{l,1}(y_{l-1};\theta_{l,1}),\cdots,f_{l,M}(y_{l-1};\theta_{l,M})])+y_{l-1}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSSx1.p1.12" class="ltx_p">where the composite function <math id="S3.SS2.SSSx1.p1.12.m1.1" class="ltx_math_unparsed" alttext="\phi(.)" display="inline"><semantics id="S3.SS2.SSSx1.p1.12.m1.1a"><mrow id="S3.SS2.SSSx1.p1.12.m1.1b"><mi id="S3.SS2.SSSx1.p1.12.m1.1.1">ϕ</mi><mrow id="S3.SS2.SSSx1.p1.12.m1.1.2"><mo stretchy="false" id="S3.SS2.SSSx1.p1.12.m1.1.2.1">(</mo><mo lspace="0em" rspace="0.167em" id="S3.SS2.SSSx1.p1.12.m1.1.2.2">.</mo><mo stretchy="false" id="S3.SS2.SSSx1.p1.12.m1.1.2.3">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS2.SSSx1.p1.12.m1.1c">\phi(.)</annotation></semantics></math> can either be concatenation or summation.</p>
</div>
</section>
<section id="S3.SS2.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Modular Routing Architecture</h4>

<div id="S3.SS2.SSSx2.p1" class="ltx_para">
<p id="S3.SS2.SSSx2.p1.12" class="ltx_p">First, we denote the routing path as</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.1" class="ltx_Math" alttext="\mathbf{P}=\text{RNET}(\mathbf{q})" display="block"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.2" xref="S3.E3.m1.1.2.cmml"><mi id="S3.E3.m1.1.2.2" xref="S3.E3.m1.1.2.2.cmml">𝐏</mi><mo id="S3.E3.m1.1.2.1" xref="S3.E3.m1.1.2.1.cmml">=</mo><mrow id="S3.E3.m1.1.2.3" xref="S3.E3.m1.1.2.3.cmml"><mtext id="S3.E3.m1.1.2.3.2" xref="S3.E3.m1.1.2.3.2a.cmml">RNET</mtext><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.2.3.1" xref="S3.E3.m1.1.2.3.1.cmml">​</mo><mrow id="S3.E3.m1.1.2.3.3.2" xref="S3.E3.m1.1.2.3.cmml"><mo stretchy="false" id="S3.E3.m1.1.2.3.3.2.1" xref="S3.E3.m1.1.2.3.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">𝐪</mi><mo stretchy="false" id="S3.E3.m1.1.2.3.3.2.2" xref="S3.E3.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.2.cmml" xref="S3.E3.m1.1.2"><eq id="S3.E3.m1.1.2.1.cmml" xref="S3.E3.m1.1.2.1"></eq><ci id="S3.E3.m1.1.2.2.cmml" xref="S3.E3.m1.1.2.2">𝐏</ci><apply id="S3.E3.m1.1.2.3.cmml" xref="S3.E3.m1.1.2.3"><times id="S3.E3.m1.1.2.3.1.cmml" xref="S3.E3.m1.1.2.3.1"></times><ci id="S3.E3.m1.1.2.3.2a.cmml" xref="S3.E3.m1.1.2.3.2"><mtext id="S3.E3.m1.1.2.3.2.cmml" xref="S3.E3.m1.1.2.3.2">RNET</mtext></ci><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝐪</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\mathbf{P}=\text{RNET}(\mathbf{q})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSSx2.p1.9" class="ltx_p">where RNET is the routing network that generates a routing path <math id="S3.SS2.SSSx2.p1.1.m1.2" class="ltx_Math" alttext="\mathbf{P}\in\{0,1\}^{L\times M}" display="inline"><semantics id="S3.SS2.SSSx2.p1.1.m1.2a"><mrow id="S3.SS2.SSSx2.p1.1.m1.2.3" xref="S3.SS2.SSSx2.p1.1.m1.2.3.cmml"><mi id="S3.SS2.SSSx2.p1.1.m1.2.3.2" xref="S3.SS2.SSSx2.p1.1.m1.2.3.2.cmml">𝐏</mi><mo id="S3.SS2.SSSx2.p1.1.m1.2.3.1" xref="S3.SS2.SSSx2.p1.1.m1.2.3.1.cmml">∈</mo><msup id="S3.SS2.SSSx2.p1.1.m1.2.3.3" xref="S3.SS2.SSSx2.p1.1.m1.2.3.3.cmml"><mrow id="S3.SS2.SSSx2.p1.1.m1.2.3.3.2.2" xref="S3.SS2.SSSx2.p1.1.m1.2.3.3.2.1.cmml"><mo stretchy="false" id="S3.SS2.SSSx2.p1.1.m1.2.3.3.2.2.1" xref="S3.SS2.SSSx2.p1.1.m1.2.3.3.2.1.cmml">{</mo><mn id="S3.SS2.SSSx2.p1.1.m1.1.1" xref="S3.SS2.SSSx2.p1.1.m1.1.1.cmml">0</mn><mo id="S3.SS2.SSSx2.p1.1.m1.2.3.3.2.2.2" xref="S3.SS2.SSSx2.p1.1.m1.2.3.3.2.1.cmml">,</mo><mn id="S3.SS2.SSSx2.p1.1.m1.2.2" xref="S3.SS2.SSSx2.p1.1.m1.2.2.cmml">1</mn><mo stretchy="false" id="S3.SS2.SSSx2.p1.1.m1.2.3.3.2.2.3" xref="S3.SS2.SSSx2.p1.1.m1.2.3.3.2.1.cmml">}</mo></mrow><mrow id="S3.SS2.SSSx2.p1.1.m1.2.3.3.3" xref="S3.SS2.SSSx2.p1.1.m1.2.3.3.3.cmml"><mi id="S3.SS2.SSSx2.p1.1.m1.2.3.3.3.2" xref="S3.SS2.SSSx2.p1.1.m1.2.3.3.3.2.cmml">L</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSSx2.p1.1.m1.2.3.3.3.1" xref="S3.SS2.SSSx2.p1.1.m1.2.3.3.3.1.cmml">×</mo><mi id="S3.SS2.SSSx2.p1.1.m1.2.3.3.3.3" xref="S3.SS2.SSSx2.p1.1.m1.2.3.3.3.3.cmml">M</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSSx2.p1.1.m1.2b"><apply id="S3.SS2.SSSx2.p1.1.m1.2.3.cmml" xref="S3.SS2.SSSx2.p1.1.m1.2.3"><in id="S3.SS2.SSSx2.p1.1.m1.2.3.1.cmml" xref="S3.SS2.SSSx2.p1.1.m1.2.3.1"></in><ci id="S3.SS2.SSSx2.p1.1.m1.2.3.2.cmml" xref="S3.SS2.SSSx2.p1.1.m1.2.3.2">𝐏</ci><apply id="S3.SS2.SSSx2.p1.1.m1.2.3.3.cmml" xref="S3.SS2.SSSx2.p1.1.m1.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSSx2.p1.1.m1.2.3.3.1.cmml" xref="S3.SS2.SSSx2.p1.1.m1.2.3.3">superscript</csymbol><set id="S3.SS2.SSSx2.p1.1.m1.2.3.3.2.1.cmml" xref="S3.SS2.SSSx2.p1.1.m1.2.3.3.2.2"><cn type="integer" id="S3.SS2.SSSx2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSSx2.p1.1.m1.1.1">0</cn><cn type="integer" id="S3.SS2.SSSx2.p1.1.m1.2.2.cmml" xref="S3.SS2.SSSx2.p1.1.m1.2.2">1</cn></set><apply id="S3.SS2.SSSx2.p1.1.m1.2.3.3.3.cmml" xref="S3.SS2.SSSx2.p1.1.m1.2.3.3.3"><times id="S3.SS2.SSSx2.p1.1.m1.2.3.3.3.1.cmml" xref="S3.SS2.SSSx2.p1.1.m1.2.3.3.3.1"></times><ci id="S3.SS2.SSSx2.p1.1.m1.2.3.3.3.2.cmml" xref="S3.SS2.SSSx2.p1.1.m1.2.3.3.3.2">𝐿</ci><ci id="S3.SS2.SSSx2.p1.1.m1.2.3.3.3.3.cmml" xref="S3.SS2.SSSx2.p1.1.m1.2.3.3.3.3">𝑀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSSx2.p1.1.m1.2c">\mathbf{P}\in\{0,1\}^{L\times M}</annotation></semantics></math> condtioned on the question features <math id="S3.SS2.SSSx2.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{q}\in\mathbb{R}^{h}" display="inline"><semantics id="S3.SS2.SSSx2.p1.2.m2.1a"><mrow id="S3.SS2.SSSx2.p1.2.m2.1.1" xref="S3.SS2.SSSx2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSSx2.p1.2.m2.1.1.2" xref="S3.SS2.SSSx2.p1.2.m2.1.1.2.cmml">𝐪</mi><mo id="S3.SS2.SSSx2.p1.2.m2.1.1.1" xref="S3.SS2.SSSx2.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSSx2.p1.2.m2.1.1.3" xref="S3.SS2.SSSx2.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.SSSx2.p1.2.m2.1.1.3.2" xref="S3.SS2.SSSx2.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.SSSx2.p1.2.m2.1.1.3.3" xref="S3.SS2.SSSx2.p1.2.m2.1.1.3.3.cmml">h</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSSx2.p1.2.m2.1b"><apply id="S3.SS2.SSSx2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSSx2.p1.2.m2.1.1"><in id="S3.SS2.SSSx2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSSx2.p1.2.m2.1.1.1"></in><ci id="S3.SS2.SSSx2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSSx2.p1.2.m2.1.1.2">𝐪</ci><apply id="S3.SS2.SSSx2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSSx2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSSx2.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSSx2.p1.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.SSSx2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.SSSx2.p1.2.m2.1.1.3.2">ℝ</ci><ci id="S3.SS2.SSSx2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.SSSx2.p1.2.m2.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSSx2.p1.2.m2.1c">\mathbf{q}\in\mathbb{R}^{h}</annotation></semantics></math>. <math id="S3.SS2.SSSx2.p1.3.m3.2" class="ltx_Math" alttext="\mathbf{P}_{l,m}" display="inline"><semantics id="S3.SS2.SSSx2.p1.3.m3.2a"><msub id="S3.SS2.SSSx2.p1.3.m3.2.3" xref="S3.SS2.SSSx2.p1.3.m3.2.3.cmml"><mi id="S3.SS2.SSSx2.p1.3.m3.2.3.2" xref="S3.SS2.SSSx2.p1.3.m3.2.3.2.cmml">𝐏</mi><mrow id="S3.SS2.SSSx2.p1.3.m3.2.2.2.4" xref="S3.SS2.SSSx2.p1.3.m3.2.2.2.3.cmml"><mi id="S3.SS2.SSSx2.p1.3.m3.1.1.1.1" xref="S3.SS2.SSSx2.p1.3.m3.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSSx2.p1.3.m3.2.2.2.4.1" xref="S3.SS2.SSSx2.p1.3.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS2.SSSx2.p1.3.m3.2.2.2.2" xref="S3.SS2.SSSx2.p1.3.m3.2.2.2.2.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSSx2.p1.3.m3.2b"><apply id="S3.SS2.SSSx2.p1.3.m3.2.3.cmml" xref="S3.SS2.SSSx2.p1.3.m3.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSSx2.p1.3.m3.2.3.1.cmml" xref="S3.SS2.SSSx2.p1.3.m3.2.3">subscript</csymbol><ci id="S3.SS2.SSSx2.p1.3.m3.2.3.2.cmml" xref="S3.SS2.SSSx2.p1.3.m3.2.3.2">𝐏</ci><list id="S3.SS2.SSSx2.p1.3.m3.2.2.2.3.cmml" xref="S3.SS2.SSSx2.p1.3.m3.2.2.2.4"><ci id="S3.SS2.SSSx2.p1.3.m3.1.1.1.1.cmml" xref="S3.SS2.SSSx2.p1.3.m3.1.1.1.1">𝑙</ci><ci id="S3.SS2.SSSx2.p1.3.m3.2.2.2.2.cmml" xref="S3.SS2.SSSx2.p1.3.m3.2.2.2.2">𝑚</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSSx2.p1.3.m3.2c">\mathbf{P}_{l,m}</annotation></semantics></math> for <math id="S3.SS2.SSSx2.p1.4.m4.3" class="ltx_Math" alttext="l\in\{1,\cdots,L\}" display="inline"><semantics id="S3.SS2.SSSx2.p1.4.m4.3a"><mrow id="S3.SS2.SSSx2.p1.4.m4.3.4" xref="S3.SS2.SSSx2.p1.4.m4.3.4.cmml"><mi id="S3.SS2.SSSx2.p1.4.m4.3.4.2" xref="S3.SS2.SSSx2.p1.4.m4.3.4.2.cmml">l</mi><mo id="S3.SS2.SSSx2.p1.4.m4.3.4.1" xref="S3.SS2.SSSx2.p1.4.m4.3.4.1.cmml">∈</mo><mrow id="S3.SS2.SSSx2.p1.4.m4.3.4.3.2" xref="S3.SS2.SSSx2.p1.4.m4.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS2.SSSx2.p1.4.m4.3.4.3.2.1" xref="S3.SS2.SSSx2.p1.4.m4.3.4.3.1.cmml">{</mo><mn id="S3.SS2.SSSx2.p1.4.m4.1.1" xref="S3.SS2.SSSx2.p1.4.m4.1.1.cmml">1</mn><mo id="S3.SS2.SSSx2.p1.4.m4.3.4.3.2.2" xref="S3.SS2.SSSx2.p1.4.m4.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSSx2.p1.4.m4.2.2" xref="S3.SS2.SSSx2.p1.4.m4.2.2.cmml">⋯</mi><mo id="S3.SS2.SSSx2.p1.4.m4.3.4.3.2.3" xref="S3.SS2.SSSx2.p1.4.m4.3.4.3.1.cmml">,</mo><mi id="S3.SS2.SSSx2.p1.4.m4.3.3" xref="S3.SS2.SSSx2.p1.4.m4.3.3.cmml">L</mi><mo stretchy="false" id="S3.SS2.SSSx2.p1.4.m4.3.4.3.2.4" xref="S3.SS2.SSSx2.p1.4.m4.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSSx2.p1.4.m4.3b"><apply id="S3.SS2.SSSx2.p1.4.m4.3.4.cmml" xref="S3.SS2.SSSx2.p1.4.m4.3.4"><in id="S3.SS2.SSSx2.p1.4.m4.3.4.1.cmml" xref="S3.SS2.SSSx2.p1.4.m4.3.4.1"></in><ci id="S3.SS2.SSSx2.p1.4.m4.3.4.2.cmml" xref="S3.SS2.SSSx2.p1.4.m4.3.4.2">𝑙</ci><set id="S3.SS2.SSSx2.p1.4.m4.3.4.3.1.cmml" xref="S3.SS2.SSSx2.p1.4.m4.3.4.3.2"><cn type="integer" id="S3.SS2.SSSx2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSSx2.p1.4.m4.1.1">1</cn><ci id="S3.SS2.SSSx2.p1.4.m4.2.2.cmml" xref="S3.SS2.SSSx2.p1.4.m4.2.2">⋯</ci><ci id="S3.SS2.SSSx2.p1.4.m4.3.3.cmml" xref="S3.SS2.SSSx2.p1.4.m4.3.3">𝐿</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSSx2.p1.4.m4.3c">l\in\{1,\cdots,L\}</annotation></semantics></math> and <math id="S3.SS2.SSSx2.p1.5.m5.3" class="ltx_Math" alttext="m\in\{1,\cdots,M\}" display="inline"><semantics id="S3.SS2.SSSx2.p1.5.m5.3a"><mrow id="S3.SS2.SSSx2.p1.5.m5.3.4" xref="S3.SS2.SSSx2.p1.5.m5.3.4.cmml"><mi id="S3.SS2.SSSx2.p1.5.m5.3.4.2" xref="S3.SS2.SSSx2.p1.5.m5.3.4.2.cmml">m</mi><mo id="S3.SS2.SSSx2.p1.5.m5.3.4.1" xref="S3.SS2.SSSx2.p1.5.m5.3.4.1.cmml">∈</mo><mrow id="S3.SS2.SSSx2.p1.5.m5.3.4.3.2" xref="S3.SS2.SSSx2.p1.5.m5.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS2.SSSx2.p1.5.m5.3.4.3.2.1" xref="S3.SS2.SSSx2.p1.5.m5.3.4.3.1.cmml">{</mo><mn id="S3.SS2.SSSx2.p1.5.m5.1.1" xref="S3.SS2.SSSx2.p1.5.m5.1.1.cmml">1</mn><mo id="S3.SS2.SSSx2.p1.5.m5.3.4.3.2.2" xref="S3.SS2.SSSx2.p1.5.m5.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSSx2.p1.5.m5.2.2" xref="S3.SS2.SSSx2.p1.5.m5.2.2.cmml">⋯</mi><mo id="S3.SS2.SSSx2.p1.5.m5.3.4.3.2.3" xref="S3.SS2.SSSx2.p1.5.m5.3.4.3.1.cmml">,</mo><mi id="S3.SS2.SSSx2.p1.5.m5.3.3" xref="S3.SS2.SSSx2.p1.5.m5.3.3.cmml">M</mi><mo stretchy="false" id="S3.SS2.SSSx2.p1.5.m5.3.4.3.2.4" xref="S3.SS2.SSSx2.p1.5.m5.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSSx2.p1.5.m5.3b"><apply id="S3.SS2.SSSx2.p1.5.m5.3.4.cmml" xref="S3.SS2.SSSx2.p1.5.m5.3.4"><in id="S3.SS2.SSSx2.p1.5.m5.3.4.1.cmml" xref="S3.SS2.SSSx2.p1.5.m5.3.4.1"></in><ci id="S3.SS2.SSSx2.p1.5.m5.3.4.2.cmml" xref="S3.SS2.SSSx2.p1.5.m5.3.4.2">𝑚</ci><set id="S3.SS2.SSSx2.p1.5.m5.3.4.3.1.cmml" xref="S3.SS2.SSSx2.p1.5.m5.3.4.3.2"><cn type="integer" id="S3.SS2.SSSx2.p1.5.m5.1.1.cmml" xref="S3.SS2.SSSx2.p1.5.m5.1.1">1</cn><ci id="S3.SS2.SSSx2.p1.5.m5.2.2.cmml" xref="S3.SS2.SSSx2.p1.5.m5.2.2">⋯</ci><ci id="S3.SS2.SSSx2.p1.5.m5.3.3.cmml" xref="S3.SS2.SSSx2.p1.5.m5.3.3">𝑀</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSSx2.p1.5.m5.3c">m\in\{1,\cdots,M\}</annotation></semantics></math> is a binary gate that controls whether or not to execute the <math id="S3.SS2.SSSx2.p1.6.m6.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS2.SSSx2.p1.6.m6.1a"><mi id="S3.SS2.SSSx2.p1.6.m6.1.1" xref="S3.SS2.SSSx2.p1.6.m6.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSSx2.p1.6.m6.1b"><ci id="S3.SS2.SSSx2.p1.6.m6.1.1.cmml" xref="S3.SS2.SSSx2.p1.6.m6.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSSx2.p1.6.m6.1c">m</annotation></semantics></math>th module of the <math id="S3.SS2.SSSx2.p1.7.m7.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS2.SSSx2.p1.7.m7.1a"><mi id="S3.SS2.SSSx2.p1.7.m7.1.1" xref="S3.SS2.SSSx2.p1.7.m7.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSSx2.p1.7.m7.1b"><ci id="S3.SS2.SSSx2.p1.7.m7.1.1.cmml" xref="S3.SS2.SSSx2.p1.7.m7.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSSx2.p1.7.m7.1c">l</annotation></semantics></math>th layer. The output of the <math id="S3.SS2.SSSx2.p1.8.m8.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS2.SSSx2.p1.8.m8.1a"><mi id="S3.SS2.SSSx2.p1.8.m8.1.1" xref="S3.SS2.SSSx2.p1.8.m8.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSSx2.p1.8.m8.1b"><ci id="S3.SS2.SSSx2.p1.8.m8.1.1.cmml" xref="S3.SS2.SSSx2.p1.8.m8.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSSx2.p1.8.m8.1c">l</annotation></semantics></math>th layer <math id="S3.SS2.SSSx2.p1.9.m9.1" class="ltx_Math" alttext="\tilde{y}_{l}" display="inline"><semantics id="S3.SS2.SSSx2.p1.9.m9.1a"><msub id="S3.SS2.SSSx2.p1.9.m9.1.1" xref="S3.SS2.SSSx2.p1.9.m9.1.1.cmml"><mover accent="true" id="S3.SS2.SSSx2.p1.9.m9.1.1.2" xref="S3.SS2.SSSx2.p1.9.m9.1.1.2.cmml"><mi id="S3.SS2.SSSx2.p1.9.m9.1.1.2.2" xref="S3.SS2.SSSx2.p1.9.m9.1.1.2.2.cmml">y</mi><mo id="S3.SS2.SSSx2.p1.9.m9.1.1.2.1" xref="S3.SS2.SSSx2.p1.9.m9.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS2.SSSx2.p1.9.m9.1.1.3" xref="S3.SS2.SSSx2.p1.9.m9.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSSx2.p1.9.m9.1b"><apply id="S3.SS2.SSSx2.p1.9.m9.1.1.cmml" xref="S3.SS2.SSSx2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSSx2.p1.9.m9.1.1.1.cmml" xref="S3.SS2.SSSx2.p1.9.m9.1.1">subscript</csymbol><apply id="S3.SS2.SSSx2.p1.9.m9.1.1.2.cmml" xref="S3.SS2.SSSx2.p1.9.m9.1.1.2"><ci id="S3.SS2.SSSx2.p1.9.m9.1.1.2.1.cmml" xref="S3.SS2.SSSx2.p1.9.m9.1.1.2.1">~</ci><ci id="S3.SS2.SSSx2.p1.9.m9.1.1.2.2.cmml" xref="S3.SS2.SSSx2.p1.9.m9.1.1.2.2">𝑦</ci></apply><ci id="S3.SS2.SSSx2.p1.9.m9.1.1.3.cmml" xref="S3.SS2.SSSx2.p1.9.m9.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSSx2.p1.9.m9.1c">\tilde{y}_{l}</annotation></semantics></math> of modular routing architecture is now changed to:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.10" class="ltx_Math" alttext="\tilde{y}_{l}=\phi([\tilde{f}_{l,1}(\tilde{y}_{l-1};\theta_{l,1}),\cdots,\tilde{f}_{l,M}(\tilde{y}_{l-1};\theta_{l,M})])+\tilde{y}_{l-1}\\
" display="block"><semantics id="S3.E4.m1.10a"><mrow id="S3.E4.m1.10.10" xref="S3.E4.m1.10.10.cmml"><msub id="S3.E4.m1.10.10.3" xref="S3.E4.m1.10.10.3.cmml"><mover accent="true" id="S3.E4.m1.10.10.3.2" xref="S3.E4.m1.10.10.3.2.cmml"><mi id="S3.E4.m1.10.10.3.2.2" xref="S3.E4.m1.10.10.3.2.2.cmml">y</mi><mo id="S3.E4.m1.10.10.3.2.1" xref="S3.E4.m1.10.10.3.2.1.cmml">~</mo></mover><mi id="S3.E4.m1.10.10.3.3" xref="S3.E4.m1.10.10.3.3.cmml">l</mi></msub><mo id="S3.E4.m1.10.10.2" xref="S3.E4.m1.10.10.2.cmml">=</mo><mrow id="S3.E4.m1.10.10.1" xref="S3.E4.m1.10.10.1.cmml"><mrow id="S3.E4.m1.10.10.1.1" xref="S3.E4.m1.10.10.1.1.cmml"><mi id="S3.E4.m1.10.10.1.1.3" xref="S3.E4.m1.10.10.1.1.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.10.10.1.1.2" xref="S3.E4.m1.10.10.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.10.10.1.1.1.1" xref="S3.E4.m1.10.10.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.10.10.1.1.1.1.2" xref="S3.E4.m1.10.10.1.1.cmml">(</mo><mrow id="S3.E4.m1.10.10.1.1.1.1.1.2" xref="S3.E4.m1.10.10.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.E4.m1.10.10.1.1.1.1.1.2.3" xref="S3.E4.m1.10.10.1.1.1.1.1.3.cmml">[</mo><mrow id="S3.E4.m1.10.10.1.1.1.1.1.1.1" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.cmml"><msub id="S3.E4.m1.10.10.1.1.1.1.1.1.1.4" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.4.cmml"><mover accent="true" id="S3.E4.m1.10.10.1.1.1.1.1.1.1.4.2" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.4.2.cmml"><mi id="S3.E4.m1.10.10.1.1.1.1.1.1.1.4.2.2" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.4.2.2.cmml">f</mi><mo id="S3.E4.m1.10.10.1.1.1.1.1.1.1.4.2.1" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.4.2.1.cmml">~</mo></mover><mrow id="S3.E4.m1.2.2.2.4" xref="S3.E4.m1.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">l</mi><mo id="S3.E4.m1.2.2.2.4.1" xref="S3.E4.m1.2.2.2.3.cmml">,</mo><mn id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.2.cmml">1</mn></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.10.10.1.1.1.1.1.1.1.3" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S3.E4.m1.10.10.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.10.10.1.1.1.1.1.1.1.2.2.3" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.2.3.cmml">(</mo><msub id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mo id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mrow id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E4.m1.10.10.1.1.1.1.1.1.1.2.2.4" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.2.3.cmml">;</mo><msub id="S3.E4.m1.10.10.1.1.1.1.1.1.1.2.2.2" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E4.m1.10.10.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.2.2.2.2.cmml">θ</mi><mrow id="S3.E4.m1.4.4.2.4" xref="S3.E4.m1.4.4.2.3.cmml"><mi id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.1.cmml">l</mi><mo id="S3.E4.m1.4.4.2.4.1" xref="S3.E4.m1.4.4.2.3.cmml">,</mo><mn id="S3.E4.m1.4.4.2.2" xref="S3.E4.m1.4.4.2.2.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.E4.m1.10.10.1.1.1.1.1.1.1.2.2.5" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.10.10.1.1.1.1.1.2.4" xref="S3.E4.m1.10.10.1.1.1.1.1.3.cmml">,</mo><mi mathvariant="normal" id="S3.E4.m1.9.9" xref="S3.E4.m1.9.9.cmml">⋯</mi><mo id="S3.E4.m1.10.10.1.1.1.1.1.2.5" xref="S3.E4.m1.10.10.1.1.1.1.1.3.cmml">,</mo><mrow id="S3.E4.m1.10.10.1.1.1.1.1.2.2" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.cmml"><msub id="S3.E4.m1.10.10.1.1.1.1.1.2.2.4" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.4.cmml"><mover accent="true" id="S3.E4.m1.10.10.1.1.1.1.1.2.2.4.2" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.4.2.cmml"><mi id="S3.E4.m1.10.10.1.1.1.1.1.2.2.4.2.2" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.4.2.2.cmml">f</mi><mo id="S3.E4.m1.10.10.1.1.1.1.1.2.2.4.2.1" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.4.2.1.cmml">~</mo></mover><mrow id="S3.E4.m1.6.6.2.4" xref="S3.E4.m1.6.6.2.3.cmml"><mi id="S3.E4.m1.5.5.1.1" xref="S3.E4.m1.5.5.1.1.cmml">l</mi><mo id="S3.E4.m1.6.6.2.4.1" xref="S3.E4.m1.6.6.2.3.cmml">,</mo><mi id="S3.E4.m1.6.6.2.2" xref="S3.E4.m1.6.6.2.2.cmml">M</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.10.10.1.1.1.1.1.2.2.3" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.3.cmml">​</mo><mrow id="S3.E4.m1.10.10.1.1.1.1.1.2.2.2.2" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.10.10.1.1.1.1.1.2.2.2.2.3" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.2.3.cmml">(</mo><msub id="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.cmml"><mover accent="true" id="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.2" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.2.cmml"><mi id="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.2.2" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.2.2.cmml">y</mi><mo id="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.2.1" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.2.1.cmml">~</mo></mover><mrow id="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.3" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.cmml"><mi id="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.2" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.2.cmml">l</mi><mo id="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.1" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.1.cmml">−</mo><mn id="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.3" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E4.m1.10.10.1.1.1.1.1.2.2.2.2.4" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.2.3.cmml">;</mo><msub id="S3.E4.m1.10.10.1.1.1.1.1.2.2.2.2.2" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.2.2.2.cmml"><mi id="S3.E4.m1.10.10.1.1.1.1.1.2.2.2.2.2.2" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.2.2.2.2.cmml">θ</mi><mrow id="S3.E4.m1.8.8.2.4" xref="S3.E4.m1.8.8.2.3.cmml"><mi id="S3.E4.m1.7.7.1.1" xref="S3.E4.m1.7.7.1.1.cmml">l</mi><mo id="S3.E4.m1.8.8.2.4.1" xref="S3.E4.m1.8.8.2.3.cmml">,</mo><mi id="S3.E4.m1.8.8.2.2" xref="S3.E4.m1.8.8.2.2.cmml">M</mi></mrow></msub><mo stretchy="false" id="S3.E4.m1.10.10.1.1.1.1.1.2.2.2.2.5" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E4.m1.10.10.1.1.1.1.1.2.6" xref="S3.E4.m1.10.10.1.1.1.1.1.3.cmml">]</mo></mrow><mo stretchy="false" id="S3.E4.m1.10.10.1.1.1.1.3" xref="S3.E4.m1.10.10.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.10.10.1.2" xref="S3.E4.m1.10.10.1.2.cmml">+</mo><msub id="S3.E4.m1.10.10.1.3" xref="S3.E4.m1.10.10.1.3.cmml"><mover accent="true" id="S3.E4.m1.10.10.1.3.2" xref="S3.E4.m1.10.10.1.3.2.cmml"><mi id="S3.E4.m1.10.10.1.3.2.2" xref="S3.E4.m1.10.10.1.3.2.2.cmml">y</mi><mo id="S3.E4.m1.10.10.1.3.2.1" xref="S3.E4.m1.10.10.1.3.2.1.cmml">~</mo></mover><mrow id="S3.E4.m1.10.10.1.3.3" xref="S3.E4.m1.10.10.1.3.3.cmml"><mi id="S3.E4.m1.10.10.1.3.3.2" xref="S3.E4.m1.10.10.1.3.3.2.cmml">l</mi><mo id="S3.E4.m1.10.10.1.3.3.1" xref="S3.E4.m1.10.10.1.3.3.1.cmml">−</mo><mn id="S3.E4.m1.10.10.1.3.3.3" xref="S3.E4.m1.10.10.1.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.10b"><apply id="S3.E4.m1.10.10.cmml" xref="S3.E4.m1.10.10"><eq id="S3.E4.m1.10.10.2.cmml" xref="S3.E4.m1.10.10.2"></eq><apply id="S3.E4.m1.10.10.3.cmml" xref="S3.E4.m1.10.10.3"><csymbol cd="ambiguous" id="S3.E4.m1.10.10.3.1.cmml" xref="S3.E4.m1.10.10.3">subscript</csymbol><apply id="S3.E4.m1.10.10.3.2.cmml" xref="S3.E4.m1.10.10.3.2"><ci id="S3.E4.m1.10.10.3.2.1.cmml" xref="S3.E4.m1.10.10.3.2.1">~</ci><ci id="S3.E4.m1.10.10.3.2.2.cmml" xref="S3.E4.m1.10.10.3.2.2">𝑦</ci></apply><ci id="S3.E4.m1.10.10.3.3.cmml" xref="S3.E4.m1.10.10.3.3">𝑙</ci></apply><apply id="S3.E4.m1.10.10.1.cmml" xref="S3.E4.m1.10.10.1"><plus id="S3.E4.m1.10.10.1.2.cmml" xref="S3.E4.m1.10.10.1.2"></plus><apply id="S3.E4.m1.10.10.1.1.cmml" xref="S3.E4.m1.10.10.1.1"><times id="S3.E4.m1.10.10.1.1.2.cmml" xref="S3.E4.m1.10.10.1.1.2"></times><ci id="S3.E4.m1.10.10.1.1.3.cmml" xref="S3.E4.m1.10.10.1.1.3">italic-ϕ</ci><list id="S3.E4.m1.10.10.1.1.1.1.1.3.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.2"><apply id="S3.E4.m1.10.10.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1"><times id="S3.E4.m1.10.10.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.3"></times><apply id="S3.E4.m1.10.10.1.1.1.1.1.1.1.4.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.10.10.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.4">subscript</csymbol><apply id="S3.E4.m1.10.10.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.4.2"><ci id="S3.E4.m1.10.10.1.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.4.2.1">~</ci><ci id="S3.E4.m1.10.10.1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.4.2.2">𝑓</ci></apply><list id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.4"><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝑙</ci><cn type="integer" id="S3.E4.m1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2">1</cn></list></apply><list id="S3.E4.m1.10.10.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.2.2"><apply id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.2"><ci id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.1">~</ci><ci id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.2">𝑦</ci></apply><apply id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.3"><minus id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2">𝑙</ci><cn type="integer" id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E4.m1.10.10.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.10.10.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E4.m1.10.10.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.2.2.2.2">𝜃</ci><list id="S3.E4.m1.4.4.2.3.cmml" xref="S3.E4.m1.4.4.2.4"><ci id="S3.E4.m1.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1.1">𝑙</ci><cn type="integer" id="S3.E4.m1.4.4.2.2.cmml" xref="S3.E4.m1.4.4.2.2">1</cn></list></apply></list></apply><ci id="S3.E4.m1.9.9.cmml" xref="S3.E4.m1.9.9">⋯</ci><apply id="S3.E4.m1.10.10.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2"><times id="S3.E4.m1.10.10.1.1.1.1.1.2.2.3.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.3"></times><apply id="S3.E4.m1.10.10.1.1.1.1.1.2.2.4.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.4"><csymbol cd="ambiguous" id="S3.E4.m1.10.10.1.1.1.1.1.2.2.4.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.4">subscript</csymbol><apply id="S3.E4.m1.10.10.1.1.1.1.1.2.2.4.2.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.4.2"><ci id="S3.E4.m1.10.10.1.1.1.1.1.2.2.4.2.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.4.2.1">~</ci><ci id="S3.E4.m1.10.10.1.1.1.1.1.2.2.4.2.2.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.4.2.2">𝑓</ci></apply><list id="S3.E4.m1.6.6.2.3.cmml" xref="S3.E4.m1.6.6.2.4"><ci id="S3.E4.m1.5.5.1.1.cmml" xref="S3.E4.m1.5.5.1.1">𝑙</ci><ci id="S3.E4.m1.6.6.2.2.cmml" xref="S3.E4.m1.6.6.2.2">𝑀</ci></list></apply><list id="S3.E4.m1.10.10.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.2.2"><apply id="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1">subscript</csymbol><apply id="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.2.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.2"><ci id="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.2.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.2.1">~</ci><ci id="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.2.2.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.2.2">𝑦</ci></apply><apply id="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.3"><minus id="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.1"></minus><ci id="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.2.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.2">𝑙</ci><cn type="integer" id="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.3.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E4.m1.10.10.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.10.10.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.E4.m1.10.10.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.2.2.2.2.2.2">𝜃</ci><list id="S3.E4.m1.8.8.2.3.cmml" xref="S3.E4.m1.8.8.2.4"><ci id="S3.E4.m1.7.7.1.1.cmml" xref="S3.E4.m1.7.7.1.1">𝑙</ci><ci id="S3.E4.m1.8.8.2.2.cmml" xref="S3.E4.m1.8.8.2.2">𝑀</ci></list></apply></list></apply></list></apply><apply id="S3.E4.m1.10.10.1.3.cmml" xref="S3.E4.m1.10.10.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.10.10.1.3.1.cmml" xref="S3.E4.m1.10.10.1.3">subscript</csymbol><apply id="S3.E4.m1.10.10.1.3.2.cmml" xref="S3.E4.m1.10.10.1.3.2"><ci id="S3.E4.m1.10.10.1.3.2.1.cmml" xref="S3.E4.m1.10.10.1.3.2.1">~</ci><ci id="S3.E4.m1.10.10.1.3.2.2.cmml" xref="S3.E4.m1.10.10.1.3.2.2">𝑦</ci></apply><apply id="S3.E4.m1.10.10.1.3.3.cmml" xref="S3.E4.m1.10.10.1.3.3"><minus id="S3.E4.m1.10.10.1.3.3.1.cmml" xref="S3.E4.m1.10.10.1.3.3.1"></minus><ci id="S3.E4.m1.10.10.1.3.3.2.cmml" xref="S3.E4.m1.10.10.1.3.3.2">𝑙</ci><cn type="integer" id="S3.E4.m1.10.10.1.3.3.3.cmml" xref="S3.E4.m1.10.10.1.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.10c">\tilde{y}_{l}=\phi([\tilde{f}_{l,1}(\tilde{y}_{l-1};\theta_{l,1}),\cdots,\tilde{f}_{l,M}(\tilde{y}_{l-1};\theta_{l,M})])+\tilde{y}_{l-1}\\
</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSSx2.p1.11" class="ltx_p">where <math id="S3.SS2.SSSx2.p1.10.m1.14" class="ltx_Math" alttext="\tilde{f}_{l,m}(\tilde{y}_{l-1};\theta_{l,m})=\mathbf{P}_{l,m}\cdot f_{l,m}(\tilde{y}_{l-1};\theta_{l,m})" display="inline"><semantics id="S3.SS2.SSSx2.p1.10.m1.14a"><mrow id="S3.SS2.SSSx2.p1.10.m1.14.14" xref="S3.SS2.SSSx2.p1.10.m1.14.14.cmml"><mrow id="S3.SS2.SSSx2.p1.10.m1.12.12.2" xref="S3.SS2.SSSx2.p1.10.m1.12.12.2.cmml"><msub id="S3.SS2.SSSx2.p1.10.m1.12.12.2.4" xref="S3.SS2.SSSx2.p1.10.m1.12.12.2.4.cmml"><mover accent="true" id="S3.SS2.SSSx2.p1.10.m1.12.12.2.4.2" xref="S3.SS2.SSSx2.p1.10.m1.12.12.2.4.2.cmml"><mi id="S3.SS2.SSSx2.p1.10.m1.12.12.2.4.2.2" xref="S3.SS2.SSSx2.p1.10.m1.12.12.2.4.2.2.cmml">f</mi><mo id="S3.SS2.SSSx2.p1.10.m1.12.12.2.4.2.1" xref="S3.SS2.SSSx2.p1.10.m1.12.12.2.4.2.1.cmml">~</mo></mover><mrow id="S3.SS2.SSSx2.p1.10.m1.2.2.2.4" xref="S3.SS2.SSSx2.p1.10.m1.2.2.2.3.cmml"><mi id="S3.SS2.SSSx2.p1.10.m1.1.1.1.1" xref="S3.SS2.SSSx2.p1.10.m1.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSSx2.p1.10.m1.2.2.2.4.1" xref="S3.SS2.SSSx2.p1.10.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS2.SSSx2.p1.10.m1.2.2.2.2" xref="S3.SS2.SSSx2.p1.10.m1.2.2.2.2.cmml">m</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSSx2.p1.10.m1.12.12.2.3" xref="S3.SS2.SSSx2.p1.10.m1.12.12.2.3.cmml">​</mo><mrow id="S3.SS2.SSSx2.p1.10.m1.12.12.2.2.2" xref="S3.SS2.SSSx2.p1.10.m1.12.12.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.SSSx2.p1.10.m1.12.12.2.2.2.3" xref="S3.SS2.SSSx2.p1.10.m1.12.12.2.2.3.cmml">(</mo><msub id="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1" xref="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.cmml"><mover accent="true" id="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.2" xref="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.2.cmml"><mi id="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.2.2" xref="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.2.2.cmml">y</mi><mo id="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.2.1" xref="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.2.1.cmml">~</mo></mover><mrow id="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.3" xref="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.3.cmml"><mi id="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.3.2" xref="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.3.2.cmml">l</mi><mo id="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.3.1" xref="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.3.1.cmml">−</mo><mn id="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.3.3" xref="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS2.SSSx2.p1.10.m1.12.12.2.2.2.4" xref="S3.SS2.SSSx2.p1.10.m1.12.12.2.2.3.cmml">;</mo><msub id="S3.SS2.SSSx2.p1.10.m1.12.12.2.2.2.2" xref="S3.SS2.SSSx2.p1.10.m1.12.12.2.2.2.2.cmml"><mi id="S3.SS2.SSSx2.p1.10.m1.12.12.2.2.2.2.2" xref="S3.SS2.SSSx2.p1.10.m1.12.12.2.2.2.2.2.cmml">θ</mi><mrow id="S3.SS2.SSSx2.p1.10.m1.4.4.2.4" xref="S3.SS2.SSSx2.p1.10.m1.4.4.2.3.cmml"><mi id="S3.SS2.SSSx2.p1.10.m1.3.3.1.1" xref="S3.SS2.SSSx2.p1.10.m1.3.3.1.1.cmml">l</mi><mo id="S3.SS2.SSSx2.p1.10.m1.4.4.2.4.1" xref="S3.SS2.SSSx2.p1.10.m1.4.4.2.3.cmml">,</mo><mi id="S3.SS2.SSSx2.p1.10.m1.4.4.2.2" xref="S3.SS2.SSSx2.p1.10.m1.4.4.2.2.cmml">m</mi></mrow></msub><mo stretchy="false" id="S3.SS2.SSSx2.p1.10.m1.12.12.2.2.2.5" xref="S3.SS2.SSSx2.p1.10.m1.12.12.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSSx2.p1.10.m1.14.14.5" xref="S3.SS2.SSSx2.p1.10.m1.14.14.5.cmml">=</mo><mrow id="S3.SS2.SSSx2.p1.10.m1.14.14.4" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4.cmml"><mrow id="S3.SS2.SSSx2.p1.10.m1.14.14.4.4" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4.4.cmml"><msub id="S3.SS2.SSSx2.p1.10.m1.14.14.4.4.2" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4.4.2.cmml"><mi id="S3.SS2.SSSx2.p1.10.m1.14.14.4.4.2.2" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4.4.2.2.cmml">𝐏</mi><mrow id="S3.SS2.SSSx2.p1.10.m1.6.6.2.4" xref="S3.SS2.SSSx2.p1.10.m1.6.6.2.3.cmml"><mi id="S3.SS2.SSSx2.p1.10.m1.5.5.1.1" xref="S3.SS2.SSSx2.p1.10.m1.5.5.1.1.cmml">l</mi><mo id="S3.SS2.SSSx2.p1.10.m1.6.6.2.4.1" xref="S3.SS2.SSSx2.p1.10.m1.6.6.2.3.cmml">,</mo><mi id="S3.SS2.SSSx2.p1.10.m1.6.6.2.2" xref="S3.SS2.SSSx2.p1.10.m1.6.6.2.2.cmml">m</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSSx2.p1.10.m1.14.14.4.4.1" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4.4.1.cmml">⋅</mo><msub id="S3.SS2.SSSx2.p1.10.m1.14.14.4.4.3" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4.4.3.cmml"><mi id="S3.SS2.SSSx2.p1.10.m1.14.14.4.4.3.2" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4.4.3.2.cmml">f</mi><mrow id="S3.SS2.SSSx2.p1.10.m1.8.8.2.4" xref="S3.SS2.SSSx2.p1.10.m1.8.8.2.3.cmml"><mi id="S3.SS2.SSSx2.p1.10.m1.7.7.1.1" xref="S3.SS2.SSSx2.p1.10.m1.7.7.1.1.cmml">l</mi><mo id="S3.SS2.SSSx2.p1.10.m1.8.8.2.4.1" xref="S3.SS2.SSSx2.p1.10.m1.8.8.2.3.cmml">,</mo><mi id="S3.SS2.SSSx2.p1.10.m1.8.8.2.2" xref="S3.SS2.SSSx2.p1.10.m1.8.8.2.2.cmml">m</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S3.SS2.SSSx2.p1.10.m1.14.14.4.3" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4.3.cmml">​</mo><mrow id="S3.SS2.SSSx2.p1.10.m1.14.14.4.2.2" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4.2.3.cmml"><mo stretchy="false" id="S3.SS2.SSSx2.p1.10.m1.14.14.4.2.2.3" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4.2.3.cmml">(</mo><msub id="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1" xref="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.cmml"><mover accent="true" id="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.2" xref="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.2.cmml"><mi id="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.2.2" xref="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.2.2.cmml">y</mi><mo id="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.2.1" xref="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.2.1.cmml">~</mo></mover><mrow id="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.3" xref="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.3.cmml"><mi id="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.3.2" xref="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.3.2.cmml">l</mi><mo id="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.3.1" xref="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.3.1.cmml">−</mo><mn id="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.3.3" xref="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS2.SSSx2.p1.10.m1.14.14.4.2.2.4" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4.2.3.cmml">;</mo><msub id="S3.SS2.SSSx2.p1.10.m1.14.14.4.2.2.2" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4.2.2.2.cmml"><mi id="S3.SS2.SSSx2.p1.10.m1.14.14.4.2.2.2.2" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4.2.2.2.2.cmml">θ</mi><mrow id="S3.SS2.SSSx2.p1.10.m1.10.10.2.4" xref="S3.SS2.SSSx2.p1.10.m1.10.10.2.3.cmml"><mi id="S3.SS2.SSSx2.p1.10.m1.9.9.1.1" xref="S3.SS2.SSSx2.p1.10.m1.9.9.1.1.cmml">l</mi><mo id="S3.SS2.SSSx2.p1.10.m1.10.10.2.4.1" xref="S3.SS2.SSSx2.p1.10.m1.10.10.2.3.cmml">,</mo><mi id="S3.SS2.SSSx2.p1.10.m1.10.10.2.2" xref="S3.SS2.SSSx2.p1.10.m1.10.10.2.2.cmml">m</mi></mrow></msub><mo stretchy="false" id="S3.SS2.SSSx2.p1.10.m1.14.14.4.2.2.5" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSSx2.p1.10.m1.14b"><apply id="S3.SS2.SSSx2.p1.10.m1.14.14.cmml" xref="S3.SS2.SSSx2.p1.10.m1.14.14"><eq id="S3.SS2.SSSx2.p1.10.m1.14.14.5.cmml" xref="S3.SS2.SSSx2.p1.10.m1.14.14.5"></eq><apply id="S3.SS2.SSSx2.p1.10.m1.12.12.2.cmml" xref="S3.SS2.SSSx2.p1.10.m1.12.12.2"><times id="S3.SS2.SSSx2.p1.10.m1.12.12.2.3.cmml" xref="S3.SS2.SSSx2.p1.10.m1.12.12.2.3"></times><apply id="S3.SS2.SSSx2.p1.10.m1.12.12.2.4.cmml" xref="S3.SS2.SSSx2.p1.10.m1.12.12.2.4"><csymbol cd="ambiguous" id="S3.SS2.SSSx2.p1.10.m1.12.12.2.4.1.cmml" xref="S3.SS2.SSSx2.p1.10.m1.12.12.2.4">subscript</csymbol><apply id="S3.SS2.SSSx2.p1.10.m1.12.12.2.4.2.cmml" xref="S3.SS2.SSSx2.p1.10.m1.12.12.2.4.2"><ci id="S3.SS2.SSSx2.p1.10.m1.12.12.2.4.2.1.cmml" xref="S3.SS2.SSSx2.p1.10.m1.12.12.2.4.2.1">~</ci><ci id="S3.SS2.SSSx2.p1.10.m1.12.12.2.4.2.2.cmml" xref="S3.SS2.SSSx2.p1.10.m1.12.12.2.4.2.2">𝑓</ci></apply><list id="S3.SS2.SSSx2.p1.10.m1.2.2.2.3.cmml" xref="S3.SS2.SSSx2.p1.10.m1.2.2.2.4"><ci id="S3.SS2.SSSx2.p1.10.m1.1.1.1.1.cmml" xref="S3.SS2.SSSx2.p1.10.m1.1.1.1.1">𝑙</ci><ci id="S3.SS2.SSSx2.p1.10.m1.2.2.2.2.cmml" xref="S3.SS2.SSSx2.p1.10.m1.2.2.2.2">𝑚</ci></list></apply><list id="S3.SS2.SSSx2.p1.10.m1.12.12.2.2.3.cmml" xref="S3.SS2.SSSx2.p1.10.m1.12.12.2.2.2"><apply id="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.cmml" xref="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.1.cmml" xref="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1">subscript</csymbol><apply id="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.2.cmml" xref="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.2"><ci id="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.2.1.cmml" xref="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.2.1">~</ci><ci id="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.2.2.cmml" xref="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.2.2">𝑦</ci></apply><apply id="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.3.cmml" xref="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.3"><minus id="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.3.1.cmml" xref="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.3.1"></minus><ci id="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.3.2.cmml" xref="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.3.2">𝑙</ci><cn type="integer" id="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.3.3.cmml" xref="S3.SS2.SSSx2.p1.10.m1.11.11.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS2.SSSx2.p1.10.m1.12.12.2.2.2.2.cmml" xref="S3.SS2.SSSx2.p1.10.m1.12.12.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSSx2.p1.10.m1.12.12.2.2.2.2.1.cmml" xref="S3.SS2.SSSx2.p1.10.m1.12.12.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSSx2.p1.10.m1.12.12.2.2.2.2.2.cmml" xref="S3.SS2.SSSx2.p1.10.m1.12.12.2.2.2.2.2">𝜃</ci><list id="S3.SS2.SSSx2.p1.10.m1.4.4.2.3.cmml" xref="S3.SS2.SSSx2.p1.10.m1.4.4.2.4"><ci id="S3.SS2.SSSx2.p1.10.m1.3.3.1.1.cmml" xref="S3.SS2.SSSx2.p1.10.m1.3.3.1.1">𝑙</ci><ci id="S3.SS2.SSSx2.p1.10.m1.4.4.2.2.cmml" xref="S3.SS2.SSSx2.p1.10.m1.4.4.2.2">𝑚</ci></list></apply></list></apply><apply id="S3.SS2.SSSx2.p1.10.m1.14.14.4.cmml" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4"><times id="S3.SS2.SSSx2.p1.10.m1.14.14.4.3.cmml" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4.3"></times><apply id="S3.SS2.SSSx2.p1.10.m1.14.14.4.4.cmml" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4.4"><ci id="S3.SS2.SSSx2.p1.10.m1.14.14.4.4.1.cmml" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4.4.1">⋅</ci><apply id="S3.SS2.SSSx2.p1.10.m1.14.14.4.4.2.cmml" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4.4.2"><csymbol cd="ambiguous" id="S3.SS2.SSSx2.p1.10.m1.14.14.4.4.2.1.cmml" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4.4.2">subscript</csymbol><ci id="S3.SS2.SSSx2.p1.10.m1.14.14.4.4.2.2.cmml" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4.4.2.2">𝐏</ci><list id="S3.SS2.SSSx2.p1.10.m1.6.6.2.3.cmml" xref="S3.SS2.SSSx2.p1.10.m1.6.6.2.4"><ci id="S3.SS2.SSSx2.p1.10.m1.5.5.1.1.cmml" xref="S3.SS2.SSSx2.p1.10.m1.5.5.1.1">𝑙</ci><ci id="S3.SS2.SSSx2.p1.10.m1.6.6.2.2.cmml" xref="S3.SS2.SSSx2.p1.10.m1.6.6.2.2">𝑚</ci></list></apply><apply id="S3.SS2.SSSx2.p1.10.m1.14.14.4.4.3.cmml" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4.4.3"><csymbol cd="ambiguous" id="S3.SS2.SSSx2.p1.10.m1.14.14.4.4.3.1.cmml" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4.4.3">subscript</csymbol><ci id="S3.SS2.SSSx2.p1.10.m1.14.14.4.4.3.2.cmml" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4.4.3.2">𝑓</ci><list id="S3.SS2.SSSx2.p1.10.m1.8.8.2.3.cmml" xref="S3.SS2.SSSx2.p1.10.m1.8.8.2.4"><ci id="S3.SS2.SSSx2.p1.10.m1.7.7.1.1.cmml" xref="S3.SS2.SSSx2.p1.10.m1.7.7.1.1">𝑙</ci><ci id="S3.SS2.SSSx2.p1.10.m1.8.8.2.2.cmml" xref="S3.SS2.SSSx2.p1.10.m1.8.8.2.2">𝑚</ci></list></apply></apply><list id="S3.SS2.SSSx2.p1.10.m1.14.14.4.2.3.cmml" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4.2.2"><apply id="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.cmml" xref="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.1.cmml" xref="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1">subscript</csymbol><apply id="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.2.cmml" xref="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.2"><ci id="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.2.1.cmml" xref="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.2.1">~</ci><ci id="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.2.2.cmml" xref="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.2.2">𝑦</ci></apply><apply id="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.3.cmml" xref="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.3"><minus id="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.3.1.cmml" xref="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.3.1"></minus><ci id="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.3.2.cmml" xref="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.3.2">𝑙</ci><cn type="integer" id="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.3.3.cmml" xref="S3.SS2.SSSx2.p1.10.m1.13.13.3.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS2.SSSx2.p1.10.m1.14.14.4.2.2.2.cmml" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSSx2.p1.10.m1.14.14.4.2.2.2.1.cmml" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4.2.2.2">subscript</csymbol><ci id="S3.SS2.SSSx2.p1.10.m1.14.14.4.2.2.2.2.cmml" xref="S3.SS2.SSSx2.p1.10.m1.14.14.4.2.2.2.2">𝜃</ci><list id="S3.SS2.SSSx2.p1.10.m1.10.10.2.3.cmml" xref="S3.SS2.SSSx2.p1.10.m1.10.10.2.4"><ci id="S3.SS2.SSSx2.p1.10.m1.9.9.1.1.cmml" xref="S3.SS2.SSSx2.p1.10.m1.9.9.1.1">𝑙</ci><ci id="S3.SS2.SSSx2.p1.10.m1.10.10.2.2.cmml" xref="S3.SS2.SSSx2.p1.10.m1.10.10.2.2">𝑚</ci></list></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSSx2.p1.10.m1.14c">\tilde{f}_{l,m}(\tilde{y}_{l-1};\theta_{l,m})=\mathbf{P}_{l,m}\cdot f_{l,m}(\tilde{y}_{l-1};\theta_{l,m})</annotation></semantics></math>.
Due to the discrete nature of <math id="S3.SS2.SSSx2.p1.11.m2.1" class="ltx_Math" alttext="\mathbf{P}" display="inline"><semantics id="S3.SS2.SSSx2.p1.11.m2.1a"><mi id="S3.SS2.SSSx2.p1.11.m2.1.1" xref="S3.SS2.SSSx2.p1.11.m2.1.1.cmml">𝐏</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSSx2.p1.11.m2.1b"><ci id="S3.SS2.SSSx2.p1.11.m2.1.1.cmml" xref="S3.SS2.SSSx2.p1.11.m2.1.1">𝐏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSSx2.p1.11.m2.1c">\mathbf{P}</annotation></semantics></math>, the gradient backpropagation algorithm cannot be applied here, we will use some tricks to make the whole model differentiable and the details will be discussed in section <a href="#S3.SS3" title="3.3 Routing Network ‣ 3 METHODOLOGY ‣ Question Guided Modular Routing Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>.</p>
</div>
</section>
<section id="S3.SS2.SSSx3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">FRN and BRN</h4>

<div id="S3.SS2.SSSx3.p1" class="ltx_para">
<p id="S3.SS2.SSSx3.p1.1" class="ltx_p">As we claimed before, with the introduced modular routing architecture, different models can be realized by changing the granularity of the module. Here we introduce two kinds of special cases that are easy to implement.
<br class="ltx_break"><span id="S3.SS2.SSSx3.p1.1.1" class="ltx_text ltx_font_bold">FRN: </span>when the routed module is the filter in a convolutional layer, we call it FRN. Note that the FRN can be plugged into any modern CNN, we applied it to the current popular ResNet for convenience. More specifically, we route the last convolutional layer of each <span id="S3.SS2.SSSx3.p1.1.2" class="ltx_text ltx_font_italic">residual block</span>.
<br class="ltx_break"><span id="S3.SS2.SSSx3.p1.1.3" class="ltx_text ltx_font_bold">BRN: </span>when the routed module is the branch of a multi-branch network, we call it BRN. The BRN can be plugged into any multi-branch convolutional networks. In this paper, we test the BRN under the ResNext model.</p>
</div>
</section>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Routing Network</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.8" class="ltx_p">As we claimed before, RNET aims to compute the binary gates conditioned on the question features. First, we temporarily ignore the fact that the routing path is discrete for simplicity, All we need is a fully connected layer <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="\text{fc}:\mathbb{R}^{h}\rightarrow\mathbb{R}^{L\times M}" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mrow id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mtext id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2a.cmml">fc</mtext><mo lspace="0.278em" rspace="0.278em" id="S3.SS3.p1.1.m1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.cmml">:</mo><mrow id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml"><msup id="S3.SS3.p1.1.m1.1.1.3.2" xref="S3.SS3.p1.1.m1.1.1.3.2.cmml"><mi id="S3.SS3.p1.1.m1.1.1.3.2.2" xref="S3.SS3.p1.1.m1.1.1.3.2.2.cmml">ℝ</mi><mi id="S3.SS3.p1.1.m1.1.1.3.2.3" xref="S3.SS3.p1.1.m1.1.1.3.2.3.cmml">h</mi></msup><mo stretchy="false" id="S3.SS3.p1.1.m1.1.1.3.1" xref="S3.SS3.p1.1.m1.1.1.3.1.cmml">→</mo><msup id="S3.SS3.p1.1.m1.1.1.3.3" xref="S3.SS3.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS3.p1.1.m1.1.1.3.3.2" xref="S3.SS3.p1.1.m1.1.1.3.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p1.1.m1.1.1.3.3.3" xref="S3.SS3.p1.1.m1.1.1.3.3.3.cmml"><mi id="S3.SS3.p1.1.m1.1.1.3.3.3.2" xref="S3.SS3.p1.1.m1.1.1.3.3.3.2.cmml">L</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.1.m1.1.1.3.3.3.1" xref="S3.SS3.p1.1.m1.1.1.3.3.3.1.cmml">×</mo><mi id="S3.SS3.p1.1.m1.1.1.3.3.3.3" xref="S3.SS3.p1.1.m1.1.1.3.3.3.3.cmml">M</mi></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><ci id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1">:</ci><ci id="S3.SS3.p1.1.m1.1.1.2a.cmml" xref="S3.SS3.p1.1.m1.1.1.2"><mtext id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">fc</mtext></ci><apply id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3"><ci id="S3.SS3.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.p1.1.m1.1.1.3.1">→</ci><apply id="S3.SS3.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.p1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.3.2.1.cmml" xref="S3.SS3.p1.1.m1.1.1.3.2">superscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.3.2.2.cmml" xref="S3.SS3.p1.1.m1.1.1.3.2.2">ℝ</ci><ci id="S3.SS3.p1.1.m1.1.1.3.2.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3.2.3">ℎ</ci></apply><apply id="S3.SS3.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS3.p1.1.m1.1.1.3.3">superscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS3.p1.1.m1.1.1.3.3.2">ℝ</ci><apply id="S3.SS3.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3.3.3"><times id="S3.SS3.p1.1.m1.1.1.3.3.3.1.cmml" xref="S3.SS3.p1.1.m1.1.1.3.3.3.1"></times><ci id="S3.SS3.p1.1.m1.1.1.3.3.3.2.cmml" xref="S3.SS3.p1.1.m1.1.1.3.3.3.2">𝐿</ci><ci id="S3.SS3.p1.1.m1.1.1.3.3.3.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3.3.3.3">𝑀</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\text{fc}:\mathbb{R}^{h}\rightarrow\mathbb{R}^{L\times M}</annotation></semantics></math> to map the question features to a <span id="S3.SS3.p1.8.1" class="ltx_text ltx_font_italic">real-valued</span> routing path <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{\tilde{P}}=\text{fc}(\mathbf{q})" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mrow id="S3.SS3.p1.2.m2.1.2" xref="S3.SS3.p1.2.m2.1.2.cmml"><mover accent="true" id="S3.SS3.p1.2.m2.1.2.2" xref="S3.SS3.p1.2.m2.1.2.2.cmml"><mi id="S3.SS3.p1.2.m2.1.2.2.2" xref="S3.SS3.p1.2.m2.1.2.2.2.cmml">𝐏</mi><mo id="S3.SS3.p1.2.m2.1.2.2.1" xref="S3.SS3.p1.2.m2.1.2.2.1.cmml">~</mo></mover><mo id="S3.SS3.p1.2.m2.1.2.1" xref="S3.SS3.p1.2.m2.1.2.1.cmml">=</mo><mrow id="S3.SS3.p1.2.m2.1.2.3" xref="S3.SS3.p1.2.m2.1.2.3.cmml"><mtext id="S3.SS3.p1.2.m2.1.2.3.2" xref="S3.SS3.p1.2.m2.1.2.3.2a.cmml">fc</mtext><mo lspace="0em" rspace="0em" id="S3.SS3.p1.2.m2.1.2.3.1" xref="S3.SS3.p1.2.m2.1.2.3.1.cmml">​</mo><mrow id="S3.SS3.p1.2.m2.1.2.3.3.2" xref="S3.SS3.p1.2.m2.1.2.3.cmml"><mo stretchy="false" id="S3.SS3.p1.2.m2.1.2.3.3.2.1" xref="S3.SS3.p1.2.m2.1.2.3.cmml">(</mo><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">𝐪</mi><mo stretchy="false" id="S3.SS3.p1.2.m2.1.2.3.3.2.2" xref="S3.SS3.p1.2.m2.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.2.cmml" xref="S3.SS3.p1.2.m2.1.2"><eq id="S3.SS3.p1.2.m2.1.2.1.cmml" xref="S3.SS3.p1.2.m2.1.2.1"></eq><apply id="S3.SS3.p1.2.m2.1.2.2.cmml" xref="S3.SS3.p1.2.m2.1.2.2"><ci id="S3.SS3.p1.2.m2.1.2.2.1.cmml" xref="S3.SS3.p1.2.m2.1.2.2.1">~</ci><ci id="S3.SS3.p1.2.m2.1.2.2.2.cmml" xref="S3.SS3.p1.2.m2.1.2.2.2">𝐏</ci></apply><apply id="S3.SS3.p1.2.m2.1.2.3.cmml" xref="S3.SS3.p1.2.m2.1.2.3"><times id="S3.SS3.p1.2.m2.1.2.3.1.cmml" xref="S3.SS3.p1.2.m2.1.2.3.1"></times><ci id="S3.SS3.p1.2.m2.1.2.3.2a.cmml" xref="S3.SS3.p1.2.m2.1.2.3.2"><mtext id="S3.SS3.p1.2.m2.1.2.3.2.cmml" xref="S3.SS3.p1.2.m2.1.2.3.2">fc</mtext></ci><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝐪</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">\mathbf{\tilde{P}}=\text{fc}(\mathbf{q})</annotation></semantics></math>. Now take into account the nature of the discrete, a naive attempt would be thresholding <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{\tilde{P}}" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><mover accent="true" id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">𝐏</mi><mo id="S3.SS3.p1.3.m3.1.1.1" xref="S3.SS3.p1.3.m3.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><ci id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1.1">~</ci><ci id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">𝐏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">\mathbf{\tilde{P}}</annotation></semantics></math> into <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><mn id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><cn type="integer" id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">1</annotation></semantics></math>s and <math id="S3.SS3.p1.5.m5.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S3.SS3.p1.5.m5.1a"><mn id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><cn type="integer" id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">0</cn></annotation-xml></semantics></math>s, but unfortunately, it is not differentiable and the backpropagation algorithm cannot be applied. Also note that the threshold function is deterministic, in order to explore more possible paths, the generation of routing path will better to be stochastic. Based on the above considerations, <span id="S3.SS3.p1.8.2" class="ltx_text ltx_font_italic">i.e.,</span> <span id="S3.SS3.p1.8.3" class="ltx_text ltx_font_bold">discrete</span> and <span id="S3.SS3.p1.8.4" class="ltx_text ltx_font_bold">stochastic</span>, we let the routing path <math id="S3.SS3.p1.6.m6.1" class="ltx_Math" alttext="\mathbf{P}" display="inline"><semantics id="S3.SS3.p1.6.m6.1a"><mi id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml">𝐏</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><ci id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">𝐏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">\mathbf{P}</annotation></semantics></math> follows a <math id="S3.SS3.p1.7.m7.1" class="ltx_Math" alttext="L\times M" display="inline"><semantics id="S3.SS3.p1.7.m7.1a"><mrow id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml"><mi id="S3.SS3.p1.7.m7.1.1.2" xref="S3.SS3.p1.7.m7.1.1.2.cmml">L</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.7.m7.1.1.1" xref="S3.SS3.p1.7.m7.1.1.1.cmml">×</mo><mi id="S3.SS3.p1.7.m7.1.1.3" xref="S3.SS3.p1.7.m7.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><apply id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1"><times id="S3.SS3.p1.7.m7.1.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1.1"></times><ci id="S3.SS3.p1.7.m7.1.1.2.cmml" xref="S3.SS3.p1.7.m7.1.1.2">𝐿</ci><ci id="S3.SS3.p1.7.m7.1.1.3.cmml" xref="S3.SS3.p1.7.m7.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">L\times M</annotation></semantics></math>-dimensional Bernoulli distribution whose parameter <math id="S3.SS3.p1.8.m8.2" class="ltx_Math" alttext="\mathbf{s}\in[0,1]^{L\times M}" display="inline"><semantics id="S3.SS3.p1.8.m8.2a"><mrow id="S3.SS3.p1.8.m8.2.3" xref="S3.SS3.p1.8.m8.2.3.cmml"><mi id="S3.SS3.p1.8.m8.2.3.2" xref="S3.SS3.p1.8.m8.2.3.2.cmml">𝐬</mi><mo id="S3.SS3.p1.8.m8.2.3.1" xref="S3.SS3.p1.8.m8.2.3.1.cmml">∈</mo><msup id="S3.SS3.p1.8.m8.2.3.3" xref="S3.SS3.p1.8.m8.2.3.3.cmml"><mrow id="S3.SS3.p1.8.m8.2.3.3.2.2" xref="S3.SS3.p1.8.m8.2.3.3.2.1.cmml"><mo stretchy="false" id="S3.SS3.p1.8.m8.2.3.3.2.2.1" xref="S3.SS3.p1.8.m8.2.3.3.2.1.cmml">[</mo><mn id="S3.SS3.p1.8.m8.1.1" xref="S3.SS3.p1.8.m8.1.1.cmml">0</mn><mo id="S3.SS3.p1.8.m8.2.3.3.2.2.2" xref="S3.SS3.p1.8.m8.2.3.3.2.1.cmml">,</mo><mn id="S3.SS3.p1.8.m8.2.2" xref="S3.SS3.p1.8.m8.2.2.cmml">1</mn><mo stretchy="false" id="S3.SS3.p1.8.m8.2.3.3.2.2.3" xref="S3.SS3.p1.8.m8.2.3.3.2.1.cmml">]</mo></mrow><mrow id="S3.SS3.p1.8.m8.2.3.3.3" xref="S3.SS3.p1.8.m8.2.3.3.3.cmml"><mi id="S3.SS3.p1.8.m8.2.3.3.3.2" xref="S3.SS3.p1.8.m8.2.3.3.3.2.cmml">L</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.8.m8.2.3.3.3.1" xref="S3.SS3.p1.8.m8.2.3.3.3.1.cmml">×</mo><mi id="S3.SS3.p1.8.m8.2.3.3.3.3" xref="S3.SS3.p1.8.m8.2.3.3.3.3.cmml">M</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.2b"><apply id="S3.SS3.p1.8.m8.2.3.cmml" xref="S3.SS3.p1.8.m8.2.3"><in id="S3.SS3.p1.8.m8.2.3.1.cmml" xref="S3.SS3.p1.8.m8.2.3.1"></in><ci id="S3.SS3.p1.8.m8.2.3.2.cmml" xref="S3.SS3.p1.8.m8.2.3.2">𝐬</ci><apply id="S3.SS3.p1.8.m8.2.3.3.cmml" xref="S3.SS3.p1.8.m8.2.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.2.3.3.1.cmml" xref="S3.SS3.p1.8.m8.2.3.3">superscript</csymbol><interval closure="closed" id="S3.SS3.p1.8.m8.2.3.3.2.1.cmml" xref="S3.SS3.p1.8.m8.2.3.3.2.2"><cn type="integer" id="S3.SS3.p1.8.m8.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1">0</cn><cn type="integer" id="S3.SS3.p1.8.m8.2.2.cmml" xref="S3.SS3.p1.8.m8.2.2">1</cn></interval><apply id="S3.SS3.p1.8.m8.2.3.3.3.cmml" xref="S3.SS3.p1.8.m8.2.3.3.3"><times id="S3.SS3.p1.8.m8.2.3.3.3.1.cmml" xref="S3.SS3.p1.8.m8.2.3.3.3.1"></times><ci id="S3.SS3.p1.8.m8.2.3.3.3.2.cmml" xref="S3.SS3.p1.8.m8.2.3.3.3.2">𝐿</ci><ci id="S3.SS3.p1.8.m8.2.3.3.3.3.cmml" xref="S3.SS3.p1.8.m8.2.3.3.3.3">𝑀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.2c">\mathbf{s}\in[0,1]^{L\times M}</annotation></semantics></math> is generated from the routing network. To optimize the whole model, we employ a reparameterization trick called <span id="S3.SS3.p1.8.5" class="ltx_text ltx_font_italic">Concrete Distribution</span> (<span id="S3.SS3.p1.8.6" class="ltx_text ltx_font_bold">?</span>) or <span id="S3.SS3.p1.8.7" class="ltx_text ltx_font_italic">Gumbel- Softmax</span> (<span id="S3.SS3.p1.8.8" class="ltx_text ltx_font_bold">?</span>) in this paper.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.2" class="ltx_p">In order to elicit this method, we first review the Gumbel-Max trick (<span id="S3.SS3.p2.2.1" class="ltx_text ltx_font_bold">?</span>) which provides a way to sample <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\mathbf{z}</annotation></semantics></math> from a categorical distribution with class probability of <math id="S3.SS3.p2.2.m2.4" class="ltx_Math" alttext="\pi_{1},\pi_{2},\cdots,\pi_{n}" display="inline"><semantics id="S3.SS3.p2.2.m2.4a"><mrow id="S3.SS3.p2.2.m2.4.4.3" xref="S3.SS3.p2.2.m2.4.4.4.cmml"><msub id="S3.SS3.p2.2.m2.2.2.1.1" xref="S3.SS3.p2.2.m2.2.2.1.1.cmml"><mi id="S3.SS3.p2.2.m2.2.2.1.1.2" xref="S3.SS3.p2.2.m2.2.2.1.1.2.cmml">π</mi><mn id="S3.SS3.p2.2.m2.2.2.1.1.3" xref="S3.SS3.p2.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.p2.2.m2.4.4.3.4" xref="S3.SS3.p2.2.m2.4.4.4.cmml">,</mo><msub id="S3.SS3.p2.2.m2.3.3.2.2" xref="S3.SS3.p2.2.m2.3.3.2.2.cmml"><mi id="S3.SS3.p2.2.m2.3.3.2.2.2" xref="S3.SS3.p2.2.m2.3.3.2.2.2.cmml">π</mi><mn id="S3.SS3.p2.2.m2.3.3.2.2.3" xref="S3.SS3.p2.2.m2.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.SS3.p2.2.m2.4.4.3.5" xref="S3.SS3.p2.2.m2.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">⋯</mi><mo id="S3.SS3.p2.2.m2.4.4.3.6" xref="S3.SS3.p2.2.m2.4.4.4.cmml">,</mo><msub id="S3.SS3.p2.2.m2.4.4.3.3" xref="S3.SS3.p2.2.m2.4.4.3.3.cmml"><mi id="S3.SS3.p2.2.m2.4.4.3.3.2" xref="S3.SS3.p2.2.m2.4.4.3.3.2.cmml">π</mi><mi id="S3.SS3.p2.2.m2.4.4.3.3.3" xref="S3.SS3.p2.2.m2.4.4.3.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.4b"><list id="S3.SS3.p2.2.m2.4.4.4.cmml" xref="S3.SS3.p2.2.m2.4.4.3"><apply id="S3.SS3.p2.2.m2.2.2.1.1.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.2.2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m2.2.2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.2">𝜋</ci><cn type="integer" id="S3.SS3.p2.2.m2.2.2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.3">1</cn></apply><apply id="S3.SS3.p2.2.m2.3.3.2.2.cmml" xref="S3.SS3.p2.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.3.3.2.2.1.cmml" xref="S3.SS3.p2.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS3.p2.2.m2.3.3.2.2.2.cmml" xref="S3.SS3.p2.2.m2.3.3.2.2.2">𝜋</ci><cn type="integer" id="S3.SS3.p2.2.m2.3.3.2.2.3.cmml" xref="S3.SS3.p2.2.m2.3.3.2.2.3">2</cn></apply><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">⋯</ci><apply id="S3.SS3.p2.2.m2.4.4.3.3.cmml" xref="S3.SS3.p2.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.4.4.3.3.1.cmml" xref="S3.SS3.p2.2.m2.4.4.3.3">subscript</csymbol><ci id="S3.SS3.p2.2.m2.4.4.3.3.2.cmml" xref="S3.SS3.p2.2.m2.4.4.3.3.2">𝜋</ci><ci id="S3.SS3.p2.2.m2.4.4.3.3.3.cmml" xref="S3.SS3.p2.2.m2.4.4.3.3.3">𝑛</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.4c">\pi_{1},\pi_{2},\cdots,\pi_{n}</annotation></semantics></math> as follows:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.1" class="ltx_Math" alttext="\mathbf{z}=\text{one-hot}(\operatorname*{arg\,max}_{i}{[\textnormal{g}_{i}+\log\pi_{i}]})\\
" display="block"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml"><mi id="S3.E5.m1.1.1.3" xref="S3.E5.m1.1.1.3.cmml">𝐳</mi><mo id="S3.E5.m1.1.1.2" xref="S3.E5.m1.1.1.2.cmml">=</mo><mrow id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.cmml"><mtext id="S3.E5.m1.1.1.1.3" xref="S3.E5.m1.1.1.1.3a.cmml">one-hot</mtext><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.2" xref="S3.E5.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.3.cmml"><munder id="S3.E5.m1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E5.m1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S3.E5.m1.1.1.1.1.1.1.1.1.2.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.3.cmml">max</mi></mrow><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></munder><mo id="S3.E5.m1.1.1.1.1.1.1.2a" xref="S3.E5.m1.1.1.1.1.1.1.3.cmml">⁡</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.2.2" xref="S3.E5.m1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.1.2.2.2" xref="S3.E5.m1.1.1.1.1.1.1.3.cmml">[</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.2.2.1" xref="S3.E5.m1.1.1.1.1.1.1.2.2.1.cmml"><msub id="S3.E5.m1.1.1.1.1.1.1.2.2.1.2" xref="S3.E5.m1.1.1.1.1.1.1.2.2.1.2.cmml"><mtext id="S3.E5.m1.1.1.1.1.1.1.2.2.1.2.2" xref="S3.E5.m1.1.1.1.1.1.1.2.2.1.2.2a.cmml">g</mtext><mi id="S3.E5.m1.1.1.1.1.1.1.2.2.1.2.3" xref="S3.E5.m1.1.1.1.1.1.1.2.2.1.2.3.cmml">i</mi></msub><mo id="S3.E5.m1.1.1.1.1.1.1.2.2.1.1" xref="S3.E5.m1.1.1.1.1.1.1.2.2.1.1.cmml">+</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.2.2.1.3" xref="S3.E5.m1.1.1.1.1.1.1.2.2.1.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.2.2.1.3.1" xref="S3.E5.m1.1.1.1.1.1.1.2.2.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E5.m1.1.1.1.1.1.1.2.2.1.3a" xref="S3.E5.m1.1.1.1.1.1.1.2.2.1.3.cmml">⁡</mo><msub id="S3.E5.m1.1.1.1.1.1.1.2.2.1.3.2" xref="S3.E5.m1.1.1.1.1.1.1.2.2.1.3.2.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.2.2.1.3.2.2" xref="S3.E5.m1.1.1.1.1.1.1.2.2.1.3.2.2.cmml">π</mi><mi id="S3.E5.m1.1.1.1.1.1.1.2.2.1.3.2.3" xref="S3.E5.m1.1.1.1.1.1.1.2.2.1.3.2.3.cmml">i</mi></msub></mrow></mrow><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.1.2.2.3" xref="S3.E5.m1.1.1.1.1.1.1.3.cmml">]</mo></mrow></mrow><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1"><eq id="S3.E5.m1.1.1.2.cmml" xref="S3.E5.m1.1.1.2"></eq><ci id="S3.E5.m1.1.1.3.cmml" xref="S3.E5.m1.1.1.3">𝐳</ci><apply id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><times id="S3.E5.m1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.2"></times><ci id="S3.E5.m1.1.1.1.3a.cmml" xref="S3.E5.m1.1.1.1.3"><mtext id="S3.E5.m1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.3">one-hot</mtext></ci><apply id="S3.E5.m1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2"><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2"><times id="S3.E5.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.1"></times><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.2">arg</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.3">max</ci></apply><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E5.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.1"><plus id="S3.E5.m1.1.1.1.1.1.1.2.2.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.1.1"></plus><apply id="S3.E5.m1.1.1.1.1.1.1.2.2.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.2.2.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.1.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.2.2.1.2.2a.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.1.2.2"><mtext id="S3.E5.m1.1.1.1.1.1.1.2.2.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.1.2.2">g</mtext></ci><ci id="S3.E5.m1.1.1.1.1.1.1.2.2.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.1.2.3">𝑖</ci></apply><apply id="S3.E5.m1.1.1.1.1.1.1.2.2.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.1.3"><log id="S3.E5.m1.1.1.1.1.1.1.2.2.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.1.3.1"></log><apply id="S3.E5.m1.1.1.1.1.1.1.2.2.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.2.2.1.3.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.1.3.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.2.2.1.3.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.1.3.2.2">𝜋</ci><ci id="S3.E5.m1.1.1.1.1.1.1.2.2.1.3.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.1.3.2.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\mathbf{z}=\text{one-hot}(\operatorname*{arg\,max}_{i}{[\textnormal{g}_{i}+\log\pi_{i}]})\\
</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.5" class="ltx_p">where <math id="S3.SS3.p2.3.m1.3" class="ltx_Math" alttext="\textnormal{g}_{1},...,\textnormal{g}_{n}" display="inline"><semantics id="S3.SS3.p2.3.m1.3a"><mrow id="S3.SS3.p2.3.m1.3.3.2" xref="S3.SS3.p2.3.m1.3.3.3.cmml"><msub id="S3.SS3.p2.3.m1.2.2.1.1" xref="S3.SS3.p2.3.m1.2.2.1.1.cmml"><mtext id="S3.SS3.p2.3.m1.2.2.1.1.2" xref="S3.SS3.p2.3.m1.2.2.1.1.2a.cmml">g</mtext><mn id="S3.SS3.p2.3.m1.2.2.1.1.3" xref="S3.SS3.p2.3.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.p2.3.m1.3.3.2.3" xref="S3.SS3.p2.3.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p2.3.m1.1.1" xref="S3.SS3.p2.3.m1.1.1.cmml">…</mi><mo id="S3.SS3.p2.3.m1.3.3.2.4" xref="S3.SS3.p2.3.m1.3.3.3.cmml">,</mo><msub id="S3.SS3.p2.3.m1.3.3.2.2" xref="S3.SS3.p2.3.m1.3.3.2.2.cmml"><mtext id="S3.SS3.p2.3.m1.3.3.2.2.2" xref="S3.SS3.p2.3.m1.3.3.2.2.2a.cmml">g</mtext><mi id="S3.SS3.p2.3.m1.3.3.2.2.3" xref="S3.SS3.p2.3.m1.3.3.2.2.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m1.3b"><list id="S3.SS3.p2.3.m1.3.3.3.cmml" xref="S3.SS3.p2.3.m1.3.3.2"><apply id="S3.SS3.p2.3.m1.2.2.1.1.cmml" xref="S3.SS3.p2.3.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m1.2.2.1.1.1.cmml" xref="S3.SS3.p2.3.m1.2.2.1.1">subscript</csymbol><ci id="S3.SS3.p2.3.m1.2.2.1.1.2a.cmml" xref="S3.SS3.p2.3.m1.2.2.1.1.2"><mtext id="S3.SS3.p2.3.m1.2.2.1.1.2.cmml" xref="S3.SS3.p2.3.m1.2.2.1.1.2">g</mtext></ci><cn type="integer" id="S3.SS3.p2.3.m1.2.2.1.1.3.cmml" xref="S3.SS3.p2.3.m1.2.2.1.1.3">1</cn></apply><ci id="S3.SS3.p2.3.m1.1.1.cmml" xref="S3.SS3.p2.3.m1.1.1">…</ci><apply id="S3.SS3.p2.3.m1.3.3.2.2.cmml" xref="S3.SS3.p2.3.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m1.3.3.2.2.1.cmml" xref="S3.SS3.p2.3.m1.3.3.2.2">subscript</csymbol><ci id="S3.SS3.p2.3.m1.3.3.2.2.2a.cmml" xref="S3.SS3.p2.3.m1.3.3.2.2.2"><mtext id="S3.SS3.p2.3.m1.3.3.2.2.2.cmml" xref="S3.SS3.p2.3.m1.3.3.2.2.2">g</mtext></ci><ci id="S3.SS3.p2.3.m1.3.3.2.2.3.cmml" xref="S3.SS3.p2.3.m1.3.3.2.2.3">𝑛</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m1.3c">\textnormal{g}_{1},...,\textnormal{g}_{n}</annotation></semantics></math> are i.i.d samples from Gumbel distribution <span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>To sample from Gumbel distribution, first draw a sample from Uniform distribution <math id="footnote2.m1.2" class="ltx_Math" alttext="\textnormal{u}\sim\text{Uniform}(0,1)" display="inline"><semantics id="footnote2.m1.2b"><mrow id="footnote2.m1.2.3" xref="footnote2.m1.2.3.cmml"><mtext id="footnote2.m1.2.3.2" xref="footnote2.m1.2.3.2a.cmml">u</mtext><mo id="footnote2.m1.2.3.1" xref="footnote2.m1.2.3.1.cmml">∼</mo><mrow id="footnote2.m1.2.3.3" xref="footnote2.m1.2.3.3.cmml"><mtext id="footnote2.m1.2.3.3.2" xref="footnote2.m1.2.3.3.2a.cmml">Uniform</mtext><mo lspace="0em" rspace="0em" id="footnote2.m1.2.3.3.1" xref="footnote2.m1.2.3.3.1.cmml">​</mo><mrow id="footnote2.m1.2.3.3.3.2" xref="footnote2.m1.2.3.3.3.1.cmml"><mo stretchy="false" id="footnote2.m1.2.3.3.3.2.1" xref="footnote2.m1.2.3.3.3.1.cmml">(</mo><mn id="footnote2.m1.1.1" xref="footnote2.m1.1.1.cmml">0</mn><mo id="footnote2.m1.2.3.3.3.2.2" xref="footnote2.m1.2.3.3.3.1.cmml">,</mo><mn id="footnote2.m1.2.2" xref="footnote2.m1.2.2.cmml">1</mn><mo stretchy="false" id="footnote2.m1.2.3.3.3.2.3" xref="footnote2.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnote2.m1.2c"><apply id="footnote2.m1.2.3.cmml" xref="footnote2.m1.2.3"><csymbol cd="latexml" id="footnote2.m1.2.3.1.cmml" xref="footnote2.m1.2.3.1">similar-to</csymbol><ci id="footnote2.m1.2.3.2a.cmml" xref="footnote2.m1.2.3.2"><mtext id="footnote2.m1.2.3.2.cmml" xref="footnote2.m1.2.3.2">u</mtext></ci><apply id="footnote2.m1.2.3.3.cmml" xref="footnote2.m1.2.3.3"><times id="footnote2.m1.2.3.3.1.cmml" xref="footnote2.m1.2.3.3.1"></times><ci id="footnote2.m1.2.3.3.2a.cmml" xref="footnote2.m1.2.3.3.2"><mtext id="footnote2.m1.2.3.3.2.cmml" xref="footnote2.m1.2.3.3.2">Uniform</mtext></ci><interval closure="open" id="footnote2.m1.2.3.3.3.1.cmml" xref="footnote2.m1.2.3.3.3.2"><cn type="integer" id="footnote2.m1.1.1.cmml" xref="footnote2.m1.1.1">0</cn><cn type="integer" id="footnote2.m1.2.2.cmml" xref="footnote2.m1.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote2.m1.2d">\textnormal{u}\sim\text{Uniform}(0,1)</annotation></semantics></math>, computing random variable <span id="footnote2.1" class="ltx_text ltx_markedasmath">g</span> as <math id="footnote2.m3.4" class="ltx_Math" alttext="\textnormal{g}=-\log(-\log(\textnormal{u}))" display="inline"><semantics id="footnote2.m3.4b"><mrow id="footnote2.m3.4.4" xref="footnote2.m3.4.4.cmml"><mtext id="footnote2.m3.4.4.3" xref="footnote2.m3.4.4.3a.cmml">g</mtext><mo id="footnote2.m3.4.4.2" xref="footnote2.m3.4.4.2.cmml">=</mo><mrow id="footnote2.m3.4.4.1" xref="footnote2.m3.4.4.1.cmml"><mo rspace="0.167em" id="footnote2.m3.4.4.1b" xref="footnote2.m3.4.4.1.cmml">−</mo><mrow id="footnote2.m3.4.4.1.1.1" xref="footnote2.m3.4.4.1.1.2.cmml"><mi id="footnote2.m3.3.3" xref="footnote2.m3.3.3.cmml">log</mi><mo id="footnote2.m3.4.4.1.1.1b" xref="footnote2.m3.4.4.1.1.2.cmml">⁡</mo><mrow id="footnote2.m3.4.4.1.1.1.1" xref="footnote2.m3.4.4.1.1.2.cmml"><mo stretchy="false" id="footnote2.m3.4.4.1.1.1.1.2" xref="footnote2.m3.4.4.1.1.2.cmml">(</mo><mrow id="footnote2.m3.4.4.1.1.1.1.1" xref="footnote2.m3.4.4.1.1.1.1.1.cmml"><mo rspace="0.167em" id="footnote2.m3.4.4.1.1.1.1.1b" xref="footnote2.m3.4.4.1.1.1.1.1.cmml">−</mo><mrow id="footnote2.m3.4.4.1.1.1.1.1.2.2" xref="footnote2.m3.4.4.1.1.1.1.1.2.1.cmml"><mi id="footnote2.m3.1.1" xref="footnote2.m3.1.1.cmml">log</mi><mo id="footnote2.m3.4.4.1.1.1.1.1.2.2b" xref="footnote2.m3.4.4.1.1.1.1.1.2.1.cmml">⁡</mo><mrow id="footnote2.m3.4.4.1.1.1.1.1.2.2.1" xref="footnote2.m3.4.4.1.1.1.1.1.2.1.cmml"><mo stretchy="false" id="footnote2.m3.4.4.1.1.1.1.1.2.2.1.1" xref="footnote2.m3.4.4.1.1.1.1.1.2.1.cmml">(</mo><mtext id="footnote2.m3.2.2" xref="footnote2.m3.2.2a.cmml">u</mtext><mo stretchy="false" id="footnote2.m3.4.4.1.1.1.1.1.2.2.1.2" xref="footnote2.m3.4.4.1.1.1.1.1.2.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="footnote2.m3.4.4.1.1.1.1.3" xref="footnote2.m3.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnote2.m3.4c"><apply id="footnote2.m3.4.4.cmml" xref="footnote2.m3.4.4"><eq id="footnote2.m3.4.4.2.cmml" xref="footnote2.m3.4.4.2"></eq><ci id="footnote2.m3.4.4.3a.cmml" xref="footnote2.m3.4.4.3"><mtext id="footnote2.m3.4.4.3.cmml" xref="footnote2.m3.4.4.3">g</mtext></ci><apply id="footnote2.m3.4.4.1.cmml" xref="footnote2.m3.4.4.1"><minus id="footnote2.m3.4.4.1.2.cmml" xref="footnote2.m3.4.4.1"></minus><apply id="footnote2.m3.4.4.1.1.2.cmml" xref="footnote2.m3.4.4.1.1.1"><log id="footnote2.m3.3.3.cmml" xref="footnote2.m3.3.3"></log><apply id="footnote2.m3.4.4.1.1.1.1.1.cmml" xref="footnote2.m3.4.4.1.1.1.1.1"><minus id="footnote2.m3.4.4.1.1.1.1.1.1.cmml" xref="footnote2.m3.4.4.1.1.1.1.1"></minus><apply id="footnote2.m3.4.4.1.1.1.1.1.2.1.cmml" xref="footnote2.m3.4.4.1.1.1.1.1.2.2"><log id="footnote2.m3.1.1.cmml" xref="footnote2.m3.1.1"></log><ci id="footnote2.m3.2.2a.cmml" xref="footnote2.m3.2.2"><mtext id="footnote2.m3.2.2.cmml" xref="footnote2.m3.2.2">u</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote2.m3.4d">\textnormal{g}=-\log(-\log(\textnormal{u}))</annotation></semantics></math>, then <math id="footnote2.m4.2" class="ltx_Math" alttext="\textnormal{g}\sim\text{Gumbel}(0,1)" display="inline"><semantics id="footnote2.m4.2b"><mrow id="footnote2.m4.2.3" xref="footnote2.m4.2.3.cmml"><mtext id="footnote2.m4.2.3.2" xref="footnote2.m4.2.3.2a.cmml">g</mtext><mo id="footnote2.m4.2.3.1" xref="footnote2.m4.2.3.1.cmml">∼</mo><mrow id="footnote2.m4.2.3.3" xref="footnote2.m4.2.3.3.cmml"><mtext id="footnote2.m4.2.3.3.2" xref="footnote2.m4.2.3.3.2a.cmml">Gumbel</mtext><mo lspace="0em" rspace="0em" id="footnote2.m4.2.3.3.1" xref="footnote2.m4.2.3.3.1.cmml">​</mo><mrow id="footnote2.m4.2.3.3.3.2" xref="footnote2.m4.2.3.3.3.1.cmml"><mo stretchy="false" id="footnote2.m4.2.3.3.3.2.1" xref="footnote2.m4.2.3.3.3.1.cmml">(</mo><mn id="footnote2.m4.1.1" xref="footnote2.m4.1.1.cmml">0</mn><mo id="footnote2.m4.2.3.3.3.2.2" xref="footnote2.m4.2.3.3.3.1.cmml">,</mo><mn id="footnote2.m4.2.2" xref="footnote2.m4.2.2.cmml">1</mn><mo stretchy="false" id="footnote2.m4.2.3.3.3.2.3" xref="footnote2.m4.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnote2.m4.2c"><apply id="footnote2.m4.2.3.cmml" xref="footnote2.m4.2.3"><csymbol cd="latexml" id="footnote2.m4.2.3.1.cmml" xref="footnote2.m4.2.3.1">similar-to</csymbol><ci id="footnote2.m4.2.3.2a.cmml" xref="footnote2.m4.2.3.2"><mtext id="footnote2.m4.2.3.2.cmml" xref="footnote2.m4.2.3.2">g</mtext></ci><apply id="footnote2.m4.2.3.3.cmml" xref="footnote2.m4.2.3.3"><times id="footnote2.m4.2.3.3.1.cmml" xref="footnote2.m4.2.3.3.1"></times><ci id="footnote2.m4.2.3.3.2a.cmml" xref="footnote2.m4.2.3.3.2"><mtext id="footnote2.m4.2.3.3.2.cmml" xref="footnote2.m4.2.3.3.2">Gumbel</mtext></ci><interval closure="open" id="footnote2.m4.2.3.3.3.1.cmml" xref="footnote2.m4.2.3.3.3.2"><cn type="integer" id="footnote2.m4.1.1.cmml" xref="footnote2.m4.1.1">0</cn><cn type="integer" id="footnote2.m4.2.2.cmml" xref="footnote2.m4.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote2.m4.2d">\textnormal{g}\sim\text{Gumbel}(0,1)</annotation></semantics></math></span></span></span> and <math id="S3.SS3.p2.4.m2.1" class="ltx_Math" alttext="P(\mathbf{z}_{k}=1)=\pi_{k}" display="inline"><semantics id="S3.SS3.p2.4.m2.1a"><mrow id="S3.SS3.p2.4.m2.1.1" xref="S3.SS3.p2.4.m2.1.1.cmml"><mrow id="S3.SS3.p2.4.m2.1.1.1" xref="S3.SS3.p2.4.m2.1.1.1.cmml"><mi id="S3.SS3.p2.4.m2.1.1.1.3" xref="S3.SS3.p2.4.m2.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.4.m2.1.1.1.2" xref="S3.SS3.p2.4.m2.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.p2.4.m2.1.1.1.1.1" xref="S3.SS3.p2.4.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p2.4.m2.1.1.1.1.1.2" xref="S3.SS3.p2.4.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p2.4.m2.1.1.1.1.1.1" xref="S3.SS3.p2.4.m2.1.1.1.1.1.1.cmml"><msub id="S3.SS3.p2.4.m2.1.1.1.1.1.1.2" xref="S3.SS3.p2.4.m2.1.1.1.1.1.1.2.cmml"><mi id="S3.SS3.p2.4.m2.1.1.1.1.1.1.2.2" xref="S3.SS3.p2.4.m2.1.1.1.1.1.1.2.2.cmml">𝐳</mi><mi id="S3.SS3.p2.4.m2.1.1.1.1.1.1.2.3" xref="S3.SS3.p2.4.m2.1.1.1.1.1.1.2.3.cmml">k</mi></msub><mo id="S3.SS3.p2.4.m2.1.1.1.1.1.1.1" xref="S3.SS3.p2.4.m2.1.1.1.1.1.1.1.cmml">=</mo><mn id="S3.SS3.p2.4.m2.1.1.1.1.1.1.3" xref="S3.SS3.p2.4.m2.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS3.p2.4.m2.1.1.1.1.1.3" xref="S3.SS3.p2.4.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p2.4.m2.1.1.2" xref="S3.SS3.p2.4.m2.1.1.2.cmml">=</mo><msub id="S3.SS3.p2.4.m2.1.1.3" xref="S3.SS3.p2.4.m2.1.1.3.cmml"><mi id="S3.SS3.p2.4.m2.1.1.3.2" xref="S3.SS3.p2.4.m2.1.1.3.2.cmml">π</mi><mi id="S3.SS3.p2.4.m2.1.1.3.3" xref="S3.SS3.p2.4.m2.1.1.3.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m2.1b"><apply id="S3.SS3.p2.4.m2.1.1.cmml" xref="S3.SS3.p2.4.m2.1.1"><eq id="S3.SS3.p2.4.m2.1.1.2.cmml" xref="S3.SS3.p2.4.m2.1.1.2"></eq><apply id="S3.SS3.p2.4.m2.1.1.1.cmml" xref="S3.SS3.p2.4.m2.1.1.1"><times id="S3.SS3.p2.4.m2.1.1.1.2.cmml" xref="S3.SS3.p2.4.m2.1.1.1.2"></times><ci id="S3.SS3.p2.4.m2.1.1.1.3.cmml" xref="S3.SS3.p2.4.m2.1.1.1.3">𝑃</ci><apply id="S3.SS3.p2.4.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.4.m2.1.1.1.1.1"><eq id="S3.SS3.p2.4.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.4.m2.1.1.1.1.1.1.1"></eq><apply id="S3.SS3.p2.4.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.4.m2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m2.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.4.m2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.4.m2.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.4.m2.1.1.1.1.1.1.2.2">𝐳</ci><ci id="S3.SS3.p2.4.m2.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p2.4.m2.1.1.1.1.1.1.2.3">𝑘</ci></apply><cn type="integer" id="S3.SS3.p2.4.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.4.m2.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.SS3.p2.4.m2.1.1.3.cmml" xref="S3.SS3.p2.4.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m2.1.1.3.1.cmml" xref="S3.SS3.p2.4.m2.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.4.m2.1.1.3.2.cmml" xref="S3.SS3.p2.4.m2.1.1.3.2">𝜋</ci><ci id="S3.SS3.p2.4.m2.1.1.3.3.cmml" xref="S3.SS3.p2.4.m2.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m2.1c">P(\mathbf{z}_{k}=1)=\pi_{k}</annotation></semantics></math>. However the argmax operation is still not differentiable, so the softmax function with temperature <math id="S3.SS3.p2.5.m3.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS3.p2.5.m3.1a"><mi id="S3.SS3.p2.5.m3.1.1" xref="S3.SS3.p2.5.m3.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m3.1b"><ci id="S3.SS3.p2.5.m3.1.1.cmml" xref="S3.SS3.p2.5.m3.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m3.1c">\tau</annotation></semantics></math> is introduced here to approximate the argmax function:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.3" class="ltx_Math" alttext="\mathbf{\tilde{z}}=\text{softmax}((\textnormal{g}+\log(\pi))/\tau)" display="block"><semantics id="S3.E6.m1.3a"><mrow id="S3.E6.m1.3.3" xref="S3.E6.m1.3.3.cmml"><mover accent="true" id="S3.E6.m1.3.3.3" xref="S3.E6.m1.3.3.3.cmml"><mi id="S3.E6.m1.3.3.3.2" xref="S3.E6.m1.3.3.3.2.cmml">𝐳</mi><mo id="S3.E6.m1.3.3.3.1" xref="S3.E6.m1.3.3.3.1.cmml">~</mo></mover><mo id="S3.E6.m1.3.3.2" xref="S3.E6.m1.3.3.2.cmml">=</mo><mrow id="S3.E6.m1.3.3.1" xref="S3.E6.m1.3.3.1.cmml"><mtext id="S3.E6.m1.3.3.1.3" xref="S3.E6.m1.3.3.1.3a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.2" xref="S3.E6.m1.3.3.1.2.cmml">​</mo><mrow id="S3.E6.m1.3.3.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.3.3.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.cmml"><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.cmml"><mtext id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2a.cmml">g</mtext><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.cmml"><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">log</mi><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.2a" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.cmml">⁡</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.2.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.2.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml">π</mi><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.2.1.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E6.m1.3.3.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.2.cmml">/</mo><mi id="S3.E6.m1.3.3.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.3.cmml">τ</mi></mrow><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.3b"><apply id="S3.E6.m1.3.3.cmml" xref="S3.E6.m1.3.3"><eq id="S3.E6.m1.3.3.2.cmml" xref="S3.E6.m1.3.3.2"></eq><apply id="S3.E6.m1.3.3.3.cmml" xref="S3.E6.m1.3.3.3"><ci id="S3.E6.m1.3.3.3.1.cmml" xref="S3.E6.m1.3.3.3.1">~</ci><ci id="S3.E6.m1.3.3.3.2.cmml" xref="S3.E6.m1.3.3.3.2">𝐳</ci></apply><apply id="S3.E6.m1.3.3.1.cmml" xref="S3.E6.m1.3.3.1"><times id="S3.E6.m1.3.3.1.2.cmml" xref="S3.E6.m1.3.3.1.2"></times><ci id="S3.E6.m1.3.3.1.3a.cmml" xref="S3.E6.m1.3.3.1.3"><mtext id="S3.E6.m1.3.3.1.3.cmml" xref="S3.E6.m1.3.3.1.3">softmax</mtext></ci><apply id="S3.E6.m1.3.3.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1"><divide id="S3.E6.m1.3.3.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2"></divide><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1"><plus id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1"></plus><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2a.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2"><mtext id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2">g</mtext></ci><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.2"><log id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"></log><ci id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2">𝜋</ci></apply></apply><ci id="S3.E6.m1.3.3.1.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.3">𝜏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.3c">\mathbf{\tilde{z}}=\text{softmax}((\textnormal{g}+\log(\pi))/\tau)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.6" class="ltx_p">As <math id="S3.SS3.p2.6.m1.1" class="ltx_Math" alttext="\tau\rightarrow 0" display="inline"><semantics id="S3.SS3.p2.6.m1.1a"><mrow id="S3.SS3.p2.6.m1.1.1" xref="S3.SS3.p2.6.m1.1.1.cmml"><mi id="S3.SS3.p2.6.m1.1.1.2" xref="S3.SS3.p2.6.m1.1.1.2.cmml">τ</mi><mo stretchy="false" id="S3.SS3.p2.6.m1.1.1.1" xref="S3.SS3.p2.6.m1.1.1.1.cmml">→</mo><mn id="S3.SS3.p2.6.m1.1.1.3" xref="S3.SS3.p2.6.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m1.1b"><apply id="S3.SS3.p2.6.m1.1.1.cmml" xref="S3.SS3.p2.6.m1.1.1"><ci id="S3.SS3.p2.6.m1.1.1.1.cmml" xref="S3.SS3.p2.6.m1.1.1.1">→</ci><ci id="S3.SS3.p2.6.m1.1.1.2.cmml" xref="S3.SS3.p2.6.m1.1.1.2">𝜏</ci><cn type="integer" id="S3.SS3.p2.6.m1.1.1.3.cmml" xref="S3.SS3.p2.6.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m1.1c">\tau\rightarrow 0</annotation></semantics></math>, the softmax function is smoothly approaching the argmax function.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.8" class="ltx_p">In the above we have showed how to sample from categorical distribution <math id="S3.SS3.p3.1.m1.4" class="ltx_Math" alttext="\text{Cat}(\pi_{1},\pi_{2},\cdots,\pi_{n})" display="inline"><semantics id="S3.SS3.p3.1.m1.4a"><mrow id="S3.SS3.p3.1.m1.4.4" xref="S3.SS3.p3.1.m1.4.4.cmml"><mtext id="S3.SS3.p3.1.m1.4.4.5" xref="S3.SS3.p3.1.m1.4.4.5a.cmml">Cat</mtext><mo lspace="0em" rspace="0em" id="S3.SS3.p3.1.m1.4.4.4" xref="S3.SS3.p3.1.m1.4.4.4.cmml">​</mo><mrow id="S3.SS3.p3.1.m1.4.4.3.3" xref="S3.SS3.p3.1.m1.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS3.p3.1.m1.4.4.3.3.4" xref="S3.SS3.p3.1.m1.4.4.3.4.cmml">(</mo><msub id="S3.SS3.p3.1.m1.2.2.1.1.1" xref="S3.SS3.p3.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS3.p3.1.m1.2.2.1.1.1.2" xref="S3.SS3.p3.1.m1.2.2.1.1.1.2.cmml">π</mi><mn id="S3.SS3.p3.1.m1.2.2.1.1.1.3" xref="S3.SS3.p3.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.p3.1.m1.4.4.3.3.5" xref="S3.SS3.p3.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS3.p3.1.m1.3.3.2.2.2" xref="S3.SS3.p3.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS3.p3.1.m1.3.3.2.2.2.2" xref="S3.SS3.p3.1.m1.3.3.2.2.2.2.cmml">π</mi><mn id="S3.SS3.p3.1.m1.3.3.2.2.2.3" xref="S3.SS3.p3.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS3.p3.1.m1.4.4.3.3.6" xref="S3.SS3.p3.1.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">⋯</mi><mo id="S3.SS3.p3.1.m1.4.4.3.3.7" xref="S3.SS3.p3.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS3.p3.1.m1.4.4.3.3.3" xref="S3.SS3.p3.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS3.p3.1.m1.4.4.3.3.3.2" xref="S3.SS3.p3.1.m1.4.4.3.3.3.2.cmml">π</mi><mi id="S3.SS3.p3.1.m1.4.4.3.3.3.3" xref="S3.SS3.p3.1.m1.4.4.3.3.3.3.cmml">n</mi></msub><mo stretchy="false" id="S3.SS3.p3.1.m1.4.4.3.3.8" xref="S3.SS3.p3.1.m1.4.4.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.4b"><apply id="S3.SS3.p3.1.m1.4.4.cmml" xref="S3.SS3.p3.1.m1.4.4"><times id="S3.SS3.p3.1.m1.4.4.4.cmml" xref="S3.SS3.p3.1.m1.4.4.4"></times><ci id="S3.SS3.p3.1.m1.4.4.5a.cmml" xref="S3.SS3.p3.1.m1.4.4.5"><mtext id="S3.SS3.p3.1.m1.4.4.5.cmml" xref="S3.SS3.p3.1.m1.4.4.5">Cat</mtext></ci><vector id="S3.SS3.p3.1.m1.4.4.3.4.cmml" xref="S3.SS3.p3.1.m1.4.4.3.3"><apply id="S3.SS3.p3.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.p3.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.2.2.1.1.1.2">𝜋</ci><cn type="integer" id="S3.SS3.p3.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS3.p3.1.m1.3.3.2.2.2.cmml" xref="S3.SS3.p3.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS3.p3.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.p3.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS3.p3.1.m1.3.3.2.2.2.2">𝜋</ci><cn type="integer" id="S3.SS3.p3.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS3.p3.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">⋯</ci><apply id="S3.SS3.p3.1.m1.4.4.3.3.3.cmml" xref="S3.SS3.p3.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS3.p3.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS3.p3.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS3.p3.1.m1.4.4.3.3.3.2">𝜋</ci><ci id="S3.SS3.p3.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS3.p3.1.m1.4.4.3.3.3.3">𝑛</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.4c">\text{Cat}(\pi_{1},\pi_{2},\cdots,\pi_{n})</annotation></semantics></math> using the Gumbel-Softmax trick, now we discuss the “binary” case of our problem, that means we need to sample from <math id="S3.SS3.p3.2.m2.2" class="ltx_Math" alttext="\text{Cat}(\pi_{1},\pi_{2})" display="inline"><semantics id="S3.SS3.p3.2.m2.2a"><mrow id="S3.SS3.p3.2.m2.2.2" xref="S3.SS3.p3.2.m2.2.2.cmml"><mtext id="S3.SS3.p3.2.m2.2.2.4" xref="S3.SS3.p3.2.m2.2.2.4a.cmml">Cat</mtext><mo lspace="0em" rspace="0em" id="S3.SS3.p3.2.m2.2.2.3" xref="S3.SS3.p3.2.m2.2.2.3.cmml">​</mo><mrow id="S3.SS3.p3.2.m2.2.2.2.2" xref="S3.SS3.p3.2.m2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.p3.2.m2.2.2.2.2.3" xref="S3.SS3.p3.2.m2.2.2.2.3.cmml">(</mo><msub id="S3.SS3.p3.2.m2.1.1.1.1.1" xref="S3.SS3.p3.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.2.m2.1.1.1.1.1.2" xref="S3.SS3.p3.2.m2.1.1.1.1.1.2.cmml">π</mi><mn id="S3.SS3.p3.2.m2.1.1.1.1.1.3" xref="S3.SS3.p3.2.m2.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.p3.2.m2.2.2.2.2.4" xref="S3.SS3.p3.2.m2.2.2.2.3.cmml">,</mo><msub id="S3.SS3.p3.2.m2.2.2.2.2.2" xref="S3.SS3.p3.2.m2.2.2.2.2.2.cmml"><mi id="S3.SS3.p3.2.m2.2.2.2.2.2.2" xref="S3.SS3.p3.2.m2.2.2.2.2.2.2.cmml">π</mi><mn id="S3.SS3.p3.2.m2.2.2.2.2.2.3" xref="S3.SS3.p3.2.m2.2.2.2.2.2.3.cmml">2</mn></msub><mo stretchy="false" id="S3.SS3.p3.2.m2.2.2.2.2.5" xref="S3.SS3.p3.2.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.2b"><apply id="S3.SS3.p3.2.m2.2.2.cmml" xref="S3.SS3.p3.2.m2.2.2"><times id="S3.SS3.p3.2.m2.2.2.3.cmml" xref="S3.SS3.p3.2.m2.2.2.3"></times><ci id="S3.SS3.p3.2.m2.2.2.4a.cmml" xref="S3.SS3.p3.2.m2.2.2.4"><mtext id="S3.SS3.p3.2.m2.2.2.4.cmml" xref="S3.SS3.p3.2.m2.2.2.4">Cat</mtext></ci><interval closure="open" id="S3.SS3.p3.2.m2.2.2.2.3.cmml" xref="S3.SS3.p3.2.m2.2.2.2.2"><apply id="S3.SS3.p3.2.m2.1.1.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.2">𝜋</ci><cn type="integer" id="S3.SS3.p3.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS3.p3.2.m2.2.2.2.2.2.cmml" xref="S3.SS3.p3.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS3.p3.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p3.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS3.p3.2.m2.2.2.2.2.2.2">𝜋</ci><cn type="integer" id="S3.SS3.p3.2.m2.2.2.2.2.2.3.cmml" xref="S3.SS3.p3.2.m2.2.2.2.2.2.3">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.2c">\text{Cat}(\pi_{1},\pi_{2})</annotation></semantics></math> where <math id="S3.SS3.p3.3.m3.1" class="ltx_Math" alttext="\pi_{2}=1-\pi_{1}" display="inline"><semantics id="S3.SS3.p3.3.m3.1a"><mrow id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml"><msub id="S3.SS3.p3.3.m3.1.1.2" xref="S3.SS3.p3.3.m3.1.1.2.cmml"><mi id="S3.SS3.p3.3.m3.1.1.2.2" xref="S3.SS3.p3.3.m3.1.1.2.2.cmml">π</mi><mn id="S3.SS3.p3.3.m3.1.1.2.3" xref="S3.SS3.p3.3.m3.1.1.2.3.cmml">2</mn></msub><mo id="S3.SS3.p3.3.m3.1.1.1" xref="S3.SS3.p3.3.m3.1.1.1.cmml">=</mo><mrow id="S3.SS3.p3.3.m3.1.1.3" xref="S3.SS3.p3.3.m3.1.1.3.cmml"><mn id="S3.SS3.p3.3.m3.1.1.3.2" xref="S3.SS3.p3.3.m3.1.1.3.2.cmml">1</mn><mo id="S3.SS3.p3.3.m3.1.1.3.1" xref="S3.SS3.p3.3.m3.1.1.3.1.cmml">−</mo><msub id="S3.SS3.p3.3.m3.1.1.3.3" xref="S3.SS3.p3.3.m3.1.1.3.3.cmml"><mi id="S3.SS3.p3.3.m3.1.1.3.3.2" xref="S3.SS3.p3.3.m3.1.1.3.3.2.cmml">π</mi><mn id="S3.SS3.p3.3.m3.1.1.3.3.3" xref="S3.SS3.p3.3.m3.1.1.3.3.3.cmml">1</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><apply id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1"><eq id="S3.SS3.p3.3.m3.1.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1.1"></eq><apply id="S3.SS3.p3.3.m3.1.1.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.2.1.cmml" xref="S3.SS3.p3.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS3.p3.3.m3.1.1.2.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2.2">𝜋</ci><cn type="integer" id="S3.SS3.p3.3.m3.1.1.2.3.cmml" xref="S3.SS3.p3.3.m3.1.1.2.3">2</cn></apply><apply id="S3.SS3.p3.3.m3.1.1.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3"><minus id="S3.SS3.p3.3.m3.1.1.3.1.cmml" xref="S3.SS3.p3.3.m3.1.1.3.1"></minus><cn type="integer" id="S3.SS3.p3.3.m3.1.1.3.2.cmml" xref="S3.SS3.p3.3.m3.1.1.3.2">1</cn><apply id="S3.SS3.p3.3.m3.1.1.3.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.3.3.1.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3">subscript</csymbol><ci id="S3.SS3.p3.3.m3.1.1.3.3.2.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3.2">𝜋</ci><cn type="integer" id="S3.SS3.p3.3.m3.1.1.3.3.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">\pi_{2}=1-\pi_{1}</annotation></semantics></math>. Note that this distribution is equivalent to Bernoulli distribution <math id="S3.SS3.p3.4.m4.1" class="ltx_Math" alttext="\text{Bern}(\pi_{1})" display="inline"><semantics id="S3.SS3.p3.4.m4.1a"><mrow id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml"><mtext id="S3.SS3.p3.4.m4.1.1.3" xref="S3.SS3.p3.4.m4.1.1.3a.cmml">Bern</mtext><mo lspace="0em" rspace="0em" id="S3.SS3.p3.4.m4.1.1.2" xref="S3.SS3.p3.4.m4.1.1.2.cmml">​</mo><mrow id="S3.SS3.p3.4.m4.1.1.1.1" xref="S3.SS3.p3.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p3.4.m4.1.1.1.1.2" xref="S3.SS3.p3.4.m4.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p3.4.m4.1.1.1.1.1" xref="S3.SS3.p3.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.4.m4.1.1.1.1.1.2" xref="S3.SS3.p3.4.m4.1.1.1.1.1.2.cmml">π</mi><mn id="S3.SS3.p3.4.m4.1.1.1.1.1.3" xref="S3.SS3.p3.4.m4.1.1.1.1.1.3.cmml">1</mn></msub><mo stretchy="false" id="S3.SS3.p3.4.m4.1.1.1.1.3" xref="S3.SS3.p3.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><apply id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1"><times id="S3.SS3.p3.4.m4.1.1.2.cmml" xref="S3.SS3.p3.4.m4.1.1.2"></times><ci id="S3.SS3.p3.4.m4.1.1.3a.cmml" xref="S3.SS3.p3.4.m4.1.1.3"><mtext id="S3.SS3.p3.4.m4.1.1.3.cmml" xref="S3.SS3.p3.4.m4.1.1.3">Bern</mtext></ci><apply id="S3.SS3.p3.4.m4.1.1.1.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.4.m4.1.1.1.1.1.2">𝜋</ci><cn type="integer" id="S3.SS3.p3.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.4.m4.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">\text{Bern}(\pi_{1})</annotation></semantics></math>, we use <math id="S3.SS3.p3.5.m5.1" class="ltx_Math" alttext="\rho" display="inline"><semantics id="S3.SS3.p3.5.m5.1a"><mi id="S3.SS3.p3.5.m5.1.1" xref="S3.SS3.p3.5.m5.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.1b"><ci id="S3.SS3.p3.5.m5.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.1c">\rho</annotation></semantics></math> to substitute <math id="S3.SS3.p3.6.m6.1" class="ltx_Math" alttext="\pi_{1}" display="inline"><semantics id="S3.SS3.p3.6.m6.1a"><msub id="S3.SS3.p3.6.m6.1.1" xref="S3.SS3.p3.6.m6.1.1.cmml"><mi id="S3.SS3.p3.6.m6.1.1.2" xref="S3.SS3.p3.6.m6.1.1.2.cmml">π</mi><mn id="S3.SS3.p3.6.m6.1.1.3" xref="S3.SS3.p3.6.m6.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m6.1b"><apply id="S3.SS3.p3.6.m6.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.1.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p3.6.m6.1.1.2.cmml" xref="S3.SS3.p3.6.m6.1.1.2">𝜋</ci><cn type="integer" id="S3.SS3.p3.6.m6.1.1.3.cmml" xref="S3.SS3.p3.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m6.1c">\pi_{1}</annotation></semantics></math> to distinguish from the previous symbol definition, then we apply the Gumbel-Max trick again to sample Bernoulli variable <span id="S3.SS3.p3.8.1" class="ltx_text ltx_markedasmath">b</span> from <math id="S3.SS3.p3.8.m8.1" class="ltx_Math" alttext="\text{Bern}(\rho)" display="inline"><semantics id="S3.SS3.p3.8.m8.1a"><mrow id="S3.SS3.p3.8.m8.1.2" xref="S3.SS3.p3.8.m8.1.2.cmml"><mtext id="S3.SS3.p3.8.m8.1.2.2" xref="S3.SS3.p3.8.m8.1.2.2a.cmml">Bern</mtext><mo lspace="0em" rspace="0em" id="S3.SS3.p3.8.m8.1.2.1" xref="S3.SS3.p3.8.m8.1.2.1.cmml">​</mo><mrow id="S3.SS3.p3.8.m8.1.2.3.2" xref="S3.SS3.p3.8.m8.1.2.cmml"><mo stretchy="false" id="S3.SS3.p3.8.m8.1.2.3.2.1" xref="S3.SS3.p3.8.m8.1.2.cmml">(</mo><mi id="S3.SS3.p3.8.m8.1.1" xref="S3.SS3.p3.8.m8.1.1.cmml">ρ</mi><mo stretchy="false" id="S3.SS3.p3.8.m8.1.2.3.2.2" xref="S3.SS3.p3.8.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.8.m8.1b"><apply id="S3.SS3.p3.8.m8.1.2.cmml" xref="S3.SS3.p3.8.m8.1.2"><times id="S3.SS3.p3.8.m8.1.2.1.cmml" xref="S3.SS3.p3.8.m8.1.2.1"></times><ci id="S3.SS3.p3.8.m8.1.2.2a.cmml" xref="S3.SS3.p3.8.m8.1.2.2"><mtext id="S3.SS3.p3.8.m8.1.2.2.cmml" xref="S3.SS3.p3.8.m8.1.2.2">Bern</mtext></ci><ci id="S3.SS3.p3.8.m8.1.1.cmml" xref="S3.SS3.p3.8.m8.1.1">𝜌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.8.m8.1c">\text{Bern}(\rho)</annotation></semantics></math> as
</p>
<table id="A2.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S3.E7.2.1.1.1" class="ltx_text ltx_markedasmath">b</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7.m2.4" class="ltx_Math" alttext="\displaystyle=[\textnormal{g}_{1}+\log(\rho)&gt;\textnormal{g}_{2}+\log(1-\rho)]" display="inline"><semantics id="S3.E7.m2.4a"><mrow id="S3.E7.m2.4.4" xref="S3.E7.m2.4.4.cmml"><mi id="S3.E7.m2.4.4.3" xref="S3.E7.m2.4.4.3.cmml"></mi><mo id="S3.E7.m2.4.4.2" xref="S3.E7.m2.4.4.2.cmml">=</mo><mrow id="S3.E7.m2.4.4.1.1" xref="S3.E7.m2.4.4.1.2.cmml"><mo stretchy="false" id="S3.E7.m2.4.4.1.1.2" xref="S3.E7.m2.4.4.1.2.1.cmml">[</mo><mrow id="S3.E7.m2.4.4.1.1.1" xref="S3.E7.m2.4.4.1.1.1.cmml"><mrow id="S3.E7.m2.4.4.1.1.1.3" xref="S3.E7.m2.4.4.1.1.1.3.cmml"><msub id="S3.E7.m2.4.4.1.1.1.3.2" xref="S3.E7.m2.4.4.1.1.1.3.2.cmml"><mtext id="S3.E7.m2.4.4.1.1.1.3.2.2" xref="S3.E7.m2.4.4.1.1.1.3.2.2a.cmml">g</mtext><mn id="S3.E7.m2.4.4.1.1.1.3.2.3" xref="S3.E7.m2.4.4.1.1.1.3.2.3.cmml">1</mn></msub><mo id="S3.E7.m2.4.4.1.1.1.3.1" xref="S3.E7.m2.4.4.1.1.1.3.1.cmml">+</mo><mrow id="S3.E7.m2.4.4.1.1.1.3.3.2" xref="S3.E7.m2.4.4.1.1.1.3.3.1.cmml"><mi id="S3.E7.m2.1.1" xref="S3.E7.m2.1.1.cmml">log</mi><mo id="S3.E7.m2.4.4.1.1.1.3.3.2a" xref="S3.E7.m2.4.4.1.1.1.3.3.1.cmml">⁡</mo><mrow id="S3.E7.m2.4.4.1.1.1.3.3.2.1" xref="S3.E7.m2.4.4.1.1.1.3.3.1.cmml"><mo stretchy="false" id="S3.E7.m2.4.4.1.1.1.3.3.2.1.1" xref="S3.E7.m2.4.4.1.1.1.3.3.1.cmml">(</mo><mi id="S3.E7.m2.2.2" xref="S3.E7.m2.2.2.cmml">ρ</mi><mo stretchy="false" id="S3.E7.m2.4.4.1.1.1.3.3.2.1.2" xref="S3.E7.m2.4.4.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m2.4.4.1.1.1.2" xref="S3.E7.m2.4.4.1.1.1.2.cmml">&gt;</mo><mrow id="S3.E7.m2.4.4.1.1.1.1" xref="S3.E7.m2.4.4.1.1.1.1.cmml"><msub id="S3.E7.m2.4.4.1.1.1.1.3" xref="S3.E7.m2.4.4.1.1.1.1.3.cmml"><mtext id="S3.E7.m2.4.4.1.1.1.1.3.2" xref="S3.E7.m2.4.4.1.1.1.1.3.2a.cmml">g</mtext><mn id="S3.E7.m2.4.4.1.1.1.1.3.3" xref="S3.E7.m2.4.4.1.1.1.1.3.3.cmml">2</mn></msub><mo id="S3.E7.m2.4.4.1.1.1.1.2" xref="S3.E7.m2.4.4.1.1.1.1.2.cmml">+</mo><mrow id="S3.E7.m2.4.4.1.1.1.1.1.1" xref="S3.E7.m2.4.4.1.1.1.1.1.2.cmml"><mi id="S3.E7.m2.3.3" xref="S3.E7.m2.3.3.cmml">log</mi><mo id="S3.E7.m2.4.4.1.1.1.1.1.1a" xref="S3.E7.m2.4.4.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E7.m2.4.4.1.1.1.1.1.1.1" xref="S3.E7.m2.4.4.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E7.m2.4.4.1.1.1.1.1.1.1.2" xref="S3.E7.m2.4.4.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E7.m2.4.4.1.1.1.1.1.1.1.1" xref="S3.E7.m2.4.4.1.1.1.1.1.1.1.1.cmml"><mn id="S3.E7.m2.4.4.1.1.1.1.1.1.1.1.2" xref="S3.E7.m2.4.4.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E7.m2.4.4.1.1.1.1.1.1.1.1.1" xref="S3.E7.m2.4.4.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E7.m2.4.4.1.1.1.1.1.1.1.1.3" xref="S3.E7.m2.4.4.1.1.1.1.1.1.1.1.3.cmml">ρ</mi></mrow><mo stretchy="false" id="S3.E7.m2.4.4.1.1.1.1.1.1.1.3" xref="S3.E7.m2.4.4.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo stretchy="false" id="S3.E7.m2.4.4.1.1.3" xref="S3.E7.m2.4.4.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m2.4b"><apply id="S3.E7.m2.4.4.cmml" xref="S3.E7.m2.4.4"><eq id="S3.E7.m2.4.4.2.cmml" xref="S3.E7.m2.4.4.2"></eq><csymbol cd="latexml" id="S3.E7.m2.4.4.3.cmml" xref="S3.E7.m2.4.4.3">absent</csymbol><apply id="S3.E7.m2.4.4.1.2.cmml" xref="S3.E7.m2.4.4.1.1"><csymbol cd="latexml" id="S3.E7.m2.4.4.1.2.1.cmml" xref="S3.E7.m2.4.4.1.1.2">delimited-[]</csymbol><apply id="S3.E7.m2.4.4.1.1.1.cmml" xref="S3.E7.m2.4.4.1.1.1"><gt id="S3.E7.m2.4.4.1.1.1.2.cmml" xref="S3.E7.m2.4.4.1.1.1.2"></gt><apply id="S3.E7.m2.4.4.1.1.1.3.cmml" xref="S3.E7.m2.4.4.1.1.1.3"><plus id="S3.E7.m2.4.4.1.1.1.3.1.cmml" xref="S3.E7.m2.4.4.1.1.1.3.1"></plus><apply id="S3.E7.m2.4.4.1.1.1.3.2.cmml" xref="S3.E7.m2.4.4.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m2.4.4.1.1.1.3.2.1.cmml" xref="S3.E7.m2.4.4.1.1.1.3.2">subscript</csymbol><ci id="S3.E7.m2.4.4.1.1.1.3.2.2a.cmml" xref="S3.E7.m2.4.4.1.1.1.3.2.2"><mtext id="S3.E7.m2.4.4.1.1.1.3.2.2.cmml" xref="S3.E7.m2.4.4.1.1.1.3.2.2">g</mtext></ci><cn type="integer" id="S3.E7.m2.4.4.1.1.1.3.2.3.cmml" xref="S3.E7.m2.4.4.1.1.1.3.2.3">1</cn></apply><apply id="S3.E7.m2.4.4.1.1.1.3.3.1.cmml" xref="S3.E7.m2.4.4.1.1.1.3.3.2"><log id="S3.E7.m2.1.1.cmml" xref="S3.E7.m2.1.1"></log><ci id="S3.E7.m2.2.2.cmml" xref="S3.E7.m2.2.2">𝜌</ci></apply></apply><apply id="S3.E7.m2.4.4.1.1.1.1.cmml" xref="S3.E7.m2.4.4.1.1.1.1"><plus id="S3.E7.m2.4.4.1.1.1.1.2.cmml" xref="S3.E7.m2.4.4.1.1.1.1.2"></plus><apply id="S3.E7.m2.4.4.1.1.1.1.3.cmml" xref="S3.E7.m2.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m2.4.4.1.1.1.1.3.1.cmml" xref="S3.E7.m2.4.4.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m2.4.4.1.1.1.1.3.2a.cmml" xref="S3.E7.m2.4.4.1.1.1.1.3.2"><mtext id="S3.E7.m2.4.4.1.1.1.1.3.2.cmml" xref="S3.E7.m2.4.4.1.1.1.1.3.2">g</mtext></ci><cn type="integer" id="S3.E7.m2.4.4.1.1.1.1.3.3.cmml" xref="S3.E7.m2.4.4.1.1.1.1.3.3">2</cn></apply><apply id="S3.E7.m2.4.4.1.1.1.1.1.2.cmml" xref="S3.E7.m2.4.4.1.1.1.1.1.1"><log id="S3.E7.m2.3.3.cmml" xref="S3.E7.m2.3.3"></log><apply id="S3.E7.m2.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m2.4.4.1.1.1.1.1.1.1.1"><minus id="S3.E7.m2.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m2.4.4.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E7.m2.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m2.4.4.1.1.1.1.1.1.1.1.2">1</cn><ci id="S3.E7.m2.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m2.4.4.1.1.1.1.1.1.1.1.3">𝜌</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m2.4c">\displaystyle=[\textnormal{g}_{1}+\log(\rho)&gt;\textnormal{g}_{2}+\log(1-\rho)]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
<tbody id="S3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E8.m1.2" class="ltx_Math" alttext="\displaystyle=[\textnormal{g}_{1}-\textnormal{g}_{2}+\log(\rho/(1-\rho))&gt;0]" display="inline"><semantics id="S3.E8.m1.2a"><mrow id="S3.E8.m1.2.2" xref="S3.E8.m1.2.2.cmml"><mi id="S3.E8.m1.2.2.3" xref="S3.E8.m1.2.2.3.cmml"></mi><mo id="S3.E8.m1.2.2.2" xref="S3.E8.m1.2.2.2.cmml">=</mo><mrow id="S3.E8.m1.2.2.1.1" xref="S3.E8.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.E8.m1.2.2.1.1.2" xref="S3.E8.m1.2.2.1.2.1.cmml">[</mo><mrow id="S3.E8.m1.2.2.1.1.1" xref="S3.E8.m1.2.2.1.1.1.cmml"><mrow id="S3.E8.m1.2.2.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.cmml"><mrow id="S3.E8.m1.2.2.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.3.cmml"><msub id="S3.E8.m1.2.2.1.1.1.1.3.2" xref="S3.E8.m1.2.2.1.1.1.1.3.2.cmml"><mtext id="S3.E8.m1.2.2.1.1.1.1.3.2.2" xref="S3.E8.m1.2.2.1.1.1.1.3.2.2a.cmml">g</mtext><mn id="S3.E8.m1.2.2.1.1.1.1.3.2.3" xref="S3.E8.m1.2.2.1.1.1.1.3.2.3.cmml">1</mn></msub><mo id="S3.E8.m1.2.2.1.1.1.1.3.1" xref="S3.E8.m1.2.2.1.1.1.1.3.1.cmml">−</mo><msub id="S3.E8.m1.2.2.1.1.1.1.3.3" xref="S3.E8.m1.2.2.1.1.1.1.3.3.cmml"><mtext id="S3.E8.m1.2.2.1.1.1.1.3.3.2" xref="S3.E8.m1.2.2.1.1.1.1.3.3.2a.cmml">g</mtext><mn id="S3.E8.m1.2.2.1.1.1.1.3.3.3" xref="S3.E8.m1.2.2.1.1.1.1.3.3.3.cmml">2</mn></msub></mrow><mo id="S3.E8.m1.2.2.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.2.cmml">+</mo><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml">log</mi><mo id="S3.E8.m1.2.2.1.1.1.1.1.1a" xref="S3.E8.m1.2.2.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E8.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">ρ</mi><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">/</mo><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">ρ</mi></mrow><mo stretchy="false" id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E8.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m1.2.2.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.2.cmml">&gt;</mo><mn id="S3.E8.m1.2.2.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.3.cmml">0</mn></mrow><mo stretchy="false" id="S3.E8.m1.2.2.1.1.3" xref="S3.E8.m1.2.2.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.2b"><apply id="S3.E8.m1.2.2.cmml" xref="S3.E8.m1.2.2"><eq id="S3.E8.m1.2.2.2.cmml" xref="S3.E8.m1.2.2.2"></eq><csymbol cd="latexml" id="S3.E8.m1.2.2.3.cmml" xref="S3.E8.m1.2.2.3">absent</csymbol><apply id="S3.E8.m1.2.2.1.2.cmml" xref="S3.E8.m1.2.2.1.1"><csymbol cd="latexml" id="S3.E8.m1.2.2.1.2.1.cmml" xref="S3.E8.m1.2.2.1.1.2">delimited-[]</csymbol><apply id="S3.E8.m1.2.2.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1"><gt id="S3.E8.m1.2.2.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.2"></gt><apply id="S3.E8.m1.2.2.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1"><plus id="S3.E8.m1.2.2.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.2"></plus><apply id="S3.E8.m1.2.2.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3"><minus id="S3.E8.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3.1"></minus><apply id="S3.E8.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.3.2.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.3.2.2a.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3.2.2"><mtext id="S3.E8.m1.2.2.1.1.1.1.3.2.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3.2.2">g</mtext></ci><cn type="integer" id="S3.E8.m1.2.2.1.1.1.1.3.2.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3.2.3">1</cn></apply><apply id="S3.E8.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.3.3.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.3.3.2a.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3.3.2"><mtext id="S3.E8.m1.2.2.1.1.1.1.3.3.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3.3.2">g</mtext></ci><cn type="integer" id="S3.E8.m1.2.2.1.1.1.1.3.3.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3.3.3">2</cn></apply></apply><apply id="S3.E8.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1"><log id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1"></log><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1"><divide id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.2"></divide><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.3">𝜌</ci><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">𝜌</ci></apply></apply></apply></apply><cn type="integer" id="S3.E8.m1.2.2.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.2c">\displaystyle=[\textnormal{g}_{1}-\textnormal{g}_{2}+\log(\rho/(1-\rho))&gt;0]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
<tbody id="S3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E9.m2.2" class="ltx_Math" alttext="\displaystyle=[\textnormal{t}+\log(\rho/(1-\rho))&gt;0]" display="inline"><semantics id="S3.E9.m2.2a"><mrow id="S3.E9.m2.2.2" xref="S3.E9.m2.2.2.cmml"><mi id="S3.E9.m2.2.2.3" xref="S3.E9.m2.2.2.3.cmml"></mi><mo id="S3.E9.m2.2.2.2" xref="S3.E9.m2.2.2.2.cmml">=</mo><mrow id="S3.E9.m2.2.2.1.1" xref="S3.E9.m2.2.2.1.2.cmml"><mo stretchy="false" id="S3.E9.m2.2.2.1.1.2" xref="S3.E9.m2.2.2.1.2.1.cmml">[</mo><mrow id="S3.E9.m2.2.2.1.1.1" xref="S3.E9.m2.2.2.1.1.1.cmml"><mrow id="S3.E9.m2.2.2.1.1.1.1" xref="S3.E9.m2.2.2.1.1.1.1.cmml"><mtext id="S3.E9.m2.2.2.1.1.1.1.3" xref="S3.E9.m2.2.2.1.1.1.1.3a.cmml">t</mtext><mo id="S3.E9.m2.2.2.1.1.1.1.2" xref="S3.E9.m2.2.2.1.1.1.1.2.cmml">+</mo><mrow id="S3.E9.m2.2.2.1.1.1.1.1.1" xref="S3.E9.m2.2.2.1.1.1.1.1.2.cmml"><mi id="S3.E9.m2.1.1" xref="S3.E9.m2.1.1.cmml">log</mi><mo id="S3.E9.m2.2.2.1.1.1.1.1.1a" xref="S3.E9.m2.2.2.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E9.m2.2.2.1.1.1.1.1.1.1" xref="S3.E9.m2.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E9.m2.2.2.1.1.1.1.1.1.1.2" xref="S3.E9.m2.2.2.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E9.m2.2.2.1.1.1.1.1.1.1.1" xref="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.3.cmml">ρ</mi><mo id="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.2.cmml">/</mo><mrow id="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">ρ</mi></mrow><mo stretchy="false" id="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E9.m2.2.2.1.1.1.1.1.1.1.3" xref="S3.E9.m2.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E9.m2.2.2.1.1.1.2" xref="S3.E9.m2.2.2.1.1.1.2.cmml">&gt;</mo><mn id="S3.E9.m2.2.2.1.1.1.3" xref="S3.E9.m2.2.2.1.1.1.3.cmml">0</mn></mrow><mo stretchy="false" id="S3.E9.m2.2.2.1.1.3" xref="S3.E9.m2.2.2.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m2.2b"><apply id="S3.E9.m2.2.2.cmml" xref="S3.E9.m2.2.2"><eq id="S3.E9.m2.2.2.2.cmml" xref="S3.E9.m2.2.2.2"></eq><csymbol cd="latexml" id="S3.E9.m2.2.2.3.cmml" xref="S3.E9.m2.2.2.3">absent</csymbol><apply id="S3.E9.m2.2.2.1.2.cmml" xref="S3.E9.m2.2.2.1.1"><csymbol cd="latexml" id="S3.E9.m2.2.2.1.2.1.cmml" xref="S3.E9.m2.2.2.1.1.2">delimited-[]</csymbol><apply id="S3.E9.m2.2.2.1.1.1.cmml" xref="S3.E9.m2.2.2.1.1.1"><gt id="S3.E9.m2.2.2.1.1.1.2.cmml" xref="S3.E9.m2.2.2.1.1.1.2"></gt><apply id="S3.E9.m2.2.2.1.1.1.1.cmml" xref="S3.E9.m2.2.2.1.1.1.1"><plus id="S3.E9.m2.2.2.1.1.1.1.2.cmml" xref="S3.E9.m2.2.2.1.1.1.1.2"></plus><ci id="S3.E9.m2.2.2.1.1.1.1.3a.cmml" xref="S3.E9.m2.2.2.1.1.1.1.3"><mtext id="S3.E9.m2.2.2.1.1.1.1.3.cmml" xref="S3.E9.m2.2.2.1.1.1.1.3">t</mtext></ci><apply id="S3.E9.m2.2.2.1.1.1.1.1.2.cmml" xref="S3.E9.m2.2.2.1.1.1.1.1.1"><log id="S3.E9.m2.1.1.cmml" xref="S3.E9.m2.1.1"></log><apply id="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m2.2.2.1.1.1.1.1.1.1.1"><divide id="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.2"></divide><ci id="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.3">𝜌</ci><apply id="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.3">𝜌</ci></apply></apply></apply></apply><cn type="integer" id="S3.E9.m2.2.2.1.1.1.3.cmml" xref="S3.E9.m2.2.2.1.1.1.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m2.2c">\displaystyle=[\textnormal{t}+\log(\rho/(1-\rho))&gt;0]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p3.12" class="ltx_p">where <math id="S3.SS3.p3.9.m1.2" class="ltx_Math" alttext="\textnormal{t}\sim\text{Logistic}(0,1)" display="inline"><semantics id="S3.SS3.p3.9.m1.2a"><mrow id="S3.SS3.p3.9.m1.2.3" xref="S3.SS3.p3.9.m1.2.3.cmml"><mtext id="S3.SS3.p3.9.m1.2.3.2" xref="S3.SS3.p3.9.m1.2.3.2a.cmml">t</mtext><mo id="S3.SS3.p3.9.m1.2.3.1" xref="S3.SS3.p3.9.m1.2.3.1.cmml">∼</mo><mrow id="S3.SS3.p3.9.m1.2.3.3" xref="S3.SS3.p3.9.m1.2.3.3.cmml"><mtext id="S3.SS3.p3.9.m1.2.3.3.2" xref="S3.SS3.p3.9.m1.2.3.3.2a.cmml">Logistic</mtext><mo lspace="0em" rspace="0em" id="S3.SS3.p3.9.m1.2.3.3.1" xref="S3.SS3.p3.9.m1.2.3.3.1.cmml">​</mo><mrow id="S3.SS3.p3.9.m1.2.3.3.3.2" xref="S3.SS3.p3.9.m1.2.3.3.3.1.cmml"><mo stretchy="false" id="S3.SS3.p3.9.m1.2.3.3.3.2.1" xref="S3.SS3.p3.9.m1.2.3.3.3.1.cmml">(</mo><mn id="S3.SS3.p3.9.m1.1.1" xref="S3.SS3.p3.9.m1.1.1.cmml">0</mn><mo id="S3.SS3.p3.9.m1.2.3.3.3.2.2" xref="S3.SS3.p3.9.m1.2.3.3.3.1.cmml">,</mo><mn id="S3.SS3.p3.9.m1.2.2" xref="S3.SS3.p3.9.m1.2.2.cmml">1</mn><mo stretchy="false" id="S3.SS3.p3.9.m1.2.3.3.3.2.3" xref="S3.SS3.p3.9.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.9.m1.2b"><apply id="S3.SS3.p3.9.m1.2.3.cmml" xref="S3.SS3.p3.9.m1.2.3"><csymbol cd="latexml" id="S3.SS3.p3.9.m1.2.3.1.cmml" xref="S3.SS3.p3.9.m1.2.3.1">similar-to</csymbol><ci id="S3.SS3.p3.9.m1.2.3.2a.cmml" xref="S3.SS3.p3.9.m1.2.3.2"><mtext id="S3.SS3.p3.9.m1.2.3.2.cmml" xref="S3.SS3.p3.9.m1.2.3.2">t</mtext></ci><apply id="S3.SS3.p3.9.m1.2.3.3.cmml" xref="S3.SS3.p3.9.m1.2.3.3"><times id="S3.SS3.p3.9.m1.2.3.3.1.cmml" xref="S3.SS3.p3.9.m1.2.3.3.1"></times><ci id="S3.SS3.p3.9.m1.2.3.3.2a.cmml" xref="S3.SS3.p3.9.m1.2.3.3.2"><mtext id="S3.SS3.p3.9.m1.2.3.3.2.cmml" xref="S3.SS3.p3.9.m1.2.3.3.2">Logistic</mtext></ci><interval closure="open" id="S3.SS3.p3.9.m1.2.3.3.3.1.cmml" xref="S3.SS3.p3.9.m1.2.3.3.3.2"><cn type="integer" id="S3.SS3.p3.9.m1.1.1.cmml" xref="S3.SS3.p3.9.m1.1.1">0</cn><cn type="integer" id="S3.SS3.p3.9.m1.2.2.cmml" xref="S3.SS3.p3.9.m1.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.9.m1.2c">\textnormal{t}\sim\text{Logistic}(0,1)</annotation></semantics></math> and the bracketed notation [statement] stands for <math id="S3.SS3.p3.10.m2.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S3.SS3.p3.10.m2.1a"><mn id="S3.SS3.p3.10.m2.1.1" xref="S3.SS3.p3.10.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.10.m2.1b"><cn type="integer" id="S3.SS3.p3.10.m2.1.1.cmml" xref="S3.SS3.p3.10.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.10.m2.1c">1</annotation></semantics></math> if statement is true, <math id="S3.SS3.p3.11.m3.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S3.SS3.p3.11.m3.1a"><mn id="S3.SS3.p3.11.m3.1.1" xref="S3.SS3.p3.11.m3.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.11.m3.1b"><cn type="integer" id="S3.SS3.p3.11.m3.1.1.cmml" xref="S3.SS3.p3.11.m3.1.1">0</cn></annotation-xml></semantics></math> otherwise.
The derivation of Eq.(<a href="#S3.E9" title="In 3.3 Routing Network ‣ 3 METHODOLOGY ‣ Question Guided Modular Routing Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>) uses the fact that the difference of two Gumbels variables follows a Logistic distribution<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>To sample from Logistic distribution, computing random variable <span id="footnote3.1" class="ltx_text ltx_markedasmath">t</span> as <math id="footnote3.m2.4" class="ltx_Math" alttext="\textnormal{t}=\log(\textnormal{u})-\log(1-\textnormal{u})" display="inline"><semantics id="footnote3.m2.4b"><mrow id="footnote3.m2.4.4" xref="footnote3.m2.4.4.cmml"><mtext id="footnote3.m2.4.4.3" xref="footnote3.m2.4.4.3a.cmml">t</mtext><mo id="footnote3.m2.4.4.2" xref="footnote3.m2.4.4.2.cmml">=</mo><mrow id="footnote3.m2.4.4.1" xref="footnote3.m2.4.4.1.cmml"><mrow id="footnote3.m2.4.4.1.3.2" xref="footnote3.m2.4.4.1.3.1.cmml"><mi id="footnote3.m2.1.1" xref="footnote3.m2.1.1.cmml">log</mi><mo id="footnote3.m2.4.4.1.3.2b" xref="footnote3.m2.4.4.1.3.1.cmml">⁡</mo><mrow id="footnote3.m2.4.4.1.3.2.1" xref="footnote3.m2.4.4.1.3.1.cmml"><mo stretchy="false" id="footnote3.m2.4.4.1.3.2.1.1" xref="footnote3.m2.4.4.1.3.1.cmml">(</mo><mtext id="footnote3.m2.2.2" xref="footnote3.m2.2.2a.cmml">u</mtext><mo stretchy="false" id="footnote3.m2.4.4.1.3.2.1.2" xref="footnote3.m2.4.4.1.3.1.cmml">)</mo></mrow></mrow><mo id="footnote3.m2.4.4.1.2" xref="footnote3.m2.4.4.1.2.cmml">−</mo><mrow id="footnote3.m2.4.4.1.1.1" xref="footnote3.m2.4.4.1.1.2.cmml"><mi id="footnote3.m2.3.3" xref="footnote3.m2.3.3.cmml">log</mi><mo id="footnote3.m2.4.4.1.1.1b" xref="footnote3.m2.4.4.1.1.2.cmml">⁡</mo><mrow id="footnote3.m2.4.4.1.1.1.1" xref="footnote3.m2.4.4.1.1.2.cmml"><mo stretchy="false" id="footnote3.m2.4.4.1.1.1.1.2" xref="footnote3.m2.4.4.1.1.2.cmml">(</mo><mrow id="footnote3.m2.4.4.1.1.1.1.1" xref="footnote3.m2.4.4.1.1.1.1.1.cmml"><mn id="footnote3.m2.4.4.1.1.1.1.1.2" xref="footnote3.m2.4.4.1.1.1.1.1.2.cmml">1</mn><mo id="footnote3.m2.4.4.1.1.1.1.1.1" xref="footnote3.m2.4.4.1.1.1.1.1.1.cmml">−</mo><mtext id="footnote3.m2.4.4.1.1.1.1.1.3" xref="footnote3.m2.4.4.1.1.1.1.1.3a.cmml">u</mtext></mrow><mo stretchy="false" id="footnote3.m2.4.4.1.1.1.1.3" xref="footnote3.m2.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnote3.m2.4c"><apply id="footnote3.m2.4.4.cmml" xref="footnote3.m2.4.4"><eq id="footnote3.m2.4.4.2.cmml" xref="footnote3.m2.4.4.2"></eq><ci id="footnote3.m2.4.4.3a.cmml" xref="footnote3.m2.4.4.3"><mtext id="footnote3.m2.4.4.3.cmml" xref="footnote3.m2.4.4.3">t</mtext></ci><apply id="footnote3.m2.4.4.1.cmml" xref="footnote3.m2.4.4.1"><minus id="footnote3.m2.4.4.1.2.cmml" xref="footnote3.m2.4.4.1.2"></minus><apply id="footnote3.m2.4.4.1.3.1.cmml" xref="footnote3.m2.4.4.1.3.2"><log id="footnote3.m2.1.1.cmml" xref="footnote3.m2.1.1"></log><ci id="footnote3.m2.2.2a.cmml" xref="footnote3.m2.2.2"><mtext id="footnote3.m2.2.2.cmml" xref="footnote3.m2.2.2">u</mtext></ci></apply><apply id="footnote3.m2.4.4.1.1.2.cmml" xref="footnote3.m2.4.4.1.1.1"><log id="footnote3.m2.3.3.cmml" xref="footnote3.m2.3.3"></log><apply id="footnote3.m2.4.4.1.1.1.1.1.cmml" xref="footnote3.m2.4.4.1.1.1.1.1"><minus id="footnote3.m2.4.4.1.1.1.1.1.1.cmml" xref="footnote3.m2.4.4.1.1.1.1.1.1"></minus><cn type="integer" id="footnote3.m2.4.4.1.1.1.1.1.2.cmml" xref="footnote3.m2.4.4.1.1.1.1.1.2">1</cn><ci id="footnote3.m2.4.4.1.1.1.1.1.3a.cmml" xref="footnote3.m2.4.4.1.1.1.1.1.3"><mtext id="footnote3.m2.4.4.1.1.1.1.1.3.cmml" xref="footnote3.m2.4.4.1.1.1.1.1.3">u</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote3.m2.4d">\textnormal{t}=\log(\textnormal{u})-\log(1-\textnormal{u})</annotation></semantics></math> where <math id="footnote3.m3.2" class="ltx_Math" alttext="\textnormal{u}\sim\text{Uniform}(0,1)" display="inline"><semantics id="footnote3.m3.2b"><mrow id="footnote3.m3.2.3" xref="footnote3.m3.2.3.cmml"><mtext id="footnote3.m3.2.3.2" xref="footnote3.m3.2.3.2a.cmml">u</mtext><mo id="footnote3.m3.2.3.1" xref="footnote3.m3.2.3.1.cmml">∼</mo><mrow id="footnote3.m3.2.3.3" xref="footnote3.m3.2.3.3.cmml"><mtext id="footnote3.m3.2.3.3.2" xref="footnote3.m3.2.3.3.2a.cmml">Uniform</mtext><mo lspace="0em" rspace="0em" id="footnote3.m3.2.3.3.1" xref="footnote3.m3.2.3.3.1.cmml">​</mo><mrow id="footnote3.m3.2.3.3.3.2" xref="footnote3.m3.2.3.3.3.1.cmml"><mo stretchy="false" id="footnote3.m3.2.3.3.3.2.1" xref="footnote3.m3.2.3.3.3.1.cmml">(</mo><mn id="footnote3.m3.1.1" xref="footnote3.m3.1.1.cmml">0</mn><mo id="footnote3.m3.2.3.3.3.2.2" xref="footnote3.m3.2.3.3.3.1.cmml">,</mo><mn id="footnote3.m3.2.2" xref="footnote3.m3.2.2.cmml">1</mn><mo stretchy="false" id="footnote3.m3.2.3.3.3.2.3" xref="footnote3.m3.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnote3.m3.2c"><apply id="footnote3.m3.2.3.cmml" xref="footnote3.m3.2.3"><csymbol cd="latexml" id="footnote3.m3.2.3.1.cmml" xref="footnote3.m3.2.3.1">similar-to</csymbol><ci id="footnote3.m3.2.3.2a.cmml" xref="footnote3.m3.2.3.2"><mtext id="footnote3.m3.2.3.2.cmml" xref="footnote3.m3.2.3.2">u</mtext></ci><apply id="footnote3.m3.2.3.3.cmml" xref="footnote3.m3.2.3.3"><times id="footnote3.m3.2.3.3.1.cmml" xref="footnote3.m3.2.3.3.1"></times><ci id="footnote3.m3.2.3.3.2a.cmml" xref="footnote3.m3.2.3.3.2"><mtext id="footnote3.m3.2.3.3.2.cmml" xref="footnote3.m3.2.3.3.2">Uniform</mtext></ci><interval closure="open" id="footnote3.m3.2.3.3.3.1.cmml" xref="footnote3.m3.2.3.3.3.2"><cn type="integer" id="footnote3.m3.1.1.cmml" xref="footnote3.m3.1.1">0</cn><cn type="integer" id="footnote3.m3.2.2.cmml" xref="footnote3.m3.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote3.m3.2d">\textnormal{u}\sim\text{Uniform}(0,1)</annotation></semantics></math>, then <math id="footnote3.m4.2" class="ltx_Math" alttext="\textnormal{t}\sim\text{Logistic}(0,1)" display="inline"><semantics id="footnote3.m4.2b"><mrow id="footnote3.m4.2.3" xref="footnote3.m4.2.3.cmml"><mtext id="footnote3.m4.2.3.2" xref="footnote3.m4.2.3.2a.cmml">t</mtext><mo id="footnote3.m4.2.3.1" xref="footnote3.m4.2.3.1.cmml">∼</mo><mrow id="footnote3.m4.2.3.3" xref="footnote3.m4.2.3.3.cmml"><mtext id="footnote3.m4.2.3.3.2" xref="footnote3.m4.2.3.3.2a.cmml">Logistic</mtext><mo lspace="0em" rspace="0em" id="footnote3.m4.2.3.3.1" xref="footnote3.m4.2.3.3.1.cmml">​</mo><mrow id="footnote3.m4.2.3.3.3.2" xref="footnote3.m4.2.3.3.3.1.cmml"><mo stretchy="false" id="footnote3.m4.2.3.3.3.2.1" xref="footnote3.m4.2.3.3.3.1.cmml">(</mo><mn id="footnote3.m4.1.1" xref="footnote3.m4.1.1.cmml">0</mn><mo id="footnote3.m4.2.3.3.3.2.2" xref="footnote3.m4.2.3.3.3.1.cmml">,</mo><mn id="footnote3.m4.2.2" xref="footnote3.m4.2.2.cmml">1</mn><mo stretchy="false" id="footnote3.m4.2.3.3.3.2.3" xref="footnote3.m4.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnote3.m4.2c"><apply id="footnote3.m4.2.3.cmml" xref="footnote3.m4.2.3"><csymbol cd="latexml" id="footnote3.m4.2.3.1.cmml" xref="footnote3.m4.2.3.1">similar-to</csymbol><ci id="footnote3.m4.2.3.2a.cmml" xref="footnote3.m4.2.3.2"><mtext id="footnote3.m4.2.3.2.cmml" xref="footnote3.m4.2.3.2">t</mtext></ci><apply id="footnote3.m4.2.3.3.cmml" xref="footnote3.m4.2.3.3"><times id="footnote3.m4.2.3.3.1.cmml" xref="footnote3.m4.2.3.3.1"></times><ci id="footnote3.m4.2.3.3.2a.cmml" xref="footnote3.m4.2.3.3.2"><mtext id="footnote3.m4.2.3.3.2.cmml" xref="footnote3.m4.2.3.3.2">Logistic</mtext></ci><interval closure="open" id="footnote3.m4.2.3.3.3.1.cmml" xref="footnote3.m4.2.3.3.3.2"><cn type="integer" id="footnote3.m4.1.1.cmml" xref="footnote3.m4.1.1">0</cn><cn type="integer" id="footnote3.m4.2.2.cmml" xref="footnote3.m4.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote3.m4.2d">\textnormal{t}\sim\text{Logistic}(0,1)</annotation></semantics></math></span></span></span>, <span id="S3.SS3.p3.12.1" class="ltx_text ltx_font_italic">i.e.,</span> <math id="S3.SS3.p3.12.m4.2" class="ltx_Math" alttext="\textnormal{g}_{1}-\textnormal{g}_{2}\sim\text{Logistic}(0,1)" display="inline"><semantics id="S3.SS3.p3.12.m4.2a"><mrow id="S3.SS3.p3.12.m4.2.3" xref="S3.SS3.p3.12.m4.2.3.cmml"><mrow id="S3.SS3.p3.12.m4.2.3.2" xref="S3.SS3.p3.12.m4.2.3.2.cmml"><msub id="S3.SS3.p3.12.m4.2.3.2.2" xref="S3.SS3.p3.12.m4.2.3.2.2.cmml"><mtext id="S3.SS3.p3.12.m4.2.3.2.2.2" xref="S3.SS3.p3.12.m4.2.3.2.2.2a.cmml">g</mtext><mn id="S3.SS3.p3.12.m4.2.3.2.2.3" xref="S3.SS3.p3.12.m4.2.3.2.2.3.cmml">1</mn></msub><mo id="S3.SS3.p3.12.m4.2.3.2.1" xref="S3.SS3.p3.12.m4.2.3.2.1.cmml">−</mo><msub id="S3.SS3.p3.12.m4.2.3.2.3" xref="S3.SS3.p3.12.m4.2.3.2.3.cmml"><mtext id="S3.SS3.p3.12.m4.2.3.2.3.2" xref="S3.SS3.p3.12.m4.2.3.2.3.2a.cmml">g</mtext><mn id="S3.SS3.p3.12.m4.2.3.2.3.3" xref="S3.SS3.p3.12.m4.2.3.2.3.3.cmml">2</mn></msub></mrow><mo id="S3.SS3.p3.12.m4.2.3.1" xref="S3.SS3.p3.12.m4.2.3.1.cmml">∼</mo><mrow id="S3.SS3.p3.12.m4.2.3.3" xref="S3.SS3.p3.12.m4.2.3.3.cmml"><mtext id="S3.SS3.p3.12.m4.2.3.3.2" xref="S3.SS3.p3.12.m4.2.3.3.2a.cmml">Logistic</mtext><mo lspace="0em" rspace="0em" id="S3.SS3.p3.12.m4.2.3.3.1" xref="S3.SS3.p3.12.m4.2.3.3.1.cmml">​</mo><mrow id="S3.SS3.p3.12.m4.2.3.3.3.2" xref="S3.SS3.p3.12.m4.2.3.3.3.1.cmml"><mo stretchy="false" id="S3.SS3.p3.12.m4.2.3.3.3.2.1" xref="S3.SS3.p3.12.m4.2.3.3.3.1.cmml">(</mo><mn id="S3.SS3.p3.12.m4.1.1" xref="S3.SS3.p3.12.m4.1.1.cmml">0</mn><mo id="S3.SS3.p3.12.m4.2.3.3.3.2.2" xref="S3.SS3.p3.12.m4.2.3.3.3.1.cmml">,</mo><mn id="S3.SS3.p3.12.m4.2.2" xref="S3.SS3.p3.12.m4.2.2.cmml">1</mn><mo stretchy="false" id="S3.SS3.p3.12.m4.2.3.3.3.2.3" xref="S3.SS3.p3.12.m4.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.12.m4.2b"><apply id="S3.SS3.p3.12.m4.2.3.cmml" xref="S3.SS3.p3.12.m4.2.3"><csymbol cd="latexml" id="S3.SS3.p3.12.m4.2.3.1.cmml" xref="S3.SS3.p3.12.m4.2.3.1">similar-to</csymbol><apply id="S3.SS3.p3.12.m4.2.3.2.cmml" xref="S3.SS3.p3.12.m4.2.3.2"><minus id="S3.SS3.p3.12.m4.2.3.2.1.cmml" xref="S3.SS3.p3.12.m4.2.3.2.1"></minus><apply id="S3.SS3.p3.12.m4.2.3.2.2.cmml" xref="S3.SS3.p3.12.m4.2.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.12.m4.2.3.2.2.1.cmml" xref="S3.SS3.p3.12.m4.2.3.2.2">subscript</csymbol><ci id="S3.SS3.p3.12.m4.2.3.2.2.2a.cmml" xref="S3.SS3.p3.12.m4.2.3.2.2.2"><mtext id="S3.SS3.p3.12.m4.2.3.2.2.2.cmml" xref="S3.SS3.p3.12.m4.2.3.2.2.2">g</mtext></ci><cn type="integer" id="S3.SS3.p3.12.m4.2.3.2.2.3.cmml" xref="S3.SS3.p3.12.m4.2.3.2.2.3">1</cn></apply><apply id="S3.SS3.p3.12.m4.2.3.2.3.cmml" xref="S3.SS3.p3.12.m4.2.3.2.3"><csymbol cd="ambiguous" id="S3.SS3.p3.12.m4.2.3.2.3.1.cmml" xref="S3.SS3.p3.12.m4.2.3.2.3">subscript</csymbol><ci id="S3.SS3.p3.12.m4.2.3.2.3.2a.cmml" xref="S3.SS3.p3.12.m4.2.3.2.3.2"><mtext id="S3.SS3.p3.12.m4.2.3.2.3.2.cmml" xref="S3.SS3.p3.12.m4.2.3.2.3.2">g</mtext></ci><cn type="integer" id="S3.SS3.p3.12.m4.2.3.2.3.3.cmml" xref="S3.SS3.p3.12.m4.2.3.2.3.3">2</cn></apply></apply><apply id="S3.SS3.p3.12.m4.2.3.3.cmml" xref="S3.SS3.p3.12.m4.2.3.3"><times id="S3.SS3.p3.12.m4.2.3.3.1.cmml" xref="S3.SS3.p3.12.m4.2.3.3.1"></times><ci id="S3.SS3.p3.12.m4.2.3.3.2a.cmml" xref="S3.SS3.p3.12.m4.2.3.3.2"><mtext id="S3.SS3.p3.12.m4.2.3.3.2.cmml" xref="S3.SS3.p3.12.m4.2.3.3.2">Logistic</mtext></ci><interval closure="open" id="S3.SS3.p3.12.m4.2.3.3.3.1.cmml" xref="S3.SS3.p3.12.m4.2.3.3.3.2"><cn type="integer" id="S3.SS3.p3.12.m4.1.1.cmml" xref="S3.SS3.p3.12.m4.1.1">0</cn><cn type="integer" id="S3.SS3.p3.12.m4.2.2.cmml" xref="S3.SS3.p3.12.m4.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.12.m4.2c">\textnormal{g}_{1}-\textnormal{g}_{2}\sim\text{Logistic}(0,1)</annotation></semantics></math>. Just as we use the softmax function with temperature to approximate the argmax function, here we use the sigmoid function with temperature to approximate the unit step function:</p>
<table id="S3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E10.m1.2" class="ltx_Math" alttext="\tilde{\textnormal{b}}=\text{sigmoid}((\textnormal{t}+\log(\rho/(1-\rho)))/\tau)" display="block"><semantics id="S3.E10.m1.2a"><mrow id="S3.E10.m1.2.2" xref="S3.E10.m1.2.2.cmml"><mover accent="true" id="S3.E10.m1.2.2.3" xref="S3.E10.m1.2.2.3.cmml"><mtext id="S3.E10.m1.2.2.3.2" xref="S3.E10.m1.2.2.3.2a.cmml">b</mtext><mo id="S3.E10.m1.2.2.3.1" xref="S3.E10.m1.2.2.3.1.cmml">~</mo></mover><mo id="S3.E10.m1.2.2.2" xref="S3.E10.m1.2.2.2.cmml">=</mo><mrow id="S3.E10.m1.2.2.1" xref="S3.E10.m1.2.2.1.cmml"><mtext id="S3.E10.m1.2.2.1.3" xref="S3.E10.m1.2.2.1.3a.cmml">sigmoid</mtext><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.2" xref="S3.E10.m1.2.2.1.2.cmml">​</mo><mrow id="S3.E10.m1.2.2.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E10.m1.2.2.1.1.1.2" xref="S3.E10.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E10.m1.2.2.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.cmml"><mrow id="S3.E10.m1.2.2.1.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E10.m1.2.2.1.1.1.1.1.1.2" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E10.m1.2.2.1.1.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.cmml"><mtext id="S3.E10.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.3a.cmml">t</mtext><mo id="S3.E10.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml">log</mi><mo id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1a" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">ρ</mi><mo id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">/</mo><mrow id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">ρ</mi></mrow><mo stretchy="false" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E10.m1.2.2.1.1.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E10.m1.2.2.1.1.1.1.2" xref="S3.E10.m1.2.2.1.1.1.1.2.cmml">/</mo><mi id="S3.E10.m1.2.2.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.1.3.cmml">τ</mi></mrow><mo stretchy="false" id="S3.E10.m1.2.2.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.2b"><apply id="S3.E10.m1.2.2.cmml" xref="S3.E10.m1.2.2"><eq id="S3.E10.m1.2.2.2.cmml" xref="S3.E10.m1.2.2.2"></eq><apply id="S3.E10.m1.2.2.3.cmml" xref="S3.E10.m1.2.2.3"><ci id="S3.E10.m1.2.2.3.1.cmml" xref="S3.E10.m1.2.2.3.1">~</ci><ci id="S3.E10.m1.2.2.3.2a.cmml" xref="S3.E10.m1.2.2.3.2"><mtext id="S3.E10.m1.2.2.3.2.cmml" xref="S3.E10.m1.2.2.3.2">b</mtext></ci></apply><apply id="S3.E10.m1.2.2.1.cmml" xref="S3.E10.m1.2.2.1"><times id="S3.E10.m1.2.2.1.2.cmml" xref="S3.E10.m1.2.2.1.2"></times><ci id="S3.E10.m1.2.2.1.3a.cmml" xref="S3.E10.m1.2.2.1.3"><mtext id="S3.E10.m1.2.2.1.3.cmml" xref="S3.E10.m1.2.2.1.3">sigmoid</mtext></ci><apply id="S3.E10.m1.2.2.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1"><divide id="S3.E10.m1.2.2.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.2"></divide><apply id="S3.E10.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1"><plus id="S3.E10.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.2"></plus><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.1.3a.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.3"><mtext id="S3.E10.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.3">t</mtext></ci><apply id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1"><log id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1"></log><apply id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><divide id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2"></divide><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">𝜌</ci><apply id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝜌</ci></apply></apply></apply></apply><ci id="S3.E10.m1.2.2.1.1.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.3">𝜏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.2c">\tilde{\textnormal{b}}=\text{sigmoid}((\textnormal{t}+\log(\rho/(1-\rho)))/\tau)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p3.13" class="ltx_p">as <math id="S3.SS3.p3.13.m1.1" class="ltx_Math" alttext="\tau\rightarrow 0" display="inline"><semantics id="S3.SS3.p3.13.m1.1a"><mrow id="S3.SS3.p3.13.m1.1.1" xref="S3.SS3.p3.13.m1.1.1.cmml"><mi id="S3.SS3.p3.13.m1.1.1.2" xref="S3.SS3.p3.13.m1.1.1.2.cmml">τ</mi><mo stretchy="false" id="S3.SS3.p3.13.m1.1.1.1" xref="S3.SS3.p3.13.m1.1.1.1.cmml">→</mo><mn id="S3.SS3.p3.13.m1.1.1.3" xref="S3.SS3.p3.13.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.13.m1.1b"><apply id="S3.SS3.p3.13.m1.1.1.cmml" xref="S3.SS3.p3.13.m1.1.1"><ci id="S3.SS3.p3.13.m1.1.1.1.cmml" xref="S3.SS3.p3.13.m1.1.1.1">→</ci><ci id="S3.SS3.p3.13.m1.1.1.2.cmml" xref="S3.SS3.p3.13.m1.1.1.2">𝜏</ci><cn type="integer" id="S3.SS3.p3.13.m1.1.1.3.cmml" xref="S3.SS3.p3.13.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.13.m1.1c">\tau\rightarrow 0</annotation></semantics></math>, the sigmoid function is smoothly approaching the unit step function. Readers who are interested in Gumbel-Softmax or Concrete Distribution are referred to (<span id="S3.SS3.p3.13.1" class="ltx_text ltx_font_bold">?</span>; <span id="S3.SS3.p3.13.2" class="ltx_text ltx_font_bold">?</span>) for more details.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<p id="S3.SS3.p4.3" class="ltx_p">Based on previous discussion, we can convert the <span id="S3.SS3.p4.3.1" class="ltx_text ltx_font_italic">real-valued</span> <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="\mathbf{\tilde{P}}" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><mover accent="true" id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml"><mi id="S3.SS3.p4.1.m1.1.1.2" xref="S3.SS3.p4.1.m1.1.1.2.cmml">𝐏</mi><mo id="S3.SS3.p4.1.m1.1.1.1" xref="S3.SS3.p4.1.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><apply id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1"><ci id="S3.SS3.p4.1.m1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1">~</ci><ci id="S3.SS3.p4.1.m1.1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.1.2">𝐏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">\mathbf{\tilde{P}}</annotation></semantics></math> to binary value in a simple way. First, for each entry <math id="S3.SS3.p4.2.m2.2" class="ltx_Math" alttext="\mathbf{\tilde{P}}_{l,m}" display="inline"><semantics id="S3.SS3.p4.2.m2.2a"><msub id="S3.SS3.p4.2.m2.2.3" xref="S3.SS3.p4.2.m2.2.3.cmml"><mover accent="true" id="S3.SS3.p4.2.m2.2.3.2" xref="S3.SS3.p4.2.m2.2.3.2.cmml"><mi id="S3.SS3.p4.2.m2.2.3.2.2" xref="S3.SS3.p4.2.m2.2.3.2.2.cmml">𝐏</mi><mo id="S3.SS3.p4.2.m2.2.3.2.1" xref="S3.SS3.p4.2.m2.2.3.2.1.cmml">~</mo></mover><mrow id="S3.SS3.p4.2.m2.2.2.2.4" xref="S3.SS3.p4.2.m2.2.2.2.3.cmml"><mi id="S3.SS3.p4.2.m2.1.1.1.1" xref="S3.SS3.p4.2.m2.1.1.1.1.cmml">l</mi><mo id="S3.SS3.p4.2.m2.2.2.2.4.1" xref="S3.SS3.p4.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p4.2.m2.2.2.2.2" xref="S3.SS3.p4.2.m2.2.2.2.2.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.2b"><apply id="S3.SS3.p4.2.m2.2.3.cmml" xref="S3.SS3.p4.2.m2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.2.3.1.cmml" xref="S3.SS3.p4.2.m2.2.3">subscript</csymbol><apply id="S3.SS3.p4.2.m2.2.3.2.cmml" xref="S3.SS3.p4.2.m2.2.3.2"><ci id="S3.SS3.p4.2.m2.2.3.2.1.cmml" xref="S3.SS3.p4.2.m2.2.3.2.1">~</ci><ci id="S3.SS3.p4.2.m2.2.3.2.2.cmml" xref="S3.SS3.p4.2.m2.2.3.2.2">𝐏</ci></apply><list id="S3.SS3.p4.2.m2.2.2.2.3.cmml" xref="S3.SS3.p4.2.m2.2.2.2.4"><ci id="S3.SS3.p4.2.m2.1.1.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1.1.1">𝑙</ci><ci id="S3.SS3.p4.2.m2.2.2.2.2.cmml" xref="S3.SS3.p4.2.m2.2.2.2.2">𝑚</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.2c">\mathbf{\tilde{P}}_{l,m}</annotation></semantics></math>, we compute <math id="S3.SS3.p4.3.m3.2" class="ltx_Math" alttext="\mathbf{\tilde{B}}_{l,m}" display="inline"><semantics id="S3.SS3.p4.3.m3.2a"><msub id="S3.SS3.p4.3.m3.2.3" xref="S3.SS3.p4.3.m3.2.3.cmml"><mover accent="true" id="S3.SS3.p4.3.m3.2.3.2" xref="S3.SS3.p4.3.m3.2.3.2.cmml"><mi id="S3.SS3.p4.3.m3.2.3.2.2" xref="S3.SS3.p4.3.m3.2.3.2.2.cmml">𝐁</mi><mo id="S3.SS3.p4.3.m3.2.3.2.1" xref="S3.SS3.p4.3.m3.2.3.2.1.cmml">~</mo></mover><mrow id="S3.SS3.p4.3.m3.2.2.2.4" xref="S3.SS3.p4.3.m3.2.2.2.3.cmml"><mi id="S3.SS3.p4.3.m3.1.1.1.1" xref="S3.SS3.p4.3.m3.1.1.1.1.cmml">l</mi><mo id="S3.SS3.p4.3.m3.2.2.2.4.1" xref="S3.SS3.p4.3.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p4.3.m3.2.2.2.2" xref="S3.SS3.p4.3.m3.2.2.2.2.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.2b"><apply id="S3.SS3.p4.3.m3.2.3.cmml" xref="S3.SS3.p4.3.m3.2.3"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.2.3.1.cmml" xref="S3.SS3.p4.3.m3.2.3">subscript</csymbol><apply id="S3.SS3.p4.3.m3.2.3.2.cmml" xref="S3.SS3.p4.3.m3.2.3.2"><ci id="S3.SS3.p4.3.m3.2.3.2.1.cmml" xref="S3.SS3.p4.3.m3.2.3.2.1">~</ci><ci id="S3.SS3.p4.3.m3.2.3.2.2.cmml" xref="S3.SS3.p4.3.m3.2.3.2.2">𝐁</ci></apply><list id="S3.SS3.p4.3.m3.2.2.2.3.cmml" xref="S3.SS3.p4.3.m3.2.2.2.4"><ci id="S3.SS3.p4.3.m3.1.1.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1.1.1">𝑙</ci><ci id="S3.SS3.p4.3.m3.2.2.2.2.cmml" xref="S3.SS3.p4.3.m3.2.2.2.2">𝑚</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.2c">\mathbf{\tilde{B}}_{l,m}</annotation></semantics></math> as:</p>
<table id="S3.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E11.m1.7" class="ltx_Math" alttext="\mathbf{\tilde{B}}_{l,m}=\text{sigmoid}((\textnormal{t}_{l,m}+\mathbf{\tilde{P}}_{l,m})/\tau)" display="block"><semantics id="S3.E11.m1.7a"><mrow id="S3.E11.m1.7.7" xref="S3.E11.m1.7.7.cmml"><msub id="S3.E11.m1.7.7.3" xref="S3.E11.m1.7.7.3.cmml"><mover accent="true" id="S3.E11.m1.7.7.3.2" xref="S3.E11.m1.7.7.3.2.cmml"><mi id="S3.E11.m1.7.7.3.2.2" xref="S3.E11.m1.7.7.3.2.2.cmml">𝐁</mi><mo id="S3.E11.m1.7.7.3.2.1" xref="S3.E11.m1.7.7.3.2.1.cmml">~</mo></mover><mrow id="S3.E11.m1.2.2.2.4" xref="S3.E11.m1.2.2.2.3.cmml"><mi id="S3.E11.m1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.cmml">l</mi><mo id="S3.E11.m1.2.2.2.4.1" xref="S3.E11.m1.2.2.2.3.cmml">,</mo><mi id="S3.E11.m1.2.2.2.2" xref="S3.E11.m1.2.2.2.2.cmml">m</mi></mrow></msub><mo id="S3.E11.m1.7.7.2" xref="S3.E11.m1.7.7.2.cmml">=</mo><mrow id="S3.E11.m1.7.7.1" xref="S3.E11.m1.7.7.1.cmml"><mtext id="S3.E11.m1.7.7.1.3" xref="S3.E11.m1.7.7.1.3a.cmml">sigmoid</mtext><mo lspace="0em" rspace="0em" id="S3.E11.m1.7.7.1.2" xref="S3.E11.m1.7.7.1.2.cmml">​</mo><mrow id="S3.E11.m1.7.7.1.1.1" xref="S3.E11.m1.7.7.1.1.1.1.cmml"><mo stretchy="false" id="S3.E11.m1.7.7.1.1.1.2" xref="S3.E11.m1.7.7.1.1.1.1.cmml">(</mo><mrow id="S3.E11.m1.7.7.1.1.1.1" xref="S3.E11.m1.7.7.1.1.1.1.cmml"><mrow id="S3.E11.m1.7.7.1.1.1.1.1.1" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E11.m1.7.7.1.1.1.1.1.1.2" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E11.m1.7.7.1.1.1.1.1.1.1" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.cmml"><msub id="S3.E11.m1.7.7.1.1.1.1.1.1.1.2" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.2.cmml"><mtext id="S3.E11.m1.7.7.1.1.1.1.1.1.1.2.2" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.2.2a.cmml">t</mtext><mrow id="S3.E11.m1.4.4.2.4" xref="S3.E11.m1.4.4.2.3.cmml"><mi id="S3.E11.m1.3.3.1.1" xref="S3.E11.m1.3.3.1.1.cmml">l</mi><mo id="S3.E11.m1.4.4.2.4.1" xref="S3.E11.m1.4.4.2.3.cmml">,</mo><mi id="S3.E11.m1.4.4.2.2" xref="S3.E11.m1.4.4.2.2.cmml">m</mi></mrow></msub><mo id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E11.m1.7.7.1.1.1.1.1.1.1.3" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E11.m1.7.7.1.1.1.1.1.1.1.3.2" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E11.m1.7.7.1.1.1.1.1.1.1.3.2.2" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.3.2.2.cmml">𝐏</mi><mo id="S3.E11.m1.7.7.1.1.1.1.1.1.1.3.2.1" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.3.2.1.cmml">~</mo></mover><mrow id="S3.E11.m1.6.6.2.4" xref="S3.E11.m1.6.6.2.3.cmml"><mi id="S3.E11.m1.5.5.1.1" xref="S3.E11.m1.5.5.1.1.cmml">l</mi><mo id="S3.E11.m1.6.6.2.4.1" xref="S3.E11.m1.6.6.2.3.cmml">,</mo><mi id="S3.E11.m1.6.6.2.2" xref="S3.E11.m1.6.6.2.2.cmml">m</mi></mrow></msub></mrow><mo stretchy="false" id="S3.E11.m1.7.7.1.1.1.1.1.1.3" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E11.m1.7.7.1.1.1.1.2" xref="S3.E11.m1.7.7.1.1.1.1.2.cmml">/</mo><mi id="S3.E11.m1.7.7.1.1.1.1.3" xref="S3.E11.m1.7.7.1.1.1.1.3.cmml">τ</mi></mrow><mo stretchy="false" id="S3.E11.m1.7.7.1.1.1.3" xref="S3.E11.m1.7.7.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.7b"><apply id="S3.E11.m1.7.7.cmml" xref="S3.E11.m1.7.7"><eq id="S3.E11.m1.7.7.2.cmml" xref="S3.E11.m1.7.7.2"></eq><apply id="S3.E11.m1.7.7.3.cmml" xref="S3.E11.m1.7.7.3"><csymbol cd="ambiguous" id="S3.E11.m1.7.7.3.1.cmml" xref="S3.E11.m1.7.7.3">subscript</csymbol><apply id="S3.E11.m1.7.7.3.2.cmml" xref="S3.E11.m1.7.7.3.2"><ci id="S3.E11.m1.7.7.3.2.1.cmml" xref="S3.E11.m1.7.7.3.2.1">~</ci><ci id="S3.E11.m1.7.7.3.2.2.cmml" xref="S3.E11.m1.7.7.3.2.2">𝐁</ci></apply><list id="S3.E11.m1.2.2.2.3.cmml" xref="S3.E11.m1.2.2.2.4"><ci id="S3.E11.m1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1">𝑙</ci><ci id="S3.E11.m1.2.2.2.2.cmml" xref="S3.E11.m1.2.2.2.2">𝑚</ci></list></apply><apply id="S3.E11.m1.7.7.1.cmml" xref="S3.E11.m1.7.7.1"><times id="S3.E11.m1.7.7.1.2.cmml" xref="S3.E11.m1.7.7.1.2"></times><ci id="S3.E11.m1.7.7.1.3a.cmml" xref="S3.E11.m1.7.7.1.3"><mtext id="S3.E11.m1.7.7.1.3.cmml" xref="S3.E11.m1.7.7.1.3">sigmoid</mtext></ci><apply id="S3.E11.m1.7.7.1.1.1.1.cmml" xref="S3.E11.m1.7.7.1.1.1"><divide id="S3.E11.m1.7.7.1.1.1.1.2.cmml" xref="S3.E11.m1.7.7.1.1.1.1.2"></divide><apply id="S3.E11.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.7.7.1.1.1.1.1.1"><plus id="S3.E11.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.1"></plus><apply id="S3.E11.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E11.m1.7.7.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E11.m1.7.7.1.1.1.1.1.1.1.2.2a.cmml" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.2.2"><mtext id="S3.E11.m1.7.7.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.2.2">t</mtext></ci><list id="S3.E11.m1.4.4.2.3.cmml" xref="S3.E11.m1.4.4.2.4"><ci id="S3.E11.m1.3.3.1.1.cmml" xref="S3.E11.m1.3.3.1.1">𝑙</ci><ci id="S3.E11.m1.4.4.2.2.cmml" xref="S3.E11.m1.4.4.2.2">𝑚</ci></list></apply><apply id="S3.E11.m1.7.7.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.7.7.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E11.m1.7.7.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.3.2"><ci id="S3.E11.m1.7.7.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.3.2.1">~</ci><ci id="S3.E11.m1.7.7.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E11.m1.7.7.1.1.1.1.1.1.1.3.2.2">𝐏</ci></apply><list id="S3.E11.m1.6.6.2.3.cmml" xref="S3.E11.m1.6.6.2.4"><ci id="S3.E11.m1.5.5.1.1.cmml" xref="S3.E11.m1.5.5.1.1">𝑙</ci><ci id="S3.E11.m1.6.6.2.2.cmml" xref="S3.E11.m1.6.6.2.2">𝑚</ci></list></apply></apply><ci id="S3.E11.m1.7.7.1.1.1.1.3.cmml" xref="S3.E11.m1.7.7.1.1.1.1.3">𝜏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.7c">\mathbf{\tilde{B}}_{l,m}=\text{sigmoid}((\textnormal{t}_{l,m}+\mathbf{\tilde{P}}_{l,m})/\tau)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p4.14" class="ltx_p">where <math id="S3.SS3.p4.4.m1.2" class="ltx_Math" alttext="\textnormal{t}_{1...L,1...M}" display="inline"><semantics id="S3.SS3.p4.4.m1.2a"><msub id="S3.SS3.p4.4.m1.2.3" xref="S3.SS3.p4.4.m1.2.3.cmml"><mtext id="S3.SS3.p4.4.m1.2.3.2" xref="S3.SS3.p4.4.m1.2.3.2a.cmml">t</mtext><mrow id="S3.SS3.p4.4.m1.2.2.2.2" xref="S3.SS3.p4.4.m1.2.2.2.3.cmml"><mrow id="S3.SS3.p4.4.m1.1.1.1.1.1" xref="S3.SS3.p4.4.m1.1.1.1.1.1.cmml"><mn id="S3.SS3.p4.4.m1.1.1.1.1.1.2" xref="S3.SS3.p4.4.m1.1.1.1.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S3.SS3.p4.4.m1.1.1.1.1.1.1" xref="S3.SS3.p4.4.m1.1.1.1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS3.p4.4.m1.1.1.1.1.1.3" xref="S3.SS3.p4.4.m1.1.1.1.1.1.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.4.m1.1.1.1.1.1.1a" xref="S3.SS3.p4.4.m1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.SS3.p4.4.m1.1.1.1.1.1.4" xref="S3.SS3.p4.4.m1.1.1.1.1.1.4.cmml">L</mi></mrow><mo id="S3.SS3.p4.4.m1.2.2.2.2.3" xref="S3.SS3.p4.4.m1.2.2.2.3.cmml">,</mo><mrow id="S3.SS3.p4.4.m1.2.2.2.2.2" xref="S3.SS3.p4.4.m1.2.2.2.2.2.cmml"><mn id="S3.SS3.p4.4.m1.2.2.2.2.2.2" xref="S3.SS3.p4.4.m1.2.2.2.2.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S3.SS3.p4.4.m1.2.2.2.2.2.1" xref="S3.SS3.p4.4.m1.2.2.2.2.2.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS3.p4.4.m1.2.2.2.2.2.3" xref="S3.SS3.p4.4.m1.2.2.2.2.2.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.4.m1.2.2.2.2.2.1a" xref="S3.SS3.p4.4.m1.2.2.2.2.2.1.cmml">​</mo><mi id="S3.SS3.p4.4.m1.2.2.2.2.2.4" xref="S3.SS3.p4.4.m1.2.2.2.2.2.4.cmml">M</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m1.2b"><apply id="S3.SS3.p4.4.m1.2.3.cmml" xref="S3.SS3.p4.4.m1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m1.2.3.1.cmml" xref="S3.SS3.p4.4.m1.2.3">subscript</csymbol><ci id="S3.SS3.p4.4.m1.2.3.2a.cmml" xref="S3.SS3.p4.4.m1.2.3.2"><mtext id="S3.SS3.p4.4.m1.2.3.2.cmml" xref="S3.SS3.p4.4.m1.2.3.2">t</mtext></ci><list id="S3.SS3.p4.4.m1.2.2.2.3.cmml" xref="S3.SS3.p4.4.m1.2.2.2.2"><apply id="S3.SS3.p4.4.m1.1.1.1.1.1.cmml" xref="S3.SS3.p4.4.m1.1.1.1.1.1"><times id="S3.SS3.p4.4.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.4.m1.1.1.1.1.1.1"></times><cn type="integer" id="S3.SS3.p4.4.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.p4.4.m1.1.1.1.1.1.2">1</cn><ci id="S3.SS3.p4.4.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.p4.4.m1.1.1.1.1.1.3">…</ci><ci id="S3.SS3.p4.4.m1.1.1.1.1.1.4.cmml" xref="S3.SS3.p4.4.m1.1.1.1.1.1.4">𝐿</ci></apply><apply id="S3.SS3.p4.4.m1.2.2.2.2.2.cmml" xref="S3.SS3.p4.4.m1.2.2.2.2.2"><times id="S3.SS3.p4.4.m1.2.2.2.2.2.1.cmml" xref="S3.SS3.p4.4.m1.2.2.2.2.2.1"></times><cn type="integer" id="S3.SS3.p4.4.m1.2.2.2.2.2.2.cmml" xref="S3.SS3.p4.4.m1.2.2.2.2.2.2">1</cn><ci id="S3.SS3.p4.4.m1.2.2.2.2.2.3.cmml" xref="S3.SS3.p4.4.m1.2.2.2.2.2.3">…</ci><ci id="S3.SS3.p4.4.m1.2.2.2.2.2.4.cmml" xref="S3.SS3.p4.4.m1.2.2.2.2.2.4">𝑀</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m1.2c">\textnormal{t}_{1...L,1...M}</annotation></semantics></math> are i.i.d samples from Logistic distribution and <math id="S3.SS3.p4.5.m2.7" class="ltx_Math" alttext="\mathbf{\tilde{P}}_{l,m}=\log(\frac{\mathbf{s}_{l,m}}{1-\mathbf{s}_{l,m}})" display="inline"><semantics id="S3.SS3.p4.5.m2.7a"><mrow id="S3.SS3.p4.5.m2.7.8" xref="S3.SS3.p4.5.m2.7.8.cmml"><msub id="S3.SS3.p4.5.m2.7.8.2" xref="S3.SS3.p4.5.m2.7.8.2.cmml"><mover accent="true" id="S3.SS3.p4.5.m2.7.8.2.2" xref="S3.SS3.p4.5.m2.7.8.2.2.cmml"><mi id="S3.SS3.p4.5.m2.7.8.2.2.2" xref="S3.SS3.p4.5.m2.7.8.2.2.2.cmml">𝐏</mi><mo id="S3.SS3.p4.5.m2.7.8.2.2.1" xref="S3.SS3.p4.5.m2.7.8.2.2.1.cmml">~</mo></mover><mrow id="S3.SS3.p4.5.m2.2.2.2.4" xref="S3.SS3.p4.5.m2.2.2.2.3.cmml"><mi id="S3.SS3.p4.5.m2.1.1.1.1" xref="S3.SS3.p4.5.m2.1.1.1.1.cmml">l</mi><mo id="S3.SS3.p4.5.m2.2.2.2.4.1" xref="S3.SS3.p4.5.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p4.5.m2.2.2.2.2" xref="S3.SS3.p4.5.m2.2.2.2.2.cmml">m</mi></mrow></msub><mo id="S3.SS3.p4.5.m2.7.8.1" xref="S3.SS3.p4.5.m2.7.8.1.cmml">=</mo><mrow id="S3.SS3.p4.5.m2.7.8.3.2" xref="S3.SS3.p4.5.m2.7.8.3.1.cmml"><mi id="S3.SS3.p4.5.m2.7.7" xref="S3.SS3.p4.5.m2.7.7.cmml">log</mi><mo id="S3.SS3.p4.5.m2.7.8.3.2a" xref="S3.SS3.p4.5.m2.7.8.3.1.cmml">⁡</mo><mrow id="S3.SS3.p4.5.m2.7.8.3.2.1" xref="S3.SS3.p4.5.m2.7.8.3.1.cmml"><mo stretchy="false" id="S3.SS3.p4.5.m2.7.8.3.2.1.1" xref="S3.SS3.p4.5.m2.7.8.3.1.cmml">(</mo><mfrac id="S3.SS3.p4.5.m2.6.6" xref="S3.SS3.p4.5.m2.6.6.cmml"><msub id="S3.SS3.p4.5.m2.4.4.2" xref="S3.SS3.p4.5.m2.4.4.2.cmml"><mi id="S3.SS3.p4.5.m2.4.4.2.4" xref="S3.SS3.p4.5.m2.4.4.2.4.cmml">𝐬</mi><mrow id="S3.SS3.p4.5.m2.4.4.2.2.2.4" xref="S3.SS3.p4.5.m2.4.4.2.2.2.3.cmml"><mi id="S3.SS3.p4.5.m2.3.3.1.1.1.1" xref="S3.SS3.p4.5.m2.3.3.1.1.1.1.cmml">l</mi><mo id="S3.SS3.p4.5.m2.4.4.2.2.2.4.1" xref="S3.SS3.p4.5.m2.4.4.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p4.5.m2.4.4.2.2.2.2" xref="S3.SS3.p4.5.m2.4.4.2.2.2.2.cmml">m</mi></mrow></msub><mrow id="S3.SS3.p4.5.m2.6.6.4" xref="S3.SS3.p4.5.m2.6.6.4.cmml"><mn id="S3.SS3.p4.5.m2.6.6.4.4" xref="S3.SS3.p4.5.m2.6.6.4.4.cmml">1</mn><mo id="S3.SS3.p4.5.m2.6.6.4.3" xref="S3.SS3.p4.5.m2.6.6.4.3.cmml">−</mo><msub id="S3.SS3.p4.5.m2.6.6.4.5" xref="S3.SS3.p4.5.m2.6.6.4.5.cmml"><mi id="S3.SS3.p4.5.m2.6.6.4.5.2" xref="S3.SS3.p4.5.m2.6.6.4.5.2.cmml">𝐬</mi><mrow id="S3.SS3.p4.5.m2.6.6.4.2.2.4" xref="S3.SS3.p4.5.m2.6.6.4.2.2.3.cmml"><mi id="S3.SS3.p4.5.m2.5.5.3.1.1.1" xref="S3.SS3.p4.5.m2.5.5.3.1.1.1.cmml">l</mi><mo id="S3.SS3.p4.5.m2.6.6.4.2.2.4.1" xref="S3.SS3.p4.5.m2.6.6.4.2.2.3.cmml">,</mo><mi id="S3.SS3.p4.5.m2.6.6.4.2.2.2" xref="S3.SS3.p4.5.m2.6.6.4.2.2.2.cmml">m</mi></mrow></msub></mrow></mfrac><mo stretchy="false" id="S3.SS3.p4.5.m2.7.8.3.2.1.2" xref="S3.SS3.p4.5.m2.7.8.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.5.m2.7b"><apply id="S3.SS3.p4.5.m2.7.8.cmml" xref="S3.SS3.p4.5.m2.7.8"><eq id="S3.SS3.p4.5.m2.7.8.1.cmml" xref="S3.SS3.p4.5.m2.7.8.1"></eq><apply id="S3.SS3.p4.5.m2.7.8.2.cmml" xref="S3.SS3.p4.5.m2.7.8.2"><csymbol cd="ambiguous" id="S3.SS3.p4.5.m2.7.8.2.1.cmml" xref="S3.SS3.p4.5.m2.7.8.2">subscript</csymbol><apply id="S3.SS3.p4.5.m2.7.8.2.2.cmml" xref="S3.SS3.p4.5.m2.7.8.2.2"><ci id="S3.SS3.p4.5.m2.7.8.2.2.1.cmml" xref="S3.SS3.p4.5.m2.7.8.2.2.1">~</ci><ci id="S3.SS3.p4.5.m2.7.8.2.2.2.cmml" xref="S3.SS3.p4.5.m2.7.8.2.2.2">𝐏</ci></apply><list id="S3.SS3.p4.5.m2.2.2.2.3.cmml" xref="S3.SS3.p4.5.m2.2.2.2.4"><ci id="S3.SS3.p4.5.m2.1.1.1.1.cmml" xref="S3.SS3.p4.5.m2.1.1.1.1">𝑙</ci><ci id="S3.SS3.p4.5.m2.2.2.2.2.cmml" xref="S3.SS3.p4.5.m2.2.2.2.2">𝑚</ci></list></apply><apply id="S3.SS3.p4.5.m2.7.8.3.1.cmml" xref="S3.SS3.p4.5.m2.7.8.3.2"><log id="S3.SS3.p4.5.m2.7.7.cmml" xref="S3.SS3.p4.5.m2.7.7"></log><apply id="S3.SS3.p4.5.m2.6.6.cmml" xref="S3.SS3.p4.5.m2.6.6"><divide id="S3.SS3.p4.5.m2.6.6.5.cmml" xref="S3.SS3.p4.5.m2.6.6"></divide><apply id="S3.SS3.p4.5.m2.4.4.2.cmml" xref="S3.SS3.p4.5.m2.4.4.2"><csymbol cd="ambiguous" id="S3.SS3.p4.5.m2.4.4.2.3.cmml" xref="S3.SS3.p4.5.m2.4.4.2">subscript</csymbol><ci id="S3.SS3.p4.5.m2.4.4.2.4.cmml" xref="S3.SS3.p4.5.m2.4.4.2.4">𝐬</ci><list id="S3.SS3.p4.5.m2.4.4.2.2.2.3.cmml" xref="S3.SS3.p4.5.m2.4.4.2.2.2.4"><ci id="S3.SS3.p4.5.m2.3.3.1.1.1.1.cmml" xref="S3.SS3.p4.5.m2.3.3.1.1.1.1">𝑙</ci><ci id="S3.SS3.p4.5.m2.4.4.2.2.2.2.cmml" xref="S3.SS3.p4.5.m2.4.4.2.2.2.2">𝑚</ci></list></apply><apply id="S3.SS3.p4.5.m2.6.6.4.cmml" xref="S3.SS3.p4.5.m2.6.6.4"><minus id="S3.SS3.p4.5.m2.6.6.4.3.cmml" xref="S3.SS3.p4.5.m2.6.6.4.3"></minus><cn type="integer" id="S3.SS3.p4.5.m2.6.6.4.4.cmml" xref="S3.SS3.p4.5.m2.6.6.4.4">1</cn><apply id="S3.SS3.p4.5.m2.6.6.4.5.cmml" xref="S3.SS3.p4.5.m2.6.6.4.5"><csymbol cd="ambiguous" id="S3.SS3.p4.5.m2.6.6.4.5.1.cmml" xref="S3.SS3.p4.5.m2.6.6.4.5">subscript</csymbol><ci id="S3.SS3.p4.5.m2.6.6.4.5.2.cmml" xref="S3.SS3.p4.5.m2.6.6.4.5.2">𝐬</ci><list id="S3.SS3.p4.5.m2.6.6.4.2.2.3.cmml" xref="S3.SS3.p4.5.m2.6.6.4.2.2.4"><ci id="S3.SS3.p4.5.m2.5.5.3.1.1.1.cmml" xref="S3.SS3.p4.5.m2.5.5.3.1.1.1">𝑙</ci><ci id="S3.SS3.p4.5.m2.6.6.4.2.2.2.cmml" xref="S3.SS3.p4.5.m2.6.6.4.2.2.2">𝑚</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.5.m2.7c">\mathbf{\tilde{P}}_{l,m}=\log(\frac{\mathbf{s}_{l,m}}{1-\mathbf{s}_{l,m}})</annotation></semantics></math>. However <math id="S3.SS3.p4.6.m3.2" class="ltx_Math" alttext="\mathbf{\tilde{B}}_{l,m}" display="inline"><semantics id="S3.SS3.p4.6.m3.2a"><msub id="S3.SS3.p4.6.m3.2.3" xref="S3.SS3.p4.6.m3.2.3.cmml"><mover accent="true" id="S3.SS3.p4.6.m3.2.3.2" xref="S3.SS3.p4.6.m3.2.3.2.cmml"><mi id="S3.SS3.p4.6.m3.2.3.2.2" xref="S3.SS3.p4.6.m3.2.3.2.2.cmml">𝐁</mi><mo id="S3.SS3.p4.6.m3.2.3.2.1" xref="S3.SS3.p4.6.m3.2.3.2.1.cmml">~</mo></mover><mrow id="S3.SS3.p4.6.m3.2.2.2.4" xref="S3.SS3.p4.6.m3.2.2.2.3.cmml"><mi id="S3.SS3.p4.6.m3.1.1.1.1" xref="S3.SS3.p4.6.m3.1.1.1.1.cmml">l</mi><mo id="S3.SS3.p4.6.m3.2.2.2.4.1" xref="S3.SS3.p4.6.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p4.6.m3.2.2.2.2" xref="S3.SS3.p4.6.m3.2.2.2.2.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.6.m3.2b"><apply id="S3.SS3.p4.6.m3.2.3.cmml" xref="S3.SS3.p4.6.m3.2.3"><csymbol cd="ambiguous" id="S3.SS3.p4.6.m3.2.3.1.cmml" xref="S3.SS3.p4.6.m3.2.3">subscript</csymbol><apply id="S3.SS3.p4.6.m3.2.3.2.cmml" xref="S3.SS3.p4.6.m3.2.3.2"><ci id="S3.SS3.p4.6.m3.2.3.2.1.cmml" xref="S3.SS3.p4.6.m3.2.3.2.1">~</ci><ci id="S3.SS3.p4.6.m3.2.3.2.2.cmml" xref="S3.SS3.p4.6.m3.2.3.2.2">𝐁</ci></apply><list id="S3.SS3.p4.6.m3.2.2.2.3.cmml" xref="S3.SS3.p4.6.m3.2.2.2.4"><ci id="S3.SS3.p4.6.m3.1.1.1.1.cmml" xref="S3.SS3.p4.6.m3.1.1.1.1">𝑙</ci><ci id="S3.SS3.p4.6.m3.2.2.2.2.cmml" xref="S3.SS3.p4.6.m3.2.2.2.2">𝑚</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.6.m3.2c">\mathbf{\tilde{B}}_{l,m}</annotation></semantics></math> is still a continuous value as <math id="S3.SS3.p4.7.m4.1" class="ltx_Math" alttext="\tau&gt;0" display="inline"><semantics id="S3.SS3.p4.7.m4.1a"><mrow id="S3.SS3.p4.7.m4.1.1" xref="S3.SS3.p4.7.m4.1.1.cmml"><mi id="S3.SS3.p4.7.m4.1.1.2" xref="S3.SS3.p4.7.m4.1.1.2.cmml">τ</mi><mo id="S3.SS3.p4.7.m4.1.1.1" xref="S3.SS3.p4.7.m4.1.1.1.cmml">&gt;</mo><mn id="S3.SS3.p4.7.m4.1.1.3" xref="S3.SS3.p4.7.m4.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.7.m4.1b"><apply id="S3.SS3.p4.7.m4.1.1.cmml" xref="S3.SS3.p4.7.m4.1.1"><gt id="S3.SS3.p4.7.m4.1.1.1.cmml" xref="S3.SS3.p4.7.m4.1.1.1"></gt><ci id="S3.SS3.p4.7.m4.1.1.2.cmml" xref="S3.SS3.p4.7.m4.1.1.2">𝜏</ci><cn type="integer" id="S3.SS3.p4.7.m4.1.1.3.cmml" xref="S3.SS3.p4.7.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.7.m4.1c">\tau&gt;0</annotation></semantics></math>, here we use a Straight-Through (ST) method introduced in (<span id="S3.SS3.p4.14.1" class="ltx_text ltx_font_bold">?</span>) to convert the continuous <math id="S3.SS3.p4.8.m5.2" class="ltx_Math" alttext="\mathbf{\tilde{B}}_{l,m}" display="inline"><semantics id="S3.SS3.p4.8.m5.2a"><msub id="S3.SS3.p4.8.m5.2.3" xref="S3.SS3.p4.8.m5.2.3.cmml"><mover accent="true" id="S3.SS3.p4.8.m5.2.3.2" xref="S3.SS3.p4.8.m5.2.3.2.cmml"><mi id="S3.SS3.p4.8.m5.2.3.2.2" xref="S3.SS3.p4.8.m5.2.3.2.2.cmml">𝐁</mi><mo id="S3.SS3.p4.8.m5.2.3.2.1" xref="S3.SS3.p4.8.m5.2.3.2.1.cmml">~</mo></mover><mrow id="S3.SS3.p4.8.m5.2.2.2.4" xref="S3.SS3.p4.8.m5.2.2.2.3.cmml"><mi id="S3.SS3.p4.8.m5.1.1.1.1" xref="S3.SS3.p4.8.m5.1.1.1.1.cmml">l</mi><mo id="S3.SS3.p4.8.m5.2.2.2.4.1" xref="S3.SS3.p4.8.m5.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p4.8.m5.2.2.2.2" xref="S3.SS3.p4.8.m5.2.2.2.2.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.8.m5.2b"><apply id="S3.SS3.p4.8.m5.2.3.cmml" xref="S3.SS3.p4.8.m5.2.3"><csymbol cd="ambiguous" id="S3.SS3.p4.8.m5.2.3.1.cmml" xref="S3.SS3.p4.8.m5.2.3">subscript</csymbol><apply id="S3.SS3.p4.8.m5.2.3.2.cmml" xref="S3.SS3.p4.8.m5.2.3.2"><ci id="S3.SS3.p4.8.m5.2.3.2.1.cmml" xref="S3.SS3.p4.8.m5.2.3.2.1">~</ci><ci id="S3.SS3.p4.8.m5.2.3.2.2.cmml" xref="S3.SS3.p4.8.m5.2.3.2.2">𝐁</ci></apply><list id="S3.SS3.p4.8.m5.2.2.2.3.cmml" xref="S3.SS3.p4.8.m5.2.2.2.4"><ci id="S3.SS3.p4.8.m5.1.1.1.1.cmml" xref="S3.SS3.p4.8.m5.1.1.1.1">𝑙</ci><ci id="S3.SS3.p4.8.m5.2.2.2.2.cmml" xref="S3.SS3.p4.8.m5.2.2.2.2">𝑚</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.8.m5.2c">\mathbf{\tilde{B}}_{l,m}</annotation></semantics></math> to discrete <math id="S3.SS3.p4.9.m6.2" class="ltx_Math" alttext="\mathbf{P}_{l,m}" display="inline"><semantics id="S3.SS3.p4.9.m6.2a"><msub id="S3.SS3.p4.9.m6.2.3" xref="S3.SS3.p4.9.m6.2.3.cmml"><mi id="S3.SS3.p4.9.m6.2.3.2" xref="S3.SS3.p4.9.m6.2.3.2.cmml">𝐏</mi><mrow id="S3.SS3.p4.9.m6.2.2.2.4" xref="S3.SS3.p4.9.m6.2.2.2.3.cmml"><mi id="S3.SS3.p4.9.m6.1.1.1.1" xref="S3.SS3.p4.9.m6.1.1.1.1.cmml">l</mi><mo id="S3.SS3.p4.9.m6.2.2.2.4.1" xref="S3.SS3.p4.9.m6.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p4.9.m6.2.2.2.2" xref="S3.SS3.p4.9.m6.2.2.2.2.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.9.m6.2b"><apply id="S3.SS3.p4.9.m6.2.3.cmml" xref="S3.SS3.p4.9.m6.2.3"><csymbol cd="ambiguous" id="S3.SS3.p4.9.m6.2.3.1.cmml" xref="S3.SS3.p4.9.m6.2.3">subscript</csymbol><ci id="S3.SS3.p4.9.m6.2.3.2.cmml" xref="S3.SS3.p4.9.m6.2.3.2">𝐏</ci><list id="S3.SS3.p4.9.m6.2.2.2.3.cmml" xref="S3.SS3.p4.9.m6.2.2.2.4"><ci id="S3.SS3.p4.9.m6.1.1.1.1.cmml" xref="S3.SS3.p4.9.m6.1.1.1.1">𝑙</ci><ci id="S3.SS3.p4.9.m6.2.2.2.2.cmml" xref="S3.SS3.p4.9.m6.2.2.2.2">𝑚</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.9.m6.2c">\mathbf{P}_{l,m}</annotation></semantics></math>, that is, during forward process, we use a threshold of <math id="S3.SS3.p4.10.m7.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="S3.SS3.p4.10.m7.1a"><mn id="S3.SS3.p4.10.m7.1.1" xref="S3.SS3.p4.10.m7.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.10.m7.1b"><cn type="float" id="S3.SS3.p4.10.m7.1.1.cmml" xref="S3.SS3.p4.10.m7.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.10.m7.1c">0.5</annotation></semantics></math> to thresholding <math id="S3.SS3.p4.11.m8.2" class="ltx_Math" alttext="\mathbf{\tilde{B}}_{l,m}" display="inline"><semantics id="S3.SS3.p4.11.m8.2a"><msub id="S3.SS3.p4.11.m8.2.3" xref="S3.SS3.p4.11.m8.2.3.cmml"><mover accent="true" id="S3.SS3.p4.11.m8.2.3.2" xref="S3.SS3.p4.11.m8.2.3.2.cmml"><mi id="S3.SS3.p4.11.m8.2.3.2.2" xref="S3.SS3.p4.11.m8.2.3.2.2.cmml">𝐁</mi><mo id="S3.SS3.p4.11.m8.2.3.2.1" xref="S3.SS3.p4.11.m8.2.3.2.1.cmml">~</mo></mover><mrow id="S3.SS3.p4.11.m8.2.2.2.4" xref="S3.SS3.p4.11.m8.2.2.2.3.cmml"><mi id="S3.SS3.p4.11.m8.1.1.1.1" xref="S3.SS3.p4.11.m8.1.1.1.1.cmml">l</mi><mo id="S3.SS3.p4.11.m8.2.2.2.4.1" xref="S3.SS3.p4.11.m8.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p4.11.m8.2.2.2.2" xref="S3.SS3.p4.11.m8.2.2.2.2.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.11.m8.2b"><apply id="S3.SS3.p4.11.m8.2.3.cmml" xref="S3.SS3.p4.11.m8.2.3"><csymbol cd="ambiguous" id="S3.SS3.p4.11.m8.2.3.1.cmml" xref="S3.SS3.p4.11.m8.2.3">subscript</csymbol><apply id="S3.SS3.p4.11.m8.2.3.2.cmml" xref="S3.SS3.p4.11.m8.2.3.2"><ci id="S3.SS3.p4.11.m8.2.3.2.1.cmml" xref="S3.SS3.p4.11.m8.2.3.2.1">~</ci><ci id="S3.SS3.p4.11.m8.2.3.2.2.cmml" xref="S3.SS3.p4.11.m8.2.3.2.2">𝐁</ci></apply><list id="S3.SS3.p4.11.m8.2.2.2.3.cmml" xref="S3.SS3.p4.11.m8.2.2.2.4"><ci id="S3.SS3.p4.11.m8.1.1.1.1.cmml" xref="S3.SS3.p4.11.m8.1.1.1.1">𝑙</ci><ci id="S3.SS3.p4.11.m8.2.2.2.2.cmml" xref="S3.SS3.p4.11.m8.2.2.2.2">𝑚</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.11.m8.2c">\mathbf{\tilde{B}}_{l,m}</annotation></semantics></math> to <math id="S3.SS3.p4.12.m9.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S3.SS3.p4.12.m9.1a"><mn id="S3.SS3.p4.12.m9.1.1" xref="S3.SS3.p4.12.m9.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.12.m9.1b"><cn type="integer" id="S3.SS3.p4.12.m9.1.1.cmml" xref="S3.SS3.p4.12.m9.1.1">0</cn></annotation-xml></semantics></math> and <math id="S3.SS3.p4.13.m10.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S3.SS3.p4.13.m10.1a"><mn id="S3.SS3.p4.13.m10.1.1" xref="S3.SS3.p4.13.m10.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.13.m10.1b"><cn type="integer" id="S3.SS3.p4.13.m10.1.1.cmml" xref="S3.SS3.p4.13.m10.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.13.m10.1c">1</annotation></semantics></math>, but during the backward process, the gradient is normally passed to <math id="S3.SS3.p4.14.m11.2" class="ltx_Math" alttext="\mathbf{\tilde{B}}_{l,m}" display="inline"><semantics id="S3.SS3.p4.14.m11.2a"><msub id="S3.SS3.p4.14.m11.2.3" xref="S3.SS3.p4.14.m11.2.3.cmml"><mover accent="true" id="S3.SS3.p4.14.m11.2.3.2" xref="S3.SS3.p4.14.m11.2.3.2.cmml"><mi id="S3.SS3.p4.14.m11.2.3.2.2" xref="S3.SS3.p4.14.m11.2.3.2.2.cmml">𝐁</mi><mo id="S3.SS3.p4.14.m11.2.3.2.1" xref="S3.SS3.p4.14.m11.2.3.2.1.cmml">~</mo></mover><mrow id="S3.SS3.p4.14.m11.2.2.2.4" xref="S3.SS3.p4.14.m11.2.2.2.3.cmml"><mi id="S3.SS3.p4.14.m11.1.1.1.1" xref="S3.SS3.p4.14.m11.1.1.1.1.cmml">l</mi><mo id="S3.SS3.p4.14.m11.2.2.2.4.1" xref="S3.SS3.p4.14.m11.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p4.14.m11.2.2.2.2" xref="S3.SS3.p4.14.m11.2.2.2.2.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.14.m11.2b"><apply id="S3.SS3.p4.14.m11.2.3.cmml" xref="S3.SS3.p4.14.m11.2.3"><csymbol cd="ambiguous" id="S3.SS3.p4.14.m11.2.3.1.cmml" xref="S3.SS3.p4.14.m11.2.3">subscript</csymbol><apply id="S3.SS3.p4.14.m11.2.3.2.cmml" xref="S3.SS3.p4.14.m11.2.3.2"><ci id="S3.SS3.p4.14.m11.2.3.2.1.cmml" xref="S3.SS3.p4.14.m11.2.3.2.1">~</ci><ci id="S3.SS3.p4.14.m11.2.3.2.2.cmml" xref="S3.SS3.p4.14.m11.2.3.2.2">𝐁</ci></apply><list id="S3.SS3.p4.14.m11.2.2.2.3.cmml" xref="S3.SS3.p4.14.m11.2.2.2.4"><ci id="S3.SS3.p4.14.m11.1.1.1.1.cmml" xref="S3.SS3.p4.14.m11.1.1.1.1">𝑙</ci><ci id="S3.SS3.p4.14.m11.2.2.2.2.cmml" xref="S3.SS3.p4.14.m11.2.2.2.2">𝑚</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.14.m11.2c">\mathbf{\tilde{B}}_{l,m}</annotation></semantics></math> just as the thresholding function is an identity function. We provide the pseudocode of the routing algorithm in appendix <a href="#A2" title="Appendix B Pseudocode of routing algorithm ‣ Question Guided Modular Routing Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>QGMRN with Attention</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.1" class="ltx_p">Benefiting from the routing mechanism, the visual feature map <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="\tilde{y}_{L}" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><msub id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mover accent="true" id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml"><mi id="S3.SS4.p1.1.m1.1.1.2.2" xref="S3.SS4.p1.1.m1.1.1.2.2.cmml">y</mi><mo id="S3.SS4.p1.1.m1.1.1.2.1" xref="S3.SS4.p1.1.m1.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">subscript</csymbol><apply id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2"><ci id="S3.SS4.p1.1.m1.1.1.2.1.cmml" xref="S3.SS4.p1.1.m1.1.1.2.1">~</ci><ci id="S3.SS4.p1.1.m1.1.1.2.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2.2">𝑦</ci></apply><ci id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">\tilde{y}_{L}</annotation></semantics></math> extracted from the visual network already contains enough information and clues to answer the question, so we can directly send it to a global max pooling (GMP) layer and a simple MLP classifier to predict the answer.</p>
</div>
<div id="S3.SS4.p2" class="ltx_para">
<p id="S3.SS4.p2.1" class="ltx_p">And we can also use an additional attention mechanism to further fuse the multi-modal features. The attention method consists of two stages: (1) We use the spatial self-attention mechanism to enhance the representation power and the spatial reasoning ability of the model; (2) We use a simple spatial attention mechanism to convert the feature map to the final feature vector.</p>
</div>
<div id="S3.SS4.p3" class="ltx_para">
<p id="S3.SS4.p3.10" class="ltx_p">In the first stage, we first concatenate the question features <math id="S3.SS4.p3.1.m1.1" class="ltx_Math" alttext="\mathbf{q}" display="inline"><semantics id="S3.SS4.p3.1.m1.1a"><mi id="S3.SS4.p3.1.m1.1.1" xref="S3.SS4.p3.1.m1.1.1.cmml">𝐪</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.1b"><ci id="S3.SS4.p3.1.m1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1">𝐪</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.1c">\mathbf{q}</annotation></semantics></math> with the visual features <math id="S3.SS4.p3.2.m2.1" class="ltx_Math" alttext="\tilde{y}_{L}" display="inline"><semantics id="S3.SS4.p3.2.m2.1a"><msub id="S3.SS4.p3.2.m2.1.1" xref="S3.SS4.p3.2.m2.1.1.cmml"><mover accent="true" id="S3.SS4.p3.2.m2.1.1.2" xref="S3.SS4.p3.2.m2.1.1.2.cmml"><mi id="S3.SS4.p3.2.m2.1.1.2.2" xref="S3.SS4.p3.2.m2.1.1.2.2.cmml">y</mi><mo id="S3.SS4.p3.2.m2.1.1.2.1" xref="S3.SS4.p3.2.m2.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS4.p3.2.m2.1.1.3" xref="S3.SS4.p3.2.m2.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.m2.1b"><apply id="S3.SS4.p3.2.m2.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m2.1.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1">subscript</csymbol><apply id="S3.SS4.p3.2.m2.1.1.2.cmml" xref="S3.SS4.p3.2.m2.1.1.2"><ci id="S3.SS4.p3.2.m2.1.1.2.1.cmml" xref="S3.SS4.p3.2.m2.1.1.2.1">~</ci><ci id="S3.SS4.p3.2.m2.1.1.2.2.cmml" xref="S3.SS4.p3.2.m2.1.1.2.2">𝑦</ci></apply><ci id="S3.SS4.p3.2.m2.1.1.3.cmml" xref="S3.SS4.p3.2.m2.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.2.m2.1c">\tilde{y}_{L}</annotation></semantics></math> to get the fused multi-modal features <math id="S3.SS4.p3.3.m3.1" class="ltx_Math" alttext="u\in\mathbb{R}^{h\times w\times c}" display="inline"><semantics id="S3.SS4.p3.3.m3.1a"><mrow id="S3.SS4.p3.3.m3.1.1" xref="S3.SS4.p3.3.m3.1.1.cmml"><mi id="S3.SS4.p3.3.m3.1.1.2" xref="S3.SS4.p3.3.m3.1.1.2.cmml">u</mi><mo id="S3.SS4.p3.3.m3.1.1.1" xref="S3.SS4.p3.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS4.p3.3.m3.1.1.3" xref="S3.SS4.p3.3.m3.1.1.3.cmml"><mi id="S3.SS4.p3.3.m3.1.1.3.2" xref="S3.SS4.p3.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p3.3.m3.1.1.3.3" xref="S3.SS4.p3.3.m3.1.1.3.3.cmml"><mi id="S3.SS4.p3.3.m3.1.1.3.3.2" xref="S3.SS4.p3.3.m3.1.1.3.3.2.cmml">h</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p3.3.m3.1.1.3.3.1" xref="S3.SS4.p3.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS4.p3.3.m3.1.1.3.3.3" xref="S3.SS4.p3.3.m3.1.1.3.3.3.cmml">w</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p3.3.m3.1.1.3.3.1a" xref="S3.SS4.p3.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS4.p3.3.m3.1.1.3.3.4" xref="S3.SS4.p3.3.m3.1.1.3.3.4.cmml">c</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.3.m3.1b"><apply id="S3.SS4.p3.3.m3.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1"><in id="S3.SS4.p3.3.m3.1.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1.1"></in><ci id="S3.SS4.p3.3.m3.1.1.2.cmml" xref="S3.SS4.p3.3.m3.1.1.2">𝑢</ci><apply id="S3.SS4.p3.3.m3.1.1.3.cmml" xref="S3.SS4.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p3.3.m3.1.1.3.1.cmml" xref="S3.SS4.p3.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS4.p3.3.m3.1.1.3.2.cmml" xref="S3.SS4.p3.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS4.p3.3.m3.1.1.3.3.cmml" xref="S3.SS4.p3.3.m3.1.1.3.3"><times id="S3.SS4.p3.3.m3.1.1.3.3.1.cmml" xref="S3.SS4.p3.3.m3.1.1.3.3.1"></times><ci id="S3.SS4.p3.3.m3.1.1.3.3.2.cmml" xref="S3.SS4.p3.3.m3.1.1.3.3.2">ℎ</ci><ci id="S3.SS4.p3.3.m3.1.1.3.3.3.cmml" xref="S3.SS4.p3.3.m3.1.1.3.3.3">𝑤</ci><ci id="S3.SS4.p3.3.m3.1.1.3.3.4.cmml" xref="S3.SS4.p3.3.m3.1.1.3.3.4">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.3.m3.1c">u\in\mathbb{R}^{h\times w\times c}</annotation></semantics></math> (broadcasting is used here) where <math id="S3.SS4.p3.4.m4.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S3.SS4.p3.4.m4.1a"><mi id="S3.SS4.p3.4.m4.1.1" xref="S3.SS4.p3.4.m4.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.4.m4.1b"><ci id="S3.SS4.p3.4.m4.1.1.cmml" xref="S3.SS4.p3.4.m4.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.4.m4.1c">h</annotation></semantics></math>, <math id="S3.SS4.p3.5.m5.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS4.p3.5.m5.1a"><mi id="S3.SS4.p3.5.m5.1.1" xref="S3.SS4.p3.5.m5.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.5.m5.1b"><ci id="S3.SS4.p3.5.m5.1.1.cmml" xref="S3.SS4.p3.5.m5.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.5.m5.1c">w</annotation></semantics></math>, and <math id="S3.SS4.p3.6.m6.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS4.p3.6.m6.1a"><mi id="S3.SS4.p3.6.m6.1.1" xref="S3.SS4.p3.6.m6.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.6.m6.1b"><ci id="S3.SS4.p3.6.m6.1.1.cmml" xref="S3.SS4.p3.6.m6.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.6.m6.1c">c</annotation></semantics></math> denote the height, width and channel of the feature map. Then we reshape it to <math id="S3.SS4.p3.7.m7.1" class="ltx_Math" alttext="hw\times c" display="inline"><semantics id="S3.SS4.p3.7.m7.1a"><mrow id="S3.SS4.p3.7.m7.1.1" xref="S3.SS4.p3.7.m7.1.1.cmml"><mrow id="S3.SS4.p3.7.m7.1.1.2" xref="S3.SS4.p3.7.m7.1.1.2.cmml"><mi id="S3.SS4.p3.7.m7.1.1.2.2" xref="S3.SS4.p3.7.m7.1.1.2.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p3.7.m7.1.1.2.1" xref="S3.SS4.p3.7.m7.1.1.2.1.cmml">​</mo><mi id="S3.SS4.p3.7.m7.1.1.2.3" xref="S3.SS4.p3.7.m7.1.1.2.3.cmml">w</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p3.7.m7.1.1.1" xref="S3.SS4.p3.7.m7.1.1.1.cmml">×</mo><mi id="S3.SS4.p3.7.m7.1.1.3" xref="S3.SS4.p3.7.m7.1.1.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.7.m7.1b"><apply id="S3.SS4.p3.7.m7.1.1.cmml" xref="S3.SS4.p3.7.m7.1.1"><times id="S3.SS4.p3.7.m7.1.1.1.cmml" xref="S3.SS4.p3.7.m7.1.1.1"></times><apply id="S3.SS4.p3.7.m7.1.1.2.cmml" xref="S3.SS4.p3.7.m7.1.1.2"><times id="S3.SS4.p3.7.m7.1.1.2.1.cmml" xref="S3.SS4.p3.7.m7.1.1.2.1"></times><ci id="S3.SS4.p3.7.m7.1.1.2.2.cmml" xref="S3.SS4.p3.7.m7.1.1.2.2">ℎ</ci><ci id="S3.SS4.p3.7.m7.1.1.2.3.cmml" xref="S3.SS4.p3.7.m7.1.1.2.3">𝑤</ci></apply><ci id="S3.SS4.p3.7.m7.1.1.3.cmml" xref="S3.SS4.p3.7.m7.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.7.m7.1c">hw\times c</annotation></semantics></math>, and feed it to an off-the-shelf Transformer (<span id="S3.SS4.p3.10.1" class="ltx_text ltx_font_bold">?</span>) encoder layers for modeling the correlations among the spatial locations. After we get the output <math id="S3.SS4.p3.8.m8.1" class="ltx_Math" alttext="\tilde{u}\in\mathbb{R}^{hw\times d_{t}}" display="inline"><semantics id="S3.SS4.p3.8.m8.1a"><mrow id="S3.SS4.p3.8.m8.1.1" xref="S3.SS4.p3.8.m8.1.1.cmml"><mover accent="true" id="S3.SS4.p3.8.m8.1.1.2" xref="S3.SS4.p3.8.m8.1.1.2.cmml"><mi id="S3.SS4.p3.8.m8.1.1.2.2" xref="S3.SS4.p3.8.m8.1.1.2.2.cmml">u</mi><mo id="S3.SS4.p3.8.m8.1.1.2.1" xref="S3.SS4.p3.8.m8.1.1.2.1.cmml">~</mo></mover><mo id="S3.SS4.p3.8.m8.1.1.1" xref="S3.SS4.p3.8.m8.1.1.1.cmml">∈</mo><msup id="S3.SS4.p3.8.m8.1.1.3" xref="S3.SS4.p3.8.m8.1.1.3.cmml"><mi id="S3.SS4.p3.8.m8.1.1.3.2" xref="S3.SS4.p3.8.m8.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p3.8.m8.1.1.3.3" xref="S3.SS4.p3.8.m8.1.1.3.3.cmml"><mrow id="S3.SS4.p3.8.m8.1.1.3.3.2" xref="S3.SS4.p3.8.m8.1.1.3.3.2.cmml"><mi id="S3.SS4.p3.8.m8.1.1.3.3.2.2" xref="S3.SS4.p3.8.m8.1.1.3.3.2.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p3.8.m8.1.1.3.3.2.1" xref="S3.SS4.p3.8.m8.1.1.3.3.2.1.cmml">​</mo><mi id="S3.SS4.p3.8.m8.1.1.3.3.2.3" xref="S3.SS4.p3.8.m8.1.1.3.3.2.3.cmml">w</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p3.8.m8.1.1.3.3.1" xref="S3.SS4.p3.8.m8.1.1.3.3.1.cmml">×</mo><msub id="S3.SS4.p3.8.m8.1.1.3.3.3" xref="S3.SS4.p3.8.m8.1.1.3.3.3.cmml"><mi id="S3.SS4.p3.8.m8.1.1.3.3.3.2" xref="S3.SS4.p3.8.m8.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS4.p3.8.m8.1.1.3.3.3.3" xref="S3.SS4.p3.8.m8.1.1.3.3.3.3.cmml">t</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.8.m8.1b"><apply id="S3.SS4.p3.8.m8.1.1.cmml" xref="S3.SS4.p3.8.m8.1.1"><in id="S3.SS4.p3.8.m8.1.1.1.cmml" xref="S3.SS4.p3.8.m8.1.1.1"></in><apply id="S3.SS4.p3.8.m8.1.1.2.cmml" xref="S3.SS4.p3.8.m8.1.1.2"><ci id="S3.SS4.p3.8.m8.1.1.2.1.cmml" xref="S3.SS4.p3.8.m8.1.1.2.1">~</ci><ci id="S3.SS4.p3.8.m8.1.1.2.2.cmml" xref="S3.SS4.p3.8.m8.1.1.2.2">𝑢</ci></apply><apply id="S3.SS4.p3.8.m8.1.1.3.cmml" xref="S3.SS4.p3.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p3.8.m8.1.1.3.1.cmml" xref="S3.SS4.p3.8.m8.1.1.3">superscript</csymbol><ci id="S3.SS4.p3.8.m8.1.1.3.2.cmml" xref="S3.SS4.p3.8.m8.1.1.3.2">ℝ</ci><apply id="S3.SS4.p3.8.m8.1.1.3.3.cmml" xref="S3.SS4.p3.8.m8.1.1.3.3"><times id="S3.SS4.p3.8.m8.1.1.3.3.1.cmml" xref="S3.SS4.p3.8.m8.1.1.3.3.1"></times><apply id="S3.SS4.p3.8.m8.1.1.3.3.2.cmml" xref="S3.SS4.p3.8.m8.1.1.3.3.2"><times id="S3.SS4.p3.8.m8.1.1.3.3.2.1.cmml" xref="S3.SS4.p3.8.m8.1.1.3.3.2.1"></times><ci id="S3.SS4.p3.8.m8.1.1.3.3.2.2.cmml" xref="S3.SS4.p3.8.m8.1.1.3.3.2.2">ℎ</ci><ci id="S3.SS4.p3.8.m8.1.1.3.3.2.3.cmml" xref="S3.SS4.p3.8.m8.1.1.3.3.2.3">𝑤</ci></apply><apply id="S3.SS4.p3.8.m8.1.1.3.3.3.cmml" xref="S3.SS4.p3.8.m8.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.p3.8.m8.1.1.3.3.3.1.cmml" xref="S3.SS4.p3.8.m8.1.1.3.3.3">subscript</csymbol><ci id="S3.SS4.p3.8.m8.1.1.3.3.3.2.cmml" xref="S3.SS4.p3.8.m8.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS4.p3.8.m8.1.1.3.3.3.3.cmml" xref="S3.SS4.p3.8.m8.1.1.3.3.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.8.m8.1c">\tilde{u}\in\mathbb{R}^{hw\times d_{t}}</annotation></semantics></math> where <math id="S3.SS4.p3.9.m9.1" class="ltx_Math" alttext="d_{t}" display="inline"><semantics id="S3.SS4.p3.9.m9.1a"><msub id="S3.SS4.p3.9.m9.1.1" xref="S3.SS4.p3.9.m9.1.1.cmml"><mi id="S3.SS4.p3.9.m9.1.1.2" xref="S3.SS4.p3.9.m9.1.1.2.cmml">d</mi><mi id="S3.SS4.p3.9.m9.1.1.3" xref="S3.SS4.p3.9.m9.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.9.m9.1b"><apply id="S3.SS4.p3.9.m9.1.1.cmml" xref="S3.SS4.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.9.m9.1.1.1.cmml" xref="S3.SS4.p3.9.m9.1.1">subscript</csymbol><ci id="S3.SS4.p3.9.m9.1.1.2.cmml" xref="S3.SS4.p3.9.m9.1.1.2">𝑑</ci><ci id="S3.SS4.p3.9.m9.1.1.3.cmml" xref="S3.SS4.p3.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.9.m9.1c">d_{t}</annotation></semantics></math> is the dimension of the Transformer, we reshape it back to <math id="S3.SS4.p3.10.m10.1" class="ltx_Math" alttext="h\times w\times d_{t}" display="inline"><semantics id="S3.SS4.p3.10.m10.1a"><mrow id="S3.SS4.p3.10.m10.1.1" xref="S3.SS4.p3.10.m10.1.1.cmml"><mi id="S3.SS4.p3.10.m10.1.1.2" xref="S3.SS4.p3.10.m10.1.1.2.cmml">h</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p3.10.m10.1.1.1" xref="S3.SS4.p3.10.m10.1.1.1.cmml">×</mo><mi id="S3.SS4.p3.10.m10.1.1.3" xref="S3.SS4.p3.10.m10.1.1.3.cmml">w</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p3.10.m10.1.1.1a" xref="S3.SS4.p3.10.m10.1.1.1.cmml">×</mo><msub id="S3.SS4.p3.10.m10.1.1.4" xref="S3.SS4.p3.10.m10.1.1.4.cmml"><mi id="S3.SS4.p3.10.m10.1.1.4.2" xref="S3.SS4.p3.10.m10.1.1.4.2.cmml">d</mi><mi id="S3.SS4.p3.10.m10.1.1.4.3" xref="S3.SS4.p3.10.m10.1.1.4.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.10.m10.1b"><apply id="S3.SS4.p3.10.m10.1.1.cmml" xref="S3.SS4.p3.10.m10.1.1"><times id="S3.SS4.p3.10.m10.1.1.1.cmml" xref="S3.SS4.p3.10.m10.1.1.1"></times><ci id="S3.SS4.p3.10.m10.1.1.2.cmml" xref="S3.SS4.p3.10.m10.1.1.2">ℎ</ci><ci id="S3.SS4.p3.10.m10.1.1.3.cmml" xref="S3.SS4.p3.10.m10.1.1.3">𝑤</ci><apply id="S3.SS4.p3.10.m10.1.1.4.cmml" xref="S3.SS4.p3.10.m10.1.1.4"><csymbol cd="ambiguous" id="S3.SS4.p3.10.m10.1.1.4.1.cmml" xref="S3.SS4.p3.10.m10.1.1.4">subscript</csymbol><ci id="S3.SS4.p3.10.m10.1.1.4.2.cmml" xref="S3.SS4.p3.10.m10.1.1.4.2">𝑑</ci><ci id="S3.SS4.p3.10.m10.1.1.4.3.cmml" xref="S3.SS4.p3.10.m10.1.1.4.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.10.m10.1c">h\times w\times d_{t}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS4.p4" class="ltx_para">
<p id="S3.SS4.p4.6" class="ltx_p">In the second stage, rather than using GMP as aggregator to convert the feature map <math id="S3.SS4.p4.1.m1.1" class="ltx_Math" alttext="\tilde{u}" display="inline"><semantics id="S3.SS4.p4.1.m1.1a"><mover accent="true" id="S3.SS4.p4.1.m1.1.1" xref="S3.SS4.p4.1.m1.1.1.cmml"><mi id="S3.SS4.p4.1.m1.1.1.2" xref="S3.SS4.p4.1.m1.1.1.2.cmml">u</mi><mo id="S3.SS4.p4.1.m1.1.1.1" xref="S3.SS4.p4.1.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.1.m1.1b"><apply id="S3.SS4.p4.1.m1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1"><ci id="S3.SS4.p4.1.m1.1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1.1">~</ci><ci id="S3.SS4.p4.1.m1.1.1.2.cmml" xref="S3.SS4.p4.1.m1.1.1.2">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.1.m1.1c">\tilde{u}</annotation></semantics></math> to the feature vector, we find the weighted summation as aggregator is better. Specifically, we send <math id="S3.SS4.p4.2.m2.1" class="ltx_Math" alttext="\tilde{u}" display="inline"><semantics id="S3.SS4.p4.2.m2.1a"><mover accent="true" id="S3.SS4.p4.2.m2.1.1" xref="S3.SS4.p4.2.m2.1.1.cmml"><mi id="S3.SS4.p4.2.m2.1.1.2" xref="S3.SS4.p4.2.m2.1.1.2.cmml">u</mi><mo id="S3.SS4.p4.2.m2.1.1.1" xref="S3.SS4.p4.2.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.2.m2.1b"><apply id="S3.SS4.p4.2.m2.1.1.cmml" xref="S3.SS4.p4.2.m2.1.1"><ci id="S3.SS4.p4.2.m2.1.1.1.cmml" xref="S3.SS4.p4.2.m2.1.1.1">~</ci><ci id="S3.SS4.p4.2.m2.1.1.2.cmml" xref="S3.SS4.p4.2.m2.1.1.2">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.2.m2.1c">\tilde{u}</annotation></semantics></math> to a <math id="S3.SS4.p4.3.m3.1" class="ltx_Math" alttext="1\times 1" display="inline"><semantics id="S3.SS4.p4.3.m3.1a"><mrow id="S3.SS4.p4.3.m3.1.1" xref="S3.SS4.p4.3.m3.1.1.cmml"><mn id="S3.SS4.p4.3.m3.1.1.2" xref="S3.SS4.p4.3.m3.1.1.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p4.3.m3.1.1.1" xref="S3.SS4.p4.3.m3.1.1.1.cmml">×</mo><mn id="S3.SS4.p4.3.m3.1.1.3" xref="S3.SS4.p4.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.3.m3.1b"><apply id="S3.SS4.p4.3.m3.1.1.cmml" xref="S3.SS4.p4.3.m3.1.1"><times id="S3.SS4.p4.3.m3.1.1.1.cmml" xref="S3.SS4.p4.3.m3.1.1.1"></times><cn type="integer" id="S3.SS4.p4.3.m3.1.1.2.cmml" xref="S3.SS4.p4.3.m3.1.1.2">1</cn><cn type="integer" id="S3.SS4.p4.3.m3.1.1.3.cmml" xref="S3.SS4.p4.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.3.m3.1c">1\times 1</annotation></semantics></math> convolution layer followed by a spatial softmax layer to get the attention/weight map <math id="S3.SS4.p4.4.m4.1" class="ltx_Math" alttext="a\in\mathbb{R}^{h\times w\times 1}" display="inline"><semantics id="S3.SS4.p4.4.m4.1a"><mrow id="S3.SS4.p4.4.m4.1.1" xref="S3.SS4.p4.4.m4.1.1.cmml"><mi id="S3.SS4.p4.4.m4.1.1.2" xref="S3.SS4.p4.4.m4.1.1.2.cmml">a</mi><mo id="S3.SS4.p4.4.m4.1.1.1" xref="S3.SS4.p4.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS4.p4.4.m4.1.1.3" xref="S3.SS4.p4.4.m4.1.1.3.cmml"><mi id="S3.SS4.p4.4.m4.1.1.3.2" xref="S3.SS4.p4.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p4.4.m4.1.1.3.3" xref="S3.SS4.p4.4.m4.1.1.3.3.cmml"><mi id="S3.SS4.p4.4.m4.1.1.3.3.2" xref="S3.SS4.p4.4.m4.1.1.3.3.2.cmml">h</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p4.4.m4.1.1.3.3.1" xref="S3.SS4.p4.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS4.p4.4.m4.1.1.3.3.3" xref="S3.SS4.p4.4.m4.1.1.3.3.3.cmml">w</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p4.4.m4.1.1.3.3.1a" xref="S3.SS4.p4.4.m4.1.1.3.3.1.cmml">×</mo><mn id="S3.SS4.p4.4.m4.1.1.3.3.4" xref="S3.SS4.p4.4.m4.1.1.3.3.4.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.4.m4.1b"><apply id="S3.SS4.p4.4.m4.1.1.cmml" xref="S3.SS4.p4.4.m4.1.1"><in id="S3.SS4.p4.4.m4.1.1.1.cmml" xref="S3.SS4.p4.4.m4.1.1.1"></in><ci id="S3.SS4.p4.4.m4.1.1.2.cmml" xref="S3.SS4.p4.4.m4.1.1.2">𝑎</ci><apply id="S3.SS4.p4.4.m4.1.1.3.cmml" xref="S3.SS4.p4.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p4.4.m4.1.1.3.1.cmml" xref="S3.SS4.p4.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS4.p4.4.m4.1.1.3.2.cmml" xref="S3.SS4.p4.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS4.p4.4.m4.1.1.3.3.cmml" xref="S3.SS4.p4.4.m4.1.1.3.3"><times id="S3.SS4.p4.4.m4.1.1.3.3.1.cmml" xref="S3.SS4.p4.4.m4.1.1.3.3.1"></times><ci id="S3.SS4.p4.4.m4.1.1.3.3.2.cmml" xref="S3.SS4.p4.4.m4.1.1.3.3.2">ℎ</ci><ci id="S3.SS4.p4.4.m4.1.1.3.3.3.cmml" xref="S3.SS4.p4.4.m4.1.1.3.3.3">𝑤</ci><cn type="integer" id="S3.SS4.p4.4.m4.1.1.3.3.4.cmml" xref="S3.SS4.p4.4.m4.1.1.3.3.4">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.4.m4.1c">a\in\mathbb{R}^{h\times w\times 1}</annotation></semantics></math>, the final features <math id="S3.SS4.p4.5.m5.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S3.SS4.p4.5.m5.1a"><mi id="S3.SS4.p4.5.m5.1.1" xref="S3.SS4.p4.5.m5.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.5.m5.1b"><ci id="S3.SS4.p4.5.m5.1.1.cmml" xref="S3.SS4.p4.5.m5.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.5.m5.1c">f</annotation></semantics></math> send to the MLP classifier is the weighted sum of <math id="S3.SS4.p4.6.m6.1" class="ltx_Math" alttext="\tilde{u}" display="inline"><semantics id="S3.SS4.p4.6.m6.1a"><mover accent="true" id="S3.SS4.p4.6.m6.1.1" xref="S3.SS4.p4.6.m6.1.1.cmml"><mi id="S3.SS4.p4.6.m6.1.1.2" xref="S3.SS4.p4.6.m6.1.1.2.cmml">u</mi><mo id="S3.SS4.p4.6.m6.1.1.1" xref="S3.SS4.p4.6.m6.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.6.m6.1b"><apply id="S3.SS4.p4.6.m6.1.1.cmml" xref="S3.SS4.p4.6.m6.1.1"><ci id="S3.SS4.p4.6.m6.1.1.1.cmml" xref="S3.SS4.p4.6.m6.1.1.1">~</ci><ci id="S3.SS4.p4.6.m6.1.1.2.cmml" xref="S3.SS4.p4.6.m6.1.1.2">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.6.m6.1c">\tilde{u}</annotation></semantics></math> at all spatial locations:</p>
<table id="S3.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E12.m1.4" class="ltx_Math" alttext="f=\text{sum}(a\cdot\tilde{u},\text{dim}=(0,1))" display="block"><semantics id="S3.E12.m1.4a"><mrow id="S3.E12.m1.4.4" xref="S3.E12.m1.4.4.cmml"><mi id="S3.E12.m1.4.4.3" xref="S3.E12.m1.4.4.3.cmml">f</mi><mo id="S3.E12.m1.4.4.2" xref="S3.E12.m1.4.4.2.cmml">=</mo><mrow id="S3.E12.m1.4.4.1" xref="S3.E12.m1.4.4.1.cmml"><mtext id="S3.E12.m1.4.4.1.3" xref="S3.E12.m1.4.4.1.3a.cmml">sum</mtext><mo lspace="0em" rspace="0em" id="S3.E12.m1.4.4.1.2" xref="S3.E12.m1.4.4.1.2.cmml">​</mo><mrow id="S3.E12.m1.4.4.1.1.1" xref="S3.E12.m1.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S3.E12.m1.4.4.1.1.1.2" xref="S3.E12.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S3.E12.m1.4.4.1.1.1.1" xref="S3.E12.m1.4.4.1.1.1.1.cmml"><mrow id="S3.E12.m1.4.4.1.1.1.1.1.1" xref="S3.E12.m1.4.4.1.1.1.1.1.2.cmml"><mrow id="S3.E12.m1.4.4.1.1.1.1.1.1.1" xref="S3.E12.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="S3.E12.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E12.m1.4.4.1.1.1.1.1.1.1.2.cmml">a</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E12.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E12.m1.4.4.1.1.1.1.1.1.1.1.cmml">⋅</mo><mover accent="true" id="S3.E12.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E12.m1.4.4.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E12.m1.4.4.1.1.1.1.1.1.1.3.2" xref="S3.E12.m1.4.4.1.1.1.1.1.1.1.3.2.cmml">u</mi><mo id="S3.E12.m1.4.4.1.1.1.1.1.1.1.3.1" xref="S3.E12.m1.4.4.1.1.1.1.1.1.1.3.1.cmml">~</mo></mover></mrow><mo id="S3.E12.m1.4.4.1.1.1.1.1.1.2" xref="S3.E12.m1.4.4.1.1.1.1.1.2.cmml">,</mo><mtext id="S3.E12.m1.3.3" xref="S3.E12.m1.3.3a.cmml">dim</mtext></mrow><mo id="S3.E12.m1.4.4.1.1.1.1.2" xref="S3.E12.m1.4.4.1.1.1.1.2.cmml">=</mo><mrow id="S3.E12.m1.4.4.1.1.1.1.3.2" xref="S3.E12.m1.4.4.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.E12.m1.4.4.1.1.1.1.3.2.1" xref="S3.E12.m1.4.4.1.1.1.1.3.1.cmml">(</mo><mn id="S3.E12.m1.1.1" xref="S3.E12.m1.1.1.cmml">0</mn><mo id="S3.E12.m1.4.4.1.1.1.1.3.2.2" xref="S3.E12.m1.4.4.1.1.1.1.3.1.cmml">,</mo><mn id="S3.E12.m1.2.2" xref="S3.E12.m1.2.2.cmml">1</mn><mo stretchy="false" id="S3.E12.m1.4.4.1.1.1.1.3.2.3" xref="S3.E12.m1.4.4.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E12.m1.4.4.1.1.1.3" xref="S3.E12.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.4b"><apply id="S3.E12.m1.4.4.cmml" xref="S3.E12.m1.4.4"><eq id="S3.E12.m1.4.4.2.cmml" xref="S3.E12.m1.4.4.2"></eq><ci id="S3.E12.m1.4.4.3.cmml" xref="S3.E12.m1.4.4.3">𝑓</ci><apply id="S3.E12.m1.4.4.1.cmml" xref="S3.E12.m1.4.4.1"><times id="S3.E12.m1.4.4.1.2.cmml" xref="S3.E12.m1.4.4.1.2"></times><ci id="S3.E12.m1.4.4.1.3a.cmml" xref="S3.E12.m1.4.4.1.3"><mtext id="S3.E12.m1.4.4.1.3.cmml" xref="S3.E12.m1.4.4.1.3">sum</mtext></ci><apply id="S3.E12.m1.4.4.1.1.1.1.cmml" xref="S3.E12.m1.4.4.1.1.1"><eq id="S3.E12.m1.4.4.1.1.1.1.2.cmml" xref="S3.E12.m1.4.4.1.1.1.1.2"></eq><list id="S3.E12.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E12.m1.4.4.1.1.1.1.1.1"><apply id="S3.E12.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.4.4.1.1.1.1.1.1.1"><ci id="S3.E12.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.4.4.1.1.1.1.1.1.1.1">⋅</ci><ci id="S3.E12.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.4.4.1.1.1.1.1.1.1.2">𝑎</ci><apply id="S3.E12.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.4.4.1.1.1.1.1.1.1.3"><ci id="S3.E12.m1.4.4.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E12.m1.4.4.1.1.1.1.1.1.1.3.1">~</ci><ci id="S3.E12.m1.4.4.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E12.m1.4.4.1.1.1.1.1.1.1.3.2">𝑢</ci></apply></apply><ci id="S3.E12.m1.3.3a.cmml" xref="S3.E12.m1.3.3"><mtext id="S3.E12.m1.3.3.cmml" xref="S3.E12.m1.3.3">dim</mtext></ci></list><interval closure="open" id="S3.E12.m1.4.4.1.1.1.1.3.1.cmml" xref="S3.E12.m1.4.4.1.1.1.1.3.2"><cn type="integer" id="S3.E12.m1.1.1.cmml" xref="S3.E12.m1.1.1">0</cn><cn type="integer" id="S3.E12.m1.2.2.cmml" xref="S3.E12.m1.2.2">1</cn></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.4c">f=\text{sum}(a\cdot\tilde{u},\text{dim}=(0,1))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p4.7" class="ltx_p">where <math id="S3.SS4.p4.7.m1.1" class="ltx_Math" alttext="f\in\mathbb{R}^{d_{t}}" display="inline"><semantics id="S3.SS4.p4.7.m1.1a"><mrow id="S3.SS4.p4.7.m1.1.1" xref="S3.SS4.p4.7.m1.1.1.cmml"><mi id="S3.SS4.p4.7.m1.1.1.2" xref="S3.SS4.p4.7.m1.1.1.2.cmml">f</mi><mo id="S3.SS4.p4.7.m1.1.1.1" xref="S3.SS4.p4.7.m1.1.1.1.cmml">∈</mo><msup id="S3.SS4.p4.7.m1.1.1.3" xref="S3.SS4.p4.7.m1.1.1.3.cmml"><mi id="S3.SS4.p4.7.m1.1.1.3.2" xref="S3.SS4.p4.7.m1.1.1.3.2.cmml">ℝ</mi><msub id="S3.SS4.p4.7.m1.1.1.3.3" xref="S3.SS4.p4.7.m1.1.1.3.3.cmml"><mi id="S3.SS4.p4.7.m1.1.1.3.3.2" xref="S3.SS4.p4.7.m1.1.1.3.3.2.cmml">d</mi><mi id="S3.SS4.p4.7.m1.1.1.3.3.3" xref="S3.SS4.p4.7.m1.1.1.3.3.3.cmml">t</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.7.m1.1b"><apply id="S3.SS4.p4.7.m1.1.1.cmml" xref="S3.SS4.p4.7.m1.1.1"><in id="S3.SS4.p4.7.m1.1.1.1.cmml" xref="S3.SS4.p4.7.m1.1.1.1"></in><ci id="S3.SS4.p4.7.m1.1.1.2.cmml" xref="S3.SS4.p4.7.m1.1.1.2">𝑓</ci><apply id="S3.SS4.p4.7.m1.1.1.3.cmml" xref="S3.SS4.p4.7.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p4.7.m1.1.1.3.1.cmml" xref="S3.SS4.p4.7.m1.1.1.3">superscript</csymbol><ci id="S3.SS4.p4.7.m1.1.1.3.2.cmml" xref="S3.SS4.p4.7.m1.1.1.3.2">ℝ</ci><apply id="S3.SS4.p4.7.m1.1.1.3.3.cmml" xref="S3.SS4.p4.7.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS4.p4.7.m1.1.1.3.3.1.cmml" xref="S3.SS4.p4.7.m1.1.1.3.3">subscript</csymbol><ci id="S3.SS4.p4.7.m1.1.1.3.3.2.cmml" xref="S3.SS4.p4.7.m1.1.1.3.3.2">𝑑</ci><ci id="S3.SS4.p4.7.m1.1.1.3.3.3.cmml" xref="S3.SS4.p4.7.m1.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.7.m1.1c">f\in\mathbb{R}^{d_{t}}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Training Loss</h3>

<div id="S3.SS5.p1" class="ltx_para">
<p id="S3.SS5.p1.13" class="ltx_p">In order to avoid model collapse and prevent certain modules from being always executed or always not executed, some sparsity and variance regularizations (<span id="S3.SS5.p1.13.1" class="ltx_text ltx_font_bold">?</span>; <span id="S3.SS5.p1.13.2" class="ltx_text ltx_font_bold">?</span>; <span id="S3.SS5.p1.13.3" class="ltx_text ltx_font_bold">?</span>) are introduced. In this paper, we do not require our model to be sparse. But we observe that adding an regularization technique called load-balancing loss <math id="S3.SS5.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{load}" display="inline"><semantics id="S3.SS5.p1.1.m1.1a"><msub id="S3.SS5.p1.1.m1.1.1" xref="S3.SS5.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p1.1.m1.1.1.2" xref="S3.SS5.p1.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.SS5.p1.1.m1.1.1.3" xref="S3.SS5.p1.1.m1.1.1.3.cmml"><mi id="S3.SS5.p1.1.m1.1.1.3.2" xref="S3.SS5.p1.1.m1.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.1.m1.1.1.3.1" xref="S3.SS5.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p1.1.m1.1.1.3.3" xref="S3.SS5.p1.1.m1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.1.m1.1.1.3.1a" xref="S3.SS5.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p1.1.m1.1.1.3.4" xref="S3.SS5.p1.1.m1.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.1.m1.1.1.3.1b" xref="S3.SS5.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p1.1.m1.1.1.3.5" xref="S3.SS5.p1.1.m1.1.1.3.5.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.1.m1.1b"><apply id="S3.SS5.p1.1.m1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.1.m1.1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS5.p1.1.m1.1.1.2.cmml" xref="S3.SS5.p1.1.m1.1.1.2">ℒ</ci><apply id="S3.SS5.p1.1.m1.1.1.3.cmml" xref="S3.SS5.p1.1.m1.1.1.3"><times id="S3.SS5.p1.1.m1.1.1.3.1.cmml" xref="S3.SS5.p1.1.m1.1.1.3.1"></times><ci id="S3.SS5.p1.1.m1.1.1.3.2.cmml" xref="S3.SS5.p1.1.m1.1.1.3.2">𝑙</ci><ci id="S3.SS5.p1.1.m1.1.1.3.3.cmml" xref="S3.SS5.p1.1.m1.1.1.3.3">𝑜</ci><ci id="S3.SS5.p1.1.m1.1.1.3.4.cmml" xref="S3.SS5.p1.1.m1.1.1.3.4">𝑎</ci><ci id="S3.SS5.p1.1.m1.1.1.3.5.cmml" xref="S3.SS5.p1.1.m1.1.1.3.5">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.1.m1.1c">\mathcal{L}_{load}</annotation></semantics></math>, which was first introduced in (<span id="S3.SS5.p1.13.4" class="ltx_text ltx_font_bold">?</span>) to prevent model collapse, will make the model converge faster.
We define the load of a module as the number of samples in one training batch activate that module. So the load of the <math id="S3.SS5.p1.2.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS5.p1.2.m2.1a"><mi id="S3.SS5.p1.2.m2.1.1" xref="S3.SS5.p1.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.2.m2.1b"><ci id="S3.SS5.p1.2.m2.1.1.cmml" xref="S3.SS5.p1.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.2.m2.1c">m</annotation></semantics></math>th module in the <math id="S3.SS5.p1.3.m3.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS5.p1.3.m3.1a"><mi id="S3.SS5.p1.3.m3.1.1" xref="S3.SS5.p1.3.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.3.m3.1b"><ci id="S3.SS5.p1.3.m3.1.1.cmml" xref="S3.SS5.p1.3.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.3.m3.1c">l</annotation></semantics></math>th layer is calculated as: <math id="S3.SS5.p1.4.m4.5" class="ltx_Math" alttext="\mathbf{A}_{l,m}=\sum_{i=1}^{N}\mathbf{P}_{l,m}^{(i)}" display="inline"><semantics id="S3.SS5.p1.4.m4.5a"><mrow id="S3.SS5.p1.4.m4.5.6" xref="S3.SS5.p1.4.m4.5.6.cmml"><msub id="S3.SS5.p1.4.m4.5.6.2" xref="S3.SS5.p1.4.m4.5.6.2.cmml"><mi id="S3.SS5.p1.4.m4.5.6.2.2" xref="S3.SS5.p1.4.m4.5.6.2.2.cmml">𝐀</mi><mrow id="S3.SS5.p1.4.m4.2.2.2.4" xref="S3.SS5.p1.4.m4.2.2.2.3.cmml"><mi id="S3.SS5.p1.4.m4.1.1.1.1" xref="S3.SS5.p1.4.m4.1.1.1.1.cmml">l</mi><mo id="S3.SS5.p1.4.m4.2.2.2.4.1" xref="S3.SS5.p1.4.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS5.p1.4.m4.2.2.2.2" xref="S3.SS5.p1.4.m4.2.2.2.2.cmml">m</mi></mrow></msub><mo rspace="0.111em" id="S3.SS5.p1.4.m4.5.6.1" xref="S3.SS5.p1.4.m4.5.6.1.cmml">=</mo><mrow id="S3.SS5.p1.4.m4.5.6.3" xref="S3.SS5.p1.4.m4.5.6.3.cmml"><msubsup id="S3.SS5.p1.4.m4.5.6.3.1" xref="S3.SS5.p1.4.m4.5.6.3.1.cmml"><mo id="S3.SS5.p1.4.m4.5.6.3.1.2.2" xref="S3.SS5.p1.4.m4.5.6.3.1.2.2.cmml">∑</mo><mrow id="S3.SS5.p1.4.m4.5.6.3.1.2.3" xref="S3.SS5.p1.4.m4.5.6.3.1.2.3.cmml"><mi id="S3.SS5.p1.4.m4.5.6.3.1.2.3.2" xref="S3.SS5.p1.4.m4.5.6.3.1.2.3.2.cmml">i</mi><mo id="S3.SS5.p1.4.m4.5.6.3.1.2.3.1" xref="S3.SS5.p1.4.m4.5.6.3.1.2.3.1.cmml">=</mo><mn id="S3.SS5.p1.4.m4.5.6.3.1.2.3.3" xref="S3.SS5.p1.4.m4.5.6.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS5.p1.4.m4.5.6.3.1.3" xref="S3.SS5.p1.4.m4.5.6.3.1.3.cmml">N</mi></msubsup><msubsup id="S3.SS5.p1.4.m4.5.6.3.2" xref="S3.SS5.p1.4.m4.5.6.3.2.cmml"><mi id="S3.SS5.p1.4.m4.5.6.3.2.2.2" xref="S3.SS5.p1.4.m4.5.6.3.2.2.2.cmml">𝐏</mi><mrow id="S3.SS5.p1.4.m4.4.4.2.4" xref="S3.SS5.p1.4.m4.4.4.2.3.cmml"><mi id="S3.SS5.p1.4.m4.3.3.1.1" xref="S3.SS5.p1.4.m4.3.3.1.1.cmml">l</mi><mo id="S3.SS5.p1.4.m4.4.4.2.4.1" xref="S3.SS5.p1.4.m4.4.4.2.3.cmml">,</mo><mi id="S3.SS5.p1.4.m4.4.4.2.2" xref="S3.SS5.p1.4.m4.4.4.2.2.cmml">m</mi></mrow><mrow id="S3.SS5.p1.4.m4.5.5.1.3" xref="S3.SS5.p1.4.m4.5.6.3.2.cmml"><mo stretchy="false" id="S3.SS5.p1.4.m4.5.5.1.3.1" xref="S3.SS5.p1.4.m4.5.6.3.2.cmml">(</mo><mi id="S3.SS5.p1.4.m4.5.5.1.1" xref="S3.SS5.p1.4.m4.5.5.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS5.p1.4.m4.5.5.1.3.2" xref="S3.SS5.p1.4.m4.5.6.3.2.cmml">)</mo></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.4.m4.5b"><apply id="S3.SS5.p1.4.m4.5.6.cmml" xref="S3.SS5.p1.4.m4.5.6"><eq id="S3.SS5.p1.4.m4.5.6.1.cmml" xref="S3.SS5.p1.4.m4.5.6.1"></eq><apply id="S3.SS5.p1.4.m4.5.6.2.cmml" xref="S3.SS5.p1.4.m4.5.6.2"><csymbol cd="ambiguous" id="S3.SS5.p1.4.m4.5.6.2.1.cmml" xref="S3.SS5.p1.4.m4.5.6.2">subscript</csymbol><ci id="S3.SS5.p1.4.m4.5.6.2.2.cmml" xref="S3.SS5.p1.4.m4.5.6.2.2">𝐀</ci><list id="S3.SS5.p1.4.m4.2.2.2.3.cmml" xref="S3.SS5.p1.4.m4.2.2.2.4"><ci id="S3.SS5.p1.4.m4.1.1.1.1.cmml" xref="S3.SS5.p1.4.m4.1.1.1.1">𝑙</ci><ci id="S3.SS5.p1.4.m4.2.2.2.2.cmml" xref="S3.SS5.p1.4.m4.2.2.2.2">𝑚</ci></list></apply><apply id="S3.SS5.p1.4.m4.5.6.3.cmml" xref="S3.SS5.p1.4.m4.5.6.3"><apply id="S3.SS5.p1.4.m4.5.6.3.1.cmml" xref="S3.SS5.p1.4.m4.5.6.3.1"><csymbol cd="ambiguous" id="S3.SS5.p1.4.m4.5.6.3.1.1.cmml" xref="S3.SS5.p1.4.m4.5.6.3.1">superscript</csymbol><apply id="S3.SS5.p1.4.m4.5.6.3.1.2.cmml" xref="S3.SS5.p1.4.m4.5.6.3.1"><csymbol cd="ambiguous" id="S3.SS5.p1.4.m4.5.6.3.1.2.1.cmml" xref="S3.SS5.p1.4.m4.5.6.3.1">subscript</csymbol><sum id="S3.SS5.p1.4.m4.5.6.3.1.2.2.cmml" xref="S3.SS5.p1.4.m4.5.6.3.1.2.2"></sum><apply id="S3.SS5.p1.4.m4.5.6.3.1.2.3.cmml" xref="S3.SS5.p1.4.m4.5.6.3.1.2.3"><eq id="S3.SS5.p1.4.m4.5.6.3.1.2.3.1.cmml" xref="S3.SS5.p1.4.m4.5.6.3.1.2.3.1"></eq><ci id="S3.SS5.p1.4.m4.5.6.3.1.2.3.2.cmml" xref="S3.SS5.p1.4.m4.5.6.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.SS5.p1.4.m4.5.6.3.1.2.3.3.cmml" xref="S3.SS5.p1.4.m4.5.6.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS5.p1.4.m4.5.6.3.1.3.cmml" xref="S3.SS5.p1.4.m4.5.6.3.1.3">𝑁</ci></apply><apply id="S3.SS5.p1.4.m4.5.6.3.2.cmml" xref="S3.SS5.p1.4.m4.5.6.3.2"><csymbol cd="ambiguous" id="S3.SS5.p1.4.m4.5.6.3.2.1.cmml" xref="S3.SS5.p1.4.m4.5.6.3.2">superscript</csymbol><apply id="S3.SS5.p1.4.m4.5.6.3.2.2.cmml" xref="S3.SS5.p1.4.m4.5.6.3.2"><csymbol cd="ambiguous" id="S3.SS5.p1.4.m4.5.6.3.2.2.1.cmml" xref="S3.SS5.p1.4.m4.5.6.3.2">subscript</csymbol><ci id="S3.SS5.p1.4.m4.5.6.3.2.2.2.cmml" xref="S3.SS5.p1.4.m4.5.6.3.2.2.2">𝐏</ci><list id="S3.SS5.p1.4.m4.4.4.2.3.cmml" xref="S3.SS5.p1.4.m4.4.4.2.4"><ci id="S3.SS5.p1.4.m4.3.3.1.1.cmml" xref="S3.SS5.p1.4.m4.3.3.1.1">𝑙</ci><ci id="S3.SS5.p1.4.m4.4.4.2.2.cmml" xref="S3.SS5.p1.4.m4.4.4.2.2">𝑚</ci></list></apply><ci id="S3.SS5.p1.4.m4.5.5.1.1.cmml" xref="S3.SS5.p1.4.m4.5.5.1.1">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.4.m4.5c">\mathbf{A}_{l,m}=\sum_{i=1}^{N}\mathbf{P}_{l,m}^{(i)}</annotation></semantics></math>, where <math id="S3.SS5.p1.5.m5.3" class="ltx_Math" alttext="\mathbf{P}_{l,m}^{(i)}" display="inline"><semantics id="S3.SS5.p1.5.m5.3a"><msubsup id="S3.SS5.p1.5.m5.3.4" xref="S3.SS5.p1.5.m5.3.4.cmml"><mi id="S3.SS5.p1.5.m5.3.4.2.2" xref="S3.SS5.p1.5.m5.3.4.2.2.cmml">𝐏</mi><mrow id="S3.SS5.p1.5.m5.2.2.2.4" xref="S3.SS5.p1.5.m5.2.2.2.3.cmml"><mi id="S3.SS5.p1.5.m5.1.1.1.1" xref="S3.SS5.p1.5.m5.1.1.1.1.cmml">l</mi><mo id="S3.SS5.p1.5.m5.2.2.2.4.1" xref="S3.SS5.p1.5.m5.2.2.2.3.cmml">,</mo><mi id="S3.SS5.p1.5.m5.2.2.2.2" xref="S3.SS5.p1.5.m5.2.2.2.2.cmml">m</mi></mrow><mrow id="S3.SS5.p1.5.m5.3.3.1.3" xref="S3.SS5.p1.5.m5.3.4.cmml"><mo stretchy="false" id="S3.SS5.p1.5.m5.3.3.1.3.1" xref="S3.SS5.p1.5.m5.3.4.cmml">(</mo><mi id="S3.SS5.p1.5.m5.3.3.1.1" xref="S3.SS5.p1.5.m5.3.3.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS5.p1.5.m5.3.3.1.3.2" xref="S3.SS5.p1.5.m5.3.4.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.5.m5.3b"><apply id="S3.SS5.p1.5.m5.3.4.cmml" xref="S3.SS5.p1.5.m5.3.4"><csymbol cd="ambiguous" id="S3.SS5.p1.5.m5.3.4.1.cmml" xref="S3.SS5.p1.5.m5.3.4">superscript</csymbol><apply id="S3.SS5.p1.5.m5.3.4.2.cmml" xref="S3.SS5.p1.5.m5.3.4"><csymbol cd="ambiguous" id="S3.SS5.p1.5.m5.3.4.2.1.cmml" xref="S3.SS5.p1.5.m5.3.4">subscript</csymbol><ci id="S3.SS5.p1.5.m5.3.4.2.2.cmml" xref="S3.SS5.p1.5.m5.3.4.2.2">𝐏</ci><list id="S3.SS5.p1.5.m5.2.2.2.3.cmml" xref="S3.SS5.p1.5.m5.2.2.2.4"><ci id="S3.SS5.p1.5.m5.1.1.1.1.cmml" xref="S3.SS5.p1.5.m5.1.1.1.1">𝑙</ci><ci id="S3.SS5.p1.5.m5.2.2.2.2.cmml" xref="S3.SS5.p1.5.m5.2.2.2.2">𝑚</ci></list></apply><ci id="S3.SS5.p1.5.m5.3.3.1.1.cmml" xref="S3.SS5.p1.5.m5.3.3.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.5.m5.3c">\mathbf{P}_{l,m}^{(i)}</annotation></semantics></math> is the gate of the <math id="S3.SS5.p1.6.m6.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS5.p1.6.m6.1a"><mi id="S3.SS5.p1.6.m6.1.1" xref="S3.SS5.p1.6.m6.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.6.m6.1b"><ci id="S3.SS5.p1.6.m6.1.1.cmml" xref="S3.SS5.p1.6.m6.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.6.m6.1c">m</annotation></semantics></math>th module in the <math id="S3.SS5.p1.7.m7.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS5.p1.7.m7.1a"><mi id="S3.SS5.p1.7.m7.1.1" xref="S3.SS5.p1.7.m7.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.7.m7.1b"><ci id="S3.SS5.p1.7.m7.1.1.cmml" xref="S3.SS5.p1.7.m7.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.7.m7.1c">l</annotation></semantics></math>th layer for the <math id="S3.SS5.p1.8.m8.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS5.p1.8.m8.1a"><mi id="S3.SS5.p1.8.m8.1.1" xref="S3.SS5.p1.8.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.8.m8.1b"><ci id="S3.SS5.p1.8.m8.1.1.cmml" xref="S3.SS5.p1.8.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.8.m8.1c">i</annotation></semantics></math>th instance in the mini-batch, <math id="S3.SS5.p1.9.m9.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS5.p1.9.m9.1a"><mi id="S3.SS5.p1.9.m9.1.1" xref="S3.SS5.p1.9.m9.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.9.m9.1b"><ci id="S3.SS5.p1.9.m9.1.1.cmml" xref="S3.SS5.p1.9.m9.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.9.m9.1c">N</annotation></semantics></math> is the batch size. Further, we define <math id="S3.SS5.p1.10.m10.3" class="ltx_Math" alttext="\mathcal{L}_{load_{l}}=\mathrm{CV}(\mathbf{A}_{l,:})^{2}" display="inline"><semantics id="S3.SS5.p1.10.m10.3a"><mrow id="S3.SS5.p1.10.m10.3.3" xref="S3.SS5.p1.10.m10.3.3.cmml"><msub id="S3.SS5.p1.10.m10.3.3.3" xref="S3.SS5.p1.10.m10.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p1.10.m10.3.3.3.2" xref="S3.SS5.p1.10.m10.3.3.3.2.cmml">ℒ</mi><mrow id="S3.SS5.p1.10.m10.3.3.3.3" xref="S3.SS5.p1.10.m10.3.3.3.3.cmml"><mi id="S3.SS5.p1.10.m10.3.3.3.3.2" xref="S3.SS5.p1.10.m10.3.3.3.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.10.m10.3.3.3.3.1" xref="S3.SS5.p1.10.m10.3.3.3.3.1.cmml">​</mo><mi id="S3.SS5.p1.10.m10.3.3.3.3.3" xref="S3.SS5.p1.10.m10.3.3.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.10.m10.3.3.3.3.1a" xref="S3.SS5.p1.10.m10.3.3.3.3.1.cmml">​</mo><mi id="S3.SS5.p1.10.m10.3.3.3.3.4" xref="S3.SS5.p1.10.m10.3.3.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.10.m10.3.3.3.3.1b" xref="S3.SS5.p1.10.m10.3.3.3.3.1.cmml">​</mo><msub id="S3.SS5.p1.10.m10.3.3.3.3.5" xref="S3.SS5.p1.10.m10.3.3.3.3.5.cmml"><mi id="S3.SS5.p1.10.m10.3.3.3.3.5.2" xref="S3.SS5.p1.10.m10.3.3.3.3.5.2.cmml">d</mi><mi id="S3.SS5.p1.10.m10.3.3.3.3.5.3" xref="S3.SS5.p1.10.m10.3.3.3.3.5.3.cmml">l</mi></msub></mrow></msub><mo id="S3.SS5.p1.10.m10.3.3.2" xref="S3.SS5.p1.10.m10.3.3.2.cmml">=</mo><mrow id="S3.SS5.p1.10.m10.3.3.1" xref="S3.SS5.p1.10.m10.3.3.1.cmml"><mi id="S3.SS5.p1.10.m10.3.3.1.3" xref="S3.SS5.p1.10.m10.3.3.1.3.cmml">CV</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.10.m10.3.3.1.2" xref="S3.SS5.p1.10.m10.3.3.1.2.cmml">​</mo><msup id="S3.SS5.p1.10.m10.3.3.1.1" xref="S3.SS5.p1.10.m10.3.3.1.1.cmml"><mrow id="S3.SS5.p1.10.m10.3.3.1.1.1.1" xref="S3.SS5.p1.10.m10.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS5.p1.10.m10.3.3.1.1.1.1.2" xref="S3.SS5.p1.10.m10.3.3.1.1.1.1.1.cmml">(</mo><msub id="S3.SS5.p1.10.m10.3.3.1.1.1.1.1" xref="S3.SS5.p1.10.m10.3.3.1.1.1.1.1.cmml"><mi id="S3.SS5.p1.10.m10.3.3.1.1.1.1.1.2" xref="S3.SS5.p1.10.m10.3.3.1.1.1.1.1.2.cmml">𝐀</mi><mrow id="S3.SS5.p1.10.m10.2.2.2.4" xref="S3.SS5.p1.10.m10.2.2.2.3.cmml"><mi id="S3.SS5.p1.10.m10.1.1.1.1" xref="S3.SS5.p1.10.m10.1.1.1.1.cmml">l</mi><mo id="S3.SS5.p1.10.m10.2.2.2.4.1" xref="S3.SS5.p1.10.m10.2.2.2.3.cmml">,</mo><mo id="S3.SS5.p1.10.m10.2.2.2.2" xref="S3.SS5.p1.10.m10.2.2.2.2.cmml">:</mo></mrow></msub><mo stretchy="false" id="S3.SS5.p1.10.m10.3.3.1.1.1.1.3" xref="S3.SS5.p1.10.m10.3.3.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.SS5.p1.10.m10.3.3.1.1.3" xref="S3.SS5.p1.10.m10.3.3.1.1.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.10.m10.3b"><apply id="S3.SS5.p1.10.m10.3.3.cmml" xref="S3.SS5.p1.10.m10.3.3"><eq id="S3.SS5.p1.10.m10.3.3.2.cmml" xref="S3.SS5.p1.10.m10.3.3.2"></eq><apply id="S3.SS5.p1.10.m10.3.3.3.cmml" xref="S3.SS5.p1.10.m10.3.3.3"><csymbol cd="ambiguous" id="S3.SS5.p1.10.m10.3.3.3.1.cmml" xref="S3.SS5.p1.10.m10.3.3.3">subscript</csymbol><ci id="S3.SS5.p1.10.m10.3.3.3.2.cmml" xref="S3.SS5.p1.10.m10.3.3.3.2">ℒ</ci><apply id="S3.SS5.p1.10.m10.3.3.3.3.cmml" xref="S3.SS5.p1.10.m10.3.3.3.3"><times id="S3.SS5.p1.10.m10.3.3.3.3.1.cmml" xref="S3.SS5.p1.10.m10.3.3.3.3.1"></times><ci id="S3.SS5.p1.10.m10.3.3.3.3.2.cmml" xref="S3.SS5.p1.10.m10.3.3.3.3.2">𝑙</ci><ci id="S3.SS5.p1.10.m10.3.3.3.3.3.cmml" xref="S3.SS5.p1.10.m10.3.3.3.3.3">𝑜</ci><ci id="S3.SS5.p1.10.m10.3.3.3.3.4.cmml" xref="S3.SS5.p1.10.m10.3.3.3.3.4">𝑎</ci><apply id="S3.SS5.p1.10.m10.3.3.3.3.5.cmml" xref="S3.SS5.p1.10.m10.3.3.3.3.5"><csymbol cd="ambiguous" id="S3.SS5.p1.10.m10.3.3.3.3.5.1.cmml" xref="S3.SS5.p1.10.m10.3.3.3.3.5">subscript</csymbol><ci id="S3.SS5.p1.10.m10.3.3.3.3.5.2.cmml" xref="S3.SS5.p1.10.m10.3.3.3.3.5.2">𝑑</ci><ci id="S3.SS5.p1.10.m10.3.3.3.3.5.3.cmml" xref="S3.SS5.p1.10.m10.3.3.3.3.5.3">𝑙</ci></apply></apply></apply><apply id="S3.SS5.p1.10.m10.3.3.1.cmml" xref="S3.SS5.p1.10.m10.3.3.1"><times id="S3.SS5.p1.10.m10.3.3.1.2.cmml" xref="S3.SS5.p1.10.m10.3.3.1.2"></times><ci id="S3.SS5.p1.10.m10.3.3.1.3.cmml" xref="S3.SS5.p1.10.m10.3.3.1.3">CV</ci><apply id="S3.SS5.p1.10.m10.3.3.1.1.cmml" xref="S3.SS5.p1.10.m10.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.10.m10.3.3.1.1.2.cmml" xref="S3.SS5.p1.10.m10.3.3.1.1">superscript</csymbol><apply id="S3.SS5.p1.10.m10.3.3.1.1.1.1.1.cmml" xref="S3.SS5.p1.10.m10.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.10.m10.3.3.1.1.1.1.1.1.cmml" xref="S3.SS5.p1.10.m10.3.3.1.1.1.1">subscript</csymbol><ci id="S3.SS5.p1.10.m10.3.3.1.1.1.1.1.2.cmml" xref="S3.SS5.p1.10.m10.3.3.1.1.1.1.1.2">𝐀</ci><list id="S3.SS5.p1.10.m10.2.2.2.3.cmml" xref="S3.SS5.p1.10.m10.2.2.2.4"><ci id="S3.SS5.p1.10.m10.1.1.1.1.cmml" xref="S3.SS5.p1.10.m10.1.1.1.1">𝑙</ci><ci id="S3.SS5.p1.10.m10.2.2.2.2.cmml" xref="S3.SS5.p1.10.m10.2.2.2.2">:</ci></list></apply><cn type="integer" id="S3.SS5.p1.10.m10.3.3.1.1.3.cmml" xref="S3.SS5.p1.10.m10.3.3.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.10.m10.3c">\mathcal{L}_{load_{l}}=\mathrm{CV}(\mathbf{A}_{l,:})^{2}</annotation></semantics></math> as the square of the coefficient of variation (CV) for the module load at the <math id="S3.SS5.p1.11.m11.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS5.p1.11.m11.1a"><mi id="S3.SS5.p1.11.m11.1.1" xref="S3.SS5.p1.11.m11.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.11.m11.1b"><ci id="S3.SS5.p1.11.m11.1.1.cmml" xref="S3.SS5.p1.11.m11.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.11.m11.1c">l</annotation></semantics></math>th layer, and <math id="S3.SS5.p1.12.m12.1" class="ltx_Math" alttext="\mathcal{L}_{load}=\sum_{l=1}^{L}\mathcal{L}_{load_{l}}" display="inline"><semantics id="S3.SS5.p1.12.m12.1a"><mrow id="S3.SS5.p1.12.m12.1.1" xref="S3.SS5.p1.12.m12.1.1.cmml"><msub id="S3.SS5.p1.12.m12.1.1.2" xref="S3.SS5.p1.12.m12.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p1.12.m12.1.1.2.2" xref="S3.SS5.p1.12.m12.1.1.2.2.cmml">ℒ</mi><mrow id="S3.SS5.p1.12.m12.1.1.2.3" xref="S3.SS5.p1.12.m12.1.1.2.3.cmml"><mi id="S3.SS5.p1.12.m12.1.1.2.3.2" xref="S3.SS5.p1.12.m12.1.1.2.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.12.m12.1.1.2.3.1" xref="S3.SS5.p1.12.m12.1.1.2.3.1.cmml">​</mo><mi id="S3.SS5.p1.12.m12.1.1.2.3.3" xref="S3.SS5.p1.12.m12.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.12.m12.1.1.2.3.1a" xref="S3.SS5.p1.12.m12.1.1.2.3.1.cmml">​</mo><mi id="S3.SS5.p1.12.m12.1.1.2.3.4" xref="S3.SS5.p1.12.m12.1.1.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.12.m12.1.1.2.3.1b" xref="S3.SS5.p1.12.m12.1.1.2.3.1.cmml">​</mo><mi id="S3.SS5.p1.12.m12.1.1.2.3.5" xref="S3.SS5.p1.12.m12.1.1.2.3.5.cmml">d</mi></mrow></msub><mo rspace="0.111em" id="S3.SS5.p1.12.m12.1.1.1" xref="S3.SS5.p1.12.m12.1.1.1.cmml">=</mo><mrow id="S3.SS5.p1.12.m12.1.1.3" xref="S3.SS5.p1.12.m12.1.1.3.cmml"><msubsup id="S3.SS5.p1.12.m12.1.1.3.1" xref="S3.SS5.p1.12.m12.1.1.3.1.cmml"><mo id="S3.SS5.p1.12.m12.1.1.3.1.2.2" xref="S3.SS5.p1.12.m12.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.SS5.p1.12.m12.1.1.3.1.2.3" xref="S3.SS5.p1.12.m12.1.1.3.1.2.3.cmml"><mi id="S3.SS5.p1.12.m12.1.1.3.1.2.3.2" xref="S3.SS5.p1.12.m12.1.1.3.1.2.3.2.cmml">l</mi><mo id="S3.SS5.p1.12.m12.1.1.3.1.2.3.1" xref="S3.SS5.p1.12.m12.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.SS5.p1.12.m12.1.1.3.1.2.3.3" xref="S3.SS5.p1.12.m12.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS5.p1.12.m12.1.1.3.1.3" xref="S3.SS5.p1.12.m12.1.1.3.1.3.cmml">L</mi></msubsup><msub id="S3.SS5.p1.12.m12.1.1.3.2" xref="S3.SS5.p1.12.m12.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p1.12.m12.1.1.3.2.2" xref="S3.SS5.p1.12.m12.1.1.3.2.2.cmml">ℒ</mi><mrow id="S3.SS5.p1.12.m12.1.1.3.2.3" xref="S3.SS5.p1.12.m12.1.1.3.2.3.cmml"><mi id="S3.SS5.p1.12.m12.1.1.3.2.3.2" xref="S3.SS5.p1.12.m12.1.1.3.2.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.12.m12.1.1.3.2.3.1" xref="S3.SS5.p1.12.m12.1.1.3.2.3.1.cmml">​</mo><mi id="S3.SS5.p1.12.m12.1.1.3.2.3.3" xref="S3.SS5.p1.12.m12.1.1.3.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.12.m12.1.1.3.2.3.1a" xref="S3.SS5.p1.12.m12.1.1.3.2.3.1.cmml">​</mo><mi id="S3.SS5.p1.12.m12.1.1.3.2.3.4" xref="S3.SS5.p1.12.m12.1.1.3.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.12.m12.1.1.3.2.3.1b" xref="S3.SS5.p1.12.m12.1.1.3.2.3.1.cmml">​</mo><msub id="S3.SS5.p1.12.m12.1.1.3.2.3.5" xref="S3.SS5.p1.12.m12.1.1.3.2.3.5.cmml"><mi id="S3.SS5.p1.12.m12.1.1.3.2.3.5.2" xref="S3.SS5.p1.12.m12.1.1.3.2.3.5.2.cmml">d</mi><mi id="S3.SS5.p1.12.m12.1.1.3.2.3.5.3" xref="S3.SS5.p1.12.m12.1.1.3.2.3.5.3.cmml">l</mi></msub></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.12.m12.1b"><apply id="S3.SS5.p1.12.m12.1.1.cmml" xref="S3.SS5.p1.12.m12.1.1"><eq id="S3.SS5.p1.12.m12.1.1.1.cmml" xref="S3.SS5.p1.12.m12.1.1.1"></eq><apply id="S3.SS5.p1.12.m12.1.1.2.cmml" xref="S3.SS5.p1.12.m12.1.1.2"><csymbol cd="ambiguous" id="S3.SS5.p1.12.m12.1.1.2.1.cmml" xref="S3.SS5.p1.12.m12.1.1.2">subscript</csymbol><ci id="S3.SS5.p1.12.m12.1.1.2.2.cmml" xref="S3.SS5.p1.12.m12.1.1.2.2">ℒ</ci><apply id="S3.SS5.p1.12.m12.1.1.2.3.cmml" xref="S3.SS5.p1.12.m12.1.1.2.3"><times id="S3.SS5.p1.12.m12.1.1.2.3.1.cmml" xref="S3.SS5.p1.12.m12.1.1.2.3.1"></times><ci id="S3.SS5.p1.12.m12.1.1.2.3.2.cmml" xref="S3.SS5.p1.12.m12.1.1.2.3.2">𝑙</ci><ci id="S3.SS5.p1.12.m12.1.1.2.3.3.cmml" xref="S3.SS5.p1.12.m12.1.1.2.3.3">𝑜</ci><ci id="S3.SS5.p1.12.m12.1.1.2.3.4.cmml" xref="S3.SS5.p1.12.m12.1.1.2.3.4">𝑎</ci><ci id="S3.SS5.p1.12.m12.1.1.2.3.5.cmml" xref="S3.SS5.p1.12.m12.1.1.2.3.5">𝑑</ci></apply></apply><apply id="S3.SS5.p1.12.m12.1.1.3.cmml" xref="S3.SS5.p1.12.m12.1.1.3"><apply id="S3.SS5.p1.12.m12.1.1.3.1.cmml" xref="S3.SS5.p1.12.m12.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS5.p1.12.m12.1.1.3.1.1.cmml" xref="S3.SS5.p1.12.m12.1.1.3.1">superscript</csymbol><apply id="S3.SS5.p1.12.m12.1.1.3.1.2.cmml" xref="S3.SS5.p1.12.m12.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS5.p1.12.m12.1.1.3.1.2.1.cmml" xref="S3.SS5.p1.12.m12.1.1.3.1">subscript</csymbol><sum id="S3.SS5.p1.12.m12.1.1.3.1.2.2.cmml" xref="S3.SS5.p1.12.m12.1.1.3.1.2.2"></sum><apply id="S3.SS5.p1.12.m12.1.1.3.1.2.3.cmml" xref="S3.SS5.p1.12.m12.1.1.3.1.2.3"><eq id="S3.SS5.p1.12.m12.1.1.3.1.2.3.1.cmml" xref="S3.SS5.p1.12.m12.1.1.3.1.2.3.1"></eq><ci id="S3.SS5.p1.12.m12.1.1.3.1.2.3.2.cmml" xref="S3.SS5.p1.12.m12.1.1.3.1.2.3.2">𝑙</ci><cn type="integer" id="S3.SS5.p1.12.m12.1.1.3.1.2.3.3.cmml" xref="S3.SS5.p1.12.m12.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS5.p1.12.m12.1.1.3.1.3.cmml" xref="S3.SS5.p1.12.m12.1.1.3.1.3">𝐿</ci></apply><apply id="S3.SS5.p1.12.m12.1.1.3.2.cmml" xref="S3.SS5.p1.12.m12.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS5.p1.12.m12.1.1.3.2.1.cmml" xref="S3.SS5.p1.12.m12.1.1.3.2">subscript</csymbol><ci id="S3.SS5.p1.12.m12.1.1.3.2.2.cmml" xref="S3.SS5.p1.12.m12.1.1.3.2.2">ℒ</ci><apply id="S3.SS5.p1.12.m12.1.1.3.2.3.cmml" xref="S3.SS5.p1.12.m12.1.1.3.2.3"><times id="S3.SS5.p1.12.m12.1.1.3.2.3.1.cmml" xref="S3.SS5.p1.12.m12.1.1.3.2.3.1"></times><ci id="S3.SS5.p1.12.m12.1.1.3.2.3.2.cmml" xref="S3.SS5.p1.12.m12.1.1.3.2.3.2">𝑙</ci><ci id="S3.SS5.p1.12.m12.1.1.3.2.3.3.cmml" xref="S3.SS5.p1.12.m12.1.1.3.2.3.3">𝑜</ci><ci id="S3.SS5.p1.12.m12.1.1.3.2.3.4.cmml" xref="S3.SS5.p1.12.m12.1.1.3.2.3.4">𝑎</ci><apply id="S3.SS5.p1.12.m12.1.1.3.2.3.5.cmml" xref="S3.SS5.p1.12.m12.1.1.3.2.3.5"><csymbol cd="ambiguous" id="S3.SS5.p1.12.m12.1.1.3.2.3.5.1.cmml" xref="S3.SS5.p1.12.m12.1.1.3.2.3.5">subscript</csymbol><ci id="S3.SS5.p1.12.m12.1.1.3.2.3.5.2.cmml" xref="S3.SS5.p1.12.m12.1.1.3.2.3.5.2">𝑑</ci><ci id="S3.SS5.p1.12.m12.1.1.3.2.3.5.3.cmml" xref="S3.SS5.p1.12.m12.1.1.3.2.3.5.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.12.m12.1c">\mathcal{L}_{load}=\sum_{l=1}^{L}\mathcal{L}_{load_{l}}</annotation></semantics></math> as the sum of <math id="S3.SS5.p1.13.m13.1" class="ltx_Math" alttext="\mathcal{L}_{load_{l}}" display="inline"><semantics id="S3.SS5.p1.13.m13.1a"><msub id="S3.SS5.p1.13.m13.1.1" xref="S3.SS5.p1.13.m13.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p1.13.m13.1.1.2" xref="S3.SS5.p1.13.m13.1.1.2.cmml">ℒ</mi><mrow id="S3.SS5.p1.13.m13.1.1.3" xref="S3.SS5.p1.13.m13.1.1.3.cmml"><mi id="S3.SS5.p1.13.m13.1.1.3.2" xref="S3.SS5.p1.13.m13.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.13.m13.1.1.3.1" xref="S3.SS5.p1.13.m13.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p1.13.m13.1.1.3.3" xref="S3.SS5.p1.13.m13.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.13.m13.1.1.3.1a" xref="S3.SS5.p1.13.m13.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p1.13.m13.1.1.3.4" xref="S3.SS5.p1.13.m13.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.13.m13.1.1.3.1b" xref="S3.SS5.p1.13.m13.1.1.3.1.cmml">​</mo><msub id="S3.SS5.p1.13.m13.1.1.3.5" xref="S3.SS5.p1.13.m13.1.1.3.5.cmml"><mi id="S3.SS5.p1.13.m13.1.1.3.5.2" xref="S3.SS5.p1.13.m13.1.1.3.5.2.cmml">d</mi><mi id="S3.SS5.p1.13.m13.1.1.3.5.3" xref="S3.SS5.p1.13.m13.1.1.3.5.3.cmml">l</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.13.m13.1b"><apply id="S3.SS5.p1.13.m13.1.1.cmml" xref="S3.SS5.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.13.m13.1.1.1.cmml" xref="S3.SS5.p1.13.m13.1.1">subscript</csymbol><ci id="S3.SS5.p1.13.m13.1.1.2.cmml" xref="S3.SS5.p1.13.m13.1.1.2">ℒ</ci><apply id="S3.SS5.p1.13.m13.1.1.3.cmml" xref="S3.SS5.p1.13.m13.1.1.3"><times id="S3.SS5.p1.13.m13.1.1.3.1.cmml" xref="S3.SS5.p1.13.m13.1.1.3.1"></times><ci id="S3.SS5.p1.13.m13.1.1.3.2.cmml" xref="S3.SS5.p1.13.m13.1.1.3.2">𝑙</ci><ci id="S3.SS5.p1.13.m13.1.1.3.3.cmml" xref="S3.SS5.p1.13.m13.1.1.3.3">𝑜</ci><ci id="S3.SS5.p1.13.m13.1.1.3.4.cmml" xref="S3.SS5.p1.13.m13.1.1.3.4">𝑎</ci><apply id="S3.SS5.p1.13.m13.1.1.3.5.cmml" xref="S3.SS5.p1.13.m13.1.1.3.5"><csymbol cd="ambiguous" id="S3.SS5.p1.13.m13.1.1.3.5.1.cmml" xref="S3.SS5.p1.13.m13.1.1.3.5">subscript</csymbol><ci id="S3.SS5.p1.13.m13.1.1.3.5.2.cmml" xref="S3.SS5.p1.13.m13.1.1.3.5.2">𝑑</ci><ci id="S3.SS5.p1.13.m13.1.1.3.5.3.cmml" xref="S3.SS5.p1.13.m13.1.1.3.5.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.13.m13.1c">\mathcal{L}_{load_{l}}</annotation></semantics></math> in all layers.</p>
</div>
<div id="S3.SS5.p2" class="ltx_para">
<p id="S3.SS5.p2.1" class="ltx_p">With the standard VQA loss <math id="S3.SS5.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{vqa}" display="inline"><semantics id="S3.SS5.p2.1.m1.1a"><msub id="S3.SS5.p2.1.m1.1.1" xref="S3.SS5.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p2.1.m1.1.1.2" xref="S3.SS5.p2.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.SS5.p2.1.m1.1.1.3" xref="S3.SS5.p2.1.m1.1.1.3.cmml"><mi id="S3.SS5.p2.1.m1.1.1.3.2" xref="S3.SS5.p2.1.m1.1.1.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p2.1.m1.1.1.3.1" xref="S3.SS5.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p2.1.m1.1.1.3.3" xref="S3.SS5.p2.1.m1.1.1.3.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p2.1.m1.1.1.3.1a" xref="S3.SS5.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p2.1.m1.1.1.3.4" xref="S3.SS5.p2.1.m1.1.1.3.4.cmml">a</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.1.m1.1b"><apply id="S3.SS5.p2.1.m1.1.1.cmml" xref="S3.SS5.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.1.m1.1.1.1.cmml" xref="S3.SS5.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS5.p2.1.m1.1.1.2.cmml" xref="S3.SS5.p2.1.m1.1.1.2">ℒ</ci><apply id="S3.SS5.p2.1.m1.1.1.3.cmml" xref="S3.SS5.p2.1.m1.1.1.3"><times id="S3.SS5.p2.1.m1.1.1.3.1.cmml" xref="S3.SS5.p2.1.m1.1.1.3.1"></times><ci id="S3.SS5.p2.1.m1.1.1.3.2.cmml" xref="S3.SS5.p2.1.m1.1.1.3.2">𝑣</ci><ci id="S3.SS5.p2.1.m1.1.1.3.3.cmml" xref="S3.SS5.p2.1.m1.1.1.3.3">𝑞</ci><ci id="S3.SS5.p2.1.m1.1.1.3.4.cmml" xref="S3.SS5.p2.1.m1.1.1.3.4">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.1.m1.1c">\mathcal{L}_{vqa}</annotation></semantics></math>, the full loss is:</p>
<table id="S3.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E13.m1.1" class="ltx_Math" alttext="\mathcal{L}=\mathcal{L}_{vqa}+\lambda\mathcal{L}_{load}" display="block"><semantics id="S3.E13.m1.1a"><mrow id="S3.E13.m1.1.1" xref="S3.E13.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.1.1.2" xref="S3.E13.m1.1.1.2.cmml">ℒ</mi><mo id="S3.E13.m1.1.1.1" xref="S3.E13.m1.1.1.1.cmml">=</mo><mrow id="S3.E13.m1.1.1.3" xref="S3.E13.m1.1.1.3.cmml"><msub id="S3.E13.m1.1.1.3.2" xref="S3.E13.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.1.1.3.2.2" xref="S3.E13.m1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S3.E13.m1.1.1.3.2.3" xref="S3.E13.m1.1.1.3.2.3.cmml"><mi id="S3.E13.m1.1.1.3.2.3.2" xref="S3.E13.m1.1.1.3.2.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.3.2.3.1" xref="S3.E13.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E13.m1.1.1.3.2.3.3" xref="S3.E13.m1.1.1.3.2.3.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.3.2.3.1a" xref="S3.E13.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E13.m1.1.1.3.2.3.4" xref="S3.E13.m1.1.1.3.2.3.4.cmml">a</mi></mrow></msub><mo id="S3.E13.m1.1.1.3.1" xref="S3.E13.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E13.m1.1.1.3.3" xref="S3.E13.m1.1.1.3.3.cmml"><mi id="S3.E13.m1.1.1.3.3.2" xref="S3.E13.m1.1.1.3.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.3.3.1" xref="S3.E13.m1.1.1.3.3.1.cmml">​</mo><msub id="S3.E13.m1.1.1.3.3.3" xref="S3.E13.m1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.1.1.3.3.3.2" xref="S3.E13.m1.1.1.3.3.3.2.cmml">ℒ</mi><mrow id="S3.E13.m1.1.1.3.3.3.3" xref="S3.E13.m1.1.1.3.3.3.3.cmml"><mi id="S3.E13.m1.1.1.3.3.3.3.2" xref="S3.E13.m1.1.1.3.3.3.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.3.3.3.3.1" xref="S3.E13.m1.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.E13.m1.1.1.3.3.3.3.3" xref="S3.E13.m1.1.1.3.3.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.3.3.3.3.1a" xref="S3.E13.m1.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.E13.m1.1.1.3.3.3.3.4" xref="S3.E13.m1.1.1.3.3.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.3.3.3.3.1b" xref="S3.E13.m1.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.E13.m1.1.1.3.3.3.3.5" xref="S3.E13.m1.1.1.3.3.3.3.5.cmml">d</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.1b"><apply id="S3.E13.m1.1.1.cmml" xref="S3.E13.m1.1.1"><eq id="S3.E13.m1.1.1.1.cmml" xref="S3.E13.m1.1.1.1"></eq><ci id="S3.E13.m1.1.1.2.cmml" xref="S3.E13.m1.1.1.2">ℒ</ci><apply id="S3.E13.m1.1.1.3.cmml" xref="S3.E13.m1.1.1.3"><plus id="S3.E13.m1.1.1.3.1.cmml" xref="S3.E13.m1.1.1.3.1"></plus><apply id="S3.E13.m1.1.1.3.2.cmml" xref="S3.E13.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.3.2.1.cmml" xref="S3.E13.m1.1.1.3.2">subscript</csymbol><ci id="S3.E13.m1.1.1.3.2.2.cmml" xref="S3.E13.m1.1.1.3.2.2">ℒ</ci><apply id="S3.E13.m1.1.1.3.2.3.cmml" xref="S3.E13.m1.1.1.3.2.3"><times id="S3.E13.m1.1.1.3.2.3.1.cmml" xref="S3.E13.m1.1.1.3.2.3.1"></times><ci id="S3.E13.m1.1.1.3.2.3.2.cmml" xref="S3.E13.m1.1.1.3.2.3.2">𝑣</ci><ci id="S3.E13.m1.1.1.3.2.3.3.cmml" xref="S3.E13.m1.1.1.3.2.3.3">𝑞</ci><ci id="S3.E13.m1.1.1.3.2.3.4.cmml" xref="S3.E13.m1.1.1.3.2.3.4">𝑎</ci></apply></apply><apply id="S3.E13.m1.1.1.3.3.cmml" xref="S3.E13.m1.1.1.3.3"><times id="S3.E13.m1.1.1.3.3.1.cmml" xref="S3.E13.m1.1.1.3.3.1"></times><ci id="S3.E13.m1.1.1.3.3.2.cmml" xref="S3.E13.m1.1.1.3.3.2">𝜆</ci><apply id="S3.E13.m1.1.1.3.3.3.cmml" xref="S3.E13.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.3.3.3.1.cmml" xref="S3.E13.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.E13.m1.1.1.3.3.3.2.cmml" xref="S3.E13.m1.1.1.3.3.3.2">ℒ</ci><apply id="S3.E13.m1.1.1.3.3.3.3.cmml" xref="S3.E13.m1.1.1.3.3.3.3"><times id="S3.E13.m1.1.1.3.3.3.3.1.cmml" xref="S3.E13.m1.1.1.3.3.3.3.1"></times><ci id="S3.E13.m1.1.1.3.3.3.3.2.cmml" xref="S3.E13.m1.1.1.3.3.3.3.2">𝑙</ci><ci id="S3.E13.m1.1.1.3.3.3.3.3.cmml" xref="S3.E13.m1.1.1.3.3.3.3.3">𝑜</ci><ci id="S3.E13.m1.1.1.3.3.3.3.4.cmml" xref="S3.E13.m1.1.1.3.3.3.3.4">𝑎</ci><ci id="S3.E13.m1.1.1.3.3.3.3.5.cmml" xref="S3.E13.m1.1.1.3.3.3.3.5">𝑑</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.1c">\mathcal{L}=\mathcal{L}_{vqa}+\lambda\mathcal{L}_{load}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p id="S3.SS5.p2.2" class="ltx_p">where <math id="S3.SS5.p2.2.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS5.p2.2.m1.1a"><mi id="S3.SS5.p2.2.m1.1.1" xref="S3.SS5.p2.2.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.2.m1.1b"><ci id="S3.SS5.p2.2.m1.1.1.cmml" xref="S3.SS5.p2.2.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.2.m1.1c">\lambda</annotation></semantics></math> is the coefficient of the load-balancing loss.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>EXPERIMENTS</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Datasets</h3>

<figure id="S4.T1" class="ltx_table">
<table id="S4.T1.4" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T1.4.5" class="ltx_tr">
<td id="S4.T1.4.5.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt">Model</td>
<td id="S4.T1.4.5.2" class="ltx_td ltx_align_center ltx_border_tt">
<table id="S4.T1.4.5.2.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T1.4.5.2.1.1" class="ltx_tr">
<td id="S4.T1.4.5.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">CLEVR</td>
</tr>
<tr id="S4.T1.4.5.2.1.2" class="ltx_tr">
<td id="S4.T1.4.5.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Overall</td>
</tr>
</table>
</td>
<td id="S4.T1.4.5.3" class="ltx_td ltx_align_center ltx_border_tt">Count</td>
<td id="S4.T1.4.5.4" class="ltx_td ltx_align_center ltx_border_tt">Exist</td>
<td id="S4.T1.4.5.5" class="ltx_td ltx_align_center ltx_border_tt">
<table id="S4.T1.4.5.5.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T1.4.5.5.1.1" class="ltx_tr">
<td id="S4.T1.4.5.5.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Compare</td>
</tr>
<tr id="S4.T1.4.5.5.1.2" class="ltx_tr">
<td id="S4.T1.4.5.5.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Numbers</td>
</tr>
</table>
</td>
<td id="S4.T1.4.5.6" class="ltx_td ltx_align_center ltx_border_tt">
<table id="S4.T1.4.5.6.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T1.4.5.6.1.1" class="ltx_tr">
<td id="S4.T1.4.5.6.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Query</td>
</tr>
<tr id="S4.T1.4.5.6.1.2" class="ltx_tr">
<td id="S4.T1.4.5.6.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Attribute</td>
</tr>
</table>
</td>
<td id="S4.T1.4.5.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">
<table id="S4.T1.4.5.7.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T1.4.5.7.1.1" class="ltx_tr">
<td id="S4.T1.4.5.7.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Compare</td>
</tr>
<tr id="S4.T1.4.5.7.1.2" class="ltx_tr">
<td id="S4.T1.4.5.7.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Attribute</td>
</tr>
</table>
</td>
<td id="S4.T1.4.5.8" class="ltx_td ltx_align_center ltx_border_tt">
<table id="S4.T1.4.5.8.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T1.4.5.8.1.1" class="ltx_tr">
<td id="S4.T1.4.5.8.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Humans</td>
</tr>
<tr id="S4.T1.4.5.8.1.2" class="ltx_tr">
<td id="S4.T1.4.5.8.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">After FT</td>
</tr>
</table>
</td>
</tr>
<tr id="S4.T1.4.6" class="ltx_tr">
<td id="S4.T1.4.6.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Human (<span id="S4.T1.4.6.1.1" class="ltx_text ltx_font_bold">?</span>)</td>
<td id="S4.T1.4.6.2" class="ltx_td ltx_align_center ltx_border_t">92.6</td>
<td id="S4.T1.4.6.3" class="ltx_td ltx_align_center ltx_border_t">86.7</td>
<td id="S4.T1.4.6.4" class="ltx_td ltx_align_center ltx_border_t">96.6</td>
<td id="S4.T1.4.6.5" class="ltx_td ltx_align_center ltx_border_t">86.5</td>
<td id="S4.T1.4.6.6" class="ltx_td ltx_align_center ltx_border_t">95.0</td>
<td id="S4.T1.4.6.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">96.0</td>
<td id="S4.T1.4.6.8" class="ltx_td ltx_align_center ltx_border_t">–</td>
</tr>
<tr id="S4.T1.4.7" class="ltx_tr">
<td id="S4.T1.4.7.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">N2NMN* (<span id="S4.T1.4.7.1.1" class="ltx_text ltx_font_bold">?</span>)</td>
<td id="S4.T1.4.7.2" class="ltx_td ltx_align_center ltx_border_t">83.7</td>
<td id="S4.T1.4.7.3" class="ltx_td ltx_align_center ltx_border_t">68.5</td>
<td id="S4.T1.4.7.4" class="ltx_td ltx_align_center ltx_border_t">85.7</td>
<td id="S4.T1.4.7.5" class="ltx_td ltx_align_center ltx_border_t">84.9</td>
<td id="S4.T1.4.7.6" class="ltx_td ltx_align_center ltx_border_t">90.0</td>
<td id="S4.T1.4.7.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">88.7</td>
<td id="S4.T1.4.7.8" class="ltx_td ltx_align_center ltx_border_t">–</td>
</tr>
<tr id="S4.T1.4.8" class="ltx_tr">
<td id="S4.T1.4.8.1" class="ltx_td ltx_align_left ltx_border_r">PG+EE (18K prog.)* (<span id="S4.T1.4.8.1.1" class="ltx_text ltx_font_bold">?</span>)</td>
<td id="S4.T1.4.8.2" class="ltx_td ltx_align_center">95.4</td>
<td id="S4.T1.4.8.3" class="ltx_td ltx_align_center">90.1</td>
<td id="S4.T1.4.8.4" class="ltx_td ltx_align_center">97.3</td>
<td id="S4.T1.4.8.5" class="ltx_td ltx_align_center">96.5</td>
<td id="S4.T1.4.8.6" class="ltx_td ltx_align_center">97.4</td>
<td id="S4.T1.4.8.7" class="ltx_td ltx_align_center ltx_border_r">98.0</td>
<td id="S4.T1.4.8.8" class="ltx_td ltx_align_center">66.6</td>
</tr>
<tr id="S4.T1.4.9" class="ltx_tr">
<td id="S4.T1.4.9.1" class="ltx_td ltx_align_left ltx_border_r">PG+EE (700K prog.)* (<span id="S4.T1.4.9.1.1" class="ltx_text ltx_font_bold">?</span>)</td>
<td id="S4.T1.4.9.2" class="ltx_td ltx_align_center">96.9</td>
<td id="S4.T1.4.9.3" class="ltx_td ltx_align_center">92.7</td>
<td id="S4.T1.4.9.4" class="ltx_td ltx_align_center">97.1</td>
<td id="S4.T1.4.9.5" class="ltx_td ltx_align_center">98.7</td>
<td id="S4.T1.4.9.6" class="ltx_td ltx_align_center">98.1</td>
<td id="S4.T1.4.9.7" class="ltx_td ltx_align_center ltx_border_r">98.9</td>
<td id="S4.T1.4.9.8" class="ltx_td ltx_align_center">–</td>
</tr>
<tr id="S4.T1.4.10" class="ltx_tr">
<td id="S4.T1.4.10.1" class="ltx_td ltx_align_left ltx_border_r">TbD* (<span id="S4.T1.4.10.1.1" class="ltx_text ltx_font_bold">?</span>)</td>
<td id="S4.T1.4.10.2" class="ltx_td ltx_align_center">99.1</td>
<td id="S4.T1.4.10.3" class="ltx_td ltx_align_center">97.6</td>
<td id="S4.T1.4.10.4" class="ltx_td ltx_align_center">99.2</td>
<td id="S4.T1.4.10.5" class="ltx_td ltx_align_center">99.4</td>
<td id="S4.T1.4.10.6" class="ltx_td ltx_align_center">99.5</td>
<td id="S4.T1.4.10.7" class="ltx_td ltx_align_center ltx_border_r">99.6</td>
<td id="S4.T1.4.10.8" class="ltx_td ltx_align_center">–</td>
</tr>
<tr id="S4.T1.4.11" class="ltx_tr">
<td id="S4.T1.4.11.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">LSTM (<span id="S4.T1.4.11.1.1" class="ltx_text ltx_font_bold">?</span>)</td>
<td id="S4.T1.4.11.2" class="ltx_td ltx_align_center ltx_border_t">46.8</td>
<td id="S4.T1.4.11.3" class="ltx_td ltx_align_center ltx_border_t">41.7</td>
<td id="S4.T1.4.11.4" class="ltx_td ltx_align_center ltx_border_t">61.1</td>
<td id="S4.T1.4.11.5" class="ltx_td ltx_align_center ltx_border_t">69.8</td>
<td id="S4.T1.4.11.6" class="ltx_td ltx_align_center ltx_border_t">36.8</td>
<td id="S4.T1.4.11.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">51.8</td>
<td id="S4.T1.4.11.8" class="ltx_td ltx_align_center ltx_border_t">36.5</td>
</tr>
<tr id="S4.T1.4.12" class="ltx_tr">
<td id="S4.T1.4.12.1" class="ltx_td ltx_align_left ltx_border_r">CNN+LSTM (<span id="S4.T1.4.12.1.1" class="ltx_text ltx_font_bold">?</span>)</td>
<td id="S4.T1.4.12.2" class="ltx_td ltx_align_center">52.3</td>
<td id="S4.T1.4.12.3" class="ltx_td ltx_align_center">43.7</td>
<td id="S4.T1.4.12.4" class="ltx_td ltx_align_center">65.2</td>
<td id="S4.T1.4.12.5" class="ltx_td ltx_align_center">67.1</td>
<td id="S4.T1.4.12.6" class="ltx_td ltx_align_center">49.3</td>
<td id="S4.T1.4.12.7" class="ltx_td ltx_align_center ltx_border_r">53.0</td>
<td id="S4.T1.4.12.8" class="ltx_td ltx_align_center">43.2</td>
</tr>
<tr id="S4.T1.4.13" class="ltx_tr">
<td id="S4.T1.4.13.1" class="ltx_td ltx_align_left ltx_border_r">CNN+LSTM+SA (<span id="S4.T1.4.13.1.1" class="ltx_text ltx_font_bold">?</span>)</td>
<td id="S4.T1.4.13.2" class="ltx_td ltx_align_center">76.6</td>
<td id="S4.T1.4.13.3" class="ltx_td ltx_align_center">64.4</td>
<td id="S4.T1.4.13.4" class="ltx_td ltx_align_center">82.7</td>
<td id="S4.T1.4.13.5" class="ltx_td ltx_align_center">77.4</td>
<td id="S4.T1.4.13.6" class="ltx_td ltx_align_center">82.6</td>
<td id="S4.T1.4.13.7" class="ltx_td ltx_align_center ltx_border_r">75.4</td>
<td id="S4.T1.4.13.8" class="ltx_td ltx_align_center">57.6</td>
</tr>
<tr id="S4.T1.4.14" class="ltx_tr">
<td id="S4.T1.4.14.1" class="ltx_td ltx_align_left ltx_border_r">FiLM (<span id="S4.T1.4.14.1.1" class="ltx_text ltx_font_bold">?</span>)</td>
<td id="S4.T1.4.14.2" class="ltx_td ltx_align_center">97.6</td>
<td id="S4.T1.4.14.3" class="ltx_td ltx_align_center">94.3</td>
<td id="S4.T1.4.14.4" class="ltx_td ltx_align_center">99.3</td>
<td id="S4.T1.4.14.5" class="ltx_td ltx_align_center">93.4</td>
<td id="S4.T1.4.14.6" class="ltx_td ltx_align_center">99.3</td>
<td id="S4.T1.4.14.7" class="ltx_td ltx_align_center ltx_border_r">99.3</td>
<td id="S4.T1.4.14.8" class="ltx_td ltx_align_center">75.9</td>
</tr>
<tr id="S4.T1.4.15" class="ltx_tr">
<td id="S4.T1.4.15.1" class="ltx_td ltx_align_left ltx_border_r">QGHC (<span id="S4.T1.4.15.1.1" class="ltx_text ltx_font_bold">?</span>)</td>
<td id="S4.T1.4.15.2" class="ltx_td ltx_align_center">86.3</td>
<td id="S4.T1.4.15.3" class="ltx_td ltx_align_center">78.1</td>
<td id="S4.T1.4.15.4" class="ltx_td ltx_align_center">91.7</td>
<td id="S4.T1.4.15.5" class="ltx_td ltx_align_center">80.7</td>
<td id="S4.T1.4.15.6" class="ltx_td ltx_align_center">89.4</td>
<td id="S4.T1.4.15.7" class="ltx_td ltx_align_center ltx_border_r">86.8</td>
<td id="S4.T1.4.15.8" class="ltx_td ltx_align_center">–</td>
</tr>
<tr id="S4.T1.4.16" class="ltx_tr">
<td id="S4.T1.4.16.1" class="ltx_td ltx_align_left ltx_border_r">Relation Network (<span id="S4.T1.4.16.1.1" class="ltx_text ltx_font_bold">?</span>)</td>
<td id="S4.T1.4.16.2" class="ltx_td ltx_align_center">95.5</td>
<td id="S4.T1.4.16.3" class="ltx_td ltx_align_center">90.1</td>
<td id="S4.T1.4.16.4" class="ltx_td ltx_align_center">97.8</td>
<td id="S4.T1.4.16.5" class="ltx_td ltx_align_center">93.6</td>
<td id="S4.T1.4.16.6" class="ltx_td ltx_align_center">97.9</td>
<td id="S4.T1.4.16.7" class="ltx_td ltx_align_center ltx_border_r">97.1</td>
<td id="S4.T1.4.16.8" class="ltx_td ltx_align_center">–</td>
</tr>
<tr id="S4.T1.4.17" class="ltx_tr">
<td id="S4.T1.4.17.1" class="ltx_td ltx_align_left ltx_border_r">MAC (<span id="S4.T1.4.17.1.1" class="ltx_text ltx_font_bold">?</span>)</td>
<td id="S4.T1.4.17.2" class="ltx_td ltx_align_center" style="background-color:#C4C7FD;"><span id="S4.T1.4.17.2.1" class="ltx_text" style="background-color:#C4C7FD;">98.9</span></td>
<td id="S4.T1.4.17.3" class="ltx_td ltx_align_center">97.2</td>
<td id="S4.T1.4.17.4" class="ltx_td ltx_align_center">99.5</td>
<td id="S4.T1.4.17.5" class="ltx_td ltx_align_center" style="background-color:#C4C7FD;"><span id="S4.T1.4.17.5.1" class="ltx_text" style="background-color:#C4C7FD;">99.4</span></td>
<td id="S4.T1.4.17.6" class="ltx_td ltx_align_center">99.3</td>
<td id="S4.T1.4.17.7" class="ltx_td ltx_align_center ltx_border_r">99.5</td>
<td id="S4.T1.4.17.8" class="ltx_td ltx_align_center" style="background-color:#EBECFF;"><span id="S4.T1.4.17.8.1" class="ltx_text" style="background-color:#EBECFF;">81.5</span></td>
</tr>
<tr id="S4.T1.4.18" class="ltx_tr">
<td id="S4.T1.4.18.1" class="ltx_td ltx_align_left ltx_border_r">NS-CL (<span id="S4.T1.4.18.1.1" class="ltx_text ltx_font_bold">?</span>)</td>
<td id="S4.T1.4.18.2" class="ltx_td ltx_align_center" style="background-color:#C4C7FD;"><span id="S4.T1.4.18.2.1" class="ltx_text" style="background-color:#C4C7FD;">98.9</span></td>
<td id="S4.T1.4.18.3" class="ltx_td ltx_align_center" style="background-color:#C4C7FD;"><span id="S4.T1.4.18.3.1" class="ltx_text" style="background-color:#C4C7FD;">98.2</span></td>
<td id="S4.T1.4.18.4" class="ltx_td ltx_align_center">98.9</td>
<td id="S4.T1.4.18.5" class="ltx_td ltx_align_center" style="background-color:#EBECFF;"><span id="S4.T1.4.18.5.1" class="ltx_text" style="background-color:#EBECFF;">99.0</span></td>
<td id="S4.T1.4.18.6" class="ltx_td ltx_align_center">99.3</td>
<td id="S4.T1.4.18.7" class="ltx_td ltx_align_center ltx_border_r">99.1</td>
<td id="S4.T1.4.18.8" class="ltx_td ltx_align_center">–</td>
</tr>
<tr id="S4.T1.1.1" class="ltx_tr">
<td id="S4.T1.1.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">BRN (c<math id="S4.T1.1.1.1.m1.1" class="ltx_Math" alttext="=" display="inline"><semantics id="S4.T1.1.1.1.m1.1a"><mo id="S4.T1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.m1.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.m1.1b"><eq id="S4.T1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">=</annotation></semantics></math>8) (ours)</td>
<td id="S4.T1.1.1.2" class="ltx_td ltx_align_center ltx_border_t">86.8</td>
<td id="S4.T1.1.1.3" class="ltx_td ltx_align_center ltx_border_t">79.5</td>
<td id="S4.T1.1.1.4" class="ltx_td ltx_align_center ltx_border_t">93.4</td>
<td id="S4.T1.1.1.5" class="ltx_td ltx_align_center ltx_border_t">75.1</td>
<td id="S4.T1.1.1.6" class="ltx_td ltx_align_center ltx_border_t">90.0</td>
<td id="S4.T1.1.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">91.1</td>
<td id="S4.T1.1.1.8" class="ltx_td ltx_align_center ltx_border_t">–</td>
</tr>
<tr id="S4.T1.2.2" class="ltx_tr">
<td id="S4.T1.2.2.1" class="ltx_td ltx_align_left ltx_border_r">BRN (c<math id="S4.T1.2.2.1.m1.1" class="ltx_Math" alttext="=" display="inline"><semantics id="S4.T1.2.2.1.m1.1a"><mo id="S4.T1.2.2.1.m1.1.1" xref="S4.T1.2.2.1.m1.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.1.m1.1b"><eq id="S4.T1.2.2.1.m1.1.1.cmml" xref="S4.T1.2.2.1.m1.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.1.m1.1c">=</annotation></semantics></math>16) (ours)</td>
<td id="S4.T1.2.2.2" class="ltx_td ltx_align_center">94.7</td>
<td id="S4.T1.2.2.3" class="ltx_td ltx_align_center">90.8</td>
<td id="S4.T1.2.2.4" class="ltx_td ltx_align_center">98.1</td>
<td id="S4.T1.2.2.5" class="ltx_td ltx_align_center">82.8</td>
<td id="S4.T1.2.2.6" class="ltx_td ltx_align_center">97.3</td>
<td id="S4.T1.2.2.7" class="ltx_td ltx_align_center ltx_border_r">98.4</td>
<td id="S4.T1.2.2.8" class="ltx_td ltx_align_center">–</td>
</tr>
<tr id="S4.T1.3.3" class="ltx_tr">
<td id="S4.T1.3.3.1" class="ltx_td ltx_align_left ltx_border_r">BRN (c<math id="S4.T1.3.3.1.m1.1" class="ltx_Math" alttext="=" display="inline"><semantics id="S4.T1.3.3.1.m1.1a"><mo id="S4.T1.3.3.1.m1.1.1" xref="S4.T1.3.3.1.m1.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.1.m1.1b"><eq id="S4.T1.3.3.1.m1.1.1.cmml" xref="S4.T1.3.3.1.m1.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.1.m1.1c">=</annotation></semantics></math>32) (ours)</td>
<td id="S4.T1.3.3.2" class="ltx_td ltx_align_center">97.9</td>
<td id="S4.T1.3.3.3" class="ltx_td ltx_align_center">95.4</td>
<td id="S4.T1.3.3.4" class="ltx_td ltx_align_center">98.9</td>
<td id="S4.T1.3.3.5" class="ltx_td ltx_align_center">92.9</td>
<td id="S4.T1.3.3.6" class="ltx_td ltx_align_center">99.4</td>
<td id="S4.T1.3.3.7" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#EBECFF;"><span id="S4.T1.3.3.7.1" class="ltx_text" style="background-color:#EBECFF;">99.7</span></td>
<td id="S4.T1.3.3.8" class="ltx_td ltx_align_center">77.9</td>
</tr>
<tr id="S4.T1.4.4" class="ltx_tr">
<td id="S4.T1.4.4.1" class="ltx_td ltx_align_left ltx_border_r">BRN (c<math id="S4.T1.4.4.1.m1.1" class="ltx_Math" alttext="=" display="inline"><semantics id="S4.T1.4.4.1.m1.1a"><mo id="S4.T1.4.4.1.m1.1.1" xref="S4.T1.4.4.1.m1.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.1.m1.1b"><eq id="S4.T1.4.4.1.m1.1.1.cmml" xref="S4.T1.4.4.1.m1.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.1.m1.1c">=</annotation></semantics></math>32)+Attention (ours)</td>
<td id="S4.T1.4.4.2" class="ltx_td ltx_align_center" style="background-color:#EBECFF;"><span id="S4.T1.4.4.2.1" class="ltx_text" style="background-color:#EBECFF;">98.7</span></td>
<td id="S4.T1.4.4.3" class="ltx_td ltx_align_center">97.4</td>
<td id="S4.T1.4.4.4" class="ltx_td ltx_align_center" style="background-color:#EBECFF;"><span id="S4.T1.4.4.4.1" class="ltx_text" style="background-color:#EBECFF;">99.6</span></td>
<td id="S4.T1.4.4.5" class="ltx_td ltx_align_center">95.1</td>
<td id="S4.T1.4.4.6" class="ltx_td ltx_align_center" style="background-color:#EBECFF;"><span id="S4.T1.4.4.6.1" class="ltx_text" style="background-color:#EBECFF;">99.7</span></td>
<td id="S4.T1.4.4.7" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#EBECFF;"><span id="S4.T1.4.4.7.1" class="ltx_text" style="background-color:#EBECFF;">99.7</span></td>
<td id="S4.T1.4.4.8" class="ltx_td ltx_align_center">79.3</td>
</tr>
<tr id="S4.T1.4.19" class="ltx_tr">
<td id="S4.T1.4.19.1" class="ltx_td ltx_align_left ltx_border_r">FRN (ours)</td>
<td id="S4.T1.4.19.2" class="ltx_td ltx_align_center">98.2</td>
<td id="S4.T1.4.19.3" class="ltx_td ltx_align_center">96.6</td>
<td id="S4.T1.4.19.4" class="ltx_td ltx_align_center" style="background-color:#C4C7FD;"><span id="S4.T1.4.19.4.1" class="ltx_text" style="background-color:#C4C7FD;">99.9</span></td>
<td id="S4.T1.4.19.5" class="ltx_td ltx_align_center">94.1</td>
<td id="S4.T1.4.19.6" class="ltx_td ltx_align_center">98.7</td>
<td id="S4.T1.4.19.7" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#C4C7FD;"><span id="S4.T1.4.19.7.1" class="ltx_text" style="background-color:#C4C7FD;">99.9</span></td>
<td id="S4.T1.4.19.8" class="ltx_td ltx_align_center">79.9</td>
</tr>
<tr id="S4.T1.4.20" class="ltx_tr">
<td id="S4.T1.4.20.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r">FRN+Attention (ours)</td>
<td id="S4.T1.4.20.2" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C4C7FD;"><span id="S4.T1.4.20.2.1" class="ltx_text" style="background-color:#C4C7FD;">98.9</span></td>
<td id="S4.T1.4.20.3" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#EBECFF;"><span id="S4.T1.4.20.3.1" class="ltx_text" style="background-color:#EBECFF;">97.7</span></td>
<td id="S4.T1.4.20.4" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C4C7FD;"><span id="S4.T1.4.20.4.1" class="ltx_text" style="background-color:#C4C7FD;">99.9</span></td>
<td id="S4.T1.4.20.5" class="ltx_td ltx_align_center ltx_border_bb">94.5</td>
<td id="S4.T1.4.20.6" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C4C7FD;"><span id="S4.T1.4.20.6.1" class="ltx_text" style="background-color:#C4C7FD;">99.8</span></td>
<td id="S4.T1.4.20.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="background-color:#C4C7FD;"><span id="S4.T1.4.20.7.1" class="ltx_text" style="background-color:#C4C7FD;">99.9</span></td>
<td id="S4.T1.4.20.8" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#C4C7FD;"><span id="S4.T1.4.20.8.1" class="ltx_text" style="background-color:#C4C7FD;">81.8</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Comparison of accuracy on CLEVR and CLEVR-Humans datasets with previous methods. (*) denotes use of extra supervisory information through program labels. And c is the abbreviation for cardinality, and represents the number of modules per modular layer. The highest and second highest accuracies are shown in different background colors. However, we did not highlight TbD since it uses the extra supervisory information.</figcaption>
</figure>
<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">The proposed method is evaluated on two datasets: (1) CLEVR dataset (<span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_bold">?</span>) is proposed to study the ability of VQA systems to perform reasoning. Answering question about a CLEVR image requires various kinds of reasoning, which makes the standard VQA methods perform poorly on this dataset. The dataset contains 100K 3D-rendered images and about one million automatically-generated questions. Specifically, the question in the dataset can be divided into the following five types: <span id="S4.SS1.p1.1.2" class="ltx_text ltx_font_typewriter">Count</span>: ask the number of certain objects; <span id="S4.SS1.p1.1.3" class="ltx_text ltx_font_typewriter">Exist</span>: ask whether a certain object is present; <span id="S4.SS1.p1.1.4" class="ltx_text ltx_font_typewriter">Compare Numbers</span>: ask which of two object sets is larger; <span id="S4.SS1.p1.1.5" class="ltx_text ltx_font_typewriter">Query Attribute</span>: query a attribute of particular object; <span id="S4.SS1.p1.1.6" class="ltx_text ltx_font_typewriter">Compare Attribute</span>: ask whether two particular objects have same value on some attribute. (2) CLEVR-Humans dataset (<span id="S4.SS1.p1.1.7" class="ltx_text ltx_font_bold">?</span>) contains human-posed questions on CLEVR images, which makes the dataset more complex and realistic.
We train all of our models with the official training set and test the models on the official validation set, and we train our models from raw pixels.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Implementation details</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.6" class="ltx_p"><span id="S4.SS2.p1.6.1" class="ltx_text ltx_font_bold">Configuration of BRN and FRN:</span> BRN has <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="8" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mn id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><cn type="integer" id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">8</annotation></semantics></math> modular routing layers, and each layer has <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="8/16/32" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mrow id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mn id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">8</mn><mo id="S4.SS2.p1.2.m2.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.cmml">/</mo><mn id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml">16</mn><mo id="S4.SS2.p1.2.m2.1.1.1a" xref="S4.SS2.p1.2.m2.1.1.1.cmml">/</mo><mn id="S4.SS2.p1.2.m2.1.1.4" xref="S4.SS2.p1.2.m2.1.1.4.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><divide id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1"></divide><cn type="integer" id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">8</cn><cn type="integer" id="S4.SS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3">16</cn><cn type="integer" id="S4.SS2.p1.2.m2.1.1.4.cmml" xref="S4.SS2.p1.2.m2.1.1.4">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">8/16/32</annotation></semantics></math> modules. In the terminology of the ResNext paper, the cardinality is <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="8/16/32" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mn id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">8</mn><mo id="S4.SS2.p1.3.m3.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.cmml">/</mo><mn id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml">16</mn><mo id="S4.SS2.p1.3.m3.1.1.1a" xref="S4.SS2.p1.3.m3.1.1.1.cmml">/</mo><mn id="S4.SS2.p1.3.m3.1.1.4" xref="S4.SS2.p1.3.m3.1.1.4.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><divide id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1"></divide><cn type="integer" id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2">8</cn><cn type="integer" id="S4.SS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3">16</cn><cn type="integer" id="S4.SS2.p1.3.m3.1.1.4.cmml" xref="S4.SS2.p1.3.m3.1.1.4">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">8/16/32</annotation></semantics></math> and the depth is <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="26=3\times 8+2" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><mrow id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml"><mn id="S4.SS2.p1.4.m4.1.1.2" xref="S4.SS2.p1.4.m4.1.1.2.cmml">26</mn><mo id="S4.SS2.p1.4.m4.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.cmml">=</mo><mrow id="S4.SS2.p1.4.m4.1.1.3" xref="S4.SS2.p1.4.m4.1.1.3.cmml"><mrow id="S4.SS2.p1.4.m4.1.1.3.2" xref="S4.SS2.p1.4.m4.1.1.3.2.cmml"><mn id="S4.SS2.p1.4.m4.1.1.3.2.2" xref="S4.SS2.p1.4.m4.1.1.3.2.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p1.4.m4.1.1.3.2.1" xref="S4.SS2.p1.4.m4.1.1.3.2.1.cmml">×</mo><mn id="S4.SS2.p1.4.m4.1.1.3.2.3" xref="S4.SS2.p1.4.m4.1.1.3.2.3.cmml">8</mn></mrow><mo id="S4.SS2.p1.4.m4.1.1.3.1" xref="S4.SS2.p1.4.m4.1.1.3.1.cmml">+</mo><mn id="S4.SS2.p1.4.m4.1.1.3.3" xref="S4.SS2.p1.4.m4.1.1.3.3.cmml">2</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1"><eq id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1"></eq><cn type="integer" id="S4.SS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2">26</cn><apply id="S4.SS2.p1.4.m4.1.1.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3"><plus id="S4.SS2.p1.4.m4.1.1.3.1.cmml" xref="S4.SS2.p1.4.m4.1.1.3.1"></plus><apply id="S4.SS2.p1.4.m4.1.1.3.2.cmml" xref="S4.SS2.p1.4.m4.1.1.3.2"><times id="S4.SS2.p1.4.m4.1.1.3.2.1.cmml" xref="S4.SS2.p1.4.m4.1.1.3.2.1"></times><cn type="integer" id="S4.SS2.p1.4.m4.1.1.3.2.2.cmml" xref="S4.SS2.p1.4.m4.1.1.3.2.2">3</cn><cn type="integer" id="S4.SS2.p1.4.m4.1.1.3.2.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3.2.3">8</cn></apply><cn type="integer" id="S4.SS2.p1.4.m4.1.1.3.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">26=3\times 8+2</annotation></semantics></math>. It is notable that we replace the <math id="S4.SS2.p1.5.m5.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S4.SS2.p1.5.m5.1a"><mn id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><cn type="integer" id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">3</annotation></semantics></math>rd batch normalization (bn) of the bottleneck block with group normalization (gn). Although most studies have shown that gn does not perform as well as bn when the batch size is large enough, and it is rarely seen that gn is applied to the ResNext model. But for BRN, the combination of gn and ResNext will greatly improve the performance of the model. We regard this as an interesting discovery, and we provide a possible explanation in the ablation study. FRN is based on ResNet34, that is, each modular layer is a <span id="S4.SS2.p1.6.2" class="ltx_text ltx_font_italic">basicblock</span> and has <math id="S4.SS2.p1.6.m6.1" class="ltx_Math" alttext="16" display="inline"><semantics id="S4.SS2.p1.6.m6.1a"><mn id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><cn type="integer" id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">16</annotation></semantics></math> modular layers in total, the number of modules for each layer depends on the second convolutional layer’s filter number.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.p2.7" class="ltx_p"><span id="S4.SS2.p2.7.1" class="ltx_text ltx_font_bold">Visual Network:</span> all images are resized to <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="480\times 360" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mn id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">480</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.1.m1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">360</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><times id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1"></times><cn type="integer" id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">480</cn><cn type="integer" id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">360</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">480\times 360</annotation></semantics></math> and we found that whether the image size is <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="480\times 360" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mrow id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mn id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">480</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.2.m2.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.cmml">×</mo><mn id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml">360</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><times id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1"></times><cn type="integer" id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">480</cn><cn type="integer" id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3">360</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">480\times 360</annotation></semantics></math> or <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="224\times 224" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mrow id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mn id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml">224</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.3.m3.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.cmml">×</mo><mn id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml">224</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><times id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1"></times><cn type="integer" id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2">224</cn><cn type="integer" id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3">224</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">224\times 224</annotation></semantics></math> has little effect on the performance of BRN, so BRN takes images of <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="224\times 224" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><mrow id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><mn id="S4.SS2.p2.4.m4.1.1.2" xref="S4.SS2.p2.4.m4.1.1.2.cmml">224</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.4.m4.1.1.1" xref="S4.SS2.p2.4.m4.1.1.1.cmml">×</mo><mn id="S4.SS2.p2.4.m4.1.1.3" xref="S4.SS2.p2.4.m4.1.1.3.cmml">224</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><times id="S4.SS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1.1"></times><cn type="integer" id="S4.SS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2">224</cn><cn type="integer" id="S4.SS2.p2.4.m4.1.1.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3">224</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">224\times 224</annotation></semantics></math> as input. We also found that sending the question features together with the visual features into the classifier will help the BRN training more stable. In order to achieve the best performance, we concatenate <math id="S4.SS2.p2.5.m5.1" class="ltx_Math" alttext="\tilde{y}_{L}" display="inline"><semantics id="S4.SS2.p2.5.m5.1a"><msub id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml"><mover accent="true" id="S4.SS2.p2.5.m5.1.1.2" xref="S4.SS2.p2.5.m5.1.1.2.cmml"><mi id="S4.SS2.p2.5.m5.1.1.2.2" xref="S4.SS2.p2.5.m5.1.1.2.2.cmml">y</mi><mo id="S4.SS2.p2.5.m5.1.1.2.1" xref="S4.SS2.p2.5.m5.1.1.2.1.cmml">~</mo></mover><mi id="S4.SS2.p2.5.m5.1.1.3" xref="S4.SS2.p2.5.m5.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><apply id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1">subscript</csymbol><apply id="S4.SS2.p2.5.m5.1.1.2.cmml" xref="S4.SS2.p2.5.m5.1.1.2"><ci id="S4.SS2.p2.5.m5.1.1.2.1.cmml" xref="S4.SS2.p2.5.m5.1.1.2.1">~</ci><ci id="S4.SS2.p2.5.m5.1.1.2.2.cmml" xref="S4.SS2.p2.5.m5.1.1.2.2">𝑦</ci></apply><ci id="S4.SS2.p2.5.m5.1.1.3.cmml" xref="S4.SS2.p2.5.m5.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">\tilde{y}_{L}</annotation></semantics></math> with two coordinate feature maps indicating relative <math id="S4.SS2.p2.6.m6.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S4.SS2.p2.6.m6.1a"><mi id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><ci id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">x</annotation></semantics></math> and <math id="S4.SS2.p2.7.m7.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S4.SS2.p2.7.m7.1a"><mi id="S4.SS2.p2.7.m7.1.1" xref="S4.SS2.p2.7.m7.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m7.1b"><ci id="S4.SS2.p2.7.m7.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m7.1c">y</annotation></semantics></math> spatial position.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para ltx_noindent">
<p id="S4.SS2.p3.4" class="ltx_p"><span id="S4.SS2.p3.4.1" class="ltx_text ltx_font_bold">Textual Network:</span> the word embedding size is set to <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="200" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><mn id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">200</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><cn type="integer" id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">200</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">200</annotation></semantics></math>, the GRU hidden size is set to <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="512" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><mn id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><cn type="integer" id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">512</annotation></semantics></math>, we observe that the hidden size set to <math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="512" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><mn id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><cn type="integer" id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">512</annotation></semantics></math> or <math id="S4.SS2.p3.4.m4.1" class="ltx_Math" alttext="1024" display="inline"><semantics id="S4.SS2.p3.4.m4.1a"><mn id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml">1024</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b"><cn type="integer" id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1">1024</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">1024</annotation></semantics></math> has little effect on the final accuracy. The parameters of the GRU and word embedding layer are initialized with orthogonal initialization and uniform initialization respectively.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para ltx_noindent">
<p id="S4.SS2.p4.7" class="ltx_p"><span id="S4.SS2.p4.7.1" class="ltx_text ltx_font_bold">Routing Network:</span> although the temperature <math id="S4.SS2.p4.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S4.SS2.p4.1.m1.1a"><mi id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><ci id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">\tau</annotation></semantics></math> can be annealed to a small value during training, we find that just keeping it a constant value <math id="S4.SS2.p4.2.m2.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="S4.SS2.p4.2.m2.1a"><mn id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><cn type="float" id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">1.0</annotation></semantics></math> can get decent accuracy. Note that we need the generation of routing path to be stochastic to exploit more possible routing paths during training, but during test phrase, we want the generation of routing path to be deterministic, so just use the sigmoid function with a threshold <math id="S4.SS2.p4.3.m3.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="S4.SS2.p4.3.m3.1a"><mn id="S4.SS2.p4.3.m3.1.1" xref="S4.SS2.p4.3.m3.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.1b"><cn type="float" id="S4.SS2.p4.3.m3.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">0.5</annotation></semantics></math> to convert the <math id="S4.SS2.p4.4.m4.1" class="ltx_Math" alttext="\tilde{P}" display="inline"><semantics id="S4.SS2.p4.4.m4.1a"><mover accent="true" id="S4.SS2.p4.4.m4.1.1" xref="S4.SS2.p4.4.m4.1.1.cmml"><mi id="S4.SS2.p4.4.m4.1.1.2" xref="S4.SS2.p4.4.m4.1.1.2.cmml">P</mi><mo id="S4.SS2.p4.4.m4.1.1.1" xref="S4.SS2.p4.4.m4.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.4.m4.1b"><apply id="S4.SS2.p4.4.m4.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1"><ci id="S4.SS2.p4.4.m4.1.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1.1">~</ci><ci id="S4.SS2.p4.4.m4.1.1.2.cmml" xref="S4.SS2.p4.4.m4.1.1.2">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.4.m4.1c">\tilde{P}</annotation></semantics></math> to <math id="S4.SS2.p4.5.m5.1" class="ltx_Math" alttext="P" display="inline"><semantics id="S4.SS2.p4.5.m5.1a"><mi id="S4.SS2.p4.5.m5.1.1" xref="S4.SS2.p4.5.m5.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.5.m5.1b"><ci id="S4.SS2.p4.5.m5.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.5.m5.1c">P</annotation></semantics></math>. We also initialize the parameters of the routing network so that the probability of each module being executed at the beginning is <math id="S4.SS2.p4.6.m6.1" class="ltx_Math" alttext="0.7" display="inline"><semantics id="S4.SS2.p4.6.m6.1a"><mn id="S4.SS2.p4.6.m6.1.1" xref="S4.SS2.p4.6.m6.1.1.cmml">0.7</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.6.m6.1b"><cn type="float" id="S4.SS2.p4.6.m6.1.1.cmml" xref="S4.SS2.p4.6.m6.1.1">0.7</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.6.m6.1c">0.7</annotation></semantics></math>, that is, the bias of the fc layer of routing network is initialized to <math id="S4.SS2.p4.7.m7.2" class="ltx_Math" alttext="\log(\frac{0.7}{1-0.7})" display="inline"><semantics id="S4.SS2.p4.7.m7.2a"><mrow id="S4.SS2.p4.7.m7.2.3.2" xref="S4.SS2.p4.7.m7.2.3.1.cmml"><mi id="S4.SS2.p4.7.m7.1.1" xref="S4.SS2.p4.7.m7.1.1.cmml">log</mi><mo id="S4.SS2.p4.7.m7.2.3.2a" xref="S4.SS2.p4.7.m7.2.3.1.cmml">⁡</mo><mrow id="S4.SS2.p4.7.m7.2.3.2.1" xref="S4.SS2.p4.7.m7.2.3.1.cmml"><mo stretchy="false" id="S4.SS2.p4.7.m7.2.3.2.1.1" xref="S4.SS2.p4.7.m7.2.3.1.cmml">(</mo><mfrac id="S4.SS2.p4.7.m7.2.2" xref="S4.SS2.p4.7.m7.2.2.cmml"><mn id="S4.SS2.p4.7.m7.2.2.2" xref="S4.SS2.p4.7.m7.2.2.2.cmml">0.7</mn><mrow id="S4.SS2.p4.7.m7.2.2.3" xref="S4.SS2.p4.7.m7.2.2.3.cmml"><mn id="S4.SS2.p4.7.m7.2.2.3.2" xref="S4.SS2.p4.7.m7.2.2.3.2.cmml">1</mn><mo id="S4.SS2.p4.7.m7.2.2.3.1" xref="S4.SS2.p4.7.m7.2.2.3.1.cmml">−</mo><mn id="S4.SS2.p4.7.m7.2.2.3.3" xref="S4.SS2.p4.7.m7.2.2.3.3.cmml">0.7</mn></mrow></mfrac><mo stretchy="false" id="S4.SS2.p4.7.m7.2.3.2.1.2" xref="S4.SS2.p4.7.m7.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.7.m7.2b"><apply id="S4.SS2.p4.7.m7.2.3.1.cmml" xref="S4.SS2.p4.7.m7.2.3.2"><log id="S4.SS2.p4.7.m7.1.1.cmml" xref="S4.SS2.p4.7.m7.1.1"></log><apply id="S4.SS2.p4.7.m7.2.2.cmml" xref="S4.SS2.p4.7.m7.2.2"><divide id="S4.SS2.p4.7.m7.2.2.1.cmml" xref="S4.SS2.p4.7.m7.2.2"></divide><cn type="float" id="S4.SS2.p4.7.m7.2.2.2.cmml" xref="S4.SS2.p4.7.m7.2.2.2">0.7</cn><apply id="S4.SS2.p4.7.m7.2.2.3.cmml" xref="S4.SS2.p4.7.m7.2.2.3"><minus id="S4.SS2.p4.7.m7.2.2.3.1.cmml" xref="S4.SS2.p4.7.m7.2.2.3.1"></minus><cn type="integer" id="S4.SS2.p4.7.m7.2.2.3.2.cmml" xref="S4.SS2.p4.7.m7.2.2.3.2">1</cn><cn type="float" id="S4.SS2.p4.7.m7.2.2.3.3.cmml" xref="S4.SS2.p4.7.m7.2.2.3.3">0.7</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.7.m7.2c">\log(\frac{0.7}{1-0.7})</annotation></semantics></math>.</p>
</div>
<div id="S4.SS2.p5" class="ltx_para ltx_noindent">
<p id="S4.SS2.p5.3" class="ltx_p"><span id="S4.SS2.p5.3.1" class="ltx_text ltx_font_bold">Training:</span> all the models are trained with ADAM(<span id="S4.SS2.p5.3.2" class="ltx_text ltx_font_bold">?</span>) optimizer, betas are set to <math id="S4.SS2.p5.1.m1.2" class="ltx_Math" alttext="(0.9,0.999)" display="inline"><semantics id="S4.SS2.p5.1.m1.2a"><mrow id="S4.SS2.p5.1.m1.2.3.2" xref="S4.SS2.p5.1.m1.2.3.1.cmml"><mo stretchy="false" id="S4.SS2.p5.1.m1.2.3.2.1" xref="S4.SS2.p5.1.m1.2.3.1.cmml">(</mo><mn id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1.cmml">0.9</mn><mo id="S4.SS2.p5.1.m1.2.3.2.2" xref="S4.SS2.p5.1.m1.2.3.1.cmml">,</mo><mn id="S4.SS2.p5.1.m1.2.2" xref="S4.SS2.p5.1.m1.2.2.cmml">0.999</mn><mo stretchy="false" id="S4.SS2.p5.1.m1.2.3.2.3" xref="S4.SS2.p5.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.2b"><interval closure="open" id="S4.SS2.p5.1.m1.2.3.1.cmml" xref="S4.SS2.p5.1.m1.2.3.2"><cn type="float" id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1">0.9</cn><cn type="float" id="S4.SS2.p5.1.m1.2.2.cmml" xref="S4.SS2.p5.1.m1.2.2">0.999</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.2c">(0.9,0.999)</annotation></semantics></math>, batchsize is set to 64, learning rate is set to <math id="S4.SS2.p5.2.m2.1" class="ltx_Math" alttext="3e-4" display="inline"><semantics id="S4.SS2.p5.2.m2.1a"><mrow id="S4.SS2.p5.2.m2.1.1" xref="S4.SS2.p5.2.m2.1.1.cmml"><mrow id="S4.SS2.p5.2.m2.1.1.2" xref="S4.SS2.p5.2.m2.1.1.2.cmml"><mn id="S4.SS2.p5.2.m2.1.1.2.2" xref="S4.SS2.p5.2.m2.1.1.2.2.cmml">3</mn><mo lspace="0em" rspace="0em" id="S4.SS2.p5.2.m2.1.1.2.1" xref="S4.SS2.p5.2.m2.1.1.2.1.cmml">​</mo><mi id="S4.SS2.p5.2.m2.1.1.2.3" xref="S4.SS2.p5.2.m2.1.1.2.3.cmml">e</mi></mrow><mo id="S4.SS2.p5.2.m2.1.1.1" xref="S4.SS2.p5.2.m2.1.1.1.cmml">−</mo><mn id="S4.SS2.p5.2.m2.1.1.3" xref="S4.SS2.p5.2.m2.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.2.m2.1b"><apply id="S4.SS2.p5.2.m2.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1"><minus id="S4.SS2.p5.2.m2.1.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1.1"></minus><apply id="S4.SS2.p5.2.m2.1.1.2.cmml" xref="S4.SS2.p5.2.m2.1.1.2"><times id="S4.SS2.p5.2.m2.1.1.2.1.cmml" xref="S4.SS2.p5.2.m2.1.1.2.1"></times><cn type="integer" id="S4.SS2.p5.2.m2.1.1.2.2.cmml" xref="S4.SS2.p5.2.m2.1.1.2.2">3</cn><ci id="S4.SS2.p5.2.m2.1.1.2.3.cmml" xref="S4.SS2.p5.2.m2.1.1.2.3">𝑒</ci></apply><cn type="integer" id="S4.SS2.p5.2.m2.1.1.3.cmml" xref="S4.SS2.p5.2.m2.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.2.m2.1c">3e-4</annotation></semantics></math>. We observe that applying a warmup scheme(<span id="S4.SS2.p5.3.3" class="ltx_text ltx_font_bold">?</span>) can help the FRN to achieve better performance, <span id="S4.SS2.p5.3.4" class="ltx_text ltx_font_italic">i.e.,</span> we start training our model with a small learning rate 3e-6, and slowly increase the learning rate until it reaches 3e-4, then use <math id="S4.SS2.p5.3.m3.1" class="ltx_Math" alttext="3e-4" display="inline"><semantics id="S4.SS2.p5.3.m3.1a"><mrow id="S4.SS2.p5.3.m3.1.1" xref="S4.SS2.p5.3.m3.1.1.cmml"><mrow id="S4.SS2.p5.3.m3.1.1.2" xref="S4.SS2.p5.3.m3.1.1.2.cmml"><mn id="S4.SS2.p5.3.m3.1.1.2.2" xref="S4.SS2.p5.3.m3.1.1.2.2.cmml">3</mn><mo lspace="0em" rspace="0em" id="S4.SS2.p5.3.m3.1.1.2.1" xref="S4.SS2.p5.3.m3.1.1.2.1.cmml">​</mo><mi id="S4.SS2.p5.3.m3.1.1.2.3" xref="S4.SS2.p5.3.m3.1.1.2.3.cmml">e</mi></mrow><mo id="S4.SS2.p5.3.m3.1.1.1" xref="S4.SS2.p5.3.m3.1.1.1.cmml">−</mo><mn id="S4.SS2.p5.3.m3.1.1.3" xref="S4.SS2.p5.3.m3.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.3.m3.1b"><apply id="S4.SS2.p5.3.m3.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1"><minus id="S4.SS2.p5.3.m3.1.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1.1"></minus><apply id="S4.SS2.p5.3.m3.1.1.2.cmml" xref="S4.SS2.p5.3.m3.1.1.2"><times id="S4.SS2.p5.3.m3.1.1.2.1.cmml" xref="S4.SS2.p5.3.m3.1.1.2.1"></times><cn type="integer" id="S4.SS2.p5.3.m3.1.1.2.2.cmml" xref="S4.SS2.p5.3.m3.1.1.2.2">3</cn><ci id="S4.SS2.p5.3.m3.1.1.2.3.cmml" xref="S4.SS2.p5.3.m3.1.1.2.3">𝑒</ci></apply><cn type="integer" id="S4.SS2.p5.3.m3.1.1.3.cmml" xref="S4.SS2.p5.3.m3.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.3.m3.1c">3e-4</annotation></semantics></math> to train the model until the end.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Results on CLEVR dataset</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">The results of all the compared methods on CLEVR are shown in Table <a href="#S4.T1" title="Table 1 ‣ 4.1 Datasets ‣ 4 EXPERIMENTS ‣ Question Guided Modular Routing Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, as we claimed before, the standard VQA methods like CNN+LSTM, CNN+LSTM+MCB, CNN+LSTM+SA perform poorly on this challenging dataset. Compared with the explicit reasoning methods N2NMN, PG+EE, TbD, and NS-CL, which are also based on modular networks, most of our proposed models outperform N2NMN and PG+EE, and our best-performed model is as good as NS-CL. Please note that all the four explicit methods require expert knowledge to analyze subquestion set and design corresponding modules for solving them, and all methods except NS-CL require extra supervisory information. So although it is slightly unfair to compare our models with these methods, our models still achieve competitive performance. We attribute such results to the combination of routing mechanism and modular networks. Compared with question guided methods like FiLM and QGHC, our question guided modular routing networks still outperform these methods, which validates the effectiveness of routing mechanism, especially that QGHC and BRN are both based on ResNext, but BRN outperforms QGHC by a large margin. Compared with the implicit reasoning methods like FiLM and MAC, and the prominent Relation Network, our best-performed model still outperforms most of these methods and achieves the same level of performance as MAC.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.4" class="ltx_p">By comparing the three BRN models with different branch numbers, we can basically conclude that increasing the number of modules per layer will improve the performance accordingly. This makes sense, as the diversity of routing path can be expressed as <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="2^{L*M}" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><msup id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml"><mn id="S4.SS3.p2.1.m1.1.1.2" xref="S4.SS3.p2.1.m1.1.1.2.cmml">2</mn><mrow id="S4.SS3.p2.1.m1.1.1.3" xref="S4.SS3.p2.1.m1.1.1.3.cmml"><mi id="S4.SS3.p2.1.m1.1.1.3.2" xref="S4.SS3.p2.1.m1.1.1.3.2.cmml">L</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS3.p2.1.m1.1.1.3.1" xref="S4.SS3.p2.1.m1.1.1.3.1.cmml">∗</mo><mi id="S4.SS3.p2.1.m1.1.1.3.3" xref="S4.SS3.p2.1.m1.1.1.3.3.cmml">M</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">superscript</csymbol><cn type="integer" id="S4.SS3.p2.1.m1.1.1.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2">2</cn><apply id="S4.SS3.p2.1.m1.1.1.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3"><times id="S4.SS3.p2.1.m1.1.1.3.1.cmml" xref="S4.SS3.p2.1.m1.1.1.3.1"></times><ci id="S4.SS3.p2.1.m1.1.1.3.2.cmml" xref="S4.SS3.p2.1.m1.1.1.3.2">𝐿</ci><ci id="S4.SS3.p2.1.m1.1.1.3.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">2^{L*M}</annotation></semantics></math> (the routing path consists of <math id="S4.SS3.p2.2.m2.1" class="ltx_Math" alttext="L*M" display="inline"><semantics id="S4.SS3.p2.2.m2.1a"><mrow id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml"><mi id="S4.SS3.p2.2.m2.1.1.2" xref="S4.SS3.p2.2.m2.1.1.2.cmml">L</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS3.p2.2.m2.1.1.1" xref="S4.SS3.p2.2.m2.1.1.1.cmml">∗</mo><mi id="S4.SS3.p2.2.m2.1.1.3" xref="S4.SS3.p2.2.m2.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><apply id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1"><times id="S4.SS3.p2.2.m2.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1.1"></times><ci id="S4.SS3.p2.2.m2.1.1.2.cmml" xref="S4.SS3.p2.2.m2.1.1.2">𝐿</ci><ci id="S4.SS3.p2.2.m2.1.1.3.cmml" xref="S4.SS3.p2.2.m2.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">L*M</annotation></semantics></math> switches, each of which has two states), if we keep the number of module layers <math id="S4.SS3.p2.3.m3.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.SS3.p2.3.m3.1a"><mi id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.1b"><ci id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.1c">L</annotation></semantics></math> consistent and increase the number of modules per layer <math id="S4.SS3.p2.4.m4.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S4.SS3.p2.4.m4.1a"><mi id="S4.SS3.p2.4.m4.1.1" xref="S4.SS3.p2.4.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.1b"><ci id="S4.SS3.p2.4.m4.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.1c">M</annotation></semantics></math>, the diversity of routing path will also increase. Since the diversity of routing path largely reflects the model’s representation power, so increasing the number of modules per layer can enhance the performance of the model finally. We hope this discovery can provide some help for future research on routing models. By comparing the model performance with or without attention component we propose in Section <a href="#S3.SS4" title="3.4 QGMRN with Attention ‣ 3 METHODOLOGY ‣ Question Guided Modular Routing Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4</span></a> , we can find the attention component can improve the overall accuracy by about 0.7%.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.1" class="ltx_p">Finally, on <span id="S4.SS3.p3.1.1" class="ltx_text ltx_font_typewriter">Exist</span>, <span id="S4.SS3.p3.1.2" class="ltx_text ltx_font_typewriter">Query Attribute</span> and <span id="S4.SS3.p3.1.3" class="ltx_text ltx_font_typewriter">Compare Attribute</span> question types, our best-performed model has reached nearly 100% accuracy, higher than all other methods. But on <span id="S4.SS3.p3.1.4" class="ltx_text ltx_font_typewriter">Compare Numbers</span> question type, our models do not perform well. However previous study (<span id="S4.SS3.p3.1.5" class="ltx_text ltx_font_bold">?</span>) has pointed out that on <span id="S4.SS3.p3.1.6" class="ltx_text ltx_font_typewriter">Compare Numbers</span> question type, model trained from feature map (extracted from a pre-trained model) will perform better than the model trained from raw pixel.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Results on CLEVR-Humans</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">To further validate the reasoning ability and generalization ability of our model, we next provide the results on CLEVR-Humans. To make a fair comparison with other methods, the reported result is fine-tuned from previous best-performed BRN and FRN models on CLEVR dataset. Also, pre-trained word embeddings are not used.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.1" class="ltx_p">As shown in the last column of Table <a href="#S4.T1" title="Table 1 ‣ 4.1 Datasets ‣ 4 EXPERIMENTS ‣ Question Guided Modular Routing Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, our best-performed model outperforms all compared methods. The performance difference is more significant compared to CLEVR which validates that our model has better robustness and strong reasoning ability.</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Ablation study of BRN</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">We conduct ablation studies of BRN on CLEVR dataset to analyze the influence of each decision to the model performance.</p>
</div>
<div id="S4.SS5.p2" class="ltx_para ltx_noindent">
<p id="S4.SS5.p2.1" class="ltx_p"><span id="S4.SS5.p2.1.1" class="ltx_text ltx_font_bold">Should we send question features to the classifier with image features?</span> As shown in Table <a href="#S4.T2" title="Table 2 ‣ 4.5 Ablation study of BRN ‣ 4 EXPERIMENTS ‣ Question Guided Modular Routing Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, when the number of modules per modular layers is set to <math id="S4.SS5.p2.1.m1.1" class="ltx_Math" alttext="16" display="inline"><semantics id="S4.SS5.p2.1.m1.1a"><mn id="S4.SS5.p2.1.m1.1.1" xref="S4.SS5.p2.1.m1.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.1.m1.1b"><cn type="integer" id="S4.SS5.p2.1.m1.1.1.cmml" xref="S4.SS5.p2.1.m1.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.1.m1.1c">16</annotation></semantics></math>, sending question features together with image features to the classifier will provide 3.3% improvement over sending only image features to the classifier. However, we did not find a similar improvement in FRN, perhaps because the performance of FRN itself is high enough.</p>
</div>
<div id="S4.SS5.p3" class="ltx_para ltx_noindent">
<p id="S4.SS5.p3.2" class="ltx_p"><span id="S4.SS5.p3.2.1" class="ltx_text ltx_font_bold">Should we replace the 3rd normalization layer of the ResNext block from bn to gn?</span> First of all, why use gn instead of bn when the batchsize is already large enough? Since bn keeps <math id="S4.SS5.p3.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS5.p3.1.m1.1a"><mi id="S4.SS5.p3.1.m1.1.1" xref="S4.SS5.p3.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.1.m1.1b"><ci id="S4.SS5.p3.1.m1.1.1.cmml" xref="S4.SS5.p3.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p3.1.m1.1c">C</annotation></semantics></math> pairs of mean and variance for each channel within a mini-batch. And a generally accepted rule is that the model with bn does not work well when the batchsize is too small. One possible reason is that the smaller batchsize will cause the statistics (mean and var) unstable, and change the distribution of feature map all the time. In the scenario of dynamic routing, bn’s statistics will also be unstable. To validate our analysis, we replace the <math id="S4.SS5.p3.2.m2.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S4.SS5.p3.2.m2.1a"><mn id="S4.SS5.p3.2.m2.1.1" xref="S4.SS5.p3.2.m2.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.2.m2.1b"><cn type="integer" id="S4.SS5.p3.2.m2.1.1.cmml" xref="S4.SS5.p3.2.m2.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p3.2.m2.1c">3</annotation></semantics></math>rd normalization layer of the bottleneck block from bn to gn. The results can be found in Table <a href="#S4.T2" title="Table 2 ‣ 4.5 Ablation study of BRN ‣ 4 EXPERIMENTS ‣ Question Guided Modular Routing Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>,
we can see the improvements are very significant after the replacement. As for why FRN can achieve good results without the replacement, we suspect that it may be due to the higher module execution ratio of FRN (please refer to section <a href="#S4.SS6" title="4.6 Visualization ‣ 4 EXPERIMENTS ‣ Question Guided Modular Routing Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.6</span></a>).</p>
</div>
<div id="S4.SS5.p4" class="ltx_para ltx_noindent">
<p id="S4.SS5.p4.1" class="ltx_p"><span id="S4.SS5.p4.1.1" class="ltx_text ltx_font_bold">How to select the number of modules per layer?</span> In the previous section, we have shown that for BRN with gn, increasing the number of modules per layer will improve the performance accordingly. In Table <a href="#S4.T2" title="Table 2 ‣ 4.5 Ablation study of BRN ‣ 4 EXPERIMENTS ‣ Question Guided Modular Routing Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we also show that the above rule apply to BRN without gn (<span id="S4.SS5.p4.1.2" class="ltx_text ltx_font_italic">i.e.,</span> without replacing the 3 normalization layers in the ResNext block) too.</p>
</div>
<div id="S4.SS5.p5" class="ltx_para ltx_noindent">
<p id="S4.SS5.p5.3" class="ltx_p"><span id="S4.SS5.p5.3.1" class="ltx_text ltx_font_bold">Will deepening or widening ResNext bring performance improvements?</span> The default depth and width of BRN’s ResNext can be denoted as [2,2,2,2] and [64,128,256,256]. The <math id="S4.SS5.p5.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS5.p5.1.m1.1a"><mi id="S4.SS5.p5.1.m1.1.1" xref="S4.SS5.p5.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p5.1.m1.1b"><ci id="S4.SS5.p5.1.m1.1.1.cmml" xref="S4.SS5.p5.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p5.1.m1.1c">i</annotation></semantics></math>-th values of these two arrays represent the depth (<span id="S4.SS5.p5.3.2" class="ltx_text ltx_font_italic">i.e.,</span> the number of bottleneck blocks) and width (i.e., channel number) of the <math id="S4.SS5.p5.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS5.p5.2.m2.1a"><mi id="S4.SS5.p5.2.m2.1.1" xref="S4.SS5.p5.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p5.2.m2.1b"><ci id="S4.SS5.p5.2.m2.1.1.cmml" xref="S4.SS5.p5.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p5.2.m2.1c">i</annotation></semantics></math>-th stage, respectively. The <math id="S4.SS5.p5.3.m3.1" class="ltx_Math" alttext="4" display="inline"><semantics id="S4.SS5.p5.3.m3.1a"><mn id="S4.SS5.p5.3.m3.1.1" xref="S4.SS5.p5.3.m3.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S4.SS5.p5.3.m3.1b"><cn type="integer" id="S4.SS5.p5.3.m3.1.1.cmml" xref="S4.SS5.p5.3.m3.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p5.3.m3.1c">4</annotation></semantics></math> stages are divided according to the downsampling operation. Based on this default configuration, we experiment with deepened (depth from [2,2,2,2] to [2,4,6,3]) or widened (width from [64,128,256,256] to [64,128,256,512]) models respectively. From Table <a href="#S4.T2" title="Table 2 ‣ 4.5 Ablation study of BRN ‣ 4 EXPERIMENTS ‣ Question Guided Modular Routing Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> we can find that deepening BRN will improve the accuracy by 0.3%, however widening BRN will result in a 0.3% accuracy drop. Therefore, the overall difference between the three models is not significant, but whether it is deepened or widened will increase the running time and slow down the convergence speed, so we finally use the default width and depth.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<table id="S4.T2.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T2.1.2" class="ltx_tr">
<td id="S4.T2.1.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r ltx_border_tt" style="padding-left:1.6pt;padding-right:1.6pt;">Model</td>
<td id="S4.T2.1.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:1.6pt;padding-right:1.6pt;">Overall</td>
<td id="S4.T2.1.2.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:1.6pt;padding-right:1.6pt;">Count</td>
<td id="S4.T2.1.2.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:1.6pt;padding-right:1.6pt;">Exist</td>
<td id="S4.T2.1.2.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:1.6pt;padding-right:1.6pt;">
<table id="S4.T2.1.2.5.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T2.1.2.5.1.1" class="ltx_tr">
<td id="S4.T2.1.2.5.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">Cmp.</td>
</tr>
<tr id="S4.T2.1.2.5.1.2" class="ltx_tr">
<td id="S4.T2.1.2.5.1.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">Num.</td>
</tr>
</table>
</td>
<td id="S4.T2.1.2.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:1.6pt;padding-right:1.6pt;">
<table id="S4.T2.1.2.6.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T2.1.2.6.1.1" class="ltx_tr">
<td id="S4.T2.1.2.6.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">Query</td>
</tr>
<tr id="S4.T2.1.2.6.1.2" class="ltx_tr">
<td id="S4.T2.1.2.6.1.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">Attr.</td>
</tr>
</table>
</td>
<td id="S4.T2.1.2.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:1.6pt;padding-right:1.6pt;">
<table id="S4.T2.1.2.7.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T2.1.2.7.1.1" class="ltx_tr">
<td id="S4.T2.1.2.7.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">Cmp.</td>
</tr>
<tr id="S4.T2.1.2.7.1.2" class="ltx_tr">
<td id="S4.T2.1.2.7.1.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">Attr.</td>
</tr>
</table>
</td>
</tr>
<tr id="S4.T2.1.1" class="ltx_tr">
<td id="S4.T2.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;" colspan="7"><span id="S4.T2.1.1.1.1" class="ltx_text ltx_font_bold">Ablation experiment on whether to feed <math id="S4.T2.1.1.1.1.m1.1" class="ltx_Math" alttext="\mathbf{q}" display="inline"><semantics id="S4.T2.1.1.1.1.m1.1a"><mi id="S4.T2.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.cmml">𝐪</mi><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.1b"><ci id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1">𝐪</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.1c">\mathbf{q}</annotation></semantics></math> to the classifier</span></td>
</tr>
<tr id="S4.T2.1.3" class="ltx_tr" style="background-color:#E6E6E6;">
<td id="S4.T2.1.3.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.3.1.1" class="ltx_text" style="background-color:#E6E6E6;">c=16, w/o q</span></td>
<td id="S4.T2.1.3.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.3.2.1" class="ltx_text" style="background-color:#E6E6E6;">89.7</span></td>
<td id="S4.T2.1.3.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.3.3.1" class="ltx_text" style="background-color:#E6E6E6;">84.7</span></td>
<td id="S4.T2.1.3.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.3.4.1" class="ltx_text" style="background-color:#E6E6E6;">95.9</span></td>
<td id="S4.T2.1.3.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.3.5.1" class="ltx_text" style="background-color:#E6E6E6;">81.9</span></td>
<td id="S4.T2.1.3.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.3.6.1" class="ltx_text" style="background-color:#E6E6E6;">90.2</span></td>
<td id="S4.T2.1.3.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.3.7.1" class="ltx_text" style="background-color:#E6E6E6;">94.6</span></td>
</tr>
<tr id="S4.T2.1.4" class="ltx_tr" style="background-color:#E6E6E6;">
<td id="S4.T2.1.4.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.4.1.1" class="ltx_text" style="background-color:#E6E6E6;">c=16, w/ q</span></td>
<td id="S4.T2.1.4.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.4.2.1" class="ltx_text" style="background-color:#E6E6E6;">93.0</span></td>
<td id="S4.T2.1.4.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.4.3.1" class="ltx_text" style="background-color:#E6E6E6;">90.8</span></td>
<td id="S4.T2.1.4.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.4.4.1" class="ltx_text" style="background-color:#E6E6E6;">98.6</span></td>
<td id="S4.T2.1.4.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.4.5.1" class="ltx_text" style="background-color:#E6E6E6;">83.6</span></td>
<td id="S4.T2.1.4.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.4.6.1" class="ltx_text" style="background-color:#E6E6E6;">91.7</span></td>
<td id="S4.T2.1.4.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.4.7.1" class="ltx_text" style="background-color:#E6E6E6;">98.9</span></td>
</tr>
<tr id="S4.T2.1.5" class="ltx_tr">
<td id="S4.T2.1.5.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;" colspan="7"><span id="S4.T2.1.5.1.1" class="ltx_text ltx_font_bold">Ablation experiment on whether to replace bn with gn</span></td>
</tr>
<tr id="S4.T2.1.6" class="ltx_tr">
<td id="S4.T2.1.6.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;">c=8, w/ q</td>
<td id="S4.T2.1.6.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;">75.1</td>
<td id="S4.T2.1.6.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;">66.8</td>
<td id="S4.T2.1.6.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;">84.7</td>
<td id="S4.T2.1.6.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;">75.8</td>
<td id="S4.T2.1.6.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;">80.3</td>
<td id="S4.T2.1.6.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;">68.4</td>
</tr>
<tr id="S4.T2.1.7" class="ltx_tr">
<td id="S4.T2.1.7.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r" style="padding-left:1.6pt;padding-right:1.6pt;">c=8, w/ q, gn</td>
<td id="S4.T2.1.7.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">86.8</td>
<td id="S4.T2.1.7.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">79.5</td>
<td id="S4.T2.1.7.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">93.4</td>
<td id="S4.T2.1.7.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">75.1</td>
<td id="S4.T2.1.7.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">90.0</td>
<td id="S4.T2.1.7.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">91.1</td>
</tr>
<tr id="S4.T2.1.8" class="ltx_tr" style="background-color:#E6E6E6;">
<td id="S4.T2.1.8.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.8.1.1" class="ltx_text" style="background-color:#E6E6E6;">c=16, w/ q</span></td>
<td id="S4.T2.1.8.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.8.2.1" class="ltx_text" style="background-color:#E6E6E6;">93.0</span></td>
<td id="S4.T2.1.8.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.8.3.1" class="ltx_text" style="background-color:#E6E6E6;">90.8</span></td>
<td id="S4.T2.1.8.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.8.4.1" class="ltx_text" style="background-color:#E6E6E6;">98.6</span></td>
<td id="S4.T2.1.8.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.8.5.1" class="ltx_text" style="background-color:#E6E6E6;">83.6</span></td>
<td id="S4.T2.1.8.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.8.6.1" class="ltx_text" style="background-color:#E6E6E6;">91.7</span></td>
<td id="S4.T2.1.8.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.8.7.1" class="ltx_text" style="background-color:#E6E6E6;">98.9</span></td>
</tr>
<tr id="S4.T2.1.9" class="ltx_tr" style="background-color:#E6E6E6;">
<td id="S4.T2.1.9.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.9.1.1" class="ltx_text" style="background-color:#E6E6E6;">c=16, w/ q, gn</span></td>
<td id="S4.T2.1.9.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.9.2.1" class="ltx_text" style="background-color:#E6E6E6;">94.7</span></td>
<td id="S4.T2.1.9.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.9.3.1" class="ltx_text" style="background-color:#E6E6E6;">90.8</span></td>
<td id="S4.T2.1.9.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.9.4.1" class="ltx_text" style="background-color:#E6E6E6;">98.1</span></td>
<td id="S4.T2.1.9.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.9.5.1" class="ltx_text" style="background-color:#E6E6E6;">82.8</span></td>
<td id="S4.T2.1.9.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.9.6.1" class="ltx_text" style="background-color:#E6E6E6;">97.3</span></td>
<td id="S4.T2.1.9.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.9.7.1" class="ltx_text" style="background-color:#E6E6E6;">98.4</span></td>
</tr>
<tr id="S4.T2.1.10" class="ltx_tr">
<td id="S4.T2.1.10.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r" style="padding-left:1.6pt;padding-right:1.6pt;">c=32, w/ q</td>
<td id="S4.T2.1.10.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">94.0</td>
<td id="S4.T2.1.10.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">93.0</td>
<td id="S4.T2.1.10.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">99.6</td>
<td id="S4.T2.1.10.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">85.9</td>
<td id="S4.T2.1.10.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">91.9</td>
<td id="S4.T2.1.10.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">99.4</td>
</tr>
<tr id="S4.T2.1.11" class="ltx_tr">
<td id="S4.T2.1.11.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r" style="padding-left:1.6pt;padding-right:1.6pt;">c=32, w/ q, gn</td>
<td id="S4.T2.1.11.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">97.9</td>
<td id="S4.T2.1.11.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">95.4</td>
<td id="S4.T2.1.11.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">98.9</td>
<td id="S4.T2.1.11.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">92.9</td>
<td id="S4.T2.1.11.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">99.4</td>
<td id="S4.T2.1.11.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">99.7</td>
</tr>
<tr id="S4.T2.1.12" class="ltx_tr">
<td id="S4.T2.1.12.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;" colspan="7"><span id="S4.T2.1.12.1.1" class="ltx_text ltx_font_bold">Ablation experiment on the number of modules per-layer</span></td>
</tr>
<tr id="S4.T2.1.13" class="ltx_tr" style="background-color:#E6E6E6;">
<td id="S4.T2.1.13.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.13.1.1" class="ltx_text" style="background-color:#E6E6E6;">c=8, w/ q</span></td>
<td id="S4.T2.1.13.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.13.2.1" class="ltx_text" style="background-color:#E6E6E6;">75.1</span></td>
<td id="S4.T2.1.13.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.13.3.1" class="ltx_text" style="background-color:#E6E6E6;">66.8</span></td>
<td id="S4.T2.1.13.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.13.4.1" class="ltx_text" style="background-color:#E6E6E6;">84.7</span></td>
<td id="S4.T2.1.13.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.13.5.1" class="ltx_text" style="background-color:#E6E6E6;">75.8</span></td>
<td id="S4.T2.1.13.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.13.6.1" class="ltx_text" style="background-color:#E6E6E6;">80.3</span></td>
<td id="S4.T2.1.13.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.13.7.1" class="ltx_text" style="background-color:#E6E6E6;">68.4</span></td>
</tr>
<tr id="S4.T2.1.14" class="ltx_tr" style="background-color:#E6E6E6;">
<td id="S4.T2.1.14.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.14.1.1" class="ltx_text" style="background-color:#E6E6E6;">c=16, w/ q</span></td>
<td id="S4.T2.1.14.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.14.2.1" class="ltx_text" style="background-color:#E6E6E6;">93.0</span></td>
<td id="S4.T2.1.14.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.14.3.1" class="ltx_text" style="background-color:#E6E6E6;">90.8</span></td>
<td id="S4.T2.1.14.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.14.4.1" class="ltx_text" style="background-color:#E6E6E6;">98.6</span></td>
<td id="S4.T2.1.14.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.14.5.1" class="ltx_text" style="background-color:#E6E6E6;">83.6</span></td>
<td id="S4.T2.1.14.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.14.6.1" class="ltx_text" style="background-color:#E6E6E6;">91.7</span></td>
<td id="S4.T2.1.14.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.14.7.1" class="ltx_text" style="background-color:#E6E6E6;">98.9</span></td>
</tr>
<tr id="S4.T2.1.15" class="ltx_tr" style="background-color:#E6E6E6;">
<td id="S4.T2.1.15.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.15.1.1" class="ltx_text" style="background-color:#E6E6E6;">c=32, w/ q</span></td>
<td id="S4.T2.1.15.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.15.2.1" class="ltx_text" style="background-color:#E6E6E6;">94.0</span></td>
<td id="S4.T2.1.15.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.15.3.1" class="ltx_text" style="background-color:#E6E6E6;">93.0</span></td>
<td id="S4.T2.1.15.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.15.4.1" class="ltx_text" style="background-color:#E6E6E6;">99.6</span></td>
<td id="S4.T2.1.15.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.15.5.1" class="ltx_text" style="background-color:#E6E6E6;">85.9</span></td>
<td id="S4.T2.1.15.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.15.6.1" class="ltx_text" style="background-color:#E6E6E6;">91.9</span></td>
<td id="S4.T2.1.15.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.15.7.1" class="ltx_text" style="background-color:#E6E6E6;">99.4</span></td>
</tr>
<tr id="S4.T2.1.16" class="ltx_tr">
<td id="S4.T2.1.16.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r" style="padding-left:1.6pt;padding-right:1.6pt;">c=8, w/ q, gn</td>
<td id="S4.T2.1.16.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">86.8</td>
<td id="S4.T2.1.16.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">79.5</td>
<td id="S4.T2.1.16.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">93.4</td>
<td id="S4.T2.1.16.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">75.1</td>
<td id="S4.T2.1.16.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">90.0</td>
<td id="S4.T2.1.16.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">91.1</td>
</tr>
<tr id="S4.T2.1.17" class="ltx_tr">
<td id="S4.T2.1.17.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r" style="padding-left:1.6pt;padding-right:1.6pt;">c=16, w/ q, gn</td>
<td id="S4.T2.1.17.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">94.7</td>
<td id="S4.T2.1.17.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">90.8</td>
<td id="S4.T2.1.17.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">98.1</td>
<td id="S4.T2.1.17.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">82.8</td>
<td id="S4.T2.1.17.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">97.3</td>
<td id="S4.T2.1.17.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">98.4</td>
</tr>
<tr id="S4.T2.1.18" class="ltx_tr">
<td id="S4.T2.1.18.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r" style="padding-left:1.6pt;padding-right:1.6pt;">c=32, w/ q, gn</td>
<td id="S4.T2.1.18.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">97.9</td>
<td id="S4.T2.1.18.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">95.4</td>
<td id="S4.T2.1.18.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">98.9</td>
<td id="S4.T2.1.18.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">92.9</td>
<td id="S4.T2.1.18.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">99.4</td>
<td id="S4.T2.1.18.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;">99.7</td>
</tr>
<tr id="S4.T2.1.19" class="ltx_tr">
<td id="S4.T2.1.19.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;" colspan="7"><span id="S4.T2.1.19.1.1" class="ltx_text ltx_font_bold">Ablation experiment on increasing the depth and width</span></td>
</tr>
<tr id="S4.T2.1.20" class="ltx_tr" style="background-color:#E6E6E6;">
<td id="S4.T2.1.20.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.20.1.1" class="ltx_text" style="background-color:#E6E6E6;">c=32, w/ q</span></td>
<td id="S4.T2.1.20.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.20.2.1" class="ltx_text" style="background-color:#E6E6E6;">94.0</span></td>
<td id="S4.T2.1.20.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.20.3.1" class="ltx_text" style="background-color:#E6E6E6;">93.0</span></td>
<td id="S4.T2.1.20.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.20.4.1" class="ltx_text" style="background-color:#E6E6E6;">99.6</span></td>
<td id="S4.T2.1.20.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.20.5.1" class="ltx_text" style="background-color:#E6E6E6;">85.9</span></td>
<td id="S4.T2.1.20.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.20.6.1" class="ltx_text" style="background-color:#E6E6E6;">91.9</span></td>
<td id="S4.T2.1.20.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.20.7.1" class="ltx_text" style="background-color:#E6E6E6;">99.4</span></td>
</tr>
<tr id="S4.T2.1.21" class="ltx_tr" style="background-color:#E6E6E6;">
<td id="S4.T2.1.21.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.21.1.1" class="ltx_text" style="background-color:#E6E6E6;">c=32, w/ q, deeper</span></td>
<td id="S4.T2.1.21.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.21.2.1" class="ltx_text" style="background-color:#E6E6E6;">94.3</span></td>
<td id="S4.T2.1.21.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.21.3.1" class="ltx_text" style="background-color:#E6E6E6;">94.1</span></td>
<td id="S4.T2.1.21.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.21.4.1" class="ltx_text" style="background-color:#E6E6E6;">99.6</span></td>
<td id="S4.T2.1.21.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.21.5.1" class="ltx_text" style="background-color:#E6E6E6;">85.4</span></td>
<td id="S4.T2.1.21.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.21.6.1" class="ltx_text" style="background-color:#E6E6E6;">92.1</span></td>
<td id="S4.T2.1.21.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.21.7.1" class="ltx_text" style="background-color:#E6E6E6;">99.5</span></td>
</tr>
<tr id="S4.T2.1.22" class="ltx_tr" style="background-color:#E6E6E6;">
<td id="S4.T2.1.22.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_r" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.22.1.1" class="ltx_text" style="background-color:#E6E6E6;">c=32, w/ q, wider</span></td>
<td id="S4.T2.1.22.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.22.2.1" class="ltx_text" style="background-color:#E6E6E6;">93.7</span></td>
<td id="S4.T2.1.22.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.22.3.1" class="ltx_text" style="background-color:#E6E6E6;">91.7</span></td>
<td id="S4.T2.1.22.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.22.4.1" class="ltx_text" style="background-color:#E6E6E6;">99.0</span></td>
<td id="S4.T2.1.22.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.22.5.1" class="ltx_text" style="background-color:#E6E6E6;">83.8</span></td>
<td id="S4.T2.1.22.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.22.6.1" class="ltx_text" style="background-color:#E6E6E6;">93.0</span></td>
<td id="S4.T2.1.22.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:1.6pt;padding-right:1.6pt;"><span id="S4.T2.1.22.7.1" class="ltx_text" style="background-color:#E6E6E6;">99.1</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Ablation studies of BRN on CLEVR dataset. The notation c is the abbreviation for cardinality, and represents the number of modules per modular layer; w/ q represents sending both image features and question features to the classifier; w/o q represents only sending the image features to the classifier; gn denotes using group normalization instead of batch normalization; deeper means more bottleneck blocks and wider means more channel number.</figcaption>
</figure>
<figure id="S4.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F3.1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" style="width:303.5pt;"><img src="/html/1904.08324/assets/fig/test.png" id="S4.F3.1.g1" class="ltx_graphics ltx_img_landscape" width="698" height="485" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The t-SNE visualization of routing paths of stage1, stage2, stage3 and stage4 are represented at top-left, top-right, bottom-left and bottom-right sub-figures respectively. Low-level question subtypes are clustered in the earlier stages and high-level question subtypes are clustered in the later stages. Best seen on the computer, in colour and zoomed in.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F3.fig1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" style="width:161.9pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F3.sf1" class="ltx_figure ltx_figure_panel"><img src="/html/1904.08324/assets/fig/statistic.png" id="S4.F3.sf1.g1" class="ltx_graphics ltx_img_landscape" width="698" height="465" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>FRN</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1904.08324/assets/fig/statistic1.png" id="S4.F3.sf2.g1" class="ltx_graphics ltx_img_landscape" width="698" height="465" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>BRN(c=32)</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>The module execution ratio in each layer. The overall execution ratio of FRN is above BRN.</figcaption>
</figure>
</div>
</div>
</figure>
<figure id="S4.F4" class="ltx_figure"><img src="/html/1904.08324/assets/fig/saliency_example1.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="328" height="153" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>The saliency map indicates the key pixels for reasoning with respect to different questions.</figcaption>
</figure>
</section>
<section id="S4.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6 </span>Visualization</h3>

<div id="S4.SS6.p1" class="ltx_para ltx_noindent">
<p id="S4.SS6.p1.1" class="ltx_p"><span id="S4.SS6.p1.1.1" class="ltx_text ltx_font_bold">T-SNE visualization of routing paths
<br class="ltx_break"></span>To investigate what the routing network learns, we use t-SNE (<span id="S4.SS6.p1.1.2" class="ltx_text ltx_font_bold">?</span>) to visualize the routing paths in 2D embedding. Specifically, we divide the routing path into 4 stages according to the downsampling in the visual network, then flatten the routing path of each stage into a vector, and finally project it to the 2D space through t-SNE. For efficiency, we did not visualize the entire CLEVR dataset, but randomly select 500 instances on the validation set for each officially provided question subtype (<span id="S4.SS6.p1.1.3" class="ltx_text ltx_font_italic">i.e.,</span> subtypes subdivided from the previous 5 types). The visualization and detailed 13 question subtypes can be seen in Figure <a href="#S4.F3" title="Figure 3 ‣ 4.5 Ablation study of BRN ‣ 4 EXPERIMENTS ‣ Question Guided Modular Routing Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Each point represents an instance, and points of the same question subtype are labeled with the same color. From the figure, we can discover some interesting phenomenons, we list some of them as follows: a) as the stage increases, data points with different question types can be discriminated better. b) The visualization of stage1 may be confusing at first glance, but note that data points with question subtype of <span id="S4.SS6.p1.1.4" class="ltx_text ltx_font_typewriter">query_color</span> and <span id="S4.SS6.p1.1.5" class="ltx_text ltx_font_typewriter">equal_color</span> are clustered together and data points with question subtype of <span id="S4.SS6.p1.1.6" class="ltx_text ltx_font_typewriter">query_material</span> and <span id="S4.SS6.p1.1.7" class="ltx_text ltx_font_typewriter">equal_material</span> are clustered together, this makes sense because the first few layers of CNN are responsible for detecting features about colors, textures, and edges (<span id="S4.SS6.p1.1.8" class="ltx_text ltx_font_bold">?</span>). c) data points with the question subtype belonging to the same question type (<span id="S4.SS6.p1.1.9" class="ltx_text ltx_font_italic">e.g.,</span> <span id="S4.SS6.p1.1.10" class="ltx_text ltx_font_typewriter">greater_than</span>, <span id="S4.SS6.p1.1.11" class="ltx_text ltx_font_typewriter">less_than</span> and <span id="S4.SS6.p1.1.12" class="ltx_text ltx_font_typewriter">equal_integer</span> belong to the <span id="S4.SS6.p1.1.13" class="ltx_text ltx_font_typewriter">Compare Numbers</span> type) are tend to cluster together. d) data points with the question type of <span id="S4.SS6.p1.1.14" class="ltx_text ltx_font_typewriter">count</span> and <span id="S4.SS6.p1.1.15" class="ltx_text ltx_font_typewriter">exist</span> are clustered together, this makes sense as <span id="S4.SS6.p1.1.16" class="ltx_text ltx_font_typewriter">exist</span> is a special case of <span id="S4.SS6.p1.1.17" class="ltx_text ltx_font_typewriter">count</span>.</p>
</div>
<div id="S4.SS6.p2" class="ltx_para ltx_noindent">
<p id="S4.SS6.p2.1" class="ltx_p"><span id="S4.SS6.p2.1.1" class="ltx_text ltx_font_bold">How many modules are executed for each layer
<br class="ltx_break"></span>
To investigate how many modules are executed in each layer, we provide the box plot (Figure <a href="#S4.F3" title="Figure 3 ‣ 4.5 Ablation study of BRN ‣ 4 EXPERIMENTS ‣ Question Guided Modular Routing Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) of the module execution ratio (<span id="S4.SS6.p2.1.2" class="ltx_text ltx_font_italic">i.e.,</span> the number of executed modules divided by the total number of the modules) for each layer of FRN and BRN(c=32) on the validation set. First of all, it can be observed that both FRN (refer to Figure <a href="#S4.F3.sf1" title="In Figure 3 ‣ 4.5 Ablation study of BRN ‣ 4 EXPERIMENTS ‣ Question Guided Modular Routing Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3a</span></a>) and BRN (refer to Figure <a href="#S4.F3.sf2" title="In Figure 3 ‣ 4.5 Ablation study of BRN ‣ 4 EXPERIMENTS ‣ Question Guided Modular Routing Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3b</span></a>) follow a rule: the execution ratio becomes lower as layers going deeper, this makes sense as the
features extracted at early layers are generic, and the features extracted at higher layers are more related to the VQA task. Next we can observe that the overall execution ratio of the FRN model is not low, however please note that with the reduction of filters, current deep learning frameworks cannot reduce the running time accordingly, so we did not pay much attention to it. Finally, note that even if we do not add any sparsity constraints, BRN still has a considerable reduction of about <span id="S4.SS6.p2.1.3" class="ltx_text ltx_font_bold">43%</span>. We believe that this number can be increased with the addition of sparsity constraints. And with the further support of the deep learning framework, the routing model will have more useful applications in the future.</p>
</div>
<div id="S4.SS6.p3" class="ltx_para ltx_noindent">
<p id="S4.SS6.p3.1" class="ltx_p"><span id="S4.SS6.p3.1.1" class="ltx_text ltx_font_bold">Saliency map
<br class="ltx_break"></span>To investigate which pixels affect the prediction most, we visualize the saliency map of the same image to different questions. Concretely, we calculate the gradient of each pixel with respect to the max prediction score. Figure <a href="#S4.F4" title="Figure 4 ‣ 4.5 Ablation study of BRN ‣ 4 EXPERIMENTS ‣ Question Guided Modular Routing Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> quantitatively shows that QGMRN can identify the key pixels for prediction. More examples are available in appendix <a href="#A1" title="Appendix A Saliency map examples ‣ Question Guided Modular Routing Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we propose the Question Guided Modular Routing Networks for VQA which can fuse the visual and textual modalities at multiple semantic levels and learn to reason by routing between the generic modules, different interesting variant models can be generated by changing the granularity of the module. In the experiments, we show that our models have achieved the state-of-the-art performance. From the perspective of routing models, we find a suitable application for them where static models struggle, we also successfully applied them to large models and large-scale datasets. In particular, we provide two interesting findings: 1. The performance of the model is positively correlated with the number of modules per layer; 2. When the execution ratio is low, using gn will be better than bn. We believe that routing models will play an important role in future multimodal fusion and embedding.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bibx1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Anderson et al<span id="bib.bibx1.1.1.1" class="ltx_text">.</span> 2018]</span>
<span class="ltx_bibblock">
Anderson, P.; He, X.; Buehler, C.; Teney, D.; Johnson, M.; Gould, S.; and
Zhang, L.

</span>
<span class="ltx_bibblock">2018.

</span>
<span class="ltx_bibblock">Bottom-up and top-down attention for image captioning and visual
question answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx1.3.1" class="ltx_text ltx_font_italic">CVPR</span>.

</span>
</li>
<li id="bib.bibx2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Andreas et al<span id="bib.bibx2.1.1.1" class="ltx_text">.</span> 2016]</span>
<span class="ltx_bibblock">
Andreas, J.; Rohrbach, M.; Darrell, T.; and Klein, D.

</span>
<span class="ltx_bibblock">2016.

</span>
<span class="ltx_bibblock">Neural module networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx2.3.1" class="ltx_text ltx_font_italic">CVPR</span>.

</span>
</li>
<li id="bib.bibx3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Antol et al<span id="bib.bibx3.1.1.1" class="ltx_text">.</span> 2015]</span>
<span class="ltx_bibblock">
Antol, S.; Agrawal, A.; Lu, J.; Mitchell, M.; Batra, D.; Lawrence Zitnick, C.;
and Parikh, D.

</span>
<span class="ltx_bibblock">2015.

</span>
<span class="ltx_bibblock">Vqa: Visual question answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx3.3.1" class="ltx_text ltx_font_italic">ICCV</span>.

</span>
</li>
<li id="bib.bibx4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Ben-Younes et al<span id="bib.bibx4.1.1.1" class="ltx_text">.</span> 2017]</span>
<span class="ltx_bibblock">
Ben-Younes, H.; Cadene, R.; Cord, M.; and Thome, N.

</span>
<span class="ltx_bibblock">2017.

</span>
<span class="ltx_bibblock">Mutan: Multimodal tucker fusion for visual question answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx4.3.1" class="ltx_text ltx_font_italic">ICCV</span>.

</span>
</li>
<li id="bib.bibx5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Bengio et al<span id="bib.bibx5.1.1.1" class="ltx_text">.</span> 2016]</span>
<span class="ltx_bibblock">
Bengio, E.; Bacon, P.-L.; Pineau, J.; and Precup, D.

</span>
<span class="ltx_bibblock">2016.

</span>
<span class="ltx_bibblock">Conditional computation in neural networks for faster models.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx5.3.1" class="ltx_text ltx_font_italic">ICLR workshop</span>, volume abs/1511.06297.

</span>
</li>
<li id="bib.bibx6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Bengio, Léonard, and
Courville 2013]</span>
<span class="ltx_bibblock">
Bengio, Y.; Léonard, N.; and Courville, A.

</span>
<span class="ltx_bibblock">2013.

</span>
<span class="ltx_bibblock">Estimating or propagating gradients through stochastic neurons for
conditional computation.

</span>
<span class="ltx_bibblock"><span id="bib.bibx6.1.1" class="ltx_text ltx_font_italic">CoRR</span> abs/1308.3432.

</span>
</li>
<li id="bib.bibx7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Cho et al<span id="bib.bibx7.1.1.1" class="ltx_text">.</span> 2014]</span>
<span class="ltx_bibblock">
Cho, K.; Van Merriënboer, B.; Gulcehre, C.; Bahdanau, D.; Bougares, F.;
Schwenk, H.; and Bengio, Y.

</span>
<span class="ltx_bibblock">2014.

</span>
<span class="ltx_bibblock">Learning phrase representations using rnn encoder-decoder for
statistical machine translation.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx7.3.1" class="ltx_text ltx_font_italic">EMNLP</span>.

</span>
</li>
<li id="bib.bibx8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[De Vries et al<span id="bib.bibx8.1.1.1" class="ltx_text">.</span> 2017]</span>
<span class="ltx_bibblock">
De Vries, H.; Strub, F.; Mary, J.; Larochelle, H.; Pietquin, O.; and Courville,
A. C.

</span>
<span class="ltx_bibblock">2017.

</span>
<span class="ltx_bibblock">Modulating early visual processing by language.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx8.3.1" class="ltx_text ltx_font_italic">NIPS</span>, 6594–6604.

</span>
</li>
<li id="bib.bibx9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Eigen, Ranzato, and
Sutskever 2013]</span>
<span class="ltx_bibblock">
Eigen, D.; Ranzato, M.; and Sutskever, I.

</span>
<span class="ltx_bibblock">2013.

</span>
<span class="ltx_bibblock">Learning factored representations in a deep mixture of experts.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx9.1.1" class="ltx_text ltx_font_italic">ICLR</span>.

</span>
</li>
<li id="bib.bibx10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Fukui et al<span id="bib.bibx10.1.1.1" class="ltx_text">.</span> 2016]</span>
<span class="ltx_bibblock">
Fukui, A.; Park, D. H.; Yang, D.; Rohrbach, A.; Darrell, T.; and Rohrbach, M.

</span>
<span class="ltx_bibblock">2016.

</span>
<span class="ltx_bibblock">Multimodal compact bilinear pooling for visual question answering and
visual grounding.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx10.3.1" class="ltx_text ltx_font_italic">EMNLP</span>.

</span>
</li>
<li id="bib.bibx11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Gao et al<span id="bib.bibx11.1.1.1" class="ltx_text">.</span> 2018]</span>
<span class="ltx_bibblock">
Gao, P.; Li, H.; Li, S.; Lu, P.; Li, Y.; Hoi, S. C.; and Wang, X.

</span>
<span class="ltx_bibblock">2018.

</span>
<span class="ltx_bibblock">Question-guided hybrid convolution for visual question answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx11.3.1" class="ltx_text ltx_font_italic">ECCV</span>.

</span>
</li>
<li id="bib.bibx12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Goyal et al<span id="bib.bibx12.1.1.1" class="ltx_text">.</span> 2017]</span>
<span class="ltx_bibblock">
Goyal, P.; Dollár, P.; Girshick, R.; Noordhuis, P.; Wesolowski, L.; Kyrola,
A.; Tulloch, A.; Jia, Y.; and He, K.

</span>
<span class="ltx_bibblock">2017.

</span>
<span class="ltx_bibblock">Accurate, large minibatch sgd: Training imagenet in 1 hour.

</span>
<span class="ltx_bibblock"><span id="bib.bibx12.3.1" class="ltx_text ltx_font_italic">CoRR</span> abs/1706.02677.

</span>
</li>
<li id="bib.bibx13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[He et al<span id="bib.bibx13.1.1.1" class="ltx_text">.</span> 2016]</span>
<span class="ltx_bibblock">
He, K.; Zhang, X.; Ren, S.; and Sun, J.

</span>
<span class="ltx_bibblock">2016.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx13.3.1" class="ltx_text ltx_font_italic">CVPR</span>, 770–778.

</span>
</li>
<li id="bib.bibx14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Hochreiter and
Schmidhuber 1997]</span>
<span class="ltx_bibblock">
Hochreiter, S., and Schmidhuber, J.

</span>
<span class="ltx_bibblock">1997.

</span>
<span class="ltx_bibblock">Long short-term memory.

</span>
<span class="ltx_bibblock"><span id="bib.bibx14.1.1" class="ltx_text ltx_font_italic">Neural computation</span> 9(8):1735–1780.

</span>
</li>
<li id="bib.bibx15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Hu et al<span id="bib.bibx15.1.1.1" class="ltx_text">.</span> 2017]</span>
<span class="ltx_bibblock">
Hu, R.; Andreas, J.; Rohrbach, M.; Darrell, T.; and Saenko, K.

</span>
<span class="ltx_bibblock">2017.

</span>
<span class="ltx_bibblock">Learning to reason: End-to-end module networks for visual question
answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx15.3.1" class="ltx_text ltx_font_italic">ICCV</span>.

</span>
</li>
<li id="bib.bibx16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Hudson and
Manning 2018]</span>
<span class="ltx_bibblock">
Hudson, D. A., and Manning, C. D.

</span>
<span class="ltx_bibblock">2018.

</span>
<span class="ltx_bibblock">Compositional attention networks for machine reasoning.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx16.1.1" class="ltx_text ltx_font_italic">ICLR</span>.

</span>
</li>
<li id="bib.bibx17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Ioffe and Szegedy 2015]</span>
<span class="ltx_bibblock">
Ioffe, S., and Szegedy, C.

</span>
<span class="ltx_bibblock">2015.

</span>
<span class="ltx_bibblock">Batch normalization: Accelerating deep network training by reducing
internal covariate shift.

</span>
<span class="ltx_bibblock"><span id="bib.bibx17.1.1" class="ltx_text ltx_font_italic">CoRR</span> abs/1502.03167.

</span>
</li>
<li id="bib.bibx18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Jacobs et al<span id="bib.bibx18.1.1.1" class="ltx_text">.</span> 1991]</span>
<span class="ltx_bibblock">
Jacobs, R. A.; Jordan, M. I.; Nowlan, S. J.; Hinton, G. E.; et al.

</span>
<span class="ltx_bibblock">1991.

</span>
<span class="ltx_bibblock">Adaptive mixtures of local experts.

</span>
<span class="ltx_bibblock"><span id="bib.bibx18.3.1" class="ltx_text ltx_font_italic">Neural computation</span> 3(1):79–87.

</span>
</li>
<li id="bib.bibx19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Jang, Gu, and
Poole 2017]</span>
<span class="ltx_bibblock">
Jang, E.; Gu, S.; and Poole, B.

</span>
<span class="ltx_bibblock">2017.

</span>
<span class="ltx_bibblock">Categorical reparameterization with gumbel-softmax.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx19.1.1" class="ltx_text ltx_font_italic">ICLR</span>.

</span>
</li>
<li id="bib.bibx20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Johnson et al<span id="bib.bibx20.1.1.1" class="ltx_text">.</span> 2017a]</span>
<span class="ltx_bibblock">
Johnson, J.; Hariharan, B.; van der Maaten, L.; Fei-Fei, L.; Lawrence Zitnick,
C.; and Girshick, R.

</span>
<span class="ltx_bibblock">2017a.

</span>
<span class="ltx_bibblock">Clevr: A diagnostic dataset for compositional language and elementary
visual reasoning.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx20.3.1" class="ltx_text ltx_font_italic">CVPR</span>, 2901–2910.

</span>
</li>
<li id="bib.bibx21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Johnson et al<span id="bib.bibx21.1.1.1" class="ltx_text">.</span> 2017b]</span>
<span class="ltx_bibblock">
Johnson, J.; Hariharan, B.; van der Maaten, L.; Hoffman, J.; Fei-Fei, L.;
Lawrence Zitnick, C.; and Girshick, R.

</span>
<span class="ltx_bibblock">2017b.

</span>
<span class="ltx_bibblock">Inferring and executing programs for visual reasoning.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx21.3.1" class="ltx_text ltx_font_italic">ICCV</span>.

</span>
</li>
<li id="bib.bibx22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Jordan and
Jacobs 1994]</span>
<span class="ltx_bibblock">
Jordan, M. I., and Jacobs, R. A.

</span>
<span class="ltx_bibblock">1994.

</span>
<span class="ltx_bibblock">Hierarchical mixtures of experts and the em algorithm.

</span>
<span class="ltx_bibblock"><span id="bib.bibx22.1.1" class="ltx_text ltx_font_italic">Neural computation</span> 6(2):181–214.

</span>
</li>
<li id="bib.bibx23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Kazemi and Elqursh 2017]</span>
<span class="ltx_bibblock">
Kazemi, V., and Elqursh, A.

</span>
<span class="ltx_bibblock">2017.

</span>
<span class="ltx_bibblock">Show, ask, attend, and answer: A strong baseline for visual question
answering.

</span>
<span class="ltx_bibblock"><span id="bib.bibx23.1.1" class="ltx_text ltx_font_italic">CoRR</span> abs/1704.03162.

</span>
</li>
<li id="bib.bibx24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Kim et al<span id="bib.bibx24.1.1.1" class="ltx_text">.</span> 2016]</span>
<span class="ltx_bibblock">
Kim, J.-H.; Lee, S.-W.; Kwak, D.-H.; Heo, M.-O.; Kim, J.; Ha, J.-W.; and Zhang,
B.-T.

</span>
<span class="ltx_bibblock">2016.

</span>
<span class="ltx_bibblock">Multimodal residual learning for visual qa.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx24.3.1" class="ltx_text ltx_font_italic">NIPS</span>.

</span>
</li>
<li id="bib.bibx25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Kingma and Ba 2015]</span>
<span class="ltx_bibblock">
Kingma, D. P., and Ba, J.

</span>
<span class="ltx_bibblock">2015.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx25.1.1" class="ltx_text ltx_font_italic">ICLR</span>.

</span>
</li>
<li id="bib.bibx26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Kirsch, Kunze, and
Barber 2018]</span>
<span class="ltx_bibblock">
Kirsch, L.; Kunze, J.; and Barber, D.

</span>
<span class="ltx_bibblock">2018.

</span>
<span class="ltx_bibblock">Modular networks: Learning to decompose neural computation.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx26.1.1" class="ltx_text ltx_font_italic">NeurIPS</span>.

</span>
</li>
<li id="bib.bibx27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Maaten and
Hinton 2008]</span>
<span class="ltx_bibblock">
Maaten, L. v. d., and Hinton, G.

</span>
<span class="ltx_bibblock">2008.

</span>
<span class="ltx_bibblock">Visualizing data using t-sne.

</span>
<span class="ltx_bibblock"><span id="bib.bibx27.1.1" class="ltx_text ltx_font_italic">Journal of machine learning research</span> 9(Nov):2579–2605.

</span>
</li>
<li id="bib.bibx28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Maddison, Mnih, and
Teh 2017]</span>
<span class="ltx_bibblock">
Maddison, C. J.; Mnih, A.; and Teh, Y. W.

</span>
<span class="ltx_bibblock">2017.

</span>
<span class="ltx_bibblock">The concrete distribution: A continuous relaxation of discrete random
variables.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx28.1.1" class="ltx_text ltx_font_italic">ICLR</span>.

</span>
</li>
<li id="bib.bibx29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Malinowski, Rohrbach, and
Fritz 2015]</span>
<span class="ltx_bibblock">
Malinowski, M.; Rohrbach, M.; and Fritz, M.

</span>
<span class="ltx_bibblock">2015.

</span>
<span class="ltx_bibblock">Ask your neurons: A neural-based approach to answering questions
about images.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx29.1.1" class="ltx_text ltx_font_italic">ICCV</span>, 1–9.

</span>
</li>
<li id="bib.bibx30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Mao et al<span id="bib.bibx30.1.1.1" class="ltx_text">.</span> 2019]</span>
<span class="ltx_bibblock">
Mao, J.; Gan, C.; Kohli, P.; Tenenbaum, J. B.; and Wu, J.

</span>
<span class="ltx_bibblock">2019.

</span>
<span class="ltx_bibblock">The neuro-symbolic concept learner: Interpreting scenes, words, and
sentences from natural supervision.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx30.3.1" class="ltx_text ltx_font_italic">ICLR</span>.

</span>
</li>
<li id="bib.bibx31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Mascharka et al<span id="bib.bibx31.1.1.1" class="ltx_text">.</span> 2018]</span>
<span class="ltx_bibblock">
Mascharka, D.; Tran, P.; Soklaski, R.; and Majumdar, A.

</span>
<span class="ltx_bibblock">2018.

</span>
<span class="ltx_bibblock">Transparency by design: Closing the gap between performance and
interpretability in visual reasoning.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx31.3.1" class="ltx_text ltx_font_italic">CVPR</span>.

</span>
</li>
<li id="bib.bibx32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Olah, Mordvintsev, and
Schubert 2017]</span>
<span class="ltx_bibblock">
Olah, C.; Mordvintsev, A.; and Schubert, L.

</span>
<span class="ltx_bibblock">2017.

</span>
<span class="ltx_bibblock">Feature visualization.

</span>
<span class="ltx_bibblock"><span id="bib.bibx32.1.1" class="ltx_text ltx_font_italic">Distill</span>.

</span>
<span class="ltx_bibblock">https://distill.pub/2017/feature-visualization.

</span>
</li>
<li id="bib.bibx33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Perez et al<span id="bib.bibx33.1.1.1" class="ltx_text">.</span> 2018]</span>
<span class="ltx_bibblock">
Perez, E.; Strub, F.; De Vries, H.; Dumoulin, V.; and Courville, A.

</span>
<span class="ltx_bibblock">2018.

</span>
<span class="ltx_bibblock">Film: Visual reasoning with a general conditioning layer.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx33.3.1" class="ltx_text ltx_font_italic">AAAI</span>.

</span>
</li>
<li id="bib.bibx34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Ramachandran and
Le 2019]</span>
<span class="ltx_bibblock">
Ramachandran, P., and Le, Q. V.

</span>
<span class="ltx_bibblock">2019.

</span>
<span class="ltx_bibblock">Diversity and depth in per-example routing models.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx34.1.1" class="ltx_text ltx_font_italic">ICLR</span>.

</span>
</li>
<li id="bib.bibx35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Rosenbaum, Klinger, and
Riemer 2018]</span>
<span class="ltx_bibblock">
Rosenbaum, C.; Klinger, T.; and Riemer, M.

</span>
<span class="ltx_bibblock">2018.

</span>
<span class="ltx_bibblock">Routing networks: Adaptive selection of non-linear functions for
multi-task learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx35.1.1" class="ltx_text ltx_font_italic">ICLR</span>.

</span>
</li>
<li id="bib.bibx36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Santoro et al<span id="bib.bibx36.1.1.1" class="ltx_text">.</span> 2017]</span>
<span class="ltx_bibblock">
Santoro, A.; Raposo, D.; Barrett, D. G.; Malinowski, M.; Pascanu, R.;
Battaglia, P.; and Lillicrap, T.

</span>
<span class="ltx_bibblock">2017.

</span>
<span class="ltx_bibblock">A simple neural network module for relational reasoning.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx36.3.1" class="ltx_text ltx_font_italic">NIPS</span>.

</span>
</li>
<li id="bib.bibx37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Shazeer et al<span id="bib.bibx37.1.1.1" class="ltx_text">.</span> 2017]</span>
<span class="ltx_bibblock">
Shazeer, N.; Mirhoseini, A.; Maziarz, K.; Davis, A.; Le, Q. V.; Hinton, G. E.;
and Dean, J.

</span>
<span class="ltx_bibblock">2017.

</span>
<span class="ltx_bibblock">Outrageously large neural networks: The sparsely-gated
mixture-of-experts layer.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx37.3.1" class="ltx_text ltx_font_italic">ICLR</span>.

</span>
</li>
<li id="bib.bibx38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Simonyan and
Zisserman 2014]</span>
<span class="ltx_bibblock">
Simonyan, K., and Zisserman, A.

</span>
<span class="ltx_bibblock">2014.

</span>
<span class="ltx_bibblock">Very deep convolutional networks for large-scale image recognition.

</span>
<span class="ltx_bibblock"><span id="bib.bibx38.1.1" class="ltx_text ltx_font_italic">CoRR</span> abs/1409.1556.

</span>
</li>
<li id="bib.bibx39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Vaswani et al<span id="bib.bibx39.1.1.1" class="ltx_text">.</span> 2017]</span>
<span class="ltx_bibblock">
Vaswani, A.; Shazeer, N.; Parmar, N.; Uszkoreit, J.; Jones, L.; Gomez, A. N.;
Kaiser, Ł.; and Polosukhin, I.

</span>
<span class="ltx_bibblock">2017.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx39.3.1" class="ltx_text ltx_font_italic">NIPS</span>.

</span>
</li>
<li id="bib.bibx40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Veit and
Belongie 2018]</span>
<span class="ltx_bibblock">
Veit, A., and Belongie, S. J.

</span>
<span class="ltx_bibblock">2018.

</span>
<span class="ltx_bibblock">Convolutional networks with adaptive inference graphs.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx40.1.1" class="ltx_text ltx_font_italic">ECCV</span>.

</span>
</li>
<li id="bib.bibx41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Wu et al<span id="bib.bibx41.1.1.1" class="ltx_text">.</span> 2018a]</span>
<span class="ltx_bibblock">
Wu, C.; Liu, J.; Wang, X.; and Dong, X.

</span>
<span class="ltx_bibblock">2018a.

</span>
<span class="ltx_bibblock">Object-difference attention: A simple relational attention for visual
question answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx41.3.1" class="ltx_text ltx_font_italic">2018 ACM Multimedia Conference on Multimedia Conference</span>,
519–527.

</span>
<span class="ltx_bibblock">ACM.

</span>
</li>
<li id="bib.bibx42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Wu et al<span id="bib.bibx42.1.1.1" class="ltx_text">.</span> 2018b]</span>
<span class="ltx_bibblock">
Wu, Z.; Nagarajan, T.; Kumar, A.; Rennie, S.; Davis, L. S.; Grauman, K.; and
Feris, R. S.

</span>
<span class="ltx_bibblock">2018b.

</span>
<span class="ltx_bibblock">Blockdrop: Dynamic inference paths in residual networks.

</span>
<span class="ltx_bibblock"><span id="bib.bibx42.3.1" class="ltx_text ltx_font_italic">CVPR</span>.

</span>
</li>
<li id="bib.bibx43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Xie et al<span id="bib.bibx43.1.1.1" class="ltx_text">.</span> 2017]</span>
<span class="ltx_bibblock">
Xie, S.; Girshick, R. B.; Dollár, P.; Tu, Z.; and He, K.

</span>
<span class="ltx_bibblock">2017.

</span>
<span class="ltx_bibblock">Aggregated residual transformations for deep neural networks.

</span>
<span class="ltx_bibblock"><span id="bib.bibx43.3.1" class="ltx_text ltx_font_italic">CVPR</span> 5987–5995.

</span>
</li>
<li id="bib.bibx44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Yang et al<span id="bib.bibx44.1.1.1" class="ltx_text">.</span> 2016]</span>
<span class="ltx_bibblock">
Yang, Z.; He, X.; Gao, J.; Deng, L.; and Smola, A.

</span>
<span class="ltx_bibblock">2016.

</span>
<span class="ltx_bibblock">Stacked attention networks for image question answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx44.3.1" class="ltx_text ltx_font_italic">CVPR</span>, 21–29.

</span>
</li>
<li id="bib.bibx45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Yellott Jr 1977]</span>
<span class="ltx_bibblock">
Yellott Jr, J. I.

</span>
<span class="ltx_bibblock">1977.

</span>
<span class="ltx_bibblock">The relationship between luce’s choice axiom, thurstone’s theory of
comparative judgment, and the double exponential distribution.

</span>
<span class="ltx_bibblock"><span id="bib.bibx45.1.1" class="ltx_text ltx_font_italic">Journal of Mathematical Psychology</span> 15(2):109–144.

</span>
</li>
<li id="bib.bibx46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Zhou et al<span id="bib.bibx46.1.1.1" class="ltx_text">.</span> 2015]</span>
<span class="ltx_bibblock">
Zhou, B.; Tian, Y.; Sukhbaatar, S.; Szlam, A.; and Fergus, R.

</span>
<span class="ltx_bibblock">2015.

</span>
<span class="ltx_bibblock">Simple baseline for visual question answering.

</span>
<span class="ltx_bibblock"><span id="bib.bibx46.3.1" class="ltx_text ltx_font_italic">CoRR</span> abs/1512.02167.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Saliency map examples</h2>

<figure id="A1.F5" class="ltx_figure"><img src="/html/1904.08324/assets/fig/examples_all4.png" id="A1.F5.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="454" height="856" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>More saliency map examples with respect to different questions.</figcaption>
</figure>
<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p">We provide several saliency maps to illustrate the key pixels conditioned on the question in Figure <a href="#A1.F5" title="Figure 5 ‣ Appendix A Saliency map examples ‣ Question Guided Modular Routing Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Pseudocode of routing algorithm</h2>

<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Pseudocode of routing algorithm</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l0" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">0:</span>  question feature <math id="alg1.l0.m1.1" class="ltx_Math" alttext="\mathbf{q}" display="inline"><semantics id="alg1.l0.m1.1a"><mi id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml">𝐪</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.1b"><ci id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1">𝐪</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.1c">\mathbf{q}</annotation></semantics></math>; shape of routing path <math id="alg1.l0.m2.1" class="ltx_Math" alttext="L" display="inline"><semantics id="alg1.l0.m2.1a"><mi id="alg1.l0.m2.1.1" xref="alg1.l0.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.1b"><ci id="alg1.l0.m2.1.1.cmml" xref="alg1.l0.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.1c">L</annotation></semantics></math> and <math id="alg1.l0.m3.1" class="ltx_Math" alttext="M" display="inline"><semantics id="alg1.l0.m3.1a"><mi id="alg1.l0.m3.1.1" xref="alg1.l0.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m3.1b"><ci id="alg1.l0.m3.1.1.cmml" xref="alg1.l0.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m3.1c">M</annotation></semantics></math>; temperature <math id="alg1.l0.m4.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="alg1.l0.m4.1a"><mi id="alg1.l0.m4.1.1" xref="alg1.l0.m4.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m4.1b"><ci id="alg1.l0.m4.1.1.cmml" xref="alg1.l0.m4.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m4.1c">\tau</annotation></semantics></math>

</div>
<div id="alg1.l0a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">0:</span>  routing path <math id="alg1.l0a.m1.1" class="ltx_Math" alttext="\mathbf{P}" display="inline"><semantics id="alg1.l0a.m1.1a"><mi id="alg1.l0a.m1.1.1" xref="alg1.l0a.m1.1.1.cmml">𝐏</mi><annotation-xml encoding="MathML-Content" id="alg1.l0a.m1.1b"><ci id="alg1.l0a.m1.1.1.cmml" xref="alg1.l0a.m1.1.1">𝐏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m1.1c">\mathbf{P}</annotation></semantics></math>
/* Sample from Logistic distribution */

</div>
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span>  First Sample a random tensor from Uniform distribution <math id="alg1.l1.m1.3" class="ltx_Math" alttext="\textnormal{u}\sim\text{Uniform}([0,1]^{L\times M})" display="inline"><semantics id="alg1.l1.m1.3a"><mrow id="alg1.l1.m1.3.3" xref="alg1.l1.m1.3.3.cmml"><mtext id="alg1.l1.m1.3.3.3" xref="alg1.l1.m1.3.3.3a.cmml">u</mtext><mo id="alg1.l1.m1.3.3.2" xref="alg1.l1.m1.3.3.2.cmml">∼</mo><mrow id="alg1.l1.m1.3.3.1" xref="alg1.l1.m1.3.3.1.cmml"><mtext id="alg1.l1.m1.3.3.1.3" xref="alg1.l1.m1.3.3.1.3a.cmml">Uniform</mtext><mo lspace="0em" rspace="0em" id="alg1.l1.m1.3.3.1.2" xref="alg1.l1.m1.3.3.1.2.cmml">​</mo><mrow id="alg1.l1.m1.3.3.1.1.1" xref="alg1.l1.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l1.m1.3.3.1.1.1.2" xref="alg1.l1.m1.3.3.1.1.1.1.cmml">(</mo><msup id="alg1.l1.m1.3.3.1.1.1.1" xref="alg1.l1.m1.3.3.1.1.1.1.cmml"><mrow id="alg1.l1.m1.3.3.1.1.1.1.2.2" xref="alg1.l1.m1.3.3.1.1.1.1.2.1.cmml"><mo stretchy="false" id="alg1.l1.m1.3.3.1.1.1.1.2.2.1" xref="alg1.l1.m1.3.3.1.1.1.1.2.1.cmml">[</mo><mn id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">0</mn><mo id="alg1.l1.m1.3.3.1.1.1.1.2.2.2" xref="alg1.l1.m1.3.3.1.1.1.1.2.1.cmml">,</mo><mn id="alg1.l1.m1.2.2" xref="alg1.l1.m1.2.2.cmml">1</mn><mo stretchy="false" id="alg1.l1.m1.3.3.1.1.1.1.2.2.3" xref="alg1.l1.m1.3.3.1.1.1.1.2.1.cmml">]</mo></mrow><mrow id="alg1.l1.m1.3.3.1.1.1.1.3" xref="alg1.l1.m1.3.3.1.1.1.1.3.cmml"><mi id="alg1.l1.m1.3.3.1.1.1.1.3.2" xref="alg1.l1.m1.3.3.1.1.1.1.3.2.cmml">L</mi><mo lspace="0.222em" rspace="0.222em" id="alg1.l1.m1.3.3.1.1.1.1.3.1" xref="alg1.l1.m1.3.3.1.1.1.1.3.1.cmml">×</mo><mi id="alg1.l1.m1.3.3.1.1.1.1.3.3" xref="alg1.l1.m1.3.3.1.1.1.1.3.3.cmml">M</mi></mrow></msup><mo stretchy="false" id="alg1.l1.m1.3.3.1.1.1.3" xref="alg1.l1.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.3b"><apply id="alg1.l1.m1.3.3.cmml" xref="alg1.l1.m1.3.3"><csymbol cd="latexml" id="alg1.l1.m1.3.3.2.cmml" xref="alg1.l1.m1.3.3.2">similar-to</csymbol><ci id="alg1.l1.m1.3.3.3a.cmml" xref="alg1.l1.m1.3.3.3"><mtext id="alg1.l1.m1.3.3.3.cmml" xref="alg1.l1.m1.3.3.3">u</mtext></ci><apply id="alg1.l1.m1.3.3.1.cmml" xref="alg1.l1.m1.3.3.1"><times id="alg1.l1.m1.3.3.1.2.cmml" xref="alg1.l1.m1.3.3.1.2"></times><ci id="alg1.l1.m1.3.3.1.3a.cmml" xref="alg1.l1.m1.3.3.1.3"><mtext id="alg1.l1.m1.3.3.1.3.cmml" xref="alg1.l1.m1.3.3.1.3">Uniform</mtext></ci><apply id="alg1.l1.m1.3.3.1.1.1.1.cmml" xref="alg1.l1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l1.m1.3.3.1.1.1">superscript</csymbol><interval closure="closed" id="alg1.l1.m1.3.3.1.1.1.1.2.1.cmml" xref="alg1.l1.m1.3.3.1.1.1.1.2.2"><cn type="integer" id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">0</cn><cn type="integer" id="alg1.l1.m1.2.2.cmml" xref="alg1.l1.m1.2.2">1</cn></interval><apply id="alg1.l1.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l1.m1.3.3.1.1.1.1.3"><times id="alg1.l1.m1.3.3.1.1.1.1.3.1.cmml" xref="alg1.l1.m1.3.3.1.1.1.1.3.1"></times><ci id="alg1.l1.m1.3.3.1.1.1.1.3.2.cmml" xref="alg1.l1.m1.3.3.1.1.1.1.3.2">𝐿</ci><ci id="alg1.l1.m1.3.3.1.1.1.1.3.3.cmml" xref="alg1.l1.m1.3.3.1.1.1.1.3.3">𝑀</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.3c">\textnormal{u}\sim\text{Uniform}([0,1]^{L\times M})</annotation></semantics></math>, where <math id="alg1.l1.m2.1" class="ltx_Math" alttext="\textnormal{u}\in\mathbb{R}^{L\times M}" display="inline"><semantics id="alg1.l1.m2.1a"><mrow id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mtext id="alg1.l1.m2.1.1.2" xref="alg1.l1.m2.1.1.2a.cmml">u</mtext><mo id="alg1.l1.m2.1.1.1" xref="alg1.l1.m2.1.1.1.cmml">∈</mo><msup id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3.cmml"><mi id="alg1.l1.m2.1.1.3.2" xref="alg1.l1.m2.1.1.3.2.cmml">ℝ</mi><mrow id="alg1.l1.m2.1.1.3.3" xref="alg1.l1.m2.1.1.3.3.cmml"><mi id="alg1.l1.m2.1.1.3.3.2" xref="alg1.l1.m2.1.1.3.3.2.cmml">L</mi><mo lspace="0.222em" rspace="0.222em" id="alg1.l1.m2.1.1.3.3.1" xref="alg1.l1.m2.1.1.3.3.1.cmml">×</mo><mi id="alg1.l1.m2.1.1.3.3.3" xref="alg1.l1.m2.1.1.3.3.3.cmml">M</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><in id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1.1"></in><ci id="alg1.l1.m2.1.1.2a.cmml" xref="alg1.l1.m2.1.1.2"><mtext id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1.2">u</mtext></ci><apply id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.3.1.cmml" xref="alg1.l1.m2.1.1.3">superscript</csymbol><ci id="alg1.l1.m2.1.1.3.2.cmml" xref="alg1.l1.m2.1.1.3.2">ℝ</ci><apply id="alg1.l1.m2.1.1.3.3.cmml" xref="alg1.l1.m2.1.1.3.3"><times id="alg1.l1.m2.1.1.3.3.1.cmml" xref="alg1.l1.m2.1.1.3.3.1"></times><ci id="alg1.l1.m2.1.1.3.3.2.cmml" xref="alg1.l1.m2.1.1.3.3.2">𝐿</ci><ci id="alg1.l1.m2.1.1.3.3.3.cmml" xref="alg1.l1.m2.1.1.3.3.3">𝑀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">\textnormal{u}\in\mathbb{R}^{L\times M}</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span>  Then compute <math id="alg1.l2.m1.4" class="ltx_Math" alttext="\textnormal{t}\leftarrow\log(\textnormal{u})-\log(1-\textnormal{u})" display="inline"><semantics id="alg1.l2.m1.4a"><mrow id="alg1.l2.m1.4.4" xref="alg1.l2.m1.4.4.cmml"><mtext id="alg1.l2.m1.4.4.3" xref="alg1.l2.m1.4.4.3a.cmml">t</mtext><mo stretchy="false" id="alg1.l2.m1.4.4.2" xref="alg1.l2.m1.4.4.2.cmml">←</mo><mrow id="alg1.l2.m1.4.4.1" xref="alg1.l2.m1.4.4.1.cmml"><mrow id="alg1.l2.m1.4.4.1.3.2" xref="alg1.l2.m1.4.4.1.3.1.cmml"><mi id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">log</mi><mo id="alg1.l2.m1.4.4.1.3.2a" xref="alg1.l2.m1.4.4.1.3.1.cmml">⁡</mo><mrow id="alg1.l2.m1.4.4.1.3.2.1" xref="alg1.l2.m1.4.4.1.3.1.cmml"><mo stretchy="false" id="alg1.l2.m1.4.4.1.3.2.1.1" xref="alg1.l2.m1.4.4.1.3.1.cmml">(</mo><mtext id="alg1.l2.m1.2.2" xref="alg1.l2.m1.2.2a.cmml">u</mtext><mo stretchy="false" id="alg1.l2.m1.4.4.1.3.2.1.2" xref="alg1.l2.m1.4.4.1.3.1.cmml">)</mo></mrow></mrow><mo id="alg1.l2.m1.4.4.1.2" xref="alg1.l2.m1.4.4.1.2.cmml">−</mo><mrow id="alg1.l2.m1.4.4.1.1.1" xref="alg1.l2.m1.4.4.1.1.2.cmml"><mi id="alg1.l2.m1.3.3" xref="alg1.l2.m1.3.3.cmml">log</mi><mo id="alg1.l2.m1.4.4.1.1.1a" xref="alg1.l2.m1.4.4.1.1.2.cmml">⁡</mo><mrow id="alg1.l2.m1.4.4.1.1.1.1" xref="alg1.l2.m1.4.4.1.1.2.cmml"><mo stretchy="false" id="alg1.l2.m1.4.4.1.1.1.1.2" xref="alg1.l2.m1.4.4.1.1.2.cmml">(</mo><mrow id="alg1.l2.m1.4.4.1.1.1.1.1" xref="alg1.l2.m1.4.4.1.1.1.1.1.cmml"><mn id="alg1.l2.m1.4.4.1.1.1.1.1.2" xref="alg1.l2.m1.4.4.1.1.1.1.1.2.cmml">1</mn><mo id="alg1.l2.m1.4.4.1.1.1.1.1.1" xref="alg1.l2.m1.4.4.1.1.1.1.1.1.cmml">−</mo><mtext id="alg1.l2.m1.4.4.1.1.1.1.1.3" xref="alg1.l2.m1.4.4.1.1.1.1.1.3a.cmml">u</mtext></mrow><mo stretchy="false" id="alg1.l2.m1.4.4.1.1.1.1.3" xref="alg1.l2.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.4b"><apply id="alg1.l2.m1.4.4.cmml" xref="alg1.l2.m1.4.4"><ci id="alg1.l2.m1.4.4.2.cmml" xref="alg1.l2.m1.4.4.2">←</ci><ci id="alg1.l2.m1.4.4.3a.cmml" xref="alg1.l2.m1.4.4.3"><mtext id="alg1.l2.m1.4.4.3.cmml" xref="alg1.l2.m1.4.4.3">t</mtext></ci><apply id="alg1.l2.m1.4.4.1.cmml" xref="alg1.l2.m1.4.4.1"><minus id="alg1.l2.m1.4.4.1.2.cmml" xref="alg1.l2.m1.4.4.1.2"></minus><apply id="alg1.l2.m1.4.4.1.3.1.cmml" xref="alg1.l2.m1.4.4.1.3.2"><log id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"></log><ci id="alg1.l2.m1.2.2a.cmml" xref="alg1.l2.m1.2.2"><mtext id="alg1.l2.m1.2.2.cmml" xref="alg1.l2.m1.2.2">u</mtext></ci></apply><apply id="alg1.l2.m1.4.4.1.1.2.cmml" xref="alg1.l2.m1.4.4.1.1.1"><log id="alg1.l2.m1.3.3.cmml" xref="alg1.l2.m1.3.3"></log><apply id="alg1.l2.m1.4.4.1.1.1.1.1.cmml" xref="alg1.l2.m1.4.4.1.1.1.1.1"><minus id="alg1.l2.m1.4.4.1.1.1.1.1.1.cmml" xref="alg1.l2.m1.4.4.1.1.1.1.1.1"></minus><cn type="integer" id="alg1.l2.m1.4.4.1.1.1.1.1.2.cmml" xref="alg1.l2.m1.4.4.1.1.1.1.1.2">1</cn><ci id="alg1.l2.m1.4.4.1.1.1.1.1.3a.cmml" xref="alg1.l2.m1.4.4.1.1.1.1.1.3"><mtext id="alg1.l2.m1.4.4.1.1.1.1.1.3.cmml" xref="alg1.l2.m1.4.4.1.1.1.1.1.3">u</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.4c">\textnormal{t}\leftarrow\log(\textnormal{u})-\log(1-\textnormal{u})</annotation></semantics></math>, and <math id="alg1.l2.m2.3" class="ltx_Math" alttext="\textnormal{t}\sim\text{Logistic}([0,1]^{L\times M})" display="inline"><semantics id="alg1.l2.m2.3a"><mrow id="alg1.l2.m2.3.3" xref="alg1.l2.m2.3.3.cmml"><mtext id="alg1.l2.m2.3.3.3" xref="alg1.l2.m2.3.3.3a.cmml">t</mtext><mo id="alg1.l2.m2.3.3.2" xref="alg1.l2.m2.3.3.2.cmml">∼</mo><mrow id="alg1.l2.m2.3.3.1" xref="alg1.l2.m2.3.3.1.cmml"><mtext id="alg1.l2.m2.3.3.1.3" xref="alg1.l2.m2.3.3.1.3a.cmml">Logistic</mtext><mo lspace="0em" rspace="0em" id="alg1.l2.m2.3.3.1.2" xref="alg1.l2.m2.3.3.1.2.cmml">​</mo><mrow id="alg1.l2.m2.3.3.1.1.1" xref="alg1.l2.m2.3.3.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l2.m2.3.3.1.1.1.2" xref="alg1.l2.m2.3.3.1.1.1.1.cmml">(</mo><msup id="alg1.l2.m2.3.3.1.1.1.1" xref="alg1.l2.m2.3.3.1.1.1.1.cmml"><mrow id="alg1.l2.m2.3.3.1.1.1.1.2.2" xref="alg1.l2.m2.3.3.1.1.1.1.2.1.cmml"><mo stretchy="false" id="alg1.l2.m2.3.3.1.1.1.1.2.2.1" xref="alg1.l2.m2.3.3.1.1.1.1.2.1.cmml">[</mo><mn id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml">0</mn><mo id="alg1.l2.m2.3.3.1.1.1.1.2.2.2" xref="alg1.l2.m2.3.3.1.1.1.1.2.1.cmml">,</mo><mn id="alg1.l2.m2.2.2" xref="alg1.l2.m2.2.2.cmml">1</mn><mo stretchy="false" id="alg1.l2.m2.3.3.1.1.1.1.2.2.3" xref="alg1.l2.m2.3.3.1.1.1.1.2.1.cmml">]</mo></mrow><mrow id="alg1.l2.m2.3.3.1.1.1.1.3" xref="alg1.l2.m2.3.3.1.1.1.1.3.cmml"><mi id="alg1.l2.m2.3.3.1.1.1.1.3.2" xref="alg1.l2.m2.3.3.1.1.1.1.3.2.cmml">L</mi><mo lspace="0.222em" rspace="0.222em" id="alg1.l2.m2.3.3.1.1.1.1.3.1" xref="alg1.l2.m2.3.3.1.1.1.1.3.1.cmml">×</mo><mi id="alg1.l2.m2.3.3.1.1.1.1.3.3" xref="alg1.l2.m2.3.3.1.1.1.1.3.3.cmml">M</mi></mrow></msup><mo stretchy="false" id="alg1.l2.m2.3.3.1.1.1.3" xref="alg1.l2.m2.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.3b"><apply id="alg1.l2.m2.3.3.cmml" xref="alg1.l2.m2.3.3"><csymbol cd="latexml" id="alg1.l2.m2.3.3.2.cmml" xref="alg1.l2.m2.3.3.2">similar-to</csymbol><ci id="alg1.l2.m2.3.3.3a.cmml" xref="alg1.l2.m2.3.3.3"><mtext id="alg1.l2.m2.3.3.3.cmml" xref="alg1.l2.m2.3.3.3">t</mtext></ci><apply id="alg1.l2.m2.3.3.1.cmml" xref="alg1.l2.m2.3.3.1"><times id="alg1.l2.m2.3.3.1.2.cmml" xref="alg1.l2.m2.3.3.1.2"></times><ci id="alg1.l2.m2.3.3.1.3a.cmml" xref="alg1.l2.m2.3.3.1.3"><mtext id="alg1.l2.m2.3.3.1.3.cmml" xref="alg1.l2.m2.3.3.1.3">Logistic</mtext></ci><apply id="alg1.l2.m2.3.3.1.1.1.1.cmml" xref="alg1.l2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m2.3.3.1.1.1.1.1.cmml" xref="alg1.l2.m2.3.3.1.1.1">superscript</csymbol><interval closure="closed" id="alg1.l2.m2.3.3.1.1.1.1.2.1.cmml" xref="alg1.l2.m2.3.3.1.1.1.1.2.2"><cn type="integer" id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1">0</cn><cn type="integer" id="alg1.l2.m2.2.2.cmml" xref="alg1.l2.m2.2.2">1</cn></interval><apply id="alg1.l2.m2.3.3.1.1.1.1.3.cmml" xref="alg1.l2.m2.3.3.1.1.1.1.3"><times id="alg1.l2.m2.3.3.1.1.1.1.3.1.cmml" xref="alg1.l2.m2.3.3.1.1.1.1.3.1"></times><ci id="alg1.l2.m2.3.3.1.1.1.1.3.2.cmml" xref="alg1.l2.m2.3.3.1.1.1.1.3.2">𝐿</ci><ci id="alg1.l2.m2.3.3.1.1.1.1.3.3.cmml" xref="alg1.l2.m2.3.3.1.1.1.1.3.3">𝑀</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.3c">\textnormal{t}\sim\text{Logistic}([0,1]^{L\times M})</annotation></semantics></math>
/* Compute routing path */

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span>  First use a fc layer to get the real-valued routing path <math id="alg1.l3.m1.1" class="ltx_Math" alttext="\tilde{\mathbf{P}}\leftarrow\text{FC}(\mathbf{q})" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.2" xref="alg1.l3.m1.1.2.cmml"><mover accent="true" id="alg1.l3.m1.1.2.2" xref="alg1.l3.m1.1.2.2.cmml"><mi id="alg1.l3.m1.1.2.2.2" xref="alg1.l3.m1.1.2.2.2.cmml">𝐏</mi><mo id="alg1.l3.m1.1.2.2.1" xref="alg1.l3.m1.1.2.2.1.cmml">~</mo></mover><mo stretchy="false" id="alg1.l3.m1.1.2.1" xref="alg1.l3.m1.1.2.1.cmml">←</mo><mrow id="alg1.l3.m1.1.2.3" xref="alg1.l3.m1.1.2.3.cmml"><mtext id="alg1.l3.m1.1.2.3.2" xref="alg1.l3.m1.1.2.3.2a.cmml">FC</mtext><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.2.3.1" xref="alg1.l3.m1.1.2.3.1.cmml">​</mo><mrow id="alg1.l3.m1.1.2.3.3.2" xref="alg1.l3.m1.1.2.3.cmml"><mo stretchy="false" id="alg1.l3.m1.1.2.3.3.2.1" xref="alg1.l3.m1.1.2.3.cmml">(</mo><mi id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">𝐪</mi><mo stretchy="false" id="alg1.l3.m1.1.2.3.3.2.2" xref="alg1.l3.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.2.cmml" xref="alg1.l3.m1.1.2"><ci id="alg1.l3.m1.1.2.1.cmml" xref="alg1.l3.m1.1.2.1">←</ci><apply id="alg1.l3.m1.1.2.2.cmml" xref="alg1.l3.m1.1.2.2"><ci id="alg1.l3.m1.1.2.2.1.cmml" xref="alg1.l3.m1.1.2.2.1">~</ci><ci id="alg1.l3.m1.1.2.2.2.cmml" xref="alg1.l3.m1.1.2.2.2">𝐏</ci></apply><apply id="alg1.l3.m1.1.2.3.cmml" xref="alg1.l3.m1.1.2.3"><times id="alg1.l3.m1.1.2.3.1.cmml" xref="alg1.l3.m1.1.2.3.1"></times><ci id="alg1.l3.m1.1.2.3.2a.cmml" xref="alg1.l3.m1.1.2.3.2"><mtext id="alg1.l3.m1.1.2.3.2.cmml" xref="alg1.l3.m1.1.2.3.2">FC</mtext></ci><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">𝐪</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\tilde{\mathbf{P}}\leftarrow\text{FC}(\mathbf{q})</annotation></semantics></math>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>  Then use Gumbel-Sigmoid trick to compute random tensor <math id="alg1.l4.m1.1" class="ltx_Math" alttext="\tilde{\mathbf{B}}\leftarrow\text{Sigmoid}(\frac{\textnormal{t}+\tilde{\mathbf{P}}}{\tau})" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.2" xref="alg1.l4.m1.1.2.cmml"><mover accent="true" id="alg1.l4.m1.1.2.2" xref="alg1.l4.m1.1.2.2.cmml"><mi id="alg1.l4.m1.1.2.2.2" xref="alg1.l4.m1.1.2.2.2.cmml">𝐁</mi><mo id="alg1.l4.m1.1.2.2.1" xref="alg1.l4.m1.1.2.2.1.cmml">~</mo></mover><mo stretchy="false" id="alg1.l4.m1.1.2.1" xref="alg1.l4.m1.1.2.1.cmml">←</mo><mrow id="alg1.l4.m1.1.2.3" xref="alg1.l4.m1.1.2.3.cmml"><mtext id="alg1.l4.m1.1.2.3.2" xref="alg1.l4.m1.1.2.3.2a.cmml">Sigmoid</mtext><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.2.3.1" xref="alg1.l4.m1.1.2.3.1.cmml">​</mo><mrow id="alg1.l4.m1.1.2.3.3.2" xref="alg1.l4.m1.1.1.cmml"><mo stretchy="false" id="alg1.l4.m1.1.2.3.3.2.1" xref="alg1.l4.m1.1.1.cmml">(</mo><mfrac id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mrow id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml"><mtext id="alg1.l4.m1.1.1.2.2" xref="alg1.l4.m1.1.1.2.2a.cmml">t</mtext><mo id="alg1.l4.m1.1.1.2.1" xref="alg1.l4.m1.1.1.2.1.cmml">+</mo><mover accent="true" id="alg1.l4.m1.1.1.2.3" xref="alg1.l4.m1.1.1.2.3.cmml"><mi id="alg1.l4.m1.1.1.2.3.2" xref="alg1.l4.m1.1.1.2.3.2.cmml">𝐏</mi><mo id="alg1.l4.m1.1.1.2.3.1" xref="alg1.l4.m1.1.1.2.3.1.cmml">~</mo></mover></mrow><mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">τ</mi></mfrac><mo stretchy="false" id="alg1.l4.m1.1.2.3.3.2.2" xref="alg1.l4.m1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.2.cmml" xref="alg1.l4.m1.1.2"><ci id="alg1.l4.m1.1.2.1.cmml" xref="alg1.l4.m1.1.2.1">←</ci><apply id="alg1.l4.m1.1.2.2.cmml" xref="alg1.l4.m1.1.2.2"><ci id="alg1.l4.m1.1.2.2.1.cmml" xref="alg1.l4.m1.1.2.2.1">~</ci><ci id="alg1.l4.m1.1.2.2.2.cmml" xref="alg1.l4.m1.1.2.2.2">𝐁</ci></apply><apply id="alg1.l4.m1.1.2.3.cmml" xref="alg1.l4.m1.1.2.3"><times id="alg1.l4.m1.1.2.3.1.cmml" xref="alg1.l4.m1.1.2.3.1"></times><ci id="alg1.l4.m1.1.2.3.2a.cmml" xref="alg1.l4.m1.1.2.3.2"><mtext id="alg1.l4.m1.1.2.3.2.cmml" xref="alg1.l4.m1.1.2.3.2">Sigmoid</mtext></ci><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.2.3.3.2"><divide id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.2.3.3.2"></divide><apply id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2"><plus id="alg1.l4.m1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.2.1"></plus><ci id="alg1.l4.m1.1.1.2.2a.cmml" xref="alg1.l4.m1.1.1.2.2"><mtext mathsize="70%" id="alg1.l4.m1.1.1.2.2.cmml" xref="alg1.l4.m1.1.1.2.2">t</mtext></ci><apply id="alg1.l4.m1.1.1.2.3.cmml" xref="alg1.l4.m1.1.1.2.3"><ci id="alg1.l4.m1.1.1.2.3.1.cmml" xref="alg1.l4.m1.1.1.2.3.1">~</ci><ci id="alg1.l4.m1.1.1.2.3.2.cmml" xref="alg1.l4.m1.1.1.2.3.2">𝐏</ci></apply></apply><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">𝜏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\tilde{\mathbf{B}}\leftarrow\text{Sigmoid}(\frac{\textnormal{t}+\tilde{\mathbf{P}}}{\tau})</annotation></semantics></math>

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>  Threshold <math id="alg1.l5.m1.1" class="ltx_Math" alttext="\tilde{\mathbf{B}}" display="inline"><semantics id="alg1.l5.m1.1a"><mover accent="true" id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">𝐁</mi><mo id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><ci id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1">~</ci><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝐁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\tilde{\mathbf{B}}</annotation></semantics></math> to get the <math id="alg1.l5.m2.1" class="ltx_Math" alttext="\tilde{\mathbf{B}}_{\text{binary}}\leftarrow\tilde{\mathbf{B}}&gt;0.5" display="inline"><semantics id="alg1.l5.m2.1a"><mrow id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml"><msub id="alg1.l5.m2.1.1.2" xref="alg1.l5.m2.1.1.2.cmml"><mover accent="true" id="alg1.l5.m2.1.1.2.2" xref="alg1.l5.m2.1.1.2.2.cmml"><mi id="alg1.l5.m2.1.1.2.2.2" xref="alg1.l5.m2.1.1.2.2.2.cmml">𝐁</mi><mo id="alg1.l5.m2.1.1.2.2.1" xref="alg1.l5.m2.1.1.2.2.1.cmml">~</mo></mover><mtext id="alg1.l5.m2.1.1.2.3" xref="alg1.l5.m2.1.1.2.3a.cmml">binary</mtext></msub><mo stretchy="false" id="alg1.l5.m2.1.1.3" xref="alg1.l5.m2.1.1.3.cmml">←</mo><mover accent="true" id="alg1.l5.m2.1.1.4" xref="alg1.l5.m2.1.1.4.cmml"><mi id="alg1.l5.m2.1.1.4.2" xref="alg1.l5.m2.1.1.4.2.cmml">𝐁</mi><mo id="alg1.l5.m2.1.1.4.1" xref="alg1.l5.m2.1.1.4.1.cmml">~</mo></mover><mo id="alg1.l5.m2.1.1.5" xref="alg1.l5.m2.1.1.5.cmml">&gt;</mo><mn id="alg1.l5.m2.1.1.6" xref="alg1.l5.m2.1.1.6.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1"><and id="alg1.l5.m2.1.1a.cmml" xref="alg1.l5.m2.1.1"></and><apply id="alg1.l5.m2.1.1b.cmml" xref="alg1.l5.m2.1.1"><ci id="alg1.l5.m2.1.1.3.cmml" xref="alg1.l5.m2.1.1.3">←</ci><apply id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.2.1.cmml" xref="alg1.l5.m2.1.1.2">subscript</csymbol><apply id="alg1.l5.m2.1.1.2.2.cmml" xref="alg1.l5.m2.1.1.2.2"><ci id="alg1.l5.m2.1.1.2.2.1.cmml" xref="alg1.l5.m2.1.1.2.2.1">~</ci><ci id="alg1.l5.m2.1.1.2.2.2.cmml" xref="alg1.l5.m2.1.1.2.2.2">𝐁</ci></apply><ci id="alg1.l5.m2.1.1.2.3a.cmml" xref="alg1.l5.m2.1.1.2.3"><mtext mathsize="70%" id="alg1.l5.m2.1.1.2.3.cmml" xref="alg1.l5.m2.1.1.2.3">binary</mtext></ci></apply><apply id="alg1.l5.m2.1.1.4.cmml" xref="alg1.l5.m2.1.1.4"><ci id="alg1.l5.m2.1.1.4.1.cmml" xref="alg1.l5.m2.1.1.4.1">~</ci><ci id="alg1.l5.m2.1.1.4.2.cmml" xref="alg1.l5.m2.1.1.4.2">𝐁</ci></apply></apply><apply id="alg1.l5.m2.1.1c.cmml" xref="alg1.l5.m2.1.1"><gt id="alg1.l5.m2.1.1.5.cmml" xref="alg1.l5.m2.1.1.5"></gt><share href="#alg1.l5.m2.1.1.4.cmml" id="alg1.l5.m2.1.1d.cmml" xref="alg1.l5.m2.1.1"></share><cn type="float" id="alg1.l5.m2.1.1.6.cmml" xref="alg1.l5.m2.1.1.6">0.5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">\tilde{\mathbf{B}}_{\text{binary}}\leftarrow\tilde{\mathbf{B}}&gt;0.5</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>  Finally use Straight-Through (ST) trick (<span id="alg1.l6.1" class="ltx_text ltx_font_bold">?</span>) to compute discrete routing path <math id="alg1.l6.m1.1" class="ltx_Math" alttext="\mathbf{P}\leftarrow\tilde{\mathbf{B}}_{\text{binary}}-\text{detach}(\tilde{\mathbf{B}})+\tilde{\mathbf{B}}" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.2" xref="alg1.l6.m1.1.2.cmml"><mi id="alg1.l6.m1.1.2.2" xref="alg1.l6.m1.1.2.2.cmml">𝐏</mi><mo stretchy="false" id="alg1.l6.m1.1.2.1" xref="alg1.l6.m1.1.2.1.cmml">←</mo><mrow id="alg1.l6.m1.1.2.3" xref="alg1.l6.m1.1.2.3.cmml"><mrow id="alg1.l6.m1.1.2.3.2" xref="alg1.l6.m1.1.2.3.2.cmml"><msub id="alg1.l6.m1.1.2.3.2.2" xref="alg1.l6.m1.1.2.3.2.2.cmml"><mover accent="true" id="alg1.l6.m1.1.2.3.2.2.2" xref="alg1.l6.m1.1.2.3.2.2.2.cmml"><mi id="alg1.l6.m1.1.2.3.2.2.2.2" xref="alg1.l6.m1.1.2.3.2.2.2.2.cmml">𝐁</mi><mo id="alg1.l6.m1.1.2.3.2.2.2.1" xref="alg1.l6.m1.1.2.3.2.2.2.1.cmml">~</mo></mover><mtext id="alg1.l6.m1.1.2.3.2.2.3" xref="alg1.l6.m1.1.2.3.2.2.3a.cmml">binary</mtext></msub><mo id="alg1.l6.m1.1.2.3.2.1" xref="alg1.l6.m1.1.2.3.2.1.cmml">−</mo><mrow id="alg1.l6.m1.1.2.3.2.3" xref="alg1.l6.m1.1.2.3.2.3.cmml"><mtext id="alg1.l6.m1.1.2.3.2.3.2" xref="alg1.l6.m1.1.2.3.2.3.2a.cmml">detach</mtext><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.2.3.2.3.1" xref="alg1.l6.m1.1.2.3.2.3.1.cmml">​</mo><mrow id="alg1.l6.m1.1.2.3.2.3.3.2" xref="alg1.l6.m1.1.1.cmml"><mo stretchy="false" id="alg1.l6.m1.1.2.3.2.3.3.2.1" xref="alg1.l6.m1.1.1.cmml">(</mo><mover accent="true" id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">𝐁</mi><mo id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">~</mo></mover><mo stretchy="false" id="alg1.l6.m1.1.2.3.2.3.3.2.2" xref="alg1.l6.m1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="alg1.l6.m1.1.2.3.1" xref="alg1.l6.m1.1.2.3.1.cmml">+</mo><mover accent="true" id="alg1.l6.m1.1.2.3.3" xref="alg1.l6.m1.1.2.3.3.cmml"><mi id="alg1.l6.m1.1.2.3.3.2" xref="alg1.l6.m1.1.2.3.3.2.cmml">𝐁</mi><mo id="alg1.l6.m1.1.2.3.3.1" xref="alg1.l6.m1.1.2.3.3.1.cmml">~</mo></mover></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.2.cmml" xref="alg1.l6.m1.1.2"><ci id="alg1.l6.m1.1.2.1.cmml" xref="alg1.l6.m1.1.2.1">←</ci><ci id="alg1.l6.m1.1.2.2.cmml" xref="alg1.l6.m1.1.2.2">𝐏</ci><apply id="alg1.l6.m1.1.2.3.cmml" xref="alg1.l6.m1.1.2.3"><plus id="alg1.l6.m1.1.2.3.1.cmml" xref="alg1.l6.m1.1.2.3.1"></plus><apply id="alg1.l6.m1.1.2.3.2.cmml" xref="alg1.l6.m1.1.2.3.2"><minus id="alg1.l6.m1.1.2.3.2.1.cmml" xref="alg1.l6.m1.1.2.3.2.1"></minus><apply id="alg1.l6.m1.1.2.3.2.2.cmml" xref="alg1.l6.m1.1.2.3.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.2.3.2.2.1.cmml" xref="alg1.l6.m1.1.2.3.2.2">subscript</csymbol><apply id="alg1.l6.m1.1.2.3.2.2.2.cmml" xref="alg1.l6.m1.1.2.3.2.2.2"><ci id="alg1.l6.m1.1.2.3.2.2.2.1.cmml" xref="alg1.l6.m1.1.2.3.2.2.2.1">~</ci><ci id="alg1.l6.m1.1.2.3.2.2.2.2.cmml" xref="alg1.l6.m1.1.2.3.2.2.2.2">𝐁</ci></apply><ci id="alg1.l6.m1.1.2.3.2.2.3a.cmml" xref="alg1.l6.m1.1.2.3.2.2.3"><mtext mathsize="70%" id="alg1.l6.m1.1.2.3.2.2.3.cmml" xref="alg1.l6.m1.1.2.3.2.2.3">binary</mtext></ci></apply><apply id="alg1.l6.m1.1.2.3.2.3.cmml" xref="alg1.l6.m1.1.2.3.2.3"><times id="alg1.l6.m1.1.2.3.2.3.1.cmml" xref="alg1.l6.m1.1.2.3.2.3.1"></times><ci id="alg1.l6.m1.1.2.3.2.3.2a.cmml" xref="alg1.l6.m1.1.2.3.2.3.2"><mtext id="alg1.l6.m1.1.2.3.2.3.2.cmml" xref="alg1.l6.m1.1.2.3.2.3.2">detach</mtext></ci><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.2.3.2.3.3.2"><ci id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1">~</ci><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝐁</ci></apply></apply></apply><apply id="alg1.l6.m1.1.2.3.3.cmml" xref="alg1.l6.m1.1.2.3.3"><ci id="alg1.l6.m1.1.2.3.3.1.cmml" xref="alg1.l6.m1.1.2.3.3.1">~</ci><ci id="alg1.l6.m1.1.2.3.3.2.cmml" xref="alg1.l6.m1.1.2.3.3.2">𝐁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">\mathbf{P}\leftarrow\tilde{\mathbf{B}}_{\text{binary}}-\text{detach}(\tilde{\mathbf{B}})+\tilde{\mathbf{B}}</annotation></semantics></math>

</div>
</div>
</figure>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1904.08322" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1904.08324" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1904.08324">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1904.08324" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1904.08325" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sat Mar  2 17:47:47 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
