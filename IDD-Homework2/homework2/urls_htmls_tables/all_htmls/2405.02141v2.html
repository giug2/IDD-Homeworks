<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Multi-Objective Recommendation via Multivariate Policy Learning</title>
<!--Generated on Mon Sep 16 09:21:00 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2405.02141v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S1" title="In Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction &amp; Motivation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S2" title="In Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Multi-Objective Recommendation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S3" title="In Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Multivariate Off-Policy Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S4" title="In Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Improving the CRM Lower Bound</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S4.SS1" title="In 4. Improving the CRM Lower Bound ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Effective Sample Size Corrections</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S4.SS2" title="In 4. Improving the CRM Lower Bound ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Estimating the Effective Sample Size</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S5" title="In Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Considerations for logging policies</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S5.SS1" title="In 5. Considerations for logging policies ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Violating the common support assumption</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S5.SS2" title="In 5. Considerations for logging policies ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Self-normalisation becomes unstable</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S5.SS3" title="In 5. Considerations for logging policies ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>The curse of dimensionality</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S6" title="In Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Designing a sensitive reward signal</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S7" title="In Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Experiments &amp; Discussion</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S7.SS1" title="In 7. Experiments &amp; Discussion ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.1 </span>ESS Corrections &amp; Estimator Coverage (RQ1)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S7.SS2" title="In 7. Experiments &amp; Discussion ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.2 </span>Improved Recommendations (RQ2–4)</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S7.SS2.SSS1" title="In 7.2. Improved Recommendations (RQ2–4) ‣ 7. Experiments &amp; Discussion ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.2.1 </span>Production Baseline (Control)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S7.SS2.SSS2" title="In 7.2. Improved Recommendations (RQ2–4) ‣ 7. Experiments &amp; Discussion ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.2.2 </span>Offline Results (RQ2–3)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S7.SS2.SSS3" title="In 7.2. Improved Recommendations (RQ2–4) ‣ 7. Experiments &amp; Discussion ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.2.3 </span>Online Results (RQ4)</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S8" title="In Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8 </span>Conclusions &amp; Outlook</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">Multi-Objective Recommendation 
<br class="ltx_break"/>via Multivariate Policy Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Olivier Jeunen
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">ShareChat</span><span class="ltx_text ltx_affiliation_country" id="id2.2.id2">United Kingdom</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jatin Mandav
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id3.1.id1">ShareChat</span><span class="ltx_text ltx_affiliation_country" id="id4.2.id2">India</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ivan Potapov
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id5.1.id1">ShareChat</span><span class="ltx_text ltx_affiliation_country" id="id6.2.id2">United Kingdom</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Nakul Agarwal
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.1.id1">ShareChat</span><span class="ltx_text ltx_affiliation_country" id="id8.2.id2">India</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Sourabh Vaid
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id9.1.id1">ShareChat</span><span class="ltx_text ltx_affiliation_country" id="id10.2.id2">India</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Wenzhe Shi
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id11.1.id1">ShareChat</span><span class="ltx_text ltx_affiliation_country" id="id12.2.id2">United Kingdom</span>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Aleksei Ustimenko
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id13.1.id1">ShareChat</span><span class="ltx_text ltx_affiliation_country" id="id14.2.id2">United Kingdom</span>
</span></span></span>
</div>
<div class="ltx_dates">(2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id15.id1">Real-world recommender systems often need to balance multiple objectives when deciding which recommendations to present to users.
These include behavioural signals (e.g. clicks, shares, dwell time), as well as broader objectives (e.g. diversity, fairness).
Scalarisation methods are commonly used to handle this balancing task, where a weighted average of per-objective reward signals determines the final score used for ranking.
Naturally, <em class="ltx_emph ltx_font_italic" id="id15.id1.1">how</em> these weights are computed exactly, is key to success for any online platform.</p>
<p class="ltx_p" id="id16.id2">We frame this as a decision-making task, where the scalarisation weights are <em class="ltx_emph ltx_font_italic" id="id16.id2.1">actions</em> taken to maximise an overall North Star reward (e.g. long-term user retention or growth).
We extend existing policy learning methods to the continuous multivariate action domain, proposing to maximise a pessimistic lower bound on the North Star reward that the learnt policy will yield.
Typical lower bounds based on normal approximations suffer from insufficient coverage, and we propose an efficient and effective policy-dependent correction for this.
We provide guidance to design stochastic data collection policies, as well as highly sensitive reward signals.
Empirical observations from simulations, offline and online experiments highlight the efficacy of our deployed approach.</p>
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>18th ACM Conference on Recommender Systems; October 14–18, 2024; Bari, Italy</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_booktitle" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>18th ACM Conference on Recommender Systems (RecSys ’24), October 14–18, 2024, Bari, Italy</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/3640457.3688132</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>979-8-4007-0505-2/24/10</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction &amp; Motivation</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Recommender systems are crucial tools that empower online platforms to connect users to content they enjoy—be it on music and video streaming platforms, e-commerce websites, social media applications, or others.
Practical implementations of such systems serve broad and diverse use-cases, with a few common tendencies.
One of those, is that recommendations are rarely centred around a <em class="ltx_emph ltx_font_italic" id="S1.p1.1.1">single</em> objective.
Indeed, streaming platforms might want to optimise both short-term and long-term engagement whilst ultimately targeting retention and lifetime customer value <cite class="ltx_cite ltx_citemacro_citep">(Briand et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib5" title="">2024</a>; Mehrotra et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib49" title="">2020</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib48" title="">2018</a>; Bugliarello et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib7" title="">2022</a>; Tang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib62" title="">2023</a>)</cite>; e-commerce platforms need to balance clicks, add-to-carts and conversions with possible returns and advertising income <cite class="ltx_cite ltx_citemacro_citep">(Gu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib21" title="">2020</a>; Lin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib40" title="">2019</a>; Wan and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib65" title="">2018</a>)</cite>; and social media platforms encounter similar challenges <cite class="ltx_cite ltx_citemacro_citep">(Sagtani et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib55" title="">2023</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib56" title="">2024</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Another recent tendency is that such systems are increasingly often framed as <em class="ltx_emph ltx_font_italic" id="S1.p2.1.1">decision-making</em> instead of <em class="ltx_emph ltx_font_italic" id="S1.p2.1.2">prediction</em> systems.
Indeed, predictions about user-item affinities typically serve to inform real-time decisions about recommendations, rankings, advertisements, and so forth.
The decision-making lens allows us to reason about <em class="ltx_emph ltx_font_italic" id="S1.p2.1.3">consequences</em> of such systems, and has been gaining popularity in recent years <cite class="ltx_cite ltx_citemacro_citep">(Jeunen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib32" title="">2022</a>)</cite>.
In the context of real-world platforms, it allows us to frame changes in key online metrics as the consequences of recommendation decisions, which in turn allows us to optimise those online metrics directly <cite class="ltx_cite ltx_citemacro_citep">(Jeunen, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib27" title="">2021</a>; Jeunen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib33" title="">2024</a>)</cite>.
Approaches that leverage the decision-making literature and frame recommendation as a <em class="ltx_emph ltx_font_italic" id="S1.p2.1.4">bandit</em> learning task have led to several practical successes <cite class="ltx_cite ltx_citemacro_citep">(McInerney et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib47" title="">2018</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib9" title="">2019</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib10" title="">2021</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib11" title="">2022</a>; Dong et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib14" title="">2020</a>; Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib44" title="">2020</a>; Mehrotra et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib49" title="">2020</a>; Bendada et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib3" title="">2020</a>; Su et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib59" title="">2024</a>; Briand et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib5" title="">2024</a>)</cite>.
Most common is the <em class="ltx_emph ltx_font_italic" id="S1.p2.1.5">off-policy</em> or <em class="ltx_emph ltx_font_italic" id="S1.p2.1.6">counterfactual</em> family of approaches, as they allow practitioners to learn and evaluate models <em class="ltx_emph ltx_font_italic" id="S1.p2.1.7">offline</em> before <em class="ltx_emph ltx_font_italic" id="S1.p2.1.8">online</em> deployment <cite class="ltx_cite ltx_citemacro_citep">(van den Akker et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib64" title="">2024</a>)</cite>.
Such methods typically leverage some form of algorithmic <em class="ltx_emph ltx_font_italic" id="S1.p2.1.9">pessimism</em>, optimising a lower bound on the reward they will yield <cite class="ltx_cite ltx_citemacro_citep">(Jeunen and Goethals, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib29" title="">2021a</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib31" title="">2023</a>; Swaminathan and Joachims, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib60" title="">2015a</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">The majority of the (off-policy) bandit literature focuses on <em class="ltx_emph ltx_font_italic" id="S1.p3.1.1">single</em> rewards, but <em class="ltx_emph ltx_font_italic" id="S1.p3.1.2">multi</em>-objective bandit approaches have been proposed as well <cite class="ltx_cite ltx_citemacro_citep">(Drugan and Nowe, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib15" title="">2013</a>; Busa-Fekete et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib8" title="">2017</a>)</cite>.
In the context of multi-objective recommendation with bandits, a few specialised solutions have been proposed recently.
These either focus on artist objectives in music streaming platforms <cite class="ltx_cite ltx_citemacro_citep">(Mehrotra et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib49" title="">2020</a>)</cite>, exposure fairness objectives in top-<math alttext="K" class="ltx_Math" display="inline" id="S1.p3.1.m1.1"><semantics id="S1.p3.1.m1.1a"><mi id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><ci id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S1.p3.1.m1.1d">italic_K</annotation></semantics></math> settings <cite class="ltx_cite ltx_citemacro_citep">(Jeunen and Goethals, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib30" title="">2021b</a>)</cite>, or long-term value via reinforcement learning <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib67" title="">2022</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In this work, we propose a general multi-objective recommendation approach that frames the optimisation of the <em class="ltx_emph ltx_font_italic" id="S1.p4.1.1">weights</em> that are given to individual objectives as a decision-making problem.
To this end, we leverage the Counterfactual Risk Minimisation (CRM) principle to optimise a lower bound on the reward a recommendation policy will yield, thereby extending it to a multivariate continuous action domain <cite class="ltx_cite ltx_citemacro_citep">(Swaminathan and Joachims, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib60" title="">2015a</a>)</cite>.
We show that existing approaches to construct the lower bound, based on the Central Limit Theorem (CLT), provide insufficient coverage in finite sample scenarios, and propose an efficient and effective policy-dependent correction for this problem.
In doing so, we combine existing elements in the literature to derive a novel estimator for the Effective Sample Size <cite class="ltx_cite ltx_citemacro_citep">(Martino et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib45" title="">2017</a>; Owen, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib52" title="">2013</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Reproducible empirical observations on synthetic data show that our proposed approach reduces the required sample size for the confidence interval to have sufficient coverage by a factor of up to 60, significantly reducing the cost of randomisation that is required for off-policy learning to work effectively.
We discuss practical considerations for designing logging policies in multivariate continuous domains, showing that the “<em class="ltx_emph ltx_font_italic" id="S1.p5.1.1">curse of dimensionality</em>” makes uniform randomisation less useful than practitioners would typically assume.
Furthermore, we show how “<em class="ltx_emph ltx_font_italic" id="S1.p5.1.2">learnt metrics</em>” give rise to highly sensitive reward signals that further improve effectiveness by improving statistical power <cite class="ltx_cite ltx_citemacro_citep">(Jeunen and Ustimenko, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib35" title="">2024</a>)</cite>.
Using real-world data from a large-scale short-video platform, we perform offline experiments that highlight the promise of our learnt policies.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Online experiments on two platforms with monthly user-bases over 160 million each, show that our approach significantly outperforms existing alternatives on multiple key metrics, bringing significant value to the business.
The alignment between our off- and online experimental results underscores the value of the bandit learning paradigm, and the decision-making lens in general.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Multi-Objective Recommendation</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">Users interact with content on the web through various modalities.
Online content marketplaces such as Instagram, Reddit, TikTok or ShareChat allow users to view, click, (dis)like, save, share and comment on items that are presented to them by the recommender system.
Such systems are typically not optimised for a <em class="ltx_emph ltx_font_italic" id="S2.p1.1.1">single</em> type of interaction, but rather aim to maximise a set of positive behaviours through multi-objective optimisation techniques.
Decidedly the most common approach in practice is scalarisation <cite class="ltx_cite ltx_citemacro_citep">(Hwang and Masud, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib23" title="">1979</a>)</cite>, where the multi-objective optimisation problem is recast with a single scalar objective.
Different parameterisations for the function that maps the multiple objectives to a single scalar, then give rise to different Pareto-optimal solutions.
Pareto-optimality in multi-objective recommendation applications is a well-studied topic <cite class="ltx_cite ltx_citemacro_citep">(Ribeiro et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib54" title="">2012</a>; Lin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib40" title="">2019</a>; Xie et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib66" title="">2021</a>)</cite>.
When the Pareto-front is convex, a <span class="ltx_text ltx_font_italic" id="S2.p1.1.2">linear</span> scalarisation function is sufficient to represent <em class="ltx_emph ltx_font_italic" id="S2.p1.1.3">all</em> Pareto-optimal solutions.
Naturally, this does not tell us <em class="ltx_emph ltx_font_italic" id="S2.p1.1.4">how</em> the weights of the linear function should be chosen, or where on the Pareto-front the business should position itself to optimise long-term business goals.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.5">Formally, assume we need to decide on a recommendation <math alttext="i\in\mathcal{I}" class="ltx_Math" display="inline" id="S2.p2.1.m1.1"><semantics id="S2.p2.1.m1.1a"><mrow id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml"><mi id="S2.p2.1.m1.1.1.2" xref="S2.p2.1.m1.1.1.2.cmml">i</mi><mo id="S2.p2.1.m1.1.1.1" xref="S2.p2.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.p2.1.m1.1.1.3" xref="S2.p2.1.m1.1.1.3.cmml">ℐ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><apply id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1"><in id="S2.p2.1.m1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1"></in><ci id="S2.p2.1.m1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.2">𝑖</ci><ci id="S2.p2.1.m1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.3">ℐ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">i\in\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.1.m1.1d">italic_i ∈ caligraphic_I</annotation></semantics></math> to show to a user <math alttext="u\in\mathcal{U}" class="ltx_Math" display="inline" id="S2.p2.2.m2.1"><semantics id="S2.p2.2.m2.1a"><mrow id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml"><mi id="S2.p2.2.m2.1.1.2" xref="S2.p2.2.m2.1.1.2.cmml">u</mi><mo id="S2.p2.2.m2.1.1.1" xref="S2.p2.2.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.p2.2.m2.1.1.3" xref="S2.p2.2.m2.1.1.3.cmml">𝒰</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><apply id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1"><in id="S2.p2.2.m2.1.1.1.cmml" xref="S2.p2.2.m2.1.1.1"></in><ci id="S2.p2.2.m2.1.1.2.cmml" xref="S2.p2.2.m2.1.1.2">𝑢</ci><ci id="S2.p2.2.m2.1.1.3.cmml" xref="S2.p2.2.m2.1.1.3">𝒰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">u\in\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.2.m2.1d">italic_u ∈ caligraphic_U</annotation></semantics></math>, in an attempt to optimise <math alttext="d\in\mathbb{N}" class="ltx_Math" display="inline" id="S2.p2.3.m3.1"><semantics id="S2.p2.3.m3.1a"><mrow id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml"><mi id="S2.p2.3.m3.1.1.2" xref="S2.p2.3.m3.1.1.2.cmml">d</mi><mo id="S2.p2.3.m3.1.1.1" xref="S2.p2.3.m3.1.1.1.cmml">∈</mo><mi id="S2.p2.3.m3.1.1.3" xref="S2.p2.3.m3.1.1.3.cmml">ℕ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><apply id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1"><in id="S2.p2.3.m3.1.1.1.cmml" xref="S2.p2.3.m3.1.1.1"></in><ci id="S2.p2.3.m3.1.1.2.cmml" xref="S2.p2.3.m3.1.1.2">𝑑</ci><ci id="S2.p2.3.m3.1.1.3.cmml" xref="S2.p2.3.m3.1.1.3">ℕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">d\in\mathbb{N}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.3.m3.1d">italic_d ∈ blackboard_N</annotation></semantics></math> objectives represented as <math alttext="f(u,i)" class="ltx_Math" display="inline" id="S2.p2.4.m4.2"><semantics id="S2.p2.4.m4.2a"><mrow id="S2.p2.4.m4.2.3" xref="S2.p2.4.m4.2.3.cmml"><mi id="S2.p2.4.m4.2.3.2" xref="S2.p2.4.m4.2.3.2.cmml">f</mi><mo id="S2.p2.4.m4.2.3.1" xref="S2.p2.4.m4.2.3.1.cmml">⁢</mo><mrow id="S2.p2.4.m4.2.3.3.2" xref="S2.p2.4.m4.2.3.3.1.cmml"><mo id="S2.p2.4.m4.2.3.3.2.1" stretchy="false" xref="S2.p2.4.m4.2.3.3.1.cmml">(</mo><mi id="S2.p2.4.m4.1.1" xref="S2.p2.4.m4.1.1.cmml">u</mi><mo id="S2.p2.4.m4.2.3.3.2.2" xref="S2.p2.4.m4.2.3.3.1.cmml">,</mo><mi id="S2.p2.4.m4.2.2" xref="S2.p2.4.m4.2.2.cmml">i</mi><mo id="S2.p2.4.m4.2.3.3.2.3" stretchy="false" xref="S2.p2.4.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.4.m4.2b"><apply id="S2.p2.4.m4.2.3.cmml" xref="S2.p2.4.m4.2.3"><times id="S2.p2.4.m4.2.3.1.cmml" xref="S2.p2.4.m4.2.3.1"></times><ci id="S2.p2.4.m4.2.3.2.cmml" xref="S2.p2.4.m4.2.3.2">𝑓</ci><interval closure="open" id="S2.p2.4.m4.2.3.3.1.cmml" xref="S2.p2.4.m4.2.3.3.2"><ci id="S2.p2.4.m4.1.1.cmml" xref="S2.p2.4.m4.1.1">𝑢</ci><ci id="S2.p2.4.m4.2.2.cmml" xref="S2.p2.4.m4.2.2">𝑖</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m4.2c">f(u,i)</annotation><annotation encoding="application/x-llamapun" id="S2.p2.4.m4.2d">italic_f ( italic_u , italic_i )</annotation></semantics></math>.
A multi-objective decision-making procedure with linear scalarisation weights <math alttext="a\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S2.p2.5.m5.1"><semantics id="S2.p2.5.m5.1a"><mrow id="S2.p2.5.m5.1.1" xref="S2.p2.5.m5.1.1.cmml"><mi id="S2.p2.5.m5.1.1.2" xref="S2.p2.5.m5.1.1.2.cmml">a</mi><mo id="S2.p2.5.m5.1.1.1" xref="S2.p2.5.m5.1.1.1.cmml">∈</mo><msup id="S2.p2.5.m5.1.1.3" xref="S2.p2.5.m5.1.1.3.cmml"><mi id="S2.p2.5.m5.1.1.3.2" xref="S2.p2.5.m5.1.1.3.2.cmml">ℝ</mi><mi id="S2.p2.5.m5.1.1.3.3" xref="S2.p2.5.m5.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.5.m5.1b"><apply id="S2.p2.5.m5.1.1.cmml" xref="S2.p2.5.m5.1.1"><in id="S2.p2.5.m5.1.1.1.cmml" xref="S2.p2.5.m5.1.1.1"></in><ci id="S2.p2.5.m5.1.1.2.cmml" xref="S2.p2.5.m5.1.1.2">𝑎</ci><apply id="S2.p2.5.m5.1.1.3.cmml" xref="S2.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.p2.5.m5.1.1.3.1.cmml" xref="S2.p2.5.m5.1.1.3">superscript</csymbol><ci id="S2.p2.5.m5.1.1.3.2.cmml" xref="S2.p2.5.m5.1.1.3.2">ℝ</ci><ci id="S2.p2.5.m5.1.1.3.3.cmml" xref="S2.p2.5.m5.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m5.1c">a\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.5.m5.1d">italic_a ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> can then be described as finding the items that satisfy:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\max_{i\in\mathcal{I}}\sum_{k=1}^{d}a_{k}\cdot f_{k}(u,i)." class="ltx_Math" display="block" id="S2.E1.m1.3"><semantics id="S2.E1.m1.3a"><mrow id="S2.E1.m1.3.3.1" xref="S2.E1.m1.3.3.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1" xref="S2.E1.m1.3.3.1.1.cmml"><munder id="S2.E1.m1.3.3.1.1.2" xref="S2.E1.m1.3.3.1.1.2.cmml"><mi id="S2.E1.m1.3.3.1.1.2.2" xref="S2.E1.m1.3.3.1.1.2.2.cmml">max</mi><mrow id="S2.E1.m1.3.3.1.1.2.3" xref="S2.E1.m1.3.3.1.1.2.3.cmml"><mi id="S2.E1.m1.3.3.1.1.2.3.2" xref="S2.E1.m1.3.3.1.1.2.3.2.cmml">i</mi><mo id="S2.E1.m1.3.3.1.1.2.3.1" xref="S2.E1.m1.3.3.1.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.3.3.1.1.2.3.3" xref="S2.E1.m1.3.3.1.1.2.3.3.cmml">ℐ</mi></mrow></munder><mo id="S2.E1.m1.3.3.1.1.1" xref="S2.E1.m1.3.3.1.1.1.cmml">⁢</mo><mrow id="S2.E1.m1.3.3.1.1.3" xref="S2.E1.m1.3.3.1.1.3.cmml"><munderover id="S2.E1.m1.3.3.1.1.3.1" xref="S2.E1.m1.3.3.1.1.3.1.cmml"><mo id="S2.E1.m1.3.3.1.1.3.1.2.2" movablelimits="false" xref="S2.E1.m1.3.3.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.E1.m1.3.3.1.1.3.1.2.3" xref="S2.E1.m1.3.3.1.1.3.1.2.3.cmml"><mi id="S2.E1.m1.3.3.1.1.3.1.2.3.2" xref="S2.E1.m1.3.3.1.1.3.1.2.3.2.cmml">k</mi><mo id="S2.E1.m1.3.3.1.1.3.1.2.3.1" xref="S2.E1.m1.3.3.1.1.3.1.2.3.1.cmml">=</mo><mn id="S2.E1.m1.3.3.1.1.3.1.2.3.3" xref="S2.E1.m1.3.3.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E1.m1.3.3.1.1.3.1.3" xref="S2.E1.m1.3.3.1.1.3.1.3.cmml">d</mi></munderover><mrow id="S2.E1.m1.3.3.1.1.3.2" xref="S2.E1.m1.3.3.1.1.3.2.cmml"><mrow id="S2.E1.m1.3.3.1.1.3.2.2" xref="S2.E1.m1.3.3.1.1.3.2.2.cmml"><msub id="S2.E1.m1.3.3.1.1.3.2.2.2" xref="S2.E1.m1.3.3.1.1.3.2.2.2.cmml"><mi id="S2.E1.m1.3.3.1.1.3.2.2.2.2" xref="S2.E1.m1.3.3.1.1.3.2.2.2.2.cmml">a</mi><mi id="S2.E1.m1.3.3.1.1.3.2.2.2.3" xref="S2.E1.m1.3.3.1.1.3.2.2.2.3.cmml">k</mi></msub><mo id="S2.E1.m1.3.3.1.1.3.2.2.1" lspace="0.222em" rspace="0.222em" xref="S2.E1.m1.3.3.1.1.3.2.2.1.cmml">⋅</mo><msub id="S2.E1.m1.3.3.1.1.3.2.2.3" xref="S2.E1.m1.3.3.1.1.3.2.2.3.cmml"><mi id="S2.E1.m1.3.3.1.1.3.2.2.3.2" xref="S2.E1.m1.3.3.1.1.3.2.2.3.2.cmml">f</mi><mi id="S2.E1.m1.3.3.1.1.3.2.2.3.3" xref="S2.E1.m1.3.3.1.1.3.2.2.3.3.cmml">k</mi></msub></mrow><mo id="S2.E1.m1.3.3.1.1.3.2.1" xref="S2.E1.m1.3.3.1.1.3.2.1.cmml">⁢</mo><mrow id="S2.E1.m1.3.3.1.1.3.2.3.2" xref="S2.E1.m1.3.3.1.1.3.2.3.1.cmml"><mo id="S2.E1.m1.3.3.1.1.3.2.3.2.1" stretchy="false" xref="S2.E1.m1.3.3.1.1.3.2.3.1.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">u</mi><mo id="S2.E1.m1.3.3.1.1.3.2.3.2.2" xref="S2.E1.m1.3.3.1.1.3.2.3.1.cmml">,</mo><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">i</mi><mo id="S2.E1.m1.3.3.1.1.3.2.3.2.3" stretchy="false" xref="S2.E1.m1.3.3.1.1.3.2.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E1.m1.3.3.1.2" lspace="0em" xref="S2.E1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.3b"><apply id="S2.E1.m1.3.3.1.1.cmml" xref="S2.E1.m1.3.3.1"><times id="S2.E1.m1.3.3.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1"></times><apply id="S2.E1.m1.3.3.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2">subscript</csymbol><max id="S2.E1.m1.3.3.1.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2"></max><apply id="S2.E1.m1.3.3.1.1.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.3"><in id="S2.E1.m1.3.3.1.1.2.3.1.cmml" xref="S2.E1.m1.3.3.1.1.2.3.1"></in><ci id="S2.E1.m1.3.3.1.1.2.3.2.cmml" xref="S2.E1.m1.3.3.1.1.2.3.2">𝑖</ci><ci id="S2.E1.m1.3.3.1.1.2.3.3.cmml" xref="S2.E1.m1.3.3.1.1.2.3.3">ℐ</ci></apply></apply><apply id="S2.E1.m1.3.3.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.3"><apply id="S2.E1.m1.3.3.1.1.3.1.cmml" xref="S2.E1.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.1.1.cmml" xref="S2.E1.m1.3.3.1.1.3.1">superscript</csymbol><apply id="S2.E1.m1.3.3.1.1.3.1.2.cmml" xref="S2.E1.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.1.2.1.cmml" xref="S2.E1.m1.3.3.1.1.3.1">subscript</csymbol><sum id="S2.E1.m1.3.3.1.1.3.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.2"></sum><apply id="S2.E1.m1.3.3.1.1.3.1.2.3.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.3"><eq id="S2.E1.m1.3.3.1.1.3.1.2.3.1.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.3.1"></eq><ci id="S2.E1.m1.3.3.1.1.3.1.2.3.2.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.3.2">𝑘</ci><cn id="S2.E1.m1.3.3.1.1.3.1.2.3.3.cmml" type="integer" xref="S2.E1.m1.3.3.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.3.3.1.1.3.1.3.cmml" xref="S2.E1.m1.3.3.1.1.3.1.3">𝑑</ci></apply><apply id="S2.E1.m1.3.3.1.1.3.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2"><times id="S2.E1.m1.3.3.1.1.3.2.1.cmml" xref="S2.E1.m1.3.3.1.1.3.2.1"></times><apply id="S2.E1.m1.3.3.1.1.3.2.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2"><ci id="S2.E1.m1.3.3.1.1.3.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.1">⋅</ci><apply id="S2.E1.m1.3.3.1.1.3.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.2.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.3.2.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.2.2">𝑎</ci><ci id="S2.E1.m1.3.3.1.1.3.2.2.2.3.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.2.3">𝑘</ci></apply><apply id="S2.E1.m1.3.3.1.1.3.2.2.3.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.2.2.3.1.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.3">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.3.2.2.3.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.3.2">𝑓</ci><ci id="S2.E1.m1.3.3.1.1.3.2.2.3.3.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.3.3">𝑘</ci></apply></apply><interval closure="open" id="S2.E1.m1.3.3.1.1.3.2.3.1.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3.2"><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝑢</ci><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝑖</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.3c">\max_{i\in\mathcal{I}}\sum_{k=1}^{d}a_{k}\cdot f_{k}(u,i).</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.3d">roman_max start_POSTSUBSCRIPT italic_i ∈ caligraphic_I end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ⋅ italic_f start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( italic_u , italic_i ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p2.8">Naturally, in top-<math alttext="n" class="ltx_Math" display="inline" id="S2.p2.6.m1.1"><semantics id="S2.p2.6.m1.1a"><mi id="S2.p2.6.m1.1.1" xref="S2.p2.6.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.p2.6.m1.1b"><ci id="S2.p2.6.m1.1.1.cmml" xref="S2.p2.6.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.6.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.p2.6.m1.1d">italic_n</annotation></semantics></math> settings we can replace the <math alttext="\max" class="ltx_Math" display="inline" id="S2.p2.7.m2.1"><semantics id="S2.p2.7.m2.1a"><mi id="S2.p2.7.m2.1.1" xref="S2.p2.7.m2.1.1.cmml">max</mi><annotation-xml encoding="MathML-Content" id="S2.p2.7.m2.1b"><max id="S2.p2.7.m2.1.1.cmml" xref="S2.p2.7.m2.1.1"></max></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.7.m2.1c">\max</annotation><annotation encoding="application/x-llamapun" id="S2.p2.7.m2.1d">roman_max</annotation></semantics></math>-operation with a <math alttext="{\tt sort}" class="ltx_Math" display="inline" id="S2.p2.8.m3.1"><semantics id="S2.p2.8.m3.1a"><mi id="S2.p2.8.m3.1.1" xref="S2.p2.8.m3.1.1.cmml">𝚜𝚘𝚛𝚝</mi><annotation-xml encoding="MathML-Content" id="S2.p2.8.m3.1b"><ci id="S2.p2.8.m3.1.1.cmml" xref="S2.p2.8.m3.1.1">𝚜𝚘𝚛𝚝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.8.m3.1c">{\tt sort}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.8.m3.1d">typewriter_sort</annotation></semantics></math>-operation.
This type of procedure is exceedingly common in deployed recommender systems on the web.
Indeed: public accounts describe Facebook and TikTok’s systems in this way <cite class="ltx_cite ltx_citemacro_citep">(Smith, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib58" title="">2021</a>; Merrill and Oremus, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib50" title="">2021</a>)</cite> and Twitter even open-sourced their exact weights <cite class="ltx_cite ltx_citemacro_citep">(Twitter, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib63" title="">2023</a>)</cite>.
<cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib49" title="">Mehrotra et al<span class="ltx_text">.</span></a></cite> <cite class="ltx_cite ltx_citemacro_citep">(Mehrotra et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib49" title="">2020</a>)</cite> describe how Spotify leverages the Generalised Gini Index <cite class="ltx_cite ltx_citemacro_citep">(Busa-Fekete et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib8" title="">2017</a>)</cite> aggregation function to decide on the weights, motivated as preserving fairness between user- and artist-centric objectives.
<cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib67" title="">Zhang et al<span class="ltx_text">.</span></a></cite> describe a reinforcement learning approach for Tencent that aims to find weights that maximise long-term user satisfaction <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib67" title="">2022</a>)</cite>.
<cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib51" title="">Milli et al<span class="ltx_text">.</span></a></cite> study strategic behaviour of users and content providers that might result from the weights being chosen <cite class="ltx_cite ltx_citemacro_citep">(Milli et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib51" title="">2023</a>)</cite>.
<cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib25" title="">Jannach and Abdollahpouri</a></cite> present a taxonomy of <em class="ltx_emph ltx_font_italic" id="S2.p2.8.1">types</em> of objectives that might be considered in multi-objective recommendation settings, whilst outlining open challenges <cite class="ltx_cite ltx_citemacro_citep">(Jannach and Abdollahpouri, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib25" title="">2023</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.1">Our work complements the existing literature by describing a policy learning approach to align the scalarisation weights with an over-arching North Star reward, such as long-term growth or revenue.
Crucially, this can help guide online platforms to decide <em class="ltx_emph ltx_font_italic" id="S2.p3.1.1">where</em> on the Pareto-front they wish to position themselves.
Additional to technical contributions improving the robustness of existing policy learning methods, we present extensive experimental results that highlight its real-world effectiveness.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Multivariate Off-Policy Learning</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.9">We want to learn a <math alttext="d" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">italic_d</annotation></semantics></math>-dimensional weight vector <math alttext="a\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.p1.2.m2.1"><semantics id="S3.p1.2.m2.1a"><mrow id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml"><mi id="S3.p1.2.m2.1.1.2" xref="S3.p1.2.m2.1.1.2.cmml">a</mi><mo id="S3.p1.2.m2.1.1.1" xref="S3.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S3.p1.2.m2.1.1.3" xref="S3.p1.2.m2.1.1.3.cmml"><mi id="S3.p1.2.m2.1.1.3.2" xref="S3.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S3.p1.2.m2.1.1.3.3" xref="S3.p1.2.m2.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><apply id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1"><in id="S3.p1.2.m2.1.1.1.cmml" xref="S3.p1.2.m2.1.1.1"></in><ci id="S3.p1.2.m2.1.1.2.cmml" xref="S3.p1.2.m2.1.1.2">𝑎</ci><apply id="S3.p1.2.m2.1.1.3.cmml" xref="S3.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.p1.2.m2.1.1.3.1.cmml" xref="S3.p1.2.m2.1.1.3">superscript</csymbol><ci id="S3.p1.2.m2.1.1.3.2.cmml" xref="S3.p1.2.m2.1.1.3.2">ℝ</ci><ci id="S3.p1.2.m2.1.1.3.3.cmml" xref="S3.p1.2.m2.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">a\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.1d">italic_a ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, which we will refer to as an action <math alttext="A" class="ltx_Math" display="inline" id="S3.p1.3.m3.1"><semantics id="S3.p1.3.m3.1a"><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.p1.3.m3.1d">italic_A</annotation></semantics></math>, in line with the bandit literature <cite class="ltx_cite ltx_citemacro_citep">(Lattimore and Szepesvári, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib39" title="">2020</a>)</cite>.
The space of all possible actions, i.e. <math alttext="\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.p1.4.m4.1"><semantics id="S3.p1.4.m4.1a"><msup id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml"><mi id="S3.p1.4.m4.1.1.2" xref="S3.p1.4.m4.1.1.2.cmml">ℝ</mi><mi id="S3.p1.4.m4.1.1.3" xref="S3.p1.4.m4.1.1.3.cmml">d</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><apply id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.1.1.cmml" xref="S3.p1.4.m4.1.1">superscript</csymbol><ci id="S3.p1.4.m4.1.1.2.cmml" xref="S3.p1.4.m4.1.1.2">ℝ</ci><ci id="S3.p1.4.m4.1.1.3.cmml" xref="S3.p1.4.m4.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.4.m4.1d">blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, is then denoted by the calligraphic <math alttext="\mathcal{A}" class="ltx_Math" display="inline" id="S3.p1.5.m5.1"><semantics id="S3.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><ci id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">\mathcal{A}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.5.m5.1d">caligraphic_A</annotation></semantics></math>.
When taken, an action yields a reward <math alttext="R" class="ltx_Math" display="inline" id="S3.p1.6.m6.1"><semantics id="S3.p1.6.m6.1a"><mi id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><ci id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.p1.6.m6.1d">italic_R</annotation></semantics></math> (e.g. long-term retention, growth, revenue).
The goal is to find the weights that maximise rewards.
Specifically, we frame this as a policy learning problem, where a policy <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S3.p1.7.m7.1"><semantics id="S3.p1.7.m7.1a"><msub id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml"><mi id="S3.p1.7.m7.1.1.2" xref="S3.p1.7.m7.1.1.2.cmml">π</mi><mi id="S3.p1.7.m7.1.1.3" xref="S3.p1.7.m7.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><apply id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p1.7.m7.1.1.1.cmml" xref="S3.p1.7.m7.1.1">subscript</csymbol><ci id="S3.p1.7.m7.1.1.2.cmml" xref="S3.p1.7.m7.1.1.2">𝜋</ci><ci id="S3.p1.7.m7.1.1.3.cmml" xref="S3.p1.7.m7.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.7.m7.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> describes a distribution over actions <math alttext="\pi_{\theta}(A)\equiv\mathsf{P}(A|\pi,\theta)" class="ltx_Math" display="inline" id="S3.p1.8.m8.4"><semantics id="S3.p1.8.m8.4a"><mrow id="S3.p1.8.m8.4.4" xref="S3.p1.8.m8.4.4.cmml"><mrow id="S3.p1.8.m8.4.4.3" xref="S3.p1.8.m8.4.4.3.cmml"><msub id="S3.p1.8.m8.4.4.3.2" xref="S3.p1.8.m8.4.4.3.2.cmml"><mi id="S3.p1.8.m8.4.4.3.2.2" xref="S3.p1.8.m8.4.4.3.2.2.cmml">π</mi><mi id="S3.p1.8.m8.4.4.3.2.3" xref="S3.p1.8.m8.4.4.3.2.3.cmml">θ</mi></msub><mo id="S3.p1.8.m8.4.4.3.1" xref="S3.p1.8.m8.4.4.3.1.cmml">⁢</mo><mrow id="S3.p1.8.m8.4.4.3.3.2" xref="S3.p1.8.m8.4.4.3.cmml"><mo id="S3.p1.8.m8.4.4.3.3.2.1" stretchy="false" xref="S3.p1.8.m8.4.4.3.cmml">(</mo><mi id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml">A</mi><mo id="S3.p1.8.m8.4.4.3.3.2.2" stretchy="false" xref="S3.p1.8.m8.4.4.3.cmml">)</mo></mrow></mrow><mo id="S3.p1.8.m8.4.4.2" xref="S3.p1.8.m8.4.4.2.cmml">≡</mo><mrow id="S3.p1.8.m8.4.4.1" xref="S3.p1.8.m8.4.4.1.cmml"><mi id="S3.p1.8.m8.4.4.1.3" xref="S3.p1.8.m8.4.4.1.3.cmml">𝖯</mi><mo id="S3.p1.8.m8.4.4.1.2" xref="S3.p1.8.m8.4.4.1.2.cmml">⁢</mo><mrow id="S3.p1.8.m8.4.4.1.1.1" xref="S3.p1.8.m8.4.4.1.1.1.1.cmml"><mo id="S3.p1.8.m8.4.4.1.1.1.2" stretchy="false" xref="S3.p1.8.m8.4.4.1.1.1.1.cmml">(</mo><mrow id="S3.p1.8.m8.4.4.1.1.1.1" xref="S3.p1.8.m8.4.4.1.1.1.1.cmml"><mi id="S3.p1.8.m8.4.4.1.1.1.1.2" xref="S3.p1.8.m8.4.4.1.1.1.1.2.cmml">A</mi><mo fence="false" id="S3.p1.8.m8.4.4.1.1.1.1.1" xref="S3.p1.8.m8.4.4.1.1.1.1.1.cmml">|</mo><mrow id="S3.p1.8.m8.4.4.1.1.1.1.3.2" xref="S3.p1.8.m8.4.4.1.1.1.1.3.1.cmml"><mi id="S3.p1.8.m8.2.2" xref="S3.p1.8.m8.2.2.cmml">π</mi><mo id="S3.p1.8.m8.4.4.1.1.1.1.3.2.1" xref="S3.p1.8.m8.4.4.1.1.1.1.3.1.cmml">,</mo><mi id="S3.p1.8.m8.3.3" xref="S3.p1.8.m8.3.3.cmml">θ</mi></mrow></mrow><mo id="S3.p1.8.m8.4.4.1.1.1.3" stretchy="false" xref="S3.p1.8.m8.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.4b"><apply id="S3.p1.8.m8.4.4.cmml" xref="S3.p1.8.m8.4.4"><equivalent id="S3.p1.8.m8.4.4.2.cmml" xref="S3.p1.8.m8.4.4.2"></equivalent><apply id="S3.p1.8.m8.4.4.3.cmml" xref="S3.p1.8.m8.4.4.3"><times id="S3.p1.8.m8.4.4.3.1.cmml" xref="S3.p1.8.m8.4.4.3.1"></times><apply id="S3.p1.8.m8.4.4.3.2.cmml" xref="S3.p1.8.m8.4.4.3.2"><csymbol cd="ambiguous" id="S3.p1.8.m8.4.4.3.2.1.cmml" xref="S3.p1.8.m8.4.4.3.2">subscript</csymbol><ci id="S3.p1.8.m8.4.4.3.2.2.cmml" xref="S3.p1.8.m8.4.4.3.2.2">𝜋</ci><ci id="S3.p1.8.m8.4.4.3.2.3.cmml" xref="S3.p1.8.m8.4.4.3.2.3">𝜃</ci></apply><ci id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1">𝐴</ci></apply><apply id="S3.p1.8.m8.4.4.1.cmml" xref="S3.p1.8.m8.4.4.1"><times id="S3.p1.8.m8.4.4.1.2.cmml" xref="S3.p1.8.m8.4.4.1.2"></times><ci id="S3.p1.8.m8.4.4.1.3.cmml" xref="S3.p1.8.m8.4.4.1.3">𝖯</ci><apply id="S3.p1.8.m8.4.4.1.1.1.1.cmml" xref="S3.p1.8.m8.4.4.1.1.1"><csymbol cd="latexml" id="S3.p1.8.m8.4.4.1.1.1.1.1.cmml" xref="S3.p1.8.m8.4.4.1.1.1.1.1">conditional</csymbol><ci id="S3.p1.8.m8.4.4.1.1.1.1.2.cmml" xref="S3.p1.8.m8.4.4.1.1.1.1.2">𝐴</ci><list id="S3.p1.8.m8.4.4.1.1.1.1.3.1.cmml" xref="S3.p1.8.m8.4.4.1.1.1.1.3.2"><ci id="S3.p1.8.m8.2.2.cmml" xref="S3.p1.8.m8.2.2">𝜋</ci><ci id="S3.p1.8.m8.3.3.cmml" xref="S3.p1.8.m8.3.3">𝜃</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.4c">\pi_{\theta}(A)\equiv\mathsf{P}(A|\pi,\theta)</annotation><annotation encoding="application/x-llamapun" id="S3.p1.8.m8.4d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_A ) ≡ sansserif_P ( italic_A | italic_π , italic_θ )</annotation></semantics></math>.
Note that the probabilistic view is general, but <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S3.p1.9.m9.1"><semantics id="S3.p1.9.m9.1a"><msub id="S3.p1.9.m9.1.1" xref="S3.p1.9.m9.1.1.cmml"><mi id="S3.p1.9.m9.1.1.2" xref="S3.p1.9.m9.1.1.2.cmml">π</mi><mi id="S3.p1.9.m9.1.1.3" xref="S3.p1.9.m9.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.1b"><apply id="S3.p1.9.m9.1.1.cmml" xref="S3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.p1.9.m9.1.1.1.cmml" xref="S3.p1.9.m9.1.1">subscript</csymbol><ci id="S3.p1.9.m9.1.1.2.cmml" xref="S3.p1.9.m9.1.1.2">𝜋</ci><ci id="S3.p1.9.m9.1.1.3.cmml" xref="S3.p1.9.m9.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.9.m9.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> is allowed to be deterministic.
We wish to learn the parameters that maximise the expected reward under the learnt policy:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\theta^{\star}=\operatorname*{arg\,max}_{\theta\in\Theta}\mathbb{E}_{a\sim\pi_%
{\theta}}[R]." class="ltx_Math" display="block" id="S3.E2.m1.2"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2.1" xref="S3.E2.m1.2.2.1.1.cmml"><mrow id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.1.cmml"><msup id="S3.E2.m1.2.2.1.1.2" xref="S3.E2.m1.2.2.1.1.2.cmml"><mi id="S3.E2.m1.2.2.1.1.2.2" xref="S3.E2.m1.2.2.1.1.2.2.cmml">θ</mi><mo id="S3.E2.m1.2.2.1.1.2.3" xref="S3.E2.m1.2.2.1.1.2.3.cmml">⋆</mo></msup><mo id="S3.E2.m1.2.2.1.1.1" xref="S3.E2.m1.2.2.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.2.2.1.1.3" xref="S3.E2.m1.2.2.1.1.3.cmml"><mrow id="S3.E2.m1.2.2.1.1.3.2" xref="S3.E2.m1.2.2.1.1.3.2.cmml"><munder id="S3.E2.m1.2.2.1.1.3.2.1" xref="S3.E2.m1.2.2.1.1.3.2.1.cmml"><mrow id="S3.E2.m1.2.2.1.1.3.2.1.2" xref="S3.E2.m1.2.2.1.1.3.2.1.2.cmml"><mi id="S3.E2.m1.2.2.1.1.3.2.1.2.2" xref="S3.E2.m1.2.2.1.1.3.2.1.2.2.cmml">arg</mi><mo id="S3.E2.m1.2.2.1.1.3.2.1.2.1" lspace="0.170em" xref="S3.E2.m1.2.2.1.1.3.2.1.2.1.cmml">⁢</mo><mi id="S3.E2.m1.2.2.1.1.3.2.1.2.3" xref="S3.E2.m1.2.2.1.1.3.2.1.2.3.cmml">max</mi></mrow><mrow id="S3.E2.m1.2.2.1.1.3.2.1.3" xref="S3.E2.m1.2.2.1.1.3.2.1.3.cmml"><mi id="S3.E2.m1.2.2.1.1.3.2.1.3.2" xref="S3.E2.m1.2.2.1.1.3.2.1.3.2.cmml">θ</mi><mo id="S3.E2.m1.2.2.1.1.3.2.1.3.1" xref="S3.E2.m1.2.2.1.1.3.2.1.3.1.cmml">∈</mo><mi id="S3.E2.m1.2.2.1.1.3.2.1.3.3" mathvariant="normal" xref="S3.E2.m1.2.2.1.1.3.2.1.3.3.cmml">Θ</mi></mrow></munder><mo id="S3.E2.m1.2.2.1.1.3.2a" xref="S3.E2.m1.2.2.1.1.3.2.cmml">⁡</mo><msub id="S3.E2.m1.2.2.1.1.3.2.2" xref="S3.E2.m1.2.2.1.1.3.2.2.cmml"><mi id="S3.E2.m1.2.2.1.1.3.2.2.2" xref="S3.E2.m1.2.2.1.1.3.2.2.2.cmml">𝔼</mi><mrow id="S3.E2.m1.2.2.1.1.3.2.2.3" xref="S3.E2.m1.2.2.1.1.3.2.2.3.cmml"><mi id="S3.E2.m1.2.2.1.1.3.2.2.3.2" xref="S3.E2.m1.2.2.1.1.3.2.2.3.2.cmml">a</mi><mo id="S3.E2.m1.2.2.1.1.3.2.2.3.1" xref="S3.E2.m1.2.2.1.1.3.2.2.3.1.cmml">∼</mo><msub id="S3.E2.m1.2.2.1.1.3.2.2.3.3" xref="S3.E2.m1.2.2.1.1.3.2.2.3.3.cmml"><mi id="S3.E2.m1.2.2.1.1.3.2.2.3.3.2" xref="S3.E2.m1.2.2.1.1.3.2.2.3.3.2.cmml">π</mi><mi id="S3.E2.m1.2.2.1.1.3.2.2.3.3.3" xref="S3.E2.m1.2.2.1.1.3.2.2.3.3.3.cmml">θ</mi></msub></mrow></msub></mrow><mo id="S3.E2.m1.2.2.1.1.3.1" xref="S3.E2.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S3.E2.m1.2.2.1.1.3.3.2" xref="S3.E2.m1.2.2.1.1.3.3.1.cmml"><mo id="S3.E2.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="S3.E2.m1.2.2.1.1.3.3.1.1.cmml">[</mo><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">R</mi><mo id="S3.E2.m1.2.2.1.1.3.3.2.2" stretchy="false" xref="S3.E2.m1.2.2.1.1.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E2.m1.2.2.1.2" lspace="0em" xref="S3.E2.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.1.1.cmml" xref="S3.E2.m1.2.2.1"><eq id="S3.E2.m1.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1"></eq><apply id="S3.E2.m1.2.2.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.2.1.cmml" xref="S3.E2.m1.2.2.1.1.2">superscript</csymbol><ci id="S3.E2.m1.2.2.1.1.2.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2">𝜃</ci><ci id="S3.E2.m1.2.2.1.1.2.3.cmml" xref="S3.E2.m1.2.2.1.1.2.3">⋆</ci></apply><apply id="S3.E2.m1.2.2.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.3"><times id="S3.E2.m1.2.2.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.3.1"></times><apply id="S3.E2.m1.2.2.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.3.2"><apply id="S3.E2.m1.2.2.1.1.3.2.1.cmml" xref="S3.E2.m1.2.2.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.3.2.1.1.cmml" xref="S3.E2.m1.2.2.1.1.3.2.1">subscript</csymbol><apply id="S3.E2.m1.2.2.1.1.3.2.1.2.cmml" xref="S3.E2.m1.2.2.1.1.3.2.1.2"><times id="S3.E2.m1.2.2.1.1.3.2.1.2.1.cmml" xref="S3.E2.m1.2.2.1.1.3.2.1.2.1"></times><ci id="S3.E2.m1.2.2.1.1.3.2.1.2.2.cmml" xref="S3.E2.m1.2.2.1.1.3.2.1.2.2">arg</ci><ci id="S3.E2.m1.2.2.1.1.3.2.1.2.3.cmml" xref="S3.E2.m1.2.2.1.1.3.2.1.2.3">max</ci></apply><apply id="S3.E2.m1.2.2.1.1.3.2.1.3.cmml" xref="S3.E2.m1.2.2.1.1.3.2.1.3"><in id="S3.E2.m1.2.2.1.1.3.2.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.3.2.1.3.1"></in><ci id="S3.E2.m1.2.2.1.1.3.2.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.3.2.1.3.2">𝜃</ci><ci id="S3.E2.m1.2.2.1.1.3.2.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.3.2.1.3.3">Θ</ci></apply></apply><apply id="S3.E2.m1.2.2.1.1.3.2.2.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.3.2.2.1.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.3.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2.2">𝔼</ci><apply id="S3.E2.m1.2.2.1.1.3.2.2.3.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2.3"><csymbol cd="latexml" id="S3.E2.m1.2.2.1.1.3.2.2.3.1.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2.3.1">similar-to</csymbol><ci id="S3.E2.m1.2.2.1.1.3.2.2.3.2.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2.3.2">𝑎</ci><apply id="S3.E2.m1.2.2.1.1.3.2.2.3.3.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.3.2.2.3.3.1.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2.3.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.3.2.2.3.3.2.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2.3.3.2">𝜋</ci><ci id="S3.E2.m1.2.2.1.1.3.2.2.3.3.3.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2.3.3.3">𝜃</ci></apply></apply></apply></apply><apply id="S3.E2.m1.2.2.1.1.3.3.1.cmml" xref="S3.E2.m1.2.2.1.1.3.3.2"><csymbol cd="latexml" id="S3.E2.m1.2.2.1.1.3.3.1.1.cmml" xref="S3.E2.m1.2.2.1.1.3.3.2.1">delimited-[]</csymbol><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝑅</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">\theta^{\star}=\operatorname*{arg\,max}_{\theta\in\Theta}\mathbb{E}_{a\sim\pi_%
{\theta}}[R].</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.2d">italic_θ start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT = start_OPERATOR roman_arg roman_max end_OPERATOR start_POSTSUBSCRIPT italic_θ ∈ roman_Θ end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_a ∼ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ italic_R ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.5">This is often attained via gradient ascent on an importance sampling or Inverse Propensity Score (IPS) weighting estimator, where we leverage samples from a given <span class="ltx_text ltx_font_italic" id="S3.p2.5.1">data collection</span> or “<span class="ltx_text ltx_font_italic" id="S3.p2.5.2">logging</span>” policy to allow for unbiased counterfactual estimation:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbb{E}_{a\sim\pi_{\theta}}[R]=\mathbb{E}_{a\sim\pi_{0}}\left[\frac{\pi_{%
\theta}(a)}{\pi_{0}(a)}R\right]." class="ltx_Math" display="block" id="S3.E3.m1.4"><semantics id="S3.E3.m1.4a"><mrow id="S3.E3.m1.4.4.1" xref="S3.E3.m1.4.4.1.1.cmml"><mrow id="S3.E3.m1.4.4.1.1" xref="S3.E3.m1.4.4.1.1.cmml"><mrow id="S3.E3.m1.4.4.1.1.3" xref="S3.E3.m1.4.4.1.1.3.cmml"><msub id="S3.E3.m1.4.4.1.1.3.2" xref="S3.E3.m1.4.4.1.1.3.2.cmml"><mi id="S3.E3.m1.4.4.1.1.3.2.2" xref="S3.E3.m1.4.4.1.1.3.2.2.cmml">𝔼</mi><mrow id="S3.E3.m1.4.4.1.1.3.2.3" xref="S3.E3.m1.4.4.1.1.3.2.3.cmml"><mi id="S3.E3.m1.4.4.1.1.3.2.3.2" xref="S3.E3.m1.4.4.1.1.3.2.3.2.cmml">a</mi><mo id="S3.E3.m1.4.4.1.1.3.2.3.1" xref="S3.E3.m1.4.4.1.1.3.2.3.1.cmml">∼</mo><msub id="S3.E3.m1.4.4.1.1.3.2.3.3" xref="S3.E3.m1.4.4.1.1.3.2.3.3.cmml"><mi id="S3.E3.m1.4.4.1.1.3.2.3.3.2" xref="S3.E3.m1.4.4.1.1.3.2.3.3.2.cmml">π</mi><mi id="S3.E3.m1.4.4.1.1.3.2.3.3.3" xref="S3.E3.m1.4.4.1.1.3.2.3.3.3.cmml">θ</mi></msub></mrow></msub><mo id="S3.E3.m1.4.4.1.1.3.1" xref="S3.E3.m1.4.4.1.1.3.1.cmml">⁢</mo><mrow id="S3.E3.m1.4.4.1.1.3.3.2" xref="S3.E3.m1.4.4.1.1.3.3.1.cmml"><mo id="S3.E3.m1.4.4.1.1.3.3.2.1" stretchy="false" xref="S3.E3.m1.4.4.1.1.3.3.1.1.cmml">[</mo><mi id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">R</mi><mo id="S3.E3.m1.4.4.1.1.3.3.2.2" stretchy="false" xref="S3.E3.m1.4.4.1.1.3.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.E3.m1.4.4.1.1.2" xref="S3.E3.m1.4.4.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.4.4.1.1.1" xref="S3.E3.m1.4.4.1.1.1.cmml"><msub id="S3.E3.m1.4.4.1.1.1.3" xref="S3.E3.m1.4.4.1.1.1.3.cmml"><mi id="S3.E3.m1.4.4.1.1.1.3.2" xref="S3.E3.m1.4.4.1.1.1.3.2.cmml">𝔼</mi><mrow id="S3.E3.m1.4.4.1.1.1.3.3" xref="S3.E3.m1.4.4.1.1.1.3.3.cmml"><mi id="S3.E3.m1.4.4.1.1.1.3.3.2" xref="S3.E3.m1.4.4.1.1.1.3.3.2.cmml">a</mi><mo id="S3.E3.m1.4.4.1.1.1.3.3.1" xref="S3.E3.m1.4.4.1.1.1.3.3.1.cmml">∼</mo><msub id="S3.E3.m1.4.4.1.1.1.3.3.3" xref="S3.E3.m1.4.4.1.1.1.3.3.3.cmml"><mi id="S3.E3.m1.4.4.1.1.1.3.3.3.2" xref="S3.E3.m1.4.4.1.1.1.3.3.3.2.cmml">π</mi><mn id="S3.E3.m1.4.4.1.1.1.3.3.3.3" xref="S3.E3.m1.4.4.1.1.1.3.3.3.3.cmml">0</mn></msub></mrow></msub><mo id="S3.E3.m1.4.4.1.1.1.2" xref="S3.E3.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.4.4.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.2.cmml"><mo id="S3.E3.m1.4.4.1.1.1.1.1.2" xref="S3.E3.m1.4.4.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E3.m1.4.4.1.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.1.cmml"><mfrac id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml"><mrow id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml"><msub id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.3.2.cmml">π</mi><mi id="S3.E3.m1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.E3.m1.1.1.1.2" xref="S3.E3.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.1.1.1.4.2" xref="S3.E3.m1.1.1.1.cmml"><mo id="S3.E3.m1.1.1.1.4.2.1" stretchy="false" xref="S3.E3.m1.1.1.1.cmml">(</mo><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">a</mi><mo id="S3.E3.m1.1.1.1.4.2.2" stretchy="false" xref="S3.E3.m1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E3.m1.2.2.2" xref="S3.E3.m1.2.2.2.cmml"><msub id="S3.E3.m1.2.2.2.3" xref="S3.E3.m1.2.2.2.3.cmml"><mi id="S3.E3.m1.2.2.2.3.2" xref="S3.E3.m1.2.2.2.3.2.cmml">π</mi><mn id="S3.E3.m1.2.2.2.3.3" xref="S3.E3.m1.2.2.2.3.3.cmml">0</mn></msub><mo id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml">⁢</mo><mrow id="S3.E3.m1.2.2.2.4.2" xref="S3.E3.m1.2.2.2.cmml"><mo id="S3.E3.m1.2.2.2.4.2.1" stretchy="false" xref="S3.E3.m1.2.2.2.cmml">(</mo><mi id="S3.E3.m1.2.2.2.1" xref="S3.E3.m1.2.2.2.1.cmml">a</mi><mo id="S3.E3.m1.2.2.2.4.2.2" stretchy="false" xref="S3.E3.m1.2.2.2.cmml">)</mo></mrow></mrow></mfrac><mo id="S3.E3.m1.4.4.1.1.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E3.m1.4.4.1.1.1.1.1.1.2" xref="S3.E3.m1.4.4.1.1.1.1.1.1.2.cmml">R</mi></mrow><mo id="S3.E3.m1.4.4.1.1.1.1.1.3" xref="S3.E3.m1.4.4.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E3.m1.4.4.1.2" lspace="0em" xref="S3.E3.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.4b"><apply id="S3.E3.m1.4.4.1.1.cmml" xref="S3.E3.m1.4.4.1"><eq id="S3.E3.m1.4.4.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.2"></eq><apply id="S3.E3.m1.4.4.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.3"><times id="S3.E3.m1.4.4.1.1.3.1.cmml" xref="S3.E3.m1.4.4.1.1.3.1"></times><apply id="S3.E3.m1.4.4.1.1.3.2.cmml" xref="S3.E3.m1.4.4.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.3.2.1.cmml" xref="S3.E3.m1.4.4.1.1.3.2">subscript</csymbol><ci id="S3.E3.m1.4.4.1.1.3.2.2.cmml" xref="S3.E3.m1.4.4.1.1.3.2.2">𝔼</ci><apply id="S3.E3.m1.4.4.1.1.3.2.3.cmml" xref="S3.E3.m1.4.4.1.1.3.2.3"><csymbol cd="latexml" id="S3.E3.m1.4.4.1.1.3.2.3.1.cmml" xref="S3.E3.m1.4.4.1.1.3.2.3.1">similar-to</csymbol><ci id="S3.E3.m1.4.4.1.1.3.2.3.2.cmml" xref="S3.E3.m1.4.4.1.1.3.2.3.2">𝑎</ci><apply id="S3.E3.m1.4.4.1.1.3.2.3.3.cmml" xref="S3.E3.m1.4.4.1.1.3.2.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.3.2.3.3.1.cmml" xref="S3.E3.m1.4.4.1.1.3.2.3.3">subscript</csymbol><ci id="S3.E3.m1.4.4.1.1.3.2.3.3.2.cmml" xref="S3.E3.m1.4.4.1.1.3.2.3.3.2">𝜋</ci><ci id="S3.E3.m1.4.4.1.1.3.2.3.3.3.cmml" xref="S3.E3.m1.4.4.1.1.3.2.3.3.3">𝜃</ci></apply></apply></apply><apply id="S3.E3.m1.4.4.1.1.3.3.1.cmml" xref="S3.E3.m1.4.4.1.1.3.3.2"><csymbol cd="latexml" id="S3.E3.m1.4.4.1.1.3.3.1.1.cmml" xref="S3.E3.m1.4.4.1.1.3.3.2.1">delimited-[]</csymbol><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">𝑅</ci></apply></apply><apply id="S3.E3.m1.4.4.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1"><times id="S3.E3.m1.4.4.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.2"></times><apply id="S3.E3.m1.4.4.1.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.1.3.1.cmml" xref="S3.E3.m1.4.4.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.4.4.1.1.1.3.2.cmml" xref="S3.E3.m1.4.4.1.1.1.3.2">𝔼</ci><apply id="S3.E3.m1.4.4.1.1.1.3.3.cmml" xref="S3.E3.m1.4.4.1.1.1.3.3"><csymbol cd="latexml" id="S3.E3.m1.4.4.1.1.1.3.3.1.cmml" xref="S3.E3.m1.4.4.1.1.1.3.3.1">similar-to</csymbol><ci id="S3.E3.m1.4.4.1.1.1.3.3.2.cmml" xref="S3.E3.m1.4.4.1.1.1.3.3.2">𝑎</ci><apply id="S3.E3.m1.4.4.1.1.1.3.3.3.cmml" xref="S3.E3.m1.4.4.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.1.3.3.3.1.cmml" xref="S3.E3.m1.4.4.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E3.m1.4.4.1.1.1.3.3.3.2.cmml" xref="S3.E3.m1.4.4.1.1.1.3.3.3.2">𝜋</ci><cn id="S3.E3.m1.4.4.1.1.1.3.3.3.3.cmml" type="integer" xref="S3.E3.m1.4.4.1.1.1.3.3.3.3">0</cn></apply></apply></apply><apply id="S3.E3.m1.4.4.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.4.4.1.1.1.1.2.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E3.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1"><times id="S3.E3.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1"></times><apply id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2"><divide id="S3.E3.m1.2.2.3.cmml" xref="S3.E3.m1.2.2"></divide><apply id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><times id="S3.E3.m1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.2"></times><apply id="S3.E3.m1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.3.2">𝜋</ci><ci id="S3.E3.m1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.3.3">𝜃</ci></apply><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑎</ci></apply><apply id="S3.E3.m1.2.2.2.cmml" xref="S3.E3.m1.2.2.2"><times id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2"></times><apply id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.3.1.cmml" xref="S3.E3.m1.2.2.2.3">subscript</csymbol><ci id="S3.E3.m1.2.2.2.3.2.cmml" xref="S3.E3.m1.2.2.2.3.2">𝜋</ci><cn id="S3.E3.m1.2.2.2.3.3.cmml" type="integer" xref="S3.E3.m1.2.2.2.3.3">0</cn></apply><ci id="S3.E3.m1.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.1">𝑎</ci></apply></apply><ci id="S3.E3.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.2">𝑅</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.4c">\mathbb{E}_{a\sim\pi_{\theta}}[R]=\mathbb{E}_{a\sim\pi_{0}}\left[\frac{\pi_{%
\theta}(a)}{\pi_{0}(a)}R\right].</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.4d">blackboard_E start_POSTSUBSCRIPT italic_a ∼ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ italic_R ] = blackboard_E start_POSTSUBSCRIPT italic_a ∼ italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a ) end_ARG italic_R ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p2.4">Being able to estimate the left-hand side of Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S3.E3" title="In 3. Multivariate Off-Policy Learning ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">3</span></a> without actually needing to deploy <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S3.p2.1.m1.1"><semantics id="S3.p2.1.m1.1a"><msub id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml"><mi id="S3.p2.1.m1.1.1.2" xref="S3.p2.1.m1.1.1.2.cmml">π</mi><mi id="S3.p2.1.m1.1.1.3" xref="S3.p2.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.1.cmml" xref="S3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.p2.1.m1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.2">𝜋</ci><ci id="S3.p2.1.m1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>, is what makes Off-Policy Learning (OPL) attractive and desirable.
We only need a single assumption to make this work: the logging policy <math alttext="\pi_{0}" class="ltx_Math" display="inline" id="S3.p2.2.m2.1"><semantics id="S3.p2.2.m2.1a"><msub id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml"><mi id="S3.p2.2.m2.1.1.2" xref="S3.p2.2.m2.1.1.2.cmml">π</mi><mn id="S3.p2.2.m2.1.1.3" xref="S3.p2.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.1.cmml" xref="S3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.p2.2.m2.1.1.2.cmml" xref="S3.p2.2.m2.1.1.2">𝜋</ci><cn id="S3.p2.2.m2.1.1.3.cmml" type="integer" xref="S3.p2.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">\pi_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.2.m2.1d">italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> should have common support with the target policy <math alttext="\pi" class="ltx_Math" display="inline" id="S3.p2.3.m3.1"><semantics id="S3.p2.3.m3.1a"><mi id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><ci id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S3.p2.3.m3.1d">italic_π</annotation></semantics></math>. I.e. <math alttext="\forall a\in\mathcal{A}:\pi(a)&gt;0\implies\pi_{0}(a)&gt;0" class="ltx_Math" display="inline" id="S3.p2.4.m4.2"><semantics id="S3.p2.4.m4.2a"><mrow id="S3.p2.4.m4.2.3" xref="S3.p2.4.m4.2.3.cmml"><mrow id="S3.p2.4.m4.2.3.2" xref="S3.p2.4.m4.2.3.2.cmml"><mrow id="S3.p2.4.m4.2.3.2.2" xref="S3.p2.4.m4.2.3.2.2.cmml"><mo id="S3.p2.4.m4.2.3.2.2.1" rspace="0.167em" xref="S3.p2.4.m4.2.3.2.2.1.cmml">∀</mo><mi id="S3.p2.4.m4.2.3.2.2.2" xref="S3.p2.4.m4.2.3.2.2.2.cmml">a</mi></mrow><mo id="S3.p2.4.m4.2.3.2.1" xref="S3.p2.4.m4.2.3.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.4.m4.2.3.2.3" xref="S3.p2.4.m4.2.3.2.3.cmml">𝒜</mi></mrow><mo id="S3.p2.4.m4.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.p2.4.m4.2.3.1.cmml">:</mo><mrow id="S3.p2.4.m4.2.3.3" xref="S3.p2.4.m4.2.3.3.cmml"><mrow id="S3.p2.4.m4.2.3.3.2" xref="S3.p2.4.m4.2.3.3.2.cmml"><mi id="S3.p2.4.m4.2.3.3.2.2" xref="S3.p2.4.m4.2.3.3.2.2.cmml">π</mi><mo id="S3.p2.4.m4.2.3.3.2.1" xref="S3.p2.4.m4.2.3.3.2.1.cmml">⁢</mo><mrow id="S3.p2.4.m4.2.3.3.2.3.2" xref="S3.p2.4.m4.2.3.3.2.cmml"><mo id="S3.p2.4.m4.2.3.3.2.3.2.1" stretchy="false" xref="S3.p2.4.m4.2.3.3.2.cmml">(</mo><mi id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml">a</mi><mo id="S3.p2.4.m4.2.3.3.2.3.2.2" stretchy="false" xref="S3.p2.4.m4.2.3.3.2.cmml">)</mo></mrow></mrow><mo id="S3.p2.4.m4.2.3.3.3" xref="S3.p2.4.m4.2.3.3.3.cmml">&gt;</mo><mn id="S3.p2.4.m4.2.3.3.4" xref="S3.p2.4.m4.2.3.3.4.cmml">0</mn><mo id="S3.p2.4.m4.2.3.3.5" stretchy="false" xref="S3.p2.4.m4.2.3.3.5.cmml">⟹</mo><mrow id="S3.p2.4.m4.2.3.3.6" xref="S3.p2.4.m4.2.3.3.6.cmml"><msub id="S3.p2.4.m4.2.3.3.6.2" xref="S3.p2.4.m4.2.3.3.6.2.cmml"><mi id="S3.p2.4.m4.2.3.3.6.2.2" xref="S3.p2.4.m4.2.3.3.6.2.2.cmml">π</mi><mn id="S3.p2.4.m4.2.3.3.6.2.3" xref="S3.p2.4.m4.2.3.3.6.2.3.cmml">0</mn></msub><mo id="S3.p2.4.m4.2.3.3.6.1" xref="S3.p2.4.m4.2.3.3.6.1.cmml">⁢</mo><mrow id="S3.p2.4.m4.2.3.3.6.3.2" xref="S3.p2.4.m4.2.3.3.6.cmml"><mo id="S3.p2.4.m4.2.3.3.6.3.2.1" stretchy="false" xref="S3.p2.4.m4.2.3.3.6.cmml">(</mo><mi id="S3.p2.4.m4.2.2" xref="S3.p2.4.m4.2.2.cmml">a</mi><mo id="S3.p2.4.m4.2.3.3.6.3.2.2" stretchy="false" xref="S3.p2.4.m4.2.3.3.6.cmml">)</mo></mrow></mrow><mo id="S3.p2.4.m4.2.3.3.7" xref="S3.p2.4.m4.2.3.3.7.cmml">&gt;</mo><mn id="S3.p2.4.m4.2.3.3.8" xref="S3.p2.4.m4.2.3.3.8.cmml">0</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.2b"><apply id="S3.p2.4.m4.2.3.cmml" xref="S3.p2.4.m4.2.3"><ci id="S3.p2.4.m4.2.3.1.cmml" xref="S3.p2.4.m4.2.3.1">:</ci><apply id="S3.p2.4.m4.2.3.2.cmml" xref="S3.p2.4.m4.2.3.2"><in id="S3.p2.4.m4.2.3.2.1.cmml" xref="S3.p2.4.m4.2.3.2.1"></in><apply id="S3.p2.4.m4.2.3.2.2.cmml" xref="S3.p2.4.m4.2.3.2.2"><csymbol cd="latexml" id="S3.p2.4.m4.2.3.2.2.1.cmml" xref="S3.p2.4.m4.2.3.2.2.1">for-all</csymbol><ci id="S3.p2.4.m4.2.3.2.2.2.cmml" xref="S3.p2.4.m4.2.3.2.2.2">𝑎</ci></apply><ci id="S3.p2.4.m4.2.3.2.3.cmml" xref="S3.p2.4.m4.2.3.2.3">𝒜</ci></apply><apply id="S3.p2.4.m4.2.3.3.cmml" xref="S3.p2.4.m4.2.3.3"><and id="S3.p2.4.m4.2.3.3a.cmml" xref="S3.p2.4.m4.2.3.3"></and><apply id="S3.p2.4.m4.2.3.3b.cmml" xref="S3.p2.4.m4.2.3.3"><gt id="S3.p2.4.m4.2.3.3.3.cmml" xref="S3.p2.4.m4.2.3.3.3"></gt><apply id="S3.p2.4.m4.2.3.3.2.cmml" xref="S3.p2.4.m4.2.3.3.2"><times id="S3.p2.4.m4.2.3.3.2.1.cmml" xref="S3.p2.4.m4.2.3.3.2.1"></times><ci id="S3.p2.4.m4.2.3.3.2.2.cmml" xref="S3.p2.4.m4.2.3.3.2.2">𝜋</ci><ci id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1">𝑎</ci></apply><cn id="S3.p2.4.m4.2.3.3.4.cmml" type="integer" xref="S3.p2.4.m4.2.3.3.4">0</cn></apply><apply id="S3.p2.4.m4.2.3.3c.cmml" xref="S3.p2.4.m4.2.3.3"><implies id="S3.p2.4.m4.2.3.3.5.cmml" xref="S3.p2.4.m4.2.3.3.5"></implies><share href="https://arxiv.org/html/2405.02141v2#S3.p2.4.m4.2.3.3.4.cmml" id="S3.p2.4.m4.2.3.3d.cmml" xref="S3.p2.4.m4.2.3.3"></share><apply id="S3.p2.4.m4.2.3.3.6.cmml" xref="S3.p2.4.m4.2.3.3.6"><times id="S3.p2.4.m4.2.3.3.6.1.cmml" xref="S3.p2.4.m4.2.3.3.6.1"></times><apply id="S3.p2.4.m4.2.3.3.6.2.cmml" xref="S3.p2.4.m4.2.3.3.6.2"><csymbol cd="ambiguous" id="S3.p2.4.m4.2.3.3.6.2.1.cmml" xref="S3.p2.4.m4.2.3.3.6.2">subscript</csymbol><ci id="S3.p2.4.m4.2.3.3.6.2.2.cmml" xref="S3.p2.4.m4.2.3.3.6.2.2">𝜋</ci><cn id="S3.p2.4.m4.2.3.3.6.2.3.cmml" type="integer" xref="S3.p2.4.m4.2.3.3.6.2.3">0</cn></apply><ci id="S3.p2.4.m4.2.2.cmml" xref="S3.p2.4.m4.2.2">𝑎</ci></apply></apply><apply id="S3.p2.4.m4.2.3.3e.cmml" xref="S3.p2.4.m4.2.3.3"><gt id="S3.p2.4.m4.2.3.3.7.cmml" xref="S3.p2.4.m4.2.3.3.7"></gt><share href="https://arxiv.org/html/2405.02141v2#S3.p2.4.m4.2.3.3.6.cmml" id="S3.p2.4.m4.2.3.3f.cmml" xref="S3.p2.4.m4.2.3.3"></share><cn id="S3.p2.4.m4.2.3.3.8.cmml" type="integer" xref="S3.p2.4.m4.2.3.3.8">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.2c">\forall a\in\mathcal{A}:\pi(a)&gt;0\implies\pi_{0}(a)&gt;0</annotation><annotation encoding="application/x-llamapun" id="S3.p2.4.m4.2d">∀ italic_a ∈ caligraphic_A : italic_π ( italic_a ) &gt; 0 ⟹ italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a ) &gt; 0</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.1">Note that this implies that the <em class="ltx_emph ltx_font_italic" id="S3.p3.1.1">logging</em> policy <em class="ltx_emph ltx_font_italic" id="S3.p3.1.2">should</em> be stochastic.
Whilst a natural consideration for OPL researchers and practitioners, the choice of logging policy is crucial.
We discuss concerns when constructing data collection policies in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S5" title="5. Considerations for logging policies ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<div class="ltx_para" id="S3.p4">
<p class="ltx_p" id="S3.p4.2">Suppose we have a logged dataset <math alttext="\mathcal{D}=\{(a_{i},r_{i})_{i=1}^{N}\}" class="ltx_Math" display="inline" id="S3.p4.1.m1.1"><semantics id="S3.p4.1.m1.1a"><mrow id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p4.1.m1.1.1.3" xref="S3.p4.1.m1.1.1.3.cmml">𝒟</mi><mo id="S3.p4.1.m1.1.1.2" xref="S3.p4.1.m1.1.1.2.cmml">=</mo><mrow id="S3.p4.1.m1.1.1.1.1" xref="S3.p4.1.m1.1.1.1.2.cmml"><mo id="S3.p4.1.m1.1.1.1.1.2" stretchy="false" xref="S3.p4.1.m1.1.1.1.2.cmml">{</mo><msubsup id="S3.p4.1.m1.1.1.1.1.1" xref="S3.p4.1.m1.1.1.1.1.1.cmml"><mrow id="S3.p4.1.m1.1.1.1.1.1.2.2.2" xref="S3.p4.1.m1.1.1.1.1.1.2.2.3.cmml"><mo id="S3.p4.1.m1.1.1.1.1.1.2.2.2.3" stretchy="false" xref="S3.p4.1.m1.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S3.p4.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.p4.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.p4.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.p4.1.m1.1.1.1.1.1.1.1.1.1.2.cmml">a</mi><mi id="S3.p4.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.p4.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.p4.1.m1.1.1.1.1.1.2.2.2.4" xref="S3.p4.1.m1.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S3.p4.1.m1.1.1.1.1.1.2.2.2.2" xref="S3.p4.1.m1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.p4.1.m1.1.1.1.1.1.2.2.2.2.2" xref="S3.p4.1.m1.1.1.1.1.1.2.2.2.2.2.cmml">r</mi><mi id="S3.p4.1.m1.1.1.1.1.1.2.2.2.2.3" xref="S3.p4.1.m1.1.1.1.1.1.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.p4.1.m1.1.1.1.1.1.2.2.2.5" stretchy="false" xref="S3.p4.1.m1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow><mrow id="S3.p4.1.m1.1.1.1.1.1.2.4" xref="S3.p4.1.m1.1.1.1.1.1.2.4.cmml"><mi id="S3.p4.1.m1.1.1.1.1.1.2.4.2" xref="S3.p4.1.m1.1.1.1.1.1.2.4.2.cmml">i</mi><mo id="S3.p4.1.m1.1.1.1.1.1.2.4.1" xref="S3.p4.1.m1.1.1.1.1.1.2.4.1.cmml">=</mo><mn id="S3.p4.1.m1.1.1.1.1.1.2.4.3" xref="S3.p4.1.m1.1.1.1.1.1.2.4.3.cmml">1</mn></mrow><mi id="S3.p4.1.m1.1.1.1.1.1.4" xref="S3.p4.1.m1.1.1.1.1.1.4.cmml">N</mi></msubsup><mo id="S3.p4.1.m1.1.1.1.1.3" stretchy="false" xref="S3.p4.1.m1.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><apply id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1"><eq id="S3.p4.1.m1.1.1.2.cmml" xref="S3.p4.1.m1.1.1.2"></eq><ci id="S3.p4.1.m1.1.1.3.cmml" xref="S3.p4.1.m1.1.1.3">𝒟</ci><set id="S3.p4.1.m1.1.1.1.2.cmml" xref="S3.p4.1.m1.1.1.1.1"><apply id="S3.p4.1.m1.1.1.1.1.1.cmml" xref="S3.p4.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p4.1.m1.1.1.1.1.1.3.cmml" xref="S3.p4.1.m1.1.1.1.1.1">superscript</csymbol><apply id="S3.p4.1.m1.1.1.1.1.1.2.cmml" xref="S3.p4.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p4.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.p4.1.m1.1.1.1.1.1">subscript</csymbol><interval closure="open" id="S3.p4.1.m1.1.1.1.1.1.2.2.3.cmml" xref="S3.p4.1.m1.1.1.1.1.1.2.2.2"><apply id="S3.p4.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.p4.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p4.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.p4.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p4.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.p4.1.m1.1.1.1.1.1.1.1.1.1.2">𝑎</ci><ci id="S3.p4.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.p4.1.m1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.p4.1.m1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.p4.1.m1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.p4.1.m1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.p4.1.m1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.p4.1.m1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.p4.1.m1.1.1.1.1.1.2.2.2.2.2">𝑟</ci><ci id="S3.p4.1.m1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.p4.1.m1.1.1.1.1.1.2.2.2.2.3">𝑖</ci></apply></interval><apply id="S3.p4.1.m1.1.1.1.1.1.2.4.cmml" xref="S3.p4.1.m1.1.1.1.1.1.2.4"><eq id="S3.p4.1.m1.1.1.1.1.1.2.4.1.cmml" xref="S3.p4.1.m1.1.1.1.1.1.2.4.1"></eq><ci id="S3.p4.1.m1.1.1.1.1.1.2.4.2.cmml" xref="S3.p4.1.m1.1.1.1.1.1.2.4.2">𝑖</ci><cn id="S3.p4.1.m1.1.1.1.1.1.2.4.3.cmml" type="integer" xref="S3.p4.1.m1.1.1.1.1.1.2.4.3">1</cn></apply></apply><ci id="S3.p4.1.m1.1.1.1.1.1.4.cmml" xref="S3.p4.1.m1.1.1.1.1.1.4">𝑁</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">\mathcal{D}=\{(a_{i},r_{i})_{i=1}^{N}\}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.1.m1.1d">caligraphic_D = { ( italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT }</annotation></semantics></math>, where actions were sampled according to the logging policy: <math alttext="a_{i}\sim\pi_{0}(A)" class="ltx_Math" display="inline" id="S3.p4.2.m2.1"><semantics id="S3.p4.2.m2.1a"><mrow id="S3.p4.2.m2.1.2" xref="S3.p4.2.m2.1.2.cmml"><msub id="S3.p4.2.m2.1.2.2" xref="S3.p4.2.m2.1.2.2.cmml"><mi id="S3.p4.2.m2.1.2.2.2" xref="S3.p4.2.m2.1.2.2.2.cmml">a</mi><mi id="S3.p4.2.m2.1.2.2.3" xref="S3.p4.2.m2.1.2.2.3.cmml">i</mi></msub><mo id="S3.p4.2.m2.1.2.1" xref="S3.p4.2.m2.1.2.1.cmml">∼</mo><mrow id="S3.p4.2.m2.1.2.3" xref="S3.p4.2.m2.1.2.3.cmml"><msub id="S3.p4.2.m2.1.2.3.2" xref="S3.p4.2.m2.1.2.3.2.cmml"><mi id="S3.p4.2.m2.1.2.3.2.2" xref="S3.p4.2.m2.1.2.3.2.2.cmml">π</mi><mn id="S3.p4.2.m2.1.2.3.2.3" xref="S3.p4.2.m2.1.2.3.2.3.cmml">0</mn></msub><mo id="S3.p4.2.m2.1.2.3.1" xref="S3.p4.2.m2.1.2.3.1.cmml">⁢</mo><mrow id="S3.p4.2.m2.1.2.3.3.2" xref="S3.p4.2.m2.1.2.3.cmml"><mo id="S3.p4.2.m2.1.2.3.3.2.1" stretchy="false" xref="S3.p4.2.m2.1.2.3.cmml">(</mo><mi id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml">A</mi><mo id="S3.p4.2.m2.1.2.3.3.2.2" stretchy="false" xref="S3.p4.2.m2.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.1b"><apply id="S3.p4.2.m2.1.2.cmml" xref="S3.p4.2.m2.1.2"><csymbol cd="latexml" id="S3.p4.2.m2.1.2.1.cmml" xref="S3.p4.2.m2.1.2.1">similar-to</csymbol><apply id="S3.p4.2.m2.1.2.2.cmml" xref="S3.p4.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.p4.2.m2.1.2.2.1.cmml" xref="S3.p4.2.m2.1.2.2">subscript</csymbol><ci id="S3.p4.2.m2.1.2.2.2.cmml" xref="S3.p4.2.m2.1.2.2.2">𝑎</ci><ci id="S3.p4.2.m2.1.2.2.3.cmml" xref="S3.p4.2.m2.1.2.2.3">𝑖</ci></apply><apply id="S3.p4.2.m2.1.2.3.cmml" xref="S3.p4.2.m2.1.2.3"><times id="S3.p4.2.m2.1.2.3.1.cmml" xref="S3.p4.2.m2.1.2.3.1"></times><apply id="S3.p4.2.m2.1.2.3.2.cmml" xref="S3.p4.2.m2.1.2.3.2"><csymbol cd="ambiguous" id="S3.p4.2.m2.1.2.3.2.1.cmml" xref="S3.p4.2.m2.1.2.3.2">subscript</csymbol><ci id="S3.p4.2.m2.1.2.3.2.2.cmml" xref="S3.p4.2.m2.1.2.3.2.2">𝜋</ci><cn id="S3.p4.2.m2.1.2.3.2.3.cmml" type="integer" xref="S3.p4.2.m2.1.2.3.2.3">0</cn></apply><ci id="S3.p4.2.m2.1.1.cmml" xref="S3.p4.2.m2.1.1">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.1c">a_{i}\sim\pi_{0}(A)</annotation><annotation encoding="application/x-llamapun" id="S3.p4.2.m2.1d">italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∼ italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_A )</annotation></semantics></math>.
Then, we can get a sample estimate for the quantity in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S3.E3" title="In 3. Multivariate Off-Policy Learning ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">3</span></a> as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\widehat{V}_{\rm IPS}(\pi_{\theta},\mathcal{D})=\frac{1}{|\mathcal{D}|}\sum_{(%
a,r)\in\mathcal{D}}\frac{\pi_{\theta}(a)}{\pi_{0}(a)}r." class="ltx_Math" display="block" id="S3.E4.m1.7"><semantics id="S3.E4.m1.7a"><mrow id="S3.E4.m1.7.7.1" xref="S3.E4.m1.7.7.1.1.cmml"><mrow id="S3.E4.m1.7.7.1.1" xref="S3.E4.m1.7.7.1.1.cmml"><mrow id="S3.E4.m1.7.7.1.1.1" xref="S3.E4.m1.7.7.1.1.1.cmml"><msub id="S3.E4.m1.7.7.1.1.1.3" xref="S3.E4.m1.7.7.1.1.1.3.cmml"><mover accent="true" id="S3.E4.m1.7.7.1.1.1.3.2" xref="S3.E4.m1.7.7.1.1.1.3.2.cmml"><mi id="S3.E4.m1.7.7.1.1.1.3.2.2" xref="S3.E4.m1.7.7.1.1.1.3.2.2.cmml">V</mi><mo id="S3.E4.m1.7.7.1.1.1.3.2.1" xref="S3.E4.m1.7.7.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E4.m1.7.7.1.1.1.3.3" xref="S3.E4.m1.7.7.1.1.1.3.3.cmml">IPS</mi></msub><mo id="S3.E4.m1.7.7.1.1.1.2" xref="S3.E4.m1.7.7.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.7.7.1.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.2.cmml"><mo id="S3.E4.m1.7.7.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.7.7.1.1.1.1.2.cmml">(</mo><msub id="S3.E4.m1.7.7.1.1.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.7.7.1.1.1.1.1.1.2" xref="S3.E4.m1.7.7.1.1.1.1.1.1.2.cmml">π</mi><mi id="S3.E4.m1.7.7.1.1.1.1.1.1.3" xref="S3.E4.m1.7.7.1.1.1.1.1.1.3.cmml">θ</mi></msub><mo id="S3.E4.m1.7.7.1.1.1.1.1.3" xref="S3.E4.m1.7.7.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.6.6" xref="S3.E4.m1.6.6.cmml">𝒟</mi><mo id="S3.E4.m1.7.7.1.1.1.1.1.4" stretchy="false" xref="S3.E4.m1.7.7.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.7.7.1.1.2" xref="S3.E4.m1.7.7.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.7.7.1.1.3" xref="S3.E4.m1.7.7.1.1.3.cmml"><mfrac id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><mn id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml">1</mn><mrow id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.1.1.1.2.cmml"><mo id="S3.E4.m1.1.1.1.3.1" stretchy="false" xref="S3.E4.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">𝒟</mi><mo id="S3.E4.m1.1.1.1.3.2" stretchy="false" xref="S3.E4.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S3.E4.m1.7.7.1.1.3.1" xref="S3.E4.m1.7.7.1.1.3.1.cmml">⁢</mo><mrow id="S3.E4.m1.7.7.1.1.3.2" xref="S3.E4.m1.7.7.1.1.3.2.cmml"><munder id="S3.E4.m1.7.7.1.1.3.2.1" xref="S3.E4.m1.7.7.1.1.3.2.1.cmml"><mo id="S3.E4.m1.7.7.1.1.3.2.1.2" movablelimits="false" xref="S3.E4.m1.7.7.1.1.3.2.1.2.cmml">∑</mo><mrow id="S3.E4.m1.3.3.2" xref="S3.E4.m1.3.3.2.cmml"><mrow id="S3.E4.m1.3.3.2.4.2" xref="S3.E4.m1.3.3.2.4.1.cmml"><mo id="S3.E4.m1.3.3.2.4.2.1" stretchy="false" xref="S3.E4.m1.3.3.2.4.1.cmml">(</mo><mi id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml">a</mi><mo id="S3.E4.m1.3.3.2.4.2.2" xref="S3.E4.m1.3.3.2.4.1.cmml">,</mo><mi id="S3.E4.m1.3.3.2.2" xref="S3.E4.m1.3.3.2.2.cmml">r</mi><mo id="S3.E4.m1.3.3.2.4.2.3" stretchy="false" xref="S3.E4.m1.3.3.2.4.1.cmml">)</mo></mrow><mo id="S3.E4.m1.3.3.2.3" xref="S3.E4.m1.3.3.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.3.3.2.5" xref="S3.E4.m1.3.3.2.5.cmml">𝒟</mi></mrow></munder><mrow id="S3.E4.m1.7.7.1.1.3.2.2" xref="S3.E4.m1.7.7.1.1.3.2.2.cmml"><mfrac id="S3.E4.m1.5.5" xref="S3.E4.m1.5.5.cmml"><mrow id="S3.E4.m1.4.4.1" xref="S3.E4.m1.4.4.1.cmml"><msub id="S3.E4.m1.4.4.1.3" xref="S3.E4.m1.4.4.1.3.cmml"><mi id="S3.E4.m1.4.4.1.3.2" xref="S3.E4.m1.4.4.1.3.2.cmml">π</mi><mi id="S3.E4.m1.4.4.1.3.3" xref="S3.E4.m1.4.4.1.3.3.cmml">θ</mi></msub><mo id="S3.E4.m1.4.4.1.2" xref="S3.E4.m1.4.4.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.4.4.1.4.2" xref="S3.E4.m1.4.4.1.cmml"><mo id="S3.E4.m1.4.4.1.4.2.1" stretchy="false" xref="S3.E4.m1.4.4.1.cmml">(</mo><mi id="S3.E4.m1.4.4.1.1" xref="S3.E4.m1.4.4.1.1.cmml">a</mi><mo id="S3.E4.m1.4.4.1.4.2.2" stretchy="false" xref="S3.E4.m1.4.4.1.cmml">)</mo></mrow></mrow><mrow id="S3.E4.m1.5.5.2" xref="S3.E4.m1.5.5.2.cmml"><msub id="S3.E4.m1.5.5.2.3" xref="S3.E4.m1.5.5.2.3.cmml"><mi id="S3.E4.m1.5.5.2.3.2" xref="S3.E4.m1.5.5.2.3.2.cmml">π</mi><mn id="S3.E4.m1.5.5.2.3.3" xref="S3.E4.m1.5.5.2.3.3.cmml">0</mn></msub><mo id="S3.E4.m1.5.5.2.2" xref="S3.E4.m1.5.5.2.2.cmml">⁢</mo><mrow id="S3.E4.m1.5.5.2.4.2" xref="S3.E4.m1.5.5.2.cmml"><mo id="S3.E4.m1.5.5.2.4.2.1" stretchy="false" xref="S3.E4.m1.5.5.2.cmml">(</mo><mi id="S3.E4.m1.5.5.2.1" xref="S3.E4.m1.5.5.2.1.cmml">a</mi><mo id="S3.E4.m1.5.5.2.4.2.2" stretchy="false" xref="S3.E4.m1.5.5.2.cmml">)</mo></mrow></mrow></mfrac><mo id="S3.E4.m1.7.7.1.1.3.2.2.1" xref="S3.E4.m1.7.7.1.1.3.2.2.1.cmml">⁢</mo><mi id="S3.E4.m1.7.7.1.1.3.2.2.2" xref="S3.E4.m1.7.7.1.1.3.2.2.2.cmml">r</mi></mrow></mrow></mrow></mrow><mo id="S3.E4.m1.7.7.1.2" lspace="0em" xref="S3.E4.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.7b"><apply id="S3.E4.m1.7.7.1.1.cmml" xref="S3.E4.m1.7.7.1"><eq id="S3.E4.m1.7.7.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.2"></eq><apply id="S3.E4.m1.7.7.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1"><times id="S3.E4.m1.7.7.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.1.2"></times><apply id="S3.E4.m1.7.7.1.1.1.3.cmml" xref="S3.E4.m1.7.7.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.3.1.cmml" xref="S3.E4.m1.7.7.1.1.1.3">subscript</csymbol><apply id="S3.E4.m1.7.7.1.1.1.3.2.cmml" xref="S3.E4.m1.7.7.1.1.1.3.2"><ci id="S3.E4.m1.7.7.1.1.1.3.2.1.cmml" xref="S3.E4.m1.7.7.1.1.1.3.2.1">^</ci><ci id="S3.E4.m1.7.7.1.1.1.3.2.2.cmml" xref="S3.E4.m1.7.7.1.1.1.3.2.2">𝑉</ci></apply><ci id="S3.E4.m1.7.7.1.1.1.3.3.cmml" xref="S3.E4.m1.7.7.1.1.1.3.3">IPS</ci></apply><interval closure="open" id="S3.E4.m1.7.7.1.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1"><apply id="S3.E4.m1.7.7.1.1.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.2">𝜋</ci><ci id="S3.E4.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.3">𝜃</ci></apply><ci id="S3.E4.m1.6.6.cmml" xref="S3.E4.m1.6.6">𝒟</ci></interval></apply><apply id="S3.E4.m1.7.7.1.1.3.cmml" xref="S3.E4.m1.7.7.1.1.3"><times id="S3.E4.m1.7.7.1.1.3.1.cmml" xref="S3.E4.m1.7.7.1.1.3.1"></times><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><divide id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1"></divide><cn id="S3.E4.m1.1.1.3.cmml" type="integer" xref="S3.E4.m1.1.1.3">1</cn><apply id="S3.E4.m1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.3"><abs id="S3.E4.m1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.3.1"></abs><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝒟</ci></apply></apply><apply id="S3.E4.m1.7.7.1.1.3.2.cmml" xref="S3.E4.m1.7.7.1.1.3.2"><apply id="S3.E4.m1.7.7.1.1.3.2.1.cmml" xref="S3.E4.m1.7.7.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.3.2.1.1.cmml" xref="S3.E4.m1.7.7.1.1.3.2.1">subscript</csymbol><sum id="S3.E4.m1.7.7.1.1.3.2.1.2.cmml" xref="S3.E4.m1.7.7.1.1.3.2.1.2"></sum><apply id="S3.E4.m1.3.3.2.cmml" xref="S3.E4.m1.3.3.2"><in id="S3.E4.m1.3.3.2.3.cmml" xref="S3.E4.m1.3.3.2.3"></in><interval closure="open" id="S3.E4.m1.3.3.2.4.1.cmml" xref="S3.E4.m1.3.3.2.4.2"><ci id="S3.E4.m1.2.2.1.1.cmml" xref="S3.E4.m1.2.2.1.1">𝑎</ci><ci id="S3.E4.m1.3.3.2.2.cmml" xref="S3.E4.m1.3.3.2.2">𝑟</ci></interval><ci id="S3.E4.m1.3.3.2.5.cmml" xref="S3.E4.m1.3.3.2.5">𝒟</ci></apply></apply><apply id="S3.E4.m1.7.7.1.1.3.2.2.cmml" xref="S3.E4.m1.7.7.1.1.3.2.2"><times id="S3.E4.m1.7.7.1.1.3.2.2.1.cmml" xref="S3.E4.m1.7.7.1.1.3.2.2.1"></times><apply id="S3.E4.m1.5.5.cmml" xref="S3.E4.m1.5.5"><divide id="S3.E4.m1.5.5.3.cmml" xref="S3.E4.m1.5.5"></divide><apply id="S3.E4.m1.4.4.1.cmml" xref="S3.E4.m1.4.4.1"><times id="S3.E4.m1.4.4.1.2.cmml" xref="S3.E4.m1.4.4.1.2"></times><apply id="S3.E4.m1.4.4.1.3.cmml" xref="S3.E4.m1.4.4.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.3.1.cmml" xref="S3.E4.m1.4.4.1.3">subscript</csymbol><ci id="S3.E4.m1.4.4.1.3.2.cmml" xref="S3.E4.m1.4.4.1.3.2">𝜋</ci><ci id="S3.E4.m1.4.4.1.3.3.cmml" xref="S3.E4.m1.4.4.1.3.3">𝜃</ci></apply><ci id="S3.E4.m1.4.4.1.1.cmml" xref="S3.E4.m1.4.4.1.1">𝑎</ci></apply><apply id="S3.E4.m1.5.5.2.cmml" xref="S3.E4.m1.5.5.2"><times id="S3.E4.m1.5.5.2.2.cmml" xref="S3.E4.m1.5.5.2.2"></times><apply id="S3.E4.m1.5.5.2.3.cmml" xref="S3.E4.m1.5.5.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.2.3.1.cmml" xref="S3.E4.m1.5.5.2.3">subscript</csymbol><ci id="S3.E4.m1.5.5.2.3.2.cmml" xref="S3.E4.m1.5.5.2.3.2">𝜋</ci><cn id="S3.E4.m1.5.5.2.3.3.cmml" type="integer" xref="S3.E4.m1.5.5.2.3.3">0</cn></apply><ci id="S3.E4.m1.5.5.2.1.cmml" xref="S3.E4.m1.5.5.2.1">𝑎</ci></apply></apply><ci id="S3.E4.m1.7.7.1.1.3.2.2.2.cmml" xref="S3.E4.m1.7.7.1.1.3.2.2.2">𝑟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.7c">\widehat{V}_{\rm IPS}(\pi_{\theta},\mathcal{D})=\frac{1}{|\mathcal{D}|}\sum_{(%
a,r)\in\mathcal{D}}\frac{\pi_{\theta}(a)}{\pi_{0}(a)}r.</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.7d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_IPS end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT , caligraphic_D ) = divide start_ARG 1 end_ARG start_ARG | caligraphic_D | end_ARG ∑ start_POSTSUBSCRIPT ( italic_a , italic_r ) ∈ caligraphic_D end_POSTSUBSCRIPT divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a ) end_ARG italic_r .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.p5">
<p class="ltx_p" id="S3.p5.1">Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S3.E3" title="In 3. Multivariate Off-Policy Learning ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">3</span></a> gives rise to an unbiased estimator for the optimisation objective in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S3.E2" title="In 3. Multivariate Off-Policy Learning ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">2</span></a>, formulated in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S3.E4" title="In 3. Multivariate Off-Policy Learning ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">4</span></a>.
Its variance, however, is often problematic.
A common solution is to introduce a multiplicative control variate to the IPS estimator, and perform <em class="ltx_emph ltx_font_italic" id="S3.p5.1.1">self-normalised</em> importance sampling instead:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbb{E}_{a\sim\pi_{\theta}}[R]=\frac{\mathbb{E}_{a\sim\pi_{0}}\left[\frac{%
\pi_{\theta}(a)}{\pi_{0}(a)}R\right]}{\mathbb{E}_{a\sim\pi_{0}}\left[\frac{\pi%
_{\theta}(a)}{\pi_{0}(a)}\right]}." class="ltx_Math" display="block" id="S3.E5.m1.7"><semantics id="S3.E5.m1.7a"><mrow id="S3.E5.m1.7.7.1" xref="S3.E5.m1.7.7.1.1.cmml"><mrow id="S3.E5.m1.7.7.1.1" xref="S3.E5.m1.7.7.1.1.cmml"><mrow id="S3.E5.m1.7.7.1.1.2" xref="S3.E5.m1.7.7.1.1.2.cmml"><msub id="S3.E5.m1.7.7.1.1.2.2" xref="S3.E5.m1.7.7.1.1.2.2.cmml"><mi id="S3.E5.m1.7.7.1.1.2.2.2" xref="S3.E5.m1.7.7.1.1.2.2.2.cmml">𝔼</mi><mrow id="S3.E5.m1.7.7.1.1.2.2.3" xref="S3.E5.m1.7.7.1.1.2.2.3.cmml"><mi id="S3.E5.m1.7.7.1.1.2.2.3.2" xref="S3.E5.m1.7.7.1.1.2.2.3.2.cmml">a</mi><mo id="S3.E5.m1.7.7.1.1.2.2.3.1" xref="S3.E5.m1.7.7.1.1.2.2.3.1.cmml">∼</mo><msub id="S3.E5.m1.7.7.1.1.2.2.3.3" xref="S3.E5.m1.7.7.1.1.2.2.3.3.cmml"><mi id="S3.E5.m1.7.7.1.1.2.2.3.3.2" xref="S3.E5.m1.7.7.1.1.2.2.3.3.2.cmml">π</mi><mi id="S3.E5.m1.7.7.1.1.2.2.3.3.3" xref="S3.E5.m1.7.7.1.1.2.2.3.3.3.cmml">θ</mi></msub></mrow></msub><mo id="S3.E5.m1.7.7.1.1.2.1" xref="S3.E5.m1.7.7.1.1.2.1.cmml">⁢</mo><mrow id="S3.E5.m1.7.7.1.1.2.3.2" xref="S3.E5.m1.7.7.1.1.2.3.1.cmml"><mo id="S3.E5.m1.7.7.1.1.2.3.2.1" stretchy="false" xref="S3.E5.m1.7.7.1.1.2.3.1.1.cmml">[</mo><mi id="S3.E5.m1.6.6" xref="S3.E5.m1.6.6.cmml">R</mi><mo id="S3.E5.m1.7.7.1.1.2.3.2.2" stretchy="false" xref="S3.E5.m1.7.7.1.1.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.E5.m1.7.7.1.1.1" xref="S3.E5.m1.7.7.1.1.1.cmml">=</mo><mfrac id="S3.E5.m1.5.5" xref="S3.E5.m1.5.5.cmml"><mrow id="S3.E5.m1.3.3.3" xref="S3.E5.m1.3.3.3.cmml"><msub id="S3.E5.m1.3.3.3.5" xref="S3.E5.m1.3.3.3.5.cmml"><mi id="S3.E5.m1.3.3.3.5.2" xref="S3.E5.m1.3.3.3.5.2.cmml">𝔼</mi><mrow id="S3.E5.m1.3.3.3.5.3" xref="S3.E5.m1.3.3.3.5.3.cmml"><mi id="S3.E5.m1.3.3.3.5.3.2" xref="S3.E5.m1.3.3.3.5.3.2.cmml">a</mi><mo id="S3.E5.m1.3.3.3.5.3.1" xref="S3.E5.m1.3.3.3.5.3.1.cmml">∼</mo><msub id="S3.E5.m1.3.3.3.5.3.3" xref="S3.E5.m1.3.3.3.5.3.3.cmml"><mi id="S3.E5.m1.3.3.3.5.3.3.2" xref="S3.E5.m1.3.3.3.5.3.3.2.cmml">π</mi><mn id="S3.E5.m1.3.3.3.5.3.3.3" xref="S3.E5.m1.3.3.3.5.3.3.3.cmml">0</mn></msub></mrow></msub><mo id="S3.E5.m1.3.3.3.4" xref="S3.E5.m1.3.3.3.4.cmml">⁢</mo><mrow id="S3.E5.m1.3.3.3.3.1" xref="S3.E5.m1.3.3.3.3.2.cmml"><mo id="S3.E5.m1.3.3.3.3.1.2" xref="S3.E5.m1.3.3.3.3.2.1.cmml">[</mo><mrow id="S3.E5.m1.3.3.3.3.1.1" xref="S3.E5.m1.3.3.3.3.1.1.cmml"><mfrac id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.2.cmml"><mrow id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.cmml"><msub id="S3.E5.m1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.1.3.2.cmml">π</mi><mi id="S3.E5.m1.1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.E5.m1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.1.1.1.1.1.4.2" xref="S3.E5.m1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.1.1.1.1.1.4.2.1" stretchy="false" xref="S3.E5.m1.1.1.1.1.1.cmml">(</mo><mi id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml">a</mi><mo id="S3.E5.m1.1.1.1.1.1.4.2.2" stretchy="false" xref="S3.E5.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E5.m1.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.cmml"><msub id="S3.E5.m1.2.2.2.2.2.3" xref="S3.E5.m1.2.2.2.2.2.3.cmml"><mi id="S3.E5.m1.2.2.2.2.2.3.2" xref="S3.E5.m1.2.2.2.2.2.3.2.cmml">π</mi><mn id="S3.E5.m1.2.2.2.2.2.3.3" xref="S3.E5.m1.2.2.2.2.2.3.3.cmml">0</mn></msub><mo id="S3.E5.m1.2.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.2.cmml">⁢</mo><mrow id="S3.E5.m1.2.2.2.2.2.4.2" xref="S3.E5.m1.2.2.2.2.2.cmml"><mo id="S3.E5.m1.2.2.2.2.2.4.2.1" stretchy="false" xref="S3.E5.m1.2.2.2.2.2.cmml">(</mo><mi id="S3.E5.m1.2.2.2.2.2.1" xref="S3.E5.m1.2.2.2.2.2.1.cmml">a</mi><mo id="S3.E5.m1.2.2.2.2.2.4.2.2" stretchy="false" xref="S3.E5.m1.2.2.2.2.2.cmml">)</mo></mrow></mrow></mfrac><mo id="S3.E5.m1.3.3.3.3.1.1.1" xref="S3.E5.m1.3.3.3.3.1.1.1.cmml">⁢</mo><mi id="S3.E5.m1.3.3.3.3.1.1.2" xref="S3.E5.m1.3.3.3.3.1.1.2.cmml">R</mi></mrow><mo id="S3.E5.m1.3.3.3.3.1.3" xref="S3.E5.m1.3.3.3.3.2.1.cmml">]</mo></mrow></mrow><mrow id="S3.E5.m1.5.5.5" xref="S3.E5.m1.5.5.5.cmml"><msub id="S3.E5.m1.5.5.5.4" xref="S3.E5.m1.5.5.5.4.cmml"><mi id="S3.E5.m1.5.5.5.4.2" xref="S3.E5.m1.5.5.5.4.2.cmml">𝔼</mi><mrow id="S3.E5.m1.5.5.5.4.3" xref="S3.E5.m1.5.5.5.4.3.cmml"><mi id="S3.E5.m1.5.5.5.4.3.2" xref="S3.E5.m1.5.5.5.4.3.2.cmml">a</mi><mo id="S3.E5.m1.5.5.5.4.3.1" xref="S3.E5.m1.5.5.5.4.3.1.cmml">∼</mo><msub id="S3.E5.m1.5.5.5.4.3.3" xref="S3.E5.m1.5.5.5.4.3.3.cmml"><mi id="S3.E5.m1.5.5.5.4.3.3.2" xref="S3.E5.m1.5.5.5.4.3.3.2.cmml">π</mi><mn id="S3.E5.m1.5.5.5.4.3.3.3" xref="S3.E5.m1.5.5.5.4.3.3.3.cmml">0</mn></msub></mrow></msub><mo id="S3.E5.m1.5.5.5.3" xref="S3.E5.m1.5.5.5.3.cmml">⁢</mo><mrow id="S3.E5.m1.5.5.5.5.2" xref="S3.E5.m1.5.5.5.5.1.cmml"><mo id="S3.E5.m1.5.5.5.5.2.1" xref="S3.E5.m1.5.5.5.5.1.1.cmml">[</mo><mfrac id="S3.E5.m1.5.5.5.2" xref="S3.E5.m1.5.5.5.2.cmml"><mrow id="S3.E5.m1.4.4.4.1.1" xref="S3.E5.m1.4.4.4.1.1.cmml"><msub id="S3.E5.m1.4.4.4.1.1.3" xref="S3.E5.m1.4.4.4.1.1.3.cmml"><mi id="S3.E5.m1.4.4.4.1.1.3.2" xref="S3.E5.m1.4.4.4.1.1.3.2.cmml">π</mi><mi id="S3.E5.m1.4.4.4.1.1.3.3" xref="S3.E5.m1.4.4.4.1.1.3.3.cmml">θ</mi></msub><mo id="S3.E5.m1.4.4.4.1.1.2" xref="S3.E5.m1.4.4.4.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.4.4.4.1.1.4.2" xref="S3.E5.m1.4.4.4.1.1.cmml"><mo id="S3.E5.m1.4.4.4.1.1.4.2.1" stretchy="false" xref="S3.E5.m1.4.4.4.1.1.cmml">(</mo><mi id="S3.E5.m1.4.4.4.1.1.1" xref="S3.E5.m1.4.4.4.1.1.1.cmml">a</mi><mo id="S3.E5.m1.4.4.4.1.1.4.2.2" stretchy="false" xref="S3.E5.m1.4.4.4.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E5.m1.5.5.5.2.2" xref="S3.E5.m1.5.5.5.2.2.cmml"><msub id="S3.E5.m1.5.5.5.2.2.3" xref="S3.E5.m1.5.5.5.2.2.3.cmml"><mi id="S3.E5.m1.5.5.5.2.2.3.2" xref="S3.E5.m1.5.5.5.2.2.3.2.cmml">π</mi><mn id="S3.E5.m1.5.5.5.2.2.3.3" xref="S3.E5.m1.5.5.5.2.2.3.3.cmml">0</mn></msub><mo id="S3.E5.m1.5.5.5.2.2.2" xref="S3.E5.m1.5.5.5.2.2.2.cmml">⁢</mo><mrow id="S3.E5.m1.5.5.5.2.2.4.2" xref="S3.E5.m1.5.5.5.2.2.cmml"><mo id="S3.E5.m1.5.5.5.2.2.4.2.1" stretchy="false" xref="S3.E5.m1.5.5.5.2.2.cmml">(</mo><mi id="S3.E5.m1.5.5.5.2.2.1" xref="S3.E5.m1.5.5.5.2.2.1.cmml">a</mi><mo id="S3.E5.m1.5.5.5.2.2.4.2.2" stretchy="false" xref="S3.E5.m1.5.5.5.2.2.cmml">)</mo></mrow></mrow></mfrac><mo id="S3.E5.m1.5.5.5.5.2.2" xref="S3.E5.m1.5.5.5.5.1.1.cmml">]</mo></mrow></mrow></mfrac></mrow><mo id="S3.E5.m1.7.7.1.2" lspace="0em" xref="S3.E5.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.7b"><apply id="S3.E5.m1.7.7.1.1.cmml" xref="S3.E5.m1.7.7.1"><eq id="S3.E5.m1.7.7.1.1.1.cmml" xref="S3.E5.m1.7.7.1.1.1"></eq><apply id="S3.E5.m1.7.7.1.1.2.cmml" xref="S3.E5.m1.7.7.1.1.2"><times id="S3.E5.m1.7.7.1.1.2.1.cmml" xref="S3.E5.m1.7.7.1.1.2.1"></times><apply id="S3.E5.m1.7.7.1.1.2.2.cmml" xref="S3.E5.m1.7.7.1.1.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.2.2.1.cmml" xref="S3.E5.m1.7.7.1.1.2.2">subscript</csymbol><ci id="S3.E5.m1.7.7.1.1.2.2.2.cmml" xref="S3.E5.m1.7.7.1.1.2.2.2">𝔼</ci><apply id="S3.E5.m1.7.7.1.1.2.2.3.cmml" xref="S3.E5.m1.7.7.1.1.2.2.3"><csymbol cd="latexml" id="S3.E5.m1.7.7.1.1.2.2.3.1.cmml" xref="S3.E5.m1.7.7.1.1.2.2.3.1">similar-to</csymbol><ci id="S3.E5.m1.7.7.1.1.2.2.3.2.cmml" xref="S3.E5.m1.7.7.1.1.2.2.3.2">𝑎</ci><apply id="S3.E5.m1.7.7.1.1.2.2.3.3.cmml" xref="S3.E5.m1.7.7.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.2.2.3.3.1.cmml" xref="S3.E5.m1.7.7.1.1.2.2.3.3">subscript</csymbol><ci id="S3.E5.m1.7.7.1.1.2.2.3.3.2.cmml" xref="S3.E5.m1.7.7.1.1.2.2.3.3.2">𝜋</ci><ci id="S3.E5.m1.7.7.1.1.2.2.3.3.3.cmml" xref="S3.E5.m1.7.7.1.1.2.2.3.3.3">𝜃</ci></apply></apply></apply><apply id="S3.E5.m1.7.7.1.1.2.3.1.cmml" xref="S3.E5.m1.7.7.1.1.2.3.2"><csymbol cd="latexml" id="S3.E5.m1.7.7.1.1.2.3.1.1.cmml" xref="S3.E5.m1.7.7.1.1.2.3.2.1">delimited-[]</csymbol><ci id="S3.E5.m1.6.6.cmml" xref="S3.E5.m1.6.6">𝑅</ci></apply></apply><apply id="S3.E5.m1.5.5.cmml" xref="S3.E5.m1.5.5"><divide id="S3.E5.m1.5.5.6.cmml" xref="S3.E5.m1.5.5"></divide><apply id="S3.E5.m1.3.3.3.cmml" xref="S3.E5.m1.3.3.3"><times id="S3.E5.m1.3.3.3.4.cmml" xref="S3.E5.m1.3.3.3.4"></times><apply id="S3.E5.m1.3.3.3.5.cmml" xref="S3.E5.m1.3.3.3.5"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.3.5.1.cmml" xref="S3.E5.m1.3.3.3.5">subscript</csymbol><ci id="S3.E5.m1.3.3.3.5.2.cmml" xref="S3.E5.m1.3.3.3.5.2">𝔼</ci><apply id="S3.E5.m1.3.3.3.5.3.cmml" xref="S3.E5.m1.3.3.3.5.3"><csymbol cd="latexml" id="S3.E5.m1.3.3.3.5.3.1.cmml" xref="S3.E5.m1.3.3.3.5.3.1">similar-to</csymbol><ci id="S3.E5.m1.3.3.3.5.3.2.cmml" xref="S3.E5.m1.3.3.3.5.3.2">𝑎</ci><apply id="S3.E5.m1.3.3.3.5.3.3.cmml" xref="S3.E5.m1.3.3.3.5.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.3.5.3.3.1.cmml" xref="S3.E5.m1.3.3.3.5.3.3">subscript</csymbol><ci id="S3.E5.m1.3.3.3.5.3.3.2.cmml" xref="S3.E5.m1.3.3.3.5.3.3.2">𝜋</ci><cn id="S3.E5.m1.3.3.3.5.3.3.3.cmml" type="integer" xref="S3.E5.m1.3.3.3.5.3.3.3">0</cn></apply></apply></apply><apply id="S3.E5.m1.3.3.3.3.2.cmml" xref="S3.E5.m1.3.3.3.3.1"><csymbol cd="latexml" id="S3.E5.m1.3.3.3.3.2.1.cmml" xref="S3.E5.m1.3.3.3.3.1.2">delimited-[]</csymbol><apply id="S3.E5.m1.3.3.3.3.1.1.cmml" xref="S3.E5.m1.3.3.3.3.1.1"><times id="S3.E5.m1.3.3.3.3.1.1.1.cmml" xref="S3.E5.m1.3.3.3.3.1.1.1"></times><apply id="S3.E5.m1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2"><divide id="S3.E5.m1.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2"></divide><apply id="S3.E5.m1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1"><times id="S3.E5.m1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.2"></times><apply id="S3.E5.m1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.3.2">𝜋</ci><ci id="S3.E5.m1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.3.3">𝜃</ci></apply><ci id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1">𝑎</ci></apply><apply id="S3.E5.m1.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2"><times id="S3.E5.m1.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2.2"></times><apply id="S3.E5.m1.2.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.2.3.1.cmml" xref="S3.E5.m1.2.2.2.2.2.3">subscript</csymbol><ci id="S3.E5.m1.2.2.2.2.2.3.2.cmml" xref="S3.E5.m1.2.2.2.2.2.3.2">𝜋</ci><cn id="S3.E5.m1.2.2.2.2.2.3.3.cmml" type="integer" xref="S3.E5.m1.2.2.2.2.2.3.3">0</cn></apply><ci id="S3.E5.m1.2.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.2.1">𝑎</ci></apply></apply><ci id="S3.E5.m1.3.3.3.3.1.1.2.cmml" xref="S3.E5.m1.3.3.3.3.1.1.2">𝑅</ci></apply></apply></apply><apply id="S3.E5.m1.5.5.5.cmml" xref="S3.E5.m1.5.5.5"><times id="S3.E5.m1.5.5.5.3.cmml" xref="S3.E5.m1.5.5.5.3"></times><apply id="S3.E5.m1.5.5.5.4.cmml" xref="S3.E5.m1.5.5.5.4"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.5.4.1.cmml" xref="S3.E5.m1.5.5.5.4">subscript</csymbol><ci id="S3.E5.m1.5.5.5.4.2.cmml" xref="S3.E5.m1.5.5.5.4.2">𝔼</ci><apply id="S3.E5.m1.5.5.5.4.3.cmml" xref="S3.E5.m1.5.5.5.4.3"><csymbol cd="latexml" id="S3.E5.m1.5.5.5.4.3.1.cmml" xref="S3.E5.m1.5.5.5.4.3.1">similar-to</csymbol><ci id="S3.E5.m1.5.5.5.4.3.2.cmml" xref="S3.E5.m1.5.5.5.4.3.2">𝑎</ci><apply id="S3.E5.m1.5.5.5.4.3.3.cmml" xref="S3.E5.m1.5.5.5.4.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.5.4.3.3.1.cmml" xref="S3.E5.m1.5.5.5.4.3.3">subscript</csymbol><ci id="S3.E5.m1.5.5.5.4.3.3.2.cmml" xref="S3.E5.m1.5.5.5.4.3.3.2">𝜋</ci><cn id="S3.E5.m1.5.5.5.4.3.3.3.cmml" type="integer" xref="S3.E5.m1.5.5.5.4.3.3.3">0</cn></apply></apply></apply><apply id="S3.E5.m1.5.5.5.5.1.cmml" xref="S3.E5.m1.5.5.5.5.2"><csymbol cd="latexml" id="S3.E5.m1.5.5.5.5.1.1.cmml" xref="S3.E5.m1.5.5.5.5.2.1">delimited-[]</csymbol><apply id="S3.E5.m1.5.5.5.2.cmml" xref="S3.E5.m1.5.5.5.2"><divide id="S3.E5.m1.5.5.5.2.3.cmml" xref="S3.E5.m1.5.5.5.2"></divide><apply id="S3.E5.m1.4.4.4.1.1.cmml" xref="S3.E5.m1.4.4.4.1.1"><times id="S3.E5.m1.4.4.4.1.1.2.cmml" xref="S3.E5.m1.4.4.4.1.1.2"></times><apply id="S3.E5.m1.4.4.4.1.1.3.cmml" xref="S3.E5.m1.4.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.4.1.1.3.1.cmml" xref="S3.E5.m1.4.4.4.1.1.3">subscript</csymbol><ci id="S3.E5.m1.4.4.4.1.1.3.2.cmml" xref="S3.E5.m1.4.4.4.1.1.3.2">𝜋</ci><ci id="S3.E5.m1.4.4.4.1.1.3.3.cmml" xref="S3.E5.m1.4.4.4.1.1.3.3">𝜃</ci></apply><ci id="S3.E5.m1.4.4.4.1.1.1.cmml" xref="S3.E5.m1.4.4.4.1.1.1">𝑎</ci></apply><apply id="S3.E5.m1.5.5.5.2.2.cmml" xref="S3.E5.m1.5.5.5.2.2"><times id="S3.E5.m1.5.5.5.2.2.2.cmml" xref="S3.E5.m1.5.5.5.2.2.2"></times><apply id="S3.E5.m1.5.5.5.2.2.3.cmml" xref="S3.E5.m1.5.5.5.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.5.2.2.3.1.cmml" xref="S3.E5.m1.5.5.5.2.2.3">subscript</csymbol><ci id="S3.E5.m1.5.5.5.2.2.3.2.cmml" xref="S3.E5.m1.5.5.5.2.2.3.2">𝜋</ci><cn id="S3.E5.m1.5.5.5.2.2.3.3.cmml" type="integer" xref="S3.E5.m1.5.5.5.2.2.3.3">0</cn></apply><ci id="S3.E5.m1.5.5.5.2.2.1.cmml" xref="S3.E5.m1.5.5.5.2.2.1">𝑎</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.7c">\mathbb{E}_{a\sim\pi_{\theta}}[R]=\frac{\mathbb{E}_{a\sim\pi_{0}}\left[\frac{%
\pi_{\theta}(a)}{\pi_{0}(a)}R\right]}{\mathbb{E}_{a\sim\pi_{0}}\left[\frac{\pi%
_{\theta}(a)}{\pi_{0}(a)}\right]}.</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.7d">blackboard_E start_POSTSUBSCRIPT italic_a ∼ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ italic_R ] = divide start_ARG blackboard_E start_POSTSUBSCRIPT italic_a ∼ italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a ) end_ARG italic_R ] end_ARG start_ARG blackboard_E start_POSTSUBSCRIPT italic_a ∼ italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a ) end_ARG ] end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p5.2">Indeed, the denominator on the right-hand side of this equation equals 1 if the common support assumption is met <cite class="ltx_cite ltx_citemacro_citep">(London and Joachims, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib42" title="">2022</a>)</cite>.
Sample average approximations for this Self-Normalised IPS (SNIPS) estimator typically enjoy significantly reduced variance over the IPS estimator, whilst remaining asymptotically unbiased <cite class="ltx_cite ltx_citemacro_citep">(Kong, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib38" title="">1992</a>)</cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\widehat{V}_{\rm SNIPS}(\pi_{\theta},\mathcal{D})=\frac{\sum_{(a,r)\in\mathcal%
{D}}\frac{\pi_{\theta}(a)}{\pi_{0}(a)}r}{\sum_{(a,r)\in\mathcal{D}}\frac{\pi_{%
\theta}(a)}{\pi_{0}(a)}}." class="ltx_Math" display="block" id="S3.E6.m1.10"><semantics id="S3.E6.m1.10a"><mrow id="S3.E6.m1.10.10.1" xref="S3.E6.m1.10.10.1.1.cmml"><mrow id="S3.E6.m1.10.10.1.1" xref="S3.E6.m1.10.10.1.1.cmml"><mrow id="S3.E6.m1.10.10.1.1.1" xref="S3.E6.m1.10.10.1.1.1.cmml"><msub id="S3.E6.m1.10.10.1.1.1.3" xref="S3.E6.m1.10.10.1.1.1.3.cmml"><mover accent="true" id="S3.E6.m1.10.10.1.1.1.3.2" xref="S3.E6.m1.10.10.1.1.1.3.2.cmml"><mi id="S3.E6.m1.10.10.1.1.1.3.2.2" xref="S3.E6.m1.10.10.1.1.1.3.2.2.cmml">V</mi><mo id="S3.E6.m1.10.10.1.1.1.3.2.1" xref="S3.E6.m1.10.10.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E6.m1.10.10.1.1.1.3.3" xref="S3.E6.m1.10.10.1.1.1.3.3.cmml">SNIPS</mi></msub><mo id="S3.E6.m1.10.10.1.1.1.2" xref="S3.E6.m1.10.10.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.10.10.1.1.1.1.1" xref="S3.E6.m1.10.10.1.1.1.1.2.cmml"><mo id="S3.E6.m1.10.10.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.10.10.1.1.1.1.2.cmml">(</mo><msub id="S3.E6.m1.10.10.1.1.1.1.1.1" xref="S3.E6.m1.10.10.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.10.10.1.1.1.1.1.1.2" xref="S3.E6.m1.10.10.1.1.1.1.1.1.2.cmml">π</mi><mi id="S3.E6.m1.10.10.1.1.1.1.1.1.3" xref="S3.E6.m1.10.10.1.1.1.1.1.1.3.cmml">θ</mi></msub><mo id="S3.E6.m1.10.10.1.1.1.1.1.3" xref="S3.E6.m1.10.10.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.9.9" xref="S3.E6.m1.9.9.cmml">𝒟</mi><mo id="S3.E6.m1.10.10.1.1.1.1.1.4" stretchy="false" xref="S3.E6.m1.10.10.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.10.10.1.1.2" xref="S3.E6.m1.10.10.1.1.2.cmml">=</mo><mfrac id="S3.E6.m1.8.8" xref="S3.E6.m1.8.8.cmml"><mrow id="S3.E6.m1.4.4.4" xref="S3.E6.m1.4.4.4.cmml"><msub id="S3.E6.m1.4.4.4.5" xref="S3.E6.m1.4.4.4.5.cmml"><mo id="S3.E6.m1.4.4.4.5.2" xref="S3.E6.m1.4.4.4.5.2.cmml">∑</mo><mrow id="S3.E6.m1.2.2.2.2.2" xref="S3.E6.m1.2.2.2.2.2.cmml"><mrow id="S3.E6.m1.2.2.2.2.2.4.2" xref="S3.E6.m1.2.2.2.2.2.4.1.cmml"><mo id="S3.E6.m1.2.2.2.2.2.4.2.1" stretchy="false" xref="S3.E6.m1.2.2.2.2.2.4.1.cmml">(</mo><mi id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml">a</mi><mo id="S3.E6.m1.2.2.2.2.2.4.2.2" xref="S3.E6.m1.2.2.2.2.2.4.1.cmml">,</mo><mi id="S3.E6.m1.2.2.2.2.2.2" xref="S3.E6.m1.2.2.2.2.2.2.cmml">r</mi><mo id="S3.E6.m1.2.2.2.2.2.4.2.3" stretchy="false" xref="S3.E6.m1.2.2.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.E6.m1.2.2.2.2.2.3" xref="S3.E6.m1.2.2.2.2.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.2.2.2.2.2.5" xref="S3.E6.m1.2.2.2.2.2.5.cmml">𝒟</mi></mrow></msub><mrow id="S3.E6.m1.4.4.4.6" xref="S3.E6.m1.4.4.4.6.cmml"><mfrac id="S3.E6.m1.4.4.4.4" xref="S3.E6.m1.4.4.4.4.cmml"><mrow id="S3.E6.m1.3.3.3.3.1" xref="S3.E6.m1.3.3.3.3.1.cmml"><msub id="S3.E6.m1.3.3.3.3.1.3" xref="S3.E6.m1.3.3.3.3.1.3.cmml"><mi id="S3.E6.m1.3.3.3.3.1.3.2" xref="S3.E6.m1.3.3.3.3.1.3.2.cmml">π</mi><mi id="S3.E6.m1.3.3.3.3.1.3.3" xref="S3.E6.m1.3.3.3.3.1.3.3.cmml">θ</mi></msub><mo id="S3.E6.m1.3.3.3.3.1.2" xref="S3.E6.m1.3.3.3.3.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.3.3.3.3.1.4.2" xref="S3.E6.m1.3.3.3.3.1.cmml"><mo id="S3.E6.m1.3.3.3.3.1.4.2.1" stretchy="false" xref="S3.E6.m1.3.3.3.3.1.cmml">(</mo><mi id="S3.E6.m1.3.3.3.3.1.1" xref="S3.E6.m1.3.3.3.3.1.1.cmml">a</mi><mo id="S3.E6.m1.3.3.3.3.1.4.2.2" stretchy="false" xref="S3.E6.m1.3.3.3.3.1.cmml">)</mo></mrow></mrow><mrow id="S3.E6.m1.4.4.4.4.2" xref="S3.E6.m1.4.4.4.4.2.cmml"><msub id="S3.E6.m1.4.4.4.4.2.3" xref="S3.E6.m1.4.4.4.4.2.3.cmml"><mi id="S3.E6.m1.4.4.4.4.2.3.2" xref="S3.E6.m1.4.4.4.4.2.3.2.cmml">π</mi><mn id="S3.E6.m1.4.4.4.4.2.3.3" xref="S3.E6.m1.4.4.4.4.2.3.3.cmml">0</mn></msub><mo id="S3.E6.m1.4.4.4.4.2.2" xref="S3.E6.m1.4.4.4.4.2.2.cmml">⁢</mo><mrow id="S3.E6.m1.4.4.4.4.2.4.2" xref="S3.E6.m1.4.4.4.4.2.cmml"><mo id="S3.E6.m1.4.4.4.4.2.4.2.1" stretchy="false" xref="S3.E6.m1.4.4.4.4.2.cmml">(</mo><mi id="S3.E6.m1.4.4.4.4.2.1" xref="S3.E6.m1.4.4.4.4.2.1.cmml">a</mi><mo id="S3.E6.m1.4.4.4.4.2.4.2.2" stretchy="false" xref="S3.E6.m1.4.4.4.4.2.cmml">)</mo></mrow></mrow></mfrac><mo id="S3.E6.m1.4.4.4.6.1" xref="S3.E6.m1.4.4.4.6.1.cmml">⁢</mo><mi id="S3.E6.m1.4.4.4.6.2" xref="S3.E6.m1.4.4.4.6.2.cmml">r</mi></mrow></mrow><mrow id="S3.E6.m1.8.8.8" xref="S3.E6.m1.8.8.8.cmml"><msub id="S3.E6.m1.8.8.8.5" xref="S3.E6.m1.8.8.8.5.cmml"><mo id="S3.E6.m1.8.8.8.5.2" xref="S3.E6.m1.8.8.8.5.2.cmml">∑</mo><mrow id="S3.E6.m1.6.6.6.2.2" xref="S3.E6.m1.6.6.6.2.2.cmml"><mrow id="S3.E6.m1.6.6.6.2.2.4.2" xref="S3.E6.m1.6.6.6.2.2.4.1.cmml"><mo id="S3.E6.m1.6.6.6.2.2.4.2.1" stretchy="false" xref="S3.E6.m1.6.6.6.2.2.4.1.cmml">(</mo><mi id="S3.E6.m1.5.5.5.1.1.1" xref="S3.E6.m1.5.5.5.1.1.1.cmml">a</mi><mo id="S3.E6.m1.6.6.6.2.2.4.2.2" xref="S3.E6.m1.6.6.6.2.2.4.1.cmml">,</mo><mi id="S3.E6.m1.6.6.6.2.2.2" xref="S3.E6.m1.6.6.6.2.2.2.cmml">r</mi><mo id="S3.E6.m1.6.6.6.2.2.4.2.3" stretchy="false" xref="S3.E6.m1.6.6.6.2.2.4.1.cmml">)</mo></mrow><mo id="S3.E6.m1.6.6.6.2.2.3" xref="S3.E6.m1.6.6.6.2.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.6.6.6.2.2.5" xref="S3.E6.m1.6.6.6.2.2.5.cmml">𝒟</mi></mrow></msub><mfrac id="S3.E6.m1.8.8.8.4" xref="S3.E6.m1.8.8.8.4.cmml"><mrow id="S3.E6.m1.7.7.7.3.1" xref="S3.E6.m1.7.7.7.3.1.cmml"><msub id="S3.E6.m1.7.7.7.3.1.3" xref="S3.E6.m1.7.7.7.3.1.3.cmml"><mi id="S3.E6.m1.7.7.7.3.1.3.2" xref="S3.E6.m1.7.7.7.3.1.3.2.cmml">π</mi><mi id="S3.E6.m1.7.7.7.3.1.3.3" xref="S3.E6.m1.7.7.7.3.1.3.3.cmml">θ</mi></msub><mo id="S3.E6.m1.7.7.7.3.1.2" xref="S3.E6.m1.7.7.7.3.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.7.7.7.3.1.4.2" xref="S3.E6.m1.7.7.7.3.1.cmml"><mo id="S3.E6.m1.7.7.7.3.1.4.2.1" stretchy="false" xref="S3.E6.m1.7.7.7.3.1.cmml">(</mo><mi id="S3.E6.m1.7.7.7.3.1.1" xref="S3.E6.m1.7.7.7.3.1.1.cmml">a</mi><mo id="S3.E6.m1.7.7.7.3.1.4.2.2" stretchy="false" xref="S3.E6.m1.7.7.7.3.1.cmml">)</mo></mrow></mrow><mrow id="S3.E6.m1.8.8.8.4.2" xref="S3.E6.m1.8.8.8.4.2.cmml"><msub id="S3.E6.m1.8.8.8.4.2.3" xref="S3.E6.m1.8.8.8.4.2.3.cmml"><mi id="S3.E6.m1.8.8.8.4.2.3.2" xref="S3.E6.m1.8.8.8.4.2.3.2.cmml">π</mi><mn id="S3.E6.m1.8.8.8.4.2.3.3" xref="S3.E6.m1.8.8.8.4.2.3.3.cmml">0</mn></msub><mo id="S3.E6.m1.8.8.8.4.2.2" xref="S3.E6.m1.8.8.8.4.2.2.cmml">⁢</mo><mrow id="S3.E6.m1.8.8.8.4.2.4.2" xref="S3.E6.m1.8.8.8.4.2.cmml"><mo id="S3.E6.m1.8.8.8.4.2.4.2.1" stretchy="false" xref="S3.E6.m1.8.8.8.4.2.cmml">(</mo><mi id="S3.E6.m1.8.8.8.4.2.1" xref="S3.E6.m1.8.8.8.4.2.1.cmml">a</mi><mo id="S3.E6.m1.8.8.8.4.2.4.2.2" stretchy="false" xref="S3.E6.m1.8.8.8.4.2.cmml">)</mo></mrow></mrow></mfrac></mrow></mfrac></mrow><mo id="S3.E6.m1.10.10.1.2" lspace="0em" xref="S3.E6.m1.10.10.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.10b"><apply id="S3.E6.m1.10.10.1.1.cmml" xref="S3.E6.m1.10.10.1"><eq id="S3.E6.m1.10.10.1.1.2.cmml" xref="S3.E6.m1.10.10.1.1.2"></eq><apply id="S3.E6.m1.10.10.1.1.1.cmml" xref="S3.E6.m1.10.10.1.1.1"><times id="S3.E6.m1.10.10.1.1.1.2.cmml" xref="S3.E6.m1.10.10.1.1.1.2"></times><apply id="S3.E6.m1.10.10.1.1.1.3.cmml" xref="S3.E6.m1.10.10.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.10.10.1.1.1.3.1.cmml" xref="S3.E6.m1.10.10.1.1.1.3">subscript</csymbol><apply id="S3.E6.m1.10.10.1.1.1.3.2.cmml" xref="S3.E6.m1.10.10.1.1.1.3.2"><ci id="S3.E6.m1.10.10.1.1.1.3.2.1.cmml" xref="S3.E6.m1.10.10.1.1.1.3.2.1">^</ci><ci id="S3.E6.m1.10.10.1.1.1.3.2.2.cmml" xref="S3.E6.m1.10.10.1.1.1.3.2.2">𝑉</ci></apply><ci id="S3.E6.m1.10.10.1.1.1.3.3.cmml" xref="S3.E6.m1.10.10.1.1.1.3.3">SNIPS</ci></apply><interval closure="open" id="S3.E6.m1.10.10.1.1.1.1.2.cmml" xref="S3.E6.m1.10.10.1.1.1.1.1"><apply id="S3.E6.m1.10.10.1.1.1.1.1.1.cmml" xref="S3.E6.m1.10.10.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.10.10.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.10.10.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.10.10.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.10.10.1.1.1.1.1.1.2">𝜋</ci><ci id="S3.E6.m1.10.10.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.10.10.1.1.1.1.1.1.3">𝜃</ci></apply><ci id="S3.E6.m1.9.9.cmml" xref="S3.E6.m1.9.9">𝒟</ci></interval></apply><apply id="S3.E6.m1.8.8.cmml" xref="S3.E6.m1.8.8"><divide id="S3.E6.m1.8.8.9.cmml" xref="S3.E6.m1.8.8"></divide><apply id="S3.E6.m1.4.4.4.cmml" xref="S3.E6.m1.4.4.4"><apply id="S3.E6.m1.4.4.4.5.cmml" xref="S3.E6.m1.4.4.4.5"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.4.5.1.cmml" xref="S3.E6.m1.4.4.4.5">subscript</csymbol><sum id="S3.E6.m1.4.4.4.5.2.cmml" xref="S3.E6.m1.4.4.4.5.2"></sum><apply id="S3.E6.m1.2.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2.2"><in id="S3.E6.m1.2.2.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.2.2.3"></in><interval closure="open" id="S3.E6.m1.2.2.2.2.2.4.1.cmml" xref="S3.E6.m1.2.2.2.2.2.4.2"><ci id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1">𝑎</ci><ci id="S3.E6.m1.2.2.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2.2.2">𝑟</ci></interval><ci id="S3.E6.m1.2.2.2.2.2.5.cmml" xref="S3.E6.m1.2.2.2.2.2.5">𝒟</ci></apply></apply><apply id="S3.E6.m1.4.4.4.6.cmml" xref="S3.E6.m1.4.4.4.6"><times id="S3.E6.m1.4.4.4.6.1.cmml" xref="S3.E6.m1.4.4.4.6.1"></times><apply id="S3.E6.m1.4.4.4.4.cmml" xref="S3.E6.m1.4.4.4.4"><divide id="S3.E6.m1.4.4.4.4.3.cmml" xref="S3.E6.m1.4.4.4.4"></divide><apply id="S3.E6.m1.3.3.3.3.1.cmml" xref="S3.E6.m1.3.3.3.3.1"><times id="S3.E6.m1.3.3.3.3.1.2.cmml" xref="S3.E6.m1.3.3.3.3.1.2"></times><apply id="S3.E6.m1.3.3.3.3.1.3.cmml" xref="S3.E6.m1.3.3.3.3.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.3.3.1.3.1.cmml" xref="S3.E6.m1.3.3.3.3.1.3">subscript</csymbol><ci id="S3.E6.m1.3.3.3.3.1.3.2.cmml" xref="S3.E6.m1.3.3.3.3.1.3.2">𝜋</ci><ci id="S3.E6.m1.3.3.3.3.1.3.3.cmml" xref="S3.E6.m1.3.3.3.3.1.3.3">𝜃</ci></apply><ci id="S3.E6.m1.3.3.3.3.1.1.cmml" xref="S3.E6.m1.3.3.3.3.1.1">𝑎</ci></apply><apply id="S3.E6.m1.4.4.4.4.2.cmml" xref="S3.E6.m1.4.4.4.4.2"><times id="S3.E6.m1.4.4.4.4.2.2.cmml" xref="S3.E6.m1.4.4.4.4.2.2"></times><apply id="S3.E6.m1.4.4.4.4.2.3.cmml" xref="S3.E6.m1.4.4.4.4.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.4.4.2.3.1.cmml" xref="S3.E6.m1.4.4.4.4.2.3">subscript</csymbol><ci id="S3.E6.m1.4.4.4.4.2.3.2.cmml" xref="S3.E6.m1.4.4.4.4.2.3.2">𝜋</ci><cn id="S3.E6.m1.4.4.4.4.2.3.3.cmml" type="integer" xref="S3.E6.m1.4.4.4.4.2.3.3">0</cn></apply><ci id="S3.E6.m1.4.4.4.4.2.1.cmml" xref="S3.E6.m1.4.4.4.4.2.1">𝑎</ci></apply></apply><ci id="S3.E6.m1.4.4.4.6.2.cmml" xref="S3.E6.m1.4.4.4.6.2">𝑟</ci></apply></apply><apply id="S3.E6.m1.8.8.8.cmml" xref="S3.E6.m1.8.8.8"><apply id="S3.E6.m1.8.8.8.5.cmml" xref="S3.E6.m1.8.8.8.5"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.8.5.1.cmml" xref="S3.E6.m1.8.8.8.5">subscript</csymbol><sum id="S3.E6.m1.8.8.8.5.2.cmml" xref="S3.E6.m1.8.8.8.5.2"></sum><apply id="S3.E6.m1.6.6.6.2.2.cmml" xref="S3.E6.m1.6.6.6.2.2"><in id="S3.E6.m1.6.6.6.2.2.3.cmml" xref="S3.E6.m1.6.6.6.2.2.3"></in><interval closure="open" id="S3.E6.m1.6.6.6.2.2.4.1.cmml" xref="S3.E6.m1.6.6.6.2.2.4.2"><ci id="S3.E6.m1.5.5.5.1.1.1.cmml" xref="S3.E6.m1.5.5.5.1.1.1">𝑎</ci><ci id="S3.E6.m1.6.6.6.2.2.2.cmml" xref="S3.E6.m1.6.6.6.2.2.2">𝑟</ci></interval><ci id="S3.E6.m1.6.6.6.2.2.5.cmml" xref="S3.E6.m1.6.6.6.2.2.5">𝒟</ci></apply></apply><apply id="S3.E6.m1.8.8.8.4.cmml" xref="S3.E6.m1.8.8.8.4"><divide id="S3.E6.m1.8.8.8.4.3.cmml" xref="S3.E6.m1.8.8.8.4"></divide><apply id="S3.E6.m1.7.7.7.3.1.cmml" xref="S3.E6.m1.7.7.7.3.1"><times id="S3.E6.m1.7.7.7.3.1.2.cmml" xref="S3.E6.m1.7.7.7.3.1.2"></times><apply id="S3.E6.m1.7.7.7.3.1.3.cmml" xref="S3.E6.m1.7.7.7.3.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.7.3.1.3.1.cmml" xref="S3.E6.m1.7.7.7.3.1.3">subscript</csymbol><ci id="S3.E6.m1.7.7.7.3.1.3.2.cmml" xref="S3.E6.m1.7.7.7.3.1.3.2">𝜋</ci><ci id="S3.E6.m1.7.7.7.3.1.3.3.cmml" xref="S3.E6.m1.7.7.7.3.1.3.3">𝜃</ci></apply><ci id="S3.E6.m1.7.7.7.3.1.1.cmml" xref="S3.E6.m1.7.7.7.3.1.1">𝑎</ci></apply><apply id="S3.E6.m1.8.8.8.4.2.cmml" xref="S3.E6.m1.8.8.8.4.2"><times id="S3.E6.m1.8.8.8.4.2.2.cmml" xref="S3.E6.m1.8.8.8.4.2.2"></times><apply id="S3.E6.m1.8.8.8.4.2.3.cmml" xref="S3.E6.m1.8.8.8.4.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.8.4.2.3.1.cmml" xref="S3.E6.m1.8.8.8.4.2.3">subscript</csymbol><ci id="S3.E6.m1.8.8.8.4.2.3.2.cmml" xref="S3.E6.m1.8.8.8.4.2.3.2">𝜋</ci><cn id="S3.E6.m1.8.8.8.4.2.3.3.cmml" type="integer" xref="S3.E6.m1.8.8.8.4.2.3.3">0</cn></apply><ci id="S3.E6.m1.8.8.8.4.2.1.cmml" xref="S3.E6.m1.8.8.8.4.2.1">𝑎</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.10c">\widehat{V}_{\rm SNIPS}(\pi_{\theta},\mathcal{D})=\frac{\sum_{(a,r)\in\mathcal%
{D}}\frac{\pi_{\theta}(a)}{\pi_{0}(a)}r}{\sum_{(a,r)\in\mathcal{D}}\frac{\pi_{%
\theta}(a)}{\pi_{0}(a)}}.</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.10d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_SNIPS end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT , caligraphic_D ) = divide start_ARG ∑ start_POSTSUBSCRIPT ( italic_a , italic_r ) ∈ caligraphic_D end_POSTSUBSCRIPT divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a ) end_ARG italic_r end_ARG start_ARG ∑ start_POSTSUBSCRIPT ( italic_a , italic_r ) ∈ caligraphic_D end_POSTSUBSCRIPT divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a ) end_ARG end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p5.3">Reducing the variance of the estimator does not solve all problems.
Indeed, we run into Goodhart’s law, often paraphrased as: “<span class="ltx_text ltx_font_italic" id="S3.p5.3.1">when a measure becomes a target, it ceases to be a good measure</span>” <cite class="ltx_cite ltx_citemacro_citep">(Goodhart, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib19" title="">1984</a>)</cite>.
In other words, maximising it directly likely leads to overfitting.</p>
</div>
<div class="ltx_para" id="S3.p6">
<p class="ltx_p" id="S3.p6.1">To deal with this, the Counterfactual Risk Minimisation (CRM) paradigm proposes to optimise a lower bound on the true reward instead, either for IPS <cite class="ltx_cite ltx_citemacro_citep">(Swaminathan and Joachims, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib60" title="">2015a</a>)</cite> or SNIPS <cite class="ltx_cite ltx_citemacro_citep">(Swaminathan and Joachims, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib61" title="">2015b</a>)</cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\theta^{\star}=\operatorname*{arg\,max}_{\theta\in\Theta}\widehat{V}_{\rm(SN)%
IPS}(\pi_{\theta},\mathcal{D})-\lambda{\rm Var}\left(\widehat{V}_{\rm(SN)IPS}(%
\pi_{\theta},\mathcal{D})\right)." class="ltx_Math" display="block" id="S3.E7.m1.5"><semantics id="S3.E7.m1.5a"><mrow id="S3.E7.m1.5.5.1" xref="S3.E7.m1.5.5.1.1.cmml"><mrow id="S3.E7.m1.5.5.1.1" xref="S3.E7.m1.5.5.1.1.cmml"><msup id="S3.E7.m1.5.5.1.1.4" xref="S3.E7.m1.5.5.1.1.4.cmml"><mi id="S3.E7.m1.5.5.1.1.4.2" xref="S3.E7.m1.5.5.1.1.4.2.cmml">θ</mi><mo id="S3.E7.m1.5.5.1.1.4.3" xref="S3.E7.m1.5.5.1.1.4.3.cmml">⋆</mo></msup><mo id="S3.E7.m1.5.5.1.1.3" xref="S3.E7.m1.5.5.1.1.3.cmml">=</mo><mrow id="S3.E7.m1.5.5.1.1.2" xref="S3.E7.m1.5.5.1.1.2.cmml"><mrow id="S3.E7.m1.5.5.1.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.cmml"><mrow id="S3.E7.m1.5.5.1.1.1.1.3" xref="S3.E7.m1.5.5.1.1.1.1.3.cmml"><munder id="S3.E7.m1.5.5.1.1.1.1.3.1" xref="S3.E7.m1.5.5.1.1.1.1.3.1.cmml"><mrow id="S3.E7.m1.5.5.1.1.1.1.3.1.2" xref="S3.E7.m1.5.5.1.1.1.1.3.1.2.cmml"><mi id="S3.E7.m1.5.5.1.1.1.1.3.1.2.2" xref="S3.E7.m1.5.5.1.1.1.1.3.1.2.2.cmml">arg</mi><mo id="S3.E7.m1.5.5.1.1.1.1.3.1.2.1" lspace="0.170em" xref="S3.E7.m1.5.5.1.1.1.1.3.1.2.1.cmml">⁢</mo><mi id="S3.E7.m1.5.5.1.1.1.1.3.1.2.3" xref="S3.E7.m1.5.5.1.1.1.1.3.1.2.3.cmml">max</mi></mrow><mrow id="S3.E7.m1.5.5.1.1.1.1.3.1.3" xref="S3.E7.m1.5.5.1.1.1.1.3.1.3.cmml"><mi id="S3.E7.m1.5.5.1.1.1.1.3.1.3.2" xref="S3.E7.m1.5.5.1.1.1.1.3.1.3.2.cmml">θ</mi><mo id="S3.E7.m1.5.5.1.1.1.1.3.1.3.1" xref="S3.E7.m1.5.5.1.1.1.1.3.1.3.1.cmml">∈</mo><mi id="S3.E7.m1.5.5.1.1.1.1.3.1.3.3" mathvariant="normal" xref="S3.E7.m1.5.5.1.1.1.1.3.1.3.3.cmml">Θ</mi></mrow></munder><mo id="S3.E7.m1.5.5.1.1.1.1.3a" xref="S3.E7.m1.5.5.1.1.1.1.3.cmml">⁡</mo><msub id="S3.E7.m1.5.5.1.1.1.1.3.2" xref="S3.E7.m1.5.5.1.1.1.1.3.2.cmml"><mover accent="true" id="S3.E7.m1.5.5.1.1.1.1.3.2.2" xref="S3.E7.m1.5.5.1.1.1.1.3.2.2.cmml"><mi id="S3.E7.m1.5.5.1.1.1.1.3.2.2.2" xref="S3.E7.m1.5.5.1.1.1.1.3.2.2.2.cmml">V</mi><mo id="S3.E7.m1.5.5.1.1.1.1.3.2.2.1" xref="S3.E7.m1.5.5.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mrow id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.cmml"><mo id="S3.E7.m1.1.1.1.3.2.1" stretchy="false" xref="S3.E7.m1.1.1.1.cmml">(</mo><mi id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml">SN</mi><mo id="S3.E7.m1.1.1.1.3.2.2" stretchy="false" xref="S3.E7.m1.1.1.1.cmml">)</mo></mrow><mo id="S3.E7.m1.1.1.1.2" xref="S3.E7.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.4" xref="S3.E7.m1.1.1.1.4.cmml">IPS</mi></mrow></msub></mrow><mo id="S3.E7.m1.5.5.1.1.1.1.2" xref="S3.E7.m1.5.5.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.5.5.1.1.1.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.1.2.cmml"><mo id="S3.E7.m1.5.5.1.1.1.1.1.1.2" stretchy="false" xref="S3.E7.m1.5.5.1.1.1.1.1.2.cmml">(</mo><msub id="S3.E7.m1.5.5.1.1.1.1.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.5.5.1.1.1.1.1.1.1.2" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.2.cmml">π</mi><mi id="S3.E7.m1.5.5.1.1.1.1.1.1.1.3" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.3.cmml">θ</mi></msub><mo id="S3.E7.m1.5.5.1.1.1.1.1.1.3" xref="S3.E7.m1.5.5.1.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.3.3" xref="S3.E7.m1.3.3.cmml">𝒟</mi><mo id="S3.E7.m1.5.5.1.1.1.1.1.1.4" stretchy="false" xref="S3.E7.m1.5.5.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.5.5.1.1.2.3" xref="S3.E7.m1.5.5.1.1.2.3.cmml">−</mo><mrow id="S3.E7.m1.5.5.1.1.2.2" xref="S3.E7.m1.5.5.1.1.2.2.cmml"><mi id="S3.E7.m1.5.5.1.1.2.2.3" xref="S3.E7.m1.5.5.1.1.2.2.3.cmml">λ</mi><mo id="S3.E7.m1.5.5.1.1.2.2.2" xref="S3.E7.m1.5.5.1.1.2.2.2.cmml">⁢</mo><mi id="S3.E7.m1.5.5.1.1.2.2.4" xref="S3.E7.m1.5.5.1.1.2.2.4.cmml">Var</mi><mo id="S3.E7.m1.5.5.1.1.2.2.2a" xref="S3.E7.m1.5.5.1.1.2.2.2.cmml">⁢</mo><mrow id="S3.E7.m1.5.5.1.1.2.2.1.1" xref="S3.E7.m1.5.5.1.1.2.2.1.1.1.cmml"><mo id="S3.E7.m1.5.5.1.1.2.2.1.1.2" xref="S3.E7.m1.5.5.1.1.2.2.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.5.5.1.1.2.2.1.1.1" xref="S3.E7.m1.5.5.1.1.2.2.1.1.1.cmml"><msub id="S3.E7.m1.5.5.1.1.2.2.1.1.1.3" xref="S3.E7.m1.5.5.1.1.2.2.1.1.1.3.cmml"><mover accent="true" id="S3.E7.m1.5.5.1.1.2.2.1.1.1.3.2" xref="S3.E7.m1.5.5.1.1.2.2.1.1.1.3.2.cmml"><mi id="S3.E7.m1.5.5.1.1.2.2.1.1.1.3.2.2" xref="S3.E7.m1.5.5.1.1.2.2.1.1.1.3.2.2.cmml">V</mi><mo id="S3.E7.m1.5.5.1.1.2.2.1.1.1.3.2.1" xref="S3.E7.m1.5.5.1.1.2.2.1.1.1.3.2.1.cmml">^</mo></mover><mrow id="S3.E7.m1.2.2.1" xref="S3.E7.m1.2.2.1.cmml"><mrow id="S3.E7.m1.2.2.1.3.2" xref="S3.E7.m1.2.2.1.cmml"><mo id="S3.E7.m1.2.2.1.3.2.1" stretchy="false" xref="S3.E7.m1.2.2.1.cmml">(</mo><mi id="S3.E7.m1.2.2.1.1" xref="S3.E7.m1.2.2.1.1.cmml">SN</mi><mo id="S3.E7.m1.2.2.1.3.2.2" stretchy="false" xref="S3.E7.m1.2.2.1.cmml">)</mo></mrow><mo id="S3.E7.m1.2.2.1.2" xref="S3.E7.m1.2.2.1.2.cmml">⁢</mo><mi id="S3.E7.m1.2.2.1.4" xref="S3.E7.m1.2.2.1.4.cmml">IPS</mi></mrow></msub><mo id="S3.E7.m1.5.5.1.1.2.2.1.1.1.2" xref="S3.E7.m1.5.5.1.1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.5.5.1.1.2.2.1.1.1.1.1" xref="S3.E7.m1.5.5.1.1.2.2.1.1.1.1.2.cmml"><mo id="S3.E7.m1.5.5.1.1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E7.m1.5.5.1.1.2.2.1.1.1.1.2.cmml">(</mo><msub id="S3.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1" xref="S3.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.2" xref="S3.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.2.cmml">π</mi><mi id="S3.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.3" xref="S3.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.3.cmml">θ</mi></msub><mo id="S3.E7.m1.5.5.1.1.2.2.1.1.1.1.1.3" xref="S3.E7.m1.5.5.1.1.2.2.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.4.4" xref="S3.E7.m1.4.4.cmml">𝒟</mi><mo id="S3.E7.m1.5.5.1.1.2.2.1.1.1.1.1.4" stretchy="false" xref="S3.E7.m1.5.5.1.1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.5.5.1.1.2.2.1.1.3" xref="S3.E7.m1.5.5.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E7.m1.5.5.1.2" lspace="0em" xref="S3.E7.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.5b"><apply id="S3.E7.m1.5.5.1.1.cmml" xref="S3.E7.m1.5.5.1"><eq id="S3.E7.m1.5.5.1.1.3.cmml" xref="S3.E7.m1.5.5.1.1.3"></eq><apply id="S3.E7.m1.5.5.1.1.4.cmml" xref="S3.E7.m1.5.5.1.1.4"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.4.1.cmml" xref="S3.E7.m1.5.5.1.1.4">superscript</csymbol><ci id="S3.E7.m1.5.5.1.1.4.2.cmml" xref="S3.E7.m1.5.5.1.1.4.2">𝜃</ci><ci id="S3.E7.m1.5.5.1.1.4.3.cmml" xref="S3.E7.m1.5.5.1.1.4.3">⋆</ci></apply><apply id="S3.E7.m1.5.5.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.2"><minus id="S3.E7.m1.5.5.1.1.2.3.cmml" xref="S3.E7.m1.5.5.1.1.2.3"></minus><apply id="S3.E7.m1.5.5.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1"><times id="S3.E7.m1.5.5.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.2"></times><apply id="S3.E7.m1.5.5.1.1.1.1.3.cmml" xref="S3.E7.m1.5.5.1.1.1.1.3"><apply id="S3.E7.m1.5.5.1.1.1.1.3.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.1.1.3.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.3.1">subscript</csymbol><apply id="S3.E7.m1.5.5.1.1.1.1.3.1.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.3.1.2"><times id="S3.E7.m1.5.5.1.1.1.1.3.1.2.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.3.1.2.1"></times><ci id="S3.E7.m1.5.5.1.1.1.1.3.1.2.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.3.1.2.2">arg</ci><ci id="S3.E7.m1.5.5.1.1.1.1.3.1.2.3.cmml" xref="S3.E7.m1.5.5.1.1.1.1.3.1.2.3">max</ci></apply><apply id="S3.E7.m1.5.5.1.1.1.1.3.1.3.cmml" xref="S3.E7.m1.5.5.1.1.1.1.3.1.3"><in id="S3.E7.m1.5.5.1.1.1.1.3.1.3.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.3.1.3.1"></in><ci id="S3.E7.m1.5.5.1.1.1.1.3.1.3.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.3.1.3.2">𝜃</ci><ci id="S3.E7.m1.5.5.1.1.1.1.3.1.3.3.cmml" xref="S3.E7.m1.5.5.1.1.1.1.3.1.3.3">Θ</ci></apply></apply><apply id="S3.E7.m1.5.5.1.1.1.1.3.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.3.2">subscript</csymbol><apply id="S3.E7.m1.5.5.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.3.2.2"><ci id="S3.E7.m1.5.5.1.1.1.1.3.2.2.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.3.2.2.1">^</ci><ci id="S3.E7.m1.5.5.1.1.1.1.3.2.2.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.3.2.2.2">𝑉</ci></apply><apply id="S3.E7.m1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"><times id="S3.E7.m1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.2"></times><ci id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1">SN</ci><ci id="S3.E7.m1.1.1.1.4.cmml" xref="S3.E7.m1.1.1.1.4">IPS</ci></apply></apply></apply><interval closure="open" id="S3.E7.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1"><apply id="S3.E7.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.2">𝜋</ci><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.3">𝜃</ci></apply><ci id="S3.E7.m1.3.3.cmml" xref="S3.E7.m1.3.3">𝒟</ci></interval></apply><apply id="S3.E7.m1.5.5.1.1.2.2.cmml" xref="S3.E7.m1.5.5.1.1.2.2"><times id="S3.E7.m1.5.5.1.1.2.2.2.cmml" xref="S3.E7.m1.5.5.1.1.2.2.2"></times><ci id="S3.E7.m1.5.5.1.1.2.2.3.cmml" xref="S3.E7.m1.5.5.1.1.2.2.3">𝜆</ci><ci id="S3.E7.m1.5.5.1.1.2.2.4.cmml" xref="S3.E7.m1.5.5.1.1.2.2.4">Var</ci><apply id="S3.E7.m1.5.5.1.1.2.2.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.2.2.1.1"><times id="S3.E7.m1.5.5.1.1.2.2.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.2.2.1.1.1.2"></times><apply id="S3.E7.m1.5.5.1.1.2.2.1.1.1.3.cmml" xref="S3.E7.m1.5.5.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.2.2.1.1.1.3.1.cmml" xref="S3.E7.m1.5.5.1.1.2.2.1.1.1.3">subscript</csymbol><apply id="S3.E7.m1.5.5.1.1.2.2.1.1.1.3.2.cmml" xref="S3.E7.m1.5.5.1.1.2.2.1.1.1.3.2"><ci id="S3.E7.m1.5.5.1.1.2.2.1.1.1.3.2.1.cmml" xref="S3.E7.m1.5.5.1.1.2.2.1.1.1.3.2.1">^</ci><ci id="S3.E7.m1.5.5.1.1.2.2.1.1.1.3.2.2.cmml" xref="S3.E7.m1.5.5.1.1.2.2.1.1.1.3.2.2">𝑉</ci></apply><apply id="S3.E7.m1.2.2.1.cmml" xref="S3.E7.m1.2.2.1"><times id="S3.E7.m1.2.2.1.2.cmml" xref="S3.E7.m1.2.2.1.2"></times><ci id="S3.E7.m1.2.2.1.1.cmml" xref="S3.E7.m1.2.2.1.1">SN</ci><ci id="S3.E7.m1.2.2.1.4.cmml" xref="S3.E7.m1.2.2.1.4">IPS</ci></apply></apply><interval closure="open" id="S3.E7.m1.5.5.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.2.2.1.1.1.1.1"><apply id="S3.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.2">𝜋</ci><ci id="S3.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.5.5.1.1.2.2.1.1.1.1.1.1.3">𝜃</ci></apply><ci id="S3.E7.m1.4.4.cmml" xref="S3.E7.m1.4.4">𝒟</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.5c">\theta^{\star}=\operatorname*{arg\,max}_{\theta\in\Theta}\widehat{V}_{\rm(SN)%
IPS}(\pi_{\theta},\mathcal{D})-\lambda{\rm Var}\left(\widehat{V}_{\rm(SN)IPS}(%
\pi_{\theta},\mathcal{D})\right).</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.5d">italic_θ start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT = start_OPERATOR roman_arg roman_max end_OPERATOR start_POSTSUBSCRIPT italic_θ ∈ roman_Θ end_POSTSUBSCRIPT over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT ( roman_SN ) roman_IPS end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT , caligraphic_D ) - italic_λ roman_Var ( over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT ( roman_SN ) roman_IPS end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT , caligraphic_D ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.p7">
<p class="ltx_p" id="S3.p7.1">The variance penalisation term is estimated empirically for IPS <cite class="ltx_cite ltx_citemacro_citep">(Maurer and Pontil, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib46" title="">2009</a>)</cite>, and approximated using the delta method for SNIPS <cite class="ltx_cite ltx_citemacro_citep">(Owen, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib52" title="">2013</a>, Eq. 9.9)</cite>.
Naturally, these variance estimates are only useful when confidence intervals constructed using them have the required coverage.
Whilst the Central Limit Theorem (CLT) ensures this <em class="ltx_emph ltx_font_italic" id="S3.p7.1.1">eventually</em>, it might fall short in finite sample scenarios.
We discuss this in detail and propose effective extensions in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S4" title="4. Improving the CRM Lower Bound ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div class="ltx_para" id="S3.p8">
<p class="ltx_p" id="S3.p8.5">Another important aspect to consider is that our action space <math alttext="\mathcal{A}" class="ltx_Math" display="inline" id="S3.p8.1.m1.1"><semantics id="S3.p8.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p8.1.m1.1.1" xref="S3.p8.1.m1.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S3.p8.1.m1.1b"><ci id="S3.p8.1.m1.1.1.cmml" xref="S3.p8.1.m1.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.1.m1.1c">\mathcal{A}</annotation><annotation encoding="application/x-llamapun" id="S3.p8.1.m1.1d">caligraphic_A</annotation></semantics></math> is multivariate and continuous.
This entails that we perform importance sampling with probability <em class="ltx_emph ltx_font_italic" id="S3.p8.5.1">density</em> functions.
In the case of deterministic distributions, these are Dirac delta functions.
In other words, the probability that an observed action <math alttext="a\sim\pi_{0}" class="ltx_Math" display="inline" id="S3.p8.2.m2.1"><semantics id="S3.p8.2.m2.1a"><mrow id="S3.p8.2.m2.1.1" xref="S3.p8.2.m2.1.1.cmml"><mi id="S3.p8.2.m2.1.1.2" xref="S3.p8.2.m2.1.1.2.cmml">a</mi><mo id="S3.p8.2.m2.1.1.1" xref="S3.p8.2.m2.1.1.1.cmml">∼</mo><msub id="S3.p8.2.m2.1.1.3" xref="S3.p8.2.m2.1.1.3.cmml"><mi id="S3.p8.2.m2.1.1.3.2" xref="S3.p8.2.m2.1.1.3.2.cmml">π</mi><mn id="S3.p8.2.m2.1.1.3.3" xref="S3.p8.2.m2.1.1.3.3.cmml">0</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.p8.2.m2.1b"><apply id="S3.p8.2.m2.1.1.cmml" xref="S3.p8.2.m2.1.1"><csymbol cd="latexml" id="S3.p8.2.m2.1.1.1.cmml" xref="S3.p8.2.m2.1.1.1">similar-to</csymbol><ci id="S3.p8.2.m2.1.1.2.cmml" xref="S3.p8.2.m2.1.1.2">𝑎</ci><apply id="S3.p8.2.m2.1.1.3.cmml" xref="S3.p8.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.p8.2.m2.1.1.3.1.cmml" xref="S3.p8.2.m2.1.1.3">subscript</csymbol><ci id="S3.p8.2.m2.1.1.3.2.cmml" xref="S3.p8.2.m2.1.1.3.2">𝜋</ci><cn id="S3.p8.2.m2.1.1.3.3.cmml" type="integer" xref="S3.p8.2.m2.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.2.m2.1c">a\sim\pi_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.p8.2.m2.1d">italic_a ∼ italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> has non-zero density under a <em class="ltx_emph ltx_font_italic" id="S3.p8.5.2">deterministic</em> learnt policy <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S3.p8.3.m3.1"><semantics id="S3.p8.3.m3.1a"><msub id="S3.p8.3.m3.1.1" xref="S3.p8.3.m3.1.1.cmml"><mi id="S3.p8.3.m3.1.1.2" xref="S3.p8.3.m3.1.1.2.cmml">π</mi><mi id="S3.p8.3.m3.1.1.3" xref="S3.p8.3.m3.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p8.3.m3.1b"><apply id="S3.p8.3.m3.1.1.cmml" xref="S3.p8.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p8.3.m3.1.1.1.cmml" xref="S3.p8.3.m3.1.1">subscript</csymbol><ci id="S3.p8.3.m3.1.1.2.cmml" xref="S3.p8.3.m3.1.1.2">𝜋</ci><ci id="S3.p8.3.m3.1.1.3.cmml" xref="S3.p8.3.m3.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.3.m3.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.p8.3.m3.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> <em class="ltx_emph ltx_font_italic" id="S3.p8.5.3">exactly</em> is practically non-existent.
Kernel smoothing techniques have been proposed to deal with this <cite class="ltx_cite ltx_citemacro_citep">(Kallus and Zhou, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib36" title="">2018</a>)</cite>.
A natural choice for the kernel is the Gaussian density function. Letting <math alttext="\theta\equiv\mu" class="ltx_Math" display="inline" id="S3.p8.4.m4.1"><semantics id="S3.p8.4.m4.1a"><mrow id="S3.p8.4.m4.1.1" xref="S3.p8.4.m4.1.1.cmml"><mi id="S3.p8.4.m4.1.1.2" xref="S3.p8.4.m4.1.1.2.cmml">θ</mi><mo id="S3.p8.4.m4.1.1.1" xref="S3.p8.4.m4.1.1.1.cmml">≡</mo><mi id="S3.p8.4.m4.1.1.3" xref="S3.p8.4.m4.1.1.3.cmml">μ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p8.4.m4.1b"><apply id="S3.p8.4.m4.1.1.cmml" xref="S3.p8.4.m4.1.1"><equivalent id="S3.p8.4.m4.1.1.1.cmml" xref="S3.p8.4.m4.1.1.1"></equivalent><ci id="S3.p8.4.m4.1.1.2.cmml" xref="S3.p8.4.m4.1.1.2">𝜃</ci><ci id="S3.p8.4.m4.1.1.3.cmml" xref="S3.p8.4.m4.1.1.3">𝜇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.4.m4.1c">\theta\equiv\mu</annotation><annotation encoding="application/x-llamapun" id="S3.p8.4.m4.1d">italic_θ ≡ italic_μ</annotation></semantics></math> and treating the kernel bandwidth <math alttext="\Sigma" class="ltx_Math" display="inline" id="S3.p8.5.m5.1"><semantics id="S3.p8.5.m5.1a"><mi id="S3.p8.5.m5.1.1" mathvariant="normal" xref="S3.p8.5.m5.1.1.cmml">Σ</mi><annotation-xml encoding="MathML-Content" id="S3.p8.5.m5.1b"><ci id="S3.p8.5.m5.1.1.cmml" xref="S3.p8.5.m5.1.1">Σ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.5.m5.1c">\Sigma</annotation><annotation encoding="application/x-llamapun" id="S3.p8.5.m5.1d">roman_Σ</annotation></semantics></math> as a matrix hyper-parameter, this is given by:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\pi_{\theta}(a)\approx\mathsf{P}(A=a|\mathcal{N}(\mu,\Sigma))=\frac{\exp\left(%
-\frac{1}{2}(a-\mu)^{\top}\Sigma^{-1}(a-\mu)\right)}{(2\pi)^{\frac{d}{2}}\sqrt%
{|\Sigma|}}." class="ltx_Math" display="block" id="S3.E8.m1.8"><semantics id="S3.E8.m1.8a"><mrow id="S3.E8.m1.8.8.1" xref="S3.E8.m1.8.8.1.1.cmml"><mrow id="S3.E8.m1.8.8.1.1" xref="S3.E8.m1.8.8.1.1.cmml"><mrow id="S3.E8.m1.8.8.1.1.3" xref="S3.E8.m1.8.8.1.1.3.cmml"><msub id="S3.E8.m1.8.8.1.1.3.2" xref="S3.E8.m1.8.8.1.1.3.2.cmml"><mi id="S3.E8.m1.8.8.1.1.3.2.2" xref="S3.E8.m1.8.8.1.1.3.2.2.cmml">π</mi><mi id="S3.E8.m1.8.8.1.1.3.2.3" xref="S3.E8.m1.8.8.1.1.3.2.3.cmml">θ</mi></msub><mo id="S3.E8.m1.8.8.1.1.3.1" xref="S3.E8.m1.8.8.1.1.3.1.cmml">⁢</mo><mrow id="S3.E8.m1.8.8.1.1.3.3.2" xref="S3.E8.m1.8.8.1.1.3.cmml"><mo id="S3.E8.m1.8.8.1.1.3.3.2.1" stretchy="false" xref="S3.E8.m1.8.8.1.1.3.cmml">(</mo><mi id="S3.E8.m1.5.5" xref="S3.E8.m1.5.5.cmml">a</mi><mo id="S3.E8.m1.8.8.1.1.3.3.2.2" stretchy="false" xref="S3.E8.m1.8.8.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.8.8.1.1.4" xref="S3.E8.m1.8.8.1.1.4.cmml">≈</mo><mrow id="S3.E8.m1.8.8.1.1.1" xref="S3.E8.m1.8.8.1.1.1.cmml"><mi id="S3.E8.m1.8.8.1.1.1.3" xref="S3.E8.m1.8.8.1.1.1.3.cmml">𝖯</mi><mo id="S3.E8.m1.8.8.1.1.1.2" xref="S3.E8.m1.8.8.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.8.8.1.1.1.1.1" xref="S3.E8.m1.8.8.1.1.1.1.1.1.cmml"><mo id="S3.E8.m1.8.8.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.8.8.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.8.8.1.1.1.1.1.1" xref="S3.E8.m1.8.8.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.8.8.1.1.1.1.1.1.2" xref="S3.E8.m1.8.8.1.1.1.1.1.1.2.cmml">A</mi><mo id="S3.E8.m1.8.8.1.1.1.1.1.1.1" xref="S3.E8.m1.8.8.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E8.m1.8.8.1.1.1.1.1.1.3" xref="S3.E8.m1.8.8.1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.8.8.1.1.1.1.1.1.3.2" xref="S3.E8.m1.8.8.1.1.1.1.1.1.3.2.cmml">a</mi><mo fence="false" id="S3.E8.m1.8.8.1.1.1.1.1.1.3.1" xref="S3.E8.m1.8.8.1.1.1.1.1.1.3.1.cmml">|</mo><mrow id="S3.E8.m1.8.8.1.1.1.1.1.1.3.3" xref="S3.E8.m1.8.8.1.1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.8.8.1.1.1.1.1.1.3.3.2" xref="S3.E8.m1.8.8.1.1.1.1.1.1.3.3.2.cmml">𝒩</mi><mo id="S3.E8.m1.8.8.1.1.1.1.1.1.3.3.1" xref="S3.E8.m1.8.8.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mrow id="S3.E8.m1.8.8.1.1.1.1.1.1.3.3.3.2" xref="S3.E8.m1.8.8.1.1.1.1.1.1.3.3.3.1.cmml"><mo id="S3.E8.m1.8.8.1.1.1.1.1.1.3.3.3.2.1" stretchy="false" xref="S3.E8.m1.8.8.1.1.1.1.1.1.3.3.3.1.cmml">(</mo><mi id="S3.E8.m1.6.6" xref="S3.E8.m1.6.6.cmml">μ</mi><mo id="S3.E8.m1.8.8.1.1.1.1.1.1.3.3.3.2.2" xref="S3.E8.m1.8.8.1.1.1.1.1.1.3.3.3.1.cmml">,</mo><mi id="S3.E8.m1.7.7" mathvariant="normal" xref="S3.E8.m1.7.7.cmml">Σ</mi><mo id="S3.E8.m1.8.8.1.1.1.1.1.1.3.3.3.2.3" stretchy="false" xref="S3.E8.m1.8.8.1.1.1.1.1.1.3.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E8.m1.8.8.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.8.8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.8.8.1.1.5" xref="S3.E8.m1.8.8.1.1.5.cmml">=</mo><mfrac id="S3.E8.m1.4.4" xref="S3.E8.m1.4.4.cmml"><mrow id="S3.E8.m1.2.2.2.2" xref="S3.E8.m1.2.2.2.3.cmml"><mi id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml">exp</mi><mo id="S3.E8.m1.2.2.2.2a" xref="S3.E8.m1.2.2.2.3.cmml">⁡</mo><mrow id="S3.E8.m1.2.2.2.2.1" xref="S3.E8.m1.2.2.2.3.cmml"><mo id="S3.E8.m1.2.2.2.2.1.2" xref="S3.E8.m1.2.2.2.3.cmml">(</mo><mrow id="S3.E8.m1.2.2.2.2.1.1" xref="S3.E8.m1.2.2.2.2.1.1.cmml"><mo id="S3.E8.m1.2.2.2.2.1.1a" xref="S3.E8.m1.2.2.2.2.1.1.cmml">−</mo><mrow id="S3.E8.m1.2.2.2.2.1.1.2" xref="S3.E8.m1.2.2.2.2.1.1.2.cmml"><mfrac id="S3.E8.m1.2.2.2.2.1.1.2.4" xref="S3.E8.m1.2.2.2.2.1.1.2.4.cmml"><mn id="S3.E8.m1.2.2.2.2.1.1.2.4.2" xref="S3.E8.m1.2.2.2.2.1.1.2.4.2.cmml">1</mn><mn id="S3.E8.m1.2.2.2.2.1.1.2.4.3" xref="S3.E8.m1.2.2.2.2.1.1.2.4.3.cmml">2</mn></mfrac><mo id="S3.E8.m1.2.2.2.2.1.1.2.3" xref="S3.E8.m1.2.2.2.2.1.1.2.3.cmml">⁢</mo><msup id="S3.E8.m1.2.2.2.2.1.1.1.1" xref="S3.E8.m1.2.2.2.2.1.1.1.1.cmml"><mrow id="S3.E8.m1.2.2.2.2.1.1.1.1.1.1" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1.1.1.cmml"><mo id="S3.E8.m1.2.2.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.2.2.2.2.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.2.2.2.2.1.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1.1.1.2.cmml">a</mi><mo id="S3.E8.m1.2.2.2.2.1.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E8.m1.2.2.2.2.1.1.1.1.1.1.1.3" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1.1.1.3.cmml">μ</mi></mrow><mo id="S3.E8.m1.2.2.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E8.m1.2.2.2.2.1.1.1.1.3" xref="S3.E8.m1.2.2.2.2.1.1.1.1.3.cmml">⊤</mo></msup><mo id="S3.E8.m1.2.2.2.2.1.1.2.3a" xref="S3.E8.m1.2.2.2.2.1.1.2.3.cmml">⁢</mo><msup id="S3.E8.m1.2.2.2.2.1.1.2.5" xref="S3.E8.m1.2.2.2.2.1.1.2.5.cmml"><mi id="S3.E8.m1.2.2.2.2.1.1.2.5.2" mathvariant="normal" xref="S3.E8.m1.2.2.2.2.1.1.2.5.2.cmml">Σ</mi><mrow id="S3.E8.m1.2.2.2.2.1.1.2.5.3" xref="S3.E8.m1.2.2.2.2.1.1.2.5.3.cmml"><mo id="S3.E8.m1.2.2.2.2.1.1.2.5.3a" xref="S3.E8.m1.2.2.2.2.1.1.2.5.3.cmml">−</mo><mn id="S3.E8.m1.2.2.2.2.1.1.2.5.3.2" xref="S3.E8.m1.2.2.2.2.1.1.2.5.3.2.cmml">1</mn></mrow></msup><mo id="S3.E8.m1.2.2.2.2.1.1.2.3b" xref="S3.E8.m1.2.2.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S3.E8.m1.2.2.2.2.1.1.2.2.1" xref="S3.E8.m1.2.2.2.2.1.1.2.2.1.1.cmml"><mo id="S3.E8.m1.2.2.2.2.1.1.2.2.1.2" stretchy="false" xref="S3.E8.m1.2.2.2.2.1.1.2.2.1.1.cmml">(</mo><mrow id="S3.E8.m1.2.2.2.2.1.1.2.2.1.1" xref="S3.E8.m1.2.2.2.2.1.1.2.2.1.1.cmml"><mi id="S3.E8.m1.2.2.2.2.1.1.2.2.1.1.2" xref="S3.E8.m1.2.2.2.2.1.1.2.2.1.1.2.cmml">a</mi><mo id="S3.E8.m1.2.2.2.2.1.1.2.2.1.1.1" xref="S3.E8.m1.2.2.2.2.1.1.2.2.1.1.1.cmml">−</mo><mi id="S3.E8.m1.2.2.2.2.1.1.2.2.1.1.3" xref="S3.E8.m1.2.2.2.2.1.1.2.2.1.1.3.cmml">μ</mi></mrow><mo id="S3.E8.m1.2.2.2.2.1.1.2.2.1.3" stretchy="false" xref="S3.E8.m1.2.2.2.2.1.1.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m1.2.2.2.2.1.3" xref="S3.E8.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S3.E8.m1.4.4.4" xref="S3.E8.m1.4.4.4.cmml"><msup id="S3.E8.m1.4.4.4.2" xref="S3.E8.m1.4.4.4.2.cmml"><mrow id="S3.E8.m1.4.4.4.2.1.1" xref="S3.E8.m1.4.4.4.2.1.1.1.cmml"><mo id="S3.E8.m1.4.4.4.2.1.1.2" stretchy="false" xref="S3.E8.m1.4.4.4.2.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.4.4.4.2.1.1.1" xref="S3.E8.m1.4.4.4.2.1.1.1.cmml"><mn id="S3.E8.m1.4.4.4.2.1.1.1.2" xref="S3.E8.m1.4.4.4.2.1.1.1.2.cmml">2</mn><mo id="S3.E8.m1.4.4.4.2.1.1.1.1" xref="S3.E8.m1.4.4.4.2.1.1.1.1.cmml">⁢</mo><mi id="S3.E8.m1.4.4.4.2.1.1.1.3" xref="S3.E8.m1.4.4.4.2.1.1.1.3.cmml">π</mi></mrow><mo id="S3.E8.m1.4.4.4.2.1.1.3" stretchy="false" xref="S3.E8.m1.4.4.4.2.1.1.1.cmml">)</mo></mrow><mfrac id="S3.E8.m1.4.4.4.2.3" xref="S3.E8.m1.4.4.4.2.3.cmml"><mi id="S3.E8.m1.4.4.4.2.3.2" xref="S3.E8.m1.4.4.4.2.3.2.cmml">d</mi><mn id="S3.E8.m1.4.4.4.2.3.3" xref="S3.E8.m1.4.4.4.2.3.3.cmml">2</mn></mfrac></msup><mo id="S3.E8.m1.4.4.4.3" xref="S3.E8.m1.4.4.4.3.cmml">⁢</mo><msqrt id="S3.E8.m1.3.3.3.1" xref="S3.E8.m1.3.3.3.1.cmml"><mrow id="S3.E8.m1.3.3.3.1.1.3" xref="S3.E8.m1.3.3.3.1.1.2.cmml"><mo id="S3.E8.m1.3.3.3.1.1.3.1" stretchy="false" xref="S3.E8.m1.3.3.3.1.1.2.1.cmml">|</mo><mi id="S3.E8.m1.3.3.3.1.1.1" mathvariant="normal" xref="S3.E8.m1.3.3.3.1.1.1.cmml">Σ</mi><mo id="S3.E8.m1.3.3.3.1.1.3.2" stretchy="false" xref="S3.E8.m1.3.3.3.1.1.2.1.cmml">|</mo></mrow></msqrt></mrow></mfrac></mrow><mo id="S3.E8.m1.8.8.1.2" lspace="0em" xref="S3.E8.m1.8.8.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.8b"><apply id="S3.E8.m1.8.8.1.1.cmml" xref="S3.E8.m1.8.8.1"><and id="S3.E8.m1.8.8.1.1a.cmml" xref="S3.E8.m1.8.8.1"></and><apply id="S3.E8.m1.8.8.1.1b.cmml" xref="S3.E8.m1.8.8.1"><approx id="S3.E8.m1.8.8.1.1.4.cmml" xref="S3.E8.m1.8.8.1.1.4"></approx><apply id="S3.E8.m1.8.8.1.1.3.cmml" xref="S3.E8.m1.8.8.1.1.3"><times id="S3.E8.m1.8.8.1.1.3.1.cmml" xref="S3.E8.m1.8.8.1.1.3.1"></times><apply id="S3.E8.m1.8.8.1.1.3.2.cmml" xref="S3.E8.m1.8.8.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.8.8.1.1.3.2.1.cmml" xref="S3.E8.m1.8.8.1.1.3.2">subscript</csymbol><ci id="S3.E8.m1.8.8.1.1.3.2.2.cmml" xref="S3.E8.m1.8.8.1.1.3.2.2">𝜋</ci><ci id="S3.E8.m1.8.8.1.1.3.2.3.cmml" xref="S3.E8.m1.8.8.1.1.3.2.3">𝜃</ci></apply><ci id="S3.E8.m1.5.5.cmml" xref="S3.E8.m1.5.5">𝑎</ci></apply><apply id="S3.E8.m1.8.8.1.1.1.cmml" xref="S3.E8.m1.8.8.1.1.1"><times id="S3.E8.m1.8.8.1.1.1.2.cmml" xref="S3.E8.m1.8.8.1.1.1.2"></times><ci id="S3.E8.m1.8.8.1.1.1.3.cmml" xref="S3.E8.m1.8.8.1.1.1.3">𝖯</ci><apply id="S3.E8.m1.8.8.1.1.1.1.1.1.cmml" xref="S3.E8.m1.8.8.1.1.1.1.1"><eq id="S3.E8.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.8.8.1.1.1.1.1.1.1"></eq><ci id="S3.E8.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.8.8.1.1.1.1.1.1.2">𝐴</ci><apply id="S3.E8.m1.8.8.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.8.8.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.E8.m1.8.8.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.8.8.1.1.1.1.1.1.3.1">conditional</csymbol><ci id="S3.E8.m1.8.8.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.8.8.1.1.1.1.1.1.3.2">𝑎</ci><apply id="S3.E8.m1.8.8.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.8.8.1.1.1.1.1.1.3.3"><times id="S3.E8.m1.8.8.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E8.m1.8.8.1.1.1.1.1.1.3.3.1"></times><ci id="S3.E8.m1.8.8.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E8.m1.8.8.1.1.1.1.1.1.3.3.2">𝒩</ci><interval closure="open" id="S3.E8.m1.8.8.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E8.m1.8.8.1.1.1.1.1.1.3.3.3.2"><ci id="S3.E8.m1.6.6.cmml" xref="S3.E8.m1.6.6">𝜇</ci><ci id="S3.E8.m1.7.7.cmml" xref="S3.E8.m1.7.7">Σ</ci></interval></apply></apply></apply></apply></apply><apply id="S3.E8.m1.8.8.1.1c.cmml" xref="S3.E8.m1.8.8.1"><eq id="S3.E8.m1.8.8.1.1.5.cmml" xref="S3.E8.m1.8.8.1.1.5"></eq><share href="https://arxiv.org/html/2405.02141v2#S3.E8.m1.8.8.1.1.1.cmml" id="S3.E8.m1.8.8.1.1d.cmml" xref="S3.E8.m1.8.8.1"></share><apply id="S3.E8.m1.4.4.cmml" xref="S3.E8.m1.4.4"><divide id="S3.E8.m1.4.4.5.cmml" xref="S3.E8.m1.4.4"></divide><apply id="S3.E8.m1.2.2.2.3.cmml" xref="S3.E8.m1.2.2.2.2"><exp id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1"></exp><apply id="S3.E8.m1.2.2.2.2.1.1.cmml" xref="S3.E8.m1.2.2.2.2.1.1"><minus id="S3.E8.m1.2.2.2.2.1.1.3.cmml" xref="S3.E8.m1.2.2.2.2.1.1"></minus><apply id="S3.E8.m1.2.2.2.2.1.1.2.cmml" xref="S3.E8.m1.2.2.2.2.1.1.2"><times id="S3.E8.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E8.m1.2.2.2.2.1.1.2.3"></times><apply id="S3.E8.m1.2.2.2.2.1.1.2.4.cmml" xref="S3.E8.m1.2.2.2.2.1.1.2.4"><divide id="S3.E8.m1.2.2.2.2.1.1.2.4.1.cmml" xref="S3.E8.m1.2.2.2.2.1.1.2.4"></divide><cn id="S3.E8.m1.2.2.2.2.1.1.2.4.2.cmml" type="integer" xref="S3.E8.m1.2.2.2.2.1.1.2.4.2">1</cn><cn id="S3.E8.m1.2.2.2.2.1.1.2.4.3.cmml" type="integer" xref="S3.E8.m1.2.2.2.2.1.1.2.4.3">2</cn></apply><apply id="S3.E8.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.1">superscript</csymbol><apply id="S3.E8.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1.1"><minus id="S3.E8.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1.1.1.1"></minus><ci id="S3.E8.m1.2.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1.1.1.2">𝑎</ci><ci id="S3.E8.m1.2.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1.1.1.3">𝜇</ci></apply><csymbol cd="latexml" id="S3.E8.m1.2.2.2.2.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.1.3">top</csymbol></apply><apply id="S3.E8.m1.2.2.2.2.1.1.2.5.cmml" xref="S3.E8.m1.2.2.2.2.1.1.2.5"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.2.2.1.1.2.5.1.cmml" xref="S3.E8.m1.2.2.2.2.1.1.2.5">superscript</csymbol><ci id="S3.E8.m1.2.2.2.2.1.1.2.5.2.cmml" xref="S3.E8.m1.2.2.2.2.1.1.2.5.2">Σ</ci><apply id="S3.E8.m1.2.2.2.2.1.1.2.5.3.cmml" xref="S3.E8.m1.2.2.2.2.1.1.2.5.3"><minus id="S3.E8.m1.2.2.2.2.1.1.2.5.3.1.cmml" xref="S3.E8.m1.2.2.2.2.1.1.2.5.3"></minus><cn id="S3.E8.m1.2.2.2.2.1.1.2.5.3.2.cmml" type="integer" xref="S3.E8.m1.2.2.2.2.1.1.2.5.3.2">1</cn></apply></apply><apply id="S3.E8.m1.2.2.2.2.1.1.2.2.1.1.cmml" xref="S3.E8.m1.2.2.2.2.1.1.2.2.1"><minus id="S3.E8.m1.2.2.2.2.1.1.2.2.1.1.1.cmml" xref="S3.E8.m1.2.2.2.2.1.1.2.2.1.1.1"></minus><ci id="S3.E8.m1.2.2.2.2.1.1.2.2.1.1.2.cmml" xref="S3.E8.m1.2.2.2.2.1.1.2.2.1.1.2">𝑎</ci><ci id="S3.E8.m1.2.2.2.2.1.1.2.2.1.1.3.cmml" xref="S3.E8.m1.2.2.2.2.1.1.2.2.1.1.3">𝜇</ci></apply></apply></apply></apply><apply id="S3.E8.m1.4.4.4.cmml" xref="S3.E8.m1.4.4.4"><times id="S3.E8.m1.4.4.4.3.cmml" xref="S3.E8.m1.4.4.4.3"></times><apply id="S3.E8.m1.4.4.4.2.cmml" xref="S3.E8.m1.4.4.4.2"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.4.2.2.cmml" xref="S3.E8.m1.4.4.4.2">superscript</csymbol><apply id="S3.E8.m1.4.4.4.2.1.1.1.cmml" xref="S3.E8.m1.4.4.4.2.1.1"><times id="S3.E8.m1.4.4.4.2.1.1.1.1.cmml" xref="S3.E8.m1.4.4.4.2.1.1.1.1"></times><cn id="S3.E8.m1.4.4.4.2.1.1.1.2.cmml" type="integer" xref="S3.E8.m1.4.4.4.2.1.1.1.2">2</cn><ci id="S3.E8.m1.4.4.4.2.1.1.1.3.cmml" xref="S3.E8.m1.4.4.4.2.1.1.1.3">𝜋</ci></apply><apply id="S3.E8.m1.4.4.4.2.3.cmml" xref="S3.E8.m1.4.4.4.2.3"><divide id="S3.E8.m1.4.4.4.2.3.1.cmml" xref="S3.E8.m1.4.4.4.2.3"></divide><ci id="S3.E8.m1.4.4.4.2.3.2.cmml" xref="S3.E8.m1.4.4.4.2.3.2">𝑑</ci><cn id="S3.E8.m1.4.4.4.2.3.3.cmml" type="integer" xref="S3.E8.m1.4.4.4.2.3.3">2</cn></apply></apply><apply id="S3.E8.m1.3.3.3.1.cmml" xref="S3.E8.m1.3.3.3.1"><root id="S3.E8.m1.3.3.3.1a.cmml" xref="S3.E8.m1.3.3.3.1"></root><apply id="S3.E8.m1.3.3.3.1.1.2.cmml" xref="S3.E8.m1.3.3.3.1.1.3"><abs id="S3.E8.m1.3.3.3.1.1.2.1.cmml" xref="S3.E8.m1.3.3.3.1.1.3.1"></abs><ci id="S3.E8.m1.3.3.3.1.1.1.cmml" xref="S3.E8.m1.3.3.3.1.1.1">Σ</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.8c">\pi_{\theta}(a)\approx\mathsf{P}(A=a|\mathcal{N}(\mu,\Sigma))=\frac{\exp\left(%
-\frac{1}{2}(a-\mu)^{\top}\Sigma^{-1}(a-\mu)\right)}{(2\pi)^{\frac{d}{2}}\sqrt%
{|\Sigma|}}.</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.8d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ) ≈ sansserif_P ( italic_A = italic_a | caligraphic_N ( italic_μ , roman_Σ ) ) = divide start_ARG roman_exp ( - divide start_ARG 1 end_ARG start_ARG 2 end_ARG ( italic_a - italic_μ ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT roman_Σ start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( italic_a - italic_μ ) ) end_ARG start_ARG ( 2 italic_π ) start_POSTSUPERSCRIPT divide start_ARG italic_d end_ARG start_ARG 2 end_ARG end_POSTSUPERSCRIPT square-root start_ARG | roman_Σ | end_ARG end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p8.8">For <math alttext="\lim_{\Sigma\to\bm{0}}" class="ltx_Math" display="inline" id="S3.p8.6.m1.1"><semantics id="S3.p8.6.m1.1a"><msub id="S3.p8.6.m1.1.1" xref="S3.p8.6.m1.1.1.cmml"><mo id="S3.p8.6.m1.1.1.2" xref="S3.p8.6.m1.1.1.2.cmml">lim</mo><mrow id="S3.p8.6.m1.1.1.3" xref="S3.p8.6.m1.1.1.3.cmml"><mi id="S3.p8.6.m1.1.1.3.2" mathvariant="normal" xref="S3.p8.6.m1.1.1.3.2.cmml">Σ</mi><mo id="S3.p8.6.m1.1.1.3.1" stretchy="false" xref="S3.p8.6.m1.1.1.3.1.cmml">→</mo><mn id="S3.p8.6.m1.1.1.3.3" xref="S3.p8.6.m1.1.1.3.3.cmml">𝟎</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p8.6.m1.1b"><apply id="S3.p8.6.m1.1.1.cmml" xref="S3.p8.6.m1.1.1"><csymbol cd="ambiguous" id="S3.p8.6.m1.1.1.1.cmml" xref="S3.p8.6.m1.1.1">subscript</csymbol><limit id="S3.p8.6.m1.1.1.2.cmml" xref="S3.p8.6.m1.1.1.2"></limit><apply id="S3.p8.6.m1.1.1.3.cmml" xref="S3.p8.6.m1.1.1.3"><ci id="S3.p8.6.m1.1.1.3.1.cmml" xref="S3.p8.6.m1.1.1.3.1">→</ci><ci id="S3.p8.6.m1.1.1.3.2.cmml" xref="S3.p8.6.m1.1.1.3.2">Σ</ci><cn id="S3.p8.6.m1.1.1.3.3.cmml" type="integer" xref="S3.p8.6.m1.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.6.m1.1c">\lim_{\Sigma\to\bm{0}}</annotation><annotation encoding="application/x-llamapun" id="S3.p8.6.m1.1d">roman_lim start_POSTSUBSCRIPT roman_Σ → bold_0 end_POSTSUBSCRIPT</annotation></semantics></math>, the kernel converges to the deterministic distribution, and hence the estimate is unbiased.
Nevertheless, this can lead to excessively high variance because of a low <em class="ltx_emph ltx_font_italic" id="S3.p8.8.1">effective</em> sample size <cite class="ltx_cite ltx_citemacro_citep">(Owen, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib52" title="">2013</a>, §9.3)</cite>.
For <math alttext="\lim_{\sigma\to\infty\bm{I}}" class="ltx_Math" display="inline" id="S3.p8.7.m2.1"><semantics id="S3.p8.7.m2.1a"><msub id="S3.p8.7.m2.1.1" xref="S3.p8.7.m2.1.1.cmml"><mo id="S3.p8.7.m2.1.1.2" xref="S3.p8.7.m2.1.1.2.cmml">lim</mo><mrow id="S3.p8.7.m2.1.1.3" xref="S3.p8.7.m2.1.1.3.cmml"><mi id="S3.p8.7.m2.1.1.3.2" xref="S3.p8.7.m2.1.1.3.2.cmml">σ</mi><mo id="S3.p8.7.m2.1.1.3.1" stretchy="false" xref="S3.p8.7.m2.1.1.3.1.cmml">→</mo><mrow id="S3.p8.7.m2.1.1.3.3" xref="S3.p8.7.m2.1.1.3.3.cmml"><mi id="S3.p8.7.m2.1.1.3.3.2" mathvariant="normal" xref="S3.p8.7.m2.1.1.3.3.2.cmml">∞</mi><mo id="S3.p8.7.m2.1.1.3.3.1" xref="S3.p8.7.m2.1.1.3.3.1.cmml">⁢</mo><mi id="S3.p8.7.m2.1.1.3.3.3" xref="S3.p8.7.m2.1.1.3.3.3.cmml">𝑰</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p8.7.m2.1b"><apply id="S3.p8.7.m2.1.1.cmml" xref="S3.p8.7.m2.1.1"><csymbol cd="ambiguous" id="S3.p8.7.m2.1.1.1.cmml" xref="S3.p8.7.m2.1.1">subscript</csymbol><limit id="S3.p8.7.m2.1.1.2.cmml" xref="S3.p8.7.m2.1.1.2"></limit><apply id="S3.p8.7.m2.1.1.3.cmml" xref="S3.p8.7.m2.1.1.3"><ci id="S3.p8.7.m2.1.1.3.1.cmml" xref="S3.p8.7.m2.1.1.3.1">→</ci><ci id="S3.p8.7.m2.1.1.3.2.cmml" xref="S3.p8.7.m2.1.1.3.2">𝜎</ci><apply id="S3.p8.7.m2.1.1.3.3.cmml" xref="S3.p8.7.m2.1.1.3.3"><times id="S3.p8.7.m2.1.1.3.3.1.cmml" xref="S3.p8.7.m2.1.1.3.3.1"></times><infinity id="S3.p8.7.m2.1.1.3.3.2.cmml" xref="S3.p8.7.m2.1.1.3.3.2"></infinity><ci id="S3.p8.7.m2.1.1.3.3.3.cmml" xref="S3.p8.7.m2.1.1.3.3.3">𝑰</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.7.m2.1c">\lim_{\sigma\to\infty\bm{I}}</annotation><annotation encoding="application/x-llamapun" id="S3.p8.7.m2.1d">roman_lim start_POSTSUBSCRIPT italic_σ → ∞ bold_italic_I end_POSTSUBSCRIPT</annotation></semantics></math>, the kernel approximates a uniform distribution. Whilst this minimises variance, it significantly increases bias.
The Gaussian kernel permits an intuitive understanding: we estimate <em class="ltx_emph ltx_font_italic" id="S3.p8.8.2">as if</em> we would deploy a Gaussian policy, when in reality we ignore its covariance matrix and simply deploy its mean deterministically.
This gives rise to an intuitive way to visualise estimates of policy value: we vary values of <math alttext="\Sigma" class="ltx_Math" display="inline" id="S3.p8.8.m3.1"><semantics id="S3.p8.8.m3.1a"><mi id="S3.p8.8.m3.1.1" mathvariant="normal" xref="S3.p8.8.m3.1.1.cmml">Σ</mi><annotation-xml encoding="MathML-Content" id="S3.p8.8.m3.1b"><ci id="S3.p8.8.m3.1.1.cmml" xref="S3.p8.8.m3.1.1">Σ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.8.m3.1c">\Sigma</annotation><annotation encoding="application/x-llamapun" id="S3.p8.8.m3.1d">roman_Σ</annotation></semantics></math> and consider their trend across the bias–variance trade-off.
We introduce, discuss, and visualise such results for off-policy evaluation in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S7.SS2.SSS2" title="7.2.2. Offline Results (RQ2–3) ‣ 7.2. Improved Recommendations (RQ2–4) ‣ 7. Experiments &amp; Discussion ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">7.2.2</span></a>.</p>
</div>
<div class="ltx_para" id="S3.p9">
<p class="ltx_p" id="S3.p9.1">Finally, we note that the Gaussian kernel is one of many alternatives to consider, albeit an intuitive option.
Any multivariate continuous probability distribution gives rise to a density function that can be used either directly to optimise a stochastic policy, or as a kernel smoothing function when optimising a deterministic policy.
The problems we describe in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S5" title="5. Considerations for logging policies ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">5</span></a> that arise from uniform logging distributions, hold for all distributions and kernels that have an unrestricted domain.</p>
</div>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Improving the CRM Lower Bound</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.4">We require accurate variance estimates for two reasons: (1) during evaluation, we want to ensure statistical significance of our results, obtaining confidence intervals that exhibit the expected coverage levels so we can make meaningful statements about probabilities, and (2) during learning, we make use of sample variance penalisation schemes that assume accurate variance estimates to provide sensible lower bounds. As such: we require an estimator for <math alttext="{\rm Var}\left(\widehat{V}_{\rm(SN)IPS}(\pi_{\theta},\mathcal{D})\right)" class="ltx_Math" display="inline" id="S4.p1.1.m1.3"><semantics id="S4.p1.1.m1.3a"><mrow id="S4.p1.1.m1.3.3" xref="S4.p1.1.m1.3.3.cmml"><mi id="S4.p1.1.m1.3.3.3" xref="S4.p1.1.m1.3.3.3.cmml">Var</mi><mo id="S4.p1.1.m1.3.3.2" xref="S4.p1.1.m1.3.3.2.cmml">⁢</mo><mrow id="S4.p1.1.m1.3.3.1.1" xref="S4.p1.1.m1.3.3.1.1.1.cmml"><mo id="S4.p1.1.m1.3.3.1.1.2" xref="S4.p1.1.m1.3.3.1.1.1.cmml">(</mo><mrow id="S4.p1.1.m1.3.3.1.1.1" xref="S4.p1.1.m1.3.3.1.1.1.cmml"><msub id="S4.p1.1.m1.3.3.1.1.1.3" xref="S4.p1.1.m1.3.3.1.1.1.3.cmml"><mover accent="true" id="S4.p1.1.m1.3.3.1.1.1.3.2" xref="S4.p1.1.m1.3.3.1.1.1.3.2.cmml"><mi id="S4.p1.1.m1.3.3.1.1.1.3.2.2" xref="S4.p1.1.m1.3.3.1.1.1.3.2.2.cmml">V</mi><mo id="S4.p1.1.m1.3.3.1.1.1.3.2.1" xref="S4.p1.1.m1.3.3.1.1.1.3.2.1.cmml">^</mo></mover><mrow id="S4.p1.1.m1.1.1.1" xref="S4.p1.1.m1.1.1.1.cmml"><mrow id="S4.p1.1.m1.1.1.1.3.2" xref="S4.p1.1.m1.1.1.1.cmml"><mo id="S4.p1.1.m1.1.1.1.3.2.1" stretchy="false" xref="S4.p1.1.m1.1.1.1.cmml">(</mo><mi id="S4.p1.1.m1.1.1.1.1" xref="S4.p1.1.m1.1.1.1.1.cmml">SN</mi><mo id="S4.p1.1.m1.1.1.1.3.2.2" stretchy="false" xref="S4.p1.1.m1.1.1.1.cmml">)</mo></mrow><mo id="S4.p1.1.m1.1.1.1.2" xref="S4.p1.1.m1.1.1.1.2.cmml">⁢</mo><mi id="S4.p1.1.m1.1.1.1.4" xref="S4.p1.1.m1.1.1.1.4.cmml">IPS</mi></mrow></msub><mo id="S4.p1.1.m1.3.3.1.1.1.2" xref="S4.p1.1.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.p1.1.m1.3.3.1.1.1.1.1" xref="S4.p1.1.m1.3.3.1.1.1.1.2.cmml"><mo id="S4.p1.1.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S4.p1.1.m1.3.3.1.1.1.1.2.cmml">(</mo><msub id="S4.p1.1.m1.3.3.1.1.1.1.1.1" xref="S4.p1.1.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.p1.1.m1.3.3.1.1.1.1.1.1.2" xref="S4.p1.1.m1.3.3.1.1.1.1.1.1.2.cmml">π</mi><mi id="S4.p1.1.m1.3.3.1.1.1.1.1.1.3" xref="S4.p1.1.m1.3.3.1.1.1.1.1.1.3.cmml">θ</mi></msub><mo id="S4.p1.1.m1.3.3.1.1.1.1.1.3" xref="S4.p1.1.m1.3.3.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.p1.1.m1.2.2" xref="S4.p1.1.m1.2.2.cmml">𝒟</mi><mo id="S4.p1.1.m1.3.3.1.1.1.1.1.4" stretchy="false" xref="S4.p1.1.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.p1.1.m1.3.3.1.1.3" xref="S4.p1.1.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.3b"><apply id="S4.p1.1.m1.3.3.cmml" xref="S4.p1.1.m1.3.3"><times id="S4.p1.1.m1.3.3.2.cmml" xref="S4.p1.1.m1.3.3.2"></times><ci id="S4.p1.1.m1.3.3.3.cmml" xref="S4.p1.1.m1.3.3.3">Var</ci><apply id="S4.p1.1.m1.3.3.1.1.1.cmml" xref="S4.p1.1.m1.3.3.1.1"><times id="S4.p1.1.m1.3.3.1.1.1.2.cmml" xref="S4.p1.1.m1.3.3.1.1.1.2"></times><apply id="S4.p1.1.m1.3.3.1.1.1.3.cmml" xref="S4.p1.1.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.p1.1.m1.3.3.1.1.1.3.1.cmml" xref="S4.p1.1.m1.3.3.1.1.1.3">subscript</csymbol><apply id="S4.p1.1.m1.3.3.1.1.1.3.2.cmml" xref="S4.p1.1.m1.3.3.1.1.1.3.2"><ci id="S4.p1.1.m1.3.3.1.1.1.3.2.1.cmml" xref="S4.p1.1.m1.3.3.1.1.1.3.2.1">^</ci><ci id="S4.p1.1.m1.3.3.1.1.1.3.2.2.cmml" xref="S4.p1.1.m1.3.3.1.1.1.3.2.2">𝑉</ci></apply><apply id="S4.p1.1.m1.1.1.1.cmml" xref="S4.p1.1.m1.1.1.1"><times id="S4.p1.1.m1.1.1.1.2.cmml" xref="S4.p1.1.m1.1.1.1.2"></times><ci id="S4.p1.1.m1.1.1.1.1.cmml" xref="S4.p1.1.m1.1.1.1.1">SN</ci><ci id="S4.p1.1.m1.1.1.1.4.cmml" xref="S4.p1.1.m1.1.1.1.4">IPS</ci></apply></apply><interval closure="open" id="S4.p1.1.m1.3.3.1.1.1.1.2.cmml" xref="S4.p1.1.m1.3.3.1.1.1.1.1"><apply id="S4.p1.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.p1.1.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p1.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.p1.1.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S4.p1.1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.p1.1.m1.3.3.1.1.1.1.1.1.2">𝜋</ci><ci id="S4.p1.1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.p1.1.m1.3.3.1.1.1.1.1.1.3">𝜃</ci></apply><ci id="S4.p1.1.m1.2.2.cmml" xref="S4.p1.1.m1.2.2">𝒟</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.3c">{\rm Var}\left(\widehat{V}_{\rm(SN)IPS}(\pi_{\theta},\mathcal{D})\right)</annotation><annotation encoding="application/x-llamapun" id="S4.p1.1.m1.3d">roman_Var ( over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT ( roman_SN ) roman_IPS end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT , caligraphic_D ) )</annotation></semantics></math> that implies confidence intervals with expected coverage.
That is, when <math alttext="\lambda\approx 1.96" class="ltx_Math" display="inline" id="S4.p1.2.m2.1"><semantics id="S4.p1.2.m2.1a"><mrow id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml"><mi id="S4.p1.2.m2.1.1.2" xref="S4.p1.2.m2.1.1.2.cmml">λ</mi><mo id="S4.p1.2.m2.1.1.1" xref="S4.p1.2.m2.1.1.1.cmml">≈</mo><mn id="S4.p1.2.m2.1.1.3" xref="S4.p1.2.m2.1.1.3.cmml">1.96</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><apply id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1"><approx id="S4.p1.2.m2.1.1.1.cmml" xref="S4.p1.2.m2.1.1.1"></approx><ci id="S4.p1.2.m2.1.1.2.cmml" xref="S4.p1.2.m2.1.1.2">𝜆</ci><cn id="S4.p1.2.m2.1.1.3.cmml" type="float" xref="S4.p1.2.m2.1.1.3">1.96</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">\lambda\approx 1.96</annotation><annotation encoding="application/x-llamapun" id="S4.p1.2.m2.1d">italic_λ ≈ 1.96</annotation></semantics></math> in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S3.E7" title="In 3. Multivariate Off-Policy Learning ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">7</span></a>, the lower bound holds in 95% of cases.
Traditionally used variance estimators are based on Gaussian approximations, motivated through the CLT.
For <math alttext="\widehat{V}_{\rm IPS}" class="ltx_Math" display="inline" id="S4.p1.3.m3.1"><semantics id="S4.p1.3.m3.1a"><msub id="S4.p1.3.m3.1.1" xref="S4.p1.3.m3.1.1.cmml"><mover accent="true" id="S4.p1.3.m3.1.1.2" xref="S4.p1.3.m3.1.1.2.cmml"><mi id="S4.p1.3.m3.1.1.2.2" xref="S4.p1.3.m3.1.1.2.2.cmml">V</mi><mo id="S4.p1.3.m3.1.1.2.1" xref="S4.p1.3.m3.1.1.2.1.cmml">^</mo></mover><mi id="S4.p1.3.m3.1.1.3" xref="S4.p1.3.m3.1.1.3.cmml">IPS</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p1.3.m3.1b"><apply id="S4.p1.3.m3.1.1.cmml" xref="S4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p1.3.m3.1.1.1.cmml" xref="S4.p1.3.m3.1.1">subscript</csymbol><apply id="S4.p1.3.m3.1.1.2.cmml" xref="S4.p1.3.m3.1.1.2"><ci id="S4.p1.3.m3.1.1.2.1.cmml" xref="S4.p1.3.m3.1.1.2.1">^</ci><ci id="S4.p1.3.m3.1.1.2.2.cmml" xref="S4.p1.3.m3.1.1.2.2">𝑉</ci></apply><ci id="S4.p1.3.m3.1.1.3.cmml" xref="S4.p1.3.m3.1.1.3">IPS</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.3.m3.1c">\widehat{V}_{\rm IPS}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.3.m3.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_IPS end_POSTSUBSCRIPT</annotation></semantics></math>, the sample variance with <math alttext="N" class="ltx_Math" display="inline" id="S4.p1.4.m4.1"><semantics id="S4.p1.4.m4.1a"><mi id="S4.p1.4.m4.1.1" xref="S4.p1.4.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.p1.4.m4.1b"><ci id="S4.p1.4.m4.1.1.cmml" xref="S4.p1.4.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.4.m4.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.p1.4.m4.1d">italic_N</annotation></semantics></math> as the sample size is given by:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(9)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\widehat{{\rm Var}}\left(\widehat{V}_{\rm IPS}(\pi_{\theta},\mathcal{D})\right%
)=\frac{\sum_{(a,r)\in\mathcal{D}}\left(\frac{\pi_{\theta}(a)}{\pi_{0}(a)}r-%
\widehat{V}_{\rm IPS}(\pi_{\theta},\mathcal{D})\right)^{2}}{{N-1}}." class="ltx_Math" display="block" id="S4.E9.m1.8"><semantics id="S4.E9.m1.8a"><mrow id="S4.E9.m1.8.8.1" xref="S4.E9.m1.8.8.1.1.cmml"><mrow id="S4.E9.m1.8.8.1.1" xref="S4.E9.m1.8.8.1.1.cmml"><mrow id="S4.E9.m1.8.8.1.1.1" xref="S4.E9.m1.8.8.1.1.1.cmml"><mover accent="true" id="S4.E9.m1.8.8.1.1.1.3" xref="S4.E9.m1.8.8.1.1.1.3.cmml"><mi id="S4.E9.m1.8.8.1.1.1.3.2" xref="S4.E9.m1.8.8.1.1.1.3.2.cmml">Var</mi><mo id="S4.E9.m1.8.8.1.1.1.3.1" xref="S4.E9.m1.8.8.1.1.1.3.1.cmml">^</mo></mover><mo id="S4.E9.m1.8.8.1.1.1.2" xref="S4.E9.m1.8.8.1.1.1.2.cmml">⁢</mo><mrow id="S4.E9.m1.8.8.1.1.1.1.1" xref="S4.E9.m1.8.8.1.1.1.1.1.1.cmml"><mo id="S4.E9.m1.8.8.1.1.1.1.1.2" xref="S4.E9.m1.8.8.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.8.8.1.1.1.1.1.1" xref="S4.E9.m1.8.8.1.1.1.1.1.1.cmml"><msub id="S4.E9.m1.8.8.1.1.1.1.1.1.3" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S4.E9.m1.8.8.1.1.1.1.1.1.3.2" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.cmml"><mi id="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.2" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.2.cmml">V</mi><mo id="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.1" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S4.E9.m1.8.8.1.1.1.1.1.1.3.3" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.3.cmml">IPS</mi></msub><mo id="S4.E9.m1.8.8.1.1.1.1.1.1.2" xref="S4.E9.m1.8.8.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.2.cmml">π</mi><mi id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.3.cmml">θ</mi></msub><mo id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.7.7" xref="S4.E9.m1.7.7.cmml">𝒟</mi><mo id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.4" stretchy="false" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.8.8.1.1.1.1.1.3" xref="S4.E9.m1.8.8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.8.8.1.1.2" xref="S4.E9.m1.8.8.1.1.2.cmml">=</mo><mfrac id="S4.E9.m1.6.6" xref="S4.E9.m1.6.6.cmml"><mrow id="S4.E9.m1.6.6.6" xref="S4.E9.m1.6.6.6.cmml"><msub id="S4.E9.m1.6.6.6.7" xref="S4.E9.m1.6.6.6.7.cmml"><mo id="S4.E9.m1.6.6.6.7.2" xref="S4.E9.m1.6.6.6.7.2.cmml">∑</mo><mrow id="S4.E9.m1.2.2.2.2.2" xref="S4.E9.m1.2.2.2.2.2.cmml"><mrow id="S4.E9.m1.2.2.2.2.2.4.2" xref="S4.E9.m1.2.2.2.2.2.4.1.cmml"><mo id="S4.E9.m1.2.2.2.2.2.4.2.1" stretchy="false" xref="S4.E9.m1.2.2.2.2.2.4.1.cmml">(</mo><mi id="S4.E9.m1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.cmml">a</mi><mo id="S4.E9.m1.2.2.2.2.2.4.2.2" xref="S4.E9.m1.2.2.2.2.2.4.1.cmml">,</mo><mi id="S4.E9.m1.2.2.2.2.2.2" xref="S4.E9.m1.2.2.2.2.2.2.cmml">r</mi><mo id="S4.E9.m1.2.2.2.2.2.4.2.3" stretchy="false" xref="S4.E9.m1.2.2.2.2.2.4.1.cmml">)</mo></mrow><mo id="S4.E9.m1.2.2.2.2.2.3" xref="S4.E9.m1.2.2.2.2.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.2.2.2.2.2.5" xref="S4.E9.m1.2.2.2.2.2.5.cmml">𝒟</mi></mrow></msub><msup id="S4.E9.m1.6.6.6.6" xref="S4.E9.m1.6.6.6.6.cmml"><mrow id="S4.E9.m1.6.6.6.6.1.1" xref="S4.E9.m1.6.6.6.6.1.1.1.cmml"><mo id="S4.E9.m1.6.6.6.6.1.1.2" lspace="0em" xref="S4.E9.m1.6.6.6.6.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.6.6.6.6.1.1.1" xref="S4.E9.m1.6.6.6.6.1.1.1.cmml"><mrow id="S4.E9.m1.6.6.6.6.1.1.1.3" xref="S4.E9.m1.6.6.6.6.1.1.1.3.cmml"><mfrac id="S4.E9.m1.4.4.4.4" xref="S4.E9.m1.4.4.4.4.cmml"><mrow id="S4.E9.m1.3.3.3.3.1" xref="S4.E9.m1.3.3.3.3.1.cmml"><msub id="S4.E9.m1.3.3.3.3.1.3" xref="S4.E9.m1.3.3.3.3.1.3.cmml"><mi id="S4.E9.m1.3.3.3.3.1.3.2" xref="S4.E9.m1.3.3.3.3.1.3.2.cmml">π</mi><mi id="S4.E9.m1.3.3.3.3.1.3.3" xref="S4.E9.m1.3.3.3.3.1.3.3.cmml">θ</mi></msub><mo id="S4.E9.m1.3.3.3.3.1.2" xref="S4.E9.m1.3.3.3.3.1.2.cmml">⁢</mo><mrow id="S4.E9.m1.3.3.3.3.1.4.2" xref="S4.E9.m1.3.3.3.3.1.cmml"><mo id="S4.E9.m1.3.3.3.3.1.4.2.1" stretchy="false" xref="S4.E9.m1.3.3.3.3.1.cmml">(</mo><mi id="S4.E9.m1.3.3.3.3.1.1" xref="S4.E9.m1.3.3.3.3.1.1.cmml">a</mi><mo id="S4.E9.m1.3.3.3.3.1.4.2.2" stretchy="false" xref="S4.E9.m1.3.3.3.3.1.cmml">)</mo></mrow></mrow><mrow id="S4.E9.m1.4.4.4.4.2" xref="S4.E9.m1.4.4.4.4.2.cmml"><msub id="S4.E9.m1.4.4.4.4.2.3" xref="S4.E9.m1.4.4.4.4.2.3.cmml"><mi id="S4.E9.m1.4.4.4.4.2.3.2" xref="S4.E9.m1.4.4.4.4.2.3.2.cmml">π</mi><mn id="S4.E9.m1.4.4.4.4.2.3.3" xref="S4.E9.m1.4.4.4.4.2.3.3.cmml">0</mn></msub><mo id="S4.E9.m1.4.4.4.4.2.2" xref="S4.E9.m1.4.4.4.4.2.2.cmml">⁢</mo><mrow id="S4.E9.m1.4.4.4.4.2.4.2" xref="S4.E9.m1.4.4.4.4.2.cmml"><mo id="S4.E9.m1.4.4.4.4.2.4.2.1" stretchy="false" xref="S4.E9.m1.4.4.4.4.2.cmml">(</mo><mi id="S4.E9.m1.4.4.4.4.2.1" xref="S4.E9.m1.4.4.4.4.2.1.cmml">a</mi><mo id="S4.E9.m1.4.4.4.4.2.4.2.2" stretchy="false" xref="S4.E9.m1.4.4.4.4.2.cmml">)</mo></mrow></mrow></mfrac><mo id="S4.E9.m1.6.6.6.6.1.1.1.3.1" xref="S4.E9.m1.6.6.6.6.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E9.m1.6.6.6.6.1.1.1.3.2" xref="S4.E9.m1.6.6.6.6.1.1.1.3.2.cmml">r</mi></mrow><mo id="S4.E9.m1.6.6.6.6.1.1.1.2" xref="S4.E9.m1.6.6.6.6.1.1.1.2.cmml">−</mo><mrow id="S4.E9.m1.6.6.6.6.1.1.1.1" xref="S4.E9.m1.6.6.6.6.1.1.1.1.cmml"><msub id="S4.E9.m1.6.6.6.6.1.1.1.1.3" xref="S4.E9.m1.6.6.6.6.1.1.1.1.3.cmml"><mover accent="true" id="S4.E9.m1.6.6.6.6.1.1.1.1.3.2" xref="S4.E9.m1.6.6.6.6.1.1.1.1.3.2.cmml"><mi id="S4.E9.m1.6.6.6.6.1.1.1.1.3.2.2" xref="S4.E9.m1.6.6.6.6.1.1.1.1.3.2.2.cmml">V</mi><mo id="S4.E9.m1.6.6.6.6.1.1.1.1.3.2.1" xref="S4.E9.m1.6.6.6.6.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S4.E9.m1.6.6.6.6.1.1.1.1.3.3" xref="S4.E9.m1.6.6.6.6.1.1.1.1.3.3.cmml">IPS</mi></msub><mo id="S4.E9.m1.6.6.6.6.1.1.1.1.2" xref="S4.E9.m1.6.6.6.6.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E9.m1.6.6.6.6.1.1.1.1.1.1" xref="S4.E9.m1.6.6.6.6.1.1.1.1.1.2.cmml"><mo id="S4.E9.m1.6.6.6.6.1.1.1.1.1.1.2" stretchy="false" xref="S4.E9.m1.6.6.6.6.1.1.1.1.1.2.cmml">(</mo><msub id="S4.E9.m1.6.6.6.6.1.1.1.1.1.1.1" xref="S4.E9.m1.6.6.6.6.1.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.6.6.6.6.1.1.1.1.1.1.1.2" xref="S4.E9.m1.6.6.6.6.1.1.1.1.1.1.1.2.cmml">π</mi><mi id="S4.E9.m1.6.6.6.6.1.1.1.1.1.1.1.3" xref="S4.E9.m1.6.6.6.6.1.1.1.1.1.1.1.3.cmml">θ</mi></msub><mo id="S4.E9.m1.6.6.6.6.1.1.1.1.1.1.3" xref="S4.E9.m1.6.6.6.6.1.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.5.5.5.5" xref="S4.E9.m1.5.5.5.5.cmml">𝒟</mi><mo id="S4.E9.m1.6.6.6.6.1.1.1.1.1.1.4" stretchy="false" xref="S4.E9.m1.6.6.6.6.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E9.m1.6.6.6.6.1.1.3" xref="S4.E9.m1.6.6.6.6.1.1.1.cmml">)</mo></mrow><mn id="S4.E9.m1.6.6.6.6.3" xref="S4.E9.m1.6.6.6.6.3.cmml">2</mn></msup></mrow><mrow id="S4.E9.m1.6.6.8" xref="S4.E9.m1.6.6.8.cmml"><mi id="S4.E9.m1.6.6.8.2" xref="S4.E9.m1.6.6.8.2.cmml">N</mi><mo id="S4.E9.m1.6.6.8.1" xref="S4.E9.m1.6.6.8.1.cmml">−</mo><mn id="S4.E9.m1.6.6.8.3" xref="S4.E9.m1.6.6.8.3.cmml">1</mn></mrow></mfrac></mrow><mo id="S4.E9.m1.8.8.1.2" lspace="0em" xref="S4.E9.m1.8.8.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.8b"><apply id="S4.E9.m1.8.8.1.1.cmml" xref="S4.E9.m1.8.8.1"><eq id="S4.E9.m1.8.8.1.1.2.cmml" xref="S4.E9.m1.8.8.1.1.2"></eq><apply id="S4.E9.m1.8.8.1.1.1.cmml" xref="S4.E9.m1.8.8.1.1.1"><times id="S4.E9.m1.8.8.1.1.1.2.cmml" xref="S4.E9.m1.8.8.1.1.1.2"></times><apply id="S4.E9.m1.8.8.1.1.1.3.cmml" xref="S4.E9.m1.8.8.1.1.1.3"><ci id="S4.E9.m1.8.8.1.1.1.3.1.cmml" xref="S4.E9.m1.8.8.1.1.1.3.1">^</ci><ci id="S4.E9.m1.8.8.1.1.1.3.2.cmml" xref="S4.E9.m1.8.8.1.1.1.3.2">Var</ci></apply><apply id="S4.E9.m1.8.8.1.1.1.1.1.1.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1"><times id="S4.E9.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.2"></times><apply id="S4.E9.m1.8.8.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.8.8.1.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3">subscript</csymbol><apply id="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.2"><ci id="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.1">^</ci><ci id="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.2.2">𝑉</ci></apply><ci id="S4.E9.m1.8.8.1.1.1.1.1.1.3.3.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.3">IPS</ci></apply><interval closure="open" id="S4.E9.m1.8.8.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1"><apply id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.2">𝜋</ci><ci id="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.1.1.3">𝜃</ci></apply><ci id="S4.E9.m1.7.7.cmml" xref="S4.E9.m1.7.7">𝒟</ci></interval></apply></apply><apply id="S4.E9.m1.6.6.cmml" xref="S4.E9.m1.6.6"><divide id="S4.E9.m1.6.6.7.cmml" xref="S4.E9.m1.6.6"></divide><apply id="S4.E9.m1.6.6.6.cmml" xref="S4.E9.m1.6.6.6"><apply id="S4.E9.m1.6.6.6.7.cmml" xref="S4.E9.m1.6.6.6.7"><csymbol cd="ambiguous" id="S4.E9.m1.6.6.6.7.1.cmml" xref="S4.E9.m1.6.6.6.7">subscript</csymbol><sum id="S4.E9.m1.6.6.6.7.2.cmml" xref="S4.E9.m1.6.6.6.7.2"></sum><apply id="S4.E9.m1.2.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2.2"><in id="S4.E9.m1.2.2.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2.2.2.3"></in><interval closure="open" id="S4.E9.m1.2.2.2.2.2.4.1.cmml" xref="S4.E9.m1.2.2.2.2.2.4.2"><ci id="S4.E9.m1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1">𝑎</ci><ci id="S4.E9.m1.2.2.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2.2.2">𝑟</ci></interval><ci id="S4.E9.m1.2.2.2.2.2.5.cmml" xref="S4.E9.m1.2.2.2.2.2.5">𝒟</ci></apply></apply><apply id="S4.E9.m1.6.6.6.6.cmml" xref="S4.E9.m1.6.6.6.6"><csymbol cd="ambiguous" id="S4.E9.m1.6.6.6.6.2.cmml" xref="S4.E9.m1.6.6.6.6">superscript</csymbol><apply id="S4.E9.m1.6.6.6.6.1.1.1.cmml" xref="S4.E9.m1.6.6.6.6.1.1"><minus id="S4.E9.m1.6.6.6.6.1.1.1.2.cmml" xref="S4.E9.m1.6.6.6.6.1.1.1.2"></minus><apply id="S4.E9.m1.6.6.6.6.1.1.1.3.cmml" xref="S4.E9.m1.6.6.6.6.1.1.1.3"><times id="S4.E9.m1.6.6.6.6.1.1.1.3.1.cmml" xref="S4.E9.m1.6.6.6.6.1.1.1.3.1"></times><apply id="S4.E9.m1.4.4.4.4.cmml" xref="S4.E9.m1.4.4.4.4"><divide id="S4.E9.m1.4.4.4.4.3.cmml" xref="S4.E9.m1.4.4.4.4"></divide><apply id="S4.E9.m1.3.3.3.3.1.cmml" xref="S4.E9.m1.3.3.3.3.1"><times id="S4.E9.m1.3.3.3.3.1.2.cmml" xref="S4.E9.m1.3.3.3.3.1.2"></times><apply id="S4.E9.m1.3.3.3.3.1.3.cmml" xref="S4.E9.m1.3.3.3.3.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.3.3.1.3.1.cmml" xref="S4.E9.m1.3.3.3.3.1.3">subscript</csymbol><ci id="S4.E9.m1.3.3.3.3.1.3.2.cmml" xref="S4.E9.m1.3.3.3.3.1.3.2">𝜋</ci><ci id="S4.E9.m1.3.3.3.3.1.3.3.cmml" xref="S4.E9.m1.3.3.3.3.1.3.3">𝜃</ci></apply><ci id="S4.E9.m1.3.3.3.3.1.1.cmml" xref="S4.E9.m1.3.3.3.3.1.1">𝑎</ci></apply><apply id="S4.E9.m1.4.4.4.4.2.cmml" xref="S4.E9.m1.4.4.4.4.2"><times id="S4.E9.m1.4.4.4.4.2.2.cmml" xref="S4.E9.m1.4.4.4.4.2.2"></times><apply id="S4.E9.m1.4.4.4.4.2.3.cmml" xref="S4.E9.m1.4.4.4.4.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.4.4.2.3.1.cmml" xref="S4.E9.m1.4.4.4.4.2.3">subscript</csymbol><ci id="S4.E9.m1.4.4.4.4.2.3.2.cmml" xref="S4.E9.m1.4.4.4.4.2.3.2">𝜋</ci><cn id="S4.E9.m1.4.4.4.4.2.3.3.cmml" type="integer" xref="S4.E9.m1.4.4.4.4.2.3.3">0</cn></apply><ci id="S4.E9.m1.4.4.4.4.2.1.cmml" xref="S4.E9.m1.4.4.4.4.2.1">𝑎</ci></apply></apply><ci id="S4.E9.m1.6.6.6.6.1.1.1.3.2.cmml" xref="S4.E9.m1.6.6.6.6.1.1.1.3.2">𝑟</ci></apply><apply id="S4.E9.m1.6.6.6.6.1.1.1.1.cmml" xref="S4.E9.m1.6.6.6.6.1.1.1.1"><times id="S4.E9.m1.6.6.6.6.1.1.1.1.2.cmml" xref="S4.E9.m1.6.6.6.6.1.1.1.1.2"></times><apply id="S4.E9.m1.6.6.6.6.1.1.1.1.3.cmml" xref="S4.E9.m1.6.6.6.6.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.6.6.6.6.1.1.1.1.3.1.cmml" xref="S4.E9.m1.6.6.6.6.1.1.1.1.3">subscript</csymbol><apply id="S4.E9.m1.6.6.6.6.1.1.1.1.3.2.cmml" xref="S4.E9.m1.6.6.6.6.1.1.1.1.3.2"><ci id="S4.E9.m1.6.6.6.6.1.1.1.1.3.2.1.cmml" xref="S4.E9.m1.6.6.6.6.1.1.1.1.3.2.1">^</ci><ci id="S4.E9.m1.6.6.6.6.1.1.1.1.3.2.2.cmml" xref="S4.E9.m1.6.6.6.6.1.1.1.1.3.2.2">𝑉</ci></apply><ci id="S4.E9.m1.6.6.6.6.1.1.1.1.3.3.cmml" xref="S4.E9.m1.6.6.6.6.1.1.1.1.3.3">IPS</ci></apply><interval closure="open" id="S4.E9.m1.6.6.6.6.1.1.1.1.1.2.cmml" xref="S4.E9.m1.6.6.6.6.1.1.1.1.1.1"><apply id="S4.E9.m1.6.6.6.6.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.6.6.6.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.6.6.6.6.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.6.6.6.6.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E9.m1.6.6.6.6.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.6.6.6.6.1.1.1.1.1.1.1.2">𝜋</ci><ci id="S4.E9.m1.6.6.6.6.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.6.6.6.6.1.1.1.1.1.1.1.3">𝜃</ci></apply><ci id="S4.E9.m1.5.5.5.5.cmml" xref="S4.E9.m1.5.5.5.5">𝒟</ci></interval></apply></apply><cn id="S4.E9.m1.6.6.6.6.3.cmml" type="integer" xref="S4.E9.m1.6.6.6.6.3">2</cn></apply></apply><apply id="S4.E9.m1.6.6.8.cmml" xref="S4.E9.m1.6.6.8"><minus id="S4.E9.m1.6.6.8.1.cmml" xref="S4.E9.m1.6.6.8.1"></minus><ci id="S4.E9.m1.6.6.8.2.cmml" xref="S4.E9.m1.6.6.8.2">𝑁</ci><cn id="S4.E9.m1.6.6.8.3.cmml" type="integer" xref="S4.E9.m1.6.6.8.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.8c">\widehat{{\rm Var}}\left(\widehat{V}_{\rm IPS}(\pi_{\theta},\mathcal{D})\right%
)=\frac{\sum_{(a,r)\in\mathcal{D}}\left(\frac{\pi_{\theta}(a)}{\pi_{0}(a)}r-%
\widehat{V}_{\rm IPS}(\pi_{\theta},\mathcal{D})\right)^{2}}{{N-1}}.</annotation><annotation encoding="application/x-llamapun" id="S4.E9.m1.8d">over^ start_ARG roman_Var end_ARG ( over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_IPS end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT , caligraphic_D ) ) = divide start_ARG ∑ start_POSTSUBSCRIPT ( italic_a , italic_r ) ∈ caligraphic_D end_POSTSUBSCRIPT ( divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a ) end_ARG italic_r - over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_IPS end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT , caligraphic_D ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_N - 1 end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.1">Because the <math alttext="\widehat{V}_{\rm SNIPS}" class="ltx_Math" display="inline" id="S4.p2.1.m1.1"><semantics id="S4.p2.1.m1.1a"><msub id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml"><mover accent="true" id="S4.p2.1.m1.1.1.2" xref="S4.p2.1.m1.1.1.2.cmml"><mi id="S4.p2.1.m1.1.1.2.2" xref="S4.p2.1.m1.1.1.2.2.cmml">V</mi><mo id="S4.p2.1.m1.1.1.2.1" xref="S4.p2.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S4.p2.1.m1.1.1.3" xref="S4.p2.1.m1.1.1.3.cmml">SNIPS</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><apply id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.1.cmml" xref="S4.p2.1.m1.1.1">subscript</csymbol><apply id="S4.p2.1.m1.1.1.2.cmml" xref="S4.p2.1.m1.1.1.2"><ci id="S4.p2.1.m1.1.1.2.1.cmml" xref="S4.p2.1.m1.1.1.2.1">^</ci><ci id="S4.p2.1.m1.1.1.2.2.cmml" xref="S4.p2.1.m1.1.1.2.2">𝑉</ci></apply><ci id="S4.p2.1.m1.1.1.3.cmml" xref="S4.p2.1.m1.1.1.3">SNIPS</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">\widehat{V}_{\rm SNIPS}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.1.m1.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_SNIPS end_POSTSUBSCRIPT</annotation></semantics></math> estimator deals with a <em class="ltx_emph ltx_font_italic" id="S4.p2.1.1">ratio</em> of two expectations, we need to resort to the delta method to approximate its variance <cite class="ltx_cite ltx_citemacro_citep">(Owen, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib52" title="">2013</a>, Eq. 9.9)</cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(10)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\widehat{{\rm Var}}\left(\widehat{V}_{\rm SNIPS}(\pi_{\theta},\mathcal{D})%
\right)=\frac{\sum_{(a,r)\in\mathcal{D}}\left(\frac{\pi_{\theta}(a)}{\pi_{0}(a%
)}r-\frac{\pi_{\theta}(a)}{\pi_{0}(a)}\widehat{V}_{\rm SNIPS}(\pi_{\theta},%
\mathcal{D})\right)^{2}}{(N-1)\left(\frac{1}{|\mathcal{D}|}\sum_{(a,r)\in%
\mathcal{D}}\frac{\pi_{\theta}(a)}{\pi_{0}(a)}\right)^{2}}." class="ltx_Math" display="block" id="S4.E10.m1.17"><semantics id="S4.E10.m1.17a"><mrow id="S4.E10.m1.17.17.1" xref="S4.E10.m1.17.17.1.1.cmml"><mrow id="S4.E10.m1.17.17.1.1" xref="S4.E10.m1.17.17.1.1.cmml"><mrow id="S4.E10.m1.17.17.1.1.1" xref="S4.E10.m1.17.17.1.1.1.cmml"><mover accent="true" id="S4.E10.m1.17.17.1.1.1.3" xref="S4.E10.m1.17.17.1.1.1.3.cmml"><mi id="S4.E10.m1.17.17.1.1.1.3.2" xref="S4.E10.m1.17.17.1.1.1.3.2.cmml">Var</mi><mo id="S4.E10.m1.17.17.1.1.1.3.1" xref="S4.E10.m1.17.17.1.1.1.3.1.cmml">^</mo></mover><mo id="S4.E10.m1.17.17.1.1.1.2" xref="S4.E10.m1.17.17.1.1.1.2.cmml">⁢</mo><mrow id="S4.E10.m1.17.17.1.1.1.1.1" xref="S4.E10.m1.17.17.1.1.1.1.1.1.cmml"><mo id="S4.E10.m1.17.17.1.1.1.1.1.2" xref="S4.E10.m1.17.17.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E10.m1.17.17.1.1.1.1.1.1" xref="S4.E10.m1.17.17.1.1.1.1.1.1.cmml"><msub id="S4.E10.m1.17.17.1.1.1.1.1.1.3" xref="S4.E10.m1.17.17.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S4.E10.m1.17.17.1.1.1.1.1.1.3.2" xref="S4.E10.m1.17.17.1.1.1.1.1.1.3.2.cmml"><mi id="S4.E10.m1.17.17.1.1.1.1.1.1.3.2.2" xref="S4.E10.m1.17.17.1.1.1.1.1.1.3.2.2.cmml">V</mi><mo id="S4.E10.m1.17.17.1.1.1.1.1.1.3.2.1" xref="S4.E10.m1.17.17.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S4.E10.m1.17.17.1.1.1.1.1.1.3.3" xref="S4.E10.m1.17.17.1.1.1.1.1.1.3.3.cmml">SNIPS</mi></msub><mo id="S4.E10.m1.17.17.1.1.1.1.1.1.2" xref="S4.E10.m1.17.17.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E10.m1.17.17.1.1.1.1.1.1.1.1" xref="S4.E10.m1.17.17.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E10.m1.17.17.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E10.m1.17.17.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S4.E10.m1.17.17.1.1.1.1.1.1.1.1.1" xref="S4.E10.m1.17.17.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E10.m1.17.17.1.1.1.1.1.1.1.1.1.2" xref="S4.E10.m1.17.17.1.1.1.1.1.1.1.1.1.2.cmml">π</mi><mi id="S4.E10.m1.17.17.1.1.1.1.1.1.1.1.1.3" xref="S4.E10.m1.17.17.1.1.1.1.1.1.1.1.1.3.cmml">θ</mi></msub><mo id="S4.E10.m1.17.17.1.1.1.1.1.1.1.1.3" xref="S4.E10.m1.17.17.1.1.1.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.16.16" xref="S4.E10.m1.16.16.cmml">𝒟</mi><mo id="S4.E10.m1.17.17.1.1.1.1.1.1.1.1.4" stretchy="false" xref="S4.E10.m1.17.17.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E10.m1.17.17.1.1.1.1.1.3" xref="S4.E10.m1.17.17.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E10.m1.17.17.1.1.2" xref="S4.E10.m1.17.17.1.1.2.cmml">=</mo><mfrac id="S4.E10.m1.15.15" xref="S4.E10.m1.15.15.cmml"><mrow id="S4.E10.m1.8.8.8" xref="S4.E10.m1.8.8.8.cmml"><msub id="S4.E10.m1.8.8.8.9" xref="S4.E10.m1.8.8.8.9.cmml"><mo id="S4.E10.m1.8.8.8.9.2" xref="S4.E10.m1.8.8.8.9.2.cmml">∑</mo><mrow id="S4.E10.m1.2.2.2.2.2" xref="S4.E10.m1.2.2.2.2.2.cmml"><mrow id="S4.E10.m1.2.2.2.2.2.4.2" xref="S4.E10.m1.2.2.2.2.2.4.1.cmml"><mo id="S4.E10.m1.2.2.2.2.2.4.2.1" stretchy="false" xref="S4.E10.m1.2.2.2.2.2.4.1.cmml">(</mo><mi id="S4.E10.m1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.cmml">a</mi><mo id="S4.E10.m1.2.2.2.2.2.4.2.2" xref="S4.E10.m1.2.2.2.2.2.4.1.cmml">,</mo><mi id="S4.E10.m1.2.2.2.2.2.2" xref="S4.E10.m1.2.2.2.2.2.2.cmml">r</mi><mo id="S4.E10.m1.2.2.2.2.2.4.2.3" stretchy="false" xref="S4.E10.m1.2.2.2.2.2.4.1.cmml">)</mo></mrow><mo id="S4.E10.m1.2.2.2.2.2.3" xref="S4.E10.m1.2.2.2.2.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.2.2.2.2.2.5" xref="S4.E10.m1.2.2.2.2.2.5.cmml">𝒟</mi></mrow></msub><msup id="S4.E10.m1.8.8.8.8" xref="S4.E10.m1.8.8.8.8.cmml"><mrow id="S4.E10.m1.8.8.8.8.1.1" xref="S4.E10.m1.8.8.8.8.1.1.1.cmml"><mo id="S4.E10.m1.8.8.8.8.1.1.2" lspace="0em" xref="S4.E10.m1.8.8.8.8.1.1.1.cmml">(</mo><mrow id="S4.E10.m1.8.8.8.8.1.1.1" xref="S4.E10.m1.8.8.8.8.1.1.1.cmml"><mrow id="S4.E10.m1.8.8.8.8.1.1.1.3" xref="S4.E10.m1.8.8.8.8.1.1.1.3.cmml"><mfrac id="S4.E10.m1.4.4.4.4" xref="S4.E10.m1.4.4.4.4.cmml"><mrow id="S4.E10.m1.3.3.3.3.1" xref="S4.E10.m1.3.3.3.3.1.cmml"><msub id="S4.E10.m1.3.3.3.3.1.3" xref="S4.E10.m1.3.3.3.3.1.3.cmml"><mi id="S4.E10.m1.3.3.3.3.1.3.2" xref="S4.E10.m1.3.3.3.3.1.3.2.cmml">π</mi><mi id="S4.E10.m1.3.3.3.3.1.3.3" xref="S4.E10.m1.3.3.3.3.1.3.3.cmml">θ</mi></msub><mo id="S4.E10.m1.3.3.3.3.1.2" xref="S4.E10.m1.3.3.3.3.1.2.cmml">⁢</mo><mrow id="S4.E10.m1.3.3.3.3.1.4.2" xref="S4.E10.m1.3.3.3.3.1.cmml"><mo id="S4.E10.m1.3.3.3.3.1.4.2.1" stretchy="false" xref="S4.E10.m1.3.3.3.3.1.cmml">(</mo><mi id="S4.E10.m1.3.3.3.3.1.1" xref="S4.E10.m1.3.3.3.3.1.1.cmml">a</mi><mo id="S4.E10.m1.3.3.3.3.1.4.2.2" stretchy="false" xref="S4.E10.m1.3.3.3.3.1.cmml">)</mo></mrow></mrow><mrow id="S4.E10.m1.4.4.4.4.2" xref="S4.E10.m1.4.4.4.4.2.cmml"><msub id="S4.E10.m1.4.4.4.4.2.3" xref="S4.E10.m1.4.4.4.4.2.3.cmml"><mi id="S4.E10.m1.4.4.4.4.2.3.2" xref="S4.E10.m1.4.4.4.4.2.3.2.cmml">π</mi><mn id="S4.E10.m1.4.4.4.4.2.3.3" xref="S4.E10.m1.4.4.4.4.2.3.3.cmml">0</mn></msub><mo id="S4.E10.m1.4.4.4.4.2.2" xref="S4.E10.m1.4.4.4.4.2.2.cmml">⁢</mo><mrow id="S4.E10.m1.4.4.4.4.2.4.2" xref="S4.E10.m1.4.4.4.4.2.cmml"><mo id="S4.E10.m1.4.4.4.4.2.4.2.1" stretchy="false" xref="S4.E10.m1.4.4.4.4.2.cmml">(</mo><mi id="S4.E10.m1.4.4.4.4.2.1" xref="S4.E10.m1.4.4.4.4.2.1.cmml">a</mi><mo id="S4.E10.m1.4.4.4.4.2.4.2.2" stretchy="false" xref="S4.E10.m1.4.4.4.4.2.cmml">)</mo></mrow></mrow></mfrac><mo id="S4.E10.m1.8.8.8.8.1.1.1.3.1" xref="S4.E10.m1.8.8.8.8.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E10.m1.8.8.8.8.1.1.1.3.2" xref="S4.E10.m1.8.8.8.8.1.1.1.3.2.cmml">r</mi></mrow><mo id="S4.E10.m1.8.8.8.8.1.1.1.2" xref="S4.E10.m1.8.8.8.8.1.1.1.2.cmml">−</mo><mrow id="S4.E10.m1.8.8.8.8.1.1.1.1" xref="S4.E10.m1.8.8.8.8.1.1.1.1.cmml"><mfrac id="S4.E10.m1.6.6.6.6" xref="S4.E10.m1.6.6.6.6.cmml"><mrow id="S4.E10.m1.5.5.5.5.1" xref="S4.E10.m1.5.5.5.5.1.cmml"><msub id="S4.E10.m1.5.5.5.5.1.3" xref="S4.E10.m1.5.5.5.5.1.3.cmml"><mi id="S4.E10.m1.5.5.5.5.1.3.2" xref="S4.E10.m1.5.5.5.5.1.3.2.cmml">π</mi><mi id="S4.E10.m1.5.5.5.5.1.3.3" xref="S4.E10.m1.5.5.5.5.1.3.3.cmml">θ</mi></msub><mo id="S4.E10.m1.5.5.5.5.1.2" xref="S4.E10.m1.5.5.5.5.1.2.cmml">⁢</mo><mrow id="S4.E10.m1.5.5.5.5.1.4.2" xref="S4.E10.m1.5.5.5.5.1.cmml"><mo id="S4.E10.m1.5.5.5.5.1.4.2.1" stretchy="false" xref="S4.E10.m1.5.5.5.5.1.cmml">(</mo><mi id="S4.E10.m1.5.5.5.5.1.1" xref="S4.E10.m1.5.5.5.5.1.1.cmml">a</mi><mo id="S4.E10.m1.5.5.5.5.1.4.2.2" stretchy="false" xref="S4.E10.m1.5.5.5.5.1.cmml">)</mo></mrow></mrow><mrow id="S4.E10.m1.6.6.6.6.2" xref="S4.E10.m1.6.6.6.6.2.cmml"><msub id="S4.E10.m1.6.6.6.6.2.3" xref="S4.E10.m1.6.6.6.6.2.3.cmml"><mi id="S4.E10.m1.6.6.6.6.2.3.2" xref="S4.E10.m1.6.6.6.6.2.3.2.cmml">π</mi><mn id="S4.E10.m1.6.6.6.6.2.3.3" xref="S4.E10.m1.6.6.6.6.2.3.3.cmml">0</mn></msub><mo id="S4.E10.m1.6.6.6.6.2.2" xref="S4.E10.m1.6.6.6.6.2.2.cmml">⁢</mo><mrow id="S4.E10.m1.6.6.6.6.2.4.2" xref="S4.E10.m1.6.6.6.6.2.cmml"><mo id="S4.E10.m1.6.6.6.6.2.4.2.1" stretchy="false" xref="S4.E10.m1.6.6.6.6.2.cmml">(</mo><mi id="S4.E10.m1.6.6.6.6.2.1" xref="S4.E10.m1.6.6.6.6.2.1.cmml">a</mi><mo id="S4.E10.m1.6.6.6.6.2.4.2.2" stretchy="false" xref="S4.E10.m1.6.6.6.6.2.cmml">)</mo></mrow></mrow></mfrac><mo id="S4.E10.m1.8.8.8.8.1.1.1.1.2" xref="S4.E10.m1.8.8.8.8.1.1.1.1.2.cmml">⁢</mo><msub id="S4.E10.m1.8.8.8.8.1.1.1.1.3" xref="S4.E10.m1.8.8.8.8.1.1.1.1.3.cmml"><mover accent="true" id="S4.E10.m1.8.8.8.8.1.1.1.1.3.2" xref="S4.E10.m1.8.8.8.8.1.1.1.1.3.2.cmml"><mi id="S4.E10.m1.8.8.8.8.1.1.1.1.3.2.2" xref="S4.E10.m1.8.8.8.8.1.1.1.1.3.2.2.cmml">V</mi><mo id="S4.E10.m1.8.8.8.8.1.1.1.1.3.2.1" xref="S4.E10.m1.8.8.8.8.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S4.E10.m1.8.8.8.8.1.1.1.1.3.3" xref="S4.E10.m1.8.8.8.8.1.1.1.1.3.3.cmml">SNIPS</mi></msub><mo id="S4.E10.m1.8.8.8.8.1.1.1.1.2a" xref="S4.E10.m1.8.8.8.8.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E10.m1.8.8.8.8.1.1.1.1.1.1" xref="S4.E10.m1.8.8.8.8.1.1.1.1.1.2.cmml"><mo id="S4.E10.m1.8.8.8.8.1.1.1.1.1.1.2" stretchy="false" xref="S4.E10.m1.8.8.8.8.1.1.1.1.1.2.cmml">(</mo><msub id="S4.E10.m1.8.8.8.8.1.1.1.1.1.1.1" xref="S4.E10.m1.8.8.8.8.1.1.1.1.1.1.1.cmml"><mi id="S4.E10.m1.8.8.8.8.1.1.1.1.1.1.1.2" xref="S4.E10.m1.8.8.8.8.1.1.1.1.1.1.1.2.cmml">π</mi><mi id="S4.E10.m1.8.8.8.8.1.1.1.1.1.1.1.3" xref="S4.E10.m1.8.8.8.8.1.1.1.1.1.1.1.3.cmml">θ</mi></msub><mo id="S4.E10.m1.8.8.8.8.1.1.1.1.1.1.3" xref="S4.E10.m1.8.8.8.8.1.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.7.7.7.7" xref="S4.E10.m1.7.7.7.7.cmml">𝒟</mi><mo id="S4.E10.m1.8.8.8.8.1.1.1.1.1.1.4" stretchy="false" xref="S4.E10.m1.8.8.8.8.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E10.m1.8.8.8.8.1.1.3" xref="S4.E10.m1.8.8.8.8.1.1.1.cmml">)</mo></mrow><mn id="S4.E10.m1.8.8.8.8.3" xref="S4.E10.m1.8.8.8.8.3.cmml">2</mn></msup></mrow><mrow id="S4.E10.m1.15.15.15" xref="S4.E10.m1.15.15.15.cmml"><mrow id="S4.E10.m1.14.14.14.6.1" xref="S4.E10.m1.14.14.14.6.1.1.cmml"><mo id="S4.E10.m1.14.14.14.6.1.2" stretchy="false" xref="S4.E10.m1.14.14.14.6.1.1.cmml">(</mo><mrow id="S4.E10.m1.14.14.14.6.1.1" xref="S4.E10.m1.14.14.14.6.1.1.cmml"><mi id="S4.E10.m1.14.14.14.6.1.1.2" xref="S4.E10.m1.14.14.14.6.1.1.2.cmml">N</mi><mo id="S4.E10.m1.14.14.14.6.1.1.1" xref="S4.E10.m1.14.14.14.6.1.1.1.cmml">−</mo><mn id="S4.E10.m1.14.14.14.6.1.1.3" xref="S4.E10.m1.14.14.14.6.1.1.3.cmml">1</mn></mrow><mo id="S4.E10.m1.14.14.14.6.1.3" stretchy="false" xref="S4.E10.m1.14.14.14.6.1.1.cmml">)</mo></mrow><mo id="S4.E10.m1.15.15.15.8" xref="S4.E10.m1.15.15.15.8.cmml">⁢</mo><msup id="S4.E10.m1.15.15.15.7" xref="S4.E10.m1.15.15.15.7.cmml"><mrow id="S4.E10.m1.15.15.15.7.1.1" xref="S4.E10.m1.15.15.15.7.1.1.1.cmml"><mo id="S4.E10.m1.15.15.15.7.1.1.2" xref="S4.E10.m1.15.15.15.7.1.1.1.cmml">(</mo><mrow id="S4.E10.m1.15.15.15.7.1.1.1" xref="S4.E10.m1.15.15.15.7.1.1.1.cmml"><mfrac id="S4.E10.m1.9.9.9.1" xref="S4.E10.m1.9.9.9.1.cmml"><mn id="S4.E10.m1.9.9.9.1.3" xref="S4.E10.m1.9.9.9.1.3.cmml">1</mn><mrow id="S4.E10.m1.9.9.9.1.1.3" xref="S4.E10.m1.9.9.9.1.1.2.cmml"><mo id="S4.E10.m1.9.9.9.1.1.3.1" stretchy="false" xref="S4.E10.m1.9.9.9.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.9.9.9.1.1.1" xref="S4.E10.m1.9.9.9.1.1.1.cmml">𝒟</mi><mo id="S4.E10.m1.9.9.9.1.1.3.2" stretchy="false" xref="S4.E10.m1.9.9.9.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S4.E10.m1.15.15.15.7.1.1.1.1" xref="S4.E10.m1.15.15.15.7.1.1.1.1.cmml">⁢</mo><mrow id="S4.E10.m1.15.15.15.7.1.1.1.2" xref="S4.E10.m1.15.15.15.7.1.1.1.2.cmml"><msub id="S4.E10.m1.15.15.15.7.1.1.1.2.1" xref="S4.E10.m1.15.15.15.7.1.1.1.2.1.cmml"><mo id="S4.E10.m1.15.15.15.7.1.1.1.2.1.2" xref="S4.E10.m1.15.15.15.7.1.1.1.2.1.2.cmml">∑</mo><mrow id="S4.E10.m1.11.11.11.3.2" xref="S4.E10.m1.11.11.11.3.2.cmml"><mrow id="S4.E10.m1.11.11.11.3.2.4.2" xref="S4.E10.m1.11.11.11.3.2.4.1.cmml"><mo id="S4.E10.m1.11.11.11.3.2.4.2.1" stretchy="false" xref="S4.E10.m1.11.11.11.3.2.4.1.cmml">(</mo><mi id="S4.E10.m1.10.10.10.2.1.1" xref="S4.E10.m1.10.10.10.2.1.1.cmml">a</mi><mo id="S4.E10.m1.11.11.11.3.2.4.2.2" xref="S4.E10.m1.11.11.11.3.2.4.1.cmml">,</mo><mi id="S4.E10.m1.11.11.11.3.2.2" xref="S4.E10.m1.11.11.11.3.2.2.cmml">r</mi><mo id="S4.E10.m1.11.11.11.3.2.4.2.3" stretchy="false" xref="S4.E10.m1.11.11.11.3.2.4.1.cmml">)</mo></mrow><mo id="S4.E10.m1.11.11.11.3.2.3" xref="S4.E10.m1.11.11.11.3.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.11.11.11.3.2.5" xref="S4.E10.m1.11.11.11.3.2.5.cmml">𝒟</mi></mrow></msub><mfrac id="S4.E10.m1.13.13.13.5" xref="S4.E10.m1.13.13.13.5.cmml"><mrow id="S4.E10.m1.12.12.12.4.1" xref="S4.E10.m1.12.12.12.4.1.cmml"><msub id="S4.E10.m1.12.12.12.4.1.3" xref="S4.E10.m1.12.12.12.4.1.3.cmml"><mi id="S4.E10.m1.12.12.12.4.1.3.2" xref="S4.E10.m1.12.12.12.4.1.3.2.cmml">π</mi><mi id="S4.E10.m1.12.12.12.4.1.3.3" xref="S4.E10.m1.12.12.12.4.1.3.3.cmml">θ</mi></msub><mo id="S4.E10.m1.12.12.12.4.1.2" xref="S4.E10.m1.12.12.12.4.1.2.cmml">⁢</mo><mrow id="S4.E10.m1.12.12.12.4.1.4.2" xref="S4.E10.m1.12.12.12.4.1.cmml"><mo id="S4.E10.m1.12.12.12.4.1.4.2.1" stretchy="false" xref="S4.E10.m1.12.12.12.4.1.cmml">(</mo><mi id="S4.E10.m1.12.12.12.4.1.1" xref="S4.E10.m1.12.12.12.4.1.1.cmml">a</mi><mo id="S4.E10.m1.12.12.12.4.1.4.2.2" stretchy="false" xref="S4.E10.m1.12.12.12.4.1.cmml">)</mo></mrow></mrow><mrow id="S4.E10.m1.13.13.13.5.2" xref="S4.E10.m1.13.13.13.5.2.cmml"><msub id="S4.E10.m1.13.13.13.5.2.3" xref="S4.E10.m1.13.13.13.5.2.3.cmml"><mi id="S4.E10.m1.13.13.13.5.2.3.2" xref="S4.E10.m1.13.13.13.5.2.3.2.cmml">π</mi><mn id="S4.E10.m1.13.13.13.5.2.3.3" xref="S4.E10.m1.13.13.13.5.2.3.3.cmml">0</mn></msub><mo id="S4.E10.m1.13.13.13.5.2.2" xref="S4.E10.m1.13.13.13.5.2.2.cmml">⁢</mo><mrow id="S4.E10.m1.13.13.13.5.2.4.2" xref="S4.E10.m1.13.13.13.5.2.cmml"><mo id="S4.E10.m1.13.13.13.5.2.4.2.1" stretchy="false" xref="S4.E10.m1.13.13.13.5.2.cmml">(</mo><mi id="S4.E10.m1.13.13.13.5.2.1" xref="S4.E10.m1.13.13.13.5.2.1.cmml">a</mi><mo id="S4.E10.m1.13.13.13.5.2.4.2.2" stretchy="false" xref="S4.E10.m1.13.13.13.5.2.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="S4.E10.m1.15.15.15.7.1.1.3" xref="S4.E10.m1.15.15.15.7.1.1.1.cmml">)</mo></mrow><mn id="S4.E10.m1.15.15.15.7.3" xref="S4.E10.m1.15.15.15.7.3.cmml">2</mn></msup></mrow></mfrac></mrow><mo id="S4.E10.m1.17.17.1.2" lspace="0em" xref="S4.E10.m1.17.17.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.17b"><apply id="S4.E10.m1.17.17.1.1.cmml" xref="S4.E10.m1.17.17.1"><eq id="S4.E10.m1.17.17.1.1.2.cmml" xref="S4.E10.m1.17.17.1.1.2"></eq><apply id="S4.E10.m1.17.17.1.1.1.cmml" xref="S4.E10.m1.17.17.1.1.1"><times id="S4.E10.m1.17.17.1.1.1.2.cmml" xref="S4.E10.m1.17.17.1.1.1.2"></times><apply id="S4.E10.m1.17.17.1.1.1.3.cmml" xref="S4.E10.m1.17.17.1.1.1.3"><ci id="S4.E10.m1.17.17.1.1.1.3.1.cmml" xref="S4.E10.m1.17.17.1.1.1.3.1">^</ci><ci id="S4.E10.m1.17.17.1.1.1.3.2.cmml" xref="S4.E10.m1.17.17.1.1.1.3.2">Var</ci></apply><apply id="S4.E10.m1.17.17.1.1.1.1.1.1.cmml" xref="S4.E10.m1.17.17.1.1.1.1.1"><times id="S4.E10.m1.17.17.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.17.17.1.1.1.1.1.1.2"></times><apply id="S4.E10.m1.17.17.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.17.17.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.17.17.1.1.1.1.1.1.3.1.cmml" xref="S4.E10.m1.17.17.1.1.1.1.1.1.3">subscript</csymbol><apply id="S4.E10.m1.17.17.1.1.1.1.1.1.3.2.cmml" xref="S4.E10.m1.17.17.1.1.1.1.1.1.3.2"><ci id="S4.E10.m1.17.17.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E10.m1.17.17.1.1.1.1.1.1.3.2.1">^</ci><ci id="S4.E10.m1.17.17.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E10.m1.17.17.1.1.1.1.1.1.3.2.2">𝑉</ci></apply><ci id="S4.E10.m1.17.17.1.1.1.1.1.1.3.3.cmml" xref="S4.E10.m1.17.17.1.1.1.1.1.1.3.3">SNIPS</ci></apply><interval closure="open" id="S4.E10.m1.17.17.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.17.17.1.1.1.1.1.1.1.1"><apply id="S4.E10.m1.17.17.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.17.17.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.17.17.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.17.17.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E10.m1.17.17.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.17.17.1.1.1.1.1.1.1.1.1.2">𝜋</ci><ci id="S4.E10.m1.17.17.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.17.17.1.1.1.1.1.1.1.1.1.3">𝜃</ci></apply><ci id="S4.E10.m1.16.16.cmml" xref="S4.E10.m1.16.16">𝒟</ci></interval></apply></apply><apply id="S4.E10.m1.15.15.cmml" xref="S4.E10.m1.15.15"><divide id="S4.E10.m1.15.15.16.cmml" xref="S4.E10.m1.15.15"></divide><apply id="S4.E10.m1.8.8.8.cmml" xref="S4.E10.m1.8.8.8"><apply id="S4.E10.m1.8.8.8.9.cmml" xref="S4.E10.m1.8.8.8.9"><csymbol cd="ambiguous" id="S4.E10.m1.8.8.8.9.1.cmml" xref="S4.E10.m1.8.8.8.9">subscript</csymbol><sum id="S4.E10.m1.8.8.8.9.2.cmml" xref="S4.E10.m1.8.8.8.9.2"></sum><apply id="S4.E10.m1.2.2.2.2.2.cmml" xref="S4.E10.m1.2.2.2.2.2"><in id="S4.E10.m1.2.2.2.2.2.3.cmml" xref="S4.E10.m1.2.2.2.2.2.3"></in><interval closure="open" id="S4.E10.m1.2.2.2.2.2.4.1.cmml" xref="S4.E10.m1.2.2.2.2.2.4.2"><ci id="S4.E10.m1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1">𝑎</ci><ci id="S4.E10.m1.2.2.2.2.2.2.cmml" xref="S4.E10.m1.2.2.2.2.2.2">𝑟</ci></interval><ci id="S4.E10.m1.2.2.2.2.2.5.cmml" xref="S4.E10.m1.2.2.2.2.2.5">𝒟</ci></apply></apply><apply id="S4.E10.m1.8.8.8.8.cmml" xref="S4.E10.m1.8.8.8.8"><csymbol cd="ambiguous" id="S4.E10.m1.8.8.8.8.2.cmml" xref="S4.E10.m1.8.8.8.8">superscript</csymbol><apply id="S4.E10.m1.8.8.8.8.1.1.1.cmml" xref="S4.E10.m1.8.8.8.8.1.1"><minus id="S4.E10.m1.8.8.8.8.1.1.1.2.cmml" xref="S4.E10.m1.8.8.8.8.1.1.1.2"></minus><apply id="S4.E10.m1.8.8.8.8.1.1.1.3.cmml" xref="S4.E10.m1.8.8.8.8.1.1.1.3"><times id="S4.E10.m1.8.8.8.8.1.1.1.3.1.cmml" xref="S4.E10.m1.8.8.8.8.1.1.1.3.1"></times><apply id="S4.E10.m1.4.4.4.4.cmml" xref="S4.E10.m1.4.4.4.4"><divide id="S4.E10.m1.4.4.4.4.3.cmml" xref="S4.E10.m1.4.4.4.4"></divide><apply id="S4.E10.m1.3.3.3.3.1.cmml" xref="S4.E10.m1.3.3.3.3.1"><times id="S4.E10.m1.3.3.3.3.1.2.cmml" xref="S4.E10.m1.3.3.3.3.1.2"></times><apply id="S4.E10.m1.3.3.3.3.1.3.cmml" xref="S4.E10.m1.3.3.3.3.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.3.3.1.3.1.cmml" xref="S4.E10.m1.3.3.3.3.1.3">subscript</csymbol><ci id="S4.E10.m1.3.3.3.3.1.3.2.cmml" xref="S4.E10.m1.3.3.3.3.1.3.2">𝜋</ci><ci id="S4.E10.m1.3.3.3.3.1.3.3.cmml" xref="S4.E10.m1.3.3.3.3.1.3.3">𝜃</ci></apply><ci id="S4.E10.m1.3.3.3.3.1.1.cmml" xref="S4.E10.m1.3.3.3.3.1.1">𝑎</ci></apply><apply id="S4.E10.m1.4.4.4.4.2.cmml" xref="S4.E10.m1.4.4.4.4.2"><times id="S4.E10.m1.4.4.4.4.2.2.cmml" xref="S4.E10.m1.4.4.4.4.2.2"></times><apply id="S4.E10.m1.4.4.4.4.2.3.cmml" xref="S4.E10.m1.4.4.4.4.2.3"><csymbol cd="ambiguous" id="S4.E10.m1.4.4.4.4.2.3.1.cmml" xref="S4.E10.m1.4.4.4.4.2.3">subscript</csymbol><ci id="S4.E10.m1.4.4.4.4.2.3.2.cmml" xref="S4.E10.m1.4.4.4.4.2.3.2">𝜋</ci><cn id="S4.E10.m1.4.4.4.4.2.3.3.cmml" type="integer" xref="S4.E10.m1.4.4.4.4.2.3.3">0</cn></apply><ci id="S4.E10.m1.4.4.4.4.2.1.cmml" xref="S4.E10.m1.4.4.4.4.2.1">𝑎</ci></apply></apply><ci id="S4.E10.m1.8.8.8.8.1.1.1.3.2.cmml" xref="S4.E10.m1.8.8.8.8.1.1.1.3.2">𝑟</ci></apply><apply id="S4.E10.m1.8.8.8.8.1.1.1.1.cmml" xref="S4.E10.m1.8.8.8.8.1.1.1.1"><times id="S4.E10.m1.8.8.8.8.1.1.1.1.2.cmml" xref="S4.E10.m1.8.8.8.8.1.1.1.1.2"></times><apply id="S4.E10.m1.6.6.6.6.cmml" xref="S4.E10.m1.6.6.6.6"><divide id="S4.E10.m1.6.6.6.6.3.cmml" xref="S4.E10.m1.6.6.6.6"></divide><apply id="S4.E10.m1.5.5.5.5.1.cmml" xref="S4.E10.m1.5.5.5.5.1"><times id="S4.E10.m1.5.5.5.5.1.2.cmml" xref="S4.E10.m1.5.5.5.5.1.2"></times><apply id="S4.E10.m1.5.5.5.5.1.3.cmml" xref="S4.E10.m1.5.5.5.5.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.5.5.5.5.1.3.1.cmml" xref="S4.E10.m1.5.5.5.5.1.3">subscript</csymbol><ci id="S4.E10.m1.5.5.5.5.1.3.2.cmml" xref="S4.E10.m1.5.5.5.5.1.3.2">𝜋</ci><ci id="S4.E10.m1.5.5.5.5.1.3.3.cmml" xref="S4.E10.m1.5.5.5.5.1.3.3">𝜃</ci></apply><ci id="S4.E10.m1.5.5.5.5.1.1.cmml" xref="S4.E10.m1.5.5.5.5.1.1">𝑎</ci></apply><apply id="S4.E10.m1.6.6.6.6.2.cmml" xref="S4.E10.m1.6.6.6.6.2"><times id="S4.E10.m1.6.6.6.6.2.2.cmml" xref="S4.E10.m1.6.6.6.6.2.2"></times><apply id="S4.E10.m1.6.6.6.6.2.3.cmml" xref="S4.E10.m1.6.6.6.6.2.3"><csymbol cd="ambiguous" id="S4.E10.m1.6.6.6.6.2.3.1.cmml" xref="S4.E10.m1.6.6.6.6.2.3">subscript</csymbol><ci id="S4.E10.m1.6.6.6.6.2.3.2.cmml" xref="S4.E10.m1.6.6.6.6.2.3.2">𝜋</ci><cn id="S4.E10.m1.6.6.6.6.2.3.3.cmml" type="integer" xref="S4.E10.m1.6.6.6.6.2.3.3">0</cn></apply><ci id="S4.E10.m1.6.6.6.6.2.1.cmml" xref="S4.E10.m1.6.6.6.6.2.1">𝑎</ci></apply></apply><apply id="S4.E10.m1.8.8.8.8.1.1.1.1.3.cmml" xref="S4.E10.m1.8.8.8.8.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.8.8.8.8.1.1.1.1.3.1.cmml" xref="S4.E10.m1.8.8.8.8.1.1.1.1.3">subscript</csymbol><apply id="S4.E10.m1.8.8.8.8.1.1.1.1.3.2.cmml" xref="S4.E10.m1.8.8.8.8.1.1.1.1.3.2"><ci id="S4.E10.m1.8.8.8.8.1.1.1.1.3.2.1.cmml" xref="S4.E10.m1.8.8.8.8.1.1.1.1.3.2.1">^</ci><ci id="S4.E10.m1.8.8.8.8.1.1.1.1.3.2.2.cmml" xref="S4.E10.m1.8.8.8.8.1.1.1.1.3.2.2">𝑉</ci></apply><ci id="S4.E10.m1.8.8.8.8.1.1.1.1.3.3.cmml" xref="S4.E10.m1.8.8.8.8.1.1.1.1.3.3">SNIPS</ci></apply><interval closure="open" id="S4.E10.m1.8.8.8.8.1.1.1.1.1.2.cmml" xref="S4.E10.m1.8.8.8.8.1.1.1.1.1.1"><apply id="S4.E10.m1.8.8.8.8.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.8.8.8.8.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.8.8.8.8.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.8.8.8.8.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E10.m1.8.8.8.8.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.8.8.8.8.1.1.1.1.1.1.1.2">𝜋</ci><ci id="S4.E10.m1.8.8.8.8.1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.8.8.8.8.1.1.1.1.1.1.1.3">𝜃</ci></apply><ci id="S4.E10.m1.7.7.7.7.cmml" xref="S4.E10.m1.7.7.7.7">𝒟</ci></interval></apply></apply><cn id="S4.E10.m1.8.8.8.8.3.cmml" type="integer" xref="S4.E10.m1.8.8.8.8.3">2</cn></apply></apply><apply id="S4.E10.m1.15.15.15.cmml" xref="S4.E10.m1.15.15.15"><times id="S4.E10.m1.15.15.15.8.cmml" xref="S4.E10.m1.15.15.15.8"></times><apply id="S4.E10.m1.14.14.14.6.1.1.cmml" xref="S4.E10.m1.14.14.14.6.1"><minus id="S4.E10.m1.14.14.14.6.1.1.1.cmml" xref="S4.E10.m1.14.14.14.6.1.1.1"></minus><ci id="S4.E10.m1.14.14.14.6.1.1.2.cmml" xref="S4.E10.m1.14.14.14.6.1.1.2">𝑁</ci><cn id="S4.E10.m1.14.14.14.6.1.1.3.cmml" type="integer" xref="S4.E10.m1.14.14.14.6.1.1.3">1</cn></apply><apply id="S4.E10.m1.15.15.15.7.cmml" xref="S4.E10.m1.15.15.15.7"><csymbol cd="ambiguous" id="S4.E10.m1.15.15.15.7.2.cmml" xref="S4.E10.m1.15.15.15.7">superscript</csymbol><apply id="S4.E10.m1.15.15.15.7.1.1.1.cmml" xref="S4.E10.m1.15.15.15.7.1.1"><times id="S4.E10.m1.15.15.15.7.1.1.1.1.cmml" xref="S4.E10.m1.15.15.15.7.1.1.1.1"></times><apply id="S4.E10.m1.9.9.9.1.cmml" xref="S4.E10.m1.9.9.9.1"><divide id="S4.E10.m1.9.9.9.1.2.cmml" xref="S4.E10.m1.9.9.9.1"></divide><cn id="S4.E10.m1.9.9.9.1.3.cmml" type="integer" xref="S4.E10.m1.9.9.9.1.3">1</cn><apply id="S4.E10.m1.9.9.9.1.1.2.cmml" xref="S4.E10.m1.9.9.9.1.1.3"><abs id="S4.E10.m1.9.9.9.1.1.2.1.cmml" xref="S4.E10.m1.9.9.9.1.1.3.1"></abs><ci id="S4.E10.m1.9.9.9.1.1.1.cmml" xref="S4.E10.m1.9.9.9.1.1.1">𝒟</ci></apply></apply><apply id="S4.E10.m1.15.15.15.7.1.1.1.2.cmml" xref="S4.E10.m1.15.15.15.7.1.1.1.2"><apply id="S4.E10.m1.15.15.15.7.1.1.1.2.1.cmml" xref="S4.E10.m1.15.15.15.7.1.1.1.2.1"><csymbol cd="ambiguous" id="S4.E10.m1.15.15.15.7.1.1.1.2.1.1.cmml" xref="S4.E10.m1.15.15.15.7.1.1.1.2.1">subscript</csymbol><sum id="S4.E10.m1.15.15.15.7.1.1.1.2.1.2.cmml" xref="S4.E10.m1.15.15.15.7.1.1.1.2.1.2"></sum><apply id="S4.E10.m1.11.11.11.3.2.cmml" xref="S4.E10.m1.11.11.11.3.2"><in id="S4.E10.m1.11.11.11.3.2.3.cmml" xref="S4.E10.m1.11.11.11.3.2.3"></in><interval closure="open" id="S4.E10.m1.11.11.11.3.2.4.1.cmml" xref="S4.E10.m1.11.11.11.3.2.4.2"><ci id="S4.E10.m1.10.10.10.2.1.1.cmml" xref="S4.E10.m1.10.10.10.2.1.1">𝑎</ci><ci id="S4.E10.m1.11.11.11.3.2.2.cmml" xref="S4.E10.m1.11.11.11.3.2.2">𝑟</ci></interval><ci id="S4.E10.m1.11.11.11.3.2.5.cmml" xref="S4.E10.m1.11.11.11.3.2.5">𝒟</ci></apply></apply><apply id="S4.E10.m1.13.13.13.5.cmml" xref="S4.E10.m1.13.13.13.5"><divide id="S4.E10.m1.13.13.13.5.3.cmml" xref="S4.E10.m1.13.13.13.5"></divide><apply id="S4.E10.m1.12.12.12.4.1.cmml" xref="S4.E10.m1.12.12.12.4.1"><times id="S4.E10.m1.12.12.12.4.1.2.cmml" xref="S4.E10.m1.12.12.12.4.1.2"></times><apply id="S4.E10.m1.12.12.12.4.1.3.cmml" xref="S4.E10.m1.12.12.12.4.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.12.12.12.4.1.3.1.cmml" xref="S4.E10.m1.12.12.12.4.1.3">subscript</csymbol><ci id="S4.E10.m1.12.12.12.4.1.3.2.cmml" xref="S4.E10.m1.12.12.12.4.1.3.2">𝜋</ci><ci id="S4.E10.m1.12.12.12.4.1.3.3.cmml" xref="S4.E10.m1.12.12.12.4.1.3.3">𝜃</ci></apply><ci id="S4.E10.m1.12.12.12.4.1.1.cmml" xref="S4.E10.m1.12.12.12.4.1.1">𝑎</ci></apply><apply id="S4.E10.m1.13.13.13.5.2.cmml" xref="S4.E10.m1.13.13.13.5.2"><times id="S4.E10.m1.13.13.13.5.2.2.cmml" xref="S4.E10.m1.13.13.13.5.2.2"></times><apply id="S4.E10.m1.13.13.13.5.2.3.cmml" xref="S4.E10.m1.13.13.13.5.2.3"><csymbol cd="ambiguous" id="S4.E10.m1.13.13.13.5.2.3.1.cmml" xref="S4.E10.m1.13.13.13.5.2.3">subscript</csymbol><ci id="S4.E10.m1.13.13.13.5.2.3.2.cmml" xref="S4.E10.m1.13.13.13.5.2.3.2">𝜋</ci><cn id="S4.E10.m1.13.13.13.5.2.3.3.cmml" type="integer" xref="S4.E10.m1.13.13.13.5.2.3.3">0</cn></apply><ci id="S4.E10.m1.13.13.13.5.2.1.cmml" xref="S4.E10.m1.13.13.13.5.2.1">𝑎</ci></apply></apply></apply></apply><cn id="S4.E10.m1.15.15.15.7.3.cmml" type="integer" xref="S4.E10.m1.15.15.15.7.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.17c">\widehat{{\rm Var}}\left(\widehat{V}_{\rm SNIPS}(\pi_{\theta},\mathcal{D})%
\right)=\frac{\sum_{(a,r)\in\mathcal{D}}\left(\frac{\pi_{\theta}(a)}{\pi_{0}(a%
)}r-\frac{\pi_{\theta}(a)}{\pi_{0}(a)}\widehat{V}_{\rm SNIPS}(\pi_{\theta},%
\mathcal{D})\right)^{2}}{(N-1)\left(\frac{1}{|\mathcal{D}|}\sum_{(a,r)\in%
\mathcal{D}}\frac{\pi_{\theta}(a)}{\pi_{0}(a)}\right)^{2}}.</annotation><annotation encoding="application/x-llamapun" id="S4.E10.m1.17d">over^ start_ARG roman_Var end_ARG ( over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_SNIPS end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT , caligraphic_D ) ) = divide start_ARG ∑ start_POSTSUBSCRIPT ( italic_a , italic_r ) ∈ caligraphic_D end_POSTSUBSCRIPT ( divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a ) end_ARG italic_r - divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a ) end_ARG over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_SNIPS end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT , caligraphic_D ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG ( italic_N - 1 ) ( divide start_ARG 1 end_ARG start_ARG | caligraphic_D | end_ARG ∑ start_POSTSUBSCRIPT ( italic_a , italic_r ) ∈ caligraphic_D end_POSTSUBSCRIPT divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a ) end_ARG ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Effective Sample Size Corrections</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.2">Whilst the CLT justifies the use of such estimates to obtain confidence intervals for <math alttext="\widehat{V}_{\rm(SN)IPS}" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><msub id="S4.SS1.p1.1.m1.1.2" xref="S4.SS1.p1.1.m1.1.2.cmml"><mover accent="true" id="S4.SS1.p1.1.m1.1.2.2" xref="S4.SS1.p1.1.m1.1.2.2.cmml"><mi id="S4.SS1.p1.1.m1.1.2.2.2" xref="S4.SS1.p1.1.m1.1.2.2.2.cmml">V</mi><mo id="S4.SS1.p1.1.m1.1.2.2.1" xref="S4.SS1.p1.1.m1.1.2.2.1.cmml">^</mo></mover><mrow id="S4.SS1.p1.1.m1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.cmml"><mrow id="S4.SS1.p1.1.m1.1.1.1.3.2" xref="S4.SS1.p1.1.m1.1.1.1.cmml"><mo id="S4.SS1.p1.1.m1.1.1.1.3.2.1" stretchy="false" xref="S4.SS1.p1.1.m1.1.1.1.cmml">(</mo><mi id="S4.SS1.p1.1.m1.1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.1.cmml">SN</mi><mo id="S4.SS1.p1.1.m1.1.1.1.3.2.2" stretchy="false" xref="S4.SS1.p1.1.m1.1.1.1.cmml">)</mo></mrow><mo id="S4.SS1.p1.1.m1.1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.1.2.cmml">⁢</mo><mi id="S4.SS1.p1.1.m1.1.1.1.4" xref="S4.SS1.p1.1.m1.1.1.1.4.cmml">IPS</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.2.1.cmml" xref="S4.SS1.p1.1.m1.1.2">subscript</csymbol><apply id="S4.SS1.p1.1.m1.1.2.2.cmml" xref="S4.SS1.p1.1.m1.1.2.2"><ci id="S4.SS1.p1.1.m1.1.2.2.1.cmml" xref="S4.SS1.p1.1.m1.1.2.2.1">^</ci><ci id="S4.SS1.p1.1.m1.1.2.2.2.cmml" xref="S4.SS1.p1.1.m1.1.2.2.2">𝑉</ci></apply><apply id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1"><times id="S4.SS1.p1.1.m1.1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.1.2"></times><ci id="S4.SS1.p1.1.m1.1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1">SN</ci><ci id="S4.SS1.p1.1.m1.1.1.1.4.cmml" xref="S4.SS1.p1.1.m1.1.1.1.4">IPS</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\widehat{V}_{\rm(SN)IPS}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT ( roman_SN ) roman_IPS end_POSTSUBSCRIPT</annotation></semantics></math> in large-sample scenarios, it does not tell us when the sample size is sufficient.
As <cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib4" title="">Bottou et al<span class="ltx_text">.</span></a></cite> write: “<em class="ltx_emph ltx_font_italic" id="S4.SS1.p1.2.1">central limit convergence might occur
too slowly to justify such confidence intervals</em>” <cite class="ltx_cite ltx_citemacro_citep">(Bottou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib4" title="">2013</a>)</cite>.
We empirically observe this phenomenon, and highlight it in our experiments.
<cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib4" title="">Bottou et al<span class="ltx_text">.</span></a></cite>’s proposed solution is two-fold <cite class="ltx_cite ltx_citemacro_citep">(Bottou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib4" title="">2013</a>)</cite>: reduce the variance of <math alttext="\widehat{V}_{\rm IPS}" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><msub id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mover accent="true" id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2.2" xref="S4.SS1.p1.2.m2.1.1.2.2.cmml">V</mi><mo id="S4.SS1.p1.2.m2.1.1.2.1" xref="S4.SS1.p1.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">IPS</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">subscript</csymbol><apply id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2"><ci id="S4.SS1.p1.2.m2.1.1.2.1.cmml" xref="S4.SS1.p1.2.m2.1.1.2.1">^</ci><ci id="S4.SS1.p1.2.m2.1.1.2.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2.2">𝑉</ci></apply><ci id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3">IPS</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\widehat{V}_{\rm IPS}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_IPS end_POSTSUBSCRIPT</annotation></semantics></math> by clipping the importance weights <cite class="ltx_cite ltx_citemacro_citep">(Ionides, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib24" title="">2008</a>; Gilotte et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib18" title="">2018</a>)</cite>, bound the bias this introduces to the estimator, and provide an <em class="ltx_emph ltx_font_italic" id="S4.SS1.p1.2.2">inner</em> and <em class="ltx_emph ltx_font_italic" id="S4.SS1.p1.2.3">outer</em> confidence interval.
Whilst this can be effective for <em class="ltx_emph ltx_font_italic" id="S4.SS1.p1.2.4">evaluation</em>, we wish to obtain confidence intervals that we can plug into Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S3.E7" title="In 3. Multivariate Off-Policy Learning ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">7</span></a> to obtain a lower bound with improved empirical coverage.
As such, the alternative estimator we wish to construct has two desiderata:

<span class="ltx_inline-enumerate" id="S4.I1">
<span class="ltx_inline-item" id="S4.I1.i1"><span class="ltx_tag ltx_tag_inline-item">(1)</span> <span class="ltx_text" id="S4.I1.i1.1">improved coverage at small sample sizes, and
</span></span>
<span class="ltx_inline-item" id="S4.I1.i2"><span class="ltx_tag ltx_tag_inline-item">(2)</span> <span class="ltx_text" id="S4.I1.i2.1">convergence to the Gaussian estimator at large sample sizes (i.e. <em class="ltx_emph ltx_font_italic" id="S4.I1.i2.1.1">consistency</em> with the CLT).
</span></span>
</span>
Indeed, inflating the variance estimate will help (1), but leave much to be desired for (2).</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.2">To satisfy property (1), we leverage the Effective Sample Size (ESS) <cite class="ltx_cite ltx_citemacro_citep">(Owen, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib52" title="">2013</a>, §9.3)</cite>.
The ESS estimates the number of independent samples from the target policy that would be equally informative as the actual weighted samples from the logging policy that we have <cite class="ltx_cite ltx_citemacro_citep">(Elvira et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib17" title="">2022</a>)</cite>.
When the ESS is low, we can expect the variance estimates in Eqs. <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S4.E9" title="In 4. Improving the CRM Lower Bound ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">9</span></a>–<a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S4.E10" title="In 4. Improving the CRM Lower Bound ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">10</span></a> to be <em class="ltx_emph ltx_font_italic" id="S4.SS1.p2.2.1">under</em>-estimates.
When the ESS is high (i.e. maximally <math alttext="N" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><mi id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">italic_N</annotation></semantics></math> when <math alttext="\pi_{\theta}\equiv\pi_{0}" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.1"><semantics id="S4.SS1.p2.2.m2.1a"><mrow id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml"><msub id="S4.SS1.p2.2.m2.1.1.2" xref="S4.SS1.p2.2.m2.1.1.2.cmml"><mi id="S4.SS1.p2.2.m2.1.1.2.2" xref="S4.SS1.p2.2.m2.1.1.2.2.cmml">π</mi><mi id="S4.SS1.p2.2.m2.1.1.2.3" xref="S4.SS1.p2.2.m2.1.1.2.3.cmml">θ</mi></msub><mo id="S4.SS1.p2.2.m2.1.1.1" xref="S4.SS1.p2.2.m2.1.1.1.cmml">≡</mo><msub id="S4.SS1.p2.2.m2.1.1.3" xref="S4.SS1.p2.2.m2.1.1.3.cmml"><mi id="S4.SS1.p2.2.m2.1.1.3.2" xref="S4.SS1.p2.2.m2.1.1.3.2.cmml">π</mi><mn id="S4.SS1.p2.2.m2.1.1.3.3" xref="S4.SS1.p2.2.m2.1.1.3.3.cmml">0</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><apply id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"><equivalent id="S4.SS1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1.1"></equivalent><apply id="S4.SS1.p2.2.m2.1.1.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.1.1.2.1.cmml" xref="S4.SS1.p2.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS1.p2.2.m2.1.1.2.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2.2">𝜋</ci><ci id="S4.SS1.p2.2.m2.1.1.2.3.cmml" xref="S4.SS1.p2.2.m2.1.1.2.3">𝜃</ci></apply><apply id="S4.SS1.p2.2.m2.1.1.3.cmml" xref="S4.SS1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.1.1.3.1.cmml" xref="S4.SS1.p2.2.m2.1.1.3">subscript</csymbol><ci id="S4.SS1.p2.2.m2.1.1.3.2.cmml" xref="S4.SS1.p2.2.m2.1.1.3.2">𝜋</ci><cn id="S4.SS1.p2.2.m2.1.1.3.3.cmml" type="integer" xref="S4.SS1.p2.2.m2.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">\pi_{\theta}\equiv\pi_{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ≡ italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>), we are not losing any statistical efficiency due to importance sampling, and we can only hope for CLT convergence.
To satisfy property (2), we formulate our estimator as a multiplicative correction factor to the original sample size.
Thus, as the sample size grows, we retain consistency and coverage guarantees at larger sample sizes (from the CLT), whilst exhibiting improved coverage at smaller sample sizes (which we show empirically in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S7.SS1" title="7.1. ESS Corrections &amp; Estimator Coverage (RQ1) ‣ 7. Experiments &amp; Discussion ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">7.1</span></a>).
We define the ESS-corrected sample size as:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(11)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\widetilde{N}=1+\frac{N(\widehat{\rm ESS}-1)}{\widehat{\rm ESS}}." class="ltx_Math" display="block" id="S4.E11.m1.2"><semantics id="S4.E11.m1.2a"><mrow id="S4.E11.m1.2.2.1" xref="S4.E11.m1.2.2.1.1.cmml"><mrow id="S4.E11.m1.2.2.1.1" xref="S4.E11.m1.2.2.1.1.cmml"><mover accent="true" id="S4.E11.m1.2.2.1.1.2" xref="S4.E11.m1.2.2.1.1.2.cmml"><mi id="S4.E11.m1.2.2.1.1.2.2" xref="S4.E11.m1.2.2.1.1.2.2.cmml">N</mi><mo id="S4.E11.m1.2.2.1.1.2.1" xref="S4.E11.m1.2.2.1.1.2.1.cmml">~</mo></mover><mo id="S4.E11.m1.2.2.1.1.1" xref="S4.E11.m1.2.2.1.1.1.cmml">=</mo><mrow id="S4.E11.m1.2.2.1.1.3" xref="S4.E11.m1.2.2.1.1.3.cmml"><mn id="S4.E11.m1.2.2.1.1.3.2" xref="S4.E11.m1.2.2.1.1.3.2.cmml">1</mn><mo id="S4.E11.m1.2.2.1.1.3.1" xref="S4.E11.m1.2.2.1.1.3.1.cmml">+</mo><mfrac id="S4.E11.m1.1.1" xref="S4.E11.m1.1.1.cmml"><mrow id="S4.E11.m1.1.1.1" xref="S4.E11.m1.1.1.1.cmml"><mi id="S4.E11.m1.1.1.1.3" xref="S4.E11.m1.1.1.1.3.cmml">N</mi><mo id="S4.E11.m1.1.1.1.2" xref="S4.E11.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E11.m1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.cmml"><mo id="S4.E11.m1.1.1.1.1.1.2" stretchy="false" xref="S4.E11.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E11.m1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.E11.m1.1.1.1.1.1.1.2" xref="S4.E11.m1.1.1.1.1.1.1.2.cmml"><mi id="S4.E11.m1.1.1.1.1.1.1.2.2" xref="S4.E11.m1.1.1.1.1.1.1.2.2.cmml">ESS</mi><mo id="S4.E11.m1.1.1.1.1.1.1.2.1" xref="S4.E11.m1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo id="S4.E11.m1.1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S4.E11.m1.1.1.1.1.1.1.3" xref="S4.E11.m1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E11.m1.1.1.1.1.1.3" stretchy="false" xref="S4.E11.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mover accent="true" id="S4.E11.m1.1.1.3" xref="S4.E11.m1.1.1.3.cmml"><mi id="S4.E11.m1.1.1.3.2" xref="S4.E11.m1.1.1.3.2.cmml">ESS</mi><mo id="S4.E11.m1.1.1.3.1" xref="S4.E11.m1.1.1.3.1.cmml">^</mo></mover></mfrac></mrow></mrow><mo id="S4.E11.m1.2.2.1.2" lspace="0em" xref="S4.E11.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.2b"><apply id="S4.E11.m1.2.2.1.1.cmml" xref="S4.E11.m1.2.2.1"><eq id="S4.E11.m1.2.2.1.1.1.cmml" xref="S4.E11.m1.2.2.1.1.1"></eq><apply id="S4.E11.m1.2.2.1.1.2.cmml" xref="S4.E11.m1.2.2.1.1.2"><ci id="S4.E11.m1.2.2.1.1.2.1.cmml" xref="S4.E11.m1.2.2.1.1.2.1">~</ci><ci id="S4.E11.m1.2.2.1.1.2.2.cmml" xref="S4.E11.m1.2.2.1.1.2.2">𝑁</ci></apply><apply id="S4.E11.m1.2.2.1.1.3.cmml" xref="S4.E11.m1.2.2.1.1.3"><plus id="S4.E11.m1.2.2.1.1.3.1.cmml" xref="S4.E11.m1.2.2.1.1.3.1"></plus><cn id="S4.E11.m1.2.2.1.1.3.2.cmml" type="integer" xref="S4.E11.m1.2.2.1.1.3.2">1</cn><apply id="S4.E11.m1.1.1.cmml" xref="S4.E11.m1.1.1"><divide id="S4.E11.m1.1.1.2.cmml" xref="S4.E11.m1.1.1"></divide><apply id="S4.E11.m1.1.1.1.cmml" xref="S4.E11.m1.1.1.1"><times id="S4.E11.m1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.2"></times><ci id="S4.E11.m1.1.1.1.3.cmml" xref="S4.E11.m1.1.1.1.3">𝑁</ci><apply id="S4.E11.m1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1"><minus id="S4.E11.m1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1"></minus><apply id="S4.E11.m1.1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.2"><ci id="S4.E11.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.2.1">^</ci><ci id="S4.E11.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.2.2">ESS</ci></apply><cn id="S4.E11.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E11.m1.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S4.E11.m1.1.1.3.cmml" xref="S4.E11.m1.1.1.3"><ci id="S4.E11.m1.1.1.3.1.cmml" xref="S4.E11.m1.1.1.3.1">^</ci><ci id="S4.E11.m1.1.1.3.2.cmml" xref="S4.E11.m1.1.1.3.2">ESS</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.2c">\widetilde{N}=1+\frac{N(\widehat{\rm ESS}-1)}{\widehat{\rm ESS}}.</annotation><annotation encoding="application/x-llamapun" id="S4.E11.m1.2d">over~ start_ARG italic_N end_ARG = 1 + divide start_ARG italic_N ( over^ start_ARG roman_ESS end_ARG - 1 ) end_ARG start_ARG over^ start_ARG roman_ESS end_ARG end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p2.13">From this formula, it is clear that <math alttext="\widetilde{N}" class="ltx_Math" display="inline" id="S4.SS1.p2.3.m1.1"><semantics id="S4.SS1.p2.3.m1.1a"><mover accent="true" id="S4.SS1.p2.3.m1.1.1" xref="S4.SS1.p2.3.m1.1.1.cmml"><mi id="S4.SS1.p2.3.m1.1.1.2" xref="S4.SS1.p2.3.m1.1.1.2.cmml">N</mi><mo id="S4.SS1.p2.3.m1.1.1.1" xref="S4.SS1.p2.3.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m1.1b"><apply id="S4.SS1.p2.3.m1.1.1.cmml" xref="S4.SS1.p2.3.m1.1.1"><ci id="S4.SS1.p2.3.m1.1.1.1.cmml" xref="S4.SS1.p2.3.m1.1.1.1">~</ci><ci id="S4.SS1.p2.3.m1.1.1.2.cmml" xref="S4.SS1.p2.3.m1.1.1.2">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m1.1c">\widetilde{N}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.3.m1.1d">over~ start_ARG italic_N end_ARG</annotation></semantics></math> is monotonically increasing as a function of <math alttext="N" class="ltx_Math" display="inline" id="S4.SS1.p2.4.m2.1"><semantics id="S4.SS1.p2.4.m2.1a"><mi id="S4.SS1.p2.4.m2.1.1" xref="S4.SS1.p2.4.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m2.1b"><ci id="S4.SS1.p2.4.m2.1.1.cmml" xref="S4.SS1.p2.4.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.4.m2.1d">italic_N</annotation></semantics></math>, and that <math alttext="\widetilde{N}\equiv N" class="ltx_Math" display="inline" id="S4.SS1.p2.5.m3.1"><semantics id="S4.SS1.p2.5.m3.1a"><mrow id="S4.SS1.p2.5.m3.1.1" xref="S4.SS1.p2.5.m3.1.1.cmml"><mover accent="true" id="S4.SS1.p2.5.m3.1.1.2" xref="S4.SS1.p2.5.m3.1.1.2.cmml"><mi id="S4.SS1.p2.5.m3.1.1.2.2" xref="S4.SS1.p2.5.m3.1.1.2.2.cmml">N</mi><mo id="S4.SS1.p2.5.m3.1.1.2.1" xref="S4.SS1.p2.5.m3.1.1.2.1.cmml">~</mo></mover><mo id="S4.SS1.p2.5.m3.1.1.1" xref="S4.SS1.p2.5.m3.1.1.1.cmml">≡</mo><mi id="S4.SS1.p2.5.m3.1.1.3" xref="S4.SS1.p2.5.m3.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m3.1b"><apply id="S4.SS1.p2.5.m3.1.1.cmml" xref="S4.SS1.p2.5.m3.1.1"><equivalent id="S4.SS1.p2.5.m3.1.1.1.cmml" xref="S4.SS1.p2.5.m3.1.1.1"></equivalent><apply id="S4.SS1.p2.5.m3.1.1.2.cmml" xref="S4.SS1.p2.5.m3.1.1.2"><ci id="S4.SS1.p2.5.m3.1.1.2.1.cmml" xref="S4.SS1.p2.5.m3.1.1.2.1">~</ci><ci id="S4.SS1.p2.5.m3.1.1.2.2.cmml" xref="S4.SS1.p2.5.m3.1.1.2.2">𝑁</ci></apply><ci id="S4.SS1.p2.5.m3.1.1.3.cmml" xref="S4.SS1.p2.5.m3.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m3.1c">\widetilde{N}\equiv N</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.5.m3.1d">over~ start_ARG italic_N end_ARG ≡ italic_N</annotation></semantics></math> when <math alttext="\widehat{\rm ESS}\equiv N" class="ltx_Math" display="inline" id="S4.SS1.p2.6.m4.1"><semantics id="S4.SS1.p2.6.m4.1a"><mrow id="S4.SS1.p2.6.m4.1.1" xref="S4.SS1.p2.6.m4.1.1.cmml"><mover accent="true" id="S4.SS1.p2.6.m4.1.1.2" xref="S4.SS1.p2.6.m4.1.1.2.cmml"><mi id="S4.SS1.p2.6.m4.1.1.2.2" xref="S4.SS1.p2.6.m4.1.1.2.2.cmml">ESS</mi><mo id="S4.SS1.p2.6.m4.1.1.2.1" xref="S4.SS1.p2.6.m4.1.1.2.1.cmml">^</mo></mover><mo id="S4.SS1.p2.6.m4.1.1.1" xref="S4.SS1.p2.6.m4.1.1.1.cmml">≡</mo><mi id="S4.SS1.p2.6.m4.1.1.3" xref="S4.SS1.p2.6.m4.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m4.1b"><apply id="S4.SS1.p2.6.m4.1.1.cmml" xref="S4.SS1.p2.6.m4.1.1"><equivalent id="S4.SS1.p2.6.m4.1.1.1.cmml" xref="S4.SS1.p2.6.m4.1.1.1"></equivalent><apply id="S4.SS1.p2.6.m4.1.1.2.cmml" xref="S4.SS1.p2.6.m4.1.1.2"><ci id="S4.SS1.p2.6.m4.1.1.2.1.cmml" xref="S4.SS1.p2.6.m4.1.1.2.1">^</ci><ci id="S4.SS1.p2.6.m4.1.1.2.2.cmml" xref="S4.SS1.p2.6.m4.1.1.2.2">ESS</ci></apply><ci id="S4.SS1.p2.6.m4.1.1.3.cmml" xref="S4.SS1.p2.6.m4.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m4.1c">\widehat{\rm ESS}\equiv N</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.6.m4.1d">over^ start_ARG roman_ESS end_ARG ≡ italic_N</annotation></semantics></math>.
Furthermore, when <math alttext="{\rm ESS}&gt;1" class="ltx_Math" display="inline" id="S4.SS1.p2.7.m5.1"><semantics id="S4.SS1.p2.7.m5.1a"><mrow id="S4.SS1.p2.7.m5.1.1" xref="S4.SS1.p2.7.m5.1.1.cmml"><mi id="S4.SS1.p2.7.m5.1.1.2" xref="S4.SS1.p2.7.m5.1.1.2.cmml">ESS</mi><mo id="S4.SS1.p2.7.m5.1.1.1" xref="S4.SS1.p2.7.m5.1.1.1.cmml">&gt;</mo><mn id="S4.SS1.p2.7.m5.1.1.3" xref="S4.SS1.p2.7.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m5.1b"><apply id="S4.SS1.p2.7.m5.1.1.cmml" xref="S4.SS1.p2.7.m5.1.1"><gt id="S4.SS1.p2.7.m5.1.1.1.cmml" xref="S4.SS1.p2.7.m5.1.1.1"></gt><ci id="S4.SS1.p2.7.m5.1.1.2.cmml" xref="S4.SS1.p2.7.m5.1.1.2">ESS</ci><cn id="S4.SS1.p2.7.m5.1.1.3.cmml" type="integer" xref="S4.SS1.p2.7.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.7.m5.1c">{\rm ESS}&gt;1</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.7.m5.1d">roman_ESS &gt; 1</annotation></semantics></math>, as <math alttext="N" class="ltx_Math" display="inline" id="S4.SS1.p2.8.m6.1"><semantics id="S4.SS1.p2.8.m6.1a"><mi id="S4.SS1.p2.8.m6.1.1" xref="S4.SS1.p2.8.m6.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.8.m6.1b"><ci id="S4.SS1.p2.8.m6.1.1.cmml" xref="S4.SS1.p2.8.m6.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.8.m6.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.8.m6.1d">italic_N</annotation></semantics></math> grows, Eq. 11 converges towards <math alttext="N" class="ltx_Math" display="inline" id="S4.SS1.p2.9.m7.1"><semantics id="S4.SS1.p2.9.m7.1a"><mi id="S4.SS1.p2.9.m7.1.1" xref="S4.SS1.p2.9.m7.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.9.m7.1b"><ci id="S4.SS1.p2.9.m7.1.1.cmml" xref="S4.SS1.p2.9.m7.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.9.m7.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.9.m7.1d">italic_N</annotation></semantics></math>.
As a result, <math alttext="\widetilde{N}" class="ltx_Math" display="inline" id="S4.SS1.p2.10.m8.1"><semantics id="S4.SS1.p2.10.m8.1a"><mover accent="true" id="S4.SS1.p2.10.m8.1.1" xref="S4.SS1.p2.10.m8.1.1.cmml"><mi id="S4.SS1.p2.10.m8.1.1.2" xref="S4.SS1.p2.10.m8.1.1.2.cmml">N</mi><mo id="S4.SS1.p2.10.m8.1.1.1" xref="S4.SS1.p2.10.m8.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.10.m8.1b"><apply id="S4.SS1.p2.10.m8.1.1.cmml" xref="S4.SS1.p2.10.m8.1.1"><ci id="S4.SS1.p2.10.m8.1.1.1.cmml" xref="S4.SS1.p2.10.m8.1.1.1">~</ci><ci id="S4.SS1.p2.10.m8.1.1.2.cmml" xref="S4.SS1.p2.10.m8.1.1.2">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.10.m8.1c">\widetilde{N}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.10.m8.1d">over~ start_ARG italic_N end_ARG</annotation></semantics></math> is a consistent estimator for <math alttext="N" class="ltx_Math" display="inline" id="S4.SS1.p2.11.m9.1"><semantics id="S4.SS1.p2.11.m9.1a"><mi id="S4.SS1.p2.11.m9.1.1" xref="S4.SS1.p2.11.m9.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.11.m9.1b"><ci id="S4.SS1.p2.11.m9.1.1.cmml" xref="S4.SS1.p2.11.m9.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.11.m9.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.11.m9.1d">italic_N</annotation></semantics></math>, and as a consequence, variance estimates using <math alttext="\widetilde{N}" class="ltx_Math" display="inline" id="S4.SS1.p2.12.m10.1"><semantics id="S4.SS1.p2.12.m10.1a"><mover accent="true" id="S4.SS1.p2.12.m10.1.1" xref="S4.SS1.p2.12.m10.1.1.cmml"><mi id="S4.SS1.p2.12.m10.1.1.2" xref="S4.SS1.p2.12.m10.1.1.2.cmml">N</mi><mo id="S4.SS1.p2.12.m10.1.1.1" xref="S4.SS1.p2.12.m10.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.12.m10.1b"><apply id="S4.SS1.p2.12.m10.1.1.cmml" xref="S4.SS1.p2.12.m10.1.1"><ci id="S4.SS1.p2.12.m10.1.1.1.cmml" xref="S4.SS1.p2.12.m10.1.1.1">~</ci><ci id="S4.SS1.p2.12.m10.1.1.2.cmml" xref="S4.SS1.p2.12.m10.1.1.2">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.12.m10.1c">\widetilde{N}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.12.m10.1d">over~ start_ARG italic_N end_ARG</annotation></semantics></math> instead of <math alttext="N" class="ltx_Math" display="inline" id="S4.SS1.p2.13.m11.1"><semantics id="S4.SS1.p2.13.m11.1a"><mi id="S4.SS1.p2.13.m11.1.1" xref="S4.SS1.p2.13.m11.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.13.m11.1b"><ci id="S4.SS1.p2.13.m11.1.1.cmml" xref="S4.SS1.p2.13.m11.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.13.m11.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.13.m11.1d">italic_N</annotation></semantics></math> are also consistent.</p>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.3">In Eqs. <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S4.E9" title="In 4. Improving the CRM Lower Bound ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">9</span></a>–<a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S4.E10" title="In 4. Improving the CRM Lower Bound ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">10</span></a>, we then simply replace <math alttext="N" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><mi id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><ci id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">italic_N</annotation></semantics></math> with <math alttext="\widetilde{N}" class="ltx_Math" display="inline" id="S4.SS1.p3.2.m2.1"><semantics id="S4.SS1.p3.2.m2.1a"><mover accent="true" id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml"><mi id="S4.SS1.p3.2.m2.1.1.2" xref="S4.SS1.p3.2.m2.1.1.2.cmml">N</mi><mo id="S4.SS1.p3.2.m2.1.1.1" xref="S4.SS1.p3.2.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><apply id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1"><ci id="S4.SS1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1">~</ci><ci id="S4.SS1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">\widetilde{N}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.2.m2.1d">over~ start_ARG italic_N end_ARG</annotation></semantics></math> and denote this as <math alttext="\widehat{{\rm Var_{ESS}}}" class="ltx_Math" display="inline" id="S4.SS1.p3.3.m3.1"><semantics id="S4.SS1.p3.3.m3.1a"><mover accent="true" id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml"><msub id="S4.SS1.p3.3.m3.1.1.2" xref="S4.SS1.p3.3.m3.1.1.2.cmml"><mi id="S4.SS1.p3.3.m3.1.1.2.2" xref="S4.SS1.p3.3.m3.1.1.2.2.cmml">Var</mi><mi id="S4.SS1.p3.3.m3.1.1.2.3" xref="S4.SS1.p3.3.m3.1.1.2.3.cmml">ESS</mi></msub><mo id="S4.SS1.p3.3.m3.1.1.1" xref="S4.SS1.p3.3.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><apply id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1"><ci id="S4.SS1.p3.3.m3.1.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1.1">^</ci><apply id="S4.SS1.p3.3.m3.1.1.2.cmml" xref="S4.SS1.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.1.1.2.1.cmml" xref="S4.SS1.p3.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS1.p3.3.m3.1.1.2.2.cmml" xref="S4.SS1.p3.3.m3.1.1.2.2">Var</ci><ci id="S4.SS1.p3.3.m3.1.1.2.3.cmml" xref="S4.SS1.p3.3.m3.1.1.2.3">ESS</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">\widehat{{\rm Var_{ESS}}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.3.m3.1d">over^ start_ARG roman_Var start_POSTSUBSCRIPT roman_ESS end_POSTSUBSCRIPT end_ARG</annotation></semantics></math>.
This gives rise to a symmetric confidence interval as:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(12)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\widehat{V}_{\rm(SN)IPS}(\pi_{\theta},\mathcal{D})\pm\Phi^{-1}\left(1-\frac{%
\alpha}{2}\right)\sqrt{\frac{\widehat{\rm Var_{ESS}}\left(\widehat{V}_{\rm(SN)%
IPS}(\pi_{\theta},\mathcal{D})\right)}{\widetilde{N}}}." class="ltx_Math" display="block" id="S4.E12.m1.6"><semantics id="S4.E12.m1.6a"><mrow id="S4.E12.m1.6.6.1" xref="S4.E12.m1.6.6.1.1.cmml"><mrow id="S4.E12.m1.6.6.1.1" xref="S4.E12.m1.6.6.1.1.cmml"><mrow id="S4.E12.m1.6.6.1.1.1" xref="S4.E12.m1.6.6.1.1.1.cmml"><msub id="S4.E12.m1.6.6.1.1.1.3" xref="S4.E12.m1.6.6.1.1.1.3.cmml"><mover accent="true" id="S4.E12.m1.6.6.1.1.1.3.2" xref="S4.E12.m1.6.6.1.1.1.3.2.cmml"><mi id="S4.E12.m1.6.6.1.1.1.3.2.2" xref="S4.E12.m1.6.6.1.1.1.3.2.2.cmml">V</mi><mo id="S4.E12.m1.6.6.1.1.1.3.2.1" xref="S4.E12.m1.6.6.1.1.1.3.2.1.cmml">^</mo></mover><mrow id="S4.E12.m1.1.1.1" xref="S4.E12.m1.1.1.1.cmml"><mrow id="S4.E12.m1.1.1.1.3.2" xref="S4.E12.m1.1.1.1.cmml"><mo id="S4.E12.m1.1.1.1.3.2.1" stretchy="false" xref="S4.E12.m1.1.1.1.cmml">(</mo><mi id="S4.E12.m1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.cmml">SN</mi><mo id="S4.E12.m1.1.1.1.3.2.2" stretchy="false" xref="S4.E12.m1.1.1.1.cmml">)</mo></mrow><mo id="S4.E12.m1.1.1.1.2" xref="S4.E12.m1.1.1.1.2.cmml">⁢</mo><mi id="S4.E12.m1.1.1.1.4" xref="S4.E12.m1.1.1.1.4.cmml">IPS</mi></mrow></msub><mo id="S4.E12.m1.6.6.1.1.1.2" xref="S4.E12.m1.6.6.1.1.1.2.cmml">⁢</mo><mrow id="S4.E12.m1.6.6.1.1.1.1.1" xref="S4.E12.m1.6.6.1.1.1.1.2.cmml"><mo id="S4.E12.m1.6.6.1.1.1.1.1.2" stretchy="false" xref="S4.E12.m1.6.6.1.1.1.1.2.cmml">(</mo><msub id="S4.E12.m1.6.6.1.1.1.1.1.1" xref="S4.E12.m1.6.6.1.1.1.1.1.1.cmml"><mi id="S4.E12.m1.6.6.1.1.1.1.1.1.2" xref="S4.E12.m1.6.6.1.1.1.1.1.1.2.cmml">π</mi><mi id="S4.E12.m1.6.6.1.1.1.1.1.1.3" xref="S4.E12.m1.6.6.1.1.1.1.1.1.3.cmml">θ</mi></msub><mo id="S4.E12.m1.6.6.1.1.1.1.1.3" xref="S4.E12.m1.6.6.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.5.5" xref="S4.E12.m1.5.5.cmml">𝒟</mi><mo id="S4.E12.m1.6.6.1.1.1.1.1.4" stretchy="false" xref="S4.E12.m1.6.6.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E12.m1.6.6.1.1.3" xref="S4.E12.m1.6.6.1.1.3.cmml">±</mo><mrow id="S4.E12.m1.6.6.1.1.2" xref="S4.E12.m1.6.6.1.1.2.cmml"><msup id="S4.E12.m1.6.6.1.1.2.3" xref="S4.E12.m1.6.6.1.1.2.3.cmml"><mi id="S4.E12.m1.6.6.1.1.2.3.2" mathvariant="normal" xref="S4.E12.m1.6.6.1.1.2.3.2.cmml">Φ</mi><mrow id="S4.E12.m1.6.6.1.1.2.3.3" xref="S4.E12.m1.6.6.1.1.2.3.3.cmml"><mo id="S4.E12.m1.6.6.1.1.2.3.3a" xref="S4.E12.m1.6.6.1.1.2.3.3.cmml">−</mo><mn id="S4.E12.m1.6.6.1.1.2.3.3.2" xref="S4.E12.m1.6.6.1.1.2.3.3.2.cmml">1</mn></mrow></msup><mo id="S4.E12.m1.6.6.1.1.2.2" xref="S4.E12.m1.6.6.1.1.2.2.cmml">⁢</mo><mrow id="S4.E12.m1.6.6.1.1.2.1.1" xref="S4.E12.m1.6.6.1.1.2.1.1.1.cmml"><mo id="S4.E12.m1.6.6.1.1.2.1.1.2" xref="S4.E12.m1.6.6.1.1.2.1.1.1.cmml">(</mo><mrow id="S4.E12.m1.6.6.1.1.2.1.1.1" xref="S4.E12.m1.6.6.1.1.2.1.1.1.cmml"><mn id="S4.E12.m1.6.6.1.1.2.1.1.1.2" xref="S4.E12.m1.6.6.1.1.2.1.1.1.2.cmml">1</mn><mo id="S4.E12.m1.6.6.1.1.2.1.1.1.1" xref="S4.E12.m1.6.6.1.1.2.1.1.1.1.cmml">−</mo><mfrac id="S4.E12.m1.6.6.1.1.2.1.1.1.3" xref="S4.E12.m1.6.6.1.1.2.1.1.1.3.cmml"><mi id="S4.E12.m1.6.6.1.1.2.1.1.1.3.2" xref="S4.E12.m1.6.6.1.1.2.1.1.1.3.2.cmml">α</mi><mn id="S4.E12.m1.6.6.1.1.2.1.1.1.3.3" xref="S4.E12.m1.6.6.1.1.2.1.1.1.3.3.cmml">2</mn></mfrac></mrow><mo id="S4.E12.m1.6.6.1.1.2.1.1.3" xref="S4.E12.m1.6.6.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="S4.E12.m1.6.6.1.1.2.2a" xref="S4.E12.m1.6.6.1.1.2.2.cmml">⁢</mo><msqrt id="S4.E12.m1.4.4" xref="S4.E12.m1.4.4.cmml"><mfrac id="S4.E12.m1.4.4.3" xref="S4.E12.m1.4.4.3.cmml"><mrow id="S4.E12.m1.4.4.3.3.3" xref="S4.E12.m1.4.4.3.3.3.cmml"><mover accent="true" id="S4.E12.m1.4.4.3.3.3.5" xref="S4.E12.m1.4.4.3.3.3.5.cmml"><msub id="S4.E12.m1.4.4.3.3.3.5.2" xref="S4.E12.m1.4.4.3.3.3.5.2.cmml"><mi id="S4.E12.m1.4.4.3.3.3.5.2.2" xref="S4.E12.m1.4.4.3.3.3.5.2.2.cmml">Var</mi><mi id="S4.E12.m1.4.4.3.3.3.5.2.3" xref="S4.E12.m1.4.4.3.3.3.5.2.3.cmml">ESS</mi></msub><mo id="S4.E12.m1.4.4.3.3.3.5.1" xref="S4.E12.m1.4.4.3.3.3.5.1.cmml">^</mo></mover><mo id="S4.E12.m1.4.4.3.3.3.4" xref="S4.E12.m1.4.4.3.3.3.4.cmml">⁢</mo><mrow id="S4.E12.m1.4.4.3.3.3.3.1" xref="S4.E12.m1.4.4.3.3.3.3.1.1.cmml"><mo id="S4.E12.m1.4.4.3.3.3.3.1.2" xref="S4.E12.m1.4.4.3.3.3.3.1.1.cmml">(</mo><mrow id="S4.E12.m1.4.4.3.3.3.3.1.1" xref="S4.E12.m1.4.4.3.3.3.3.1.1.cmml"><msub id="S4.E12.m1.4.4.3.3.3.3.1.1.3" xref="S4.E12.m1.4.4.3.3.3.3.1.1.3.cmml"><mover accent="true" id="S4.E12.m1.4.4.3.3.3.3.1.1.3.2" xref="S4.E12.m1.4.4.3.3.3.3.1.1.3.2.cmml"><mi id="S4.E12.m1.4.4.3.3.3.3.1.1.3.2.2" xref="S4.E12.m1.4.4.3.3.3.3.1.1.3.2.2.cmml">V</mi><mo id="S4.E12.m1.4.4.3.3.3.3.1.1.3.2.1" xref="S4.E12.m1.4.4.3.3.3.3.1.1.3.2.1.cmml">^</mo></mover><mrow id="S4.E12.m1.2.2.1.1.1.1.1" xref="S4.E12.m1.2.2.1.1.1.1.1.cmml"><mrow id="S4.E12.m1.2.2.1.1.1.1.1.3.2" xref="S4.E12.m1.2.2.1.1.1.1.1.cmml"><mo id="S4.E12.m1.2.2.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.E12.m1.2.2.1.1.1.1.1.cmml">(</mo><mi id="S4.E12.m1.2.2.1.1.1.1.1.1" xref="S4.E12.m1.2.2.1.1.1.1.1.1.cmml">SN</mi><mo id="S4.E12.m1.2.2.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.E12.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E12.m1.2.2.1.1.1.1.1.2" xref="S4.E12.m1.2.2.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E12.m1.2.2.1.1.1.1.1.4" xref="S4.E12.m1.2.2.1.1.1.1.1.4.cmml">IPS</mi></mrow></msub><mo id="S4.E12.m1.4.4.3.3.3.3.1.1.2" xref="S4.E12.m1.4.4.3.3.3.3.1.1.2.cmml">⁢</mo><mrow id="S4.E12.m1.4.4.3.3.3.3.1.1.1.1" xref="S4.E12.m1.4.4.3.3.3.3.1.1.1.2.cmml"><mo id="S4.E12.m1.4.4.3.3.3.3.1.1.1.1.2" stretchy="false" xref="S4.E12.m1.4.4.3.3.3.3.1.1.1.2.cmml">(</mo><msub id="S4.E12.m1.4.4.3.3.3.3.1.1.1.1.1" xref="S4.E12.m1.4.4.3.3.3.3.1.1.1.1.1.cmml"><mi id="S4.E12.m1.4.4.3.3.3.3.1.1.1.1.1.2" xref="S4.E12.m1.4.4.3.3.3.3.1.1.1.1.1.2.cmml">π</mi><mi id="S4.E12.m1.4.4.3.3.3.3.1.1.1.1.1.3" xref="S4.E12.m1.4.4.3.3.3.3.1.1.1.1.1.3.cmml">θ</mi></msub><mo id="S4.E12.m1.4.4.3.3.3.3.1.1.1.1.3" xref="S4.E12.m1.4.4.3.3.3.3.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.3.3.2.2.2.2" xref="S4.E12.m1.3.3.2.2.2.2.cmml">𝒟</mi><mo id="S4.E12.m1.4.4.3.3.3.3.1.1.1.1.4" stretchy="false" xref="S4.E12.m1.4.4.3.3.3.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E12.m1.4.4.3.3.3.3.1.3" xref="S4.E12.m1.4.4.3.3.3.3.1.1.cmml">)</mo></mrow></mrow><mover accent="true" id="S4.E12.m1.4.4.3.5" xref="S4.E12.m1.4.4.3.5.cmml"><mi id="S4.E12.m1.4.4.3.5.2" xref="S4.E12.m1.4.4.3.5.2.cmml">N</mi><mo id="S4.E12.m1.4.4.3.5.1" xref="S4.E12.m1.4.4.3.5.1.cmml">~</mo></mover></mfrac></msqrt></mrow></mrow><mo id="S4.E12.m1.6.6.1.2" lspace="0em" xref="S4.E12.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.6b"><apply id="S4.E12.m1.6.6.1.1.cmml" xref="S4.E12.m1.6.6.1"><csymbol cd="latexml" id="S4.E12.m1.6.6.1.1.3.cmml" xref="S4.E12.m1.6.6.1.1.3">plus-or-minus</csymbol><apply id="S4.E12.m1.6.6.1.1.1.cmml" xref="S4.E12.m1.6.6.1.1.1"><times id="S4.E12.m1.6.6.1.1.1.2.cmml" xref="S4.E12.m1.6.6.1.1.1.2"></times><apply id="S4.E12.m1.6.6.1.1.1.3.cmml" xref="S4.E12.m1.6.6.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.6.6.1.1.1.3.1.cmml" xref="S4.E12.m1.6.6.1.1.1.3">subscript</csymbol><apply id="S4.E12.m1.6.6.1.1.1.3.2.cmml" xref="S4.E12.m1.6.6.1.1.1.3.2"><ci id="S4.E12.m1.6.6.1.1.1.3.2.1.cmml" xref="S4.E12.m1.6.6.1.1.1.3.2.1">^</ci><ci id="S4.E12.m1.6.6.1.1.1.3.2.2.cmml" xref="S4.E12.m1.6.6.1.1.1.3.2.2">𝑉</ci></apply><apply id="S4.E12.m1.1.1.1.cmml" xref="S4.E12.m1.1.1.1"><times id="S4.E12.m1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.2"></times><ci id="S4.E12.m1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1">SN</ci><ci id="S4.E12.m1.1.1.1.4.cmml" xref="S4.E12.m1.1.1.1.4">IPS</ci></apply></apply><interval closure="open" id="S4.E12.m1.6.6.1.1.1.1.2.cmml" xref="S4.E12.m1.6.6.1.1.1.1.1"><apply id="S4.E12.m1.6.6.1.1.1.1.1.1.cmml" xref="S4.E12.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.6.6.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E12.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.6.6.1.1.1.1.1.1.2">𝜋</ci><ci id="S4.E12.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S4.E12.m1.6.6.1.1.1.1.1.1.3">𝜃</ci></apply><ci id="S4.E12.m1.5.5.cmml" xref="S4.E12.m1.5.5">𝒟</ci></interval></apply><apply id="S4.E12.m1.6.6.1.1.2.cmml" xref="S4.E12.m1.6.6.1.1.2"><times id="S4.E12.m1.6.6.1.1.2.2.cmml" xref="S4.E12.m1.6.6.1.1.2.2"></times><apply id="S4.E12.m1.6.6.1.1.2.3.cmml" xref="S4.E12.m1.6.6.1.1.2.3"><csymbol cd="ambiguous" id="S4.E12.m1.6.6.1.1.2.3.1.cmml" xref="S4.E12.m1.6.6.1.1.2.3">superscript</csymbol><ci id="S4.E12.m1.6.6.1.1.2.3.2.cmml" xref="S4.E12.m1.6.6.1.1.2.3.2">Φ</ci><apply id="S4.E12.m1.6.6.1.1.2.3.3.cmml" xref="S4.E12.m1.6.6.1.1.2.3.3"><minus id="S4.E12.m1.6.6.1.1.2.3.3.1.cmml" xref="S4.E12.m1.6.6.1.1.2.3.3"></minus><cn id="S4.E12.m1.6.6.1.1.2.3.3.2.cmml" type="integer" xref="S4.E12.m1.6.6.1.1.2.3.3.2">1</cn></apply></apply><apply id="S4.E12.m1.6.6.1.1.2.1.1.1.cmml" xref="S4.E12.m1.6.6.1.1.2.1.1"><minus id="S4.E12.m1.6.6.1.1.2.1.1.1.1.cmml" xref="S4.E12.m1.6.6.1.1.2.1.1.1.1"></minus><cn id="S4.E12.m1.6.6.1.1.2.1.1.1.2.cmml" type="integer" xref="S4.E12.m1.6.6.1.1.2.1.1.1.2">1</cn><apply id="S4.E12.m1.6.6.1.1.2.1.1.1.3.cmml" xref="S4.E12.m1.6.6.1.1.2.1.1.1.3"><divide id="S4.E12.m1.6.6.1.1.2.1.1.1.3.1.cmml" xref="S4.E12.m1.6.6.1.1.2.1.1.1.3"></divide><ci id="S4.E12.m1.6.6.1.1.2.1.1.1.3.2.cmml" xref="S4.E12.m1.6.6.1.1.2.1.1.1.3.2">𝛼</ci><cn id="S4.E12.m1.6.6.1.1.2.1.1.1.3.3.cmml" type="integer" xref="S4.E12.m1.6.6.1.1.2.1.1.1.3.3">2</cn></apply></apply><apply id="S4.E12.m1.4.4.cmml" xref="S4.E12.m1.4.4"><root id="S4.E12.m1.4.4a.cmml" xref="S4.E12.m1.4.4"></root><apply id="S4.E12.m1.4.4.3.cmml" xref="S4.E12.m1.4.4.3"><divide id="S4.E12.m1.4.4.3.4.cmml" xref="S4.E12.m1.4.4.3"></divide><apply id="S4.E12.m1.4.4.3.3.3.cmml" xref="S4.E12.m1.4.4.3.3.3"><times id="S4.E12.m1.4.4.3.3.3.4.cmml" xref="S4.E12.m1.4.4.3.3.3.4"></times><apply id="S4.E12.m1.4.4.3.3.3.5.cmml" xref="S4.E12.m1.4.4.3.3.3.5"><ci id="S4.E12.m1.4.4.3.3.3.5.1.cmml" xref="S4.E12.m1.4.4.3.3.3.5.1">^</ci><apply id="S4.E12.m1.4.4.3.3.3.5.2.cmml" xref="S4.E12.m1.4.4.3.3.3.5.2"><csymbol cd="ambiguous" id="S4.E12.m1.4.4.3.3.3.5.2.1.cmml" xref="S4.E12.m1.4.4.3.3.3.5.2">subscript</csymbol><ci id="S4.E12.m1.4.4.3.3.3.5.2.2.cmml" xref="S4.E12.m1.4.4.3.3.3.5.2.2">Var</ci><ci id="S4.E12.m1.4.4.3.3.3.5.2.3.cmml" xref="S4.E12.m1.4.4.3.3.3.5.2.3">ESS</ci></apply></apply><apply id="S4.E12.m1.4.4.3.3.3.3.1.1.cmml" xref="S4.E12.m1.4.4.3.3.3.3.1"><times id="S4.E12.m1.4.4.3.3.3.3.1.1.2.cmml" xref="S4.E12.m1.4.4.3.3.3.3.1.1.2"></times><apply id="S4.E12.m1.4.4.3.3.3.3.1.1.3.cmml" xref="S4.E12.m1.4.4.3.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.4.4.3.3.3.3.1.1.3.1.cmml" xref="S4.E12.m1.4.4.3.3.3.3.1.1.3">subscript</csymbol><apply id="S4.E12.m1.4.4.3.3.3.3.1.1.3.2.cmml" xref="S4.E12.m1.4.4.3.3.3.3.1.1.3.2"><ci id="S4.E12.m1.4.4.3.3.3.3.1.1.3.2.1.cmml" xref="S4.E12.m1.4.4.3.3.3.3.1.1.3.2.1">^</ci><ci id="S4.E12.m1.4.4.3.3.3.3.1.1.3.2.2.cmml" xref="S4.E12.m1.4.4.3.3.3.3.1.1.3.2.2">𝑉</ci></apply><apply id="S4.E12.m1.2.2.1.1.1.1.1.cmml" xref="S4.E12.m1.2.2.1.1.1.1.1"><times id="S4.E12.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.E12.m1.2.2.1.1.1.1.1.2"></times><ci id="S4.E12.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E12.m1.2.2.1.1.1.1.1.1">SN</ci><ci id="S4.E12.m1.2.2.1.1.1.1.1.4.cmml" xref="S4.E12.m1.2.2.1.1.1.1.1.4">IPS</ci></apply></apply><interval closure="open" id="S4.E12.m1.4.4.3.3.3.3.1.1.1.2.cmml" xref="S4.E12.m1.4.4.3.3.3.3.1.1.1.1"><apply id="S4.E12.m1.4.4.3.3.3.3.1.1.1.1.1.cmml" xref="S4.E12.m1.4.4.3.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.4.4.3.3.3.3.1.1.1.1.1.1.cmml" xref="S4.E12.m1.4.4.3.3.3.3.1.1.1.1.1">subscript</csymbol><ci id="S4.E12.m1.4.4.3.3.3.3.1.1.1.1.1.2.cmml" xref="S4.E12.m1.4.4.3.3.3.3.1.1.1.1.1.2">𝜋</ci><ci id="S4.E12.m1.4.4.3.3.3.3.1.1.1.1.1.3.cmml" xref="S4.E12.m1.4.4.3.3.3.3.1.1.1.1.1.3">𝜃</ci></apply><ci id="S4.E12.m1.3.3.2.2.2.2.cmml" xref="S4.E12.m1.3.3.2.2.2.2">𝒟</ci></interval></apply></apply><apply id="S4.E12.m1.4.4.3.5.cmml" xref="S4.E12.m1.4.4.3.5"><ci id="S4.E12.m1.4.4.3.5.1.cmml" xref="S4.E12.m1.4.4.3.5.1">~</ci><ci id="S4.E12.m1.4.4.3.5.2.cmml" xref="S4.E12.m1.4.4.3.5.2">𝑁</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.6c">\widehat{V}_{\rm(SN)IPS}(\pi_{\theta},\mathcal{D})\pm\Phi^{-1}\left(1-\frac{%
\alpha}{2}\right)\sqrt{\frac{\widehat{\rm Var_{ESS}}\left(\widehat{V}_{\rm(SN)%
IPS}(\pi_{\theta},\mathcal{D})\right)}{\widetilde{N}}}.</annotation><annotation encoding="application/x-llamapun" id="S4.E12.m1.6d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT ( roman_SN ) roman_IPS end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT , caligraphic_D ) ± roman_Φ start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( 1 - divide start_ARG italic_α end_ARG start_ARG 2 end_ARG ) square-root start_ARG divide start_ARG over^ start_ARG roman_Var start_POSTSUBSCRIPT roman_ESS end_POSTSUBSCRIPT end_ARG ( over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT ( roman_SN ) roman_IPS end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT , caligraphic_D ) ) end_ARG start_ARG over~ start_ARG italic_N end_ARG end_ARG end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p3.6">Naturally, <math alttext="\Phi^{-1}" class="ltx_Math" display="inline" id="S4.SS1.p3.4.m1.1"><semantics id="S4.SS1.p3.4.m1.1a"><msup id="S4.SS1.p3.4.m1.1.1" xref="S4.SS1.p3.4.m1.1.1.cmml"><mi id="S4.SS1.p3.4.m1.1.1.2" mathvariant="normal" xref="S4.SS1.p3.4.m1.1.1.2.cmml">Φ</mi><mrow id="S4.SS1.p3.4.m1.1.1.3" xref="S4.SS1.p3.4.m1.1.1.3.cmml"><mo id="S4.SS1.p3.4.m1.1.1.3a" xref="S4.SS1.p3.4.m1.1.1.3.cmml">−</mo><mn id="S4.SS1.p3.4.m1.1.1.3.2" xref="S4.SS1.p3.4.m1.1.1.3.2.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m1.1b"><apply id="S4.SS1.p3.4.m1.1.1.cmml" xref="S4.SS1.p3.4.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m1.1.1.1.cmml" xref="S4.SS1.p3.4.m1.1.1">superscript</csymbol><ci id="S4.SS1.p3.4.m1.1.1.2.cmml" xref="S4.SS1.p3.4.m1.1.1.2">Φ</ci><apply id="S4.SS1.p3.4.m1.1.1.3.cmml" xref="S4.SS1.p3.4.m1.1.1.3"><minus id="S4.SS1.p3.4.m1.1.1.3.1.cmml" xref="S4.SS1.p3.4.m1.1.1.3"></minus><cn id="S4.SS1.p3.4.m1.1.1.3.2.cmml" type="integer" xref="S4.SS1.p3.4.m1.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m1.1c">\Phi^{-1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.4.m1.1d">roman_Φ start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT</annotation></semantics></math> represents the quantile function of a standard normal distribution, such that the multiplicative factor roughly equals <math alttext="1.96" class="ltx_Math" display="inline" id="S4.SS1.p3.5.m2.1"><semantics id="S4.SS1.p3.5.m2.1a"><mn id="S4.SS1.p3.5.m2.1.1" xref="S4.SS1.p3.5.m2.1.1.cmml">1.96</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m2.1b"><cn id="S4.SS1.p3.5.m2.1.1.cmml" type="float" xref="S4.SS1.p3.5.m2.1.1">1.96</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m2.1c">1.96</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.5.m2.1d">1.96</annotation></semantics></math> when <math alttext="\alpha=0.05" class="ltx_Math" display="inline" id="S4.SS1.p3.6.m3.1"><semantics id="S4.SS1.p3.6.m3.1a"><mrow id="S4.SS1.p3.6.m3.1.1" xref="S4.SS1.p3.6.m3.1.1.cmml"><mi id="S4.SS1.p3.6.m3.1.1.2" xref="S4.SS1.p3.6.m3.1.1.2.cmml">α</mi><mo id="S4.SS1.p3.6.m3.1.1.1" xref="S4.SS1.p3.6.m3.1.1.1.cmml">=</mo><mn id="S4.SS1.p3.6.m3.1.1.3" xref="S4.SS1.p3.6.m3.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m3.1b"><apply id="S4.SS1.p3.6.m3.1.1.cmml" xref="S4.SS1.p3.6.m3.1.1"><eq id="S4.SS1.p3.6.m3.1.1.1.cmml" xref="S4.SS1.p3.6.m3.1.1.1"></eq><ci id="S4.SS1.p3.6.m3.1.1.2.cmml" xref="S4.SS1.p3.6.m3.1.1.2">𝛼</ci><cn id="S4.SS1.p3.6.m3.1.1.3.cmml" type="float" xref="S4.SS1.p3.6.m3.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m3.1c">\alpha=0.05</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.6.m3.1d">italic_α = 0.05</annotation></semantics></math> to obtain standard 95% confidence intervals.</p>
</div>
<div class="ltx_para" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.1">This yields a robust lower bound on the value of the policy that we wish to maximise.
We expect the ESS correction to appropriately inflate the width of the confidence interval when the ESS is low, and the CLT is thus unlikely to hold, improving the estimators’ empirical coverage in low sample-size scenarios.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Estimating the Effective Sample Size</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.7">A widespread estimator for the ESS is given by <cite class="ltx_cite ltx_citemacro_citep">(Owen, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib52" title="">2013</a>, Eq. 9.13)</cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(13)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="P^{2}_{N}=\frac{1}{\sum_{i}\overline{w}^{2}_{i}},\text{~{}where~{}}\overline{w%
}_{i}=\frac{w_{i}}{\sum\limits_{(a_{j},r_{j})\in\mathcal{D}}w_{j}}=\frac{\frac%
{\pi_{\theta}(a_{i})}{\pi_{0}(a_{i})}}{\sum\limits_{(a_{j},r_{j})\in\mathcal{D%
}}\frac{\pi_{\theta}(a_{j})}{\pi_{0}(a_{j})}}." class="ltx_Math" display="block" id="S4.E13.m1.9"><semantics id="S4.E13.m1.9a"><mrow id="S4.E13.m1.9.9.1"><mrow id="S4.E13.m1.9.9.1.1.2" xref="S4.E13.m1.9.9.1.1.3.cmml"><mrow id="S4.E13.m1.9.9.1.1.1.1" xref="S4.E13.m1.9.9.1.1.1.1.cmml"><msubsup id="S4.E13.m1.9.9.1.1.1.1.2" xref="S4.E13.m1.9.9.1.1.1.1.2.cmml"><mi id="S4.E13.m1.9.9.1.1.1.1.2.2.2" xref="S4.E13.m1.9.9.1.1.1.1.2.2.2.cmml">P</mi><mi id="S4.E13.m1.9.9.1.1.1.1.2.3" xref="S4.E13.m1.9.9.1.1.1.1.2.3.cmml">N</mi><mn id="S4.E13.m1.9.9.1.1.1.1.2.2.3" xref="S4.E13.m1.9.9.1.1.1.1.2.2.3.cmml">2</mn></msubsup><mo id="S4.E13.m1.9.9.1.1.1.1.1" xref="S4.E13.m1.9.9.1.1.1.1.1.cmml">=</mo><mfrac id="S4.E13.m1.9.9.1.1.1.1.3" xref="S4.E13.m1.9.9.1.1.1.1.3.cmml"><mn id="S4.E13.m1.9.9.1.1.1.1.3.2" xref="S4.E13.m1.9.9.1.1.1.1.3.2.cmml">1</mn><mrow id="S4.E13.m1.9.9.1.1.1.1.3.3" xref="S4.E13.m1.9.9.1.1.1.1.3.3.cmml"><msub id="S4.E13.m1.9.9.1.1.1.1.3.3.1" xref="S4.E13.m1.9.9.1.1.1.1.3.3.1.cmml"><mo id="S4.E13.m1.9.9.1.1.1.1.3.3.1.2" xref="S4.E13.m1.9.9.1.1.1.1.3.3.1.2.cmml">∑</mo><mi id="S4.E13.m1.9.9.1.1.1.1.3.3.1.3" xref="S4.E13.m1.9.9.1.1.1.1.3.3.1.3.cmml">i</mi></msub><msubsup id="S4.E13.m1.9.9.1.1.1.1.3.3.2" xref="S4.E13.m1.9.9.1.1.1.1.3.3.2.cmml"><mover accent="true" id="S4.E13.m1.9.9.1.1.1.1.3.3.2.2.2" xref="S4.E13.m1.9.9.1.1.1.1.3.3.2.2.2.cmml"><mi id="S4.E13.m1.9.9.1.1.1.1.3.3.2.2.2.2" xref="S4.E13.m1.9.9.1.1.1.1.3.3.2.2.2.2.cmml">w</mi><mo id="S4.E13.m1.9.9.1.1.1.1.3.3.2.2.2.1" xref="S4.E13.m1.9.9.1.1.1.1.3.3.2.2.2.1.cmml">¯</mo></mover><mi id="S4.E13.m1.9.9.1.1.1.1.3.3.2.3" xref="S4.E13.m1.9.9.1.1.1.1.3.3.2.3.cmml">i</mi><mn id="S4.E13.m1.9.9.1.1.1.1.3.3.2.2.3" xref="S4.E13.m1.9.9.1.1.1.1.3.3.2.2.3.cmml">2</mn></msubsup></mrow></mfrac></mrow><mo id="S4.E13.m1.9.9.1.1.2.3" xref="S4.E13.m1.9.9.1.1.3a.cmml">,</mo><mrow id="S4.E13.m1.9.9.1.1.2.2" xref="S4.E13.m1.9.9.1.1.2.2.cmml"><mrow id="S4.E13.m1.9.9.1.1.2.2.2" xref="S4.E13.m1.9.9.1.1.2.2.2.cmml"><mtext id="S4.E13.m1.9.9.1.1.2.2.2.2" xref="S4.E13.m1.9.9.1.1.2.2.2.2a.cmml"> where </mtext><mo id="S4.E13.m1.9.9.1.1.2.2.2.1" xref="S4.E13.m1.9.9.1.1.2.2.2.1.cmml">⁢</mo><msub id="S4.E13.m1.9.9.1.1.2.2.2.3" xref="S4.E13.m1.9.9.1.1.2.2.2.3.cmml"><mover accent="true" id="S4.E13.m1.9.9.1.1.2.2.2.3.2" xref="S4.E13.m1.9.9.1.1.2.2.2.3.2.cmml"><mi id="S4.E13.m1.9.9.1.1.2.2.2.3.2.2" xref="S4.E13.m1.9.9.1.1.2.2.2.3.2.2.cmml">w</mi><mo id="S4.E13.m1.9.9.1.1.2.2.2.3.2.1" xref="S4.E13.m1.9.9.1.1.2.2.2.3.2.1.cmml">¯</mo></mover><mi id="S4.E13.m1.9.9.1.1.2.2.2.3.3" xref="S4.E13.m1.9.9.1.1.2.2.2.3.3.cmml">i</mi></msub></mrow><mo id="S4.E13.m1.9.9.1.1.2.2.3" xref="S4.E13.m1.9.9.1.1.2.2.3.cmml">=</mo><mfrac id="S4.E13.m1.2.2" xref="S4.E13.m1.2.2.cmml"><msub id="S4.E13.m1.2.2.4" xref="S4.E13.m1.2.2.4.cmml"><mi id="S4.E13.m1.2.2.4.2" xref="S4.E13.m1.2.2.4.2.cmml">w</mi><mi id="S4.E13.m1.2.2.4.3" xref="S4.E13.m1.2.2.4.3.cmml">i</mi></msub><mrow id="S4.E13.m1.2.2.2" xref="S4.E13.m1.2.2.2.cmml"><munder id="S4.E13.m1.2.2.2.3" xref="S4.E13.m1.2.2.2.3.cmml"><mo id="S4.E13.m1.2.2.2.3.2" movablelimits="false" xref="S4.E13.m1.2.2.2.3.2.cmml">∑</mo><mrow id="S4.E13.m1.2.2.2.2.2" xref="S4.E13.m1.2.2.2.2.2.cmml"><mrow id="S4.E13.m1.2.2.2.2.2.2.2" xref="S4.E13.m1.2.2.2.2.2.2.3.cmml"><mo id="S4.E13.m1.2.2.2.2.2.2.2.3" stretchy="false" xref="S4.E13.m1.2.2.2.2.2.2.3.cmml">(</mo><msub id="S4.E13.m1.1.1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E13.m1.1.1.1.1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.1.1.1.1.2.cmml">a</mi><mi id="S4.E13.m1.1.1.1.1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S4.E13.m1.2.2.2.2.2.2.2.4" xref="S4.E13.m1.2.2.2.2.2.2.3.cmml">,</mo><msub id="S4.E13.m1.2.2.2.2.2.2.2.2" xref="S4.E13.m1.2.2.2.2.2.2.2.2.cmml"><mi id="S4.E13.m1.2.2.2.2.2.2.2.2.2" xref="S4.E13.m1.2.2.2.2.2.2.2.2.2.cmml">r</mi><mi id="S4.E13.m1.2.2.2.2.2.2.2.2.3" xref="S4.E13.m1.2.2.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S4.E13.m1.2.2.2.2.2.2.2.5" stretchy="false" xref="S4.E13.m1.2.2.2.2.2.2.3.cmml">)</mo></mrow><mo id="S4.E13.m1.2.2.2.2.2.3" xref="S4.E13.m1.2.2.2.2.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E13.m1.2.2.2.2.2.4" xref="S4.E13.m1.2.2.2.2.2.4.cmml">𝒟</mi></mrow></munder><msub id="S4.E13.m1.2.2.2.4" xref="S4.E13.m1.2.2.2.4.cmml"><mi id="S4.E13.m1.2.2.2.4.2" xref="S4.E13.m1.2.2.2.4.2.cmml">w</mi><mi id="S4.E13.m1.2.2.2.4.3" xref="S4.E13.m1.2.2.2.4.3.cmml">j</mi></msub></mrow></mfrac><mo id="S4.E13.m1.9.9.1.1.2.2.4" xref="S4.E13.m1.9.9.1.1.2.2.4.cmml">=</mo><mfrac id="S4.E13.m1.8.8" xref="S4.E13.m1.8.8.cmml"><mfrac id="S4.E13.m1.4.4.2" xref="S4.E13.m1.4.4.2.cmml"><mrow id="S4.E13.m1.3.3.1.1.1" xref="S4.E13.m1.3.3.1.1.1.cmml"><msub id="S4.E13.m1.3.3.1.1.1.3" xref="S4.E13.m1.3.3.1.1.1.3.cmml"><mi id="S4.E13.m1.3.3.1.1.1.3.2" xref="S4.E13.m1.3.3.1.1.1.3.2.cmml">π</mi><mi id="S4.E13.m1.3.3.1.1.1.3.3" xref="S4.E13.m1.3.3.1.1.1.3.3.cmml">θ</mi></msub><mo id="S4.E13.m1.3.3.1.1.1.2" xref="S4.E13.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.E13.m1.3.3.1.1.1.1.1" xref="S4.E13.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S4.E13.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S4.E13.m1.3.3.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E13.m1.3.3.1.1.1.1.1.1" xref="S4.E13.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E13.m1.3.3.1.1.1.1.1.1.2" xref="S4.E13.m1.3.3.1.1.1.1.1.1.2.cmml">a</mi><mi id="S4.E13.m1.3.3.1.1.1.1.1.1.3" xref="S4.E13.m1.3.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E13.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S4.E13.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.E13.m1.4.4.2.2.2" xref="S4.E13.m1.4.4.2.2.2.cmml"><msub id="S4.E13.m1.4.4.2.2.2.3" xref="S4.E13.m1.4.4.2.2.2.3.cmml"><mi id="S4.E13.m1.4.4.2.2.2.3.2" xref="S4.E13.m1.4.4.2.2.2.3.2.cmml">π</mi><mn id="S4.E13.m1.4.4.2.2.2.3.3" xref="S4.E13.m1.4.4.2.2.2.3.3.cmml">0</mn></msub><mo id="S4.E13.m1.4.4.2.2.2.2" xref="S4.E13.m1.4.4.2.2.2.2.cmml">⁢</mo><mrow id="S4.E13.m1.4.4.2.2.2.1.1" xref="S4.E13.m1.4.4.2.2.2.1.1.1.cmml"><mo id="S4.E13.m1.4.4.2.2.2.1.1.2" stretchy="false" xref="S4.E13.m1.4.4.2.2.2.1.1.1.cmml">(</mo><msub id="S4.E13.m1.4.4.2.2.2.1.1.1" xref="S4.E13.m1.4.4.2.2.2.1.1.1.cmml"><mi id="S4.E13.m1.4.4.2.2.2.1.1.1.2" xref="S4.E13.m1.4.4.2.2.2.1.1.1.2.cmml">a</mi><mi id="S4.E13.m1.4.4.2.2.2.1.1.1.3" xref="S4.E13.m1.4.4.2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S4.E13.m1.4.4.2.2.2.1.1.3" stretchy="false" xref="S4.E13.m1.4.4.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mrow id="S4.E13.m1.8.8.6" xref="S4.E13.m1.8.8.6.cmml"><munder id="S4.E13.m1.8.8.6.5" xref="S4.E13.m1.8.8.6.5.cmml"><mo id="S4.E13.m1.8.8.6.5.2" movablelimits="false" xref="S4.E13.m1.8.8.6.5.2.cmml">∑</mo><mrow id="S4.E13.m1.6.6.4.2.2" xref="S4.E13.m1.6.6.4.2.2.cmml"><mrow id="S4.E13.m1.6.6.4.2.2.2.2" xref="S4.E13.m1.6.6.4.2.2.2.3.cmml"><mo id="S4.E13.m1.6.6.4.2.2.2.2.3" stretchy="false" xref="S4.E13.m1.6.6.4.2.2.2.3.cmml">(</mo><msub id="S4.E13.m1.5.5.3.1.1.1.1.1" xref="S4.E13.m1.5.5.3.1.1.1.1.1.cmml"><mi id="S4.E13.m1.5.5.3.1.1.1.1.1.2" xref="S4.E13.m1.5.5.3.1.1.1.1.1.2.cmml">a</mi><mi id="S4.E13.m1.5.5.3.1.1.1.1.1.3" xref="S4.E13.m1.5.5.3.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S4.E13.m1.6.6.4.2.2.2.2.4" xref="S4.E13.m1.6.6.4.2.2.2.3.cmml">,</mo><msub id="S4.E13.m1.6.6.4.2.2.2.2.2" xref="S4.E13.m1.6.6.4.2.2.2.2.2.cmml"><mi id="S4.E13.m1.6.6.4.2.2.2.2.2.2" xref="S4.E13.m1.6.6.4.2.2.2.2.2.2.cmml">r</mi><mi id="S4.E13.m1.6.6.4.2.2.2.2.2.3" xref="S4.E13.m1.6.6.4.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S4.E13.m1.6.6.4.2.2.2.2.5" stretchy="false" xref="S4.E13.m1.6.6.4.2.2.2.3.cmml">)</mo></mrow><mo id="S4.E13.m1.6.6.4.2.2.3" xref="S4.E13.m1.6.6.4.2.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E13.m1.6.6.4.2.2.4" xref="S4.E13.m1.6.6.4.2.2.4.cmml">𝒟</mi></mrow></munder><mfrac id="S4.E13.m1.8.8.6.4" xref="S4.E13.m1.8.8.6.4.cmml"><mrow id="S4.E13.m1.7.7.5.3.1" xref="S4.E13.m1.7.7.5.3.1.cmml"><msub id="S4.E13.m1.7.7.5.3.1.3" xref="S4.E13.m1.7.7.5.3.1.3.cmml"><mi id="S4.E13.m1.7.7.5.3.1.3.2" xref="S4.E13.m1.7.7.5.3.1.3.2.cmml">π</mi><mi id="S4.E13.m1.7.7.5.3.1.3.3" xref="S4.E13.m1.7.7.5.3.1.3.3.cmml">θ</mi></msub><mo id="S4.E13.m1.7.7.5.3.1.2" xref="S4.E13.m1.7.7.5.3.1.2.cmml">⁢</mo><mrow id="S4.E13.m1.7.7.5.3.1.1.1" xref="S4.E13.m1.7.7.5.3.1.1.1.1.cmml"><mo id="S4.E13.m1.7.7.5.3.1.1.1.2" stretchy="false" xref="S4.E13.m1.7.7.5.3.1.1.1.1.cmml">(</mo><msub id="S4.E13.m1.7.7.5.3.1.1.1.1" xref="S4.E13.m1.7.7.5.3.1.1.1.1.cmml"><mi id="S4.E13.m1.7.7.5.3.1.1.1.1.2" xref="S4.E13.m1.7.7.5.3.1.1.1.1.2.cmml">a</mi><mi id="S4.E13.m1.7.7.5.3.1.1.1.1.3" xref="S4.E13.m1.7.7.5.3.1.1.1.1.3.cmml">j</mi></msub><mo id="S4.E13.m1.7.7.5.3.1.1.1.3" stretchy="false" xref="S4.E13.m1.7.7.5.3.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.E13.m1.8.8.6.4.2" xref="S4.E13.m1.8.8.6.4.2.cmml"><msub id="S4.E13.m1.8.8.6.4.2.3" xref="S4.E13.m1.8.8.6.4.2.3.cmml"><mi id="S4.E13.m1.8.8.6.4.2.3.2" xref="S4.E13.m1.8.8.6.4.2.3.2.cmml">π</mi><mn id="S4.E13.m1.8.8.6.4.2.3.3" xref="S4.E13.m1.8.8.6.4.2.3.3.cmml">0</mn></msub><mo id="S4.E13.m1.8.8.6.4.2.2" xref="S4.E13.m1.8.8.6.4.2.2.cmml">⁢</mo><mrow id="S4.E13.m1.8.8.6.4.2.1.1" xref="S4.E13.m1.8.8.6.4.2.1.1.1.cmml"><mo id="S4.E13.m1.8.8.6.4.2.1.1.2" stretchy="false" xref="S4.E13.m1.8.8.6.4.2.1.1.1.cmml">(</mo><msub id="S4.E13.m1.8.8.6.4.2.1.1.1" xref="S4.E13.m1.8.8.6.4.2.1.1.1.cmml"><mi id="S4.E13.m1.8.8.6.4.2.1.1.1.2" xref="S4.E13.m1.8.8.6.4.2.1.1.1.2.cmml">a</mi><mi id="S4.E13.m1.8.8.6.4.2.1.1.1.3" xref="S4.E13.m1.8.8.6.4.2.1.1.1.3.cmml">j</mi></msub><mo id="S4.E13.m1.8.8.6.4.2.1.1.3" stretchy="false" xref="S4.E13.m1.8.8.6.4.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mfrac></mrow></mrow><mo id="S4.E13.m1.9.9.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m1.9b"><apply id="S4.E13.m1.9.9.1.1.3.cmml" xref="S4.E13.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="S4.E13.m1.9.9.1.1.3a.cmml" xref="S4.E13.m1.9.9.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E13.m1.9.9.1.1.1.1.cmml" xref="S4.E13.m1.9.9.1.1.1.1"><eq id="S4.E13.m1.9.9.1.1.1.1.1.cmml" xref="S4.E13.m1.9.9.1.1.1.1.1"></eq><apply id="S4.E13.m1.9.9.1.1.1.1.2.cmml" xref="S4.E13.m1.9.9.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E13.m1.9.9.1.1.1.1.2.1.cmml" xref="S4.E13.m1.9.9.1.1.1.1.2">subscript</csymbol><apply id="S4.E13.m1.9.9.1.1.1.1.2.2.cmml" xref="S4.E13.m1.9.9.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E13.m1.9.9.1.1.1.1.2.2.1.cmml" xref="S4.E13.m1.9.9.1.1.1.1.2">superscript</csymbol><ci id="S4.E13.m1.9.9.1.1.1.1.2.2.2.cmml" xref="S4.E13.m1.9.9.1.1.1.1.2.2.2">𝑃</ci><cn id="S4.E13.m1.9.9.1.1.1.1.2.2.3.cmml" type="integer" xref="S4.E13.m1.9.9.1.1.1.1.2.2.3">2</cn></apply><ci id="S4.E13.m1.9.9.1.1.1.1.2.3.cmml" xref="S4.E13.m1.9.9.1.1.1.1.2.3">𝑁</ci></apply><apply id="S4.E13.m1.9.9.1.1.1.1.3.cmml" xref="S4.E13.m1.9.9.1.1.1.1.3"><divide id="S4.E13.m1.9.9.1.1.1.1.3.1.cmml" xref="S4.E13.m1.9.9.1.1.1.1.3"></divide><cn id="S4.E13.m1.9.9.1.1.1.1.3.2.cmml" type="integer" xref="S4.E13.m1.9.9.1.1.1.1.3.2">1</cn><apply id="S4.E13.m1.9.9.1.1.1.1.3.3.cmml" xref="S4.E13.m1.9.9.1.1.1.1.3.3"><apply id="S4.E13.m1.9.9.1.1.1.1.3.3.1.cmml" xref="S4.E13.m1.9.9.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S4.E13.m1.9.9.1.1.1.1.3.3.1.1.cmml" xref="S4.E13.m1.9.9.1.1.1.1.3.3.1">subscript</csymbol><sum id="S4.E13.m1.9.9.1.1.1.1.3.3.1.2.cmml" xref="S4.E13.m1.9.9.1.1.1.1.3.3.1.2"></sum><ci id="S4.E13.m1.9.9.1.1.1.1.3.3.1.3.cmml" xref="S4.E13.m1.9.9.1.1.1.1.3.3.1.3">𝑖</ci></apply><apply id="S4.E13.m1.9.9.1.1.1.1.3.3.2.cmml" xref="S4.E13.m1.9.9.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E13.m1.9.9.1.1.1.1.3.3.2.1.cmml" xref="S4.E13.m1.9.9.1.1.1.1.3.3.2">subscript</csymbol><apply id="S4.E13.m1.9.9.1.1.1.1.3.3.2.2.cmml" xref="S4.E13.m1.9.9.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E13.m1.9.9.1.1.1.1.3.3.2.2.1.cmml" xref="S4.E13.m1.9.9.1.1.1.1.3.3.2">superscript</csymbol><apply id="S4.E13.m1.9.9.1.1.1.1.3.3.2.2.2.cmml" xref="S4.E13.m1.9.9.1.1.1.1.3.3.2.2.2"><ci id="S4.E13.m1.9.9.1.1.1.1.3.3.2.2.2.1.cmml" xref="S4.E13.m1.9.9.1.1.1.1.3.3.2.2.2.1">¯</ci><ci id="S4.E13.m1.9.9.1.1.1.1.3.3.2.2.2.2.cmml" xref="S4.E13.m1.9.9.1.1.1.1.3.3.2.2.2.2">𝑤</ci></apply><cn id="S4.E13.m1.9.9.1.1.1.1.3.3.2.2.3.cmml" type="integer" xref="S4.E13.m1.9.9.1.1.1.1.3.3.2.2.3">2</cn></apply><ci id="S4.E13.m1.9.9.1.1.1.1.3.3.2.3.cmml" xref="S4.E13.m1.9.9.1.1.1.1.3.3.2.3">𝑖</ci></apply></apply></apply></apply><apply id="S4.E13.m1.9.9.1.1.2.2.cmml" xref="S4.E13.m1.9.9.1.1.2.2"><and id="S4.E13.m1.9.9.1.1.2.2a.cmml" xref="S4.E13.m1.9.9.1.1.2.2"></and><apply id="S4.E13.m1.9.9.1.1.2.2b.cmml" xref="S4.E13.m1.9.9.1.1.2.2"><eq id="S4.E13.m1.9.9.1.1.2.2.3.cmml" xref="S4.E13.m1.9.9.1.1.2.2.3"></eq><apply id="S4.E13.m1.9.9.1.1.2.2.2.cmml" xref="S4.E13.m1.9.9.1.1.2.2.2"><times id="S4.E13.m1.9.9.1.1.2.2.2.1.cmml" xref="S4.E13.m1.9.9.1.1.2.2.2.1"></times><ci id="S4.E13.m1.9.9.1.1.2.2.2.2a.cmml" xref="S4.E13.m1.9.9.1.1.2.2.2.2"><mtext id="S4.E13.m1.9.9.1.1.2.2.2.2.cmml" xref="S4.E13.m1.9.9.1.1.2.2.2.2"> where </mtext></ci><apply id="S4.E13.m1.9.9.1.1.2.2.2.3.cmml" xref="S4.E13.m1.9.9.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E13.m1.9.9.1.1.2.2.2.3.1.cmml" xref="S4.E13.m1.9.9.1.1.2.2.2.3">subscript</csymbol><apply id="S4.E13.m1.9.9.1.1.2.2.2.3.2.cmml" xref="S4.E13.m1.9.9.1.1.2.2.2.3.2"><ci id="S4.E13.m1.9.9.1.1.2.2.2.3.2.1.cmml" xref="S4.E13.m1.9.9.1.1.2.2.2.3.2.1">¯</ci><ci id="S4.E13.m1.9.9.1.1.2.2.2.3.2.2.cmml" xref="S4.E13.m1.9.9.1.1.2.2.2.3.2.2">𝑤</ci></apply><ci id="S4.E13.m1.9.9.1.1.2.2.2.3.3.cmml" xref="S4.E13.m1.9.9.1.1.2.2.2.3.3">𝑖</ci></apply></apply><apply id="S4.E13.m1.2.2.cmml" xref="S4.E13.m1.2.2"><divide id="S4.E13.m1.2.2.3.cmml" xref="S4.E13.m1.2.2"></divide><apply id="S4.E13.m1.2.2.4.cmml" xref="S4.E13.m1.2.2.4"><csymbol cd="ambiguous" id="S4.E13.m1.2.2.4.1.cmml" xref="S4.E13.m1.2.2.4">subscript</csymbol><ci id="S4.E13.m1.2.2.4.2.cmml" xref="S4.E13.m1.2.2.4.2">𝑤</ci><ci id="S4.E13.m1.2.2.4.3.cmml" xref="S4.E13.m1.2.2.4.3">𝑖</ci></apply><apply id="S4.E13.m1.2.2.2.cmml" xref="S4.E13.m1.2.2.2"><apply id="S4.E13.m1.2.2.2.3.cmml" xref="S4.E13.m1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E13.m1.2.2.2.3.1.cmml" xref="S4.E13.m1.2.2.2.3">subscript</csymbol><sum id="S4.E13.m1.2.2.2.3.2.cmml" xref="S4.E13.m1.2.2.2.3.2"></sum><apply id="S4.E13.m1.2.2.2.2.2.cmml" xref="S4.E13.m1.2.2.2.2.2"><in id="S4.E13.m1.2.2.2.2.2.3.cmml" xref="S4.E13.m1.2.2.2.2.2.3"></in><interval closure="open" id="S4.E13.m1.2.2.2.2.2.2.3.cmml" xref="S4.E13.m1.2.2.2.2.2.2.2"><apply id="S4.E13.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.2">𝑎</ci><ci id="S4.E13.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S4.E13.m1.2.2.2.2.2.2.2.2.cmml" xref="S4.E13.m1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E13.m1.2.2.2.2.2.2.2.2.1.cmml" xref="S4.E13.m1.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E13.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S4.E13.m1.2.2.2.2.2.2.2.2.2">𝑟</ci><ci id="S4.E13.m1.2.2.2.2.2.2.2.2.3.cmml" xref="S4.E13.m1.2.2.2.2.2.2.2.2.3">𝑗</ci></apply></interval><ci id="S4.E13.m1.2.2.2.2.2.4.cmml" xref="S4.E13.m1.2.2.2.2.2.4">𝒟</ci></apply></apply><apply id="S4.E13.m1.2.2.2.4.cmml" xref="S4.E13.m1.2.2.2.4"><csymbol cd="ambiguous" id="S4.E13.m1.2.2.2.4.1.cmml" xref="S4.E13.m1.2.2.2.4">subscript</csymbol><ci id="S4.E13.m1.2.2.2.4.2.cmml" xref="S4.E13.m1.2.2.2.4.2">𝑤</ci><ci id="S4.E13.m1.2.2.2.4.3.cmml" xref="S4.E13.m1.2.2.2.4.3">𝑗</ci></apply></apply></apply></apply><apply id="S4.E13.m1.9.9.1.1.2.2c.cmml" xref="S4.E13.m1.9.9.1.1.2.2"><eq id="S4.E13.m1.9.9.1.1.2.2.4.cmml" xref="S4.E13.m1.9.9.1.1.2.2.4"></eq><share href="https://arxiv.org/html/2405.02141v2#S4.E13.m1.2.2.cmml" id="S4.E13.m1.9.9.1.1.2.2d.cmml" xref="S4.E13.m1.9.9.1.1.2.2"></share><apply id="S4.E13.m1.8.8.cmml" xref="S4.E13.m1.8.8"><divide id="S4.E13.m1.8.8.7.cmml" xref="S4.E13.m1.8.8"></divide><apply id="S4.E13.m1.4.4.2.cmml" xref="S4.E13.m1.4.4.2"><divide id="S4.E13.m1.4.4.2.3.cmml" xref="S4.E13.m1.4.4.2"></divide><apply id="S4.E13.m1.3.3.1.1.1.cmml" xref="S4.E13.m1.3.3.1.1.1"><times id="S4.E13.m1.3.3.1.1.1.2.cmml" xref="S4.E13.m1.3.3.1.1.1.2"></times><apply id="S4.E13.m1.3.3.1.1.1.3.cmml" xref="S4.E13.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.3.3.1.1.1.3.1.cmml" xref="S4.E13.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S4.E13.m1.3.3.1.1.1.3.2.cmml" xref="S4.E13.m1.3.3.1.1.1.3.2">𝜋</ci><ci id="S4.E13.m1.3.3.1.1.1.3.3.cmml" xref="S4.E13.m1.3.3.1.1.1.3.3">𝜃</ci></apply><apply id="S4.E13.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S4.E13.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.2">𝑎</ci><ci id="S4.E13.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S4.E13.m1.4.4.2.2.2.cmml" xref="S4.E13.m1.4.4.2.2.2"><times id="S4.E13.m1.4.4.2.2.2.2.cmml" xref="S4.E13.m1.4.4.2.2.2.2"></times><apply id="S4.E13.m1.4.4.2.2.2.3.cmml" xref="S4.E13.m1.4.4.2.2.2.3"><csymbol cd="ambiguous" id="S4.E13.m1.4.4.2.2.2.3.1.cmml" xref="S4.E13.m1.4.4.2.2.2.3">subscript</csymbol><ci id="S4.E13.m1.4.4.2.2.2.3.2.cmml" xref="S4.E13.m1.4.4.2.2.2.3.2">𝜋</ci><cn id="S4.E13.m1.4.4.2.2.2.3.3.cmml" type="integer" xref="S4.E13.m1.4.4.2.2.2.3.3">0</cn></apply><apply id="S4.E13.m1.4.4.2.2.2.1.1.1.cmml" xref="S4.E13.m1.4.4.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.4.4.2.2.2.1.1.1.1.cmml" xref="S4.E13.m1.4.4.2.2.2.1.1">subscript</csymbol><ci id="S4.E13.m1.4.4.2.2.2.1.1.1.2.cmml" xref="S4.E13.m1.4.4.2.2.2.1.1.1.2">𝑎</ci><ci id="S4.E13.m1.4.4.2.2.2.1.1.1.3.cmml" xref="S4.E13.m1.4.4.2.2.2.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S4.E13.m1.8.8.6.cmml" xref="S4.E13.m1.8.8.6"><apply id="S4.E13.m1.8.8.6.5.cmml" xref="S4.E13.m1.8.8.6.5"><csymbol cd="ambiguous" id="S4.E13.m1.8.8.6.5.1.cmml" xref="S4.E13.m1.8.8.6.5">subscript</csymbol><sum id="S4.E13.m1.8.8.6.5.2.cmml" xref="S4.E13.m1.8.8.6.5.2"></sum><apply id="S4.E13.m1.6.6.4.2.2.cmml" xref="S4.E13.m1.6.6.4.2.2"><in id="S4.E13.m1.6.6.4.2.2.3.cmml" xref="S4.E13.m1.6.6.4.2.2.3"></in><interval closure="open" id="S4.E13.m1.6.6.4.2.2.2.3.cmml" xref="S4.E13.m1.6.6.4.2.2.2.2"><apply id="S4.E13.m1.5.5.3.1.1.1.1.1.cmml" xref="S4.E13.m1.5.5.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.5.5.3.1.1.1.1.1.1.cmml" xref="S4.E13.m1.5.5.3.1.1.1.1.1">subscript</csymbol><ci id="S4.E13.m1.5.5.3.1.1.1.1.1.2.cmml" xref="S4.E13.m1.5.5.3.1.1.1.1.1.2">𝑎</ci><ci id="S4.E13.m1.5.5.3.1.1.1.1.1.3.cmml" xref="S4.E13.m1.5.5.3.1.1.1.1.1.3">𝑗</ci></apply><apply id="S4.E13.m1.6.6.4.2.2.2.2.2.cmml" xref="S4.E13.m1.6.6.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E13.m1.6.6.4.2.2.2.2.2.1.cmml" xref="S4.E13.m1.6.6.4.2.2.2.2.2">subscript</csymbol><ci id="S4.E13.m1.6.6.4.2.2.2.2.2.2.cmml" xref="S4.E13.m1.6.6.4.2.2.2.2.2.2">𝑟</ci><ci id="S4.E13.m1.6.6.4.2.2.2.2.2.3.cmml" xref="S4.E13.m1.6.6.4.2.2.2.2.2.3">𝑗</ci></apply></interval><ci id="S4.E13.m1.6.6.4.2.2.4.cmml" xref="S4.E13.m1.6.6.4.2.2.4">𝒟</ci></apply></apply><apply id="S4.E13.m1.8.8.6.4.cmml" xref="S4.E13.m1.8.8.6.4"><divide id="S4.E13.m1.8.8.6.4.3.cmml" xref="S4.E13.m1.8.8.6.4"></divide><apply id="S4.E13.m1.7.7.5.3.1.cmml" xref="S4.E13.m1.7.7.5.3.1"><times id="S4.E13.m1.7.7.5.3.1.2.cmml" xref="S4.E13.m1.7.7.5.3.1.2"></times><apply id="S4.E13.m1.7.7.5.3.1.3.cmml" xref="S4.E13.m1.7.7.5.3.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.7.7.5.3.1.3.1.cmml" xref="S4.E13.m1.7.7.5.3.1.3">subscript</csymbol><ci id="S4.E13.m1.7.7.5.3.1.3.2.cmml" xref="S4.E13.m1.7.7.5.3.1.3.2">𝜋</ci><ci id="S4.E13.m1.7.7.5.3.1.3.3.cmml" xref="S4.E13.m1.7.7.5.3.1.3.3">𝜃</ci></apply><apply id="S4.E13.m1.7.7.5.3.1.1.1.1.cmml" xref="S4.E13.m1.7.7.5.3.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.7.7.5.3.1.1.1.1.1.cmml" xref="S4.E13.m1.7.7.5.3.1.1.1">subscript</csymbol><ci id="S4.E13.m1.7.7.5.3.1.1.1.1.2.cmml" xref="S4.E13.m1.7.7.5.3.1.1.1.1.2">𝑎</ci><ci id="S4.E13.m1.7.7.5.3.1.1.1.1.3.cmml" xref="S4.E13.m1.7.7.5.3.1.1.1.1.3">𝑗</ci></apply></apply><apply id="S4.E13.m1.8.8.6.4.2.cmml" xref="S4.E13.m1.8.8.6.4.2"><times id="S4.E13.m1.8.8.6.4.2.2.cmml" xref="S4.E13.m1.8.8.6.4.2.2"></times><apply id="S4.E13.m1.8.8.6.4.2.3.cmml" xref="S4.E13.m1.8.8.6.4.2.3"><csymbol cd="ambiguous" id="S4.E13.m1.8.8.6.4.2.3.1.cmml" xref="S4.E13.m1.8.8.6.4.2.3">subscript</csymbol><ci id="S4.E13.m1.8.8.6.4.2.3.2.cmml" xref="S4.E13.m1.8.8.6.4.2.3.2">𝜋</ci><cn id="S4.E13.m1.8.8.6.4.2.3.3.cmml" type="integer" xref="S4.E13.m1.8.8.6.4.2.3.3">0</cn></apply><apply id="S4.E13.m1.8.8.6.4.2.1.1.1.cmml" xref="S4.E13.m1.8.8.6.4.2.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.8.8.6.4.2.1.1.1.1.cmml" xref="S4.E13.m1.8.8.6.4.2.1.1">subscript</csymbol><ci id="S4.E13.m1.8.8.6.4.2.1.1.1.2.cmml" xref="S4.E13.m1.8.8.6.4.2.1.1.1.2">𝑎</ci><ci id="S4.E13.m1.8.8.6.4.2.1.1.1.3.cmml" xref="S4.E13.m1.8.8.6.4.2.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.9c">P^{2}_{N}=\frac{1}{\sum_{i}\overline{w}^{2}_{i}},\text{~{}where~{}}\overline{w%
}_{i}=\frac{w_{i}}{\sum\limits_{(a_{j},r_{j})\in\mathcal{D}}w_{j}}=\frac{\frac%
{\pi_{\theta}(a_{i})}{\pi_{0}(a_{i})}}{\sum\limits_{(a_{j},r_{j})\in\mathcal{D%
}}\frac{\pi_{\theta}(a_{j})}{\pi_{0}(a_{j})}}.</annotation><annotation encoding="application/x-llamapun" id="S4.E13.m1.9d">italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT over¯ start_ARG italic_w end_ARG start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG , where over¯ start_ARG italic_w end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = divide start_ARG italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG ∑ start_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ∈ caligraphic_D end_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG = divide start_ARG divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_ARG end_ARG start_ARG ∑ start_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ∈ caligraphic_D end_POSTSUBSCRIPT divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p1.1">Whilst common and intuitive, this estimator has flaws.
First, <cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib52" title="">Owen</a></cite> remarks that the effectiveness of importance sampling depends on the distribution of <math alttext="R" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">R</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">italic_R</annotation></semantics></math>, which is not captured here.
They propose to define a reward-specific estimator as <cite class="ltx_cite ltx_citemacro_citep">(Owen, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib52" title="">2013</a>, Eq. 9.17)</cite>:</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="S8.EGx1">
<tbody id="S4.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(14)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle P^{R-2}_{N}=\frac{1}{\sum_{i}\widetilde{w}^{2}_{i}}," class="ltx_Math" display="block" id="S4.E14.m1.1"><semantics id="S4.E14.m1.1a"><mrow id="S4.E14.m1.1.1.1" xref="S4.E14.m1.1.1.1.1.cmml"><mrow id="S4.E14.m1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.cmml"><msubsup id="S4.E14.m1.1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.2.cmml"><mi id="S4.E14.m1.1.1.1.1.2.2.2" xref="S4.E14.m1.1.1.1.1.2.2.2.cmml">P</mi><mi id="S4.E14.m1.1.1.1.1.2.3" xref="S4.E14.m1.1.1.1.1.2.3.cmml">N</mi><mrow id="S4.E14.m1.1.1.1.1.2.2.3" xref="S4.E14.m1.1.1.1.1.2.2.3.cmml"><mi id="S4.E14.m1.1.1.1.1.2.2.3.2" xref="S4.E14.m1.1.1.1.1.2.2.3.2.cmml">R</mi><mo id="S4.E14.m1.1.1.1.1.2.2.3.1" xref="S4.E14.m1.1.1.1.1.2.2.3.1.cmml">−</mo><mn id="S4.E14.m1.1.1.1.1.2.2.3.3" xref="S4.E14.m1.1.1.1.1.2.2.3.3.cmml">2</mn></mrow></msubsup><mo id="S4.E14.m1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.cmml">=</mo><mfrac id="S4.E14.m1.1.1.1.1.3" xref="S4.E14.m1.1.1.1.1.3.cmml"><mn id="S4.E14.m1.1.1.1.1.3.2" xref="S4.E14.m1.1.1.1.1.3.2.cmml">1</mn><mrow id="S4.E14.m1.1.1.1.1.3.3" xref="S4.E14.m1.1.1.1.1.3.3.cmml"><msub id="S4.E14.m1.1.1.1.1.3.3.1" xref="S4.E14.m1.1.1.1.1.3.3.1.cmml"><mo id="S4.E14.m1.1.1.1.1.3.3.1.2" xref="S4.E14.m1.1.1.1.1.3.3.1.2.cmml">∑</mo><mi id="S4.E14.m1.1.1.1.1.3.3.1.3" xref="S4.E14.m1.1.1.1.1.3.3.1.3.cmml">i</mi></msub><msubsup id="S4.E14.m1.1.1.1.1.3.3.2" xref="S4.E14.m1.1.1.1.1.3.3.2.cmml"><mover accent="true" id="S4.E14.m1.1.1.1.1.3.3.2.2.2" xref="S4.E14.m1.1.1.1.1.3.3.2.2.2.cmml"><mi id="S4.E14.m1.1.1.1.1.3.3.2.2.2.2" xref="S4.E14.m1.1.1.1.1.3.3.2.2.2.2.cmml">w</mi><mo id="S4.E14.m1.1.1.1.1.3.3.2.2.2.1" xref="S4.E14.m1.1.1.1.1.3.3.2.2.2.1.cmml">~</mo></mover><mi id="S4.E14.m1.1.1.1.1.3.3.2.3" xref="S4.E14.m1.1.1.1.1.3.3.2.3.cmml">i</mi><mn id="S4.E14.m1.1.1.1.1.3.3.2.2.3" xref="S4.E14.m1.1.1.1.1.3.3.2.2.3.cmml">2</mn></msubsup></mrow></mfrac></mrow><mo id="S4.E14.m1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E14.m1.1b"><apply id="S4.E14.m1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1"><eq id="S4.E14.m1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.1"></eq><apply id="S4.E14.m1.1.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.2.1.cmml" xref="S4.E14.m1.1.1.1.1.2">subscript</csymbol><apply id="S4.E14.m1.1.1.1.1.2.2.cmml" xref="S4.E14.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.2.2.1.cmml" xref="S4.E14.m1.1.1.1.1.2">superscript</csymbol><ci id="S4.E14.m1.1.1.1.1.2.2.2.cmml" xref="S4.E14.m1.1.1.1.1.2.2.2">𝑃</ci><apply id="S4.E14.m1.1.1.1.1.2.2.3.cmml" xref="S4.E14.m1.1.1.1.1.2.2.3"><minus id="S4.E14.m1.1.1.1.1.2.2.3.1.cmml" xref="S4.E14.m1.1.1.1.1.2.2.3.1"></minus><ci id="S4.E14.m1.1.1.1.1.2.2.3.2.cmml" xref="S4.E14.m1.1.1.1.1.2.2.3.2">𝑅</ci><cn id="S4.E14.m1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E14.m1.1.1.1.1.2.2.3.3">2</cn></apply></apply><ci id="S4.E14.m1.1.1.1.1.2.3.cmml" xref="S4.E14.m1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S4.E14.m1.1.1.1.1.3.cmml" xref="S4.E14.m1.1.1.1.1.3"><divide id="S4.E14.m1.1.1.1.1.3.1.cmml" xref="S4.E14.m1.1.1.1.1.3"></divide><cn id="S4.E14.m1.1.1.1.1.3.2.cmml" type="integer" xref="S4.E14.m1.1.1.1.1.3.2">1</cn><apply id="S4.E14.m1.1.1.1.1.3.3.cmml" xref="S4.E14.m1.1.1.1.1.3.3"><apply id="S4.E14.m1.1.1.1.1.3.3.1.cmml" xref="S4.E14.m1.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.3.3.1.1.cmml" xref="S4.E14.m1.1.1.1.1.3.3.1">subscript</csymbol><sum id="S4.E14.m1.1.1.1.1.3.3.1.2.cmml" xref="S4.E14.m1.1.1.1.1.3.3.1.2"></sum><ci id="S4.E14.m1.1.1.1.1.3.3.1.3.cmml" xref="S4.E14.m1.1.1.1.1.3.3.1.3">𝑖</ci></apply><apply id="S4.E14.m1.1.1.1.1.3.3.2.cmml" xref="S4.E14.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.3.3.2.1.cmml" xref="S4.E14.m1.1.1.1.1.3.3.2">subscript</csymbol><apply id="S4.E14.m1.1.1.1.1.3.3.2.2.cmml" xref="S4.E14.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.3.3.2.2.1.cmml" xref="S4.E14.m1.1.1.1.1.3.3.2">superscript</csymbol><apply id="S4.E14.m1.1.1.1.1.3.3.2.2.2.cmml" xref="S4.E14.m1.1.1.1.1.3.3.2.2.2"><ci id="S4.E14.m1.1.1.1.1.3.3.2.2.2.1.cmml" xref="S4.E14.m1.1.1.1.1.3.3.2.2.2.1">~</ci><ci id="S4.E14.m1.1.1.1.1.3.3.2.2.2.2.cmml" xref="S4.E14.m1.1.1.1.1.3.3.2.2.2.2">𝑤</ci></apply><cn id="S4.E14.m1.1.1.1.1.3.3.2.2.3.cmml" type="integer" xref="S4.E14.m1.1.1.1.1.3.3.2.2.3">2</cn></apply><ci id="S4.E14.m1.1.1.1.1.3.3.2.3.cmml" xref="S4.E14.m1.1.1.1.1.3.3.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14.m1.1c">\displaystyle P^{R-2}_{N}=\frac{1}{\sum_{i}\widetilde{w}^{2}_{i}},</annotation><annotation encoding="application/x-llamapun" id="S4.E14.m1.1d">italic_P start_POSTSUPERSCRIPT italic_R - 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT over~ start_ARG italic_w end_ARG start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\text{~{}where~{}}\widetilde{w}_{i}=\frac{w_{i}|r_{i}|}{\sum%
\limits_{(a_{j},r_{j})\in\mathcal{D}}w_{j}|r_{j}|}=\frac{\frac{\pi(a_{i})}{\pi%
_{0}(a_{i})}|r_{i}|}{\sum\limits_{(a_{j},r_{j})\in\mathcal{D}}\frac{\pi(a_{j})%
}{\pi_{0}(a_{j})}|r_{j}|}." class="ltx_Math" display="block" id="S4.Ex1.m1.13"><semantics id="S4.Ex1.m1.13a"><mrow id="S4.Ex1.m1.13.13.1" xref="S4.Ex1.m1.13.13.1.1.cmml"><mrow id="S4.Ex1.m1.13.13.1.1" xref="S4.Ex1.m1.13.13.1.1.cmml"><mrow id="S4.Ex1.m1.13.13.1.1.2" xref="S4.Ex1.m1.13.13.1.1.2.cmml"><mtext id="S4.Ex1.m1.13.13.1.1.2.2" xref="S4.Ex1.m1.13.13.1.1.2.2a.cmml"> where </mtext><mo id="S4.Ex1.m1.13.13.1.1.2.1" xref="S4.Ex1.m1.13.13.1.1.2.1.cmml">⁢</mo><msub id="S4.Ex1.m1.13.13.1.1.2.3" xref="S4.Ex1.m1.13.13.1.1.2.3.cmml"><mover accent="true" id="S4.Ex1.m1.13.13.1.1.2.3.2" xref="S4.Ex1.m1.13.13.1.1.2.3.2.cmml"><mi id="S4.Ex1.m1.13.13.1.1.2.3.2.2" xref="S4.Ex1.m1.13.13.1.1.2.3.2.2.cmml">w</mi><mo id="S4.Ex1.m1.13.13.1.1.2.3.2.1" xref="S4.Ex1.m1.13.13.1.1.2.3.2.1.cmml">~</mo></mover><mi id="S4.Ex1.m1.13.13.1.1.2.3.3" xref="S4.Ex1.m1.13.13.1.1.2.3.3.cmml">i</mi></msub></mrow><mo id="S4.Ex1.m1.13.13.1.1.3" xref="S4.Ex1.m1.13.13.1.1.3.cmml">=</mo><mfrac id="S4.Ex1.m1.4.4" xref="S4.Ex1.m1.4.4.cmml"><mrow id="S4.Ex1.m1.1.1.1" xref="S4.Ex1.m1.1.1.1.cmml"><msub id="S4.Ex1.m1.1.1.1.3" xref="S4.Ex1.m1.1.1.1.3.cmml"><mi id="S4.Ex1.m1.1.1.1.3.2" xref="S4.Ex1.m1.1.1.1.3.2.cmml">w</mi><mi id="S4.Ex1.m1.1.1.1.3.3" xref="S4.Ex1.m1.1.1.1.3.3.cmml">i</mi></msub><mo id="S4.Ex1.m1.1.1.1.2" xref="S4.Ex1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex1.m1.1.1.1.1.1" xref="S4.Ex1.m1.1.1.1.1.2.cmml"><mo id="S4.Ex1.m1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex1.m1.1.1.1.1.2.1.cmml">|</mo><msub id="S4.Ex1.m1.1.1.1.1.1.1" xref="S4.Ex1.m1.1.1.1.1.1.1.cmml"><mi id="S4.Ex1.m1.1.1.1.1.1.1.2" xref="S4.Ex1.m1.1.1.1.1.1.1.2.cmml">r</mi><mi id="S4.Ex1.m1.1.1.1.1.1.1.3" xref="S4.Ex1.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.Ex1.m1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex1.m1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow><mrow id="S4.Ex1.m1.4.4.4" xref="S4.Ex1.m1.4.4.4.cmml"><munder id="S4.Ex1.m1.4.4.4.4" xref="S4.Ex1.m1.4.4.4.4.cmml"><mo id="S4.Ex1.m1.4.4.4.4.2" movablelimits="false" xref="S4.Ex1.m1.4.4.4.4.2.cmml">∑</mo><mrow id="S4.Ex1.m1.3.3.3.2.2" xref="S4.Ex1.m1.3.3.3.2.2.cmml"><mrow id="S4.Ex1.m1.3.3.3.2.2.2.2" xref="S4.Ex1.m1.3.3.3.2.2.2.3.cmml"><mo id="S4.Ex1.m1.3.3.3.2.2.2.2.3" stretchy="false" xref="S4.Ex1.m1.3.3.3.2.2.2.3.cmml">(</mo><msub id="S4.Ex1.m1.2.2.2.1.1.1.1.1" xref="S4.Ex1.m1.2.2.2.1.1.1.1.1.cmml"><mi id="S4.Ex1.m1.2.2.2.1.1.1.1.1.2" xref="S4.Ex1.m1.2.2.2.1.1.1.1.1.2.cmml">a</mi><mi id="S4.Ex1.m1.2.2.2.1.1.1.1.1.3" xref="S4.Ex1.m1.2.2.2.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S4.Ex1.m1.3.3.3.2.2.2.2.4" xref="S4.Ex1.m1.3.3.3.2.2.2.3.cmml">,</mo><msub id="S4.Ex1.m1.3.3.3.2.2.2.2.2" xref="S4.Ex1.m1.3.3.3.2.2.2.2.2.cmml"><mi id="S4.Ex1.m1.3.3.3.2.2.2.2.2.2" xref="S4.Ex1.m1.3.3.3.2.2.2.2.2.2.cmml">r</mi><mi id="S4.Ex1.m1.3.3.3.2.2.2.2.2.3" xref="S4.Ex1.m1.3.3.3.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S4.Ex1.m1.3.3.3.2.2.2.2.5" stretchy="false" xref="S4.Ex1.m1.3.3.3.2.2.2.3.cmml">)</mo></mrow><mo id="S4.Ex1.m1.3.3.3.2.2.3" xref="S4.Ex1.m1.3.3.3.2.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.Ex1.m1.3.3.3.2.2.4" xref="S4.Ex1.m1.3.3.3.2.2.4.cmml">𝒟</mi></mrow></munder><mrow id="S4.Ex1.m1.4.4.4.3" xref="S4.Ex1.m1.4.4.4.3.cmml"><msub id="S4.Ex1.m1.4.4.4.3.3" xref="S4.Ex1.m1.4.4.4.3.3.cmml"><mi id="S4.Ex1.m1.4.4.4.3.3.2" xref="S4.Ex1.m1.4.4.4.3.3.2.cmml">w</mi><mi id="S4.Ex1.m1.4.4.4.3.3.3" xref="S4.Ex1.m1.4.4.4.3.3.3.cmml">j</mi></msub><mo id="S4.Ex1.m1.4.4.4.3.2" xref="S4.Ex1.m1.4.4.4.3.2.cmml">⁢</mo><mrow id="S4.Ex1.m1.4.4.4.3.1.1" xref="S4.Ex1.m1.4.4.4.3.1.2.cmml"><mo id="S4.Ex1.m1.4.4.4.3.1.1.2" stretchy="false" xref="S4.Ex1.m1.4.4.4.3.1.2.1.cmml">|</mo><msub id="S4.Ex1.m1.4.4.4.3.1.1.1" xref="S4.Ex1.m1.4.4.4.3.1.1.1.cmml"><mi id="S4.Ex1.m1.4.4.4.3.1.1.1.2" xref="S4.Ex1.m1.4.4.4.3.1.1.1.2.cmml">r</mi><mi id="S4.Ex1.m1.4.4.4.3.1.1.1.3" xref="S4.Ex1.m1.4.4.4.3.1.1.1.3.cmml">j</mi></msub><mo id="S4.Ex1.m1.4.4.4.3.1.1.3" stretchy="false" xref="S4.Ex1.m1.4.4.4.3.1.2.1.cmml">|</mo></mrow></mrow></mrow></mfrac><mo id="S4.Ex1.m1.13.13.1.1.4" xref="S4.Ex1.m1.13.13.1.1.4.cmml">=</mo><mfrac id="S4.Ex1.m1.12.12" xref="S4.Ex1.m1.12.12.cmml"><mrow id="S4.Ex1.m1.7.7.3" xref="S4.Ex1.m1.7.7.3.cmml"><mfrac id="S4.Ex1.m1.6.6.2.2" xref="S4.Ex1.m1.6.6.2.2.cmml"><mrow id="S4.Ex1.m1.5.5.1.1.1" xref="S4.Ex1.m1.5.5.1.1.1.cmml"><mi id="S4.Ex1.m1.5.5.1.1.1.3" xref="S4.Ex1.m1.5.5.1.1.1.3.cmml">π</mi><mo id="S4.Ex1.m1.5.5.1.1.1.2" xref="S4.Ex1.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex1.m1.5.5.1.1.1.1.1" xref="S4.Ex1.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S4.Ex1.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S4.Ex1.m1.5.5.1.1.1.1.1.1.cmml">(</mo><msub id="S4.Ex1.m1.5.5.1.1.1.1.1.1" xref="S4.Ex1.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S4.Ex1.m1.5.5.1.1.1.1.1.1.2" xref="S4.Ex1.m1.5.5.1.1.1.1.1.1.2.cmml">a</mi><mi id="S4.Ex1.m1.5.5.1.1.1.1.1.1.3" xref="S4.Ex1.m1.5.5.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.Ex1.m1.5.5.1.1.1.1.1.3" stretchy="false" xref="S4.Ex1.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.Ex1.m1.6.6.2.2.2" xref="S4.Ex1.m1.6.6.2.2.2.cmml"><msub id="S4.Ex1.m1.6.6.2.2.2.3" xref="S4.Ex1.m1.6.6.2.2.2.3.cmml"><mi id="S4.Ex1.m1.6.6.2.2.2.3.2" xref="S4.Ex1.m1.6.6.2.2.2.3.2.cmml">π</mi><mn id="S4.Ex1.m1.6.6.2.2.2.3.3" xref="S4.Ex1.m1.6.6.2.2.2.3.3.cmml">0</mn></msub><mo id="S4.Ex1.m1.6.6.2.2.2.2" xref="S4.Ex1.m1.6.6.2.2.2.2.cmml">⁢</mo><mrow id="S4.Ex1.m1.6.6.2.2.2.1.1" xref="S4.Ex1.m1.6.6.2.2.2.1.1.1.cmml"><mo id="S4.Ex1.m1.6.6.2.2.2.1.1.2" stretchy="false" xref="S4.Ex1.m1.6.6.2.2.2.1.1.1.cmml">(</mo><msub id="S4.Ex1.m1.6.6.2.2.2.1.1.1" xref="S4.Ex1.m1.6.6.2.2.2.1.1.1.cmml"><mi id="S4.Ex1.m1.6.6.2.2.2.1.1.1.2" xref="S4.Ex1.m1.6.6.2.2.2.1.1.1.2.cmml">a</mi><mi id="S4.Ex1.m1.6.6.2.2.2.1.1.1.3" xref="S4.Ex1.m1.6.6.2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S4.Ex1.m1.6.6.2.2.2.1.1.3" stretchy="false" xref="S4.Ex1.m1.6.6.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S4.Ex1.m1.7.7.3.4" xref="S4.Ex1.m1.7.7.3.4.cmml">⁢</mo><mrow id="S4.Ex1.m1.7.7.3.3.1" xref="S4.Ex1.m1.7.7.3.3.2.cmml"><mo id="S4.Ex1.m1.7.7.3.3.1.2" stretchy="false" xref="S4.Ex1.m1.7.7.3.3.2.1.cmml">|</mo><msub id="S4.Ex1.m1.7.7.3.3.1.1" xref="S4.Ex1.m1.7.7.3.3.1.1.cmml"><mi id="S4.Ex1.m1.7.7.3.3.1.1.2" xref="S4.Ex1.m1.7.7.3.3.1.1.2.cmml">r</mi><mi id="S4.Ex1.m1.7.7.3.3.1.1.3" xref="S4.Ex1.m1.7.7.3.3.1.1.3.cmml">i</mi></msub><mo id="S4.Ex1.m1.7.7.3.3.1.3" stretchy="false" xref="S4.Ex1.m1.7.7.3.3.2.1.cmml">|</mo></mrow></mrow><mrow id="S4.Ex1.m1.12.12.8" xref="S4.Ex1.m1.12.12.8.cmml"><munder id="S4.Ex1.m1.12.12.8.6" xref="S4.Ex1.m1.12.12.8.6.cmml"><mo id="S4.Ex1.m1.12.12.8.6.2" movablelimits="false" xref="S4.Ex1.m1.12.12.8.6.2.cmml">∑</mo><mrow id="S4.Ex1.m1.9.9.5.2.2" xref="S4.Ex1.m1.9.9.5.2.2.cmml"><mrow id="S4.Ex1.m1.9.9.5.2.2.2.2" xref="S4.Ex1.m1.9.9.5.2.2.2.3.cmml"><mo id="S4.Ex1.m1.9.9.5.2.2.2.2.3" stretchy="false" xref="S4.Ex1.m1.9.9.5.2.2.2.3.cmml">(</mo><msub id="S4.Ex1.m1.8.8.4.1.1.1.1.1" xref="S4.Ex1.m1.8.8.4.1.1.1.1.1.cmml"><mi id="S4.Ex1.m1.8.8.4.1.1.1.1.1.2" xref="S4.Ex1.m1.8.8.4.1.1.1.1.1.2.cmml">a</mi><mi id="S4.Ex1.m1.8.8.4.1.1.1.1.1.3" xref="S4.Ex1.m1.8.8.4.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S4.Ex1.m1.9.9.5.2.2.2.2.4" xref="S4.Ex1.m1.9.9.5.2.2.2.3.cmml">,</mo><msub id="S4.Ex1.m1.9.9.5.2.2.2.2.2" xref="S4.Ex1.m1.9.9.5.2.2.2.2.2.cmml"><mi id="S4.Ex1.m1.9.9.5.2.2.2.2.2.2" xref="S4.Ex1.m1.9.9.5.2.2.2.2.2.2.cmml">r</mi><mi id="S4.Ex1.m1.9.9.5.2.2.2.2.2.3" xref="S4.Ex1.m1.9.9.5.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S4.Ex1.m1.9.9.5.2.2.2.2.5" stretchy="false" xref="S4.Ex1.m1.9.9.5.2.2.2.3.cmml">)</mo></mrow><mo id="S4.Ex1.m1.9.9.5.2.2.3" xref="S4.Ex1.m1.9.9.5.2.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.Ex1.m1.9.9.5.2.2.4" xref="S4.Ex1.m1.9.9.5.2.2.4.cmml">𝒟</mi></mrow></munder><mrow id="S4.Ex1.m1.12.12.8.5" xref="S4.Ex1.m1.12.12.8.5.cmml"><mfrac id="S4.Ex1.m1.11.11.7.4" xref="S4.Ex1.m1.11.11.7.4.cmml"><mrow id="S4.Ex1.m1.10.10.6.3.1" xref="S4.Ex1.m1.10.10.6.3.1.cmml"><mi id="S4.Ex1.m1.10.10.6.3.1.3" xref="S4.Ex1.m1.10.10.6.3.1.3.cmml">π</mi><mo id="S4.Ex1.m1.10.10.6.3.1.2" xref="S4.Ex1.m1.10.10.6.3.1.2.cmml">⁢</mo><mrow id="S4.Ex1.m1.10.10.6.3.1.1.1" xref="S4.Ex1.m1.10.10.6.3.1.1.1.1.cmml"><mo id="S4.Ex1.m1.10.10.6.3.1.1.1.2" stretchy="false" xref="S4.Ex1.m1.10.10.6.3.1.1.1.1.cmml">(</mo><msub id="S4.Ex1.m1.10.10.6.3.1.1.1.1" xref="S4.Ex1.m1.10.10.6.3.1.1.1.1.cmml"><mi id="S4.Ex1.m1.10.10.6.3.1.1.1.1.2" xref="S4.Ex1.m1.10.10.6.3.1.1.1.1.2.cmml">a</mi><mi id="S4.Ex1.m1.10.10.6.3.1.1.1.1.3" xref="S4.Ex1.m1.10.10.6.3.1.1.1.1.3.cmml">j</mi></msub><mo id="S4.Ex1.m1.10.10.6.3.1.1.1.3" stretchy="false" xref="S4.Ex1.m1.10.10.6.3.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.Ex1.m1.11.11.7.4.2" xref="S4.Ex1.m1.11.11.7.4.2.cmml"><msub id="S4.Ex1.m1.11.11.7.4.2.3" xref="S4.Ex1.m1.11.11.7.4.2.3.cmml"><mi id="S4.Ex1.m1.11.11.7.4.2.3.2" xref="S4.Ex1.m1.11.11.7.4.2.3.2.cmml">π</mi><mn id="S4.Ex1.m1.11.11.7.4.2.3.3" xref="S4.Ex1.m1.11.11.7.4.2.3.3.cmml">0</mn></msub><mo id="S4.Ex1.m1.11.11.7.4.2.2" xref="S4.Ex1.m1.11.11.7.4.2.2.cmml">⁢</mo><mrow id="S4.Ex1.m1.11.11.7.4.2.1.1" xref="S4.Ex1.m1.11.11.7.4.2.1.1.1.cmml"><mo id="S4.Ex1.m1.11.11.7.4.2.1.1.2" stretchy="false" xref="S4.Ex1.m1.11.11.7.4.2.1.1.1.cmml">(</mo><msub id="S4.Ex1.m1.11.11.7.4.2.1.1.1" xref="S4.Ex1.m1.11.11.7.4.2.1.1.1.cmml"><mi id="S4.Ex1.m1.11.11.7.4.2.1.1.1.2" xref="S4.Ex1.m1.11.11.7.4.2.1.1.1.2.cmml">a</mi><mi id="S4.Ex1.m1.11.11.7.4.2.1.1.1.3" xref="S4.Ex1.m1.11.11.7.4.2.1.1.1.3.cmml">j</mi></msub><mo id="S4.Ex1.m1.11.11.7.4.2.1.1.3" stretchy="false" xref="S4.Ex1.m1.11.11.7.4.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S4.Ex1.m1.12.12.8.5.2" xref="S4.Ex1.m1.12.12.8.5.2.cmml">⁢</mo><mrow id="S4.Ex1.m1.12.12.8.5.1.1" xref="S4.Ex1.m1.12.12.8.5.1.2.cmml"><mo id="S4.Ex1.m1.12.12.8.5.1.1.2" stretchy="false" xref="S4.Ex1.m1.12.12.8.5.1.2.1.cmml">|</mo><msub id="S4.Ex1.m1.12.12.8.5.1.1.1" xref="S4.Ex1.m1.12.12.8.5.1.1.1.cmml"><mi id="S4.Ex1.m1.12.12.8.5.1.1.1.2" xref="S4.Ex1.m1.12.12.8.5.1.1.1.2.cmml">r</mi><mi id="S4.Ex1.m1.12.12.8.5.1.1.1.3" xref="S4.Ex1.m1.12.12.8.5.1.1.1.3.cmml">j</mi></msub><mo id="S4.Ex1.m1.12.12.8.5.1.1.3" stretchy="false" xref="S4.Ex1.m1.12.12.8.5.1.2.1.cmml">|</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S4.Ex1.m1.13.13.1.2" lspace="0em" xref="S4.Ex1.m1.13.13.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex1.m1.13b"><apply id="S4.Ex1.m1.13.13.1.1.cmml" xref="S4.Ex1.m1.13.13.1"><and id="S4.Ex1.m1.13.13.1.1a.cmml" xref="S4.Ex1.m1.13.13.1"></and><apply id="S4.Ex1.m1.13.13.1.1b.cmml" xref="S4.Ex1.m1.13.13.1"><eq id="S4.Ex1.m1.13.13.1.1.3.cmml" xref="S4.Ex1.m1.13.13.1.1.3"></eq><apply id="S4.Ex1.m1.13.13.1.1.2.cmml" xref="S4.Ex1.m1.13.13.1.1.2"><times id="S4.Ex1.m1.13.13.1.1.2.1.cmml" xref="S4.Ex1.m1.13.13.1.1.2.1"></times><ci id="S4.Ex1.m1.13.13.1.1.2.2a.cmml" xref="S4.Ex1.m1.13.13.1.1.2.2"><mtext id="S4.Ex1.m1.13.13.1.1.2.2.cmml" xref="S4.Ex1.m1.13.13.1.1.2.2"> where </mtext></ci><apply id="S4.Ex1.m1.13.13.1.1.2.3.cmml" xref="S4.Ex1.m1.13.13.1.1.2.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.13.13.1.1.2.3.1.cmml" xref="S4.Ex1.m1.13.13.1.1.2.3">subscript</csymbol><apply id="S4.Ex1.m1.13.13.1.1.2.3.2.cmml" xref="S4.Ex1.m1.13.13.1.1.2.3.2"><ci id="S4.Ex1.m1.13.13.1.1.2.3.2.1.cmml" xref="S4.Ex1.m1.13.13.1.1.2.3.2.1">~</ci><ci id="S4.Ex1.m1.13.13.1.1.2.3.2.2.cmml" xref="S4.Ex1.m1.13.13.1.1.2.3.2.2">𝑤</ci></apply><ci id="S4.Ex1.m1.13.13.1.1.2.3.3.cmml" xref="S4.Ex1.m1.13.13.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S4.Ex1.m1.4.4.cmml" xref="S4.Ex1.m1.4.4"><divide id="S4.Ex1.m1.4.4.5.cmml" xref="S4.Ex1.m1.4.4"></divide><apply id="S4.Ex1.m1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1"><times id="S4.Ex1.m1.1.1.1.2.cmml" xref="S4.Ex1.m1.1.1.1.2"></times><apply id="S4.Ex1.m1.1.1.1.3.cmml" xref="S4.Ex1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.1.1.1.3.1.cmml" xref="S4.Ex1.m1.1.1.1.3">subscript</csymbol><ci id="S4.Ex1.m1.1.1.1.3.2.cmml" xref="S4.Ex1.m1.1.1.1.3.2">𝑤</ci><ci id="S4.Ex1.m1.1.1.1.3.3.cmml" xref="S4.Ex1.m1.1.1.1.3.3">𝑖</ci></apply><apply id="S4.Ex1.m1.1.1.1.1.2.cmml" xref="S4.Ex1.m1.1.1.1.1.1"><abs id="S4.Ex1.m1.1.1.1.1.2.1.cmml" xref="S4.Ex1.m1.1.1.1.1.1.2"></abs><apply id="S4.Ex1.m1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex1.m1.1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1.2">𝑟</ci><ci id="S4.Ex1.m1.1.1.1.1.1.1.3.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S4.Ex1.m1.4.4.4.cmml" xref="S4.Ex1.m1.4.4.4"><apply id="S4.Ex1.m1.4.4.4.4.cmml" xref="S4.Ex1.m1.4.4.4.4"><csymbol cd="ambiguous" id="S4.Ex1.m1.4.4.4.4.1.cmml" xref="S4.Ex1.m1.4.4.4.4">subscript</csymbol><sum id="S4.Ex1.m1.4.4.4.4.2.cmml" xref="S4.Ex1.m1.4.4.4.4.2"></sum><apply id="S4.Ex1.m1.3.3.3.2.2.cmml" xref="S4.Ex1.m1.3.3.3.2.2"><in id="S4.Ex1.m1.3.3.3.2.2.3.cmml" xref="S4.Ex1.m1.3.3.3.2.2.3"></in><interval closure="open" id="S4.Ex1.m1.3.3.3.2.2.2.3.cmml" xref="S4.Ex1.m1.3.3.3.2.2.2.2"><apply id="S4.Ex1.m1.2.2.2.1.1.1.1.1.cmml" xref="S4.Ex1.m1.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.2.2.2.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex1.m1.2.2.2.1.1.1.1.1.2.cmml" xref="S4.Ex1.m1.2.2.2.1.1.1.1.1.2">𝑎</ci><ci id="S4.Ex1.m1.2.2.2.1.1.1.1.1.3.cmml" xref="S4.Ex1.m1.2.2.2.1.1.1.1.1.3">𝑗</ci></apply><apply id="S4.Ex1.m1.3.3.3.2.2.2.2.2.cmml" xref="S4.Ex1.m1.3.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.3.3.3.2.2.2.2.2.1.cmml" xref="S4.Ex1.m1.3.3.3.2.2.2.2.2">subscript</csymbol><ci id="S4.Ex1.m1.3.3.3.2.2.2.2.2.2.cmml" xref="S4.Ex1.m1.3.3.3.2.2.2.2.2.2">𝑟</ci><ci id="S4.Ex1.m1.3.3.3.2.2.2.2.2.3.cmml" xref="S4.Ex1.m1.3.3.3.2.2.2.2.2.3">𝑗</ci></apply></interval><ci id="S4.Ex1.m1.3.3.3.2.2.4.cmml" xref="S4.Ex1.m1.3.3.3.2.2.4">𝒟</ci></apply></apply><apply id="S4.Ex1.m1.4.4.4.3.cmml" xref="S4.Ex1.m1.4.4.4.3"><times id="S4.Ex1.m1.4.4.4.3.2.cmml" xref="S4.Ex1.m1.4.4.4.3.2"></times><apply id="S4.Ex1.m1.4.4.4.3.3.cmml" xref="S4.Ex1.m1.4.4.4.3.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.4.4.4.3.3.1.cmml" xref="S4.Ex1.m1.4.4.4.3.3">subscript</csymbol><ci id="S4.Ex1.m1.4.4.4.3.3.2.cmml" xref="S4.Ex1.m1.4.4.4.3.3.2">𝑤</ci><ci id="S4.Ex1.m1.4.4.4.3.3.3.cmml" xref="S4.Ex1.m1.4.4.4.3.3.3">𝑗</ci></apply><apply id="S4.Ex1.m1.4.4.4.3.1.2.cmml" xref="S4.Ex1.m1.4.4.4.3.1.1"><abs id="S4.Ex1.m1.4.4.4.3.1.2.1.cmml" xref="S4.Ex1.m1.4.4.4.3.1.1.2"></abs><apply id="S4.Ex1.m1.4.4.4.3.1.1.1.cmml" xref="S4.Ex1.m1.4.4.4.3.1.1.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.4.4.4.3.1.1.1.1.cmml" xref="S4.Ex1.m1.4.4.4.3.1.1.1">subscript</csymbol><ci id="S4.Ex1.m1.4.4.4.3.1.1.1.2.cmml" xref="S4.Ex1.m1.4.4.4.3.1.1.1.2">𝑟</ci><ci id="S4.Ex1.m1.4.4.4.3.1.1.1.3.cmml" xref="S4.Ex1.m1.4.4.4.3.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></apply><apply id="S4.Ex1.m1.13.13.1.1c.cmml" xref="S4.Ex1.m1.13.13.1"><eq id="S4.Ex1.m1.13.13.1.1.4.cmml" xref="S4.Ex1.m1.13.13.1.1.4"></eq><share href="https://arxiv.org/html/2405.02141v2#S4.Ex1.m1.4.4.cmml" id="S4.Ex1.m1.13.13.1.1d.cmml" xref="S4.Ex1.m1.13.13.1"></share><apply id="S4.Ex1.m1.12.12.cmml" xref="S4.Ex1.m1.12.12"><divide id="S4.Ex1.m1.12.12.9.cmml" xref="S4.Ex1.m1.12.12"></divide><apply id="S4.Ex1.m1.7.7.3.cmml" xref="S4.Ex1.m1.7.7.3"><times id="S4.Ex1.m1.7.7.3.4.cmml" xref="S4.Ex1.m1.7.7.3.4"></times><apply id="S4.Ex1.m1.6.6.2.2.cmml" xref="S4.Ex1.m1.6.6.2.2"><divide id="S4.Ex1.m1.6.6.2.2.3.cmml" xref="S4.Ex1.m1.6.6.2.2"></divide><apply id="S4.Ex1.m1.5.5.1.1.1.cmml" xref="S4.Ex1.m1.5.5.1.1.1"><times id="S4.Ex1.m1.5.5.1.1.1.2.cmml" xref="S4.Ex1.m1.5.5.1.1.1.2"></times><ci id="S4.Ex1.m1.5.5.1.1.1.3.cmml" xref="S4.Ex1.m1.5.5.1.1.1.3">𝜋</ci><apply id="S4.Ex1.m1.5.5.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.5.5.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex1.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m1.5.5.1.1.1.1.1.1.2">𝑎</ci><ci id="S4.Ex1.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S4.Ex1.m1.5.5.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S4.Ex1.m1.6.6.2.2.2.cmml" xref="S4.Ex1.m1.6.6.2.2.2"><times id="S4.Ex1.m1.6.6.2.2.2.2.cmml" xref="S4.Ex1.m1.6.6.2.2.2.2"></times><apply id="S4.Ex1.m1.6.6.2.2.2.3.cmml" xref="S4.Ex1.m1.6.6.2.2.2.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.6.6.2.2.2.3.1.cmml" xref="S4.Ex1.m1.6.6.2.2.2.3">subscript</csymbol><ci id="S4.Ex1.m1.6.6.2.2.2.3.2.cmml" xref="S4.Ex1.m1.6.6.2.2.2.3.2">𝜋</ci><cn id="S4.Ex1.m1.6.6.2.2.2.3.3.cmml" type="integer" xref="S4.Ex1.m1.6.6.2.2.2.3.3">0</cn></apply><apply id="S4.Ex1.m1.6.6.2.2.2.1.1.1.cmml" xref="S4.Ex1.m1.6.6.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.6.6.2.2.2.1.1.1.1.cmml" xref="S4.Ex1.m1.6.6.2.2.2.1.1">subscript</csymbol><ci id="S4.Ex1.m1.6.6.2.2.2.1.1.1.2.cmml" xref="S4.Ex1.m1.6.6.2.2.2.1.1.1.2">𝑎</ci><ci id="S4.Ex1.m1.6.6.2.2.2.1.1.1.3.cmml" xref="S4.Ex1.m1.6.6.2.2.2.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S4.Ex1.m1.7.7.3.3.2.cmml" xref="S4.Ex1.m1.7.7.3.3.1"><abs id="S4.Ex1.m1.7.7.3.3.2.1.cmml" xref="S4.Ex1.m1.7.7.3.3.1.2"></abs><apply id="S4.Ex1.m1.7.7.3.3.1.1.cmml" xref="S4.Ex1.m1.7.7.3.3.1.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.7.7.3.3.1.1.1.cmml" xref="S4.Ex1.m1.7.7.3.3.1.1">subscript</csymbol><ci id="S4.Ex1.m1.7.7.3.3.1.1.2.cmml" xref="S4.Ex1.m1.7.7.3.3.1.1.2">𝑟</ci><ci id="S4.Ex1.m1.7.7.3.3.1.1.3.cmml" xref="S4.Ex1.m1.7.7.3.3.1.1.3">𝑖</ci></apply></apply></apply><apply id="S4.Ex1.m1.12.12.8.cmml" xref="S4.Ex1.m1.12.12.8"><apply id="S4.Ex1.m1.12.12.8.6.cmml" xref="S4.Ex1.m1.12.12.8.6"><csymbol cd="ambiguous" id="S4.Ex1.m1.12.12.8.6.1.cmml" xref="S4.Ex1.m1.12.12.8.6">subscript</csymbol><sum id="S4.Ex1.m1.12.12.8.6.2.cmml" xref="S4.Ex1.m1.12.12.8.6.2"></sum><apply id="S4.Ex1.m1.9.9.5.2.2.cmml" xref="S4.Ex1.m1.9.9.5.2.2"><in id="S4.Ex1.m1.9.9.5.2.2.3.cmml" xref="S4.Ex1.m1.9.9.5.2.2.3"></in><interval closure="open" id="S4.Ex1.m1.9.9.5.2.2.2.3.cmml" xref="S4.Ex1.m1.9.9.5.2.2.2.2"><apply id="S4.Ex1.m1.8.8.4.1.1.1.1.1.cmml" xref="S4.Ex1.m1.8.8.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.8.8.4.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.8.8.4.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex1.m1.8.8.4.1.1.1.1.1.2.cmml" xref="S4.Ex1.m1.8.8.4.1.1.1.1.1.2">𝑎</ci><ci id="S4.Ex1.m1.8.8.4.1.1.1.1.1.3.cmml" xref="S4.Ex1.m1.8.8.4.1.1.1.1.1.3">𝑗</ci></apply><apply id="S4.Ex1.m1.9.9.5.2.2.2.2.2.cmml" xref="S4.Ex1.m1.9.9.5.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.9.9.5.2.2.2.2.2.1.cmml" xref="S4.Ex1.m1.9.9.5.2.2.2.2.2">subscript</csymbol><ci id="S4.Ex1.m1.9.9.5.2.2.2.2.2.2.cmml" xref="S4.Ex1.m1.9.9.5.2.2.2.2.2.2">𝑟</ci><ci id="S4.Ex1.m1.9.9.5.2.2.2.2.2.3.cmml" xref="S4.Ex1.m1.9.9.5.2.2.2.2.2.3">𝑗</ci></apply></interval><ci id="S4.Ex1.m1.9.9.5.2.2.4.cmml" xref="S4.Ex1.m1.9.9.5.2.2.4">𝒟</ci></apply></apply><apply id="S4.Ex1.m1.12.12.8.5.cmml" xref="S4.Ex1.m1.12.12.8.5"><times id="S4.Ex1.m1.12.12.8.5.2.cmml" xref="S4.Ex1.m1.12.12.8.5.2"></times><apply id="S4.Ex1.m1.11.11.7.4.cmml" xref="S4.Ex1.m1.11.11.7.4"><divide id="S4.Ex1.m1.11.11.7.4.3.cmml" xref="S4.Ex1.m1.11.11.7.4"></divide><apply id="S4.Ex1.m1.10.10.6.3.1.cmml" xref="S4.Ex1.m1.10.10.6.3.1"><times id="S4.Ex1.m1.10.10.6.3.1.2.cmml" xref="S4.Ex1.m1.10.10.6.3.1.2"></times><ci id="S4.Ex1.m1.10.10.6.3.1.3.cmml" xref="S4.Ex1.m1.10.10.6.3.1.3">𝜋</ci><apply id="S4.Ex1.m1.10.10.6.3.1.1.1.1.cmml" xref="S4.Ex1.m1.10.10.6.3.1.1.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.10.10.6.3.1.1.1.1.1.cmml" xref="S4.Ex1.m1.10.10.6.3.1.1.1">subscript</csymbol><ci id="S4.Ex1.m1.10.10.6.3.1.1.1.1.2.cmml" xref="S4.Ex1.m1.10.10.6.3.1.1.1.1.2">𝑎</ci><ci id="S4.Ex1.m1.10.10.6.3.1.1.1.1.3.cmml" xref="S4.Ex1.m1.10.10.6.3.1.1.1.1.3">𝑗</ci></apply></apply><apply id="S4.Ex1.m1.11.11.7.4.2.cmml" xref="S4.Ex1.m1.11.11.7.4.2"><times id="S4.Ex1.m1.11.11.7.4.2.2.cmml" xref="S4.Ex1.m1.11.11.7.4.2.2"></times><apply id="S4.Ex1.m1.11.11.7.4.2.3.cmml" xref="S4.Ex1.m1.11.11.7.4.2.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.11.11.7.4.2.3.1.cmml" xref="S4.Ex1.m1.11.11.7.4.2.3">subscript</csymbol><ci id="S4.Ex1.m1.11.11.7.4.2.3.2.cmml" xref="S4.Ex1.m1.11.11.7.4.2.3.2">𝜋</ci><cn id="S4.Ex1.m1.11.11.7.4.2.3.3.cmml" type="integer" xref="S4.Ex1.m1.11.11.7.4.2.3.3">0</cn></apply><apply id="S4.Ex1.m1.11.11.7.4.2.1.1.1.cmml" xref="S4.Ex1.m1.11.11.7.4.2.1.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.11.11.7.4.2.1.1.1.1.cmml" xref="S4.Ex1.m1.11.11.7.4.2.1.1">subscript</csymbol><ci id="S4.Ex1.m1.11.11.7.4.2.1.1.1.2.cmml" xref="S4.Ex1.m1.11.11.7.4.2.1.1.1.2">𝑎</ci><ci id="S4.Ex1.m1.11.11.7.4.2.1.1.1.3.cmml" xref="S4.Ex1.m1.11.11.7.4.2.1.1.1.3">𝑗</ci></apply></apply></apply><apply id="S4.Ex1.m1.12.12.8.5.1.2.cmml" xref="S4.Ex1.m1.12.12.8.5.1.1"><abs id="S4.Ex1.m1.12.12.8.5.1.2.1.cmml" xref="S4.Ex1.m1.12.12.8.5.1.1.2"></abs><apply id="S4.Ex1.m1.12.12.8.5.1.1.1.cmml" xref="S4.Ex1.m1.12.12.8.5.1.1.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.12.12.8.5.1.1.1.1.cmml" xref="S4.Ex1.m1.12.12.8.5.1.1.1">subscript</csymbol><ci id="S4.Ex1.m1.12.12.8.5.1.1.1.2.cmml" xref="S4.Ex1.m1.12.12.8.5.1.1.1.2">𝑟</ci><ci id="S4.Ex1.m1.12.12.8.5.1.1.1.3.cmml" xref="S4.Ex1.m1.12.12.8.5.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex1.m1.13c">\displaystyle\text{~{}where~{}}\widetilde{w}_{i}=\frac{w_{i}|r_{i}|}{\sum%
\limits_{(a_{j},r_{j})\in\mathcal{D}}w_{j}|r_{j}|}=\frac{\frac{\pi(a_{i})}{\pi%
_{0}(a_{i})}|r_{i}|}{\sum\limits_{(a_{j},r_{j})\in\mathcal{D}}\frac{\pi(a_{j})%
}{\pi_{0}(a_{j})}|r_{j}|}.</annotation><annotation encoding="application/x-llamapun" id="S4.Ex1.m1.13d">where over~ start_ARG italic_w end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = divide start_ARG italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | end_ARG start_ARG ∑ start_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ∈ caligraphic_D end_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | end_ARG = divide start_ARG divide start_ARG italic_π ( italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_ARG | italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | end_ARG start_ARG ∑ start_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ∈ caligraphic_D end_POSTSUBSCRIPT divide start_ARG italic_π ( italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG | italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p1.6"><cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib45" title="">Martino et al<span class="ltx_text">.</span></a></cite> independently remark that <math alttext="P^{2}_{N}" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m1.1"><semantics id="S4.SS2.p1.2.m1.1a"><msubsup id="S4.SS2.p1.2.m1.1.1" xref="S4.SS2.p1.2.m1.1.1.cmml"><mi id="S4.SS2.p1.2.m1.1.1.2.2" xref="S4.SS2.p1.2.m1.1.1.2.2.cmml">P</mi><mi id="S4.SS2.p1.2.m1.1.1.3" xref="S4.SS2.p1.2.m1.1.1.3.cmml">N</mi><mn id="S4.SS2.p1.2.m1.1.1.2.3" xref="S4.SS2.p1.2.m1.1.1.2.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m1.1b"><apply id="S4.SS2.p1.2.m1.1.1.cmml" xref="S4.SS2.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m1.1.1.1.cmml" xref="S4.SS2.p1.2.m1.1.1">subscript</csymbol><apply id="S4.SS2.p1.2.m1.1.1.2.cmml" xref="S4.SS2.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m1.1.1.2.1.cmml" xref="S4.SS2.p1.2.m1.1.1">superscript</csymbol><ci id="S4.SS2.p1.2.m1.1.1.2.2.cmml" xref="S4.SS2.p1.2.m1.1.1.2.2">𝑃</ci><cn id="S4.SS2.p1.2.m1.1.1.2.3.cmml" type="integer" xref="S4.SS2.p1.2.m1.1.1.2.3">2</cn></apply><ci id="S4.SS2.p1.2.m1.1.1.3.cmml" xref="S4.SS2.p1.2.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m1.1c">P^{2}_{N}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m1.1d">italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT</annotation></semantics></math> is related to the Euclidean distance between the distribution of the normalised importance weights and uniform weights (i.e. when <math alttext="\pi_{\theta}\equiv\pi_{0}" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m2.1"><semantics id="S4.SS2.p1.3.m2.1a"><mrow id="S4.SS2.p1.3.m2.1.1" xref="S4.SS2.p1.3.m2.1.1.cmml"><msub id="S4.SS2.p1.3.m2.1.1.2" xref="S4.SS2.p1.3.m2.1.1.2.cmml"><mi id="S4.SS2.p1.3.m2.1.1.2.2" xref="S4.SS2.p1.3.m2.1.1.2.2.cmml">π</mi><mi id="S4.SS2.p1.3.m2.1.1.2.3" xref="S4.SS2.p1.3.m2.1.1.2.3.cmml">θ</mi></msub><mo id="S4.SS2.p1.3.m2.1.1.1" xref="S4.SS2.p1.3.m2.1.1.1.cmml">≡</mo><msub id="S4.SS2.p1.3.m2.1.1.3" xref="S4.SS2.p1.3.m2.1.1.3.cmml"><mi id="S4.SS2.p1.3.m2.1.1.3.2" xref="S4.SS2.p1.3.m2.1.1.3.2.cmml">π</mi><mn id="S4.SS2.p1.3.m2.1.1.3.3" xref="S4.SS2.p1.3.m2.1.1.3.3.cmml">0</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m2.1b"><apply id="S4.SS2.p1.3.m2.1.1.cmml" xref="S4.SS2.p1.3.m2.1.1"><equivalent id="S4.SS2.p1.3.m2.1.1.1.cmml" xref="S4.SS2.p1.3.m2.1.1.1"></equivalent><apply id="S4.SS2.p1.3.m2.1.1.2.cmml" xref="S4.SS2.p1.3.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m2.1.1.2.1.cmml" xref="S4.SS2.p1.3.m2.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.3.m2.1.1.2.2.cmml" xref="S4.SS2.p1.3.m2.1.1.2.2">𝜋</ci><ci id="S4.SS2.p1.3.m2.1.1.2.3.cmml" xref="S4.SS2.p1.3.m2.1.1.2.3">𝜃</ci></apply><apply id="S4.SS2.p1.3.m2.1.1.3.cmml" xref="S4.SS2.p1.3.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m2.1.1.3.1.cmml" xref="S4.SS2.p1.3.m2.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.3.m2.1.1.3.2.cmml" xref="S4.SS2.p1.3.m2.1.1.3.2">𝜋</ci><cn id="S4.SS2.p1.3.m2.1.1.3.3.cmml" type="integer" xref="S4.SS2.p1.3.m2.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m2.1c">\pi_{\theta}\equiv\pi_{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m2.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ≡ italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>) <cite class="ltx_cite ltx_citemacro_citep">(Martino et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib45" title="">2017</a>)</cite>.
They derive alternative estimators arising from alternative discrepancy measures and evaluate them on a synthetic task, showing promising results for a formulation that considers the <math alttext="\ell_{\infty}" class="ltx_Math" display="inline" id="S4.SS2.p1.4.m3.1"><semantics id="S4.SS2.p1.4.m3.1a"><msub id="S4.SS2.p1.4.m3.1.1" xref="S4.SS2.p1.4.m3.1.1.cmml"><mi id="S4.SS2.p1.4.m3.1.1.2" mathvariant="normal" xref="S4.SS2.p1.4.m3.1.1.2.cmml">ℓ</mi><mi id="S4.SS2.p1.4.m3.1.1.3" mathvariant="normal" xref="S4.SS2.p1.4.m3.1.1.3.cmml">∞</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m3.1b"><apply id="S4.SS2.p1.4.m3.1.1.cmml" xref="S4.SS2.p1.4.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m3.1.1.1.cmml" xref="S4.SS2.p1.4.m3.1.1">subscript</csymbol><ci id="S4.SS2.p1.4.m3.1.1.2.cmml" xref="S4.SS2.p1.4.m3.1.1.2">ℓ</ci><infinity id="S4.SS2.p1.4.m3.1.1.3.cmml" xref="S4.SS2.p1.4.m3.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m3.1c">\ell_{\infty}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.4.m3.1d">roman_ℓ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT</annotation></semantics></math>-norm instead of the <math alttext="\ell_{2}" class="ltx_Math" display="inline" id="S4.SS2.p1.5.m4.1"><semantics id="S4.SS2.p1.5.m4.1a"><msub id="S4.SS2.p1.5.m4.1.1" xref="S4.SS2.p1.5.m4.1.1.cmml"><mi id="S4.SS2.p1.5.m4.1.1.2" mathvariant="normal" xref="S4.SS2.p1.5.m4.1.1.2.cmml">ℓ</mi><mn id="S4.SS2.p1.5.m4.1.1.3" xref="S4.SS2.p1.5.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m4.1b"><apply id="S4.SS2.p1.5.m4.1.1.cmml" xref="S4.SS2.p1.5.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m4.1.1.1.cmml" xref="S4.SS2.p1.5.m4.1.1">subscript</csymbol><ci id="S4.SS2.p1.5.m4.1.1.2.cmml" xref="S4.SS2.p1.5.m4.1.1.2">ℓ</ci><cn id="S4.SS2.p1.5.m4.1.1.3.cmml" type="integer" xref="S4.SS2.p1.5.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m4.1c">\ell_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.5.m4.1d">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>-norm implied by the Euclidean distance measure (shown in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S4.E15" title="In 4.2. Estimating the Effective Sample Size ‣ 4. Improving the CRM Lower Bound ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">15</span></a>).
We can equivalently extend this to obtain a reward-dependent estimator in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S4.E16" title="In 4.2. Estimating the Effective Sample Size ‣ 4. Improving the CRM Lower Bound ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">16</span></a>:
<br class="ltx_break"/>
<span class="ltx_inline-block ltx_minipage ltx_align_middle" id="S4.SS2.p1.6.1" style="width:216.8pt;">
<span class="ltx_equation ltx_eqn_table" id="S4.E15">
<span><span class="ltx_equation ltx_eqn_row ltx_align_baseline">
<span class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(15)</span></span>
<span class="ltx_eqn_cell ltx_eqn_center_padleft"></span>
<span class="ltx_eqn_cell ltx_align_center"><math alttext="D^{\infty}_{N}=\frac{1}{\max_{i}\overline{w}_{i}}," class="ltx_Math" display="block" id="S4.E15.m1.1"><semantics id="S4.E15.m1.1a"><mrow id="S4.E15.m1.1.1.1" xref="S4.E15.m1.1.1.1.1.cmml"><mrow id="S4.E15.m1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.cmml"><msubsup id="S4.E15.m1.1.1.1.1.2" xref="S4.E15.m1.1.1.1.1.2.cmml"><mi id="S4.E15.m1.1.1.1.1.2.2.2" xref="S4.E15.m1.1.1.1.1.2.2.2.cmml">D</mi><mi id="S4.E15.m1.1.1.1.1.2.3" xref="S4.E15.m1.1.1.1.1.2.3.cmml">N</mi><mi id="S4.E15.m1.1.1.1.1.2.2.3" mathvariant="normal" xref="S4.E15.m1.1.1.1.1.2.2.3.cmml">∞</mi></msubsup><mo id="S4.E15.m1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.cmml">=</mo><mfrac id="S4.E15.m1.1.1.1.1.3" xref="S4.E15.m1.1.1.1.1.3.cmml"><mn id="S4.E15.m1.1.1.1.1.3.2" xref="S4.E15.m1.1.1.1.1.3.2.cmml">1</mn><mrow id="S4.E15.m1.1.1.1.1.3.3" xref="S4.E15.m1.1.1.1.1.3.3.cmml"><msub id="S4.E15.m1.1.1.1.1.3.3.1" xref="S4.E15.m1.1.1.1.1.3.3.1.cmml"><mi id="S4.E15.m1.1.1.1.1.3.3.1.2" xref="S4.E15.m1.1.1.1.1.3.3.1.2.cmml">max</mi><mi id="S4.E15.m1.1.1.1.1.3.3.1.3" xref="S4.E15.m1.1.1.1.1.3.3.1.3.cmml">i</mi></msub><mo id="S4.E15.m1.1.1.1.1.3.3a" lspace="0.167em" xref="S4.E15.m1.1.1.1.1.3.3.cmml">⁡</mo><msub id="S4.E15.m1.1.1.1.1.3.3.2" xref="S4.E15.m1.1.1.1.1.3.3.2.cmml"><mover accent="true" id="S4.E15.m1.1.1.1.1.3.3.2.2" xref="S4.E15.m1.1.1.1.1.3.3.2.2.cmml"><mi id="S4.E15.m1.1.1.1.1.3.3.2.2.2" xref="S4.E15.m1.1.1.1.1.3.3.2.2.2.cmml">w</mi><mo id="S4.E15.m1.1.1.1.1.3.3.2.2.1" xref="S4.E15.m1.1.1.1.1.3.3.2.2.1.cmml">¯</mo></mover><mi id="S4.E15.m1.1.1.1.1.3.3.2.3" xref="S4.E15.m1.1.1.1.1.3.3.2.3.cmml">i</mi></msub></mrow></mfrac></mrow><mo id="S4.E15.m1.1.1.1.2" xref="S4.E15.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E15.m1.1b"><apply id="S4.E15.m1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1"><eq id="S4.E15.m1.1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1.1"></eq><apply id="S4.E15.m1.1.1.1.1.2.cmml" xref="S4.E15.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.2.1.cmml" xref="S4.E15.m1.1.1.1.1.2">subscript</csymbol><apply id="S4.E15.m1.1.1.1.1.2.2.cmml" xref="S4.E15.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.2.2.1.cmml" xref="S4.E15.m1.1.1.1.1.2">superscript</csymbol><ci id="S4.E15.m1.1.1.1.1.2.2.2.cmml" xref="S4.E15.m1.1.1.1.1.2.2.2">𝐷</ci><infinity id="S4.E15.m1.1.1.1.1.2.2.3.cmml" xref="S4.E15.m1.1.1.1.1.2.2.3"></infinity></apply><ci id="S4.E15.m1.1.1.1.1.2.3.cmml" xref="S4.E15.m1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S4.E15.m1.1.1.1.1.3.cmml" xref="S4.E15.m1.1.1.1.1.3"><divide id="S4.E15.m1.1.1.1.1.3.1.cmml" xref="S4.E15.m1.1.1.1.1.3"></divide><cn id="S4.E15.m1.1.1.1.1.3.2.cmml" type="integer" xref="S4.E15.m1.1.1.1.1.3.2">1</cn><apply id="S4.E15.m1.1.1.1.1.3.3.cmml" xref="S4.E15.m1.1.1.1.1.3.3"><apply id="S4.E15.m1.1.1.1.1.3.3.1.cmml" xref="S4.E15.m1.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.3.3.1.1.cmml" xref="S4.E15.m1.1.1.1.1.3.3.1">subscript</csymbol><max id="S4.E15.m1.1.1.1.1.3.3.1.2.cmml" xref="S4.E15.m1.1.1.1.1.3.3.1.2"></max><ci id="S4.E15.m1.1.1.1.1.3.3.1.3.cmml" xref="S4.E15.m1.1.1.1.1.3.3.1.3">𝑖</ci></apply><apply id="S4.E15.m1.1.1.1.1.3.3.2.cmml" xref="S4.E15.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.3.3.2.1.cmml" xref="S4.E15.m1.1.1.1.1.3.3.2">subscript</csymbol><apply id="S4.E15.m1.1.1.1.1.3.3.2.2.cmml" xref="S4.E15.m1.1.1.1.1.3.3.2.2"><ci id="S4.E15.m1.1.1.1.1.3.3.2.2.1.cmml" xref="S4.E15.m1.1.1.1.1.3.3.2.2.1">¯</ci><ci id="S4.E15.m1.1.1.1.1.3.3.2.2.2.cmml" xref="S4.E15.m1.1.1.1.1.3.3.2.2.2">𝑤</ci></apply><ci id="S4.E15.m1.1.1.1.1.3.3.2.3.cmml" xref="S4.E15.m1.1.1.1.1.3.3.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E15.m1.1c">D^{\infty}_{N}=\frac{1}{\max_{i}\overline{w}_{i}},</annotation><annotation encoding="application/x-llamapun" id="S4.E15.m1.1d">italic_D start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG roman_max start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT over¯ start_ARG italic_w end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG ,</annotation></semantics></math></span>
<span class="ltx_eqn_cell ltx_eqn_center_padright"></span></span></span>
</span>
</span>
<span class="ltx_inline-block ltx_minipage ltx_align_middle" id="S4.SS2.p1.6.2" style="width:216.8pt;">
<span class="ltx_equation ltx_eqn_table" id="S4.E16">
<span><span class="ltx_equation ltx_eqn_row ltx_align_baseline">
<span class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(16)</span></span>
<span class="ltx_eqn_cell ltx_eqn_center_padleft"></span>
<span class="ltx_eqn_cell ltx_align_center"><math alttext="D^{R-\infty}_{N}=\frac{1}{\max_{i}\widetilde{w}_{i}}." class="ltx_Math" display="block" id="S4.E16.m1.1"><semantics id="S4.E16.m1.1a"><mrow id="S4.E16.m1.1.1.1" xref="S4.E16.m1.1.1.1.1.cmml"><mrow id="S4.E16.m1.1.1.1.1" xref="S4.E16.m1.1.1.1.1.cmml"><msubsup id="S4.E16.m1.1.1.1.1.2" xref="S4.E16.m1.1.1.1.1.2.cmml"><mi id="S4.E16.m1.1.1.1.1.2.2.2" xref="S4.E16.m1.1.1.1.1.2.2.2.cmml">D</mi><mi id="S4.E16.m1.1.1.1.1.2.3" xref="S4.E16.m1.1.1.1.1.2.3.cmml">N</mi><mrow id="S4.E16.m1.1.1.1.1.2.2.3" xref="S4.E16.m1.1.1.1.1.2.2.3.cmml"><mi id="S4.E16.m1.1.1.1.1.2.2.3.2" xref="S4.E16.m1.1.1.1.1.2.2.3.2.cmml">R</mi><mo id="S4.E16.m1.1.1.1.1.2.2.3.1" xref="S4.E16.m1.1.1.1.1.2.2.3.1.cmml">−</mo><mi id="S4.E16.m1.1.1.1.1.2.2.3.3" mathvariant="normal" xref="S4.E16.m1.1.1.1.1.2.2.3.3.cmml">∞</mi></mrow></msubsup><mo id="S4.E16.m1.1.1.1.1.1" xref="S4.E16.m1.1.1.1.1.1.cmml">=</mo><mfrac id="S4.E16.m1.1.1.1.1.3" xref="S4.E16.m1.1.1.1.1.3.cmml"><mn id="S4.E16.m1.1.1.1.1.3.2" xref="S4.E16.m1.1.1.1.1.3.2.cmml">1</mn><mrow id="S4.E16.m1.1.1.1.1.3.3" xref="S4.E16.m1.1.1.1.1.3.3.cmml"><msub id="S4.E16.m1.1.1.1.1.3.3.1" xref="S4.E16.m1.1.1.1.1.3.3.1.cmml"><mi id="S4.E16.m1.1.1.1.1.3.3.1.2" xref="S4.E16.m1.1.1.1.1.3.3.1.2.cmml">max</mi><mi id="S4.E16.m1.1.1.1.1.3.3.1.3" xref="S4.E16.m1.1.1.1.1.3.3.1.3.cmml">i</mi></msub><mo id="S4.E16.m1.1.1.1.1.3.3a" lspace="0.167em" xref="S4.E16.m1.1.1.1.1.3.3.cmml">⁡</mo><msub id="S4.E16.m1.1.1.1.1.3.3.2" xref="S4.E16.m1.1.1.1.1.3.3.2.cmml"><mover accent="true" id="S4.E16.m1.1.1.1.1.3.3.2.2" xref="S4.E16.m1.1.1.1.1.3.3.2.2.cmml"><mi id="S4.E16.m1.1.1.1.1.3.3.2.2.2" xref="S4.E16.m1.1.1.1.1.3.3.2.2.2.cmml">w</mi><mo id="S4.E16.m1.1.1.1.1.3.3.2.2.1" xref="S4.E16.m1.1.1.1.1.3.3.2.2.1.cmml">~</mo></mover><mi id="S4.E16.m1.1.1.1.1.3.3.2.3" xref="S4.E16.m1.1.1.1.1.3.3.2.3.cmml">i</mi></msub></mrow></mfrac></mrow><mo id="S4.E16.m1.1.1.1.2" lspace="0em" xref="S4.E16.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E16.m1.1b"><apply id="S4.E16.m1.1.1.1.1.cmml" xref="S4.E16.m1.1.1.1"><eq id="S4.E16.m1.1.1.1.1.1.cmml" xref="S4.E16.m1.1.1.1.1.1"></eq><apply id="S4.E16.m1.1.1.1.1.2.cmml" xref="S4.E16.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E16.m1.1.1.1.1.2.1.cmml" xref="S4.E16.m1.1.1.1.1.2">subscript</csymbol><apply id="S4.E16.m1.1.1.1.1.2.2.cmml" xref="S4.E16.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E16.m1.1.1.1.1.2.2.1.cmml" xref="S4.E16.m1.1.1.1.1.2">superscript</csymbol><ci id="S4.E16.m1.1.1.1.1.2.2.2.cmml" xref="S4.E16.m1.1.1.1.1.2.2.2">𝐷</ci><apply id="S4.E16.m1.1.1.1.1.2.2.3.cmml" xref="S4.E16.m1.1.1.1.1.2.2.3"><minus id="S4.E16.m1.1.1.1.1.2.2.3.1.cmml" xref="S4.E16.m1.1.1.1.1.2.2.3.1"></minus><ci id="S4.E16.m1.1.1.1.1.2.2.3.2.cmml" xref="S4.E16.m1.1.1.1.1.2.2.3.2">𝑅</ci><infinity id="S4.E16.m1.1.1.1.1.2.2.3.3.cmml" xref="S4.E16.m1.1.1.1.1.2.2.3.3"></infinity></apply></apply><ci id="S4.E16.m1.1.1.1.1.2.3.cmml" xref="S4.E16.m1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S4.E16.m1.1.1.1.1.3.cmml" xref="S4.E16.m1.1.1.1.1.3"><divide id="S4.E16.m1.1.1.1.1.3.1.cmml" xref="S4.E16.m1.1.1.1.1.3"></divide><cn id="S4.E16.m1.1.1.1.1.3.2.cmml" type="integer" xref="S4.E16.m1.1.1.1.1.3.2">1</cn><apply id="S4.E16.m1.1.1.1.1.3.3.cmml" xref="S4.E16.m1.1.1.1.1.3.3"><apply id="S4.E16.m1.1.1.1.1.3.3.1.cmml" xref="S4.E16.m1.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S4.E16.m1.1.1.1.1.3.3.1.1.cmml" xref="S4.E16.m1.1.1.1.1.3.3.1">subscript</csymbol><max id="S4.E16.m1.1.1.1.1.3.3.1.2.cmml" xref="S4.E16.m1.1.1.1.1.3.3.1.2"></max><ci id="S4.E16.m1.1.1.1.1.3.3.1.3.cmml" xref="S4.E16.m1.1.1.1.1.3.3.1.3">𝑖</ci></apply><apply id="S4.E16.m1.1.1.1.1.3.3.2.cmml" xref="S4.E16.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E16.m1.1.1.1.1.3.3.2.1.cmml" xref="S4.E16.m1.1.1.1.1.3.3.2">subscript</csymbol><apply id="S4.E16.m1.1.1.1.1.3.3.2.2.cmml" xref="S4.E16.m1.1.1.1.1.3.3.2.2"><ci id="S4.E16.m1.1.1.1.1.3.3.2.2.1.cmml" xref="S4.E16.m1.1.1.1.1.3.3.2.2.1">~</ci><ci id="S4.E16.m1.1.1.1.1.3.3.2.2.2.cmml" xref="S4.E16.m1.1.1.1.1.3.3.2.2.2">𝑤</ci></apply><ci id="S4.E16.m1.1.1.1.1.3.3.2.3.cmml" xref="S4.E16.m1.1.1.1.1.3.3.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E16.m1.1c">D^{R-\infty}_{N}=\frac{1}{\max_{i}\widetilde{w}_{i}}.</annotation><annotation encoding="application/x-llamapun" id="S4.E16.m1.1d">italic_D start_POSTSUPERSCRIPT italic_R - ∞ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG roman_max start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT over~ start_ARG italic_w end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG .</annotation></semantics></math></span>
<span class="ltx_eqn_cell ltx_eqn_center_padright"></span></span></span>
</span>
</span>
Note that the latter provides a novel estimator for the ESS, combining existing elements in the literature <cite class="ltx_cite ltx_citemacro_citep">(Owen, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib52" title="">2013</a>; Martino et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib45" title="">2017</a>)</cite>.
We can use any of these estimators to compute <math alttext="\widehat{\rm ESS},\widetilde{N}" class="ltx_Math" display="inline" id="S4.SS2.p1.6.m5.2"><semantics id="S4.SS2.p1.6.m5.2a"><mrow id="S4.SS2.p1.6.m5.2.3.2" xref="S4.SS2.p1.6.m5.2.3.1.cmml"><mover accent="true" id="S4.SS2.p1.6.m5.1.1" xref="S4.SS2.p1.6.m5.1.1.cmml"><mi id="S4.SS2.p1.6.m5.1.1.2" xref="S4.SS2.p1.6.m5.1.1.2.cmml">ESS</mi><mo id="S4.SS2.p1.6.m5.1.1.1" xref="S4.SS2.p1.6.m5.1.1.1.cmml">^</mo></mover><mo id="S4.SS2.p1.6.m5.2.3.2.1" xref="S4.SS2.p1.6.m5.2.3.1.cmml">,</mo><mover accent="true" id="S4.SS2.p1.6.m5.2.2" xref="S4.SS2.p1.6.m5.2.2.cmml"><mi id="S4.SS2.p1.6.m5.2.2.2" xref="S4.SS2.p1.6.m5.2.2.2.cmml">N</mi><mo id="S4.SS2.p1.6.m5.2.2.1" xref="S4.SS2.p1.6.m5.2.2.1.cmml">~</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m5.2b"><list id="S4.SS2.p1.6.m5.2.3.1.cmml" xref="S4.SS2.p1.6.m5.2.3.2"><apply id="S4.SS2.p1.6.m5.1.1.cmml" xref="S4.SS2.p1.6.m5.1.1"><ci id="S4.SS2.p1.6.m5.1.1.1.cmml" xref="S4.SS2.p1.6.m5.1.1.1">^</ci><ci id="S4.SS2.p1.6.m5.1.1.2.cmml" xref="S4.SS2.p1.6.m5.1.1.2">ESS</ci></apply><apply id="S4.SS2.p1.6.m5.2.2.cmml" xref="S4.SS2.p1.6.m5.2.2"><ci id="S4.SS2.p1.6.m5.2.2.1.cmml" xref="S4.SS2.p1.6.m5.2.2.1">~</ci><ci id="S4.SS2.p1.6.m5.2.2.2.cmml" xref="S4.SS2.p1.6.m5.2.2.2">𝑁</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m5.2c">\widehat{\rm ESS},\widetilde{N}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.6.m5.2d">over^ start_ARG roman_ESS end_ARG , over~ start_ARG italic_N end_ARG</annotation></semantics></math> and the resulting confidence interval in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S4.E12" title="In 4.1. Effective Sample Size Corrections ‣ 4. Improving the CRM Lower Bound ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">12</span></a>.
In Section <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S7.SS1" title="7.1. ESS Corrections &amp; Estimator Coverage (RQ1) ‣ 7. Experiments &amp; Discussion ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">7.1</span></a>, we empirically verify C.I. coverage for all mentioned ESS estimators.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Considerations for logging policies</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.3">Assuming stationarity, the optimal scalarisation weights will be deterministic.
That is, if we do not consider the explore–exploit trade-off that arises when learning over time, the density of the optimal policy <math alttext="\pi_{\theta^{\star}}" class="ltx_Math" display="inline" id="S5.p1.1.m1.1"><semantics id="S5.p1.1.m1.1a"><msub id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml"><mi id="S5.p1.1.m1.1.1.2" xref="S5.p1.1.m1.1.1.2.cmml">π</mi><msup id="S5.p1.1.m1.1.1.3" xref="S5.p1.1.m1.1.1.3.cmml"><mi id="S5.p1.1.m1.1.1.3.2" xref="S5.p1.1.m1.1.1.3.2.cmml">θ</mi><mo id="S5.p1.1.m1.1.1.3.3" xref="S5.p1.1.m1.1.1.3.3.cmml">⋆</mo></msup></msub><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><apply id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p1.1.m1.1.1.1.cmml" xref="S5.p1.1.m1.1.1">subscript</csymbol><ci id="S5.p1.1.m1.1.1.2.cmml" xref="S5.p1.1.m1.1.1.2">𝜋</ci><apply id="S5.p1.1.m1.1.1.3.cmml" xref="S5.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.p1.1.m1.1.1.3.1.cmml" xref="S5.p1.1.m1.1.1.3">superscript</csymbol><ci id="S5.p1.1.m1.1.1.3.2.cmml" xref="S5.p1.1.m1.1.1.3.2">𝜃</ci><ci id="S5.p1.1.m1.1.1.3.3.cmml" xref="S5.p1.1.m1.1.1.3.3">⋆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">\pi_{\theta^{\star}}</annotation><annotation encoding="application/x-llamapun" id="S5.p1.1.m1.1d">italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> will be a Dirac-delta centred at a single point.
It comes natural, however, to assume that <math alttext="\pi_{\theta^{\star}}" class="ltx_Math" display="inline" id="S5.p1.2.m2.1"><semantics id="S5.p1.2.m2.1a"><msub id="S5.p1.2.m2.1.1" xref="S5.p1.2.m2.1.1.cmml"><mi id="S5.p1.2.m2.1.1.2" xref="S5.p1.2.m2.1.1.2.cmml">π</mi><msup id="S5.p1.2.m2.1.1.3" xref="S5.p1.2.m2.1.1.3.cmml"><mi id="S5.p1.2.m2.1.1.3.2" xref="S5.p1.2.m2.1.1.3.2.cmml">θ</mi><mo id="S5.p1.2.m2.1.1.3.3" xref="S5.p1.2.m2.1.1.3.3.cmml">⋆</mo></msup></msub><annotation-xml encoding="MathML-Content" id="S5.p1.2.m2.1b"><apply id="S5.p1.2.m2.1.1.cmml" xref="S5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.p1.2.m2.1.1.1.cmml" xref="S5.p1.2.m2.1.1">subscript</csymbol><ci id="S5.p1.2.m2.1.1.2.cmml" xref="S5.p1.2.m2.1.1.2">𝜋</ci><apply id="S5.p1.2.m2.1.1.3.cmml" xref="S5.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S5.p1.2.m2.1.1.3.1.cmml" xref="S5.p1.2.m2.1.1.3">superscript</csymbol><ci id="S5.p1.2.m2.1.1.3.2.cmml" xref="S5.p1.2.m2.1.1.3.2">𝜃</ci><ci id="S5.p1.2.m2.1.1.3.3.cmml" xref="S5.p1.2.m2.1.1.3.3">⋆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.2.m2.1c">\pi_{\theta^{\star}}</annotation><annotation encoding="application/x-llamapun" id="S5.p1.2.m2.1d">italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> is not static and the optimal weights might drift over time.
As discussed in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S3" title="3. Multivariate Off-Policy Learning ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">3</span></a>, the <em class="ltx_emph ltx_font_italic" id="S5.p1.3.1">logging</em> policy that is responsible for collecting the samples we use to estimate Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S4.E12" title="In 4.1. Effective Sample Size Corrections ‣ 4. Improving the CRM Lower Bound ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">12</span></a> needs to be stochastic.
Thus, practitioners need to deploy a randomisation strategy that collects informative samples to allow for counterfactual estimation.
For general applications, <em class="ltx_emph ltx_font_italic" id="S5.p1.3.2">uniform</em> distributions are attractive.
Indeed, they are intuitive and easy to implement, and the constant logging propensities <math alttext="\pi_{0}(a)" class="ltx_Math" display="inline" id="S5.p1.3.m3.1"><semantics id="S5.p1.3.m3.1a"><mrow id="S5.p1.3.m3.1.2" xref="S5.p1.3.m3.1.2.cmml"><msub id="S5.p1.3.m3.1.2.2" xref="S5.p1.3.m3.1.2.2.cmml"><mi id="S5.p1.3.m3.1.2.2.2" xref="S5.p1.3.m3.1.2.2.2.cmml">π</mi><mn id="S5.p1.3.m3.1.2.2.3" xref="S5.p1.3.m3.1.2.2.3.cmml">0</mn></msub><mo id="S5.p1.3.m3.1.2.1" xref="S5.p1.3.m3.1.2.1.cmml">⁢</mo><mrow id="S5.p1.3.m3.1.2.3.2" xref="S5.p1.3.m3.1.2.cmml"><mo id="S5.p1.3.m3.1.2.3.2.1" stretchy="false" xref="S5.p1.3.m3.1.2.cmml">(</mo><mi id="S5.p1.3.m3.1.1" xref="S5.p1.3.m3.1.1.cmml">a</mi><mo id="S5.p1.3.m3.1.2.3.2.2" stretchy="false" xref="S5.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p1.3.m3.1b"><apply id="S5.p1.3.m3.1.2.cmml" xref="S5.p1.3.m3.1.2"><times id="S5.p1.3.m3.1.2.1.cmml" xref="S5.p1.3.m3.1.2.1"></times><apply id="S5.p1.3.m3.1.2.2.cmml" xref="S5.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="S5.p1.3.m3.1.2.2.1.cmml" xref="S5.p1.3.m3.1.2.2">subscript</csymbol><ci id="S5.p1.3.m3.1.2.2.2.cmml" xref="S5.p1.3.m3.1.2.2.2">𝜋</ci><cn id="S5.p1.3.m3.1.2.2.3.cmml" type="integer" xref="S5.p1.3.m3.1.2.2.3">0</cn></apply><ci id="S5.p1.3.m3.1.1.cmml" xref="S5.p1.3.m3.1.1">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.3.m3.1c">\pi_{0}(a)</annotation><annotation encoding="application/x-llamapun" id="S5.p1.3.m3.1d">italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a )</annotation></semantics></math> they imply significantly simplify both the modelling and engineering efforts required to run off-policy learning in production environments <cite class="ltx_cite ltx_citemacro_citep">(van den Akker et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib64" title="">2024</a>)</cite>.
As such, they are commonly used.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">Notwithstanding this, uniform distributions bring significant downsides as well.
In this Section, we wish to dissuade researchers and practitioners from using uniform logging policies in the multivariate continuous case, focusing on three arguments.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>Violating the common support assumption</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.4">Suppose we have a vector of production weights <math alttext="\bm{a_{0}}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S5.SS1.p1.1.m1.1"><semantics id="S5.SS1.p1.1.m1.1a"><mrow id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml"><msub id="S5.SS1.p1.1.m1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.2.cmml"><mi id="S5.SS1.p1.1.m1.1.1.2.2" xref="S5.SS1.p1.1.m1.1.1.2.2.cmml">𝒂</mi><mn id="S5.SS1.p1.1.m1.1.1.2.3" xref="S5.SS1.p1.1.m1.1.1.2.3.cmml">𝟎</mn></msub><mo id="S5.SS1.p1.1.m1.1.1.1" xref="S5.SS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S5.SS1.p1.1.m1.1.1.3" xref="S5.SS1.p1.1.m1.1.1.3.cmml"><mi id="S5.SS1.p1.1.m1.1.1.3.2" xref="S5.SS1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S5.SS1.p1.1.m1.1.1.3.3" xref="S5.SS1.p1.1.m1.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"><in id="S5.SS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1.1"></in><apply id="S5.SS1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p1.1.m1.1.1.2.1.cmml" xref="S5.SS1.p1.1.m1.1.1.2">subscript</csymbol><ci id="S5.SS1.p1.1.m1.1.1.2.2.cmml" xref="S5.SS1.p1.1.m1.1.1.2.2">𝒂</ci><cn id="S5.SS1.p1.1.m1.1.1.2.3.cmml" type="integer" xref="S5.SS1.p1.1.m1.1.1.2.3">0</cn></apply><apply id="S5.SS1.p1.1.m1.1.1.3.cmml" xref="S5.SS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p1.1.m1.1.1.3.1.cmml" xref="S5.SS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S5.SS1.p1.1.m1.1.1.3.2.cmml" xref="S5.SS1.p1.1.m1.1.1.3.2">ℝ</ci><ci id="S5.SS1.p1.1.m1.1.1.3.3.cmml" xref="S5.SS1.p1.1.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">\bm{a_{0}}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.1.m1.1d">bold_italic_a start_POSTSUBSCRIPT bold_0 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, around which we wish to design a logging policy.
Suppose we wish to explore a relative <math alttext="\epsilon\%" class="ltx_Math" display="inline" id="S5.SS1.p1.2.m2.1"><semantics id="S5.SS1.p1.2.m2.1a"><mrow id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml"><mi id="S5.SS1.p1.2.m2.1.1.2" xref="S5.SS1.p1.2.m2.1.1.2.cmml">ϵ</mi><mo id="S5.SS1.p1.2.m2.1.1.1" xref="S5.SS1.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><apply id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1"><csymbol cd="latexml" id="S5.SS1.p1.2.m2.1.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1.1">percent</csymbol><ci id="S5.SS1.p1.2.m2.1.1.2.cmml" xref="S5.SS1.p1.2.m2.1.1.2">italic-ϵ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">\epsilon\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.2.m2.1d">italic_ϵ %</annotation></semantics></math> range on either side of the current weights: hence we have <math alttext="\pi_{0}\equiv\mathcal{U}\left((1-\frac{\epsilon}{100})\bm{a_{0}};(1+\frac{%
\epsilon}{100})\bm{a_{0}}\right)" class="ltx_Math" display="inline" id="S5.SS1.p1.3.m3.2"><semantics id="S5.SS1.p1.3.m3.2a"><mrow id="S5.SS1.p1.3.m3.2.2" xref="S5.SS1.p1.3.m3.2.2.cmml"><msub id="S5.SS1.p1.3.m3.2.2.4" xref="S5.SS1.p1.3.m3.2.2.4.cmml"><mi id="S5.SS1.p1.3.m3.2.2.4.2" xref="S5.SS1.p1.3.m3.2.2.4.2.cmml">π</mi><mn id="S5.SS1.p1.3.m3.2.2.4.3" xref="S5.SS1.p1.3.m3.2.2.4.3.cmml">0</mn></msub><mo id="S5.SS1.p1.3.m3.2.2.3" xref="S5.SS1.p1.3.m3.2.2.3.cmml">≡</mo><mrow id="S5.SS1.p1.3.m3.2.2.2" xref="S5.SS1.p1.3.m3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p1.3.m3.2.2.2.4" xref="S5.SS1.p1.3.m3.2.2.2.4.cmml">𝒰</mi><mo id="S5.SS1.p1.3.m3.2.2.2.3" xref="S5.SS1.p1.3.m3.2.2.2.3.cmml">⁢</mo><mrow id="S5.SS1.p1.3.m3.2.2.2.2.2" xref="S5.SS1.p1.3.m3.2.2.2.2.3.cmml"><mo id="S5.SS1.p1.3.m3.2.2.2.2.2.3" xref="S5.SS1.p1.3.m3.2.2.2.2.3.cmml">(</mo><mrow id="S5.SS1.p1.3.m3.1.1.1.1.1.1" xref="S5.SS1.p1.3.m3.1.1.1.1.1.1.cmml"><mrow id="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1" xref="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml"><mo id="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1" xref="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml"><mn id="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.2" xref="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.1" xref="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mfrac id="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.3" xref="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.3.2" xref="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.3.2.cmml">ϵ</mi><mn id="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.3.3" xref="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.3.3.cmml">100</mn></mfrac></mrow><mo id="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S5.SS1.p1.3.m3.1.1.1.1.1.1.2" xref="S5.SS1.p1.3.m3.1.1.1.1.1.1.2.cmml">⁢</mo><msub id="S5.SS1.p1.3.m3.1.1.1.1.1.1.3" xref="S5.SS1.p1.3.m3.1.1.1.1.1.1.3.cmml"><mi id="S5.SS1.p1.3.m3.1.1.1.1.1.1.3.2" xref="S5.SS1.p1.3.m3.1.1.1.1.1.1.3.2.cmml">𝒂</mi><mn id="S5.SS1.p1.3.m3.1.1.1.1.1.1.3.3" xref="S5.SS1.p1.3.m3.1.1.1.1.1.1.3.3.cmml">𝟎</mn></msub></mrow><mo id="S5.SS1.p1.3.m3.2.2.2.2.2.4" xref="S5.SS1.p1.3.m3.2.2.2.2.3.cmml">;</mo><mrow id="S5.SS1.p1.3.m3.2.2.2.2.2.2" xref="S5.SS1.p1.3.m3.2.2.2.2.2.2.cmml"><mrow id="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1" xref="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1.cmml"><mo id="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.2" stretchy="false" xref="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1" xref="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1.cmml"><mn id="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1.2" xref="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1.2.cmml">1</mn><mo id="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1.1" xref="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1.1.cmml">+</mo><mfrac id="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1.3" xref="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1.3.cmml"><mi id="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1.3.2" xref="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1.3.2.cmml">ϵ</mi><mn id="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1.3.3" xref="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1.3.3.cmml">100</mn></mfrac></mrow><mo id="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.3" stretchy="false" xref="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="S5.SS1.p1.3.m3.2.2.2.2.2.2.2" xref="S5.SS1.p1.3.m3.2.2.2.2.2.2.2.cmml">⁢</mo><msub id="S5.SS1.p1.3.m3.2.2.2.2.2.2.3" xref="S5.SS1.p1.3.m3.2.2.2.2.2.2.3.cmml"><mi id="S5.SS1.p1.3.m3.2.2.2.2.2.2.3.2" xref="S5.SS1.p1.3.m3.2.2.2.2.2.2.3.2.cmml">𝒂</mi><mn id="S5.SS1.p1.3.m3.2.2.2.2.2.2.3.3" xref="S5.SS1.p1.3.m3.2.2.2.2.2.2.3.3.cmml">𝟎</mn></msub></mrow><mo id="S5.SS1.p1.3.m3.2.2.2.2.2.5" xref="S5.SS1.p1.3.m3.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.2b"><apply id="S5.SS1.p1.3.m3.2.2.cmml" xref="S5.SS1.p1.3.m3.2.2"><equivalent id="S5.SS1.p1.3.m3.2.2.3.cmml" xref="S5.SS1.p1.3.m3.2.2.3"></equivalent><apply id="S5.SS1.p1.3.m3.2.2.4.cmml" xref="S5.SS1.p1.3.m3.2.2.4"><csymbol cd="ambiguous" id="S5.SS1.p1.3.m3.2.2.4.1.cmml" xref="S5.SS1.p1.3.m3.2.2.4">subscript</csymbol><ci id="S5.SS1.p1.3.m3.2.2.4.2.cmml" xref="S5.SS1.p1.3.m3.2.2.4.2">𝜋</ci><cn id="S5.SS1.p1.3.m3.2.2.4.3.cmml" type="integer" xref="S5.SS1.p1.3.m3.2.2.4.3">0</cn></apply><apply id="S5.SS1.p1.3.m3.2.2.2.cmml" xref="S5.SS1.p1.3.m3.2.2.2"><times id="S5.SS1.p1.3.m3.2.2.2.3.cmml" xref="S5.SS1.p1.3.m3.2.2.2.3"></times><ci id="S5.SS1.p1.3.m3.2.2.2.4.cmml" xref="S5.SS1.p1.3.m3.2.2.2.4">𝒰</ci><list id="S5.SS1.p1.3.m3.2.2.2.2.3.cmml" xref="S5.SS1.p1.3.m3.2.2.2.2.2"><apply id="S5.SS1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1.1.1.1.1"><times id="S5.SS1.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="S5.SS1.p1.3.m3.1.1.1.1.1.1.2"></times><apply id="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1"><minus id="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.1"></minus><cn id="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.3"><divide id="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.3"></divide><ci id="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.3.2">italic-ϵ</ci><cn id="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S5.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.3.3">100</cn></apply></apply><apply id="S5.SS1.p1.3.m3.1.1.1.1.1.1.3.cmml" xref="S5.SS1.p1.3.m3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p1.3.m3.1.1.1.1.1.1.3.1.cmml" xref="S5.SS1.p1.3.m3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S5.SS1.p1.3.m3.1.1.1.1.1.1.3.2.cmml" xref="S5.SS1.p1.3.m3.1.1.1.1.1.1.3.2">𝒂</ci><cn id="S5.SS1.p1.3.m3.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S5.SS1.p1.3.m3.1.1.1.1.1.1.3.3">0</cn></apply></apply><apply id="S5.SS1.p1.3.m3.2.2.2.2.2.2.cmml" xref="S5.SS1.p1.3.m3.2.2.2.2.2.2"><times id="S5.SS1.p1.3.m3.2.2.2.2.2.2.2.cmml" xref="S5.SS1.p1.3.m3.2.2.2.2.2.2.2"></times><apply id="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1.cmml" xref="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1"><plus id="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1.1.cmml" xref="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1.1"></plus><cn id="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1.2.cmml" type="integer" xref="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1.2">1</cn><apply id="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1.3.cmml" xref="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1.3"><divide id="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1.3.1.cmml" xref="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1.3"></divide><ci id="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1.3.2.cmml" xref="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1.3.2">italic-ϵ</ci><cn id="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1.3.3.cmml" type="integer" xref="S5.SS1.p1.3.m3.2.2.2.2.2.2.1.1.1.3.3">100</cn></apply></apply><apply id="S5.SS1.p1.3.m3.2.2.2.2.2.2.3.cmml" xref="S5.SS1.p1.3.m3.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S5.SS1.p1.3.m3.2.2.2.2.2.2.3.1.cmml" xref="S5.SS1.p1.3.m3.2.2.2.2.2.2.3">subscript</csymbol><ci id="S5.SS1.p1.3.m3.2.2.2.2.2.2.3.2.cmml" xref="S5.SS1.p1.3.m3.2.2.2.2.2.2.3.2">𝒂</ci><cn id="S5.SS1.p1.3.m3.2.2.2.2.2.2.3.3.cmml" type="integer" xref="S5.SS1.p1.3.m3.2.2.2.2.2.2.3.3">0</cn></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.2c">\pi_{0}\equiv\mathcal{U}\left((1-\frac{\epsilon}{100})\bm{a_{0}};(1+\frac{%
\epsilon}{100})\bm{a_{0}}\right)</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.3.m3.2d">italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ≡ caligraphic_U ( ( 1 - divide start_ARG italic_ϵ end_ARG start_ARG 100 end_ARG ) bold_italic_a start_POSTSUBSCRIPT bold_0 end_POSTSUBSCRIPT ; ( 1 + divide start_ARG italic_ϵ end_ARG start_ARG 100 end_ARG ) bold_italic_a start_POSTSUBSCRIPT bold_0 end_POSTSUBSCRIPT )</annotation></semantics></math>.
Whilst a very natural choice, it should be noted that the logging policy now has a restricted domain.
One might assume that if we are merely learning a deterministic target policy, this is not hugely problematic.
Nevertheless, even when we learn deterministic policies, we need to resort to kernel smoothing techniques such as the Gaussian kernel introduced in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S3.E8" title="In 3. Multivariate Off-Policy Learning ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">8</span></a>.
The Gaussian kernel implies a domain over <math alttext="\mathcal{A}\equiv\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S5.SS1.p1.4.m4.1"><semantics id="S5.SS1.p1.4.m4.1a"><mrow id="S5.SS1.p1.4.m4.1.1" xref="S5.SS1.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p1.4.m4.1.1.2" xref="S5.SS1.p1.4.m4.1.1.2.cmml">𝒜</mi><mo id="S5.SS1.p1.4.m4.1.1.1" xref="S5.SS1.p1.4.m4.1.1.1.cmml">≡</mo><msup id="S5.SS1.p1.4.m4.1.1.3" xref="S5.SS1.p1.4.m4.1.1.3.cmml"><mi id="S5.SS1.p1.4.m4.1.1.3.2" xref="S5.SS1.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mi id="S5.SS1.p1.4.m4.1.1.3.3" xref="S5.SS1.p1.4.m4.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.4.m4.1b"><apply id="S5.SS1.p1.4.m4.1.1.cmml" xref="S5.SS1.p1.4.m4.1.1"><equivalent id="S5.SS1.p1.4.m4.1.1.1.cmml" xref="S5.SS1.p1.4.m4.1.1.1"></equivalent><ci id="S5.SS1.p1.4.m4.1.1.2.cmml" xref="S5.SS1.p1.4.m4.1.1.2">𝒜</ci><apply id="S5.SS1.p1.4.m4.1.1.3.cmml" xref="S5.SS1.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p1.4.m4.1.1.3.1.cmml" xref="S5.SS1.p1.4.m4.1.1.3">superscript</csymbol><ci id="S5.SS1.p1.4.m4.1.1.3.2.cmml" xref="S5.SS1.p1.4.m4.1.1.3.2">ℝ</ci><ci id="S5.SS1.p1.4.m4.1.1.3.3.cmml" xref="S5.SS1.p1.4.m4.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.4.m4.1c">\mathcal{A}\equiv\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.4.m4.1d">caligraphic_A ≡ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, and hence, the common support assumption is violated:</p>
<table class="ltx_equation ltx_eqn_table" id="S5.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\forall a\in\mathbb{R}^{d}_{\setminus\left[(1-\frac{\epsilon}{100})\bm{a_{0}};%
(1+\frac{\epsilon}{100})\bm{a_{0}}\right]}:\pi_{0}(a)=0\land\pi_{\theta}(a)&gt;0." class="ltx_Math" display="block" id="S5.Ex2.m1.5"><semantics id="S5.Ex2.m1.5a"><mrow id="S5.Ex2.m1.5.5.1" xref="S5.Ex2.m1.5.5.1.1.cmml"><mrow id="S5.Ex2.m1.5.5.1.1" xref="S5.Ex2.m1.5.5.1.1.cmml"><mrow id="S5.Ex2.m1.5.5.1.1.2" xref="S5.Ex2.m1.5.5.1.1.2.cmml"><mrow id="S5.Ex2.m1.5.5.1.1.2.2" xref="S5.Ex2.m1.5.5.1.1.2.2.cmml"><mo id="S5.Ex2.m1.5.5.1.1.2.2.1" rspace="0.167em" xref="S5.Ex2.m1.5.5.1.1.2.2.1.cmml">∀</mo><mi id="S5.Ex2.m1.5.5.1.1.2.2.2" xref="S5.Ex2.m1.5.5.1.1.2.2.2.cmml">a</mi></mrow><mo id="S5.Ex2.m1.5.5.1.1.2.1" xref="S5.Ex2.m1.5.5.1.1.2.1.cmml">∈</mo><msubsup id="S5.Ex2.m1.5.5.1.1.2.3" xref="S5.Ex2.m1.5.5.1.1.2.3.cmml"><mi id="S5.Ex2.m1.5.5.1.1.2.3.2.2" xref="S5.Ex2.m1.5.5.1.1.2.3.2.2.cmml">ℝ</mi><mrow id="S5.Ex2.m1.2.2.2" xref="S5.Ex2.m1.2.2.2.cmml"><mo id="S5.Ex2.m1.2.2.2a" rspace="0em" xref="S5.Ex2.m1.2.2.2.cmml">∖</mo><mrow id="S5.Ex2.m1.2.2.2.2.2" xref="S5.Ex2.m1.2.2.2.2.3.cmml"><mo id="S5.Ex2.m1.2.2.2.2.2.3" xref="S5.Ex2.m1.2.2.2.2.3.cmml">[</mo><mrow id="S5.Ex2.m1.1.1.1.1.1.1" xref="S5.Ex2.m1.1.1.1.1.1.1.cmml"><mrow id="S5.Ex2.m1.1.1.1.1.1.1.1.1" xref="S5.Ex2.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S5.Ex2.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S5.Ex2.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.Ex2.m1.1.1.1.1.1.1.1.1.1" xref="S5.Ex2.m1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S5.Ex2.m1.1.1.1.1.1.1.1.1.1.2" xref="S5.Ex2.m1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S5.Ex2.m1.1.1.1.1.1.1.1.1.1.1" xref="S5.Ex2.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mfrac id="S5.Ex2.m1.1.1.1.1.1.1.1.1.1.3" xref="S5.Ex2.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S5.Ex2.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S5.Ex2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">ϵ</mi><mn id="S5.Ex2.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S5.Ex2.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">100</mn></mfrac></mrow><mo id="S5.Ex2.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S5.Ex2.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S5.Ex2.m1.1.1.1.1.1.1.2" xref="S5.Ex2.m1.1.1.1.1.1.1.2.cmml">⁢</mo><msub id="S5.Ex2.m1.1.1.1.1.1.1.3" xref="S5.Ex2.m1.1.1.1.1.1.1.3.cmml"><mi id="S5.Ex2.m1.1.1.1.1.1.1.3.2" xref="S5.Ex2.m1.1.1.1.1.1.1.3.2.cmml">𝒂</mi><mn id="S5.Ex2.m1.1.1.1.1.1.1.3.3" xref="S5.Ex2.m1.1.1.1.1.1.1.3.3.cmml">𝟎</mn></msub></mrow><mo id="S5.Ex2.m1.2.2.2.2.2.4" xref="S5.Ex2.m1.2.2.2.2.3.cmml">;</mo><mrow id="S5.Ex2.m1.2.2.2.2.2.2" xref="S5.Ex2.m1.2.2.2.2.2.2.cmml"><mrow id="S5.Ex2.m1.2.2.2.2.2.2.1.1" xref="S5.Ex2.m1.2.2.2.2.2.2.1.1.1.cmml"><mo id="S5.Ex2.m1.2.2.2.2.2.2.1.1.2" stretchy="false" xref="S5.Ex2.m1.2.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S5.Ex2.m1.2.2.2.2.2.2.1.1.1" xref="S5.Ex2.m1.2.2.2.2.2.2.1.1.1.cmml"><mn id="S5.Ex2.m1.2.2.2.2.2.2.1.1.1.2" xref="S5.Ex2.m1.2.2.2.2.2.2.1.1.1.2.cmml">1</mn><mo id="S5.Ex2.m1.2.2.2.2.2.2.1.1.1.1" xref="S5.Ex2.m1.2.2.2.2.2.2.1.1.1.1.cmml">+</mo><mfrac id="S5.Ex2.m1.2.2.2.2.2.2.1.1.1.3" xref="S5.Ex2.m1.2.2.2.2.2.2.1.1.1.3.cmml"><mi id="S5.Ex2.m1.2.2.2.2.2.2.1.1.1.3.2" xref="S5.Ex2.m1.2.2.2.2.2.2.1.1.1.3.2.cmml">ϵ</mi><mn id="S5.Ex2.m1.2.2.2.2.2.2.1.1.1.3.3" xref="S5.Ex2.m1.2.2.2.2.2.2.1.1.1.3.3.cmml">100</mn></mfrac></mrow><mo id="S5.Ex2.m1.2.2.2.2.2.2.1.1.3" stretchy="false" xref="S5.Ex2.m1.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="S5.Ex2.m1.2.2.2.2.2.2.2" xref="S5.Ex2.m1.2.2.2.2.2.2.2.cmml">⁢</mo><msub id="S5.Ex2.m1.2.2.2.2.2.2.3" xref="S5.Ex2.m1.2.2.2.2.2.2.3.cmml"><mi id="S5.Ex2.m1.2.2.2.2.2.2.3.2" xref="S5.Ex2.m1.2.2.2.2.2.2.3.2.cmml">𝒂</mi><mn id="S5.Ex2.m1.2.2.2.2.2.2.3.3" xref="S5.Ex2.m1.2.2.2.2.2.2.3.3.cmml">𝟎</mn></msub></mrow><mo id="S5.Ex2.m1.2.2.2.2.2.5" xref="S5.Ex2.m1.2.2.2.2.3.cmml">]</mo></mrow></mrow><mi id="S5.Ex2.m1.5.5.1.1.2.3.2.3" xref="S5.Ex2.m1.5.5.1.1.2.3.2.3.cmml">d</mi></msubsup></mrow><mo id="S5.Ex2.m1.5.5.1.1.1" lspace="0.278em" rspace="0.278em" xref="S5.Ex2.m1.5.5.1.1.1.cmml">:</mo><mrow id="S5.Ex2.m1.5.5.1.1.3" xref="S5.Ex2.m1.5.5.1.1.3.cmml"><mrow id="S5.Ex2.m1.5.5.1.1.3.2" xref="S5.Ex2.m1.5.5.1.1.3.2.cmml"><msub id="S5.Ex2.m1.5.5.1.1.3.2.2" xref="S5.Ex2.m1.5.5.1.1.3.2.2.cmml"><mi id="S5.Ex2.m1.5.5.1.1.3.2.2.2" xref="S5.Ex2.m1.5.5.1.1.3.2.2.2.cmml">π</mi><mn id="S5.Ex2.m1.5.5.1.1.3.2.2.3" xref="S5.Ex2.m1.5.5.1.1.3.2.2.3.cmml">0</mn></msub><mo id="S5.Ex2.m1.5.5.1.1.3.2.1" xref="S5.Ex2.m1.5.5.1.1.3.2.1.cmml">⁢</mo><mrow id="S5.Ex2.m1.5.5.1.1.3.2.3.2" xref="S5.Ex2.m1.5.5.1.1.3.2.cmml"><mo id="S5.Ex2.m1.5.5.1.1.3.2.3.2.1" stretchy="false" xref="S5.Ex2.m1.5.5.1.1.3.2.cmml">(</mo><mi id="S5.Ex2.m1.3.3" xref="S5.Ex2.m1.3.3.cmml">a</mi><mo id="S5.Ex2.m1.5.5.1.1.3.2.3.2.2" stretchy="false" xref="S5.Ex2.m1.5.5.1.1.3.2.cmml">)</mo></mrow></mrow><mo id="S5.Ex2.m1.5.5.1.1.3.3" xref="S5.Ex2.m1.5.5.1.1.3.3.cmml">=</mo><mrow id="S5.Ex2.m1.5.5.1.1.3.4" xref="S5.Ex2.m1.5.5.1.1.3.4.cmml"><mn id="S5.Ex2.m1.5.5.1.1.3.4.2" xref="S5.Ex2.m1.5.5.1.1.3.4.2.cmml">0</mn><mo id="S5.Ex2.m1.5.5.1.1.3.4.1" xref="S5.Ex2.m1.5.5.1.1.3.4.1.cmml">∧</mo><mrow id="S5.Ex2.m1.5.5.1.1.3.4.3" xref="S5.Ex2.m1.5.5.1.1.3.4.3.cmml"><msub id="S5.Ex2.m1.5.5.1.1.3.4.3.2" xref="S5.Ex2.m1.5.5.1.1.3.4.3.2.cmml"><mi id="S5.Ex2.m1.5.5.1.1.3.4.3.2.2" xref="S5.Ex2.m1.5.5.1.1.3.4.3.2.2.cmml">π</mi><mi id="S5.Ex2.m1.5.5.1.1.3.4.3.2.3" xref="S5.Ex2.m1.5.5.1.1.3.4.3.2.3.cmml">θ</mi></msub><mo id="S5.Ex2.m1.5.5.1.1.3.4.3.1" xref="S5.Ex2.m1.5.5.1.1.3.4.3.1.cmml">⁢</mo><mrow id="S5.Ex2.m1.5.5.1.1.3.4.3.3.2" xref="S5.Ex2.m1.5.5.1.1.3.4.3.cmml"><mo id="S5.Ex2.m1.5.5.1.1.3.4.3.3.2.1" stretchy="false" xref="S5.Ex2.m1.5.5.1.1.3.4.3.cmml">(</mo><mi id="S5.Ex2.m1.4.4" xref="S5.Ex2.m1.4.4.cmml">a</mi><mo id="S5.Ex2.m1.5.5.1.1.3.4.3.3.2.2" stretchy="false" xref="S5.Ex2.m1.5.5.1.1.3.4.3.cmml">)</mo></mrow></mrow></mrow><mo id="S5.Ex2.m1.5.5.1.1.3.5" xref="S5.Ex2.m1.5.5.1.1.3.5.cmml">&gt;</mo><mn id="S5.Ex2.m1.5.5.1.1.3.6" xref="S5.Ex2.m1.5.5.1.1.3.6.cmml">0</mn></mrow></mrow><mo id="S5.Ex2.m1.5.5.1.2" lspace="0em" xref="S5.Ex2.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex2.m1.5b"><apply id="S5.Ex2.m1.5.5.1.1.cmml" xref="S5.Ex2.m1.5.5.1"><ci id="S5.Ex2.m1.5.5.1.1.1.cmml" xref="S5.Ex2.m1.5.5.1.1.1">:</ci><apply id="S5.Ex2.m1.5.5.1.1.2.cmml" xref="S5.Ex2.m1.5.5.1.1.2"><in id="S5.Ex2.m1.5.5.1.1.2.1.cmml" xref="S5.Ex2.m1.5.5.1.1.2.1"></in><apply id="S5.Ex2.m1.5.5.1.1.2.2.cmml" xref="S5.Ex2.m1.5.5.1.1.2.2"><csymbol cd="latexml" id="S5.Ex2.m1.5.5.1.1.2.2.1.cmml" xref="S5.Ex2.m1.5.5.1.1.2.2.1">for-all</csymbol><ci id="S5.Ex2.m1.5.5.1.1.2.2.2.cmml" xref="S5.Ex2.m1.5.5.1.1.2.2.2">𝑎</ci></apply><apply id="S5.Ex2.m1.5.5.1.1.2.3.cmml" xref="S5.Ex2.m1.5.5.1.1.2.3"><csymbol cd="ambiguous" id="S5.Ex2.m1.5.5.1.1.2.3.1.cmml" xref="S5.Ex2.m1.5.5.1.1.2.3">subscript</csymbol><apply id="S5.Ex2.m1.5.5.1.1.2.3.2.cmml" xref="S5.Ex2.m1.5.5.1.1.2.3"><csymbol cd="ambiguous" id="S5.Ex2.m1.5.5.1.1.2.3.2.1.cmml" xref="S5.Ex2.m1.5.5.1.1.2.3">superscript</csymbol><ci id="S5.Ex2.m1.5.5.1.1.2.3.2.2.cmml" xref="S5.Ex2.m1.5.5.1.1.2.3.2.2">ℝ</ci><ci id="S5.Ex2.m1.5.5.1.1.2.3.2.3.cmml" xref="S5.Ex2.m1.5.5.1.1.2.3.2.3">𝑑</ci></apply><apply id="S5.Ex2.m1.2.2.2.cmml" xref="S5.Ex2.m1.2.2.2"><setdiff id="S5.Ex2.m1.2.2.2.3.cmml" xref="S5.Ex2.m1.2.2.2"></setdiff><list id="S5.Ex2.m1.2.2.2.2.3.cmml" xref="S5.Ex2.m1.2.2.2.2.2"><apply id="S5.Ex2.m1.1.1.1.1.1.1.cmml" xref="S5.Ex2.m1.1.1.1.1.1.1"><times id="S5.Ex2.m1.1.1.1.1.1.1.2.cmml" xref="S5.Ex2.m1.1.1.1.1.1.1.2"></times><apply id="S5.Ex2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.Ex2.m1.1.1.1.1.1.1.1.1"><minus id="S5.Ex2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.Ex2.m1.1.1.1.1.1.1.1.1.1.1"></minus><cn id="S5.Ex2.m1.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S5.Ex2.m1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="S5.Ex2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S5.Ex2.m1.1.1.1.1.1.1.1.1.1.3"><divide id="S5.Ex2.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S5.Ex2.m1.1.1.1.1.1.1.1.1.1.3"></divide><ci id="S5.Ex2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S5.Ex2.m1.1.1.1.1.1.1.1.1.1.3.2">italic-ϵ</ci><cn id="S5.Ex2.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S5.Ex2.m1.1.1.1.1.1.1.1.1.1.3.3">100</cn></apply></apply><apply id="S5.Ex2.m1.1.1.1.1.1.1.3.cmml" xref="S5.Ex2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.Ex2.m1.1.1.1.1.1.1.3.1.cmml" xref="S5.Ex2.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S5.Ex2.m1.1.1.1.1.1.1.3.2.cmml" xref="S5.Ex2.m1.1.1.1.1.1.1.3.2">𝒂</ci><cn id="S5.Ex2.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S5.Ex2.m1.1.1.1.1.1.1.3.3">0</cn></apply></apply><apply id="S5.Ex2.m1.2.2.2.2.2.2.cmml" xref="S5.Ex2.m1.2.2.2.2.2.2"><times id="S5.Ex2.m1.2.2.2.2.2.2.2.cmml" xref="S5.Ex2.m1.2.2.2.2.2.2.2"></times><apply id="S5.Ex2.m1.2.2.2.2.2.2.1.1.1.cmml" xref="S5.Ex2.m1.2.2.2.2.2.2.1.1"><plus id="S5.Ex2.m1.2.2.2.2.2.2.1.1.1.1.cmml" xref="S5.Ex2.m1.2.2.2.2.2.2.1.1.1.1"></plus><cn id="S5.Ex2.m1.2.2.2.2.2.2.1.1.1.2.cmml" type="integer" xref="S5.Ex2.m1.2.2.2.2.2.2.1.1.1.2">1</cn><apply id="S5.Ex2.m1.2.2.2.2.2.2.1.1.1.3.cmml" xref="S5.Ex2.m1.2.2.2.2.2.2.1.1.1.3"><divide id="S5.Ex2.m1.2.2.2.2.2.2.1.1.1.3.1.cmml" xref="S5.Ex2.m1.2.2.2.2.2.2.1.1.1.3"></divide><ci id="S5.Ex2.m1.2.2.2.2.2.2.1.1.1.3.2.cmml" xref="S5.Ex2.m1.2.2.2.2.2.2.1.1.1.3.2">italic-ϵ</ci><cn id="S5.Ex2.m1.2.2.2.2.2.2.1.1.1.3.3.cmml" type="integer" xref="S5.Ex2.m1.2.2.2.2.2.2.1.1.1.3.3">100</cn></apply></apply><apply id="S5.Ex2.m1.2.2.2.2.2.2.3.cmml" xref="S5.Ex2.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S5.Ex2.m1.2.2.2.2.2.2.3.1.cmml" xref="S5.Ex2.m1.2.2.2.2.2.2.3">subscript</csymbol><ci id="S5.Ex2.m1.2.2.2.2.2.2.3.2.cmml" xref="S5.Ex2.m1.2.2.2.2.2.2.3.2">𝒂</ci><cn id="S5.Ex2.m1.2.2.2.2.2.2.3.3.cmml" type="integer" xref="S5.Ex2.m1.2.2.2.2.2.2.3.3">0</cn></apply></apply></list></apply></apply></apply><apply id="S5.Ex2.m1.5.5.1.1.3.cmml" xref="S5.Ex2.m1.5.5.1.1.3"><and id="S5.Ex2.m1.5.5.1.1.3a.cmml" xref="S5.Ex2.m1.5.5.1.1.3"></and><apply id="S5.Ex2.m1.5.5.1.1.3b.cmml" xref="S5.Ex2.m1.5.5.1.1.3"><eq id="S5.Ex2.m1.5.5.1.1.3.3.cmml" xref="S5.Ex2.m1.5.5.1.1.3.3"></eq><apply id="S5.Ex2.m1.5.5.1.1.3.2.cmml" xref="S5.Ex2.m1.5.5.1.1.3.2"><times id="S5.Ex2.m1.5.5.1.1.3.2.1.cmml" xref="S5.Ex2.m1.5.5.1.1.3.2.1"></times><apply id="S5.Ex2.m1.5.5.1.1.3.2.2.cmml" xref="S5.Ex2.m1.5.5.1.1.3.2.2"><csymbol cd="ambiguous" id="S5.Ex2.m1.5.5.1.1.3.2.2.1.cmml" xref="S5.Ex2.m1.5.5.1.1.3.2.2">subscript</csymbol><ci id="S5.Ex2.m1.5.5.1.1.3.2.2.2.cmml" xref="S5.Ex2.m1.5.5.1.1.3.2.2.2">𝜋</ci><cn id="S5.Ex2.m1.5.5.1.1.3.2.2.3.cmml" type="integer" xref="S5.Ex2.m1.5.5.1.1.3.2.2.3">0</cn></apply><ci id="S5.Ex2.m1.3.3.cmml" xref="S5.Ex2.m1.3.3">𝑎</ci></apply><apply id="S5.Ex2.m1.5.5.1.1.3.4.cmml" xref="S5.Ex2.m1.5.5.1.1.3.4"><and id="S5.Ex2.m1.5.5.1.1.3.4.1.cmml" xref="S5.Ex2.m1.5.5.1.1.3.4.1"></and><cn id="S5.Ex2.m1.5.5.1.1.3.4.2.cmml" type="integer" xref="S5.Ex2.m1.5.5.1.1.3.4.2">0</cn><apply id="S5.Ex2.m1.5.5.1.1.3.4.3.cmml" xref="S5.Ex2.m1.5.5.1.1.3.4.3"><times id="S5.Ex2.m1.5.5.1.1.3.4.3.1.cmml" xref="S5.Ex2.m1.5.5.1.1.3.4.3.1"></times><apply id="S5.Ex2.m1.5.5.1.1.3.4.3.2.cmml" xref="S5.Ex2.m1.5.5.1.1.3.4.3.2"><csymbol cd="ambiguous" id="S5.Ex2.m1.5.5.1.1.3.4.3.2.1.cmml" xref="S5.Ex2.m1.5.5.1.1.3.4.3.2">subscript</csymbol><ci id="S5.Ex2.m1.5.5.1.1.3.4.3.2.2.cmml" xref="S5.Ex2.m1.5.5.1.1.3.4.3.2.2">𝜋</ci><ci id="S5.Ex2.m1.5.5.1.1.3.4.3.2.3.cmml" xref="S5.Ex2.m1.5.5.1.1.3.4.3.2.3">𝜃</ci></apply><ci id="S5.Ex2.m1.4.4.cmml" xref="S5.Ex2.m1.4.4">𝑎</ci></apply></apply></apply><apply id="S5.Ex2.m1.5.5.1.1.3c.cmml" xref="S5.Ex2.m1.5.5.1.1.3"><gt id="S5.Ex2.m1.5.5.1.1.3.5.cmml" xref="S5.Ex2.m1.5.5.1.1.3.5"></gt><share href="https://arxiv.org/html/2405.02141v2#S5.Ex2.m1.5.5.1.1.3.4.cmml" id="S5.Ex2.m1.5.5.1.1.3d.cmml" xref="S5.Ex2.m1.5.5.1.1.3"></share><cn id="S5.Ex2.m1.5.5.1.1.3.6.cmml" type="integer" xref="S5.Ex2.m1.5.5.1.1.3.6">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex2.m1.5c">\forall a\in\mathbb{R}^{d}_{\setminus\left[(1-\frac{\epsilon}{100})\bm{a_{0}};%
(1+\frac{\epsilon}{100})\bm{a_{0}}\right]}:\pi_{0}(a)=0\land\pi_{\theta}(a)&gt;0.</annotation><annotation encoding="application/x-llamapun" id="S5.Ex2.m1.5d">∀ italic_a ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ∖ [ ( 1 - divide start_ARG italic_ϵ end_ARG start_ARG 100 end_ARG ) bold_italic_a start_POSTSUBSCRIPT bold_0 end_POSTSUBSCRIPT ; ( 1 + divide start_ARG italic_ϵ end_ARG start_ARG 100 end_ARG ) bold_italic_a start_POSTSUBSCRIPT bold_0 end_POSTSUBSCRIPT ] end_POSTSUBSCRIPT : italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a ) = 0 ∧ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ) &gt; 0 .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS1.p1.5">The main problem that this violation implies, is that the expected importance weight no longer equals 1 <cite class="ltx_cite ltx_citemacro_citep">(London and Joachims, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib42" title="">2022</a>)</cite>. Aside from the fact that this implies that the conventional IPS estimator is now biased, it brings along additional problems.
Indeed, baseline corrections now have a significant effect on the estimator, and should be avoided.
Usually, practitioners recentre observed rewards as a simple variance-reduction technique <cite class="ltx_cite ltx_citemacro_citep">(Gupta et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib22" title="">2024</a>)</cite>.
When the common support assumption holds, we can straightforwardly show that any constant scalar translation <math alttext="\beta" class="ltx_Math" display="inline" id="S5.SS1.p1.5.m1.1"><semantics id="S5.SS1.p1.5.m1.1a"><mi id="S5.SS1.p1.5.m1.1.1" xref="S5.SS1.p1.5.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.5.m1.1b"><ci id="S5.SS1.p1.5.m1.1.1.cmml" xref="S5.SS1.p1.5.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.5.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.5.m1.1d">italic_β</annotation></semantics></math> preserves the unbiasedness of the estimator:</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="S8.EGx2">
<tbody id="S5.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\beta+\mathop{\mathbb{E}}\limits_{a\sim\pi_{0}}\left[\frac{\pi_{%
\theta}(a)}{\pi_{0}(a)}(R-\beta)\right]=\beta+\mathop{\mathbb{E}}\limits_{a%
\sim\pi_{0}}\left[\frac{\pi_{\theta}(a)}{\pi_{0}(a)}R\right]-\mathop{\mathbb{E%
}}\limits_{a\sim\pi_{0}}\left[\frac{\pi_{\theta}(a)}{\pi_{0}(a)}\beta\right]" class="ltx_Math" display="block" id="S5.Ex3.m1.9"><semantics id="S5.Ex3.m1.9a"><mrow id="S5.Ex3.m1.9.9" xref="S5.Ex3.m1.9.9.cmml"><mrow id="S5.Ex3.m1.7.7.1" xref="S5.Ex3.m1.7.7.1.cmml"><mi id="S5.Ex3.m1.7.7.1.3" xref="S5.Ex3.m1.7.7.1.3.cmml">β</mi><mo id="S5.Ex3.m1.7.7.1.2" xref="S5.Ex3.m1.7.7.1.2.cmml">+</mo><mrow id="S5.Ex3.m1.7.7.1.1" xref="S5.Ex3.m1.7.7.1.1.cmml"><munder id="S5.Ex3.m1.7.7.1.1.2" xref="S5.Ex3.m1.7.7.1.1.2.cmml"><mo id="S5.Ex3.m1.7.7.1.1.2.2" lspace="0em" movablelimits="false" rspace="0em" xref="S5.Ex3.m1.7.7.1.1.2.2.cmml">𝔼</mo><mrow id="S5.Ex3.m1.7.7.1.1.2.3" xref="S5.Ex3.m1.7.7.1.1.2.3.cmml"><mi id="S5.Ex3.m1.7.7.1.1.2.3.2" xref="S5.Ex3.m1.7.7.1.1.2.3.2.cmml">a</mi><mo id="S5.Ex3.m1.7.7.1.1.2.3.1" xref="S5.Ex3.m1.7.7.1.1.2.3.1.cmml">∼</mo><msub id="S5.Ex3.m1.7.7.1.1.2.3.3" xref="S5.Ex3.m1.7.7.1.1.2.3.3.cmml"><mi id="S5.Ex3.m1.7.7.1.1.2.3.3.2" xref="S5.Ex3.m1.7.7.1.1.2.3.3.2.cmml">π</mi><mn id="S5.Ex3.m1.7.7.1.1.2.3.3.3" xref="S5.Ex3.m1.7.7.1.1.2.3.3.3.cmml">0</mn></msub></mrow></munder><mrow id="S5.Ex3.m1.7.7.1.1.1.1" xref="S5.Ex3.m1.7.7.1.1.1.2.cmml"><mo id="S5.Ex3.m1.7.7.1.1.1.1.2" xref="S5.Ex3.m1.7.7.1.1.1.2.1.cmml">[</mo><mrow id="S5.Ex3.m1.7.7.1.1.1.1.1" xref="S5.Ex3.m1.7.7.1.1.1.1.1.cmml"><mfrac id="S5.Ex3.m1.2.2" xref="S5.Ex3.m1.2.2.cmml"><mrow id="S5.Ex3.m1.1.1.1" xref="S5.Ex3.m1.1.1.1.cmml"><msub id="S5.Ex3.m1.1.1.1.3" xref="S5.Ex3.m1.1.1.1.3.cmml"><mi id="S5.Ex3.m1.1.1.1.3.2" xref="S5.Ex3.m1.1.1.1.3.2.cmml">π</mi><mi id="S5.Ex3.m1.1.1.1.3.3" xref="S5.Ex3.m1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S5.Ex3.m1.1.1.1.2" xref="S5.Ex3.m1.1.1.1.2.cmml">⁢</mo><mrow id="S5.Ex3.m1.1.1.1.4.2" xref="S5.Ex3.m1.1.1.1.cmml"><mo id="S5.Ex3.m1.1.1.1.4.2.1" stretchy="false" xref="S5.Ex3.m1.1.1.1.cmml">(</mo><mi id="S5.Ex3.m1.1.1.1.1" xref="S5.Ex3.m1.1.1.1.1.cmml">a</mi><mo id="S5.Ex3.m1.1.1.1.4.2.2" stretchy="false" xref="S5.Ex3.m1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S5.Ex3.m1.2.2.2" xref="S5.Ex3.m1.2.2.2.cmml"><msub id="S5.Ex3.m1.2.2.2.3" xref="S5.Ex3.m1.2.2.2.3.cmml"><mi id="S5.Ex3.m1.2.2.2.3.2" xref="S5.Ex3.m1.2.2.2.3.2.cmml">π</mi><mn id="S5.Ex3.m1.2.2.2.3.3" xref="S5.Ex3.m1.2.2.2.3.3.cmml">0</mn></msub><mo id="S5.Ex3.m1.2.2.2.2" xref="S5.Ex3.m1.2.2.2.2.cmml">⁢</mo><mrow id="S5.Ex3.m1.2.2.2.4.2" xref="S5.Ex3.m1.2.2.2.cmml"><mo id="S5.Ex3.m1.2.2.2.4.2.1" stretchy="false" xref="S5.Ex3.m1.2.2.2.cmml">(</mo><mi id="S5.Ex3.m1.2.2.2.1" xref="S5.Ex3.m1.2.2.2.1.cmml">a</mi><mo id="S5.Ex3.m1.2.2.2.4.2.2" stretchy="false" xref="S5.Ex3.m1.2.2.2.cmml">)</mo></mrow></mrow></mfrac><mo id="S5.Ex3.m1.7.7.1.1.1.1.1.2" xref="S5.Ex3.m1.7.7.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S5.Ex3.m1.7.7.1.1.1.1.1.1.1" xref="S5.Ex3.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mo id="S5.Ex3.m1.7.7.1.1.1.1.1.1.1.2" stretchy="false" xref="S5.Ex3.m1.7.7.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.Ex3.m1.7.7.1.1.1.1.1.1.1.1" xref="S5.Ex3.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mi id="S5.Ex3.m1.7.7.1.1.1.1.1.1.1.1.2" xref="S5.Ex3.m1.7.7.1.1.1.1.1.1.1.1.2.cmml">R</mi><mo id="S5.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S5.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S5.Ex3.m1.7.7.1.1.1.1.1.1.1.1.3" xref="S5.Ex3.m1.7.7.1.1.1.1.1.1.1.1.3.cmml">β</mi></mrow><mo id="S5.Ex3.m1.7.7.1.1.1.1.1.1.1.3" stretchy="false" xref="S5.Ex3.m1.7.7.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.Ex3.m1.7.7.1.1.1.1.3" xref="S5.Ex3.m1.7.7.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S5.Ex3.m1.9.9.4" xref="S5.Ex3.m1.9.9.4.cmml">=</mo><mrow id="S5.Ex3.m1.9.9.3" xref="S5.Ex3.m1.9.9.3.cmml"><mrow id="S5.Ex3.m1.8.8.2.1" xref="S5.Ex3.m1.8.8.2.1.cmml"><mi id="S5.Ex3.m1.8.8.2.1.3" xref="S5.Ex3.m1.8.8.2.1.3.cmml">β</mi><mo id="S5.Ex3.m1.8.8.2.1.2" xref="S5.Ex3.m1.8.8.2.1.2.cmml">+</mo><mrow id="S5.Ex3.m1.8.8.2.1.1" xref="S5.Ex3.m1.8.8.2.1.1.cmml"><munder id="S5.Ex3.m1.8.8.2.1.1.2" xref="S5.Ex3.m1.8.8.2.1.1.2.cmml"><mo id="S5.Ex3.m1.8.8.2.1.1.2.2" lspace="0em" movablelimits="false" rspace="0em" xref="S5.Ex3.m1.8.8.2.1.1.2.2.cmml">𝔼</mo><mrow id="S5.Ex3.m1.8.8.2.1.1.2.3" xref="S5.Ex3.m1.8.8.2.1.1.2.3.cmml"><mi id="S5.Ex3.m1.8.8.2.1.1.2.3.2" xref="S5.Ex3.m1.8.8.2.1.1.2.3.2.cmml">a</mi><mo id="S5.Ex3.m1.8.8.2.1.1.2.3.1" xref="S5.Ex3.m1.8.8.2.1.1.2.3.1.cmml">∼</mo><msub id="S5.Ex3.m1.8.8.2.1.1.2.3.3" xref="S5.Ex3.m1.8.8.2.1.1.2.3.3.cmml"><mi id="S5.Ex3.m1.8.8.2.1.1.2.3.3.2" xref="S5.Ex3.m1.8.8.2.1.1.2.3.3.2.cmml">π</mi><mn id="S5.Ex3.m1.8.8.2.1.1.2.3.3.3" xref="S5.Ex3.m1.8.8.2.1.1.2.3.3.3.cmml">0</mn></msub></mrow></munder><mrow id="S5.Ex3.m1.8.8.2.1.1.1.1" xref="S5.Ex3.m1.8.8.2.1.1.1.2.cmml"><mo id="S5.Ex3.m1.8.8.2.1.1.1.1.2" xref="S5.Ex3.m1.8.8.2.1.1.1.2.1.cmml">[</mo><mrow id="S5.Ex3.m1.8.8.2.1.1.1.1.1" xref="S5.Ex3.m1.8.8.2.1.1.1.1.1.cmml"><mfrac id="S5.Ex3.m1.4.4" xref="S5.Ex3.m1.4.4.cmml"><mrow id="S5.Ex3.m1.3.3.1" xref="S5.Ex3.m1.3.3.1.cmml"><msub id="S5.Ex3.m1.3.3.1.3" xref="S5.Ex3.m1.3.3.1.3.cmml"><mi id="S5.Ex3.m1.3.3.1.3.2" xref="S5.Ex3.m1.3.3.1.3.2.cmml">π</mi><mi id="S5.Ex3.m1.3.3.1.3.3" xref="S5.Ex3.m1.3.3.1.3.3.cmml">θ</mi></msub><mo id="S5.Ex3.m1.3.3.1.2" xref="S5.Ex3.m1.3.3.1.2.cmml">⁢</mo><mrow id="S5.Ex3.m1.3.3.1.4.2" xref="S5.Ex3.m1.3.3.1.cmml"><mo id="S5.Ex3.m1.3.3.1.4.2.1" stretchy="false" xref="S5.Ex3.m1.3.3.1.cmml">(</mo><mi id="S5.Ex3.m1.3.3.1.1" xref="S5.Ex3.m1.3.3.1.1.cmml">a</mi><mo id="S5.Ex3.m1.3.3.1.4.2.2" stretchy="false" xref="S5.Ex3.m1.3.3.1.cmml">)</mo></mrow></mrow><mrow id="S5.Ex3.m1.4.4.2" xref="S5.Ex3.m1.4.4.2.cmml"><msub id="S5.Ex3.m1.4.4.2.3" xref="S5.Ex3.m1.4.4.2.3.cmml"><mi id="S5.Ex3.m1.4.4.2.3.2" xref="S5.Ex3.m1.4.4.2.3.2.cmml">π</mi><mn id="S5.Ex3.m1.4.4.2.3.3" xref="S5.Ex3.m1.4.4.2.3.3.cmml">0</mn></msub><mo id="S5.Ex3.m1.4.4.2.2" xref="S5.Ex3.m1.4.4.2.2.cmml">⁢</mo><mrow id="S5.Ex3.m1.4.4.2.4.2" xref="S5.Ex3.m1.4.4.2.cmml"><mo id="S5.Ex3.m1.4.4.2.4.2.1" stretchy="false" xref="S5.Ex3.m1.4.4.2.cmml">(</mo><mi id="S5.Ex3.m1.4.4.2.1" xref="S5.Ex3.m1.4.4.2.1.cmml">a</mi><mo id="S5.Ex3.m1.4.4.2.4.2.2" stretchy="false" xref="S5.Ex3.m1.4.4.2.cmml">)</mo></mrow></mrow></mfrac><mo id="S5.Ex3.m1.8.8.2.1.1.1.1.1.1" xref="S5.Ex3.m1.8.8.2.1.1.1.1.1.1.cmml">⁢</mo><mi id="S5.Ex3.m1.8.8.2.1.1.1.1.1.2" xref="S5.Ex3.m1.8.8.2.1.1.1.1.1.2.cmml">R</mi></mrow><mo id="S5.Ex3.m1.8.8.2.1.1.1.1.3" xref="S5.Ex3.m1.8.8.2.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S5.Ex3.m1.9.9.3.3" xref="S5.Ex3.m1.9.9.3.3.cmml">−</mo><mrow id="S5.Ex3.m1.9.9.3.2" xref="S5.Ex3.m1.9.9.3.2.cmml"><munder id="S5.Ex3.m1.9.9.3.2.2" xref="S5.Ex3.m1.9.9.3.2.2.cmml"><mo id="S5.Ex3.m1.9.9.3.2.2.2" lspace="0em" movablelimits="false" rspace="0em" xref="S5.Ex3.m1.9.9.3.2.2.2.cmml">𝔼</mo><mrow id="S5.Ex3.m1.9.9.3.2.2.3" xref="S5.Ex3.m1.9.9.3.2.2.3.cmml"><mi id="S5.Ex3.m1.9.9.3.2.2.3.2" xref="S5.Ex3.m1.9.9.3.2.2.3.2.cmml">a</mi><mo id="S5.Ex3.m1.9.9.3.2.2.3.1" xref="S5.Ex3.m1.9.9.3.2.2.3.1.cmml">∼</mo><msub id="S5.Ex3.m1.9.9.3.2.2.3.3" xref="S5.Ex3.m1.9.9.3.2.2.3.3.cmml"><mi id="S5.Ex3.m1.9.9.3.2.2.3.3.2" xref="S5.Ex3.m1.9.9.3.2.2.3.3.2.cmml">π</mi><mn id="S5.Ex3.m1.9.9.3.2.2.3.3.3" xref="S5.Ex3.m1.9.9.3.2.2.3.3.3.cmml">0</mn></msub></mrow></munder><mrow id="S5.Ex3.m1.9.9.3.2.1.1" xref="S5.Ex3.m1.9.9.3.2.1.2.cmml"><mo id="S5.Ex3.m1.9.9.3.2.1.1.2" xref="S5.Ex3.m1.9.9.3.2.1.2.1.cmml">[</mo><mrow id="S5.Ex3.m1.9.9.3.2.1.1.1" xref="S5.Ex3.m1.9.9.3.2.1.1.1.cmml"><mfrac id="S5.Ex3.m1.6.6" xref="S5.Ex3.m1.6.6.cmml"><mrow id="S5.Ex3.m1.5.5.1" xref="S5.Ex3.m1.5.5.1.cmml"><msub id="S5.Ex3.m1.5.5.1.3" xref="S5.Ex3.m1.5.5.1.3.cmml"><mi id="S5.Ex3.m1.5.5.1.3.2" xref="S5.Ex3.m1.5.5.1.3.2.cmml">π</mi><mi id="S5.Ex3.m1.5.5.1.3.3" xref="S5.Ex3.m1.5.5.1.3.3.cmml">θ</mi></msub><mo id="S5.Ex3.m1.5.5.1.2" xref="S5.Ex3.m1.5.5.1.2.cmml">⁢</mo><mrow id="S5.Ex3.m1.5.5.1.4.2" xref="S5.Ex3.m1.5.5.1.cmml"><mo id="S5.Ex3.m1.5.5.1.4.2.1" stretchy="false" xref="S5.Ex3.m1.5.5.1.cmml">(</mo><mi id="S5.Ex3.m1.5.5.1.1" xref="S5.Ex3.m1.5.5.1.1.cmml">a</mi><mo id="S5.Ex3.m1.5.5.1.4.2.2" stretchy="false" xref="S5.Ex3.m1.5.5.1.cmml">)</mo></mrow></mrow><mrow id="S5.Ex3.m1.6.6.2" xref="S5.Ex3.m1.6.6.2.cmml"><msub id="S5.Ex3.m1.6.6.2.3" xref="S5.Ex3.m1.6.6.2.3.cmml"><mi id="S5.Ex3.m1.6.6.2.3.2" xref="S5.Ex3.m1.6.6.2.3.2.cmml">π</mi><mn id="S5.Ex3.m1.6.6.2.3.3" xref="S5.Ex3.m1.6.6.2.3.3.cmml">0</mn></msub><mo id="S5.Ex3.m1.6.6.2.2" xref="S5.Ex3.m1.6.6.2.2.cmml">⁢</mo><mrow id="S5.Ex3.m1.6.6.2.4.2" xref="S5.Ex3.m1.6.6.2.cmml"><mo id="S5.Ex3.m1.6.6.2.4.2.1" stretchy="false" xref="S5.Ex3.m1.6.6.2.cmml">(</mo><mi id="S5.Ex3.m1.6.6.2.1" xref="S5.Ex3.m1.6.6.2.1.cmml">a</mi><mo id="S5.Ex3.m1.6.6.2.4.2.2" stretchy="false" xref="S5.Ex3.m1.6.6.2.cmml">)</mo></mrow></mrow></mfrac><mo id="S5.Ex3.m1.9.9.3.2.1.1.1.1" xref="S5.Ex3.m1.9.9.3.2.1.1.1.1.cmml">⁢</mo><mi id="S5.Ex3.m1.9.9.3.2.1.1.1.2" xref="S5.Ex3.m1.9.9.3.2.1.1.1.2.cmml">β</mi></mrow><mo id="S5.Ex3.m1.9.9.3.2.1.1.3" xref="S5.Ex3.m1.9.9.3.2.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex3.m1.9b"><apply id="S5.Ex3.m1.9.9.cmml" xref="S5.Ex3.m1.9.9"><eq id="S5.Ex3.m1.9.9.4.cmml" xref="S5.Ex3.m1.9.9.4"></eq><apply id="S5.Ex3.m1.7.7.1.cmml" xref="S5.Ex3.m1.7.7.1"><plus id="S5.Ex3.m1.7.7.1.2.cmml" xref="S5.Ex3.m1.7.7.1.2"></plus><ci id="S5.Ex3.m1.7.7.1.3.cmml" xref="S5.Ex3.m1.7.7.1.3">𝛽</ci><apply id="S5.Ex3.m1.7.7.1.1.cmml" xref="S5.Ex3.m1.7.7.1.1"><apply id="S5.Ex3.m1.7.7.1.1.2.cmml" xref="S5.Ex3.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S5.Ex3.m1.7.7.1.1.2.1.cmml" xref="S5.Ex3.m1.7.7.1.1.2">subscript</csymbol><ci id="S5.Ex3.m1.7.7.1.1.2.2.cmml" xref="S5.Ex3.m1.7.7.1.1.2.2">𝔼</ci><apply id="S5.Ex3.m1.7.7.1.1.2.3.cmml" xref="S5.Ex3.m1.7.7.1.1.2.3"><csymbol cd="latexml" id="S5.Ex3.m1.7.7.1.1.2.3.1.cmml" xref="S5.Ex3.m1.7.7.1.1.2.3.1">similar-to</csymbol><ci id="S5.Ex3.m1.7.7.1.1.2.3.2.cmml" xref="S5.Ex3.m1.7.7.1.1.2.3.2">𝑎</ci><apply id="S5.Ex3.m1.7.7.1.1.2.3.3.cmml" xref="S5.Ex3.m1.7.7.1.1.2.3.3"><csymbol cd="ambiguous" id="S5.Ex3.m1.7.7.1.1.2.3.3.1.cmml" xref="S5.Ex3.m1.7.7.1.1.2.3.3">subscript</csymbol><ci id="S5.Ex3.m1.7.7.1.1.2.3.3.2.cmml" xref="S5.Ex3.m1.7.7.1.1.2.3.3.2">𝜋</ci><cn id="S5.Ex3.m1.7.7.1.1.2.3.3.3.cmml" type="integer" xref="S5.Ex3.m1.7.7.1.1.2.3.3.3">0</cn></apply></apply></apply><apply id="S5.Ex3.m1.7.7.1.1.1.2.cmml" xref="S5.Ex3.m1.7.7.1.1.1.1"><csymbol cd="latexml" id="S5.Ex3.m1.7.7.1.1.1.2.1.cmml" xref="S5.Ex3.m1.7.7.1.1.1.1.2">delimited-[]</csymbol><apply id="S5.Ex3.m1.7.7.1.1.1.1.1.cmml" xref="S5.Ex3.m1.7.7.1.1.1.1.1"><times id="S5.Ex3.m1.7.7.1.1.1.1.1.2.cmml" xref="S5.Ex3.m1.7.7.1.1.1.1.1.2"></times><apply id="S5.Ex3.m1.2.2.cmml" xref="S5.Ex3.m1.2.2"><divide id="S5.Ex3.m1.2.2.3.cmml" xref="S5.Ex3.m1.2.2"></divide><apply id="S5.Ex3.m1.1.1.1.cmml" xref="S5.Ex3.m1.1.1.1"><times id="S5.Ex3.m1.1.1.1.2.cmml" xref="S5.Ex3.m1.1.1.1.2"></times><apply id="S5.Ex3.m1.1.1.1.3.cmml" xref="S5.Ex3.m1.1.1.1.3"><csymbol cd="ambiguous" id="S5.Ex3.m1.1.1.1.3.1.cmml" xref="S5.Ex3.m1.1.1.1.3">subscript</csymbol><ci id="S5.Ex3.m1.1.1.1.3.2.cmml" xref="S5.Ex3.m1.1.1.1.3.2">𝜋</ci><ci id="S5.Ex3.m1.1.1.1.3.3.cmml" xref="S5.Ex3.m1.1.1.1.3.3">𝜃</ci></apply><ci id="S5.Ex3.m1.1.1.1.1.cmml" xref="S5.Ex3.m1.1.1.1.1">𝑎</ci></apply><apply id="S5.Ex3.m1.2.2.2.cmml" xref="S5.Ex3.m1.2.2.2"><times id="S5.Ex3.m1.2.2.2.2.cmml" xref="S5.Ex3.m1.2.2.2.2"></times><apply id="S5.Ex3.m1.2.2.2.3.cmml" xref="S5.Ex3.m1.2.2.2.3"><csymbol cd="ambiguous" id="S5.Ex3.m1.2.2.2.3.1.cmml" xref="S5.Ex3.m1.2.2.2.3">subscript</csymbol><ci id="S5.Ex3.m1.2.2.2.3.2.cmml" xref="S5.Ex3.m1.2.2.2.3.2">𝜋</ci><cn id="S5.Ex3.m1.2.2.2.3.3.cmml" type="integer" xref="S5.Ex3.m1.2.2.2.3.3">0</cn></apply><ci id="S5.Ex3.m1.2.2.2.1.cmml" xref="S5.Ex3.m1.2.2.2.1">𝑎</ci></apply></apply><apply id="S5.Ex3.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S5.Ex3.m1.7.7.1.1.1.1.1.1.1"><minus id="S5.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="S5.Ex3.m1.7.7.1.1.1.1.1.1.1.1.1"></minus><ci id="S5.Ex3.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="S5.Ex3.m1.7.7.1.1.1.1.1.1.1.1.2">𝑅</ci><ci id="S5.Ex3.m1.7.7.1.1.1.1.1.1.1.1.3.cmml" xref="S5.Ex3.m1.7.7.1.1.1.1.1.1.1.1.3">𝛽</ci></apply></apply></apply></apply></apply><apply id="S5.Ex3.m1.9.9.3.cmml" xref="S5.Ex3.m1.9.9.3"><minus id="S5.Ex3.m1.9.9.3.3.cmml" xref="S5.Ex3.m1.9.9.3.3"></minus><apply id="S5.Ex3.m1.8.8.2.1.cmml" xref="S5.Ex3.m1.8.8.2.1"><plus id="S5.Ex3.m1.8.8.2.1.2.cmml" xref="S5.Ex3.m1.8.8.2.1.2"></plus><ci id="S5.Ex3.m1.8.8.2.1.3.cmml" xref="S5.Ex3.m1.8.8.2.1.3">𝛽</ci><apply id="S5.Ex3.m1.8.8.2.1.1.cmml" xref="S5.Ex3.m1.8.8.2.1.1"><apply id="S5.Ex3.m1.8.8.2.1.1.2.cmml" xref="S5.Ex3.m1.8.8.2.1.1.2"><csymbol cd="ambiguous" id="S5.Ex3.m1.8.8.2.1.1.2.1.cmml" xref="S5.Ex3.m1.8.8.2.1.1.2">subscript</csymbol><ci id="S5.Ex3.m1.8.8.2.1.1.2.2.cmml" xref="S5.Ex3.m1.8.8.2.1.1.2.2">𝔼</ci><apply id="S5.Ex3.m1.8.8.2.1.1.2.3.cmml" xref="S5.Ex3.m1.8.8.2.1.1.2.3"><csymbol cd="latexml" id="S5.Ex3.m1.8.8.2.1.1.2.3.1.cmml" xref="S5.Ex3.m1.8.8.2.1.1.2.3.1">similar-to</csymbol><ci id="S5.Ex3.m1.8.8.2.1.1.2.3.2.cmml" xref="S5.Ex3.m1.8.8.2.1.1.2.3.2">𝑎</ci><apply id="S5.Ex3.m1.8.8.2.1.1.2.3.3.cmml" xref="S5.Ex3.m1.8.8.2.1.1.2.3.3"><csymbol cd="ambiguous" id="S5.Ex3.m1.8.8.2.1.1.2.3.3.1.cmml" xref="S5.Ex3.m1.8.8.2.1.1.2.3.3">subscript</csymbol><ci id="S5.Ex3.m1.8.8.2.1.1.2.3.3.2.cmml" xref="S5.Ex3.m1.8.8.2.1.1.2.3.3.2">𝜋</ci><cn id="S5.Ex3.m1.8.8.2.1.1.2.3.3.3.cmml" type="integer" xref="S5.Ex3.m1.8.8.2.1.1.2.3.3.3">0</cn></apply></apply></apply><apply id="S5.Ex3.m1.8.8.2.1.1.1.2.cmml" xref="S5.Ex3.m1.8.8.2.1.1.1.1"><csymbol cd="latexml" id="S5.Ex3.m1.8.8.2.1.1.1.2.1.cmml" xref="S5.Ex3.m1.8.8.2.1.1.1.1.2">delimited-[]</csymbol><apply id="S5.Ex3.m1.8.8.2.1.1.1.1.1.cmml" xref="S5.Ex3.m1.8.8.2.1.1.1.1.1"><times id="S5.Ex3.m1.8.8.2.1.1.1.1.1.1.cmml" xref="S5.Ex3.m1.8.8.2.1.1.1.1.1.1"></times><apply id="S5.Ex3.m1.4.4.cmml" xref="S5.Ex3.m1.4.4"><divide id="S5.Ex3.m1.4.4.3.cmml" xref="S5.Ex3.m1.4.4"></divide><apply id="S5.Ex3.m1.3.3.1.cmml" xref="S5.Ex3.m1.3.3.1"><times id="S5.Ex3.m1.3.3.1.2.cmml" xref="S5.Ex3.m1.3.3.1.2"></times><apply id="S5.Ex3.m1.3.3.1.3.cmml" xref="S5.Ex3.m1.3.3.1.3"><csymbol cd="ambiguous" id="S5.Ex3.m1.3.3.1.3.1.cmml" xref="S5.Ex3.m1.3.3.1.3">subscript</csymbol><ci id="S5.Ex3.m1.3.3.1.3.2.cmml" xref="S5.Ex3.m1.3.3.1.3.2">𝜋</ci><ci id="S5.Ex3.m1.3.3.1.3.3.cmml" xref="S5.Ex3.m1.3.3.1.3.3">𝜃</ci></apply><ci id="S5.Ex3.m1.3.3.1.1.cmml" xref="S5.Ex3.m1.3.3.1.1">𝑎</ci></apply><apply id="S5.Ex3.m1.4.4.2.cmml" xref="S5.Ex3.m1.4.4.2"><times id="S5.Ex3.m1.4.4.2.2.cmml" xref="S5.Ex3.m1.4.4.2.2"></times><apply id="S5.Ex3.m1.4.4.2.3.cmml" xref="S5.Ex3.m1.4.4.2.3"><csymbol cd="ambiguous" id="S5.Ex3.m1.4.4.2.3.1.cmml" xref="S5.Ex3.m1.4.4.2.3">subscript</csymbol><ci id="S5.Ex3.m1.4.4.2.3.2.cmml" xref="S5.Ex3.m1.4.4.2.3.2">𝜋</ci><cn id="S5.Ex3.m1.4.4.2.3.3.cmml" type="integer" xref="S5.Ex3.m1.4.4.2.3.3">0</cn></apply><ci id="S5.Ex3.m1.4.4.2.1.cmml" xref="S5.Ex3.m1.4.4.2.1">𝑎</ci></apply></apply><ci id="S5.Ex3.m1.8.8.2.1.1.1.1.1.2.cmml" xref="S5.Ex3.m1.8.8.2.1.1.1.1.1.2">𝑅</ci></apply></apply></apply></apply><apply id="S5.Ex3.m1.9.9.3.2.cmml" xref="S5.Ex3.m1.9.9.3.2"><apply id="S5.Ex3.m1.9.9.3.2.2.cmml" xref="S5.Ex3.m1.9.9.3.2.2"><csymbol cd="ambiguous" id="S5.Ex3.m1.9.9.3.2.2.1.cmml" xref="S5.Ex3.m1.9.9.3.2.2">subscript</csymbol><ci id="S5.Ex3.m1.9.9.3.2.2.2.cmml" xref="S5.Ex3.m1.9.9.3.2.2.2">𝔼</ci><apply id="S5.Ex3.m1.9.9.3.2.2.3.cmml" xref="S5.Ex3.m1.9.9.3.2.2.3"><csymbol cd="latexml" id="S5.Ex3.m1.9.9.3.2.2.3.1.cmml" xref="S5.Ex3.m1.9.9.3.2.2.3.1">similar-to</csymbol><ci id="S5.Ex3.m1.9.9.3.2.2.3.2.cmml" xref="S5.Ex3.m1.9.9.3.2.2.3.2">𝑎</ci><apply id="S5.Ex3.m1.9.9.3.2.2.3.3.cmml" xref="S5.Ex3.m1.9.9.3.2.2.3.3"><csymbol cd="ambiguous" id="S5.Ex3.m1.9.9.3.2.2.3.3.1.cmml" xref="S5.Ex3.m1.9.9.3.2.2.3.3">subscript</csymbol><ci id="S5.Ex3.m1.9.9.3.2.2.3.3.2.cmml" xref="S5.Ex3.m1.9.9.3.2.2.3.3.2">𝜋</ci><cn id="S5.Ex3.m1.9.9.3.2.2.3.3.3.cmml" type="integer" xref="S5.Ex3.m1.9.9.3.2.2.3.3.3">0</cn></apply></apply></apply><apply id="S5.Ex3.m1.9.9.3.2.1.2.cmml" xref="S5.Ex3.m1.9.9.3.2.1.1"><csymbol cd="latexml" id="S5.Ex3.m1.9.9.3.2.1.2.1.cmml" xref="S5.Ex3.m1.9.9.3.2.1.1.2">delimited-[]</csymbol><apply id="S5.Ex3.m1.9.9.3.2.1.1.1.cmml" xref="S5.Ex3.m1.9.9.3.2.1.1.1"><times id="S5.Ex3.m1.9.9.3.2.1.1.1.1.cmml" xref="S5.Ex3.m1.9.9.3.2.1.1.1.1"></times><apply id="S5.Ex3.m1.6.6.cmml" xref="S5.Ex3.m1.6.6"><divide id="S5.Ex3.m1.6.6.3.cmml" xref="S5.Ex3.m1.6.6"></divide><apply id="S5.Ex3.m1.5.5.1.cmml" xref="S5.Ex3.m1.5.5.1"><times id="S5.Ex3.m1.5.5.1.2.cmml" xref="S5.Ex3.m1.5.5.1.2"></times><apply id="S5.Ex3.m1.5.5.1.3.cmml" xref="S5.Ex3.m1.5.5.1.3"><csymbol cd="ambiguous" id="S5.Ex3.m1.5.5.1.3.1.cmml" xref="S5.Ex3.m1.5.5.1.3">subscript</csymbol><ci id="S5.Ex3.m1.5.5.1.3.2.cmml" xref="S5.Ex3.m1.5.5.1.3.2">𝜋</ci><ci id="S5.Ex3.m1.5.5.1.3.3.cmml" xref="S5.Ex3.m1.5.5.1.3.3">𝜃</ci></apply><ci id="S5.Ex3.m1.5.5.1.1.cmml" xref="S5.Ex3.m1.5.5.1.1">𝑎</ci></apply><apply id="S5.Ex3.m1.6.6.2.cmml" xref="S5.Ex3.m1.6.6.2"><times id="S5.Ex3.m1.6.6.2.2.cmml" xref="S5.Ex3.m1.6.6.2.2"></times><apply id="S5.Ex3.m1.6.6.2.3.cmml" xref="S5.Ex3.m1.6.6.2.3"><csymbol cd="ambiguous" id="S5.Ex3.m1.6.6.2.3.1.cmml" xref="S5.Ex3.m1.6.6.2.3">subscript</csymbol><ci id="S5.Ex3.m1.6.6.2.3.2.cmml" xref="S5.Ex3.m1.6.6.2.3.2">𝜋</ci><cn id="S5.Ex3.m1.6.6.2.3.3.cmml" type="integer" xref="S5.Ex3.m1.6.6.2.3.3">0</cn></apply><ci id="S5.Ex3.m1.6.6.2.1.cmml" xref="S5.Ex3.m1.6.6.2.1">𝑎</ci></apply></apply><ci id="S5.Ex3.m1.9.9.3.2.1.1.1.2.cmml" xref="S5.Ex3.m1.9.9.3.2.1.1.1.2">𝛽</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex3.m1.9c">\displaystyle\beta+\mathop{\mathbb{E}}\limits_{a\sim\pi_{0}}\left[\frac{\pi_{%
\theta}(a)}{\pi_{0}(a)}(R-\beta)\right]=\beta+\mathop{\mathbb{E}}\limits_{a%
\sim\pi_{0}}\left[\frac{\pi_{\theta}(a)}{\pi_{0}(a)}R\right]-\mathop{\mathbb{E%
}}\limits_{a\sim\pi_{0}}\left[\frac{\pi_{\theta}(a)}{\pi_{0}(a)}\beta\right]</annotation><annotation encoding="application/x-llamapun" id="S5.Ex3.m1.9d">italic_β + blackboard_E start_POSTSUBSCRIPT italic_a ∼ italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a ) end_ARG ( italic_R - italic_β ) ] = italic_β + blackboard_E start_POSTSUBSCRIPT italic_a ∼ italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a ) end_ARG italic_R ] - blackboard_E start_POSTSUBSCRIPT italic_a ∼ italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a ) end_ARG italic_β ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S5.E17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(17)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle=\beta+\mathop{\mathbb{E}}\limits_{a\sim\pi_{0}}\left[\frac{\pi_{%
\theta}(a)}{\pi_{0}(a)}R\right]-\beta\underbrace{\mathop{\mathbb{E}}\limits_{a%
\sim\pi_{0}}\left[\frac{\pi_{\theta}(a)}{\pi_{0}(a)}\right]}_{{\color[rgb]{%
0,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{0,0,0}\nequiv 1}}{\color[rgb]{%
0,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{0,0,0}\neq}\mathop{\mathbb{E}}%
\limits_{a\sim\pi_{0}}\left[\frac{\pi_{\theta}(a)}{\pi_{0}(a)}R\right]." class="ltx_Math" display="block" id="S5.E17.m1.7"><semantics id="S5.E17.m1.7a"><mrow id="S5.E17.m1.7.7.1" xref="S5.E17.m1.7.7.1.1.cmml"><mrow id="S5.E17.m1.7.7.1.1" xref="S5.E17.m1.7.7.1.1.cmml"><mi id="S5.E17.m1.7.7.1.1.4" xref="S5.E17.m1.7.7.1.1.4.cmml"></mi><mo id="S5.E17.m1.7.7.1.1.5" xref="S5.E17.m1.7.7.1.1.5.cmml">=</mo><mrow id="S5.E17.m1.7.7.1.1.1" xref="S5.E17.m1.7.7.1.1.1.cmml"><mrow id="S5.E17.m1.7.7.1.1.1.1" xref="S5.E17.m1.7.7.1.1.1.1.cmml"><mi id="S5.E17.m1.7.7.1.1.1.1.3" xref="S5.E17.m1.7.7.1.1.1.1.3.cmml">β</mi><mo id="S5.E17.m1.7.7.1.1.1.1.2" xref="S5.E17.m1.7.7.1.1.1.1.2.cmml">+</mo><mrow id="S5.E17.m1.7.7.1.1.1.1.1" xref="S5.E17.m1.7.7.1.1.1.1.1.cmml"><munder id="S5.E17.m1.7.7.1.1.1.1.1.2" xref="S5.E17.m1.7.7.1.1.1.1.1.2.cmml"><mo id="S5.E17.m1.7.7.1.1.1.1.1.2.2" lspace="0em" movablelimits="false" rspace="0em" xref="S5.E17.m1.7.7.1.1.1.1.1.2.2.cmml">𝔼</mo><mrow id="S5.E17.m1.7.7.1.1.1.1.1.2.3" xref="S5.E17.m1.7.7.1.1.1.1.1.2.3.cmml"><mi id="S5.E17.m1.7.7.1.1.1.1.1.2.3.2" xref="S5.E17.m1.7.7.1.1.1.1.1.2.3.2.cmml">a</mi><mo id="S5.E17.m1.7.7.1.1.1.1.1.2.3.1" xref="S5.E17.m1.7.7.1.1.1.1.1.2.3.1.cmml">∼</mo><msub id="S5.E17.m1.7.7.1.1.1.1.1.2.3.3" xref="S5.E17.m1.7.7.1.1.1.1.1.2.3.3.cmml"><mi id="S5.E17.m1.7.7.1.1.1.1.1.2.3.3.2" xref="S5.E17.m1.7.7.1.1.1.1.1.2.3.3.2.cmml">π</mi><mn id="S5.E17.m1.7.7.1.1.1.1.1.2.3.3.3" xref="S5.E17.m1.7.7.1.1.1.1.1.2.3.3.3.cmml">0</mn></msub></mrow></munder><mrow id="S5.E17.m1.7.7.1.1.1.1.1.1.1" xref="S5.E17.m1.7.7.1.1.1.1.1.1.2.cmml"><mo id="S5.E17.m1.7.7.1.1.1.1.1.1.1.2" xref="S5.E17.m1.7.7.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S5.E17.m1.7.7.1.1.1.1.1.1.1.1" xref="S5.E17.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mfrac id="S5.E17.m1.2.2" xref="S5.E17.m1.2.2.cmml"><mrow id="S5.E17.m1.1.1.1" xref="S5.E17.m1.1.1.1.cmml"><msub id="S5.E17.m1.1.1.1.3" xref="S5.E17.m1.1.1.1.3.cmml"><mi id="S5.E17.m1.1.1.1.3.2" xref="S5.E17.m1.1.1.1.3.2.cmml">π</mi><mi id="S5.E17.m1.1.1.1.3.3" xref="S5.E17.m1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S5.E17.m1.1.1.1.2" xref="S5.E17.m1.1.1.1.2.cmml">⁢</mo><mrow id="S5.E17.m1.1.1.1.4.2" xref="S5.E17.m1.1.1.1.cmml"><mo id="S5.E17.m1.1.1.1.4.2.1" stretchy="false" xref="S5.E17.m1.1.1.1.cmml">(</mo><mi id="S5.E17.m1.1.1.1.1" xref="S5.E17.m1.1.1.1.1.cmml">a</mi><mo id="S5.E17.m1.1.1.1.4.2.2" stretchy="false" xref="S5.E17.m1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S5.E17.m1.2.2.2" xref="S5.E17.m1.2.2.2.cmml"><msub id="S5.E17.m1.2.2.2.3" xref="S5.E17.m1.2.2.2.3.cmml"><mi id="S5.E17.m1.2.2.2.3.2" xref="S5.E17.m1.2.2.2.3.2.cmml">π</mi><mn id="S5.E17.m1.2.2.2.3.3" xref="S5.E17.m1.2.2.2.3.3.cmml">0</mn></msub><mo id="S5.E17.m1.2.2.2.2" xref="S5.E17.m1.2.2.2.2.cmml">⁢</mo><mrow id="S5.E17.m1.2.2.2.4.2" xref="S5.E17.m1.2.2.2.cmml"><mo id="S5.E17.m1.2.2.2.4.2.1" stretchy="false" xref="S5.E17.m1.2.2.2.cmml">(</mo><mi id="S5.E17.m1.2.2.2.1" xref="S5.E17.m1.2.2.2.1.cmml">a</mi><mo id="S5.E17.m1.2.2.2.4.2.2" stretchy="false" xref="S5.E17.m1.2.2.2.cmml">)</mo></mrow></mrow></mfrac><mo id="S5.E17.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S5.E17.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S5.E17.m1.7.7.1.1.1.1.1.1.1.1.2" xref="S5.E17.m1.7.7.1.1.1.1.1.1.1.1.2.cmml">R</mi></mrow><mo id="S5.E17.m1.7.7.1.1.1.1.1.1.1.3" xref="S5.E17.m1.7.7.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S5.E17.m1.7.7.1.1.1.2" xref="S5.E17.m1.7.7.1.1.1.2.cmml">−</mo><mrow id="S5.E17.m1.7.7.1.1.1.3" xref="S5.E17.m1.7.7.1.1.1.3.cmml"><mi id="S5.E17.m1.7.7.1.1.1.3.2" xref="S5.E17.m1.7.7.1.1.1.3.2.cmml">β</mi><mo id="S5.E17.m1.7.7.1.1.1.3.1" lspace="0.167em" xref="S5.E17.m1.7.7.1.1.1.3.1.cmml">⁢</mo><munder id="S5.E17.m1.7.7.1.1.1.3.3" xref="S5.E17.m1.7.7.1.1.1.3.3.cmml"><munder accentunder="true" id="S5.E17.m1.4.4" xref="S5.E17.m1.4.4.cmml"><mrow id="S5.E17.m1.4.4.2" xref="S5.E17.m1.4.4.2.cmml"><munder id="S5.E17.m1.4.4.2.3" xref="S5.E17.m1.4.4.2.3.cmml"><mo id="S5.E17.m1.4.4.2.3.2" movablelimits="false" rspace="0em" xref="S5.E17.m1.4.4.2.3.2.cmml">𝔼</mo><mrow id="S5.E17.m1.4.4.2.3.3" xref="S5.E17.m1.4.4.2.3.3.cmml"><mi id="S5.E17.m1.4.4.2.3.3.2" xref="S5.E17.m1.4.4.2.3.3.2.cmml">a</mi><mo id="S5.E17.m1.4.4.2.3.3.1" xref="S5.E17.m1.4.4.2.3.3.1.cmml">∼</mo><msub id="S5.E17.m1.4.4.2.3.3.3" xref="S5.E17.m1.4.4.2.3.3.3.cmml"><mi id="S5.E17.m1.4.4.2.3.3.3.2" xref="S5.E17.m1.4.4.2.3.3.3.2.cmml">π</mi><mn id="S5.E17.m1.4.4.2.3.3.3.3" xref="S5.E17.m1.4.4.2.3.3.3.3.cmml">0</mn></msub></mrow></munder><mrow id="S5.E17.m1.4.4.2.4.2" xref="S5.E17.m1.4.4.2.4.1.cmml"><mo id="S5.E17.m1.4.4.2.4.2.1" xref="S5.E17.m1.4.4.2.4.1.1.cmml">[</mo><mfrac id="S5.E17.m1.4.4.2.2" xref="S5.E17.m1.4.4.2.2.cmml"><mrow id="S5.E17.m1.3.3.1.1.1" xref="S5.E17.m1.3.3.1.1.1.cmml"><msub id="S5.E17.m1.3.3.1.1.1.3" xref="S5.E17.m1.3.3.1.1.1.3.cmml"><mi id="S5.E17.m1.3.3.1.1.1.3.2" xref="S5.E17.m1.3.3.1.1.1.3.2.cmml">π</mi><mi id="S5.E17.m1.3.3.1.1.1.3.3" xref="S5.E17.m1.3.3.1.1.1.3.3.cmml">θ</mi></msub><mo id="S5.E17.m1.3.3.1.1.1.2" xref="S5.E17.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S5.E17.m1.3.3.1.1.1.4.2" xref="S5.E17.m1.3.3.1.1.1.cmml"><mo id="S5.E17.m1.3.3.1.1.1.4.2.1" stretchy="false" xref="S5.E17.m1.3.3.1.1.1.cmml">(</mo><mi id="S5.E17.m1.3.3.1.1.1.1" xref="S5.E17.m1.3.3.1.1.1.1.cmml">a</mi><mo id="S5.E17.m1.3.3.1.1.1.4.2.2" stretchy="false" xref="S5.E17.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S5.E17.m1.4.4.2.2.2" xref="S5.E17.m1.4.4.2.2.2.cmml"><msub id="S5.E17.m1.4.4.2.2.2.3" xref="S5.E17.m1.4.4.2.2.2.3.cmml"><mi id="S5.E17.m1.4.4.2.2.2.3.2" xref="S5.E17.m1.4.4.2.2.2.3.2.cmml">π</mi><mn id="S5.E17.m1.4.4.2.2.2.3.3" xref="S5.E17.m1.4.4.2.2.2.3.3.cmml">0</mn></msub><mo id="S5.E17.m1.4.4.2.2.2.2" xref="S5.E17.m1.4.4.2.2.2.2.cmml">⁢</mo><mrow id="S5.E17.m1.4.4.2.2.2.4.2" xref="S5.E17.m1.4.4.2.2.2.cmml"><mo id="S5.E17.m1.4.4.2.2.2.4.2.1" stretchy="false" xref="S5.E17.m1.4.4.2.2.2.cmml">(</mo><mi id="S5.E17.m1.4.4.2.2.2.1" xref="S5.E17.m1.4.4.2.2.2.1.cmml">a</mi><mo id="S5.E17.m1.4.4.2.2.2.4.2.2" stretchy="false" xref="S5.E17.m1.4.4.2.2.2.cmml">)</mo></mrow></mrow></mfrac><mo id="S5.E17.m1.4.4.2.4.2.2" xref="S5.E17.m1.4.4.2.4.1.1.cmml">]</mo></mrow></mrow><mo id="S5.E17.m1.4.4.3" xref="S5.E17.m1.4.4.3.cmml">⏟</mo></munder><mrow id="S5.E17.m1.7.7.1.1.1.3.3.2" xref="S5.E17.m1.7.7.1.1.1.3.3.2.cmml"><mi id="S5.E17.m1.7.7.1.1.1.3.3.2.2" xref="S5.E17.m1.7.7.1.1.1.3.3.2.2.cmml"></mi><mo id="S5.E17.m1.7.7.1.1.1.3.3.2.1" xref="S5.E17.m1.7.7.1.1.1.3.3.2.1.cmml">≢</mo><mn id="S5.E17.m1.7.7.1.1.1.3.3.2.3" xref="S5.E17.m1.7.7.1.1.1.3.3.2.3.cmml">1</mn></mrow></munder></mrow></mrow><mo id="S5.E17.m1.7.7.1.1.6" rspace="0.1389em" xref="S5.E17.m1.7.7.1.1.6.cmml">≠</mo><mrow id="S5.E17.m1.7.7.1.1.2" xref="S5.E17.m1.7.7.1.1.2.cmml"><munder id="S5.E17.m1.7.7.1.1.2.2" xref="S5.E17.m1.7.7.1.1.2.2.cmml"><mo id="S5.E17.m1.7.7.1.1.2.2.2" lspace="0.1389em" movablelimits="false" rspace="0em" xref="S5.E17.m1.7.7.1.1.2.2.2.cmml">𝔼</mo><mrow id="S5.E17.m1.7.7.1.1.2.2.3" xref="S5.E17.m1.7.7.1.1.2.2.3.cmml"><mi id="S5.E17.m1.7.7.1.1.2.2.3.2" xref="S5.E17.m1.7.7.1.1.2.2.3.2.cmml">a</mi><mo id="S5.E17.m1.7.7.1.1.2.2.3.1" xref="S5.E17.m1.7.7.1.1.2.2.3.1.cmml">∼</mo><msub id="S5.E17.m1.7.7.1.1.2.2.3.3" xref="S5.E17.m1.7.7.1.1.2.2.3.3.cmml"><mi id="S5.E17.m1.7.7.1.1.2.2.3.3.2" xref="S5.E17.m1.7.7.1.1.2.2.3.3.2.cmml">π</mi><mn id="S5.E17.m1.7.7.1.1.2.2.3.3.3" xref="S5.E17.m1.7.7.1.1.2.2.3.3.3.cmml">0</mn></msub></mrow></munder><mrow id="S5.E17.m1.7.7.1.1.2.1.1" xref="S5.E17.m1.7.7.1.1.2.1.2.cmml"><mo id="S5.E17.m1.7.7.1.1.2.1.1.2" xref="S5.E17.m1.7.7.1.1.2.1.2.1.cmml">[</mo><mrow id="S5.E17.m1.7.7.1.1.2.1.1.1" xref="S5.E17.m1.7.7.1.1.2.1.1.1.cmml"><mfrac id="S5.E17.m1.6.6" xref="S5.E17.m1.6.6.cmml"><mrow id="S5.E17.m1.5.5.1" xref="S5.E17.m1.5.5.1.cmml"><msub id="S5.E17.m1.5.5.1.3" xref="S5.E17.m1.5.5.1.3.cmml"><mi id="S5.E17.m1.5.5.1.3.2" xref="S5.E17.m1.5.5.1.3.2.cmml">π</mi><mi id="S5.E17.m1.5.5.1.3.3" xref="S5.E17.m1.5.5.1.3.3.cmml">θ</mi></msub><mo id="S5.E17.m1.5.5.1.2" xref="S5.E17.m1.5.5.1.2.cmml">⁢</mo><mrow id="S5.E17.m1.5.5.1.4.2" xref="S5.E17.m1.5.5.1.cmml"><mo id="S5.E17.m1.5.5.1.4.2.1" stretchy="false" xref="S5.E17.m1.5.5.1.cmml">(</mo><mi id="S5.E17.m1.5.5.1.1" xref="S5.E17.m1.5.5.1.1.cmml">a</mi><mo id="S5.E17.m1.5.5.1.4.2.2" stretchy="false" xref="S5.E17.m1.5.5.1.cmml">)</mo></mrow></mrow><mrow id="S5.E17.m1.6.6.2" xref="S5.E17.m1.6.6.2.cmml"><msub id="S5.E17.m1.6.6.2.3" xref="S5.E17.m1.6.6.2.3.cmml"><mi id="S5.E17.m1.6.6.2.3.2" xref="S5.E17.m1.6.6.2.3.2.cmml">π</mi><mn id="S5.E17.m1.6.6.2.3.3" xref="S5.E17.m1.6.6.2.3.3.cmml">0</mn></msub><mo id="S5.E17.m1.6.6.2.2" xref="S5.E17.m1.6.6.2.2.cmml">⁢</mo><mrow id="S5.E17.m1.6.6.2.4.2" xref="S5.E17.m1.6.6.2.cmml"><mo id="S5.E17.m1.6.6.2.4.2.1" stretchy="false" xref="S5.E17.m1.6.6.2.cmml">(</mo><mi id="S5.E17.m1.6.6.2.1" xref="S5.E17.m1.6.6.2.1.cmml">a</mi><mo id="S5.E17.m1.6.6.2.4.2.2" stretchy="false" xref="S5.E17.m1.6.6.2.cmml">)</mo></mrow></mrow></mfrac><mo id="S5.E17.m1.7.7.1.1.2.1.1.1.1" xref="S5.E17.m1.7.7.1.1.2.1.1.1.1.cmml">⁢</mo><mi id="S5.E17.m1.7.7.1.1.2.1.1.1.2" xref="S5.E17.m1.7.7.1.1.2.1.1.1.2.cmml">R</mi></mrow><mo id="S5.E17.m1.7.7.1.1.2.1.1.3" xref="S5.E17.m1.7.7.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S5.E17.m1.7.7.1.2" lspace="0em" xref="S5.E17.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E17.m1.7b"><apply id="S5.E17.m1.7.7.1.1.cmml" xref="S5.E17.m1.7.7.1"><and id="S5.E17.m1.7.7.1.1a.cmml" xref="S5.E17.m1.7.7.1"></and><apply id="S5.E17.m1.7.7.1.1b.cmml" xref="S5.E17.m1.7.7.1"><eq id="S5.E17.m1.7.7.1.1.5.cmml" xref="S5.E17.m1.7.7.1.1.5"></eq><csymbol cd="latexml" id="S5.E17.m1.7.7.1.1.4.cmml" xref="S5.E17.m1.7.7.1.1.4">absent</csymbol><apply id="S5.E17.m1.7.7.1.1.1.cmml" xref="S5.E17.m1.7.7.1.1.1"><minus id="S5.E17.m1.7.7.1.1.1.2.cmml" xref="S5.E17.m1.7.7.1.1.1.2"></minus><apply id="S5.E17.m1.7.7.1.1.1.1.cmml" xref="S5.E17.m1.7.7.1.1.1.1"><plus id="S5.E17.m1.7.7.1.1.1.1.2.cmml" xref="S5.E17.m1.7.7.1.1.1.1.2"></plus><ci id="S5.E17.m1.7.7.1.1.1.1.3.cmml" xref="S5.E17.m1.7.7.1.1.1.1.3">𝛽</ci><apply id="S5.E17.m1.7.7.1.1.1.1.1.cmml" xref="S5.E17.m1.7.7.1.1.1.1.1"><apply id="S5.E17.m1.7.7.1.1.1.1.1.2.cmml" xref="S5.E17.m1.7.7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E17.m1.7.7.1.1.1.1.1.2.1.cmml" xref="S5.E17.m1.7.7.1.1.1.1.1.2">subscript</csymbol><ci id="S5.E17.m1.7.7.1.1.1.1.1.2.2.cmml" xref="S5.E17.m1.7.7.1.1.1.1.1.2.2">𝔼</ci><apply id="S5.E17.m1.7.7.1.1.1.1.1.2.3.cmml" xref="S5.E17.m1.7.7.1.1.1.1.1.2.3"><csymbol cd="latexml" id="S5.E17.m1.7.7.1.1.1.1.1.2.3.1.cmml" xref="S5.E17.m1.7.7.1.1.1.1.1.2.3.1">similar-to</csymbol><ci id="S5.E17.m1.7.7.1.1.1.1.1.2.3.2.cmml" xref="S5.E17.m1.7.7.1.1.1.1.1.2.3.2">𝑎</ci><apply id="S5.E17.m1.7.7.1.1.1.1.1.2.3.3.cmml" xref="S5.E17.m1.7.7.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S5.E17.m1.7.7.1.1.1.1.1.2.3.3.1.cmml" xref="S5.E17.m1.7.7.1.1.1.1.1.2.3.3">subscript</csymbol><ci id="S5.E17.m1.7.7.1.1.1.1.1.2.3.3.2.cmml" xref="S5.E17.m1.7.7.1.1.1.1.1.2.3.3.2">𝜋</ci><cn id="S5.E17.m1.7.7.1.1.1.1.1.2.3.3.3.cmml" type="integer" xref="S5.E17.m1.7.7.1.1.1.1.1.2.3.3.3">0</cn></apply></apply></apply><apply id="S5.E17.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S5.E17.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S5.E17.m1.7.7.1.1.1.1.1.1.2.1.cmml" xref="S5.E17.m1.7.7.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S5.E17.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S5.E17.m1.7.7.1.1.1.1.1.1.1.1"><times id="S5.E17.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E17.m1.7.7.1.1.1.1.1.1.1.1.1"></times><apply id="S5.E17.m1.2.2.cmml" xref="S5.E17.m1.2.2"><divide id="S5.E17.m1.2.2.3.cmml" xref="S5.E17.m1.2.2"></divide><apply id="S5.E17.m1.1.1.1.cmml" xref="S5.E17.m1.1.1.1"><times id="S5.E17.m1.1.1.1.2.cmml" xref="S5.E17.m1.1.1.1.2"></times><apply id="S5.E17.m1.1.1.1.3.cmml" xref="S5.E17.m1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E17.m1.1.1.1.3.1.cmml" xref="S5.E17.m1.1.1.1.3">subscript</csymbol><ci id="S5.E17.m1.1.1.1.3.2.cmml" xref="S5.E17.m1.1.1.1.3.2">𝜋</ci><ci id="S5.E17.m1.1.1.1.3.3.cmml" xref="S5.E17.m1.1.1.1.3.3">𝜃</ci></apply><ci id="S5.E17.m1.1.1.1.1.cmml" xref="S5.E17.m1.1.1.1.1">𝑎</ci></apply><apply id="S5.E17.m1.2.2.2.cmml" xref="S5.E17.m1.2.2.2"><times id="S5.E17.m1.2.2.2.2.cmml" xref="S5.E17.m1.2.2.2.2"></times><apply id="S5.E17.m1.2.2.2.3.cmml" xref="S5.E17.m1.2.2.2.3"><csymbol cd="ambiguous" id="S5.E17.m1.2.2.2.3.1.cmml" xref="S5.E17.m1.2.2.2.3">subscript</csymbol><ci id="S5.E17.m1.2.2.2.3.2.cmml" xref="S5.E17.m1.2.2.2.3.2">𝜋</ci><cn id="S5.E17.m1.2.2.2.3.3.cmml" type="integer" xref="S5.E17.m1.2.2.2.3.3">0</cn></apply><ci id="S5.E17.m1.2.2.2.1.cmml" xref="S5.E17.m1.2.2.2.1">𝑎</ci></apply></apply><ci id="S5.E17.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E17.m1.7.7.1.1.1.1.1.1.1.1.2">𝑅</ci></apply></apply></apply></apply><apply id="S5.E17.m1.7.7.1.1.1.3.cmml" xref="S5.E17.m1.7.7.1.1.1.3"><times id="S5.E17.m1.7.7.1.1.1.3.1.cmml" xref="S5.E17.m1.7.7.1.1.1.3.1"></times><ci id="S5.E17.m1.7.7.1.1.1.3.2.cmml" xref="S5.E17.m1.7.7.1.1.1.3.2">𝛽</ci><apply id="S5.E17.m1.7.7.1.1.1.3.3.cmml" xref="S5.E17.m1.7.7.1.1.1.3.3"><csymbol cd="ambiguous" id="S5.E17.m1.7.7.1.1.1.3.3.1.cmml" xref="S5.E17.m1.7.7.1.1.1.3.3">subscript</csymbol><apply id="S5.E17.m1.4.4.cmml" xref="S5.E17.m1.4.4"><ci id="S5.E17.m1.4.4.3.cmml" xref="S5.E17.m1.4.4.3">⏟</ci><apply id="S5.E17.m1.4.4.2.cmml" xref="S5.E17.m1.4.4.2"><apply id="S5.E17.m1.4.4.2.3.cmml" xref="S5.E17.m1.4.4.2.3"><csymbol cd="ambiguous" id="S5.E17.m1.4.4.2.3.1.cmml" xref="S5.E17.m1.4.4.2.3">subscript</csymbol><ci id="S5.E17.m1.4.4.2.3.2.cmml" xref="S5.E17.m1.4.4.2.3.2">𝔼</ci><apply id="S5.E17.m1.4.4.2.3.3.cmml" xref="S5.E17.m1.4.4.2.3.3"><csymbol cd="latexml" id="S5.E17.m1.4.4.2.3.3.1.cmml" xref="S5.E17.m1.4.4.2.3.3.1">similar-to</csymbol><ci id="S5.E17.m1.4.4.2.3.3.2.cmml" xref="S5.E17.m1.4.4.2.3.3.2">𝑎</ci><apply id="S5.E17.m1.4.4.2.3.3.3.cmml" xref="S5.E17.m1.4.4.2.3.3.3"><csymbol cd="ambiguous" id="S5.E17.m1.4.4.2.3.3.3.1.cmml" xref="S5.E17.m1.4.4.2.3.3.3">subscript</csymbol><ci id="S5.E17.m1.4.4.2.3.3.3.2.cmml" xref="S5.E17.m1.4.4.2.3.3.3.2">𝜋</ci><cn id="S5.E17.m1.4.4.2.3.3.3.3.cmml" type="integer" xref="S5.E17.m1.4.4.2.3.3.3.3">0</cn></apply></apply></apply><apply id="S5.E17.m1.4.4.2.4.1.cmml" xref="S5.E17.m1.4.4.2.4.2"><csymbol cd="latexml" id="S5.E17.m1.4.4.2.4.1.1.cmml" xref="S5.E17.m1.4.4.2.4.2.1">delimited-[]</csymbol><apply id="S5.E17.m1.4.4.2.2.cmml" xref="S5.E17.m1.4.4.2.2"><divide id="S5.E17.m1.4.4.2.2.3.cmml" xref="S5.E17.m1.4.4.2.2"></divide><apply id="S5.E17.m1.3.3.1.1.1.cmml" xref="S5.E17.m1.3.3.1.1.1"><times id="S5.E17.m1.3.3.1.1.1.2.cmml" xref="S5.E17.m1.3.3.1.1.1.2"></times><apply id="S5.E17.m1.3.3.1.1.1.3.cmml" xref="S5.E17.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S5.E17.m1.3.3.1.1.1.3.1.cmml" xref="S5.E17.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S5.E17.m1.3.3.1.1.1.3.2.cmml" xref="S5.E17.m1.3.3.1.1.1.3.2">𝜋</ci><ci id="S5.E17.m1.3.3.1.1.1.3.3.cmml" xref="S5.E17.m1.3.3.1.1.1.3.3">𝜃</ci></apply><ci id="S5.E17.m1.3.3.1.1.1.1.cmml" xref="S5.E17.m1.3.3.1.1.1.1">𝑎</ci></apply><apply id="S5.E17.m1.4.4.2.2.2.cmml" xref="S5.E17.m1.4.4.2.2.2"><times id="S5.E17.m1.4.4.2.2.2.2.cmml" xref="S5.E17.m1.4.4.2.2.2.2"></times><apply id="S5.E17.m1.4.4.2.2.2.3.cmml" xref="S5.E17.m1.4.4.2.2.2.3"><csymbol cd="ambiguous" id="S5.E17.m1.4.4.2.2.2.3.1.cmml" xref="S5.E17.m1.4.4.2.2.2.3">subscript</csymbol><ci id="S5.E17.m1.4.4.2.2.2.3.2.cmml" xref="S5.E17.m1.4.4.2.2.2.3.2">𝜋</ci><cn id="S5.E17.m1.4.4.2.2.2.3.3.cmml" type="integer" xref="S5.E17.m1.4.4.2.2.2.3.3">0</cn></apply><ci id="S5.E17.m1.4.4.2.2.2.1.cmml" xref="S5.E17.m1.4.4.2.2.2.1">𝑎</ci></apply></apply></apply></apply></apply><apply id="S5.E17.m1.7.7.1.1.1.3.3.2.cmml" xref="S5.E17.m1.7.7.1.1.1.3.3.2"><csymbol cd="latexml" id="S5.E17.m1.7.7.1.1.1.3.3.2.1.cmml" xref="S5.E17.m1.7.7.1.1.1.3.3.2.1">not-equivalent-to</csymbol><csymbol cd="latexml" id="S5.E17.m1.7.7.1.1.1.3.3.2.2.cmml" xref="S5.E17.m1.7.7.1.1.1.3.3.2.2">absent</csymbol><cn id="S5.E17.m1.7.7.1.1.1.3.3.2.3.cmml" type="integer" xref="S5.E17.m1.7.7.1.1.1.3.3.2.3">1</cn></apply></apply></apply></apply></apply><apply id="S5.E17.m1.7.7.1.1c.cmml" xref="S5.E17.m1.7.7.1"><neq id="S5.E17.m1.7.7.1.1.6.cmml" xref="S5.E17.m1.7.7.1.1.6"></neq><share href="https://arxiv.org/html/2405.02141v2#S5.E17.m1.7.7.1.1.1.cmml" id="S5.E17.m1.7.7.1.1d.cmml" xref="S5.E17.m1.7.7.1"></share><apply id="S5.E17.m1.7.7.1.1.2.cmml" xref="S5.E17.m1.7.7.1.1.2"><apply id="S5.E17.m1.7.7.1.1.2.2.cmml" xref="S5.E17.m1.7.7.1.1.2.2"><csymbol cd="ambiguous" id="S5.E17.m1.7.7.1.1.2.2.1.cmml" xref="S5.E17.m1.7.7.1.1.2.2">subscript</csymbol><ci id="S5.E17.m1.7.7.1.1.2.2.2.cmml" xref="S5.E17.m1.7.7.1.1.2.2.2">𝔼</ci><apply id="S5.E17.m1.7.7.1.1.2.2.3.cmml" xref="S5.E17.m1.7.7.1.1.2.2.3"><csymbol cd="latexml" id="S5.E17.m1.7.7.1.1.2.2.3.1.cmml" xref="S5.E17.m1.7.7.1.1.2.2.3.1">similar-to</csymbol><ci id="S5.E17.m1.7.7.1.1.2.2.3.2.cmml" xref="S5.E17.m1.7.7.1.1.2.2.3.2">𝑎</ci><apply id="S5.E17.m1.7.7.1.1.2.2.3.3.cmml" xref="S5.E17.m1.7.7.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S5.E17.m1.7.7.1.1.2.2.3.3.1.cmml" xref="S5.E17.m1.7.7.1.1.2.2.3.3">subscript</csymbol><ci id="S5.E17.m1.7.7.1.1.2.2.3.3.2.cmml" xref="S5.E17.m1.7.7.1.1.2.2.3.3.2">𝜋</ci><cn id="S5.E17.m1.7.7.1.1.2.2.3.3.3.cmml" type="integer" xref="S5.E17.m1.7.7.1.1.2.2.3.3.3">0</cn></apply></apply></apply><apply id="S5.E17.m1.7.7.1.1.2.1.2.cmml" xref="S5.E17.m1.7.7.1.1.2.1.1"><csymbol cd="latexml" id="S5.E17.m1.7.7.1.1.2.1.2.1.cmml" xref="S5.E17.m1.7.7.1.1.2.1.1.2">delimited-[]</csymbol><apply id="S5.E17.m1.7.7.1.1.2.1.1.1.cmml" xref="S5.E17.m1.7.7.1.1.2.1.1.1"><times id="S5.E17.m1.7.7.1.1.2.1.1.1.1.cmml" xref="S5.E17.m1.7.7.1.1.2.1.1.1.1"></times><apply id="S5.E17.m1.6.6.cmml" xref="S5.E17.m1.6.6"><divide id="S5.E17.m1.6.6.3.cmml" xref="S5.E17.m1.6.6"></divide><apply id="S5.E17.m1.5.5.1.cmml" xref="S5.E17.m1.5.5.1"><times id="S5.E17.m1.5.5.1.2.cmml" xref="S5.E17.m1.5.5.1.2"></times><apply id="S5.E17.m1.5.5.1.3.cmml" xref="S5.E17.m1.5.5.1.3"><csymbol cd="ambiguous" id="S5.E17.m1.5.5.1.3.1.cmml" xref="S5.E17.m1.5.5.1.3">subscript</csymbol><ci id="S5.E17.m1.5.5.1.3.2.cmml" xref="S5.E17.m1.5.5.1.3.2">𝜋</ci><ci id="S5.E17.m1.5.5.1.3.3.cmml" xref="S5.E17.m1.5.5.1.3.3">𝜃</ci></apply><ci id="S5.E17.m1.5.5.1.1.cmml" xref="S5.E17.m1.5.5.1.1">𝑎</ci></apply><apply id="S5.E17.m1.6.6.2.cmml" xref="S5.E17.m1.6.6.2"><times id="S5.E17.m1.6.6.2.2.cmml" xref="S5.E17.m1.6.6.2.2"></times><apply id="S5.E17.m1.6.6.2.3.cmml" xref="S5.E17.m1.6.6.2.3"><csymbol cd="ambiguous" id="S5.E17.m1.6.6.2.3.1.cmml" xref="S5.E17.m1.6.6.2.3">subscript</csymbol><ci id="S5.E17.m1.6.6.2.3.2.cmml" xref="S5.E17.m1.6.6.2.3.2">𝜋</ci><cn id="S5.E17.m1.6.6.2.3.3.cmml" type="integer" xref="S5.E17.m1.6.6.2.3.3">0</cn></apply><ci id="S5.E17.m1.6.6.2.1.cmml" xref="S5.E17.m1.6.6.2.1">𝑎</ci></apply></apply><ci id="S5.E17.m1.7.7.1.1.2.1.1.1.2.cmml" xref="S5.E17.m1.7.7.1.1.2.1.1.1.2">𝑅</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E17.m1.7c">\displaystyle=\beta+\mathop{\mathbb{E}}\limits_{a\sim\pi_{0}}\left[\frac{\pi_{%
\theta}(a)}{\pi_{0}(a)}R\right]-\beta\underbrace{\mathop{\mathbb{E}}\limits_{a%
\sim\pi_{0}}\left[\frac{\pi_{\theta}(a)}{\pi_{0}(a)}\right]}_{{\color[rgb]{%
0,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{0,0,0}\nequiv 1}}{\color[rgb]{%
0,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{0,0,0}\neq}\mathop{\mathbb{E}}%
\limits_{a\sim\pi_{0}}\left[\frac{\pi_{\theta}(a)}{\pi_{0}(a)}R\right].</annotation><annotation encoding="application/x-llamapun" id="S5.E17.m1.7d">= italic_β + blackboard_E start_POSTSUBSCRIPT italic_a ∼ italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a ) end_ARG italic_R ] - italic_β under⏟ start_ARG blackboard_E start_POSTSUBSCRIPT italic_a ∼ italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a ) end_ARG ] end_ARG start_POSTSUBSCRIPT ≢ 1 end_POSTSUBSCRIPT ≠ blackboard_E start_POSTSUBSCRIPT italic_a ∼ italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a ) end_ARG italic_R ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS1.p1.6">When we leverage a uniform logging policy with any kernel that has a domain that can extend beyond that of <math alttext="\pi_{0}" class="ltx_Math" display="inline" id="S5.SS1.p1.6.m1.1"><semantics id="S5.SS1.p1.6.m1.1a"><msub id="S5.SS1.p1.6.m1.1.1" xref="S5.SS1.p1.6.m1.1.1.cmml"><mi id="S5.SS1.p1.6.m1.1.1.2" xref="S5.SS1.p1.6.m1.1.1.2.cmml">π</mi><mn id="S5.SS1.p1.6.m1.1.1.3" xref="S5.SS1.p1.6.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.6.m1.1b"><apply id="S5.SS1.p1.6.m1.1.1.cmml" xref="S5.SS1.p1.6.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.6.m1.1.1.1.cmml" xref="S5.SS1.p1.6.m1.1.1">subscript</csymbol><ci id="S5.SS1.p1.6.m1.1.1.2.cmml" xref="S5.SS1.p1.6.m1.1.1.2">𝜋</ci><cn id="S5.SS1.p1.6.m1.1.1.3.cmml" type="integer" xref="S5.SS1.p1.6.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.6.m1.1c">\pi_{0}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.6.m1.1d">italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, the common support assumption does not hold.
As a result, the equivalence of baseline corrections is now violated, and they should be avoided.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>Self-normalisation becomes unstable</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.5">The SNIPS estimator introduced in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S3.E5" title="In 3. Multivariate Off-Policy Learning ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">5</span></a> also leverages the fact that <math alttext="\mathbb{E}_{a\sim\pi_{0}}\left[\frac{\pi_{\theta}(a)}{\pi_{0}(a)}\right]=1." class="ltx_Math" display="inline" id="S5.SS2.p1.1.m1.3"><semantics id="S5.SS2.p1.1.m1.3a"><mrow id="S5.SS2.p1.1.m1.3.3.1" xref="S5.SS2.p1.1.m1.3.3.1.1.cmml"><mrow id="S5.SS2.p1.1.m1.3.3.1.1" xref="S5.SS2.p1.1.m1.3.3.1.1.cmml"><mrow id="S5.SS2.p1.1.m1.3.3.1.1.2" xref="S5.SS2.p1.1.m1.3.3.1.1.2.cmml"><msub id="S5.SS2.p1.1.m1.3.3.1.1.2.2" xref="S5.SS2.p1.1.m1.3.3.1.1.2.2.cmml"><mi id="S5.SS2.p1.1.m1.3.3.1.1.2.2.2" xref="S5.SS2.p1.1.m1.3.3.1.1.2.2.2.cmml">𝔼</mi><mrow id="S5.SS2.p1.1.m1.3.3.1.1.2.2.3" xref="S5.SS2.p1.1.m1.3.3.1.1.2.2.3.cmml"><mi id="S5.SS2.p1.1.m1.3.3.1.1.2.2.3.2" xref="S5.SS2.p1.1.m1.3.3.1.1.2.2.3.2.cmml">a</mi><mo id="S5.SS2.p1.1.m1.3.3.1.1.2.2.3.1" xref="S5.SS2.p1.1.m1.3.3.1.1.2.2.3.1.cmml">∼</mo><msub id="S5.SS2.p1.1.m1.3.3.1.1.2.2.3.3" xref="S5.SS2.p1.1.m1.3.3.1.1.2.2.3.3.cmml"><mi id="S5.SS2.p1.1.m1.3.3.1.1.2.2.3.3.2" xref="S5.SS2.p1.1.m1.3.3.1.1.2.2.3.3.2.cmml">π</mi><mn id="S5.SS2.p1.1.m1.3.3.1.1.2.2.3.3.3" xref="S5.SS2.p1.1.m1.3.3.1.1.2.2.3.3.3.cmml">0</mn></msub></mrow></msub><mo id="S5.SS2.p1.1.m1.3.3.1.1.2.1" xref="S5.SS2.p1.1.m1.3.3.1.1.2.1.cmml">⁢</mo><mrow id="S5.SS2.p1.1.m1.3.3.1.1.2.3.2" xref="S5.SS2.p1.1.m1.3.3.1.1.2.3.1.cmml"><mo id="S5.SS2.p1.1.m1.3.3.1.1.2.3.2.1" xref="S5.SS2.p1.1.m1.3.3.1.1.2.3.1.1.cmml">[</mo><mfrac id="S5.SS2.p1.1.m1.2.2" xref="S5.SS2.p1.1.m1.2.2.cmml"><mrow id="S5.SS2.p1.1.m1.1.1.1" xref="S5.SS2.p1.1.m1.1.1.1.cmml"><msub id="S5.SS2.p1.1.m1.1.1.1.3" xref="S5.SS2.p1.1.m1.1.1.1.3.cmml"><mi id="S5.SS2.p1.1.m1.1.1.1.3.2" xref="S5.SS2.p1.1.m1.1.1.1.3.2.cmml">π</mi><mi id="S5.SS2.p1.1.m1.1.1.1.3.3" xref="S5.SS2.p1.1.m1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S5.SS2.p1.1.m1.1.1.1.2" xref="S5.SS2.p1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S5.SS2.p1.1.m1.1.1.1.4.2" xref="S5.SS2.p1.1.m1.1.1.1.cmml"><mo id="S5.SS2.p1.1.m1.1.1.1.4.2.1" stretchy="false" xref="S5.SS2.p1.1.m1.1.1.1.cmml">(</mo><mi id="S5.SS2.p1.1.m1.1.1.1.1" xref="S5.SS2.p1.1.m1.1.1.1.1.cmml">a</mi><mo id="S5.SS2.p1.1.m1.1.1.1.4.2.2" stretchy="false" xref="S5.SS2.p1.1.m1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S5.SS2.p1.1.m1.2.2.2" xref="S5.SS2.p1.1.m1.2.2.2.cmml"><msub id="S5.SS2.p1.1.m1.2.2.2.3" xref="S5.SS2.p1.1.m1.2.2.2.3.cmml"><mi id="S5.SS2.p1.1.m1.2.2.2.3.2" xref="S5.SS2.p1.1.m1.2.2.2.3.2.cmml">π</mi><mn id="S5.SS2.p1.1.m1.2.2.2.3.3" xref="S5.SS2.p1.1.m1.2.2.2.3.3.cmml">0</mn></msub><mo id="S5.SS2.p1.1.m1.2.2.2.2" xref="S5.SS2.p1.1.m1.2.2.2.2.cmml">⁢</mo><mrow id="S5.SS2.p1.1.m1.2.2.2.4.2" xref="S5.SS2.p1.1.m1.2.2.2.cmml"><mo id="S5.SS2.p1.1.m1.2.2.2.4.2.1" stretchy="false" xref="S5.SS2.p1.1.m1.2.2.2.cmml">(</mo><mi id="S5.SS2.p1.1.m1.2.2.2.1" xref="S5.SS2.p1.1.m1.2.2.2.1.cmml">a</mi><mo id="S5.SS2.p1.1.m1.2.2.2.4.2.2" stretchy="false" xref="S5.SS2.p1.1.m1.2.2.2.cmml">)</mo></mrow></mrow></mfrac><mo id="S5.SS2.p1.1.m1.3.3.1.1.2.3.2.2" xref="S5.SS2.p1.1.m1.3.3.1.1.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S5.SS2.p1.1.m1.3.3.1.1.1" xref="S5.SS2.p1.1.m1.3.3.1.1.1.cmml">=</mo><mn id="S5.SS2.p1.1.m1.3.3.1.1.3" xref="S5.SS2.p1.1.m1.3.3.1.1.3.cmml">1</mn></mrow><mo id="S5.SS2.p1.1.m1.3.3.1.2" lspace="0em" xref="S5.SS2.p1.1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.3b"><apply id="S5.SS2.p1.1.m1.3.3.1.1.cmml" xref="S5.SS2.p1.1.m1.3.3.1"><eq id="S5.SS2.p1.1.m1.3.3.1.1.1.cmml" xref="S5.SS2.p1.1.m1.3.3.1.1.1"></eq><apply id="S5.SS2.p1.1.m1.3.3.1.1.2.cmml" xref="S5.SS2.p1.1.m1.3.3.1.1.2"><times id="S5.SS2.p1.1.m1.3.3.1.1.2.1.cmml" xref="S5.SS2.p1.1.m1.3.3.1.1.2.1"></times><apply id="S5.SS2.p1.1.m1.3.3.1.1.2.2.cmml" xref="S5.SS2.p1.1.m1.3.3.1.1.2.2"><csymbol cd="ambiguous" id="S5.SS2.p1.1.m1.3.3.1.1.2.2.1.cmml" xref="S5.SS2.p1.1.m1.3.3.1.1.2.2">subscript</csymbol><ci id="S5.SS2.p1.1.m1.3.3.1.1.2.2.2.cmml" xref="S5.SS2.p1.1.m1.3.3.1.1.2.2.2">𝔼</ci><apply id="S5.SS2.p1.1.m1.3.3.1.1.2.2.3.cmml" xref="S5.SS2.p1.1.m1.3.3.1.1.2.2.3"><csymbol cd="latexml" id="S5.SS2.p1.1.m1.3.3.1.1.2.2.3.1.cmml" xref="S5.SS2.p1.1.m1.3.3.1.1.2.2.3.1">similar-to</csymbol><ci id="S5.SS2.p1.1.m1.3.3.1.1.2.2.3.2.cmml" xref="S5.SS2.p1.1.m1.3.3.1.1.2.2.3.2">𝑎</ci><apply id="S5.SS2.p1.1.m1.3.3.1.1.2.2.3.3.cmml" xref="S5.SS2.p1.1.m1.3.3.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S5.SS2.p1.1.m1.3.3.1.1.2.2.3.3.1.cmml" xref="S5.SS2.p1.1.m1.3.3.1.1.2.2.3.3">subscript</csymbol><ci id="S5.SS2.p1.1.m1.3.3.1.1.2.2.3.3.2.cmml" xref="S5.SS2.p1.1.m1.3.3.1.1.2.2.3.3.2">𝜋</ci><cn id="S5.SS2.p1.1.m1.3.3.1.1.2.2.3.3.3.cmml" type="integer" xref="S5.SS2.p1.1.m1.3.3.1.1.2.2.3.3.3">0</cn></apply></apply></apply><apply id="S5.SS2.p1.1.m1.3.3.1.1.2.3.1.cmml" xref="S5.SS2.p1.1.m1.3.3.1.1.2.3.2"><csymbol cd="latexml" id="S5.SS2.p1.1.m1.3.3.1.1.2.3.1.1.cmml" xref="S5.SS2.p1.1.m1.3.3.1.1.2.3.2.1">delimited-[]</csymbol><apply id="S5.SS2.p1.1.m1.2.2.cmml" xref="S5.SS2.p1.1.m1.2.2"><divide id="S5.SS2.p1.1.m1.2.2.3.cmml" xref="S5.SS2.p1.1.m1.2.2"></divide><apply id="S5.SS2.p1.1.m1.1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1.1"><times id="S5.SS2.p1.1.m1.1.1.1.2.cmml" xref="S5.SS2.p1.1.m1.1.1.1.2"></times><apply id="S5.SS2.p1.1.m1.1.1.1.3.cmml" xref="S5.SS2.p1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS2.p1.1.m1.1.1.1.3.1.cmml" xref="S5.SS2.p1.1.m1.1.1.1.3">subscript</csymbol><ci id="S5.SS2.p1.1.m1.1.1.1.3.2.cmml" xref="S5.SS2.p1.1.m1.1.1.1.3.2">𝜋</ci><ci id="S5.SS2.p1.1.m1.1.1.1.3.3.cmml" xref="S5.SS2.p1.1.m1.1.1.1.3.3">𝜃</ci></apply><ci id="S5.SS2.p1.1.m1.1.1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1.1.1">𝑎</ci></apply><apply id="S5.SS2.p1.1.m1.2.2.2.cmml" xref="S5.SS2.p1.1.m1.2.2.2"><times id="S5.SS2.p1.1.m1.2.2.2.2.cmml" xref="S5.SS2.p1.1.m1.2.2.2.2"></times><apply id="S5.SS2.p1.1.m1.2.2.2.3.cmml" xref="S5.SS2.p1.1.m1.2.2.2.3"><csymbol cd="ambiguous" id="S5.SS2.p1.1.m1.2.2.2.3.1.cmml" xref="S5.SS2.p1.1.m1.2.2.2.3">subscript</csymbol><ci id="S5.SS2.p1.1.m1.2.2.2.3.2.cmml" xref="S5.SS2.p1.1.m1.2.2.2.3.2">𝜋</ci><cn id="S5.SS2.p1.1.m1.2.2.2.3.3.cmml" type="integer" xref="S5.SS2.p1.1.m1.2.2.2.3.3">0</cn></apply><ci id="S5.SS2.p1.1.m1.2.2.2.1.cmml" xref="S5.SS2.p1.1.m1.2.2.2.1">𝑎</ci></apply></apply></apply></apply><cn id="S5.SS2.p1.1.m1.3.3.1.1.3.cmml" type="integer" xref="S5.SS2.p1.1.m1.3.3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.3c">\mathbb{E}_{a\sim\pi_{0}}\left[\frac{\pi_{\theta}(a)}{\pi_{0}(a)}\right]=1.</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.1.m1.3d">blackboard_E start_POSTSUBSCRIPT italic_a ∼ italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a ) end_ARG ] = 1 .</annotation></semantics></math>
Because this equivalence no longer holds, the SNIPS estimator is no longer asymptotically unbiased.
More problematically, when leveraging this estimator for <em class="ltx_emph ltx_font_italic" id="S5.SS2.p1.5.1">learning</em> purposes, we are incentivised to find a policy that minimises <math alttext="\mathbb{E}_{a\sim\pi_{0}}\left[\frac{\pi_{\theta}(a)}{\pi_{0}(a)}\right]" class="ltx_Math" display="inline" id="S5.SS2.p1.2.m2.2"><semantics id="S5.SS2.p1.2.m2.2a"><mrow id="S5.SS2.p1.2.m2.2.3" xref="S5.SS2.p1.2.m2.2.3.cmml"><msub id="S5.SS2.p1.2.m2.2.3.2" xref="S5.SS2.p1.2.m2.2.3.2.cmml"><mi id="S5.SS2.p1.2.m2.2.3.2.2" xref="S5.SS2.p1.2.m2.2.3.2.2.cmml">𝔼</mi><mrow id="S5.SS2.p1.2.m2.2.3.2.3" xref="S5.SS2.p1.2.m2.2.3.2.3.cmml"><mi id="S5.SS2.p1.2.m2.2.3.2.3.2" xref="S5.SS2.p1.2.m2.2.3.2.3.2.cmml">a</mi><mo id="S5.SS2.p1.2.m2.2.3.2.3.1" xref="S5.SS2.p1.2.m2.2.3.2.3.1.cmml">∼</mo><msub id="S5.SS2.p1.2.m2.2.3.2.3.3" xref="S5.SS2.p1.2.m2.2.3.2.3.3.cmml"><mi id="S5.SS2.p1.2.m2.2.3.2.3.3.2" xref="S5.SS2.p1.2.m2.2.3.2.3.3.2.cmml">π</mi><mn id="S5.SS2.p1.2.m2.2.3.2.3.3.3" xref="S5.SS2.p1.2.m2.2.3.2.3.3.3.cmml">0</mn></msub></mrow></msub><mo id="S5.SS2.p1.2.m2.2.3.1" xref="S5.SS2.p1.2.m2.2.3.1.cmml">⁢</mo><mrow id="S5.SS2.p1.2.m2.2.3.3.2" xref="S5.SS2.p1.2.m2.2.3.3.1.cmml"><mo id="S5.SS2.p1.2.m2.2.3.3.2.1" xref="S5.SS2.p1.2.m2.2.3.3.1.1.cmml">[</mo><mfrac id="S5.SS2.p1.2.m2.2.2" xref="S5.SS2.p1.2.m2.2.2.cmml"><mrow id="S5.SS2.p1.2.m2.1.1.1" xref="S5.SS2.p1.2.m2.1.1.1.cmml"><msub id="S5.SS2.p1.2.m2.1.1.1.3" xref="S5.SS2.p1.2.m2.1.1.1.3.cmml"><mi id="S5.SS2.p1.2.m2.1.1.1.3.2" xref="S5.SS2.p1.2.m2.1.1.1.3.2.cmml">π</mi><mi id="S5.SS2.p1.2.m2.1.1.1.3.3" xref="S5.SS2.p1.2.m2.1.1.1.3.3.cmml">θ</mi></msub><mo id="S5.SS2.p1.2.m2.1.1.1.2" xref="S5.SS2.p1.2.m2.1.1.1.2.cmml">⁢</mo><mrow id="S5.SS2.p1.2.m2.1.1.1.4.2" xref="S5.SS2.p1.2.m2.1.1.1.cmml"><mo id="S5.SS2.p1.2.m2.1.1.1.4.2.1" stretchy="false" xref="S5.SS2.p1.2.m2.1.1.1.cmml">(</mo><mi id="S5.SS2.p1.2.m2.1.1.1.1" xref="S5.SS2.p1.2.m2.1.1.1.1.cmml">a</mi><mo id="S5.SS2.p1.2.m2.1.1.1.4.2.2" stretchy="false" xref="S5.SS2.p1.2.m2.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S5.SS2.p1.2.m2.2.2.2" xref="S5.SS2.p1.2.m2.2.2.2.cmml"><msub id="S5.SS2.p1.2.m2.2.2.2.3" xref="S5.SS2.p1.2.m2.2.2.2.3.cmml"><mi id="S5.SS2.p1.2.m2.2.2.2.3.2" xref="S5.SS2.p1.2.m2.2.2.2.3.2.cmml">π</mi><mn id="S5.SS2.p1.2.m2.2.2.2.3.3" xref="S5.SS2.p1.2.m2.2.2.2.3.3.cmml">0</mn></msub><mo id="S5.SS2.p1.2.m2.2.2.2.2" xref="S5.SS2.p1.2.m2.2.2.2.2.cmml">⁢</mo><mrow id="S5.SS2.p1.2.m2.2.2.2.4.2" xref="S5.SS2.p1.2.m2.2.2.2.cmml"><mo id="S5.SS2.p1.2.m2.2.2.2.4.2.1" stretchy="false" xref="S5.SS2.p1.2.m2.2.2.2.cmml">(</mo><mi id="S5.SS2.p1.2.m2.2.2.2.1" xref="S5.SS2.p1.2.m2.2.2.2.1.cmml">a</mi><mo id="S5.SS2.p1.2.m2.2.2.2.4.2.2" stretchy="false" xref="S5.SS2.p1.2.m2.2.2.2.cmml">)</mo></mrow></mrow></mfrac><mo id="S5.SS2.p1.2.m2.2.3.3.2.2" xref="S5.SS2.p1.2.m2.2.3.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.2b"><apply id="S5.SS2.p1.2.m2.2.3.cmml" xref="S5.SS2.p1.2.m2.2.3"><times id="S5.SS2.p1.2.m2.2.3.1.cmml" xref="S5.SS2.p1.2.m2.2.3.1"></times><apply id="S5.SS2.p1.2.m2.2.3.2.cmml" xref="S5.SS2.p1.2.m2.2.3.2"><csymbol cd="ambiguous" id="S5.SS2.p1.2.m2.2.3.2.1.cmml" xref="S5.SS2.p1.2.m2.2.3.2">subscript</csymbol><ci id="S5.SS2.p1.2.m2.2.3.2.2.cmml" xref="S5.SS2.p1.2.m2.2.3.2.2">𝔼</ci><apply id="S5.SS2.p1.2.m2.2.3.2.3.cmml" xref="S5.SS2.p1.2.m2.2.3.2.3"><csymbol cd="latexml" id="S5.SS2.p1.2.m2.2.3.2.3.1.cmml" xref="S5.SS2.p1.2.m2.2.3.2.3.1">similar-to</csymbol><ci id="S5.SS2.p1.2.m2.2.3.2.3.2.cmml" xref="S5.SS2.p1.2.m2.2.3.2.3.2">𝑎</ci><apply id="S5.SS2.p1.2.m2.2.3.2.3.3.cmml" xref="S5.SS2.p1.2.m2.2.3.2.3.3"><csymbol cd="ambiguous" id="S5.SS2.p1.2.m2.2.3.2.3.3.1.cmml" xref="S5.SS2.p1.2.m2.2.3.2.3.3">subscript</csymbol><ci id="S5.SS2.p1.2.m2.2.3.2.3.3.2.cmml" xref="S5.SS2.p1.2.m2.2.3.2.3.3.2">𝜋</ci><cn id="S5.SS2.p1.2.m2.2.3.2.3.3.3.cmml" type="integer" xref="S5.SS2.p1.2.m2.2.3.2.3.3.3">0</cn></apply></apply></apply><apply id="S5.SS2.p1.2.m2.2.3.3.1.cmml" xref="S5.SS2.p1.2.m2.2.3.3.2"><csymbol cd="latexml" id="S5.SS2.p1.2.m2.2.3.3.1.1.cmml" xref="S5.SS2.p1.2.m2.2.3.3.2.1">delimited-[]</csymbol><apply id="S5.SS2.p1.2.m2.2.2.cmml" xref="S5.SS2.p1.2.m2.2.2"><divide id="S5.SS2.p1.2.m2.2.2.3.cmml" xref="S5.SS2.p1.2.m2.2.2"></divide><apply id="S5.SS2.p1.2.m2.1.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1.1"><times id="S5.SS2.p1.2.m2.1.1.1.2.cmml" xref="S5.SS2.p1.2.m2.1.1.1.2"></times><apply id="S5.SS2.p1.2.m2.1.1.1.3.cmml" xref="S5.SS2.p1.2.m2.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS2.p1.2.m2.1.1.1.3.1.cmml" xref="S5.SS2.p1.2.m2.1.1.1.3">subscript</csymbol><ci id="S5.SS2.p1.2.m2.1.1.1.3.2.cmml" xref="S5.SS2.p1.2.m2.1.1.1.3.2">𝜋</ci><ci id="S5.SS2.p1.2.m2.1.1.1.3.3.cmml" xref="S5.SS2.p1.2.m2.1.1.1.3.3">𝜃</ci></apply><ci id="S5.SS2.p1.2.m2.1.1.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1.1.1">𝑎</ci></apply><apply id="S5.SS2.p1.2.m2.2.2.2.cmml" xref="S5.SS2.p1.2.m2.2.2.2"><times id="S5.SS2.p1.2.m2.2.2.2.2.cmml" xref="S5.SS2.p1.2.m2.2.2.2.2"></times><apply id="S5.SS2.p1.2.m2.2.2.2.3.cmml" xref="S5.SS2.p1.2.m2.2.2.2.3"><csymbol cd="ambiguous" id="S5.SS2.p1.2.m2.2.2.2.3.1.cmml" xref="S5.SS2.p1.2.m2.2.2.2.3">subscript</csymbol><ci id="S5.SS2.p1.2.m2.2.2.2.3.2.cmml" xref="S5.SS2.p1.2.m2.2.2.2.3.2">𝜋</ci><cn id="S5.SS2.p1.2.m2.2.2.2.3.3.cmml" type="integer" xref="S5.SS2.p1.2.m2.2.2.2.3.3">0</cn></apply><ci id="S5.SS2.p1.2.m2.2.2.2.1.cmml" xref="S5.SS2.p1.2.m2.2.2.2.1">𝑎</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.2c">\mathbb{E}_{a\sim\pi_{0}}\left[\frac{\pi_{\theta}(a)}{\pi_{0}(a)}\right]</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.2.m2.2d">blackboard_E start_POSTSUBSCRIPT italic_a ∼ italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a ) end_ARG ]</annotation></semantics></math> (as it appears in the denominator of Eqs. <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S3.E5" title="In 3. Multivariate Off-Policy Learning ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">5</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S4.E12" title="In 4.1. Effective Sample Size Corrections ‣ 4. Improving the CRM Lower Bound ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">12</span></a>).
This quantity can become arbitrarily small by moving <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S5.SS2.p1.3.m3.1"><semantics id="S5.SS2.p1.3.m3.1a"><msub id="S5.SS2.p1.3.m3.1.1" xref="S5.SS2.p1.3.m3.1.1.cmml"><mi id="S5.SS2.p1.3.m3.1.1.2" xref="S5.SS2.p1.3.m3.1.1.2.cmml">π</mi><mi id="S5.SS2.p1.3.m3.1.1.3" xref="S5.SS2.p1.3.m3.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.3.m3.1b"><apply id="S5.SS2.p1.3.m3.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.3.m3.1.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S5.SS2.p1.3.m3.1.1.2.cmml" xref="S5.SS2.p1.3.m3.1.1.2">𝜋</ci><ci id="S5.SS2.p1.3.m3.1.1.3.cmml" xref="S5.SS2.p1.3.m3.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.3.m3.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.3.m3.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> to or beyond the borders of the logging policy’s domain.
Indeed: this <em class="ltx_emph ltx_font_italic" id="S5.SS2.p1.5.2">decreases</em> <math alttext="\mathbb{E}_{a\sim\pi_{0}}\left[\frac{\pi_{\theta}(a)}{\pi_{0}(a)}\right]" class="ltx_Math" display="inline" id="S5.SS2.p1.4.m4.2"><semantics id="S5.SS2.p1.4.m4.2a"><mrow id="S5.SS2.p1.4.m4.2.3" xref="S5.SS2.p1.4.m4.2.3.cmml"><msub id="S5.SS2.p1.4.m4.2.3.2" xref="S5.SS2.p1.4.m4.2.3.2.cmml"><mi id="S5.SS2.p1.4.m4.2.3.2.2" xref="S5.SS2.p1.4.m4.2.3.2.2.cmml">𝔼</mi><mrow id="S5.SS2.p1.4.m4.2.3.2.3" xref="S5.SS2.p1.4.m4.2.3.2.3.cmml"><mi id="S5.SS2.p1.4.m4.2.3.2.3.2" xref="S5.SS2.p1.4.m4.2.3.2.3.2.cmml">a</mi><mo id="S5.SS2.p1.4.m4.2.3.2.3.1" xref="S5.SS2.p1.4.m4.2.3.2.3.1.cmml">∼</mo><msub id="S5.SS2.p1.4.m4.2.3.2.3.3" xref="S5.SS2.p1.4.m4.2.3.2.3.3.cmml"><mi id="S5.SS2.p1.4.m4.2.3.2.3.3.2" xref="S5.SS2.p1.4.m4.2.3.2.3.3.2.cmml">π</mi><mn id="S5.SS2.p1.4.m4.2.3.2.3.3.3" xref="S5.SS2.p1.4.m4.2.3.2.3.3.3.cmml">0</mn></msub></mrow></msub><mo id="S5.SS2.p1.4.m4.2.3.1" xref="S5.SS2.p1.4.m4.2.3.1.cmml">⁢</mo><mrow id="S5.SS2.p1.4.m4.2.3.3.2" xref="S5.SS2.p1.4.m4.2.3.3.1.cmml"><mo id="S5.SS2.p1.4.m4.2.3.3.2.1" xref="S5.SS2.p1.4.m4.2.3.3.1.1.cmml">[</mo><mfrac id="S5.SS2.p1.4.m4.2.2" xref="S5.SS2.p1.4.m4.2.2.cmml"><mrow id="S5.SS2.p1.4.m4.1.1.1" xref="S5.SS2.p1.4.m4.1.1.1.cmml"><msub id="S5.SS2.p1.4.m4.1.1.1.3" xref="S5.SS2.p1.4.m4.1.1.1.3.cmml"><mi id="S5.SS2.p1.4.m4.1.1.1.3.2" xref="S5.SS2.p1.4.m4.1.1.1.3.2.cmml">π</mi><mi id="S5.SS2.p1.4.m4.1.1.1.3.3" xref="S5.SS2.p1.4.m4.1.1.1.3.3.cmml">θ</mi></msub><mo id="S5.SS2.p1.4.m4.1.1.1.2" xref="S5.SS2.p1.4.m4.1.1.1.2.cmml">⁢</mo><mrow id="S5.SS2.p1.4.m4.1.1.1.4.2" xref="S5.SS2.p1.4.m4.1.1.1.cmml"><mo id="S5.SS2.p1.4.m4.1.1.1.4.2.1" stretchy="false" xref="S5.SS2.p1.4.m4.1.1.1.cmml">(</mo><mi id="S5.SS2.p1.4.m4.1.1.1.1" xref="S5.SS2.p1.4.m4.1.1.1.1.cmml">a</mi><mo id="S5.SS2.p1.4.m4.1.1.1.4.2.2" stretchy="false" xref="S5.SS2.p1.4.m4.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S5.SS2.p1.4.m4.2.2.2" xref="S5.SS2.p1.4.m4.2.2.2.cmml"><msub id="S5.SS2.p1.4.m4.2.2.2.3" xref="S5.SS2.p1.4.m4.2.2.2.3.cmml"><mi id="S5.SS2.p1.4.m4.2.2.2.3.2" xref="S5.SS2.p1.4.m4.2.2.2.3.2.cmml">π</mi><mn id="S5.SS2.p1.4.m4.2.2.2.3.3" xref="S5.SS2.p1.4.m4.2.2.2.3.3.cmml">0</mn></msub><mo id="S5.SS2.p1.4.m4.2.2.2.2" xref="S5.SS2.p1.4.m4.2.2.2.2.cmml">⁢</mo><mrow id="S5.SS2.p1.4.m4.2.2.2.4.2" xref="S5.SS2.p1.4.m4.2.2.2.cmml"><mo id="S5.SS2.p1.4.m4.2.2.2.4.2.1" stretchy="false" xref="S5.SS2.p1.4.m4.2.2.2.cmml">(</mo><mi id="S5.SS2.p1.4.m4.2.2.2.1" xref="S5.SS2.p1.4.m4.2.2.2.1.cmml">a</mi><mo id="S5.SS2.p1.4.m4.2.2.2.4.2.2" stretchy="false" xref="S5.SS2.p1.4.m4.2.2.2.cmml">)</mo></mrow></mrow></mfrac><mo id="S5.SS2.p1.4.m4.2.3.3.2.2" xref="S5.SS2.p1.4.m4.2.3.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.4.m4.2b"><apply id="S5.SS2.p1.4.m4.2.3.cmml" xref="S5.SS2.p1.4.m4.2.3"><times id="S5.SS2.p1.4.m4.2.3.1.cmml" xref="S5.SS2.p1.4.m4.2.3.1"></times><apply id="S5.SS2.p1.4.m4.2.3.2.cmml" xref="S5.SS2.p1.4.m4.2.3.2"><csymbol cd="ambiguous" id="S5.SS2.p1.4.m4.2.3.2.1.cmml" xref="S5.SS2.p1.4.m4.2.3.2">subscript</csymbol><ci id="S5.SS2.p1.4.m4.2.3.2.2.cmml" xref="S5.SS2.p1.4.m4.2.3.2.2">𝔼</ci><apply id="S5.SS2.p1.4.m4.2.3.2.3.cmml" xref="S5.SS2.p1.4.m4.2.3.2.3"><csymbol cd="latexml" id="S5.SS2.p1.4.m4.2.3.2.3.1.cmml" xref="S5.SS2.p1.4.m4.2.3.2.3.1">similar-to</csymbol><ci id="S5.SS2.p1.4.m4.2.3.2.3.2.cmml" xref="S5.SS2.p1.4.m4.2.3.2.3.2">𝑎</ci><apply id="S5.SS2.p1.4.m4.2.3.2.3.3.cmml" xref="S5.SS2.p1.4.m4.2.3.2.3.3"><csymbol cd="ambiguous" id="S5.SS2.p1.4.m4.2.3.2.3.3.1.cmml" xref="S5.SS2.p1.4.m4.2.3.2.3.3">subscript</csymbol><ci id="S5.SS2.p1.4.m4.2.3.2.3.3.2.cmml" xref="S5.SS2.p1.4.m4.2.3.2.3.3.2">𝜋</ci><cn id="S5.SS2.p1.4.m4.2.3.2.3.3.3.cmml" type="integer" xref="S5.SS2.p1.4.m4.2.3.2.3.3.3">0</cn></apply></apply></apply><apply id="S5.SS2.p1.4.m4.2.3.3.1.cmml" xref="S5.SS2.p1.4.m4.2.3.3.2"><csymbol cd="latexml" id="S5.SS2.p1.4.m4.2.3.3.1.1.cmml" xref="S5.SS2.p1.4.m4.2.3.3.2.1">delimited-[]</csymbol><apply id="S5.SS2.p1.4.m4.2.2.cmml" xref="S5.SS2.p1.4.m4.2.2"><divide id="S5.SS2.p1.4.m4.2.2.3.cmml" xref="S5.SS2.p1.4.m4.2.2"></divide><apply id="S5.SS2.p1.4.m4.1.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1.1"><times id="S5.SS2.p1.4.m4.1.1.1.2.cmml" xref="S5.SS2.p1.4.m4.1.1.1.2"></times><apply id="S5.SS2.p1.4.m4.1.1.1.3.cmml" xref="S5.SS2.p1.4.m4.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS2.p1.4.m4.1.1.1.3.1.cmml" xref="S5.SS2.p1.4.m4.1.1.1.3">subscript</csymbol><ci id="S5.SS2.p1.4.m4.1.1.1.3.2.cmml" xref="S5.SS2.p1.4.m4.1.1.1.3.2">𝜋</ci><ci id="S5.SS2.p1.4.m4.1.1.1.3.3.cmml" xref="S5.SS2.p1.4.m4.1.1.1.3.3">𝜃</ci></apply><ci id="S5.SS2.p1.4.m4.1.1.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1.1.1">𝑎</ci></apply><apply id="S5.SS2.p1.4.m4.2.2.2.cmml" xref="S5.SS2.p1.4.m4.2.2.2"><times id="S5.SS2.p1.4.m4.2.2.2.2.cmml" xref="S5.SS2.p1.4.m4.2.2.2.2"></times><apply id="S5.SS2.p1.4.m4.2.2.2.3.cmml" xref="S5.SS2.p1.4.m4.2.2.2.3"><csymbol cd="ambiguous" id="S5.SS2.p1.4.m4.2.2.2.3.1.cmml" xref="S5.SS2.p1.4.m4.2.2.2.3">subscript</csymbol><ci id="S5.SS2.p1.4.m4.2.2.2.3.2.cmml" xref="S5.SS2.p1.4.m4.2.2.2.3.2">𝜋</ci><cn id="S5.SS2.p1.4.m4.2.2.2.3.3.cmml" type="integer" xref="S5.SS2.p1.4.m4.2.2.2.3.3">0</cn></apply><ci id="S5.SS2.p1.4.m4.2.2.2.1.cmml" xref="S5.SS2.p1.4.m4.2.2.2.1">𝑎</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.4.m4.2c">\mathbb{E}_{a\sim\pi_{0}}\left[\frac{\pi_{\theta}(a)}{\pi_{0}(a)}\right]</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.4.m4.2d">blackboard_E start_POSTSUBSCRIPT italic_a ∼ italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_a ) end_ARG ]</annotation></semantics></math> and <em class="ltx_emph ltx_font_italic" id="S5.SS2.p1.5.3">increases</em> <math alttext="\widehat{V}_{\rm SNIPS}" class="ltx_Math" display="inline" id="S5.SS2.p1.5.m5.1"><semantics id="S5.SS2.p1.5.m5.1a"><msub id="S5.SS2.p1.5.m5.1.1" xref="S5.SS2.p1.5.m5.1.1.cmml"><mover accent="true" id="S5.SS2.p1.5.m5.1.1.2" xref="S5.SS2.p1.5.m5.1.1.2.cmml"><mi id="S5.SS2.p1.5.m5.1.1.2.2" xref="S5.SS2.p1.5.m5.1.1.2.2.cmml">V</mi><mo id="S5.SS2.p1.5.m5.1.1.2.1" xref="S5.SS2.p1.5.m5.1.1.2.1.cmml">^</mo></mover><mi id="S5.SS2.p1.5.m5.1.1.3" xref="S5.SS2.p1.5.m5.1.1.3.cmml">SNIPS</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.5.m5.1b"><apply id="S5.SS2.p1.5.m5.1.1.cmml" xref="S5.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.5.m5.1.1.1.cmml" xref="S5.SS2.p1.5.m5.1.1">subscript</csymbol><apply id="S5.SS2.p1.5.m5.1.1.2.cmml" xref="S5.SS2.p1.5.m5.1.1.2"><ci id="S5.SS2.p1.5.m5.1.1.2.1.cmml" xref="S5.SS2.p1.5.m5.1.1.2.1">^</ci><ci id="S5.SS2.p1.5.m5.1.1.2.2.cmml" xref="S5.SS2.p1.5.m5.1.1.2.2">𝑉</ci></apply><ci id="S5.SS2.p1.5.m5.1.1.3.cmml" xref="S5.SS2.p1.5.m5.1.1.3">SNIPS</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.5.m5.1c">\widehat{V}_{\rm SNIPS}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.5.m5.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_SNIPS end_POSTSUBSCRIPT</annotation></semantics></math> as a result.
It should nevertheless intuitively be clear that this is undesirable behaviour: placing probability density <em class="ltx_emph ltx_font_italic" id="S5.SS2.p1.5.4">away</em> from the observed data should not increase our reward estimate.
This is closely related to the “propensity overfitting” phenomenon described by <cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib61" title="">Swaminathan and Joachims</a></cite> <cite class="ltx_cite ltx_citemacro_citep">(Swaminathan and Joachims, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib61" title="">2015b</a>)</cite>, which the uniform logging policy cannot avoid here.
As such, we cannot enjoy the variance reduction that self-normalisation brings without introducing a statistical bias that is problematic.</p>
</div>
<figure class="ltx_figure" id="S5.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="225" id="S5.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F1.5.1.1" style="font-size:90%;">Figure 1</span>. </span><span class="ltx_text" id="S5.F1.6.2" style="font-size:90%;">Visualising the curse of dimensionality and counterintuitive properties of the Uniform distribution in high dimensions. <span class="ltx_text ltx_font_italic" id="S5.F1.6.2.1">Left</span>: Whilst all distances are equally likely in a single dimension, this property quickly disappears in higher dimensions. <span class="ltx_text ltx_font_italic" id="S5.F1.6.2.2">Middle</span>: The Normal distribution exhibits similar but less pronounced behaviour, with a lower slope on the cumulative density. <span class="ltx_text ltx_font_italic" id="S5.F1.6.2.3">Right</span>: Uniform sampling disfavours a hypersphere around the mean. Normal sampling can help to partially alleviate this.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3. </span>The curse of dimensionality</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">Finally, whilst the uniform distribution has certain intuitive and desirable properties in a <em class="ltx_emph ltx_font_italic" id="S5.SS3.p1.1.1">single</em> dimension, they can become counterintuitive and disappear when we consider <em class="ltx_emph ltx_font_italic" id="S5.SS3.p1.1.2">multiple</em> dimensions.
A key desirable property in the univariate case is that sampled points’ distances to the centre of the distribution are also uniformly distributed.
When the mean of the distribution is defined by the weights we use in production and we randomise purely for the sake of data collection, this seems logical and desirable.</p>
</div>
<div class="ltx_para" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.1">Nevertheless, when we consider higher dimensions, this property vanishes.
Imagine we sample 1 million points from a uniform distribution in <math alttext="\mathcal{U}(-0.5,0.5)" class="ltx_Math" display="inline" id="S5.SS3.p2.1.m1.2"><semantics id="S5.SS3.p2.1.m1.2a"><mrow id="S5.SS3.p2.1.m1.2.2" xref="S5.SS3.p2.1.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p2.1.m1.2.2.3" xref="S5.SS3.p2.1.m1.2.2.3.cmml">𝒰</mi><mo id="S5.SS3.p2.1.m1.2.2.2" xref="S5.SS3.p2.1.m1.2.2.2.cmml">⁢</mo><mrow id="S5.SS3.p2.1.m1.2.2.1.1" xref="S5.SS3.p2.1.m1.2.2.1.2.cmml"><mo id="S5.SS3.p2.1.m1.2.2.1.1.2" stretchy="false" xref="S5.SS3.p2.1.m1.2.2.1.2.cmml">(</mo><mrow id="S5.SS3.p2.1.m1.2.2.1.1.1" xref="S5.SS3.p2.1.m1.2.2.1.1.1.cmml"><mo id="S5.SS3.p2.1.m1.2.2.1.1.1a" xref="S5.SS3.p2.1.m1.2.2.1.1.1.cmml">−</mo><mn id="S5.SS3.p2.1.m1.2.2.1.1.1.2" xref="S5.SS3.p2.1.m1.2.2.1.1.1.2.cmml">0.5</mn></mrow><mo id="S5.SS3.p2.1.m1.2.2.1.1.3" xref="S5.SS3.p2.1.m1.2.2.1.2.cmml">,</mo><mn id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml">0.5</mn><mo id="S5.SS3.p2.1.m1.2.2.1.1.4" stretchy="false" xref="S5.SS3.p2.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.2b"><apply id="S5.SS3.p2.1.m1.2.2.cmml" xref="S5.SS3.p2.1.m1.2.2"><times id="S5.SS3.p2.1.m1.2.2.2.cmml" xref="S5.SS3.p2.1.m1.2.2.2"></times><ci id="S5.SS3.p2.1.m1.2.2.3.cmml" xref="S5.SS3.p2.1.m1.2.2.3">𝒰</ci><interval closure="open" id="S5.SS3.p2.1.m1.2.2.1.2.cmml" xref="S5.SS3.p2.1.m1.2.2.1.1"><apply id="S5.SS3.p2.1.m1.2.2.1.1.1.cmml" xref="S5.SS3.p2.1.m1.2.2.1.1.1"><minus id="S5.SS3.p2.1.m1.2.2.1.1.1.1.cmml" xref="S5.SS3.p2.1.m1.2.2.1.1.1"></minus><cn id="S5.SS3.p2.1.m1.2.2.1.1.1.2.cmml" type="float" xref="S5.SS3.p2.1.m1.2.2.1.1.1.2">0.5</cn></apply><cn id="S5.SS3.p2.1.m1.1.1.cmml" type="float" xref="S5.SS3.p2.1.m1.1.1">0.5</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.2c">\mathcal{U}(-0.5,0.5)</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.1.m1.2d">caligraphic_U ( - 0.5 , 0.5 )</annotation></semantics></math>.
In a single dimension, it is easily verified that the (normalised) Euclidean distance of every point is also uniformly distributed.<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Because the maximal Euclidean distance depends on the dimensionality <math alttext="d" class="ltx_Math" display="inline" id="footnote1.m1.1"><semantics id="footnote1.m1.1b"><mi id="footnote1.m1.1.1" xref="footnote1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="footnote1.m1.1c"><ci id="footnote1.m1.1.1.cmml" xref="footnote1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m1.1d">d</annotation><annotation encoding="application/x-llamapun" id="footnote1.m1.1e">italic_d</annotation></semantics></math>, we normalise the distances by a factor <math alttext="\sqrt{0.25d}" class="ltx_Math" display="inline" id="footnote1.m2.1"><semantics id="footnote1.m2.1b"><msqrt id="footnote1.m2.1.1" xref="footnote1.m2.1.1.cmml"><mrow id="footnote1.m2.1.1.2" xref="footnote1.m2.1.1.2.cmml"><mn id="footnote1.m2.1.1.2.2" xref="footnote1.m2.1.1.2.2.cmml">0.25</mn><mo id="footnote1.m2.1.1.2.1" xref="footnote1.m2.1.1.2.1.cmml">⁢</mo><mi id="footnote1.m2.1.1.2.3" xref="footnote1.m2.1.1.2.3.cmml">d</mi></mrow></msqrt><annotation-xml encoding="MathML-Content" id="footnote1.m2.1c"><apply id="footnote1.m2.1.1.cmml" xref="footnote1.m2.1.1"><root id="footnote1.m2.1.1a.cmml" xref="footnote1.m2.1.1"></root><apply id="footnote1.m2.1.1.2.cmml" xref="footnote1.m2.1.1.2"><times id="footnote1.m2.1.1.2.1.cmml" xref="footnote1.m2.1.1.2.1"></times><cn id="footnote1.m2.1.1.2.2.cmml" type="float" xref="footnote1.m2.1.1.2.2">0.25</cn><ci id="footnote1.m2.1.1.2.3.cmml" xref="footnote1.m2.1.1.2.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m2.1d">\sqrt{0.25d}</annotation><annotation encoding="application/x-llamapun" id="footnote1.m2.1e">square-root start_ARG 0.25 italic_d end_ARG</annotation></semantics></math> to allow comparison across changing <math alttext="d" class="ltx_Math" display="inline" id="footnote1.m3.1"><semantics id="footnote1.m3.1b"><mi id="footnote1.m3.1.1" xref="footnote1.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="footnote1.m3.1c"><ci id="footnote1.m3.1.1.cmml" xref="footnote1.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m3.1d">d</annotation><annotation encoding="application/x-llamapun" id="footnote1.m3.1e">italic_d</annotation></semantics></math>.</span></span></span>
If we increase the number of dimensions, however, this desirable property no longer holds.
Suppose we were to sample from a Gaussian distribution instead: this bias is also present, but in a far less pronounced manner.</p>
</div>
<div class="ltx_para" id="S5.SS3.p3">
<p class="ltx_p" id="S5.SS3.p3.7">Intuitively, what practitioners <em class="ltx_emph ltx_font_italic" id="S5.SS3.p3.7.1">expect</em> when choosing a uniformly distributed data collection policy is that the probability of a point falling into a region <math alttext="[\mu-\epsilon,\mu+\epsilon]" class="ltx_Math" display="inline" id="S5.SS3.p3.1.m1.2"><semantics id="S5.SS3.p3.1.m1.2a"><mrow id="S5.SS3.p3.1.m1.2.2.2" xref="S5.SS3.p3.1.m1.2.2.3.cmml"><mo id="S5.SS3.p3.1.m1.2.2.2.3" stretchy="false" xref="S5.SS3.p3.1.m1.2.2.3.cmml">[</mo><mrow id="S5.SS3.p3.1.m1.1.1.1.1" xref="S5.SS3.p3.1.m1.1.1.1.1.cmml"><mi id="S5.SS3.p3.1.m1.1.1.1.1.2" xref="S5.SS3.p3.1.m1.1.1.1.1.2.cmml">μ</mi><mo id="S5.SS3.p3.1.m1.1.1.1.1.1" xref="S5.SS3.p3.1.m1.1.1.1.1.1.cmml">−</mo><mi id="S5.SS3.p3.1.m1.1.1.1.1.3" xref="S5.SS3.p3.1.m1.1.1.1.1.3.cmml">ϵ</mi></mrow><mo id="S5.SS3.p3.1.m1.2.2.2.4" xref="S5.SS3.p3.1.m1.2.2.3.cmml">,</mo><mrow id="S5.SS3.p3.1.m1.2.2.2.2" xref="S5.SS3.p3.1.m1.2.2.2.2.cmml"><mi id="S5.SS3.p3.1.m1.2.2.2.2.2" xref="S5.SS3.p3.1.m1.2.2.2.2.2.cmml">μ</mi><mo id="S5.SS3.p3.1.m1.2.2.2.2.1" xref="S5.SS3.p3.1.m1.2.2.2.2.1.cmml">+</mo><mi id="S5.SS3.p3.1.m1.2.2.2.2.3" xref="S5.SS3.p3.1.m1.2.2.2.2.3.cmml">ϵ</mi></mrow><mo id="S5.SS3.p3.1.m1.2.2.2.5" stretchy="false" xref="S5.SS3.p3.1.m1.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.1.m1.2b"><interval closure="closed" id="S5.SS3.p3.1.m1.2.2.3.cmml" xref="S5.SS3.p3.1.m1.2.2.2"><apply id="S5.SS3.p3.1.m1.1.1.1.1.cmml" xref="S5.SS3.p3.1.m1.1.1.1.1"><minus id="S5.SS3.p3.1.m1.1.1.1.1.1.cmml" xref="S5.SS3.p3.1.m1.1.1.1.1.1"></minus><ci id="S5.SS3.p3.1.m1.1.1.1.1.2.cmml" xref="S5.SS3.p3.1.m1.1.1.1.1.2">𝜇</ci><ci id="S5.SS3.p3.1.m1.1.1.1.1.3.cmml" xref="S5.SS3.p3.1.m1.1.1.1.1.3">italic-ϵ</ci></apply><apply id="S5.SS3.p3.1.m1.2.2.2.2.cmml" xref="S5.SS3.p3.1.m1.2.2.2.2"><plus id="S5.SS3.p3.1.m1.2.2.2.2.1.cmml" xref="S5.SS3.p3.1.m1.2.2.2.2.1"></plus><ci id="S5.SS3.p3.1.m1.2.2.2.2.2.cmml" xref="S5.SS3.p3.1.m1.2.2.2.2.2">𝜇</ci><ci id="S5.SS3.p3.1.m1.2.2.2.2.3.cmml" xref="S5.SS3.p3.1.m1.2.2.2.2.3">italic-ϵ</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.1.m1.2c">[\mu-\epsilon,\mu+\epsilon]</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.1.m1.2d">[ italic_μ - italic_ϵ , italic_μ + italic_ϵ ]</annotation></semantics></math> (where <math alttext="\mu" class="ltx_Math" display="inline" id="S5.SS3.p3.2.m2.1"><semantics id="S5.SS3.p3.2.m2.1a"><mi id="S5.SS3.p3.2.m2.1.1" xref="S5.SS3.p3.2.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.2.m2.1b"><ci id="S5.SS3.p3.2.m2.1.1.cmml" xref="S5.SS3.p3.2.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.2.m2.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.2.m2.1d">italic_μ</annotation></semantics></math> is the centre of the distribution) grows linearly with <math alttext="\epsilon" class="ltx_Math" display="inline" id="S5.SS3.p3.3.m3.1"><semantics id="S5.SS3.p3.3.m3.1a"><mi id="S5.SS3.p3.3.m3.1.1" xref="S5.SS3.p3.3.m3.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.3.m3.1b"><ci id="S5.SS3.p3.3.m3.1.1.cmml" xref="S5.SS3.p3.3.m3.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.3.m3.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.3.m3.1d">italic_ϵ</annotation></semantics></math> (until the upper bound of the interval).
This is clearly valid for the univariate case.
Nevertheless, this is <em class="ltx_emph ltx_font_italic" id="S5.SS3.p3.7.2">not</em> what we get for the multivariate case.
Indeed, this probability can be computed as <math alttext="\mathsf{P}(x\in[\mu-\epsilon,\mu+\epsilon])=(1-2\epsilon)^{d}" class="ltx_Math" display="inline" id="S5.SS3.p3.4.m4.2"><semantics id="S5.SS3.p3.4.m4.2a"><mrow id="S5.SS3.p3.4.m4.2.2" xref="S5.SS3.p3.4.m4.2.2.cmml"><mrow id="S5.SS3.p3.4.m4.1.1.1" xref="S5.SS3.p3.4.m4.1.1.1.cmml"><mi id="S5.SS3.p3.4.m4.1.1.1.3" xref="S5.SS3.p3.4.m4.1.1.1.3.cmml">𝖯</mi><mo id="S5.SS3.p3.4.m4.1.1.1.2" xref="S5.SS3.p3.4.m4.1.1.1.2.cmml">⁢</mo><mrow id="S5.SS3.p3.4.m4.1.1.1.1.1" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.cmml"><mo id="S5.SS3.p3.4.m4.1.1.1.1.1.2" stretchy="false" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS3.p3.4.m4.1.1.1.1.1.1" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.cmml"><mi id="S5.SS3.p3.4.m4.1.1.1.1.1.1.4" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.4.cmml">x</mi><mo id="S5.SS3.p3.4.m4.1.1.1.1.1.1.3" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.3.cmml">∈</mo><mrow id="S5.SS3.p3.4.m4.1.1.1.1.1.1.2.2" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.2.3.cmml"><mo id="S5.SS3.p3.4.m4.1.1.1.1.1.1.2.2.3" stretchy="false" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.2.3.cmml">[</mo><mrow id="S5.SS3.p3.4.m4.1.1.1.1.1.1.1.1.1" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.1.1.1.cmml"><mi id="S5.SS3.p3.4.m4.1.1.1.1.1.1.1.1.1.2" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.1.1.1.2.cmml">μ</mi><mo id="S5.SS3.p3.4.m4.1.1.1.1.1.1.1.1.1.1" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S5.SS3.p3.4.m4.1.1.1.1.1.1.1.1.1.3" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.1.1.1.3.cmml">ϵ</mi></mrow><mo id="S5.SS3.p3.4.m4.1.1.1.1.1.1.2.2.4" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.2.3.cmml">,</mo><mrow id="S5.SS3.p3.4.m4.1.1.1.1.1.1.2.2.2" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.2.2.2.cmml"><mi id="S5.SS3.p3.4.m4.1.1.1.1.1.1.2.2.2.2" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.2.2.2.2.cmml">μ</mi><mo id="S5.SS3.p3.4.m4.1.1.1.1.1.1.2.2.2.1" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.2.2.2.1.cmml">+</mo><mi id="S5.SS3.p3.4.m4.1.1.1.1.1.1.2.2.2.3" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.2.2.2.3.cmml">ϵ</mi></mrow><mo id="S5.SS3.p3.4.m4.1.1.1.1.1.1.2.2.5" stretchy="false" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo id="S5.SS3.p3.4.m4.1.1.1.1.1.3" stretchy="false" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.SS3.p3.4.m4.2.2.3" xref="S5.SS3.p3.4.m4.2.2.3.cmml">=</mo><msup id="S5.SS3.p3.4.m4.2.2.2" xref="S5.SS3.p3.4.m4.2.2.2.cmml"><mrow id="S5.SS3.p3.4.m4.2.2.2.1.1" xref="S5.SS3.p3.4.m4.2.2.2.1.1.1.cmml"><mo id="S5.SS3.p3.4.m4.2.2.2.1.1.2" stretchy="false" xref="S5.SS3.p3.4.m4.2.2.2.1.1.1.cmml">(</mo><mrow id="S5.SS3.p3.4.m4.2.2.2.1.1.1" xref="S5.SS3.p3.4.m4.2.2.2.1.1.1.cmml"><mn id="S5.SS3.p3.4.m4.2.2.2.1.1.1.2" xref="S5.SS3.p3.4.m4.2.2.2.1.1.1.2.cmml">1</mn><mo id="S5.SS3.p3.4.m4.2.2.2.1.1.1.1" xref="S5.SS3.p3.4.m4.2.2.2.1.1.1.1.cmml">−</mo><mrow id="S5.SS3.p3.4.m4.2.2.2.1.1.1.3" xref="S5.SS3.p3.4.m4.2.2.2.1.1.1.3.cmml"><mn id="S5.SS3.p3.4.m4.2.2.2.1.1.1.3.2" xref="S5.SS3.p3.4.m4.2.2.2.1.1.1.3.2.cmml">2</mn><mo id="S5.SS3.p3.4.m4.2.2.2.1.1.1.3.1" xref="S5.SS3.p3.4.m4.2.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS3.p3.4.m4.2.2.2.1.1.1.3.3" xref="S5.SS3.p3.4.m4.2.2.2.1.1.1.3.3.cmml">ϵ</mi></mrow></mrow><mo id="S5.SS3.p3.4.m4.2.2.2.1.1.3" stretchy="false" xref="S5.SS3.p3.4.m4.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S5.SS3.p3.4.m4.2.2.2.3" xref="S5.SS3.p3.4.m4.2.2.2.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.4.m4.2b"><apply id="S5.SS3.p3.4.m4.2.2.cmml" xref="S5.SS3.p3.4.m4.2.2"><eq id="S5.SS3.p3.4.m4.2.2.3.cmml" xref="S5.SS3.p3.4.m4.2.2.3"></eq><apply id="S5.SS3.p3.4.m4.1.1.1.cmml" xref="S5.SS3.p3.4.m4.1.1.1"><times id="S5.SS3.p3.4.m4.1.1.1.2.cmml" xref="S5.SS3.p3.4.m4.1.1.1.2"></times><ci id="S5.SS3.p3.4.m4.1.1.1.3.cmml" xref="S5.SS3.p3.4.m4.1.1.1.3">𝖯</ci><apply id="S5.SS3.p3.4.m4.1.1.1.1.1.1.cmml" xref="S5.SS3.p3.4.m4.1.1.1.1.1"><in id="S5.SS3.p3.4.m4.1.1.1.1.1.1.3.cmml" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.3"></in><ci id="S5.SS3.p3.4.m4.1.1.1.1.1.1.4.cmml" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.4">𝑥</ci><interval closure="closed" id="S5.SS3.p3.4.m4.1.1.1.1.1.1.2.3.cmml" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.2.2"><apply id="S5.SS3.p3.4.m4.1.1.1.1.1.1.1.1.1.cmml" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.1.1.1"><minus id="S5.SS3.p3.4.m4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S5.SS3.p3.4.m4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.1.1.1.2">𝜇</ci><ci id="S5.SS3.p3.4.m4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.1.1.1.3">italic-ϵ</ci></apply><apply id="S5.SS3.p3.4.m4.1.1.1.1.1.1.2.2.2.cmml" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.2.2.2"><plus id="S5.SS3.p3.4.m4.1.1.1.1.1.1.2.2.2.1.cmml" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.2.2.2.1"></plus><ci id="S5.SS3.p3.4.m4.1.1.1.1.1.1.2.2.2.2.cmml" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.2.2.2.2">𝜇</ci><ci id="S5.SS3.p3.4.m4.1.1.1.1.1.1.2.2.2.3.cmml" xref="S5.SS3.p3.4.m4.1.1.1.1.1.1.2.2.2.3">italic-ϵ</ci></apply></interval></apply></apply><apply id="S5.SS3.p3.4.m4.2.2.2.cmml" xref="S5.SS3.p3.4.m4.2.2.2"><csymbol cd="ambiguous" id="S5.SS3.p3.4.m4.2.2.2.2.cmml" xref="S5.SS3.p3.4.m4.2.2.2">superscript</csymbol><apply id="S5.SS3.p3.4.m4.2.2.2.1.1.1.cmml" xref="S5.SS3.p3.4.m4.2.2.2.1.1"><minus id="S5.SS3.p3.4.m4.2.2.2.1.1.1.1.cmml" xref="S5.SS3.p3.4.m4.2.2.2.1.1.1.1"></minus><cn id="S5.SS3.p3.4.m4.2.2.2.1.1.1.2.cmml" type="integer" xref="S5.SS3.p3.4.m4.2.2.2.1.1.1.2">1</cn><apply id="S5.SS3.p3.4.m4.2.2.2.1.1.1.3.cmml" xref="S5.SS3.p3.4.m4.2.2.2.1.1.1.3"><times id="S5.SS3.p3.4.m4.2.2.2.1.1.1.3.1.cmml" xref="S5.SS3.p3.4.m4.2.2.2.1.1.1.3.1"></times><cn id="S5.SS3.p3.4.m4.2.2.2.1.1.1.3.2.cmml" type="integer" xref="S5.SS3.p3.4.m4.2.2.2.1.1.1.3.2">2</cn><ci id="S5.SS3.p3.4.m4.2.2.2.1.1.1.3.3.cmml" xref="S5.SS3.p3.4.m4.2.2.2.1.1.1.3.3">italic-ϵ</ci></apply></apply><ci id="S5.SS3.p3.4.m4.2.2.2.3.cmml" xref="S5.SS3.p3.4.m4.2.2.2.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.4.m4.2c">\mathsf{P}(x\in[\mu-\epsilon,\mu+\epsilon])=(1-2\epsilon)^{d}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.4.m4.2d">sansserif_P ( italic_x ∈ [ italic_μ - italic_ϵ , italic_μ + italic_ϵ ] ) = ( 1 - 2 italic_ϵ ) start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, implying that a hypersphere with a radius covering 80% of the maximal distance to the origin (<math alttext="\epsilon=0.4" class="ltx_Math" display="inline" id="S5.SS3.p3.5.m5.1"><semantics id="S5.SS3.p3.5.m5.1a"><mrow id="S5.SS3.p3.5.m5.1.1" xref="S5.SS3.p3.5.m5.1.1.cmml"><mi id="S5.SS3.p3.5.m5.1.1.2" xref="S5.SS3.p3.5.m5.1.1.2.cmml">ϵ</mi><mo id="S5.SS3.p3.5.m5.1.1.1" xref="S5.SS3.p3.5.m5.1.1.1.cmml">=</mo><mn id="S5.SS3.p3.5.m5.1.1.3" xref="S5.SS3.p3.5.m5.1.1.3.cmml">0.4</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.5.m5.1b"><apply id="S5.SS3.p3.5.m5.1.1.cmml" xref="S5.SS3.p3.5.m5.1.1"><eq id="S5.SS3.p3.5.m5.1.1.1.cmml" xref="S5.SS3.p3.5.m5.1.1.1"></eq><ci id="S5.SS3.p3.5.m5.1.1.2.cmml" xref="S5.SS3.p3.5.m5.1.1.2">italic-ϵ</ci><cn id="S5.SS3.p3.5.m5.1.1.3.cmml" type="float" xref="S5.SS3.p3.5.m5.1.1.3">0.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.5.m5.1c">\epsilon=0.4</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.5.m5.1d">italic_ϵ = 0.4</annotation></semantics></math>), only covers roughly 16% of the data points for <math alttext="d=8" class="ltx_Math" display="inline" id="S5.SS3.p3.6.m6.1"><semantics id="S5.SS3.p3.6.m6.1a"><mrow id="S5.SS3.p3.6.m6.1.1" xref="S5.SS3.p3.6.m6.1.1.cmml"><mi id="S5.SS3.p3.6.m6.1.1.2" xref="S5.SS3.p3.6.m6.1.1.2.cmml">d</mi><mo id="S5.SS3.p3.6.m6.1.1.1" xref="S5.SS3.p3.6.m6.1.1.1.cmml">=</mo><mn id="S5.SS3.p3.6.m6.1.1.3" xref="S5.SS3.p3.6.m6.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.6.m6.1b"><apply id="S5.SS3.p3.6.m6.1.1.cmml" xref="S5.SS3.p3.6.m6.1.1"><eq id="S5.SS3.p3.6.m6.1.1.1.cmml" xref="S5.SS3.p3.6.m6.1.1.1"></eq><ci id="S5.SS3.p3.6.m6.1.1.2.cmml" xref="S5.SS3.p3.6.m6.1.1.2">𝑑</ci><cn id="S5.SS3.p3.6.m6.1.1.3.cmml" type="integer" xref="S5.SS3.p3.6.m6.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.6.m6.1c">d=8</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.6.m6.1d">italic_d = 8</annotation></semantics></math>.
This fraction decreases monotonically as <math alttext="d" class="ltx_Math" display="inline" id="S5.SS3.p3.7.m7.1"><semantics id="S5.SS3.p3.7.m7.1a"><mi id="S5.SS3.p3.7.m7.1.1" xref="S5.SS3.p3.7.m7.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.7.m7.1b"><ci id="S5.SS3.p3.7.m7.1.1.cmml" xref="S5.SS3.p3.7.m7.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.7.m7.1c">d</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.7.m7.1d">italic_d</annotation></semantics></math> grows.</p>
</div>
<div class="ltx_para" id="S5.SS3.p4">
<p class="ltx_p" id="S5.SS3.p4.7">We visualise these phenomena in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S5.F1" title="Figure 1 ‣ 5.2. Self-normalisation becomes unstable ‣ 5. Considerations for logging policies ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">1</span></a>, where we sample 1 million points from a Uniform distribution, and 1 million points from an isotropic Normal distribution.
The left and middle plot visualise the cumulative density of the normalised Euclidean distance to the mean of the distribution (i.e. the origin), over sampled points.
The linear line on the left-hand plot (i.e. <math alttext="\mathcal{U}(d=1)" class="ltx_Math" display="inline" id="S5.SS3.p4.1.m1.1"><semantics id="S5.SS3.p4.1.m1.1a"><mrow id="S5.SS3.p4.1.m1.1.1" xref="S5.SS3.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p4.1.m1.1.1.3" xref="S5.SS3.p4.1.m1.1.1.3.cmml">𝒰</mi><mo id="S5.SS3.p4.1.m1.1.1.2" xref="S5.SS3.p4.1.m1.1.1.2.cmml">⁢</mo><mrow id="S5.SS3.p4.1.m1.1.1.1.1" xref="S5.SS3.p4.1.m1.1.1.1.1.1.cmml"><mo id="S5.SS3.p4.1.m1.1.1.1.1.2" stretchy="false" xref="S5.SS3.p4.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS3.p4.1.m1.1.1.1.1.1" xref="S5.SS3.p4.1.m1.1.1.1.1.1.cmml"><mi id="S5.SS3.p4.1.m1.1.1.1.1.1.2" xref="S5.SS3.p4.1.m1.1.1.1.1.1.2.cmml">d</mi><mo id="S5.SS3.p4.1.m1.1.1.1.1.1.1" xref="S5.SS3.p4.1.m1.1.1.1.1.1.1.cmml">=</mo><mn id="S5.SS3.p4.1.m1.1.1.1.1.1.3" xref="S5.SS3.p4.1.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S5.SS3.p4.1.m1.1.1.1.1.3" stretchy="false" xref="S5.SS3.p4.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.1.m1.1b"><apply id="S5.SS3.p4.1.m1.1.1.cmml" xref="S5.SS3.p4.1.m1.1.1"><times id="S5.SS3.p4.1.m1.1.1.2.cmml" xref="S5.SS3.p4.1.m1.1.1.2"></times><ci id="S5.SS3.p4.1.m1.1.1.3.cmml" xref="S5.SS3.p4.1.m1.1.1.3">𝒰</ci><apply id="S5.SS3.p4.1.m1.1.1.1.1.1.cmml" xref="S5.SS3.p4.1.m1.1.1.1.1"><eq id="S5.SS3.p4.1.m1.1.1.1.1.1.1.cmml" xref="S5.SS3.p4.1.m1.1.1.1.1.1.1"></eq><ci id="S5.SS3.p4.1.m1.1.1.1.1.1.2.cmml" xref="S5.SS3.p4.1.m1.1.1.1.1.1.2">𝑑</ci><cn id="S5.SS3.p4.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S5.SS3.p4.1.m1.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.1.m1.1c">\mathcal{U}(d=1)</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.1.m1.1d">caligraphic_U ( italic_d = 1 )</annotation></semantics></math>) exhibits the desirable uniform-distance property, which is not retained for increasing <math alttext="d" class="ltx_Math" display="inline" id="S5.SS3.p4.2.m2.1"><semantics id="S5.SS3.p4.2.m2.1a"><mi id="S5.SS3.p4.2.m2.1.1" xref="S5.SS3.p4.2.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.2.m2.1b"><ci id="S5.SS3.p4.2.m2.1.1.cmml" xref="S5.SS3.p4.2.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.2.m2.1c">d</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.2.m2.1d">italic_d</annotation></semantics></math>.
We plot the empirical fraction of sampled points falling into a centred hypersphere with radius <math alttext="\epsilon" class="ltx_Math" display="inline" id="S5.SS3.p4.3.m3.1"><semantics id="S5.SS3.p4.3.m3.1a"><mi id="S5.SS3.p4.3.m3.1.1" xref="S5.SS3.p4.3.m3.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.3.m3.1b"><ci id="S5.SS3.p4.3.m3.1.1.cmml" xref="S5.SS3.p4.3.m3.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.3.m3.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.3.m3.1d">italic_ϵ</annotation></semantics></math> on the right-hand plot.
Analogous to the cumulative density, whilst we observe a linear trend for <math alttext="\mathcal{U}(d=1)" class="ltx_Math" display="inline" id="S5.SS3.p4.4.m4.1"><semantics id="S5.SS3.p4.4.m4.1a"><mrow id="S5.SS3.p4.4.m4.1.1" xref="S5.SS3.p4.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p4.4.m4.1.1.3" xref="S5.SS3.p4.4.m4.1.1.3.cmml">𝒰</mi><mo id="S5.SS3.p4.4.m4.1.1.2" xref="S5.SS3.p4.4.m4.1.1.2.cmml">⁢</mo><mrow id="S5.SS3.p4.4.m4.1.1.1.1" xref="S5.SS3.p4.4.m4.1.1.1.1.1.cmml"><mo id="S5.SS3.p4.4.m4.1.1.1.1.2" stretchy="false" xref="S5.SS3.p4.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS3.p4.4.m4.1.1.1.1.1" xref="S5.SS3.p4.4.m4.1.1.1.1.1.cmml"><mi id="S5.SS3.p4.4.m4.1.1.1.1.1.2" xref="S5.SS3.p4.4.m4.1.1.1.1.1.2.cmml">d</mi><mo id="S5.SS3.p4.4.m4.1.1.1.1.1.1" xref="S5.SS3.p4.4.m4.1.1.1.1.1.1.cmml">=</mo><mn id="S5.SS3.p4.4.m4.1.1.1.1.1.3" xref="S5.SS3.p4.4.m4.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S5.SS3.p4.4.m4.1.1.1.1.3" stretchy="false" xref="S5.SS3.p4.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.4.m4.1b"><apply id="S5.SS3.p4.4.m4.1.1.cmml" xref="S5.SS3.p4.4.m4.1.1"><times id="S5.SS3.p4.4.m4.1.1.2.cmml" xref="S5.SS3.p4.4.m4.1.1.2"></times><ci id="S5.SS3.p4.4.m4.1.1.3.cmml" xref="S5.SS3.p4.4.m4.1.1.3">𝒰</ci><apply id="S5.SS3.p4.4.m4.1.1.1.1.1.cmml" xref="S5.SS3.p4.4.m4.1.1.1.1"><eq id="S5.SS3.p4.4.m4.1.1.1.1.1.1.cmml" xref="S5.SS3.p4.4.m4.1.1.1.1.1.1"></eq><ci id="S5.SS3.p4.4.m4.1.1.1.1.1.2.cmml" xref="S5.SS3.p4.4.m4.1.1.1.1.1.2">𝑑</ci><cn id="S5.SS3.p4.4.m4.1.1.1.1.1.3.cmml" type="integer" xref="S5.SS3.p4.4.m4.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.4.m4.1c">\mathcal{U}(d=1)</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.4.m4.1d">caligraphic_U ( italic_d = 1 )</annotation></semantics></math> this quickly changes for increasing <math alttext="d" class="ltx_Math" display="inline" id="S5.SS3.p4.5.m5.1"><semantics id="S5.SS3.p4.5.m5.1a"><mi id="S5.SS3.p4.5.m5.1.1" xref="S5.SS3.p4.5.m5.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.5.m5.1b"><ci id="S5.SS3.p4.5.m5.1.1.cmml" xref="S5.SS3.p4.5.m5.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.5.m5.1c">d</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.5.m5.1d">italic_d</annotation></semantics></math>.
The multivariate normal distribution provides a smoother transition, with 75% of points being covered for <math alttext="\epsilon=0.4" class="ltx_Math" display="inline" id="S5.SS3.p4.6.m6.1"><semantics id="S5.SS3.p4.6.m6.1a"><mrow id="S5.SS3.p4.6.m6.1.1" xref="S5.SS3.p4.6.m6.1.1.cmml"><mi id="S5.SS3.p4.6.m6.1.1.2" xref="S5.SS3.p4.6.m6.1.1.2.cmml">ϵ</mi><mo id="S5.SS3.p4.6.m6.1.1.1" xref="S5.SS3.p4.6.m6.1.1.1.cmml">=</mo><mn id="S5.SS3.p4.6.m6.1.1.3" xref="S5.SS3.p4.6.m6.1.1.3.cmml">0.4</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.6.m6.1b"><apply id="S5.SS3.p4.6.m6.1.1.cmml" xref="S5.SS3.p4.6.m6.1.1"><eq id="S5.SS3.p4.6.m6.1.1.1.cmml" xref="S5.SS3.p4.6.m6.1.1.1"></eq><ci id="S5.SS3.p4.6.m6.1.1.2.cmml" xref="S5.SS3.p4.6.m6.1.1.2">italic-ϵ</ci><cn id="S5.SS3.p4.6.m6.1.1.3.cmml" type="float" xref="S5.SS3.p4.6.m6.1.1.3">0.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.6.m6.1c">\epsilon=0.4</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.6.m6.1d">italic_ϵ = 0.4</annotation></semantics></math> at <math alttext="d=8" class="ltx_Math" display="inline" id="S5.SS3.p4.7.m7.1"><semantics id="S5.SS3.p4.7.m7.1a"><mrow id="S5.SS3.p4.7.m7.1.1" xref="S5.SS3.p4.7.m7.1.1.cmml"><mi id="S5.SS3.p4.7.m7.1.1.2" xref="S5.SS3.p4.7.m7.1.1.2.cmml">d</mi><mo id="S5.SS3.p4.7.m7.1.1.1" xref="S5.SS3.p4.7.m7.1.1.1.cmml">=</mo><mn id="S5.SS3.p4.7.m7.1.1.3" xref="S5.SS3.p4.7.m7.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.7.m7.1b"><apply id="S5.SS3.p4.7.m7.1.1.cmml" xref="S5.SS3.p4.7.m7.1.1"><eq id="S5.SS3.p4.7.m7.1.1.1.cmml" xref="S5.SS3.p4.7.m7.1.1.1"></eq><ci id="S5.SS3.p4.7.m7.1.1.2.cmml" xref="S5.SS3.p4.7.m7.1.1.2">𝑑</ci><cn id="S5.SS3.p4.7.m7.1.1.3.cmml" type="integer" xref="S5.SS3.p4.7.m7.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.7.m7.1c">d=8</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.7.m7.1d">italic_d = 8</annotation></semantics></math>, instead of 16%.</p>
</div>
<div class="ltx_para" id="S5.SS3.p5">
<p class="ltx_p" id="S5.SS3.p5.1">A potential downside of using a multivariate normal logging distribution instead of a uniform distribution, is that its domain is unbounded.
Nevertheless, the cumulative density plots show that the probability of observing extreme points is negligible for practical purposes.
We gain the desirable property of more sampled points falling near the mean of the distribution, which in turn implies a higher effective sample size when we wish to evaluate policies that make small, rather than drastic changes to the production weights.</p>
</div>
<div class="ltx_para" id="S5.SS3.p6">
<p class="ltx_p" id="S5.SS3.p6.1">Furthermore, common support for the logging and target policies opens the door to many statistical tools and tricks that allow for more effective and efficient estimation for both evaluation and learning: baseline corrections <cite class="ltx_cite ltx_citemacro_citep">(Gupta et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib22" title="">2024</a>)</cite>, and self-normalisation <cite class="ltx_cite ltx_citemacro_citep">(Swaminathan and Joachims, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib61" title="">2015b</a>)</cite>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Designing a sensitive reward signal</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">The algorithmic decision-making lens that motivates the use of policy learning techniques for recommendation use-cases, allows us to directly target key online metrics as the <em class="ltx_emph ltx_font_italic" id="S6.p1.1.1">reward</em> signal for the learnt policy.
Whilst <em class="ltx_emph ltx_font_italic" id="S6.p1.1.2">effective</em>, typical North Star metrics such as long-term growth might not be <em class="ltx_emph ltx_font_italic" id="S6.p1.1.3">efficient</em> labels to consider.
Indeed, the variance of the estimators discussed in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S3" title="3. Multivariate Off-Policy Learning ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">3</span></a> depends on the inherent variance of the reward signal in the estimand.
As discussed in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S4" title="4. Improving the CRM Lower Bound ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">4</span></a>, the effective sample size is also dependent on this reward, further highlighting its importance as a crucial design consideration in the modelling process.</p>
</div>
<div class="ltx_para" id="S6.p2">
<p class="ltx_p" id="S6.p2.1">In essence, we wish to use a reward signal that is highly (causally) correlated with the North Star, but potentially has lower variance.
Variance reduction techniques are a staple in the online experimentation research literature, typically leveraging regression adjustments as additive control variates <cite class="ltx_cite ltx_citemacro_citep">(Deng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib13" title="">2013</a>; Poyarkov et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib53" title="">2016</a>; Budylin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib6" title="">2018</a>; Baweja et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib2" title="">2024</a>)</cite>.
Note that this line of work is analogous to the use of Doubly Robust estimators in the off-policy learning literature <cite class="ltx_cite ltx_citemacro_citep">(Dudík et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib16" title="">2014</a>; Jeunen and Goethals, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib28" title="">2020</a>)</cite>.
As these techniques would require us to introduce an additional model that estimates the reward, they are out-of-scope for the purposes of this work.</p>
</div>
<div class="ltx_para" id="S6.p3">
<p class="ltx_p" id="S6.p3.1">Other work has focused on “<em class="ltx_emph ltx_font_italic" id="S6.p3.1.1">data-driven metric development</em>” <cite class="ltx_cite ltx_citemacro_citep">(Deng and Shi, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib12" title="">2016</a>)</cite>, <em class="ltx_emph ltx_font_italic" id="S6.p3.1.2">learning</em> online metrics that directly target statistical sensitivity <cite class="ltx_cite ltx_citemacro_citep">(Kharitonov et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib37" title="">2017</a>)</cite>.
We leverage the work of <cite class="ltx_cite ltx_citemacro_citet">Jeunen and Ustimenko (<a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib35" title="">2024</a>)</cite> to learn a reward signal that minimises a convex lower bound on the number of type-III and type-II errors the metric exhibits on a logged dataset of past A/B-experiments.
This minimises observed <math alttext="p" class="ltx_Math" display="inline" id="S6.p3.1.m1.1"><semantics id="S6.p3.1.m1.1a"><mi id="S6.p3.1.m1.1.1" xref="S6.p3.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S6.p3.1.m1.1b"><ci id="S6.p3.1.m1.1.1.cmml" xref="S6.p3.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p3.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S6.p3.1.m1.1d">italic_p</annotation></semantics></math>-values and, hence, maximises statistical power w.r.t. the North Star.
We refer the interested reader to their work for technical details <cite class="ltx_cite ltx_citemacro_citep">(Jeunen and Ustimenko, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib35" title="">2024</a>)</cite>, and evaluate the sensitivity of this learnt metric as a reward signal for off-policy learning and evaluation in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S7" title="7. Experiments &amp; Discussion ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">7</span></a>.</p>
</div>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7. </span>Experiments &amp; Discussion</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">In this section, we wish to empirically validate the theoretical and technical contributions set forth earlier in this article.
The research questions we wish to answer can be summarised as:</p>
<dl class="ltx_description" id="S7.I1">
<dt class="ltx_item" id="S7.I1.ix1"><span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S7.I1.ix1.1.1.1">RQ1: </span></span></dt>
<dd class="ltx_item">
<div class="ltx_para" id="S7.I1.ix1.p1">
<p class="ltx_p" id="S7.I1.ix1.p1.1"><span class="ltx_text ltx_font_italic" id="S7.I1.ix1.p1.1.1">Can effective sample size corrections improve the coverage of estimator confidence intervals for (SN)IPS?</span></p>
</div>
</dd>
<dt class="ltx_item" id="S7.I1.ix2"><span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S7.I1.ix2.1.1.1">RQ2: </span></span></dt>
<dd class="ltx_item">
<div class="ltx_para" id="S7.I1.ix2.p1">
<p class="ltx_p" id="S7.I1.ix2.p1.1"><span class="ltx_text ltx_font_italic" id="S7.I1.ix2.p1.1.1">Does a learnt reward signal affect the sensitivity of results?</span></p>
</div>
</dd>
<dt class="ltx_item" id="S7.I1.ix3"><span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S7.I1.ix3.1.1.1">RQ3: </span></span></dt>
<dd class="ltx_item">
<div class="ltx_para" id="S7.I1.ix3.p1">
<p class="ltx_p" id="S7.I1.ix3.p1.1"><span class="ltx_text ltx_font_italic" id="S7.I1.ix3.p1.1.1">Does our proposed approach lead to offline improvements?</span></p>
</div>
</dd>
<dt class="ltx_item" id="S7.I1.ix4"><span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S7.I1.ix4.1.1.1">RQ4: </span></span></dt>
<dd class="ltx_item">
<div class="ltx_para" id="S7.I1.ix4.p1">
<p class="ltx_p" id="S7.I1.ix4.p1.1"><span class="ltx_text ltx_font_italic" id="S7.I1.ix4.p1.1.1">Does our proposed approach lead to online improvements?</span></p>
</div>
</dd>
</dl>
</div>
<div class="ltx_para" id="S7.p2">
<p class="ltx_p" id="S7.p2.1">All source code to reproduce the empirical results on synthetic data can be found at <a class="ltx_ref ltx_href" href="https://github.com/olivierjeunen/multivariate-policy-learning-recsys-2024" title="">github.com/olivierjeunen/multivariate-policy-learning-recsys-2024</a>.</p>
</div>
<figure class="ltx_figure" id="S7.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="463" id="S7.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S7.F2.4.2.1" style="font-size:90%;">Figure 2</span>. </span><span class="ltx_text" id="S7.F2.2.1" style="font-size:90%;">Off-policy evaluation results for <math alttext="\widehat{V}_{\rm SNIPS}" class="ltx_Math" display="inline" id="S7.F2.2.1.m1.1"><semantics id="S7.F2.2.1.m1.1b"><msub id="S7.F2.2.1.m1.1.1" xref="S7.F2.2.1.m1.1.1.cmml"><mover accent="true" id="S7.F2.2.1.m1.1.1.2" xref="S7.F2.2.1.m1.1.1.2.cmml"><mi id="S7.F2.2.1.m1.1.1.2.2" xref="S7.F2.2.1.m1.1.1.2.2.cmml">V</mi><mo id="S7.F2.2.1.m1.1.1.2.1" xref="S7.F2.2.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S7.F2.2.1.m1.1.1.3" xref="S7.F2.2.1.m1.1.1.3.cmml">SNIPS</mi></msub><annotation-xml encoding="MathML-Content" id="S7.F2.2.1.m1.1c"><apply id="S7.F2.2.1.m1.1.1.cmml" xref="S7.F2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S7.F2.2.1.m1.1.1.1.cmml" xref="S7.F2.2.1.m1.1.1">subscript</csymbol><apply id="S7.F2.2.1.m1.1.1.2.cmml" xref="S7.F2.2.1.m1.1.1.2"><ci id="S7.F2.2.1.m1.1.1.2.1.cmml" xref="S7.F2.2.1.m1.1.1.2.1">^</ci><ci id="S7.F2.2.1.m1.1.1.2.2.cmml" xref="S7.F2.2.1.m1.1.1.2.2">𝑉</ci></apply><ci id="S7.F2.2.1.m1.1.1.3.cmml" xref="S7.F2.2.1.m1.1.1.3">SNIPS</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.F2.2.1.m1.1d">\widehat{V}_{\rm SNIPS}</annotation><annotation encoding="application/x-llamapun" id="S7.F2.2.1.m1.1e">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_SNIPS end_POSTSUBSCRIPT</annotation></semantics></math>, considering the coverage of C.I.s obtained through various variations of our proposed ESS correction. ESS-corrected methods attain target coverage at significantly reduced sample sizes.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S7.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="278" id="S7.F3.g1" src="x3.png" width="747"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S7.F3.6.3.1" style="font-size:90%;">Figure 3</span>. </span><span class="ltx_text" id="S7.F3.4.2" style="font-size:90%;">All considered C.I. corrections significantly reduce the required sample size for the C.I. to achieve its specified coverage level: down to 60<math alttext="\times" class="ltx_Math" display="inline" id="S7.F3.3.1.m1.1"><semantics id="S7.F3.3.1.m1.1b"><mo id="S7.F3.3.1.m1.1.1" xref="S7.F3.3.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S7.F3.3.1.m1.1c"><times id="S7.F3.3.1.m1.1.1.cmml" xref="S7.F3.3.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S7.F3.3.1.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S7.F3.3.1.m1.1e">×</annotation></semantics></math> on average for <math alttext="D_{N}^{R-\infty}" class="ltx_Math" display="inline" id="S7.F3.4.2.m2.1"><semantics id="S7.F3.4.2.m2.1b"><msubsup id="S7.F3.4.2.m2.1.1" xref="S7.F3.4.2.m2.1.1.cmml"><mi id="S7.F3.4.2.m2.1.1.2.2" xref="S7.F3.4.2.m2.1.1.2.2.cmml">D</mi><mi id="S7.F3.4.2.m2.1.1.2.3" xref="S7.F3.4.2.m2.1.1.2.3.cmml">N</mi><mrow id="S7.F3.4.2.m2.1.1.3" xref="S7.F3.4.2.m2.1.1.3.cmml"><mi id="S7.F3.4.2.m2.1.1.3.2" xref="S7.F3.4.2.m2.1.1.3.2.cmml">R</mi><mo id="S7.F3.4.2.m2.1.1.3.1" xref="S7.F3.4.2.m2.1.1.3.1.cmml">−</mo><mi id="S7.F3.4.2.m2.1.1.3.3" mathvariant="normal" xref="S7.F3.4.2.m2.1.1.3.3.cmml">∞</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S7.F3.4.2.m2.1c"><apply id="S7.F3.4.2.m2.1.1.cmml" xref="S7.F3.4.2.m2.1.1"><csymbol cd="ambiguous" id="S7.F3.4.2.m2.1.1.1.cmml" xref="S7.F3.4.2.m2.1.1">superscript</csymbol><apply id="S7.F3.4.2.m2.1.1.2.cmml" xref="S7.F3.4.2.m2.1.1"><csymbol cd="ambiguous" id="S7.F3.4.2.m2.1.1.2.1.cmml" xref="S7.F3.4.2.m2.1.1">subscript</csymbol><ci id="S7.F3.4.2.m2.1.1.2.2.cmml" xref="S7.F3.4.2.m2.1.1.2.2">𝐷</ci><ci id="S7.F3.4.2.m2.1.1.2.3.cmml" xref="S7.F3.4.2.m2.1.1.2.3">𝑁</ci></apply><apply id="S7.F3.4.2.m2.1.1.3.cmml" xref="S7.F3.4.2.m2.1.1.3"><minus id="S7.F3.4.2.m2.1.1.3.1.cmml" xref="S7.F3.4.2.m2.1.1.3.1"></minus><ci id="S7.F3.4.2.m2.1.1.3.2.cmml" xref="S7.F3.4.2.m2.1.1.3.2">𝑅</ci><infinity id="S7.F3.4.2.m2.1.1.3.3.cmml" xref="S7.F3.4.2.m2.1.1.3.3"></infinity></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.F3.4.2.m2.1d">D_{N}^{R-\infty}</annotation><annotation encoding="application/x-llamapun" id="S7.F3.4.2.m2.1e">italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_R - ∞ end_POSTSUPERSCRIPT</annotation></semantics></math>.</span></figcaption>
</figure>
<section class="ltx_subsection" id="S7.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.1. </span>ESS Corrections &amp; Estimator Coverage (RQ1)</h3>
<div class="ltx_para" id="S7.SS1.p1">
<p class="ltx_p" id="S7.SS1.p1.1">As argued in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S4" title="4. Improving the CRM Lower Bound ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">4</span></a>: whilst existing variance estimators for the CRM objective are guaranteed to hold in the limit of large sample sizes because of the CLT, they might give rise to confidence interval that exhibit insufficient coverage in finite sample scenarios.
We wish to validate whether the policy-dependent correction laid out in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S4" title="4. Improving the CRM Lower Bound ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">4</span></a> can improve empirical coverage, when using a range of potential estimators for the effective sample size.</p>
</div>
<div class="ltx_para" id="S7.SS1.p2">
<p class="ltx_p" id="S7.SS1.p2.1">Naturally, the statistical coverage of a confidence interval can only be validated via simulation studies using synthetic data.
This has the added advantage of ease-of-reproducibility.</p>
</div>
<div class="ltx_para" id="S7.SS1.p3">
<p class="ltx_p" id="S7.SS1.p3.11">We simulate a multivariate isotropic Gaussian logging policy with identity co-variance and <math alttext="d=5" class="ltx_Math" display="inline" id="S7.SS1.p3.1.m1.1"><semantics id="S7.SS1.p3.1.m1.1a"><mrow id="S7.SS1.p3.1.m1.1.1" xref="S7.SS1.p3.1.m1.1.1.cmml"><mi id="S7.SS1.p3.1.m1.1.1.2" xref="S7.SS1.p3.1.m1.1.1.2.cmml">d</mi><mo id="S7.SS1.p3.1.m1.1.1.1" xref="S7.SS1.p3.1.m1.1.1.1.cmml">=</mo><mn id="S7.SS1.p3.1.m1.1.1.3" xref="S7.SS1.p3.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p3.1.m1.1b"><apply id="S7.SS1.p3.1.m1.1.1.cmml" xref="S7.SS1.p3.1.m1.1.1"><eq id="S7.SS1.p3.1.m1.1.1.1.cmml" xref="S7.SS1.p3.1.m1.1.1.1"></eq><ci id="S7.SS1.p3.1.m1.1.1.2.cmml" xref="S7.SS1.p3.1.m1.1.1.2">𝑑</ci><cn id="S7.SS1.p3.1.m1.1.1.3.cmml" type="integer" xref="S7.SS1.p3.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p3.1.m1.1c">d=5</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p3.1.m1.1d">italic_d = 5</annotation></semantics></math> dimensions, centred at the origin.
We shift the target policies to be centred at <math alttext="\mu_{t}=0.5" class="ltx_Math" display="inline" id="S7.SS1.p3.2.m2.1"><semantics id="S7.SS1.p3.2.m2.1a"><mrow id="S7.SS1.p3.2.m2.1.1" xref="S7.SS1.p3.2.m2.1.1.cmml"><msub id="S7.SS1.p3.2.m2.1.1.2" xref="S7.SS1.p3.2.m2.1.1.2.cmml"><mi id="S7.SS1.p3.2.m2.1.1.2.2" xref="S7.SS1.p3.2.m2.1.1.2.2.cmml">μ</mi><mi id="S7.SS1.p3.2.m2.1.1.2.3" xref="S7.SS1.p3.2.m2.1.1.2.3.cmml">t</mi></msub><mo id="S7.SS1.p3.2.m2.1.1.1" xref="S7.SS1.p3.2.m2.1.1.1.cmml">=</mo><mn id="S7.SS1.p3.2.m2.1.1.3" xref="S7.SS1.p3.2.m2.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p3.2.m2.1b"><apply id="S7.SS1.p3.2.m2.1.1.cmml" xref="S7.SS1.p3.2.m2.1.1"><eq id="S7.SS1.p3.2.m2.1.1.1.cmml" xref="S7.SS1.p3.2.m2.1.1.1"></eq><apply id="S7.SS1.p3.2.m2.1.1.2.cmml" xref="S7.SS1.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S7.SS1.p3.2.m2.1.1.2.1.cmml" xref="S7.SS1.p3.2.m2.1.1.2">subscript</csymbol><ci id="S7.SS1.p3.2.m2.1.1.2.2.cmml" xref="S7.SS1.p3.2.m2.1.1.2.2">𝜇</ci><ci id="S7.SS1.p3.2.m2.1.1.2.3.cmml" xref="S7.SS1.p3.2.m2.1.1.2.3">𝑡</ci></apply><cn id="S7.SS1.p3.2.m2.1.1.3.cmml" type="float" xref="S7.SS1.p3.2.m2.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p3.2.m2.1c">\mu_{t}=0.5</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p3.2.m2.1d">italic_μ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = 0.5</annotation></semantics></math>, and consider varying standard deviations <math alttext="\sigma\in\{1,0.5,0.25,0.125,0.0625\}" class="ltx_Math" display="inline" id="S7.SS1.p3.3.m3.5"><semantics id="S7.SS1.p3.3.m3.5a"><mrow id="S7.SS1.p3.3.m3.5.6" xref="S7.SS1.p3.3.m3.5.6.cmml"><mi id="S7.SS1.p3.3.m3.5.6.2" xref="S7.SS1.p3.3.m3.5.6.2.cmml">σ</mi><mo id="S7.SS1.p3.3.m3.5.6.1" xref="S7.SS1.p3.3.m3.5.6.1.cmml">∈</mo><mrow id="S7.SS1.p3.3.m3.5.6.3.2" xref="S7.SS1.p3.3.m3.5.6.3.1.cmml"><mo id="S7.SS1.p3.3.m3.5.6.3.2.1" stretchy="false" xref="S7.SS1.p3.3.m3.5.6.3.1.cmml">{</mo><mn id="S7.SS1.p3.3.m3.1.1" xref="S7.SS1.p3.3.m3.1.1.cmml">1</mn><mo id="S7.SS1.p3.3.m3.5.6.3.2.2" xref="S7.SS1.p3.3.m3.5.6.3.1.cmml">,</mo><mn id="S7.SS1.p3.3.m3.2.2" xref="S7.SS1.p3.3.m3.2.2.cmml">0.5</mn><mo id="S7.SS1.p3.3.m3.5.6.3.2.3" xref="S7.SS1.p3.3.m3.5.6.3.1.cmml">,</mo><mn id="S7.SS1.p3.3.m3.3.3" xref="S7.SS1.p3.3.m3.3.3.cmml">0.25</mn><mo id="S7.SS1.p3.3.m3.5.6.3.2.4" xref="S7.SS1.p3.3.m3.5.6.3.1.cmml">,</mo><mn id="S7.SS1.p3.3.m3.4.4" xref="S7.SS1.p3.3.m3.4.4.cmml">0.125</mn><mo id="S7.SS1.p3.3.m3.5.6.3.2.5" xref="S7.SS1.p3.3.m3.5.6.3.1.cmml">,</mo><mn id="S7.SS1.p3.3.m3.5.5" xref="S7.SS1.p3.3.m3.5.5.cmml">0.0625</mn><mo id="S7.SS1.p3.3.m3.5.6.3.2.6" stretchy="false" xref="S7.SS1.p3.3.m3.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p3.3.m3.5b"><apply id="S7.SS1.p3.3.m3.5.6.cmml" xref="S7.SS1.p3.3.m3.5.6"><in id="S7.SS1.p3.3.m3.5.6.1.cmml" xref="S7.SS1.p3.3.m3.5.6.1"></in><ci id="S7.SS1.p3.3.m3.5.6.2.cmml" xref="S7.SS1.p3.3.m3.5.6.2">𝜎</ci><set id="S7.SS1.p3.3.m3.5.6.3.1.cmml" xref="S7.SS1.p3.3.m3.5.6.3.2"><cn id="S7.SS1.p3.3.m3.1.1.cmml" type="integer" xref="S7.SS1.p3.3.m3.1.1">1</cn><cn id="S7.SS1.p3.3.m3.2.2.cmml" type="float" xref="S7.SS1.p3.3.m3.2.2">0.5</cn><cn id="S7.SS1.p3.3.m3.3.3.cmml" type="float" xref="S7.SS1.p3.3.m3.3.3">0.25</cn><cn id="S7.SS1.p3.3.m3.4.4.cmml" type="float" xref="S7.SS1.p3.3.m3.4.4">0.125</cn><cn id="S7.SS1.p3.3.m3.5.5.cmml" type="float" xref="S7.SS1.p3.3.m3.5.5">0.0625</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p3.3.m3.5c">\sigma\in\{1,0.5,0.25,0.125,0.0625\}</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p3.3.m3.5d">italic_σ ∈ { 1 , 0.5 , 0.25 , 0.125 , 0.0625 }</annotation></semantics></math>.
To simulate a realistic setting where the target is e.g. the number of active days a user spends on the platform, we sample Poisson-distributed rewards where the rate is proportional to the average of the weights <math alttext="\bar{a}" class="ltx_Math" display="inline" id="S7.SS1.p3.4.m4.1"><semantics id="S7.SS1.p3.4.m4.1a"><mover accent="true" id="S7.SS1.p3.4.m4.1.1" xref="S7.SS1.p3.4.m4.1.1.cmml"><mi id="S7.SS1.p3.4.m4.1.1.2" xref="S7.SS1.p3.4.m4.1.1.2.cmml">a</mi><mo id="S7.SS1.p3.4.m4.1.1.1" xref="S7.SS1.p3.4.m4.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S7.SS1.p3.4.m4.1b"><apply id="S7.SS1.p3.4.m4.1.1.cmml" xref="S7.SS1.p3.4.m4.1.1"><ci id="S7.SS1.p3.4.m4.1.1.1.cmml" xref="S7.SS1.p3.4.m4.1.1.1">¯</ci><ci id="S7.SS1.p3.4.m4.1.1.2.cmml" xref="S7.SS1.p3.4.m4.1.1.2">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p3.4.m4.1c">\bar{a}</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p3.4.m4.1d">over¯ start_ARG italic_a end_ARG</annotation></semantics></math>: <math alttext="r\sim{\rm Poisson}(\max(0,0.1\cdot\bar{a}))" class="ltx_Math" display="inline" id="S7.SS1.p3.5.m5.3"><semantics id="S7.SS1.p3.5.m5.3a"><mrow id="S7.SS1.p3.5.m5.3.3" xref="S7.SS1.p3.5.m5.3.3.cmml"><mi id="S7.SS1.p3.5.m5.3.3.3" xref="S7.SS1.p3.5.m5.3.3.3.cmml">r</mi><mo id="S7.SS1.p3.5.m5.3.3.2" xref="S7.SS1.p3.5.m5.3.3.2.cmml">∼</mo><mrow id="S7.SS1.p3.5.m5.3.3.1" xref="S7.SS1.p3.5.m5.3.3.1.cmml"><mi id="S7.SS1.p3.5.m5.3.3.1.3" xref="S7.SS1.p3.5.m5.3.3.1.3.cmml">Poisson</mi><mo id="S7.SS1.p3.5.m5.3.3.1.2" xref="S7.SS1.p3.5.m5.3.3.1.2.cmml">⁢</mo><mrow id="S7.SS1.p3.5.m5.3.3.1.1.1" xref="S7.SS1.p3.5.m5.3.3.1.cmml"><mo id="S7.SS1.p3.5.m5.3.3.1.1.1.2" stretchy="false" xref="S7.SS1.p3.5.m5.3.3.1.cmml">(</mo><mrow id="S7.SS1.p3.5.m5.3.3.1.1.1.1.1" xref="S7.SS1.p3.5.m5.3.3.1.1.1.1.2.cmml"><mi id="S7.SS1.p3.5.m5.1.1" xref="S7.SS1.p3.5.m5.1.1.cmml">max</mi><mo id="S7.SS1.p3.5.m5.3.3.1.1.1.1.1a" xref="S7.SS1.p3.5.m5.3.3.1.1.1.1.2.cmml">⁡</mo><mrow id="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1" xref="S7.SS1.p3.5.m5.3.3.1.1.1.1.2.cmml"><mo id="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S7.SS1.p3.5.m5.3.3.1.1.1.1.2.cmml">(</mo><mn id="S7.SS1.p3.5.m5.2.2" xref="S7.SS1.p3.5.m5.2.2.cmml">0</mn><mo id="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1.3" xref="S7.SS1.p3.5.m5.3.3.1.1.1.1.2.cmml">,</mo><mrow id="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1.1" xref="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1.1.cmml"><mn id="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1.1.2" xref="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1.1.2.cmml">0.1</mn><mo id="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1.1.1.cmml">⋅</mo><mover accent="true" id="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1.1.3" xref="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1.1.3.2" xref="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1.1.3.2.cmml">a</mi><mo id="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1.1.3.1" xref="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1.1.3.1.cmml">¯</mo></mover></mrow><mo id="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1.4" stretchy="false" xref="S7.SS1.p3.5.m5.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S7.SS1.p3.5.m5.3.3.1.1.1.3" stretchy="false" xref="S7.SS1.p3.5.m5.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p3.5.m5.3b"><apply id="S7.SS1.p3.5.m5.3.3.cmml" xref="S7.SS1.p3.5.m5.3.3"><csymbol cd="latexml" id="S7.SS1.p3.5.m5.3.3.2.cmml" xref="S7.SS1.p3.5.m5.3.3.2">similar-to</csymbol><ci id="S7.SS1.p3.5.m5.3.3.3.cmml" xref="S7.SS1.p3.5.m5.3.3.3">𝑟</ci><apply id="S7.SS1.p3.5.m5.3.3.1.cmml" xref="S7.SS1.p3.5.m5.3.3.1"><times id="S7.SS1.p3.5.m5.3.3.1.2.cmml" xref="S7.SS1.p3.5.m5.3.3.1.2"></times><ci id="S7.SS1.p3.5.m5.3.3.1.3.cmml" xref="S7.SS1.p3.5.m5.3.3.1.3">Poisson</ci><apply id="S7.SS1.p3.5.m5.3.3.1.1.1.1.2.cmml" xref="S7.SS1.p3.5.m5.3.3.1.1.1.1.1"><max id="S7.SS1.p3.5.m5.1.1.cmml" xref="S7.SS1.p3.5.m5.1.1"></max><cn id="S7.SS1.p3.5.m5.2.2.cmml" type="integer" xref="S7.SS1.p3.5.m5.2.2">0</cn><apply id="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1.1.cmml" xref="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1.1"><ci id="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1.1.1.cmml" xref="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1.1.1">⋅</ci><cn id="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1.1.2.cmml" type="float" xref="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1.1.2">0.1</cn><apply id="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1.1.3.cmml" xref="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1.1.3"><ci id="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1.1.3.1">¯</ci><ci id="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S7.SS1.p3.5.m5.3.3.1.1.1.1.1.1.1.3.2">𝑎</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p3.5.m5.3c">r\sim{\rm Poisson}(\max(0,0.1\cdot\bar{a}))</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p3.5.m5.3d">italic_r ∼ roman_Poisson ( roman_max ( 0 , 0.1 ⋅ over¯ start_ARG italic_a end_ARG ) )</annotation></semantics></math>.
This allows us to easily recover the ground truth policy value, as <math alttext="\mathbb{E}_{a\sim\mathcal{N}(\mu_{t},\sigma I)}[R]=0.1\cdot\mu_{t}" class="ltx_Math" display="inline" id="S7.SS1.p3.6.m6.3"><semantics id="S7.SS1.p3.6.m6.3a"><mrow id="S7.SS1.p3.6.m6.3.4" xref="S7.SS1.p3.6.m6.3.4.cmml"><mrow id="S7.SS1.p3.6.m6.3.4.2" xref="S7.SS1.p3.6.m6.3.4.2.cmml"><msub id="S7.SS1.p3.6.m6.3.4.2.2" xref="S7.SS1.p3.6.m6.3.4.2.2.cmml"><mi id="S7.SS1.p3.6.m6.3.4.2.2.2" xref="S7.SS1.p3.6.m6.3.4.2.2.2.cmml">𝔼</mi><mrow id="S7.SS1.p3.6.m6.2.2.2" xref="S7.SS1.p3.6.m6.2.2.2.cmml"><mi id="S7.SS1.p3.6.m6.2.2.2.4" xref="S7.SS1.p3.6.m6.2.2.2.4.cmml">a</mi><mo id="S7.SS1.p3.6.m6.2.2.2.3" xref="S7.SS1.p3.6.m6.2.2.2.3.cmml">∼</mo><mrow id="S7.SS1.p3.6.m6.2.2.2.2" xref="S7.SS1.p3.6.m6.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p3.6.m6.2.2.2.2.4" xref="S7.SS1.p3.6.m6.2.2.2.2.4.cmml">𝒩</mi><mo id="S7.SS1.p3.6.m6.2.2.2.2.3" xref="S7.SS1.p3.6.m6.2.2.2.2.3.cmml">⁢</mo><mrow id="S7.SS1.p3.6.m6.2.2.2.2.2.2" xref="S7.SS1.p3.6.m6.2.2.2.2.2.3.cmml"><mo id="S7.SS1.p3.6.m6.2.2.2.2.2.2.3" stretchy="false" xref="S7.SS1.p3.6.m6.2.2.2.2.2.3.cmml">(</mo><msub id="S7.SS1.p3.6.m6.1.1.1.1.1.1.1" xref="S7.SS1.p3.6.m6.1.1.1.1.1.1.1.cmml"><mi id="S7.SS1.p3.6.m6.1.1.1.1.1.1.1.2" xref="S7.SS1.p3.6.m6.1.1.1.1.1.1.1.2.cmml">μ</mi><mi id="S7.SS1.p3.6.m6.1.1.1.1.1.1.1.3" xref="S7.SS1.p3.6.m6.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S7.SS1.p3.6.m6.2.2.2.2.2.2.4" xref="S7.SS1.p3.6.m6.2.2.2.2.2.3.cmml">,</mo><mrow id="S7.SS1.p3.6.m6.2.2.2.2.2.2.2" xref="S7.SS1.p3.6.m6.2.2.2.2.2.2.2.cmml"><mi id="S7.SS1.p3.6.m6.2.2.2.2.2.2.2.2" xref="S7.SS1.p3.6.m6.2.2.2.2.2.2.2.2.cmml">σ</mi><mo id="S7.SS1.p3.6.m6.2.2.2.2.2.2.2.1" xref="S7.SS1.p3.6.m6.2.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="S7.SS1.p3.6.m6.2.2.2.2.2.2.2.3" xref="S7.SS1.p3.6.m6.2.2.2.2.2.2.2.3.cmml">I</mi></mrow><mo id="S7.SS1.p3.6.m6.2.2.2.2.2.2.5" stretchy="false" xref="S7.SS1.p3.6.m6.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></msub><mo id="S7.SS1.p3.6.m6.3.4.2.1" xref="S7.SS1.p3.6.m6.3.4.2.1.cmml">⁢</mo><mrow id="S7.SS1.p3.6.m6.3.4.2.3.2" xref="S7.SS1.p3.6.m6.3.4.2.3.1.cmml"><mo id="S7.SS1.p3.6.m6.3.4.2.3.2.1" stretchy="false" xref="S7.SS1.p3.6.m6.3.4.2.3.1.1.cmml">[</mo><mi id="S7.SS1.p3.6.m6.3.3" xref="S7.SS1.p3.6.m6.3.3.cmml">R</mi><mo id="S7.SS1.p3.6.m6.3.4.2.3.2.2" stretchy="false" xref="S7.SS1.p3.6.m6.3.4.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S7.SS1.p3.6.m6.3.4.1" xref="S7.SS1.p3.6.m6.3.4.1.cmml">=</mo><mrow id="S7.SS1.p3.6.m6.3.4.3" xref="S7.SS1.p3.6.m6.3.4.3.cmml"><mn id="S7.SS1.p3.6.m6.3.4.3.2" xref="S7.SS1.p3.6.m6.3.4.3.2.cmml">0.1</mn><mo id="S7.SS1.p3.6.m6.3.4.3.1" lspace="0.222em" rspace="0.222em" xref="S7.SS1.p3.6.m6.3.4.3.1.cmml">⋅</mo><msub id="S7.SS1.p3.6.m6.3.4.3.3" xref="S7.SS1.p3.6.m6.3.4.3.3.cmml"><mi id="S7.SS1.p3.6.m6.3.4.3.3.2" xref="S7.SS1.p3.6.m6.3.4.3.3.2.cmml">μ</mi><mi id="S7.SS1.p3.6.m6.3.4.3.3.3" xref="S7.SS1.p3.6.m6.3.4.3.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p3.6.m6.3b"><apply id="S7.SS1.p3.6.m6.3.4.cmml" xref="S7.SS1.p3.6.m6.3.4"><eq id="S7.SS1.p3.6.m6.3.4.1.cmml" xref="S7.SS1.p3.6.m6.3.4.1"></eq><apply id="S7.SS1.p3.6.m6.3.4.2.cmml" xref="S7.SS1.p3.6.m6.3.4.2"><times id="S7.SS1.p3.6.m6.3.4.2.1.cmml" xref="S7.SS1.p3.6.m6.3.4.2.1"></times><apply id="S7.SS1.p3.6.m6.3.4.2.2.cmml" xref="S7.SS1.p3.6.m6.3.4.2.2"><csymbol cd="ambiguous" id="S7.SS1.p3.6.m6.3.4.2.2.1.cmml" xref="S7.SS1.p3.6.m6.3.4.2.2">subscript</csymbol><ci id="S7.SS1.p3.6.m6.3.4.2.2.2.cmml" xref="S7.SS1.p3.6.m6.3.4.2.2.2">𝔼</ci><apply id="S7.SS1.p3.6.m6.2.2.2.cmml" xref="S7.SS1.p3.6.m6.2.2.2"><csymbol cd="latexml" id="S7.SS1.p3.6.m6.2.2.2.3.cmml" xref="S7.SS1.p3.6.m6.2.2.2.3">similar-to</csymbol><ci id="S7.SS1.p3.6.m6.2.2.2.4.cmml" xref="S7.SS1.p3.6.m6.2.2.2.4">𝑎</ci><apply id="S7.SS1.p3.6.m6.2.2.2.2.cmml" xref="S7.SS1.p3.6.m6.2.2.2.2"><times id="S7.SS1.p3.6.m6.2.2.2.2.3.cmml" xref="S7.SS1.p3.6.m6.2.2.2.2.3"></times><ci id="S7.SS1.p3.6.m6.2.2.2.2.4.cmml" xref="S7.SS1.p3.6.m6.2.2.2.2.4">𝒩</ci><interval closure="open" id="S7.SS1.p3.6.m6.2.2.2.2.2.3.cmml" xref="S7.SS1.p3.6.m6.2.2.2.2.2.2"><apply id="S7.SS1.p3.6.m6.1.1.1.1.1.1.1.cmml" xref="S7.SS1.p3.6.m6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.SS1.p3.6.m6.1.1.1.1.1.1.1.1.cmml" xref="S7.SS1.p3.6.m6.1.1.1.1.1.1.1">subscript</csymbol><ci id="S7.SS1.p3.6.m6.1.1.1.1.1.1.1.2.cmml" xref="S7.SS1.p3.6.m6.1.1.1.1.1.1.1.2">𝜇</ci><ci id="S7.SS1.p3.6.m6.1.1.1.1.1.1.1.3.cmml" xref="S7.SS1.p3.6.m6.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S7.SS1.p3.6.m6.2.2.2.2.2.2.2.cmml" xref="S7.SS1.p3.6.m6.2.2.2.2.2.2.2"><times id="S7.SS1.p3.6.m6.2.2.2.2.2.2.2.1.cmml" xref="S7.SS1.p3.6.m6.2.2.2.2.2.2.2.1"></times><ci id="S7.SS1.p3.6.m6.2.2.2.2.2.2.2.2.cmml" xref="S7.SS1.p3.6.m6.2.2.2.2.2.2.2.2">𝜎</ci><ci id="S7.SS1.p3.6.m6.2.2.2.2.2.2.2.3.cmml" xref="S7.SS1.p3.6.m6.2.2.2.2.2.2.2.3">𝐼</ci></apply></interval></apply></apply></apply><apply id="S7.SS1.p3.6.m6.3.4.2.3.1.cmml" xref="S7.SS1.p3.6.m6.3.4.2.3.2"><csymbol cd="latexml" id="S7.SS1.p3.6.m6.3.4.2.3.1.1.cmml" xref="S7.SS1.p3.6.m6.3.4.2.3.2.1">delimited-[]</csymbol><ci id="S7.SS1.p3.6.m6.3.3.cmml" xref="S7.SS1.p3.6.m6.3.3">𝑅</ci></apply></apply><apply id="S7.SS1.p3.6.m6.3.4.3.cmml" xref="S7.SS1.p3.6.m6.3.4.3"><ci id="S7.SS1.p3.6.m6.3.4.3.1.cmml" xref="S7.SS1.p3.6.m6.3.4.3.1">⋅</ci><cn id="S7.SS1.p3.6.m6.3.4.3.2.cmml" type="float" xref="S7.SS1.p3.6.m6.3.4.3.2">0.1</cn><apply id="S7.SS1.p3.6.m6.3.4.3.3.cmml" xref="S7.SS1.p3.6.m6.3.4.3.3"><csymbol cd="ambiguous" id="S7.SS1.p3.6.m6.3.4.3.3.1.cmml" xref="S7.SS1.p3.6.m6.3.4.3.3">subscript</csymbol><ci id="S7.SS1.p3.6.m6.3.4.3.3.2.cmml" xref="S7.SS1.p3.6.m6.3.4.3.3.2">𝜇</ci><ci id="S7.SS1.p3.6.m6.3.4.3.3.3.cmml" xref="S7.SS1.p3.6.m6.3.4.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p3.6.m6.3c">\mathbb{E}_{a\sim\mathcal{N}(\mu_{t},\sigma I)}[R]=0.1\cdot\mu_{t}</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p3.6.m6.3d">blackboard_E start_POSTSUBSCRIPT italic_a ∼ caligraphic_N ( italic_μ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_σ italic_I ) end_POSTSUBSCRIPT [ italic_R ] = 0.1 ⋅ italic_μ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.
We sample between <math alttext="2^{3}" class="ltx_Math" display="inline" id="S7.SS1.p3.7.m7.1"><semantics id="S7.SS1.p3.7.m7.1a"><msup id="S7.SS1.p3.7.m7.1.1" xref="S7.SS1.p3.7.m7.1.1.cmml"><mn id="S7.SS1.p3.7.m7.1.1.2" xref="S7.SS1.p3.7.m7.1.1.2.cmml">2</mn><mn id="S7.SS1.p3.7.m7.1.1.3" xref="S7.SS1.p3.7.m7.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S7.SS1.p3.7.m7.1b"><apply id="S7.SS1.p3.7.m7.1.1.cmml" xref="S7.SS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S7.SS1.p3.7.m7.1.1.1.cmml" xref="S7.SS1.p3.7.m7.1.1">superscript</csymbol><cn id="S7.SS1.p3.7.m7.1.1.2.cmml" type="integer" xref="S7.SS1.p3.7.m7.1.1.2">2</cn><cn id="S7.SS1.p3.7.m7.1.1.3.cmml" type="integer" xref="S7.SS1.p3.7.m7.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p3.7.m7.1c">2^{3}</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p3.7.m7.1d">2 start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="2^{20}" class="ltx_Math" display="inline" id="S7.SS1.p3.8.m8.1"><semantics id="S7.SS1.p3.8.m8.1a"><msup id="S7.SS1.p3.8.m8.1.1" xref="S7.SS1.p3.8.m8.1.1.cmml"><mn id="S7.SS1.p3.8.m8.1.1.2" xref="S7.SS1.p3.8.m8.1.1.2.cmml">2</mn><mn id="S7.SS1.p3.8.m8.1.1.3" xref="S7.SS1.p3.8.m8.1.1.3.cmml">20</mn></msup><annotation-xml encoding="MathML-Content" id="S7.SS1.p3.8.m8.1b"><apply id="S7.SS1.p3.8.m8.1.1.cmml" xref="S7.SS1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S7.SS1.p3.8.m8.1.1.1.cmml" xref="S7.SS1.p3.8.m8.1.1">superscript</csymbol><cn id="S7.SS1.p3.8.m8.1.1.2.cmml" type="integer" xref="S7.SS1.p3.8.m8.1.1.2">2</cn><cn id="S7.SS1.p3.8.m8.1.1.3.cmml" type="integer" xref="S7.SS1.p3.8.m8.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p3.8.m8.1c">2^{20}</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p3.8.m8.1d">2 start_POSTSUPERSCRIPT 20 end_POSTSUPERSCRIPT</annotation></semantics></math> data points from <math alttext="\pi_{0}" class="ltx_Math" display="inline" id="S7.SS1.p3.9.m9.1"><semantics id="S7.SS1.p3.9.m9.1a"><msub id="S7.SS1.p3.9.m9.1.1" xref="S7.SS1.p3.9.m9.1.1.cmml"><mi id="S7.SS1.p3.9.m9.1.1.2" xref="S7.SS1.p3.9.m9.1.1.2.cmml">π</mi><mn id="S7.SS1.p3.9.m9.1.1.3" xref="S7.SS1.p3.9.m9.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S7.SS1.p3.9.m9.1b"><apply id="S7.SS1.p3.9.m9.1.1.cmml" xref="S7.SS1.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S7.SS1.p3.9.m9.1.1.1.cmml" xref="S7.SS1.p3.9.m9.1.1">subscript</csymbol><ci id="S7.SS1.p3.9.m9.1.1.2.cmml" xref="S7.SS1.p3.9.m9.1.1.2">𝜋</ci><cn id="S7.SS1.p3.9.m9.1.1.3.cmml" type="integer" xref="S7.SS1.p3.9.m9.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p3.9.m9.1c">\pi_{0}</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p3.9.m9.1d">italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> and use these to estimate the value of the target policy <math alttext="\widehat{V}_{\rm(SN)IPS}(\pi_{t})" class="ltx_Math" display="inline" id="S7.SS1.p3.10.m10.2"><semantics id="S7.SS1.p3.10.m10.2a"><mrow id="S7.SS1.p3.10.m10.2.2" xref="S7.SS1.p3.10.m10.2.2.cmml"><msub id="S7.SS1.p3.10.m10.2.2.3" xref="S7.SS1.p3.10.m10.2.2.3.cmml"><mover accent="true" id="S7.SS1.p3.10.m10.2.2.3.2" xref="S7.SS1.p3.10.m10.2.2.3.2.cmml"><mi id="S7.SS1.p3.10.m10.2.2.3.2.2" xref="S7.SS1.p3.10.m10.2.2.3.2.2.cmml">V</mi><mo id="S7.SS1.p3.10.m10.2.2.3.2.1" xref="S7.SS1.p3.10.m10.2.2.3.2.1.cmml">^</mo></mover><mrow id="S7.SS1.p3.10.m10.1.1.1" xref="S7.SS1.p3.10.m10.1.1.1.cmml"><mrow id="S7.SS1.p3.10.m10.1.1.1.3.2" xref="S7.SS1.p3.10.m10.1.1.1.cmml"><mo id="S7.SS1.p3.10.m10.1.1.1.3.2.1" stretchy="false" xref="S7.SS1.p3.10.m10.1.1.1.cmml">(</mo><mi id="S7.SS1.p3.10.m10.1.1.1.1" xref="S7.SS1.p3.10.m10.1.1.1.1.cmml">SN</mi><mo id="S7.SS1.p3.10.m10.1.1.1.3.2.2" stretchy="false" xref="S7.SS1.p3.10.m10.1.1.1.cmml">)</mo></mrow><mo id="S7.SS1.p3.10.m10.1.1.1.2" xref="S7.SS1.p3.10.m10.1.1.1.2.cmml">⁢</mo><mi id="S7.SS1.p3.10.m10.1.1.1.4" xref="S7.SS1.p3.10.m10.1.1.1.4.cmml">IPS</mi></mrow></msub><mo id="S7.SS1.p3.10.m10.2.2.2" xref="S7.SS1.p3.10.m10.2.2.2.cmml">⁢</mo><mrow id="S7.SS1.p3.10.m10.2.2.1.1" xref="S7.SS1.p3.10.m10.2.2.1.1.1.cmml"><mo id="S7.SS1.p3.10.m10.2.2.1.1.2" stretchy="false" xref="S7.SS1.p3.10.m10.2.2.1.1.1.cmml">(</mo><msub id="S7.SS1.p3.10.m10.2.2.1.1.1" xref="S7.SS1.p3.10.m10.2.2.1.1.1.cmml"><mi id="S7.SS1.p3.10.m10.2.2.1.1.1.2" xref="S7.SS1.p3.10.m10.2.2.1.1.1.2.cmml">π</mi><mi id="S7.SS1.p3.10.m10.2.2.1.1.1.3" xref="S7.SS1.p3.10.m10.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S7.SS1.p3.10.m10.2.2.1.1.3" stretchy="false" xref="S7.SS1.p3.10.m10.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p3.10.m10.2b"><apply id="S7.SS1.p3.10.m10.2.2.cmml" xref="S7.SS1.p3.10.m10.2.2"><times id="S7.SS1.p3.10.m10.2.2.2.cmml" xref="S7.SS1.p3.10.m10.2.2.2"></times><apply id="S7.SS1.p3.10.m10.2.2.3.cmml" xref="S7.SS1.p3.10.m10.2.2.3"><csymbol cd="ambiguous" id="S7.SS1.p3.10.m10.2.2.3.1.cmml" xref="S7.SS1.p3.10.m10.2.2.3">subscript</csymbol><apply id="S7.SS1.p3.10.m10.2.2.3.2.cmml" xref="S7.SS1.p3.10.m10.2.2.3.2"><ci id="S7.SS1.p3.10.m10.2.2.3.2.1.cmml" xref="S7.SS1.p3.10.m10.2.2.3.2.1">^</ci><ci id="S7.SS1.p3.10.m10.2.2.3.2.2.cmml" xref="S7.SS1.p3.10.m10.2.2.3.2.2">𝑉</ci></apply><apply id="S7.SS1.p3.10.m10.1.1.1.cmml" xref="S7.SS1.p3.10.m10.1.1.1"><times id="S7.SS1.p3.10.m10.1.1.1.2.cmml" xref="S7.SS1.p3.10.m10.1.1.1.2"></times><ci id="S7.SS1.p3.10.m10.1.1.1.1.cmml" xref="S7.SS1.p3.10.m10.1.1.1.1">SN</ci><ci id="S7.SS1.p3.10.m10.1.1.1.4.cmml" xref="S7.SS1.p3.10.m10.1.1.1.4">IPS</ci></apply></apply><apply id="S7.SS1.p3.10.m10.2.2.1.1.1.cmml" xref="S7.SS1.p3.10.m10.2.2.1.1"><csymbol cd="ambiguous" id="S7.SS1.p3.10.m10.2.2.1.1.1.1.cmml" xref="S7.SS1.p3.10.m10.2.2.1.1">subscript</csymbol><ci id="S7.SS1.p3.10.m10.2.2.1.1.1.2.cmml" xref="S7.SS1.p3.10.m10.2.2.1.1.1.2">𝜋</ci><ci id="S7.SS1.p3.10.m10.2.2.1.1.1.3.cmml" xref="S7.SS1.p3.10.m10.2.2.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p3.10.m10.2c">\widehat{V}_{\rm(SN)IPS}(\pi_{t})</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p3.10.m10.2d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT ( roman_SN ) roman_IPS end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>.
We repeat this process <math alttext="2\,000" class="ltx_Math" display="inline" id="S7.SS1.p3.11.m11.1"><semantics id="S7.SS1.p3.11.m11.1a"><mn id="S7.SS1.p3.11.m11.1.1" xref="S7.SS1.p3.11.m11.1.1.cmml">2 000</mn><annotation-xml encoding="MathML-Content" id="S7.SS1.p3.11.m11.1b"><cn id="S7.SS1.p3.11.m11.1.1.cmml" type="integer" xref="S7.SS1.p3.11.m11.1.1">2000</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p3.11.m11.1c">2\,000</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p3.11.m11.1d">2 000</annotation></semantics></math> times to smooth out the effects of stochasticity.</p>
</div>
<div class="ltx_para" id="S7.SS1.p4">
<p class="ltx_p" id="S7.SS1.p4.5">Confidence Intervals (C.I.s) for <math alttext="\widehat{V}_{\rm(SN)IPS}(\pi_{t})" class="ltx_Math" display="inline" id="S7.SS1.p4.1.m1.2"><semantics id="S7.SS1.p4.1.m1.2a"><mrow id="S7.SS1.p4.1.m1.2.2" xref="S7.SS1.p4.1.m1.2.2.cmml"><msub id="S7.SS1.p4.1.m1.2.2.3" xref="S7.SS1.p4.1.m1.2.2.3.cmml"><mover accent="true" id="S7.SS1.p4.1.m1.2.2.3.2" xref="S7.SS1.p4.1.m1.2.2.3.2.cmml"><mi id="S7.SS1.p4.1.m1.2.2.3.2.2" xref="S7.SS1.p4.1.m1.2.2.3.2.2.cmml">V</mi><mo id="S7.SS1.p4.1.m1.2.2.3.2.1" xref="S7.SS1.p4.1.m1.2.2.3.2.1.cmml">^</mo></mover><mrow id="S7.SS1.p4.1.m1.1.1.1" xref="S7.SS1.p4.1.m1.1.1.1.cmml"><mrow id="S7.SS1.p4.1.m1.1.1.1.3.2" xref="S7.SS1.p4.1.m1.1.1.1.cmml"><mo id="S7.SS1.p4.1.m1.1.1.1.3.2.1" stretchy="false" xref="S7.SS1.p4.1.m1.1.1.1.cmml">(</mo><mi id="S7.SS1.p4.1.m1.1.1.1.1" xref="S7.SS1.p4.1.m1.1.1.1.1.cmml">SN</mi><mo id="S7.SS1.p4.1.m1.1.1.1.3.2.2" stretchy="false" xref="S7.SS1.p4.1.m1.1.1.1.cmml">)</mo></mrow><mo id="S7.SS1.p4.1.m1.1.1.1.2" xref="S7.SS1.p4.1.m1.1.1.1.2.cmml">⁢</mo><mi id="S7.SS1.p4.1.m1.1.1.1.4" xref="S7.SS1.p4.1.m1.1.1.1.4.cmml">IPS</mi></mrow></msub><mo id="S7.SS1.p4.1.m1.2.2.2" xref="S7.SS1.p4.1.m1.2.2.2.cmml">⁢</mo><mrow id="S7.SS1.p4.1.m1.2.2.1.1" xref="S7.SS1.p4.1.m1.2.2.1.1.1.cmml"><mo id="S7.SS1.p4.1.m1.2.2.1.1.2" stretchy="false" xref="S7.SS1.p4.1.m1.2.2.1.1.1.cmml">(</mo><msub id="S7.SS1.p4.1.m1.2.2.1.1.1" xref="S7.SS1.p4.1.m1.2.2.1.1.1.cmml"><mi id="S7.SS1.p4.1.m1.2.2.1.1.1.2" xref="S7.SS1.p4.1.m1.2.2.1.1.1.2.cmml">π</mi><mi id="S7.SS1.p4.1.m1.2.2.1.1.1.3" xref="S7.SS1.p4.1.m1.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S7.SS1.p4.1.m1.2.2.1.1.3" stretchy="false" xref="S7.SS1.p4.1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p4.1.m1.2b"><apply id="S7.SS1.p4.1.m1.2.2.cmml" xref="S7.SS1.p4.1.m1.2.2"><times id="S7.SS1.p4.1.m1.2.2.2.cmml" xref="S7.SS1.p4.1.m1.2.2.2"></times><apply id="S7.SS1.p4.1.m1.2.2.3.cmml" xref="S7.SS1.p4.1.m1.2.2.3"><csymbol cd="ambiguous" id="S7.SS1.p4.1.m1.2.2.3.1.cmml" xref="S7.SS1.p4.1.m1.2.2.3">subscript</csymbol><apply id="S7.SS1.p4.1.m1.2.2.3.2.cmml" xref="S7.SS1.p4.1.m1.2.2.3.2"><ci id="S7.SS1.p4.1.m1.2.2.3.2.1.cmml" xref="S7.SS1.p4.1.m1.2.2.3.2.1">^</ci><ci id="S7.SS1.p4.1.m1.2.2.3.2.2.cmml" xref="S7.SS1.p4.1.m1.2.2.3.2.2">𝑉</ci></apply><apply id="S7.SS1.p4.1.m1.1.1.1.cmml" xref="S7.SS1.p4.1.m1.1.1.1"><times id="S7.SS1.p4.1.m1.1.1.1.2.cmml" xref="S7.SS1.p4.1.m1.1.1.1.2"></times><ci id="S7.SS1.p4.1.m1.1.1.1.1.cmml" xref="S7.SS1.p4.1.m1.1.1.1.1">SN</ci><ci id="S7.SS1.p4.1.m1.1.1.1.4.cmml" xref="S7.SS1.p4.1.m1.1.1.1.4">IPS</ci></apply></apply><apply id="S7.SS1.p4.1.m1.2.2.1.1.1.cmml" xref="S7.SS1.p4.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S7.SS1.p4.1.m1.2.2.1.1.1.1.cmml" xref="S7.SS1.p4.1.m1.2.2.1.1">subscript</csymbol><ci id="S7.SS1.p4.1.m1.2.2.1.1.1.2.cmml" xref="S7.SS1.p4.1.m1.2.2.1.1.1.2">𝜋</ci><ci id="S7.SS1.p4.1.m1.2.2.1.1.1.3.cmml" xref="S7.SS1.p4.1.m1.2.2.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p4.1.m1.2c">\widehat{V}_{\rm(SN)IPS}(\pi_{t})</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p4.1.m1.2d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT ( roman_SN ) roman_IPS end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> are obtained via Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S4.E12" title="In 4.1. Effective Sample Size Corrections ‣ 4. Improving the CRM Lower Bound ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">12</span></a>, with varying estimators for <math alttext="\widehat{{\rm ESS}}" class="ltx_Math" display="inline" id="S7.SS1.p4.2.m2.1"><semantics id="S7.SS1.p4.2.m2.1a"><mover accent="true" id="S7.SS1.p4.2.m2.1.1" xref="S7.SS1.p4.2.m2.1.1.cmml"><mi id="S7.SS1.p4.2.m2.1.1.2" xref="S7.SS1.p4.2.m2.1.1.2.cmml">ESS</mi><mo id="S7.SS1.p4.2.m2.1.1.1" xref="S7.SS1.p4.2.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S7.SS1.p4.2.m2.1b"><apply id="S7.SS1.p4.2.m2.1.1.cmml" xref="S7.SS1.p4.2.m2.1.1"><ci id="S7.SS1.p4.2.m2.1.1.1.cmml" xref="S7.SS1.p4.2.m2.1.1.1">^</ci><ci id="S7.SS1.p4.2.m2.1.1.2.cmml" xref="S7.SS1.p4.2.m2.1.1.2">ESS</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p4.2.m2.1c">\widehat{{\rm ESS}}</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p4.2.m2.1d">over^ start_ARG roman_ESS end_ARG</annotation></semantics></math> and thus <math alttext="\widetilde{N}" class="ltx_Math" display="inline" id="S7.SS1.p4.3.m3.1"><semantics id="S7.SS1.p4.3.m3.1a"><mover accent="true" id="S7.SS1.p4.3.m3.1.1" xref="S7.SS1.p4.3.m3.1.1.cmml"><mi id="S7.SS1.p4.3.m3.1.1.2" xref="S7.SS1.p4.3.m3.1.1.2.cmml">N</mi><mo id="S7.SS1.p4.3.m3.1.1.1" xref="S7.SS1.p4.3.m3.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S7.SS1.p4.3.m3.1b"><apply id="S7.SS1.p4.3.m3.1.1.cmml" xref="S7.SS1.p4.3.m3.1.1"><ci id="S7.SS1.p4.3.m3.1.1.1.cmml" xref="S7.SS1.p4.3.m3.1.1.1">~</ci><ci id="S7.SS1.p4.3.m3.1.1.2.cmml" xref="S7.SS1.p4.3.m3.1.1.2">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p4.3.m3.1c">\widetilde{N}</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p4.3.m3.1d">over~ start_ARG italic_N end_ARG</annotation></semantics></math>.
We report three key metrics:

<span class="ltx_inline-enumerate" id="S7.I2">
<span class="ltx_inline-item" id="S7.I2.i1"><span class="ltx_tag ltx_tag_inline-item">(1)</span> <span class="ltx_text" id="S7.I2.i1.2">the estimated ESS (directly proportional to the discrepancy between <math alttext="\pi_{0}" class="ltx_Math" display="inline" id="S7.I2.i1.1.m1.1"><semantics id="S7.I2.i1.1.m1.1a"><msub id="S7.I2.i1.1.m1.1.1" xref="S7.I2.i1.1.m1.1.1.cmml"><mi id="S7.I2.i1.1.m1.1.1.2" xref="S7.I2.i1.1.m1.1.1.2.cmml">π</mi><mn id="S7.I2.i1.1.m1.1.1.3" xref="S7.I2.i1.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S7.I2.i1.1.m1.1b"><apply id="S7.I2.i1.1.m1.1.1.cmml" xref="S7.I2.i1.1.m1.1.1"><csymbol cd="ambiguous" id="S7.I2.i1.1.m1.1.1.1.cmml" xref="S7.I2.i1.1.m1.1.1">subscript</csymbol><ci id="S7.I2.i1.1.m1.1.1.2.cmml" xref="S7.I2.i1.1.m1.1.1.2">𝜋</ci><cn id="S7.I2.i1.1.m1.1.1.3.cmml" type="integer" xref="S7.I2.i1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I2.i1.1.m1.1c">\pi_{0}</annotation><annotation encoding="application/x-llamapun" id="S7.I2.i1.1.m1.1d">italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\pi_{t}" class="ltx_Math" display="inline" id="S7.I2.i1.2.m2.1"><semantics id="S7.I2.i1.2.m2.1a"><msub id="S7.I2.i1.2.m2.1.1" xref="S7.I2.i1.2.m2.1.1.cmml"><mi id="S7.I2.i1.2.m2.1.1.2" xref="S7.I2.i1.2.m2.1.1.2.cmml">π</mi><mi id="S7.I2.i1.2.m2.1.1.3" xref="S7.I2.i1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S7.I2.i1.2.m2.1b"><apply id="S7.I2.i1.2.m2.1.1.cmml" xref="S7.I2.i1.2.m2.1.1"><csymbol cd="ambiguous" id="S7.I2.i1.2.m2.1.1.1.cmml" xref="S7.I2.i1.2.m2.1.1">subscript</csymbol><ci id="S7.I2.i1.2.m2.1.1.2.cmml" xref="S7.I2.i1.2.m2.1.1.2">𝜋</ci><ci id="S7.I2.i1.2.m2.1.1.3.cmml" xref="S7.I2.i1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.I2.i1.2.m2.1c">\pi_{t}</annotation><annotation encoding="application/x-llamapun" id="S7.I2.i1.2.m2.1d">italic_π start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>,
</span></span>
<span class="ltx_inline-item" id="S7.I2.i2"><span class="ltx_tag ltx_tag_inline-item">(2)</span> <span class="ltx_text" id="S7.I2.i2.1">the width of the C.I. (directly proportional to the estimated variance of the mean), and
</span></span>
<span class="ltx_inline-item" id="S7.I2.i3"><span class="ltx_tag ltx_tag_inline-item">(3)</span> <span class="ltx_text" id="S7.I2.i3.1">the coverage of the 95% C.I. (which should converge to 95%).
</span></span>
</span>
We increase the sample size over the <math alttext="x" class="ltx_Math" display="inline" id="S7.SS1.p4.4.m4.1"><semantics id="S7.SS1.p4.4.m4.1a"><mi id="S7.SS1.p4.4.m4.1.1" xref="S7.SS1.p4.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S7.SS1.p4.4.m4.1b"><ci id="S7.SS1.p4.4.m4.1.1.cmml" xref="S7.SS1.p4.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p4.4.m4.1c">x</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p4.4.m4.1d">italic_x</annotation></semantics></math>-axis, and show results for varying target policy standard deviations in different columns.
Results for <math alttext="\widehat{V}_{\rm SNIPS}" class="ltx_Math" display="inline" id="S7.SS1.p4.5.m5.1"><semantics id="S7.SS1.p4.5.m5.1a"><msub id="S7.SS1.p4.5.m5.1.1" xref="S7.SS1.p4.5.m5.1.1.cmml"><mover accent="true" id="S7.SS1.p4.5.m5.1.1.2" xref="S7.SS1.p4.5.m5.1.1.2.cmml"><mi id="S7.SS1.p4.5.m5.1.1.2.2" xref="S7.SS1.p4.5.m5.1.1.2.2.cmml">V</mi><mo id="S7.SS1.p4.5.m5.1.1.2.1" xref="S7.SS1.p4.5.m5.1.1.2.1.cmml">^</mo></mover><mi id="S7.SS1.p4.5.m5.1.1.3" xref="S7.SS1.p4.5.m5.1.1.3.cmml">SNIPS</mi></msub><annotation-xml encoding="MathML-Content" id="S7.SS1.p4.5.m5.1b"><apply id="S7.SS1.p4.5.m5.1.1.cmml" xref="S7.SS1.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S7.SS1.p4.5.m5.1.1.1.cmml" xref="S7.SS1.p4.5.m5.1.1">subscript</csymbol><apply id="S7.SS1.p4.5.m5.1.1.2.cmml" xref="S7.SS1.p4.5.m5.1.1.2"><ci id="S7.SS1.p4.5.m5.1.1.2.1.cmml" xref="S7.SS1.p4.5.m5.1.1.2.1">^</ci><ci id="S7.SS1.p4.5.m5.1.1.2.2.cmml" xref="S7.SS1.p4.5.m5.1.1.2.2">𝑉</ci></apply><ci id="S7.SS1.p4.5.m5.1.1.3.cmml" xref="S7.SS1.p4.5.m5.1.1.3">SNIPS</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p4.5.m5.1c">\widehat{V}_{\rm SNIPS}</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p4.5.m5.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_SNIPS end_POSTSUBSCRIPT</annotation></semantics></math> are visualised in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S7.F2" title="Figure 2 ‣ 7. Experiments &amp; Discussion ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div class="ltx_para" id="S7.SS1.p5">
<p class="ltx_p" id="S7.SS1.p5.4">Key observations from this plot include that the traditional sample variance C.I. has poor coverage in realistic scenarios, when sample sizes are relatively low (up to 10k in this simple non-contextual setting).
Convergence does indeed occur, as guaranteed by the CLT, but slowly. Furthermore, it is unclear <em class="ltx_emph ltx_font_italic" id="S7.SS1.p5.4.1">when</em> we can expect the CLT to hold.
In constrast, all the proposed ESS estimators combined with our sample size correction improve coverage at smaller sample sizes, whilst still converging to the advertised coverage level as the sample size grows.
These empirical findings corroborate our theoretical expectations.
Pessimistic ESS estimates, i.e. those leveraging the <math alttext="\ell_{\infty}" class="ltx_Math" display="inline" id="S7.SS1.p5.1.m1.1"><semantics id="S7.SS1.p5.1.m1.1a"><msub id="S7.SS1.p5.1.m1.1.1" xref="S7.SS1.p5.1.m1.1.1.cmml"><mi id="S7.SS1.p5.1.m1.1.1.2" mathvariant="normal" xref="S7.SS1.p5.1.m1.1.1.2.cmml">ℓ</mi><mi id="S7.SS1.p5.1.m1.1.1.3" mathvariant="normal" xref="S7.SS1.p5.1.m1.1.1.3.cmml">∞</mi></msub><annotation-xml encoding="MathML-Content" id="S7.SS1.p5.1.m1.1b"><apply id="S7.SS1.p5.1.m1.1.1.cmml" xref="S7.SS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S7.SS1.p5.1.m1.1.1.1.cmml" xref="S7.SS1.p5.1.m1.1.1">subscript</csymbol><ci id="S7.SS1.p5.1.m1.1.1.2.cmml" xref="S7.SS1.p5.1.m1.1.1.2">ℓ</ci><infinity id="S7.SS1.p5.1.m1.1.1.3.cmml" xref="S7.SS1.p5.1.m1.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p5.1.m1.1c">\ell_{\infty}</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p5.1.m1.1d">roman_ℓ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT</annotation></semantics></math>-norm proposed by <cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib45" title="">Martino et al<span class="ltx_text">.</span></a></cite> <cite class="ltx_cite ltx_citemacro_citep">(Martino et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib45" title="">2017</a>)</cite>, outperform the conventional estimates that rely on <math alttext="\ell_{2}" class="ltx_Math" display="inline" id="S7.SS1.p5.2.m2.1"><semantics id="S7.SS1.p5.2.m2.1a"><msub id="S7.SS1.p5.2.m2.1.1" xref="S7.SS1.p5.2.m2.1.1.cmml"><mi id="S7.SS1.p5.2.m2.1.1.2" mathvariant="normal" xref="S7.SS1.p5.2.m2.1.1.2.cmml">ℓ</mi><mn id="S7.SS1.p5.2.m2.1.1.3" xref="S7.SS1.p5.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S7.SS1.p5.2.m2.1b"><apply id="S7.SS1.p5.2.m2.1.1.cmml" xref="S7.SS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S7.SS1.p5.2.m2.1.1.1.cmml" xref="S7.SS1.p5.2.m2.1.1">subscript</csymbol><ci id="S7.SS1.p5.2.m2.1.1.2.cmml" xref="S7.SS1.p5.2.m2.1.1.2">ℓ</ci><cn id="S7.SS1.p5.2.m2.1.1.3.cmml" type="integer" xref="S7.SS1.p5.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p5.2.m2.1c">\ell_{2}</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p5.2.m2.1d">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>-norms.
Reward-dependent ESS estimates, as discussed by <cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib52" title="">Owen</a></cite> <cite class="ltx_cite ltx_citemacro_citep">(Owen, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib52" title="">2013</a>)</cite>, outperform their reward-independent counterparts.
The most promising variant is <math alttext="D_{N}^{R-\infty}" class="ltx_Math" display="inline" id="S7.SS1.p5.3.m3.1"><semantics id="S7.SS1.p5.3.m3.1a"><msubsup id="S7.SS1.p5.3.m3.1.1" xref="S7.SS1.p5.3.m3.1.1.cmml"><mi id="S7.SS1.p5.3.m3.1.1.2.2" xref="S7.SS1.p5.3.m3.1.1.2.2.cmml">D</mi><mi id="S7.SS1.p5.3.m3.1.1.2.3" xref="S7.SS1.p5.3.m3.1.1.2.3.cmml">N</mi><mrow id="S7.SS1.p5.3.m3.1.1.3" xref="S7.SS1.p5.3.m3.1.1.3.cmml"><mi id="S7.SS1.p5.3.m3.1.1.3.2" xref="S7.SS1.p5.3.m3.1.1.3.2.cmml">R</mi><mo id="S7.SS1.p5.3.m3.1.1.3.1" xref="S7.SS1.p5.3.m3.1.1.3.1.cmml">−</mo><mi id="S7.SS1.p5.3.m3.1.1.3.3" mathvariant="normal" xref="S7.SS1.p5.3.m3.1.1.3.3.cmml">∞</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S7.SS1.p5.3.m3.1b"><apply id="S7.SS1.p5.3.m3.1.1.cmml" xref="S7.SS1.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S7.SS1.p5.3.m3.1.1.1.cmml" xref="S7.SS1.p5.3.m3.1.1">superscript</csymbol><apply id="S7.SS1.p5.3.m3.1.1.2.cmml" xref="S7.SS1.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S7.SS1.p5.3.m3.1.1.2.1.cmml" xref="S7.SS1.p5.3.m3.1.1">subscript</csymbol><ci id="S7.SS1.p5.3.m3.1.1.2.2.cmml" xref="S7.SS1.p5.3.m3.1.1.2.2">𝐷</ci><ci id="S7.SS1.p5.3.m3.1.1.2.3.cmml" xref="S7.SS1.p5.3.m3.1.1.2.3">𝑁</ci></apply><apply id="S7.SS1.p5.3.m3.1.1.3.cmml" xref="S7.SS1.p5.3.m3.1.1.3"><minus id="S7.SS1.p5.3.m3.1.1.3.1.cmml" xref="S7.SS1.p5.3.m3.1.1.3.1"></minus><ci id="S7.SS1.p5.3.m3.1.1.3.2.cmml" xref="S7.SS1.p5.3.m3.1.1.3.2">𝑅</ci><infinity id="S7.SS1.p5.3.m3.1.1.3.3.cmml" xref="S7.SS1.p5.3.m3.1.1.3.3"></infinity></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p5.3.m3.1c">D_{N}^{R-\infty}</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p5.3.m3.1d">italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_R - ∞ end_POSTSUPERSCRIPT</annotation></semantics></math>, the estimator that combines both pre-existing elements in the literature into a novel estimator for the ESS.
Importantly, we note that the corrections do not significantly overshoot the required coverage level, and converge to the CLT C.I.s as <math alttext="N" class="ltx_Math" display="inline" id="S7.SS1.p5.4.m4.1"><semantics id="S7.SS1.p5.4.m4.1a"><mi id="S7.SS1.p5.4.m4.1.1" xref="S7.SS1.p5.4.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S7.SS1.p5.4.m4.1b"><ci id="S7.SS1.p5.4.m4.1.1.cmml" xref="S7.SS1.p5.4.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p5.4.m4.1c">N</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p5.4.m4.1d">italic_N</annotation></semantics></math> grows.</p>
</div>
<div class="ltx_para" id="S7.SS1.p6">
<p class="ltx_p" id="S7.SS1.p6.3">Aggregating for all considered target policies the ratio of the minimum sample size required to achieve the advertised coverage level using <math alttext="N" class="ltx_Math" display="inline" id="S7.SS1.p6.1.m1.1"><semantics id="S7.SS1.p6.1.m1.1a"><mi id="S7.SS1.p6.1.m1.1.1" xref="S7.SS1.p6.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S7.SS1.p6.1.m1.1b"><ci id="S7.SS1.p6.1.m1.1.1.cmml" xref="S7.SS1.p6.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p6.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p6.1.m1.1d">italic_N</annotation></semantics></math> and using <math alttext="\widetilde{N}" class="ltx_Math" display="inline" id="S7.SS1.p6.2.m2.1"><semantics id="S7.SS1.p6.2.m2.1a"><mover accent="true" id="S7.SS1.p6.2.m2.1.1" xref="S7.SS1.p6.2.m2.1.1.cmml"><mi id="S7.SS1.p6.2.m2.1.1.2" xref="S7.SS1.p6.2.m2.1.1.2.cmml">N</mi><mo id="S7.SS1.p6.2.m2.1.1.1" xref="S7.SS1.p6.2.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S7.SS1.p6.2.m2.1b"><apply id="S7.SS1.p6.2.m2.1.1.cmml" xref="S7.SS1.p6.2.m2.1.1"><ci id="S7.SS1.p6.2.m2.1.1.1.cmml" xref="S7.SS1.p6.2.m2.1.1.1">~</ci><ci id="S7.SS1.p6.2.m2.1.1.2.cmml" xref="S7.SS1.p6.2.m2.1.1.2">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p6.2.m2.1c">\widetilde{N}</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p6.2.m2.1d">over~ start_ARG italic_N end_ARG</annotation></semantics></math>, we observe average sample size reductions of up to 60 times (i.e. down to 1.7% of the traditional C.I.).
These results are visualised in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S7.F3" title="Figure 3 ‣ 7. Experiments &amp; Discussion ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">3</span></a>.
This represents a significant shift that improves the robustness of offline evaluation and learning capabilities for multivariate policy learning models in production.
Results for <math alttext="\widehat{V}_{\rm IPS}" class="ltx_Math" display="inline" id="S7.SS1.p6.3.m3.1"><semantics id="S7.SS1.p6.3.m3.1a"><msub id="S7.SS1.p6.3.m3.1.1" xref="S7.SS1.p6.3.m3.1.1.cmml"><mover accent="true" id="S7.SS1.p6.3.m3.1.1.2" xref="S7.SS1.p6.3.m3.1.1.2.cmml"><mi id="S7.SS1.p6.3.m3.1.1.2.2" xref="S7.SS1.p6.3.m3.1.1.2.2.cmml">V</mi><mo id="S7.SS1.p6.3.m3.1.1.2.1" xref="S7.SS1.p6.3.m3.1.1.2.1.cmml">^</mo></mover><mi id="S7.SS1.p6.3.m3.1.1.3" xref="S7.SS1.p6.3.m3.1.1.3.cmml">IPS</mi></msub><annotation-xml encoding="MathML-Content" id="S7.SS1.p6.3.m3.1b"><apply id="S7.SS1.p6.3.m3.1.1.cmml" xref="S7.SS1.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S7.SS1.p6.3.m3.1.1.1.cmml" xref="S7.SS1.p6.3.m3.1.1">subscript</csymbol><apply id="S7.SS1.p6.3.m3.1.1.2.cmml" xref="S7.SS1.p6.3.m3.1.1.2"><ci id="S7.SS1.p6.3.m3.1.1.2.1.cmml" xref="S7.SS1.p6.3.m3.1.1.2.1">^</ci><ci id="S7.SS1.p6.3.m3.1.1.2.2.cmml" xref="S7.SS1.p6.3.m3.1.1.2.2">𝑉</ci></apply><ci id="S7.SS1.p6.3.m3.1.1.3.cmml" xref="S7.SS1.p6.3.m3.1.1.3">IPS</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p6.3.m3.1c">\widehat{V}_{\rm IPS}</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p6.3.m3.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_IPS end_POSTSUBSCRIPT</annotation></semantics></math> are qualitatively similar but omitted for brevity.</p>
</div>
<figure class="ltx_figure" id="S7.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S7.F4.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="436" id="S7.F4.sf1.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S7.F4.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S7.F4.sf1.3.2" style="font-size:90%;">Off-policy evaluation results for the “retained users” label. High variance leads to inconclusive results and extremely wide C.I.s.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S7.F4.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="429" id="S7.F4.sf2.g1" src="x5.png" width="829"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S7.F4.sf2.6.3.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S7.F4.sf2.4.2" style="font-size:90%;">Off-policy evaluation results for the “learnt reward” label. Around <math alttext="\sigma\approx 0.1" class="ltx_Math" display="inline" id="S7.F4.sf2.3.1.m1.1"><semantics id="S7.F4.sf2.3.1.m1.1b"><mrow id="S7.F4.sf2.3.1.m1.1.1" xref="S7.F4.sf2.3.1.m1.1.1.cmml"><mi id="S7.F4.sf2.3.1.m1.1.1.2" xref="S7.F4.sf2.3.1.m1.1.1.2.cmml">σ</mi><mo id="S7.F4.sf2.3.1.m1.1.1.1" xref="S7.F4.sf2.3.1.m1.1.1.1.cmml">≈</mo><mn id="S7.F4.sf2.3.1.m1.1.1.3" xref="S7.F4.sf2.3.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.F4.sf2.3.1.m1.1c"><apply id="S7.F4.sf2.3.1.m1.1.1.cmml" xref="S7.F4.sf2.3.1.m1.1.1"><approx id="S7.F4.sf2.3.1.m1.1.1.1.cmml" xref="S7.F4.sf2.3.1.m1.1.1.1"></approx><ci id="S7.F4.sf2.3.1.m1.1.1.2.cmml" xref="S7.F4.sf2.3.1.m1.1.1.2">𝜎</ci><cn id="S7.F4.sf2.3.1.m1.1.1.3.cmml" type="float" xref="S7.F4.sf2.3.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.F4.sf2.3.1.m1.1d">\sigma\approx 0.1</annotation><annotation encoding="application/x-llamapun" id="S7.F4.sf2.3.1.m1.1e">italic_σ ≈ 0.1</annotation></semantics></math>, improvements are statistically significant with <math alttext="p&lt;0.05" class="ltx_Math" display="inline" id="S7.F4.sf2.4.2.m2.1"><semantics id="S7.F4.sf2.4.2.m2.1b"><mrow id="S7.F4.sf2.4.2.m2.1.1" xref="S7.F4.sf2.4.2.m2.1.1.cmml"><mi id="S7.F4.sf2.4.2.m2.1.1.2" xref="S7.F4.sf2.4.2.m2.1.1.2.cmml">p</mi><mo id="S7.F4.sf2.4.2.m2.1.1.1" xref="S7.F4.sf2.4.2.m2.1.1.1.cmml">&lt;</mo><mn id="S7.F4.sf2.4.2.m2.1.1.3" xref="S7.F4.sf2.4.2.m2.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.F4.sf2.4.2.m2.1c"><apply id="S7.F4.sf2.4.2.m2.1.1.cmml" xref="S7.F4.sf2.4.2.m2.1.1"><lt id="S7.F4.sf2.4.2.m2.1.1.1.cmml" xref="S7.F4.sf2.4.2.m2.1.1.1"></lt><ci id="S7.F4.sf2.4.2.m2.1.1.2.cmml" xref="S7.F4.sf2.4.2.m2.1.1.2">𝑝</ci><cn id="S7.F4.sf2.4.2.m2.1.1.3.cmml" type="float" xref="S7.F4.sf2.4.2.m2.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.F4.sf2.4.2.m2.1d">p&lt;0.05</annotation><annotation encoding="application/x-llamapun" id="S7.F4.sf2.4.2.m2.1e">italic_p &lt; 0.05</annotation></semantics></math>.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S7.F4.4.2.1" style="font-size:90%;">Figure 4</span>. </span><span class="ltx_text" id="S7.F4.2.1" style="font-size:90%;">Off-policy evaluation results for varying <math alttext="\sigma" class="ltx_Math" display="inline" id="S7.F4.2.1.m1.1"><semantics id="S7.F4.2.1.m1.1b"><mi id="S7.F4.2.1.m1.1.1" xref="S7.F4.2.1.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S7.F4.2.1.m1.1c"><ci id="S7.F4.2.1.m1.1.1.cmml" xref="S7.F4.2.1.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.F4.2.1.m1.1d">\sigma</annotation><annotation encoding="application/x-llamapun" id="S7.F4.2.1.m1.1e">italic_σ</annotation></semantics></math>, visualising the bias-variance trade-off that comes with the kernel smoothing technique. We provide results for an insensitive North Star (a), and a learnt reward signal that maximises statistical power (b).</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S7.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.2. </span>Improved Recommendations (RQ2–4)</h3>
<div class="ltx_para" id="S7.SS2.p1">
<p class="ltx_p" id="S7.SS2.p1.1">To empirically validate that we can leverage the multivariate policy learning approach to learn improved policies and ultimately improve the recommendations that are being shown to end-users, we require either access to

<span class="ltx_inline-enumerate" id="S7.I3">
<span class="ltx_inline-item" id="S7.I3.i1"><span class="ltx_tag ltx_tag_inline-item">(1)</span> <span class="ltx_text" id="S7.I3.i1.1">a dataset where weights were actively randomised and logged along with the appropriate reward signals, or
</span></span>
<span class="ltx_inline-item" id="S7.I3.i2"><span class="ltx_tag ltx_tag_inline-item">(2)</span> <span class="ltx_text" id="S7.I3.i2.1">a simulation environment that accurately mimics real user behaviour in response to recommendations, over multiple signals and objectives (e.g. engagements, time spent, retention).
</span></span>
</span>
Whilst the latter has been popular to validate general off-policy learning approaches to recommendation <cite class="ltx_cite ltx_citemacro_citep">(Sakhi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib57" title="">2020</a>; Jeunen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib34" title="">2020</a>; Jeunen and Goethals, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib29" title="">2021a</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib31" title="">2023</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib41" title="">2022</a>)</cite>, existing simulators only consider single objectives (e.g. clicks) and it is unclear how these results translate to experiments with real end-users.
Because no appropriate datasets are publicly available, we resort to proprietary datasets obtained from large-scale short-video platforms.
We report both offline evaluation results and results from online experiments in the following subsections.</p>
</div>
<div class="ltx_para" id="S7.SS2.p2">
<p class="ltx_p" id="S7.SS2.p2.1">The base recommendation model on the platforms is a Multi-gate Mixture of Experts (MMOE) multi-task learning model <cite class="ltx_cite ltx_citemacro_citep">(Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib43" title="">2018</a>)</cite>, used to generate predictions for 9 different behaviour signals (i.e. like, share, favourite, end session and view, among others).
These are then combined following Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S2.E1" title="In 2. Multi-Objective Recommendation ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<section class="ltx_subsubsection" id="S7.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.2.1. </span>Production Baseline (Control)</h4>
<div class="ltx_para" id="S7.SS2.SSS1.p1">
<p class="ltx_p" id="S7.SS2.SSS1.p1.1">The production baseline can be seen as an instantiation of the Direct Method <cite class="ltx_cite ltx_citemacro_citep">(Dudík et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib16" title="">2014</a>)</cite>, where a direct search is performed to find the scalarisation weights that maximise the correlation with retention, typically seen as a strong indicator of user satisfaction and long-term growth for the platform.
These deterministic production weights are then treated as hyper-parameters of the overall system, and have undergone multiple manual tuning rounds where the outcomes of online experiments decide which weights will be used going forward.
Because online performance is measured directly, this approach is effective.
Nevertheless, because the search space of possible weights is vast, the approach is inefficient and costly.
Automated policy learning methods that can improve over the production weights are therefore of significant importance to the platform.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S7.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.2.2. </span>Offline Results (RQ2–3)</h4>
<div class="ltx_para" id="S7.SS2.SSS2.p1">
<p class="ltx_p" id="S7.SS2.SSS2.p1.1">To obtain an offline dataset to learn from, we randomise weights for 4.5 million users and log their behaviour on the platform over a period of three weeks.
The randomised weights correspond to the <em class="ltx_emph ltx_font_italic" id="S7.SS2.SSS2.p1.1.1">actions</em>, and the behaviours inform the <em class="ltx_emph ltx_font_italic" id="S7.SS2.SSS2.p1.1.2">rewards</em> we wish to optimise using our proposed multivariate off-policy learning approach.</p>
</div>
<div class="ltx_para" id="S7.SS2.SSS2.p2">
<p class="ltx_p" id="S7.SS2.SSS2.p2.5">We optimise a deterministic policy to maximise a lower bound on the <math alttext="\widehat{V}_{\rm SNIPS}" class="ltx_Math" display="inline" id="S7.SS2.SSS2.p2.1.m1.1"><semantics id="S7.SS2.SSS2.p2.1.m1.1a"><msub id="S7.SS2.SSS2.p2.1.m1.1.1" xref="S7.SS2.SSS2.p2.1.m1.1.1.cmml"><mover accent="true" id="S7.SS2.SSS2.p2.1.m1.1.1.2" xref="S7.SS2.SSS2.p2.1.m1.1.1.2.cmml"><mi id="S7.SS2.SSS2.p2.1.m1.1.1.2.2" xref="S7.SS2.SSS2.p2.1.m1.1.1.2.2.cmml">V</mi><mo id="S7.SS2.SSS2.p2.1.m1.1.1.2.1" xref="S7.SS2.SSS2.p2.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S7.SS2.SSS2.p2.1.m1.1.1.3" xref="S7.SS2.SSS2.p2.1.m1.1.1.3.cmml">SNIPS</mi></msub><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS2.p2.1.m1.1b"><apply id="S7.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S7.SS2.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S7.SS2.SSS2.p2.1.m1.1.1.1.cmml" xref="S7.SS2.SSS2.p2.1.m1.1.1">subscript</csymbol><apply id="S7.SS2.SSS2.p2.1.m1.1.1.2.cmml" xref="S7.SS2.SSS2.p2.1.m1.1.1.2"><ci id="S7.SS2.SSS2.p2.1.m1.1.1.2.1.cmml" xref="S7.SS2.SSS2.p2.1.m1.1.1.2.1">^</ci><ci id="S7.SS2.SSS2.p2.1.m1.1.1.2.2.cmml" xref="S7.SS2.SSS2.p2.1.m1.1.1.2.2">𝑉</ci></apply><ci id="S7.SS2.SSS2.p2.1.m1.1.1.3.cmml" xref="S7.SS2.SSS2.p2.1.m1.1.1.3">SNIPS</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS2.p2.1.m1.1c">\widehat{V}_{\rm SNIPS}</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS2.p2.1.m1.1d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT roman_SNIPS end_POSTSUBSCRIPT</annotation></semantics></math> estimator, given by Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S4.E12" title="In 4.1. Effective Sample Size Corrections ‣ 4. Improving the CRM Lower Bound ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">12</span></a>.
For the learnt policy, we visualise the obtained ESS-corrected confidence interval for the value estimates when we vary the bandwidth of the Gaussian kernel (i.e. the standard deviation <math alttext="\sigma" class="ltx_Math" display="inline" id="S7.SS2.SSS2.p2.2.m2.1"><semantics id="S7.SS2.SSS2.p2.2.m2.1a"><mi id="S7.SS2.SSS2.p2.2.m2.1.1" xref="S7.SS2.SSS2.p2.2.m2.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS2.p2.2.m2.1b"><ci id="S7.SS2.SSS2.p2.2.m2.1.1.cmml" xref="S7.SS2.SSS2.p2.2.m2.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS2.p2.2.m2.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS2.p2.2.m2.1d">italic_σ</annotation></semantics></math>).
These results are visualised in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S7.F4" title="Figure 4 ‣ 7.1. ESS Corrections &amp; Estimator Coverage (RQ1) ‣ 7. Experiments &amp; Discussion ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">4</span></a>.
The policy we wish to deploy is deterministic, i.e. <math alttext="\sigma\equiv 0" class="ltx_Math" display="inline" id="S7.SS2.SSS2.p2.3.m3.1"><semantics id="S7.SS2.SSS2.p2.3.m3.1a"><mrow id="S7.SS2.SSS2.p2.3.m3.1.1" xref="S7.SS2.SSS2.p2.3.m3.1.1.cmml"><mi id="S7.SS2.SSS2.p2.3.m3.1.1.2" xref="S7.SS2.SSS2.p2.3.m3.1.1.2.cmml">σ</mi><mo id="S7.SS2.SSS2.p2.3.m3.1.1.1" xref="S7.SS2.SSS2.p2.3.m3.1.1.1.cmml">≡</mo><mn id="S7.SS2.SSS2.p2.3.m3.1.1.3" xref="S7.SS2.SSS2.p2.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS2.p2.3.m3.1b"><apply id="S7.SS2.SSS2.p2.3.m3.1.1.cmml" xref="S7.SS2.SSS2.p2.3.m3.1.1"><equivalent id="S7.SS2.SSS2.p2.3.m3.1.1.1.cmml" xref="S7.SS2.SSS2.p2.3.m3.1.1.1"></equivalent><ci id="S7.SS2.SSS2.p2.3.m3.1.1.2.cmml" xref="S7.SS2.SSS2.p2.3.m3.1.1.2">𝜎</ci><cn id="S7.SS2.SSS2.p2.3.m3.1.1.3.cmml" type="integer" xref="S7.SS2.SSS2.p2.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS2.p2.3.m3.1c">\sigma\equiv 0</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS2.p2.3.m3.1d">italic_σ ≡ 0</annotation></semantics></math>.
Naturally, this would lead to an extremely low ESS, and high variance as a result.
As we increase <math alttext="\sigma" class="ltx_Math" display="inline" id="S7.SS2.SSS2.p2.4.m4.1"><semantics id="S7.SS2.SSS2.p2.4.m4.1a"><mi id="S7.SS2.SSS2.p2.4.m4.1.1" xref="S7.SS2.SSS2.p2.4.m4.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS2.p2.4.m4.1b"><ci id="S7.SS2.SSS2.p2.4.m4.1.1.cmml" xref="S7.SS2.SSS2.p2.4.m4.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS2.p2.4.m4.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS2.p2.4.m4.1d">italic_σ</annotation></semantics></math>, we observe that the variance of the estimator <em class="ltx_emph ltx_font_italic" id="S7.SS2.SSS2.p2.5.1">decreases</em> as its bias <em class="ltx_emph ltx_font_italic" id="S7.SS2.SSS2.p2.5.2">increases</em>.
Indeed, for large values of <math alttext="\sigma" class="ltx_Math" display="inline" id="S7.SS2.SSS2.p2.5.m5.1"><semantics id="S7.SS2.SSS2.p2.5.m5.1a"><mi id="S7.SS2.SSS2.p2.5.m5.1.1" xref="S7.SS2.SSS2.p2.5.m5.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS2.p2.5.m5.1b"><ci id="S7.SS2.SSS2.p2.5.m5.1.1.cmml" xref="S7.SS2.SSS2.p2.5.m5.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS2.p2.5.m5.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS2.p2.5.m5.1d">italic_σ</annotation></semantics></math>, the estimates coincide with the empirical reward obtained by the logging policy, as the widening Gaussian kernel tends to smooth over <em class="ltx_emph ltx_font_italic" id="S7.SS2.SSS2.p2.5.3">all</em> observed samples.
This visualises the bias–variance trade-off that occurs for off-policy evaluation in continuous action domains.</p>
</div>
<div class="ltx_para" id="S7.SS2.SSS2.p3">
<p class="ltx_p" id="S7.SS2.SSS2.p3.1">We plot offline evaluation results for two reward signals: “retained users” as a direct but noisy measurement of platform growth objectives, and our “learnt reward” signal introduced in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S6" title="6. Designing a sensitive reward signal ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">6</span></a>.
First, we observe that offline estimates for the “retained users” reward are directionally positive, but imply such high variance that we cannot make confident statements about the superiority of the learnt policy.
Furthermore, this inhibits any meaningful estimates about the treatment effect of the learnt policy, as the C.I.s indicate an increase of up to 300%, which no recommendation policy change could ever reasonably incur.</p>
</div>
<div class="ltx_para" id="S7.SS2.SSS2.p4">
<p class="ltx_p" id="S7.SS2.SSS2.p4.2">When considering the learnt reward signal instead, we first observe a far more reasonable scale on the y-axis.
Second, we observe that around <math alttext="\sigma\approx 0.1" class="ltx_Math" display="inline" id="S7.SS2.SSS2.p4.1.m1.1"><semantics id="S7.SS2.SSS2.p4.1.m1.1a"><mrow id="S7.SS2.SSS2.p4.1.m1.1.1" xref="S7.SS2.SSS2.p4.1.m1.1.1.cmml"><mi id="S7.SS2.SSS2.p4.1.m1.1.1.2" xref="S7.SS2.SSS2.p4.1.m1.1.1.2.cmml">σ</mi><mo id="S7.SS2.SSS2.p4.1.m1.1.1.1" xref="S7.SS2.SSS2.p4.1.m1.1.1.1.cmml">≈</mo><mn id="S7.SS2.SSS2.p4.1.m1.1.1.3" xref="S7.SS2.SSS2.p4.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS2.p4.1.m1.1b"><apply id="S7.SS2.SSS2.p4.1.m1.1.1.cmml" xref="S7.SS2.SSS2.p4.1.m1.1.1"><approx id="S7.SS2.SSS2.p4.1.m1.1.1.1.cmml" xref="S7.SS2.SSS2.p4.1.m1.1.1.1"></approx><ci id="S7.SS2.SSS2.p4.1.m1.1.1.2.cmml" xref="S7.SS2.SSS2.p4.1.m1.1.1.2">𝜎</ci><cn id="S7.SS2.SSS2.p4.1.m1.1.1.3.cmml" type="float" xref="S7.SS2.SSS2.p4.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS2.p4.1.m1.1c">\sigma\approx 0.1</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS2.p4.1.m1.1d">italic_σ ≈ 0.1</annotation></semantics></math> the 95% confidence intervals denoting relative improvements over the logging policy no longer include 1.
In other words, the improvements are statistically significant with <math alttext="p&lt;0.05" class="ltx_Math" display="inline" id="S7.SS2.SSS2.p4.2.m2.1"><semantics id="S7.SS2.SSS2.p4.2.m2.1a"><mrow id="S7.SS2.SSS2.p4.2.m2.1.1" xref="S7.SS2.SSS2.p4.2.m2.1.1.cmml"><mi id="S7.SS2.SSS2.p4.2.m2.1.1.2" xref="S7.SS2.SSS2.p4.2.m2.1.1.2.cmml">p</mi><mo id="S7.SS2.SSS2.p4.2.m2.1.1.1" xref="S7.SS2.SSS2.p4.2.m2.1.1.1.cmml">&lt;</mo><mn id="S7.SS2.SSS2.p4.2.m2.1.1.3" xref="S7.SS2.SSS2.p4.2.m2.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS2.p4.2.m2.1b"><apply id="S7.SS2.SSS2.p4.2.m2.1.1.cmml" xref="S7.SS2.SSS2.p4.2.m2.1.1"><lt id="S7.SS2.SSS2.p4.2.m2.1.1.1.cmml" xref="S7.SS2.SSS2.p4.2.m2.1.1.1"></lt><ci id="S7.SS2.SSS2.p4.2.m2.1.1.2.cmml" xref="S7.SS2.SSS2.p4.2.m2.1.1.2">𝑝</ci><cn id="S7.SS2.SSS2.p4.2.m2.1.1.3.cmml" type="float" xref="S7.SS2.SSS2.p4.2.m2.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS2.p4.2.m2.1c">p&lt;0.05</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS2.p4.2.m2.1d">italic_p &lt; 0.05</annotation></semantics></math>.
This leads us to consider the learnt policy as a promising candidate for an online experiment.</p>
</div>
<figure class="ltx_table" id="S7.T1">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_table ltx_figure_panel" id="S7.T1.st1">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S7.T1.st1.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S7.T1.st1.2.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S7.T1.st1.2.1.1.1"><span class="ltx_text ltx_font_bold" id="S7.T1.st1.2.1.1.1.1">Metric</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S7.T1.st1.2.1.1.2"><span class="ltx_text ltx_font_bold" id="S7.T1.st1.2.1.1.2.1">Relative Improvement (95% C.I.)</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S7.T1.st1.2.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S7.T1.st1.2.2.1.1">Retention</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T1.st1.2.2.1.2"><span class="ltx_text" id="S7.T1.st1.2.2.1.2.1" style="background-color:#F2F2F2;">[–0.05%, +0.07%]</span></td>
</tr>
<tr class="ltx_tr" id="S7.T1.st1.2.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T1.st1.2.3.2.1">Time on Platform</th>
<td class="ltx_td ltx_align_center" id="S7.T1.st1.2.3.2.2"><span class="ltx_text" id="S7.T1.st1.2.3.2.2.1" style="background-color:#F2F2F2;">[–0.07%, +0.34%]</span></td>
</tr>
<tr class="ltx_tr" id="S7.T1.st1.2.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T1.st1.2.4.3.1">Heavy Users</th>
<td class="ltx_td ltx_align_center" id="S7.T1.st1.2.4.3.2"><span class="ltx_text" id="S7.T1.st1.2.4.3.2.1" style="background-color:#808080;">[+0.07%, +0.30%]</span></td>
</tr>
<tr class="ltx_tr" id="S7.T1.st1.2.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S7.T1.st1.2.5.4.1">Learnt Reward</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S7.T1.st1.2.5.4.2"><span class="ltx_text" id="S7.T1.st1.2.5.4.2.1" style="background-color:#808080;">[+0.04%, +0.27%]</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S7.T1.st1.3.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S7.T1.st1.4.2" style="font-size:90%;">Global weights on platform A, 14 days, 6.4 million users.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_table ltx_figure_panel" id="S7.T1.st2">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S7.T1.st2.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S7.T1.st2.2.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S7.T1.st2.2.1.1.1"><span class="ltx_text ltx_font_bold" id="S7.T1.st2.2.1.1.1.1">Metric</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S7.T1.st2.2.1.1.2"><span class="ltx_text ltx_font_bold" id="S7.T1.st2.2.1.1.2.1">Relative Improvement (95% C.I.)</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S7.T1.st2.2.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S7.T1.st2.2.2.1.1">Retention</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T1.st2.2.2.1.2"><span class="ltx_text" id="S7.T1.st2.2.2.1.2.1" style="background-color:#808080;">[+0.01%, +0.25%]</span></td>
</tr>
<tr class="ltx_tr" id="S7.T1.st2.2.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T1.st2.2.3.2.1">Time on Platform</th>
<td class="ltx_td ltx_align_center" id="S7.T1.st2.2.3.2.2"><span class="ltx_text" id="S7.T1.st2.2.3.2.2.1" style="background-color:#808080;">[+0.08%, +1.14%]</span></td>
</tr>
<tr class="ltx_tr" id="S7.T1.st2.2.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T1.st2.2.4.3.1">Heavy Users</th>
<td class="ltx_td ltx_align_center" id="S7.T1.st2.2.4.3.2"><span class="ltx_text" id="S7.T1.st2.2.4.3.2.1" style="background-color:#F2F2F2;">[–0.07%, +0.51%]</span></td>
</tr>
<tr class="ltx_tr" id="S7.T1.st2.2.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S7.T1.st2.2.5.4.1">Learnt Reward</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S7.T1.st2.2.5.4.2"><span class="ltx_text" id="S7.T1.st2.2.5.4.2.1" style="background-color:#808080;">[+0.03%, +0.51%]</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S7.T1.st2.3.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S7.T1.st2.4.2" style="font-size:90%;">Feed-specific weights on platform B, 14 days, 10 million users.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S7.T1.5.2.1" style="font-size:90%;">Table 1</span>. </span><span class="ltx_text" id="S7.T1.2.1" style="font-size:90%;">Online A/B-test results from deploying our approach on two large-scale short-video platforms.
We report Bonferroni-corrected 95% confidence intervals for key platform metrics.
We observe statistically significant improvements to both the optimisation target and adjacent metrics, <span class="ltx_text" id="S7.T1.2.1.1" style="background-color:#808080;">highlighting</span> results that are statistically significant with <math alttext="p&lt;0.05" class="ltx_Math" display="inline" id="S7.T1.2.1.m1.1"><semantics id="S7.T1.2.1.m1.1b"><mrow id="S7.T1.2.1.m1.1.1" xref="S7.T1.2.1.m1.1.1.cmml"><mi id="S7.T1.2.1.m1.1.1.2" xref="S7.T1.2.1.m1.1.1.2.cmml">p</mi><mo id="S7.T1.2.1.m1.1.1.1" xref="S7.T1.2.1.m1.1.1.1.cmml">&lt;</mo><mn id="S7.T1.2.1.m1.1.1.3" xref="S7.T1.2.1.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T1.2.1.m1.1c"><apply id="S7.T1.2.1.m1.1.1.cmml" xref="S7.T1.2.1.m1.1.1"><lt id="S7.T1.2.1.m1.1.1.1.cmml" xref="S7.T1.2.1.m1.1.1.1"></lt><ci id="S7.T1.2.1.m1.1.1.2.cmml" xref="S7.T1.2.1.m1.1.1.2">𝑝</ci><cn id="S7.T1.2.1.m1.1.1.3.cmml" type="float" xref="S7.T1.2.1.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T1.2.1.m1.1d">p&lt;0.05</annotation><annotation encoding="application/x-llamapun" id="S7.T1.2.1.m1.1e">italic_p &lt; 0.05</annotation></semantics></math>.</span></figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S7.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.2.3. </span>Online Results (RQ4)</h4>
<div class="ltx_para" id="S7.SS2.SSS3.p1">
<p class="ltx_p" id="S7.SS2.SSS3.p1.1">We deploy the learnt policy obtained through the offline experiment in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S7.F4" title="Figure 4 ‣ 7.1. ESS Corrections &amp; Estimator Coverage (RQ1) ‣ 7. Experiments &amp; Discussion ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">4</span></a> in an online A/B-test with 6.4 million users, over the course of 2 weeks.
Results are reported in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S7.T1.st1" title="In Table 1 ‣ 7.2.2. Offline Results (RQ2–3) ‣ 7.2. Improved Recommendations (RQ2–4) ‣ 7. Experiments &amp; Discussion ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">1(a)</span></a>, for various metrics that are key to the platform.
<span class="ltx_text ltx_font_bold" id="S7.SS2.SSS3.p1.1.1">Retention</span> denotes the fraction of users that use the app the day after, <span class="ltx_text ltx_font_bold" id="S7.SS2.SSS3.p1.1.2">Time</span> on the platform denotes overall time spent on the app, <span class="ltx_text ltx_font_bold" id="S7.SS2.SSS3.p1.1.3">Heavy Users</span> are users that have more than <math alttext="X" class="ltx_Math" display="inline" id="S7.SS2.SSS3.p1.1.m1.1"><semantics id="S7.SS2.SSS3.p1.1.m1.1a"><mi id="S7.SS2.SSS3.p1.1.m1.1.1" xref="S7.SS2.SSS3.p1.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS3.p1.1.m1.1b"><ci id="S7.SS2.SSS3.p1.1.m1.1.1.cmml" xref="S7.SS2.SSS3.p1.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS3.p1.1.m1.1c">X</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS3.p1.1.m1.1d">italic_X</annotation></semantics></math> positive item interactions, and the <span class="ltx_text ltx_font_bold" id="S7.SS2.SSS3.p1.1.4">Learnt Reward</span> is a metric specifically optimised to maximise statistical power w.r.t. the North Star, which is also the optimisation target for our policy learning approach, as described in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S6" title="6. Designing a sensitive reward signal ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">6</span></a>.
We apply a Bonferroni-correction to obtain 95% C.I.s for the relative improvement in these metrics, for the learnt weights over the production weights.
We observe that the learnt policy is able to improve the target metric in the online test, a testament to the effectiveness of the off-policy learning framework.
Indeed, mismatches between online and offline evaluation results plague the recommender systems research field <cite class="ltx_cite ltx_citemacro_citep">(Jeunen, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib26" title="">2019</a>; Gruson et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib20" title="">2019</a>; Gilotte et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib18" title="">2018</a>)</cite>, but the decision-making lens allows us to directly optimise offline estimators of online metrics instead <cite class="ltx_cite ltx_citemacro_citep">(Jeunen, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib27" title="">2021</a>)</cite>.
This experiment highlights the effectiveness of such approaches for general multi-objective recommendation scenarios.</p>
</div>
<div class="ltx_para" id="S7.SS2.SSS3.p2">
<p class="ltx_p" id="S7.SS2.SSS3.p2.1">To reproduce, validate and extend these empirical insights, we perform a second online A/B-test on another large-scale short-video platform, considering similar metrics.
We report results in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#S7.T1.st2" title="In Table 1 ‣ 7.2.2. Offline Results (RQ2–3) ‣ 7.2. Improved Recommendations (RQ2–4) ‣ 7. Experiments &amp; Discussion ‣ Multi-Objective Recommendation via Multivariate Policy Learning"><span class="ltx_text ltx_ref_tag">1(b)</span></a>.
In this experiment, we learn different scalarisation weights for different short-video feeds users can interact with on the platform (i.e. home page feed, specific feeds, et cetera).
Reassuringly, we also observe that the learnt policy is able to improve the target metric significantly.
The time users spend on the platform and user retention also improve significantly.
Because these metrics are not easily moved by online experiments, this represents an important improvement to end-users’ experience on the platforms, and signifies the effectiveness of our method.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S8">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8. </span>Conclusions &amp; Outlook</h2>
<div class="ltx_para" id="S8.p1">
<p class="ltx_p" id="S8.p1.1">Recommender Systems operating on online platforms are typically optimised for multiple objectives via scalarisation techniques <cite class="ltx_cite ltx_citemacro_citep">(Hwang and Masud, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib23" title="">1979</a>)</cite>.
Whilst these techniques help to find Pareto-optimal solutions, the choice of <em class="ltx_emph ltx_font_italic" id="S8.p1.1.1">where</em> on the Pareto-front the platform wishes to place itself, remains a question that is hard to answer.</p>
</div>
<div class="ltx_para" id="S8.p2">
<p class="ltx_p" id="S8.p2.1">In this work, we present a general approach to solve this problem, leveraging elements from the algorithmic decision-making literature.
In particular, we propose to use the Counterfactual Risk Minimisation paradigm <cite class="ltx_cite ltx_citemacro_citep">(Swaminathan and Joachims, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib60" title="">2015a</a>)</cite> with a continuous multivariate action space to learn a scalarisation policy that maximises a notion of North Star reward defined by the platform.
To make our approach more effective and efficient, we propose a policy-dependent correction on the lower bound that is typically used by CRM, which improves empirical coverage at small sample sizes whilst retaining CLT guarantees in the limit.
In doing so, we provide a novel estimator for the ESS and empirically show its utility using synthetic data.
Furthermore, we highlight that the common practice of preferring <em class="ltx_emph ltx_font_italic" id="S8.p2.1.1">uniform</em> randomisation is counterproductive in multivariate domains, and propose to leverage work on “learnt metrics” to design reward signals that are highly correlated with the North Star, but bring improved statistical power to benefit our learning method <cite class="ltx_cite ltx_citemacro_citep">(Jeunen and Ustimenko, <a class="ltx_ref" href="https://arxiv.org/html/2405.02141v2#bib.bib35" title="">2024</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S8.p3">
<p class="ltx_p" id="S8.p3.1">We apply our learning method to two large-scale short-video platforms, with over 160 million monthly active users each, and showcase via off- and online experiments that our methods are able to bring significant value to the platforms’ objectives.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Baweja et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Shubham Baweja, Neeti Pokharna, Aleksei Ustimenko, and Olivier Jeunen. 2024.

</span>
<span class="ltx_bibblock">Variance Reduction in Ratio Metrics for Efficient Online Experiments. In <em class="ltx_emph ltx_font_italic" id="bib.bib2.3.1">Proc. of the 46th European Conference on Information Retrieval</em> <em class="ltx_emph ltx_font_italic" id="bib.bib2.4.2">(ECIR ’24)</em>. Springer.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bendada et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Walid Bendada, Guillaume Salha, and Théo Bontempelli. 2020.

</span>
<span class="ltx_bibblock">Carousel Personalization in Music Streaming Apps with Contextual Bandits. In <em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">Proceedings of the 14th ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib3.4.2">(RecSys ’20)</em>. ACM, 420–425.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3383313.3412217" title="">https://doi.org/10.1145/3383313.3412217</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bottou et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2013)</span>
<span class="ltx_bibblock">
Léon Bottou, Jonas Peters, Joaquin Quiñonero-Candela, Denis X. Charles, D. Max Chickering, Elon Portugaly, Dipankar Ray, Patrice Simard, and Ed Snelson. 2013.

</span>
<span class="ltx_bibblock">Counterfactual Reasoning and Learning Systems: The Example of Computational Advertising.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">Journal of Machine Learning Research</em> 14, 101 (2013), 3207–3260.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="http://jmlr.org/papers/v14/bottou13a.html" title="">http://jmlr.org/papers/v14/bottou13a.html</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Briand et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Léa Briand, Théo Bontempelli, Walid Bendada, Mathieu Morlon, François Rigaud, Benjamin Chapus, Thomas Bouabça, and Guillaume Salha-Galvan. 2024.

</span>
<span class="ltx_bibblock">Let’s Get It Started: Fostering the Discoverability of New Releases on Deezer. In <em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">Advances in Information Retrieval</em>, Nazli Goharian, Nicola Tonellotto, Yulan He, Aldo Lipani, Graham McDonald, Craig Macdonald, and Iadh Ounis (Eds.). Springer Nature Switzerland, Cham, 286–291.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Budylin et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Roman Budylin, Alexey Drutsa, Ilya Katsev, and Valeriya Tsoy. 2018.

</span>
<span class="ltx_bibblock">Consistent Transformation of Ratio Metrics for Efficient Online Controlled Experiments. In <em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">Proc. of the Eleventh ACM International Conference on Web Search and Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib6.4.2">(WSDM ’18)</em>. ACM, 55–63.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3159652.3159699" title="">https://doi.org/10.1145/3159652.3159699</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bugliarello et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Emanuele Bugliarello, Rishabh Mehrotra, James Kirk, and Mounia Lalmas. 2022.

</span>
<span class="ltx_bibblock">Mostra: A Flexible Balancing Framework to Trade-off User, Artist and Platform Objectives for Music Sequencing. In <em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">Proceedings of the ACM Web Conference 2022</em> <em class="ltx_emph ltx_font_italic" id="bib.bib7.4.2">(WWW ’22)</em>. ACM, 2936–2945.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3485447.3512014" title="">https://doi.org/10.1145/3485447.3512014</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Busa-Fekete et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Róbert Busa-Fekete, Balázs Szörényi, Paul Weng, and Shie Mannor. 2017.

</span>
<span class="ltx_bibblock">Multi-objective Bandits: Optimizing the Generalized Gini Index. In <em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">Proceedings of the 34th International Conference on Machine Learning</em> <em class="ltx_emph ltx_font_italic" id="bib.bib8.4.2">(Proceedings of Machine Learning Research, Vol. 70)</em>, Doina Precup and Yee Whye Teh (Eds.). PMLR, 625–634.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.mlr.press/v70/busa-fekete17a.html" title="">https://proceedings.mlr.press/v70/busa-fekete17a.html</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Minmin Chen, Alex Beutel, Paul Covington, Sagar Jain, Francois Belletti, and Ed H. Chi. 2019.

</span>
<span class="ltx_bibblock">Top-K Off-Policy Correction for a REINFORCE Recommender System. In <em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">Proceedings of the Twelfth ACM International Conference on Web Search and Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib9.4.2">(WSDM ’19)</em>. ACM, 456–464.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3289600.3290999" title="">https://doi.org/10.1145/3289600.3290999</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Minmin Chen, Bo Chang, Can Xu, and Ed H. Chi. 2021.

</span>
<span class="ltx_bibblock">User Response Models to Improve a REINFORCE Recommender System. In <em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">Proceedings of the 14th ACM International Conference on Web Search and Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib10.4.2">(WSDM ’21)</em>. ACM, 121–129.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3437963.3441764" title="">https://doi.org/10.1145/3437963.3441764</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Minmin Chen, Can Xu, Vince Gatto, Devanshu Jain, Aviral Kumar, and Ed Chi. 2022.

</span>
<span class="ltx_bibblock">Off-Policy Actor-Critic for Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">Proceedings of the 16th ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib11.4.2">(RecSys ’22)</em>. ACM, 338–349.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3523227.3546758" title="">https://doi.org/10.1145/3523227.3546758</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng and Shi (2016)</span>
<span class="ltx_bibblock">
Alex Deng and Xiaolin Shi. 2016.

</span>
<span class="ltx_bibblock">Data-Driven Metric Development for Online Controlled Experiments: Seven Lessons Learned. In <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib12.2.2">(KDD ’16)</em>. ACM, 77–86.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/2939672.2939700" title="">https://doi.org/10.1145/2939672.2939700</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2013)</span>
<span class="ltx_bibblock">
Alex Deng, Ya Xu, Ron Kohavi, and Toby Walker. 2013.

</span>
<span class="ltx_bibblock">Improving the Sensitivity of Online Controlled Experiments by Utilizing Pre-Experiment Data. In <em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">Proc. of the Sixth ACM International Conference on Web Search and Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib13.4.2">(WSDM ’13)</em>. ACM, 123–132.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/2433396.2433413" title="">https://doi.org/10.1145/2433396.2433413</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dong et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Zhenhua Dong, Hong Zhu, Pengxiang Cheng, Xinhua Feng, Guohao Cai, Xiuqiang He, Jun Xu, and Jirong Wen. 2020.

</span>
<span class="ltx_bibblock">Counterfactual learning for recommender system. In <em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">Proceedings of the 14th ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib14.4.2">(RecSys ’20)</em>. ACM, 568–569.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3383313.3411552" title="">https://doi.org/10.1145/3383313.3411552</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Drugan and Nowe (2013)</span>
<span class="ltx_bibblock">
Madalina M. Drugan and Ann Nowe. 2013.

</span>
<span class="ltx_bibblock">Designing multi-objective multi-armed bandits algorithms: A study. In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">The 2013 International Joint Conference on Neural Networks (IJCNN)</em>. 1–8.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/IJCNN.2013.6707036" title="">https://doi.org/10.1109/IJCNN.2013.6707036</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dudík et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Miroslav Dudík, Dumitru Erhan, John Langford, and Lihong Li. 2014.

</span>
<span class="ltx_bibblock">Doubly Robust Policy Evaluation and Optimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">Statist. Sci.</em> 29, 4 (2014), 485 – 511.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1214/14-STS500" title="">https://doi.org/10.1214/14-STS500</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Elvira et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Víctor Elvira, Luca Martino, and Christian P. Robert. 2022.

</span>
<span class="ltx_bibblock">Rethinking the Effective Sample Size.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">International Statistical Review</em> 90, 3 (2022), 525–550.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1111/insr.12500" title="">https://doi.org/10.1111/insr.12500</a>
arXiv:https://onlinelibrary.wiley.com/doi/pdf/10.1111/insr.12500

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gilotte et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Alexandre Gilotte, Clément Calauzènes, Thomas Nedelec, Alexandre Abraham, and Simon Dollé. 2018.

</span>
<span class="ltx_bibblock">Offline A/B Testing for Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">Proc. of the Eleventh ACM International Conference on Web Search and Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib18.4.2">(WSDM ’18)</em>. ACM, 198–206.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3159652.3159687" title="">https://doi.org/10.1145/3159652.3159687</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goodhart (1984)</span>
<span class="ltx_bibblock">
Charles A. E. Goodhart. 1984.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Problems of Monetary Management: The UK Experience</em>.

</span>
<span class="ltx_bibblock">Macmillan Education UK, London, 91–121.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gruson et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Alois Gruson, Praveen Chandar, Christophe Charbuillet, James McInerney, Samantha Hansen, Damien Tardieu, and Ben Carterette. 2019.

</span>
<span class="ltx_bibblock">Offline Evaluation to Make Decisions About PlaylistRecommendation Algorithms. In <em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">Proceedings of the Twelfth ACM International Conference on Web Search and Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib20.4.2">(WSDM ’19)</em>. ACM, 420–428.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3289600.3291027" title="">https://doi.org/10.1145/3289600.3291027</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Yulong Gu, Zhuoye Ding, Shuaiqiang Wang, Lixin Zou, Yiding Liu, and Dawei Yin. 2020.

</span>
<span class="ltx_bibblock">Deep Multifaceted Transformers for Multi-objective Ranking in Large-Scale E-commerce Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">Proceedings of the 29th ACM International Conference on Information &amp; Knowledge Management</em> <em class="ltx_emph ltx_font_italic" id="bib.bib21.4.2">(CIKM ’20)</em>. ACM, 2493–2500.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3340531.3412697" title="">https://doi.org/10.1145/3340531.3412697</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gupta et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Shashank Gupta, Olivier Jeunen, Harrie Oosterhuis, and Maarten de Rijke. 2024.

</span>
<span class="ltx_bibblock">Optimal Baseline Corrections for Off-Policy Contextual Bandits. In <em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">Proceedings of the 18th ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib22.4.2">(RecSys ’24)</em>.

</span>
<span class="ltx_bibblock">arXiv:2405.05736 [cs.LG]

<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2405.05736" title="">https://arxiv.org/abs/2405.05736</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hwang and Masud (1979)</span>
<span class="ltx_bibblock">
Ching-Lai Hwang and Abu Syed Md. Masud. 1979.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Multiple objective decision making — Methods and applications: a state-of-the-art survey</em>. Lecture Notes in Economics and Mathematical Systems, Vol. 164.

</span>
<span class="ltx_bibblock">Springer Science &amp; Business Media.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1007/978-3-642-45511-7" title="">https://doi.org/10.1007/978-3-642-45511-7</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ionides (2008)</span>
<span class="ltx_bibblock">
Edward L Ionides. 2008.

</span>
<span class="ltx_bibblock">Truncated Importance Sampling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Journal of Computational and Graphical Statistics</em> 17, 2 (2008), 295–311.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1198/106186008X320456" title="">https://doi.org/10.1198/106186008X320456</a>
arXiv:https://doi.org/10.1198/106186008X320456

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jannach and Abdollahpouri (2023)</span>
<span class="ltx_bibblock">
Dietmar Jannach and Himan Abdollahpouri. 2023.

</span>
<span class="ltx_bibblock">A survey on multi-objective recommender systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Frontiers in Big Data</em> 6 (2023).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.3389/fdata.2023.1157899" title="">https://doi.org/10.3389/fdata.2023.1157899</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeunen (2019)</span>
<span class="ltx_bibblock">
Olivier Jeunen. 2019.

</span>
<span class="ltx_bibblock">Revisiting Offline Evaluation for Implicit-Feedback Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Proceedings of the 13th ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib26.2.2">(RecSys ’19)</em>. ACM, 596–600.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3298689.3347069" title="">https://doi.org/10.1145/3298689.3347069</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeunen (2021)</span>
<span class="ltx_bibblock">
Olivier Jeunen. 2021.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Offline approaches to recommendation with online success</em>.

</span>
<span class="ltx_bibblock">Ph. D. Dissertation. University of Antwerp.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeunen and Goethals (2020)</span>
<span class="ltx_bibblock">
Olivier Jeunen and Bart Goethals. 2020.

</span>
<span class="ltx_bibblock">An Empirical Evaluation of Doubly Robust Learning for Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proceedings of the ACM RecSys Workshop on Bandit Learning from User Interactions</em> <em class="ltx_emph ltx_font_italic" id="bib.bib28.2.2">(REVEAL ’20)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeunen and Goethals (2021a)</span>
<span class="ltx_bibblock">
Olivier Jeunen and Bart Goethals. 2021a.

</span>
<span class="ltx_bibblock">Pessimistic Reward Models for Off-Policy Learning in Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Proceedings of the 15th ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib29.2.2">(RecSys ’21)</em>. ACM, 63–74.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3460231.3474247" title="">https://doi.org/10.1145/3460231.3474247</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeunen and Goethals (2021b)</span>
<span class="ltx_bibblock">
Olivier Jeunen and Bart Goethals. 2021b.

</span>
<span class="ltx_bibblock">Top-K Contextual Bandits with Equity of Exposure. In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Proceedings of the 15th ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib30.2.2">(RecSys ’21)</em>. ACM, 310–320.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3460231.3474248" title="">https://doi.org/10.1145/3460231.3474248</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeunen and Goethals (2023)</span>
<span class="ltx_bibblock">
Olivier Jeunen and Bart Goethals. 2023.

</span>
<span class="ltx_bibblock">Pessimistic Decision-Making for Recommender Systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">ACM Trans. Recomm. Syst.</em> 1, 1, Article 4 (feb 2023), 27 pages.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3568029" title="">https://doi.org/10.1145/3568029</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeunen et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Olivier Jeunen, Thorsten Joachims, Harrie Oosterhuis, Yuta Saito, and Flavian Vasile. 2022.

</span>
<span class="ltx_bibblock">CONSEQUENCES — Causality, Counterfactuals and Sequential Decision-Making for Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">Proceedings of the 16th ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib32.4.2">(RecSys ’22)</em>. ACM, 654–657.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3523227.3547409" title="">https://doi.org/10.1145/3523227.3547409</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeunen et al<span class="ltx_text" id="bib.bib33.3.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Olivier Jeunen, Ivan Potapov, and Aleksei Ustimenko. 2024.

</span>
<span class="ltx_bibblock">On (Normalised) Discounted Cumulative Gain as an Offline Evaluation Metric for Top-<math alttext="n" class="ltx_Math" display="inline" id="bib.bib33.1.m1.1"><semantics id="bib.bib33.1.m1.1a"><mi id="bib.bib33.1.m1.1.1" xref="bib.bib33.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="bib.bib33.1.m1.1b"><ci id="bib.bib33.1.m1.1.1.cmml" xref="bib.bib33.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib33.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="bib.bib33.1.m1.1d">italic_n</annotation></semantics></math> Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib33.4.1">Proceedings of the 30th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib33.5.2">(KDD ’24)</em>.

</span>
<span class="ltx_bibblock">arXiv:2307.15053 [cs.IR]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeunen et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Olivier Jeunen, David Rohde, Flavian Vasile, and Martin Bompaire. 2020.

</span>
<span class="ltx_bibblock">Joint Policy-Value Learning for Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">Proceedings of the 26th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib34.4.2">(KDD ’20)</em>. ACM, 1223–1233.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3394486.3403175" title="">https://doi.org/10.1145/3394486.3403175</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeunen and Ustimenko (2024)</span>
<span class="ltx_bibblock">
Olivier Jeunen and Aleksei Ustimenko. 2024.

</span>
<span class="ltx_bibblock">Learning Metrics that Maximise Power for Accelerated A/B-Tests. In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Proceedings of the 30th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib35.2.2">(KDD ’24)</em>.

</span>
<span class="ltx_bibblock">arXiv:2402.03915 [cs.LG]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kallus and Zhou (2018)</span>
<span class="ltx_bibblock">
Nathan Kallus and Angela Zhou. 2018.

</span>
<span class="ltx_bibblock">Policy Evaluation and Optimization with Continuous Treatments. In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Proceedings of the Twenty-First International Conference on Artificial Intelligence and Statistics</em> <em class="ltx_emph ltx_font_italic" id="bib.bib36.2.2">(Proceedings of Machine Learning Research, Vol. 84)</em>, Amos Storkey and Fernando Perez-Cruz (Eds.). PMLR, 1243–1251.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.mlr.press/v84/kallus18a.html" title="">https://proceedings.mlr.press/v84/kallus18a.html</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kharitonov et al<span class="ltx_text" id="bib.bib37.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Eugene Kharitonov, Alexey Drutsa, and Pavel Serdyukov. 2017.

</span>
<span class="ltx_bibblock">Learning Sensitive Combinations of A/B Test Metrics. In <em class="ltx_emph ltx_font_italic" id="bib.bib37.3.1">Proceedings of the Tenth ACM International Conference on Web Search and Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib37.4.2">(WSDM ’17)</em>. ACM, 651–659.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3018661.3018708" title="">https://doi.org/10.1145/3018661.3018708</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kong (1992)</span>
<span class="ltx_bibblock">
Augustine Kong. 1992.

</span>
<span class="ltx_bibblock">A note on importance sampling using standardized weights.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">University of Chicago, Dept. of Statistics, Tech. Rep</em> 348 (1992).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lattimore and Szepesvári (2020)</span>
<span class="ltx_bibblock">
Tor Lattimore and Csaba Szepesvári. 2020.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">Bandit algorithms</em>.

</span>
<span class="ltx_bibblock">Cambridge University Press.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al<span class="ltx_text" id="bib.bib40.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Xiao Lin, Hongjie Chen, Changhua Pei, Fei Sun, Xuanji Xiao, Hanxiao Sun, Yongfeng Zhang, Wenwu Ou, and Peng Jiang. 2019.

</span>
<span class="ltx_bibblock">A pareto-efficient algorithm for multiple objective optimization in e-commerce recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib40.3.1">Proceedings of the 13th ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib40.4.2">(RecSys ’19)</em>. ACM, 20–28.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3298689.3346998" title="">https://doi.org/10.1145/3298689.3346998</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib41.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yaxu Liu, Jui-Nan Yen, Bowen Yuan, Rundong Shi, Peng Yan, and Chih-Jen Lin. 2022.

</span>
<span class="ltx_bibblock">Practical Counterfactual Policy Learning for Top-K Recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib41.3.1">Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib41.4.2">(KDD ’22)</em>. ACM, 1141–1151.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3534678.3539295" title="">https://doi.org/10.1145/3534678.3539295</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">London and Joachims (2022)</span>
<span class="ltx_bibblock">
Ben London and Thorsten Joachims. 2022.

</span>
<span class="ltx_bibblock">Control Variate Diagnostics for Detecting Problems in Logged Bandit Feedback. In <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">CONSEQUENCES+REVEAL Workshop at ACM RecSys ’22</em> <em class="ltx_emph ltx_font_italic" id="bib.bib42.2.2">(CONSEQUENCES+REVEAL ’22)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al<span class="ltx_text" id="bib.bib43.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Jiaqi Ma, Zhe Zhao, Xinyang Yi, Jilin Chen, Lichan Hong, and Ed H. Chi. 2018.

</span>
<span class="ltx_bibblock">Modeling Task Relationships in Multi-task Learning with Multi-gate Mixture-of-Experts. In <em class="ltx_emph ltx_font_italic" id="bib.bib43.3.1">Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib43.4.2">(KDD ’18)</em>. ACM, 1930–1939.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3219819.3220007" title="">https://doi.org/10.1145/3219819.3220007</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al<span class="ltx_text" id="bib.bib44.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Jiaqi Ma, Zhe Zhao, Xinyang Yi, Ji Yang, Minmin Chen, Jiaxi Tang, Lichan Hong, and Ed H. Chi. 2020.

</span>
<span class="ltx_bibblock">Off-Policy Learning in Two-Stage Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib44.3.1">Proceedings of The Web Conference 2020</em> <em class="ltx_emph ltx_font_italic" id="bib.bib44.4.2">(WWW ’20)</em>. ACM, 463–473.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3366423.3380130" title="">https://doi.org/10.1145/3366423.3380130</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Martino et al<span class="ltx_text" id="bib.bib45.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Luca Martino, Víctor Elvira, and Francisco Louzada. 2017.

</span>
<span class="ltx_bibblock">Effective sample size for importance sampling based on discrepancy measures.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.3.1">Signal Processing</em> 131 (2017), 386–401.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1016/j.sigpro.2016.08.025" title="">https://doi.org/10.1016/j.sigpro.2016.08.025</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Maurer and Pontil (2009)</span>
<span class="ltx_bibblock">
Andreas Maurer and Massimiliano Pontil. 2009.

</span>
<span class="ltx_bibblock">Empirical Bernstein Bounds and Sample Variance Penalization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">Stat.</em> 1050 (2009), 21.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McInerney et al<span class="ltx_text" id="bib.bib47.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
James McInerney, Benjamin Lacker, Samantha Hansen, Karl Higley, Hugues Bouchard, Alois Gruson, and Rishabh Mehrotra. 2018.

</span>
<span class="ltx_bibblock">Explore, exploit, and explain: personalizing explainable recommendations with bandits. In <em class="ltx_emph ltx_font_italic" id="bib.bib47.3.1">Proceedings of the 12th ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib47.4.2">(RecSys ’18)</em>. ACM, 31–39.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3240323.3240354" title="">https://doi.org/10.1145/3240323.3240354</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mehrotra et al<span class="ltx_text" id="bib.bib48.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Rishabh Mehrotra, James McInerney, Hugues Bouchard, Mounia Lalmas, and Fernando Diaz. 2018.

</span>
<span class="ltx_bibblock">Towards a Fair Marketplace: Counterfactual Evaluation of the trade-off between Relevance, Fairness &amp; Satisfaction in Recommendation Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib48.3.1">Proceedings of the 27th ACM International Conference on Information and Knowledge Management</em> <em class="ltx_emph ltx_font_italic" id="bib.bib48.4.2">(CIKM ’18)</em>. ACM, 2243–2251.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3269206.3272027" title="">https://doi.org/10.1145/3269206.3272027</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mehrotra et al<span class="ltx_text" id="bib.bib49.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Rishabh Mehrotra, Niannan Xue, and Mounia Lalmas. 2020.

</span>
<span class="ltx_bibblock">Bandit based Optimization of Multiple Objectives on a Music Streaming Platform. In <em class="ltx_emph ltx_font_italic" id="bib.bib49.3.1">Proceedings of the 26th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib49.4.2">(KDD ’20)</em>. ACM, 3224–3233.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3394486.3403374" title="">https://doi.org/10.1145/3394486.3403374</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Merrill and Oremus (2021)</span>
<span class="ltx_bibblock">
Jeremy B. Merrill and Will Oremus. 2021.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">Five points for anger, one for a ‘like’: How Facebook’s formula fostered rage and misinformation</em>.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.washingtonpost.com/technology/2021/10/26/facebook-angry-emoji-algorithm/" title="">https://www.washingtonpost.com/technology/2021/10/26/facebook-angry-emoji-algorithm/</a>
</span>
<span class="ltx_bibblock">Accessed: 2024-04-10.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Milli et al<span class="ltx_text" id="bib.bib51.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Smitha Milli, Emma Pierson, and Nikhil Garg. 2023.

</span>
<span class="ltx_bibblock">Choosing the Right Weights: Balancing Value, Strategy, and Noise in Recommender Systems.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2305.17428 [cs.LG]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Owen (2013)</span>
<span class="ltx_bibblock">
Art B. Owen. 2013.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">Monte Carlo theory, methods and examples</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Poyarkov et al<span class="ltx_text" id="bib.bib53.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Alexey Poyarkov, Alexey Drutsa, Andrey Khalyavin, Gleb Gusev, and Pavel Serdyukov. 2016.

</span>
<span class="ltx_bibblock">Boosted Decision Tree Regression Adjustment for Variance Reduction in Online Controlled Experiments. In <em class="ltx_emph ltx_font_italic" id="bib.bib53.3.1">Proc. of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib53.4.2">(KDD ’16)</em>. ACM, 235–244.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/2939672.2939688" title="">https://doi.org/10.1145/2939672.2939688</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ribeiro et al<span class="ltx_text" id="bib.bib54.2.2.1">.</span> (2012)</span>
<span class="ltx_bibblock">
Marco Tulio Ribeiro, Anisio Lacerda, Adriano Veloso, and Nivio Ziviani. 2012.

</span>
<span class="ltx_bibblock">Pareto-efficient hybridization for multi-objective recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib54.3.1">Proceedings of the Sixth ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib54.4.2">(RecSys ’12)</em>. ACM, 19–26.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/2365952.2365962" title="">https://doi.org/10.1145/2365952.2365962</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sagtani et al<span class="ltx_text" id="bib.bib55.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Hitesh Sagtani, Madan Gopal Jhawar, Akshat Gupta, and Rishabh Mehrotra. 2023.

</span>
<span class="ltx_bibblock">Quantifying and Leveraging User Fatigue for Interventions in Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib55.3.1">Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval</em> <em class="ltx_emph ltx_font_italic" id="bib.bib55.4.2">(SIGIR ’23)</em>. ACM, 2293–2297.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3539618.3592044" title="">https://doi.org/10.1145/3539618.3592044</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sagtani et al<span class="ltx_text" id="bib.bib56.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Hitesh Sagtani, Madan Gopal Jhawar, Rishabh Mehrotra, and Olivier Jeunen. 2024.

</span>
<span class="ltx_bibblock">Ad-load Balancing via Off-policy Learning in a Content Marketplace. In <em class="ltx_emph ltx_font_italic" id="bib.bib56.3.1">Proceedings of the 17th ACM International Conference on Web Search and Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib56.4.2">(WSDM ’24)</em>. ACM, 586–595.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3616855.3635846" title="">https://doi.org/10.1145/3616855.3635846</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sakhi et al<span class="ltx_text" id="bib.bib57.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Otmane Sakhi, Stephen Bonner, David Rohde, and Flavian Vasile. 2020.

</span>
<span class="ltx_bibblock">BLOB: A Probabilistic Model for Recommendation that Combines Organic and Bandit Signals. In <em class="ltx_emph ltx_font_italic" id="bib.bib57.3.1">Proceedings of the 26th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib57.4.2">(KDD ’20)</em>. ACM, 783–793.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3394486.3403121" title="">https://doi.org/10.1145/3394486.3403121</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Smith (2021)</span>
<span class="ltx_bibblock">
Ben Smith. 2021.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib58.1.1">How TikTok Reads Your Mind</em>.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.nytimes.com/2021/12/05/business/media/tiktok-algorithm.html" title="">https://www.nytimes.com/2021/12/05/business/media/tiktok-algorithm.html</a>
</span>
<span class="ltx_bibblock">Accessed: 2024-04-10.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et al<span class="ltx_text" id="bib.bib59.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Yi Su, Xiangyu Wang, Elaine Ya Le, Liang Liu, Yuening Li, Haokai Lu, Benjamin Lipshitz, Sriraj Badam, Lukasz Heldt, Shuchao Bi, Ed H. Chi, Cristos Goodrow, Su-Lin Wu, Lexi Baugher, and Minmin Chen. 2024.

</span>
<span class="ltx_bibblock">Long-Term Value of Exploration: Measurements, Findings and Algorithms. In <em class="ltx_emph ltx_font_italic" id="bib.bib59.3.1">Proceedings of the 17th ACM International Conference on Web Search and Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib59.4.2">(WSDM ’24)</em>. ACM, 636–644.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3616855.3635833" title="">https://doi.org/10.1145/3616855.3635833</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Swaminathan and Joachims (2015a)</span>
<span class="ltx_bibblock">
Adith Swaminathan and Thorsten Joachims. 2015a.

</span>
<span class="ltx_bibblock">Batch learning from logged bandit feedback through counterfactual risk minimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib60.1.1">The Journal of Machine Learning Research</em> 16, 1 (2015), 1731–1755.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Swaminathan and Joachims (2015b)</span>
<span class="ltx_bibblock">
Adith Swaminathan and Thorsten Joachims. 2015b.

</span>
<span class="ltx_bibblock">The Self-Normalized Estimator for Counterfactual Learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib61.1.1">Advances in Neural Information Processing Systems</em>, Vol. 28.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper_files/paper/2015/file/39027dfad5138c9ca0c474d71db915c3-Paper.pdf" title="">https://proceedings.neurips.cc/paper_files/paper/2015/file/39027dfad5138c9ca0c474d71db915c3-Paper.pdf</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang et al<span class="ltx_text" id="bib.bib62.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Gary Tang, Jiangwei Pan, Henry Wang, and Justin Basilico. 2023.

</span>
<span class="ltx_bibblock">Reward innovation for long-term member satisfaction. In <em class="ltx_emph ltx_font_italic" id="bib.bib62.3.1">Proceedings of the 17th ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib62.4.2">(RecSys ’23)</em>. ACM, 396–399.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3604915.3608873" title="">https://doi.org/10.1145/3604915.3608873</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Twitter (2023)</span>
<span class="ltx_bibblock">
Twitter. 2023.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib63.1.1">The Algorithm repository</em>.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/twitter/the-algorithm-ml/tree/main/projects/home/recap" title="">https://github.com/twitter/the-algorithm-ml/tree/main/projects/home/recap</a>
</span>
<span class="ltx_bibblock">Accessed: 2024-04-10.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">van den Akker et al<span class="ltx_text" id="bib.bib64.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Bram van den Akker, Olivier Jeunen, Ying Li, Ben London, Zahra Nazari, and Devesh Parekh. 2024.

</span>
<span class="ltx_bibblock">Practical Bandits: An Industry Perspective. In <em class="ltx_emph ltx_font_italic" id="bib.bib64.3.1">Proceedings of the 17th ACM International Conference on Web Search and Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib64.4.2">(WSDM ’24)</em>. ACM, 1132–1135.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3616855.3636449" title="">https://doi.org/10.1145/3616855.3636449</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib65">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wan and McAuley (2018)</span>
<span class="ltx_bibblock">
Mengting Wan and Julian McAuley. 2018.

</span>
<span class="ltx_bibblock">Item recommendation on monotonic behavior chains. In <em class="ltx_emph ltx_font_italic" id="bib.bib65.1.1">Proceedings of the 12th ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib65.2.2">(RecSys ’18)</em>. ACM, 86–94.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3240323.3240369" title="">https://doi.org/10.1145/3240323.3240369</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib66">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al<span class="ltx_text" id="bib.bib66.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Ruobing Xie, Yanlei Liu, Shaoliang Zhang, Rui Wang, Feng Xia, and Leyu Lin. 2021.

</span>
<span class="ltx_bibblock">Personalized Approximate Pareto-Efficient Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib66.3.1">Proceedings of the Web Conference 2021</em> <em class="ltx_emph ltx_font_italic" id="bib.bib66.4.2">(WWW ’21)</em>. ACM, 3839–3849.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3442381.3450039" title="">https://doi.org/10.1145/3442381.3450039</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib67">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib67.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Qihua Zhang, Junning Liu, Yuzhuo Dai, Yiyan Qi, Yifan Yuan, Kunlun Zheng, Fan Huang, and Xianfeng Tan. 2022.

</span>
<span class="ltx_bibblock">Multi-Task Fusion via Reinforcement Learning for Long-Term User Satisfaction in Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib67.3.1">Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib67.4.2">(KDD ’22)</em>. ACM, 4510–4520.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3534678.3539040" title="">https://doi.org/10.1145/3534678.3539040</a>
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Sep 16 09:21:00 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
