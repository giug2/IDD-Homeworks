<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2409.09391] Tran-GCN: A Transformer-Enhanced Graph Convolutional Network for Person Re-Identification in Monitoring Videos</title><meta property="og:description" content="Person Re-Identification (Re-ID) has gained popularity in computer vision, enabling cross-camera pedestrian recognition. Although the development of deep learning has provided a robust technical foundation for person R…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Tran-GCN: A Transformer-Enhanced Graph Convolutional Network for Person Re-Identification in Monitoring Videos">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Tran-GCN: A Transformer-Enhanced Graph Convolutional Network for Person Re-Identification in Monitoring Videos">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2409.09391">

<!--Generated on Sun Oct  6 01:59:27 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_fleqn">
<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p">1]<span id="p1.1.1" class="ltx_ERROR undefined">\orgdiv</span>Faculty of Computing, <span id="p1.1.2" class="ltx_ERROR undefined">\orgname</span>Universiti Teknologi Malaysia, <span id="p1.1.3" class="ltx_ERROR undefined">\orgaddress</span><span id="p1.1.4" class="ltx_ERROR undefined">\street</span>Jalan Iman, <span id="p1.1.5" class="ltx_ERROR undefined">\city</span>Skudai, <span id="p1.1.6" class="ltx_ERROR undefined">\postcode</span>81310, <span id="p1.1.7" class="ltx_ERROR undefined">\state</span>Johor, <span id="p1.1.8" class="ltx_ERROR undefined">\country</span>Malaysia</p>
</div>
<div id="p2" class="ltx_para">
<p id="p2.1" class="ltx_p">2]<span id="p2.1.1" class="ltx_ERROR undefined">\orgdiv</span>Malaysia-Japan International Institute of Technology, <span id="p2.1.2" class="ltx_ERROR undefined">\orgname</span>Universiti Teknologi Malaysia, <span id="p2.1.3" class="ltx_ERROR undefined">\orgaddress</span><span id="p2.1.4" class="ltx_ERROR undefined">\street</span>Kuala Lumpur, <span id="p2.1.5" class="ltx_ERROR undefined">\postcode</span>54100, <span id="p2.1.6" class="ltx_ERROR undefined">\country</span>Malaysia</p>
</div>
<h1 class="ltx_title ltx_title_document">Tran-GCN: A Transformer-Enhanced Graph
Convolutional Network for Person
Re-Identification in Monitoring Videos</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span id="id1.1.id1" class="ltx_ERROR undefined">\fnm</span>Xiaobin <span id="id2.2.id2" class="ltx_ERROR undefined">\sur</span>Hong
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:xiaobin20@graduate.utm.my">xiaobin20@graduate.utm.my</a>
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span id="id3.1.id1" class="ltx_ERROR undefined">\fnm</span>Tarmizi <span id="id4.2.id2" class="ltx_ERROR undefined">\sur</span>Adam
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:Tarmizi.adam@utm.my">Tarmizi.adam@utm.my</a>
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span id="id5.1.id1" class="ltx_ERROR undefined">\fnm</span>Masitah <span id="id6.2.id2" class="ltx_ERROR undefined">\sur</span>Ghazali
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:Masitah@utm.my">Masitah@utm.my</a>
</span>
<span class="ltx_contact ltx_role_affiliation">[
</span>
<span class="ltx_contact ltx_role_affiliation">[
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id7.id1" class="ltx_p">Person Re-Identification (Re-ID) has gained popularity in computer vision, enabling cross-camera pedestrian recognition. Although the development of deep learning has provided a robust technical foundation for person Re-ID research, most existing person Re-ID methods overlook the potential relationships among local person features, failing to adequately address the impact of pedestrian pose variations and local body parts occlusion.
Therefore, we propose a Transformer-enhanced Graph Convolutional Network (Tran-GCN) model to improve Person Re-Identification performance in monitoring videos. The model comprises four key components: (1) A Pose Estimation Learning branch is utilized to estimate pedestrian pose information and inherent skeletal structure data, extracting pedestrian key point information; (2) A Transformer learning branch learns the global dependencies between fine-grained and semantically meaningful local person features; (3) A Convolution learning branch uses the basic ResNet architecture to extract the person’s fine-grained local features; (4) A Graph Convolutional Module (GCM) integrates local feature information, global feature information, and body information for more effective person identification after fusion.
Quantitative and qualitative analysis experiments conducted on three different datasets (Market-1501, DukeMTMC-ReID, and MSMT17) demonstrate that the Tran-GCN model can more accurately capture discriminative person features in monitoring videos, significantly improving identification accuracy.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>Person Re-Identification,ResNet, OpenPose, Graph Convolutional Network
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Person Re-Identification is a technology that utilizes computer vision techniques to determine whether a specific pedestrian exists in an image or video sequence, aiming to retrieve individuals of interest through multiple non-overlapping cameras <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. As a fundamental computer vision task, Person Re-Identification is used in various fields such as public safety, traffic management, smart urban management and autonomous driving <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">As Person Re-Identification evolves rapidly, deep learning has emerged as the primary research and technical approach in this domain<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>.Yi and Li et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> introduce Person Re-Identification methods grounded in feature representation, utilizing Siamese network models to compute similarities between pedestrian images. Weinberger et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> propose a metric learning-based approach, designing a suitable and effective triplet loss function through a function to ensure that pedestrian images adhere to specific distributions in the target feature space. Wang, Song, and Zhao et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> introduce methods centered on local features, adopting grid partitioning, human semantic segmentation techniques, and utilizing pedestrian key points to extract local features from specific body parts. Unfortunately, most existing Person Re-Identification methods overlook the inherent structural information of the human body and the relationships between local features. This can result in inaccurate retrieval outcomes when pedestrian poses vary or when pedestrians exhibit similar appearances. The inadequate handling of pedestrian poses and the relationships between local features has limited the generalization capabilities of models, thereby hindering the progress of Person Re-Identification technology.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">At present, several deep learning models excel in extracting local pedestrian features and estimating pedestrian poses. For example, part-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> adopt horizontal or grid partitioning to obtain various local regions of pedestrians, Using ResNet to obtain global features,facilitating the alignment of pedestrian images <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. However, due to the small size of pedestrian datasets, these models are prone to overfitting. Metric learning-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> emphasize designing suitable and effective metric loss functions to continuously reduce the distance between images of the same pedestrian and increase the distance between images of different pedestrians. Although this approach achieves high recognition accuracy, its generalization performance suffers when confronted with complex backgrounds. Local feature-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> utilize manual partitioning or auxiliary information such as pedestrian poses to acquire local regional features from pedestrian images, thereby mitigating the effects of misalignment and pose variations. Nevertheless, these methods overlook the potential relationships between local pedestrian features, failing to extract discriminative key information when noise is present in images.
Multimodal fusion optimization is verified by demonstrating improved performance metrics, such as accuracy and robustness, when integrating data from multiple modalities compared to using individual modalities alone <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>.
Therefore, it is crucial for person re-identification networks to comprehensively consider the extraction of local features, the global dependencies between these local features, and pedestrian poseture or gesture information <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this paper, we propose a Tran-GCN person re-identification model that systematically integrates local features, the global dependencies between these features, and pedestrian pose information using a graph convolution module, thereby capturing more detailed and comprehensive pedestrian characteristics to significantly enhance the performance and accuracy of person re-identification.
First, pedestrian pose estimation is utilized to obtain rich joint skeleton structure information of pedestrians, constructs a topological graph of pedestrian joints, extracts local features of each key point using joint information, and learns the adjacency matrix of the human topology graph. Next, ResNet and Transformer extract fine-grained local features and global appearance features relationship of pedestrians, respectively. Finally, GCM integrates the correlations among these three types of features to extract more discriminative pedestrian features, effectively addressing challenges such as variations in pedestrian poses, similarities in pedestrian appearances, and partial occlusions.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">The main contributions of this study are as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We present a Tran-GCN network, which simultaneously captures local features, global dependencies of local features, and pedestrian pose information, and then uses graph networks to generate more discriminative features, enhancing the ability to distinguish between different pedestrians.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">A graph convolution module is proposed to effectively and efficiently integrate local features, global features, and pedestrian pose information by capturing features through the adjacency matrix, enabling a high-level understanding of pedestrian characteristics and behaviors.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Extensive experiments on the Market-1501 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, DukeMTMC-ReID <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>, and MSMT17 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> Person Re-Identification datasets demonstrate the effectiveness and robustness of the proposed Tran-GCN model in addressing various challenges in Person Re-Identification, highlighting its outstanding performance across these diverse datasets.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">In recent years, deep learning-based methods have dominated the field of Person Re-Identification. In this section, we comprehensively review three popular Person Re-Identification approaches: feature representation-based methods, metric learning-based methods, and local feature-based methods. These approaches are closely related to our proposed Person Re-Identification method.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Feature Representation-based Methods</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Most existing Person Re-Identification techniques focus on this approach, leveraging the concept of image classification tasks to transform Person Re-Identification into either a classification or verification task. Typically, the entire pedestrian image was input into a network to extract the global features of the pedestrian. Geng et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> aimed to fully utilize pedestrian label information by utilizing a joint learning approach with a classification subnetwork and a verification subnetwork, thereby extracting more discriminative pedestrian features. In addition to utilizing pedestrian label information, various attribute label information of pedestrians, such as long or short hair, whether carrying a backpack, whether wearing a hat, etc., had also been fully explored. For example, Zhang et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> proposed a multi-task learning framework that combined attribute label information and jointly trained classification and verification networks to extract complementary and discriminative pedestrian features. Ahmed et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> added a cross-input neighborhood difference layer and an image patch difference accumulation layer to the Siamese network. By calculating the differences between adjacent local region blocks, they were able to obtain the similarity between pedestrian images. Although this method could extract complementary and discriminative pedestrian features, the small size of pedestrian datasets could easily lead to model overfitting.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Metric Learning-based Methods</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">This Person Re-Identification method focused on designing appropriate and effective metric loss functions to reduce the intra-class distance (between similar pedestrians) and increase the inter-class distance (between different pedestrians). Cheng et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> proposed the Triplet Loss function, which involved inputting three pedestrian images at a time: an anchor image, a positive sample (similar to the anchor), and a negative sample (dissimilar to the anchor). During the network optimization process, the distance between positive sample pairs is minimized, while the distance between negative sample pairs is maintained above a certain threshold.To enhance the performance of the Triplet Loss, Hermans et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> introduced the concept of Hard Sample Mining into the Triplet Loss function. This improvement involved selecting, within each input batch, the least similar positive sample and the most similar negative sample to the anchor sample as ”hard samples” during training. This approach helped improve the model’s generalization ability.Furthermore, Chen et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> proposed the Quadruplet Loss function, which extended the Triplet Loss by adding a pair of negative samples. This additional pair served as a weakly supervised term, enhancing the model’s learning capability. While this method achieved high recognition accuracy, the model’s generalization performance may decrease when there were significant variations in pedestrian poses.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Local Features-based Methods</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">Recently, numerous studies have leveraged local feature information to improve the representation of local features in Person Re-Identification tasks. Some part-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite> utilized manually defined horizontal or network-partitioned pedestrian local regions, which tended to be coarse and did not account for the refined local characteristics of pedestrians. These methods were sensitive to changes in pedestrian poses. On the other hand, mask-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>, <a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib45" title="" class="ltx_ref">45</a>, <a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite> could effectively eliminate the impact of background noise, but they primarily contain shape information of the human body, and the extracted semantic information heavily relied on the performance of semantic segmentation algorithms. Pose-based methods
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>, <a href="#bib.bib48" title="" class="ltx_ref">48</a>, <a href="#bib.bib49" title="" class="ltx_ref">49</a>, <a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite>, while capable of mitigating the effects of pedestrian misalignment and pose variations, often overlooked the relationships between local features of pedestrians. When there were partial occlusions in the images, these methods might lose some of their generalization capabilities.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Proposed method</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this section, we first introduce the overall structure of the network, followed by a description of the multi-branch feature extraction backbone. Next, we explain how the GCM efficiently and effectively integrates the multiple features extracted by the multi-branch Backbone. Finally, the loss function for training the multi-branch network is discussed in Section 3.4.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Overview</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">Fig. <a href="#S3.F1" title="Figure 1 ‣ 3.1 Overview ‣ 3 Proposed method ‣ Tran-GCN: A Transformer-Enhanced Graph Convolutional Network for Person Re-Identification in Monitoring Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates the overall network structure of the proposed Tran-GCN, which comprises two main parts: the multi-branch Feature Extraction backbone and the feature fusion Graph Convolutional module (GCM). We denote the input as a probe person image. This probe image Input is passed through the Multi-Branch Feature Extraction backbone to obtain the pedestrian’s pose information, global features, and local feature relationships. The first part contains three components, each with a corresponding loss function, explained in Section 3.2 and Section 3.4. Finally, GCM integrates the above pedestrian information to generate richer and more discriminative feature representations, aiding in accurate pedestrian identification in complex backgrounds, which is explained in detail in Section 3.3.</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2409.09391/assets/x1.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="378" height="287" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Illustration of our proposed framework includes two parts: (1) Multi-branch Feature Extraction Backbone which extracts pedestrian multi-scale features; (2) GCM branch which performs fusing the pedestrian features from above.</figcaption>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Multi-Branch Feature Extraction Backbone</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">The section includes three components: (1) Pose Estimation Module: this component provides data on the positions of the pedestrian’s skeleton and joints. (2) ResNet Module: this component extracts fine-grained local features, such as clothing textures, colors, and other subtle markers; (3) Transformer Module: this component establishes global dependencies between different local features, making it less susceptible to local occlusions and partial deformations.</p>
</div>
<section id="S3.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Pose Estimation Learning Module</h4>

<div id="S3.SS2.SSS1.p1" class="ltx_para">
<p id="S3.SS2.SSS1.p1.1" class="ltx_p">Evaluating whole-body motion is challenging because of the articulated nature of the skeleton structure <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite>. Pedestrian pose information provides data on the positions of the skeleton and joints, offering fine-grained features for pedestrians with varying poses and partial occlusions, thereby enhancing re-identification performance to handle various complex scenarios and challenges.Therefore, we adopt a pedestrian pose detection network to obtain the positions of the keypoints and the connections between the skeletons.</p>
</div>
<div id="S3.SS2.SSS1.p2" class="ltx_para">
<p id="S3.SS2.SSS1.p2.5" class="ltx_p">Specifically, the input image <math id="S3.SS2.SSS1.p2.1.m1.1" class="ltx_Math" alttext="I\in\mathbb{R}^{W\times H\times 3}" display="inline"><semantics id="S3.SS2.SSS1.p2.1.m1.1a"><mrow id="S3.SS2.SSS1.p2.1.m1.1.1" xref="S3.SS2.SSS1.p2.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p2.1.m1.1.1.2" xref="S3.SS2.SSS1.p2.1.m1.1.1.2.cmml">I</mi><mo id="S3.SS2.SSS1.p2.1.m1.1.1.1" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS1.p2.1.m1.1.1.3" xref="S3.SS2.SSS1.p2.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p2.1.m1.1.1.3.2" xref="S3.SS2.SSS1.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS1.p2.1.m1.1.1.3.3" xref="S3.SS2.SSS1.p2.1.m1.1.1.3.3.cmml"><mi id="S3.SS2.SSS1.p2.1.m1.1.1.3.3.2" xref="S3.SS2.SSS1.p2.1.m1.1.1.3.3.2.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS1.p2.1.m1.1.1.3.3.1" xref="S3.SS2.SSS1.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.SSS1.p2.1.m1.1.1.3.3.3" xref="S3.SS2.SSS1.p2.1.m1.1.1.3.3.3.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS1.p2.1.m1.1.1.3.3.1a" xref="S3.SS2.SSS1.p2.1.m1.1.1.3.3.1.cmml">×</mo><mn id="S3.SS2.SSS1.p2.1.m1.1.1.3.3.4" xref="S3.SS2.SSS1.p2.1.m1.1.1.3.3.4.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.1.m1.1b"><apply id="S3.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1"><in id="S3.SS2.SSS1.p2.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.1"></in><ci id="S3.SS2.SSS1.p2.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.2">𝐼</ci><apply id="S3.SS2.SSS1.p2.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS1.p2.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS1.p2.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.3.3"><times id="S3.SS2.SSS1.p2.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.3.3.1"></times><ci id="S3.SS2.SSS1.p2.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.3.3.2">𝑊</ci><ci id="S3.SS2.SSS1.p2.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.3.3.3">𝐻</ci><cn type="integer" id="S3.SS2.SSS1.p2.1.m1.1.1.3.3.4.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.3.3.4">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.1.m1.1c">I\in\mathbb{R}^{W\times H\times 3}</annotation></semantics></math> is fed into VGG-16 to extract deep feature representations <math id="S3.SS2.SSS1.p2.2.m2.1" class="ltx_Math" alttext="F_{pe}\in\mathbb{R}^{\frac{W}{32}\times\frac{H}{32}\times 512}" display="inline"><semantics id="S3.SS2.SSS1.p2.2.m2.1a"><mrow id="S3.SS2.SSS1.p2.2.m2.1.1" xref="S3.SS2.SSS1.p2.2.m2.1.1.cmml"><msub id="S3.SS2.SSS1.p2.2.m2.1.1.2" xref="S3.SS2.SSS1.p2.2.m2.1.1.2.cmml"><mi id="S3.SS2.SSS1.p2.2.m2.1.1.2.2" xref="S3.SS2.SSS1.p2.2.m2.1.1.2.2.cmml">F</mi><mrow id="S3.SS2.SSS1.p2.2.m2.1.1.2.3" xref="S3.SS2.SSS1.p2.2.m2.1.1.2.3.cmml"><mi id="S3.SS2.SSS1.p2.2.m2.1.1.2.3.2" xref="S3.SS2.SSS1.p2.2.m2.1.1.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.2.m2.1.1.2.3.1" xref="S3.SS2.SSS1.p2.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.SSS1.p2.2.m2.1.1.2.3.3" xref="S3.SS2.SSS1.p2.2.m2.1.1.2.3.3.cmml">e</mi></mrow></msub><mo id="S3.SS2.SSS1.p2.2.m2.1.1.1" xref="S3.SS2.SSS1.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS1.p2.2.m2.1.1.3" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.cmml"><mi id="S3.SS2.SSS1.p2.2.m2.1.1.3.2" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS1.p2.2.m2.1.1.3.3" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.3.cmml"><mfrac id="S3.SS2.SSS1.p2.2.m2.1.1.3.3.2" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.3.2.cmml"><mi id="S3.SS2.SSS1.p2.2.m2.1.1.3.3.2.2" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.3.2.2.cmml">W</mi><mn id="S3.SS2.SSS1.p2.2.m2.1.1.3.3.2.3" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.3.2.3.cmml">32</mn></mfrac><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS1.p2.2.m2.1.1.3.3.1" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.3.1.cmml">×</mo><mfrac id="S3.SS2.SSS1.p2.2.m2.1.1.3.3.3" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS1.p2.2.m2.1.1.3.3.3.2" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.3.3.2.cmml">H</mi><mn id="S3.SS2.SSS1.p2.2.m2.1.1.3.3.3.3" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.3.3.3.cmml">32</mn></mfrac><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS1.p2.2.m2.1.1.3.3.1a" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.3.1.cmml">×</mo><mn id="S3.SS2.SSS1.p2.2.m2.1.1.3.3.4" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.3.4.cmml">512</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.2.m2.1b"><apply id="S3.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1"><in id="S3.SS2.SSS1.p2.2.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.1"></in><apply id="S3.SS2.SSS1.p2.2.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.2.m2.1.1.2.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS1.p2.2.m2.1.1.2.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.2.2">𝐹</ci><apply id="S3.SS2.SSS1.p2.2.m2.1.1.2.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.2.3"><times id="S3.SS2.SSS1.p2.2.m2.1.1.2.3.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.2.3.1"></times><ci id="S3.SS2.SSS1.p2.2.m2.1.1.2.3.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.2.3.2">𝑝</ci><ci id="S3.SS2.SSS1.p2.2.m2.1.1.2.3.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.2.3.3">𝑒</ci></apply></apply><apply id="S3.SS2.SSS1.p2.2.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS1.p2.2.m2.1.1.3.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS1.p2.2.m2.1.1.3.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.3"><times id="S3.SS2.SSS1.p2.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.3.1"></times><apply id="S3.SS2.SSS1.p2.2.m2.1.1.3.3.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.3.2"><divide id="S3.SS2.SSS1.p2.2.m2.1.1.3.3.2.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.3.2"></divide><ci id="S3.SS2.SSS1.p2.2.m2.1.1.3.3.2.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.3.2.2">𝑊</ci><cn type="integer" id="S3.SS2.SSS1.p2.2.m2.1.1.3.3.2.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.3.2.3">32</cn></apply><apply id="S3.SS2.SSS1.p2.2.m2.1.1.3.3.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.3.3"><divide id="S3.SS2.SSS1.p2.2.m2.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.3.3"></divide><ci id="S3.SS2.SSS1.p2.2.m2.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.3.3.2">𝐻</ci><cn type="integer" id="S3.SS2.SSS1.p2.2.m2.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.3.3.3">32</cn></apply><cn type="integer" id="S3.SS2.SSS1.p2.2.m2.1.1.3.3.4.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.3.4">512</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.2.m2.1c">F_{pe}\in\mathbb{R}^{\frac{W}{32}\times\frac{H}{32}\times 512}</annotation></semantics></math>, followed by simultaneous prediction of confidence maps and affinity fields,,it can be mathematically denoted by the following equation. In which, the <math id="S3.SS2.SSS1.p2.3.m3.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.SS2.SSS1.p2.3.m3.1a"><mi id="S3.SS2.SSS1.p2.3.m3.1.1" xref="S3.SS2.SSS1.p2.3.m3.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.3.m3.1b"><ci id="S3.SS2.SSS1.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.3.m3.1c">W</annotation></semantics></math>, <math id="S3.SS2.SSS1.p2.4.m4.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S3.SS2.SSS1.p2.4.m4.1a"><mi id="S3.SS2.SSS1.p2.4.m4.1.1" xref="S3.SS2.SSS1.p2.4.m4.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.4.m4.1b"><ci id="S3.SS2.SSS1.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.4.m4.1c">H</annotation></semantics></math>, and <math id="S3.SS2.SSS1.p2.5.m5.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S3.SS2.SSS1.p2.5.m5.1a"><mn id="S3.SS2.SSS1.p2.5.m5.1.1" xref="S3.SS2.SSS1.p2.5.m5.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.5.m5.1b"><cn type="integer" id="S3.SS2.SSS1.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.5.m5.1c">3</annotation></semantics></math> represent the width, height, and channels of the input image.</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E1.m1.2" class="ltx_Math" alttext="F_{pe}=VGG16(I)." display="block"><semantics id="S3.E1.m1.2a"><mrow id="S3.E1.m1.2.2.1" xref="S3.E1.m1.2.2.1.1.cmml"><mrow id="S3.E1.m1.2.2.1.1" xref="S3.E1.m1.2.2.1.1.cmml"><msub id="S3.E1.m1.2.2.1.1.2" xref="S3.E1.m1.2.2.1.1.2.cmml"><mi id="S3.E1.m1.2.2.1.1.2.2" xref="S3.E1.m1.2.2.1.1.2.2.cmml">F</mi><mrow id="S3.E1.m1.2.2.1.1.2.3" xref="S3.E1.m1.2.2.1.1.2.3.cmml"><mi id="S3.E1.m1.2.2.1.1.2.3.2" xref="S3.E1.m1.2.2.1.1.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.2.3.1" xref="S3.E1.m1.2.2.1.1.2.3.1.cmml">​</mo><mi id="S3.E1.m1.2.2.1.1.2.3.3" xref="S3.E1.m1.2.2.1.1.2.3.3.cmml">e</mi></mrow></msub><mo id="S3.E1.m1.2.2.1.1.1" xref="S3.E1.m1.2.2.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.2.2.1.1.3" xref="S3.E1.m1.2.2.1.1.3.cmml"><mi id="S3.E1.m1.2.2.1.1.3.2" xref="S3.E1.m1.2.2.1.1.3.2.cmml">V</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.3.1" xref="S3.E1.m1.2.2.1.1.3.1.cmml">​</mo><mi id="S3.E1.m1.2.2.1.1.3.3" xref="S3.E1.m1.2.2.1.1.3.3.cmml">G</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.3.1a" xref="S3.E1.m1.2.2.1.1.3.1.cmml">​</mo><mi id="S3.E1.m1.2.2.1.1.3.4" xref="S3.E1.m1.2.2.1.1.3.4.cmml">G</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.3.1b" xref="S3.E1.m1.2.2.1.1.3.1.cmml">​</mo><mn id="S3.E1.m1.2.2.1.1.3.5" xref="S3.E1.m1.2.2.1.1.3.5.cmml">16</mn><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.3.1c" xref="S3.E1.m1.2.2.1.1.3.1.cmml">​</mo><mrow id="S3.E1.m1.2.2.1.1.3.6.2" xref="S3.E1.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.1.1.3.6.2.1" xref="S3.E1.m1.2.2.1.1.3.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">I</mi><mo stretchy="false" id="S3.E1.m1.2.2.1.1.3.6.2.2" xref="S3.E1.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E1.m1.2.2.1.2" xref="S3.E1.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.2b"><apply id="S3.E1.m1.2.2.1.1.cmml" xref="S3.E1.m1.2.2.1"><eq id="S3.E1.m1.2.2.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1"></eq><apply id="S3.E1.m1.2.2.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.2.1.cmml" xref="S3.E1.m1.2.2.1.1.2">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2">𝐹</ci><apply id="S3.E1.m1.2.2.1.1.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.3"><times id="S3.E1.m1.2.2.1.1.2.3.1.cmml" xref="S3.E1.m1.2.2.1.1.2.3.1"></times><ci id="S3.E1.m1.2.2.1.1.2.3.2.cmml" xref="S3.E1.m1.2.2.1.1.2.3.2">𝑝</ci><ci id="S3.E1.m1.2.2.1.1.2.3.3.cmml" xref="S3.E1.m1.2.2.1.1.2.3.3">𝑒</ci></apply></apply><apply id="S3.E1.m1.2.2.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.3"><times id="S3.E1.m1.2.2.1.1.3.1.cmml" xref="S3.E1.m1.2.2.1.1.3.1"></times><ci id="S3.E1.m1.2.2.1.1.3.2.cmml" xref="S3.E1.m1.2.2.1.1.3.2">𝑉</ci><ci id="S3.E1.m1.2.2.1.1.3.3.cmml" xref="S3.E1.m1.2.2.1.1.3.3">𝐺</ci><ci id="S3.E1.m1.2.2.1.1.3.4.cmml" xref="S3.E1.m1.2.2.1.1.3.4">𝐺</ci><cn type="integer" id="S3.E1.m1.2.2.1.1.3.5.cmml" xref="S3.E1.m1.2.2.1.1.3.5">16</cn><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝐼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.2c">F_{pe}=VGG16(I).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS1.p2.8" class="ltx_p">In the pose estimation section of Fig. <a href="#S3.F1" title="Figure 1 ‣ 3.1 Overview ‣ 3 Proposed method ‣ Tran-GCN: A Transformer-Enhanced Graph Convolutional Network for Person Re-Identification in Monitoring Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, <math id="S3.SS2.SSS1.p2.6.m1.1" class="ltx_Math" alttext="L\in\mathbb{R}^{\frac{W}{32}\times\frac{H}{32}\times K}" display="inline"><semantics id="S3.SS2.SSS1.p2.6.m1.1a"><mrow id="S3.SS2.SSS1.p2.6.m1.1.1" xref="S3.SS2.SSS1.p2.6.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p2.6.m1.1.1.2" xref="S3.SS2.SSS1.p2.6.m1.1.1.2.cmml">L</mi><mo id="S3.SS2.SSS1.p2.6.m1.1.1.1" xref="S3.SS2.SSS1.p2.6.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS1.p2.6.m1.1.1.3" xref="S3.SS2.SSS1.p2.6.m1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p2.6.m1.1.1.3.2" xref="S3.SS2.SSS1.p2.6.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS1.p2.6.m1.1.1.3.3" xref="S3.SS2.SSS1.p2.6.m1.1.1.3.3.cmml"><mfrac id="S3.SS2.SSS1.p2.6.m1.1.1.3.3.2" xref="S3.SS2.SSS1.p2.6.m1.1.1.3.3.2.cmml"><mi id="S3.SS2.SSS1.p2.6.m1.1.1.3.3.2.2" xref="S3.SS2.SSS1.p2.6.m1.1.1.3.3.2.2.cmml">W</mi><mn id="S3.SS2.SSS1.p2.6.m1.1.1.3.3.2.3" xref="S3.SS2.SSS1.p2.6.m1.1.1.3.3.2.3.cmml">32</mn></mfrac><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS1.p2.6.m1.1.1.3.3.1" xref="S3.SS2.SSS1.p2.6.m1.1.1.3.3.1.cmml">×</mo><mfrac id="S3.SS2.SSS1.p2.6.m1.1.1.3.3.3" xref="S3.SS2.SSS1.p2.6.m1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS1.p2.6.m1.1.1.3.3.3.2" xref="S3.SS2.SSS1.p2.6.m1.1.1.3.3.3.2.cmml">H</mi><mn id="S3.SS2.SSS1.p2.6.m1.1.1.3.3.3.3" xref="S3.SS2.SSS1.p2.6.m1.1.1.3.3.3.3.cmml">32</mn></mfrac><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS1.p2.6.m1.1.1.3.3.1a" xref="S3.SS2.SSS1.p2.6.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.SSS1.p2.6.m1.1.1.3.3.4" xref="S3.SS2.SSS1.p2.6.m1.1.1.3.3.4.cmml">K</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.6.m1.1b"><apply id="S3.SS2.SSS1.p2.6.m1.1.1.cmml" xref="S3.SS2.SSS1.p2.6.m1.1.1"><in id="S3.SS2.SSS1.p2.6.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.6.m1.1.1.1"></in><ci id="S3.SS2.SSS1.p2.6.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.6.m1.1.1.2">𝐿</ci><apply id="S3.SS2.SSS1.p2.6.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.6.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.6.m1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p2.6.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS1.p2.6.m1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p2.6.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS1.p2.6.m1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p2.6.m1.1.1.3.3"><times id="S3.SS2.SSS1.p2.6.m1.1.1.3.3.1.cmml" xref="S3.SS2.SSS1.p2.6.m1.1.1.3.3.1"></times><apply id="S3.SS2.SSS1.p2.6.m1.1.1.3.3.2.cmml" xref="S3.SS2.SSS1.p2.6.m1.1.1.3.3.2"><divide id="S3.SS2.SSS1.p2.6.m1.1.1.3.3.2.1.cmml" xref="S3.SS2.SSS1.p2.6.m1.1.1.3.3.2"></divide><ci id="S3.SS2.SSS1.p2.6.m1.1.1.3.3.2.2.cmml" xref="S3.SS2.SSS1.p2.6.m1.1.1.3.3.2.2">𝑊</ci><cn type="integer" id="S3.SS2.SSS1.p2.6.m1.1.1.3.3.2.3.cmml" xref="S3.SS2.SSS1.p2.6.m1.1.1.3.3.2.3">32</cn></apply><apply id="S3.SS2.SSS1.p2.6.m1.1.1.3.3.3.cmml" xref="S3.SS2.SSS1.p2.6.m1.1.1.3.3.3"><divide id="S3.SS2.SSS1.p2.6.m1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS1.p2.6.m1.1.1.3.3.3"></divide><ci id="S3.SS2.SSS1.p2.6.m1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS1.p2.6.m1.1.1.3.3.3.2">𝐻</ci><cn type="integer" id="S3.SS2.SSS1.p2.6.m1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS1.p2.6.m1.1.1.3.3.3.3">32</cn></apply><ci id="S3.SS2.SSS1.p2.6.m1.1.1.3.3.4.cmml" xref="S3.SS2.SSS1.p2.6.m1.1.1.3.3.4">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.6.m1.1c">L\in\mathbb{R}^{\frac{W}{32}\times\frac{H}{32}\times K}</annotation></semantics></math> and <math id="S3.SS2.SSS1.p2.7.m2.1" class="ltx_Math" alttext="S\in\mathbb{R}^{\frac{W}{32}\times\frac{H}{32}\times K}" display="inline"><semantics id="S3.SS2.SSS1.p2.7.m2.1a"><mrow id="S3.SS2.SSS1.p2.7.m2.1.1" xref="S3.SS2.SSS1.p2.7.m2.1.1.cmml"><mi id="S3.SS2.SSS1.p2.7.m2.1.1.2" xref="S3.SS2.SSS1.p2.7.m2.1.1.2.cmml">S</mi><mo id="S3.SS2.SSS1.p2.7.m2.1.1.1" xref="S3.SS2.SSS1.p2.7.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS1.p2.7.m2.1.1.3" xref="S3.SS2.SSS1.p2.7.m2.1.1.3.cmml"><mi id="S3.SS2.SSS1.p2.7.m2.1.1.3.2" xref="S3.SS2.SSS1.p2.7.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS1.p2.7.m2.1.1.3.3" xref="S3.SS2.SSS1.p2.7.m2.1.1.3.3.cmml"><mfrac id="S3.SS2.SSS1.p2.7.m2.1.1.3.3.2" xref="S3.SS2.SSS1.p2.7.m2.1.1.3.3.2.cmml"><mi id="S3.SS2.SSS1.p2.7.m2.1.1.3.3.2.2" xref="S3.SS2.SSS1.p2.7.m2.1.1.3.3.2.2.cmml">W</mi><mn id="S3.SS2.SSS1.p2.7.m2.1.1.3.3.2.3" xref="S3.SS2.SSS1.p2.7.m2.1.1.3.3.2.3.cmml">32</mn></mfrac><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS1.p2.7.m2.1.1.3.3.1" xref="S3.SS2.SSS1.p2.7.m2.1.1.3.3.1.cmml">×</mo><mfrac id="S3.SS2.SSS1.p2.7.m2.1.1.3.3.3" xref="S3.SS2.SSS1.p2.7.m2.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS1.p2.7.m2.1.1.3.3.3.2" xref="S3.SS2.SSS1.p2.7.m2.1.1.3.3.3.2.cmml">H</mi><mn id="S3.SS2.SSS1.p2.7.m2.1.1.3.3.3.3" xref="S3.SS2.SSS1.p2.7.m2.1.1.3.3.3.3.cmml">32</mn></mfrac><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS1.p2.7.m2.1.1.3.3.1a" xref="S3.SS2.SSS1.p2.7.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.SSS1.p2.7.m2.1.1.3.3.4" xref="S3.SS2.SSS1.p2.7.m2.1.1.3.3.4.cmml">K</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.7.m2.1b"><apply id="S3.SS2.SSS1.p2.7.m2.1.1.cmml" xref="S3.SS2.SSS1.p2.7.m2.1.1"><in id="S3.SS2.SSS1.p2.7.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p2.7.m2.1.1.1"></in><ci id="S3.SS2.SSS1.p2.7.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p2.7.m2.1.1.2">𝑆</ci><apply id="S3.SS2.SSS1.p2.7.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p2.7.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.7.m2.1.1.3.1.cmml" xref="S3.SS2.SSS1.p2.7.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS1.p2.7.m2.1.1.3.2.cmml" xref="S3.SS2.SSS1.p2.7.m2.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS1.p2.7.m2.1.1.3.3.cmml" xref="S3.SS2.SSS1.p2.7.m2.1.1.3.3"><times id="S3.SS2.SSS1.p2.7.m2.1.1.3.3.1.cmml" xref="S3.SS2.SSS1.p2.7.m2.1.1.3.3.1"></times><apply id="S3.SS2.SSS1.p2.7.m2.1.1.3.3.2.cmml" xref="S3.SS2.SSS1.p2.7.m2.1.1.3.3.2"><divide id="S3.SS2.SSS1.p2.7.m2.1.1.3.3.2.1.cmml" xref="S3.SS2.SSS1.p2.7.m2.1.1.3.3.2"></divide><ci id="S3.SS2.SSS1.p2.7.m2.1.1.3.3.2.2.cmml" xref="S3.SS2.SSS1.p2.7.m2.1.1.3.3.2.2">𝑊</ci><cn type="integer" id="S3.SS2.SSS1.p2.7.m2.1.1.3.3.2.3.cmml" xref="S3.SS2.SSS1.p2.7.m2.1.1.3.3.2.3">32</cn></apply><apply id="S3.SS2.SSS1.p2.7.m2.1.1.3.3.3.cmml" xref="S3.SS2.SSS1.p2.7.m2.1.1.3.3.3"><divide id="S3.SS2.SSS1.p2.7.m2.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS1.p2.7.m2.1.1.3.3.3"></divide><ci id="S3.SS2.SSS1.p2.7.m2.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS1.p2.7.m2.1.1.3.3.3.2">𝐻</ci><cn type="integer" id="S3.SS2.SSS1.p2.7.m2.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS1.p2.7.m2.1.1.3.3.3.3">32</cn></apply><ci id="S3.SS2.SSS1.p2.7.m2.1.1.3.3.4.cmml" xref="S3.SS2.SSS1.p2.7.m2.1.1.3.3.4">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.7.m2.1c">S\in\mathbb{R}^{\frac{W}{32}\times\frac{H}{32}\times K}</annotation></semantics></math> represent the affinity fields and confidence maps, respectively. The <math id="S3.SS2.SSS1.p2.8.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.SSS1.p2.8.m3.1a"><mi id="S3.SS2.SSS1.p2.8.m3.1.1" xref="S3.SS2.SSS1.p2.8.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.8.m3.1b"><ci id="S3.SS2.SSS1.p2.8.m3.1.1.cmml" xref="S3.SS2.SSS1.p2.8.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.8.m3.1c">K</annotation></semantics></math> represents the key point in the feature map.
Since confidence maps provide information about the likelihood of keypoints at each location, helping to identify the most probable positions of keypoints, and affinity fields capture the relationships between different keypoints, indicating the degree of association between pairs of keypoints (e.g., those connecting bones) and aiding in determining the connections between keypoints to construct the skeleton structure. Therefore, we incorporate information from affinity fields when predicting confidence maps, and vice versa.</p>
</div>
<div id="S3.SS2.SSS1.p3" class="ltx_para">
<table id="S3.E2" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E2X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E2X.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle S=\rho\left(F_{pe},L\right)," display="inline"><semantics id="S3.E2X.2.1.1.m1.2a"><mrow id="S3.E2X.2.1.1.m1.2.2.1" xref="S3.E2X.2.1.1.m1.2.2.1.1.cmml"><mrow id="S3.E2X.2.1.1.m1.2.2.1.1" xref="S3.E2X.2.1.1.m1.2.2.1.1.cmml"><mi id="S3.E2X.2.1.1.m1.2.2.1.1.3" xref="S3.E2X.2.1.1.m1.2.2.1.1.3.cmml">S</mi><mo id="S3.E2X.2.1.1.m1.2.2.1.1.2" xref="S3.E2X.2.1.1.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E2X.2.1.1.m1.2.2.1.1.1" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.cmml"><mi id="S3.E2X.2.1.1.m1.2.2.1.1.1.3" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.3.cmml">ρ</mi><mo lspace="0em" rspace="0em" id="S3.E2X.2.1.1.m1.2.2.1.1.1.2" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.2" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.1.2.cmml">(</mo><msub id="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.1" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.1.2" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml">F</mi><mrow id="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.1.3" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.1.3.1" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.1.3.3.cmml">e</mi></mrow></msub><mo id="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.3" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.1.2.cmml">,</mo><mi id="S3.E2X.2.1.1.m1.1.1" xref="S3.E2X.2.1.1.m1.1.1.cmml">L</mi><mo id="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.4" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2X.2.1.1.m1.2.2.1.2" xref="S3.E2X.2.1.1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2X.2.1.1.m1.2b"><apply id="S3.E2X.2.1.1.m1.2.2.1.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.1"><eq id="S3.E2X.2.1.1.m1.2.2.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.1.2"></eq><ci id="S3.E2X.2.1.1.m1.2.2.1.1.3.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.1.3">𝑆</ci><apply id="S3.E2X.2.1.1.m1.2.2.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.1.1"><times id="S3.E2X.2.1.1.m1.2.2.1.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.2"></times><ci id="S3.E2X.2.1.1.m1.2.2.1.1.1.3.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.3">𝜌</ci><interval closure="open" id="S3.E2X.2.1.1.m1.2.2.1.1.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1"><apply id="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.1.2">𝐹</ci><apply id="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.1.3"><times id="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.1.3.1"></times><ci id="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.1.3.2">𝑝</ci><ci id="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.1.1.1.1.1.3.3">𝑒</ci></apply></apply><ci id="S3.E2X.2.1.1.m1.1.1.cmml" xref="S3.E2X.2.1.1.m1.1.1">𝐿</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2X.2.1.1.m1.2c">\displaystyle S=\rho\left(F_{pe},L\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(2)</span></td>
</tr>
<tr id="S3.E2Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E2Xa.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle L=\phi\left(F_{pe},S\right)," display="inline"><semantics id="S3.E2Xa.2.1.1.m1.2a"><mrow id="S3.E2Xa.2.1.1.m1.2.2.1" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.cmml"><mrow id="S3.E2Xa.2.1.1.m1.2.2.1.1" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.cmml"><mi id="S3.E2Xa.2.1.1.m1.2.2.1.1.3" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.3.cmml">L</mi><mo id="S3.E2Xa.2.1.1.m1.2.2.1.1.2" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E2Xa.2.1.1.m1.2.2.1.1.1" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.cmml"><mi id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.3" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.2" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.2" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.cmml">(</mo><msub id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.2" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml">F</mi><mrow id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.1" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.3.cmml">e</mi></mrow></msub><mo id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.3" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.cmml">,</mo><mi id="S3.E2Xa.2.1.1.m1.1.1" xref="S3.E2Xa.2.1.1.m1.1.1.cmml">S</mi><mo id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.4" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2Xa.2.1.1.m1.2.2.1.2" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2Xa.2.1.1.m1.2b"><apply id="S3.E2Xa.2.1.1.m1.2.2.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1"><eq id="S3.E2Xa.2.1.1.m1.2.2.1.1.2.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.2"></eq><ci id="S3.E2Xa.2.1.1.m1.2.2.1.1.3.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.3">𝐿</ci><apply id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1"><times id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.2.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.2"></times><ci id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.3.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.3">italic-ϕ</ci><interval closure="open" id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1"><apply id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.2">𝐹</ci><apply id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3"><times id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.1"></times><ci id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.2">𝑝</ci><ci id="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.3.3">𝑒</ci></apply></apply><ci id="S3.E2Xa.2.1.1.m1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.1.1">𝑆</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2Xa.2.1.1.m1.2c">\displaystyle L=\phi\left(F_{pe},S\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr>
</tbody>
</table>
</div>
<div id="S3.SS2.SSS1.p4" class="ltx_para ltx_noindent">
<p id="S3.SS2.SSS1.p4.7" class="ltx_p">where <math id="S3.SS2.SSS1.p4.1.m1.1" class="ltx_Math" alttext="\rho" display="inline"><semantics id="S3.SS2.SSS1.p4.1.m1.1a"><mi id="S3.SS2.SSS1.p4.1.m1.1.1" xref="S3.SS2.SSS1.p4.1.m1.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.1.m1.1b"><ci id="S3.SS2.SSS1.p4.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.1.m1.1c">\rho</annotation></semantics></math>(,) and <math id="S3.SS2.SSS1.p4.2.m2.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S3.SS2.SSS1.p4.2.m2.1a"><mi id="S3.SS2.SSS1.p4.2.m2.1.1" xref="S3.SS2.SSS1.p4.2.m2.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.2.m2.1b"><ci id="S3.SS2.SSS1.p4.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p4.2.m2.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.2.m2.1c">\phi</annotation></semantics></math>(,) are the fully connections layer having import <math id="S3.SS2.SSS1.p4.3.m3.1" class="ltx_Math" alttext="F_{pe}" display="inline"><semantics id="S3.SS2.SSS1.p4.3.m3.1a"><msub id="S3.SS2.SSS1.p4.3.m3.1.1" xref="S3.SS2.SSS1.p4.3.m3.1.1.cmml"><mi id="S3.SS2.SSS1.p4.3.m3.1.1.2" xref="S3.SS2.SSS1.p4.3.m3.1.1.2.cmml">F</mi><mrow id="S3.SS2.SSS1.p4.3.m3.1.1.3" xref="S3.SS2.SSS1.p4.3.m3.1.1.3.cmml"><mi id="S3.SS2.SSS1.p4.3.m3.1.1.3.2" xref="S3.SS2.SSS1.p4.3.m3.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p4.3.m3.1.1.3.1" xref="S3.SS2.SSS1.p4.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS1.p4.3.m3.1.1.3.3" xref="S3.SS2.SSS1.p4.3.m3.1.1.3.3.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.3.m3.1b"><apply id="S3.SS2.SSS1.p4.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.3.m3.1.1.1.cmml" xref="S3.SS2.SSS1.p4.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p4.3.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p4.3.m3.1.1.2">𝐹</ci><apply id="S3.SS2.SSS1.p4.3.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p4.3.m3.1.1.3"><times id="S3.SS2.SSS1.p4.3.m3.1.1.3.1.cmml" xref="S3.SS2.SSS1.p4.3.m3.1.1.3.1"></times><ci id="S3.SS2.SSS1.p4.3.m3.1.1.3.2.cmml" xref="S3.SS2.SSS1.p4.3.m3.1.1.3.2">𝑝</ci><ci id="S3.SS2.SSS1.p4.3.m3.1.1.3.3.cmml" xref="S3.SS2.SSS1.p4.3.m3.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.3.m3.1c">F_{pe}</annotation></semantics></math>,<math id="S3.SS2.SSS1.p4.4.m4.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS2.SSS1.p4.4.m4.1a"><mi id="S3.SS2.SSS1.p4.4.m4.1.1" xref="S3.SS2.SSS1.p4.4.m4.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.4.m4.1b"><ci id="S3.SS2.SSS1.p4.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p4.4.m4.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.4.m4.1c">L</annotation></semantics></math> and <math id="S3.SS2.SSS1.p4.5.m5.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS2.SSS1.p4.5.m5.1a"><mi id="S3.SS2.SSS1.p4.5.m5.1.1" xref="S3.SS2.SSS1.p4.5.m5.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.5.m5.1b"><ci id="S3.SS2.SSS1.p4.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p4.5.m5.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.5.m5.1c">S</annotation></semantics></math> respectively. Compared with the original OpenPose <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite>, the backbone of generating <math id="S3.SS2.SSS1.p4.6.m6.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS2.SSS1.p4.6.m6.1a"><mi id="S3.SS2.SSS1.p4.6.m6.1.1" xref="S3.SS2.SSS1.p4.6.m6.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.6.m6.1b"><ci id="S3.SS2.SSS1.p4.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p4.6.m6.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.6.m6.1c">L</annotation></semantics></math> and <math id="S3.SS2.SSS1.p4.7.m7.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS2.SSS1.p4.7.m7.1a"><mi id="S3.SS2.SSS1.p4.7.m7.1.1" xref="S3.SS2.SSS1.p4.7.m7.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.7.m7.1b"><ci id="S3.SS2.SSS1.p4.7.m7.1.1.cmml" xref="S3.SS2.SSS1.p4.7.m7.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.7.m7.1c">S</annotation></semantics></math> shares weights to reduce the parameter count by half. Additionally, we have removed the multi-stage iterative steps from OpenPose to improve computational efficiency and speed. For complex pose variations and occlusion scenarios, these can be addressed subsequently through the GCM.</p>
</div>
<div id="S3.SS2.SSS1.p5" class="ltx_para">
<p id="S3.SS2.SSS1.p5.4" class="ltx_p">To obtain rich pose information of pedestrians, we pre-trained OpenPose on the COCO dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite>, which extracts <math id="S3.SS2.SSS1.p5.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.SSS1.p5.1.m1.1a"><mi id="S3.SS2.SSS1.p5.1.m1.1.1" xref="S3.SS2.SSS1.p5.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p5.1.m1.1b"><ci id="S3.SS2.SSS1.p5.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p5.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p5.1.m1.1c">K</annotation></semantics></math>=18 keypoint heatmaps and <math id="S3.SS2.SSS1.p5.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS2.SSS1.p5.2.m2.1a"><mi id="S3.SS2.SSS1.p5.2.m2.1.1" xref="S3.SS2.SSS1.p5.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p5.2.m2.1b"><ci id="S3.SS2.SSS1.p5.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p5.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p5.2.m2.1c">N</annotation></semantics></math>=19 part affinity fields from the input pedestrian images. Each generated keypoint heatmap <math id="S3.SS2.SSS1.p5.3.m3.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS2.SSS1.p5.3.m3.1a"><mi id="S3.SS2.SSS1.p5.3.m3.1.1" xref="S3.SS2.SSS1.p5.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p5.3.m3.1b"><ci id="S3.SS2.SSS1.p5.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p5.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p5.3.m3.1c">S</annotation></semantics></math> and confidence score <math id="S3.SS2.SSS1.p5.4.m4.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS2.SSS1.p5.4.m4.1a"><mi id="S3.SS2.SSS1.p5.4.m4.1.1" xref="S3.SS2.SSS1.p5.4.m4.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p5.4.m4.1b"><ci id="S3.SS2.SSS1.p5.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p5.4.m4.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p5.4.m4.1c">L</annotation></semantics></math> contain information about the pedestrian’s joints.</p>
</div>
</section>
<section id="S3.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>ResNet Learning branch</h4>

<div id="S3.SS2.SSS2.p1" class="ltx_para">
<p id="S3.SS2.SSS2.p1.1" class="ltx_p">Due to the fact that each convolutional kernel (filter) in a Convolution Neural Netowrk (CNN) operates only within a local region and progressively moves across the entire image through a sliding window approach, CNN possesses the ability to capture local features such as edges, corners, and textures. In the task of Person Re-Identification, local features are crucial for identifying and distinguishing different individuals. Especially in complex backgrounds, the focus on local features enhances the model’s robustness. Therefore, we employ a ResNet-50 pre-trained on ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite> as the backbone network.</p>
</div>
<div id="S3.SS2.SSS2.p2" class="ltx_para">
<p id="S3.SS2.SSS2.p2.2" class="ltx_p">To adapt the network for pedestrian feature extraction, the final average pooling layer and fully connected layer of the original ResNet-50 are removed. The stride of the convolutional layer in the first residual block of Stage 4 in the ResNet-50 structure is set to 1, modifying the network architecture to better suit the specific task of pedestrian feature extraction.</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E3.m1.2" class="ltx_Math" alttext="F_{Res}=ResNet50(I)," display="block"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.2.1" xref="S3.E3.m1.2.2.1.1.cmml"><mrow id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml"><msub id="S3.E3.m1.2.2.1.1.2" xref="S3.E3.m1.2.2.1.1.2.cmml"><mi id="S3.E3.m1.2.2.1.1.2.2" xref="S3.E3.m1.2.2.1.1.2.2.cmml">F</mi><mrow id="S3.E3.m1.2.2.1.1.2.3" xref="S3.E3.m1.2.2.1.1.2.3.cmml"><mi id="S3.E3.m1.2.2.1.1.2.3.2" xref="S3.E3.m1.2.2.1.1.2.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.2.3.1" xref="S3.E3.m1.2.2.1.1.2.3.1.cmml">​</mo><mi id="S3.E3.m1.2.2.1.1.2.3.3" xref="S3.E3.m1.2.2.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.2.3.1a" xref="S3.E3.m1.2.2.1.1.2.3.1.cmml">​</mo><mi id="S3.E3.m1.2.2.1.1.2.3.4" xref="S3.E3.m1.2.2.1.1.2.3.4.cmml">s</mi></mrow></msub><mo id="S3.E3.m1.2.2.1.1.1" xref="S3.E3.m1.2.2.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.2.2.1.1.3" xref="S3.E3.m1.2.2.1.1.3.cmml"><mi id="S3.E3.m1.2.2.1.1.3.2" xref="S3.E3.m1.2.2.1.1.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.3.1" xref="S3.E3.m1.2.2.1.1.3.1.cmml">​</mo><mi id="S3.E3.m1.2.2.1.1.3.3" xref="S3.E3.m1.2.2.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.3.1a" xref="S3.E3.m1.2.2.1.1.3.1.cmml">​</mo><mi id="S3.E3.m1.2.2.1.1.3.4" xref="S3.E3.m1.2.2.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.3.1b" xref="S3.E3.m1.2.2.1.1.3.1.cmml">​</mo><mi id="S3.E3.m1.2.2.1.1.3.5" xref="S3.E3.m1.2.2.1.1.3.5.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.3.1c" xref="S3.E3.m1.2.2.1.1.3.1.cmml">​</mo><mi id="S3.E3.m1.2.2.1.1.3.6" xref="S3.E3.m1.2.2.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.3.1d" xref="S3.E3.m1.2.2.1.1.3.1.cmml">​</mo><mi id="S3.E3.m1.2.2.1.1.3.7" xref="S3.E3.m1.2.2.1.1.3.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.3.1e" xref="S3.E3.m1.2.2.1.1.3.1.cmml">​</mo><mn id="S3.E3.m1.2.2.1.1.3.8" xref="S3.E3.m1.2.2.1.1.3.8.cmml">50</mn><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.3.1f" xref="S3.E3.m1.2.2.1.1.3.1.cmml">​</mo><mrow id="S3.E3.m1.2.2.1.1.3.9.2" xref="S3.E3.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.1.1.3.9.2.1" xref="S3.E3.m1.2.2.1.1.3.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">I</mi><mo stretchy="false" id="S3.E3.m1.2.2.1.1.3.9.2.2" xref="S3.E3.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.2.2.1.2" xref="S3.E3.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1"><eq id="S3.E3.m1.2.2.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1"></eq><apply id="S3.E3.m1.2.2.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.2">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2">𝐹</ci><apply id="S3.E3.m1.2.2.1.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.2.3"><times id="S3.E3.m1.2.2.1.1.2.3.1.cmml" xref="S3.E3.m1.2.2.1.1.2.3.1"></times><ci id="S3.E3.m1.2.2.1.1.2.3.2.cmml" xref="S3.E3.m1.2.2.1.1.2.3.2">𝑅</ci><ci id="S3.E3.m1.2.2.1.1.2.3.3.cmml" xref="S3.E3.m1.2.2.1.1.2.3.3">𝑒</ci><ci id="S3.E3.m1.2.2.1.1.2.3.4.cmml" xref="S3.E3.m1.2.2.1.1.2.3.4">𝑠</ci></apply></apply><apply id="S3.E3.m1.2.2.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.3"><times id="S3.E3.m1.2.2.1.1.3.1.cmml" xref="S3.E3.m1.2.2.1.1.3.1"></times><ci id="S3.E3.m1.2.2.1.1.3.2.cmml" xref="S3.E3.m1.2.2.1.1.3.2">𝑅</ci><ci id="S3.E3.m1.2.2.1.1.3.3.cmml" xref="S3.E3.m1.2.2.1.1.3.3">𝑒</ci><ci id="S3.E3.m1.2.2.1.1.3.4.cmml" xref="S3.E3.m1.2.2.1.1.3.4">𝑠</ci><ci id="S3.E3.m1.2.2.1.1.3.5.cmml" xref="S3.E3.m1.2.2.1.1.3.5">𝑁</ci><ci id="S3.E3.m1.2.2.1.1.3.6.cmml" xref="S3.E3.m1.2.2.1.1.3.6">𝑒</ci><ci id="S3.E3.m1.2.2.1.1.3.7.cmml" xref="S3.E3.m1.2.2.1.1.3.7">𝑡</ci><cn type="integer" id="S3.E3.m1.2.2.1.1.3.8.cmml" xref="S3.E3.m1.2.2.1.1.3.8">50</cn><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝐼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">F_{Res}=ResNet50(I),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS2.p2.1" class="ltx_p">where <math id="S3.SS2.SSS2.p2.1.m1.1" class="ltx_Math" alttext="F_{Res}\in\mathbb{R}^{\frac{W}{32}\times\frac{H}{32}\times 512}" display="inline"><semantics id="S3.SS2.SSS2.p2.1.m1.1a"><mrow id="S3.SS2.SSS2.p2.1.m1.1.1" xref="S3.SS2.SSS2.p2.1.m1.1.1.cmml"><msub id="S3.SS2.SSS2.p2.1.m1.1.1.2" xref="S3.SS2.SSS2.p2.1.m1.1.1.2.cmml"><mi id="S3.SS2.SSS2.p2.1.m1.1.1.2.2" xref="S3.SS2.SSS2.p2.1.m1.1.1.2.2.cmml">F</mi><mrow id="S3.SS2.SSS2.p2.1.m1.1.1.2.3" xref="S3.SS2.SSS2.p2.1.m1.1.1.2.3.cmml"><mi id="S3.SS2.SSS2.p2.1.m1.1.1.2.3.2" xref="S3.SS2.SSS2.p2.1.m1.1.1.2.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p2.1.m1.1.1.2.3.1" xref="S3.SS2.SSS2.p2.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.SSS2.p2.1.m1.1.1.2.3.3" xref="S3.SS2.SSS2.p2.1.m1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p2.1.m1.1.1.2.3.1a" xref="S3.SS2.SSS2.p2.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.SSS2.p2.1.m1.1.1.2.3.4" xref="S3.SS2.SSS2.p2.1.m1.1.1.2.3.4.cmml">s</mi></mrow></msub><mo id="S3.SS2.SSS2.p2.1.m1.1.1.1" xref="S3.SS2.SSS2.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS2.p2.1.m1.1.1.3" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS2.p2.1.m1.1.1.3.2" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS2.p2.1.m1.1.1.3.3" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.3.cmml"><mfrac id="S3.SS2.SSS2.p2.1.m1.1.1.3.3.2" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.3.2.cmml"><mi id="S3.SS2.SSS2.p2.1.m1.1.1.3.3.2.2" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.3.2.2.cmml">W</mi><mn id="S3.SS2.SSS2.p2.1.m1.1.1.3.3.2.3" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.3.2.3.cmml">32</mn></mfrac><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS2.p2.1.m1.1.1.3.3.1" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.3.1.cmml">×</mo><mfrac id="S3.SS2.SSS2.p2.1.m1.1.1.3.3.3" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS2.p2.1.m1.1.1.3.3.3.2" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.3.3.2.cmml">H</mi><mn id="S3.SS2.SSS2.p2.1.m1.1.1.3.3.3.3" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.3.3.3.cmml">32</mn></mfrac><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS2.p2.1.m1.1.1.3.3.1a" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.3.1.cmml">×</mo><mn id="S3.SS2.SSS2.p2.1.m1.1.1.3.3.4" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.3.4.cmml">512</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.1.m1.1b"><apply id="S3.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1"><in id="S3.SS2.SSS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.1"></in><apply id="S3.SS2.SSS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.1.m1.1.1.2.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS2.p2.1.m1.1.1.2.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.2.2">𝐹</ci><apply id="S3.SS2.SSS2.p2.1.m1.1.1.2.3.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.2.3"><times id="S3.SS2.SSS2.p2.1.m1.1.1.2.3.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.2.3.1"></times><ci id="S3.SS2.SSS2.p2.1.m1.1.1.2.3.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.2.3.2">𝑅</ci><ci id="S3.SS2.SSS2.p2.1.m1.1.1.2.3.3.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.2.3.3">𝑒</ci><ci id="S3.SS2.SSS2.p2.1.m1.1.1.2.3.4.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.2.3.4">𝑠</ci></apply></apply><apply id="S3.SS2.SSS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS2.p2.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS2.p2.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.3"><times id="S3.SS2.SSS2.p2.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.3.1"></times><apply id="S3.SS2.SSS2.p2.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.3.2"><divide id="S3.SS2.SSS2.p2.1.m1.1.1.3.3.2.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.3.2"></divide><ci id="S3.SS2.SSS2.p2.1.m1.1.1.3.3.2.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.3.2.2">𝑊</ci><cn type="integer" id="S3.SS2.SSS2.p2.1.m1.1.1.3.3.2.3.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.3.2.3">32</cn></apply><apply id="S3.SS2.SSS2.p2.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.3.3"><divide id="S3.SS2.SSS2.p2.1.m1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.3.3"></divide><ci id="S3.SS2.SSS2.p2.1.m1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.3.3.2">𝐻</ci><cn type="integer" id="S3.SS2.SSS2.p2.1.m1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.3.3.3">32</cn></apply><cn type="integer" id="S3.SS2.SSS2.p2.1.m1.1.1.3.3.4.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.3.4">512</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.1.m1.1c">F_{Res}\in\mathbb{R}^{\frac{W}{32}\times\frac{H}{32}\times 512}</annotation></semantics></math> represents the output of ResNet50.</p>
</div>
</section>
<section id="S3.SS2.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.3 </span>Transformer Learning branch</h4>

<div id="S3.SS2.SSS3.p1" class="ltx_para">
<p id="S3.SS2.SSS3.p1.1" class="ltx_p">Due to partial occlusion of pedestrians, key parts of the body are often missing, making it difficult to accurately identify them. However, the Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>, <a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite> captures global features, linking these scattered features together and providing a comprehensive pedestrian representation, thereby alleviating the challenges posed by occlusion. Therefore, we design a Transformer-based feature extractor that better understands the overall structure of pedestrian images, maintaining high recognition efficiency.</p>
</div>
<div id="S3.SS2.SSS3.p2" class="ltx_para">
<p id="S3.SS2.SSS3.p2.3" class="ltx_p">Firstly,the input pedestrian image I is divided into <math id="S3.SS2.SSS3.p2.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS2.SSS3.p2.1.m1.1a"><mi id="S3.SS2.SSS3.p2.1.m1.1.1" xref="S3.SS2.SSS3.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.1.m1.1b"><ci id="S3.SS2.SSS3.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.1.m1.1c">N</annotation></semantics></math> fixed-size patches of <math id="S3.SS2.SSS3.p2.2.m2.1" class="ltx_Math" alttext="p\times p" display="inline"><semantics id="S3.SS2.SSS3.p2.2.m2.1a"><mrow id="S3.SS2.SSS3.p2.2.m2.1.1" xref="S3.SS2.SSS3.p2.2.m2.1.1.cmml"><mi id="S3.SS2.SSS3.p2.2.m2.1.1.2" xref="S3.SS2.SSS3.p2.2.m2.1.1.2.cmml">p</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS3.p2.2.m2.1.1.1" xref="S3.SS2.SSS3.p2.2.m2.1.1.1.cmml">×</mo><mi id="S3.SS2.SSS3.p2.2.m2.1.1.3" xref="S3.SS2.SSS3.p2.2.m2.1.1.3.cmml">p</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.2.m2.1b"><apply id="S3.SS2.SSS3.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS3.p2.2.m2.1.1"><times id="S3.SS2.SSS3.p2.2.m2.1.1.1.cmml" xref="S3.SS2.SSS3.p2.2.m2.1.1.1"></times><ci id="S3.SS2.SSS3.p2.2.m2.1.1.2.cmml" xref="S3.SS2.SSS3.p2.2.m2.1.1.2">𝑝</ci><ci id="S3.SS2.SSS3.p2.2.m2.1.1.3.cmml" xref="S3.SS2.SSS3.p2.2.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.2.m2.1c">p\times p</annotation></semantics></math>. Then, each image patch undergoes a linear transformation using a learnable projection matrix <math id="S3.SS2.SSS3.p2.3.m3.1" class="ltx_Math" alttext="E\in\mathbb{R}^{D}" display="inline"><semantics id="S3.SS2.SSS3.p2.3.m3.1a"><mrow id="S3.SS2.SSS3.p2.3.m3.1.1" xref="S3.SS2.SSS3.p2.3.m3.1.1.cmml"><mi id="S3.SS2.SSS3.p2.3.m3.1.1.2" xref="S3.SS2.SSS3.p2.3.m3.1.1.2.cmml">E</mi><mo id="S3.SS2.SSS3.p2.3.m3.1.1.1" xref="S3.SS2.SSS3.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS3.p2.3.m3.1.1.3" xref="S3.SS2.SSS3.p2.3.m3.1.1.3.cmml"><mi id="S3.SS2.SSS3.p2.3.m3.1.1.3.2" xref="S3.SS2.SSS3.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.SSS3.p2.3.m3.1.1.3.3" xref="S3.SS2.SSS3.p2.3.m3.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.3.m3.1b"><apply id="S3.SS2.SSS3.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS3.p2.3.m3.1.1"><in id="S3.SS2.SSS3.p2.3.m3.1.1.1.cmml" xref="S3.SS2.SSS3.p2.3.m3.1.1.1"></in><ci id="S3.SS2.SSS3.p2.3.m3.1.1.2.cmml" xref="S3.SS2.SSS3.p2.3.m3.1.1.2">𝐸</ci><apply id="S3.SS2.SSS3.p2.3.m3.1.1.3.cmml" xref="S3.SS2.SSS3.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.3.m3.1.1.3.1.cmml" xref="S3.SS2.SSS3.p2.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS3.p2.3.m3.1.1.3.2.cmml" xref="S3.SS2.SSS3.p2.3.m3.1.1.3.2">ℝ</ci><ci id="S3.SS2.SSS3.p2.3.m3.1.1.3.3.cmml" xref="S3.SS2.SSS3.p2.3.m3.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.3.m3.1c">E\in\mathbb{R}^{D}</annotation></semantics></math> to convert it into a fixed-length feature vector</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E4.m1.1" class="ltx_Math" alttext="f_{\text{patch }}\in\mathbb{R}^{D}," display="block"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><msub id="S3.E4.m1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.1.1.1.1.2.2" xref="S3.E4.m1.1.1.1.1.2.2.cmml">f</mi><mtext id="S3.E4.m1.1.1.1.1.2.3" xref="S3.E4.m1.1.1.1.1.2.3a.cmml">patch </mtext></msub><mo id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.cmml">∈</mo><msup id="S3.E4.m1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.3.2.cmml">ℝ</mi><mi id="S3.E4.m1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.3.3.cmml">D</mi></msup></mrow><mo id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><in id="S3.E4.m1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1"></in><apply id="S3.E4.m1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2">𝑓</ci><ci id="S3.E4.m1.1.1.1.1.2.3a.cmml" xref="S3.E4.m1.1.1.1.1.2.3"><mtext mathsize="70%" id="S3.E4.m1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.3">patch </mtext></ci></apply><apply id="S3.E4.m1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2">ℝ</ci><ci id="S3.E4.m1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">f_{\text{patch }}\in\mathbb{R}^{D},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS3.p2.7" class="ltx_p">where <math id="S3.SS2.SSS3.p2.4.m1.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S3.SS2.SSS3.p2.4.m1.1a"><mi id="S3.SS2.SSS3.p2.4.m1.1.1" xref="S3.SS2.SSS3.p2.4.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.4.m1.1b"><ci id="S3.SS2.SSS3.p2.4.m1.1.1.cmml" xref="S3.SS2.SSS3.p2.4.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.4.m1.1c">D</annotation></semantics></math> is the dimension of the feature vector. All feature vectors of the patches are sequentially arranged, and a learnable classification token (denoted as <math id="S3.SS2.SSS3.p2.5.m2.1" class="ltx_Math" alttext="f_{cls}" display="inline"><semantics id="S3.SS2.SSS3.p2.5.m2.1a"><msub id="S3.SS2.SSS3.p2.5.m2.1.1" xref="S3.SS2.SSS3.p2.5.m2.1.1.cmml"><mi id="S3.SS2.SSS3.p2.5.m2.1.1.2" xref="S3.SS2.SSS3.p2.5.m2.1.1.2.cmml">f</mi><mrow id="S3.SS2.SSS3.p2.5.m2.1.1.3" xref="S3.SS2.SSS3.p2.5.m2.1.1.3.cmml"><mi id="S3.SS2.SSS3.p2.5.m2.1.1.3.2" xref="S3.SS2.SSS3.p2.5.m2.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p2.5.m2.1.1.3.1" xref="S3.SS2.SSS3.p2.5.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p2.5.m2.1.1.3.3" xref="S3.SS2.SSS3.p2.5.m2.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p2.5.m2.1.1.3.1a" xref="S3.SS2.SSS3.p2.5.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p2.5.m2.1.1.3.4" xref="S3.SS2.SSS3.p2.5.m2.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.5.m2.1b"><apply id="S3.SS2.SSS3.p2.5.m2.1.1.cmml" xref="S3.SS2.SSS3.p2.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.5.m2.1.1.1.cmml" xref="S3.SS2.SSS3.p2.5.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p2.5.m2.1.1.2.cmml" xref="S3.SS2.SSS3.p2.5.m2.1.1.2">𝑓</ci><apply id="S3.SS2.SSS3.p2.5.m2.1.1.3.cmml" xref="S3.SS2.SSS3.p2.5.m2.1.1.3"><times id="S3.SS2.SSS3.p2.5.m2.1.1.3.1.cmml" xref="S3.SS2.SSS3.p2.5.m2.1.1.3.1"></times><ci id="S3.SS2.SSS3.p2.5.m2.1.1.3.2.cmml" xref="S3.SS2.SSS3.p2.5.m2.1.1.3.2">𝑐</ci><ci id="S3.SS2.SSS3.p2.5.m2.1.1.3.3.cmml" xref="S3.SS2.SSS3.p2.5.m2.1.1.3.3">𝑙</ci><ci id="S3.SS2.SSS3.p2.5.m2.1.1.3.4.cmml" xref="S3.SS2.SSS3.p2.5.m2.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.5.m2.1c">f_{cls}</annotation></semantics></math>) is appended to integrate the features of all patches, generating a global feature representation.
Learnable positional encoding information <math id="S3.SS2.SSS3.p2.6.m3.1" class="ltx_Math" alttext="E_{posi}" display="inline"><semantics id="S3.SS2.SSS3.p2.6.m3.1a"><msub id="S3.SS2.SSS3.p2.6.m3.1.1" xref="S3.SS2.SSS3.p2.6.m3.1.1.cmml"><mi id="S3.SS2.SSS3.p2.6.m3.1.1.2" xref="S3.SS2.SSS3.p2.6.m3.1.1.2.cmml">E</mi><mrow id="S3.SS2.SSS3.p2.6.m3.1.1.3" xref="S3.SS2.SSS3.p2.6.m3.1.1.3.cmml"><mi id="S3.SS2.SSS3.p2.6.m3.1.1.3.2" xref="S3.SS2.SSS3.p2.6.m3.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p2.6.m3.1.1.3.1" xref="S3.SS2.SSS3.p2.6.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p2.6.m3.1.1.3.3" xref="S3.SS2.SSS3.p2.6.m3.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p2.6.m3.1.1.3.1a" xref="S3.SS2.SSS3.p2.6.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p2.6.m3.1.1.3.4" xref="S3.SS2.SSS3.p2.6.m3.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p2.6.m3.1.1.3.1b" xref="S3.SS2.SSS3.p2.6.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p2.6.m3.1.1.3.5" xref="S3.SS2.SSS3.p2.6.m3.1.1.3.5.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.6.m3.1b"><apply id="S3.SS2.SSS3.p2.6.m3.1.1.cmml" xref="S3.SS2.SSS3.p2.6.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.6.m3.1.1.1.cmml" xref="S3.SS2.SSS3.p2.6.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p2.6.m3.1.1.2.cmml" xref="S3.SS2.SSS3.p2.6.m3.1.1.2">𝐸</ci><apply id="S3.SS2.SSS3.p2.6.m3.1.1.3.cmml" xref="S3.SS2.SSS3.p2.6.m3.1.1.3"><times id="S3.SS2.SSS3.p2.6.m3.1.1.3.1.cmml" xref="S3.SS2.SSS3.p2.6.m3.1.1.3.1"></times><ci id="S3.SS2.SSS3.p2.6.m3.1.1.3.2.cmml" xref="S3.SS2.SSS3.p2.6.m3.1.1.3.2">𝑝</ci><ci id="S3.SS2.SSS3.p2.6.m3.1.1.3.3.cmml" xref="S3.SS2.SSS3.p2.6.m3.1.1.3.3">𝑜</ci><ci id="S3.SS2.SSS3.p2.6.m3.1.1.3.4.cmml" xref="S3.SS2.SSS3.p2.6.m3.1.1.3.4">𝑠</ci><ci id="S3.SS2.SSS3.p2.6.m3.1.1.3.5.cmml" xref="S3.SS2.SSS3.p2.6.m3.1.1.3.5">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.6.m3.1c">E_{posi}</annotation></semantics></math> is added to each patch feature vector to retain the positional information within the original image. Thus, we get the input feature sequence <math id="S3.SS2.SSS3.p2.7.m4.1" class="ltx_Math" alttext="X_{f}\in\mathbb{R}^{(N+1)\times D}" display="inline"><semantics id="S3.SS2.SSS3.p2.7.m4.1a"><mrow id="S3.SS2.SSS3.p2.7.m4.1.2" xref="S3.SS2.SSS3.p2.7.m4.1.2.cmml"><msub id="S3.SS2.SSS3.p2.7.m4.1.2.2" xref="S3.SS2.SSS3.p2.7.m4.1.2.2.cmml"><mi id="S3.SS2.SSS3.p2.7.m4.1.2.2.2" xref="S3.SS2.SSS3.p2.7.m4.1.2.2.2.cmml">X</mi><mi id="S3.SS2.SSS3.p2.7.m4.1.2.2.3" xref="S3.SS2.SSS3.p2.7.m4.1.2.2.3.cmml">f</mi></msub><mo id="S3.SS2.SSS3.p2.7.m4.1.2.1" xref="S3.SS2.SSS3.p2.7.m4.1.2.1.cmml">∈</mo><msup id="S3.SS2.SSS3.p2.7.m4.1.2.3" xref="S3.SS2.SSS3.p2.7.m4.1.2.3.cmml"><mi id="S3.SS2.SSS3.p2.7.m4.1.2.3.2" xref="S3.SS2.SSS3.p2.7.m4.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS3.p2.7.m4.1.1.1" xref="S3.SS2.SSS3.p2.7.m4.1.1.1.cmml"><mrow id="S3.SS2.SSS3.p2.7.m4.1.1.1.1.1" xref="S3.SS2.SSS3.p2.7.m4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS3.p2.7.m4.1.1.1.1.1.2" xref="S3.SS2.SSS3.p2.7.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS3.p2.7.m4.1.1.1.1.1.1" xref="S3.SS2.SSS3.p2.7.m4.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS3.p2.7.m4.1.1.1.1.1.1.2" xref="S3.SS2.SSS3.p2.7.m4.1.1.1.1.1.1.2.cmml">N</mi><mo id="S3.SS2.SSS3.p2.7.m4.1.1.1.1.1.1.1" xref="S3.SS2.SSS3.p2.7.m4.1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS2.SSS3.p2.7.m4.1.1.1.1.1.1.3" xref="S3.SS2.SSS3.p2.7.m4.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo rspace="0.055em" stretchy="false" id="S3.SS2.SSS3.p2.7.m4.1.1.1.1.1.3" xref="S3.SS2.SSS3.p2.7.m4.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.SS2.SSS3.p2.7.m4.1.1.1.2" xref="S3.SS2.SSS3.p2.7.m4.1.1.1.2.cmml">×</mo><mi id="S3.SS2.SSS3.p2.7.m4.1.1.1.3" xref="S3.SS2.SSS3.p2.7.m4.1.1.1.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.7.m4.1b"><apply id="S3.SS2.SSS3.p2.7.m4.1.2.cmml" xref="S3.SS2.SSS3.p2.7.m4.1.2"><in id="S3.SS2.SSS3.p2.7.m4.1.2.1.cmml" xref="S3.SS2.SSS3.p2.7.m4.1.2.1"></in><apply id="S3.SS2.SSS3.p2.7.m4.1.2.2.cmml" xref="S3.SS2.SSS3.p2.7.m4.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.7.m4.1.2.2.1.cmml" xref="S3.SS2.SSS3.p2.7.m4.1.2.2">subscript</csymbol><ci id="S3.SS2.SSS3.p2.7.m4.1.2.2.2.cmml" xref="S3.SS2.SSS3.p2.7.m4.1.2.2.2">𝑋</ci><ci id="S3.SS2.SSS3.p2.7.m4.1.2.2.3.cmml" xref="S3.SS2.SSS3.p2.7.m4.1.2.2.3">𝑓</ci></apply><apply id="S3.SS2.SSS3.p2.7.m4.1.2.3.cmml" xref="S3.SS2.SSS3.p2.7.m4.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.7.m4.1.2.3.1.cmml" xref="S3.SS2.SSS3.p2.7.m4.1.2.3">superscript</csymbol><ci id="S3.SS2.SSS3.p2.7.m4.1.2.3.2.cmml" xref="S3.SS2.SSS3.p2.7.m4.1.2.3.2">ℝ</ci><apply id="S3.SS2.SSS3.p2.7.m4.1.1.1.cmml" xref="S3.SS2.SSS3.p2.7.m4.1.1.1"><times id="S3.SS2.SSS3.p2.7.m4.1.1.1.2.cmml" xref="S3.SS2.SSS3.p2.7.m4.1.1.1.2"></times><apply id="S3.SS2.SSS3.p2.7.m4.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p2.7.m4.1.1.1.1.1"><plus id="S3.SS2.SSS3.p2.7.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p2.7.m4.1.1.1.1.1.1.1"></plus><ci id="S3.SS2.SSS3.p2.7.m4.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS3.p2.7.m4.1.1.1.1.1.1.2">𝑁</ci><cn type="integer" id="S3.SS2.SSS3.p2.7.m4.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS3.p2.7.m4.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.SS2.SSS3.p2.7.m4.1.1.1.3.cmml" xref="S3.SS2.SSS3.p2.7.m4.1.1.1.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.7.m4.1c">X_{f}\in\mathbb{R}^{(N+1)\times D}</annotation></semantics></math> for the Transformer:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E5.m1.2" class="ltx_Math" alttext="X_{f}=\left[f_{1}^{\text{patch }}E,f_{2}^{\text{patch }}E,\ldots,f_{N}^{\text{patch }}E,f_{cls}\right]+E_{\text{posi}}," display="block"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.2.1" xref="S3.E5.m1.2.2.1.1.cmml"><mrow id="S3.E5.m1.2.2.1.1" xref="S3.E5.m1.2.2.1.1.cmml"><msub id="S3.E5.m1.2.2.1.1.6" xref="S3.E5.m1.2.2.1.1.6.cmml"><mi id="S3.E5.m1.2.2.1.1.6.2" xref="S3.E5.m1.2.2.1.1.6.2.cmml">X</mi><mi id="S3.E5.m1.2.2.1.1.6.3" xref="S3.E5.m1.2.2.1.1.6.3.cmml">f</mi></msub><mo id="S3.E5.m1.2.2.1.1.5" xref="S3.E5.m1.2.2.1.1.5.cmml">=</mo><mrow id="S3.E5.m1.2.2.1.1.4" xref="S3.E5.m1.2.2.1.1.4.cmml"><mrow id="S3.E5.m1.2.2.1.1.4.4.4" xref="S3.E5.m1.2.2.1.1.4.4.5.cmml"><mo id="S3.E5.m1.2.2.1.1.4.4.4.5" xref="S3.E5.m1.2.2.1.1.4.4.5.cmml">[</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.cmml"><msubsup id="S3.E5.m1.2.2.1.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.cmml">f</mi><mn id="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.3.cmml">1</mn><mtext id="S3.E5.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.3a.cmml">patch </mtext></msubsup><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.cmml">E</mi></mrow><mo id="S3.E5.m1.2.2.1.1.4.4.4.6" xref="S3.E5.m1.2.2.1.1.4.4.5.cmml">,</mo><mrow id="S3.E5.m1.2.2.1.1.2.2.2.2" xref="S3.E5.m1.2.2.1.1.2.2.2.2.cmml"><msubsup id="S3.E5.m1.2.2.1.1.2.2.2.2.2" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.cmml"><mi id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.cmml">f</mi><mn id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.3" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.3.cmml">2</mn><mtext id="S3.E5.m1.2.2.1.1.2.2.2.2.2.3" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.3a.cmml">patch </mtext></msubsup><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.2.2.2.2.1" xref="S3.E5.m1.2.2.1.1.2.2.2.2.1.cmml">​</mo><mi id="S3.E5.m1.2.2.1.1.2.2.2.2.3" xref="S3.E5.m1.2.2.1.1.2.2.2.2.3.cmml">E</mi></mrow><mo id="S3.E5.m1.2.2.1.1.4.4.4.7" xref="S3.E5.m1.2.2.1.1.4.4.5.cmml">,</mo><mi mathvariant="normal" id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">…</mi><mo id="S3.E5.m1.2.2.1.1.4.4.4.8" xref="S3.E5.m1.2.2.1.1.4.4.5.cmml">,</mo><mrow id="S3.E5.m1.2.2.1.1.3.3.3.3" xref="S3.E5.m1.2.2.1.1.3.3.3.3.cmml"><msubsup id="S3.E5.m1.2.2.1.1.3.3.3.3.2" xref="S3.E5.m1.2.2.1.1.3.3.3.3.2.cmml"><mi id="S3.E5.m1.2.2.1.1.3.3.3.3.2.2.2" xref="S3.E5.m1.2.2.1.1.3.3.3.3.2.2.2.cmml">f</mi><mi id="S3.E5.m1.2.2.1.1.3.3.3.3.2.2.3" xref="S3.E5.m1.2.2.1.1.3.3.3.3.2.2.3.cmml">N</mi><mtext id="S3.E5.m1.2.2.1.1.3.3.3.3.2.3" xref="S3.E5.m1.2.2.1.1.3.3.3.3.2.3a.cmml">patch </mtext></msubsup><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.3.3.3.3.1" xref="S3.E5.m1.2.2.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.E5.m1.2.2.1.1.3.3.3.3.3" xref="S3.E5.m1.2.2.1.1.3.3.3.3.3.cmml">E</mi></mrow><mo id="S3.E5.m1.2.2.1.1.4.4.4.9" xref="S3.E5.m1.2.2.1.1.4.4.5.cmml">,</mo><msub id="S3.E5.m1.2.2.1.1.4.4.4.4" xref="S3.E5.m1.2.2.1.1.4.4.4.4.cmml"><mi id="S3.E5.m1.2.2.1.1.4.4.4.4.2" xref="S3.E5.m1.2.2.1.1.4.4.4.4.2.cmml">f</mi><mrow id="S3.E5.m1.2.2.1.1.4.4.4.4.3" xref="S3.E5.m1.2.2.1.1.4.4.4.4.3.cmml"><mi id="S3.E5.m1.2.2.1.1.4.4.4.4.3.2" xref="S3.E5.m1.2.2.1.1.4.4.4.4.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.4.4.4.4.3.1" xref="S3.E5.m1.2.2.1.1.4.4.4.4.3.1.cmml">​</mo><mi id="S3.E5.m1.2.2.1.1.4.4.4.4.3.3" xref="S3.E5.m1.2.2.1.1.4.4.4.4.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.4.4.4.4.3.1a" xref="S3.E5.m1.2.2.1.1.4.4.4.4.3.1.cmml">​</mo><mi id="S3.E5.m1.2.2.1.1.4.4.4.4.3.4" xref="S3.E5.m1.2.2.1.1.4.4.4.4.3.4.cmml">s</mi></mrow></msub><mo id="S3.E5.m1.2.2.1.1.4.4.4.10" xref="S3.E5.m1.2.2.1.1.4.4.5.cmml">]</mo></mrow><mo id="S3.E5.m1.2.2.1.1.4.5" xref="S3.E5.m1.2.2.1.1.4.5.cmml">+</mo><msub id="S3.E5.m1.2.2.1.1.4.6" xref="S3.E5.m1.2.2.1.1.4.6.cmml"><mi id="S3.E5.m1.2.2.1.1.4.6.2" xref="S3.E5.m1.2.2.1.1.4.6.2.cmml">E</mi><mtext id="S3.E5.m1.2.2.1.1.4.6.3" xref="S3.E5.m1.2.2.1.1.4.6.3a.cmml">posi</mtext></msub></mrow></mrow><mo id="S3.E5.m1.2.2.1.2" xref="S3.E5.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.2.1.1.cmml" xref="S3.E5.m1.2.2.1"><eq id="S3.E5.m1.2.2.1.1.5.cmml" xref="S3.E5.m1.2.2.1.1.5"></eq><apply id="S3.E5.m1.2.2.1.1.6.cmml" xref="S3.E5.m1.2.2.1.1.6"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.6.1.cmml" xref="S3.E5.m1.2.2.1.1.6">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.6.2.cmml" xref="S3.E5.m1.2.2.1.1.6.2">𝑋</ci><ci id="S3.E5.m1.2.2.1.1.6.3.cmml" xref="S3.E5.m1.2.2.1.1.6.3">𝑓</ci></apply><apply id="S3.E5.m1.2.2.1.1.4.cmml" xref="S3.E5.m1.2.2.1.1.4"><plus id="S3.E5.m1.2.2.1.1.4.5.cmml" xref="S3.E5.m1.2.2.1.1.4.5"></plus><list id="S3.E5.m1.2.2.1.1.4.4.5.cmml" xref="S3.E5.m1.2.2.1.1.4.4.4"><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1"><times id="S3.E5.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1"></times><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2">𝑓</ci><cn type="integer" id="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.3">1</cn></apply><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.2.3a.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="S3.E5.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.3">patch </mtext></ci></apply><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3">𝐸</ci></apply><apply id="S3.E5.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2"><times id="S3.E5.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.1"></times><apply id="S3.E5.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.2.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2">superscript</csymbol><apply id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.2">𝑓</ci><cn type="integer" id="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.2.3">2</cn></apply><ci id="S3.E5.m1.2.2.1.1.2.2.2.2.2.3a.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.3"><mtext mathsize="70%" id="S3.E5.m1.2.2.1.1.2.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.2.3">patch </mtext></ci></apply><ci id="S3.E5.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2.2.3">𝐸</ci></apply><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">…</ci><apply id="S3.E5.m1.2.2.1.1.3.3.3.3.cmml" xref="S3.E5.m1.2.2.1.1.3.3.3.3"><times id="S3.E5.m1.2.2.1.1.3.3.3.3.1.cmml" xref="S3.E5.m1.2.2.1.1.3.3.3.3.1"></times><apply id="S3.E5.m1.2.2.1.1.3.3.3.3.2.cmml" xref="S3.E5.m1.2.2.1.1.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.3.3.3.3.2.1.cmml" xref="S3.E5.m1.2.2.1.1.3.3.3.3.2">superscript</csymbol><apply id="S3.E5.m1.2.2.1.1.3.3.3.3.2.2.cmml" xref="S3.E5.m1.2.2.1.1.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.3.3.3.3.2.2.1.cmml" xref="S3.E5.m1.2.2.1.1.3.3.3.3.2">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.3.3.3.3.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.3.3.3.3.2.2.2">𝑓</ci><ci id="S3.E5.m1.2.2.1.1.3.3.3.3.2.2.3.cmml" xref="S3.E5.m1.2.2.1.1.3.3.3.3.2.2.3">𝑁</ci></apply><ci id="S3.E5.m1.2.2.1.1.3.3.3.3.2.3a.cmml" xref="S3.E5.m1.2.2.1.1.3.3.3.3.2.3"><mtext mathsize="70%" id="S3.E5.m1.2.2.1.1.3.3.3.3.2.3.cmml" xref="S3.E5.m1.2.2.1.1.3.3.3.3.2.3">patch </mtext></ci></apply><ci id="S3.E5.m1.2.2.1.1.3.3.3.3.3.cmml" xref="S3.E5.m1.2.2.1.1.3.3.3.3.3">𝐸</ci></apply><apply id="S3.E5.m1.2.2.1.1.4.4.4.4.cmml" xref="S3.E5.m1.2.2.1.1.4.4.4.4"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.4.4.4.4.1.cmml" xref="S3.E5.m1.2.2.1.1.4.4.4.4">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.4.4.4.4.2.cmml" xref="S3.E5.m1.2.2.1.1.4.4.4.4.2">𝑓</ci><apply id="S3.E5.m1.2.2.1.1.4.4.4.4.3.cmml" xref="S3.E5.m1.2.2.1.1.4.4.4.4.3"><times id="S3.E5.m1.2.2.1.1.4.4.4.4.3.1.cmml" xref="S3.E5.m1.2.2.1.1.4.4.4.4.3.1"></times><ci id="S3.E5.m1.2.2.1.1.4.4.4.4.3.2.cmml" xref="S3.E5.m1.2.2.1.1.4.4.4.4.3.2">𝑐</ci><ci id="S3.E5.m1.2.2.1.1.4.4.4.4.3.3.cmml" xref="S3.E5.m1.2.2.1.1.4.4.4.4.3.3">𝑙</ci><ci id="S3.E5.m1.2.2.1.1.4.4.4.4.3.4.cmml" xref="S3.E5.m1.2.2.1.1.4.4.4.4.3.4">𝑠</ci></apply></apply></list><apply id="S3.E5.m1.2.2.1.1.4.6.cmml" xref="S3.E5.m1.2.2.1.1.4.6"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.4.6.1.cmml" xref="S3.E5.m1.2.2.1.1.4.6">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.4.6.2.cmml" xref="S3.E5.m1.2.2.1.1.4.6.2">𝐸</ci><ci id="S3.E5.m1.2.2.1.1.4.6.3a.cmml" xref="S3.E5.m1.2.2.1.1.4.6.3"><mtext mathsize="70%" id="S3.E5.m1.2.2.1.1.4.6.3.cmml" xref="S3.E5.m1.2.2.1.1.4.6.3">posi</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">X_{f}=\left[f_{1}^{\text{patch }}E,f_{2}^{\text{patch }}E,\ldots,f_{N}^{\text{patch }}E,f_{cls}\right]+E_{\text{posi}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS3.p2.12" class="ltx_p">where <math id="S3.SS2.SSS3.p2.8.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS2.SSS3.p2.8.m1.1a"><mi id="S3.SS2.SSS3.p2.8.m1.1.1" xref="S3.SS2.SSS3.p2.8.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.8.m1.1b"><ci id="S3.SS2.SSS3.p2.8.m1.1.1.cmml" xref="S3.SS2.SSS3.p2.8.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.8.m1.1c">N</annotation></semantics></math> represents the number of patches, and <math id="S3.SS2.SSS3.p2.9.m2.1" class="ltx_Math" alttext="f_{k}^{\text{p}atch}" display="inline"><semantics id="S3.SS2.SSS3.p2.9.m2.1a"><msubsup id="S3.SS2.SSS3.p2.9.m2.1.1" xref="S3.SS2.SSS3.p2.9.m2.1.1.cmml"><mi id="S3.SS2.SSS3.p2.9.m2.1.1.2.2" xref="S3.SS2.SSS3.p2.9.m2.1.1.2.2.cmml">f</mi><mi id="S3.SS2.SSS3.p2.9.m2.1.1.2.3" xref="S3.SS2.SSS3.p2.9.m2.1.1.2.3.cmml">k</mi><mrow id="S3.SS2.SSS3.p2.9.m2.1.1.3" xref="S3.SS2.SSS3.p2.9.m2.1.1.3.cmml"><mtext id="S3.SS2.SSS3.p2.9.m2.1.1.3.2" xref="S3.SS2.SSS3.p2.9.m2.1.1.3.2a.cmml">p</mtext><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p2.9.m2.1.1.3.1" xref="S3.SS2.SSS3.p2.9.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p2.9.m2.1.1.3.3" xref="S3.SS2.SSS3.p2.9.m2.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p2.9.m2.1.1.3.1a" xref="S3.SS2.SSS3.p2.9.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p2.9.m2.1.1.3.4" xref="S3.SS2.SSS3.p2.9.m2.1.1.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p2.9.m2.1.1.3.1b" xref="S3.SS2.SSS3.p2.9.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p2.9.m2.1.1.3.5" xref="S3.SS2.SSS3.p2.9.m2.1.1.3.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p2.9.m2.1.1.3.1c" xref="S3.SS2.SSS3.p2.9.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p2.9.m2.1.1.3.6" xref="S3.SS2.SSS3.p2.9.m2.1.1.3.6.cmml">h</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.9.m2.1b"><apply id="S3.SS2.SSS3.p2.9.m2.1.1.cmml" xref="S3.SS2.SSS3.p2.9.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.9.m2.1.1.1.cmml" xref="S3.SS2.SSS3.p2.9.m2.1.1">superscript</csymbol><apply id="S3.SS2.SSS3.p2.9.m2.1.1.2.cmml" xref="S3.SS2.SSS3.p2.9.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.9.m2.1.1.2.1.cmml" xref="S3.SS2.SSS3.p2.9.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p2.9.m2.1.1.2.2.cmml" xref="S3.SS2.SSS3.p2.9.m2.1.1.2.2">𝑓</ci><ci id="S3.SS2.SSS3.p2.9.m2.1.1.2.3.cmml" xref="S3.SS2.SSS3.p2.9.m2.1.1.2.3">𝑘</ci></apply><apply id="S3.SS2.SSS3.p2.9.m2.1.1.3.cmml" xref="S3.SS2.SSS3.p2.9.m2.1.1.3"><times id="S3.SS2.SSS3.p2.9.m2.1.1.3.1.cmml" xref="S3.SS2.SSS3.p2.9.m2.1.1.3.1"></times><ci id="S3.SS2.SSS3.p2.9.m2.1.1.3.2a.cmml" xref="S3.SS2.SSS3.p2.9.m2.1.1.3.2"><mtext mathsize="70%" id="S3.SS2.SSS3.p2.9.m2.1.1.3.2.cmml" xref="S3.SS2.SSS3.p2.9.m2.1.1.3.2">p</mtext></ci><ci id="S3.SS2.SSS3.p2.9.m2.1.1.3.3.cmml" xref="S3.SS2.SSS3.p2.9.m2.1.1.3.3">𝑎</ci><ci id="S3.SS2.SSS3.p2.9.m2.1.1.3.4.cmml" xref="S3.SS2.SSS3.p2.9.m2.1.1.3.4">𝑡</ci><ci id="S3.SS2.SSS3.p2.9.m2.1.1.3.5.cmml" xref="S3.SS2.SSS3.p2.9.m2.1.1.3.5">𝑐</ci><ci id="S3.SS2.SSS3.p2.9.m2.1.1.3.6.cmml" xref="S3.SS2.SSS3.p2.9.m2.1.1.3.6">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.9.m2.1c">f_{k}^{\text{p}atch}</annotation></semantics></math> represents <math id="S3.SS2.SSS3.p2.10.m3.1" class="ltx_Math" alttext="k-th" display="inline"><semantics id="S3.SS2.SSS3.p2.10.m3.1a"><mrow id="S3.SS2.SSS3.p2.10.m3.1.1" xref="S3.SS2.SSS3.p2.10.m3.1.1.cmml"><mi id="S3.SS2.SSS3.p2.10.m3.1.1.2" xref="S3.SS2.SSS3.p2.10.m3.1.1.2.cmml">k</mi><mo id="S3.SS2.SSS3.p2.10.m3.1.1.1" xref="S3.SS2.SSS3.p2.10.m3.1.1.1.cmml">−</mo><mrow id="S3.SS2.SSS3.p2.10.m3.1.1.3" xref="S3.SS2.SSS3.p2.10.m3.1.1.3.cmml"><mi id="S3.SS2.SSS3.p2.10.m3.1.1.3.2" xref="S3.SS2.SSS3.p2.10.m3.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p2.10.m3.1.1.3.1" xref="S3.SS2.SSS3.p2.10.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p2.10.m3.1.1.3.3" xref="S3.SS2.SSS3.p2.10.m3.1.1.3.3.cmml">h</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.10.m3.1b"><apply id="S3.SS2.SSS3.p2.10.m3.1.1.cmml" xref="S3.SS2.SSS3.p2.10.m3.1.1"><minus id="S3.SS2.SSS3.p2.10.m3.1.1.1.cmml" xref="S3.SS2.SSS3.p2.10.m3.1.1.1"></minus><ci id="S3.SS2.SSS3.p2.10.m3.1.1.2.cmml" xref="S3.SS2.SSS3.p2.10.m3.1.1.2">𝑘</ci><apply id="S3.SS2.SSS3.p2.10.m3.1.1.3.cmml" xref="S3.SS2.SSS3.p2.10.m3.1.1.3"><times id="S3.SS2.SSS3.p2.10.m3.1.1.3.1.cmml" xref="S3.SS2.SSS3.p2.10.m3.1.1.3.1"></times><ci id="S3.SS2.SSS3.p2.10.m3.1.1.3.2.cmml" xref="S3.SS2.SSS3.p2.10.m3.1.1.3.2">𝑡</ci><ci id="S3.SS2.SSS3.p2.10.m3.1.1.3.3.cmml" xref="S3.SS2.SSS3.p2.10.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.10.m3.1c">k-th</annotation></semantics></math> patch. <math id="S3.SS2.SSS3.p2.11.m4.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.SS2.SSS3.p2.11.m4.1a"><mi id="S3.SS2.SSS3.p2.11.m4.1.1" xref="S3.SS2.SSS3.p2.11.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.11.m4.1b"><ci id="S3.SS2.SSS3.p2.11.m4.1.1.cmml" xref="S3.SS2.SSS3.p2.11.m4.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.11.m4.1c">E</annotation></semantics></math> represents an embedding matrix used to map input feature vectors.
The input feature sequence undergoes layer normalization to obtain the normalized feature sequence <math id="S3.SS2.SSS3.p2.12.m5.1" class="ltx_Math" alttext="X^{N}" display="inline"><semantics id="S3.SS2.SSS3.p2.12.m5.1a"><msup id="S3.SS2.SSS3.p2.12.m5.1.1" xref="S3.SS2.SSS3.p2.12.m5.1.1.cmml"><mi id="S3.SS2.SSS3.p2.12.m5.1.1.2" xref="S3.SS2.SSS3.p2.12.m5.1.1.2.cmml">X</mi><mi id="S3.SS2.SSS3.p2.12.m5.1.1.3" xref="S3.SS2.SSS3.p2.12.m5.1.1.3.cmml">N</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.12.m5.1b"><apply id="S3.SS2.SSS3.p2.12.m5.1.1.cmml" xref="S3.SS2.SSS3.p2.12.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.12.m5.1.1.1.cmml" xref="S3.SS2.SSS3.p2.12.m5.1.1">superscript</csymbol><ci id="S3.SS2.SSS3.p2.12.m5.1.1.2.cmml" xref="S3.SS2.SSS3.p2.12.m5.1.1.2">𝑋</ci><ci id="S3.SS2.SSS3.p2.12.m5.1.1.3.cmml" xref="S3.SS2.SSS3.p2.12.m5.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.12.m5.1c">X^{N}</annotation></semantics></math>:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E6.m1.1" class="ltx_Math" alttext="X^{N}=LayerNorm(X_{f})." display="block"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><msup id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.3.2.cmml">X</mi><mi id="S3.E6.m1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.3.3.cmml">N</mi></msup><mo id="S3.E6.m1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.1.4" xref="S3.E6.m1.1.1.1.1.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.2a" xref="S3.E6.m1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.1.5" xref="S3.E6.m1.1.1.1.1.1.5.cmml">y</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.2b" xref="S3.E6.m1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.1.6" xref="S3.E6.m1.1.1.1.1.1.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.2c" xref="S3.E6.m1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.1.7" xref="S3.E6.m1.1.1.1.1.1.7.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.2d" xref="S3.E6.m1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.1.8" xref="S3.E6.m1.1.1.1.1.1.8.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.2e" xref="S3.E6.m1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.1.9" xref="S3.E6.m1.1.1.1.1.1.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.2f" xref="S3.E6.m1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.1.10" xref="S3.E6.m1.1.1.1.1.1.10.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.2g" xref="S3.E6.m1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.1.11" xref="S3.E6.m1.1.1.1.1.1.11.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.2h" xref="S3.E6.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E6.m1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.cmml">X</mi><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.cmml">f</mi></msub><mo stretchy="false" id="S3.E6.m1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E6.m1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><eq id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2"></eq><apply id="S3.E6.m1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.3">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.3.2">𝑋</ci><ci id="S3.E6.m1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.3.3">𝑁</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1"><times id="S3.E6.m1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2"></times><ci id="S3.E6.m1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3">𝐿</ci><ci id="S3.E6.m1.1.1.1.1.1.4.cmml" xref="S3.E6.m1.1.1.1.1.1.4">𝑎</ci><ci id="S3.E6.m1.1.1.1.1.1.5.cmml" xref="S3.E6.m1.1.1.1.1.1.5">𝑦</ci><ci id="S3.E6.m1.1.1.1.1.1.6.cmml" xref="S3.E6.m1.1.1.1.1.1.6">𝑒</ci><ci id="S3.E6.m1.1.1.1.1.1.7.cmml" xref="S3.E6.m1.1.1.1.1.1.7">𝑟</ci><ci id="S3.E6.m1.1.1.1.1.1.8.cmml" xref="S3.E6.m1.1.1.1.1.1.8">𝑁</ci><ci id="S3.E6.m1.1.1.1.1.1.9.cmml" xref="S3.E6.m1.1.1.1.1.1.9">𝑜</ci><ci id="S3.E6.m1.1.1.1.1.1.10.cmml" xref="S3.E6.m1.1.1.1.1.1.10">𝑟</ci><ci id="S3.E6.m1.1.1.1.1.1.11.cmml" xref="S3.E6.m1.1.1.1.1.1.11">𝑚</ci><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2">𝑋</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3">𝑓</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">X^{N}=LayerNorm(X_{f}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS3.p2.19" class="ltx_p">The normalized feature sequence <math id="S3.SS2.SSS3.p2.13.m1.1" class="ltx_Math" alttext="X^{N}" display="inline"><semantics id="S3.SS2.SSS3.p2.13.m1.1a"><msup id="S3.SS2.SSS3.p2.13.m1.1.1" xref="S3.SS2.SSS3.p2.13.m1.1.1.cmml"><mi id="S3.SS2.SSS3.p2.13.m1.1.1.2" xref="S3.SS2.SSS3.p2.13.m1.1.1.2.cmml">X</mi><mi id="S3.SS2.SSS3.p2.13.m1.1.1.3" xref="S3.SS2.SSS3.p2.13.m1.1.1.3.cmml">N</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.13.m1.1b"><apply id="S3.SS2.SSS3.p2.13.m1.1.1.cmml" xref="S3.SS2.SSS3.p2.13.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.13.m1.1.1.1.cmml" xref="S3.SS2.SSS3.p2.13.m1.1.1">superscript</csymbol><ci id="S3.SS2.SSS3.p2.13.m1.1.1.2.cmml" xref="S3.SS2.SSS3.p2.13.m1.1.1.2">𝑋</ci><ci id="S3.SS2.SSS3.p2.13.m1.1.1.3.cmml" xref="S3.SS2.SSS3.p2.13.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.13.m1.1c">X^{N}</annotation></semantics></math> is multiplied by three weight matrices <math id="S3.SS2.SSS3.p2.14.m2.1" class="ltx_Math" alttext="W^{Q}" display="inline"><semantics id="S3.SS2.SSS3.p2.14.m2.1a"><msup id="S3.SS2.SSS3.p2.14.m2.1.1" xref="S3.SS2.SSS3.p2.14.m2.1.1.cmml"><mi id="S3.SS2.SSS3.p2.14.m2.1.1.2" xref="S3.SS2.SSS3.p2.14.m2.1.1.2.cmml">W</mi><mi id="S3.SS2.SSS3.p2.14.m2.1.1.3" xref="S3.SS2.SSS3.p2.14.m2.1.1.3.cmml">Q</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.14.m2.1b"><apply id="S3.SS2.SSS3.p2.14.m2.1.1.cmml" xref="S3.SS2.SSS3.p2.14.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.14.m2.1.1.1.cmml" xref="S3.SS2.SSS3.p2.14.m2.1.1">superscript</csymbol><ci id="S3.SS2.SSS3.p2.14.m2.1.1.2.cmml" xref="S3.SS2.SSS3.p2.14.m2.1.1.2">𝑊</ci><ci id="S3.SS2.SSS3.p2.14.m2.1.1.3.cmml" xref="S3.SS2.SSS3.p2.14.m2.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.14.m2.1c">W^{Q}</annotation></semantics></math>, <math id="S3.SS2.SSS3.p2.15.m3.1" class="ltx_Math" alttext="W^{K}" display="inline"><semantics id="S3.SS2.SSS3.p2.15.m3.1a"><msup id="S3.SS2.SSS3.p2.15.m3.1.1" xref="S3.SS2.SSS3.p2.15.m3.1.1.cmml"><mi id="S3.SS2.SSS3.p2.15.m3.1.1.2" xref="S3.SS2.SSS3.p2.15.m3.1.1.2.cmml">W</mi><mi id="S3.SS2.SSS3.p2.15.m3.1.1.3" xref="S3.SS2.SSS3.p2.15.m3.1.1.3.cmml">K</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.15.m3.1b"><apply id="S3.SS2.SSS3.p2.15.m3.1.1.cmml" xref="S3.SS2.SSS3.p2.15.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.15.m3.1.1.1.cmml" xref="S3.SS2.SSS3.p2.15.m3.1.1">superscript</csymbol><ci id="S3.SS2.SSS3.p2.15.m3.1.1.2.cmml" xref="S3.SS2.SSS3.p2.15.m3.1.1.2">𝑊</ci><ci id="S3.SS2.SSS3.p2.15.m3.1.1.3.cmml" xref="S3.SS2.SSS3.p2.15.m3.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.15.m3.1c">W^{K}</annotation></semantics></math>, and <math id="S3.SS2.SSS3.p2.16.m4.1" class="ltx_Math" alttext="W^{V}" display="inline"><semantics id="S3.SS2.SSS3.p2.16.m4.1a"><msup id="S3.SS2.SSS3.p2.16.m4.1.1" xref="S3.SS2.SSS3.p2.16.m4.1.1.cmml"><mi id="S3.SS2.SSS3.p2.16.m4.1.1.2" xref="S3.SS2.SSS3.p2.16.m4.1.1.2.cmml">W</mi><mi id="S3.SS2.SSS3.p2.16.m4.1.1.3" xref="S3.SS2.SSS3.p2.16.m4.1.1.3.cmml">V</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.16.m4.1b"><apply id="S3.SS2.SSS3.p2.16.m4.1.1.cmml" xref="S3.SS2.SSS3.p2.16.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.16.m4.1.1.1.cmml" xref="S3.SS2.SSS3.p2.16.m4.1.1">superscript</csymbol><ci id="S3.SS2.SSS3.p2.16.m4.1.1.2.cmml" xref="S3.SS2.SSS3.p2.16.m4.1.1.2">𝑊</ci><ci id="S3.SS2.SSS3.p2.16.m4.1.1.3.cmml" xref="S3.SS2.SSS3.p2.16.m4.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.16.m4.1c">W^{V}</annotation></semantics></math> respectively to obtain the query vector <math id="S3.SS2.SSS3.p2.17.m5.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS2.SSS3.p2.17.m5.1a"><mi id="S3.SS2.SSS3.p2.17.m5.1.1" xref="S3.SS2.SSS3.p2.17.m5.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.17.m5.1b"><ci id="S3.SS2.SSS3.p2.17.m5.1.1.cmml" xref="S3.SS2.SSS3.p2.17.m5.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.17.m5.1c">Q</annotation></semantics></math>, key vector <math id="S3.SS2.SSS3.p2.18.m6.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.SSS3.p2.18.m6.1a"><mi id="S3.SS2.SSS3.p2.18.m6.1.1" xref="S3.SS2.SSS3.p2.18.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.18.m6.1b"><ci id="S3.SS2.SSS3.p2.18.m6.1.1.cmml" xref="S3.SS2.SSS3.p2.18.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.18.m6.1c">K</annotation></semantics></math>, and value vector <math id="S3.SS2.SSS3.p2.19.m7.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S3.SS2.SSS3.p2.19.m7.1a"><mi id="S3.SS2.SSS3.p2.19.m7.1.1" xref="S3.SS2.SSS3.p2.19.m7.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.19.m7.1b"><ci id="S3.SS2.SSS3.p2.19.m7.1.1.cmml" xref="S3.SS2.SSS3.p2.19.m7.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.19.m7.1c">V</annotation></semantics></math>:</p>
<table id="S3.E7" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E7X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle Q=X^{N}W^{Q}," display="inline"><semantics id="S3.E7X.2.1.1.m1.1a"><mrow id="S3.E7X.2.1.1.m1.1.1.1" xref="S3.E7X.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E7X.2.1.1.m1.1.1.1.1" xref="S3.E7X.2.1.1.m1.1.1.1.1.cmml"><mi id="S3.E7X.2.1.1.m1.1.1.1.1.2" xref="S3.E7X.2.1.1.m1.1.1.1.1.2.cmml">Q</mi><mo id="S3.E7X.2.1.1.m1.1.1.1.1.1" xref="S3.E7X.2.1.1.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E7X.2.1.1.m1.1.1.1.1.3" xref="S3.E7X.2.1.1.m1.1.1.1.1.3.cmml"><msup id="S3.E7X.2.1.1.m1.1.1.1.1.3.2" xref="S3.E7X.2.1.1.m1.1.1.1.1.3.2.cmml"><mi id="S3.E7X.2.1.1.m1.1.1.1.1.3.2.2" xref="S3.E7X.2.1.1.m1.1.1.1.1.3.2.2.cmml">X</mi><mi id="S3.E7X.2.1.1.m1.1.1.1.1.3.2.3" xref="S3.E7X.2.1.1.m1.1.1.1.1.3.2.3.cmml">N</mi></msup><mo lspace="0em" rspace="0em" id="S3.E7X.2.1.1.m1.1.1.1.1.3.1" xref="S3.E7X.2.1.1.m1.1.1.1.1.3.1.cmml">​</mo><msup id="S3.E7X.2.1.1.m1.1.1.1.1.3.3" xref="S3.E7X.2.1.1.m1.1.1.1.1.3.3.cmml"><mi id="S3.E7X.2.1.1.m1.1.1.1.1.3.3.2" xref="S3.E7X.2.1.1.m1.1.1.1.1.3.3.2.cmml">W</mi><mi id="S3.E7X.2.1.1.m1.1.1.1.1.3.3.3" xref="S3.E7X.2.1.1.m1.1.1.1.1.3.3.3.cmml">Q</mi></msup></mrow></mrow><mo id="S3.E7X.2.1.1.m1.1.1.1.2" xref="S3.E7X.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7X.2.1.1.m1.1b"><apply id="S3.E7X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E7X.2.1.1.m1.1.1.1"><eq id="S3.E7X.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E7X.2.1.1.m1.1.1.1.1.1"></eq><ci id="S3.E7X.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E7X.2.1.1.m1.1.1.1.1.2">𝑄</ci><apply id="S3.E7X.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E7X.2.1.1.m1.1.1.1.1.3"><times id="S3.E7X.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S3.E7X.2.1.1.m1.1.1.1.1.3.1"></times><apply id="S3.E7X.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S3.E7X.2.1.1.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.1.1.1.1.3.2.1.cmml" xref="S3.E7X.2.1.1.m1.1.1.1.1.3.2">superscript</csymbol><ci id="S3.E7X.2.1.1.m1.1.1.1.1.3.2.2.cmml" xref="S3.E7X.2.1.1.m1.1.1.1.1.3.2.2">𝑋</ci><ci id="S3.E7X.2.1.1.m1.1.1.1.1.3.2.3.cmml" xref="S3.E7X.2.1.1.m1.1.1.1.1.3.2.3">𝑁</ci></apply><apply id="S3.E7X.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S3.E7X.2.1.1.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.1.1.1.1.3.3.1.cmml" xref="S3.E7X.2.1.1.m1.1.1.1.1.3.3">superscript</csymbol><ci id="S3.E7X.2.1.1.m1.1.1.1.1.3.3.2.cmml" xref="S3.E7X.2.1.1.m1.1.1.1.1.3.3.2">𝑊</ci><ci id="S3.E7X.2.1.1.m1.1.1.1.1.3.3.3.cmml" xref="S3.E7X.2.1.1.m1.1.1.1.1.3.3.3">𝑄</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7X.2.1.1.m1.1c">\displaystyle Q=X^{N}W^{Q},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="3" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(7)</span></td>
</tr>
<tr id="S3.E7Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle K=X^{N}W^{K}," display="inline"><semantics id="S3.E7Xa.2.1.1.m1.1a"><mrow id="S3.E7Xa.2.1.1.m1.1.1.1" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E7Xa.2.1.1.m1.1.1.1.1" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.cmml"><mi id="S3.E7Xa.2.1.1.m1.1.1.1.1.2" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.2.cmml">K</mi><mo id="S3.E7Xa.2.1.1.m1.1.1.1.1.1" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E7Xa.2.1.1.m1.1.1.1.1.3" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3.cmml"><msup id="S3.E7Xa.2.1.1.m1.1.1.1.1.3.2" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3.2.cmml"><mi id="S3.E7Xa.2.1.1.m1.1.1.1.1.3.2.2" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3.2.2.cmml">X</mi><mi id="S3.E7Xa.2.1.1.m1.1.1.1.1.3.2.3" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.cmml">N</mi></msup><mo lspace="0em" rspace="0em" id="S3.E7Xa.2.1.1.m1.1.1.1.1.3.1" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3.1.cmml">​</mo><msup id="S3.E7Xa.2.1.1.m1.1.1.1.1.3.3" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3.3.cmml"><mi id="S3.E7Xa.2.1.1.m1.1.1.1.1.3.3.2" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.cmml">W</mi><mi id="S3.E7Xa.2.1.1.m1.1.1.1.1.3.3.3" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3.3.3.cmml">K</mi></msup></mrow></mrow><mo id="S3.E7Xa.2.1.1.m1.1.1.1.2" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7Xa.2.1.1.m1.1b"><apply id="S3.E7Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1"><eq id="S3.E7Xa.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.1"></eq><ci id="S3.E7Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.2">𝐾</ci><apply id="S3.E7Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3"><times id="S3.E7Xa.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3.1"></times><apply id="S3.E7Xa.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7Xa.2.1.1.m1.1.1.1.1.3.2.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3.2">superscript</csymbol><ci id="S3.E7Xa.2.1.1.m1.1.1.1.1.3.2.2.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3.2.2">𝑋</ci><ci id="S3.E7Xa.2.1.1.m1.1.1.1.1.3.2.3.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3.2.3">𝑁</ci></apply><apply id="S3.E7Xa.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E7Xa.2.1.1.m1.1.1.1.1.3.3.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3.3">superscript</csymbol><ci id="S3.E7Xa.2.1.1.m1.1.1.1.1.3.3.2.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3.3.2">𝑊</ci><ci id="S3.E7Xa.2.1.1.m1.1.1.1.1.3.3.3.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.1.1.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7Xa.2.1.1.m1.1c">\displaystyle K=X^{N}W^{K},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr>
<tr id="S3.E7Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7Xb.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle V=X^{N}W^{V}." display="inline"><semantics id="S3.E7Xb.2.1.1.m1.1a"><mrow id="S3.E7Xb.2.1.1.m1.1.1.1" xref="S3.E7Xb.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E7Xb.2.1.1.m1.1.1.1.1" xref="S3.E7Xb.2.1.1.m1.1.1.1.1.cmml"><mi id="S3.E7Xb.2.1.1.m1.1.1.1.1.2" xref="S3.E7Xb.2.1.1.m1.1.1.1.1.2.cmml">V</mi><mo id="S3.E7Xb.2.1.1.m1.1.1.1.1.1" xref="S3.E7Xb.2.1.1.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E7Xb.2.1.1.m1.1.1.1.1.3" xref="S3.E7Xb.2.1.1.m1.1.1.1.1.3.cmml"><msup id="S3.E7Xb.2.1.1.m1.1.1.1.1.3.2" xref="S3.E7Xb.2.1.1.m1.1.1.1.1.3.2.cmml"><mi id="S3.E7Xb.2.1.1.m1.1.1.1.1.3.2.2" xref="S3.E7Xb.2.1.1.m1.1.1.1.1.3.2.2.cmml">X</mi><mi id="S3.E7Xb.2.1.1.m1.1.1.1.1.3.2.3" xref="S3.E7Xb.2.1.1.m1.1.1.1.1.3.2.3.cmml">N</mi></msup><mo lspace="0em" rspace="0em" id="S3.E7Xb.2.1.1.m1.1.1.1.1.3.1" xref="S3.E7Xb.2.1.1.m1.1.1.1.1.3.1.cmml">​</mo><msup id="S3.E7Xb.2.1.1.m1.1.1.1.1.3.3" xref="S3.E7Xb.2.1.1.m1.1.1.1.1.3.3.cmml"><mi id="S3.E7Xb.2.1.1.m1.1.1.1.1.3.3.2" xref="S3.E7Xb.2.1.1.m1.1.1.1.1.3.3.2.cmml">W</mi><mi id="S3.E7Xb.2.1.1.m1.1.1.1.1.3.3.3" xref="S3.E7Xb.2.1.1.m1.1.1.1.1.3.3.3.cmml">V</mi></msup></mrow></mrow><mo lspace="0em" id="S3.E7Xb.2.1.1.m1.1.1.1.2" xref="S3.E7Xb.2.1.1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7Xb.2.1.1.m1.1b"><apply id="S3.E7Xb.2.1.1.m1.1.1.1.1.cmml" xref="S3.E7Xb.2.1.1.m1.1.1.1"><eq id="S3.E7Xb.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E7Xb.2.1.1.m1.1.1.1.1.1"></eq><ci id="S3.E7Xb.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E7Xb.2.1.1.m1.1.1.1.1.2">𝑉</ci><apply id="S3.E7Xb.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E7Xb.2.1.1.m1.1.1.1.1.3"><times id="S3.E7Xb.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S3.E7Xb.2.1.1.m1.1.1.1.1.3.1"></times><apply id="S3.E7Xb.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S3.E7Xb.2.1.1.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7Xb.2.1.1.m1.1.1.1.1.3.2.1.cmml" xref="S3.E7Xb.2.1.1.m1.1.1.1.1.3.2">superscript</csymbol><ci id="S3.E7Xb.2.1.1.m1.1.1.1.1.3.2.2.cmml" xref="S3.E7Xb.2.1.1.m1.1.1.1.1.3.2.2">𝑋</ci><ci id="S3.E7Xb.2.1.1.m1.1.1.1.1.3.2.3.cmml" xref="S3.E7Xb.2.1.1.m1.1.1.1.1.3.2.3">𝑁</ci></apply><apply id="S3.E7Xb.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S3.E7Xb.2.1.1.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E7Xb.2.1.1.m1.1.1.1.1.3.3.1.cmml" xref="S3.E7Xb.2.1.1.m1.1.1.1.1.3.3">superscript</csymbol><ci id="S3.E7Xb.2.1.1.m1.1.1.1.1.3.3.2.cmml" xref="S3.E7Xb.2.1.1.m1.1.1.1.1.3.3.2">𝑊</ci><ci id="S3.E7Xb.2.1.1.m1.1.1.1.1.3.3.3.cmml" xref="S3.E7Xb.2.1.1.m1.1.1.1.1.3.3.3">𝑉</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7Xb.2.1.1.m1.1c">\displaystyle V=X^{N}W^{V}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS2.SSS3.p2.20" class="ltx_p">The multi-head attention mechanism calculates the relationships between the feature vectors. The output of the multi-head attention is denoted as <math id="S3.SS2.SSS3.p2.20.m1.1" class="ltx_Math" alttext="Z_{H}" display="inline"><semantics id="S3.SS2.SSS3.p2.20.m1.1a"><msub id="S3.SS2.SSS3.p2.20.m1.1.1" xref="S3.SS2.SSS3.p2.20.m1.1.1.cmml"><mi id="S3.SS2.SSS3.p2.20.m1.1.1.2" xref="S3.SS2.SSS3.p2.20.m1.1.1.2.cmml">Z</mi><mi id="S3.SS2.SSS3.p2.20.m1.1.1.3" xref="S3.SS2.SSS3.p2.20.m1.1.1.3.cmml">H</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.20.m1.1b"><apply id="S3.SS2.SSS3.p2.20.m1.1.1.cmml" xref="S3.SS2.SSS3.p2.20.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.20.m1.1.1.1.cmml" xref="S3.SS2.SSS3.p2.20.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p2.20.m1.1.1.2.cmml" xref="S3.SS2.SSS3.p2.20.m1.1.1.2">𝑍</ci><ci id="S3.SS2.SSS3.p2.20.m1.1.1.3.cmml" xref="S3.SS2.SSS3.p2.20.m1.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.20.m1.1c">Z_{H}</annotation></semantics></math>:</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E8.m1.7" class="ltx_Math" alttext="Z_{H}=\operatorname{MultiHead}(Q,K,V)=\operatorname{Concat}\left(H_{1},H_{2},\ldots,H_{h}\right)W^{O}," display="block"><semantics id="S3.E8.m1.7a"><mrow id="S3.E8.m1.7.7.1" xref="S3.E8.m1.7.7.1.1.cmml"><mrow id="S3.E8.m1.7.7.1.1" xref="S3.E8.m1.7.7.1.1.cmml"><msub id="S3.E8.m1.7.7.1.1.5" xref="S3.E8.m1.7.7.1.1.5.cmml"><mi id="S3.E8.m1.7.7.1.1.5.2" xref="S3.E8.m1.7.7.1.1.5.2.cmml">Z</mi><mi id="S3.E8.m1.7.7.1.1.5.3" xref="S3.E8.m1.7.7.1.1.5.3.cmml">H</mi></msub><mo id="S3.E8.m1.7.7.1.1.6" xref="S3.E8.m1.7.7.1.1.6.cmml">=</mo><mrow id="S3.E8.m1.7.7.1.1.7.2" xref="S3.E8.m1.7.7.1.1.7.1.cmml"><mi id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml">MultiHead</mi><mo id="S3.E8.m1.7.7.1.1.7.2a" xref="S3.E8.m1.7.7.1.1.7.1.cmml">⁡</mo><mrow id="S3.E8.m1.7.7.1.1.7.2.1" xref="S3.E8.m1.7.7.1.1.7.1.cmml"><mo stretchy="false" id="S3.E8.m1.7.7.1.1.7.2.1.1" xref="S3.E8.m1.7.7.1.1.7.1.cmml">(</mo><mi id="S3.E8.m1.2.2" xref="S3.E8.m1.2.2.cmml">Q</mi><mo id="S3.E8.m1.7.7.1.1.7.2.1.2" xref="S3.E8.m1.7.7.1.1.7.1.cmml">,</mo><mi id="S3.E8.m1.3.3" xref="S3.E8.m1.3.3.cmml">K</mi><mo id="S3.E8.m1.7.7.1.1.7.2.1.3" xref="S3.E8.m1.7.7.1.1.7.1.cmml">,</mo><mi id="S3.E8.m1.4.4" xref="S3.E8.m1.4.4.cmml">V</mi><mo stretchy="false" id="S3.E8.m1.7.7.1.1.7.2.1.4" xref="S3.E8.m1.7.7.1.1.7.1.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.7.7.1.1.8" xref="S3.E8.m1.7.7.1.1.8.cmml">=</mo><mrow id="S3.E8.m1.7.7.1.1.3" xref="S3.E8.m1.7.7.1.1.3.cmml"><mrow id="S3.E8.m1.7.7.1.1.3.3.3" xref="S3.E8.m1.7.7.1.1.3.3.4.cmml"><mi id="S3.E8.m1.5.5" xref="S3.E8.m1.5.5.cmml">Concat</mi><mo id="S3.E8.m1.7.7.1.1.3.3.3a" xref="S3.E8.m1.7.7.1.1.3.3.4.cmml">⁡</mo><mrow id="S3.E8.m1.7.7.1.1.3.3.3.3" xref="S3.E8.m1.7.7.1.1.3.3.4.cmml"><mo id="S3.E8.m1.7.7.1.1.3.3.3.3.4" xref="S3.E8.m1.7.7.1.1.3.3.4.cmml">(</mo><msub id="S3.E8.m1.7.7.1.1.1.1.1.1.1" xref="S3.E8.m1.7.7.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.7.7.1.1.1.1.1.1.1.2" xref="S3.E8.m1.7.7.1.1.1.1.1.1.1.2.cmml">H</mi><mn id="S3.E8.m1.7.7.1.1.1.1.1.1.1.3" xref="S3.E8.m1.7.7.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E8.m1.7.7.1.1.3.3.3.3.5" xref="S3.E8.m1.7.7.1.1.3.3.4.cmml">,</mo><msub id="S3.E8.m1.7.7.1.1.2.2.2.2.2" xref="S3.E8.m1.7.7.1.1.2.2.2.2.2.cmml"><mi id="S3.E8.m1.7.7.1.1.2.2.2.2.2.2" xref="S3.E8.m1.7.7.1.1.2.2.2.2.2.2.cmml">H</mi><mn id="S3.E8.m1.7.7.1.1.2.2.2.2.2.3" xref="S3.E8.m1.7.7.1.1.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.E8.m1.7.7.1.1.3.3.3.3.6" xref="S3.E8.m1.7.7.1.1.3.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.E8.m1.6.6" xref="S3.E8.m1.6.6.cmml">…</mi><mo id="S3.E8.m1.7.7.1.1.3.3.3.3.7" xref="S3.E8.m1.7.7.1.1.3.3.4.cmml">,</mo><msub id="S3.E8.m1.7.7.1.1.3.3.3.3.3" xref="S3.E8.m1.7.7.1.1.3.3.3.3.3.cmml"><mi id="S3.E8.m1.7.7.1.1.3.3.3.3.3.2" xref="S3.E8.m1.7.7.1.1.3.3.3.3.3.2.cmml">H</mi><mi id="S3.E8.m1.7.7.1.1.3.3.3.3.3.3" xref="S3.E8.m1.7.7.1.1.3.3.3.3.3.3.cmml">h</mi></msub><mo id="S3.E8.m1.7.7.1.1.3.3.3.3.8" xref="S3.E8.m1.7.7.1.1.3.3.4.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E8.m1.7.7.1.1.3.4" xref="S3.E8.m1.7.7.1.1.3.4.cmml">​</mo><msup id="S3.E8.m1.7.7.1.1.3.5" xref="S3.E8.m1.7.7.1.1.3.5.cmml"><mi id="S3.E8.m1.7.7.1.1.3.5.2" xref="S3.E8.m1.7.7.1.1.3.5.2.cmml">W</mi><mi id="S3.E8.m1.7.7.1.1.3.5.3" xref="S3.E8.m1.7.7.1.1.3.5.3.cmml">O</mi></msup></mrow></mrow><mo id="S3.E8.m1.7.7.1.2" xref="S3.E8.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.7b"><apply id="S3.E8.m1.7.7.1.1.cmml" xref="S3.E8.m1.7.7.1"><and id="S3.E8.m1.7.7.1.1a.cmml" xref="S3.E8.m1.7.7.1"></and><apply id="S3.E8.m1.7.7.1.1b.cmml" xref="S3.E8.m1.7.7.1"><eq id="S3.E8.m1.7.7.1.1.6.cmml" xref="S3.E8.m1.7.7.1.1.6"></eq><apply id="S3.E8.m1.7.7.1.1.5.cmml" xref="S3.E8.m1.7.7.1.1.5"><csymbol cd="ambiguous" id="S3.E8.m1.7.7.1.1.5.1.cmml" xref="S3.E8.m1.7.7.1.1.5">subscript</csymbol><ci id="S3.E8.m1.7.7.1.1.5.2.cmml" xref="S3.E8.m1.7.7.1.1.5.2">𝑍</ci><ci id="S3.E8.m1.7.7.1.1.5.3.cmml" xref="S3.E8.m1.7.7.1.1.5.3">𝐻</ci></apply><apply id="S3.E8.m1.7.7.1.1.7.1.cmml" xref="S3.E8.m1.7.7.1.1.7.2"><ci id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1">MultiHead</ci><ci id="S3.E8.m1.2.2.cmml" xref="S3.E8.m1.2.2">𝑄</ci><ci id="S3.E8.m1.3.3.cmml" xref="S3.E8.m1.3.3">𝐾</ci><ci id="S3.E8.m1.4.4.cmml" xref="S3.E8.m1.4.4">𝑉</ci></apply></apply><apply id="S3.E8.m1.7.7.1.1c.cmml" xref="S3.E8.m1.7.7.1"><eq id="S3.E8.m1.7.7.1.1.8.cmml" xref="S3.E8.m1.7.7.1.1.8"></eq><share href="#S3.E8.m1.7.7.1.1.7.cmml" id="S3.E8.m1.7.7.1.1d.cmml" xref="S3.E8.m1.7.7.1"></share><apply id="S3.E8.m1.7.7.1.1.3.cmml" xref="S3.E8.m1.7.7.1.1.3"><times id="S3.E8.m1.7.7.1.1.3.4.cmml" xref="S3.E8.m1.7.7.1.1.3.4"></times><apply id="S3.E8.m1.7.7.1.1.3.3.4.cmml" xref="S3.E8.m1.7.7.1.1.3.3.3"><ci id="S3.E8.m1.5.5.cmml" xref="S3.E8.m1.5.5">Concat</ci><apply id="S3.E8.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.7.7.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.7.7.1.1.1.1.1.1.1.2">𝐻</ci><cn type="integer" id="S3.E8.m1.7.7.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.7.7.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.E8.m1.7.7.1.1.2.2.2.2.2.cmml" xref="S3.E8.m1.7.7.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.7.7.1.1.2.2.2.2.2.1.cmml" xref="S3.E8.m1.7.7.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.E8.m1.7.7.1.1.2.2.2.2.2.2.cmml" xref="S3.E8.m1.7.7.1.1.2.2.2.2.2.2">𝐻</ci><cn type="integer" id="S3.E8.m1.7.7.1.1.2.2.2.2.2.3.cmml" xref="S3.E8.m1.7.7.1.1.2.2.2.2.2.3">2</cn></apply><ci id="S3.E8.m1.6.6.cmml" xref="S3.E8.m1.6.6">…</ci><apply id="S3.E8.m1.7.7.1.1.3.3.3.3.3.cmml" xref="S3.E8.m1.7.7.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.7.7.1.1.3.3.3.3.3.1.cmml" xref="S3.E8.m1.7.7.1.1.3.3.3.3.3">subscript</csymbol><ci id="S3.E8.m1.7.7.1.1.3.3.3.3.3.2.cmml" xref="S3.E8.m1.7.7.1.1.3.3.3.3.3.2">𝐻</ci><ci id="S3.E8.m1.7.7.1.1.3.3.3.3.3.3.cmml" xref="S3.E8.m1.7.7.1.1.3.3.3.3.3.3">ℎ</ci></apply></apply><apply id="S3.E8.m1.7.7.1.1.3.5.cmml" xref="S3.E8.m1.7.7.1.1.3.5"><csymbol cd="ambiguous" id="S3.E8.m1.7.7.1.1.3.5.1.cmml" xref="S3.E8.m1.7.7.1.1.3.5">superscript</csymbol><ci id="S3.E8.m1.7.7.1.1.3.5.2.cmml" xref="S3.E8.m1.7.7.1.1.3.5.2">𝑊</ci><ci id="S3.E8.m1.7.7.1.1.3.5.3.cmml" xref="S3.E8.m1.7.7.1.1.3.5.3">𝑂</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.7c">Z_{H}=\operatorname{MultiHead}(Q,K,V)=\operatorname{Concat}\left(H_{1},H_{2},\ldots,H_{h}\right)W^{O},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS3.p2.25" class="ltx_p">where each head <math id="S3.SS2.SSS3.p2.21.m1.1" class="ltx_Math" alttext="H_{h}" display="inline"><semantics id="S3.SS2.SSS3.p2.21.m1.1a"><msub id="S3.SS2.SSS3.p2.21.m1.1.1" xref="S3.SS2.SSS3.p2.21.m1.1.1.cmml"><mi id="S3.SS2.SSS3.p2.21.m1.1.1.2" xref="S3.SS2.SSS3.p2.21.m1.1.1.2.cmml">H</mi><mi id="S3.SS2.SSS3.p2.21.m1.1.1.3" xref="S3.SS2.SSS3.p2.21.m1.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.21.m1.1b"><apply id="S3.SS2.SSS3.p2.21.m1.1.1.cmml" xref="S3.SS2.SSS3.p2.21.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.21.m1.1.1.1.cmml" xref="S3.SS2.SSS3.p2.21.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p2.21.m1.1.1.2.cmml" xref="S3.SS2.SSS3.p2.21.m1.1.1.2">𝐻</ci><ci id="S3.SS2.SSS3.p2.21.m1.1.1.3.cmml" xref="S3.SS2.SSS3.p2.21.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.21.m1.1c">H_{h}</annotation></semantics></math> represents <math id="S3.SS2.SSS3.p2.22.m2.1" class="ltx_Math" alttext="h-th" display="inline"><semantics id="S3.SS2.SSS3.p2.22.m2.1a"><mrow id="S3.SS2.SSS3.p2.22.m2.1.1" xref="S3.SS2.SSS3.p2.22.m2.1.1.cmml"><mi id="S3.SS2.SSS3.p2.22.m2.1.1.2" xref="S3.SS2.SSS3.p2.22.m2.1.1.2.cmml">h</mi><mo id="S3.SS2.SSS3.p2.22.m2.1.1.1" xref="S3.SS2.SSS3.p2.22.m2.1.1.1.cmml">−</mo><mrow id="S3.SS2.SSS3.p2.22.m2.1.1.3" xref="S3.SS2.SSS3.p2.22.m2.1.1.3.cmml"><mi id="S3.SS2.SSS3.p2.22.m2.1.1.3.2" xref="S3.SS2.SSS3.p2.22.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p2.22.m2.1.1.3.1" xref="S3.SS2.SSS3.p2.22.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p2.22.m2.1.1.3.3" xref="S3.SS2.SSS3.p2.22.m2.1.1.3.3.cmml">h</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.22.m2.1b"><apply id="S3.SS2.SSS3.p2.22.m2.1.1.cmml" xref="S3.SS2.SSS3.p2.22.m2.1.1"><minus id="S3.SS2.SSS3.p2.22.m2.1.1.1.cmml" xref="S3.SS2.SSS3.p2.22.m2.1.1.1"></minus><ci id="S3.SS2.SSS3.p2.22.m2.1.1.2.cmml" xref="S3.SS2.SSS3.p2.22.m2.1.1.2">ℎ</ci><apply id="S3.SS2.SSS3.p2.22.m2.1.1.3.cmml" xref="S3.SS2.SSS3.p2.22.m2.1.1.3"><times id="S3.SS2.SSS3.p2.22.m2.1.1.3.1.cmml" xref="S3.SS2.SSS3.p2.22.m2.1.1.3.1"></times><ci id="S3.SS2.SSS3.p2.22.m2.1.1.3.2.cmml" xref="S3.SS2.SSS3.p2.22.m2.1.1.3.2">𝑡</ci><ci id="S3.SS2.SSS3.p2.22.m2.1.1.3.3.cmml" xref="S3.SS2.SSS3.p2.22.m2.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.22.m2.1c">h-th</annotation></semantics></math> single self-attention module computing by the following equation, where <math id="S3.SS2.SSS3.p2.23.m3.1" class="ltx_Math" alttext="\sqrt{d_{k}}" display="inline"><semantics id="S3.SS2.SSS3.p2.23.m3.1a"><msqrt id="S3.SS2.SSS3.p2.23.m3.1.1" xref="S3.SS2.SSS3.p2.23.m3.1.1.cmml"><msub id="S3.SS2.SSS3.p2.23.m3.1.1.2" xref="S3.SS2.SSS3.p2.23.m3.1.1.2.cmml"><mi id="S3.SS2.SSS3.p2.23.m3.1.1.2.2" xref="S3.SS2.SSS3.p2.23.m3.1.1.2.2.cmml">d</mi><mi id="S3.SS2.SSS3.p2.23.m3.1.1.2.3" xref="S3.SS2.SSS3.p2.23.m3.1.1.2.3.cmml">k</mi></msub></msqrt><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.23.m3.1b"><apply id="S3.SS2.SSS3.p2.23.m3.1.1.cmml" xref="S3.SS2.SSS3.p2.23.m3.1.1"><root id="S3.SS2.SSS3.p2.23.m3.1.1a.cmml" xref="S3.SS2.SSS3.p2.23.m3.1.1"></root><apply id="S3.SS2.SSS3.p2.23.m3.1.1.2.cmml" xref="S3.SS2.SSS3.p2.23.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.23.m3.1.1.2.1.cmml" xref="S3.SS2.SSS3.p2.23.m3.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS3.p2.23.m3.1.1.2.2.cmml" xref="S3.SS2.SSS3.p2.23.m3.1.1.2.2">𝑑</ci><ci id="S3.SS2.SSS3.p2.23.m3.1.1.2.3.cmml" xref="S3.SS2.SSS3.p2.23.m3.1.1.2.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.23.m3.1c">\sqrt{d_{k}}</annotation></semantics></math> is used to scale <math id="S3.SS2.SSS3.p2.24.m4.1" class="ltx_Math" alttext="QK^{T}" display="inline"><semantics id="S3.SS2.SSS3.p2.24.m4.1a"><mrow id="S3.SS2.SSS3.p2.24.m4.1.1" xref="S3.SS2.SSS3.p2.24.m4.1.1.cmml"><mi id="S3.SS2.SSS3.p2.24.m4.1.1.2" xref="S3.SS2.SSS3.p2.24.m4.1.1.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p2.24.m4.1.1.1" xref="S3.SS2.SSS3.p2.24.m4.1.1.1.cmml">​</mo><msup id="S3.SS2.SSS3.p2.24.m4.1.1.3" xref="S3.SS2.SSS3.p2.24.m4.1.1.3.cmml"><mi id="S3.SS2.SSS3.p2.24.m4.1.1.3.2" xref="S3.SS2.SSS3.p2.24.m4.1.1.3.2.cmml">K</mi><mi id="S3.SS2.SSS3.p2.24.m4.1.1.3.3" xref="S3.SS2.SSS3.p2.24.m4.1.1.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.24.m4.1b"><apply id="S3.SS2.SSS3.p2.24.m4.1.1.cmml" xref="S3.SS2.SSS3.p2.24.m4.1.1"><times id="S3.SS2.SSS3.p2.24.m4.1.1.1.cmml" xref="S3.SS2.SSS3.p2.24.m4.1.1.1"></times><ci id="S3.SS2.SSS3.p2.24.m4.1.1.2.cmml" xref="S3.SS2.SSS3.p2.24.m4.1.1.2">𝑄</ci><apply id="S3.SS2.SSS3.p2.24.m4.1.1.3.cmml" xref="S3.SS2.SSS3.p2.24.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.24.m4.1.1.3.1.cmml" xref="S3.SS2.SSS3.p2.24.m4.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS3.p2.24.m4.1.1.3.2.cmml" xref="S3.SS2.SSS3.p2.24.m4.1.1.3.2">𝐾</ci><ci id="S3.SS2.SSS3.p2.24.m4.1.1.3.3.cmml" xref="S3.SS2.SSS3.p2.24.m4.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.24.m4.1c">QK^{T}</annotation></semantics></math> to prevent them from becoming too large, and <math id="S3.SS2.SSS3.p2.25.m5.1" class="ltx_Math" alttext="W^{O}" display="inline"><semantics id="S3.SS2.SSS3.p2.25.m5.1a"><msup id="S3.SS2.SSS3.p2.25.m5.1.1" xref="S3.SS2.SSS3.p2.25.m5.1.1.cmml"><mi id="S3.SS2.SSS3.p2.25.m5.1.1.2" xref="S3.SS2.SSS3.p2.25.m5.1.1.2.cmml">W</mi><mi id="S3.SS2.SSS3.p2.25.m5.1.1.3" xref="S3.SS2.SSS3.p2.25.m5.1.1.3.cmml">O</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.25.m5.1b"><apply id="S3.SS2.SSS3.p2.25.m5.1.1.cmml" xref="S3.SS2.SSS3.p2.25.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.25.m5.1.1.1.cmml" xref="S3.SS2.SSS3.p2.25.m5.1.1">superscript</csymbol><ci id="S3.SS2.SSS3.p2.25.m5.1.1.2.cmml" xref="S3.SS2.SSS3.p2.25.m5.1.1.2">𝑊</ci><ci id="S3.SS2.SSS3.p2.25.m5.1.1.3.cmml" xref="S3.SS2.SSS3.p2.25.m5.1.1.3">𝑂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.25.m5.1c">W^{O}</annotation></semantics></math> is the weight matrix for the multi-head outputs.</p>
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E9.m1.3" class="ltx_Math" alttext="H_{h}=\operatorname{softmax}\left(\frac{Q_{h}K_{h}^{T}}{\sqrt{d_{k}}}\right)V_{h}," display="block"><semantics id="S3.E9.m1.3a"><mrow id="S3.E9.m1.3.3.1" xref="S3.E9.m1.3.3.1.1.cmml"><mrow id="S3.E9.m1.3.3.1.1" xref="S3.E9.m1.3.3.1.1.cmml"><msub id="S3.E9.m1.3.3.1.1.2" xref="S3.E9.m1.3.3.1.1.2.cmml"><mi id="S3.E9.m1.3.3.1.1.2.2" xref="S3.E9.m1.3.3.1.1.2.2.cmml">H</mi><mi id="S3.E9.m1.3.3.1.1.2.3" xref="S3.E9.m1.3.3.1.1.2.3.cmml">h</mi></msub><mo id="S3.E9.m1.3.3.1.1.1" xref="S3.E9.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E9.m1.3.3.1.1.3" xref="S3.E9.m1.3.3.1.1.3.cmml"><mrow id="S3.E9.m1.3.3.1.1.3.2.2" xref="S3.E9.m1.3.3.1.1.3.2.1.cmml"><mi id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml">softmax</mi><mo id="S3.E9.m1.3.3.1.1.3.2.2a" xref="S3.E9.m1.3.3.1.1.3.2.1.cmml">⁡</mo><mrow id="S3.E9.m1.3.3.1.1.3.2.2.1" xref="S3.E9.m1.3.3.1.1.3.2.1.cmml"><mo id="S3.E9.m1.3.3.1.1.3.2.2.1.1" xref="S3.E9.m1.3.3.1.1.3.2.1.cmml">(</mo><mfrac id="S3.E9.m1.2.2" xref="S3.E9.m1.2.2.cmml"><mrow id="S3.E9.m1.2.2.2" xref="S3.E9.m1.2.2.2.cmml"><msub id="S3.E9.m1.2.2.2.2" xref="S3.E9.m1.2.2.2.2.cmml"><mi id="S3.E9.m1.2.2.2.2.2" xref="S3.E9.m1.2.2.2.2.2.cmml">Q</mi><mi id="S3.E9.m1.2.2.2.2.3" xref="S3.E9.m1.2.2.2.2.3.cmml">h</mi></msub><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.2.2.1" xref="S3.E9.m1.2.2.2.1.cmml">​</mo><msubsup id="S3.E9.m1.2.2.2.3" xref="S3.E9.m1.2.2.2.3.cmml"><mi id="S3.E9.m1.2.2.2.3.2.2" xref="S3.E9.m1.2.2.2.3.2.2.cmml">K</mi><mi id="S3.E9.m1.2.2.2.3.2.3" xref="S3.E9.m1.2.2.2.3.2.3.cmml">h</mi><mi id="S3.E9.m1.2.2.2.3.3" xref="S3.E9.m1.2.2.2.3.3.cmml">T</mi></msubsup></mrow><msqrt id="S3.E9.m1.2.2.3" xref="S3.E9.m1.2.2.3.cmml"><msub id="S3.E9.m1.2.2.3.2" xref="S3.E9.m1.2.2.3.2.cmml"><mi id="S3.E9.m1.2.2.3.2.2" xref="S3.E9.m1.2.2.3.2.2.cmml">d</mi><mi id="S3.E9.m1.2.2.3.2.3" xref="S3.E9.m1.2.2.3.2.3.cmml">k</mi></msub></msqrt></mfrac><mo id="S3.E9.m1.3.3.1.1.3.2.2.1.2" xref="S3.E9.m1.3.3.1.1.3.2.1.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E9.m1.3.3.1.1.3.1" xref="S3.E9.m1.3.3.1.1.3.1.cmml">​</mo><msub id="S3.E9.m1.3.3.1.1.3.3" xref="S3.E9.m1.3.3.1.1.3.3.cmml"><mi id="S3.E9.m1.3.3.1.1.3.3.2" xref="S3.E9.m1.3.3.1.1.3.3.2.cmml">V</mi><mi id="S3.E9.m1.3.3.1.1.3.3.3" xref="S3.E9.m1.3.3.1.1.3.3.3.cmml">h</mi></msub></mrow></mrow><mo id="S3.E9.m1.3.3.1.2" xref="S3.E9.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.3b"><apply id="S3.E9.m1.3.3.1.1.cmml" xref="S3.E9.m1.3.3.1"><eq id="S3.E9.m1.3.3.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.1"></eq><apply id="S3.E9.m1.3.3.1.1.2.cmml" xref="S3.E9.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.2.1.cmml" xref="S3.E9.m1.3.3.1.1.2">subscript</csymbol><ci id="S3.E9.m1.3.3.1.1.2.2.cmml" xref="S3.E9.m1.3.3.1.1.2.2">𝐻</ci><ci id="S3.E9.m1.3.3.1.1.2.3.cmml" xref="S3.E9.m1.3.3.1.1.2.3">ℎ</ci></apply><apply id="S3.E9.m1.3.3.1.1.3.cmml" xref="S3.E9.m1.3.3.1.1.3"><times id="S3.E9.m1.3.3.1.1.3.1.cmml" xref="S3.E9.m1.3.3.1.1.3.1"></times><apply id="S3.E9.m1.3.3.1.1.3.2.1.cmml" xref="S3.E9.m1.3.3.1.1.3.2.2"><ci id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1">softmax</ci><apply id="S3.E9.m1.2.2.cmml" xref="S3.E9.m1.2.2"><divide id="S3.E9.m1.2.2.1.cmml" xref="S3.E9.m1.2.2"></divide><apply id="S3.E9.m1.2.2.2.cmml" xref="S3.E9.m1.2.2.2"><times id="S3.E9.m1.2.2.2.1.cmml" xref="S3.E9.m1.2.2.2.1"></times><apply id="S3.E9.m1.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.2.1.cmml" xref="S3.E9.m1.2.2.2.2">subscript</csymbol><ci id="S3.E9.m1.2.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2.2">𝑄</ci><ci id="S3.E9.m1.2.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.2.3">ℎ</ci></apply><apply id="S3.E9.m1.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.3.1.cmml" xref="S3.E9.m1.2.2.2.3">superscript</csymbol><apply id="S3.E9.m1.2.2.2.3.2.cmml" xref="S3.E9.m1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.3.2.1.cmml" xref="S3.E9.m1.2.2.2.3">subscript</csymbol><ci id="S3.E9.m1.2.2.2.3.2.2.cmml" xref="S3.E9.m1.2.2.2.3.2.2">𝐾</ci><ci id="S3.E9.m1.2.2.2.3.2.3.cmml" xref="S3.E9.m1.2.2.2.3.2.3">ℎ</ci></apply><ci id="S3.E9.m1.2.2.2.3.3.cmml" xref="S3.E9.m1.2.2.2.3.3">𝑇</ci></apply></apply><apply id="S3.E9.m1.2.2.3.cmml" xref="S3.E9.m1.2.2.3"><root id="S3.E9.m1.2.2.3a.cmml" xref="S3.E9.m1.2.2.3"></root><apply id="S3.E9.m1.2.2.3.2.cmml" xref="S3.E9.m1.2.2.3.2"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.3.2.1.cmml" xref="S3.E9.m1.2.2.3.2">subscript</csymbol><ci id="S3.E9.m1.2.2.3.2.2.cmml" xref="S3.E9.m1.2.2.3.2.2">𝑑</ci><ci id="S3.E9.m1.2.2.3.2.3.cmml" xref="S3.E9.m1.2.2.3.2.3">𝑘</ci></apply></apply></apply></apply><apply id="S3.E9.m1.3.3.1.1.3.3.cmml" xref="S3.E9.m1.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.3.3.1.cmml" xref="S3.E9.m1.3.3.1.1.3.3">subscript</csymbol><ci id="S3.E9.m1.3.3.1.1.3.3.2.cmml" xref="S3.E9.m1.3.3.1.1.3.3.2">𝑉</ci><ci id="S3.E9.m1.3.3.1.1.3.3.3.cmml" xref="S3.E9.m1.3.3.1.1.3.3.3">ℎ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.3c">H_{h}=\operatorname{softmax}\left(\frac{Q_{h}K_{h}^{T}}{\sqrt{d_{k}}}\right)V_{h},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS3.p2.27" class="ltx_p">Utilize T-cascaded encoder models to extract the relationships among the previously obtained input local feature sequences,the final output sequence <math id="S3.SS2.SSS3.p2.26.m1.1" class="ltx_Math" alttext="F_{Trans}\in\mathbb{R}^{(N+1)\times D}" display="inline"><semantics id="S3.SS2.SSS3.p2.26.m1.1a"><mrow id="S3.SS2.SSS3.p2.26.m1.1.2" xref="S3.SS2.SSS3.p2.26.m1.1.2.cmml"><msub id="S3.SS2.SSS3.p2.26.m1.1.2.2" xref="S3.SS2.SSS3.p2.26.m1.1.2.2.cmml"><mi id="S3.SS2.SSS3.p2.26.m1.1.2.2.2" xref="S3.SS2.SSS3.p2.26.m1.1.2.2.2.cmml">F</mi><mrow id="S3.SS2.SSS3.p2.26.m1.1.2.2.3" xref="S3.SS2.SSS3.p2.26.m1.1.2.2.3.cmml"><mi id="S3.SS2.SSS3.p2.26.m1.1.2.2.3.2" xref="S3.SS2.SSS3.p2.26.m1.1.2.2.3.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p2.26.m1.1.2.2.3.1" xref="S3.SS2.SSS3.p2.26.m1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p2.26.m1.1.2.2.3.3" xref="S3.SS2.SSS3.p2.26.m1.1.2.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p2.26.m1.1.2.2.3.1a" xref="S3.SS2.SSS3.p2.26.m1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p2.26.m1.1.2.2.3.4" xref="S3.SS2.SSS3.p2.26.m1.1.2.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p2.26.m1.1.2.2.3.1b" xref="S3.SS2.SSS3.p2.26.m1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p2.26.m1.1.2.2.3.5" xref="S3.SS2.SSS3.p2.26.m1.1.2.2.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p2.26.m1.1.2.2.3.1c" xref="S3.SS2.SSS3.p2.26.m1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p2.26.m1.1.2.2.3.6" xref="S3.SS2.SSS3.p2.26.m1.1.2.2.3.6.cmml">s</mi></mrow></msub><mo id="S3.SS2.SSS3.p2.26.m1.1.2.1" xref="S3.SS2.SSS3.p2.26.m1.1.2.1.cmml">∈</mo><msup id="S3.SS2.SSS3.p2.26.m1.1.2.3" xref="S3.SS2.SSS3.p2.26.m1.1.2.3.cmml"><mi id="S3.SS2.SSS3.p2.26.m1.1.2.3.2" xref="S3.SS2.SSS3.p2.26.m1.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS3.p2.26.m1.1.1.1" xref="S3.SS2.SSS3.p2.26.m1.1.1.1.cmml"><mrow id="S3.SS2.SSS3.p2.26.m1.1.1.1.1.1" xref="S3.SS2.SSS3.p2.26.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS3.p2.26.m1.1.1.1.1.1.2" xref="S3.SS2.SSS3.p2.26.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS3.p2.26.m1.1.1.1.1.1.1" xref="S3.SS2.SSS3.p2.26.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS3.p2.26.m1.1.1.1.1.1.1.2" xref="S3.SS2.SSS3.p2.26.m1.1.1.1.1.1.1.2.cmml">N</mi><mo id="S3.SS2.SSS3.p2.26.m1.1.1.1.1.1.1.1" xref="S3.SS2.SSS3.p2.26.m1.1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS2.SSS3.p2.26.m1.1.1.1.1.1.1.3" xref="S3.SS2.SSS3.p2.26.m1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo rspace="0.055em" stretchy="false" id="S3.SS2.SSS3.p2.26.m1.1.1.1.1.1.3" xref="S3.SS2.SSS3.p2.26.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.SS2.SSS3.p2.26.m1.1.1.1.2" xref="S3.SS2.SSS3.p2.26.m1.1.1.1.2.cmml">×</mo><mi id="S3.SS2.SSS3.p2.26.m1.1.1.1.3" xref="S3.SS2.SSS3.p2.26.m1.1.1.1.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.26.m1.1b"><apply id="S3.SS2.SSS3.p2.26.m1.1.2.cmml" xref="S3.SS2.SSS3.p2.26.m1.1.2"><in id="S3.SS2.SSS3.p2.26.m1.1.2.1.cmml" xref="S3.SS2.SSS3.p2.26.m1.1.2.1"></in><apply id="S3.SS2.SSS3.p2.26.m1.1.2.2.cmml" xref="S3.SS2.SSS3.p2.26.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.26.m1.1.2.2.1.cmml" xref="S3.SS2.SSS3.p2.26.m1.1.2.2">subscript</csymbol><ci id="S3.SS2.SSS3.p2.26.m1.1.2.2.2.cmml" xref="S3.SS2.SSS3.p2.26.m1.1.2.2.2">𝐹</ci><apply id="S3.SS2.SSS3.p2.26.m1.1.2.2.3.cmml" xref="S3.SS2.SSS3.p2.26.m1.1.2.2.3"><times id="S3.SS2.SSS3.p2.26.m1.1.2.2.3.1.cmml" xref="S3.SS2.SSS3.p2.26.m1.1.2.2.3.1"></times><ci id="S3.SS2.SSS3.p2.26.m1.1.2.2.3.2.cmml" xref="S3.SS2.SSS3.p2.26.m1.1.2.2.3.2">𝑇</ci><ci id="S3.SS2.SSS3.p2.26.m1.1.2.2.3.3.cmml" xref="S3.SS2.SSS3.p2.26.m1.1.2.2.3.3">𝑟</ci><ci id="S3.SS2.SSS3.p2.26.m1.1.2.2.3.4.cmml" xref="S3.SS2.SSS3.p2.26.m1.1.2.2.3.4">𝑎</ci><ci id="S3.SS2.SSS3.p2.26.m1.1.2.2.3.5.cmml" xref="S3.SS2.SSS3.p2.26.m1.1.2.2.3.5">𝑛</ci><ci id="S3.SS2.SSS3.p2.26.m1.1.2.2.3.6.cmml" xref="S3.SS2.SSS3.p2.26.m1.1.2.2.3.6">𝑠</ci></apply></apply><apply id="S3.SS2.SSS3.p2.26.m1.1.2.3.cmml" xref="S3.SS2.SSS3.p2.26.m1.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.26.m1.1.2.3.1.cmml" xref="S3.SS2.SSS3.p2.26.m1.1.2.3">superscript</csymbol><ci id="S3.SS2.SSS3.p2.26.m1.1.2.3.2.cmml" xref="S3.SS2.SSS3.p2.26.m1.1.2.3.2">ℝ</ci><apply id="S3.SS2.SSS3.p2.26.m1.1.1.1.cmml" xref="S3.SS2.SSS3.p2.26.m1.1.1.1"><times id="S3.SS2.SSS3.p2.26.m1.1.1.1.2.cmml" xref="S3.SS2.SSS3.p2.26.m1.1.1.1.2"></times><apply id="S3.SS2.SSS3.p2.26.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p2.26.m1.1.1.1.1.1"><plus id="S3.SS2.SSS3.p2.26.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p2.26.m1.1.1.1.1.1.1.1"></plus><ci id="S3.SS2.SSS3.p2.26.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS3.p2.26.m1.1.1.1.1.1.1.2">𝑁</ci><cn type="integer" id="S3.SS2.SSS3.p2.26.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS3.p2.26.m1.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.SS2.SSS3.p2.26.m1.1.1.1.3.cmml" xref="S3.SS2.SSS3.p2.26.m1.1.1.1.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.26.m1.1c">F_{Trans}\in\mathbb{R}^{(N+1)\times D}</annotation></semantics></math> includes the classification token <math id="S3.SS2.SSS3.p2.27.m2.1" class="ltx_Math" alttext="f_{cls}^{out}" display="inline"><semantics id="S3.SS2.SSS3.p2.27.m2.1a"><msubsup id="S3.SS2.SSS3.p2.27.m2.1.1" xref="S3.SS2.SSS3.p2.27.m2.1.1.cmml"><mi id="S3.SS2.SSS3.p2.27.m2.1.1.2.2" xref="S3.SS2.SSS3.p2.27.m2.1.1.2.2.cmml">f</mi><mrow id="S3.SS2.SSS3.p2.27.m2.1.1.2.3" xref="S3.SS2.SSS3.p2.27.m2.1.1.2.3.cmml"><mi id="S3.SS2.SSS3.p2.27.m2.1.1.2.3.2" xref="S3.SS2.SSS3.p2.27.m2.1.1.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p2.27.m2.1.1.2.3.1" xref="S3.SS2.SSS3.p2.27.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p2.27.m2.1.1.2.3.3" xref="S3.SS2.SSS3.p2.27.m2.1.1.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p2.27.m2.1.1.2.3.1a" xref="S3.SS2.SSS3.p2.27.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p2.27.m2.1.1.2.3.4" xref="S3.SS2.SSS3.p2.27.m2.1.1.2.3.4.cmml">s</mi></mrow><mrow id="S3.SS2.SSS3.p2.27.m2.1.1.3" xref="S3.SS2.SSS3.p2.27.m2.1.1.3.cmml"><mi id="S3.SS2.SSS3.p2.27.m2.1.1.3.2" xref="S3.SS2.SSS3.p2.27.m2.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p2.27.m2.1.1.3.1" xref="S3.SS2.SSS3.p2.27.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p2.27.m2.1.1.3.3" xref="S3.SS2.SSS3.p2.27.m2.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p2.27.m2.1.1.3.1a" xref="S3.SS2.SSS3.p2.27.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p2.27.m2.1.1.3.4" xref="S3.SS2.SSS3.p2.27.m2.1.1.3.4.cmml">t</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.27.m2.1b"><apply id="S3.SS2.SSS3.p2.27.m2.1.1.cmml" xref="S3.SS2.SSS3.p2.27.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.27.m2.1.1.1.cmml" xref="S3.SS2.SSS3.p2.27.m2.1.1">superscript</csymbol><apply id="S3.SS2.SSS3.p2.27.m2.1.1.2.cmml" xref="S3.SS2.SSS3.p2.27.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.27.m2.1.1.2.1.cmml" xref="S3.SS2.SSS3.p2.27.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p2.27.m2.1.1.2.2.cmml" xref="S3.SS2.SSS3.p2.27.m2.1.1.2.2">𝑓</ci><apply id="S3.SS2.SSS3.p2.27.m2.1.1.2.3.cmml" xref="S3.SS2.SSS3.p2.27.m2.1.1.2.3"><times id="S3.SS2.SSS3.p2.27.m2.1.1.2.3.1.cmml" xref="S3.SS2.SSS3.p2.27.m2.1.1.2.3.1"></times><ci id="S3.SS2.SSS3.p2.27.m2.1.1.2.3.2.cmml" xref="S3.SS2.SSS3.p2.27.m2.1.1.2.3.2">𝑐</ci><ci id="S3.SS2.SSS3.p2.27.m2.1.1.2.3.3.cmml" xref="S3.SS2.SSS3.p2.27.m2.1.1.2.3.3">𝑙</ci><ci id="S3.SS2.SSS3.p2.27.m2.1.1.2.3.4.cmml" xref="S3.SS2.SSS3.p2.27.m2.1.1.2.3.4">𝑠</ci></apply></apply><apply id="S3.SS2.SSS3.p2.27.m2.1.1.3.cmml" xref="S3.SS2.SSS3.p2.27.m2.1.1.3"><times id="S3.SS2.SSS3.p2.27.m2.1.1.3.1.cmml" xref="S3.SS2.SSS3.p2.27.m2.1.1.3.1"></times><ci id="S3.SS2.SSS3.p2.27.m2.1.1.3.2.cmml" xref="S3.SS2.SSS3.p2.27.m2.1.1.3.2">𝑜</ci><ci id="S3.SS2.SSS3.p2.27.m2.1.1.3.3.cmml" xref="S3.SS2.SSS3.p2.27.m2.1.1.3.3">𝑢</ci><ci id="S3.SS2.SSS3.p2.27.m2.1.1.3.4.cmml" xref="S3.SS2.SSS3.p2.27.m2.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.27.m2.1c">f_{cls}^{out}</annotation></semantics></math>, which represents the global feature of the entire image:</p>
<table id="S3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E10.m1.2" class="ltx_Math" alttext="F_{Trans}=\left[f_{1}^{\text{out }},f_{2}^{\text{out }},\ldots,f_{N}^{\text{out }},f_{\text{cls }}^{\text{out }}\right]." display="block"><semantics id="S3.E10.m1.2a"><mrow id="S3.E10.m1.2.2.1" xref="S3.E10.m1.2.2.1.1.cmml"><mrow id="S3.E10.m1.2.2.1.1" xref="S3.E10.m1.2.2.1.1.cmml"><msub id="S3.E10.m1.2.2.1.1.6" xref="S3.E10.m1.2.2.1.1.6.cmml"><mi id="S3.E10.m1.2.2.1.1.6.2" xref="S3.E10.m1.2.2.1.1.6.2.cmml">F</mi><mrow id="S3.E10.m1.2.2.1.1.6.3" xref="S3.E10.m1.2.2.1.1.6.3.cmml"><mi id="S3.E10.m1.2.2.1.1.6.3.2" xref="S3.E10.m1.2.2.1.1.6.3.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.1.6.3.1" xref="S3.E10.m1.2.2.1.1.6.3.1.cmml">​</mo><mi id="S3.E10.m1.2.2.1.1.6.3.3" xref="S3.E10.m1.2.2.1.1.6.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.1.6.3.1a" xref="S3.E10.m1.2.2.1.1.6.3.1.cmml">​</mo><mi id="S3.E10.m1.2.2.1.1.6.3.4" xref="S3.E10.m1.2.2.1.1.6.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.1.6.3.1b" xref="S3.E10.m1.2.2.1.1.6.3.1.cmml">​</mo><mi id="S3.E10.m1.2.2.1.1.6.3.5" xref="S3.E10.m1.2.2.1.1.6.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.1.6.3.1c" xref="S3.E10.m1.2.2.1.1.6.3.1.cmml">​</mo><mi id="S3.E10.m1.2.2.1.1.6.3.6" xref="S3.E10.m1.2.2.1.1.6.3.6.cmml">s</mi></mrow></msub><mo id="S3.E10.m1.2.2.1.1.5" xref="S3.E10.m1.2.2.1.1.5.cmml">=</mo><mrow id="S3.E10.m1.2.2.1.1.4.4" xref="S3.E10.m1.2.2.1.1.4.5.cmml"><mo id="S3.E10.m1.2.2.1.1.4.4.5" xref="S3.E10.m1.2.2.1.1.4.5.cmml">[</mo><msubsup id="S3.E10.m1.2.2.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.E10.m1.2.2.1.1.1.1.1.2.2" xref="S3.E10.m1.2.2.1.1.1.1.1.2.2.cmml">f</mi><mn id="S3.E10.m1.2.2.1.1.1.1.1.2.3" xref="S3.E10.m1.2.2.1.1.1.1.1.2.3.cmml">1</mn><mtext id="S3.E10.m1.2.2.1.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.1.1.3a.cmml">out </mtext></msubsup><mo id="S3.E10.m1.2.2.1.1.4.4.6" xref="S3.E10.m1.2.2.1.1.4.5.cmml">,</mo><msubsup id="S3.E10.m1.2.2.1.1.2.2.2" xref="S3.E10.m1.2.2.1.1.2.2.2.cmml"><mi id="S3.E10.m1.2.2.1.1.2.2.2.2.2" xref="S3.E10.m1.2.2.1.1.2.2.2.2.2.cmml">f</mi><mn id="S3.E10.m1.2.2.1.1.2.2.2.2.3" xref="S3.E10.m1.2.2.1.1.2.2.2.2.3.cmml">2</mn><mtext id="S3.E10.m1.2.2.1.1.2.2.2.3" xref="S3.E10.m1.2.2.1.1.2.2.2.3a.cmml">out </mtext></msubsup><mo id="S3.E10.m1.2.2.1.1.4.4.7" xref="S3.E10.m1.2.2.1.1.4.5.cmml">,</mo><mi mathvariant="normal" id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml">…</mi><mo id="S3.E10.m1.2.2.1.1.4.4.8" xref="S3.E10.m1.2.2.1.1.4.5.cmml">,</mo><msubsup id="S3.E10.m1.2.2.1.1.3.3.3" xref="S3.E10.m1.2.2.1.1.3.3.3.cmml"><mi id="S3.E10.m1.2.2.1.1.3.3.3.2.2" xref="S3.E10.m1.2.2.1.1.3.3.3.2.2.cmml">f</mi><mi id="S3.E10.m1.2.2.1.1.3.3.3.2.3" xref="S3.E10.m1.2.2.1.1.3.3.3.2.3.cmml">N</mi><mtext id="S3.E10.m1.2.2.1.1.3.3.3.3" xref="S3.E10.m1.2.2.1.1.3.3.3.3a.cmml">out </mtext></msubsup><mo id="S3.E10.m1.2.2.1.1.4.4.9" xref="S3.E10.m1.2.2.1.1.4.5.cmml">,</mo><msubsup id="S3.E10.m1.2.2.1.1.4.4.4" xref="S3.E10.m1.2.2.1.1.4.4.4.cmml"><mi id="S3.E10.m1.2.2.1.1.4.4.4.2.2" xref="S3.E10.m1.2.2.1.1.4.4.4.2.2.cmml">f</mi><mtext id="S3.E10.m1.2.2.1.1.4.4.4.2.3" xref="S3.E10.m1.2.2.1.1.4.4.4.2.3a.cmml">cls </mtext><mtext id="S3.E10.m1.2.2.1.1.4.4.4.3" xref="S3.E10.m1.2.2.1.1.4.4.4.3a.cmml">out </mtext></msubsup><mo id="S3.E10.m1.2.2.1.1.4.4.10" xref="S3.E10.m1.2.2.1.1.4.5.cmml">]</mo></mrow></mrow><mo lspace="0em" id="S3.E10.m1.2.2.1.2" xref="S3.E10.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.2b"><apply id="S3.E10.m1.2.2.1.1.cmml" xref="S3.E10.m1.2.2.1"><eq id="S3.E10.m1.2.2.1.1.5.cmml" xref="S3.E10.m1.2.2.1.1.5"></eq><apply id="S3.E10.m1.2.2.1.1.6.cmml" xref="S3.E10.m1.2.2.1.1.6"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.6.1.cmml" xref="S3.E10.m1.2.2.1.1.6">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.6.2.cmml" xref="S3.E10.m1.2.2.1.1.6.2">𝐹</ci><apply id="S3.E10.m1.2.2.1.1.6.3.cmml" xref="S3.E10.m1.2.2.1.1.6.3"><times id="S3.E10.m1.2.2.1.1.6.3.1.cmml" xref="S3.E10.m1.2.2.1.1.6.3.1"></times><ci id="S3.E10.m1.2.2.1.1.6.3.2.cmml" xref="S3.E10.m1.2.2.1.1.6.3.2">𝑇</ci><ci id="S3.E10.m1.2.2.1.1.6.3.3.cmml" xref="S3.E10.m1.2.2.1.1.6.3.3">𝑟</ci><ci id="S3.E10.m1.2.2.1.1.6.3.4.cmml" xref="S3.E10.m1.2.2.1.1.6.3.4">𝑎</ci><ci id="S3.E10.m1.2.2.1.1.6.3.5.cmml" xref="S3.E10.m1.2.2.1.1.6.3.5">𝑛</ci><ci id="S3.E10.m1.2.2.1.1.6.3.6.cmml" xref="S3.E10.m1.2.2.1.1.6.3.6">𝑠</ci></apply></apply><list id="S3.E10.m1.2.2.1.1.4.5.cmml" xref="S3.E10.m1.2.2.1.1.4.4"><apply id="S3.E10.m1.2.2.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1">superscript</csymbol><apply id="S3.E10.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.2.2">𝑓</ci><cn type="integer" id="S3.E10.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.2.3">1</cn></apply><ci id="S3.E10.m1.2.2.1.1.1.1.1.3a.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.3"><mtext mathsize="70%" id="S3.E10.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.3">out </mtext></ci></apply><apply id="S3.E10.m1.2.2.1.1.2.2.2.cmml" xref="S3.E10.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.2.2.2.1.cmml" xref="S3.E10.m1.2.2.1.1.2.2.2">superscript</csymbol><apply id="S3.E10.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E10.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E10.m1.2.2.1.1.2.2.2">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E10.m1.2.2.1.1.2.2.2.2.2">𝑓</ci><cn type="integer" id="S3.E10.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E10.m1.2.2.1.1.2.2.2.2.3">2</cn></apply><ci id="S3.E10.m1.2.2.1.1.2.2.2.3a.cmml" xref="S3.E10.m1.2.2.1.1.2.2.2.3"><mtext mathsize="70%" id="S3.E10.m1.2.2.1.1.2.2.2.3.cmml" xref="S3.E10.m1.2.2.1.1.2.2.2.3">out </mtext></ci></apply><ci id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1">…</ci><apply id="S3.E10.m1.2.2.1.1.3.3.3.cmml" xref="S3.E10.m1.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.3.3.3.1.cmml" xref="S3.E10.m1.2.2.1.1.3.3.3">superscript</csymbol><apply id="S3.E10.m1.2.2.1.1.3.3.3.2.cmml" xref="S3.E10.m1.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.3.3.3.2.1.cmml" xref="S3.E10.m1.2.2.1.1.3.3.3">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.3.3.3.2.2.cmml" xref="S3.E10.m1.2.2.1.1.3.3.3.2.2">𝑓</ci><ci id="S3.E10.m1.2.2.1.1.3.3.3.2.3.cmml" xref="S3.E10.m1.2.2.1.1.3.3.3.2.3">𝑁</ci></apply><ci id="S3.E10.m1.2.2.1.1.3.3.3.3a.cmml" xref="S3.E10.m1.2.2.1.1.3.3.3.3"><mtext mathsize="70%" id="S3.E10.m1.2.2.1.1.3.3.3.3.cmml" xref="S3.E10.m1.2.2.1.1.3.3.3.3">out </mtext></ci></apply><apply id="S3.E10.m1.2.2.1.1.4.4.4.cmml" xref="S3.E10.m1.2.2.1.1.4.4.4"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.4.4.4.1.cmml" xref="S3.E10.m1.2.2.1.1.4.4.4">superscript</csymbol><apply id="S3.E10.m1.2.2.1.1.4.4.4.2.cmml" xref="S3.E10.m1.2.2.1.1.4.4.4"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.4.4.4.2.1.cmml" xref="S3.E10.m1.2.2.1.1.4.4.4">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.4.4.4.2.2.cmml" xref="S3.E10.m1.2.2.1.1.4.4.4.2.2">𝑓</ci><ci id="S3.E10.m1.2.2.1.1.4.4.4.2.3a.cmml" xref="S3.E10.m1.2.2.1.1.4.4.4.2.3"><mtext mathsize="70%" id="S3.E10.m1.2.2.1.1.4.4.4.2.3.cmml" xref="S3.E10.m1.2.2.1.1.4.4.4.2.3">cls </mtext></ci></apply><ci id="S3.E10.m1.2.2.1.1.4.4.4.3a.cmml" xref="S3.E10.m1.2.2.1.1.4.4.4.3"><mtext mathsize="70%" id="S3.E10.m1.2.2.1.1.4.4.4.3.cmml" xref="S3.E10.m1.2.2.1.1.4.4.4.3">out </mtext></ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.2c">F_{Trans}=\left[f_{1}^{\text{out }},f_{2}^{\text{out }},\ldots,f_{N}^{\text{out }},f_{\text{cls }}^{\text{out }}\right].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS3.p2.29" class="ltx_p">where <math id="S3.SS2.SSS3.p2.28.m1.1" class="ltx_Math" alttext="f_{1}^{\text{out}}" display="inline"><semantics id="S3.SS2.SSS3.p2.28.m1.1a"><msubsup id="S3.SS2.SSS3.p2.28.m1.1.1" xref="S3.SS2.SSS3.p2.28.m1.1.1.cmml"><mi id="S3.SS2.SSS3.p2.28.m1.1.1.2.2" xref="S3.SS2.SSS3.p2.28.m1.1.1.2.2.cmml">f</mi><mn id="S3.SS2.SSS3.p2.28.m1.1.1.2.3" xref="S3.SS2.SSS3.p2.28.m1.1.1.2.3.cmml">1</mn><mtext id="S3.SS2.SSS3.p2.28.m1.1.1.3" xref="S3.SS2.SSS3.p2.28.m1.1.1.3a.cmml">out</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.28.m1.1b"><apply id="S3.SS2.SSS3.p2.28.m1.1.1.cmml" xref="S3.SS2.SSS3.p2.28.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.28.m1.1.1.1.cmml" xref="S3.SS2.SSS3.p2.28.m1.1.1">superscript</csymbol><apply id="S3.SS2.SSS3.p2.28.m1.1.1.2.cmml" xref="S3.SS2.SSS3.p2.28.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.28.m1.1.1.2.1.cmml" xref="S3.SS2.SSS3.p2.28.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p2.28.m1.1.1.2.2.cmml" xref="S3.SS2.SSS3.p2.28.m1.1.1.2.2">𝑓</ci><cn type="integer" id="S3.SS2.SSS3.p2.28.m1.1.1.2.3.cmml" xref="S3.SS2.SSS3.p2.28.m1.1.1.2.3">1</cn></apply><ci id="S3.SS2.SSS3.p2.28.m1.1.1.3a.cmml" xref="S3.SS2.SSS3.p2.28.m1.1.1.3"><mtext mathsize="70%" id="S3.SS2.SSS3.p2.28.m1.1.1.3.cmml" xref="S3.SS2.SSS3.p2.28.m1.1.1.3">out</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.28.m1.1c">f_{1}^{\text{out}}</annotation></semantics></math> is the output representation of <math id="S3.SS2.SSS3.p2.29.m2.1" class="ltx_Math" alttext="f_{1}^{\text{patch}}" display="inline"><semantics id="S3.SS2.SSS3.p2.29.m2.1a"><msubsup id="S3.SS2.SSS3.p2.29.m2.1.1" xref="S3.SS2.SSS3.p2.29.m2.1.1.cmml"><mi id="S3.SS2.SSS3.p2.29.m2.1.1.2.2" xref="S3.SS2.SSS3.p2.29.m2.1.1.2.2.cmml">f</mi><mn id="S3.SS2.SSS3.p2.29.m2.1.1.2.3" xref="S3.SS2.SSS3.p2.29.m2.1.1.2.3.cmml">1</mn><mtext id="S3.SS2.SSS3.p2.29.m2.1.1.3" xref="S3.SS2.SSS3.p2.29.m2.1.1.3a.cmml">patch</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.29.m2.1b"><apply id="S3.SS2.SSS3.p2.29.m2.1.1.cmml" xref="S3.SS2.SSS3.p2.29.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.29.m2.1.1.1.cmml" xref="S3.SS2.SSS3.p2.29.m2.1.1">superscript</csymbol><apply id="S3.SS2.SSS3.p2.29.m2.1.1.2.cmml" xref="S3.SS2.SSS3.p2.29.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.29.m2.1.1.2.1.cmml" xref="S3.SS2.SSS3.p2.29.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p2.29.m2.1.1.2.2.cmml" xref="S3.SS2.SSS3.p2.29.m2.1.1.2.2">𝑓</ci><cn type="integer" id="S3.SS2.SSS3.p2.29.m2.1.1.2.3.cmml" xref="S3.SS2.SSS3.p2.29.m2.1.1.2.3">1</cn></apply><ci id="S3.SS2.SSS3.p2.29.m2.1.1.3a.cmml" xref="S3.SS2.SSS3.p2.29.m2.1.1.3"><mtext mathsize="70%" id="S3.SS2.SSS3.p2.29.m2.1.1.3.cmml" xref="S3.SS2.SSS3.p2.29.m2.1.1.3">patch</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.29.m2.1c">f_{1}^{\text{patch}}</annotation></semantics></math> through the Transformer model, and similarly for the others. Using the multi-head self-attention mechanism of the Transformer encoder, the features from different patch blocks are weighted and fused to construct a global image feature representation. The fused features can then be further applied to GCM to extract more discriminative features.</p>
</div>
</section>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Graph Convolutional Module (GCM)</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">To effectively integrate features from different branches, i.e., the affinity field and confidence maps from the pose estimation, the feature maps from ResNet and Transformer, we propose a GCM to combine these features and produce a comprehensive feature representation for Person Re-Identification.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.5" class="ltx_p">First, for the outputs of pose estimation, the affinity field <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">L</annotation></semantics></math> and confidence maps <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><mi id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">S</annotation></semantics></math> are used to construct node and edge features for the graph. The specific steps are as follows: 1) Node Features Initialization: Initialize node features <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="H_{S}\in\mathbb{R}^{k\times j}" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><mrow id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><msub id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2.2" xref="S3.SS3.p2.3.m3.1.1.2.2.cmml">H</mi><mi id="S3.SS3.p2.3.m3.1.1.2.3" xref="S3.SS3.p2.3.m3.1.1.2.3.cmml">S</mi></msub><mo id="S3.SS3.p2.3.m3.1.1.1" xref="S3.SS3.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml"><mi id="S3.SS3.p2.3.m3.1.1.3.2" xref="S3.SS3.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p2.3.m3.1.1.3.3" xref="S3.SS3.p2.3.m3.1.1.3.3.cmml"><mi id="S3.SS3.p2.3.m3.1.1.3.3.2" xref="S3.SS3.p2.3.m3.1.1.3.3.2.cmml">k</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p2.3.m3.1.1.3.3.1" xref="S3.SS3.p2.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p2.3.m3.1.1.3.3.3" xref="S3.SS3.p2.3.m3.1.1.3.3.3.cmml">j</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><in id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1.1"></in><apply id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.2.1.cmml" xref="S3.SS3.p2.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2.2">𝐻</ci><ci id="S3.SS3.p2.3.m3.1.1.2.3.cmml" xref="S3.SS3.p2.3.m3.1.1.2.3">𝑆</ci></apply><apply id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.3.1.cmml" xref="S3.SS3.p2.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.3.2.cmml" xref="S3.SS3.p2.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS3.p2.3.m3.1.1.3.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3"><times id="S3.SS3.p2.3.m3.1.1.3.3.1.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3.1"></times><ci id="S3.SS3.p2.3.m3.1.1.3.3.2.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3.2">𝑘</ci><ci id="S3.SS3.p2.3.m3.1.1.3.3.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">H_{S}\in\mathbb{R}^{k\times j}</annotation></semantics></math> using the confidence maps <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><mi id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><ci id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">S</annotation></semantics></math>. Each node corresponds to a key point, and the node features <math id="S3.SS3.p2.5.m5.1" class="ltx_Math" alttext="H_{S}" display="inline"><semantics id="S3.SS3.p2.5.m5.1a"><msub id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml"><mi id="S3.SS3.p2.5.m5.1.1.2" xref="S3.SS3.p2.5.m5.1.1.2.cmml">H</mi><mi id="S3.SS3.p2.5.m5.1.1.3" xref="S3.SS3.p2.5.m5.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><apply id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p2.5.m5.1.1.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2">𝐻</ci><ci id="S3.SS3.p2.5.m5.1.1.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">H_{S}</annotation></semantics></math> represent the confidence score of that key point as follows:</p>
<table id="S3.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E11.m1.2" class="ltx_Math" alttext="H_{S}=\operatorname{Normalize}\left(S_{k}^{j}\right)," display="block"><semantics id="S3.E11.m1.2a"><mrow id="S3.E11.m1.2.2.1" xref="S3.E11.m1.2.2.1.1.cmml"><mrow id="S3.E11.m1.2.2.1.1" xref="S3.E11.m1.2.2.1.1.cmml"><msub id="S3.E11.m1.2.2.1.1.3" xref="S3.E11.m1.2.2.1.1.3.cmml"><mi id="S3.E11.m1.2.2.1.1.3.2" xref="S3.E11.m1.2.2.1.1.3.2.cmml">H</mi><mi id="S3.E11.m1.2.2.1.1.3.3" xref="S3.E11.m1.2.2.1.1.3.3.cmml">S</mi></msub><mo id="S3.E11.m1.2.2.1.1.2" xref="S3.E11.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E11.m1.2.2.1.1.1.1" xref="S3.E11.m1.2.2.1.1.1.2.cmml"><mi id="S3.E11.m1.1.1" xref="S3.E11.m1.1.1.cmml">Normalize</mi><mo id="S3.E11.m1.2.2.1.1.1.1a" xref="S3.E11.m1.2.2.1.1.1.2.cmml">⁡</mo><mrow id="S3.E11.m1.2.2.1.1.1.1.1" xref="S3.E11.m1.2.2.1.1.1.2.cmml"><mo id="S3.E11.m1.2.2.1.1.1.1.1.2" xref="S3.E11.m1.2.2.1.1.1.2.cmml">(</mo><msubsup id="S3.E11.m1.2.2.1.1.1.1.1.1" xref="S3.E11.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E11.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.E11.m1.2.2.1.1.1.1.1.1.2.2.cmml">S</mi><mi id="S3.E11.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.E11.m1.2.2.1.1.1.1.1.1.2.3.cmml">k</mi><mi id="S3.E11.m1.2.2.1.1.1.1.1.1.3" xref="S3.E11.m1.2.2.1.1.1.1.1.1.3.cmml">j</mi></msubsup><mo id="S3.E11.m1.2.2.1.1.1.1.1.3" xref="S3.E11.m1.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E11.m1.2.2.1.2" xref="S3.E11.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.2b"><apply id="S3.E11.m1.2.2.1.1.cmml" xref="S3.E11.m1.2.2.1"><eq id="S3.E11.m1.2.2.1.1.2.cmml" xref="S3.E11.m1.2.2.1.1.2"></eq><apply id="S3.E11.m1.2.2.1.1.3.cmml" xref="S3.E11.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.1.1.3.1.cmml" xref="S3.E11.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.E11.m1.2.2.1.1.3.2.cmml" xref="S3.E11.m1.2.2.1.1.3.2">𝐻</ci><ci id="S3.E11.m1.2.2.1.1.3.3.cmml" xref="S3.E11.m1.2.2.1.1.3.3">𝑆</ci></apply><apply id="S3.E11.m1.2.2.1.1.1.2.cmml" xref="S3.E11.m1.2.2.1.1.1.1"><ci id="S3.E11.m1.1.1.cmml" xref="S3.E11.m1.1.1">Normalize</ci><apply id="S3.E11.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E11.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E11.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.2.2">𝑆</ci><ci id="S3.E11.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S3.E11.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.2c">H_{S}=\operatorname{Normalize}\left(S_{k}^{j}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.10" class="ltx_p">where <math id="S3.SS3.p2.6.m1.1" class="ltx_Math" alttext="S_{k}^{j}" display="inline"><semantics id="S3.SS3.p2.6.m1.1a"><msubsup id="S3.SS3.p2.6.m1.1.1" xref="S3.SS3.p2.6.m1.1.1.cmml"><mi id="S3.SS3.p2.6.m1.1.1.2.2" xref="S3.SS3.p2.6.m1.1.1.2.2.cmml">S</mi><mi id="S3.SS3.p2.6.m1.1.1.2.3" xref="S3.SS3.p2.6.m1.1.1.2.3.cmml">k</mi><mi id="S3.SS3.p2.6.m1.1.1.3" xref="S3.SS3.p2.6.m1.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m1.1b"><apply id="S3.SS3.p2.6.m1.1.1.cmml" xref="S3.SS3.p2.6.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m1.1.1.1.cmml" xref="S3.SS3.p2.6.m1.1.1">superscript</csymbol><apply id="S3.SS3.p2.6.m1.1.1.2.cmml" xref="S3.SS3.p2.6.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m1.1.1.2.1.cmml" xref="S3.SS3.p2.6.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.6.m1.1.1.2.2.cmml" xref="S3.SS3.p2.6.m1.1.1.2.2">𝑆</ci><ci id="S3.SS3.p2.6.m1.1.1.2.3.cmml" xref="S3.SS3.p2.6.m1.1.1.2.3">𝑘</ci></apply><ci id="S3.SS3.p2.6.m1.1.1.3.cmml" xref="S3.SS3.p2.6.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m1.1c">S_{k}^{j}</annotation></semantics></math> denotes the confidence score of the <math id="S3.SS3.p2.7.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p2.7.m2.1a"><mi id="S3.SS3.p2.7.m2.1.1" xref="S3.SS3.p2.7.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m2.1b"><ci id="S3.SS3.p2.7.m2.1.1.cmml" xref="S3.SS3.p2.7.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m2.1c">k</annotation></semantics></math>-th key point at the <math id="S3.SS3.p2.8.m3.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS3.p2.8.m3.1a"><mi id="S3.SS3.p2.8.m3.1.1" xref="S3.SS3.p2.8.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m3.1b"><ci id="S3.SS3.p2.8.m3.1.1.cmml" xref="S3.SS3.p2.8.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m3.1c">j</annotation></semantics></math>-th location. Edge Feature Initialization: Initialize edge features <math id="S3.SS3.p2.9.m4.1" class="ltx_Math" alttext="H_{L}\in\mathbb{R}^{k\times k}" display="inline"><semantics id="S3.SS3.p2.9.m4.1a"><mrow id="S3.SS3.p2.9.m4.1.1" xref="S3.SS3.p2.9.m4.1.1.cmml"><msub id="S3.SS3.p2.9.m4.1.1.2" xref="S3.SS3.p2.9.m4.1.1.2.cmml"><mi id="S3.SS3.p2.9.m4.1.1.2.2" xref="S3.SS3.p2.9.m4.1.1.2.2.cmml">H</mi><mi id="S3.SS3.p2.9.m4.1.1.2.3" xref="S3.SS3.p2.9.m4.1.1.2.3.cmml">L</mi></msub><mo id="S3.SS3.p2.9.m4.1.1.1" xref="S3.SS3.p2.9.m4.1.1.1.cmml">∈</mo><msup id="S3.SS3.p2.9.m4.1.1.3" xref="S3.SS3.p2.9.m4.1.1.3.cmml"><mi id="S3.SS3.p2.9.m4.1.1.3.2" xref="S3.SS3.p2.9.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p2.9.m4.1.1.3.3" xref="S3.SS3.p2.9.m4.1.1.3.3.cmml"><mi id="S3.SS3.p2.9.m4.1.1.3.3.2" xref="S3.SS3.p2.9.m4.1.1.3.3.2.cmml">k</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p2.9.m4.1.1.3.3.1" xref="S3.SS3.p2.9.m4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p2.9.m4.1.1.3.3.3" xref="S3.SS3.p2.9.m4.1.1.3.3.3.cmml">k</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.9.m4.1b"><apply id="S3.SS3.p2.9.m4.1.1.cmml" xref="S3.SS3.p2.9.m4.1.1"><in id="S3.SS3.p2.9.m4.1.1.1.cmml" xref="S3.SS3.p2.9.m4.1.1.1"></in><apply id="S3.SS3.p2.9.m4.1.1.2.cmml" xref="S3.SS3.p2.9.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.9.m4.1.1.2.1.cmml" xref="S3.SS3.p2.9.m4.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.9.m4.1.1.2.2.cmml" xref="S3.SS3.p2.9.m4.1.1.2.2">𝐻</ci><ci id="S3.SS3.p2.9.m4.1.1.2.3.cmml" xref="S3.SS3.p2.9.m4.1.1.2.3">𝐿</ci></apply><apply id="S3.SS3.p2.9.m4.1.1.3.cmml" xref="S3.SS3.p2.9.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.9.m4.1.1.3.1.cmml" xref="S3.SS3.p2.9.m4.1.1.3">superscript</csymbol><ci id="S3.SS3.p2.9.m4.1.1.3.2.cmml" xref="S3.SS3.p2.9.m4.1.1.3.2">ℝ</ci><apply id="S3.SS3.p2.9.m4.1.1.3.3.cmml" xref="S3.SS3.p2.9.m4.1.1.3.3"><times id="S3.SS3.p2.9.m4.1.1.3.3.1.cmml" xref="S3.SS3.p2.9.m4.1.1.3.3.1"></times><ci id="S3.SS3.p2.9.m4.1.1.3.3.2.cmml" xref="S3.SS3.p2.9.m4.1.1.3.3.2">𝑘</ci><ci id="S3.SS3.p2.9.m4.1.1.3.3.3.cmml" xref="S3.SS3.p2.9.m4.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m4.1c">H_{L}\in\mathbb{R}^{k\times k}</annotation></semantics></math> using the affinity field <math id="S3.SS3.p2.10.m5.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS3.p2.10.m5.1a"><mi id="S3.SS3.p2.10.m5.1.1" xref="S3.SS3.p2.10.m5.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.10.m5.1b"><ci id="S3.SS3.p2.10.m5.1.1.cmml" xref="S3.SS3.p2.10.m5.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.10.m5.1c">L</annotation></semantics></math>. Each edge represents the degree of association between key points.</p>
<table id="S3.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E12.m1.2" class="ltx_Math" alttext="H_{L}=\operatorname{Normalize}\left(L_{ij}\right)," display="block"><semantics id="S3.E12.m1.2a"><mrow id="S3.E12.m1.2.2.1" xref="S3.E12.m1.2.2.1.1.cmml"><mrow id="S3.E12.m1.2.2.1.1" xref="S3.E12.m1.2.2.1.1.cmml"><msub id="S3.E12.m1.2.2.1.1.3" xref="S3.E12.m1.2.2.1.1.3.cmml"><mi id="S3.E12.m1.2.2.1.1.3.2" xref="S3.E12.m1.2.2.1.1.3.2.cmml">H</mi><mi id="S3.E12.m1.2.2.1.1.3.3" xref="S3.E12.m1.2.2.1.1.3.3.cmml">L</mi></msub><mo id="S3.E12.m1.2.2.1.1.2" xref="S3.E12.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E12.m1.2.2.1.1.1.1" xref="S3.E12.m1.2.2.1.1.1.2.cmml"><mi id="S3.E12.m1.1.1" xref="S3.E12.m1.1.1.cmml">Normalize</mi><mo id="S3.E12.m1.2.2.1.1.1.1a" xref="S3.E12.m1.2.2.1.1.1.2.cmml">⁡</mo><mrow id="S3.E12.m1.2.2.1.1.1.1.1" xref="S3.E12.m1.2.2.1.1.1.2.cmml"><mo id="S3.E12.m1.2.2.1.1.1.1.1.2" xref="S3.E12.m1.2.2.1.1.1.2.cmml">(</mo><msub id="S3.E12.m1.2.2.1.1.1.1.1.1" xref="S3.E12.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E12.m1.2.2.1.1.1.1.1.1.2" xref="S3.E12.m1.2.2.1.1.1.1.1.1.2.cmml">L</mi><mrow id="S3.E12.m1.2.2.1.1.1.1.1.1.3" xref="S3.E12.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E12.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.E12.m1.2.2.1.1.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.2.2.1.1.1.1.1.1.3.1" xref="S3.E12.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E12.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E12.m1.2.2.1.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S3.E12.m1.2.2.1.1.1.1.1.3" xref="S3.E12.m1.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E12.m1.2.2.1.2" xref="S3.E12.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.2b"><apply id="S3.E12.m1.2.2.1.1.cmml" xref="S3.E12.m1.2.2.1"><eq id="S3.E12.m1.2.2.1.1.2.cmml" xref="S3.E12.m1.2.2.1.1.2"></eq><apply id="S3.E12.m1.2.2.1.1.3.cmml" xref="S3.E12.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.1.1.3.1.cmml" xref="S3.E12.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.E12.m1.2.2.1.1.3.2.cmml" xref="S3.E12.m1.2.2.1.1.3.2">𝐻</ci><ci id="S3.E12.m1.2.2.1.1.3.3.cmml" xref="S3.E12.m1.2.2.1.1.3.3">𝐿</ci></apply><apply id="S3.E12.m1.2.2.1.1.1.2.cmml" xref="S3.E12.m1.2.2.1.1.1.1"><ci id="S3.E12.m1.1.1.cmml" xref="S3.E12.m1.1.1">Normalize</ci><apply id="S3.E12.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E12.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E12.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.2.2.1.1.1.1.1.1.2">𝐿</ci><apply id="S3.E12.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.2.2.1.1.1.1.1.1.3"><times id="S3.E12.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E12.m1.2.2.1.1.1.1.1.1.3.1"></times><ci id="S3.E12.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E12.m1.2.2.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.E12.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E12.m1.2.2.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.2c">H_{L}=\operatorname{Normalize}\left(L_{ij}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.13" class="ltx_p">where <math id="S3.SS3.p2.11.m1.1" class="ltx_Math" alttext="L_{ij}" display="inline"><semantics id="S3.SS3.p2.11.m1.1a"><msub id="S3.SS3.p2.11.m1.1.1" xref="S3.SS3.p2.11.m1.1.1.cmml"><mi id="S3.SS3.p2.11.m1.1.1.2" xref="S3.SS3.p2.11.m1.1.1.2.cmml">L</mi><mrow id="S3.SS3.p2.11.m1.1.1.3" xref="S3.SS3.p2.11.m1.1.1.3.cmml"><mi id="S3.SS3.p2.11.m1.1.1.3.2" xref="S3.SS3.p2.11.m1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.11.m1.1.1.3.1" xref="S3.SS3.p2.11.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.11.m1.1.1.3.3" xref="S3.SS3.p2.11.m1.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.11.m1.1b"><apply id="S3.SS3.p2.11.m1.1.1.cmml" xref="S3.SS3.p2.11.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.11.m1.1.1.1.cmml" xref="S3.SS3.p2.11.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.11.m1.1.1.2.cmml" xref="S3.SS3.p2.11.m1.1.1.2">𝐿</ci><apply id="S3.SS3.p2.11.m1.1.1.3.cmml" xref="S3.SS3.p2.11.m1.1.1.3"><times id="S3.SS3.p2.11.m1.1.1.3.1.cmml" xref="S3.SS3.p2.11.m1.1.1.3.1"></times><ci id="S3.SS3.p2.11.m1.1.1.3.2.cmml" xref="S3.SS3.p2.11.m1.1.1.3.2">𝑖</ci><ci id="S3.SS3.p2.11.m1.1.1.3.3.cmml" xref="S3.SS3.p2.11.m1.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.11.m1.1c">L_{ij}</annotation></semantics></math> represents the affinity score between the <math id="S3.SS3.p2.12.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p2.12.m2.1a"><mi id="S3.SS3.p2.12.m2.1.1" xref="S3.SS3.p2.12.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.12.m2.1b"><ci id="S3.SS3.p2.12.m2.1.1.cmml" xref="S3.SS3.p2.12.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.12.m2.1c">i</annotation></semantics></math>-th and <math id="S3.SS3.p2.13.m3.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS3.p2.13.m3.1a"><mi id="S3.SS3.p2.13.m3.1.1" xref="S3.SS3.p2.13.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.13.m3.1b"><ci id="S3.SS3.p2.13.m3.1.1.cmml" xref="S3.SS3.p2.13.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.13.m3.1c">j</annotation></semantics></math>-th key points.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.2" class="ltx_p">Second, we process the feature maps from ResNet and Transformer to obtain features suitable for the graph neural network.
ResNet Feature Maps: Convert the feature map <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="F_{Res}\in\mathbb{R}^{k\times d_{Res}}" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><mrow id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><msub id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml"><mi id="S3.SS3.p3.1.m1.1.1.2.2" xref="S3.SS3.p3.1.m1.1.1.2.2.cmml">F</mi><mrow id="S3.SS3.p3.1.m1.1.1.2.3" xref="S3.SS3.p3.1.m1.1.1.2.3.cmml"><mi id="S3.SS3.p3.1.m1.1.1.2.3.2" xref="S3.SS3.p3.1.m1.1.1.2.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.1.m1.1.1.2.3.1" xref="S3.SS3.p3.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p3.1.m1.1.1.2.3.3" xref="S3.SS3.p3.1.m1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.1.m1.1.1.2.3.1a" xref="S3.SS3.p3.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p3.1.m1.1.1.2.3.4" xref="S3.SS3.p3.1.m1.1.1.2.3.4.cmml">s</mi></mrow></msub><mo id="S3.SS3.p3.1.m1.1.1.1" xref="S3.SS3.p3.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml"><mi id="S3.SS3.p3.1.m1.1.1.3.2" xref="S3.SS3.p3.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p3.1.m1.1.1.3.3" xref="S3.SS3.p3.1.m1.1.1.3.3.cmml"><mi id="S3.SS3.p3.1.m1.1.1.3.3.2" xref="S3.SS3.p3.1.m1.1.1.3.3.2.cmml">k</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p3.1.m1.1.1.3.3.1" xref="S3.SS3.p3.1.m1.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.p3.1.m1.1.1.3.3.3" xref="S3.SS3.p3.1.m1.1.1.3.3.3.cmml"><mi id="S3.SS3.p3.1.m1.1.1.3.3.3.2" xref="S3.SS3.p3.1.m1.1.1.3.3.3.2.cmml">d</mi><mrow id="S3.SS3.p3.1.m1.1.1.3.3.3.3" xref="S3.SS3.p3.1.m1.1.1.3.3.3.3.cmml"><mi id="S3.SS3.p3.1.m1.1.1.3.3.3.3.2" xref="S3.SS3.p3.1.m1.1.1.3.3.3.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.1.m1.1.1.3.3.3.3.1" xref="S3.SS3.p3.1.m1.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.SS3.p3.1.m1.1.1.3.3.3.3.3" xref="S3.SS3.p3.1.m1.1.1.3.3.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.1.m1.1.1.3.3.3.3.1a" xref="S3.SS3.p3.1.m1.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.SS3.p3.1.m1.1.1.3.3.3.3.4" xref="S3.SS3.p3.1.m1.1.1.3.3.3.3.4.cmml">s</mi></mrow></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><in id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1.1"></in><apply id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.2.1.cmml" xref="S3.SS3.p3.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.2.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2.2">𝐹</ci><apply id="S3.SS3.p3.1.m1.1.1.2.3.cmml" xref="S3.SS3.p3.1.m1.1.1.2.3"><times id="S3.SS3.p3.1.m1.1.1.2.3.1.cmml" xref="S3.SS3.p3.1.m1.1.1.2.3.1"></times><ci id="S3.SS3.p3.1.m1.1.1.2.3.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2.3.2">𝑅</ci><ci id="S3.SS3.p3.1.m1.1.1.2.3.3.cmml" xref="S3.SS3.p3.1.m1.1.1.2.3.3">𝑒</ci><ci id="S3.SS3.p3.1.m1.1.1.2.3.4.cmml" xref="S3.SS3.p3.1.m1.1.1.2.3.4">𝑠</ci></apply></apply><apply id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.3.1.cmml" xref="S3.SS3.p3.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.3.2.cmml" xref="S3.SS3.p3.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS3.p3.1.m1.1.1.3.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3.3"><times id="S3.SS3.p3.1.m1.1.1.3.3.1.cmml" xref="S3.SS3.p3.1.m1.1.1.3.3.1"></times><ci id="S3.SS3.p3.1.m1.1.1.3.3.2.cmml" xref="S3.SS3.p3.1.m1.1.1.3.3.2">𝑘</ci><apply id="S3.SS3.p3.1.m1.1.1.3.3.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.3.3.3.1.cmml" xref="S3.SS3.p3.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.3.3.3.2.cmml" xref="S3.SS3.p3.1.m1.1.1.3.3.3.2">𝑑</ci><apply id="S3.SS3.p3.1.m1.1.1.3.3.3.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3.3.3.3"><times id="S3.SS3.p3.1.m1.1.1.3.3.3.3.1.cmml" xref="S3.SS3.p3.1.m1.1.1.3.3.3.3.1"></times><ci id="S3.SS3.p3.1.m1.1.1.3.3.3.3.2.cmml" xref="S3.SS3.p3.1.m1.1.1.3.3.3.3.2">𝑅</ci><ci id="S3.SS3.p3.1.m1.1.1.3.3.3.3.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3.3.3.3.3">𝑒</ci><ci id="S3.SS3.p3.1.m1.1.1.3.3.3.3.4.cmml" xref="S3.SS3.p3.1.m1.1.1.3.3.3.3.4">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">F_{Res}\in\mathbb{R}^{k\times d_{Res}}</annotation></semantics></math> into node features <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="H_{Res}" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><msub id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml"><mi id="S3.SS3.p3.2.m2.1.1.2" xref="S3.SS3.p3.2.m2.1.1.2.cmml">H</mi><mrow id="S3.SS3.p3.2.m2.1.1.3" xref="S3.SS3.p3.2.m2.1.1.3.cmml"><mi id="S3.SS3.p3.2.m2.1.1.3.2" xref="S3.SS3.p3.2.m2.1.1.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.2.m2.1.1.3.1" xref="S3.SS3.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p3.2.m2.1.1.3.3" xref="S3.SS3.p3.2.m2.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.2.m2.1.1.3.1a" xref="S3.SS3.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p3.2.m2.1.1.3.4" xref="S3.SS3.p3.2.m2.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2">𝐻</ci><apply id="S3.SS3.p3.2.m2.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3"><times id="S3.SS3.p3.2.m2.1.1.3.1.cmml" xref="S3.SS3.p3.2.m2.1.1.3.1"></times><ci id="S3.SS3.p3.2.m2.1.1.3.2.cmml" xref="S3.SS3.p3.2.m2.1.1.3.2">𝑅</ci><ci id="S3.SS3.p3.2.m2.1.1.3.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3.3">𝑒</ci><ci id="S3.SS3.p3.2.m2.1.1.3.4.cmml" xref="S3.SS3.p3.2.m2.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">H_{Res}</annotation></semantics></math> via convolutional operations.</p>
<table id="S3.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E13.m1.1" class="ltx_Math" alttext="H_{\text{Res }}=\operatorname{Conv}_{\text{Res }}\left(F_{Res}\right)." display="block"><semantics id="S3.E13.m1.1a"><mrow id="S3.E13.m1.1.1.1" xref="S3.E13.m1.1.1.1.1.cmml"><mrow id="S3.E13.m1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.cmml"><msub id="S3.E13.m1.1.1.1.1.4" xref="S3.E13.m1.1.1.1.1.4.cmml"><mi id="S3.E13.m1.1.1.1.1.4.2" xref="S3.E13.m1.1.1.1.1.4.2.cmml">H</mi><mtext id="S3.E13.m1.1.1.1.1.4.3" xref="S3.E13.m1.1.1.1.1.4.3a.cmml">Res </mtext></msub><mo id="S3.E13.m1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.3.cmml">=</mo><mrow id="S3.E13.m1.1.1.1.1.2.2" xref="S3.E13.m1.1.1.1.1.2.3.cmml"><msub id="S3.E13.m1.1.1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E13.m1.1.1.1.1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.1.1.1.2.cmml">Conv</mi><mtext id="S3.E13.m1.1.1.1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.1.1.1.3a.cmml">Res </mtext></msub><mo id="S3.E13.m1.1.1.1.1.2.2a" xref="S3.E13.m1.1.1.1.1.2.3.cmml">⁡</mo><mrow id="S3.E13.m1.1.1.1.1.2.2.2" xref="S3.E13.m1.1.1.1.1.2.3.cmml"><mo id="S3.E13.m1.1.1.1.1.2.2.2.2" xref="S3.E13.m1.1.1.1.1.2.3.cmml">(</mo><msub id="S3.E13.m1.1.1.1.1.2.2.2.1" xref="S3.E13.m1.1.1.1.1.2.2.2.1.cmml"><mi id="S3.E13.m1.1.1.1.1.2.2.2.1.2" xref="S3.E13.m1.1.1.1.1.2.2.2.1.2.cmml">F</mi><mrow id="S3.E13.m1.1.1.1.1.2.2.2.1.3" xref="S3.E13.m1.1.1.1.1.2.2.2.1.3.cmml"><mi id="S3.E13.m1.1.1.1.1.2.2.2.1.3.2" xref="S3.E13.m1.1.1.1.1.2.2.2.1.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.2.2.2.1.3.1" xref="S3.E13.m1.1.1.1.1.2.2.2.1.3.1.cmml">​</mo><mi id="S3.E13.m1.1.1.1.1.2.2.2.1.3.3" xref="S3.E13.m1.1.1.1.1.2.2.2.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.2.2.2.1.3.1a" xref="S3.E13.m1.1.1.1.1.2.2.2.1.3.1.cmml">​</mo><mi id="S3.E13.m1.1.1.1.1.2.2.2.1.3.4" xref="S3.E13.m1.1.1.1.1.2.2.2.1.3.4.cmml">s</mi></mrow></msub><mo id="S3.E13.m1.1.1.1.1.2.2.2.3" xref="S3.E13.m1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E13.m1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.1b"><apply id="S3.E13.m1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1"><eq id="S3.E13.m1.1.1.1.1.3.cmml" xref="S3.E13.m1.1.1.1.1.3"></eq><apply id="S3.E13.m1.1.1.1.1.4.cmml" xref="S3.E13.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.4.1.cmml" xref="S3.E13.m1.1.1.1.1.4">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.4.2.cmml" xref="S3.E13.m1.1.1.1.1.4.2">𝐻</ci><ci id="S3.E13.m1.1.1.1.1.4.3a.cmml" xref="S3.E13.m1.1.1.1.1.4.3"><mtext mathsize="70%" id="S3.E13.m1.1.1.1.1.4.3.cmml" xref="S3.E13.m1.1.1.1.1.4.3">Res </mtext></ci></apply><apply id="S3.E13.m1.1.1.1.1.2.3.cmml" xref="S3.E13.m1.1.1.1.1.2.2"><apply id="S3.E13.m1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.2">Conv</ci><ci id="S3.E13.m1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S3.E13.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.3">Res </mtext></ci></apply><apply id="S3.E13.m1.1.1.1.1.2.2.2.1.cmml" xref="S3.E13.m1.1.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.2.2.2.1.1.cmml" xref="S3.E13.m1.1.1.1.1.2.2.2.1">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.2.2.2.1.2.cmml" xref="S3.E13.m1.1.1.1.1.2.2.2.1.2">𝐹</ci><apply id="S3.E13.m1.1.1.1.1.2.2.2.1.3.cmml" xref="S3.E13.m1.1.1.1.1.2.2.2.1.3"><times id="S3.E13.m1.1.1.1.1.2.2.2.1.3.1.cmml" xref="S3.E13.m1.1.1.1.1.2.2.2.1.3.1"></times><ci id="S3.E13.m1.1.1.1.1.2.2.2.1.3.2.cmml" xref="S3.E13.m1.1.1.1.1.2.2.2.1.3.2">𝑅</ci><ci id="S3.E13.m1.1.1.1.1.2.2.2.1.3.3.cmml" xref="S3.E13.m1.1.1.1.1.2.2.2.1.3.3">𝑒</ci><ci id="S3.E13.m1.1.1.1.1.2.2.2.1.3.4.cmml" xref="S3.E13.m1.1.1.1.1.2.2.2.1.3.4">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.1c">H_{\text{Res }}=\operatorname{Conv}_{\text{Res }}\left(F_{Res}\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p3.4" class="ltx_p">2) Transformer Feature Maps: Convert the feature map <math id="S3.SS3.p3.3.m1.1" class="ltx_Math" alttext="F_{Trans}" display="inline"><semantics id="S3.SS3.p3.3.m1.1a"><msub id="S3.SS3.p3.3.m1.1.1" xref="S3.SS3.p3.3.m1.1.1.cmml"><mi id="S3.SS3.p3.3.m1.1.1.2" xref="S3.SS3.p3.3.m1.1.1.2.cmml">F</mi><mrow id="S3.SS3.p3.3.m1.1.1.3" xref="S3.SS3.p3.3.m1.1.1.3.cmml"><mi id="S3.SS3.p3.3.m1.1.1.3.2" xref="S3.SS3.p3.3.m1.1.1.3.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.3.m1.1.1.3.1" xref="S3.SS3.p3.3.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p3.3.m1.1.1.3.3" xref="S3.SS3.p3.3.m1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.3.m1.1.1.3.1a" xref="S3.SS3.p3.3.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p3.3.m1.1.1.3.4" xref="S3.SS3.p3.3.m1.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.3.m1.1.1.3.1b" xref="S3.SS3.p3.3.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p3.3.m1.1.1.3.5" xref="S3.SS3.p3.3.m1.1.1.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.3.m1.1.1.3.1c" xref="S3.SS3.p3.3.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p3.3.m1.1.1.3.6" xref="S3.SS3.p3.3.m1.1.1.3.6.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m1.1b"><apply id="S3.SS3.p3.3.m1.1.1.cmml" xref="S3.SS3.p3.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m1.1.1.1.cmml" xref="S3.SS3.p3.3.m1.1.1">subscript</csymbol><ci id="S3.SS3.p3.3.m1.1.1.2.cmml" xref="S3.SS3.p3.3.m1.1.1.2">𝐹</ci><apply id="S3.SS3.p3.3.m1.1.1.3.cmml" xref="S3.SS3.p3.3.m1.1.1.3"><times id="S3.SS3.p3.3.m1.1.1.3.1.cmml" xref="S3.SS3.p3.3.m1.1.1.3.1"></times><ci id="S3.SS3.p3.3.m1.1.1.3.2.cmml" xref="S3.SS3.p3.3.m1.1.1.3.2">𝑇</ci><ci id="S3.SS3.p3.3.m1.1.1.3.3.cmml" xref="S3.SS3.p3.3.m1.1.1.3.3">𝑟</ci><ci id="S3.SS3.p3.3.m1.1.1.3.4.cmml" xref="S3.SS3.p3.3.m1.1.1.3.4">𝑎</ci><ci id="S3.SS3.p3.3.m1.1.1.3.5.cmml" xref="S3.SS3.p3.3.m1.1.1.3.5">𝑛</ci><ci id="S3.SS3.p3.3.m1.1.1.3.6.cmml" xref="S3.SS3.p3.3.m1.1.1.3.6">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m1.1c">F_{Trans}</annotation></semantics></math> into node features <math id="S3.SS3.p3.4.m2.1" class="ltx_Math" alttext="H_{Trans}\in\mathbb{R}^{k\times d_{Trans}}" display="inline"><semantics id="S3.SS3.p3.4.m2.1a"><mrow id="S3.SS3.p3.4.m2.1.1" xref="S3.SS3.p3.4.m2.1.1.cmml"><msub id="S3.SS3.p3.4.m2.1.1.2" xref="S3.SS3.p3.4.m2.1.1.2.cmml"><mi id="S3.SS3.p3.4.m2.1.1.2.2" xref="S3.SS3.p3.4.m2.1.1.2.2.cmml">H</mi><mrow id="S3.SS3.p3.4.m2.1.1.2.3" xref="S3.SS3.p3.4.m2.1.1.2.3.cmml"><mi id="S3.SS3.p3.4.m2.1.1.2.3.2" xref="S3.SS3.p3.4.m2.1.1.2.3.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.4.m2.1.1.2.3.1" xref="S3.SS3.p3.4.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p3.4.m2.1.1.2.3.3" xref="S3.SS3.p3.4.m2.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.4.m2.1.1.2.3.1a" xref="S3.SS3.p3.4.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p3.4.m2.1.1.2.3.4" xref="S3.SS3.p3.4.m2.1.1.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.4.m2.1.1.2.3.1b" xref="S3.SS3.p3.4.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p3.4.m2.1.1.2.3.5" xref="S3.SS3.p3.4.m2.1.1.2.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.4.m2.1.1.2.3.1c" xref="S3.SS3.p3.4.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p3.4.m2.1.1.2.3.6" xref="S3.SS3.p3.4.m2.1.1.2.3.6.cmml">s</mi></mrow></msub><mo id="S3.SS3.p3.4.m2.1.1.1" xref="S3.SS3.p3.4.m2.1.1.1.cmml">∈</mo><msup id="S3.SS3.p3.4.m2.1.1.3" xref="S3.SS3.p3.4.m2.1.1.3.cmml"><mi id="S3.SS3.p3.4.m2.1.1.3.2" xref="S3.SS3.p3.4.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p3.4.m2.1.1.3.3" xref="S3.SS3.p3.4.m2.1.1.3.3.cmml"><mi id="S3.SS3.p3.4.m2.1.1.3.3.2" xref="S3.SS3.p3.4.m2.1.1.3.3.2.cmml">k</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p3.4.m2.1.1.3.3.1" xref="S3.SS3.p3.4.m2.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.p3.4.m2.1.1.3.3.3" xref="S3.SS3.p3.4.m2.1.1.3.3.3.cmml"><mi id="S3.SS3.p3.4.m2.1.1.3.3.3.2" xref="S3.SS3.p3.4.m2.1.1.3.3.3.2.cmml">d</mi><mrow id="S3.SS3.p3.4.m2.1.1.3.3.3.3" xref="S3.SS3.p3.4.m2.1.1.3.3.3.3.cmml"><mi id="S3.SS3.p3.4.m2.1.1.3.3.3.3.2" xref="S3.SS3.p3.4.m2.1.1.3.3.3.3.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.4.m2.1.1.3.3.3.3.1" xref="S3.SS3.p3.4.m2.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.SS3.p3.4.m2.1.1.3.3.3.3.3" xref="S3.SS3.p3.4.m2.1.1.3.3.3.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.4.m2.1.1.3.3.3.3.1a" xref="S3.SS3.p3.4.m2.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.SS3.p3.4.m2.1.1.3.3.3.3.4" xref="S3.SS3.p3.4.m2.1.1.3.3.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.4.m2.1.1.3.3.3.3.1b" xref="S3.SS3.p3.4.m2.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.SS3.p3.4.m2.1.1.3.3.3.3.5" xref="S3.SS3.p3.4.m2.1.1.3.3.3.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.4.m2.1.1.3.3.3.3.1c" xref="S3.SS3.p3.4.m2.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.SS3.p3.4.m2.1.1.3.3.3.3.6" xref="S3.SS3.p3.4.m2.1.1.3.3.3.3.6.cmml">s</mi></mrow></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m2.1b"><apply id="S3.SS3.p3.4.m2.1.1.cmml" xref="S3.SS3.p3.4.m2.1.1"><in id="S3.SS3.p3.4.m2.1.1.1.cmml" xref="S3.SS3.p3.4.m2.1.1.1"></in><apply id="S3.SS3.p3.4.m2.1.1.2.cmml" xref="S3.SS3.p3.4.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m2.1.1.2.1.cmml" xref="S3.SS3.p3.4.m2.1.1.2">subscript</csymbol><ci id="S3.SS3.p3.4.m2.1.1.2.2.cmml" xref="S3.SS3.p3.4.m2.1.1.2.2">𝐻</ci><apply id="S3.SS3.p3.4.m2.1.1.2.3.cmml" xref="S3.SS3.p3.4.m2.1.1.2.3"><times id="S3.SS3.p3.4.m2.1.1.2.3.1.cmml" xref="S3.SS3.p3.4.m2.1.1.2.3.1"></times><ci id="S3.SS3.p3.4.m2.1.1.2.3.2.cmml" xref="S3.SS3.p3.4.m2.1.1.2.3.2">𝑇</ci><ci id="S3.SS3.p3.4.m2.1.1.2.3.3.cmml" xref="S3.SS3.p3.4.m2.1.1.2.3.3">𝑟</ci><ci id="S3.SS3.p3.4.m2.1.1.2.3.4.cmml" xref="S3.SS3.p3.4.m2.1.1.2.3.4">𝑎</ci><ci id="S3.SS3.p3.4.m2.1.1.2.3.5.cmml" xref="S3.SS3.p3.4.m2.1.1.2.3.5">𝑛</ci><ci id="S3.SS3.p3.4.m2.1.1.2.3.6.cmml" xref="S3.SS3.p3.4.m2.1.1.2.3.6">𝑠</ci></apply></apply><apply id="S3.SS3.p3.4.m2.1.1.3.cmml" xref="S3.SS3.p3.4.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m2.1.1.3.1.cmml" xref="S3.SS3.p3.4.m2.1.1.3">superscript</csymbol><ci id="S3.SS3.p3.4.m2.1.1.3.2.cmml" xref="S3.SS3.p3.4.m2.1.1.3.2">ℝ</ci><apply id="S3.SS3.p3.4.m2.1.1.3.3.cmml" xref="S3.SS3.p3.4.m2.1.1.3.3"><times id="S3.SS3.p3.4.m2.1.1.3.3.1.cmml" xref="S3.SS3.p3.4.m2.1.1.3.3.1"></times><ci id="S3.SS3.p3.4.m2.1.1.3.3.2.cmml" xref="S3.SS3.p3.4.m2.1.1.3.3.2">𝑘</ci><apply id="S3.SS3.p3.4.m2.1.1.3.3.3.cmml" xref="S3.SS3.p3.4.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m2.1.1.3.3.3.1.cmml" xref="S3.SS3.p3.4.m2.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.p3.4.m2.1.1.3.3.3.2.cmml" xref="S3.SS3.p3.4.m2.1.1.3.3.3.2">𝑑</ci><apply id="S3.SS3.p3.4.m2.1.1.3.3.3.3.cmml" xref="S3.SS3.p3.4.m2.1.1.3.3.3.3"><times id="S3.SS3.p3.4.m2.1.1.3.3.3.3.1.cmml" xref="S3.SS3.p3.4.m2.1.1.3.3.3.3.1"></times><ci id="S3.SS3.p3.4.m2.1.1.3.3.3.3.2.cmml" xref="S3.SS3.p3.4.m2.1.1.3.3.3.3.2">𝑇</ci><ci id="S3.SS3.p3.4.m2.1.1.3.3.3.3.3.cmml" xref="S3.SS3.p3.4.m2.1.1.3.3.3.3.3">𝑟</ci><ci id="S3.SS3.p3.4.m2.1.1.3.3.3.3.4.cmml" xref="S3.SS3.p3.4.m2.1.1.3.3.3.3.4">𝑎</ci><ci id="S3.SS3.p3.4.m2.1.1.3.3.3.3.5.cmml" xref="S3.SS3.p3.4.m2.1.1.3.3.3.3.5">𝑛</ci><ci id="S3.SS3.p3.4.m2.1.1.3.3.3.3.6.cmml" xref="S3.SS3.p3.4.m2.1.1.3.3.3.3.6">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m2.1c">H_{Trans}\in\mathbb{R}^{k\times d_{Trans}}</annotation></semantics></math> via convolutional operations.</p>
<table id="S3.E14" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E14.m1.1" class="ltx_Math" alttext="H_{\text{Trans }}=\operatorname{Conv}_{\text{Trans }}\left(F_{\text{Trans }}\right)." display="block"><semantics id="S3.E14.m1.1a"><mrow id="S3.E14.m1.1.1.1" xref="S3.E14.m1.1.1.1.1.cmml"><mrow id="S3.E14.m1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.cmml"><msub id="S3.E14.m1.1.1.1.1.4" xref="S3.E14.m1.1.1.1.1.4.cmml"><mi id="S3.E14.m1.1.1.1.1.4.2" xref="S3.E14.m1.1.1.1.1.4.2.cmml">H</mi><mtext id="S3.E14.m1.1.1.1.1.4.3" xref="S3.E14.m1.1.1.1.1.4.3a.cmml">Trans </mtext></msub><mo id="S3.E14.m1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.3.cmml">=</mo><mrow id="S3.E14.m1.1.1.1.1.2.2" xref="S3.E14.m1.1.1.1.1.2.3.cmml"><msub id="S3.E14.m1.1.1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.1.1.1.2.cmml">Conv</mi><mtext id="S3.E14.m1.1.1.1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.1.1.1.3a.cmml">Trans </mtext></msub><mo id="S3.E14.m1.1.1.1.1.2.2a" xref="S3.E14.m1.1.1.1.1.2.3.cmml">⁡</mo><mrow id="S3.E14.m1.1.1.1.1.2.2.2" xref="S3.E14.m1.1.1.1.1.2.3.cmml"><mo id="S3.E14.m1.1.1.1.1.2.2.2.2" xref="S3.E14.m1.1.1.1.1.2.3.cmml">(</mo><msub id="S3.E14.m1.1.1.1.1.2.2.2.1" xref="S3.E14.m1.1.1.1.1.2.2.2.1.cmml"><mi id="S3.E14.m1.1.1.1.1.2.2.2.1.2" xref="S3.E14.m1.1.1.1.1.2.2.2.1.2.cmml">F</mi><mtext id="S3.E14.m1.1.1.1.1.2.2.2.1.3" xref="S3.E14.m1.1.1.1.1.2.2.2.1.3a.cmml">Trans </mtext></msub><mo id="S3.E14.m1.1.1.1.1.2.2.2.3" xref="S3.E14.m1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E14.m1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m1.1b"><apply id="S3.E14.m1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1"><eq id="S3.E14.m1.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.3"></eq><apply id="S3.E14.m1.1.1.1.1.4.cmml" xref="S3.E14.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.4.1.cmml" xref="S3.E14.m1.1.1.1.1.4">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.4.2.cmml" xref="S3.E14.m1.1.1.1.1.4.2">𝐻</ci><ci id="S3.E14.m1.1.1.1.1.4.3a.cmml" xref="S3.E14.m1.1.1.1.1.4.3"><mtext mathsize="70%" id="S3.E14.m1.1.1.1.1.4.3.cmml" xref="S3.E14.m1.1.1.1.1.4.3">Trans </mtext></ci></apply><apply id="S3.E14.m1.1.1.1.1.2.3.cmml" xref="S3.E14.m1.1.1.1.1.2.2"><apply id="S3.E14.m1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.2">Conv</ci><ci id="S3.E14.m1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S3.E14.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.3">Trans </mtext></ci></apply><apply id="S3.E14.m1.1.1.1.1.2.2.2.1.cmml" xref="S3.E14.m1.1.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.2.2.2.1.1.cmml" xref="S3.E14.m1.1.1.1.1.2.2.2.1">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.2.2.2.1.2.cmml" xref="S3.E14.m1.1.1.1.1.2.2.2.1.2">𝐹</ci><ci id="S3.E14.m1.1.1.1.1.2.2.2.1.3a.cmml" xref="S3.E14.m1.1.1.1.1.2.2.2.1.3"><mtext mathsize="70%" id="S3.E14.m1.1.1.1.1.2.2.2.1.3.cmml" xref="S3.E14.m1.1.1.1.1.2.2.2.1.3">Trans </mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.1c">H_{\text{Trans }}=\operatorname{Conv}_{\text{Trans }}\left(F_{\text{Trans }}\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<p id="S3.SS3.p4.2" class="ltx_p">Next, initialize the graph’s node features <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="H_{node}\in\mathbb{R}^{k\times(j+d_{Res}+d_{Trans})}" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><mrow id="S3.SS3.p4.1.m1.1.2" xref="S3.SS3.p4.1.m1.1.2.cmml"><msub id="S3.SS3.p4.1.m1.1.2.2" xref="S3.SS3.p4.1.m1.1.2.2.cmml"><mi id="S3.SS3.p4.1.m1.1.2.2.2" xref="S3.SS3.p4.1.m1.1.2.2.2.cmml">H</mi><mrow id="S3.SS3.p4.1.m1.1.2.2.3" xref="S3.SS3.p4.1.m1.1.2.2.3.cmml"><mi id="S3.SS3.p4.1.m1.1.2.2.3.2" xref="S3.SS3.p4.1.m1.1.2.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.1.m1.1.2.2.3.1" xref="S3.SS3.p4.1.m1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.1.m1.1.2.2.3.3" xref="S3.SS3.p4.1.m1.1.2.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.1.m1.1.2.2.3.1a" xref="S3.SS3.p4.1.m1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.1.m1.1.2.2.3.4" xref="S3.SS3.p4.1.m1.1.2.2.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.1.m1.1.2.2.3.1b" xref="S3.SS3.p4.1.m1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.1.m1.1.2.2.3.5" xref="S3.SS3.p4.1.m1.1.2.2.3.5.cmml">e</mi></mrow></msub><mo id="S3.SS3.p4.1.m1.1.2.1" xref="S3.SS3.p4.1.m1.1.2.1.cmml">∈</mo><msup id="S3.SS3.p4.1.m1.1.2.3" xref="S3.SS3.p4.1.m1.1.2.3.cmml"><mi id="S3.SS3.p4.1.m1.1.2.3.2" xref="S3.SS3.p4.1.m1.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p4.1.m1.1.1.1" xref="S3.SS3.p4.1.m1.1.1.1.cmml"><mi id="S3.SS3.p4.1.m1.1.1.1.3" xref="S3.SS3.p4.1.m1.1.1.1.3.cmml">k</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.1.m1.1.1.1.2" xref="S3.SS3.p4.1.m1.1.1.1.2.cmml">×</mo><mrow id="S3.SS3.p4.1.m1.1.1.1.1.1" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p4.1.m1.1.1.1.1.1.2" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p4.1.m1.1.1.1.1.1.1" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p4.1.m1.1.1.1.1.1.1.2" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.2.cmml">j</mi><mo id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.SS3.p4.1.m1.1.1.1.1.1.1.3" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.2" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.2.cmml">d</mi><mrow id="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.3" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.3.2" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.3.1" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.3.3" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.3.1a" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.3.4" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.3.4.cmml">s</mi></mrow></msub><mo id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1a" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.SS3.p4.1.m1.1.1.1.1.1.1.4" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.cmml"><mi id="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.2" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.2.cmml">d</mi><mrow id="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.cmml"><mi id="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.2" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.1" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.3" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.1a" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.4" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.1b" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.5" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.1c" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.6" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.6.cmml">s</mi></mrow></msub></mrow><mo stretchy="false" id="S3.SS3.p4.1.m1.1.1.1.1.1.3" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><apply id="S3.SS3.p4.1.m1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.2"><in id="S3.SS3.p4.1.m1.1.2.1.cmml" xref="S3.SS3.p4.1.m1.1.2.1"></in><apply id="S3.SS3.p4.1.m1.1.2.2.cmml" xref="S3.SS3.p4.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.2.2.1.cmml" xref="S3.SS3.p4.1.m1.1.2.2">subscript</csymbol><ci id="S3.SS3.p4.1.m1.1.2.2.2.cmml" xref="S3.SS3.p4.1.m1.1.2.2.2">𝐻</ci><apply id="S3.SS3.p4.1.m1.1.2.2.3.cmml" xref="S3.SS3.p4.1.m1.1.2.2.3"><times id="S3.SS3.p4.1.m1.1.2.2.3.1.cmml" xref="S3.SS3.p4.1.m1.1.2.2.3.1"></times><ci id="S3.SS3.p4.1.m1.1.2.2.3.2.cmml" xref="S3.SS3.p4.1.m1.1.2.2.3.2">𝑛</ci><ci id="S3.SS3.p4.1.m1.1.2.2.3.3.cmml" xref="S3.SS3.p4.1.m1.1.2.2.3.3">𝑜</ci><ci id="S3.SS3.p4.1.m1.1.2.2.3.4.cmml" xref="S3.SS3.p4.1.m1.1.2.2.3.4">𝑑</ci><ci id="S3.SS3.p4.1.m1.1.2.2.3.5.cmml" xref="S3.SS3.p4.1.m1.1.2.2.3.5">𝑒</ci></apply></apply><apply id="S3.SS3.p4.1.m1.1.2.3.cmml" xref="S3.SS3.p4.1.m1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.2.3.1.cmml" xref="S3.SS3.p4.1.m1.1.2.3">superscript</csymbol><ci id="S3.SS3.p4.1.m1.1.2.3.2.cmml" xref="S3.SS3.p4.1.m1.1.2.3.2">ℝ</ci><apply id="S3.SS3.p4.1.m1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1"><times id="S3.SS3.p4.1.m1.1.1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.1.1.2"></times><ci id="S3.SS3.p4.1.m1.1.1.1.3.cmml" xref="S3.SS3.p4.1.m1.1.1.1.3">𝑘</ci><apply id="S3.SS3.p4.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1"><plus id="S3.SS3.p4.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.1"></plus><ci id="S3.SS3.p4.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.2">𝑗</ci><apply id="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.2">𝑑</ci><apply id="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.3"><times id="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.3.1"></times><ci id="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.3.2">𝑅</ci><ci id="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.3.3">𝑒</ci><ci id="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.3.4.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.3.3.4">𝑠</ci></apply></apply><apply id="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.2.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.2">𝑑</ci><apply id="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3"><times id="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.1"></times><ci id="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.2.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.2">𝑇</ci><ci id="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.3.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.3">𝑟</ci><ci id="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.4.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.4">𝑎</ci><ci id="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.5.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.5">𝑛</ci><ci id="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.6.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1.1.1.4.3.6">𝑠</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">H_{node}\in\mathbb{R}^{k\times(j+d_{Res}+d_{Trans})}</annotation></semantics></math> and edge features <math id="S3.SS3.p4.2.m2.1" class="ltx_Math" alttext="H_{edge}\in\mathbb{R}^{k\times k}" display="inline"><semantics id="S3.SS3.p4.2.m2.1a"><mrow id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml"><msub id="S3.SS3.p4.2.m2.1.1.2" xref="S3.SS3.p4.2.m2.1.1.2.cmml"><mi id="S3.SS3.p4.2.m2.1.1.2.2" xref="S3.SS3.p4.2.m2.1.1.2.2.cmml">H</mi><mrow id="S3.SS3.p4.2.m2.1.1.2.3" xref="S3.SS3.p4.2.m2.1.1.2.3.cmml"><mi id="S3.SS3.p4.2.m2.1.1.2.3.2" xref="S3.SS3.p4.2.m2.1.1.2.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.2.m2.1.1.2.3.1" xref="S3.SS3.p4.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.2.m2.1.1.2.3.3" xref="S3.SS3.p4.2.m2.1.1.2.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.2.m2.1.1.2.3.1a" xref="S3.SS3.p4.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.2.m2.1.1.2.3.4" xref="S3.SS3.p4.2.m2.1.1.2.3.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.2.m2.1.1.2.3.1b" xref="S3.SS3.p4.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p4.2.m2.1.1.2.3.5" xref="S3.SS3.p4.2.m2.1.1.2.3.5.cmml">e</mi></mrow></msub><mo id="S3.SS3.p4.2.m2.1.1.1" xref="S3.SS3.p4.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS3.p4.2.m2.1.1.3" xref="S3.SS3.p4.2.m2.1.1.3.cmml"><mi id="S3.SS3.p4.2.m2.1.1.3.2" xref="S3.SS3.p4.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p4.2.m2.1.1.3.3" xref="S3.SS3.p4.2.m2.1.1.3.3.cmml"><mi id="S3.SS3.p4.2.m2.1.1.3.3.2" xref="S3.SS3.p4.2.m2.1.1.3.3.2.cmml">k</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p4.2.m2.1.1.3.3.1" xref="S3.SS3.p4.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p4.2.m2.1.1.3.3.3" xref="S3.SS3.p4.2.m2.1.1.3.3.3.cmml">k</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><apply id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1"><in id="S3.SS3.p4.2.m2.1.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1.1"></in><apply id="S3.SS3.p4.2.m2.1.1.2.cmml" xref="S3.SS3.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.1.2.1.cmml" xref="S3.SS3.p4.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS3.p4.2.m2.1.1.2.2.cmml" xref="S3.SS3.p4.2.m2.1.1.2.2">𝐻</ci><apply id="S3.SS3.p4.2.m2.1.1.2.3.cmml" xref="S3.SS3.p4.2.m2.1.1.2.3"><times id="S3.SS3.p4.2.m2.1.1.2.3.1.cmml" xref="S3.SS3.p4.2.m2.1.1.2.3.1"></times><ci id="S3.SS3.p4.2.m2.1.1.2.3.2.cmml" xref="S3.SS3.p4.2.m2.1.1.2.3.2">𝑒</ci><ci id="S3.SS3.p4.2.m2.1.1.2.3.3.cmml" xref="S3.SS3.p4.2.m2.1.1.2.3.3">𝑑</ci><ci id="S3.SS3.p4.2.m2.1.1.2.3.4.cmml" xref="S3.SS3.p4.2.m2.1.1.2.3.4">𝑔</ci><ci id="S3.SS3.p4.2.m2.1.1.2.3.5.cmml" xref="S3.SS3.p4.2.m2.1.1.2.3.5">𝑒</ci></apply></apply><apply id="S3.SS3.p4.2.m2.1.1.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.1.3.1.cmml" xref="S3.SS3.p4.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS3.p4.2.m2.1.1.3.2.cmml" xref="S3.SS3.p4.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS3.p4.2.m2.1.1.3.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3"><times id="S3.SS3.p4.2.m2.1.1.3.3.1.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3.1"></times><ci id="S3.SS3.p4.2.m2.1.1.3.3.2.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3.2">𝑘</ci><ci id="S3.SS3.p4.2.m2.1.1.3.3.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">H_{edge}\in\mathbb{R}^{k\times k}</annotation></semantics></math> as follows:</p>
<table id="S3.E15" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E15.m1.17" class="ltx_Math" alttext="\begin{gathered}H_{\text{node }}=\operatorname{Concat}\left(H_{S},H_{\text{Res }},H_{\text{Trans }}\right),\\
\end{gathered}" display="block"><semantics id="S3.E15.m1.17a"><mtable displaystyle="true" id="S3.E15.m1.17.17.2"><mtr id="S3.E15.m1.17.17.2a"><mtd id="S3.E15.m1.17.17.2b"><mrow id="S3.E15.m1.17.17.2.16.16.16.16"><mrow id="S3.E15.m1.17.17.2.16.16.16.16.1"><msub id="S3.E15.m1.17.17.2.16.16.16.16.1.4"><mi id="S3.E15.m1.1.1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.1.1.cmml">H</mi><mtext id="S3.E15.m1.2.2.2.2.2.2.1" xref="S3.E15.m1.2.2.2.2.2.2.1a.cmml">node </mtext></msub><mo id="S3.E15.m1.3.3.3.3.3.3" xref="S3.E15.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S3.E15.m1.17.17.2.16.16.16.16.1.3.3"><mi id="S3.E15.m1.4.4.4.4.4.4" xref="S3.E15.m1.4.4.4.4.4.4.cmml">Concat</mi><mo id="S3.E15.m1.17.17.2.16.16.16.16.1.3.3a" xref="S3.E15.m1.16.16.1.1.1.cmml">⁡</mo><mrow id="S3.E15.m1.17.17.2.16.16.16.16.1.3.3.3"><mo id="S3.E15.m1.5.5.5.5.5.5" xref="S3.E15.m1.16.16.1.1.1.cmml">(</mo><msub id="S3.E15.m1.17.17.2.16.16.16.16.1.1.1.1.1"><mi id="S3.E15.m1.6.6.6.6.6.6" xref="S3.E15.m1.6.6.6.6.6.6.cmml">H</mi><mi id="S3.E15.m1.7.7.7.7.7.7.1" xref="S3.E15.m1.7.7.7.7.7.7.1.cmml">S</mi></msub><mo id="S3.E15.m1.8.8.8.8.8.8" xref="S3.E15.m1.16.16.1.1.1.cmml">,</mo><msub id="S3.E15.m1.17.17.2.16.16.16.16.1.2.2.2.2"><mi id="S3.E15.m1.9.9.9.9.9.9" xref="S3.E15.m1.9.9.9.9.9.9.cmml">H</mi><mtext id="S3.E15.m1.10.10.10.10.10.10.1" xref="S3.E15.m1.10.10.10.10.10.10.1a.cmml">Res </mtext></msub><mo id="S3.E15.m1.11.11.11.11.11.11" xref="S3.E15.m1.16.16.1.1.1.cmml">,</mo><msub id="S3.E15.m1.17.17.2.16.16.16.16.1.3.3.3.3"><mi id="S3.E15.m1.12.12.12.12.12.12" xref="S3.E15.m1.12.12.12.12.12.12.cmml">H</mi><mtext id="S3.E15.m1.13.13.13.13.13.13.1" xref="S3.E15.m1.13.13.13.13.13.13.1a.cmml">Trans </mtext></msub><mo id="S3.E15.m1.14.14.14.14.14.14" xref="S3.E15.m1.16.16.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E15.m1.15.15.15.15.15.15" xref="S3.E15.m1.16.16.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E15.m1.17b"><apply id="S3.E15.m1.16.16.1.1.1.cmml" xref="S3.E15.m1.17.17.2.16.16.16.16.1.3.3a"><eq id="S3.E15.m1.3.3.3.3.3.3.cmml" xref="S3.E15.m1.3.3.3.3.3.3"></eq><apply id="S3.E15.m1.16.16.1.1.1.5.cmml" xref="S3.E15.m1.17.17.2.16.16.16.16.1.3.3a"><csymbol cd="ambiguous" id="S3.E15.m1.16.16.1.1.1.5.1.cmml" xref="S3.E15.m1.17.17.2.16.16.16.16.1.3.3a">subscript</csymbol><ci id="S3.E15.m1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1.1.1.1">𝐻</ci><ci id="S3.E15.m1.2.2.2.2.2.2.1a.cmml" xref="S3.E15.m1.2.2.2.2.2.2.1"><mtext mathsize="70%" id="S3.E15.m1.2.2.2.2.2.2.1.cmml" xref="S3.E15.m1.2.2.2.2.2.2.1">node </mtext></ci></apply><apply id="S3.E15.m1.16.16.1.1.1.3.4.cmml" xref="S3.E15.m1.17.17.2.16.16.16.16.1.3.3a"><ci id="S3.E15.m1.4.4.4.4.4.4.cmml" xref="S3.E15.m1.4.4.4.4.4.4">Concat</ci><apply id="S3.E15.m1.16.16.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.17.17.2.16.16.16.16.1.3.3a"><csymbol cd="ambiguous" id="S3.E15.m1.16.16.1.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.17.17.2.16.16.16.16.1.3.3a">subscript</csymbol><ci id="S3.E15.m1.6.6.6.6.6.6.cmml" xref="S3.E15.m1.6.6.6.6.6.6">𝐻</ci><ci id="S3.E15.m1.7.7.7.7.7.7.1.cmml" xref="S3.E15.m1.7.7.7.7.7.7.1">𝑆</ci></apply><apply id="S3.E15.m1.16.16.1.1.1.2.2.2.2.cmml" xref="S3.E15.m1.17.17.2.16.16.16.16.1.3.3a"><csymbol cd="ambiguous" id="S3.E15.m1.16.16.1.1.1.2.2.2.2.1.cmml" xref="S3.E15.m1.17.17.2.16.16.16.16.1.3.3a">subscript</csymbol><ci id="S3.E15.m1.9.9.9.9.9.9.cmml" xref="S3.E15.m1.9.9.9.9.9.9">𝐻</ci><ci id="S3.E15.m1.10.10.10.10.10.10.1a.cmml" xref="S3.E15.m1.10.10.10.10.10.10.1"><mtext mathsize="70%" id="S3.E15.m1.10.10.10.10.10.10.1.cmml" xref="S3.E15.m1.10.10.10.10.10.10.1">Res </mtext></ci></apply><apply id="S3.E15.m1.16.16.1.1.1.3.3.3.3.cmml" xref="S3.E15.m1.17.17.2.16.16.16.16.1.3.3a"><csymbol cd="ambiguous" id="S3.E15.m1.16.16.1.1.1.3.3.3.3.1.cmml" xref="S3.E15.m1.17.17.2.16.16.16.16.1.3.3a">subscript</csymbol><ci id="S3.E15.m1.12.12.12.12.12.12.cmml" xref="S3.E15.m1.12.12.12.12.12.12">𝐻</ci><ci id="S3.E15.m1.13.13.13.13.13.13.1a.cmml" xref="S3.E15.m1.13.13.13.13.13.13.1"><mtext mathsize="70%" id="S3.E15.m1.13.13.13.13.13.13.1.cmml" xref="S3.E15.m1.13.13.13.13.13.13.1">Trans </mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15.m1.17c">\begin{gathered}H_{\text{node }}=\operatorname{Concat}\left(H_{S},H_{\text{Res }},H_{\text{Trans }}\right),\\
\end{gathered}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p4.9" class="ltx_p">and</p>
<table id="S3.E16" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E16.m1.11" class="ltx_Math" alttext="\begin{gathered}H_{\text{edge }}=\operatorname{Normalize}\left(H_{L}\right).\end{gathered}" display="block"><semantics id="S3.E16.m1.11a"><mtable displaystyle="true" id="S3.E16.m1.11.11.2"><mtr id="S3.E16.m1.11.11.2a"><mtd id="S3.E16.m1.11.11.2b"><mrow id="S3.E16.m1.11.11.2.10.10.10.10"><mrow id="S3.E16.m1.11.11.2.10.10.10.10.1"><msub id="S3.E16.m1.11.11.2.10.10.10.10.1.2"><mi id="S3.E16.m1.1.1.1.1.1.1" xref="S3.E16.m1.1.1.1.1.1.1.cmml">H</mi><mtext id="S3.E16.m1.2.2.2.2.2.2.1" xref="S3.E16.m1.2.2.2.2.2.2.1a.cmml">edge </mtext></msub><mo id="S3.E16.m1.3.3.3.3.3.3" xref="S3.E16.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S3.E16.m1.11.11.2.10.10.10.10.1.1.1"><mi id="S3.E16.m1.4.4.4.4.4.4" xref="S3.E16.m1.4.4.4.4.4.4.cmml">Normalize</mi><mo id="S3.E16.m1.11.11.2.10.10.10.10.1.1.1a" xref="S3.E16.m1.10.10.1.1.1.cmml">⁡</mo><mrow id="S3.E16.m1.11.11.2.10.10.10.10.1.1.1.1"><mo id="S3.E16.m1.5.5.5.5.5.5" xref="S3.E16.m1.10.10.1.1.1.cmml">(</mo><msub id="S3.E16.m1.11.11.2.10.10.10.10.1.1.1.1.1"><mi id="S3.E16.m1.6.6.6.6.6.6" xref="S3.E16.m1.6.6.6.6.6.6.cmml">H</mi><mi id="S3.E16.m1.7.7.7.7.7.7.1" xref="S3.E16.m1.7.7.7.7.7.7.1.cmml">L</mi></msub><mo id="S3.E16.m1.8.8.8.8.8.8" xref="S3.E16.m1.10.10.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E16.m1.9.9.9.9.9.9" xref="S3.E16.m1.10.10.1.1.1.cmml">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E16.m1.11b"><apply id="S3.E16.m1.10.10.1.1.1.cmml" xref="S3.E16.m1.11.11.2.10.10.10.10.1.1.1a"><eq id="S3.E16.m1.3.3.3.3.3.3.cmml" xref="S3.E16.m1.3.3.3.3.3.3"></eq><apply id="S3.E16.m1.10.10.1.1.1.3.cmml" xref="S3.E16.m1.11.11.2.10.10.10.10.1.1.1a"><csymbol cd="ambiguous" id="S3.E16.m1.10.10.1.1.1.3.1.cmml" xref="S3.E16.m1.11.11.2.10.10.10.10.1.1.1a">subscript</csymbol><ci id="S3.E16.m1.1.1.1.1.1.1.cmml" xref="S3.E16.m1.1.1.1.1.1.1">𝐻</ci><ci id="S3.E16.m1.2.2.2.2.2.2.1a.cmml" xref="S3.E16.m1.2.2.2.2.2.2.1"><mtext mathsize="70%" id="S3.E16.m1.2.2.2.2.2.2.1.cmml" xref="S3.E16.m1.2.2.2.2.2.2.1">edge </mtext></ci></apply><apply id="S3.E16.m1.10.10.1.1.1.1.2.cmml" xref="S3.E16.m1.11.11.2.10.10.10.10.1.1.1a"><ci id="S3.E16.m1.4.4.4.4.4.4.cmml" xref="S3.E16.m1.4.4.4.4.4.4">Normalize</ci><apply id="S3.E16.m1.10.10.1.1.1.1.1.1.1.cmml" xref="S3.E16.m1.11.11.2.10.10.10.10.1.1.1a"><csymbol cd="ambiguous" id="S3.E16.m1.10.10.1.1.1.1.1.1.1.1.cmml" xref="S3.E16.m1.11.11.2.10.10.10.10.1.1.1a">subscript</csymbol><ci id="S3.E16.m1.6.6.6.6.6.6.cmml" xref="S3.E16.m1.6.6.6.6.6.6">𝐻</ci><ci id="S3.E16.m1.7.7.7.7.7.7.1.cmml" xref="S3.E16.m1.7.7.7.7.7.7.1">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16.m1.11c">\begin{gathered}H_{\text{edge }}=\operatorname{Normalize}\left(H_{L}\right).\end{gathered}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p4.3" class="ltx_p">where <span id="S3.SS3.p4.3.1" class="ltx_text ltx_markedasmath">Concat</span> denotes concatenation of node features. Graph convolution layers are used to update node features by considering edge features.</p>
<table id="S3.E17" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E17.m1.4" class="ltx_Math" alttext="H_{\text{node }}^{(l+1)}=\operatorname{GCM}\left(H_{\text{node }}^{(l)},H_{\text{edge }}\right)," display="block"><semantics id="S3.E17.m1.4a"><mrow id="S3.E17.m1.4.4.1" xref="S3.E17.m1.4.4.1.1.cmml"><mrow id="S3.E17.m1.4.4.1.1" xref="S3.E17.m1.4.4.1.1.cmml"><msubsup id="S3.E17.m1.4.4.1.1.4" xref="S3.E17.m1.4.4.1.1.4.cmml"><mi id="S3.E17.m1.4.4.1.1.4.2.2" xref="S3.E17.m1.4.4.1.1.4.2.2.cmml">H</mi><mtext id="S3.E17.m1.4.4.1.1.4.2.3" xref="S3.E17.m1.4.4.1.1.4.2.3a.cmml">node </mtext><mrow id="S3.E17.m1.1.1.1.1" xref="S3.E17.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E17.m1.1.1.1.1.2" xref="S3.E17.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E17.m1.1.1.1.1.1" xref="S3.E17.m1.1.1.1.1.1.cmml"><mi id="S3.E17.m1.1.1.1.1.1.2" xref="S3.E17.m1.1.1.1.1.1.2.cmml">l</mi><mo id="S3.E17.m1.1.1.1.1.1.1" xref="S3.E17.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.E17.m1.1.1.1.1.1.3" xref="S3.E17.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E17.m1.1.1.1.1.3" xref="S3.E17.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E17.m1.4.4.1.1.3" xref="S3.E17.m1.4.4.1.1.3.cmml">=</mo><mrow id="S3.E17.m1.4.4.1.1.2.2" xref="S3.E17.m1.4.4.1.1.2.3.cmml"><mi id="S3.E17.m1.3.3" xref="S3.E17.m1.3.3.cmml">GCM</mi><mo id="S3.E17.m1.4.4.1.1.2.2a" xref="S3.E17.m1.4.4.1.1.2.3.cmml">⁡</mo><mrow id="S3.E17.m1.4.4.1.1.2.2.2" xref="S3.E17.m1.4.4.1.1.2.3.cmml"><mo id="S3.E17.m1.4.4.1.1.2.2.2.3" xref="S3.E17.m1.4.4.1.1.2.3.cmml">(</mo><msubsup id="S3.E17.m1.4.4.1.1.1.1.1.1" xref="S3.E17.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E17.m1.4.4.1.1.1.1.1.1.2.2" xref="S3.E17.m1.4.4.1.1.1.1.1.1.2.2.cmml">H</mi><mtext id="S3.E17.m1.4.4.1.1.1.1.1.1.2.3" xref="S3.E17.m1.4.4.1.1.1.1.1.1.2.3a.cmml">node </mtext><mrow id="S3.E17.m1.2.2.1.3" xref="S3.E17.m1.4.4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E17.m1.2.2.1.3.1" xref="S3.E17.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E17.m1.2.2.1.1" xref="S3.E17.m1.2.2.1.1.cmml">l</mi><mo stretchy="false" id="S3.E17.m1.2.2.1.3.2" xref="S3.E17.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E17.m1.4.4.1.1.2.2.2.4" xref="S3.E17.m1.4.4.1.1.2.3.cmml">,</mo><msub id="S3.E17.m1.4.4.1.1.2.2.2.2" xref="S3.E17.m1.4.4.1.1.2.2.2.2.cmml"><mi id="S3.E17.m1.4.4.1.1.2.2.2.2.2" xref="S3.E17.m1.4.4.1.1.2.2.2.2.2.cmml">H</mi><mtext id="S3.E17.m1.4.4.1.1.2.2.2.2.3" xref="S3.E17.m1.4.4.1.1.2.2.2.2.3a.cmml">edge </mtext></msub><mo id="S3.E17.m1.4.4.1.1.2.2.2.5" xref="S3.E17.m1.4.4.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E17.m1.4.4.1.2" xref="S3.E17.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E17.m1.4b"><apply id="S3.E17.m1.4.4.1.1.cmml" xref="S3.E17.m1.4.4.1"><eq id="S3.E17.m1.4.4.1.1.3.cmml" xref="S3.E17.m1.4.4.1.1.3"></eq><apply id="S3.E17.m1.4.4.1.1.4.cmml" xref="S3.E17.m1.4.4.1.1.4"><csymbol cd="ambiguous" id="S3.E17.m1.4.4.1.1.4.1.cmml" xref="S3.E17.m1.4.4.1.1.4">superscript</csymbol><apply id="S3.E17.m1.4.4.1.1.4.2.cmml" xref="S3.E17.m1.4.4.1.1.4"><csymbol cd="ambiguous" id="S3.E17.m1.4.4.1.1.4.2.1.cmml" xref="S3.E17.m1.4.4.1.1.4">subscript</csymbol><ci id="S3.E17.m1.4.4.1.1.4.2.2.cmml" xref="S3.E17.m1.4.4.1.1.4.2.2">𝐻</ci><ci id="S3.E17.m1.4.4.1.1.4.2.3a.cmml" xref="S3.E17.m1.4.4.1.1.4.2.3"><mtext mathsize="70%" id="S3.E17.m1.4.4.1.1.4.2.3.cmml" xref="S3.E17.m1.4.4.1.1.4.2.3">node </mtext></ci></apply><apply id="S3.E17.m1.1.1.1.1.1.cmml" xref="S3.E17.m1.1.1.1.1"><plus id="S3.E17.m1.1.1.1.1.1.1.cmml" xref="S3.E17.m1.1.1.1.1.1.1"></plus><ci id="S3.E17.m1.1.1.1.1.1.2.cmml" xref="S3.E17.m1.1.1.1.1.1.2">𝑙</ci><cn type="integer" id="S3.E17.m1.1.1.1.1.1.3.cmml" xref="S3.E17.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.E17.m1.4.4.1.1.2.3.cmml" xref="S3.E17.m1.4.4.1.1.2.2"><ci id="S3.E17.m1.3.3.cmml" xref="S3.E17.m1.3.3">GCM</ci><apply id="S3.E17.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E17.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E17.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E17.m1.4.4.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E17.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E17.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E17.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S3.E17.m1.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E17.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="S3.E17.m1.4.4.1.1.1.1.1.1.2.2">𝐻</ci><ci id="S3.E17.m1.4.4.1.1.1.1.1.1.2.3a.cmml" xref="S3.E17.m1.4.4.1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="S3.E17.m1.4.4.1.1.1.1.1.1.2.3.cmml" xref="S3.E17.m1.4.4.1.1.1.1.1.1.2.3">node </mtext></ci></apply><ci id="S3.E17.m1.2.2.1.1.cmml" xref="S3.E17.m1.2.2.1.1">𝑙</ci></apply><apply id="S3.E17.m1.4.4.1.1.2.2.2.2.cmml" xref="S3.E17.m1.4.4.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E17.m1.4.4.1.1.2.2.2.2.1.cmml" xref="S3.E17.m1.4.4.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E17.m1.4.4.1.1.2.2.2.2.2.cmml" xref="S3.E17.m1.4.4.1.1.2.2.2.2.2">𝐻</ci><ci id="S3.E17.m1.4.4.1.1.2.2.2.2.3a.cmml" xref="S3.E17.m1.4.4.1.1.2.2.2.2.3"><mtext mathsize="70%" id="S3.E17.m1.4.4.1.1.2.2.2.2.3.cmml" xref="S3.E17.m1.4.4.1.1.2.2.2.2.3">edge </mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E17.m1.4c">H_{\text{node }}^{(l+1)}=\operatorname{GCM}\left(H_{\text{node }}^{(l)},H_{\text{edge }}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p4.6" class="ltx_p">where <math id="S3.SS3.p4.4.m1.1" class="ltx_Math" alttext="\text{GCM}(\cdot)" display="inline"><semantics id="S3.SS3.p4.4.m1.1a"><mrow id="S3.SS3.p4.4.m1.1.2" xref="S3.SS3.p4.4.m1.1.2.cmml"><mtext id="S3.SS3.p4.4.m1.1.2.2" xref="S3.SS3.p4.4.m1.1.2.2a.cmml">GCM</mtext><mo lspace="0em" rspace="0em" id="S3.SS3.p4.4.m1.1.2.1" xref="S3.SS3.p4.4.m1.1.2.1.cmml">​</mo><mrow id="S3.SS3.p4.4.m1.1.2.3.2" xref="S3.SS3.p4.4.m1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p4.4.m1.1.2.3.2.1" xref="S3.SS3.p4.4.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS3.p4.4.m1.1.1" xref="S3.SS3.p4.4.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS3.p4.4.m1.1.2.3.2.2" xref="S3.SS3.p4.4.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m1.1b"><apply id="S3.SS3.p4.4.m1.1.2.cmml" xref="S3.SS3.p4.4.m1.1.2"><times id="S3.SS3.p4.4.m1.1.2.1.cmml" xref="S3.SS3.p4.4.m1.1.2.1"></times><ci id="S3.SS3.p4.4.m1.1.2.2a.cmml" xref="S3.SS3.p4.4.m1.1.2.2"><mtext id="S3.SS3.p4.4.m1.1.2.2.cmml" xref="S3.SS3.p4.4.m1.1.2.2">GCM</mtext></ci><ci id="S3.SS3.p4.4.m1.1.1.cmml" xref="S3.SS3.p4.4.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m1.1c">\text{GCM}(\cdot)</annotation></semantics></math> represents the graph convolution operation and <math id="S3.SS3.p4.5.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS3.p4.5.m2.1a"><mi id="S3.SS3.p4.5.m2.1.1" xref="S3.SS3.p4.5.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.5.m2.1b"><ci id="S3.SS3.p4.5.m2.1.1.cmml" xref="S3.SS3.p4.5.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.5.m2.1c">l</annotation></semantics></math> denotes the layer index. In the GCM, node features are updated and aggregated at each layer. The final node features <math id="S3.SS3.p4.6.m3.1" class="ltx_Math" alttext="H_{agg}" display="inline"><semantics id="S3.SS3.p4.6.m3.1a"><msub id="S3.SS3.p4.6.m3.1.1" xref="S3.SS3.p4.6.m3.1.1.cmml"><mi id="S3.SS3.p4.6.m3.1.1.2" xref="S3.SS3.p4.6.m3.1.1.2.cmml">H</mi><mrow id="S3.SS3.p4.6.m3.1.1.3" xref="S3.SS3.p4.6.m3.1.1.3.cmml"><mi id="S3.SS3.p4.6.m3.1.1.3.2" xref="S3.SS3.p4.6.m3.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.6.m3.1.1.3.1" xref="S3.SS3.p4.6.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p4.6.m3.1.1.3.3" xref="S3.SS3.p4.6.m3.1.1.3.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.6.m3.1.1.3.1a" xref="S3.SS3.p4.6.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p4.6.m3.1.1.3.4" xref="S3.SS3.p4.6.m3.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.6.m3.1b"><apply id="S3.SS3.p4.6.m3.1.1.cmml" xref="S3.SS3.p4.6.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.6.m3.1.1.1.cmml" xref="S3.SS3.p4.6.m3.1.1">subscript</csymbol><ci id="S3.SS3.p4.6.m3.1.1.2.cmml" xref="S3.SS3.p4.6.m3.1.1.2">𝐻</ci><apply id="S3.SS3.p4.6.m3.1.1.3.cmml" xref="S3.SS3.p4.6.m3.1.1.3"><times id="S3.SS3.p4.6.m3.1.1.3.1.cmml" xref="S3.SS3.p4.6.m3.1.1.3.1"></times><ci id="S3.SS3.p4.6.m3.1.1.3.2.cmml" xref="S3.SS3.p4.6.m3.1.1.3.2">𝑎</ci><ci id="S3.SS3.p4.6.m3.1.1.3.3.cmml" xref="S3.SS3.p4.6.m3.1.1.3.3">𝑔</ci><ci id="S3.SS3.p4.6.m3.1.1.3.4.cmml" xref="S3.SS3.p4.6.m3.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.6.m3.1c">H_{agg}</annotation></semantics></math> are obtained through an aggregation operation.</p>
<table id="S3.E18" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E18.m1.3" class="ltx_Math" alttext="H_{\text{agg }}=\operatorname{Aggregate}\left(H_{\text{node }}^{(N)}\right)," display="block"><semantics id="S3.E18.m1.3a"><mrow id="S3.E18.m1.3.3.1" xref="S3.E18.m1.3.3.1.1.cmml"><mrow id="S3.E18.m1.3.3.1.1" xref="S3.E18.m1.3.3.1.1.cmml"><msub id="S3.E18.m1.3.3.1.1.3" xref="S3.E18.m1.3.3.1.1.3.cmml"><mi id="S3.E18.m1.3.3.1.1.3.2" xref="S3.E18.m1.3.3.1.1.3.2.cmml">H</mi><mtext id="S3.E18.m1.3.3.1.1.3.3" xref="S3.E18.m1.3.3.1.1.3.3a.cmml">agg </mtext></msub><mo id="S3.E18.m1.3.3.1.1.2" xref="S3.E18.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E18.m1.3.3.1.1.1.1" xref="S3.E18.m1.3.3.1.1.1.2.cmml"><mi id="S3.E18.m1.2.2" xref="S3.E18.m1.2.2.cmml">Aggregate</mi><mo id="S3.E18.m1.3.3.1.1.1.1a" xref="S3.E18.m1.3.3.1.1.1.2.cmml">⁡</mo><mrow id="S3.E18.m1.3.3.1.1.1.1.1" xref="S3.E18.m1.3.3.1.1.1.2.cmml"><mo id="S3.E18.m1.3.3.1.1.1.1.1.2" xref="S3.E18.m1.3.3.1.1.1.2.cmml">(</mo><msubsup id="S3.E18.m1.3.3.1.1.1.1.1.1" xref="S3.E18.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E18.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E18.m1.3.3.1.1.1.1.1.1.2.2.cmml">H</mi><mtext id="S3.E18.m1.3.3.1.1.1.1.1.1.2.3" xref="S3.E18.m1.3.3.1.1.1.1.1.1.2.3a.cmml">node </mtext><mrow id="S3.E18.m1.1.1.1.3" xref="S3.E18.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E18.m1.1.1.1.3.1" xref="S3.E18.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E18.m1.1.1.1.1" xref="S3.E18.m1.1.1.1.1.cmml">N</mi><mo stretchy="false" id="S3.E18.m1.1.1.1.3.2" xref="S3.E18.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E18.m1.3.3.1.1.1.1.1.3" xref="S3.E18.m1.3.3.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E18.m1.3.3.1.2" xref="S3.E18.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E18.m1.3b"><apply id="S3.E18.m1.3.3.1.1.cmml" xref="S3.E18.m1.3.3.1"><eq id="S3.E18.m1.3.3.1.1.2.cmml" xref="S3.E18.m1.3.3.1.1.2"></eq><apply id="S3.E18.m1.3.3.1.1.3.cmml" xref="S3.E18.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E18.m1.3.3.1.1.3.1.cmml" xref="S3.E18.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.E18.m1.3.3.1.1.3.2.cmml" xref="S3.E18.m1.3.3.1.1.3.2">𝐻</ci><ci id="S3.E18.m1.3.3.1.1.3.3a.cmml" xref="S3.E18.m1.3.3.1.1.3.3"><mtext mathsize="70%" id="S3.E18.m1.3.3.1.1.3.3.cmml" xref="S3.E18.m1.3.3.1.1.3.3">agg </mtext></ci></apply><apply id="S3.E18.m1.3.3.1.1.1.2.cmml" xref="S3.E18.m1.3.3.1.1.1.1"><ci id="S3.E18.m1.2.2.cmml" xref="S3.E18.m1.2.2">Aggregate</ci><apply id="S3.E18.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E18.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E18.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E18.m1.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E18.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E18.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E18.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E18.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E18.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E18.m1.3.3.1.1.1.1.1.1.2.2">𝐻</ci><ci id="S3.E18.m1.3.3.1.1.1.1.1.1.2.3a.cmml" xref="S3.E18.m1.3.3.1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="S3.E18.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E18.m1.3.3.1.1.1.1.1.1.2.3">node </mtext></ci></apply><ci id="S3.E18.m1.1.1.1.1.cmml" xref="S3.E18.m1.1.1.1.1">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E18.m1.3c">H_{\text{agg }}=\operatorname{Aggregate}\left(H_{\text{node }}^{(N)}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p4.8" class="ltx_p">where <span id="S3.SS3.p4.8.1" class="ltx_text ltx_markedasmath">Aggregate</span> performs feature aggregation and <math id="S3.SS3.p4.8.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS3.p4.8.m2.1a"><mi id="S3.SS3.p4.8.m2.1.1" xref="S3.SS3.p4.8.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.8.m2.1b"><ci id="S3.SS3.p4.8.m2.1.1.cmml" xref="S3.SS3.p4.8.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.8.m2.1c">N</annotation></semantics></math> is the total number of graph convolution layers.</p>
</div>
<div id="S3.SS3.p5" class="ltx_para">
<p id="S3.SS3.p5.2" class="ltx_p">Finally, we fuse the aggregated node features <math id="S3.SS3.p5.1.m1.1" class="ltx_Math" alttext="H_{agg}" display="inline"><semantics id="S3.SS3.p5.1.m1.1a"><msub id="S3.SS3.p5.1.m1.1.1" xref="S3.SS3.p5.1.m1.1.1.cmml"><mi id="S3.SS3.p5.1.m1.1.1.2" xref="S3.SS3.p5.1.m1.1.1.2.cmml">H</mi><mrow id="S3.SS3.p5.1.m1.1.1.3" xref="S3.SS3.p5.1.m1.1.1.3.cmml"><mi id="S3.SS3.p5.1.m1.1.1.3.2" xref="S3.SS3.p5.1.m1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.1.m1.1.1.3.1" xref="S3.SS3.p5.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p5.1.m1.1.1.3.3" xref="S3.SS3.p5.1.m1.1.1.3.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.1.m1.1.1.3.1a" xref="S3.SS3.p5.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p5.1.m1.1.1.3.4" xref="S3.SS3.p5.1.m1.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.1b"><apply id="S3.SS3.p5.1.m1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.1.m1.1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p5.1.m1.1.1.2.cmml" xref="S3.SS3.p5.1.m1.1.1.2">𝐻</ci><apply id="S3.SS3.p5.1.m1.1.1.3.cmml" xref="S3.SS3.p5.1.m1.1.1.3"><times id="S3.SS3.p5.1.m1.1.1.3.1.cmml" xref="S3.SS3.p5.1.m1.1.1.3.1"></times><ci id="S3.SS3.p5.1.m1.1.1.3.2.cmml" xref="S3.SS3.p5.1.m1.1.1.3.2">𝑎</ci><ci id="S3.SS3.p5.1.m1.1.1.3.3.cmml" xref="S3.SS3.p5.1.m1.1.1.3.3">𝑔</ci><ci id="S3.SS3.p5.1.m1.1.1.3.4.cmml" xref="S3.SS3.p5.1.m1.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.1c">H_{agg}</annotation></semantics></math> with other features to obtain the final fused feature <math id="S3.SS3.p5.2.m2.1" class="ltx_Math" alttext="F_{final}" display="inline"><semantics id="S3.SS3.p5.2.m2.1a"><msub id="S3.SS3.p5.2.m2.1.1" xref="S3.SS3.p5.2.m2.1.1.cmml"><mi id="S3.SS3.p5.2.m2.1.1.2" xref="S3.SS3.p5.2.m2.1.1.2.cmml">F</mi><mrow id="S3.SS3.p5.2.m2.1.1.3" xref="S3.SS3.p5.2.m2.1.1.3.cmml"><mi id="S3.SS3.p5.2.m2.1.1.3.2" xref="S3.SS3.p5.2.m2.1.1.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.2.m2.1.1.3.1" xref="S3.SS3.p5.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p5.2.m2.1.1.3.3" xref="S3.SS3.p5.2.m2.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.2.m2.1.1.3.1a" xref="S3.SS3.p5.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p5.2.m2.1.1.3.4" xref="S3.SS3.p5.2.m2.1.1.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.2.m2.1.1.3.1b" xref="S3.SS3.p5.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p5.2.m2.1.1.3.5" xref="S3.SS3.p5.2.m2.1.1.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.2.m2.1.1.3.1c" xref="S3.SS3.p5.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p5.2.m2.1.1.3.6" xref="S3.SS3.p5.2.m2.1.1.3.6.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.2.m2.1b"><apply id="S3.SS3.p5.2.m2.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.2.m2.1.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p5.2.m2.1.1.2.cmml" xref="S3.SS3.p5.2.m2.1.1.2">𝐹</ci><apply id="S3.SS3.p5.2.m2.1.1.3.cmml" xref="S3.SS3.p5.2.m2.1.1.3"><times id="S3.SS3.p5.2.m2.1.1.3.1.cmml" xref="S3.SS3.p5.2.m2.1.1.3.1"></times><ci id="S3.SS3.p5.2.m2.1.1.3.2.cmml" xref="S3.SS3.p5.2.m2.1.1.3.2">𝑓</ci><ci id="S3.SS3.p5.2.m2.1.1.3.3.cmml" xref="S3.SS3.p5.2.m2.1.1.3.3">𝑖</ci><ci id="S3.SS3.p5.2.m2.1.1.3.4.cmml" xref="S3.SS3.p5.2.m2.1.1.3.4">𝑛</ci><ci id="S3.SS3.p5.2.m2.1.1.3.5.cmml" xref="S3.SS3.p5.2.m2.1.1.3.5">𝑎</ci><ci id="S3.SS3.p5.2.m2.1.1.3.6.cmml" xref="S3.SS3.p5.2.m2.1.1.3.6">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.2.m2.1c">F_{final}</annotation></semantics></math>:</p>
<table id="S3.E19" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E19.m1.3" class="ltx_Math" alttext="F_{final}=\operatorname{Fusion}\left(H_{\text{agg }},H_{\text{node }}^{(L)}\right)," display="block"><semantics id="S3.E19.m1.3a"><mrow id="S3.E19.m1.3.3.1" xref="S3.E19.m1.3.3.1.1.cmml"><mrow id="S3.E19.m1.3.3.1.1" xref="S3.E19.m1.3.3.1.1.cmml"><msub id="S3.E19.m1.3.3.1.1.4" xref="S3.E19.m1.3.3.1.1.4.cmml"><mi id="S3.E19.m1.3.3.1.1.4.2" xref="S3.E19.m1.3.3.1.1.4.2.cmml">F</mi><mrow id="S3.E19.m1.3.3.1.1.4.3" xref="S3.E19.m1.3.3.1.1.4.3.cmml"><mi id="S3.E19.m1.3.3.1.1.4.3.2" xref="S3.E19.m1.3.3.1.1.4.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E19.m1.3.3.1.1.4.3.1" xref="S3.E19.m1.3.3.1.1.4.3.1.cmml">​</mo><mi id="S3.E19.m1.3.3.1.1.4.3.3" xref="S3.E19.m1.3.3.1.1.4.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E19.m1.3.3.1.1.4.3.1a" xref="S3.E19.m1.3.3.1.1.4.3.1.cmml">​</mo><mi id="S3.E19.m1.3.3.1.1.4.3.4" xref="S3.E19.m1.3.3.1.1.4.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E19.m1.3.3.1.1.4.3.1b" xref="S3.E19.m1.3.3.1.1.4.3.1.cmml">​</mo><mi id="S3.E19.m1.3.3.1.1.4.3.5" xref="S3.E19.m1.3.3.1.1.4.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E19.m1.3.3.1.1.4.3.1c" xref="S3.E19.m1.3.3.1.1.4.3.1.cmml">​</mo><mi id="S3.E19.m1.3.3.1.1.4.3.6" xref="S3.E19.m1.3.3.1.1.4.3.6.cmml">l</mi></mrow></msub><mo id="S3.E19.m1.3.3.1.1.3" xref="S3.E19.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E19.m1.3.3.1.1.2.2" xref="S3.E19.m1.3.3.1.1.2.3.cmml"><mi id="S3.E19.m1.2.2" xref="S3.E19.m1.2.2.cmml">Fusion</mi><mo id="S3.E19.m1.3.3.1.1.2.2a" xref="S3.E19.m1.3.3.1.1.2.3.cmml">⁡</mo><mrow id="S3.E19.m1.3.3.1.1.2.2.2" xref="S3.E19.m1.3.3.1.1.2.3.cmml"><mo id="S3.E19.m1.3.3.1.1.2.2.2.3" xref="S3.E19.m1.3.3.1.1.2.3.cmml">(</mo><msub id="S3.E19.m1.3.3.1.1.1.1.1.1" xref="S3.E19.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E19.m1.3.3.1.1.1.1.1.1.2" xref="S3.E19.m1.3.3.1.1.1.1.1.1.2.cmml">H</mi><mtext id="S3.E19.m1.3.3.1.1.1.1.1.1.3" xref="S3.E19.m1.3.3.1.1.1.1.1.1.3a.cmml">agg </mtext></msub><mo id="S3.E19.m1.3.3.1.1.2.2.2.4" xref="S3.E19.m1.3.3.1.1.2.3.cmml">,</mo><msubsup id="S3.E19.m1.3.3.1.1.2.2.2.2" xref="S3.E19.m1.3.3.1.1.2.2.2.2.cmml"><mi id="S3.E19.m1.3.3.1.1.2.2.2.2.2.2" xref="S3.E19.m1.3.3.1.1.2.2.2.2.2.2.cmml">H</mi><mtext id="S3.E19.m1.3.3.1.1.2.2.2.2.2.3" xref="S3.E19.m1.3.3.1.1.2.2.2.2.2.3a.cmml">node </mtext><mrow id="S3.E19.m1.1.1.1.3" xref="S3.E19.m1.3.3.1.1.2.2.2.2.cmml"><mo stretchy="false" id="S3.E19.m1.1.1.1.3.1" xref="S3.E19.m1.3.3.1.1.2.2.2.2.cmml">(</mo><mi id="S3.E19.m1.1.1.1.1" xref="S3.E19.m1.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S3.E19.m1.1.1.1.3.2" xref="S3.E19.m1.3.3.1.1.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.E19.m1.3.3.1.1.2.2.2.5" xref="S3.E19.m1.3.3.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E19.m1.3.3.1.2" xref="S3.E19.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E19.m1.3b"><apply id="S3.E19.m1.3.3.1.1.cmml" xref="S3.E19.m1.3.3.1"><eq id="S3.E19.m1.3.3.1.1.3.cmml" xref="S3.E19.m1.3.3.1.1.3"></eq><apply id="S3.E19.m1.3.3.1.1.4.cmml" xref="S3.E19.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="S3.E19.m1.3.3.1.1.4.1.cmml" xref="S3.E19.m1.3.3.1.1.4">subscript</csymbol><ci id="S3.E19.m1.3.3.1.1.4.2.cmml" xref="S3.E19.m1.3.3.1.1.4.2">𝐹</ci><apply id="S3.E19.m1.3.3.1.1.4.3.cmml" xref="S3.E19.m1.3.3.1.1.4.3"><times id="S3.E19.m1.3.3.1.1.4.3.1.cmml" xref="S3.E19.m1.3.3.1.1.4.3.1"></times><ci id="S3.E19.m1.3.3.1.1.4.3.2.cmml" xref="S3.E19.m1.3.3.1.1.4.3.2">𝑓</ci><ci id="S3.E19.m1.3.3.1.1.4.3.3.cmml" xref="S3.E19.m1.3.3.1.1.4.3.3">𝑖</ci><ci id="S3.E19.m1.3.3.1.1.4.3.4.cmml" xref="S3.E19.m1.3.3.1.1.4.3.4">𝑛</ci><ci id="S3.E19.m1.3.3.1.1.4.3.5.cmml" xref="S3.E19.m1.3.3.1.1.4.3.5">𝑎</ci><ci id="S3.E19.m1.3.3.1.1.4.3.6.cmml" xref="S3.E19.m1.3.3.1.1.4.3.6">𝑙</ci></apply></apply><apply id="S3.E19.m1.3.3.1.1.2.3.cmml" xref="S3.E19.m1.3.3.1.1.2.2"><ci id="S3.E19.m1.2.2.cmml" xref="S3.E19.m1.2.2">Fusion</ci><apply id="S3.E19.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E19.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E19.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E19.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E19.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E19.m1.3.3.1.1.1.1.1.1.2">𝐻</ci><ci id="S3.E19.m1.3.3.1.1.1.1.1.1.3a.cmml" xref="S3.E19.m1.3.3.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S3.E19.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E19.m1.3.3.1.1.1.1.1.1.3">agg </mtext></ci></apply><apply id="S3.E19.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E19.m1.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E19.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S3.E19.m1.3.3.1.1.2.2.2.2">superscript</csymbol><apply id="S3.E19.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E19.m1.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E19.m1.3.3.1.1.2.2.2.2.2.1.cmml" xref="S3.E19.m1.3.3.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E19.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S3.E19.m1.3.3.1.1.2.2.2.2.2.2">𝐻</ci><ci id="S3.E19.m1.3.3.1.1.2.2.2.2.2.3a.cmml" xref="S3.E19.m1.3.3.1.1.2.2.2.2.2.3"><mtext mathsize="70%" id="S3.E19.m1.3.3.1.1.2.2.2.2.2.3.cmml" xref="S3.E19.m1.3.3.1.1.2.2.2.2.2.3">node </mtext></ci></apply><ci id="S3.E19.m1.1.1.1.1.cmml" xref="S3.E19.m1.1.1.1.1">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E19.m1.3c">F_{final}=\operatorname{Fusion}\left(H_{\text{agg }},H_{\text{node }}^{(L)}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p5.4" class="ltx_p">The final fused feature <math id="S3.SS3.p5.3.m1.1" class="ltx_Math" alttext="F_{final}" display="inline"><semantics id="S3.SS3.p5.3.m1.1a"><msub id="S3.SS3.p5.3.m1.1.1" xref="S3.SS3.p5.3.m1.1.1.cmml"><mi id="S3.SS3.p5.3.m1.1.1.2" xref="S3.SS3.p5.3.m1.1.1.2.cmml">F</mi><mrow id="S3.SS3.p5.3.m1.1.1.3" xref="S3.SS3.p5.3.m1.1.1.3.cmml"><mi id="S3.SS3.p5.3.m1.1.1.3.2" xref="S3.SS3.p5.3.m1.1.1.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.3.m1.1.1.3.1" xref="S3.SS3.p5.3.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p5.3.m1.1.1.3.3" xref="S3.SS3.p5.3.m1.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.3.m1.1.1.3.1a" xref="S3.SS3.p5.3.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p5.3.m1.1.1.3.4" xref="S3.SS3.p5.3.m1.1.1.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.3.m1.1.1.3.1b" xref="S3.SS3.p5.3.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p5.3.m1.1.1.3.5" xref="S3.SS3.p5.3.m1.1.1.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.3.m1.1.1.3.1c" xref="S3.SS3.p5.3.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p5.3.m1.1.1.3.6" xref="S3.SS3.p5.3.m1.1.1.3.6.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.3.m1.1b"><apply id="S3.SS3.p5.3.m1.1.1.cmml" xref="S3.SS3.p5.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.3.m1.1.1.1.cmml" xref="S3.SS3.p5.3.m1.1.1">subscript</csymbol><ci id="S3.SS3.p5.3.m1.1.1.2.cmml" xref="S3.SS3.p5.3.m1.1.1.2">𝐹</ci><apply id="S3.SS3.p5.3.m1.1.1.3.cmml" xref="S3.SS3.p5.3.m1.1.1.3"><times id="S3.SS3.p5.3.m1.1.1.3.1.cmml" xref="S3.SS3.p5.3.m1.1.1.3.1"></times><ci id="S3.SS3.p5.3.m1.1.1.3.2.cmml" xref="S3.SS3.p5.3.m1.1.1.3.2">𝑓</ci><ci id="S3.SS3.p5.3.m1.1.1.3.3.cmml" xref="S3.SS3.p5.3.m1.1.1.3.3">𝑖</ci><ci id="S3.SS3.p5.3.m1.1.1.3.4.cmml" xref="S3.SS3.p5.3.m1.1.1.3.4">𝑛</ci><ci id="S3.SS3.p5.3.m1.1.1.3.5.cmml" xref="S3.SS3.p5.3.m1.1.1.3.5">𝑎</ci><ci id="S3.SS3.p5.3.m1.1.1.3.6.cmml" xref="S3.SS3.p5.3.m1.1.1.3.6">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.3.m1.1c">F_{final}</annotation></semantics></math> is fed into a classifier for Person Re-Identification to get <math id="S3.SS3.p5.4.m2.1" class="ltx_Math" alttext="P_{reid}\in\mathbb{R}^{C}" display="inline"><semantics id="S3.SS3.p5.4.m2.1a"><mrow id="S3.SS3.p5.4.m2.1.1" xref="S3.SS3.p5.4.m2.1.1.cmml"><msub id="S3.SS3.p5.4.m2.1.1.2" xref="S3.SS3.p5.4.m2.1.1.2.cmml"><mi id="S3.SS3.p5.4.m2.1.1.2.2" xref="S3.SS3.p5.4.m2.1.1.2.2.cmml">P</mi><mrow id="S3.SS3.p5.4.m2.1.1.2.3" xref="S3.SS3.p5.4.m2.1.1.2.3.cmml"><mi id="S3.SS3.p5.4.m2.1.1.2.3.2" xref="S3.SS3.p5.4.m2.1.1.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.4.m2.1.1.2.3.1" xref="S3.SS3.p5.4.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p5.4.m2.1.1.2.3.3" xref="S3.SS3.p5.4.m2.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.4.m2.1.1.2.3.1a" xref="S3.SS3.p5.4.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p5.4.m2.1.1.2.3.4" xref="S3.SS3.p5.4.m2.1.1.2.3.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.4.m2.1.1.2.3.1b" xref="S3.SS3.p5.4.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p5.4.m2.1.1.2.3.5" xref="S3.SS3.p5.4.m2.1.1.2.3.5.cmml">d</mi></mrow></msub><mo id="S3.SS3.p5.4.m2.1.1.1" xref="S3.SS3.p5.4.m2.1.1.1.cmml">∈</mo><msup id="S3.SS3.p5.4.m2.1.1.3" xref="S3.SS3.p5.4.m2.1.1.3.cmml"><mi id="S3.SS3.p5.4.m2.1.1.3.2" xref="S3.SS3.p5.4.m2.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS3.p5.4.m2.1.1.3.3" xref="S3.SS3.p5.4.m2.1.1.3.3.cmml">C</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.4.m2.1b"><apply id="S3.SS3.p5.4.m2.1.1.cmml" xref="S3.SS3.p5.4.m2.1.1"><in id="S3.SS3.p5.4.m2.1.1.1.cmml" xref="S3.SS3.p5.4.m2.1.1.1"></in><apply id="S3.SS3.p5.4.m2.1.1.2.cmml" xref="S3.SS3.p5.4.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p5.4.m2.1.1.2.1.cmml" xref="S3.SS3.p5.4.m2.1.1.2">subscript</csymbol><ci id="S3.SS3.p5.4.m2.1.1.2.2.cmml" xref="S3.SS3.p5.4.m2.1.1.2.2">𝑃</ci><apply id="S3.SS3.p5.4.m2.1.1.2.3.cmml" xref="S3.SS3.p5.4.m2.1.1.2.3"><times id="S3.SS3.p5.4.m2.1.1.2.3.1.cmml" xref="S3.SS3.p5.4.m2.1.1.2.3.1"></times><ci id="S3.SS3.p5.4.m2.1.1.2.3.2.cmml" xref="S3.SS3.p5.4.m2.1.1.2.3.2">𝑟</ci><ci id="S3.SS3.p5.4.m2.1.1.2.3.3.cmml" xref="S3.SS3.p5.4.m2.1.1.2.3.3">𝑒</ci><ci id="S3.SS3.p5.4.m2.1.1.2.3.4.cmml" xref="S3.SS3.p5.4.m2.1.1.2.3.4">𝑖</ci><ci id="S3.SS3.p5.4.m2.1.1.2.3.5.cmml" xref="S3.SS3.p5.4.m2.1.1.2.3.5">𝑑</ci></apply></apply><apply id="S3.SS3.p5.4.m2.1.1.3.cmml" xref="S3.SS3.p5.4.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p5.4.m2.1.1.3.1.cmml" xref="S3.SS3.p5.4.m2.1.1.3">superscript</csymbol><ci id="S3.SS3.p5.4.m2.1.1.3.2.cmml" xref="S3.SS3.p5.4.m2.1.1.3.2">ℝ</ci><ci id="S3.SS3.p5.4.m2.1.1.3.3.cmml" xref="S3.SS3.p5.4.m2.1.1.3.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.4.m2.1c">P_{reid}\in\mathbb{R}^{C}</annotation></semantics></math>:</p>
<table id="S3.E20" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E20.m1.1" class="ltx_Math" alttext="P_{\text{reid }}=\text{ Classifier }\left(F_{\text{final }}\right)," display="block"><semantics id="S3.E20.m1.1a"><mrow id="S3.E20.m1.1.1.1" xref="S3.E20.m1.1.1.1.1.cmml"><mrow id="S3.E20.m1.1.1.1.1" xref="S3.E20.m1.1.1.1.1.cmml"><msub id="S3.E20.m1.1.1.1.1.3" xref="S3.E20.m1.1.1.1.1.3.cmml"><mi id="S3.E20.m1.1.1.1.1.3.2" xref="S3.E20.m1.1.1.1.1.3.2.cmml">P</mi><mtext id="S3.E20.m1.1.1.1.1.3.3" xref="S3.E20.m1.1.1.1.1.3.3a.cmml">reid </mtext></msub><mo id="S3.E20.m1.1.1.1.1.2" xref="S3.E20.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E20.m1.1.1.1.1.1" xref="S3.E20.m1.1.1.1.1.1.cmml"><mtext id="S3.E20.m1.1.1.1.1.1.3" xref="S3.E20.m1.1.1.1.1.1.3a.cmml"> Classifier </mtext><mo lspace="0em" rspace="0em" id="S3.E20.m1.1.1.1.1.1.2" xref="S3.E20.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E20.m1.1.1.1.1.1.1.1" xref="S3.E20.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E20.m1.1.1.1.1.1.1.1.2" xref="S3.E20.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E20.m1.1.1.1.1.1.1.1.1" xref="S3.E20.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E20.m1.1.1.1.1.1.1.1.1.2" xref="S3.E20.m1.1.1.1.1.1.1.1.1.2.cmml">F</mi><mtext id="S3.E20.m1.1.1.1.1.1.1.1.1.3" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3a.cmml">final </mtext></msub><mo id="S3.E20.m1.1.1.1.1.1.1.1.3" xref="S3.E20.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E20.m1.1.1.1.2" xref="S3.E20.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E20.m1.1b"><apply id="S3.E20.m1.1.1.1.1.cmml" xref="S3.E20.m1.1.1.1"><eq id="S3.E20.m1.1.1.1.1.2.cmml" xref="S3.E20.m1.1.1.1.1.2"></eq><apply id="S3.E20.m1.1.1.1.1.3.cmml" xref="S3.E20.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E20.m1.1.1.1.1.3.1.cmml" xref="S3.E20.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E20.m1.1.1.1.1.3.2.cmml" xref="S3.E20.m1.1.1.1.1.3.2">𝑃</ci><ci id="S3.E20.m1.1.1.1.1.3.3a.cmml" xref="S3.E20.m1.1.1.1.1.3.3"><mtext mathsize="70%" id="S3.E20.m1.1.1.1.1.3.3.cmml" xref="S3.E20.m1.1.1.1.1.3.3">reid </mtext></ci></apply><apply id="S3.E20.m1.1.1.1.1.1.cmml" xref="S3.E20.m1.1.1.1.1.1"><times id="S3.E20.m1.1.1.1.1.1.2.cmml" xref="S3.E20.m1.1.1.1.1.1.2"></times><ci id="S3.E20.m1.1.1.1.1.1.3a.cmml" xref="S3.E20.m1.1.1.1.1.1.3"><mtext id="S3.E20.m1.1.1.1.1.1.3.cmml" xref="S3.E20.m1.1.1.1.1.1.3"> Classifier </mtext></ci><apply id="S3.E20.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E20.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E20.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1.1.2">𝐹</ci><ci id="S3.E20.m1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S3.E20.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E20.m1.1.1.1.1.1.1.1.1.3">final </mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E20.m1.1c">P_{\text{reid }}=\text{ Classifier }\left(F_{\text{final }}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p5.6" class="ltx_p">where <span id="S3.SS3.p5.6.1" class="ltx_text ltx_markedasmath">Classifier()</span> is a classifier typically consisting of fully connected layers and activation functions,<math id="S3.SS3.p5.6.m2.1" class="ltx_Math" alttext="P_{\text{reid}}" display="inline"><semantics id="S3.SS3.p5.6.m2.1a"><msub id="S3.SS3.p5.6.m2.1.1" xref="S3.SS3.p5.6.m2.1.1.cmml"><mi id="S3.SS3.p5.6.m2.1.1.2" xref="S3.SS3.p5.6.m2.1.1.2.cmml">P</mi><mtext id="S3.SS3.p5.6.m2.1.1.3" xref="S3.SS3.p5.6.m2.1.1.3a.cmml">reid</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.6.m2.1b"><apply id="S3.SS3.p5.6.m2.1.1.cmml" xref="S3.SS3.p5.6.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.6.m2.1.1.1.cmml" xref="S3.SS3.p5.6.m2.1.1">subscript</csymbol><ci id="S3.SS3.p5.6.m2.1.1.2.cmml" xref="S3.SS3.p5.6.m2.1.1.2">𝑃</ci><ci id="S3.SS3.p5.6.m2.1.1.3a.cmml" xref="S3.SS3.p5.6.m2.1.1.3"><mtext mathsize="70%" id="S3.SS3.p5.6.m2.1.1.3.cmml" xref="S3.SS3.p5.6.m2.1.1.3">reid</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.6.m2.1c">P_{\text{reid}}</annotation></semantics></math> is the result after classification.</p>
</div>
<div id="S3.SS3.p6" class="ltx_para">
<p id="S3.SS3.p6.1" class="ltx_p">In summary, the proposed graph convolutional module successfully integrates various features from different branches. This approach leverages the information from each feature source to extract more discriminative pedestrian characteristics. This not only improves the model’s accuracy in Person Re-Identification tasks but also significantly enhances its robustness in various complex scenarios.Next we discuss Loss Function for the proposed method.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Loss Function Design</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.1" class="ltx_p">To enhance performance, the three branches—pose estimation, ResNet features, and Transformer features—are trained separately and then combined. Each branch uses a distinct loss function tailored to its specific task, allowing for optimized learning and more effective feature integration.</p>
</div>
<div id="S3.SS4.p2" class="ltx_para">
<p id="S3.SS4.p2.4" class="ltx_p">The pose estimation branch uses OpenPose to generate the affinity fields <math id="S3.SS4.p2.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS4.p2.1.m1.1a"><mi id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><ci id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">L</annotation></semantics></math> and confidence maps <math id="S3.SS4.p2.2.m2.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS4.p2.2.m2.1a"><mi id="S3.SS4.p2.2.m2.1.1" xref="S3.SS4.p2.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.1b"><ci id="S3.SS4.p2.2.m2.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.1c">S</annotation></semantics></math>. The pose estimation network is trained with the L2 loss to optimize the prediction of <math id="S3.SS4.p2.3.m3.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS4.p2.3.m3.1a"><mi id="S3.SS4.p2.3.m3.1.1" xref="S3.SS4.p2.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.m3.1b"><ci id="S3.SS4.p2.3.m3.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.3.m3.1c">L</annotation></semantics></math> and <math id="S3.SS4.p2.4.m4.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS4.p2.4.m4.1a"><mi id="S3.SS4.p2.4.m4.1.1" xref="S3.SS4.p2.4.m4.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.4.m4.1b"><ci id="S3.SS4.p2.4.m4.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.4.m4.1c">S</annotation></semantics></math>. The L2 loss for the pose estimation branch can be expressed as:</p>
<table id="S3.E21" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E21.m1.1" class="ltx_Math" alttext="\mathcal{L}_{\text{pose }}=\frac{1}{N}\sum_{i=1}^{N}\left\|L_{i}-L_{i}^{\mathrm{gt}}\right\|^{2}+\frac{1}{N}\sum_{i=1}^{N}\left\|S_{i}-S_{i}^{\mathrm{gt}}\right\|^{2}," display="block"><semantics id="S3.E21.m1.1a"><mrow id="S3.E21.m1.1.1.1" xref="S3.E21.m1.1.1.1.1.cmml"><mrow id="S3.E21.m1.1.1.1.1" xref="S3.E21.m1.1.1.1.1.cmml"><msub id="S3.E21.m1.1.1.1.1.4" xref="S3.E21.m1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E21.m1.1.1.1.1.4.2" xref="S3.E21.m1.1.1.1.1.4.2.cmml">ℒ</mi><mtext id="S3.E21.m1.1.1.1.1.4.3" xref="S3.E21.m1.1.1.1.1.4.3a.cmml">pose </mtext></msub><mo id="S3.E21.m1.1.1.1.1.3" xref="S3.E21.m1.1.1.1.1.3.cmml">=</mo><mrow id="S3.E21.m1.1.1.1.1.2" xref="S3.E21.m1.1.1.1.1.2.cmml"><mrow id="S3.E21.m1.1.1.1.1.1.1" xref="S3.E21.m1.1.1.1.1.1.1.cmml"><mfrac id="S3.E21.m1.1.1.1.1.1.1.3" xref="S3.E21.m1.1.1.1.1.1.1.3.cmml"><mn id="S3.E21.m1.1.1.1.1.1.1.3.2" xref="S3.E21.m1.1.1.1.1.1.1.3.2.cmml">1</mn><mi id="S3.E21.m1.1.1.1.1.1.1.3.3" xref="S3.E21.m1.1.1.1.1.1.1.3.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E21.m1.1.1.1.1.1.1.2" xref="S3.E21.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E21.m1.1.1.1.1.1.1.1" xref="S3.E21.m1.1.1.1.1.1.1.1.cmml"><munderover id="S3.E21.m1.1.1.1.1.1.1.1.2" xref="S3.E21.m1.1.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E21.m1.1.1.1.1.1.1.1.2.2.2" xref="S3.E21.m1.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E21.m1.1.1.1.1.1.1.1.2.2.3" xref="S3.E21.m1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E21.m1.1.1.1.1.1.1.1.2.2.3.2" xref="S3.E21.m1.1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E21.m1.1.1.1.1.1.1.1.2.2.3.1" xref="S3.E21.m1.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E21.m1.1.1.1.1.1.1.1.2.2.3.3" xref="S3.E21.m1.1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E21.m1.1.1.1.1.1.1.1.2.3" xref="S3.E21.m1.1.1.1.1.1.1.1.2.3.cmml">N</mi></munderover><msup id="S3.E21.m1.1.1.1.1.1.1.1.1" xref="S3.E21.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E21.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E21.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E21.m1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">L</mi><mi id="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">L</mi><mi id="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mi id="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">gt</mi></msubsup></mrow><mo id="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E21.m1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E21.m1.1.1.1.1.1.1.1.1.3" xref="S3.E21.m1.1.1.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo id="S3.E21.m1.1.1.1.1.2.3" xref="S3.E21.m1.1.1.1.1.2.3.cmml">+</mo><mrow id="S3.E21.m1.1.1.1.1.2.2" xref="S3.E21.m1.1.1.1.1.2.2.cmml"><mfrac id="S3.E21.m1.1.1.1.1.2.2.3" xref="S3.E21.m1.1.1.1.1.2.2.3.cmml"><mn id="S3.E21.m1.1.1.1.1.2.2.3.2" xref="S3.E21.m1.1.1.1.1.2.2.3.2.cmml">1</mn><mi id="S3.E21.m1.1.1.1.1.2.2.3.3" xref="S3.E21.m1.1.1.1.1.2.2.3.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E21.m1.1.1.1.1.2.2.2" xref="S3.E21.m1.1.1.1.1.2.2.2.cmml">​</mo><mrow id="S3.E21.m1.1.1.1.1.2.2.1" xref="S3.E21.m1.1.1.1.1.2.2.1.cmml"><munderover id="S3.E21.m1.1.1.1.1.2.2.1.2" xref="S3.E21.m1.1.1.1.1.2.2.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E21.m1.1.1.1.1.2.2.1.2.2.2" xref="S3.E21.m1.1.1.1.1.2.2.1.2.2.2.cmml">∑</mo><mrow id="S3.E21.m1.1.1.1.1.2.2.1.2.2.3" xref="S3.E21.m1.1.1.1.1.2.2.1.2.2.3.cmml"><mi id="S3.E21.m1.1.1.1.1.2.2.1.2.2.3.2" xref="S3.E21.m1.1.1.1.1.2.2.1.2.2.3.2.cmml">i</mi><mo id="S3.E21.m1.1.1.1.1.2.2.1.2.2.3.1" xref="S3.E21.m1.1.1.1.1.2.2.1.2.2.3.1.cmml">=</mo><mn id="S3.E21.m1.1.1.1.1.2.2.1.2.2.3.3" xref="S3.E21.m1.1.1.1.1.2.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E21.m1.1.1.1.1.2.2.1.2.3" xref="S3.E21.m1.1.1.1.1.2.2.1.2.3.cmml">N</mi></munderover><msup id="S3.E21.m1.1.1.1.1.2.2.1.1" xref="S3.E21.m1.1.1.1.1.2.2.1.1.cmml"><mrow id="S3.E21.m1.1.1.1.1.2.2.1.1.1.1" xref="S3.E21.m1.1.1.1.1.2.2.1.1.1.2.cmml"><mo id="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.2" xref="S3.E21.m1.1.1.1.1.2.2.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1" xref="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.cmml"><msub id="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.2" xref="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.2.cmml"><mi id="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.2.2" xref="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.2.2.cmml">S</mi><mi id="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.2.3" xref="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.1" xref="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.1.cmml">−</mo><msubsup id="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.3" xref="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.3.2.2" xref="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.3.2.2.cmml">S</mi><mi id="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.3.2.3" xref="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.3.2.3.cmml">i</mi><mi id="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.3.3" xref="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.3.3.cmml">gt</mi></msubsup></mrow><mo id="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.3" xref="S3.E21.m1.1.1.1.1.2.2.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E21.m1.1.1.1.1.2.2.1.1.3" xref="S3.E21.m1.1.1.1.1.2.2.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow></mrow><mo id="S3.E21.m1.1.1.1.2" xref="S3.E21.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E21.m1.1b"><apply id="S3.E21.m1.1.1.1.1.cmml" xref="S3.E21.m1.1.1.1"><eq id="S3.E21.m1.1.1.1.1.3.cmml" xref="S3.E21.m1.1.1.1.1.3"></eq><apply id="S3.E21.m1.1.1.1.1.4.cmml" xref="S3.E21.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E21.m1.1.1.1.1.4.1.cmml" xref="S3.E21.m1.1.1.1.1.4">subscript</csymbol><ci id="S3.E21.m1.1.1.1.1.4.2.cmml" xref="S3.E21.m1.1.1.1.1.4.2">ℒ</ci><ci id="S3.E21.m1.1.1.1.1.4.3a.cmml" xref="S3.E21.m1.1.1.1.1.4.3"><mtext mathsize="70%" id="S3.E21.m1.1.1.1.1.4.3.cmml" xref="S3.E21.m1.1.1.1.1.4.3">pose </mtext></ci></apply><apply id="S3.E21.m1.1.1.1.1.2.cmml" xref="S3.E21.m1.1.1.1.1.2"><plus id="S3.E21.m1.1.1.1.1.2.3.cmml" xref="S3.E21.m1.1.1.1.1.2.3"></plus><apply id="S3.E21.m1.1.1.1.1.1.1.cmml" xref="S3.E21.m1.1.1.1.1.1.1"><times id="S3.E21.m1.1.1.1.1.1.1.2.cmml" xref="S3.E21.m1.1.1.1.1.1.1.2"></times><apply id="S3.E21.m1.1.1.1.1.1.1.3.cmml" xref="S3.E21.m1.1.1.1.1.1.1.3"><divide id="S3.E21.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E21.m1.1.1.1.1.1.1.3"></divide><cn type="integer" id="S3.E21.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E21.m1.1.1.1.1.1.1.3.2">1</cn><ci id="S3.E21.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E21.m1.1.1.1.1.1.1.3.3">𝑁</ci></apply><apply id="S3.E21.m1.1.1.1.1.1.1.1.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1"><apply id="S3.E21.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E21.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E21.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E21.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E21.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.2.2.2"></sum><apply id="S3.E21.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.2.2.3"><eq id="S3.E21.m1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E21.m1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E21.m1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E21.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S3.E21.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E21.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E21.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E21.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐿</ci><ci id="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐿</ci><ci id="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.1.1.1.1.3.3">gt</ci></apply></apply></apply><cn type="integer" id="S3.E21.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E21.m1.1.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply><apply id="S3.E21.m1.1.1.1.1.2.2.cmml" xref="S3.E21.m1.1.1.1.1.2.2"><times id="S3.E21.m1.1.1.1.1.2.2.2.cmml" xref="S3.E21.m1.1.1.1.1.2.2.2"></times><apply id="S3.E21.m1.1.1.1.1.2.2.3.cmml" xref="S3.E21.m1.1.1.1.1.2.2.3"><divide id="S3.E21.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E21.m1.1.1.1.1.2.2.3"></divide><cn type="integer" id="S3.E21.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E21.m1.1.1.1.1.2.2.3.2">1</cn><ci id="S3.E21.m1.1.1.1.1.2.2.3.3.cmml" xref="S3.E21.m1.1.1.1.1.2.2.3.3">𝑁</ci></apply><apply id="S3.E21.m1.1.1.1.1.2.2.1.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1"><apply id="S3.E21.m1.1.1.1.1.2.2.1.2.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.2"><csymbol cd="ambiguous" id="S3.E21.m1.1.1.1.1.2.2.1.2.1.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.2">superscript</csymbol><apply id="S3.E21.m1.1.1.1.1.2.2.1.2.2.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.2"><csymbol cd="ambiguous" id="S3.E21.m1.1.1.1.1.2.2.1.2.2.1.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.2">subscript</csymbol><sum id="S3.E21.m1.1.1.1.1.2.2.1.2.2.2.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.2.2.2"></sum><apply id="S3.E21.m1.1.1.1.1.2.2.1.2.2.3.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.2.2.3"><eq id="S3.E21.m1.1.1.1.1.2.2.1.2.2.3.1.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.2.2.3.1"></eq><ci id="S3.E21.m1.1.1.1.1.2.2.1.2.2.3.2.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E21.m1.1.1.1.1.2.2.1.2.2.3.3.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E21.m1.1.1.1.1.2.2.1.2.3.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.2.3">𝑁</ci></apply><apply id="S3.E21.m1.1.1.1.1.2.2.1.1.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S3.E21.m1.1.1.1.1.2.2.1.1.2.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.1">superscript</csymbol><apply id="S3.E21.m1.1.1.1.1.2.2.1.1.1.2.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.1.1.1"><csymbol cd="latexml" id="S3.E21.m1.1.1.1.1.2.2.1.1.1.2.1.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.2">norm</csymbol><apply id="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1"><minus id="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.1.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.1"></minus><apply id="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.2.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.2.2">𝑆</ci><ci id="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.3.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.3.2.1.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.3.2.2.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.3.2.2">𝑆</ci><ci id="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.3.2.3.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.1.1.1.1.3.3">gt</ci></apply></apply></apply><cn type="integer" id="S3.E21.m1.1.1.1.1.2.2.1.1.3.cmml" xref="S3.E21.m1.1.1.1.1.2.2.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E21.m1.1c">\mathcal{L}_{\text{pose }}=\frac{1}{N}\sum_{i=1}^{N}\left\|L_{i}-L_{i}^{\mathrm{gt}}\right\|^{2}+\frac{1}{N}\sum_{i=1}^{N}\left\|S_{i}-S_{i}^{\mathrm{gt}}\right\|^{2},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(21)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p2.9" class="ltx_p">where <math id="S3.SS4.p2.5.m1.1" class="ltx_Math" alttext="L_{i}" display="inline"><semantics id="S3.SS4.p2.5.m1.1a"><msub id="S3.SS4.p2.5.m1.1.1" xref="S3.SS4.p2.5.m1.1.1.cmml"><mi id="S3.SS4.p2.5.m1.1.1.2" xref="S3.SS4.p2.5.m1.1.1.2.cmml">L</mi><mi id="S3.SS4.p2.5.m1.1.1.3" xref="S3.SS4.p2.5.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.5.m1.1b"><apply id="S3.SS4.p2.5.m1.1.1.cmml" xref="S3.SS4.p2.5.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.5.m1.1.1.1.cmml" xref="S3.SS4.p2.5.m1.1.1">subscript</csymbol><ci id="S3.SS4.p2.5.m1.1.1.2.cmml" xref="S3.SS4.p2.5.m1.1.1.2">𝐿</ci><ci id="S3.SS4.p2.5.m1.1.1.3.cmml" xref="S3.SS4.p2.5.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.5.m1.1c">L_{i}</annotation></semantics></math> and <math id="S3.SS4.p2.6.m2.1" class="ltx_Math" alttext="S_{i}" display="inline"><semantics id="S3.SS4.p2.6.m2.1a"><msub id="S3.SS4.p2.6.m2.1.1" xref="S3.SS4.p2.6.m2.1.1.cmml"><mi id="S3.SS4.p2.6.m2.1.1.2" xref="S3.SS4.p2.6.m2.1.1.2.cmml">S</mi><mi id="S3.SS4.p2.6.m2.1.1.3" xref="S3.SS4.p2.6.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.6.m2.1b"><apply id="S3.SS4.p2.6.m2.1.1.cmml" xref="S3.SS4.p2.6.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.6.m2.1.1.1.cmml" xref="S3.SS4.p2.6.m2.1.1">subscript</csymbol><ci id="S3.SS4.p2.6.m2.1.1.2.cmml" xref="S3.SS4.p2.6.m2.1.1.2">𝑆</ci><ci id="S3.SS4.p2.6.m2.1.1.3.cmml" xref="S3.SS4.p2.6.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.6.m2.1c">S_{i}</annotation></semantics></math> are the predicted affinity fields and confidence maps, respectively, and <math id="S3.SS4.p2.7.m3.1" class="ltx_Math" alttext="L_{i}^{gt}" display="inline"><semantics id="S3.SS4.p2.7.m3.1a"><msubsup id="S3.SS4.p2.7.m3.1.1" xref="S3.SS4.p2.7.m3.1.1.cmml"><mi id="S3.SS4.p2.7.m3.1.1.2.2" xref="S3.SS4.p2.7.m3.1.1.2.2.cmml">L</mi><mi id="S3.SS4.p2.7.m3.1.1.2.3" xref="S3.SS4.p2.7.m3.1.1.2.3.cmml">i</mi><mrow id="S3.SS4.p2.7.m3.1.1.3" xref="S3.SS4.p2.7.m3.1.1.3.cmml"><mi id="S3.SS4.p2.7.m3.1.1.3.2" xref="S3.SS4.p2.7.m3.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.7.m3.1.1.3.1" xref="S3.SS4.p2.7.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p2.7.m3.1.1.3.3" xref="S3.SS4.p2.7.m3.1.1.3.3.cmml">t</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.7.m3.1b"><apply id="S3.SS4.p2.7.m3.1.1.cmml" xref="S3.SS4.p2.7.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.7.m3.1.1.1.cmml" xref="S3.SS4.p2.7.m3.1.1">superscript</csymbol><apply id="S3.SS4.p2.7.m3.1.1.2.cmml" xref="S3.SS4.p2.7.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.7.m3.1.1.2.1.cmml" xref="S3.SS4.p2.7.m3.1.1">subscript</csymbol><ci id="S3.SS4.p2.7.m3.1.1.2.2.cmml" xref="S3.SS4.p2.7.m3.1.1.2.2">𝐿</ci><ci id="S3.SS4.p2.7.m3.1.1.2.3.cmml" xref="S3.SS4.p2.7.m3.1.1.2.3">𝑖</ci></apply><apply id="S3.SS4.p2.7.m3.1.1.3.cmml" xref="S3.SS4.p2.7.m3.1.1.3"><times id="S3.SS4.p2.7.m3.1.1.3.1.cmml" xref="S3.SS4.p2.7.m3.1.1.3.1"></times><ci id="S3.SS4.p2.7.m3.1.1.3.2.cmml" xref="S3.SS4.p2.7.m3.1.1.3.2">𝑔</ci><ci id="S3.SS4.p2.7.m3.1.1.3.3.cmml" xref="S3.SS4.p2.7.m3.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.7.m3.1c">L_{i}^{gt}</annotation></semantics></math> and <math id="S3.SS4.p2.8.m4.1" class="ltx_Math" alttext="S_{i}^{gt}" display="inline"><semantics id="S3.SS4.p2.8.m4.1a"><msubsup id="S3.SS4.p2.8.m4.1.1" xref="S3.SS4.p2.8.m4.1.1.cmml"><mi id="S3.SS4.p2.8.m4.1.1.2.2" xref="S3.SS4.p2.8.m4.1.1.2.2.cmml">S</mi><mi id="S3.SS4.p2.8.m4.1.1.2.3" xref="S3.SS4.p2.8.m4.1.1.2.3.cmml">i</mi><mrow id="S3.SS4.p2.8.m4.1.1.3" xref="S3.SS4.p2.8.m4.1.1.3.cmml"><mi id="S3.SS4.p2.8.m4.1.1.3.2" xref="S3.SS4.p2.8.m4.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.8.m4.1.1.3.1" xref="S3.SS4.p2.8.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p2.8.m4.1.1.3.3" xref="S3.SS4.p2.8.m4.1.1.3.3.cmml">t</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.8.m4.1b"><apply id="S3.SS4.p2.8.m4.1.1.cmml" xref="S3.SS4.p2.8.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.8.m4.1.1.1.cmml" xref="S3.SS4.p2.8.m4.1.1">superscript</csymbol><apply id="S3.SS4.p2.8.m4.1.1.2.cmml" xref="S3.SS4.p2.8.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.8.m4.1.1.2.1.cmml" xref="S3.SS4.p2.8.m4.1.1">subscript</csymbol><ci id="S3.SS4.p2.8.m4.1.1.2.2.cmml" xref="S3.SS4.p2.8.m4.1.1.2.2">𝑆</ci><ci id="S3.SS4.p2.8.m4.1.1.2.3.cmml" xref="S3.SS4.p2.8.m4.1.1.2.3">𝑖</ci></apply><apply id="S3.SS4.p2.8.m4.1.1.3.cmml" xref="S3.SS4.p2.8.m4.1.1.3"><times id="S3.SS4.p2.8.m4.1.1.3.1.cmml" xref="S3.SS4.p2.8.m4.1.1.3.1"></times><ci id="S3.SS4.p2.8.m4.1.1.3.2.cmml" xref="S3.SS4.p2.8.m4.1.1.3.2">𝑔</ci><ci id="S3.SS4.p2.8.m4.1.1.3.3.cmml" xref="S3.SS4.p2.8.m4.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.8.m4.1c">S_{i}^{gt}</annotation></semantics></math> are the ground truth values. <math id="S3.SS4.p2.9.m5.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS4.p2.9.m5.1a"><mi id="S3.SS4.p2.9.m5.1.1" xref="S3.SS4.p2.9.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.9.m5.1b"><ci id="S3.SS4.p2.9.m5.1.1.cmml" xref="S3.SS4.p2.9.m5.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.9.m5.1c">N</annotation></semantics></math> denotes the number of keypoints or patches. L2 loss minimizes the squared difference between the predicted and ground truth values, improving the accuracy of the pose estimation by ensuring precise localization of keypoints and reliable confidence scores.</p>
</div>
<div id="S3.SS4.p3" class="ltx_para">
<p id="S3.SS4.p3.5" class="ltx_p">The ResNet branch extracts deep features from pedestrian images. It employs a contrastive loss which encourages similar features to be close and dissimilar features to be far apart in the feature space. The loss function is defined as:</p>
<table id="S3.E22" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E22.m1.3" class="ltx_Math" alttext="\mathcal{L}_{ce}=\frac{1}{M}\sum_{i=1}^{M}\left[y_{i}\cdot\max\left(0,\operatorname{margin}-\left\|F_{i}^{\mathrm{res}}-F_{i}^{\mathrm{pos}}\right\|^{2}\right)+\left(1-y_{i}\right)\cdot\left\|F_{i}^{\mathrm{res}}-F_{i}^{\mathrm{neg}}\right\|^{2}\right]," display="block"><semantics id="S3.E22.m1.3a"><mrow id="S3.E22.m1.3.3.1" xref="S3.E22.m1.3.3.1.1.cmml"><mrow id="S3.E22.m1.3.3.1.1" xref="S3.E22.m1.3.3.1.1.cmml"><msub id="S3.E22.m1.3.3.1.1.3" xref="S3.E22.m1.3.3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E22.m1.3.3.1.1.3.2" xref="S3.E22.m1.3.3.1.1.3.2.cmml">ℒ</mi><mrow id="S3.E22.m1.3.3.1.1.3.3" xref="S3.E22.m1.3.3.1.1.3.3.cmml"><mi id="S3.E22.m1.3.3.1.1.3.3.2" xref="S3.E22.m1.3.3.1.1.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E22.m1.3.3.1.1.3.3.1" xref="S3.E22.m1.3.3.1.1.3.3.1.cmml">​</mo><mi id="S3.E22.m1.3.3.1.1.3.3.3" xref="S3.E22.m1.3.3.1.1.3.3.3.cmml">e</mi></mrow></msub><mo id="S3.E22.m1.3.3.1.1.2" xref="S3.E22.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E22.m1.3.3.1.1.1" xref="S3.E22.m1.3.3.1.1.1.cmml"><mfrac id="S3.E22.m1.3.3.1.1.1.3" xref="S3.E22.m1.3.3.1.1.1.3.cmml"><mn id="S3.E22.m1.3.3.1.1.1.3.2" xref="S3.E22.m1.3.3.1.1.1.3.2.cmml">1</mn><mi id="S3.E22.m1.3.3.1.1.1.3.3" xref="S3.E22.m1.3.3.1.1.1.3.3.cmml">M</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E22.m1.3.3.1.1.1.2" xref="S3.E22.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E22.m1.3.3.1.1.1.1" xref="S3.E22.m1.3.3.1.1.1.1.cmml"><munderover id="S3.E22.m1.3.3.1.1.1.1.2" xref="S3.E22.m1.3.3.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E22.m1.3.3.1.1.1.1.2.2.2" xref="S3.E22.m1.3.3.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E22.m1.3.3.1.1.1.1.2.2.3" xref="S3.E22.m1.3.3.1.1.1.1.2.2.3.cmml"><mi id="S3.E22.m1.3.3.1.1.1.1.2.2.3.2" xref="S3.E22.m1.3.3.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E22.m1.3.3.1.1.1.1.2.2.3.1" xref="S3.E22.m1.3.3.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E22.m1.3.3.1.1.1.1.2.2.3.3" xref="S3.E22.m1.3.3.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E22.m1.3.3.1.1.1.1.2.3" xref="S3.E22.m1.3.3.1.1.1.1.2.3.cmml">M</mi></munderover><mrow id="S3.E22.m1.3.3.1.1.1.1.1.1" xref="S3.E22.m1.3.3.1.1.1.1.1.2.cmml"><mo id="S3.E22.m1.3.3.1.1.1.1.1.1.2" xref="S3.E22.m1.3.3.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E22.m1.3.3.1.1.1.1.1.1.1" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.cmml"><mrow id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.3.2" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml">y</mi><mi id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.3.3" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">⋅</mo><mrow id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E22.m1.1.1" xref="S3.E22.m1.1.1.cmml">max</mi><mo id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1a" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mn id="S3.E22.m1.2.2" xref="S3.E22.m1.2.2.cmml">0</mn><mo id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mrow id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">margin</mi><mo lspace="0em" id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">−</mo><msup id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">F</mi><mi id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi><mi id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">res</mi></msubsup><mo id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">F</mi><mi id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mi id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">pos</mi></msubsup></mrow><mo id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow><mo id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.4" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E22.m1.3.3.1.1.1.1.1.1.1.4" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.4.cmml">+</mo><mrow id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mrow id="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.2" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.cmml"><mn id="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.2" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.2.cmml">1</mn><mo id="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.1" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.1.cmml">−</mo><msub id="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3.cmml"><mi id="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3.2" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml">y</mi><mi id="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3.3" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml">i</mi></msub></mrow><mo rspace="0.055em" id="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.3" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.3" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.3.cmml">⋅</mo><msup id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.cmml"><mrow id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.2.cmml"><mo id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.2" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.2.1.cmml">‖</mo><mrow id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.cmml"><msubsup id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.2" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.2.cmml"><mi id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.2.2.2" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.2.2.2.cmml">F</mi><mi id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.2.2.3" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.2.2.3.cmml">i</mi><mi id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.2.3" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.2.3.cmml">res</mi></msubsup><mo id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.1" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.1.cmml">−</mo><msubsup id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.3" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.3.cmml"><mi id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.3.2.2" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.3.2.2.cmml">F</mi><mi id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.3.2.3" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.3.2.3.cmml">i</mi><mi id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.3.3" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.3.3.cmml">neg</mi></msubsup></mrow><mo id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.3" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.2.1.cmml">‖</mo></mrow><mn id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.3" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.3.cmml">2</mn></msup></mrow></mrow><mo id="S3.E22.m1.3.3.1.1.1.1.1.1.3" xref="S3.E22.m1.3.3.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S3.E22.m1.3.3.1.2" xref="S3.E22.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E22.m1.3b"><apply id="S3.E22.m1.3.3.1.1.cmml" xref="S3.E22.m1.3.3.1"><eq id="S3.E22.m1.3.3.1.1.2.cmml" xref="S3.E22.m1.3.3.1.1.2"></eq><apply id="S3.E22.m1.3.3.1.1.3.cmml" xref="S3.E22.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E22.m1.3.3.1.1.3.1.cmml" xref="S3.E22.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.E22.m1.3.3.1.1.3.2.cmml" xref="S3.E22.m1.3.3.1.1.3.2">ℒ</ci><apply id="S3.E22.m1.3.3.1.1.3.3.cmml" xref="S3.E22.m1.3.3.1.1.3.3"><times id="S3.E22.m1.3.3.1.1.3.3.1.cmml" xref="S3.E22.m1.3.3.1.1.3.3.1"></times><ci id="S3.E22.m1.3.3.1.1.3.3.2.cmml" xref="S3.E22.m1.3.3.1.1.3.3.2">𝑐</ci><ci id="S3.E22.m1.3.3.1.1.3.3.3.cmml" xref="S3.E22.m1.3.3.1.1.3.3.3">𝑒</ci></apply></apply><apply id="S3.E22.m1.3.3.1.1.1.cmml" xref="S3.E22.m1.3.3.1.1.1"><times id="S3.E22.m1.3.3.1.1.1.2.cmml" xref="S3.E22.m1.3.3.1.1.1.2"></times><apply id="S3.E22.m1.3.3.1.1.1.3.cmml" xref="S3.E22.m1.3.3.1.1.1.3"><divide id="S3.E22.m1.3.3.1.1.1.3.1.cmml" xref="S3.E22.m1.3.3.1.1.1.3"></divide><cn type="integer" id="S3.E22.m1.3.3.1.1.1.3.2.cmml" xref="S3.E22.m1.3.3.1.1.1.3.2">1</cn><ci id="S3.E22.m1.3.3.1.1.1.3.3.cmml" xref="S3.E22.m1.3.3.1.1.1.3.3">𝑀</ci></apply><apply id="S3.E22.m1.3.3.1.1.1.1.cmml" xref="S3.E22.m1.3.3.1.1.1.1"><apply id="S3.E22.m1.3.3.1.1.1.1.2.cmml" xref="S3.E22.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E22.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E22.m1.3.3.1.1.1.1.2">superscript</csymbol><apply id="S3.E22.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E22.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E22.m1.3.3.1.1.1.1.2.2.1.cmml" xref="S3.E22.m1.3.3.1.1.1.1.2">subscript</csymbol><sum id="S3.E22.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S3.E22.m1.3.3.1.1.1.1.2.2.2"></sum><apply id="S3.E22.m1.3.3.1.1.1.1.2.2.3.cmml" xref="S3.E22.m1.3.3.1.1.1.1.2.2.3"><eq id="S3.E22.m1.3.3.1.1.1.1.2.2.3.1.cmml" xref="S3.E22.m1.3.3.1.1.1.1.2.2.3.1"></eq><ci id="S3.E22.m1.3.3.1.1.1.1.2.2.3.2.cmml" xref="S3.E22.m1.3.3.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E22.m1.3.3.1.1.1.1.2.2.3.3.cmml" xref="S3.E22.m1.3.3.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E22.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E22.m1.3.3.1.1.1.1.2.3">𝑀</ci></apply><apply id="S3.E22.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E22.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E22.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1"><plus id="S3.E22.m1.3.3.1.1.1.1.1.1.1.4.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.4"></plus><apply id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1"><ci id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.2">⋅</ci><apply id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.3.2">𝑦</ci><ci id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1"><max id="S3.E22.m1.1.1.cmml" xref="S3.E22.m1.1.1"></max><cn type="integer" id="S3.E22.m1.2.2.cmml" xref="S3.E22.m1.2.2">0</cn><apply id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2"></minus><ci id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3">margin</ci><apply id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝐹</ci><ci id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">res</ci></apply><apply id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐹</ci><ci id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">pos</ci></apply></apply></apply><cn type="integer" id="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply><apply id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3"><ci id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.3">⋅</ci><apply id="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1"><minus id="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.1"></minus><cn type="integer" id="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.2">1</cn><apply id="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3.2">𝑦</ci><ci id="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2">superscript</csymbol><apply id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.2.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1"><csymbol cd="latexml" id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.2.1.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.2">norm</csymbol><apply id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1"><minus id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.1.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.1"></minus><apply id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.2.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.2.1.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.2">superscript</csymbol><apply id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.2.2.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.2.2.1.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.2">subscript</csymbol><ci id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.2.2.2.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.2.2.2">𝐹</ci><ci id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.2.2.3.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.2.3.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.2.3">res</ci></apply><apply id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.3.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.3.1.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.3">superscript</csymbol><apply id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.3.2.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.3.2.1.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.3">subscript</csymbol><ci id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.3.2.2.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.3.2.2">𝐹</ci><ci id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.3.2.3.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.3.3.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.1.1.1.3.3">neg</ci></apply></apply></apply><cn type="integer" id="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E22.m1.3.3.1.1.1.1.1.1.1.3.2.3">2</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E22.m1.3c">\mathcal{L}_{ce}=\frac{1}{M}\sum_{i=1}^{M}\left[y_{i}\cdot\max\left(0,\operatorname{margin}-\left\|F_{i}^{\mathrm{res}}-F_{i}^{\mathrm{pos}}\right\|^{2}\right)+\left(1-y_{i}\right)\cdot\left\|F_{i}^{\mathrm{res}}-F_{i}^{\mathrm{neg}}\right\|^{2}\right],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(22)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p3.4" class="ltx_p">where <math id="S3.SS4.p3.1.m1.1" class="ltx_Math" alttext="F_{i}^{\mathrm{res}}" display="inline"><semantics id="S3.SS4.p3.1.m1.1a"><msubsup id="S3.SS4.p3.1.m1.1.1" xref="S3.SS4.p3.1.m1.1.1.cmml"><mi id="S3.SS4.p3.1.m1.1.1.2.2" xref="S3.SS4.p3.1.m1.1.1.2.2.cmml">F</mi><mi id="S3.SS4.p3.1.m1.1.1.2.3" xref="S3.SS4.p3.1.m1.1.1.2.3.cmml">i</mi><mi id="S3.SS4.p3.1.m1.1.1.3" xref="S3.SS4.p3.1.m1.1.1.3.cmml">res</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.1b"><apply id="S3.SS4.p3.1.m1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.1.m1.1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1">superscript</csymbol><apply id="S3.SS4.p3.1.m1.1.1.2.cmml" xref="S3.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.1.m1.1.1.2.1.cmml" xref="S3.SS4.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p3.1.m1.1.1.2.2.cmml" xref="S3.SS4.p3.1.m1.1.1.2.2">𝐹</ci><ci id="S3.SS4.p3.1.m1.1.1.2.3.cmml" xref="S3.SS4.p3.1.m1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS4.p3.1.m1.1.1.3.cmml" xref="S3.SS4.p3.1.m1.1.1.3">res</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.1c">F_{i}^{\mathrm{res}}</annotation></semantics></math> represents the feature vector from ResNet, <math id="S3.SS4.p3.2.m2.1" class="ltx_Math" alttext="F_{i}^{\mathrm{pos}}" display="inline"><semantics id="S3.SS4.p3.2.m2.1a"><msubsup id="S3.SS4.p3.2.m2.1.1" xref="S3.SS4.p3.2.m2.1.1.cmml"><mi id="S3.SS4.p3.2.m2.1.1.2.2" xref="S3.SS4.p3.2.m2.1.1.2.2.cmml">F</mi><mi id="S3.SS4.p3.2.m2.1.1.2.3" xref="S3.SS4.p3.2.m2.1.1.2.3.cmml">i</mi><mi id="S3.SS4.p3.2.m2.1.1.3" xref="S3.SS4.p3.2.m2.1.1.3.cmml">pos</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.m2.1b"><apply id="S3.SS4.p3.2.m2.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m2.1.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1">superscript</csymbol><apply id="S3.SS4.p3.2.m2.1.1.2.cmml" xref="S3.SS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m2.1.1.2.1.cmml" xref="S3.SS4.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p3.2.m2.1.1.2.2.cmml" xref="S3.SS4.p3.2.m2.1.1.2.2">𝐹</ci><ci id="S3.SS4.p3.2.m2.1.1.2.3.cmml" xref="S3.SS4.p3.2.m2.1.1.2.3">𝑖</ci></apply><ci id="S3.SS4.p3.2.m2.1.1.3.cmml" xref="S3.SS4.p3.2.m2.1.1.3">pos</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.2.m2.1c">F_{i}^{\mathrm{pos}}</annotation></semantics></math> and <math id="S3.SS4.p3.3.m3.1" class="ltx_Math" alttext="F_{i}^{\mathrm{neg}}" display="inline"><semantics id="S3.SS4.p3.3.m3.1a"><msubsup id="S3.SS4.p3.3.m3.1.1" xref="S3.SS4.p3.3.m3.1.1.cmml"><mi id="S3.SS4.p3.3.m3.1.1.2.2" xref="S3.SS4.p3.3.m3.1.1.2.2.cmml">F</mi><mi id="S3.SS4.p3.3.m3.1.1.2.3" xref="S3.SS4.p3.3.m3.1.1.2.3.cmml">i</mi><mi id="S3.SS4.p3.3.m3.1.1.3" xref="S3.SS4.p3.3.m3.1.1.3.cmml">neg</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.3.m3.1b"><apply id="S3.SS4.p3.3.m3.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.3.m3.1.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1">superscript</csymbol><apply id="S3.SS4.p3.3.m3.1.1.2.cmml" xref="S3.SS4.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.3.m3.1.1.2.1.cmml" xref="S3.SS4.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p3.3.m3.1.1.2.2.cmml" xref="S3.SS4.p3.3.m3.1.1.2.2">𝐹</ci><ci id="S3.SS4.p3.3.m3.1.1.2.3.cmml" xref="S3.SS4.p3.3.m3.1.1.2.3">𝑖</ci></apply><ci id="S3.SS4.p3.3.m3.1.1.3.cmml" xref="S3.SS4.p3.3.m3.1.1.3">neg</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.3.m3.1c">F_{i}^{\mathrm{neg}}</annotation></semantics></math> are positive and negative pairs respectively, <math id="S3.SS4.p3.4.m4.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S3.SS4.p3.4.m4.1a"><msub id="S3.SS4.p3.4.m4.1.1" xref="S3.SS4.p3.4.m4.1.1.cmml"><mi id="S3.SS4.p3.4.m4.1.1.2" xref="S3.SS4.p3.4.m4.1.1.2.cmml">y</mi><mi id="S3.SS4.p3.4.m4.1.1.3" xref="S3.SS4.p3.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.4.m4.1b"><apply id="S3.SS4.p3.4.m4.1.1.cmml" xref="S3.SS4.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.4.m4.1.1.1.cmml" xref="S3.SS4.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS4.p3.4.m4.1.1.2.cmml" xref="S3.SS4.p3.4.m4.1.1.2">𝑦</ci><ci id="S3.SS4.p3.4.m4.1.1.3.cmml" xref="S3.SS4.p3.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.4.m4.1c">y_{i}</annotation></semantics></math> is a binary label indicating similarity, and
margin is a hyperparameter that defines the minimum distance between dissimilar pairs. Contrastive loss enhances the discriminative power of the ResNet features by ensuring that features from the same identity are close while features from different identities are separated, improving recognition performance.</p>
</div>
<div id="S3.SS4.p4" class="ltx_para">
<p id="S3.SS4.p4.2" class="ltx_p">The Transformer branch captures global contextual information using self-attention mechanisms. It uses triplet loss to enforce a relative distance constraint between anchor, positive, and negative samples:</p>
<table id="S3.E23" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E23.m1.3" class="ltx_Math" alttext="\mathcal{L}_{\text{triplet }}=\frac{1}{P}\sum_{i=1}^{P}\max\left(0,\left\|F_{i}^{\mathrm{trans}}-F_{i}^{\mathrm{pos}}\right\|^{2}-\left\|F_{i}^{\mathrm{trans}}-F_{i}^{\mathrm{neg}}\right\|^{2}+\text{ margin }\right)," display="block"><semantics id="S3.E23.m1.3a"><mrow id="S3.E23.m1.3.3.1" xref="S3.E23.m1.3.3.1.1.cmml"><mrow id="S3.E23.m1.3.3.1.1" xref="S3.E23.m1.3.3.1.1.cmml"><msub id="S3.E23.m1.3.3.1.1.3" xref="S3.E23.m1.3.3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E23.m1.3.3.1.1.3.2" xref="S3.E23.m1.3.3.1.1.3.2.cmml">ℒ</mi><mtext id="S3.E23.m1.3.3.1.1.3.3" xref="S3.E23.m1.3.3.1.1.3.3a.cmml">triplet </mtext></msub><mo id="S3.E23.m1.3.3.1.1.2" xref="S3.E23.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E23.m1.3.3.1.1.1" xref="S3.E23.m1.3.3.1.1.1.cmml"><mfrac id="S3.E23.m1.3.3.1.1.1.3" xref="S3.E23.m1.3.3.1.1.1.3.cmml"><mn id="S3.E23.m1.3.3.1.1.1.3.2" xref="S3.E23.m1.3.3.1.1.1.3.2.cmml">1</mn><mi id="S3.E23.m1.3.3.1.1.1.3.3" xref="S3.E23.m1.3.3.1.1.1.3.3.cmml">P</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E23.m1.3.3.1.1.1.2" xref="S3.E23.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E23.m1.3.3.1.1.1.1" xref="S3.E23.m1.3.3.1.1.1.1.cmml"><munderover id="S3.E23.m1.3.3.1.1.1.1.2" xref="S3.E23.m1.3.3.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E23.m1.3.3.1.1.1.1.2.2.2" xref="S3.E23.m1.3.3.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E23.m1.3.3.1.1.1.1.2.2.3" xref="S3.E23.m1.3.3.1.1.1.1.2.2.3.cmml"><mi id="S3.E23.m1.3.3.1.1.1.1.2.2.3.2" xref="S3.E23.m1.3.3.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E23.m1.3.3.1.1.1.1.2.2.3.1" xref="S3.E23.m1.3.3.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E23.m1.3.3.1.1.1.1.2.2.3.3" xref="S3.E23.m1.3.3.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E23.m1.3.3.1.1.1.1.2.3" xref="S3.E23.m1.3.3.1.1.1.1.2.3.cmml">P</mi></munderover><mrow id="S3.E23.m1.3.3.1.1.1.1.1.1" xref="S3.E23.m1.3.3.1.1.1.1.1.2.cmml"><mi id="S3.E23.m1.1.1" xref="S3.E23.m1.1.1.cmml">max</mi><mo id="S3.E23.m1.3.3.1.1.1.1.1.1a" xref="S3.E23.m1.3.3.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E23.m1.3.3.1.1.1.1.1.1.1" xref="S3.E23.m1.3.3.1.1.1.1.1.2.cmml"><mo id="S3.E23.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E23.m1.3.3.1.1.1.1.1.2.cmml">(</mo><mn id="S3.E23.m1.2.2" xref="S3.E23.m1.2.2.cmml">0</mn><mo id="S3.E23.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E23.m1.3.3.1.1.1.1.1.2.cmml">,</mo><mrow id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.cmml"><msup id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">F</mi><mi id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi><mi id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">trans</mi></msubsup><mo id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">F</mi><mi id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mi id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">pos</mi></msubsup></mrow><mo id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.3" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml">−</mo><msup id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.cmml"><mrow id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.2.cmml"><mo id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.2" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.2.1.cmml">‖</mo><mrow id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.cmml"><msubsup id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.2" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.2.cmml"><mi id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.2.2.2" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.2.2.2.cmml">F</mi><mi id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.2.2.3" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.2.2.3.cmml">i</mi><mi id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.2.3" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.2.3.cmml">trans</mi></msubsup><mo id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.1" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.1.cmml">−</mo><msubsup id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.3" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.3.cmml"><mi id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.3.2.2" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.3.2.2.cmml">F</mi><mi id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.3.2.3" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.3.2.3.cmml">i</mi><mi id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.3.3" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.3.3.cmml">neg</mi></msubsup></mrow><mo id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.3" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.2.1.cmml">‖</mo></mrow><mn id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.3.cmml">2</mn></msup></mrow><mo id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">+</mo><mtext id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.4" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.4a.cmml"> margin </mtext></mrow><mo id="S3.E23.m1.3.3.1.1.1.1.1.1.1.4" xref="S3.E23.m1.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E23.m1.3.3.1.2" xref="S3.E23.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E23.m1.3b"><apply id="S3.E23.m1.3.3.1.1.cmml" xref="S3.E23.m1.3.3.1"><eq id="S3.E23.m1.3.3.1.1.2.cmml" xref="S3.E23.m1.3.3.1.1.2"></eq><apply id="S3.E23.m1.3.3.1.1.3.cmml" xref="S3.E23.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E23.m1.3.3.1.1.3.1.cmml" xref="S3.E23.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.E23.m1.3.3.1.1.3.2.cmml" xref="S3.E23.m1.3.3.1.1.3.2">ℒ</ci><ci id="S3.E23.m1.3.3.1.1.3.3a.cmml" xref="S3.E23.m1.3.3.1.1.3.3"><mtext mathsize="70%" id="S3.E23.m1.3.3.1.1.3.3.cmml" xref="S3.E23.m1.3.3.1.1.3.3">triplet </mtext></ci></apply><apply id="S3.E23.m1.3.3.1.1.1.cmml" xref="S3.E23.m1.3.3.1.1.1"><times id="S3.E23.m1.3.3.1.1.1.2.cmml" xref="S3.E23.m1.3.3.1.1.1.2"></times><apply id="S3.E23.m1.3.3.1.1.1.3.cmml" xref="S3.E23.m1.3.3.1.1.1.3"><divide id="S3.E23.m1.3.3.1.1.1.3.1.cmml" xref="S3.E23.m1.3.3.1.1.1.3"></divide><cn type="integer" id="S3.E23.m1.3.3.1.1.1.3.2.cmml" xref="S3.E23.m1.3.3.1.1.1.3.2">1</cn><ci id="S3.E23.m1.3.3.1.1.1.3.3.cmml" xref="S3.E23.m1.3.3.1.1.1.3.3">𝑃</ci></apply><apply id="S3.E23.m1.3.3.1.1.1.1.cmml" xref="S3.E23.m1.3.3.1.1.1.1"><apply id="S3.E23.m1.3.3.1.1.1.1.2.cmml" xref="S3.E23.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E23.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E23.m1.3.3.1.1.1.1.2">superscript</csymbol><apply id="S3.E23.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E23.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E23.m1.3.3.1.1.1.1.2.2.1.cmml" xref="S3.E23.m1.3.3.1.1.1.1.2">subscript</csymbol><sum id="S3.E23.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S3.E23.m1.3.3.1.1.1.1.2.2.2"></sum><apply id="S3.E23.m1.3.3.1.1.1.1.2.2.3.cmml" xref="S3.E23.m1.3.3.1.1.1.1.2.2.3"><eq id="S3.E23.m1.3.3.1.1.1.1.2.2.3.1.cmml" xref="S3.E23.m1.3.3.1.1.1.1.2.2.3.1"></eq><ci id="S3.E23.m1.3.3.1.1.1.1.2.2.3.2.cmml" xref="S3.E23.m1.3.3.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E23.m1.3.3.1.1.1.1.2.2.3.3.cmml" xref="S3.E23.m1.3.3.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E23.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E23.m1.3.3.1.1.1.1.2.3">𝑃</ci></apply><apply id="S3.E23.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1"><max id="S3.E23.m1.1.1.cmml" xref="S3.E23.m1.1.1"></max><cn type="integer" id="S3.E23.m1.2.2.cmml" xref="S3.E23.m1.2.2">0</cn><apply id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1"><plus id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.3"></plus><apply id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2"><minus id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.3"></minus><apply id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝐹</ci><ci id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">trans</ci></apply><apply id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐹</ci><ci id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">pos</ci></apply></apply></apply><cn type="integer" id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.3">2</cn></apply><apply id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.2.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1"><csymbol cd="latexml" id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.2.1.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.2">norm</csymbol><apply id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1"><minus id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.1"></minus><apply id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.2.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.2.1.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.2">superscript</csymbol><apply id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.2.2.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.2.2.1.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.2">subscript</csymbol><ci id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.2.2.2.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.2.2.2">𝐹</ci><ci id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.2.2.3.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.2.3.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.2.3">trans</ci></apply><apply id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.3.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.3.1.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.3">superscript</csymbol><apply id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.3.2.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.3.2.1.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.3.2.2.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.3.2.2">𝐹</ci><ci id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.3.2.3.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.3.3.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.1.1.3.3">neg</ci></apply></apply></apply><cn type="integer" id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.2.2.3">2</cn></apply></apply><ci id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.4a.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.4"><mtext id="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1.1.1.1.4"> margin </mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E23.m1.3c">\mathcal{L}_{\text{triplet }}=\frac{1}{P}\sum_{i=1}^{P}\max\left(0,\left\|F_{i}^{\mathrm{trans}}-F_{i}^{\mathrm{pos}}\right\|^{2}-\left\|F_{i}^{\mathrm{trans}}-F_{i}^{\mathrm{neg}}\right\|^{2}+\text{ margin }\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(23)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p4.1" class="ltx_p">where <math id="S3.SS4.p4.1.m1.1" class="ltx_Math" alttext="F_{i}^{\mathrm{trans}}" display="inline"><semantics id="S3.SS4.p4.1.m1.1a"><msubsup id="S3.SS4.p4.1.m1.1.1" xref="S3.SS4.p4.1.m1.1.1.cmml"><mi id="S3.SS4.p4.1.m1.1.1.2.2" xref="S3.SS4.p4.1.m1.1.1.2.2.cmml">F</mi><mi id="S3.SS4.p4.1.m1.1.1.2.3" xref="S3.SS4.p4.1.m1.1.1.2.3.cmml">i</mi><mi id="S3.SS4.p4.1.m1.1.1.3" xref="S3.SS4.p4.1.m1.1.1.3.cmml">trans</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.1.m1.1b"><apply id="S3.SS4.p4.1.m1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.1.m1.1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1">superscript</csymbol><apply id="S3.SS4.p4.1.m1.1.1.2.cmml" xref="S3.SS4.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.1.m1.1.1.2.1.cmml" xref="S3.SS4.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p4.1.m1.1.1.2.2.cmml" xref="S3.SS4.p4.1.m1.1.1.2.2">𝐹</ci><ci id="S3.SS4.p4.1.m1.1.1.2.3.cmml" xref="S3.SS4.p4.1.m1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS4.p4.1.m1.1.1.3.cmml" xref="S3.SS4.p4.1.m1.1.1.3">trans</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.1.m1.1c">F_{i}^{\mathrm{trans}}</annotation></semantics></math> represents the feature vector from ResNet. Triplet loss ensures that the global features learned by the Transformer are sufficiently discriminative by maintaining the desired relative distances between feature embeddings, which is crucial for accurate Person Re-Identification.</p>
</div>
<div id="S3.SS4.p5" class="ltx_para">
<p id="S3.SS4.p5.4" class="ltx_p">Once trained, the features from these branches are concatenated or fused to create a unified representation. The combined feature vector incorporates:</p>
<table id="S3.E24" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E24.m1.1" class="ltx_Math" alttext="F_{Combined}=F_{pose}+F_{trans}+F_{res}." display="block"><semantics id="S3.E24.m1.1a"><mrow id="S3.E24.m1.1.1.1" xref="S3.E24.m1.1.1.1.1.cmml"><mrow id="S3.E24.m1.1.1.1.1" xref="S3.E24.m1.1.1.1.1.cmml"><msub id="S3.E24.m1.1.1.1.1.2" xref="S3.E24.m1.1.1.1.1.2.cmml"><mi id="S3.E24.m1.1.1.1.1.2.2" xref="S3.E24.m1.1.1.1.1.2.2.cmml">F</mi><mrow id="S3.E24.m1.1.1.1.1.2.3" xref="S3.E24.m1.1.1.1.1.2.3.cmml"><mi id="S3.E24.m1.1.1.1.1.2.3.2" xref="S3.E24.m1.1.1.1.1.2.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.E24.m1.1.1.1.1.2.3.1" xref="S3.E24.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E24.m1.1.1.1.1.2.3.3" xref="S3.E24.m1.1.1.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E24.m1.1.1.1.1.2.3.1a" xref="S3.E24.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E24.m1.1.1.1.1.2.3.4" xref="S3.E24.m1.1.1.1.1.2.3.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E24.m1.1.1.1.1.2.3.1b" xref="S3.E24.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E24.m1.1.1.1.1.2.3.5" xref="S3.E24.m1.1.1.1.1.2.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E24.m1.1.1.1.1.2.3.1c" xref="S3.E24.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E24.m1.1.1.1.1.2.3.6" xref="S3.E24.m1.1.1.1.1.2.3.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E24.m1.1.1.1.1.2.3.1d" xref="S3.E24.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E24.m1.1.1.1.1.2.3.7" xref="S3.E24.m1.1.1.1.1.2.3.7.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E24.m1.1.1.1.1.2.3.1e" xref="S3.E24.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E24.m1.1.1.1.1.2.3.8" xref="S3.E24.m1.1.1.1.1.2.3.8.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E24.m1.1.1.1.1.2.3.1f" xref="S3.E24.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E24.m1.1.1.1.1.2.3.9" xref="S3.E24.m1.1.1.1.1.2.3.9.cmml">d</mi></mrow></msub><mo id="S3.E24.m1.1.1.1.1.1" xref="S3.E24.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E24.m1.1.1.1.1.3" xref="S3.E24.m1.1.1.1.1.3.cmml"><msub id="S3.E24.m1.1.1.1.1.3.2" xref="S3.E24.m1.1.1.1.1.3.2.cmml"><mi id="S3.E24.m1.1.1.1.1.3.2.2" xref="S3.E24.m1.1.1.1.1.3.2.2.cmml">F</mi><mrow id="S3.E24.m1.1.1.1.1.3.2.3" xref="S3.E24.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E24.m1.1.1.1.1.3.2.3.2" xref="S3.E24.m1.1.1.1.1.3.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E24.m1.1.1.1.1.3.2.3.1" xref="S3.E24.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E24.m1.1.1.1.1.3.2.3.3" xref="S3.E24.m1.1.1.1.1.3.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E24.m1.1.1.1.1.3.2.3.1a" xref="S3.E24.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E24.m1.1.1.1.1.3.2.3.4" xref="S3.E24.m1.1.1.1.1.3.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E24.m1.1.1.1.1.3.2.3.1b" xref="S3.E24.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E24.m1.1.1.1.1.3.2.3.5" xref="S3.E24.m1.1.1.1.1.3.2.3.5.cmml">e</mi></mrow></msub><mo id="S3.E24.m1.1.1.1.1.3.1" xref="S3.E24.m1.1.1.1.1.3.1.cmml">+</mo><msub id="S3.E24.m1.1.1.1.1.3.3" xref="S3.E24.m1.1.1.1.1.3.3.cmml"><mi id="S3.E24.m1.1.1.1.1.3.3.2" xref="S3.E24.m1.1.1.1.1.3.3.2.cmml">F</mi><mrow id="S3.E24.m1.1.1.1.1.3.3.3" xref="S3.E24.m1.1.1.1.1.3.3.3.cmml"><mi id="S3.E24.m1.1.1.1.1.3.3.3.2" xref="S3.E24.m1.1.1.1.1.3.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E24.m1.1.1.1.1.3.3.3.1" xref="S3.E24.m1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E24.m1.1.1.1.1.3.3.3.3" xref="S3.E24.m1.1.1.1.1.3.3.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E24.m1.1.1.1.1.3.3.3.1a" xref="S3.E24.m1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E24.m1.1.1.1.1.3.3.3.4" xref="S3.E24.m1.1.1.1.1.3.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E24.m1.1.1.1.1.3.3.3.1b" xref="S3.E24.m1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E24.m1.1.1.1.1.3.3.3.5" xref="S3.E24.m1.1.1.1.1.3.3.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E24.m1.1.1.1.1.3.3.3.1c" xref="S3.E24.m1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E24.m1.1.1.1.1.3.3.3.6" xref="S3.E24.m1.1.1.1.1.3.3.3.6.cmml">s</mi></mrow></msub><mo id="S3.E24.m1.1.1.1.1.3.1a" xref="S3.E24.m1.1.1.1.1.3.1.cmml">+</mo><msub id="S3.E24.m1.1.1.1.1.3.4" xref="S3.E24.m1.1.1.1.1.3.4.cmml"><mi id="S3.E24.m1.1.1.1.1.3.4.2" xref="S3.E24.m1.1.1.1.1.3.4.2.cmml">F</mi><mrow id="S3.E24.m1.1.1.1.1.3.4.3" xref="S3.E24.m1.1.1.1.1.3.4.3.cmml"><mi id="S3.E24.m1.1.1.1.1.3.4.3.2" xref="S3.E24.m1.1.1.1.1.3.4.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E24.m1.1.1.1.1.3.4.3.1" xref="S3.E24.m1.1.1.1.1.3.4.3.1.cmml">​</mo><mi id="S3.E24.m1.1.1.1.1.3.4.3.3" xref="S3.E24.m1.1.1.1.1.3.4.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E24.m1.1.1.1.1.3.4.3.1a" xref="S3.E24.m1.1.1.1.1.3.4.3.1.cmml">​</mo><mi id="S3.E24.m1.1.1.1.1.3.4.3.4" xref="S3.E24.m1.1.1.1.1.3.4.3.4.cmml">s</mi></mrow></msub></mrow></mrow><mo lspace="0em" id="S3.E24.m1.1.1.1.2" xref="S3.E24.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E24.m1.1b"><apply id="S3.E24.m1.1.1.1.1.cmml" xref="S3.E24.m1.1.1.1"><eq id="S3.E24.m1.1.1.1.1.1.cmml" xref="S3.E24.m1.1.1.1.1.1"></eq><apply id="S3.E24.m1.1.1.1.1.2.cmml" xref="S3.E24.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E24.m1.1.1.1.1.2.1.cmml" xref="S3.E24.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E24.m1.1.1.1.1.2.2.cmml" xref="S3.E24.m1.1.1.1.1.2.2">𝐹</ci><apply id="S3.E24.m1.1.1.1.1.2.3.cmml" xref="S3.E24.m1.1.1.1.1.2.3"><times id="S3.E24.m1.1.1.1.1.2.3.1.cmml" xref="S3.E24.m1.1.1.1.1.2.3.1"></times><ci id="S3.E24.m1.1.1.1.1.2.3.2.cmml" xref="S3.E24.m1.1.1.1.1.2.3.2">𝐶</ci><ci id="S3.E24.m1.1.1.1.1.2.3.3.cmml" xref="S3.E24.m1.1.1.1.1.2.3.3">𝑜</ci><ci id="S3.E24.m1.1.1.1.1.2.3.4.cmml" xref="S3.E24.m1.1.1.1.1.2.3.4">𝑚</ci><ci id="S3.E24.m1.1.1.1.1.2.3.5.cmml" xref="S3.E24.m1.1.1.1.1.2.3.5">𝑏</ci><ci id="S3.E24.m1.1.1.1.1.2.3.6.cmml" xref="S3.E24.m1.1.1.1.1.2.3.6">𝑖</ci><ci id="S3.E24.m1.1.1.1.1.2.3.7.cmml" xref="S3.E24.m1.1.1.1.1.2.3.7">𝑛</ci><ci id="S3.E24.m1.1.1.1.1.2.3.8.cmml" xref="S3.E24.m1.1.1.1.1.2.3.8">𝑒</ci><ci id="S3.E24.m1.1.1.1.1.2.3.9.cmml" xref="S3.E24.m1.1.1.1.1.2.3.9">𝑑</ci></apply></apply><apply id="S3.E24.m1.1.1.1.1.3.cmml" xref="S3.E24.m1.1.1.1.1.3"><plus id="S3.E24.m1.1.1.1.1.3.1.cmml" xref="S3.E24.m1.1.1.1.1.3.1"></plus><apply id="S3.E24.m1.1.1.1.1.3.2.cmml" xref="S3.E24.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E24.m1.1.1.1.1.3.2.1.cmml" xref="S3.E24.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E24.m1.1.1.1.1.3.2.2.cmml" xref="S3.E24.m1.1.1.1.1.3.2.2">𝐹</ci><apply id="S3.E24.m1.1.1.1.1.3.2.3.cmml" xref="S3.E24.m1.1.1.1.1.3.2.3"><times id="S3.E24.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E24.m1.1.1.1.1.3.2.3.1"></times><ci id="S3.E24.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E24.m1.1.1.1.1.3.2.3.2">𝑝</ci><ci id="S3.E24.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E24.m1.1.1.1.1.3.2.3.3">𝑜</ci><ci id="S3.E24.m1.1.1.1.1.3.2.3.4.cmml" xref="S3.E24.m1.1.1.1.1.3.2.3.4">𝑠</ci><ci id="S3.E24.m1.1.1.1.1.3.2.3.5.cmml" xref="S3.E24.m1.1.1.1.1.3.2.3.5">𝑒</ci></apply></apply><apply id="S3.E24.m1.1.1.1.1.3.3.cmml" xref="S3.E24.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E24.m1.1.1.1.1.3.3.1.cmml" xref="S3.E24.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E24.m1.1.1.1.1.3.3.2.cmml" xref="S3.E24.m1.1.1.1.1.3.3.2">𝐹</ci><apply id="S3.E24.m1.1.1.1.1.3.3.3.cmml" xref="S3.E24.m1.1.1.1.1.3.3.3"><times id="S3.E24.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E24.m1.1.1.1.1.3.3.3.1"></times><ci id="S3.E24.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E24.m1.1.1.1.1.3.3.3.2">𝑡</ci><ci id="S3.E24.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E24.m1.1.1.1.1.3.3.3.3">𝑟</ci><ci id="S3.E24.m1.1.1.1.1.3.3.3.4.cmml" xref="S3.E24.m1.1.1.1.1.3.3.3.4">𝑎</ci><ci id="S3.E24.m1.1.1.1.1.3.3.3.5.cmml" xref="S3.E24.m1.1.1.1.1.3.3.3.5">𝑛</ci><ci id="S3.E24.m1.1.1.1.1.3.3.3.6.cmml" xref="S3.E24.m1.1.1.1.1.3.3.3.6">𝑠</ci></apply></apply><apply id="S3.E24.m1.1.1.1.1.3.4.cmml" xref="S3.E24.m1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S3.E24.m1.1.1.1.1.3.4.1.cmml" xref="S3.E24.m1.1.1.1.1.3.4">subscript</csymbol><ci id="S3.E24.m1.1.1.1.1.3.4.2.cmml" xref="S3.E24.m1.1.1.1.1.3.4.2">𝐹</ci><apply id="S3.E24.m1.1.1.1.1.3.4.3.cmml" xref="S3.E24.m1.1.1.1.1.3.4.3"><times id="S3.E24.m1.1.1.1.1.3.4.3.1.cmml" xref="S3.E24.m1.1.1.1.1.3.4.3.1"></times><ci id="S3.E24.m1.1.1.1.1.3.4.3.2.cmml" xref="S3.E24.m1.1.1.1.1.3.4.3.2">𝑟</ci><ci id="S3.E24.m1.1.1.1.1.3.4.3.3.cmml" xref="S3.E24.m1.1.1.1.1.3.4.3.3">𝑒</ci><ci id="S3.E24.m1.1.1.1.1.3.4.3.4.cmml" xref="S3.E24.m1.1.1.1.1.3.4.3.4">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E24.m1.1c">F_{Combined}=F_{pose}+F_{trans}+F_{res}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(24)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p5.3" class="ltx_p">where <math id="S3.SS4.p5.1.m1.1" class="ltx_Math" alttext="F_{pose}" display="inline"><semantics id="S3.SS4.p5.1.m1.1a"><msub id="S3.SS4.p5.1.m1.1.1" xref="S3.SS4.p5.1.m1.1.1.cmml"><mi id="S3.SS4.p5.1.m1.1.1.2" xref="S3.SS4.p5.1.m1.1.1.2.cmml">F</mi><mrow id="S3.SS4.p5.1.m1.1.1.3" xref="S3.SS4.p5.1.m1.1.1.3.cmml"><mi id="S3.SS4.p5.1.m1.1.1.3.2" xref="S3.SS4.p5.1.m1.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p5.1.m1.1.1.3.1" xref="S3.SS4.p5.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p5.1.m1.1.1.3.3" xref="S3.SS4.p5.1.m1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p5.1.m1.1.1.3.1a" xref="S3.SS4.p5.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p5.1.m1.1.1.3.4" xref="S3.SS4.p5.1.m1.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p5.1.m1.1.1.3.1b" xref="S3.SS4.p5.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p5.1.m1.1.1.3.5" xref="S3.SS4.p5.1.m1.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.1.m1.1b"><apply id="S3.SS4.p5.1.m1.1.1.cmml" xref="S3.SS4.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p5.1.m1.1.1.1.cmml" xref="S3.SS4.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p5.1.m1.1.1.2.cmml" xref="S3.SS4.p5.1.m1.1.1.2">𝐹</ci><apply id="S3.SS4.p5.1.m1.1.1.3.cmml" xref="S3.SS4.p5.1.m1.1.1.3"><times id="S3.SS4.p5.1.m1.1.1.3.1.cmml" xref="S3.SS4.p5.1.m1.1.1.3.1"></times><ci id="S3.SS4.p5.1.m1.1.1.3.2.cmml" xref="S3.SS4.p5.1.m1.1.1.3.2">𝑝</ci><ci id="S3.SS4.p5.1.m1.1.1.3.3.cmml" xref="S3.SS4.p5.1.m1.1.1.3.3">𝑜</ci><ci id="S3.SS4.p5.1.m1.1.1.3.4.cmml" xref="S3.SS4.p5.1.m1.1.1.3.4">𝑠</ci><ci id="S3.SS4.p5.1.m1.1.1.3.5.cmml" xref="S3.SS4.p5.1.m1.1.1.3.5">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.1.m1.1c">F_{pose}</annotation></semantics></math> is derived from pose estimation features, <math id="S3.SS4.p5.2.m2.1" class="ltx_Math" alttext="F_{res}" display="inline"><semantics id="S3.SS4.p5.2.m2.1a"><msub id="S3.SS4.p5.2.m2.1.1" xref="S3.SS4.p5.2.m2.1.1.cmml"><mi id="S3.SS4.p5.2.m2.1.1.2" xref="S3.SS4.p5.2.m2.1.1.2.cmml">F</mi><mrow id="S3.SS4.p5.2.m2.1.1.3" xref="S3.SS4.p5.2.m2.1.1.3.cmml"><mi id="S3.SS4.p5.2.m2.1.1.3.2" xref="S3.SS4.p5.2.m2.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p5.2.m2.1.1.3.1" xref="S3.SS4.p5.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p5.2.m2.1.1.3.3" xref="S3.SS4.p5.2.m2.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p5.2.m2.1.1.3.1a" xref="S3.SS4.p5.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p5.2.m2.1.1.3.4" xref="S3.SS4.p5.2.m2.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.2.m2.1b"><apply id="S3.SS4.p5.2.m2.1.1.cmml" xref="S3.SS4.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p5.2.m2.1.1.1.cmml" xref="S3.SS4.p5.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p5.2.m2.1.1.2.cmml" xref="S3.SS4.p5.2.m2.1.1.2">𝐹</ci><apply id="S3.SS4.p5.2.m2.1.1.3.cmml" xref="S3.SS4.p5.2.m2.1.1.3"><times id="S3.SS4.p5.2.m2.1.1.3.1.cmml" xref="S3.SS4.p5.2.m2.1.1.3.1"></times><ci id="S3.SS4.p5.2.m2.1.1.3.2.cmml" xref="S3.SS4.p5.2.m2.1.1.3.2">𝑟</ci><ci id="S3.SS4.p5.2.m2.1.1.3.3.cmml" xref="S3.SS4.p5.2.m2.1.1.3.3">𝑒</ci><ci id="S3.SS4.p5.2.m2.1.1.3.4.cmml" xref="S3.SS4.p5.2.m2.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.2.m2.1c">F_{res}</annotation></semantics></math> is from ResNet features, and <math id="S3.SS4.p5.3.m3.1" class="ltx_Math" alttext="F_{trans}" display="inline"><semantics id="S3.SS4.p5.3.m3.1a"><msub id="S3.SS4.p5.3.m3.1.1" xref="S3.SS4.p5.3.m3.1.1.cmml"><mi id="S3.SS4.p5.3.m3.1.1.2" xref="S3.SS4.p5.3.m3.1.1.2.cmml">F</mi><mrow id="S3.SS4.p5.3.m3.1.1.3" xref="S3.SS4.p5.3.m3.1.1.3.cmml"><mi id="S3.SS4.p5.3.m3.1.1.3.2" xref="S3.SS4.p5.3.m3.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p5.3.m3.1.1.3.1" xref="S3.SS4.p5.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p5.3.m3.1.1.3.3" xref="S3.SS4.p5.3.m3.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p5.3.m3.1.1.3.1a" xref="S3.SS4.p5.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p5.3.m3.1.1.3.4" xref="S3.SS4.p5.3.m3.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p5.3.m3.1.1.3.1b" xref="S3.SS4.p5.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p5.3.m3.1.1.3.5" xref="S3.SS4.p5.3.m3.1.1.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p5.3.m3.1.1.3.1c" xref="S3.SS4.p5.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p5.3.m3.1.1.3.6" xref="S3.SS4.p5.3.m3.1.1.3.6.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.3.m3.1b"><apply id="S3.SS4.p5.3.m3.1.1.cmml" xref="S3.SS4.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p5.3.m3.1.1.1.cmml" xref="S3.SS4.p5.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p5.3.m3.1.1.2.cmml" xref="S3.SS4.p5.3.m3.1.1.2">𝐹</ci><apply id="S3.SS4.p5.3.m3.1.1.3.cmml" xref="S3.SS4.p5.3.m3.1.1.3"><times id="S3.SS4.p5.3.m3.1.1.3.1.cmml" xref="S3.SS4.p5.3.m3.1.1.3.1"></times><ci id="S3.SS4.p5.3.m3.1.1.3.2.cmml" xref="S3.SS4.p5.3.m3.1.1.3.2">𝑡</ci><ci id="S3.SS4.p5.3.m3.1.1.3.3.cmml" xref="S3.SS4.p5.3.m3.1.1.3.3">𝑟</ci><ci id="S3.SS4.p5.3.m3.1.1.3.4.cmml" xref="S3.SS4.p5.3.m3.1.1.3.4">𝑎</ci><ci id="S3.SS4.p5.3.m3.1.1.3.5.cmml" xref="S3.SS4.p5.3.m3.1.1.3.5">𝑛</ci><ci id="S3.SS4.p5.3.m3.1.1.3.6.cmml" xref="S3.SS4.p5.3.m3.1.1.3.6">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.3.m3.1c">F_{trans}</annotation></semantics></math> is from Transformer features.</p>
</div>
<div id="S3.SS4.p6" class="ltx_para">
<p id="S3.SS4.p6.1" class="ltx_p">Training each branch with a specific loss function allows the model to leverage different types of information—local features, contextual understanding, and global representations. This comprehensive learning approach enhances the model’s ability to extract discriminative features and improve performance in Person Re-Identification tasks. By separately optimizing each branch for its specific role and then integrating their outputs, the model achieves higher accuracy and robustness in various scenarios.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments and Analysis</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">To verify the superiority of the proposed Tran-GCN method, experiments are conducted from both quantitative and qualitative angles. Specifically, ablation experiments and comparative experiments are adopted for quantitative analysis. In the comparative experiments, the Market-1501, DukeMTMC-ReID, and MSMT17 datasets commonly used in Person Re-Identification are employed to evaluate the proposed model.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Dataset</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">The Market-1501 dataset comprises 32,668 pedestrian images of 1,501 unique identities, captured by six cameras with different viewpoints on the Tsinghua University campus. The pedestrian bounding boxes in all images are extracted from the original video frames using the DPM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib56" title="" class="ltx_ref">56</a>]</cite> pedestrian detector. The training set contains 12,936 images from 751 identities, with an average of 71.2 images per identity. The test set includes 15,913 gallery images and 3,368 query images from 750 identities.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">The DukeMTMC-ReID dataset provideds a large dataset recorded by eight cameras, which included 36,411 labeled images of 1404 identities. The 1404 identities are randomly divided, with 702 identities for training and the others for testing. Among them, 16,522 images of 702 identities are used for training, and 2228 query images and 17,661 gallery images of 1110 identities for testing <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite>.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p">The MSMT17 dataset is the most recent and largest Person Re-Identification dataset that closely resembles real-world scenarios. It contains 126,441 images of 4,101 identities, captured by 15 cameras in a campus environment. The pedestrian bounding boxes are detected from the original video frames using the Faster-RCNN detector <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite>. The training set comprises 32,621 images from 1,041 identities, with an average of approximately 31.3 images per identity. The test set consists of 82,161 gallery images and 11,659 query images.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span> Experimental Environment</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">The primary environment is as follows: Python 3.7, PyTorch 1.6,64-bit Ubuntu 18.04 operating system, CPU: Xeon E5-2620, Memory: 32GB, GPU: NVIDIA GTX 2080Ti with 12GB VRAM, CUDA version: 11.1.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Evaluation Metrics</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">This paper uses two person re-identification evaluation metrics to evaluate the proposed model:</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">(1) Rank-k Hit Rate (Rank-k). It represents the probability that the target to be retrieved appears within the top k positions of the retrieval results. In this paper, Rank-1, Rank-5, and Rank-10 are selected as evaluation metrics to measure the model’s performance, with Rank-1 serving as an important reference. A higher Rank-1 value indicates a higher hit rate at the first position, signifying better model performance.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.1" class="ltx_p">(2) Mean Average Precision (mAP). To provide a more comprehensive assessment of the model’s overall performance, the mean Average Precision (mAP) is utilized as an evaluation criterion. mAP considers the positions of all images with the same ID as the retrieval target within the retrieval results. A higher mAP value indicates that the correct retrieval targets are ranked higher in the results, reflecting the algorithm’s average accuracy performance effectiveness of the Tran-GCN model.</p>
</div>
<div id="S4.SS3.p4" class="ltx_para">
<p id="S4.SS3.p4.1" class="ltx_p">Cumulative Matching Characteristic (CMC) curve and mean Average Precision (mAP). CMC demonstrates the accuracy of the top K individuals by calculating the true positives and false positives among the top K individuals in the ranked list. mAP measures the area under the precision-recall curve, reflecting the overall re-identification accuracy across the gallery set <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib59" title="" class="ltx_ref">59</a>]</cite>.</p>
</div>
<div id="S4.SS3.p5" class="ltx_para">
<p id="S4.SS3.p5.1" class="ltx_p">For the Tran-GCN performance is evaluated quantitatively by mean average precision (mAP) and cumulative matching characteristic (CMC) at Rank-1, Rank-5, Rank-10 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite>.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Ablation Experiments</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">To validate the effectiveness of the proposed Tran-GCN, we conducted ablation experiments on the Market-1501 dataset as shown in Table <a href="#S4.T1" title="Table 1 ‣ 4.4 Ablation Experiments ‣ 4 Experiments and Analysis ‣ Tran-GCN: A Transformer-Enhanced Graph Convolutional Network for Person Re-Identification in Monitoring Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. We employed different methods, including Baseline, GCM (without the addition of Transformer), and Tran-GCN, to derive the respective values for the evaluation metrics of Rank-1, Rank-5, Rank-10, and mAP.From Table <a href="#S4.T1" title="Table 1 ‣ 4.4 Ablation Experiments ‣ 4 Experiments and Analysis ‣ Tran-GCN: A Transformer-Enhanced Graph Convolutional Network for Person Re-Identification in Monitoring Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the ResNet-50 baseline method achieved an accuracy of 92.1% for Rank-1 and 81.7% for mAP. In contrast, the GCM improved performance significantly, achieving 96.4% for Rank-1 and 87.1% for mAP.When the Transformer was added to the GCM Module(Tran-GCN), the accuracy for Rank-1 and mAP improved to 97.4% and 87.9% respectively, representing an increase of 1.0% for mAP and 0.8% for Rank-1 over the GCM model, and an increase of 5.3% and 6.2% respectively over the baseline for Rank-1 and mAP.Thus,Tran-GCN can better extract local features and the global dependencies between feature sequences, and can further improve the recognition accuracy of the model.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Results of ablation experiments on the Market-1501 dataset.</figcaption>
<table id="S4.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">Method</th>
<th id="S4.T1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">Rank-1</th>
<th id="S4.T1.1.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">Rank-5</th>
<th id="S4.T1.1.1.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">Rank-10</th>
<th id="S4.T1.1.1.1.5" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_tt">mAP</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.1.2.1" class="ltx_tr">
<td id="S4.T1.1.2.1.1" class="ltx_td ltx_align_left ltx_border_t">Baseline</td>
<td id="S4.T1.1.2.1.2" class="ltx_td ltx_align_left ltx_border_t">92.0</td>
<td id="S4.T1.1.2.1.3" class="ltx_td ltx_align_left ltx_border_t">95.9</td>
<td id="S4.T1.1.2.1.4" class="ltx_td ltx_align_left ltx_border_t">98.0</td>
<td id="S4.T1.1.2.1.5" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t">81.6</td>
</tr>
<tr id="S4.T1.1.3.2" class="ltx_tr">
<td id="S4.T1.1.3.2.1" class="ltx_td ltx_align_left"><span id="S4.T1.1.3.2.1.1" class="ltx_text ltx_font_bold">GCM</span></td>
<td id="S4.T1.1.3.2.2" class="ltx_td ltx_align_left"><span id="S4.T1.1.3.2.2.1" class="ltx_text ltx_font_bold">96.2</span></td>
<td id="S4.T1.1.3.2.3" class="ltx_td ltx_align_left"><span id="S4.T1.1.3.2.3.1" class="ltx_text ltx_font_bold">98.0</span></td>
<td id="S4.T1.1.3.2.4" class="ltx_td ltx_align_left"><span id="S4.T1.1.3.2.4.1" class="ltx_text ltx_font_bold">98.8</span></td>
<td id="S4.T1.1.3.2.5" class="ltx_td ltx_nopad_r ltx_align_left"><span id="S4.T1.1.3.2.5.1" class="ltx_text ltx_font_bold">86.9</span></td>
</tr>
<tr id="S4.T1.1.4.3" class="ltx_tr">
<td id="S4.T1.1.4.3.1" class="ltx_td ltx_align_left ltx_border_bb"><span id="S4.T1.1.4.3.1.1" class="ltx_text ltx_font_bold">Tran-GCN</span></td>
<td id="S4.T1.1.4.3.2" class="ltx_td ltx_align_left ltx_border_bb"><span id="S4.T1.1.4.3.2.1" class="ltx_text ltx_font_bold">97.2</span></td>
<td id="S4.T1.1.4.3.3" class="ltx_td ltx_align_left ltx_border_bb"><span id="S4.T1.1.4.3.3.1" class="ltx_text ltx_font_bold">98.4</span></td>
<td id="S4.T1.1.4.3.4" class="ltx_td ltx_align_left ltx_border_bb"><span id="S4.T1.1.4.3.4.1" class="ltx_text ltx_font_bold">99.0</span></td>
<td id="S4.T1.1.4.3.5" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb"><span id="S4.T1.1.4.3.5.1" class="ltx_text ltx_font_bold">87.7</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.1" class="ltx_p">To verify the effectiveness of the constructed fine-grained and semantically localized features within the Transformer learning branch, we conducted ablation experiments on the Market-1501 dataset. This experiment employed three methods: RawP+Trans, CNN+Trans, and Ours. The three methods were executed under identical Transformer network parameters and experimental conditions, and the experimental results are presented in Fig. <a href="#S4.F2" title="Figure 2 ‣ 4.4 Ablation Experiments ‣ 4 Experiments and Analysis ‣ Tran-GCN: A Transformer-Enhanced Graph Convolutional Network for Person Re-Identification in Monitoring Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
Among the methods, the RawP+Trans approach directly divides the original pedestrian image horizontally and vertically to obtain feature sequences for each image patch, which are then input into the Transformer encoder model. The CNN+Trans method uses ResNet-50 to extract the pedestrian feature map, where the vector at each pixel location in the feature map is taken as the input feature sequence. After flattening and linear transformation, the input feature sequence is fed into the Transformer. Our method utilizes the first two stages of ResNet-50 to extract fine-grained pedestrian features, leveraging keypoint information to extract semantically localized features. These features are then flattened, concatenated, and linearly transformed to obtain the input features for the Transformer. As shown in Fig. <a href="#S4.F2" title="Figure 2 ‣ 4.4 Ablation Experiments ‣ 4 Experiments and Analysis ‣ Tran-GCN: A Transformer-Enhanced Graph Convolutional Network for Person Re-Identification in Monitoring Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, our proposed method achieves an accuracy of 87.9% for mAP and 97.4% for Rank-1. This approach not only retains detailed features from the original image but also extracts more semantically localized regional features of pedestrians, resulting in more discriminative pedestrian features and higher recognition accuracy.</p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2409.09391/assets/x2.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="338" height="187" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Experimental results of different partitioning methods for Transformer input.)</figcaption>
</figure>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Comparative Experiments</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">To further verify the effectiveness of the Tran-GCN model proposed in this paper, we conducted comparative experiments on three public datasets (Market-1501, DukeMTMC-ReID, and MSMT17).</p>
</div>
<div id="S4.SS5.p2" class="ltx_para">
<p id="S4.SS5.p2.1" class="ltx_p">From table <a href="#S4.T2" title="Table 2 ‣ 4.5 Comparative Experiments ‣ 4 Experiments and Analysis ‣ Tran-GCN: A Transformer-Enhanced Graph Convolutional Network for Person Re-Identification in Monitoring Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, it shows the comparative experimental results of the Tran-GCN model on the Market1501 dataset. The compared methods include part-based methods (PCB, PCB+RPP, AlignedReID, MGN, Deep-pedestrian), mask-based methods (MGCAM, MaskReID, SPReID), and pose-based methods (SpindleNet, PIE, PDC, PAR, PSE, etc.). Tran-GCN achieves accuracies of 97.4%, 98.4%, 99.0%, and 87.9% for Rank-1, Rank-5, Rank-10, and mAP, respectively, on this dataset, surpassing most mainstream methods. This indicates that Tran-GCN can effectively aggregate the global dependencies among fine-grained local features of pedestrians, enabling the model to focus on more important local regions and further improving recognition accuracy.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Comparative Experimental Results of Tran-GCN on Market-1501 Dataset.</figcaption>
<table id="S4.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.1.1.1" class="ltx_tr">
<th id="S4.T2.1.1.1.1" class="ltx_td ltx_align_top ltx_th ltx_th_row ltx_border_tt"></th>
<td id="S4.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T2.1.1.1.2.1" class="ltx_text ltx_font_italic">Method</span></td>
<td id="S4.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T2.1.1.1.3.1" class="ltx_text ltx_font_italic">Rank-1</span></td>
<td id="S4.T2.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T2.1.1.1.4.1" class="ltx_text ltx_font_italic">Rank-5</span></td>
<td id="S4.T2.1.1.1.5" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T2.1.1.1.5.1" class="ltx_text ltx_font_italic">Rank-10</span></td>
<td id="S4.T2.1.1.1.6" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T2.1.1.1.6.1" class="ltx_text ltx_font_italic">mAP</span></td>
</tr>
<tr id="S4.T2.1.2.2" class="ltx_tr">
<th id="S4.T2.1.2.2.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_t" rowspan="5">
<span id="S4.T2.1.2.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.1.2.2.1.1.1" class="ltx_p" style="width:93.9pt;"><span id="S4.T2.1.2.2.1.1.1.1" class="ltx_text">Part-based methods</span></span>
</span>
</th>
<td id="S4.T2.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t">PCB<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>
</td>
<td id="S4.T2.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t">92.3</td>
<td id="S4.T2.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t">97.2</td>
<td id="S4.T2.1.2.2.5" class="ltx_td ltx_align_center ltx_border_t">98.2</td>
<td id="S4.T2.1.2.2.6" class="ltx_td ltx_align_center ltx_border_t">77.4</td>
</tr>
<tr id="S4.T2.1.3.3" class="ltx_tr">
<td id="S4.T2.1.3.3.1" class="ltx_td ltx_align_center">PCB+RPP<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>
</td>
<td id="S4.T2.1.3.3.2" class="ltx_td ltx_align_center">93.8</td>
<td id="S4.T2.1.3.3.3" class="ltx_td ltx_align_center">97.5</td>
<td id="S4.T2.1.3.3.4" class="ltx_td ltx_align_center">98.5</td>
<td id="S4.T2.1.3.3.5" class="ltx_td ltx_align_center">81.6</td>
</tr>
<tr id="S4.T2.1.4.4" class="ltx_tr">
<td id="S4.T2.1.4.4.1" class="ltx_td ltx_align_center">AlignedReID<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>
</td>
<td id="S4.T2.1.4.4.2" class="ltx_td ltx_align_center">91.8</td>
<td id="S4.T2.1.4.4.3" class="ltx_td ltx_align_center">97.1</td>
<td id="S4.T2.1.4.4.4" class="ltx_td ltx_align_center">- 79.2</td>
<td id="S4.T2.1.4.4.5" class="ltx_td"></td>
</tr>
<tr id="S4.T2.1.5.5" class="ltx_tr">
<td id="S4.T2.1.5.5.1" class="ltx_td ltx_align_center">MGN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>
</td>
<td id="S4.T2.1.5.5.2" class="ltx_td ltx_align_center">95.7</td>
<td id="S4.T2.1.5.5.3" class="ltx_td ltx_align_center">-</td>
<td id="S4.T2.1.5.5.4" class="ltx_td ltx_align_center">-</td>
<td id="S4.T2.1.5.5.5" class="ltx_td ltx_align_center">86.9</td>
</tr>
<tr id="S4.T2.1.6.6" class="ltx_tr">
<td id="S4.T2.1.6.6.1" class="ltx_td ltx_align_center">Deep-pedestrian<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>
</td>
<td id="S4.T2.1.6.6.2" class="ltx_td ltx_align_center">92.3</td>
<td id="S4.T2.1.6.6.3" class="ltx_td ltx_align_center">-</td>
<td id="S4.T2.1.6.6.4" class="ltx_td ltx_align_center">-</td>
<td id="S4.T2.1.6.6.5" class="ltx_td ltx_align_center">79.6</td>
</tr>
<tr id="S4.T2.1.7.7" class="ltx_tr">
<th id="S4.T2.1.7.7.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_t" rowspan="3">
<span id="S4.T2.1.7.7.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.1.7.7.1.1.1" class="ltx_p" style="width:93.9pt;"><span id="S4.T2.1.7.7.1.1.1.1" class="ltx_text">Mask-based methods</span></span>
</span>
</th>
<td id="S4.T2.1.7.7.2" class="ltx_td ltx_align_center ltx_border_t">MGCAM<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>
</td>
<td id="S4.T2.1.7.7.3" class="ltx_td ltx_align_center ltx_border_t">83.8</td>
<td id="S4.T2.1.7.7.4" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S4.T2.1.7.7.5" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S4.T2.1.7.7.6" class="ltx_td ltx_align_center ltx_border_t">74.3</td>
</tr>
<tr id="S4.T2.1.8.8" class="ltx_tr">
<td id="S4.T2.1.8.8.1" class="ltx_td ltx_align_center">MaskeReID<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>
</td>
<td id="S4.T2.1.8.8.2" class="ltx_td ltx_align_center">90.0</td>
<td id="S4.T2.1.8.8.3" class="ltx_td ltx_align_center">-</td>
<td id="S4.T2.1.8.8.4" class="ltx_td ltx_align_center">-</td>
<td id="S4.T2.1.8.8.5" class="ltx_td ltx_align_center">75.3</td>
</tr>
<tr id="S4.T2.1.9.9" class="ltx_tr">
<td id="S4.T2.1.9.9.1" class="ltx_td ltx_align_center">SPReID<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>
</td>
<td id="S4.T2.1.9.9.2" class="ltx_td ltx_align_center">92.5</td>
<td id="S4.T2.1.9.9.3" class="ltx_td ltx_align_center">97.2</td>
<td id="S4.T2.1.9.9.4" class="ltx_td ltx_align_center">98.1</td>
<td id="S4.T2.1.9.9.5" class="ltx_td ltx_align_center">81.3</td>
</tr>
<tr id="S4.T2.1.10.10" class="ltx_tr">
<th id="S4.T2.1.10.10.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_t" rowspan="10">
<span id="S4.T2.1.10.10.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T2.1.10.10.1.1.1" class="ltx_p" style="width:93.9pt;"><span id="S4.T2.1.10.10.1.1.1.1" class="ltx_text">Pose-based methods</span></span>
</span>
</th>
<td id="S4.T2.1.10.10.2" class="ltx_td ltx_align_center ltx_border_t">SpindleNet<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>
</td>
<td id="S4.T2.1.10.10.3" class="ltx_td ltx_align_center ltx_border_t">76.9</td>
<td id="S4.T2.1.10.10.4" class="ltx_td ltx_align_center ltx_border_t">91.5</td>
<td id="S4.T2.1.10.10.5" class="ltx_td ltx_align_center ltx_border_t">94.6</td>
<td id="S4.T2.1.10.10.6" class="ltx_td ltx_align_center ltx_border_t">-</td>
</tr>
<tr id="S4.T2.1.11.11" class="ltx_tr">
<td id="S4.T2.1.11.11.1" class="ltx_td ltx_align_center">PIE<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>
</td>
<td id="S4.T2.1.11.11.2" class="ltx_td ltx_align_center">78.7</td>
<td id="S4.T2.1.11.11.3" class="ltx_td ltx_align_center">90.3</td>
<td id="S4.T2.1.11.11.4" class="ltx_td ltx_align_center">93.4</td>
<td id="S4.T2.1.11.11.5" class="ltx_td ltx_align_center">53.9</td>
</tr>
<tr id="S4.T2.1.12.12" class="ltx_tr">
<td id="S4.T2.1.12.12.1" class="ltx_td ltx_align_center">PDC<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>
</td>
<td id="S4.T2.1.12.12.2" class="ltx_td ltx_align_center">84.1</td>
<td id="S4.T2.1.12.12.3" class="ltx_td ltx_align_center">92.7</td>
<td id="S4.T2.1.12.12.4" class="ltx_td ltx_align_center">94.9</td>
<td id="S4.T2.1.12.12.5" class="ltx_td ltx_align_center">63.4</td>
</tr>
<tr id="S4.T2.1.13.13" class="ltx_tr">
<td id="S4.T2.1.13.13.1" class="ltx_td ltx_align_center">PAR<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite>
</td>
<td id="S4.T2.1.13.13.2" class="ltx_td ltx_align_center">81.0</td>
<td id="S4.T2.1.13.13.3" class="ltx_td ltx_align_center">92.0</td>
<td id="S4.T2.1.13.13.4" class="ltx_td ltx_align_center">94.7</td>
<td id="S4.T2.1.13.13.5" class="ltx_td ltx_align_center">63.4</td>
</tr>
<tr id="S4.T2.1.14.14" class="ltx_tr">
<td id="S4.T2.1.14.14.1" class="ltx_td ltx_align_center">PSE<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite>
</td>
<td id="S4.T2.1.14.14.2" class="ltx_td ltx_align_center">87.1</td>
<td id="S4.T2.1.14.14.3" class="ltx_td ltx_align_center">-</td>
<td id="S4.T2.1.14.14.4" class="ltx_td ltx_align_center">-</td>
<td id="S4.T2.1.14.14.5" class="ltx_td ltx_align_center">69.0</td>
</tr>
<tr id="S4.T2.1.15.15" class="ltx_tr">
<td id="S4.T2.1.15.15.1" class="ltx_td ltx_align_center">Part-Aligned<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>
</td>
<td id="S4.T2.1.15.15.2" class="ltx_td ltx_align_center">91.7</td>
<td id="S4.T2.1.15.15.3" class="ltx_td ltx_align_center">-</td>
<td id="S4.T2.1.15.15.4" class="ltx_td ltx_align_center">-</td>
<td id="S4.T2.1.15.15.5" class="ltx_td ltx_align_center">79.6</td>
</tr>
<tr id="S4.T2.1.16.16" class="ltx_tr">
<td id="S4.T2.1.16.16.1" class="ltx_td ltx_align_center">PGR<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib61" title="" class="ltx_ref">61</a>]</cite>
</td>
<td id="S4.T2.1.16.16.2" class="ltx_td ltx_align_center">93.8</td>
<td id="S4.T2.1.16.16.3" class="ltx_td ltx_align_center">97.7</td>
<td id="S4.T2.1.16.16.4" class="ltx_td ltx_align_center">-</td>
<td id="S4.T2.1.16.16.5" class="ltx_td ltx_align_center">77.2</td>
</tr>
<tr id="S4.T2.1.17.17" class="ltx_tr">
<td id="S4.T2.1.17.17.1" class="ltx_td ltx_align_center">PGFA<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib62" title="" class="ltx_ref">62</a>]</cite>
</td>
<td id="S4.T2.1.17.17.2" class="ltx_td ltx_align_center">91.2</td>
<td id="S4.T2.1.17.17.3" class="ltx_td ltx_align_center">-</td>
<td id="S4.T2.1.17.17.4" class="ltx_td ltx_align_center">-</td>
<td id="S4.T2.1.17.17.5" class="ltx_td ltx_align_center">76.8</td>
</tr>
<tr id="S4.T2.1.18.18" class="ltx_tr">
<td id="S4.T2.1.18.18.1" class="ltx_td ltx_align_center">Pose-transfer<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib63" title="" class="ltx_ref">63</a>]</cite>
</td>
<td id="S4.T2.1.18.18.2" class="ltx_td ltx_align_center">87.7</td>
<td id="S4.T2.1.18.18.3" class="ltx_td ltx_align_center">-</td>
<td id="S4.T2.1.18.18.4" class="ltx_td ltx_align_center">-</td>
<td id="S4.T2.1.18.18.5" class="ltx_td ltx_align_center">68.9</td>
</tr>
<tr id="S4.T2.1.19.19" class="ltx_tr">
<td id="S4.T2.1.19.19.1" class="ltx_td ltx_align_center">PN-GAN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib64" title="" class="ltx_ref">64</a>]</cite>
</td>
<td id="S4.T2.1.19.19.2" class="ltx_td ltx_align_center">89.4</td>
<td id="S4.T2.1.19.19.3" class="ltx_td ltx_align_center">-</td>
<td id="S4.T2.1.19.19.4" class="ltx_td ltx_align_center">-</td>
<td id="S4.T2.1.19.19.5" class="ltx_td ltx_align_center">72.6</td>
</tr>
<tr id="S4.T2.1.20.20" class="ltx_tr">
<th id="S4.T2.1.20.20.1" class="ltx_td ltx_align_top ltx_th ltx_th_row ltx_border_bb ltx_border_t" rowspan="2"></th>
<td id="S4.T2.1.20.20.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.1.20.20.2.1" class="ltx_text ltx_font_bold">GCM</span></td>
<td id="S4.T2.1.20.20.3" class="ltx_td ltx_align_center ltx_border_t">96.3</td>
<td id="S4.T2.1.20.20.4" class="ltx_td ltx_align_center ltx_border_t">98.1</td>
<td id="S4.T2.1.20.20.5" class="ltx_td ltx_align_center ltx_border_t">98.9</td>
<td id="S4.T2.1.20.20.6" class="ltx_td ltx_align_center ltx_border_t">87.0</td>
</tr>
<tr id="S4.T2.1.21.21" class="ltx_tr">
<td id="S4.T2.1.21.21.1" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.1.21.21.1.1" class="ltx_text ltx_font_bold">Tran-GCN</span></td>
<td id="S4.T2.1.21.21.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.1.21.21.2.1" class="ltx_text ltx_font_bold">97.2</span></td>
<td id="S4.T2.1.21.21.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.1.21.21.3.1" class="ltx_text ltx_font_bold">98.4</span></td>
<td id="S4.T2.1.21.21.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.1.21.21.4.1" class="ltx_text ltx_font_bold">99.0</span></td>
<td id="S4.T2.1.21.21.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.1.21.21.5.1" class="ltx_text ltx_font_bold">87.7</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS5.p3" class="ltx_para">
<p id="S4.SS5.p3.1" class="ltx_p">From Table <a href="#S4.T3" title="Table 3 ‣ 4.5 Comparative Experiments ‣ 4 Experiments and Analysis ‣ Tran-GCN: A Transformer-Enhanced Graph Convolutional Network for Person Re-Identification in Monitoring Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, it presents the comparative experimental results of the Tran-GCN model on the DukeMTMC-ReID dataset. It indicates that Tran-GCN outperforms most mainstream methods on this dataset, achieving accuracies of 88.3%, 93.8%, 96.0%, and 78.2% for Rank-1, Rank-5, Rank-10, and mAP, respectively. Its performance is comparable to the MGN method, which is known for its high accuracy among horizontal partition-based methods. This proves the effectiveness of incorporating the Transformer Learning Module.</p>
</div>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Comparative Experimental Results of Tran-GCN on DukeMTMC-ReID Dataset.</figcaption>
<table id="S4.T3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.1.1.1" class="ltx_tr">
<th id="S4.T3.1.1.1.1" class="ltx_td ltx_align_top ltx_th ltx_th_row ltx_border_tt"></th>
<th id="S4.T3.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T3.1.1.1.2.1" class="ltx_text ltx_font_italic">Method</span></th>
<th id="S4.T3.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T3.1.1.1.3.1" class="ltx_text ltx_font_italic">Rank-1</span></th>
<th id="S4.T3.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T3.1.1.1.4.1" class="ltx_text ltx_font_italic">Rank-5</span></th>
<th id="S4.T3.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T3.1.1.1.5.1" class="ltx_text ltx_font_italic">Rank-10</span></th>
<th id="S4.T3.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T3.1.1.1.6.1" class="ltx_text ltx_font_italic">mAP</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.1.2.1" class="ltx_tr">
<th id="S4.T3.1.2.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_t" rowspan="4">
<span id="S4.T3.1.2.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T3.1.2.1.1.1.1" class="ltx_p" style="width:93.9pt;"><span id="S4.T3.1.2.1.1.1.1.1" class="ltx_text">Part-based methods</span></span>
</span>
</th>
<td id="S4.T3.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">PCB<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>
</td>
<td id="S4.T3.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">81.7</td>
<td id="S4.T3.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S4.T3.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S4.T3.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t">66.1</td>
</tr>
<tr id="S4.T3.1.3.2" class="ltx_tr">
<td id="S4.T3.1.3.2.1" class="ltx_td ltx_align_center">PCB+RPP<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>
</td>
<td id="S4.T3.1.3.2.2" class="ltx_td ltx_align_center">83.3</td>
<td id="S4.T3.1.3.2.3" class="ltx_td ltx_align_center">-</td>
<td id="S4.T3.1.3.2.4" class="ltx_td ltx_align_center">-</td>
<td id="S4.T3.1.3.2.5" class="ltx_td ltx_align_center">69.2</td>
</tr>
<tr id="S4.T3.1.4.3" class="ltx_tr">
<td id="S4.T3.1.4.3.1" class="ltx_td ltx_align_center">MGN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>
</td>
<td id="S4.T3.1.4.3.2" class="ltx_td ltx_align_center">88.7</td>
<td id="S4.T3.1.4.3.3" class="ltx_td ltx_align_center">-</td>
<td id="S4.T3.1.4.3.4" class="ltx_td ltx_align_center">-</td>
<td id="S4.T3.1.4.3.5" class="ltx_td ltx_align_center">78.4</td>
</tr>
<tr id="S4.T3.1.5.4" class="ltx_tr">
<td id="S4.T3.1.5.4.1" class="ltx_td ltx_align_center">Deep-pedestrian<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>
</td>
<td id="S4.T3.1.5.4.2" class="ltx_td ltx_align_center">80.9</td>
<td id="S4.T3.1.5.4.3" class="ltx_td ltx_align_center">-</td>
<td id="S4.T3.1.5.4.4" class="ltx_td ltx_align_center">-</td>
<td id="S4.T3.1.5.4.5" class="ltx_td ltx_align_center">64.8</td>
</tr>
<tr id="S4.T3.1.6.5" class="ltx_tr">
<th id="S4.T3.1.6.5.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_t" rowspan="2">
<span id="S4.T3.1.6.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T3.1.6.5.1.1.1" class="ltx_p" style="width:93.9pt;"><span id="S4.T3.1.6.5.1.1.1.1" class="ltx_text">Mask-based methods</span></span>
</span>
</th>
<td id="S4.T3.1.6.5.2" class="ltx_td ltx_align_center ltx_border_t">MaskReID<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>
</td>
<td id="S4.T3.1.6.5.3" class="ltx_td ltx_align_center ltx_border_t">78.7</td>
<td id="S4.T3.1.6.5.4" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S4.T3.1.6.5.5" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S4.T3.1.6.5.6" class="ltx_td ltx_align_center ltx_border_t">61.9</td>
</tr>
<tr id="S4.T3.1.7.6" class="ltx_tr">
<td id="S4.T3.1.7.6.1" class="ltx_td ltx_align_center">SPReID<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>
</td>
<td id="S4.T3.1.7.6.2" class="ltx_td ltx_align_center">85.9</td>
<td id="S4.T3.1.7.6.3" class="ltx_td ltx_align_center">92.9</td>
<td id="S4.T3.1.7.6.4" class="ltx_td ltx_align_center">94.5</td>
<td id="S4.T3.1.7.6.5" class="ltx_td ltx_align_center">73.3</td>
</tr>
<tr id="S4.T3.1.8.7" class="ltx_tr">
<th id="S4.T3.1.8.7.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_t" rowspan="10">
<span id="S4.T3.1.8.7.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T3.1.8.7.1.1.1" class="ltx_p" style="width:93.9pt;"><span id="S4.T3.1.8.7.1.1.1.1" class="ltx_text">Pose-based methods</span></span>
</span>
</th>
<td id="S4.T3.1.8.7.2" class="ltx_td ltx_align_center ltx_border_t">PSE<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite>
</td>
<td id="S4.T3.1.8.7.3" class="ltx_td ltx_align_center ltx_border_t">79.8</td>
<td id="S4.T3.1.8.7.4" class="ltx_td ltx_align_center ltx_border_t">89.7</td>
<td id="S4.T3.1.8.7.5" class="ltx_td ltx_align_center ltx_border_t">92.2</td>
<td id="S4.T3.1.8.7.6" class="ltx_td ltx_align_center ltx_border_t">62.0</td>
</tr>
<tr id="S4.T3.1.9.8" class="ltx_tr">
<td id="S4.T3.1.9.8.1" class="ltx_td ltx_align_center">Part-Aligned<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>
</td>
<td id="S4.T3.1.9.8.2" class="ltx_td ltx_align_center">84.4</td>
<td id="S4.T3.1.9.8.3" class="ltx_td ltx_align_center">-</td>
<td id="S4.T3.1.9.8.4" class="ltx_td ltx_align_center">-</td>
<td id="S4.T3.1.9.8.5" class="ltx_td ltx_align_center">69.3</td>
</tr>
<tr id="S4.T3.1.10.9" class="ltx_tr">
<td id="S4.T3.1.10.9.1" class="ltx_td ltx_align_center">PGR<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib61" title="" class="ltx_ref">61</a>]</cite>
</td>
<td id="S4.T3.1.10.9.2" class="ltx_td ltx_align_center">83.6</td>
<td id="S4.T3.1.10.9.3" class="ltx_td ltx_align_center">89.7</td>
<td id="S4.T3.1.10.9.4" class="ltx_td ltx_align_center">92.2</td>
<td id="S4.T3.1.10.9.5" class="ltx_td ltx_align_center">65.9</td>
</tr>
<tr id="S4.T3.1.11.10" class="ltx_tr">
<td id="S4.T3.1.11.10.1" class="ltx_td ltx_align_center">PGFA<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib62" title="" class="ltx_ref">62</a>]</cite>
</td>
<td id="S4.T3.1.11.10.2" class="ltx_td ltx_align_center">82.6</td>
<td id="S4.T3.1.11.10.3" class="ltx_td ltx_align_center">-</td>
<td id="S4.T3.1.11.10.4" class="ltx_td ltx_align_center">-</td>
<td id="S4.T3.1.11.10.5" class="ltx_td ltx_align_center">76.8</td>
</tr>
<tr id="S4.T3.1.12.11" class="ltx_tr">
<td id="S4.T3.1.12.11.1" class="ltx_td ltx_align_center">Pose-transfer<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib63" title="" class="ltx_ref">63</a>]</cite>
</td>
<td id="S4.T3.1.12.11.2" class="ltx_td ltx_align_center">78.5</td>
<td id="S4.T3.1.12.11.3" class="ltx_td ltx_align_center">-</td>
<td id="S4.T3.1.12.11.4" class="ltx_td ltx_align_center">-</td>
<td id="S4.T3.1.12.11.5" class="ltx_td ltx_align_center">56.5</td>
</tr>
<tr id="S4.T3.1.13.12" class="ltx_tr">
<td id="S4.T3.1.13.12.1" class="ltx_td ltx_align_center">PN-GAN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib64" title="" class="ltx_ref">64</a>]</cite>
</td>
<td id="S4.T3.1.13.12.2" class="ltx_td ltx_align_center">73.6</td>
<td id="S4.T3.1.13.12.3" class="ltx_td ltx_align_center">-</td>
<td id="S4.T3.1.13.12.4" class="ltx_td ltx_align_center">-</td>
<td id="S4.T3.1.13.12.5" class="ltx_td ltx_align_center">53.2</td>
</tr>
<tr id="S4.T3.1.14.13" class="ltx_tr">
<td id="S4.T3.1.14.13.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.14.13.1.1" class="ltx_text ltx_font_bold">GCM</span></td>
<td id="S4.T3.1.14.13.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.14.13.2.1" class="ltx_text ltx_font_bold">87.5</span></td>
<td id="S4.T3.1.14.13.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.14.13.3.1" class="ltx_text ltx_font_bold">93.3</span></td>
<td id="S4.T3.1.14.13.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.14.13.4.1" class="ltx_text ltx_font_bold">95.6</span></td>
<td id="S4.T3.1.14.13.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.14.13.5.1" class="ltx_text ltx_font_bold">77.1</span></td>
</tr>
<tr id="S4.T3.1.15.14" class="ltx_tr">
<td id="S4.T3.1.15.14.1" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.1.15.14.1.1" class="ltx_text ltx_font_bold">Tran-GCN</span></td>
<td id="S4.T3.1.15.14.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.1.15.14.2.1" class="ltx_text ltx_font_bold">88.3</span></td>
<td id="S4.T3.1.15.14.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.1.15.14.3.1" class="ltx_text ltx_font_bold">93.8</span></td>
<td id="S4.T3.1.15.14.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.1.15.14.4.1" class="ltx_text ltx_font_bold">96.2</span></td>
<td id="S4.T3.1.15.14.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.1.15.14.5.1" class="ltx_text ltx_font_bold">78.2</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS5.p4" class="ltx_para">
<p id="S4.SS5.p4.1" class="ltx_p">Table <a href="#S4.T4" title="Table 4 ‣ 4.5 Comparative Experiments ‣ 4 Experiments and Analysis ‣ Tran-GCN: A Transformer-Enhanced Graph Convolutional Network for Person Re-Identification in Monitoring Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> displays the comparative experimental results of Tran-GCN on the even larger MSMT17 dataset. The proposed method Tran-GCN improves the accuracies of Rank-1 and mAP by 1.8% and 2.3% than GCM, respectively, and surpasses most classical algorithms. This proves the effectiveness and advanced nature of Tran-GCN on large-scale datasets.</p>
</div>
<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Comparative Experimental Results of Tran-GCN on MSMT17 Dataset(%).</figcaption>
<table id="S4.T4.1" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T4.1.1.1" class="ltx_tr">
<td id="S4.T4.1.1.1.1" class="ltx_td ltx_align_left ltx_border_tt"><span id="S4.T4.1.1.1.1.1" class="ltx_text ltx_font_italic">Method</span></td>
<td id="S4.T4.1.1.1.2" class="ltx_td ltx_align_left ltx_border_tt">Rank-1</td>
<td id="S4.T4.1.1.1.3" class="ltx_td ltx_align_left ltx_border_tt">Rank-5</td>
<td id="S4.T4.1.1.1.4" class="ltx_td ltx_align_left ltx_border_tt">Rank-10</td>
<td id="S4.T4.1.1.1.5" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_tt">mAP</td>
</tr>
<tr id="S4.T4.1.2.2" class="ltx_tr">
<td id="S4.T4.1.2.2.1" class="ltx_td ltx_align_left ltx_border_t">GoogLeNet<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib65" title="" class="ltx_ref">65</a>]</cite>
</td>
<td id="S4.T4.1.2.2.2" class="ltx_td ltx_align_left ltx_border_t">47.6</td>
<td id="S4.T4.1.2.2.3" class="ltx_td ltx_align_left ltx_border_t">-</td>
<td id="S4.T4.1.2.2.4" class="ltx_td ltx_align_left ltx_border_t">-</td>
<td id="S4.T4.1.2.2.5" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t">23.0</td>
</tr>
<tr id="S4.T4.1.3.3" class="ltx_tr">
<td id="S4.T4.1.3.3.1" class="ltx_td ltx_align_left">PDC<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>
</td>
<td id="S4.T4.1.3.3.2" class="ltx_td ltx_align_left">58.0</td>
<td id="S4.T4.1.3.3.3" class="ltx_td ltx_align_left">-</td>
<td id="S4.T4.1.3.3.4" class="ltx_td ltx_align_left">-</td>
<td id="S4.T4.1.3.3.5" class="ltx_td ltx_nopad_r ltx_align_left">29.7</td>
</tr>
<tr id="S4.T4.1.4.4" class="ltx_tr">
<td id="S4.T4.1.4.4.1" class="ltx_td ltx_align_left">GLAD<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>
</td>
<td id="S4.T4.1.4.4.2" class="ltx_td ltx_align_left">61.4</td>
<td id="S4.T4.1.4.4.3" class="ltx_td ltx_align_left">-</td>
<td id="S4.T4.1.4.4.4" class="ltx_td ltx_align_left">-</td>
<td id="S4.T4.1.4.4.5" class="ltx_td ltx_nopad_r ltx_align_left">34.0</td>
</tr>
<tr id="S4.T4.1.5.5" class="ltx_tr">
<td id="S4.T4.1.5.5.1" class="ltx_td ltx_align_left">PCB+RPP<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>
</td>
<td id="S4.T4.1.5.5.2" class="ltx_td ltx_align_left">68.2</td>
<td id="S4.T4.1.5.5.3" class="ltx_td ltx_align_left">-</td>
<td id="S4.T4.1.5.5.4" class="ltx_td ltx_align_left">-</td>
<td id="S4.T4.1.5.5.5" class="ltx_td ltx_nopad_r ltx_align_left">40.4</td>
</tr>
<tr id="S4.T4.1.6.6" class="ltx_tr">
<td id="S4.T4.1.6.6.1" class="ltx_td ltx_align_left">MGN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>
</td>
<td id="S4.T4.1.6.6.2" class="ltx_td ltx_align_left">76.9</td>
<td id="S4.T4.1.6.6.3" class="ltx_td ltx_align_left">-</td>
<td id="S4.T4.1.6.6.4" class="ltx_td ltx_align_left">-</td>
<td id="S4.T4.1.6.6.5" class="ltx_td ltx_nopad_r ltx_align_left">52.1</td>
</tr>
<tr id="S4.T4.1.7.7" class="ltx_tr">
<td id="S4.T4.1.7.7.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T4.1.7.7.1.1" class="ltx_text ltx_font_bold">GCM</span></td>
<td id="S4.T4.1.7.7.2" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T4.1.7.7.2.1" class="ltx_text ltx_font_bold">78.4</span></td>
<td id="S4.T4.1.7.7.3" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T4.1.7.7.3.1" class="ltx_text ltx_font_bold">88.5</span></td>
<td id="S4.T4.1.7.7.4" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T4.1.7.7.4.1" class="ltx_text ltx_font_bold">91.3</span></td>
<td id="S4.T4.1.7.7.5" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t"><span id="S4.T4.1.7.7.5.1" class="ltx_text ltx_font_bold">54.3</span></td>
</tr>
<tr id="S4.T4.1.8.8" class="ltx_tr">
<td id="S4.T4.1.8.8.1" class="ltx_td ltx_align_left"><span id="S4.T4.1.8.8.1.1" class="ltx_text ltx_font_bold">Tran-GCN</span></td>
<td id="S4.T4.1.8.8.2" class="ltx_td ltx_align_left"><span id="S4.T4.1.8.8.2.1" class="ltx_text ltx_font_bold">80.2</span></td>
<td id="S4.T4.1.8.8.3" class="ltx_td ltx_align_left"><span id="S4.T4.1.8.8.3.1" class="ltx_text ltx_font_bold">89.6</span></td>
<td id="S4.T4.1.8.8.4" class="ltx_td ltx_align_left"><span id="S4.T4.1.8.8.4.1" class="ltx_text ltx_font_bold">92.2</span></td>
<td id="S4.T4.1.8.8.5" class="ltx_td ltx_nopad_r ltx_align_left"><span id="S4.T4.1.8.8.5.1" class="ltx_text ltx_font_bold">56.6</span></td>
</tr>
<tr id="S4.T4.1.9.9" class="ltx_tr">
<td id="S4.T4.1.9.9.1" class="ltx_td ltx_align_left"><span id="S4.T4.1.9.9.1.1" class="ltx_ERROR undefined">\botrule</span></td>
<td id="S4.T4.1.9.9.2" class="ltx_td"></td>
<td id="S4.T4.1.9.9.3" class="ltx_td"></td>
<td id="S4.T4.1.9.9.4" class="ltx_td"></td>
<td id="S4.T4.1.9.9.5" class="ltx_td"></td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS5.p5" class="ltx_para">
<p id="S4.SS5.p5.1" class="ltx_p">From Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.5 Comparative Experiments ‣ 4 Experiments and Analysis ‣ Tran-GCN: A Transformer-Enhanced Graph Convolutional Network for Person Re-Identification in Monitoring Videos" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, the experimental results of the Tran-GCN method on three public retrieval datasets can be clearly observed. On the left side of the figure, the query pedestrian images are displayed, while the right side shows the Top-5 retrieval results, with correct results marked in green and incorrect results marked in red. It can be seen that even in challenging scenarios with complex backgrounds, similar pedestrian appearances, and partial occlusions in the images, Tran-GCN still achieves satisfactory retrieval performance. Particularly in these complex situations, Tran-GCN demonstrates robustness and efficiency in handling visual retrieval tasks. These results indicate that the Tran-GCN method has potential in practical applications, effectively enhancing the accuracy and reliability of visual retrieval.</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2409.09391/assets/x3.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="365" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Visualization of top-5 retrieval results of our Tran-GCN method on three datasets.</figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Discussion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">Despite the Tran-GCN model’s ability to integrate multiple feature types and improve pedestrian re-identification accuracy, it is not without its limitations.</p>
</div>
<div id="S5.p2" class="ltx_para ltx_noindent">
<p id="S5.p2.1" class="ltx_p"><span id="S5.p2.1.1" class="ltx_text ltx_font_bold">Computational Complexity and Resource Demands</span>. The Tran-GCN model combines the outputs from OpenPose, ResNet-50, and Transformer encoders. Each of these components is computationally intensive, requiring significant processing power and memory. This complexity can pose challenges for real-time applications and deployment on devices with limited resources.</p>
</div>
<div id="S5.p3" class="ltx_para ltx_noindent">
<p id="S5.p3.1" class="ltx_p"><span id="S5.p3.1.1" class="ltx_text ltx_font_bold">Training Time and Data Requirements.</span> The multi-branch learning approach, involving separate training of each branch before integration, can lead to prolonged training times. Additionally, the model’s reliance on extensive labeled datasets, such as those used for OpenPose, ResNet, and Transformer training, may limit its applicability in scenarios where such comprehensive datasets are unavailable.</p>
</div>
<div id="S5.p4" class="ltx_para ltx_noindent">
<p id="S5.p4.1" class="ltx_p"><span id="S5.p4.1.1" class="ltx_text ltx_font_bold">Model Interpretability.</span>
As the model integrates features from various sources and applies complex transformations, interpreting its decision-making process becomes challenging. Understanding how different features contribute to the final re-identification output is crucial for improving model transparency and trustworthiness.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this study, we propose a Person Re-Identification model based on the Transformer-Enhanced Graph Convolutional Neural Network (Tran-GCN) to improve pedestrian recognition in monitoring videos. The Tran-GCN model consists of a multi-branch feature extraction module and a graph convolutional network module(GCM). The multi-branch feature extraction includes pedestrian keypoint features, local features, and global features. The GCM integrates these three different types of features to obtain a discriminative feature representation. Extensive experiments have demonstrated that the proposed method effectively enhances the accuracy of Person Re-Identification. In the future, we plan to further integrate mutual information for multi-feature fusion and extend the application to challenging scenarios involving low-light conditions and disguised pedestrians.</p>
</div>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Acknowledgments</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">The first author would like to thank you for the support of the College of Guangzhou technology and business of China. We also want to thank the HCI V3Lab of Universiti Teknologi Malaysia for some constructive comments.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Declarations</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p"><span id="Sx1.p1.1.1" class="ltx_text ltx_font_bold">Authors’ contributions
<br class="ltx_break"></span>Masitah put up with the idea,Tarmizi guided the research process and checked the work, Hong xiaobin designed the model,done the experiment and wrote the main manuscript. All authors reviewed the manuscript.</p>
</div>
<div id="Sx1.p2" class="ltx_para">
<br class="ltx_break">
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.1.1" class="ltx_bibitem">
<span class="ltx_bibblock"><span id="bib.1.1.1.1" class="ltx_ERROR undefined">\bibcommenthead</span>
</span>
</li>
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ye et al. [2021]</span>
<span class="ltx_bibblock">
Ye, M.,
Shen, J.,
Lin, G.,
Xiang, T.,
Shao, L.,
Hoi, S.C.:
Deep learning for person re-identification: A survey and outlook.
IEEE transactions on pattern analysis and machine intelligence
<span id="bib.bib1.1.1" class="ltx_text ltx_font_bold">44</span>(6),
2872–2893
(2021)


</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sezavar et al. [2024]</span>
<span class="ltx_bibblock">
Sezavar, A.,
Farsi, H.,
Mohamadzadeh, S.,
Radeva, P.:
A new person re-identification method by defining cnn-based feature extractor and sparse representation.
Multimedia Tools and Applications
(2024)


</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gong et al. [2024]</span>
<span class="ltx_bibblock">
Gong, Y.,
Jiang, X.,
Wang, L.,
Xu, L.,
Lu, J.,
Liu, H.,
Lin, L.,
Zhang, X.:
Tclanenet: Task-conditioned lane detection network driven by vibration information.
IEEE Transactions on Intelligent Vehicles
(2024)


</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. [2023]</span>
<span class="ltx_bibblock">
Zhang, X.,
Gong, Y.,
Li, Z.,
Gao, X.,
Jin, D.,
Li, J.,
Liu, H.:
Skipcrossnets: Adaptive skip-cross fusion for road detection.
arXiv preprint arXiv:2308.12863
(2023)


</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et al. [2023]</span>
<span class="ltx_bibblock">
Song, Z.,
Jia, C.,
Yang, L.,
Wei, H.,
Liu, L.:
Graphalign++: An accurate feature alignment by graph matching for multi-modal 3d object detection.
IEEE Transactions on Circuits and Systems for Video Technology
(2023)


</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yadav and Vishwakarma [2024]</span>
<span class="ltx_bibblock">
Yadav, A.,
Vishwakarma, D.K.:
Deep learning algorithms for person re-identification: sate-of-the-art and research challenges.
Multimedia Tools and Applications
<span id="bib.bib6.1.1" class="ltx_text ltx_font_bold">83</span>(8),
22005–22054
(2024)


</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yi et al. [2014]</span>
<span class="ltx_bibblock">
Yi, D.,
Lei, Z.,
Liao, S.,
Li, S.Z.:
Deep metric learning for person re-identification,
34–39
(2014)


</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2014]</span>
<span class="ltx_bibblock">
Li, W.,
Zhao, R.,
Xiao, T.,
Wang, X.:
Deepreid: Deep filter pairing neural network for person re-identification,
152–159
(2014)


</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Weinberger and Saul [2009]</span>
<span class="ltx_bibblock">
Weinberger, K.Q.,
Saul, L.K.:
Distance Metric Learning for Large Margin Nearest Neighbor Classification.
vol. 10,
(2009)


</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2018]</span>
<span class="ltx_bibblock">
Wang, G.,
Yuan, Y.,
Chen, X.,
Li, J.,
Zhou, X.:
Learning discriminative features with multiple granularities for person re-identification.
In: Proceedings of the 26th ACM International Conference on Multimedia,
pp. 274–282
(2018)


</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et al. [2018]</span>
<span class="ltx_bibblock">
Song, C.,
Huang, Y.,
Ouyang, W.,
Wang, L.:
Mask-guided Contrastive Attention Model for Person Re-identification,
pp. 1179–1188
(2018)


</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. [2017]</span>
<span class="ltx_bibblock">
Zhao, H.,
Tian, M.,
Sun, S.,
Shao, J.,
Yan, J.,
Yi, S.,
Wang, X.,
Tang, X.:
Spindle net: Person re-identification with human body region guided feature decomposition and fusion.
In: Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition,
pp. 1077–1085
(2017)


</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. [2018]</span>
<span class="ltx_bibblock">
Sun, Y.,
Zheng, L.,
Yang, Y.,
Tian, Q.,
Wang, S.:
Beyond part models: Person retrieval with refined part pooling (and a strong convolutional baseline)
(2018)


</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. [2021]</span>
<span class="ltx_bibblock">
Hu, X.,
Cao, Y.,
Sun, Y.,
Tang, T.:
Railway automatic switch stationary contacts wear detection under few-shot occasions.
IEEE transactions on intelligent transportation systems
<span id="bib.bib14.1.1" class="ltx_text ltx_font_bold">23</span>(9),
14893–14907
(2021)


</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. [2017]</span>
<span class="ltx_bibblock">
Zhang, X.,
Luo, H.,
Fan, X.,
Xiang, W.,
Sun, Y.,
Xiao, Q.,
Jiang, W.,
Zhang, C.,
Sun, J.:
Alignedreid: Surpassing human-level performance in person re-identification
(2017)


</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. [2015]</span>
<span class="ltx_bibblock">
Zheng, W.-S.,
Li, X.,
Xiang, T.,
Liao, S.,
Lai, J.,
Gong, S.:
Partial person re-identification
(2015)


</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et al. [2024]</span>
<span class="ltx_bibblock">
Song, Z.,
Jia, F.,
Pan, H.,
Luo, Y.,
Jia, C.,
Zhang, G.,
Liu, L.,
Ji, Y.,
Yang, L.,
Wang, L.:
Contrastalign: Toward robust bev feature alignment via contrastive learning for multi-modal 3d object detection.
arXiv preprint arXiv:2405.16873
(2024)


</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Koestinger et al. [2012]</span>
<span class="ltx_bibblock">
Koestinger, M.,
Hirzer, M.,
Wohlhart, P.,
Roth, P.M.,
Bischof, H.:
Large scale metric learning from equivalence constraints,
2288–2295
(2012).
IEEE


</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Mignon, A.,
Pcca, F.:
A New Approach for Distance Learning from Sparse Pairwise Constraints


</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2023]</span>
<span class="ltx_bibblock">
Li, Z.,
Zhang, X.,
Tian, C.,
Gao, X.,
Gong, Y.,
Wu, J.,
Zhang, G.,
Li, J.,
Liu, H.:
Tvg-reid: Transformer-based vehicle-graph re-identification.
IEEE Transactions on Intelligent Vehicles
(2023)


</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. [2019]</span>
<span class="ltx_bibblock">
Zheng, L.,
Huang, Y.,
Lu, H.,
Yang, Y.:
Pose-invariant embedding for deep person re-identification.
IEEE transactions on image processing
<span id="bib.bib21.1.1" class="ltx_text ltx_font_bold">28</span>(9),
4500–4509
(2019)


</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et al. [2017]</span>
<span class="ltx_bibblock">
Su, C.,
Li, J.,
Zhang, S.,
Xing, J.,
Gao, W.,
Tian, Q.:
Pose-driven deep convolutional model for person re-identification,
3960–3969
(2017)


</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Suh et al. [2018]</span>
<span class="ltx_bibblock">
Suh, Y.,
Wang, J.,
Tang, S.,
Mei, T.,
Lee, K.M.:
Part-aligned bilinear representations for person re-identification,
402–419
(2018)


</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gong et al. [2023]</span>
<span class="ltx_bibblock">
Gong, Y.,
Wang, L.,
Xu, L.:
A feature aggregation network for multispectral pedestrian detection.
Applied Intelligence
<span id="bib.bib24.1.1" class="ltx_text ltx_font_bold">53</span>(19),
22117–22131
(2023)


</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. [2023]</span>
<span class="ltx_bibblock">
Zhang, X.,
Gong, Y.,
Lu, J.,
Wu, J.,
Li, Z.,
Jin, D.,
Li, J.:
Multi-modal fusion technology based on vehicle information: A survey.
IEEE Transactions on Intelligent Vehicles
<span id="bib.bib25.1.1" class="ltx_text ltx_font_bold">8</span>(6),
3605–3619
(2023)


</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gong et al. [2023]</span>
<span class="ltx_bibblock">
Gong, Y.,
Lu, J.,
Liu, W.,
Li, Z.,
Jiang, X.,
Gao, X.,
Wu, X.:
Sifdrivenet: Speed and image fusion for driving behavior classification network.
IEEE Transactions on Computational Social Systems
(2023)


</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et al. [2023]</span>
<span class="ltx_bibblock">
Song, Z.,
Wei, H.,
Bai, L.,
Yang, L.,
Jia, C.:
Graphalign: Enhancing accurate feature alignment by graph matching for multi-modal 3d object detection.
In: Proceedings of the IEEE/CVF International Conference on Computer Vision,
pp. 3358–3369
(2023)


</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ertugrul et al. [2020]</span>
<span class="ltx_bibblock">
Ertugrul, E.,
Li, P.,
Sheng, B.:
On attaining user-friendly hand gesture interfaces to control existing guis.
Virtual Reality &amp; Intelligent Hardware
(2020)


</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zeghoud et al. [2022]</span>
<span class="ltx_bibblock">
Zeghoud, S.,
Ali, S.G.,
Ertugrul, E.,
Kamel, A.,
Sheng, B.,
Li, P.,
Chi, X.,
Kim, J.,
Mao, L.:
Real-time spatial normalization for dynamic gesture classification.
The Visual Computer,
1–13
(2022)


</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. [2015]</span>
<span class="ltx_bibblock">
Zheng, L.,
Shen, L.,
Tian, L.,
Wang, S.,
Wang, J.,
Tian, Q.:
Scalable person re-identification: A benchmark,
1116–1124
(2015)


</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. [2017]</span>
<span class="ltx_bibblock">
Zheng, Z.,
Zheng, L.,
Yang, Y.:
Unlabeled samples generated by gan improve the person re-identification baseline in vitro,
3754–3762
(2017)


</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al. [2018]</span>
<span class="ltx_bibblock">
Wei, L.,
Zhang, S.,
Gao, W.,
Tian, Q.:
Person transfer gan to bridge domain gap for person re-identification,
79–88
(2018)


</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geng et al. [2016]</span>
<span class="ltx_bibblock">
Geng, M.,
Wang, Y.,
Xiang, T.,
Tian, Y.:
Deep transfer learning for person re-identification.
arXiv preprint arXiv:1611.05244
(2016)


</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. [2019]</span>
<span class="ltx_bibblock">
Zhang, S.,
He, Y.,
Wei, J.,
Mei, S.,
Wan, S.,
Chen, K.:
Person re-identification with joint verification and identification of identity-attribute labels.
IEEE Access
<span id="bib.bib34.1.1" class="ltx_text ltx_font_bold">7</span>,
126116–126126
(2019)


</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ahmed et al. [2015]</span>
<span class="ltx_bibblock">
Ahmed, E.,
Jones, M.,
Marks, T.K.:
An improved deep learning architecture for person re-identification,
3908–3916
(2015)


</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheng et al. [2016]</span>
<span class="ltx_bibblock">
Cheng, D.,
Gong, Y.,
Zhou, S.,
Wang, J.,
Zheng, N.:
Person re-identification by multi-channel parts-based cnn with improved triplet loss function,
1335–1344
(2016)


</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hermans et al. [2017]</span>
<span class="ltx_bibblock">
Hermans, A.,
Beyer, L.,
Leibe, B.:
In defense of the triplet loss for person re-identification.
arXiv preprint arXiv:1703.07737
(2017)


</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. [2017]</span>
<span class="ltx_bibblock">
Chen, W.,
Chen, X.,
Zhang, J.,
Huang, K.:
Beyond triplet loss: a deep quadruplet network for person re-identification,
403–412
(2017)


</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2017]</span>
<span class="ltx_bibblock">
Li, D.,
Chen, X.,
Zhang, Z.,
Huang, K.:
Learning deep context-aware features over body and latent parts for person re-identification,
384–393
(2017)


</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al. [2020]</span>
<span class="ltx_bibblock">
Bai, X.,
Yang, M.,
Huang, T.,
Dou, Z.,
Yu, R.,
Xu, Y.:
Deep-person: Learning discriminative deep features for person re-identification.
Pattern Recognition
<span id="bib.bib40.1.1" class="ltx_text ltx_font_bold">98</span>,
107036
(2020)


</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. [2018]</span>
<span class="ltx_bibblock">
Zheng, Z.,
Zheng, L.,
Yang, Y.:
Pedestrian alignment network for large-scale person re-identification.
IEEE Transactions on Circuits and Systems for Video Technology
<span id="bib.bib41.1.1" class="ltx_text ltx_font_bold">29</span>(10),
3037–3045
(2018)


</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kalayeh et al. [2018]</span>
<span class="ltx_bibblock">
Kalayeh, M.M.,
Basaran, E.,
Gökmen, M.,
Kamasak, M.E.,
Shah, M.:
Human semantic parsing for person re-identification,
1062–1071
(2018)


</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qi et al. [2018]</span>
<span class="ltx_bibblock">
Qi, L.,
Huo, J.,
Wang, L.,
Shi, Y.,
Gao, Y.:
Maskreid: A mask based deep ranking neural network for person re-identification.
arXiv preprint arXiv:1804.03864
(2018)


</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tian et al. [2018]</span>
<span class="ltx_bibblock">
Tian, M.,
Yi, S.,
Li, H.,
Li, S.,
Zhang, X.,
Shi, J.,
Yan, J.,
Wang, X.:
Eliminating background-bias for robust person re-identification,
5794–5803
(2018)


</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. [2019]</span>
<span class="ltx_bibblock">
He, L.,
Wang, Y.,
Liu, W.,
Zhao, H.,
Sun, Z.,
Feng, J.:
Foreground-aware pyramid reconstruction for alignment-free occluded person re-identification,
8450–8459
(2019)


</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan et al. [2023]</span>
<span class="ltx_bibblock">
Tan, L.,
Chen, X.,
Hu, X.,
Tang, T.:
Dmdsnet: A computer vision-based dual multi-task model for tunnel bolt detection and corrosion segmentation.
In: 2023 IEEE 26th International Conference on Intelligent Transportation Systems (ITSC),
pp. 4827–4833
(2023).
IEEE


</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. [2017]</span>
<span class="ltx_bibblock">
Zhao, L.,
Li, X.,
Zhuang, Y.,
Wang, J.:
Deeply-learned part-aligned representations for person re-identification,
3219–3228
(2017)


</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al. [2017]</span>
<span class="ltx_bibblock">
Wei, L.,
Zhang, S.,
Yao, H.,
Gao, W.,
Tian, Q.:
Glad: Global-local-alignment descriptor for pedestrian retrieval,
420–428
(2017)


</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan et al. [2023]</span>
<span class="ltx_bibblock">
Tan, L.,
Hu, X.,
Tang, T.,
Yuan, D.:
A lightweight metro tunnel water leakage identification algorithm via machine vision.
Engineering Failure Analysis
<span id="bib.bib49.1.1" class="ltx_text ltx_font_bold">150</span>,
107327
(2023)


</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sarfraz et al. [2018]</span>
<span class="ltx_bibblock">
Sarfraz, M.S.,
Schumann, A.,
Eberle, A.,
Stiefelhagen, R.:
A pose-sensitive embedding for person re-identification with expanded cross neighborhood re-ranking,
420–429
(2018)


</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aouaidjia et al. [2019]</span>
<span class="ltx_bibblock">
Aouaidjia, K.,
Sheng, B.,
Li, P.,
Kim, J.,
Feng, D.D.:
Efficient body motion quantification and similarity evaluation using 3-d joints skeleton coordinates.
IEEE, ???
(2019)


</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. [2014]</span>
<span class="ltx_bibblock">
Lin, T.-Y.,
Maire, M.,
Belongie, S.,
Hays, J.,
Perona, P.,
Ramanan, D.,
Dollár, P.,
Zitnick, C.L.:
Microsoft coco: Common objects in context,
740–755
(2014).
Springer


</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lowe [1999]</span>
<span class="ltx_bibblock">
Lowe, D.G.:
Object recognition from local scale-invariant features
<span id="bib.bib53.1.1" class="ltx_text ltx_font_bold">2</span>,
1150–1157
(1999).
Ieee


</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Carion et al. [2020]</span>
<span class="ltx_bibblock">
Carion, N.,
Massa, F.,
Synnaeve, G.,
Usunier, N.,
Kirillov, A.,
Zagoruyko, S.:
End-to-end object detection with transformers.
In: European Conference on Computer Vision,
pp. 213–229
(2020).
Springer


</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. [2017]</span>
<span class="ltx_bibblock">
Vaswani, A.,
Shazeer, N.,
Parmar, N.,
Uszkoreit, J.,
Jones, L.,
Gomez, A.N.,
Kaiser, Ł.,
Polosukhin, I.:
Attention is all you need.
Advances in neural information processing systems
<span id="bib.bib55.1.1" class="ltx_text ltx_font_bold">30</span>
(2017)


</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Felzenszwalb et al. [2009]</span>
<span class="ltx_bibblock">
Felzenszwalb, P.F.,
Girshick, R.B.,
McAllester, D.,
Ramanan, D.:
Object detection with discriminatively trained part-based models.
IEEE transactions on pattern analysis and machine intelligence
<span id="bib.bib56.1.1" class="ltx_text ltx_font_bold">32</span>(9),
1627–1645
(2009)


</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et al. [2024]</span>
<span class="ltx_bibblock">
Luo, Q.,
Shao, J.,
Dang, W.,
Geng, L.,
Zheng, H.,
Liu, C.:
An efficient multi-scale channel attention network for person re-identification.
The Visual Computer
<span id="bib.bib57.1.1" class="ltx_text ltx_font_bold">40</span>(5),
3515–3527
(2024)


</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et al. [2015]</span>
<span class="ltx_bibblock">
Ren, S.,
He, K.,
Girshick, R.,
Sun, J.:
Faster r-cnn: Towards real-time object detection with region proposal networks.
Advances in neural information processing systems
<span id="bib.bib58.1.1" class="ltx_text ltx_font_bold">28</span>
(2015)


</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2022]</span>
<span class="ltx_bibblock">
Wang, H.,
Shen, J.,
Liu, Y.,
Gao, Y.,
Gavves, E.:
Nformer: Robust person re-identification with neighbor transformer.
In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR),
pp. 7297–7307
(2022)


</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ni et al. [2023]</span>
<span class="ltx_bibblock">
Ni, H.,
Li, Y.,
Gao, L.,
Shen, H.T.,
Song, J.:
Part-aware transformer for generalizable person re-identification.
In: Proceedings of the IEEE/CVF International Conference on Computer Vision (ICCV),
pp. 11280–11289
(2023)


</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2019]</span>
<span class="ltx_bibblock">
Li, J.,
Zhang, S.,
Tian, Q.,
Wang, M.,
Gao, W.:
Pose-guided representation learning for person re-identification.
IEEE transactions on pattern analysis and machine intelligence
<span id="bib.bib61.1.1" class="ltx_text ltx_font_bold">44</span>(2),
622–635
(2019)


</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Miao et al. [2019]</span>
<span class="ltx_bibblock">
Miao, J.,
Wu, Y.,
Liu, P.,
Ding, Y.,
Yang, Y.:
Pose-guided feature alignment for occluded person re-identification.
In: Proceedings of the IEEE/CVF International Conference on Computer Vision,
pp. 542–551
(2019)


</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2018]</span>
<span class="ltx_bibblock">
Liu, J.,
Ni, B.,
Yan, Y.,
Zhou, P.,
Cheng, S.,
Hu, J.:
Pose transferrable person re-identification.
In: Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition,
pp. 4099–4108
(2018)


</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qian et al. [2018]</span>
<span class="ltx_bibblock">
Qian, X.,
Fu, Y.,
Xiang, T.,
Wang, W.,
Qiu, J.,
Wu, Y.,
Jiang, Y.-G.,
Xue, X.:
Pose-normalized image generation for person re-identification.
In: Proceedings of the European Conference on Computer Vision (ECCV),
pp. 650–667
(2018)


</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Szegedy et al. [2015]</span>
<span class="ltx_bibblock">
Szegedy, C.,
Liu, W.,
Jia, Y.,
Sermanet, P.,
Reed, S.,
Anguelov, D.,
Erhan, D.,
Vanhoucke, V.,
Rabinovich, A.:
Going deeper with convolutions.
In: Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition,
pp. 1–9
(2015)


</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2409.09390" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2409.09391" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2409.09391">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2409.09391" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2409.09392" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sun Oct  6 01:59:27 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
