<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2204.12495] Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies</title><meta property="og:description" content="Federated learning reduces the risk of information leakage, but remains vulnerable to attacks. We investigate how several neural network design decisions can defend against gradients inversion attacks. We show that ove…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2204.12495">

<!--Generated on Wed Feb 28 07:09:45 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<h1 class="ltx_title ltx_title_document">Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shaltiel Eloul
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Fran Silavong
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Sanket Kamthe
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Antonios Georgiadis
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Sean J. Moran
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Federated learning reduces the risk of information leakage, but remains vulnerable to attacks. We investigate how several neural network design decisions can defend against gradients inversion attacks. We show that <em id="id1.id1.1" class="ltx_emph ltx_font_italic">overlapping</em> gradients provides numerical resistance to gradient inversion on the highly vulnerable dense layer. Specifically, we propose to leverage batching to maximise mixing of gradients by choosing an appropriate loss function and drawing identical labels. We show that otherwise it is possible to directly recover all vectors in a mini-batch without any numerical optimisation due to the de-mixing nature of the cross entropy loss. To accurately assess data recovery, we introduce an <em id="id1.id1.2" class="ltx_emph ltx_font_italic">absolute variation distance</em> (AVD) metric for information leakage in images, derived from total variation. In contrast to standard metrics, e.g. Mean Squared Error or Structural Similarity Index, AVD offers a continuous metric for extracting information in noisy images. Finally, our empirical results on information recovery from various inversion attacks and training performance supports our defense strategies. These strategies are also shown to be useful for deep convolutional neural networks such as LeNET for image recognition. We hope that this study will help guide the development of further strategies that achieve a trustful federation policy.</p>
</div>
<div id="p1" class="ltx_para">
<span id="p1.1" class="ltx_ERROR undefined">\useunder</span>
<p id="p1.2" class="ltx_p"><span id="p1.2.1" class="ltx_text ltx_ulem_uline"></span><span id="p1.2.2" class="ltx_ERROR undefined">\ul</span>
</p>
</div>
<div id="p3" class="ltx_para">
<p id="p3.1" class="ltx_p"><sup id="p3.1.1" class="ltx_sup"><span id="p3.1.1.1" class="ltx_text ltx_font_italic">1</span></sup>CTO, JPMorgan Chase, London, UK.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.5" class="ltx_p">Federated learning (FL) enables distributed client nodes to contribute to the training of a centralised global model without exposing their private data <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib13" title="" class="ltx_ref">2017</a>; Kairouz et al., <a href="#bib.bib9" title="" class="ltx_ref">2021</a>; Yang et al., <a href="#bib.bib24" title="" class="ltx_ref">2019</a>)</cite>. The promises of federated learning are significant and have wide applicability in industry. For example through federated learning it is possible for hospitals to collaborate on training a centralised model around the globe, without sharing or moving the actual private patient information across institutions <cite class="ltx_cite ltx_citemacro_citep">(Rieke et al., <a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite>. As it potentially protects sensitive data, it can better align with data protection regulations such as GDPR <cite class="ltx_cite ltx_citemacro_citep">(Commission, <a href="#bib.bib3" title="" class="ltx_ref">2018</a>)</cite>. For example, FL has been already applied to prediction of treatment side effects in medicine <cite class="ltx_cite ltx_citemacro_citep">(Jochems et al., <a href="#bib.bib8" title="" class="ltx_ref">2016</a>)</cite> or learning a predictive keyboard for smartphones <cite class="ltx_cite ltx_citemacro_citep">(Bonawitz et al., <a href="#bib.bib1" title="" class="ltx_ref">2019</a>; Konečný et al., <a href="#bib.bib10" title="" class="ltx_ref">2016</a>)</cite>.
The reduction of data movement is an additional important advantage, as it is costly and time consuming for large industrial applications.
Given the potential impact of FL, many authors have since examined the security and privacy of FL <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a href="#bib.bib26" title="" class="ltx_ref">2020</a>; Geiping et al., <a href="#bib.bib5" title="" class="ltx_ref">2020</a>; Yin et al., <a href="#bib.bib25" title="" class="ltx_ref">2021</a>; Zhu et al., <a href="#bib.bib28" title="" class="ltx_ref">2019</a>; Huang et al., <a href="#bib.bib7" title="" class="ltx_ref">2020</a>; Phong et al., <a href="#bib.bib15" title="" class="ltx_ref">2018</a>; Carlini et al., <a href="#bib.bib2" title="" class="ltx_ref">2020</a>; Shokri et al., <a href="#bib.bib19" title="" class="ltx_ref">2017</a>; Melis et al., <a href="#bib.bib14" title="" class="ltx_ref">2019</a>)</cite>.
A standard FL configuration is typically achieved with a central aggregator node which exchanges gradients for centralised aggregation. At each training step (<math id="S1.p1.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S1.p1.1.m1.1a"><mi id="S1.p1.1.m1.1.1" xref="S1.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S1.p1.1.m1.1b"><ci id="S1.p1.1.m1.1.1.cmml" xref="S1.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.1.m1.1c">t</annotation></semantics></math>), a client node receives neural network model weights, <math id="S1.p1.2.m2.1" class="ltx_Math" alttext="F(W_{t})" display="inline"><semantics id="S1.p1.2.m2.1a"><mrow id="S1.p1.2.m2.1.1" xref="S1.p1.2.m2.1.1.cmml"><mi id="S1.p1.2.m2.1.1.3" xref="S1.p1.2.m2.1.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S1.p1.2.m2.1.1.2" xref="S1.p1.2.m2.1.1.2.cmml">​</mo><mrow id="S1.p1.2.m2.1.1.1.1" xref="S1.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S1.p1.2.m2.1.1.1.1.2" xref="S1.p1.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S1.p1.2.m2.1.1.1.1.1" xref="S1.p1.2.m2.1.1.1.1.1.cmml"><mi id="S1.p1.2.m2.1.1.1.1.1.2" xref="S1.p1.2.m2.1.1.1.1.1.2.cmml">W</mi><mi id="S1.p1.2.m2.1.1.1.1.1.3" xref="S1.p1.2.m2.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S1.p1.2.m2.1.1.1.1.3" xref="S1.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p1.2.m2.1b"><apply id="S1.p1.2.m2.1.1.cmml" xref="S1.p1.2.m2.1.1"><times id="S1.p1.2.m2.1.1.2.cmml" xref="S1.p1.2.m2.1.1.2"></times><ci id="S1.p1.2.m2.1.1.3.cmml" xref="S1.p1.2.m2.1.1.3">𝐹</ci><apply id="S1.p1.2.m2.1.1.1.1.1.cmml" xref="S1.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S1.p1.2.m2.1.1.1.1">subscript</csymbol><ci id="S1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S1.p1.2.m2.1.1.1.1.1.2">𝑊</ci><ci id="S1.p1.2.m2.1.1.1.1.1.3.cmml" xref="S1.p1.2.m2.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.2.m2.1c">F(W_{t})</annotation></semantics></math>, from the aggregator server and calculates loss (<math id="S1.p1.3.m3.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S1.p1.3.m3.1a"><mi id="S1.p1.3.m3.1.1" xref="S1.p1.3.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S1.p1.3.m3.1b"><ci id="S1.p1.3.m3.1.1.cmml" xref="S1.p1.3.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.3.m3.1c">l</annotation></semantics></math>) with a local data <math id="S1.p1.4.m4.2" class="ltx_Math" alttext="x_{t},y_{t}" display="inline"><semantics id="S1.p1.4.m4.2a"><mrow id="S1.p1.4.m4.2.2.2" xref="S1.p1.4.m4.2.2.3.cmml"><msub id="S1.p1.4.m4.1.1.1.1" xref="S1.p1.4.m4.1.1.1.1.cmml"><mi id="S1.p1.4.m4.1.1.1.1.2" xref="S1.p1.4.m4.1.1.1.1.2.cmml">x</mi><mi id="S1.p1.4.m4.1.1.1.1.3" xref="S1.p1.4.m4.1.1.1.1.3.cmml">t</mi></msub><mo id="S1.p1.4.m4.2.2.2.3" xref="S1.p1.4.m4.2.2.3.cmml">,</mo><msub id="S1.p1.4.m4.2.2.2.2" xref="S1.p1.4.m4.2.2.2.2.cmml"><mi id="S1.p1.4.m4.2.2.2.2.2" xref="S1.p1.4.m4.2.2.2.2.2.cmml">y</mi><mi id="S1.p1.4.m4.2.2.2.2.3" xref="S1.p1.4.m4.2.2.2.2.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S1.p1.4.m4.2b"><list id="S1.p1.4.m4.2.2.3.cmml" xref="S1.p1.4.m4.2.2.2"><apply id="S1.p1.4.m4.1.1.1.1.cmml" xref="S1.p1.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S1.p1.4.m4.1.1.1.1.1.cmml" xref="S1.p1.4.m4.1.1.1.1">subscript</csymbol><ci id="S1.p1.4.m4.1.1.1.1.2.cmml" xref="S1.p1.4.m4.1.1.1.1.2">𝑥</ci><ci id="S1.p1.4.m4.1.1.1.1.3.cmml" xref="S1.p1.4.m4.1.1.1.1.3">𝑡</ci></apply><apply id="S1.p1.4.m4.2.2.2.2.cmml" xref="S1.p1.4.m4.2.2.2.2"><csymbol cd="ambiguous" id="S1.p1.4.m4.2.2.2.2.1.cmml" xref="S1.p1.4.m4.2.2.2.2">subscript</csymbol><ci id="S1.p1.4.m4.2.2.2.2.2.cmml" xref="S1.p1.4.m4.2.2.2.2.2">𝑦</ci><ci id="S1.p1.4.m4.2.2.2.2.3.cmml" xref="S1.p1.4.m4.2.2.2.2.3">𝑡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.4.m4.2c">x_{t},y_{t}</annotation></semantics></math> for a mini-batch, <math id="S1.p1.5.m5.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S1.p1.5.m5.1a"><mi id="S1.p1.5.m5.1.1" xref="S1.p1.5.m5.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S1.p1.5.m5.1b"><ci id="S1.p1.5.m5.1.1.cmml" xref="S1.p1.5.m5.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.5.m5.1c">B</annotation></semantics></math>, which generates gradients with respect to the model weights:</p>
<table id="S1.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S1.E1.m1.5" class="ltx_Math" alttext="\Delta W_{t}=-\frac{\gamma}{B}\sum_{b&lt;B}{\frac{\partial l(F(x_{t,b},y_{t,b}))}{\partial W_{t}}}" display="block"><semantics id="S1.E1.m1.5a"><mrow id="S1.E1.m1.5.6" xref="S1.E1.m1.5.6.cmml"><mrow id="S1.E1.m1.5.6.2" xref="S1.E1.m1.5.6.2.cmml"><mi mathvariant="normal" id="S1.E1.m1.5.6.2.2" xref="S1.E1.m1.5.6.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S1.E1.m1.5.6.2.1" xref="S1.E1.m1.5.6.2.1.cmml">​</mo><msub id="S1.E1.m1.5.6.2.3" xref="S1.E1.m1.5.6.2.3.cmml"><mi id="S1.E1.m1.5.6.2.3.2" xref="S1.E1.m1.5.6.2.3.2.cmml">W</mi><mi id="S1.E1.m1.5.6.2.3.3" xref="S1.E1.m1.5.6.2.3.3.cmml">t</mi></msub></mrow><mo id="S1.E1.m1.5.6.1" xref="S1.E1.m1.5.6.1.cmml">=</mo><mrow id="S1.E1.m1.5.6.3" xref="S1.E1.m1.5.6.3.cmml"><mo id="S1.E1.m1.5.6.3a" xref="S1.E1.m1.5.6.3.cmml">−</mo><mrow id="S1.E1.m1.5.6.3.2" xref="S1.E1.m1.5.6.3.2.cmml"><mfrac id="S1.E1.m1.5.6.3.2.2" xref="S1.E1.m1.5.6.3.2.2.cmml"><mi id="S1.E1.m1.5.6.3.2.2.2" xref="S1.E1.m1.5.6.3.2.2.2.cmml">γ</mi><mi id="S1.E1.m1.5.6.3.2.2.3" xref="S1.E1.m1.5.6.3.2.2.3.cmml">B</mi></mfrac><mo lspace="0em" rspace="0em" id="S1.E1.m1.5.6.3.2.1" xref="S1.E1.m1.5.6.3.2.1.cmml">​</mo><mrow id="S1.E1.m1.5.6.3.2.3" xref="S1.E1.m1.5.6.3.2.3.cmml"><munder id="S1.E1.m1.5.6.3.2.3.1" xref="S1.E1.m1.5.6.3.2.3.1.cmml"><mo movablelimits="false" id="S1.E1.m1.5.6.3.2.3.1.2" xref="S1.E1.m1.5.6.3.2.3.1.2.cmml">∑</mo><mrow id="S1.E1.m1.5.6.3.2.3.1.3" xref="S1.E1.m1.5.6.3.2.3.1.3.cmml"><mi id="S1.E1.m1.5.6.3.2.3.1.3.2" xref="S1.E1.m1.5.6.3.2.3.1.3.2.cmml">b</mi><mo id="S1.E1.m1.5.6.3.2.3.1.3.1" xref="S1.E1.m1.5.6.3.2.3.1.3.1.cmml">&lt;</mo><mi id="S1.E1.m1.5.6.3.2.3.1.3.3" xref="S1.E1.m1.5.6.3.2.3.1.3.3.cmml">B</mi></mrow></munder><mfrac id="S1.E1.m1.5.5" xref="S1.E1.m1.5.5.cmml"><mrow id="S1.E1.m1.5.5.5" xref="S1.E1.m1.5.5.5.cmml"><mo rspace="0em" id="S1.E1.m1.5.5.5.6" xref="S1.E1.m1.5.5.5.6.cmml">∂</mo><mrow id="S1.E1.m1.5.5.5.5" xref="S1.E1.m1.5.5.5.5.cmml"><mi id="S1.E1.m1.5.5.5.5.3" xref="S1.E1.m1.5.5.5.5.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S1.E1.m1.5.5.5.5.2" xref="S1.E1.m1.5.5.5.5.2.cmml">​</mo><mrow id="S1.E1.m1.5.5.5.5.1.1" xref="S1.E1.m1.5.5.5.5.1.1.1.cmml"><mo stretchy="false" id="S1.E1.m1.5.5.5.5.1.1.2" xref="S1.E1.m1.5.5.5.5.1.1.1.cmml">(</mo><mrow id="S1.E1.m1.5.5.5.5.1.1.1" xref="S1.E1.m1.5.5.5.5.1.1.1.cmml"><mi id="S1.E1.m1.5.5.5.5.1.1.1.4" xref="S1.E1.m1.5.5.5.5.1.1.1.4.cmml">F</mi><mo lspace="0em" rspace="0em" id="S1.E1.m1.5.5.5.5.1.1.1.3" xref="S1.E1.m1.5.5.5.5.1.1.1.3.cmml">​</mo><mrow id="S1.E1.m1.5.5.5.5.1.1.1.2.2" xref="S1.E1.m1.5.5.5.5.1.1.1.2.3.cmml"><mo stretchy="false" id="S1.E1.m1.5.5.5.5.1.1.1.2.2.3" xref="S1.E1.m1.5.5.5.5.1.1.1.2.3.cmml">(</mo><msub id="S1.E1.m1.5.5.5.5.1.1.1.1.1.1" xref="S1.E1.m1.5.5.5.5.1.1.1.1.1.1.cmml"><mi id="S1.E1.m1.5.5.5.5.1.1.1.1.1.1.2" xref="S1.E1.m1.5.5.5.5.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S1.E1.m1.2.2.2.2.2.4" xref="S1.E1.m1.2.2.2.2.2.3.cmml"><mi id="S1.E1.m1.1.1.1.1.1.1" xref="S1.E1.m1.1.1.1.1.1.1.cmml">t</mi><mo id="S1.E1.m1.2.2.2.2.2.4.1" xref="S1.E1.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S1.E1.m1.2.2.2.2.2.2" xref="S1.E1.m1.2.2.2.2.2.2.cmml">b</mi></mrow></msub><mo id="S1.E1.m1.5.5.5.5.1.1.1.2.2.4" xref="S1.E1.m1.5.5.5.5.1.1.1.2.3.cmml">,</mo><msub id="S1.E1.m1.5.5.5.5.1.1.1.2.2.2" xref="S1.E1.m1.5.5.5.5.1.1.1.2.2.2.cmml"><mi id="S1.E1.m1.5.5.5.5.1.1.1.2.2.2.2" xref="S1.E1.m1.5.5.5.5.1.1.1.2.2.2.2.cmml">y</mi><mrow id="S1.E1.m1.4.4.4.4.2.4" xref="S1.E1.m1.4.4.4.4.2.3.cmml"><mi id="S1.E1.m1.3.3.3.3.1.1" xref="S1.E1.m1.3.3.3.3.1.1.cmml">t</mi><mo id="S1.E1.m1.4.4.4.4.2.4.1" xref="S1.E1.m1.4.4.4.4.2.3.cmml">,</mo><mi id="S1.E1.m1.4.4.4.4.2.2" xref="S1.E1.m1.4.4.4.4.2.2.cmml">b</mi></mrow></msub><mo stretchy="false" id="S1.E1.m1.5.5.5.5.1.1.1.2.2.5" xref="S1.E1.m1.5.5.5.5.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S1.E1.m1.5.5.5.5.1.1.3" xref="S1.E1.m1.5.5.5.5.1.1.1.cmml">)</mo></mrow></mrow></mrow><mrow id="S1.E1.m1.5.5.7" xref="S1.E1.m1.5.5.7.cmml"><mo rspace="0em" id="S1.E1.m1.5.5.7.1" xref="S1.E1.m1.5.5.7.1.cmml">∂</mo><msub id="S1.E1.m1.5.5.7.2" xref="S1.E1.m1.5.5.7.2.cmml"><mi id="S1.E1.m1.5.5.7.2.2" xref="S1.E1.m1.5.5.7.2.2.cmml">W</mi><mi id="S1.E1.m1.5.5.7.2.3" xref="S1.E1.m1.5.5.7.2.3.cmml">t</mi></msub></mrow></mfrac></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.E1.m1.5b"><apply id="S1.E1.m1.5.6.cmml" xref="S1.E1.m1.5.6"><eq id="S1.E1.m1.5.6.1.cmml" xref="S1.E1.m1.5.6.1"></eq><apply id="S1.E1.m1.5.6.2.cmml" xref="S1.E1.m1.5.6.2"><times id="S1.E1.m1.5.6.2.1.cmml" xref="S1.E1.m1.5.6.2.1"></times><ci id="S1.E1.m1.5.6.2.2.cmml" xref="S1.E1.m1.5.6.2.2">Δ</ci><apply id="S1.E1.m1.5.6.2.3.cmml" xref="S1.E1.m1.5.6.2.3"><csymbol cd="ambiguous" id="S1.E1.m1.5.6.2.3.1.cmml" xref="S1.E1.m1.5.6.2.3">subscript</csymbol><ci id="S1.E1.m1.5.6.2.3.2.cmml" xref="S1.E1.m1.5.6.2.3.2">𝑊</ci><ci id="S1.E1.m1.5.6.2.3.3.cmml" xref="S1.E1.m1.5.6.2.3.3">𝑡</ci></apply></apply><apply id="S1.E1.m1.5.6.3.cmml" xref="S1.E1.m1.5.6.3"><minus id="S1.E1.m1.5.6.3.1.cmml" xref="S1.E1.m1.5.6.3"></minus><apply id="S1.E1.m1.5.6.3.2.cmml" xref="S1.E1.m1.5.6.3.2"><times id="S1.E1.m1.5.6.3.2.1.cmml" xref="S1.E1.m1.5.6.3.2.1"></times><apply id="S1.E1.m1.5.6.3.2.2.cmml" xref="S1.E1.m1.5.6.3.2.2"><divide id="S1.E1.m1.5.6.3.2.2.1.cmml" xref="S1.E1.m1.5.6.3.2.2"></divide><ci id="S1.E1.m1.5.6.3.2.2.2.cmml" xref="S1.E1.m1.5.6.3.2.2.2">𝛾</ci><ci id="S1.E1.m1.5.6.3.2.2.3.cmml" xref="S1.E1.m1.5.6.3.2.2.3">𝐵</ci></apply><apply id="S1.E1.m1.5.6.3.2.3.cmml" xref="S1.E1.m1.5.6.3.2.3"><apply id="S1.E1.m1.5.6.3.2.3.1.cmml" xref="S1.E1.m1.5.6.3.2.3.1"><csymbol cd="ambiguous" id="S1.E1.m1.5.6.3.2.3.1.1.cmml" xref="S1.E1.m1.5.6.3.2.3.1">subscript</csymbol><sum id="S1.E1.m1.5.6.3.2.3.1.2.cmml" xref="S1.E1.m1.5.6.3.2.3.1.2"></sum><apply id="S1.E1.m1.5.6.3.2.3.1.3.cmml" xref="S1.E1.m1.5.6.3.2.3.1.3"><lt id="S1.E1.m1.5.6.3.2.3.1.3.1.cmml" xref="S1.E1.m1.5.6.3.2.3.1.3.1"></lt><ci id="S1.E1.m1.5.6.3.2.3.1.3.2.cmml" xref="S1.E1.m1.5.6.3.2.3.1.3.2">𝑏</ci><ci id="S1.E1.m1.5.6.3.2.3.1.3.3.cmml" xref="S1.E1.m1.5.6.3.2.3.1.3.3">𝐵</ci></apply></apply><apply id="S1.E1.m1.5.5.cmml" xref="S1.E1.m1.5.5"><divide id="S1.E1.m1.5.5.6.cmml" xref="S1.E1.m1.5.5"></divide><apply id="S1.E1.m1.5.5.5.cmml" xref="S1.E1.m1.5.5.5"><partialdiff id="S1.E1.m1.5.5.5.6.cmml" xref="S1.E1.m1.5.5.5.6"></partialdiff><apply id="S1.E1.m1.5.5.5.5.cmml" xref="S1.E1.m1.5.5.5.5"><times id="S1.E1.m1.5.5.5.5.2.cmml" xref="S1.E1.m1.5.5.5.5.2"></times><ci id="S1.E1.m1.5.5.5.5.3.cmml" xref="S1.E1.m1.5.5.5.5.3">𝑙</ci><apply id="S1.E1.m1.5.5.5.5.1.1.1.cmml" xref="S1.E1.m1.5.5.5.5.1.1"><times id="S1.E1.m1.5.5.5.5.1.1.1.3.cmml" xref="S1.E1.m1.5.5.5.5.1.1.1.3"></times><ci id="S1.E1.m1.5.5.5.5.1.1.1.4.cmml" xref="S1.E1.m1.5.5.5.5.1.1.1.4">𝐹</ci><interval closure="open" id="S1.E1.m1.5.5.5.5.1.1.1.2.3.cmml" xref="S1.E1.m1.5.5.5.5.1.1.1.2.2"><apply id="S1.E1.m1.5.5.5.5.1.1.1.1.1.1.cmml" xref="S1.E1.m1.5.5.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S1.E1.m1.5.5.5.5.1.1.1.1.1.1.1.cmml" xref="S1.E1.m1.5.5.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S1.E1.m1.5.5.5.5.1.1.1.1.1.1.2.cmml" xref="S1.E1.m1.5.5.5.5.1.1.1.1.1.1.2">𝑥</ci><list id="S1.E1.m1.2.2.2.2.2.3.cmml" xref="S1.E1.m1.2.2.2.2.2.4"><ci id="S1.E1.m1.1.1.1.1.1.1.cmml" xref="S1.E1.m1.1.1.1.1.1.1">𝑡</ci><ci id="S1.E1.m1.2.2.2.2.2.2.cmml" xref="S1.E1.m1.2.2.2.2.2.2">𝑏</ci></list></apply><apply id="S1.E1.m1.5.5.5.5.1.1.1.2.2.2.cmml" xref="S1.E1.m1.5.5.5.5.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S1.E1.m1.5.5.5.5.1.1.1.2.2.2.1.cmml" xref="S1.E1.m1.5.5.5.5.1.1.1.2.2.2">subscript</csymbol><ci id="S1.E1.m1.5.5.5.5.1.1.1.2.2.2.2.cmml" xref="S1.E1.m1.5.5.5.5.1.1.1.2.2.2.2">𝑦</ci><list id="S1.E1.m1.4.4.4.4.2.3.cmml" xref="S1.E1.m1.4.4.4.4.2.4"><ci id="S1.E1.m1.3.3.3.3.1.1.cmml" xref="S1.E1.m1.3.3.3.3.1.1">𝑡</ci><ci id="S1.E1.m1.4.4.4.4.2.2.cmml" xref="S1.E1.m1.4.4.4.4.2.2">𝑏</ci></list></apply></interval></apply></apply></apply><apply id="S1.E1.m1.5.5.7.cmml" xref="S1.E1.m1.5.5.7"><partialdiff id="S1.E1.m1.5.5.7.1.cmml" xref="S1.E1.m1.5.5.7.1"></partialdiff><apply id="S1.E1.m1.5.5.7.2.cmml" xref="S1.E1.m1.5.5.7.2"><csymbol cd="ambiguous" id="S1.E1.m1.5.5.7.2.1.cmml" xref="S1.E1.m1.5.5.7.2">subscript</csymbol><ci id="S1.E1.m1.5.5.7.2.2.cmml" xref="S1.E1.m1.5.5.7.2.2">𝑊</ci><ci id="S1.E1.m1.5.5.7.2.3.cmml" xref="S1.E1.m1.5.5.7.2.3">𝑡</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.E1.m1.5c">\Delta W_{t}=-\frac{\gamma}{B}\sum_{b&lt;B}{\frac{\partial l(F(x_{t,b},y_{t,b}))}{\partial W_{t}}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.2" class="ltx_p">The gradients are aggregated by the centralised server, usually by averaging and with rate, <math id="S1.p2.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S1.p2.1.m1.1a"><mi id="S1.p2.1.m1.1.1" xref="S1.p2.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S1.p2.1.m1.1b"><ci id="S1.p2.1.m1.1.1.cmml" xref="S1.p2.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.1.m1.1c">\gamma</annotation></semantics></math>. The gradients, <math id="S1.p2.2.m2.1" class="ltx_Math" alttext="\Delta W_{t}" display="inline"><semantics id="S1.p2.2.m2.1a"><mrow id="S1.p2.2.m2.1.1" xref="S1.p2.2.m2.1.1.cmml"><mi mathvariant="normal" id="S1.p2.2.m2.1.1.2" xref="S1.p2.2.m2.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S1.p2.2.m2.1.1.1" xref="S1.p2.2.m2.1.1.1.cmml">​</mo><msub id="S1.p2.2.m2.1.1.3" xref="S1.p2.2.m2.1.1.3.cmml"><mi id="S1.p2.2.m2.1.1.3.2" xref="S1.p2.2.m2.1.1.3.2.cmml">W</mi><mi id="S1.p2.2.m2.1.1.3.3" xref="S1.p2.2.m2.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S1.p2.2.m2.1b"><apply id="S1.p2.2.m2.1.1.cmml" xref="S1.p2.2.m2.1.1"><times id="S1.p2.2.m2.1.1.1.cmml" xref="S1.p2.2.m2.1.1.1"></times><ci id="S1.p2.2.m2.1.1.2.cmml" xref="S1.p2.2.m2.1.1.2">Δ</ci><apply id="S1.p2.2.m2.1.1.3.cmml" xref="S1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S1.p2.2.m2.1.1.3.1.cmml" xref="S1.p2.2.m2.1.1.3">subscript</csymbol><ci id="S1.p2.2.m2.1.1.3.2.cmml" xref="S1.p2.2.m2.1.1.3.2">𝑊</ci><ci id="S1.p2.2.m2.1.1.3.3.cmml" xref="S1.p2.2.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.2.m2.1c">\Delta W_{t}</annotation></semantics></math>, shared by the client can expose the client to a potential inversion attack instigated by a malicious eavesdropper. The inversion attacks have shown to be surprisingly successful in many pioneer studies <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a href="#bib.bib26" title="" class="ltx_ref">2020</a>; Geiping et al., <a href="#bib.bib5" title="" class="ltx_ref">2020</a>; Zhu et al., <a href="#bib.bib28" title="" class="ltx_ref">2019</a>)</cite>. This compromised privacy prevents federated learning from becoming a fully trustful framework for distributed training of machine learning models. Whilst most prior studies are focused on developing successful inversion attacks on the gradients, in this work, we identify conditions under which privacy can be attained with confidence against inversion attacks. We explore the effect of the objective loss function and its relation to the mini-batch class distributions for dense layers. In addition, we also conduct a similar study for convolutional neural networks on the benchmark task of image classification. Through our analysis, we demonstrate that <em id="S1.p2.2.1" class="ltx_emph ltx_font_italic">maximising the mixing of gradients</em> can be an effective defense strategy to counteract gradient inversion attacks. Furthermore this defense strategy does not require or minimise the need for masking of the gradients by pruning or noise addition which often leads to a degradation on model accuracy <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al., <a href="#bib.bib28" title="" class="ltx_ref">2019</a>; Wei et al., <a href="#bib.bib23" title="" class="ltx_ref">2020</a>; Tramèr &amp; Boneh, <a href="#bib.bib20" title="" class="ltx_ref">2021</a>)</cite>. In more detail, our contributions in this paper are three-fold:</p>
</div>
<div id="S1.p3" class="ltx_para">
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p"><span id="S1.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">Inversion of batch, label distribution and loss function:</span> we revisit the linear dense layer and show that it is possible to directly invert a full batch without an optimisation-based gradient attack. In this context, we provide insights into the role of the loss function and batch label distribution on the recovery rate of gradient inversion attacks.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p"><span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Strategies for better privacy:</span> resulting from the above study, we suggest and provide a quantitative analysis of training strategies that are stable against attack. In contrast to existing defence mechanisms (e.g. differential privacy), our training strategies require no noise, therefore preserving accuracy in classification tasks with no performance degradation.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p"><span id="S1.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">Absolute Variation Distance (AVD):</span>
it is usually difficult to tell automatically whether information leakage has obtained from a gradient reversal attack, and metrics such as mean squared error between the ground-truth and recovered data are inadequate due to the high degree of noise. We introduce a more effective metric for detecting information recovery that we term as absolute variation distance, a variant of total variation metric <cite class="ltx_cite ltx_citemacro_citep">(Rudin et al., <a href="#bib.bib18" title="" class="ltx_ref">1992</a>)</cite>. This metric can have an important applications for creating a policy as an automatic tool for continuous monitoring of information leakage in a federation, and in future studies of defence strategies for FL.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">There is a wide literature of attacks on machine learning models, and a significant portion of recent work focuses on comprising deep learning models to steal private data <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al., <a href="#bib.bib28" title="" class="ltx_ref">2019</a>)</cite> and even hyperparameters <cite class="ltx_cite ltx_citemacro_citep">(Wang &amp; Gong, <a href="#bib.bib21" title="" class="ltx_ref">2018</a>)</cite>. Our study is mostly related to attacks on learning systems that run on multiple distributed nodes and exchange gradients to communicate weight updates.
Despite the compelling promises for privacy in FL, there is a body of work <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a href="#bib.bib26" title="" class="ltx_ref">2020</a>; Geiping et al., <a href="#bib.bib5" title="" class="ltx_ref">2020</a>; Yin et al., <a href="#bib.bib25" title="" class="ltx_ref">2021</a>; Zhu et al., <a href="#bib.bib28" title="" class="ltx_ref">2019</a>; Melis et al., <a href="#bib.bib14" title="" class="ltx_ref">2019</a>; Shokri et al., <a href="#bib.bib19" title="" class="ltx_ref">2017</a>)</cite> that present eavesdropping attacks on distributed machine learning systems to compromise data privacy, necessitating a better understanding on defense mechanisms to generate a trustful federation policy.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">Gradient Inversion Attacks:</span>
Early works studied techniques for extracting metadata about the private data, for example, membership attacks have been proposed in which a classifier is trained to identify whether a specific data-point has been used to train a model <cite class="ltx_cite ltx_citemacro_citep">(Shokri et al., <a href="#bib.bib19" title="" class="ltx_ref">2017</a>)</cite>. Property attacks are another attack variant in this direction where properties of a batch are exposed <cite class="ltx_cite ltx_citemacro_citep">(Melis et al., <a href="#bib.bib14" title="" class="ltx_ref">2019</a>)</cite>, such as the presence of a person in a photograph or their age. In both cases, actual data-points are not extracted from the gradient information. Later studies, led by Zhu <em id="S2.p2.1.2" class="ltx_emph ltx_font_italic">et al.</em> <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al., <a href="#bib.bib28" title="" class="ltx_ref">2019</a>)</cite> and expanded upon by <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a href="#bib.bib26" title="" class="ltx_ref">2020</a>; Geiping et al., <a href="#bib.bib5" title="" class="ltx_ref">2020</a>; Yin et al., <a href="#bib.bib25" title="" class="ltx_ref">2021</a>; Zhu &amp; Blaschko, <a href="#bib.bib27" title="" class="ltx_ref">2021</a>)</cite> showed how it is possible to extract the actual data by inverting the gradients communicated by clients in a federation. For example, recently <cite class="ltx_cite ltx_citemacro_citet">Yin et al. (<a href="#bib.bib25" title="" class="ltx_ref">2021</a>)</cite> showed that it is possible to extract data at a pixel-level granularity with remarkable clarity. Many approaches tackle the inversion as an optimisation problem, and we discuss the popular algorithms in the context of our experiments in section <a href="#S4.SS1" title="4.1 Inversion Attack Optimisation Algorithms ‣ 4 Experimental framework ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">Much less attention is dedicated for defence of those inversion attacks. However typical mechanism has been proposed with a range of effectiveness, including gradient pruning, adding noise to the gradients <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al., <a href="#bib.bib28" title="" class="ltx_ref">2019</a>; Wei et al., <a href="#bib.bib23" title="" class="ltx_ref">2020</a>; Tramèr &amp; Boneh, <a href="#bib.bib20" title="" class="ltx_ref">2021</a>)</cite> and encryption of training images applied online by the client nodes <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite><span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Recently a input defence scheme has been proposed for InstaHide <cite class="ltx_cite ltx_citemacro_citep">(Carlini et al., <a href="#bib.bib2" title="" class="ltx_ref">2020</a>)</cite> </span></span></span>.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">In this paper we propose a defence strategies that leverage the properties of a mini-batch to maximise gradient mixing. We analyse <em id="S2.p4.1.1" class="ltx_emph ltx_font_italic">gradient mixing</em> as a lightweight defense strategy for counteracting gradient inversion attacks.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Gradient mixing as a batch defense strategy</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">We focus in the analysis of gradient mixing on a mini-batch of linear dense layers. Later in the paper, we provide supporting results for classification tasks of linear-layer and LeNET.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Batch size of a final dense layer</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.5" class="ltx_p">The high vulnerability for recovering vector information from a fully connected layer is well known <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a href="#bib.bib26" title="" class="ltx_ref">2020</a>; Qian et al., <a href="#bib.bib16" title="" class="ltx_ref">2021</a>; Geiping et al., <a href="#bib.bib5" title="" class="ltx_ref">2020</a>)</cite>, but here we examine the vulnerability of averaged information from a batch and under various gradient mixing conditions. We simplify our analysis to a dense linear layer containing only <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">x</annotation></semantics></math> as input and <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">y</annotation></semantics></math> as output where, <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="o_{j}=\sum^{n}_{i}{w_{ij}x_{i}+b_{j}}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><msub id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2.2" xref="S3.SS1.p1.3.m3.1.1.2.2.cmml">o</mi><mi id="S3.SS1.p1.3.m3.1.1.2.3" xref="S3.SS1.p1.3.m3.1.1.2.3.cmml">j</mi></msub><mo rspace="0.111em" id="S3.SS1.p1.3.m3.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.cmml">=</mo><mrow id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml"><mrow id="S3.SS1.p1.3.m3.1.1.3.2" xref="S3.SS1.p1.3.m3.1.1.3.2.cmml"><msubsup id="S3.SS1.p1.3.m3.1.1.3.2.1" xref="S3.SS1.p1.3.m3.1.1.3.2.1.cmml"><mo id="S3.SS1.p1.3.m3.1.1.3.2.1.2.2" xref="S3.SS1.p1.3.m3.1.1.3.2.1.2.2.cmml">∑</mo><mi id="S3.SS1.p1.3.m3.1.1.3.2.1.3" xref="S3.SS1.p1.3.m3.1.1.3.2.1.3.cmml">i</mi><mi id="S3.SS1.p1.3.m3.1.1.3.2.1.2.3" xref="S3.SS1.p1.3.m3.1.1.3.2.1.2.3.cmml">n</mi></msubsup><mrow id="S3.SS1.p1.3.m3.1.1.3.2.2" xref="S3.SS1.p1.3.m3.1.1.3.2.2.cmml"><msub id="S3.SS1.p1.3.m3.1.1.3.2.2.2" xref="S3.SS1.p1.3.m3.1.1.3.2.2.2.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3.2.2.2.2" xref="S3.SS1.p1.3.m3.1.1.3.2.2.2.2.cmml">w</mi><mrow id="S3.SS1.p1.3.m3.1.1.3.2.2.2.3" xref="S3.SS1.p1.3.m3.1.1.3.2.2.2.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3.2.2.2.3.2" xref="S3.SS1.p1.3.m3.1.1.3.2.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.3.m3.1.1.3.2.2.2.3.1" xref="S3.SS1.p1.3.m3.1.1.3.2.2.2.3.1.cmml">​</mo><mi id="S3.SS1.p1.3.m3.1.1.3.2.2.2.3.3" xref="S3.SS1.p1.3.m3.1.1.3.2.2.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.3.m3.1.1.3.2.2.1" xref="S3.SS1.p1.3.m3.1.1.3.2.2.1.cmml">​</mo><msub id="S3.SS1.p1.3.m3.1.1.3.2.2.3" xref="S3.SS1.p1.3.m3.1.1.3.2.2.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3.2.2.3.2" xref="S3.SS1.p1.3.m3.1.1.3.2.2.3.2.cmml">x</mi><mi id="S3.SS1.p1.3.m3.1.1.3.2.2.3.3" xref="S3.SS1.p1.3.m3.1.1.3.2.2.3.3.cmml">i</mi></msub></mrow></mrow><mo id="S3.SS1.p1.3.m3.1.1.3.1" xref="S3.SS1.p1.3.m3.1.1.3.1.cmml">+</mo><msub id="S3.SS1.p1.3.m3.1.1.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3.3.2" xref="S3.SS1.p1.3.m3.1.1.3.3.2.cmml">b</mi><mi id="S3.SS1.p1.3.m3.1.1.3.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3.3.cmml">j</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><eq id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1"></eq><apply id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2.2">𝑜</ci><ci id="S3.SS1.p1.3.m3.1.1.2.3.cmml" xref="S3.SS1.p1.3.m3.1.1.2.3">𝑗</ci></apply><apply id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3"><plus id="S3.SS1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.1"></plus><apply id="S3.SS1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2"><apply id="S3.SS1.p1.3.m3.1.1.3.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.3.2.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.1">subscript</csymbol><apply id="S3.SS1.p1.3.m3.1.1.3.2.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.3.2.1.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.1">superscript</csymbol><sum id="S3.SS1.p1.3.m3.1.1.3.2.1.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.1.2.2"></sum><ci id="S3.SS1.p1.3.m3.1.1.3.2.1.2.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.1.2.3">𝑛</ci></apply><ci id="S3.SS1.p1.3.m3.1.1.3.2.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.1.3">𝑖</ci></apply><apply id="S3.SS1.p1.3.m3.1.1.3.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.2"><times id="S3.SS1.p1.3.m3.1.1.3.2.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.2.1"></times><apply id="S3.SS1.p1.3.m3.1.1.3.2.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.3.2.2.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.3.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.2.2.2">𝑤</ci><apply id="S3.SS1.p1.3.m3.1.1.3.2.2.2.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.2.2.3"><times id="S3.SS1.p1.3.m3.1.1.3.2.2.2.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.2.2.3.1"></times><ci id="S3.SS1.p1.3.m3.1.1.3.2.2.2.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.2.2.3.2">𝑖</ci><ci id="S3.SS1.p1.3.m3.1.1.3.2.2.2.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.2.2.3.3">𝑗</ci></apply></apply><apply id="S3.SS1.p1.3.m3.1.1.3.2.2.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.3.2.2.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.2.3">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.3.2.2.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.2.3.2">𝑥</ci><ci id="S3.SS1.p1.3.m3.1.1.3.2.2.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.2.3.3">𝑖</ci></apply></apply></apply><apply id="S3.SS1.p1.3.m3.1.1.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.3.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.3.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.2">𝑏</ci><ci id="S3.SS1.p1.3.m3.1.1.3.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">o_{j}=\sum^{n}_{i}{w_{ij}x_{i}+b_{j}}</annotation></semantics></math>. Note that <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">x</annotation></semantics></math> can be inverted from known <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">y</annotation></semantics></math>, and any additional hidden linear layers can be inverted by back-propagation (however, this is not the case for convolutional layers where inputs are convolved by shared kernel weights).</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Direct inversion of a full batch</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">A typical classification architecture uses softmax, <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="p_{k}=\frac{e^{o_{k}}}{\sum_{j}{e^{o_{j}}}}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><msub id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2.2" xref="S3.SS2.p1.1.m1.1.1.2.2.cmml">p</mi><mi id="S3.SS2.p1.1.m1.1.1.2.3" xref="S3.SS2.p1.1.m1.1.1.2.3.cmml">k</mi></msub><mo id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.cmml">=</mo><mfrac id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml"><msup id="S3.SS2.p1.1.m1.1.1.3.2" xref="S3.SS2.p1.1.m1.1.1.3.2.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.2.2" xref="S3.SS2.p1.1.m1.1.1.3.2.2.cmml">e</mi><msub id="S3.SS2.p1.1.m1.1.1.3.2.3" xref="S3.SS2.p1.1.m1.1.1.3.2.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.2.3.2" xref="S3.SS2.p1.1.m1.1.1.3.2.3.2.cmml">o</mi><mi id="S3.SS2.p1.1.m1.1.1.3.2.3.3" xref="S3.SS2.p1.1.m1.1.1.3.2.3.3.cmml">k</mi></msub></msup><mrow id="S3.SS2.p1.1.m1.1.1.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.cmml"><mstyle displaystyle="false" id="S3.SS2.p1.1.m1.1.1.3.3.1" xref="S3.SS2.p1.1.m1.1.1.3.3.1.cmml"><msub id="S3.SS2.p1.1.m1.1.1.3.3.1a" xref="S3.SS2.p1.1.m1.1.1.3.3.1.cmml"><mo id="S3.SS2.p1.1.m1.1.1.3.3.1.2" xref="S3.SS2.p1.1.m1.1.1.3.3.1.2.cmml">∑</mo><mi id="S3.SS2.p1.1.m1.1.1.3.3.1.3" xref="S3.SS2.p1.1.m1.1.1.3.3.1.3.cmml">j</mi></msub></mstyle><msup id="S3.SS2.p1.1.m1.1.1.3.3.2" xref="S3.SS2.p1.1.m1.1.1.3.3.2.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.3.2.2" xref="S3.SS2.p1.1.m1.1.1.3.3.2.2.cmml">e</mi><msub id="S3.SS2.p1.1.m1.1.1.3.3.2.3" xref="S3.SS2.p1.1.m1.1.1.3.3.2.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.3.2.3.2" xref="S3.SS2.p1.1.m1.1.1.3.3.2.3.2.cmml">o</mi><mi id="S3.SS2.p1.1.m1.1.1.3.3.2.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.2.3.3.cmml">j</mi></msub></msup></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><eq id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1"></eq><apply id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.2.1.cmml" xref="S3.SS2.p1.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2.2">𝑝</ci><ci id="S3.SS2.p1.1.m1.1.1.2.3.cmml" xref="S3.SS2.p1.1.m1.1.1.2.3">𝑘</ci></apply><apply id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3"><divide id="S3.SS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3"></divide><apply id="S3.SS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.3.2.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2">superscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.3.2.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2.2">𝑒</ci><apply id="S3.SS2.p1.1.m1.1.1.3.2.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.3.2.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2.3">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.3.2.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2.3.2">𝑜</ci><ci id="S3.SS2.p1.1.m1.1.1.3.2.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2.3.3">𝑘</ci></apply></apply><apply id="S3.SS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3"><apply id="S3.SS2.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.3.3.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.1">subscript</csymbol><sum id="S3.SS2.p1.1.m1.1.1.3.3.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.1.2"></sum><ci id="S3.SS2.p1.1.m1.1.1.3.3.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.1.3">𝑗</ci></apply><apply id="S3.SS2.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.3.3.2.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.2">superscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.3.3.2.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.2.2">𝑒</ci><apply id="S3.SS2.p1.1.m1.1.1.3.3.2.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.3.3.2.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.2.3">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.3.3.2.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.2.3.2">𝑜</ci><ci id="S3.SS2.p1.1.m1.1.1.3.3.2.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">p_{k}=\frac{e^{o_{k}}}{\sum_{j}{e^{o_{j}}}}</annotation></semantics></math>, followed by cross-entropy to obtain the loss:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.2" class="ltx_Math" alttext="l(p,y)=-\sum_{k}^{C}{y_{k}\log p_{k}}" display="block"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.3" xref="S3.E2.m1.2.3.cmml"><mrow id="S3.E2.m1.2.3.2" xref="S3.E2.m1.2.3.2.cmml"><mi id="S3.E2.m1.2.3.2.2" xref="S3.E2.m1.2.3.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.3.2.1" xref="S3.E2.m1.2.3.2.1.cmml">​</mo><mrow id="S3.E2.m1.2.3.2.3.2" xref="S3.E2.m1.2.3.2.3.1.cmml"><mo stretchy="false" id="S3.E2.m1.2.3.2.3.2.1" xref="S3.E2.m1.2.3.2.3.1.cmml">(</mo><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">p</mi><mo id="S3.E2.m1.2.3.2.3.2.2" xref="S3.E2.m1.2.3.2.3.1.cmml">,</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">y</mi><mo stretchy="false" id="S3.E2.m1.2.3.2.3.2.3" xref="S3.E2.m1.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.2.3.1" xref="S3.E2.m1.2.3.1.cmml">=</mo><mrow id="S3.E2.m1.2.3.3" xref="S3.E2.m1.2.3.3.cmml"><mo id="S3.E2.m1.2.3.3a" xref="S3.E2.m1.2.3.3.cmml">−</mo><mrow id="S3.E2.m1.2.3.3.2" xref="S3.E2.m1.2.3.3.2.cmml"><munderover id="S3.E2.m1.2.3.3.2.1" xref="S3.E2.m1.2.3.3.2.1.cmml"><mo movablelimits="false" id="S3.E2.m1.2.3.3.2.1.2.2" xref="S3.E2.m1.2.3.3.2.1.2.2.cmml">∑</mo><mi id="S3.E2.m1.2.3.3.2.1.2.3" xref="S3.E2.m1.2.3.3.2.1.2.3.cmml">k</mi><mi id="S3.E2.m1.2.3.3.2.1.3" xref="S3.E2.m1.2.3.3.2.1.3.cmml">C</mi></munderover><mrow id="S3.E2.m1.2.3.3.2.2" xref="S3.E2.m1.2.3.3.2.2.cmml"><msub id="S3.E2.m1.2.3.3.2.2.2" xref="S3.E2.m1.2.3.3.2.2.2.cmml"><mi id="S3.E2.m1.2.3.3.2.2.2.2" xref="S3.E2.m1.2.3.3.2.2.2.2.cmml">y</mi><mi id="S3.E2.m1.2.3.3.2.2.2.3" xref="S3.E2.m1.2.3.3.2.2.2.3.cmml">k</mi></msub><mo lspace="0.167em" rspace="0em" id="S3.E2.m1.2.3.3.2.2.1" xref="S3.E2.m1.2.3.3.2.2.1.cmml">​</mo><mrow id="S3.E2.m1.2.3.3.2.2.3" xref="S3.E2.m1.2.3.3.2.2.3.cmml"><mi id="S3.E2.m1.2.3.3.2.2.3.1" xref="S3.E2.m1.2.3.3.2.2.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E2.m1.2.3.3.2.2.3a" xref="S3.E2.m1.2.3.3.2.2.3.cmml">⁡</mo><msub id="S3.E2.m1.2.3.3.2.2.3.2" xref="S3.E2.m1.2.3.3.2.2.3.2.cmml"><mi id="S3.E2.m1.2.3.3.2.2.3.2.2" xref="S3.E2.m1.2.3.3.2.2.3.2.2.cmml">p</mi><mi id="S3.E2.m1.2.3.3.2.2.3.2.3" xref="S3.E2.m1.2.3.3.2.2.3.2.3.cmml">k</mi></msub></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.3.cmml" xref="S3.E2.m1.2.3"><eq id="S3.E2.m1.2.3.1.cmml" xref="S3.E2.m1.2.3.1"></eq><apply id="S3.E2.m1.2.3.2.cmml" xref="S3.E2.m1.2.3.2"><times id="S3.E2.m1.2.3.2.1.cmml" xref="S3.E2.m1.2.3.2.1"></times><ci id="S3.E2.m1.2.3.2.2.cmml" xref="S3.E2.m1.2.3.2.2">𝑙</ci><interval closure="open" id="S3.E2.m1.2.3.2.3.1.cmml" xref="S3.E2.m1.2.3.2.3.2"><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝑝</ci><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝑦</ci></interval></apply><apply id="S3.E2.m1.2.3.3.cmml" xref="S3.E2.m1.2.3.3"><minus id="S3.E2.m1.2.3.3.1.cmml" xref="S3.E2.m1.2.3.3"></minus><apply id="S3.E2.m1.2.3.3.2.cmml" xref="S3.E2.m1.2.3.3.2"><apply id="S3.E2.m1.2.3.3.2.1.cmml" xref="S3.E2.m1.2.3.3.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.3.3.2.1.1.cmml" xref="S3.E2.m1.2.3.3.2.1">superscript</csymbol><apply id="S3.E2.m1.2.3.3.2.1.2.cmml" xref="S3.E2.m1.2.3.3.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.3.3.2.1.2.1.cmml" xref="S3.E2.m1.2.3.3.2.1">subscript</csymbol><sum id="S3.E2.m1.2.3.3.2.1.2.2.cmml" xref="S3.E2.m1.2.3.3.2.1.2.2"></sum><ci id="S3.E2.m1.2.3.3.2.1.2.3.cmml" xref="S3.E2.m1.2.3.3.2.1.2.3">𝑘</ci></apply><ci id="S3.E2.m1.2.3.3.2.1.3.cmml" xref="S3.E2.m1.2.3.3.2.1.3">𝐶</ci></apply><apply id="S3.E2.m1.2.3.3.2.2.cmml" xref="S3.E2.m1.2.3.3.2.2"><times id="S3.E2.m1.2.3.3.2.2.1.cmml" xref="S3.E2.m1.2.3.3.2.2.1"></times><apply id="S3.E2.m1.2.3.3.2.2.2.cmml" xref="S3.E2.m1.2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.3.3.2.2.2.1.cmml" xref="S3.E2.m1.2.3.3.2.2.2">subscript</csymbol><ci id="S3.E2.m1.2.3.3.2.2.2.2.cmml" xref="S3.E2.m1.2.3.3.2.2.2.2">𝑦</ci><ci id="S3.E2.m1.2.3.3.2.2.2.3.cmml" xref="S3.E2.m1.2.3.3.2.2.2.3">𝑘</ci></apply><apply id="S3.E2.m1.2.3.3.2.2.3.cmml" xref="S3.E2.m1.2.3.3.2.2.3"><log id="S3.E2.m1.2.3.3.2.2.3.1.cmml" xref="S3.E2.m1.2.3.3.2.2.3.1"></log><apply id="S3.E2.m1.2.3.3.2.2.3.2.cmml" xref="S3.E2.m1.2.3.3.2.2.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.3.3.2.2.3.2.1.cmml" xref="S3.E2.m1.2.3.3.2.2.3.2">subscript</csymbol><ci id="S3.E2.m1.2.3.3.2.2.3.2.2.cmml" xref="S3.E2.m1.2.3.3.2.2.3.2.2">𝑝</ci><ci id="S3.E2.m1.2.3.3.2.2.3.2.3.cmml" xref="S3.E2.m1.2.3.3.2.2.3.2.3">𝑘</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">l(p,y)=-\sum_{k}^{C}{y_{k}\log p_{k}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.4" class="ltx_p">where, <math id="S3.SS2.p1.2.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS2.p1.2.m1.1a"><mi id="S3.SS2.p1.2.m1.1.1" xref="S3.SS2.p1.2.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m1.1b"><ci id="S3.SS2.p1.2.m1.1.1.cmml" xref="S3.SS2.p1.2.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m1.1c">C</annotation></semantics></math> is the number of classes/categories. The derivative of <math id="S3.SS2.p1.3.m2.1" class="ltx_Math" alttext="p_{k}" display="inline"><semantics id="S3.SS2.p1.3.m2.1a"><msub id="S3.SS2.p1.3.m2.1.1" xref="S3.SS2.p1.3.m2.1.1.cmml"><mi id="S3.SS2.p1.3.m2.1.1.2" xref="S3.SS2.p1.3.m2.1.1.2.cmml">p</mi><mi id="S3.SS2.p1.3.m2.1.1.3" xref="S3.SS2.p1.3.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m2.1b"><apply id="S3.SS2.p1.3.m2.1.1.cmml" xref="S3.SS2.p1.3.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m2.1.1.1.cmml" xref="S3.SS2.p1.3.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m2.1.1.2.cmml" xref="S3.SS2.p1.3.m2.1.1.2">𝑝</ci><ci id="S3.SS2.p1.3.m2.1.1.3.cmml" xref="S3.SS2.p1.3.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m2.1c">p_{k}</annotation></semantics></math> with respect to each <math id="S3.SS2.p1.4.m3.1" class="ltx_Math" alttext="o_{j}" display="inline"><semantics id="S3.SS2.p1.4.m3.1a"><msub id="S3.SS2.p1.4.m3.1.1" xref="S3.SS2.p1.4.m3.1.1.cmml"><mi id="S3.SS2.p1.4.m3.1.1.2" xref="S3.SS2.p1.4.m3.1.1.2.cmml">o</mi><mi id="S3.SS2.p1.4.m3.1.1.3" xref="S3.SS2.p1.4.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m3.1b"><apply id="S3.SS2.p1.4.m3.1.1.cmml" xref="S3.SS2.p1.4.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m3.1.1.1.cmml" xref="S3.SS2.p1.4.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m3.1.1.2.cmml" xref="S3.SS2.p1.4.m3.1.1.2">𝑜</ci><ci id="S3.SS2.p1.4.m3.1.1.3.cmml" xref="S3.SS2.p1.4.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m3.1c">o_{j}</annotation></semantics></math>:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.4" class="ltx_Math" alttext="\frac{\partial{p_{k}}}{\partial{o_{j}}}=\begin{cases}p_{k}(1-p_{j}),&amp;k=j\\
-p_{k}p_{j},&amp;k\neq j.\end{cases}" display="block"><semantics id="S3.E3.m1.4a"><mrow id="S3.E3.m1.4.5" xref="S3.E3.m1.4.5.cmml"><mfrac id="S3.E3.m1.4.5.2" xref="S3.E3.m1.4.5.2.cmml"><mrow id="S3.E3.m1.4.5.2.2" xref="S3.E3.m1.4.5.2.2.cmml"><mo rspace="0em" id="S3.E3.m1.4.5.2.2.1" xref="S3.E3.m1.4.5.2.2.1.cmml">∂</mo><msub id="S3.E3.m1.4.5.2.2.2" xref="S3.E3.m1.4.5.2.2.2.cmml"><mi id="S3.E3.m1.4.5.2.2.2.2" xref="S3.E3.m1.4.5.2.2.2.2.cmml">p</mi><mi id="S3.E3.m1.4.5.2.2.2.3" xref="S3.E3.m1.4.5.2.2.2.3.cmml">k</mi></msub></mrow><mrow id="S3.E3.m1.4.5.2.3" xref="S3.E3.m1.4.5.2.3.cmml"><mo rspace="0em" id="S3.E3.m1.4.5.2.3.1" xref="S3.E3.m1.4.5.2.3.1.cmml">∂</mo><msub id="S3.E3.m1.4.5.2.3.2" xref="S3.E3.m1.4.5.2.3.2.cmml"><mi id="S3.E3.m1.4.5.2.3.2.2" xref="S3.E3.m1.4.5.2.3.2.2.cmml">o</mi><mi id="S3.E3.m1.4.5.2.3.2.3" xref="S3.E3.m1.4.5.2.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo id="S3.E3.m1.4.5.1" xref="S3.E3.m1.4.5.1.cmml">=</mo><mrow id="S3.E3.m1.4.4" xref="S3.E3.m1.4.5.3.1.cmml"><mo id="S3.E3.m1.4.4.5" xref="S3.E3.m1.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S3.E3.m1.4.4.4" xref="S3.E3.m1.4.5.3.1.cmml"><mtr id="S3.E3.m1.4.4.4a" xref="S3.E3.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.4.4.4b" xref="S3.E3.m1.4.5.3.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.2.cmml">p</mi><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">p</mi><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.4.4.4c" xref="S3.E3.m1.4.5.3.1.cmml"><mrow id="S3.E3.m1.2.2.2.2.2.1" xref="S3.E3.m1.2.2.2.2.2.1.cmml"><mi id="S3.E3.m1.2.2.2.2.2.1.2" xref="S3.E3.m1.2.2.2.2.2.1.2.cmml">k</mi><mo id="S3.E3.m1.2.2.2.2.2.1.1" xref="S3.E3.m1.2.2.2.2.2.1.1.cmml">=</mo><mi id="S3.E3.m1.2.2.2.2.2.1.3" xref="S3.E3.m1.2.2.2.2.2.1.3.cmml">j</mi></mrow></mtd></mtr><mtr id="S3.E3.m1.4.4.4d" xref="S3.E3.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.4.4.4e" xref="S3.E3.m1.4.5.3.1.cmml"><mrow id="S3.E3.m1.3.3.3.3.1.1.1" xref="S3.E3.m1.3.3.3.3.1.1.1.1.cmml"><mrow id="S3.E3.m1.3.3.3.3.1.1.1.1" xref="S3.E3.m1.3.3.3.3.1.1.1.1.cmml"><mo id="S3.E3.m1.3.3.3.3.1.1.1.1a" xref="S3.E3.m1.3.3.3.3.1.1.1.1.cmml">−</mo><mrow id="S3.E3.m1.3.3.3.3.1.1.1.1.2" xref="S3.E3.m1.3.3.3.3.1.1.1.1.2.cmml"><msub id="S3.E3.m1.3.3.3.3.1.1.1.1.2.2" xref="S3.E3.m1.3.3.3.3.1.1.1.1.2.2.cmml"><mi id="S3.E3.m1.3.3.3.3.1.1.1.1.2.2.2" xref="S3.E3.m1.3.3.3.3.1.1.1.1.2.2.2.cmml">p</mi><mi id="S3.E3.m1.3.3.3.3.1.1.1.1.2.2.3" xref="S3.E3.m1.3.3.3.3.1.1.1.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.3.3.1.1.1.1.2.1" xref="S3.E3.m1.3.3.3.3.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E3.m1.3.3.3.3.1.1.1.1.2.3" xref="S3.E3.m1.3.3.3.3.1.1.1.1.2.3.cmml"><mi id="S3.E3.m1.3.3.3.3.1.1.1.1.2.3.2" xref="S3.E3.m1.3.3.3.3.1.1.1.1.2.3.2.cmml">p</mi><mi id="S3.E3.m1.3.3.3.3.1.1.1.1.2.3.3" xref="S3.E3.m1.3.3.3.3.1.1.1.1.2.3.3.cmml">j</mi></msub></mrow></mrow><mo id="S3.E3.m1.3.3.3.3.1.1.1.2" xref="S3.E3.m1.3.3.3.3.1.1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.4.4.4f" xref="S3.E3.m1.4.5.3.1.cmml"><mrow id="S3.E3.m1.4.4.4.4.2.1.1" xref="S3.E3.m1.4.4.4.4.2.1.1.1.cmml"><mrow id="S3.E3.m1.4.4.4.4.2.1.1.1" xref="S3.E3.m1.4.4.4.4.2.1.1.1.cmml"><mi id="S3.E3.m1.4.4.4.4.2.1.1.1.2" xref="S3.E3.m1.4.4.4.4.2.1.1.1.2.cmml">k</mi><mo id="S3.E3.m1.4.4.4.4.2.1.1.1.1" xref="S3.E3.m1.4.4.4.4.2.1.1.1.1.cmml">≠</mo><mi id="S3.E3.m1.4.4.4.4.2.1.1.1.3" xref="S3.E3.m1.4.4.4.4.2.1.1.1.3.cmml">j</mi></mrow><mo lspace="0em" id="S3.E3.m1.4.4.4.4.2.1.1.2" xref="S3.E3.m1.4.4.4.4.2.1.1.1.cmml">.</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.4b"><apply id="S3.E3.m1.4.5.cmml" xref="S3.E3.m1.4.5"><eq id="S3.E3.m1.4.5.1.cmml" xref="S3.E3.m1.4.5.1"></eq><apply id="S3.E3.m1.4.5.2.cmml" xref="S3.E3.m1.4.5.2"><divide id="S3.E3.m1.4.5.2.1.cmml" xref="S3.E3.m1.4.5.2"></divide><apply id="S3.E3.m1.4.5.2.2.cmml" xref="S3.E3.m1.4.5.2.2"><partialdiff id="S3.E3.m1.4.5.2.2.1.cmml" xref="S3.E3.m1.4.5.2.2.1"></partialdiff><apply id="S3.E3.m1.4.5.2.2.2.cmml" xref="S3.E3.m1.4.5.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.5.2.2.2.1.cmml" xref="S3.E3.m1.4.5.2.2.2">subscript</csymbol><ci id="S3.E3.m1.4.5.2.2.2.2.cmml" xref="S3.E3.m1.4.5.2.2.2.2">𝑝</ci><ci id="S3.E3.m1.4.5.2.2.2.3.cmml" xref="S3.E3.m1.4.5.2.2.2.3">𝑘</ci></apply></apply><apply id="S3.E3.m1.4.5.2.3.cmml" xref="S3.E3.m1.4.5.2.3"><partialdiff id="S3.E3.m1.4.5.2.3.1.cmml" xref="S3.E3.m1.4.5.2.3.1"></partialdiff><apply id="S3.E3.m1.4.5.2.3.2.cmml" xref="S3.E3.m1.4.5.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.5.2.3.2.1.cmml" xref="S3.E3.m1.4.5.2.3.2">subscript</csymbol><ci id="S3.E3.m1.4.5.2.3.2.2.cmml" xref="S3.E3.m1.4.5.2.3.2.2">𝑜</ci><ci id="S3.E3.m1.4.5.2.3.2.3.cmml" xref="S3.E3.m1.4.5.2.3.2.3">𝑗</ci></apply></apply></apply><apply id="S3.E3.m1.4.5.3.1.cmml" xref="S3.E3.m1.4.4"><csymbol cd="latexml" id="S3.E3.m1.4.5.3.1.1.cmml" xref="S3.E3.m1.4.4.5">cases</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1"><times id="S3.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.2">𝑝</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑝</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><apply id="S3.E3.m1.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.2.1"><eq id="S3.E3.m1.2.2.2.2.2.1.1.cmml" xref="S3.E3.m1.2.2.2.2.2.1.1"></eq><ci id="S3.E3.m1.2.2.2.2.2.1.2.cmml" xref="S3.E3.m1.2.2.2.2.2.1.2">𝑘</ci><ci id="S3.E3.m1.2.2.2.2.2.1.3.cmml" xref="S3.E3.m1.2.2.2.2.2.1.3">𝑗</ci></apply><apply id="S3.E3.m1.3.3.3.3.1.1.1.1.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1"><minus id="S3.E3.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1"></minus><apply id="S3.E3.m1.3.3.3.3.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.2"><times id="S3.E3.m1.3.3.3.3.1.1.1.1.2.1.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.2.1"></times><apply id="S3.E3.m1.3.3.3.3.1.1.1.1.2.2.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.3.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E3.m1.3.3.3.3.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.2.2.2">𝑝</ci><ci id="S3.E3.m1.3.3.3.3.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.2.2.3">𝑘</ci></apply><apply id="S3.E3.m1.3.3.3.3.1.1.1.1.2.3.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.3.1.1.1.1.2.3.1.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E3.m1.3.3.3.3.1.1.1.1.2.3.2.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.2.3.2">𝑝</ci><ci id="S3.E3.m1.3.3.3.3.1.1.1.1.2.3.3.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.2.3.3">𝑗</ci></apply></apply></apply><apply id="S3.E3.m1.4.4.4.4.2.1.1.1.cmml" xref="S3.E3.m1.4.4.4.4.2.1.1"><neq id="S3.E3.m1.4.4.4.4.2.1.1.1.1.cmml" xref="S3.E3.m1.4.4.4.4.2.1.1.1.1"></neq><ci id="S3.E3.m1.4.4.4.4.2.1.1.1.2.cmml" xref="S3.E3.m1.4.4.4.4.2.1.1.1.2">𝑘</ci><ci id="S3.E3.m1.4.4.4.4.2.1.1.1.3.cmml" xref="S3.E3.m1.4.4.4.4.2.1.1.1.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.4c">\frac{\partial{p_{k}}}{\partial{o_{j}}}=\begin{cases}p_{k}(1-p_{j}),&amp;k=j\\
-p_{k}p_{j},&amp;k\neq j.\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.13" class="ltx_p">The loss set of equations is then obtained:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.3" class="ltx_Math" alttext="\frac{\partial{l}}{\partial w_{i,j=k}}=\frac{\partial{l}}{\partial{p_{k}}}\frac{\partial{p_{k}}}{\partial{o_{j}}}x_{i}=(p_{j}-y_{j})x_{i}" display="block"><semantics id="S3.E4.m1.3a"><mrow id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml"><mfrac id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml"><mrow id="S3.E4.m1.2.2.4" xref="S3.E4.m1.2.2.4.cmml"><mo rspace="0em" id="S3.E4.m1.2.2.4.1" xref="S3.E4.m1.2.2.4.1.cmml">∂</mo><mi id="S3.E4.m1.2.2.4.2" xref="S3.E4.m1.2.2.4.2.cmml">l</mi></mrow><mrow id="S3.E4.m1.2.2.2" xref="S3.E4.m1.2.2.2.cmml"><mo rspace="0em" id="S3.E4.m1.2.2.2.3" xref="S3.E4.m1.2.2.2.3.cmml">∂</mo><msub id="S3.E4.m1.2.2.2.4" xref="S3.E4.m1.2.2.2.4.cmml"><mi id="S3.E4.m1.2.2.2.4.2" xref="S3.E4.m1.2.2.2.4.2.cmml">w</mi><mrow id="S3.E4.m1.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.cmml"><mrow id="S3.E4.m1.2.2.2.2.2.4.2" xref="S3.E4.m1.2.2.2.2.2.4.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml">i</mi><mo id="S3.E4.m1.2.2.2.2.2.4.2.1" xref="S3.E4.m1.2.2.2.2.2.4.1.cmml">,</mo><mi id="S3.E4.m1.2.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.2.cmml">j</mi></mrow><mo id="S3.E4.m1.2.2.2.2.2.3" xref="S3.E4.m1.2.2.2.2.2.3.cmml">=</mo><mi id="S3.E4.m1.2.2.2.2.2.5" xref="S3.E4.m1.2.2.2.2.2.5.cmml">k</mi></mrow></msub></mrow></mfrac><mo id="S3.E4.m1.3.3.3" xref="S3.E4.m1.3.3.3.cmml">=</mo><mrow id="S3.E4.m1.3.3.4" xref="S3.E4.m1.3.3.4.cmml"><mfrac id="S3.E4.m1.3.3.4.2" xref="S3.E4.m1.3.3.4.2.cmml"><mrow id="S3.E4.m1.3.3.4.2.2" xref="S3.E4.m1.3.3.4.2.2.cmml"><mo rspace="0em" id="S3.E4.m1.3.3.4.2.2.1" xref="S3.E4.m1.3.3.4.2.2.1.cmml">∂</mo><mi id="S3.E4.m1.3.3.4.2.2.2" xref="S3.E4.m1.3.3.4.2.2.2.cmml">l</mi></mrow><mrow id="S3.E4.m1.3.3.4.2.3" xref="S3.E4.m1.3.3.4.2.3.cmml"><mo rspace="0em" id="S3.E4.m1.3.3.4.2.3.1" xref="S3.E4.m1.3.3.4.2.3.1.cmml">∂</mo><msub id="S3.E4.m1.3.3.4.2.3.2" xref="S3.E4.m1.3.3.4.2.3.2.cmml"><mi id="S3.E4.m1.3.3.4.2.3.2.2" xref="S3.E4.m1.3.3.4.2.3.2.2.cmml">p</mi><mi id="S3.E4.m1.3.3.4.2.3.2.3" xref="S3.E4.m1.3.3.4.2.3.2.3.cmml">k</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.4.1" xref="S3.E4.m1.3.3.4.1.cmml">​</mo><mfrac id="S3.E4.m1.3.3.4.3" xref="S3.E4.m1.3.3.4.3.cmml"><mrow id="S3.E4.m1.3.3.4.3.2" xref="S3.E4.m1.3.3.4.3.2.cmml"><mo rspace="0em" id="S3.E4.m1.3.3.4.3.2.1" xref="S3.E4.m1.3.3.4.3.2.1.cmml">∂</mo><msub id="S3.E4.m1.3.3.4.3.2.2" xref="S3.E4.m1.3.3.4.3.2.2.cmml"><mi id="S3.E4.m1.3.3.4.3.2.2.2" xref="S3.E4.m1.3.3.4.3.2.2.2.cmml">p</mi><mi id="S3.E4.m1.3.3.4.3.2.2.3" xref="S3.E4.m1.3.3.4.3.2.2.3.cmml">k</mi></msub></mrow><mrow id="S3.E4.m1.3.3.4.3.3" xref="S3.E4.m1.3.3.4.3.3.cmml"><mo rspace="0em" id="S3.E4.m1.3.3.4.3.3.1" xref="S3.E4.m1.3.3.4.3.3.1.cmml">∂</mo><msub id="S3.E4.m1.3.3.4.3.3.2" xref="S3.E4.m1.3.3.4.3.3.2.cmml"><mi id="S3.E4.m1.3.3.4.3.3.2.2" xref="S3.E4.m1.3.3.4.3.3.2.2.cmml">o</mi><mi id="S3.E4.m1.3.3.4.3.3.2.3" xref="S3.E4.m1.3.3.4.3.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.4.1a" xref="S3.E4.m1.3.3.4.1.cmml">​</mo><msub id="S3.E4.m1.3.3.4.4" xref="S3.E4.m1.3.3.4.4.cmml"><mi id="S3.E4.m1.3.3.4.4.2" xref="S3.E4.m1.3.3.4.4.2.cmml">x</mi><mi id="S3.E4.m1.3.3.4.4.3" xref="S3.E4.m1.3.3.4.4.3.cmml">i</mi></msub></mrow><mo id="S3.E4.m1.3.3.5" xref="S3.E4.m1.3.3.5.cmml">=</mo><mrow id="S3.E4.m1.3.3.1" xref="S3.E4.m1.3.3.1.cmml"><mrow id="S3.E4.m1.3.3.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.3.3.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.3.3.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.cmml"><msub id="S3.E4.m1.3.3.1.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.1.2.cmml"><mi id="S3.E4.m1.3.3.1.1.1.1.2.2" xref="S3.E4.m1.3.3.1.1.1.1.2.2.cmml">p</mi><mi id="S3.E4.m1.3.3.1.1.1.1.2.3" xref="S3.E4.m1.3.3.1.1.1.1.2.3.cmml">j</mi></msub><mo id="S3.E4.m1.3.3.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.cmml">−</mo><msub id="S3.E4.m1.3.3.1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.3.cmml"><mi id="S3.E4.m1.3.3.1.1.1.1.3.2" xref="S3.E4.m1.3.3.1.1.1.1.3.2.cmml">y</mi><mi id="S3.E4.m1.3.3.1.1.1.1.3.3" xref="S3.E4.m1.3.3.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S3.E4.m1.3.3.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.1.2" xref="S3.E4.m1.3.3.1.2.cmml">​</mo><msub id="S3.E4.m1.3.3.1.3" xref="S3.E4.m1.3.3.1.3.cmml"><mi id="S3.E4.m1.3.3.1.3.2" xref="S3.E4.m1.3.3.1.3.2.cmml">x</mi><mi id="S3.E4.m1.3.3.1.3.3" xref="S3.E4.m1.3.3.1.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.3b"><apply id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3"><and id="S3.E4.m1.3.3a.cmml" xref="S3.E4.m1.3.3"></and><apply id="S3.E4.m1.3.3b.cmml" xref="S3.E4.m1.3.3"><eq id="S3.E4.m1.3.3.3.cmml" xref="S3.E4.m1.3.3.3"></eq><apply id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2"><divide id="S3.E4.m1.2.2.3.cmml" xref="S3.E4.m1.2.2"></divide><apply id="S3.E4.m1.2.2.4.cmml" xref="S3.E4.m1.2.2.4"><partialdiff id="S3.E4.m1.2.2.4.1.cmml" xref="S3.E4.m1.2.2.4.1"></partialdiff><ci id="S3.E4.m1.2.2.4.2.cmml" xref="S3.E4.m1.2.2.4.2">𝑙</ci></apply><apply id="S3.E4.m1.2.2.2.cmml" xref="S3.E4.m1.2.2.2"><partialdiff id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.3"></partialdiff><apply id="S3.E4.m1.2.2.2.4.cmml" xref="S3.E4.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.4.1.cmml" xref="S3.E4.m1.2.2.2.4">subscript</csymbol><ci id="S3.E4.m1.2.2.2.4.2.cmml" xref="S3.E4.m1.2.2.2.4.2">𝑤</ci><apply id="S3.E4.m1.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2"><eq id="S3.E4.m1.2.2.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.3"></eq><list id="S3.E4.m1.2.2.2.2.2.4.1.cmml" xref="S3.E4.m1.2.2.2.2.2.4.2"><ci id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1">𝑖</ci><ci id="S3.E4.m1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2">𝑗</ci></list><ci id="S3.E4.m1.2.2.2.2.2.5.cmml" xref="S3.E4.m1.2.2.2.2.2.5">𝑘</ci></apply></apply></apply></apply><apply id="S3.E4.m1.3.3.4.cmml" xref="S3.E4.m1.3.3.4"><times id="S3.E4.m1.3.3.4.1.cmml" xref="S3.E4.m1.3.3.4.1"></times><apply id="S3.E4.m1.3.3.4.2.cmml" xref="S3.E4.m1.3.3.4.2"><divide id="S3.E4.m1.3.3.4.2.1.cmml" xref="S3.E4.m1.3.3.4.2"></divide><apply id="S3.E4.m1.3.3.4.2.2.cmml" xref="S3.E4.m1.3.3.4.2.2"><partialdiff id="S3.E4.m1.3.3.4.2.2.1.cmml" xref="S3.E4.m1.3.3.4.2.2.1"></partialdiff><ci id="S3.E4.m1.3.3.4.2.2.2.cmml" xref="S3.E4.m1.3.3.4.2.2.2">𝑙</ci></apply><apply id="S3.E4.m1.3.3.4.2.3.cmml" xref="S3.E4.m1.3.3.4.2.3"><partialdiff id="S3.E4.m1.3.3.4.2.3.1.cmml" xref="S3.E4.m1.3.3.4.2.3.1"></partialdiff><apply id="S3.E4.m1.3.3.4.2.3.2.cmml" xref="S3.E4.m1.3.3.4.2.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.4.2.3.2.1.cmml" xref="S3.E4.m1.3.3.4.2.3.2">subscript</csymbol><ci id="S3.E4.m1.3.3.4.2.3.2.2.cmml" xref="S3.E4.m1.3.3.4.2.3.2.2">𝑝</ci><ci id="S3.E4.m1.3.3.4.2.3.2.3.cmml" xref="S3.E4.m1.3.3.4.2.3.2.3">𝑘</ci></apply></apply></apply><apply id="S3.E4.m1.3.3.4.3.cmml" xref="S3.E4.m1.3.3.4.3"><divide id="S3.E4.m1.3.3.4.3.1.cmml" xref="S3.E4.m1.3.3.4.3"></divide><apply id="S3.E4.m1.3.3.4.3.2.cmml" xref="S3.E4.m1.3.3.4.3.2"><partialdiff id="S3.E4.m1.3.3.4.3.2.1.cmml" xref="S3.E4.m1.3.3.4.3.2.1"></partialdiff><apply id="S3.E4.m1.3.3.4.3.2.2.cmml" xref="S3.E4.m1.3.3.4.3.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.4.3.2.2.1.cmml" xref="S3.E4.m1.3.3.4.3.2.2">subscript</csymbol><ci id="S3.E4.m1.3.3.4.3.2.2.2.cmml" xref="S3.E4.m1.3.3.4.3.2.2.2">𝑝</ci><ci id="S3.E4.m1.3.3.4.3.2.2.3.cmml" xref="S3.E4.m1.3.3.4.3.2.2.3">𝑘</ci></apply></apply><apply id="S3.E4.m1.3.3.4.3.3.cmml" xref="S3.E4.m1.3.3.4.3.3"><partialdiff id="S3.E4.m1.3.3.4.3.3.1.cmml" xref="S3.E4.m1.3.3.4.3.3.1"></partialdiff><apply id="S3.E4.m1.3.3.4.3.3.2.cmml" xref="S3.E4.m1.3.3.4.3.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.4.3.3.2.1.cmml" xref="S3.E4.m1.3.3.4.3.3.2">subscript</csymbol><ci id="S3.E4.m1.3.3.4.3.3.2.2.cmml" xref="S3.E4.m1.3.3.4.3.3.2.2">𝑜</ci><ci id="S3.E4.m1.3.3.4.3.3.2.3.cmml" xref="S3.E4.m1.3.3.4.3.3.2.3">𝑗</ci></apply></apply></apply><apply id="S3.E4.m1.3.3.4.4.cmml" xref="S3.E4.m1.3.3.4.4"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.4.4.1.cmml" xref="S3.E4.m1.3.3.4.4">subscript</csymbol><ci id="S3.E4.m1.3.3.4.4.2.cmml" xref="S3.E4.m1.3.3.4.4.2">𝑥</ci><ci id="S3.E4.m1.3.3.4.4.3.cmml" xref="S3.E4.m1.3.3.4.4.3">𝑖</ci></apply></apply></apply><apply id="S3.E4.m1.3.3c.cmml" xref="S3.E4.m1.3.3"><eq id="S3.E4.m1.3.3.5.cmml" xref="S3.E4.m1.3.3.5"></eq><share href="#S3.E4.m1.3.3.4.cmml" id="S3.E4.m1.3.3d.cmml" xref="S3.E4.m1.3.3"></share><apply id="S3.E4.m1.3.3.1.cmml" xref="S3.E4.m1.3.3.1"><times id="S3.E4.m1.3.3.1.2.cmml" xref="S3.E4.m1.3.3.1.2"></times><apply id="S3.E4.m1.3.3.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1"><minus id="S3.E4.m1.3.3.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1"></minus><apply id="S3.E4.m1.3.3.1.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.2.2">𝑝</ci><ci id="S3.E4.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.2.3">𝑗</ci></apply><apply id="S3.E4.m1.3.3.1.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.3.2">𝑦</ci><ci id="S3.E4.m1.3.3.1.1.1.1.3.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.3.3">𝑗</ci></apply></apply><apply id="S3.E4.m1.3.3.1.3.cmml" xref="S3.E4.m1.3.3.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.3.1.cmml" xref="S3.E4.m1.3.3.1.3">subscript</csymbol><ci id="S3.E4.m1.3.3.1.3.2.cmml" xref="S3.E4.m1.3.3.1.3.2">𝑥</ci><ci id="S3.E4.m1.3.3.1.3.3.cmml" xref="S3.E4.m1.3.3.1.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.3c">\frac{\partial{l}}{\partial w_{i,j=k}}=\frac{\partial{l}}{\partial{p_{k}}}\frac{\partial{p_{k}}}{\partial{o_{j}}}x_{i}=(p_{j}-y_{j})x_{i}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.14" class="ltx_p">and:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.1" class="ltx_Math" alttext="\frac{\partial{l}}{\partial b_{j=k}}=p_{j}-y_{j}" display="block"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml"><mfrac id="S3.E5.m1.1.1.2" xref="S3.E5.m1.1.1.2.cmml"><mrow id="S3.E5.m1.1.1.2.2" xref="S3.E5.m1.1.1.2.2.cmml"><mo rspace="0em" id="S3.E5.m1.1.1.2.2.1" xref="S3.E5.m1.1.1.2.2.1.cmml">∂</mo><mi id="S3.E5.m1.1.1.2.2.2" xref="S3.E5.m1.1.1.2.2.2.cmml">l</mi></mrow><mrow id="S3.E5.m1.1.1.2.3" xref="S3.E5.m1.1.1.2.3.cmml"><mo rspace="0em" id="S3.E5.m1.1.1.2.3.1" xref="S3.E5.m1.1.1.2.3.1.cmml">∂</mo><msub id="S3.E5.m1.1.1.2.3.2" xref="S3.E5.m1.1.1.2.3.2.cmml"><mi id="S3.E5.m1.1.1.2.3.2.2" xref="S3.E5.m1.1.1.2.3.2.2.cmml">b</mi><mrow id="S3.E5.m1.1.1.2.3.2.3" xref="S3.E5.m1.1.1.2.3.2.3.cmml"><mi id="S3.E5.m1.1.1.2.3.2.3.2" xref="S3.E5.m1.1.1.2.3.2.3.2.cmml">j</mi><mo id="S3.E5.m1.1.1.2.3.2.3.1" xref="S3.E5.m1.1.1.2.3.2.3.1.cmml">=</mo><mi id="S3.E5.m1.1.1.2.3.2.3.3" xref="S3.E5.m1.1.1.2.3.2.3.3.cmml">k</mi></mrow></msub></mrow></mfrac><mo id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.cmml">=</mo><mrow id="S3.E5.m1.1.1.3" xref="S3.E5.m1.1.1.3.cmml"><msub id="S3.E5.m1.1.1.3.2" xref="S3.E5.m1.1.1.3.2.cmml"><mi id="S3.E5.m1.1.1.3.2.2" xref="S3.E5.m1.1.1.3.2.2.cmml">p</mi><mi id="S3.E5.m1.1.1.3.2.3" xref="S3.E5.m1.1.1.3.2.3.cmml">j</mi></msub><mo id="S3.E5.m1.1.1.3.1" xref="S3.E5.m1.1.1.3.1.cmml">−</mo><msub id="S3.E5.m1.1.1.3.3" xref="S3.E5.m1.1.1.3.3.cmml"><mi id="S3.E5.m1.1.1.3.3.2" xref="S3.E5.m1.1.1.3.3.2.cmml">y</mi><mi id="S3.E5.m1.1.1.3.3.3" xref="S3.E5.m1.1.1.3.3.3.cmml">j</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1"><eq id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"></eq><apply id="S3.E5.m1.1.1.2.cmml" xref="S3.E5.m1.1.1.2"><divide id="S3.E5.m1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.2"></divide><apply id="S3.E5.m1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.2.2"><partialdiff id="S3.E5.m1.1.1.2.2.1.cmml" xref="S3.E5.m1.1.1.2.2.1"></partialdiff><ci id="S3.E5.m1.1.1.2.2.2.cmml" xref="S3.E5.m1.1.1.2.2.2">𝑙</ci></apply><apply id="S3.E5.m1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.2.3"><partialdiff id="S3.E5.m1.1.1.2.3.1.cmml" xref="S3.E5.m1.1.1.2.3.1"></partialdiff><apply id="S3.E5.m1.1.1.2.3.2.cmml" xref="S3.E5.m1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.2.3.2.1.cmml" xref="S3.E5.m1.1.1.2.3.2">subscript</csymbol><ci id="S3.E5.m1.1.1.2.3.2.2.cmml" xref="S3.E5.m1.1.1.2.3.2.2">𝑏</ci><apply id="S3.E5.m1.1.1.2.3.2.3.cmml" xref="S3.E5.m1.1.1.2.3.2.3"><eq id="S3.E5.m1.1.1.2.3.2.3.1.cmml" xref="S3.E5.m1.1.1.2.3.2.3.1"></eq><ci id="S3.E5.m1.1.1.2.3.2.3.2.cmml" xref="S3.E5.m1.1.1.2.3.2.3.2">𝑗</ci><ci id="S3.E5.m1.1.1.2.3.2.3.3.cmml" xref="S3.E5.m1.1.1.2.3.2.3.3">𝑘</ci></apply></apply></apply></apply><apply id="S3.E5.m1.1.1.3.cmml" xref="S3.E5.m1.1.1.3"><minus id="S3.E5.m1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.3.1"></minus><apply id="S3.E5.m1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.2.1.cmml" xref="S3.E5.m1.1.1.3.2">subscript</csymbol><ci id="S3.E5.m1.1.1.3.2.2.cmml" xref="S3.E5.m1.1.1.3.2.2">𝑝</ci><ci id="S3.E5.m1.1.1.3.2.3.cmml" xref="S3.E5.m1.1.1.3.2.3">𝑗</ci></apply><apply id="S3.E5.m1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.3.1.cmml" xref="S3.E5.m1.1.1.3.3">subscript</csymbol><ci id="S3.E5.m1.1.1.3.3.2.cmml" xref="S3.E5.m1.1.1.3.3.2">𝑦</ci><ci id="S3.E5.m1.1.1.3.3.3.cmml" xref="S3.E5.m1.1.1.3.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\frac{\partial{l}}{\partial b_{j=k}}=p_{j}-y_{j}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.12" class="ltx_p">Specifically, the gradients are shared accurately for a single input batch, <math id="S3.SS2.p1.5.m1.1" class="ltx_Math" alttext="B=1" display="inline"><semantics id="S3.SS2.p1.5.m1.1a"><mrow id="S3.SS2.p1.5.m1.1.1" xref="S3.SS2.p1.5.m1.1.1.cmml"><mi id="S3.SS2.p1.5.m1.1.1.2" xref="S3.SS2.p1.5.m1.1.1.2.cmml">B</mi><mo id="S3.SS2.p1.5.m1.1.1.1" xref="S3.SS2.p1.5.m1.1.1.1.cmml">=</mo><mn id="S3.SS2.p1.5.m1.1.1.3" xref="S3.SS2.p1.5.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m1.1b"><apply id="S3.SS2.p1.5.m1.1.1.cmml" xref="S3.SS2.p1.5.m1.1.1"><eq id="S3.SS2.p1.5.m1.1.1.1.cmml" xref="S3.SS2.p1.5.m1.1.1.1"></eq><ci id="S3.SS2.p1.5.m1.1.1.2.cmml" xref="S3.SS2.p1.5.m1.1.1.2">𝐵</ci><cn type="integer" id="S3.SS2.p1.5.m1.1.1.3.cmml" xref="S3.SS2.p1.5.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m1.1c">B=1</annotation></semantics></math>, as also observed by <cite class="ltx_cite ltx_citemacro_citet">Qian et al. (<a href="#bib.bib16" title="" class="ltx_ref">2021</a>)</cite>.
The number of gradient equations are <math id="S3.SS2.p1.6.m2.1" class="ltx_Math" alttext="nC+C" display="inline"><semantics id="S3.SS2.p1.6.m2.1a"><mrow id="S3.SS2.p1.6.m2.1.1" xref="S3.SS2.p1.6.m2.1.1.cmml"><mrow id="S3.SS2.p1.6.m2.1.1.2" xref="S3.SS2.p1.6.m2.1.1.2.cmml"><mi id="S3.SS2.p1.6.m2.1.1.2.2" xref="S3.SS2.p1.6.m2.1.1.2.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.6.m2.1.1.2.1" xref="S3.SS2.p1.6.m2.1.1.2.1.cmml">​</mo><mi id="S3.SS2.p1.6.m2.1.1.2.3" xref="S3.SS2.p1.6.m2.1.1.2.3.cmml">C</mi></mrow><mo id="S3.SS2.p1.6.m2.1.1.1" xref="S3.SS2.p1.6.m2.1.1.1.cmml">+</mo><mi id="S3.SS2.p1.6.m2.1.1.3" xref="S3.SS2.p1.6.m2.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m2.1b"><apply id="S3.SS2.p1.6.m2.1.1.cmml" xref="S3.SS2.p1.6.m2.1.1"><plus id="S3.SS2.p1.6.m2.1.1.1.cmml" xref="S3.SS2.p1.6.m2.1.1.1"></plus><apply id="S3.SS2.p1.6.m2.1.1.2.cmml" xref="S3.SS2.p1.6.m2.1.1.2"><times id="S3.SS2.p1.6.m2.1.1.2.1.cmml" xref="S3.SS2.p1.6.m2.1.1.2.1"></times><ci id="S3.SS2.p1.6.m2.1.1.2.2.cmml" xref="S3.SS2.p1.6.m2.1.1.2.2">𝑛</ci><ci id="S3.SS2.p1.6.m2.1.1.2.3.cmml" xref="S3.SS2.p1.6.m2.1.1.2.3">𝐶</ci></apply><ci id="S3.SS2.p1.6.m2.1.1.3.cmml" xref="S3.SS2.p1.6.m2.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m2.1c">nC+C</annotation></semantics></math> with an extra <math id="S3.SS2.p1.7.m3.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS2.p1.7.m3.1a"><mi id="S3.SS2.p1.7.m3.1.1" xref="S3.SS2.p1.7.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m3.1b"><ci id="S3.SS2.p1.7.m3.1.1.cmml" xref="S3.SS2.p1.7.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m3.1c">C</annotation></semantics></math> equations for weights (for each <math id="S3.SS2.p1.8.m4.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS2.p1.8.m4.1a"><mi id="S3.SS2.p1.8.m4.1.1" xref="S3.SS2.p1.8.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m4.1b"><ci id="S3.SS2.p1.8.m4.1.1.cmml" xref="S3.SS2.p1.8.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m4.1c">j</annotation></semantics></math>) whilst the unknowns are <math id="S3.SS2.p1.9.m5.1" class="ltx_Math" alttext="n+C" display="inline"><semantics id="S3.SS2.p1.9.m5.1a"><mrow id="S3.SS2.p1.9.m5.1.1" xref="S3.SS2.p1.9.m5.1.1.cmml"><mi id="S3.SS2.p1.9.m5.1.1.2" xref="S3.SS2.p1.9.m5.1.1.2.cmml">n</mi><mo id="S3.SS2.p1.9.m5.1.1.1" xref="S3.SS2.p1.9.m5.1.1.1.cmml">+</mo><mi id="S3.SS2.p1.9.m5.1.1.3" xref="S3.SS2.p1.9.m5.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m5.1b"><apply id="S3.SS2.p1.9.m5.1.1.cmml" xref="S3.SS2.p1.9.m5.1.1"><plus id="S3.SS2.p1.9.m5.1.1.1.cmml" xref="S3.SS2.p1.9.m5.1.1.1"></plus><ci id="S3.SS2.p1.9.m5.1.1.2.cmml" xref="S3.SS2.p1.9.m5.1.1.2">𝑛</ci><ci id="S3.SS2.p1.9.m5.1.1.3.cmml" xref="S3.SS2.p1.9.m5.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m5.1c">n+C</annotation></semantics></math>. For example <math id="S3.SS2.p1.10.m6.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="S3.SS2.p1.10.m6.1a"><msub id="S3.SS2.p1.10.m6.1.1" xref="S3.SS2.p1.10.m6.1.1.cmml"><mi id="S3.SS2.p1.10.m6.1.1.2" xref="S3.SS2.p1.10.m6.1.1.2.cmml">x</mi><mi id="S3.SS2.p1.10.m6.1.1.3" xref="S3.SS2.p1.10.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m6.1b"><apply id="S3.SS2.p1.10.m6.1.1.cmml" xref="S3.SS2.p1.10.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m6.1.1.1.cmml" xref="S3.SS2.p1.10.m6.1.1">subscript</csymbol><ci id="S3.SS2.p1.10.m6.1.1.2.cmml" xref="S3.SS2.p1.10.m6.1.1.2">𝑥</ci><ci id="S3.SS2.p1.10.m6.1.1.3.cmml" xref="S3.SS2.p1.10.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m6.1c">x_{i}</annotation></semantics></math> can be found from any <math id="S3.SS2.p1.11.m7.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS2.p1.11.m7.1a"><mi id="S3.SS2.p1.11.m7.1.1" xref="S3.SS2.p1.11.m7.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m7.1b"><ci id="S3.SS2.p1.11.m7.1.1.cmml" xref="S3.SS2.p1.11.m7.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m7.1c">j</annotation></semantics></math>, using <math id="S3.SS2.p1.12.m8.1" class="ltx_Math" alttext="\frac{\partial{l}}{\partial w_{ij=k}}/\frac{\partial{l}}{\partial b_{j=k}}=x_{i}" display="inline"><semantics id="S3.SS2.p1.12.m8.1a"><mrow id="S3.SS2.p1.12.m8.1.1" xref="S3.SS2.p1.12.m8.1.1.cmml"><mrow id="S3.SS2.p1.12.m8.1.1.2" xref="S3.SS2.p1.12.m8.1.1.2.cmml"><mfrac id="S3.SS2.p1.12.m8.1.1.2.2" xref="S3.SS2.p1.12.m8.1.1.2.2.cmml"><mrow id="S3.SS2.p1.12.m8.1.1.2.2.2" xref="S3.SS2.p1.12.m8.1.1.2.2.2.cmml"><mo rspace="0em" id="S3.SS2.p1.12.m8.1.1.2.2.2.1" xref="S3.SS2.p1.12.m8.1.1.2.2.2.1.cmml">∂</mo><mi id="S3.SS2.p1.12.m8.1.1.2.2.2.2" xref="S3.SS2.p1.12.m8.1.1.2.2.2.2.cmml">l</mi></mrow><mrow id="S3.SS2.p1.12.m8.1.1.2.2.3" xref="S3.SS2.p1.12.m8.1.1.2.2.3.cmml"><mo rspace="0em" id="S3.SS2.p1.12.m8.1.1.2.2.3.1" xref="S3.SS2.p1.12.m8.1.1.2.2.3.1.cmml">∂</mo><msub id="S3.SS2.p1.12.m8.1.1.2.2.3.2" xref="S3.SS2.p1.12.m8.1.1.2.2.3.2.cmml"><mi id="S3.SS2.p1.12.m8.1.1.2.2.3.2.2" xref="S3.SS2.p1.12.m8.1.1.2.2.3.2.2.cmml">w</mi><mrow id="S3.SS2.p1.12.m8.1.1.2.2.3.2.3" xref="S3.SS2.p1.12.m8.1.1.2.2.3.2.3.cmml"><mrow id="S3.SS2.p1.12.m8.1.1.2.2.3.2.3.2" xref="S3.SS2.p1.12.m8.1.1.2.2.3.2.3.2.cmml"><mi id="S3.SS2.p1.12.m8.1.1.2.2.3.2.3.2.2" xref="S3.SS2.p1.12.m8.1.1.2.2.3.2.3.2.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.12.m8.1.1.2.2.3.2.3.2.1" xref="S3.SS2.p1.12.m8.1.1.2.2.3.2.3.2.1.cmml">​</mo><mi id="S3.SS2.p1.12.m8.1.1.2.2.3.2.3.2.3" xref="S3.SS2.p1.12.m8.1.1.2.2.3.2.3.2.3.cmml">j</mi></mrow><mo id="S3.SS2.p1.12.m8.1.1.2.2.3.2.3.1" xref="S3.SS2.p1.12.m8.1.1.2.2.3.2.3.1.cmml">=</mo><mi id="S3.SS2.p1.12.m8.1.1.2.2.3.2.3.3" xref="S3.SS2.p1.12.m8.1.1.2.2.3.2.3.3.cmml">k</mi></mrow></msub></mrow></mfrac><mo id="S3.SS2.p1.12.m8.1.1.2.1" xref="S3.SS2.p1.12.m8.1.1.2.1.cmml">/</mo><mfrac id="S3.SS2.p1.12.m8.1.1.2.3" xref="S3.SS2.p1.12.m8.1.1.2.3.cmml"><mrow id="S3.SS2.p1.12.m8.1.1.2.3.2" xref="S3.SS2.p1.12.m8.1.1.2.3.2.cmml"><mo rspace="0em" id="S3.SS2.p1.12.m8.1.1.2.3.2.1" xref="S3.SS2.p1.12.m8.1.1.2.3.2.1.cmml">∂</mo><mi id="S3.SS2.p1.12.m8.1.1.2.3.2.2" xref="S3.SS2.p1.12.m8.1.1.2.3.2.2.cmml">l</mi></mrow><mrow id="S3.SS2.p1.12.m8.1.1.2.3.3" xref="S3.SS2.p1.12.m8.1.1.2.3.3.cmml"><mo rspace="0em" id="S3.SS2.p1.12.m8.1.1.2.3.3.1" xref="S3.SS2.p1.12.m8.1.1.2.3.3.1.cmml">∂</mo><msub id="S3.SS2.p1.12.m8.1.1.2.3.3.2" xref="S3.SS2.p1.12.m8.1.1.2.3.3.2.cmml"><mi id="S3.SS2.p1.12.m8.1.1.2.3.3.2.2" xref="S3.SS2.p1.12.m8.1.1.2.3.3.2.2.cmml">b</mi><mrow id="S3.SS2.p1.12.m8.1.1.2.3.3.2.3" xref="S3.SS2.p1.12.m8.1.1.2.3.3.2.3.cmml"><mi id="S3.SS2.p1.12.m8.1.1.2.3.3.2.3.2" xref="S3.SS2.p1.12.m8.1.1.2.3.3.2.3.2.cmml">j</mi><mo id="S3.SS2.p1.12.m8.1.1.2.3.3.2.3.1" xref="S3.SS2.p1.12.m8.1.1.2.3.3.2.3.1.cmml">=</mo><mi id="S3.SS2.p1.12.m8.1.1.2.3.3.2.3.3" xref="S3.SS2.p1.12.m8.1.1.2.3.3.2.3.3.cmml">k</mi></mrow></msub></mrow></mfrac></mrow><mo id="S3.SS2.p1.12.m8.1.1.1" xref="S3.SS2.p1.12.m8.1.1.1.cmml">=</mo><msub id="S3.SS2.p1.12.m8.1.1.3" xref="S3.SS2.p1.12.m8.1.1.3.cmml"><mi id="S3.SS2.p1.12.m8.1.1.3.2" xref="S3.SS2.p1.12.m8.1.1.3.2.cmml">x</mi><mi id="S3.SS2.p1.12.m8.1.1.3.3" xref="S3.SS2.p1.12.m8.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m8.1b"><apply id="S3.SS2.p1.12.m8.1.1.cmml" xref="S3.SS2.p1.12.m8.1.1"><eq id="S3.SS2.p1.12.m8.1.1.1.cmml" xref="S3.SS2.p1.12.m8.1.1.1"></eq><apply id="S3.SS2.p1.12.m8.1.1.2.cmml" xref="S3.SS2.p1.12.m8.1.1.2"><divide id="S3.SS2.p1.12.m8.1.1.2.1.cmml" xref="S3.SS2.p1.12.m8.1.1.2.1"></divide><apply id="S3.SS2.p1.12.m8.1.1.2.2.cmml" xref="S3.SS2.p1.12.m8.1.1.2.2"><divide id="S3.SS2.p1.12.m8.1.1.2.2.1.cmml" xref="S3.SS2.p1.12.m8.1.1.2.2"></divide><apply id="S3.SS2.p1.12.m8.1.1.2.2.2.cmml" xref="S3.SS2.p1.12.m8.1.1.2.2.2"><partialdiff id="S3.SS2.p1.12.m8.1.1.2.2.2.1.cmml" xref="S3.SS2.p1.12.m8.1.1.2.2.2.1"></partialdiff><ci id="S3.SS2.p1.12.m8.1.1.2.2.2.2.cmml" xref="S3.SS2.p1.12.m8.1.1.2.2.2.2">𝑙</ci></apply><apply id="S3.SS2.p1.12.m8.1.1.2.2.3.cmml" xref="S3.SS2.p1.12.m8.1.1.2.2.3"><partialdiff id="S3.SS2.p1.12.m8.1.1.2.2.3.1.cmml" xref="S3.SS2.p1.12.m8.1.1.2.2.3.1"></partialdiff><apply id="S3.SS2.p1.12.m8.1.1.2.2.3.2.cmml" xref="S3.SS2.p1.12.m8.1.1.2.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.12.m8.1.1.2.2.3.2.1.cmml" xref="S3.SS2.p1.12.m8.1.1.2.2.3.2">subscript</csymbol><ci id="S3.SS2.p1.12.m8.1.1.2.2.3.2.2.cmml" xref="S3.SS2.p1.12.m8.1.1.2.2.3.2.2">𝑤</ci><apply id="S3.SS2.p1.12.m8.1.1.2.2.3.2.3.cmml" xref="S3.SS2.p1.12.m8.1.1.2.2.3.2.3"><eq id="S3.SS2.p1.12.m8.1.1.2.2.3.2.3.1.cmml" xref="S3.SS2.p1.12.m8.1.1.2.2.3.2.3.1"></eq><apply id="S3.SS2.p1.12.m8.1.1.2.2.3.2.3.2.cmml" xref="S3.SS2.p1.12.m8.1.1.2.2.3.2.3.2"><times id="S3.SS2.p1.12.m8.1.1.2.2.3.2.3.2.1.cmml" xref="S3.SS2.p1.12.m8.1.1.2.2.3.2.3.2.1"></times><ci id="S3.SS2.p1.12.m8.1.1.2.2.3.2.3.2.2.cmml" xref="S3.SS2.p1.12.m8.1.1.2.2.3.2.3.2.2">𝑖</ci><ci id="S3.SS2.p1.12.m8.1.1.2.2.3.2.3.2.3.cmml" xref="S3.SS2.p1.12.m8.1.1.2.2.3.2.3.2.3">𝑗</ci></apply><ci id="S3.SS2.p1.12.m8.1.1.2.2.3.2.3.3.cmml" xref="S3.SS2.p1.12.m8.1.1.2.2.3.2.3.3">𝑘</ci></apply></apply></apply></apply><apply id="S3.SS2.p1.12.m8.1.1.2.3.cmml" xref="S3.SS2.p1.12.m8.1.1.2.3"><divide id="S3.SS2.p1.12.m8.1.1.2.3.1.cmml" xref="S3.SS2.p1.12.m8.1.1.2.3"></divide><apply id="S3.SS2.p1.12.m8.1.1.2.3.2.cmml" xref="S3.SS2.p1.12.m8.1.1.2.3.2"><partialdiff id="S3.SS2.p1.12.m8.1.1.2.3.2.1.cmml" xref="S3.SS2.p1.12.m8.1.1.2.3.2.1"></partialdiff><ci id="S3.SS2.p1.12.m8.1.1.2.3.2.2.cmml" xref="S3.SS2.p1.12.m8.1.1.2.3.2.2">𝑙</ci></apply><apply id="S3.SS2.p1.12.m8.1.1.2.3.3.cmml" xref="S3.SS2.p1.12.m8.1.1.2.3.3"><partialdiff id="S3.SS2.p1.12.m8.1.1.2.3.3.1.cmml" xref="S3.SS2.p1.12.m8.1.1.2.3.3.1"></partialdiff><apply id="S3.SS2.p1.12.m8.1.1.2.3.3.2.cmml" xref="S3.SS2.p1.12.m8.1.1.2.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.12.m8.1.1.2.3.3.2.1.cmml" xref="S3.SS2.p1.12.m8.1.1.2.3.3.2">subscript</csymbol><ci id="S3.SS2.p1.12.m8.1.1.2.3.3.2.2.cmml" xref="S3.SS2.p1.12.m8.1.1.2.3.3.2.2">𝑏</ci><apply id="S3.SS2.p1.12.m8.1.1.2.3.3.2.3.cmml" xref="S3.SS2.p1.12.m8.1.1.2.3.3.2.3"><eq id="S3.SS2.p1.12.m8.1.1.2.3.3.2.3.1.cmml" xref="S3.SS2.p1.12.m8.1.1.2.3.3.2.3.1"></eq><ci id="S3.SS2.p1.12.m8.1.1.2.3.3.2.3.2.cmml" xref="S3.SS2.p1.12.m8.1.1.2.3.3.2.3.2">𝑗</ci><ci id="S3.SS2.p1.12.m8.1.1.2.3.3.2.3.3.cmml" xref="S3.SS2.p1.12.m8.1.1.2.3.3.2.3.3">𝑘</ci></apply></apply></apply></apply></apply><apply id="S3.SS2.p1.12.m8.1.1.3.cmml" xref="S3.SS2.p1.12.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.12.m8.1.1.3.1.cmml" xref="S3.SS2.p1.12.m8.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.12.m8.1.1.3.2.cmml" xref="S3.SS2.p1.12.m8.1.1.3.2">𝑥</ci><ci id="S3.SS2.p1.12.m8.1.1.3.3.cmml" xref="S3.SS2.p1.12.m8.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m8.1c">\frac{\partial{l}}{\partial w_{ij=k}}/\frac{\partial{l}}{\partial b_{j=k}}=x_{i}</annotation></semantics></math>.
Although this shows the vulnerability of a linear layers in an FL model, when the mini-batch size is larger than one, the client would only share the averaged information:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.5" class="ltx_Math" alttext="\frac{\partial{l^{B}}}{\partial w_{i,j=k}^{B}}=\frac{1}{B}\sum_{m\in[1,B]}{(p^{m}_{j}-y^{m}_{j})x_{i}^{m}}" display="block"><semantics id="S3.E6.m1.5a"><mrow id="S3.E6.m1.5.5" xref="S3.E6.m1.5.5.cmml"><mfrac id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml"><mrow id="S3.E6.m1.2.2.4" xref="S3.E6.m1.2.2.4.cmml"><mo rspace="0em" id="S3.E6.m1.2.2.4.1" xref="S3.E6.m1.2.2.4.1.cmml">∂</mo><msup id="S3.E6.m1.2.2.4.2" xref="S3.E6.m1.2.2.4.2.cmml"><mi id="S3.E6.m1.2.2.4.2.2" xref="S3.E6.m1.2.2.4.2.2.cmml">l</mi><mi id="S3.E6.m1.2.2.4.2.3" xref="S3.E6.m1.2.2.4.2.3.cmml">B</mi></msup></mrow><mrow id="S3.E6.m1.2.2.2" xref="S3.E6.m1.2.2.2.cmml"><mo rspace="0em" id="S3.E6.m1.2.2.2.3" xref="S3.E6.m1.2.2.2.3.cmml">∂</mo><msubsup id="S3.E6.m1.2.2.2.4" xref="S3.E6.m1.2.2.2.4.cmml"><mi id="S3.E6.m1.2.2.2.4.2.2" xref="S3.E6.m1.2.2.2.4.2.2.cmml">w</mi><mrow id="S3.E6.m1.2.2.2.2.2" xref="S3.E6.m1.2.2.2.2.2.cmml"><mrow id="S3.E6.m1.2.2.2.2.2.4.2" xref="S3.E6.m1.2.2.2.2.2.4.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml">i</mi><mo id="S3.E6.m1.2.2.2.2.2.4.2.1" xref="S3.E6.m1.2.2.2.2.2.4.1.cmml">,</mo><mi id="S3.E6.m1.2.2.2.2.2.2" xref="S3.E6.m1.2.2.2.2.2.2.cmml">j</mi></mrow><mo id="S3.E6.m1.2.2.2.2.2.3" xref="S3.E6.m1.2.2.2.2.2.3.cmml">=</mo><mi id="S3.E6.m1.2.2.2.2.2.5" xref="S3.E6.m1.2.2.2.2.2.5.cmml">k</mi></mrow><mi id="S3.E6.m1.2.2.2.4.3" xref="S3.E6.m1.2.2.2.4.3.cmml">B</mi></msubsup></mrow></mfrac><mo id="S3.E6.m1.5.5.2" xref="S3.E6.m1.5.5.2.cmml">=</mo><mrow id="S3.E6.m1.5.5.1" xref="S3.E6.m1.5.5.1.cmml"><mfrac id="S3.E6.m1.5.5.1.3" xref="S3.E6.m1.5.5.1.3.cmml"><mn id="S3.E6.m1.5.5.1.3.2" xref="S3.E6.m1.5.5.1.3.2.cmml">1</mn><mi id="S3.E6.m1.5.5.1.3.3" xref="S3.E6.m1.5.5.1.3.3.cmml">B</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.2" xref="S3.E6.m1.5.5.1.2.cmml">​</mo><mrow id="S3.E6.m1.5.5.1.1" xref="S3.E6.m1.5.5.1.1.cmml"><munder id="S3.E6.m1.5.5.1.1.2" xref="S3.E6.m1.5.5.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E6.m1.5.5.1.1.2.2" xref="S3.E6.m1.5.5.1.1.2.2.cmml">∑</mo><mrow id="S3.E6.m1.4.4.2" xref="S3.E6.m1.4.4.2.cmml"><mi id="S3.E6.m1.4.4.2.4" xref="S3.E6.m1.4.4.2.4.cmml">m</mi><mo id="S3.E6.m1.4.4.2.3" xref="S3.E6.m1.4.4.2.3.cmml">∈</mo><mrow id="S3.E6.m1.4.4.2.5.2" xref="S3.E6.m1.4.4.2.5.1.cmml"><mo stretchy="false" id="S3.E6.m1.4.4.2.5.2.1" xref="S3.E6.m1.4.4.2.5.1.cmml">[</mo><mn id="S3.E6.m1.3.3.1.1" xref="S3.E6.m1.3.3.1.1.cmml">1</mn><mo id="S3.E6.m1.4.4.2.5.2.2" xref="S3.E6.m1.4.4.2.5.1.cmml">,</mo><mi id="S3.E6.m1.4.4.2.2" xref="S3.E6.m1.4.4.2.2.cmml">B</mi><mo stretchy="false" id="S3.E6.m1.4.4.2.5.2.3" xref="S3.E6.m1.4.4.2.5.1.cmml">]</mo></mrow></mrow></munder><mrow id="S3.E6.m1.5.5.1.1.1" xref="S3.E6.m1.5.5.1.1.1.cmml"><mrow id="S3.E6.m1.5.5.1.1.1.1.1" xref="S3.E6.m1.5.5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.5.5.1.1.1.1.1.2" xref="S3.E6.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.5.5.1.1.1.1.1.1" xref="S3.E6.m1.5.5.1.1.1.1.1.1.cmml"><msubsup id="S3.E6.m1.5.5.1.1.1.1.1.1.2" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.5.5.1.1.1.1.1.1.2.2.2" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2.2.2.cmml">p</mi><mi id="S3.E6.m1.5.5.1.1.1.1.1.1.2.3" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2.3.cmml">j</mi><mi id="S3.E6.m1.5.5.1.1.1.1.1.1.2.2.3" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2.2.3.cmml">m</mi></msubsup><mo id="S3.E6.m1.5.5.1.1.1.1.1.1.1" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S3.E6.m1.5.5.1.1.1.1.1.1.3" xref="S3.E6.m1.5.5.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.5.5.1.1.1.1.1.1.3.2.2" xref="S3.E6.m1.5.5.1.1.1.1.1.1.3.2.2.cmml">y</mi><mi id="S3.E6.m1.5.5.1.1.1.1.1.1.3.3" xref="S3.E6.m1.5.5.1.1.1.1.1.1.3.3.cmml">j</mi><mi id="S3.E6.m1.5.5.1.1.1.1.1.1.3.2.3" xref="S3.E6.m1.5.5.1.1.1.1.1.1.3.2.3.cmml">m</mi></msubsup></mrow><mo stretchy="false" id="S3.E6.m1.5.5.1.1.1.1.1.3" xref="S3.E6.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.1.1.2" xref="S3.E6.m1.5.5.1.1.1.2.cmml">​</mo><msubsup id="S3.E6.m1.5.5.1.1.1.3" xref="S3.E6.m1.5.5.1.1.1.3.cmml"><mi id="S3.E6.m1.5.5.1.1.1.3.2.2" xref="S3.E6.m1.5.5.1.1.1.3.2.2.cmml">x</mi><mi id="S3.E6.m1.5.5.1.1.1.3.2.3" xref="S3.E6.m1.5.5.1.1.1.3.2.3.cmml">i</mi><mi id="S3.E6.m1.5.5.1.1.1.3.3" xref="S3.E6.m1.5.5.1.1.1.3.3.cmml">m</mi></msubsup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.5b"><apply id="S3.E6.m1.5.5.cmml" xref="S3.E6.m1.5.5"><eq id="S3.E6.m1.5.5.2.cmml" xref="S3.E6.m1.5.5.2"></eq><apply id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2"><divide id="S3.E6.m1.2.2.3.cmml" xref="S3.E6.m1.2.2"></divide><apply id="S3.E6.m1.2.2.4.cmml" xref="S3.E6.m1.2.2.4"><partialdiff id="S3.E6.m1.2.2.4.1.cmml" xref="S3.E6.m1.2.2.4.1"></partialdiff><apply id="S3.E6.m1.2.2.4.2.cmml" xref="S3.E6.m1.2.2.4.2"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.4.2.1.cmml" xref="S3.E6.m1.2.2.4.2">superscript</csymbol><ci id="S3.E6.m1.2.2.4.2.2.cmml" xref="S3.E6.m1.2.2.4.2.2">𝑙</ci><ci id="S3.E6.m1.2.2.4.2.3.cmml" xref="S3.E6.m1.2.2.4.2.3">𝐵</ci></apply></apply><apply id="S3.E6.m1.2.2.2.cmml" xref="S3.E6.m1.2.2.2"><partialdiff id="S3.E6.m1.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.3"></partialdiff><apply id="S3.E6.m1.2.2.2.4.cmml" xref="S3.E6.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.4.1.cmml" xref="S3.E6.m1.2.2.2.4">superscript</csymbol><apply id="S3.E6.m1.2.2.2.4.2.cmml" xref="S3.E6.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.4.2.1.cmml" xref="S3.E6.m1.2.2.2.4">subscript</csymbol><ci id="S3.E6.m1.2.2.2.4.2.2.cmml" xref="S3.E6.m1.2.2.2.4.2.2">𝑤</ci><apply id="S3.E6.m1.2.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2.2"><eq id="S3.E6.m1.2.2.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.2.2.3"></eq><list id="S3.E6.m1.2.2.2.2.2.4.1.cmml" xref="S3.E6.m1.2.2.2.2.2.4.2"><ci id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1">𝑖</ci><ci id="S3.E6.m1.2.2.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2.2.2">𝑗</ci></list><ci id="S3.E6.m1.2.2.2.2.2.5.cmml" xref="S3.E6.m1.2.2.2.2.2.5">𝑘</ci></apply></apply><ci id="S3.E6.m1.2.2.2.4.3.cmml" xref="S3.E6.m1.2.2.2.4.3">𝐵</ci></apply></apply></apply><apply id="S3.E6.m1.5.5.1.cmml" xref="S3.E6.m1.5.5.1"><times id="S3.E6.m1.5.5.1.2.cmml" xref="S3.E6.m1.5.5.1.2"></times><apply id="S3.E6.m1.5.5.1.3.cmml" xref="S3.E6.m1.5.5.1.3"><divide id="S3.E6.m1.5.5.1.3.1.cmml" xref="S3.E6.m1.5.5.1.3"></divide><cn type="integer" id="S3.E6.m1.5.5.1.3.2.cmml" xref="S3.E6.m1.5.5.1.3.2">1</cn><ci id="S3.E6.m1.5.5.1.3.3.cmml" xref="S3.E6.m1.5.5.1.3.3">𝐵</ci></apply><apply id="S3.E6.m1.5.5.1.1.cmml" xref="S3.E6.m1.5.5.1.1"><apply id="S3.E6.m1.5.5.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.2.1.cmml" xref="S3.E6.m1.5.5.1.1.2">subscript</csymbol><sum id="S3.E6.m1.5.5.1.1.2.2.cmml" xref="S3.E6.m1.5.5.1.1.2.2"></sum><apply id="S3.E6.m1.4.4.2.cmml" xref="S3.E6.m1.4.4.2"><in id="S3.E6.m1.4.4.2.3.cmml" xref="S3.E6.m1.4.4.2.3"></in><ci id="S3.E6.m1.4.4.2.4.cmml" xref="S3.E6.m1.4.4.2.4">𝑚</ci><interval closure="closed" id="S3.E6.m1.4.4.2.5.1.cmml" xref="S3.E6.m1.4.4.2.5.2"><cn type="integer" id="S3.E6.m1.3.3.1.1.cmml" xref="S3.E6.m1.3.3.1.1">1</cn><ci id="S3.E6.m1.4.4.2.2.cmml" xref="S3.E6.m1.4.4.2.2">𝐵</ci></interval></apply></apply><apply id="S3.E6.m1.5.5.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1"><times id="S3.E6.m1.5.5.1.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.1.2"></times><apply id="S3.E6.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1"><minus id="S3.E6.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1"></minus><apply id="S3.E6.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E6.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E6.m1.5.5.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2.2.2">𝑝</ci><ci id="S3.E6.m1.5.5.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2.2.3">𝑚</ci></apply><ci id="S3.E6.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="S3.E6.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E6.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E6.m1.5.5.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.3.2.2">𝑦</ci><ci id="S3.E6.m1.5.5.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.3.2.3">𝑚</ci></apply><ci id="S3.E6.m1.5.5.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply><apply id="S3.E6.m1.5.5.1.1.1.3.cmml" xref="S3.E6.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.1.3.1.cmml" xref="S3.E6.m1.5.5.1.1.1.3">superscript</csymbol><apply id="S3.E6.m1.5.5.1.1.1.3.2.cmml" xref="S3.E6.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.1.3.2.1.cmml" xref="S3.E6.m1.5.5.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.5.5.1.1.1.3.2.2.cmml" xref="S3.E6.m1.5.5.1.1.1.3.2.2">𝑥</ci><ci id="S3.E6.m1.5.5.1.1.1.3.2.3.cmml" xref="S3.E6.m1.5.5.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E6.m1.5.5.1.1.1.3.3.cmml" xref="S3.E6.m1.5.5.1.1.1.3.3">𝑚</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.5c">\frac{\partial{l^{B}}}{\partial w_{i,j=k}^{B}}=\frac{1}{B}\sum_{m\in[1,B]}{(p^{m}_{j}-y^{m}_{j})x_{i}^{m}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.2" class="ltx_Math" alttext="\frac{\partial{l^{B}}}{\partial b^{B}_{j=k}}=\frac{1}{B}\sum_{m\in[1,B]}{p^{m}_{j}-y^{m}_{j}}" display="block"><semantics id="S3.E7.m1.2a"><mrow id="S3.E7.m1.2.3" xref="S3.E7.m1.2.3.cmml"><mfrac id="S3.E7.m1.2.3.2" xref="S3.E7.m1.2.3.2.cmml"><mrow id="S3.E7.m1.2.3.2.2" xref="S3.E7.m1.2.3.2.2.cmml"><mo rspace="0em" id="S3.E7.m1.2.3.2.2.1" xref="S3.E7.m1.2.3.2.2.1.cmml">∂</mo><msup id="S3.E7.m1.2.3.2.2.2" xref="S3.E7.m1.2.3.2.2.2.cmml"><mi id="S3.E7.m1.2.3.2.2.2.2" xref="S3.E7.m1.2.3.2.2.2.2.cmml">l</mi><mi id="S3.E7.m1.2.3.2.2.2.3" xref="S3.E7.m1.2.3.2.2.2.3.cmml">B</mi></msup></mrow><mrow id="S3.E7.m1.2.3.2.3" xref="S3.E7.m1.2.3.2.3.cmml"><mo rspace="0em" id="S3.E7.m1.2.3.2.3.1" xref="S3.E7.m1.2.3.2.3.1.cmml">∂</mo><msubsup id="S3.E7.m1.2.3.2.3.2" xref="S3.E7.m1.2.3.2.3.2.cmml"><mi id="S3.E7.m1.2.3.2.3.2.2.2" xref="S3.E7.m1.2.3.2.3.2.2.2.cmml">b</mi><mrow id="S3.E7.m1.2.3.2.3.2.3" xref="S3.E7.m1.2.3.2.3.2.3.cmml"><mi id="S3.E7.m1.2.3.2.3.2.3.2" xref="S3.E7.m1.2.3.2.3.2.3.2.cmml">j</mi><mo id="S3.E7.m1.2.3.2.3.2.3.1" xref="S3.E7.m1.2.3.2.3.2.3.1.cmml">=</mo><mi id="S3.E7.m1.2.3.2.3.2.3.3" xref="S3.E7.m1.2.3.2.3.2.3.3.cmml">k</mi></mrow><mi id="S3.E7.m1.2.3.2.3.2.2.3" xref="S3.E7.m1.2.3.2.3.2.2.3.cmml">B</mi></msubsup></mrow></mfrac><mo id="S3.E7.m1.2.3.1" xref="S3.E7.m1.2.3.1.cmml">=</mo><mrow id="S3.E7.m1.2.3.3" xref="S3.E7.m1.2.3.3.cmml"><mrow id="S3.E7.m1.2.3.3.2" xref="S3.E7.m1.2.3.3.2.cmml"><mfrac id="S3.E7.m1.2.3.3.2.2" xref="S3.E7.m1.2.3.3.2.2.cmml"><mn id="S3.E7.m1.2.3.3.2.2.2" xref="S3.E7.m1.2.3.3.2.2.2.cmml">1</mn><mi id="S3.E7.m1.2.3.3.2.2.3" xref="S3.E7.m1.2.3.3.2.2.3.cmml">B</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E7.m1.2.3.3.2.1" xref="S3.E7.m1.2.3.3.2.1.cmml">​</mo><mrow id="S3.E7.m1.2.3.3.2.3" xref="S3.E7.m1.2.3.3.2.3.cmml"><munder id="S3.E7.m1.2.3.3.2.3.1" xref="S3.E7.m1.2.3.3.2.3.1.cmml"><mo movablelimits="false" id="S3.E7.m1.2.3.3.2.3.1.2" xref="S3.E7.m1.2.3.3.2.3.1.2.cmml">∑</mo><mrow id="S3.E7.m1.2.2.2" xref="S3.E7.m1.2.2.2.cmml"><mi id="S3.E7.m1.2.2.2.4" xref="S3.E7.m1.2.2.2.4.cmml">m</mi><mo id="S3.E7.m1.2.2.2.3" xref="S3.E7.m1.2.2.2.3.cmml">∈</mo><mrow id="S3.E7.m1.2.2.2.5.2" xref="S3.E7.m1.2.2.2.5.1.cmml"><mo stretchy="false" id="S3.E7.m1.2.2.2.5.2.1" xref="S3.E7.m1.2.2.2.5.1.cmml">[</mo><mn id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml">1</mn><mo id="S3.E7.m1.2.2.2.5.2.2" xref="S3.E7.m1.2.2.2.5.1.cmml">,</mo><mi id="S3.E7.m1.2.2.2.2" xref="S3.E7.m1.2.2.2.2.cmml">B</mi><mo stretchy="false" id="S3.E7.m1.2.2.2.5.2.3" xref="S3.E7.m1.2.2.2.5.1.cmml">]</mo></mrow></mrow></munder><msubsup id="S3.E7.m1.2.3.3.2.3.2" xref="S3.E7.m1.2.3.3.2.3.2.cmml"><mi id="S3.E7.m1.2.3.3.2.3.2.2.2" xref="S3.E7.m1.2.3.3.2.3.2.2.2.cmml">p</mi><mi id="S3.E7.m1.2.3.3.2.3.2.3" xref="S3.E7.m1.2.3.3.2.3.2.3.cmml">j</mi><mi id="S3.E7.m1.2.3.3.2.3.2.2.3" xref="S3.E7.m1.2.3.3.2.3.2.2.3.cmml">m</mi></msubsup></mrow></mrow><mo id="S3.E7.m1.2.3.3.1" xref="S3.E7.m1.2.3.3.1.cmml">−</mo><msubsup id="S3.E7.m1.2.3.3.3" xref="S3.E7.m1.2.3.3.3.cmml"><mi id="S3.E7.m1.2.3.3.3.2.2" xref="S3.E7.m1.2.3.3.3.2.2.cmml">y</mi><mi id="S3.E7.m1.2.3.3.3.3" xref="S3.E7.m1.2.3.3.3.3.cmml">j</mi><mi id="S3.E7.m1.2.3.3.3.2.3" xref="S3.E7.m1.2.3.3.3.2.3.cmml">m</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.2b"><apply id="S3.E7.m1.2.3.cmml" xref="S3.E7.m1.2.3"><eq id="S3.E7.m1.2.3.1.cmml" xref="S3.E7.m1.2.3.1"></eq><apply id="S3.E7.m1.2.3.2.cmml" xref="S3.E7.m1.2.3.2"><divide id="S3.E7.m1.2.3.2.1.cmml" xref="S3.E7.m1.2.3.2"></divide><apply id="S3.E7.m1.2.3.2.2.cmml" xref="S3.E7.m1.2.3.2.2"><partialdiff id="S3.E7.m1.2.3.2.2.1.cmml" xref="S3.E7.m1.2.3.2.2.1"></partialdiff><apply id="S3.E7.m1.2.3.2.2.2.cmml" xref="S3.E7.m1.2.3.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.3.2.2.2.1.cmml" xref="S3.E7.m1.2.3.2.2.2">superscript</csymbol><ci id="S3.E7.m1.2.3.2.2.2.2.cmml" xref="S3.E7.m1.2.3.2.2.2.2">𝑙</ci><ci id="S3.E7.m1.2.3.2.2.2.3.cmml" xref="S3.E7.m1.2.3.2.2.2.3">𝐵</ci></apply></apply><apply id="S3.E7.m1.2.3.2.3.cmml" xref="S3.E7.m1.2.3.2.3"><partialdiff id="S3.E7.m1.2.3.2.3.1.cmml" xref="S3.E7.m1.2.3.2.3.1"></partialdiff><apply id="S3.E7.m1.2.3.2.3.2.cmml" xref="S3.E7.m1.2.3.2.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.3.2.3.2.1.cmml" xref="S3.E7.m1.2.3.2.3.2">subscript</csymbol><apply id="S3.E7.m1.2.3.2.3.2.2.cmml" xref="S3.E7.m1.2.3.2.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.3.2.3.2.2.1.cmml" xref="S3.E7.m1.2.3.2.3.2">superscript</csymbol><ci id="S3.E7.m1.2.3.2.3.2.2.2.cmml" xref="S3.E7.m1.2.3.2.3.2.2.2">𝑏</ci><ci id="S3.E7.m1.2.3.2.3.2.2.3.cmml" xref="S3.E7.m1.2.3.2.3.2.2.3">𝐵</ci></apply><apply id="S3.E7.m1.2.3.2.3.2.3.cmml" xref="S3.E7.m1.2.3.2.3.2.3"><eq id="S3.E7.m1.2.3.2.3.2.3.1.cmml" xref="S3.E7.m1.2.3.2.3.2.3.1"></eq><ci id="S3.E7.m1.2.3.2.3.2.3.2.cmml" xref="S3.E7.m1.2.3.2.3.2.3.2">𝑗</ci><ci id="S3.E7.m1.2.3.2.3.2.3.3.cmml" xref="S3.E7.m1.2.3.2.3.2.3.3">𝑘</ci></apply></apply></apply></apply><apply id="S3.E7.m1.2.3.3.cmml" xref="S3.E7.m1.2.3.3"><minus id="S3.E7.m1.2.3.3.1.cmml" xref="S3.E7.m1.2.3.3.1"></minus><apply id="S3.E7.m1.2.3.3.2.cmml" xref="S3.E7.m1.2.3.3.2"><times id="S3.E7.m1.2.3.3.2.1.cmml" xref="S3.E7.m1.2.3.3.2.1"></times><apply id="S3.E7.m1.2.3.3.2.2.cmml" xref="S3.E7.m1.2.3.3.2.2"><divide id="S3.E7.m1.2.3.3.2.2.1.cmml" xref="S3.E7.m1.2.3.3.2.2"></divide><cn type="integer" id="S3.E7.m1.2.3.3.2.2.2.cmml" xref="S3.E7.m1.2.3.3.2.2.2">1</cn><ci id="S3.E7.m1.2.3.3.2.2.3.cmml" xref="S3.E7.m1.2.3.3.2.2.3">𝐵</ci></apply><apply id="S3.E7.m1.2.3.3.2.3.cmml" xref="S3.E7.m1.2.3.3.2.3"><apply id="S3.E7.m1.2.3.3.2.3.1.cmml" xref="S3.E7.m1.2.3.3.2.3.1"><csymbol cd="ambiguous" id="S3.E7.m1.2.3.3.2.3.1.1.cmml" xref="S3.E7.m1.2.3.3.2.3.1">subscript</csymbol><sum id="S3.E7.m1.2.3.3.2.3.1.2.cmml" xref="S3.E7.m1.2.3.3.2.3.1.2"></sum><apply id="S3.E7.m1.2.2.2.cmml" xref="S3.E7.m1.2.2.2"><in id="S3.E7.m1.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.3"></in><ci id="S3.E7.m1.2.2.2.4.cmml" xref="S3.E7.m1.2.2.2.4">𝑚</ci><interval closure="closed" id="S3.E7.m1.2.2.2.5.1.cmml" xref="S3.E7.m1.2.2.2.5.2"><cn type="integer" id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1">1</cn><ci id="S3.E7.m1.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2">𝐵</ci></interval></apply></apply><apply id="S3.E7.m1.2.3.3.2.3.2.cmml" xref="S3.E7.m1.2.3.3.2.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.3.3.2.3.2.1.cmml" xref="S3.E7.m1.2.3.3.2.3.2">subscript</csymbol><apply id="S3.E7.m1.2.3.3.2.3.2.2.cmml" xref="S3.E7.m1.2.3.3.2.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.3.3.2.3.2.2.1.cmml" xref="S3.E7.m1.2.3.3.2.3.2">superscript</csymbol><ci id="S3.E7.m1.2.3.3.2.3.2.2.2.cmml" xref="S3.E7.m1.2.3.3.2.3.2.2.2">𝑝</ci><ci id="S3.E7.m1.2.3.3.2.3.2.2.3.cmml" xref="S3.E7.m1.2.3.3.2.3.2.2.3">𝑚</ci></apply><ci id="S3.E7.m1.2.3.3.2.3.2.3.cmml" xref="S3.E7.m1.2.3.3.2.3.2.3">𝑗</ci></apply></apply></apply><apply id="S3.E7.m1.2.3.3.3.cmml" xref="S3.E7.m1.2.3.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.3.3.3.1.cmml" xref="S3.E7.m1.2.3.3.3">subscript</csymbol><apply id="S3.E7.m1.2.3.3.3.2.cmml" xref="S3.E7.m1.2.3.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.3.3.3.2.1.cmml" xref="S3.E7.m1.2.3.3.3">superscript</csymbol><ci id="S3.E7.m1.2.3.3.3.2.2.cmml" xref="S3.E7.m1.2.3.3.3.2.2">𝑦</ci><ci id="S3.E7.m1.2.3.3.3.2.3.cmml" xref="S3.E7.m1.2.3.3.3.2.3">𝑚</ci></apply><ci id="S3.E7.m1.2.3.3.3.3.cmml" xref="S3.E7.m1.2.3.3.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.2c">\frac{\partial{l^{B}}}{\partial b^{B}_{j=k}}=\frac{1}{B}\sum_{m\in[1,B]}{p^{m}_{j}-y^{m}_{j}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.12" class="ltx_p">As no additional equations are shared, the number of unknown, <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="B(n+C)" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><mrow id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">B</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p3.1.m1.1.1.1.1" xref="S3.SS2.p3.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.1.m1.1.1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p3.1.m1.1.1.1.1.1" xref="S3.SS2.p3.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.1.1.1.2.cmml">n</mi><mo id="S3.SS2.p3.1.m1.1.1.1.1.1.1" xref="S3.SS2.p3.1.m1.1.1.1.1.1.1.cmml">+</mo><mi id="S3.SS2.p3.1.m1.1.1.1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.1.1.1.3.cmml">C</mi></mrow><mo stretchy="false" id="S3.SS2.p3.1.m1.1.1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><times id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2"></times><ci id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3">𝐵</ci><apply id="S3.SS2.p3.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1.1.1"><plus id="S3.SS2.p3.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1.1.1.1.1"></plus><ci id="S3.SS2.p3.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.1.1.1.2">𝑛</ci><ci id="S3.SS2.p3.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.1.1.1.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">B(n+C)</annotation></semantics></math> can exceed the gradients equations number <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="nC+C" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><mrow id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mrow id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml"><mi id="S3.SS2.p3.2.m2.1.1.2.2" xref="S3.SS2.p3.2.m2.1.1.2.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.2.m2.1.1.2.1" xref="S3.SS2.p3.2.m2.1.1.2.1.cmml">​</mo><mi id="S3.SS2.p3.2.m2.1.1.2.3" xref="S3.SS2.p3.2.m2.1.1.2.3.cmml">C</mi></mrow><mo id="S3.SS2.p3.2.m2.1.1.1" xref="S3.SS2.p3.2.m2.1.1.1.cmml">+</mo><mi id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><plus id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1.1"></plus><apply id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2"><times id="S3.SS2.p3.2.m2.1.1.2.1.cmml" xref="S3.SS2.p3.2.m2.1.1.2.1"></times><ci id="S3.SS2.p3.2.m2.1.1.2.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2.2">𝑛</ci><ci id="S3.SS2.p3.2.m2.1.1.2.3.cmml" xref="S3.SS2.p3.2.m2.1.1.2.3">𝐶</ci></apply><ci id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">nC+C</annotation></semantics></math>, and there will be no unique solution to solve the set of equations. Even in the case that a unique solution exists, numerical optimisation can be challenging. However, in the scenario in which softmax is followed by cross entropy, we show that an accurate direct solution can be found in many cases even for <math id="S3.SS2.p3.3.m3.1" class="ltx_Math" alttext="B\gg 1" display="inline"><semantics id="S3.SS2.p3.3.m3.1a"><mrow id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml"><mi id="S3.SS2.p3.3.m3.1.1.2" xref="S3.SS2.p3.3.m3.1.1.2.cmml">B</mi><mo id="S3.SS2.p3.3.m3.1.1.1" xref="S3.SS2.p3.3.m3.1.1.1.cmml">≫</mo><mn id="S3.SS2.p3.3.m3.1.1.3" xref="S3.SS2.p3.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1"><csymbol cd="latexml" id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1.1">much-greater-than</csymbol><ci id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2">𝐵</ci><cn type="integer" id="S3.SS2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">B\gg 1</annotation></semantics></math>, due to the de-mixing property across the batch.
In an untrained, randomised weights model, the first order expected value of <math id="S3.SS2.p3.4.m4.1" class="ltx_Math" alttext="\langle p^{m}_{j}-y^{m}_{j}\rangle" display="inline"><semantics id="S3.SS2.p3.4.m4.1a"><mrow id="S3.SS2.p3.4.m4.1.1.1" xref="S3.SS2.p3.4.m4.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p3.4.m4.1.1.1.2" xref="S3.SS2.p3.4.m4.1.1.2.1.cmml">⟨</mo><mrow id="S3.SS2.p3.4.m4.1.1.1.1" xref="S3.SS2.p3.4.m4.1.1.1.1.cmml"><msubsup id="S3.SS2.p3.4.m4.1.1.1.1.2" xref="S3.SS2.p3.4.m4.1.1.1.1.2.cmml"><mi id="S3.SS2.p3.4.m4.1.1.1.1.2.2.2" xref="S3.SS2.p3.4.m4.1.1.1.1.2.2.2.cmml">p</mi><mi id="S3.SS2.p3.4.m4.1.1.1.1.2.3" xref="S3.SS2.p3.4.m4.1.1.1.1.2.3.cmml">j</mi><mi id="S3.SS2.p3.4.m4.1.1.1.1.2.2.3" xref="S3.SS2.p3.4.m4.1.1.1.1.2.2.3.cmml">m</mi></msubsup><mo id="S3.SS2.p3.4.m4.1.1.1.1.1" xref="S3.SS2.p3.4.m4.1.1.1.1.1.cmml">−</mo><msubsup id="S3.SS2.p3.4.m4.1.1.1.1.3" xref="S3.SS2.p3.4.m4.1.1.1.1.3.cmml"><mi id="S3.SS2.p3.4.m4.1.1.1.1.3.2.2" xref="S3.SS2.p3.4.m4.1.1.1.1.3.2.2.cmml">y</mi><mi id="S3.SS2.p3.4.m4.1.1.1.1.3.3" xref="S3.SS2.p3.4.m4.1.1.1.1.3.3.cmml">j</mi><mi id="S3.SS2.p3.4.m4.1.1.1.1.3.2.3" xref="S3.SS2.p3.4.m4.1.1.1.1.3.2.3.cmml">m</mi></msubsup></mrow><mo stretchy="false" id="S3.SS2.p3.4.m4.1.1.1.3" xref="S3.SS2.p3.4.m4.1.1.2.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.1"><csymbol cd="latexml" id="S3.SS2.p3.4.m4.1.1.2.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S3.SS2.p3.4.m4.1.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1"><minus id="S3.SS2.p3.4.m4.1.1.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.1"></minus><apply id="S3.SS2.p3.4.m4.1.1.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.1.2.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.2">subscript</csymbol><apply id="S3.SS2.p3.4.m4.1.1.1.1.2.2.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.1.2.2.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.2">superscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.1.1.2.2.2.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.2.2.2">𝑝</ci><ci id="S3.SS2.p3.4.m4.1.1.1.1.2.2.3.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.2.2.3">𝑚</ci></apply><ci id="S3.SS2.p3.4.m4.1.1.1.1.2.3.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.2.3">𝑗</ci></apply><apply id="S3.SS2.p3.4.m4.1.1.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.1.3.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.3">subscript</csymbol><apply id="S3.SS2.p3.4.m4.1.1.1.1.3.2.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.1.3.2.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.3">superscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.1.1.3.2.2.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.3.2.2">𝑦</ci><ci id="S3.SS2.p3.4.m4.1.1.1.1.3.2.3.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.3.2.3">𝑚</ci></apply><ci id="S3.SS2.p3.4.m4.1.1.1.1.3.3.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">\langle p^{m}_{j}-y^{m}_{j}\rangle</annotation></semantics></math>, is positive but close to zero for a non-target instance (<math id="S3.SS2.p3.5.m5.1" class="ltx_Math" alttext="j\neq c" display="inline"><semantics id="S3.SS2.p3.5.m5.1a"><mrow id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml"><mi id="S3.SS2.p3.5.m5.1.1.2" xref="S3.SS2.p3.5.m5.1.1.2.cmml">j</mi><mo id="S3.SS2.p3.5.m5.1.1.1" xref="S3.SS2.p3.5.m5.1.1.1.cmml">≠</mo><mi id="S3.SS2.p3.5.m5.1.1.3" xref="S3.SS2.p3.5.m5.1.1.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><apply id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1"><neq id="S3.SS2.p3.5.m5.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1.1"></neq><ci id="S3.SS2.p3.5.m5.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1.2">𝑗</ci><ci id="S3.SS2.p3.5.m5.1.1.3.cmml" xref="S3.SS2.p3.5.m5.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">j\neq c</annotation></semantics></math>) and close to <math id="S3.SS2.p3.6.m6.1" class="ltx_Math" alttext="-1" display="inline"><semantics id="S3.SS2.p3.6.m6.1a"><mrow id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml"><mo id="S3.SS2.p3.6.m6.1.1a" xref="S3.SS2.p3.6.m6.1.1.cmml">−</mo><mn id="S3.SS2.p3.6.m6.1.1.2" xref="S3.SS2.p3.6.m6.1.1.2.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><apply id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1"><minus id="S3.SS2.p3.6.m6.1.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1"></minus><cn type="integer" id="S3.SS2.p3.6.m6.1.1.2.cmml" xref="S3.SS2.p3.6.m6.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">-1</annotation></semantics></math> for the instance target (<math id="S3.SS2.p3.7.m7.1" class="ltx_Math" alttext="j=c" display="inline"><semantics id="S3.SS2.p3.7.m7.1a"><mrow id="S3.SS2.p3.7.m7.1.1" xref="S3.SS2.p3.7.m7.1.1.cmml"><mi id="S3.SS2.p3.7.m7.1.1.2" xref="S3.SS2.p3.7.m7.1.1.2.cmml">j</mi><mo id="S3.SS2.p3.7.m7.1.1.1" xref="S3.SS2.p3.7.m7.1.1.1.cmml">=</mo><mi id="S3.SS2.p3.7.m7.1.1.3" xref="S3.SS2.p3.7.m7.1.1.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m7.1b"><apply id="S3.SS2.p3.7.m7.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1"><eq id="S3.SS2.p3.7.m7.1.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1.1"></eq><ci id="S3.SS2.p3.7.m7.1.1.2.cmml" xref="S3.SS2.p3.7.m7.1.1.2">𝑗</ci><ci id="S3.SS2.p3.7.m7.1.1.3.cmml" xref="S3.SS2.p3.7.m7.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m7.1c">j=c</annotation></semantics></math>). This is due to the fact that expected value, <math id="S3.SS2.p3.8.m8.1" class="ltx_Math" alttext="\langle p_{j}(o_{j})\rangle" display="inline"><semantics id="S3.SS2.p3.8.m8.1a"><mrow id="S3.SS2.p3.8.m8.1.1.1" xref="S3.SS2.p3.8.m8.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p3.8.m8.1.1.1.2" xref="S3.SS2.p3.8.m8.1.1.2.1.cmml">⟨</mo><mrow id="S3.SS2.p3.8.m8.1.1.1.1" xref="S3.SS2.p3.8.m8.1.1.1.1.cmml"><msub id="S3.SS2.p3.8.m8.1.1.1.1.3" xref="S3.SS2.p3.8.m8.1.1.1.1.3.cmml"><mi id="S3.SS2.p3.8.m8.1.1.1.1.3.2" xref="S3.SS2.p3.8.m8.1.1.1.1.3.2.cmml">p</mi><mi id="S3.SS2.p3.8.m8.1.1.1.1.3.3" xref="S3.SS2.p3.8.m8.1.1.1.1.3.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p3.8.m8.1.1.1.1.2" xref="S3.SS2.p3.8.m8.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p3.8.m8.1.1.1.1.1.1" xref="S3.SS2.p3.8.m8.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.8.m8.1.1.1.1.1.1.2" xref="S3.SS2.p3.8.m8.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p3.8.m8.1.1.1.1.1.1.1" xref="S3.SS2.p3.8.m8.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.8.m8.1.1.1.1.1.1.1.2" xref="S3.SS2.p3.8.m8.1.1.1.1.1.1.1.2.cmml">o</mi><mi id="S3.SS2.p3.8.m8.1.1.1.1.1.1.1.3" xref="S3.SS2.p3.8.m8.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS2.p3.8.m8.1.1.1.1.1.1.3" xref="S3.SS2.p3.8.m8.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS2.p3.8.m8.1.1.1.3" xref="S3.SS2.p3.8.m8.1.1.2.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m8.1b"><apply id="S3.SS2.p3.8.m8.1.1.2.cmml" xref="S3.SS2.p3.8.m8.1.1.1"><csymbol cd="latexml" id="S3.SS2.p3.8.m8.1.1.2.1.cmml" xref="S3.SS2.p3.8.m8.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S3.SS2.p3.8.m8.1.1.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1.1.1"><times id="S3.SS2.p3.8.m8.1.1.1.1.2.cmml" xref="S3.SS2.p3.8.m8.1.1.1.1.2"></times><apply id="S3.SS2.p3.8.m8.1.1.1.1.3.cmml" xref="S3.SS2.p3.8.m8.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.8.m8.1.1.1.1.3.1.cmml" xref="S3.SS2.p3.8.m8.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p3.8.m8.1.1.1.1.3.2.cmml" xref="S3.SS2.p3.8.m8.1.1.1.1.3.2">𝑝</ci><ci id="S3.SS2.p3.8.m8.1.1.1.1.3.3.cmml" xref="S3.SS2.p3.8.m8.1.1.1.1.3.3">𝑗</ci></apply><apply id="S3.SS2.p3.8.m8.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.8.m8.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.8.m8.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.8.m8.1.1.1.1.1.1.1.2">𝑜</ci><ci id="S3.SS2.p3.8.m8.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.8.m8.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m8.1c">\langle p_{j}(o_{j})\rangle</annotation></semantics></math> can be grossly estimated as <math id="S3.SS2.p3.9.m9.1" class="ltx_Math" alttext="p_{j}(E(o_{j}))" display="inline"><semantics id="S3.SS2.p3.9.m9.1a"><mrow id="S3.SS2.p3.9.m9.1.1" xref="S3.SS2.p3.9.m9.1.1.cmml"><msub id="S3.SS2.p3.9.m9.1.1.3" xref="S3.SS2.p3.9.m9.1.1.3.cmml"><mi id="S3.SS2.p3.9.m9.1.1.3.2" xref="S3.SS2.p3.9.m9.1.1.3.2.cmml">p</mi><mi id="S3.SS2.p3.9.m9.1.1.3.3" xref="S3.SS2.p3.9.m9.1.1.3.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p3.9.m9.1.1.2" xref="S3.SS2.p3.9.m9.1.1.2.cmml">​</mo><mrow id="S3.SS2.p3.9.m9.1.1.1.1" xref="S3.SS2.p3.9.m9.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.9.m9.1.1.1.1.2" xref="S3.SS2.p3.9.m9.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p3.9.m9.1.1.1.1.1" xref="S3.SS2.p3.9.m9.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.9.m9.1.1.1.1.1.3" xref="S3.SS2.p3.9.m9.1.1.1.1.1.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.9.m9.1.1.1.1.1.2" xref="S3.SS2.p3.9.m9.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p3.9.m9.1.1.1.1.1.1.1" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.2" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.2" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.2.cmml">o</mi><mi id="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.3" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.3" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS2.p3.9.m9.1.1.1.1.3" xref="S3.SS2.p3.9.m9.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.9.m9.1b"><apply id="S3.SS2.p3.9.m9.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1"><times id="S3.SS2.p3.9.m9.1.1.2.cmml" xref="S3.SS2.p3.9.m9.1.1.2"></times><apply id="S3.SS2.p3.9.m9.1.1.3.cmml" xref="S3.SS2.p3.9.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.9.m9.1.1.3.1.cmml" xref="S3.SS2.p3.9.m9.1.1.3">subscript</csymbol><ci id="S3.SS2.p3.9.m9.1.1.3.2.cmml" xref="S3.SS2.p3.9.m9.1.1.3.2">𝑝</ci><ci id="S3.SS2.p3.9.m9.1.1.3.3.cmml" xref="S3.SS2.p3.9.m9.1.1.3.3">𝑗</ci></apply><apply id="S3.SS2.p3.9.m9.1.1.1.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1.1.1"><times id="S3.SS2.p3.9.m9.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.9.m9.1.1.1.1.1.2"></times><ci id="S3.SS2.p3.9.m9.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.9.m9.1.1.1.1.1.3">𝐸</ci><apply id="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.2">𝑜</ci><ci id="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.9.m9.1c">p_{j}(E(o_{j}))</annotation></semantics></math> for first order Taylor expansion (see also <cite class="ltx_cite ltx_citemacro_citep">(Daunizeau, <a href="#bib.bib4" title="" class="ltx_ref">2017</a>)</cite>). Therefore, this results in <math id="S3.SS2.p3.10.m10.1" class="ltx_Math" alttext="\langle p_{j}\rangle" display="inline"><semantics id="S3.SS2.p3.10.m10.1a"><mrow id="S3.SS2.p3.10.m10.1.1.1" xref="S3.SS2.p3.10.m10.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p3.10.m10.1.1.1.2" xref="S3.SS2.p3.10.m10.1.1.2.1.cmml">⟨</mo><msub id="S3.SS2.p3.10.m10.1.1.1.1" xref="S3.SS2.p3.10.m10.1.1.1.1.cmml"><mi id="S3.SS2.p3.10.m10.1.1.1.1.2" xref="S3.SS2.p3.10.m10.1.1.1.1.2.cmml">p</mi><mi id="S3.SS2.p3.10.m10.1.1.1.1.3" xref="S3.SS2.p3.10.m10.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS2.p3.10.m10.1.1.1.3" xref="S3.SS2.p3.10.m10.1.1.2.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.10.m10.1b"><apply id="S3.SS2.p3.10.m10.1.1.2.cmml" xref="S3.SS2.p3.10.m10.1.1.1"><csymbol cd="latexml" id="S3.SS2.p3.10.m10.1.1.2.1.cmml" xref="S3.SS2.p3.10.m10.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S3.SS2.p3.10.m10.1.1.1.1.cmml" xref="S3.SS2.p3.10.m10.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.10.m10.1.1.1.1.1.cmml" xref="S3.SS2.p3.10.m10.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.10.m10.1.1.1.1.2.cmml" xref="S3.SS2.p3.10.m10.1.1.1.1.2">𝑝</ci><ci id="S3.SS2.p3.10.m10.1.1.1.1.3.cmml" xref="S3.SS2.p3.10.m10.1.1.1.1.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.10.m10.1c">\langle p_{j}\rangle</annotation></semantics></math> to be inversely proportional to the number of classes <math id="S3.SS2.p3.11.m11.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS2.p3.11.m11.1a"><mi id="S3.SS2.p3.11.m11.1.1" xref="S3.SS2.p3.11.m11.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.11.m11.1b"><ci id="S3.SS2.p3.11.m11.1.1.cmml" xref="S3.SS2.p3.11.m11.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.11.m11.1c">C</annotation></semantics></math>.
Subsequently, a batch that contains non-similar labels, <math id="S3.SS2.p3.12.m12.1" class="ltx_Math" alttext="c^{m}\neq c^{1...B}" display="inline"><semantics id="S3.SS2.p3.12.m12.1a"><mrow id="S3.SS2.p3.12.m12.1.1" xref="S3.SS2.p3.12.m12.1.1.cmml"><msup id="S3.SS2.p3.12.m12.1.1.2" xref="S3.SS2.p3.12.m12.1.1.2.cmml"><mi id="S3.SS2.p3.12.m12.1.1.2.2" xref="S3.SS2.p3.12.m12.1.1.2.2.cmml">c</mi><mi id="S3.SS2.p3.12.m12.1.1.2.3" xref="S3.SS2.p3.12.m12.1.1.2.3.cmml">m</mi></msup><mo id="S3.SS2.p3.12.m12.1.1.1" xref="S3.SS2.p3.12.m12.1.1.1.cmml">≠</mo><msup id="S3.SS2.p3.12.m12.1.1.3" xref="S3.SS2.p3.12.m12.1.1.3.cmml"><mi id="S3.SS2.p3.12.m12.1.1.3.2" xref="S3.SS2.p3.12.m12.1.1.3.2.cmml">c</mi><mrow id="S3.SS2.p3.12.m12.1.1.3.3" xref="S3.SS2.p3.12.m12.1.1.3.3.cmml"><mn id="S3.SS2.p3.12.m12.1.1.3.3.2" xref="S3.SS2.p3.12.m12.1.1.3.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S3.SS2.p3.12.m12.1.1.3.3.1" xref="S3.SS2.p3.12.m12.1.1.3.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS2.p3.12.m12.1.1.3.3.3" xref="S3.SS2.p3.12.m12.1.1.3.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.12.m12.1.1.3.3.1a" xref="S3.SS2.p3.12.m12.1.1.3.3.1.cmml">​</mo><mi id="S3.SS2.p3.12.m12.1.1.3.3.4" xref="S3.SS2.p3.12.m12.1.1.3.3.4.cmml">B</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.12.m12.1b"><apply id="S3.SS2.p3.12.m12.1.1.cmml" xref="S3.SS2.p3.12.m12.1.1"><neq id="S3.SS2.p3.12.m12.1.1.1.cmml" xref="S3.SS2.p3.12.m12.1.1.1"></neq><apply id="S3.SS2.p3.12.m12.1.1.2.cmml" xref="S3.SS2.p3.12.m12.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.12.m12.1.1.2.1.cmml" xref="S3.SS2.p3.12.m12.1.1.2">superscript</csymbol><ci id="S3.SS2.p3.12.m12.1.1.2.2.cmml" xref="S3.SS2.p3.12.m12.1.1.2.2">𝑐</ci><ci id="S3.SS2.p3.12.m12.1.1.2.3.cmml" xref="S3.SS2.p3.12.m12.1.1.2.3">𝑚</ci></apply><apply id="S3.SS2.p3.12.m12.1.1.3.cmml" xref="S3.SS2.p3.12.m12.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.12.m12.1.1.3.1.cmml" xref="S3.SS2.p3.12.m12.1.1.3">superscript</csymbol><ci id="S3.SS2.p3.12.m12.1.1.3.2.cmml" xref="S3.SS2.p3.12.m12.1.1.3.2">𝑐</ci><apply id="S3.SS2.p3.12.m12.1.1.3.3.cmml" xref="S3.SS2.p3.12.m12.1.1.3.3"><times id="S3.SS2.p3.12.m12.1.1.3.3.1.cmml" xref="S3.SS2.p3.12.m12.1.1.3.3.1"></times><cn type="integer" id="S3.SS2.p3.12.m12.1.1.3.3.2.cmml" xref="S3.SS2.p3.12.m12.1.1.3.3.2">1</cn><ci id="S3.SS2.p3.12.m12.1.1.3.3.3.cmml" xref="S3.SS2.p3.12.m12.1.1.3.3.3">…</ci><ci id="S3.SS2.p3.12.m12.1.1.3.3.4.cmml" xref="S3.SS2.p3.12.m12.1.1.3.3.4">𝐵</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.12.m12.1c">c^{m}\neq c^{1...B}</annotation></semantics></math>, Eq. (<a href="#S3.E6" title="In 3.2 Direct inversion of a full batch ‣ 3 Gradient mixing as a batch defense strategy ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>)-(<a href="#S3.E7" title="In 3.2 Direct inversion of a full batch ‣ 3 Gradient mixing as a batch defense strategy ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>) can be estimated as:</p>
<table id="S3.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex1.m1.9" class="ltx_Math" alttext="\frac{\partial{w_{i,j}^{B}}}{\partial b^{B}_{j}}\approx\frac{(\langle p^{m}_{j=c}\rangle-1)x_{i}^{m(j=c)}+\langle p^{m}_{j\neq c}\rangle\sum x_{i}^{m(j\neq c)}}{(\langle p^{m}_{j=c}\rangle-1)+(B-1)\langle p^{m}_{j\neq c}\rangle}" display="block"><semantics id="S3.Ex1.m1.9a"><mrow id="S3.Ex1.m1.9.10" xref="S3.Ex1.m1.9.10.cmml"><mfrac id="S3.Ex1.m1.2.2" xref="S3.Ex1.m1.2.2.cmml"><mrow id="S3.Ex1.m1.2.2.2" xref="S3.Ex1.m1.2.2.2.cmml"><mo rspace="0em" id="S3.Ex1.m1.2.2.2.3" xref="S3.Ex1.m1.2.2.2.3.cmml">∂</mo><msubsup id="S3.Ex1.m1.2.2.2.4" xref="S3.Ex1.m1.2.2.2.4.cmml"><mi id="S3.Ex1.m1.2.2.2.4.2.2" xref="S3.Ex1.m1.2.2.2.4.2.2.cmml">w</mi><mrow id="S3.Ex1.m1.2.2.2.2.2.4" xref="S3.Ex1.m1.2.2.2.2.2.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml">i</mi><mo id="S3.Ex1.m1.2.2.2.2.2.4.1" xref="S3.Ex1.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S3.Ex1.m1.2.2.2.2.2.2" xref="S3.Ex1.m1.2.2.2.2.2.2.cmml">j</mi></mrow><mi id="S3.Ex1.m1.2.2.2.4.3" xref="S3.Ex1.m1.2.2.2.4.3.cmml">B</mi></msubsup></mrow><mrow id="S3.Ex1.m1.2.2.4" xref="S3.Ex1.m1.2.2.4.cmml"><mo rspace="0em" id="S3.Ex1.m1.2.2.4.1" xref="S3.Ex1.m1.2.2.4.1.cmml">∂</mo><msubsup id="S3.Ex1.m1.2.2.4.2" xref="S3.Ex1.m1.2.2.4.2.cmml"><mi id="S3.Ex1.m1.2.2.4.2.2.2" xref="S3.Ex1.m1.2.2.4.2.2.2.cmml">b</mi><mi id="S3.Ex1.m1.2.2.4.2.3" xref="S3.Ex1.m1.2.2.4.2.3.cmml">j</mi><mi id="S3.Ex1.m1.2.2.4.2.2.3" xref="S3.Ex1.m1.2.2.4.2.2.3.cmml">B</mi></msubsup></mrow></mfrac><mo id="S3.Ex1.m1.9.10.1" xref="S3.Ex1.m1.9.10.1.cmml">≈</mo><mfrac id="S3.Ex1.m1.9.9" xref="S3.Ex1.m1.9.9.cmml"><mrow id="S3.Ex1.m1.6.6.4" xref="S3.Ex1.m1.6.6.4.cmml"><mrow id="S3.Ex1.m1.5.5.3.3" xref="S3.Ex1.m1.5.5.3.3.cmml"><mrow id="S3.Ex1.m1.5.5.3.3.1.1" xref="S3.Ex1.m1.5.5.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.5.5.3.3.1.1.2" xref="S3.Ex1.m1.5.5.3.3.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.5.5.3.3.1.1.1" xref="S3.Ex1.m1.5.5.3.3.1.1.1.cmml"><mrow id="S3.Ex1.m1.5.5.3.3.1.1.1.1.1" xref="S3.Ex1.m1.5.5.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.2" xref="S3.Ex1.m1.5.5.3.3.1.1.1.1.2.1.cmml">⟨</mo><msubsup id="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1" xref="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.2.2" xref="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.2.2.cmml">p</mi><mrow id="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.3" xref="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.3.2" xref="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.3.2.cmml">j</mi><mo id="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.3.1" xref="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.3.1.cmml">=</mo><mi id="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.3.3" xref="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.3.3.cmml">c</mi></mrow><mi id="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.2.3" xref="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.2.3.cmml">m</mi></msubsup><mo stretchy="false" id="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.3" xref="S3.Ex1.m1.5.5.3.3.1.1.1.1.2.1.cmml">⟩</mo></mrow><mo id="S3.Ex1.m1.5.5.3.3.1.1.1.2" xref="S3.Ex1.m1.5.5.3.3.1.1.1.2.cmml">−</mo><mn id="S3.Ex1.m1.5.5.3.3.1.1.1.3" xref="S3.Ex1.m1.5.5.3.3.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.Ex1.m1.5.5.3.3.1.1.3" xref="S3.Ex1.m1.5.5.3.3.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.5.5.3.3.2" xref="S3.Ex1.m1.5.5.3.3.2.cmml">​</mo><msubsup id="S3.Ex1.m1.5.5.3.3.3" xref="S3.Ex1.m1.5.5.3.3.3.cmml"><mi id="S3.Ex1.m1.5.5.3.3.3.2.2" xref="S3.Ex1.m1.5.5.3.3.3.2.2.cmml">x</mi><mi id="S3.Ex1.m1.5.5.3.3.3.2.3" xref="S3.Ex1.m1.5.5.3.3.3.2.3.cmml">i</mi><mrow id="S3.Ex1.m1.3.3.1.1.1" xref="S3.Ex1.m1.3.3.1.1.1.cmml"><mi id="S3.Ex1.m1.3.3.1.1.1.3" xref="S3.Ex1.m1.3.3.1.1.1.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.1.1.1.2" xref="S3.Ex1.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.Ex1.m1.3.3.1.1.1.1.1" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.3.3.1.1.1.1.1.2" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.3.3.1.1.1.1.1.1" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.3.3.1.1.1.1.1.1.2" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.2.cmml">j</mi><mo id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.cmml">=</mo><mi id="S3.Ex1.m1.3.3.1.1.1.1.1.1.3" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.3.cmml">c</mi></mrow><mo stretchy="false" id="S3.Ex1.m1.3.3.1.1.1.1.1.3" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msubsup></mrow><mo id="S3.Ex1.m1.6.6.4.5" xref="S3.Ex1.m1.6.6.4.5.cmml">+</mo><mrow id="S3.Ex1.m1.6.6.4.4" xref="S3.Ex1.m1.6.6.4.4.cmml"><mrow id="S3.Ex1.m1.6.6.4.4.1.1" xref="S3.Ex1.m1.6.6.4.4.1.2.cmml"><mo stretchy="false" id="S3.Ex1.m1.6.6.4.4.1.1.2" xref="S3.Ex1.m1.6.6.4.4.1.2.1.cmml">⟨</mo><msubsup id="S3.Ex1.m1.6.6.4.4.1.1.1" xref="S3.Ex1.m1.6.6.4.4.1.1.1.cmml"><mi id="S3.Ex1.m1.6.6.4.4.1.1.1.2.2" xref="S3.Ex1.m1.6.6.4.4.1.1.1.2.2.cmml">p</mi><mrow id="S3.Ex1.m1.6.6.4.4.1.1.1.3" xref="S3.Ex1.m1.6.6.4.4.1.1.1.3.cmml"><mi id="S3.Ex1.m1.6.6.4.4.1.1.1.3.2" xref="S3.Ex1.m1.6.6.4.4.1.1.1.3.2.cmml">j</mi><mo id="S3.Ex1.m1.6.6.4.4.1.1.1.3.1" xref="S3.Ex1.m1.6.6.4.4.1.1.1.3.1.cmml">≠</mo><mi id="S3.Ex1.m1.6.6.4.4.1.1.1.3.3" xref="S3.Ex1.m1.6.6.4.4.1.1.1.3.3.cmml">c</mi></mrow><mi id="S3.Ex1.m1.6.6.4.4.1.1.1.2.3" xref="S3.Ex1.m1.6.6.4.4.1.1.1.2.3.cmml">m</mi></msubsup><mo stretchy="false" id="S3.Ex1.m1.6.6.4.4.1.1.3" xref="S3.Ex1.m1.6.6.4.4.1.2.1.cmml">⟩</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.6.6.4.4.2" xref="S3.Ex1.m1.6.6.4.4.2.cmml">​</mo><mrow id="S3.Ex1.m1.6.6.4.4.3" xref="S3.Ex1.m1.6.6.4.4.3.cmml"><mo id="S3.Ex1.m1.6.6.4.4.3.1" xref="S3.Ex1.m1.6.6.4.4.3.1.cmml">∑</mo><msubsup id="S3.Ex1.m1.6.6.4.4.3.2" xref="S3.Ex1.m1.6.6.4.4.3.2.cmml"><mi id="S3.Ex1.m1.6.6.4.4.3.2.2.2" xref="S3.Ex1.m1.6.6.4.4.3.2.2.2.cmml">x</mi><mi id="S3.Ex1.m1.6.6.4.4.3.2.2.3" xref="S3.Ex1.m1.6.6.4.4.3.2.2.3.cmml">i</mi><mrow id="S3.Ex1.m1.4.4.2.2.1" xref="S3.Ex1.m1.4.4.2.2.1.cmml"><mi id="S3.Ex1.m1.4.4.2.2.1.3" xref="S3.Ex1.m1.4.4.2.2.1.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.4.4.2.2.1.2" xref="S3.Ex1.m1.4.4.2.2.1.2.cmml">​</mo><mrow id="S3.Ex1.m1.4.4.2.2.1.1.1" xref="S3.Ex1.m1.4.4.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.4.4.2.2.1.1.1.2" xref="S3.Ex1.m1.4.4.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.4.4.2.2.1.1.1.1" xref="S3.Ex1.m1.4.4.2.2.1.1.1.1.cmml"><mi id="S3.Ex1.m1.4.4.2.2.1.1.1.1.2" xref="S3.Ex1.m1.4.4.2.2.1.1.1.1.2.cmml">j</mi><mo id="S3.Ex1.m1.4.4.2.2.1.1.1.1.1" xref="S3.Ex1.m1.4.4.2.2.1.1.1.1.1.cmml">≠</mo><mi id="S3.Ex1.m1.4.4.2.2.1.1.1.1.3" xref="S3.Ex1.m1.4.4.2.2.1.1.1.1.3.cmml">c</mi></mrow><mo stretchy="false" id="S3.Ex1.m1.4.4.2.2.1.1.1.3" xref="S3.Ex1.m1.4.4.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></msubsup></mrow></mrow></mrow><mrow id="S3.Ex1.m1.9.9.7" xref="S3.Ex1.m1.9.9.7.cmml"><mrow id="S3.Ex1.m1.7.7.5.1.1" xref="S3.Ex1.m1.7.7.5.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.7.7.5.1.1.2" xref="S3.Ex1.m1.7.7.5.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.7.7.5.1.1.1" xref="S3.Ex1.m1.7.7.5.1.1.1.cmml"><mrow id="S3.Ex1.m1.7.7.5.1.1.1.1.1" xref="S3.Ex1.m1.7.7.5.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex1.m1.7.7.5.1.1.1.1.1.2" xref="S3.Ex1.m1.7.7.5.1.1.1.1.2.1.cmml">⟨</mo><msubsup id="S3.Ex1.m1.7.7.5.1.1.1.1.1.1" xref="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.2.2" xref="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.2.2.cmml">p</mi><mrow id="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.3" xref="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.3.2" xref="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.3.2.cmml">j</mi><mo id="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.3.1" xref="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.3.1.cmml">=</mo><mi id="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.3.3" xref="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.3.3.cmml">c</mi></mrow><mi id="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.2.3" xref="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.2.3.cmml">m</mi></msubsup><mo stretchy="false" id="S3.Ex1.m1.7.7.5.1.1.1.1.1.3" xref="S3.Ex1.m1.7.7.5.1.1.1.1.2.1.cmml">⟩</mo></mrow><mo id="S3.Ex1.m1.7.7.5.1.1.1.2" xref="S3.Ex1.m1.7.7.5.1.1.1.2.cmml">−</mo><mn id="S3.Ex1.m1.7.7.5.1.1.1.3" xref="S3.Ex1.m1.7.7.5.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.Ex1.m1.7.7.5.1.1.3" xref="S3.Ex1.m1.7.7.5.1.1.1.cmml">)</mo></mrow><mo id="S3.Ex1.m1.9.9.7.4" xref="S3.Ex1.m1.9.9.7.4.cmml">+</mo><mrow id="S3.Ex1.m1.9.9.7.3" xref="S3.Ex1.m1.9.9.7.3.cmml"><mrow id="S3.Ex1.m1.8.8.6.2.1.1" xref="S3.Ex1.m1.8.8.6.2.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.8.8.6.2.1.1.2" xref="S3.Ex1.m1.8.8.6.2.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.8.8.6.2.1.1.1" xref="S3.Ex1.m1.8.8.6.2.1.1.1.cmml"><mi id="S3.Ex1.m1.8.8.6.2.1.1.1.2" xref="S3.Ex1.m1.8.8.6.2.1.1.1.2.cmml">B</mi><mo id="S3.Ex1.m1.8.8.6.2.1.1.1.1" xref="S3.Ex1.m1.8.8.6.2.1.1.1.1.cmml">−</mo><mn id="S3.Ex1.m1.8.8.6.2.1.1.1.3" xref="S3.Ex1.m1.8.8.6.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.Ex1.m1.8.8.6.2.1.1.3" xref="S3.Ex1.m1.8.8.6.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.9.9.7.3.3" xref="S3.Ex1.m1.9.9.7.3.3.cmml">​</mo><mrow id="S3.Ex1.m1.9.9.7.3.2.1" xref="S3.Ex1.m1.9.9.7.3.2.2.cmml"><mo stretchy="false" id="S3.Ex1.m1.9.9.7.3.2.1.2" xref="S3.Ex1.m1.9.9.7.3.2.2.1.cmml">⟨</mo><msubsup id="S3.Ex1.m1.9.9.7.3.2.1.1" xref="S3.Ex1.m1.9.9.7.3.2.1.1.cmml"><mi id="S3.Ex1.m1.9.9.7.3.2.1.1.2.2" xref="S3.Ex1.m1.9.9.7.3.2.1.1.2.2.cmml">p</mi><mrow id="S3.Ex1.m1.9.9.7.3.2.1.1.3" xref="S3.Ex1.m1.9.9.7.3.2.1.1.3.cmml"><mi id="S3.Ex1.m1.9.9.7.3.2.1.1.3.2" xref="S3.Ex1.m1.9.9.7.3.2.1.1.3.2.cmml">j</mi><mo id="S3.Ex1.m1.9.9.7.3.2.1.1.3.1" xref="S3.Ex1.m1.9.9.7.3.2.1.1.3.1.cmml">≠</mo><mi id="S3.Ex1.m1.9.9.7.3.2.1.1.3.3" xref="S3.Ex1.m1.9.9.7.3.2.1.1.3.3.cmml">c</mi></mrow><mi id="S3.Ex1.m1.9.9.7.3.2.1.1.2.3" xref="S3.Ex1.m1.9.9.7.3.2.1.1.2.3.cmml">m</mi></msubsup><mo stretchy="false" id="S3.Ex1.m1.9.9.7.3.2.1.3" xref="S3.Ex1.m1.9.9.7.3.2.2.1.cmml">⟩</mo></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.9b"><apply id="S3.Ex1.m1.9.10.cmml" xref="S3.Ex1.m1.9.10"><approx id="S3.Ex1.m1.9.10.1.cmml" xref="S3.Ex1.m1.9.10.1"></approx><apply id="S3.Ex1.m1.2.2.cmml" xref="S3.Ex1.m1.2.2"><divide id="S3.Ex1.m1.2.2.3.cmml" xref="S3.Ex1.m1.2.2"></divide><apply id="S3.Ex1.m1.2.2.2.cmml" xref="S3.Ex1.m1.2.2.2"><partialdiff id="S3.Ex1.m1.2.2.2.3.cmml" xref="S3.Ex1.m1.2.2.2.3"></partialdiff><apply id="S3.Ex1.m1.2.2.2.4.cmml" xref="S3.Ex1.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.2.4.1.cmml" xref="S3.Ex1.m1.2.2.2.4">superscript</csymbol><apply id="S3.Ex1.m1.2.2.2.4.2.cmml" xref="S3.Ex1.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.2.4.2.1.cmml" xref="S3.Ex1.m1.2.2.2.4">subscript</csymbol><ci id="S3.Ex1.m1.2.2.2.4.2.2.cmml" xref="S3.Ex1.m1.2.2.2.4.2.2">𝑤</ci><list id="S3.Ex1.m1.2.2.2.2.2.3.cmml" xref="S3.Ex1.m1.2.2.2.2.2.4"><ci id="S3.Ex1.m1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1">𝑖</ci><ci id="S3.Ex1.m1.2.2.2.2.2.2.cmml" xref="S3.Ex1.m1.2.2.2.2.2.2">𝑗</ci></list></apply><ci id="S3.Ex1.m1.2.2.2.4.3.cmml" xref="S3.Ex1.m1.2.2.2.4.3">𝐵</ci></apply></apply><apply id="S3.Ex1.m1.2.2.4.cmml" xref="S3.Ex1.m1.2.2.4"><partialdiff id="S3.Ex1.m1.2.2.4.1.cmml" xref="S3.Ex1.m1.2.2.4.1"></partialdiff><apply id="S3.Ex1.m1.2.2.4.2.cmml" xref="S3.Ex1.m1.2.2.4.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.4.2.1.cmml" xref="S3.Ex1.m1.2.2.4.2">subscript</csymbol><apply id="S3.Ex1.m1.2.2.4.2.2.cmml" xref="S3.Ex1.m1.2.2.4.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.4.2.2.1.cmml" xref="S3.Ex1.m1.2.2.4.2">superscript</csymbol><ci id="S3.Ex1.m1.2.2.4.2.2.2.cmml" xref="S3.Ex1.m1.2.2.4.2.2.2">𝑏</ci><ci id="S3.Ex1.m1.2.2.4.2.2.3.cmml" xref="S3.Ex1.m1.2.2.4.2.2.3">𝐵</ci></apply><ci id="S3.Ex1.m1.2.2.4.2.3.cmml" xref="S3.Ex1.m1.2.2.4.2.3">𝑗</ci></apply></apply></apply><apply id="S3.Ex1.m1.9.9.cmml" xref="S3.Ex1.m1.9.9"><divide id="S3.Ex1.m1.9.9.8.cmml" xref="S3.Ex1.m1.9.9"></divide><apply id="S3.Ex1.m1.6.6.4.cmml" xref="S3.Ex1.m1.6.6.4"><plus id="S3.Ex1.m1.6.6.4.5.cmml" xref="S3.Ex1.m1.6.6.4.5"></plus><apply id="S3.Ex1.m1.5.5.3.3.cmml" xref="S3.Ex1.m1.5.5.3.3"><times id="S3.Ex1.m1.5.5.3.3.2.cmml" xref="S3.Ex1.m1.5.5.3.3.2"></times><apply id="S3.Ex1.m1.5.5.3.3.1.1.1.cmml" xref="S3.Ex1.m1.5.5.3.3.1.1"><minus id="S3.Ex1.m1.5.5.3.3.1.1.1.2.cmml" xref="S3.Ex1.m1.5.5.3.3.1.1.1.2"></minus><apply id="S3.Ex1.m1.5.5.3.3.1.1.1.1.2.cmml" xref="S3.Ex1.m1.5.5.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex1.m1.5.5.3.3.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1">subscript</csymbol><apply id="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1">superscript</csymbol><ci id="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.2.2">𝑝</ci><ci id="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.2.3">𝑚</ci></apply><apply id="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.3"><eq id="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.3.1"></eq><ci id="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.3.2">𝑗</ci><ci id="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.5.5.3.3.1.1.1.1.1.1.3.3">𝑐</ci></apply></apply></apply><cn type="integer" id="S3.Ex1.m1.5.5.3.3.1.1.1.3.cmml" xref="S3.Ex1.m1.5.5.3.3.1.1.1.3">1</cn></apply><apply id="S3.Ex1.m1.5.5.3.3.3.cmml" xref="S3.Ex1.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.5.5.3.3.3.1.cmml" xref="S3.Ex1.m1.5.5.3.3.3">superscript</csymbol><apply id="S3.Ex1.m1.5.5.3.3.3.2.cmml" xref="S3.Ex1.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.5.5.3.3.3.2.1.cmml" xref="S3.Ex1.m1.5.5.3.3.3">subscript</csymbol><ci id="S3.Ex1.m1.5.5.3.3.3.2.2.cmml" xref="S3.Ex1.m1.5.5.3.3.3.2.2">𝑥</ci><ci id="S3.Ex1.m1.5.5.3.3.3.2.3.cmml" xref="S3.Ex1.m1.5.5.3.3.3.2.3">𝑖</ci></apply><apply id="S3.Ex1.m1.3.3.1.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1"><times id="S3.Ex1.m1.3.3.1.1.1.2.cmml" xref="S3.Ex1.m1.3.3.1.1.1.2"></times><ci id="S3.Ex1.m1.3.3.1.1.1.3.cmml" xref="S3.Ex1.m1.3.3.1.1.1.3">𝑚</ci><apply id="S3.Ex1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1"><eq id="S3.Ex1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.1"></eq><ci id="S3.Ex1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.2">𝑗</ci><ci id="S3.Ex1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.3">𝑐</ci></apply></apply></apply></apply><apply id="S3.Ex1.m1.6.6.4.4.cmml" xref="S3.Ex1.m1.6.6.4.4"><times id="S3.Ex1.m1.6.6.4.4.2.cmml" xref="S3.Ex1.m1.6.6.4.4.2"></times><apply id="S3.Ex1.m1.6.6.4.4.1.2.cmml" xref="S3.Ex1.m1.6.6.4.4.1.1"><csymbol cd="latexml" id="S3.Ex1.m1.6.6.4.4.1.2.1.cmml" xref="S3.Ex1.m1.6.6.4.4.1.1.2">delimited-⟨⟩</csymbol><apply id="S3.Ex1.m1.6.6.4.4.1.1.1.cmml" xref="S3.Ex1.m1.6.6.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.6.6.4.4.1.1.1.1.cmml" xref="S3.Ex1.m1.6.6.4.4.1.1.1">subscript</csymbol><apply id="S3.Ex1.m1.6.6.4.4.1.1.1.2.cmml" xref="S3.Ex1.m1.6.6.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.6.6.4.4.1.1.1.2.1.cmml" xref="S3.Ex1.m1.6.6.4.4.1.1.1">superscript</csymbol><ci id="S3.Ex1.m1.6.6.4.4.1.1.1.2.2.cmml" xref="S3.Ex1.m1.6.6.4.4.1.1.1.2.2">𝑝</ci><ci id="S3.Ex1.m1.6.6.4.4.1.1.1.2.3.cmml" xref="S3.Ex1.m1.6.6.4.4.1.1.1.2.3">𝑚</ci></apply><apply id="S3.Ex1.m1.6.6.4.4.1.1.1.3.cmml" xref="S3.Ex1.m1.6.6.4.4.1.1.1.3"><neq id="S3.Ex1.m1.6.6.4.4.1.1.1.3.1.cmml" xref="S3.Ex1.m1.6.6.4.4.1.1.1.3.1"></neq><ci id="S3.Ex1.m1.6.6.4.4.1.1.1.3.2.cmml" xref="S3.Ex1.m1.6.6.4.4.1.1.1.3.2">𝑗</ci><ci id="S3.Ex1.m1.6.6.4.4.1.1.1.3.3.cmml" xref="S3.Ex1.m1.6.6.4.4.1.1.1.3.3">𝑐</ci></apply></apply></apply><apply id="S3.Ex1.m1.6.6.4.4.3.cmml" xref="S3.Ex1.m1.6.6.4.4.3"><sum id="S3.Ex1.m1.6.6.4.4.3.1.cmml" xref="S3.Ex1.m1.6.6.4.4.3.1"></sum><apply id="S3.Ex1.m1.6.6.4.4.3.2.cmml" xref="S3.Ex1.m1.6.6.4.4.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.6.6.4.4.3.2.1.cmml" xref="S3.Ex1.m1.6.6.4.4.3.2">superscript</csymbol><apply id="S3.Ex1.m1.6.6.4.4.3.2.2.cmml" xref="S3.Ex1.m1.6.6.4.4.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.6.6.4.4.3.2.2.1.cmml" xref="S3.Ex1.m1.6.6.4.4.3.2">subscript</csymbol><ci id="S3.Ex1.m1.6.6.4.4.3.2.2.2.cmml" xref="S3.Ex1.m1.6.6.4.4.3.2.2.2">𝑥</ci><ci id="S3.Ex1.m1.6.6.4.4.3.2.2.3.cmml" xref="S3.Ex1.m1.6.6.4.4.3.2.2.3">𝑖</ci></apply><apply id="S3.Ex1.m1.4.4.2.2.1.cmml" xref="S3.Ex1.m1.4.4.2.2.1"><times id="S3.Ex1.m1.4.4.2.2.1.2.cmml" xref="S3.Ex1.m1.4.4.2.2.1.2"></times><ci id="S3.Ex1.m1.4.4.2.2.1.3.cmml" xref="S3.Ex1.m1.4.4.2.2.1.3">𝑚</ci><apply id="S3.Ex1.m1.4.4.2.2.1.1.1.1.cmml" xref="S3.Ex1.m1.4.4.2.2.1.1.1"><neq id="S3.Ex1.m1.4.4.2.2.1.1.1.1.1.cmml" xref="S3.Ex1.m1.4.4.2.2.1.1.1.1.1"></neq><ci id="S3.Ex1.m1.4.4.2.2.1.1.1.1.2.cmml" xref="S3.Ex1.m1.4.4.2.2.1.1.1.1.2">𝑗</ci><ci id="S3.Ex1.m1.4.4.2.2.1.1.1.1.3.cmml" xref="S3.Ex1.m1.4.4.2.2.1.1.1.1.3">𝑐</ci></apply></apply></apply></apply></apply></apply><apply id="S3.Ex1.m1.9.9.7.cmml" xref="S3.Ex1.m1.9.9.7"><plus id="S3.Ex1.m1.9.9.7.4.cmml" xref="S3.Ex1.m1.9.9.7.4"></plus><apply id="S3.Ex1.m1.7.7.5.1.1.1.cmml" xref="S3.Ex1.m1.7.7.5.1.1"><minus id="S3.Ex1.m1.7.7.5.1.1.1.2.cmml" xref="S3.Ex1.m1.7.7.5.1.1.1.2"></minus><apply id="S3.Ex1.m1.7.7.5.1.1.1.1.2.cmml" xref="S3.Ex1.m1.7.7.5.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex1.m1.7.7.5.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.7.7.5.1.1.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.7.7.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.7.7.5.1.1.1.1.1.1">subscript</csymbol><apply id="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.7.7.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.7.7.5.1.1.1.1.1.1">superscript</csymbol><ci id="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.2.2">𝑝</ci><ci id="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.2.3">𝑚</ci></apply><apply id="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.3"><eq id="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.3.1"></eq><ci id="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.3.2">𝑗</ci><ci id="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.7.7.5.1.1.1.1.1.1.3.3">𝑐</ci></apply></apply></apply><cn type="integer" id="S3.Ex1.m1.7.7.5.1.1.1.3.cmml" xref="S3.Ex1.m1.7.7.5.1.1.1.3">1</cn></apply><apply id="S3.Ex1.m1.9.9.7.3.cmml" xref="S3.Ex1.m1.9.9.7.3"><times id="S3.Ex1.m1.9.9.7.3.3.cmml" xref="S3.Ex1.m1.9.9.7.3.3"></times><apply id="S3.Ex1.m1.8.8.6.2.1.1.1.cmml" xref="S3.Ex1.m1.8.8.6.2.1.1"><minus id="S3.Ex1.m1.8.8.6.2.1.1.1.1.cmml" xref="S3.Ex1.m1.8.8.6.2.1.1.1.1"></minus><ci id="S3.Ex1.m1.8.8.6.2.1.1.1.2.cmml" xref="S3.Ex1.m1.8.8.6.2.1.1.1.2">𝐵</ci><cn type="integer" id="S3.Ex1.m1.8.8.6.2.1.1.1.3.cmml" xref="S3.Ex1.m1.8.8.6.2.1.1.1.3">1</cn></apply><apply id="S3.Ex1.m1.9.9.7.3.2.2.cmml" xref="S3.Ex1.m1.9.9.7.3.2.1"><csymbol cd="latexml" id="S3.Ex1.m1.9.9.7.3.2.2.1.cmml" xref="S3.Ex1.m1.9.9.7.3.2.1.2">delimited-⟨⟩</csymbol><apply id="S3.Ex1.m1.9.9.7.3.2.1.1.cmml" xref="S3.Ex1.m1.9.9.7.3.2.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.9.9.7.3.2.1.1.1.cmml" xref="S3.Ex1.m1.9.9.7.3.2.1.1">subscript</csymbol><apply id="S3.Ex1.m1.9.9.7.3.2.1.1.2.cmml" xref="S3.Ex1.m1.9.9.7.3.2.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.9.9.7.3.2.1.1.2.1.cmml" xref="S3.Ex1.m1.9.9.7.3.2.1.1">superscript</csymbol><ci id="S3.Ex1.m1.9.9.7.3.2.1.1.2.2.cmml" xref="S3.Ex1.m1.9.9.7.3.2.1.1.2.2">𝑝</ci><ci id="S3.Ex1.m1.9.9.7.3.2.1.1.2.3.cmml" xref="S3.Ex1.m1.9.9.7.3.2.1.1.2.3">𝑚</ci></apply><apply id="S3.Ex1.m1.9.9.7.3.2.1.1.3.cmml" xref="S3.Ex1.m1.9.9.7.3.2.1.1.3"><neq id="S3.Ex1.m1.9.9.7.3.2.1.1.3.1.cmml" xref="S3.Ex1.m1.9.9.7.3.2.1.1.3.1"></neq><ci id="S3.Ex1.m1.9.9.7.3.2.1.1.3.2.cmml" xref="S3.Ex1.m1.9.9.7.3.2.1.1.3.2">𝑗</ci><ci id="S3.Ex1.m1.9.9.7.3.2.1.1.3.3.cmml" xref="S3.Ex1.m1.9.9.7.3.2.1.1.3.3">𝑐</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.9c">\frac{\partial{w_{i,j}^{B}}}{\partial b^{B}_{j}}\approx\frac{(\langle p^{m}_{j=c}\rangle-1)x_{i}^{m(j=c)}+\langle p^{m}_{j\neq c}\rangle\sum x_{i}^{m(j\neq c)}}{(\langle p^{m}_{j=c}\rangle-1)+(B-1)\langle p^{m}_{j\neq c}\rangle}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.4" class="ltx_Math" alttext="\approx\frac{(\langle p^{m}_{j=c}\rangle-1)x_{i}^{m(j=c)}}{(\langle p^{m}_{j=c}\rangle-1)}=x_{i}^{m(j=c)}" display="block"><semantics id="S3.E8.m1.4a"><mrow id="S3.E8.m1.4.5" xref="S3.E8.m1.4.5.cmml"><mi id="S3.E8.m1.4.5.2" xref="S3.E8.m1.4.5.2.cmml"></mi><mo id="S3.E8.m1.4.5.3" xref="S3.E8.m1.4.5.3.cmml">≈</mo><mfrac id="S3.E8.m1.3.3" xref="S3.E8.m1.3.3.cmml"><mrow id="S3.E8.m1.2.2.2" xref="S3.E8.m1.2.2.2.cmml"><mrow id="S3.E8.m1.2.2.2.2.1" xref="S3.E8.m1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.2.2.2.2.1.2" xref="S3.E8.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.E8.m1.2.2.2.2.1.1" xref="S3.E8.m1.2.2.2.2.1.1.cmml"><mrow id="S3.E8.m1.2.2.2.2.1.1.1.1" xref="S3.E8.m1.2.2.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.E8.m1.2.2.2.2.1.1.1.1.2" xref="S3.E8.m1.2.2.2.2.1.1.1.2.1.cmml">⟨</mo><msubsup id="S3.E8.m1.2.2.2.2.1.1.1.1.1" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1.cmml"><mi id="S3.E8.m1.2.2.2.2.1.1.1.1.1.2.2" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1.2.2.cmml">p</mi><mrow id="S3.E8.m1.2.2.2.2.1.1.1.1.1.3" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.2.2.2.2.1.1.1.1.1.3.2" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1.3.2.cmml">j</mi><mo id="S3.E8.m1.2.2.2.2.1.1.1.1.1.3.1" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1.3.1.cmml">=</mo><mi id="S3.E8.m1.2.2.2.2.1.1.1.1.1.3.3" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1.3.3.cmml">c</mi></mrow><mi id="S3.E8.m1.2.2.2.2.1.1.1.1.1.2.3" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1.2.3.cmml">m</mi></msubsup><mo stretchy="false" id="S3.E8.m1.2.2.2.2.1.1.1.1.3" xref="S3.E8.m1.2.2.2.2.1.1.1.2.1.cmml">⟩</mo></mrow><mo id="S3.E8.m1.2.2.2.2.1.1.2" xref="S3.E8.m1.2.2.2.2.1.1.2.cmml">−</mo><mn id="S3.E8.m1.2.2.2.2.1.1.3" xref="S3.E8.m1.2.2.2.2.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E8.m1.2.2.2.2.1.3" xref="S3.E8.m1.2.2.2.2.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.2.3" xref="S3.E8.m1.2.2.2.3.cmml">​</mo><msubsup id="S3.E8.m1.2.2.2.4" xref="S3.E8.m1.2.2.2.4.cmml"><mi id="S3.E8.m1.2.2.2.4.2.2" xref="S3.E8.m1.2.2.2.4.2.2.cmml">x</mi><mi id="S3.E8.m1.2.2.2.4.2.3" xref="S3.E8.m1.2.2.2.4.2.3.cmml">i</mi><mrow id="S3.E8.m1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E8.m1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.1.2.cmml">j</mi><mo id="S3.E8.m1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S3.E8.m1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.1.3.cmml">c</mi></mrow><mo stretchy="false" id="S3.E8.m1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msubsup></mrow><mrow id="S3.E8.m1.3.3.3.1" xref="S3.E8.m1.3.3.3.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.3.3.3.1.2" xref="S3.E8.m1.3.3.3.1.1.cmml">(</mo><mrow id="S3.E8.m1.3.3.3.1.1" xref="S3.E8.m1.3.3.3.1.1.cmml"><mrow id="S3.E8.m1.3.3.3.1.1.1.1" xref="S3.E8.m1.3.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S3.E8.m1.3.3.3.1.1.1.1.2" xref="S3.E8.m1.3.3.3.1.1.1.2.1.cmml">⟨</mo><msubsup id="S3.E8.m1.3.3.3.1.1.1.1.1" xref="S3.E8.m1.3.3.3.1.1.1.1.1.cmml"><mi id="S3.E8.m1.3.3.3.1.1.1.1.1.2.2" xref="S3.E8.m1.3.3.3.1.1.1.1.1.2.2.cmml">p</mi><mrow id="S3.E8.m1.3.3.3.1.1.1.1.1.3" xref="S3.E8.m1.3.3.3.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.3.3.3.1.1.1.1.1.3.2" xref="S3.E8.m1.3.3.3.1.1.1.1.1.3.2.cmml">j</mi><mo id="S3.E8.m1.3.3.3.1.1.1.1.1.3.1" xref="S3.E8.m1.3.3.3.1.1.1.1.1.3.1.cmml">=</mo><mi id="S3.E8.m1.3.3.3.1.1.1.1.1.3.3" xref="S3.E8.m1.3.3.3.1.1.1.1.1.3.3.cmml">c</mi></mrow><mi id="S3.E8.m1.3.3.3.1.1.1.1.1.2.3" xref="S3.E8.m1.3.3.3.1.1.1.1.1.2.3.cmml">m</mi></msubsup><mo stretchy="false" id="S3.E8.m1.3.3.3.1.1.1.1.3" xref="S3.E8.m1.3.3.3.1.1.1.2.1.cmml">⟩</mo></mrow><mo id="S3.E8.m1.3.3.3.1.1.2" xref="S3.E8.m1.3.3.3.1.1.2.cmml">−</mo><mn id="S3.E8.m1.3.3.3.1.1.3" xref="S3.E8.m1.3.3.3.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E8.m1.3.3.3.1.3" xref="S3.E8.m1.3.3.3.1.1.cmml">)</mo></mrow></mfrac><mo id="S3.E8.m1.4.5.4" xref="S3.E8.m1.4.5.4.cmml">=</mo><msubsup id="S3.E8.m1.4.5.5" xref="S3.E8.m1.4.5.5.cmml"><mi id="S3.E8.m1.4.5.5.2.2" xref="S3.E8.m1.4.5.5.2.2.cmml">x</mi><mi id="S3.E8.m1.4.5.5.2.3" xref="S3.E8.m1.4.5.5.2.3.cmml">i</mi><mrow id="S3.E8.m1.4.4.1" xref="S3.E8.m1.4.4.1.cmml"><mi id="S3.E8.m1.4.4.1.3" xref="S3.E8.m1.4.4.1.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.4.4.1.2" xref="S3.E8.m1.4.4.1.2.cmml">​</mo><mrow id="S3.E8.m1.4.4.1.1.1" xref="S3.E8.m1.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.4.4.1.1.1.2" xref="S3.E8.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.4.4.1.1.1.1" xref="S3.E8.m1.4.4.1.1.1.1.cmml"><mi id="S3.E8.m1.4.4.1.1.1.1.2" xref="S3.E8.m1.4.4.1.1.1.1.2.cmml">j</mi><mo id="S3.E8.m1.4.4.1.1.1.1.1" xref="S3.E8.m1.4.4.1.1.1.1.1.cmml">=</mo><mi id="S3.E8.m1.4.4.1.1.1.1.3" xref="S3.E8.m1.4.4.1.1.1.1.3.cmml">c</mi></mrow><mo stretchy="false" id="S3.E8.m1.4.4.1.1.1.3" xref="S3.E8.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.4b"><apply id="S3.E8.m1.4.5.cmml" xref="S3.E8.m1.4.5"><and id="S3.E8.m1.4.5a.cmml" xref="S3.E8.m1.4.5"></and><apply id="S3.E8.m1.4.5b.cmml" xref="S3.E8.m1.4.5"><approx id="S3.E8.m1.4.5.3.cmml" xref="S3.E8.m1.4.5.3"></approx><csymbol cd="latexml" id="S3.E8.m1.4.5.2.cmml" xref="S3.E8.m1.4.5.2">absent</csymbol><apply id="S3.E8.m1.3.3.cmml" xref="S3.E8.m1.3.3"><divide id="S3.E8.m1.3.3.4.cmml" xref="S3.E8.m1.3.3"></divide><apply id="S3.E8.m1.2.2.2.cmml" xref="S3.E8.m1.2.2.2"><times id="S3.E8.m1.2.2.2.3.cmml" xref="S3.E8.m1.2.2.2.3"></times><apply id="S3.E8.m1.2.2.2.2.1.1.cmml" xref="S3.E8.m1.2.2.2.2.1"><minus id="S3.E8.m1.2.2.2.2.1.1.2.cmml" xref="S3.E8.m1.2.2.2.2.1.1.2"></minus><apply id="S3.E8.m1.2.2.2.2.1.1.1.2.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.1"><csymbol cd="latexml" id="S3.E8.m1.2.2.2.2.1.1.1.2.1.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S3.E8.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1">subscript</csymbol><apply id="S3.E8.m1.2.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1">superscript</csymbol><ci id="S3.E8.m1.2.2.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1.2.2">𝑝</ci><ci id="S3.E8.m1.2.2.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1.2.3">𝑚</ci></apply><apply id="S3.E8.m1.2.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1.3"><eq id="S3.E8.m1.2.2.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1.3.1"></eq><ci id="S3.E8.m1.2.2.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1.3.2">𝑗</ci><ci id="S3.E8.m1.2.2.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.2.2.2.2.1.1.1.1.1.3.3">𝑐</ci></apply></apply></apply><cn type="integer" id="S3.E8.m1.2.2.2.2.1.1.3.cmml" xref="S3.E8.m1.2.2.2.2.1.1.3">1</cn></apply><apply id="S3.E8.m1.2.2.2.4.cmml" xref="S3.E8.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.2.4.1.cmml" xref="S3.E8.m1.2.2.2.4">superscript</csymbol><apply id="S3.E8.m1.2.2.2.4.2.cmml" xref="S3.E8.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.2.4.2.1.cmml" xref="S3.E8.m1.2.2.2.4">subscript</csymbol><ci id="S3.E8.m1.2.2.2.4.2.2.cmml" xref="S3.E8.m1.2.2.2.4.2.2">𝑥</ci><ci id="S3.E8.m1.2.2.2.4.2.3.cmml" xref="S3.E8.m1.2.2.2.4.2.3">𝑖</ci></apply><apply id="S3.E8.m1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1"><times id="S3.E8.m1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.2"></times><ci id="S3.E8.m1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.3">𝑚</ci><apply id="S3.E8.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1"><eq id="S3.E8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1"></eq><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.2">𝑗</ci><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.3">𝑐</ci></apply></apply></apply></apply><apply id="S3.E8.m1.3.3.3.1.1.cmml" xref="S3.E8.m1.3.3.3.1"><minus id="S3.E8.m1.3.3.3.1.1.2.cmml" xref="S3.E8.m1.3.3.3.1.1.2"></minus><apply id="S3.E8.m1.3.3.3.1.1.1.2.cmml" xref="S3.E8.m1.3.3.3.1.1.1.1"><csymbol cd="latexml" id="S3.E8.m1.3.3.3.1.1.1.2.1.cmml" xref="S3.E8.m1.3.3.3.1.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S3.E8.m1.3.3.3.1.1.1.1.1.cmml" xref="S3.E8.m1.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E8.m1.3.3.3.1.1.1.1.1">subscript</csymbol><apply id="S3.E8.m1.3.3.3.1.1.1.1.1.2.cmml" xref="S3.E8.m1.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.3.3.3.1.1.1.1.1">superscript</csymbol><ci id="S3.E8.m1.3.3.3.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.3.3.3.1.1.1.1.1.2.2">𝑝</ci><ci id="S3.E8.m1.3.3.3.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.3.3.3.1.1.1.1.1.2.3">𝑚</ci></apply><apply id="S3.E8.m1.3.3.3.1.1.1.1.1.3.cmml" xref="S3.E8.m1.3.3.3.1.1.1.1.1.3"><eq id="S3.E8.m1.3.3.3.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.3.3.3.1.1.1.1.1.3.1"></eq><ci id="S3.E8.m1.3.3.3.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.3.3.3.1.1.1.1.1.3.2">𝑗</ci><ci id="S3.E8.m1.3.3.3.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.3.3.3.1.1.1.1.1.3.3">𝑐</ci></apply></apply></apply><cn type="integer" id="S3.E8.m1.3.3.3.1.1.3.cmml" xref="S3.E8.m1.3.3.3.1.1.3">1</cn></apply></apply></apply><apply id="S3.E8.m1.4.5c.cmml" xref="S3.E8.m1.4.5"><eq id="S3.E8.m1.4.5.4.cmml" xref="S3.E8.m1.4.5.4"></eq><share href="#S3.E8.m1.3.3.cmml" id="S3.E8.m1.4.5d.cmml" xref="S3.E8.m1.4.5"></share><apply id="S3.E8.m1.4.5.5.cmml" xref="S3.E8.m1.4.5.5"><csymbol cd="ambiguous" id="S3.E8.m1.4.5.5.1.cmml" xref="S3.E8.m1.4.5.5">superscript</csymbol><apply id="S3.E8.m1.4.5.5.2.cmml" xref="S3.E8.m1.4.5.5"><csymbol cd="ambiguous" id="S3.E8.m1.4.5.5.2.1.cmml" xref="S3.E8.m1.4.5.5">subscript</csymbol><ci id="S3.E8.m1.4.5.5.2.2.cmml" xref="S3.E8.m1.4.5.5.2.2">𝑥</ci><ci id="S3.E8.m1.4.5.5.2.3.cmml" xref="S3.E8.m1.4.5.5.2.3">𝑖</ci></apply><apply id="S3.E8.m1.4.4.1.cmml" xref="S3.E8.m1.4.4.1"><times id="S3.E8.m1.4.4.1.2.cmml" xref="S3.E8.m1.4.4.1.2"></times><ci id="S3.E8.m1.4.4.1.3.cmml" xref="S3.E8.m1.4.4.1.3">𝑚</ci><apply id="S3.E8.m1.4.4.1.1.1.1.cmml" xref="S3.E8.m1.4.4.1.1.1"><eq id="S3.E8.m1.4.4.1.1.1.1.1.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1"></eq><ci id="S3.E8.m1.4.4.1.1.1.1.2.cmml" xref="S3.E8.m1.4.4.1.1.1.1.2">𝑗</ci><ci id="S3.E8.m1.4.4.1.1.1.1.3.cmml" xref="S3.E8.m1.4.4.1.1.1.1.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.4c">\approx\frac{(\langle p^{m}_{j=c}\rangle-1)x_{i}^{m(j=c)}}{(\langle p^{m}_{j=c}\rangle-1)}=x_{i}^{m(j=c)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.6" class="ltx_p">This approximation shows that the de-mixing of the gradients for each vector enables a direct estimate of the input layer for any vector <math id="S3.SS2.p4.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS2.p4.1.m1.1a"><mi id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">m</annotation></semantics></math> in the batch when we pick <math id="S3.SS2.p4.2.m2.1" class="ltx_Math" alttext="j=c" display="inline"><semantics id="S3.SS2.p4.2.m2.1a"><mrow id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml"><mi id="S3.SS2.p4.2.m2.1.1.2" xref="S3.SS2.p4.2.m2.1.1.2.cmml">j</mi><mo id="S3.SS2.p4.2.m2.1.1.1" xref="S3.SS2.p4.2.m2.1.1.1.cmml">=</mo><mi id="S3.SS2.p4.2.m2.1.1.3" xref="S3.SS2.p4.2.m2.1.1.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><apply id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1"><eq id="S3.SS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1.1"></eq><ci id="S3.SS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2">𝑗</ci><ci id="S3.SS2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">j=c</annotation></semantics></math>. The error of this estimation can be very low for large <math id="S3.SS2.p4.3.m3.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS2.p4.3.m3.1a"><mi id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><ci id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">C</annotation></semantics></math>. It is clearly seen empirically with the two most popular data-sets used for studying such inversion attacks, the MNIST with small number of equations <math id="S3.SS2.p4.4.m4.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS2.p4.4.m4.1a"><mi id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.1b"><ci id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.1c">C</annotation></semantics></math> and LFW with large <math id="S3.SS2.p4.5.m5.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS2.p4.5.m5.1a"><mi id="S3.SS2.p4.5.m5.1.1" xref="S3.SS2.p4.5.m5.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.1b"><ci id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.1c">C</annotation></semantics></math> (<math id="S3.SS2.p4.6.m6.1" class="ltx_Math" alttext="C\gg B" display="inline"><semantics id="S3.SS2.p4.6.m6.1a"><mrow id="S3.SS2.p4.6.m6.1.1" xref="S3.SS2.p4.6.m6.1.1.cmml"><mi id="S3.SS2.p4.6.m6.1.1.2" xref="S3.SS2.p4.6.m6.1.1.2.cmml">C</mi><mo id="S3.SS2.p4.6.m6.1.1.1" xref="S3.SS2.p4.6.m6.1.1.1.cmml">≫</mo><mi id="S3.SS2.p4.6.m6.1.1.3" xref="S3.SS2.p4.6.m6.1.1.3.cmml">B</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.6.m6.1b"><apply id="S3.SS2.p4.6.m6.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1"><csymbol cd="latexml" id="S3.SS2.p4.6.m6.1.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1.1">much-greater-than</csymbol><ci id="S3.SS2.p4.6.m6.1.1.2.cmml" xref="S3.SS2.p4.6.m6.1.1.2">𝐶</ci><ci id="S3.SS2.p4.6.m6.1.1.3.cmml" xref="S3.SS2.p4.6.m6.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.6.m6.1c">C\gg B</annotation></semantics></math> ).</p>
</div>
<figure id="S3.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S3.F1.1" class="ltx_figure ltx_figure_panel"><img src="/html/2204.12495/assets/x1.png" id="S3.F1.1.g1" class="ltx_graphics ltx_img_landscape" width="146" height="107" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S3.F1.2" class="ltx_figure ltx_figure_panel"><img src="/html/2204.12495/assets/x2.png" id="S3.F1.2.g1" class="ltx_graphics ltx_img_landscape" width="146" height="107" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S3.F1.3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2204.12495/assets/x3.png" id="S3.F1.3.g1" class="ltx_graphics ltx_img_landscape" width="166" height="122" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Log error on direct inversion on input batch for linear dense layer. We calculate the approximation of Eq. (<a href="#S3.E8" title="In 3.2 Direct inversion of a full batch ‣ 3 Gradient mixing as a batch defense strategy ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>) in 2 histograms for an untrained model. The case of drawing similar labels (red), and drawing unique labels in the batch (blue). (a) for MNIST (C=10), (b) for LFW dataset (C=5749), and (c) for batch size of 8 drawing unique labels, comparing LFW (blue) and MNIST (red).</figcaption>
</figure>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.4" class="ltx_p">Figure <a href="#S3.F1" title="Figure 1 ‣ 3.2 Direct inversion of a full batch ‣ 3 Gradient mixing as a batch defense strategy ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(a)-(c) shows our estimates to direct invert the input of a dense layer from a vector batch, and the ability to infer all inputs of a batch in a dense layer. It supports that inverting the 2-8 vectors is likely to be possible with a very small error, as long as labels are unique. In the case of the LFW dataset, due to the large <math id="S3.SS2.p5.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS2.p5.1.m1.1a"><mi id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><ci id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">C</annotation></semantics></math>, the error is inversely proportional to <math id="S3.SS2.p5.2.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS2.p5.2.m2.1a"><mi id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b"><ci id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">C</annotation></semantics></math>, so the two vectors in the batch are recovered for all random samples tested with a very low error. This low error is obtained so long as the vectors have a unique class, given <math id="S3.SS2.p5.3.m3.1" class="ltx_Math" alttext="C\gg B" display="inline"><semantics id="S3.SS2.p5.3.m3.1a"><mrow id="S3.SS2.p5.3.m3.1.1" xref="S3.SS2.p5.3.m3.1.1.cmml"><mi id="S3.SS2.p5.3.m3.1.1.2" xref="S3.SS2.p5.3.m3.1.1.2.cmml">C</mi><mo id="S3.SS2.p5.3.m3.1.1.1" xref="S3.SS2.p5.3.m3.1.1.1.cmml">≫</mo><mi id="S3.SS2.p5.3.m3.1.1.3" xref="S3.SS2.p5.3.m3.1.1.3.cmml">B</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m3.1b"><apply id="S3.SS2.p5.3.m3.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1"><csymbol cd="latexml" id="S3.SS2.p5.3.m3.1.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1.1">much-greater-than</csymbol><ci id="S3.SS2.p5.3.m3.1.1.2.cmml" xref="S3.SS2.p5.3.m3.1.1.2">𝐶</ci><ci id="S3.SS2.p5.3.m3.1.1.3.cmml" xref="S3.SS2.p5.3.m3.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.3.m3.1c">C\gg B</annotation></semantics></math>, which is the case for the LFW classification network with much larger batch sizes (e.g. <math id="S3.SS2.p5.4.m4.1" class="ltx_math_unparsed" alttext="B\gg 8)" display="inline"><semantics id="S3.SS2.p5.4.m4.1a"><mrow id="S3.SS2.p5.4.m4.1b"><mi id="S3.SS2.p5.4.m4.1.1">B</mi><mo id="S3.SS2.p5.4.m4.1.2">≫</mo><mn id="S3.SS2.p5.4.m4.1.3">8</mn><mo stretchy="false" id="S3.SS2.p5.4.m4.1.4">)</mo></mrow><annotation encoding="application/x-tex" id="S3.SS2.p5.4.m4.1c">B\gg 8)</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p6" class="ltx_para">
<p id="S3.SS2.p6.5" class="ltx_p">The de-mixing property of cross-entropy is not only helpful for estimating input without numerical optimisation, but also allows simple numerical convergence as the dimensionality for searching a solution is effectively reduced. This can be inferred from Eq. (<a href="#S3.E8" title="In 3.2 Direct inversion of a full batch ‣ 3 Gradient mixing as a batch defense strategy ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>). If for a given <math id="S3.SS2.p6.1.m1.1" class="ltx_Math" alttext="j=c" display="inline"><semantics id="S3.SS2.p6.1.m1.1a"><mrow id="S3.SS2.p6.1.m1.1.1" xref="S3.SS2.p6.1.m1.1.1.cmml"><mi id="S3.SS2.p6.1.m1.1.1.2" xref="S3.SS2.p6.1.m1.1.1.2.cmml">j</mi><mo id="S3.SS2.p6.1.m1.1.1.1" xref="S3.SS2.p6.1.m1.1.1.1.cmml">=</mo><mi id="S3.SS2.p6.1.m1.1.1.3" xref="S3.SS2.p6.1.m1.1.1.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.1.m1.1b"><apply id="S3.SS2.p6.1.m1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1"><eq id="S3.SS2.p6.1.m1.1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1.1"></eq><ci id="S3.SS2.p6.1.m1.1.1.2.cmml" xref="S3.SS2.p6.1.m1.1.1.2">𝑗</ci><ci id="S3.SS2.p6.1.m1.1.1.3.cmml" xref="S3.SS2.p6.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.1.m1.1c">j=c</annotation></semantics></math>, <math id="S3.SS2.p6.2.m2.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="S3.SS2.p6.2.m2.1a"><msub id="S3.SS2.p6.2.m2.1.1" xref="S3.SS2.p6.2.m2.1.1.cmml"><mi id="S3.SS2.p6.2.m2.1.1.2" xref="S3.SS2.p6.2.m2.1.1.2.cmml">x</mi><mi id="S3.SS2.p6.2.m2.1.1.3" xref="S3.SS2.p6.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.2.m2.1b"><apply id="S3.SS2.p6.2.m2.1.1.cmml" xref="S3.SS2.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p6.2.m2.1.1.1.cmml" xref="S3.SS2.p6.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p6.2.m2.1.1.2.cmml" xref="S3.SS2.p6.2.m2.1.1.2">𝑥</ci><ci id="S3.SS2.p6.2.m2.1.1.3.cmml" xref="S3.SS2.p6.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.2.m2.1c">x_{i}</annotation></semantics></math> only belongs to a single <math id="S3.SS2.p6.3.m3.1" class="ltx_Math" alttext="m=M" display="inline"><semantics id="S3.SS2.p6.3.m3.1a"><mrow id="S3.SS2.p6.3.m3.1.1" xref="S3.SS2.p6.3.m3.1.1.cmml"><mi id="S3.SS2.p6.3.m3.1.1.2" xref="S3.SS2.p6.3.m3.1.1.2.cmml">m</mi><mo id="S3.SS2.p6.3.m3.1.1.1" xref="S3.SS2.p6.3.m3.1.1.1.cmml">=</mo><mi id="S3.SS2.p6.3.m3.1.1.3" xref="S3.SS2.p6.3.m3.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.3.m3.1b"><apply id="S3.SS2.p6.3.m3.1.1.cmml" xref="S3.SS2.p6.3.m3.1.1"><eq id="S3.SS2.p6.3.m3.1.1.1.cmml" xref="S3.SS2.p6.3.m3.1.1.1"></eq><ci id="S3.SS2.p6.3.m3.1.1.2.cmml" xref="S3.SS2.p6.3.m3.1.1.2">𝑚</ci><ci id="S3.SS2.p6.3.m3.1.1.3.cmml" xref="S3.SS2.p6.3.m3.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.3.m3.1c">m=M</annotation></semantics></math>, the search is constrained to a one dimension parabola (in the case of a squared distance objective function), as other <math id="S3.SS2.p6.4.m4.1" class="ltx_Math" alttext="m\neq M" display="inline"><semantics id="S3.SS2.p6.4.m4.1a"><mrow id="S3.SS2.p6.4.m4.1.1" xref="S3.SS2.p6.4.m4.1.1.cmml"><mi id="S3.SS2.p6.4.m4.1.1.2" xref="S3.SS2.p6.4.m4.1.1.2.cmml">m</mi><mo id="S3.SS2.p6.4.m4.1.1.1" xref="S3.SS2.p6.4.m4.1.1.1.cmml">≠</mo><mi id="S3.SS2.p6.4.m4.1.1.3" xref="S3.SS2.p6.4.m4.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.4.m4.1b"><apply id="S3.SS2.p6.4.m4.1.1.cmml" xref="S3.SS2.p6.4.m4.1.1"><neq id="S3.SS2.p6.4.m4.1.1.1.cmml" xref="S3.SS2.p6.4.m4.1.1.1"></neq><ci id="S3.SS2.p6.4.m4.1.1.2.cmml" xref="S3.SS2.p6.4.m4.1.1.2">𝑚</ci><ci id="S3.SS2.p6.4.m4.1.1.3.cmml" xref="S3.SS2.p6.4.m4.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.4.m4.1c">m\neq M</annotation></semantics></math> will not influence the right term in Eq. (<a href="#S3.E8" title="In 3.2 Direct inversion of a full batch ‣ 3 Gradient mixing as a batch defense strategy ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>). Yet, once we draw similar labels in the batch the recovery of data exhibits a large error, and the error is within the order of magnitude of the information (<math id="S3.SS2.p6.5.m5.1" class="ltx_Math" alttext="\propto x_{i}" display="inline"><semantics id="S3.SS2.p6.5.m5.1a"><mrow id="S3.SS2.p6.5.m5.1.1" xref="S3.SS2.p6.5.m5.1.1.cmml"><mi id="S3.SS2.p6.5.m5.1.1.2" xref="S3.SS2.p6.5.m5.1.1.2.cmml"></mi><mo id="S3.SS2.p6.5.m5.1.1.1" xref="S3.SS2.p6.5.m5.1.1.1.cmml">∝</mo><msub id="S3.SS2.p6.5.m5.1.1.3" xref="S3.SS2.p6.5.m5.1.1.3.cmml"><mi id="S3.SS2.p6.5.m5.1.1.3.2" xref="S3.SS2.p6.5.m5.1.1.3.2.cmml">x</mi><mi id="S3.SS2.p6.5.m5.1.1.3.3" xref="S3.SS2.p6.5.m5.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.5.m5.1b"><apply id="S3.SS2.p6.5.m5.1.1.cmml" xref="S3.SS2.p6.5.m5.1.1"><csymbol cd="latexml" id="S3.SS2.p6.5.m5.1.1.1.cmml" xref="S3.SS2.p6.5.m5.1.1.1">proportional-to</csymbol><csymbol cd="latexml" id="S3.SS2.p6.5.m5.1.1.2.cmml" xref="S3.SS2.p6.5.m5.1.1.2">absent</csymbol><apply id="S3.SS2.p6.5.m5.1.1.3.cmml" xref="S3.SS2.p6.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p6.5.m5.1.1.3.1.cmml" xref="S3.SS2.p6.5.m5.1.1.3">subscript</csymbol><ci id="S3.SS2.p6.5.m5.1.1.3.2.cmml" xref="S3.SS2.p6.5.m5.1.1.3.2">𝑥</ci><ci id="S3.SS2.p6.5.m5.1.1.3.3.cmml" xref="S3.SS2.p6.5.m5.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.5.m5.1c">\propto x_{i}</annotation></semantics></math>). This mixing of gradients can serve as a strategy to increase privacy in FL against direct inversion and our results in section <a href="#S4.SS1" title="4.1 Inversion Attack Optimisation Algorithms ‣ 4 Experimental framework ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a> show that the strategy is also effective against numerical optimisation attacks.</p>
</div>
<div id="S3.SS2.p7" class="ltx_para">
<p id="S3.SS2.p7.1" class="ltx_p">Following this insight, we can also consider changing the objective function to mix the gradients. Instead of using cross-entropy loss (CEL), it is possible to use the mean squared loss (MSE), <math id="S3.SS2.p7.1.m1.3" class="ltx_Math" alttext="l_{2}(o,y)=-\sum_{k}^{C}{(y_{k}-o_{k})}^{2}" display="inline"><semantics id="S3.SS2.p7.1.m1.3a"><mrow id="S3.SS2.p7.1.m1.3.3" xref="S3.SS2.p7.1.m1.3.3.cmml"><mrow id="S3.SS2.p7.1.m1.3.3.3" xref="S3.SS2.p7.1.m1.3.3.3.cmml"><msub id="S3.SS2.p7.1.m1.3.3.3.2" xref="S3.SS2.p7.1.m1.3.3.3.2.cmml"><mi id="S3.SS2.p7.1.m1.3.3.3.2.2" xref="S3.SS2.p7.1.m1.3.3.3.2.2.cmml">l</mi><mn id="S3.SS2.p7.1.m1.3.3.3.2.3" xref="S3.SS2.p7.1.m1.3.3.3.2.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p7.1.m1.3.3.3.1" xref="S3.SS2.p7.1.m1.3.3.3.1.cmml">​</mo><mrow id="S3.SS2.p7.1.m1.3.3.3.3.2" xref="S3.SS2.p7.1.m1.3.3.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.p7.1.m1.3.3.3.3.2.1" xref="S3.SS2.p7.1.m1.3.3.3.3.1.cmml">(</mo><mi id="S3.SS2.p7.1.m1.1.1" xref="S3.SS2.p7.1.m1.1.1.cmml">o</mi><mo id="S3.SS2.p7.1.m1.3.3.3.3.2.2" xref="S3.SS2.p7.1.m1.3.3.3.3.1.cmml">,</mo><mi id="S3.SS2.p7.1.m1.2.2" xref="S3.SS2.p7.1.m1.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS2.p7.1.m1.3.3.3.3.2.3" xref="S3.SS2.p7.1.m1.3.3.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p7.1.m1.3.3.2" xref="S3.SS2.p7.1.m1.3.3.2.cmml">=</mo><mrow id="S3.SS2.p7.1.m1.3.3.1" xref="S3.SS2.p7.1.m1.3.3.1.cmml"><mo id="S3.SS2.p7.1.m1.3.3.1a" xref="S3.SS2.p7.1.m1.3.3.1.cmml">−</mo><mrow id="S3.SS2.p7.1.m1.3.3.1.1" xref="S3.SS2.p7.1.m1.3.3.1.1.cmml"><msubsup id="S3.SS2.p7.1.m1.3.3.1.1.2" xref="S3.SS2.p7.1.m1.3.3.1.1.2.cmml"><mo rspace="0em" id="S3.SS2.p7.1.m1.3.3.1.1.2.2.2" xref="S3.SS2.p7.1.m1.3.3.1.1.2.2.2.cmml">∑</mo><mi id="S3.SS2.p7.1.m1.3.3.1.1.2.2.3" xref="S3.SS2.p7.1.m1.3.3.1.1.2.2.3.cmml">k</mi><mi id="S3.SS2.p7.1.m1.3.3.1.1.2.3" xref="S3.SS2.p7.1.m1.3.3.1.1.2.3.cmml">C</mi></msubsup><msup id="S3.SS2.p7.1.m1.3.3.1.1.1" xref="S3.SS2.p7.1.m1.3.3.1.1.1.cmml"><mrow id="S3.SS2.p7.1.m1.3.3.1.1.1.1.1" xref="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.2" xref="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1" xref="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.cmml"><msub id="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.2" xref="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.2.3" xref="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.2.3.cmml">k</mi></msub><mo id="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.1" xref="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.3" xref="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.3.2" xref="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.3.2.cmml">o</mi><mi id="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.3.3" xref="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo stretchy="false" id="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.3" xref="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.SS2.p7.1.m1.3.3.1.1.1.3" xref="S3.SS2.p7.1.m1.3.3.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.1.m1.3b"><apply id="S3.SS2.p7.1.m1.3.3.cmml" xref="S3.SS2.p7.1.m1.3.3"><eq id="S3.SS2.p7.1.m1.3.3.2.cmml" xref="S3.SS2.p7.1.m1.3.3.2"></eq><apply id="S3.SS2.p7.1.m1.3.3.3.cmml" xref="S3.SS2.p7.1.m1.3.3.3"><times id="S3.SS2.p7.1.m1.3.3.3.1.cmml" xref="S3.SS2.p7.1.m1.3.3.3.1"></times><apply id="S3.SS2.p7.1.m1.3.3.3.2.cmml" xref="S3.SS2.p7.1.m1.3.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p7.1.m1.3.3.3.2.1.cmml" xref="S3.SS2.p7.1.m1.3.3.3.2">subscript</csymbol><ci id="S3.SS2.p7.1.m1.3.3.3.2.2.cmml" xref="S3.SS2.p7.1.m1.3.3.3.2.2">𝑙</ci><cn type="integer" id="S3.SS2.p7.1.m1.3.3.3.2.3.cmml" xref="S3.SS2.p7.1.m1.3.3.3.2.3">2</cn></apply><interval closure="open" id="S3.SS2.p7.1.m1.3.3.3.3.1.cmml" xref="S3.SS2.p7.1.m1.3.3.3.3.2"><ci id="S3.SS2.p7.1.m1.1.1.cmml" xref="S3.SS2.p7.1.m1.1.1">𝑜</ci><ci id="S3.SS2.p7.1.m1.2.2.cmml" xref="S3.SS2.p7.1.m1.2.2">𝑦</ci></interval></apply><apply id="S3.SS2.p7.1.m1.3.3.1.cmml" xref="S3.SS2.p7.1.m1.3.3.1"><minus id="S3.SS2.p7.1.m1.3.3.1.2.cmml" xref="S3.SS2.p7.1.m1.3.3.1"></minus><apply id="S3.SS2.p7.1.m1.3.3.1.1.cmml" xref="S3.SS2.p7.1.m1.3.3.1.1"><apply id="S3.SS2.p7.1.m1.3.3.1.1.2.cmml" xref="S3.SS2.p7.1.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p7.1.m1.3.3.1.1.2.1.cmml" xref="S3.SS2.p7.1.m1.3.3.1.1.2">superscript</csymbol><apply id="S3.SS2.p7.1.m1.3.3.1.1.2.2.cmml" xref="S3.SS2.p7.1.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p7.1.m1.3.3.1.1.2.2.1.cmml" xref="S3.SS2.p7.1.m1.3.3.1.1.2">subscript</csymbol><sum id="S3.SS2.p7.1.m1.3.3.1.1.2.2.2.cmml" xref="S3.SS2.p7.1.m1.3.3.1.1.2.2.2"></sum><ci id="S3.SS2.p7.1.m1.3.3.1.1.2.2.3.cmml" xref="S3.SS2.p7.1.m1.3.3.1.1.2.2.3">𝑘</ci></apply><ci id="S3.SS2.p7.1.m1.3.3.1.1.2.3.cmml" xref="S3.SS2.p7.1.m1.3.3.1.1.2.3">𝐶</ci></apply><apply id="S3.SS2.p7.1.m1.3.3.1.1.1.cmml" xref="S3.SS2.p7.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p7.1.m1.3.3.1.1.1.2.cmml" xref="S3.SS2.p7.1.m1.3.3.1.1.1">superscript</csymbol><apply id="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.SS2.p7.1.m1.3.3.1.1.1.1.1"><minus id="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.1"></minus><apply id="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.3.2">𝑜</ci><ci id="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p7.1.m1.3.3.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply><cn type="integer" id="S3.SS2.p7.1.m1.3.3.1.1.1.3.cmml" xref="S3.SS2.p7.1.m1.3.3.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.1.m1.3c">l_{2}(o,y)=-\sum_{k}^{C}{(y_{k}-o_{k})}^{2}</annotation></semantics></math>. This is not a typical choice for a classification task, but performance results show later that there is little to an unnoticeable degradation in classification performance when using MSE instead of CEL. On the contrary, there is a large gain in privacy by the high mixing of gradients on the dense layer. The gradients are calculated on a dense layer using mean square estimation (for simplicity with no softmax):</p>
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E9.m1.3" class="ltx_Math" alttext="\frac{\partial{l_{2}}}{\partial w_{i,j=k}}=\frac{\partial{l_{2}}}{\partial{o_{k}}}\frac{\partial{o_{k}}}{\partial{w_{i}}}=-2(o_{j}-y_{j})x_{i}" display="block"><semantics id="S3.E9.m1.3a"><mrow id="S3.E9.m1.3.3" xref="S3.E9.m1.3.3.cmml"><mfrac id="S3.E9.m1.2.2" xref="S3.E9.m1.2.2.cmml"><mrow id="S3.E9.m1.2.2.4" xref="S3.E9.m1.2.2.4.cmml"><mo rspace="0em" id="S3.E9.m1.2.2.4.1" xref="S3.E9.m1.2.2.4.1.cmml">∂</mo><msub id="S3.E9.m1.2.2.4.2" xref="S3.E9.m1.2.2.4.2.cmml"><mi id="S3.E9.m1.2.2.4.2.2" xref="S3.E9.m1.2.2.4.2.2.cmml">l</mi><mn id="S3.E9.m1.2.2.4.2.3" xref="S3.E9.m1.2.2.4.2.3.cmml">2</mn></msub></mrow><mrow id="S3.E9.m1.2.2.2" xref="S3.E9.m1.2.2.2.cmml"><mo rspace="0em" id="S3.E9.m1.2.2.2.3" xref="S3.E9.m1.2.2.2.3.cmml">∂</mo><msub id="S3.E9.m1.2.2.2.4" xref="S3.E9.m1.2.2.2.4.cmml"><mi id="S3.E9.m1.2.2.2.4.2" xref="S3.E9.m1.2.2.2.4.2.cmml">w</mi><mrow id="S3.E9.m1.2.2.2.2.2" xref="S3.E9.m1.2.2.2.2.2.cmml"><mrow id="S3.E9.m1.2.2.2.2.2.4.2" xref="S3.E9.m1.2.2.2.2.2.4.1.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.cmml">i</mi><mo id="S3.E9.m1.2.2.2.2.2.4.2.1" xref="S3.E9.m1.2.2.2.2.2.4.1.cmml">,</mo><mi id="S3.E9.m1.2.2.2.2.2.2" xref="S3.E9.m1.2.2.2.2.2.2.cmml">j</mi></mrow><mo id="S3.E9.m1.2.2.2.2.2.3" xref="S3.E9.m1.2.2.2.2.2.3.cmml">=</mo><mi id="S3.E9.m1.2.2.2.2.2.5" xref="S3.E9.m1.2.2.2.2.2.5.cmml">k</mi></mrow></msub></mrow></mfrac><mo id="S3.E9.m1.3.3.3" xref="S3.E9.m1.3.3.3.cmml">=</mo><mrow id="S3.E9.m1.3.3.4" xref="S3.E9.m1.3.3.4.cmml"><mfrac id="S3.E9.m1.3.3.4.2" xref="S3.E9.m1.3.3.4.2.cmml"><mrow id="S3.E9.m1.3.3.4.2.2" xref="S3.E9.m1.3.3.4.2.2.cmml"><mo rspace="0em" id="S3.E9.m1.3.3.4.2.2.1" xref="S3.E9.m1.3.3.4.2.2.1.cmml">∂</mo><msub id="S3.E9.m1.3.3.4.2.2.2" xref="S3.E9.m1.3.3.4.2.2.2.cmml"><mi id="S3.E9.m1.3.3.4.2.2.2.2" xref="S3.E9.m1.3.3.4.2.2.2.2.cmml">l</mi><mn id="S3.E9.m1.3.3.4.2.2.2.3" xref="S3.E9.m1.3.3.4.2.2.2.3.cmml">2</mn></msub></mrow><mrow id="S3.E9.m1.3.3.4.2.3" xref="S3.E9.m1.3.3.4.2.3.cmml"><mo rspace="0em" id="S3.E9.m1.3.3.4.2.3.1" xref="S3.E9.m1.3.3.4.2.3.1.cmml">∂</mo><msub id="S3.E9.m1.3.3.4.2.3.2" xref="S3.E9.m1.3.3.4.2.3.2.cmml"><mi id="S3.E9.m1.3.3.4.2.3.2.2" xref="S3.E9.m1.3.3.4.2.3.2.2.cmml">o</mi><mi id="S3.E9.m1.3.3.4.2.3.2.3" xref="S3.E9.m1.3.3.4.2.3.2.3.cmml">k</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E9.m1.3.3.4.1" xref="S3.E9.m1.3.3.4.1.cmml">​</mo><mfrac id="S3.E9.m1.3.3.4.3" xref="S3.E9.m1.3.3.4.3.cmml"><mrow id="S3.E9.m1.3.3.4.3.2" xref="S3.E9.m1.3.3.4.3.2.cmml"><mo rspace="0em" id="S3.E9.m1.3.3.4.3.2.1" xref="S3.E9.m1.3.3.4.3.2.1.cmml">∂</mo><msub id="S3.E9.m1.3.3.4.3.2.2" xref="S3.E9.m1.3.3.4.3.2.2.cmml"><mi id="S3.E9.m1.3.3.4.3.2.2.2" xref="S3.E9.m1.3.3.4.3.2.2.2.cmml">o</mi><mi id="S3.E9.m1.3.3.4.3.2.2.3" xref="S3.E9.m1.3.3.4.3.2.2.3.cmml">k</mi></msub></mrow><mrow id="S3.E9.m1.3.3.4.3.3" xref="S3.E9.m1.3.3.4.3.3.cmml"><mo rspace="0em" id="S3.E9.m1.3.3.4.3.3.1" xref="S3.E9.m1.3.3.4.3.3.1.cmml">∂</mo><msub id="S3.E9.m1.3.3.4.3.3.2" xref="S3.E9.m1.3.3.4.3.3.2.cmml"><mi id="S3.E9.m1.3.3.4.3.3.2.2" xref="S3.E9.m1.3.3.4.3.3.2.2.cmml">w</mi><mi id="S3.E9.m1.3.3.4.3.3.2.3" xref="S3.E9.m1.3.3.4.3.3.2.3.cmml">i</mi></msub></mrow></mfrac></mrow><mo id="S3.E9.m1.3.3.5" xref="S3.E9.m1.3.3.5.cmml">=</mo><mrow id="S3.E9.m1.3.3.1" xref="S3.E9.m1.3.3.1.cmml"><mo id="S3.E9.m1.3.3.1a" xref="S3.E9.m1.3.3.1.cmml">−</mo><mrow id="S3.E9.m1.3.3.1.1" xref="S3.E9.m1.3.3.1.1.cmml"><mn id="S3.E9.m1.3.3.1.1.3" xref="S3.E9.m1.3.3.1.1.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E9.m1.3.3.1.1.2" xref="S3.E9.m1.3.3.1.1.2.cmml">​</mo><mrow id="S3.E9.m1.3.3.1.1.1.1" xref="S3.E9.m1.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.3.3.1.1.1.1.2" xref="S3.E9.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.3.3.1.1.1.1.1" xref="S3.E9.m1.3.3.1.1.1.1.1.cmml"><msub id="S3.E9.m1.3.3.1.1.1.1.1.2" xref="S3.E9.m1.3.3.1.1.1.1.1.2.cmml"><mi id="S3.E9.m1.3.3.1.1.1.1.1.2.2" xref="S3.E9.m1.3.3.1.1.1.1.1.2.2.cmml">o</mi><mi id="S3.E9.m1.3.3.1.1.1.1.1.2.3" xref="S3.E9.m1.3.3.1.1.1.1.1.2.3.cmml">j</mi></msub><mo id="S3.E9.m1.3.3.1.1.1.1.1.1" xref="S3.E9.m1.3.3.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E9.m1.3.3.1.1.1.1.1.3" xref="S3.E9.m1.3.3.1.1.1.1.1.3.cmml"><mi id="S3.E9.m1.3.3.1.1.1.1.1.3.2" xref="S3.E9.m1.3.3.1.1.1.1.1.3.2.cmml">y</mi><mi id="S3.E9.m1.3.3.1.1.1.1.1.3.3" xref="S3.E9.m1.3.3.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S3.E9.m1.3.3.1.1.1.1.3" xref="S3.E9.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E9.m1.3.3.1.1.2a" xref="S3.E9.m1.3.3.1.1.2.cmml">​</mo><msub id="S3.E9.m1.3.3.1.1.4" xref="S3.E9.m1.3.3.1.1.4.cmml"><mi id="S3.E9.m1.3.3.1.1.4.2" xref="S3.E9.m1.3.3.1.1.4.2.cmml">x</mi><mi id="S3.E9.m1.3.3.1.1.4.3" xref="S3.E9.m1.3.3.1.1.4.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.3b"><apply id="S3.E9.m1.3.3.cmml" xref="S3.E9.m1.3.3"><and id="S3.E9.m1.3.3a.cmml" xref="S3.E9.m1.3.3"></and><apply id="S3.E9.m1.3.3b.cmml" xref="S3.E9.m1.3.3"><eq id="S3.E9.m1.3.3.3.cmml" xref="S3.E9.m1.3.3.3"></eq><apply id="S3.E9.m1.2.2.cmml" xref="S3.E9.m1.2.2"><divide id="S3.E9.m1.2.2.3.cmml" xref="S3.E9.m1.2.2"></divide><apply id="S3.E9.m1.2.2.4.cmml" xref="S3.E9.m1.2.2.4"><partialdiff id="S3.E9.m1.2.2.4.1.cmml" xref="S3.E9.m1.2.2.4.1"></partialdiff><apply id="S3.E9.m1.2.2.4.2.cmml" xref="S3.E9.m1.2.2.4.2"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.4.2.1.cmml" xref="S3.E9.m1.2.2.4.2">subscript</csymbol><ci id="S3.E9.m1.2.2.4.2.2.cmml" xref="S3.E9.m1.2.2.4.2.2">𝑙</ci><cn type="integer" id="S3.E9.m1.2.2.4.2.3.cmml" xref="S3.E9.m1.2.2.4.2.3">2</cn></apply></apply><apply id="S3.E9.m1.2.2.2.cmml" xref="S3.E9.m1.2.2.2"><partialdiff id="S3.E9.m1.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.3"></partialdiff><apply id="S3.E9.m1.2.2.2.4.cmml" xref="S3.E9.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.4.1.cmml" xref="S3.E9.m1.2.2.2.4">subscript</csymbol><ci id="S3.E9.m1.2.2.2.4.2.cmml" xref="S3.E9.m1.2.2.2.4.2">𝑤</ci><apply id="S3.E9.m1.2.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2.2"><eq id="S3.E9.m1.2.2.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.2.2.3"></eq><list id="S3.E9.m1.2.2.2.2.2.4.1.cmml" xref="S3.E9.m1.2.2.2.2.2.4.2"><ci id="S3.E9.m1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1">𝑖</ci><ci id="S3.E9.m1.2.2.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2.2.2">𝑗</ci></list><ci id="S3.E9.m1.2.2.2.2.2.5.cmml" xref="S3.E9.m1.2.2.2.2.2.5">𝑘</ci></apply></apply></apply></apply><apply id="S3.E9.m1.3.3.4.cmml" xref="S3.E9.m1.3.3.4"><times id="S3.E9.m1.3.3.4.1.cmml" xref="S3.E9.m1.3.3.4.1"></times><apply id="S3.E9.m1.3.3.4.2.cmml" xref="S3.E9.m1.3.3.4.2"><divide id="S3.E9.m1.3.3.4.2.1.cmml" xref="S3.E9.m1.3.3.4.2"></divide><apply id="S3.E9.m1.3.3.4.2.2.cmml" xref="S3.E9.m1.3.3.4.2.2"><partialdiff id="S3.E9.m1.3.3.4.2.2.1.cmml" xref="S3.E9.m1.3.3.4.2.2.1"></partialdiff><apply id="S3.E9.m1.3.3.4.2.2.2.cmml" xref="S3.E9.m1.3.3.4.2.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.4.2.2.2.1.cmml" xref="S3.E9.m1.3.3.4.2.2.2">subscript</csymbol><ci id="S3.E9.m1.3.3.4.2.2.2.2.cmml" xref="S3.E9.m1.3.3.4.2.2.2.2">𝑙</ci><cn type="integer" id="S3.E9.m1.3.3.4.2.2.2.3.cmml" xref="S3.E9.m1.3.3.4.2.2.2.3">2</cn></apply></apply><apply id="S3.E9.m1.3.3.4.2.3.cmml" xref="S3.E9.m1.3.3.4.2.3"><partialdiff id="S3.E9.m1.3.3.4.2.3.1.cmml" xref="S3.E9.m1.3.3.4.2.3.1"></partialdiff><apply id="S3.E9.m1.3.3.4.2.3.2.cmml" xref="S3.E9.m1.3.3.4.2.3.2"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.4.2.3.2.1.cmml" xref="S3.E9.m1.3.3.4.2.3.2">subscript</csymbol><ci id="S3.E9.m1.3.3.4.2.3.2.2.cmml" xref="S3.E9.m1.3.3.4.2.3.2.2">𝑜</ci><ci id="S3.E9.m1.3.3.4.2.3.2.3.cmml" xref="S3.E9.m1.3.3.4.2.3.2.3">𝑘</ci></apply></apply></apply><apply id="S3.E9.m1.3.3.4.3.cmml" xref="S3.E9.m1.3.3.4.3"><divide id="S3.E9.m1.3.3.4.3.1.cmml" xref="S3.E9.m1.3.3.4.3"></divide><apply id="S3.E9.m1.3.3.4.3.2.cmml" xref="S3.E9.m1.3.3.4.3.2"><partialdiff id="S3.E9.m1.3.3.4.3.2.1.cmml" xref="S3.E9.m1.3.3.4.3.2.1"></partialdiff><apply id="S3.E9.m1.3.3.4.3.2.2.cmml" xref="S3.E9.m1.3.3.4.3.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.4.3.2.2.1.cmml" xref="S3.E9.m1.3.3.4.3.2.2">subscript</csymbol><ci id="S3.E9.m1.3.3.4.3.2.2.2.cmml" xref="S3.E9.m1.3.3.4.3.2.2.2">𝑜</ci><ci id="S3.E9.m1.3.3.4.3.2.2.3.cmml" xref="S3.E9.m1.3.3.4.3.2.2.3">𝑘</ci></apply></apply><apply id="S3.E9.m1.3.3.4.3.3.cmml" xref="S3.E9.m1.3.3.4.3.3"><partialdiff id="S3.E9.m1.3.3.4.3.3.1.cmml" xref="S3.E9.m1.3.3.4.3.3.1"></partialdiff><apply id="S3.E9.m1.3.3.4.3.3.2.cmml" xref="S3.E9.m1.3.3.4.3.3.2"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.4.3.3.2.1.cmml" xref="S3.E9.m1.3.3.4.3.3.2">subscript</csymbol><ci id="S3.E9.m1.3.3.4.3.3.2.2.cmml" xref="S3.E9.m1.3.3.4.3.3.2.2">𝑤</ci><ci id="S3.E9.m1.3.3.4.3.3.2.3.cmml" xref="S3.E9.m1.3.3.4.3.3.2.3">𝑖</ci></apply></apply></apply></apply></apply><apply id="S3.E9.m1.3.3c.cmml" xref="S3.E9.m1.3.3"><eq id="S3.E9.m1.3.3.5.cmml" xref="S3.E9.m1.3.3.5"></eq><share href="#S3.E9.m1.3.3.4.cmml" id="S3.E9.m1.3.3d.cmml" xref="S3.E9.m1.3.3"></share><apply id="S3.E9.m1.3.3.1.cmml" xref="S3.E9.m1.3.3.1"><minus id="S3.E9.m1.3.3.1.2.cmml" xref="S3.E9.m1.3.3.1"></minus><apply id="S3.E9.m1.3.3.1.1.cmml" xref="S3.E9.m1.3.3.1.1"><times id="S3.E9.m1.3.3.1.1.2.cmml" xref="S3.E9.m1.3.3.1.1.2"></times><cn type="integer" id="S3.E9.m1.3.3.1.1.3.cmml" xref="S3.E9.m1.3.3.1.1.3">2</cn><apply id="S3.E9.m1.3.3.1.1.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1"><minus id="S3.E9.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1"></minus><apply id="S3.E9.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E9.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.2.2">𝑜</ci><ci id="S3.E9.m1.3.3.1.1.1.1.1.2.3.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="S3.E9.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E9.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.3.2">𝑦</ci><ci id="S3.E9.m1.3.3.1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.3.3">𝑗</ci></apply></apply><apply id="S3.E9.m1.3.3.1.1.4.cmml" xref="S3.E9.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.4.1.cmml" xref="S3.E9.m1.3.3.1.1.4">subscript</csymbol><ci id="S3.E9.m1.3.3.1.1.4.2.cmml" xref="S3.E9.m1.3.3.1.1.4.2">𝑥</ci><ci id="S3.E9.m1.3.3.1.1.4.3.cmml" xref="S3.E9.m1.3.3.1.1.4.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.3c">\frac{\partial{l_{2}}}{\partial w_{i,j=k}}=\frac{\partial{l_{2}}}{\partial{o_{k}}}\frac{\partial{o_{k}}}{\partial{w_{i}}}=-2(o_{j}-y_{j})x_{i}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p7.7" class="ltx_p">and</p>
<table id="S3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E10.m1.1" class="ltx_Math" alttext="\frac{\partial{l_{2}}}{\partial b_{j=k}}=-2(o_{j}-y_{j})" display="block"><semantics id="S3.E10.m1.1a"><mrow id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml"><mfrac id="S3.E10.m1.1.1.3" xref="S3.E10.m1.1.1.3.cmml"><mrow id="S3.E10.m1.1.1.3.2" xref="S3.E10.m1.1.1.3.2.cmml"><mo rspace="0em" id="S3.E10.m1.1.1.3.2.1" xref="S3.E10.m1.1.1.3.2.1.cmml">∂</mo><msub id="S3.E10.m1.1.1.3.2.2" xref="S3.E10.m1.1.1.3.2.2.cmml"><mi id="S3.E10.m1.1.1.3.2.2.2" xref="S3.E10.m1.1.1.3.2.2.2.cmml">l</mi><mn id="S3.E10.m1.1.1.3.2.2.3" xref="S3.E10.m1.1.1.3.2.2.3.cmml">2</mn></msub></mrow><mrow id="S3.E10.m1.1.1.3.3" xref="S3.E10.m1.1.1.3.3.cmml"><mo rspace="0em" id="S3.E10.m1.1.1.3.3.1" xref="S3.E10.m1.1.1.3.3.1.cmml">∂</mo><msub id="S3.E10.m1.1.1.3.3.2" xref="S3.E10.m1.1.1.3.3.2.cmml"><mi id="S3.E10.m1.1.1.3.3.2.2" xref="S3.E10.m1.1.1.3.3.2.2.cmml">b</mi><mrow id="S3.E10.m1.1.1.3.3.2.3" xref="S3.E10.m1.1.1.3.3.2.3.cmml"><mi id="S3.E10.m1.1.1.3.3.2.3.2" xref="S3.E10.m1.1.1.3.3.2.3.2.cmml">j</mi><mo id="S3.E10.m1.1.1.3.3.2.3.1" xref="S3.E10.m1.1.1.3.3.2.3.1.cmml">=</mo><mi id="S3.E10.m1.1.1.3.3.2.3.3" xref="S3.E10.m1.1.1.3.3.2.3.3.cmml">k</mi></mrow></msub></mrow></mfrac><mo id="S3.E10.m1.1.1.2" xref="S3.E10.m1.1.1.2.cmml">=</mo><mrow id="S3.E10.m1.1.1.1" xref="S3.E10.m1.1.1.1.cmml"><mo id="S3.E10.m1.1.1.1a" xref="S3.E10.m1.1.1.1.cmml">−</mo><mrow id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml"><mn id="S3.E10.m1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E10.m1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E10.m1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E10.m1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.cmml"><msub id="S3.E10.m1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.1.2.2" xref="S3.E10.m1.1.1.1.1.1.1.1.2.2.cmml">o</mi><mi id="S3.E10.m1.1.1.1.1.1.1.1.2.3" xref="S3.E10.m1.1.1.1.1.1.1.1.2.3.cmml">j</mi></msub><mo id="S3.E10.m1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E10.m1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.1.3.2" xref="S3.E10.m1.1.1.1.1.1.1.1.3.2.cmml">y</mi><mi id="S3.E10.m1.1.1.1.1.1.1.1.3.3" xref="S3.E10.m1.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S3.E10.m1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.1b"><apply id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1"><eq id="S3.E10.m1.1.1.2.cmml" xref="S3.E10.m1.1.1.2"></eq><apply id="S3.E10.m1.1.1.3.cmml" xref="S3.E10.m1.1.1.3"><divide id="S3.E10.m1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.3"></divide><apply id="S3.E10.m1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.3.2"><partialdiff id="S3.E10.m1.1.1.3.2.1.cmml" xref="S3.E10.m1.1.1.3.2.1"></partialdiff><apply id="S3.E10.m1.1.1.3.2.2.cmml" xref="S3.E10.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.3.2.2.1.cmml" xref="S3.E10.m1.1.1.3.2.2">subscript</csymbol><ci id="S3.E10.m1.1.1.3.2.2.2.cmml" xref="S3.E10.m1.1.1.3.2.2.2">𝑙</ci><cn type="integer" id="S3.E10.m1.1.1.3.2.2.3.cmml" xref="S3.E10.m1.1.1.3.2.2.3">2</cn></apply></apply><apply id="S3.E10.m1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.3.3"><partialdiff id="S3.E10.m1.1.1.3.3.1.cmml" xref="S3.E10.m1.1.1.3.3.1"></partialdiff><apply id="S3.E10.m1.1.1.3.3.2.cmml" xref="S3.E10.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.3.3.2.1.cmml" xref="S3.E10.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.E10.m1.1.1.3.3.2.2.cmml" xref="S3.E10.m1.1.1.3.3.2.2">𝑏</ci><apply id="S3.E10.m1.1.1.3.3.2.3.cmml" xref="S3.E10.m1.1.1.3.3.2.3"><eq id="S3.E10.m1.1.1.3.3.2.3.1.cmml" xref="S3.E10.m1.1.1.3.3.2.3.1"></eq><ci id="S3.E10.m1.1.1.3.3.2.3.2.cmml" xref="S3.E10.m1.1.1.3.3.2.3.2">𝑗</ci><ci id="S3.E10.m1.1.1.3.3.2.3.3.cmml" xref="S3.E10.m1.1.1.3.3.2.3.3">𝑘</ci></apply></apply></apply></apply><apply id="S3.E10.m1.1.1.1.cmml" xref="S3.E10.m1.1.1.1"><minus id="S3.E10.m1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1"></minus><apply id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1"><times id="S3.E10.m1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.2"></times><cn type="integer" id="S3.E10.m1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.3">2</cn><apply id="S3.E10.m1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1"><minus id="S3.E10.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E10.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.2.2">𝑜</ci><ci id="S3.E10.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="S3.E10.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.3.2">𝑦</ci><ci id="S3.E10.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.1c">\frac{\partial{l_{2}}}{\partial b_{j=k}}=-2(o_{j}-y_{j})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p7.6" class="ltx_p">Here <math id="S3.SS2.p7.2.m1.1" class="ltx_Math" alttext="o_{j}" display="inline"><semantics id="S3.SS2.p7.2.m1.1a"><msub id="S3.SS2.p7.2.m1.1.1" xref="S3.SS2.p7.2.m1.1.1.cmml"><mi id="S3.SS2.p7.2.m1.1.1.2" xref="S3.SS2.p7.2.m1.1.1.2.cmml">o</mi><mi id="S3.SS2.p7.2.m1.1.1.3" xref="S3.SS2.p7.2.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.2.m1.1b"><apply id="S3.SS2.p7.2.m1.1.1.cmml" xref="S3.SS2.p7.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p7.2.m1.1.1.1.cmml" xref="S3.SS2.p7.2.m1.1.1">subscript</csymbol><ci id="S3.SS2.p7.2.m1.1.1.2.cmml" xref="S3.SS2.p7.2.m1.1.1.2">𝑜</ci><ci id="S3.SS2.p7.2.m1.1.1.3.cmml" xref="S3.SS2.p7.2.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.2.m1.1c">o_{j}</annotation></semantics></math> can take positive or negative values and generally within the order of <math id="S3.SS2.p7.3.m2.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS2.p7.3.m2.1a"><mi id="S3.SS2.p7.3.m2.1.1" xref="S3.SS2.p7.3.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.3.m2.1b"><ci id="S3.SS2.p7.3.m2.1.1.cmml" xref="S3.SS2.p7.3.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.3.m2.1c">y</annotation></semantics></math>, for <math id="S3.SS2.p7.4.m3.1" class="ltx_Math" alttext="j=c" display="inline"><semantics id="S3.SS2.p7.4.m3.1a"><mrow id="S3.SS2.p7.4.m3.1.1" xref="S3.SS2.p7.4.m3.1.1.cmml"><mi id="S3.SS2.p7.4.m3.1.1.2" xref="S3.SS2.p7.4.m3.1.1.2.cmml">j</mi><mo id="S3.SS2.p7.4.m3.1.1.1" xref="S3.SS2.p7.4.m3.1.1.1.cmml">=</mo><mi id="S3.SS2.p7.4.m3.1.1.3" xref="S3.SS2.p7.4.m3.1.1.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.4.m3.1b"><apply id="S3.SS2.p7.4.m3.1.1.cmml" xref="S3.SS2.p7.4.m3.1.1"><eq id="S3.SS2.p7.4.m3.1.1.1.cmml" xref="S3.SS2.p7.4.m3.1.1.1"></eq><ci id="S3.SS2.p7.4.m3.1.1.2.cmml" xref="S3.SS2.p7.4.m3.1.1.2">𝑗</ci><ci id="S3.SS2.p7.4.m3.1.1.3.cmml" xref="S3.SS2.p7.4.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.4.m3.1c">j=c</annotation></semantics></math> or <math id="S3.SS2.p7.5.m4.1" class="ltx_Math" alttext="j\neq c" display="inline"><semantics id="S3.SS2.p7.5.m4.1a"><mrow id="S3.SS2.p7.5.m4.1.1" xref="S3.SS2.p7.5.m4.1.1.cmml"><mi id="S3.SS2.p7.5.m4.1.1.2" xref="S3.SS2.p7.5.m4.1.1.2.cmml">j</mi><mo id="S3.SS2.p7.5.m4.1.1.1" xref="S3.SS2.p7.5.m4.1.1.1.cmml">≠</mo><mi id="S3.SS2.p7.5.m4.1.1.3" xref="S3.SS2.p7.5.m4.1.1.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.5.m4.1b"><apply id="S3.SS2.p7.5.m4.1.1.cmml" xref="S3.SS2.p7.5.m4.1.1"><neq id="S3.SS2.p7.5.m4.1.1.1.cmml" xref="S3.SS2.p7.5.m4.1.1.1"></neq><ci id="S3.SS2.p7.5.m4.1.1.2.cmml" xref="S3.SS2.p7.5.m4.1.1.2">𝑗</ci><ci id="S3.SS2.p7.5.m4.1.1.3.cmml" xref="S3.SS2.p7.5.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.5.m4.1c">j\neq c</annotation></semantics></math>, hence the average of a batch will not de-mix the gradients. Note that we are also using softmax followed by MSE for comparison, and the gradients will also obtain a strong gradient mixing (but a less trivial gradient expression).
We show in figure <a href="#S3.F2" title="Figure 2 ‣ 3.2 Direct inversion of a full batch ‣ 3 Gradient mixing as a batch defense strategy ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> a sample of results for the error on the direct inversion of a batch. We observe that the error on estimation of any vector using <math id="S3.SS2.p7.6.m5.1" class="ltx_Math" alttext="\frac{\partial w}{\partial b}" display="inline"><semantics id="S3.SS2.p7.6.m5.1a"><mfrac id="S3.SS2.p7.6.m5.1.1" xref="S3.SS2.p7.6.m5.1.1.cmml"><mrow id="S3.SS2.p7.6.m5.1.1.2" xref="S3.SS2.p7.6.m5.1.1.2.cmml"><mo rspace="0em" id="S3.SS2.p7.6.m5.1.1.2.1" xref="S3.SS2.p7.6.m5.1.1.2.1.cmml">∂</mo><mi id="S3.SS2.p7.6.m5.1.1.2.2" xref="S3.SS2.p7.6.m5.1.1.2.2.cmml">w</mi></mrow><mrow id="S3.SS2.p7.6.m5.1.1.3" xref="S3.SS2.p7.6.m5.1.1.3.cmml"><mo rspace="0em" id="S3.SS2.p7.6.m5.1.1.3.1" xref="S3.SS2.p7.6.m5.1.1.3.1.cmml">∂</mo><mi id="S3.SS2.p7.6.m5.1.1.3.2" xref="S3.SS2.p7.6.m5.1.1.3.2.cmml">b</mi></mrow></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.6.m5.1b"><apply id="S3.SS2.p7.6.m5.1.1.cmml" xref="S3.SS2.p7.6.m5.1.1"><divide id="S3.SS2.p7.6.m5.1.1.1.cmml" xref="S3.SS2.p7.6.m5.1.1"></divide><apply id="S3.SS2.p7.6.m5.1.1.2.cmml" xref="S3.SS2.p7.6.m5.1.1.2"><partialdiff id="S3.SS2.p7.6.m5.1.1.2.1.cmml" xref="S3.SS2.p7.6.m5.1.1.2.1"></partialdiff><ci id="S3.SS2.p7.6.m5.1.1.2.2.cmml" xref="S3.SS2.p7.6.m5.1.1.2.2">𝑤</ci></apply><apply id="S3.SS2.p7.6.m5.1.1.3.cmml" xref="S3.SS2.p7.6.m5.1.1.3"><partialdiff id="S3.SS2.p7.6.m5.1.1.3.1.cmml" xref="S3.SS2.p7.6.m5.1.1.3.1"></partialdiff><ci id="S3.SS2.p7.6.m5.1.1.3.2.cmml" xref="S3.SS2.p7.6.m5.1.1.3.2">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.6.m5.1c">\frac{\partial w}{\partial b}</annotation></semantics></math> is not negligible, and sufficiently large even in batch size of 2 and more distinctive in batch size of 8.</p>
</div>
<figure id="S3.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F2.1" class="ltx_figure ltx_figure_panel"><img src="/html/2204.12495/assets/x4.png" id="S3.F2.1.g1" class="ltx_graphics ltx_img_landscape" width="156" height="118" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F2.2" class="ltx_figure ltx_figure_panel"><img src="/html/2204.12495/assets/x5.png" id="S3.F2.2.g1" class="ltx_graphics ltx_img_landscape" width="156" height="118" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The error on direct inversion of single input in a linear dense layer in a batch. We calculate the approximation in Eq. (<a href="#S3.E8" title="In 3.2 Direct inversion of a full batch ‣ 3 Gradient mixing as a batch defense strategy ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>) and show the error in two histograms for an untrained model. The case of mean square error objective loss function (red histogram) compared to the cross entropy loss as generally used (both use softmax). Histogram (a) shows the result of minibatch size of 2, and histogram (b) for batch size of 8.</figcaption>
</figure>
<div id="S3.SS2.p8" class="ltx_para">
<p id="S3.SS2.p8.1" class="ltx_p">We see here that potentially drawing input with similar labels and adjusting the loss function to increase mixing of gradients are strategies that counter the recovery of input from dense layers. In fact, we can compare our result to the effectiveness of adding noise as a defensive strategy given its wide application. We add a Gaussian noise term for all gradients in a linear layer, <math id="S3.SS2.p8.1.m1.6" class="ltx_Math" alttext="\frac{\partial{l}}{\partial w_{i,j}}+\zeta_{i,j},\frac{\partial{l}}{\partial b_{j}}+\zeta_{j}" display="inline"><semantics id="S3.SS2.p8.1.m1.6a"><mrow id="S3.SS2.p8.1.m1.6.6.2" xref="S3.SS2.p8.1.m1.6.6.3.cmml"><mrow id="S3.SS2.p8.1.m1.5.5.1.1" xref="S3.SS2.p8.1.m1.5.5.1.1.cmml"><mfrac id="S3.SS2.p8.1.m1.2.2" xref="S3.SS2.p8.1.m1.2.2.cmml"><mrow id="S3.SS2.p8.1.m1.2.2.4" xref="S3.SS2.p8.1.m1.2.2.4.cmml"><mo rspace="0em" id="S3.SS2.p8.1.m1.2.2.4.1" xref="S3.SS2.p8.1.m1.2.2.4.1.cmml">∂</mo><mi id="S3.SS2.p8.1.m1.2.2.4.2" xref="S3.SS2.p8.1.m1.2.2.4.2.cmml">l</mi></mrow><mrow id="S3.SS2.p8.1.m1.2.2.2" xref="S3.SS2.p8.1.m1.2.2.2.cmml"><mo rspace="0em" id="S3.SS2.p8.1.m1.2.2.2.3" xref="S3.SS2.p8.1.m1.2.2.2.3.cmml">∂</mo><msub id="S3.SS2.p8.1.m1.2.2.2.4" xref="S3.SS2.p8.1.m1.2.2.2.4.cmml"><mi id="S3.SS2.p8.1.m1.2.2.2.4.2" xref="S3.SS2.p8.1.m1.2.2.2.4.2.cmml">w</mi><mrow id="S3.SS2.p8.1.m1.2.2.2.2.2.4" xref="S3.SS2.p8.1.m1.2.2.2.2.2.3.cmml"><mi id="S3.SS2.p8.1.m1.1.1.1.1.1.1" xref="S3.SS2.p8.1.m1.1.1.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p8.1.m1.2.2.2.2.2.4.1" xref="S3.SS2.p8.1.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p8.1.m1.2.2.2.2.2.2" xref="S3.SS2.p8.1.m1.2.2.2.2.2.2.cmml">j</mi></mrow></msub></mrow></mfrac><mo id="S3.SS2.p8.1.m1.5.5.1.1.1" xref="S3.SS2.p8.1.m1.5.5.1.1.1.cmml">+</mo><msub id="S3.SS2.p8.1.m1.5.5.1.1.2" xref="S3.SS2.p8.1.m1.5.5.1.1.2.cmml"><mi id="S3.SS2.p8.1.m1.5.5.1.1.2.2" xref="S3.SS2.p8.1.m1.5.5.1.1.2.2.cmml">ζ</mi><mrow id="S3.SS2.p8.1.m1.4.4.2.4" xref="S3.SS2.p8.1.m1.4.4.2.3.cmml"><mi id="S3.SS2.p8.1.m1.3.3.1.1" xref="S3.SS2.p8.1.m1.3.3.1.1.cmml">i</mi><mo id="S3.SS2.p8.1.m1.4.4.2.4.1" xref="S3.SS2.p8.1.m1.4.4.2.3.cmml">,</mo><mi id="S3.SS2.p8.1.m1.4.4.2.2" xref="S3.SS2.p8.1.m1.4.4.2.2.cmml">j</mi></mrow></msub></mrow><mo id="S3.SS2.p8.1.m1.6.6.2.3" xref="S3.SS2.p8.1.m1.6.6.3.cmml">,</mo><mrow id="S3.SS2.p8.1.m1.6.6.2.2" xref="S3.SS2.p8.1.m1.6.6.2.2.cmml"><mfrac id="S3.SS2.p8.1.m1.6.6.2.2.2" xref="S3.SS2.p8.1.m1.6.6.2.2.2.cmml"><mrow id="S3.SS2.p8.1.m1.6.6.2.2.2.2" xref="S3.SS2.p8.1.m1.6.6.2.2.2.2.cmml"><mo rspace="0em" id="S3.SS2.p8.1.m1.6.6.2.2.2.2.1" xref="S3.SS2.p8.1.m1.6.6.2.2.2.2.1.cmml">∂</mo><mi id="S3.SS2.p8.1.m1.6.6.2.2.2.2.2" xref="S3.SS2.p8.1.m1.6.6.2.2.2.2.2.cmml">l</mi></mrow><mrow id="S3.SS2.p8.1.m1.6.6.2.2.2.3" xref="S3.SS2.p8.1.m1.6.6.2.2.2.3.cmml"><mo rspace="0em" id="S3.SS2.p8.1.m1.6.6.2.2.2.3.1" xref="S3.SS2.p8.1.m1.6.6.2.2.2.3.1.cmml">∂</mo><msub id="S3.SS2.p8.1.m1.6.6.2.2.2.3.2" xref="S3.SS2.p8.1.m1.6.6.2.2.2.3.2.cmml"><mi id="S3.SS2.p8.1.m1.6.6.2.2.2.3.2.2" xref="S3.SS2.p8.1.m1.6.6.2.2.2.3.2.2.cmml">b</mi><mi id="S3.SS2.p8.1.m1.6.6.2.2.2.3.2.3" xref="S3.SS2.p8.1.m1.6.6.2.2.2.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo id="S3.SS2.p8.1.m1.6.6.2.2.1" xref="S3.SS2.p8.1.m1.6.6.2.2.1.cmml">+</mo><msub id="S3.SS2.p8.1.m1.6.6.2.2.3" xref="S3.SS2.p8.1.m1.6.6.2.2.3.cmml"><mi id="S3.SS2.p8.1.m1.6.6.2.2.3.2" xref="S3.SS2.p8.1.m1.6.6.2.2.3.2.cmml">ζ</mi><mi id="S3.SS2.p8.1.m1.6.6.2.2.3.3" xref="S3.SS2.p8.1.m1.6.6.2.2.3.3.cmml">j</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.1.m1.6b"><list id="S3.SS2.p8.1.m1.6.6.3.cmml" xref="S3.SS2.p8.1.m1.6.6.2"><apply id="S3.SS2.p8.1.m1.5.5.1.1.cmml" xref="S3.SS2.p8.1.m1.5.5.1.1"><plus id="S3.SS2.p8.1.m1.5.5.1.1.1.cmml" xref="S3.SS2.p8.1.m1.5.5.1.1.1"></plus><apply id="S3.SS2.p8.1.m1.2.2.cmml" xref="S3.SS2.p8.1.m1.2.2"><divide id="S3.SS2.p8.1.m1.2.2.3.cmml" xref="S3.SS2.p8.1.m1.2.2"></divide><apply id="S3.SS2.p8.1.m1.2.2.4.cmml" xref="S3.SS2.p8.1.m1.2.2.4"><partialdiff id="S3.SS2.p8.1.m1.2.2.4.1.cmml" xref="S3.SS2.p8.1.m1.2.2.4.1"></partialdiff><ci id="S3.SS2.p8.1.m1.2.2.4.2.cmml" xref="S3.SS2.p8.1.m1.2.2.4.2">𝑙</ci></apply><apply id="S3.SS2.p8.1.m1.2.2.2.cmml" xref="S3.SS2.p8.1.m1.2.2.2"><partialdiff id="S3.SS2.p8.1.m1.2.2.2.3.cmml" xref="S3.SS2.p8.1.m1.2.2.2.3"></partialdiff><apply id="S3.SS2.p8.1.m1.2.2.2.4.cmml" xref="S3.SS2.p8.1.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.p8.1.m1.2.2.2.4.1.cmml" xref="S3.SS2.p8.1.m1.2.2.2.4">subscript</csymbol><ci id="S3.SS2.p8.1.m1.2.2.2.4.2.cmml" xref="S3.SS2.p8.1.m1.2.2.2.4.2">𝑤</ci><list id="S3.SS2.p8.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS2.p8.1.m1.2.2.2.2.2.4"><ci id="S3.SS2.p8.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p8.1.m1.1.1.1.1.1.1">𝑖</ci><ci id="S3.SS2.p8.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS2.p8.1.m1.2.2.2.2.2.2">𝑗</ci></list></apply></apply></apply><apply id="S3.SS2.p8.1.m1.5.5.1.1.2.cmml" xref="S3.SS2.p8.1.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p8.1.m1.5.5.1.1.2.1.cmml" xref="S3.SS2.p8.1.m1.5.5.1.1.2">subscript</csymbol><ci id="S3.SS2.p8.1.m1.5.5.1.1.2.2.cmml" xref="S3.SS2.p8.1.m1.5.5.1.1.2.2">𝜁</ci><list id="S3.SS2.p8.1.m1.4.4.2.3.cmml" xref="S3.SS2.p8.1.m1.4.4.2.4"><ci id="S3.SS2.p8.1.m1.3.3.1.1.cmml" xref="S3.SS2.p8.1.m1.3.3.1.1">𝑖</ci><ci id="S3.SS2.p8.1.m1.4.4.2.2.cmml" xref="S3.SS2.p8.1.m1.4.4.2.2">𝑗</ci></list></apply></apply><apply id="S3.SS2.p8.1.m1.6.6.2.2.cmml" xref="S3.SS2.p8.1.m1.6.6.2.2"><plus id="S3.SS2.p8.1.m1.6.6.2.2.1.cmml" xref="S3.SS2.p8.1.m1.6.6.2.2.1"></plus><apply id="S3.SS2.p8.1.m1.6.6.2.2.2.cmml" xref="S3.SS2.p8.1.m1.6.6.2.2.2"><divide id="S3.SS2.p8.1.m1.6.6.2.2.2.1.cmml" xref="S3.SS2.p8.1.m1.6.6.2.2.2"></divide><apply id="S3.SS2.p8.1.m1.6.6.2.2.2.2.cmml" xref="S3.SS2.p8.1.m1.6.6.2.2.2.2"><partialdiff id="S3.SS2.p8.1.m1.6.6.2.2.2.2.1.cmml" xref="S3.SS2.p8.1.m1.6.6.2.2.2.2.1"></partialdiff><ci id="S3.SS2.p8.1.m1.6.6.2.2.2.2.2.cmml" xref="S3.SS2.p8.1.m1.6.6.2.2.2.2.2">𝑙</ci></apply><apply id="S3.SS2.p8.1.m1.6.6.2.2.2.3.cmml" xref="S3.SS2.p8.1.m1.6.6.2.2.2.3"><partialdiff id="S3.SS2.p8.1.m1.6.6.2.2.2.3.1.cmml" xref="S3.SS2.p8.1.m1.6.6.2.2.2.3.1"></partialdiff><apply id="S3.SS2.p8.1.m1.6.6.2.2.2.3.2.cmml" xref="S3.SS2.p8.1.m1.6.6.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p8.1.m1.6.6.2.2.2.3.2.1.cmml" xref="S3.SS2.p8.1.m1.6.6.2.2.2.3.2">subscript</csymbol><ci id="S3.SS2.p8.1.m1.6.6.2.2.2.3.2.2.cmml" xref="S3.SS2.p8.1.m1.6.6.2.2.2.3.2.2">𝑏</ci><ci id="S3.SS2.p8.1.m1.6.6.2.2.2.3.2.3.cmml" xref="S3.SS2.p8.1.m1.6.6.2.2.2.3.2.3">𝑗</ci></apply></apply></apply><apply id="S3.SS2.p8.1.m1.6.6.2.2.3.cmml" xref="S3.SS2.p8.1.m1.6.6.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p8.1.m1.6.6.2.2.3.1.cmml" xref="S3.SS2.p8.1.m1.6.6.2.2.3">subscript</csymbol><ci id="S3.SS2.p8.1.m1.6.6.2.2.3.2.cmml" xref="S3.SS2.p8.1.m1.6.6.2.2.3.2">𝜁</ci><ci id="S3.SS2.p8.1.m1.6.6.2.2.3.3.cmml" xref="S3.SS2.p8.1.m1.6.6.2.2.3.3">𝑗</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.1.m1.6c">\frac{\partial{l}}{\partial w_{i,j}}+\zeta_{i,j},\frac{\partial{l}}{\partial b_{j}}+\zeta_{j}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p9" class="ltx_para">
<p id="S3.SS2.p9.2" class="ltx_p">Figure <a href="#S3.F3" title="Figure 3 ‣ 3.2 Direct inversion of a full batch ‣ 3 Gradient mixing as a batch defense strategy ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the results from addition of noise at various standard deviations. We find that small contamination of noise does not protect against inversion and the error is in the order of the noise, and given that, we are required the noise to be in the order of the weights (<math id="S3.SS2.p9.1.m1.1" class="ltx_Math" alttext="std&gt;0.01" display="inline"><semantics id="S3.SS2.p9.1.m1.1a"><mrow id="S3.SS2.p9.1.m1.1.1" xref="S3.SS2.p9.1.m1.1.1.cmml"><mrow id="S3.SS2.p9.1.m1.1.1.2" xref="S3.SS2.p9.1.m1.1.1.2.cmml"><mi id="S3.SS2.p9.1.m1.1.1.2.2" xref="S3.SS2.p9.1.m1.1.1.2.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p9.1.m1.1.1.2.1" xref="S3.SS2.p9.1.m1.1.1.2.1.cmml">​</mo><mi id="S3.SS2.p9.1.m1.1.1.2.3" xref="S3.SS2.p9.1.m1.1.1.2.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p9.1.m1.1.1.2.1a" xref="S3.SS2.p9.1.m1.1.1.2.1.cmml">​</mo><mi id="S3.SS2.p9.1.m1.1.1.2.4" xref="S3.SS2.p9.1.m1.1.1.2.4.cmml">d</mi></mrow><mo id="S3.SS2.p9.1.m1.1.1.1" xref="S3.SS2.p9.1.m1.1.1.1.cmml">&gt;</mo><mn id="S3.SS2.p9.1.m1.1.1.3" xref="S3.SS2.p9.1.m1.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.1.m1.1b"><apply id="S3.SS2.p9.1.m1.1.1.cmml" xref="S3.SS2.p9.1.m1.1.1"><gt id="S3.SS2.p9.1.m1.1.1.1.cmml" xref="S3.SS2.p9.1.m1.1.1.1"></gt><apply id="S3.SS2.p9.1.m1.1.1.2.cmml" xref="S3.SS2.p9.1.m1.1.1.2"><times id="S3.SS2.p9.1.m1.1.1.2.1.cmml" xref="S3.SS2.p9.1.m1.1.1.2.1"></times><ci id="S3.SS2.p9.1.m1.1.1.2.2.cmml" xref="S3.SS2.p9.1.m1.1.1.2.2">𝑠</ci><ci id="S3.SS2.p9.1.m1.1.1.2.3.cmml" xref="S3.SS2.p9.1.m1.1.1.2.3">𝑡</ci><ci id="S3.SS2.p9.1.m1.1.1.2.4.cmml" xref="S3.SS2.p9.1.m1.1.1.2.4">𝑑</ci></apply><cn type="float" id="S3.SS2.p9.1.m1.1.1.3.cmml" xref="S3.SS2.p9.1.m1.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.1.m1.1c">std&gt;0.01</annotation></semantics></math>, with weights initialised uniformly between <math id="S3.SS2.p9.2.m2.2" class="ltx_Math" alttext="(-0.5,0.5)" display="inline"><semantics id="S3.SS2.p9.2.m2.2a"><mrow id="S3.SS2.p9.2.m2.2.2.1" xref="S3.SS2.p9.2.m2.2.2.2.cmml"><mo stretchy="false" id="S3.SS2.p9.2.m2.2.2.1.2" xref="S3.SS2.p9.2.m2.2.2.2.cmml">(</mo><mrow id="S3.SS2.p9.2.m2.2.2.1.1" xref="S3.SS2.p9.2.m2.2.2.1.1.cmml"><mo id="S3.SS2.p9.2.m2.2.2.1.1a" xref="S3.SS2.p9.2.m2.2.2.1.1.cmml">−</mo><mn id="S3.SS2.p9.2.m2.2.2.1.1.2" xref="S3.SS2.p9.2.m2.2.2.1.1.2.cmml">0.5</mn></mrow><mo id="S3.SS2.p9.2.m2.2.2.1.3" xref="S3.SS2.p9.2.m2.2.2.2.cmml">,</mo><mn id="S3.SS2.p9.2.m2.1.1" xref="S3.SS2.p9.2.m2.1.1.cmml">0.5</mn><mo stretchy="false" id="S3.SS2.p9.2.m2.2.2.1.4" xref="S3.SS2.p9.2.m2.2.2.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.2.m2.2b"><interval closure="open" id="S3.SS2.p9.2.m2.2.2.2.cmml" xref="S3.SS2.p9.2.m2.2.2.1"><apply id="S3.SS2.p9.2.m2.2.2.1.1.cmml" xref="S3.SS2.p9.2.m2.2.2.1.1"><minus id="S3.SS2.p9.2.m2.2.2.1.1.1.cmml" xref="S3.SS2.p9.2.m2.2.2.1.1"></minus><cn type="float" id="S3.SS2.p9.2.m2.2.2.1.1.2.cmml" xref="S3.SS2.p9.2.m2.2.2.1.1.2">0.5</cn></apply><cn type="float" id="S3.SS2.p9.2.m2.1.1.cmml" xref="S3.SS2.p9.2.m2.1.1">0.5</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.2.m2.2c">(-0.5,0.5)</annotation></semantics></math>). The addition of such a noise will affect the training drastically. In fact, this exercise shows that our gradient mixing strategies can be as effective as the addition of a large noise term, without the loss of training performance as we show in section <a href="#S5" title="5 Experimental Results ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<div id="S3.SS2.p10" class="ltx_para">
<p id="S3.SS2.p10.1" class="ltx_p">To further support our gradient mixing strategies, in section <a href="#S5" title="5 Experimental Results ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> we carry out an analysis of widely used inversion attacks that use numerical optimisation. We do this by firstly analysing inversion attack success in a dense layer model for simplicity, and then show its validity for a typically explored convolutional network in an inversion attack context.</p>
</div>
<figure id="S3.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F3.1" class="ltx_figure ltx_figure_panel"><img src="/html/2204.12495/assets/x6.png" id="S3.F3.1.g1" class="ltx_graphics ltx_img_landscape" width="156" height="118" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F3.2" class="ltx_figure ltx_figure_panel"><img src="/html/2204.12495/assets/x7.png" id="S3.F3.2.g1" class="ltx_graphics ltx_img_landscape" width="156" height="118" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>The error from direct inversion by adding Gaussian noise to gradients and biases at various standard deviations. Histogram (a) for MNIST dataset and histogram (b) for LFW dataset.</figcaption>
</figure>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Types of gradient inversion attacks employed to evaluate our proposed defense strategy.</figcaption>
<div id="S3.T1.3" class="ltx_inline-block ltx_transformed_outer" style="width:433.6pt;height:44.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-214.3pt,21.9pt) scale(0.502941185423772,0.502941185423772) ;">
<table id="S3.T1.3.3" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.3.3.4.1" class="ltx_tr">
<th id="S3.T1.3.3.4.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">Attack Name</th>
<th id="S3.T1.3.3.4.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">Main Objective Function</th>
<th id="S3.T1.3.3.4.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">Description</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.1.1.1" class="ltx_tr">
<td id="S3.T1.1.1.1.2" class="ltx_td ltx_align_left ltx_border_t">2-norm</td>
<td id="S3.T1.1.1.1.1" class="ltx_td ltx_align_left ltx_border_t">
<math id="S3.T1.1.1.1.1.m1.1" class="ltx_Math" alttext="g^{l2}" display="inline"><semantics id="S3.T1.1.1.1.1.m1.1a"><msup id="S3.T1.1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.1.m1.1.1.cmml"><mi id="S3.T1.1.1.1.1.m1.1.1.2" xref="S3.T1.1.1.1.1.m1.1.1.2.cmml">g</mi><mrow id="S3.T1.1.1.1.1.m1.1.1.3" xref="S3.T1.1.1.1.1.m1.1.1.3.cmml"><mi id="S3.T1.1.1.1.1.m1.1.1.3.2" xref="S3.T1.1.1.1.1.m1.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.T1.1.1.1.1.m1.1.1.3.1" xref="S3.T1.1.1.1.1.m1.1.1.3.1.cmml">​</mo><mn id="S3.T1.1.1.1.1.m1.1.1.3.3" xref="S3.T1.1.1.1.1.m1.1.1.3.3.cmml">2</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.1.m1.1b"><apply id="S3.T1.1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.1.1.1.1.m1.1.1.1.cmml" xref="S3.T1.1.1.1.1.m1.1.1">superscript</csymbol><ci id="S3.T1.1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.1.1.1.1.m1.1.1.2">𝑔</ci><apply id="S3.T1.1.1.1.1.m1.1.1.3.cmml" xref="S3.T1.1.1.1.1.m1.1.1.3"><times id="S3.T1.1.1.1.1.m1.1.1.3.1.cmml" xref="S3.T1.1.1.1.1.m1.1.1.3.1"></times><ci id="S3.T1.1.1.1.1.m1.1.1.3.2.cmml" xref="S3.T1.1.1.1.1.m1.1.1.3.2">𝑙</ci><cn type="integer" id="S3.T1.1.1.1.1.m1.1.1.3.3.cmml" xref="S3.T1.1.1.1.1.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.1.m1.1c">g^{l2}</annotation></semantics></math> (<a href="#S4.E11" title="In 4.1 Inversion Attack Optimisation Algorithms ‣ 4 Experimental framework ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>)</td>
<td id="S3.T1.1.1.1.3" class="ltx_td ltx_align_left ltx_border_t">Euclidean distance and initial label determination.</td>
</tr>
<tr id="S3.T1.2.2.2" class="ltx_tr">
<td id="S3.T1.2.2.2.2" class="ltx_td ltx_align_left">Angle &amp; var</td>
<td id="S3.T1.2.2.2.1" class="ltx_td ltx_align_left">
<math id="S3.T1.2.2.2.1.m1.1" class="ltx_Math" alttext="g^{ang}" display="inline"><semantics id="S3.T1.2.2.2.1.m1.1a"><msup id="S3.T1.2.2.2.1.m1.1.1" xref="S3.T1.2.2.2.1.m1.1.1.cmml"><mi id="S3.T1.2.2.2.1.m1.1.1.2" xref="S3.T1.2.2.2.1.m1.1.1.2.cmml">g</mi><mrow id="S3.T1.2.2.2.1.m1.1.1.3" xref="S3.T1.2.2.2.1.m1.1.1.3.cmml"><mi id="S3.T1.2.2.2.1.m1.1.1.3.2" xref="S3.T1.2.2.2.1.m1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.T1.2.2.2.1.m1.1.1.3.1" xref="S3.T1.2.2.2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.T1.2.2.2.1.m1.1.1.3.3" xref="S3.T1.2.2.2.1.m1.1.1.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.T1.2.2.2.1.m1.1.1.3.1a" xref="S3.T1.2.2.2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.T1.2.2.2.1.m1.1.1.3.4" xref="S3.T1.2.2.2.1.m1.1.1.3.4.cmml">g</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.2.1.m1.1b"><apply id="S3.T1.2.2.2.1.m1.1.1.cmml" xref="S3.T1.2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.2.2.2.1.m1.1.1.1.cmml" xref="S3.T1.2.2.2.1.m1.1.1">superscript</csymbol><ci id="S3.T1.2.2.2.1.m1.1.1.2.cmml" xref="S3.T1.2.2.2.1.m1.1.1.2">𝑔</ci><apply id="S3.T1.2.2.2.1.m1.1.1.3.cmml" xref="S3.T1.2.2.2.1.m1.1.1.3"><times id="S3.T1.2.2.2.1.m1.1.1.3.1.cmml" xref="S3.T1.2.2.2.1.m1.1.1.3.1"></times><ci id="S3.T1.2.2.2.1.m1.1.1.3.2.cmml" xref="S3.T1.2.2.2.1.m1.1.1.3.2">𝑎</ci><ci id="S3.T1.2.2.2.1.m1.1.1.3.3.cmml" xref="S3.T1.2.2.2.1.m1.1.1.3.3">𝑛</ci><ci id="S3.T1.2.2.2.1.m1.1.1.3.4.cmml" xref="S3.T1.2.2.2.1.m1.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.2.1.m1.1c">g^{ang}</annotation></semantics></math> + TV (<a href="#S4.E12" title="In 4.1 Inversion Attack Optimisation Algorithms ‣ 4 Experimental framework ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>)</td>
<td id="S3.T1.2.2.2.3" class="ltx_td ltx_align_left">
<cite class="ltx_cite ltx_citemacro_citet">Geiping et al. (<a href="#bib.bib5" title="" class="ltx_ref">2020</a>)</cite> proposed to leverage cosine
similarity, total variation (TV) and initial label determination.</td>
</tr>
<tr id="S3.T1.3.3.3" class="ltx_tr">
<td id="S3.T1.3.3.3.2" class="ltx_td ltx_align_left ltx_border_b">Angle &amp; var &amp; Orth_regulators</td>
<td id="S3.T1.3.3.3.1" class="ltx_td ltx_align_left ltx_border_b">
<math id="S3.T1.3.3.3.1.m1.1" class="ltx_Math" alttext="g^{ang}" display="inline"><semantics id="S3.T1.3.3.3.1.m1.1a"><msup id="S3.T1.3.3.3.1.m1.1.1" xref="S3.T1.3.3.3.1.m1.1.1.cmml"><mi id="S3.T1.3.3.3.1.m1.1.1.2" xref="S3.T1.3.3.3.1.m1.1.1.2.cmml">g</mi><mrow id="S3.T1.3.3.3.1.m1.1.1.3" xref="S3.T1.3.3.3.1.m1.1.1.3.cmml"><mi id="S3.T1.3.3.3.1.m1.1.1.3.2" xref="S3.T1.3.3.3.1.m1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.T1.3.3.3.1.m1.1.1.3.1" xref="S3.T1.3.3.3.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.T1.3.3.3.1.m1.1.1.3.3" xref="S3.T1.3.3.3.1.m1.1.1.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.T1.3.3.3.1.m1.1.1.3.1a" xref="S3.T1.3.3.3.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.T1.3.3.3.1.m1.1.1.3.4" xref="S3.T1.3.3.3.1.m1.1.1.3.4.cmml">g</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.3.1.m1.1b"><apply id="S3.T1.3.3.3.1.m1.1.1.cmml" xref="S3.T1.3.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.3.3.3.1.m1.1.1.1.cmml" xref="S3.T1.3.3.3.1.m1.1.1">superscript</csymbol><ci id="S3.T1.3.3.3.1.m1.1.1.2.cmml" xref="S3.T1.3.3.3.1.m1.1.1.2">𝑔</ci><apply id="S3.T1.3.3.3.1.m1.1.1.3.cmml" xref="S3.T1.3.3.3.1.m1.1.1.3"><times id="S3.T1.3.3.3.1.m1.1.1.3.1.cmml" xref="S3.T1.3.3.3.1.m1.1.1.3.1"></times><ci id="S3.T1.3.3.3.1.m1.1.1.3.2.cmml" xref="S3.T1.3.3.3.1.m1.1.1.3.2">𝑎</ci><ci id="S3.T1.3.3.3.1.m1.1.1.3.3.cmml" xref="S3.T1.3.3.3.1.m1.1.1.3.3">𝑛</ci><ci id="S3.T1.3.3.3.1.m1.1.1.3.4.cmml" xref="S3.T1.3.3.3.1.m1.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.3.1.m1.1c">g^{ang}</annotation></semantics></math> + TV + Orth</td>
<td id="S3.T1.3.3.3.3" class="ltx_td ltx_align_left ltx_border_b">Cosine distance with orthogonal regulator for the input + initial label determination. <cite class="ltx_cite ltx_citemacro_citep">(Qian et al., <a href="#bib.bib16" title="" class="ltx_ref">2021</a>)</cite>
</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experimental framework</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section we detail the experimental framework we use to evaluate our gradient de-mixing strategies in section <a href="#S5" title="5 Experimental Results ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. In our experiments we explore the privacy of the input data with two representative networks, the first, a single dense layer and a standard LeNET convolutional neural network <cite class="ltx_cite ltx_citemacro_citep">(LeCun et al., <a href="#bib.bib11" title="" class="ltx_ref">1990</a>)</cite>. We analyse the impact of different loss functions and label distributions by varying the batch sizes and the number of filters. This empirical study explores the limit of the attacks for varying conditions. For example, how many filters and the size of batch that are needed to protect privacy. We demonstrate how the MSE loss and choosing similar labels in a mini-batch helps a practitioner leverage a greater number of filters and a lower size of batch.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Inversion Attack Optimisation Algorithms</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.4" class="ltx_p">The gradient inversion attack is carried out by choosing <math id="S4.SS1.p1.1.m1.2" class="ltx_Math" alttext="x_{t}^{\prime},y_{t}^{\prime}" display="inline"><semantics id="S4.SS1.p1.1.m1.2a"><mrow id="S4.SS1.p1.1.m1.2.2.2" xref="S4.SS1.p1.1.m1.2.2.3.cmml"><msubsup id="S4.SS1.p1.1.m1.1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1.1.1.2.2" xref="S4.SS1.p1.1.m1.1.1.1.1.2.2.cmml">x</mi><mi id="S4.SS1.p1.1.m1.1.1.1.1.2.3" xref="S4.SS1.p1.1.m1.1.1.1.1.2.3.cmml">t</mi><mo id="S4.SS1.p1.1.m1.1.1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S4.SS1.p1.1.m1.2.2.2.3" xref="S4.SS1.p1.1.m1.2.2.3.cmml">,</mo><msubsup id="S4.SS1.p1.1.m1.2.2.2.2" xref="S4.SS1.p1.1.m1.2.2.2.2.cmml"><mi id="S4.SS1.p1.1.m1.2.2.2.2.2.2" xref="S4.SS1.p1.1.m1.2.2.2.2.2.2.cmml">y</mi><mi id="S4.SS1.p1.1.m1.2.2.2.2.2.3" xref="S4.SS1.p1.1.m1.2.2.2.2.2.3.cmml">t</mi><mo id="S4.SS1.p1.1.m1.2.2.2.2.3" xref="S4.SS1.p1.1.m1.2.2.2.2.3.cmml">′</mo></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.2b"><list id="S4.SS1.p1.1.m1.2.2.3.cmml" xref="S4.SS1.p1.1.m1.2.2.2"><apply id="S4.SS1.p1.1.m1.1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1">superscript</csymbol><apply id="S4.SS1.p1.1.m1.1.1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.1.2.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.1.1.2.2.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.2.2">𝑥</ci><ci id="S4.SS1.p1.1.m1.1.1.1.1.2.3.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S4.SS1.p1.1.m1.1.1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.3">′</ci></apply><apply id="S4.SS1.p1.1.m1.2.2.2.2.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.2.2.2.2.1.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2">superscript</csymbol><apply id="S4.SS1.p1.1.m1.2.2.2.2.2.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.2.2.2.2.2.1.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.1.m1.2.2.2.2.2.2.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2.2.2">𝑦</ci><ci id="S4.SS1.p1.1.m1.2.2.2.2.2.3.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2.2.3">𝑡</ci></apply><ci id="S4.SS1.p1.1.m1.2.2.2.2.3.cmml" xref="S4.SS1.p1.1.m1.2.2.2.2.3">′</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.2c">x_{t}^{\prime},y_{t}^{\prime}</annotation></semantics></math> on a proxy model, <math id="S4.SS1.p1.2.m2.2" class="ltx_Math" alttext="F^{\prime}(x_{t}^{\prime},y_{t}^{\prime})" display="inline"><semantics id="S4.SS1.p1.2.m2.2a"><mrow id="S4.SS1.p1.2.m2.2.2" xref="S4.SS1.p1.2.m2.2.2.cmml"><msup id="S4.SS1.p1.2.m2.2.2.4" xref="S4.SS1.p1.2.m2.2.2.4.cmml"><mi id="S4.SS1.p1.2.m2.2.2.4.2" xref="S4.SS1.p1.2.m2.2.2.4.2.cmml">F</mi><mo id="S4.SS1.p1.2.m2.2.2.4.3" xref="S4.SS1.p1.2.m2.2.2.4.3.cmml">′</mo></msup><mo lspace="0em" rspace="0em" id="S4.SS1.p1.2.m2.2.2.3" xref="S4.SS1.p1.2.m2.2.2.3.cmml">​</mo><mrow id="S4.SS1.p1.2.m2.2.2.2.2" xref="S4.SS1.p1.2.m2.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.p1.2.m2.2.2.2.2.3" xref="S4.SS1.p1.2.m2.2.2.2.3.cmml">(</mo><msubsup id="S4.SS1.p1.2.m2.1.1.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.1.1.1.2.2" xref="S4.SS1.p1.2.m2.1.1.1.1.1.2.2.cmml">x</mi><mi id="S4.SS1.p1.2.m2.1.1.1.1.1.2.3" xref="S4.SS1.p1.2.m2.1.1.1.1.1.2.3.cmml">t</mi><mo id="S4.SS1.p1.2.m2.1.1.1.1.1.3" xref="S4.SS1.p1.2.m2.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S4.SS1.p1.2.m2.2.2.2.2.4" xref="S4.SS1.p1.2.m2.2.2.2.3.cmml">,</mo><msubsup id="S4.SS1.p1.2.m2.2.2.2.2.2" xref="S4.SS1.p1.2.m2.2.2.2.2.2.cmml"><mi id="S4.SS1.p1.2.m2.2.2.2.2.2.2.2" xref="S4.SS1.p1.2.m2.2.2.2.2.2.2.2.cmml">y</mi><mi id="S4.SS1.p1.2.m2.2.2.2.2.2.2.3" xref="S4.SS1.p1.2.m2.2.2.2.2.2.2.3.cmml">t</mi><mo id="S4.SS1.p1.2.m2.2.2.2.2.2.3" xref="S4.SS1.p1.2.m2.2.2.2.2.2.3.cmml">′</mo></msubsup><mo stretchy="false" id="S4.SS1.p1.2.m2.2.2.2.2.5" xref="S4.SS1.p1.2.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.2b"><apply id="S4.SS1.p1.2.m2.2.2.cmml" xref="S4.SS1.p1.2.m2.2.2"><times id="S4.SS1.p1.2.m2.2.2.3.cmml" xref="S4.SS1.p1.2.m2.2.2.3"></times><apply id="S4.SS1.p1.2.m2.2.2.4.cmml" xref="S4.SS1.p1.2.m2.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.2.2.4.1.cmml" xref="S4.SS1.p1.2.m2.2.2.4">superscript</csymbol><ci id="S4.SS1.p1.2.m2.2.2.4.2.cmml" xref="S4.SS1.p1.2.m2.2.2.4.2">𝐹</ci><ci id="S4.SS1.p1.2.m2.2.2.4.3.cmml" xref="S4.SS1.p1.2.m2.2.2.4.3">′</ci></apply><interval closure="open" id="S4.SS1.p1.2.m2.2.2.2.3.cmml" xref="S4.SS1.p1.2.m2.2.2.2.2"><apply id="S4.SS1.p1.2.m2.1.1.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1">superscript</csymbol><apply id="S4.SS1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.2.2">𝑥</ci><ci id="S4.SS1.p1.2.m2.1.1.1.1.1.2.3.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S4.SS1.p1.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.3">′</ci></apply><apply id="S4.SS1.p1.2.m2.2.2.2.2.2.cmml" xref="S4.SS1.p1.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.2.2.2.2.2.1.cmml" xref="S4.SS1.p1.2.m2.2.2.2.2.2">superscript</csymbol><apply id="S4.SS1.p1.2.m2.2.2.2.2.2.2.cmml" xref="S4.SS1.p1.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.2.2.2.2.2.2.1.cmml" xref="S4.SS1.p1.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.2.m2.2.2.2.2.2.2.2.cmml" xref="S4.SS1.p1.2.m2.2.2.2.2.2.2.2">𝑦</ci><ci id="S4.SS1.p1.2.m2.2.2.2.2.2.2.3.cmml" xref="S4.SS1.p1.2.m2.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="S4.SS1.p1.2.m2.2.2.2.2.2.3.cmml" xref="S4.SS1.p1.2.m2.2.2.2.2.2.3">′</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.2c">F^{\prime}(x_{t}^{\prime},y_{t}^{\prime})</annotation></semantics></math>, and finding <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="\Delta W_{t}^{\prime}" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mrow id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml"><mi mathvariant="normal" id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.3.m3.1.1.1" xref="S4.SS1.p1.3.m3.1.1.1.cmml">​</mo><msubsup id="S4.SS1.p1.3.m3.1.1.3" xref="S4.SS1.p1.3.m3.1.1.3.cmml"><mi id="S4.SS1.p1.3.m3.1.1.3.2.2" xref="S4.SS1.p1.3.m3.1.1.3.2.2.cmml">W</mi><mi id="S4.SS1.p1.3.m3.1.1.3.2.3" xref="S4.SS1.p1.3.m3.1.1.3.2.3.cmml">t</mi><mo id="S4.SS1.p1.3.m3.1.1.3.3" xref="S4.SS1.p1.3.m3.1.1.3.3.cmml">′</mo></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"><times id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1"></times><ci id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2">Δ</ci><apply id="S4.SS1.p1.3.m3.1.1.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.3.1.cmml" xref="S4.SS1.p1.3.m3.1.1.3">superscript</csymbol><apply id="S4.SS1.p1.3.m3.1.1.3.2.cmml" xref="S4.SS1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.3.2.1.cmml" xref="S4.SS1.p1.3.m3.1.1.3">subscript</csymbol><ci id="S4.SS1.p1.3.m3.1.1.3.2.2.cmml" xref="S4.SS1.p1.3.m3.1.1.3.2.2">𝑊</ci><ci id="S4.SS1.p1.3.m3.1.1.3.2.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3.2.3">𝑡</ci></apply><ci id="S4.SS1.p1.3.m3.1.1.3.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">\Delta W_{t}^{\prime}</annotation></semantics></math> which minimises an objective function <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="M\Delta W_{t}" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><mrow id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><mi id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.4.m4.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.4.m4.1.1.1a" xref="S4.SS1.p1.4.m4.1.1.1.cmml">​</mo><msub id="S4.SS1.p1.4.m4.1.1.4" xref="S4.SS1.p1.4.m4.1.1.4.cmml"><mi id="S4.SS1.p1.4.m4.1.1.4.2" xref="S4.SS1.p1.4.m4.1.1.4.2.cmml">W</mi><mi id="S4.SS1.p1.4.m4.1.1.4.3" xref="S4.SS1.p1.4.m4.1.1.4.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><times id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1"></times><ci id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2">𝑀</ci><ci id="S4.SS1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3">Δ</ci><apply id="S4.SS1.p1.4.m4.1.1.4.cmml" xref="S4.SS1.p1.4.m4.1.1.4"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.4.1.cmml" xref="S4.SS1.p1.4.m4.1.1.4">subscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.4.2.cmml" xref="S4.SS1.p1.4.m4.1.1.4.2">𝑊</ci><ci id="S4.SS1.p1.4.m4.1.1.4.3.cmml" xref="S4.SS1.p1.4.m4.1.1.4.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">M\Delta W_{t}</annotation></semantics></math>. A typical objective can be the norm of the gradients’ difference:</p>
<table id="S4.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E11.m1.3" class="ltx_Math" alttext="g^{l2}(x_{t}^{\prime},y_{t}^{\prime})=\mathrm{min}||\Delta W_{t}^{\prime}-\Delta W_{t}||" display="block"><semantics id="S4.E11.m1.3a"><mrow id="S4.E11.m1.3.3" xref="S4.E11.m1.3.3.cmml"><mrow id="S4.E11.m1.2.2.2" xref="S4.E11.m1.2.2.2.cmml"><msup id="S4.E11.m1.2.2.2.4" xref="S4.E11.m1.2.2.2.4.cmml"><mi id="S4.E11.m1.2.2.2.4.2" xref="S4.E11.m1.2.2.2.4.2.cmml">g</mi><mrow id="S4.E11.m1.2.2.2.4.3" xref="S4.E11.m1.2.2.2.4.3.cmml"><mi id="S4.E11.m1.2.2.2.4.3.2" xref="S4.E11.m1.2.2.2.4.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.2.2.2.4.3.1" xref="S4.E11.m1.2.2.2.4.3.1.cmml">​</mo><mn id="S4.E11.m1.2.2.2.4.3.3" xref="S4.E11.m1.2.2.2.4.3.3.cmml">2</mn></mrow></msup><mo lspace="0em" rspace="0em" id="S4.E11.m1.2.2.2.3" xref="S4.E11.m1.2.2.2.3.cmml">​</mo><mrow id="S4.E11.m1.2.2.2.2.2" xref="S4.E11.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="S4.E11.m1.2.2.2.2.2.3" xref="S4.E11.m1.2.2.2.2.3.cmml">(</mo><msubsup id="S4.E11.m1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.cmml"><mi id="S4.E11.m1.1.1.1.1.1.1.2.2" xref="S4.E11.m1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S4.E11.m1.1.1.1.1.1.1.2.3" xref="S4.E11.m1.1.1.1.1.1.1.2.3.cmml">t</mi><mo id="S4.E11.m1.1.1.1.1.1.1.3" xref="S4.E11.m1.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S4.E11.m1.2.2.2.2.2.4" xref="S4.E11.m1.2.2.2.2.3.cmml">,</mo><msubsup id="S4.E11.m1.2.2.2.2.2.2" xref="S4.E11.m1.2.2.2.2.2.2.cmml"><mi id="S4.E11.m1.2.2.2.2.2.2.2.2" xref="S4.E11.m1.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="S4.E11.m1.2.2.2.2.2.2.2.3" xref="S4.E11.m1.2.2.2.2.2.2.2.3.cmml">t</mi><mo id="S4.E11.m1.2.2.2.2.2.2.3" xref="S4.E11.m1.2.2.2.2.2.2.3.cmml">′</mo></msubsup><mo stretchy="false" id="S4.E11.m1.2.2.2.2.2.5" xref="S4.E11.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E11.m1.3.3.4" xref="S4.E11.m1.3.3.4.cmml">=</mo><mrow id="S4.E11.m1.3.3.3" xref="S4.E11.m1.3.3.3.cmml"><mi id="S4.E11.m1.3.3.3.3" xref="S4.E11.m1.3.3.3.3.cmml">min</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.3.3.3.2" xref="S4.E11.m1.3.3.3.2.cmml">​</mo><mrow id="S4.E11.m1.3.3.3.1.1" xref="S4.E11.m1.3.3.3.1.2.cmml"><mo stretchy="false" id="S4.E11.m1.3.3.3.1.1.2" xref="S4.E11.m1.3.3.3.1.2.1.cmml">‖</mo><mrow id="S4.E11.m1.3.3.3.1.1.1" xref="S4.E11.m1.3.3.3.1.1.1.cmml"><mrow id="S4.E11.m1.3.3.3.1.1.1.2" xref="S4.E11.m1.3.3.3.1.1.1.2.cmml"><mi mathvariant="normal" id="S4.E11.m1.3.3.3.1.1.1.2.2" xref="S4.E11.m1.3.3.3.1.1.1.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.3.3.3.1.1.1.2.1" xref="S4.E11.m1.3.3.3.1.1.1.2.1.cmml">​</mo><msubsup id="S4.E11.m1.3.3.3.1.1.1.2.3" xref="S4.E11.m1.3.3.3.1.1.1.2.3.cmml"><mi id="S4.E11.m1.3.3.3.1.1.1.2.3.2.2" xref="S4.E11.m1.3.3.3.1.1.1.2.3.2.2.cmml">W</mi><mi id="S4.E11.m1.3.3.3.1.1.1.2.3.2.3" xref="S4.E11.m1.3.3.3.1.1.1.2.3.2.3.cmml">t</mi><mo id="S4.E11.m1.3.3.3.1.1.1.2.3.3" xref="S4.E11.m1.3.3.3.1.1.1.2.3.3.cmml">′</mo></msubsup></mrow><mo id="S4.E11.m1.3.3.3.1.1.1.1" xref="S4.E11.m1.3.3.3.1.1.1.1.cmml">−</mo><mrow id="S4.E11.m1.3.3.3.1.1.1.3" xref="S4.E11.m1.3.3.3.1.1.1.3.cmml"><mi mathvariant="normal" id="S4.E11.m1.3.3.3.1.1.1.3.2" xref="S4.E11.m1.3.3.3.1.1.1.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.3.3.3.1.1.1.3.1" xref="S4.E11.m1.3.3.3.1.1.1.3.1.cmml">​</mo><msub id="S4.E11.m1.3.3.3.1.1.1.3.3" xref="S4.E11.m1.3.3.3.1.1.1.3.3.cmml"><mi id="S4.E11.m1.3.3.3.1.1.1.3.3.2" xref="S4.E11.m1.3.3.3.1.1.1.3.3.2.cmml">W</mi><mi id="S4.E11.m1.3.3.3.1.1.1.3.3.3" xref="S4.E11.m1.3.3.3.1.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><mo stretchy="false" id="S4.E11.m1.3.3.3.1.1.3" xref="S4.E11.m1.3.3.3.1.2.1.cmml">‖</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.3b"><apply id="S4.E11.m1.3.3.cmml" xref="S4.E11.m1.3.3"><eq id="S4.E11.m1.3.3.4.cmml" xref="S4.E11.m1.3.3.4"></eq><apply id="S4.E11.m1.2.2.2.cmml" xref="S4.E11.m1.2.2.2"><times id="S4.E11.m1.2.2.2.3.cmml" xref="S4.E11.m1.2.2.2.3"></times><apply id="S4.E11.m1.2.2.2.4.cmml" xref="S4.E11.m1.2.2.2.4"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.4.1.cmml" xref="S4.E11.m1.2.2.2.4">superscript</csymbol><ci id="S4.E11.m1.2.2.2.4.2.cmml" xref="S4.E11.m1.2.2.2.4.2">𝑔</ci><apply id="S4.E11.m1.2.2.2.4.3.cmml" xref="S4.E11.m1.2.2.2.4.3"><times id="S4.E11.m1.2.2.2.4.3.1.cmml" xref="S4.E11.m1.2.2.2.4.3.1"></times><ci id="S4.E11.m1.2.2.2.4.3.2.cmml" xref="S4.E11.m1.2.2.2.4.3.2">𝑙</ci><cn type="integer" id="S4.E11.m1.2.2.2.4.3.3.cmml" xref="S4.E11.m1.2.2.2.4.3.3">2</cn></apply></apply><interval closure="open" id="S4.E11.m1.2.2.2.2.3.cmml" xref="S4.E11.m1.2.2.2.2.2"><apply id="S4.E11.m1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E11.m1.1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E11.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S4.E11.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.E11.m1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S4.E11.m1.1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.1.1.1.1.1.1.3">′</ci></apply><apply id="S4.E11.m1.2.2.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.2.2.2.1.cmml" xref="S4.E11.m1.2.2.2.2.2.2">superscript</csymbol><apply id="S4.E11.m1.2.2.2.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.2.2.2.2.1.cmml" xref="S4.E11.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E11.m1.2.2.2.2.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2.2.2.2.2.2">𝑦</ci><ci id="S4.E11.m1.2.2.2.2.2.2.2.3.cmml" xref="S4.E11.m1.2.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="S4.E11.m1.2.2.2.2.2.2.3.cmml" xref="S4.E11.m1.2.2.2.2.2.2.3">′</ci></apply></interval></apply><apply id="S4.E11.m1.3.3.3.cmml" xref="S4.E11.m1.3.3.3"><times id="S4.E11.m1.3.3.3.2.cmml" xref="S4.E11.m1.3.3.3.2"></times><ci id="S4.E11.m1.3.3.3.3.cmml" xref="S4.E11.m1.3.3.3.3">min</ci><apply id="S4.E11.m1.3.3.3.1.2.cmml" xref="S4.E11.m1.3.3.3.1.1"><csymbol cd="latexml" id="S4.E11.m1.3.3.3.1.2.1.cmml" xref="S4.E11.m1.3.3.3.1.1.2">norm</csymbol><apply id="S4.E11.m1.3.3.3.1.1.1.cmml" xref="S4.E11.m1.3.3.3.1.1.1"><minus id="S4.E11.m1.3.3.3.1.1.1.1.cmml" xref="S4.E11.m1.3.3.3.1.1.1.1"></minus><apply id="S4.E11.m1.3.3.3.1.1.1.2.cmml" xref="S4.E11.m1.3.3.3.1.1.1.2"><times id="S4.E11.m1.3.3.3.1.1.1.2.1.cmml" xref="S4.E11.m1.3.3.3.1.1.1.2.1"></times><ci id="S4.E11.m1.3.3.3.1.1.1.2.2.cmml" xref="S4.E11.m1.3.3.3.1.1.1.2.2">Δ</ci><apply id="S4.E11.m1.3.3.3.1.1.1.2.3.cmml" xref="S4.E11.m1.3.3.3.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E11.m1.3.3.3.1.1.1.2.3.1.cmml" xref="S4.E11.m1.3.3.3.1.1.1.2.3">superscript</csymbol><apply id="S4.E11.m1.3.3.3.1.1.1.2.3.2.cmml" xref="S4.E11.m1.3.3.3.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E11.m1.3.3.3.1.1.1.2.3.2.1.cmml" xref="S4.E11.m1.3.3.3.1.1.1.2.3">subscript</csymbol><ci id="S4.E11.m1.3.3.3.1.1.1.2.3.2.2.cmml" xref="S4.E11.m1.3.3.3.1.1.1.2.3.2.2">𝑊</ci><ci id="S4.E11.m1.3.3.3.1.1.1.2.3.2.3.cmml" xref="S4.E11.m1.3.3.3.1.1.1.2.3.2.3">𝑡</ci></apply><ci id="S4.E11.m1.3.3.3.1.1.1.2.3.3.cmml" xref="S4.E11.m1.3.3.3.1.1.1.2.3.3">′</ci></apply></apply><apply id="S4.E11.m1.3.3.3.1.1.1.3.cmml" xref="S4.E11.m1.3.3.3.1.1.1.3"><times id="S4.E11.m1.3.3.3.1.1.1.3.1.cmml" xref="S4.E11.m1.3.3.3.1.1.1.3.1"></times><ci id="S4.E11.m1.3.3.3.1.1.1.3.2.cmml" xref="S4.E11.m1.3.3.3.1.1.1.3.2">Δ</ci><apply id="S4.E11.m1.3.3.3.1.1.1.3.3.cmml" xref="S4.E11.m1.3.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E11.m1.3.3.3.1.1.1.3.3.1.cmml" xref="S4.E11.m1.3.3.3.1.1.1.3.3">subscript</csymbol><ci id="S4.E11.m1.3.3.3.1.1.1.3.3.2.cmml" xref="S4.E11.m1.3.3.3.1.1.1.3.3.2">𝑊</ci><ci id="S4.E11.m1.3.3.3.1.1.1.3.3.3.cmml" xref="S4.E11.m1.3.3.3.1.1.1.3.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.3c">g^{l2}(x_{t}^{\prime},y_{t}^{\prime})=\mathrm{min}||\Delta W_{t}^{\prime}-\Delta W_{t}||</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p1.5" class="ltx_p">This solution searches for a model <math id="S4.SS1.p1.5.m1.2" class="ltx_Math" alttext="F^{\prime}(x_{t}^{\prime},y_{t}^{\prime})" display="inline"><semantics id="S4.SS1.p1.5.m1.2a"><mrow id="S4.SS1.p1.5.m1.2.2" xref="S4.SS1.p1.5.m1.2.2.cmml"><msup id="S4.SS1.p1.5.m1.2.2.4" xref="S4.SS1.p1.5.m1.2.2.4.cmml"><mi id="S4.SS1.p1.5.m1.2.2.4.2" xref="S4.SS1.p1.5.m1.2.2.4.2.cmml">F</mi><mo id="S4.SS1.p1.5.m1.2.2.4.3" xref="S4.SS1.p1.5.m1.2.2.4.3.cmml">′</mo></msup><mo lspace="0em" rspace="0em" id="S4.SS1.p1.5.m1.2.2.3" xref="S4.SS1.p1.5.m1.2.2.3.cmml">​</mo><mrow id="S4.SS1.p1.5.m1.2.2.2.2" xref="S4.SS1.p1.5.m1.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.p1.5.m1.2.2.2.2.3" xref="S4.SS1.p1.5.m1.2.2.2.3.cmml">(</mo><msubsup id="S4.SS1.p1.5.m1.1.1.1.1.1" xref="S4.SS1.p1.5.m1.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.5.m1.1.1.1.1.1.2.2" xref="S4.SS1.p1.5.m1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S4.SS1.p1.5.m1.1.1.1.1.1.2.3" xref="S4.SS1.p1.5.m1.1.1.1.1.1.2.3.cmml">t</mi><mo id="S4.SS1.p1.5.m1.1.1.1.1.1.3" xref="S4.SS1.p1.5.m1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S4.SS1.p1.5.m1.2.2.2.2.4" xref="S4.SS1.p1.5.m1.2.2.2.3.cmml">,</mo><msubsup id="S4.SS1.p1.5.m1.2.2.2.2.2" xref="S4.SS1.p1.5.m1.2.2.2.2.2.cmml"><mi id="S4.SS1.p1.5.m1.2.2.2.2.2.2.2" xref="S4.SS1.p1.5.m1.2.2.2.2.2.2.2.cmml">y</mi><mi id="S4.SS1.p1.5.m1.2.2.2.2.2.2.3" xref="S4.SS1.p1.5.m1.2.2.2.2.2.2.3.cmml">t</mi><mo id="S4.SS1.p1.5.m1.2.2.2.2.2.3" xref="S4.SS1.p1.5.m1.2.2.2.2.2.3.cmml">′</mo></msubsup><mo stretchy="false" id="S4.SS1.p1.5.m1.2.2.2.2.5" xref="S4.SS1.p1.5.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m1.2b"><apply id="S4.SS1.p1.5.m1.2.2.cmml" xref="S4.SS1.p1.5.m1.2.2"><times id="S4.SS1.p1.5.m1.2.2.3.cmml" xref="S4.SS1.p1.5.m1.2.2.3"></times><apply id="S4.SS1.p1.5.m1.2.2.4.cmml" xref="S4.SS1.p1.5.m1.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m1.2.2.4.1.cmml" xref="S4.SS1.p1.5.m1.2.2.4">superscript</csymbol><ci id="S4.SS1.p1.5.m1.2.2.4.2.cmml" xref="S4.SS1.p1.5.m1.2.2.4.2">𝐹</ci><ci id="S4.SS1.p1.5.m1.2.2.4.3.cmml" xref="S4.SS1.p1.5.m1.2.2.4.3">′</ci></apply><interval closure="open" id="S4.SS1.p1.5.m1.2.2.2.3.cmml" xref="S4.SS1.p1.5.m1.2.2.2.2"><apply id="S4.SS1.p1.5.m1.1.1.1.1.1.cmml" xref="S4.SS1.p1.5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.5.m1.1.1.1.1.1">superscript</csymbol><apply id="S4.SS1.p1.5.m1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p1.5.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.5.m1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p1.5.m1.1.1.1.1.1.2.2">𝑥</ci><ci id="S4.SS1.p1.5.m1.1.1.1.1.1.2.3.cmml" xref="S4.SS1.p1.5.m1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S4.SS1.p1.5.m1.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.5.m1.1.1.1.1.1.3">′</ci></apply><apply id="S4.SS1.p1.5.m1.2.2.2.2.2.cmml" xref="S4.SS1.p1.5.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m1.2.2.2.2.2.1.cmml" xref="S4.SS1.p1.5.m1.2.2.2.2.2">superscript</csymbol><apply id="S4.SS1.p1.5.m1.2.2.2.2.2.2.cmml" xref="S4.SS1.p1.5.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m1.2.2.2.2.2.2.1.cmml" xref="S4.SS1.p1.5.m1.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.5.m1.2.2.2.2.2.2.2.cmml" xref="S4.SS1.p1.5.m1.2.2.2.2.2.2.2">𝑦</ci><ci id="S4.SS1.p1.5.m1.2.2.2.2.2.2.3.cmml" xref="S4.SS1.p1.5.m1.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="S4.SS1.p1.5.m1.2.2.2.2.2.3.cmml" xref="S4.SS1.p1.5.m1.2.2.2.2.2.3">′</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m1.2c">F^{\prime}(x_{t}^{\prime},y_{t}^{\prime})</annotation></semantics></math> that matches the size of the gradient vector observed by the client. Although further empirical studies have found the cosine distance to provide better convergence results <cite class="ltx_cite ltx_citemacro_citep">(Geiping et al., <a href="#bib.bib5" title="" class="ltx_ref">2020</a>)</cite>:</p>
<table id="S4.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E12.m1.6" class="ltx_Math" alttext="g^{ang}(x_{t}^{\prime},y_{t}^{\prime})=\mathrm{min}\,1-\frac{\langle\Delta W_{t}^{\prime},\Delta W_{t}\rangle}{||\Delta W_{t}^{\prime}||\cdot||\Delta W_{t}||}" display="block"><semantics id="S4.E12.m1.6a"><mrow id="S4.E12.m1.6.6" xref="S4.E12.m1.6.6.cmml"><mrow id="S4.E12.m1.6.6.2" xref="S4.E12.m1.6.6.2.cmml"><msup id="S4.E12.m1.6.6.2.4" xref="S4.E12.m1.6.6.2.4.cmml"><mi id="S4.E12.m1.6.6.2.4.2" xref="S4.E12.m1.6.6.2.4.2.cmml">g</mi><mrow id="S4.E12.m1.6.6.2.4.3" xref="S4.E12.m1.6.6.2.4.3.cmml"><mi id="S4.E12.m1.6.6.2.4.3.2" xref="S4.E12.m1.6.6.2.4.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.6.6.2.4.3.1" xref="S4.E12.m1.6.6.2.4.3.1.cmml">​</mo><mi id="S4.E12.m1.6.6.2.4.3.3" xref="S4.E12.m1.6.6.2.4.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.6.6.2.4.3.1a" xref="S4.E12.m1.6.6.2.4.3.1.cmml">​</mo><mi id="S4.E12.m1.6.6.2.4.3.4" xref="S4.E12.m1.6.6.2.4.3.4.cmml">g</mi></mrow></msup><mo lspace="0em" rspace="0em" id="S4.E12.m1.6.6.2.3" xref="S4.E12.m1.6.6.2.3.cmml">​</mo><mrow id="S4.E12.m1.6.6.2.2.2" xref="S4.E12.m1.6.6.2.2.3.cmml"><mo stretchy="false" id="S4.E12.m1.6.6.2.2.2.3" xref="S4.E12.m1.6.6.2.2.3.cmml">(</mo><msubsup id="S4.E12.m1.5.5.1.1.1.1" xref="S4.E12.m1.5.5.1.1.1.1.cmml"><mi id="S4.E12.m1.5.5.1.1.1.1.2.2" xref="S4.E12.m1.5.5.1.1.1.1.2.2.cmml">x</mi><mi id="S4.E12.m1.5.5.1.1.1.1.2.3" xref="S4.E12.m1.5.5.1.1.1.1.2.3.cmml">t</mi><mo id="S4.E12.m1.5.5.1.1.1.1.3" xref="S4.E12.m1.5.5.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S4.E12.m1.6.6.2.2.2.4" xref="S4.E12.m1.6.6.2.2.3.cmml">,</mo><msubsup id="S4.E12.m1.6.6.2.2.2.2" xref="S4.E12.m1.6.6.2.2.2.2.cmml"><mi id="S4.E12.m1.6.6.2.2.2.2.2.2" xref="S4.E12.m1.6.6.2.2.2.2.2.2.cmml">y</mi><mi id="S4.E12.m1.6.6.2.2.2.2.2.3" xref="S4.E12.m1.6.6.2.2.2.2.2.3.cmml">t</mi><mo id="S4.E12.m1.6.6.2.2.2.2.3" xref="S4.E12.m1.6.6.2.2.2.2.3.cmml">′</mo></msubsup><mo stretchy="false" id="S4.E12.m1.6.6.2.2.2.5" xref="S4.E12.m1.6.6.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E12.m1.6.6.3" xref="S4.E12.m1.6.6.3.cmml">=</mo><mrow id="S4.E12.m1.6.6.4" xref="S4.E12.m1.6.6.4.cmml"><mrow id="S4.E12.m1.6.6.4.2" xref="S4.E12.m1.6.6.4.2.cmml"><mi id="S4.E12.m1.6.6.4.2.2" xref="S4.E12.m1.6.6.4.2.2.cmml">min</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.6.6.4.2.1" xref="S4.E12.m1.6.6.4.2.1.cmml">​</mo><mn id="S4.E12.m1.6.6.4.2.3" xref="S4.E12.m1.6.6.4.2.3.cmml"> 1</mn></mrow><mo id="S4.E12.m1.6.6.4.1" xref="S4.E12.m1.6.6.4.1.cmml">−</mo><mfrac id="S4.E12.m1.4.4" xref="S4.E12.m1.4.4.cmml"><mrow id="S4.E12.m1.2.2.2.2" xref="S4.E12.m1.2.2.2.3.cmml"><mo stretchy="false" id="S4.E12.m1.2.2.2.2.3" xref="S4.E12.m1.2.2.2.3.cmml">⟨</mo><mrow id="S4.E12.m1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S4.E12.m1.1.1.1.1.1.2" xref="S4.E12.m1.1.1.1.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.cmml">​</mo><msubsup id="S4.E12.m1.1.1.1.1.1.3" xref="S4.E12.m1.1.1.1.1.1.3.cmml"><mi id="S4.E12.m1.1.1.1.1.1.3.2.2" xref="S4.E12.m1.1.1.1.1.1.3.2.2.cmml">W</mi><mi id="S4.E12.m1.1.1.1.1.1.3.2.3" xref="S4.E12.m1.1.1.1.1.1.3.2.3.cmml">t</mi><mo id="S4.E12.m1.1.1.1.1.1.3.3" xref="S4.E12.m1.1.1.1.1.1.3.3.cmml">′</mo></msubsup></mrow><mo id="S4.E12.m1.2.2.2.2.4" xref="S4.E12.m1.2.2.2.3.cmml">,</mo><mrow id="S4.E12.m1.2.2.2.2.2" xref="S4.E12.m1.2.2.2.2.2.cmml"><mi mathvariant="normal" id="S4.E12.m1.2.2.2.2.2.2" xref="S4.E12.m1.2.2.2.2.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.2.2.2.2.2.1" xref="S4.E12.m1.2.2.2.2.2.1.cmml">​</mo><msub id="S4.E12.m1.2.2.2.2.2.3" xref="S4.E12.m1.2.2.2.2.2.3.cmml"><mi id="S4.E12.m1.2.2.2.2.2.3.2" xref="S4.E12.m1.2.2.2.2.2.3.2.cmml">W</mi><mi id="S4.E12.m1.2.2.2.2.2.3.3" xref="S4.E12.m1.2.2.2.2.2.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S4.E12.m1.2.2.2.2.5" xref="S4.E12.m1.2.2.2.3.cmml">⟩</mo></mrow><mrow id="S4.E12.m1.4.4.4" xref="S4.E12.m1.4.4.4.cmml"><mrow id="S4.E12.m1.3.3.3.1.1" xref="S4.E12.m1.3.3.3.1.2.cmml"><mo stretchy="false" id="S4.E12.m1.3.3.3.1.1.2" xref="S4.E12.m1.3.3.3.1.2.1.cmml">‖</mo><mrow id="S4.E12.m1.3.3.3.1.1.1" xref="S4.E12.m1.3.3.3.1.1.1.cmml"><mi mathvariant="normal" id="S4.E12.m1.3.3.3.1.1.1.2" xref="S4.E12.m1.3.3.3.1.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.3.3.3.1.1.1.1" xref="S4.E12.m1.3.3.3.1.1.1.1.cmml">​</mo><msubsup id="S4.E12.m1.3.3.3.1.1.1.3" xref="S4.E12.m1.3.3.3.1.1.1.3.cmml"><mi id="S4.E12.m1.3.3.3.1.1.1.3.2.2" xref="S4.E12.m1.3.3.3.1.1.1.3.2.2.cmml">W</mi><mi id="S4.E12.m1.3.3.3.1.1.1.3.2.3" xref="S4.E12.m1.3.3.3.1.1.1.3.2.3.cmml">t</mi><mo id="S4.E12.m1.3.3.3.1.1.1.3.3" xref="S4.E12.m1.3.3.3.1.1.1.3.3.cmml">′</mo></msubsup></mrow><mo rspace="0.055em" stretchy="false" id="S4.E12.m1.3.3.3.1.1.3" xref="S4.E12.m1.3.3.3.1.2.1.cmml">‖</mo></mrow><mo rspace="0.222em" id="S4.E12.m1.4.4.4.3" xref="S4.E12.m1.4.4.4.3.cmml">⋅</mo><mrow id="S4.E12.m1.4.4.4.2.1" xref="S4.E12.m1.4.4.4.2.2.cmml"><mo stretchy="false" id="S4.E12.m1.4.4.4.2.1.2" xref="S4.E12.m1.4.4.4.2.2.1.cmml">‖</mo><mrow id="S4.E12.m1.4.4.4.2.1.1" xref="S4.E12.m1.4.4.4.2.1.1.cmml"><mi mathvariant="normal" id="S4.E12.m1.4.4.4.2.1.1.2" xref="S4.E12.m1.4.4.4.2.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.4.4.4.2.1.1.1" xref="S4.E12.m1.4.4.4.2.1.1.1.cmml">​</mo><msub id="S4.E12.m1.4.4.4.2.1.1.3" xref="S4.E12.m1.4.4.4.2.1.1.3.cmml"><mi id="S4.E12.m1.4.4.4.2.1.1.3.2" xref="S4.E12.m1.4.4.4.2.1.1.3.2.cmml">W</mi><mi id="S4.E12.m1.4.4.4.2.1.1.3.3" xref="S4.E12.m1.4.4.4.2.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S4.E12.m1.4.4.4.2.1.3" xref="S4.E12.m1.4.4.4.2.2.1.cmml">‖</mo></mrow></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.6b"><apply id="S4.E12.m1.6.6.cmml" xref="S4.E12.m1.6.6"><eq id="S4.E12.m1.6.6.3.cmml" xref="S4.E12.m1.6.6.3"></eq><apply id="S4.E12.m1.6.6.2.cmml" xref="S4.E12.m1.6.6.2"><times id="S4.E12.m1.6.6.2.3.cmml" xref="S4.E12.m1.6.6.2.3"></times><apply id="S4.E12.m1.6.6.2.4.cmml" xref="S4.E12.m1.6.6.2.4"><csymbol cd="ambiguous" id="S4.E12.m1.6.6.2.4.1.cmml" xref="S4.E12.m1.6.6.2.4">superscript</csymbol><ci id="S4.E12.m1.6.6.2.4.2.cmml" xref="S4.E12.m1.6.6.2.4.2">𝑔</ci><apply id="S4.E12.m1.6.6.2.4.3.cmml" xref="S4.E12.m1.6.6.2.4.3"><times id="S4.E12.m1.6.6.2.4.3.1.cmml" xref="S4.E12.m1.6.6.2.4.3.1"></times><ci id="S4.E12.m1.6.6.2.4.3.2.cmml" xref="S4.E12.m1.6.6.2.4.3.2">𝑎</ci><ci id="S4.E12.m1.6.6.2.4.3.3.cmml" xref="S4.E12.m1.6.6.2.4.3.3">𝑛</ci><ci id="S4.E12.m1.6.6.2.4.3.4.cmml" xref="S4.E12.m1.6.6.2.4.3.4">𝑔</ci></apply></apply><interval closure="open" id="S4.E12.m1.6.6.2.2.3.cmml" xref="S4.E12.m1.6.6.2.2.2"><apply id="S4.E12.m1.5.5.1.1.1.1.cmml" xref="S4.E12.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.5.5.1.1.1.1.1.cmml" xref="S4.E12.m1.5.5.1.1.1.1">superscript</csymbol><apply id="S4.E12.m1.5.5.1.1.1.1.2.cmml" xref="S4.E12.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.5.5.1.1.1.1.2.1.cmml" xref="S4.E12.m1.5.5.1.1.1.1">subscript</csymbol><ci id="S4.E12.m1.5.5.1.1.1.1.2.2.cmml" xref="S4.E12.m1.5.5.1.1.1.1.2.2">𝑥</ci><ci id="S4.E12.m1.5.5.1.1.1.1.2.3.cmml" xref="S4.E12.m1.5.5.1.1.1.1.2.3">𝑡</ci></apply><ci id="S4.E12.m1.5.5.1.1.1.1.3.cmml" xref="S4.E12.m1.5.5.1.1.1.1.3">′</ci></apply><apply id="S4.E12.m1.6.6.2.2.2.2.cmml" xref="S4.E12.m1.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.6.6.2.2.2.2.1.cmml" xref="S4.E12.m1.6.6.2.2.2.2">superscript</csymbol><apply id="S4.E12.m1.6.6.2.2.2.2.2.cmml" xref="S4.E12.m1.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.6.6.2.2.2.2.2.1.cmml" xref="S4.E12.m1.6.6.2.2.2.2">subscript</csymbol><ci id="S4.E12.m1.6.6.2.2.2.2.2.2.cmml" xref="S4.E12.m1.6.6.2.2.2.2.2.2">𝑦</ci><ci id="S4.E12.m1.6.6.2.2.2.2.2.3.cmml" xref="S4.E12.m1.6.6.2.2.2.2.2.3">𝑡</ci></apply><ci id="S4.E12.m1.6.6.2.2.2.2.3.cmml" xref="S4.E12.m1.6.6.2.2.2.2.3">′</ci></apply></interval></apply><apply id="S4.E12.m1.6.6.4.cmml" xref="S4.E12.m1.6.6.4"><minus id="S4.E12.m1.6.6.4.1.cmml" xref="S4.E12.m1.6.6.4.1"></minus><apply id="S4.E12.m1.6.6.4.2.cmml" xref="S4.E12.m1.6.6.4.2"><times id="S4.E12.m1.6.6.4.2.1.cmml" xref="S4.E12.m1.6.6.4.2.1"></times><ci id="S4.E12.m1.6.6.4.2.2.cmml" xref="S4.E12.m1.6.6.4.2.2">min</ci><cn type="integer" id="S4.E12.m1.6.6.4.2.3.cmml" xref="S4.E12.m1.6.6.4.2.3">1</cn></apply><apply id="S4.E12.m1.4.4.cmml" xref="S4.E12.m1.4.4"><divide id="S4.E12.m1.4.4.5.cmml" xref="S4.E12.m1.4.4"></divide><list id="S4.E12.m1.2.2.2.3.cmml" xref="S4.E12.m1.2.2.2.2"><apply id="S4.E12.m1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1"><times id="S4.E12.m1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1"></times><ci id="S4.E12.m1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.1.2">Δ</ci><apply id="S4.E12.m1.1.1.1.1.1.3.cmml" xref="S4.E12.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.3.1.cmml" xref="S4.E12.m1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E12.m1.1.1.1.1.1.3.2.cmml" xref="S4.E12.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.3.2.1.cmml" xref="S4.E12.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.1.3.2.2.cmml" xref="S4.E12.m1.1.1.1.1.1.3.2.2">𝑊</ci><ci id="S4.E12.m1.1.1.1.1.1.3.2.3.cmml" xref="S4.E12.m1.1.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="S4.E12.m1.1.1.1.1.1.3.3.cmml" xref="S4.E12.m1.1.1.1.1.1.3.3">′</ci></apply></apply><apply id="S4.E12.m1.2.2.2.2.2.cmml" xref="S4.E12.m1.2.2.2.2.2"><times id="S4.E12.m1.2.2.2.2.2.1.cmml" xref="S4.E12.m1.2.2.2.2.2.1"></times><ci id="S4.E12.m1.2.2.2.2.2.2.cmml" xref="S4.E12.m1.2.2.2.2.2.2">Δ</ci><apply id="S4.E12.m1.2.2.2.2.2.3.cmml" xref="S4.E12.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E12.m1.2.2.2.2.2.3.1.cmml" xref="S4.E12.m1.2.2.2.2.2.3">subscript</csymbol><ci id="S4.E12.m1.2.2.2.2.2.3.2.cmml" xref="S4.E12.m1.2.2.2.2.2.3.2">𝑊</ci><ci id="S4.E12.m1.2.2.2.2.2.3.3.cmml" xref="S4.E12.m1.2.2.2.2.2.3.3">𝑡</ci></apply></apply></list><apply id="S4.E12.m1.4.4.4.cmml" xref="S4.E12.m1.4.4.4"><ci id="S4.E12.m1.4.4.4.3.cmml" xref="S4.E12.m1.4.4.4.3">⋅</ci><apply id="S4.E12.m1.3.3.3.1.2.cmml" xref="S4.E12.m1.3.3.3.1.1"><csymbol cd="latexml" id="S4.E12.m1.3.3.3.1.2.1.cmml" xref="S4.E12.m1.3.3.3.1.1.2">norm</csymbol><apply id="S4.E12.m1.3.3.3.1.1.1.cmml" xref="S4.E12.m1.3.3.3.1.1.1"><times id="S4.E12.m1.3.3.3.1.1.1.1.cmml" xref="S4.E12.m1.3.3.3.1.1.1.1"></times><ci id="S4.E12.m1.3.3.3.1.1.1.2.cmml" xref="S4.E12.m1.3.3.3.1.1.1.2">Δ</ci><apply id="S4.E12.m1.3.3.3.1.1.1.3.cmml" xref="S4.E12.m1.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.3.1.1.1.3.1.cmml" xref="S4.E12.m1.3.3.3.1.1.1.3">superscript</csymbol><apply id="S4.E12.m1.3.3.3.1.1.1.3.2.cmml" xref="S4.E12.m1.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.3.1.1.1.3.2.1.cmml" xref="S4.E12.m1.3.3.3.1.1.1.3">subscript</csymbol><ci id="S4.E12.m1.3.3.3.1.1.1.3.2.2.cmml" xref="S4.E12.m1.3.3.3.1.1.1.3.2.2">𝑊</ci><ci id="S4.E12.m1.3.3.3.1.1.1.3.2.3.cmml" xref="S4.E12.m1.3.3.3.1.1.1.3.2.3">𝑡</ci></apply><ci id="S4.E12.m1.3.3.3.1.1.1.3.3.cmml" xref="S4.E12.m1.3.3.3.1.1.1.3.3">′</ci></apply></apply></apply><apply id="S4.E12.m1.4.4.4.2.2.cmml" xref="S4.E12.m1.4.4.4.2.1"><csymbol cd="latexml" id="S4.E12.m1.4.4.4.2.2.1.cmml" xref="S4.E12.m1.4.4.4.2.1.2">norm</csymbol><apply id="S4.E12.m1.4.4.4.2.1.1.cmml" xref="S4.E12.m1.4.4.4.2.1.1"><times id="S4.E12.m1.4.4.4.2.1.1.1.cmml" xref="S4.E12.m1.4.4.4.2.1.1.1"></times><ci id="S4.E12.m1.4.4.4.2.1.1.2.cmml" xref="S4.E12.m1.4.4.4.2.1.1.2">Δ</ci><apply id="S4.E12.m1.4.4.4.2.1.1.3.cmml" xref="S4.E12.m1.4.4.4.2.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.4.4.4.2.1.1.3.1.cmml" xref="S4.E12.m1.4.4.4.2.1.1.3">subscript</csymbol><ci id="S4.E12.m1.4.4.4.2.1.1.3.2.cmml" xref="S4.E12.m1.4.4.4.2.1.1.3.2">𝑊</ci><ci id="S4.E12.m1.4.4.4.2.1.1.3.3.cmml" xref="S4.E12.m1.4.4.4.2.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.6c">g^{ang}(x_{t}^{\prime},y_{t}^{\prime})=\mathrm{min}\,1-\frac{\langle\Delta W_{t}^{\prime},\Delta W_{t}\rangle}{||\Delta W_{t}^{\prime}||\cdot||\Delta W_{t}||}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p1.6" class="ltx_p">Various regularisation terms were shown to improve convergence. For example, regularisation that penalises high variations in the input images and constrains the search to high-fidelity images and de-noised solutions <cite class="ltx_cite ltx_citemacro_citep">(Geiping et al., <a href="#bib.bib5" title="" class="ltx_ref">2020</a>; Yin et al., <a href="#bib.bib25" title="" class="ltx_ref">2021</a>)</cite>. In mini-batches the orthogonality <cite class="ltx_cite ltx_citemacro_citep">(Qian et al., <a href="#bib.bib16" title="" class="ltx_ref">2021</a>)</cite> between input vectors in the batch has been shown to bias the search towards different vectors in the batch. Additionally it has been found that determining the label from the gradients is important for initialisation of the numerical optimisation <cite class="ltx_cite ltx_citemacro_citep">(Yin et al., <a href="#bib.bib25" title="" class="ltx_ref">2021</a>)</cite>.
We have also seen in the literature various type of attacks that provide improvements in image fidelity, or training convergence. Since no work so far is focused on enforcing the leakage of minimal information, in our study in section <a href="#S5" title="5 Experimental Results ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> we apply various types of attacks and regularisation terms to provide a comprehensive analysis without any prior assumption on the performance of the attack. As summarised in Table <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:attacks</span>, we utilise both the Euclidean distance and cosine similarity objective functions proposed by recent prior work <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al., <a href="#bib.bib28" title="" class="ltx_ref">2019</a>; Geiping et al., <a href="#bib.bib5" title="" class="ltx_ref">2020</a>)</cite> including a selection of popular regularisation functions.</p>
</div>
<section id="S4.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1 </span>Determining the Labels in a Mini-Batch</h4>

<div id="S4.SS1.SSS1.p1" class="ltx_para">
<p id="S4.SS1.SSS1.p1.15" class="ltx_p">One of the important characteristics for fast attack convergence is the initial determination of the labels which reduces the number of unknowns in the dense layer from <math id="S4.SS1.SSS1.p1.1.m1.1" class="ltx_Math" alttext="nB+CB" display="inline"><semantics id="S4.SS1.SSS1.p1.1.m1.1a"><mrow id="S4.SS1.SSS1.p1.1.m1.1.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.cmml"><mrow id="S4.SS1.SSS1.p1.1.m1.1.1.2" xref="S4.SS1.SSS1.p1.1.m1.1.1.2.cmml"><mi id="S4.SS1.SSS1.p1.1.m1.1.1.2.2" xref="S4.SS1.SSS1.p1.1.m1.1.1.2.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p1.1.m1.1.1.2.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.2.1.cmml">​</mo><mi id="S4.SS1.SSS1.p1.1.m1.1.1.2.3" xref="S4.SS1.SSS1.p1.1.m1.1.1.2.3.cmml">B</mi></mrow><mo id="S4.SS1.SSS1.p1.1.m1.1.1.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.cmml">+</mo><mrow id="S4.SS1.SSS1.p1.1.m1.1.1.3" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.cmml"><mi id="S4.SS1.SSS1.p1.1.m1.1.1.3.2" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p1.1.m1.1.1.3.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS1.SSS1.p1.1.m1.1.1.3.3" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.3.cmml">B</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.1.m1.1b"><apply id="S4.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1"><plus id="S4.SS1.SSS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.1"></plus><apply id="S4.SS1.SSS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.2"><times id="S4.SS1.SSS1.p1.1.m1.1.1.2.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.2.1"></times><ci id="S4.SS1.SSS1.p1.1.m1.1.1.2.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.2.2">𝑛</ci><ci id="S4.SS1.SSS1.p1.1.m1.1.1.2.3.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.2.3">𝐵</ci></apply><apply id="S4.SS1.SSS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.3"><times id="S4.SS1.SSS1.p1.1.m1.1.1.3.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.1"></times><ci id="S4.SS1.SSS1.p1.1.m1.1.1.3.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.2">𝐶</ci><ci id="S4.SS1.SSS1.p1.1.m1.1.1.3.3.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.3">𝐵</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.1.m1.1c">nB+CB</annotation></semantics></math> to only <math id="S4.SS1.SSS1.p1.2.m2.1" class="ltx_Math" alttext="nB" display="inline"><semantics id="S4.SS1.SSS1.p1.2.m2.1a"><mrow id="S4.SS1.SSS1.p1.2.m2.1.1" xref="S4.SS1.SSS1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.SSS1.p1.2.m2.1.1.2" xref="S4.SS1.SSS1.p1.2.m2.1.1.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p1.2.m2.1.1.1" xref="S4.SS1.SSS1.p1.2.m2.1.1.1.cmml">​</mo><mi id="S4.SS1.SSS1.p1.2.m2.1.1.3" xref="S4.SS1.SSS1.p1.2.m2.1.1.3.cmml">B</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.2.m2.1b"><apply id="S4.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1"><times id="S4.SS1.SSS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.1"></times><ci id="S4.SS1.SSS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.2">𝑛</ci><ci id="S4.SS1.SSS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.2.m2.1c">nB</annotation></semantics></math> (for a classification task only). A typical classification model contains a softmax followed by a cross-entropy loss on neural network output. Labels can be obtained in this context by choosing the negative gradients to be the labels. Recall if <math id="S4.SS1.SSS1.p1.3.m3.1" class="ltx_Math" alttext="p_{j}^{m}" display="inline"><semantics id="S4.SS1.SSS1.p1.3.m3.1a"><msubsup id="S4.SS1.SSS1.p1.3.m3.1.1" xref="S4.SS1.SSS1.p1.3.m3.1.1.cmml"><mi id="S4.SS1.SSS1.p1.3.m3.1.1.2.2" xref="S4.SS1.SSS1.p1.3.m3.1.1.2.2.cmml">p</mi><mi id="S4.SS1.SSS1.p1.3.m3.1.1.2.3" xref="S4.SS1.SSS1.p1.3.m3.1.1.2.3.cmml">j</mi><mi id="S4.SS1.SSS1.p1.3.m3.1.1.3" xref="S4.SS1.SSS1.p1.3.m3.1.1.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.3.m3.1b"><apply id="S4.SS1.SSS1.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.3.m3.1.1.2.1.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p1.3.m3.1.1.2.2.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1.2.2">𝑝</ci><ci id="S4.SS1.SSS1.p1.3.m3.1.1.2.3.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1.2.3">𝑗</ci></apply><ci id="S4.SS1.SSS1.p1.3.m3.1.1.3.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.3.m3.1c">p_{j}^{m}</annotation></semantics></math> is close to zero in an untrained model, from the distribution of the negative gradients it is possible to identify all the distribution of labels and even similar labels, as has also been suggested previously <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a href="#bib.bib26" title="" class="ltx_ref">2020</a>; Yin et al., <a href="#bib.bib25" title="" class="ltx_ref">2021</a>)</cite>. However here we stress that this is possible only when <math id="S4.SS1.SSS1.p1.4.m4.1" class="ltx_Math" alttext="C\gg B" display="inline"><semantics id="S4.SS1.SSS1.p1.4.m4.1a"><mrow id="S4.SS1.SSS1.p1.4.m4.1.1" xref="S4.SS1.SSS1.p1.4.m4.1.1.cmml"><mi id="S4.SS1.SSS1.p1.4.m4.1.1.2" xref="S4.SS1.SSS1.p1.4.m4.1.1.2.cmml">C</mi><mo id="S4.SS1.SSS1.p1.4.m4.1.1.1" xref="S4.SS1.SSS1.p1.4.m4.1.1.1.cmml">≫</mo><mi id="S4.SS1.SSS1.p1.4.m4.1.1.3" xref="S4.SS1.SSS1.p1.4.m4.1.1.3.cmml">B</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.4.m4.1b"><apply id="S4.SS1.SSS1.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS1.p1.4.m4.1.1"><csymbol cd="latexml" id="S4.SS1.SSS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.SSS1.p1.4.m4.1.1.1">much-greater-than</csymbol><ci id="S4.SS1.SSS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.SSS1.p1.4.m4.1.1.2">𝐶</ci><ci id="S4.SS1.SSS1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.SSS1.p1.4.m4.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.4.m4.1c">C\gg B</annotation></semantics></math> but not necessarily true when <math id="S4.SS1.SSS1.p1.5.m5.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S4.SS1.SSS1.p1.5.m5.1a"><mi id="S4.SS1.SSS1.p1.5.m5.1.1" xref="S4.SS1.SSS1.p1.5.m5.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.5.m5.1b"><ci id="S4.SS1.SSS1.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS1.p1.5.m5.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.5.m5.1c">B</annotation></semantics></math> is comparable to <math id="S4.SS1.SSS1.p1.6.m6.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS1.SSS1.p1.6.m6.1a"><mi id="S4.SS1.SSS1.p1.6.m6.1.1" xref="S4.SS1.SSS1.p1.6.m6.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.6.m6.1b"><ci id="S4.SS1.SSS1.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS1.p1.6.m6.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.6.m6.1c">C</annotation></semantics></math>. This is due to the fact that <math id="S4.SS1.SSS1.p1.7.m7.1" class="ltx_Math" alttext="p_{j}^{m}" display="inline"><semantics id="S4.SS1.SSS1.p1.7.m7.1a"><msubsup id="S4.SS1.SSS1.p1.7.m7.1.1" xref="S4.SS1.SSS1.p1.7.m7.1.1.cmml"><mi id="S4.SS1.SSS1.p1.7.m7.1.1.2.2" xref="S4.SS1.SSS1.p1.7.m7.1.1.2.2.cmml">p</mi><mi id="S4.SS1.SSS1.p1.7.m7.1.1.2.3" xref="S4.SS1.SSS1.p1.7.m7.1.1.2.3.cmml">j</mi><mi id="S4.SS1.SSS1.p1.7.m7.1.1.3" xref="S4.SS1.SSS1.p1.7.m7.1.1.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.7.m7.1b"><apply id="S4.SS1.SSS1.p1.7.m7.1.1.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.7.m7.1.1.1.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p1.7.m7.1.1.2.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.7.m7.1.1.2.1.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p1.7.m7.1.1.2.2.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1.2.2">𝑝</ci><ci id="S4.SS1.SSS1.p1.7.m7.1.1.2.3.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1.2.3">𝑗</ci></apply><ci id="S4.SS1.SSS1.p1.7.m7.1.1.3.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.7.m7.1c">p_{j}^{m}</annotation></semantics></math> (see Eq. (<a href="#S3.E4" title="In 3.2 Direct inversion of a full batch ‣ 3 Gradient mixing as a batch defense strategy ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>)) can obtain significant positive values for certain <math id="S4.SS1.SSS1.p1.8.m8.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S4.SS1.SSS1.p1.8.m8.1a"><mi id="S4.SS1.SSS1.p1.8.m8.1.1" xref="S4.SS1.SSS1.p1.8.m8.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.8.m8.1b"><ci id="S4.SS1.SSS1.p1.8.m8.1.1.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.8.m8.1c">j</annotation></semantics></math> when <math id="S4.SS1.SSS1.p1.9.m9.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS1.SSS1.p1.9.m9.1a"><mi id="S4.SS1.SSS1.p1.9.m9.1.1" xref="S4.SS1.SSS1.p1.9.m9.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.9.m9.1b"><ci id="S4.SS1.SSS1.p1.9.m9.1.1.cmml" xref="S4.SS1.SSS1.p1.9.m9.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.9.m9.1c">C</annotation></semantics></math> is small, and can even result in average positive gradients when <math id="S4.SS1.SSS1.p1.10.m10.1" class="ltx_Math" alttext="j=C" display="inline"><semantics id="S4.SS1.SSS1.p1.10.m10.1a"><mrow id="S4.SS1.SSS1.p1.10.m10.1.1" xref="S4.SS1.SSS1.p1.10.m10.1.1.cmml"><mi id="S4.SS1.SSS1.p1.10.m10.1.1.2" xref="S4.SS1.SSS1.p1.10.m10.1.1.2.cmml">j</mi><mo id="S4.SS1.SSS1.p1.10.m10.1.1.1" xref="S4.SS1.SSS1.p1.10.m10.1.1.1.cmml">=</mo><mi id="S4.SS1.SSS1.p1.10.m10.1.1.3" xref="S4.SS1.SSS1.p1.10.m10.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.10.m10.1b"><apply id="S4.SS1.SSS1.p1.10.m10.1.1.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.1"><eq id="S4.SS1.SSS1.p1.10.m10.1.1.1.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.1.1"></eq><ci id="S4.SS1.SSS1.p1.10.m10.1.1.2.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.1.2">𝑗</ci><ci id="S4.SS1.SSS1.p1.10.m10.1.1.3.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.10.m10.1c">j=C</annotation></semantics></math>. This for example occurs in the MNIST dataset where <math id="S4.SS1.SSS1.p1.11.m11.1" class="ltx_Math" alttext="C=10" display="inline"><semantics id="S4.SS1.SSS1.p1.11.m11.1a"><mrow id="S4.SS1.SSS1.p1.11.m11.1.1" xref="S4.SS1.SSS1.p1.11.m11.1.1.cmml"><mi id="S4.SS1.SSS1.p1.11.m11.1.1.2" xref="S4.SS1.SSS1.p1.11.m11.1.1.2.cmml">C</mi><mo id="S4.SS1.SSS1.p1.11.m11.1.1.1" xref="S4.SS1.SSS1.p1.11.m11.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS1.p1.11.m11.1.1.3" xref="S4.SS1.SSS1.p1.11.m11.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.11.m11.1b"><apply id="S4.SS1.SSS1.p1.11.m11.1.1.cmml" xref="S4.SS1.SSS1.p1.11.m11.1.1"><eq id="S4.SS1.SSS1.p1.11.m11.1.1.1.cmml" xref="S4.SS1.SSS1.p1.11.m11.1.1.1"></eq><ci id="S4.SS1.SSS1.p1.11.m11.1.1.2.cmml" xref="S4.SS1.SSS1.p1.11.m11.1.1.2">𝐶</ci><cn type="integer" id="S4.SS1.SSS1.p1.11.m11.1.1.3.cmml" xref="S4.SS1.SSS1.p1.11.m11.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.11.m11.1c">C=10</annotation></semantics></math> but will not be observed in LFW with large <math id="S4.SS1.SSS1.p1.12.m12.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS1.SSS1.p1.12.m12.1a"><mi id="S4.SS1.SSS1.p1.12.m12.1.1" xref="S4.SS1.SSS1.p1.12.m12.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.12.m12.1b"><ci id="S4.SS1.SSS1.p1.12.m12.1.1.cmml" xref="S4.SS1.SSS1.p1.12.m12.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.12.m12.1c">C</annotation></semantics></math>. In the case of the MSE loss, we cannot initialise the labels distribution directly from the gradient sign, as <math id="S4.SS1.SSS1.p1.13.m13.1" class="ltx_Math" alttext="o_{j}" display="inline"><semantics id="S4.SS1.SSS1.p1.13.m13.1a"><msub id="S4.SS1.SSS1.p1.13.m13.1.1" xref="S4.SS1.SSS1.p1.13.m13.1.1.cmml"><mi id="S4.SS1.SSS1.p1.13.m13.1.1.2" xref="S4.SS1.SSS1.p1.13.m13.1.1.2.cmml">o</mi><mi id="S4.SS1.SSS1.p1.13.m13.1.1.3" xref="S4.SS1.SSS1.p1.13.m13.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.13.m13.1b"><apply id="S4.SS1.SSS1.p1.13.m13.1.1.cmml" xref="S4.SS1.SSS1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.13.m13.1.1.1.cmml" xref="S4.SS1.SSS1.p1.13.m13.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p1.13.m13.1.1.2.cmml" xref="S4.SS1.SSS1.p1.13.m13.1.1.2">𝑜</ci><ci id="S4.SS1.SSS1.p1.13.m13.1.1.3.cmml" xref="S4.SS1.SSS1.p1.13.m13.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.13.m13.1c">o_{j}</annotation></semantics></math> is proportional to <math id="S4.SS1.SSS1.p1.14.m14.1" class="ltx_Math" alttext="y_{j}" display="inline"><semantics id="S4.SS1.SSS1.p1.14.m14.1a"><msub id="S4.SS1.SSS1.p1.14.m14.1.1" xref="S4.SS1.SSS1.p1.14.m14.1.1.cmml"><mi id="S4.SS1.SSS1.p1.14.m14.1.1.2" xref="S4.SS1.SSS1.p1.14.m14.1.1.2.cmml">y</mi><mi id="S4.SS1.SSS1.p1.14.m14.1.1.3" xref="S4.SS1.SSS1.p1.14.m14.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.14.m14.1b"><apply id="S4.SS1.SSS1.p1.14.m14.1.1.cmml" xref="S4.SS1.SSS1.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.14.m14.1.1.1.cmml" xref="S4.SS1.SSS1.p1.14.m14.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p1.14.m14.1.1.2.cmml" xref="S4.SS1.SSS1.p1.14.m14.1.1.2">𝑦</ci><ci id="S4.SS1.SSS1.p1.14.m14.1.1.3.cmml" xref="S4.SS1.SSS1.p1.14.m14.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.14.m14.1c">y_{j}</annotation></semantics></math> in Eq. (<a href="#S3.E9" title="In 3.2 Direct inversion of a full batch ‣ 3 Gradient mixing as a batch defense strategy ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>) and Eq. (<a href="#S3.E10" title="In 3.2 Direct inversion of a full batch ‣ 3 Gradient mixing as a batch defense strategy ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>) . Hence, we suggest that although we determine the overall label distribution, we find that it is important to still optimize the labels output using the optimizer scheme in order to maximise the recovery of an MNIST attack for a batch.
Note that in a well trained model, it is also possible to estimate labels of a batch directly from <math id="S4.SS1.SSS1.p1.15.m15.1" class="ltx_Math" alttext="p_{j}^{m}" display="inline"><semantics id="S4.SS1.SSS1.p1.15.m15.1a"><msubsup id="S4.SS1.SSS1.p1.15.m15.1.1" xref="S4.SS1.SSS1.p1.15.m15.1.1.cmml"><mi id="S4.SS1.SSS1.p1.15.m15.1.1.2.2" xref="S4.SS1.SSS1.p1.15.m15.1.1.2.2.cmml">p</mi><mi id="S4.SS1.SSS1.p1.15.m15.1.1.2.3" xref="S4.SS1.SSS1.p1.15.m15.1.1.2.3.cmml">j</mi><mi id="S4.SS1.SSS1.p1.15.m15.1.1.3" xref="S4.SS1.SSS1.p1.15.m15.1.1.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.15.m15.1b"><apply id="S4.SS1.SSS1.p1.15.m15.1.1.cmml" xref="S4.SS1.SSS1.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.15.m15.1.1.1.cmml" xref="S4.SS1.SSS1.p1.15.m15.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p1.15.m15.1.1.2.cmml" xref="S4.SS1.SSS1.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.15.m15.1.1.2.1.cmml" xref="S4.SS1.SSS1.p1.15.m15.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p1.15.m15.1.1.2.2.cmml" xref="S4.SS1.SSS1.p1.15.m15.1.1.2.2">𝑝</ci><ci id="S4.SS1.SSS1.p1.15.m15.1.1.2.3.cmml" xref="S4.SS1.SSS1.p1.15.m15.1.1.2.3">𝑗</ci></apply><ci id="S4.SS1.SSS1.p1.15.m15.1.1.3.cmml" xref="S4.SS1.SSS1.p1.15.m15.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.15.m15.1c">p_{j}^{m}</annotation></semantics></math>, so typically FL frameworks do not protecting labels.</p>
</div>
<figure id="S4.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F4.1" class="ltx_figure ltx_figure_panel"><img src="/html/2204.12495/assets/x8.png" id="S4.F4.1.g1" class="ltx_graphics ltx_img_landscape" width="325" height="247" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F4.2" class="ltx_figure ltx_figure_panel"><img src="/html/2204.12495/assets/x9.png" id="S4.F4.2.g1" class="ltx_graphics ltx_img_landscape" width="332" height="228" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Random recovered vectors from MNIST (a) and LFW (b) datasets, column-wise sorted via the abs. variation distance measure. The AVD values were scaled to 1.0 by dividing the AVD for the distance between the initial uniform noise input image, to a black image.</figcaption>
</figure>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Criterion for Successful Attack</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">Many studies for improving attacks focus on fidelity of recovery and rate of convergence, e.g. <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a href="#bib.bib26" title="" class="ltx_ref">2020</a>; Qian et al., <a href="#bib.bib16" title="" class="ltx_ref">2021</a>; Yin et al., <a href="#bib.bib25" title="" class="ltx_ref">2021</a>)</cite>. Our focus is the opposite, to determine if any information regarding the data can be recovered. Therefore our criterion for a successful attack is minimal and we define it as the ability to obtain information for one input vector in a batch. For example in MNIST this is the ability to recognise any information that is distinguished from noise. The mean square error (MSE) and structural similarity index measure (SSIM) <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib22" title="" class="ltx_ref">2004</a>)</cite> are useful for high fidelity and small changes between images. We found that these metrics are not reliable and cannot be used as indicator for information leakage in datasets such as MNIST where the information is sparse. We can show this visible information in a random sample of recovered vectors from attacks in figure <a href="#S4.F4" title="Figure 4 ‣ 4.1.1 Determining the Labels in a Mini-Batch ‣ 4.1 Inversion Attack Optimisation Algorithms ‣ 4 Experimental framework ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>(a). The MSE indicator is not sufficient in the intermediate range where information is visible but noisy, blended, or there are other patterns that can significantly skew the results.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.2" class="ltx_p">A more suitable indicator is to compare the spatial gradient of the recovered image and source image:</p>
<table id="S4.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E13.m1.7" class="ltx_Math" alttext="\mathrm{AVD}(v^{source},v^{target})=||(|\nabla v^{source}_{x,y}|-|\nabla v^{target}_{x,y}|)||" display="block"><semantics id="S4.E13.m1.7a"><mrow id="S4.E13.m1.7.7" xref="S4.E13.m1.7.7.cmml"><mrow id="S4.E13.m1.6.6.2" xref="S4.E13.m1.6.6.2.cmml"><mi id="S4.E13.m1.6.6.2.4" xref="S4.E13.m1.6.6.2.4.cmml">AVD</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.6.6.2.3" xref="S4.E13.m1.6.6.2.3.cmml">​</mo><mrow id="S4.E13.m1.6.6.2.2.2" xref="S4.E13.m1.6.6.2.2.3.cmml"><mo stretchy="false" id="S4.E13.m1.6.6.2.2.2.3" xref="S4.E13.m1.6.6.2.2.3.cmml">(</mo><msup id="S4.E13.m1.5.5.1.1.1.1" xref="S4.E13.m1.5.5.1.1.1.1.cmml"><mi id="S4.E13.m1.5.5.1.1.1.1.2" xref="S4.E13.m1.5.5.1.1.1.1.2.cmml">v</mi><mrow id="S4.E13.m1.5.5.1.1.1.1.3" xref="S4.E13.m1.5.5.1.1.1.1.3.cmml"><mi id="S4.E13.m1.5.5.1.1.1.1.3.2" xref="S4.E13.m1.5.5.1.1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.5.5.1.1.1.1.3.1" xref="S4.E13.m1.5.5.1.1.1.1.3.1.cmml">​</mo><mi id="S4.E13.m1.5.5.1.1.1.1.3.3" xref="S4.E13.m1.5.5.1.1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.5.5.1.1.1.1.3.1a" xref="S4.E13.m1.5.5.1.1.1.1.3.1.cmml">​</mo><mi id="S4.E13.m1.5.5.1.1.1.1.3.4" xref="S4.E13.m1.5.5.1.1.1.1.3.4.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.5.5.1.1.1.1.3.1b" xref="S4.E13.m1.5.5.1.1.1.1.3.1.cmml">​</mo><mi id="S4.E13.m1.5.5.1.1.1.1.3.5" xref="S4.E13.m1.5.5.1.1.1.1.3.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.5.5.1.1.1.1.3.1c" xref="S4.E13.m1.5.5.1.1.1.1.3.1.cmml">​</mo><mi id="S4.E13.m1.5.5.1.1.1.1.3.6" xref="S4.E13.m1.5.5.1.1.1.1.3.6.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.5.5.1.1.1.1.3.1d" xref="S4.E13.m1.5.5.1.1.1.1.3.1.cmml">​</mo><mi id="S4.E13.m1.5.5.1.1.1.1.3.7" xref="S4.E13.m1.5.5.1.1.1.1.3.7.cmml">e</mi></mrow></msup><mo id="S4.E13.m1.6.6.2.2.2.4" xref="S4.E13.m1.6.6.2.2.3.cmml">,</mo><msup id="S4.E13.m1.6.6.2.2.2.2" xref="S4.E13.m1.6.6.2.2.2.2.cmml"><mi id="S4.E13.m1.6.6.2.2.2.2.2" xref="S4.E13.m1.6.6.2.2.2.2.2.cmml">v</mi><mrow id="S4.E13.m1.6.6.2.2.2.2.3" xref="S4.E13.m1.6.6.2.2.2.2.3.cmml"><mi id="S4.E13.m1.6.6.2.2.2.2.3.2" xref="S4.E13.m1.6.6.2.2.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.6.6.2.2.2.2.3.1" xref="S4.E13.m1.6.6.2.2.2.2.3.1.cmml">​</mo><mi id="S4.E13.m1.6.6.2.2.2.2.3.3" xref="S4.E13.m1.6.6.2.2.2.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.6.6.2.2.2.2.3.1a" xref="S4.E13.m1.6.6.2.2.2.2.3.1.cmml">​</mo><mi id="S4.E13.m1.6.6.2.2.2.2.3.4" xref="S4.E13.m1.6.6.2.2.2.2.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.6.6.2.2.2.2.3.1b" xref="S4.E13.m1.6.6.2.2.2.2.3.1.cmml">​</mo><mi id="S4.E13.m1.6.6.2.2.2.2.3.5" xref="S4.E13.m1.6.6.2.2.2.2.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.6.6.2.2.2.2.3.1c" xref="S4.E13.m1.6.6.2.2.2.2.3.1.cmml">​</mo><mi id="S4.E13.m1.6.6.2.2.2.2.3.6" xref="S4.E13.m1.6.6.2.2.2.2.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.6.6.2.2.2.2.3.1d" xref="S4.E13.m1.6.6.2.2.2.2.3.1.cmml">​</mo><mi id="S4.E13.m1.6.6.2.2.2.2.3.7" xref="S4.E13.m1.6.6.2.2.2.2.3.7.cmml">t</mi></mrow></msup><mo stretchy="false" id="S4.E13.m1.6.6.2.2.2.5" xref="S4.E13.m1.6.6.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E13.m1.7.7.4" xref="S4.E13.m1.7.7.4.cmml">=</mo><mrow id="S4.E13.m1.7.7.3.1" xref="S4.E13.m1.7.7.3.2.cmml"><mo stretchy="false" id="S4.E13.m1.7.7.3.1.2" xref="S4.E13.m1.7.7.3.2.1.cmml">‖</mo><mrow id="S4.E13.m1.7.7.3.1.1.1" xref="S4.E13.m1.7.7.3.1.1.1.1.cmml"><mo stretchy="false" id="S4.E13.m1.7.7.3.1.1.1.2" xref="S4.E13.m1.7.7.3.1.1.1.1.cmml">(</mo><mrow id="S4.E13.m1.7.7.3.1.1.1.1" xref="S4.E13.m1.7.7.3.1.1.1.1.cmml"><mrow id="S4.E13.m1.7.7.3.1.1.1.1.1.1" xref="S4.E13.m1.7.7.3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E13.m1.7.7.3.1.1.1.1.1.1.2" xref="S4.E13.m1.7.7.3.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.cmml"><mo rspace="0.167em" id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.1" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.1.cmml">∇</mo><msubsup id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.2" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.2.cmml">v</mi><mrow id="S4.E13.m1.2.2.2.4" xref="S4.E13.m1.2.2.2.3.cmml"><mi id="S4.E13.m1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.cmml">x</mi><mo id="S4.E13.m1.2.2.2.4.1" xref="S4.E13.m1.2.2.2.3.cmml">,</mo><mi id="S4.E13.m1.2.2.2.2" xref="S4.E13.m1.2.2.2.2.cmml">y</mi></mrow><mrow id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.2" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.1" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.3" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.1a" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.4" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.4.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.1b" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.5" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.1c" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.6" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.6.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.1d" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.7" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.7.cmml">e</mi></mrow></msubsup></mrow><mo stretchy="false" id="S4.E13.m1.7.7.3.1.1.1.1.1.1.3" xref="S4.E13.m1.7.7.3.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S4.E13.m1.7.7.3.1.1.1.1.3" xref="S4.E13.m1.7.7.3.1.1.1.1.3.cmml">−</mo><mrow id="S4.E13.m1.7.7.3.1.1.1.1.2.1" xref="S4.E13.m1.7.7.3.1.1.1.1.2.2.cmml"><mo stretchy="false" id="S4.E13.m1.7.7.3.1.1.1.1.2.1.2" xref="S4.E13.m1.7.7.3.1.1.1.1.2.2.1.cmml">|</mo><mrow id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.cmml"><mo rspace="0.167em" id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.1" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.1.cmml">∇</mo><msubsup id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.cmml"><mi id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.2" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.2.cmml">v</mi><mrow id="S4.E13.m1.4.4.2.4" xref="S4.E13.m1.4.4.2.3.cmml"><mi id="S4.E13.m1.3.3.1.1" xref="S4.E13.m1.3.3.1.1.cmml">x</mi><mo id="S4.E13.m1.4.4.2.4.1" xref="S4.E13.m1.4.4.2.3.cmml">,</mo><mi id="S4.E13.m1.4.4.2.2" xref="S4.E13.m1.4.4.2.2.cmml">y</mi></mrow><mrow id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.cmml"><mi id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.2" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.1" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.3" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.1a" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.4" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.1b" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.5" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.1c" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.6" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.1d" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.7" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.7.cmml">t</mi></mrow></msubsup></mrow><mo stretchy="false" id="S4.E13.m1.7.7.3.1.1.1.1.2.1.3" xref="S4.E13.m1.7.7.3.1.1.1.1.2.2.1.cmml">|</mo></mrow></mrow><mo stretchy="false" id="S4.E13.m1.7.7.3.1.1.1.3" xref="S4.E13.m1.7.7.3.1.1.1.1.cmml">)</mo></mrow><mo stretchy="false" id="S4.E13.m1.7.7.3.1.3" xref="S4.E13.m1.7.7.3.2.1.cmml">‖</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m1.7b"><apply id="S4.E13.m1.7.7.cmml" xref="S4.E13.m1.7.7"><eq id="S4.E13.m1.7.7.4.cmml" xref="S4.E13.m1.7.7.4"></eq><apply id="S4.E13.m1.6.6.2.cmml" xref="S4.E13.m1.6.6.2"><times id="S4.E13.m1.6.6.2.3.cmml" xref="S4.E13.m1.6.6.2.3"></times><ci id="S4.E13.m1.6.6.2.4.cmml" xref="S4.E13.m1.6.6.2.4">AVD</ci><interval closure="open" id="S4.E13.m1.6.6.2.2.3.cmml" xref="S4.E13.m1.6.6.2.2.2"><apply id="S4.E13.m1.5.5.1.1.1.1.cmml" xref="S4.E13.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.5.5.1.1.1.1.1.cmml" xref="S4.E13.m1.5.5.1.1.1.1">superscript</csymbol><ci id="S4.E13.m1.5.5.1.1.1.1.2.cmml" xref="S4.E13.m1.5.5.1.1.1.1.2">𝑣</ci><apply id="S4.E13.m1.5.5.1.1.1.1.3.cmml" xref="S4.E13.m1.5.5.1.1.1.1.3"><times id="S4.E13.m1.5.5.1.1.1.1.3.1.cmml" xref="S4.E13.m1.5.5.1.1.1.1.3.1"></times><ci id="S4.E13.m1.5.5.1.1.1.1.3.2.cmml" xref="S4.E13.m1.5.5.1.1.1.1.3.2">𝑠</ci><ci id="S4.E13.m1.5.5.1.1.1.1.3.3.cmml" xref="S4.E13.m1.5.5.1.1.1.1.3.3">𝑜</ci><ci id="S4.E13.m1.5.5.1.1.1.1.3.4.cmml" xref="S4.E13.m1.5.5.1.1.1.1.3.4">𝑢</ci><ci id="S4.E13.m1.5.5.1.1.1.1.3.5.cmml" xref="S4.E13.m1.5.5.1.1.1.1.3.5">𝑟</ci><ci id="S4.E13.m1.5.5.1.1.1.1.3.6.cmml" xref="S4.E13.m1.5.5.1.1.1.1.3.6">𝑐</ci><ci id="S4.E13.m1.5.5.1.1.1.1.3.7.cmml" xref="S4.E13.m1.5.5.1.1.1.1.3.7">𝑒</ci></apply></apply><apply id="S4.E13.m1.6.6.2.2.2.2.cmml" xref="S4.E13.m1.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S4.E13.m1.6.6.2.2.2.2.1.cmml" xref="S4.E13.m1.6.6.2.2.2.2">superscript</csymbol><ci id="S4.E13.m1.6.6.2.2.2.2.2.cmml" xref="S4.E13.m1.6.6.2.2.2.2.2">𝑣</ci><apply id="S4.E13.m1.6.6.2.2.2.2.3.cmml" xref="S4.E13.m1.6.6.2.2.2.2.3"><times id="S4.E13.m1.6.6.2.2.2.2.3.1.cmml" xref="S4.E13.m1.6.6.2.2.2.2.3.1"></times><ci id="S4.E13.m1.6.6.2.2.2.2.3.2.cmml" xref="S4.E13.m1.6.6.2.2.2.2.3.2">𝑡</ci><ci id="S4.E13.m1.6.6.2.2.2.2.3.3.cmml" xref="S4.E13.m1.6.6.2.2.2.2.3.3">𝑎</ci><ci id="S4.E13.m1.6.6.2.2.2.2.3.4.cmml" xref="S4.E13.m1.6.6.2.2.2.2.3.4">𝑟</ci><ci id="S4.E13.m1.6.6.2.2.2.2.3.5.cmml" xref="S4.E13.m1.6.6.2.2.2.2.3.5">𝑔</ci><ci id="S4.E13.m1.6.6.2.2.2.2.3.6.cmml" xref="S4.E13.m1.6.6.2.2.2.2.3.6">𝑒</ci><ci id="S4.E13.m1.6.6.2.2.2.2.3.7.cmml" xref="S4.E13.m1.6.6.2.2.2.2.3.7">𝑡</ci></apply></apply></interval></apply><apply id="S4.E13.m1.7.7.3.2.cmml" xref="S4.E13.m1.7.7.3.1"><csymbol cd="latexml" id="S4.E13.m1.7.7.3.2.1.cmml" xref="S4.E13.m1.7.7.3.1.2">norm</csymbol><apply id="S4.E13.m1.7.7.3.1.1.1.1.cmml" xref="S4.E13.m1.7.7.3.1.1.1"><minus id="S4.E13.m1.7.7.3.1.1.1.1.3.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.3"></minus><apply id="S4.E13.m1.7.7.3.1.1.1.1.1.2.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1"><abs id="S4.E13.m1.7.7.3.1.1.1.1.1.2.1.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.2"></abs><apply id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1"><ci id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.1">∇</ci><apply id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.2">𝑣</ci><apply id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3"><times id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.2">𝑠</ci><ci id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.3">𝑜</ci><ci id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.4.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.4">𝑢</ci><ci id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.5.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.5">𝑟</ci><ci id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.6.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.6">𝑐</ci><ci id="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.7.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.1.1.1.2.2.3.7">𝑒</ci></apply></apply><list id="S4.E13.m1.2.2.2.3.cmml" xref="S4.E13.m1.2.2.2.4"><ci id="S4.E13.m1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1">𝑥</ci><ci id="S4.E13.m1.2.2.2.2.cmml" xref="S4.E13.m1.2.2.2.2">𝑦</ci></list></apply></apply></apply><apply id="S4.E13.m1.7.7.3.1.1.1.1.2.2.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1"><abs id="S4.E13.m1.7.7.3.1.1.1.1.2.2.1.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.2"></abs><apply id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1"><ci id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.1.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.1">∇</ci><apply id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.1.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2">subscript</csymbol><apply id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.1.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2">superscript</csymbol><ci id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.2.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.2">𝑣</ci><apply id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3"><times id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.1.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.1"></times><ci id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.2.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.2">𝑡</ci><ci id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.3.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.3">𝑎</ci><ci id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.4.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.4">𝑟</ci><ci id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.5.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.5">𝑔</ci><ci id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.6.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.6">𝑒</ci><ci id="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.7.cmml" xref="S4.E13.m1.7.7.3.1.1.1.1.2.1.1.2.2.3.7">𝑡</ci></apply></apply><list id="S4.E13.m1.4.4.2.3.cmml" xref="S4.E13.m1.4.4.2.4"><ci id="S4.E13.m1.3.3.1.1.cmml" xref="S4.E13.m1.3.3.1.1">𝑥</ci><ci id="S4.E13.m1.4.4.2.2.cmml" xref="S4.E13.m1.4.4.2.2">𝑦</ci></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.7c">\mathrm{AVD}(v^{source},v^{target})=||(|\nabla v^{source}_{x,y}|-|\nabla v^{target}_{x,y}|)||</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p2.1" class="ltx_p">where <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="\nabla v=\frac{dv}{dx}+\frac{dv}{dy}" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mrow id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml"><mo rspace="0.167em" id="S4.SS2.p2.1.m1.1.1.2.1" xref="S4.SS2.p2.1.m1.1.1.2.1.cmml">∇</mo><mi id="S4.SS2.p2.1.m1.1.1.2.2" xref="S4.SS2.p2.1.m1.1.1.2.2.cmml">v</mi></mrow><mo id="S4.SS2.p2.1.m1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.cmml">=</mo><mrow id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml"><mfrac id="S4.SS2.p2.1.m1.1.1.3.2" xref="S4.SS2.p2.1.m1.1.1.3.2.cmml"><mrow id="S4.SS2.p2.1.m1.1.1.3.2.2" xref="S4.SS2.p2.1.m1.1.1.3.2.2.cmml"><mi id="S4.SS2.p2.1.m1.1.1.3.2.2.2" xref="S4.SS2.p2.1.m1.1.1.3.2.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.1.m1.1.1.3.2.2.1" xref="S4.SS2.p2.1.m1.1.1.3.2.2.1.cmml">​</mo><mi id="S4.SS2.p2.1.m1.1.1.3.2.2.3" xref="S4.SS2.p2.1.m1.1.1.3.2.2.3.cmml">v</mi></mrow><mrow id="S4.SS2.p2.1.m1.1.1.3.2.3" xref="S4.SS2.p2.1.m1.1.1.3.2.3.cmml"><mi id="S4.SS2.p2.1.m1.1.1.3.2.3.2" xref="S4.SS2.p2.1.m1.1.1.3.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.1.m1.1.1.3.2.3.1" xref="S4.SS2.p2.1.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S4.SS2.p2.1.m1.1.1.3.2.3.3" xref="S4.SS2.p2.1.m1.1.1.3.2.3.3.cmml">x</mi></mrow></mfrac><mo id="S4.SS2.p2.1.m1.1.1.3.1" xref="S4.SS2.p2.1.m1.1.1.3.1.cmml">+</mo><mfrac id="S4.SS2.p2.1.m1.1.1.3.3" xref="S4.SS2.p2.1.m1.1.1.3.3.cmml"><mrow id="S4.SS2.p2.1.m1.1.1.3.3.2" xref="S4.SS2.p2.1.m1.1.1.3.3.2.cmml"><mi id="S4.SS2.p2.1.m1.1.1.3.3.2.2" xref="S4.SS2.p2.1.m1.1.1.3.3.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.1.m1.1.1.3.3.2.1" xref="S4.SS2.p2.1.m1.1.1.3.3.2.1.cmml">​</mo><mi id="S4.SS2.p2.1.m1.1.1.3.3.2.3" xref="S4.SS2.p2.1.m1.1.1.3.3.2.3.cmml">v</mi></mrow><mrow id="S4.SS2.p2.1.m1.1.1.3.3.3" xref="S4.SS2.p2.1.m1.1.1.3.3.3.cmml"><mi id="S4.SS2.p2.1.m1.1.1.3.3.3.2" xref="S4.SS2.p2.1.m1.1.1.3.3.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.1.m1.1.1.3.3.3.1" xref="S4.SS2.p2.1.m1.1.1.3.3.3.1.cmml">​</mo><mi id="S4.SS2.p2.1.m1.1.1.3.3.3.3" xref="S4.SS2.p2.1.m1.1.1.3.3.3.3.cmml">y</mi></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><eq id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1"></eq><apply id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2"><ci id="S4.SS2.p2.1.m1.1.1.2.1.cmml" xref="S4.SS2.p2.1.m1.1.1.2.1">∇</ci><ci id="S4.SS2.p2.1.m1.1.1.2.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2.2">𝑣</ci></apply><apply id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3"><plus id="S4.SS2.p2.1.m1.1.1.3.1.cmml" xref="S4.SS2.p2.1.m1.1.1.3.1"></plus><apply id="S4.SS2.p2.1.m1.1.1.3.2.cmml" xref="S4.SS2.p2.1.m1.1.1.3.2"><divide id="S4.SS2.p2.1.m1.1.1.3.2.1.cmml" xref="S4.SS2.p2.1.m1.1.1.3.2"></divide><apply id="S4.SS2.p2.1.m1.1.1.3.2.2.cmml" xref="S4.SS2.p2.1.m1.1.1.3.2.2"><times id="S4.SS2.p2.1.m1.1.1.3.2.2.1.cmml" xref="S4.SS2.p2.1.m1.1.1.3.2.2.1"></times><ci id="S4.SS2.p2.1.m1.1.1.3.2.2.2.cmml" xref="S4.SS2.p2.1.m1.1.1.3.2.2.2">𝑑</ci><ci id="S4.SS2.p2.1.m1.1.1.3.2.2.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3.2.2.3">𝑣</ci></apply><apply id="S4.SS2.p2.1.m1.1.1.3.2.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3.2.3"><times id="S4.SS2.p2.1.m1.1.1.3.2.3.1.cmml" xref="S4.SS2.p2.1.m1.1.1.3.2.3.1"></times><ci id="S4.SS2.p2.1.m1.1.1.3.2.3.2.cmml" xref="S4.SS2.p2.1.m1.1.1.3.2.3.2">𝑑</ci><ci id="S4.SS2.p2.1.m1.1.1.3.2.3.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3.2.3.3">𝑥</ci></apply></apply><apply id="S4.SS2.p2.1.m1.1.1.3.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3"><divide id="S4.SS2.p2.1.m1.1.1.3.3.1.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3"></divide><apply id="S4.SS2.p2.1.m1.1.1.3.3.2.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.2"><times id="S4.SS2.p2.1.m1.1.1.3.3.2.1.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.2.1"></times><ci id="S4.SS2.p2.1.m1.1.1.3.3.2.2.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.2.2">𝑑</ci><ci id="S4.SS2.p2.1.m1.1.1.3.3.2.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.2.3">𝑣</ci></apply><apply id="S4.SS2.p2.1.m1.1.1.3.3.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.3"><times id="S4.SS2.p2.1.m1.1.1.3.3.3.1.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.3.1"></times><ci id="S4.SS2.p2.1.m1.1.1.3.3.3.2.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.3.2">𝑑</ci><ci id="S4.SS2.p2.1.m1.1.1.3.3.3.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.3.3">𝑦</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">\nabla v=\frac{dv}{dx}+\frac{dv}{dy}</annotation></semantics></math> is the pixel-wise gradient.
The absolute variation distance allows to consider boundaries and edges in images which are a common discriminator in visual recognition, whilst the gradient of noise remains as noise. A random sample of attack results after 550 iterations of optimisation are shown in figure <a href="#S4.F4" title="Figure 4 ‣ 4.1.1 Determining the Labels in a Mini-Batch ‣ 4.1 Inversion Attack Optimisation Algorithms ‣ 4 Experimental framework ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. A qualitative assessment of the results shows that recovery of data is more visible as AVD decreases in a continuous manner. In contrast the MSE metric for MNIST fluctuates drastically when the image is not completely clear or a blend, and can obtain various values similar or higher than the MSE for the pure noise input. Using this qualitative observation, we can define a threshold range between 0.6, where numbers are starting to emerge, and beyond 0.8, where information, at least for human eyes, is not visible.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">For the LFW dataset (figure <a href="#S4.F4" title="Figure 4 ‣ 4.1.1 Determining the Labels in a Mini-Batch ‣ 4.1 Inversion Attack Optimisation Algorithms ‣ 4 Experimental framework ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>), we see the same trend of good correlation between AVD and the revealed information, but the MSE metric is also a reasonable indicator as the images contain highly dense information. We use similar range of threshold of 0.6, and 0.8 to indicate a successful recovery.
<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>We note that using the variation by measuring the entropy, also yields in a very compatible metric, but was not used in this study. In that case, the relative information can be measured as:

<span id="S4.E14" class="ltx_equation ltx_eqn_table">

<span><span class="ltx_equation ltx_eqn_row ltx_align_baseline">
<span class="ltx_eqn_cell ltx_eqn_center_padleft"></span>
<span class="ltx_eqn_cell ltx_align_center"><math id="S4.E14.m1.6" class="ltx_Math" alttext="\Delta S_{av}=-p_{0}\log|\nabla v^{source}_{x,y}|/|\nabla v^{target}_{x,y}|" display="block"><semantics id="S4.E14.m1.6b"><mrow id="S4.E14.m1.6.6" xref="S4.E14.m1.6.6.cmml"><mrow id="S4.E14.m1.6.6.4" xref="S4.E14.m1.6.6.4.cmml"><mi mathvariant="normal" id="S4.E14.m1.6.6.4.2" xref="S4.E14.m1.6.6.4.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.E14.m1.6.6.4.1" xref="S4.E14.m1.6.6.4.1.cmml">​</mo><msub id="S4.E14.m1.6.6.4.3" xref="S4.E14.m1.6.6.4.3.cmml"><mi id="S4.E14.m1.6.6.4.3.2" xref="S4.E14.m1.6.6.4.3.2.cmml">S</mi><mrow id="S4.E14.m1.6.6.4.3.3" xref="S4.E14.m1.6.6.4.3.3.cmml"><mi id="S4.E14.m1.6.6.4.3.3.2" xref="S4.E14.m1.6.6.4.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E14.m1.6.6.4.3.3.1" xref="S4.E14.m1.6.6.4.3.3.1.cmml">​</mo><mi id="S4.E14.m1.6.6.4.3.3.3" xref="S4.E14.m1.6.6.4.3.3.3.cmml">v</mi></mrow></msub></mrow><mo id="S4.E14.m1.6.6.3" xref="S4.E14.m1.6.6.3.cmml">=</mo><mrow id="S4.E14.m1.6.6.2" xref="S4.E14.m1.6.6.2.cmml"><mo id="S4.E14.m1.6.6.2b" xref="S4.E14.m1.6.6.2.cmml">−</mo><mrow id="S4.E14.m1.6.6.2.2" xref="S4.E14.m1.6.6.2.2.cmml"><msub id="S4.E14.m1.6.6.2.2.4" xref="S4.E14.m1.6.6.2.2.4.cmml"><mi id="S4.E14.m1.6.6.2.2.4.2" xref="S4.E14.m1.6.6.2.2.4.2.cmml">p</mi><mn id="S4.E14.m1.6.6.2.2.4.3" xref="S4.E14.m1.6.6.2.2.4.3.cmml">0</mn></msub><mo lspace="0.167em" rspace="0em" id="S4.E14.m1.6.6.2.2.3" xref="S4.E14.m1.6.6.2.2.3.cmml">​</mo><mrow id="S4.E14.m1.6.6.2.2.2" xref="S4.E14.m1.6.6.2.2.2.cmml"><mi id="S4.E14.m1.6.6.2.2.2.3" xref="S4.E14.m1.6.6.2.2.2.3.cmml">log</mi><mo id="S4.E14.m1.6.6.2.2.2b" xref="S4.E14.m1.6.6.2.2.2.cmml">⁡</mo><mrow id="S4.E14.m1.6.6.2.2.2.2" xref="S4.E14.m1.6.6.2.2.2.2.cmml"><mrow id="S4.E14.m1.5.5.1.1.1.1.1.1" xref="S4.E14.m1.5.5.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E14.m1.5.5.1.1.1.1.1.1.2" xref="S4.E14.m1.5.5.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S4.E14.m1.5.5.1.1.1.1.1.1.1" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.cmml"><mo rspace="0.167em" id="S4.E14.m1.5.5.1.1.1.1.1.1.1.1" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.1.cmml">∇</mo><msubsup id="S4.E14.m1.5.5.1.1.1.1.1.1.1.2" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.2" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.2.cmml">v</mi><mrow id="S4.E14.m1.2.2.2.4" xref="S4.E14.m1.2.2.2.3.cmml"><mi id="S4.E14.m1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.cmml">x</mi><mo id="S4.E14.m1.2.2.2.4.1" xref="S4.E14.m1.2.2.2.3.cmml">,</mo><mi id="S4.E14.m1.2.2.2.2" xref="S4.E14.m1.2.2.2.2.cmml">y</mi></mrow><mrow id="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.2" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.1" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.3" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.1b" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.4" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.4.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.1c" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.5" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.1d" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.6" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.6.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.1e" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.7" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.7.cmml">e</mi></mrow></msubsup></mrow><mo stretchy="false" id="S4.E14.m1.5.5.1.1.1.1.1.1.3" xref="S4.E14.m1.5.5.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S4.E14.m1.6.6.2.2.2.2.3" xref="S4.E14.m1.6.6.2.2.2.2.3.cmml">/</mo><mrow id="S4.E14.m1.6.6.2.2.2.2.2.1" xref="S4.E14.m1.6.6.2.2.2.2.2.2.cmml"><mo stretchy="false" id="S4.E14.m1.6.6.2.2.2.2.2.1.2" xref="S4.E14.m1.6.6.2.2.2.2.2.2.1.cmml">|</mo><mrow id="S4.E14.m1.6.6.2.2.2.2.2.1.1" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.cmml"><mo rspace="0.167em" id="S4.E14.m1.6.6.2.2.2.2.2.1.1.1" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.1.cmml">∇</mo><msubsup id="S4.E14.m1.6.6.2.2.2.2.2.1.1.2" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.cmml"><mi id="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.2" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.2.cmml">v</mi><mrow id="S4.E14.m1.4.4.2.4" xref="S4.E14.m1.4.4.2.3.cmml"><mi id="S4.E14.m1.3.3.1.1" xref="S4.E14.m1.3.3.1.1.cmml">x</mi><mo id="S4.E14.m1.4.4.2.4.1" xref="S4.E14.m1.4.4.2.3.cmml">,</mo><mi id="S4.E14.m1.4.4.2.2" xref="S4.E14.m1.4.4.2.2.cmml">y</mi></mrow><mrow id="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.cmml"><mi id="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.2" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.1" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.3" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.1b" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.4" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.1c" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.5" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.1d" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.6" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.1e" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.7" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.7.cmml">t</mi></mrow></msubsup></mrow><mo stretchy="false" id="S4.E14.m1.6.6.2.2.2.2.2.1.3" xref="S4.E14.m1.6.6.2.2.2.2.2.2.1.cmml">|</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E14.m1.6c"><apply id="S4.E14.m1.6.6.cmml" xref="S4.E14.m1.6.6"><eq id="S4.E14.m1.6.6.3.cmml" xref="S4.E14.m1.6.6.3"></eq><apply id="S4.E14.m1.6.6.4.cmml" xref="S4.E14.m1.6.6.4"><times id="S4.E14.m1.6.6.4.1.cmml" xref="S4.E14.m1.6.6.4.1"></times><ci id="S4.E14.m1.6.6.4.2.cmml" xref="S4.E14.m1.6.6.4.2">Δ</ci><apply id="S4.E14.m1.6.6.4.3.cmml" xref="S4.E14.m1.6.6.4.3"><csymbol cd="ambiguous" id="S4.E14.m1.6.6.4.3.1.cmml" xref="S4.E14.m1.6.6.4.3">subscript</csymbol><ci id="S4.E14.m1.6.6.4.3.2.cmml" xref="S4.E14.m1.6.6.4.3.2">𝑆</ci><apply id="S4.E14.m1.6.6.4.3.3.cmml" xref="S4.E14.m1.6.6.4.3.3"><times id="S4.E14.m1.6.6.4.3.3.1.cmml" xref="S4.E14.m1.6.6.4.3.3.1"></times><ci id="S4.E14.m1.6.6.4.3.3.2.cmml" xref="S4.E14.m1.6.6.4.3.3.2">𝑎</ci><ci id="S4.E14.m1.6.6.4.3.3.3.cmml" xref="S4.E14.m1.6.6.4.3.3.3">𝑣</ci></apply></apply></apply><apply id="S4.E14.m1.6.6.2.cmml" xref="S4.E14.m1.6.6.2"><minus id="S4.E14.m1.6.6.2.3.cmml" xref="S4.E14.m1.6.6.2"></minus><apply id="S4.E14.m1.6.6.2.2.cmml" xref="S4.E14.m1.6.6.2.2"><times id="S4.E14.m1.6.6.2.2.3.cmml" xref="S4.E14.m1.6.6.2.2.3"></times><apply id="S4.E14.m1.6.6.2.2.4.cmml" xref="S4.E14.m1.6.6.2.2.4"><csymbol cd="ambiguous" id="S4.E14.m1.6.6.2.2.4.1.cmml" xref="S4.E14.m1.6.6.2.2.4">subscript</csymbol><ci id="S4.E14.m1.6.6.2.2.4.2.cmml" xref="S4.E14.m1.6.6.2.2.4.2">𝑝</ci><cn type="integer" id="S4.E14.m1.6.6.2.2.4.3.cmml" xref="S4.E14.m1.6.6.2.2.4.3">0</cn></apply><apply id="S4.E14.m1.6.6.2.2.2.cmml" xref="S4.E14.m1.6.6.2.2.2"><log id="S4.E14.m1.6.6.2.2.2.3.cmml" xref="S4.E14.m1.6.6.2.2.2.3"></log><apply id="S4.E14.m1.6.6.2.2.2.2.cmml" xref="S4.E14.m1.6.6.2.2.2.2"><divide id="S4.E14.m1.6.6.2.2.2.2.3.cmml" xref="S4.E14.m1.6.6.2.2.2.2.3"></divide><apply id="S4.E14.m1.5.5.1.1.1.1.1.2.cmml" xref="S4.E14.m1.5.5.1.1.1.1.1.1"><abs id="S4.E14.m1.5.5.1.1.1.1.1.2.1.cmml" xref="S4.E14.m1.5.5.1.1.1.1.1.1.2"></abs><apply id="S4.E14.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1"><ci id="S4.E14.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.1">∇</ci><apply id="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.2">𝑣</ci><apply id="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3"><times id="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.2">𝑠</ci><ci id="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.3">𝑜</ci><ci id="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.4.cmml" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.4">𝑢</ci><ci id="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.5.cmml" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.5">𝑟</ci><ci id="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.6.cmml" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.6">𝑐</ci><ci id="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.7.cmml" xref="S4.E14.m1.5.5.1.1.1.1.1.1.1.2.2.3.7">𝑒</ci></apply></apply><list id="S4.E14.m1.2.2.2.3.cmml" xref="S4.E14.m1.2.2.2.4"><ci id="S4.E14.m1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1">𝑥</ci><ci id="S4.E14.m1.2.2.2.2.cmml" xref="S4.E14.m1.2.2.2.2">𝑦</ci></list></apply></apply></apply><apply id="S4.E14.m1.6.6.2.2.2.2.2.2.cmml" xref="S4.E14.m1.6.6.2.2.2.2.2.1"><abs id="S4.E14.m1.6.6.2.2.2.2.2.2.1.cmml" xref="S4.E14.m1.6.6.2.2.2.2.2.1.2"></abs><apply id="S4.E14.m1.6.6.2.2.2.2.2.1.1.cmml" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1"><ci id="S4.E14.m1.6.6.2.2.2.2.2.1.1.1.cmml" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.1">∇</ci><apply id="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.cmml" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.1.cmml" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.2">subscript</csymbol><apply id="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.cmml" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.1.cmml" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.2">superscript</csymbol><ci id="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.2.cmml" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.2">𝑣</ci><apply id="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.cmml" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3"><times id="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.1.cmml" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.1"></times><ci id="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.2.cmml" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.2">𝑡</ci><ci id="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.3.cmml" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.3">𝑎</ci><ci id="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.4.cmml" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.4">𝑟</ci><ci id="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.5.cmml" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.5">𝑔</ci><ci id="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.6.cmml" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.6">𝑒</ci><ci id="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.7.cmml" xref="S4.E14.m1.6.6.2.2.2.2.2.1.1.2.2.3.7">𝑡</ci></apply></apply><list id="S4.E14.m1.4.4.2.3.cmml" xref="S4.E14.m1.4.4.2.4"><ci id="S4.E14.m1.3.3.1.1.cmml" xref="S4.E14.m1.3.3.1.1">𝑥</ci><ci id="S4.E14.m1.4.4.2.2.cmml" xref="S4.E14.m1.4.4.2.2">𝑦</ci></list></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14.m1.6d">\Delta S_{av}=-p_{0}\log|\nabla v^{source}_{x,y}|/|\nabla v^{target}_{x,y}|</annotation></semantics></math></span>
<span class="ltx_eqn_cell ltx_eqn_center_padright"></span>
<span rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></span></span></span>
</span>
Here <math id="footnote2.m1.1" class="ltx_Math" alttext="p_{0}" display="inline"><semantics id="footnote2.m1.1b"><msub id="footnote2.m1.1.1" xref="footnote2.m1.1.1.cmml"><mi id="footnote2.m1.1.1.2" xref="footnote2.m1.1.1.2.cmml">p</mi><mn id="footnote2.m1.1.1.3" xref="footnote2.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="footnote2.m1.1c"><apply id="footnote2.m1.1.1.cmml" xref="footnote2.m1.1.1"><csymbol cd="ambiguous" id="footnote2.m1.1.1.1.cmml" xref="footnote2.m1.1.1">subscript</csymbol><ci id="footnote2.m1.1.1.2.cmml" xref="footnote2.m1.1.1.2">𝑝</ci><cn type="integer" id="footnote2.m1.1.1.3.cmml" xref="footnote2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote2.m1.1d">p_{0}</annotation></semantics></math> is used here to be the expected value of the initial input vector to the attack, which in our case is uniform noise (0,1), so <math id="footnote2.m2.1" class="ltx_Math" alttext="p_{0}=0.5" display="inline"><semantics id="footnote2.m2.1b"><mrow id="footnote2.m2.1.1" xref="footnote2.m2.1.1.cmml"><msub id="footnote2.m2.1.1.2" xref="footnote2.m2.1.1.2.cmml"><mi id="footnote2.m2.1.1.2.2" xref="footnote2.m2.1.1.2.2.cmml">p</mi><mn id="footnote2.m2.1.1.2.3" xref="footnote2.m2.1.1.2.3.cmml">0</mn></msub><mo id="footnote2.m2.1.1.1" xref="footnote2.m2.1.1.1.cmml">=</mo><mn id="footnote2.m2.1.1.3" xref="footnote2.m2.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="footnote2.m2.1c"><apply id="footnote2.m2.1.1.cmml" xref="footnote2.m2.1.1"><eq id="footnote2.m2.1.1.1.cmml" xref="footnote2.m2.1.1.1"></eq><apply id="footnote2.m2.1.1.2.cmml" xref="footnote2.m2.1.1.2"><csymbol cd="ambiguous" id="footnote2.m2.1.1.2.1.cmml" xref="footnote2.m2.1.1.2">subscript</csymbol><ci id="footnote2.m2.1.1.2.2.cmml" xref="footnote2.m2.1.1.2.2">𝑝</ci><cn type="integer" id="footnote2.m2.1.1.2.3.cmml" xref="footnote2.m2.1.1.2.3">0</cn></apply><cn type="float" id="footnote2.m2.1.1.3.cmml" xref="footnote2.m2.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote2.m2.1d">p_{0}=0.5</annotation></semantics></math>.</span></span></span></p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Datasets and Attack Experiments</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.5" class="ltx_p">We conduct gradient inversion attack experiments on two representative datasets, MNIST Handwritten Digit <cite class="ltx_cite ltx_citemacro_citep">(LeCun et al., <a href="#bib.bib12" title="" class="ltx_ref">2010</a>)</cite> and Labelled Faces in the Wild (LFW) <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a href="#bib.bib6" title="" class="ltx_ref">2007</a>)</cite>, to illustrate how our proposed defense strategies successfully minimise information leakage without performance degradation. These two dataset are commonly used among researchers to study attacks <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al., <a href="#bib.bib28" title="" class="ltx_ref">2019</a>; Zhao et al., <a href="#bib.bib26" title="" class="ltx_ref">2020</a>; Melis et al., <a href="#bib.bib14" title="" class="ltx_ref">2019</a>; Shokri et al., <a href="#bib.bib19" title="" class="ltx_ref">2017</a>)</cite>. For each experiment we carried out 10-20 trials for each of the 3 attacks presented in table <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:attacks</span>. We analyse the recovery rate, which is the percentage of trials that lead to successful recovery. A successful recovery is determined by a threshold for the AVD metric (in MNIST) or MSE metric (in LFW) at the end of the every trial. In terms of the optimisation scheme, we utilized the standard optimisation scheme, LFBGS, with learning rate (<math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="lr" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mrow id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mi id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.1.m1.1.1.1" xref="S4.SS3.p1.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><times id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1.1"></times><ci id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">𝑙</ci><ci id="S4.SS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">lr</annotation></semantics></math>) of <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="0.05" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><mn id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">0.05</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><cn type="float" id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">0.05</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">0.05</annotation></semantics></math> and <math id="S4.SS3.p1.3.m3.1" class="ltx_Math" alttext="550" display="inline"><semantics id="S4.SS3.p1.3.m3.1a"><mn id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml">550</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><cn type="integer" id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">550</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">550</annotation></semantics></math> iterations for running a proxy model to attack. We also carried out complementary tests with <math id="S4.SS3.p1.4.m4.1" class="ltx_Math" alttext="1200" display="inline"><semantics id="S4.SS3.p1.4.m4.1a"><mn id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml">1200</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><cn type="integer" id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">1200</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">1200</annotation></semantics></math> iterations, and <math id="S4.SS3.p1.5.m5.1" class="ltx_Math" alttext="lr" display="inline"><semantics id="S4.SS3.p1.5.m5.1a"><mrow id="S4.SS3.p1.5.m5.1.1" xref="S4.SS3.p1.5.m5.1.1.cmml"><mi id="S4.SS3.p1.5.m5.1.1.2" xref="S4.SS3.p1.5.m5.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.5.m5.1.1.1" xref="S4.SS3.p1.5.m5.1.1.1.cmml">​</mo><mi id="S4.SS3.p1.5.m5.1.1.3" xref="S4.SS3.p1.5.m5.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.1b"><apply id="S4.SS3.p1.5.m5.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1"><times id="S4.SS3.p1.5.m5.1.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1.1"></times><ci id="S4.SS3.p1.5.m5.1.1.2.cmml" xref="S4.SS3.p1.5.m5.1.1.2">𝑙</ci><ci id="S4.SS3.p1.5.m5.1.1.3.cmml" xref="S4.SS3.p1.5.m5.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.1c">lr</annotation></semantics></math> of 0.025 to further showcase the validity of our results. The detailed analysis is available in the supporting information.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">To evaluate the performance of the neural networks we trained the LeNET and dense layer models using an SGD optimiser on the MNIST dataset for 60 epochs. We will release the source code to reproduce these results upon acceptance of the paper.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experimental Results</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Single Dense Layer</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">A single layer attack is a valuable experiment to clearly demonstrate our strategy. As we have shown earlier we can recover the data directly from a batch without numerical optimisation. Here we explore the results from the attacks on a simplified single layer. In this case we look only at the MNIST dataset, as linear regression can provide a very useful though not optimal model for prediction. We explore different batch sizes, <math id="S5.SS1.p1.1.m1.4" class="ltx_Math" alttext="B{=}1,2,4,6" display="inline"><semantics id="S5.SS1.p1.1.m1.4a"><mrow id="S5.SS1.p1.1.m1.4.5" xref="S5.SS1.p1.1.m1.4.5.cmml"><mi id="S5.SS1.p1.1.m1.4.5.2" xref="S5.SS1.p1.1.m1.4.5.2.cmml">B</mi><mo id="S5.SS1.p1.1.m1.4.5.1" xref="S5.SS1.p1.1.m1.4.5.1.cmml">=</mo><mrow id="S5.SS1.p1.1.m1.4.5.3.2" xref="S5.SS1.p1.1.m1.4.5.3.1.cmml"><mn id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml">1</mn><mo id="S5.SS1.p1.1.m1.4.5.3.2.1" xref="S5.SS1.p1.1.m1.4.5.3.1.cmml">,</mo><mn id="S5.SS1.p1.1.m1.2.2" xref="S5.SS1.p1.1.m1.2.2.cmml">2</mn><mo id="S5.SS1.p1.1.m1.4.5.3.2.2" xref="S5.SS1.p1.1.m1.4.5.3.1.cmml">,</mo><mn id="S5.SS1.p1.1.m1.3.3" xref="S5.SS1.p1.1.m1.3.3.cmml">4</mn><mo id="S5.SS1.p1.1.m1.4.5.3.2.3" xref="S5.SS1.p1.1.m1.4.5.3.1.cmml">,</mo><mn id="S5.SS1.p1.1.m1.4.4" xref="S5.SS1.p1.1.m1.4.4.cmml">6</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.4b"><apply id="S5.SS1.p1.1.m1.4.5.cmml" xref="S5.SS1.p1.1.m1.4.5"><eq id="S5.SS1.p1.1.m1.4.5.1.cmml" xref="S5.SS1.p1.1.m1.4.5.1"></eq><ci id="S5.SS1.p1.1.m1.4.5.2.cmml" xref="S5.SS1.p1.1.m1.4.5.2">𝐵</ci><list id="S5.SS1.p1.1.m1.4.5.3.1.cmml" xref="S5.SS1.p1.1.m1.4.5.3.2"><cn type="integer" id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1">1</cn><cn type="integer" id="S5.SS1.p1.1.m1.2.2.cmml" xref="S5.SS1.p1.1.m1.2.2">2</cn><cn type="integer" id="S5.SS1.p1.1.m1.3.3.cmml" xref="S5.SS1.p1.1.m1.3.3">4</cn><cn type="integer" id="S5.SS1.p1.1.m1.4.4.cmml" xref="S5.SS1.p1.1.m1.4.4">6</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.4c">B{=}1,2,4,6</annotation></semantics></math> using the AVD metric with two thresholds to determine a successful recovery.
We calculate recovery rates for each experiment strategy, MSE vs. CEL as loss function, both followed by softmax and random drawing of labels vs. equal labels in a batch.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p">Figure <a href="#S5.F5" title="Figure 5 ‣ 5.1 Single Dense Layer ‣ 5 Experimental Results ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows that MSE and a batch of equal labels provides very low recovery rates for batches of size 4 and 6. This result is observed for both threshold values 0.6 and 0.8. The additional value of using MSE with equal labeling is minor. The regular approach of using random data in the batch with CEL is observed to be the most vulnerable. The importance of these results can be justified by looking at the training performance of these networks as presented in figure <a href="#S5.F6" title="Figure 6 ‣ 5.1 Single Dense Layer ‣ 5 Experimental Results ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.
It is shown that performance has in fact remained intact, even for MSE as an objective function followed by softmax, which is not typically applied in classification tasks, and also for equal labels despite the possible diversification issue that this may raise <span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>Hyper-parameters were not optimised and similar to all configurations.</span></span></span>.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<p id="S5.SS1.p3.1" class="ltx_p">We note that in the aggregation of a central model, we update the model only after aggregation of the gradients from clients, so the diversification of labels in the batch of equal labels happens naturally. It therefore enables similar performance to the random label. We also observe that the MSE loss without softmax results in lower performance for a single dense layer. However we obtained the opposite behaviour for LeNET as we show next, so this discrepancy may be addressed by further optimisation through tuning the network hyper-parameters.</p>
</div>
<figure id="S5.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S5.F5.1.1" class="ltx_p ltx_align_left ltx_figure_panel ltx_align_center"><span id="S5.F5.1.1.1" class="ltx_text"><img src="/html/2204.12495/assets/figures/mnist_linear_bar06soft.png" id="S5.F5.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="264" height="141" alt="Refer to caption"></span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S5.F5.2.2" class="ltx_p ltx_align_left ltx_figure_panel ltx_align_center"><span id="S5.F5.2.2.1" class="ltx_text"><img src="/html/2204.12495/assets/figures/mnist_linear_bar08soft.png" id="S5.F5.2.2.1.g1" class="ltx_graphics ltx_img_landscape" width="264" height="141" alt="Refer to caption"></span></p>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Recovery rates (in percents) for MNIST dataset using one linear dense layer. We preset the rate of recovery using the AVD metric with threshold 0.6 (a), and 0.8 (b). The bars show different mini-batch sizes, and the <math id="S5.F5.4.4.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S5.F5.4.4.m1.1b"><mi id="S5.F5.4.4.m1.1.1" xref="S5.F5.4.4.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S5.F5.4.4.m1.1c"><ci id="S5.F5.4.4.m1.1.1.cmml" xref="S5.F5.4.4.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.4.4.m1.1d">x</annotation></semantics></math>-axis differentiates between MSE loss function, CEL function and the cases of drawing random and equal labels in CEL function.</figcaption>
</figure>
<figure id="S5.F6" class="ltx_figure">
<p id="S5.F6.1" class="ltx_p ltx_align_left"><span id="S5.F6.1.1" class="ltx_text"><img src="/html/2204.12495/assets/x10.png" id="S5.F6.1.1.g1" class="ltx_graphics ltx_img_landscape" width="286" height="166" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Performance of MNIST in single net architecture sizes at various strategies and at batch sizes 2, 4 and 6. The y-axis represents classification accuracy and the x-axis shows fraction of recovered images. The figure shows that recovery rate is high for cross entropy, and either mixing the labels or using a different loss function can reduce recovery rate without sacrificing the classification accuracy.</figcaption>
</figure>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Convolutional neural network recovery rates</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">Results for the linear layer in section <a href="#S5.SS1" title="5.1 Single Dense Layer ‣ 5 Experimental Results ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.1</span></a> show the clear numerical challenge in inverting a batch while employing the suggested gradient mixing strategies. Here we explore how this affects the attack success in a widely used convolutional neural network for image recognition, LeNET <cite class="ltx_cite ltx_citemacro_citep">(LeCun et al., <a href="#bib.bib11" title="" class="ltx_ref">1990</a>)</cite>. We show a 2D map of the recovery rates for attack experiments on different batch sizes and channels. The results are presented in figure <a href="#S5.F7" title="Figure 7 ‣ 5.2 Convolutional neural network recovery rates ‣ 5 Experimental Results ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> for the MNIST and the LFW dataset. The maps also show the boundaries for zero recovery rates. The trends show that overall the MSE and equal label strategies provide a useful decrease in recovery rates that permit a practitioner to deploy a larger model with data protection supported by the mixing of gradients. This effect is especially dominant for the LFW dataset. However we expect that with a much larger number of channels the data can be recovered solely by the convolutional layers. A detailed interplay between the minimal required channels in convolutional layers with or without dense layers was discussed recently by <cite class="ltx_cite ltx_citemacro_citep">(Qian et al., <a href="#bib.bib16" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<figure id="S5.F7" class="ltx_figure"><img src="/html/2204.12495/assets/x11.png" id="S5.F7.g1" class="ltx_graphics ltx_img_landscape" width="332" height="239" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Analysis of recovery attack success rate in MNIST and LFW with CNN model, LeNET architecture. The white dashed line represents the boundary of zero rate success recovery.</figcaption>
</figure>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.1" class="ltx_p">Finally we carry out a performance test for LeNET for each strategy and with varying batch sizes and number of channels for the MNIST dataset. We show the comparison of the network performance against the recovery rates in figure <a href="#S5.F8" title="Figure 8 ‣ 5.2 Convolutional neural network recovery rates ‣ 5 Experimental Results ‣ Enhancing Privacy against Inversion Attacks in Federated Learning by using Mixing Gradients Strategies" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>. Results show that performance is also kept relatively intact allowing a clear benefit of privacy protection in comparison to the typical CEL and random label selection. Interestingly, in contrast to the single dense layer case, here MSE with softmax performs less well than other networks. Our results for LeNET show the benefit of choosing strategies for mixing gradients as, in many cases, the maximum batch size that can be used is limited (e.g. in distributed training over clients with sparse data).</p>
</div>
<figure id="S5.F8" class="ltx_figure">
<p id="S5.F8.1" class="ltx_p ltx_align_left ltx_align_center"><span id="S5.F8.1.1" class="ltx_text"><img src="/html/2204.12495/assets/x12.png" id="S5.F8.1.1.g1" class="ltx_graphics ltx_img_landscape" width="312" height="181" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Performance of MNIST dataset on LeNET network architecture with different channels and batch sizes and for various gradient mixing strategies.</figcaption>
</figure>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusions</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">We have shown that by simple architecture choices it is possible to prevent the recovery of data from widely used gradient inversion attacks. The choice of loss function and the drawing of equal labels in a batch results in strategic mixing of the gradients in typical neural networks with dense linear and convolutional layers. We revisited the analysis of the dense linear layer and have shown that mixing gradients makes a linear layer much less vulnerable to attack, and in fact, without mixing gradients, it is possible to recover directly all batch vectors due to the de-mixing nature of the typical cross entropy loss function. Our suggested strategies for mixing gradients maintain network performance which is in contrast to common methods that apply noise to the gradients and drop performance significantly. Additionally, in practice, one could combine the mixed gradients strategies further with noise or other defense methods to obtain an even more secure federated learning policy. Finally, we have introduced a new metric, absolute variation distance, to measure the relative information recovered by gradient inversion attacks. The AVD metric, which is derived from total variation, can distinguish information from noise especially for datasets that have sparse information such as the digit images in the MNIST dataset.</p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.1" class="ltx_p">We hope that this work prompts the development of new gradient mixing strategies that further secure data in distributed learning. Further work will also study the effect of more complex architectures and the creation of a privacy policy for federated learning that will allow a trustful federated learning platform.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bonawitz et al. (2019)</span>
<span class="ltx_bibblock">
Bonawitz, K., Eichner, H., Grieskamp, W., Huba, D., Ingerman, A., Ivanov, V.,
Kiddon, C., Konečný, J., Mazzocchi, S., McMahan, B., Van Overveldt,
T., Petrou, D., Ramage, D., and Roselander, J.

</span>
<span class="ltx_bibblock">Towards federated learning at scale: System design.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning and Systems</em>, volume 1, pp. 374–388, 2019.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="https://proceedings.mlsys.org/paper/2019/file/bd686fd640be98efaae0091fa301e613-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlsys.org/paper/2019/file/bd686fd640be98efaae0091fa301e613-Paper.pdf</a>.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Carlini et al. (2020)</span>
<span class="ltx_bibblock">
Carlini, N., Deng, S., Garg, S., Jha, S., Mahloujifar, S., Mahmoody, M., Song,
S., Thakurta, A., and Tramèr, F.

</span>
<span class="ltx_bibblock">An attack on instahide: Is private learning possible with instance
encoding?

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2011.05315, 2020.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="http://dblp.uni-trier.de/db/journals/corr/corr2011.html#abs-2011-05315" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://dblp.uni-trier.de/db/journals/corr/corr2011.html#abs-2011-05315</a>.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Commission (2018)</span>
<span class="ltx_bibblock">
Commission, E.

</span>
<span class="ltx_bibblock">2018 reform of eu data protection rules.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">General Data Protection Regulation</em>, 2018.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://gdpr-info.eu" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://gdpr-info.eu</a>.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Daunizeau (2017)</span>
<span class="ltx_bibblock">
Daunizeau, J.

</span>
<span class="ltx_bibblock">Semi-analytical Approximations to Statistical Moments of Sigmoid and
Softmax Mappings of Normal Variables, 2017.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geiping et al. (2020)</span>
<span class="ltx_bibblock">
Geiping, J., Bauermeister, H., Dröge, H., and Moeller, M.

</span>
<span class="ltx_bibblock">Inverting Gradients - How easy is it to break privacy in federated
learning?

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems 33: Annual
Conference on Neural Information Processing Systems 2020, NeurIPS 2020,
December 6-12, 2020, virtual</em>, 2020.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="https://proceedings.neurips.cc/paper/2020/hash/c4ede56bbd98819ae6112b20ac6bf145-Abstract.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper/2020/hash/c4ede56bbd98819ae6112b20ac6bf145-Abstract.html</a>.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2007)</span>
<span class="ltx_bibblock">
Huang, G. B., Ramesh, M., Berg, T., and Learned-Miller, E.

</span>
<span class="ltx_bibblock">Labeled faces in the wild: A database for studying face recognition
in unconstrained environments.

</span>
<span class="ltx_bibblock">Technical Report 07-49, University of Massachusetts, Amherst, October
2007.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2020)</span>
<span class="ltx_bibblock">
Huang, Y., Song, Z., Li, K., and Arora, S.

</span>
<span class="ltx_bibblock">InstaHide: Instance-hiding schemes for private distributed
learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 37th International Conference on Machine
Learning</em>, volume 119 of <em id="bib.bib7.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>,
pp.  4507–4518. PMLR, 13–18 Jul 2020.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.mlr.press/v119/huang20i.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v119/huang20i.html</a>.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jochems et al. (2016)</span>
<span class="ltx_bibblock">
Jochems, A., Deist, T. M., van Soest, J., Eble, M. J., Bulens, P., Coucke, P.,
Dries, W. J. F., Lambin, P., and Dekker, A.

</span>
<span class="ltx_bibblock">Distributed learning: Developing a predictive model based on data
from multiple hospitals without data leaving the hospital - a real life proof
of concept.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Radiotherapy and oncology : journal of the European Society for
Therapeutic Radiology and Oncology</em>, 121 3:459–467, 2016.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz et al. (2021)</span>
<span class="ltx_bibblock">
Kairouz, P., McMahan, H. B., Avent, B., Bellet, A., Bennis, M., Bhagoji, A. N.,
Bonawitz, K. A., Charles, Z., Cormode, G., Cummings, R., D’Oliveira, R. G.,
Rouayheb, S. E., Evans, D., Gardner, J., Garrett, Z., Gascón, A., Ghazi, B.,
Gibbons, P. B., Gruteser, M., Harchaoui, Z., He, C., He, L., Huo, Z.,
Hutchinson, B., Hsu, J., Jaggi, M., Javidi, T., Joshi, G., Khodak, M.,
Konečný, J., Korolova, A., Koushanfar, F., Koyejo, S., Lepoint, T., Liu,
Y., Mittal, P., Mohri, M., Nock, R., Özgür, A., Pagh, R., Raykova, M., Qi,
H., Ramage, D., Raskar, R., Song, D., Song, W., Stich, S. U., Sun, Z.,
Suresh, A. T., Tramèr, F., Vepakomma, P., Wang, J., Xiong, L., Xu, Z., Yang,
Q., Yu, F. X., Yu, H., and Zhao, S.

</span>
<span class="ltx_bibblock">Advances and Open Problems in Federated Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Foundations and Trends® in Machine Learning</em>,
14:1–210, 2021.

</span>
<span class="ltx_bibblock">ISSN 1935-8237.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1561/2200000083</span>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://dx.doi.org/10.1561/2200000083" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://dx.doi.org/10.1561/2200000083</a>.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Konečný et al. (2016)</span>
<span class="ltx_bibblock">
Konečný, J., McMahan, H. B., Yu, F. X., Richtarik, P., Suresh, A. T., and
Bacon, D.

</span>
<span class="ltx_bibblock">Federated learning: Strategies for improving communication
efficiency.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">NIPS Workshop on Private Multi-Party Machine Learning</em>,
2016.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://arxiv.org/abs/1610.05492" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/1610.05492</a>.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">LeCun et al. (1990)</span>
<span class="ltx_bibblock">
LeCun, Y., Boser, B., Denker, J., Henderson, D., Howard, R., Hubbard, W., and
Jackel, L.

</span>
<span class="ltx_bibblock">Handwritten Digit Recognition with a Back-Propagation Network.

</span>
<span class="ltx_bibblock">In <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
volume 2. Morgan-Kaufmann, 1990.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="https://proceedings.neurips.cc/paper/1989/file/53c3bce66e43be4f209556518c2fcb54-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper/1989/file/53c3bce66e43be4f209556518c2fcb54-Paper.pdf</a>.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">LeCun et al. (2010)</span>
<span class="ltx_bibblock">
LeCun, Y., Cortes, C., and Burges, C.

</span>
<span class="ltx_bibblock">Mnist handwritten digit database.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">ATT Labs [Online]. Available:
http://yann.lecun.com/exdb/mnist</em>, 2, 2010.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
McMahan, B., Moore, E., Ramage, D., Hampson, S., and Arcas, B. A. y.

</span>
<span class="ltx_bibblock">Communication-Efficient Learning of Deep Networks from Decentralized
Data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 20th International Conference on
Artificial Intelligence and Statistics</em>, volume 54 of <em id="bib.bib13.2.2" class="ltx_emph ltx_font_italic">Proceedings of
Machine Learning Research</em>, pp.  1273–1282. PMLR, 20–22 Apr 2017.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.mlr.press/v54/mcmahan17a.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v54/mcmahan17a.html</a>.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Melis et al. (2019)</span>
<span class="ltx_bibblock">
Melis, L., Song, C., Cristofaro, E. D., and Shmatikov, V.

</span>
<span class="ltx_bibblock">Exploiting unintended feature leakage in collaborative learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">2019 IEEE Symposium on Security and Privacy, SP 2019,
San Francisco, CA, USA, May 19-23, 2019</em>, pp.  691–706. IEEE, 2019.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/SP.2019.00029</span>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1109/SP.2019.00029" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1109/SP.2019.00029</a>.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Phong et al. (2018)</span>
<span class="ltx_bibblock">
Phong, L. T., Aono, Y., Hayashi, T., Wang, L., and Moriai, S.

</span>
<span class="ltx_bibblock">Privacy-preserving deep learning via additively homomorphic
encryption.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Information Forensics and Security</em>,
13(5):1333–1345, 2018.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/TIFS.2017.2787987</span>.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qian et al. (2021)</span>
<span class="ltx_bibblock">
Qian, J., Nassar, H., and Hansen, L. K.

</span>
<span class="ltx_bibblock">Minimal model structure analysis for input reconstruction in
federated learning, 2021.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rieke et al. (2020)</span>
<span class="ltx_bibblock">
Rieke, N., Hancox, J., Li, W., Milletarì, F., Roth, H., Albarqouni, S.,
Bakas, S., Galtier, M., Landman, B., Maier-Hein, K., Ourselin, S., Sheller,
M., Summers, R., Trask, A., Xu, D., Baust, M., and Cardoso, M.

</span>
<span class="ltx_bibblock">The future of Digital Health with Federated Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">npj Digital Medicine</em>, 3(1), December 2020.

</span>
<span class="ltx_bibblock">ISSN 2398-6352.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1038/s41746-020-00323-1</span>.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rudin et al. (1992)</span>
<span class="ltx_bibblock">
Rudin, L. I., Osher, S., and Fatemi, E.

</span>
<span class="ltx_bibblock">Nonlinear total variation based noise removal algorithms.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Eleventh Annual International Conference
of the Center for Nonlinear Studies on Experimental Mathematics:
Computational Issues in Nonlinear Science: Computational Issues in Nonlinear
Science</em>, pp.  259–268, USA, 1992. Elsevier North-Holland, Inc.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shokri et al. (2017)</span>
<span class="ltx_bibblock">
Shokri, R., Stronati, M., Song, C., and Shmatikov, V.

</span>
<span class="ltx_bibblock">Membership inference attacks against machine learning models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">2017 IEEE Symposium on Security and Privacy, SP 2017,
San Jose, CA, USA, May 22-26, 2017</em>, pp.  3–18. IEEE Computer Society,
2017.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/SP.2017.41</span>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1109/SP.2017.41" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1109/SP.2017.41</a>.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tramèr &amp; Boneh (2021)</span>
<span class="ltx_bibblock">
Tramèr, F. and Boneh, D.

</span>
<span class="ltx_bibblock">Differentially Private Learning Needs Better Features (or Much More
Data).

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations
(ICLR)</em>, 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://arxiv.org/abs/2011.11660" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2011.11660</a>.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang &amp; Gong (2018)</span>
<span class="ltx_bibblock">
Wang, B. and Gong, N. Z.

</span>
<span class="ltx_bibblock">Stealing hyperparameters in machine learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">2018 IEEE Symposium on Security and Privacy, SP 2018,
Proceedings, 21-23 May 2018, San Francisco, California, USA</em>, pp.  36–52.
IEEE Computer Society, 2018.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/SP.2018.00038</span>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1109/SP.2018.00038" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1109/SP.2018.00038</a>.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2004)</span>
<span class="ltx_bibblock">
Wang, Z., Bovik, A., Sheikh, H., and Simoncelli, E.

</span>
<span class="ltx_bibblock">Image quality assessment: from error visibility to structural
similarity.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Image Processing</em>, 13(4):600–612, 2004.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/TIP.2003.819861</span>.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al. (2020)</span>
<span class="ltx_bibblock">
Wei, W., Liu, L., Loper, M., Chow, K.-H., Gursoy, M. E., Truex, S., and Wu, Y.

</span>
<span class="ltx_bibblock">A Framework for Evaluating Gradient Leakage Attacks in Federated
Learning, 2020.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2019)</span>
<span class="ltx_bibblock">
Yang, Q., Liu, Y., Chen, T., and Tong, Y.

</span>
<span class="ltx_bibblock">Federated Machine Learning: Concept and Applications.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">ACM Trans. Intell. Syst. Technol.</em>, 10(2), jan 2019.

</span>
<span class="ltx_bibblock">ISSN 2157-6904.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1145/3298981</span>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1145/3298981" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1145/3298981</a>.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yin et al. (2021)</span>
<span class="ltx_bibblock">
Yin, H., Mallya, A., Vahdat, A., Alvarez, J., Kautz, J., and Molchanov, P.

</span>
<span class="ltx_bibblock">See through Gradients: Image Batch Recovery via GradInversion.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">2021 IEEE/CVF Conference on Computer Vision and Pattern
Recognition (CVPR)</em>, pp.  16332–16341, 2021.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/CVPR46437.2021.01607</span>.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2020)</span>
<span class="ltx_bibblock">
Zhao, B., Mopuri, K. R., and Bilen, H.

</span>
<span class="ltx_bibblock">idlg: Improved deep leakage from gradients, 2020.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu &amp; Blaschko (2021)</span>
<span class="ltx_bibblock">
Zhu, J. and Blaschko, M. B.

</span>
<span class="ltx_bibblock">R-GAP: recursive gradient attack on privacy.

</span>
<span class="ltx_bibblock">In <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">9th International Conference on Learning Representations,
ICLR 2021, Virtual Event, Austria, May 3-7, 2021</em>. OpenReview.net, 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=RSU17UoKfJF" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=RSU17UoKfJF</a>.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2019)</span>
<span class="ltx_bibblock">
Zhu, L., Liu, Z., and Han, S.

</span>
<span class="ltx_bibblock">Deep leakage from gradients.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
volume 32. Curran Associates, Inc., 2019.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="https://proceedings.neurips.cc/paper/2019/file/60a6c4002cc7b29142def8871531281a-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper/2019/file/60a6c4002cc7b29142def8871531281a-Paper.pdf</a>.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2204.12494" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2204.12495" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2204.12495">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2204.12495" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2204.12496" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Feb 28 07:09:45 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
