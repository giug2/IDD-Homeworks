<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Longitudinal Segmentation of MS Lesions via Temporal Difference Weighting</title>
<!--Generated on Fri Sep 20 11:23:25 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Medical Image Segmentation Longitudinal Imaging Multiple Sclerosis" lang="en" name="keywords"/>
<base href="/html/2409.13416v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#S1" title="In Longitudinal Segmentation of MS Lesions via Temporal Difference Weighting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#S2" title="In Longitudinal Segmentation of MS Lesions via Temporal Difference Weighting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#S2.SS1" title="In 2 Method ‣ Longitudinal Segmentation of MS Lesions via Temporal Difference Weighting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Integrating Prior Images for Enhanced Segmentation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#S2.SS2" title="In 2 Method ‣ Longitudinal Segmentation of MS Lesions via Temporal Difference Weighting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Difference Weighting Block</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#S3" title="In Longitudinal Segmentation of MS Lesions via Temporal Difference Weighting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#S3.SS1" title="In 3 Experiments ‣ Longitudinal Segmentation of MS Lesions via Temporal Difference Weighting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#S3.SS2" title="In 3 Experiments ‣ Longitudinal Segmentation of MS Lesions via Temporal Difference Weighting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Evaluation Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#S3.SS3" title="In 3 Experiments ‣ Longitudinal Segmentation of MS Lesions via Temporal Difference Weighting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Implementation details</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#S4" title="In Longitudinal Segmentation of MS Lesions via Temporal Difference Weighting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Results and Discussion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#S5" title="In Longitudinal Segmentation of MS Lesions via Temporal Difference Weighting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#S5.SS0.SSS1" title="In 5 Conclusion ‣ Longitudinal Segmentation of MS Lesions via Temporal Difference Weighting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.0.1 </span>Acknowledgements</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#S5.SS0.SSS2" title="In 5 Conclusion ‣ Longitudinal Segmentation of MS Lesions via Temporal Difference Weighting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.0.2 </span><span class="ltx_ERROR undefined">\discintname</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#Pt0.A1" title="In Longitudinal Segmentation of MS Lesions via Temporal Difference Weighting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">0.A </span>Statistical Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#Pt0.A2" title="In Longitudinal Segmentation of MS Lesions via Temporal Difference Weighting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">0.B </span>Results without Size Filtering</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line"><span class="ltx_note ltx_role_institutetext" id="id1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">institutetext: </span>German Cancer Research Center (DKFZ), Heidelberg, Division of Medical Image Computing, Germany
</span></span></span><span class="ltx_note ltx_role_institutetext" id="id2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">institutetext: </span>Faculty of Mathematics and Computer Science, Heidelberg University, Germany
</span></span></span><span class="ltx_note ltx_role_institutetext" id="id3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_note_type">institutetext: </span>HIDSS4Health - Helmholtz Information and Data Science School for Health, Karlsruhe/Heidelberg, Germany </span></span></span><span class="ltx_note ltx_role_institutetext" id="id4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_note_type">institutetext: </span>Medical Faculty Heidelberg, Heidelberg University, Heidelberg, Germany
</span></span></span><span class="ltx_note ltx_role_institutetext" id="id5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_note_type">institutetext: </span>Helmholtz Imaging, German Cancer Research Center, Heidelberg, Germany
</span></span></span><span class="ltx_note ltx_role_institutetext" id="id6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_note_type">institutetext: </span>Department of Neuroradiology, Heidelberg University Hospital, Heidelberg, Germany
</span></span></span><span class="ltx_note ltx_role_institutetext" id="id7"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_note_type">institutetext: </span>Division for Computational Neuroimaging, Department of Neuroradiology, Heidelberg University Hospital, Heidelberg, Germany
</span></span></span><span class="ltx_note ltx_role_institutetext" id="id8"><sup class="ltx_note_mark">8</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">8</sup><span class="ltx_note_type">institutetext: </span>Institute for Artificial Intelligence in Medicine (IKIM), University Hospital Essen, Essen, Germany
</span></span></span><span class="ltx_note ltx_role_institutetext" id="id9"><sup class="ltx_note_mark">9</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">9</sup><span class="ltx_note_type">institutetext: </span>Cancer Research Center Cologne Essen (CCCE), West German Cancer Center Essen, University Hospital Essen, Essen, Germany
</span></span></span><span class="ltx_note ltx_role_institutetext" id="id10"><sup class="ltx_note_mark">10</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">10</sup><span class="ltx_note_type">institutetext: </span>Pattern Analysis and Learning Group, Department of Radiation Oncology, Heidelberg University Hospital
<br class="ltx_break"/><span class="ltx_note ltx_role_email" id="id10.1"><sup class="ltx_note_mark">10</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">10</sup><span class="ltx_note_type">email: </span>{maximilian.rokuss,yannick.kirchhoff}@dkfz-heidelberg.de</span></span></span>
</span></span></span>
<h1 class="ltx_title ltx_title_document">Longitudinal Segmentation of MS Lesions via Temporal Difference Weighting</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Maximilian R. Rokuss<span class="ltx_ERROR undefined" id="id1.1.id1">\orcidlink</span>0009-0004-4560-0760
</span><span class="ltx_author_notes">Contributed equally. Each co-first author may list themselves as lead author on their CV.1122</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yannick Kirchhoff<span class="ltx_ERROR undefined" id="id2.1.id1">\orcidlink</span>0000-0001-8124-8435<sup class="ltx_sup" id="id3.2.id2">*</sup>
</span><span class="ltx_author_notes">112233</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Saikat Roy<span class="ltx_ERROR undefined" id="id4.1.id1">\orcidlink</span>0000-0002-0809-6524
</span><span class="ltx_author_notes">1122</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Balint Kovacs<span class="ltx_ERROR undefined" id="id5.1.id1">\orcidlink</span>0000-0002-1191-0646
</span><span class="ltx_author_notes">1144</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Constantin Ulrich<span class="ltx_ERROR undefined" id="id6.1.id1">\orcidlink</span>0000-0003-3002-8170
</span><span class="ltx_author_notes">1144</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Tassilo Wald<span class="ltx_ERROR undefined" id="id7.1.id1">\orcidlink</span>0009-0007-5222-2683
</span><span class="ltx_author_notes">112255</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Maximilian Zenk<span class="ltx_ERROR undefined" id="id8.1.id1">\orcidlink</span>0000-0002-8933-5995
</span><span class="ltx_author_notes">1144</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Stefan Denner<span class="ltx_ERROR undefined" id="id9.1.id1">\orcidlink</span>0009-0008-2302-743X
</span><span class="ltx_author_notes">1144</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Fabian Isensee<span class="ltx_ERROR undefined" id="id10.1.id1">\orcidlink</span>0000-0002-3519-5886
</span><span class="ltx_author_notes">1155</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Philipp Vollmuth<span class="ltx_ERROR undefined" id="id11.1.id1">\orcidlink</span>0000-0002-6224-0064
</span><span class="ltx_author_notes">116677</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jens Kleesiek<span class="ltx_ERROR undefined" id="id12.1.id1">\orcidlink</span>0000-0001-8686-0682
</span><span class="ltx_author_notes">8899</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Klaus Maier-Hein<span class="ltx_ERROR undefined" id="id13.1.id1">\orcidlink</span>0000-0002-6626-2463
</span><span class="ltx_author_notes">111010</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id14.id1">Accurate segmentation of Multiple Sclerosis (MS) lesions in longitudinal MRI scans is crucial for monitoring disease progression and treatment efficacy. Although changes across time are taken into account when assessing images in clinical practice, most existing deep learning methods treat scans from different timepoints separately. Among studies utilizing longitudinal images, a simple channel-wise concatenation is the primary albeit suboptimal method employed to integrate timepoints. We introduce a novel approach that explicitly incorporates temporal differences between baseline and follow-up scans through a unique architectural inductive bias called Difference Weighting Block. It merges features from two timepoints, emphasizing changes between scans. We achieve superior scores in lesion segmentation (Dice Score, Hausdorff distance) as well as lesion detection (lesion-level F<sub class="ltx_sub" id="id14.id1.1">1</sub> score) as compared to state-of-the-art longitudinal and single timepoint models across two datasets. Our code is made publicly available at: <a class="ltx_ref ltx_url" href="www.github.com/MIC-DKFZ/Longitudinal-Difference-Weighting" style="color:#0000FF;" title="">www.github.com/MIC-DKFZ/Longitudinal-Difference-Weighting</a>.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Keywords: </h6>Medical Image Segmentation Longitudinal Imaging Multiple Sclerosis
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Multiple sclerosis (MS) is an inflammatory disease in the central nervous system (CNS), characterized by the accumulation of demyelinating white-matter lesions in the brain and spinal cord, especially affecting young adults <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib12" title="">12</a>]</cite>. Magnetic resonance imaging (MRI) has been proven as a valuable diagnostic tool for identifying and monitoring MS. In clinical practice, patients typically undergo routine screenings that involve multiple MRI scans throughout their treatment. For instance, official MS guidelines advocate for regular screenings at intervals ranging from 3 to 12 months <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib21" title="">21</a>]</cite>. Monitoring the progress of MS lesions is crucial for evaluating the effectiveness of anti-inflammatory disease-modifying drugs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib7" title="">7</a>]</cite>. However, analyzing the lesion load of several MS scans at different timepoints is a heavy burden for clinicians, adding to their workload <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib25" title="">25</a>]</cite>. Thus, automating lesion segmentation is critical for clinical computer-aided diagnosis (CAD) systems, facilitating precise quantification for evaluating treatment response <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib23" title="">23</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">There has been a multitude of approaches proposed for the automated segmentation of MS lesions in brain MRI sequences, with deep learning being widely utilized <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib9" title="">9</a>]</cite>. However, common methods for white-matter lesion segmentation process images from various timepoints independently <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib4" title="">4</a>]</cite>, deviating from the clinical practice of comprehensively assessing patients’ progression over time. Current state-of-the-art biomedical image segmentation pipelines like nnUNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib16" title="">16</a>]</cite> or SwinUNETR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib15" title="">15</a>]</cite> are cross-sectional methods, meaning they only use information from single timepoints, even when longitudinal (multiple timepoint) data is available. So far, only a few works proposed using the information of prior scans for the segmentation task <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib11" title="">11</a>]</cite>. Early work from Birenbaum et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib3" title="">3</a>]</cite> passes 2D slices from multiple timepoints through a single view CNN, which are then concatenated and used to classify the center pixel. Denner et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib10" title="">10</a>]</cite> proposed a multitask network simultaneously trained on registration and segmentation using a 2.5D approach. Szeskin et al.<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib24" title="">24</a>]</cite> employed a multi-channel 3D recurrent residual U-Net model (R2UNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib1" title="">1</a>]</cite>) trained on pairs of registered scans, benefiting from the inclusion of additional time steps as inputs. Wu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib25" title="">25</a>]</cite> combine heterogeneous dataset annotations using a model that outputs the new-lesion and all-lesion mask given a baseline and follow-up scan. Notably, the non-deep learning-based neuroimage analysis tool <span class="ltx_text ltx_font_italic" id="S1.p2.1.1">FreeSurfer</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib13" title="">13</a>]</cite> was recently extended with a longitudinal whole-brain and white-matter lesion segmentation method, solving an optimization problem across all scans of a given patient <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib6" title="">6</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Nevertheless, none of the above methods impose an explicit architectural inductive bias to guide the network to use the additional timepoint. While multiple timepoints can be trivially incorporated into standard UNet-like architectures by channel-wise concatenation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib24" title="">24</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib10" title="">10</a>]</cite>, a potential concern is that the network might primarily emphasize one particular scan similar to a single timepoint model. Previous methods lack thorough evaluation against strong benchmarks<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib24" title="">24</a>]</cite>, often comparing only to their own method with single timepoint input or basic U-Net architectures, without considering state-of-the-art single timepoint methods like nnUNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib16" title="">16</a>]</cite> or SwinUNETR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib15" title="">15</a>]</cite>. Additionally, a recent review revealed that most longitudinal lesion segmentation models lack publicly available datasets or code, negatively impacting reproducibility <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib11" title="">11</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Addressing the aforementioned issues, we propose a method for longitudinal MS lesion segmentation, inherently adhering to clinical practice of assessing an image by comparison, i.e. the difference, to the previous scan. Our method introduces explicit inductive bias to leverage the information surplus from the additional baseline scan. Specifically, our model encodes both baseline and follow-up images into a latent space where a novel <span class="ltx_text ltx_font_italic" id="S1.p4.1.1">Difference Weighting Block</span> produces a temporally-informed combined representation which the decoder uses to generate the segmentation mask. Extensive experiments on two public MS datasets from different sites demonstrate that our proposed model outperforms all state-of-the-art single timepoint baselines as well as all publicly available longitudinal MS lesion segmentation methods. It achieves superior performance for both the pixel-based Dice score and the clinically more relevant lesion-based F<sub class="ltx_sub" id="S1.p4.1.2">1</sub> score, thus improving the lesion detection rate.
<br class="ltx_break"/></p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Overall, our contributions encompass these key aspects:</p>
</div>
<div class="ltx_para" id="S1.p6">
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.1">Pitfalls of existing Longitudinal Methods:</span> We demonstrate that state-of-the-art single timepoint baselines surpass existing longitudinal methods. However, even naively combining longitudinal data with strong single timepoint models yields superior performance.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.1">Difference Weighting Block:</span> Inspired by clinical practice, we incorporate explicit architectural bias to fully leverage the benefits of longitudinal information. We introduce a novel component for merging features from different timepoints in latent space, significantly enhancing generated segmentations.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i3.p1.1.1">Cross-Dataset Generalization of Longitudinal Benefits:</span> Our method demonstrates transferability to unseen datasets, indicating that the advantages of longitudinal information can be effectively applied to real world scenarios.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Method</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Integrating Prior Images for Enhanced Segmentation</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.6">Similar to a single timepoint method, our model <math alttext="F_{\theta}" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><msub id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml"><mi id="S2.SS1.p1.1.m1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.2.cmml">F</mi><mi id="S2.SS1.p1.1.m1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.2">𝐹</ci><ci id="S2.SS1.p1.1.m1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">F_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">italic_F start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> is designed to predict a segmentation mask <math alttext="\hat{Y}_{c}" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><msub id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml"><mover accent="true" id="S2.SS1.p1.2.m2.1.1.2" xref="S2.SS1.p1.2.m2.1.1.2.cmml"><mi id="S2.SS1.p1.2.m2.1.1.2.2" xref="S2.SS1.p1.2.m2.1.1.2.2.cmml">Y</mi><mo id="S2.SS1.p1.2.m2.1.1.2.1" xref="S2.SS1.p1.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS1.p1.2.m2.1.1.3" xref="S2.SS1.p1.2.m2.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><apply id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">subscript</csymbol><apply id="S2.SS1.p1.2.m2.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.2"><ci id="S2.SS1.p1.2.m2.1.1.2.1.cmml" xref="S2.SS1.p1.2.m2.1.1.2.1">^</ci><ci id="S2.SS1.p1.2.m2.1.1.2.2.cmml" xref="S2.SS1.p1.2.m2.1.1.2.2">𝑌</ci></apply><ci id="S2.SS1.p1.2.m2.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">\hat{Y}_{c}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">over^ start_ARG italic_Y end_ARG start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> for a <span class="ltx_text ltx_font_italic" id="S2.SS1.p1.6.1">current</span> scan <math alttext="X_{c}" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><msub id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml"><mi id="S2.SS1.p1.3.m3.1.1.2" xref="S2.SS1.p1.3.m3.1.1.2.cmml">X</mi><mi id="S2.SS1.p1.3.m3.1.1.3" xref="S2.SS1.p1.3.m3.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2">𝑋</ci><ci id="S2.SS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">X_{c}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">italic_X start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>. However, it additionally incorporates information from a <span class="ltx_text ltx_font_italic" id="S2.SS1.p1.6.2">prior</span> scan <math alttext="X_{p}" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.1"><semantics id="S2.SS1.p1.4.m4.1a"><msub id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml">X</mi><mi id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2">𝑋</ci><ci id="S2.SS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">X_{p}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.1d">italic_X start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> by co-learning both representations. The method thus leverages the change between <math alttext="X_{p}" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m5.1"><semantics id="S2.SS1.p1.5.m5.1a"><msub id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml"><mi id="S2.SS1.p1.5.m5.1.1.2" xref="S2.SS1.p1.5.m5.1.1.2.cmml">X</mi><mi id="S2.SS1.p1.5.m5.1.1.3" xref="S2.SS1.p1.5.m5.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><apply id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.1.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S2.SS1.p1.5.m5.1.1.2.cmml" xref="S2.SS1.p1.5.m5.1.1.2">𝑋</ci><ci id="S2.SS1.p1.5.m5.1.1.3.cmml" xref="S2.SS1.p1.5.m5.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">X_{p}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m5.1d">italic_X start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="X_{c}" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m6.1"><semantics id="S2.SS1.p1.6.m6.1a"><msub id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml"><mi id="S2.SS1.p1.6.m6.1.1.2" xref="S2.SS1.p1.6.m6.1.1.2.cmml">X</mi><mi id="S2.SS1.p1.6.m6.1.1.3" xref="S2.SS1.p1.6.m6.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><apply id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1.2">𝑋</ci><ci id="S2.SS1.p1.6.m6.1.1.3.cmml" xref="S2.SS1.p1.6.m6.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">X_{c}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m6.1d">italic_X start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> as depicted in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#S2.E1" title="In 2.1 Integrating Prior Images for Enhanced Segmentation ‣ 2 Method ‣ Longitudinal Segmentation of MS Lesions via Temporal Difference Weighting"><span class="ltx_text ltx_ref_tag">1</span></a>. For instance, the <span class="ltx_text ltx_font_italic" id="S2.SS1.p1.6.3">prior</span> image can correspond to the baseline scan, and the <span class="ltx_text ltx_font_italic" id="S2.SS1.p1.6.4">current</span> image represents a subsequent follow-up examination. For predicting the baseline scan we use the subsequent follow-up examination as additional information.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="F_{\theta}:\mathbb{R}^{3}\to\mathbb{R}^{3},\,\hat{Y}_{c}=F_{\theta}(X_{c},X_{p%
})\text{ where }X_{c}\neq X_{p}" class="ltx_Math" display="block" id="S2.E1.m1.2"><semantics id="S2.E1.m1.2a"><mrow id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml"><msub id="S2.E1.m1.2.2.4" xref="S2.E1.m1.2.2.4.cmml"><mi id="S2.E1.m1.2.2.4.2" xref="S2.E1.m1.2.2.4.2.cmml">F</mi><mi id="S2.E1.m1.2.2.4.3" xref="S2.E1.m1.2.2.4.3.cmml">θ</mi></msub><mo id="S2.E1.m1.2.2.3" lspace="0.278em" rspace="0.278em" xref="S2.E1.m1.2.2.3.cmml">:</mo><mrow id="S2.E1.m1.2.2.2.2" xref="S2.E1.m1.2.2.2.3.cmml"><mrow id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.cmml"><msup id="S2.E1.m1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.2.cmml"><mi id="S2.E1.m1.1.1.1.1.1.2.2" xref="S2.E1.m1.1.1.1.1.1.2.2.cmml">ℝ</mi><mn id="S2.E1.m1.1.1.1.1.1.2.3" xref="S2.E1.m1.1.1.1.1.1.2.3.cmml">3</mn></msup><mo id="S2.E1.m1.1.1.1.1.1.1" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.cmml">→</mo><msup id="S2.E1.m1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.1.3.2.cmml">ℝ</mi><mn id="S2.E1.m1.1.1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.1.1.3.3.cmml">3</mn></msup></mrow><mo id="S2.E1.m1.2.2.2.2.3" rspace="0.337em" xref="S2.E1.m1.2.2.2.3a.cmml">,</mo><mrow id="S2.E1.m1.2.2.2.2.2" xref="S2.E1.m1.2.2.2.2.2.cmml"><msub id="S2.E1.m1.2.2.2.2.2.4" xref="S2.E1.m1.2.2.2.2.2.4.cmml"><mover accent="true" id="S2.E1.m1.2.2.2.2.2.4.2" xref="S2.E1.m1.2.2.2.2.2.4.2.cmml"><mi id="S2.E1.m1.2.2.2.2.2.4.2.2" xref="S2.E1.m1.2.2.2.2.2.4.2.2.cmml">Y</mi><mo id="S2.E1.m1.2.2.2.2.2.4.2.1" xref="S2.E1.m1.2.2.2.2.2.4.2.1.cmml">^</mo></mover><mi id="S2.E1.m1.2.2.2.2.2.4.3" xref="S2.E1.m1.2.2.2.2.2.4.3.cmml">c</mi></msub><mo id="S2.E1.m1.2.2.2.2.2.5" xref="S2.E1.m1.2.2.2.2.2.5.cmml">=</mo><mrow id="S2.E1.m1.2.2.2.2.2.2" xref="S2.E1.m1.2.2.2.2.2.2.cmml"><msub id="S2.E1.m1.2.2.2.2.2.2.4" xref="S2.E1.m1.2.2.2.2.2.2.4.cmml"><mi id="S2.E1.m1.2.2.2.2.2.2.4.2" xref="S2.E1.m1.2.2.2.2.2.2.4.2.cmml">F</mi><mi id="S2.E1.m1.2.2.2.2.2.2.4.3" xref="S2.E1.m1.2.2.2.2.2.2.4.3.cmml">θ</mi></msub><mo id="S2.E1.m1.2.2.2.2.2.2.3" xref="S2.E1.m1.2.2.2.2.2.2.3.cmml">⁢</mo><mrow id="S2.E1.m1.2.2.2.2.2.2.2.2" xref="S2.E1.m1.2.2.2.2.2.2.2.3.cmml"><mo id="S2.E1.m1.2.2.2.2.2.2.2.2.3" stretchy="false" xref="S2.E1.m1.2.2.2.2.2.2.2.3.cmml">(</mo><msub id="S2.E1.m1.2.2.2.2.2.1.1.1.1" xref="S2.E1.m1.2.2.2.2.2.1.1.1.1.cmml"><mi id="S2.E1.m1.2.2.2.2.2.1.1.1.1.2" xref="S2.E1.m1.2.2.2.2.2.1.1.1.1.2.cmml">X</mi><mi id="S2.E1.m1.2.2.2.2.2.1.1.1.1.3" xref="S2.E1.m1.2.2.2.2.2.1.1.1.1.3.cmml">c</mi></msub><mo id="S2.E1.m1.2.2.2.2.2.2.2.2.4" xref="S2.E1.m1.2.2.2.2.2.2.2.3.cmml">,</mo><msub id="S2.E1.m1.2.2.2.2.2.2.2.2.2" xref="S2.E1.m1.2.2.2.2.2.2.2.2.2.cmml"><mi id="S2.E1.m1.2.2.2.2.2.2.2.2.2.2" xref="S2.E1.m1.2.2.2.2.2.2.2.2.2.2.cmml">X</mi><mi id="S2.E1.m1.2.2.2.2.2.2.2.2.2.3" xref="S2.E1.m1.2.2.2.2.2.2.2.2.2.3.cmml">p</mi></msub><mo id="S2.E1.m1.2.2.2.2.2.2.2.2.5" stretchy="false" xref="S2.E1.m1.2.2.2.2.2.2.2.3.cmml">)</mo></mrow><mo id="S2.E1.m1.2.2.2.2.2.2.3a" xref="S2.E1.m1.2.2.2.2.2.2.3.cmml">⁢</mo><mtext id="S2.E1.m1.2.2.2.2.2.2.5" xref="S2.E1.m1.2.2.2.2.2.2.5a.cmml"> where </mtext><mo id="S2.E1.m1.2.2.2.2.2.2.3b" xref="S2.E1.m1.2.2.2.2.2.2.3.cmml">⁢</mo><msub id="S2.E1.m1.2.2.2.2.2.2.6" xref="S2.E1.m1.2.2.2.2.2.2.6.cmml"><mi id="S2.E1.m1.2.2.2.2.2.2.6.2" xref="S2.E1.m1.2.2.2.2.2.2.6.2.cmml">X</mi><mi id="S2.E1.m1.2.2.2.2.2.2.6.3" xref="S2.E1.m1.2.2.2.2.2.2.6.3.cmml">c</mi></msub></mrow><mo id="S2.E1.m1.2.2.2.2.2.6" xref="S2.E1.m1.2.2.2.2.2.6.cmml">≠</mo><msub id="S2.E1.m1.2.2.2.2.2.7" xref="S2.E1.m1.2.2.2.2.2.7.cmml"><mi id="S2.E1.m1.2.2.2.2.2.7.2" xref="S2.E1.m1.2.2.2.2.2.7.2.cmml">X</mi><mi id="S2.E1.m1.2.2.2.2.2.7.3" xref="S2.E1.m1.2.2.2.2.2.7.3.cmml">p</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.2b"><apply id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2"><ci id="S2.E1.m1.2.2.3.cmml" xref="S2.E1.m1.2.2.3">:</ci><apply id="S2.E1.m1.2.2.4.cmml" xref="S2.E1.m1.2.2.4"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.4.1.cmml" xref="S2.E1.m1.2.2.4">subscript</csymbol><ci id="S2.E1.m1.2.2.4.2.cmml" xref="S2.E1.m1.2.2.4.2">𝐹</ci><ci id="S2.E1.m1.2.2.4.3.cmml" xref="S2.E1.m1.2.2.4.3">𝜃</ci></apply><apply id="S2.E1.m1.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.3a.cmml" xref="S2.E1.m1.2.2.2.2.3">formulae-sequence</csymbol><apply id="S2.E1.m1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1"><ci id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1">→</ci><apply id="S2.E1.m1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.2">superscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2.2">ℝ</ci><cn id="S2.E1.m1.1.1.1.1.1.2.3.cmml" type="integer" xref="S2.E1.m1.1.1.1.1.1.2.3">3</cn></apply><apply id="S2.E1.m1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.3.2">ℝ</ci><cn id="S2.E1.m1.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.E1.m1.1.1.1.1.1.3.3">3</cn></apply></apply><apply id="S2.E1.m1.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2.2"><and id="S2.E1.m1.2.2.2.2.2a.cmml" xref="S2.E1.m1.2.2.2.2.2"></and><apply id="S2.E1.m1.2.2.2.2.2b.cmml" xref="S2.E1.m1.2.2.2.2.2"><eq id="S2.E1.m1.2.2.2.2.2.5.cmml" xref="S2.E1.m1.2.2.2.2.2.5"></eq><apply id="S2.E1.m1.2.2.2.2.2.4.cmml" xref="S2.E1.m1.2.2.2.2.2.4"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.2.2.4.1.cmml" xref="S2.E1.m1.2.2.2.2.2.4">subscript</csymbol><apply id="S2.E1.m1.2.2.2.2.2.4.2.cmml" xref="S2.E1.m1.2.2.2.2.2.4.2"><ci id="S2.E1.m1.2.2.2.2.2.4.2.1.cmml" xref="S2.E1.m1.2.2.2.2.2.4.2.1">^</ci><ci id="S2.E1.m1.2.2.2.2.2.4.2.2.cmml" xref="S2.E1.m1.2.2.2.2.2.4.2.2">𝑌</ci></apply><ci id="S2.E1.m1.2.2.2.2.2.4.3.cmml" xref="S2.E1.m1.2.2.2.2.2.4.3">𝑐</ci></apply><apply id="S2.E1.m1.2.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2.2.2"><times id="S2.E1.m1.2.2.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2.2.2.3"></times><apply id="S2.E1.m1.2.2.2.2.2.2.4.cmml" xref="S2.E1.m1.2.2.2.2.2.2.4"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.2.2.2.4.1.cmml" xref="S2.E1.m1.2.2.2.2.2.2.4">subscript</csymbol><ci id="S2.E1.m1.2.2.2.2.2.2.4.2.cmml" xref="S2.E1.m1.2.2.2.2.2.2.4.2">𝐹</ci><ci id="S2.E1.m1.2.2.2.2.2.2.4.3.cmml" xref="S2.E1.m1.2.2.2.2.2.2.4.3">𝜃</ci></apply><interval closure="open" id="S2.E1.m1.2.2.2.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2.2.2.2.2"><apply id="S2.E1.m1.2.2.2.2.2.1.1.1.1.cmml" xref="S2.E1.m1.2.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.2.2.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.2.2.2.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.2.2.2.2.2.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.2.2.2.1.1.1.1.2">𝑋</ci><ci id="S2.E1.m1.2.2.2.2.2.1.1.1.1.3.cmml" xref="S2.E1.m1.2.2.2.2.2.1.1.1.1.3">𝑐</ci></apply><apply id="S2.E1.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E1.m1.2.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S2.E1.m1.2.2.2.2.2.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2.2.2.2.2.2.2">𝑋</ci><ci id="S2.E1.m1.2.2.2.2.2.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2.2.2.2.2.2.3">𝑝</ci></apply></interval><ci id="S2.E1.m1.2.2.2.2.2.2.5a.cmml" xref="S2.E1.m1.2.2.2.2.2.2.5"><mtext id="S2.E1.m1.2.2.2.2.2.2.5.cmml" xref="S2.E1.m1.2.2.2.2.2.2.5"> where </mtext></ci><apply id="S2.E1.m1.2.2.2.2.2.2.6.cmml" xref="S2.E1.m1.2.2.2.2.2.2.6"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.2.2.2.6.1.cmml" xref="S2.E1.m1.2.2.2.2.2.2.6">subscript</csymbol><ci id="S2.E1.m1.2.2.2.2.2.2.6.2.cmml" xref="S2.E1.m1.2.2.2.2.2.2.6.2">𝑋</ci><ci id="S2.E1.m1.2.2.2.2.2.2.6.3.cmml" xref="S2.E1.m1.2.2.2.2.2.2.6.3">𝑐</ci></apply></apply></apply><apply id="S2.E1.m1.2.2.2.2.2c.cmml" xref="S2.E1.m1.2.2.2.2.2"><neq id="S2.E1.m1.2.2.2.2.2.6.cmml" xref="S2.E1.m1.2.2.2.2.2.6"></neq><share href="https://arxiv.org/html/2409.13416v1#S2.E1.m1.2.2.2.2.2.2.cmml" id="S2.E1.m1.2.2.2.2.2d.cmml" xref="S2.E1.m1.2.2.2.2.2"></share><apply id="S2.E1.m1.2.2.2.2.2.7.cmml" xref="S2.E1.m1.2.2.2.2.2.7"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.2.2.7.1.cmml" xref="S2.E1.m1.2.2.2.2.2.7">subscript</csymbol><ci id="S2.E1.m1.2.2.2.2.2.7.2.cmml" xref="S2.E1.m1.2.2.2.2.2.7.2">𝑋</ci><ci id="S2.E1.m1.2.2.2.2.2.7.3.cmml" xref="S2.E1.m1.2.2.2.2.2.7.3">𝑝</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.2c">F_{\theta}:\mathbb{R}^{3}\to\mathbb{R}^{3},\,\hat{Y}_{c}=F_{\theta}(X_{c},X_{p%
})\text{ where }X_{c}\neq X_{p}</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.2d">italic_F start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT : blackboard_R start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT → blackboard_R start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT , over^ start_ARG italic_Y end_ARG start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = italic_F start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_X start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT , italic_X start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ) where italic_X start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ≠ italic_X start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<br class="ltx_break"/>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.1">The aim of a longitudinal approach is to improve the segmentation by utilizing information from multiple timepoints. Instead of the early fusion of longitudinal scans in the form of channel-wise concatenation, we propose a later fusion of features from the two timepoints. We achieve this by passing both the baseline and follow-up images through a shared encoder. Then, we merge the resulting features using a novel <span class="ltx_text ltx_font_italic" id="S2.SS1.p3.1.1">Difference Weighting Block</span>, which takes into account information from both scans, explicitly putting focus on the prior scan. Our architecture inherently utilizes the feature space difference between the current and prior scans as a weighting factor. This combined representation is then used by the decoder to produce the output segmentation. Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#S2.F1" title="Figure 1 ‣ 2.1 Integrating Prior Images for Enhanced Segmentation ‣ 2 Method ‣ Longitudinal Segmentation of MS Lesions via Temporal Difference Weighting"><span class="ltx_text ltx_ref_tag">1</span></a> shows an overview of our pipeline as well as a schematic of the Difference Weighting Block.</p>
</div>
<figure class="ltx_figure" id="S2.F1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="341" id="S2.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F1.4.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text ltx_font_italic" id="S2.F1.5.2" style="font-size:90%;">Left:<span class="ltx_text ltx_font_upright" id="S2.F1.5.2.1"> Pipeline of our proposed model. First, the prior image (baseline) and current image (follow-up) are both encoded by a shared encoder. Subsequently, the Difference Weighting Block is applied on all skip connections to merge these encoded representations, emphasizing dissimilarities between the two images. This temporally enhanced representation is then fed to the decoder to produce the segmentation of the current image. </span>Right:<span class="ltx_text ltx_font_upright" id="S2.F1.5.2.2"> Architecture of the Difference Weighting Block. Firstly, the difference between the features extracted from the current and prior images is computed, followed by an Instance Norm. This result is then multiplied with the current image features and finally a residual connection is added.</span></span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Difference Weighting Block</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.3">The Difference Weighting Block acts as a mechanism to weigh and incorporate the temporal differences between images, enhancing the ability of the network to leverage prior scan information for improved segmentation. The architecture involves a series of steps designed to effectively merge latent representations from both the current and prior images. It operates on all resolutions of the U-Net skip connections. Initially, the block calculates the difference between the features <math alttext="x_{c}" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><msub id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><mi id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml">x</mi><mi id="S2.SS2.p1.1.m1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2">𝑥</ci><ci id="S2.SS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">x_{c}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> extracted from the current image and features <math alttext="x_{p}" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.1"><semantics id="S2.SS2.p1.2.m2.1a"><msub id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml"><mi id="S2.SS2.p1.2.m2.1.1.2" xref="S2.SS2.p1.2.m2.1.1.2.cmml">x</mi><mi id="S2.SS2.p1.2.m2.1.1.3" xref="S2.SS2.p1.2.m2.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><apply id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p1.2.m2.1.1.2.cmml" xref="S2.SS2.p1.2.m2.1.1.2">𝑥</ci><ci id="S2.SS2.p1.2.m2.1.1.3.cmml" xref="S2.SS2.p1.2.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">x_{p}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.1d">italic_x start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> obtained from the prior image. Subsequently, an Instance Normalization is applied to the calculated difference, generating a <span class="ltx_text ltx_font_italic" id="S2.SS2.p1.3.1">normalized attention map highlighting areas of change</span>. The attention map is then multiplied by the features initially derived from the current image. This multiplication process serves as a weighting to emphasize or de-emphasize specific features based on the differences between the two images. It effectively modulates the importance of each feature in the context of changes over time. In contrast to classical attention our block offers a distinct advantage through its lightweight design, which enables 3D operation at all resolutions, and the inherent focus on the differences between inputs. Finally, to ensure a smooth integration, a residual connection is introduced adding the modified features back to the original features extracted from the current image. The output of the Difference Weighting Block are the temporally informed features <math alttext="x^{\prime}_{c}" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m3.1"><semantics id="S2.SS2.p1.3.m3.1a"><msubsup id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml"><mi id="S2.SS2.p1.3.m3.1.1.2.2" xref="S2.SS2.p1.3.m3.1.1.2.2.cmml">x</mi><mi id="S2.SS2.p1.3.m3.1.1.3" xref="S2.SS2.p1.3.m3.1.1.3.cmml">c</mi><mo id="S2.SS2.p1.3.m3.1.1.2.3" xref="S2.SS2.p1.3.m3.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><apply id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.1.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">subscript</csymbol><apply id="S2.SS2.p1.3.m3.1.1.2.cmml" xref="S2.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.1.1.2.1.cmml" xref="S2.SS2.p1.3.m3.1.1">superscript</csymbol><ci id="S2.SS2.p1.3.m3.1.1.2.2.cmml" xref="S2.SS2.p1.3.m3.1.1.2.2">𝑥</ci><ci id="S2.SS2.p1.3.m3.1.1.2.3.cmml" xref="S2.SS2.p1.3.m3.1.1.2.3">′</ci></apply><ci id="S2.SS2.p1.3.m3.1.1.3.cmml" xref="S2.SS2.p1.3.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">x^{\prime}_{c}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m3.1d">italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> used to predict the mask of the current image as shown in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#S2.E2" title="In 2.2 Difference Weighting Block ‣ 2 Method ‣ Longitudinal Segmentation of MS Lesions via Temporal Difference Weighting"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="x^{\prime}_{c}=x_{c}\times\mathrm{InstNorm}(x_{c}-x_{p})+x_{c}" class="ltx_Math" display="block" id="S2.E2.m1.1"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml"><msubsup id="S2.E2.m1.1.1.3" xref="S2.E2.m1.1.1.3.cmml"><mi id="S2.E2.m1.1.1.3.2.2" xref="S2.E2.m1.1.1.3.2.2.cmml">x</mi><mi id="S2.E2.m1.1.1.3.3" xref="S2.E2.m1.1.1.3.3.cmml">c</mi><mo id="S2.E2.m1.1.1.3.2.3" xref="S2.E2.m1.1.1.3.2.3.cmml">′</mo></msubsup><mo id="S2.E2.m1.1.1.2" xref="S2.E2.m1.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.cmml"><mrow id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><mrow id="S2.E2.m1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.3.cmml"><msub id="S2.E2.m1.1.1.1.1.3.2" xref="S2.E2.m1.1.1.1.1.3.2.cmml"><mi id="S2.E2.m1.1.1.1.1.3.2.2" xref="S2.E2.m1.1.1.1.1.3.2.2.cmml">x</mi><mi id="S2.E2.m1.1.1.1.1.3.2.3" xref="S2.E2.m1.1.1.1.1.3.2.3.cmml">c</mi></msub><mo id="S2.E2.m1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S2.E2.m1.1.1.1.1.3.1.cmml">×</mo><mi id="S2.E2.m1.1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.1.3.3.cmml">InstNorm</mi></mrow><mo id="S2.E2.m1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.E2.m1.1.1.1.1.1.1.1.2.3" xref="S2.E2.m1.1.1.1.1.1.1.1.2.3.cmml">c</mi></msub><mo id="S2.E2.m1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S2.E2.m1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mi id="S2.E2.m1.1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.1.1.1.1.3.3.cmml">p</mi></msub></mrow><mo id="S2.E2.m1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E2.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.1.1.1.2" xref="S2.E2.m1.1.1.1.2.cmml">+</mo><msub id="S2.E2.m1.1.1.1.3" xref="S2.E2.m1.1.1.1.3.cmml"><mi id="S2.E2.m1.1.1.1.3.2" xref="S2.E2.m1.1.1.1.3.2.cmml">x</mi><mi id="S2.E2.m1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.3.3.cmml">c</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1"><eq id="S2.E2.m1.1.1.2.cmml" xref="S2.E2.m1.1.1.2"></eq><apply id="S2.E2.m1.1.1.3.cmml" xref="S2.E2.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.3">subscript</csymbol><apply id="S2.E2.m1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.2.1.cmml" xref="S2.E2.m1.1.1.3">superscript</csymbol><ci id="S2.E2.m1.1.1.3.2.2.cmml" xref="S2.E2.m1.1.1.3.2.2">𝑥</ci><ci id="S2.E2.m1.1.1.3.2.3.cmml" xref="S2.E2.m1.1.1.3.2.3">′</ci></apply><ci id="S2.E2.m1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.3.3">𝑐</ci></apply><apply id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><plus id="S2.E2.m1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.2"></plus><apply id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1"><times id="S2.E2.m1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.2"></times><apply id="S2.E2.m1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.3"><times id="S2.E2.m1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.1"></times><apply id="S2.E2.m1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.3.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2">𝑥</ci><ci id="S2.E2.m1.1.1.1.1.3.2.3.cmml" xref="S2.E2.m1.1.1.1.1.3.2.3">𝑐</ci></apply><ci id="S2.E2.m1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.3">InstNorm</ci></apply><apply id="S2.E2.m1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1"><minus id="S2.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1"></minus><apply id="S2.E2.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.E2.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.2.3">𝑐</ci></apply><apply id="S2.E2.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.3.2">𝑥</ci><ci id="S2.E2.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.3.3">𝑝</ci></apply></apply></apply><apply id="S2.E2.m1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.3.2">𝑥</ci><ci id="S2.E2.m1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">x^{\prime}_{c}=x_{c}\times\mathrm{InstNorm}(x_{c}-x_{p})+x_{c}</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.1d">italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = italic_x start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT × roman_InstNorm ( italic_x start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT - italic_x start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ) + italic_x start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experiments</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Datasets</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">To comprehensively assess the efficacy of our model across diverse data, we conducted experiments on two separate longitudinal multiple sclerosis segmentation datasets obtained from distinct medical sites, as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#S3.T1" title="Table 1 ‣ 3.1 Datasets ‣ 3 Experiments ‣ Longitudinal Segmentation of MS Lesions via Temporal Difference Weighting"><span class="ltx_text ltx_ref_tag">1</span></a>. We use a dataset from the University Medical Center Ljubljana and the Laboratory of Imaging Technologies, University of Ljubljana <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib19" title="">19</a>]</cite>. It contains <math alttext="1\mathrm{mm}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mn id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">1</mn><mo id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p1.1.m1.1.1.3" mathvariant="normal" xref="S3.SS1.p1.1.m1.1.1.3.cmml">m</mi><mo id="S3.SS1.p1.1.m1.1.1.1a" xref="S3.SS1.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p1.1.m1.1.1.4" mathvariant="normal" xref="S3.SS1.p1.1.m1.1.1.4.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><times id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"></times><cn id="S3.SS1.p1.1.m1.1.1.2.cmml" type="integer" xref="S3.SS1.p1.1.m1.1.1.2">1</cn><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">m</ci><ci id="S3.SS1.p1.1.m1.1.1.4.cmml" xref="S3.SS1.p1.1.m1.1.1.4">m</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">1\mathrm{mm}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">1 roman_m roman_m</annotation></semantics></math> isotropic resolution T1-weighted and FLAIR MR brain images from 162 subjects, each with two to four timepoints, acquired with a 3T Siemens Magnetom Trio MR system. Manual annotations of white-matter lesions were performed through automated segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib14" title="">14</a>]</cite>, followed by manual corrections by three expert raters <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib19" title="">19</a>]</cite>, with collaborative revisions to achieve consensus. A partial version of the dataset is publicly accessible<span class="ltx_note ltx_role_footnote" id="footnotex1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a class="ltx_ref ltx_url" href="https://github.com/muschellij2/open_ms_data" style="color:#0000FF;" title="">https://github.com/muschellij2/open˙ms˙data</a></span></span></span>, the rest is available upon request. Additionally, we utilize the publicly accessible training split<span class="ltx_note ltx_role_footnote" id="footnotex2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a class="ltx_ref ltx_url" href="https://smart-stats-tools.org/lesion-challenge" style="color:#0000FF;" title="">https://smart-stats-tools.org/lesion-challenge</a></span></span></span> from the ISBI 2015 Longitudinal MS Lesion Segmentation Challenge <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib5" title="">5</a>]</cite> for independent model evaluation. It comprises 5 patients, with an average of 4.4 scans per patient, acquired using a 3T MRI scanner from Philips Medical Systems. Manual annotations of white-matter lesions were conducted by two raters. For consistency with the Ljubljana dataset, we exclusively employ the T1-weighted and FLAIR sequences out of the four available sequences (T1w, T2w, PDw, and FLAIR) for evaluation.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S3.T1.2.1.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S3.T1.3.2" style="font-size:90%;">Details of the datasets used for training and evaluation. The dataset split is shown in parenthesis (Training, Test). Note that we use the ISBI 2015 dataset solely as an external testset due to the small size.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T1.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T1.4.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T1.4.1.1.1" rowspan="2"><span class="ltx_text" id="S3.T1.4.1.1.1.1">Origin</span></th>
<th class="ltx_td ltx_nopad_l ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T1.4.1.1.2" rowspan="2"><span class="ltx_text" id="S3.T1.4.1.1.2.1">Modalities</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S3.T1.4.1.1.3">Patients</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S3.T1.4.1.1.4">Number of scans</th>
</tr>
<tr class="ltx_tr" id="S3.T1.4.2.2">
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_column" id="S3.T1.4.2.2.1">  Train</th>
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_column" id="S3.T1.4.2.2.2">Test</th>
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_column" id="S3.T1.4.2.2.3"><span class="ltx_text ltx_inline-block" id="S3.T1.4.2.2.3.1" style="width:45.0pt;">      Train</span></th>
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_column" id="S3.T1.4.2.2.4"><span class="ltx_text ltx_inline-block" id="S3.T1.4.2.2.4.1" style="width:45.0pt;">Test</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.4.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.4.3.1.1">Ljubljana <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib19" title="">19</a>]</cite>
</th>
<th class="ltx_td ltx_nopad_l ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.4.3.1.2">T1, FLAIR</th>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" id="S3.T1.4.3.1.3">  129</td>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" id="S3.T1.4.3.1.4">33</td>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" id="S3.T1.4.3.1.5">      264</td>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" id="S3.T1.4.3.1.6">67</td>
</tr>
<tr class="ltx_tr" id="S3.T1.4.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S3.T1.4.4.2.1">ISBI 2015 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib5" title="">5</a>]</cite>
</th>
<th class="ltx_td ltx_nopad_l ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S3.T1.4.4.2.2">T1, FLAIR</th>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_bb" id="S3.T1.4.4.2.3">  -</td>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_bb" id="S3.T1.4.4.2.4">5</td>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_bb" id="S3.T1.4.4.2.5">      -</td>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_bb" id="S3.T1.4.4.2.6">21</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Evaluation Metrics</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.2">In this study, we assess the efficacy of various models using a comprehensive set of metrics, encompassing volumetric, distance-based, and lesion-centered measures. Specifically, we calculate the Dice coefficient for voxel-level accuracy, the 95% Hausdorff distance to evaluate boundary discrepancies, and the lesion-based F<sub class="ltx_sub" id="S3.SS2.p1.2.1">1</sub> score as a clinically relevant lesion detection metric<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib20" title="">20</a>]</cite>. To align with previous evaluation guidelines <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib8" title="">8</a>]</cite>, lesions smaller than <math alttext="3~{}\mathrm{mm}^{3}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mn id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">3</mn><mo id="S3.SS2.p1.1.m1.1.1.1" lspace="0.330em" xref="S3.SS2.p1.1.m1.1.1.1.cmml">⁢</mo><msup id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.2" xref="S3.SS2.p1.1.m1.1.1.3.2.cmml">mm</mi><mn id="S3.SS2.p1.1.m1.1.1.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><times id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1"></times><cn id="S3.SS2.p1.1.m1.1.1.2.cmml" type="integer" xref="S3.SS2.p1.1.m1.1.1.2">3</cn><apply id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2">mm</ci><cn id="S3.SS2.p1.1.m1.1.1.3.3.cmml" type="integer" xref="S3.SS2.p1.1.m1.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">3~{}\mathrm{mm}^{3}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">3 roman_mm start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math> are omitted from both the ground truth and predictions prior to metric computation. Results without size filtering are shown in the Appendix. We compute the lesion-based F<sub class="ltx_sub" id="S3.SS2.p1.2.2">1</sub> score as the harmonic mean of separately calculated lesion-based precision and recall. Following best practice guidelines for medical object detection<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib17" title="">17</a>]</cite>, we set a threshold of <math alttext="0.1" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mn id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><cn id="S3.SS2.p1.2.m2.1.1.cmml" type="float" xref="S3.SS2.p1.2.m2.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">0.1</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">0.1</annotation></semantics></math> for the Intersection over Union of true positive lesions. Crucially, to account for the varying number of scans per patient and to mitigate potential biases, we average all metrics across patients. The patient-wise averaging ensures a fair and balanced evaluation, reflecting the performance in the clinical scenario.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Implementation details</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.4">First, we perform affine registration utilizing FSL FLIRT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib18" title="">18</a>]</cite> to align follow-up examinations with the initial baseline scan. This ensures a consistent image space across all scans for a given patient. Following the methodology of nnUNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib16" title="">16</a>]</cite>, we automatically determine the optimal U-Net architecture, normalization scheme, and patch size. Training is conducted with a batch size of <math alttext="2" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mn id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><cn id="S3.SS3.p1.1.m1.1.1.cmml" type="integer" xref="S3.SS3.p1.1.m1.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">2</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">2</annotation></semantics></math>, utilizing patches of dimensions <math alttext="128\times 160\times 128" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><mrow id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mn id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">128</mn><mo id="S3.SS3.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p1.2.m2.1.1.1.cmml">×</mo><mn id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">160</mn><mo id="S3.SS3.p1.2.m2.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p1.2.m2.1.1.1.cmml">×</mo><mn id="S3.SS3.p1.2.m2.1.1.4" xref="S3.SS3.p1.2.m2.1.1.4.cmml">128</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><times id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1"></times><cn id="S3.SS3.p1.2.m2.1.1.2.cmml" type="integer" xref="S3.SS3.p1.2.m2.1.1.2">128</cn><cn id="S3.SS3.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.SS3.p1.2.m2.1.1.3">160</cn><cn id="S3.SS3.p1.2.m2.1.1.4.cmml" type="integer" xref="S3.SS3.p1.2.m2.1.1.4">128</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">128\times 160\times 128</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">128 × 160 × 128</annotation></semantics></math> and z-score normalization. It is important to note that during preprocessing, we crop all images of an individual patient to the largest nonzero bounding box encompassing all timepoints. For optimization, we employ the default nnUNet training scheme, that is, SGD optimizer with momentum <math alttext="0.99" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><mn id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">0.99</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><cn id="S3.SS3.p1.3.m3.1.1.cmml" type="float" xref="S3.SS3.p1.3.m3.1.1">0.99</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">0.99</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">0.99</annotation></semantics></math>, an initial learning rate of <math alttext="0.01" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.1"><semantics id="S3.SS3.p1.4.m4.1a"><mn id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><cn id="S3.SS3.p1.4.m4.1.1.cmml" type="float" xref="S3.SS3.p1.4.m4.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">0.01</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m4.1d">0.01</annotation></semantics></math> and polynomial decay.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Results and Discussion</h2>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T2.11.1.1" style="font-size:90%;">Table 2</span>: </span><span class="ltx_text" id="S4.T2.12.2" style="font-size:90%;">Comparison of state-of-the-art single timepoint and longitudinal methods for MS lesion segmentation on the Ljubljana dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib19" title="">19</a>]</cite>. <span class="ltx_text ltx_font_italic" id="S4.T2.12.2.1">Longitudinal nnUNet</span> is shown as an ablation. Statistical analysis is given in the Appendix.

<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S4.T2.12.2.2">Bold</span>: Best performance, <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.12.2.3">Underlined</span>: best single or multi timepoint baseline.
</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T2.6">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.6.7.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S4.T2.6.7.1.1"></th>
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S4.T2.6.7.1.2"></th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S4.T2.6.7.1.3">5-fold Cross Val</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S4.T2.6.7.1.4">Test Set</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.6">
<th class="ltx_td ltx_th ltx_th_row" id="S4.T2.6.6.7"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.6.6.8">Method</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.1">DSC <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.1.1.1.m1.1"><semantics id="S4.T2.1.1.1.m1.1a"><mo id="S4.T2.1.1.1.m1.1.1" stretchy="false" xref="S4.T2.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.1b"><ci id="S4.T2.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.2.2">HD95 <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.2.2.2.m1.1"><semantics id="S4.T2.2.2.2.m1.1a"><mo id="S4.T2.2.2.2.m1.1.1" stretchy="false" xref="S4.T2.2.2.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.m1.1b"><ci id="S4.T2.2.2.2.m1.1.1.cmml" xref="S4.T2.2.2.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.2.2.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.3.3">F<sub class="ltx_sub" id="S4.T2.3.3.3.1">1</sub> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.3.3.3.m1.1"><semantics id="S4.T2.3.3.3.m1.1a"><mo id="S4.T2.3.3.3.m1.1.1" stretchy="false" xref="S4.T2.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.m1.1b"><ci id="S4.T2.3.3.3.m1.1.1.cmml" xref="S4.T2.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.3.3.3.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.4.4">DSC <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.4.4.4.m1.1"><semantics id="S4.T2.4.4.4.m1.1a"><mo id="S4.T2.4.4.4.m1.1.1" stretchy="false" xref="S4.T2.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.4.m1.1b"><ci id="S4.T2.4.4.4.m1.1.1.cmml" xref="S4.T2.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.4.4.4.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.5.5">HD95 <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.5.5.5.m1.1"><semantics id="S4.T2.5.5.5.m1.1a"><mo id="S4.T2.5.5.5.m1.1.1" stretchy="false" xref="S4.T2.5.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.5.m1.1b"><ci id="S4.T2.5.5.5.m1.1.1.cmml" xref="S4.T2.5.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.5.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.5.5.5.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.6">F<sub class="ltx_sub" id="S4.T2.6.6.6.1">1</sub> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.6.6.6.m1.1"><semantics id="S4.T2.6.6.6.m1.1a"><mo id="S4.T2.6.6.6.m1.1.1" stretchy="false" xref="S4.T2.6.6.6.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.6.6.6.m1.1b"><ci id="S4.T2.6.6.6.m1.1.1.cmml" xref="S4.T2.6.6.6.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.6.6.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.6.6.6.m1.1d">↑</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.8.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T2.6.8.2.1" rowspan="2"><span class="ltx_text" id="S4.T2.6.8.2.1.1">
<span class="ltx_inline-block" id="S4.T2.6.8.2.1.1.1">
<span class="ltx_p" id="S4.T2.6.8.2.1.1.1.1">Single</span>
<span class="ltx_p" id="S4.T2.6.8.2.1.1.1.2">Timepoint</span>
</span></span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T2.6.8.2.2">nnUNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib16" title="">16</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.8.2.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.6.8.2.3.1">73.37</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.8.2.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.6.8.2.4.1">4.51</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.8.2.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.6.8.2.5.1">69.83</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.8.2.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.6.8.2.6.1">74.16</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.8.2.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.6.8.2.7.1">4.95</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.8.2.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.6.8.2.8.1">71.27</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.9.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.6.9.3.1">SwinUNETR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib15" title="">15</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.6.9.3.2">73.12</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.9.3.3">4.72</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.9.3.4">69.34</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.9.3.5">74.05</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.9.3.6">4.96</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.9.3.7">70.67</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.10.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S4.T2.6.10.4.1" rowspan="6"><span class="ltx_text" id="S4.T2.6.10.4.1.1">
<span class="ltx_inline-block" id="S4.T2.6.10.4.1.1.1">
<span class="ltx_p" id="S4.T2.6.10.4.1.1.1.1">Longi-</span>
<span class="ltx_p" id="S4.T2.6.10.4.1.1.1.2">tudinal</span>
</span></span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T2.6.10.4.2">FreeSurfer Samseg (2023) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib6" title="">6</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.10.4.3">62.47</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.10.4.4">12.77</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.10.4.5">37.08</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.10.4.6">45.54</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.10.4.7">15.84</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.10.4.8">33.05</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.11.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.6.11.5.1">Denner et.al. (2020) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib10" title="">10</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.6.11.5.2">67.42</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.11.5.3">5.69</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.11.5.4">61.56</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.11.5.5">69.57</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.11.5.6">5.43</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.11.5.7">65.59</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.12.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.6.12.6.1">Szeskin et.al.<span class="ltx_note ltx_role_footnote" id="footnotex3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>Reimplemented in the nnUNet Framework</span></span></span> (2022) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib24" title="">24</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.6.12.6.2">73.24</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.12.6.3">4.87</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.12.6.4">68.45</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.12.6.5">73.44</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.12.6.6">5.11</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.12.6.7">69.08</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.13.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.6.13.7.1">Wu et.al. (2023) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib25" title="">25</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.6.13.7.2">71.61</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.13.7.3">6.16</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.13.7.4">64.42</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.13.7.5">72.53</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.13.7.6">6.57</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.13.7.7">66.17</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.14.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T2.6.14.8.1">Longitudinal nnUNet <span class="ltx_text ltx_font_italic" id="S4.T2.6.14.8.1.1">(Ours)</span>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.14.8.2">74.37</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.14.8.3">4.12</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.14.8.4">71.32</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.14.8.5">75.29</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.14.8.6"><span class="ltx_text ltx_font_bold" id="S4.T2.6.14.8.6.1">4.59</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.14.8.7">72.92</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.15.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T2.6.15.9.1">+ Diff. Weighting <span class="ltx_text ltx_font_italic" id="S4.T2.6.15.9.1.1">(Ours)</span>
</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.6.15.9.2"><span class="ltx_text ltx_font_bold" id="S4.T2.6.15.9.2.1">75.05</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.6.15.9.3"><span class="ltx_text ltx_font_bold" id="S4.T2.6.15.9.3.1">3.99</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.6.15.9.4"><span class="ltx_text ltx_font_bold" id="S4.T2.6.15.9.4.1">72.72</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.6.15.9.5"><span class="ltx_text ltx_font_bold" id="S4.T2.6.15.9.5.1">75.61</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.6.15.9.6">4.61</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.6.15.9.7"><span class="ltx_text ltx_font_bold" id="S4.T2.6.15.9.7.1">73.28</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_figure" id="S4.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F2.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_portrait" height="998" id="S4.F2.sf1.g1" src="extracted/5868167/figures/case_nnunet_green.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F2.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S4.F2.sf1.3.2" style="font-size:90%;">nnUNet<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib16" title="">16</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F2.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_portrait" height="998" id="S4.F2.sf2.g1" src="extracted/5868167/figures/case1_simunet_green.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F2.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S4.F2.sf2.3.2" style="font-size:90%;">Szeskin et.al.<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib24" title="">24</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F2.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_portrait" height="998" id="S4.F2.sf3.g1" src="extracted/5868167/figures/case_diffweigh_green.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F2.sf3.3.1.1" style="font-size:90%;">(c)</span> </span>
<span class="ltx_inline-block" id="S4.F2.sf3.4.2">
<span class="ltx_p" id="S4.F2.sf3.4.2.1"><span class="ltx_text" id="S4.F2.sf3.4.2.1.1" style="font-size:90%;">Difference</span></span>
<span class="ltx_p" id="S4.F2.sf3.4.2.2"><span class="ltx_text" id="S4.F2.sf3.4.2.2.1" style="font-size:90%;">Weighting </span><span class="ltx_text ltx_font_italic" id="S4.F2.sf3.4.2.2.2" style="font-size:90%;">(Ours)</span></span>
</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F2.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_portrait" height="998" id="S4.F2.sf4.g1" src="extracted/5868167/figures/case1_gt_green.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F2.sf4.2.1.1" style="font-size:90%;">(d)</span> </span><span class="ltx_text" id="S4.F2.sf4.3.2" style="font-size:90%;">Ground Truth</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F2.2.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S4.F2.3.2" style="font-size:90%;">Qualitative results on the Ljubljana dataset. Compared to related work, our proposed method demonstrates superior performance in volumetric delineation of MS lesions and successfully identifies lesions missed by other methods.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#S4.T2" title="Table 2 ‣ 4 Results and Discussion ‣ Longitudinal Segmentation of MS Lesions via Temporal Difference Weighting"><span class="ltx_text ltx_ref_tag">2</span></a> illustrates SOTA performance against several established single and multi timepoint baselines on the Ljubljana dataset. We also show the generalizability of our best models on the ISBI 2015 dataset in Tab. <a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#S4.T3" title="Table 3 ‣ 4 Results and Discussion ‣ Longitudinal Segmentation of MS Lesions via Temporal Difference Weighting"><span class="ltx_text ltx_ref_tag">3</span></a> respectively. Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#S4.F2" title="Figure 2 ‣ 4 Results and Discussion ‣ Longitudinal Segmentation of MS Lesions via Temporal Difference Weighting"><span class="ltx_text ltx_ref_tag">2</span></a> shows additional qualitative results on the Ljubljana dataset. Overall, we demonstrate the following findings:
<br class="ltx_break"/></p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p2">
<p class="ltx_p" id="S4.p2.1"><span class="ltx_text ltx_font_bold" id="S4.p2.1.1">Powerful single timepoint networks outperform existing longitudinal approaches:</span> nnUNet<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib16" title="">16</a>]</cite>, as the best single timepoint model, achieves a Dice score of 74.16%, a 95% Hausdorff Distance of 4.95mm and a lesion-based F<sub class="ltx_sub" id="S4.p2.1.2">1</sub> score of 71.27% on the test set of the Ljubljana dataset. The results clearly show that current <span class="ltx_text ltx_font_italic" id="S4.p2.1.3">longitudinal</span> approaches consistently struggle to surpass or even reach this performance. The most competitive longitudinal baseline, a reimplementation of Szeskin et.al.’s method <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib24" title="">24</a>]</cite> within the nnUNet framework, still performs worse than nnUNet on all metrics, especially falling short 2.19% in lesion-based F<sub class="ltx_sub" id="S4.p2.1.4">1</sub> score. The other two deep learning based baselines from Denner et al.<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib10" title="">10</a>]</cite> and Wu el.al.<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib25" title="">25</a>]</cite> demonstrate even lower performances with large decreases in all metrics. The non deep learning based FreeSurfer Samseg tool<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib6" title="">6</a>]</cite> achieves the worst results with a Dice score of 45.54%, a 95% Hausdorff distance of 15.84mm and a lesion-based F<sub class="ltx_sub" id="S4.p2.1.5">1</sub> score of 33.05%.
<br class="ltx_break"/></p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p3">
<p class="ltx_p" id="S4.p3.1"><span class="ltx_text ltx_font_bold" id="S4.p3.1.1">Pairing powerful single timepoint methods with longitudinal data enables efficient use of additional information:</span> While nnUNet on single timepoints outperforms inefficient longitudinal methods, the ablation of naively integrating longitudinal data into nnUNet through color channel concatenation (<span class="ltx_text ltx_font_italic" id="S4.p3.1.2">Longitudinal nnUNet</span>) delivers enhancements across all investigated metrics when compared to previous longitudinal methods and SOTA single timepoint approaches. This underlines the potential gain longitudinal data can have even just as an additional channel input of a powerful single timepoint network.
<br class="ltx_break"/></p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p4">
<p class="ltx_p" id="S4.p4.1"><span class="ltx_text ltx_font_bold" id="S4.p4.1.1">Employing inductive bias via feature differences achieves SOTA performance:</span> The integration of our novel Difference Weighting method further elevates the model’s performance, demonstrating a new state-of-the-art performance. Our proposed method improves upon nnUNet, as the best performing state-of-the-art model, by 1.45% in Dice score and 0.34mm in 95% Hausdorff distance. Notably, we see an increase of 2.01% in lesion-based F<sub class="ltx_sub" id="S4.p4.1.2">1</sub> score, as the most important clinical metric, indicating that our approach better detects individual lesions. We also surpass the Longitudinal nnUNet indicating that the imposed inductive bias is superior over plain channel-wise concatenation.
<br class="ltx_break"/></p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p5">
<p class="ltx_p" id="S4.p5.1"><span class="ltx_text ltx_font_bold" id="S4.p5.1.1">Benefits from longitudinal data are transferable across datasets:</span> The evaluation on the ISBI 2015 dataset validates the robustness of our method across datasets as shown in Tab. <a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#S4.T3" title="Table 3 ‣ 4 Results and Discussion ‣ Longitudinal Segmentation of MS Lesions via Temporal Difference Weighting"><span class="ltx_text ltx_ref_tag">3</span></a>. It is worth noting that this dataset, while used for generalization testing, is too small to properly train longitudinal methods. Although slightly underperforming in the 95% Hausdorff distance, our Difference Weighting approach delivers the best performance in Dice score and lesion-based F<sub class="ltx_sub" id="S4.p5.1.2">1</sub> score outperforming nnUNet by 1.09% and 2.71% respectively. Surpassing FreeSurfer Samseg it thus demonstrates superior overall performance on the ISBI 2015 dataset which illustrates the effective translation of our findings across multiple MS datasets. This highlights the substantial potential of leveraging longitudinal data for improved disease monitoring and assessment.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T3.6.1.1" style="font-size:90%;">Table 3</span>: </span><span class="ltx_text ltx_font_bold" id="S4.T3.7.2" style="font-size:90%;">Generalizability to data from other sites.<span class="ltx_text ltx_font_medium" id="S4.T3.7.2.1"> Independent evaluation of models trained on the Ljubljana dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib19" title="">19</a>]</cite> and the non-deeplearning tool FreeSurfer<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib6" title="">6</a>]</cite> on the official ISBI 2015 challenge training dataset.</span></span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T3.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T3.3.3.4">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.1.1.1">DSC <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.1.1.1.m1.1"><semantics id="S4.T3.1.1.1.m1.1a"><mo id="S4.T3.1.1.1.m1.1.1" stretchy="false" xref="S4.T3.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.m1.1b"><ci id="S4.T3.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.1.1.1.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.2.2.2">HD95 <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.2.2.2.m1.1"><semantics id="S4.T3.2.2.2.m1.1a"><mo id="S4.T3.2.2.2.m1.1.1" stretchy="false" xref="S4.T3.2.2.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.2.2.2.m1.1b"><ci id="S4.T3.2.2.2.m1.1.1.cmml" xref="S4.T3.2.2.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.2.2.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.2.2.2.m1.1d">↓</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.3.3.3">F<sub class="ltx_sub" id="S4.T3.3.3.3.1">1</sub> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.3.3.3.m1.1"><semantics id="S4.T3.3.3.3.m1.1a"><mo id="S4.T3.3.3.3.m1.1.1" stretchy="false" xref="S4.T3.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.3.3.3.m1.1b"><ci id="S4.T3.3.3.3.m1.1.1.cmml" xref="S4.T3.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.3.3.3.m1.1d">↑</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.3.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.3.4.1.1">FreeSurfer Samseg (2023) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib6" title="">6</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.4.1.2">68.50</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.4.1.3">12.42</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.4.1.4">51.97</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.5.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.3.5.2.1">nnUNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib16" title="">16</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.3.5.2.2">69.74</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.5.2.3"><span class="ltx_text ltx_font_bold" id="S4.T3.3.5.2.3.1">9.95</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.5.2.4">59.74</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.6.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.3.6.3.1">Longitudinal nnUNet <span class="ltx_text ltx_font_italic" id="S4.T3.3.6.3.1.1">(Ours)</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.3.6.3.2">70.77</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.6.3.3">12.13</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.6.3.4">60.64</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.7.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T3.3.7.4.1">+ Diff. Weighting <span class="ltx_text ltx_font_italic" id="S4.T3.3.7.4.1.1">(Ours)</span>
</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.3.7.4.2"><span class="ltx_text ltx_font_bold" id="S4.T3.3.7.4.2.1">70.83</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.3.7.4.3">10.83</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.3.7.4.4"><span class="ltx_text ltx_font_bold" id="S4.T3.3.7.4.4.1">62.45</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this paper, we have presented a novel method for multiple sclerosis lesion segmentation explicitly incorporating temporal information using our Difference Weighting Block. This component fuses baseline and follow-up scan features, emphasizing changes for improved segmentation. Experimental results demonstrated our model’s superiority over state-of-the-art single timepoint baselines and existing longitudinal methods. Our findings emphasize that leveraging representational differences outperforms naive channel-wise concatenation, with improvements also transferring to unseen datasets. Further research will focus on utilizing this longitudinal approach in addressing additional diseases.</p>
</div>
<div class="ltx_para" id="S5.p2">
<span class="ltx_ERROR undefined" id="S5.p2.1">{credits}</span>
</div>
<section class="ltx_subsubsection" id="S5.SS0.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.0.1 </span>Acknowledgements</h4>
<div class="ltx_para" id="S5.SS0.SSS1.p1">
<p class="ltx_p" id="S5.SS0.SSS1.p1.1">The present contribution is supported by the Helmholtz Association under the joint research school ”HIDSS4Health – Helmholtz Information and Data Science School for Health”. This work was partly funded by Helmholtz Imaging (HI), a platform of the Helmholtz Incubator on Information and Data Science. PV is funded through an Else Kröner Clinician Scientist Endowed Professorship by the Else Kröner Fresenius Foundation (reference number: 2022_EKCS.17).</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS0.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.0.2 </span><span class="ltx_ERROR undefined" id="S5.SS0.SSS2.1.1">\discintname</span>
</h4>
<div class="ltx_para" id="S5.SS0.SSS2.p1">
<p class="ltx_p" id="S5.SS0.SSS2.p1.1">The authors have no competing interests to declare that are relevant to the content of this article.</p>
</div>
</section>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Alom, M.Z., Yakopcic, C., Hasan, M., Taha, T.M., Asari, V.K.: Recurrent residual u-net for medical image segmentation. Journal of Medical Imaging <span class="ltx_text ltx_font_bold" id="bib.bib1.1.1">6</span>(1), 014006–014006 (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Baumgartner, M., Jäger, P.F., Isensee, F., Maier-Hein, K.H.: nndetection: a self-configuring method for medical object detection. In: Medical Image Computing and Computer Assisted Intervention–MICCAI 2021: 24th International Conference, Strasbourg, France, September 27–October 1, 2021, Proceedings, Part V 24. pp. 530–539. Springer (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Birenbaum, A., Greenspan, H.: Multi-view longitudinal cnn for multiple sclerosis lesion segmentation. Engineering Applications of Artificial Intelligence <span class="ltx_text ltx_font_bold" id="bib.bib3.1.1">65</span>, 111–118 (2017)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Brugnara, G., Isensee, F., Neuberger, U., Bonekamp, D., Petersen, J., Diem, R., Wildemann, B., Heiland, S., Wick, W., Bendszus, M., et al.: Automated volumetric assessment with artificial neural networks might enable a more accurate assessment of disease burden in patients with multiple sclerosis. European radiology <span class="ltx_text ltx_font_bold" id="bib.bib4.1.1">30</span>, 2356–2364 (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Carass, A., Roy, S., Jog, A., Cuzzocreo, J.L., Magrath, E., Gherman, A., Button, J., Nguyen, J., Prados, F., Sudre, C.H., et al.: Longitudinal multiple sclerosis lesion segmentation: resource and challenge. NeuroImage <span class="ltx_text ltx_font_bold" id="bib.bib5.1.1">148</span>, 77–102 (2017)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Cerri, S., Greve, D.N., Hoopes, A., Lundell, H., Siebner, H.R., Mühlau, M., Van Leemput, K.: An open-source tool for longitudinal whole-brain and white matter lesion segmentation. NeuroImage: Clinical <span class="ltx_text ltx_font_bold" id="bib.bib6.1.1">38</span>, 103354 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Commowick, O., Cervenansky, F., Cotton, F., Dojat, M.: Msseg-2 challenge proceedings: Multiple sclerosis new lesions segmentation challenge using a data management and processing infrastructure. In: MICCAI 2021-24th International Conference on Medical Image Computing and Computer Assisted Intervention. p. 126 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Commowick, O., Istace, A., Kain, M., Laurent, B., Leray, F., Simon, M., Pop, S.C., Girard, P., Ameli, R., Ferré, J.C., et al.: Objective evaluation of multiple sclerosis lesion segmentation using a data management and processing infrastructure. Scientific reports <span class="ltx_text ltx_font_bold" id="bib.bib8.1.1">8</span>(1), 13650 (2018)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Danelakis, A., Theoharis, T., Verganelakis, D.A.: Survey of automated multiple sclerosis lesion segmentation techniques on magnetic resonance imaging. Computerized Medical Imaging and Graphics <span class="ltx_text ltx_font_bold" id="bib.bib9.1.1">70</span>, 83–100 (2018)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Denner, S., Khakzar, A., Sajid, M., Saleh, M., Spiclin, Z., Kim, S.T., Navab, N.: Spatio-temporal learning from longitudinal data for multiple sclerosis lesion segmentation. In: Brainlesion: Glioma, Multiple Sclerosis, Stroke and Traumatic Brain Injuries: 6th International Workshop, BrainLes 2020, Held in Conjunction with MICCAI 2020, Lima, Peru, October 4, 2020, Revised Selected Papers, Part I 6. pp. 111–121. Springer (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Diaz-Hurtado, M., Martínez-Heras, E., Solana, E., Casas-Roma, J., Llufriu, S., Kanber, B., Prados, F.: Recent advances in the longitudinal segmentation of multiple sclerosis lesions on magnetic resonance imaging: a review. Neuroradiology <span class="ltx_text ltx_font_bold" id="bib.bib11.1.1">64</span>(11), 2103–2117 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Filippi, M., Bar-Or, A., Piehl, F., Preziosa, P., Solari, A., Vukusic, S., Rocca, M.A.: Multiple sclerosis. Nature Reviews Disease Primers <span class="ltx_text ltx_font_bold" id="bib.bib12.1.1">4</span>(1),  43 (Nov 2018). https://doi.org/10.1038/s41572-018-0041-4

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Fischl, B.: Freesurfer. Neuroimage <span class="ltx_text ltx_font_bold" id="bib.bib13.1.1">62</span>(2), 774–781 (2012)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Galimzianova, A., Pernuš, F., Likar, B., Špiclin, Ž.: Stratified mixture modeling for segmentation of white-matter lesions in brain mr images. NeuroImage <span class="ltx_text ltx_font_bold" id="bib.bib14.1.1">124</span>, 1031–1043 (2016)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Hatamizadeh, A., Nath, V., Tang, Y., Yang, D., Roth, H.R., Xu, D.: Swin unetr: Swin transformers for semantic segmentation of brain tumors in mri images. In: International MICCAI Brainlesion Workshop. pp. 272–284. Springer (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Isensee, F., Jaeger, P.F., Kohl, S.A., Petersen, J., Maier-Hein, K.H.: nnu-net: a self-configuring method for deep learning-based biomedical image segmentation. Nature methods <span class="ltx_text ltx_font_bold" id="bib.bib16.1.1">18</span>(2), 203–211 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Jaeger, P.F., Kohl, S.A., Bickelhaupt, S., Isensee, F., Kuder, T.A., Schlemmer, H.P., Maier-Hein, K.H.: Retina u-net: Embarrassingly simple exploitation of segmentation supervision for medical object detection. In: Machine Learning for Health Workshop. pp. 171–183. PMLR (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Jenkinson, M., Bannister, P., Brady, M., Smith, S.: Improved optimization for the robust and accurate linear registration and motion correction of brain images. Neuroimage <span class="ltx_text ltx_font_bold" id="bib.bib18.1.1">17</span>(2), 825–841 (2002)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Lesjak, Ž., Galimzianova, A., Koren, A., Lukin, M., Pernuš, F., Likar, B., Špiclin, Ž.: A novel public mr image dataset of multiple sclerosis patients with lesion segmentations based on multi-rater consensus. Neuroinformatics <span class="ltx_text ltx_font_bold" id="bib.bib19.1.1">16</span>, 51–63 (2018)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Maier-Hein, L., Reinke, A., Godau, P., Tizabi, M.D., Buettner, F., Christodoulou, E., Glocker, B., Isensee, F., Kleesiek, J., Kozubek, M., et al.: Metrics reloaded: recommendations for image analysis validation. Nature methods pp. 1–18 (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Montalban, X., Gold, R., Thompson, A.J., Otero-Romero, S., Amato, M.P., Chandraratna, D., Clanet, M., Comi, G., Derfuss, T., Fazekas, F., et al.: Ectrims/ean guideline on the pharmacological treatment of people with multiple sclerosis. Multiple Sclerosis Journal <span class="ltx_text ltx_font_bold" id="bib.bib21.1.1">24</span>(2), 96–120 (2018)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Rakić, M., Vercruyssen, S., Van Eyndhoven, S., de la Rosa, E., Jain, S., Van Huffel, S., Maes, F., Smeets, D., Sima, D.M.: Icobrain ms 5.1: Combining unsupervised and supervised approaches for improving the detection of multiple sclerosis lesions. NeuroImage: Clinical <span class="ltx_text ltx_font_bold" id="bib.bib22.1.1">31</span>, 102707 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Stangel, M., Penner, I.K., Kallmann, B.A., Lukas, C., Kieseier, B.C.: Towards the implementation of ‘no evidence of disease activity’in multiple sclerosis treatment: the multiple sclerosis decision model. Therapeutic advances in neurological disorders <span class="ltx_text ltx_font_bold" id="bib.bib23.1.1">8</span>(1), 3–13 (2015)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Szeskin, A., Rochman, S., Weiss, S., Lederman, R., Sosna, J., Joskowicz, L.: Liver lesion changes analysis in longitudinal cect scans by simultaneous deep learning voxel classification with simu-net. Medical Image Analysis <span class="ltx_text ltx_font_bold" id="bib.bib24.1.1">83</span>, 102675 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Wu, Y., Wu, Z., Shi, H., Picker, B., Chong, W., Cai, J.: Coactseg: Learning from heterogeneous data for new multiple sclerosis lesion segmentation. In: International conference on medical image computing and computer-assisted intervention. pp. 3–13. Springer (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Zeng, C., Gu, L., Liu, Z., Zhao, S.: Review of deep learning approaches for the segmentation of multiple sclerosis lesions on brain mri. Frontiers in Neuroinformatics <span class="ltx_text ltx_font_bold" id="bib.bib26.1.1">14</span>, 610967 (2020)

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="Pt0.A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix 0.A </span>Statistical Analysis</h2>
<figure class="ltx_figure" id="Pt0.A1.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="Pt0.A1.F3.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="415" id="Pt0.A1.F3.1.g1" src="x2.png" width="830"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="Pt0.A1.F3.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="415" id="Pt0.A1.F3.2.g1" src="x3.png" width="830"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Pt0.A1.F3.9.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="Pt0.A1.F3.10.2" style="font-size:90%;">Distribution of Dice and lesion-based F<sub class="ltx_sub" id="Pt0.A1.F3.10.2.1">1</sub> scores on the Ljubljana test set. The longitudinal baselines are depicted in <span class="ltx_text ltx_font_italic" id="Pt0.A1.F3.10.2.2">blue</span>, nnUNet as the best single timepoint baseline in <span class="ltx_text ltx_font_italic" id="Pt0.A1.F3.10.2.3">orange</span>, and our proposed Difference Weighting approach in <span class="ltx_text ltx_font_italic" id="Pt0.A1.F3.10.2.4">green</span>. The figure depicts the superiority of our proposed method in terms of both the mean and the distribution, particularly evident in the F<sub class="ltx_sub" id="Pt0.A1.F3.10.2.5">1</sub> score. The narrower tails of the distribution indicate more precise segmentations, especially for challenging cases.</span></figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_appendix" id="Pt0.A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix 0.B </span>Results without Size Filtering</h2>
<figure class="ltx_table" id="Pt0.A2.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="Pt0.A2.T4.8.2.1" style="font-size:90%;">Table 4</span>: </span><span class="ltx_text" id="Pt0.A2.T4.2.1" style="font-size:90%;">Comparison of state-of-the-art single timepoint and longitudinal methods for MS lesion segmentation on the Ljubljana test set <span class="ltx_text ltx_font_italic" id="Pt0.A2.T4.2.1.1">without</span> size threshold filtering of lesions smaller than <math alttext="3~{}\mathrm{mm}^{3}" class="ltx_Math" display="inline" id="Pt0.A2.T4.2.1.m1.1"><semantics id="Pt0.A2.T4.2.1.m1.1b"><mrow id="Pt0.A2.T4.2.1.m1.1.1" xref="Pt0.A2.T4.2.1.m1.1.1.cmml"><mn id="Pt0.A2.T4.2.1.m1.1.1.2" xref="Pt0.A2.T4.2.1.m1.1.1.2.cmml">3</mn><mo id="Pt0.A2.T4.2.1.m1.1.1.1" lspace="0.300em" xref="Pt0.A2.T4.2.1.m1.1.1.1.cmml">⁢</mo><msup id="Pt0.A2.T4.2.1.m1.1.1.3" xref="Pt0.A2.T4.2.1.m1.1.1.3.cmml"><mi id="Pt0.A2.T4.2.1.m1.1.1.3.2" xref="Pt0.A2.T4.2.1.m1.1.1.3.2.cmml">mm</mi><mn id="Pt0.A2.T4.2.1.m1.1.1.3.3" xref="Pt0.A2.T4.2.1.m1.1.1.3.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A2.T4.2.1.m1.1c"><apply id="Pt0.A2.T4.2.1.m1.1.1.cmml" xref="Pt0.A2.T4.2.1.m1.1.1"><times id="Pt0.A2.T4.2.1.m1.1.1.1.cmml" xref="Pt0.A2.T4.2.1.m1.1.1.1"></times><cn id="Pt0.A2.T4.2.1.m1.1.1.2.cmml" type="integer" xref="Pt0.A2.T4.2.1.m1.1.1.2">3</cn><apply id="Pt0.A2.T4.2.1.m1.1.1.3.cmml" xref="Pt0.A2.T4.2.1.m1.1.1.3"><csymbol cd="ambiguous" id="Pt0.A2.T4.2.1.m1.1.1.3.1.cmml" xref="Pt0.A2.T4.2.1.m1.1.1.3">superscript</csymbol><ci id="Pt0.A2.T4.2.1.m1.1.1.3.2.cmml" xref="Pt0.A2.T4.2.1.m1.1.1.3.2">mm</ci><cn id="Pt0.A2.T4.2.1.m1.1.1.3.3.cmml" type="integer" xref="Pt0.A2.T4.2.1.m1.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A2.T4.2.1.m1.1d">3~{}\mathrm{mm}^{3}</annotation><annotation encoding="application/x-llamapun" id="Pt0.A2.T4.2.1.m1.1e">3 roman_mm start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math>.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="Pt0.A2.T4.5">
<thead class="ltx_thead">
<tr class="ltx_tr" id="Pt0.A2.T4.5.3">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="Pt0.A2.T4.5.3.4"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="Pt0.A2.T4.5.3.5">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="Pt0.A2.T4.3.1.1">DSC <math alttext="\uparrow" class="ltx_Math" display="inline" id="Pt0.A2.T4.3.1.1.m1.1"><semantics id="Pt0.A2.T4.3.1.1.m1.1a"><mo id="Pt0.A2.T4.3.1.1.m1.1.1" stretchy="false" xref="Pt0.A2.T4.3.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="Pt0.A2.T4.3.1.1.m1.1b"><ci id="Pt0.A2.T4.3.1.1.m1.1.1.cmml" xref="Pt0.A2.T4.3.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A2.T4.3.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="Pt0.A2.T4.3.1.1.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="Pt0.A2.T4.4.2.2">HD95 <math alttext="\downarrow" class="ltx_Math" display="inline" id="Pt0.A2.T4.4.2.2.m1.1"><semantics id="Pt0.A2.T4.4.2.2.m1.1a"><mo id="Pt0.A2.T4.4.2.2.m1.1.1" stretchy="false" xref="Pt0.A2.T4.4.2.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="Pt0.A2.T4.4.2.2.m1.1b"><ci id="Pt0.A2.T4.4.2.2.m1.1.1.cmml" xref="Pt0.A2.T4.4.2.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A2.T4.4.2.2.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="Pt0.A2.T4.4.2.2.m1.1d">↓</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="Pt0.A2.T4.5.3.3">F<sub class="ltx_sub" id="Pt0.A2.T4.5.3.3.1">1</sub> <math alttext="\uparrow" class="ltx_Math" display="inline" id="Pt0.A2.T4.5.3.3.m1.1"><semantics id="Pt0.A2.T4.5.3.3.m1.1a"><mo id="Pt0.A2.T4.5.3.3.m1.1.1" stretchy="false" xref="Pt0.A2.T4.5.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="Pt0.A2.T4.5.3.3.m1.1b"><ci id="Pt0.A2.T4.5.3.3.m1.1.1.cmml" xref="Pt0.A2.T4.5.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A2.T4.5.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="Pt0.A2.T4.5.3.3.m1.1d">↑</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="Pt0.A2.T4.5.4.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="Pt0.A2.T4.5.4.1.1" rowspan="2"><span class="ltx_text" id="Pt0.A2.T4.5.4.1.1.1">
<span class="ltx_inline-block" id="Pt0.A2.T4.5.4.1.1.1.1">
<span class="ltx_p" id="Pt0.A2.T4.5.4.1.1.1.1.1">Single</span>
<span class="ltx_p" id="Pt0.A2.T4.5.4.1.1.1.1.2">Timepoint</span>
</span></span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="Pt0.A2.T4.5.4.1.2">nnUNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib16" title="">16</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="Pt0.A2.T4.5.4.1.3">74.04</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Pt0.A2.T4.5.4.1.4">4.68</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Pt0.A2.T4.5.4.1.5">67.63</td>
</tr>
<tr class="ltx_tr" id="Pt0.A2.T4.5.5.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="Pt0.A2.T4.5.5.2.1">SwinUNETR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib15" title="">15</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="Pt0.A2.T4.5.5.2.2">73.86</td>
<td class="ltx_td ltx_align_center" id="Pt0.A2.T4.5.5.2.3">4.55</td>
<td class="ltx_td ltx_align_center" id="Pt0.A2.T4.5.5.2.4">66.41</td>
</tr>
<tr class="ltx_tr" id="Pt0.A2.T4.5.6.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="Pt0.A2.T4.5.6.3.1" rowspan="6"><span class="ltx_text" id="Pt0.A2.T4.5.6.3.1.1">
<span class="ltx_inline-block" id="Pt0.A2.T4.5.6.3.1.1.1">
<span class="ltx_p" id="Pt0.A2.T4.5.6.3.1.1.1.1">Longi-</span>
<span class="ltx_p" id="Pt0.A2.T4.5.6.3.1.1.1.2">tudinal</span>
</span></span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="Pt0.A2.T4.5.6.3.2">FreeSurfer Samseg (2023) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib6" title="">6</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="Pt0.A2.T4.5.6.3.3">45.57</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Pt0.A2.T4.5.6.3.4">15.61</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Pt0.A2.T4.5.6.3.5">27.39</td>
</tr>
<tr class="ltx_tr" id="Pt0.A2.T4.5.7.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="Pt0.A2.T4.5.7.4.1">Denner et.al. (2020) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib10" title="">10</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="Pt0.A2.T4.5.7.4.2">69.40</td>
<td class="ltx_td ltx_align_center" id="Pt0.A2.T4.5.7.4.3">4.57</td>
<td class="ltx_td ltx_align_center" id="Pt0.A2.T4.5.7.4.4">59.16</td>
</tr>
<tr class="ltx_tr" id="Pt0.A2.T4.5.8.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="Pt0.A2.T4.5.8.5.1">Szeskin et.al. (2022) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib24" title="">24</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="Pt0.A2.T4.5.8.5.2">73.24</td>
<td class="ltx_td ltx_align_center" id="Pt0.A2.T4.5.8.5.3">4.77</td>
<td class="ltx_td ltx_align_center" id="Pt0.A2.T4.5.8.5.4">65.46</td>
</tr>
<tr class="ltx_tr" id="Pt0.A2.T4.5.9.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="Pt0.A2.T4.5.9.6.1">Wu et.al. (2023) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13416v1#bib.bib25" title="">25</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="Pt0.A2.T4.5.9.6.2">72.34</td>
<td class="ltx_td ltx_align_center" id="Pt0.A2.T4.5.9.6.3">6.32</td>
<td class="ltx_td ltx_align_center" id="Pt0.A2.T4.5.9.6.4">59.64</td>
</tr>
<tr class="ltx_tr" id="Pt0.A2.T4.5.10.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="Pt0.A2.T4.5.10.7.1">Longitudinal nnUNet <span class="ltx_text ltx_font_italic" id="Pt0.A2.T4.5.10.7.1.1">(Ours)</span>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="Pt0.A2.T4.5.10.7.2">75.13</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Pt0.A2.T4.5.10.7.3"><span class="ltx_text ltx_font_bold" id="Pt0.A2.T4.5.10.7.3.1">4.19</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Pt0.A2.T4.5.10.7.4">68.38</td>
</tr>
<tr class="ltx_tr" id="Pt0.A2.T4.5.11.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="Pt0.A2.T4.5.11.8.1">+ Diff. Weighting <span class="ltx_text ltx_font_italic" id="Pt0.A2.T4.5.11.8.1.1">(Ours)</span>
</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="Pt0.A2.T4.5.11.8.2"><span class="ltx_text ltx_font_bold" id="Pt0.A2.T4.5.11.8.2.1">75.41</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="Pt0.A2.T4.5.11.8.3">4.29</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="Pt0.A2.T4.5.11.8.4"><span class="ltx_text ltx_font_bold" id="Pt0.A2.T4.5.11.8.4.1">69.71</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Sep 20 11:23:25 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
