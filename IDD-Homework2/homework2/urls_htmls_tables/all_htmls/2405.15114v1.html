<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning</title>
<!--Generated on Fri May 24 13:42:28 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Recommender system,  Large language models,  Tool learning" lang="en" name="keywords"/>
<base href="/html/2405.15114v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S1" title="In Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S2" title="In Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S2.SS1" title="In 2. Related Work ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>LLMs with Tool Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S2.SS2" title="In 2. Related Work ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>LLMs for Recommendation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S3" title="In Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S3.SS1" title="In 3. Methodology ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Problem Formulation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S3.SS2" title="In 3. Methodology ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>User Decision Simulation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S3.SS3" title="In 3. Methodology ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Attribute-oriented Tools</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S3.SS3.SSS1" title="In 3.3. Attribute-oriented Tools ‣ 3. Methodology ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.1 </span>Rank tools</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S3.SS3.SSS2" title="In 3.3. Attribute-oriented Tools ‣ 3. Methodology ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.2 </span>Retrieval tools</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S3.SS4" title="In 3. Methodology ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Memory Strategy</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S4" title="In Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S4.SS1" title="In 4. Experiments ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Experimental Settings</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S4.SS1.SSS1" title="In 4.1. Experimental Settings ‣ 4. Experiments ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.1 </span>Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S4.SS1.SSS2" title="In 4.1. Experimental Settings ‣ 4. Experiments ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.2 </span>Evaluation protocols</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S4.SS1.SSS3" title="In 4.1. Experimental Settings ‣ 4. Experiments ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.3 </span>Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S4.SS1.SSS4" title="In 4.1. Experimental Settings ‣ 4. Experiments ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.4 </span>Implementation details</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S4.SS2" title="In 4. Experiments ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Performance Comparison (RQ1)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S4.SS3" title="In 4. Experiments ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Decomposing ToolRec  (RQ2)</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S4.SS3.SSS1" title="In 4.3. Decomposing ToolRec (RQ2) ‣ 4. Experiments ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.1 </span>Effectiveness of user decision simulation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S4.SS3.SSS2" title="In 4.3. Decomposing ToolRec (RQ2) ‣ 4. Experiments ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.2 </span>Analysis of round termination in ToolRec</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S4.SS3.SSS3" title="In 4.3. Decomposing ToolRec (RQ2) ‣ 4. Experiments ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.3 </span>Efficiency and scalability of attribute-oriented retrieval tools</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S4.SS4" title="In 4. Experiments ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Surprises and Limitations (RQ3)</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S4.SS4.SSS1" title="In 4.4. Surprises and Limitations (RQ3) ‣ 4. Experiments ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4.1 </span>Unanticipated outcomes: Beyond conventional failures</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S4.SS4.SSS2" title="In 4.4. Surprises and Limitations (RQ3) ‣ 4. Experiments ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4.2 </span>Influence of LLM selection on recommendation performance</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S5" title="In Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yuyue Zhao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0000-0002-5298-0309" title="ORCID identifier">0000-0002-5298-0309</a></span>
<span class="ltx_contact ltx_role_email"><a href="mailto:yyzha0@mail.ustc.edu.cn">yyzha0@mail.ustc.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">University of Science and Technology of China</span><span class="ltx_text ltx_affiliation_institution" id="id2.2.id2">University of Amsterdam</span><span class="ltx_text ltx_affiliation_city" id="id3.3.id3">Hefei</span><span class="ltx_text ltx_affiliation_state" id="id4.4.id4">Anhui</span><span class="ltx_text ltx_affiliation_country" id="id5.5.id5">China</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jiancan Wu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0000-0002-6941-5218" title="ORCID identifier">0000-0002-6941-5218</a></span>
<span class="ltx_contact ltx_role_email"><a href="mailto:wujcan@gmail.com">wujcan@gmail.com</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id6.1.id1">University of Science and Technology of China</span><span class="ltx_text ltx_affiliation_city" id="id7.2.id2">Hefei</span><span class="ltx_text ltx_affiliation_state" id="id8.3.id3">Anhui</span><span class="ltx_text ltx_affiliation_country" id="id9.4.id4">China</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xiang Wang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0000-0002-6148-6329" title="ORCID identifier">0000-0002-6148-6329</a></span>
<span class="ltx_contact ltx_role_email"><a href="mailto:xiangwang1223@gmail.com">xiangwang1223@gmail.com</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id10.1.id1">University of Science and Technology of China</span><span class="ltx_text ltx_affiliation_city" id="id11.2.id2">Hefei</span><span class="ltx_text ltx_affiliation_state" id="id12.3.id3">Anhui</span><span class="ltx_text ltx_affiliation_country" id="id13.4.id4">China</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Wei Tang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0000-0001-6561-7026" title="ORCID identifier">0000-0001-6561-7026</a></span>
<span class="ltx_contact ltx_role_email"><a href="mailto:weitang@mail.ustc.edu.cn">weitang@mail.ustc.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id14.1.id1">University of Science and Technology of China</span><span class="ltx_text ltx_affiliation_city" id="id15.2.id2">Hefei</span><span class="ltx_text ltx_affiliation_state" id="id16.3.id3">Anhui</span><span class="ltx_text ltx_affiliation_country" id="id17.4.id4">China</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Dingxian Wang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0000-0002-6880-7869" title="ORCID identifier">0000-0002-6880-7869</a></span>
<span class="ltx_contact ltx_role_email"><a href="mailto:dingxian.wang@student.uts.edu.au">dingxian.wang@student.uts.edu.au</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id18.1.id1">University of Technology Sydney</span><span class="ltx_text ltx_affiliation_city" id="id19.2.id2">Ultimo</span><span class="ltx_text ltx_affiliation_state" id="id20.3.id3">New South Wales</span><span class="ltx_text ltx_affiliation_country" id="id21.4.id4">Australia</span>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Maarten de Rijke
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0000-0002-1086-0202" title="ORCID identifier">0000-0002-1086-0202</a></span>
<span class="ltx_contact ltx_role_email"><a href="mailto:m.derijke@uva.nl">m.derijke@uva.nl</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id22.1.id1">University of Amsterdam</span><span class="ltx_text ltx_affiliation_city" id="id23.2.id2">Amsterdam</span><span class="ltx_text ltx_affiliation_country" id="id24.3.id3">The Netherlands</span>
</span></span></span>
</div>
<div class="ltx_dates">(2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id25.id1">Conventional recommender systems (RSs) face challenges in precisely capturing users’ fine-grained preferences.
Large language models (LLMs) have shown capabilities in commonsense reasoning and leveraging external tools that may help address these challenges. However, existing LLM-based RSs suffer from hallucinations, misalignment between the semantic space of items and the behavior space of users, or overly simplistic control strategies (e.g., whether to rank or directly present existing results). To bridge these gap, we introduce ToolRec, a framework for LLM-empowered recommendations via tool learning that uses LLMs as surrogate users, thereby guiding the recommendation process and invoking external tools to generate a recommendation list that aligns closely with users’ nuanced preferences.</p>
<p class="ltx_p" id="id26.id2">We formulate the recommendation process as a process aimed at exploring user interests in attribute granularity.
The process factors in the nuances of the context and user preferences.
The LLM then invokes external tools based on a user’s attribute instructions and probes different segments of the item pool.
We consider two types of attribute-oriented tools: rank tools and retrieval tools.
Through the integration of LLMs, ToolRec enables conventional recommender systems to become external tools with a natural language interface.
Extensive experiments verify the effectiveness of ToolRec, particularly in scenarios that are rich in semantic content.</p>
</div>
<div class="ltx_keywords">Recommender system, Large language models, Tool learning
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_submissionid" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">submissionid: </span>9455</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Proceedings of the 47th International ACM SIGIR Conference on Research and Development in Information Retrieval; July 14–18, 2024; Washington, DC, USA</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_booktitle" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>Proceedings of the 47th International ACM SIGIR Conference on Research and Development in Information Retrieval (SIGIR ’24), July 14–18, 2024, Washington, DC, USA</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/3626772.3657828</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>979-8-4007-0431-4/24/07</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id8"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Recommender systems</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Recommender systems (RSs) are typically designed to identify user preferences and subsequently suggest potential items of interest <cite class="ltx_cite ltx_citemacro_citep">(Rendle et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib35" title="">2009</a>; Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib23" title="">2018</a>; He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib16" title="">2020</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib44" title="">2019</a>; Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib48" title="">2021a</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib49" title="">2024</a>; Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib55" title="">2023c</a>; Gao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib10" title="">2024</a>)</cite>.
This strategy has two important limitations.
First, the capabilities of existing RSs to accurately capture a user’s true preferences are limited when relying solely on historical interaction data.
Second, conventional RSs are often “narrow experts,” lacking commonsense knowledge about users and items, which leads to a restricted scope of recommendations <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib15" title="">2020</a>)</cite>.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="731" id="S1.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>Illustrating how ToolRec works.
The LLM-based <span class="ltx_text ltx_font_italic" id="S1.F1.2.1">surrogate user</span> learns the real user’s preferences and decides to employ attribute-oriented tools to explore areas of items. This process leads to a broad view of items, which, in turn, leads to the successful retrieval of the target item. It is important to note that the areas representing different attribute-oriented items that are retrieved according to a specific attribute may contain overlapping elements.
</figcaption>
</figure>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Inspired by the commonsense reasoning and knowledge utilization capabilities of large language models (LLMs), there have been several attempts to integrate LLMs with RSs and mitigate their inherent limitations <cite class="ltx_cite ltx_citemacro_citep">(Lin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib27" title="">2023</a>; Zhu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib63" title="">2023b</a>; Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib50" title="">2023</a>)</cite>:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.1">LLMs as RSs</span>: Here, LLMs, whether initially trained or further fine-tuned using user-item interaction data, are adapted to serve as RSs <cite class="ltx_cite ltx_citemacro_citep">(Wang and Lim, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib42" title="">2023</a>; Mysore et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib28" title="">2023</a>; Xi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib51" title="">2023</a>)</cite> and directly generate candidate items in text. This approach easily suffers from the hallucination problem <cite class="ltx_cite ltx_citemacro_citep">(Bang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib3" title="">2023</a>)</cite>, especially given large item catalogue sizes and extensive item names <cite class="ltx_cite ltx_citemacro_citep">(Huang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib22" title="">2023</a>)</cite>.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.1">LLMs enhance RSs:</span> Here, RSs are enhanced with world knowledge and reasoning abilities of LLMs <cite class="ltx_cite ltx_citemacro_citep">(Wang and Lim, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib42" title="">2023</a>; Mysore et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib28" title="">2023</a>; Xi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib51" title="">2023</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib60" title="">2021</a>; Qiu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib33" title="">2021</a>; Liao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib26" title="">2024</a>)</cite>. This category limits LLMs to offering semantic information within a conventional recommendation paradigm, sometimes leading to inconsistencies between the semantic and behavior spaces.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i3.p1.1.1">LLMs control RSs:</span> Here, LLMs are used to monitor and control the recommendation pipeline.
Existing controllers either have simple control strategies <cite class="ltx_cite ltx_citemacro_citep">(Gao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib11" title="">2023</a>; Hou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib17" title="">2024</a>)</cite> or necessitate active user involvement <cite class="ltx_cite ltx_citemacro_citep">(Friedman et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib9" title="">2023</a>)</cite>. Their decisions are rarely human-like, which hinders their effectiveness in applications.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1"><span class="ltx_text ltx_font_bold" id="S1.p3.1.1">Tool learning for recommendations.</span>
Motivated by recent advancements in tool learning with foundation models <cite class="ltx_cite ltx_citemacro_citep">(e.g., Schick et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib36" title="">2023</a>; Yao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib56" title="">2023</a>; Shen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib37" title="">2023</a>)</cite>, we propose to use LLMs as a surrogate user to emulate her/his decision-making process along with the utilization of tools.
At the core of our proposal is the task of learning to adaptively select appropriate recommender tools and curate a user-centric item list that is aligned with the user’s preferences.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates a four-round example of how ToolRec works. The LLM starts the simulation by focusing on the movie genre and selects an initial set of 5 movies; satisfied with the genre of the returned movies, it then aims to complement the set based on the release_year, and retrieves 3 additional movies; subsequently, the LLM refines its focus towards the actors, leading to an adjustment of four movies in the list.
Such iterative refinements continue until the simulator deems the movie list satisfactory enough to include the item of interest, thus finishing the recommendation process.
Notice how the LLM directs the recommendation through multiple decision-making rounds with attribute signals, contrasting with conventional RSs.
By adopting this approach, we aim to move beyond relying solely on users’ historical interactions, resulting in a more tailored set of recommended items (cf. the red area on the right of Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Using LLM tool learning to simulate users’ decision-making processes presents distinct challenges.
The first challenge concerns the recommendation ability of LLMs.
Although LLMs are pretrained on extensive datasets <cite class="ltx_cite ltx_citemacro_citep">(Ouyang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib29" title="">2022</a>; Bai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib2" title="">2022</a>)</cite>, improving their ability to produce quality recommendations remains a challenge, particularly in domain-specific scenarios.
The second challenge is developing appropriate attribute-oriented tools.
Attribute-oriented tools should not only be capable of exploring facets of the item pool (e.g.,  genre, release year of movies) but also need to be effective in handling different attribute choices during decision simulation.
Lastly, leveraging LLMs to refine the set of candidate items in each round presents a significant challenge.
This step could ensure that the final results benefit from an LLM’s open-world knowledge and are not limited by a single “narrow expert.”</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1"><span class="ltx_text ltx_font_bold" id="S1.p5.1.1">A new proposal for tool learning for recommendations.</span>
To address the challenges listed above, we introduce ToolRec, for LLM-empowered recommendations via tool learning, which is aimed at aligning the emergent abilities of LLMs with the demands of recommender systems.
ToolRec comprises three key components:

<span class="ltx_inline-enumerate" id="S1.I2">
<span class="ltx_inline-item" id="S1.I2.i1"><span class="ltx_tag ltx_tag_inline-item">(i)</span> <span class="ltx_text" id="S1.I2.i1.1">A <span class="ltx_text ltx_font_bold" id="S1.I2.i1.1.1">user decision simulation module</span>: We use LLMs initialized with user behavior history, acting as a <span class="ltx_text ltx_font_italic" id="S1.I2.i1.1.2">surrogate user</span> to evaluate user preferences against the current scenario.
</span></span>
<span class="ltx_inline-item" id="S1.I2.i2"><span class="ltx_tag ltx_tag_inline-item">(ii)</span> <span class="ltx_text ltx_font_bold" id="S1.I2.i2.1">Attribute-oriented tools</span><span class="ltx_text" id="S1.I2.i2.2">: We develop two distinct sets of attribute-based tools: rank tools and retrieval tools. The ranking tools are operationalized by LLMs with attribute-oriented ranking instructions, while the retrieval tools are operationalized by merging a frozen backbone with additional fine-tuned attribute encoders. These tools are activated when the <span class="ltx_text ltx_font_italic" id="S1.I2.i2.2.1">surrogate user</span> identifies unsatisfactory attributes, and then fetches corresponding candidate items.
</span></span>
<span class="ltx_inline-item" id="S1.I2.i3"><span class="ltx_tag ltx_tag_inline-item">(iii)</span> <span class="ltx_text" id="S1.I2.i3.1">A <span class="ltx_text ltx_font_bold" id="S1.I2.i3.1.1">memory strategy</span>: This component checks the presence of intermediate results and stores them with associated tool marks, aiding the LLM in leveraging open-world knowledge to refine the final recommendation list.
</span></span>
</span>
The latter two components are governed by the <span class="ltx_text ltx_font_italic" id="S1.p5.1.2">surrogate user</span>’s decisions, and conclude the recommendation process once a satisfactory candidate item list has been found.
ToolRec’s iterative framework integrates LLMs into recommender systems while enhancing the quality of recommendations.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1"><span class="ltx_text ltx_font_bold" id="S1.p6.1.1">Contributions.</span>
Our main contributions are as follows:</p>
</div>
<div class="ltx_para" id="S1.p7">
<ul class="ltx_itemize" id="S1.I3">
<li class="ltx_item" id="S1.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I3.i1.p1">
<p class="ltx_p" id="S1.I3.i1.p1.1">We propose ToolRec, a framework that deploys LLMs to enhance recommendations via tool learning. It employs LLMs to closely emulate user preferences, thereby improving the accuracy of recommendations generated during user decision simulation.</p>
</div>
</li>
<li class="ltx_item" id="S1.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I3.i2.p1">
<p class="ltx_p" id="S1.I3.i2.p1.1">To better meet the surrogate user’s needs, we incorporate attribute-oriented tools and a memory strategy. Those components address the challenge of effective item retrieval based on identified attributes, ensuring the recommendations are well-aligned with user preferences.</p>
</div>
</li>
<li class="ltx_item" id="S1.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I3.i3.p1">
<p class="ltx_p" id="S1.I3.i3.p1.1">Experimental results on three real-world datasets demonstrate the effectiveness of ToolRec, especially in domains enriched by world knowledge.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">We review tool learning with LLMs and the use of LLMs for recommendation.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>LLMs with Tool Learning </h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">There is a growing trend to employ LLMs to construct autonomous agents to achieve decision-making capabilities <cite class="ltx_cite ltx_citemacro_citep">(Shen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib37" title="">2023</a>; Schick et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib36" title="">2023</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib5" title="">2019</a>; Qin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib32" title="">2023b</a>; Zhu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib62" title="">2023a</a>)</cite>.
These LLM-based agents often fall short in domains that demand extensive expert knowledge and suffer from hallucination issues <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib43" title="">2024</a>)</cite>.
To alleviate these problems, these agents are enhanced with the ability to invoke external tools for action execution. Previous external tools can be grouped into three types: APIs <cite class="ltx_cite ltx_citemacro_citep">(Shen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib37" title="">2023</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib25" title="">2023</a>; Qin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib32" title="">2023b</a>; Schick et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib36" title="">2023</a>; Qin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib31" title="">2023a</a>)</cite>, Databases &amp; Knowledge Bases <cite class="ltx_cite ltx_citemacro_citep">(Karpas et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib24" title="">2022</a>; Hu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib18" title="">2023</a>; Ge et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib12" title="">2023</a>)</cite>, and External Models <cite class="ltx_cite ltx_citemacro_citep">(Zhong et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib61" title="">2024</a>; Surís et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib39" title="">2023</a>; Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib53" title="">2023a</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">The use of APIs as tools has become a popular approach.
E.g., HuggingGPT <cite class="ltx_cite ltx_citemacro_citep">(Shen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib37" title="">2023</a>)</cite> employs models on HuggingFace to accomplish complex user tasks.
API-Bank <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib25" title="">2023</a>)</cite> serves as an LLM-based API recommendation agent, and autonomously searches and generates suitable API calls across various programming languages and domains. ToolBench <cite class="ltx_cite ltx_citemacro_citep">(Qin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib31" title="">2023a</a>)</cite> is an LLM-based tool generation system that creates various tools based on natural language requirements.
Connecting LLMs to external databases or knowledge bases enables access to domain-specific information, thus generating more realistic actions. E.g., ChatDB <cite class="ltx_cite ltx_citemacro_citep">(Hu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib18" title="">2023</a>)</cite> uses SQL statements to query databases, enabling logical action execution by agents.
Similarly, in the recommendation scenario, RecMind <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib45" title="">2023</a>)</cite> and InteRecAgent <cite class="ltx_cite ltx_citemacro_citep">(Huang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib22" title="">2023</a>)</cite> engage various expert systems such as MySQL and planners to retrieve detailed item information.
Employing external models can expand the range of feasible actions.
E.g., MemoryBank <cite class="ltx_cite ltx_citemacro_citep">(Zhong et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib61" title="">2024</a>)</cite> employs two language models to enhance text retrieval capabilities: one for encoding input text and the other for matching query statements. MM-REACT <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib53" title="">2023a</a>)</cite> integrates various vision models to improve its performance in visual understanding tasks.</p>
</div>
<div class="ltx_para" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.1">Our attribute-oriented rank tools can be summarized into APIs, while retrieval tools can be summarized into external models. This approach helps our surrogate user to explore different interest areas and return a better user preference-aligned item set.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>LLMs for Recommendation </h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Methods using LLMs in RSs come in three groups, based on the role of the LLMs: LLMs as RSs <cite class="ltx_cite ltx_citemacro_citep">(Geng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib13" title="">2022</a>; Hua et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib20" title="">2024</a>; Geng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib14" title="">2023</a>; Bao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib4" title="">2023</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib59" title="">2023b</a>; Xu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib52" title="">2023</a>; Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib54" title="">2023b</a>)</cite>, LLMs as assistants <cite class="ltx_cite ltx_citemacro_citep">(Wang and Lim, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib42" title="">2023</a>; Mysore et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib28" title="">2023</a>; Xi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib51" title="">2023</a>)</cite>, and LLMs as pipeline controllers <cite class="ltx_cite ltx_citemacro_citep">(Gao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib11" title="">2023</a>; Friedman et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib9" title="">2023</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib45" title="">2023</a>; Huang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib22" title="">2023</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">LLMs as RSs involve using LLMs to generate candidate items. For instance, P5 <cite class="ltx_cite ltx_citemacro_citep">(Geng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib13" title="">2022</a>)</cite> is fine-tuned on T5 <cite class="ltx_cite ltx_citemacro_citep">(Raffel et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib34" title="">2020</a>)</cite> with a collection of personalized prompts to achieve zero-shot generalization. Following this, UP5 <cite class="ltx_cite ltx_citemacro_citep">(Hua et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib20" title="">2024</a>)</cite> and VIP5 <cite class="ltx_cite ltx_citemacro_citep">(Geng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib14" title="">2023</a>)</cite> extend the paradigm to fairness and multimodal tasks, respectively. InstructRec <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib59" title="">2023b</a>)</cite> views recommendation as an instruction following task for LLMs, tuning T5 with user-specific instructions. TALLRec <cite class="ltx_cite ltx_citemacro_citep">(Bao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib4" title="">2023</a>)</cite> trains LLaMA <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib40" title="">2023a</a>)</cite> with LoRA <cite class="ltx_cite ltx_citemacro_citep">(Hu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib19" title="">2022</a>)</cite> to follow instructions and respond to a binary query provided within the contextual information. LLaRA <cite class="ltx_cite ltx_citemacro_citep">(Liao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib26" title="">2024</a>)</cite> utilizes hybrid prompting to bridge the modality gap between traditional recommendation systems and LLMs.</p>
</div>
<div class="ltx_para" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.1">When LLMs serve as Assistants, LLMs are leveraged for their factual knowledge or reasoning capabilities to generate or encode auxiliary textual features, assisting conventional RSs with semantic information. For example, Various studies use auxiliary textual features from BERT <cite class="ltx_cite ltx_citemacro_citep">(Devlin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib8" title="">2019</a>)</cite> for document ranking <cite class="ltx_cite ltx_citemacro_citep">(Zou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib64" title="">2021</a>)</cite>, while others aim to leverage these features for news recommendation <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib60" title="">2021</a>; Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib47" title="">2021b</a>; Qiu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib33" title="">2021</a>)</cite>. KAR <cite class="ltx_cite ltx_citemacro_citep">(Xi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib51" title="">2023</a>)</cite> extracts reasoning and factual knowledge from LLMs to serve as augmented features, enhancing recommendation models in a model-agnostic manner.</p>
</div>
<div class="ltx_para" id="S2.SS2.p4">
<p class="ltx_p" id="S2.SS2.p4.1">In the setting where LLMs act as Pipeline Controllers, models such as Chat-REC <cite class="ltx_cite ltx_citemacro_citep">(Gao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib11" title="">2023</a>)</cite> use ChatGPT to understand user preferences, decide whether to use the backend recommender system, and refine the suggested items before showing them to the user. RecLLM <cite class="ltx_cite ltx_citemacro_citep">(Friedman et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib9" title="">2023</a>)</cite> and InteRecAgent <cite class="ltx_cite ltx_citemacro_citep">(Huang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib22" title="">2023</a>)</cite> propose frameworks for integrated conversational recommender systems with LLMs managing dialogues, understanding user preferences. InteRecAgent further determines the usage of various tools (i.e., information query tools, retrieval tools, and rank tools) to support the candidate items. RecMind <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib45" title="">2023</a>)</cite>, inspired by P5’s various-task experiment setup, manages tool usage through a Self-Inspiring mechanism. Agent4Rec <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib57" title="">2024</a>)</cite> simulates and infers user-personalized preferences and behavior patterns using a LLM-based movie recommendation simulator.</p>
</div>
<div class="ltx_para" id="S2.SS2.p5">
<p class="ltx_p" id="S2.SS2.p5.1">While these pipeline controller efforts address challenges similar to ours, there are several aspects that make our approach different from theirs. First, we focus on the sequential recommendation task and top-N recommendation setting. Second, we introduce attribute-oriented tools designed specifically for the recommendation exploration journey. Lastly, we propose a proactive analysis of preference mismatches by using an LLM as a surrogate user.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Methodology</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">We propose ToolRec, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S3.F2" title="Figure 2 ‣ 3. Methodology ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_tag">2</span></a>.
We first formalize the recommendation process as a process exploring users’ interests.
Then, we introduce a general framework that adapts LLMs as surrogate users to enhance the recommendation mechanism through attribute-oriented tools.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="133" id="S3.F2.g1" src="x2.png" width="373"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>An overview of the proposed LLM-based recommendation method via tool learning.
</figcaption>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Problem Formulation</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.8">In the context of sequential recommendation, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_tag">1</span></a>, given user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_u</annotation></semantics></math> with a historical interaction sequence <math alttext="\mathcal{H}=\{i^{1},i^{2},\ldots,i^{n-1}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.4"><semantics id="S3.SS1.p1.2.m2.4a"><mrow id="S3.SS1.p1.2.m2.4.4" xref="S3.SS1.p1.2.m2.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.4.4.5" xref="S3.SS1.p1.2.m2.4.4.5.cmml">ℋ</mi><mo id="S3.SS1.p1.2.m2.4.4.4" xref="S3.SS1.p1.2.m2.4.4.4.cmml">=</mo><mrow id="S3.SS1.p1.2.m2.4.4.3.3" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml"><mo id="S3.SS1.p1.2.m2.4.4.3.3.4" stretchy="false" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml">{</mo><msup id="S3.SS1.p1.2.m2.2.2.1.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.2.m2.2.2.1.1.1.2" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2.cmml">i</mi><mn id="S3.SS1.p1.2.m2.2.2.1.1.1.3" xref="S3.SS1.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msup><mo id="S3.SS1.p1.2.m2.4.4.3.3.5" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><msup id="S3.SS1.p1.2.m2.3.3.2.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.2.m2.3.3.2.2.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2.cmml">i</mi><mn id="S3.SS1.p1.2.m2.3.3.2.2.2.3" xref="S3.SS1.p1.2.m2.3.3.2.2.2.3.cmml">2</mn></msup><mo id="S3.SS1.p1.2.m2.4.4.3.3.6" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><mi id="S3.SS1.p1.2.m2.1.1" mathvariant="normal" xref="S3.SS1.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS1.p1.2.m2.4.4.3.3.7" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><msup id="S3.SS1.p1.2.m2.4.4.3.3.3" xref="S3.SS1.p1.2.m2.4.4.3.3.3.cmml"><mi id="S3.SS1.p1.2.m2.4.4.3.3.3.2" xref="S3.SS1.p1.2.m2.4.4.3.3.3.2.cmml">i</mi><mrow id="S3.SS1.p1.2.m2.4.4.3.3.3.3" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.cmml"><mi id="S3.SS1.p1.2.m2.4.4.3.3.3.3.2" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.2.cmml">n</mi><mo id="S3.SS1.p1.2.m2.4.4.3.3.3.3.1" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.1.cmml">−</mo><mn id="S3.SS1.p1.2.m2.4.4.3.3.3.3.3" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.3.cmml">1</mn></mrow></msup><mo id="S3.SS1.p1.2.m2.4.4.3.3.8" stretchy="false" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.4b"><apply id="S3.SS1.p1.2.m2.4.4.cmml" xref="S3.SS1.p1.2.m2.4.4"><eq id="S3.SS1.p1.2.m2.4.4.4.cmml" xref="S3.SS1.p1.2.m2.4.4.4"></eq><ci id="S3.SS1.p1.2.m2.4.4.5.cmml" xref="S3.SS1.p1.2.m2.4.4.5">ℋ</ci><set id="S3.SS1.p1.2.m2.4.4.3.4.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3"><apply id="S3.SS1.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1">superscript</csymbol><ci id="S3.SS1.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2">𝑖</ci><cn id="S3.SS1.p1.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2">superscript</csymbol><ci id="S3.SS1.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2">𝑖</ci><cn id="S3.SS1.p1.2.m2.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">…</ci><apply id="S3.SS1.p1.2.m2.4.4.3.3.3.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3">superscript</csymbol><ci id="S3.SS1.p1.2.m2.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3.2">𝑖</ci><apply id="S3.SS1.p1.2.m2.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3"><minus id="S3.SS1.p1.2.m2.4.4.3.3.3.3.1.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.1"></minus><ci id="S3.SS1.p1.2.m2.4.4.3.3.3.3.2.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.2">𝑛</ci><cn id="S3.SS1.p1.2.m2.4.4.3.3.3.3.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.3">1</cn></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.4c">\mathcal{H}=\{i^{1},i^{2},\ldots,i^{n-1}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.4d">caligraphic_H = { italic_i start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_i start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , … , italic_i start_POSTSUPERSCRIPT italic_n - 1 end_POSTSUPERSCRIPT }</annotation></semantics></math>, the goal is to predict the next item of interest <math alttext="i^{n}\in\mathcal{I}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><msup id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2.2" xref="S3.SS1.p1.3.m3.1.1.2.2.cmml">i</mi><mi id="S3.SS1.p1.3.m3.1.1.2.3" xref="S3.SS1.p1.3.m3.1.1.2.3.cmml">n</mi></msup><mo id="S3.SS1.p1.3.m3.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">ℐ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><in id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1"></in><apply id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.2">superscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2.2">𝑖</ci><ci id="S3.SS1.p1.3.m3.1.1.2.3.cmml" xref="S3.SS1.p1.3.m3.1.1.2.3">𝑛</ci></apply><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">ℐ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">i^{n}\in\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_i start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ∈ caligraphic_I</annotation></semantics></math>, where <math alttext="\mathcal{I}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">caligraphic_I</annotation></semantics></math> is the complete item pool. Conventional RSs retrieve a subset <math alttext="\mathcal{I}_{c}\subseteq\mathcal{I}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mrow id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><msub id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.1.1.2.2" xref="S3.SS1.p1.5.m5.1.1.2.2.cmml">ℐ</mi><mi id="S3.SS1.p1.5.m5.1.1.2.3" xref="S3.SS1.p1.5.m5.1.1.2.3.cmml">c</mi></msub><mo id="S3.SS1.p1.5.m5.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.cmml">⊆</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml">ℐ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><subset id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1"></subset><apply id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.2.1.cmml" xref="S3.SS1.p1.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2.2">ℐ</ci><ci id="S3.SS1.p1.5.m5.1.1.2.3.cmml" xref="S3.SS1.p1.5.m5.1.1.2.3">𝑐</ci></apply><ci id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">ℐ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\mathcal{I}_{c}\subseteq\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">caligraphic_I start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ⊆ caligraphic_I</annotation></semantics></math> based on the predicted preferences of user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_u</annotation></semantics></math>. However, this easily results in the desired item <math alttext="i^{n}" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><msup id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><mi id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml">i</mi><mi id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml">n</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">superscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2">𝑖</ci><ci id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">i^{n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">italic_i start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> being absent from <math alttext="\mathcal{I}_{c}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><msub id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml">ℐ</mi><mi id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2">ℐ</ci><ci id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">\mathcal{I}_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">caligraphic_I start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.14">In this work, we position LLMs as the central controller for recommendation, simulating the user exploration w.r.t. item attributes in a multi-round manner. The interaction history <math alttext="\mathcal{H}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">ℋ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">ℋ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\mathcal{H}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">caligraphic_H</annotation></semantics></math> of user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_u</annotation></semantics></math> is fed into the LLM, so as to initialize the profile of surrogate user <math alttext="\hat{u}" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mover accent="true" id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">u</mi><mo id="S3.SS1.p2.3.m3.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><ci id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1">^</ci><ci id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\hat{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">over^ start_ARG italic_u end_ARG</annotation></semantics></math>.
In the first round, <math alttext="\hat{u}" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mover accent="true" id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">u</mi><mo id="S3.SS1.p2.4.m4.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><ci id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1">^</ci><ci id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">\hat{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">over^ start_ARG italic_u end_ARG</annotation></semantics></math> identifies a key attribute <math alttext="a_{1}" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><msub id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml"><mi id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml">a</mi><mn id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2">𝑎</ci><cn id="S3.SS1.p2.5.m5.1.1.3.cmml" type="integer" xref="S3.SS1.p2.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">a_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and uses external tools to fetch the related item set <math alttext="\mathcal{I}^{a_{1}}_{\hat{u}}" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m6.1"><semantics id="S3.SS1.p2.6.m6.1a"><msubsup id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.6.m6.1.1.2.2" xref="S3.SS1.p2.6.m6.1.1.2.2.cmml">ℐ</mi><mover accent="true" id="S3.SS1.p2.6.m6.1.1.3" xref="S3.SS1.p2.6.m6.1.1.3.cmml"><mi id="S3.SS1.p2.6.m6.1.1.3.2" xref="S3.SS1.p2.6.m6.1.1.3.2.cmml">u</mi><mo id="S3.SS1.p2.6.m6.1.1.3.1" xref="S3.SS1.p2.6.m6.1.1.3.1.cmml">^</mo></mover><msub id="S3.SS1.p2.6.m6.1.1.2.3" xref="S3.SS1.p2.6.m6.1.1.2.3.cmml"><mi id="S3.SS1.p2.6.m6.1.1.2.3.2" xref="S3.SS1.p2.6.m6.1.1.2.3.2.cmml">a</mi><mn id="S3.SS1.p2.6.m6.1.1.2.3.3" xref="S3.SS1.p2.6.m6.1.1.2.3.3.cmml">1</mn></msub></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">subscript</csymbol><apply id="S3.SS1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.2.1.cmml" xref="S3.SS1.p2.6.m6.1.1">superscript</csymbol><ci id="S3.SS1.p2.6.m6.1.1.2.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2.2">ℐ</ci><apply id="S3.SS1.p2.6.m6.1.1.2.3.cmml" xref="S3.SS1.p2.6.m6.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.2.3.1.cmml" xref="S3.SS1.p2.6.m6.1.1.2.3">subscript</csymbol><ci id="S3.SS1.p2.6.m6.1.1.2.3.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2.3.2">𝑎</ci><cn id="S3.SS1.p2.6.m6.1.1.2.3.3.cmml" type="integer" xref="S3.SS1.p2.6.m6.1.1.2.3.3">1</cn></apply></apply><apply id="S3.SS1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3"><ci id="S3.SS1.p2.6.m6.1.1.3.1.cmml" xref="S3.SS1.p2.6.m6.1.1.3.1">^</ci><ci id="S3.SS1.p2.6.m6.1.1.3.2.cmml" xref="S3.SS1.p2.6.m6.1.1.3.2">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">\mathcal{I}^{a_{1}}_{\hat{u}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m6.1d">caligraphic_I start_POSTSUPERSCRIPT italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT over^ start_ARG italic_u end_ARG end_POSTSUBSCRIPT</annotation></semantics></math>.
For clarity and brevity, we omit the subscript <math alttext="\hat{u}" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m7.1"><semantics id="S3.SS1.p2.7.m7.1a"><mover accent="true" id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml"><mi id="S3.SS1.p2.7.m7.1.1.2" xref="S3.SS1.p2.7.m7.1.1.2.cmml">u</mi><mo id="S3.SS1.p2.7.m7.1.1.1" xref="S3.SS1.p2.7.m7.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><apply id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1"><ci id="S3.SS1.p2.7.m7.1.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1.1">^</ci><ci id="S3.SS1.p2.7.m7.1.1.2.cmml" xref="S3.SS1.p2.7.m7.1.1.2">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">\hat{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.7.m7.1d">over^ start_ARG italic_u end_ARG</annotation></semantics></math> when the user is clear from the context. In the second round, <math alttext="\hat{u}" class="ltx_Math" display="inline" id="S3.SS1.p2.8.m8.1"><semantics id="S3.SS1.p2.8.m8.1a"><mover accent="true" id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml"><mi id="S3.SS1.p2.8.m8.1.1.2" xref="S3.SS1.p2.8.m8.1.1.2.cmml">u</mi><mo id="S3.SS1.p2.8.m8.1.1.1" xref="S3.SS1.p2.8.m8.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><apply id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1"><ci id="S3.SS1.p2.8.m8.1.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1.1">^</ci><ci id="S3.SS1.p2.8.m8.1.1.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">\hat{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.8.m8.1d">over^ start_ARG italic_u end_ARG</annotation></semantics></math> contrasts the preferences between <math alttext="\mathcal{I}^{a_{1}}" class="ltx_Math" display="inline" id="S3.SS1.p2.9.m9.1"><semantics id="S3.SS1.p2.9.m9.1a"><msup id="S3.SS1.p2.9.m9.1.1" xref="S3.SS1.p2.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.9.m9.1.1.2" xref="S3.SS1.p2.9.m9.1.1.2.cmml">ℐ</mi><msub id="S3.SS1.p2.9.m9.1.1.3" xref="S3.SS1.p2.9.m9.1.1.3.cmml"><mi id="S3.SS1.p2.9.m9.1.1.3.2" xref="S3.SS1.p2.9.m9.1.1.3.2.cmml">a</mi><mn id="S3.SS1.p2.9.m9.1.1.3.3" xref="S3.SS1.p2.9.m9.1.1.3.3.cmml">1</mn></msub></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.1b"><apply id="S3.SS1.p2.9.m9.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m9.1.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1">superscript</csymbol><ci id="S3.SS1.p2.9.m9.1.1.2.cmml" xref="S3.SS1.p2.9.m9.1.1.2">ℐ</ci><apply id="S3.SS1.p2.9.m9.1.1.3.cmml" xref="S3.SS1.p2.9.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m9.1.1.3.1.cmml" xref="S3.SS1.p2.9.m9.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.9.m9.1.1.3.2.cmml" xref="S3.SS1.p2.9.m9.1.1.3.2">𝑎</ci><cn id="S3.SS1.p2.9.m9.1.1.3.3.cmml" type="integer" xref="S3.SS1.p2.9.m9.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.1c">\mathcal{I}^{a_{1}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.9.m9.1d">caligraphic_I start_POSTSUPERSCRIPT italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{H}" class="ltx_Math" display="inline" id="S3.SS1.p2.10.m10.1"><semantics id="S3.SS1.p2.10.m10.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.10.m10.1.1" xref="S3.SS1.p2.10.m10.1.1.cmml">ℋ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m10.1b"><ci id="S3.SS1.p2.10.m10.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1">ℋ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m10.1c">\mathcal{H}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.10.m10.1d">caligraphic_H</annotation></semantics></math>, selects another attribute <math alttext="a_{2}" class="ltx_Math" display="inline" id="S3.SS1.p2.11.m11.1"><semantics id="S3.SS1.p2.11.m11.1a"><msub id="S3.SS1.p2.11.m11.1.1" xref="S3.SS1.p2.11.m11.1.1.cmml"><mi id="S3.SS1.p2.11.m11.1.1.2" xref="S3.SS1.p2.11.m11.1.1.2.cmml">a</mi><mn id="S3.SS1.p2.11.m11.1.1.3" xref="S3.SS1.p2.11.m11.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m11.1b"><apply id="S3.SS1.p2.11.m11.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.1.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1">subscript</csymbol><ci id="S3.SS1.p2.11.m11.1.1.2.cmml" xref="S3.SS1.p2.11.m11.1.1.2">𝑎</ci><cn id="S3.SS1.p2.11.m11.1.1.3.cmml" type="integer" xref="S3.SS1.p2.11.m11.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m11.1c">a_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.11.m11.1d">italic_a start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, and retrieves <math alttext="\mathcal{I}^{a_{2}}" class="ltx_Math" display="inline" id="S3.SS1.p2.12.m12.1"><semantics id="S3.SS1.p2.12.m12.1a"><msup id="S3.SS1.p2.12.m12.1.1" xref="S3.SS1.p2.12.m12.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.12.m12.1.1.2" xref="S3.SS1.p2.12.m12.1.1.2.cmml">ℐ</mi><msub id="S3.SS1.p2.12.m12.1.1.3" xref="S3.SS1.p2.12.m12.1.1.3.cmml"><mi id="S3.SS1.p2.12.m12.1.1.3.2" xref="S3.SS1.p2.12.m12.1.1.3.2.cmml">a</mi><mn id="S3.SS1.p2.12.m12.1.1.3.3" xref="S3.SS1.p2.12.m12.1.1.3.3.cmml">2</mn></msub></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.12.m12.1b"><apply id="S3.SS1.p2.12.m12.1.1.cmml" xref="S3.SS1.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m12.1.1.1.cmml" xref="S3.SS1.p2.12.m12.1.1">superscript</csymbol><ci id="S3.SS1.p2.12.m12.1.1.2.cmml" xref="S3.SS1.p2.12.m12.1.1.2">ℐ</ci><apply id="S3.SS1.p2.12.m12.1.1.3.cmml" xref="S3.SS1.p2.12.m12.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m12.1.1.3.1.cmml" xref="S3.SS1.p2.12.m12.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.12.m12.1.1.3.2.cmml" xref="S3.SS1.p2.12.m12.1.1.3.2">𝑎</ci><cn id="S3.SS1.p2.12.m12.1.1.3.3.cmml" type="integer" xref="S3.SS1.p2.12.m12.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.12.m12.1c">\mathcal{I}^{a_{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.12.m12.1d">caligraphic_I start_POSTSUPERSCRIPT italic_a start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.
Such iterative refinements continue until <math alttext="\hat{u}" class="ltx_Math" display="inline" id="S3.SS1.p2.13.m13.1"><semantics id="S3.SS1.p2.13.m13.1a"><mover accent="true" id="S3.SS1.p2.13.m13.1.1" xref="S3.SS1.p2.13.m13.1.1.cmml"><mi id="S3.SS1.p2.13.m13.1.1.2" xref="S3.SS1.p2.13.m13.1.1.2.cmml">u</mi><mo id="S3.SS1.p2.13.m13.1.1.1" xref="S3.SS1.p2.13.m13.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.13.m13.1b"><apply id="S3.SS1.p2.13.m13.1.1.cmml" xref="S3.SS1.p2.13.m13.1.1"><ci id="S3.SS1.p2.13.m13.1.1.1.cmml" xref="S3.SS1.p2.13.m13.1.1.1">^</ci><ci id="S3.SS1.p2.13.m13.1.1.2.cmml" xref="S3.SS1.p2.13.m13.1.1.2">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.13.m13.1c">\hat{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.13.m13.1d">over^ start_ARG italic_u end_ARG</annotation></semantics></math> is satisfied with the retrieved items, and outputs the final set <math alttext="\mathcal{I}_{\hat{u}}" class="ltx_Math" display="inline" id="S3.SS1.p2.14.m14.1"><semantics id="S3.SS1.p2.14.m14.1a"><msub id="S3.SS1.p2.14.m14.1.1" xref="S3.SS1.p2.14.m14.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.14.m14.1.1.2" xref="S3.SS1.p2.14.m14.1.1.2.cmml">ℐ</mi><mover accent="true" id="S3.SS1.p2.14.m14.1.1.3" xref="S3.SS1.p2.14.m14.1.1.3.cmml"><mi id="S3.SS1.p2.14.m14.1.1.3.2" xref="S3.SS1.p2.14.m14.1.1.3.2.cmml">u</mi><mo id="S3.SS1.p2.14.m14.1.1.3.1" xref="S3.SS1.p2.14.m14.1.1.3.1.cmml">^</mo></mover></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.14.m14.1b"><apply id="S3.SS1.p2.14.m14.1.1.cmml" xref="S3.SS1.p2.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.14.m14.1.1.1.cmml" xref="S3.SS1.p2.14.m14.1.1">subscript</csymbol><ci id="S3.SS1.p2.14.m14.1.1.2.cmml" xref="S3.SS1.p2.14.m14.1.1.2">ℐ</ci><apply id="S3.SS1.p2.14.m14.1.1.3.cmml" xref="S3.SS1.p2.14.m14.1.1.3"><ci id="S3.SS1.p2.14.m14.1.1.3.1.cmml" xref="S3.SS1.p2.14.m14.1.1.3.1">^</ci><ci id="S3.SS1.p2.14.m14.1.1.3.2.cmml" xref="S3.SS1.p2.14.m14.1.1.3.2">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.14.m14.1c">\mathcal{I}_{\hat{u}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.14.m14.1d">caligraphic_I start_POSTSUBSCRIPT over^ start_ARG italic_u end_ARG end_POSTSUBSCRIPT</annotation></semantics></math> ranked by preference. Each derived item set reflects the interest emerging from the respective round.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>User Decision Simulation</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">To validate LLMs’ capability in simulating user preferences and utilizing external tools, we draw inspiration from prior tool-learning studies <cite class="ltx_cite ltx_citemacro_citep">(Yao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib56" title="">2023</a>; Qin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib31" title="">2023a</a>; Schick et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib36" title="">2023</a>; Qin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib32" title="">2023b</a>)</cite> and propose a user decision simulation process. Here is an example of the simulation prompt in the movie recommendation scenario:</p>
</div>
<figure class="ltx_figure" id="S3.SS2.1"><img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_landscape" height="364" id="S3.SS2.1.g1" src="x3.png" width="831"/>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.2">where <math alttext="{&lt;}\mathcal{D}{&gt;}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mrow id="S3.SS2.p2.1.m1.1.2.2" xref="S3.SS2.p2.1.m1.1.2.1.cmml"><mo fence="true" id="S3.SS2.p2.1.m1.1.2.2.1" rspace="0em" xref="S3.SS2.p2.1.m1.1.2.1.1.cmml">&lt;</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">𝒟</mi><mo fence="true" id="S3.SS2.p2.1.m1.1.2.2.2" lspace="0em" xref="S3.SS2.p2.1.m1.1.2.1.1.cmml">&gt;</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.2.1.cmml" xref="S3.SS2.p2.1.m1.1.2.2"><csymbol cd="latexml" id="S3.SS2.p2.1.m1.1.2.1.1.cmml" xref="S3.SS2.p2.1.m1.1.2.2.1">expectation</csymbol><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">{&lt;}\mathcal{D}{&gt;}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">&lt; caligraphic_D &gt;</annotation></semantics></math> represents the collection of demonstrations that show LLMs what a good movie list looks like, and <math alttext="{&lt;}\mathcal{T}{&gt;}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><mrow id="S3.SS2.p2.2.m2.1.2.2" xref="S3.SS2.p2.2.m2.1.2.1.cmml"><mo fence="true" id="S3.SS2.p2.2.m2.1.2.2.1" rspace="0em" xref="S3.SS2.p2.2.m2.1.2.1.1.cmml">&lt;</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">𝒯</mi><mo fence="true" id="S3.SS2.p2.2.m2.1.2.2.2" lspace="0em" xref="S3.SS2.p2.2.m2.1.2.1.1.cmml">&gt;</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.2.1.cmml" xref="S3.SS2.p2.2.m2.1.2.2"><csymbol cd="latexml" id="S3.SS2.p2.2.m2.1.2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.2.2.1">expectation</csymbol><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝒯</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">{&lt;}\mathcal{T}{&gt;}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">&lt; caligraphic_T &gt;</annotation></semantics></math> denotes the detailed description of the tools.
The foundational elements of the user decision simulation methodology are twofold:</p>
<dl class="ltx_description" id="S3.I1">
<dt class="ltx_item" id="S3.I1.ix1"><span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S3.I1.ix1.1.1.1">Chain-of-thought prompting (CoT).: </span></span></dt>
<dd class="ltx_item">
<div class="ltx_para" id="S3.I1.ix1.p1">
<p class="ltx_p" id="S3.I1.ix1.p1.18">We use CoT <cite class="ltx_cite ltx_citemacro_citep">(Wei et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib46" title="">2022</a>)</cite> to synergize reasoning and action.
Here, “reasoning” refers to the “thinking procedure” for how to recommend suitable items to users, and decide the details of the subsequent action.
Meanwhile, “action” entails executing the directives derived from reasoning, making “observations,” and yielding the corresponding outcome.
At each step <math alttext="t" class="ltx_Math" display="inline" id="S3.I1.ix1.p1.1.m1.1"><semantics id="S3.I1.ix1.p1.1.m1.1a"><mi id="S3.I1.ix1.p1.1.m1.1.1" xref="S3.I1.ix1.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.I1.ix1.p1.1.m1.1b"><ci id="S3.I1.ix1.p1.1.m1.1.1.cmml" xref="S3.I1.ix1.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix1.p1.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix1.p1.1.m1.1d">italic_t</annotation></semantics></math>, the LLM-driven surrogate user <math alttext="\hat{u}" class="ltx_Math" display="inline" id="S3.I1.ix1.p1.2.m2.1"><semantics id="S3.I1.ix1.p1.2.m2.1a"><mover accent="true" id="S3.I1.ix1.p1.2.m2.1.1" xref="S3.I1.ix1.p1.2.m2.1.1.cmml"><mi id="S3.I1.ix1.p1.2.m2.1.1.2" xref="S3.I1.ix1.p1.2.m2.1.1.2.cmml">u</mi><mo id="S3.I1.ix1.p1.2.m2.1.1.1" xref="S3.I1.ix1.p1.2.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.I1.ix1.p1.2.m2.1b"><apply id="S3.I1.ix1.p1.2.m2.1.1.cmml" xref="S3.I1.ix1.p1.2.m2.1.1"><ci id="S3.I1.ix1.p1.2.m2.1.1.1.cmml" xref="S3.I1.ix1.p1.2.m2.1.1.1">^</ci><ci id="S3.I1.ix1.p1.2.m2.1.1.2.cmml" xref="S3.I1.ix1.p1.2.m2.1.1.2">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix1.p1.2.m2.1c">\hat{u}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix1.p1.2.m2.1d">over^ start_ARG italic_u end_ARG</annotation></semantics></math> receives an observation <math alttext="o^{t-1}" class="ltx_Math" display="inline" id="S3.I1.ix1.p1.3.m3.1"><semantics id="S3.I1.ix1.p1.3.m3.1a"><msup id="S3.I1.ix1.p1.3.m3.1.1" xref="S3.I1.ix1.p1.3.m3.1.1.cmml"><mi id="S3.I1.ix1.p1.3.m3.1.1.2" xref="S3.I1.ix1.p1.3.m3.1.1.2.cmml">o</mi><mrow id="S3.I1.ix1.p1.3.m3.1.1.3" xref="S3.I1.ix1.p1.3.m3.1.1.3.cmml"><mi id="S3.I1.ix1.p1.3.m3.1.1.3.2" xref="S3.I1.ix1.p1.3.m3.1.1.3.2.cmml">t</mi><mo id="S3.I1.ix1.p1.3.m3.1.1.3.1" xref="S3.I1.ix1.p1.3.m3.1.1.3.1.cmml">−</mo><mn id="S3.I1.ix1.p1.3.m3.1.1.3.3" xref="S3.I1.ix1.p1.3.m3.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.I1.ix1.p1.3.m3.1b"><apply id="S3.I1.ix1.p1.3.m3.1.1.cmml" xref="S3.I1.ix1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.I1.ix1.p1.3.m3.1.1.1.cmml" xref="S3.I1.ix1.p1.3.m3.1.1">superscript</csymbol><ci id="S3.I1.ix1.p1.3.m3.1.1.2.cmml" xref="S3.I1.ix1.p1.3.m3.1.1.2">𝑜</ci><apply id="S3.I1.ix1.p1.3.m3.1.1.3.cmml" xref="S3.I1.ix1.p1.3.m3.1.1.3"><minus id="S3.I1.ix1.p1.3.m3.1.1.3.1.cmml" xref="S3.I1.ix1.p1.3.m3.1.1.3.1"></minus><ci id="S3.I1.ix1.p1.3.m3.1.1.3.2.cmml" xref="S3.I1.ix1.p1.3.m3.1.1.3.2">𝑡</ci><cn id="S3.I1.ix1.p1.3.m3.1.1.3.3.cmml" type="integer" xref="S3.I1.ix1.p1.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix1.p1.3.m3.1c">o^{t-1}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix1.p1.3.m3.1d">italic_o start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT</annotation></semantics></math> from the last step and derives a thought <math alttext="g_{t}" class="ltx_Math" display="inline" id="S3.I1.ix1.p1.4.m4.1"><semantics id="S3.I1.ix1.p1.4.m4.1a"><msub id="S3.I1.ix1.p1.4.m4.1.1" xref="S3.I1.ix1.p1.4.m4.1.1.cmml"><mi id="S3.I1.ix1.p1.4.m4.1.1.2" xref="S3.I1.ix1.p1.4.m4.1.1.2.cmml">g</mi><mi id="S3.I1.ix1.p1.4.m4.1.1.3" xref="S3.I1.ix1.p1.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.ix1.p1.4.m4.1b"><apply id="S3.I1.ix1.p1.4.m4.1.1.cmml" xref="S3.I1.ix1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.I1.ix1.p1.4.m4.1.1.1.cmml" xref="S3.I1.ix1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.I1.ix1.p1.4.m4.1.1.2.cmml" xref="S3.I1.ix1.p1.4.m4.1.1.2">𝑔</ci><ci id="S3.I1.ix1.p1.4.m4.1.1.3.cmml" xref="S3.I1.ix1.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix1.p1.4.m4.1c">g_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix1.p1.4.m4.1d">italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to take an action <math alttext="\mathcal{A}_{t}" class="ltx_Math" display="inline" id="S3.I1.ix1.p1.5.m5.1"><semantics id="S3.I1.ix1.p1.5.m5.1a"><msub id="S3.I1.ix1.p1.5.m5.1.1" xref="S3.I1.ix1.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I1.ix1.p1.5.m5.1.1.2" xref="S3.I1.ix1.p1.5.m5.1.1.2.cmml">𝒜</mi><mi id="S3.I1.ix1.p1.5.m5.1.1.3" xref="S3.I1.ix1.p1.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.ix1.p1.5.m5.1b"><apply id="S3.I1.ix1.p1.5.m5.1.1.cmml" xref="S3.I1.ix1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.I1.ix1.p1.5.m5.1.1.1.cmml" xref="S3.I1.ix1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.I1.ix1.p1.5.m5.1.1.2.cmml" xref="S3.I1.ix1.p1.5.m5.1.1.2">𝒜</ci><ci id="S3.I1.ix1.p1.5.m5.1.1.3.cmml" xref="S3.I1.ix1.p1.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix1.p1.5.m5.1c">\mathcal{A}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix1.p1.5.m5.1d">caligraphic_A start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> following some policy <math alttext="\pi(g_{t},\mathcal{A}_{t}|c_{t})" class="ltx_Math" display="inline" id="S3.I1.ix1.p1.6.m6.2"><semantics id="S3.I1.ix1.p1.6.m6.2a"><mrow id="S3.I1.ix1.p1.6.m6.2.2" xref="S3.I1.ix1.p1.6.m6.2.2.cmml"><mi id="S3.I1.ix1.p1.6.m6.2.2.4" xref="S3.I1.ix1.p1.6.m6.2.2.4.cmml">π</mi><mo id="S3.I1.ix1.p1.6.m6.2.2.3" xref="S3.I1.ix1.p1.6.m6.2.2.3.cmml">⁢</mo><mrow id="S3.I1.ix1.p1.6.m6.2.2.2.2" xref="S3.I1.ix1.p1.6.m6.2.2.2.3.cmml"><mo id="S3.I1.ix1.p1.6.m6.2.2.2.2.3" stretchy="false" xref="S3.I1.ix1.p1.6.m6.2.2.2.3.cmml">(</mo><msub id="S3.I1.ix1.p1.6.m6.1.1.1.1.1" xref="S3.I1.ix1.p1.6.m6.1.1.1.1.1.cmml"><mi id="S3.I1.ix1.p1.6.m6.1.1.1.1.1.2" xref="S3.I1.ix1.p1.6.m6.1.1.1.1.1.2.cmml">g</mi><mi id="S3.I1.ix1.p1.6.m6.1.1.1.1.1.3" xref="S3.I1.ix1.p1.6.m6.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.I1.ix1.p1.6.m6.2.2.2.2.4" xref="S3.I1.ix1.p1.6.m6.2.2.2.3.cmml">,</mo><mrow id="S3.I1.ix1.p1.6.m6.2.2.2.2.2" xref="S3.I1.ix1.p1.6.m6.2.2.2.2.2.cmml"><msub id="S3.I1.ix1.p1.6.m6.2.2.2.2.2.2" xref="S3.I1.ix1.p1.6.m6.2.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I1.ix1.p1.6.m6.2.2.2.2.2.2.2" xref="S3.I1.ix1.p1.6.m6.2.2.2.2.2.2.2.cmml">𝒜</mi><mi id="S3.I1.ix1.p1.6.m6.2.2.2.2.2.2.3" xref="S3.I1.ix1.p1.6.m6.2.2.2.2.2.2.3.cmml">t</mi></msub><mo fence="false" id="S3.I1.ix1.p1.6.m6.2.2.2.2.2.1" xref="S3.I1.ix1.p1.6.m6.2.2.2.2.2.1.cmml">|</mo><msub id="S3.I1.ix1.p1.6.m6.2.2.2.2.2.3" xref="S3.I1.ix1.p1.6.m6.2.2.2.2.2.3.cmml"><mi id="S3.I1.ix1.p1.6.m6.2.2.2.2.2.3.2" xref="S3.I1.ix1.p1.6.m6.2.2.2.2.2.3.2.cmml">c</mi><mi id="S3.I1.ix1.p1.6.m6.2.2.2.2.2.3.3" xref="S3.I1.ix1.p1.6.m6.2.2.2.2.2.3.3.cmml">t</mi></msub></mrow><mo id="S3.I1.ix1.p1.6.m6.2.2.2.2.5" stretchy="false" xref="S3.I1.ix1.p1.6.m6.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.ix1.p1.6.m6.2b"><apply id="S3.I1.ix1.p1.6.m6.2.2.cmml" xref="S3.I1.ix1.p1.6.m6.2.2"><times id="S3.I1.ix1.p1.6.m6.2.2.3.cmml" xref="S3.I1.ix1.p1.6.m6.2.2.3"></times><ci id="S3.I1.ix1.p1.6.m6.2.2.4.cmml" xref="S3.I1.ix1.p1.6.m6.2.2.4">𝜋</ci><interval closure="open" id="S3.I1.ix1.p1.6.m6.2.2.2.3.cmml" xref="S3.I1.ix1.p1.6.m6.2.2.2.2"><apply id="S3.I1.ix1.p1.6.m6.1.1.1.1.1.cmml" xref="S3.I1.ix1.p1.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.I1.ix1.p1.6.m6.1.1.1.1.1.1.cmml" xref="S3.I1.ix1.p1.6.m6.1.1.1.1.1">subscript</csymbol><ci id="S3.I1.ix1.p1.6.m6.1.1.1.1.1.2.cmml" xref="S3.I1.ix1.p1.6.m6.1.1.1.1.1.2">𝑔</ci><ci id="S3.I1.ix1.p1.6.m6.1.1.1.1.1.3.cmml" xref="S3.I1.ix1.p1.6.m6.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.I1.ix1.p1.6.m6.2.2.2.2.2.cmml" xref="S3.I1.ix1.p1.6.m6.2.2.2.2.2"><csymbol cd="latexml" id="S3.I1.ix1.p1.6.m6.2.2.2.2.2.1.cmml" xref="S3.I1.ix1.p1.6.m6.2.2.2.2.2.1">conditional</csymbol><apply id="S3.I1.ix1.p1.6.m6.2.2.2.2.2.2.cmml" xref="S3.I1.ix1.p1.6.m6.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.I1.ix1.p1.6.m6.2.2.2.2.2.2.1.cmml" xref="S3.I1.ix1.p1.6.m6.2.2.2.2.2.2">subscript</csymbol><ci id="S3.I1.ix1.p1.6.m6.2.2.2.2.2.2.2.cmml" xref="S3.I1.ix1.p1.6.m6.2.2.2.2.2.2.2">𝒜</ci><ci id="S3.I1.ix1.p1.6.m6.2.2.2.2.2.2.3.cmml" xref="S3.I1.ix1.p1.6.m6.2.2.2.2.2.2.3">𝑡</ci></apply><apply id="S3.I1.ix1.p1.6.m6.2.2.2.2.2.3.cmml" xref="S3.I1.ix1.p1.6.m6.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.I1.ix1.p1.6.m6.2.2.2.2.2.3.1.cmml" xref="S3.I1.ix1.p1.6.m6.2.2.2.2.2.3">subscript</csymbol><ci id="S3.I1.ix1.p1.6.m6.2.2.2.2.2.3.2.cmml" xref="S3.I1.ix1.p1.6.m6.2.2.2.2.2.3.2">𝑐</ci><ci id="S3.I1.ix1.p1.6.m6.2.2.2.2.2.3.3.cmml" xref="S3.I1.ix1.p1.6.m6.2.2.2.2.2.3.3">𝑡</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix1.p1.6.m6.2c">\pi(g_{t},\mathcal{A}_{t}|c_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix1.p1.6.m6.2d">italic_π ( italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , caligraphic_A start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="\pi" class="ltx_Math" display="inline" id="S3.I1.ix1.p1.7.m7.1"><semantics id="S3.I1.ix1.p1.7.m7.1a"><mi id="S3.I1.ix1.p1.7.m7.1.1" xref="S3.I1.ix1.p1.7.m7.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.I1.ix1.p1.7.m7.1b"><ci id="S3.I1.ix1.p1.7.m7.1.1.cmml" xref="S3.I1.ix1.p1.7.m7.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix1.p1.7.m7.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix1.p1.7.m7.1d">italic_π</annotation></semantics></math> could be implemented by any LLMs, specifically ChatGPT, in our ToolRec, and <math alttext="c_{t}=(o_{0},g_{1},\mathcal{A}_{1},o_{1},\ldots,g_{{t}-1},\mathcal{A}_{{t}-1},%
o_{{t}-1})" class="ltx_Math" display="inline" id="S3.I1.ix1.p1.8.m8.8"><semantics id="S3.I1.ix1.p1.8.m8.8a"><mrow id="S3.I1.ix1.p1.8.m8.8.8" xref="S3.I1.ix1.p1.8.m8.8.8.cmml"><msub id="S3.I1.ix1.p1.8.m8.8.8.9" xref="S3.I1.ix1.p1.8.m8.8.8.9.cmml"><mi id="S3.I1.ix1.p1.8.m8.8.8.9.2" xref="S3.I1.ix1.p1.8.m8.8.8.9.2.cmml">c</mi><mi id="S3.I1.ix1.p1.8.m8.8.8.9.3" xref="S3.I1.ix1.p1.8.m8.8.8.9.3.cmml">t</mi></msub><mo id="S3.I1.ix1.p1.8.m8.8.8.8" xref="S3.I1.ix1.p1.8.m8.8.8.8.cmml">=</mo><mrow id="S3.I1.ix1.p1.8.m8.8.8.7.7" xref="S3.I1.ix1.p1.8.m8.8.8.7.8.cmml"><mo id="S3.I1.ix1.p1.8.m8.8.8.7.7.8" stretchy="false" xref="S3.I1.ix1.p1.8.m8.8.8.7.8.cmml">(</mo><msub id="S3.I1.ix1.p1.8.m8.2.2.1.1.1" xref="S3.I1.ix1.p1.8.m8.2.2.1.1.1.cmml"><mi id="S3.I1.ix1.p1.8.m8.2.2.1.1.1.2" xref="S3.I1.ix1.p1.8.m8.2.2.1.1.1.2.cmml">o</mi><mn id="S3.I1.ix1.p1.8.m8.2.2.1.1.1.3" xref="S3.I1.ix1.p1.8.m8.2.2.1.1.1.3.cmml">0</mn></msub><mo id="S3.I1.ix1.p1.8.m8.8.8.7.7.9" xref="S3.I1.ix1.p1.8.m8.8.8.7.8.cmml">,</mo><msub id="S3.I1.ix1.p1.8.m8.3.3.2.2.2" xref="S3.I1.ix1.p1.8.m8.3.3.2.2.2.cmml"><mi id="S3.I1.ix1.p1.8.m8.3.3.2.2.2.2" xref="S3.I1.ix1.p1.8.m8.3.3.2.2.2.2.cmml">g</mi><mn id="S3.I1.ix1.p1.8.m8.3.3.2.2.2.3" xref="S3.I1.ix1.p1.8.m8.3.3.2.2.2.3.cmml">1</mn></msub><mo id="S3.I1.ix1.p1.8.m8.8.8.7.7.10" xref="S3.I1.ix1.p1.8.m8.8.8.7.8.cmml">,</mo><msub id="S3.I1.ix1.p1.8.m8.4.4.3.3.3" xref="S3.I1.ix1.p1.8.m8.4.4.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I1.ix1.p1.8.m8.4.4.3.3.3.2" xref="S3.I1.ix1.p1.8.m8.4.4.3.3.3.2.cmml">𝒜</mi><mn id="S3.I1.ix1.p1.8.m8.4.4.3.3.3.3" xref="S3.I1.ix1.p1.8.m8.4.4.3.3.3.3.cmml">1</mn></msub><mo id="S3.I1.ix1.p1.8.m8.8.8.7.7.11" xref="S3.I1.ix1.p1.8.m8.8.8.7.8.cmml">,</mo><msub id="S3.I1.ix1.p1.8.m8.5.5.4.4.4" xref="S3.I1.ix1.p1.8.m8.5.5.4.4.4.cmml"><mi id="S3.I1.ix1.p1.8.m8.5.5.4.4.4.2" xref="S3.I1.ix1.p1.8.m8.5.5.4.4.4.2.cmml">o</mi><mn id="S3.I1.ix1.p1.8.m8.5.5.4.4.4.3" xref="S3.I1.ix1.p1.8.m8.5.5.4.4.4.3.cmml">1</mn></msub><mo id="S3.I1.ix1.p1.8.m8.8.8.7.7.12" xref="S3.I1.ix1.p1.8.m8.8.8.7.8.cmml">,</mo><mi id="S3.I1.ix1.p1.8.m8.1.1" mathvariant="normal" xref="S3.I1.ix1.p1.8.m8.1.1.cmml">…</mi><mo id="S3.I1.ix1.p1.8.m8.8.8.7.7.13" xref="S3.I1.ix1.p1.8.m8.8.8.7.8.cmml">,</mo><msub id="S3.I1.ix1.p1.8.m8.6.6.5.5.5" xref="S3.I1.ix1.p1.8.m8.6.6.5.5.5.cmml"><mi id="S3.I1.ix1.p1.8.m8.6.6.5.5.5.2" xref="S3.I1.ix1.p1.8.m8.6.6.5.5.5.2.cmml">g</mi><mrow id="S3.I1.ix1.p1.8.m8.6.6.5.5.5.3" xref="S3.I1.ix1.p1.8.m8.6.6.5.5.5.3.cmml"><mi id="S3.I1.ix1.p1.8.m8.6.6.5.5.5.3.2" xref="S3.I1.ix1.p1.8.m8.6.6.5.5.5.3.2.cmml">t</mi><mo id="S3.I1.ix1.p1.8.m8.6.6.5.5.5.3.1" xref="S3.I1.ix1.p1.8.m8.6.6.5.5.5.3.1.cmml">−</mo><mn id="S3.I1.ix1.p1.8.m8.6.6.5.5.5.3.3" xref="S3.I1.ix1.p1.8.m8.6.6.5.5.5.3.3.cmml">1</mn></mrow></msub><mo id="S3.I1.ix1.p1.8.m8.8.8.7.7.14" xref="S3.I1.ix1.p1.8.m8.8.8.7.8.cmml">,</mo><msub id="S3.I1.ix1.p1.8.m8.7.7.6.6.6" xref="S3.I1.ix1.p1.8.m8.7.7.6.6.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I1.ix1.p1.8.m8.7.7.6.6.6.2" xref="S3.I1.ix1.p1.8.m8.7.7.6.6.6.2.cmml">𝒜</mi><mrow id="S3.I1.ix1.p1.8.m8.7.7.6.6.6.3" xref="S3.I1.ix1.p1.8.m8.7.7.6.6.6.3.cmml"><mi id="S3.I1.ix1.p1.8.m8.7.7.6.6.6.3.2" xref="S3.I1.ix1.p1.8.m8.7.7.6.6.6.3.2.cmml">t</mi><mo id="S3.I1.ix1.p1.8.m8.7.7.6.6.6.3.1" xref="S3.I1.ix1.p1.8.m8.7.7.6.6.6.3.1.cmml">−</mo><mn id="S3.I1.ix1.p1.8.m8.7.7.6.6.6.3.3" xref="S3.I1.ix1.p1.8.m8.7.7.6.6.6.3.3.cmml">1</mn></mrow></msub><mo id="S3.I1.ix1.p1.8.m8.8.8.7.7.15" xref="S3.I1.ix1.p1.8.m8.8.8.7.8.cmml">,</mo><msub id="S3.I1.ix1.p1.8.m8.8.8.7.7.7" xref="S3.I1.ix1.p1.8.m8.8.8.7.7.7.cmml"><mi id="S3.I1.ix1.p1.8.m8.8.8.7.7.7.2" xref="S3.I1.ix1.p1.8.m8.8.8.7.7.7.2.cmml">o</mi><mrow id="S3.I1.ix1.p1.8.m8.8.8.7.7.7.3" xref="S3.I1.ix1.p1.8.m8.8.8.7.7.7.3.cmml"><mi id="S3.I1.ix1.p1.8.m8.8.8.7.7.7.3.2" xref="S3.I1.ix1.p1.8.m8.8.8.7.7.7.3.2.cmml">t</mi><mo id="S3.I1.ix1.p1.8.m8.8.8.7.7.7.3.1" xref="S3.I1.ix1.p1.8.m8.8.8.7.7.7.3.1.cmml">−</mo><mn id="S3.I1.ix1.p1.8.m8.8.8.7.7.7.3.3" xref="S3.I1.ix1.p1.8.m8.8.8.7.7.7.3.3.cmml">1</mn></mrow></msub><mo id="S3.I1.ix1.p1.8.m8.8.8.7.7.16" stretchy="false" xref="S3.I1.ix1.p1.8.m8.8.8.7.8.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.ix1.p1.8.m8.8b"><apply id="S3.I1.ix1.p1.8.m8.8.8.cmml" xref="S3.I1.ix1.p1.8.m8.8.8"><eq id="S3.I1.ix1.p1.8.m8.8.8.8.cmml" xref="S3.I1.ix1.p1.8.m8.8.8.8"></eq><apply id="S3.I1.ix1.p1.8.m8.8.8.9.cmml" xref="S3.I1.ix1.p1.8.m8.8.8.9"><csymbol cd="ambiguous" id="S3.I1.ix1.p1.8.m8.8.8.9.1.cmml" xref="S3.I1.ix1.p1.8.m8.8.8.9">subscript</csymbol><ci id="S3.I1.ix1.p1.8.m8.8.8.9.2.cmml" xref="S3.I1.ix1.p1.8.m8.8.8.9.2">𝑐</ci><ci id="S3.I1.ix1.p1.8.m8.8.8.9.3.cmml" xref="S3.I1.ix1.p1.8.m8.8.8.9.3">𝑡</ci></apply><vector id="S3.I1.ix1.p1.8.m8.8.8.7.8.cmml" xref="S3.I1.ix1.p1.8.m8.8.8.7.7"><apply id="S3.I1.ix1.p1.8.m8.2.2.1.1.1.cmml" xref="S3.I1.ix1.p1.8.m8.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.I1.ix1.p1.8.m8.2.2.1.1.1.1.cmml" xref="S3.I1.ix1.p1.8.m8.2.2.1.1.1">subscript</csymbol><ci id="S3.I1.ix1.p1.8.m8.2.2.1.1.1.2.cmml" xref="S3.I1.ix1.p1.8.m8.2.2.1.1.1.2">𝑜</ci><cn id="S3.I1.ix1.p1.8.m8.2.2.1.1.1.3.cmml" type="integer" xref="S3.I1.ix1.p1.8.m8.2.2.1.1.1.3">0</cn></apply><apply id="S3.I1.ix1.p1.8.m8.3.3.2.2.2.cmml" xref="S3.I1.ix1.p1.8.m8.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.I1.ix1.p1.8.m8.3.3.2.2.2.1.cmml" xref="S3.I1.ix1.p1.8.m8.3.3.2.2.2">subscript</csymbol><ci id="S3.I1.ix1.p1.8.m8.3.3.2.2.2.2.cmml" xref="S3.I1.ix1.p1.8.m8.3.3.2.2.2.2">𝑔</ci><cn id="S3.I1.ix1.p1.8.m8.3.3.2.2.2.3.cmml" type="integer" xref="S3.I1.ix1.p1.8.m8.3.3.2.2.2.3">1</cn></apply><apply id="S3.I1.ix1.p1.8.m8.4.4.3.3.3.cmml" xref="S3.I1.ix1.p1.8.m8.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.I1.ix1.p1.8.m8.4.4.3.3.3.1.cmml" xref="S3.I1.ix1.p1.8.m8.4.4.3.3.3">subscript</csymbol><ci id="S3.I1.ix1.p1.8.m8.4.4.3.3.3.2.cmml" xref="S3.I1.ix1.p1.8.m8.4.4.3.3.3.2">𝒜</ci><cn id="S3.I1.ix1.p1.8.m8.4.4.3.3.3.3.cmml" type="integer" xref="S3.I1.ix1.p1.8.m8.4.4.3.3.3.3">1</cn></apply><apply id="S3.I1.ix1.p1.8.m8.5.5.4.4.4.cmml" xref="S3.I1.ix1.p1.8.m8.5.5.4.4.4"><csymbol cd="ambiguous" id="S3.I1.ix1.p1.8.m8.5.5.4.4.4.1.cmml" xref="S3.I1.ix1.p1.8.m8.5.5.4.4.4">subscript</csymbol><ci id="S3.I1.ix1.p1.8.m8.5.5.4.4.4.2.cmml" xref="S3.I1.ix1.p1.8.m8.5.5.4.4.4.2">𝑜</ci><cn id="S3.I1.ix1.p1.8.m8.5.5.4.4.4.3.cmml" type="integer" xref="S3.I1.ix1.p1.8.m8.5.5.4.4.4.3">1</cn></apply><ci id="S3.I1.ix1.p1.8.m8.1.1.cmml" xref="S3.I1.ix1.p1.8.m8.1.1">…</ci><apply id="S3.I1.ix1.p1.8.m8.6.6.5.5.5.cmml" xref="S3.I1.ix1.p1.8.m8.6.6.5.5.5"><csymbol cd="ambiguous" id="S3.I1.ix1.p1.8.m8.6.6.5.5.5.1.cmml" xref="S3.I1.ix1.p1.8.m8.6.6.5.5.5">subscript</csymbol><ci id="S3.I1.ix1.p1.8.m8.6.6.5.5.5.2.cmml" xref="S3.I1.ix1.p1.8.m8.6.6.5.5.5.2">𝑔</ci><apply id="S3.I1.ix1.p1.8.m8.6.6.5.5.5.3.cmml" xref="S3.I1.ix1.p1.8.m8.6.6.5.5.5.3"><minus id="S3.I1.ix1.p1.8.m8.6.6.5.5.5.3.1.cmml" xref="S3.I1.ix1.p1.8.m8.6.6.5.5.5.3.1"></minus><ci id="S3.I1.ix1.p1.8.m8.6.6.5.5.5.3.2.cmml" xref="S3.I1.ix1.p1.8.m8.6.6.5.5.5.3.2">𝑡</ci><cn id="S3.I1.ix1.p1.8.m8.6.6.5.5.5.3.3.cmml" type="integer" xref="S3.I1.ix1.p1.8.m8.6.6.5.5.5.3.3">1</cn></apply></apply><apply id="S3.I1.ix1.p1.8.m8.7.7.6.6.6.cmml" xref="S3.I1.ix1.p1.8.m8.7.7.6.6.6"><csymbol cd="ambiguous" id="S3.I1.ix1.p1.8.m8.7.7.6.6.6.1.cmml" xref="S3.I1.ix1.p1.8.m8.7.7.6.6.6">subscript</csymbol><ci id="S3.I1.ix1.p1.8.m8.7.7.6.6.6.2.cmml" xref="S3.I1.ix1.p1.8.m8.7.7.6.6.6.2">𝒜</ci><apply id="S3.I1.ix1.p1.8.m8.7.7.6.6.6.3.cmml" xref="S3.I1.ix1.p1.8.m8.7.7.6.6.6.3"><minus id="S3.I1.ix1.p1.8.m8.7.7.6.6.6.3.1.cmml" xref="S3.I1.ix1.p1.8.m8.7.7.6.6.6.3.1"></minus><ci id="S3.I1.ix1.p1.8.m8.7.7.6.6.6.3.2.cmml" xref="S3.I1.ix1.p1.8.m8.7.7.6.6.6.3.2">𝑡</ci><cn id="S3.I1.ix1.p1.8.m8.7.7.6.6.6.3.3.cmml" type="integer" xref="S3.I1.ix1.p1.8.m8.7.7.6.6.6.3.3">1</cn></apply></apply><apply id="S3.I1.ix1.p1.8.m8.8.8.7.7.7.cmml" xref="S3.I1.ix1.p1.8.m8.8.8.7.7.7"><csymbol cd="ambiguous" id="S3.I1.ix1.p1.8.m8.8.8.7.7.7.1.cmml" xref="S3.I1.ix1.p1.8.m8.8.8.7.7.7">subscript</csymbol><ci id="S3.I1.ix1.p1.8.m8.8.8.7.7.7.2.cmml" xref="S3.I1.ix1.p1.8.m8.8.8.7.7.7.2">𝑜</ci><apply id="S3.I1.ix1.p1.8.m8.8.8.7.7.7.3.cmml" xref="S3.I1.ix1.p1.8.m8.8.8.7.7.7.3"><minus id="S3.I1.ix1.p1.8.m8.8.8.7.7.7.3.1.cmml" xref="S3.I1.ix1.p1.8.m8.8.8.7.7.7.3.1"></minus><ci id="S3.I1.ix1.p1.8.m8.8.8.7.7.7.3.2.cmml" xref="S3.I1.ix1.p1.8.m8.8.8.7.7.7.3.2">𝑡</ci><cn id="S3.I1.ix1.p1.8.m8.8.8.7.7.7.3.3.cmml" type="integer" xref="S3.I1.ix1.p1.8.m8.8.8.7.7.7.3.3">1</cn></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix1.p1.8.m8.8c">c_{t}=(o_{0},g_{1},\mathcal{A}_{1},o_{1},\ldots,g_{{t}-1},\mathcal{A}_{{t}-1},%
o_{{t}-1})</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix1.p1.8.m8.8d">italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ( italic_o start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_g start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , caligraphic_A start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_g start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , caligraphic_A start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT )</annotation></semantics></math> is the <span class="ltx_text ltx_font_italic" id="S3.I1.ix1.p1.18.1">context</span> to the <math alttext="\hat{u}" class="ltx_Math" display="inline" id="S3.I1.ix1.p1.9.m9.1"><semantics id="S3.I1.ix1.p1.9.m9.1a"><mover accent="true" id="S3.I1.ix1.p1.9.m9.1.1" xref="S3.I1.ix1.p1.9.m9.1.1.cmml"><mi id="S3.I1.ix1.p1.9.m9.1.1.2" xref="S3.I1.ix1.p1.9.m9.1.1.2.cmml">u</mi><mo id="S3.I1.ix1.p1.9.m9.1.1.1" xref="S3.I1.ix1.p1.9.m9.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.I1.ix1.p1.9.m9.1b"><apply id="S3.I1.ix1.p1.9.m9.1.1.cmml" xref="S3.I1.ix1.p1.9.m9.1.1"><ci id="S3.I1.ix1.p1.9.m9.1.1.1.cmml" xref="S3.I1.ix1.p1.9.m9.1.1.1">^</ci><ci id="S3.I1.ix1.p1.9.m9.1.1.2.cmml" xref="S3.I1.ix1.p1.9.m9.1.1.2">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix1.p1.9.m9.1c">\hat{u}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix1.p1.9.m9.1d">over^ start_ARG italic_u end_ARG</annotation></semantics></math>.
The primary objective is to deduce the policy and mapping <math alttext="c_{t}\rightarrow(g_{t},\mathcal{A}_{t})" class="ltx_Math" display="inline" id="S3.I1.ix1.p1.10.m10.2"><semantics id="S3.I1.ix1.p1.10.m10.2a"><mrow id="S3.I1.ix1.p1.10.m10.2.2" xref="S3.I1.ix1.p1.10.m10.2.2.cmml"><msub id="S3.I1.ix1.p1.10.m10.2.2.4" xref="S3.I1.ix1.p1.10.m10.2.2.4.cmml"><mi id="S3.I1.ix1.p1.10.m10.2.2.4.2" xref="S3.I1.ix1.p1.10.m10.2.2.4.2.cmml">c</mi><mi id="S3.I1.ix1.p1.10.m10.2.2.4.3" xref="S3.I1.ix1.p1.10.m10.2.2.4.3.cmml">t</mi></msub><mo id="S3.I1.ix1.p1.10.m10.2.2.3" stretchy="false" xref="S3.I1.ix1.p1.10.m10.2.2.3.cmml">→</mo><mrow id="S3.I1.ix1.p1.10.m10.2.2.2.2" xref="S3.I1.ix1.p1.10.m10.2.2.2.3.cmml"><mo id="S3.I1.ix1.p1.10.m10.2.2.2.2.3" stretchy="false" xref="S3.I1.ix1.p1.10.m10.2.2.2.3.cmml">(</mo><msub id="S3.I1.ix1.p1.10.m10.1.1.1.1.1" xref="S3.I1.ix1.p1.10.m10.1.1.1.1.1.cmml"><mi id="S3.I1.ix1.p1.10.m10.1.1.1.1.1.2" xref="S3.I1.ix1.p1.10.m10.1.1.1.1.1.2.cmml">g</mi><mi id="S3.I1.ix1.p1.10.m10.1.1.1.1.1.3" xref="S3.I1.ix1.p1.10.m10.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.I1.ix1.p1.10.m10.2.2.2.2.4" xref="S3.I1.ix1.p1.10.m10.2.2.2.3.cmml">,</mo><msub id="S3.I1.ix1.p1.10.m10.2.2.2.2.2" xref="S3.I1.ix1.p1.10.m10.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I1.ix1.p1.10.m10.2.2.2.2.2.2" xref="S3.I1.ix1.p1.10.m10.2.2.2.2.2.2.cmml">𝒜</mi><mi id="S3.I1.ix1.p1.10.m10.2.2.2.2.2.3" xref="S3.I1.ix1.p1.10.m10.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.I1.ix1.p1.10.m10.2.2.2.2.5" stretchy="false" xref="S3.I1.ix1.p1.10.m10.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.ix1.p1.10.m10.2b"><apply id="S3.I1.ix1.p1.10.m10.2.2.cmml" xref="S3.I1.ix1.p1.10.m10.2.2"><ci id="S3.I1.ix1.p1.10.m10.2.2.3.cmml" xref="S3.I1.ix1.p1.10.m10.2.2.3">→</ci><apply id="S3.I1.ix1.p1.10.m10.2.2.4.cmml" xref="S3.I1.ix1.p1.10.m10.2.2.4"><csymbol cd="ambiguous" id="S3.I1.ix1.p1.10.m10.2.2.4.1.cmml" xref="S3.I1.ix1.p1.10.m10.2.2.4">subscript</csymbol><ci id="S3.I1.ix1.p1.10.m10.2.2.4.2.cmml" xref="S3.I1.ix1.p1.10.m10.2.2.4.2">𝑐</ci><ci id="S3.I1.ix1.p1.10.m10.2.2.4.3.cmml" xref="S3.I1.ix1.p1.10.m10.2.2.4.3">𝑡</ci></apply><interval closure="open" id="S3.I1.ix1.p1.10.m10.2.2.2.3.cmml" xref="S3.I1.ix1.p1.10.m10.2.2.2.2"><apply id="S3.I1.ix1.p1.10.m10.1.1.1.1.1.cmml" xref="S3.I1.ix1.p1.10.m10.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.I1.ix1.p1.10.m10.1.1.1.1.1.1.cmml" xref="S3.I1.ix1.p1.10.m10.1.1.1.1.1">subscript</csymbol><ci id="S3.I1.ix1.p1.10.m10.1.1.1.1.1.2.cmml" xref="S3.I1.ix1.p1.10.m10.1.1.1.1.1.2">𝑔</ci><ci id="S3.I1.ix1.p1.10.m10.1.1.1.1.1.3.cmml" xref="S3.I1.ix1.p1.10.m10.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.I1.ix1.p1.10.m10.2.2.2.2.2.cmml" xref="S3.I1.ix1.p1.10.m10.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.I1.ix1.p1.10.m10.2.2.2.2.2.1.cmml" xref="S3.I1.ix1.p1.10.m10.2.2.2.2.2">subscript</csymbol><ci id="S3.I1.ix1.p1.10.m10.2.2.2.2.2.2.cmml" xref="S3.I1.ix1.p1.10.m10.2.2.2.2.2.2">𝒜</ci><ci id="S3.I1.ix1.p1.10.m10.2.2.2.2.2.3.cmml" xref="S3.I1.ix1.p1.10.m10.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix1.p1.10.m10.2c">c_{t}\rightarrow(g_{t},\mathcal{A}_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix1.p1.10.m10.2d">italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT → ( italic_g start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , caligraphic_A start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>.
As shown in the left of Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_tag">1</span></a>, within the context <math alttext="c_{t}" class="ltx_Math" display="inline" id="S3.I1.ix1.p1.11.m11.1"><semantics id="S3.I1.ix1.p1.11.m11.1a"><msub id="S3.I1.ix1.p1.11.m11.1.1" xref="S3.I1.ix1.p1.11.m11.1.1.cmml"><mi id="S3.I1.ix1.p1.11.m11.1.1.2" xref="S3.I1.ix1.p1.11.m11.1.1.2.cmml">c</mi><mi id="S3.I1.ix1.p1.11.m11.1.1.3" xref="S3.I1.ix1.p1.11.m11.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.ix1.p1.11.m11.1b"><apply id="S3.I1.ix1.p1.11.m11.1.1.cmml" xref="S3.I1.ix1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.I1.ix1.p1.11.m11.1.1.1.cmml" xref="S3.I1.ix1.p1.11.m11.1.1">subscript</csymbol><ci id="S3.I1.ix1.p1.11.m11.1.1.2.cmml" xref="S3.I1.ix1.p1.11.m11.1.1.2">𝑐</ci><ci id="S3.I1.ix1.p1.11.m11.1.1.3.cmml" xref="S3.I1.ix1.p1.11.m11.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix1.p1.11.m11.1c">c_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix1.p1.11.m11.1d">italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\hat{u}" class="ltx_Math" display="inline" id="S3.I1.ix1.p1.12.m12.1"><semantics id="S3.I1.ix1.p1.12.m12.1a"><mover accent="true" id="S3.I1.ix1.p1.12.m12.1.1" xref="S3.I1.ix1.p1.12.m12.1.1.cmml"><mi id="S3.I1.ix1.p1.12.m12.1.1.2" xref="S3.I1.ix1.p1.12.m12.1.1.2.cmml">u</mi><mo id="S3.I1.ix1.p1.12.m12.1.1.1" xref="S3.I1.ix1.p1.12.m12.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.I1.ix1.p1.12.m12.1b"><apply id="S3.I1.ix1.p1.12.m12.1.1.cmml" xref="S3.I1.ix1.p1.12.m12.1.1"><ci id="S3.I1.ix1.p1.12.m12.1.1.1.cmml" xref="S3.I1.ix1.p1.12.m12.1.1.1">^</ci><ci id="S3.I1.ix1.p1.12.m12.1.1.2.cmml" xref="S3.I1.ix1.p1.12.m12.1.1.2">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix1.p1.12.m12.1c">\hat{u}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix1.p1.12.m12.1d">over^ start_ARG italic_u end_ARG</annotation></semantics></math> observes a discrepancy in the movie actors between the retrieved movies and the user’s previous movies.
Consequently, it decides to rank the movie list based on their actors (i.e.,  <math alttext="\mathcal{A}_{t}" class="ltx_Math" display="inline" id="S3.I1.ix1.p1.13.m13.1"><semantics id="S3.I1.ix1.p1.13.m13.1a"><msub id="S3.I1.ix1.p1.13.m13.1.1" xref="S3.I1.ix1.p1.13.m13.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I1.ix1.p1.13.m13.1.1.2" xref="S3.I1.ix1.p1.13.m13.1.1.2.cmml">𝒜</mi><mi id="S3.I1.ix1.p1.13.m13.1.1.3" xref="S3.I1.ix1.p1.13.m13.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.ix1.p1.13.m13.1b"><apply id="S3.I1.ix1.p1.13.m13.1.1.cmml" xref="S3.I1.ix1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.I1.ix1.p1.13.m13.1.1.1.cmml" xref="S3.I1.ix1.p1.13.m13.1.1">subscript</csymbol><ci id="S3.I1.ix1.p1.13.m13.1.1.2.cmml" xref="S3.I1.ix1.p1.13.m13.1.1.2">𝒜</ci><ci id="S3.I1.ix1.p1.13.m13.1.1.3.cmml" xref="S3.I1.ix1.p1.13.m13.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix1.p1.13.m13.1c">\mathcal{A}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix1.p1.13.m13.1d">caligraphic_A start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>) and obtain <math alttext="o_{t}" class="ltx_Math" display="inline" id="S3.I1.ix1.p1.14.m14.1"><semantics id="S3.I1.ix1.p1.14.m14.1a"><msub id="S3.I1.ix1.p1.14.m14.1.1" xref="S3.I1.ix1.p1.14.m14.1.1.cmml"><mi id="S3.I1.ix1.p1.14.m14.1.1.2" xref="S3.I1.ix1.p1.14.m14.1.1.2.cmml">o</mi><mi id="S3.I1.ix1.p1.14.m14.1.1.3" xref="S3.I1.ix1.p1.14.m14.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.ix1.p1.14.m14.1b"><apply id="S3.I1.ix1.p1.14.m14.1.1.cmml" xref="S3.I1.ix1.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S3.I1.ix1.p1.14.m14.1.1.1.cmml" xref="S3.I1.ix1.p1.14.m14.1.1">subscript</csymbol><ci id="S3.I1.ix1.p1.14.m14.1.1.2.cmml" xref="S3.I1.ix1.p1.14.m14.1.1.2">𝑜</ci><ci id="S3.I1.ix1.p1.14.m14.1.1.3.cmml" xref="S3.I1.ix1.p1.14.m14.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix1.p1.14.m14.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix1.p1.14.m14.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. If <math alttext="\hat{u}" class="ltx_Math" display="inline" id="S3.I1.ix1.p1.15.m15.1"><semantics id="S3.I1.ix1.p1.15.m15.1a"><mover accent="true" id="S3.I1.ix1.p1.15.m15.1.1" xref="S3.I1.ix1.p1.15.m15.1.1.cmml"><mi id="S3.I1.ix1.p1.15.m15.1.1.2" xref="S3.I1.ix1.p1.15.m15.1.1.2.cmml">u</mi><mo id="S3.I1.ix1.p1.15.m15.1.1.1" xref="S3.I1.ix1.p1.15.m15.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.I1.ix1.p1.15.m15.1b"><apply id="S3.I1.ix1.p1.15.m15.1.1.cmml" xref="S3.I1.ix1.p1.15.m15.1.1"><ci id="S3.I1.ix1.p1.15.m15.1.1.1.cmml" xref="S3.I1.ix1.p1.15.m15.1.1.1">^</ci><ci id="S3.I1.ix1.p1.15.m15.1.1.2.cmml" xref="S3.I1.ix1.p1.15.m15.1.1.2">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix1.p1.15.m15.1c">\hat{u}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix1.p1.15.m15.1d">over^ start_ARG italic_u end_ARG</annotation></semantics></math> is satisfied within the context (i.e.,  <math alttext="c_{N}" class="ltx_Math" display="inline" id="S3.I1.ix1.p1.16.m16.1"><semantics id="S3.I1.ix1.p1.16.m16.1a"><msub id="S3.I1.ix1.p1.16.m16.1.1" xref="S3.I1.ix1.p1.16.m16.1.1.cmml"><mi id="S3.I1.ix1.p1.16.m16.1.1.2" xref="S3.I1.ix1.p1.16.m16.1.1.2.cmml">c</mi><mi id="S3.I1.ix1.p1.16.m16.1.1.3" xref="S3.I1.ix1.p1.16.m16.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.ix1.p1.16.m16.1b"><apply id="S3.I1.ix1.p1.16.m16.1.1.cmml" xref="S3.I1.ix1.p1.16.m16.1.1"><csymbol cd="ambiguous" id="S3.I1.ix1.p1.16.m16.1.1.1.cmml" xref="S3.I1.ix1.p1.16.m16.1.1">subscript</csymbol><ci id="S3.I1.ix1.p1.16.m16.1.1.2.cmml" xref="S3.I1.ix1.p1.16.m16.1.1.2">𝑐</ci><ci id="S3.I1.ix1.p1.16.m16.1.1.3.cmml" xref="S3.I1.ix1.p1.16.m16.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix1.p1.16.m16.1c">c_{N}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix1.p1.16.m16.1d">italic_c start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT</annotation></semantics></math>), by comparing the candidate items to the user’s history, then <math alttext="\hat{u}" class="ltx_Math" display="inline" id="S3.I1.ix1.p1.17.m17.1"><semantics id="S3.I1.ix1.p1.17.m17.1a"><mover accent="true" id="S3.I1.ix1.p1.17.m17.1.1" xref="S3.I1.ix1.p1.17.m17.1.1.cmml"><mi id="S3.I1.ix1.p1.17.m17.1.1.2" xref="S3.I1.ix1.p1.17.m17.1.1.2.cmml">u</mi><mo id="S3.I1.ix1.p1.17.m17.1.1.1" xref="S3.I1.ix1.p1.17.m17.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.I1.ix1.p1.17.m17.1b"><apply id="S3.I1.ix1.p1.17.m17.1.1.cmml" xref="S3.I1.ix1.p1.17.m17.1.1"><ci id="S3.I1.ix1.p1.17.m17.1.1.1.cmml" xref="S3.I1.ix1.p1.17.m17.1.1.1">^</ci><ci id="S3.I1.ix1.p1.17.m17.1.1.2.cmml" xref="S3.I1.ix1.p1.17.m17.1.1.2">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix1.p1.17.m17.1c">\hat{u}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix1.p1.17.m17.1d">over^ start_ARG italic_u end_ARG</annotation></semantics></math> will conclude the process and present the final set of candidate items, denoted as <math alttext="\mathcal{I}_{\hat{u}}" class="ltx_Math" display="inline" id="S3.I1.ix1.p1.18.m18.1"><semantics id="S3.I1.ix1.p1.18.m18.1a"><msub id="S3.I1.ix1.p1.18.m18.1.1" xref="S3.I1.ix1.p1.18.m18.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I1.ix1.p1.18.m18.1.1.2" xref="S3.I1.ix1.p1.18.m18.1.1.2.cmml">ℐ</mi><mover accent="true" id="S3.I1.ix1.p1.18.m18.1.1.3" xref="S3.I1.ix1.p1.18.m18.1.1.3.cmml"><mi id="S3.I1.ix1.p1.18.m18.1.1.3.2" xref="S3.I1.ix1.p1.18.m18.1.1.3.2.cmml">u</mi><mo id="S3.I1.ix1.p1.18.m18.1.1.3.1" xref="S3.I1.ix1.p1.18.m18.1.1.3.1.cmml">^</mo></mover></msub><annotation-xml encoding="MathML-Content" id="S3.I1.ix1.p1.18.m18.1b"><apply id="S3.I1.ix1.p1.18.m18.1.1.cmml" xref="S3.I1.ix1.p1.18.m18.1.1"><csymbol cd="ambiguous" id="S3.I1.ix1.p1.18.m18.1.1.1.cmml" xref="S3.I1.ix1.p1.18.m18.1.1">subscript</csymbol><ci id="S3.I1.ix1.p1.18.m18.1.1.2.cmml" xref="S3.I1.ix1.p1.18.m18.1.1.2">ℐ</ci><apply id="S3.I1.ix1.p1.18.m18.1.1.3.cmml" xref="S3.I1.ix1.p1.18.m18.1.1.3"><ci id="S3.I1.ix1.p1.18.m18.1.1.3.1.cmml" xref="S3.I1.ix1.p1.18.m18.1.1.3.1">^</ci><ci id="S3.I1.ix1.p1.18.m18.1.1.3.2.cmml" xref="S3.I1.ix1.p1.18.m18.1.1.3.2">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix1.p1.18.m18.1c">\mathcal{I}_{\hat{u}}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix1.p1.18.m18.1d">caligraphic_I start_POSTSUBSCRIPT over^ start_ARG italic_u end_ARG end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</dd>
<dt class="ltx_item" id="S3.I1.ix2"><span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S3.I1.ix2.1.1.1">Tool learning.: </span></span></dt>
<dd class="ltx_item">
<div class="ltx_para" id="S3.I1.ix2.p1">
<p class="ltx_p" id="S3.I1.ix2.p1.18">Tool learning technology refers to combine the strength of LLMs and specialized tools, as discussed in previous studies <cite class="ltx_cite ltx_citemacro_citep">(Qin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib31" title="">2023a</a>)</cite>.
Here, our tools are activated by the generated action <math alttext="\mathcal{A}_{t}" class="ltx_Math" display="inline" id="S3.I1.ix2.p1.1.m1.1"><semantics id="S3.I1.ix2.p1.1.m1.1a"><msub id="S3.I1.ix2.p1.1.m1.1.1" xref="S3.I1.ix2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I1.ix2.p1.1.m1.1.1.2" xref="S3.I1.ix2.p1.1.m1.1.1.2.cmml">𝒜</mi><mi id="S3.I1.ix2.p1.1.m1.1.1.3" xref="S3.I1.ix2.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.ix2.p1.1.m1.1b"><apply id="S3.I1.ix2.p1.1.m1.1.1.cmml" xref="S3.I1.ix2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I1.ix2.p1.1.m1.1.1.1.cmml" xref="S3.I1.ix2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.I1.ix2.p1.1.m1.1.1.2.cmml" xref="S3.I1.ix2.p1.1.m1.1.1.2">𝒜</ci><ci id="S3.I1.ix2.p1.1.m1.1.1.3.cmml" xref="S3.I1.ix2.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix2.p1.1.m1.1c">\mathcal{A}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix2.p1.1.m1.1d">caligraphic_A start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Schick et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib36" title="">2023</a>; Qin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib32" title="">2023b</a>; Yao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib56" title="">2023</a>)</cite>.
For each context <math alttext="c_{t}" class="ltx_Math" display="inline" id="S3.I1.ix2.p1.2.m2.1"><semantics id="S3.I1.ix2.p1.2.m2.1a"><msub id="S3.I1.ix2.p1.2.m2.1.1" xref="S3.I1.ix2.p1.2.m2.1.1.cmml"><mi id="S3.I1.ix2.p1.2.m2.1.1.2" xref="S3.I1.ix2.p1.2.m2.1.1.2.cmml">c</mi><mi id="S3.I1.ix2.p1.2.m2.1.1.3" xref="S3.I1.ix2.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.ix2.p1.2.m2.1b"><apply id="S3.I1.ix2.p1.2.m2.1.1.cmml" xref="S3.I1.ix2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.I1.ix2.p1.2.m2.1.1.1.cmml" xref="S3.I1.ix2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.I1.ix2.p1.2.m2.1.1.2.cmml" xref="S3.I1.ix2.p1.2.m2.1.1.2">𝑐</ci><ci id="S3.I1.ix2.p1.2.m2.1.1.3.cmml" xref="S3.I1.ix2.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix2.p1.2.m2.1c">c_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix2.p1.2.m2.1d">italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, the initial observation <math alttext="o_{0}=(\mathcal{H},\mathcal{T},\mathcal{D})" class="ltx_Math" display="inline" id="S3.I1.ix2.p1.3.m3.3"><semantics id="S3.I1.ix2.p1.3.m3.3a"><mrow id="S3.I1.ix2.p1.3.m3.3.4" xref="S3.I1.ix2.p1.3.m3.3.4.cmml"><msub id="S3.I1.ix2.p1.3.m3.3.4.2" xref="S3.I1.ix2.p1.3.m3.3.4.2.cmml"><mi id="S3.I1.ix2.p1.3.m3.3.4.2.2" xref="S3.I1.ix2.p1.3.m3.3.4.2.2.cmml">o</mi><mn id="S3.I1.ix2.p1.3.m3.3.4.2.3" xref="S3.I1.ix2.p1.3.m3.3.4.2.3.cmml">0</mn></msub><mo id="S3.I1.ix2.p1.3.m3.3.4.1" xref="S3.I1.ix2.p1.3.m3.3.4.1.cmml">=</mo><mrow id="S3.I1.ix2.p1.3.m3.3.4.3.2" xref="S3.I1.ix2.p1.3.m3.3.4.3.1.cmml"><mo id="S3.I1.ix2.p1.3.m3.3.4.3.2.1" stretchy="false" xref="S3.I1.ix2.p1.3.m3.3.4.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.I1.ix2.p1.3.m3.1.1" xref="S3.I1.ix2.p1.3.m3.1.1.cmml">ℋ</mi><mo id="S3.I1.ix2.p1.3.m3.3.4.3.2.2" xref="S3.I1.ix2.p1.3.m3.3.4.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.I1.ix2.p1.3.m3.2.2" xref="S3.I1.ix2.p1.3.m3.2.2.cmml">𝒯</mi><mo id="S3.I1.ix2.p1.3.m3.3.4.3.2.3" xref="S3.I1.ix2.p1.3.m3.3.4.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.I1.ix2.p1.3.m3.3.3" xref="S3.I1.ix2.p1.3.m3.3.3.cmml">𝒟</mi><mo id="S3.I1.ix2.p1.3.m3.3.4.3.2.4" stretchy="false" xref="S3.I1.ix2.p1.3.m3.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.ix2.p1.3.m3.3b"><apply id="S3.I1.ix2.p1.3.m3.3.4.cmml" xref="S3.I1.ix2.p1.3.m3.3.4"><eq id="S3.I1.ix2.p1.3.m3.3.4.1.cmml" xref="S3.I1.ix2.p1.3.m3.3.4.1"></eq><apply id="S3.I1.ix2.p1.3.m3.3.4.2.cmml" xref="S3.I1.ix2.p1.3.m3.3.4.2"><csymbol cd="ambiguous" id="S3.I1.ix2.p1.3.m3.3.4.2.1.cmml" xref="S3.I1.ix2.p1.3.m3.3.4.2">subscript</csymbol><ci id="S3.I1.ix2.p1.3.m3.3.4.2.2.cmml" xref="S3.I1.ix2.p1.3.m3.3.4.2.2">𝑜</ci><cn id="S3.I1.ix2.p1.3.m3.3.4.2.3.cmml" type="integer" xref="S3.I1.ix2.p1.3.m3.3.4.2.3">0</cn></apply><vector id="S3.I1.ix2.p1.3.m3.3.4.3.1.cmml" xref="S3.I1.ix2.p1.3.m3.3.4.3.2"><ci id="S3.I1.ix2.p1.3.m3.1.1.cmml" xref="S3.I1.ix2.p1.3.m3.1.1">ℋ</ci><ci id="S3.I1.ix2.p1.3.m3.2.2.cmml" xref="S3.I1.ix2.p1.3.m3.2.2">𝒯</ci><ci id="S3.I1.ix2.p1.3.m3.3.3.cmml" xref="S3.I1.ix2.p1.3.m3.3.3">𝒟</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix2.p1.3.m3.3c">o_{0}=(\mathcal{H},\mathcal{T},\mathcal{D})</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix2.p1.3.m3.3d">italic_o start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = ( caligraphic_H , caligraphic_T , caligraphic_D )</annotation></semantics></math> is composed of the user <math alttext="u" class="ltx_Math" display="inline" id="S3.I1.ix2.p1.4.m4.1"><semantics id="S3.I1.ix2.p1.4.m4.1a"><mi id="S3.I1.ix2.p1.4.m4.1.1" xref="S3.I1.ix2.p1.4.m4.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.I1.ix2.p1.4.m4.1b"><ci id="S3.I1.ix2.p1.4.m4.1.1.cmml" xref="S3.I1.ix2.p1.4.m4.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix2.p1.4.m4.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix2.p1.4.m4.1d">italic_u</annotation></semantics></math>’s historical interactions <math alttext="\mathcal{H}" class="ltx_Math" display="inline" id="S3.I1.ix2.p1.5.m5.1"><semantics id="S3.I1.ix2.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.I1.ix2.p1.5.m5.1.1" xref="S3.I1.ix2.p1.5.m5.1.1.cmml">ℋ</mi><annotation-xml encoding="MathML-Content" id="S3.I1.ix2.p1.5.m5.1b"><ci id="S3.I1.ix2.p1.5.m5.1.1.cmml" xref="S3.I1.ix2.p1.5.m5.1.1">ℋ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix2.p1.5.m5.1c">\mathcal{H}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix2.p1.5.m5.1d">caligraphic_H</annotation></semantics></math>, tool description <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S3.I1.ix2.p1.6.m6.1"><semantics id="S3.I1.ix2.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.I1.ix2.p1.6.m6.1.1" xref="S3.I1.ix2.p1.6.m6.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.I1.ix2.p1.6.m6.1b"><ci id="S3.I1.ix2.p1.6.m6.1.1.cmml" xref="S3.I1.ix2.p1.6.m6.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix2.p1.6.m6.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix2.p1.6.m6.1d">caligraphic_T</annotation></semantics></math>, and demonstration <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.I1.ix2.p1.7.m7.1"><semantics id="S3.I1.ix2.p1.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S3.I1.ix2.p1.7.m7.1.1" xref="S3.I1.ix2.p1.7.m7.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.I1.ix2.p1.7.m7.1b"><ci id="S3.I1.ix2.p1.7.m7.1.1.cmml" xref="S3.I1.ix2.p1.7.m7.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix2.p1.7.m7.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix2.p1.7.m7.1d">caligraphic_D</annotation></semantics></math>.
The tools can be categorized into two types based on <math alttext="\mathcal{T}_{type}" class="ltx_Math" display="inline" id="S3.I1.ix2.p1.8.m8.1"><semantics id="S3.I1.ix2.p1.8.m8.1a"><msub id="S3.I1.ix2.p1.8.m8.1.1" xref="S3.I1.ix2.p1.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I1.ix2.p1.8.m8.1.1.2" xref="S3.I1.ix2.p1.8.m8.1.1.2.cmml">𝒯</mi><mrow id="S3.I1.ix2.p1.8.m8.1.1.3" xref="S3.I1.ix2.p1.8.m8.1.1.3.cmml"><mi id="S3.I1.ix2.p1.8.m8.1.1.3.2" xref="S3.I1.ix2.p1.8.m8.1.1.3.2.cmml">t</mi><mo id="S3.I1.ix2.p1.8.m8.1.1.3.1" xref="S3.I1.ix2.p1.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S3.I1.ix2.p1.8.m8.1.1.3.3" xref="S3.I1.ix2.p1.8.m8.1.1.3.3.cmml">y</mi><mo id="S3.I1.ix2.p1.8.m8.1.1.3.1a" xref="S3.I1.ix2.p1.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S3.I1.ix2.p1.8.m8.1.1.3.4" xref="S3.I1.ix2.p1.8.m8.1.1.3.4.cmml">p</mi><mo id="S3.I1.ix2.p1.8.m8.1.1.3.1b" xref="S3.I1.ix2.p1.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S3.I1.ix2.p1.8.m8.1.1.3.5" xref="S3.I1.ix2.p1.8.m8.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.I1.ix2.p1.8.m8.1b"><apply id="S3.I1.ix2.p1.8.m8.1.1.cmml" xref="S3.I1.ix2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.I1.ix2.p1.8.m8.1.1.1.cmml" xref="S3.I1.ix2.p1.8.m8.1.1">subscript</csymbol><ci id="S3.I1.ix2.p1.8.m8.1.1.2.cmml" xref="S3.I1.ix2.p1.8.m8.1.1.2">𝒯</ci><apply id="S3.I1.ix2.p1.8.m8.1.1.3.cmml" xref="S3.I1.ix2.p1.8.m8.1.1.3"><times id="S3.I1.ix2.p1.8.m8.1.1.3.1.cmml" xref="S3.I1.ix2.p1.8.m8.1.1.3.1"></times><ci id="S3.I1.ix2.p1.8.m8.1.1.3.2.cmml" xref="S3.I1.ix2.p1.8.m8.1.1.3.2">𝑡</ci><ci id="S3.I1.ix2.p1.8.m8.1.1.3.3.cmml" xref="S3.I1.ix2.p1.8.m8.1.1.3.3">𝑦</ci><ci id="S3.I1.ix2.p1.8.m8.1.1.3.4.cmml" xref="S3.I1.ix2.p1.8.m8.1.1.3.4">𝑝</ci><ci id="S3.I1.ix2.p1.8.m8.1.1.3.5.cmml" xref="S3.I1.ix2.p1.8.m8.1.1.3.5">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix2.p1.8.m8.1c">\mathcal{T}_{type}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix2.p1.8.m8.1d">caligraphic_T start_POSTSUBSCRIPT italic_t italic_y italic_p italic_e end_POSTSUBSCRIPT</annotation></semantics></math>, which can be either “retrieve tools” or “rank tools.”
The description <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S3.I1.ix2.p1.9.m9.1"><semantics id="S3.I1.ix2.p1.9.m9.1a"><mi class="ltx_font_mathcaligraphic" id="S3.I1.ix2.p1.9.m9.1.1" xref="S3.I1.ix2.p1.9.m9.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.I1.ix2.p1.9.m9.1b"><ci id="S3.I1.ix2.p1.9.m9.1.1.cmml" xref="S3.I1.ix2.p1.9.m9.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix2.p1.9.m9.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix2.p1.9.m9.1d">caligraphic_T</annotation></semantics></math> elucidates the impact of using the tools, and <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.I1.ix2.p1.10.m10.1"><semantics id="S3.I1.ix2.p1.10.m10.1a"><mi class="ltx_font_mathcaligraphic" id="S3.I1.ix2.p1.10.m10.1.1" xref="S3.I1.ix2.p1.10.m10.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.I1.ix2.p1.10.m10.1b"><ci id="S3.I1.ix2.p1.10.m10.1.1.cmml" xref="S3.I1.ix2.p1.10.m10.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix2.p1.10.m10.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix2.p1.10.m10.1d">caligraphic_D</annotation></semantics></math> offers practical demonstrations of their application.
Together, these components promote the effective utilization of external tools.
Tool actions are formulated as <math alttext="\mathcal{T}_{type}[a_{t},\$K]" class="ltx_Math" display="inline" id="S3.I1.ix2.p1.11.m11.2"><semantics id="S3.I1.ix2.p1.11.m11.2a"><mrow id="S3.I1.ix2.p1.11.m11.2.2" xref="S3.I1.ix2.p1.11.m11.2.2.cmml"><msub id="S3.I1.ix2.p1.11.m11.2.2.4" xref="S3.I1.ix2.p1.11.m11.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I1.ix2.p1.11.m11.2.2.4.2" xref="S3.I1.ix2.p1.11.m11.2.2.4.2.cmml">𝒯</mi><mrow id="S3.I1.ix2.p1.11.m11.2.2.4.3" xref="S3.I1.ix2.p1.11.m11.2.2.4.3.cmml"><mi id="S3.I1.ix2.p1.11.m11.2.2.4.3.2" xref="S3.I1.ix2.p1.11.m11.2.2.4.3.2.cmml">t</mi><mo id="S3.I1.ix2.p1.11.m11.2.2.4.3.1" xref="S3.I1.ix2.p1.11.m11.2.2.4.3.1.cmml">⁢</mo><mi id="S3.I1.ix2.p1.11.m11.2.2.4.3.3" xref="S3.I1.ix2.p1.11.m11.2.2.4.3.3.cmml">y</mi><mo id="S3.I1.ix2.p1.11.m11.2.2.4.3.1a" xref="S3.I1.ix2.p1.11.m11.2.2.4.3.1.cmml">⁢</mo><mi id="S3.I1.ix2.p1.11.m11.2.2.4.3.4" xref="S3.I1.ix2.p1.11.m11.2.2.4.3.4.cmml">p</mi><mo id="S3.I1.ix2.p1.11.m11.2.2.4.3.1b" xref="S3.I1.ix2.p1.11.m11.2.2.4.3.1.cmml">⁢</mo><mi id="S3.I1.ix2.p1.11.m11.2.2.4.3.5" xref="S3.I1.ix2.p1.11.m11.2.2.4.3.5.cmml">e</mi></mrow></msub><mo id="S3.I1.ix2.p1.11.m11.2.2.3" xref="S3.I1.ix2.p1.11.m11.2.2.3.cmml">⁢</mo><mrow id="S3.I1.ix2.p1.11.m11.2.2.2.2" xref="S3.I1.ix2.p1.11.m11.2.2.2.3.cmml"><mo id="S3.I1.ix2.p1.11.m11.2.2.2.2.3" stretchy="false" xref="S3.I1.ix2.p1.11.m11.2.2.2.3.cmml">[</mo><msub id="S3.I1.ix2.p1.11.m11.1.1.1.1.1" xref="S3.I1.ix2.p1.11.m11.1.1.1.1.1.cmml"><mi id="S3.I1.ix2.p1.11.m11.1.1.1.1.1.2" xref="S3.I1.ix2.p1.11.m11.1.1.1.1.1.2.cmml">a</mi><mi id="S3.I1.ix2.p1.11.m11.1.1.1.1.1.3" xref="S3.I1.ix2.p1.11.m11.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.I1.ix2.p1.11.m11.2.2.2.2.4" xref="S3.I1.ix2.p1.11.m11.2.2.2.3.cmml">,</mo><mrow id="S3.I1.ix2.p1.11.m11.2.2.2.2.2" xref="S3.I1.ix2.p1.11.m11.2.2.2.2.2.cmml"><mo id="S3.I1.ix2.p1.11.m11.2.2.2.2.2.1" lspace="0em" rspace="0.167em" xref="S3.I1.ix2.p1.11.m11.2.2.2.2.2.1.cmml">$</mo><mi id="S3.I1.ix2.p1.11.m11.2.2.2.2.2.2" xref="S3.I1.ix2.p1.11.m11.2.2.2.2.2.2.cmml">K</mi></mrow><mo id="S3.I1.ix2.p1.11.m11.2.2.2.2.5" stretchy="false" xref="S3.I1.ix2.p1.11.m11.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.ix2.p1.11.m11.2b"><apply id="S3.I1.ix2.p1.11.m11.2.2.cmml" xref="S3.I1.ix2.p1.11.m11.2.2"><times id="S3.I1.ix2.p1.11.m11.2.2.3.cmml" xref="S3.I1.ix2.p1.11.m11.2.2.3"></times><apply id="S3.I1.ix2.p1.11.m11.2.2.4.cmml" xref="S3.I1.ix2.p1.11.m11.2.2.4"><csymbol cd="ambiguous" id="S3.I1.ix2.p1.11.m11.2.2.4.1.cmml" xref="S3.I1.ix2.p1.11.m11.2.2.4">subscript</csymbol><ci id="S3.I1.ix2.p1.11.m11.2.2.4.2.cmml" xref="S3.I1.ix2.p1.11.m11.2.2.4.2">𝒯</ci><apply id="S3.I1.ix2.p1.11.m11.2.2.4.3.cmml" xref="S3.I1.ix2.p1.11.m11.2.2.4.3"><times id="S3.I1.ix2.p1.11.m11.2.2.4.3.1.cmml" xref="S3.I1.ix2.p1.11.m11.2.2.4.3.1"></times><ci id="S3.I1.ix2.p1.11.m11.2.2.4.3.2.cmml" xref="S3.I1.ix2.p1.11.m11.2.2.4.3.2">𝑡</ci><ci id="S3.I1.ix2.p1.11.m11.2.2.4.3.3.cmml" xref="S3.I1.ix2.p1.11.m11.2.2.4.3.3">𝑦</ci><ci id="S3.I1.ix2.p1.11.m11.2.2.4.3.4.cmml" xref="S3.I1.ix2.p1.11.m11.2.2.4.3.4">𝑝</ci><ci id="S3.I1.ix2.p1.11.m11.2.2.4.3.5.cmml" xref="S3.I1.ix2.p1.11.m11.2.2.4.3.5">𝑒</ci></apply></apply><interval closure="closed" id="S3.I1.ix2.p1.11.m11.2.2.2.3.cmml" xref="S3.I1.ix2.p1.11.m11.2.2.2.2"><apply id="S3.I1.ix2.p1.11.m11.1.1.1.1.1.cmml" xref="S3.I1.ix2.p1.11.m11.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.I1.ix2.p1.11.m11.1.1.1.1.1.1.cmml" xref="S3.I1.ix2.p1.11.m11.1.1.1.1.1">subscript</csymbol><ci id="S3.I1.ix2.p1.11.m11.1.1.1.1.1.2.cmml" xref="S3.I1.ix2.p1.11.m11.1.1.1.1.1.2">𝑎</ci><ci id="S3.I1.ix2.p1.11.m11.1.1.1.1.1.3.cmml" xref="S3.I1.ix2.p1.11.m11.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.I1.ix2.p1.11.m11.2.2.2.2.2.cmml" xref="S3.I1.ix2.p1.11.m11.2.2.2.2.2"><csymbol cd="latexml" id="S3.I1.ix2.p1.11.m11.2.2.2.2.2.1.cmml" xref="S3.I1.ix2.p1.11.m11.2.2.2.2.2.1">currency-dollar</csymbol><ci id="S3.I1.ix2.p1.11.m11.2.2.2.2.2.2.cmml" xref="S3.I1.ix2.p1.11.m11.2.2.2.2.2.2">𝐾</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix2.p1.11.m11.2c">\mathcal{T}_{type}[a_{t},\$K]</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix2.p1.11.m11.2d">caligraphic_T start_POSTSUBSCRIPT italic_t italic_y italic_p italic_e end_POSTSUBSCRIPT [ italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , $ italic_K ]</annotation></semantics></math>, where <math alttext="\mathcal{T}_{type}\in\{Retrieval,Rank\}" class="ltx_Math" display="inline" id="S3.I1.ix2.p1.12.m12.2"><semantics id="S3.I1.ix2.p1.12.m12.2a"><mrow id="S3.I1.ix2.p1.12.m12.2.2" xref="S3.I1.ix2.p1.12.m12.2.2.cmml"><msub id="S3.I1.ix2.p1.12.m12.2.2.4" xref="S3.I1.ix2.p1.12.m12.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I1.ix2.p1.12.m12.2.2.4.2" xref="S3.I1.ix2.p1.12.m12.2.2.4.2.cmml">𝒯</mi><mrow id="S3.I1.ix2.p1.12.m12.2.2.4.3" xref="S3.I1.ix2.p1.12.m12.2.2.4.3.cmml"><mi id="S3.I1.ix2.p1.12.m12.2.2.4.3.2" xref="S3.I1.ix2.p1.12.m12.2.2.4.3.2.cmml">t</mi><mo id="S3.I1.ix2.p1.12.m12.2.2.4.3.1" xref="S3.I1.ix2.p1.12.m12.2.2.4.3.1.cmml">⁢</mo><mi id="S3.I1.ix2.p1.12.m12.2.2.4.3.3" xref="S3.I1.ix2.p1.12.m12.2.2.4.3.3.cmml">y</mi><mo id="S3.I1.ix2.p1.12.m12.2.2.4.3.1a" xref="S3.I1.ix2.p1.12.m12.2.2.4.3.1.cmml">⁢</mo><mi id="S3.I1.ix2.p1.12.m12.2.2.4.3.4" xref="S3.I1.ix2.p1.12.m12.2.2.4.3.4.cmml">p</mi><mo id="S3.I1.ix2.p1.12.m12.2.2.4.3.1b" xref="S3.I1.ix2.p1.12.m12.2.2.4.3.1.cmml">⁢</mo><mi id="S3.I1.ix2.p1.12.m12.2.2.4.3.5" xref="S3.I1.ix2.p1.12.m12.2.2.4.3.5.cmml">e</mi></mrow></msub><mo id="S3.I1.ix2.p1.12.m12.2.2.3" xref="S3.I1.ix2.p1.12.m12.2.2.3.cmml">∈</mo><mrow id="S3.I1.ix2.p1.12.m12.2.2.2.2" xref="S3.I1.ix2.p1.12.m12.2.2.2.3.cmml"><mo id="S3.I1.ix2.p1.12.m12.2.2.2.2.3" stretchy="false" xref="S3.I1.ix2.p1.12.m12.2.2.2.3.cmml">{</mo><mrow id="S3.I1.ix2.p1.12.m12.1.1.1.1.1" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.cmml"><mi id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.2" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.2.cmml">R</mi><mo id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.1" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.3" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.3.cmml">e</mi><mo id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.1a" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.4" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.4.cmml">t</mi><mo id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.1b" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.5" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.5.cmml">r</mi><mo id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.1c" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.6" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.6.cmml">i</mi><mo id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.1d" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.7" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.7.cmml">e</mi><mo id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.1e" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.8" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.8.cmml">v</mi><mo id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.1f" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.9" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.9.cmml">a</mi><mo id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.1g" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.10" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.10.cmml">l</mi></mrow><mo id="S3.I1.ix2.p1.12.m12.2.2.2.2.4" xref="S3.I1.ix2.p1.12.m12.2.2.2.3.cmml">,</mo><mrow id="S3.I1.ix2.p1.12.m12.2.2.2.2.2" xref="S3.I1.ix2.p1.12.m12.2.2.2.2.2.cmml"><mi id="S3.I1.ix2.p1.12.m12.2.2.2.2.2.2" xref="S3.I1.ix2.p1.12.m12.2.2.2.2.2.2.cmml">R</mi><mo id="S3.I1.ix2.p1.12.m12.2.2.2.2.2.1" xref="S3.I1.ix2.p1.12.m12.2.2.2.2.2.1.cmml">⁢</mo><mi id="S3.I1.ix2.p1.12.m12.2.2.2.2.2.3" xref="S3.I1.ix2.p1.12.m12.2.2.2.2.2.3.cmml">a</mi><mo id="S3.I1.ix2.p1.12.m12.2.2.2.2.2.1a" xref="S3.I1.ix2.p1.12.m12.2.2.2.2.2.1.cmml">⁢</mo><mi id="S3.I1.ix2.p1.12.m12.2.2.2.2.2.4" xref="S3.I1.ix2.p1.12.m12.2.2.2.2.2.4.cmml">n</mi><mo id="S3.I1.ix2.p1.12.m12.2.2.2.2.2.1b" xref="S3.I1.ix2.p1.12.m12.2.2.2.2.2.1.cmml">⁢</mo><mi id="S3.I1.ix2.p1.12.m12.2.2.2.2.2.5" xref="S3.I1.ix2.p1.12.m12.2.2.2.2.2.5.cmml">k</mi></mrow><mo id="S3.I1.ix2.p1.12.m12.2.2.2.2.5" stretchy="false" xref="S3.I1.ix2.p1.12.m12.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.ix2.p1.12.m12.2b"><apply id="S3.I1.ix2.p1.12.m12.2.2.cmml" xref="S3.I1.ix2.p1.12.m12.2.2"><in id="S3.I1.ix2.p1.12.m12.2.2.3.cmml" xref="S3.I1.ix2.p1.12.m12.2.2.3"></in><apply id="S3.I1.ix2.p1.12.m12.2.2.4.cmml" xref="S3.I1.ix2.p1.12.m12.2.2.4"><csymbol cd="ambiguous" id="S3.I1.ix2.p1.12.m12.2.2.4.1.cmml" xref="S3.I1.ix2.p1.12.m12.2.2.4">subscript</csymbol><ci id="S3.I1.ix2.p1.12.m12.2.2.4.2.cmml" xref="S3.I1.ix2.p1.12.m12.2.2.4.2">𝒯</ci><apply id="S3.I1.ix2.p1.12.m12.2.2.4.3.cmml" xref="S3.I1.ix2.p1.12.m12.2.2.4.3"><times id="S3.I1.ix2.p1.12.m12.2.2.4.3.1.cmml" xref="S3.I1.ix2.p1.12.m12.2.2.4.3.1"></times><ci id="S3.I1.ix2.p1.12.m12.2.2.4.3.2.cmml" xref="S3.I1.ix2.p1.12.m12.2.2.4.3.2">𝑡</ci><ci id="S3.I1.ix2.p1.12.m12.2.2.4.3.3.cmml" xref="S3.I1.ix2.p1.12.m12.2.2.4.3.3">𝑦</ci><ci id="S3.I1.ix2.p1.12.m12.2.2.4.3.4.cmml" xref="S3.I1.ix2.p1.12.m12.2.2.4.3.4">𝑝</ci><ci id="S3.I1.ix2.p1.12.m12.2.2.4.3.5.cmml" xref="S3.I1.ix2.p1.12.m12.2.2.4.3.5">𝑒</ci></apply></apply><set id="S3.I1.ix2.p1.12.m12.2.2.2.3.cmml" xref="S3.I1.ix2.p1.12.m12.2.2.2.2"><apply id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.cmml" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1"><times id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.1.cmml" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.1"></times><ci id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.2.cmml" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.2">𝑅</ci><ci id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.3.cmml" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.3">𝑒</ci><ci id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.4.cmml" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.4">𝑡</ci><ci id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.5.cmml" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.5">𝑟</ci><ci id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.6.cmml" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.6">𝑖</ci><ci id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.7.cmml" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.7">𝑒</ci><ci id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.8.cmml" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.8">𝑣</ci><ci id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.9.cmml" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.9">𝑎</ci><ci id="S3.I1.ix2.p1.12.m12.1.1.1.1.1.10.cmml" xref="S3.I1.ix2.p1.12.m12.1.1.1.1.1.10">𝑙</ci></apply><apply id="S3.I1.ix2.p1.12.m12.2.2.2.2.2.cmml" xref="S3.I1.ix2.p1.12.m12.2.2.2.2.2"><times id="S3.I1.ix2.p1.12.m12.2.2.2.2.2.1.cmml" xref="S3.I1.ix2.p1.12.m12.2.2.2.2.2.1"></times><ci id="S3.I1.ix2.p1.12.m12.2.2.2.2.2.2.cmml" xref="S3.I1.ix2.p1.12.m12.2.2.2.2.2.2">𝑅</ci><ci id="S3.I1.ix2.p1.12.m12.2.2.2.2.2.3.cmml" xref="S3.I1.ix2.p1.12.m12.2.2.2.2.2.3">𝑎</ci><ci id="S3.I1.ix2.p1.12.m12.2.2.2.2.2.4.cmml" xref="S3.I1.ix2.p1.12.m12.2.2.2.2.2.4">𝑛</ci><ci id="S3.I1.ix2.p1.12.m12.2.2.2.2.2.5.cmml" xref="S3.I1.ix2.p1.12.m12.2.2.2.2.2.5">𝑘</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix2.p1.12.m12.2c">\mathcal{T}_{type}\in\{Retrieval,Rank\}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix2.p1.12.m12.2d">caligraphic_T start_POSTSUBSCRIPT italic_t italic_y italic_p italic_e end_POSTSUBSCRIPT ∈ { italic_R italic_e italic_t italic_r italic_i italic_e italic_v italic_a italic_l , italic_R italic_a italic_n italic_k }</annotation></semantics></math>, <math alttext="a_{t}" class="ltx_Math" display="inline" id="S3.I1.ix2.p1.13.m13.1"><semantics id="S3.I1.ix2.p1.13.m13.1a"><msub id="S3.I1.ix2.p1.13.m13.1.1" xref="S3.I1.ix2.p1.13.m13.1.1.cmml"><mi id="S3.I1.ix2.p1.13.m13.1.1.2" xref="S3.I1.ix2.p1.13.m13.1.1.2.cmml">a</mi><mi id="S3.I1.ix2.p1.13.m13.1.1.3" xref="S3.I1.ix2.p1.13.m13.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.ix2.p1.13.m13.1b"><apply id="S3.I1.ix2.p1.13.m13.1.1.cmml" xref="S3.I1.ix2.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.I1.ix2.p1.13.m13.1.1.1.cmml" xref="S3.I1.ix2.p1.13.m13.1.1">subscript</csymbol><ci id="S3.I1.ix2.p1.13.m13.1.1.2.cmml" xref="S3.I1.ix2.p1.13.m13.1.1.2">𝑎</ci><ci id="S3.I1.ix2.p1.13.m13.1.1.3.cmml" xref="S3.I1.ix2.p1.13.m13.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix2.p1.13.m13.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix2.p1.13.m13.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> indicates the chosen attribute based on <math alttext="\hat{u}" class="ltx_Math" display="inline" id="S3.I1.ix2.p1.14.m14.1"><semantics id="S3.I1.ix2.p1.14.m14.1a"><mover accent="true" id="S3.I1.ix2.p1.14.m14.1.1" xref="S3.I1.ix2.p1.14.m14.1.1.cmml"><mi id="S3.I1.ix2.p1.14.m14.1.1.2" xref="S3.I1.ix2.p1.14.m14.1.1.2.cmml">u</mi><mo id="S3.I1.ix2.p1.14.m14.1.1.1" xref="S3.I1.ix2.p1.14.m14.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.I1.ix2.p1.14.m14.1b"><apply id="S3.I1.ix2.p1.14.m14.1.1.cmml" xref="S3.I1.ix2.p1.14.m14.1.1"><ci id="S3.I1.ix2.p1.14.m14.1.1.1.cmml" xref="S3.I1.ix2.p1.14.m14.1.1.1">^</ci><ci id="S3.I1.ix2.p1.14.m14.1.1.2.cmml" xref="S3.I1.ix2.p1.14.m14.1.1.2">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix2.p1.14.m14.1c">\hat{u}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix2.p1.14.m14.1d">over^ start_ARG italic_u end_ARG</annotation></semantics></math>’s decision at time <math alttext="t" class="ltx_Math" display="inline" id="S3.I1.ix2.p1.15.m15.1"><semantics id="S3.I1.ix2.p1.15.m15.1a"><mi id="S3.I1.ix2.p1.15.m15.1.1" xref="S3.I1.ix2.p1.15.m15.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.I1.ix2.p1.15.m15.1b"><ci id="S3.I1.ix2.p1.15.m15.1.1.cmml" xref="S3.I1.ix2.p1.15.m15.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix2.p1.15.m15.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix2.p1.15.m15.1d">italic_t</annotation></semantics></math>, and <math alttext="\$K" class="ltx_Math" display="inline" id="S3.I1.ix2.p1.16.m16.1"><semantics id="S3.I1.ix2.p1.16.m16.1a"><mrow id="S3.I1.ix2.p1.16.m16.1.1" xref="S3.I1.ix2.p1.16.m16.1.1.cmml"><mo id="S3.I1.ix2.p1.16.m16.1.1.1" rspace="0.167em" xref="S3.I1.ix2.p1.16.m16.1.1.1.cmml">$</mo><mi id="S3.I1.ix2.p1.16.m16.1.1.2" xref="S3.I1.ix2.p1.16.m16.1.1.2.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.ix2.p1.16.m16.1b"><apply id="S3.I1.ix2.p1.16.m16.1.1.cmml" xref="S3.I1.ix2.p1.16.m16.1.1"><csymbol cd="latexml" id="S3.I1.ix2.p1.16.m16.1.1.1.cmml" xref="S3.I1.ix2.p1.16.m16.1.1.1">currency-dollar</csymbol><ci id="S3.I1.ix2.p1.16.m16.1.1.2.cmml" xref="S3.I1.ix2.p1.16.m16.1.1.2">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix2.p1.16.m16.1c">\$K</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix2.p1.16.m16.1d">$ italic_K</annotation></semantics></math> specifies the number of items to be returned.
For instance, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_tag">1</span></a>, at the first step, <math alttext="\hat{u}" class="ltx_Math" display="inline" id="S3.I1.ix2.p1.17.m17.1"><semantics id="S3.I1.ix2.p1.17.m17.1a"><mover accent="true" id="S3.I1.ix2.p1.17.m17.1.1" xref="S3.I1.ix2.p1.17.m17.1.1.cmml"><mi id="S3.I1.ix2.p1.17.m17.1.1.2" xref="S3.I1.ix2.p1.17.m17.1.1.2.cmml">u</mi><mo id="S3.I1.ix2.p1.17.m17.1.1.1" xref="S3.I1.ix2.p1.17.m17.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.I1.ix2.p1.17.m17.1b"><apply id="S3.I1.ix2.p1.17.m17.1.1.cmml" xref="S3.I1.ix2.p1.17.m17.1.1"><ci id="S3.I1.ix2.p1.17.m17.1.1.1.cmml" xref="S3.I1.ix2.p1.17.m17.1.1.1">^</ci><ci id="S3.I1.ix2.p1.17.m17.1.1.2.cmml" xref="S3.I1.ix2.p1.17.m17.1.1.2">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix2.p1.17.m17.1c">\hat{u}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix2.p1.17.m17.1d">over^ start_ARG italic_u end_ARG</annotation></semantics></math> opts to use the retrieval tools conditioned on the attribute “genre” and retrieves 5 items. Meanwhile, at step 3, <math alttext="\hat{u}" class="ltx_Math" display="inline" id="S3.I1.ix2.p1.18.m18.1"><semantics id="S3.I1.ix2.p1.18.m18.1a"><mover accent="true" id="S3.I1.ix2.p1.18.m18.1.1" xref="S3.I1.ix2.p1.18.m18.1.1.cmml"><mi id="S3.I1.ix2.p1.18.m18.1.1.2" xref="S3.I1.ix2.p1.18.m18.1.1.2.cmml">u</mi><mo id="S3.I1.ix2.p1.18.m18.1.1.1" xref="S3.I1.ix2.p1.18.m18.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.I1.ix2.p1.18.m18.1b"><apply id="S3.I1.ix2.p1.18.m18.1.1.cmml" xref="S3.I1.ix2.p1.18.m18.1.1"><ci id="S3.I1.ix2.p1.18.m18.1.1.1.cmml" xref="S3.I1.ix2.p1.18.m18.1.1.1">^</ci><ci id="S3.I1.ix2.p1.18.m18.1.1.2.cmml" xref="S3.I1.ix2.p1.18.m18.1.1.2">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix2.p1.18.m18.1c">\hat{u}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix2.p1.18.m18.1d">over^ start_ARG italic_u end_ARG</annotation></semantics></math> decides to employ rank tools conditioned on the attribute “actor”, returning the top 4 items.
This phase is constructed to emulate a human-like approach of leveraging tools to broaden their choices through linguistic reasoning.</p>
</div>
</dd>
</dl>
<p class="ltx_p" id="S3.SS2.p2.3">The CoT prompting phase controls the iterative decision process, determining when to employ external tools or finalize the recommendations. Concurrently, feedback from these tools enhances item exploration and further refines the recommendation process.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Attribute-oriented Tools</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">By empowering an LLM to use tools, we can explore different parts of the item pool, uncovering target items that remain latent. To achieve this, we have designed two types of tools.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1. </span>Rank tools</h4>
<div class="ltx_para" id="S3.SS3.SSS1.p1">
<p class="ltx_p" id="S3.SS3.SSS1.p1.2">For attribute-oriented rank tools, we incorporate a ranking instruction template and employ LLMs to order the candidate items.
Given that LLMs have demonstrated proficiency in both zero-shot and few-shot scenarios <cite class="ltx_cite ltx_citemacro_citep">(Hou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib17" title="">2024</a>)</cite>, their capabilities are essential for returning item sets that align more closely with the user’s latent intent.
Our instruction for ranking is framed as: “{<span class="ltx_text ltx_font_italic" id="S3.SS3.SSS1.p1.2.1">User Historical Record</span>} {<span class="ltx_text ltx_font_italic" id="S3.SS3.SSS1.p1.2.2">Prior Retrieved Item Set</span>}. <span class="ltx_text ltx_font_italic" id="S3.SS3.SSS1.p1.2.3">Please rank the above recommended movies by measuring the possibilities that the user would like to watch next most according to the movie</span> [<span class="ltx_text ltx_font_italic" id="S3.SS3.SSS1.p1.2.4">Attribute Pattern</span> <math alttext="a_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.1.m1.1"><semantics id="S3.SS3.SSS1.p1.1.m1.1a"><msub id="S3.SS3.SSS1.p1.1.m1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.1.m1.1.1.2" xref="S3.SS3.SSS1.p1.1.m1.1.1.2.cmml">a</mi><mi id="S3.SS3.SSS1.p1.1.m1.1.1.3" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.1.m1.1b"><apply id="S3.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.2">𝑎</ci><ci id="S3.SS3.SSS1.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.1.m1.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.1.m1.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>] <span class="ltx_text ltx_font_italic" id="S3.SS3.SSS1.p1.2.5">attribute and the given movie history records, and output top</span> [<span class="ltx_text ltx_font_italic" id="S3.SS3.SSS1.p1.2.6">Output Size Pattern</span> <math alttext="\$K" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.2.m2.1"><semantics id="S3.SS3.SSS1.p1.2.m2.1a"><mrow id="S3.SS3.SSS1.p1.2.m2.1.1" xref="S3.SS3.SSS1.p1.2.m2.1.1.cmml"><mo id="S3.SS3.SSS1.p1.2.m2.1.1.1" rspace="0.167em" xref="S3.SS3.SSS1.p1.2.m2.1.1.1.cmml">$</mo><mi id="S3.SS3.SSS1.p1.2.m2.1.1.2" xref="S3.SS3.SSS1.p1.2.m2.1.1.2.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.2.m2.1b"><apply id="S3.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1"><csymbol cd="latexml" id="S3.SS3.SSS1.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.1">currency-dollar</csymbol><ci id="S3.SS3.SSS1.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.2">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.2.m2.1c">\$K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.2.m2.1d">$ italic_K</annotation></semantics></math>] <span class="ltx_text ltx_font_italic" id="S3.SS3.SSS1.p1.2.7">movies except user’s historical movies</span>.”</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.2. </span>Retrieval tools</h4>
<div class="ltx_para" id="S3.SS3.SSS2.p1">
<p class="ltx_p" id="S3.SS3.SSS2.p1.2">For each user, our attribute-oriented retrieval tools accept an attribute pattern <math alttext="a_{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.1.m1.1"><semantics id="S3.SS3.SSS2.p1.1.m1.1a"><msub id="S3.SS3.SSS2.p1.1.m1.1.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS2.p1.1.m1.1.1.2" xref="S3.SS3.SSS2.p1.1.m1.1.1.2.cmml">a</mi><mi id="S3.SS3.SSS2.p1.1.m1.1.1.3" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.1.m1.1b"><apply id="S3.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.2">𝑎</ci><ci id="S3.SS3.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.1.m1.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.1.m1.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and a specified item set size <math alttext="\$K" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.2.m2.1"><semantics id="S3.SS3.SSS2.p1.2.m2.1a"><mrow id="S3.SS3.SSS2.p1.2.m2.1.1" xref="S3.SS3.SSS2.p1.2.m2.1.1.cmml"><mo id="S3.SS3.SSS2.p1.2.m2.1.1.1" rspace="0.167em" xref="S3.SS3.SSS2.p1.2.m2.1.1.1.cmml">$</mo><mi id="S3.SS3.SSS2.p1.2.m2.1.1.2" xref="S3.SS3.SSS2.p1.2.m2.1.1.2.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.2.m2.1b"><apply id="S3.SS3.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1"><csymbol cd="latexml" id="S3.SS3.SSS2.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1.1">currency-dollar</csymbol><ci id="S3.SS3.SSS2.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1.2">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.2.m2.1c">\$K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.2.m2.1d">$ italic_K</annotation></semantics></math>, subsequently returning the matching candidate item set. An intuitive way is creating dedicated models tailored to each attribute pattern. However, it is markedly inefficient to fully train and store separate models for every possible attribute permutation. To address this, we introduce a two-stage method for managing attribute-specific variations:</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS2.p2">
<dl class="ltx_description" id="S3.I2">
<dt class="ltx_item" id="S3.I2.ix1"><span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S3.I2.ix1.1.1.1">Pre-training.: </span></span></dt>
<dd class="ltx_item">
<div class="ltx_para" id="S3.I2.ix1.p1">
<p class="ltx_p" id="S3.I2.ix1.p1.9">The pre-training stage is for the original model with no attribute-specific consideration. Without loss of generality, we incorporate the attribute-specific switches into the popular sequential recommendation model, SASRec <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib23" title="">2018</a>)</cite>.
For a historical behavior sequence <math alttext="\mathcal{H}" class="ltx_Math" display="inline" id="S3.I2.ix1.p1.1.m1.1"><semantics id="S3.I2.ix1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.I2.ix1.p1.1.m1.1.1" xref="S3.I2.ix1.p1.1.m1.1.1.cmml">ℋ</mi><annotation-xml encoding="MathML-Content" id="S3.I2.ix1.p1.1.m1.1b"><ci id="S3.I2.ix1.p1.1.m1.1.1.cmml" xref="S3.I2.ix1.p1.1.m1.1.1">ℋ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.ix1.p1.1.m1.1c">\mathcal{H}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.ix1.p1.1.m1.1d">caligraphic_H</annotation></semantics></math>, the <math alttext="l" class="ltx_Math" display="inline" id="S3.I2.ix1.p1.2.m2.1"><semantics id="S3.I2.ix1.p1.2.m2.1a"><mi id="S3.I2.ix1.p1.2.m2.1.1" xref="S3.I2.ix1.p1.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.I2.ix1.p1.2.m2.1b"><ci id="S3.I2.ix1.p1.2.m2.1.1.cmml" xref="S3.I2.ix1.p1.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.ix1.p1.2.m2.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.I2.ix1.p1.2.m2.1d">italic_l</annotation></semantics></math>-th layer behavior representation matrix is denoted as <math alttext="\mathbf{H}^{l}=\{\mathbf{h}_{1}^{l},\mathbf{h}_{2}^{l},\ldots,\mathbf{h}_{|%
\mathcal{H}|}^{l}\}" class="ltx_Math" display="inline" id="S3.I2.ix1.p1.3.m3.5"><semantics id="S3.I2.ix1.p1.3.m3.5a"><mrow id="S3.I2.ix1.p1.3.m3.5.5" xref="S3.I2.ix1.p1.3.m3.5.5.cmml"><msup id="S3.I2.ix1.p1.3.m3.5.5.5" xref="S3.I2.ix1.p1.3.m3.5.5.5.cmml"><mi id="S3.I2.ix1.p1.3.m3.5.5.5.2" xref="S3.I2.ix1.p1.3.m3.5.5.5.2.cmml">𝐇</mi><mi id="S3.I2.ix1.p1.3.m3.5.5.5.3" xref="S3.I2.ix1.p1.3.m3.5.5.5.3.cmml">l</mi></msup><mo id="S3.I2.ix1.p1.3.m3.5.5.4" xref="S3.I2.ix1.p1.3.m3.5.5.4.cmml">=</mo><mrow id="S3.I2.ix1.p1.3.m3.5.5.3.3" xref="S3.I2.ix1.p1.3.m3.5.5.3.4.cmml"><mo id="S3.I2.ix1.p1.3.m3.5.5.3.3.4" stretchy="false" xref="S3.I2.ix1.p1.3.m3.5.5.3.4.cmml">{</mo><msubsup id="S3.I2.ix1.p1.3.m3.3.3.1.1.1" xref="S3.I2.ix1.p1.3.m3.3.3.1.1.1.cmml"><mi id="S3.I2.ix1.p1.3.m3.3.3.1.1.1.2.2" xref="S3.I2.ix1.p1.3.m3.3.3.1.1.1.2.2.cmml">𝐡</mi><mn id="S3.I2.ix1.p1.3.m3.3.3.1.1.1.2.3" xref="S3.I2.ix1.p1.3.m3.3.3.1.1.1.2.3.cmml">1</mn><mi id="S3.I2.ix1.p1.3.m3.3.3.1.1.1.3" xref="S3.I2.ix1.p1.3.m3.3.3.1.1.1.3.cmml">l</mi></msubsup><mo id="S3.I2.ix1.p1.3.m3.5.5.3.3.5" xref="S3.I2.ix1.p1.3.m3.5.5.3.4.cmml">,</mo><msubsup id="S3.I2.ix1.p1.3.m3.4.4.2.2.2" xref="S3.I2.ix1.p1.3.m3.4.4.2.2.2.cmml"><mi id="S3.I2.ix1.p1.3.m3.4.4.2.2.2.2.2" xref="S3.I2.ix1.p1.3.m3.4.4.2.2.2.2.2.cmml">𝐡</mi><mn id="S3.I2.ix1.p1.3.m3.4.4.2.2.2.2.3" xref="S3.I2.ix1.p1.3.m3.4.4.2.2.2.2.3.cmml">2</mn><mi id="S3.I2.ix1.p1.3.m3.4.4.2.2.2.3" xref="S3.I2.ix1.p1.3.m3.4.4.2.2.2.3.cmml">l</mi></msubsup><mo id="S3.I2.ix1.p1.3.m3.5.5.3.3.6" xref="S3.I2.ix1.p1.3.m3.5.5.3.4.cmml">,</mo><mi id="S3.I2.ix1.p1.3.m3.2.2" mathvariant="normal" xref="S3.I2.ix1.p1.3.m3.2.2.cmml">…</mi><mo id="S3.I2.ix1.p1.3.m3.5.5.3.3.7" xref="S3.I2.ix1.p1.3.m3.5.5.3.4.cmml">,</mo><msubsup id="S3.I2.ix1.p1.3.m3.5.5.3.3.3" xref="S3.I2.ix1.p1.3.m3.5.5.3.3.3.cmml"><mi id="S3.I2.ix1.p1.3.m3.5.5.3.3.3.2.2" xref="S3.I2.ix1.p1.3.m3.5.5.3.3.3.2.2.cmml">𝐡</mi><mrow id="S3.I2.ix1.p1.3.m3.1.1.1.3" xref="S3.I2.ix1.p1.3.m3.1.1.1.2.cmml"><mo id="S3.I2.ix1.p1.3.m3.1.1.1.3.1" stretchy="false" xref="S3.I2.ix1.p1.3.m3.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.I2.ix1.p1.3.m3.1.1.1.1" xref="S3.I2.ix1.p1.3.m3.1.1.1.1.cmml">ℋ</mi><mo id="S3.I2.ix1.p1.3.m3.1.1.1.3.2" stretchy="false" xref="S3.I2.ix1.p1.3.m3.1.1.1.2.1.cmml">|</mo></mrow><mi id="S3.I2.ix1.p1.3.m3.5.5.3.3.3.3" xref="S3.I2.ix1.p1.3.m3.5.5.3.3.3.3.cmml">l</mi></msubsup><mo id="S3.I2.ix1.p1.3.m3.5.5.3.3.8" stretchy="false" xref="S3.I2.ix1.p1.3.m3.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.ix1.p1.3.m3.5b"><apply id="S3.I2.ix1.p1.3.m3.5.5.cmml" xref="S3.I2.ix1.p1.3.m3.5.5"><eq id="S3.I2.ix1.p1.3.m3.5.5.4.cmml" xref="S3.I2.ix1.p1.3.m3.5.5.4"></eq><apply id="S3.I2.ix1.p1.3.m3.5.5.5.cmml" xref="S3.I2.ix1.p1.3.m3.5.5.5"><csymbol cd="ambiguous" id="S3.I2.ix1.p1.3.m3.5.5.5.1.cmml" xref="S3.I2.ix1.p1.3.m3.5.5.5">superscript</csymbol><ci id="S3.I2.ix1.p1.3.m3.5.5.5.2.cmml" xref="S3.I2.ix1.p1.3.m3.5.5.5.2">𝐇</ci><ci id="S3.I2.ix1.p1.3.m3.5.5.5.3.cmml" xref="S3.I2.ix1.p1.3.m3.5.5.5.3">𝑙</ci></apply><set id="S3.I2.ix1.p1.3.m3.5.5.3.4.cmml" xref="S3.I2.ix1.p1.3.m3.5.5.3.3"><apply id="S3.I2.ix1.p1.3.m3.3.3.1.1.1.cmml" xref="S3.I2.ix1.p1.3.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.I2.ix1.p1.3.m3.3.3.1.1.1.1.cmml" xref="S3.I2.ix1.p1.3.m3.3.3.1.1.1">superscript</csymbol><apply id="S3.I2.ix1.p1.3.m3.3.3.1.1.1.2.cmml" xref="S3.I2.ix1.p1.3.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.I2.ix1.p1.3.m3.3.3.1.1.1.2.1.cmml" xref="S3.I2.ix1.p1.3.m3.3.3.1.1.1">subscript</csymbol><ci id="S3.I2.ix1.p1.3.m3.3.3.1.1.1.2.2.cmml" xref="S3.I2.ix1.p1.3.m3.3.3.1.1.1.2.2">𝐡</ci><cn id="S3.I2.ix1.p1.3.m3.3.3.1.1.1.2.3.cmml" type="integer" xref="S3.I2.ix1.p1.3.m3.3.3.1.1.1.2.3">1</cn></apply><ci id="S3.I2.ix1.p1.3.m3.3.3.1.1.1.3.cmml" xref="S3.I2.ix1.p1.3.m3.3.3.1.1.1.3">𝑙</ci></apply><apply id="S3.I2.ix1.p1.3.m3.4.4.2.2.2.cmml" xref="S3.I2.ix1.p1.3.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.I2.ix1.p1.3.m3.4.4.2.2.2.1.cmml" xref="S3.I2.ix1.p1.3.m3.4.4.2.2.2">superscript</csymbol><apply id="S3.I2.ix1.p1.3.m3.4.4.2.2.2.2.cmml" xref="S3.I2.ix1.p1.3.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.I2.ix1.p1.3.m3.4.4.2.2.2.2.1.cmml" xref="S3.I2.ix1.p1.3.m3.4.4.2.2.2">subscript</csymbol><ci id="S3.I2.ix1.p1.3.m3.4.4.2.2.2.2.2.cmml" xref="S3.I2.ix1.p1.3.m3.4.4.2.2.2.2.2">𝐡</ci><cn id="S3.I2.ix1.p1.3.m3.4.4.2.2.2.2.3.cmml" type="integer" xref="S3.I2.ix1.p1.3.m3.4.4.2.2.2.2.3">2</cn></apply><ci id="S3.I2.ix1.p1.3.m3.4.4.2.2.2.3.cmml" xref="S3.I2.ix1.p1.3.m3.4.4.2.2.2.3">𝑙</ci></apply><ci id="S3.I2.ix1.p1.3.m3.2.2.cmml" xref="S3.I2.ix1.p1.3.m3.2.2">…</ci><apply id="S3.I2.ix1.p1.3.m3.5.5.3.3.3.cmml" xref="S3.I2.ix1.p1.3.m3.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.I2.ix1.p1.3.m3.5.5.3.3.3.1.cmml" xref="S3.I2.ix1.p1.3.m3.5.5.3.3.3">superscript</csymbol><apply id="S3.I2.ix1.p1.3.m3.5.5.3.3.3.2.cmml" xref="S3.I2.ix1.p1.3.m3.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.I2.ix1.p1.3.m3.5.5.3.3.3.2.1.cmml" xref="S3.I2.ix1.p1.3.m3.5.5.3.3.3">subscript</csymbol><ci id="S3.I2.ix1.p1.3.m3.5.5.3.3.3.2.2.cmml" xref="S3.I2.ix1.p1.3.m3.5.5.3.3.3.2.2">𝐡</ci><apply id="S3.I2.ix1.p1.3.m3.1.1.1.2.cmml" xref="S3.I2.ix1.p1.3.m3.1.1.1.3"><abs id="S3.I2.ix1.p1.3.m3.1.1.1.2.1.cmml" xref="S3.I2.ix1.p1.3.m3.1.1.1.3.1"></abs><ci id="S3.I2.ix1.p1.3.m3.1.1.1.1.cmml" xref="S3.I2.ix1.p1.3.m3.1.1.1.1">ℋ</ci></apply></apply><ci id="S3.I2.ix1.p1.3.m3.5.5.3.3.3.3.cmml" xref="S3.I2.ix1.p1.3.m3.5.5.3.3.3.3">𝑙</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.ix1.p1.3.m3.5c">\mathbf{H}^{l}=\{\mathbf{h}_{1}^{l},\mathbf{h}_{2}^{l},\ldots,\mathbf{h}_{|%
\mathcal{H}|}^{l}\}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.ix1.p1.3.m3.5d">bold_H start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT = { bold_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT , bold_h start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT , … , bold_h start_POSTSUBSCRIPT | caligraphic_H | end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT }</annotation></semantics></math>, where <math alttext="\mathbf{h}_{i}^{l}" class="ltx_Math" display="inline" id="S3.I2.ix1.p1.4.m4.1"><semantics id="S3.I2.ix1.p1.4.m4.1a"><msubsup id="S3.I2.ix1.p1.4.m4.1.1" xref="S3.I2.ix1.p1.4.m4.1.1.cmml"><mi id="S3.I2.ix1.p1.4.m4.1.1.2.2" xref="S3.I2.ix1.p1.4.m4.1.1.2.2.cmml">𝐡</mi><mi id="S3.I2.ix1.p1.4.m4.1.1.2.3" xref="S3.I2.ix1.p1.4.m4.1.1.2.3.cmml">i</mi><mi id="S3.I2.ix1.p1.4.m4.1.1.3" xref="S3.I2.ix1.p1.4.m4.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.I2.ix1.p1.4.m4.1b"><apply id="S3.I2.ix1.p1.4.m4.1.1.cmml" xref="S3.I2.ix1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.I2.ix1.p1.4.m4.1.1.1.cmml" xref="S3.I2.ix1.p1.4.m4.1.1">superscript</csymbol><apply id="S3.I2.ix1.p1.4.m4.1.1.2.cmml" xref="S3.I2.ix1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.I2.ix1.p1.4.m4.1.1.2.1.cmml" xref="S3.I2.ix1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.I2.ix1.p1.4.m4.1.1.2.2.cmml" xref="S3.I2.ix1.p1.4.m4.1.1.2.2">𝐡</ci><ci id="S3.I2.ix1.p1.4.m4.1.1.2.3.cmml" xref="S3.I2.ix1.p1.4.m4.1.1.2.3">𝑖</ci></apply><ci id="S3.I2.ix1.p1.4.m4.1.1.3.cmml" xref="S3.I2.ix1.p1.4.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.ix1.p1.4.m4.1c">\mathbf{h}_{i}^{l}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.ix1.p1.4.m4.1d">bold_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> is the <math alttext="l" class="ltx_Math" display="inline" id="S3.I2.ix1.p1.5.m5.1"><semantics id="S3.I2.ix1.p1.5.m5.1a"><mi id="S3.I2.ix1.p1.5.m5.1.1" xref="S3.I2.ix1.p1.5.m5.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.I2.ix1.p1.5.m5.1b"><ci id="S3.I2.ix1.p1.5.m5.1.1.cmml" xref="S3.I2.ix1.p1.5.m5.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.ix1.p1.5.m5.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.I2.ix1.p1.5.m5.1d">italic_l</annotation></semantics></math>-th layer’s representation of the <math alttext="i" class="ltx_Math" display="inline" id="S3.I2.ix1.p1.6.m6.1"><semantics id="S3.I2.ix1.p1.6.m6.1a"><mi id="S3.I2.ix1.p1.6.m6.1.1" xref="S3.I2.ix1.p1.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.I2.ix1.p1.6.m6.1b"><ci id="S3.I2.ix1.p1.6.m6.1.1.cmml" xref="S3.I2.ix1.p1.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.ix1.p1.6.m6.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.I2.ix1.p1.6.m6.1d">italic_i</annotation></semantics></math>-th behavior within the sequence <math alttext="\mathcal{H}" class="ltx_Math" display="inline" id="S3.I2.ix1.p1.7.m7.1"><semantics id="S3.I2.ix1.p1.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S3.I2.ix1.p1.7.m7.1.1" xref="S3.I2.ix1.p1.7.m7.1.1.cmml">ℋ</mi><annotation-xml encoding="MathML-Content" id="S3.I2.ix1.p1.7.m7.1b"><ci id="S3.I2.ix1.p1.7.m7.1.1.cmml" xref="S3.I2.ix1.p1.7.m7.1.1">ℋ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.ix1.p1.7.m7.1c">\mathcal{H}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.ix1.p1.7.m7.1d">caligraphic_H</annotation></semantics></math>. Then in the final layer <math alttext="L" class="ltx_Math" display="inline" id="S3.I2.ix1.p1.8.m8.1"><semantics id="S3.I2.ix1.p1.8.m8.1a"><mi id="S3.I2.ix1.p1.8.m8.1.1" xref="S3.I2.ix1.p1.8.m8.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.I2.ix1.p1.8.m8.1b"><ci id="S3.I2.ix1.p1.8.m8.1.1.cmml" xref="S3.I2.ix1.p1.8.m8.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.ix1.p1.8.m8.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.I2.ix1.p1.8.m8.1d">italic_L</annotation></semantics></math>, the pre-training behavior representation <math alttext="\mathbf{H}" class="ltx_Math" display="inline" id="S3.I2.ix1.p1.9.m9.1"><semantics id="S3.I2.ix1.p1.9.m9.1a"><mi id="S3.I2.ix1.p1.9.m9.1.1" xref="S3.I2.ix1.p1.9.m9.1.1.cmml">𝐇</mi><annotation-xml encoding="MathML-Content" id="S3.I2.ix1.p1.9.m9.1b"><ci id="S3.I2.ix1.p1.9.m9.1.1.cmml" xref="S3.I2.ix1.p1.9.m9.1.1">𝐇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.ix1.p1.9.m9.1c">\mathbf{H}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.ix1.p1.9.m9.1d">bold_H</annotation></semantics></math> is derived:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{H}=f_{seq}(\mathcal{H}|\beta)=\mathbf{h}_{|\mathcal{H}|}^{L},\,\mathbf%
{H}^{l+1}=\text{Transformer}^{l}_{h}(\mathbf{H}^{l})," class="ltx_Math" display="block" id="S3.E1.m1.2"><semantics id="S3.E1.m1.2a"><mrow id="S3.E1.m1.2.2.1"><mrow id="S3.E1.m1.2.2.1.1.2" xref="S3.E1.m1.2.2.1.1.3.cmml"><mrow id="S3.E1.m1.2.2.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.cmml"><mi id="S3.E1.m1.2.2.1.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.1.3.cmml">𝐇</mi><mo id="S3.E1.m1.2.2.1.1.1.1.4" xref="S3.E1.m1.2.2.1.1.1.1.4.cmml">=</mo><mrow id="S3.E1.m1.2.2.1.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.1.cmml"><msub id="S3.E1.m1.2.2.1.1.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.2.2.1.1.1.1.1.3.2" xref="S3.E1.m1.2.2.1.1.1.1.1.3.2.cmml">f</mi><mrow id="S3.E1.m1.2.2.1.1.1.1.1.3.3" xref="S3.E1.m1.2.2.1.1.1.1.1.3.3.cmml"><mi id="S3.E1.m1.2.2.1.1.1.1.1.3.3.2" xref="S3.E1.m1.2.2.1.1.1.1.1.3.3.2.cmml">s</mi><mo id="S3.E1.m1.2.2.1.1.1.1.1.3.3.1" xref="S3.E1.m1.2.2.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E1.m1.2.2.1.1.1.1.1.3.3.3" xref="S3.E1.m1.2.2.1.1.1.1.1.3.3.3.cmml">e</mi><mo id="S3.E1.m1.2.2.1.1.1.1.1.3.3.1a" xref="S3.E1.m1.2.2.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E1.m1.2.2.1.1.1.1.1.3.3.4" xref="S3.E1.m1.2.2.1.1.1.1.1.3.3.4.cmml">q</mi></mrow></msub><mo id="S3.E1.m1.2.2.1.1.1.1.1.2" xref="S3.E1.m1.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.2.2.1.1.1.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">ℋ</mi><mo fence="false" id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">β</mi></mrow><mo id="S3.E1.m1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.2.2.1.1.1.1.5" xref="S3.E1.m1.2.2.1.1.1.1.5.cmml">=</mo><msubsup id="S3.E1.m1.2.2.1.1.1.1.6" xref="S3.E1.m1.2.2.1.1.1.1.6.cmml"><mi id="S3.E1.m1.2.2.1.1.1.1.6.2.2" xref="S3.E1.m1.2.2.1.1.1.1.6.2.2.cmml">𝐡</mi><mrow id="S3.E1.m1.1.1.1.3" xref="S3.E1.m1.1.1.1.2.cmml"><mo id="S3.E1.m1.1.1.1.3.1" stretchy="false" xref="S3.E1.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">ℋ</mi><mo id="S3.E1.m1.1.1.1.3.2" stretchy="false" xref="S3.E1.m1.1.1.1.2.1.cmml">|</mo></mrow><mi id="S3.E1.m1.2.2.1.1.1.1.6.3" xref="S3.E1.m1.2.2.1.1.1.1.6.3.cmml">L</mi></msubsup></mrow><mo id="S3.E1.m1.2.2.1.1.2.3" rspace="0.337em" xref="S3.E1.m1.2.2.1.1.3a.cmml">,</mo><mrow id="S3.E1.m1.2.2.1.1.2.2" xref="S3.E1.m1.2.2.1.1.2.2.cmml"><msup id="S3.E1.m1.2.2.1.1.2.2.3" xref="S3.E1.m1.2.2.1.1.2.2.3.cmml"><mi id="S3.E1.m1.2.2.1.1.2.2.3.2" xref="S3.E1.m1.2.2.1.1.2.2.3.2.cmml">𝐇</mi><mrow id="S3.E1.m1.2.2.1.1.2.2.3.3" xref="S3.E1.m1.2.2.1.1.2.2.3.3.cmml"><mi id="S3.E1.m1.2.2.1.1.2.2.3.3.2" xref="S3.E1.m1.2.2.1.1.2.2.3.3.2.cmml">l</mi><mo id="S3.E1.m1.2.2.1.1.2.2.3.3.1" xref="S3.E1.m1.2.2.1.1.2.2.3.3.1.cmml">+</mo><mn id="S3.E1.m1.2.2.1.1.2.2.3.3.3" xref="S3.E1.m1.2.2.1.1.2.2.3.3.3.cmml">1</mn></mrow></msup><mo id="S3.E1.m1.2.2.1.1.2.2.2" xref="S3.E1.m1.2.2.1.1.2.2.2.cmml">=</mo><mrow id="S3.E1.m1.2.2.1.1.2.2.1" xref="S3.E1.m1.2.2.1.1.2.2.1.cmml"><msubsup id="S3.E1.m1.2.2.1.1.2.2.1.3" xref="S3.E1.m1.2.2.1.1.2.2.1.3.cmml"><mtext id="S3.E1.m1.2.2.1.1.2.2.1.3.2.2" xref="S3.E1.m1.2.2.1.1.2.2.1.3.2.2a.cmml">Transformer</mtext><mi id="S3.E1.m1.2.2.1.1.2.2.1.3.3" xref="S3.E1.m1.2.2.1.1.2.2.1.3.3.cmml">h</mi><mi id="S3.E1.m1.2.2.1.1.2.2.1.3.2.3" xref="S3.E1.m1.2.2.1.1.2.2.1.3.2.3.cmml">l</mi></msubsup><mo id="S3.E1.m1.2.2.1.1.2.2.1.2" xref="S3.E1.m1.2.2.1.1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.2.2.1.1.2.2.1.1.1" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.1.cmml"><mo id="S3.E1.m1.2.2.1.1.2.2.1.1.1.2" stretchy="false" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.1.cmml">(</mo><msup id="S3.E1.m1.2.2.1.1.2.2.1.1.1.1" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.1.cmml"><mi id="S3.E1.m1.2.2.1.1.2.2.1.1.1.1.2" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.1.2.cmml">𝐇</mi><mi id="S3.E1.m1.2.2.1.1.2.2.1.1.1.1.3" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.1.3.cmml">l</mi></msup><mo id="S3.E1.m1.2.2.1.1.2.2.1.1.1.3" stretchy="false" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.2.2.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.2b"><apply id="S3.E1.m1.2.2.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.3a.cmml" xref="S3.E1.m1.2.2.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.2.2.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1"><and id="S3.E1.m1.2.2.1.1.1.1a.cmml" xref="S3.E1.m1.2.2.1.1.1.1"></and><apply id="S3.E1.m1.2.2.1.1.1.1b.cmml" xref="S3.E1.m1.2.2.1.1.1.1"><eq id="S3.E1.m1.2.2.1.1.1.1.4.cmml" xref="S3.E1.m1.2.2.1.1.1.1.4"></eq><ci id="S3.E1.m1.2.2.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.3">𝐇</ci><apply id="S3.E1.m1.2.2.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1"><times id="S3.E1.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.2"></times><apply id="S3.E1.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.3.2">𝑓</ci><apply id="S3.E1.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.3.3"><times id="S3.E1.m1.2.2.1.1.1.1.1.3.3.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.3.3.1"></times><ci id="S3.E1.m1.2.2.1.1.1.1.1.3.3.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.3.3.2">𝑠</ci><ci id="S3.E1.m1.2.2.1.1.1.1.1.3.3.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.3.3.3">𝑒</ci><ci id="S3.E1.m1.2.2.1.1.1.1.1.3.3.4.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.3.3.4">𝑞</ci></apply></apply><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.2">ℋ</ci><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3">𝛽</ci></apply></apply></apply><apply id="S3.E1.m1.2.2.1.1.1.1c.cmml" xref="S3.E1.m1.2.2.1.1.1.1"><eq id="S3.E1.m1.2.2.1.1.1.1.5.cmml" xref="S3.E1.m1.2.2.1.1.1.1.5"></eq><share href="https://arxiv.org/html/2405.15114v1#S3.E1.m1.2.2.1.1.1.1.1.cmml" id="S3.E1.m1.2.2.1.1.1.1d.cmml" xref="S3.E1.m1.2.2.1.1.1.1"></share><apply id="S3.E1.m1.2.2.1.1.1.1.6.cmml" xref="S3.E1.m1.2.2.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.6.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.6">superscript</csymbol><apply id="S3.E1.m1.2.2.1.1.1.1.6.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.6.2.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.6">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.1.6.2.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.6.2.2">𝐡</ci><apply id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.3"><abs id="S3.E1.m1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.3.1"></abs><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">ℋ</ci></apply></apply><ci id="S3.E1.m1.2.2.1.1.1.1.6.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.6.3">𝐿</ci></apply></apply></apply><apply id="S3.E1.m1.2.2.1.1.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2"><eq id="S3.E1.m1.2.2.1.1.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2"></eq><apply id="S3.E1.m1.2.2.1.1.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.2.2.3.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.3">superscript</csymbol><ci id="S3.E1.m1.2.2.1.1.2.2.3.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.3.2">𝐇</ci><apply id="S3.E1.m1.2.2.1.1.2.2.3.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.3.3"><plus id="S3.E1.m1.2.2.1.1.2.2.3.3.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.3.3.1"></plus><ci id="S3.E1.m1.2.2.1.1.2.2.3.3.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.3.3.2">𝑙</ci><cn id="S3.E1.m1.2.2.1.1.2.2.3.3.3.cmml" type="integer" xref="S3.E1.m1.2.2.1.1.2.2.3.3.3">1</cn></apply></apply><apply id="S3.E1.m1.2.2.1.1.2.2.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1"><times id="S3.E1.m1.2.2.1.1.2.2.1.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.2"></times><apply id="S3.E1.m1.2.2.1.1.2.2.1.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.2.2.1.3.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.3">subscript</csymbol><apply id="S3.E1.m1.2.2.1.1.2.2.1.3.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.2.2.1.3.2.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.3">superscript</csymbol><ci id="S3.E1.m1.2.2.1.1.2.2.1.3.2.2a.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.3.2.2"><mtext id="S3.E1.m1.2.2.1.1.2.2.1.3.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.3.2.2">Transformer</mtext></ci><ci id="S3.E1.m1.2.2.1.1.2.2.1.3.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.3.2.3">𝑙</ci></apply><ci id="S3.E1.m1.2.2.1.1.2.2.1.3.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.3.3">ℎ</ci></apply><apply id="S3.E1.m1.2.2.1.1.2.2.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1">superscript</csymbol><ci id="S3.E1.m1.2.2.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.1.2">𝐇</ci><ci id="S3.E1.m1.2.2.1.1.2.2.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.1.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.2c">\mathbf{H}=f_{seq}(\mathcal{H}|\beta)=\mathbf{h}_{|\mathcal{H}|}^{L},\,\mathbf%
{H}^{l+1}=\text{Transformer}^{l}_{h}(\mathbf{H}^{l}),</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.2d">bold_H = italic_f start_POSTSUBSCRIPT italic_s italic_e italic_q end_POSTSUBSCRIPT ( caligraphic_H | italic_β ) = bold_h start_POSTSUBSCRIPT | caligraphic_H | end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT , bold_H start_POSTSUPERSCRIPT italic_l + 1 end_POSTSUPERSCRIPT = Transformer start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ( bold_H start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.I2.ix1.p1.13">where <math alttext="f_{seq}" class="ltx_Math" display="inline" id="S3.I2.ix1.p1.10.m1.1"><semantics id="S3.I2.ix1.p1.10.m1.1a"><msub id="S3.I2.ix1.p1.10.m1.1.1" xref="S3.I2.ix1.p1.10.m1.1.1.cmml"><mi id="S3.I2.ix1.p1.10.m1.1.1.2" xref="S3.I2.ix1.p1.10.m1.1.1.2.cmml">f</mi><mrow id="S3.I2.ix1.p1.10.m1.1.1.3" xref="S3.I2.ix1.p1.10.m1.1.1.3.cmml"><mi id="S3.I2.ix1.p1.10.m1.1.1.3.2" xref="S3.I2.ix1.p1.10.m1.1.1.3.2.cmml">s</mi><mo id="S3.I2.ix1.p1.10.m1.1.1.3.1" xref="S3.I2.ix1.p1.10.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.I2.ix1.p1.10.m1.1.1.3.3" xref="S3.I2.ix1.p1.10.m1.1.1.3.3.cmml">e</mi><mo id="S3.I2.ix1.p1.10.m1.1.1.3.1a" xref="S3.I2.ix1.p1.10.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.I2.ix1.p1.10.m1.1.1.3.4" xref="S3.I2.ix1.p1.10.m1.1.1.3.4.cmml">q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.I2.ix1.p1.10.m1.1b"><apply id="S3.I2.ix1.p1.10.m1.1.1.cmml" xref="S3.I2.ix1.p1.10.m1.1.1"><csymbol cd="ambiguous" id="S3.I2.ix1.p1.10.m1.1.1.1.cmml" xref="S3.I2.ix1.p1.10.m1.1.1">subscript</csymbol><ci id="S3.I2.ix1.p1.10.m1.1.1.2.cmml" xref="S3.I2.ix1.p1.10.m1.1.1.2">𝑓</ci><apply id="S3.I2.ix1.p1.10.m1.1.1.3.cmml" xref="S3.I2.ix1.p1.10.m1.1.1.3"><times id="S3.I2.ix1.p1.10.m1.1.1.3.1.cmml" xref="S3.I2.ix1.p1.10.m1.1.1.3.1"></times><ci id="S3.I2.ix1.p1.10.m1.1.1.3.2.cmml" xref="S3.I2.ix1.p1.10.m1.1.1.3.2">𝑠</ci><ci id="S3.I2.ix1.p1.10.m1.1.1.3.3.cmml" xref="S3.I2.ix1.p1.10.m1.1.1.3.3">𝑒</ci><ci id="S3.I2.ix1.p1.10.m1.1.1.3.4.cmml" xref="S3.I2.ix1.p1.10.m1.1.1.3.4">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.ix1.p1.10.m1.1c">f_{seq}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.ix1.p1.10.m1.1d">italic_f start_POSTSUBSCRIPT italic_s italic_e italic_q end_POSTSUBSCRIPT</annotation></semantics></math> represents the sequential model, <math alttext="\beta" class="ltx_Math" display="inline" id="S3.I2.ix1.p1.11.m2.1"><semantics id="S3.I2.ix1.p1.11.m2.1a"><mi id="S3.I2.ix1.p1.11.m2.1.1" xref="S3.I2.ix1.p1.11.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.I2.ix1.p1.11.m2.1b"><ci id="S3.I2.ix1.p1.11.m2.1.1.cmml" xref="S3.I2.ix1.p1.11.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.ix1.p1.11.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.I2.ix1.p1.11.m2.1d">italic_β</annotation></semantics></math> is the pre-training parameter, <span class="ltx_text ltx_markedasmath" id="S3.I2.ix1.p1.13.1">Transformer</span> denotes the Transformer architecture encoder, and <math alttext="\mathbf{H}" class="ltx_Math" display="inline" id="S3.I2.ix1.p1.13.m4.1"><semantics id="S3.I2.ix1.p1.13.m4.1a"><mi id="S3.I2.ix1.p1.13.m4.1.1" xref="S3.I2.ix1.p1.13.m4.1.1.cmml">𝐇</mi><annotation-xml encoding="MathML-Content" id="S3.I2.ix1.p1.13.m4.1b"><ci id="S3.I2.ix1.p1.13.m4.1.1.cmml" xref="S3.I2.ix1.p1.13.m4.1.1">𝐇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.ix1.p1.13.m4.1c">\mathbf{H}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.ix1.p1.13.m4.1d">bold_H</annotation></semantics></math> is considered as the user representation at the pre-training phase for sequential recommendation.</p>
</div>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="376" id="S3.F3.g1" src="x4.png" width="829"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>Fine-tuning stage of attribute-oriented retrieval tools. The parameters in the blue ‘ice’ section remain fixed, while those in the red ‘flame’ section are exclusively fine-tuned.</figcaption>
</figure>
</dd>
<dt class="ltx_item" id="S3.I2.ix2"><span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S3.I2.ix2.1.1.1">Attribute-specific encoder in tuning.: </span></span></dt>
<dd class="ltx_item">
<div class="ltx_para" id="S3.I2.ix2.p1">
<p class="ltx_p" id="S3.I2.ix2.p1.8">As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S3.F3" title="Figure 3 ‣ item Pre-training. ‣ 3.3.2. Retrieval tools ‣ 3.3. Attribute-oriented Tools ‣ 3. Methodology ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_tag">3</span></a>, after learning the pretrained model, we freeze the pre-training parameter <math alttext="\beta" class="ltx_Math" display="inline" id="S3.I2.ix2.p1.1.m1.1"><semantics id="S3.I2.ix2.p1.1.m1.1a"><mi id="S3.I2.ix2.p1.1.m1.1.1" xref="S3.I2.ix2.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.I2.ix2.p1.1.m1.1b"><ci id="S3.I2.ix2.p1.1.m1.1.1.cmml" xref="S3.I2.ix2.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.ix2.p1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.I2.ix2.p1.1.m1.1d">italic_β</annotation></semantics></math>. Our goal is to fine-tune the attribute-specific encoder. To achieve this, we construct an additional attribute encoder <math alttext="f_{attr}" class="ltx_Math" display="inline" id="S3.I2.ix2.p1.2.m2.1"><semantics id="S3.I2.ix2.p1.2.m2.1a"><msub id="S3.I2.ix2.p1.2.m2.1.1" xref="S3.I2.ix2.p1.2.m2.1.1.cmml"><mi id="S3.I2.ix2.p1.2.m2.1.1.2" xref="S3.I2.ix2.p1.2.m2.1.1.2.cmml">f</mi><mrow id="S3.I2.ix2.p1.2.m2.1.1.3" xref="S3.I2.ix2.p1.2.m2.1.1.3.cmml"><mi id="S3.I2.ix2.p1.2.m2.1.1.3.2" xref="S3.I2.ix2.p1.2.m2.1.1.3.2.cmml">a</mi><mo id="S3.I2.ix2.p1.2.m2.1.1.3.1" xref="S3.I2.ix2.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.I2.ix2.p1.2.m2.1.1.3.3" xref="S3.I2.ix2.p1.2.m2.1.1.3.3.cmml">t</mi><mo id="S3.I2.ix2.p1.2.m2.1.1.3.1a" xref="S3.I2.ix2.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.I2.ix2.p1.2.m2.1.1.3.4" xref="S3.I2.ix2.p1.2.m2.1.1.3.4.cmml">t</mi><mo id="S3.I2.ix2.p1.2.m2.1.1.3.1b" xref="S3.I2.ix2.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.I2.ix2.p1.2.m2.1.1.3.5" xref="S3.I2.ix2.p1.2.m2.1.1.3.5.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.I2.ix2.p1.2.m2.1b"><apply id="S3.I2.ix2.p1.2.m2.1.1.cmml" xref="S3.I2.ix2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.I2.ix2.p1.2.m2.1.1.1.cmml" xref="S3.I2.ix2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.I2.ix2.p1.2.m2.1.1.2.cmml" xref="S3.I2.ix2.p1.2.m2.1.1.2">𝑓</ci><apply id="S3.I2.ix2.p1.2.m2.1.1.3.cmml" xref="S3.I2.ix2.p1.2.m2.1.1.3"><times id="S3.I2.ix2.p1.2.m2.1.1.3.1.cmml" xref="S3.I2.ix2.p1.2.m2.1.1.3.1"></times><ci id="S3.I2.ix2.p1.2.m2.1.1.3.2.cmml" xref="S3.I2.ix2.p1.2.m2.1.1.3.2">𝑎</ci><ci id="S3.I2.ix2.p1.2.m2.1.1.3.3.cmml" xref="S3.I2.ix2.p1.2.m2.1.1.3.3">𝑡</ci><ci id="S3.I2.ix2.p1.2.m2.1.1.3.4.cmml" xref="S3.I2.ix2.p1.2.m2.1.1.3.4">𝑡</ci><ci id="S3.I2.ix2.p1.2.m2.1.1.3.5.cmml" xref="S3.I2.ix2.p1.2.m2.1.1.3.5">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.ix2.p1.2.m2.1c">f_{attr}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.ix2.p1.2.m2.1d">italic_f start_POSTSUBSCRIPT italic_a italic_t italic_t italic_r end_POSTSUBSCRIPT</annotation></semantics></math>. This encoder takes the user’s historical item attribute sequence, <math alttext="a_{u}" class="ltx_Math" display="inline" id="S3.I2.ix2.p1.3.m3.1"><semantics id="S3.I2.ix2.p1.3.m3.1a"><msub id="S3.I2.ix2.p1.3.m3.1.1" xref="S3.I2.ix2.p1.3.m3.1.1.cmml"><mi id="S3.I2.ix2.p1.3.m3.1.1.2" xref="S3.I2.ix2.p1.3.m3.1.1.2.cmml">a</mi><mi id="S3.I2.ix2.p1.3.m3.1.1.3" xref="S3.I2.ix2.p1.3.m3.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I2.ix2.p1.3.m3.1b"><apply id="S3.I2.ix2.p1.3.m3.1.1.cmml" xref="S3.I2.ix2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.I2.ix2.p1.3.m3.1.1.1.cmml" xref="S3.I2.ix2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.I2.ix2.p1.3.m3.1.1.2.cmml" xref="S3.I2.ix2.p1.3.m3.1.1.2">𝑎</ci><ci id="S3.I2.ix2.p1.3.m3.1.1.3.cmml" xref="S3.I2.ix2.p1.3.m3.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.ix2.p1.3.m3.1c">a_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.ix2.p1.3.m3.1d">italic_a start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, as input. Importantly, <math alttext="\mathcal{H}" class="ltx_Math" display="inline" id="S3.I2.ix2.p1.4.m4.1"><semantics id="S3.I2.ix2.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.I2.ix2.p1.4.m4.1.1" xref="S3.I2.ix2.p1.4.m4.1.1.cmml">ℋ</mi><annotation-xml encoding="MathML-Content" id="S3.I2.ix2.p1.4.m4.1b"><ci id="S3.I2.ix2.p1.4.m4.1.1.cmml" xref="S3.I2.ix2.p1.4.m4.1.1">ℋ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.ix2.p1.4.m4.1c">\mathcal{H}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.ix2.p1.4.m4.1d">caligraphic_H</annotation></semantics></math> and <math alttext="a_{u}" class="ltx_Math" display="inline" id="S3.I2.ix2.p1.5.m5.1"><semantics id="S3.I2.ix2.p1.5.m5.1a"><msub id="S3.I2.ix2.p1.5.m5.1.1" xref="S3.I2.ix2.p1.5.m5.1.1.cmml"><mi id="S3.I2.ix2.p1.5.m5.1.1.2" xref="S3.I2.ix2.p1.5.m5.1.1.2.cmml">a</mi><mi id="S3.I2.ix2.p1.5.m5.1.1.3" xref="S3.I2.ix2.p1.5.m5.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I2.ix2.p1.5.m5.1b"><apply id="S3.I2.ix2.p1.5.m5.1.1.cmml" xref="S3.I2.ix2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.I2.ix2.p1.5.m5.1.1.1.cmml" xref="S3.I2.ix2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.I2.ix2.p1.5.m5.1.1.2.cmml" xref="S3.I2.ix2.p1.5.m5.1.1.2">𝑎</ci><ci id="S3.I2.ix2.p1.5.m5.1.1.3.cmml" xref="S3.I2.ix2.p1.5.m5.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.ix2.p1.5.m5.1c">a_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.ix2.p1.5.m5.1d">italic_a start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> are aligned based on items in the historical sequence. Subsequently, we define the <math alttext="l" class="ltx_Math" display="inline" id="S3.I2.ix2.p1.6.m6.1"><semantics id="S3.I2.ix2.p1.6.m6.1a"><mi id="S3.I2.ix2.p1.6.m6.1.1" xref="S3.I2.ix2.p1.6.m6.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.I2.ix2.p1.6.m6.1b"><ci id="S3.I2.ix2.p1.6.m6.1.1.cmml" xref="S3.I2.ix2.p1.6.m6.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.ix2.p1.6.m6.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.I2.ix2.p1.6.m6.1d">italic_l</annotation></semantics></math>-th layer attribute representation matrix as <math alttext="\bm{a}_{u}^{l}=\{\bm{a}_{1}^{l},\bm{a}_{2}^{l},\cdots,\bm{a}_{|a_{u}|}^{l}\}" class="ltx_Math" display="inline" id="S3.I2.ix2.p1.7.m7.5"><semantics id="S3.I2.ix2.p1.7.m7.5a"><mrow id="S3.I2.ix2.p1.7.m7.5.5" xref="S3.I2.ix2.p1.7.m7.5.5.cmml"><msubsup id="S3.I2.ix2.p1.7.m7.5.5.5" xref="S3.I2.ix2.p1.7.m7.5.5.5.cmml"><mi id="S3.I2.ix2.p1.7.m7.5.5.5.2.2" xref="S3.I2.ix2.p1.7.m7.5.5.5.2.2.cmml">𝒂</mi><mi id="S3.I2.ix2.p1.7.m7.5.5.5.2.3" xref="S3.I2.ix2.p1.7.m7.5.5.5.2.3.cmml">u</mi><mi id="S3.I2.ix2.p1.7.m7.5.5.5.3" xref="S3.I2.ix2.p1.7.m7.5.5.5.3.cmml">l</mi></msubsup><mo id="S3.I2.ix2.p1.7.m7.5.5.4" xref="S3.I2.ix2.p1.7.m7.5.5.4.cmml">=</mo><mrow id="S3.I2.ix2.p1.7.m7.5.5.3.3" xref="S3.I2.ix2.p1.7.m7.5.5.3.4.cmml"><mo id="S3.I2.ix2.p1.7.m7.5.5.3.3.4" stretchy="false" xref="S3.I2.ix2.p1.7.m7.5.5.3.4.cmml">{</mo><msubsup id="S3.I2.ix2.p1.7.m7.3.3.1.1.1" xref="S3.I2.ix2.p1.7.m7.3.3.1.1.1.cmml"><mi id="S3.I2.ix2.p1.7.m7.3.3.1.1.1.2.2" xref="S3.I2.ix2.p1.7.m7.3.3.1.1.1.2.2.cmml">𝒂</mi><mn id="S3.I2.ix2.p1.7.m7.3.3.1.1.1.2.3" xref="S3.I2.ix2.p1.7.m7.3.3.1.1.1.2.3.cmml">1</mn><mi id="S3.I2.ix2.p1.7.m7.3.3.1.1.1.3" xref="S3.I2.ix2.p1.7.m7.3.3.1.1.1.3.cmml">l</mi></msubsup><mo id="S3.I2.ix2.p1.7.m7.5.5.3.3.5" xref="S3.I2.ix2.p1.7.m7.5.5.3.4.cmml">,</mo><msubsup id="S3.I2.ix2.p1.7.m7.4.4.2.2.2" xref="S3.I2.ix2.p1.7.m7.4.4.2.2.2.cmml"><mi id="S3.I2.ix2.p1.7.m7.4.4.2.2.2.2.2" xref="S3.I2.ix2.p1.7.m7.4.4.2.2.2.2.2.cmml">𝒂</mi><mn id="S3.I2.ix2.p1.7.m7.4.4.2.2.2.2.3" xref="S3.I2.ix2.p1.7.m7.4.4.2.2.2.2.3.cmml">2</mn><mi id="S3.I2.ix2.p1.7.m7.4.4.2.2.2.3" xref="S3.I2.ix2.p1.7.m7.4.4.2.2.2.3.cmml">l</mi></msubsup><mo id="S3.I2.ix2.p1.7.m7.5.5.3.3.6" xref="S3.I2.ix2.p1.7.m7.5.5.3.4.cmml">,</mo><mi id="S3.I2.ix2.p1.7.m7.2.2" mathvariant="normal" xref="S3.I2.ix2.p1.7.m7.2.2.cmml">⋯</mi><mo id="S3.I2.ix2.p1.7.m7.5.5.3.3.7" xref="S3.I2.ix2.p1.7.m7.5.5.3.4.cmml">,</mo><msubsup id="S3.I2.ix2.p1.7.m7.5.5.3.3.3" xref="S3.I2.ix2.p1.7.m7.5.5.3.3.3.cmml"><mi id="S3.I2.ix2.p1.7.m7.5.5.3.3.3.2.2" xref="S3.I2.ix2.p1.7.m7.5.5.3.3.3.2.2.cmml">𝒂</mi><mrow id="S3.I2.ix2.p1.7.m7.1.1.1.1" xref="S3.I2.ix2.p1.7.m7.1.1.1.2.cmml"><mo id="S3.I2.ix2.p1.7.m7.1.1.1.1.2" stretchy="false" xref="S3.I2.ix2.p1.7.m7.1.1.1.2.1.cmml">|</mo><msub id="S3.I2.ix2.p1.7.m7.1.1.1.1.1" xref="S3.I2.ix2.p1.7.m7.1.1.1.1.1.cmml"><mi id="S3.I2.ix2.p1.7.m7.1.1.1.1.1.2" xref="S3.I2.ix2.p1.7.m7.1.1.1.1.1.2.cmml">a</mi><mi id="S3.I2.ix2.p1.7.m7.1.1.1.1.1.3" xref="S3.I2.ix2.p1.7.m7.1.1.1.1.1.3.cmml">u</mi></msub><mo id="S3.I2.ix2.p1.7.m7.1.1.1.1.3" stretchy="false" xref="S3.I2.ix2.p1.7.m7.1.1.1.2.1.cmml">|</mo></mrow><mi id="S3.I2.ix2.p1.7.m7.5.5.3.3.3.3" xref="S3.I2.ix2.p1.7.m7.5.5.3.3.3.3.cmml">l</mi></msubsup><mo id="S3.I2.ix2.p1.7.m7.5.5.3.3.8" stretchy="false" xref="S3.I2.ix2.p1.7.m7.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.ix2.p1.7.m7.5b"><apply id="S3.I2.ix2.p1.7.m7.5.5.cmml" xref="S3.I2.ix2.p1.7.m7.5.5"><eq id="S3.I2.ix2.p1.7.m7.5.5.4.cmml" xref="S3.I2.ix2.p1.7.m7.5.5.4"></eq><apply id="S3.I2.ix2.p1.7.m7.5.5.5.cmml" xref="S3.I2.ix2.p1.7.m7.5.5.5"><csymbol cd="ambiguous" id="S3.I2.ix2.p1.7.m7.5.5.5.1.cmml" xref="S3.I2.ix2.p1.7.m7.5.5.5">superscript</csymbol><apply id="S3.I2.ix2.p1.7.m7.5.5.5.2.cmml" xref="S3.I2.ix2.p1.7.m7.5.5.5"><csymbol cd="ambiguous" id="S3.I2.ix2.p1.7.m7.5.5.5.2.1.cmml" xref="S3.I2.ix2.p1.7.m7.5.5.5">subscript</csymbol><ci id="S3.I2.ix2.p1.7.m7.5.5.5.2.2.cmml" xref="S3.I2.ix2.p1.7.m7.5.5.5.2.2">𝒂</ci><ci id="S3.I2.ix2.p1.7.m7.5.5.5.2.3.cmml" xref="S3.I2.ix2.p1.7.m7.5.5.5.2.3">𝑢</ci></apply><ci id="S3.I2.ix2.p1.7.m7.5.5.5.3.cmml" xref="S3.I2.ix2.p1.7.m7.5.5.5.3">𝑙</ci></apply><set id="S3.I2.ix2.p1.7.m7.5.5.3.4.cmml" xref="S3.I2.ix2.p1.7.m7.5.5.3.3"><apply id="S3.I2.ix2.p1.7.m7.3.3.1.1.1.cmml" xref="S3.I2.ix2.p1.7.m7.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.I2.ix2.p1.7.m7.3.3.1.1.1.1.cmml" xref="S3.I2.ix2.p1.7.m7.3.3.1.1.1">superscript</csymbol><apply id="S3.I2.ix2.p1.7.m7.3.3.1.1.1.2.cmml" xref="S3.I2.ix2.p1.7.m7.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.I2.ix2.p1.7.m7.3.3.1.1.1.2.1.cmml" xref="S3.I2.ix2.p1.7.m7.3.3.1.1.1">subscript</csymbol><ci id="S3.I2.ix2.p1.7.m7.3.3.1.1.1.2.2.cmml" xref="S3.I2.ix2.p1.7.m7.3.3.1.1.1.2.2">𝒂</ci><cn id="S3.I2.ix2.p1.7.m7.3.3.1.1.1.2.3.cmml" type="integer" xref="S3.I2.ix2.p1.7.m7.3.3.1.1.1.2.3">1</cn></apply><ci id="S3.I2.ix2.p1.7.m7.3.3.1.1.1.3.cmml" xref="S3.I2.ix2.p1.7.m7.3.3.1.1.1.3">𝑙</ci></apply><apply id="S3.I2.ix2.p1.7.m7.4.4.2.2.2.cmml" xref="S3.I2.ix2.p1.7.m7.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.I2.ix2.p1.7.m7.4.4.2.2.2.1.cmml" xref="S3.I2.ix2.p1.7.m7.4.4.2.2.2">superscript</csymbol><apply id="S3.I2.ix2.p1.7.m7.4.4.2.2.2.2.cmml" xref="S3.I2.ix2.p1.7.m7.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.I2.ix2.p1.7.m7.4.4.2.2.2.2.1.cmml" xref="S3.I2.ix2.p1.7.m7.4.4.2.2.2">subscript</csymbol><ci id="S3.I2.ix2.p1.7.m7.4.4.2.2.2.2.2.cmml" xref="S3.I2.ix2.p1.7.m7.4.4.2.2.2.2.2">𝒂</ci><cn id="S3.I2.ix2.p1.7.m7.4.4.2.2.2.2.3.cmml" type="integer" xref="S3.I2.ix2.p1.7.m7.4.4.2.2.2.2.3">2</cn></apply><ci id="S3.I2.ix2.p1.7.m7.4.4.2.2.2.3.cmml" xref="S3.I2.ix2.p1.7.m7.4.4.2.2.2.3">𝑙</ci></apply><ci id="S3.I2.ix2.p1.7.m7.2.2.cmml" xref="S3.I2.ix2.p1.7.m7.2.2">⋯</ci><apply id="S3.I2.ix2.p1.7.m7.5.5.3.3.3.cmml" xref="S3.I2.ix2.p1.7.m7.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.I2.ix2.p1.7.m7.5.5.3.3.3.1.cmml" xref="S3.I2.ix2.p1.7.m7.5.5.3.3.3">superscript</csymbol><apply id="S3.I2.ix2.p1.7.m7.5.5.3.3.3.2.cmml" xref="S3.I2.ix2.p1.7.m7.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.I2.ix2.p1.7.m7.5.5.3.3.3.2.1.cmml" xref="S3.I2.ix2.p1.7.m7.5.5.3.3.3">subscript</csymbol><ci id="S3.I2.ix2.p1.7.m7.5.5.3.3.3.2.2.cmml" xref="S3.I2.ix2.p1.7.m7.5.5.3.3.3.2.2">𝒂</ci><apply id="S3.I2.ix2.p1.7.m7.1.1.1.2.cmml" xref="S3.I2.ix2.p1.7.m7.1.1.1.1"><abs id="S3.I2.ix2.p1.7.m7.1.1.1.2.1.cmml" xref="S3.I2.ix2.p1.7.m7.1.1.1.1.2"></abs><apply id="S3.I2.ix2.p1.7.m7.1.1.1.1.1.cmml" xref="S3.I2.ix2.p1.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.I2.ix2.p1.7.m7.1.1.1.1.1.1.cmml" xref="S3.I2.ix2.p1.7.m7.1.1.1.1.1">subscript</csymbol><ci id="S3.I2.ix2.p1.7.m7.1.1.1.1.1.2.cmml" xref="S3.I2.ix2.p1.7.m7.1.1.1.1.1.2">𝑎</ci><ci id="S3.I2.ix2.p1.7.m7.1.1.1.1.1.3.cmml" xref="S3.I2.ix2.p1.7.m7.1.1.1.1.1.3">𝑢</ci></apply></apply></apply><ci id="S3.I2.ix2.p1.7.m7.5.5.3.3.3.3.cmml" xref="S3.I2.ix2.p1.7.m7.5.5.3.3.3.3">𝑙</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.ix2.p1.7.m7.5c">\bm{a}_{u}^{l}=\{\bm{a}_{1}^{l},\bm{a}_{2}^{l},\cdots,\bm{a}_{|a_{u}|}^{l}\}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.ix2.p1.7.m7.5d">bold_italic_a start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT = { bold_italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT , bold_italic_a start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT , ⋯ , bold_italic_a start_POSTSUBSCRIPT | italic_a start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT | end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT }</annotation></semantics></math>. Similar to the pre-training approach, the attribute sequence representation <math alttext="\bm{a}_{u}" class="ltx_Math" display="inline" id="S3.I2.ix2.p1.8.m8.1"><semantics id="S3.I2.ix2.p1.8.m8.1a"><msub id="S3.I2.ix2.p1.8.m8.1.1" xref="S3.I2.ix2.p1.8.m8.1.1.cmml"><mi id="S3.I2.ix2.p1.8.m8.1.1.2" xref="S3.I2.ix2.p1.8.m8.1.1.2.cmml">𝒂</mi><mi id="S3.I2.ix2.p1.8.m8.1.1.3" xref="S3.I2.ix2.p1.8.m8.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I2.ix2.p1.8.m8.1b"><apply id="S3.I2.ix2.p1.8.m8.1.1.cmml" xref="S3.I2.ix2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.I2.ix2.p1.8.m8.1.1.1.cmml" xref="S3.I2.ix2.p1.8.m8.1.1">subscript</csymbol><ci id="S3.I2.ix2.p1.8.m8.1.1.2.cmml" xref="S3.I2.ix2.p1.8.m8.1.1.2">𝒂</ci><ci id="S3.I2.ix2.p1.8.m8.1.1.3.cmml" xref="S3.I2.ix2.p1.8.m8.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.ix2.p1.8.m8.1c">\bm{a}_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.ix2.p1.8.m8.1d">bold_italic_a start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> is learned as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\bm{a}_{u}=f_{attr}(a_{u}|\gamma)=\bm{a}_{|a_{u}|}^{L},\,\bm{a}_{u}^{l+1}=%
\text{Transformer}^{l}_{a}(\bm{a}_{u}^{l})." class="ltx_Math" display="block" id="S3.E2.m1.2"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2.1"><mrow id="S3.E2.m1.2.2.1.1.2" xref="S3.E2.m1.2.2.1.1.3.cmml"><mrow id="S3.E2.m1.2.2.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.cmml"><msub id="S3.E2.m1.2.2.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.3.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.3.2" xref="S3.E2.m1.2.2.1.1.1.1.3.2.cmml">𝒂</mi><mi id="S3.E2.m1.2.2.1.1.1.1.3.3" xref="S3.E2.m1.2.2.1.1.1.1.3.3.cmml">u</mi></msub><mo id="S3.E2.m1.2.2.1.1.1.1.4" xref="S3.E2.m1.2.2.1.1.1.1.4.cmml">=</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.cmml"><msub id="S3.E2.m1.2.2.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.3.2" xref="S3.E2.m1.2.2.1.1.1.1.1.3.2.cmml">f</mi><mrow id="S3.E2.m1.2.2.1.1.1.1.1.3.3" xref="S3.E2.m1.2.2.1.1.1.1.1.3.3.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.3.3.2" xref="S3.E2.m1.2.2.1.1.1.1.1.3.3.2.cmml">a</mi><mo id="S3.E2.m1.2.2.1.1.1.1.1.3.3.1" xref="S3.E2.m1.2.2.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E2.m1.2.2.1.1.1.1.1.3.3.3" xref="S3.E2.m1.2.2.1.1.1.1.1.3.3.3.cmml">t</mi><mo id="S3.E2.m1.2.2.1.1.1.1.1.3.3.1a" xref="S3.E2.m1.2.2.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E2.m1.2.2.1.1.1.1.1.3.3.4" xref="S3.E2.m1.2.2.1.1.1.1.1.3.3.4.cmml">t</mi><mo id="S3.E2.m1.2.2.1.1.1.1.1.3.3.1b" xref="S3.E2.m1.2.2.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E2.m1.2.2.1.1.1.1.1.3.3.5" xref="S3.E2.m1.2.2.1.1.1.1.1.3.3.5.cmml">r</mi></mrow></msub><mo id="S3.E2.m1.2.2.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">a</mi><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">u</mi></msub><mo fence="false" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">γ</mi></mrow><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.2.2.1.1.1.1.5" xref="S3.E2.m1.2.2.1.1.1.1.5.cmml">=</mo><msubsup id="S3.E2.m1.2.2.1.1.1.1.6" xref="S3.E2.m1.2.2.1.1.1.1.6.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.6.2.2" xref="S3.E2.m1.2.2.1.1.1.1.6.2.2.cmml">𝒂</mi><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.2.cmml"><mo id="S3.E2.m1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.1.1.1.2.1.cmml">|</mo><msub id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.2.cmml">a</mi><mi id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.3.cmml">u</mi></msub><mo id="S3.E2.m1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.1.1.1.2.1.cmml">|</mo></mrow><mi id="S3.E2.m1.2.2.1.1.1.1.6.3" xref="S3.E2.m1.2.2.1.1.1.1.6.3.cmml">L</mi></msubsup></mrow><mo id="S3.E2.m1.2.2.1.1.2.3" rspace="0.337em" xref="S3.E2.m1.2.2.1.1.3a.cmml">,</mo><mrow id="S3.E2.m1.2.2.1.1.2.2" xref="S3.E2.m1.2.2.1.1.2.2.cmml"><msubsup id="S3.E2.m1.2.2.1.1.2.2.3" xref="S3.E2.m1.2.2.1.1.2.2.3.cmml"><mi id="S3.E2.m1.2.2.1.1.2.2.3.2.2" xref="S3.E2.m1.2.2.1.1.2.2.3.2.2.cmml">𝒂</mi><mi id="S3.E2.m1.2.2.1.1.2.2.3.2.3" xref="S3.E2.m1.2.2.1.1.2.2.3.2.3.cmml">u</mi><mrow id="S3.E2.m1.2.2.1.1.2.2.3.3" xref="S3.E2.m1.2.2.1.1.2.2.3.3.cmml"><mi id="S3.E2.m1.2.2.1.1.2.2.3.3.2" xref="S3.E2.m1.2.2.1.1.2.2.3.3.2.cmml">l</mi><mo id="S3.E2.m1.2.2.1.1.2.2.3.3.1" xref="S3.E2.m1.2.2.1.1.2.2.3.3.1.cmml">+</mo><mn id="S3.E2.m1.2.2.1.1.2.2.3.3.3" xref="S3.E2.m1.2.2.1.1.2.2.3.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E2.m1.2.2.1.1.2.2.2" xref="S3.E2.m1.2.2.1.1.2.2.2.cmml">=</mo><mrow id="S3.E2.m1.2.2.1.1.2.2.1" xref="S3.E2.m1.2.2.1.1.2.2.1.cmml"><msubsup id="S3.E2.m1.2.2.1.1.2.2.1.3" xref="S3.E2.m1.2.2.1.1.2.2.1.3.cmml"><mtext id="S3.E2.m1.2.2.1.1.2.2.1.3.2.2" xref="S3.E2.m1.2.2.1.1.2.2.1.3.2.2a.cmml">Transformer</mtext><mi id="S3.E2.m1.2.2.1.1.2.2.1.3.3" xref="S3.E2.m1.2.2.1.1.2.2.1.3.3.cmml">a</mi><mi id="S3.E2.m1.2.2.1.1.2.2.1.3.2.3" xref="S3.E2.m1.2.2.1.1.2.2.1.3.2.3.cmml">l</mi></msubsup><mo id="S3.E2.m1.2.2.1.1.2.2.1.2" xref="S3.E2.m1.2.2.1.1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.2.2.1.1.2.2.1.1.1" xref="S3.E2.m1.2.2.1.1.2.2.1.1.1.1.cmml"><mo id="S3.E2.m1.2.2.1.1.2.2.1.1.1.2" stretchy="false" xref="S3.E2.m1.2.2.1.1.2.2.1.1.1.1.cmml">(</mo><msubsup id="S3.E2.m1.2.2.1.1.2.2.1.1.1.1" xref="S3.E2.m1.2.2.1.1.2.2.1.1.1.1.cmml"><mi id="S3.E2.m1.2.2.1.1.2.2.1.1.1.1.2.2" xref="S3.E2.m1.2.2.1.1.2.2.1.1.1.1.2.2.cmml">𝒂</mi><mi id="S3.E2.m1.2.2.1.1.2.2.1.1.1.1.2.3" xref="S3.E2.m1.2.2.1.1.2.2.1.1.1.1.2.3.cmml">u</mi><mi id="S3.E2.m1.2.2.1.1.2.2.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.2.2.1.1.1.1.3.cmml">l</mi></msubsup><mo id="S3.E2.m1.2.2.1.1.2.2.1.1.1.3" stretchy="false" xref="S3.E2.m1.2.2.1.1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.2.2.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.3a.cmml" xref="S3.E2.m1.2.2.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.2.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1"><and id="S3.E2.m1.2.2.1.1.1.1a.cmml" xref="S3.E2.m1.2.2.1.1.1.1"></and><apply id="S3.E2.m1.2.2.1.1.1.1b.cmml" xref="S3.E2.m1.2.2.1.1.1.1"><eq id="S3.E2.m1.2.2.1.1.1.1.4.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4"></eq><apply id="S3.E2.m1.2.2.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.3.2">𝒂</ci><ci id="S3.E2.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.3.3">𝑢</ci></apply><apply id="S3.E2.m1.2.2.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1"><times id="S3.E2.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.2"></times><apply id="S3.E2.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.3.2">𝑓</ci><apply id="S3.E2.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.3.3"><times id="S3.E2.m1.2.2.1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.3.3.1"></times><ci id="S3.E2.m1.2.2.1.1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.3.3.2">𝑎</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.3.3.3">𝑡</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.3.3.4.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.3.3.4">𝑡</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.3.3.5.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.3.3.5">𝑟</ci></apply></apply><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2.2">𝑎</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2.3">𝑢</ci></apply><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.3">𝛾</ci></apply></apply></apply><apply id="S3.E2.m1.2.2.1.1.1.1c.cmml" xref="S3.E2.m1.2.2.1.1.1.1"><eq id="S3.E2.m1.2.2.1.1.1.1.5.cmml" xref="S3.E2.m1.2.2.1.1.1.1.5"></eq><share href="https://arxiv.org/html/2405.15114v1#S3.E2.m1.2.2.1.1.1.1.1.cmml" id="S3.E2.m1.2.2.1.1.1.1d.cmml" xref="S3.E2.m1.2.2.1.1.1.1"></share><apply id="S3.E2.m1.2.2.1.1.1.1.6.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.6.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6">superscript</csymbol><apply id="S3.E2.m1.2.2.1.1.1.1.6.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.6.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.6.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.2.2">𝒂</ci><apply id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1"><abs id="S3.E2.m1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.2"></abs><apply id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.2">𝑎</ci><ci id="S3.E2.m1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3">𝑢</ci></apply></apply></apply><ci id="S3.E2.m1.2.2.1.1.1.1.6.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3">𝐿</ci></apply></apply></apply><apply id="S3.E2.m1.2.2.1.1.2.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2"><eq id="S3.E2.m1.2.2.1.1.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2"></eq><apply id="S3.E2.m1.2.2.1.1.2.2.3.cmml" xref="S3.E2.m1.2.2.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.2.2.3.1.cmml" xref="S3.E2.m1.2.2.1.1.2.2.3">superscript</csymbol><apply id="S3.E2.m1.2.2.1.1.2.2.3.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.2.2.3.2.1.cmml" xref="S3.E2.m1.2.2.1.1.2.2.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.2.2.3.2.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2.3.2.2">𝒂</ci><ci id="S3.E2.m1.2.2.1.1.2.2.3.2.3.cmml" xref="S3.E2.m1.2.2.1.1.2.2.3.2.3">𝑢</ci></apply><apply id="S3.E2.m1.2.2.1.1.2.2.3.3.cmml" xref="S3.E2.m1.2.2.1.1.2.2.3.3"><plus id="S3.E2.m1.2.2.1.1.2.2.3.3.1.cmml" xref="S3.E2.m1.2.2.1.1.2.2.3.3.1"></plus><ci id="S3.E2.m1.2.2.1.1.2.2.3.3.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2.3.3.2">𝑙</ci><cn id="S3.E2.m1.2.2.1.1.2.2.3.3.3.cmml" type="integer" xref="S3.E2.m1.2.2.1.1.2.2.3.3.3">1</cn></apply></apply><apply id="S3.E2.m1.2.2.1.1.2.2.1.cmml" xref="S3.E2.m1.2.2.1.1.2.2.1"><times id="S3.E2.m1.2.2.1.1.2.2.1.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2.1.2"></times><apply id="S3.E2.m1.2.2.1.1.2.2.1.3.cmml" xref="S3.E2.m1.2.2.1.1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.2.2.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.2.2.1.3">subscript</csymbol><apply id="S3.E2.m1.2.2.1.1.2.2.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.2.2.1.3.2.1.cmml" xref="S3.E2.m1.2.2.1.1.2.2.1.3">superscript</csymbol><ci id="S3.E2.m1.2.2.1.1.2.2.1.3.2.2a.cmml" xref="S3.E2.m1.2.2.1.1.2.2.1.3.2.2"><mtext id="S3.E2.m1.2.2.1.1.2.2.1.3.2.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2.1.3.2.2">Transformer</mtext></ci><ci id="S3.E2.m1.2.2.1.1.2.2.1.3.2.3.cmml" xref="S3.E2.m1.2.2.1.1.2.2.1.3.2.3">𝑙</ci></apply><ci id="S3.E2.m1.2.2.1.1.2.2.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.2.2.1.3.3">𝑎</ci></apply><apply id="S3.E2.m1.2.2.1.1.2.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.2.2.1.1.1">superscript</csymbol><apply id="S3.E2.m1.2.2.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.2.2.1.1.1.1.2.1.cmml" xref="S3.E2.m1.2.2.1.1.2.2.1.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.2.2.1.1.1.1.2.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2.1.1.1.1.2.2">𝒂</ci><ci id="S3.E2.m1.2.2.1.1.2.2.1.1.1.1.2.3.cmml" xref="S3.E2.m1.2.2.1.1.2.2.1.1.1.1.2.3">𝑢</ci></apply><ci id="S3.E2.m1.2.2.1.1.2.2.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.2.2.1.1.1.1.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">\bm{a}_{u}=f_{attr}(a_{u}|\gamma)=\bm{a}_{|a_{u}|}^{L},\,\bm{a}_{u}^{l+1}=%
\text{Transformer}^{l}_{a}(\bm{a}_{u}^{l}).</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.2d">bold_italic_a start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = italic_f start_POSTSUBSCRIPT italic_a italic_t italic_t italic_r end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT | italic_γ ) = bold_italic_a start_POSTSUBSCRIPT | italic_a start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT | end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT , bold_italic_a start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l + 1 end_POSTSUPERSCRIPT = Transformer start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ( bold_italic_a start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.I2.ix2.p1.10">We then incorporate a dense layer to encode the combination of attribute representation <math alttext="\bm{a}_{u}" class="ltx_Math" display="inline" id="S3.I2.ix2.p1.9.m1.1"><semantics id="S3.I2.ix2.p1.9.m1.1a"><msub id="S3.I2.ix2.p1.9.m1.1.1" xref="S3.I2.ix2.p1.9.m1.1.1.cmml"><mi id="S3.I2.ix2.p1.9.m1.1.1.2" xref="S3.I2.ix2.p1.9.m1.1.1.2.cmml">𝒂</mi><mi id="S3.I2.ix2.p1.9.m1.1.1.3" xref="S3.I2.ix2.p1.9.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I2.ix2.p1.9.m1.1b"><apply id="S3.I2.ix2.p1.9.m1.1.1.cmml" xref="S3.I2.ix2.p1.9.m1.1.1"><csymbol cd="ambiguous" id="S3.I2.ix2.p1.9.m1.1.1.1.cmml" xref="S3.I2.ix2.p1.9.m1.1.1">subscript</csymbol><ci id="S3.I2.ix2.p1.9.m1.1.1.2.cmml" xref="S3.I2.ix2.p1.9.m1.1.1.2">𝒂</ci><ci id="S3.I2.ix2.p1.9.m1.1.1.3.cmml" xref="S3.I2.ix2.p1.9.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.ix2.p1.9.m1.1c">\bm{a}_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.ix2.p1.9.m1.1d">bold_italic_a start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> and the frozen behavior representation <math alttext="\mathbf{H}" class="ltx_Math" display="inline" id="S3.I2.ix2.p1.10.m2.1"><semantics id="S3.I2.ix2.p1.10.m2.1a"><mi id="S3.I2.ix2.p1.10.m2.1.1" xref="S3.I2.ix2.p1.10.m2.1.1.cmml">𝐇</mi><annotation-xml encoding="MathML-Content" id="S3.I2.ix2.p1.10.m2.1b"><ci id="S3.I2.ix2.p1.10.m2.1.1.cmml" xref="S3.I2.ix2.p1.10.m2.1.1">𝐇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.ix2.p1.10.m2.1c">\mathbf{H}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.ix2.p1.10.m2.1d">bold_H</annotation></semantics></math>, resulting in a new user representation:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{u}=\text{Dense}(\bm{a}_{u}\oplus\mathbf{H},\theta)," class="ltx_Math" display="block" id="S3.E3.m1.2"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.2.1" xref="S3.E3.m1.2.2.1.1.cmml"><mrow id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml"><mi id="S3.E3.m1.2.2.1.1.3" xref="S3.E3.m1.2.2.1.1.3.cmml">𝐮</mi><mo id="S3.E3.m1.2.2.1.1.2" xref="S3.E3.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.2.2.1.1.1" xref="S3.E3.m1.2.2.1.1.1.cmml"><mtext id="S3.E3.m1.2.2.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.3a.cmml">Dense</mtext><mo id="S3.E3.m1.2.2.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.E3.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.2.2.1.1.1.1.2.cmml">(</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.2.2.1.1.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.cmml">𝒂</mi><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.3.cmml">u</mi></msub><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.cmml">⊕</mo><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3.cmml">𝐇</mi></mrow><mo id="S3.E3.m1.2.2.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.2.cmml">,</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">θ</mi><mo id="S3.E3.m1.2.2.1.1.1.1.1.4" stretchy="false" xref="S3.E3.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.2.2.1.2" xref="S3.E3.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1"><eq id="S3.E3.m1.2.2.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.2"></eq><ci id="S3.E3.m1.2.2.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.3">𝐮</ci><apply id="S3.E3.m1.2.2.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1"><times id="S3.E3.m1.2.2.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.2"></times><ci id="S3.E3.m1.2.2.1.1.1.3a.cmml" xref="S3.E3.m1.2.2.1.1.1.3"><mtext id="S3.E3.m1.2.2.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.3">Dense</mtext></ci><interval closure="open" id="S3.E3.m1.2.2.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1"><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1">direct-sum</csymbol><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2">𝒂</ci><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.3">𝑢</ci></apply><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3">𝐇</ci></apply><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝜃</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">\mathbf{u}=\text{Dense}(\bm{a}_{u}\oplus\mathbf{H},\theta),</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.2d">bold_u = Dense ( bold_italic_a start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ⊕ bold_H , italic_θ ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.I2.ix2.p1.12">where <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.I2.ix2.p1.11.m1.1"><semantics id="S3.I2.ix2.p1.11.m1.1a"><mi id="S3.I2.ix2.p1.11.m1.1.1" xref="S3.I2.ix2.p1.11.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.I2.ix2.p1.11.m1.1b"><ci id="S3.I2.ix2.p1.11.m1.1.1.cmml" xref="S3.I2.ix2.p1.11.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.ix2.p1.11.m1.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S3.I2.ix2.p1.11.m1.1d">italic_γ</annotation></semantics></math> and <math alttext="\theta" class="ltx_Math" display="inline" id="S3.I2.ix2.p1.12.m2.1"><semantics id="S3.I2.ix2.p1.12.m2.1a"><mi id="S3.I2.ix2.p1.12.m2.1.1" xref="S3.I2.ix2.p1.12.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.I2.ix2.p1.12.m2.1b"><ci id="S3.I2.ix2.p1.12.m2.1.1.cmml" xref="S3.I2.ix2.p1.12.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.ix2.p1.12.m2.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.I2.ix2.p1.12.m2.1d">italic_θ</annotation></semantics></math> are the trainable parameters in the tuning phase.</p>
</div>
</dd>
</dl>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS2.p3">
<p class="ltx_p" id="S3.SS3.SSS2.p3.8">The sequential recommender is trained by minimizing the BPR loss function:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{BPR}=-\sum_{(\mathcal{H},\,v)\in\mathcal{O}^{+},(\mathcal{H},w)%
\in\mathcal{O}^{-},}\log\sigma(\phi(\mathbf{u},v)-\phi(\mathbf{u},w))," class="ltx_Math" display="block" id="S3.E4.m1.10"><semantics id="S3.E4.m1.10a"><mrow id="S3.E4.m1.10.10.1" xref="S3.E4.m1.10.10.1.1.cmml"><mrow id="S3.E4.m1.10.10.1.1" xref="S3.E4.m1.10.10.1.1.cmml"><msub id="S3.E4.m1.10.10.1.1.3" xref="S3.E4.m1.10.10.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.10.10.1.1.3.2" xref="S3.E4.m1.10.10.1.1.3.2.cmml">ℒ</mi><mrow id="S3.E4.m1.10.10.1.1.3.3" xref="S3.E4.m1.10.10.1.1.3.3.cmml"><mi id="S3.E4.m1.10.10.1.1.3.3.2" xref="S3.E4.m1.10.10.1.1.3.3.2.cmml">B</mi><mo id="S3.E4.m1.10.10.1.1.3.3.1" xref="S3.E4.m1.10.10.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E4.m1.10.10.1.1.3.3.3" xref="S3.E4.m1.10.10.1.1.3.3.3.cmml">P</mi><mo id="S3.E4.m1.10.10.1.1.3.3.1a" xref="S3.E4.m1.10.10.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E4.m1.10.10.1.1.3.3.4" xref="S3.E4.m1.10.10.1.1.3.3.4.cmml">R</mi></mrow></msub><mo id="S3.E4.m1.10.10.1.1.2" xref="S3.E4.m1.10.10.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.10.10.1.1.1" xref="S3.E4.m1.10.10.1.1.1.cmml"><mo id="S3.E4.m1.10.10.1.1.1a" xref="S3.E4.m1.10.10.1.1.1.cmml">−</mo><mrow id="S3.E4.m1.10.10.1.1.1.1" xref="S3.E4.m1.10.10.1.1.1.1.cmml"><munder id="S3.E4.m1.10.10.1.1.1.1.2" xref="S3.E4.m1.10.10.1.1.1.1.2.cmml"><mo id="S3.E4.m1.10.10.1.1.1.1.2.2" movablelimits="false" xref="S3.E4.m1.10.10.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E4.m1.5.5.5.5" xref="S3.E4.m1.5.5.5.6.cmml"><mrow id="S3.E4.m1.5.5.5.5.1.2" xref="S3.E4.m1.5.5.5.5.1.3.cmml"><mrow id="S3.E4.m1.5.5.5.5.1.1.1" xref="S3.E4.m1.5.5.5.5.1.1.1.cmml"><mrow id="S3.E4.m1.5.5.5.5.1.1.1.2.2" xref="S3.E4.m1.5.5.5.5.1.1.1.2.1.cmml"><mo id="S3.E4.m1.5.5.5.5.1.1.1.2.2.1" stretchy="false" xref="S3.E4.m1.5.5.5.5.1.1.1.2.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">ℋ</mi><mo id="S3.E4.m1.5.5.5.5.1.1.1.2.2.2" rspace="0.337em" xref="S3.E4.m1.5.5.5.5.1.1.1.2.1.cmml">,</mo><mi id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.2.cmml">v</mi><mo id="S3.E4.m1.5.5.5.5.1.1.1.2.2.3" stretchy="false" xref="S3.E4.m1.5.5.5.5.1.1.1.2.1.cmml">)</mo></mrow><mo id="S3.E4.m1.5.5.5.5.1.1.1.1" xref="S3.E4.m1.5.5.5.5.1.1.1.1.cmml">∈</mo><msup id="S3.E4.m1.5.5.5.5.1.1.1.3" xref="S3.E4.m1.5.5.5.5.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.5.5.5.5.1.1.1.3.2" xref="S3.E4.m1.5.5.5.5.1.1.1.3.2.cmml">𝒪</mi><mo id="S3.E4.m1.5.5.5.5.1.1.1.3.3" xref="S3.E4.m1.5.5.5.5.1.1.1.3.3.cmml">+</mo></msup></mrow><mo id="S3.E4.m1.5.5.5.5.1.2.3" xref="S3.E4.m1.5.5.5.5.1.3a.cmml">,</mo><mrow id="S3.E4.m1.5.5.5.5.1.2.2" xref="S3.E4.m1.5.5.5.5.1.2.2.cmml"><mrow id="S3.E4.m1.5.5.5.5.1.2.2.2.2" xref="S3.E4.m1.5.5.5.5.1.2.2.2.1.cmml"><mo id="S3.E4.m1.5.5.5.5.1.2.2.2.2.1" stretchy="false" xref="S3.E4.m1.5.5.5.5.1.2.2.2.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.3.3.3.3" xref="S3.E4.m1.3.3.3.3.cmml">ℋ</mi><mo id="S3.E4.m1.5.5.5.5.1.2.2.2.2.2" xref="S3.E4.m1.5.5.5.5.1.2.2.2.1.cmml">,</mo><mi id="S3.E4.m1.4.4.4.4" xref="S3.E4.m1.4.4.4.4.cmml">w</mi><mo id="S3.E4.m1.5.5.5.5.1.2.2.2.2.3" stretchy="false" xref="S3.E4.m1.5.5.5.5.1.2.2.2.1.cmml">)</mo></mrow><mo id="S3.E4.m1.5.5.5.5.1.2.2.1" xref="S3.E4.m1.5.5.5.5.1.2.2.1.cmml">∈</mo><msup id="S3.E4.m1.5.5.5.5.1.2.2.3" xref="S3.E4.m1.5.5.5.5.1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.5.5.5.5.1.2.2.3.2" xref="S3.E4.m1.5.5.5.5.1.2.2.3.2.cmml">𝒪</mi><mo id="S3.E4.m1.5.5.5.5.1.2.2.3.3" xref="S3.E4.m1.5.5.5.5.1.2.2.3.3.cmml">−</mo></msup></mrow></mrow><mo id="S3.E4.m1.5.5.5.5.2" xref="S3.E4.m1.5.5.5.6.cmml">,</mo></mrow></munder><mrow id="S3.E4.m1.10.10.1.1.1.1.1" xref="S3.E4.m1.10.10.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.10.10.1.1.1.1.1.3" xref="S3.E4.m1.10.10.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.10.10.1.1.1.1.1.3.1" xref="S3.E4.m1.10.10.1.1.1.1.1.3.1.cmml">log</mi><mo id="S3.E4.m1.10.10.1.1.1.1.1.3a" lspace="0.167em" xref="S3.E4.m1.10.10.1.1.1.1.1.3.cmml">⁡</mo><mi id="S3.E4.m1.10.10.1.1.1.1.1.3.2" xref="S3.E4.m1.10.10.1.1.1.1.1.3.2.cmml">σ</mi></mrow><mo id="S3.E4.m1.10.10.1.1.1.1.1.2" xref="S3.E4.m1.10.10.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.10.10.1.1.1.1.1.1.1" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.10.10.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.2.2.cmml">ϕ</mi><mo id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.2.1" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.2.3.1.cmml"><mo id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.2.3.1.cmml">(</mo><mi id="S3.E4.m1.6.6" xref="S3.E4.m1.6.6.cmml">𝐮</mi><mo id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.2.3.2.2" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.2.3.1.cmml">,</mo><mi id="S3.E4.m1.7.7" xref="S3.E4.m1.7.7.cmml">v</mi><mo id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.2.3.2.3" stretchy="false" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mo id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.3.1" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.3.3.1.cmml"><mo id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.3.3.1.cmml">(</mo><mi id="S3.E4.m1.8.8" xref="S3.E4.m1.8.8.cmml">𝐮</mi><mo id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.3.3.2.2" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.E4.m1.9.9" xref="S3.E4.m1.9.9.cmml">w</mi><mo id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.3.3.2.3" stretchy="false" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.10.10.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E4.m1.10.10.1.2" xref="S3.E4.m1.10.10.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.10b"><apply id="S3.E4.m1.10.10.1.1.cmml" xref="S3.E4.m1.10.10.1"><eq id="S3.E4.m1.10.10.1.1.2.cmml" xref="S3.E4.m1.10.10.1.1.2"></eq><apply id="S3.E4.m1.10.10.1.1.3.cmml" xref="S3.E4.m1.10.10.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.10.10.1.1.3.1.cmml" xref="S3.E4.m1.10.10.1.1.3">subscript</csymbol><ci id="S3.E4.m1.10.10.1.1.3.2.cmml" xref="S3.E4.m1.10.10.1.1.3.2">ℒ</ci><apply id="S3.E4.m1.10.10.1.1.3.3.cmml" xref="S3.E4.m1.10.10.1.1.3.3"><times id="S3.E4.m1.10.10.1.1.3.3.1.cmml" xref="S3.E4.m1.10.10.1.1.3.3.1"></times><ci id="S3.E4.m1.10.10.1.1.3.3.2.cmml" xref="S3.E4.m1.10.10.1.1.3.3.2">𝐵</ci><ci id="S3.E4.m1.10.10.1.1.3.3.3.cmml" xref="S3.E4.m1.10.10.1.1.3.3.3">𝑃</ci><ci id="S3.E4.m1.10.10.1.1.3.3.4.cmml" xref="S3.E4.m1.10.10.1.1.3.3.4">𝑅</ci></apply></apply><apply id="S3.E4.m1.10.10.1.1.1.cmml" xref="S3.E4.m1.10.10.1.1.1"><minus id="S3.E4.m1.10.10.1.1.1.2.cmml" xref="S3.E4.m1.10.10.1.1.1"></minus><apply id="S3.E4.m1.10.10.1.1.1.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1"><apply id="S3.E4.m1.10.10.1.1.1.1.2.cmml" xref="S3.E4.m1.10.10.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.10.10.1.1.1.1.2.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1.2">subscript</csymbol><sum id="S3.E4.m1.10.10.1.1.1.1.2.2.cmml" xref="S3.E4.m1.10.10.1.1.1.1.2.2"></sum><list id="S3.E4.m1.5.5.5.6.cmml" xref="S3.E4.m1.5.5.5.5"><apply id="S3.E4.m1.5.5.5.5.1.3.cmml" xref="S3.E4.m1.5.5.5.5.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.5.5.1.3a.cmml" xref="S3.E4.m1.5.5.5.5.1.2.3">formulae-sequence</csymbol><apply id="S3.E4.m1.5.5.5.5.1.1.1.cmml" xref="S3.E4.m1.5.5.5.5.1.1.1"><in id="S3.E4.m1.5.5.5.5.1.1.1.1.cmml" xref="S3.E4.m1.5.5.5.5.1.1.1.1"></in><interval closure="open" id="S3.E4.m1.5.5.5.5.1.1.1.2.1.cmml" xref="S3.E4.m1.5.5.5.5.1.1.1.2.2"><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">ℋ</ci><ci id="S3.E4.m1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2">𝑣</ci></interval><apply id="S3.E4.m1.5.5.5.5.1.1.1.3.cmml" xref="S3.E4.m1.5.5.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.5.5.1.1.1.3.1.cmml" xref="S3.E4.m1.5.5.5.5.1.1.1.3">superscript</csymbol><ci id="S3.E4.m1.5.5.5.5.1.1.1.3.2.cmml" xref="S3.E4.m1.5.5.5.5.1.1.1.3.2">𝒪</ci><plus id="S3.E4.m1.5.5.5.5.1.1.1.3.3.cmml" xref="S3.E4.m1.5.5.5.5.1.1.1.3.3"></plus></apply></apply><apply id="S3.E4.m1.5.5.5.5.1.2.2.cmml" xref="S3.E4.m1.5.5.5.5.1.2.2"><in id="S3.E4.m1.5.5.5.5.1.2.2.1.cmml" xref="S3.E4.m1.5.5.5.5.1.2.2.1"></in><interval closure="open" id="S3.E4.m1.5.5.5.5.1.2.2.2.1.cmml" xref="S3.E4.m1.5.5.5.5.1.2.2.2.2"><ci id="S3.E4.m1.3.3.3.3.cmml" xref="S3.E4.m1.3.3.3.3">ℋ</ci><ci id="S3.E4.m1.4.4.4.4.cmml" xref="S3.E4.m1.4.4.4.4">𝑤</ci></interval><apply id="S3.E4.m1.5.5.5.5.1.2.2.3.cmml" xref="S3.E4.m1.5.5.5.5.1.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.5.5.1.2.2.3.1.cmml" xref="S3.E4.m1.5.5.5.5.1.2.2.3">superscript</csymbol><ci id="S3.E4.m1.5.5.5.5.1.2.2.3.2.cmml" xref="S3.E4.m1.5.5.5.5.1.2.2.3.2">𝒪</ci><minus id="S3.E4.m1.5.5.5.5.1.2.2.3.3.cmml" xref="S3.E4.m1.5.5.5.5.1.2.2.3.3"></minus></apply></apply></apply></list></apply><apply id="S3.E4.m1.10.10.1.1.1.1.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1"><times id="S3.E4.m1.10.10.1.1.1.1.1.2.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.2"></times><apply id="S3.E4.m1.10.10.1.1.1.1.1.3.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.3"><log id="S3.E4.m1.10.10.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.3.1"></log><ci id="S3.E4.m1.10.10.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.3.2">𝜎</ci></apply><apply id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1"><minus id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.2"><times id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.2.1"></times><ci id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.2.2">italic-ϕ</ci><interval closure="open" id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.2.3.2"><ci id="S3.E4.m1.6.6.cmml" xref="S3.E4.m1.6.6">𝐮</ci><ci id="S3.E4.m1.7.7.cmml" xref="S3.E4.m1.7.7">𝑣</ci></interval></apply><apply id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.3"><times id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.3.2">italic-ϕ</ci><interval closure="open" id="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E4.m1.10.10.1.1.1.1.1.1.1.1.3.3.2"><ci id="S3.E4.m1.8.8.cmml" xref="S3.E4.m1.8.8">𝐮</ci><ci id="S3.E4.m1.9.9.cmml" xref="S3.E4.m1.9.9">𝑤</ci></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.10c">\mathcal{L}_{BPR}=-\sum_{(\mathcal{H},\,v)\in\mathcal{O}^{+},(\mathcal{H},w)%
\in\mathcal{O}^{-},}\log\sigma(\phi(\mathbf{u},v)-\phi(\mathbf{u},w)),</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.10d">caligraphic_L start_POSTSUBSCRIPT italic_B italic_P italic_R end_POSTSUBSCRIPT = - ∑ start_POSTSUBSCRIPT ( caligraphic_H , italic_v ) ∈ caligraphic_O start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT , ( caligraphic_H , italic_w ) ∈ caligraphic_O start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT , end_POSTSUBSCRIPT roman_log italic_σ ( italic_ϕ ( bold_u , italic_v ) - italic_ϕ ( bold_u , italic_w ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS2.p3.7">where <math alttext="\mathcal{O}^{+}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.1.m1.1"><semantics id="S3.SS3.SSS2.p3.1.m1.1a"><msup id="S3.SS3.SSS2.p3.1.m1.1.1" xref="S3.SS3.SSS2.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS2.p3.1.m1.1.1.2" xref="S3.SS3.SSS2.p3.1.m1.1.1.2.cmml">𝒪</mi><mo id="S3.SS3.SSS2.p3.1.m1.1.1.3" xref="S3.SS3.SSS2.p3.1.m1.1.1.3.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.1.m1.1b"><apply id="S3.SS3.SSS2.p3.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.1.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.SSS2.p3.1.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.1.1.2">𝒪</ci><plus id="S3.SS3.SSS2.p3.1.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p3.1.m1.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.1.m1.1c">\mathcal{O}^{+}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.1.m1.1d">caligraphic_O start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{O}^{-}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.2.m2.1"><semantics id="S3.SS3.SSS2.p3.2.m2.1a"><msup id="S3.SS3.SSS2.p3.2.m2.1.1" xref="S3.SS3.SSS2.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS2.p3.2.m2.1.1.2" xref="S3.SS3.SSS2.p3.2.m2.1.1.2.cmml">𝒪</mi><mo id="S3.SS3.SSS2.p3.2.m2.1.1.3" xref="S3.SS3.SSS2.p3.2.m2.1.1.3.cmml">−</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.2.m2.1b"><apply id="S3.SS3.SSS2.p3.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.2.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.SSS2.p3.2.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.1.2">𝒪</ci><minus id="S3.SS3.SSS2.p3.2.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.2.m2.1c">\mathcal{O}^{-}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.2.m2.1d">caligraphic_O start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math> denote the positive samples and negative samples, <math alttext="\phi(\cdot)" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.3.m3.1"><semantics id="S3.SS3.SSS2.p3.3.m3.1a"><mrow id="S3.SS3.SSS2.p3.3.m3.1.2" xref="S3.SS3.SSS2.p3.3.m3.1.2.cmml"><mi id="S3.SS3.SSS2.p3.3.m3.1.2.2" xref="S3.SS3.SSS2.p3.3.m3.1.2.2.cmml">ϕ</mi><mo id="S3.SS3.SSS2.p3.3.m3.1.2.1" xref="S3.SS3.SSS2.p3.3.m3.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p3.3.m3.1.2.3.2" xref="S3.SS3.SSS2.p3.3.m3.1.2.cmml"><mo id="S3.SS3.SSS2.p3.3.m3.1.2.3.2.1" stretchy="false" xref="S3.SS3.SSS2.p3.3.m3.1.2.cmml">(</mo><mo id="S3.SS3.SSS2.p3.3.m3.1.1" lspace="0em" rspace="0em" xref="S3.SS3.SSS2.p3.3.m3.1.1.cmml">⋅</mo><mo id="S3.SS3.SSS2.p3.3.m3.1.2.3.2.2" stretchy="false" xref="S3.SS3.SSS2.p3.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.3.m3.1b"><apply id="S3.SS3.SSS2.p3.3.m3.1.2.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.2"><times id="S3.SS3.SSS2.p3.3.m3.1.2.1.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.2.1"></times><ci id="S3.SS3.SSS2.p3.3.m3.1.2.2.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.2.2">italic-ϕ</ci><ci id="S3.SS3.SSS2.p3.3.m3.1.1.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.3.m3.1c">\phi(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.3.m3.1d">italic_ϕ ( ⋅ )</annotation></semantics></math> represents the inner-product layer, and <math alttext="\sigma(\cdot)" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.4.m4.1"><semantics id="S3.SS3.SSS2.p3.4.m4.1a"><mrow id="S3.SS3.SSS2.p3.4.m4.1.2" xref="S3.SS3.SSS2.p3.4.m4.1.2.cmml"><mi id="S3.SS3.SSS2.p3.4.m4.1.2.2" xref="S3.SS3.SSS2.p3.4.m4.1.2.2.cmml">σ</mi><mo id="S3.SS3.SSS2.p3.4.m4.1.2.1" xref="S3.SS3.SSS2.p3.4.m4.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p3.4.m4.1.2.3.2" xref="S3.SS3.SSS2.p3.4.m4.1.2.cmml"><mo id="S3.SS3.SSS2.p3.4.m4.1.2.3.2.1" stretchy="false" xref="S3.SS3.SSS2.p3.4.m4.1.2.cmml">(</mo><mo id="S3.SS3.SSS2.p3.4.m4.1.1" lspace="0em" rspace="0em" xref="S3.SS3.SSS2.p3.4.m4.1.1.cmml">⋅</mo><mo id="S3.SS3.SSS2.p3.4.m4.1.2.3.2.2" stretchy="false" xref="S3.SS3.SSS2.p3.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.4.m4.1b"><apply id="S3.SS3.SSS2.p3.4.m4.1.2.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.2"><times id="S3.SS3.SSS2.p3.4.m4.1.2.1.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.2.1"></times><ci id="S3.SS3.SSS2.p3.4.m4.1.2.2.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.2.2">𝜎</ci><ci id="S3.SS3.SSS2.p3.4.m4.1.1.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.4.m4.1c">\sigma(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.4.m4.1d">italic_σ ( ⋅ )</annotation></semantics></math> refers to the Sigmoid activation function. During the pre-training phase, <math alttext="\mathbf{u}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.5.m5.1"><semantics id="S3.SS3.SSS2.p3.5.m5.1a"><mi id="S3.SS3.SSS2.p3.5.m5.1.1" xref="S3.SS3.SSS2.p3.5.m5.1.1.cmml">𝐮</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.5.m5.1b"><ci id="S3.SS3.SSS2.p3.5.m5.1.1.cmml" xref="S3.SS3.SSS2.p3.5.m5.1.1">𝐮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.5.m5.1c">\mathbf{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.5.m5.1d">bold_u</annotation></semantics></math> is represented by <math alttext="\mathbf{H}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.6.m6.1"><semantics id="S3.SS3.SSS2.p3.6.m6.1a"><mi id="S3.SS3.SSS2.p3.6.m6.1.1" xref="S3.SS3.SSS2.p3.6.m6.1.1.cmml">𝐇</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.6.m6.1b"><ci id="S3.SS3.SSS2.p3.6.m6.1.1.cmml" xref="S3.SS3.SSS2.p3.6.m6.1.1">𝐇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.6.m6.1c">\mathbf{H}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.6.m6.1d">bold_H</annotation></semantics></math>. The finetuned user embedding <math alttext="\mathbf{u}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.7.m7.1"><semantics id="S3.SS3.SSS2.p3.7.m7.1a"><mi id="S3.SS3.SSS2.p3.7.m7.1.1" xref="S3.SS3.SSS2.p3.7.m7.1.1.cmml">𝐮</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.7.m7.1b"><ci id="S3.SS3.SSS2.p3.7.m7.1.1.cmml" xref="S3.SS3.SSS2.p3.7.m7.1.1">𝐮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.7.m7.1c">\mathbf{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.7.m7.1d">bold_u</annotation></semantics></math> is designed to be sensitive to the specific attribute, while maintaining the personalized sequential recommendation learned in the pre-training phase.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4. </span>Memory Strategy</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">The vast number of items and the complex item names&amp;IDs pose a challenge for LLMs when generating control commands or tool usages. Additionally, items retrieved from various tools should be systematically ordered to aid the LLM-based surrogate user <math alttext="\hat{u}" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.1"><semantics id="S3.SS4.p1.1.m1.1a"><mover accent="true" id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mi id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml">u</mi><mo id="S3.SS4.p1.1.m1.1.1.1" xref="S3.SS4.p1.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><ci id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1.1">^</ci><ci id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">\hat{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.1.m1.1d">over^ start_ARG italic_u end_ARG</annotation></semantics></math> in making decisions. Therefore, we introduce a memory strategy, ensuring the correctness of generated items and cataloging candidate items with their respective tool annotations.</p>
</div>
<div class="ltx_para" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.2">The memory strategy is initialized with the item pool directory. Whenever external tools return candidate items, particularly from attribute-oriented rank tools, the strategy verifies the presence of these items in the initial directory. If there are any discrepancies, the tools are prompted to re-run with additional incorrect details attached behind. Once validated, the candidate items are recorded alongside their associated tool marks, in order to serve the subsequent tool calls. As an illustration, a typical prompt might be “<span class="ltx_text ltx_font_italic" id="S3.SS4.p2.2.1">Here’s the top</span> [<span class="ltx_text ltx_font_italic" id="S3.SS4.p2.2.2">Output Size Pattern</span> <math alttext="\$K" class="ltx_Math" display="inline" id="S3.SS4.p2.1.m1.1"><semantics id="S3.SS4.p2.1.m1.1a"><mrow id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml"><mo id="S3.SS4.p2.1.m1.1.1.1" rspace="0.167em" xref="S3.SS4.p2.1.m1.1.1.1.cmml">$</mo><mi id="S3.SS4.p2.1.m1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.2.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><apply id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1"><csymbol cd="latexml" id="S3.SS4.p2.1.m1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1">currency-dollar</csymbol><ci id="S3.SS4.p2.1.m1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.2">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">\$K</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.1.m1.1d">$ italic_K</annotation></semantics></math>] <span class="ltx_text ltx_font_italic" id="S3.SS4.p2.2.3">movie ID, movie name, and the recommendation confidence score from the recommender system with</span> [<span class="ltx_text ltx_font_italic" id="S3.SS4.p2.2.4">Attribute Pattern</span> <math alttext="a_{\hat{u}}" class="ltx_Math" display="inline" id="S3.SS4.p2.2.m2.1"><semantics id="S3.SS4.p2.2.m2.1a"><msub id="S3.SS4.p2.2.m2.1.1" xref="S3.SS4.p2.2.m2.1.1.cmml"><mi id="S3.SS4.p2.2.m2.1.1.2" xref="S3.SS4.p2.2.m2.1.1.2.cmml">a</mi><mover accent="true" id="S3.SS4.p2.2.m2.1.1.3" xref="S3.SS4.p2.2.m2.1.1.3.cmml"><mi id="S3.SS4.p2.2.m2.1.1.3.2" xref="S3.SS4.p2.2.m2.1.1.3.2.cmml">u</mi><mo id="S3.SS4.p2.2.m2.1.1.3.1" xref="S3.SS4.p2.2.m2.1.1.3.1.cmml">^</mo></mover></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.1b"><apply id="S3.SS4.p2.2.m2.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.1.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p2.2.m2.1.1.2.cmml" xref="S3.SS4.p2.2.m2.1.1.2">𝑎</ci><apply id="S3.SS4.p2.2.m2.1.1.3.cmml" xref="S3.SS4.p2.2.m2.1.1.3"><ci id="S3.SS4.p2.2.m2.1.1.3.1.cmml" xref="S3.SS4.p2.2.m2.1.1.3.1">^</ci><ci id="S3.SS4.p2.2.m2.1.1.3.2.cmml" xref="S3.SS4.p2.2.m2.1.1.3.2">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.1c">a_{\hat{u}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.2.m2.1d">italic_a start_POSTSUBSCRIPT over^ start_ARG italic_u end_ARG end_POSTSUBSCRIPT</annotation></semantics></math>] <span class="ltx_text ltx_font_italic" id="S3.SS4.p2.2.5">type</span>. {<span class="ltx_text ltx_font_italic" id="S3.SS4.p2.2.6">Candidate Item Set</span>}.”</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Experiments</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we report on extensive experiments aimed at evaluating the performance of our proposed ToolRec.
Our experiments focus on answering the following research questions:

<span class="ltx_inline-enumerate" id="S4.I1">
<span class="ltx_inline-item" id="S4.I1.i1"><span class="ltx_tag ltx_tag_inline-item"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.1.1.1">(RQ1)</span></span> <span class="ltx_text" id="S4.I1.i1.5">How does ToolRec  compare to conventional RSs and LLM-based RSs in the sequential recommendation setting?
</span></span>
<span class="ltx_inline-item" id="S4.I1.i2"><span class="ltx_tag ltx_tag_inline-item"><span class="ltx_text ltx_font_bold" id="S4.I1.i2.1.1.1">(RQ2)</span></span> <span class="ltx_text" id="S4.I1.i2.5">How do different components
(<span class="ltx_text ltx_font_italic" id="S4.I1.i2.5.1">i.e.,  user decision simulation, termination round, attribute-oriented retrieval tools</span>)
influence our ToolRec? And
</span></span>
<span class="ltx_inline-item" id="S4.I1.i3"><span class="ltx_tag ltx_tag_inline-item"><span class="ltx_text ltx_font_bold" id="S4.I1.i3.1.1.1">(RQ3)</span></span> <span class="ltx_text" id="S4.I1.i3.5">Are LLMs capable of using their inherent knowledge to cater to the recommendation task’s needs?
</span></span>
</span></p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Experimental Settings</h3>
<section class="ltx_subsubsection" id="S4.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1. </span>Datasets</h4>
<div class="ltx_para" id="S4.SS1.SSS1.p1">
<p class="ltx_p" id="S4.SS1.SSS1.p1.1">To evaluate the effectiveness of our methods, we conduct experiments on three real-world datasets: Ml-1M, Amazon-Book, and Yelp2018.</p>
<ul class="ltx_itemize" id="S4.I2">
<li class="ltx_item" id="S4.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i1.p1">
<p class="ltx_p" id="S4.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i1.p1.1.1">ML-1M</span>. This dataset is derived from the MovieLens-1M<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://grouplens.org/datasets/movielens/" title="">https://grouplens.org/datasets/movielens/</a></span></span></span> benchmark, which contains user ratings for movies with timestamps.
We take the movies’ <span class="ltx_text ltx_font_italic" id="S4.I2.i1.p1.1.2">genre</span> and <span class="ltx_text ltx_font_italic" id="S4.I2.i1.p1.1.3">release year</span> as the attribute information.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i2.p1">
<p class="ltx_p" id="S4.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i2.p1.1.1">Amazon-Book</span>. This dataset<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://nijianmo.github.io/amazon/" title="">https://nijianmo.github.io/amazon/</a></span></span></span> is extracted from <span class="ltx_text ltx_font_italic" id="S4.I2.i2.p1.1.2">Amazon.com</span> platform. We adopt the Book category to evaluate our method. We take the books’ <span class="ltx_text ltx_font_italic" id="S4.I2.i2.p1.1.3">Price</span> and <span class="ltx_text ltx_font_italic" id="S4.I2.i2.p1.1.4">Sales rank</span> as the attribute information. A 10-core setting is applied to maintain dataset quality.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i3.p1">
<p class="ltx_p" id="S4.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i3.p1.1.1">Yelp2018</span>. This dataset is collected from the 2018 edition of the Yelp Challenge.<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.yelp.com/dataset" title="">https://www.yelp.com/dataset</a></span></span></span> We utilize local businesses’ <span class="ltx_text ltx_font_italic" id="S4.I2.i3.p1.1.2">Categories</span>, <span class="ltx_text ltx_font_italic" id="S4.I2.i3.p1.1.3">City</span> and <span class="ltx_text ltx_font_italic" id="S4.I2.i3.p1.1.4">Stars</span> as attributes. We employ the 10-core setting to ensure a minimum of ten interactions for each user and item.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S4.SS1.SSS1.p1.2">For each dataset, we organize users’ interactions chronologically based on timestamps, allowing us to create the corresponding historical interaction sequences. Items are described using their product IDs&amp;Names. We summarize the statistics of our datasets in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S4.T1" title="Table 1 ‣ 4.1.1. Datasets ‣ 4.1. Experimental Settings ‣ 4. Experiments ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1. </span>The statistics of the datasets used.</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.1">Datasets</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.2">#Users</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.3">#Items</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.4">#Interactions</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.5">Sparsity (%)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.1.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.1.2.1.1">ML-1M</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.1.2.1.2">6,041</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.1.2.1.3">3,884</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.1.2.1.4">1,000,209</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.1.5">95.74</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.3.2">
<td class="ltx_td ltx_align_left" id="S4.T1.1.3.2.1">Amazon-Book</td>
<td class="ltx_td ltx_align_right" id="S4.T1.1.3.2.2">158,349</td>
<td class="ltx_td ltx_align_right" id="S4.T1.1.3.2.3">97,566</td>
<td class="ltx_td ltx_align_right" id="S4.T1.1.3.2.4">3,876,663</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.3.2.5">99.97</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.4.3">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.1.4.3.1">Yelp2018</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T1.1.4.3.2">77,278</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T1.1.4.3.3">45,582</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T1.1.4.3.4">2,102,836</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.4.3.5">99.94</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2. </span>Evaluation protocols</h4>
<div class="ltx_para" id="S4.SS1.SSS2.p1">
<p class="ltx_p" id="S4.SS1.SSS2.p1.1">We apply the leave-one-out strategy <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib23" title="">2018</a>; Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib38" title="">2019</a>)</cite> and employ timestamps to set the sequence order, dividing the interaction data into training, validation, and test sets. The attribute-oriented retrieval tools are trained on the training and validation sets.
To measure the recommendation performance, we adopt two widely used metrics <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS2.p1.1.1">NDCG@N</span> and <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS2.p1.1.2">Recall@N</span> to evaluate the results within the top-<span class="ltx_text ltx_font_italic" id="S4.SS1.SSS2.p1.1.3">N</span> positions, with <math alttext="N=10" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p1.1.m1.1"><semantics id="S4.SS1.SSS2.p1.1.m1.1a"><mrow id="S4.SS1.SSS2.p1.1.m1.1.1" xref="S4.SS1.SSS2.p1.1.m1.1.1.cmml"><mi id="S4.SS1.SSS2.p1.1.m1.1.1.2" xref="S4.SS1.SSS2.p1.1.m1.1.1.2.cmml">N</mi><mo id="S4.SS1.SSS2.p1.1.m1.1.1.1" xref="S4.SS1.SSS2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS2.p1.1.m1.1.1.3" xref="S4.SS1.SSS2.p1.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.1.m1.1b"><apply id="S4.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1"><eq id="S4.SS1.SSS2.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1.1"></eq><ci id="S4.SS1.SSS2.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1.2">𝑁</ci><cn id="S4.SS1.SSS2.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS1.SSS2.p1.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.1.m1.1c">N=10</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.1.m1.1d">italic_N = 10</annotation></semantics></math> in our experiments.
Due to budget constraints, following prior work <cite class="ltx_cite ltx_citemacro_citep">(Gao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib11" title="">2023</a>; Hou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib17" title="">2024</a>)</cite>, we randomly sample 200 users and their historical behaviors from the test set for each dataset.
A similar, and similarly-sized, setting has been adopted in other recent LLM-related recommendation researches <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib57" title="">2024</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib58" title="">2023a</a>)</cite>.
To enhance the robustness and credibility of our results, we repeated the experiments three times, each with a different sample of 200 users.
The average results and standard deviations from these trials are presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S4.T2" title="Table 2 ‣ 4.1.2. Evaluation protocols ‣ 4.1. Experimental Settings ‣ 4. Experiments ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2. </span>The test performance comparison on three real-world datasets. The bold font denotes the winner in that column. The row “Improvement” indicates the relative performance gain of our ToolRec and the suboptimal method.</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T2.57">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.57.58.1">
<th class="ltx_td ltx_nopad_r ltx_th ltx_th_row ltx_border_tt" id="S4.T2.57.58.1.1"></th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T2.57.58.1.2">ML-1M</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T2.57.58.1.3">Amazon-Book</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T2.57.58.1.4">Yelp2018</td>
</tr>
<tr class="ltx_tr" id="S4.T2.57.59.2">
<th class="ltx_td ltx_nopad_r ltx_th ltx_th_row" id="S4.T2.57.59.2.1"></th>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" id="S4.T2.57.59.2.2">Recall</td>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" id="S4.T2.57.59.2.3">NDCG</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.57.59.2.4">Recall</td>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" id="S4.T2.57.59.2.5">NDCG</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.57.59.2.6">Recall</td>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" id="S4.T2.57.59.2.7">NDCG</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.6">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T2.6.6.7">SASRec</th>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" id="S4.T2.1.1.1">0.203<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.1.1.1.m1.1"><semantics id="S4.T2.1.1.1.m1.1a"><mo id="S4.T2.1.1.1.m1.1.1" xref="S4.T2.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.1b"><csymbol cd="latexml" id="S4.T2.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.1.1.1.1" style="font-size:70%;">0.047</span>
</td>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" id="S4.T2.2.2.2">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.2.2.2.1">0.1017</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.2.2.2.m1.1"><semantics id="S4.T2.2.2.2.m1.1a"><mo id="S4.T2.2.2.2.m1.1.1" xref="S4.T2.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.m1.1b"><csymbol cd="latexml" id="S4.T2.2.2.2.m1.1.1.cmml" xref="S4.T2.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.2.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.2.2.2.2" style="font-size:70%;">0.016</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.3.3">0.047<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.3.3.3.m1.1"><semantics id="S4.T2.3.3.3.m1.1a"><mo id="S4.T2.3.3.3.m1.1.1" xref="S4.T2.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.m1.1b"><csymbol cd="latexml" id="S4.T2.3.3.3.m1.1.1.cmml" xref="S4.T2.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.3.3.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.3.3.3.1" style="font-size:70%;">0.015</span>
</td>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" id="S4.T2.4.4.4">0.0205<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.4.4.4.m1.1"><semantics id="S4.T2.4.4.4.m1.1a"><mo id="S4.T2.4.4.4.m1.1.1" xref="S4.T2.4.4.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.4.m1.1b"><csymbol cd="latexml" id="S4.T2.4.4.4.m1.1.1.cmml" xref="S4.T2.4.4.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.4.4.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.4.4.4.1" style="font-size:70%;">0.006</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.5.5">0.030<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.5.5.5.m1.1"><semantics id="S4.T2.5.5.5.m1.1a"><mo id="S4.T2.5.5.5.m1.1.1" xref="S4.T2.5.5.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.5.m1.1b"><csymbol cd="latexml" id="S4.T2.5.5.5.m1.1.1.cmml" xref="S4.T2.5.5.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.5.5.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.5.5.5.1" style="font-size:70%;">0.005</span>
</td>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" id="S4.T2.6.6.6">0.0165<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.6.6.6.m1.1"><semantics id="S4.T2.6.6.6.m1.1a"><mo id="S4.T2.6.6.6.m1.1.1" xref="S4.T2.6.6.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.6.6.6.m1.1b"><csymbol cd="latexml" id="S4.T2.6.6.6.m1.1.1.cmml" xref="S4.T2.6.6.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.6.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.6.6.6.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.6.6.6.1" style="font-size:70%;">0.006</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.12">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S4.T2.12.12.7">BERT4Rec</th>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.7.7.1">0.158<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.7.7.1.m1.1"><semantics id="S4.T2.7.7.1.m1.1a"><mo id="S4.T2.7.7.1.m1.1.1" xref="S4.T2.7.7.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.7.7.1.m1.1b"><csymbol cd="latexml" id="S4.T2.7.7.1.m1.1.1.cmml" xref="S4.T2.7.7.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.7.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.7.7.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.7.7.1.1" style="font-size:70%;">0.024</span>
</td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.8.8.2">0.0729<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.8.8.2.m1.1"><semantics id="S4.T2.8.8.2.m1.1a"><mo id="S4.T2.8.8.2.m1.1.1" xref="S4.T2.8.8.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.8.8.2.m1.1b"><csymbol cd="latexml" id="S4.T2.8.8.2.m1.1.1.cmml" xref="S4.T2.8.8.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.8.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.8.8.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.8.8.2.1" style="font-size:70%;">0.008</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.9.9.3">0.042<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.9.9.3.m1.1"><semantics id="S4.T2.9.9.3.m1.1a"><mo id="S4.T2.9.9.3.m1.1.1" xref="S4.T2.9.9.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.9.9.3.m1.1b"><csymbol cd="latexml" id="S4.T2.9.9.3.m1.1.1.cmml" xref="S4.T2.9.9.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.9.9.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.9.9.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.9.9.3.1" style="font-size:70%;">0.015</span>
</td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.10.10.4">0.0212<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.10.10.4.m1.1"><semantics id="S4.T2.10.10.4.m1.1a"><mo id="S4.T2.10.10.4.m1.1.1" xref="S4.T2.10.10.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.10.10.4.m1.1b"><csymbol cd="latexml" id="S4.T2.10.10.4.m1.1.1.cmml" xref="S4.T2.10.10.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.10.10.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.10.10.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.10.10.4.1" style="font-size:70%;">0.009</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.11.11.5">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.11.11.5.1">0.033</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.11.11.5.m1.1"><semantics id="S4.T2.11.11.5.m1.1a"><mo id="S4.T2.11.11.5.m1.1.1" xref="S4.T2.11.11.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.11.11.5.m1.1b"><csymbol cd="latexml" id="S4.T2.11.11.5.m1.1.1.cmml" xref="S4.T2.11.11.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.11.11.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.11.11.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.11.11.5.2" style="font-size:70%;">0.021</span>
</td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.12.12.6"><span class="ltx_text ltx_font_bold" id="S4.T2.12.12.6.1">0.0218<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.12.12.6.1.m1.1"><semantics id="S4.T2.12.12.6.1.m1.1a"><mo id="S4.T2.12.12.6.1.m1.1.1" xref="S4.T2.12.12.6.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.12.12.6.1.m1.1b"><csymbol cd="latexml" id="S4.T2.12.12.6.1.m1.1.1.cmml" xref="S4.T2.12.12.6.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.12.12.6.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.12.12.6.1.m1.1d">±</annotation></semantics></math><span class="ltx_text ltx_font_medium" id="S4.T2.12.12.6.1.1" style="font-size:70%;">0.016</span></span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.18.18">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S4.T2.18.18.7">P5</th>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.13.13.1">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.13.13.1.1">0.208</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.13.13.1.m1.1"><semantics id="S4.T2.13.13.1.m1.1a"><mo id="S4.T2.13.13.1.m1.1.1" xref="S4.T2.13.13.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.13.13.1.m1.1b"><csymbol cd="latexml" id="S4.T2.13.13.1.m1.1.1.cmml" xref="S4.T2.13.13.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.13.13.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.13.13.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.13.13.1.2" style="font-size:70%;">0.021</span>
</td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.14.14.2">0.0962<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.14.14.2.m1.1"><semantics id="S4.T2.14.14.2.m1.1a"><mo id="S4.T2.14.14.2.m1.1.1" xref="S4.T2.14.14.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.14.14.2.m1.1b"><csymbol cd="latexml" id="S4.T2.14.14.2.m1.1.1.cmml" xref="S4.T2.14.14.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.14.14.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.14.14.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.14.14.2.1" style="font-size:70%;">0.009</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.15.15.3">0.006<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.15.15.3.m1.1"><semantics id="S4.T2.15.15.3.m1.1a"><mo id="S4.T2.15.15.3.m1.1.1" xref="S4.T2.15.15.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.15.15.3.m1.1b"><csymbol cd="latexml" id="S4.T2.15.15.3.m1.1.1.cmml" xref="S4.T2.15.15.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.15.15.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.15.15.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.15.15.3.1" style="font-size:70%;">0.003</span>
</td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.16.16.4">0.0026<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.16.16.4.m1.1"><semantics id="S4.T2.16.16.4.m1.1a"><mo id="S4.T2.16.16.4.m1.1.1" xref="S4.T2.16.16.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.16.16.4.m1.1b"><csymbol cd="latexml" id="S4.T2.16.16.4.m1.1.1.cmml" xref="S4.T2.16.16.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.16.16.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.16.16.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.16.16.4.1" style="font-size:70%;">0.002</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.17.17.5">0.012<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.17.17.5.m1.1"><semantics id="S4.T2.17.17.5.m1.1a"><mo id="S4.T2.17.17.5.m1.1.1" xref="S4.T2.17.17.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.17.17.5.m1.1b"><csymbol cd="latexml" id="S4.T2.17.17.5.m1.1.1.cmml" xref="S4.T2.17.17.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.17.17.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.17.17.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.17.17.5.1" style="font-size:70%;">0.005</span>
</td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.18.18.6">0.005<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.18.18.6.m1.1"><semantics id="S4.T2.18.18.6.m1.1a"><mo id="S4.T2.18.18.6.m1.1.1" xref="S4.T2.18.18.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.18.18.6.m1.1b"><csymbol cd="latexml" id="S4.T2.18.18.6.m1.1.1.cmml" xref="S4.T2.18.18.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.18.18.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.18.18.6.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.18.18.6.1" style="font-size:70%;">0.001</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.25.25">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S4.T2.19.19.1">SASRec<sub class="ltx_sub" id="S4.T2.19.19.1.1"><span class="ltx_text ltx_font_italic" id="S4.T2.19.19.1.1.1">BERT</span></sub>
</th>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.20.20.2">0.192<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.20.20.2.m1.1"><semantics id="S4.T2.20.20.2.m1.1a"><mo id="S4.T2.20.20.2.m1.1.1" xref="S4.T2.20.20.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.20.20.2.m1.1b"><csymbol cd="latexml" id="S4.T2.20.20.2.m1.1.1.cmml" xref="S4.T2.20.20.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.20.20.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.20.20.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.20.20.2.1" style="font-size:70%;">0.015</span>
</td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.21.21.3">0.0967<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.21.21.3.m1.1"><semantics id="S4.T2.21.21.3.m1.1a"><mo id="S4.T2.21.21.3.m1.1.1" xref="S4.T2.21.21.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.21.21.3.m1.1b"><csymbol cd="latexml" id="S4.T2.21.21.3.m1.1.1.cmml" xref="S4.T2.21.21.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.21.21.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.21.21.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.21.21.3.1" style="font-size:70%;">0.006</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.22.22.4">0.042<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.22.22.4.m1.1"><semantics id="S4.T2.22.22.4.m1.1a"><mo id="S4.T2.22.22.4.m1.1.1" xref="S4.T2.22.22.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.22.22.4.m1.1b"><csymbol cd="latexml" id="S4.T2.22.22.4.m1.1.1.cmml" xref="S4.T2.22.22.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.22.22.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.22.22.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.22.22.4.1" style="font-size:70%;">0.003</span>
</td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.23.23.5">0.0194<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.23.23.5.m1.1"><semantics id="S4.T2.23.23.5.m1.1a"><mo id="S4.T2.23.23.5.m1.1.1" xref="S4.T2.23.23.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.23.23.5.m1.1b"><csymbol cd="latexml" id="S4.T2.23.23.5.m1.1.1.cmml" xref="S4.T2.23.23.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.23.23.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.23.23.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.23.23.5.1" style="font-size:70%;">0.002</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.24.24.6">0.032<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.24.24.6.m1.1"><semantics id="S4.T2.24.24.6.m1.1a"><mo id="S4.T2.24.24.6.m1.1.1" xref="S4.T2.24.24.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.24.24.6.m1.1b"><csymbol cd="latexml" id="S4.T2.24.24.6.m1.1.1.cmml" xref="S4.T2.24.24.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.24.24.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.24.24.6.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.24.24.6.1" style="font-size:70%;">0.016</span>
</td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.25.25.7">0.0131<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.25.25.7.m1.1"><semantics id="S4.T2.25.25.7.m1.1a"><mo id="S4.T2.25.25.7.m1.1.1" xref="S4.T2.25.25.7.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.25.25.7.m1.1b"><csymbol cd="latexml" id="S4.T2.25.25.7.m1.1.1.cmml" xref="S4.T2.25.25.7.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.25.25.7.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.25.25.7.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.25.25.7.1" style="font-size:70%;">0.007</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.32.32">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S4.T2.26.26.1">BERT4Rec<sub class="ltx_sub" id="S4.T2.26.26.1.1"><span class="ltx_text ltx_font_italic" id="S4.T2.26.26.1.1.1">BERT</span></sub>
</th>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.27.27.2">0.202<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.27.27.2.m1.1"><semantics id="S4.T2.27.27.2.m1.1a"><mo id="S4.T2.27.27.2.m1.1.1" xref="S4.T2.27.27.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.27.27.2.m1.1b"><csymbol cd="latexml" id="S4.T2.27.27.2.m1.1.1.cmml" xref="S4.T2.27.27.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.27.27.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.27.27.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.27.27.2.1" style="font-size:70%;">0.013</span>
</td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.28.28.3">0.0961<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.28.28.3.m1.1"><semantics id="S4.T2.28.28.3.m1.1a"><mo id="S4.T2.28.28.3.m1.1.1" xref="S4.T2.28.28.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.28.28.3.m1.1b"><csymbol cd="latexml" id="S4.T2.28.28.3.m1.1.1.cmml" xref="S4.T2.28.28.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.28.28.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.28.28.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.28.28.3.1" style="font-size:70%;">0.009</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.29.29.4">0.045<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.29.29.4.m1.1"><semantics id="S4.T2.29.29.4.m1.1a"><mo id="S4.T2.29.29.4.m1.1.1" xref="S4.T2.29.29.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.29.29.4.m1.1b"><csymbol cd="latexml" id="S4.T2.29.29.4.m1.1.1.cmml" xref="S4.T2.29.29.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.29.29.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.29.29.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.29.29.4.1" style="font-size:70%;">0.023</span>
</td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.30.30.5">0.0233<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.30.30.5.m1.1"><semantics id="S4.T2.30.30.5.m1.1a"><mo id="S4.T2.30.30.5.m1.1.1" xref="S4.T2.30.30.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.30.30.5.m1.1b"><csymbol cd="latexml" id="S4.T2.30.30.5.m1.1.1.cmml" xref="S4.T2.30.30.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.30.30.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.30.30.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.30.30.5.1" style="font-size:70%;">0.012</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.31.31.6"><span class="ltx_text ltx_font_bold" id="S4.T2.31.31.6.1">0.040<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.31.31.6.1.m1.1"><semantics id="S4.T2.31.31.6.1.m1.1a"><mo id="S4.T2.31.31.6.1.m1.1.1" xref="S4.T2.31.31.6.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.31.31.6.1.m1.1b"><csymbol cd="latexml" id="S4.T2.31.31.6.1.m1.1.1.cmml" xref="S4.T2.31.31.6.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.31.31.6.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.31.31.6.1.m1.1d">±</annotation></semantics></math><span class="ltx_text ltx_font_medium" id="S4.T2.31.31.6.1.1" style="font-size:70%;">0.028</span></span></td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.32.32.7">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.32.32.7.1">0.0208</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.32.32.7.m1.1"><semantics id="S4.T2.32.32.7.m1.1a"><mo id="S4.T2.32.32.7.m1.1.1" xref="S4.T2.32.32.7.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.32.32.7.m1.1b"><csymbol cd="latexml" id="S4.T2.32.32.7.m1.1.1.cmml" xref="S4.T2.32.32.7.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.32.32.7.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.32.32.7.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.32.32.7.2" style="font-size:70%;">0.015</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.38.38">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S4.T2.38.38.7">Chat-REC</th>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.33.33.1">0.185<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.33.33.1.m1.1"><semantics id="S4.T2.33.33.1.m1.1a"><mo id="S4.T2.33.33.1.m1.1.1" xref="S4.T2.33.33.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.33.33.1.m1.1b"><csymbol cd="latexml" id="S4.T2.33.33.1.m1.1.1.cmml" xref="S4.T2.33.33.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.33.33.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.33.33.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.33.33.1.1" style="font-size:70%;">0.044</span>
</td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.34.34.2">0.1012<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.34.34.2.m1.1"><semantics id="S4.T2.34.34.2.m1.1a"><mo id="S4.T2.34.34.2.m1.1.1" xref="S4.T2.34.34.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.34.34.2.m1.1b"><csymbol cd="latexml" id="S4.T2.34.34.2.m1.1.1.cmml" xref="S4.T2.34.34.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.34.34.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.34.34.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.34.34.2.1" style="font-size:70%;">0.016</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.35.35.3">0.033<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.35.35.3.m1.1"><semantics id="S4.T2.35.35.3.m1.1a"><mo id="S4.T2.35.35.3.m1.1.1" xref="S4.T2.35.35.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.35.35.3.m1.1b"><csymbol cd="latexml" id="S4.T2.35.35.3.m1.1.1.cmml" xref="S4.T2.35.35.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.35.35.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.35.35.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.35.35.3.1" style="font-size:70%;">0.015</span>
</td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.36.36.4">0.0171<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.36.36.4.m1.1"><semantics id="S4.T2.36.36.4.m1.1a"><mo id="S4.T2.36.36.4.m1.1.1" xref="S4.T2.36.36.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.36.36.4.m1.1b"><csymbol cd="latexml" id="S4.T2.36.36.4.m1.1.1.cmml" xref="S4.T2.36.36.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.36.36.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.36.36.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.36.36.4.1" style="font-size:70%;">0.007</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.37.37.5">0.022<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.37.37.5.m1.1"><semantics id="S4.T2.37.37.5.m1.1a"><mo id="S4.T2.37.37.5.m1.1.1" xref="S4.T2.37.37.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.37.37.5.m1.1b"><csymbol cd="latexml" id="S4.T2.37.37.5.m1.1.1.cmml" xref="S4.T2.37.37.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.37.37.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.37.37.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.37.37.5.1" style="font-size:70%;">0.003</span>
</td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.38.38.6">0.0121<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.38.38.6.m1.1"><semantics id="S4.T2.38.38.6.m1.1a"><mo id="S4.T2.38.38.6.m1.1.1" xref="S4.T2.38.38.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.38.38.6.m1.1b"><csymbol cd="latexml" id="S4.T2.38.38.6.m1.1.1.cmml" xref="S4.T2.38.38.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.38.38.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.38.38.6.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.38.38.6.1" style="font-size:70%;">0.001</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.44.44">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S4.T2.44.44.7">LLMRank</th>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.39.39.1">0.183<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.39.39.1.m1.1"><semantics id="S4.T2.39.39.1.m1.1a"><mo id="S4.T2.39.39.1.m1.1.1" xref="S4.T2.39.39.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.39.39.1.m1.1b"><csymbol cd="latexml" id="S4.T2.39.39.1.m1.1.1.cmml" xref="S4.T2.39.39.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.39.39.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.39.39.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.39.39.1.1" style="font-size:70%;">0.049</span>
</td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.40.40.2">0.0991<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.40.40.2.m1.1"><semantics id="S4.T2.40.40.2.m1.1a"><mo id="S4.T2.40.40.2.m1.1.1" xref="S4.T2.40.40.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.40.40.2.m1.1b"><csymbol cd="latexml" id="S4.T2.40.40.2.m1.1.1.cmml" xref="S4.T2.40.40.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.40.40.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.40.40.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.40.40.2.1" style="font-size:70%;">0.020</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.41.41.3">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.41.41.3.1">0.047</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.41.41.3.m1.1"><semantics id="S4.T2.41.41.3.m1.1a"><mo id="S4.T2.41.41.3.m1.1.1" xref="S4.T2.41.41.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.41.41.3.m1.1b"><csymbol cd="latexml" id="S4.T2.41.41.3.m1.1.1.cmml" xref="S4.T2.41.41.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.41.41.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.41.41.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.41.41.3.2" style="font-size:70%;">0.013</span>
</td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.42.42.4">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.42.42.4.1">0.0246</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.42.42.4.m1.1"><semantics id="S4.T2.42.42.4.m1.1a"><mo id="S4.T2.42.42.4.m1.1.1" xref="S4.T2.42.42.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.42.42.4.m1.1b"><csymbol cd="latexml" id="S4.T2.42.42.4.m1.1.1.cmml" xref="S4.T2.42.42.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.42.42.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.42.42.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.42.42.4.2" style="font-size:70%;">0.004</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.43.43.5">0.030<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.43.43.5.m1.1"><semantics id="S4.T2.43.43.5.m1.1a"><mo id="S4.T2.43.43.5.m1.1.1" xref="S4.T2.43.43.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.43.43.5.m1.1b"><csymbol cd="latexml" id="S4.T2.43.43.5.m1.1.1.cmml" xref="S4.T2.43.43.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.43.43.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.43.43.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.43.43.5.1" style="font-size:70%;">0.005</span>
</td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.44.44.6">0.0140<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.44.44.6.m1.1"><semantics id="S4.T2.44.44.6.m1.1a"><mo id="S4.T2.44.44.6.m1.1.1" xref="S4.T2.44.44.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.44.44.6.m1.1b"><csymbol cd="latexml" id="S4.T2.44.44.6.m1.1.1.cmml" xref="S4.T2.44.44.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.44.44.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.44.44.6.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.44.44.6.1" style="font-size:70%;">0.004</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.50.50">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T2.50.50.7">ToolRec</th>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" id="S4.T2.45.45.1"><span class="ltx_text ltx_font_bold" id="S4.T2.45.45.1.1">0.215<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.45.45.1.1.m1.1"><semantics id="S4.T2.45.45.1.1.m1.1a"><mo id="S4.T2.45.45.1.1.m1.1.1" xref="S4.T2.45.45.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.45.45.1.1.m1.1b"><csymbol cd="latexml" id="S4.T2.45.45.1.1.m1.1.1.cmml" xref="S4.T2.45.45.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.45.45.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.45.45.1.1.m1.1d">±</annotation></semantics></math><span class="ltx_text ltx_font_medium" id="S4.T2.45.45.1.1.1" style="font-size:70%;">0.044</span></span></td>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" id="S4.T2.46.46.2"><span class="ltx_text ltx_font_bold" id="S4.T2.46.46.2.1">0.1171<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.46.46.2.1.m1.1"><semantics id="S4.T2.46.46.2.1.m1.1a"><mo id="S4.T2.46.46.2.1.m1.1.1" xref="S4.T2.46.46.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.46.46.2.1.m1.1b"><csymbol cd="latexml" id="S4.T2.46.46.2.1.m1.1.1.cmml" xref="S4.T2.46.46.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.46.46.2.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.46.46.2.1.m1.1d">±</annotation></semantics></math><span class="ltx_text ltx_font_medium" id="S4.T2.46.46.2.1.1" style="font-size:70%;">0.018</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.47.47.3"><span class="ltx_text ltx_font_bold" id="S4.T2.47.47.3.1">0.053<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.47.47.3.1.m1.1"><semantics id="S4.T2.47.47.3.1.m1.1a"><mo id="S4.T2.47.47.3.1.m1.1.1" xref="S4.T2.47.47.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.47.47.3.1.m1.1b"><csymbol cd="latexml" id="S4.T2.47.47.3.1.m1.1.1.cmml" xref="S4.T2.47.47.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.47.47.3.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.47.47.3.1.m1.1d">±</annotation></semantics></math><span class="ltx_text ltx_font_medium" id="S4.T2.47.47.3.1.1" style="font-size:70%;">0.013</span></span></td>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" id="S4.T2.48.48.4"><span class="ltx_text ltx_font_bold" id="S4.T2.48.48.4.1">0.0259<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.48.48.4.1.m1.1"><semantics id="S4.T2.48.48.4.1.m1.1a"><mo id="S4.T2.48.48.4.1.m1.1.1" xref="S4.T2.48.48.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.48.48.4.1.m1.1b"><csymbol cd="latexml" id="S4.T2.48.48.4.1.m1.1.1.cmml" xref="S4.T2.48.48.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.48.48.4.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.48.48.4.1.m1.1d">±</annotation></semantics></math><span class="ltx_text ltx_font_medium" id="S4.T2.48.48.4.1.1" style="font-size:70%;">0.005</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.49.49.5">0.028<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.49.49.5.m1.1"><semantics id="S4.T2.49.49.5.m1.1a"><mo id="S4.T2.49.49.5.m1.1.1" xref="S4.T2.49.49.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.49.49.5.m1.1b"><csymbol cd="latexml" id="S4.T2.49.49.5.m1.1.1.cmml" xref="S4.T2.49.49.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.49.49.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.49.49.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.49.49.5.1" style="font-size:70%;">0.003</span>
</td>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" id="S4.T2.50.50.6">0.0159<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.50.50.6.m1.1"><semantics id="S4.T2.50.50.6.m1.1a"><mo id="S4.T2.50.50.6.m1.1.1" xref="S4.T2.50.50.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.50.50.6.m1.1b"><csymbol cd="latexml" id="S4.T2.50.50.6.m1.1.1.cmml" xref="S4.T2.50.50.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.50.50.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.50.50.6.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.50.50.6.1" style="font-size:70%;">0.001</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.57.57">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S4.T2.51.51.1">ToolRec<sub class="ltx_sub" id="S4.T2.51.51.1.1"><span class="ltx_text ltx_font_italic" id="S4.T2.51.51.1.1.1">B</span></sub>
</th>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.52.52.2">0.185<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.52.52.2.m1.1"><semantics id="S4.T2.52.52.2.m1.1a"><mo id="S4.T2.52.52.2.m1.1.1" xref="S4.T2.52.52.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.52.52.2.m1.1b"><csymbol cd="latexml" id="S4.T2.52.52.2.m1.1.1.cmml" xref="S4.T2.52.52.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.52.52.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.52.52.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.52.52.2.1" style="font-size:70%;">0.018</span>
</td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.53.53.3">0.0895<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.53.53.3.m1.1"><semantics id="S4.T2.53.53.3.m1.1a"><mo id="S4.T2.53.53.3.m1.1.1" xref="S4.T2.53.53.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.53.53.3.m1.1b"><csymbol cd="latexml" id="S4.T2.53.53.3.m1.1.1.cmml" xref="S4.T2.53.53.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.53.53.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.53.53.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.53.53.3.1" style="font-size:70%;">0.002</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.54.54.4">0.043<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.54.54.4.m1.1"><semantics id="S4.T2.54.54.4.m1.1a"><mo id="S4.T2.54.54.4.m1.1.1" xref="S4.T2.54.54.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.54.54.4.m1.1b"><csymbol cd="latexml" id="S4.T2.54.54.4.m1.1.1.cmml" xref="S4.T2.54.54.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.54.54.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.54.54.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.54.54.4.1" style="font-size:70%;">0.013</span>
</td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.55.55.5">0.0223<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.55.55.5.m1.1"><semantics id="S4.T2.55.55.5.m1.1a"><mo id="S4.T2.55.55.5.m1.1.1" xref="S4.T2.55.55.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.55.55.5.m1.1b"><csymbol cd="latexml" id="S4.T2.55.55.5.m1.1.1.cmml" xref="S4.T2.55.55.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.55.55.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.55.55.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.55.55.5.1" style="font-size:70%;">0.008</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.56.6">0.025<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.56.56.6.m1.1"><semantics id="S4.T2.56.56.6.m1.1a"><mo id="S4.T2.56.56.6.m1.1.1" xref="S4.T2.56.56.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.56.56.6.m1.1b"><csymbol cd="latexml" id="S4.T2.56.56.6.m1.1.1.cmml" xref="S4.T2.56.56.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.56.56.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.56.56.6.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.56.56.6.1" style="font-size:70%;">0.005</span>
</td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S4.T2.57.57.7">0.0136<math alttext="\pm" class="ltx_Math" display="inline" id="S4.T2.57.57.7.m1.1"><semantics id="S4.T2.57.57.7.m1.1a"><mo id="S4.T2.57.57.7.m1.1.1" xref="S4.T2.57.57.7.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.57.57.7.m1.1b"><csymbol cd="latexml" id="S4.T2.57.57.7.m1.1.1.cmml" xref="S4.T2.57.57.7.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.57.57.7.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T2.57.57.7.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T2.57.57.7.1" style="font-size:70%;">0.009</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.57.60.3">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S4.T2.57.60.3.1">Improvement</th>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.57.60.3.2">3.36%</td>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.57.60.3.3">15.10%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.57.60.3.4">14.28%</td>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.57.60.3.5">5.14%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.57.60.3.6">–29.16%</td>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.57.60.3.7">–27.32%</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.3. </span>Baselines</h4>
<div class="ltx_para" id="S4.SS1.SSS3.p1">
<p class="ltx_p" id="S4.SS1.SSS3.p1.1">We compare ToolRec <span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>Our codes are available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/Go0day/ToolRec-Code" title="">https://github.com/Go0day/ToolRec-Code</a>.</span></span></span> against two traditional approaches (the first two below), one that uses LLMs as RSs (the following one), two that enhance RSs with LLMs (the next two), and two that use LLMs to control RSs (the remaining two).</p>
<ul class="ltx_itemize" id="S4.I3">
<li class="ltx_item" id="S4.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i1.p1">
<p class="ltx_p" id="S4.I3.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i1.p1.1.1">SASRec</span> <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib23" title="">2018</a>)</cite>. A self-attention-based sequential recommender, which employs the encoder of the Transformer architecture to generate representations of users’ behavior sequences.</p>
</div>
</li>
<li class="ltx_item" id="S4.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i2.p1">
<p class="ltx_p" id="S4.I3.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i2.p1.1.1">BERT4Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib38" title="">2019</a>)</cite>. A bidirectional self-attention-based sequential recommender. It uses the Transformer encoder to predict randomly masked items in a sequence by conditioning on both their left and right context, thereby capturing user historical behaviors.</p>
</div>
</li>
<li class="ltx_item" id="S4.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i3.p1">
<p class="ltx_p" id="S4.I3.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i3.p1.1.1">P5</span> <cite class="ltx_cite ltx_citemacro_citep">(Geng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib13" title="">2022</a>)</cite>. An encoder–decoder Transformer-based approach that unifies different recommendation related tasks into a single generative LLM.
For our sequential recommendation downstream task, we adopt the personalized prompts from OpenP5 <cite class="ltx_cite ltx_citemacro_citep">(Xu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib52" title="">2023</a>)</cite> and apply the same random indexing method to items as used in our ToolRec. This model is fully fine-tuned using these personalized prompts on the pre-trained T5-small <cite class="ltx_cite ltx_citemacro_citep">(Raffel et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib34" title="">2020</a>)</cite>.</p>
</div>
</li>
<li class="ltx_item" id="S4.I3.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i4.p1">
<p class="ltx_p" id="S4.I3.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i4.p1.1.1">SASRec<sub class="ltx_sub" id="S4.I3.i4.p1.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.I3.i4.p1.1.1.1.1">BERT</span></sub></span> <cite class="ltx_cite ltx_citemacro_citep">(Devlin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib8" title="">2019</a>)</cite>. An attention-based method that modifies the single interaction sequence encoder by adding a feature encoder (structured as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S3.F3" title="Figure 3 ‣ item Pre-training. ‣ 3.3.2. Retrieval tools ‣ 3.3. Attribute-oriented Tools ‣ 3. Methodology ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_tag">3</span></a>). This model is fully fine-tuned using semantic representations pre-trained with BERT.</p>
</div>
</li>
<li class="ltx_item" id="S4.I3.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i5.p1">
<p class="ltx_p" id="S4.I3.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i5.p1.1.1">BERT4Rec<sub class="ltx_sub" id="S4.I3.i5.p1.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.I3.i5.p1.1.1.1.1">BERT</span></sub></span>. A variation of the BERT4Rec sequential recommender enhanced with BERT’s pre-trained representations.</p>
</div>
</li>
<li class="ltx_item" id="S4.I3.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i6.p1">
<p class="ltx_p" id="S4.I3.i6.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i6.p1.1.1">Chat-REC</span> <cite class="ltx_cite ltx_citemacro_citep">(Gao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib11" title="">2023</a>)</cite>. The first work was on using an LLM as a controller. For our sequential recommendation task, we adopt the recommendation prompt based on the original paper, choose SASRec to supply the candidate items, and modify the output format for parsing.</p>
</div>
</li>
<li class="ltx_item" id="S4.I3.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i7.p1">
<p class="ltx_p" id="S4.I3.i7.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i7.p1.1.1">LLMRank</span> <cite class="ltx_cite ltx_citemacro_citep">(Hou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib17" title="">2024</a>)</cite>. A LLM-based ranking model. In our full-ranking experimental setup, we retrieve thirty candidate items (according to the original paper) from SASRec and adjust the output format for parsing.</p>
</div>
</li>
<li class="ltx_item" id="S4.I3.i8" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i8.p1">
<p class="ltx_p" id="S4.I3.i8.p1.2"><span class="ltx_text ltx_font_bold" id="S4.I3.i8.p1.2.1">ToolRec</span>. The method that we propose. We primarily evaluate two versions of ToolRec: ToolRec that is implemented using external attribute-oriented retrieval tools with frozen <math alttext="SASRec" class="ltx_Math" display="inline" id="S4.I3.i8.p1.1.m1.1"><semantics id="S4.I3.i8.p1.1.m1.1a"><mrow id="S4.I3.i8.p1.1.m1.1.1" xref="S4.I3.i8.p1.1.m1.1.1.cmml"><mi id="S4.I3.i8.p1.1.m1.1.1.2" xref="S4.I3.i8.p1.1.m1.1.1.2.cmml">S</mi><mo id="S4.I3.i8.p1.1.m1.1.1.1" xref="S4.I3.i8.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.I3.i8.p1.1.m1.1.1.3" xref="S4.I3.i8.p1.1.m1.1.1.3.cmml">A</mi><mo id="S4.I3.i8.p1.1.m1.1.1.1a" xref="S4.I3.i8.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.I3.i8.p1.1.m1.1.1.4" xref="S4.I3.i8.p1.1.m1.1.1.4.cmml">S</mi><mo id="S4.I3.i8.p1.1.m1.1.1.1b" xref="S4.I3.i8.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.I3.i8.p1.1.m1.1.1.5" xref="S4.I3.i8.p1.1.m1.1.1.5.cmml">R</mi><mo id="S4.I3.i8.p1.1.m1.1.1.1c" xref="S4.I3.i8.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.I3.i8.p1.1.m1.1.1.6" xref="S4.I3.i8.p1.1.m1.1.1.6.cmml">e</mi><mo id="S4.I3.i8.p1.1.m1.1.1.1d" xref="S4.I3.i8.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.I3.i8.p1.1.m1.1.1.7" xref="S4.I3.i8.p1.1.m1.1.1.7.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I3.i8.p1.1.m1.1b"><apply id="S4.I3.i8.p1.1.m1.1.1.cmml" xref="S4.I3.i8.p1.1.m1.1.1"><times id="S4.I3.i8.p1.1.m1.1.1.1.cmml" xref="S4.I3.i8.p1.1.m1.1.1.1"></times><ci id="S4.I3.i8.p1.1.m1.1.1.2.cmml" xref="S4.I3.i8.p1.1.m1.1.1.2">𝑆</ci><ci id="S4.I3.i8.p1.1.m1.1.1.3.cmml" xref="S4.I3.i8.p1.1.m1.1.1.3">𝐴</ci><ci id="S4.I3.i8.p1.1.m1.1.1.4.cmml" xref="S4.I3.i8.p1.1.m1.1.1.4">𝑆</ci><ci id="S4.I3.i8.p1.1.m1.1.1.5.cmml" xref="S4.I3.i8.p1.1.m1.1.1.5">𝑅</ci><ci id="S4.I3.i8.p1.1.m1.1.1.6.cmml" xref="S4.I3.i8.p1.1.m1.1.1.6">𝑒</ci><ci id="S4.I3.i8.p1.1.m1.1.1.7.cmml" xref="S4.I3.i8.p1.1.m1.1.1.7">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I3.i8.p1.1.m1.1c">SASRec</annotation><annotation encoding="application/x-llamapun" id="S4.I3.i8.p1.1.m1.1d">italic_S italic_A italic_S italic_R italic_e italic_c</annotation></semantics></math> parameters; and ToolRec<sub class="ltx_sub" id="S4.I3.i8.p1.2.2"><span class="ltx_text ltx_font_italic" id="S4.I3.i8.p1.2.2.1">B</span></sub> that is developed using BERT4Rec as the backbone for external attribute-oriented retrieval tools.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.4. </span>Implementation details</h4>
<div class="ltx_para" id="S4.SS1.SSS4.p1">
<p class="ltx_p" id="S4.SS1.SSS4.p1.1">We use the gpt-3.5-turbo-16k (ChatGPT for short) model as our primary LLM within ToolRec. This model is responsible for parsing user preferences and assisting in tool learning. We retain the default hyperparameters of ChatGPT without modifications.
To enable ToolRec to emulate user decisions, we incorporate decision demonstrations into the prompt for in-context-learning.
For attribute-oriented tools, retrieval tools are enhanced with corresponding additional item attributes specific to each dataset. Attributes are represented using word embeddings from GloVe <cite class="ltx_cite ltx_citemacro_citep">(Pennington et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib30" title="">2014</a>)</cite>. These tools are developed on two widely recognized backbones: SASRec and BERT4Rec. Additionally, our rank tools are constructed with instructions on ChatGPT. We limit our decision processes to a maximum of eight rounds.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Performance Comparison (RQ1)</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We compare our proposal with conventional sequential recommenders and LLM-enhanced sequential recommenders, as detailed in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S4.SS1.SSS3" title="4.1.3. Baselines ‣ 4.1. Experimental Settings ‣ 4. Experiments ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_tag">4.1.3</span></a>. The results are reported in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S4.T2" title="Table 2 ‣ 4.1.2. Evaluation protocols ‣ 4.1. Experimental Settings ‣ 4. Experiments ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_tag">2</span></a>, from which we observe:</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<ul class="ltx_itemize" id="S4.I4">
<li class="ltx_item" id="S4.I4.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I4.i1.p1">
<p class="ltx_p" id="S4.I4.i1.p1.1">In general, ToolRec  outperforms all baselines on the ML-1M and Amazon-Book datasets.
The performance improvement can be attributed to the efficacy of our designed ToolRec  framework. By delving into various facets of the item pool and utilizing LLMs to guide the exploration process, it can more effectively align with the user’s intent.</p>
</div>
</li>
<li class="ltx_item" id="S4.I4.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I4.i2.p1">
<p class="ltx_p" id="S4.I4.i2.p1.1">ToolRec and ToolRec<sub class="ltx_sub" id="S4.I4.i2.p1.1.1"><span class="ltx_text ltx_font_italic" id="S4.I4.i2.p1.1.1.1">B</span></sub> consistently demonstrate improved performance compared to their respective underlying models (i.e.,  SASRec and BERT4Rec).
This confirms the superiority of the ToolRec framework and underscores its adaptability.
The results suggest that our approach, which harnesses LLMs for recommendation through tool learning, has the potential to be integrated as a supplementary module in various recommendation systems.</p>
</div>
</li>
<li class="ltx_item" id="S4.I4.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I4.i3.p1">
<p class="ltx_p" id="S4.I4.i3.p1.1">ToolRec exhibits subpar performance on the Yelp2018 dataset. We attribute this to the LLM’s limited knowledge of local businesses. Since LLMs are primarily trained on widely available web data, they might possess a more robust understanding of topics like movies and books than local (niche) businesses.
In more specialized domains, ToolRec, which involves multiple interactions between the LLM and external tools, has the potential to make more incorrect decisions and may exhibit heightened deficiencies when compared to other LLM-based approaches such as LLMRank and SASRec<math alttext="{}_{\text{BERT}}" class="ltx_Math" display="inline" id="S4.I4.i3.p1.1.m1.1"><semantics id="S4.I4.i3.p1.1.m1.1a"><msub id="S4.I4.i3.p1.1.m1.1.1" xref="S4.I4.i3.p1.1.m1.1.1.cmml"><mi id="S4.I4.i3.p1.1.m1.1.1a" xref="S4.I4.i3.p1.1.m1.1.1.cmml"></mi><mtext id="S4.I4.i3.p1.1.m1.1.1.1" xref="S4.I4.i3.p1.1.m1.1.1.1a.cmml">BERT</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.I4.i3.p1.1.m1.1b"><apply id="S4.I4.i3.p1.1.m1.1.1.cmml" xref="S4.I4.i3.p1.1.m1.1.1"><ci id="S4.I4.i3.p1.1.m1.1.1.1a.cmml" xref="S4.I4.i3.p1.1.m1.1.1.1"><mtext id="S4.I4.i3.p1.1.m1.1.1.1.cmml" mathsize="70%" xref="S4.I4.i3.p1.1.m1.1.1.1">BERT</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I4.i3.p1.1.m1.1c">{}_{\text{BERT}}</annotation><annotation encoding="application/x-llamapun" id="S4.I4.i3.p1.1.m1.1d">start_FLOATSUBSCRIPT BERT end_FLOATSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S4.I4.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I4.i4.p1">
<p class="ltx_p" id="S4.I4.i4.p1.1">In the approach where LLMs serve as RSs, P5 demonstrates strong performance on the ML-1M. This is exciting, considering we use datasets on the scale of millions (Table <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S4.T1" title="Table 1 ‣ 4.1.1. Datasets ‣ 4.1. Experimental Settings ‣ 4. Experiments ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_tag">1</span></a>), and accurately generating items for users is challenging. However, P5 shows weaker performance on the Amazon-Book and Yelp2018 datasets, potentially due to the fact that the sparsity of those datasets is higher than ML-1M, thus leading to more severe hallucination issues. The development of more carefully designed item indexing methods <cite class="ltx_cite ltx_citemacro_citep">(Hua et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib21" title="">2023</a>)</cite> may help alleviate this problem, but this falls beyond the scope of our current research.</p>
</div>
</li>
<li class="ltx_item" id="S4.I4.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I4.i5.p1">
<p class="ltx_p" id="S4.I4.i5.p1.4">For LLM-enhanced RS approaches, such as SASRec<sub class="ltx_sub" id="S4.I4.i5.p1.4.1"><span class="ltx_text ltx_font_italic" id="S4.I4.i5.p1.4.1.1">BERT</span></sub> and BERT4Rec<sub class="ltx_sub" id="S4.I4.i5.p1.4.2"><span class="ltx_text ltx_font_italic" id="S4.I4.i5.p1.4.2.1">BERT</span></sub>, it is not surprising to see improvements over their backbone models in most cases. However, on the ML-1M dataset, SASRec<sub class="ltx_sub" id="S4.I4.i5.p1.4.3"><span class="ltx_text ltx_font_italic" id="S4.I4.i5.p1.4.3.1">BERT</span></sub> performs much worse than SASRec. Meanwhile, on the Amazon-Book dataset, BERT4Rec<sub class="ltx_sub" id="S4.I4.i5.p1.4.4"><span class="ltx_text ltx_font_italic" id="S4.I4.i5.p1.4.4.1">BERT</span></sub>’s performance is comparable to its baseline version. While language models can generally augment recommendation tasks, addressing the disparity between semantic and behavioral spaces remains challenging.</p>
</div>
</li>
<li class="ltx_item" id="S4.I4.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I4.i6.p1">
<p class="ltx_p" id="S4.I4.i6.p1.1">For LLM-controlled RS approaches, such as Chat-REC and LLMRank, they couldn’t achieve consistent improvements over SASRec in the same way as ToolRec. This suggests that merely using basic control strategies or employing LLM as a ranker might not be the most effective way forward for recommendation tasks.
A more comprehensive strategy, as demonstrated by ToolRec, appears better suited to harnessing LLMs to enhance recommendations.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Decomposing ToolRec  (RQ2)</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">Next, we delve deeper into ToolRec. We examine the user decision simulation, revealing how multi-round interactions enhance recommendation quality. We evaluate the efficiency of our attribute-oriented retrieval tools, highlighting the balance between rich information and computational practicality.</p>
</div>
<section class="ltx_subsubsection" id="S4.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1. </span>Effectiveness of user decision simulation</h4>
<div class="ltx_para" id="S4.SS3.SSS1.p1">
<p class="ltx_p" id="S4.SS3.SSS1.p1.1">To verify the contribution of the user decision simulation component (cf. Section <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S3.I1.ix1" title="item Chain-of-thought prompting (CoT). ‣ 3.2. User Decision Simulation ‣ 3. Methodology ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_tag"><span class="ltx_text ltx_font_bold">Chain-of-thought prompting (CoT).: </span></span></a>), we conducted an ablation study considering three variants of ToolRec:

<span class="ltx_inline-enumerate" id="S4.I5">
<span class="ltx_inline-item" id="S4.I5.i1"><span class="ltx_tag ltx_tag_inline-item">(i)</span> <span class="ltx_text" id="S4.I5.i1.1">Disabling the CoT and tool learning components of ToolRec, we forced the LLM to rank the candidate items from SASRec and output the result. This variant is denoted as “w/ single”;
</span></span>
<span class="ltx_inline-item" id="S4.I5.i2"><span class="ltx_tag ltx_tag_inline-item">(ii)</span> <span class="ltx_text" id="S4.I5.i2.1">Unlike “w/ single”, we had the LLM rank candidate items using both SASRec and the attribute-oriented retrieval tools, termed “w/ multi”;
</span></span>
<span class="ltx_inline-item" id="S4.I5.i3"><span class="ltx_tag ltx_tag_inline-item">(iii)</span> <span class="ltx_text" id="S4.I5.i3.1">We disable the CoT component, and instead, the LLM was instructed to generate all the steps of tool-calling at once and then strictly follow the execution plan. This setup is termed “w/ Plan”.
</span></span>
</span>
To ensure fairness in our comparisons, both the “w/ single” and “w/ multi” variants use the same number of candidate items: thirty items in total.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS1.p2">
<p class="ltx_p" id="S4.SS3.SSS1.p2.1">We demonstrate the experimental results in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S4.F4" title="Figure 4 ‣ 4.3.1. Effectiveness of user decision simulation ‣ 4.3. Decomposing ToolRec (RQ2) ‣ 4. Experiments ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_tag">4</span></a> and have the following findings:</p>
<ul class="ltx_itemize" id="S4.I6">
<li class="ltx_item" id="S4.I6.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I6.i1.p1">
<p class="ltx_p" id="S4.I6.i1.p1.1">Removing the CoT and tool learning component degrades the model’s performance. The “w/ single” variant consistently underperforms both “w/ multi” and “w/ Plan”, and its performance is even subpar compared to SASRec.
This decline in performance can be attributed to “w/ single” relying exclusively on the LLM’s zero-shot ranking without leveraging additional information to refine the results.</p>
</div>
</li>
<li class="ltx_item" id="S4.I6.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I6.i2.p1">
<p class="ltx_p" id="S4.I6.i2.p1.2">It is important to note that the performance of attribute-oriented retrieval tools, namely “frozen + <math alttext="a" class="ltx_Math" display="inline" id="S4.I6.i2.p1.1.m1.1"><semantics id="S4.I6.i2.p1.1.m1.1a"><mi id="S4.I6.i2.p1.1.m1.1.1" xref="S4.I6.i2.p1.1.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.I6.i2.p1.1.m1.1b"><ci id="S4.I6.i2.p1.1.m1.1.1.cmml" xref="S4.I6.i2.p1.1.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I6.i2.p1.1.m1.1c">a</annotation><annotation encoding="application/x-llamapun" id="S4.I6.i2.p1.1.m1.1d">italic_a</annotation></semantics></math>1” and “frozen + <math alttext="a" class="ltx_Math" display="inline" id="S4.I6.i2.p1.2.m2.1"><semantics id="S4.I6.i2.p1.2.m2.1a"><mi id="S4.I6.i2.p1.2.m2.1.1" xref="S4.I6.i2.p1.2.m2.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.I6.i2.p1.2.m2.1b"><ci id="S4.I6.i2.p1.2.m2.1.1.cmml" xref="S4.I6.i2.p1.2.m2.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I6.i2.p1.2.m2.1c">a</annotation><annotation encoding="application/x-llamapun" id="S4.I6.i2.p1.2.m2.1d">italic_a</annotation></semantics></math>2”, is inferior to SASRec in dataset ML-1M. However, results refined by ’w/ multi’ not only surpass ’w/ single’ but also outperform SASRec. This improvement suggests that the strength of our approach is not solely due to the broader item size, but also derives from the assistance of the additional attribute information.</p>
</div>
</li>
<li class="ltx_item" id="S4.I6.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I6.i3.p1">
<p class="ltx_p" id="S4.I6.i3.p1.1">When comparing “w/ Plan” with “w/ multi”, the latter consistently achieves superior results. One potential reason might be that the “generate-then-execute” approach in “w/ Plan” lacks explicit performance guidance, causing it to miss the target. This further underscores the importance of the user decision simulation in our approach.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_figure" id="S4.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F4.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="334" id="S4.F4.sf1.g1" src="x5.png" width="829"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>ML-1M.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F4.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="320" id="S4.F4.sf2.g1" src="x6.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Amazon-Book.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4. </span>Performance of ToolRec and its variants. The right side of the dividing line indicating the methods involving LLMs.</figcaption>
</figure>
<figure class="ltx_figure" id="S4.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F5.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="398" id="S4.F5.sf1.g1" src="x7.png" width="831"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>ML-1M.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F5.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="398" id="S4.F5.sf2.g1" src="x8.png" width="831"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Amazon-Book.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5. </span>Distribution of termination rounds for ToolRec. “His Round” indicates the distribution of termination rounds for all users, while “Hit Round” highlights the termination round where the recommended list accurately contains the user’s target item.</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2. </span>Analysis of round termination in ToolRec</h4>
<div class="ltx_para" id="S4.SS3.SSS2.p1">
<p class="ltx_p" id="S4.SS3.SSS2.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S4.F5" title="Figure 5 ‣ 4.3.1. Effectiveness of user decision simulation ‣ 4.3. Decomposing ToolRec (RQ2) ‣ 4. Experiments ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_tag">5</span></a> illustrates the distribution of the number of termination rounds, <math alttext="N" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p1.1.m1.1"><semantics id="S4.SS3.SSS2.p1.1.m1.1a"><mi id="S4.SS3.SSS2.p1.1.m1.1.1" xref="S4.SS3.SSS2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p1.1.m1.1b"><ci id="S4.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p1.1.m1.1d">italic_N</annotation></semantics></math>, in ToolRec.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS2.p2">
<p class="ltx_p" id="S4.SS3.SSS2.p2.1">Based on the data, we make the following observations:

<span class="ltx_inline-enumerate" id="S4.I7">
<span class="ltx_inline-item" id="S4.I7.i1"><span class="ltx_tag ltx_tag_inline-item">(i)</span> <span class="ltx_text" id="S4.I7.i1.1">The majority of processes conclude within three or four rounds. This suggests that after a few iterations, our LLM-based surrogate user, denoted as <math alttext="\hat{u}" class="ltx_Math" display="inline" id="S4.I7.i1.1.m1.1"><semantics id="S4.I7.i1.1.m1.1a"><mover accent="true" id="S4.I7.i1.1.m1.1.1" xref="S4.I7.i1.1.m1.1.1.cmml"><mi id="S4.I7.i1.1.m1.1.1.2" xref="S4.I7.i1.1.m1.1.1.2.cmml">u</mi><mo id="S4.I7.i1.1.m1.1.1.1" xref="S4.I7.i1.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.I7.i1.1.m1.1b"><apply id="S4.I7.i1.1.m1.1.1.cmml" xref="S4.I7.i1.1.m1.1.1"><ci id="S4.I7.i1.1.m1.1.1.1.cmml" xref="S4.I7.i1.1.m1.1.1.1">^</ci><ci id="S4.I7.i1.1.m1.1.1.2.cmml" xref="S4.I7.i1.1.m1.1.1.2">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I7.i1.1.m1.1c">\hat{u}</annotation><annotation encoding="application/x-llamapun" id="S4.I7.i1.1.m1.1d">over^ start_ARG italic_u end_ARG</annotation></semantics></math>, develops a good understanding of whether the user’s preferences have been adequately addressed.
</span></span>
<span class="ltx_inline-item" id="S4.I7.i2"><span class="ltx_tag ltx_tag_inline-item">(ii)</span> <span class="ltx_text" id="S4.I7.i2.2">While the majority of successful hits also occur within three or four rounds, an interesting trend emerges in the ML-1M dataset: both shorter and longer processes tend to be more successful in reaching the target item. One interpretation is that shorter rounds signify tasks that are more straightforward for the surrogate user <math alttext="\hat{u}" class="ltx_Math" display="inline" id="S4.I7.i2.1.m1.1"><semantics id="S4.I7.i2.1.m1.1a"><mover accent="true" id="S4.I7.i2.1.m1.1.1" xref="S4.I7.i2.1.m1.1.1.cmml"><mi id="S4.I7.i2.1.m1.1.1.2" xref="S4.I7.i2.1.m1.1.1.2.cmml">u</mi><mo id="S4.I7.i2.1.m1.1.1.1" xref="S4.I7.i2.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.I7.i2.1.m1.1b"><apply id="S4.I7.i2.1.m1.1.1.cmml" xref="S4.I7.i2.1.m1.1.1"><ci id="S4.I7.i2.1.m1.1.1.1.cmml" xref="S4.I7.i2.1.m1.1.1.1">^</ci><ci id="S4.I7.i2.1.m1.1.1.2.cmml" xref="S4.I7.i2.1.m1.1.1.2">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I7.i2.1.m1.1c">\hat{u}</annotation><annotation encoding="application/x-llamapun" id="S4.I7.i2.1.m1.1d">over^ start_ARG italic_u end_ARG</annotation></semantics></math>. But for users with diverse interests or nuanced tastes, <math alttext="\hat{u}" class="ltx_Math" display="inline" id="S4.I7.i2.2.m2.1"><semantics id="S4.I7.i2.2.m2.1a"><mover accent="true" id="S4.I7.i2.2.m2.1.1" xref="S4.I7.i2.2.m2.1.1.cmml"><mi id="S4.I7.i2.2.m2.1.1.2" xref="S4.I7.i2.2.m2.1.1.2.cmml">u</mi><mo id="S4.I7.i2.2.m2.1.1.1" xref="S4.I7.i2.2.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.I7.i2.2.m2.1b"><apply id="S4.I7.i2.2.m2.1.1.cmml" xref="S4.I7.i2.2.m2.1.1"><ci id="S4.I7.i2.2.m2.1.1.1.cmml" xref="S4.I7.i2.2.m2.1.1.1">^</ci><ci id="S4.I7.i2.2.m2.1.1.2.cmml" xref="S4.I7.i2.2.m2.1.1.2">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I7.i2.2.m2.1c">\hat{u}</annotation><annotation encoding="application/x-llamapun" id="S4.I7.i2.2.m2.1d">over^ start_ARG italic_u end_ARG</annotation></semantics></math> might need additional rounds to gather more information and determine if the recommendation process has been satisfactorily completed.
</span></span>
</span></p>
</div>
<figure class="ltx_figure" id="S4.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="273" id="S4.F6.sf1.g1" src="x9.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>ML-1M.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="273" id="S4.F6.sf2.g1" src="x10.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Amazon-Book.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6. </span>Comparison of trainable parameters and FLOPs for various retrieval model configurations.</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.3. </span>Efficiency and scalability of attribute-oriented retrieval tools</h4>
<div class="ltx_para" id="S4.SS3.SSS3.p1">
<p class="ltx_p" id="S4.SS3.SSS3.p1.2">As elaborated in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S3.SS3" title="3.3. Attribute-oriented Tools ‣ 3. Methodology ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_tag">3.3</span></a>, the attribute-oriented retrieval tools are designed to adeptly follow diverse attribute choices.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S4.F6" title="Figure 6 ‣ 4.3.2. Analysis of round termination in ToolRec ‣ 4.3. Decomposing ToolRec (RQ2) ‣ 4. Experiments ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_tag">6</span></a> compares the number of trainable parameters and FLOPs on the ML-1M and Amazon-Book datasets. Here, ‘forzen+<math alttext="a" class="ltx_Math" display="inline" id="S4.SS3.SSS3.p1.1.m1.1"><semantics id="S4.SS3.SSS3.p1.1.m1.1a"><mi id="S4.SS3.SSS3.p1.1.m1.1.1" xref="S4.SS3.SSS3.p1.1.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS3.p1.1.m1.1b"><ci id="S4.SS3.SSS3.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS3.p1.1.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS3.p1.1.m1.1c">a</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS3.p1.1.m1.1d">italic_a</annotation></semantics></math>1’ represents our attribute-oriented retrieval tool with frozen backbone parameters, while ‘full+<math alttext="a" class="ltx_Math" display="inline" id="S4.SS3.SSS3.p1.2.m2.1"><semantics id="S4.SS3.SSS3.p1.2.m2.1a"><mi id="S4.SS3.SSS3.p1.2.m2.1.1" xref="S4.SS3.SSS3.p1.2.m2.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS3.p1.2.m2.1b"><ci id="S4.SS3.SSS3.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS3.p1.2.m2.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS3.p1.2.m2.1c">a</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS3.p1.2.m2.1d">italic_a</annotation></semantics></math>1’ denotes its full fine-tuning variant.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS3.p2">
<p class="ltx_p" id="S4.SS3.SSS3.p2.1">We have the following observations:

<span class="ltx_inline-enumerate" id="S4.I8">
<span class="ltx_inline-item" id="S4.I8.i1"><span class="ltx_tag ltx_tag_inline-item">(i)</span> <span class="ltx_text" id="S4.I8.i1.1">The SASRec<sub class="ltx_sub" id="S4.I8.i1.1.1"><span class="ltx_text ltx_font_italic" id="S4.I8.i1.1.1.1">BERT</span></sub> model is considerably larger than the original SASRec. This increase in size can be attributed to the enriched semantic information present in the BERT embedding.
</span></span>
<span class="ltx_inline-item" id="S4.I8.i2"><span class="ltx_tag ltx_tag_inline-item">(ii)</span> <span class="ltx_text" id="S4.I8.i2.1">The trainable parameter count for ‘full+<math alttext="a" class="ltx_Math" display="inline" id="S4.I8.i2.1.m1.1"><semantics id="S4.I8.i2.1.m1.1a"><mi id="S4.I8.i2.1.m1.1.1" xref="S4.I8.i2.1.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.I8.i2.1.m1.1b"><ci id="S4.I8.i2.1.m1.1.1.cmml" xref="S4.I8.i2.1.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I8.i2.1.m1.1c">a</annotation><annotation encoding="application/x-llamapun" id="S4.I8.i2.1.m1.1d">italic_a</annotation></semantics></math>1’ aligns closely with that of SASRec. Essentially, this is akin to training an entirely new model. Such an approach becomes impractical as the number of attributes escalates.
</span></span>
<span class="ltx_inline-item" id="S4.I8.i3"><span class="ltx_tag ltx_tag_inline-item">(iii)</span> <span class="ltx_text" id="S4.I8.i3.3">While both ‘forzen+<math alttext="a" class="ltx_Math" display="inline" id="S4.I8.i3.1.m1.1"><semantics id="S4.I8.i3.1.m1.1a"><mi id="S4.I8.i3.1.m1.1.1" xref="S4.I8.i3.1.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.I8.i3.1.m1.1b"><ci id="S4.I8.i3.1.m1.1.1.cmml" xref="S4.I8.i3.1.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I8.i3.1.m1.1c">a</annotation><annotation encoding="application/x-llamapun" id="S4.I8.i3.1.m1.1d">italic_a</annotation></semantics></math>1’ and ‘full+<math alttext="a" class="ltx_Math" display="inline" id="S4.I8.i3.2.m2.1"><semantics id="S4.I8.i3.2.m2.1a"><mi id="S4.I8.i3.2.m2.1.1" xref="S4.I8.i3.2.m2.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.I8.i3.2.m2.1b"><ci id="S4.I8.i3.2.m2.1.1.cmml" xref="S4.I8.i3.2.m2.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I8.i3.2.m2.1c">a</annotation><annotation encoding="application/x-llamapun" id="S4.I8.i3.2.m2.1d">italic_a</annotation></semantics></math>1’ exhibit identical FLOPs, the former boasts a significantly reduced count of trainable parameters compared to the latter. Moreover, since our ‘forzen+<math alttext="a" class="ltx_Math" display="inline" id="S4.I8.i3.3.m3.1"><semantics id="S4.I8.i3.3.m3.1a"><mi id="S4.I8.i3.3.m3.1.1" xref="S4.I8.i3.3.m3.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.I8.i3.3.m3.1b"><ci id="S4.I8.i3.3.m3.1.1.cmml" xref="S4.I8.i3.3.m3.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I8.i3.3.m3.1c">a</annotation><annotation encoding="application/x-llamapun" id="S4.I8.i3.3.m3.1d">italic_a</annotation></semantics></math>1’ employs the shared backbone of SASRec, storage is primarily reserved for the additive parameters from the attribute-specific encoder and the dense layer.
</span></span>
</span></p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4. </span>Surprises and Limitations (RQ3)</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">ToolRec benefits from LLMs to reason about users’ preferences across attributes, enabling multi-round interaction processes and improved recommendations.</p>
</div>
<div class="ltx_para" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.1">However, language models are not inherently designed for recommendation tasks.
Below, we discuss the failures and limitations this gives rise to.</p>
</div>
<section class="ltx_subsubsection" id="S4.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.4.1. </span>Unanticipated outcomes: Beyond conventional failures</h4>
<div class="ltx_para" id="S4.SS4.SSS1.p1">
<p class="ltx_p" id="S4.SS4.SSS1.p1.1">For a rigorous comparison with existing baselines, we employed the Memory strategy (cf. Section <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S3.SS4" title="3.4. Memory Strategy ‣ 3. Methodology ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_tag">3.4</span></a>). This strategy ensures that returned items align with the dataset directory, prompting a re-run if discrepancies arise.</p>
</div>
<div class="ltx_para" id="S4.SS4.SSS1.p2">
<p class="ltx_p" id="S4.SS4.SSS1.p2.1">However, beyond the traditional recommendation paradigm, some samples that are typically classified as “failures” deserve a second look.</p>
</div>
<figure class="ltx_figure" id="S4.F7"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="708" id="S4.F7.g1" src="x11.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 7. </span>Case study of parsing errors in output samples. Highlighted samples have been manually verified to exist in the real world.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS4.SSS1.p3">
<p class="ltx_p" id="S4.SS4.SSS1.p3.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S4.F7" title="Figure 7 ‣ 4.4.1. Unanticipated outcomes: Beyond conventional failures ‣ 4.4. Surprises and Limitations (RQ3) ‣ 4. Experiments ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_tag">7</span></a> shows an example. At <span class="ltx_text ltx_font_italic" id="S4.SS4.SSS1.p3.1.1">Thought 5</span>, when our LLM-based surrogate user, <math alttext="\hat{u}" class="ltx_Math" display="inline" id="S4.SS4.SSS1.p3.1.m1.1"><semantics id="S4.SS4.SSS1.p3.1.m1.1a"><mover accent="true" id="S4.SS4.SSS1.p3.1.m1.1.1" xref="S4.SS4.SSS1.p3.1.m1.1.1.cmml"><mi id="S4.SS4.SSS1.p3.1.m1.1.1.2" xref="S4.SS4.SSS1.p3.1.m1.1.1.2.cmml">u</mi><mo id="S4.SS4.SSS1.p3.1.m1.1.1.1" xref="S4.SS4.SSS1.p3.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS1.p3.1.m1.1b"><apply id="S4.SS4.SSS1.p3.1.m1.1.1.cmml" xref="S4.SS4.SSS1.p3.1.m1.1.1"><ci id="S4.SS4.SSS1.p3.1.m1.1.1.1.cmml" xref="S4.SS4.SSS1.p3.1.m1.1.1.1">^</ci><ci id="S4.SS4.SSS1.p3.1.m1.1.1.2.cmml" xref="S4.SS4.SSS1.p3.1.m1.1.1.2">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS1.p3.1.m1.1c">\hat{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS1.p3.1.m1.1d">over^ start_ARG italic_u end_ARG</annotation></semantics></math>, is unsatisfied with the retrieved movies, it typically evaluates the unsatisfactory attributes and uses external tools to uncover additional options, thereby refining the recommendation.</p>
</div>
<div class="ltx_para" id="S4.SS4.SSS1.p4">
<p class="ltx_p" id="S4.SS4.SSS1.p4.2">Yet, in this scenario, rather than using external tools or settling for the current list of candidates, <math alttext="\hat{u}" class="ltx_Math" display="inline" id="S4.SS4.SSS1.p4.1.m1.1"><semantics id="S4.SS4.SSS1.p4.1.m1.1a"><mover accent="true" id="S4.SS4.SSS1.p4.1.m1.1.1" xref="S4.SS4.SSS1.p4.1.m1.1.1.cmml"><mi id="S4.SS4.SSS1.p4.1.m1.1.1.2" xref="S4.SS4.SSS1.p4.1.m1.1.1.2.cmml">u</mi><mo id="S4.SS4.SSS1.p4.1.m1.1.1.1" xref="S4.SS4.SSS1.p4.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS1.p4.1.m1.1b"><apply id="S4.SS4.SSS1.p4.1.m1.1.1.cmml" xref="S4.SS4.SSS1.p4.1.m1.1.1"><ci id="S4.SS4.SSS1.p4.1.m1.1.1.1.cmml" xref="S4.SS4.SSS1.p4.1.m1.1.1.1">^</ci><ci id="S4.SS4.SSS1.p4.1.m1.1.1.2.cmml" xref="S4.SS4.SSS1.p4.1.m1.1.1.2">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS1.p4.1.m1.1c">\hat{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS1.p4.1.m1.1d">over^ start_ARG italic_u end_ARG</annotation></semantics></math> decides to suggest “some popular movies”, providing a top-<math alttext="N" class="ltx_Math" display="inline" id="S4.SS4.SSS1.p4.2.m2.1"><semantics id="S4.SS4.SSS1.p4.2.m2.1a"><mi id="S4.SS4.SSS1.p4.2.m2.1.1" xref="S4.SS4.SSS1.p4.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS1.p4.2.m2.1b"><ci id="S4.SS4.SSS1.p4.2.m2.1.1.cmml" xref="S4.SS4.SSS1.p4.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS1.p4.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS1.p4.2.m2.1d">italic_N</annotation></semantics></math> recommendation on its own. Since we never trained the LLM on any of our recommendation datasets, it is evident that not all of the movies it suggests are found in the ML-1M dataset. As a result, this action is labeled as a “failure”, prompting a re-run. However, from another perspective, this could be viewed as a successful recommendation; the only limitation is our inability to evaluate it within the current dataset constraints.</p>
</div>
<figure class="ltx_figure" id="S4.F8">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F8.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="353" id="S4.F8.sf1.g1" src="x12.png" width="746"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>ML-1M.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F8.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="353" id="S4.F8.sf2.g1" src="x13.png" width="746"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Yelp2018.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8. </span>Ranking performance across different LLMs.</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS4.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.4.2. </span>Influence of LLM selection on recommendation performance</h4>
<div class="ltx_para" id="S4.SS4.SSS2.p1">
<p class="ltx_p" id="S4.SS4.SSS2.p1.1">Following the experimental setup described in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S4.SS1" title="4.1. Experimental Settings ‣ 4. Experiments ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_tag">4.1</span></a>, we replace the base LLM with two alternative LLMs: Vicuna1.5-13B-16k <cite class="ltx_cite ltx_citemacro_citep">(Chiang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib6" title="">2023</a>)</cite> (Vicuna in short), an open-source chatbot fine-tuned on Llama2 <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib41" title="">2023b</a>)</cite>; and PaLM <cite class="ltx_cite ltx_citemacro_citep">(Chowdhery et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib7" title="">2023</a>)</cite>, a commercial LLM developed by Google AI.
However, both variants yielded subpar outcomes, either failing to adhere to task instructions, misconstruing tool usage, or misinterpreting user preferences (some representative failures are cataloged in the Appendix).
Notably, even though Vicuna and PaLM use the same prompt template as ChatGPT, they are unable to consistently generate recommendations across all test users, despite several attempts.
This suggests that ChatGPT has better reasoning capabilities than both Vicuna and PaLM.
</p>
</div>
<div class="ltx_para" id="S4.SS4.SSS2.p2">
<p class="ltx_p" id="S4.SS4.SSS2.p2.1">Beyond reasoning, a ranking experiment was conducted (cf. Section <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S4.SS3.SSS1" title="4.3.1. Effectiveness of user decision simulation ‣ 4.3. Decomposing ToolRec (RQ2) ‣ 4. Experiments ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_tag">4.3.1</span></a>, w/ multi) to examine the open-world knowledge of various LLMs.
As revealed in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#S4.F8" title="Figure 8 ‣ 4.4.1. Unanticipated outcomes: Beyond conventional failures ‣ 4.4. Surprises and Limitations (RQ3) ‣ 4. Experiments ‣ Let Me Do It For You: Towards LLM Empowered Recommendation via Tool Learning"><span class="ltx_text ltx_ref_tag">8</span></a>, on datasets like ML-1M (and similar outcomes on Amazon-Book), both Vicuna and PaLM underperformed SASRec, whereas ChatGPT exhibited superior results. These findings align with insights presented in LLMRank <cite class="ltx_cite ltx_citemacro_citep">(Hou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.15114v1#bib.bib17" title="">2024</a>)</cite>.
However, all three models lagged behind SASRec on the Yelp2018 dataset, suggesting a possible limitation of LLMs in contexts like local businesses, where open-world knowledge is limited and of more limited use than on the other datasets.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this work, we zoomed in on the tool-learning capacities of LLMs, using them as controllers to guide the exploration of item spaces in a recommendation scenario.
Specifically, by treating LLMs as surrogate users, they can adeptly capture the nuances of a current context alongside user preferences.
Subsequently, we employ attribute-oriented tools for precise item retrieval.
We developed two types of attribute-oriented tools: rank tools and retrieval tools, each fetching the corresponding candidate items.
To enhance accurate item retrieval, items that appear in the process are verified and stored using the memory strategy.
Extensive experiments on real-world datasets rich in knowledge demonstrate the effectiveness and rationality of ToolRec.
</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">The idea of using LLMs for simulation, either under the hood as in our approach or for counterfactual explorations while interacting with users, holds great potential for combining the strengths of LLMs and recommendation models.
In the short term, companies operating their own recommender systems may find it impractical to switch to LLM-based RSs.
However, ToolRec could enhance recommendation performance by integrating LLMs with their current systems.
In the long-term, users are increasingly relying on LLMs for various daily tasks, including recommendations.
ToolRec does not require extensive fine-tuning of the LLM, which can lead to additional costs and potential delays due to outdated information.
Furthermore, the results from ToolRec are more reliable than those from zero-shot or few-shot LLM recommendations, as they are augmented by traditional recommendation system outputs.</p>
</div>
<div class="ltx_para" id="S5.p3">
<p class="ltx_p" id="S5.p3.1">Achieving strong recommendation performance hinges on a dataset with rich semantic knowledge and the robust capabilities of the LLM.
In future work, we plan to incorporate recommendation knowledge into LLMs to enhance domain-specific tool learning, such as retrieval-augmented generation or fine-tuning LLMs, potentially reducing the reliance on rich semantic knowledge. Additionally, we intend to explore different types of tools, including search engines and databases, along with a self-reflection strategy, to achieve even more personalized recommendations.
</p>
</div>
<section class="ltx_subsubsection" id="S5.SS0.SSSx1">
<h4 class="ltx_title ltx_font_bold ltx_title_subsubsection">Acknowledgments.</h4>
<div class="ltx_para" id="S5.SS0.SSSx1.p1">
<p class="ltx_p" id="S5.SS0.SSSx1.p1.1">This research is supported by the National Science and Technology Major Project (2023ZD0121102), National Natural Science Foundation of China (92270114, 62302321),
the Dutch Research Council (NWO), under project numbers 024.004.022, NWA.1389.20.183, and KICH3.LTP.20.006,
and the European Union’s Horizon Europe program under grant agreement No 101070212.</p>
</div>
</section>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yuntao Bai, Andy Jones, Kamal Ndousse, Amanda Askell, Anna Chen, Nova DasSarma, Dawn Drain, Stanislav Fort, Deep Ganguli, Tom Henighan, Nicholas Joseph, Saurav Kadavath, Jackson Kernion, Tom Conerly, Sheer El Showk, Nelson Elhage, Zac Hatfield-Dodds, Danny Hernandez, Tristan Hume, Scott Johnston, Shauna Kravec, Liane Lovitt, Neel Nanda, Catherine Olsson, Dario Amodei, Tom B. Brown, Jack Clark, Sam McCandlish, Chris Olah, Benjamin Mann, and
Jared Kaplan. 2022.

</span>
<span class="ltx_bibblock">Training a Helpful and Harmless Assistant with Reinforcement Learning from Human Feedback.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bang et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yejin Bang, Samuel Cahyawijaya, Nayeon Lee, Wenliang Dai, Dan Su, Bryan Wilie, Holy Lovenia, Ziwei Ji, Tiezheng Yu, Willy Chung, Quyet V. Do, Yan Xu, and Pascale Fung. 2023.

</span>
<span class="ltx_bibblock">A Multitask, Multilingual, Multimodal Evaluation of ChatGPT on Reasoning, Hallucination, and Interactivity. In <em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">IJCNLP (1)</em>. 675–718.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bao et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Keqin Bao, Jizhi Zhang, Yang Zhang, Wenjie Wang, Fuli Feng, and Xiangnan He. 2023.

</span>
<span class="ltx_bibblock">TALLRec: An Effective and Efficient Tuning Framework to Align Large Language Model with Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">RecSys</em>. 1007–1014.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Xinshi Chen, Shuang Li, Hui Li, Shaohua Jiang, Yuan Qi, and Le Song. 2019.

</span>
<span class="ltx_bibblock">Generative Adversarial User Model for Reinforcement Learning Based Recommendation System. In <em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">ICML</em>. 1052–1061.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chiang et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Wei-Lin Chiang, Zhuohan Li, Zi Lin, Ying Sheng, Zhanghao Wu, Hao Zhang, Lianmin Zheng, Siyuan Zhuang, Yonghao Zhuang, Joseph E. Gonzalez, Ion Stoica, and Eric P. Xing. 2023.

</span>
<span class="ltx_bibblock">Vicuna: An Open-Source Chatbot Impressing GPT-4 with 90%* ChatGPT Quality.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://lmsys.org/blog/2023-03-30-vicuna/" title="">https://lmsys.org/blog/2023-03-30-vicuna/</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chowdhery et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Aakanksha Chowdhery, Sharan Narang, Jacob Devlin, Maarten Bosma, Gaurav Mishra, Adam Roberts, Paul Barham, Hyung Won Chung, Charles Sutton, Sebastian Gehrmann, Parker Schuh, Kensen Shi, Sasha Tsvyashchenko, Joshua Maynez, Abhishek Rao, Parker Barnes, Yi Tay, Noam Shazeer, Vinodkumar Prabhakaran, Emily Reif, Nan Du, Ben Hutchinson, Reiner Pope, James Bradbury, Jacob Austin, Michael Isard, Guy Gur-Ari, Pengcheng Yin, Toju Duke, Anselm Levskaya,
Sanjay Ghemawat, Sunipa Dev, Henryk Michalewski, Xavier Garcia, Vedant Misra, Kevin Robinson, Liam Fedus, Denny Zhou, Daphne Ippolito, David Luan, Hyeontaek Lim, Barret Zoph, Alexander Spiridonov, Ryan Sepassi, David Dohan, Shivani Agrawal, Mark Omernick, Andrew M. Dai, Thanumalayan Sankaranarayana Pillai, Marie Pellat, Aitor Lewkowycz, Erica Moreira, Rewon Child, Oleksandr Polozov, Katherine Lee, Zongwei Zhou, Xuezhi Wang, Brennan Saeta, Mark Diaz, Orhan Firat,
Michele Catasta, Jason Wei, Kathy Meier-Hellstern, Douglas Eck, Jeff Dean, Slav Petrov, and Noah Fiedel. 2023.

</span>
<span class="ltx_bibblock">PaLM: Scaling Language Modeling with Pathways.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">J. Mach. Learn. Res.</em> 24 (2023), 240:1–240:113.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. 2019.

</span>
<span class="ltx_bibblock">BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding. In <em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">NAACL-HLT (1)</em>. 4171–4186.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Friedman et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Luke Friedman, Sameer Ahuja, David Allen, Zhenning Tan, Hakim Sidahmed, Changbo Long, Jun Xie, Gabriel Schubiner, Ajay Patel, Harsh Lara, Brian Chu, Zexi Chen, and Manoj Tiwari. 2023.

</span>
<span class="ltx_bibblock">Leveraging Large Language Models in Conversational Recommender Systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">CoRR</em> abs/2305.07961 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Chongming Gao, Shiqi Wang, Shijun Li, Jiawei Chen, Xiangnan He, Wenqiang Lei, Biao Li, Yuan Zhang, and Peng Jiang. 2024.

</span>
<span class="ltx_bibblock">CIRS: Bursting Filter Bubbles by Counterfactual Interactive Recommender System.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">ACM Trans. Inf. Syst.</em> 42, 1 (2024), 14:1–14:27.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yunfan Gao, Tao Sheng, Youlin Xiang, Yun Xiong, Haofen Wang, and Jiawei Zhang. 2023.

</span>
<span class="ltx_bibblock">Chat-REC: Towards Interactive and Explainable LLMs-Augmented Recommender System.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">CoRR</em> abs/2303.14524 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ge et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yingqiang Ge, Wenyue Hua, Kai Mei, Jianchao Ji, Juntao Tan, Shuyuan Xu, Zelong Li, and Yongfeng Zhang. 2023.

</span>
<span class="ltx_bibblock">OpenAGI: When LLM Meets Domain Experts. In <em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">NeurIPS</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geng et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Shijie Geng, Shuchang Liu, Zuohui Fu, Yingqiang Ge, and Yongfeng Zhang. 2022.

</span>
<span class="ltx_bibblock">Recommendation as Language Processing (RLP): A Unified Pretrain, Personalized Prompt &amp; Predict Paradigm (P5). In <em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">RecSys</em>. 299–315.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geng et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Shijie Geng, Juntao Tan, Shuchang Liu, Zuohui Fu, and Yongfeng Zhang. 2023.

</span>
<span class="ltx_bibblock">VIP5: Towards Multimodal Foundation Models for Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">EMNLP (Findings)</em>. 9606–9620.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Qingyu Guo, Fuzhen Zhuang, Chuan Qin, Hengshu Zhu, Xing Xie, Hui Xiong, and Qing He. 2020.

</span>
<span class="ltx_bibblock">A survey on Knowledge Graph-based Recommender Systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">IEEE Trans. Knowl. Data Eng.</em> 34, 8 (2020), 3549–3568.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Xiangnan He, Kuan Deng, Xiang Wang, Yan Li, Yongdong Zhang, and Meng Wang. 2020.

</span>
<span class="ltx_bibblock">LightGCN: Simplifying and Powering Graph Convolution Network for Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">SIGIR</em>. 639–648.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hou et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Yupeng Hou, Junjie Zhang, Zihan Lin, Hongyu Lu, Ruobing Xie, Julian J. McAuley, and Wayne Xin Zhao. 2024.

</span>
<span class="ltx_bibblock">Large Language Models are Zero-Shot Rankers for Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">ECIR (2)</em>, Vol. 14609. 364–381.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Chenxu Hu, Jie Fu, Chenzhuang Du, Simian Luo, Junbo Zhao, and Hang Zhao. 2023.

</span>
<span class="ltx_bibblock">ChatDB: Augmenting LLMs with Databases as Their Symbolic Memory.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">CoRR</em> abs/2306.03901 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Edward J. Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, Lu Wang, and Weizhu Chen. 2022.

</span>
<span class="ltx_bibblock">LoRA: Low-Rank Adaptation of Large Language Models. In <em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">ICLR</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hua et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Wenyue Hua, Yingqiang Ge, Shuyuan Xu, Jianchao Ji, Zelong Li, and Yongfeng Zhang. 2024.

</span>
<span class="ltx_bibblock">UP5: Unbiased Foundation Model for Fairness-aware Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">EACL (1)</em>. 1899–1912.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hua et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Wenyue Hua, Shuyuan Xu, Yingqiang Ge, and Yongfeng Zhang. 2023.

</span>
<span class="ltx_bibblock">How to Index Item IDs for Recommendation Foundation Models. In <em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">SIGIR-AP</em>. 195–204.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Xu Huang, Jianxun Lian, Yuxuan Lei, Jing Yao, Defu Lian, and Xing Xie. 2023.

</span>
<span class="ltx_bibblock">Recommender AI Agent: Integrating Large Language Models for Interactive Recommendations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">CoRR</em> abs/2308.16505 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang and McAuley (2018)</span>
<span class="ltx_bibblock">
Wang-Cheng Kang and Julian J. McAuley. 2018.

</span>
<span class="ltx_bibblock">Self-Attentive Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">ICDM</em>. 197–206.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karpas et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Ehud Karpas, Omri Abend, Yonatan Belinkov, Barak Lenz, Opher Lieber, Nir Ratner, Yoav Shoham, Hofit Bata, Yoav Levine, Kevin Leyton-Brown, Dor Muhlgay, Noam Rozen, Erez Schwartz, Gal Shachaf, Shai Shalev-Shwartz, Amnon Shashua, and Moshe Tennenholtz. 2022.

</span>
<span class="ltx_bibblock">MRKL Systems: A modular, neuro-symbolic architecture that combines large language models, external knowledge sources and discrete reasoning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.3.1">CoRR</em> abs/2205.00445 (2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Minghao Li, Yingxiu Zhao, Bowen Yu, Feifan Song, Hangyu Li, Haiyang Yu, Zhoujun Li, Fei Huang, and Yongbin Li. 2023.

</span>
<span class="ltx_bibblock">API-Bank: A Comprehensive Benchmark for Tool-Augmented LLMs. In <em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">EMNLP</em>. 3102–3116.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liao et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Jiayi Liao, Sihang Li, Zhengyi Yang, Jiancan Wu, Yancheng Yuan, Xiang Wang, and Xiangnan He. 2024.

</span>
<span class="ltx_bibblock">Large Language-Recommendation Assistant. In <em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">SIGIR</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Jianghao Lin, Xinyi Dai, Yunjia Xi, Weiwen Liu, Bo Chen, Xiangyang Li, Chenxu Zhu, Huifeng Guo, Yong Yu, Ruiming Tang, and Weinan Zhang. 2023.

</span>
<span class="ltx_bibblock">How Can Recommender Systems Benefit from Large Language Models: A Survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.3.1">CoRR</em> abs/2306.05817 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mysore et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Sheshera Mysore, Andrew McCallum, and Hamed Zamani. 2023.

</span>
<span class="ltx_bibblock">Large Language Model Augmented Narrative Driven Recommendations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">RecSys</em> (2023), 777–783.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ouyang et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Long Ouyang, Jeffrey Wu, Xu Jiang, Diogo Almeida, Carroll L. Wainwright, Pamela Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, John Schulman, Jacob Hilton, Fraser Kelton, Luke Miller, Maddie Simens, Amanda Askell, Peter Welinder, Paul F. Christiano, Jan Leike, and Ryan Lowe. 2022.

</span>
<span class="ltx_bibblock">Training language models to follow instructions with human feedback. In <em class="ltx_emph ltx_font_italic" id="bib.bib29.3.1">NeurIPS</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pennington et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Jeffrey Pennington, Richard Socher, and Christopher D. Manning. 2014.

</span>
<span class="ltx_bibblock">Glove: Global Vectors for Word Representation. In <em class="ltx_emph ltx_font_italic" id="bib.bib30.3.1">EMNLP</em>. ACL, 1532–1543.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qin et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Yujia Qin, Shengding Hu, Yankai Lin, Weize Chen, Ning Ding, Ganqu Cui, Zheni Zeng, Yufei Huang, Chaojun Xiao, Chi Han, Yi Ren Fung, Yusheng Su, Huadong Wang, Cheng Qian, Runchu Tian, Kunlun Zhu, Shihao Liang, Xingyu Shen, Bokai Xu, Zhen Zhang, Yining Ye, Bowen Li, Ziwei Tang, Jing Yi, Yuzhang Zhu, Zhenning Dai, Lan Yan, Xin Cong, Yaxi Lu, Weilin Zhao, Yuxiang Huang, Junxi Yan, Xu Han, Xian
Sun, Dahai Li, Jason Phang, Cheng Yang, Tongshuang Wu, Heng Ji, Zhiyuan Liu, and Maosong Sun. 2023a.

</span>
<span class="ltx_bibblock">Tool Learning with Foundation Models.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qin et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Yujia Qin, Shihao Liang, Yining Ye, Kunlun Zhu, Lan Yan, Yaxi Lu, Yankai Lin, Xin Cong, Xiangru Tang, Bill Qian, Sihan Zhao, Runchu Tian, Ruobing Xie, Jie Zhou, Mark Gerstein, Dahai Li, Zhiyuan Liu, and Maosong Sun. 2023b.

</span>
<span class="ltx_bibblock">ToolLLM: Facilitating Large Language Models to Master 16000+ Real-world APIs.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">CoRR</em> abs/2307.16789 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qiu et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Zhaopeng Qiu, Xian Wu, Jingyue Gao, and Wei Fan. 2021.

</span>
<span class="ltx_bibblock">U-BERT: Pre-training User Representations for Improved Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib33.3.1">AAAI</em>, Vol. 35. 4320–4327.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raffel et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael Matena, Yanqi Zhou, Wei Li, and Peter J. Liu. 2020.

</span>
<span class="ltx_bibblock">Exploring the Limits of Transfer Learning with a Unified Text-to-Text Transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">J. Mach. Learn. Res.</em> 21 (2020), 140:1–140:67.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rendle et al<span class="ltx_text" id="bib.bib35.2.2.1">.</span> (2009)</span>
<span class="ltx_bibblock">
Steffen Rendle, Christoph Freudenthaler, Zeno Gantner, and Lars Schmidt-Thieme. 2009.

</span>
<span class="ltx_bibblock">BPR: Bayesian Personalized Ranking from Implicit Feedback. In <em class="ltx_emph ltx_font_italic" id="bib.bib35.3.1">UAI</em>. 452–461.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schick et al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Timo Schick, Jane Dwivedi-Yu, Roberto Dessì, Roberta Raileanu, Maria Lomeli, Eric Hambro, Luke Zettlemoyer, Nicola Cancedda, and Thomas Scialom. 2023.

</span>
<span class="ltx_bibblock">Toolformer: Language Models Can Teach Themselves to Use Tools. In <em class="ltx_emph ltx_font_italic" id="bib.bib36.3.1">NeurIPS</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen et al<span class="ltx_text" id="bib.bib37.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yongliang Shen, Kaitao Song, Xu Tan, Dongsheng Li, Weiming Lu, and Yueting Zhuang. 2023.

</span>
<span class="ltx_bibblock">HuggingGPT: Solving AI Tasks with ChatGPT and its Friends in Hugging Face. In <em class="ltx_emph ltx_font_italic" id="bib.bib37.3.1">NeurIPS</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib38.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Fei Sun, Jun Liu, Jian Wu, Changhua Pei, Xiao Lin, Wenwu Ou, and Peng Jiang. 2019.

</span>
<span class="ltx_bibblock">BERT4Rec: Sequential Recommendation with Bidirectional Encoder Representations from Transformer. In <em class="ltx_emph ltx_font_italic" id="bib.bib38.3.1">CIKM</em>. ACM, 1441–1450.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Surís et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Dídac Surís, Sachit Menon, and Carl Vondrick. 2023.

</span>
<span class="ltx_bibblock">ViperGPT: Visual Inference via Python Execution for Reasoning. In <em class="ltx_emph ltx_font_italic" id="bib.bib39.3.1">ICCV</em>. 11854–11864.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al<span class="ltx_text" id="bib.bib40.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro, Faisal Azhar, Aurélien Rodriguez, Armand Joulin, Edouard Grave, and Guillaume Lample. 2023a.

</span>
<span class="ltx_bibblock">LLaMA: Open and Efficient Foundation Language Models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.3.1">CoRR</em> abs/2302.13971 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al<span class="ltx_text" id="bib.bib41.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, Dan Bikel, Lukas Blecher, Cristian Canton-Ferrer, Moya Chen, Guillem Cucurull, David Esiobu, Jude Fernandes, Jeremy Fu, Wenyin Fu, Brian Fuller, Cynthia Gao, Vedanuj Goswami, Naman Goyal, Anthony Hartshorn, Saghar Hosseini, Rui Hou, Hakan Inan, Marcin Kardas, Viktor Kerkez, Madian Khabsa,
Isabel Kloumann, Artem Korenev, Punit Singh Koura, Marie-Anne Lachaux, Thibaut Lavril, Jenya Lee, Diana Liskovich, Yinghai Lu, Yuning Mao, Xavier Martinet, Todor Mihaylov, Pushkar Mishra, Igor Molybog, Yixin Nie, Andrew Poulton, Jeremy Reizenstein, Rashi Rungta, Kalyan Saladi, Alan Schelten, Ruan Silva, Eric Michael Smith, Ranjan Subramanian, Xiaoqing Ellen Tan, Binh Tang, Ross Taylor, Adina Williams, Jian Xiang Kuan, Puxin Xu, Zheng Yan, Iliyan Zarov, Yuchen
Zhang, Angela Fan, Melanie Kambadur, Sharan Narang, Aurélien Rodriguez, Robert Stojnic, Sergey Edunov, and Thomas Scialom. 2023b.

</span>
<span class="ltx_bibblock">Llama 2: Open Foundation and Fine-Tuned Chat Models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.3.1">CoRR</em> abs/2307.09288 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang and Lim (2023)</span>
<span class="ltx_bibblock">
Lei Wang and Ee-Peng Lim. 2023.

</span>
<span class="ltx_bibblock">Zero-Shot Next-Item Recommendation using Large Pretrained Language Models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">CoRR</em> abs/2304.03153 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib43.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Lei Wang, Chen Ma, Xueyang Feng, Zeyu Zhang, Hao Yang, Jingsen Zhang, Zhiyuan Chen, Jiakai Tang, Xu Chen, Yankai Lin, Wayne Xin Zhao, Zhewei Wei, and Jirong Wen. 2024.

</span>
<span class="ltx_bibblock">A survey on large language model based autonomous agents.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.3.1">Frontiers Comput. Sci.</em> 18, 6 (2024), 186345.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib44.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Xiang Wang, Xiangnan He, Yixin Cao, Meng Liu, and Tat-Seng Chua. 2019.

</span>
<span class="ltx_bibblock">KGAT: Knowledge Graph Attention Network for Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib44.3.1">SIGKDD</em>. 950–958.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib45.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yancheng Wang, Ziyan Jiang, Zheng Chen, Fan Yang, Yingxue Zhou, Eunah Cho, Xing Fan, Xiaojiang Huang, Yanbin Lu, and Yingzhen Yang. 2023.

</span>
<span class="ltx_bibblock">RecMind: Large Language Model Powered Agent For Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.3.1">CoRR</em> abs/2308.14296 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al<span class="ltx_text" id="bib.bib46.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Jason Wei, Xuezhi Wang, Dale Schuurmans, Maarten Bosma, Brian Ichter, Fei Xia, Ed H. Chi, Quoc V. Le, and Denny Zhou. 2022.

</span>
<span class="ltx_bibblock">Chain-of-Thought Prompting Elicits Reasoning in Large Language Models. In <em class="ltx_emph ltx_font_italic" id="bib.bib46.3.1">NeurIPS</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib47.2.2.1">.</span> (2021b)</span>
<span class="ltx_bibblock">
Chuhan Wu, Fangzhao Wu, Tao Qi, and Yongfeng Huang. 2021b.

</span>
<span class="ltx_bibblock">Empowering News Recommendation with Pre-trained Language Models. In <em class="ltx_emph ltx_font_italic" id="bib.bib47.3.1">SIGIR</em>. 1652–1656.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib48.2.2.1">.</span> (2021a)</span>
<span class="ltx_bibblock">
Jiancan Wu, Xiang Wang, Fuli Feng, Xiangnan He, Liang Chen, Jianxun Lian, and Xing Xie. 2021a.

</span>
<span class="ltx_bibblock">Self-supervised Graph Learning for Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib48.3.1">SIGIR</em>. 726–735.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib49.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Jiancan Wu, Xiang Wang, Xingyu Gao, Jiawei Chen, Hongcheng Fu, Tianyu Qiu, and Xiangnan He. 2024.

</span>
<span class="ltx_bibblock">On the Effectiveness of Sampled Softmax Loss for Item Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib49.3.1">ACM Trans. Inf. Syst.</em> 42, 4 (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib50.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Likang Wu, Zhi Zheng, Zhaopeng Qiu, Hao Wang, Hongchao Gu, Tingjia Shen, Chuan Qin, Chen Zhu, Hengshu Zhu, Qi Liu, Hui Xiong, and Enhong Chen. 2023.

</span>
<span class="ltx_bibblock">A Survey on Large Language Models for Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib50.3.1">CoRR</em> abs/2305.19860 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xi et al<span class="ltx_text" id="bib.bib51.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yunjia Xi, Weiwen Liu, Jianghao Lin, Jieming Zhu, Bo Chen, Ruiming Tang, Weinan Zhang, Rui Zhang, and Yong Yu. 2023.

</span>
<span class="ltx_bibblock">Towards Open-World Recommendation with Knowledge Augmentation from Large Language Models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib51.3.1">CoRR</em> abs/2306.10933 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al<span class="ltx_text" id="bib.bib52.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Shuyuan Xu, Wenyue Hua, and Yongfeng Zhang. 2023.

</span>
<span class="ltx_bibblock">OpenP5: Benchmarking Foundation Models for Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib52.3.1">CoRR</em> abs/2306.11134 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib53.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Zhengyuan Yang, Linjie Li, Jianfeng Wang, Kevin Lin, Ehsan Azarnasab, Faisal Ahmed, Zicheng Liu, Ce Liu, Michael Zeng, and Lijuan Wang. 2023a.

</span>
<span class="ltx_bibblock">MM-REACT: Prompting ChatGPT for Multimodal Reasoning and Action.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib53.3.1">CoRR</em> abs/2303.11381 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib54.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Zhengyi Yang, Jiancan Wu, Yanchen Luo, Jizhi Zhang, Yancheng Yuan, An Zhang, Xiang Wang, and Xiangnan He. 2023b.

</span>
<span class="ltx_bibblock">Large Language Model Can Interpret Latent Space of Sequential Recommender.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib54.3.1">CoRR</em> abs/2310.20487 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib55.2.2.1">.</span> (2023c)</span>
<span class="ltx_bibblock">
Zhengyi Yang, Jiancan Wu, Zhicai Wang, Xiang Wang, Yancheng Yuan, and Xiangnan He. 2023c.

</span>
<span class="ltx_bibblock">Generate What You Prefer: Reshaping Sequential Recommendation via Guided Diffusion. In <em class="ltx_emph ltx_font_italic" id="bib.bib55.3.1">NeurIPS</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et al<span class="ltx_text" id="bib.bib56.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Shunyu Yao, Jeffrey Zhao, Dian Yu, Nan Du, Izhak Shafran, Karthik R. Narasimhan, and Yuan Cao. 2023.

</span>
<span class="ltx_bibblock">ReAct: Synergizing Reasoning and Acting in Language Models. In <em class="ltx_emph ltx_font_italic" id="bib.bib56.3.1">ICLR</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib57.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
An Zhang, Yuxin Chen, Leheng Sheng, Xiang Wang, and Tat-Seng Chua. 2024.

</span>
<span class="ltx_bibblock">On Generative Agents in Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib57.3.1">SIGIR</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib58.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Junjie Zhang, Yupeng Hou, Ruobing Xie, Wenqi Sun, Julian J. McAuley, Wayne Xin Zhao, Leyu Lin, and Ji-Rong Wen. 2023a.

</span>
<span class="ltx_bibblock">AgentCF: Collaborative Learning with Autonomous Language Agents for Recommender Systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib58.3.1">CoRR</em> abs/2310.09233 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib59.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Junjie Zhang, Ruobing Xie, Yupeng Hou, Wayne Xin Zhao, Leyu Lin, and Ji-Rong Wen. 2023b.

</span>
<span class="ltx_bibblock">Recommendation as Instruction Following: A Large Language Model Empowered Recommendation Approach.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib59.3.1">CoRR</em> abs/2305.07001 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib60.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Qi Zhang, Jingjie Li, Qinglin Jia, Chuyuan Wang, Jieming Zhu, Zhaowei Wang, and Xiuqiang He. 2021.

</span>
<span class="ltx_bibblock">UNBERT: User-News Matching BERT for News Recommendation.. In <em class="ltx_emph ltx_font_italic" id="bib.bib60.3.1">IJCAI</em>. 3356–3362.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhong et al<span class="ltx_text" id="bib.bib61.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Wanjun Zhong, Lianghong Guo, Qiqi Gao, He Ye, and Yanlin Wang. 2024.

</span>
<span class="ltx_bibblock">MemoryBank: Enhancing Large Language Models with Long-Term Memory. In <em class="ltx_emph ltx_font_italic" id="bib.bib61.3.1">AAAI</em>. 19724–19731.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al<span class="ltx_text" id="bib.bib62.3.3.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Xizhou Zhu, Yuntao Chen, Hao Tian, Chenxin Tao, Weijie Su, Chenyu Yang, Gao Huang, Bin Li, Lewei Lu, Xiaogang Wang, et al<span class="ltx_text" id="bib.bib62.4.1">.</span> 2023a.

</span>
<span class="ltx_bibblock">Ghost in the Minecraft: Generally Capable Agents for Open-World Enviroments via Large Language Models with Text-based Knowledge and Memory.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib62.5.1">CoRR</em> abs/2305.17144 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al<span class="ltx_text" id="bib.bib63.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Yutao Zhu, Huaying Yuan, Shuting Wang, Jiongnan Liu, Wenhan Liu, Chenlong Deng, Zhicheng Dou, and Ji-Rong Wen. 2023b.

</span>
<span class="ltx_bibblock">Large Language Models for Information Retrieval: A Survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib63.3.1">CoRR</em> abs/2308.07107 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zou et al<span class="ltx_text" id="bib.bib64.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Lixin Zou, Shengqiang Zhang, Hengyi Cai, Dehong Ma, Suqi Cheng, Shuaiqiang Wang, Daiting Shi, Zhicong Cheng, and Dawei Yin. 2021.

</span>
<span class="ltx_bibblock">Pre-trained Language Model based Ranking in Baidu Search. In <em class="ltx_emph ltx_font_italic" id="bib.bib64.3.1">KDD</em>. ACM, 4014–4022.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri May 24 13:42:28 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
