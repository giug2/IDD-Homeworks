<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2211.07864] Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning</title><meta property="og:description" content="Federated learning (FL) enables multiple clients to collaboratively train a global model without disclosing their data. Previous researches often require training the complete model parameters. However, the emergence o…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2211.07864">

<!--Generated on Thu Mar 14 09:02:57 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Shangchao Su,
Mingzhao Yang,
Bin Li,
Xiangyang Xue<span id="footnotex1" class="ltx_note ltx_role_footnotemark"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">1</span></span></span></span>
</span><span class="ltx_author_notes">Corresponding author</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Federated learning (FL) enables multiple clients to collaboratively train a global model without disclosing their data. Previous researches often require training the complete model parameters. However, the emergence of powerful pre-trained models makes it possible to achieve higher performance with fewer learnable parameters in FL. In this paper, we propose a federated adaptive prompt tuning algorithm, FedAPT, for multi-domain collaborative image classification with powerful foundation models, like CLIP. Compared with direct federated prompt tuning, our core idea is to adaptively unlock specific domain knowledge for each test sample in order to provide them with personalized prompts. To implement this idea, we design an adaptive prompt tuning module, which consists of a meta prompt, an adaptive network, and some keys. The server randomly generates a set of keys and assigns a unique key to each client. Then all clients cooperatively train the global adaptive network and meta prompt with the local datasets and the frozen keys. Ultimately, the global aggregation model can assign a personalized prompt to CLIP based on the domain features of each test sample. We perform extensive experiments on two multi-domain image classification datasets across two different settings — supervised and unsupervised. The results show that FedAPT can achieve better performance with less than 10% of the number of parameters of the fully trained model, and the global model can perform well in diverse client domains simultaneously.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">As privacy protection gains increasing attention, federated learning (FL) <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al. <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite>, a special machine learning paradigm, becomes more popular. FL has been applied to mobile phone album classification, automatic driving, and medical image analysis. FL enables multiple parties to cooperatively train a global model without sharing their training data. In each round of communication, the server sends the global model to the clients, and each client updates the global model with the private dataset to obtain the local model. The server collects the local models for aggregation, and obtains the global model for the next communication round. In computer vision, FL has been applied to classification <cite class="ltx_cite ltx_citemacro_citep">(Hsu, Qi, and Brown <a href="#bib.bib12" title="" class="ltx_ref">2020</a>; Li, He, and Song <a href="#bib.bib16" title="" class="ltx_ref">2021</a>; Yang et al. <a href="#bib.bib41" title="" class="ltx_ref">2023</a>)</cite>, detection <cite class="ltx_cite ltx_citemacro_citep">(Liu et al. <a href="#bib.bib22" title="" class="ltx_ref">2020</a>; Su et al. <a href="#bib.bib35" title="" class="ltx_ref">2023</a>)</cite>, ReID <cite class="ltx_cite ltx_citemacro_citep">(Zhuang, Wen, and Zhang <a href="#bib.bib49" title="" class="ltx_ref">2021</a>; Zhuang et al. <a href="#bib.bib50" title="" class="ltx_ref">2020</a>)</cite>, etc.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2211.07864/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="212" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The impact of different prompts on performance in multi-domain scenarios. The first three prompts are manually set. One can see that when domain information is included in the prompt (in red), the accuracy of the corresponding domain is improved (red arrow), but that of other domains is decreased (green arrow). The bottom three rows are the learned prompts. On one hand, the prompts learned only in one domain perform significantly worse in other domains. On the other hand, we can obtain prompts through FedAPT that are applicable across all domains.</figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Currently used FL techniques <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al. <a href="#bib.bib25" title="" class="ltx_ref">2017</a>; Li et al. <a href="#bib.bib17" title="" class="ltx_ref">2020</a>; Karimireddy et al. <a href="#bib.bib14" title="" class="ltx_ref">2020</a>)</cite> require all model parameters to be updated from the clients and shared on the server. As a result, collaborative learning incurs substantial client training costs, as well as communication costs for both clients and the server. The non-IID problem of various client data also poses significant difficulties for the federated learning algorithm. The performance of the global aggregation model will be impacted when the client datasets come from diverse data domains. Thus, training a more effective global model with fewer communication costs by adjusting only a few parameters remains an open research question.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">The emergence of powerful vision-language pre-trained models, such as CLIP <cite class="ltx_cite ltx_citemacro_citep">(Radford et al. <a href="#bib.bib30" title="" class="ltx_ref">2021</a>)</cite>, opens up new avenues for solving this problem. CLIP formalizes object recognition into image-text matching, rather than an image-label mapping problem. Text encoder and image encoder are two of the Transformer <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al. <a href="#bib.bib37" title="" class="ltx_ref">2017</a>)</cite> branches that are included in CLIP. About 400 million web-crawled image-text pairs are used for contrastive learning to establish semantic associations between images and texts. Pre-trained CLIP performs admirably in the zero-shot image classification task and demonstrates high transferability in a number of downstream applications. With the powerful representation ability of CLIP, it becomes possible to fine-tune only a few parameters for each client in the federated learning scenarios.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Inspired by the promising capabilities of CLIP, in this research, we propose a federated prompt tuning algorithm, FedAPT, for multi-domain collaborative image classification in cross-silo federated learning. Consider that there are multiple participants in diverse data domains; the ultimate objective is to develop a global classification model through federated prompt tuning that can perform well in all data domains; see Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. We employ a prompt tuning based strategy to provide learnable prompts for the CLIP. To make the global prompt adapt to all domains, we propose an adaptive method to set customized prompts for various test images in order to address the cross-domain challenge.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">The underlying intuition is that images contain domain-specific information. By incorporating this domain-specific information into prompts, we can better guide the pre-trained CLIP model to activate relevant knowledge to that domain, then the classification ability of the corresponding domain can be improved (see the first three rows in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). The adaptive prompt tuning module includes a meta prompt, an adaptive network, and some frozen keys. Before federated learning, the server randomly assigns each client a frozen key. In local training, each client trains the adaptive network and the prompt using local data and the frozen key. Considering that the client may not have labels in the real scene, we also design an unsupervised training method for FedAPT. After local training, all updated parameters and prompts are sent to the server for aggregation. During inference, we leverage an adaptive network to select a specific key for each test image, so as to generate a specific prompt from the meta prompt.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">We conduct extensive experiments on two multi-domain image classification datasets, Office-Caltech10 and DomainNet, across two different settings: supervised and unsupervised. The results show that FedAPT can build a more powerful global model than fully-trained ResNet50 or ViT with less than 10% of the number of parameters, and demonstrates its ability to perform well in a variety of scenarios. All experiments show that our scheme has significantly improved performance compared with the competitors.
In general, our contributions are as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We utilize CLIP for the first time in federated cross-domain image classification, across two distinct scenarios — supervised and unsupervised. Our results demonstrate the significant potential of CLIP in federated learning.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We propose a federated adaptive prompt tuning framework, FedAPT. With the leverage of keys, FedAPT can provide a personalized prompt for each test image without adding any learnable parameters.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Our experiments conducted across different settings on both Office-Caltech10 and DomainNet demonstrate that FedAPT outperforms both the fully-trained models and the existing federated prompt tuning methods.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Federated Learning</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">The idea of aggregating client data distribution information to the cloud can be traced back to SCM <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib15" title="" class="ltx_ref">2007</a>)</cite>. Recently, FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al. <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite> extends the aggregation idea to neural networks and proposes the federated averaging algorithm. Despite FedAvg’s strong performance under the assumption of IID, as the non-IID degree increases (due to the diverse distributions of client datasets), the aggregation model’s performance continues to deteriorate, making the non-IID problem a key area of research. Some efforts attempt to enhance the performance of the global aggregation model by improving the optimization algorithm <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib17" title="" class="ltx_ref">2020</a>; Karimireddy et al. <a href="#bib.bib14" title="" class="ltx_ref">2020</a>; Reddi et al. <a href="#bib.bib31" title="" class="ltx_ref">2020</a>; Wang et al. <a href="#bib.bib39" title="" class="ltx_ref">2020b</a>; Su, Li, and Xue <a href="#bib.bib34" title="" class="ltx_ref">2023</a>)</cite> or designing better aggregation methods <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a href="#bib.bib38" title="" class="ltx_ref">2020a</a>; Singh and Jaggi <a href="#bib.bib33" title="" class="ltx_ref">2020</a>)</cite>, while others <cite class="ltx_cite ltx_citemacro_citep">(Dinh, Tran, and Nguyen <a href="#bib.bib3" title="" class="ltx_ref">2020</a>; Fallah, Mokhtari, and Ozdaglar <a href="#bib.bib5" title="" class="ltx_ref">2020</a>; Hanzely et al. <a href="#bib.bib10" title="" class="ltx_ref">2020</a>; Li et al. <a href="#bib.bib18" title="" class="ltx_ref">2021</a>; Luo et al. <a href="#bib.bib24" title="" class="ltx_ref">2022</a>)</cite> turn to assigning different models to each client, i.e., personalized FL, such as using local batch normalization <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib18" title="" class="ltx_ref">2021</a>)</cite>, decoupling the model into personalized and global parts <cite class="ltx_cite ltx_citemacro_citep">(Luo et al. <a href="#bib.bib24" title="" class="ltx_ref">2022</a>)</cite>. The proposed FedAPT belongs to the former, i.e., to enhance the global model.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">Some works <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib1" title="" class="ltx_ref">2022</a>; Nguyen et al. <a href="#bib.bib26" title="" class="ltx_ref">2023</a>)</cite> study the impact of pre-training on FL. Unlike the fine-tuning methods, they need to train the complete model. FedPCL <cite class="ltx_cite ltx_citemacro_citep">(Tan et al. <a href="#bib.bib36" title="" class="ltx_ref">2022</a>)</cite> studies a setting where each client has <math id="S2.SS1.p2.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS1.p2.1.m1.1a"><mi id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><ci id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">K</annotation></semantics></math> fixed backbones, they fine-tune the projection head by sharing the prototype features of user data. Unlike FedPCL, we do not need to maintain multiple backbones locally, and we do not upload any prototype features. All in all, different from the existing works, we pay more attention to how to effectively utilize the knowledge in the powerful pre-trained models.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.1" class="ltx_p">Recently, FedIns <cite class="ltx_cite ltx_citemacro_citep">(Feng et al. <a href="#bib.bib6" title="" class="ltx_ref">2023</a>)</cite> shares a similar spirit with our work, both enabling Instance-adaptive Inference. The difference lies in the implementation: FedIns achieves adaptive inference for ViT through learnable Keys and SSF pool, while our approach achieves adaptive inference for CLIP through randomly initialized keys and a learnable query network coupled with prompts.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>CLIP and Prompt Tuning</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">The contrastive vision-language pre-trained model CLIP <cite class="ltx_cite ltx_citemacro_citep">(Radford et al. <a href="#bib.bib30" title="" class="ltx_ref">2021</a>)</cite> transforms image recognition into an image-text matching problem, freeing the object recognition task from human-annotated data, such that a huge amount (400M) of noisy image-text pairs can be used for training. The pre-trained model can be transferred to multiple datasets. Google releases ALIGN <cite class="ltx_cite ltx_citemacro_citep">(Jia et al. <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite> to expand CLIP’s training data to 1.8B, which achieves better results. Thanks to its powerful representation capability, CLIP has also been successfully applied to a variety of downstream visual tasks, such as RegionCLIP <cite class="ltx_cite ltx_citemacro_citep">(Zhong et al. <a href="#bib.bib46" title="" class="ltx_ref">2022</a>)</cite> and DetCLIP <cite class="ltx_cite ltx_citemacro_citep">(Yao et al. <a href="#bib.bib43" title="" class="ltx_ref">2022</a>)</cite> for object detection, MedCLIP <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a href="#bib.bib40" title="" class="ltx_ref">2022</a>)</cite> for medical image analysis, CCR-CLIP <cite class="ltx_cite ltx_citemacro_citep">(Yu et al. <a href="#bib.bib45" title="" class="ltx_ref">2023</a>)</cite> for text recognition.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">Prompt <cite class="ltx_cite ltx_citemacro_citep">(Liu et al. <a href="#bib.bib20" title="" class="ltx_ref">2021a</a>)</cite> adds additional words or sentences to the input text of the pre-trained language model, to make the pre-trained model better handle downstream tasks. The succeeding works <cite class="ltx_cite ltx_citemacro_citep">(Li and Liang <a href="#bib.bib19" title="" class="ltx_ref">2021</a>; Liu et al. <a href="#bib.bib21" title="" class="ltx_ref">2021b</a>)</cite> treat the prompts as continuous vectors in order to learn new knowledge in the process of fine-tuning, which is called Prompt Tuning. In CLIP’s follow-up work, other researchers <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al. <a href="#bib.bib48" title="" class="ltx_ref">2022b</a>, <a href="#bib.bib47" title="" class="ltx_ref">a</a>)</cite> tried to improve prompt tuning in CLIP. The work most relevant to ours is CoCoOp <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al. <a href="#bib.bib47" title="" class="ltx_ref">2022a</a>)</cite>, which trains prompts conditioned on visual features. However, it is designed for centralized training and heavily relies on high GPU computational power, making it hard to apply to clients in federated learning. In contrast, in this paper, the training of conditions and prompts are decoupled, significantly accelerating the training process.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>CLIP in Federated Learning</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">In the field of federated image classification, work related to CLIP is rare. PromptFL <cite class="ltx_cite ltx_citemacro_citep">(Guo et al. <a href="#bib.bib9" title="" class="ltx_ref">2022</a>)</cite> extends CoOp <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al. <a href="#bib.bib48" title="" class="ltx_ref">2022b</a>)</cite> to the federated learning scenarios, averaging multiple prompts on the server. PromptFL shows the potential application of prompt tuning for CLIP in FL, however, it lacks optimizations tailored for multi-domain scenarios. In comparison, FedAPT proposes an adaptive prompt tuning method for multi-domain image classification. FedCLIP <cite class="ltx_cite ltx_citemacro_citep">(Lu et al. <a href="#bib.bib23" title="" class="ltx_ref">2023</a>)</cite> adds an adapter consisting of two fully connected layers to the end of the image encoder. FedTPG <cite class="ltx_cite ltx_citemacro_citep">(Qiu et al. <a href="#bib.bib29" title="" class="ltx_ref">2023</a>)</cite> proposes a prompt generator with better generalization performance on unknown categories.
However, they do not generate personalized prompts for the images based on the domain information.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Preliminaries</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Notations</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.8" class="ltx_p">Consider a federated learning scenario, such as autonomous driving, where multiple cars are deployed in <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">K</annotation></semantics></math> regions (domains). Data from the same region exhibits similar styles, while data from different regions possesses distinct styles. Each region has <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="N_{dom}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">N</mi><mrow id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml"><mi id="S3.SS1.p1.2.m2.1.1.3.2" xref="S3.SS1.p1.2.m2.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.2.m2.1.1.3.1" xref="S3.SS1.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.2.m2.1.1.3.3" xref="S3.SS1.p1.2.m2.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.2.m2.1.1.3.1a" xref="S3.SS1.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.2.m2.1.1.3.4" xref="S3.SS1.p1.2.m2.1.1.3.4.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝑁</ci><apply id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3"><times id="S3.SS1.p1.2.m2.1.1.3.1.cmml" xref="S3.SS1.p1.2.m2.1.1.3.1"></times><ci id="S3.SS1.p1.2.m2.1.1.3.2.cmml" xref="S3.SS1.p1.2.m2.1.1.3.2">𝑑</ci><ci id="S3.SS1.p1.2.m2.1.1.3.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3.3">𝑜</ci><ci id="S3.SS1.p1.2.m2.1.1.3.4.cmml" xref="S3.SS1.p1.2.m2.1.1.3.4">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">N_{dom}</annotation></semantics></math> clients. We assume that each client has sufficient computing power to train the prompts. In supervised setting, <math id="S3.SS1.p1.3.m3.5" class="ltx_Math" alttext="\mathcal{D}_{n}=\{\mathbf{x}_{i},y_{i}\}_{i=1}^{m_{n}},n=1,\cdots,N" display="inline"><semantics id="S3.SS1.p1.3.m3.5a"><mrow id="S3.SS1.p1.3.m3.5.5.2" xref="S3.SS1.p1.3.m3.5.5.3.cmml"><mrow id="S3.SS1.p1.3.m3.4.4.1.1" xref="S3.SS1.p1.3.m3.4.4.1.1.cmml"><msub id="S3.SS1.p1.3.m3.4.4.1.1.4" xref="S3.SS1.p1.3.m3.4.4.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.4.4.1.1.4.2" xref="S3.SS1.p1.3.m3.4.4.1.1.4.2.cmml">𝒟</mi><mi id="S3.SS1.p1.3.m3.4.4.1.1.4.3" xref="S3.SS1.p1.3.m3.4.4.1.1.4.3.cmml">n</mi></msub><mo id="S3.SS1.p1.3.m3.4.4.1.1.3" xref="S3.SS1.p1.3.m3.4.4.1.1.3.cmml">=</mo><msubsup id="S3.SS1.p1.3.m3.4.4.1.1.2" xref="S3.SS1.p1.3.m3.4.4.1.1.2.cmml"><mrow id="S3.SS1.p1.3.m3.4.4.1.1.2.2.2.2" xref="S3.SS1.p1.3.m3.4.4.1.1.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p1.3.m3.4.4.1.1.2.2.2.2.3" xref="S3.SS1.p1.3.m3.4.4.1.1.2.2.2.3.cmml">{</mo><msub id="S3.SS1.p1.3.m3.4.4.1.1.1.1.1.1.1" xref="S3.SS1.p1.3.m3.4.4.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.3.m3.4.4.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.3.m3.4.4.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.SS1.p1.3.m3.4.4.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.3.m3.4.4.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p1.3.m3.4.4.1.1.2.2.2.2.4" xref="S3.SS1.p1.3.m3.4.4.1.1.2.2.2.3.cmml">,</mo><msub id="S3.SS1.p1.3.m3.4.4.1.1.2.2.2.2.2" xref="S3.SS1.p1.3.m3.4.4.1.1.2.2.2.2.2.cmml"><mi id="S3.SS1.p1.3.m3.4.4.1.1.2.2.2.2.2.2" xref="S3.SS1.p1.3.m3.4.4.1.1.2.2.2.2.2.2.cmml">y</mi><mi id="S3.SS1.p1.3.m3.4.4.1.1.2.2.2.2.2.3" xref="S3.SS1.p1.3.m3.4.4.1.1.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p1.3.m3.4.4.1.1.2.2.2.2.5" xref="S3.SS1.p1.3.m3.4.4.1.1.2.2.2.3.cmml">}</mo></mrow><mrow id="S3.SS1.p1.3.m3.4.4.1.1.2.2.4" xref="S3.SS1.p1.3.m3.4.4.1.1.2.2.4.cmml"><mi id="S3.SS1.p1.3.m3.4.4.1.1.2.2.4.2" xref="S3.SS1.p1.3.m3.4.4.1.1.2.2.4.2.cmml">i</mi><mo id="S3.SS1.p1.3.m3.4.4.1.1.2.2.4.1" xref="S3.SS1.p1.3.m3.4.4.1.1.2.2.4.1.cmml">=</mo><mn id="S3.SS1.p1.3.m3.4.4.1.1.2.2.4.3" xref="S3.SS1.p1.3.m3.4.4.1.1.2.2.4.3.cmml">1</mn></mrow><msub id="S3.SS1.p1.3.m3.4.4.1.1.2.4" xref="S3.SS1.p1.3.m3.4.4.1.1.2.4.cmml"><mi id="S3.SS1.p1.3.m3.4.4.1.1.2.4.2" xref="S3.SS1.p1.3.m3.4.4.1.1.2.4.2.cmml">m</mi><mi id="S3.SS1.p1.3.m3.4.4.1.1.2.4.3" xref="S3.SS1.p1.3.m3.4.4.1.1.2.4.3.cmml">n</mi></msub></msubsup></mrow><mo id="S3.SS1.p1.3.m3.5.5.2.3" xref="S3.SS1.p1.3.m3.5.5.3a.cmml">,</mo><mrow id="S3.SS1.p1.3.m3.5.5.2.2" xref="S3.SS1.p1.3.m3.5.5.2.2.cmml"><mi id="S3.SS1.p1.3.m3.5.5.2.2.2" xref="S3.SS1.p1.3.m3.5.5.2.2.2.cmml">n</mi><mo id="S3.SS1.p1.3.m3.5.5.2.2.1" xref="S3.SS1.p1.3.m3.5.5.2.2.1.cmml">=</mo><mrow id="S3.SS1.p1.3.m3.5.5.2.2.3.2" xref="S3.SS1.p1.3.m3.5.5.2.2.3.1.cmml"><mn id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">1</mn><mo id="S3.SS1.p1.3.m3.5.5.2.2.3.2.1" xref="S3.SS1.p1.3.m3.5.5.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.3.m3.2.2" xref="S3.SS1.p1.3.m3.2.2.cmml">⋯</mi><mo id="S3.SS1.p1.3.m3.5.5.2.2.3.2.2" xref="S3.SS1.p1.3.m3.5.5.2.2.3.1.cmml">,</mo><mi id="S3.SS1.p1.3.m3.3.3" xref="S3.SS1.p1.3.m3.3.3.cmml">N</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.5b"><apply id="S3.SS1.p1.3.m3.5.5.3.cmml" xref="S3.SS1.p1.3.m3.5.5.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.5.5.3a.cmml" xref="S3.SS1.p1.3.m3.5.5.2.3">formulae-sequence</csymbol><apply id="S3.SS1.p1.3.m3.4.4.1.1.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1"><eq id="S3.SS1.p1.3.m3.4.4.1.1.3.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.3"></eq><apply id="S3.SS1.p1.3.m3.4.4.1.1.4.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.4.4.1.1.4.1.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.4">subscript</csymbol><ci id="S3.SS1.p1.3.m3.4.4.1.1.4.2.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.4.2">𝒟</ci><ci id="S3.SS1.p1.3.m3.4.4.1.1.4.3.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.4.3">𝑛</ci></apply><apply id="S3.SS1.p1.3.m3.4.4.1.1.2.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.4.4.1.1.2.3.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.2">superscript</csymbol><apply id="S3.SS1.p1.3.m3.4.4.1.1.2.2.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.4.4.1.1.2.2.3.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.2">subscript</csymbol><set id="S3.SS1.p1.3.m3.4.4.1.1.2.2.2.3.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.2.2.2.2"><apply id="S3.SS1.p1.3.m3.4.4.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.SS1.p1.3.m3.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.p1.3.m3.4.4.1.1.2.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.4.4.1.1.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.3.m3.4.4.1.1.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.2.2.2.2.2.2">𝑦</ci><ci id="S3.SS1.p1.3.m3.4.4.1.1.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.2.2.2.2.2.3">𝑖</ci></apply></set><apply id="S3.SS1.p1.3.m3.4.4.1.1.2.2.4.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.2.2.4"><eq id="S3.SS1.p1.3.m3.4.4.1.1.2.2.4.1.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.2.2.4.1"></eq><ci id="S3.SS1.p1.3.m3.4.4.1.1.2.2.4.2.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.2.2.4.2">𝑖</ci><cn type="integer" id="S3.SS1.p1.3.m3.4.4.1.1.2.2.4.3.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.2.2.4.3">1</cn></apply></apply><apply id="S3.SS1.p1.3.m3.4.4.1.1.2.4.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.2.4"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.4.4.1.1.2.4.1.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.2.4">subscript</csymbol><ci id="S3.SS1.p1.3.m3.4.4.1.1.2.4.2.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.2.4.2">𝑚</ci><ci id="S3.SS1.p1.3.m3.4.4.1.1.2.4.3.cmml" xref="S3.SS1.p1.3.m3.4.4.1.1.2.4.3">𝑛</ci></apply></apply></apply><apply id="S3.SS1.p1.3.m3.5.5.2.2.cmml" xref="S3.SS1.p1.3.m3.5.5.2.2"><eq id="S3.SS1.p1.3.m3.5.5.2.2.1.cmml" xref="S3.SS1.p1.3.m3.5.5.2.2.1"></eq><ci id="S3.SS1.p1.3.m3.5.5.2.2.2.cmml" xref="S3.SS1.p1.3.m3.5.5.2.2.2">𝑛</ci><list id="S3.SS1.p1.3.m3.5.5.2.2.3.1.cmml" xref="S3.SS1.p1.3.m3.5.5.2.2.3.2"><cn type="integer" id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">1</cn><ci id="S3.SS1.p1.3.m3.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2">⋯</ci><ci id="S3.SS1.p1.3.m3.3.3.cmml" xref="S3.SS1.p1.3.m3.3.3">𝑁</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.5c">\mathcal{D}_{n}=\{\mathbf{x}_{i},y_{i}\}_{i=1}^{m_{n}},n=1,\cdots,N</annotation></semantics></math> denote the local datasets, <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="m_{n}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">m</mi><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝑚</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">m_{n}</annotation></semantics></math> is the number of images in the <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">n</annotation></semantics></math>-th client. In unsupervised setting, <math id="S3.SS1.p1.6.m6.5" class="ltx_Math" alttext="\mathcal{D}_{n}=\{\mathbf{x}_{i}\}_{i=1}^{m_{n}},n=1,\cdots,N" display="inline"><semantics id="S3.SS1.p1.6.m6.5a"><mrow id="S3.SS1.p1.6.m6.5.5.2" xref="S3.SS1.p1.6.m6.5.5.3.cmml"><mrow id="S3.SS1.p1.6.m6.4.4.1.1" xref="S3.SS1.p1.6.m6.4.4.1.1.cmml"><msub id="S3.SS1.p1.6.m6.4.4.1.1.3" xref="S3.SS1.p1.6.m6.4.4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.4.4.1.1.3.2" xref="S3.SS1.p1.6.m6.4.4.1.1.3.2.cmml">𝒟</mi><mi id="S3.SS1.p1.6.m6.4.4.1.1.3.3" xref="S3.SS1.p1.6.m6.4.4.1.1.3.3.cmml">n</mi></msub><mo id="S3.SS1.p1.6.m6.4.4.1.1.2" xref="S3.SS1.p1.6.m6.4.4.1.1.2.cmml">=</mo><msubsup id="S3.SS1.p1.6.m6.4.4.1.1.1" xref="S3.SS1.p1.6.m6.4.4.1.1.1.cmml"><mrow id="S3.SS1.p1.6.m6.4.4.1.1.1.1.1.1" xref="S3.SS1.p1.6.m6.4.4.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.6.m6.4.4.1.1.1.1.1.1.2" xref="S3.SS1.p1.6.m6.4.4.1.1.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p1.6.m6.4.4.1.1.1.1.1.1.1" xref="S3.SS1.p1.6.m6.4.4.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.6.m6.4.4.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.6.m6.4.4.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.SS1.p1.6.m6.4.4.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.6.m6.4.4.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p1.6.m6.4.4.1.1.1.1.1.1.3" xref="S3.SS1.p1.6.m6.4.4.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p1.6.m6.4.4.1.1.1.1.3" xref="S3.SS1.p1.6.m6.4.4.1.1.1.1.3.cmml"><mi id="S3.SS1.p1.6.m6.4.4.1.1.1.1.3.2" xref="S3.SS1.p1.6.m6.4.4.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p1.6.m6.4.4.1.1.1.1.3.1" xref="S3.SS1.p1.6.m6.4.4.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p1.6.m6.4.4.1.1.1.1.3.3" xref="S3.SS1.p1.6.m6.4.4.1.1.1.1.3.3.cmml">1</mn></mrow><msub id="S3.SS1.p1.6.m6.4.4.1.1.1.3" xref="S3.SS1.p1.6.m6.4.4.1.1.1.3.cmml"><mi id="S3.SS1.p1.6.m6.4.4.1.1.1.3.2" xref="S3.SS1.p1.6.m6.4.4.1.1.1.3.2.cmml">m</mi><mi id="S3.SS1.p1.6.m6.4.4.1.1.1.3.3" xref="S3.SS1.p1.6.m6.4.4.1.1.1.3.3.cmml">n</mi></msub></msubsup></mrow><mo id="S3.SS1.p1.6.m6.5.5.2.3" xref="S3.SS1.p1.6.m6.5.5.3a.cmml">,</mo><mrow id="S3.SS1.p1.6.m6.5.5.2.2" xref="S3.SS1.p1.6.m6.5.5.2.2.cmml"><mi id="S3.SS1.p1.6.m6.5.5.2.2.2" xref="S3.SS1.p1.6.m6.5.5.2.2.2.cmml">n</mi><mo id="S3.SS1.p1.6.m6.5.5.2.2.1" xref="S3.SS1.p1.6.m6.5.5.2.2.1.cmml">=</mo><mrow id="S3.SS1.p1.6.m6.5.5.2.2.3.2" xref="S3.SS1.p1.6.m6.5.5.2.2.3.1.cmml"><mn id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">1</mn><mo id="S3.SS1.p1.6.m6.5.5.2.2.3.2.1" xref="S3.SS1.p1.6.m6.5.5.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.6.m6.2.2" xref="S3.SS1.p1.6.m6.2.2.cmml">⋯</mi><mo id="S3.SS1.p1.6.m6.5.5.2.2.3.2.2" xref="S3.SS1.p1.6.m6.5.5.2.2.3.1.cmml">,</mo><mi id="S3.SS1.p1.6.m6.3.3" xref="S3.SS1.p1.6.m6.3.3.cmml">N</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.5b"><apply id="S3.SS1.p1.6.m6.5.5.3.cmml" xref="S3.SS1.p1.6.m6.5.5.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.5.5.3a.cmml" xref="S3.SS1.p1.6.m6.5.5.2.3">formulae-sequence</csymbol><apply id="S3.SS1.p1.6.m6.4.4.1.1.cmml" xref="S3.SS1.p1.6.m6.4.4.1.1"><eq id="S3.SS1.p1.6.m6.4.4.1.1.2.cmml" xref="S3.SS1.p1.6.m6.4.4.1.1.2"></eq><apply id="S3.SS1.p1.6.m6.4.4.1.1.3.cmml" xref="S3.SS1.p1.6.m6.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.4.4.1.1.3.1.cmml" xref="S3.SS1.p1.6.m6.4.4.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.6.m6.4.4.1.1.3.2.cmml" xref="S3.SS1.p1.6.m6.4.4.1.1.3.2">𝒟</ci><ci id="S3.SS1.p1.6.m6.4.4.1.1.3.3.cmml" xref="S3.SS1.p1.6.m6.4.4.1.1.3.3">𝑛</ci></apply><apply id="S3.SS1.p1.6.m6.4.4.1.1.1.cmml" xref="S3.SS1.p1.6.m6.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.4.4.1.1.1.2.cmml" xref="S3.SS1.p1.6.m6.4.4.1.1.1">superscript</csymbol><apply id="S3.SS1.p1.6.m6.4.4.1.1.1.1.cmml" xref="S3.SS1.p1.6.m6.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.4.4.1.1.1.1.2.cmml" xref="S3.SS1.p1.6.m6.4.4.1.1.1">subscript</csymbol><set id="S3.SS1.p1.6.m6.4.4.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.6.m6.4.4.1.1.1.1.1.1"><apply id="S3.SS1.p1.6.m6.4.4.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.6.m6.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.6.m6.4.4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.6.m6.4.4.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.SS1.p1.6.m6.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.6.m6.4.4.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.SS1.p1.6.m6.4.4.1.1.1.1.3.cmml" xref="S3.SS1.p1.6.m6.4.4.1.1.1.1.3"><eq id="S3.SS1.p1.6.m6.4.4.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.6.m6.4.4.1.1.1.1.3.1"></eq><ci id="S3.SS1.p1.6.m6.4.4.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.6.m6.4.4.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS1.p1.6.m6.4.4.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.6.m6.4.4.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS1.p1.6.m6.4.4.1.1.1.3.cmml" xref="S3.SS1.p1.6.m6.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.4.4.1.1.1.3.1.cmml" xref="S3.SS1.p1.6.m6.4.4.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.6.m6.4.4.1.1.1.3.2.cmml" xref="S3.SS1.p1.6.m6.4.4.1.1.1.3.2">𝑚</ci><ci id="S3.SS1.p1.6.m6.4.4.1.1.1.3.3.cmml" xref="S3.SS1.p1.6.m6.4.4.1.1.1.3.3">𝑛</ci></apply></apply></apply><apply id="S3.SS1.p1.6.m6.5.5.2.2.cmml" xref="S3.SS1.p1.6.m6.5.5.2.2"><eq id="S3.SS1.p1.6.m6.5.5.2.2.1.cmml" xref="S3.SS1.p1.6.m6.5.5.2.2.1"></eq><ci id="S3.SS1.p1.6.m6.5.5.2.2.2.cmml" xref="S3.SS1.p1.6.m6.5.5.2.2.2">𝑛</ci><list id="S3.SS1.p1.6.m6.5.5.2.2.3.1.cmml" xref="S3.SS1.p1.6.m6.5.5.2.2.3.2"><cn type="integer" id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">1</cn><ci id="S3.SS1.p1.6.m6.2.2.cmml" xref="S3.SS1.p1.6.m6.2.2">⋯</ci><ci id="S3.SS1.p1.6.m6.3.3.cmml" xref="S3.SS1.p1.6.m6.3.3">𝑁</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.5c">\mathcal{D}_{n}=\{\mathbf{x}_{i}\}_{i=1}^{m_{n}},n=1,\cdots,N</annotation></semantics></math>. Images in diverse domains have different styles, see Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Note that there may exist domain and category divergences across different clients at the same time, the divergence of category refers to the different label distribution of different clients. Let <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="\mathcal{I}(\cdot)" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><mrow id="S3.SS1.p1.7.m7.1.2" xref="S3.SS1.p1.7.m7.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.7.m7.1.2.2" xref="S3.SS1.p1.7.m7.1.2.2.cmml">ℐ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.7.m7.1.2.1" xref="S3.SS1.p1.7.m7.1.2.1.cmml">​</mo><mrow id="S3.SS1.p1.7.m7.1.2.3.2" xref="S3.SS1.p1.7.m7.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.7.m7.1.2.3.2.1" xref="S3.SS1.p1.7.m7.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.p1.7.m7.1.2.3.2.2" xref="S3.SS1.p1.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.2.cmml" xref="S3.SS1.p1.7.m7.1.2"><times id="S3.SS1.p1.7.m7.1.2.1.cmml" xref="S3.SS1.p1.7.m7.1.2.1"></times><ci id="S3.SS1.p1.7.m7.1.2.2.cmml" xref="S3.SS1.p1.7.m7.1.2.2">ℐ</ci><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">\mathcal{I}(\cdot)</annotation></semantics></math> and <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="\mathcal{T}(\cdot)" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><mrow id="S3.SS1.p1.8.m8.1.2" xref="S3.SS1.p1.8.m8.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.8.m8.1.2.2" xref="S3.SS1.p1.8.m8.1.2.2.cmml">𝒯</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.8.m8.1.2.1" xref="S3.SS1.p1.8.m8.1.2.1.cmml">​</mo><mrow id="S3.SS1.p1.8.m8.1.2.3.2" xref="S3.SS1.p1.8.m8.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.8.m8.1.2.3.2.1" xref="S3.SS1.p1.8.m8.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.p1.8.m8.1.2.3.2.2" xref="S3.SS1.p1.8.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.2.cmml" xref="S3.SS1.p1.8.m8.1.2"><times id="S3.SS1.p1.8.m8.1.2.1.cmml" xref="S3.SS1.p1.8.m8.1.2.1"></times><ci id="S3.SS1.p1.8.m8.1.2.2.cmml" xref="S3.SS1.p1.8.m8.1.2.2">𝒯</ci><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">\mathcal{T}(\cdot)</annotation></semantics></math> denote the image encoder and the text encoder. To reduce the calculation and communication costs, we freeze the parameters of the two encoders and perform the training task by fine-tuning the prompts.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Prompt Tuning</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.2" class="ltx_p">Let <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{t}^{c}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><msup id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">𝐭</mi><mi id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">c</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝐭</ci><ci id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\mathbf{t}^{c}</annotation></semantics></math> be the word embedding of the <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">c</annotation></semantics></math>th-class, the class text could have the form ‘a picture of a dog’. Then the prediction of CLIP for image classification is:</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<table id="A2.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E1.m1.9" class="ltx_Math" alttext="\displaystyle p(c\mid\mathbf{x})=\frac{\exp\left(\cos\left(\mathcal{T}(\mathbf{t}^{c}),\mathcal{I}(\mathbf{x})\right)/\tau\right)}{\sum_{i=1}^{C}\exp\left(\cos\left(\mathcal{T}(\mathbf{t}^{i}),\mathcal{I}(\mathbf{x})\right)/\tau\right)}" display="inline"><semantics id="S3.E1.m1.9a"><mrow id="S3.E1.m1.9.9" xref="S3.E1.m1.9.9.cmml"><mrow id="S3.E1.m1.9.9.1" xref="S3.E1.m1.9.9.1.cmml"><mi id="S3.E1.m1.9.9.1.3" xref="S3.E1.m1.9.9.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.9.9.1.2" xref="S3.E1.m1.9.9.1.2.cmml">​</mo><mrow id="S3.E1.m1.9.9.1.1.1" xref="S3.E1.m1.9.9.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.9.9.1.1.1.2" xref="S3.E1.m1.9.9.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.9.9.1.1.1.1" xref="S3.E1.m1.9.9.1.1.1.1.cmml"><mi id="S3.E1.m1.9.9.1.1.1.1.2" xref="S3.E1.m1.9.9.1.1.1.1.2.cmml">c</mi><mo id="S3.E1.m1.9.9.1.1.1.1.1" xref="S3.E1.m1.9.9.1.1.1.1.1.cmml">∣</mo><mi id="S3.E1.m1.9.9.1.1.1.1.3" xref="S3.E1.m1.9.9.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S3.E1.m1.9.9.1.1.1.3" xref="S3.E1.m1.9.9.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.9.9.2" xref="S3.E1.m1.9.9.2.cmml">=</mo><mstyle displaystyle="true" id="S3.E1.m1.8.8" xref="S3.E1.m1.8.8.cmml"><mfrac id="S3.E1.m1.8.8a" xref="S3.E1.m1.8.8.cmml"><mrow id="S3.E1.m1.4.4.4.4" xref="S3.E1.m1.4.4.4.5.cmml"><mi id="S3.E1.m1.3.3.3.3" xref="S3.E1.m1.3.3.3.3.cmml">exp</mi><mo id="S3.E1.m1.4.4.4.4a" xref="S3.E1.m1.4.4.4.5.cmml">⁡</mo><mrow id="S3.E1.m1.4.4.4.4.1" xref="S3.E1.m1.4.4.4.5.cmml"><mo id="S3.E1.m1.4.4.4.4.1.2" xref="S3.E1.m1.4.4.4.5.cmml">(</mo><mrow id="S3.E1.m1.4.4.4.4.1.1" xref="S3.E1.m1.4.4.4.4.1.1.cmml"><mrow id="S3.E1.m1.4.4.4.4.1.1.2.2" xref="S3.E1.m1.4.4.4.4.1.1.2.3.cmml"><mi id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.2.cmml">cos</mi><mo id="S3.E1.m1.4.4.4.4.1.1.2.2a" xref="S3.E1.m1.4.4.4.4.1.1.2.3.cmml">⁡</mo><mrow id="S3.E1.m1.4.4.4.4.1.1.2.2.2" xref="S3.E1.m1.4.4.4.4.1.1.2.3.cmml"><mo id="S3.E1.m1.4.4.4.4.1.1.2.2.2.3" xref="S3.E1.m1.4.4.4.4.1.1.2.3.cmml">(</mo><mrow id="S3.E1.m1.4.4.4.4.1.1.1.1.1.1" xref="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.3" xref="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.3.cmml">𝒯</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.2" xref="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.1.1" xref="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.2.cmml">𝐭</mi><mi id="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.3.cmml">c</mi></msup><mo stretchy="false" id="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.4.4.4.4.1.1.2.2.2.4" xref="S3.E1.m1.4.4.4.4.1.1.2.3.cmml">,</mo><mrow id="S3.E1.m1.4.4.4.4.1.1.2.2.2.2" xref="S3.E1.m1.4.4.4.4.1.1.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.4.4.4.4.1.1.2.2.2.2.2" xref="S3.E1.m1.4.4.4.4.1.1.2.2.2.2.2.cmml">ℐ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.4.4.1.1.2.2.2.2.1" xref="S3.E1.m1.4.4.4.4.1.1.2.2.2.2.1.cmml">​</mo><mrow id="S3.E1.m1.4.4.4.4.1.1.2.2.2.2.3.2" xref="S3.E1.m1.4.4.4.4.1.1.2.2.2.2.cmml"><mo stretchy="false" id="S3.E1.m1.4.4.4.4.1.1.2.2.2.2.3.2.1" xref="S3.E1.m1.4.4.4.4.1.1.2.2.2.2.cmml">(</mo><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S3.E1.m1.4.4.4.4.1.1.2.2.2.2.3.2.2" xref="S3.E1.m1.4.4.4.4.1.1.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.4.4.4.4.1.1.2.2.2.5" xref="S3.E1.m1.4.4.4.4.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.4.4.4.4.1.1.3" xref="S3.E1.m1.4.4.4.4.1.1.3.cmml">/</mo><mi id="S3.E1.m1.4.4.4.4.1.1.4" xref="S3.E1.m1.4.4.4.4.1.1.4.cmml">τ</mi></mrow><mo id="S3.E1.m1.4.4.4.4.1.3" xref="S3.E1.m1.4.4.4.5.cmml">)</mo></mrow></mrow><mrow id="S3.E1.m1.8.8.8" xref="S3.E1.m1.8.8.8.cmml"><msubsup id="S3.E1.m1.8.8.8.5" xref="S3.E1.m1.8.8.8.5.cmml"><mo id="S3.E1.m1.8.8.8.5.2.2" xref="S3.E1.m1.8.8.8.5.2.2.cmml">∑</mo><mrow id="S3.E1.m1.8.8.8.5.2.3" xref="S3.E1.m1.8.8.8.5.2.3.cmml"><mi id="S3.E1.m1.8.8.8.5.2.3.2" xref="S3.E1.m1.8.8.8.5.2.3.2.cmml">i</mi><mo id="S3.E1.m1.8.8.8.5.2.3.1" xref="S3.E1.m1.8.8.8.5.2.3.1.cmml">=</mo><mn id="S3.E1.m1.8.8.8.5.2.3.3" xref="S3.E1.m1.8.8.8.5.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.8.8.8.5.3" xref="S3.E1.m1.8.8.8.5.3.cmml">C</mi></msubsup><mrow id="S3.E1.m1.8.8.8.4.1" xref="S3.E1.m1.8.8.8.4.2.cmml"><mi id="S3.E1.m1.7.7.7.3" xref="S3.E1.m1.7.7.7.3.cmml">exp</mi><mo id="S3.E1.m1.8.8.8.4.1a" xref="S3.E1.m1.8.8.8.4.2.cmml">⁡</mo><mrow id="S3.E1.m1.8.8.8.4.1.1" xref="S3.E1.m1.8.8.8.4.2.cmml"><mo id="S3.E1.m1.8.8.8.4.1.1.2" xref="S3.E1.m1.8.8.8.4.2.cmml">(</mo><mrow id="S3.E1.m1.8.8.8.4.1.1.1" xref="S3.E1.m1.8.8.8.4.1.1.1.cmml"><mrow id="S3.E1.m1.8.8.8.4.1.1.1.2.2" xref="S3.E1.m1.8.8.8.4.1.1.1.2.3.cmml"><mi id="S3.E1.m1.6.6.6.2" xref="S3.E1.m1.6.6.6.2.cmml">cos</mi><mo id="S3.E1.m1.8.8.8.4.1.1.1.2.2a" xref="S3.E1.m1.8.8.8.4.1.1.1.2.3.cmml">⁡</mo><mrow id="S3.E1.m1.8.8.8.4.1.1.1.2.2.2" xref="S3.E1.m1.8.8.8.4.1.1.1.2.3.cmml"><mo id="S3.E1.m1.8.8.8.4.1.1.1.2.2.2.3" xref="S3.E1.m1.8.8.8.4.1.1.1.2.3.cmml">(</mo><mrow id="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1" xref="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.3" xref="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.3.cmml">𝒯</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.2" xref="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐭</mi><mi id="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msup><mo stretchy="false" id="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.8.8.8.4.1.1.1.2.2.2.4" xref="S3.E1.m1.8.8.8.4.1.1.1.2.3.cmml">,</mo><mrow id="S3.E1.m1.8.8.8.4.1.1.1.2.2.2.2" xref="S3.E1.m1.8.8.8.4.1.1.1.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.8.8.8.4.1.1.1.2.2.2.2.2" xref="S3.E1.m1.8.8.8.4.1.1.1.2.2.2.2.2.cmml">ℐ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.8.8.8.4.1.1.1.2.2.2.2.1" xref="S3.E1.m1.8.8.8.4.1.1.1.2.2.2.2.1.cmml">​</mo><mrow id="S3.E1.m1.8.8.8.4.1.1.1.2.2.2.2.3.2" xref="S3.E1.m1.8.8.8.4.1.1.1.2.2.2.2.cmml"><mo stretchy="false" id="S3.E1.m1.8.8.8.4.1.1.1.2.2.2.2.3.2.1" xref="S3.E1.m1.8.8.8.4.1.1.1.2.2.2.2.cmml">(</mo><mi id="S3.E1.m1.5.5.5.1" xref="S3.E1.m1.5.5.5.1.cmml">𝐱</mi><mo stretchy="false" id="S3.E1.m1.8.8.8.4.1.1.1.2.2.2.2.3.2.2" xref="S3.E1.m1.8.8.8.4.1.1.1.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.8.8.8.4.1.1.1.2.2.2.5" xref="S3.E1.m1.8.8.8.4.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.8.8.8.4.1.1.1.3" xref="S3.E1.m1.8.8.8.4.1.1.1.3.cmml">/</mo><mi id="S3.E1.m1.8.8.8.4.1.1.1.4" xref="S3.E1.m1.8.8.8.4.1.1.1.4.cmml">τ</mi></mrow><mo id="S3.E1.m1.8.8.8.4.1.1.3" xref="S3.E1.m1.8.8.8.4.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.9b"><apply id="S3.E1.m1.9.9.cmml" xref="S3.E1.m1.9.9"><eq id="S3.E1.m1.9.9.2.cmml" xref="S3.E1.m1.9.9.2"></eq><apply id="S3.E1.m1.9.9.1.cmml" xref="S3.E1.m1.9.9.1"><times id="S3.E1.m1.9.9.1.2.cmml" xref="S3.E1.m1.9.9.1.2"></times><ci id="S3.E1.m1.9.9.1.3.cmml" xref="S3.E1.m1.9.9.1.3">𝑝</ci><apply id="S3.E1.m1.9.9.1.1.1.1.cmml" xref="S3.E1.m1.9.9.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.9.9.1.1.1.1.1.cmml" xref="S3.E1.m1.9.9.1.1.1.1.1">conditional</csymbol><ci id="S3.E1.m1.9.9.1.1.1.1.2.cmml" xref="S3.E1.m1.9.9.1.1.1.1.2">𝑐</ci><ci id="S3.E1.m1.9.9.1.1.1.1.3.cmml" xref="S3.E1.m1.9.9.1.1.1.1.3">𝐱</ci></apply></apply><apply id="S3.E1.m1.8.8.cmml" xref="S3.E1.m1.8.8"><divide id="S3.E1.m1.8.8.9.cmml" xref="S3.E1.m1.8.8"></divide><apply id="S3.E1.m1.4.4.4.5.cmml" xref="S3.E1.m1.4.4.4.4"><exp id="S3.E1.m1.3.3.3.3.cmml" xref="S3.E1.m1.3.3.3.3"></exp><apply id="S3.E1.m1.4.4.4.4.1.1.cmml" xref="S3.E1.m1.4.4.4.4.1.1"><divide id="S3.E1.m1.4.4.4.4.1.1.3.cmml" xref="S3.E1.m1.4.4.4.4.1.1.3"></divide><apply id="S3.E1.m1.4.4.4.4.1.1.2.3.cmml" xref="S3.E1.m1.4.4.4.4.1.1.2.2"><cos id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2"></cos><apply id="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.4.4.1.1.1.1.1.1"><times id="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.2"></times><ci id="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.3">𝒯</ci><apply id="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.2">𝐭</ci><ci id="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.3">𝑐</ci></apply></apply><apply id="S3.E1.m1.4.4.4.4.1.1.2.2.2.2.cmml" xref="S3.E1.m1.4.4.4.4.1.1.2.2.2.2"><times id="S3.E1.m1.4.4.4.4.1.1.2.2.2.2.1.cmml" xref="S3.E1.m1.4.4.4.4.1.1.2.2.2.2.1"></times><ci id="S3.E1.m1.4.4.4.4.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.4.4.4.4.1.1.2.2.2.2.2">ℐ</ci><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝐱</ci></apply></apply><ci id="S3.E1.m1.4.4.4.4.1.1.4.cmml" xref="S3.E1.m1.4.4.4.4.1.1.4">𝜏</ci></apply></apply><apply id="S3.E1.m1.8.8.8.cmml" xref="S3.E1.m1.8.8.8"><apply id="S3.E1.m1.8.8.8.5.cmml" xref="S3.E1.m1.8.8.8.5"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.8.5.1.cmml" xref="S3.E1.m1.8.8.8.5">superscript</csymbol><apply id="S3.E1.m1.8.8.8.5.2.cmml" xref="S3.E1.m1.8.8.8.5"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.8.5.2.1.cmml" xref="S3.E1.m1.8.8.8.5">subscript</csymbol><sum id="S3.E1.m1.8.8.8.5.2.2.cmml" xref="S3.E1.m1.8.8.8.5.2.2"></sum><apply id="S3.E1.m1.8.8.8.5.2.3.cmml" xref="S3.E1.m1.8.8.8.5.2.3"><eq id="S3.E1.m1.8.8.8.5.2.3.1.cmml" xref="S3.E1.m1.8.8.8.5.2.3.1"></eq><ci id="S3.E1.m1.8.8.8.5.2.3.2.cmml" xref="S3.E1.m1.8.8.8.5.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.8.8.8.5.2.3.3.cmml" xref="S3.E1.m1.8.8.8.5.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.8.8.8.5.3.cmml" xref="S3.E1.m1.8.8.8.5.3">𝐶</ci></apply><apply id="S3.E1.m1.8.8.8.4.2.cmml" xref="S3.E1.m1.8.8.8.4.1"><exp id="S3.E1.m1.7.7.7.3.cmml" xref="S3.E1.m1.7.7.7.3"></exp><apply id="S3.E1.m1.8.8.8.4.1.1.1.cmml" xref="S3.E1.m1.8.8.8.4.1.1.1"><divide id="S3.E1.m1.8.8.8.4.1.1.1.3.cmml" xref="S3.E1.m1.8.8.8.4.1.1.1.3"></divide><apply id="S3.E1.m1.8.8.8.4.1.1.1.2.3.cmml" xref="S3.E1.m1.8.8.8.4.1.1.1.2.2"><cos id="S3.E1.m1.6.6.6.2.cmml" xref="S3.E1.m1.6.6.6.2"></cos><apply id="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1"><times id="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.2"></times><ci id="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.3">𝒯</ci><apply id="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.1.1.1.2">𝐭</ci><ci id="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.8.8.8.4.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.8.8.8.4.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.8.8.8.4.1.1.1.2.2.2.2"><times id="S3.E1.m1.8.8.8.4.1.1.1.2.2.2.2.1.cmml" xref="S3.E1.m1.8.8.8.4.1.1.1.2.2.2.2.1"></times><ci id="S3.E1.m1.8.8.8.4.1.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.8.8.8.4.1.1.1.2.2.2.2.2">ℐ</ci><ci id="S3.E1.m1.5.5.5.1.cmml" xref="S3.E1.m1.5.5.5.1">𝐱</ci></apply></apply><ci id="S3.E1.m1.8.8.8.4.1.1.1.4.cmml" xref="S3.E1.m1.8.8.8.4.1.1.1.4">𝜏</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.9c">\displaystyle p(c\mid\mathbf{x})=\frac{\exp\left(\cos\left(\mathcal{T}(\mathbf{t}^{c}),\mathcal{I}(\mathbf{x})\right)/\tau\right)}{\sum_{i=1}^{C}\exp\left(\cos\left(\mathcal{T}(\mathbf{t}^{i}),\mathcal{I}(\mathbf{x})\right)/\tau\right)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.2" class="ltx_p">where <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">C</annotation></semantics></math> is the number of classes, <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\tau</annotation></semantics></math> is a temperature parameter learned by CLIP.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.8" class="ltx_p">To fine-tune the model, one method is to manually set prompts, such as replacing ‘a picture of a dog’ with ‘a picture of a cute dog’. However, in this way, because the change of words will directly affect the performance of the model, we need to find the most appropriate words. Another method is prompt tuning <cite class="ltx_cite ltx_citemacro_citep">(Li and Liang <a href="#bib.bib19" title="" class="ltx_ref">2021</a>; Liu et al. <a href="#bib.bib21" title="" class="ltx_ref">2021b</a>; Zhou et al. <a href="#bib.bib48" title="" class="ltx_ref">2022b</a>)</cite>. Let <math id="S3.SS2.p3.1.m1.4" class="ltx_Math" alttext="\mathbf{p}^{c}=[\boldsymbol{v}^{c}_{1},\boldsymbol{v}^{c}_{2},\ldots,\boldsymbol{v}^{c}_{M}]" display="inline"><semantics id="S3.SS2.p3.1.m1.4a"><mrow id="S3.SS2.p3.1.m1.4.4" xref="S3.SS2.p3.1.m1.4.4.cmml"><msup id="S3.SS2.p3.1.m1.4.4.5" xref="S3.SS2.p3.1.m1.4.4.5.cmml"><mi id="S3.SS2.p3.1.m1.4.4.5.2" xref="S3.SS2.p3.1.m1.4.4.5.2.cmml">𝐩</mi><mi id="S3.SS2.p3.1.m1.4.4.5.3" xref="S3.SS2.p3.1.m1.4.4.5.3.cmml">c</mi></msup><mo id="S3.SS2.p3.1.m1.4.4.4" xref="S3.SS2.p3.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS2.p3.1.m1.4.4.3.3" xref="S3.SS2.p3.1.m1.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS2.p3.1.m1.4.4.3.3.4" xref="S3.SS2.p3.1.m1.4.4.3.4.cmml">[</mo><msubsup id="S3.SS2.p3.1.m1.2.2.1.1.1" xref="S3.SS2.p3.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.2.2.1.1.1.2.2" xref="S3.SS2.p3.1.m1.2.2.1.1.1.2.2.cmml">𝒗</mi><mn id="S3.SS2.p3.1.m1.2.2.1.1.1.3" xref="S3.SS2.p3.1.m1.2.2.1.1.1.3.cmml">1</mn><mi id="S3.SS2.p3.1.m1.2.2.1.1.1.2.3" xref="S3.SS2.p3.1.m1.2.2.1.1.1.2.3.cmml">c</mi></msubsup><mo id="S3.SS2.p3.1.m1.4.4.3.3.5" xref="S3.SS2.p3.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S3.SS2.p3.1.m1.3.3.2.2.2" xref="S3.SS2.p3.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS2.p3.1.m1.3.3.2.2.2.2.2" xref="S3.SS2.p3.1.m1.3.3.2.2.2.2.2.cmml">𝒗</mi><mn id="S3.SS2.p3.1.m1.3.3.2.2.2.3" xref="S3.SS2.p3.1.m1.3.3.2.2.2.3.cmml">2</mn><mi id="S3.SS2.p3.1.m1.3.3.2.2.2.2.3" xref="S3.SS2.p3.1.m1.3.3.2.2.2.2.3.cmml">c</mi></msubsup><mo id="S3.SS2.p3.1.m1.4.4.3.3.6" xref="S3.SS2.p3.1.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">…</mi><mo id="S3.SS2.p3.1.m1.4.4.3.3.7" xref="S3.SS2.p3.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S3.SS2.p3.1.m1.4.4.3.3.3" xref="S3.SS2.p3.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS2.p3.1.m1.4.4.3.3.3.2.2" xref="S3.SS2.p3.1.m1.4.4.3.3.3.2.2.cmml">𝒗</mi><mi id="S3.SS2.p3.1.m1.4.4.3.3.3.3" xref="S3.SS2.p3.1.m1.4.4.3.3.3.3.cmml">M</mi><mi id="S3.SS2.p3.1.m1.4.4.3.3.3.2.3" xref="S3.SS2.p3.1.m1.4.4.3.3.3.2.3.cmml">c</mi></msubsup><mo stretchy="false" id="S3.SS2.p3.1.m1.4.4.3.3.8" xref="S3.SS2.p3.1.m1.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.4b"><apply id="S3.SS2.p3.1.m1.4.4.cmml" xref="S3.SS2.p3.1.m1.4.4"><eq id="S3.SS2.p3.1.m1.4.4.4.cmml" xref="S3.SS2.p3.1.m1.4.4.4"></eq><apply id="S3.SS2.p3.1.m1.4.4.5.cmml" xref="S3.SS2.p3.1.m1.4.4.5"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.4.4.5.1.cmml" xref="S3.SS2.p3.1.m1.4.4.5">superscript</csymbol><ci id="S3.SS2.p3.1.m1.4.4.5.2.cmml" xref="S3.SS2.p3.1.m1.4.4.5.2">𝐩</ci><ci id="S3.SS2.p3.1.m1.4.4.5.3.cmml" xref="S3.SS2.p3.1.m1.4.4.5.3">𝑐</ci></apply><list id="S3.SS2.p3.1.m1.4.4.3.4.cmml" xref="S3.SS2.p3.1.m1.4.4.3.3"><apply id="S3.SS2.p3.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.1">subscript</csymbol><apply id="S3.SS2.p3.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.2.2.1.1.1.2.1.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.1">superscript</csymbol><ci id="S3.SS2.p3.1.m1.2.2.1.1.1.2.2.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.1.2.2">𝒗</ci><ci id="S3.SS2.p3.1.m1.2.2.1.1.1.2.3.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.1.2.3">𝑐</ci></apply><cn type="integer" id="S3.SS2.p3.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS2.p3.1.m1.3.3.2.2.2.cmml" xref="S3.SS2.p3.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS2.p3.1.m1.3.3.2.2.2">subscript</csymbol><apply id="S3.SS2.p3.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS2.p3.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.3.3.2.2.2.2.1.cmml" xref="S3.SS2.p3.1.m1.3.3.2.2.2">superscript</csymbol><ci id="S3.SS2.p3.1.m1.3.3.2.2.2.2.2.cmml" xref="S3.SS2.p3.1.m1.3.3.2.2.2.2.2">𝒗</ci><ci id="S3.SS2.p3.1.m1.3.3.2.2.2.2.3.cmml" xref="S3.SS2.p3.1.m1.3.3.2.2.2.2.3">𝑐</ci></apply><cn type="integer" id="S3.SS2.p3.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS2.p3.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">…</ci><apply id="S3.SS2.p3.1.m1.4.4.3.3.3.cmml" xref="S3.SS2.p3.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS2.p3.1.m1.4.4.3.3.3">subscript</csymbol><apply id="S3.SS2.p3.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS2.p3.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.4.4.3.3.3.2.1.cmml" xref="S3.SS2.p3.1.m1.4.4.3.3.3">superscript</csymbol><ci id="S3.SS2.p3.1.m1.4.4.3.3.3.2.2.cmml" xref="S3.SS2.p3.1.m1.4.4.3.3.3.2.2">𝒗</ci><ci id="S3.SS2.p3.1.m1.4.4.3.3.3.2.3.cmml" xref="S3.SS2.p3.1.m1.4.4.3.3.3.2.3">𝑐</ci></apply><ci id="S3.SS2.p3.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS2.p3.1.m1.4.4.3.3.3.3">𝑀</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.4c">\mathbf{p}^{c}=[\boldsymbol{v}^{c}_{1},\boldsymbol{v}^{c}_{2},\ldots,\boldsymbol{v}^{c}_{M}]</annotation></semantics></math> be the prompt. The input of the <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><mi id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><ci id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">c</annotation></semantics></math>-th class for the text encoder is <math id="S3.SS2.p3.3.m3.2" class="ltx_Math" alttext="(\mathbf{p}^{c};\mathbf{t}^{c})" display="inline"><semantics id="S3.SS2.p3.3.m3.2a"><mrow id="S3.SS2.p3.3.m3.2.2.2" xref="S3.SS2.p3.3.m3.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p3.3.m3.2.2.2.3" xref="S3.SS2.p3.3.m3.2.2.3.cmml">(</mo><msup id="S3.SS2.p3.3.m3.1.1.1.1" xref="S3.SS2.p3.3.m3.1.1.1.1.cmml"><mi id="S3.SS2.p3.3.m3.1.1.1.1.2" xref="S3.SS2.p3.3.m3.1.1.1.1.2.cmml">𝐩</mi><mi id="S3.SS2.p3.3.m3.1.1.1.1.3" xref="S3.SS2.p3.3.m3.1.1.1.1.3.cmml">c</mi></msup><mo id="S3.SS2.p3.3.m3.2.2.2.4" xref="S3.SS2.p3.3.m3.2.2.3.cmml">;</mo><msup id="S3.SS2.p3.3.m3.2.2.2.2" xref="S3.SS2.p3.3.m3.2.2.2.2.cmml"><mi id="S3.SS2.p3.3.m3.2.2.2.2.2" xref="S3.SS2.p3.3.m3.2.2.2.2.2.cmml">𝐭</mi><mi id="S3.SS2.p3.3.m3.2.2.2.2.3" xref="S3.SS2.p3.3.m3.2.2.2.2.3.cmml">c</mi></msup><mo stretchy="false" id="S3.SS2.p3.3.m3.2.2.2.5" xref="S3.SS2.p3.3.m3.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.2b"><list id="S3.SS2.p3.3.m3.2.2.3.cmml" xref="S3.SS2.p3.3.m3.2.2.2"><apply id="S3.SS2.p3.3.m3.1.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.1.1.2">𝐩</ci><ci id="S3.SS2.p3.3.m3.1.1.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.1.1.3">𝑐</ci></apply><apply id="S3.SS2.p3.3.m3.2.2.2.2.cmml" xref="S3.SS2.p3.3.m3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.2.2.2.2.1.cmml" xref="S3.SS2.p3.3.m3.2.2.2.2">superscript</csymbol><ci id="S3.SS2.p3.3.m3.2.2.2.2.2.cmml" xref="S3.SS2.p3.3.m3.2.2.2.2.2">𝐭</ci><ci id="S3.SS2.p3.3.m3.2.2.2.2.3.cmml" xref="S3.SS2.p3.3.m3.2.2.2.2.3">𝑐</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.2c">(\mathbf{p}^{c};\mathbf{t}^{c})</annotation></semantics></math>, where
<math id="S3.SS2.p3.4.m4.1" class="ltx_Math" alttext="\{\boldsymbol{v}^{c}_{i}\}^{M}_{i=1}" display="inline"><semantics id="S3.SS2.p3.4.m4.1a"><msubsup id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml"><mrow id="S3.SS2.p3.4.m4.1.1.1.1.1" xref="S3.SS2.p3.4.m4.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p3.4.m4.1.1.1.1.1.2" xref="S3.SS2.p3.4.m4.1.1.1.1.2.cmml">{</mo><msubsup id="S3.SS2.p3.4.m4.1.1.1.1.1.1" xref="S3.SS2.p3.4.m4.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.4.m4.1.1.1.1.1.1.2.2" xref="S3.SS2.p3.4.m4.1.1.1.1.1.1.2.2.cmml">𝒗</mi><mi id="S3.SS2.p3.4.m4.1.1.1.1.1.1.3" xref="S3.SS2.p3.4.m4.1.1.1.1.1.1.3.cmml">i</mi><mi id="S3.SS2.p3.4.m4.1.1.1.1.1.1.2.3" xref="S3.SS2.p3.4.m4.1.1.1.1.1.1.2.3.cmml">c</mi></msubsup><mo stretchy="false" id="S3.SS2.p3.4.m4.1.1.1.1.1.3" xref="S3.SS2.p3.4.m4.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3.cmml"><mi id="S3.SS2.p3.4.m4.1.1.3.2" xref="S3.SS2.p3.4.m4.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p3.4.m4.1.1.3.1" xref="S3.SS2.p3.4.m4.1.1.3.1.cmml">=</mo><mn id="S3.SS2.p3.4.m4.1.1.3.3" xref="S3.SS2.p3.4.m4.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p3.4.m4.1.1.1.3" xref="S3.SS2.p3.4.m4.1.1.1.3.cmml">M</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1">subscript</csymbol><apply id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1">superscript</csymbol><set id="S3.SS2.p3.4.m4.1.1.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.1"><apply id="S3.SS2.p3.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS2.p3.4.m4.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.1.1.2.2">𝒗</ci><ci id="S3.SS2.p3.4.m4.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.1.1.2.3">𝑐</ci></apply><ci id="S3.SS2.p3.4.m4.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.1.1.3">𝑖</ci></apply></set><ci id="S3.SS2.p3.4.m4.1.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.1.3">𝑀</ci></apply><apply id="S3.SS2.p3.4.m4.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3"><eq id="S3.SS2.p3.4.m4.1.1.3.1.cmml" xref="S3.SS2.p3.4.m4.1.1.3.1"></eq><ci id="S3.SS2.p3.4.m4.1.1.3.2.cmml" xref="S3.SS2.p3.4.m4.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS2.p3.4.m4.1.1.3.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">\{\boldsymbol{v}^{c}_{i}\}^{M}_{i=1}</annotation></semantics></math> are learnable prompts for the <math id="S3.SS2.p3.5.m5.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS2.p3.5.m5.1a"><mi id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><ci id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">c</annotation></semantics></math>-th class. <math id="S3.SS2.p3.6.m6.1" class="ltx_Math" alttext="\boldsymbol{v}^{c}_{i}" display="inline"><semantics id="S3.SS2.p3.6.m6.1a"><msubsup id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml"><mi id="S3.SS2.p3.6.m6.1.1.2.2" xref="S3.SS2.p3.6.m6.1.1.2.2.cmml">𝒗</mi><mi id="S3.SS2.p3.6.m6.1.1.3" xref="S3.SS2.p3.6.m6.1.1.3.cmml">i</mi><mi id="S3.SS2.p3.6.m6.1.1.2.3" xref="S3.SS2.p3.6.m6.1.1.2.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><apply id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.1.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1">subscript</csymbol><apply id="S3.SS2.p3.6.m6.1.1.2.cmml" xref="S3.SS2.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.1.1.2.1.cmml" xref="S3.SS2.p3.6.m6.1.1">superscript</csymbol><ci id="S3.SS2.p3.6.m6.1.1.2.2.cmml" xref="S3.SS2.p3.6.m6.1.1.2.2">𝒗</ci><ci id="S3.SS2.p3.6.m6.1.1.2.3.cmml" xref="S3.SS2.p3.6.m6.1.1.2.3">𝑐</ci></apply><ci id="S3.SS2.p3.6.m6.1.1.3.cmml" xref="S3.SS2.p3.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">\boldsymbol{v}^{c}_{i}</annotation></semantics></math> has the same dimension as word embedding <math id="S3.SS2.p3.7.m7.1" class="ltx_Math" alttext="\mathbf{t}^{c}" display="inline"><semantics id="S3.SS2.p3.7.m7.1a"><msup id="S3.SS2.p3.7.m7.1.1" xref="S3.SS2.p3.7.m7.1.1.cmml"><mi id="S3.SS2.p3.7.m7.1.1.2" xref="S3.SS2.p3.7.m7.1.1.2.cmml">𝐭</mi><mi id="S3.SS2.p3.7.m7.1.1.3" xref="S3.SS2.p3.7.m7.1.1.3.cmml">c</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m7.1b"><apply id="S3.SS2.p3.7.m7.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.7.m7.1.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1">superscript</csymbol><ci id="S3.SS2.p3.7.m7.1.1.2.cmml" xref="S3.SS2.p3.7.m7.1.1.2">𝐭</ci><ci id="S3.SS2.p3.7.m7.1.1.3.cmml" xref="S3.SS2.p3.7.m7.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m7.1c">\mathbf{t}^{c}</annotation></semantics></math>, <math id="S3.SS2.p3.8.m8.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS2.p3.8.m8.1a"><mi id="S3.SS2.p3.8.m8.1.1" xref="S3.SS2.p3.8.m8.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m8.1b"><ci id="S3.SS2.p3.8.m8.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m8.1c">M</annotation></semantics></math> is the number of learnable prompts.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2211.07864/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="123" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Overview of FedAPT. The federated training process is as follows: <span id="S3.F2.12.1" class="ltx_text ltx_font_bold">Step1</span>: The server first randomly generates a set of random keys and assigns each client a frozen key. <span id="S3.F2.13.2" class="ltx_text ltx_font_bold">Step2</span>: In local training, the key is used to give a constraint to the prompt. In addition, each client trains the adaptive network <math id="S3.F2.5.m1.1" class="ltx_Math" alttext="\mathcal{Q}_{n}" display="inline"><semantics id="S3.F2.5.m1.1b"><msub id="S3.F2.5.m1.1.1" xref="S3.F2.5.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.F2.5.m1.1.1.2" xref="S3.F2.5.m1.1.1.2.cmml">𝒬</mi><mi id="S3.F2.5.m1.1.1.3" xref="S3.F2.5.m1.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.5.m1.1c"><apply id="S3.F2.5.m1.1.1.cmml" xref="S3.F2.5.m1.1.1"><csymbol cd="ambiguous" id="S3.F2.5.m1.1.1.1.cmml" xref="S3.F2.5.m1.1.1">subscript</csymbol><ci id="S3.F2.5.m1.1.1.2.cmml" xref="S3.F2.5.m1.1.1.2">𝒬</ci><ci id="S3.F2.5.m1.1.1.3.cmml" xref="S3.F2.5.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.5.m1.1d">\mathcal{Q}_{n}</annotation></semantics></math> with local data. <span id="S3.F2.14.3" class="ltx_text ltx_font_bold">Step3</span>: After local training, the server averages the prompts and adaptive networks learned by the clients and sends the results back to the clients. Repeat Steps 2<math id="S3.F2.6.m2.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S3.F2.6.m2.1b"><mo id="S3.F2.6.m2.1.1" xref="S3.F2.6.m2.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S3.F2.6.m2.1c"><csymbol cd="latexml" id="S3.F2.6.m2.1.1.cmml" xref="S3.F2.6.m2.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.6.m2.1d">\sim</annotation></semantics></math>3 for multiple rounds, we can obtain <math id="S3.F2.7.m3.1" class="ltx_Math" alttext="\mathbf{p}_{g}" display="inline"><semantics id="S3.F2.7.m3.1b"><msub id="S3.F2.7.m3.1.1" xref="S3.F2.7.m3.1.1.cmml"><mi id="S3.F2.7.m3.1.1.2" xref="S3.F2.7.m3.1.1.2.cmml">𝐩</mi><mi id="S3.F2.7.m3.1.1.3" xref="S3.F2.7.m3.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.7.m3.1c"><apply id="S3.F2.7.m3.1.1.cmml" xref="S3.F2.7.m3.1.1"><csymbol cd="ambiguous" id="S3.F2.7.m3.1.1.1.cmml" xref="S3.F2.7.m3.1.1">subscript</csymbol><ci id="S3.F2.7.m3.1.1.2.cmml" xref="S3.F2.7.m3.1.1.2">𝐩</ci><ci id="S3.F2.7.m3.1.1.3.cmml" xref="S3.F2.7.m3.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.7.m3.1d">\mathbf{p}_{g}</annotation></semantics></math> and <math id="S3.F2.8.m4.1" class="ltx_Math" alttext="\mathcal{Q}_{g}" display="inline"><semantics id="S3.F2.8.m4.1b"><msub id="S3.F2.8.m4.1.1" xref="S3.F2.8.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.F2.8.m4.1.1.2" xref="S3.F2.8.m4.1.1.2.cmml">𝒬</mi><mi id="S3.F2.8.m4.1.1.3" xref="S3.F2.8.m4.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.8.m4.1c"><apply id="S3.F2.8.m4.1.1.cmml" xref="S3.F2.8.m4.1.1"><csymbol cd="ambiguous" id="S3.F2.8.m4.1.1.1.cmml" xref="S3.F2.8.m4.1.1">subscript</csymbol><ci id="S3.F2.8.m4.1.1.2.cmml" xref="S3.F2.8.m4.1.1.2">𝒬</ci><ci id="S3.F2.8.m4.1.1.3.cmml" xref="S3.F2.8.m4.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.8.m4.1d">\mathcal{Q}_{g}</annotation></semantics></math> to establish our target global model which can generate a personalized prompt according to image features. </figcaption>
</figure>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Federated Learning with Prompt</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.7" class="ltx_p">The concept of FL is introduced in FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al. <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite> to collaboratively train a global model that works for each participant. A straightforward way to apply CLIP’s prompt tuning to the FL field is that each client trains its own prompt and uploads the prompt to the server. The server averages the prompts of all clients and distributes them to the clients.
Let <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{p}^{c}_{n}" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><msubsup id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.2.2" xref="S3.SS3.p1.1.m1.1.1.2.2.cmml">𝐩</mi><mi id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml">n</mi><mi id="S3.SS3.p1.1.m1.1.1.2.3" xref="S3.SS3.p1.1.m1.1.1.2.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">subscript</csymbol><apply id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.2.1.cmml" xref="S3.SS3.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.2.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2.2">𝐩</ci><ci id="S3.SS3.p1.1.m1.1.1.2.3.cmml" xref="S3.SS3.p1.1.m1.1.1.2.3">𝑐</ci></apply><ci id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\mathbf{p}^{c}_{n}</annotation></semantics></math> denotes the prompt for the <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">c</annotation></semantics></math>-th class in the <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">n</annotation></semantics></math>-th client. For the sake of brevity, we omit <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><mi id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><ci id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">c</annotation></semantics></math> and use <math id="S3.SS3.p1.5.m5.1" class="ltx_Math" alttext="\mathbf{p}_{n}" display="inline"><semantics id="S3.SS3.p1.5.m5.1a"><msub id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml"><mi id="S3.SS3.p1.5.m5.1.1.2" xref="S3.SS3.p1.5.m5.1.1.2.cmml">𝐩</mi><mi id="S3.SS3.p1.5.m5.1.1.3" xref="S3.SS3.p1.5.m5.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><apply id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p1.5.m5.1.1.2.cmml" xref="S3.SS3.p1.5.m5.1.1.2">𝐩</ci><ci id="S3.SS3.p1.5.m5.1.1.3.cmml" xref="S3.SS3.p1.5.m5.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">\mathbf{p}_{n}</annotation></semantics></math> to denote the prompt in the <math id="S3.SS3.p1.6.m6.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS3.p1.6.m6.1a"><mi id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><ci id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">n</annotation></semantics></math>-th client. Let <math id="S3.SS3.p1.7.m7.1" class="ltx_Math" alttext="\mathbf{p}_{g}" display="inline"><semantics id="S3.SS3.p1.7.m7.1a"><msub id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml"><mi id="S3.SS3.p1.7.m7.1.1.2" xref="S3.SS3.p1.7.m7.1.1.2.cmml">𝐩</mi><mi id="S3.SS3.p1.7.m7.1.1.3" xref="S3.SS3.p1.7.m7.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><apply id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.1.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.p1.7.m7.1.1.2.cmml" xref="S3.SS3.p1.7.m7.1.1.2">𝐩</ci><ci id="S3.SS3.p1.7.m7.1.1.3.cmml" xref="S3.SS3.p1.7.m7.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">\mathbf{p}_{g}</annotation></semantics></math> denotes the prompt of the global model. Then the global objective is:</p>
<table id="A2.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2.m1.5" class="ltx_Math" alttext="\displaystyle\mathbf{p}_{g}=\arg\min_{\mathbf{p}\in\mathbb{R}^{d}}\frac{1}{N}\sum_{n=1}^{N}\mathbb{E}_{\mathbf{x},y\sim\mathcal{D}_{n}}[\ell(\mathcal{T}(\mathbf{p});\mathcal{I}(\mathbf{x}))]" display="inline"><semantics id="S3.E2.m1.5a"><mrow id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml"><msub id="S3.E2.m1.5.5.3" xref="S3.E2.m1.5.5.3.cmml"><mi id="S3.E2.m1.5.5.3.2" xref="S3.E2.m1.5.5.3.2.cmml">𝐩</mi><mi id="S3.E2.m1.5.5.3.3" xref="S3.E2.m1.5.5.3.3.cmml">g</mi></msub><mo id="S3.E2.m1.5.5.2" xref="S3.E2.m1.5.5.2.cmml">=</mo><mrow id="S3.E2.m1.5.5.1" xref="S3.E2.m1.5.5.1.cmml"><mrow id="S3.E2.m1.5.5.1.3" xref="S3.E2.m1.5.5.1.3.cmml"><mi id="S3.E2.m1.5.5.1.3.1" xref="S3.E2.m1.5.5.1.3.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E2.m1.5.5.1.3a" xref="S3.E2.m1.5.5.1.3.cmml">⁡</mo><mrow id="S3.E2.m1.5.5.1.3.2" xref="S3.E2.m1.5.5.1.3.2.cmml"><munder id="S3.E2.m1.5.5.1.3.2.1" xref="S3.E2.m1.5.5.1.3.2.1.cmml"><mi id="S3.E2.m1.5.5.1.3.2.1.2" xref="S3.E2.m1.5.5.1.3.2.1.2.cmml">min</mi><mrow id="S3.E2.m1.5.5.1.3.2.1.3" xref="S3.E2.m1.5.5.1.3.2.1.3.cmml"><mi id="S3.E2.m1.5.5.1.3.2.1.3.2" xref="S3.E2.m1.5.5.1.3.2.1.3.2.cmml">𝐩</mi><mo id="S3.E2.m1.5.5.1.3.2.1.3.1" xref="S3.E2.m1.5.5.1.3.2.1.3.1.cmml">∈</mo><msup id="S3.E2.m1.5.5.1.3.2.1.3.3" xref="S3.E2.m1.5.5.1.3.2.1.3.3.cmml"><mi id="S3.E2.m1.5.5.1.3.2.1.3.3.2" xref="S3.E2.m1.5.5.1.3.2.1.3.3.2.cmml">ℝ</mi><mi id="S3.E2.m1.5.5.1.3.2.1.3.3.3" xref="S3.E2.m1.5.5.1.3.2.1.3.3.3.cmml">d</mi></msup></mrow></munder><mo lspace="0.167em" id="S3.E2.m1.5.5.1.3.2a" xref="S3.E2.m1.5.5.1.3.2.cmml">⁡</mo><mstyle displaystyle="true" id="S3.E2.m1.5.5.1.3.2.2" xref="S3.E2.m1.5.5.1.3.2.2.cmml"><mfrac id="S3.E2.m1.5.5.1.3.2.2a" xref="S3.E2.m1.5.5.1.3.2.2.cmml"><mn id="S3.E2.m1.5.5.1.3.2.2.2" xref="S3.E2.m1.5.5.1.3.2.2.2.cmml">1</mn><mi id="S3.E2.m1.5.5.1.3.2.2.3" xref="S3.E2.m1.5.5.1.3.2.2.3.cmml">N</mi></mfrac></mstyle></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.1.2" xref="S3.E2.m1.5.5.1.2.cmml">​</mo><mrow id="S3.E2.m1.5.5.1.1" xref="S3.E2.m1.5.5.1.1.cmml"><mstyle displaystyle="true" id="S3.E2.m1.5.5.1.1.2" xref="S3.E2.m1.5.5.1.1.2.cmml"><munderover id="S3.E2.m1.5.5.1.1.2a" xref="S3.E2.m1.5.5.1.1.2.cmml"><mo movablelimits="false" id="S3.E2.m1.5.5.1.1.2.2.2" xref="S3.E2.m1.5.5.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E2.m1.5.5.1.1.2.2.3" xref="S3.E2.m1.5.5.1.1.2.2.3.cmml"><mi id="S3.E2.m1.5.5.1.1.2.2.3.2" xref="S3.E2.m1.5.5.1.1.2.2.3.2.cmml">n</mi><mo id="S3.E2.m1.5.5.1.1.2.2.3.1" xref="S3.E2.m1.5.5.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E2.m1.5.5.1.1.2.2.3.3" xref="S3.E2.m1.5.5.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.5.5.1.1.2.3" xref="S3.E2.m1.5.5.1.1.2.3.cmml">N</mi></munderover></mstyle><mrow id="S3.E2.m1.5.5.1.1.1" xref="S3.E2.m1.5.5.1.1.1.cmml"><msub id="S3.E2.m1.5.5.1.1.1.3" xref="S3.E2.m1.5.5.1.1.1.3.cmml"><mi id="S3.E2.m1.5.5.1.1.1.3.2" xref="S3.E2.m1.5.5.1.1.1.3.2.cmml">𝔼</mi><mrow id="S3.E2.m1.2.2.2" xref="S3.E2.m1.2.2.2.cmml"><mrow id="S3.E2.m1.2.2.2.4.2" xref="S3.E2.m1.2.2.2.4.1.cmml"><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">𝐱</mi><mo id="S3.E2.m1.2.2.2.4.2.1" xref="S3.E2.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml">y</mi></mrow><mo id="S3.E2.m1.2.2.2.3" xref="S3.E2.m1.2.2.2.3.cmml">∼</mo><msub id="S3.E2.m1.2.2.2.5" xref="S3.E2.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.2.2.5.2" xref="S3.E2.m1.2.2.2.5.2.cmml">𝒟</mi><mi id="S3.E2.m1.2.2.2.5.3" xref="S3.E2.m1.2.2.2.5.3.cmml">n</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.5.5.1.1.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.E2.m1.5.5.1.1.1.1.1.1.4" xref="S3.E2.m1.5.5.1.1.1.1.1.1.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.1.1.1.1.1.1.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.3.cmml">(</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">𝒯</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">𝐩</mi><mo stretchy="false" id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.4" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.3.cmml">;</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2.cmml">ℐ</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.1.cmml">​</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.3.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.cmml"><mo stretchy="false" id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.3.2.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.cmml">(</mo><mi id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml">𝐱</mi><mo stretchy="false" id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.3.2.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.5" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E2.m1.5.5.1.1.1.1.1.3" xref="S3.E2.m1.5.5.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.5b"><apply id="S3.E2.m1.5.5.cmml" xref="S3.E2.m1.5.5"><eq id="S3.E2.m1.5.5.2.cmml" xref="S3.E2.m1.5.5.2"></eq><apply id="S3.E2.m1.5.5.3.cmml" xref="S3.E2.m1.5.5.3"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.3.1.cmml" xref="S3.E2.m1.5.5.3">subscript</csymbol><ci id="S3.E2.m1.5.5.3.2.cmml" xref="S3.E2.m1.5.5.3.2">𝐩</ci><ci id="S3.E2.m1.5.5.3.3.cmml" xref="S3.E2.m1.5.5.3.3">𝑔</ci></apply><apply id="S3.E2.m1.5.5.1.cmml" xref="S3.E2.m1.5.5.1"><times id="S3.E2.m1.5.5.1.2.cmml" xref="S3.E2.m1.5.5.1.2"></times><apply id="S3.E2.m1.5.5.1.3.cmml" xref="S3.E2.m1.5.5.1.3"><arg id="S3.E2.m1.5.5.1.3.1.cmml" xref="S3.E2.m1.5.5.1.3.1"></arg><apply id="S3.E2.m1.5.5.1.3.2.cmml" xref="S3.E2.m1.5.5.1.3.2"><apply id="S3.E2.m1.5.5.1.3.2.1.cmml" xref="S3.E2.m1.5.5.1.3.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.3.2.1.1.cmml" xref="S3.E2.m1.5.5.1.3.2.1">subscript</csymbol><min id="S3.E2.m1.5.5.1.3.2.1.2.cmml" xref="S3.E2.m1.5.5.1.3.2.1.2"></min><apply id="S3.E2.m1.5.5.1.3.2.1.3.cmml" xref="S3.E2.m1.5.5.1.3.2.1.3"><in id="S3.E2.m1.5.5.1.3.2.1.3.1.cmml" xref="S3.E2.m1.5.5.1.3.2.1.3.1"></in><ci id="S3.E2.m1.5.5.1.3.2.1.3.2.cmml" xref="S3.E2.m1.5.5.1.3.2.1.3.2">𝐩</ci><apply id="S3.E2.m1.5.5.1.3.2.1.3.3.cmml" xref="S3.E2.m1.5.5.1.3.2.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.3.2.1.3.3.1.cmml" xref="S3.E2.m1.5.5.1.3.2.1.3.3">superscript</csymbol><ci id="S3.E2.m1.5.5.1.3.2.1.3.3.2.cmml" xref="S3.E2.m1.5.5.1.3.2.1.3.3.2">ℝ</ci><ci id="S3.E2.m1.5.5.1.3.2.1.3.3.3.cmml" xref="S3.E2.m1.5.5.1.3.2.1.3.3.3">𝑑</ci></apply></apply></apply><apply id="S3.E2.m1.5.5.1.3.2.2.cmml" xref="S3.E2.m1.5.5.1.3.2.2"><divide id="S3.E2.m1.5.5.1.3.2.2.1.cmml" xref="S3.E2.m1.5.5.1.3.2.2"></divide><cn type="integer" id="S3.E2.m1.5.5.1.3.2.2.2.cmml" xref="S3.E2.m1.5.5.1.3.2.2.2">1</cn><ci id="S3.E2.m1.5.5.1.3.2.2.3.cmml" xref="S3.E2.m1.5.5.1.3.2.2.3">𝑁</ci></apply></apply></apply><apply id="S3.E2.m1.5.5.1.1.cmml" xref="S3.E2.m1.5.5.1.1"><apply id="S3.E2.m1.5.5.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.2.1.cmml" xref="S3.E2.m1.5.5.1.1.2">superscript</csymbol><apply id="S3.E2.m1.5.5.1.1.2.2.cmml" xref="S3.E2.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.2.2.1.cmml" xref="S3.E2.m1.5.5.1.1.2">subscript</csymbol><sum id="S3.E2.m1.5.5.1.1.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2.2"></sum><apply id="S3.E2.m1.5.5.1.1.2.2.3.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3"><eq id="S3.E2.m1.5.5.1.1.2.2.3.1.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3.1"></eq><ci id="S3.E2.m1.5.5.1.1.2.2.3.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3.2">𝑛</ci><cn type="integer" id="S3.E2.m1.5.5.1.1.2.2.3.3.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.5.5.1.1.2.3.cmml" xref="S3.E2.m1.5.5.1.1.2.3">𝑁</ci></apply><apply id="S3.E2.m1.5.5.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1"><times id="S3.E2.m1.5.5.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.2"></times><apply id="S3.E2.m1.5.5.1.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.3.1.cmml" xref="S3.E2.m1.5.5.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.1.3.2.cmml" xref="S3.E2.m1.5.5.1.1.1.3.2">𝔼</ci><apply id="S3.E2.m1.2.2.2.cmml" xref="S3.E2.m1.2.2.2"><csymbol cd="latexml" id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.3">similar-to</csymbol><list id="S3.E2.m1.2.2.2.4.1.cmml" xref="S3.E2.m1.2.2.2.4.2"><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝐱</ci><ci id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2">𝑦</ci></list><apply id="S3.E2.m1.2.2.2.5.cmml" xref="S3.E2.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.5.1.cmml" xref="S3.E2.m1.2.2.2.5">subscript</csymbol><ci id="S3.E2.m1.2.2.2.5.2.cmml" xref="S3.E2.m1.2.2.2.5.2">𝒟</ci><ci id="S3.E2.m1.2.2.2.5.3.cmml" xref="S3.E2.m1.2.2.2.5.3">𝑛</ci></apply></apply></apply><apply id="S3.E2.m1.5.5.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.5.5.1.1.1.1.2.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1"><times id="S3.E2.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3"></times><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.4.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.4">ℓ</ci><list id="S3.E2.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2"><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1"><times id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1"></times><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2">𝒯</ci><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">𝐩</ci></apply><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2"><times id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.1"></times><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2">ℐ</ci><ci id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4">𝐱</ci></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.5c">\displaystyle\mathbf{p}_{g}=\arg\min_{\mathbf{p}\in\mathbb{R}^{d}}\frac{1}{N}\sum_{n=1}^{N}\mathbb{E}_{\mathbf{x},y\sim\mathcal{D}_{n}}[\ell(\mathcal{T}(\mathbf{p});\mathcal{I}(\mathbf{x}))]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.9" class="ltx_p">where <math id="S3.SS3.p1.8.m1.1" class="ltx_Math" alttext="\ell" display="inline"><semantics id="S3.SS3.p1.8.m1.1a"><mi mathvariant="normal" id="S3.SS3.p1.8.m1.1.1" xref="S3.SS3.p1.8.m1.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m1.1b"><ci id="S3.SS3.p1.8.m1.1.1.cmml" xref="S3.SS3.p1.8.m1.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m1.1c">\ell</annotation></semantics></math> is the loss of the <math id="S3.SS3.p1.9.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS3.p1.9.m2.1a"><mi id="S3.SS3.p1.9.m2.1.1" xref="S3.SS3.p1.9.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m2.1b"><ci id="S3.SS3.p1.9.m2.1.1.cmml" xref="S3.SS3.p1.9.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m2.1c">n</annotation></semantics></math>-th client. Although this approach can handle scenarios where multiple clients are IID, it is still difficult for a single global prompt to process clients from diverse data domains.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Method</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">The overview of the proposed FedAPT is in Figure <a href="#S3.F2" title="Figure 2 ‣ 3.2 Prompt Tuning ‣ 3 Preliminaries ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. We focus on the problem setting of one-model-fits-all, that is, learning a powerful global model to adapt to the data distribution across all domains. With the parameters of the CLIP frozen, we introduce an additional adaptive prompt tuning (APT) module for the global model. APT accepts image features as input and outputs a specific prompt for each sample. The learnable parts of APT are the prompt and the adaptive network, which are obtained through the federated training of multiple clients.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Adaptive Prompt Tuning</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.4" class="ltx_p">The input of the text encoder in PromptFL always uses a fixed prompt for all samples: <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{p}_{g}\in\mathbb{R}^{C\times s\times d}" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><msub id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2.2" xref="S4.SS1.p1.1.m1.1.1.2.2.cmml">𝐩</mi><mi id="S4.SS1.p1.1.m1.1.1.2.3" xref="S4.SS1.p1.1.m1.1.1.2.3.cmml">g</mi></msub><mo id="S4.SS1.p1.1.m1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml"><mi id="S4.SS1.p1.1.m1.1.1.3.2" xref="S4.SS1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p1.1.m1.1.1.3.3" xref="S4.SS1.p1.1.m1.1.1.3.3.cmml"><mi id="S4.SS1.p1.1.m1.1.1.3.3.2" xref="S4.SS1.p1.1.m1.1.1.3.3.2.cmml">C</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.1.m1.1.1.3.3.1" xref="S4.SS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p1.1.m1.1.1.3.3.3" xref="S4.SS1.p1.1.m1.1.1.3.3.3.cmml">s</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.1.m1.1.1.3.3.1a" xref="S4.SS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p1.1.m1.1.1.3.3.4" xref="S4.SS1.p1.1.m1.1.1.3.3.4.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><in id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1"></in><apply id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.2.1.cmml" xref="S4.SS1.p1.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.2.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2.2">𝐩</ci><ci id="S4.SS1.p1.1.m1.1.1.2.3.cmml" xref="S4.SS1.p1.1.m1.1.1.2.3">𝑔</ci></apply><apply id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.3.1.cmml" xref="S4.SS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.3.2.cmml" xref="S4.SS1.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S4.SS1.p1.1.m1.1.1.3.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3.3"><times id="S4.SS1.p1.1.m1.1.1.3.3.1.cmml" xref="S4.SS1.p1.1.m1.1.1.3.3.1"></times><ci id="S4.SS1.p1.1.m1.1.1.3.3.2.cmml" xref="S4.SS1.p1.1.m1.1.1.3.3.2">𝐶</ci><ci id="S4.SS1.p1.1.m1.1.1.3.3.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3.3.3">𝑠</ci><ci id="S4.SS1.p1.1.m1.1.1.3.3.4.cmml" xref="S4.SS1.p1.1.m1.1.1.3.3.4">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\mathbf{p}_{g}\in\mathbb{R}^{C\times s\times d}</annotation></semantics></math>, which is the learned prompt by federated averaging, <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">C</annotation></semantics></math> is the number of classes, <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mi id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">s</annotation></semantics></math> is the length of prompt, <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><mi id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><ci id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">d</annotation></semantics></math> is the embedding dimension. However, under the setting in this paper, each client may come from a specific domain, and there are obvious domain divergences among the images. A fixed prompt is no longer suitable for images in all domains. It is necessary to design a new form. An intuitive way is to introduce personalized prompts into the input of the text encoder for each domain:</p>
<table id="A2.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E3.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{p}_{g}+\mathbf{p}_{p_{k}}" display="inline"><semantics id="S4.E3.m1.1a"><mrow id="S4.E3.m1.1.1" xref="S4.E3.m1.1.1.cmml"><msub id="S4.E3.m1.1.1.2" xref="S4.E3.m1.1.1.2.cmml"><mi id="S4.E3.m1.1.1.2.2" xref="S4.E3.m1.1.1.2.2.cmml">𝐩</mi><mi id="S4.E3.m1.1.1.2.3" xref="S4.E3.m1.1.1.2.3.cmml">g</mi></msub><mo id="S4.E3.m1.1.1.1" xref="S4.E3.m1.1.1.1.cmml">+</mo><msub id="S4.E3.m1.1.1.3" xref="S4.E3.m1.1.1.3.cmml"><mi id="S4.E3.m1.1.1.3.2" xref="S4.E3.m1.1.1.3.2.cmml">𝐩</mi><msub id="S4.E3.m1.1.1.3.3" xref="S4.E3.m1.1.1.3.3.cmml"><mi id="S4.E3.m1.1.1.3.3.2" xref="S4.E3.m1.1.1.3.3.2.cmml">p</mi><mi id="S4.E3.m1.1.1.3.3.3" xref="S4.E3.m1.1.1.3.3.3.cmml">k</mi></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.1b"><apply id="S4.E3.m1.1.1.cmml" xref="S4.E3.m1.1.1"><plus id="S4.E3.m1.1.1.1.cmml" xref="S4.E3.m1.1.1.1"></plus><apply id="S4.E3.m1.1.1.2.cmml" xref="S4.E3.m1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.2.1.cmml" xref="S4.E3.m1.1.1.2">subscript</csymbol><ci id="S4.E3.m1.1.1.2.2.cmml" xref="S4.E3.m1.1.1.2.2">𝐩</ci><ci id="S4.E3.m1.1.1.2.3.cmml" xref="S4.E3.m1.1.1.2.3">𝑔</ci></apply><apply id="S4.E3.m1.1.1.3.cmml" xref="S4.E3.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.3">subscript</csymbol><ci id="S4.E3.m1.1.1.3.2.cmml" xref="S4.E3.m1.1.1.3.2">𝐩</ci><apply id="S4.E3.m1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.3.3.1.cmml" xref="S4.E3.m1.1.1.3.3">subscript</csymbol><ci id="S4.E3.m1.1.1.3.3.2.cmml" xref="S4.E3.m1.1.1.3.3.2">𝑝</ci><ci id="S4.E3.m1.1.1.3.3.3.cmml" xref="S4.E3.m1.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.1c">\displaystyle\mathbf{p}_{g}+\mathbf{p}_{p_{k}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p1.8" class="ltx_p">where <math id="S4.SS1.p1.5.m1.1" class="ltx_Math" alttext="\mathbf{p}_{p_{k}}" display="inline"><semantics id="S4.SS1.p1.5.m1.1a"><msub id="S4.SS1.p1.5.m1.1.1" xref="S4.SS1.p1.5.m1.1.1.cmml"><mi id="S4.SS1.p1.5.m1.1.1.2" xref="S4.SS1.p1.5.m1.1.1.2.cmml">𝐩</mi><msub id="S4.SS1.p1.5.m1.1.1.3" xref="S4.SS1.p1.5.m1.1.1.3.cmml"><mi id="S4.SS1.p1.5.m1.1.1.3.2" xref="S4.SS1.p1.5.m1.1.1.3.2.cmml">p</mi><mi id="S4.SS1.p1.5.m1.1.1.3.3" xref="S4.SS1.p1.5.m1.1.1.3.3.cmml">k</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m1.1b"><apply id="S4.SS1.p1.5.m1.1.1.cmml" xref="S4.SS1.p1.5.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m1.1.1.1.cmml" xref="S4.SS1.p1.5.m1.1.1">subscript</csymbol><ci id="S4.SS1.p1.5.m1.1.1.2.cmml" xref="S4.SS1.p1.5.m1.1.1.2">𝐩</ci><apply id="S4.SS1.p1.5.m1.1.1.3.cmml" xref="S4.SS1.p1.5.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m1.1.1.3.1.cmml" xref="S4.SS1.p1.5.m1.1.1.3">subscript</csymbol><ci id="S4.SS1.p1.5.m1.1.1.3.2.cmml" xref="S4.SS1.p1.5.m1.1.1.3.2">𝑝</ci><ci id="S4.SS1.p1.5.m1.1.1.3.3.cmml" xref="S4.SS1.p1.5.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m1.1c">\mathbf{p}_{p_{k}}</annotation></semantics></math> encodes the personalized domain knowledge of the <math id="S4.SS1.p1.6.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.p1.6.m2.1a"><mi id="S4.SS1.p1.6.m2.1.1" xref="S4.SS1.p1.6.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m2.1b"><ci id="S4.SS1.p1.6.m2.1.1.cmml" xref="S4.SS1.p1.6.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m2.1c">k</annotation></semantics></math>-th domain. Unfortunately, under the goal of one-model-fits-all, we need a unified global model, rather than adding personalized parameters <math id="S4.SS1.p1.7.m3.1" class="ltx_Math" alttext="\mathbf{p}_{p_{k}}" display="inline"><semantics id="S4.SS1.p1.7.m3.1a"><msub id="S4.SS1.p1.7.m3.1.1" xref="S4.SS1.p1.7.m3.1.1.cmml"><mi id="S4.SS1.p1.7.m3.1.1.2" xref="S4.SS1.p1.7.m3.1.1.2.cmml">𝐩</mi><msub id="S4.SS1.p1.7.m3.1.1.3" xref="S4.SS1.p1.7.m3.1.1.3.cmml"><mi id="S4.SS1.p1.7.m3.1.1.3.2" xref="S4.SS1.p1.7.m3.1.1.3.2.cmml">p</mi><mi id="S4.SS1.p1.7.m3.1.1.3.3" xref="S4.SS1.p1.7.m3.1.1.3.3.cmml">k</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m3.1b"><apply id="S4.SS1.p1.7.m3.1.1.cmml" xref="S4.SS1.p1.7.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m3.1.1.1.cmml" xref="S4.SS1.p1.7.m3.1.1">subscript</csymbol><ci id="S4.SS1.p1.7.m3.1.1.2.cmml" xref="S4.SS1.p1.7.m3.1.1.2">𝐩</ci><apply id="S4.SS1.p1.7.m3.1.1.3.cmml" xref="S4.SS1.p1.7.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m3.1.1.3.1.cmml" xref="S4.SS1.p1.7.m3.1.1.3">subscript</csymbol><ci id="S4.SS1.p1.7.m3.1.1.3.2.cmml" xref="S4.SS1.p1.7.m3.1.1.3.2">𝑝</ci><ci id="S4.SS1.p1.7.m3.1.1.3.3.cmml" xref="S4.SS1.p1.7.m3.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m3.1c">\mathbf{p}_{p_{k}}</annotation></semantics></math> for each client. Then a compromise improvement for Eq. <a href="#S4.E3" title="In 4.1 Adaptive Prompt Tuning ‣ 4 Method ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> is to keep all <math id="S4.SS1.p1.8.m4.1" class="ltx_Math" alttext="\mathbf{p}_{p_{k}}" display="inline"><semantics id="S4.SS1.p1.8.m4.1a"><msub id="S4.SS1.p1.8.m4.1.1" xref="S4.SS1.p1.8.m4.1.1.cmml"><mi id="S4.SS1.p1.8.m4.1.1.2" xref="S4.SS1.p1.8.m4.1.1.2.cmml">𝐩</mi><msub id="S4.SS1.p1.8.m4.1.1.3" xref="S4.SS1.p1.8.m4.1.1.3.cmml"><mi id="S4.SS1.p1.8.m4.1.1.3.2" xref="S4.SS1.p1.8.m4.1.1.3.2.cmml">p</mi><mi id="S4.SS1.p1.8.m4.1.1.3.3" xref="S4.SS1.p1.8.m4.1.1.3.3.cmml">k</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m4.1b"><apply id="S4.SS1.p1.8.m4.1.1.cmml" xref="S4.SS1.p1.8.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m4.1.1.1.cmml" xref="S4.SS1.p1.8.m4.1.1">subscript</csymbol><ci id="S4.SS1.p1.8.m4.1.1.2.cmml" xref="S4.SS1.p1.8.m4.1.1.2">𝐩</ci><apply id="S4.SS1.p1.8.m4.1.1.3.cmml" xref="S4.SS1.p1.8.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m4.1.1.3.1.cmml" xref="S4.SS1.p1.8.m4.1.1.3">subscript</csymbol><ci id="S4.SS1.p1.8.m4.1.1.3.2.cmml" xref="S4.SS1.p1.8.m4.1.1.3.2">𝑝</ci><ci id="S4.SS1.p1.8.m4.1.1.3.3.cmml" xref="S4.SS1.p1.8.m4.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m4.1c">\mathbf{p}_{p_{k}}</annotation></semantics></math> in the global model, then filter prompts based on the image features:</p>
<table id="A2.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E4.m1.4" class="ltx_Math" alttext="\displaystyle\mathbf{p}_{g}+f([\mathbf{p}_{p_{1}},\cdots,\mathbf{p}_{p_{K}}],\mathcal{Q}(\mathcal{I}(\mathbf{x})))" display="inline"><semantics id="S4.E4.m1.4a"><mrow id="S4.E4.m1.4.4" xref="S4.E4.m1.4.4.cmml"><msub id="S4.E4.m1.4.4.4" xref="S4.E4.m1.4.4.4.cmml"><mi id="S4.E4.m1.4.4.4.2" xref="S4.E4.m1.4.4.4.2.cmml">𝐩</mi><mi id="S4.E4.m1.4.4.4.3" xref="S4.E4.m1.4.4.4.3.cmml">g</mi></msub><mo id="S4.E4.m1.4.4.3" xref="S4.E4.m1.4.4.3.cmml">+</mo><mrow id="S4.E4.m1.4.4.2" xref="S4.E4.m1.4.4.2.cmml"><mi id="S4.E4.m1.4.4.2.4" xref="S4.E4.m1.4.4.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.4.4.2.3" xref="S4.E4.m1.4.4.2.3.cmml">​</mo><mrow id="S4.E4.m1.4.4.2.2.2" xref="S4.E4.m1.4.4.2.2.3.cmml"><mo stretchy="false" id="S4.E4.m1.4.4.2.2.2.3" xref="S4.E4.m1.4.4.2.2.3.cmml">(</mo><mrow id="S4.E4.m1.3.3.1.1.1.1.2" xref="S4.E4.m1.3.3.1.1.1.1.3.cmml"><mo stretchy="false" id="S4.E4.m1.3.3.1.1.1.1.2.3" xref="S4.E4.m1.3.3.1.1.1.1.3.cmml">[</mo><msub id="S4.E4.m1.3.3.1.1.1.1.1.1" xref="S4.E4.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E4.m1.3.3.1.1.1.1.1.1.2" xref="S4.E4.m1.3.3.1.1.1.1.1.1.2.cmml">𝐩</mi><msub id="S4.E4.m1.3.3.1.1.1.1.1.1.3" xref="S4.E4.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S4.E4.m1.3.3.1.1.1.1.1.1.3.2" xref="S4.E4.m1.3.3.1.1.1.1.1.1.3.2.cmml">p</mi><mn id="S4.E4.m1.3.3.1.1.1.1.1.1.3.3" xref="S4.E4.m1.3.3.1.1.1.1.1.1.3.3.cmml">1</mn></msub></msub><mo id="S4.E4.m1.3.3.1.1.1.1.2.4" xref="S4.E4.m1.3.3.1.1.1.1.3.cmml">,</mo><mi mathvariant="normal" id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml">⋯</mi><mo id="S4.E4.m1.3.3.1.1.1.1.2.5" xref="S4.E4.m1.3.3.1.1.1.1.3.cmml">,</mo><msub id="S4.E4.m1.3.3.1.1.1.1.2.2" xref="S4.E4.m1.3.3.1.1.1.1.2.2.cmml"><mi id="S4.E4.m1.3.3.1.1.1.1.2.2.2" xref="S4.E4.m1.3.3.1.1.1.1.2.2.2.cmml">𝐩</mi><msub id="S4.E4.m1.3.3.1.1.1.1.2.2.3" xref="S4.E4.m1.3.3.1.1.1.1.2.2.3.cmml"><mi id="S4.E4.m1.3.3.1.1.1.1.2.2.3.2" xref="S4.E4.m1.3.3.1.1.1.1.2.2.3.2.cmml">p</mi><mi id="S4.E4.m1.3.3.1.1.1.1.2.2.3.3" xref="S4.E4.m1.3.3.1.1.1.1.2.2.3.3.cmml">K</mi></msub></msub><mo stretchy="false" id="S4.E4.m1.3.3.1.1.1.1.2.6" xref="S4.E4.m1.3.3.1.1.1.1.3.cmml">]</mo></mrow><mo id="S4.E4.m1.4.4.2.2.2.4" xref="S4.E4.m1.4.4.2.2.3.cmml">,</mo><mrow id="S4.E4.m1.4.4.2.2.2.2" xref="S4.E4.m1.4.4.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.4.4.2.2.2.2.3" xref="S4.E4.m1.4.4.2.2.2.2.3.cmml">𝒬</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.4.4.2.2.2.2.2" xref="S4.E4.m1.4.4.2.2.2.2.2.cmml">​</mo><mrow id="S4.E4.m1.4.4.2.2.2.2.1.1" xref="S4.E4.m1.4.4.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.4.4.2.2.2.2.1.1.2" xref="S4.E4.m1.4.4.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.4.4.2.2.2.2.1.1.1" xref="S4.E4.m1.4.4.2.2.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.4.4.2.2.2.2.1.1.1.2" xref="S4.E4.m1.4.4.2.2.2.2.1.1.1.2.cmml">ℐ</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.4.4.2.2.2.2.1.1.1.1" xref="S4.E4.m1.4.4.2.2.2.2.1.1.1.1.cmml">​</mo><mrow id="S4.E4.m1.4.4.2.2.2.2.1.1.1.3.2" xref="S4.E4.m1.4.4.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.4.4.2.2.2.2.1.1.1.3.2.1" xref="S4.E4.m1.4.4.2.2.2.2.1.1.1.cmml">(</mo><mi id="S4.E4.m1.2.2" xref="S4.E4.m1.2.2.cmml">𝐱</mi><mo stretchy="false" id="S4.E4.m1.4.4.2.2.2.2.1.1.1.3.2.2" xref="S4.E4.m1.4.4.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E4.m1.4.4.2.2.2.2.1.1.3" xref="S4.E4.m1.4.4.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E4.m1.4.4.2.2.2.5" xref="S4.E4.m1.4.4.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.4b"><apply id="S4.E4.m1.4.4.cmml" xref="S4.E4.m1.4.4"><plus id="S4.E4.m1.4.4.3.cmml" xref="S4.E4.m1.4.4.3"></plus><apply id="S4.E4.m1.4.4.4.cmml" xref="S4.E4.m1.4.4.4"><csymbol cd="ambiguous" id="S4.E4.m1.4.4.4.1.cmml" xref="S4.E4.m1.4.4.4">subscript</csymbol><ci id="S4.E4.m1.4.4.4.2.cmml" xref="S4.E4.m1.4.4.4.2">𝐩</ci><ci id="S4.E4.m1.4.4.4.3.cmml" xref="S4.E4.m1.4.4.4.3">𝑔</ci></apply><apply id="S4.E4.m1.4.4.2.cmml" xref="S4.E4.m1.4.4.2"><times id="S4.E4.m1.4.4.2.3.cmml" xref="S4.E4.m1.4.4.2.3"></times><ci id="S4.E4.m1.4.4.2.4.cmml" xref="S4.E4.m1.4.4.2.4">𝑓</ci><interval closure="open" id="S4.E4.m1.4.4.2.2.3.cmml" xref="S4.E4.m1.4.4.2.2.2"><list id="S4.E4.m1.3.3.1.1.1.1.3.cmml" xref="S4.E4.m1.3.3.1.1.1.1.2"><apply id="S4.E4.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E4.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.2">𝐩</ci><apply id="S4.E4.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E4.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.3.2">𝑝</ci><cn type="integer" id="S4.E4.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S4.E4.m1.1.1.cmml" xref="S4.E4.m1.1.1">⋯</ci><apply id="S4.E4.m1.3.3.1.1.1.1.2.2.cmml" xref="S4.E4.m1.3.3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.3.3.1.1.1.1.2.2.1.cmml" xref="S4.E4.m1.3.3.1.1.1.1.2.2">subscript</csymbol><ci id="S4.E4.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S4.E4.m1.3.3.1.1.1.1.2.2.2">𝐩</ci><apply id="S4.E4.m1.3.3.1.1.1.1.2.2.3.cmml" xref="S4.E4.m1.3.3.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E4.m1.3.3.1.1.1.1.2.2.3.1.cmml" xref="S4.E4.m1.3.3.1.1.1.1.2.2.3">subscript</csymbol><ci id="S4.E4.m1.3.3.1.1.1.1.2.2.3.2.cmml" xref="S4.E4.m1.3.3.1.1.1.1.2.2.3.2">𝑝</ci><ci id="S4.E4.m1.3.3.1.1.1.1.2.2.3.3.cmml" xref="S4.E4.m1.3.3.1.1.1.1.2.2.3.3">𝐾</ci></apply></apply></list><apply id="S4.E4.m1.4.4.2.2.2.2.cmml" xref="S4.E4.m1.4.4.2.2.2.2"><times id="S4.E4.m1.4.4.2.2.2.2.2.cmml" xref="S4.E4.m1.4.4.2.2.2.2.2"></times><ci id="S4.E4.m1.4.4.2.2.2.2.3.cmml" xref="S4.E4.m1.4.4.2.2.2.2.3">𝒬</ci><apply id="S4.E4.m1.4.4.2.2.2.2.1.1.1.cmml" xref="S4.E4.m1.4.4.2.2.2.2.1.1"><times id="S4.E4.m1.4.4.2.2.2.2.1.1.1.1.cmml" xref="S4.E4.m1.4.4.2.2.2.2.1.1.1.1"></times><ci id="S4.E4.m1.4.4.2.2.2.2.1.1.1.2.cmml" xref="S4.E4.m1.4.4.2.2.2.2.1.1.1.2">ℐ</ci><ci id="S4.E4.m1.2.2.cmml" xref="S4.E4.m1.2.2">𝐱</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.4c">\displaystyle\mathbf{p}_{g}+f([\mathbf{p}_{p_{1}},\cdots,\mathbf{p}_{p_{K}}],\mathcal{Q}(\mathcal{I}(\mathbf{x})))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p1.13" class="ltx_p">where <math id="S4.SS1.p1.9.m1.1" class="ltx_Math" alttext="\mathbf{p}_{p_{k}}" display="inline"><semantics id="S4.SS1.p1.9.m1.1a"><msub id="S4.SS1.p1.9.m1.1.1" xref="S4.SS1.p1.9.m1.1.1.cmml"><mi id="S4.SS1.p1.9.m1.1.1.2" xref="S4.SS1.p1.9.m1.1.1.2.cmml">𝐩</mi><msub id="S4.SS1.p1.9.m1.1.1.3" xref="S4.SS1.p1.9.m1.1.1.3.cmml"><mi id="S4.SS1.p1.9.m1.1.1.3.2" xref="S4.SS1.p1.9.m1.1.1.3.2.cmml">p</mi><mi id="S4.SS1.p1.9.m1.1.1.3.3" xref="S4.SS1.p1.9.m1.1.1.3.3.cmml">k</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m1.1b"><apply id="S4.SS1.p1.9.m1.1.1.cmml" xref="S4.SS1.p1.9.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m1.1.1.1.cmml" xref="S4.SS1.p1.9.m1.1.1">subscript</csymbol><ci id="S4.SS1.p1.9.m1.1.1.2.cmml" xref="S4.SS1.p1.9.m1.1.1.2">𝐩</ci><apply id="S4.SS1.p1.9.m1.1.1.3.cmml" xref="S4.SS1.p1.9.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m1.1.1.3.1.cmml" xref="S4.SS1.p1.9.m1.1.1.3">subscript</csymbol><ci id="S4.SS1.p1.9.m1.1.1.3.2.cmml" xref="S4.SS1.p1.9.m1.1.1.3.2">𝑝</ci><ci id="S4.SS1.p1.9.m1.1.1.3.3.cmml" xref="S4.SS1.p1.9.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m1.1c">\mathbf{p}_{p_{k}}</annotation></semantics></math> is the personalized prompt for the <math id="S4.SS1.p1.10.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.p1.10.m2.1a"><mi id="S4.SS1.p1.10.m2.1.1" xref="S4.SS1.p1.10.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m2.1b"><ci id="S4.SS1.p1.10.m2.1.1.cmml" xref="S4.SS1.p1.10.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.10.m2.1c">k</annotation></semantics></math>-th domain, <math id="S4.SS1.p1.11.m3.1" class="ltx_Math" alttext="f(\cdot)" display="inline"><semantics id="S4.SS1.p1.11.m3.1a"><mrow id="S4.SS1.p1.11.m3.1.2" xref="S4.SS1.p1.11.m3.1.2.cmml"><mi id="S4.SS1.p1.11.m3.1.2.2" xref="S4.SS1.p1.11.m3.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.11.m3.1.2.1" xref="S4.SS1.p1.11.m3.1.2.1.cmml">​</mo><mrow id="S4.SS1.p1.11.m3.1.2.3.2" xref="S4.SS1.p1.11.m3.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.11.m3.1.2.3.2.1" xref="S4.SS1.p1.11.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.p1.11.m3.1.1" xref="S4.SS1.p1.11.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.p1.11.m3.1.2.3.2.2" xref="S4.SS1.p1.11.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.11.m3.1b"><apply id="S4.SS1.p1.11.m3.1.2.cmml" xref="S4.SS1.p1.11.m3.1.2"><times id="S4.SS1.p1.11.m3.1.2.1.cmml" xref="S4.SS1.p1.11.m3.1.2.1"></times><ci id="S4.SS1.p1.11.m3.1.2.2.cmml" xref="S4.SS1.p1.11.m3.1.2.2">𝑓</ci><ci id="S4.SS1.p1.11.m3.1.1.cmml" xref="S4.SS1.p1.11.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.11.m3.1c">f(\cdot)</annotation></semantics></math> is a filter function, <math id="S4.SS1.p1.12.m4.1" class="ltx_Math" alttext="\mathcal{Q}" display="inline"><semantics id="S4.SS1.p1.12.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.12.m4.1.1" xref="S4.SS1.p1.12.m4.1.1.cmml">𝒬</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.12.m4.1b"><ci id="S4.SS1.p1.12.m4.1.1.cmml" xref="S4.SS1.p1.12.m4.1.1">𝒬</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.12.m4.1c">\mathcal{Q}</annotation></semantics></math> is an adaptive network that is used to provide auxiliary information for filtering. However, this operation needs to retain a number of <math id="S4.SS1.p1.13.m5.1" class="ltx_Math" alttext="\mathbf{p}_{p_{k}}" display="inline"><semantics id="S4.SS1.p1.13.m5.1a"><msub id="S4.SS1.p1.13.m5.1.1" xref="S4.SS1.p1.13.m5.1.1.cmml"><mi id="S4.SS1.p1.13.m5.1.1.2" xref="S4.SS1.p1.13.m5.1.1.2.cmml">𝐩</mi><msub id="S4.SS1.p1.13.m5.1.1.3" xref="S4.SS1.p1.13.m5.1.1.3.cmml"><mi id="S4.SS1.p1.13.m5.1.1.3.2" xref="S4.SS1.p1.13.m5.1.1.3.2.cmml">p</mi><mi id="S4.SS1.p1.13.m5.1.1.3.3" xref="S4.SS1.p1.13.m5.1.1.3.3.cmml">k</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.13.m5.1b"><apply id="S4.SS1.p1.13.m5.1.1.cmml" xref="S4.SS1.p1.13.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m5.1.1.1.cmml" xref="S4.SS1.p1.13.m5.1.1">subscript</csymbol><ci id="S4.SS1.p1.13.m5.1.1.2.cmml" xref="S4.SS1.p1.13.m5.1.1.2">𝐩</ci><apply id="S4.SS1.p1.13.m5.1.1.3.cmml" xref="S4.SS1.p1.13.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m5.1.1.3.1.cmml" xref="S4.SS1.p1.13.m5.1.1.3">subscript</csymbol><ci id="S4.SS1.p1.13.m5.1.1.3.2.cmml" xref="S4.SS1.p1.13.m5.1.1.3.2">𝑝</ci><ci id="S4.SS1.p1.13.m5.1.1.3.3.cmml" xref="S4.SS1.p1.13.m5.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.13.m5.1c">\mathbf{p}_{p_{k}}</annotation></semantics></math>, thus introducing additional parameters in the global model.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.5" class="ltx_p">Finally, we adopt an adaptive prompt tuning approach. Let <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">\mathcal{P}</annotation></semantics></math> denotes the output of the APT module, the input for this module is the image features <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{I}(\mathbf{x})" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mrow id="S4.SS1.p2.2.m2.1.2" xref="S4.SS1.p2.2.m2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.2.m2.1.2.2" xref="S4.SS1.p2.2.m2.1.2.2.cmml">ℐ</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.2.m2.1.2.1" xref="S4.SS1.p2.2.m2.1.2.1.cmml">​</mo><mrow id="S4.SS1.p2.2.m2.1.2.3.2" xref="S4.SS1.p2.2.m2.1.2.cmml"><mo stretchy="false" id="S4.SS1.p2.2.m2.1.2.3.2.1" xref="S4.SS1.p2.2.m2.1.2.cmml">(</mo><mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">𝐱</mi><mo stretchy="false" id="S4.SS1.p2.2.m2.1.2.3.2.2" xref="S4.SS1.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><apply id="S4.SS1.p2.2.m2.1.2.cmml" xref="S4.SS1.p2.2.m2.1.2"><times id="S4.SS1.p2.2.m2.1.2.1.cmml" xref="S4.SS1.p2.2.m2.1.2.1"></times><ci id="S4.SS1.p2.2.m2.1.2.2.cmml" xref="S4.SS1.p2.2.m2.1.2.2">ℐ</ci><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">\mathcal{I}(\mathbf{x})</annotation></semantics></math>.
We use the key vector <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="\mathbf{e}_{k}\in\mathbb{R}^{s\times d}" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><mrow id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml"><msub id="S4.SS1.p2.3.m3.1.1.2" xref="S4.SS1.p2.3.m3.1.1.2.cmml"><mi id="S4.SS1.p2.3.m3.1.1.2.2" xref="S4.SS1.p2.3.m3.1.1.2.2.cmml">𝐞</mi><mi id="S4.SS1.p2.3.m3.1.1.2.3" xref="S4.SS1.p2.3.m3.1.1.2.3.cmml">k</mi></msub><mo id="S4.SS1.p2.3.m3.1.1.1" xref="S4.SS1.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml"><mi id="S4.SS1.p2.3.m3.1.1.3.2" xref="S4.SS1.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p2.3.m3.1.1.3.3" xref="S4.SS1.p2.3.m3.1.1.3.3.cmml"><mi id="S4.SS1.p2.3.m3.1.1.3.3.2" xref="S4.SS1.p2.3.m3.1.1.3.3.2.cmml">s</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p2.3.m3.1.1.3.3.1" xref="S4.SS1.p2.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p2.3.m3.1.1.3.3.3" xref="S4.SS1.p2.3.m3.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"><in id="S4.SS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1.1"></in><apply id="S4.SS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.1.1.2.1.cmml" xref="S4.SS1.p2.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS1.p2.3.m3.1.1.2.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2.2">𝐞</ci><ci id="S4.SS1.p2.3.m3.1.1.2.3.cmml" xref="S4.SS1.p2.3.m3.1.1.2.3">𝑘</ci></apply><apply id="S4.SS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.1.1.3.1.cmml" xref="S4.SS1.p2.3.m3.1.1.3">superscript</csymbol><ci id="S4.SS1.p2.3.m3.1.1.3.2.cmml" xref="S4.SS1.p2.3.m3.1.1.3.2">ℝ</ci><apply id="S4.SS1.p2.3.m3.1.1.3.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3.3"><times id="S4.SS1.p2.3.m3.1.1.3.3.1.cmml" xref="S4.SS1.p2.3.m3.1.1.3.3.1"></times><ci id="S4.SS1.p2.3.m3.1.1.3.3.2.cmml" xref="S4.SS1.p2.3.m3.1.1.3.3.2">𝑠</ci><ci id="S4.SS1.p2.3.m3.1.1.3.3.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">\mathbf{e}_{k}\in\mathbb{R}^{s\times d}</annotation></semantics></math> to encode personalized domain knowledge into <math id="S4.SS1.p2.4.m4.1" class="ltx_Math" alttext="\mathbf{p}_{g}" display="inline"><semantics id="S4.SS1.p2.4.m4.1a"><msub id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml"><mi id="S4.SS1.p2.4.m4.1.1.2" xref="S4.SS1.p2.4.m4.1.1.2.cmml">𝐩</mi><mi id="S4.SS1.p2.4.m4.1.1.3" xref="S4.SS1.p2.4.m4.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><apply id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p2.4.m4.1.1.2.cmml" xref="S4.SS1.p2.4.m4.1.1.2">𝐩</ci><ci id="S4.SS1.p2.4.m4.1.1.3.cmml" xref="S4.SS1.p2.4.m4.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">\mathbf{p}_{g}</annotation></semantics></math>, and decode it when necessary. <math id="S4.SS1.p2.5.m5.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="S4.SS1.p2.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b"><ci id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">\mathcal{P}</annotation></semantics></math> in the global model is:</p>
<table id="A2.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E5.m1.2" class="ltx_Math" alttext="\displaystyle\mathcal{P}(\mathcal{I}(\mathbf{x}))=\mathbf{p}_{g}+\mathbf{p}_{g}\odot\sum_{k=1}^{K}q_{k}\mathbf{e}^{\prime}_{k}" display="inline"><semantics id="S4.E5.m1.2a"><mrow id="S4.E5.m1.2.2" xref="S4.E5.m1.2.2.cmml"><mrow id="S4.E5.m1.2.2.1" xref="S4.E5.m1.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.2.2.1.3" xref="S4.E5.m1.2.2.1.3.cmml">𝒫</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.2.2.1.2" xref="S4.E5.m1.2.2.1.2.cmml">​</mo><mrow id="S4.E5.m1.2.2.1.1.1" xref="S4.E5.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5.m1.2.2.1.1.1.2" xref="S4.E5.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.2.2.1.1.1.1" xref="S4.E5.m1.2.2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.2.2.1.1.1.1.2" xref="S4.E5.m1.2.2.1.1.1.1.2.cmml">ℐ</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.2.2.1.1.1.1.1" xref="S4.E5.m1.2.2.1.1.1.1.1.cmml">​</mo><mrow id="S4.E5.m1.2.2.1.1.1.1.3.2" xref="S4.E5.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5.m1.2.2.1.1.1.1.3.2.1" xref="S4.E5.m1.2.2.1.1.1.1.cmml">(</mo><mi id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S4.E5.m1.2.2.1.1.1.1.3.2.2" xref="S4.E5.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E5.m1.2.2.1.1.1.3" xref="S4.E5.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E5.m1.2.2.2" xref="S4.E5.m1.2.2.2.cmml">=</mo><mrow id="S4.E5.m1.2.2.3" xref="S4.E5.m1.2.2.3.cmml"><msub id="S4.E5.m1.2.2.3.2" xref="S4.E5.m1.2.2.3.2.cmml"><mi id="S4.E5.m1.2.2.3.2.2" xref="S4.E5.m1.2.2.3.2.2.cmml">𝐩</mi><mi id="S4.E5.m1.2.2.3.2.3" xref="S4.E5.m1.2.2.3.2.3.cmml">g</mi></msub><mo id="S4.E5.m1.2.2.3.1" xref="S4.E5.m1.2.2.3.1.cmml">+</mo><mrow id="S4.E5.m1.2.2.3.3" xref="S4.E5.m1.2.2.3.3.cmml"><msub id="S4.E5.m1.2.2.3.3.2" xref="S4.E5.m1.2.2.3.3.2.cmml"><mi id="S4.E5.m1.2.2.3.3.2.2" xref="S4.E5.m1.2.2.3.3.2.2.cmml">𝐩</mi><mi id="S4.E5.m1.2.2.3.3.2.3" xref="S4.E5.m1.2.2.3.3.2.3.cmml">g</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.E5.m1.2.2.3.3.1" xref="S4.E5.m1.2.2.3.3.1.cmml">⊙</mo><mrow id="S4.E5.m1.2.2.3.3.3" xref="S4.E5.m1.2.2.3.3.3.cmml"><mstyle displaystyle="true" id="S4.E5.m1.2.2.3.3.3.1" xref="S4.E5.m1.2.2.3.3.3.1.cmml"><munderover id="S4.E5.m1.2.2.3.3.3.1a" xref="S4.E5.m1.2.2.3.3.3.1.cmml"><mo movablelimits="false" id="S4.E5.m1.2.2.3.3.3.1.2.2" xref="S4.E5.m1.2.2.3.3.3.1.2.2.cmml">∑</mo><mrow id="S4.E5.m1.2.2.3.3.3.1.2.3" xref="S4.E5.m1.2.2.3.3.3.1.2.3.cmml"><mi id="S4.E5.m1.2.2.3.3.3.1.2.3.2" xref="S4.E5.m1.2.2.3.3.3.1.2.3.2.cmml">k</mi><mo id="S4.E5.m1.2.2.3.3.3.1.2.3.1" xref="S4.E5.m1.2.2.3.3.3.1.2.3.1.cmml">=</mo><mn id="S4.E5.m1.2.2.3.3.3.1.2.3.3" xref="S4.E5.m1.2.2.3.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E5.m1.2.2.3.3.3.1.3" xref="S4.E5.m1.2.2.3.3.3.1.3.cmml">K</mi></munderover></mstyle><mrow id="S4.E5.m1.2.2.3.3.3.2" xref="S4.E5.m1.2.2.3.3.3.2.cmml"><msub id="S4.E5.m1.2.2.3.3.3.2.2" xref="S4.E5.m1.2.2.3.3.3.2.2.cmml"><mi id="S4.E5.m1.2.2.3.3.3.2.2.2" xref="S4.E5.m1.2.2.3.3.3.2.2.2.cmml">q</mi><mi id="S4.E5.m1.2.2.3.3.3.2.2.3" xref="S4.E5.m1.2.2.3.3.3.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.2.2.3.3.3.2.1" xref="S4.E5.m1.2.2.3.3.3.2.1.cmml">​</mo><msubsup id="S4.E5.m1.2.2.3.3.3.2.3" xref="S4.E5.m1.2.2.3.3.3.2.3.cmml"><mi id="S4.E5.m1.2.2.3.3.3.2.3.2.2" xref="S4.E5.m1.2.2.3.3.3.2.3.2.2.cmml">𝐞</mi><mi id="S4.E5.m1.2.2.3.3.3.2.3.3" xref="S4.E5.m1.2.2.3.3.3.2.3.3.cmml">k</mi><mo id="S4.E5.m1.2.2.3.3.3.2.3.2.3" xref="S4.E5.m1.2.2.3.3.3.2.3.2.3.cmml">′</mo></msubsup></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.2b"><apply id="S4.E5.m1.2.2.cmml" xref="S4.E5.m1.2.2"><eq id="S4.E5.m1.2.2.2.cmml" xref="S4.E5.m1.2.2.2"></eq><apply id="S4.E5.m1.2.2.1.cmml" xref="S4.E5.m1.2.2.1"><times id="S4.E5.m1.2.2.1.2.cmml" xref="S4.E5.m1.2.2.1.2"></times><ci id="S4.E5.m1.2.2.1.3.cmml" xref="S4.E5.m1.2.2.1.3">𝒫</ci><apply id="S4.E5.m1.2.2.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.1"><times id="S4.E5.m1.2.2.1.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.1.1.1"></times><ci id="S4.E5.m1.2.2.1.1.1.1.2.cmml" xref="S4.E5.m1.2.2.1.1.1.1.2">ℐ</ci><ci id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1">𝐱</ci></apply></apply><apply id="S4.E5.m1.2.2.3.cmml" xref="S4.E5.m1.2.2.3"><plus id="S4.E5.m1.2.2.3.1.cmml" xref="S4.E5.m1.2.2.3.1"></plus><apply id="S4.E5.m1.2.2.3.2.cmml" xref="S4.E5.m1.2.2.3.2"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.3.2.1.cmml" xref="S4.E5.m1.2.2.3.2">subscript</csymbol><ci id="S4.E5.m1.2.2.3.2.2.cmml" xref="S4.E5.m1.2.2.3.2.2">𝐩</ci><ci id="S4.E5.m1.2.2.3.2.3.cmml" xref="S4.E5.m1.2.2.3.2.3">𝑔</ci></apply><apply id="S4.E5.m1.2.2.3.3.cmml" xref="S4.E5.m1.2.2.3.3"><csymbol cd="latexml" id="S4.E5.m1.2.2.3.3.1.cmml" xref="S4.E5.m1.2.2.3.3.1">direct-product</csymbol><apply id="S4.E5.m1.2.2.3.3.2.cmml" xref="S4.E5.m1.2.2.3.3.2"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.3.3.2.1.cmml" xref="S4.E5.m1.2.2.3.3.2">subscript</csymbol><ci id="S4.E5.m1.2.2.3.3.2.2.cmml" xref="S4.E5.m1.2.2.3.3.2.2">𝐩</ci><ci id="S4.E5.m1.2.2.3.3.2.3.cmml" xref="S4.E5.m1.2.2.3.3.2.3">𝑔</ci></apply><apply id="S4.E5.m1.2.2.3.3.3.cmml" xref="S4.E5.m1.2.2.3.3.3"><apply id="S4.E5.m1.2.2.3.3.3.1.cmml" xref="S4.E5.m1.2.2.3.3.3.1"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.3.3.3.1.1.cmml" xref="S4.E5.m1.2.2.3.3.3.1">superscript</csymbol><apply id="S4.E5.m1.2.2.3.3.3.1.2.cmml" xref="S4.E5.m1.2.2.3.3.3.1"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.3.3.3.1.2.1.cmml" xref="S4.E5.m1.2.2.3.3.3.1">subscript</csymbol><sum id="S4.E5.m1.2.2.3.3.3.1.2.2.cmml" xref="S4.E5.m1.2.2.3.3.3.1.2.2"></sum><apply id="S4.E5.m1.2.2.3.3.3.1.2.3.cmml" xref="S4.E5.m1.2.2.3.3.3.1.2.3"><eq id="S4.E5.m1.2.2.3.3.3.1.2.3.1.cmml" xref="S4.E5.m1.2.2.3.3.3.1.2.3.1"></eq><ci id="S4.E5.m1.2.2.3.3.3.1.2.3.2.cmml" xref="S4.E5.m1.2.2.3.3.3.1.2.3.2">𝑘</ci><cn type="integer" id="S4.E5.m1.2.2.3.3.3.1.2.3.3.cmml" xref="S4.E5.m1.2.2.3.3.3.1.2.3.3">1</cn></apply></apply><ci id="S4.E5.m1.2.2.3.3.3.1.3.cmml" xref="S4.E5.m1.2.2.3.3.3.1.3">𝐾</ci></apply><apply id="S4.E5.m1.2.2.3.3.3.2.cmml" xref="S4.E5.m1.2.2.3.3.3.2"><times id="S4.E5.m1.2.2.3.3.3.2.1.cmml" xref="S4.E5.m1.2.2.3.3.3.2.1"></times><apply id="S4.E5.m1.2.2.3.3.3.2.2.cmml" xref="S4.E5.m1.2.2.3.3.3.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.3.3.3.2.2.1.cmml" xref="S4.E5.m1.2.2.3.3.3.2.2">subscript</csymbol><ci id="S4.E5.m1.2.2.3.3.3.2.2.2.cmml" xref="S4.E5.m1.2.2.3.3.3.2.2.2">𝑞</ci><ci id="S4.E5.m1.2.2.3.3.3.2.2.3.cmml" xref="S4.E5.m1.2.2.3.3.3.2.2.3">𝑘</ci></apply><apply id="S4.E5.m1.2.2.3.3.3.2.3.cmml" xref="S4.E5.m1.2.2.3.3.3.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.3.3.3.2.3.1.cmml" xref="S4.E5.m1.2.2.3.3.3.2.3">subscript</csymbol><apply id="S4.E5.m1.2.2.3.3.3.2.3.2.cmml" xref="S4.E5.m1.2.2.3.3.3.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.3.3.3.2.3.2.1.cmml" xref="S4.E5.m1.2.2.3.3.3.2.3">superscript</csymbol><ci id="S4.E5.m1.2.2.3.3.3.2.3.2.2.cmml" xref="S4.E5.m1.2.2.3.3.3.2.3.2.2">𝐞</ci><ci id="S4.E5.m1.2.2.3.3.3.2.3.2.3.cmml" xref="S4.E5.m1.2.2.3.3.3.2.3.2.3">′</ci></apply><ci id="S4.E5.m1.2.2.3.3.3.2.3.3.cmml" xref="S4.E5.m1.2.2.3.3.3.2.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.2c">\displaystyle\mathcal{P}(\mathcal{I}(\mathbf{x}))=\mathbf{p}_{g}+\mathbf{p}_{g}\odot\sum_{k=1}^{K}q_{k}\mathbf{e}^{\prime}_{k}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p2.17" class="ltx_p">where <math id="S4.SS1.p2.6.m1.2" class="ltx_Math" alttext="q_{k}=\mathcal{Q}_{g}(\mathcal{I}(\mathbf{x}))_{k}" display="inline"><semantics id="S4.SS1.p2.6.m1.2a"><mrow id="S4.SS1.p2.6.m1.2.2" xref="S4.SS1.p2.6.m1.2.2.cmml"><msub id="S4.SS1.p2.6.m1.2.2.3" xref="S4.SS1.p2.6.m1.2.2.3.cmml"><mi id="S4.SS1.p2.6.m1.2.2.3.2" xref="S4.SS1.p2.6.m1.2.2.3.2.cmml">q</mi><mi id="S4.SS1.p2.6.m1.2.2.3.3" xref="S4.SS1.p2.6.m1.2.2.3.3.cmml">k</mi></msub><mo id="S4.SS1.p2.6.m1.2.2.2" xref="S4.SS1.p2.6.m1.2.2.2.cmml">=</mo><mrow id="S4.SS1.p2.6.m1.2.2.1" xref="S4.SS1.p2.6.m1.2.2.1.cmml"><msub id="S4.SS1.p2.6.m1.2.2.1.3" xref="S4.SS1.p2.6.m1.2.2.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.6.m1.2.2.1.3.2" xref="S4.SS1.p2.6.m1.2.2.1.3.2.cmml">𝒬</mi><mi id="S4.SS1.p2.6.m1.2.2.1.3.3" xref="S4.SS1.p2.6.m1.2.2.1.3.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p2.6.m1.2.2.1.2" xref="S4.SS1.p2.6.m1.2.2.1.2.cmml">​</mo><msub id="S4.SS1.p2.6.m1.2.2.1.1" xref="S4.SS1.p2.6.m1.2.2.1.1.cmml"><mrow id="S4.SS1.p2.6.m1.2.2.1.1.1.1" xref="S4.SS1.p2.6.m1.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p2.6.m1.2.2.1.1.1.1.2" xref="S4.SS1.p2.6.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p2.6.m1.2.2.1.1.1.1.1" xref="S4.SS1.p2.6.m1.2.2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.6.m1.2.2.1.1.1.1.1.2" xref="S4.SS1.p2.6.m1.2.2.1.1.1.1.1.2.cmml">ℐ</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.6.m1.2.2.1.1.1.1.1.1" xref="S4.SS1.p2.6.m1.2.2.1.1.1.1.1.1.cmml">​</mo><mrow id="S4.SS1.p2.6.m1.2.2.1.1.1.1.1.3.2" xref="S4.SS1.p2.6.m1.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p2.6.m1.2.2.1.1.1.1.1.3.2.1" xref="S4.SS1.p2.6.m1.2.2.1.1.1.1.1.cmml">(</mo><mi id="S4.SS1.p2.6.m1.1.1" xref="S4.SS1.p2.6.m1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S4.SS1.p2.6.m1.2.2.1.1.1.1.1.3.2.2" xref="S4.SS1.p2.6.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.SS1.p2.6.m1.2.2.1.1.1.1.3" xref="S4.SS1.p2.6.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow><mi id="S4.SS1.p2.6.m1.2.2.1.1.3" xref="S4.SS1.p2.6.m1.2.2.1.1.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m1.2b"><apply id="S4.SS1.p2.6.m1.2.2.cmml" xref="S4.SS1.p2.6.m1.2.2"><eq id="S4.SS1.p2.6.m1.2.2.2.cmml" xref="S4.SS1.p2.6.m1.2.2.2"></eq><apply id="S4.SS1.p2.6.m1.2.2.3.cmml" xref="S4.SS1.p2.6.m1.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m1.2.2.3.1.cmml" xref="S4.SS1.p2.6.m1.2.2.3">subscript</csymbol><ci id="S4.SS1.p2.6.m1.2.2.3.2.cmml" xref="S4.SS1.p2.6.m1.2.2.3.2">𝑞</ci><ci id="S4.SS1.p2.6.m1.2.2.3.3.cmml" xref="S4.SS1.p2.6.m1.2.2.3.3">𝑘</ci></apply><apply id="S4.SS1.p2.6.m1.2.2.1.cmml" xref="S4.SS1.p2.6.m1.2.2.1"><times id="S4.SS1.p2.6.m1.2.2.1.2.cmml" xref="S4.SS1.p2.6.m1.2.2.1.2"></times><apply id="S4.SS1.p2.6.m1.2.2.1.3.cmml" xref="S4.SS1.p2.6.m1.2.2.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m1.2.2.1.3.1.cmml" xref="S4.SS1.p2.6.m1.2.2.1.3">subscript</csymbol><ci id="S4.SS1.p2.6.m1.2.2.1.3.2.cmml" xref="S4.SS1.p2.6.m1.2.2.1.3.2">𝒬</ci><ci id="S4.SS1.p2.6.m1.2.2.1.3.3.cmml" xref="S4.SS1.p2.6.m1.2.2.1.3.3">𝑔</ci></apply><apply id="S4.SS1.p2.6.m1.2.2.1.1.cmml" xref="S4.SS1.p2.6.m1.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m1.2.2.1.1.2.cmml" xref="S4.SS1.p2.6.m1.2.2.1.1">subscript</csymbol><apply id="S4.SS1.p2.6.m1.2.2.1.1.1.1.1.cmml" xref="S4.SS1.p2.6.m1.2.2.1.1.1.1"><times id="S4.SS1.p2.6.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.6.m1.2.2.1.1.1.1.1.1"></times><ci id="S4.SS1.p2.6.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.6.m1.2.2.1.1.1.1.1.2">ℐ</ci><ci id="S4.SS1.p2.6.m1.1.1.cmml" xref="S4.SS1.p2.6.m1.1.1">𝐱</ci></apply><ci id="S4.SS1.p2.6.m1.2.2.1.1.3.cmml" xref="S4.SS1.p2.6.m1.2.2.1.1.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m1.2c">q_{k}=\mathcal{Q}_{g}(\mathcal{I}(\mathbf{x}))_{k}</annotation></semantics></math>, <math id="S4.SS1.p2.7.m2.1" class="ltx_Math" alttext="\sum_{k}q_{k}=1" display="inline"><semantics id="S4.SS1.p2.7.m2.1a"><mrow id="S4.SS1.p2.7.m2.1.1" xref="S4.SS1.p2.7.m2.1.1.cmml"><mrow id="S4.SS1.p2.7.m2.1.1.2" xref="S4.SS1.p2.7.m2.1.1.2.cmml"><msub id="S4.SS1.p2.7.m2.1.1.2.1" xref="S4.SS1.p2.7.m2.1.1.2.1.cmml"><mo id="S4.SS1.p2.7.m2.1.1.2.1.2" xref="S4.SS1.p2.7.m2.1.1.2.1.2.cmml">∑</mo><mi id="S4.SS1.p2.7.m2.1.1.2.1.3" xref="S4.SS1.p2.7.m2.1.1.2.1.3.cmml">k</mi></msub><msub id="S4.SS1.p2.7.m2.1.1.2.2" xref="S4.SS1.p2.7.m2.1.1.2.2.cmml"><mi id="S4.SS1.p2.7.m2.1.1.2.2.2" xref="S4.SS1.p2.7.m2.1.1.2.2.2.cmml">q</mi><mi id="S4.SS1.p2.7.m2.1.1.2.2.3" xref="S4.SS1.p2.7.m2.1.1.2.2.3.cmml">k</mi></msub></mrow><mo id="S4.SS1.p2.7.m2.1.1.1" xref="S4.SS1.p2.7.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.7.m2.1.1.3" xref="S4.SS1.p2.7.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m2.1b"><apply id="S4.SS1.p2.7.m2.1.1.cmml" xref="S4.SS1.p2.7.m2.1.1"><eq id="S4.SS1.p2.7.m2.1.1.1.cmml" xref="S4.SS1.p2.7.m2.1.1.1"></eq><apply id="S4.SS1.p2.7.m2.1.1.2.cmml" xref="S4.SS1.p2.7.m2.1.1.2"><apply id="S4.SS1.p2.7.m2.1.1.2.1.cmml" xref="S4.SS1.p2.7.m2.1.1.2.1"><csymbol cd="ambiguous" id="S4.SS1.p2.7.m2.1.1.2.1.1.cmml" xref="S4.SS1.p2.7.m2.1.1.2.1">subscript</csymbol><sum id="S4.SS1.p2.7.m2.1.1.2.1.2.cmml" xref="S4.SS1.p2.7.m2.1.1.2.1.2"></sum><ci id="S4.SS1.p2.7.m2.1.1.2.1.3.cmml" xref="S4.SS1.p2.7.m2.1.1.2.1.3">𝑘</ci></apply><apply id="S4.SS1.p2.7.m2.1.1.2.2.cmml" xref="S4.SS1.p2.7.m2.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.7.m2.1.1.2.2.1.cmml" xref="S4.SS1.p2.7.m2.1.1.2.2">subscript</csymbol><ci id="S4.SS1.p2.7.m2.1.1.2.2.2.cmml" xref="S4.SS1.p2.7.m2.1.1.2.2.2">𝑞</ci><ci id="S4.SS1.p2.7.m2.1.1.2.2.3.cmml" xref="S4.SS1.p2.7.m2.1.1.2.2.3">𝑘</ci></apply></apply><cn type="integer" id="S4.SS1.p2.7.m2.1.1.3.cmml" xref="S4.SS1.p2.7.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.7.m2.1c">\sum_{k}q_{k}=1</annotation></semantics></math>, <math id="S4.SS1.p2.8.m3.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="S4.SS1.p2.8.m3.1a"><mo id="S4.SS1.p2.8.m3.1.1" xref="S4.SS1.p2.8.m3.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.8.m3.1b"><csymbol cd="latexml" id="S4.SS1.p2.8.m3.1.1.cmml" xref="S4.SS1.p2.8.m3.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.8.m3.1c">\odot</annotation></semantics></math> represents the element-wise multiplication, <math id="S4.SS1.p2.9.m4.1" class="ltx_Math" alttext="\mathbf{e}^{\prime}_{k}\in\mathbb{R}^{C\times s\times d}" display="inline"><semantics id="S4.SS1.p2.9.m4.1a"><mrow id="S4.SS1.p2.9.m4.1.1" xref="S4.SS1.p2.9.m4.1.1.cmml"><msubsup id="S4.SS1.p2.9.m4.1.1.2" xref="S4.SS1.p2.9.m4.1.1.2.cmml"><mi id="S4.SS1.p2.9.m4.1.1.2.2.2" xref="S4.SS1.p2.9.m4.1.1.2.2.2.cmml">𝐞</mi><mi id="S4.SS1.p2.9.m4.1.1.2.3" xref="S4.SS1.p2.9.m4.1.1.2.3.cmml">k</mi><mo id="S4.SS1.p2.9.m4.1.1.2.2.3" xref="S4.SS1.p2.9.m4.1.1.2.2.3.cmml">′</mo></msubsup><mo id="S4.SS1.p2.9.m4.1.1.1" xref="S4.SS1.p2.9.m4.1.1.1.cmml">∈</mo><msup id="S4.SS1.p2.9.m4.1.1.3" xref="S4.SS1.p2.9.m4.1.1.3.cmml"><mi id="S4.SS1.p2.9.m4.1.1.3.2" xref="S4.SS1.p2.9.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p2.9.m4.1.1.3.3" xref="S4.SS1.p2.9.m4.1.1.3.3.cmml"><mi id="S4.SS1.p2.9.m4.1.1.3.3.2" xref="S4.SS1.p2.9.m4.1.1.3.3.2.cmml">C</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p2.9.m4.1.1.3.3.1" xref="S4.SS1.p2.9.m4.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p2.9.m4.1.1.3.3.3" xref="S4.SS1.p2.9.m4.1.1.3.3.3.cmml">s</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p2.9.m4.1.1.3.3.1a" xref="S4.SS1.p2.9.m4.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p2.9.m4.1.1.3.3.4" xref="S4.SS1.p2.9.m4.1.1.3.3.4.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.9.m4.1b"><apply id="S4.SS1.p2.9.m4.1.1.cmml" xref="S4.SS1.p2.9.m4.1.1"><in id="S4.SS1.p2.9.m4.1.1.1.cmml" xref="S4.SS1.p2.9.m4.1.1.1"></in><apply id="S4.SS1.p2.9.m4.1.1.2.cmml" xref="S4.SS1.p2.9.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p2.9.m4.1.1.2.1.cmml" xref="S4.SS1.p2.9.m4.1.1.2">subscript</csymbol><apply id="S4.SS1.p2.9.m4.1.1.2.2.cmml" xref="S4.SS1.p2.9.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p2.9.m4.1.1.2.2.1.cmml" xref="S4.SS1.p2.9.m4.1.1.2">superscript</csymbol><ci id="S4.SS1.p2.9.m4.1.1.2.2.2.cmml" xref="S4.SS1.p2.9.m4.1.1.2.2.2">𝐞</ci><ci id="S4.SS1.p2.9.m4.1.1.2.2.3.cmml" xref="S4.SS1.p2.9.m4.1.1.2.2.3">′</ci></apply><ci id="S4.SS1.p2.9.m4.1.1.2.3.cmml" xref="S4.SS1.p2.9.m4.1.1.2.3">𝑘</ci></apply><apply id="S4.SS1.p2.9.m4.1.1.3.cmml" xref="S4.SS1.p2.9.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.9.m4.1.1.3.1.cmml" xref="S4.SS1.p2.9.m4.1.1.3">superscript</csymbol><ci id="S4.SS1.p2.9.m4.1.1.3.2.cmml" xref="S4.SS1.p2.9.m4.1.1.3.2">ℝ</ci><apply id="S4.SS1.p2.9.m4.1.1.3.3.cmml" xref="S4.SS1.p2.9.m4.1.1.3.3"><times id="S4.SS1.p2.9.m4.1.1.3.3.1.cmml" xref="S4.SS1.p2.9.m4.1.1.3.3.1"></times><ci id="S4.SS1.p2.9.m4.1.1.3.3.2.cmml" xref="S4.SS1.p2.9.m4.1.1.3.3.2">𝐶</ci><ci id="S4.SS1.p2.9.m4.1.1.3.3.3.cmml" xref="S4.SS1.p2.9.m4.1.1.3.3.3">𝑠</ci><ci id="S4.SS1.p2.9.m4.1.1.3.3.4.cmml" xref="S4.SS1.p2.9.m4.1.1.3.3.4">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.9.m4.1c">\mathbf{e}^{\prime}_{k}\in\mathbb{R}^{C\times s\times d}</annotation></semantics></math> is copied from <math id="S4.SS1.p2.10.m5.1" class="ltx_Math" alttext="\mathbf{e}_{k}" display="inline"><semantics id="S4.SS1.p2.10.m5.1a"><msub id="S4.SS1.p2.10.m5.1.1" xref="S4.SS1.p2.10.m5.1.1.cmml"><mi id="S4.SS1.p2.10.m5.1.1.2" xref="S4.SS1.p2.10.m5.1.1.2.cmml">𝐞</mi><mi id="S4.SS1.p2.10.m5.1.1.3" xref="S4.SS1.p2.10.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.10.m5.1b"><apply id="S4.SS1.p2.10.m5.1.1.cmml" xref="S4.SS1.p2.10.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.10.m5.1.1.1.cmml" xref="S4.SS1.p2.10.m5.1.1">subscript</csymbol><ci id="S4.SS1.p2.10.m5.1.1.2.cmml" xref="S4.SS1.p2.10.m5.1.1.2">𝐞</ci><ci id="S4.SS1.p2.10.m5.1.1.3.cmml" xref="S4.SS1.p2.10.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.10.m5.1c">\mathbf{e}_{k}</annotation></semantics></math> for <math id="S4.SS1.p2.11.m6.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS1.p2.11.m6.1a"><mi id="S4.SS1.p2.11.m6.1.1" xref="S4.SS1.p2.11.m6.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.11.m6.1b"><ci id="S4.SS1.p2.11.m6.1.1.cmml" xref="S4.SS1.p2.11.m6.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.11.m6.1c">C</annotation></semantics></math> times to match the dimension of <math id="S4.SS1.p2.12.m7.1" class="ltx_Math" alttext="\mathbf{p}_{g}" display="inline"><semantics id="S4.SS1.p2.12.m7.1a"><msub id="S4.SS1.p2.12.m7.1.1" xref="S4.SS1.p2.12.m7.1.1.cmml"><mi id="S4.SS1.p2.12.m7.1.1.2" xref="S4.SS1.p2.12.m7.1.1.2.cmml">𝐩</mi><mi id="S4.SS1.p2.12.m7.1.1.3" xref="S4.SS1.p2.12.m7.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.12.m7.1b"><apply id="S4.SS1.p2.12.m7.1.1.cmml" xref="S4.SS1.p2.12.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.12.m7.1.1.1.cmml" xref="S4.SS1.p2.12.m7.1.1">subscript</csymbol><ci id="S4.SS1.p2.12.m7.1.1.2.cmml" xref="S4.SS1.p2.12.m7.1.1.2">𝐩</ci><ci id="S4.SS1.p2.12.m7.1.1.3.cmml" xref="S4.SS1.p2.12.m7.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.12.m7.1c">\mathbf{p}_{g}</annotation></semantics></math>, and <math id="S4.SS1.p2.13.m8.1" class="ltx_Math" alttext="\mathcal{Q}_{g}" display="inline"><semantics id="S4.SS1.p2.13.m8.1a"><msub id="S4.SS1.p2.13.m8.1.1" xref="S4.SS1.p2.13.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.13.m8.1.1.2" xref="S4.SS1.p2.13.m8.1.1.2.cmml">𝒬</mi><mi id="S4.SS1.p2.13.m8.1.1.3" xref="S4.SS1.p2.13.m8.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.13.m8.1b"><apply id="S4.SS1.p2.13.m8.1.1.cmml" xref="S4.SS1.p2.13.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.13.m8.1.1.1.cmml" xref="S4.SS1.p2.13.m8.1.1">subscript</csymbol><ci id="S4.SS1.p2.13.m8.1.1.2.cmml" xref="S4.SS1.p2.13.m8.1.1.2">𝒬</ci><ci id="S4.SS1.p2.13.m8.1.1.3.cmml" xref="S4.SS1.p2.13.m8.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.13.m8.1c">\mathcal{Q}_{g}</annotation></semantics></math> is the adaptive network with parameters <math id="S4.SS1.p2.14.m9.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S4.SS1.p2.14.m9.1a"><mi id="S4.SS1.p2.14.m9.1.1" xref="S4.SS1.p2.14.m9.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.14.m9.1b"><ci id="S4.SS1.p2.14.m9.1.1.cmml" xref="S4.SS1.p2.14.m9.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.14.m9.1c">\phi</annotation></semantics></math>, which can give a one-hot or soft-membership vector of <math id="S4.SS1.p2.15.m10.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS1.p2.15.m10.1a"><mi id="S4.SS1.p2.15.m10.1.1" xref="S4.SS1.p2.15.m10.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.15.m10.1b"><ci id="S4.SS1.p2.15.m10.1.1.cmml" xref="S4.SS1.p2.15.m10.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.15.m10.1c">K</annotation></semantics></math> dimensions. In the <math id="S4.SS1.p2.16.m11.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS1.p2.16.m11.1a"><mi id="S4.SS1.p2.16.m11.1.1" xref="S4.SS1.p2.16.m11.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.16.m11.1b"><ci id="S4.SS1.p2.16.m11.1.1.cmml" xref="S4.SS1.p2.16.m11.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.16.m11.1c">n</annotation></semantics></math>-th client from the <math id="S4.SS1.p2.17.m12.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.p2.17.m12.1a"><mi id="S4.SS1.p2.17.m12.1.1" xref="S4.SS1.p2.17.m12.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.17.m12.1b"><ci id="S4.SS1.p2.17.m12.1.1.cmml" xref="S4.SS1.p2.17.m12.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.17.m12.1c">k</annotation></semantics></math>-th domain, the prompt for the text encoder in the training process is:</p>
<table id="A2.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E6.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{p}_{n}+\mathbf{p}_{n}\odot\mathbf{e}^{\prime}_{k}" display="inline"><semantics id="S4.E6.m1.1a"><mrow id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml"><msub id="S4.E6.m1.1.1.2" xref="S4.E6.m1.1.1.2.cmml"><mi id="S4.E6.m1.1.1.2.2" xref="S4.E6.m1.1.1.2.2.cmml">𝐩</mi><mi id="S4.E6.m1.1.1.2.3" xref="S4.E6.m1.1.1.2.3.cmml">n</mi></msub><mo id="S4.E6.m1.1.1.1" xref="S4.E6.m1.1.1.1.cmml">+</mo><mrow id="S4.E6.m1.1.1.3" xref="S4.E6.m1.1.1.3.cmml"><msub id="S4.E6.m1.1.1.3.2" xref="S4.E6.m1.1.1.3.2.cmml"><mi id="S4.E6.m1.1.1.3.2.2" xref="S4.E6.m1.1.1.3.2.2.cmml">𝐩</mi><mi id="S4.E6.m1.1.1.3.2.3" xref="S4.E6.m1.1.1.3.2.3.cmml">n</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.E6.m1.1.1.3.1" xref="S4.E6.m1.1.1.3.1.cmml">⊙</mo><msubsup id="S4.E6.m1.1.1.3.3" xref="S4.E6.m1.1.1.3.3.cmml"><mi id="S4.E6.m1.1.1.3.3.2.2" xref="S4.E6.m1.1.1.3.3.2.2.cmml">𝐞</mi><mi id="S4.E6.m1.1.1.3.3.3" xref="S4.E6.m1.1.1.3.3.3.cmml">k</mi><mo id="S4.E6.m1.1.1.3.3.2.3" xref="S4.E6.m1.1.1.3.3.2.3.cmml">′</mo></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.1b"><apply id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1"><plus id="S4.E6.m1.1.1.1.cmml" xref="S4.E6.m1.1.1.1"></plus><apply id="S4.E6.m1.1.1.2.cmml" xref="S4.E6.m1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.2.1.cmml" xref="S4.E6.m1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.1.1.2.2.cmml" xref="S4.E6.m1.1.1.2.2">𝐩</ci><ci id="S4.E6.m1.1.1.2.3.cmml" xref="S4.E6.m1.1.1.2.3">𝑛</ci></apply><apply id="S4.E6.m1.1.1.3.cmml" xref="S4.E6.m1.1.1.3"><csymbol cd="latexml" id="S4.E6.m1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.3.1">direct-product</csymbol><apply id="S4.E6.m1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.3.2.1.cmml" xref="S4.E6.m1.1.1.3.2">subscript</csymbol><ci id="S4.E6.m1.1.1.3.2.2.cmml" xref="S4.E6.m1.1.1.3.2.2">𝐩</ci><ci id="S4.E6.m1.1.1.3.2.3.cmml" xref="S4.E6.m1.1.1.3.2.3">𝑛</ci></apply><apply id="S4.E6.m1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.3.3.1.cmml" xref="S4.E6.m1.1.1.3.3">subscript</csymbol><apply id="S4.E6.m1.1.1.3.3.2.cmml" xref="S4.E6.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.3.3.2.1.cmml" xref="S4.E6.m1.1.1.3.3">superscript</csymbol><ci id="S4.E6.m1.1.1.3.3.2.2.cmml" xref="S4.E6.m1.1.1.3.3.2.2">𝐞</ci><ci id="S4.E6.m1.1.1.3.3.2.3.cmml" xref="S4.E6.m1.1.1.3.3.2.3">′</ci></apply><ci id="S4.E6.m1.1.1.3.3.3.cmml" xref="S4.E6.m1.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.1c">\displaystyle\mathbf{p}_{n}+\mathbf{p}_{n}\odot\mathbf{e}^{\prime}_{k}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p2.22" class="ltx_p">where <math id="S4.SS1.p2.18.m1.1" class="ltx_Math" alttext="\mathbf{p}_{n}" display="inline"><semantics id="S4.SS1.p2.18.m1.1a"><msub id="S4.SS1.p2.18.m1.1.1" xref="S4.SS1.p2.18.m1.1.1.cmml"><mi id="S4.SS1.p2.18.m1.1.1.2" xref="S4.SS1.p2.18.m1.1.1.2.cmml">𝐩</mi><mi id="S4.SS1.p2.18.m1.1.1.3" xref="S4.SS1.p2.18.m1.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.18.m1.1b"><apply id="S4.SS1.p2.18.m1.1.1.cmml" xref="S4.SS1.p2.18.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.18.m1.1.1.1.cmml" xref="S4.SS1.p2.18.m1.1.1">subscript</csymbol><ci id="S4.SS1.p2.18.m1.1.1.2.cmml" xref="S4.SS1.p2.18.m1.1.1.2">𝐩</ci><ci id="S4.SS1.p2.18.m1.1.1.3.cmml" xref="S4.SS1.p2.18.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.18.m1.1c">\mathbf{p}_{n}</annotation></semantics></math> is initialized by <math id="S4.SS1.p2.19.m2.1" class="ltx_Math" alttext="\mathbf{p}_{g}" display="inline"><semantics id="S4.SS1.p2.19.m2.1a"><msub id="S4.SS1.p2.19.m2.1.1" xref="S4.SS1.p2.19.m2.1.1.cmml"><mi id="S4.SS1.p2.19.m2.1.1.2" xref="S4.SS1.p2.19.m2.1.1.2.cmml">𝐩</mi><mi id="S4.SS1.p2.19.m2.1.1.3" xref="S4.SS1.p2.19.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.19.m2.1b"><apply id="S4.SS1.p2.19.m2.1.1.cmml" xref="S4.SS1.p2.19.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.19.m2.1.1.1.cmml" xref="S4.SS1.p2.19.m2.1.1">subscript</csymbol><ci id="S4.SS1.p2.19.m2.1.1.2.cmml" xref="S4.SS1.p2.19.m2.1.1.2">𝐩</ci><ci id="S4.SS1.p2.19.m2.1.1.3.cmml" xref="S4.SS1.p2.19.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.19.m2.1c">\mathbf{p}_{g}</annotation></semantics></math>, <math id="S4.SS1.p2.20.m3.1" class="ltx_Math" alttext="\mathbf{e}^{\prime}_{k}" display="inline"><semantics id="S4.SS1.p2.20.m3.1a"><msubsup id="S4.SS1.p2.20.m3.1.1" xref="S4.SS1.p2.20.m3.1.1.cmml"><mi id="S4.SS1.p2.20.m3.1.1.2.2" xref="S4.SS1.p2.20.m3.1.1.2.2.cmml">𝐞</mi><mi id="S4.SS1.p2.20.m3.1.1.3" xref="S4.SS1.p2.20.m3.1.1.3.cmml">k</mi><mo id="S4.SS1.p2.20.m3.1.1.2.3" xref="S4.SS1.p2.20.m3.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.20.m3.1b"><apply id="S4.SS1.p2.20.m3.1.1.cmml" xref="S4.SS1.p2.20.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.20.m3.1.1.1.cmml" xref="S4.SS1.p2.20.m3.1.1">subscript</csymbol><apply id="S4.SS1.p2.20.m3.1.1.2.cmml" xref="S4.SS1.p2.20.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.20.m3.1.1.2.1.cmml" xref="S4.SS1.p2.20.m3.1.1">superscript</csymbol><ci id="S4.SS1.p2.20.m3.1.1.2.2.cmml" xref="S4.SS1.p2.20.m3.1.1.2.2">𝐞</ci><ci id="S4.SS1.p2.20.m3.1.1.2.3.cmml" xref="S4.SS1.p2.20.m3.1.1.2.3">′</ci></apply><ci id="S4.SS1.p2.20.m3.1.1.3.cmml" xref="S4.SS1.p2.20.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.20.m3.1c">\mathbf{e}^{\prime}_{k}</annotation></semantics></math> is frozen. Through the design of Eqs.<a href="#S4.E5" title="In 4.1 Adaptive Prompt Tuning ‣ 4 Method ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> and <a href="#S4.E6" title="In 4.1 Adaptive Prompt Tuning ‣ 4 Method ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, we do not need to introduce additional learnable parameters <math id="S4.SS1.p2.21.m4.1" class="ltx_Math" alttext="\mathbf{p}_{p_{k}}" display="inline"><semantics id="S4.SS1.p2.21.m4.1a"><msub id="S4.SS1.p2.21.m4.1.1" xref="S4.SS1.p2.21.m4.1.1.cmml"><mi id="S4.SS1.p2.21.m4.1.1.2" xref="S4.SS1.p2.21.m4.1.1.2.cmml">𝐩</mi><msub id="S4.SS1.p2.21.m4.1.1.3" xref="S4.SS1.p2.21.m4.1.1.3.cmml"><mi id="S4.SS1.p2.21.m4.1.1.3.2" xref="S4.SS1.p2.21.m4.1.1.3.2.cmml">p</mi><mi id="S4.SS1.p2.21.m4.1.1.3.3" xref="S4.SS1.p2.21.m4.1.1.3.3.cmml">k</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.21.m4.1b"><apply id="S4.SS1.p2.21.m4.1.1.cmml" xref="S4.SS1.p2.21.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.21.m4.1.1.1.cmml" xref="S4.SS1.p2.21.m4.1.1">subscript</csymbol><ci id="S4.SS1.p2.21.m4.1.1.2.cmml" xref="S4.SS1.p2.21.m4.1.1.2">𝐩</ci><apply id="S4.SS1.p2.21.m4.1.1.3.cmml" xref="S4.SS1.p2.21.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.21.m4.1.1.3.1.cmml" xref="S4.SS1.p2.21.m4.1.1.3">subscript</csymbol><ci id="S4.SS1.p2.21.m4.1.1.3.2.cmml" xref="S4.SS1.p2.21.m4.1.1.3.2">𝑝</ci><ci id="S4.SS1.p2.21.m4.1.1.3.3.cmml" xref="S4.SS1.p2.21.m4.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.21.m4.1c">\mathbf{p}_{p_{k}}</annotation></semantics></math>, but use the unified <math id="S4.SS1.p2.22.m5.1" class="ltx_Math" alttext="\mathbf{p}_{g}" display="inline"><semantics id="S4.SS1.p2.22.m5.1a"><msub id="S4.SS1.p2.22.m5.1.1" xref="S4.SS1.p2.22.m5.1.1.cmml"><mi id="S4.SS1.p2.22.m5.1.1.2" xref="S4.SS1.p2.22.m5.1.1.2.cmml">𝐩</mi><mi id="S4.SS1.p2.22.m5.1.1.3" xref="S4.SS1.p2.22.m5.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.22.m5.1b"><apply id="S4.SS1.p2.22.m5.1.1.cmml" xref="S4.SS1.p2.22.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.22.m5.1.1.1.cmml" xref="S4.SS1.p2.22.m5.1.1">subscript</csymbol><ci id="S4.SS1.p2.22.m5.1.1.2.cmml" xref="S4.SS1.p2.22.m5.1.1.2">𝐩</ci><ci id="S4.SS1.p2.22.m5.1.1.3.cmml" xref="S4.SS1.p2.22.m5.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.22.m5.1c">\mathbf{p}_{g}</annotation></semantics></math>, which is named “meta prompt”. The objective for the meta prompt is:</p>
<table id="A2.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.Ex1.m1.2" class="ltx_Math" alttext="\displaystyle\mathbf{p}_{g}=\arg\min_{\mathbf{p}}\frac{1}{N}\sum_{n=1}^{N}\mathbb{E}_{\mathbf{x}\sim\mathcal{D}_{n}}[\ell(\mathcal{T}(\mathbf{p}+\mathbf{p}\odot\mathbf{e}^{\prime}_{n});\mathcal{I}(\mathbf{x}))]" display="inline"><semantics id="S4.Ex1.m1.2a"><mrow id="S4.Ex1.m1.2.2" xref="S4.Ex1.m1.2.2.cmml"><msub id="S4.Ex1.m1.2.2.3" xref="S4.Ex1.m1.2.2.3.cmml"><mi id="S4.Ex1.m1.2.2.3.2" xref="S4.Ex1.m1.2.2.3.2.cmml">𝐩</mi><mi id="S4.Ex1.m1.2.2.3.3" xref="S4.Ex1.m1.2.2.3.3.cmml">g</mi></msub><mo id="S4.Ex1.m1.2.2.2" xref="S4.Ex1.m1.2.2.2.cmml">=</mo><mrow id="S4.Ex1.m1.2.2.1" xref="S4.Ex1.m1.2.2.1.cmml"><mrow id="S4.Ex1.m1.2.2.1.3" xref="S4.Ex1.m1.2.2.1.3.cmml"><mi id="S4.Ex1.m1.2.2.1.3.1" xref="S4.Ex1.m1.2.2.1.3.1.cmml">arg</mi><mo lspace="0.167em" id="S4.Ex1.m1.2.2.1.3a" xref="S4.Ex1.m1.2.2.1.3.cmml">⁡</mo><mrow id="S4.Ex1.m1.2.2.1.3.2" xref="S4.Ex1.m1.2.2.1.3.2.cmml"><munder id="S4.Ex1.m1.2.2.1.3.2.1" xref="S4.Ex1.m1.2.2.1.3.2.1.cmml"><mi id="S4.Ex1.m1.2.2.1.3.2.1.2" xref="S4.Ex1.m1.2.2.1.3.2.1.2.cmml">min</mi><mi id="S4.Ex1.m1.2.2.1.3.2.1.3" xref="S4.Ex1.m1.2.2.1.3.2.1.3.cmml">𝐩</mi></munder><mo lspace="0.167em" id="S4.Ex1.m1.2.2.1.3.2a" xref="S4.Ex1.m1.2.2.1.3.2.cmml">⁡</mo><mstyle displaystyle="true" id="S4.Ex1.m1.2.2.1.3.2.2" xref="S4.Ex1.m1.2.2.1.3.2.2.cmml"><mfrac id="S4.Ex1.m1.2.2.1.3.2.2a" xref="S4.Ex1.m1.2.2.1.3.2.2.cmml"><mn id="S4.Ex1.m1.2.2.1.3.2.2.2" xref="S4.Ex1.m1.2.2.1.3.2.2.2.cmml">1</mn><mi id="S4.Ex1.m1.2.2.1.3.2.2.3" xref="S4.Ex1.m1.2.2.1.3.2.2.3.cmml">N</mi></mfrac></mstyle></mrow></mrow><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.2.2.1.2" xref="S4.Ex1.m1.2.2.1.2.cmml">​</mo><mrow id="S4.Ex1.m1.2.2.1.1" xref="S4.Ex1.m1.2.2.1.1.cmml"><mstyle displaystyle="true" id="S4.Ex1.m1.2.2.1.1.2" xref="S4.Ex1.m1.2.2.1.1.2.cmml"><munderover id="S4.Ex1.m1.2.2.1.1.2a" xref="S4.Ex1.m1.2.2.1.1.2.cmml"><mo movablelimits="false" id="S4.Ex1.m1.2.2.1.1.2.2.2" xref="S4.Ex1.m1.2.2.1.1.2.2.2.cmml">∑</mo><mrow id="S4.Ex1.m1.2.2.1.1.2.2.3" xref="S4.Ex1.m1.2.2.1.1.2.2.3.cmml"><mi id="S4.Ex1.m1.2.2.1.1.2.2.3.2" xref="S4.Ex1.m1.2.2.1.1.2.2.3.2.cmml">n</mi><mo id="S4.Ex1.m1.2.2.1.1.2.2.3.1" xref="S4.Ex1.m1.2.2.1.1.2.2.3.1.cmml">=</mo><mn id="S4.Ex1.m1.2.2.1.1.2.2.3.3" xref="S4.Ex1.m1.2.2.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex1.m1.2.2.1.1.2.3" xref="S4.Ex1.m1.2.2.1.1.2.3.cmml">N</mi></munderover></mstyle><mrow id="S4.Ex1.m1.2.2.1.1.1" xref="S4.Ex1.m1.2.2.1.1.1.cmml"><msub id="S4.Ex1.m1.2.2.1.1.1.3" xref="S4.Ex1.m1.2.2.1.1.1.3.cmml"><mi id="S4.Ex1.m1.2.2.1.1.1.3.2" xref="S4.Ex1.m1.2.2.1.1.1.3.2.cmml">𝔼</mi><mrow id="S4.Ex1.m1.2.2.1.1.1.3.3" xref="S4.Ex1.m1.2.2.1.1.1.3.3.cmml"><mi id="S4.Ex1.m1.2.2.1.1.1.3.3.2" xref="S4.Ex1.m1.2.2.1.1.1.3.3.2.cmml">𝐱</mi><mo id="S4.Ex1.m1.2.2.1.1.1.3.3.1" xref="S4.Ex1.m1.2.2.1.1.1.3.3.1.cmml">∼</mo><msub id="S4.Ex1.m1.2.2.1.1.1.3.3.3" xref="S4.Ex1.m1.2.2.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex1.m1.2.2.1.1.1.3.3.3.2" xref="S4.Ex1.m1.2.2.1.1.1.3.3.3.2.cmml">𝒟</mi><mi id="S4.Ex1.m1.2.2.1.1.1.3.3.3.3" xref="S4.Ex1.m1.2.2.1.1.1.3.3.3.3.cmml">n</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.2.2.1.1.1.2" xref="S4.Ex1.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S4.Ex1.m1.2.2.1.1.1.1.1" xref="S4.Ex1.m1.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.Ex1.m1.2.2.1.1.1.1.1.2" xref="S4.Ex1.m1.2.2.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.Ex1.m1.2.2.1.1.1.1.1.1" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S4.Ex1.m1.2.2.1.1.1.1.1.1.4" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.2.2.1.1.1.1.1.1.3" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.2" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.2.3" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.3.cmml">(</mo><mrow id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">𝒯</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐩</mi><mo id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐩</mi><mo lspace="0.222em" rspace="0.222em" id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">⊙</mo><msubsup id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml">𝐞</mi><mi id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">n</mi><mo id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml">′</mo></msubsup></mrow></mrow><mo stretchy="false" id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.2.4" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.3.cmml">;</mo><mrow id="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.2" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.2.cmml">ℐ</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.1" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.1.cmml">​</mo><mrow id="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.3.2" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.cmml"><mo stretchy="false" id="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.3.2.1" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.cmml">(</mo><mi id="S4.Ex1.m1.1.1" xref="S4.Ex1.m1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.3.2.2" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.2.5" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.Ex1.m1.2.2.1.1.1.1.1.3" xref="S4.Ex1.m1.2.2.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex1.m1.2b"><apply id="S4.Ex1.m1.2.2.cmml" xref="S4.Ex1.m1.2.2"><eq id="S4.Ex1.m1.2.2.2.cmml" xref="S4.Ex1.m1.2.2.2"></eq><apply id="S4.Ex1.m1.2.2.3.cmml" xref="S4.Ex1.m1.2.2.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.2.2.3.1.cmml" xref="S4.Ex1.m1.2.2.3">subscript</csymbol><ci id="S4.Ex1.m1.2.2.3.2.cmml" xref="S4.Ex1.m1.2.2.3.2">𝐩</ci><ci id="S4.Ex1.m1.2.2.3.3.cmml" xref="S4.Ex1.m1.2.2.3.3">𝑔</ci></apply><apply id="S4.Ex1.m1.2.2.1.cmml" xref="S4.Ex1.m1.2.2.1"><times id="S4.Ex1.m1.2.2.1.2.cmml" xref="S4.Ex1.m1.2.2.1.2"></times><apply id="S4.Ex1.m1.2.2.1.3.cmml" xref="S4.Ex1.m1.2.2.1.3"><arg id="S4.Ex1.m1.2.2.1.3.1.cmml" xref="S4.Ex1.m1.2.2.1.3.1"></arg><apply id="S4.Ex1.m1.2.2.1.3.2.cmml" xref="S4.Ex1.m1.2.2.1.3.2"><apply id="S4.Ex1.m1.2.2.1.3.2.1.cmml" xref="S4.Ex1.m1.2.2.1.3.2.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.2.2.1.3.2.1.1.cmml" xref="S4.Ex1.m1.2.2.1.3.2.1">subscript</csymbol><min id="S4.Ex1.m1.2.2.1.3.2.1.2.cmml" xref="S4.Ex1.m1.2.2.1.3.2.1.2"></min><ci id="S4.Ex1.m1.2.2.1.3.2.1.3.cmml" xref="S4.Ex1.m1.2.2.1.3.2.1.3">𝐩</ci></apply><apply id="S4.Ex1.m1.2.2.1.3.2.2.cmml" xref="S4.Ex1.m1.2.2.1.3.2.2"><divide id="S4.Ex1.m1.2.2.1.3.2.2.1.cmml" xref="S4.Ex1.m1.2.2.1.3.2.2"></divide><cn type="integer" id="S4.Ex1.m1.2.2.1.3.2.2.2.cmml" xref="S4.Ex1.m1.2.2.1.3.2.2.2">1</cn><ci id="S4.Ex1.m1.2.2.1.3.2.2.3.cmml" xref="S4.Ex1.m1.2.2.1.3.2.2.3">𝑁</ci></apply></apply></apply><apply id="S4.Ex1.m1.2.2.1.1.cmml" xref="S4.Ex1.m1.2.2.1.1"><apply id="S4.Ex1.m1.2.2.1.1.2.cmml" xref="S4.Ex1.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.2.2.1.1.2.1.cmml" xref="S4.Ex1.m1.2.2.1.1.2">superscript</csymbol><apply id="S4.Ex1.m1.2.2.1.1.2.2.cmml" xref="S4.Ex1.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.2.2.1.1.2.2.1.cmml" xref="S4.Ex1.m1.2.2.1.1.2">subscript</csymbol><sum id="S4.Ex1.m1.2.2.1.1.2.2.2.cmml" xref="S4.Ex1.m1.2.2.1.1.2.2.2"></sum><apply id="S4.Ex1.m1.2.2.1.1.2.2.3.cmml" xref="S4.Ex1.m1.2.2.1.1.2.2.3"><eq id="S4.Ex1.m1.2.2.1.1.2.2.3.1.cmml" xref="S4.Ex1.m1.2.2.1.1.2.2.3.1"></eq><ci id="S4.Ex1.m1.2.2.1.1.2.2.3.2.cmml" xref="S4.Ex1.m1.2.2.1.1.2.2.3.2">𝑛</ci><cn type="integer" id="S4.Ex1.m1.2.2.1.1.2.2.3.3.cmml" xref="S4.Ex1.m1.2.2.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.Ex1.m1.2.2.1.1.2.3.cmml" xref="S4.Ex1.m1.2.2.1.1.2.3">𝑁</ci></apply><apply id="S4.Ex1.m1.2.2.1.1.1.cmml" xref="S4.Ex1.m1.2.2.1.1.1"><times id="S4.Ex1.m1.2.2.1.1.1.2.cmml" xref="S4.Ex1.m1.2.2.1.1.1.2"></times><apply id="S4.Ex1.m1.2.2.1.1.1.3.cmml" xref="S4.Ex1.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.2.2.1.1.1.3.1.cmml" xref="S4.Ex1.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S4.Ex1.m1.2.2.1.1.1.3.2.cmml" xref="S4.Ex1.m1.2.2.1.1.1.3.2">𝔼</ci><apply id="S4.Ex1.m1.2.2.1.1.1.3.3.cmml" xref="S4.Ex1.m1.2.2.1.1.1.3.3"><csymbol cd="latexml" id="S4.Ex1.m1.2.2.1.1.1.3.3.1.cmml" xref="S4.Ex1.m1.2.2.1.1.1.3.3.1">similar-to</csymbol><ci id="S4.Ex1.m1.2.2.1.1.1.3.3.2.cmml" xref="S4.Ex1.m1.2.2.1.1.1.3.3.2">𝐱</ci><apply id="S4.Ex1.m1.2.2.1.1.1.3.3.3.cmml" xref="S4.Ex1.m1.2.2.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.2.2.1.1.1.3.3.3.1.cmml" xref="S4.Ex1.m1.2.2.1.1.1.3.3.3">subscript</csymbol><ci id="S4.Ex1.m1.2.2.1.1.1.3.3.3.2.cmml" xref="S4.Ex1.m1.2.2.1.1.1.3.3.3.2">𝒟</ci><ci id="S4.Ex1.m1.2.2.1.1.1.3.3.3.3.cmml" xref="S4.Ex1.m1.2.2.1.1.1.3.3.3.3">𝑛</ci></apply></apply></apply><apply id="S4.Ex1.m1.2.2.1.1.1.1.2.cmml" xref="S4.Ex1.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex1.m1.2.2.1.1.1.1.2.1.cmml" xref="S4.Ex1.m1.2.2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.Ex1.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1"><times id="S4.Ex1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.3"></times><ci id="S4.Ex1.m1.2.2.1.1.1.1.1.1.4.cmml" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.4">ℓ</ci><list id="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.2"><apply id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1"><times id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2"></times><ci id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.3">𝒯</ci><apply id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><plus id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1"></plus><ci id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐩</ci><apply id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.1">direct-product</csymbol><ci id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝐩</ci><apply id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><apply id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3">superscript</csymbol><ci id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2">𝐞</ci><ci id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3">′</ci></apply><ci id="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">𝑛</ci></apply></apply></apply></apply><apply id="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2"><times id="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.1"></times><ci id="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.2">ℐ</ci><ci id="S4.Ex1.m1.1.1.cmml" xref="S4.Ex1.m1.1.1">𝐱</ci></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex1.m1.2c">\displaystyle\mathbf{p}_{g}=\arg\min_{\mathbf{p}}\frac{1}{N}\sum_{n=1}^{N}\mathbb{E}_{\mathbf{x}\sim\mathcal{D}_{n}}[\ell(\mathcal{T}(\mathbf{p}+\mathbf{p}\odot\mathbf{e}^{\prime}_{n});\mathcal{I}(\mathbf{x}))]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Federated Training</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">To enable multiple clients to train APT cooperatively, there are three steps. At the beginning of federated training, the server randomly initializes the keys and sends them to different clients (<span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_bold">Step 1</span>).</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p"><span id="S4.SS2.p2.1.1" class="ltx_text ltx_font_bold">Step2: Local Training.</span> To evaluate the capabilities of CLIP and FedAPT in various FL settings, we consider two different client settings:</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.5" class="ltx_p">In the supervised setting, each client updates the global <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="\mathbf{p}_{g}" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><msub id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml">𝐩</mi><mi id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2">𝐩</ci><ci id="S4.SS2.p3.1.m1.1.1.3.cmml" xref="S4.SS2.p3.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">\mathbf{p}_{g}</annotation></semantics></math> and <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="\mathcal{Q}_{g}" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><msub id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.2.m2.1.1.2" xref="S4.SS2.p3.2.m2.1.1.2.cmml">𝒬</mi><mi id="S4.SS2.p3.2.m2.1.1.3" xref="S4.SS2.p3.2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p3.2.m2.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2">𝒬</ci><ci id="S4.SS2.p3.2.m2.1.1.3.cmml" xref="S4.SS2.p3.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">\mathcal{Q}_{g}</annotation></semantics></math> with the local data respectively to obtain <math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="\mathbf{p}_{n}" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><msub id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml"><mi id="S4.SS2.p3.3.m3.1.1.2" xref="S4.SS2.p3.3.m3.1.1.2.cmml">𝐩</mi><mi id="S4.SS2.p3.3.m3.1.1.3" xref="S4.SS2.p3.3.m3.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m3.1.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p3.3.m3.1.1.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2">𝐩</ci><ci id="S4.SS2.p3.3.m3.1.1.3.cmml" xref="S4.SS2.p3.3.m3.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">\mathbf{p}_{n}</annotation></semantics></math> and <math id="S4.SS2.p3.4.m4.1" class="ltx_Math" alttext="\mathcal{Q}_{n}" display="inline"><semantics id="S4.SS2.p3.4.m4.1a"><msub id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.4.m4.1.1.2" xref="S4.SS2.p3.4.m4.1.1.2.cmml">𝒬</mi><mi id="S4.SS2.p3.4.m4.1.1.3" xref="S4.SS2.p3.4.m4.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b"><apply id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.1.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p3.4.m4.1.1.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2">𝒬</ci><ci id="S4.SS2.p3.4.m4.1.1.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">\mathcal{Q}_{n}</annotation></semantics></math>. The prediction of the <math id="S4.SS2.p3.5.m5.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS2.p3.5.m5.1a"><mi id="S4.SS2.p3.5.m5.1.1" xref="S4.SS2.p3.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.5.m5.1b"><ci id="S4.SS2.p3.5.m5.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.5.m5.1c">n</annotation></semantics></math>-th local model is:</p>
<table id="A2.EGx8" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.Ex2.m1.9" class="ltx_Math" alttext="\displaystyle p(c\mid\mathbf{x})=\frac{e^{\cos\left(\mathcal{T}(\mathbf{p}^{c}_{n}+\mathbf{p}^{c}_{n}\odot\mathbf{e}_{k}),\mathcal{I}(\mathbf{x})\right)/\tau}}{\sum_{i=1}^{C}e^{\cos\left(\mathcal{T}(\mathbf{p}^{i}_{n}+\mathbf{p}^{i}_{n}\odot\mathbf{e}_{k}),\mathcal{I}(\mathbf{x})\right)/\tau}}" display="inline"><semantics id="S4.Ex2.m1.9a"><mrow id="S4.Ex2.m1.9.9" xref="S4.Ex2.m1.9.9.cmml"><mrow id="S4.Ex2.m1.9.9.1" xref="S4.Ex2.m1.9.9.1.cmml"><mi id="S4.Ex2.m1.9.9.1.3" xref="S4.Ex2.m1.9.9.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.Ex2.m1.9.9.1.2" xref="S4.Ex2.m1.9.9.1.2.cmml">​</mo><mrow id="S4.Ex2.m1.9.9.1.1.1" xref="S4.Ex2.m1.9.9.1.1.1.1.cmml"><mo stretchy="false" id="S4.Ex2.m1.9.9.1.1.1.2" xref="S4.Ex2.m1.9.9.1.1.1.1.cmml">(</mo><mrow id="S4.Ex2.m1.9.9.1.1.1.1" xref="S4.Ex2.m1.9.9.1.1.1.1.cmml"><mi id="S4.Ex2.m1.9.9.1.1.1.1.2" xref="S4.Ex2.m1.9.9.1.1.1.1.2.cmml">c</mi><mo id="S4.Ex2.m1.9.9.1.1.1.1.1" xref="S4.Ex2.m1.9.9.1.1.1.1.1.cmml">∣</mo><mi id="S4.Ex2.m1.9.9.1.1.1.1.3" xref="S4.Ex2.m1.9.9.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S4.Ex2.m1.9.9.1.1.1.3" xref="S4.Ex2.m1.9.9.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex2.m1.9.9.2" xref="S4.Ex2.m1.9.9.2.cmml">=</mo><mstyle displaystyle="true" id="S4.Ex2.m1.8.8" xref="S4.Ex2.m1.8.8.cmml"><mfrac id="S4.Ex2.m1.8.8a" xref="S4.Ex2.m1.8.8.cmml"><msup id="S4.Ex2.m1.4.4.4" xref="S4.Ex2.m1.4.4.4.cmml"><mi id="S4.Ex2.m1.4.4.4.6" xref="S4.Ex2.m1.4.4.4.6.cmml">e</mi><mrow id="S4.Ex2.m1.4.4.4.4.4" xref="S4.Ex2.m1.4.4.4.4.4.cmml"><mrow id="S4.Ex2.m1.4.4.4.4.4.4.2" xref="S4.Ex2.m1.4.4.4.4.4.4.3.cmml"><mi id="S4.Ex2.m1.2.2.2.2.2.2" xref="S4.Ex2.m1.2.2.2.2.2.2.cmml">cos</mi><mo id="S4.Ex2.m1.4.4.4.4.4.4.2a" xref="S4.Ex2.m1.4.4.4.4.4.4.3.cmml">⁡</mo><mrow id="S4.Ex2.m1.4.4.4.4.4.4.2.2" xref="S4.Ex2.m1.4.4.4.4.4.4.3.cmml"><mo id="S4.Ex2.m1.4.4.4.4.4.4.2.2.3" xref="S4.Ex2.m1.4.4.4.4.4.4.3.cmml">(</mo><mrow id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.3" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.3.cmml">𝒯</mi><mo lspace="0em" rspace="0em" id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.2" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.2.cmml">​</mo><mrow id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.2" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml"><msubsup id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.2" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.cmml"><mi id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.2.2" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.2.2.cmml">𝐩</mi><mi id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.3" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.3.cmml">n</mi><mi id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.2.3" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.2.3.cmml">c</mi></msubsup><mo id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.1" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.cmml"><msubsup id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.2" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.2.cmml"><mi id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.2.2.2" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.2.2.2.cmml">𝐩</mi><mi id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.2.3" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.2.3.cmml">n</mi><mi id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.2.2.3" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.2.2.3.cmml">c</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.1" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.1.cmml">⊙</mo><msub id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.3" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.3.cmml"><mi id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.3.2" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.3.2.cmml">𝐞</mi><mi id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.3.3" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.3.3.cmml">k</mi></msub></mrow></mrow><mo stretchy="false" id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.3" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex2.m1.4.4.4.4.4.4.2.2.4" xref="S4.Ex2.m1.4.4.4.4.4.4.3.cmml">,</mo><mrow id="S4.Ex2.m1.4.4.4.4.4.4.2.2.2" xref="S4.Ex2.m1.4.4.4.4.4.4.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex2.m1.4.4.4.4.4.4.2.2.2.2" xref="S4.Ex2.m1.4.4.4.4.4.4.2.2.2.2.cmml">ℐ</mi><mo lspace="0em" rspace="0em" id="S4.Ex2.m1.4.4.4.4.4.4.2.2.2.1" xref="S4.Ex2.m1.4.4.4.4.4.4.2.2.2.1.cmml">​</mo><mrow id="S4.Ex2.m1.4.4.4.4.4.4.2.2.2.3.2" xref="S4.Ex2.m1.4.4.4.4.4.4.2.2.2.cmml"><mo stretchy="false" id="S4.Ex2.m1.4.4.4.4.4.4.2.2.2.3.2.1" xref="S4.Ex2.m1.4.4.4.4.4.4.2.2.2.cmml">(</mo><mi id="S4.Ex2.m1.1.1.1.1.1.1" xref="S4.Ex2.m1.1.1.1.1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S4.Ex2.m1.4.4.4.4.4.4.2.2.2.3.2.2" xref="S4.Ex2.m1.4.4.4.4.4.4.2.2.2.cmml">)</mo></mrow></mrow><mo id="S4.Ex2.m1.4.4.4.4.4.4.2.2.5" xref="S4.Ex2.m1.4.4.4.4.4.4.3.cmml">)</mo></mrow></mrow><mo id="S4.Ex2.m1.4.4.4.4.4.5" xref="S4.Ex2.m1.4.4.4.4.4.5.cmml">/</mo><mi id="S4.Ex2.m1.4.4.4.4.4.6" xref="S4.Ex2.m1.4.4.4.4.4.6.cmml">τ</mi></mrow></msup><mrow id="S4.Ex2.m1.8.8.8" xref="S4.Ex2.m1.8.8.8.cmml"><msubsup id="S4.Ex2.m1.8.8.8.5" xref="S4.Ex2.m1.8.8.8.5.cmml"><mo id="S4.Ex2.m1.8.8.8.5.2.2" xref="S4.Ex2.m1.8.8.8.5.2.2.cmml">∑</mo><mrow id="S4.Ex2.m1.8.8.8.5.2.3" xref="S4.Ex2.m1.8.8.8.5.2.3.cmml"><mi id="S4.Ex2.m1.8.8.8.5.2.3.2" xref="S4.Ex2.m1.8.8.8.5.2.3.2.cmml">i</mi><mo id="S4.Ex2.m1.8.8.8.5.2.3.1" xref="S4.Ex2.m1.8.8.8.5.2.3.1.cmml">=</mo><mn id="S4.Ex2.m1.8.8.8.5.2.3.3" xref="S4.Ex2.m1.8.8.8.5.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex2.m1.8.8.8.5.3" xref="S4.Ex2.m1.8.8.8.5.3.cmml">C</mi></msubsup><msup id="S4.Ex2.m1.8.8.8.6" xref="S4.Ex2.m1.8.8.8.6.cmml"><mi id="S4.Ex2.m1.8.8.8.6.2" xref="S4.Ex2.m1.8.8.8.6.2.cmml">e</mi><mrow id="S4.Ex2.m1.8.8.8.4.4" xref="S4.Ex2.m1.8.8.8.4.4.cmml"><mrow id="S4.Ex2.m1.8.8.8.4.4.4.2" xref="S4.Ex2.m1.8.8.8.4.4.4.3.cmml"><mi id="S4.Ex2.m1.6.6.6.2.2.2" xref="S4.Ex2.m1.6.6.6.2.2.2.cmml">cos</mi><mo id="S4.Ex2.m1.8.8.8.4.4.4.2a" xref="S4.Ex2.m1.8.8.8.4.4.4.3.cmml">⁡</mo><mrow id="S4.Ex2.m1.8.8.8.4.4.4.2.2" xref="S4.Ex2.m1.8.8.8.4.4.4.3.cmml"><mo id="S4.Ex2.m1.8.8.8.4.4.4.2.2.3" xref="S4.Ex2.m1.8.8.8.4.4.4.3.cmml">(</mo><mrow id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.3" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.3.cmml">𝒯</mi><mo lspace="0em" rspace="0em" id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.2" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.2.cmml">​</mo><mrow id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.2" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.cmml"><msubsup id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.2" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.2.cmml"><mi id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.2.2.2" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.2.2.2.cmml">𝐩</mi><mi id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.2.3" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.2.3.cmml">n</mi><mi id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.2.2.3" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.2.2.3.cmml">i</mi></msubsup><mo id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.1" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.cmml"><msubsup id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.2" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.2.cmml"><mi id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.2.2.2" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.2.2.2.cmml">𝐩</mi><mi id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.2.3" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.2.3.cmml">n</mi><mi id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.2.2.3" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.2.2.3.cmml">i</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.1" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.1.cmml">⊙</mo><msub id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.3" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.3.cmml"><mi id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.3.2" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.3.2.cmml">𝐞</mi><mi id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.3.3" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.3.3.cmml">k</mi></msub></mrow></mrow><mo stretchy="false" id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.3" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex2.m1.8.8.8.4.4.4.2.2.4" xref="S4.Ex2.m1.8.8.8.4.4.4.3.cmml">,</mo><mrow id="S4.Ex2.m1.8.8.8.4.4.4.2.2.2" xref="S4.Ex2.m1.8.8.8.4.4.4.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex2.m1.8.8.8.4.4.4.2.2.2.2" xref="S4.Ex2.m1.8.8.8.4.4.4.2.2.2.2.cmml">ℐ</mi><mo lspace="0em" rspace="0em" id="S4.Ex2.m1.8.8.8.4.4.4.2.2.2.1" xref="S4.Ex2.m1.8.8.8.4.4.4.2.2.2.1.cmml">​</mo><mrow id="S4.Ex2.m1.8.8.8.4.4.4.2.2.2.3.2" xref="S4.Ex2.m1.8.8.8.4.4.4.2.2.2.cmml"><mo stretchy="false" id="S4.Ex2.m1.8.8.8.4.4.4.2.2.2.3.2.1" xref="S4.Ex2.m1.8.8.8.4.4.4.2.2.2.cmml">(</mo><mi id="S4.Ex2.m1.5.5.5.1.1.1" xref="S4.Ex2.m1.5.5.5.1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S4.Ex2.m1.8.8.8.4.4.4.2.2.2.3.2.2" xref="S4.Ex2.m1.8.8.8.4.4.4.2.2.2.cmml">)</mo></mrow></mrow><mo id="S4.Ex2.m1.8.8.8.4.4.4.2.2.5" xref="S4.Ex2.m1.8.8.8.4.4.4.3.cmml">)</mo></mrow></mrow><mo id="S4.Ex2.m1.8.8.8.4.4.5" xref="S4.Ex2.m1.8.8.8.4.4.5.cmml">/</mo><mi id="S4.Ex2.m1.8.8.8.4.4.6" xref="S4.Ex2.m1.8.8.8.4.4.6.cmml">τ</mi></mrow></msup></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex2.m1.9b"><apply id="S4.Ex2.m1.9.9.cmml" xref="S4.Ex2.m1.9.9"><eq id="S4.Ex2.m1.9.9.2.cmml" xref="S4.Ex2.m1.9.9.2"></eq><apply id="S4.Ex2.m1.9.9.1.cmml" xref="S4.Ex2.m1.9.9.1"><times id="S4.Ex2.m1.9.9.1.2.cmml" xref="S4.Ex2.m1.9.9.1.2"></times><ci id="S4.Ex2.m1.9.9.1.3.cmml" xref="S4.Ex2.m1.9.9.1.3">𝑝</ci><apply id="S4.Ex2.m1.9.9.1.1.1.1.cmml" xref="S4.Ex2.m1.9.9.1.1.1"><csymbol cd="latexml" id="S4.Ex2.m1.9.9.1.1.1.1.1.cmml" xref="S4.Ex2.m1.9.9.1.1.1.1.1">conditional</csymbol><ci id="S4.Ex2.m1.9.9.1.1.1.1.2.cmml" xref="S4.Ex2.m1.9.9.1.1.1.1.2">𝑐</ci><ci id="S4.Ex2.m1.9.9.1.1.1.1.3.cmml" xref="S4.Ex2.m1.9.9.1.1.1.1.3">𝐱</ci></apply></apply><apply id="S4.Ex2.m1.8.8.cmml" xref="S4.Ex2.m1.8.8"><divide id="S4.Ex2.m1.8.8.9.cmml" xref="S4.Ex2.m1.8.8"></divide><apply id="S4.Ex2.m1.4.4.4.cmml" xref="S4.Ex2.m1.4.4.4"><csymbol cd="ambiguous" id="S4.Ex2.m1.4.4.4.5.cmml" xref="S4.Ex2.m1.4.4.4">superscript</csymbol><ci id="S4.Ex2.m1.4.4.4.6.cmml" xref="S4.Ex2.m1.4.4.4.6">𝑒</ci><apply id="S4.Ex2.m1.4.4.4.4.4.cmml" xref="S4.Ex2.m1.4.4.4.4.4"><divide id="S4.Ex2.m1.4.4.4.4.4.5.cmml" xref="S4.Ex2.m1.4.4.4.4.4.5"></divide><apply id="S4.Ex2.m1.4.4.4.4.4.4.3.cmml" xref="S4.Ex2.m1.4.4.4.4.4.4.2"><cos id="S4.Ex2.m1.2.2.2.2.2.2.cmml" xref="S4.Ex2.m1.2.2.2.2.2.2"></cos><apply id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.cmml" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1"><times id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.2.cmml" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.2"></times><ci id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.3.cmml" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.3">𝒯</ci><apply id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1"><plus id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.1"></plus><apply id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.2">subscript</csymbol><apply id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.2">superscript</csymbol><ci id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.2.2">𝐩</ci><ci id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.2.3.cmml" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.2.3">𝑐</ci></apply><ci id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.3.cmml" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.3">𝑛</ci></apply><apply id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.cmml" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.1">direct-product</csymbol><apply id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.2.1.cmml" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.2">subscript</csymbol><apply id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.2.2.cmml" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.2.2.1.cmml" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.2.2.2.cmml" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.2.2.2">𝐩</ci><ci id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.2.2.3.cmml" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.2.2.3">𝑐</ci></apply><ci id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.2.3.cmml" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.2.3">𝑛</ci></apply><apply id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.3.cmml" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.3.1.cmml" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.3.2.cmml" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.3.2">𝐞</ci><ci id="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.3.3.cmml" xref="S4.Ex2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.3.3">𝑘</ci></apply></apply></apply></apply><apply id="S4.Ex2.m1.4.4.4.4.4.4.2.2.2.cmml" xref="S4.Ex2.m1.4.4.4.4.4.4.2.2.2"><times id="S4.Ex2.m1.4.4.4.4.4.4.2.2.2.1.cmml" xref="S4.Ex2.m1.4.4.4.4.4.4.2.2.2.1"></times><ci id="S4.Ex2.m1.4.4.4.4.4.4.2.2.2.2.cmml" xref="S4.Ex2.m1.4.4.4.4.4.4.2.2.2.2">ℐ</ci><ci id="S4.Ex2.m1.1.1.1.1.1.1.cmml" xref="S4.Ex2.m1.1.1.1.1.1.1">𝐱</ci></apply></apply><ci id="S4.Ex2.m1.4.4.4.4.4.6.cmml" xref="S4.Ex2.m1.4.4.4.4.4.6">𝜏</ci></apply></apply><apply id="S4.Ex2.m1.8.8.8.cmml" xref="S4.Ex2.m1.8.8.8"><apply id="S4.Ex2.m1.8.8.8.5.cmml" xref="S4.Ex2.m1.8.8.8.5"><csymbol cd="ambiguous" id="S4.Ex2.m1.8.8.8.5.1.cmml" xref="S4.Ex2.m1.8.8.8.5">superscript</csymbol><apply id="S4.Ex2.m1.8.8.8.5.2.cmml" xref="S4.Ex2.m1.8.8.8.5"><csymbol cd="ambiguous" id="S4.Ex2.m1.8.8.8.5.2.1.cmml" xref="S4.Ex2.m1.8.8.8.5">subscript</csymbol><sum id="S4.Ex2.m1.8.8.8.5.2.2.cmml" xref="S4.Ex2.m1.8.8.8.5.2.2"></sum><apply id="S4.Ex2.m1.8.8.8.5.2.3.cmml" xref="S4.Ex2.m1.8.8.8.5.2.3"><eq id="S4.Ex2.m1.8.8.8.5.2.3.1.cmml" xref="S4.Ex2.m1.8.8.8.5.2.3.1"></eq><ci id="S4.Ex2.m1.8.8.8.5.2.3.2.cmml" xref="S4.Ex2.m1.8.8.8.5.2.3.2">𝑖</ci><cn type="integer" id="S4.Ex2.m1.8.8.8.5.2.3.3.cmml" xref="S4.Ex2.m1.8.8.8.5.2.3.3">1</cn></apply></apply><ci id="S4.Ex2.m1.8.8.8.5.3.cmml" xref="S4.Ex2.m1.8.8.8.5.3">𝐶</ci></apply><apply id="S4.Ex2.m1.8.8.8.6.cmml" xref="S4.Ex2.m1.8.8.8.6"><csymbol cd="ambiguous" id="S4.Ex2.m1.8.8.8.6.1.cmml" xref="S4.Ex2.m1.8.8.8.6">superscript</csymbol><ci id="S4.Ex2.m1.8.8.8.6.2.cmml" xref="S4.Ex2.m1.8.8.8.6.2">𝑒</ci><apply id="S4.Ex2.m1.8.8.8.4.4.cmml" xref="S4.Ex2.m1.8.8.8.4.4"><divide id="S4.Ex2.m1.8.8.8.4.4.5.cmml" xref="S4.Ex2.m1.8.8.8.4.4.5"></divide><apply id="S4.Ex2.m1.8.8.8.4.4.4.3.cmml" xref="S4.Ex2.m1.8.8.8.4.4.4.2"><cos id="S4.Ex2.m1.6.6.6.2.2.2.cmml" xref="S4.Ex2.m1.6.6.6.2.2.2"></cos><apply id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.cmml" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1"><times id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.2.cmml" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.2"></times><ci id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.3.cmml" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.3">𝒯</ci><apply id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.cmml" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1"><plus id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.1.cmml" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.1"></plus><apply id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.2.cmml" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.2">subscript</csymbol><apply id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.2">superscript</csymbol><ci id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.2.2.2">𝐩</ci><ci id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.2.2.3.cmml" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.2.3.cmml" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.2.3">𝑛</ci></apply><apply id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.cmml" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.1">direct-product</csymbol><apply id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.2.1.cmml" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.2">subscript</csymbol><apply id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.2.2.cmml" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.2.2.1.cmml" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.2.2.2.cmml" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.2.2.2">𝐩</ci><ci id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.2.2.3.cmml" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.2.2.3">𝑖</ci></apply><ci id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.2.3.cmml" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.2.3">𝑛</ci></apply><apply id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.3.cmml" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.3.1.cmml" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.3.2.cmml" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.3.2">𝐞</ci><ci id="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.3.3.cmml" xref="S4.Ex2.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.3.3">𝑘</ci></apply></apply></apply></apply><apply id="S4.Ex2.m1.8.8.8.4.4.4.2.2.2.cmml" xref="S4.Ex2.m1.8.8.8.4.4.4.2.2.2"><times id="S4.Ex2.m1.8.8.8.4.4.4.2.2.2.1.cmml" xref="S4.Ex2.m1.8.8.8.4.4.4.2.2.2.1"></times><ci id="S4.Ex2.m1.8.8.8.4.4.4.2.2.2.2.cmml" xref="S4.Ex2.m1.8.8.8.4.4.4.2.2.2.2">ℐ</ci><ci id="S4.Ex2.m1.5.5.5.1.1.1.cmml" xref="S4.Ex2.m1.5.5.5.1.1.1">𝐱</ci></apply></apply><ci id="S4.Ex2.m1.8.8.8.4.4.6.cmml" xref="S4.Ex2.m1.8.8.8.4.4.6">𝜏</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex2.m1.9c">\displaystyle p(c\mid\mathbf{x})=\frac{e^{\cos\left(\mathcal{T}(\mathbf{p}^{c}_{n}+\mathbf{p}^{c}_{n}\odot\mathbf{e}_{k}),\mathcal{I}(\mathbf{x})\right)/\tau}}{\sum_{i=1}^{C}e^{\cos\left(\mathcal{T}(\mathbf{p}^{i}_{n}+\mathbf{p}^{i}_{n}\odot\mathbf{e}_{k}),\mathcal{I}(\mathbf{x})\right)/\tau}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS2.p3.6" class="ltx_p">where <math id="S4.SS2.p3.6.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.p3.6.m1.1a"><mi id="S4.SS2.p3.6.m1.1.1" xref="S4.SS2.p3.6.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.6.m1.1b"><ci id="S4.SS2.p3.6.m1.1.1.cmml" xref="S4.SS2.p3.6.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.6.m1.1c">k</annotation></semantics></math> is the domain index of the client. Then the cross entropy loss for image classification is:</p>
<table id="A2.EGx9" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E7.m1.4" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{c}=\frac{1}{\left|\mathcal{D}_{n}\right|}\sum_{\mathbf{x}_{i},y_{i}\sim\mathcal{D}_{n}}-\log p\left(y_{i}\mid\mathbf{x}_{i},\mathbf{p}_{n}\right)" display="inline"><semantics id="S4.E7.m1.4a"><mrow id="S4.E7.m1.4.4" xref="S4.E7.m1.4.4.cmml"><msub id="S4.E7.m1.4.4.3" xref="S4.E7.m1.4.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.4.4.3.2" xref="S4.E7.m1.4.4.3.2.cmml">ℒ</mi><mi id="S4.E7.m1.4.4.3.3" xref="S4.E7.m1.4.4.3.3.cmml">c</mi></msub><mo id="S4.E7.m1.4.4.2" xref="S4.E7.m1.4.4.2.cmml">=</mo><mrow id="S4.E7.m1.4.4.1" xref="S4.E7.m1.4.4.1.cmml"><mrow id="S4.E7.m1.4.4.1.3" xref="S4.E7.m1.4.4.1.3.cmml"><mstyle displaystyle="true" id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml"><mfrac id="S4.E7.m1.1.1a" xref="S4.E7.m1.1.1.cmml"><mn id="S4.E7.m1.1.1.3" xref="S4.E7.m1.1.1.3.cmml">1</mn><mrow id="S4.E7.m1.1.1.1.1" xref="S4.E7.m1.1.1.1.2.cmml"><mo id="S4.E7.m1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.2.1.cmml">|</mo><msub id="S4.E7.m1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S4.E7.m1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.3.cmml">n</mi></msub><mo id="S4.E7.m1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E7.m1.4.4.1.3.1" xref="S4.E7.m1.4.4.1.3.1.cmml">​</mo><mstyle displaystyle="true" id="S4.E7.m1.4.4.1.3.2" xref="S4.E7.m1.4.4.1.3.2.cmml"><munder id="S4.E7.m1.4.4.1.3.2a" xref="S4.E7.m1.4.4.1.3.2.cmml"><mo movablelimits="false" id="S4.E7.m1.4.4.1.3.2.2" xref="S4.E7.m1.4.4.1.3.2.2.cmml">∑</mo><mrow id="S4.E7.m1.3.3.2" xref="S4.E7.m1.3.3.2.cmml"><mrow id="S4.E7.m1.3.3.2.2.2" xref="S4.E7.m1.3.3.2.2.3.cmml"><msub id="S4.E7.m1.2.2.1.1.1.1" xref="S4.E7.m1.2.2.1.1.1.1.cmml"><mi id="S4.E7.m1.2.2.1.1.1.1.2" xref="S4.E7.m1.2.2.1.1.1.1.2.cmml">𝐱</mi><mi id="S4.E7.m1.2.2.1.1.1.1.3" xref="S4.E7.m1.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E7.m1.3.3.2.2.2.3" xref="S4.E7.m1.3.3.2.2.3.cmml">,</mo><msub id="S4.E7.m1.3.3.2.2.2.2" xref="S4.E7.m1.3.3.2.2.2.2.cmml"><mi id="S4.E7.m1.3.3.2.2.2.2.2" xref="S4.E7.m1.3.3.2.2.2.2.2.cmml">y</mi><mi id="S4.E7.m1.3.3.2.2.2.2.3" xref="S4.E7.m1.3.3.2.2.2.2.3.cmml">i</mi></msub></mrow><mo id="S4.E7.m1.3.3.2.3" xref="S4.E7.m1.3.3.2.3.cmml">∼</mo><msub id="S4.E7.m1.3.3.2.4" xref="S4.E7.m1.3.3.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.3.3.2.4.2" xref="S4.E7.m1.3.3.2.4.2.cmml">𝒟</mi><mi id="S4.E7.m1.3.3.2.4.3" xref="S4.E7.m1.3.3.2.4.3.cmml">n</mi></msub></mrow></munder></mstyle></mrow><mo id="S4.E7.m1.4.4.1.2" xref="S4.E7.m1.4.4.1.2.cmml">−</mo><mrow id="S4.E7.m1.4.4.1.1" xref="S4.E7.m1.4.4.1.1.cmml"><mrow id="S4.E7.m1.4.4.1.1.3" xref="S4.E7.m1.4.4.1.1.3.cmml"><mi id="S4.E7.m1.4.4.1.1.3.1" xref="S4.E7.m1.4.4.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S4.E7.m1.4.4.1.1.3a" xref="S4.E7.m1.4.4.1.1.3.cmml">⁡</mo><mi id="S4.E7.m1.4.4.1.1.3.2" xref="S4.E7.m1.4.4.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S4.E7.m1.4.4.1.1.2" xref="S4.E7.m1.4.4.1.1.2.cmml">​</mo><mrow id="S4.E7.m1.4.4.1.1.1.1" xref="S4.E7.m1.4.4.1.1.1.1.1.cmml"><mo id="S4.E7.m1.4.4.1.1.1.1.2" xref="S4.E7.m1.4.4.1.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.4.4.1.1.1.1.1" xref="S4.E7.m1.4.4.1.1.1.1.1.cmml"><msub id="S4.E7.m1.4.4.1.1.1.1.1.4" xref="S4.E7.m1.4.4.1.1.1.1.1.4.cmml"><mi id="S4.E7.m1.4.4.1.1.1.1.1.4.2" xref="S4.E7.m1.4.4.1.1.1.1.1.4.2.cmml">y</mi><mi id="S4.E7.m1.4.4.1.1.1.1.1.4.3" xref="S4.E7.m1.4.4.1.1.1.1.1.4.3.cmml">i</mi></msub><mo id="S4.E7.m1.4.4.1.1.1.1.1.3" xref="S4.E7.m1.4.4.1.1.1.1.1.3.cmml">∣</mo><mrow id="S4.E7.m1.4.4.1.1.1.1.1.2.2" xref="S4.E7.m1.4.4.1.1.1.1.1.2.3.cmml"><msub id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E7.m1.4.4.1.1.1.1.1.2.2.3" xref="S4.E7.m1.4.4.1.1.1.1.1.2.3.cmml">,</mo><msub id="S4.E7.m1.4.4.1.1.1.1.1.2.2.2" xref="S4.E7.m1.4.4.1.1.1.1.1.2.2.2.cmml"><mi id="S4.E7.m1.4.4.1.1.1.1.1.2.2.2.2" xref="S4.E7.m1.4.4.1.1.1.1.1.2.2.2.2.cmml">𝐩</mi><mi id="S4.E7.m1.4.4.1.1.1.1.1.2.2.2.3" xref="S4.E7.m1.4.4.1.1.1.1.1.2.2.2.3.cmml">n</mi></msub></mrow></mrow><mo id="S4.E7.m1.4.4.1.1.1.1.3" xref="S4.E7.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.4b"><apply id="S4.E7.m1.4.4.cmml" xref="S4.E7.m1.4.4"><eq id="S4.E7.m1.4.4.2.cmml" xref="S4.E7.m1.4.4.2"></eq><apply id="S4.E7.m1.4.4.3.cmml" xref="S4.E7.m1.4.4.3"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.3.1.cmml" xref="S4.E7.m1.4.4.3">subscript</csymbol><ci id="S4.E7.m1.4.4.3.2.cmml" xref="S4.E7.m1.4.4.3.2">ℒ</ci><ci id="S4.E7.m1.4.4.3.3.cmml" xref="S4.E7.m1.4.4.3.3">𝑐</ci></apply><apply id="S4.E7.m1.4.4.1.cmml" xref="S4.E7.m1.4.4.1"><minus id="S4.E7.m1.4.4.1.2.cmml" xref="S4.E7.m1.4.4.1.2"></minus><apply id="S4.E7.m1.4.4.1.3.cmml" xref="S4.E7.m1.4.4.1.3"><times id="S4.E7.m1.4.4.1.3.1.cmml" xref="S4.E7.m1.4.4.1.3.1"></times><apply id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1"><divide id="S4.E7.m1.1.1.2.cmml" xref="S4.E7.m1.1.1"></divide><cn type="integer" id="S4.E7.m1.1.1.3.cmml" xref="S4.E7.m1.1.1.3">1</cn><apply id="S4.E7.m1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1"><abs id="S4.E7.m1.1.1.1.2.1.cmml" xref="S4.E7.m1.1.1.1.1.2"></abs><apply id="S4.E7.m1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.1.2">𝒟</ci><ci id="S4.E7.m1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.1.3">𝑛</ci></apply></apply></apply><apply id="S4.E7.m1.4.4.1.3.2.cmml" xref="S4.E7.m1.4.4.1.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.3.2.1.cmml" xref="S4.E7.m1.4.4.1.3.2">subscript</csymbol><sum id="S4.E7.m1.4.4.1.3.2.2.cmml" xref="S4.E7.m1.4.4.1.3.2.2"></sum><apply id="S4.E7.m1.3.3.2.cmml" xref="S4.E7.m1.3.3.2"><csymbol cd="latexml" id="S4.E7.m1.3.3.2.3.cmml" xref="S4.E7.m1.3.3.2.3">similar-to</csymbol><list id="S4.E7.m1.3.3.2.2.3.cmml" xref="S4.E7.m1.3.3.2.2.2"><apply id="S4.E7.m1.2.2.1.1.1.1.cmml" xref="S4.E7.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.2.2.1.1.1.1.2.cmml" xref="S4.E7.m1.2.2.1.1.1.1.2">𝐱</ci><ci id="S4.E7.m1.2.2.1.1.1.1.3.cmml" xref="S4.E7.m1.2.2.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E7.m1.3.3.2.2.2.2.cmml" xref="S4.E7.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.2.2.2.2.1.cmml" xref="S4.E7.m1.3.3.2.2.2.2">subscript</csymbol><ci id="S4.E7.m1.3.3.2.2.2.2.2.cmml" xref="S4.E7.m1.3.3.2.2.2.2.2">𝑦</ci><ci id="S4.E7.m1.3.3.2.2.2.2.3.cmml" xref="S4.E7.m1.3.3.2.2.2.2.3">𝑖</ci></apply></list><apply id="S4.E7.m1.3.3.2.4.cmml" xref="S4.E7.m1.3.3.2.4"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.2.4.1.cmml" xref="S4.E7.m1.3.3.2.4">subscript</csymbol><ci id="S4.E7.m1.3.3.2.4.2.cmml" xref="S4.E7.m1.3.3.2.4.2">𝒟</ci><ci id="S4.E7.m1.3.3.2.4.3.cmml" xref="S4.E7.m1.3.3.2.4.3">𝑛</ci></apply></apply></apply></apply><apply id="S4.E7.m1.4.4.1.1.cmml" xref="S4.E7.m1.4.4.1.1"><times id="S4.E7.m1.4.4.1.1.2.cmml" xref="S4.E7.m1.4.4.1.1.2"></times><apply id="S4.E7.m1.4.4.1.1.3.cmml" xref="S4.E7.m1.4.4.1.1.3"><log id="S4.E7.m1.4.4.1.1.3.1.cmml" xref="S4.E7.m1.4.4.1.1.3.1"></log><ci id="S4.E7.m1.4.4.1.1.3.2.cmml" xref="S4.E7.m1.4.4.1.1.3.2">𝑝</ci></apply><apply id="S4.E7.m1.4.4.1.1.1.1.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1"><csymbol cd="latexml" id="S4.E7.m1.4.4.1.1.1.1.1.3.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.3">conditional</csymbol><apply id="S4.E7.m1.4.4.1.1.1.1.1.4.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.1.1.1.4.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.4">subscript</csymbol><ci id="S4.E7.m1.4.4.1.1.1.1.1.4.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.4.2">𝑦</ci><ci id="S4.E7.m1.4.4.1.1.1.1.1.4.3.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.4.3">𝑖</ci></apply><list id="S4.E7.m1.4.4.1.1.1.1.1.2.3.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.2.2"><apply id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E7.m1.4.4.1.1.1.1.1.2.2.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E7.m1.4.4.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.2.2.2.2">𝐩</ci><ci id="S4.E7.m1.4.4.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.2.2.2.3">𝑛</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.4c">\displaystyle\mathcal{L}_{c}=\frac{1}{\left|\mathcal{D}_{n}\right|}\sum_{\mathbf{x}_{i},y_{i}\sim\mathcal{D}_{n}}-\log p\left(y_{i}\mid\mathbf{x}_{i},\mathbf{p}_{n}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.5" class="ltx_p">In an unsupervised setting, we design a two-stage training approach. In the first stage, we augment the unlabeled data (same augment strategy as SimCLR <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib2" title="" class="ltx_ref">2020</a>)</cite>) and utilize pseudo-labels with high confidence from the original data as supervised information to perform self-training on the augmented data. The training loss is:</p>
<table id="A2.EGx10" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E8.m1.2" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{pseudo}=\frac{1}{\left|\mathcal{D}_{n}\right|}\sum_{\mathbf{x}_{i}\sim\mathcal{D}_{n}}-\log p\left(\hat{y}_{i}\mid\hat{\mathbf{x}}_{i},\mathbf{p}_{n}\right)" display="inline"><semantics id="S4.E8.m1.2a"><mrow id="S4.E8.m1.2.2" xref="S4.E8.m1.2.2.cmml"><msub id="S4.E8.m1.2.2.3" xref="S4.E8.m1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.2.2.3.2" xref="S4.E8.m1.2.2.3.2.cmml">ℒ</mi><mrow id="S4.E8.m1.2.2.3.3" xref="S4.E8.m1.2.2.3.3.cmml"><mi id="S4.E8.m1.2.2.3.3.2" xref="S4.E8.m1.2.2.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.2.2.3.3.1" xref="S4.E8.m1.2.2.3.3.1.cmml">​</mo><mi id="S4.E8.m1.2.2.3.3.3" xref="S4.E8.m1.2.2.3.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.2.2.3.3.1a" xref="S4.E8.m1.2.2.3.3.1.cmml">​</mo><mi id="S4.E8.m1.2.2.3.3.4" xref="S4.E8.m1.2.2.3.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.2.2.3.3.1b" xref="S4.E8.m1.2.2.3.3.1.cmml">​</mo><mi id="S4.E8.m1.2.2.3.3.5" xref="S4.E8.m1.2.2.3.3.5.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.2.2.3.3.1c" xref="S4.E8.m1.2.2.3.3.1.cmml">​</mo><mi id="S4.E8.m1.2.2.3.3.6" xref="S4.E8.m1.2.2.3.3.6.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.2.2.3.3.1d" xref="S4.E8.m1.2.2.3.3.1.cmml">​</mo><mi id="S4.E8.m1.2.2.3.3.7" xref="S4.E8.m1.2.2.3.3.7.cmml">o</mi></mrow></msub><mo id="S4.E8.m1.2.2.2" xref="S4.E8.m1.2.2.2.cmml">=</mo><mrow id="S4.E8.m1.2.2.1" xref="S4.E8.m1.2.2.1.cmml"><mrow id="S4.E8.m1.2.2.1.3" xref="S4.E8.m1.2.2.1.3.cmml"><mstyle displaystyle="true" id="S4.E8.m1.1.1" xref="S4.E8.m1.1.1.cmml"><mfrac id="S4.E8.m1.1.1a" xref="S4.E8.m1.1.1.cmml"><mn id="S4.E8.m1.1.1.3" xref="S4.E8.m1.1.1.3.cmml">1</mn><mrow id="S4.E8.m1.1.1.1.1" xref="S4.E8.m1.1.1.1.2.cmml"><mo id="S4.E8.m1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.2.1.cmml">|</mo><msub id="S4.E8.m1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S4.E8.m1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.3.cmml">n</mi></msub><mo id="S4.E8.m1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E8.m1.2.2.1.3.1" xref="S4.E8.m1.2.2.1.3.1.cmml">​</mo><mstyle displaystyle="true" id="S4.E8.m1.2.2.1.3.2" xref="S4.E8.m1.2.2.1.3.2.cmml"><munder id="S4.E8.m1.2.2.1.3.2a" xref="S4.E8.m1.2.2.1.3.2.cmml"><mo movablelimits="false" id="S4.E8.m1.2.2.1.3.2.2" xref="S4.E8.m1.2.2.1.3.2.2.cmml">∑</mo><mrow id="S4.E8.m1.2.2.1.3.2.3" xref="S4.E8.m1.2.2.1.3.2.3.cmml"><msub id="S4.E8.m1.2.2.1.3.2.3.2" xref="S4.E8.m1.2.2.1.3.2.3.2.cmml"><mi id="S4.E8.m1.2.2.1.3.2.3.2.2" xref="S4.E8.m1.2.2.1.3.2.3.2.2.cmml">𝐱</mi><mi id="S4.E8.m1.2.2.1.3.2.3.2.3" xref="S4.E8.m1.2.2.1.3.2.3.2.3.cmml">i</mi></msub><mo id="S4.E8.m1.2.2.1.3.2.3.1" xref="S4.E8.m1.2.2.1.3.2.3.1.cmml">∼</mo><msub id="S4.E8.m1.2.2.1.3.2.3.3" xref="S4.E8.m1.2.2.1.3.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.2.2.1.3.2.3.3.2" xref="S4.E8.m1.2.2.1.3.2.3.3.2.cmml">𝒟</mi><mi id="S4.E8.m1.2.2.1.3.2.3.3.3" xref="S4.E8.m1.2.2.1.3.2.3.3.3.cmml">n</mi></msub></mrow></munder></mstyle></mrow><mo id="S4.E8.m1.2.2.1.2" xref="S4.E8.m1.2.2.1.2.cmml">−</mo><mrow id="S4.E8.m1.2.2.1.1" xref="S4.E8.m1.2.2.1.1.cmml"><mrow id="S4.E8.m1.2.2.1.1.3" xref="S4.E8.m1.2.2.1.1.3.cmml"><mi id="S4.E8.m1.2.2.1.1.3.1" xref="S4.E8.m1.2.2.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S4.E8.m1.2.2.1.1.3a" xref="S4.E8.m1.2.2.1.1.3.cmml">⁡</mo><mi id="S4.E8.m1.2.2.1.1.3.2" xref="S4.E8.m1.2.2.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S4.E8.m1.2.2.1.1.2" xref="S4.E8.m1.2.2.1.1.2.cmml">​</mo><mrow id="S4.E8.m1.2.2.1.1.1.1" xref="S4.E8.m1.2.2.1.1.1.1.1.cmml"><mo id="S4.E8.m1.2.2.1.1.1.1.2" xref="S4.E8.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.2.2.1.1.1.1.1" xref="S4.E8.m1.2.2.1.1.1.1.1.cmml"><msub id="S4.E8.m1.2.2.1.1.1.1.1.4" xref="S4.E8.m1.2.2.1.1.1.1.1.4.cmml"><mover accent="true" id="S4.E8.m1.2.2.1.1.1.1.1.4.2" xref="S4.E8.m1.2.2.1.1.1.1.1.4.2.cmml"><mi id="S4.E8.m1.2.2.1.1.1.1.1.4.2.2" xref="S4.E8.m1.2.2.1.1.1.1.1.4.2.2.cmml">y</mi><mo id="S4.E8.m1.2.2.1.1.1.1.1.4.2.1" xref="S4.E8.m1.2.2.1.1.1.1.1.4.2.1.cmml">^</mo></mover><mi id="S4.E8.m1.2.2.1.1.1.1.1.4.3" xref="S4.E8.m1.2.2.1.1.1.1.1.4.3.cmml">i</mi></msub><mo id="S4.E8.m1.2.2.1.1.1.1.1.3" xref="S4.E8.m1.2.2.1.1.1.1.1.3.cmml">∣</mo><mrow id="S4.E8.m1.2.2.1.1.1.1.1.2.2" xref="S4.E8.m1.2.2.1.1.1.1.1.2.3.cmml"><msub id="S4.E8.m1.2.2.1.1.1.1.1.1.1.1" xref="S4.E8.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.E8.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E8.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S4.E8.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mo id="S4.E8.m1.2.2.1.1.1.1.1.1.1.1.2.1" xref="S4.E8.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S4.E8.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E8.m1.2.2.1.1.1.1.1.2.2.3" xref="S4.E8.m1.2.2.1.1.1.1.1.2.3.cmml">,</mo><msub id="S4.E8.m1.2.2.1.1.1.1.1.2.2.2" xref="S4.E8.m1.2.2.1.1.1.1.1.2.2.2.cmml"><mi id="S4.E8.m1.2.2.1.1.1.1.1.2.2.2.2" xref="S4.E8.m1.2.2.1.1.1.1.1.2.2.2.2.cmml">𝐩</mi><mi id="S4.E8.m1.2.2.1.1.1.1.1.2.2.2.3" xref="S4.E8.m1.2.2.1.1.1.1.1.2.2.2.3.cmml">n</mi></msub></mrow></mrow><mo id="S4.E8.m1.2.2.1.1.1.1.3" xref="S4.E8.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.2b"><apply id="S4.E8.m1.2.2.cmml" xref="S4.E8.m1.2.2"><eq id="S4.E8.m1.2.2.2.cmml" xref="S4.E8.m1.2.2.2"></eq><apply id="S4.E8.m1.2.2.3.cmml" xref="S4.E8.m1.2.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.3.1.cmml" xref="S4.E8.m1.2.2.3">subscript</csymbol><ci id="S4.E8.m1.2.2.3.2.cmml" xref="S4.E8.m1.2.2.3.2">ℒ</ci><apply id="S4.E8.m1.2.2.3.3.cmml" xref="S4.E8.m1.2.2.3.3"><times id="S4.E8.m1.2.2.3.3.1.cmml" xref="S4.E8.m1.2.2.3.3.1"></times><ci id="S4.E8.m1.2.2.3.3.2.cmml" xref="S4.E8.m1.2.2.3.3.2">𝑝</ci><ci id="S4.E8.m1.2.2.3.3.3.cmml" xref="S4.E8.m1.2.2.3.3.3">𝑠</ci><ci id="S4.E8.m1.2.2.3.3.4.cmml" xref="S4.E8.m1.2.2.3.3.4">𝑒</ci><ci id="S4.E8.m1.2.2.3.3.5.cmml" xref="S4.E8.m1.2.2.3.3.5">𝑢</ci><ci id="S4.E8.m1.2.2.3.3.6.cmml" xref="S4.E8.m1.2.2.3.3.6">𝑑</ci><ci id="S4.E8.m1.2.2.3.3.7.cmml" xref="S4.E8.m1.2.2.3.3.7">𝑜</ci></apply></apply><apply id="S4.E8.m1.2.2.1.cmml" xref="S4.E8.m1.2.2.1"><minus id="S4.E8.m1.2.2.1.2.cmml" xref="S4.E8.m1.2.2.1.2"></minus><apply id="S4.E8.m1.2.2.1.3.cmml" xref="S4.E8.m1.2.2.1.3"><times id="S4.E8.m1.2.2.1.3.1.cmml" xref="S4.E8.m1.2.2.1.3.1"></times><apply id="S4.E8.m1.1.1.cmml" xref="S4.E8.m1.1.1"><divide id="S4.E8.m1.1.1.2.cmml" xref="S4.E8.m1.1.1"></divide><cn type="integer" id="S4.E8.m1.1.1.3.cmml" xref="S4.E8.m1.1.1.3">1</cn><apply id="S4.E8.m1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1"><abs id="S4.E8.m1.1.1.1.2.1.cmml" xref="S4.E8.m1.1.1.1.1.2"></abs><apply id="S4.E8.m1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1.2">𝒟</ci><ci id="S4.E8.m1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.1.3">𝑛</ci></apply></apply></apply><apply id="S4.E8.m1.2.2.1.3.2.cmml" xref="S4.E8.m1.2.2.1.3.2"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.1.3.2.1.cmml" xref="S4.E8.m1.2.2.1.3.2">subscript</csymbol><sum id="S4.E8.m1.2.2.1.3.2.2.cmml" xref="S4.E8.m1.2.2.1.3.2.2"></sum><apply id="S4.E8.m1.2.2.1.3.2.3.cmml" xref="S4.E8.m1.2.2.1.3.2.3"><csymbol cd="latexml" id="S4.E8.m1.2.2.1.3.2.3.1.cmml" xref="S4.E8.m1.2.2.1.3.2.3.1">similar-to</csymbol><apply id="S4.E8.m1.2.2.1.3.2.3.2.cmml" xref="S4.E8.m1.2.2.1.3.2.3.2"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.1.3.2.3.2.1.cmml" xref="S4.E8.m1.2.2.1.3.2.3.2">subscript</csymbol><ci id="S4.E8.m1.2.2.1.3.2.3.2.2.cmml" xref="S4.E8.m1.2.2.1.3.2.3.2.2">𝐱</ci><ci id="S4.E8.m1.2.2.1.3.2.3.2.3.cmml" xref="S4.E8.m1.2.2.1.3.2.3.2.3">𝑖</ci></apply><apply id="S4.E8.m1.2.2.1.3.2.3.3.cmml" xref="S4.E8.m1.2.2.1.3.2.3.3"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.1.3.2.3.3.1.cmml" xref="S4.E8.m1.2.2.1.3.2.3.3">subscript</csymbol><ci id="S4.E8.m1.2.2.1.3.2.3.3.2.cmml" xref="S4.E8.m1.2.2.1.3.2.3.3.2">𝒟</ci><ci id="S4.E8.m1.2.2.1.3.2.3.3.3.cmml" xref="S4.E8.m1.2.2.1.3.2.3.3.3">𝑛</ci></apply></apply></apply></apply><apply id="S4.E8.m1.2.2.1.1.cmml" xref="S4.E8.m1.2.2.1.1"><times id="S4.E8.m1.2.2.1.1.2.cmml" xref="S4.E8.m1.2.2.1.1.2"></times><apply id="S4.E8.m1.2.2.1.1.3.cmml" xref="S4.E8.m1.2.2.1.1.3"><log id="S4.E8.m1.2.2.1.1.3.1.cmml" xref="S4.E8.m1.2.2.1.1.3.1"></log><ci id="S4.E8.m1.2.2.1.1.3.2.cmml" xref="S4.E8.m1.2.2.1.1.3.2">𝑝</ci></apply><apply id="S4.E8.m1.2.2.1.1.1.1.1.cmml" xref="S4.E8.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="S4.E8.m1.2.2.1.1.1.1.1.3.cmml" xref="S4.E8.m1.2.2.1.1.1.1.1.3">conditional</csymbol><apply id="S4.E8.m1.2.2.1.1.1.1.1.4.cmml" xref="S4.E8.m1.2.2.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.1.1.1.1.1.4.1.cmml" xref="S4.E8.m1.2.2.1.1.1.1.1.4">subscript</csymbol><apply id="S4.E8.m1.2.2.1.1.1.1.1.4.2.cmml" xref="S4.E8.m1.2.2.1.1.1.1.1.4.2"><ci id="S4.E8.m1.2.2.1.1.1.1.1.4.2.1.cmml" xref="S4.E8.m1.2.2.1.1.1.1.1.4.2.1">^</ci><ci id="S4.E8.m1.2.2.1.1.1.1.1.4.2.2.cmml" xref="S4.E8.m1.2.2.1.1.1.1.1.4.2.2">𝑦</ci></apply><ci id="S4.E8.m1.2.2.1.1.1.1.1.4.3.cmml" xref="S4.E8.m1.2.2.1.1.1.1.1.4.3">𝑖</ci></apply><list id="S4.E8.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S4.E8.m1.2.2.1.1.1.1.1.2.2"><apply id="S4.E8.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E8.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.2.2.1.1.1.1.1.1.1.1.2"><ci id="S4.E8.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.2.2.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S4.E8.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E8.m1.2.2.1.1.1.1.1.1.1.1.2.2">𝐱</ci></apply><ci id="S4.E8.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.2.2.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E8.m1.2.2.1.1.1.1.1.2.2.2.cmml" xref="S4.E8.m1.2.2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E8.m1.2.2.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E8.m1.2.2.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E8.m1.2.2.1.1.1.1.1.2.2.2.2">𝐩</ci><ci id="S4.E8.m1.2.2.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E8.m1.2.2.1.1.1.1.1.2.2.2.3">𝑛</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.2c">\displaystyle\mathcal{L}_{pseudo}=\frac{1}{\left|\mathcal{D}_{n}\right|}\sum_{\mathbf{x}_{i}\sim\mathcal{D}_{n}}-\log p\left(\hat{y}_{i}\mid\hat{\mathbf{x}}_{i},\mathbf{p}_{n}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p4.4" class="ltx_p">where <math id="S4.SS2.p4.1.m1.1" class="ltx_Math" alttext="\hat{y}_{i}" display="inline"><semantics id="S4.SS2.p4.1.m1.1a"><msub id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml"><mover accent="true" id="S4.SS2.p4.1.m1.1.1.2" xref="S4.SS2.p4.1.m1.1.1.2.cmml"><mi id="S4.SS2.p4.1.m1.1.1.2.2" xref="S4.SS2.p4.1.m1.1.1.2.2.cmml">y</mi><mo id="S4.SS2.p4.1.m1.1.1.2.1" xref="S4.SS2.p4.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS2.p4.1.m1.1.1.3" xref="S4.SS2.p4.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><apply id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">subscript</csymbol><apply id="S4.SS2.p4.1.m1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2"><ci id="S4.SS2.p4.1.m1.1.1.2.1.cmml" xref="S4.SS2.p4.1.m1.1.1.2.1">^</ci><ci id="S4.SS2.p4.1.m1.1.1.2.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2.2">𝑦</ci></apply><ci id="S4.SS2.p4.1.m1.1.1.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">\hat{y}_{i}</annotation></semantics></math> is the pseudo one-hot label of <math id="S4.SS2.p4.2.m2.1" class="ltx_Math" alttext="\mathbf{x}_{i}" display="inline"><semantics id="S4.SS2.p4.2.m2.1a"><msub id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml"><mi id="S4.SS2.p4.2.m2.1.1.2" xref="S4.SS2.p4.2.m2.1.1.2.cmml">𝐱</mi><mi id="S4.SS2.p4.2.m2.1.1.3" xref="S4.SS2.p4.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><apply id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.2.m2.1.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p4.2.m2.1.1.2.cmml" xref="S4.SS2.p4.2.m2.1.1.2">𝐱</ci><ci id="S4.SS2.p4.2.m2.1.1.3.cmml" xref="S4.SS2.p4.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">\mathbf{x}_{i}</annotation></semantics></math> predicted by the original CLIP, <math id="S4.SS2.p4.3.m3.1" class="ltx_Math" alttext="\hat{\mathbf{x}}_{i}" display="inline"><semantics id="S4.SS2.p4.3.m3.1a"><msub id="S4.SS2.p4.3.m3.1.1" xref="S4.SS2.p4.3.m3.1.1.cmml"><mover accent="true" id="S4.SS2.p4.3.m3.1.1.2" xref="S4.SS2.p4.3.m3.1.1.2.cmml"><mi id="S4.SS2.p4.3.m3.1.1.2.2" xref="S4.SS2.p4.3.m3.1.1.2.2.cmml">𝐱</mi><mo id="S4.SS2.p4.3.m3.1.1.2.1" xref="S4.SS2.p4.3.m3.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS2.p4.3.m3.1.1.3" xref="S4.SS2.p4.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.1b"><apply id="S4.SS2.p4.3.m3.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.3.m3.1.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1">subscript</csymbol><apply id="S4.SS2.p4.3.m3.1.1.2.cmml" xref="S4.SS2.p4.3.m3.1.1.2"><ci id="S4.SS2.p4.3.m3.1.1.2.1.cmml" xref="S4.SS2.p4.3.m3.1.1.2.1">^</ci><ci id="S4.SS2.p4.3.m3.1.1.2.2.cmml" xref="S4.SS2.p4.3.m3.1.1.2.2">𝐱</ci></apply><ci id="S4.SS2.p4.3.m3.1.1.3.cmml" xref="S4.SS2.p4.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">\hat{\mathbf{x}}_{i}</annotation></semantics></math> is the augmented version of <math id="S4.SS2.p4.4.m4.1" class="ltx_Math" alttext="\mathbf{x}_{i}" display="inline"><semantics id="S4.SS2.p4.4.m4.1a"><msub id="S4.SS2.p4.4.m4.1.1" xref="S4.SS2.p4.4.m4.1.1.cmml"><mi id="S4.SS2.p4.4.m4.1.1.2" xref="S4.SS2.p4.4.m4.1.1.2.cmml">𝐱</mi><mi id="S4.SS2.p4.4.m4.1.1.3" xref="S4.SS2.p4.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.4.m4.1b"><apply id="S4.SS2.p4.4.m4.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.4.m4.1.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p4.4.m4.1.1.2.cmml" xref="S4.SS2.p4.4.m4.1.1.2">𝐱</ci><ci id="S4.SS2.p4.4.m4.1.1.3.cmml" xref="S4.SS2.p4.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.4.m4.1c">\mathbf{x}_{i}</annotation></semantics></math>. After the first stage, we can get a coarse prompt.</p>
</div>
<div id="S4.SS2.p5" class="ltx_para">
<p id="S4.SS2.p5.3" class="ltx_p">In the second stage, use <math id="S4.SS2.p5.1.m1.1" class="ltx_Math" alttext="\mathbf{z}_{i}" display="inline"><semantics id="S4.SS2.p5.1.m1.1a"><msub id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1.cmml"><mi id="S4.SS2.p5.1.m1.1.1.2" xref="S4.SS2.p5.1.m1.1.1.2.cmml">𝐳</mi><mi id="S4.SS2.p5.1.m1.1.1.3" xref="S4.SS2.p5.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.1b"><apply id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.1.m1.1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p5.1.m1.1.1.2.cmml" xref="S4.SS2.p5.1.m1.1.1.2">𝐳</ci><ci id="S4.SS2.p5.1.m1.1.1.3.cmml" xref="S4.SS2.p5.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.1c">\mathbf{z}_{i}</annotation></semantics></math> to represent the prediction score vector of <math id="S4.SS2.p5.2.m2.1" class="ltx_Math" alttext="\mathbf{x}_{i}" display="inline"><semantics id="S4.SS2.p5.2.m2.1a"><msub id="S4.SS2.p5.2.m2.1.1" xref="S4.SS2.p5.2.m2.1.1.cmml"><mi id="S4.SS2.p5.2.m2.1.1.2" xref="S4.SS2.p5.2.m2.1.1.2.cmml">𝐱</mi><mi id="S4.SS2.p5.2.m2.1.1.3" xref="S4.SS2.p5.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.2.m2.1b"><apply id="S4.SS2.p5.2.m2.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.2.m2.1.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p5.2.m2.1.1.2.cmml" xref="S4.SS2.p5.2.m2.1.1.2">𝐱</ci><ci id="S4.SS2.p5.2.m2.1.1.3.cmml" xref="S4.SS2.p5.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.2.m2.1c">\mathbf{x}_{i}</annotation></semantics></math>, we hope to compare the outputs among different samples. For inter-sample comparison, motivated by AaDLoss <cite class="ltx_cite ltx_citemacro_citep">(Yang et al. <a href="#bib.bib42" title="" class="ltx_ref">2022</a>)</cite> in domain adaptation, for a certain sample, the logits of <math id="S4.SS2.p5.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS2.p5.3.m3.1a"><mi id="S4.SS2.p5.3.m3.1.1" xref="S4.SS2.p5.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.3.m3.1b"><ci id="S4.SS2.p5.3.m3.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.3.m3.1c">K</annotation></semantics></math>-nearest neighbor samples with similar image features should be as similar as possible, otherwise, there should be differences. Then the loss is:</p>
<table id="A2.EGx11" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E9.m1.2" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{inter}=\frac{1}{\left|\mathcal{D}_{n}\right|}\sum_{\mathbf{x}_{i}\sim\mathcal{D}_{n}}(-\sum_{j\in\mathcal{C}_{i}}\mathbf{z}_{i}^{\top}\mathbf{z}_{j}+\lambda\sum_{m\in\mathcal{B}_{i}}\mathbf{z}_{i}^{\top}\mathbf{z}_{m})" display="inline"><semantics id="S4.E9.m1.2a"><mrow id="S4.E9.m1.2.2" xref="S4.E9.m1.2.2.cmml"><msub id="S4.E9.m1.2.2.3" xref="S4.E9.m1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.2.2.3.2" xref="S4.E9.m1.2.2.3.2.cmml">ℒ</mi><mrow id="S4.E9.m1.2.2.3.3" xref="S4.E9.m1.2.2.3.3.cmml"><mi id="S4.E9.m1.2.2.3.3.2" xref="S4.E9.m1.2.2.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.3.3.1" xref="S4.E9.m1.2.2.3.3.1.cmml">​</mo><mi id="S4.E9.m1.2.2.3.3.3" xref="S4.E9.m1.2.2.3.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.3.3.1a" xref="S4.E9.m1.2.2.3.3.1.cmml">​</mo><mi id="S4.E9.m1.2.2.3.3.4" xref="S4.E9.m1.2.2.3.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.3.3.1b" xref="S4.E9.m1.2.2.3.3.1.cmml">​</mo><mi id="S4.E9.m1.2.2.3.3.5" xref="S4.E9.m1.2.2.3.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.3.3.1c" xref="S4.E9.m1.2.2.3.3.1.cmml">​</mo><mi id="S4.E9.m1.2.2.3.3.6" xref="S4.E9.m1.2.2.3.3.6.cmml">r</mi></mrow></msub><mo id="S4.E9.m1.2.2.2" xref="S4.E9.m1.2.2.2.cmml">=</mo><mrow id="S4.E9.m1.2.2.1" xref="S4.E9.m1.2.2.1.cmml"><mstyle displaystyle="true" id="S4.E9.m1.1.1" xref="S4.E9.m1.1.1.cmml"><mfrac id="S4.E9.m1.1.1a" xref="S4.E9.m1.1.1.cmml"><mn id="S4.E9.m1.1.1.3" xref="S4.E9.m1.1.1.3.cmml">1</mn><mrow id="S4.E9.m1.1.1.1.1" xref="S4.E9.m1.1.1.1.2.cmml"><mo id="S4.E9.m1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.2.1.cmml">|</mo><msub id="S4.E9.m1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S4.E9.m1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.3.cmml">n</mi></msub><mo id="S4.E9.m1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.1.2" xref="S4.E9.m1.2.2.1.2.cmml">​</mo><mrow id="S4.E9.m1.2.2.1.1" xref="S4.E9.m1.2.2.1.1.cmml"><mstyle displaystyle="true" id="S4.E9.m1.2.2.1.1.2" xref="S4.E9.m1.2.2.1.1.2.cmml"><munder id="S4.E9.m1.2.2.1.1.2a" xref="S4.E9.m1.2.2.1.1.2.cmml"><mo movablelimits="false" id="S4.E9.m1.2.2.1.1.2.2" xref="S4.E9.m1.2.2.1.1.2.2.cmml">∑</mo><mrow id="S4.E9.m1.2.2.1.1.2.3" xref="S4.E9.m1.2.2.1.1.2.3.cmml"><msub id="S4.E9.m1.2.2.1.1.2.3.2" xref="S4.E9.m1.2.2.1.1.2.3.2.cmml"><mi id="S4.E9.m1.2.2.1.1.2.3.2.2" xref="S4.E9.m1.2.2.1.1.2.3.2.2.cmml">𝐱</mi><mi id="S4.E9.m1.2.2.1.1.2.3.2.3" xref="S4.E9.m1.2.2.1.1.2.3.2.3.cmml">i</mi></msub><mo id="S4.E9.m1.2.2.1.1.2.3.1" xref="S4.E9.m1.2.2.1.1.2.3.1.cmml">∼</mo><msub id="S4.E9.m1.2.2.1.1.2.3.3" xref="S4.E9.m1.2.2.1.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.2.2.1.1.2.3.3.2" xref="S4.E9.m1.2.2.1.1.2.3.3.2.cmml">𝒟</mi><mi id="S4.E9.m1.2.2.1.1.2.3.3.3" xref="S4.E9.m1.2.2.1.1.2.3.3.3.cmml">n</mi></msub></mrow></munder></mstyle><mrow id="S4.E9.m1.2.2.1.1.1.1" xref="S4.E9.m1.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E9.m1.2.2.1.1.1.1.2" xref="S4.E9.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.2.2.1.1.1.1.1" xref="S4.E9.m1.2.2.1.1.1.1.1.cmml"><mrow id="S4.E9.m1.2.2.1.1.1.1.1.2" xref="S4.E9.m1.2.2.1.1.1.1.1.2.cmml"><mo id="S4.E9.m1.2.2.1.1.1.1.1.2a" xref="S4.E9.m1.2.2.1.1.1.1.1.2.cmml">−</mo><mrow id="S4.E9.m1.2.2.1.1.1.1.1.2.2" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.cmml"><mstyle displaystyle="true" id="S4.E9.m1.2.2.1.1.1.1.1.2.2.1" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.cmml"><munder id="S4.E9.m1.2.2.1.1.1.1.1.2.2.1a" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.cmml"><mo movablelimits="false" id="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.2" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.2.cmml">∑</mo><mrow id="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.3" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.3.cmml"><mi id="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.3.2" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.3.2.cmml">j</mi><mo id="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.3.1" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.3.1.cmml">∈</mo><msub id="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.3.3" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.3.3.2" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.3.3.2.cmml">𝒞</mi><mi id="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.3.3.3" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.3.3.3.cmml">i</mi></msub></mrow></munder></mstyle><mrow id="S4.E9.m1.2.2.1.1.1.1.1.2.2.2" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.cmml"><msubsup id="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.2" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.2.2.2" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.2.2.2.cmml">𝐳</mi><mi id="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.2.2.3" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.2.2.3.cmml">i</mi><mo id="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.2.3" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.2.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.1" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.1.cmml">​</mo><msub id="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.3" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.3.cmml"><mi id="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.3.2" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.3.2.cmml">𝐳</mi><mi id="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.3.3" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.3.3.cmml">j</mi></msub></mrow></mrow></mrow><mo id="S4.E9.m1.2.2.1.1.1.1.1.1" xref="S4.E9.m1.2.2.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.E9.m1.2.2.1.1.1.1.1.3" xref="S4.E9.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S4.E9.m1.2.2.1.1.1.1.1.3.2" xref="S4.E9.m1.2.2.1.1.1.1.1.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.1.1.1.1.1.3.1" xref="S4.E9.m1.2.2.1.1.1.1.1.3.1.cmml">​</mo><mrow id="S4.E9.m1.2.2.1.1.1.1.1.3.3" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.cmml"><mstyle displaystyle="true" id="S4.E9.m1.2.2.1.1.1.1.1.3.3.1" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.cmml"><munder id="S4.E9.m1.2.2.1.1.1.1.1.3.3.1a" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.cmml"><mo movablelimits="false" id="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.2" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.2.cmml">∑</mo><mrow id="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.3" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.3.cmml"><mi id="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.3.2" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.3.2.cmml">m</mi><mo id="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.3.1" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.3.1.cmml">∈</mo><msub id="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.3.3" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.3.3.2" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.3.3.2.cmml">ℬ</mi><mi id="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.3.3.3" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.3.3.3.cmml">i</mi></msub></mrow></munder></mstyle><mrow id="S4.E9.m1.2.2.1.1.1.1.1.3.3.2" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.cmml"><msubsup id="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.2" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.2.cmml"><mi id="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.2.2.2" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.2.2.2.cmml">𝐳</mi><mi id="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.2.2.3" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.2.2.3.cmml">i</mi><mo id="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.2.3" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.2.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.1" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.1.cmml">​</mo><msub id="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.3" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.3.cmml"><mi id="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.3.2" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.3.2.cmml">𝐳</mi><mi id="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.3.3" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.3.3.cmml">m</mi></msub></mrow></mrow></mrow></mrow><mo stretchy="false" id="S4.E9.m1.2.2.1.1.1.1.3" xref="S4.E9.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.2b"><apply id="S4.E9.m1.2.2.cmml" xref="S4.E9.m1.2.2"><eq id="S4.E9.m1.2.2.2.cmml" xref="S4.E9.m1.2.2.2"></eq><apply id="S4.E9.m1.2.2.3.cmml" xref="S4.E9.m1.2.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.3.1.cmml" xref="S4.E9.m1.2.2.3">subscript</csymbol><ci id="S4.E9.m1.2.2.3.2.cmml" xref="S4.E9.m1.2.2.3.2">ℒ</ci><apply id="S4.E9.m1.2.2.3.3.cmml" xref="S4.E9.m1.2.2.3.3"><times id="S4.E9.m1.2.2.3.3.1.cmml" xref="S4.E9.m1.2.2.3.3.1"></times><ci id="S4.E9.m1.2.2.3.3.2.cmml" xref="S4.E9.m1.2.2.3.3.2">𝑖</ci><ci id="S4.E9.m1.2.2.3.3.3.cmml" xref="S4.E9.m1.2.2.3.3.3">𝑛</ci><ci id="S4.E9.m1.2.2.3.3.4.cmml" xref="S4.E9.m1.2.2.3.3.4">𝑡</ci><ci id="S4.E9.m1.2.2.3.3.5.cmml" xref="S4.E9.m1.2.2.3.3.5">𝑒</ci><ci id="S4.E9.m1.2.2.3.3.6.cmml" xref="S4.E9.m1.2.2.3.3.6">𝑟</ci></apply></apply><apply id="S4.E9.m1.2.2.1.cmml" xref="S4.E9.m1.2.2.1"><times id="S4.E9.m1.2.2.1.2.cmml" xref="S4.E9.m1.2.2.1.2"></times><apply id="S4.E9.m1.1.1.cmml" xref="S4.E9.m1.1.1"><divide id="S4.E9.m1.1.1.2.cmml" xref="S4.E9.m1.1.1"></divide><cn type="integer" id="S4.E9.m1.1.1.3.cmml" xref="S4.E9.m1.1.1.3">1</cn><apply id="S4.E9.m1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1"><abs id="S4.E9.m1.1.1.1.2.1.cmml" xref="S4.E9.m1.1.1.1.1.2"></abs><apply id="S4.E9.m1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.2">𝒟</ci><ci id="S4.E9.m1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.1.3">𝑛</ci></apply></apply></apply><apply id="S4.E9.m1.2.2.1.1.cmml" xref="S4.E9.m1.2.2.1.1"><apply id="S4.E9.m1.2.2.1.1.2.cmml" xref="S4.E9.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.2.1.cmml" xref="S4.E9.m1.2.2.1.1.2">subscript</csymbol><sum id="S4.E9.m1.2.2.1.1.2.2.cmml" xref="S4.E9.m1.2.2.1.1.2.2"></sum><apply id="S4.E9.m1.2.2.1.1.2.3.cmml" xref="S4.E9.m1.2.2.1.1.2.3"><csymbol cd="latexml" id="S4.E9.m1.2.2.1.1.2.3.1.cmml" xref="S4.E9.m1.2.2.1.1.2.3.1">similar-to</csymbol><apply id="S4.E9.m1.2.2.1.1.2.3.2.cmml" xref="S4.E9.m1.2.2.1.1.2.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.2.3.2.1.cmml" xref="S4.E9.m1.2.2.1.1.2.3.2">subscript</csymbol><ci id="S4.E9.m1.2.2.1.1.2.3.2.2.cmml" xref="S4.E9.m1.2.2.1.1.2.3.2.2">𝐱</ci><ci id="S4.E9.m1.2.2.1.1.2.3.2.3.cmml" xref="S4.E9.m1.2.2.1.1.2.3.2.3">𝑖</ci></apply><apply id="S4.E9.m1.2.2.1.1.2.3.3.cmml" xref="S4.E9.m1.2.2.1.1.2.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.2.3.3.1.cmml" xref="S4.E9.m1.2.2.1.1.2.3.3">subscript</csymbol><ci id="S4.E9.m1.2.2.1.1.2.3.3.2.cmml" xref="S4.E9.m1.2.2.1.1.2.3.3.2">𝒟</ci><ci id="S4.E9.m1.2.2.1.1.2.3.3.3.cmml" xref="S4.E9.m1.2.2.1.1.2.3.3.3">𝑛</ci></apply></apply></apply><apply id="S4.E9.m1.2.2.1.1.1.1.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1"><plus id="S4.E9.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1"></plus><apply id="S4.E9.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.2"><minus id="S4.E9.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.2"></minus><apply id="S4.E9.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2"><apply id="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.1"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.1">subscript</csymbol><sum id="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.2"></sum><apply id="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.3"><in id="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.3.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.3.1"></in><ci id="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.3.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.3.2">𝑗</ci><apply id="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.3.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.3.3.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.3.3">subscript</csymbol><ci id="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.3.3.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.3.3.2">𝒞</ci><ci id="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.3.3.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.2"><times id="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.1"></times><apply id="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.2">superscript</csymbol><apply id="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.2.2.2">𝐳</ci><ci id="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.2.2.3">𝑖</ci></apply><csymbol cd="latexml" id="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.2.3">top</csymbol></apply><apply id="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.3.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.3">subscript</csymbol><ci id="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.3.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.3.2">𝐳</ci><ci id="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.3.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.2.2.2.3.3">𝑗</ci></apply></apply></apply></apply><apply id="S4.E9.m1.2.2.1.1.1.1.1.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3"><times id="S4.E9.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3.1"></times><ci id="S4.E9.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3.2">𝜆</ci><apply id="S4.E9.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3"><apply id="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.1">subscript</csymbol><sum id="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.2"></sum><apply id="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.3"><in id="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.3.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.3.1"></in><ci id="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.3.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.3.2">𝑚</ci><apply id="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.3.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.3.3.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.3.3">subscript</csymbol><ci id="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.3.3.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.3.3.2">ℬ</ci><ci id="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.3.3.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.2"><times id="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.1"></times><apply id="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.2.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.2">superscript</csymbol><apply id="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.2.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.2.2.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.2">subscript</csymbol><ci id="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.2.2.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.2.2.2">𝐳</ci><ci id="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.2.2.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.2.2.3">𝑖</ci></apply><csymbol cd="latexml" id="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.2.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.2.3">top</csymbol></apply><apply id="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.3.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.3">subscript</csymbol><ci id="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.3.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.3.2">𝐳</ci><ci id="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.3.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3.3.2.3.3">𝑚</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.2c">\displaystyle\mathcal{L}_{inter}=\frac{1}{\left|\mathcal{D}_{n}\right|}\sum_{\mathbf{x}_{i}\sim\mathcal{D}_{n}}(-\sum_{j\in\mathcal{C}_{i}}\mathbf{z}_{i}^{\top}\mathbf{z}_{j}+\lambda\sum_{m\in\mathcal{B}_{i}}\mathbf{z}_{i}^{\top}\mathbf{z}_{m})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p5.6" class="ltx_p">where <math id="S4.SS2.p5.4.m1.1" class="ltx_Math" alttext="\mathcal{C}_{i}" display="inline"><semantics id="S4.SS2.p5.4.m1.1a"><msub id="S4.SS2.p5.4.m1.1.1" xref="S4.SS2.p5.4.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p5.4.m1.1.1.2" xref="S4.SS2.p5.4.m1.1.1.2.cmml">𝒞</mi><mi id="S4.SS2.p5.4.m1.1.1.3" xref="S4.SS2.p5.4.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.4.m1.1b"><apply id="S4.SS2.p5.4.m1.1.1.cmml" xref="S4.SS2.p5.4.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.4.m1.1.1.1.cmml" xref="S4.SS2.p5.4.m1.1.1">subscript</csymbol><ci id="S4.SS2.p5.4.m1.1.1.2.cmml" xref="S4.SS2.p5.4.m1.1.1.2">𝒞</ci><ci id="S4.SS2.p5.4.m1.1.1.3.cmml" xref="S4.SS2.p5.4.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.4.m1.1c">\mathcal{C}_{i}</annotation></semantics></math> contains <math id="S4.SS2.p5.5.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS2.p5.5.m2.1a"><mi id="S4.SS2.p5.5.m2.1.1" xref="S4.SS2.p5.5.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.5.m2.1b"><ci id="S4.SS2.p5.5.m2.1.1.cmml" xref="S4.SS2.p5.5.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.5.m2.1c">K</annotation></semantics></math>-nearest neighbors, <math id="S4.SS2.p5.6.m3.1" class="ltx_Math" alttext="\mathcal{B}_{i}" display="inline"><semantics id="S4.SS2.p5.6.m3.1a"><msub id="S4.SS2.p5.6.m3.1.1" xref="S4.SS2.p5.6.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p5.6.m3.1.1.2" xref="S4.SS2.p5.6.m3.1.1.2.cmml">ℬ</mi><mi id="S4.SS2.p5.6.m3.1.1.3" xref="S4.SS2.p5.6.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.6.m3.1b"><apply id="S4.SS2.p5.6.m3.1.1.cmml" xref="S4.SS2.p5.6.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.6.m3.1.1.1.cmml" xref="S4.SS2.p5.6.m3.1.1">subscript</csymbol><ci id="S4.SS2.p5.6.m3.1.1.2.cmml" xref="S4.SS2.p5.6.m3.1.1.2">ℬ</ci><ci id="S4.SS2.p5.6.m3.1.1.3.cmml" xref="S4.SS2.p5.6.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.6.m3.1c">\mathcal{B}_{i}</annotation></semantics></math> contains the rest samples. A feature bank and a score bank are used to efficiently implement this loss.</p>
</div>
<div id="S4.SS2.p6" class="ltx_para">
<p id="S4.SS2.p6.4" class="ltx_p">As for intra-sample comparison, we need that the prediction of a sample is close to that of its augmented counterpart:</p>
<table id="A2.EGx12" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E10.m1.2" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{intra}=\frac{1}{\left|\mathcal{D}_{n}\right|}\sum_{\mathbf{x}_{i}\sim\mathcal{D}_{n}}KL(\hat{\mathbf{z}}_{i}\|\mathbf{z}_{i})" display="inline"><semantics id="S4.E10.m1.2a"><mrow id="S4.E10.m1.2.2" xref="S4.E10.m1.2.2.cmml"><msub id="S4.E10.m1.2.2.3" xref="S4.E10.m1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.2.2.3.2" xref="S4.E10.m1.2.2.3.2.cmml">ℒ</mi><mrow id="S4.E10.m1.2.2.3.3" xref="S4.E10.m1.2.2.3.3.cmml"><mi id="S4.E10.m1.2.2.3.3.2" xref="S4.E10.m1.2.2.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E10.m1.2.2.3.3.1" xref="S4.E10.m1.2.2.3.3.1.cmml">​</mo><mi id="S4.E10.m1.2.2.3.3.3" xref="S4.E10.m1.2.2.3.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.E10.m1.2.2.3.3.1a" xref="S4.E10.m1.2.2.3.3.1.cmml">​</mo><mi id="S4.E10.m1.2.2.3.3.4" xref="S4.E10.m1.2.2.3.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E10.m1.2.2.3.3.1b" xref="S4.E10.m1.2.2.3.3.1.cmml">​</mo><mi id="S4.E10.m1.2.2.3.3.5" xref="S4.E10.m1.2.2.3.3.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.E10.m1.2.2.3.3.1c" xref="S4.E10.m1.2.2.3.3.1.cmml">​</mo><mi id="S4.E10.m1.2.2.3.3.6" xref="S4.E10.m1.2.2.3.3.6.cmml">a</mi></mrow></msub><mo id="S4.E10.m1.2.2.2" xref="S4.E10.m1.2.2.2.cmml">=</mo><mrow id="S4.E10.m1.2.2.1" xref="S4.E10.m1.2.2.1.cmml"><mstyle displaystyle="true" id="S4.E10.m1.1.1" xref="S4.E10.m1.1.1.cmml"><mfrac id="S4.E10.m1.1.1a" xref="S4.E10.m1.1.1.cmml"><mn id="S4.E10.m1.1.1.3" xref="S4.E10.m1.1.1.3.cmml">1</mn><mrow id="S4.E10.m1.1.1.1.1" xref="S4.E10.m1.1.1.1.2.cmml"><mo id="S4.E10.m1.1.1.1.1.2" xref="S4.E10.m1.1.1.1.2.1.cmml">|</mo><msub id="S4.E10.m1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.1.1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S4.E10.m1.1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.1.3.cmml">n</mi></msub><mo id="S4.E10.m1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E10.m1.2.2.1.2" xref="S4.E10.m1.2.2.1.2.cmml">​</mo><mrow id="S4.E10.m1.2.2.1.1" xref="S4.E10.m1.2.2.1.1.cmml"><mstyle displaystyle="true" id="S4.E10.m1.2.2.1.1.2" xref="S4.E10.m1.2.2.1.1.2.cmml"><munder id="S4.E10.m1.2.2.1.1.2a" xref="S4.E10.m1.2.2.1.1.2.cmml"><mo movablelimits="false" id="S4.E10.m1.2.2.1.1.2.2" xref="S4.E10.m1.2.2.1.1.2.2.cmml">∑</mo><mrow id="S4.E10.m1.2.2.1.1.2.3" xref="S4.E10.m1.2.2.1.1.2.3.cmml"><msub id="S4.E10.m1.2.2.1.1.2.3.2" xref="S4.E10.m1.2.2.1.1.2.3.2.cmml"><mi id="S4.E10.m1.2.2.1.1.2.3.2.2" xref="S4.E10.m1.2.2.1.1.2.3.2.2.cmml">𝐱</mi><mi id="S4.E10.m1.2.2.1.1.2.3.2.3" xref="S4.E10.m1.2.2.1.1.2.3.2.3.cmml">i</mi></msub><mo id="S4.E10.m1.2.2.1.1.2.3.1" xref="S4.E10.m1.2.2.1.1.2.3.1.cmml">∼</mo><msub id="S4.E10.m1.2.2.1.1.2.3.3" xref="S4.E10.m1.2.2.1.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.2.2.1.1.2.3.3.2" xref="S4.E10.m1.2.2.1.1.2.3.3.2.cmml">𝒟</mi><mi id="S4.E10.m1.2.2.1.1.2.3.3.3" xref="S4.E10.m1.2.2.1.1.2.3.3.3.cmml">n</mi></msub></mrow></munder></mstyle><mrow id="S4.E10.m1.2.2.1.1.1" xref="S4.E10.m1.2.2.1.1.1.cmml"><mi id="S4.E10.m1.2.2.1.1.1.3" xref="S4.E10.m1.2.2.1.1.1.3.cmml">K</mi><mo lspace="0em" rspace="0em" id="S4.E10.m1.2.2.1.1.1.2" xref="S4.E10.m1.2.2.1.1.1.2.cmml">​</mo><mi id="S4.E10.m1.2.2.1.1.1.4" xref="S4.E10.m1.2.2.1.1.1.4.cmml">L</mi><mo lspace="0em" rspace="0em" id="S4.E10.m1.2.2.1.1.1.2a" xref="S4.E10.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S4.E10.m1.2.2.1.1.1.1.1" xref="S4.E10.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E10.m1.2.2.1.1.1.1.1.2" xref="S4.E10.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E10.m1.2.2.1.1.1.1.1.1" xref="S4.E10.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S4.E10.m1.2.2.1.1.1.1.1.1.2" xref="S4.E10.m1.2.2.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S4.E10.m1.2.2.1.1.1.1.1.1.2.2" xref="S4.E10.m1.2.2.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E10.m1.2.2.1.1.1.1.1.1.2.2.2" xref="S4.E10.m1.2.2.1.1.1.1.1.1.2.2.2.cmml">𝐳</mi><mo id="S4.E10.m1.2.2.1.1.1.1.1.1.2.2.1" xref="S4.E10.m1.2.2.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.E10.m1.2.2.1.1.1.1.1.1.2.3" xref="S4.E10.m1.2.2.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S4.E10.m1.2.2.1.1.1.1.1.1.1" xref="S4.E10.m1.2.2.1.1.1.1.1.1.1.cmml">∥</mo><msub id="S4.E10.m1.2.2.1.1.1.1.1.1.3" xref="S4.E10.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S4.E10.m1.2.2.1.1.1.1.1.1.3.2" xref="S4.E10.m1.2.2.1.1.1.1.1.1.3.2.cmml">𝐳</mi><mi id="S4.E10.m1.2.2.1.1.1.1.1.1.3.3" xref="S4.E10.m1.2.2.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S4.E10.m1.2.2.1.1.1.1.1.3" xref="S4.E10.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.2b"><apply id="S4.E10.m1.2.2.cmml" xref="S4.E10.m1.2.2"><eq id="S4.E10.m1.2.2.2.cmml" xref="S4.E10.m1.2.2.2"></eq><apply id="S4.E10.m1.2.2.3.cmml" xref="S4.E10.m1.2.2.3"><csymbol cd="ambiguous" id="S4.E10.m1.2.2.3.1.cmml" xref="S4.E10.m1.2.2.3">subscript</csymbol><ci id="S4.E10.m1.2.2.3.2.cmml" xref="S4.E10.m1.2.2.3.2">ℒ</ci><apply id="S4.E10.m1.2.2.3.3.cmml" xref="S4.E10.m1.2.2.3.3"><times id="S4.E10.m1.2.2.3.3.1.cmml" xref="S4.E10.m1.2.2.3.3.1"></times><ci id="S4.E10.m1.2.2.3.3.2.cmml" xref="S4.E10.m1.2.2.3.3.2">𝑖</ci><ci id="S4.E10.m1.2.2.3.3.3.cmml" xref="S4.E10.m1.2.2.3.3.3">𝑛</ci><ci id="S4.E10.m1.2.2.3.3.4.cmml" xref="S4.E10.m1.2.2.3.3.4">𝑡</ci><ci id="S4.E10.m1.2.2.3.3.5.cmml" xref="S4.E10.m1.2.2.3.3.5">𝑟</ci><ci id="S4.E10.m1.2.2.3.3.6.cmml" xref="S4.E10.m1.2.2.3.3.6">𝑎</ci></apply></apply><apply id="S4.E10.m1.2.2.1.cmml" xref="S4.E10.m1.2.2.1"><times id="S4.E10.m1.2.2.1.2.cmml" xref="S4.E10.m1.2.2.1.2"></times><apply id="S4.E10.m1.1.1.cmml" xref="S4.E10.m1.1.1"><divide id="S4.E10.m1.1.1.2.cmml" xref="S4.E10.m1.1.1"></divide><cn type="integer" id="S4.E10.m1.1.1.3.cmml" xref="S4.E10.m1.1.1.3">1</cn><apply id="S4.E10.m1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1"><abs id="S4.E10.m1.1.1.1.2.1.cmml" xref="S4.E10.m1.1.1.1.1.2"></abs><apply id="S4.E10.m1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.2">𝒟</ci><ci id="S4.E10.m1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.1.3">𝑛</ci></apply></apply></apply><apply id="S4.E10.m1.2.2.1.1.cmml" xref="S4.E10.m1.2.2.1.1"><apply id="S4.E10.m1.2.2.1.1.2.cmml" xref="S4.E10.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.E10.m1.2.2.1.1.2.1.cmml" xref="S4.E10.m1.2.2.1.1.2">subscript</csymbol><sum id="S4.E10.m1.2.2.1.1.2.2.cmml" xref="S4.E10.m1.2.2.1.1.2.2"></sum><apply id="S4.E10.m1.2.2.1.1.2.3.cmml" xref="S4.E10.m1.2.2.1.1.2.3"><csymbol cd="latexml" id="S4.E10.m1.2.2.1.1.2.3.1.cmml" xref="S4.E10.m1.2.2.1.1.2.3.1">similar-to</csymbol><apply id="S4.E10.m1.2.2.1.1.2.3.2.cmml" xref="S4.E10.m1.2.2.1.1.2.3.2"><csymbol cd="ambiguous" id="S4.E10.m1.2.2.1.1.2.3.2.1.cmml" xref="S4.E10.m1.2.2.1.1.2.3.2">subscript</csymbol><ci id="S4.E10.m1.2.2.1.1.2.3.2.2.cmml" xref="S4.E10.m1.2.2.1.1.2.3.2.2">𝐱</ci><ci id="S4.E10.m1.2.2.1.1.2.3.2.3.cmml" xref="S4.E10.m1.2.2.1.1.2.3.2.3">𝑖</ci></apply><apply id="S4.E10.m1.2.2.1.1.2.3.3.cmml" xref="S4.E10.m1.2.2.1.1.2.3.3"><csymbol cd="ambiguous" id="S4.E10.m1.2.2.1.1.2.3.3.1.cmml" xref="S4.E10.m1.2.2.1.1.2.3.3">subscript</csymbol><ci id="S4.E10.m1.2.2.1.1.2.3.3.2.cmml" xref="S4.E10.m1.2.2.1.1.2.3.3.2">𝒟</ci><ci id="S4.E10.m1.2.2.1.1.2.3.3.3.cmml" xref="S4.E10.m1.2.2.1.1.2.3.3.3">𝑛</ci></apply></apply></apply><apply id="S4.E10.m1.2.2.1.1.1.cmml" xref="S4.E10.m1.2.2.1.1.1"><times id="S4.E10.m1.2.2.1.1.1.2.cmml" xref="S4.E10.m1.2.2.1.1.1.2"></times><ci id="S4.E10.m1.2.2.1.1.1.3.cmml" xref="S4.E10.m1.2.2.1.1.1.3">𝐾</ci><ci id="S4.E10.m1.2.2.1.1.1.4.cmml" xref="S4.E10.m1.2.2.1.1.1.4">𝐿</ci><apply id="S4.E10.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E10.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S4.E10.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.2.2.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.E10.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E10.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S4.E10.m1.2.2.1.1.1.1.1.1.2">subscript</csymbol><apply id="S4.E10.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S4.E10.m1.2.2.1.1.1.1.1.1.2.2"><ci id="S4.E10.m1.2.2.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E10.m1.2.2.1.1.1.1.1.1.2.2.1">^</ci><ci id="S4.E10.m1.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E10.m1.2.2.1.1.1.1.1.1.2.2.2">𝐳</ci></apply><ci id="S4.E10.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S4.E10.m1.2.2.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S4.E10.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S4.E10.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E10.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S4.E10.m1.2.2.1.1.1.1.1.1.3.2">𝐳</ci><ci id="S4.E10.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S4.E10.m1.2.2.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.2c">\displaystyle\mathcal{L}_{intra}=\frac{1}{\left|\mathcal{D}_{n}\right|}\sum_{\mathbf{x}_{i}\sim\mathcal{D}_{n}}KL(\hat{\mathbf{z}}_{i}\|\mathbf{z}_{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p6.3" class="ltx_p">where <math id="S4.SS2.p6.1.m1.1" class="ltx_Math" alttext="\hat{\mathbf{z}}_{i}" display="inline"><semantics id="S4.SS2.p6.1.m1.1a"><msub id="S4.SS2.p6.1.m1.1.1" xref="S4.SS2.p6.1.m1.1.1.cmml"><mover accent="true" id="S4.SS2.p6.1.m1.1.1.2" xref="S4.SS2.p6.1.m1.1.1.2.cmml"><mi id="S4.SS2.p6.1.m1.1.1.2.2" xref="S4.SS2.p6.1.m1.1.1.2.2.cmml">𝐳</mi><mo id="S4.SS2.p6.1.m1.1.1.2.1" xref="S4.SS2.p6.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS2.p6.1.m1.1.1.3" xref="S4.SS2.p6.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.1.m1.1b"><apply id="S4.SS2.p6.1.m1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p6.1.m1.1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1">subscript</csymbol><apply id="S4.SS2.p6.1.m1.1.1.2.cmml" xref="S4.SS2.p6.1.m1.1.1.2"><ci id="S4.SS2.p6.1.m1.1.1.2.1.cmml" xref="S4.SS2.p6.1.m1.1.1.2.1">^</ci><ci id="S4.SS2.p6.1.m1.1.1.2.2.cmml" xref="S4.SS2.p6.1.m1.1.1.2.2">𝐳</ci></apply><ci id="S4.SS2.p6.1.m1.1.1.3.cmml" xref="S4.SS2.p6.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.1.m1.1c">\hat{\mathbf{z}}_{i}</annotation></semantics></math> is the predict score of the augment data, <math id="S4.SS2.p6.2.m2.1" class="ltx_Math" alttext="\mathbf{z}_{i}" display="inline"><semantics id="S4.SS2.p6.2.m2.1a"><msub id="S4.SS2.p6.2.m2.1.1" xref="S4.SS2.p6.2.m2.1.1.cmml"><mi id="S4.SS2.p6.2.m2.1.1.2" xref="S4.SS2.p6.2.m2.1.1.2.cmml">𝐳</mi><mi id="S4.SS2.p6.2.m2.1.1.3" xref="S4.SS2.p6.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.2.m2.1b"><apply id="S4.SS2.p6.2.m2.1.1.cmml" xref="S4.SS2.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p6.2.m2.1.1.1.cmml" xref="S4.SS2.p6.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p6.2.m2.1.1.2.cmml" xref="S4.SS2.p6.2.m2.1.1.2">𝐳</ci><ci id="S4.SS2.p6.2.m2.1.1.3.cmml" xref="S4.SS2.p6.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.2.m2.1c">\mathbf{z}_{i}</annotation></semantics></math> is extracted from the score bank. Then the overall loss in the second stage is <math id="S4.SS2.p6.3.m3.1" class="ltx_Math" alttext="\mathcal{L}_{c}=\mathcal{L}_{inter}+\mathcal{L}_{intra}" display="inline"><semantics id="S4.SS2.p6.3.m3.1a"><mrow id="S4.SS2.p6.3.m3.1.1" xref="S4.SS2.p6.3.m3.1.1.cmml"><msub id="S4.SS2.p6.3.m3.1.1.2" xref="S4.SS2.p6.3.m3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p6.3.m3.1.1.2.2" xref="S4.SS2.p6.3.m3.1.1.2.2.cmml">ℒ</mi><mi id="S4.SS2.p6.3.m3.1.1.2.3" xref="S4.SS2.p6.3.m3.1.1.2.3.cmml">c</mi></msub><mo id="S4.SS2.p6.3.m3.1.1.1" xref="S4.SS2.p6.3.m3.1.1.1.cmml">=</mo><mrow id="S4.SS2.p6.3.m3.1.1.3" xref="S4.SS2.p6.3.m3.1.1.3.cmml"><msub id="S4.SS2.p6.3.m3.1.1.3.2" xref="S4.SS2.p6.3.m3.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p6.3.m3.1.1.3.2.2" xref="S4.SS2.p6.3.m3.1.1.3.2.2.cmml">ℒ</mi><mrow id="S4.SS2.p6.3.m3.1.1.3.2.3" xref="S4.SS2.p6.3.m3.1.1.3.2.3.cmml"><mi id="S4.SS2.p6.3.m3.1.1.3.2.3.2" xref="S4.SS2.p6.3.m3.1.1.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p6.3.m3.1.1.3.2.3.1" xref="S4.SS2.p6.3.m3.1.1.3.2.3.1.cmml">​</mo><mi id="S4.SS2.p6.3.m3.1.1.3.2.3.3" xref="S4.SS2.p6.3.m3.1.1.3.2.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p6.3.m3.1.1.3.2.3.1a" xref="S4.SS2.p6.3.m3.1.1.3.2.3.1.cmml">​</mo><mi id="S4.SS2.p6.3.m3.1.1.3.2.3.4" xref="S4.SS2.p6.3.m3.1.1.3.2.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p6.3.m3.1.1.3.2.3.1b" xref="S4.SS2.p6.3.m3.1.1.3.2.3.1.cmml">​</mo><mi id="S4.SS2.p6.3.m3.1.1.3.2.3.5" xref="S4.SS2.p6.3.m3.1.1.3.2.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p6.3.m3.1.1.3.2.3.1c" xref="S4.SS2.p6.3.m3.1.1.3.2.3.1.cmml">​</mo><mi id="S4.SS2.p6.3.m3.1.1.3.2.3.6" xref="S4.SS2.p6.3.m3.1.1.3.2.3.6.cmml">r</mi></mrow></msub><mo id="S4.SS2.p6.3.m3.1.1.3.1" xref="S4.SS2.p6.3.m3.1.1.3.1.cmml">+</mo><msub id="S4.SS2.p6.3.m3.1.1.3.3" xref="S4.SS2.p6.3.m3.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p6.3.m3.1.1.3.3.2" xref="S4.SS2.p6.3.m3.1.1.3.3.2.cmml">ℒ</mi><mrow id="S4.SS2.p6.3.m3.1.1.3.3.3" xref="S4.SS2.p6.3.m3.1.1.3.3.3.cmml"><mi id="S4.SS2.p6.3.m3.1.1.3.3.3.2" xref="S4.SS2.p6.3.m3.1.1.3.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p6.3.m3.1.1.3.3.3.1" xref="S4.SS2.p6.3.m3.1.1.3.3.3.1.cmml">​</mo><mi id="S4.SS2.p6.3.m3.1.1.3.3.3.3" xref="S4.SS2.p6.3.m3.1.1.3.3.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p6.3.m3.1.1.3.3.3.1a" xref="S4.SS2.p6.3.m3.1.1.3.3.3.1.cmml">​</mo><mi id="S4.SS2.p6.3.m3.1.1.3.3.3.4" xref="S4.SS2.p6.3.m3.1.1.3.3.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p6.3.m3.1.1.3.3.3.1b" xref="S4.SS2.p6.3.m3.1.1.3.3.3.1.cmml">​</mo><mi id="S4.SS2.p6.3.m3.1.1.3.3.3.5" xref="S4.SS2.p6.3.m3.1.1.3.3.3.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p6.3.m3.1.1.3.3.3.1c" xref="S4.SS2.p6.3.m3.1.1.3.3.3.1.cmml">​</mo><mi id="S4.SS2.p6.3.m3.1.1.3.3.3.6" xref="S4.SS2.p6.3.m3.1.1.3.3.3.6.cmml">a</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.3.m3.1b"><apply id="S4.SS2.p6.3.m3.1.1.cmml" xref="S4.SS2.p6.3.m3.1.1"><eq id="S4.SS2.p6.3.m3.1.1.1.cmml" xref="S4.SS2.p6.3.m3.1.1.1"></eq><apply id="S4.SS2.p6.3.m3.1.1.2.cmml" xref="S4.SS2.p6.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p6.3.m3.1.1.2.1.cmml" xref="S4.SS2.p6.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS2.p6.3.m3.1.1.2.2.cmml" xref="S4.SS2.p6.3.m3.1.1.2.2">ℒ</ci><ci id="S4.SS2.p6.3.m3.1.1.2.3.cmml" xref="S4.SS2.p6.3.m3.1.1.2.3">𝑐</ci></apply><apply id="S4.SS2.p6.3.m3.1.1.3.cmml" xref="S4.SS2.p6.3.m3.1.1.3"><plus id="S4.SS2.p6.3.m3.1.1.3.1.cmml" xref="S4.SS2.p6.3.m3.1.1.3.1"></plus><apply id="S4.SS2.p6.3.m3.1.1.3.2.cmml" xref="S4.SS2.p6.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.p6.3.m3.1.1.3.2.1.cmml" xref="S4.SS2.p6.3.m3.1.1.3.2">subscript</csymbol><ci id="S4.SS2.p6.3.m3.1.1.3.2.2.cmml" xref="S4.SS2.p6.3.m3.1.1.3.2.2">ℒ</ci><apply id="S4.SS2.p6.3.m3.1.1.3.2.3.cmml" xref="S4.SS2.p6.3.m3.1.1.3.2.3"><times id="S4.SS2.p6.3.m3.1.1.3.2.3.1.cmml" xref="S4.SS2.p6.3.m3.1.1.3.2.3.1"></times><ci id="S4.SS2.p6.3.m3.1.1.3.2.3.2.cmml" xref="S4.SS2.p6.3.m3.1.1.3.2.3.2">𝑖</ci><ci id="S4.SS2.p6.3.m3.1.1.3.2.3.3.cmml" xref="S4.SS2.p6.3.m3.1.1.3.2.3.3">𝑛</ci><ci id="S4.SS2.p6.3.m3.1.1.3.2.3.4.cmml" xref="S4.SS2.p6.3.m3.1.1.3.2.3.4">𝑡</ci><ci id="S4.SS2.p6.3.m3.1.1.3.2.3.5.cmml" xref="S4.SS2.p6.3.m3.1.1.3.2.3.5">𝑒</ci><ci id="S4.SS2.p6.3.m3.1.1.3.2.3.6.cmml" xref="S4.SS2.p6.3.m3.1.1.3.2.3.6">𝑟</ci></apply></apply><apply id="S4.SS2.p6.3.m3.1.1.3.3.cmml" xref="S4.SS2.p6.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p6.3.m3.1.1.3.3.1.cmml" xref="S4.SS2.p6.3.m3.1.1.3.3">subscript</csymbol><ci id="S4.SS2.p6.3.m3.1.1.3.3.2.cmml" xref="S4.SS2.p6.3.m3.1.1.3.3.2">ℒ</ci><apply id="S4.SS2.p6.3.m3.1.1.3.3.3.cmml" xref="S4.SS2.p6.3.m3.1.1.3.3.3"><times id="S4.SS2.p6.3.m3.1.1.3.3.3.1.cmml" xref="S4.SS2.p6.3.m3.1.1.3.3.3.1"></times><ci id="S4.SS2.p6.3.m3.1.1.3.3.3.2.cmml" xref="S4.SS2.p6.3.m3.1.1.3.3.3.2">𝑖</ci><ci id="S4.SS2.p6.3.m3.1.1.3.3.3.3.cmml" xref="S4.SS2.p6.3.m3.1.1.3.3.3.3">𝑛</ci><ci id="S4.SS2.p6.3.m3.1.1.3.3.3.4.cmml" xref="S4.SS2.p6.3.m3.1.1.3.3.3.4">𝑡</ci><ci id="S4.SS2.p6.3.m3.1.1.3.3.3.5.cmml" xref="S4.SS2.p6.3.m3.1.1.3.3.3.5">𝑟</ci><ci id="S4.SS2.p6.3.m3.1.1.3.3.3.6.cmml" xref="S4.SS2.p6.3.m3.1.1.3.3.3.6">𝑎</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.3.m3.1c">\mathcal{L}_{c}=\mathcal{L}_{inter}+\mathcal{L}_{intra}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS2.p7" class="ltx_para">
<p id="S4.SS2.p7.3" class="ltx_p">The adaptive network <math id="S4.SS2.p7.1.m1.1" class="ltx_Math" alttext="\mathcal{Q}_{n}(\cdot)" display="inline"><semantics id="S4.SS2.p7.1.m1.1a"><mrow id="S4.SS2.p7.1.m1.1.2" xref="S4.SS2.p7.1.m1.1.2.cmml"><msub id="S4.SS2.p7.1.m1.1.2.2" xref="S4.SS2.p7.1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p7.1.m1.1.2.2.2" xref="S4.SS2.p7.1.m1.1.2.2.2.cmml">𝒬</mi><mi id="S4.SS2.p7.1.m1.1.2.2.3" xref="S4.SS2.p7.1.m1.1.2.2.3.cmml">n</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p7.1.m1.1.2.1" xref="S4.SS2.p7.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS2.p7.1.m1.1.2.3.2" xref="S4.SS2.p7.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p7.1.m1.1.2.3.2.1" xref="S4.SS2.p7.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p7.1.m1.1.1" xref="S4.SS2.p7.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.p7.1.m1.1.2.3.2.2" xref="S4.SS2.p7.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p7.1.m1.1b"><apply id="S4.SS2.p7.1.m1.1.2.cmml" xref="S4.SS2.p7.1.m1.1.2"><times id="S4.SS2.p7.1.m1.1.2.1.cmml" xref="S4.SS2.p7.1.m1.1.2.1"></times><apply id="S4.SS2.p7.1.m1.1.2.2.cmml" xref="S4.SS2.p7.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p7.1.m1.1.2.2.1.cmml" xref="S4.SS2.p7.1.m1.1.2.2">subscript</csymbol><ci id="S4.SS2.p7.1.m1.1.2.2.2.cmml" xref="S4.SS2.p7.1.m1.1.2.2.2">𝒬</ci><ci id="S4.SS2.p7.1.m1.1.2.2.3.cmml" xref="S4.SS2.p7.1.m1.1.2.2.3">𝑛</ci></apply><ci id="S4.SS2.p7.1.m1.1.1.cmml" xref="S4.SS2.p7.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p7.1.m1.1c">\mathcal{Q}_{n}(\cdot)</annotation></semantics></math> is a fully-connection layer with parameters <math id="S4.SS2.p7.2.m2.1" class="ltx_Math" alttext="\phi_{n}" display="inline"><semantics id="S4.SS2.p7.2.m2.1a"><msub id="S4.SS2.p7.2.m2.1.1" xref="S4.SS2.p7.2.m2.1.1.cmml"><mi id="S4.SS2.p7.2.m2.1.1.2" xref="S4.SS2.p7.2.m2.1.1.2.cmml">ϕ</mi><mi id="S4.SS2.p7.2.m2.1.1.3" xref="S4.SS2.p7.2.m2.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p7.2.m2.1b"><apply id="S4.SS2.p7.2.m2.1.1.cmml" xref="S4.SS2.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p7.2.m2.1.1.1.cmml" xref="S4.SS2.p7.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p7.2.m2.1.1.2.cmml" xref="S4.SS2.p7.2.m2.1.1.2">italic-ϕ</ci><ci id="S4.SS2.p7.2.m2.1.1.3.cmml" xref="S4.SS2.p7.2.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p7.2.m2.1c">\phi_{n}</annotation></semantics></math>, which tries to classify domain information from the features of images. Each client in the <math id="S4.SS2.p7.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.p7.3.m3.1a"><mi id="S4.SS2.p7.3.m3.1.1" xref="S4.SS2.p7.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p7.3.m3.1b"><ci id="S4.SS2.p7.3.m3.1.1.cmml" xref="S4.SS2.p7.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p7.3.m3.1c">k</annotation></semantics></math>-th domain trains its own adaptive network with the following cross-entropy loss:</p>
<table id="A2.EGx13" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E11.m1.2" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{q}=\frac{1}{\left|\mathcal{D}_{n}\right|}\sum_{\boldsymbol{x}\in\mathcal{D}_{n}}-\log p\left(k\mid\mathbf{x}_{i},\phi_{n}\right)" display="inline"><semantics id="S4.E11.m1.2a"><mrow id="S4.E11.m1.2.2" xref="S4.E11.m1.2.2.cmml"><msub id="S4.E11.m1.2.2.3" xref="S4.E11.m1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.2.2.3.2" xref="S4.E11.m1.2.2.3.2.cmml">ℒ</mi><mi id="S4.E11.m1.2.2.3.3" xref="S4.E11.m1.2.2.3.3.cmml">q</mi></msub><mo id="S4.E11.m1.2.2.2" xref="S4.E11.m1.2.2.2.cmml">=</mo><mrow id="S4.E11.m1.2.2.1" xref="S4.E11.m1.2.2.1.cmml"><mrow id="S4.E11.m1.2.2.1.3" xref="S4.E11.m1.2.2.1.3.cmml"><mstyle displaystyle="true" id="S4.E11.m1.1.1" xref="S4.E11.m1.1.1.cmml"><mfrac id="S4.E11.m1.1.1a" xref="S4.E11.m1.1.1.cmml"><mn id="S4.E11.m1.1.1.3" xref="S4.E11.m1.1.1.3.cmml">1</mn><mrow id="S4.E11.m1.1.1.1.1" xref="S4.E11.m1.1.1.1.2.cmml"><mo id="S4.E11.m1.1.1.1.1.2" xref="S4.E11.m1.1.1.1.2.1.cmml">|</mo><msub id="S4.E11.m1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.1.1.1.1.1.2" xref="S4.E11.m1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S4.E11.m1.1.1.1.1.1.3" xref="S4.E11.m1.1.1.1.1.1.3.cmml">n</mi></msub><mo id="S4.E11.m1.1.1.1.1.3" xref="S4.E11.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E11.m1.2.2.1.3.1" xref="S4.E11.m1.2.2.1.3.1.cmml">​</mo><mstyle displaystyle="true" id="S4.E11.m1.2.2.1.3.2" xref="S4.E11.m1.2.2.1.3.2.cmml"><munder id="S4.E11.m1.2.2.1.3.2a" xref="S4.E11.m1.2.2.1.3.2.cmml"><mo movablelimits="false" id="S4.E11.m1.2.2.1.3.2.2" xref="S4.E11.m1.2.2.1.3.2.2.cmml">∑</mo><mrow id="S4.E11.m1.2.2.1.3.2.3" xref="S4.E11.m1.2.2.1.3.2.3.cmml"><mi id="S4.E11.m1.2.2.1.3.2.3.2" xref="S4.E11.m1.2.2.1.3.2.3.2.cmml">𝒙</mi><mo id="S4.E11.m1.2.2.1.3.2.3.1" xref="S4.E11.m1.2.2.1.3.2.3.1.cmml">∈</mo><msub id="S4.E11.m1.2.2.1.3.2.3.3" xref="S4.E11.m1.2.2.1.3.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.2.2.1.3.2.3.3.2" xref="S4.E11.m1.2.2.1.3.2.3.3.2.cmml">𝒟</mi><mi id="S4.E11.m1.2.2.1.3.2.3.3.3" xref="S4.E11.m1.2.2.1.3.2.3.3.3.cmml">n</mi></msub></mrow></munder></mstyle></mrow><mo id="S4.E11.m1.2.2.1.2" xref="S4.E11.m1.2.2.1.2.cmml">−</mo><mrow id="S4.E11.m1.2.2.1.1" xref="S4.E11.m1.2.2.1.1.cmml"><mrow id="S4.E11.m1.2.2.1.1.3" xref="S4.E11.m1.2.2.1.1.3.cmml"><mi id="S4.E11.m1.2.2.1.1.3.1" xref="S4.E11.m1.2.2.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S4.E11.m1.2.2.1.1.3a" xref="S4.E11.m1.2.2.1.1.3.cmml">⁡</mo><mi id="S4.E11.m1.2.2.1.1.3.2" xref="S4.E11.m1.2.2.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S4.E11.m1.2.2.1.1.2" xref="S4.E11.m1.2.2.1.1.2.cmml">​</mo><mrow id="S4.E11.m1.2.2.1.1.1.1" xref="S4.E11.m1.2.2.1.1.1.1.1.cmml"><mo id="S4.E11.m1.2.2.1.1.1.1.2" xref="S4.E11.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S4.E11.m1.2.2.1.1.1.1.1" xref="S4.E11.m1.2.2.1.1.1.1.1.cmml"><mi id="S4.E11.m1.2.2.1.1.1.1.1.4" xref="S4.E11.m1.2.2.1.1.1.1.1.4.cmml">k</mi><mo id="S4.E11.m1.2.2.1.1.1.1.1.3" xref="S4.E11.m1.2.2.1.1.1.1.1.3.cmml">∣</mo><mrow id="S4.E11.m1.2.2.1.1.1.1.1.2.2" xref="S4.E11.m1.2.2.1.1.1.1.1.2.3.cmml"><msub id="S4.E11.m1.2.2.1.1.1.1.1.1.1.1" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E11.m1.2.2.1.1.1.1.1.2.2.3" xref="S4.E11.m1.2.2.1.1.1.1.1.2.3.cmml">,</mo><msub id="S4.E11.m1.2.2.1.1.1.1.1.2.2.2" xref="S4.E11.m1.2.2.1.1.1.1.1.2.2.2.cmml"><mi id="S4.E11.m1.2.2.1.1.1.1.1.2.2.2.2" xref="S4.E11.m1.2.2.1.1.1.1.1.2.2.2.2.cmml">ϕ</mi><mi id="S4.E11.m1.2.2.1.1.1.1.1.2.2.2.3" xref="S4.E11.m1.2.2.1.1.1.1.1.2.2.2.3.cmml">n</mi></msub></mrow></mrow><mo id="S4.E11.m1.2.2.1.1.1.1.3" xref="S4.E11.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.2b"><apply id="S4.E11.m1.2.2.cmml" xref="S4.E11.m1.2.2"><eq id="S4.E11.m1.2.2.2.cmml" xref="S4.E11.m1.2.2.2"></eq><apply id="S4.E11.m1.2.2.3.cmml" xref="S4.E11.m1.2.2.3"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.3.1.cmml" xref="S4.E11.m1.2.2.3">subscript</csymbol><ci id="S4.E11.m1.2.2.3.2.cmml" xref="S4.E11.m1.2.2.3.2">ℒ</ci><ci id="S4.E11.m1.2.2.3.3.cmml" xref="S4.E11.m1.2.2.3.3">𝑞</ci></apply><apply id="S4.E11.m1.2.2.1.cmml" xref="S4.E11.m1.2.2.1"><minus id="S4.E11.m1.2.2.1.2.cmml" xref="S4.E11.m1.2.2.1.2"></minus><apply id="S4.E11.m1.2.2.1.3.cmml" xref="S4.E11.m1.2.2.1.3"><times id="S4.E11.m1.2.2.1.3.1.cmml" xref="S4.E11.m1.2.2.1.3.1"></times><apply id="S4.E11.m1.1.1.cmml" xref="S4.E11.m1.1.1"><divide id="S4.E11.m1.1.1.2.cmml" xref="S4.E11.m1.1.1"></divide><cn type="integer" id="S4.E11.m1.1.1.3.cmml" xref="S4.E11.m1.1.1.3">1</cn><apply id="S4.E11.m1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1"><abs id="S4.E11.m1.1.1.1.2.1.cmml" xref="S4.E11.m1.1.1.1.1.2"></abs><apply id="S4.E11.m1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E11.m1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1.1.2">𝒟</ci><ci id="S4.E11.m1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.1.1.1.1.1.3">𝑛</ci></apply></apply></apply><apply id="S4.E11.m1.2.2.1.3.2.cmml" xref="S4.E11.m1.2.2.1.3.2"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.1.3.2.1.cmml" xref="S4.E11.m1.2.2.1.3.2">subscript</csymbol><sum id="S4.E11.m1.2.2.1.3.2.2.cmml" xref="S4.E11.m1.2.2.1.3.2.2"></sum><apply id="S4.E11.m1.2.2.1.3.2.3.cmml" xref="S4.E11.m1.2.2.1.3.2.3"><in id="S4.E11.m1.2.2.1.3.2.3.1.cmml" xref="S4.E11.m1.2.2.1.3.2.3.1"></in><ci id="S4.E11.m1.2.2.1.3.2.3.2.cmml" xref="S4.E11.m1.2.2.1.3.2.3.2">𝒙</ci><apply id="S4.E11.m1.2.2.1.3.2.3.3.cmml" xref="S4.E11.m1.2.2.1.3.2.3.3"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.1.3.2.3.3.1.cmml" xref="S4.E11.m1.2.2.1.3.2.3.3">subscript</csymbol><ci id="S4.E11.m1.2.2.1.3.2.3.3.2.cmml" xref="S4.E11.m1.2.2.1.3.2.3.3.2">𝒟</ci><ci id="S4.E11.m1.2.2.1.3.2.3.3.3.cmml" xref="S4.E11.m1.2.2.1.3.2.3.3.3">𝑛</ci></apply></apply></apply></apply><apply id="S4.E11.m1.2.2.1.1.cmml" xref="S4.E11.m1.2.2.1.1"><times id="S4.E11.m1.2.2.1.1.2.cmml" xref="S4.E11.m1.2.2.1.1.2"></times><apply id="S4.E11.m1.2.2.1.1.3.cmml" xref="S4.E11.m1.2.2.1.1.3"><log id="S4.E11.m1.2.2.1.1.3.1.cmml" xref="S4.E11.m1.2.2.1.1.3.1"></log><ci id="S4.E11.m1.2.2.1.1.3.2.cmml" xref="S4.E11.m1.2.2.1.1.3.2">𝑝</ci></apply><apply id="S4.E11.m1.2.2.1.1.1.1.1.cmml" xref="S4.E11.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="S4.E11.m1.2.2.1.1.1.1.1.3.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.3">conditional</csymbol><ci id="S4.E11.m1.2.2.1.1.1.1.1.4.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.4">𝑘</ci><list id="S4.E11.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.2.2"><apply id="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E11.m1.2.2.1.1.1.1.1.2.2.2.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E11.m1.2.2.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.2.2.2.2">italic-ϕ</ci><ci id="S4.E11.m1.2.2.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.2.2.2.3">𝑛</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.2c">\displaystyle\mathcal{L}_{q}=\frac{1}{\left|\mathcal{D}_{n}\right|}\sum_{\boldsymbol{x}\in\mathcal{D}_{n}}-\log p\left(k\mid\mathbf{x}_{i},\phi_{n}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p7.4" class="ltx_p">The whole loss function for local training is <math id="S4.SS2.p7.4.m1.1" class="ltx_Math" alttext="\mathcal{L}_{c}+\mathcal{L}_{q}" display="inline"><semantics id="S4.SS2.p7.4.m1.1a"><mrow id="S4.SS2.p7.4.m1.1.1" xref="S4.SS2.p7.4.m1.1.1.cmml"><msub id="S4.SS2.p7.4.m1.1.1.2" xref="S4.SS2.p7.4.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p7.4.m1.1.1.2.2" xref="S4.SS2.p7.4.m1.1.1.2.2.cmml">ℒ</mi><mi id="S4.SS2.p7.4.m1.1.1.2.3" xref="S4.SS2.p7.4.m1.1.1.2.3.cmml">c</mi></msub><mo id="S4.SS2.p7.4.m1.1.1.1" xref="S4.SS2.p7.4.m1.1.1.1.cmml">+</mo><msub id="S4.SS2.p7.4.m1.1.1.3" xref="S4.SS2.p7.4.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p7.4.m1.1.1.3.2" xref="S4.SS2.p7.4.m1.1.1.3.2.cmml">ℒ</mi><mi id="S4.SS2.p7.4.m1.1.1.3.3" xref="S4.SS2.p7.4.m1.1.1.3.3.cmml">q</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p7.4.m1.1b"><apply id="S4.SS2.p7.4.m1.1.1.cmml" xref="S4.SS2.p7.4.m1.1.1"><plus id="S4.SS2.p7.4.m1.1.1.1.cmml" xref="S4.SS2.p7.4.m1.1.1.1"></plus><apply id="S4.SS2.p7.4.m1.1.1.2.cmml" xref="S4.SS2.p7.4.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p7.4.m1.1.1.2.1.cmml" xref="S4.SS2.p7.4.m1.1.1.2">subscript</csymbol><ci id="S4.SS2.p7.4.m1.1.1.2.2.cmml" xref="S4.SS2.p7.4.m1.1.1.2.2">ℒ</ci><ci id="S4.SS2.p7.4.m1.1.1.2.3.cmml" xref="S4.SS2.p7.4.m1.1.1.2.3">𝑐</ci></apply><apply id="S4.SS2.p7.4.m1.1.1.3.cmml" xref="S4.SS2.p7.4.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p7.4.m1.1.1.3.1.cmml" xref="S4.SS2.p7.4.m1.1.1.3">subscript</csymbol><ci id="S4.SS2.p7.4.m1.1.1.3.2.cmml" xref="S4.SS2.p7.4.m1.1.1.3.2">ℒ</ci><ci id="S4.SS2.p7.4.m1.1.1.3.3.cmml" xref="S4.SS2.p7.4.m1.1.1.3.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p7.4.m1.1c">\mathcal{L}_{c}+\mathcal{L}_{q}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS2.p8" class="ltx_para">
<p id="S4.SS2.p8.4" class="ltx_p">Note that training <math id="S4.SS2.p8.1.m1.1" class="ltx_Math" alttext="\mathcal{Q}_{g}(\cdot)" display="inline"><semantics id="S4.SS2.p8.1.m1.1a"><mrow id="S4.SS2.p8.1.m1.1.2" xref="S4.SS2.p8.1.m1.1.2.cmml"><msub id="S4.SS2.p8.1.m1.1.2.2" xref="S4.SS2.p8.1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p8.1.m1.1.2.2.2" xref="S4.SS2.p8.1.m1.1.2.2.2.cmml">𝒬</mi><mi id="S4.SS2.p8.1.m1.1.2.2.3" xref="S4.SS2.p8.1.m1.1.2.2.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p8.1.m1.1.2.1" xref="S4.SS2.p8.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS2.p8.1.m1.1.2.3.2" xref="S4.SS2.p8.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p8.1.m1.1.2.3.2.1" xref="S4.SS2.p8.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p8.1.m1.1.1" xref="S4.SS2.p8.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.p8.1.m1.1.2.3.2.2" xref="S4.SS2.p8.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p8.1.m1.1b"><apply id="S4.SS2.p8.1.m1.1.2.cmml" xref="S4.SS2.p8.1.m1.1.2"><times id="S4.SS2.p8.1.m1.1.2.1.cmml" xref="S4.SS2.p8.1.m1.1.2.1"></times><apply id="S4.SS2.p8.1.m1.1.2.2.cmml" xref="S4.SS2.p8.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p8.1.m1.1.2.2.1.cmml" xref="S4.SS2.p8.1.m1.1.2.2">subscript</csymbol><ci id="S4.SS2.p8.1.m1.1.2.2.2.cmml" xref="S4.SS2.p8.1.m1.1.2.2.2">𝒬</ci><ci id="S4.SS2.p8.1.m1.1.2.2.3.cmml" xref="S4.SS2.p8.1.m1.1.2.2.3">𝑔</ci></apply><ci id="S4.SS2.p8.1.m1.1.1.cmml" xref="S4.SS2.p8.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p8.1.m1.1c">\mathcal{Q}_{g}(\cdot)</annotation></semantics></math> is a special FL problem, because each client can only access the data of its own domain. In this paper, we find that in the multi-domain scenario, we can obtain good enough <math id="S4.SS2.p8.2.m2.1" class="ltx_Math" alttext="\mathcal{Q}_{g}(\cdot)" display="inline"><semantics id="S4.SS2.p8.2.m2.1a"><mrow id="S4.SS2.p8.2.m2.1.2" xref="S4.SS2.p8.2.m2.1.2.cmml"><msub id="S4.SS2.p8.2.m2.1.2.2" xref="S4.SS2.p8.2.m2.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p8.2.m2.1.2.2.2" xref="S4.SS2.p8.2.m2.1.2.2.2.cmml">𝒬</mi><mi id="S4.SS2.p8.2.m2.1.2.2.3" xref="S4.SS2.p8.2.m2.1.2.2.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p8.2.m2.1.2.1" xref="S4.SS2.p8.2.m2.1.2.1.cmml">​</mo><mrow id="S4.SS2.p8.2.m2.1.2.3.2" xref="S4.SS2.p8.2.m2.1.2.cmml"><mo stretchy="false" id="S4.SS2.p8.2.m2.1.2.3.2.1" xref="S4.SS2.p8.2.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p8.2.m2.1.1" xref="S4.SS2.p8.2.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.p8.2.m2.1.2.3.2.2" xref="S4.SS2.p8.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p8.2.m2.1b"><apply id="S4.SS2.p8.2.m2.1.2.cmml" xref="S4.SS2.p8.2.m2.1.2"><times id="S4.SS2.p8.2.m2.1.2.1.cmml" xref="S4.SS2.p8.2.m2.1.2.1"></times><apply id="S4.SS2.p8.2.m2.1.2.2.cmml" xref="S4.SS2.p8.2.m2.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p8.2.m2.1.2.2.1.cmml" xref="S4.SS2.p8.2.m2.1.2.2">subscript</csymbol><ci id="S4.SS2.p8.2.m2.1.2.2.2.cmml" xref="S4.SS2.p8.2.m2.1.2.2.2">𝒬</ci><ci id="S4.SS2.p8.2.m2.1.2.2.3.cmml" xref="S4.SS2.p8.2.m2.1.2.2.3">𝑔</ci></apply><ci id="S4.SS2.p8.2.m2.1.1.cmml" xref="S4.SS2.p8.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p8.2.m2.1c">\mathcal{Q}_{g}(\cdot)</annotation></semantics></math> by directly using cross-entropy for local training and federated averaging for aggregation. To further improve the effect of <math id="S4.SS2.p8.3.m3.1" class="ltx_Math" alttext="\mathcal{Q}_{g}(\cdot)" display="inline"><semantics id="S4.SS2.p8.3.m3.1a"><mrow id="S4.SS2.p8.3.m3.1.2" xref="S4.SS2.p8.3.m3.1.2.cmml"><msub id="S4.SS2.p8.3.m3.1.2.2" xref="S4.SS2.p8.3.m3.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p8.3.m3.1.2.2.2" xref="S4.SS2.p8.3.m3.1.2.2.2.cmml">𝒬</mi><mi id="S4.SS2.p8.3.m3.1.2.2.3" xref="S4.SS2.p8.3.m3.1.2.2.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p8.3.m3.1.2.1" xref="S4.SS2.p8.3.m3.1.2.1.cmml">​</mo><mrow id="S4.SS2.p8.3.m3.1.2.3.2" xref="S4.SS2.p8.3.m3.1.2.cmml"><mo stretchy="false" id="S4.SS2.p8.3.m3.1.2.3.2.1" xref="S4.SS2.p8.3.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p8.3.m3.1.1" xref="S4.SS2.p8.3.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.p8.3.m3.1.2.3.2.2" xref="S4.SS2.p8.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p8.3.m3.1b"><apply id="S4.SS2.p8.3.m3.1.2.cmml" xref="S4.SS2.p8.3.m3.1.2"><times id="S4.SS2.p8.3.m3.1.2.1.cmml" xref="S4.SS2.p8.3.m3.1.2.1"></times><apply id="S4.SS2.p8.3.m3.1.2.2.cmml" xref="S4.SS2.p8.3.m3.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p8.3.m3.1.2.2.1.cmml" xref="S4.SS2.p8.3.m3.1.2.2">subscript</csymbol><ci id="S4.SS2.p8.3.m3.1.2.2.2.cmml" xref="S4.SS2.p8.3.m3.1.2.2.2">𝒬</ci><ci id="S4.SS2.p8.3.m3.1.2.2.3.cmml" xref="S4.SS2.p8.3.m3.1.2.2.3">𝑔</ci></apply><ci id="S4.SS2.p8.3.m3.1.1.cmml" xref="S4.SS2.p8.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p8.3.m3.1c">\mathcal{Q}_{g}(\cdot)</annotation></semantics></math>, it is necessary to use special training methods, such as FedAws <cite class="ltx_cite ltx_citemacro_citep">(Yu et al. <a href="#bib.bib44" title="" class="ltx_ref">2020</a>)</cite>. In addition, directly uploading the data prototype <cite class="ltx_cite ltx_citemacro_citep">(Tan et al. <a href="#bib.bib36" title="" class="ltx_ref">2022</a>; Peng et al. <a href="#bib.bib28" title="" class="ltx_ref">2019b</a>)</cite>, can also train the <math id="S4.SS2.p8.4.m4.1" class="ltx_Math" alttext="\mathcal{Q}_{g}(\cdot)" display="inline"><semantics id="S4.SS2.p8.4.m4.1a"><mrow id="S4.SS2.p8.4.m4.1.2" xref="S4.SS2.p8.4.m4.1.2.cmml"><msub id="S4.SS2.p8.4.m4.1.2.2" xref="S4.SS2.p8.4.m4.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p8.4.m4.1.2.2.2" xref="S4.SS2.p8.4.m4.1.2.2.2.cmml">𝒬</mi><mi id="S4.SS2.p8.4.m4.1.2.2.3" xref="S4.SS2.p8.4.m4.1.2.2.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p8.4.m4.1.2.1" xref="S4.SS2.p8.4.m4.1.2.1.cmml">​</mo><mrow id="S4.SS2.p8.4.m4.1.2.3.2" xref="S4.SS2.p8.4.m4.1.2.cmml"><mo stretchy="false" id="S4.SS2.p8.4.m4.1.2.3.2.1" xref="S4.SS2.p8.4.m4.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p8.4.m4.1.1" xref="S4.SS2.p8.4.m4.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.p8.4.m4.1.2.3.2.2" xref="S4.SS2.p8.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p8.4.m4.1b"><apply id="S4.SS2.p8.4.m4.1.2.cmml" xref="S4.SS2.p8.4.m4.1.2"><times id="S4.SS2.p8.4.m4.1.2.1.cmml" xref="S4.SS2.p8.4.m4.1.2.1"></times><apply id="S4.SS2.p8.4.m4.1.2.2.cmml" xref="S4.SS2.p8.4.m4.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p8.4.m4.1.2.2.1.cmml" xref="S4.SS2.p8.4.m4.1.2.2">subscript</csymbol><ci id="S4.SS2.p8.4.m4.1.2.2.2.cmml" xref="S4.SS2.p8.4.m4.1.2.2.2">𝒬</ci><ci id="S4.SS2.p8.4.m4.1.2.2.3.cmml" xref="S4.SS2.p8.4.m4.1.2.2.3">𝑔</ci></apply><ci id="S4.SS2.p8.4.m4.1.1.cmml" xref="S4.SS2.p8.4.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p8.4.m4.1c">\mathcal{Q}_{g}(\cdot)</annotation></semantics></math> in the server, but in order to prevent privacy disclosure, we do not upload any data features or prototypes.</p>
</div>
<div id="S4.SS2.p9" class="ltx_para">
<p id="S4.SS2.p9.6" class="ltx_p"><span id="S4.SS2.p9.6.1" class="ltx_text ltx_font_bold">Step3: Aggregation</span>. After the local training step, the <math id="S4.SS2.p9.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS2.p9.1.m1.1a"><mi id="S4.SS2.p9.1.m1.1.1" xref="S4.SS2.p9.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.1.m1.1b"><ci id="S4.SS2.p9.1.m1.1.1.cmml" xref="S4.SS2.p9.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.1.m1.1c">n</annotation></semantics></math>-th client uploads <math id="S4.SS2.p9.2.m2.1" class="ltx_Math" alttext="\mathbf{p}_{n}" display="inline"><semantics id="S4.SS2.p9.2.m2.1a"><msub id="S4.SS2.p9.2.m2.1.1" xref="S4.SS2.p9.2.m2.1.1.cmml"><mi id="S4.SS2.p9.2.m2.1.1.2" xref="S4.SS2.p9.2.m2.1.1.2.cmml">𝐩</mi><mi id="S4.SS2.p9.2.m2.1.1.3" xref="S4.SS2.p9.2.m2.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.2.m2.1b"><apply id="S4.SS2.p9.2.m2.1.1.cmml" xref="S4.SS2.p9.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.2.m2.1.1.1.cmml" xref="S4.SS2.p9.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p9.2.m2.1.1.2.cmml" xref="S4.SS2.p9.2.m2.1.1.2">𝐩</ci><ci id="S4.SS2.p9.2.m2.1.1.3.cmml" xref="S4.SS2.p9.2.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.2.m2.1c">\mathbf{p}_{n}</annotation></semantics></math> and <math id="S4.SS2.p9.3.m3.1" class="ltx_Math" alttext="\phi_{n}" display="inline"><semantics id="S4.SS2.p9.3.m3.1a"><msub id="S4.SS2.p9.3.m3.1.1" xref="S4.SS2.p9.3.m3.1.1.cmml"><mi id="S4.SS2.p9.3.m3.1.1.2" xref="S4.SS2.p9.3.m3.1.1.2.cmml">ϕ</mi><mi id="S4.SS2.p9.3.m3.1.1.3" xref="S4.SS2.p9.3.m3.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.3.m3.1b"><apply id="S4.SS2.p9.3.m3.1.1.cmml" xref="S4.SS2.p9.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.3.m3.1.1.1.cmml" xref="S4.SS2.p9.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p9.3.m3.1.1.2.cmml" xref="S4.SS2.p9.3.m3.1.1.2">italic-ϕ</ci><ci id="S4.SS2.p9.3.m3.1.1.3.cmml" xref="S4.SS2.p9.3.m3.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.3.m3.1c">\phi_{n}</annotation></semantics></math> to the server. Due to <math id="S4.SS2.p9.4.m4.1" class="ltx_Math" alttext="\phi_{n}\in\mathbb{R}^{d_{img}\times K}" display="inline"><semantics id="S4.SS2.p9.4.m4.1a"><mrow id="S4.SS2.p9.4.m4.1.1" xref="S4.SS2.p9.4.m4.1.1.cmml"><msub id="S4.SS2.p9.4.m4.1.1.2" xref="S4.SS2.p9.4.m4.1.1.2.cmml"><mi id="S4.SS2.p9.4.m4.1.1.2.2" xref="S4.SS2.p9.4.m4.1.1.2.2.cmml">ϕ</mi><mi id="S4.SS2.p9.4.m4.1.1.2.3" xref="S4.SS2.p9.4.m4.1.1.2.3.cmml">n</mi></msub><mo id="S4.SS2.p9.4.m4.1.1.1" xref="S4.SS2.p9.4.m4.1.1.1.cmml">∈</mo><msup id="S4.SS2.p9.4.m4.1.1.3" xref="S4.SS2.p9.4.m4.1.1.3.cmml"><mi id="S4.SS2.p9.4.m4.1.1.3.2" xref="S4.SS2.p9.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS2.p9.4.m4.1.1.3.3" xref="S4.SS2.p9.4.m4.1.1.3.3.cmml"><msub id="S4.SS2.p9.4.m4.1.1.3.3.2" xref="S4.SS2.p9.4.m4.1.1.3.3.2.cmml"><mi id="S4.SS2.p9.4.m4.1.1.3.3.2.2" xref="S4.SS2.p9.4.m4.1.1.3.3.2.2.cmml">d</mi><mrow id="S4.SS2.p9.4.m4.1.1.3.3.2.3" xref="S4.SS2.p9.4.m4.1.1.3.3.2.3.cmml"><mi id="S4.SS2.p9.4.m4.1.1.3.3.2.3.2" xref="S4.SS2.p9.4.m4.1.1.3.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p9.4.m4.1.1.3.3.2.3.1" xref="S4.SS2.p9.4.m4.1.1.3.3.2.3.1.cmml">​</mo><mi id="S4.SS2.p9.4.m4.1.1.3.3.2.3.3" xref="S4.SS2.p9.4.m4.1.1.3.3.2.3.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p9.4.m4.1.1.3.3.2.3.1a" xref="S4.SS2.p9.4.m4.1.1.3.3.2.3.1.cmml">​</mo><mi id="S4.SS2.p9.4.m4.1.1.3.3.2.3.4" xref="S4.SS2.p9.4.m4.1.1.3.3.2.3.4.cmml">g</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p9.4.m4.1.1.3.3.1" xref="S4.SS2.p9.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S4.SS2.p9.4.m4.1.1.3.3.3" xref="S4.SS2.p9.4.m4.1.1.3.3.3.cmml">K</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.4.m4.1b"><apply id="S4.SS2.p9.4.m4.1.1.cmml" xref="S4.SS2.p9.4.m4.1.1"><in id="S4.SS2.p9.4.m4.1.1.1.cmml" xref="S4.SS2.p9.4.m4.1.1.1"></in><apply id="S4.SS2.p9.4.m4.1.1.2.cmml" xref="S4.SS2.p9.4.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p9.4.m4.1.1.2.1.cmml" xref="S4.SS2.p9.4.m4.1.1.2">subscript</csymbol><ci id="S4.SS2.p9.4.m4.1.1.2.2.cmml" xref="S4.SS2.p9.4.m4.1.1.2.2">italic-ϕ</ci><ci id="S4.SS2.p9.4.m4.1.1.2.3.cmml" xref="S4.SS2.p9.4.m4.1.1.2.3">𝑛</ci></apply><apply id="S4.SS2.p9.4.m4.1.1.3.cmml" xref="S4.SS2.p9.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p9.4.m4.1.1.3.1.cmml" xref="S4.SS2.p9.4.m4.1.1.3">superscript</csymbol><ci id="S4.SS2.p9.4.m4.1.1.3.2.cmml" xref="S4.SS2.p9.4.m4.1.1.3.2">ℝ</ci><apply id="S4.SS2.p9.4.m4.1.1.3.3.cmml" xref="S4.SS2.p9.4.m4.1.1.3.3"><times id="S4.SS2.p9.4.m4.1.1.3.3.1.cmml" xref="S4.SS2.p9.4.m4.1.1.3.3.1"></times><apply id="S4.SS2.p9.4.m4.1.1.3.3.2.cmml" xref="S4.SS2.p9.4.m4.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.p9.4.m4.1.1.3.3.2.1.cmml" xref="S4.SS2.p9.4.m4.1.1.3.3.2">subscript</csymbol><ci id="S4.SS2.p9.4.m4.1.1.3.3.2.2.cmml" xref="S4.SS2.p9.4.m4.1.1.3.3.2.2">𝑑</ci><apply id="S4.SS2.p9.4.m4.1.1.3.3.2.3.cmml" xref="S4.SS2.p9.4.m4.1.1.3.3.2.3"><times id="S4.SS2.p9.4.m4.1.1.3.3.2.3.1.cmml" xref="S4.SS2.p9.4.m4.1.1.3.3.2.3.1"></times><ci id="S4.SS2.p9.4.m4.1.1.3.3.2.3.2.cmml" xref="S4.SS2.p9.4.m4.1.1.3.3.2.3.2">𝑖</ci><ci id="S4.SS2.p9.4.m4.1.1.3.3.2.3.3.cmml" xref="S4.SS2.p9.4.m4.1.1.3.3.2.3.3">𝑚</ci><ci id="S4.SS2.p9.4.m4.1.1.3.3.2.3.4.cmml" xref="S4.SS2.p9.4.m4.1.1.3.3.2.3.4">𝑔</ci></apply></apply><ci id="S4.SS2.p9.4.m4.1.1.3.3.3.cmml" xref="S4.SS2.p9.4.m4.1.1.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.4.m4.1c">\phi_{n}\in\mathbb{R}^{d_{img}\times K}</annotation></semantics></math>, <math id="S4.SS2.p9.5.m5.1" class="ltx_Math" alttext="d_{img}" display="inline"><semantics id="S4.SS2.p9.5.m5.1a"><msub id="S4.SS2.p9.5.m5.1.1" xref="S4.SS2.p9.5.m5.1.1.cmml"><mi id="S4.SS2.p9.5.m5.1.1.2" xref="S4.SS2.p9.5.m5.1.1.2.cmml">d</mi><mrow id="S4.SS2.p9.5.m5.1.1.3" xref="S4.SS2.p9.5.m5.1.1.3.cmml"><mi id="S4.SS2.p9.5.m5.1.1.3.2" xref="S4.SS2.p9.5.m5.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p9.5.m5.1.1.3.1" xref="S4.SS2.p9.5.m5.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p9.5.m5.1.1.3.3" xref="S4.SS2.p9.5.m5.1.1.3.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p9.5.m5.1.1.3.1a" xref="S4.SS2.p9.5.m5.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p9.5.m5.1.1.3.4" xref="S4.SS2.p9.5.m5.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.5.m5.1b"><apply id="S4.SS2.p9.5.m5.1.1.cmml" xref="S4.SS2.p9.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.5.m5.1.1.1.cmml" xref="S4.SS2.p9.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.p9.5.m5.1.1.2.cmml" xref="S4.SS2.p9.5.m5.1.1.2">𝑑</ci><apply id="S4.SS2.p9.5.m5.1.1.3.cmml" xref="S4.SS2.p9.5.m5.1.1.3"><times id="S4.SS2.p9.5.m5.1.1.3.1.cmml" xref="S4.SS2.p9.5.m5.1.1.3.1"></times><ci id="S4.SS2.p9.5.m5.1.1.3.2.cmml" xref="S4.SS2.p9.5.m5.1.1.3.2">𝑖</ci><ci id="S4.SS2.p9.5.m5.1.1.3.3.cmml" xref="S4.SS2.p9.5.m5.1.1.3.3">𝑚</ci><ci id="S4.SS2.p9.5.m5.1.1.3.4.cmml" xref="S4.SS2.p9.5.m5.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.5.m5.1c">d_{img}</annotation></semantics></math> is the dimension of each image feature, which is 512 in CLIP, the additional traffic brought by transmitting <math id="S4.SS2.p9.6.m6.1" class="ltx_Math" alttext="\phi_{n}" display="inline"><semantics id="S4.SS2.p9.6.m6.1a"><msub id="S4.SS2.p9.6.m6.1.1" xref="S4.SS2.p9.6.m6.1.1.cmml"><mi id="S4.SS2.p9.6.m6.1.1.2" xref="S4.SS2.p9.6.m6.1.1.2.cmml">ϕ</mi><mi id="S4.SS2.p9.6.m6.1.1.3" xref="S4.SS2.p9.6.m6.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.6.m6.1b"><apply id="S4.SS2.p9.6.m6.1.1.cmml" xref="S4.SS2.p9.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.6.m6.1.1.1.cmml" xref="S4.SS2.p9.6.m6.1.1">subscript</csymbol><ci id="S4.SS2.p9.6.m6.1.1.2.cmml" xref="S4.SS2.p9.6.m6.1.1.2">italic-ϕ</ci><ci id="S4.SS2.p9.6.m6.1.1.3.cmml" xref="S4.SS2.p9.6.m6.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.6.m6.1c">\phi_{n}</annotation></semantics></math> is extremely small compared with prompts. The server averages the parameters to obtain the aggregation model parameters:</p>
<table id="A2.EGx14" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E12.m1.2" class="ltx_Math" alttext="\displaystyle\mathbf{p}_{g}=\frac{1}{N}\sum_{n=1}^{N}\mathbf{p}_{n},\quad\phi_{g}=\frac{1}{N}\sum_{n=1}^{N}\phi_{n}" display="inline"><semantics id="S4.E12.m1.2a"><mrow id="S4.E12.m1.2.2.2" xref="S4.E12.m1.2.2.3.cmml"><mrow id="S4.E12.m1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.cmml"><msub id="S4.E12.m1.1.1.1.1.2" xref="S4.E12.m1.1.1.1.1.2.cmml"><mi id="S4.E12.m1.1.1.1.1.2.2" xref="S4.E12.m1.1.1.1.1.2.2.cmml">𝐩</mi><mi id="S4.E12.m1.1.1.1.1.2.3" xref="S4.E12.m1.1.1.1.1.2.3.cmml">g</mi></msub><mo id="S4.E12.m1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E12.m1.1.1.1.1.3" xref="S4.E12.m1.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S4.E12.m1.1.1.1.1.3.2" xref="S4.E12.m1.1.1.1.1.3.2.cmml"><mfrac id="S4.E12.m1.1.1.1.1.3.2a" xref="S4.E12.m1.1.1.1.1.3.2.cmml"><mn id="S4.E12.m1.1.1.1.1.3.2.2" xref="S4.E12.m1.1.1.1.1.3.2.2.cmml">1</mn><mi id="S4.E12.m1.1.1.1.1.3.2.3" xref="S4.E12.m1.1.1.1.1.3.2.3.cmml">N</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E12.m1.1.1.1.1.3.1" xref="S4.E12.m1.1.1.1.1.3.1.cmml">​</mo><mrow id="S4.E12.m1.1.1.1.1.3.3" xref="S4.E12.m1.1.1.1.1.3.3.cmml"><mstyle displaystyle="true" id="S4.E12.m1.1.1.1.1.3.3.1" xref="S4.E12.m1.1.1.1.1.3.3.1.cmml"><munderover id="S4.E12.m1.1.1.1.1.3.3.1a" xref="S4.E12.m1.1.1.1.1.3.3.1.cmml"><mo movablelimits="false" id="S4.E12.m1.1.1.1.1.3.3.1.2.2" xref="S4.E12.m1.1.1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S4.E12.m1.1.1.1.1.3.3.1.2.3" xref="S4.E12.m1.1.1.1.1.3.3.1.2.3.cmml"><mi id="S4.E12.m1.1.1.1.1.3.3.1.2.3.2" xref="S4.E12.m1.1.1.1.1.3.3.1.2.3.2.cmml">n</mi><mo id="S4.E12.m1.1.1.1.1.3.3.1.2.3.1" xref="S4.E12.m1.1.1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S4.E12.m1.1.1.1.1.3.3.1.2.3.3" xref="S4.E12.m1.1.1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E12.m1.1.1.1.1.3.3.1.3" xref="S4.E12.m1.1.1.1.1.3.3.1.3.cmml">N</mi></munderover></mstyle><msub id="S4.E12.m1.1.1.1.1.3.3.2" xref="S4.E12.m1.1.1.1.1.3.3.2.cmml"><mi id="S4.E12.m1.1.1.1.1.3.3.2.2" xref="S4.E12.m1.1.1.1.1.3.3.2.2.cmml">𝐩</mi><mi id="S4.E12.m1.1.1.1.1.3.3.2.3" xref="S4.E12.m1.1.1.1.1.3.3.2.3.cmml">n</mi></msub></mrow></mrow></mrow><mo rspace="1.167em" id="S4.E12.m1.2.2.2.3" xref="S4.E12.m1.2.2.3a.cmml">,</mo><mrow id="S4.E12.m1.2.2.2.2" xref="S4.E12.m1.2.2.2.2.cmml"><msub id="S4.E12.m1.2.2.2.2.2" xref="S4.E12.m1.2.2.2.2.2.cmml"><mi id="S4.E12.m1.2.2.2.2.2.2" xref="S4.E12.m1.2.2.2.2.2.2.cmml">ϕ</mi><mi id="S4.E12.m1.2.2.2.2.2.3" xref="S4.E12.m1.2.2.2.2.2.3.cmml">g</mi></msub><mo id="S4.E12.m1.2.2.2.2.1" xref="S4.E12.m1.2.2.2.2.1.cmml">=</mo><mrow id="S4.E12.m1.2.2.2.2.3" xref="S4.E12.m1.2.2.2.2.3.cmml"><mstyle displaystyle="true" id="S4.E12.m1.2.2.2.2.3.2" xref="S4.E12.m1.2.2.2.2.3.2.cmml"><mfrac id="S4.E12.m1.2.2.2.2.3.2a" xref="S4.E12.m1.2.2.2.2.3.2.cmml"><mn id="S4.E12.m1.2.2.2.2.3.2.2" xref="S4.E12.m1.2.2.2.2.3.2.2.cmml">1</mn><mi id="S4.E12.m1.2.2.2.2.3.2.3" xref="S4.E12.m1.2.2.2.2.3.2.3.cmml">N</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E12.m1.2.2.2.2.3.1" xref="S4.E12.m1.2.2.2.2.3.1.cmml">​</mo><mrow id="S4.E12.m1.2.2.2.2.3.3" xref="S4.E12.m1.2.2.2.2.3.3.cmml"><mstyle displaystyle="true" id="S4.E12.m1.2.2.2.2.3.3.1" xref="S4.E12.m1.2.2.2.2.3.3.1.cmml"><munderover id="S4.E12.m1.2.2.2.2.3.3.1a" xref="S4.E12.m1.2.2.2.2.3.3.1.cmml"><mo movablelimits="false" id="S4.E12.m1.2.2.2.2.3.3.1.2.2" xref="S4.E12.m1.2.2.2.2.3.3.1.2.2.cmml">∑</mo><mrow id="S4.E12.m1.2.2.2.2.3.3.1.2.3" xref="S4.E12.m1.2.2.2.2.3.3.1.2.3.cmml"><mi id="S4.E12.m1.2.2.2.2.3.3.1.2.3.2" xref="S4.E12.m1.2.2.2.2.3.3.1.2.3.2.cmml">n</mi><mo id="S4.E12.m1.2.2.2.2.3.3.1.2.3.1" xref="S4.E12.m1.2.2.2.2.3.3.1.2.3.1.cmml">=</mo><mn id="S4.E12.m1.2.2.2.2.3.3.1.2.3.3" xref="S4.E12.m1.2.2.2.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E12.m1.2.2.2.2.3.3.1.3" xref="S4.E12.m1.2.2.2.2.3.3.1.3.cmml">N</mi></munderover></mstyle><msub id="S4.E12.m1.2.2.2.2.3.3.2" xref="S4.E12.m1.2.2.2.2.3.3.2.cmml"><mi id="S4.E12.m1.2.2.2.2.3.3.2.2" xref="S4.E12.m1.2.2.2.2.3.3.2.2.cmml">ϕ</mi><mi id="S4.E12.m1.2.2.2.2.3.3.2.3" xref="S4.E12.m1.2.2.2.2.3.3.2.3.cmml">n</mi></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.2b"><apply id="S4.E12.m1.2.2.3.cmml" xref="S4.E12.m1.2.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.2.2.3a.cmml" xref="S4.E12.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S4.E12.m1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1"><eq id="S4.E12.m1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1"></eq><apply id="S4.E12.m1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.2.1.cmml" xref="S4.E12.m1.1.1.1.1.2">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.2.2.cmml" xref="S4.E12.m1.1.1.1.1.2.2">𝐩</ci><ci id="S4.E12.m1.1.1.1.1.2.3.cmml" xref="S4.E12.m1.1.1.1.1.2.3">𝑔</ci></apply><apply id="S4.E12.m1.1.1.1.1.3.cmml" xref="S4.E12.m1.1.1.1.1.3"><times id="S4.E12.m1.1.1.1.1.3.1.cmml" xref="S4.E12.m1.1.1.1.1.3.1"></times><apply id="S4.E12.m1.1.1.1.1.3.2.cmml" xref="S4.E12.m1.1.1.1.1.3.2"><divide id="S4.E12.m1.1.1.1.1.3.2.1.cmml" xref="S4.E12.m1.1.1.1.1.3.2"></divide><cn type="integer" id="S4.E12.m1.1.1.1.1.3.2.2.cmml" xref="S4.E12.m1.1.1.1.1.3.2.2">1</cn><ci id="S4.E12.m1.1.1.1.1.3.2.3.cmml" xref="S4.E12.m1.1.1.1.1.3.2.3">𝑁</ci></apply><apply id="S4.E12.m1.1.1.1.1.3.3.cmml" xref="S4.E12.m1.1.1.1.1.3.3"><apply id="S4.E12.m1.1.1.1.1.3.3.1.cmml" xref="S4.E12.m1.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.3.3.1.1.cmml" xref="S4.E12.m1.1.1.1.1.3.3.1">superscript</csymbol><apply id="S4.E12.m1.1.1.1.1.3.3.1.2.cmml" xref="S4.E12.m1.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.3.3.1.2.1.cmml" xref="S4.E12.m1.1.1.1.1.3.3.1">subscript</csymbol><sum id="S4.E12.m1.1.1.1.1.3.3.1.2.2.cmml" xref="S4.E12.m1.1.1.1.1.3.3.1.2.2"></sum><apply id="S4.E12.m1.1.1.1.1.3.3.1.2.3.cmml" xref="S4.E12.m1.1.1.1.1.3.3.1.2.3"><eq id="S4.E12.m1.1.1.1.1.3.3.1.2.3.1.cmml" xref="S4.E12.m1.1.1.1.1.3.3.1.2.3.1"></eq><ci id="S4.E12.m1.1.1.1.1.3.3.1.2.3.2.cmml" xref="S4.E12.m1.1.1.1.1.3.3.1.2.3.2">𝑛</ci><cn type="integer" id="S4.E12.m1.1.1.1.1.3.3.1.2.3.3.cmml" xref="S4.E12.m1.1.1.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S4.E12.m1.1.1.1.1.3.3.1.3.cmml" xref="S4.E12.m1.1.1.1.1.3.3.1.3">𝑁</ci></apply><apply id="S4.E12.m1.1.1.1.1.3.3.2.cmml" xref="S4.E12.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.3.3.2.1.cmml" xref="S4.E12.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.3.3.2.2.cmml" xref="S4.E12.m1.1.1.1.1.3.3.2.2">𝐩</ci><ci id="S4.E12.m1.1.1.1.1.3.3.2.3.cmml" xref="S4.E12.m1.1.1.1.1.3.3.2.3">𝑛</ci></apply></apply></apply></apply><apply id="S4.E12.m1.2.2.2.2.cmml" xref="S4.E12.m1.2.2.2.2"><eq id="S4.E12.m1.2.2.2.2.1.cmml" xref="S4.E12.m1.2.2.2.2.1"></eq><apply id="S4.E12.m1.2.2.2.2.2.cmml" xref="S4.E12.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.2.2.2.2.2.1.cmml" xref="S4.E12.m1.2.2.2.2.2">subscript</csymbol><ci id="S4.E12.m1.2.2.2.2.2.2.cmml" xref="S4.E12.m1.2.2.2.2.2.2">italic-ϕ</ci><ci id="S4.E12.m1.2.2.2.2.2.3.cmml" xref="S4.E12.m1.2.2.2.2.2.3">𝑔</ci></apply><apply id="S4.E12.m1.2.2.2.2.3.cmml" xref="S4.E12.m1.2.2.2.2.3"><times id="S4.E12.m1.2.2.2.2.3.1.cmml" xref="S4.E12.m1.2.2.2.2.3.1"></times><apply id="S4.E12.m1.2.2.2.2.3.2.cmml" xref="S4.E12.m1.2.2.2.2.3.2"><divide id="S4.E12.m1.2.2.2.2.3.2.1.cmml" xref="S4.E12.m1.2.2.2.2.3.2"></divide><cn type="integer" id="S4.E12.m1.2.2.2.2.3.2.2.cmml" xref="S4.E12.m1.2.2.2.2.3.2.2">1</cn><ci id="S4.E12.m1.2.2.2.2.3.2.3.cmml" xref="S4.E12.m1.2.2.2.2.3.2.3">𝑁</ci></apply><apply id="S4.E12.m1.2.2.2.2.3.3.cmml" xref="S4.E12.m1.2.2.2.2.3.3"><apply id="S4.E12.m1.2.2.2.2.3.3.1.cmml" xref="S4.E12.m1.2.2.2.2.3.3.1"><csymbol cd="ambiguous" id="S4.E12.m1.2.2.2.2.3.3.1.1.cmml" xref="S4.E12.m1.2.2.2.2.3.3.1">superscript</csymbol><apply id="S4.E12.m1.2.2.2.2.3.3.1.2.cmml" xref="S4.E12.m1.2.2.2.2.3.3.1"><csymbol cd="ambiguous" id="S4.E12.m1.2.2.2.2.3.3.1.2.1.cmml" xref="S4.E12.m1.2.2.2.2.3.3.1">subscript</csymbol><sum id="S4.E12.m1.2.2.2.2.3.3.1.2.2.cmml" xref="S4.E12.m1.2.2.2.2.3.3.1.2.2"></sum><apply id="S4.E12.m1.2.2.2.2.3.3.1.2.3.cmml" xref="S4.E12.m1.2.2.2.2.3.3.1.2.3"><eq id="S4.E12.m1.2.2.2.2.3.3.1.2.3.1.cmml" xref="S4.E12.m1.2.2.2.2.3.3.1.2.3.1"></eq><ci id="S4.E12.m1.2.2.2.2.3.3.1.2.3.2.cmml" xref="S4.E12.m1.2.2.2.2.3.3.1.2.3.2">𝑛</ci><cn type="integer" id="S4.E12.m1.2.2.2.2.3.3.1.2.3.3.cmml" xref="S4.E12.m1.2.2.2.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="S4.E12.m1.2.2.2.2.3.3.1.3.cmml" xref="S4.E12.m1.2.2.2.2.3.3.1.3">𝑁</ci></apply><apply id="S4.E12.m1.2.2.2.2.3.3.2.cmml" xref="S4.E12.m1.2.2.2.2.3.3.2"><csymbol cd="ambiguous" id="S4.E12.m1.2.2.2.2.3.3.2.1.cmml" xref="S4.E12.m1.2.2.2.2.3.3.2">subscript</csymbol><ci id="S4.E12.m1.2.2.2.2.3.3.2.2.cmml" xref="S4.E12.m1.2.2.2.2.3.3.2.2">italic-ϕ</ci><ci id="S4.E12.m1.2.2.2.2.3.3.2.3.cmml" xref="S4.E12.m1.2.2.2.2.3.3.2.3">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.2c">\displaystyle\mathbf{p}_{g}=\frac{1}{N}\sum_{n=1}^{N}\mathbf{p}_{n},\quad\phi_{g}=\frac{1}{N}\sum_{n=1}^{N}\phi_{n}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS2.p10" class="ltx_para">
<p id="S4.SS2.p10.4" class="ltx_p">Repeat Step 2 and Step 3 for <math id="S4.SS2.p10.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.SS2.p10.1.m1.1a"><mi id="S4.SS2.p10.1.m1.1.1" xref="S4.SS2.p10.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p10.1.m1.1b"><ci id="S4.SS2.p10.1.m1.1.1.cmml" xref="S4.SS2.p10.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p10.1.m1.1c">T</annotation></semantics></math> rounds, then <math id="S4.SS2.p10.2.m2.1" class="ltx_Math" alttext="\mathbf{p}_{g}" display="inline"><semantics id="S4.SS2.p10.2.m2.1a"><msub id="S4.SS2.p10.2.m2.1.1" xref="S4.SS2.p10.2.m2.1.1.cmml"><mi id="S4.SS2.p10.2.m2.1.1.2" xref="S4.SS2.p10.2.m2.1.1.2.cmml">𝐩</mi><mi id="S4.SS2.p10.2.m2.1.1.3" xref="S4.SS2.p10.2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p10.2.m2.1b"><apply id="S4.SS2.p10.2.m2.1.1.cmml" xref="S4.SS2.p10.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p10.2.m2.1.1.1.cmml" xref="S4.SS2.p10.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p10.2.m2.1.1.2.cmml" xref="S4.SS2.p10.2.m2.1.1.2">𝐩</ci><ci id="S4.SS2.p10.2.m2.1.1.3.cmml" xref="S4.SS2.p10.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p10.2.m2.1c">\mathbf{p}_{g}</annotation></semantics></math> and <math id="S4.SS2.p10.3.m3.1" class="ltx_Math" alttext="\mathcal{Q}_{g}(\cdot)" display="inline"><semantics id="S4.SS2.p10.3.m3.1a"><mrow id="S4.SS2.p10.3.m3.1.2" xref="S4.SS2.p10.3.m3.1.2.cmml"><msub id="S4.SS2.p10.3.m3.1.2.2" xref="S4.SS2.p10.3.m3.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p10.3.m3.1.2.2.2" xref="S4.SS2.p10.3.m3.1.2.2.2.cmml">𝒬</mi><mi id="S4.SS2.p10.3.m3.1.2.2.3" xref="S4.SS2.p10.3.m3.1.2.2.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p10.3.m3.1.2.1" xref="S4.SS2.p10.3.m3.1.2.1.cmml">​</mo><mrow id="S4.SS2.p10.3.m3.1.2.3.2" xref="S4.SS2.p10.3.m3.1.2.cmml"><mo stretchy="false" id="S4.SS2.p10.3.m3.1.2.3.2.1" xref="S4.SS2.p10.3.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p10.3.m3.1.1" xref="S4.SS2.p10.3.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.p10.3.m3.1.2.3.2.2" xref="S4.SS2.p10.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p10.3.m3.1b"><apply id="S4.SS2.p10.3.m3.1.2.cmml" xref="S4.SS2.p10.3.m3.1.2"><times id="S4.SS2.p10.3.m3.1.2.1.cmml" xref="S4.SS2.p10.3.m3.1.2.1"></times><apply id="S4.SS2.p10.3.m3.1.2.2.cmml" xref="S4.SS2.p10.3.m3.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p10.3.m3.1.2.2.1.cmml" xref="S4.SS2.p10.3.m3.1.2.2">subscript</csymbol><ci id="S4.SS2.p10.3.m3.1.2.2.2.cmml" xref="S4.SS2.p10.3.m3.1.2.2.2">𝒬</ci><ci id="S4.SS2.p10.3.m3.1.2.2.3.cmml" xref="S4.SS2.p10.3.m3.1.2.2.3">𝑔</ci></apply><ci id="S4.SS2.p10.3.m3.1.1.cmml" xref="S4.SS2.p10.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p10.3.m3.1c">\mathcal{Q}_{g}(\cdot)</annotation></semantics></math> with parameters <math id="S4.SS2.p10.4.m4.1" class="ltx_Math" alttext="\phi_{g}" display="inline"><semantics id="S4.SS2.p10.4.m4.1a"><msub id="S4.SS2.p10.4.m4.1.1" xref="S4.SS2.p10.4.m4.1.1.cmml"><mi id="S4.SS2.p10.4.m4.1.1.2" xref="S4.SS2.p10.4.m4.1.1.2.cmml">ϕ</mi><mi id="S4.SS2.p10.4.m4.1.1.3" xref="S4.SS2.p10.4.m4.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p10.4.m4.1b"><apply id="S4.SS2.p10.4.m4.1.1.cmml" xref="S4.SS2.p10.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p10.4.m4.1.1.1.cmml" xref="S4.SS2.p10.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p10.4.m4.1.1.2.cmml" xref="S4.SS2.p10.4.m4.1.1.2">italic-ϕ</ci><ci id="S4.SS2.p10.4.m4.1.1.3.cmml" xref="S4.SS2.p10.4.m4.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p10.4.m4.1c">\phi_{g}</annotation></semantics></math> can be used to establish the global model.</p>
</div>
<div id="S4.SS2.p11" class="ltx_para">
<p id="S4.SS2.p11.2" class="ltx_p"><span id="S4.SS2.p11.2.1" class="ltx_text ltx_font_bold">Improve inference efficiency.</span> Notably, during the inference process, assuming a batch size of <math id="S4.SS2.p11.1.m1.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S4.SS2.p11.1.m1.1a"><mi id="S4.SS2.p11.1.m1.1.1" xref="S4.SS2.p11.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p11.1.m1.1b"><ci id="S4.SS2.p11.1.m1.1.1.cmml" xref="S4.SS2.p11.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p11.1.m1.1c">B</annotation></semantics></math>, since each sample is associated with distinct prompts, the text encoder needs to be executed <math id="S4.SS2.p11.2.m2.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S4.SS2.p11.2.m2.1a"><mi id="S4.SS2.p11.2.m2.1.1" xref="S4.SS2.p11.2.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p11.2.m2.1b"><ci id="S4.SS2.p11.2.m2.1.1.cmml" xref="S4.SS2.p11.2.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p11.2.m2.1c">B</annotation></semantics></math> times. This issue is also encountered in other visually conditioned prompt methods <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al. <a href="#bib.bib47" title="" class="ltx_ref">2022a</a>)</cite>. To address this concern, we propose an enhanced strategy in Figure <a href="#S4.F3" title="Figure 3 ‣ 4.2 Federated Training ‣ 4 Method ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. By precomputing the text encodings for each key, we eliminate the need for redundant execution of the text encoder, leading to a significant reduction in inference costs.</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2211.07864/assets/x3.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="406" height="172" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Improve inference efficiency. </figcaption>
</figure>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2211.07864/assets/x4.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="261" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>(a) Office-Caltech10, which includes four domains. (b) DomainNet, which includes six domains.</figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We conduct extensive experiments to evaluate the efficacy of FedAPT. We aim to answer the following questions: 1) Can we achieve better performance with fewer learnable parameters in FL using the pre-trained model CLIP, compared to a fully-trained ViT or ResNet? 2) How much improvement in global model can FedAPT achieve compared to existing federated tuning algorithms?</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">We first compare FedAPT with various baselines on two large-scale multi-domain image classification datasets. We consider two scenarios, where each domain acts as a client independently and each domain is divided into five non-IID clients. Then we conduct several ablation studies to observe the impact of keys on the client model and global model. We also explore the impact of different initialized key values on the performance of the global model.</p>
</div>
<figure id="S5.T1" class="ltx_table">
<div id="S5.T1.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:249.6pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-59.2pt,34.0pt) scale(0.785423840360769,0.785423840360769) ;">
<table id="S5.T1.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S5.T1.1.1.1" class="ltx_tr" style="background-color:#DEDEDE;">
<td id="S5.T1.1.1.1.1" class="ltx_td ltx_align_center"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></td>
<td id="S5.T1.1.1.1.2" class="ltx_td ltx_border_r"></td>
<td id="S5.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T1.1.1.1.3.1" class="ltx_text" style="background-color:#DEDEDE;">zero-shot</span></td>
<td id="S5.T1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_r" colspan="2">fully-trained</td>
<td id="S5.T1.1.1.1.5" class="ltx_td ltx_align_center" colspan="6">fine-tune</td>
</tr>
<tr id="S5.T1.1.1.2" class="ltx_tr" style="background-color:#DEDEDE;">
<td id="S5.T1.1.1.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">
<table id="S5.T1.1.1.2.1.1" class="ltx_tabular ltx_align_middle" style="background-color:#DEDEDE;">
<tr id="S5.T1.1.1.2.1.1.1" class="ltx_tr">
<td id="S5.T1.1.1.2.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Datasets</td>
</tr>
<tr id="S5.T1.1.1.2.1.1.2" class="ltx_tr">
<td id="S5.T1.1.1.2.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">&amp; Domains</td>
</tr>
</table>
</td>
<td id="S5.T1.1.1.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">
<table id="S5.T1.1.1.2.2.1" class="ltx_tabular ltx_align_middle" style="background-color:#DEDEDE;">
<tr id="S5.T1.1.1.2.2.1.1" class="ltx_tr">
<td id="S5.T1.1.1.2.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">CLIP</td>
</tr>
<tr id="S5.T1.1.1.2.2.1.2" class="ltx_tr">
<td id="S5.T1.1.1.2.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">-zeroshot</td>
</tr>
</table>
</td>
<td id="S5.T1.1.1.2.3" class="ltx_td ltx_align_center ltx_border_tt">
<table id="S5.T1.1.1.2.3.1" class="ltx_tabular ltx_align_middle" style="background-color:#DEDEDE;">
<tr id="S5.T1.1.1.2.3.1.1" class="ltx_tr">
<td id="S5.T1.1.1.2.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">ResNet</td>
</tr>
<tr id="S5.T1.1.1.2.3.1.2" class="ltx_tr">
<td id="S5.T1.1.1.2.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">-full</td>
</tr>
</table>
</td>
<td id="S5.T1.1.1.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">
<table id="S5.T1.1.1.2.4.1" class="ltx_tabular ltx_align_middle" style="background-color:#DEDEDE;">
<tr id="S5.T1.1.1.2.4.1.1" class="ltx_tr">
<td id="S5.T1.1.1.2.4.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">ViT</td>
</tr>
<tr id="S5.T1.1.1.2.4.1.2" class="ltx_tr">
<td id="S5.T1.1.1.2.4.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">-full</td>
</tr>
</table>
</td>
<td id="S5.T1.1.1.2.5" class="ltx_td ltx_align_center ltx_border_tt">
<table id="S5.T1.1.1.2.5.1" class="ltx_tabular ltx_align_middle" style="background-color:#DEDEDE;">
<tr id="S5.T1.1.1.2.5.1.1" class="ltx_tr">
<td id="S5.T1.1.1.2.5.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">ResNet</td>
</tr>
<tr id="S5.T1.1.1.2.5.1.2" class="ltx_tr">
<td id="S5.T1.1.1.2.5.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">-tuning</td>
</tr>
</table>
</td>
<td id="S5.T1.1.1.2.6" class="ltx_td ltx_align_center ltx_border_tt">
<table id="S5.T1.1.1.2.6.1" class="ltx_tabular ltx_align_middle" style="background-color:#DEDEDE;">
<tr id="S5.T1.1.1.2.6.1.1" class="ltx_tr">
<td id="S5.T1.1.1.2.6.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">ViT</td>
</tr>
<tr id="S5.T1.1.1.2.6.1.2" class="ltx_tr">
<td id="S5.T1.1.1.2.6.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">-tuning</td>
</tr>
</table>
</td>
<td id="S5.T1.1.1.2.7" class="ltx_td ltx_align_center ltx_border_tt">
<table id="S5.T1.1.1.2.7.1" class="ltx_tabular ltx_align_middle" style="background-color:#DEDEDE;">
<tr id="S5.T1.1.1.2.7.1.1" class="ltx_tr">
<td id="S5.T1.1.1.2.7.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">CLIP</td>
</tr>
<tr id="S5.T1.1.1.2.7.1.2" class="ltx_tr">
<td id="S5.T1.1.1.2.7.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">-FC</td>
</tr>
</table>
</td>
<td id="S5.T1.1.1.2.8" class="ltx_td ltx_align_center ltx_border_tt">
<table id="S5.T1.1.1.2.8.1" class="ltx_tabular ltx_align_middle" style="background-color:#DEDEDE;">
<tr id="S5.T1.1.1.2.8.1.1" class="ltx_tr">
<td id="S5.T1.1.1.2.8.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Fed</td>
</tr>
<tr id="S5.T1.1.1.2.8.1.2" class="ltx_tr">
<td id="S5.T1.1.1.2.8.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">-CLIP</td>
</tr>
</table>
</td>
<td id="S5.T1.1.1.2.9" class="ltx_td ltx_align_center ltx_border_tt">
<table id="S5.T1.1.1.2.9.1" class="ltx_tabular ltx_align_middle" style="background-color:#DEDEDE;">
<tr id="S5.T1.1.1.2.9.1.1" class="ltx_tr">
<td id="S5.T1.1.1.2.9.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Prompt</td>
</tr>
<tr id="S5.T1.1.1.2.9.1.2" class="ltx_tr">
<td id="S5.T1.1.1.2.9.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">-FL</td>
</tr>
</table>
</td>
<td id="S5.T1.1.1.2.10" class="ltx_td ltx_align_center ltx_border_t">
<table id="S5.T1.1.1.2.10.1" class="ltx_tabular ltx_align_middle" style="background-color:#DEDEDE;">
<tr id="S5.T1.1.1.2.10.1.1" class="ltx_tr">
<td id="S5.T1.1.1.2.10.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Fed</td>
</tr>
<tr id="S5.T1.1.1.2.10.1.2" class="ltx_tr">
<td id="S5.T1.1.1.2.10.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">-APT</td>
</tr>
</table>
</td>
</tr>
<tr id="S5.T1.1.1.3" class="ltx_tr">
<td id="S5.T1.1.1.3.1" class="ltx_td ltx_align_center" colspan="4">
<span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span>
   <span id="S5.T1.1.1.3.1.1" class="ltx_text">DN</span></td>
<td id="S5.T1.1.1.3.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T1.1.1.3.2.1" class="ltx_text ltx_font_italic">c</span></td>
<td id="S5.T1.1.1.3.3" class="ltx_td ltx_align_center">65.86</td>
<td id="S5.T1.1.1.3.4" class="ltx_td ltx_align_center">32.44</td>
<td id="S5.T1.1.1.3.5" class="ltx_td ltx_align_center">63.55</td>
<td id="S5.T1.1.1.3.6" class="ltx_td ltx_align_center">52.32</td>
<td id="S5.T1.1.1.3.7" class="ltx_td ltx_align_center">71.93</td>
<td id="S5.T1.1.1.3.8" class="ltx_td ltx_align_center">74.53</td>
<td id="S5.T1.1.1.3.9" class="ltx_td ltx_nopad_r ltx_align_center">70.25</td>
<td id="S5.T1.1.1.3.10" class="ltx_td ltx_nopad_r ltx_align_center">75.84</td>
<td id="S5.T1.1.1.3.11" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.T1.1.1.3.11.1" class="ltx_text ltx_font_bold">77.36</span></td>
</tr>
<tr id="S5.T1.1.1.4" class="ltx_tr">
<td id="S5.T1.1.1.4.1" class="ltx_td ltx_border_r"></td>
<td id="S5.T1.1.1.4.2" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T1.1.1.4.2.1" class="ltx_text ltx_font_italic">i</span></td>
<td id="S5.T1.1.1.4.3" class="ltx_td ltx_align_center ltx_border_r">40.50</td>
<td id="S5.T1.1.1.4.4" class="ltx_td ltx_align_center">59.58</td>
<td id="S5.T1.1.1.4.5" class="ltx_td ltx_align_center ltx_border_r">27.07</td>
<td id="S5.T1.1.1.4.6" class="ltx_td ltx_align_center">20.85</td>
<td id="S5.T1.1.1.4.7" class="ltx_td ltx_align_center">48.39</td>
<td id="S5.T1.1.1.4.8" class="ltx_td ltx_align_center">48.00</td>
<td id="S5.T1.1.1.4.9" class="ltx_td ltx_align_center">45.70</td>
<td id="S5.T1.1.1.4.10" class="ltx_td ltx_align_center">49.82</td>
<td id="S5.T1.1.1.4.11" class="ltx_td ltx_align_center"><span id="S5.T1.1.1.4.11.1" class="ltx_text ltx_font_bold">52.17</span></td>
</tr>
<tr id="S5.T1.1.1.5" class="ltx_tr">
<td id="S5.T1.1.1.5.1" class="ltx_td ltx_border_r"></td>
<td id="S5.T1.1.1.5.2" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T1.1.1.5.2.1" class="ltx_text ltx_font_italic">p</span></td>
<td id="S5.T1.1.1.5.3" class="ltx_td ltx_align_center ltx_border_r">62.25</td>
<td id="S5.T1.1.1.5.4" class="ltx_td ltx_align_center">59.58</td>
<td id="S5.T1.1.1.5.5" class="ltx_td ltx_align_center ltx_border_r">49.00</td>
<td id="S5.T1.1.1.5.6" class="ltx_td ltx_align_center">44.66</td>
<td id="S5.T1.1.1.5.7" class="ltx_td ltx_align_center">68.06</td>
<td id="S5.T1.1.1.5.8" class="ltx_td ltx_align_center">69.08</td>
<td id="S5.T1.1.1.5.9" class="ltx_td ltx_align_center">66.16</td>
<td id="S5.T1.1.1.5.10" class="ltx_td ltx_align_center">70.81</td>
<td id="S5.T1.1.1.5.11" class="ltx_td ltx_align_center"><span id="S5.T1.1.1.5.11.1" class="ltx_text ltx_font_bold">72.51</span></td>
</tr>
<tr id="S5.T1.1.1.6" class="ltx_tr">
<td id="S5.T1.1.1.6.1" class="ltx_td ltx_border_r"></td>
<td id="S5.T1.1.1.6.2" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T1.1.1.6.2.1" class="ltx_text ltx_font_italic">q</span></td>
<td id="S5.T1.1.1.6.3" class="ltx_td ltx_align_center ltx_border_r">13.36</td>
<td id="S5.T1.1.1.6.4" class="ltx_td ltx_align_center">43.25</td>
<td id="S5.T1.1.1.6.5" class="ltx_td ltx_align_center ltx_border_r">62.20</td>
<td id="S5.T1.1.1.6.6" class="ltx_td ltx_align_center">7.13</td>
<td id="S5.T1.1.1.6.7" class="ltx_td ltx_align_center">21.24</td>
<td id="S5.T1.1.1.6.8" class="ltx_td ltx_align_center">31.84</td>
<td id="S5.T1.1.1.6.9" class="ltx_td ltx_align_center">16.98</td>
<td id="S5.T1.1.1.6.10" class="ltx_td ltx_align_center">32.98</td>
<td id="S5.T1.1.1.6.11" class="ltx_td ltx_align_center"><span id="S5.T1.1.1.6.11.1" class="ltx_text ltx_font_bold">48.84</span></td>
</tr>
<tr id="S5.T1.1.1.7" class="ltx_tr">
<td id="S5.T1.1.1.7.1" class="ltx_td ltx_border_r"></td>
<td id="S5.T1.1.1.7.2" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T1.1.1.7.2.1" class="ltx_text ltx_font_italic">r</span></td>
<td id="S5.T1.1.1.7.3" class="ltx_td ltx_align_center ltx_border_r">80.04</td>
<td id="S5.T1.1.1.7.4" class="ltx_td ltx_align_center">74.73</td>
<td id="S5.T1.1.1.7.5" class="ltx_td ltx_align_center ltx_border_r">68.35</td>
<td id="S5.T1.1.1.7.6" class="ltx_td ltx_align_center">65.85</td>
<td id="S5.T1.1.1.7.7" class="ltx_td ltx_align_center">80.43</td>
<td id="S5.T1.1.1.7.8" class="ltx_td ltx_align_center">83.87</td>
<td id="S5.T1.1.1.7.9" class="ltx_td ltx_align_center">83.04</td>
<td id="S5.T1.1.1.7.10" class="ltx_td ltx_align_center">83.55</td>
<td id="S5.T1.1.1.7.11" class="ltx_td ltx_align_center"><span id="S5.T1.1.1.7.11.1" class="ltx_text ltx_font_bold">84.79</span></td>
</tr>
<tr id="S5.T1.1.1.8" class="ltx_tr">
<td id="S5.T1.1.1.8.1" class="ltx_td ltx_border_r"></td>
<td id="S5.T1.1.1.8.2" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T1.1.1.8.2.1" class="ltx_text ltx_font_italic">s</span></td>
<td id="S5.T1.1.1.8.3" class="ltx_td ltx_align_center ltx_border_r">57.92</td>
<td id="S5.T1.1.1.8.4" class="ltx_td ltx_align_center">61.81</td>
<td id="S5.T1.1.1.8.5" class="ltx_td ltx_align_center ltx_border_r">54.05</td>
<td id="S5.T1.1.1.8.6" class="ltx_td ltx_align_center">38.33</td>
<td id="S5.T1.1.1.8.7" class="ltx_td ltx_align_center">63.45</td>
<td id="S5.T1.1.1.8.8" class="ltx_td ltx_align_center">65.29</td>
<td id="S5.T1.1.1.8.9" class="ltx_td ltx_align_center">61.75</td>
<td id="S5.T1.1.1.8.10" class="ltx_td ltx_align_center">67.31</td>
<td id="S5.T1.1.1.8.11" class="ltx_td ltx_align_center"><span id="S5.T1.1.1.8.11.1" class="ltx_text ltx_font_bold">68.69</span></td>
</tr>
<tr id="S5.T1.1.1.9" class="ltx_tr">
<td id="S5.T1.1.1.9.1" class="ltx_td ltx_border_r"></td>
<td id="S5.T1.1.1.9.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">avg</td>
<td id="S5.T1.1.1.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">53.32</td>
<td id="S5.T1.1.1.9.4" class="ltx_td ltx_align_center ltx_border_t">55.23</td>
<td id="S5.T1.1.1.9.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">54.04</td>
<td id="S5.T1.1.1.9.6" class="ltx_td ltx_align_center ltx_border_t">38.19</td>
<td id="S5.T1.1.1.9.7" class="ltx_td ltx_align_center ltx_border_t">58.92</td>
<td id="S5.T1.1.1.9.8" class="ltx_td ltx_align_center ltx_border_t">62.10</td>
<td id="S5.T1.1.1.9.9" class="ltx_td ltx_align_center ltx_border_t">57.31</td>
<td id="S5.T1.1.1.9.10" class="ltx_td ltx_align_center ltx_border_t">63.39</td>
<td id="S5.T1.1.1.9.11" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.1.1.9.11.1" class="ltx_text ltx_font_bold">67.39</span></td>
</tr>
<tr id="S5.T1.1.1.10" class="ltx_tr">
<td id="S5.T1.1.1.10.1" class="ltx_td ltx_align_center" colspan="4">
<span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span>
   <span id="S5.T1.1.1.10.1.1" class="ltx_text">
<span id="S5.T1.1.1.10.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T1.1.1.10.1.1.1.1" class="ltx_tr">
<span id="S5.T1.1.1.10.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">OC</span></span>
</span></span></td>
<td id="S5.T1.1.1.10.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T1.1.1.10.2.1" class="ltx_text ltx_font_italic">a</span></td>
<td id="S5.T1.1.1.10.3" class="ltx_td ltx_align_center">95.69</td>
<td id="S5.T1.1.1.10.4" class="ltx_td ltx_align_center">95.31</td>
<td id="S5.T1.1.1.10.5" class="ltx_td ltx_align_center">36.97</td>
<td id="S5.T1.1.1.10.6" class="ltx_td ltx_align_center">95.31</td>
<td id="S5.T1.1.1.10.7" class="ltx_td ltx_align_center"><span id="S5.T1.1.1.10.7.1" class="ltx_text ltx_font_bold">96.87</span></td>
<td id="S5.T1.1.1.10.8" class="ltx_td ltx_align_center">96.35</td>
<td id="S5.T1.1.1.10.9" class="ltx_td ltx_nopad_r ltx_align_center">95.31</td>
<td id="S5.T1.1.1.10.10" class="ltx_td ltx_nopad_r ltx_align_center">95.83</td>
<td id="S5.T1.1.1.10.11" class="ltx_td ltx_nopad_r ltx_align_center">95.83</td>
</tr>
<tr id="S5.T1.1.1.11" class="ltx_tr">
<td id="S5.T1.1.1.11.1" class="ltx_td ltx_border_r"></td>
<td id="S5.T1.1.1.11.2" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T1.1.1.11.2.1" class="ltx_text ltx_font_italic">w</span></td>
<td id="S5.T1.1.1.11.3" class="ltx_td ltx_align_center ltx_border_r">93.24</td>
<td id="S5.T1.1.1.11.4" class="ltx_td ltx_align_center">100.00</td>
<td id="S5.T1.1.1.11.5" class="ltx_td ltx_align_center ltx_border_r">36.20</td>
<td id="S5.T1.1.1.11.6" class="ltx_td ltx_align_center">98.27</td>
<td id="S5.T1.1.1.11.7" class="ltx_td ltx_align_center">100.00</td>
<td id="S5.T1.1.1.11.8" class="ltx_td ltx_align_center">100.00</td>
<td id="S5.T1.1.1.11.9" class="ltx_td ltx_align_center">98.27</td>
<td id="S5.T1.1.1.11.10" class="ltx_td ltx_align_center">98.27</td>
<td id="S5.T1.1.1.11.11" class="ltx_td ltx_align_center"><span id="S5.T1.1.1.11.11.1" class="ltx_text ltx_font_bold">100.00</span></td>
</tr>
<tr id="S5.T1.1.1.12" class="ltx_tr">
<td id="S5.T1.1.1.12.1" class="ltx_td ltx_border_r"></td>
<td id="S5.T1.1.1.12.2" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T1.1.1.12.2.1" class="ltx_text ltx_font_italic">d</span></td>
<td id="S5.T1.1.1.12.3" class="ltx_td ltx_align_center ltx_border_r">95.23</td>
<td id="S5.T1.1.1.12.4" class="ltx_td ltx_align_center">100.00</td>
<td id="S5.T1.1.1.12.5" class="ltx_td ltx_align_center ltx_border_r">12.90</td>
<td id="S5.T1.1.1.12.6" class="ltx_td ltx_align_center">93.54</td>
<td id="S5.T1.1.1.12.7" class="ltx_td ltx_align_center">96.77</td>
<td id="S5.T1.1.1.12.8" class="ltx_td ltx_align_center">93.54</td>
<td id="S5.T1.1.1.12.9" class="ltx_td ltx_align_center">96.77</td>
<td id="S5.T1.1.1.12.10" class="ltx_td ltx_align_center">96.77</td>
<td id="S5.T1.1.1.12.11" class="ltx_td ltx_align_center"><span id="S5.T1.1.1.12.11.1" class="ltx_text ltx_font_bold">100.00</span></td>
</tr>
<tr id="S5.T1.1.1.13" class="ltx_tr">
<td id="S5.T1.1.1.13.1" class="ltx_td ltx_border_r"></td>
<td id="S5.T1.1.1.13.2" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T1.1.1.13.2.1" class="ltx_text ltx_font_italic">c</span></td>
<td id="S5.T1.1.1.13.3" class="ltx_td ltx_align_center ltx_border_r">92.54</td>
<td id="S5.T1.1.1.13.4" class="ltx_td ltx_align_center">96.44</td>
<td id="S5.T1.1.1.13.5" class="ltx_td ltx_align_center ltx_border_r">29.77</td>
<td id="S5.T1.1.1.13.6" class="ltx_td ltx_align_center">93.77</td>
<td id="S5.T1.1.1.13.7" class="ltx_td ltx_align_center">97.33</td>
<td id="S5.T1.1.1.13.8" class="ltx_td ltx_align_center">96.00</td>
<td id="S5.T1.1.1.13.9" class="ltx_td ltx_align_center">96.00</td>
<td id="S5.T1.1.1.13.10" class="ltx_td ltx_align_center"><span id="S5.T1.1.1.13.10.1" class="ltx_text ltx_font_bold">98.22</span></td>
<td id="S5.T1.1.1.13.11" class="ltx_td ltx_align_center">96.44</td>
</tr>
<tr id="S5.T1.1.1.14" class="ltx_tr">
<td id="S5.T1.1.1.14.1" class="ltx_td ltx_border_r"></td>
<td id="S5.T1.1.1.14.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">avg</td>
<td id="S5.T1.1.1.14.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">94.18</td>
<td id="S5.T1.1.1.14.4" class="ltx_td ltx_align_center ltx_border_t">97.94</td>
<td id="S5.T1.1.1.14.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">28.96</td>
<td id="S5.T1.1.1.14.6" class="ltx_td ltx_align_center ltx_border_t">95.22</td>
<td id="S5.T1.1.1.14.7" class="ltx_td ltx_align_center ltx_border_t">97.74</td>
<td id="S5.T1.1.1.14.8" class="ltx_td ltx_align_center ltx_border_t">96.47</td>
<td id="S5.T1.1.1.14.9" class="ltx_td ltx_align_center ltx_border_t">96.58</td>
<td id="S5.T1.1.1.14.10" class="ltx_td ltx_align_center ltx_border_t">97.27</td>
<td id="S5.T1.1.1.14.11" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.1.1.14.11.1" class="ltx_text ltx_font_bold">98.07</span></td>
</tr>
<tr id="S5.T1.1.1.15" class="ltx_tr">
<td id="S5.T1.1.1.15.1" class="ltx_td ltx_align_center" colspan="4">
<span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span>      #params (M)</td>
<td id="S5.T1.1.1.15.2" class="ltx_td ltx_align_center ltx_border_r">0</td>
<td id="S5.T1.1.1.15.3" class="ltx_td ltx_align_center">24.21</td>
<td id="S5.T1.1.1.15.4" class="ltx_td ltx_align_center">87.86</td>
<td id="S5.T1.1.1.15.5" class="ltx_td ltx_align_center">0.71</td>
<td id="S5.T1.1.1.15.6" class="ltx_td ltx_align_center">0.18</td>
<td id="S5.T1.1.1.15.7" class="ltx_td ltx_align_center">0.26</td>
<td id="S5.T1.1.1.15.8" class="ltx_td ltx_align_center">0.52</td>
<td id="S5.T1.1.1.15.9" class="ltx_td ltx_nopad_r ltx_align_center">2.826</td>
<td id="S5.T1.1.1.15.10" class="ltx_td ltx_nopad_r ltx_align_center">2.829</td>
</tr>
<tr id="S5.T1.1.1.16" class="ltx_tr">
<td id="S5.T1.1.1.16.1" class="ltx_td ltx_align_center"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></td>
<td id="S5.T1.1.1.16.2" class="ltx_td"></td>
<td id="S5.T1.1.1.16.3" class="ltx_td"></td>
<td id="S5.T1.1.1.16.4" class="ltx_td"></td>
<td id="S5.T1.1.1.16.5" class="ltx_td"></td>
<td id="S5.T1.1.1.16.6" class="ltx_td"></td>
<td id="S5.T1.1.1.16.7" class="ltx_td"></td>
<td id="S5.T1.1.1.16.8" class="ltx_td"></td>
<td id="S5.T1.1.1.16.9" class="ltx_td"></td>
<td id="S5.T1.1.1.16.10" class="ltx_td"></td>
<td id="S5.T1.1.1.16.11" class="ltx_td"></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span> The accuracy of the global model in various domains in supervised setting with domain differences. The last row is the number of parameters to be transmitted in each round of communication. Overall, these results indicate that FedAPT achieves the best performance with few learnable parameters.</figcaption>
</figure>
<figure id="S5.T2" class="ltx_table">
<div id="S5.T2.7" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:489.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(9.3pt,-10.5pt) scale(1.04500551172477,1.04500551172477) ;">
<table id="S5.T2.7.7" class="ltx_tabular ltx_align_middle">
<tr id="S5.T2.1.1.1" class="ltx_tr" style="background-color:#DEDEDE;">
<td id="S5.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></td>
<td id="S5.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_border_r"><math id="S5.T2.1.1.1.1.m1.1" class="ltx_Math" style="background-color:#DEDEDE;" alttext="\beta" display="inline"><semantics id="S5.T2.1.1.1.1.m1.1a"><mi mathbackground="#DEDEDE" id="S5.T2.1.1.1.1.m1.1.1" xref="S5.T2.1.1.1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.1.m1.1b"><ci id="S5.T2.1.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.1.m1.1c">\beta</annotation></semantics></math></td>
<td id="S5.T2.1.1.1.3" class="ltx_td ltx_border_r"></td>
<td id="S5.T2.1.1.1.4" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.1.4.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">c</span></td>
<td id="S5.T2.1.1.1.5" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.1.5.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">i</span></td>
<td id="S5.T2.1.1.1.6" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.1.6.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">p</span></td>
<td id="S5.T2.1.1.1.7" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.1.7.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">q</span></td>
<td id="S5.T2.1.1.1.8" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.1.8.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">r</span></td>
<td id="S5.T2.1.1.1.9" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T2.1.1.1.9.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">s</span></td>
<td id="S5.T2.1.1.1.10" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.1.10.1" class="ltx_text ltx_font_bold" style="background-color:#DEDEDE;">Average</span></td>
</tr>
<tr id="S5.T2.2.2.2" class="ltx_tr">
<td id="S5.T2.2.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="12"><span id="S5.T2.2.2.2.2.1" class="ltx_text">by domain</span></td>
<td id="S5.T2.2.2.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="4"><span id="S5.T2.2.2.2.1.1" class="ltx_text"><math id="S5.T2.2.2.2.1.1.m1.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="S5.T2.2.2.2.1.1.m1.1a"><mn id="S5.T2.2.2.2.1.1.m1.1.1" xref="S5.T2.2.2.2.1.1.m1.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="S5.T2.2.2.2.1.1.m1.1b"><cn type="float" id="S5.T2.2.2.2.1.1.m1.1.1.cmml" xref="S5.T2.2.2.2.1.1.m1.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.2.2.1.1.m1.1c">0.01</annotation></semantics></math></span></td>
<td id="S5.T2.2.2.2.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">CLIP-FC</td>
<td id="S5.T2.2.2.2.4" class="ltx_td ltx_align_center ltx_border_t">67.60</td>
<td id="S5.T2.2.2.2.5" class="ltx_td ltx_align_center ltx_border_t">44.39</td>
<td id="S5.T2.2.2.2.6" class="ltx_td ltx_align_center ltx_border_t">65.32</td>
<td id="S5.T2.2.2.2.7" class="ltx_td ltx_align_center ltx_border_t">22.97</td>
<td id="S5.T2.2.2.2.8" class="ltx_td ltx_align_center ltx_border_t">79.42</td>
<td id="S5.T2.2.2.2.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">59.66</td>
<td id="S5.T2.2.2.2.10" class="ltx_td ltx_align_center ltx_border_t">56.56</td>
</tr>
<tr id="S5.T2.7.7.8" class="ltx_tr">
<td id="S5.T2.7.7.8.1" class="ltx_td ltx_align_left ltx_border_r">FedCLIP</td>
<td id="S5.T2.7.7.8.2" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.8.2.1" class="ltx_text ltx_font_bold">68.41</span></td>
<td id="S5.T2.7.7.8.3" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.8.3.1" class="ltx_text ltx_font_bold">45.04</span></td>
<td id="S5.T2.7.7.8.4" class="ltx_td ltx_align_center">64.41</td>
<td id="S5.T2.7.7.8.5" class="ltx_td ltx_align_center">16.76</td>
<td id="S5.T2.7.7.8.6" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.8.6.1" class="ltx_text ltx_font_bold">82.22</span></td>
<td id="S5.T2.7.7.8.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T2.7.7.8.7.1" class="ltx_text ltx_font_bold">60.08</span></td>
<td id="S5.T2.7.7.8.8" class="ltx_td ltx_align_center">56.15</td>
</tr>
<tr id="S5.T2.7.7.9" class="ltx_tr">
<td id="S5.T2.7.7.9.1" class="ltx_td ltx_align_left ltx_border_r">PromptFL</td>
<td id="S5.T2.7.7.9.2" class="ltx_td ltx_align_center">66.68</td>
<td id="S5.T2.7.7.9.3" class="ltx_td ltx_align_center">43.75</td>
<td id="S5.T2.7.7.9.4" class="ltx_td ltx_align_center">65.31</td>
<td id="S5.T2.7.7.9.5" class="ltx_td ltx_align_center">24.45</td>
<td id="S5.T2.7.7.9.6" class="ltx_td ltx_align_center">77.75</td>
<td id="S5.T2.7.7.9.7" class="ltx_td ltx_align_center ltx_border_r">58.74</td>
<td id="S5.T2.7.7.9.8" class="ltx_td ltx_align_center">56.11</td>
</tr>
<tr id="S5.T2.7.7.10" class="ltx_tr">
<td id="S5.T2.7.7.10.1" class="ltx_td ltx_align_left ltx_border_r">FedAPT</td>
<td id="S5.T2.7.7.10.2" class="ltx_td ltx_align_center">67.21</td>
<td id="S5.T2.7.7.10.3" class="ltx_td ltx_align_center">43.69</td>
<td id="S5.T2.7.7.10.4" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.10.4.1" class="ltx_text ltx_font_bold">66.43</span></td>
<td id="S5.T2.7.7.10.5" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.10.5.1" class="ltx_text ltx_font_bold">26.70</span></td>
<td id="S5.T2.7.7.10.6" class="ltx_td ltx_align_center">77.88</td>
<td id="S5.T2.7.7.10.7" class="ltx_td ltx_align_center ltx_border_r">57.85</td>
<td id="S5.T2.7.7.10.8" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.10.8.1" class="ltx_text ltx_font_bold">56.63</span></td>
</tr>
<tr id="S5.T2.3.3.3" class="ltx_tr">
<td id="S5.T2.3.3.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="4"><span id="S5.T2.3.3.3.1.1" class="ltx_text"><math id="S5.T2.3.3.3.1.1.m1.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="S5.T2.3.3.3.1.1.m1.1a"><mn id="S5.T2.3.3.3.1.1.m1.1.1" xref="S5.T2.3.3.3.1.1.m1.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="S5.T2.3.3.3.1.1.m1.1b"><cn type="float" id="S5.T2.3.3.3.1.1.m1.1.1.cmml" xref="S5.T2.3.3.3.1.1.m1.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.3.3.1.1.m1.1c">0.5</annotation></semantics></math></span></td>
<td id="S5.T2.3.3.3.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">CLIP-FC</td>
<td id="S5.T2.3.3.3.3" class="ltx_td ltx_align_center ltx_border_t">71.86</td>
<td id="S5.T2.3.3.3.4" class="ltx_td ltx_align_center ltx_border_t">46.70</td>
<td id="S5.T2.3.3.3.5" class="ltx_td ltx_align_center ltx_border_t">68.10</td>
<td id="S5.T2.3.3.3.6" class="ltx_td ltx_align_center ltx_border_t">31.86</td>
<td id="S5.T2.3.3.3.7" class="ltx_td ltx_align_center ltx_border_t">83.05</td>
<td id="S5.T2.3.3.3.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">63.29</td>
<td id="S5.T2.3.3.3.9" class="ltx_td ltx_align_center ltx_border_t">60.81</td>
</tr>
<tr id="S5.T2.7.7.11" class="ltx_tr">
<td id="S5.T2.7.7.11.1" class="ltx_td ltx_align_left ltx_border_r">FedCLIP</td>
<td id="S5.T2.7.7.11.2" class="ltx_td ltx_align_center">69.54</td>
<td id="S5.T2.7.7.11.3" class="ltx_td ltx_align_center">45.61</td>
<td id="S5.T2.7.7.11.4" class="ltx_td ltx_align_center">65.15</td>
<td id="S5.T2.7.7.11.5" class="ltx_td ltx_align_center">18.00</td>
<td id="S5.T2.7.7.11.6" class="ltx_td ltx_align_center">82.61</td>
<td id="S5.T2.7.7.11.7" class="ltx_td ltx_align_center ltx_border_r">60.39</td>
<td id="S5.T2.7.7.11.8" class="ltx_td ltx_align_center">56.88</td>
</tr>
<tr id="S5.T2.7.7.12" class="ltx_tr">
<td id="S5.T2.7.7.12.1" class="ltx_td ltx_align_left ltx_border_r">PromptFL</td>
<td id="S5.T2.7.7.12.2" class="ltx_td ltx_align_center">73.19</td>
<td id="S5.T2.7.7.12.3" class="ltx_td ltx_align_center">47.72</td>
<td id="S5.T2.7.7.12.4" class="ltx_td ltx_align_center">69.59</td>
<td id="S5.T2.7.7.12.5" class="ltx_td ltx_align_center">37.31</td>
<td id="S5.T2.7.7.12.6" class="ltx_td ltx_align_center">82.98</td>
<td id="S5.T2.7.7.12.7" class="ltx_td ltx_align_center ltx_border_r">64.85</td>
<td id="S5.T2.7.7.12.8" class="ltx_td ltx_align_center">62.61</td>
</tr>
<tr id="S5.T2.7.7.13" class="ltx_tr">
<td id="S5.T2.7.7.13.1" class="ltx_td ltx_align_left ltx_border_r">FedAPT</td>
<td id="S5.T2.7.7.13.2" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.13.2.1" class="ltx_text ltx_font_bold">74.70</span></td>
<td id="S5.T2.7.7.13.3" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.13.3.1" class="ltx_text ltx_font_bold">49.94</span></td>
<td id="S5.T2.7.7.13.4" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.13.4.1" class="ltx_text ltx_font_bold">71.27</span></td>
<td id="S5.T2.7.7.13.5" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.13.5.1" class="ltx_text ltx_font_bold">46.89</span></td>
<td id="S5.T2.7.7.13.6" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.13.6.1" class="ltx_text ltx_font_bold">84.41</span></td>
<td id="S5.T2.7.7.13.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T2.7.7.13.7.1" class="ltx_text ltx_font_bold">66.61</span></td>
<td id="S5.T2.7.7.13.8" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.13.8.1" class="ltx_text ltx_font_bold">65.64</span></td>
</tr>
<tr id="S5.T2.4.4.4" class="ltx_tr">
<td id="S5.T2.4.4.4.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="4"><span id="S5.T2.4.4.4.1.1" class="ltx_text"><math id="S5.T2.4.4.4.1.1.m1.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S5.T2.4.4.4.1.1.m1.1a"><mn id="S5.T2.4.4.4.1.1.m1.1.1" xref="S5.T2.4.4.4.1.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S5.T2.4.4.4.1.1.m1.1b"><cn type="integer" id="S5.T2.4.4.4.1.1.m1.1.1.cmml" xref="S5.T2.4.4.4.1.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.4.4.1.1.m1.1c">5</annotation></semantics></math></span></td>
<td id="S5.T2.4.4.4.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">CLIP-FC</td>
<td id="S5.T2.4.4.4.3" class="ltx_td ltx_align_center ltx_border_t">73.50</td>
<td id="S5.T2.4.4.4.4" class="ltx_td ltx_align_center ltx_border_t">47.34</td>
<td id="S5.T2.4.4.4.5" class="ltx_td ltx_align_center ltx_border_t">68.62</td>
<td id="S5.T2.4.4.4.6" class="ltx_td ltx_align_center ltx_border_t">34.00</td>
<td id="S5.T2.4.4.4.7" class="ltx_td ltx_align_center ltx_border_t">83.86</td>
<td id="S5.T2.4.4.4.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">64.37</td>
<td id="S5.T2.4.4.4.9" class="ltx_td ltx_align_center ltx_border_t">61.95</td>
</tr>
<tr id="S5.T2.7.7.14" class="ltx_tr">
<td id="S5.T2.7.7.14.1" class="ltx_td ltx_align_left ltx_border_r">FedCLIP</td>
<td id="S5.T2.7.7.14.2" class="ltx_td ltx_align_center">69.37</td>
<td id="S5.T2.7.7.14.3" class="ltx_td ltx_align_center">45.61</td>
<td id="S5.T2.7.7.14.4" class="ltx_td ltx_align_center">65.58</td>
<td id="S5.T2.7.7.14.5" class="ltx_td ltx_align_center">18.67</td>
<td id="S5.T2.7.7.14.6" class="ltx_td ltx_align_center">82.77</td>
<td id="S5.T2.7.7.14.7" class="ltx_td ltx_align_center ltx_border_r">60.73</td>
<td id="S5.T2.7.7.14.8" class="ltx_td ltx_align_center">57.12</td>
</tr>
<tr id="S5.T2.7.7.15" class="ltx_tr">
<td id="S5.T2.7.7.15.1" class="ltx_td ltx_align_left ltx_border_r">PromptFL</td>
<td id="S5.T2.7.7.15.2" class="ltx_td ltx_align_center">74.49</td>
<td id="S5.T2.7.7.15.3" class="ltx_td ltx_align_center">48.34</td>
<td id="S5.T2.7.7.15.4" class="ltx_td ltx_align_center">69.77</td>
<td id="S5.T2.7.7.15.5" class="ltx_td ltx_align_center">38.30</td>
<td id="S5.T2.7.7.15.6" class="ltx_td ltx_align_center">83.94</td>
<td id="S5.T2.7.7.15.7" class="ltx_td ltx_align_center ltx_border_r">66.05</td>
<td id="S5.T2.7.7.15.8" class="ltx_td ltx_align_center">63.48</td>
</tr>
<tr id="S5.T2.7.7.16" class="ltx_tr">
<td id="S5.T2.7.7.16.1" class="ltx_td ltx_align_left ltx_border_r">FedAPT</td>
<td id="S5.T2.7.7.16.2" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.16.2.1" class="ltx_text ltx_font_bold">75.64</span></td>
<td id="S5.T2.7.7.16.3" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.16.3.1" class="ltx_text ltx_font_bold">50.63</span></td>
<td id="S5.T2.7.7.16.4" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.16.4.1" class="ltx_text ltx_font_bold">71.59</span></td>
<td id="S5.T2.7.7.16.5" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.16.5.1" class="ltx_text ltx_font_bold">50.55</span></td>
<td id="S5.T2.7.7.16.6" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.16.6.1" class="ltx_text ltx_font_bold">85.02</span></td>
<td id="S5.T2.7.7.16.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T2.7.7.16.7.1" class="ltx_text ltx_font_bold">67.63</span></td>
<td id="S5.T2.7.7.16.8" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.16.8.1" class="ltx_text ltx_font_bold">66.84</span></td>
</tr>
<tr id="S5.T2.5.5.5" class="ltx_tr">
<td id="S5.T2.5.5.5.2" class="ltx_td ltx_align_center ltx_border_r" rowspan="12">
<span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span>
<span id="S5.T2.5.5.5.2.1" class="ltx_text">by random</span>
</td>
<td id="S5.T2.5.5.5.1" class="ltx_td ltx_align_center ltx_border_r" rowspan="4"><span id="S5.T2.5.5.5.1.1" class="ltx_text"><math id="S5.T2.5.5.5.1.1.m1.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="S5.T2.5.5.5.1.1.m1.1a"><mn id="S5.T2.5.5.5.1.1.m1.1.1" xref="S5.T2.5.5.5.1.1.m1.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="S5.T2.5.5.5.1.1.m1.1b"><cn type="float" id="S5.T2.5.5.5.1.1.m1.1.1.cmml" xref="S5.T2.5.5.5.1.1.m1.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.5.5.1.1.m1.1c">0.01</annotation></semantics></math></span></td>
<td id="S5.T2.5.5.5.3" class="ltx_td ltx_align_left ltx_border_r">CLIP-FC</td>
<td id="S5.T2.5.5.5.4" class="ltx_td ltx_align_center">70.36</td>
<td id="S5.T2.5.5.5.5" class="ltx_td ltx_align_center">44.55</td>
<td id="S5.T2.5.5.5.6" class="ltx_td ltx_align_center"><span id="S5.T2.5.5.5.6.1" class="ltx_text ltx_font_bold">66.59</span></td>
<td id="S5.T2.5.5.5.7" class="ltx_td ltx_align_center">21.10</td>
<td id="S5.T2.5.5.5.8" class="ltx_td ltx_align_center">80.03</td>
<td id="S5.T2.5.5.5.9" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T2.5.5.5.9.1" class="ltx_text ltx_font_bold">60.78</span></td>
<td id="S5.T2.5.5.5.10" class="ltx_td ltx_align_center"><span id="S5.T2.5.5.5.10.1" class="ltx_text ltx_font_bold">57.24</span></td>
</tr>
<tr id="S5.T2.7.7.17" class="ltx_tr">
<td id="S5.T2.7.7.17.1" class="ltx_td ltx_align_left ltx_border_r">FedCLIP</td>
<td id="S5.T2.7.7.17.2" class="ltx_td ltx_align_center">68.04</td>
<td id="S5.T2.7.7.17.3" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.17.3.1" class="ltx_text ltx_font_bold">45.10</span></td>
<td id="S5.T2.7.7.17.4" class="ltx_td ltx_align_center">63.45</td>
<td id="S5.T2.7.7.17.5" class="ltx_td ltx_align_center">16.45</td>
<td id="S5.T2.7.7.17.6" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.17.6.1" class="ltx_text ltx_font_bold">81.93</span></td>
<td id="S5.T2.7.7.17.7" class="ltx_td ltx_align_center ltx_border_r">59.26</td>
<td id="S5.T2.7.7.17.8" class="ltx_td ltx_align_center">55.70</td>
</tr>
<tr id="S5.T2.7.7.18" class="ltx_tr">
<td id="S5.T2.7.7.18.1" class="ltx_td ltx_align_left ltx_border_r">PromptFL</td>
<td id="S5.T2.7.7.18.2" class="ltx_td ltx_align_center">69.68</td>
<td id="S5.T2.7.7.18.3" class="ltx_td ltx_align_center">41.59</td>
<td id="S5.T2.7.7.18.4" class="ltx_td ltx_align_center">65.19</td>
<td id="S5.T2.7.7.18.5" class="ltx_td ltx_align_center">22.41</td>
<td id="S5.T2.7.7.18.6" class="ltx_td ltx_align_center">77.87</td>
<td id="S5.T2.7.7.18.7" class="ltx_td ltx_align_center ltx_border_r">59.40</td>
<td id="S5.T2.7.7.18.8" class="ltx_td ltx_align_center">56.02</td>
</tr>
<tr id="S5.T2.7.7.19" class="ltx_tr">
<td id="S5.T2.7.7.19.1" class="ltx_td ltx_align_left ltx_border_r">FedAPT</td>
<td id="S5.T2.7.7.19.2" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.19.2.1" class="ltx_text ltx_font_bold">70.50</span></td>
<td id="S5.T2.7.7.19.3" class="ltx_td ltx_align_center">42.17</td>
<td id="S5.T2.7.7.19.4" class="ltx_td ltx_align_center">66.18</td>
<td id="S5.T2.7.7.19.5" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.19.5.1" class="ltx_text ltx_font_bold">27.48</span></td>
<td id="S5.T2.7.7.19.6" class="ltx_td ltx_align_center">77.22</td>
<td id="S5.T2.7.7.19.7" class="ltx_td ltx_align_center ltx_border_r">59.41</td>
<td id="S5.T2.7.7.19.8" class="ltx_td ltx_align_center">57.16</td>
</tr>
<tr id="S5.T2.6.6.6" class="ltx_tr">
<td id="S5.T2.6.6.6.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="4"><span id="S5.T2.6.6.6.1.1" class="ltx_text"><math id="S5.T2.6.6.6.1.1.m1.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="S5.T2.6.6.6.1.1.m1.1a"><mn id="S5.T2.6.6.6.1.1.m1.1.1" xref="S5.T2.6.6.6.1.1.m1.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="S5.T2.6.6.6.1.1.m1.1b"><cn type="float" id="S5.T2.6.6.6.1.1.m1.1.1.cmml" xref="S5.T2.6.6.6.1.1.m1.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.6.6.1.1.m1.1c">0.5</annotation></semantics></math></span></td>
<td id="S5.T2.6.6.6.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">CLIP-FC</td>
<td id="S5.T2.6.6.6.3" class="ltx_td ltx_align_center ltx_border_t">73.19</td>
<td id="S5.T2.6.6.6.4" class="ltx_td ltx_align_center ltx_border_t">46.24</td>
<td id="S5.T2.6.6.6.5" class="ltx_td ltx_align_center ltx_border_t">68.73</td>
<td id="S5.T2.6.6.6.6" class="ltx_td ltx_align_center ltx_border_t">34.63</td>
<td id="S5.T2.6.6.6.7" class="ltx_td ltx_align_center ltx_border_t">82.43</td>
<td id="S5.T2.6.6.6.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">64.24</td>
<td id="S5.T2.6.6.6.9" class="ltx_td ltx_align_center ltx_border_t">61.58</td>
</tr>
<tr id="S5.T2.7.7.20" class="ltx_tr">
<td id="S5.T2.7.7.20.1" class="ltx_td ltx_align_left ltx_border_r">FedCLIP</td>
<td id="S5.T2.7.7.20.2" class="ltx_td ltx_align_center">69.86</td>
<td id="S5.T2.7.7.20.3" class="ltx_td ltx_align_center">45.26</td>
<td id="S5.T2.7.7.20.4" class="ltx_td ltx_align_center">65.50</td>
<td id="S5.T2.7.7.20.5" class="ltx_td ltx_align_center">17.46</td>
<td id="S5.T2.7.7.20.6" class="ltx_td ltx_align_center">82.65</td>
<td id="S5.T2.7.7.20.7" class="ltx_td ltx_align_center ltx_border_r">61.05</td>
<td id="S5.T2.7.7.20.8" class="ltx_td ltx_align_center">56.96</td>
</tr>
<tr id="S5.T2.7.7.21" class="ltx_tr">
<td id="S5.T2.7.7.21.1" class="ltx_td ltx_align_left ltx_border_r">PromptFL</td>
<td id="S5.T2.7.7.21.2" class="ltx_td ltx_align_center">73.71</td>
<td id="S5.T2.7.7.21.3" class="ltx_td ltx_align_center">46.13</td>
<td id="S5.T2.7.7.21.4" class="ltx_td ltx_align_center">69.53</td>
<td id="S5.T2.7.7.21.5" class="ltx_td ltx_align_center">39.65</td>
<td id="S5.T2.7.7.21.6" class="ltx_td ltx_align_center">82.10</td>
<td id="S5.T2.7.7.21.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T2.7.7.21.7.1" class="ltx_text ltx_font_bold">65.22</span></td>
<td id="S5.T2.7.7.21.8" class="ltx_td ltx_align_center">62.72</td>
</tr>
<tr id="S5.T2.7.7.22" class="ltx_tr">
<td id="S5.T2.7.7.22.1" class="ltx_td ltx_align_left ltx_border_r">FedAPT</td>
<td id="S5.T2.7.7.22.2" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.22.2.1" class="ltx_text ltx_font_bold">75.56</span></td>
<td id="S5.T2.7.7.22.3" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.22.3.1" class="ltx_text ltx_font_bold">48.41</span></td>
<td id="S5.T2.7.7.22.4" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.22.4.1" class="ltx_text ltx_font_bold">71.64</span></td>
<td id="S5.T2.7.7.22.5" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.22.5.1" class="ltx_text ltx_font_bold">47.28</span></td>
<td id="S5.T2.7.7.22.6" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.22.6.1" class="ltx_text ltx_font_bold">83.32</span></td>
<td id="S5.T2.7.7.22.7" class="ltx_td ltx_align_center ltx_border_r">65.06</td>
<td id="S5.T2.7.7.22.8" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.22.8.1" class="ltx_text ltx_font_bold">65.21</span></td>
</tr>
<tr id="S5.T2.7.7.7" class="ltx_tr">
<td id="S5.T2.7.7.7.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="4"><span id="S5.T2.7.7.7.1.1" class="ltx_text"><math id="S5.T2.7.7.7.1.1.m1.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S5.T2.7.7.7.1.1.m1.1a"><mn id="S5.T2.7.7.7.1.1.m1.1.1" xref="S5.T2.7.7.7.1.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S5.T2.7.7.7.1.1.m1.1b"><cn type="integer" id="S5.T2.7.7.7.1.1.m1.1.1.cmml" xref="S5.T2.7.7.7.1.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.7.7.7.1.1.m1.1c">5</annotation></semantics></math></span></td>
<td id="S5.T2.7.7.7.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">CLIP-FC</td>
<td id="S5.T2.7.7.7.3" class="ltx_td ltx_align_center ltx_border_t">74.19</td>
<td id="S5.T2.7.7.7.4" class="ltx_td ltx_align_center ltx_border_t">47.00</td>
<td id="S5.T2.7.7.7.5" class="ltx_td ltx_align_center ltx_border_t">67.85</td>
<td id="S5.T2.7.7.7.6" class="ltx_td ltx_align_center ltx_border_t">31.77</td>
<td id="S5.T2.7.7.7.7" class="ltx_td ltx_align_center ltx_border_t">84.08</td>
<td id="S5.T2.7.7.7.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">65.88</td>
<td id="S5.T2.7.7.7.9" class="ltx_td ltx_align_center ltx_border_t">61.80</td>
</tr>
<tr id="S5.T2.7.7.23" class="ltx_tr">
<td id="S5.T2.7.7.23.1" class="ltx_td ltx_align_left ltx_border_r">FedCLIP</td>
<td id="S5.T2.7.7.23.2" class="ltx_td ltx_align_center">69.67</td>
<td id="S5.T2.7.7.23.3" class="ltx_td ltx_align_center">45.30</td>
<td id="S5.T2.7.7.23.4" class="ltx_td ltx_align_center">65.42</td>
<td id="S5.T2.7.7.23.5" class="ltx_td ltx_align_center">17.93</td>
<td id="S5.T2.7.7.23.6" class="ltx_td ltx_align_center">82.86</td>
<td id="S5.T2.7.7.23.7" class="ltx_td ltx_align_center ltx_border_r">60.69</td>
<td id="S5.T2.7.7.23.8" class="ltx_td ltx_align_center">56.97</td>
</tr>
<tr id="S5.T2.7.7.24" class="ltx_tr">
<td id="S5.T2.7.7.24.1" class="ltx_td ltx_align_left ltx_border_r">PromptFL</td>
<td id="S5.T2.7.7.24.2" class="ltx_td ltx_align_center">74.44</td>
<td id="S5.T2.7.7.24.3" class="ltx_td ltx_align_center">47.70</td>
<td id="S5.T2.7.7.24.4" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.24.4.1" class="ltx_text ltx_font_bold">69.06</span></td>
<td id="S5.T2.7.7.24.5" class="ltx_td ltx_align_center">38.68</td>
<td id="S5.T2.7.7.24.6" class="ltx_td ltx_align_center">84.66</td>
<td id="S5.T2.7.7.24.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T2.7.7.24.7.1" class="ltx_text ltx_font_bold">67.51</span></td>
<td id="S5.T2.7.7.24.8" class="ltx_td ltx_align_center">63.68</td>
</tr>
<tr id="S5.T2.7.7.25" class="ltx_tr">
<td id="S5.T2.7.7.25.1" class="ltx_td ltx_align_left ltx_border_r">FedAPT</td>
<td id="S5.T2.7.7.25.2" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.25.2.1" class="ltx_text ltx_font_bold">76.99</span></td>
<td id="S5.T2.7.7.25.3" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.25.3.1" class="ltx_text ltx_font_bold">49.45</span></td>
<td id="S5.T2.7.7.25.4" class="ltx_td ltx_align_center">68.49</td>
<td id="S5.T2.7.7.25.5" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.25.5.1" class="ltx_text ltx_font_bold">49.53</span></td>
<td id="S5.T2.7.7.25.6" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.25.6.1" class="ltx_text ltx_font_bold">85.92</span></td>
<td id="S5.T2.7.7.25.7" class="ltx_td ltx_align_center ltx_border_r">67.42</td>
<td id="S5.T2.7.7.25.8" class="ltx_td ltx_align_center"><span id="S5.T2.7.7.25.8.1" class="ltx_text ltx_font_bold">66.30</span></td>
</tr>
<tr id="S5.T2.7.7.26" class="ltx_tr">
<td id="S5.T2.7.7.26.1" class="ltx_td ltx_align_center ltx_border_r"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></td>
<td id="S5.T2.7.7.26.2" class="ltx_td"></td>
<td id="S5.T2.7.7.26.3" class="ltx_td"></td>
<td id="S5.T2.7.7.26.4" class="ltx_td"></td>
<td id="S5.T2.7.7.26.5" class="ltx_td"></td>
<td id="S5.T2.7.7.26.6" class="ltx_td"></td>
<td id="S5.T2.7.7.26.7" class="ltx_td"></td>
<td id="S5.T2.7.7.26.8" class="ltx_td"></td>
<td id="S5.T2.7.7.26.9" class="ltx_td"></td>
<td id="S5.T2.7.7.26.10" class="ltx_td"></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>The accuracy of the global model in various domains in supervised setting with domain and category differences. There are 30 clients in total. ‘by domain’ means each domain randomly selects one client, and a total of six clients are selected in each round. ‘by random’ means to randomly select six clients from all 30 clients. FedAPT’s global model can significantly improve performance in various domains.</figcaption>
</figure>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Experimental Setup</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.3" class="ltx_p"><span id="S5.SS1.p1.3.1" class="ltx_text ltx_font_bold">Datasets.</span>
We adopt two datasets, Office-Caltech10 <cite class="ltx_cite ltx_citemacro_citep">(Gong et al. <a href="#bib.bib7" title="" class="ltx_ref">2012</a>)</cite> and DomainNet <cite class="ltx_cite ltx_citemacro_citep">(Peng et al. <a href="#bib.bib27" title="" class="ltx_ref">2019a</a>)</cite>. <span id="S5.SS1.p1.3.2" class="ltx_text ltx_font_bold">Office-Caltech10</span> (OC) is a small dataset that has four domains (<span id="S5.SS1.p1.3.3" class="ltx_text ltx_font_italic">amazon</span>, <span id="S5.SS1.p1.3.4" class="ltx_text ltx_font_italic">caltech</span>, <span id="S5.SS1.p1.3.5" class="ltx_text ltx_font_italic">dslr</span>, and <span id="S5.SS1.p1.3.6" class="ltx_text ltx_font_italic">webcam</span>), and each domain contains 10 overlapping categories between the Office-31 <cite class="ltx_cite ltx_citemacro_citep">(Saenko et al. <a href="#bib.bib32" title="" class="ltx_ref">2010</a>)</cite> dataset and the Caltech-256 <cite class="ltx_cite ltx_citemacro_citep">(Griffin, Holub, and Perona <a href="#bib.bib8" title="" class="ltx_ref">2007</a>)</cite> dataset. There are at least 100 and at most 800 images in different domains. Since the number of images is small, we use each domain as a client. <span id="S5.SS1.p1.3.7" class="ltx_text ltx_font_bold">DomainNet</span> (DN) is a large-scale multi-domain dataset containing six domains (<span id="S5.SS1.p1.3.8" class="ltx_text ltx_font_italic">clipart</span>, <span id="S5.SS1.p1.3.9" class="ltx_text ltx_font_italic">infograph</span>, <span id="S5.SS1.p1.3.10" class="ltx_text ltx_font_italic">painting</span>, <span id="S5.SS1.p1.3.11" class="ltx_text ltx_font_italic">quickdraw</span>, <span id="S5.SS1.p1.3.12" class="ltx_text ltx_font_italic">real</span>, and <span id="S5.SS1.p1.3.13" class="ltx_text ltx_font_italic">sketch</span>), and each domain contains about 33k-120k images with 345 categories. We set the number of clients <math id="S5.SS1.p1.1.m1.1" class="ltx_Math" alttext="N_{dom}" display="inline"><semantics id="S5.SS1.p1.1.m1.1a"><msub id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml"><mi id="S5.SS1.p1.1.m1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.2.cmml">N</mi><mrow id="S5.SS1.p1.1.m1.1.1.3" xref="S5.SS1.p1.1.m1.1.1.3.cmml"><mi id="S5.SS1.p1.1.m1.1.1.3.2" xref="S5.SS1.p1.1.m1.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p1.1.m1.1.1.3.1" xref="S5.SS1.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S5.SS1.p1.1.m1.1.1.3.3" xref="S5.SS1.p1.1.m1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p1.1.m1.1.1.3.1a" xref="S5.SS1.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S5.SS1.p1.1.m1.1.1.3.4" xref="S5.SS1.p1.1.m1.1.1.3.4.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.p1.1.m1.1.1.2">𝑁</ci><apply id="S5.SS1.p1.1.m1.1.1.3.cmml" xref="S5.SS1.p1.1.m1.1.1.3"><times id="S5.SS1.p1.1.m1.1.1.3.1.cmml" xref="S5.SS1.p1.1.m1.1.1.3.1"></times><ci id="S5.SS1.p1.1.m1.1.1.3.2.cmml" xref="S5.SS1.p1.1.m1.1.1.3.2">𝑑</ci><ci id="S5.SS1.p1.1.m1.1.1.3.3.cmml" xref="S5.SS1.p1.1.m1.1.1.3.3">𝑜</ci><ci id="S5.SS1.p1.1.m1.1.1.3.4.cmml" xref="S5.SS1.p1.1.m1.1.1.3.4">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">N_{dom}</annotation></semantics></math> in each domain as 1 or 5. When <math id="S5.SS1.p1.2.m2.1" class="ltx_Math" alttext="N_{dom}=5" display="inline"><semantics id="S5.SS1.p1.2.m2.1a"><mrow id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml"><msub id="S5.SS1.p1.2.m2.1.1.2" xref="S5.SS1.p1.2.m2.1.1.2.cmml"><mi id="S5.SS1.p1.2.m2.1.1.2.2" xref="S5.SS1.p1.2.m2.1.1.2.2.cmml">N</mi><mrow id="S5.SS1.p1.2.m2.1.1.2.3" xref="S5.SS1.p1.2.m2.1.1.2.3.cmml"><mi id="S5.SS1.p1.2.m2.1.1.2.3.2" xref="S5.SS1.p1.2.m2.1.1.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p1.2.m2.1.1.2.3.1" xref="S5.SS1.p1.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S5.SS1.p1.2.m2.1.1.2.3.3" xref="S5.SS1.p1.2.m2.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p1.2.m2.1.1.2.3.1a" xref="S5.SS1.p1.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S5.SS1.p1.2.m2.1.1.2.3.4" xref="S5.SS1.p1.2.m2.1.1.2.3.4.cmml">m</mi></mrow></msub><mo id="S5.SS1.p1.2.m2.1.1.1" xref="S5.SS1.p1.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS1.p1.2.m2.1.1.3" xref="S5.SS1.p1.2.m2.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><apply id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1"><eq id="S5.SS1.p1.2.m2.1.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1.1"></eq><apply id="S5.SS1.p1.2.m2.1.1.2.cmml" xref="S5.SS1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p1.2.m2.1.1.2.1.cmml" xref="S5.SS1.p1.2.m2.1.1.2">subscript</csymbol><ci id="S5.SS1.p1.2.m2.1.1.2.2.cmml" xref="S5.SS1.p1.2.m2.1.1.2.2">𝑁</ci><apply id="S5.SS1.p1.2.m2.1.1.2.3.cmml" xref="S5.SS1.p1.2.m2.1.1.2.3"><times id="S5.SS1.p1.2.m2.1.1.2.3.1.cmml" xref="S5.SS1.p1.2.m2.1.1.2.3.1"></times><ci id="S5.SS1.p1.2.m2.1.1.2.3.2.cmml" xref="S5.SS1.p1.2.m2.1.1.2.3.2">𝑑</ci><ci id="S5.SS1.p1.2.m2.1.1.2.3.3.cmml" xref="S5.SS1.p1.2.m2.1.1.2.3.3">𝑜</ci><ci id="S5.SS1.p1.2.m2.1.1.2.3.4.cmml" xref="S5.SS1.p1.2.m2.1.1.2.3.4">𝑚</ci></apply></apply><cn type="integer" id="S5.SS1.p1.2.m2.1.1.3.cmml" xref="S5.SS1.p1.2.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">N_{dom}=5</annotation></semantics></math>, we use the Dirichlet distribution to construct the non-IID property across clients. Both datasets contain 224<math id="S5.SS1.p1.3.m3.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S5.SS1.p1.3.m3.1a"><mo id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><times id="S5.SS1.p1.3.m3.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">\times</annotation></semantics></math>224 pixel images. Figure <a href="#S4.F4" title="Figure 4 ‣ 4.2 Federated Training ‣ 4 Method ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> depicts the divergences of different domains.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p"><span id="S5.SS1.p2.1.1" class="ltx_text ltx_font_bold">Compared Methods.</span>
To comprehensively evaluate the performance, we compare the following methods: 1) <span id="S5.SS1.p2.1.2" class="ltx_text ltx_font_bold">ResNet-full</span>: Federated training with ResNet50 <cite class="ltx_cite ltx_citemacro_citep">(He et al. <a href="#bib.bib11" title="" class="ltx_ref">2016</a>)</cite>, all parameters participate in the training procedure. 2) <span id="S5.SS1.p2.1.3" class="ltx_text ltx_font_bold">ResNet-tuning</span>, where the backbone of ResNet50 is frozen, only the last layer is trained. 3) <span id="S5.SS1.p2.1.4" class="ltx_text ltx_font_bold">ViT-full</span> and 4) <span id="S5.SS1.p2.1.5" class="ltx_text ltx_font_bold">ViT-tuning</span>: Replace ResNet in the above two baselines with ViT.
5) <span id="S5.SS1.p2.1.6" class="ltx_text ltx_font_bold">CLIP-zeroshot</span> do not make any changes to the CLIP, and directly perform zero-shot image classification in all domains. This helps us understand how much the prompt tuning improves the CLIP.
6) <span id="S5.SS1.p2.1.7" class="ltx_text ltx_font_bold">CLIP-FC</span>: Freeze the parameters of CLIP, and insert a learnable fully-connection layer at the end of the image encoder. Only the learnable layer is shared to the server.
7) <span id="S5.SS1.p2.1.8" class="ltx_text ltx_font_bold">FedCLIP</span> <cite class="ltx_cite ltx_citemacro_citep">(Lu et al. <a href="#bib.bib23" title="" class="ltx_ref">2023</a>)</cite>: Add an adapter at the end of the visual backbone and perform federated tuning. 8) <span id="S5.SS1.p2.1.9" class="ltx_text ltx_font_bold">PromptFL</span> <cite class="ltx_cite ltx_citemacro_citep">(Guo et al. <a href="#bib.bib9" title="" class="ltx_ref">2022</a>)</cite>: A prompt tuning method for CLIP, details can be seen in Section <a href="#S3.SS3" title="3.3 Federated Learning with Prompt ‣ 3 Preliminaries ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>. 9) <span id="S5.SS1.p2.1.10" class="ltx_text ltx_font_bold">FedAPT</span>: our proposed method. In the unsupervised experiment part, we utilize the local training method proposed in Section <a href="#S4.SS2" title="4.2 Federated Training ‣ 4 Method ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a> uniformly as FedCLIP and PromptFL have not yet explored federated tuning in an unsupervised setting.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<p id="S5.SS1.p3.6" class="ltx_p"><span id="S5.SS1.p3.6.1" class="ltx_text ltx_font_bold">Implementation Details.</span> We use PyTorch to implement all methods. The SGD optimizer is used for both datasets. We set Office-Caltech10 with a learning rate of 0.001 and batch size of 32, and DomainNet with a learning rate of 0.01 and batch size of 256. The global communication round <math id="S5.SS1.p3.1.m1.1" class="ltx_Math" alttext="T_{g}" display="inline"><semantics id="S5.SS1.p3.1.m1.1a"><msub id="S5.SS1.p3.1.m1.1.1" xref="S5.SS1.p3.1.m1.1.1.cmml"><mi id="S5.SS1.p3.1.m1.1.1.2" xref="S5.SS1.p3.1.m1.1.1.2.cmml">T</mi><mi id="S5.SS1.p3.1.m1.1.1.3" xref="S5.SS1.p3.1.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.1.m1.1b"><apply id="S5.SS1.p3.1.m1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p3.1.m1.1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S5.SS1.p3.1.m1.1.1.2.cmml" xref="S5.SS1.p3.1.m1.1.1.2">𝑇</ci><ci id="S5.SS1.p3.1.m1.1.1.3.cmml" xref="S5.SS1.p3.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.1.m1.1c">T_{g}</annotation></semantics></math> is set to 50, and the local training epoch <math id="S5.SS1.p3.2.m2.1" class="ltx_Math" alttext="T_{l}" display="inline"><semantics id="S5.SS1.p3.2.m2.1a"><msub id="S5.SS1.p3.2.m2.1.1" xref="S5.SS1.p3.2.m2.1.1.cmml"><mi id="S5.SS1.p3.2.m2.1.1.2" xref="S5.SS1.p3.2.m2.1.1.2.cmml">T</mi><mi id="S5.SS1.p3.2.m2.1.1.3" xref="S5.SS1.p3.2.m2.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.2.m2.1b"><apply id="S5.SS1.p3.2.m2.1.1.cmml" xref="S5.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS1.p3.2.m2.1.1.1.cmml" xref="S5.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S5.SS1.p3.2.m2.1.1.2.cmml" xref="S5.SS1.p3.2.m2.1.1.2">𝑇</ci><ci id="S5.SS1.p3.2.m2.1.1.3.cmml" xref="S5.SS1.p3.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.2.m2.1c">T_{l}</annotation></semantics></math> is set to <math id="S5.SS1.p3.3.m3.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S5.SS1.p3.3.m3.1a"><mn id="S5.SS1.p3.3.m3.1.1" xref="S5.SS1.p3.3.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.3.m3.1b"><cn type="integer" id="S5.SS1.p3.3.m3.1.1.cmml" xref="S5.SS1.p3.3.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.3.m3.1c">1</annotation></semantics></math>. The length of prompts <math id="S5.SS1.p3.4.m4.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S5.SS1.p3.4.m4.1a"><mi id="S5.SS1.p3.4.m4.1.1" xref="S5.SS1.p3.4.m4.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.4.m4.1b"><ci id="S5.SS1.p3.4.m4.1.1.cmml" xref="S5.SS1.p3.4.m4.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.4.m4.1c">s</annotation></semantics></math> is 16. In supervised setting, we set class-specific prompts <math id="S5.SS1.p3.5.m5.1" class="ltx_Math" alttext="\mathbf{p}_{g}\in\mathbb{R}^{C\times s\times d}" display="inline"><semantics id="S5.SS1.p3.5.m5.1a"><mrow id="S5.SS1.p3.5.m5.1.1" xref="S5.SS1.p3.5.m5.1.1.cmml"><msub id="S5.SS1.p3.5.m5.1.1.2" xref="S5.SS1.p3.5.m5.1.1.2.cmml"><mi id="S5.SS1.p3.5.m5.1.1.2.2" xref="S5.SS1.p3.5.m5.1.1.2.2.cmml">𝐩</mi><mi id="S5.SS1.p3.5.m5.1.1.2.3" xref="S5.SS1.p3.5.m5.1.1.2.3.cmml">g</mi></msub><mo id="S5.SS1.p3.5.m5.1.1.1" xref="S5.SS1.p3.5.m5.1.1.1.cmml">∈</mo><msup id="S5.SS1.p3.5.m5.1.1.3" xref="S5.SS1.p3.5.m5.1.1.3.cmml"><mi id="S5.SS1.p3.5.m5.1.1.3.2" xref="S5.SS1.p3.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S5.SS1.p3.5.m5.1.1.3.3" xref="S5.SS1.p3.5.m5.1.1.3.3.cmml"><mi id="S5.SS1.p3.5.m5.1.1.3.3.2" xref="S5.SS1.p3.5.m5.1.1.3.3.2.cmml">C</mi><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.p3.5.m5.1.1.3.3.1" xref="S5.SS1.p3.5.m5.1.1.3.3.1.cmml">×</mo><mi id="S5.SS1.p3.5.m5.1.1.3.3.3" xref="S5.SS1.p3.5.m5.1.1.3.3.3.cmml">s</mi><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.p3.5.m5.1.1.3.3.1a" xref="S5.SS1.p3.5.m5.1.1.3.3.1.cmml">×</mo><mi id="S5.SS1.p3.5.m5.1.1.3.3.4" xref="S5.SS1.p3.5.m5.1.1.3.3.4.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.5.m5.1b"><apply id="S5.SS1.p3.5.m5.1.1.cmml" xref="S5.SS1.p3.5.m5.1.1"><in id="S5.SS1.p3.5.m5.1.1.1.cmml" xref="S5.SS1.p3.5.m5.1.1.1"></in><apply id="S5.SS1.p3.5.m5.1.1.2.cmml" xref="S5.SS1.p3.5.m5.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p3.5.m5.1.1.2.1.cmml" xref="S5.SS1.p3.5.m5.1.1.2">subscript</csymbol><ci id="S5.SS1.p3.5.m5.1.1.2.2.cmml" xref="S5.SS1.p3.5.m5.1.1.2.2">𝐩</ci><ci id="S5.SS1.p3.5.m5.1.1.2.3.cmml" xref="S5.SS1.p3.5.m5.1.1.2.3">𝑔</ci></apply><apply id="S5.SS1.p3.5.m5.1.1.3.cmml" xref="S5.SS1.p3.5.m5.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p3.5.m5.1.1.3.1.cmml" xref="S5.SS1.p3.5.m5.1.1.3">superscript</csymbol><ci id="S5.SS1.p3.5.m5.1.1.3.2.cmml" xref="S5.SS1.p3.5.m5.1.1.3.2">ℝ</ci><apply id="S5.SS1.p3.5.m5.1.1.3.3.cmml" xref="S5.SS1.p3.5.m5.1.1.3.3"><times id="S5.SS1.p3.5.m5.1.1.3.3.1.cmml" xref="S5.SS1.p3.5.m5.1.1.3.3.1"></times><ci id="S5.SS1.p3.5.m5.1.1.3.3.2.cmml" xref="S5.SS1.p3.5.m5.1.1.3.3.2">𝐶</ci><ci id="S5.SS1.p3.5.m5.1.1.3.3.3.cmml" xref="S5.SS1.p3.5.m5.1.1.3.3.3">𝑠</ci><ci id="S5.SS1.p3.5.m5.1.1.3.3.4.cmml" xref="S5.SS1.p3.5.m5.1.1.3.3.4">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.5.m5.1c">\mathbf{p}_{g}\in\mathbb{R}^{C\times s\times d}</annotation></semantics></math>. In unsupervised setting, due to the lack of supervision information, we use the class-shared prompts <math id="S5.SS1.p3.6.m6.1" class="ltx_Math" alttext="\mathbf{p}_{g}\in\mathbb{R}^{s\times d}" display="inline"><semantics id="S5.SS1.p3.6.m6.1a"><mrow id="S5.SS1.p3.6.m6.1.1" xref="S5.SS1.p3.6.m6.1.1.cmml"><msub id="S5.SS1.p3.6.m6.1.1.2" xref="S5.SS1.p3.6.m6.1.1.2.cmml"><mi id="S5.SS1.p3.6.m6.1.1.2.2" xref="S5.SS1.p3.6.m6.1.1.2.2.cmml">𝐩</mi><mi id="S5.SS1.p3.6.m6.1.1.2.3" xref="S5.SS1.p3.6.m6.1.1.2.3.cmml">g</mi></msub><mo id="S5.SS1.p3.6.m6.1.1.1" xref="S5.SS1.p3.6.m6.1.1.1.cmml">∈</mo><msup id="S5.SS1.p3.6.m6.1.1.3" xref="S5.SS1.p3.6.m6.1.1.3.cmml"><mi id="S5.SS1.p3.6.m6.1.1.3.2" xref="S5.SS1.p3.6.m6.1.1.3.2.cmml">ℝ</mi><mrow id="S5.SS1.p3.6.m6.1.1.3.3" xref="S5.SS1.p3.6.m6.1.1.3.3.cmml"><mi id="S5.SS1.p3.6.m6.1.1.3.3.2" xref="S5.SS1.p3.6.m6.1.1.3.3.2.cmml">s</mi><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.p3.6.m6.1.1.3.3.1" xref="S5.SS1.p3.6.m6.1.1.3.3.1.cmml">×</mo><mi id="S5.SS1.p3.6.m6.1.1.3.3.3" xref="S5.SS1.p3.6.m6.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.6.m6.1b"><apply id="S5.SS1.p3.6.m6.1.1.cmml" xref="S5.SS1.p3.6.m6.1.1"><in id="S5.SS1.p3.6.m6.1.1.1.cmml" xref="S5.SS1.p3.6.m6.1.1.1"></in><apply id="S5.SS1.p3.6.m6.1.1.2.cmml" xref="S5.SS1.p3.6.m6.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p3.6.m6.1.1.2.1.cmml" xref="S5.SS1.p3.6.m6.1.1.2">subscript</csymbol><ci id="S5.SS1.p3.6.m6.1.1.2.2.cmml" xref="S5.SS1.p3.6.m6.1.1.2.2">𝐩</ci><ci id="S5.SS1.p3.6.m6.1.1.2.3.cmml" xref="S5.SS1.p3.6.m6.1.1.2.3">𝑔</ci></apply><apply id="S5.SS1.p3.6.m6.1.1.3.cmml" xref="S5.SS1.p3.6.m6.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p3.6.m6.1.1.3.1.cmml" xref="S5.SS1.p3.6.m6.1.1.3">superscript</csymbol><ci id="S5.SS1.p3.6.m6.1.1.3.2.cmml" xref="S5.SS1.p3.6.m6.1.1.3.2">ℝ</ci><apply id="S5.SS1.p3.6.m6.1.1.3.3.cmml" xref="S5.SS1.p3.6.m6.1.1.3.3"><times id="S5.SS1.p3.6.m6.1.1.3.3.1.cmml" xref="S5.SS1.p3.6.m6.1.1.3.3.1"></times><ci id="S5.SS1.p3.6.m6.1.1.3.3.2.cmml" xref="S5.SS1.p3.6.m6.1.1.3.3.2">𝑠</ci><ci id="S5.SS1.p3.6.m6.1.1.3.3.3.cmml" xref="S5.SS1.p3.6.m6.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.6.m6.1c">\mathbf{p}_{g}\in\mathbb{R}^{s\times d}</annotation></semantics></math>. The CLIP used in this paper takes ViT-B/32 <cite class="ltx_cite ltx_citemacro_citep">(Dosovitskiy et al. <a href="#bib.bib4" title="" class="ltx_ref">2020</a>)</cite> as the image encoder. Each experiment is repeated three times with different seeds, and the mean result is reported. All experiments are completed with one GeForce RTX 3090 GPU.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Main Results</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p"><span id="S5.SS2.p1.1.1" class="ltx_text ltx_font_bold">Supervised setting with domain differences. </span> We first treat each domain as a separate client with the same class distribution but different domain characteristics.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.1" class="ltx_p">The results on the two datasets are reported in Table <a href="#S5.T1" title="Table 1 ‣ 5 Experiments ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. We highlight the following points: <span id="S5.SS2.p2.1.1" class="ltx_text ltx_font_bold">1)</span> From ResNet-full vs. ResNet-tuning and ViT-full vs. ViT-tuning, we can see that pre-trained ViT has more powerful representation ability than pre-trained ResNet. As a result, ResNet must be fully trained in order to achieve the accuracy rate obtained through ViT-tuning. <span id="S5.SS2.p2.1.2" class="ltx_text ltx_font_bold">2)</span> CLIP’s zero-shot classification capability is insufficient to meet the requirements of various domains. The performance gap with federated prompt tuning is large, which indicates that the original CLIP lacks knowledge of the client domains. <span id="S5.SS2.p2.1.3" class="ltx_text ltx_font_bold">3)</span> Inserting a fully-connection layer after the image encoder of CLIP can remarkably enhance the performance on DomainNet, as indicated by CLIP-FC, which approaches the basic version of PromptFL. <span id="S5.SS2.p2.1.4" class="ltx_text ltx_font_bold">4)</span> Considering the performance of different methods and the amount of communication parameters in each round, FedAPT achieves the highest performance at a very low cost, which shows its great potential in the application of pre-trained CLIP to FL scenarios.</p>
</div>
<div id="S5.SS2.p3" class="ltx_para">
<p id="S5.SS2.p3.5" class="ltx_p"><span id="S5.SS2.p3.5.1" class="ltx_text ltx_font_bold">Supervised setting with domain and category differences.</span> We split each domain in DomainNet into five clients, i.e., sample <math id="S5.SS2.p3.1.m1.2" class="ltx_Math" alttext="\boldsymbol{\pi}_{c}\sim\operatorname{Dir}\left(\beta\mathbf{1}_{5}\right)" display="inline"><semantics id="S5.SS2.p3.1.m1.2a"><mrow id="S5.SS2.p3.1.m1.2.2" xref="S5.SS2.p3.1.m1.2.2.cmml"><msub id="S5.SS2.p3.1.m1.2.2.3" xref="S5.SS2.p3.1.m1.2.2.3.cmml"><mi id="S5.SS2.p3.1.m1.2.2.3.2" xref="S5.SS2.p3.1.m1.2.2.3.2.cmml">𝝅</mi><mi id="S5.SS2.p3.1.m1.2.2.3.3" xref="S5.SS2.p3.1.m1.2.2.3.3.cmml">c</mi></msub><mo id="S5.SS2.p3.1.m1.2.2.2" xref="S5.SS2.p3.1.m1.2.2.2.cmml">∼</mo><mrow id="S5.SS2.p3.1.m1.2.2.1.1" xref="S5.SS2.p3.1.m1.2.2.1.2.cmml"><mi id="S5.SS2.p3.1.m1.1.1" xref="S5.SS2.p3.1.m1.1.1.cmml">Dir</mi><mo id="S5.SS2.p3.1.m1.2.2.1.1a" xref="S5.SS2.p3.1.m1.2.2.1.2.cmml">⁡</mo><mrow id="S5.SS2.p3.1.m1.2.2.1.1.1" xref="S5.SS2.p3.1.m1.2.2.1.2.cmml"><mo id="S5.SS2.p3.1.m1.2.2.1.1.1.2" xref="S5.SS2.p3.1.m1.2.2.1.2.cmml">(</mo><mrow id="S5.SS2.p3.1.m1.2.2.1.1.1.1" xref="S5.SS2.p3.1.m1.2.2.1.1.1.1.cmml"><mi id="S5.SS2.p3.1.m1.2.2.1.1.1.1.2" xref="S5.SS2.p3.1.m1.2.2.1.1.1.1.2.cmml">β</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p3.1.m1.2.2.1.1.1.1.1" xref="S5.SS2.p3.1.m1.2.2.1.1.1.1.1.cmml">​</mo><msub id="S5.SS2.p3.1.m1.2.2.1.1.1.1.3" xref="S5.SS2.p3.1.m1.2.2.1.1.1.1.3.cmml"><mn id="S5.SS2.p3.1.m1.2.2.1.1.1.1.3.2" xref="S5.SS2.p3.1.m1.2.2.1.1.1.1.3.2.cmml">𝟏</mn><mn id="S5.SS2.p3.1.m1.2.2.1.1.1.1.3.3" xref="S5.SS2.p3.1.m1.2.2.1.1.1.1.3.3.cmml">5</mn></msub></mrow><mo id="S5.SS2.p3.1.m1.2.2.1.1.1.3" xref="S5.SS2.p3.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.1.m1.2b"><apply id="S5.SS2.p3.1.m1.2.2.cmml" xref="S5.SS2.p3.1.m1.2.2"><csymbol cd="latexml" id="S5.SS2.p3.1.m1.2.2.2.cmml" xref="S5.SS2.p3.1.m1.2.2.2">similar-to</csymbol><apply id="S5.SS2.p3.1.m1.2.2.3.cmml" xref="S5.SS2.p3.1.m1.2.2.3"><csymbol cd="ambiguous" id="S5.SS2.p3.1.m1.2.2.3.1.cmml" xref="S5.SS2.p3.1.m1.2.2.3">subscript</csymbol><ci id="S5.SS2.p3.1.m1.2.2.3.2.cmml" xref="S5.SS2.p3.1.m1.2.2.3.2">𝝅</ci><ci id="S5.SS2.p3.1.m1.2.2.3.3.cmml" xref="S5.SS2.p3.1.m1.2.2.3.3">𝑐</ci></apply><apply id="S5.SS2.p3.1.m1.2.2.1.2.cmml" xref="S5.SS2.p3.1.m1.2.2.1.1"><ci id="S5.SS2.p3.1.m1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1">Dir</ci><apply id="S5.SS2.p3.1.m1.2.2.1.1.1.1.cmml" xref="S5.SS2.p3.1.m1.2.2.1.1.1.1"><times id="S5.SS2.p3.1.m1.2.2.1.1.1.1.1.cmml" xref="S5.SS2.p3.1.m1.2.2.1.1.1.1.1"></times><ci id="S5.SS2.p3.1.m1.2.2.1.1.1.1.2.cmml" xref="S5.SS2.p3.1.m1.2.2.1.1.1.1.2">𝛽</ci><apply id="S5.SS2.p3.1.m1.2.2.1.1.1.1.3.cmml" xref="S5.SS2.p3.1.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS2.p3.1.m1.2.2.1.1.1.1.3.1.cmml" xref="S5.SS2.p3.1.m1.2.2.1.1.1.1.3">subscript</csymbol><cn type="integer" id="S5.SS2.p3.1.m1.2.2.1.1.1.1.3.2.cmml" xref="S5.SS2.p3.1.m1.2.2.1.1.1.1.3.2">1</cn><cn type="integer" id="S5.SS2.p3.1.m1.2.2.1.1.1.1.3.3.cmml" xref="S5.SS2.p3.1.m1.2.2.1.1.1.1.3.3">5</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.1.m1.2c">\boldsymbol{\pi}_{c}\sim\operatorname{Dir}\left(\beta\mathbf{1}_{5}\right)</annotation></semantics></math> and allocate a <math id="S5.SS2.p3.2.m2.2" class="ltx_Math" alttext="\boldsymbol{\pi}_{c,i}" display="inline"><semantics id="S5.SS2.p3.2.m2.2a"><msub id="S5.SS2.p3.2.m2.2.3" xref="S5.SS2.p3.2.m2.2.3.cmml"><mi id="S5.SS2.p3.2.m2.2.3.2" xref="S5.SS2.p3.2.m2.2.3.2.cmml">𝝅</mi><mrow id="S5.SS2.p3.2.m2.2.2.2.4" xref="S5.SS2.p3.2.m2.2.2.2.3.cmml"><mi id="S5.SS2.p3.2.m2.1.1.1.1" xref="S5.SS2.p3.2.m2.1.1.1.1.cmml">c</mi><mo id="S5.SS2.p3.2.m2.2.2.2.4.1" xref="S5.SS2.p3.2.m2.2.2.2.3.cmml">,</mo><mi id="S5.SS2.p3.2.m2.2.2.2.2" xref="S5.SS2.p3.2.m2.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.2.m2.2b"><apply id="S5.SS2.p3.2.m2.2.3.cmml" xref="S5.SS2.p3.2.m2.2.3"><csymbol cd="ambiguous" id="S5.SS2.p3.2.m2.2.3.1.cmml" xref="S5.SS2.p3.2.m2.2.3">subscript</csymbol><ci id="S5.SS2.p3.2.m2.2.3.2.cmml" xref="S5.SS2.p3.2.m2.2.3.2">𝝅</ci><list id="S5.SS2.p3.2.m2.2.2.2.3.cmml" xref="S5.SS2.p3.2.m2.2.2.2.4"><ci id="S5.SS2.p3.2.m2.1.1.1.1.cmml" xref="S5.SS2.p3.2.m2.1.1.1.1">𝑐</ci><ci id="S5.SS2.p3.2.m2.2.2.2.2.cmml" xref="S5.SS2.p3.2.m2.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.2.m2.2c">\boldsymbol{\pi}_{c,i}</annotation></semantics></math> proportion of the instances with label <math id="S5.SS2.p3.3.m3.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S5.SS2.p3.3.m3.1a"><mi id="S5.SS2.p3.3.m3.1.1" xref="S5.SS2.p3.3.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.3.m3.1b"><ci id="S5.SS2.p3.3.m3.1.1.cmml" xref="S5.SS2.p3.3.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.3.m3.1c">c</annotation></semantics></math> to the training set of the <math id="S5.SS2.p3.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S5.SS2.p3.4.m4.1a"><mi id="S5.SS2.p3.4.m4.1.1" xref="S5.SS2.p3.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.4.m4.1b"><ci id="S5.SS2.p3.4.m4.1.1.cmml" xref="S5.SS2.p3.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.4.m4.1c">i</annotation></semantics></math>-th client in each domain. Smaller <math id="S5.SS2.p3.5.m5.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S5.SS2.p3.5.m5.1a"><mi id="S5.SS2.p3.5.m5.1.1" xref="S5.SS2.p3.5.m5.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.5.m5.1b"><ci id="S5.SS2.p3.5.m5.1.1.cmml" xref="S5.SS2.p3.5.m5.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.5.m5.1c">\beta</annotation></semantics></math> leads to larger data distribution differences among clients and more imbalanced classes. Finally, we obtain 30 clients. In addition to the divergences in data domains, there are also divergences in category distribution among clients. In each communication round, we randomly select one client from each domain, meaning six clients are selected for training. Note that because the random seeds are the same, the clients selected in each round by different methods are consistent.</p>
</div>
<div id="S5.SS2.p4" class="ltx_para">
<p id="S5.SS2.p4.1" class="ltx_p">The results are shown in Table <a href="#S5.T2" title="Table 2 ‣ 5 Experiments ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. As we can see, FedAPT still outperforms the competitors overall. Furthermore, it is worth noting that when dealing with extremely unbalanced categories, all CLIP tuning methods exhibit similar performance. This suggests that the pre-trained CLIP model needs to be augmented with additional designs to achieve better performance, as its existing capabilities may be insufficient.</p>
</div>
<figure id="S5.T3" class="ltx_table">
<div id="S5.T3.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:345.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(36.2pt,-28.9pt) scale(1.20069919932458,1.20069919932458) ;">
<table id="S5.T3.3.3" class="ltx_tabular ltx_align_middle">
<tr id="S5.T3.3.3.4" class="ltx_tr" style="background-color:#DEDEDE;">
<td id="S5.T3.3.3.4.1" class="ltx_td ltx_align_center"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></td>
<td id="S5.T3.3.3.4.2" class="ltx_td ltx_border_r"></td>
<td id="S5.T3.3.3.4.3" class="ltx_td ltx_align_center"><span id="S5.T3.3.3.4.3.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">c</span></td>
<td id="S5.T3.3.3.4.4" class="ltx_td ltx_align_center"><span id="S5.T3.3.3.4.4.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">i</span></td>
<td id="S5.T3.3.3.4.5" class="ltx_td ltx_align_center"><span id="S5.T3.3.3.4.5.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">p</span></td>
<td id="S5.T3.3.3.4.6" class="ltx_td ltx_align_center"><span id="S5.T3.3.3.4.6.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">q</span></td>
<td id="S5.T3.3.3.4.7" class="ltx_td ltx_align_center"><span id="S5.T3.3.3.4.7.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">r</span></td>
<td id="S5.T3.3.3.4.8" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T3.3.3.4.8.1" class="ltx_text ltx_font_italic">s</span></td>
<td id="S5.T3.3.3.4.9" class="ltx_td ltx_align_center"><span id="S5.T3.3.3.4.9.1" class="ltx_text" style="background-color:#DEDEDE;">Average</span></td>
</tr>
<tr id="S5.T3.3.3.5" class="ltx_tr">
<td id="S5.T3.3.3.5.1" class="ltx_td ltx_align_center ltx_border_t" colspan="9">domain differences</td>
</tr>
<tr id="S5.T3.3.3.6" class="ltx_tr">
<td id="S5.T3.3.3.6.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">FedCLIP</td>
<td id="S5.T3.3.3.6.2" class="ltx_td ltx_align_center ltx_border_t">68.23</td>
<td id="S5.T3.3.3.6.3" class="ltx_td ltx_align_center ltx_border_t">45.14</td>
<td id="S5.T3.3.3.6.4" class="ltx_td ltx_align_center ltx_border_t">64.71</td>
<td id="S5.T3.3.3.6.5" class="ltx_td ltx_align_center ltx_border_t">18.07</td>
<td id="S5.T3.3.3.6.6" class="ltx_td ltx_align_center ltx_border_t">82.00</td>
<td id="S5.T3.3.3.6.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">60.00</td>
<td id="S5.T3.3.3.6.8" class="ltx_td ltx_align_center ltx_border_t">56.36</td>
</tr>
<tr id="S5.T3.3.3.7" class="ltx_tr">
<td id="S5.T3.3.3.7.1" class="ltx_td ltx_align_center ltx_border_r" colspan="2">PromptFL</td>
<td id="S5.T3.3.3.7.2" class="ltx_td ltx_align_center">68.37</td>
<td id="S5.T3.3.3.7.3" class="ltx_td ltx_align_center">46.61</td>
<td id="S5.T3.3.3.7.4" class="ltx_td ltx_align_center">65.67</td>
<td id="S5.T3.3.3.7.5" class="ltx_td ltx_align_center">17.34</td>
<td id="S5.T3.3.3.7.6" class="ltx_td ltx_align_center">82.17</td>
<td id="S5.T3.3.3.7.7" class="ltx_td ltx_align_center ltx_border_r">60.49</td>
<td id="S5.T3.3.3.7.8" class="ltx_td ltx_align_center">56.78</td>
</tr>
<tr id="S5.T3.3.3.8" class="ltx_tr">
<td id="S5.T3.3.3.8.1" class="ltx_td ltx_align_center ltx_border_r" colspan="2">FedAPT</td>
<td id="S5.T3.3.3.8.2" class="ltx_td ltx_align_center">69.48</td>
<td id="S5.T3.3.3.8.3" class="ltx_td ltx_align_center">47.18</td>
<td id="S5.T3.3.3.8.4" class="ltx_td ltx_align_center">66.12</td>
<td id="S5.T3.3.3.8.5" class="ltx_td ltx_align_center">17.89</td>
<td id="S5.T3.3.3.8.6" class="ltx_td ltx_align_center">83.09</td>
<td id="S5.T3.3.3.8.7" class="ltx_td ltx_align_center ltx_border_r">61.19</td>
<td id="S5.T3.3.3.8.8" class="ltx_td ltx_align_center"><span id="S5.T3.3.3.8.8.1" class="ltx_text ltx_font_bold">57.49</span></td>
</tr>
<tr id="S5.T3.3.3.9" class="ltx_tr">
<td id="S5.T3.3.3.9.1" class="ltx_td ltx_align_center ltx_border_t" colspan="9">domain and category differences</td>
</tr>
<tr id="S5.T3.1.1.1" class="ltx_tr">
<td id="S5.T3.1.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S5.T3.1.1.1.1.1" class="ltx_text">
<span id="S5.T3.1.1.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T3.1.1.1.1.1.1.1" class="ltx_tr">
<span id="S5.T3.1.1.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><math id="S5.T3.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S5.T3.1.1.1.1.1.1.1.1.m1.1a"><mi id="S5.T3.1.1.1.1.1.1.1.1.m1.1.1" xref="S5.T3.1.1.1.1.1.1.1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.T3.1.1.1.1.1.1.1.1.m1.1b"><ci id="S5.T3.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S5.T3.1.1.1.1.1.1.1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.1.1.1.1.1.1.1.1.m1.1c">\beta</annotation></semantics></math></span></span>
<span id="S5.T3.1.1.1.1.1.1.2" class="ltx_tr">
<span id="S5.T3.1.1.1.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">=0.01</span></span>
</span></span></td>
<td id="S5.T3.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">FedCLIP</td>
<td id="S5.T3.1.1.1.3" class="ltx_td ltx_align_center ltx_border_t">67.65</td>
<td id="S5.T3.1.1.1.4" class="ltx_td ltx_align_center ltx_border_t">43.33</td>
<td id="S5.T3.1.1.1.5" class="ltx_td ltx_align_center ltx_border_t">63.48</td>
<td id="S5.T3.1.1.1.6" class="ltx_td ltx_align_center ltx_border_t">17.55</td>
<td id="S5.T3.1.1.1.7" class="ltx_td ltx_align_center ltx_border_t">81.33</td>
<td id="S5.T3.1.1.1.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">59.17</td>
<td id="S5.T3.1.1.1.9" class="ltx_td ltx_align_center ltx_border_t">55.42</td>
</tr>
<tr id="S5.T3.3.3.10" class="ltx_tr">
<td id="S5.T3.3.3.10.1" class="ltx_td ltx_align_center ltx_border_r">PromptFL</td>
<td id="S5.T3.3.3.10.2" class="ltx_td ltx_align_center">68.31</td>
<td id="S5.T3.3.3.10.3" class="ltx_td ltx_align_center">44.41</td>
<td id="S5.T3.3.3.10.4" class="ltx_td ltx_align_center">64.31</td>
<td id="S5.T3.3.3.10.5" class="ltx_td ltx_align_center">16.37</td>
<td id="S5.T3.3.3.10.6" class="ltx_td ltx_align_center">81.29</td>
<td id="S5.T3.3.3.10.7" class="ltx_td ltx_align_center ltx_border_r">60.21</td>
<td id="S5.T3.3.3.10.8" class="ltx_td ltx_align_center">55.82</td>
</tr>
<tr id="S5.T3.3.3.11" class="ltx_tr">
<td id="S5.T3.3.3.11.1" class="ltx_td ltx_align_center ltx_border_r">FedAPT</td>
<td id="S5.T3.3.3.11.2" class="ltx_td ltx_align_center">68.23</td>
<td id="S5.T3.3.3.11.3" class="ltx_td ltx_align_center">44.99</td>
<td id="S5.T3.3.3.11.4" class="ltx_td ltx_align_center">64.29</td>
<td id="S5.T3.3.3.11.5" class="ltx_td ltx_align_center">16.70</td>
<td id="S5.T3.3.3.11.6" class="ltx_td ltx_align_center">81.57</td>
<td id="S5.T3.3.3.11.7" class="ltx_td ltx_align_center ltx_border_r">60.17</td>
<td id="S5.T3.3.3.11.8" class="ltx_td ltx_align_center"><span id="S5.T3.3.3.11.8.1" class="ltx_text ltx_font_bold">55.99</span></td>
</tr>
<tr id="S5.T3.2.2.2" class="ltx_tr">
<td id="S5.T3.2.2.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S5.T3.2.2.2.1.1" class="ltx_text">
<span id="S5.T3.2.2.2.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T3.2.2.2.1.1.1.1" class="ltx_tr">
<span id="S5.T3.2.2.2.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><math id="S5.T3.2.2.2.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S5.T3.2.2.2.1.1.1.1.1.m1.1a"><mi id="S5.T3.2.2.2.1.1.1.1.1.m1.1.1" xref="S5.T3.2.2.2.1.1.1.1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.T3.2.2.2.1.1.1.1.1.m1.1b"><ci id="S5.T3.2.2.2.1.1.1.1.1.m1.1.1.cmml" xref="S5.T3.2.2.2.1.1.1.1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.2.2.1.1.1.1.1.m1.1c">\beta</annotation></semantics></math></span></span>
<span id="S5.T3.2.2.2.1.1.1.2" class="ltx_tr">
<span id="S5.T3.2.2.2.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">=0.5</span></span>
</span></span></td>
<td id="S5.T3.2.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">FedCLIP</td>
<td id="S5.T3.2.2.2.3" class="ltx_td ltx_align_center ltx_border_t">67.59</td>
<td id="S5.T3.2.2.2.4" class="ltx_td ltx_align_center ltx_border_t">44.11</td>
<td id="S5.T3.2.2.2.5" class="ltx_td ltx_align_center ltx_border_t">63.68</td>
<td id="S5.T3.2.2.2.6" class="ltx_td ltx_align_center ltx_border_t">18.21</td>
<td id="S5.T3.2.2.2.7" class="ltx_td ltx_align_center ltx_border_t">81.52</td>
<td id="S5.T3.2.2.2.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">59.06</td>
<td id="S5.T3.2.2.2.9" class="ltx_td ltx_align_center ltx_border_t">55.70</td>
</tr>
<tr id="S5.T3.3.3.12" class="ltx_tr">
<td id="S5.T3.3.3.12.1" class="ltx_td ltx_align_center ltx_border_r">PromptFL</td>
<td id="S5.T3.3.3.12.2" class="ltx_td ltx_align_center">68.75</td>
<td id="S5.T3.3.3.12.3" class="ltx_td ltx_align_center">46.22</td>
<td id="S5.T3.3.3.12.4" class="ltx_td ltx_align_center">65.13</td>
<td id="S5.T3.3.3.12.5" class="ltx_td ltx_align_center">17.68</td>
<td id="S5.T3.3.3.12.6" class="ltx_td ltx_align_center">82.90</td>
<td id="S5.T3.3.3.12.7" class="ltx_td ltx_align_center ltx_border_r">60.62</td>
<td id="S5.T3.3.3.12.8" class="ltx_td ltx_align_center">56.88</td>
</tr>
<tr id="S5.T3.3.3.13" class="ltx_tr">
<td id="S5.T3.3.3.13.1" class="ltx_td ltx_align_center ltx_border_r">FedAPT</td>
<td id="S5.T3.3.3.13.2" class="ltx_td ltx_align_center">69.02</td>
<td id="S5.T3.3.3.13.3" class="ltx_td ltx_align_center">46.67</td>
<td id="S5.T3.3.3.13.4" class="ltx_td ltx_align_center">65.88</td>
<td id="S5.T3.3.3.13.5" class="ltx_td ltx_align_center">18.31</td>
<td id="S5.T3.3.3.13.6" class="ltx_td ltx_align_center">83.00</td>
<td id="S5.T3.3.3.13.7" class="ltx_td ltx_align_center ltx_border_r">60.96</td>
<td id="S5.T3.3.3.13.8" class="ltx_td ltx_align_center"><span id="S5.T3.3.3.13.8.1" class="ltx_text ltx_font_bold">57.31</span></td>
</tr>
<tr id="S5.T3.3.3.3" class="ltx_tr">
<td id="S5.T3.3.3.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S5.T3.3.3.3.1.1" class="ltx_text">
<span id="S5.T3.3.3.3.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T3.3.3.3.1.1.1.1" class="ltx_tr">
<span id="S5.T3.3.3.3.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><math id="S5.T3.3.3.3.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S5.T3.3.3.3.1.1.1.1.1.m1.1a"><mi id="S5.T3.3.3.3.1.1.1.1.1.m1.1.1" xref="S5.T3.3.3.3.1.1.1.1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.T3.3.3.3.1.1.1.1.1.m1.1b"><ci id="S5.T3.3.3.3.1.1.1.1.1.m1.1.1.cmml" xref="S5.T3.3.3.3.1.1.1.1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.3.3.1.1.1.1.1.m1.1c">\beta</annotation></semantics></math></span></span>
<span id="S5.T3.3.3.3.1.1.1.2" class="ltx_tr">
<span id="S5.T3.3.3.3.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">=5</span></span>
</span></span></td>
<td id="S5.T3.3.3.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">FedCLIP</td>
<td id="S5.T3.3.3.3.3" class="ltx_td ltx_align_center ltx_border_t">67.81</td>
<td id="S5.T3.3.3.3.4" class="ltx_td ltx_align_center ltx_border_t">44.32</td>
<td id="S5.T3.3.3.3.5" class="ltx_td ltx_align_center ltx_border_t">63.82</td>
<td id="S5.T3.3.3.3.6" class="ltx_td ltx_align_center ltx_border_t">18.16</td>
<td id="S5.T3.3.3.3.7" class="ltx_td ltx_align_center ltx_border_t">81.58</td>
<td id="S5.T3.3.3.3.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">59.20</td>
<td id="S5.T3.3.3.3.9" class="ltx_td ltx_align_center ltx_border_t">55.82</td>
</tr>
<tr id="S5.T3.3.3.14" class="ltx_tr">
<td id="S5.T3.3.3.14.1" class="ltx_td ltx_align_center ltx_border_r">PromptFL</td>
<td id="S5.T3.3.3.14.2" class="ltx_td ltx_align_center">68.64</td>
<td id="S5.T3.3.3.14.3" class="ltx_td ltx_align_center">46.27</td>
<td id="S5.T3.3.3.14.4" class="ltx_td ltx_align_center">65.60</td>
<td id="S5.T3.3.3.14.5" class="ltx_td ltx_align_center">17.52</td>
<td id="S5.T3.3.3.14.6" class="ltx_td ltx_align_center">82.50</td>
<td id="S5.T3.3.3.14.7" class="ltx_td ltx_align_center ltx_border_r">60.38</td>
<td id="S5.T3.3.3.14.8" class="ltx_td ltx_align_center">56.82</td>
</tr>
<tr id="S5.T3.3.3.15" class="ltx_tr">
<td id="S5.T3.3.3.15.1" class="ltx_td ltx_align_center ltx_border_r">FedAPT</td>
<td id="S5.T3.3.3.15.2" class="ltx_td ltx_align_center">69.13</td>
<td id="S5.T3.3.3.15.3" class="ltx_td ltx_align_center">47.34</td>
<td id="S5.T3.3.3.15.4" class="ltx_td ltx_align_center">66.41</td>
<td id="S5.T3.3.3.15.5" class="ltx_td ltx_align_center">18.47</td>
<td id="S5.T3.3.3.15.6" class="ltx_td ltx_align_center">83.31</td>
<td id="S5.T3.3.3.15.7" class="ltx_td ltx_align_center ltx_border_r">61.58</td>
<td id="S5.T3.3.3.15.8" class="ltx_td ltx_align_center"><span id="S5.T3.3.3.15.8.1" class="ltx_text ltx_font_bold">57.71</span></td>
</tr>
<tr id="S5.T3.3.3.16" class="ltx_tr">
<td id="S5.T3.3.3.16.1" class="ltx_td ltx_align_center"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></td>
<td id="S5.T3.3.3.16.2" class="ltx_td"></td>
<td id="S5.T3.3.3.16.3" class="ltx_td"></td>
<td id="S5.T3.3.3.16.4" class="ltx_td"></td>
<td id="S5.T3.3.3.16.5" class="ltx_td"></td>
<td id="S5.T3.3.3.16.6" class="ltx_td"></td>
<td id="S5.T3.3.3.16.7" class="ltx_td"></td>
<td id="S5.T3.3.3.16.8" class="ltx_td"></td>
<td id="S5.T3.3.3.16.9" class="ltx_td"></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>The accuracy of the global model in various domains in unsupervised settings.</figcaption>
</figure>
<div id="S5.SS2.p5" class="ltx_para">
<p id="S5.SS2.p5.1" class="ltx_p"><span id="S5.SS2.p5.1.1" class="ltx_text ltx_font_bold">Unsupervised setting.</span> We replicate the above experiments in an unlabeled setting, and the results are shown in Table <a href="#S5.T3" title="Table 3 ‣ 5.2 Main Results ‣ 5 Experiments ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Specifically, we observe that <span id="S5.SS2.p5.1.2" class="ltx_text ltx_font_bold">1)</span> On DomainNet dataset, the performance of unsupervised federated tuning is comparable to that of supervised tuning. This indicates that the unsupervised fine-tuning method proposed in Section <a href="#S3.SS3" title="3.3 Federated Learning with Prompt ‣ 3 Preliminaries ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a> is effective. <span id="S5.SS2.p5.1.3" class="ltx_text ltx_font_bold">2)</span> Under the unsupervised setting, FedAPT still outperforms the baseline methods, demonstrating its significant effectiveness. In addition, as we use the class-shared prompts for FedAPT and PromptFL in this setting, the communication parameter sizes per round are 0.011M and 0.008M, respectively. This demonstrates the advantage of federated prompt tuning in terms of communication costs.</p>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Ablation Studies</h3>

<figure id="S5.T4" class="ltx_table">
<div id="S5.T4.7" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:212.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(33.3pt,-16.3pt) scale(1.18157858508458,1.18157858508458) ;">
<table id="S5.T4.7.7" class="ltx_tabular ltx_align_middle">
<tr id="S5.T4.7.7.8" class="ltx_tr" style="background-color:#DEDEDE;">
<td id="S5.T4.7.7.8.1" class="ltx_td ltx_align_left"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></td>
<td id="S5.T4.7.7.8.2" class="ltx_td ltx_align_center"><span id="S5.T4.7.7.8.2.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">c</span></td>
<td id="S5.T4.7.7.8.3" class="ltx_td ltx_align_center"><span id="S5.T4.7.7.8.3.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">i</span></td>
<td id="S5.T4.7.7.8.4" class="ltx_td ltx_align_center"><span id="S5.T4.7.7.8.4.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">p</span></td>
<td id="S5.T4.7.7.8.5" class="ltx_td ltx_align_center"><span id="S5.T4.7.7.8.5.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">q</span></td>
<td id="S5.T4.7.7.8.6" class="ltx_td ltx_align_center"><span id="S5.T4.7.7.8.6.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">r</span></td>
<td id="S5.T4.7.7.8.7" class="ltx_td ltx_align_center"><span id="S5.T4.7.7.8.7.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">s</span></td>
<td id="S5.T4.7.7.8.8" class="ltx_td ltx_align_center"><span id="S5.T4.7.7.8.8.1" class="ltx_text" style="background-color:#DEDEDE;">Average</span></td>
</tr>
<tr id="S5.T4.1.1.1" class="ltx_tr">
<td id="S5.T4.1.1.1.1" class="ltx_td ltx_align_left">
<span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span>
meta prompt <math id="S5.T4.1.1.1.1.m1.1" class="ltx_Math" alttext="\mathbf{p}_{g}" display="inline"><semantics id="S5.T4.1.1.1.1.m1.1a"><msub id="S5.T4.1.1.1.1.m1.1.1" xref="S5.T4.1.1.1.1.m1.1.1.cmml"><mi id="S5.T4.1.1.1.1.m1.1.1.2" xref="S5.T4.1.1.1.1.m1.1.1.2.cmml">𝐩</mi><mi id="S5.T4.1.1.1.1.m1.1.1.3" xref="S5.T4.1.1.1.1.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T4.1.1.1.1.m1.1b"><apply id="S5.T4.1.1.1.1.m1.1.1.cmml" xref="S5.T4.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.1.1.1.1.m1.1.1.1.cmml" xref="S5.T4.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S5.T4.1.1.1.1.m1.1.1.2.cmml" xref="S5.T4.1.1.1.1.m1.1.1.2">𝐩</ci><ci id="S5.T4.1.1.1.1.m1.1.1.3.cmml" xref="S5.T4.1.1.1.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.1.1.1.1.m1.1c">\mathbf{p}_{g}</annotation></semantics></math>
</td>
<td id="S5.T4.1.1.1.2" class="ltx_td ltx_align_center">74.62</td>
<td id="S5.T4.1.1.1.3" class="ltx_td ltx_align_center">48.04</td>
<td id="S5.T4.1.1.1.4" class="ltx_td ltx_align_center">68.82</td>
<td id="S5.T4.1.1.1.5" class="ltx_td ltx_align_center">22.18</td>
<td id="S5.T4.1.1.1.6" class="ltx_td ltx_align_center">82.71</td>
<td id="S5.T4.1.1.1.7" class="ltx_td ltx_align_center">65.98</td>
<td id="S5.T4.1.1.1.8" class="ltx_td ltx_align_center">60.39</td>
</tr>
<tr id="S5.T4.2.2.2" class="ltx_tr">
<td id="S5.T4.2.2.2.1" class="ltx_td ltx_align_left ltx_border_t"><math id="S5.T4.2.2.2.1.m1.1" class="ltx_Math" alttext="\mathbf{p}_{g}+\mathbf{p}_{g}\odot\mathbf{e}^{\prime}_{0}" display="inline"><semantics id="S5.T4.2.2.2.1.m1.1a"><mrow id="S5.T4.2.2.2.1.m1.1.1" xref="S5.T4.2.2.2.1.m1.1.1.cmml"><msub id="S5.T4.2.2.2.1.m1.1.1.2" xref="S5.T4.2.2.2.1.m1.1.1.2.cmml"><mi id="S5.T4.2.2.2.1.m1.1.1.2.2" xref="S5.T4.2.2.2.1.m1.1.1.2.2.cmml">𝐩</mi><mi id="S5.T4.2.2.2.1.m1.1.1.2.3" xref="S5.T4.2.2.2.1.m1.1.1.2.3.cmml">g</mi></msub><mo id="S5.T4.2.2.2.1.m1.1.1.1" xref="S5.T4.2.2.2.1.m1.1.1.1.cmml">+</mo><mrow id="S5.T4.2.2.2.1.m1.1.1.3" xref="S5.T4.2.2.2.1.m1.1.1.3.cmml"><msub id="S5.T4.2.2.2.1.m1.1.1.3.2" xref="S5.T4.2.2.2.1.m1.1.1.3.2.cmml"><mi id="S5.T4.2.2.2.1.m1.1.1.3.2.2" xref="S5.T4.2.2.2.1.m1.1.1.3.2.2.cmml">𝐩</mi><mi id="S5.T4.2.2.2.1.m1.1.1.3.2.3" xref="S5.T4.2.2.2.1.m1.1.1.3.2.3.cmml">g</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S5.T4.2.2.2.1.m1.1.1.3.1" xref="S5.T4.2.2.2.1.m1.1.1.3.1.cmml">⊙</mo><msubsup id="S5.T4.2.2.2.1.m1.1.1.3.3" xref="S5.T4.2.2.2.1.m1.1.1.3.3.cmml"><mi id="S5.T4.2.2.2.1.m1.1.1.3.3.2.2" xref="S5.T4.2.2.2.1.m1.1.1.3.3.2.2.cmml">𝐞</mi><mn id="S5.T4.2.2.2.1.m1.1.1.3.3.3" xref="S5.T4.2.2.2.1.m1.1.1.3.3.3.cmml">0</mn><mo id="S5.T4.2.2.2.1.m1.1.1.3.3.2.3" xref="S5.T4.2.2.2.1.m1.1.1.3.3.2.3.cmml">′</mo></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.2.2.2.1.m1.1b"><apply id="S5.T4.2.2.2.1.m1.1.1.cmml" xref="S5.T4.2.2.2.1.m1.1.1"><plus id="S5.T4.2.2.2.1.m1.1.1.1.cmml" xref="S5.T4.2.2.2.1.m1.1.1.1"></plus><apply id="S5.T4.2.2.2.1.m1.1.1.2.cmml" xref="S5.T4.2.2.2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.T4.2.2.2.1.m1.1.1.2.1.cmml" xref="S5.T4.2.2.2.1.m1.1.1.2">subscript</csymbol><ci id="S5.T4.2.2.2.1.m1.1.1.2.2.cmml" xref="S5.T4.2.2.2.1.m1.1.1.2.2">𝐩</ci><ci id="S5.T4.2.2.2.1.m1.1.1.2.3.cmml" xref="S5.T4.2.2.2.1.m1.1.1.2.3">𝑔</ci></apply><apply id="S5.T4.2.2.2.1.m1.1.1.3.cmml" xref="S5.T4.2.2.2.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.2.2.2.1.m1.1.1.3.1.cmml" xref="S5.T4.2.2.2.1.m1.1.1.3.1">direct-product</csymbol><apply id="S5.T4.2.2.2.1.m1.1.1.3.2.cmml" xref="S5.T4.2.2.2.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S5.T4.2.2.2.1.m1.1.1.3.2.1.cmml" xref="S5.T4.2.2.2.1.m1.1.1.3.2">subscript</csymbol><ci id="S5.T4.2.2.2.1.m1.1.1.3.2.2.cmml" xref="S5.T4.2.2.2.1.m1.1.1.3.2.2">𝐩</ci><ci id="S5.T4.2.2.2.1.m1.1.1.3.2.3.cmml" xref="S5.T4.2.2.2.1.m1.1.1.3.2.3">𝑔</ci></apply><apply id="S5.T4.2.2.2.1.m1.1.1.3.3.cmml" xref="S5.T4.2.2.2.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S5.T4.2.2.2.1.m1.1.1.3.3.1.cmml" xref="S5.T4.2.2.2.1.m1.1.1.3.3">subscript</csymbol><apply id="S5.T4.2.2.2.1.m1.1.1.3.3.2.cmml" xref="S5.T4.2.2.2.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S5.T4.2.2.2.1.m1.1.1.3.3.2.1.cmml" xref="S5.T4.2.2.2.1.m1.1.1.3.3">superscript</csymbol><ci id="S5.T4.2.2.2.1.m1.1.1.3.3.2.2.cmml" xref="S5.T4.2.2.2.1.m1.1.1.3.3.2.2">𝐞</ci><ci id="S5.T4.2.2.2.1.m1.1.1.3.3.2.3.cmml" xref="S5.T4.2.2.2.1.m1.1.1.3.3.2.3">′</ci></apply><cn type="integer" id="S5.T4.2.2.2.1.m1.1.1.3.3.3.cmml" xref="S5.T4.2.2.2.1.m1.1.1.3.3.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.2.2.2.1.m1.1c">\mathbf{p}_{g}+\mathbf{p}_{g}\odot\mathbf{e}^{\prime}_{0}</annotation></semantics></math></td>
<td id="S5.T4.2.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.2.2.2.2.1" class="ltx_text ltx_font_bold">78.76</span></td>
<td id="S5.T4.2.2.2.3" class="ltx_td ltx_align_center ltx_border_t">44.77</td>
<td id="S5.T4.2.2.2.4" class="ltx_td ltx_align_center ltx_border_t">65.85</td>
<td id="S5.T4.2.2.2.5" class="ltx_td ltx_align_center ltx_border_t">20.47</td>
<td id="S5.T4.2.2.2.6" class="ltx_td ltx_align_center ltx_border_t">80.80</td>
<td id="S5.T4.2.2.2.7" class="ltx_td ltx_align_center ltx_border_t">63.85</td>
<td id="S5.T4.2.2.2.8" class="ltx_td ltx_align_center ltx_border_t">59.08</td>
</tr>
<tr id="S5.T4.3.3.3" class="ltx_tr">
<td id="S5.T4.3.3.3.1" class="ltx_td ltx_align_left"><math id="S5.T4.3.3.3.1.m1.1" class="ltx_Math" alttext="\mathbf{p}_{g}+\mathbf{p}_{g}\odot\mathbf{e}^{\prime}_{1}" display="inline"><semantics id="S5.T4.3.3.3.1.m1.1a"><mrow id="S5.T4.3.3.3.1.m1.1.1" xref="S5.T4.3.3.3.1.m1.1.1.cmml"><msub id="S5.T4.3.3.3.1.m1.1.1.2" xref="S5.T4.3.3.3.1.m1.1.1.2.cmml"><mi id="S5.T4.3.3.3.1.m1.1.1.2.2" xref="S5.T4.3.3.3.1.m1.1.1.2.2.cmml">𝐩</mi><mi id="S5.T4.3.3.3.1.m1.1.1.2.3" xref="S5.T4.3.3.3.1.m1.1.1.2.3.cmml">g</mi></msub><mo id="S5.T4.3.3.3.1.m1.1.1.1" xref="S5.T4.3.3.3.1.m1.1.1.1.cmml">+</mo><mrow id="S5.T4.3.3.3.1.m1.1.1.3" xref="S5.T4.3.3.3.1.m1.1.1.3.cmml"><msub id="S5.T4.3.3.3.1.m1.1.1.3.2" xref="S5.T4.3.3.3.1.m1.1.1.3.2.cmml"><mi id="S5.T4.3.3.3.1.m1.1.1.3.2.2" xref="S5.T4.3.3.3.1.m1.1.1.3.2.2.cmml">𝐩</mi><mi id="S5.T4.3.3.3.1.m1.1.1.3.2.3" xref="S5.T4.3.3.3.1.m1.1.1.3.2.3.cmml">g</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S5.T4.3.3.3.1.m1.1.1.3.1" xref="S5.T4.3.3.3.1.m1.1.1.3.1.cmml">⊙</mo><msubsup id="S5.T4.3.3.3.1.m1.1.1.3.3" xref="S5.T4.3.3.3.1.m1.1.1.3.3.cmml"><mi id="S5.T4.3.3.3.1.m1.1.1.3.3.2.2" xref="S5.T4.3.3.3.1.m1.1.1.3.3.2.2.cmml">𝐞</mi><mn id="S5.T4.3.3.3.1.m1.1.1.3.3.3" xref="S5.T4.3.3.3.1.m1.1.1.3.3.3.cmml">1</mn><mo id="S5.T4.3.3.3.1.m1.1.1.3.3.2.3" xref="S5.T4.3.3.3.1.m1.1.1.3.3.2.3.cmml">′</mo></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.3.3.3.1.m1.1b"><apply id="S5.T4.3.3.3.1.m1.1.1.cmml" xref="S5.T4.3.3.3.1.m1.1.1"><plus id="S5.T4.3.3.3.1.m1.1.1.1.cmml" xref="S5.T4.3.3.3.1.m1.1.1.1"></plus><apply id="S5.T4.3.3.3.1.m1.1.1.2.cmml" xref="S5.T4.3.3.3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.T4.3.3.3.1.m1.1.1.2.1.cmml" xref="S5.T4.3.3.3.1.m1.1.1.2">subscript</csymbol><ci id="S5.T4.3.3.3.1.m1.1.1.2.2.cmml" xref="S5.T4.3.3.3.1.m1.1.1.2.2">𝐩</ci><ci id="S5.T4.3.3.3.1.m1.1.1.2.3.cmml" xref="S5.T4.3.3.3.1.m1.1.1.2.3">𝑔</ci></apply><apply id="S5.T4.3.3.3.1.m1.1.1.3.cmml" xref="S5.T4.3.3.3.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.3.3.3.1.m1.1.1.3.1.cmml" xref="S5.T4.3.3.3.1.m1.1.1.3.1">direct-product</csymbol><apply id="S5.T4.3.3.3.1.m1.1.1.3.2.cmml" xref="S5.T4.3.3.3.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S5.T4.3.3.3.1.m1.1.1.3.2.1.cmml" xref="S5.T4.3.3.3.1.m1.1.1.3.2">subscript</csymbol><ci id="S5.T4.3.3.3.1.m1.1.1.3.2.2.cmml" xref="S5.T4.3.3.3.1.m1.1.1.3.2.2">𝐩</ci><ci id="S5.T4.3.3.3.1.m1.1.1.3.2.3.cmml" xref="S5.T4.3.3.3.1.m1.1.1.3.2.3">𝑔</ci></apply><apply id="S5.T4.3.3.3.1.m1.1.1.3.3.cmml" xref="S5.T4.3.3.3.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S5.T4.3.3.3.1.m1.1.1.3.3.1.cmml" xref="S5.T4.3.3.3.1.m1.1.1.3.3">subscript</csymbol><apply id="S5.T4.3.3.3.1.m1.1.1.3.3.2.cmml" xref="S5.T4.3.3.3.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S5.T4.3.3.3.1.m1.1.1.3.3.2.1.cmml" xref="S5.T4.3.3.3.1.m1.1.1.3.3">superscript</csymbol><ci id="S5.T4.3.3.3.1.m1.1.1.3.3.2.2.cmml" xref="S5.T4.3.3.3.1.m1.1.1.3.3.2.2">𝐞</ci><ci id="S5.T4.3.3.3.1.m1.1.1.3.3.2.3.cmml" xref="S5.T4.3.3.3.1.m1.1.1.3.3.2.3">′</ci></apply><cn type="integer" id="S5.T4.3.3.3.1.m1.1.1.3.3.3.cmml" xref="S5.T4.3.3.3.1.m1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.3.3.3.1.m1.1c">\mathbf{p}_{g}+\mathbf{p}_{g}\odot\mathbf{e}^{\prime}_{1}</annotation></semantics></math></td>
<td id="S5.T4.3.3.3.2" class="ltx_td ltx_align_center">70.96</td>
<td id="S5.T4.3.3.3.3" class="ltx_td ltx_align_center"><span id="S5.T4.3.3.3.3.1" class="ltx_text ltx_font_bold">52.70</span></td>
<td id="S5.T4.3.3.3.4" class="ltx_td ltx_align_center">65.83</td>
<td id="S5.T4.3.3.3.5" class="ltx_td ltx_align_center">19.26</td>
<td id="S5.T4.3.3.3.6" class="ltx_td ltx_align_center">81.03</td>
<td id="S5.T4.3.3.3.7" class="ltx_td ltx_align_center">62.40</td>
<td id="S5.T4.3.3.3.8" class="ltx_td ltx_align_center">58.70</td>
</tr>
<tr id="S5.T4.4.4.4" class="ltx_tr">
<td id="S5.T4.4.4.4.1" class="ltx_td ltx_align_left"><math id="S5.T4.4.4.4.1.m1.1" class="ltx_Math" alttext="\mathbf{p}_{g}+\mathbf{p}_{g}\odot\mathbf{e}^{\prime}_{2}" display="inline"><semantics id="S5.T4.4.4.4.1.m1.1a"><mrow id="S5.T4.4.4.4.1.m1.1.1" xref="S5.T4.4.4.4.1.m1.1.1.cmml"><msub id="S5.T4.4.4.4.1.m1.1.1.2" xref="S5.T4.4.4.4.1.m1.1.1.2.cmml"><mi id="S5.T4.4.4.4.1.m1.1.1.2.2" xref="S5.T4.4.4.4.1.m1.1.1.2.2.cmml">𝐩</mi><mi id="S5.T4.4.4.4.1.m1.1.1.2.3" xref="S5.T4.4.4.4.1.m1.1.1.2.3.cmml">g</mi></msub><mo id="S5.T4.4.4.4.1.m1.1.1.1" xref="S5.T4.4.4.4.1.m1.1.1.1.cmml">+</mo><mrow id="S5.T4.4.4.4.1.m1.1.1.3" xref="S5.T4.4.4.4.1.m1.1.1.3.cmml"><msub id="S5.T4.4.4.4.1.m1.1.1.3.2" xref="S5.T4.4.4.4.1.m1.1.1.3.2.cmml"><mi id="S5.T4.4.4.4.1.m1.1.1.3.2.2" xref="S5.T4.4.4.4.1.m1.1.1.3.2.2.cmml">𝐩</mi><mi id="S5.T4.4.4.4.1.m1.1.1.3.2.3" xref="S5.T4.4.4.4.1.m1.1.1.3.2.3.cmml">g</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S5.T4.4.4.4.1.m1.1.1.3.1" xref="S5.T4.4.4.4.1.m1.1.1.3.1.cmml">⊙</mo><msubsup id="S5.T4.4.4.4.1.m1.1.1.3.3" xref="S5.T4.4.4.4.1.m1.1.1.3.3.cmml"><mi id="S5.T4.4.4.4.1.m1.1.1.3.3.2.2" xref="S5.T4.4.4.4.1.m1.1.1.3.3.2.2.cmml">𝐞</mi><mn id="S5.T4.4.4.4.1.m1.1.1.3.3.3" xref="S5.T4.4.4.4.1.m1.1.1.3.3.3.cmml">2</mn><mo id="S5.T4.4.4.4.1.m1.1.1.3.3.2.3" xref="S5.T4.4.4.4.1.m1.1.1.3.3.2.3.cmml">′</mo></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.4.4.4.1.m1.1b"><apply id="S5.T4.4.4.4.1.m1.1.1.cmml" xref="S5.T4.4.4.4.1.m1.1.1"><plus id="S5.T4.4.4.4.1.m1.1.1.1.cmml" xref="S5.T4.4.4.4.1.m1.1.1.1"></plus><apply id="S5.T4.4.4.4.1.m1.1.1.2.cmml" xref="S5.T4.4.4.4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.T4.4.4.4.1.m1.1.1.2.1.cmml" xref="S5.T4.4.4.4.1.m1.1.1.2">subscript</csymbol><ci id="S5.T4.4.4.4.1.m1.1.1.2.2.cmml" xref="S5.T4.4.4.4.1.m1.1.1.2.2">𝐩</ci><ci id="S5.T4.4.4.4.1.m1.1.1.2.3.cmml" xref="S5.T4.4.4.4.1.m1.1.1.2.3">𝑔</ci></apply><apply id="S5.T4.4.4.4.1.m1.1.1.3.cmml" xref="S5.T4.4.4.4.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.4.4.4.1.m1.1.1.3.1.cmml" xref="S5.T4.4.4.4.1.m1.1.1.3.1">direct-product</csymbol><apply id="S5.T4.4.4.4.1.m1.1.1.3.2.cmml" xref="S5.T4.4.4.4.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S5.T4.4.4.4.1.m1.1.1.3.2.1.cmml" xref="S5.T4.4.4.4.1.m1.1.1.3.2">subscript</csymbol><ci id="S5.T4.4.4.4.1.m1.1.1.3.2.2.cmml" xref="S5.T4.4.4.4.1.m1.1.1.3.2.2">𝐩</ci><ci id="S5.T4.4.4.4.1.m1.1.1.3.2.3.cmml" xref="S5.T4.4.4.4.1.m1.1.1.3.2.3">𝑔</ci></apply><apply id="S5.T4.4.4.4.1.m1.1.1.3.3.cmml" xref="S5.T4.4.4.4.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S5.T4.4.4.4.1.m1.1.1.3.3.1.cmml" xref="S5.T4.4.4.4.1.m1.1.1.3.3">subscript</csymbol><apply id="S5.T4.4.4.4.1.m1.1.1.3.3.2.cmml" xref="S5.T4.4.4.4.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S5.T4.4.4.4.1.m1.1.1.3.3.2.1.cmml" xref="S5.T4.4.4.4.1.m1.1.1.3.3">superscript</csymbol><ci id="S5.T4.4.4.4.1.m1.1.1.3.3.2.2.cmml" xref="S5.T4.4.4.4.1.m1.1.1.3.3.2.2">𝐞</ci><ci id="S5.T4.4.4.4.1.m1.1.1.3.3.2.3.cmml" xref="S5.T4.4.4.4.1.m1.1.1.3.3.2.3">′</ci></apply><cn type="integer" id="S5.T4.4.4.4.1.m1.1.1.3.3.3.cmml" xref="S5.T4.4.4.4.1.m1.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.4.4.4.1.m1.1c">\mathbf{p}_{g}+\mathbf{p}_{g}\odot\mathbf{e}^{\prime}_{2}</annotation></semantics></math></td>
<td id="S5.T4.4.4.4.2" class="ltx_td ltx_align_center">71.98</td>
<td id="S5.T4.4.4.4.3" class="ltx_td ltx_align_center">46.05</td>
<td id="S5.T4.4.4.4.4" class="ltx_td ltx_align_center"><span id="S5.T4.4.4.4.4.1" class="ltx_text ltx_font_bold">74.58</span></td>
<td id="S5.T4.4.4.4.5" class="ltx_td ltx_align_center">16.63</td>
<td id="S5.T4.4.4.4.6" class="ltx_td ltx_align_center">81.12</td>
<td id="S5.T4.4.4.4.7" class="ltx_td ltx_align_center">61.20</td>
<td id="S5.T4.4.4.4.8" class="ltx_td ltx_align_center">58.59</td>
</tr>
<tr id="S5.T4.5.5.5" class="ltx_tr">
<td id="S5.T4.5.5.5.1" class="ltx_td ltx_align_left"><math id="S5.T4.5.5.5.1.m1.1" class="ltx_Math" alttext="\mathbf{p}_{g}+\mathbf{p}_{g}\odot\mathbf{e}^{\prime}_{3}" display="inline"><semantics id="S5.T4.5.5.5.1.m1.1a"><mrow id="S5.T4.5.5.5.1.m1.1.1" xref="S5.T4.5.5.5.1.m1.1.1.cmml"><msub id="S5.T4.5.5.5.1.m1.1.1.2" xref="S5.T4.5.5.5.1.m1.1.1.2.cmml"><mi id="S5.T4.5.5.5.1.m1.1.1.2.2" xref="S5.T4.5.5.5.1.m1.1.1.2.2.cmml">𝐩</mi><mi id="S5.T4.5.5.5.1.m1.1.1.2.3" xref="S5.T4.5.5.5.1.m1.1.1.2.3.cmml">g</mi></msub><mo id="S5.T4.5.5.5.1.m1.1.1.1" xref="S5.T4.5.5.5.1.m1.1.1.1.cmml">+</mo><mrow id="S5.T4.5.5.5.1.m1.1.1.3" xref="S5.T4.5.5.5.1.m1.1.1.3.cmml"><msub id="S5.T4.5.5.5.1.m1.1.1.3.2" xref="S5.T4.5.5.5.1.m1.1.1.3.2.cmml"><mi id="S5.T4.5.5.5.1.m1.1.1.3.2.2" xref="S5.T4.5.5.5.1.m1.1.1.3.2.2.cmml">𝐩</mi><mi id="S5.T4.5.5.5.1.m1.1.1.3.2.3" xref="S5.T4.5.5.5.1.m1.1.1.3.2.3.cmml">g</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S5.T4.5.5.5.1.m1.1.1.3.1" xref="S5.T4.5.5.5.1.m1.1.1.3.1.cmml">⊙</mo><msubsup id="S5.T4.5.5.5.1.m1.1.1.3.3" xref="S5.T4.5.5.5.1.m1.1.1.3.3.cmml"><mi id="S5.T4.5.5.5.1.m1.1.1.3.3.2.2" xref="S5.T4.5.5.5.1.m1.1.1.3.3.2.2.cmml">𝐞</mi><mn id="S5.T4.5.5.5.1.m1.1.1.3.3.3" xref="S5.T4.5.5.5.1.m1.1.1.3.3.3.cmml">3</mn><mo id="S5.T4.5.5.5.1.m1.1.1.3.3.2.3" xref="S5.T4.5.5.5.1.m1.1.1.3.3.2.3.cmml">′</mo></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.5.5.5.1.m1.1b"><apply id="S5.T4.5.5.5.1.m1.1.1.cmml" xref="S5.T4.5.5.5.1.m1.1.1"><plus id="S5.T4.5.5.5.1.m1.1.1.1.cmml" xref="S5.T4.5.5.5.1.m1.1.1.1"></plus><apply id="S5.T4.5.5.5.1.m1.1.1.2.cmml" xref="S5.T4.5.5.5.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.T4.5.5.5.1.m1.1.1.2.1.cmml" xref="S5.T4.5.5.5.1.m1.1.1.2">subscript</csymbol><ci id="S5.T4.5.5.5.1.m1.1.1.2.2.cmml" xref="S5.T4.5.5.5.1.m1.1.1.2.2">𝐩</ci><ci id="S5.T4.5.5.5.1.m1.1.1.2.3.cmml" xref="S5.T4.5.5.5.1.m1.1.1.2.3">𝑔</ci></apply><apply id="S5.T4.5.5.5.1.m1.1.1.3.cmml" xref="S5.T4.5.5.5.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.5.5.5.1.m1.1.1.3.1.cmml" xref="S5.T4.5.5.5.1.m1.1.1.3.1">direct-product</csymbol><apply id="S5.T4.5.5.5.1.m1.1.1.3.2.cmml" xref="S5.T4.5.5.5.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S5.T4.5.5.5.1.m1.1.1.3.2.1.cmml" xref="S5.T4.5.5.5.1.m1.1.1.3.2">subscript</csymbol><ci id="S5.T4.5.5.5.1.m1.1.1.3.2.2.cmml" xref="S5.T4.5.5.5.1.m1.1.1.3.2.2">𝐩</ci><ci id="S5.T4.5.5.5.1.m1.1.1.3.2.3.cmml" xref="S5.T4.5.5.5.1.m1.1.1.3.2.3">𝑔</ci></apply><apply id="S5.T4.5.5.5.1.m1.1.1.3.3.cmml" xref="S5.T4.5.5.5.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S5.T4.5.5.5.1.m1.1.1.3.3.1.cmml" xref="S5.T4.5.5.5.1.m1.1.1.3.3">subscript</csymbol><apply id="S5.T4.5.5.5.1.m1.1.1.3.3.2.cmml" xref="S5.T4.5.5.5.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S5.T4.5.5.5.1.m1.1.1.3.3.2.1.cmml" xref="S5.T4.5.5.5.1.m1.1.1.3.3">superscript</csymbol><ci id="S5.T4.5.5.5.1.m1.1.1.3.3.2.2.cmml" xref="S5.T4.5.5.5.1.m1.1.1.3.3.2.2">𝐞</ci><ci id="S5.T4.5.5.5.1.m1.1.1.3.3.2.3.cmml" xref="S5.T4.5.5.5.1.m1.1.1.3.3.2.3">′</ci></apply><cn type="integer" id="S5.T4.5.5.5.1.m1.1.1.3.3.3.cmml" xref="S5.T4.5.5.5.1.m1.1.1.3.3.3">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.5.5.5.1.m1.1c">\mathbf{p}_{g}+\mathbf{p}_{g}\odot\mathbf{e}^{\prime}_{3}</annotation></semantics></math></td>
<td id="S5.T4.5.5.5.2" class="ltx_td ltx_align_center">69.66</td>
<td id="S5.T4.5.5.5.3" class="ltx_td ltx_align_center">39.99</td>
<td id="S5.T4.5.5.5.4" class="ltx_td ltx_align_center">60.27</td>
<td id="S5.T4.5.5.5.5" class="ltx_td ltx_align_center"><span id="S5.T4.5.5.5.5.1" class="ltx_text ltx_font_bold">48.84</span></td>
<td id="S5.T4.5.5.5.6" class="ltx_td ltx_align_center">75.78</td>
<td id="S5.T4.5.5.5.7" class="ltx_td ltx_align_center">58.67</td>
<td id="S5.T4.5.5.5.8" class="ltx_td ltx_align_center">58.87</td>
</tr>
<tr id="S5.T4.6.6.6" class="ltx_tr">
<td id="S5.T4.6.6.6.1" class="ltx_td ltx_align_left"><math id="S5.T4.6.6.6.1.m1.1" class="ltx_Math" alttext="\mathbf{p}_{g}+\mathbf{p}_{g}\odot\mathbf{e}^{\prime}_{4}" display="inline"><semantics id="S5.T4.6.6.6.1.m1.1a"><mrow id="S5.T4.6.6.6.1.m1.1.1" xref="S5.T4.6.6.6.1.m1.1.1.cmml"><msub id="S5.T4.6.6.6.1.m1.1.1.2" xref="S5.T4.6.6.6.1.m1.1.1.2.cmml"><mi id="S5.T4.6.6.6.1.m1.1.1.2.2" xref="S5.T4.6.6.6.1.m1.1.1.2.2.cmml">𝐩</mi><mi id="S5.T4.6.6.6.1.m1.1.1.2.3" xref="S5.T4.6.6.6.1.m1.1.1.2.3.cmml">g</mi></msub><mo id="S5.T4.6.6.6.1.m1.1.1.1" xref="S5.T4.6.6.6.1.m1.1.1.1.cmml">+</mo><mrow id="S5.T4.6.6.6.1.m1.1.1.3" xref="S5.T4.6.6.6.1.m1.1.1.3.cmml"><msub id="S5.T4.6.6.6.1.m1.1.1.3.2" xref="S5.T4.6.6.6.1.m1.1.1.3.2.cmml"><mi id="S5.T4.6.6.6.1.m1.1.1.3.2.2" xref="S5.T4.6.6.6.1.m1.1.1.3.2.2.cmml">𝐩</mi><mi id="S5.T4.6.6.6.1.m1.1.1.3.2.3" xref="S5.T4.6.6.6.1.m1.1.1.3.2.3.cmml">g</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S5.T4.6.6.6.1.m1.1.1.3.1" xref="S5.T4.6.6.6.1.m1.1.1.3.1.cmml">⊙</mo><msubsup id="S5.T4.6.6.6.1.m1.1.1.3.3" xref="S5.T4.6.6.6.1.m1.1.1.3.3.cmml"><mi id="S5.T4.6.6.6.1.m1.1.1.3.3.2.2" xref="S5.T4.6.6.6.1.m1.1.1.3.3.2.2.cmml">𝐞</mi><mn id="S5.T4.6.6.6.1.m1.1.1.3.3.3" xref="S5.T4.6.6.6.1.m1.1.1.3.3.3.cmml">4</mn><mo id="S5.T4.6.6.6.1.m1.1.1.3.3.2.3" xref="S5.T4.6.6.6.1.m1.1.1.3.3.2.3.cmml">′</mo></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.6.6.6.1.m1.1b"><apply id="S5.T4.6.6.6.1.m1.1.1.cmml" xref="S5.T4.6.6.6.1.m1.1.1"><plus id="S5.T4.6.6.6.1.m1.1.1.1.cmml" xref="S5.T4.6.6.6.1.m1.1.1.1"></plus><apply id="S5.T4.6.6.6.1.m1.1.1.2.cmml" xref="S5.T4.6.6.6.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.T4.6.6.6.1.m1.1.1.2.1.cmml" xref="S5.T4.6.6.6.1.m1.1.1.2">subscript</csymbol><ci id="S5.T4.6.6.6.1.m1.1.1.2.2.cmml" xref="S5.T4.6.6.6.1.m1.1.1.2.2">𝐩</ci><ci id="S5.T4.6.6.6.1.m1.1.1.2.3.cmml" xref="S5.T4.6.6.6.1.m1.1.1.2.3">𝑔</ci></apply><apply id="S5.T4.6.6.6.1.m1.1.1.3.cmml" xref="S5.T4.6.6.6.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.6.6.6.1.m1.1.1.3.1.cmml" xref="S5.T4.6.6.6.1.m1.1.1.3.1">direct-product</csymbol><apply id="S5.T4.6.6.6.1.m1.1.1.3.2.cmml" xref="S5.T4.6.6.6.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S5.T4.6.6.6.1.m1.1.1.3.2.1.cmml" xref="S5.T4.6.6.6.1.m1.1.1.3.2">subscript</csymbol><ci id="S5.T4.6.6.6.1.m1.1.1.3.2.2.cmml" xref="S5.T4.6.6.6.1.m1.1.1.3.2.2">𝐩</ci><ci id="S5.T4.6.6.6.1.m1.1.1.3.2.3.cmml" xref="S5.T4.6.6.6.1.m1.1.1.3.2.3">𝑔</ci></apply><apply id="S5.T4.6.6.6.1.m1.1.1.3.3.cmml" xref="S5.T4.6.6.6.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S5.T4.6.6.6.1.m1.1.1.3.3.1.cmml" xref="S5.T4.6.6.6.1.m1.1.1.3.3">subscript</csymbol><apply id="S5.T4.6.6.6.1.m1.1.1.3.3.2.cmml" xref="S5.T4.6.6.6.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S5.T4.6.6.6.1.m1.1.1.3.3.2.1.cmml" xref="S5.T4.6.6.6.1.m1.1.1.3.3">superscript</csymbol><ci id="S5.T4.6.6.6.1.m1.1.1.3.3.2.2.cmml" xref="S5.T4.6.6.6.1.m1.1.1.3.3.2.2">𝐞</ci><ci id="S5.T4.6.6.6.1.m1.1.1.3.3.2.3.cmml" xref="S5.T4.6.6.6.1.m1.1.1.3.3.2.3">′</ci></apply><cn type="integer" id="S5.T4.6.6.6.1.m1.1.1.3.3.3.cmml" xref="S5.T4.6.6.6.1.m1.1.1.3.3.3">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.6.6.6.1.m1.1c">\mathbf{p}_{g}+\mathbf{p}_{g}\odot\mathbf{e}^{\prime}_{4}</annotation></semantics></math></td>
<td id="S5.T4.6.6.6.2" class="ltx_td ltx_align_center">73.70</td>
<td id="S5.T4.6.6.6.3" class="ltx_td ltx_align_center">47.56</td>
<td id="S5.T4.6.6.6.4" class="ltx_td ltx_align_center">68.12</td>
<td id="S5.T4.6.6.6.5" class="ltx_td ltx_align_center">19.66</td>
<td id="S5.T4.6.6.6.6" class="ltx_td ltx_align_center"><span id="S5.T4.6.6.6.6.1" class="ltx_text ltx_font_bold">85.94</span></td>
<td id="S5.T4.6.6.6.7" class="ltx_td ltx_align_center">64.41</td>
<td id="S5.T4.6.6.6.8" class="ltx_td ltx_align_center">59.90</td>
</tr>
<tr id="S5.T4.7.7.7" class="ltx_tr">
<td id="S5.T4.7.7.7.1" class="ltx_td ltx_align_left"><math id="S5.T4.7.7.7.1.m1.1" class="ltx_Math" alttext="\mathbf{p}_{g}+\mathbf{p}_{g}\odot\mathbf{e}^{\prime}_{5}" display="inline"><semantics id="S5.T4.7.7.7.1.m1.1a"><mrow id="S5.T4.7.7.7.1.m1.1.1" xref="S5.T4.7.7.7.1.m1.1.1.cmml"><msub id="S5.T4.7.7.7.1.m1.1.1.2" xref="S5.T4.7.7.7.1.m1.1.1.2.cmml"><mi id="S5.T4.7.7.7.1.m1.1.1.2.2" xref="S5.T4.7.7.7.1.m1.1.1.2.2.cmml">𝐩</mi><mi id="S5.T4.7.7.7.1.m1.1.1.2.3" xref="S5.T4.7.7.7.1.m1.1.1.2.3.cmml">g</mi></msub><mo id="S5.T4.7.7.7.1.m1.1.1.1" xref="S5.T4.7.7.7.1.m1.1.1.1.cmml">+</mo><mrow id="S5.T4.7.7.7.1.m1.1.1.3" xref="S5.T4.7.7.7.1.m1.1.1.3.cmml"><msub id="S5.T4.7.7.7.1.m1.1.1.3.2" xref="S5.T4.7.7.7.1.m1.1.1.3.2.cmml"><mi id="S5.T4.7.7.7.1.m1.1.1.3.2.2" xref="S5.T4.7.7.7.1.m1.1.1.3.2.2.cmml">𝐩</mi><mi id="S5.T4.7.7.7.1.m1.1.1.3.2.3" xref="S5.T4.7.7.7.1.m1.1.1.3.2.3.cmml">g</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S5.T4.7.7.7.1.m1.1.1.3.1" xref="S5.T4.7.7.7.1.m1.1.1.3.1.cmml">⊙</mo><msubsup id="S5.T4.7.7.7.1.m1.1.1.3.3" xref="S5.T4.7.7.7.1.m1.1.1.3.3.cmml"><mi id="S5.T4.7.7.7.1.m1.1.1.3.3.2.2" xref="S5.T4.7.7.7.1.m1.1.1.3.3.2.2.cmml">𝐞</mi><mn id="S5.T4.7.7.7.1.m1.1.1.3.3.3" xref="S5.T4.7.7.7.1.m1.1.1.3.3.3.cmml">5</mn><mo id="S5.T4.7.7.7.1.m1.1.1.3.3.2.3" xref="S5.T4.7.7.7.1.m1.1.1.3.3.2.3.cmml">′</mo></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.7.7.7.1.m1.1b"><apply id="S5.T4.7.7.7.1.m1.1.1.cmml" xref="S5.T4.7.7.7.1.m1.1.1"><plus id="S5.T4.7.7.7.1.m1.1.1.1.cmml" xref="S5.T4.7.7.7.1.m1.1.1.1"></plus><apply id="S5.T4.7.7.7.1.m1.1.1.2.cmml" xref="S5.T4.7.7.7.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.T4.7.7.7.1.m1.1.1.2.1.cmml" xref="S5.T4.7.7.7.1.m1.1.1.2">subscript</csymbol><ci id="S5.T4.7.7.7.1.m1.1.1.2.2.cmml" xref="S5.T4.7.7.7.1.m1.1.1.2.2">𝐩</ci><ci id="S5.T4.7.7.7.1.m1.1.1.2.3.cmml" xref="S5.T4.7.7.7.1.m1.1.1.2.3">𝑔</ci></apply><apply id="S5.T4.7.7.7.1.m1.1.1.3.cmml" xref="S5.T4.7.7.7.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T4.7.7.7.1.m1.1.1.3.1.cmml" xref="S5.T4.7.7.7.1.m1.1.1.3.1">direct-product</csymbol><apply id="S5.T4.7.7.7.1.m1.1.1.3.2.cmml" xref="S5.T4.7.7.7.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S5.T4.7.7.7.1.m1.1.1.3.2.1.cmml" xref="S5.T4.7.7.7.1.m1.1.1.3.2">subscript</csymbol><ci id="S5.T4.7.7.7.1.m1.1.1.3.2.2.cmml" xref="S5.T4.7.7.7.1.m1.1.1.3.2.2">𝐩</ci><ci id="S5.T4.7.7.7.1.m1.1.1.3.2.3.cmml" xref="S5.T4.7.7.7.1.m1.1.1.3.2.3">𝑔</ci></apply><apply id="S5.T4.7.7.7.1.m1.1.1.3.3.cmml" xref="S5.T4.7.7.7.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S5.T4.7.7.7.1.m1.1.1.3.3.1.cmml" xref="S5.T4.7.7.7.1.m1.1.1.3.3">subscript</csymbol><apply id="S5.T4.7.7.7.1.m1.1.1.3.3.2.cmml" xref="S5.T4.7.7.7.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S5.T4.7.7.7.1.m1.1.1.3.3.2.1.cmml" xref="S5.T4.7.7.7.1.m1.1.1.3.3">superscript</csymbol><ci id="S5.T4.7.7.7.1.m1.1.1.3.3.2.2.cmml" xref="S5.T4.7.7.7.1.m1.1.1.3.3.2.2">𝐞</ci><ci id="S5.T4.7.7.7.1.m1.1.1.3.3.2.3.cmml" xref="S5.T4.7.7.7.1.m1.1.1.3.3.2.3">′</ci></apply><cn type="integer" id="S5.T4.7.7.7.1.m1.1.1.3.3.3.cmml" xref="S5.T4.7.7.7.1.m1.1.1.3.3.3">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.7.7.7.1.m1.1c">\mathbf{p}_{g}+\mathbf{p}_{g}\odot\mathbf{e}^{\prime}_{5}</annotation></semantics></math></td>
<td id="S5.T4.7.7.7.2" class="ltx_td ltx_align_center">72.28</td>
<td id="S5.T4.7.7.7.3" class="ltx_td ltx_align_center">44.92</td>
<td id="S5.T4.7.7.7.4" class="ltx_td ltx_align_center">65.16</td>
<td id="S5.T4.7.7.7.5" class="ltx_td ltx_align_center">20.63</td>
<td id="S5.T4.7.7.7.6" class="ltx_td ltx_align_center">81.04</td>
<td id="S5.T4.7.7.7.7" class="ltx_td ltx_align_center"><span id="S5.T4.7.7.7.7.1" class="ltx_text ltx_font_bold">70.42</span></td>
<td id="S5.T4.7.7.7.8" class="ltx_td ltx_align_center">59.08</td>
</tr>
<tr id="S5.T4.7.7.9" class="ltx_tr">
<td id="S5.T4.7.7.9.1" class="ltx_td ltx_align_left ltx_border_t">Eq. <a href="#S4.E5" title="In 4.1 Adaptive Prompt Tuning ‣ 4 Method ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>
</td>
<td id="S5.T4.7.7.9.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.7.7.9.2.1" class="ltx_text ltx_font_italic"><span id="S5.T4.7.7.9.2.1.1" class="ltx_text ltx_font_bold">77.36</span></span></td>
<td id="S5.T4.7.7.9.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.7.7.9.3.1" class="ltx_text ltx_font_italic"><span id="S5.T4.7.7.9.3.1.1" class="ltx_text ltx_font_bold">52.17</span></span></td>
<td id="S5.T4.7.7.9.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.7.7.9.4.1" class="ltx_text ltx_font_italic"><span id="S5.T4.7.7.9.4.1.1" class="ltx_text ltx_font_bold">72.51</span></span></td>
<td id="S5.T4.7.7.9.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.7.7.9.5.1" class="ltx_text ltx_font_italic"><span id="S5.T4.7.7.9.5.1.1" class="ltx_text ltx_font_bold">48.84</span></span></td>
<td id="S5.T4.7.7.9.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.7.7.9.6.1" class="ltx_text ltx_font_italic"><span id="S5.T4.7.7.9.6.1.1" class="ltx_text ltx_font_bold">84.79</span></span></td>
<td id="S5.T4.7.7.9.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.7.7.9.7.1" class="ltx_text ltx_font_italic"><span id="S5.T4.7.7.9.7.1.1" class="ltx_text ltx_font_bold">68.69</span></span></td>
<td id="S5.T4.7.7.9.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.7.7.9.8.1" class="ltx_text ltx_font_italic"><span id="S5.T4.7.7.9.8.1.1" class="ltx_text ltx_font_bold">67.39</span></span></td>
</tr>
<tr id="S5.T4.7.7.10" class="ltx_tr">
<td id="S5.T4.7.7.10.1" class="ltx_td ltx_align_left"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></td>
<td id="S5.T4.7.7.10.2" class="ltx_td"></td>
<td id="S5.T4.7.7.10.3" class="ltx_td"></td>
<td id="S5.T4.7.7.10.4" class="ltx_td"></td>
<td id="S5.T4.7.7.10.5" class="ltx_td"></td>
<td id="S5.T4.7.7.10.6" class="ltx_td"></td>
<td id="S5.T4.7.7.10.7" class="ltx_td"></td>
<td id="S5.T4.7.7.10.8" class="ltx_td"></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>The impact of combining meta prompts with keys of different domains.</figcaption>
</figure>
<figure id="S5.T5" class="ltx_table">
<div id="S5.T5.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:346.9pt;height:96.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(43.8pt,-12.2pt) scale(1.33793442348956,1.33793442348956) ;">
<table id="S5.T5.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S5.T5.1.1.1" class="ltx_tr" style="background-color:#DEDEDE;">
<td id="S5.T5.1.1.1.1" class="ltx_td ltx_align_left ltx_border_r"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></td>
<td id="S5.T5.1.1.1.2" class="ltx_td ltx_align_center"><span id="S5.T5.1.1.1.2.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">c</span></td>
<td id="S5.T5.1.1.1.3" class="ltx_td ltx_align_center"><span id="S5.T5.1.1.1.3.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">i</span></td>
<td id="S5.T5.1.1.1.4" class="ltx_td ltx_align_center"><span id="S5.T5.1.1.1.4.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">p</span></td>
<td id="S5.T5.1.1.1.5" class="ltx_td ltx_align_center"><span id="S5.T5.1.1.1.5.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">q</span></td>
<td id="S5.T5.1.1.1.6" class="ltx_td ltx_align_center"><span id="S5.T5.1.1.1.6.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">r</span></td>
<td id="S5.T5.1.1.1.7" class="ltx_td ltx_align_center"><span id="S5.T5.1.1.1.7.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">s</span></td>
</tr>
<tr id="S5.T5.1.1.2" class="ltx_tr">
<td id="S5.T5.1.1.2.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">w/o key</td>
<td id="S5.T5.1.1.2.2" class="ltx_td ltx_align_center ltx_border_t">78.30</td>
<td id="S5.T5.1.1.2.3" class="ltx_td ltx_align_center ltx_border_t">51.48</td>
<td id="S5.T5.1.1.2.4" class="ltx_td ltx_align_center ltx_border_t">73.99</td>
<td id="S5.T5.1.1.2.5" class="ltx_td ltx_align_center ltx_border_t">49.05</td>
<td id="S5.T5.1.1.2.6" class="ltx_td ltx_align_center ltx_border_t">85.35</td>
<td id="S5.T5.1.1.2.7" class="ltx_td ltx_align_center ltx_border_t">69.72</td>
</tr>
<tr id="S5.T5.1.1.3" class="ltx_tr">
<td id="S5.T5.1.1.3.1" class="ltx_td ltx_align_left ltx_border_r">w key</td>
<td id="S5.T5.1.1.3.2" class="ltx_td ltx_align_center">78.03</td>
<td id="S5.T5.1.1.3.3" class="ltx_td ltx_align_center">51.59</td>
<td id="S5.T5.1.1.3.4" class="ltx_td ltx_align_center">74.00</td>
<td id="S5.T5.1.1.3.5" class="ltx_td ltx_align_center">49.35</td>
<td id="S5.T5.1.1.3.6" class="ltx_td ltx_align_center">85.67</td>
<td id="S5.T5.1.1.3.7" class="ltx_td ltx_align_center">69.73</td>
</tr>
<tr id="S5.T5.1.1.4" class="ltx_tr">
<td id="S5.T5.1.1.4.1" class="ltx_td ltx_align_left ltx_border_r"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></td>
<td id="S5.T5.1.1.4.2" class="ltx_td"></td>
<td id="S5.T5.1.1.4.3" class="ltx_td"></td>
<td id="S5.T5.1.1.4.4" class="ltx_td"></td>
<td id="S5.T5.1.1.4.5" class="ltx_td"></td>
<td id="S5.T5.1.1.4.6" class="ltx_td"></td>
<td id="S5.T5.1.1.4.7" class="ltx_td"></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>The impact of keys in local training. We show that adding the keys does not destroy the local training. </figcaption>
</figure>
<figure id="S5.T6" class="ltx_table">
<div id="S5.T6.2" class="ltx_inline-block ltx_transformed_outer" style="width:424.9pt;height:102pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(25.0pt,-6.0pt) scale(1.13357558453689,1.13357558453689) ;">
<table id="S5.T6.2.2" class="ltx_tabular ltx_align_middle">
<tr id="S5.T6.2.2.3" class="ltx_tr" style="background-color:#DEDEDE;">
<td id="S5.T6.2.2.3.1" class="ltx_td ltx_align_center"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></td>
<td id="S5.T6.2.2.3.2" class="ltx_td ltx_border_r"></td>
<td id="S5.T6.2.2.3.3" class="ltx_td ltx_align_center"><span id="S5.T6.2.2.3.3.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">i</span></td>
<td id="S5.T6.2.2.3.4" class="ltx_td ltx_align_center"><span id="S5.T6.2.2.3.4.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">p</span></td>
<td id="S5.T6.2.2.3.5" class="ltx_td ltx_align_center"><span id="S5.T6.2.2.3.5.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">q</span></td>
<td id="S5.T6.2.2.3.6" class="ltx_td ltx_align_center"><span id="S5.T6.2.2.3.6.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">r</span></td>
<td id="S5.T6.2.2.3.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T6.2.2.3.7.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">s</span></td>
<td id="S5.T6.2.2.3.8" class="ltx_td ltx_align_center"><span id="S5.T6.2.2.3.8.1" class="ltx_text" style="background-color:#DEDEDE;">unseen domain (<span id="S5.T6.2.2.3.8.1.1" class="ltx_text ltx_font_italic">c</span> )</span></td>
</tr>
<tr id="S5.T6.2.2.4" class="ltx_tr">
<td id="S5.T6.2.2.4.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">PromptFL</td>
<td id="S5.T6.2.2.4.2" class="ltx_td ltx_align_center ltx_border_t">49.71</td>
<td id="S5.T6.2.2.4.3" class="ltx_td ltx_align_center ltx_border_t">71.18</td>
<td id="S5.T6.2.2.4.4" class="ltx_td ltx_align_center ltx_border_t">34.09</td>
<td id="S5.T6.2.2.4.5" class="ltx_td ltx_align_center ltx_border_t">83.58</td>
<td id="S5.T6.2.2.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">67.26</td>
<td id="S5.T6.2.2.4.7" class="ltx_td ltx_align_center ltx_border_t">70.60</td>
</tr>
<tr id="S5.T6.1.1.1" class="ltx_tr">
<td id="S5.T6.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="2"><span id="S5.T6.1.1.1.2.1" class="ltx_text">FedAPT</span></td>
<td id="S5.T6.1.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S5.T6.1.1.1.1.m1.1" class="ltx_Math" alttext="\tau=0.01" display="inline"><semantics id="S5.T6.1.1.1.1.m1.1a"><mrow id="S5.T6.1.1.1.1.m1.1.1" xref="S5.T6.1.1.1.1.m1.1.1.cmml"><mi id="S5.T6.1.1.1.1.m1.1.1.2" xref="S5.T6.1.1.1.1.m1.1.1.2.cmml">τ</mi><mo id="S5.T6.1.1.1.1.m1.1.1.1" xref="S5.T6.1.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S5.T6.1.1.1.1.m1.1.1.3" xref="S5.T6.1.1.1.1.m1.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T6.1.1.1.1.m1.1b"><apply id="S5.T6.1.1.1.1.m1.1.1.cmml" xref="S5.T6.1.1.1.1.m1.1.1"><eq id="S5.T6.1.1.1.1.m1.1.1.1.cmml" xref="S5.T6.1.1.1.1.m1.1.1.1"></eq><ci id="S5.T6.1.1.1.1.m1.1.1.2.cmml" xref="S5.T6.1.1.1.1.m1.1.1.2">𝜏</ci><cn type="float" id="S5.T6.1.1.1.1.m1.1.1.3.cmml" xref="S5.T6.1.1.1.1.m1.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.1.1.1.1.m1.1c">\tau=0.01</annotation></semantics></math></td>
<td id="S5.T6.1.1.1.3" class="ltx_td ltx_align_center ltx_border_t">52.23</td>
<td id="S5.T6.1.1.1.4" class="ltx_td ltx_align_center ltx_border_t">72.76</td>
<td id="S5.T6.1.1.1.5" class="ltx_td ltx_align_center ltx_border_t">51.25</td>
<td id="S5.T6.1.1.1.6" class="ltx_td ltx_align_center ltx_border_t">84.67</td>
<td id="S5.T6.1.1.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">69.35</td>
<td id="S5.T6.1.1.1.8" class="ltx_td ltx_align_center ltx_border_t">68.26</td>
</tr>
<tr id="S5.T6.2.2.2" class="ltx_tr">
<td id="S5.T6.2.2.2.1" class="ltx_td ltx_align_center ltx_border_r"><math id="S5.T6.2.2.2.1.m1.1" class="ltx_Math" alttext="\tau=1" display="inline"><semantics id="S5.T6.2.2.2.1.m1.1a"><mrow id="S5.T6.2.2.2.1.m1.1.1" xref="S5.T6.2.2.2.1.m1.1.1.cmml"><mi id="S5.T6.2.2.2.1.m1.1.1.2" xref="S5.T6.2.2.2.1.m1.1.1.2.cmml">τ</mi><mo id="S5.T6.2.2.2.1.m1.1.1.1" xref="S5.T6.2.2.2.1.m1.1.1.1.cmml">=</mo><mn id="S5.T6.2.2.2.1.m1.1.1.3" xref="S5.T6.2.2.2.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T6.2.2.2.1.m1.1b"><apply id="S5.T6.2.2.2.1.m1.1.1.cmml" xref="S5.T6.2.2.2.1.m1.1.1"><eq id="S5.T6.2.2.2.1.m1.1.1.1.cmml" xref="S5.T6.2.2.2.1.m1.1.1.1"></eq><ci id="S5.T6.2.2.2.1.m1.1.1.2.cmml" xref="S5.T6.2.2.2.1.m1.1.1.2">𝜏</ci><cn type="integer" id="S5.T6.2.2.2.1.m1.1.1.3.cmml" xref="S5.T6.2.2.2.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.2.2.2.1.m1.1c">\tau=1</annotation></semantics></math></td>
<td id="S5.T6.2.2.2.2" class="ltx_td ltx_align_center">52.27</td>
<td id="S5.T6.2.2.2.3" class="ltx_td ltx_align_center">72.14</td>
<td id="S5.T6.2.2.2.4" class="ltx_td ltx_align_center">51.05</td>
<td id="S5.T6.2.2.2.5" class="ltx_td ltx_align_center">84.18</td>
<td id="S5.T6.2.2.2.6" class="ltx_td ltx_align_center ltx_border_r">68.77</td>
<td id="S5.T6.2.2.2.7" class="ltx_td ltx_align_center">70.50</td>
</tr>
<tr id="S5.T6.2.2.5" class="ltx_tr">
<td id="S5.T6.2.2.5.1" class="ltx_td ltx_align_center"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></td>
<td id="S5.T6.2.2.5.2" class="ltx_td"></td>
<td id="S5.T6.2.2.5.3" class="ltx_td"></td>
<td id="S5.T6.2.2.5.4" class="ltx_td"></td>
<td id="S5.T6.2.2.5.5" class="ltx_td"></td>
<td id="S5.T6.2.2.5.6" class="ltx_td"></td>
<td id="S5.T6.2.2.5.7" class="ltx_td"></td>
<td id="S5.T6.2.2.5.8" class="ltx_td"></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 6: </span>The impact of the adaptive network on seen and unseen domains.</figcaption>
</figure>
<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.7" class="ltx_p"><span id="S5.SS3.p1.7.1" class="ltx_text ltx_font_bold">Impact of keys.</span> We do a comprehensive study of the role of ‘key’. We disassemble the global model trained with FedAPT in Table <a href="#S5.T1" title="Table 1 ‣ 5 Experiments ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and compare its performance under different situations: 1) Use the learned meta prompt <math id="S5.SS3.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{p}_{g}" display="inline"><semantics id="S5.SS3.p1.1.m1.1a"><msub id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml"><mi id="S5.SS3.p1.1.m1.1.1.2" xref="S5.SS3.p1.1.m1.1.1.2.cmml">𝐩</mi><mi id="S5.SS3.p1.1.m1.1.1.3" xref="S5.SS3.p1.1.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><apply id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.1.m1.1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS3.p1.1.m1.1.1.2.cmml" xref="S5.SS3.p1.1.m1.1.1.2">𝐩</ci><ci id="S5.SS3.p1.1.m1.1.1.3.cmml" xref="S5.SS3.p1.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">\mathbf{p}_{g}</annotation></semantics></math> to test without any key. 2) Use keys from different domains for testing, such as <math id="S5.SS3.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{p}_{g}+\mathbf{p}_{g}\odot\mathbf{e}^{\prime}_{k}" display="inline"><semantics id="S5.SS3.p1.2.m2.1a"><mrow id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml"><msub id="S5.SS3.p1.2.m2.1.1.2" xref="S5.SS3.p1.2.m2.1.1.2.cmml"><mi id="S5.SS3.p1.2.m2.1.1.2.2" xref="S5.SS3.p1.2.m2.1.1.2.2.cmml">𝐩</mi><mi id="S5.SS3.p1.2.m2.1.1.2.3" xref="S5.SS3.p1.2.m2.1.1.2.3.cmml">g</mi></msub><mo id="S5.SS3.p1.2.m2.1.1.1" xref="S5.SS3.p1.2.m2.1.1.1.cmml">+</mo><mrow id="S5.SS3.p1.2.m2.1.1.3" xref="S5.SS3.p1.2.m2.1.1.3.cmml"><msub id="S5.SS3.p1.2.m2.1.1.3.2" xref="S5.SS3.p1.2.m2.1.1.3.2.cmml"><mi id="S5.SS3.p1.2.m2.1.1.3.2.2" xref="S5.SS3.p1.2.m2.1.1.3.2.2.cmml">𝐩</mi><mi id="S5.SS3.p1.2.m2.1.1.3.2.3" xref="S5.SS3.p1.2.m2.1.1.3.2.3.cmml">g</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S5.SS3.p1.2.m2.1.1.3.1" xref="S5.SS3.p1.2.m2.1.1.3.1.cmml">⊙</mo><msubsup id="S5.SS3.p1.2.m2.1.1.3.3" xref="S5.SS3.p1.2.m2.1.1.3.3.cmml"><mi id="S5.SS3.p1.2.m2.1.1.3.3.2.2" xref="S5.SS3.p1.2.m2.1.1.3.3.2.2.cmml">𝐞</mi><mi id="S5.SS3.p1.2.m2.1.1.3.3.3" xref="S5.SS3.p1.2.m2.1.1.3.3.3.cmml">k</mi><mo id="S5.SS3.p1.2.m2.1.1.3.3.2.3" xref="S5.SS3.p1.2.m2.1.1.3.3.2.3.cmml">′</mo></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><apply id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1"><plus id="S5.SS3.p1.2.m2.1.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1.1"></plus><apply id="S5.SS3.p1.2.m2.1.1.2.cmml" xref="S5.SS3.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p1.2.m2.1.1.2.1.cmml" xref="S5.SS3.p1.2.m2.1.1.2">subscript</csymbol><ci id="S5.SS3.p1.2.m2.1.1.2.2.cmml" xref="S5.SS3.p1.2.m2.1.1.2.2">𝐩</ci><ci id="S5.SS3.p1.2.m2.1.1.2.3.cmml" xref="S5.SS3.p1.2.m2.1.1.2.3">𝑔</ci></apply><apply id="S5.SS3.p1.2.m2.1.1.3.cmml" xref="S5.SS3.p1.2.m2.1.1.3"><csymbol cd="latexml" id="S5.SS3.p1.2.m2.1.1.3.1.cmml" xref="S5.SS3.p1.2.m2.1.1.3.1">direct-product</csymbol><apply id="S5.SS3.p1.2.m2.1.1.3.2.cmml" xref="S5.SS3.p1.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S5.SS3.p1.2.m2.1.1.3.2.1.cmml" xref="S5.SS3.p1.2.m2.1.1.3.2">subscript</csymbol><ci id="S5.SS3.p1.2.m2.1.1.3.2.2.cmml" xref="S5.SS3.p1.2.m2.1.1.3.2.2">𝐩</ci><ci id="S5.SS3.p1.2.m2.1.1.3.2.3.cmml" xref="S5.SS3.p1.2.m2.1.1.3.2.3">𝑔</ci></apply><apply id="S5.SS3.p1.2.m2.1.1.3.3.cmml" xref="S5.SS3.p1.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S5.SS3.p1.2.m2.1.1.3.3.1.cmml" xref="S5.SS3.p1.2.m2.1.1.3.3">subscript</csymbol><apply id="S5.SS3.p1.2.m2.1.1.3.3.2.cmml" xref="S5.SS3.p1.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S5.SS3.p1.2.m2.1.1.3.3.2.1.cmml" xref="S5.SS3.p1.2.m2.1.1.3.3">superscript</csymbol><ci id="S5.SS3.p1.2.m2.1.1.3.3.2.2.cmml" xref="S5.SS3.p1.2.m2.1.1.3.3.2.2">𝐞</ci><ci id="S5.SS3.p1.2.m2.1.1.3.3.2.3.cmml" xref="S5.SS3.p1.2.m2.1.1.3.3.2.3">′</ci></apply><ci id="S5.SS3.p1.2.m2.1.1.3.3.3.cmml" xref="S5.SS3.p1.2.m2.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">\mathbf{p}_{g}+\mathbf{p}_{g}\odot\mathbf{e}^{\prime}_{k}</annotation></semantics></math>.
3) Use the complete APT module, i.e., Eq. <a href="#S4.E5" title="In 4.1 Adaptive Prompt Tuning ‣ 4 Method ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. The results are reported in Tabe <a href="#S5.T4" title="Table 4 ‣ 5.3 Ablation Studies ‣ 5 Experiments ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. The classification ability of the meta prompt <math id="S5.SS3.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{p}_{g}" display="inline"><semantics id="S5.SS3.p1.3.m3.1a"><msub id="S5.SS3.p1.3.m3.1.1" xref="S5.SS3.p1.3.m3.1.1.cmml"><mi id="S5.SS3.p1.3.m3.1.1.2" xref="S5.SS3.p1.3.m3.1.1.2.cmml">𝐩</mi><mi id="S5.SS3.p1.3.m3.1.1.3" xref="S5.SS3.p1.3.m3.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.3.m3.1b"><apply id="S5.SS3.p1.3.m3.1.1.cmml" xref="S5.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.3.m3.1.1.1.cmml" xref="S5.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S5.SS3.p1.3.m3.1.1.2.cmml" xref="S5.SS3.p1.3.m3.1.1.2">𝐩</ci><ci id="S5.SS3.p1.3.m3.1.1.3.cmml" xref="S5.SS3.p1.3.m3.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.3.m3.1c">\mathbf{p}_{g}</annotation></semantics></math> is shown in the first row. Because there is no suitable key, its performance is mediocre. Then the middle six rows show the performance of <math id="S5.SS3.p1.4.m4.1" class="ltx_Math" alttext="\mathbf{p}_{g}" display="inline"><semantics id="S5.SS3.p1.4.m4.1a"><msub id="S5.SS3.p1.4.m4.1.1" xref="S5.SS3.p1.4.m4.1.1.cmml"><mi id="S5.SS3.p1.4.m4.1.1.2" xref="S5.SS3.p1.4.m4.1.1.2.cmml">𝐩</mi><mi id="S5.SS3.p1.4.m4.1.1.3" xref="S5.SS3.p1.4.m4.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.4.m4.1b"><apply id="S5.SS3.p1.4.m4.1.1.cmml" xref="S5.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.4.m4.1.1.1.cmml" xref="S5.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="S5.SS3.p1.4.m4.1.1.2.cmml" xref="S5.SS3.p1.4.m4.1.1.2">𝐩</ci><ci id="S5.SS3.p1.4.m4.1.1.3.cmml" xref="S5.SS3.p1.4.m4.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.4.m4.1c">\mathbf{p}_{g}</annotation></semantics></math> with different keys. We can see that the <math id="S5.SS3.p1.5.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.SS3.p1.5.m5.1a"><mi id="S5.SS3.p1.5.m5.1.1" xref="S5.SS3.p1.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.5.m5.1b"><ci id="S5.SS3.p1.5.m5.1.1.cmml" xref="S5.SS3.p1.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.5.m5.1c">k</annotation></semantics></math>-th key <math id="S5.SS3.p1.6.m6.1" class="ltx_Math" alttext="\mathbf{e}^{\prime}_{k}" display="inline"><semantics id="S5.SS3.p1.6.m6.1a"><msubsup id="S5.SS3.p1.6.m6.1.1" xref="S5.SS3.p1.6.m6.1.1.cmml"><mi id="S5.SS3.p1.6.m6.1.1.2.2" xref="S5.SS3.p1.6.m6.1.1.2.2.cmml">𝐞</mi><mi id="S5.SS3.p1.6.m6.1.1.3" xref="S5.SS3.p1.6.m6.1.1.3.cmml">k</mi><mo id="S5.SS3.p1.6.m6.1.1.2.3" xref="S5.SS3.p1.6.m6.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.6.m6.1b"><apply id="S5.SS3.p1.6.m6.1.1.cmml" xref="S5.SS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.6.m6.1.1.1.cmml" xref="S5.SS3.p1.6.m6.1.1">subscript</csymbol><apply id="S5.SS3.p1.6.m6.1.1.2.cmml" xref="S5.SS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.6.m6.1.1.2.1.cmml" xref="S5.SS3.p1.6.m6.1.1">superscript</csymbol><ci id="S5.SS3.p1.6.m6.1.1.2.2.cmml" xref="S5.SS3.p1.6.m6.1.1.2.2">𝐞</ci><ci id="S5.SS3.p1.6.m6.1.1.2.3.cmml" xref="S5.SS3.p1.6.m6.1.1.2.3">′</ci></apply><ci id="S5.SS3.p1.6.m6.1.1.3.cmml" xref="S5.SS3.p1.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.6.m6.1c">\mathbf{e}^{\prime}_{k}</annotation></semantics></math> can significantly improve the accuracy in the <math id="S5.SS3.p1.7.m7.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.SS3.p1.7.m7.1a"><mi id="S5.SS3.p1.7.m7.1.1" xref="S5.SS3.p1.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.7.m7.1b"><ci id="S5.SS3.p1.7.m7.1.1.cmml" xref="S5.SS3.p1.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.7.m7.1c">k</annotation></semantics></math>-th domain.</p>
</div>
<div id="S5.SS3.p2" class="ltx_para">
<p id="S5.SS3.p2.4" class="ltx_p"><span id="S5.SS3.p2.4.1" class="ltx_text ltx_font_bold">The affect of the adaptive network.</span>
We evaluate the performance of the global model in both client domains and unseen new domains. We introduce softmax temperature <math id="S5.SS3.p2.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S5.SS3.p2.1.m1.1a"><mi id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><ci id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">\tau</annotation></semantics></math> to the output of the adaptive network, and the performance at <math id="S5.SS3.p2.2.m2.1" class="ltx_Math" alttext="\tau=0.01" display="inline"><semantics id="S5.SS3.p2.2.m2.1a"><mrow id="S5.SS3.p2.2.m2.1.1" xref="S5.SS3.p2.2.m2.1.1.cmml"><mi id="S5.SS3.p2.2.m2.1.1.2" xref="S5.SS3.p2.2.m2.1.1.2.cmml">τ</mi><mo id="S5.SS3.p2.2.m2.1.1.1" xref="S5.SS3.p2.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS3.p2.2.m2.1.1.3" xref="S5.SS3.p2.2.m2.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.2.m2.1b"><apply id="S5.SS3.p2.2.m2.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1"><eq id="S5.SS3.p2.2.m2.1.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1.1"></eq><ci id="S5.SS3.p2.2.m2.1.1.2.cmml" xref="S5.SS3.p2.2.m2.1.1.2">𝜏</ci><cn type="float" id="S5.SS3.p2.2.m2.1.1.3.cmml" xref="S5.SS3.p2.2.m2.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.2.m2.1c">\tau=0.01</annotation></semantics></math> can be interpreted as directly determining “which key should be used”. The results in Table <a href="#S5.T6" title="Table 6 ‣ 5.3 Ablation Studies ‣ 5 Experiments ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> show that directly selecting a single key (<math id="S5.SS3.p2.3.m3.1" class="ltx_Math" alttext="\tau=0.01" display="inline"><semantics id="S5.SS3.p2.3.m3.1a"><mrow id="S5.SS3.p2.3.m3.1.1" xref="S5.SS3.p2.3.m3.1.1.cmml"><mi id="S5.SS3.p2.3.m3.1.1.2" xref="S5.SS3.p2.3.m3.1.1.2.cmml">τ</mi><mo id="S5.SS3.p2.3.m3.1.1.1" xref="S5.SS3.p2.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS3.p2.3.m3.1.1.3" xref="S5.SS3.p2.3.m3.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.3.m3.1b"><apply id="S5.SS3.p2.3.m3.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1"><eq id="S5.SS3.p2.3.m3.1.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1.1"></eq><ci id="S5.SS3.p2.3.m3.1.1.2.cmml" xref="S5.SS3.p2.3.m3.1.1.2">𝜏</ci><cn type="float" id="S5.SS3.p2.3.m3.1.1.3.cmml" xref="S5.SS3.p2.3.m3.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.3.m3.1c">\tau=0.01</annotation></semantics></math>) improves the performance in client domains but sacrifices generalization in unseen domains. By adjusting <math id="S5.SS3.p2.4.m4.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S5.SS3.p2.4.m4.1a"><mi id="S5.SS3.p2.4.m4.1.1" xref="S5.SS3.p2.4.m4.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.4.m4.1b"><ci id="S5.SS3.p2.4.m4.1.1.cmml" xref="S5.SS3.p2.4.m4.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.4.m4.1c">\tau</annotation></semantics></math>, we can significantly enhance client performance while maintaining nearly unchanged generalization performance in unknown domains.</p>
</div>
<div id="S5.SS3.p3" class="ltx_para">
<p id="S5.SS3.p3.1" class="ltx_p"><span id="S5.SS3.p3.1.1" class="ltx_text ltx_font_bold">Other results.</span> <span id="S5.SS3.p3.1.2" class="ltx_text ltx_font_bold">1)</span> One worrying point about using the key on the client side is whether the key will limit the learning ability of the local model. We verify this point with an experiment. We repeat the experiment in Table <a href="#S5.T1" title="Table 1 ‣ 5 Experiments ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and report the performance of local models from different domains in Table <a href="#S5.T5" title="Table 5 ‣ 5.3 Ablation Studies ‣ 5 Experiments ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. The results show that the use of the key does not limit the learning of the local model. <span id="S5.SS3.p3.1.3" class="ltx_text ltx_font_bold">2)</span> We also compare different initialized keys. The results suggest that the keys work well for different types of random initialization, including the uniform and the standard normal distribution initialization and random orthogonal initialization. We provide the numerical results in the supplementary materials. <span id="S5.SS3.p3.1.4" class="ltx_text ltx_font_bold">3)</span> After precomputing and saving the text branch outputs of different keys, only the image branch and domain classification weights need to be computed during inference. The final inference cost is as follows: CLIP’s GFLOPs is 4.42 while that of ResNet50 is 4.14. <span id="S5.SS3.p3.1.5" class="ltx_text ltx_font_bold">4)</span> We demonstrate the impact in inference efficiency of the strategy in Figure <a href="#S4.F3" title="Figure 3 ‣ 4.2 Federated Training ‣ 4 Method ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. While maintaining nearly unchanged accuracy, the inference time has been reduced from thirty minutes to 30 seconds in one GPU card. Detailed numerical results are provided in the supplementary materials.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusions</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this paper, we apply the pre-trained CLIP to the multi-domain federated learning in both supervised and unsupervised settings, and propose an adaptive prompt tuning method that uses domain-specific keys to generate specific prompts for each test sample. We have extensively validated the effectiveness of FedAPT. With less than 10% of learnable parameters, FedAPT achieves performance surpassing that of fully-trained models. Moreover, when faced with challenges such as feature and category differences in client data, FedAPT demonstrates a significant performance improvement compared with the competitors.</p>
</div>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Acknowledgements</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">This work was supported in part by the National Key R&amp;D Program of China (No.2021ZD0112803), the National Natural Science Foundation of China (No.62176061), STCSM project (No.22511105000), the Shanghai Research and Innovation Functional Program (No.17DZ2260900), and the Program for Professor of Special Appointment (Eastern Scholar) at Shanghai Institutions of Higher Learning.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2022)</span>
<span class="ltx_bibblock">
Chen, H.-Y.; Tu, C.-H.; Li, Z.; Shen, H.-W.; and Chao, W.-L. 2022.

</span>
<span class="ltx_bibblock">On pre-training for federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2206.11488</em>.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2020)</span>
<span class="ltx_bibblock">
Chen, T.; Kornblith, S.; Norouzi, M.; and Hinton, G. 2020.

</span>
<span class="ltx_bibblock">A simple framework for contrastive learning of visual
representations.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>, 1597–1607.
PMLR.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dinh, Tran, and Nguyen (2020)</span>
<span class="ltx_bibblock">
Dinh, C. T.; Tran, N. H.; and Nguyen, T. D. 2020.

</span>
<span class="ltx_bibblock">Personalized Federated Learning with Moreau Envelopes.

</span>
<span class="ltx_bibblock">In Larochelle, H.; Ranzato, M.; Hadsell, R.; Balcan, M.; and Lin, H.,
eds., <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems 33: Annual
Conference on Neural Information Processing Systems 2020, NeurIPS 2020,
December 6-12, 2020, virtual</em>.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dosovitskiy et al. (2020)</span>
<span class="ltx_bibblock">
Dosovitskiy, A.; Beyer, L.; Kolesnikov, A.; Weissenborn, D.; Zhai, X.;
Unterthiner, T.; Dehghani, M.; Minderer, M.; Heigold, G.; Gelly, S.; et al.
2020.

</span>
<span class="ltx_bibblock">An image is worth 16x16 words: Transformers for image recognition at
scale.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2010.11929</em>.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fallah, Mokhtari, and Ozdaglar (2020)</span>
<span class="ltx_bibblock">
Fallah, A.; Mokhtari, A.; and Ozdaglar, A. 2020.

</span>
<span class="ltx_bibblock">Personalized federated learning with theoretical guarantees: A
model-agnostic meta-learning approach.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 33:
3557–3568.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Feng et al. (2023)</span>
<span class="ltx_bibblock">
Feng, C.-M.; Yu, K.; Liu, N.; Xu, X.; Khan, S.; and Zuo, W. 2023.

</span>
<span class="ltx_bibblock">Towards Instance-adaptive Inference for Federated Learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF International Conference on
Computer Vision</em>, 23287–23296.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gong et al. (2012)</span>
<span class="ltx_bibblock">
Gong, B.; Shi, Y.; Sha, F.; and Grauman, K. 2012.

</span>
<span class="ltx_bibblock">Geodesic flow kernel for unsupervised domain adaptation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">2012 IEEE conference on computer vision and pattern
recognition</em>, 2066–2073. IEEE.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Griffin, Holub, and Perona (2007)</span>
<span class="ltx_bibblock">
Griffin, G.; Holub, A.; and Perona, P. 2007.

</span>
<span class="ltx_bibblock">Caltech-256 object category dataset.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2022)</span>
<span class="ltx_bibblock">
Guo, T.; Guo, S.; Wang, J.; and Xu, W. 2022.

</span>
<span class="ltx_bibblock">PromptFL: Let Federated Participants Cooperatively Learn Prompts
Instead of Models–Federated Learning in Age of Foundation Model.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2208.11625</em>.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hanzely et al. (2020)</span>
<span class="ltx_bibblock">
Hanzely, F.; Hanzely, S.; Horváth, S.; and Richtárik, P. 2020.

</span>
<span class="ltx_bibblock">Lower bounds and optimal algorithms for personalized federated
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 33:
2304–2315.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2016)</span>
<span class="ltx_bibblock">
He, K.; Zhang, X.; Ren, S.; and Sun, J. 2016.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">In <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</em>, 770–778.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsu, Qi, and Brown (2020)</span>
<span class="ltx_bibblock">
Hsu, T.-M. H.; Qi, H.; and Brown, M. 2020.

</span>
<span class="ltx_bibblock">Federated visual classification with real-world data distribution.

</span>
<span class="ltx_bibblock">In <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">European Conference on Computer Vision</em>, 76–92. Springer.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jia et al. (2021)</span>
<span class="ltx_bibblock">
Jia, C.; Yang, Y.; Xia, Y.; Chen, Y.-T.; Parekh, Z.; Pham, H.; Le, Q.; Sung,
Y.-H.; Li, Z.; and Duerig, T. 2021.

</span>
<span class="ltx_bibblock">Scaling up visual and vision-language representation learning with
noisy text supervision.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 4904–4916.
PMLR.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy et al. (2020)</span>
<span class="ltx_bibblock">
Karimireddy, S. P.; Kale, S.; Mohri, M.; Reddi, S.; Stich, S.; and Suresh,
A. T. 2020.

</span>
<span class="ltx_bibblock">SCAFFOLD: Stochastic controlled averaging for federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 5132–5143.
PMLR.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2007)</span>
<span class="ltx_bibblock">
Li, B.; Chi, M.; Fan, J.; and Xue, X. 2007.

</span>
<span class="ltx_bibblock">Support cluster machine.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 24th International Conference on Machine
Learning</em>, 505–512.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li, He, and Song (2021)</span>
<span class="ltx_bibblock">
Li, Q.; He, B.; and Song, D. 2021.

</span>
<span class="ltx_bibblock">Model-contrastive federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, 10713–10722.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020)</span>
<span class="ltx_bibblock">
Li, T.; Sahu, A. K.; Zaheer, M.; Sanjabi, M.; Talwalkar, A.; and Smith, V.
2020.

</span>
<span class="ltx_bibblock">Federated Optimization in Heterogeneous Networks.

</span>
<span class="ltx_bibblock">In Dhillon, I. S.; Papailiopoulos, D. S.; and Sze, V., eds.,
<em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">MLSys</em>. mlsys.org.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2021)</span>
<span class="ltx_bibblock">
Li, X.; Jiang, M.; Zhang, X.; Kamp, M.; and Dou, Q. 2021.

</span>
<span class="ltx_bibblock">FedBN: Federated Learning on Non-IID Features via Local Batch
Normalization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">9th International Conference on Learning Representations,
ICLR 2021, Virtual Event, Austria, May 3-7, 2021</em>. OpenReview.net.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li and Liang (2021)</span>
<span class="ltx_bibblock">
Li, X. L.; and Liang, P. 2021.

</span>
<span class="ltx_bibblock">Prefix-tuning: Optimizing continuous prompts for generation.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2101.00190</em>.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2021a)</span>
<span class="ltx_bibblock">
Liu, P.; Yuan, W.; Fu, J.; Jiang, Z.; Hayashi, H.; and Neubig, G.
2021a.

</span>
<span class="ltx_bibblock">Pre-train, prompt, and predict: A systematic survey of prompting
methods in natural language processing.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2107.13586</em>.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2021b)</span>
<span class="ltx_bibblock">
Liu, X.; Ji, K.; Fu, Y.; Du, Z.; Yang, Z.; and Tang, J. 2021b.

</span>
<span class="ltx_bibblock">P-tuning v2: Prompt tuning can be comparable to fine-tuning
universally across scales and tasks.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2110.07602</em>.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2020)</span>
<span class="ltx_bibblock">
Liu, Y.; Huang, A.; Luo, Y.; Huang, H.; Liu, Y.; Chen, Y.; Feng, L.; Chen, T.;
Yu, H.; and Yang, Q. 2020.

</span>
<span class="ltx_bibblock">Fedvision: An online visual object detection platform powered by
federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</em>, volume 34, 13172–13179.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2023)</span>
<span class="ltx_bibblock">
Lu, W.; Hu, X.; Wang, J.; and Xie, X. 2023.

</span>
<span class="ltx_bibblock">FedCLIP: Fast Generalization and Personalization for CLIP in
Federated Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2302.13485</em>.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et al. (2022)</span>
<span class="ltx_bibblock">
Luo, Z.; Wang, Y.; Wang, Z.; Sun, Z.; and Tan, T. 2022.

</span>
<span class="ltx_bibblock">Disentangled Federated Learning for Tackling Attributes Skew via
Invariant Aggregation and Diversity Transferring.

</span>
<span class="ltx_bibblock">In Chaudhuri, K.; Jegelka, S.; Song, L.; Szepesvári, C.; Niu,
G.; and Sabato, S., eds., <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning,
ICML 2022, 17-23 July 2022, Baltimore, Maryland, USA</em>, volume 162 of
<em id="bib.bib24.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>, 14527–14541. PMLR.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
McMahan, B.; Moore, E.; Ramage, D.; Hampson, S.; and y Arcas, B. A. 2017.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Artificial Intelligence and Statistics</em>, 1273–1282. PMLR.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nguyen et al. (2023)</span>
<span class="ltx_bibblock">
Nguyen, J.; Wang, J.; Malik, K.; Sanjabi, M.; and Rabbat, M. 2023.

</span>
<span class="ltx_bibblock">Where to Begin? Exploring the Impact of Pre-Training and
Initialization in Federated.

</span>
<span class="ltx_bibblock">In <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peng et al. (2019a)</span>
<span class="ltx_bibblock">
Peng, X.; Bai, Q.; Xia, X.; Huang, Z.; Saenko, K.; and Wang, B.
2019a.

</span>
<span class="ltx_bibblock">Moment matching for multi-source domain adaptation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF international conference on
computer vision</em>, 1406–1415.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peng et al. (2019b)</span>
<span class="ltx_bibblock">
Peng, X.; Huang, Z.; Zhu, Y.; and Saenko, K. 2019b.

</span>
<span class="ltx_bibblock">Federated adversarial domain adaptation.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1911.02054</em>.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qiu et al. (2023)</span>
<span class="ltx_bibblock">
Qiu, C.; Li, X.; Mummadi, C. K.; Ganesh, M. R.; Li, Z.; Peng, L.; and Lin,
W.-Y. 2023.

</span>
<span class="ltx_bibblock">Text-driven Prompt Generation for Vision-Language Models in Federated
Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2310.06123</em>.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al. (2021)</span>
<span class="ltx_bibblock">
Radford, A.; Kim, J. W.; Hallacy, C.; Ramesh, A.; Goh, G.; Agarwal, S.; Sastry,
G.; Askell, A.; Mishkin, P.; Clark, J.; et al. 2021.

</span>
<span class="ltx_bibblock">Learning transferable visual models from natural language
supervision.

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 8748–8763.
PMLR.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reddi et al. (2020)</span>
<span class="ltx_bibblock">
Reddi, S.; Charles, Z.; Zaheer, M.; Garrett, Z.; Rush, K.; Konečnỳ,
J.; Kumar, S.; and McMahan, H. B. 2020.

</span>
<span class="ltx_bibblock">Adaptive federated optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2003.00295</em>.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Saenko et al. (2010)</span>
<span class="ltx_bibblock">
Saenko, K.; Kulis, B.; Fritz, M.; and Darrell, T. 2010.

</span>
<span class="ltx_bibblock">Adapting visual category models to new domains.

</span>
<span class="ltx_bibblock">In <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">European conference on computer vision</em>, 213–226. Springer.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Singh and Jaggi (2020)</span>
<span class="ltx_bibblock">
Singh, S. P.; and Jaggi, M. 2020.

</span>
<span class="ltx_bibblock">Model fusion via optimal transport.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 33.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su, Li, and Xue (2023)</span>
<span class="ltx_bibblock">
Su, S.; Li, B.; and Xue, X. 2023.

</span>
<span class="ltx_bibblock">One-shot Federated Learning without server-side training.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Neural Networks</em>, 164: 203–215.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et al. (2023)</span>
<span class="ltx_bibblock">
Su, S.; Li, B.; Zhang, C.; Yang, M.; and Xue, X. 2023.

</span>
<span class="ltx_bibblock">Cross-domain Federated Object Detection.

</span>
<span class="ltx_bibblock">In <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">2023 IEEE International Conference on Multimedia and Expo
(ICME)</em>, 1469–1474. IEEE.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan et al. (2022)</span>
<span class="ltx_bibblock">
Tan, Y.; Long, G.; Ma, J.; Liu, L.; Zhou, T.; and Jiang, J. 2022.

</span>
<span class="ltx_bibblock">Federated learning from pre-trained models: A contrastive learning
approach.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Vaswani, A.; Shazeer, N.; Parmar, N.; Uszkoreit, J.; Jones, L.; Gomez, A. N.;
Kaiser, Ł.; and Polosukhin, I. 2017.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 30.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2020a)</span>
<span class="ltx_bibblock">
Wang, H.; Yurochkin, M.; Sun, Y.; Papailiopoulos, D. S.; and Khazaeni, Y.
2020a.

</span>
<span class="ltx_bibblock">Federated Learning with Matched Averaging.

</span>
<span class="ltx_bibblock">In <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2020b)</span>
<span class="ltx_bibblock">
Wang, J.; Liu, Q.; Liang, H.; Joshi, G.; and Poor, H. V. 2020b.

</span>
<span class="ltx_bibblock">Tackling the objective inconsistency problem in heterogeneous
federated optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems 33</em>.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2022)</span>
<span class="ltx_bibblock">
Wang, Z.; Wu, Z.; Agarwal, D.; and Sun, J. 2022.

</span>
<span class="ltx_bibblock">MedCLIP: Contrastive Learning from Unpaired Medical Images and Text.

</span>
<span class="ltx_bibblock"><em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2210.10163</em>.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2023)</span>
<span class="ltx_bibblock">
Yang, M.; Su, S.; Li, B.; and Xue, X. 2023.

</span>
<span class="ltx_bibblock">Exploring One-shot Semi-supervised Federated Learning with A
Pre-trained Diffusion Model.

</span>
<span class="ltx_bibblock"><em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.04063</em>.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2022)</span>
<span class="ltx_bibblock">
Yang, S.; Wang, Y.; Wang, K.; Jui, S.; et al. 2022.

</span>
<span class="ltx_bibblock">Attracting and dispersing: A simple approach for source-free domain
adaptation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et al. (2022)</span>
<span class="ltx_bibblock">
Yao, L.; Han, J.; Wen, Y.; Liang, X.; Xu, D.; Zhang, W.; Li, Z.; Xu, C.; and
Xu, H. 2022.

</span>
<span class="ltx_bibblock">DetCLIP: Dictionary-Enriched Visual-Concept Paralleled Pre-training
for Open-world Detection.

</span>
<span class="ltx_bibblock"><em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2209.09407</em>.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2020)</span>
<span class="ltx_bibblock">
Yu, F.; Rawat, A. S.; Menon, A.; and Kumar, S. 2020.

</span>
<span class="ltx_bibblock">Federated learning with only positive labels.

</span>
<span class="ltx_bibblock">In <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 10946–10956.
PMLR.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2023)</span>
<span class="ltx_bibblock">
Yu, H.; Wang, X.; Li, B.; and Xue, X. 2023.

</span>
<span class="ltx_bibblock">Chinese Text Recognition with A Pre-Trained CLIP-Like Model Through
Image-IDS Aligning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF International Conference on
Computer Vision</em>, 11943–11952.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhong et al. (2022)</span>
<span class="ltx_bibblock">
Zhong, Y.; Yang, J.; Zhang, P.; Li, C.; Codella, N.; Li, L. H.; Zhou, L.; Dai,
X.; Yuan, L.; Li, Y.; et al. 2022.

</span>
<span class="ltx_bibblock">Regionclip: Region-based language-image pretraining.

</span>
<span class="ltx_bibblock">In <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, 16793–16803.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. (2022a)</span>
<span class="ltx_bibblock">
Zhou, K.; Yang, J.; Loy, C. C.; and Liu, Z. 2022a.

</span>
<span class="ltx_bibblock">Conditional prompt learning for vision-language models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, 16816–16825.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. (2022b)</span>
<span class="ltx_bibblock">
Zhou, K.; Yang, J.; Loy, C. C.; and Liu, Z. 2022b.

</span>
<span class="ltx_bibblock">Learning to prompt for vision-language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">International Journal of Computer Vision</em>, 130(9): 2337–2348.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhuang, Wen, and Zhang (2021)</span>
<span class="ltx_bibblock">
Zhuang, W.; Wen, Y.; and Zhang, S. 2021.

</span>
<span class="ltx_bibblock">Joint optimization in edge-cloud continuum for federated unsupervised
person re-identification.

</span>
<span class="ltx_bibblock">In <em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 29th ACM International Conference on
Multimedia</em>, 433–441.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhuang et al. (2020)</span>
<span class="ltx_bibblock">
Zhuang, W.; Wen, Y.; Zhang, X.; Gan, X.; Yin, D.; Zhou, D.; Zhang, S.; and Yi,
S. 2020.

</span>
<span class="ltx_bibblock">Performance optimization of federated person re-identification via
benchmark analysis.

</span>
<span class="ltx_bibblock">In <em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 28th ACM International Conference on
Multimedia</em>, 955–963.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Details of Experiments</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.3" class="ltx_p">In some of the experiments, we utilize a standard Dirichlet distribution to partition the dataset, thereby creating disparities in class distributions among clients. Figure <a href="#A1.F5" title="Figure 5 ‣ Appendix A Details of Experiments ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> illustrates the impact of different hyperparameter values, denoted as <math id="A1.p1.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="A1.p1.1.m1.1a"><mi id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b"><ci id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">\beta</annotation></semantics></math>, on the divergence in class distributions. As <math id="A1.p1.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="A1.p1.2.m2.1a"><mi id="A1.p1.2.m2.1.1" xref="A1.p1.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.p1.2.m2.1b"><ci id="A1.p1.2.m2.1.1.cmml" xref="A1.p1.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.2.m2.1c">\beta</annotation></semantics></math> decreases, the disparities increase, and when <math id="A1.p1.3.m3.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="A1.p1.3.m3.1a"><mi id="A1.p1.3.m3.1.1" xref="A1.p1.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.p1.3.m3.1b"><ci id="A1.p1.3.m3.1.1.cmml" xref="A1.p1.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.3.m3.1c">\beta</annotation></semantics></math> approaches 0, there is minimal class overlap among clients.</p>
</div>
<div id="A1.p2" class="ltx_para">
<p id="A1.p2.1" class="ltx_p">We use the standard pre-trained CLIP. All images is reshaped into 224*224. We use the preprocess pipeline defined by CLIP, which includes Resize, CenterCrop, ToTensor and Normalize.</p>
</div>
<figure id="A1.F5" class="ltx_figure"><img src="/html/2211.07864/assets/x5.png" id="A1.F5.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="415" height="633" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Unbalanced label distribution controlled by <math id="A1.F5.3.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="A1.F5.3.m1.1b"><mi id="A1.F5.3.m1.1.1" xref="A1.F5.3.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.F5.3.m1.1c"><ci id="A1.F5.3.m1.1.1.cmml" xref="A1.F5.3.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.F5.3.m1.1d">\beta</annotation></semantics></math>. When <math id="A1.F5.4.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="A1.F5.4.m2.1b"><mi id="A1.F5.4.m2.1.1" xref="A1.F5.4.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.F5.4.m2.1c"><ci id="A1.F5.4.m2.1.1.cmml" xref="A1.F5.4.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.F5.4.m2.1d">\beta</annotation></semantics></math> is small, there is almost no category overlap between different clients.</figcaption>
</figure>
<div id="A1.p3" class="ltx_para">
<p id="A1.p3.1" class="ltx_p">The details of the local datasets when each domain has one client are shown in Table <a href="#A1.T7" title="Table 7 ‣ Appendix A Details of Experiments ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>. When each domain has five clients, the training set of each domain is divided into 5 parts.</p>
</div>
<figure id="A1.T7" class="ltx_table">
<div id="A1.T7.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:114.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(36.6pt,-9.7pt) scale(1.20329118498165,1.20329118498165) ;">
<table id="A1.T7.1.1" class="ltx_tabular ltx_align_middle">
<tr id="A1.T7.1.1.1" class="ltx_tr" style="background-color:#DEDEDE;">
<td id="A1.T7.1.1.1.1" class="ltx_td ltx_align_center ltx_border_r"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></td>
<td id="A1.T7.1.1.1.2" class="ltx_td ltx_align_center">
<table id="A1.T7.1.1.1.2.1" class="ltx_tabular ltx_align_middle" style="background-color:#DEDEDE;">
<tr id="A1.T7.1.1.1.2.1.1" class="ltx_tr">
<td id="A1.T7.1.1.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Client0</td>
</tr>
<tr id="A1.T7.1.1.1.2.1.2" class="ltx_tr">
<td id="A1.T7.1.1.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">clipart</td>
</tr>
</table>
</td>
<td id="A1.T7.1.1.1.3" class="ltx_td ltx_align_center">
<table id="A1.T7.1.1.1.3.1" class="ltx_tabular ltx_align_middle">
<tr id="A1.T7.1.1.1.3.1.1" class="ltx_tr">
<td id="A1.T7.1.1.1.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Client1</td>
</tr>
<tr id="A1.T7.1.1.1.3.1.2" class="ltx_tr">
<td id="A1.T7.1.1.1.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">infograph</td>
</tr>
</table>
</td>
<td id="A1.T7.1.1.1.4" class="ltx_td ltx_align_center">
<table id="A1.T7.1.1.1.4.1" class="ltx_tabular ltx_align_middle">
<tr id="A1.T7.1.1.1.4.1.1" class="ltx_tr">
<td id="A1.T7.1.1.1.4.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Client2</td>
</tr>
<tr id="A1.T7.1.1.1.4.1.2" class="ltx_tr">
<td id="A1.T7.1.1.1.4.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">painting</td>
</tr>
</table>
</td>
<td id="A1.T7.1.1.1.5" class="ltx_td ltx_align_center">
<table id="A1.T7.1.1.1.5.1" class="ltx_tabular ltx_align_middle">
<tr id="A1.T7.1.1.1.5.1.1" class="ltx_tr">
<td id="A1.T7.1.1.1.5.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Client3</td>
</tr>
<tr id="A1.T7.1.1.1.5.1.2" class="ltx_tr">
<td id="A1.T7.1.1.1.5.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">quickdraw</td>
</tr>
</table>
</td>
<td id="A1.T7.1.1.1.6" class="ltx_td ltx_align_center">
<table id="A1.T7.1.1.1.6.1" class="ltx_tabular ltx_align_middle">
<tr id="A1.T7.1.1.1.6.1.1" class="ltx_tr">
<td id="A1.T7.1.1.1.6.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Client3</td>
</tr>
<tr id="A1.T7.1.1.1.6.1.2" class="ltx_tr">
<td id="A1.T7.1.1.1.6.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">real</td>
</tr>
</table>
</td>
<td id="A1.T7.1.1.1.7" class="ltx_td ltx_align_center">
<table id="A1.T7.1.1.1.7.1" class="ltx_tabular ltx_align_middle">
<tr id="A1.T7.1.1.1.7.1.1" class="ltx_tr">
<td id="A1.T7.1.1.1.7.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Client5</td>
</tr>
<tr id="A1.T7.1.1.1.7.1.2" class="ltx_tr">
<td id="A1.T7.1.1.1.7.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">sketch</td>
</tr>
</table>
</td>
</tr>
<tr id="A1.T7.1.1.2" class="ltx_tr">
<td id="A1.T7.1.1.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">train</td>
<td id="A1.T7.1.1.2.2" class="ltx_td ltx_align_center ltx_border_t">33k</td>
<td id="A1.T7.1.1.2.3" class="ltx_td ltx_align_center ltx_border_t">36k</td>
<td id="A1.T7.1.1.2.4" class="ltx_td ltx_align_center ltx_border_t">50k</td>
<td id="A1.T7.1.1.2.5" class="ltx_td ltx_align_center ltx_border_t">120k</td>
<td id="A1.T7.1.1.2.6" class="ltx_td ltx_align_center ltx_border_t">121k</td>
<td id="A1.T7.1.1.2.7" class="ltx_td ltx_align_center ltx_border_t">48k</td>
</tr>
<tr id="A1.T7.1.1.3" class="ltx_tr">
<td id="A1.T7.1.1.3.1" class="ltx_td ltx_align_center ltx_border_r">test</td>
<td id="A1.T7.1.1.3.2" class="ltx_td ltx_align_center">15k</td>
<td id="A1.T7.1.1.3.3" class="ltx_td ltx_align_center">16k</td>
<td id="A1.T7.1.1.3.4" class="ltx_td ltx_align_center">22k</td>
<td id="A1.T7.1.1.3.5" class="ltx_td ltx_align_center">52k</td>
<td id="A1.T7.1.1.3.6" class="ltx_td ltx_align_center">52k</td>
<td id="A1.T7.1.1.3.7" class="ltx_td ltx_align_center">21k</td>
</tr>
<tr id="A1.T7.1.1.4" class="ltx_tr">
<td id="A1.T7.1.1.4.1" class="ltx_td ltx_align_center ltx_border_r"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></td>
<td id="A1.T7.1.1.4.2" class="ltx_td"></td>
<td id="A1.T7.1.1.4.3" class="ltx_td"></td>
<td id="A1.T7.1.1.4.4" class="ltx_td"></td>
<td id="A1.T7.1.1.4.5" class="ltx_td"></td>
<td id="A1.T7.1.1.4.6" class="ltx_td"></td>
<td id="A1.T7.1.1.4.7" class="ltx_td"></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>The local datasets when each domain has one client.</figcaption>
</figure>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Additional Experiments</h2>

<section id="A2.SS0.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Initialization of keys</h4>

<div id="A2.SS0.SSSx1.p1" class="ltx_para">
<p id="A2.SS0.SSSx1.p1.1" class="ltx_p">We also compare different initialized keys. Table <a href="#A2.T9" title="Table 9 ‣ The improve of inference efﬁciency ‣ Appendix B Additional Experiments ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> shows the results. ‘rand_U’ means the uniform distribution U(0,1). ‘rand_N’ means the standard normal distribution. ‘rand_01’ means to randomly generate one 01 matrix. ‘rand_O’ indicates random orthogonal initialization, that is, the keys of each domain are orthogonal. We can see that the results of different initializations are stable.</p>
</div>
</section>
<section id="A2.SS0.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">The improve of inference efﬁciency</h4>

<div id="A2.SS0.SSSx2.p1" class="ltx_para">
<p id="A2.SS0.SSSx2.p1.1" class="ltx_p">We demonstrate the impact in inference efﬁciency of the strategy in Figure 3 of the main paper.
By precomputing text encodings for different keys, we avoid the need to compute text encodings for each sample in a batch repeatedly, thus saving a considerable amount of inference cost.
While maintaining nearly unchanged accuracy, the inference time has been reduced by about 60 times, see Table <a href="#A2.T8" title="Table 8 ‣ The improve of inference efﬁciency ‣ Appendix B Additional Experiments ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
<figure id="A2.T8" class="ltx_table">
<table id="A2.T8.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A2.T8.1.1" class="ltx_tr" style="background-color:#DEDEDE;">
<td id="A2.T8.1.1.1" class="ltx_td ltx_align_left ltx_border_r"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></td>
<td id="A2.T8.1.1.2" class="ltx_td ltx_align_left"><span id="A2.T8.1.1.2.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">c</span></td>
<td id="A2.T8.1.1.3" class="ltx_td ltx_align_left"><span id="A2.T8.1.1.3.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">i</span></td>
<td id="A2.T8.1.1.4" class="ltx_td ltx_align_left"><span id="A2.T8.1.1.4.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">p</span></td>
<td id="A2.T8.1.1.5" class="ltx_td ltx_align_left"><span id="A2.T8.1.1.5.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">q</span></td>
<td id="A2.T8.1.1.6" class="ltx_td ltx_align_left"><span id="A2.T8.1.1.6.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">r</span></td>
<td id="A2.T8.1.1.7" class="ltx_td ltx_align_left"><span id="A2.T8.1.1.7.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">s</span></td>
</tr>
<tr id="A2.T8.1.2" class="ltx_tr">
<td id="A2.T8.1.2.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">original (min)</td>
<td id="A2.T8.1.2.2" class="ltx_td ltx_align_left ltx_border_t">19</td>
<td id="A2.T8.1.2.3" class="ltx_td ltx_align_left ltx_border_t">39</td>
<td id="A2.T8.1.2.4" class="ltx_td ltx_align_left ltx_border_t">31</td>
<td id="A2.T8.1.2.5" class="ltx_td ltx_align_left ltx_border_t">30</td>
<td id="A2.T8.1.2.6" class="ltx_td ltx_align_left ltx_border_t">60</td>
<td id="A2.T8.1.2.7" class="ltx_td ltx_align_left ltx_border_t">30</td>
</tr>
<tr id="A2.T8.1.3" class="ltx_tr">
<td id="A2.T8.1.3.1" class="ltx_td ltx_align_left ltx_border_r">Improved (sec)</td>
<td id="A2.T8.1.3.2" class="ltx_td ltx_align_left">19.5</td>
<td id="A2.T8.1.3.3" class="ltx_td ltx_align_left">26</td>
<td id="A2.T8.1.3.4" class="ltx_td ltx_align_left">30</td>
<td id="A2.T8.1.3.5" class="ltx_td ltx_align_left">65</td>
<td id="A2.T8.1.3.6" class="ltx_td ltx_align_left">67</td>
<td id="A2.T8.1.3.7" class="ltx_td ltx_align_left">32</td>
</tr>
<tr id="A2.T8.1.4" class="ltx_tr">
<td id="A2.T8.1.4.1" class="ltx_td ltx_align_left ltx_border_r"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></td>
<td id="A2.T8.1.4.2" class="ltx_td"></td>
<td id="A2.T8.1.4.3" class="ltx_td"></td>
<td id="A2.T8.1.4.4" class="ltx_td"></td>
<td id="A2.T8.1.4.5" class="ltx_td"></td>
<td id="A2.T8.1.4.6" class="ltx_td"></td>
<td id="A2.T8.1.4.7" class="ltx_td"></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span>The improve of inference efﬁciency.</figcaption>
</figure>
<figure id="A2.T9" class="ltx_table">
<div id="A2.T9.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:151.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(62.4pt,-21.8pt) scale(1.40405572443675,1.40405572443675) ;">
<table id="A2.T9.1.1" class="ltx_tabular ltx_align_middle">
<tr id="A2.T9.1.1.1" class="ltx_tr" style="background-color:#DEDEDE;">
<td id="A2.T9.1.1.1.1" class="ltx_td ltx_align_left"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></td>
<td id="A2.T9.1.1.1.2" class="ltx_td ltx_align_center"><span id="A2.T9.1.1.1.2.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">c</span></td>
<td id="A2.T9.1.1.1.3" class="ltx_td ltx_align_center"><span id="A2.T9.1.1.1.3.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">i</span></td>
<td id="A2.T9.1.1.1.4" class="ltx_td ltx_align_center"><span id="A2.T9.1.1.1.4.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">p</span></td>
<td id="A2.T9.1.1.1.5" class="ltx_td ltx_align_center"><span id="A2.T9.1.1.1.5.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">q</span></td>
<td id="A2.T9.1.1.1.6" class="ltx_td ltx_align_center"><span id="A2.T9.1.1.1.6.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">r</span></td>
<td id="A2.T9.1.1.1.7" class="ltx_td ltx_align_center"><span id="A2.T9.1.1.1.7.1" class="ltx_text ltx_font_italic" style="background-color:#DEDEDE;">s</span></td>
<td id="A2.T9.1.1.1.8" class="ltx_td ltx_align_center"><span id="A2.T9.1.1.1.8.1" class="ltx_text" style="background-color:#DEDEDE;">Average</span></td>
</tr>
<tr id="A2.T9.1.1.2" class="ltx_tr">
<td id="A2.T9.1.1.2.1" class="ltx_td ltx_align_left ltx_border_t">rand_U</td>
<td id="A2.T9.1.1.2.2" class="ltx_td ltx_align_center ltx_border_t">77.36</td>
<td id="A2.T9.1.1.2.3" class="ltx_td ltx_align_center ltx_border_t">52.17</td>
<td id="A2.T9.1.1.2.4" class="ltx_td ltx_align_center ltx_border_t">72.51</td>
<td id="A2.T9.1.1.2.5" class="ltx_td ltx_align_center ltx_border_t">48.84</td>
<td id="A2.T9.1.1.2.6" class="ltx_td ltx_align_center ltx_border_t">84.79</td>
<td id="A2.T9.1.1.2.7" class="ltx_td ltx_align_center ltx_border_t">68.69</td>
<td id="A2.T9.1.1.2.8" class="ltx_td ltx_align_center ltx_border_t">67.39</td>
</tr>
<tr id="A2.T9.1.1.3" class="ltx_tr">
<td id="A2.T9.1.1.3.1" class="ltx_td ltx_align_left">rand_N</td>
<td id="A2.T9.1.1.3.2" class="ltx_td ltx_align_center">75.78</td>
<td id="A2.T9.1.1.3.3" class="ltx_td ltx_align_center">51.86</td>
<td id="A2.T9.1.1.3.4" class="ltx_td ltx_align_center">72.02</td>
<td id="A2.T9.1.1.3.5" class="ltx_td ltx_align_center">53.82</td>
<td id="A2.T9.1.1.3.6" class="ltx_td ltx_align_center">84.20</td>
<td id="A2.T9.1.1.3.7" class="ltx_td ltx_align_center">67.40</td>
<td id="A2.T9.1.1.3.8" class="ltx_td ltx_align_center">67.51</td>
</tr>
<tr id="A2.T9.1.1.4" class="ltx_tr">
<td id="A2.T9.1.1.4.1" class="ltx_td ltx_align_left">rand_01</td>
<td id="A2.T9.1.1.4.2" class="ltx_td ltx_align_center">76.60</td>
<td id="A2.T9.1.1.4.3" class="ltx_td ltx_align_center">52.33</td>
<td id="A2.T9.1.1.4.4" class="ltx_td ltx_align_center">72.59</td>
<td id="A2.T9.1.1.4.5" class="ltx_td ltx_align_center">52.89</td>
<td id="A2.T9.1.1.4.6" class="ltx_td ltx_align_center">84.83</td>
<td id="A2.T9.1.1.4.7" class="ltx_td ltx_align_center">68.30</td>
<td id="A2.T9.1.1.4.8" class="ltx_td ltx_align_center">67.92</td>
</tr>
<tr id="A2.T9.1.1.5" class="ltx_tr">
<td id="A2.T9.1.1.5.1" class="ltx_td ltx_align_left">rand_O</td>
<td id="A2.T9.1.1.5.2" class="ltx_td ltx_align_center">77.00</td>
<td id="A2.T9.1.1.5.3" class="ltx_td ltx_align_center">52.25</td>
<td id="A2.T9.1.1.5.4" class="ltx_td ltx_align_center">72.83</td>
<td id="A2.T9.1.1.5.5" class="ltx_td ltx_align_center">51.29</td>
<td id="A2.T9.1.1.5.6" class="ltx_td ltx_align_center">84.86</td>
<td id="A2.T9.1.1.5.7" class="ltx_td ltx_align_center">68.64</td>
<td id="A2.T9.1.1.5.8" class="ltx_td ltx_align_center">67.81</td>
</tr>
<tr id="A2.T9.1.1.6" class="ltx_tr">
<td id="A2.T9.1.1.6.1" class="ltx_td ltx_align_left"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></td>
<td id="A2.T9.1.1.6.2" class="ltx_td"></td>
<td id="A2.T9.1.1.6.3" class="ltx_td"></td>
<td id="A2.T9.1.1.6.4" class="ltx_td"></td>
<td id="A2.T9.1.1.6.5" class="ltx_td"></td>
<td id="A2.T9.1.1.6.6" class="ltx_td"></td>
<td id="A2.T9.1.1.6.7" class="ltx_td"></td>
<td id="A2.T9.1.1.6.8" class="ltx_td"></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 9: </span>The effect of different initialization keys. It shows the robustness of initialization methods to keys.</figcaption>
</figure>
<figure id="A2.T10" class="ltx_table">
<div id="A2.T10.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:346.9pt;height:202.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-72.9pt,42.6pt) scale(0.704080775288864,0.704080775288864) ;">
<table id="A2.T10.3.3" class="ltx_tabular ltx_align_middle">
<tr id="A2.T10.3.3.4" class="ltx_tr" style="background-color:#DEDEDE;">
<td id="A2.T10.3.3.4.1" class="ltx_td ltx_align_center" colspan="2">
<span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span> <span id="A2.T10.3.3.4.1.1" class="ltx_text" style="background-color:#DEDEDE;">
   zero-shot</span>
</td>
<td id="A2.T10.3.3.4.2" class="ltx_td ltx_align_left ltx_border_r"><span id="A2.T10.3.3.4.2.1" class="ltx_text" style="background-color:#DEDEDE;">CLIP-zeroshot</span></td>
<td id="A2.T10.3.3.4.3" class="ltx_td ltx_align_center"><span id="A2.T10.3.3.4.3.1" class="ltx_text" style="background-color:#DEDEDE;">65.86</span></td>
<td id="A2.T10.3.3.4.4" class="ltx_td ltx_align_center"><span id="A2.T10.3.3.4.4.1" class="ltx_text" style="background-color:#DEDEDE;">40.50</span></td>
<td id="A2.T10.3.3.4.5" class="ltx_td ltx_align_center"><span id="A2.T10.3.3.4.5.1" class="ltx_text" style="background-color:#DEDEDE;">62.25</span></td>
<td id="A2.T10.3.3.4.6" class="ltx_td ltx_align_center"><span id="A2.T10.3.3.4.6.1" class="ltx_text" style="background-color:#DEDEDE;">13.36</span></td>
<td id="A2.T10.3.3.4.7" class="ltx_td ltx_align_center"><span id="A2.T10.3.3.4.7.1" class="ltx_text" style="background-color:#DEDEDE;">80.04</span></td>
<td id="A2.T10.3.3.4.8" class="ltx_td ltx_align_center ltx_border_r"><span id="A2.T10.3.3.4.8.1" class="ltx_text" style="background-color:#DEDEDE;">57.92</span></td>
<td id="A2.T10.3.3.4.9" class="ltx_td ltx_align_center ltx_border_r"><span id="A2.T10.3.3.4.9.1" class="ltx_text" style="background-color:#DEDEDE;">53.32</span></td>
<td id="A2.T10.3.3.4.10" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T10.3.3.4.10.1" class="ltx_text" style="background-color:#DEDEDE;">0M</span></td>
</tr>
<tr id="A2.T10.3.3.5" class="ltx_tr">
<td id="A2.T10.3.3.5.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="2"><span id="A2.T10.3.3.5.1.1" class="ltx_text">fully-trained</span></td>
<td id="A2.T10.3.3.5.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">ResNet-full</td>
<td id="A2.T10.3.3.5.3" class="ltx_td ltx_align_center ltx_border_t">71.74</td>
<td id="A2.T10.3.3.5.4" class="ltx_td ltx_align_center ltx_border_t">32.44</td>
<td id="A2.T10.3.3.5.5" class="ltx_td ltx_align_center ltx_border_t">59.58</td>
<td id="A2.T10.3.3.5.6" class="ltx_td ltx_align_center ltx_border_t">43.25</td>
<td id="A2.T10.3.3.5.7" class="ltx_td ltx_align_center ltx_border_t">74.73</td>
<td id="A2.T10.3.3.5.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">61.81</td>
<td id="A2.T10.3.3.5.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">57.26</td>
<td id="A2.T10.3.3.5.10" class="ltx_td ltx_align_center ltx_border_t">24.21M</td>
</tr>
<tr id="A2.T10.3.3.6" class="ltx_tr">
<td id="A2.T10.3.3.6.1" class="ltx_td ltx_align_left ltx_border_r">ViT-full</td>
<td id="A2.T10.3.3.6.2" class="ltx_td ltx_align_center">63.55</td>
<td id="A2.T10.3.3.6.3" class="ltx_td ltx_align_center">27.07</td>
<td id="A2.T10.3.3.6.4" class="ltx_td ltx_align_center">49.00</td>
<td id="A2.T10.3.3.6.5" class="ltx_td ltx_align_center">62.20</td>
<td id="A2.T10.3.3.6.6" class="ltx_td ltx_align_center">68.35</td>
<td id="A2.T10.3.3.6.7" class="ltx_td ltx_align_center ltx_border_r">54.05</td>
<td id="A2.T10.3.3.6.8" class="ltx_td ltx_align_center ltx_border_r">54.04</td>
<td id="A2.T10.3.3.6.9" class="ltx_td ltx_align_center">87.86M</td>
</tr>
<tr id="A2.T10.3.3.7" class="ltx_tr">
<td id="A2.T10.3.3.7.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="A2.T10.3.3.7.1.1" class="ltx_text">
<span id="A2.T10.3.3.7.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="A2.T10.3.3.7.1.1.1.1" class="ltx_tr">
<span id="A2.T10.3.3.7.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">fine-tune</span></span>
<span id="A2.T10.3.3.7.1.1.1.2" class="ltx_tr">
<span id="A2.T10.3.3.7.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">fc layer</span></span>
</span></span></td>
<td id="A2.T10.3.3.7.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">ResNet-tuning</td>
<td id="A2.T10.3.3.7.3" class="ltx_td ltx_align_center ltx_border_t">52.32</td>
<td id="A2.T10.3.3.7.4" class="ltx_td ltx_align_center ltx_border_t">20.85</td>
<td id="A2.T10.3.3.7.5" class="ltx_td ltx_align_center ltx_border_t">44.66</td>
<td id="A2.T10.3.3.7.6" class="ltx_td ltx_align_center ltx_border_t">7.13</td>
<td id="A2.T10.3.3.7.7" class="ltx_td ltx_align_center ltx_border_t">65.85</td>
<td id="A2.T10.3.3.7.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">38.33</td>
<td id="A2.T10.3.3.7.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">38.19</td>
<td id="A2.T10.3.3.7.10" class="ltx_td ltx_align_center ltx_border_t">0.71M</td>
</tr>
<tr id="A2.T10.3.3.8" class="ltx_tr">
<td id="A2.T10.3.3.8.1" class="ltx_td ltx_align_left ltx_border_r">ViT-tuning</td>
<td id="A2.T10.3.3.8.2" class="ltx_td ltx_align_center">71.93</td>
<td id="A2.T10.3.3.8.3" class="ltx_td ltx_align_center">48.39</td>
<td id="A2.T10.3.3.8.4" class="ltx_td ltx_align_center">68.06</td>
<td id="A2.T10.3.3.8.5" class="ltx_td ltx_align_center">21.24</td>
<td id="A2.T10.3.3.8.6" class="ltx_td ltx_align_center">80.43</td>
<td id="A2.T10.3.3.8.7" class="ltx_td ltx_align_center ltx_border_r">63.45</td>
<td id="A2.T10.3.3.8.8" class="ltx_td ltx_align_center ltx_border_r">58.92</td>
<td id="A2.T10.3.3.8.9" class="ltx_td ltx_align_center">0.18M</td>
</tr>
<tr id="A2.T10.3.3.9" class="ltx_tr">
<td id="A2.T10.3.3.9.1" class="ltx_td ltx_align_left ltx_border_r">CLIP-fc</td>
<td id="A2.T10.3.3.9.2" class="ltx_td ltx_align_center">74.53</td>
<td id="A2.T10.3.3.9.3" class="ltx_td ltx_align_center">48.00</td>
<td id="A2.T10.3.3.9.4" class="ltx_td ltx_align_center">69.08</td>
<td id="A2.T10.3.3.9.5" class="ltx_td ltx_align_center">31.84</td>
<td id="A2.T10.3.3.9.6" class="ltx_td ltx_align_center">83.87</td>
<td id="A2.T10.3.3.9.7" class="ltx_td ltx_align_center ltx_border_r">65.29</td>
<td id="A2.T10.3.3.9.8" class="ltx_td ltx_align_center ltx_border_r">62.10</td>
<td id="A2.T10.3.3.9.9" class="ltx_td ltx_align_center">0.26 M</td>
</tr>
<tr id="A2.T10.1.1.1" class="ltx_tr">
<td id="A2.T10.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="9"><span id="A2.T10.1.1.1.2.1" class="ltx_text">
<span id="A2.T10.1.1.1.2.1.1" class="ltx_tabular ltx_align_middle">
<span id="A2.T10.1.1.1.2.1.1.1" class="ltx_tr">
<span id="A2.T10.1.1.1.2.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">prompt</span></span>
<span id="A2.T10.1.1.1.2.1.1.2" class="ltx_tr">
<span id="A2.T10.1.1.1.2.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">tuning</span></span>
</span></span></td>
<td id="A2.T10.1.1.1.1" class="ltx_td ltx_align_center ltx_border_t" colspan="9"><math id="A2.T10.1.1.1.1.m1.1" class="ltx_Math" alttext="s_{p}=8" display="inline"><semantics id="A2.T10.1.1.1.1.m1.1a"><mrow id="A2.T10.1.1.1.1.m1.1.1" xref="A2.T10.1.1.1.1.m1.1.1.cmml"><msub id="A2.T10.1.1.1.1.m1.1.1.2" xref="A2.T10.1.1.1.1.m1.1.1.2.cmml"><mi id="A2.T10.1.1.1.1.m1.1.1.2.2" xref="A2.T10.1.1.1.1.m1.1.1.2.2.cmml">s</mi><mi id="A2.T10.1.1.1.1.m1.1.1.2.3" xref="A2.T10.1.1.1.1.m1.1.1.2.3.cmml">p</mi></msub><mo id="A2.T10.1.1.1.1.m1.1.1.1" xref="A2.T10.1.1.1.1.m1.1.1.1.cmml">=</mo><mn id="A2.T10.1.1.1.1.m1.1.1.3" xref="A2.T10.1.1.1.1.m1.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T10.1.1.1.1.m1.1b"><apply id="A2.T10.1.1.1.1.m1.1.1.cmml" xref="A2.T10.1.1.1.1.m1.1.1"><eq id="A2.T10.1.1.1.1.m1.1.1.1.cmml" xref="A2.T10.1.1.1.1.m1.1.1.1"></eq><apply id="A2.T10.1.1.1.1.m1.1.1.2.cmml" xref="A2.T10.1.1.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="A2.T10.1.1.1.1.m1.1.1.2.1.cmml" xref="A2.T10.1.1.1.1.m1.1.1.2">subscript</csymbol><ci id="A2.T10.1.1.1.1.m1.1.1.2.2.cmml" xref="A2.T10.1.1.1.1.m1.1.1.2.2">𝑠</ci><ci id="A2.T10.1.1.1.1.m1.1.1.2.3.cmml" xref="A2.T10.1.1.1.1.m1.1.1.2.3">𝑝</ci></apply><cn type="integer" id="A2.T10.1.1.1.1.m1.1.1.3.cmml" xref="A2.T10.1.1.1.1.m1.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T10.1.1.1.1.m1.1c">s_{p}=8</annotation></semantics></math></td>
</tr>
<tr id="A2.T10.3.3.10" class="ltx_tr">
<td id="A2.T10.3.3.10.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">PromptFL</td>
<td id="A2.T10.3.3.10.2" class="ltx_td ltx_align_center ltx_border_t">75.95</td>
<td id="A2.T10.3.3.10.3" class="ltx_td ltx_align_center ltx_border_t">49.60</td>
<td id="A2.T10.3.3.10.4" class="ltx_td ltx_align_center ltx_border_t">70.73</td>
<td id="A2.T10.3.3.10.5" class="ltx_td ltx_align_center ltx_border_t">31.06</td>
<td id="A2.T10.3.3.10.6" class="ltx_td ltx_align_center ltx_border_t">83.77</td>
<td id="A2.T10.3.3.10.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">67.12</td>
<td id="A2.T10.3.3.10.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">63.04</td>
<td id="A2.T10.3.3.10.9" class="ltx_td ltx_align_center ltx_border_t">1.413M</td>
</tr>
<tr id="A2.T10.3.3.11" class="ltx_tr">
<td id="A2.T10.3.3.11.1" class="ltx_td ltx_align_left ltx_border_r">FedAPT</td>
<td id="A2.T10.3.3.11.2" class="ltx_td ltx_align_center">77.28</td>
<td id="A2.T10.3.3.11.3" class="ltx_td ltx_align_center">52.07</td>
<td id="A2.T10.3.3.11.4" class="ltx_td ltx_align_center">72.45</td>
<td id="A2.T10.3.3.11.5" class="ltx_td ltx_align_center">47.31</td>
<td id="A2.T10.3.3.11.6" class="ltx_td ltx_align_center">84.76</td>
<td id="A2.T10.3.3.11.7" class="ltx_td ltx_align_center ltx_border_r">68.73</td>
<td id="A2.T10.3.3.11.8" class="ltx_td ltx_align_center ltx_border_r">67.10</td>
<td id="A2.T10.3.3.11.9" class="ltx_td ltx_align_center">1.416M</td>
</tr>
<tr id="A2.T10.2.2.2" class="ltx_tr">
<td id="A2.T10.2.2.2.1" class="ltx_td ltx_align_center ltx_border_t" colspan="9"><math id="A2.T10.2.2.2.1.m1.1" class="ltx_Math" alttext="s_{p}=16" display="inline"><semantics id="A2.T10.2.2.2.1.m1.1a"><mrow id="A2.T10.2.2.2.1.m1.1.1" xref="A2.T10.2.2.2.1.m1.1.1.cmml"><msub id="A2.T10.2.2.2.1.m1.1.1.2" xref="A2.T10.2.2.2.1.m1.1.1.2.cmml"><mi id="A2.T10.2.2.2.1.m1.1.1.2.2" xref="A2.T10.2.2.2.1.m1.1.1.2.2.cmml">s</mi><mi id="A2.T10.2.2.2.1.m1.1.1.2.3" xref="A2.T10.2.2.2.1.m1.1.1.2.3.cmml">p</mi></msub><mo id="A2.T10.2.2.2.1.m1.1.1.1" xref="A2.T10.2.2.2.1.m1.1.1.1.cmml">=</mo><mn id="A2.T10.2.2.2.1.m1.1.1.3" xref="A2.T10.2.2.2.1.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T10.2.2.2.1.m1.1b"><apply id="A2.T10.2.2.2.1.m1.1.1.cmml" xref="A2.T10.2.2.2.1.m1.1.1"><eq id="A2.T10.2.2.2.1.m1.1.1.1.cmml" xref="A2.T10.2.2.2.1.m1.1.1.1"></eq><apply id="A2.T10.2.2.2.1.m1.1.1.2.cmml" xref="A2.T10.2.2.2.1.m1.1.1.2"><csymbol cd="ambiguous" id="A2.T10.2.2.2.1.m1.1.1.2.1.cmml" xref="A2.T10.2.2.2.1.m1.1.1.2">subscript</csymbol><ci id="A2.T10.2.2.2.1.m1.1.1.2.2.cmml" xref="A2.T10.2.2.2.1.m1.1.1.2.2">𝑠</ci><ci id="A2.T10.2.2.2.1.m1.1.1.2.3.cmml" xref="A2.T10.2.2.2.1.m1.1.1.2.3">𝑝</ci></apply><cn type="integer" id="A2.T10.2.2.2.1.m1.1.1.3.cmml" xref="A2.T10.2.2.2.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T10.2.2.2.1.m1.1c">s_{p}=16</annotation></semantics></math></td>
</tr>
<tr id="A2.T10.3.3.12" class="ltx_tr">
<td id="A2.T10.3.3.12.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">PromptFL</td>
<td id="A2.T10.3.3.12.2" class="ltx_td ltx_align_center ltx_border_t">75.84</td>
<td id="A2.T10.3.3.12.3" class="ltx_td ltx_align_center ltx_border_t">49.82</td>
<td id="A2.T10.3.3.12.4" class="ltx_td ltx_align_center ltx_border_t">70.81</td>
<td id="A2.T10.3.3.12.5" class="ltx_td ltx_align_center ltx_border_t">32.98</td>
<td id="A2.T10.3.3.12.6" class="ltx_td ltx_align_center ltx_border_t">83.55</td>
<td id="A2.T10.3.3.12.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">67.31</td>
<td id="A2.T10.3.3.12.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">63.39</td>
<td id="A2.T10.3.3.12.9" class="ltx_td ltx_align_center ltx_border_t">2.836M</td>
</tr>
<tr id="A2.T10.3.3.13" class="ltx_tr">
<td id="A2.T10.3.3.13.1" class="ltx_td ltx_align_left ltx_border_r">FedAPT</td>
<td id="A2.T10.3.3.13.2" class="ltx_td ltx_align_center">77.36</td>
<td id="A2.T10.3.3.13.3" class="ltx_td ltx_align_center">52.17</td>
<td id="A2.T10.3.3.13.4" class="ltx_td ltx_align_center">72.51</td>
<td id="A2.T10.3.3.13.5" class="ltx_td ltx_align_center">48.84</td>
<td id="A2.T10.3.3.13.6" class="ltx_td ltx_align_center">84.79</td>
<td id="A2.T10.3.3.13.7" class="ltx_td ltx_align_center ltx_border_r">68.69</td>
<td id="A2.T10.3.3.13.8" class="ltx_td ltx_align_center ltx_border_r">67.39</td>
<td id="A2.T10.3.3.13.9" class="ltx_td ltx_align_center">2.829M</td>
</tr>
<tr id="A2.T10.3.3.3" class="ltx_tr">
<td id="A2.T10.3.3.3.1" class="ltx_td ltx_align_center ltx_border_t" colspan="9"><math id="A2.T10.3.3.3.1.m1.1" class="ltx_Math" alttext="s_{p}=24" display="inline"><semantics id="A2.T10.3.3.3.1.m1.1a"><mrow id="A2.T10.3.3.3.1.m1.1.1" xref="A2.T10.3.3.3.1.m1.1.1.cmml"><msub id="A2.T10.3.3.3.1.m1.1.1.2" xref="A2.T10.3.3.3.1.m1.1.1.2.cmml"><mi id="A2.T10.3.3.3.1.m1.1.1.2.2" xref="A2.T10.3.3.3.1.m1.1.1.2.2.cmml">s</mi><mi id="A2.T10.3.3.3.1.m1.1.1.2.3" xref="A2.T10.3.3.3.1.m1.1.1.2.3.cmml">p</mi></msub><mo id="A2.T10.3.3.3.1.m1.1.1.1" xref="A2.T10.3.3.3.1.m1.1.1.1.cmml">=</mo><mn id="A2.T10.3.3.3.1.m1.1.1.3" xref="A2.T10.3.3.3.1.m1.1.1.3.cmml">24</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T10.3.3.3.1.m1.1b"><apply id="A2.T10.3.3.3.1.m1.1.1.cmml" xref="A2.T10.3.3.3.1.m1.1.1"><eq id="A2.T10.3.3.3.1.m1.1.1.1.cmml" xref="A2.T10.3.3.3.1.m1.1.1.1"></eq><apply id="A2.T10.3.3.3.1.m1.1.1.2.cmml" xref="A2.T10.3.3.3.1.m1.1.1.2"><csymbol cd="ambiguous" id="A2.T10.3.3.3.1.m1.1.1.2.1.cmml" xref="A2.T10.3.3.3.1.m1.1.1.2">subscript</csymbol><ci id="A2.T10.3.3.3.1.m1.1.1.2.2.cmml" xref="A2.T10.3.3.3.1.m1.1.1.2.2">𝑠</ci><ci id="A2.T10.3.3.3.1.m1.1.1.2.3.cmml" xref="A2.T10.3.3.3.1.m1.1.1.2.3">𝑝</ci></apply><cn type="integer" id="A2.T10.3.3.3.1.m1.1.1.3.cmml" xref="A2.T10.3.3.3.1.m1.1.1.3">24</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T10.3.3.3.1.m1.1c">s_{p}=24</annotation></semantics></math></td>
</tr>
<tr id="A2.T10.3.3.14" class="ltx_tr">
<td id="A2.T10.3.3.14.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">PromptFL</td>
<td id="A2.T10.3.3.14.2" class="ltx_td ltx_align_center ltx_border_t">76.11</td>
<td id="A2.T10.3.3.14.3" class="ltx_td ltx_align_center ltx_border_t">49.77</td>
<td id="A2.T10.3.3.14.4" class="ltx_td ltx_align_center ltx_border_t">70.62</td>
<td id="A2.T10.3.3.14.5" class="ltx_td ltx_align_center ltx_border_t">32.47</td>
<td id="A2.T10.3.3.14.6" class="ltx_td ltx_align_center ltx_border_t">83.46</td>
<td id="A2.T10.3.3.14.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">67.38</td>
<td id="A2.T10.3.3.14.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">63.30</td>
<td id="A2.T10.3.3.14.9" class="ltx_td ltx_align_center ltx_border_t">4.239M</td>
</tr>
<tr id="A2.T10.3.3.15" class="ltx_tr">
<td id="A2.T10.3.3.15.1" class="ltx_td ltx_align_left ltx_border_r">FedAPT</td>
<td id="A2.T10.3.3.15.2" class="ltx_td ltx_align_center">77.34</td>
<td id="A2.T10.3.3.15.3" class="ltx_td ltx_align_center">52.29</td>
<td id="A2.T10.3.3.15.4" class="ltx_td ltx_align_center">72.87</td>
<td id="A2.T10.3.3.15.5" class="ltx_td ltx_align_center">50.35</td>
<td id="A2.T10.3.3.15.6" class="ltx_td ltx_align_center">84.80</td>
<td id="A2.T10.3.3.15.7" class="ltx_td ltx_align_center ltx_border_r">68.54</td>
<td id="A2.T10.3.3.15.8" class="ltx_td ltx_align_center ltx_border_r"><span id="A2.T10.3.3.15.8.1" class="ltx_text ltx_font_bold">67.70</span></td>
<td id="A2.T10.3.3.15.9" class="ltx_td ltx_align_center">4.242M</td>
</tr>
<tr id="A2.T10.3.3.16" class="ltx_tr">
<td id="A2.T10.3.3.16.1" class="ltx_td ltx_align_center"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></td>
<td id="A2.T10.3.3.16.2" class="ltx_td"></td>
<td id="A2.T10.3.3.16.3" class="ltx_td"></td>
<td id="A2.T10.3.3.16.4" class="ltx_td"></td>
<td id="A2.T10.3.3.16.5" class="ltx_td"></td>
<td id="A2.T10.3.3.16.6" class="ltx_td"></td>
<td id="A2.T10.3.3.16.7" class="ltx_td"></td>
<td id="A2.T10.3.3.16.8" class="ltx_td"></td>
<td id="A2.T10.3.3.16.9" class="ltx_td"></td>
<td id="A2.T10.3.3.16.10" class="ltx_td"></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 10: </span>The performance of the global model. <math id="A2.T10.5.m1.1" class="ltx_Math" alttext="s_{p}" display="inline"><semantics id="A2.T10.5.m1.1b"><msub id="A2.T10.5.m1.1.1" xref="A2.T10.5.m1.1.1.cmml"><mi id="A2.T10.5.m1.1.1.2" xref="A2.T10.5.m1.1.1.2.cmml">s</mi><mi id="A2.T10.5.m1.1.1.3" xref="A2.T10.5.m1.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="A2.T10.5.m1.1c"><apply id="A2.T10.5.m1.1.1.cmml" xref="A2.T10.5.m1.1.1"><csymbol cd="ambiguous" id="A2.T10.5.m1.1.1.1.cmml" xref="A2.T10.5.m1.1.1">subscript</csymbol><ci id="A2.T10.5.m1.1.1.2.cmml" xref="A2.T10.5.m1.1.1.2">𝑠</ci><ci id="A2.T10.5.m1.1.1.3.cmml" xref="A2.T10.5.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T10.5.m1.1d">s_{p}</annotation></semantics></math> denotes the length of prompts. </figcaption>
</figure>
<figure id="A2.F6" class="ltx_figure"><img src="/html/2211.07864/assets/x6.png" id="A2.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="276" height="208" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>The adaptive network’s accuracy in classifying domains.</figcaption>
</figure>
</section>
<section id="A2.SS0.SSSx3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Influence of the length of prompts.</h4>

<div id="A2.SS0.SSSx3.p1" class="ltx_para">
<p id="A2.SS0.SSSx3.p1.2" class="ltx_p">In the main paper, we set the length of prompts to <math id="A2.SS0.SSSx3.p1.1.m1.1" class="ltx_Math" alttext="16" display="inline"><semantics id="A2.SS0.SSSx3.p1.1.m1.1a"><mn id="A2.SS0.SSSx3.p1.1.m1.1.1" xref="A2.SS0.SSSx3.p1.1.m1.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="A2.SS0.SSSx3.p1.1.m1.1b"><cn type="integer" id="A2.SS0.SSSx3.p1.1.m1.1.1.cmml" xref="A2.SS0.SSSx3.p1.1.m1.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSSx3.p1.1.m1.1c">16</annotation></semantics></math> for PromptFL and FedAPT. Here we show the performance of the global model obtained by using prompts of different lengths. From Table <a href="#A2.T10" title="Table 10 ‣ The improve of inference efﬁciency ‣ Appendix B Additional Experiments ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>, we can see that when the length of prompts increases, the performance of FedAPT will also increase, and FedAPT still outperforms all comparison methods. Furthermore, the performance of PromptFL is not improved with the increase of <math id="A2.SS0.SSSx3.p1.2.m2.1" class="ltx_Math" alttext="s_{p}" display="inline"><semantics id="A2.SS0.SSSx3.p1.2.m2.1a"><msub id="A2.SS0.SSSx3.p1.2.m2.1.1" xref="A2.SS0.SSSx3.p1.2.m2.1.1.cmml"><mi id="A2.SS0.SSSx3.p1.2.m2.1.1.2" xref="A2.SS0.SSSx3.p1.2.m2.1.1.2.cmml">s</mi><mi id="A2.SS0.SSSx3.p1.2.m2.1.1.3" xref="A2.SS0.SSSx3.p1.2.m2.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS0.SSSx3.p1.2.m2.1b"><apply id="A2.SS0.SSSx3.p1.2.m2.1.1.cmml" xref="A2.SS0.SSSx3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A2.SS0.SSSx3.p1.2.m2.1.1.1.cmml" xref="A2.SS0.SSSx3.p1.2.m2.1.1">subscript</csymbol><ci id="A2.SS0.SSSx3.p1.2.m2.1.1.2.cmml" xref="A2.SS0.SSSx3.p1.2.m2.1.1.2">𝑠</ci><ci id="A2.SS0.SSSx3.p1.2.m2.1.1.3.cmml" xref="A2.SS0.SSSx3.p1.2.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSSx3.p1.2.m2.1c">s_{p}</annotation></semantics></math>.</p>
</div>
</section>
<section id="A2.SS0.SSSx4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Performance of <math id="A2.SS0.SSSx4.1.m1.1" class="ltx_Math" alttext="\mathcal{Q}" display="inline"><semantics id="A2.SS0.SSSx4.1.m1.1b"><mi class="ltx_font_mathcaligraphic" id="A2.SS0.SSSx4.1.m1.1.1" xref="A2.SS0.SSSx4.1.m1.1.1.cmml">𝒬</mi><annotation-xml encoding="MathML-Content" id="A2.SS0.SSSx4.1.m1.1c"><ci id="A2.SS0.SSSx4.1.m1.1.1.cmml" xref="A2.SS0.SSSx4.1.m1.1.1">𝒬</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSSx4.1.m1.1d">\mathcal{Q}</annotation></semantics></math>.</h4>

<div id="A2.SS0.SSSx4.p1" class="ltx_para">
<p id="A2.SS0.SSSx4.p1.1" class="ltx_p">We take the test set of all domains as a whole, label the data according to the domain index, and test the classification accuracy of the adaptive network. The result is as shown in Figure <a href="#A2.F6" title="Figure 6 ‣ The improve of inference efﬁciency ‣ Appendix B Additional Experiments ‣ Federated Adaptive Prompt Tuning for Multi-domain Collaborative Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. The adaptive network can converge rapidly in the early communication period.</p>
</div>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2211.07862" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2211.07864" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2211.07864">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2211.07864" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2211.07865" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Mar 14 09:02:57 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
