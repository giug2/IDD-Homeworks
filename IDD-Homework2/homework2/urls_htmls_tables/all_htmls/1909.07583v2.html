<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1909.07583] Inverse Visual Question Answering with Multi-Level Attentions</title><meta property="og:description" content="Inverse Visual Question Answering (iVQA) is a contemporary task emerged from the need of improving visual and language understanding.
It tackles the challenging problem of generating a corresponding question for a give…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Inverse Visual Question Answering with Multi-Level Attentions">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Inverse Visual Question Answering with Multi-Level Attentions">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1909.07583">

<!--Generated on Mon Mar 11 17:08:52 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Inverse Visual Question Answering with Multi-Level Attentions </h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<span id="id1.1.id1" class="ltx_text ltx_font_bold">Yaser Alwattar</span> and  <span id="id2.2.id2" class="ltx_text ltx_font_bold">Yuhong Guo</span> 
<br class="ltx_break">School of Computer Science,
Carleton University, Canada 
<br class="ltx_break"><span id="id3.3.id3" class="ltx_text ltx_font_typewriter" style="font-size:90%;">yaseralwattar@cmail.carleton.ca, yuhong.guo@carleton.cca</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id4.id1" class="ltx_p">Inverse Visual Question Answering (iVQA) is a contemporary task emerged from the need of improving visual and language understanding.
It tackles the challenging problem of generating a corresponding question for a given image-answer pair.
In this paper, we propose a novel deep multi-level attention model to address
inverse visual question answering.
The proposed model generates regional visual and semantic features at the object level
and then enhances them with the answer cue by using attention mechanisms.
Two levels of multiple attentions are employed in the model,
including the dual attention at the partial question encoding step
and the dynamic attention at the question’s next word generation step.
We evaluate the proposed model on the VQA V1 dataset.
It demonstrates
state-of-the-art performance
in terms of multiple commonly used metrics.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Inverse Visual Question Answering (iVQA) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> is a new interesting problem
emerged in computer vision
after the great success of deep learning on the VQA task <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>.
iVQA can be viewed as an extension to
the standard task of Visual Question Generation (VQG) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>.
However, different from the VQG task,
which automatically generates general questions from given images,
iVQA restricts the question generation to be correspondent to a pair of image and answer.
It has been noticed that a VQA system could predict correct answers merely based
on the textual questions without considering the corresponding images <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>,
which indicates the limitation of VQA on image understanding.
By contrast, an answer phrase is typically much shorter than the question,
it is necessary to integrate both visual image understanding and language semantic understanding
to yield an effective iVQA system.
This makes iVQA more challenging than VQA as both image and answer,
as well as their complex interactions,
must be captured.
It provides a platform for enhancing machine visual and textual understandings.
Meanwhile iVQA systems
can be used as inexpensive tools to generate questions and create richer datasets for VQA.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">As a newly emerged task, iVQA has been studied in a few previous works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> since its introduction in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>.
The work in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> have tackled iVQA
by enhancing the answer cue with high-level semantic information
only at the initial step of question generation.
The question generation model then dynamically attends to important parts of a given image
based on the current generation state and the answer cue.
The follow-up work in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> further uses
variational autoencoders to enhance question diversity of iVQA.
In these works,
the complex interaction and consistent alignment of the textual semantic features with
useful object level visual features, which are important for
effective attentions, however remain unexplored.
The potential selection of regions that are not informative or aligned with objects
may negatively affect the question generation.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In this paper, we propose a novel multi-level attention model to address inverse visual question answering.
The proposed model induces consistent regional textual and visual feature alignment with the answer cues
via attention mechanisms.
It extends a bottom-up attention model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> to extract visual features
at the level of objects and salient regions, as well as generate object and attribute labels,
i.e., semantic features (or textual features).
Different from previous iVQA models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> that
simply integrate the answer and high-level semantic concepts
to provide an initial glimpse for the partial question encoder,
we deploy a dual guiding attention module to attend to
the relevant object-level parts of both visual features and semantic features
based on the answer cue for partial question encoding.
At the question generation level,
we first statically attend the concatenation of visual and semantic features
with the answer cue, and then deploy
a dynamic attention module to attend to important regions
for the next question word generation.
We expect such a multi-level attention based model is able to
generate visual informative and answer-consistent questions
by enforcing a correct alignment between the visual features
and textual answer cues and achieve better image and text understanding.
To validate the effectiveness of the proposed model,
we conduct experiments on the VQA V1 dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>.
The results show that our proposed model achieves the state-of-the-art performance
in terms of many benchmark metrics comparing with other competitors <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">iVQA is closely related to the tasks of image caption generation and visual question answering.
In this section, we provide a brief review over the related works and techniques for image caption generation,
visual question answering, and visual question generation.
<br class="ltx_break"></p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">Image Caption Generation.</span>
The standard CNN-RNN model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> is considered the base for most state-of-the-art image captioning models. It uses a convolutional neural network (CNN) for visual feature extraction and uses recurrent neural networks (<em id="S2.p2.1.2" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S2.p2.1.3" class="ltx_text"></span> LSTM) for caption generation. After the initial success of this simple model, Xu <em id="S2.p2.1.4" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.5" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> improved it by introducing a attention mechanism which helps the model to selectively focus on important parts of the image rather than consider its whole content. This powerful technique has inspired researchers to study different attention variants.
You <em id="S2.p2.1.6" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.7" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> presented a semantic based attention strategy that helps the model to attend to the important semantic concepts
of the input image.
Lu <em id="S2.p2.1.8" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.9" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> proposed a more intuitive attention mechanism, namely adaptive attention.
Their model enables the visual attention when there is a need to consider the visual cue
and disables it when the visual cue does not correspond to the currently generated word.
More recently, considerable improvements in image captioning have been
achieved by combining both bottom-up and top-down attentions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>.
The models developed for image captioning though are not directly applicable on other types of tasks
such as VQA, VQG, and iVQA,
the principles of the techniques can be adapted and generalized.
<br class="ltx_break"></p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Visual Question Answering.</span>
VQA is similar to iVQA in the way that both tasks should capture complex textual and visual interactions
and translate them into written words.
Unlike image captioning, the primary challenge of VQA is to extract multi-modal joint features that sufficiently express
relationships between the visual content and textual content.
To solve this problem, Zhou <em id="S2.p3.1.2" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p3.1.3" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> used the conventional concatenation method to combine textual and visual features.
The moderate results of this straightforward method urged researchers to find other advanced techniques.
One of such techniques is bilinear-pooling
which allows both visual and textual features to fully interact with each other.
However, the direct implementation of this method is computationally expensive
and hence not
applicable to the complex VQA task.
Many algorithms were then developed to reduce the number of parameters needed to perform the bilinear-pooling operation.
For example, the Multi-modal Low-rank Bilinear (MLB) pooling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>
decomposes the high dimensional weight tensor needed for the bilinear-pooling operation into three lower dimensional weight matrices which can easily fit into a GPU memory.
Another method,
Multi-modal Factorized Bilinear-pooling (MFB) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>
attempts to capture complex interactions by first expanding textual and visual features into a high-dimensional feature vector
and then
squeezing it into a low-dimensional feature vector.
MFB has demonstrated good performance for many state-of-the-art VQA models.
In this work we also exploit MFB to capture complex interactions between answer and image cues.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">Similar to image captioning, the attention mechanism also plays an important role in boosting VQA performance. Instead of considering the whole content of an image equally, the attention mechanism helps VQA models to focus on parts corresponding to the given question <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>.
Many visual attention variants, e.g.,
the Stacked attention <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> and Hierarchical co-attention <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>,
have been proposed for VQA.
Besides visual attention, semantic attention has also been explored;
Yu <em id="S2.p4.1.1" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p4.1.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> designed a multi-level visual-semantic attention model
that focuses on both important regions and semantic concepts corresponding to a given question.
Nevertheless, as previously discussed,
the rich semantic information contained in the questions could
make a VQA system produce the right answers without any
image visual understanding <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>,
which motivates the new task of iVQA.
<br class="ltx_break"></p>
</div>
<div id="S2.p5" class="ltx_para ltx_noindent">
<p id="S2.p5.1" class="ltx_p"><span id="S2.p5.1.1" class="ltx_text ltx_font_bold">Visual Question Generation.</span>
VQG is a new deep learning task that aims to build an artificial intelligence system that can recognize the content of an image and generate relevant questions. One of the first research works that focused on this
task was conducted by Mostafazadeh <em id="S2.p5.1.2" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p5.1.3" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> who repurposed the standard CNN-RNN model for the task of VQG.
Similar to that for image captioning, this model became the base for many advanced state-of-the-art VQA models.
To enhance question diversity, the model in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> leveraged DenseCap <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> to generate questions that are corresponding to the main objects in a given image.
Jain <em id="S2.p5.1.4" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p5.1.5" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> improved question diversity by integrating the vanilla variational autoencoder <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> into their model.
Nevertheless, the aforementioned models generate questions merely based on images.
Although this is very helpful for enhancing visual and linguistic understandings,
the generated questions may be too generic and
lack sufficient understanding of the given image.
By contrast, the iVQA task proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> is more challenging as an iVQA model requires precise understanding of a given image and
good reasoning to generate specific questions that are corresponding to an image-answer pair.
Two main approaches have been proposed for iVQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>.
In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, a powerful model is developed by incorporating two key components,
the semantic concepts that are used together with a given answer to provide an initial first glance for question generation,
and the dynamic attention that dynamically focuses on important parts of a given image while generating the question word by word.
In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, the authors leveraged a variational autoencoder to improve the capability of generating multiple corresponding questions.
After developing both VQA and VQG models, Li <em id="S2.p5.1.6" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p5.1.7" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> exploited the complementary relationship of the two tasks and proposed the first model that can work with both VQA and iVQA. This study constituted an important step to confirm the importance of iVQA in improving VQA.</p>
</div>
<figure id="S2.F1" class="ltx_figure"><img src="/html/1909.07583/assets/figures/mainModel.jpg" id="S2.F1.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="335" height="235" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S2.F1.3.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S2.F1.4.2" class="ltx_text" style="font-size:90%;">The proposed multi-level attention iVQA model.
The model consists of the following components:
(1) GRU-based answer encoder, which encodes the answer phrase into the semantic embedding space.
(2) Faster R-CNN based image encoder, which produces visual and semantic features
at the object and salient regions.
(3) Dual guiding attention, which produces answer attended visual and semantic features.
(4) Multi-modal feature fusion (MFB), which fuses the answer cue with the visual and semantic features.
(5) Two-layer GRU model, which recurrently generates the sequence of question words with a dynamic attention mechanism.
</span></figcaption>
</figure>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Approach</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.3" class="ltx_p">Given an image <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">I</annotation></semantics></math> and an answer phrase <math id="S3.p1.2.m2.3" class="ltx_Math" alttext="A=[w_{1},\cdots,w_{m}]" display="inline"><semantics id="S3.p1.2.m2.3a"><mrow id="S3.p1.2.m2.3.3" xref="S3.p1.2.m2.3.3.cmml"><mi id="S3.p1.2.m2.3.3.4" xref="S3.p1.2.m2.3.3.4.cmml">A</mi><mo id="S3.p1.2.m2.3.3.3" xref="S3.p1.2.m2.3.3.3.cmml">=</mo><mrow id="S3.p1.2.m2.3.3.2.2" xref="S3.p1.2.m2.3.3.2.3.cmml"><mo stretchy="false" id="S3.p1.2.m2.3.3.2.2.3" xref="S3.p1.2.m2.3.3.2.3.cmml">[</mo><msub id="S3.p1.2.m2.2.2.1.1.1" xref="S3.p1.2.m2.2.2.1.1.1.cmml"><mi id="S3.p1.2.m2.2.2.1.1.1.2" xref="S3.p1.2.m2.2.2.1.1.1.2.cmml">w</mi><mn id="S3.p1.2.m2.2.2.1.1.1.3" xref="S3.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.p1.2.m2.3.3.2.2.4" xref="S3.p1.2.m2.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">⋯</mi><mo id="S3.p1.2.m2.3.3.2.2.5" xref="S3.p1.2.m2.3.3.2.3.cmml">,</mo><msub id="S3.p1.2.m2.3.3.2.2.2" xref="S3.p1.2.m2.3.3.2.2.2.cmml"><mi id="S3.p1.2.m2.3.3.2.2.2.2" xref="S3.p1.2.m2.3.3.2.2.2.2.cmml">w</mi><mi id="S3.p1.2.m2.3.3.2.2.2.3" xref="S3.p1.2.m2.3.3.2.2.2.3.cmml">m</mi></msub><mo stretchy="false" id="S3.p1.2.m2.3.3.2.2.6" xref="S3.p1.2.m2.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.3b"><apply id="S3.p1.2.m2.3.3.cmml" xref="S3.p1.2.m2.3.3"><eq id="S3.p1.2.m2.3.3.3.cmml" xref="S3.p1.2.m2.3.3.3"></eq><ci id="S3.p1.2.m2.3.3.4.cmml" xref="S3.p1.2.m2.3.3.4">𝐴</ci><list id="S3.p1.2.m2.3.3.2.3.cmml" xref="S3.p1.2.m2.3.3.2.2"><apply id="S3.p1.2.m2.2.2.1.1.1.cmml" xref="S3.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.p1.2.m2.2.2.1.1.1.2">𝑤</ci><cn type="integer" id="S3.p1.2.m2.2.2.1.1.1.3.cmml" xref="S3.p1.2.m2.2.2.1.1.1.3">1</cn></apply><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">⋯</ci><apply id="S3.p1.2.m2.3.3.2.2.2.cmml" xref="S3.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.p1.2.m2.3.3.2.2.2.2">𝑤</ci><ci id="S3.p1.2.m2.3.3.2.2.2.3.cmml" xref="S3.p1.2.m2.3.3.2.2.2.3">𝑚</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.3c">A=[w_{1},\cdots,w_{m}]</annotation></semantics></math>,
inverse question answering (iVQA) generates a corresponding question
<math id="S3.p1.3.m3.3" class="ltx_Math" alttext="Q=[q_{1},...,q_{T}]" display="inline"><semantics id="S3.p1.3.m3.3a"><mrow id="S3.p1.3.m3.3.3" xref="S3.p1.3.m3.3.3.cmml"><mi id="S3.p1.3.m3.3.3.4" xref="S3.p1.3.m3.3.3.4.cmml">Q</mi><mo id="S3.p1.3.m3.3.3.3" xref="S3.p1.3.m3.3.3.3.cmml">=</mo><mrow id="S3.p1.3.m3.3.3.2.2" xref="S3.p1.3.m3.3.3.2.3.cmml"><mo stretchy="false" id="S3.p1.3.m3.3.3.2.2.3" xref="S3.p1.3.m3.3.3.2.3.cmml">[</mo><msub id="S3.p1.3.m3.2.2.1.1.1" xref="S3.p1.3.m3.2.2.1.1.1.cmml"><mi id="S3.p1.3.m3.2.2.1.1.1.2" xref="S3.p1.3.m3.2.2.1.1.1.2.cmml">q</mi><mn id="S3.p1.3.m3.2.2.1.1.1.3" xref="S3.p1.3.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.p1.3.m3.3.3.2.2.4" xref="S3.p1.3.m3.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">…</mi><mo id="S3.p1.3.m3.3.3.2.2.5" xref="S3.p1.3.m3.3.3.2.3.cmml">,</mo><msub id="S3.p1.3.m3.3.3.2.2.2" xref="S3.p1.3.m3.3.3.2.2.2.cmml"><mi id="S3.p1.3.m3.3.3.2.2.2.2" xref="S3.p1.3.m3.3.3.2.2.2.2.cmml">q</mi><mi id="S3.p1.3.m3.3.3.2.2.2.3" xref="S3.p1.3.m3.3.3.2.2.2.3.cmml">T</mi></msub><mo stretchy="false" id="S3.p1.3.m3.3.3.2.2.6" xref="S3.p1.3.m3.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.3b"><apply id="S3.p1.3.m3.3.3.cmml" xref="S3.p1.3.m3.3.3"><eq id="S3.p1.3.m3.3.3.3.cmml" xref="S3.p1.3.m3.3.3.3"></eq><ci id="S3.p1.3.m3.3.3.4.cmml" xref="S3.p1.3.m3.3.3.4">𝑄</ci><list id="S3.p1.3.m3.3.3.2.3.cmml" xref="S3.p1.3.m3.3.3.2.2"><apply id="S3.p1.3.m3.2.2.1.1.1.cmml" xref="S3.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p1.3.m3.2.2.1.1.1.1.cmml" xref="S3.p1.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.p1.3.m3.2.2.1.1.1.2.cmml" xref="S3.p1.3.m3.2.2.1.1.1.2">𝑞</ci><cn type="integer" id="S3.p1.3.m3.2.2.1.1.1.3.cmml" xref="S3.p1.3.m3.2.2.1.1.1.3">1</cn></apply><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">…</ci><apply id="S3.p1.3.m3.3.3.2.2.2.cmml" xref="S3.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p1.3.m3.3.3.2.2.2.1.cmml" xref="S3.p1.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S3.p1.3.m3.3.3.2.2.2.2.cmml" xref="S3.p1.3.m3.3.3.2.2.2.2">𝑞</ci><ci id="S3.p1.3.m3.3.3.2.2.2.3.cmml" xref="S3.p1.3.m3.3.3.2.2.2.3">𝑇</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.3c">Q=[q_{1},...,q_{T}]</annotation></semantics></math>
by maximizing the following conditional probability:</p>
<table id="S5.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1.m1.1" class="ltx_Math" alttext="\displaystyle Q^{\star}" display="inline"><semantics id="S3.Ex1.m1.1a"><msup id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.2" xref="S3.Ex1.m1.1.1.2.cmml">Q</mi><mo id="S3.Ex1.m1.1.1.3" xref="S3.Ex1.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.cmml" xref="S3.Ex1.m1.1.1">superscript</csymbol><ci id="S3.Ex1.m1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.2">𝑄</ci><ci id="S3.Ex1.m1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">\displaystyle Q^{\star}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex1.m2.4" class="ltx_Math" alttext="\displaystyle=\underset{Q}{\arg\max}\,P(Q|I,A;\Theta)" display="inline"><semantics id="S3.Ex1.m2.4a"><mrow id="S3.Ex1.m2.4.4" xref="S3.Ex1.m2.4.4.cmml"><mi id="S3.Ex1.m2.4.4.3" xref="S3.Ex1.m2.4.4.3.cmml"></mi><mo id="S3.Ex1.m2.4.4.2" xref="S3.Ex1.m2.4.4.2.cmml">=</mo><mrow id="S3.Ex1.m2.4.4.1" xref="S3.Ex1.m2.4.4.1.cmml"><munder accentunder="true" id="S3.Ex1.m2.4.4.1.3" xref="S3.Ex1.m2.4.4.1.3.cmml"><mrow id="S3.Ex1.m2.4.4.1.3.2" xref="S3.Ex1.m2.4.4.1.3.2.cmml"><mi id="S3.Ex1.m2.4.4.1.3.2.1" xref="S3.Ex1.m2.4.4.1.3.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.Ex1.m2.4.4.1.3.2a" xref="S3.Ex1.m2.4.4.1.3.2.cmml">⁡</mo><mi id="S3.Ex1.m2.4.4.1.3.2.2" xref="S3.Ex1.m2.4.4.1.3.2.2.cmml">max</mi></mrow><mo id="S3.Ex1.m2.4.4.1.3.1" xref="S3.Ex1.m2.4.4.1.3.1.cmml">𝑄</mo></munder><mo lspace="0.167em" rspace="0em" id="S3.Ex1.m2.4.4.1.2" xref="S3.Ex1.m2.4.4.1.2.cmml">​</mo><mi id="S3.Ex1.m2.4.4.1.4" xref="S3.Ex1.m2.4.4.1.4.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.4.4.1.2a" xref="S3.Ex1.m2.4.4.1.2.cmml">​</mo><mrow id="S3.Ex1.m2.4.4.1.1.1" xref="S3.Ex1.m2.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m2.4.4.1.1.1.2" xref="S3.Ex1.m2.4.4.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m2.4.4.1.1.1.1" xref="S3.Ex1.m2.4.4.1.1.1.1.cmml"><mi id="S3.Ex1.m2.4.4.1.1.1.1.2" xref="S3.Ex1.m2.4.4.1.1.1.1.2.cmml">Q</mi><mo fence="false" id="S3.Ex1.m2.4.4.1.1.1.1.1" xref="S3.Ex1.m2.4.4.1.1.1.1.1.cmml">|</mo><mrow id="S3.Ex1.m2.4.4.1.1.1.1.3.2" xref="S3.Ex1.m2.4.4.1.1.1.1.3.1.cmml"><mi id="S3.Ex1.m2.1.1" xref="S3.Ex1.m2.1.1.cmml">I</mi><mo id="S3.Ex1.m2.4.4.1.1.1.1.3.2.1" xref="S3.Ex1.m2.4.4.1.1.1.1.3.1.cmml">,</mo><mi id="S3.Ex1.m2.2.2" xref="S3.Ex1.m2.2.2.cmml">A</mi><mo id="S3.Ex1.m2.4.4.1.1.1.1.3.2.2" xref="S3.Ex1.m2.4.4.1.1.1.1.3.1.cmml">;</mo><mi mathvariant="normal" id="S3.Ex1.m2.3.3" xref="S3.Ex1.m2.3.3.cmml">Θ</mi></mrow></mrow><mo stretchy="false" id="S3.Ex1.m2.4.4.1.1.1.3" xref="S3.Ex1.m2.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m2.4b"><apply id="S3.Ex1.m2.4.4.cmml" xref="S3.Ex1.m2.4.4"><eq id="S3.Ex1.m2.4.4.2.cmml" xref="S3.Ex1.m2.4.4.2"></eq><csymbol cd="latexml" id="S3.Ex1.m2.4.4.3.cmml" xref="S3.Ex1.m2.4.4.3">absent</csymbol><apply id="S3.Ex1.m2.4.4.1.cmml" xref="S3.Ex1.m2.4.4.1"><times id="S3.Ex1.m2.4.4.1.2.cmml" xref="S3.Ex1.m2.4.4.1.2"></times><apply id="S3.Ex1.m2.4.4.1.3.cmml" xref="S3.Ex1.m2.4.4.1.3"><ci id="S3.Ex1.m2.4.4.1.3.1.cmml" xref="S3.Ex1.m2.4.4.1.3.1">𝑄</ci><apply id="S3.Ex1.m2.4.4.1.3.2.cmml" xref="S3.Ex1.m2.4.4.1.3.2"><arg id="S3.Ex1.m2.4.4.1.3.2.1.cmml" xref="S3.Ex1.m2.4.4.1.3.2.1"></arg><max id="S3.Ex1.m2.4.4.1.3.2.2.cmml" xref="S3.Ex1.m2.4.4.1.3.2.2"></max></apply></apply><ci id="S3.Ex1.m2.4.4.1.4.cmml" xref="S3.Ex1.m2.4.4.1.4">𝑃</ci><apply id="S3.Ex1.m2.4.4.1.1.1.1.cmml" xref="S3.Ex1.m2.4.4.1.1.1"><csymbol cd="latexml" id="S3.Ex1.m2.4.4.1.1.1.1.1.cmml" xref="S3.Ex1.m2.4.4.1.1.1.1.1">conditional</csymbol><ci id="S3.Ex1.m2.4.4.1.1.1.1.2.cmml" xref="S3.Ex1.m2.4.4.1.1.1.1.2">𝑄</ci><list id="S3.Ex1.m2.4.4.1.1.1.1.3.1.cmml" xref="S3.Ex1.m2.4.4.1.1.1.1.3.2"><ci id="S3.Ex1.m2.1.1.cmml" xref="S3.Ex1.m2.1.1">𝐼</ci><ci id="S3.Ex1.m2.2.2.cmml" xref="S3.Ex1.m2.2.2">𝐴</ci><ci id="S3.Ex1.m2.3.3.cmml" xref="S3.Ex1.m2.3.3">Θ</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m2.4c">\displaystyle=\underset{Q}{\arg\max}\,P(Q|I,A;\Theta)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E1.m1.5" class="ltx_Math" alttext="\displaystyle=\underset{Q}{\arg\max}\prod_{t}P(q_{t}|q_{1},\cdots,q_{t-1},I,A;\Theta)" display="inline"><semantics id="S3.E1.m1.5a"><mrow id="S3.E1.m1.5.5" xref="S3.E1.m1.5.5.cmml"><mi id="S3.E1.m1.5.5.3" xref="S3.E1.m1.5.5.3.cmml"></mi><mo id="S3.E1.m1.5.5.2" xref="S3.E1.m1.5.5.2.cmml">=</mo><mrow id="S3.E1.m1.5.5.1" xref="S3.E1.m1.5.5.1.cmml"><munder accentunder="true" id="S3.E1.m1.5.5.1.3" xref="S3.E1.m1.5.5.1.3.cmml"><mrow id="S3.E1.m1.5.5.1.3.2" xref="S3.E1.m1.5.5.1.3.2.cmml"><mi id="S3.E1.m1.5.5.1.3.2.1" xref="S3.E1.m1.5.5.1.3.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E1.m1.5.5.1.3.2a" xref="S3.E1.m1.5.5.1.3.2.cmml">⁡</mo><mi id="S3.E1.m1.5.5.1.3.2.2" xref="S3.E1.m1.5.5.1.3.2.2.cmml">max</mi></mrow><mo id="S3.E1.m1.5.5.1.3.1" xref="S3.E1.m1.5.5.1.3.1.cmml">𝑄</mo></munder><mo lspace="0.167em" rspace="0em" id="S3.E1.m1.5.5.1.2" xref="S3.E1.m1.5.5.1.2.cmml">​</mo><mrow id="S3.E1.m1.5.5.1.1" xref="S3.E1.m1.5.5.1.1.cmml"><mstyle displaystyle="true" id="S3.E1.m1.5.5.1.1.2" xref="S3.E1.m1.5.5.1.1.2.cmml"><munder id="S3.E1.m1.5.5.1.1.2a" xref="S3.E1.m1.5.5.1.1.2.cmml"><mo movablelimits="false" id="S3.E1.m1.5.5.1.1.2.2" xref="S3.E1.m1.5.5.1.1.2.2.cmml">∏</mo><mi id="S3.E1.m1.5.5.1.1.2.3" xref="S3.E1.m1.5.5.1.1.2.3.cmml">t</mi></munder></mstyle><mrow id="S3.E1.m1.5.5.1.1.1" xref="S3.E1.m1.5.5.1.1.1.cmml"><mi id="S3.E1.m1.5.5.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.5.5.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.5.5.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.5.5.1.1.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.5.5.1.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.5.5.1.1.1.1.1.1.4" xref="S3.E1.m1.5.5.1.1.1.1.1.1.4.cmml"><mi id="S3.E1.m1.5.5.1.1.1.1.1.1.4.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.4.2.cmml">q</mi><mi id="S3.E1.m1.5.5.1.1.1.1.1.1.4.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.4.3.cmml">t</mi></msub><mo fence="false" id="S3.E1.m1.5.5.1.1.1.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S3.E1.m1.5.5.1.1.1.1.1.1.2.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2.3.cmml"><msub id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">q</mi><mn id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">⋯</mi><mo id="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.4" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.2.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.2.2.cmml">q</mi><mrow id="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.2.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.2.3.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.2.3.2.cmml">t</mi><mo id="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.2.3.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.2.3.1.cmml">−</mo><mn id="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.2.3.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.5" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2.3.cmml">,</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">I</mi><mo id="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.6" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2.3.cmml">,</mo><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">A</mi><mo id="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.7" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2.3.cmml">;</mo><mi mathvariant="normal" id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml">Θ</mi></mrow></mrow><mo stretchy="false" id="S3.E1.m1.5.5.1.1.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.5b"><apply id="S3.E1.m1.5.5.cmml" xref="S3.E1.m1.5.5"><eq id="S3.E1.m1.5.5.2.cmml" xref="S3.E1.m1.5.5.2"></eq><csymbol cd="latexml" id="S3.E1.m1.5.5.3.cmml" xref="S3.E1.m1.5.5.3">absent</csymbol><apply id="S3.E1.m1.5.5.1.cmml" xref="S3.E1.m1.5.5.1"><times id="S3.E1.m1.5.5.1.2.cmml" xref="S3.E1.m1.5.5.1.2"></times><apply id="S3.E1.m1.5.5.1.3.cmml" xref="S3.E1.m1.5.5.1.3"><ci id="S3.E1.m1.5.5.1.3.1.cmml" xref="S3.E1.m1.5.5.1.3.1">𝑄</ci><apply id="S3.E1.m1.5.5.1.3.2.cmml" xref="S3.E1.m1.5.5.1.3.2"><arg id="S3.E1.m1.5.5.1.3.2.1.cmml" xref="S3.E1.m1.5.5.1.3.2.1"></arg><max id="S3.E1.m1.5.5.1.3.2.2.cmml" xref="S3.E1.m1.5.5.1.3.2.2"></max></apply></apply><apply id="S3.E1.m1.5.5.1.1.cmml" xref="S3.E1.m1.5.5.1.1"><apply id="S3.E1.m1.5.5.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.2.1.cmml" xref="S3.E1.m1.5.5.1.1.2">subscript</csymbol><csymbol cd="latexml" id="S3.E1.m1.5.5.1.1.2.2.cmml" xref="S3.E1.m1.5.5.1.1.2.2">product</csymbol><ci id="S3.E1.m1.5.5.1.1.2.3.cmml" xref="S3.E1.m1.5.5.1.1.2.3">𝑡</ci></apply><apply id="S3.E1.m1.5.5.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1"><times id="S3.E1.m1.5.5.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.2"></times><ci id="S3.E1.m1.5.5.1.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.1.3">𝑃</ci><apply id="S3.E1.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.3">conditional</csymbol><apply id="S3.E1.m1.5.5.1.1.1.1.1.1.4.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.1.1.4.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.1.1.1.1.4.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.4.2">𝑞</ci><ci id="S3.E1.m1.5.5.1.1.1.1.1.1.4.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.4.3">𝑡</ci></apply><list id="S3.E1.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2.2"><apply id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.2">𝑞</ci><cn type="integer" id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">⋯</ci><apply id="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.2.2">𝑞</ci><apply id="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.2.3"><minus id="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.2.3.1"></minus><ci id="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.2.3.2">𝑡</ci><cn type="integer" id="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝐼</ci><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">𝐴</ci><ci id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4">Θ</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.5c">\displaystyle=\underset{Q}{\arg\max}\prod_{t}P(q_{t}|q_{1},\cdots,q_{t-1},I,A;\Theta)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.p1.4" class="ltx_p">where <math id="S3.p1.4.m1.1" class="ltx_Math" alttext="\Theta" display="inline"><semantics id="S3.p1.4.m1.1a"><mi mathvariant="normal" id="S3.p1.4.m1.1.1" xref="S3.p1.4.m1.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.4.m1.1b"><ci id="S3.p1.4.m1.1.1.cmml" xref="S3.p1.4.m1.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m1.1c">\Theta</annotation></semantics></math> denotes the model parameters.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>iVQA Model with Multi-Level Attentions</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">In this section, we present a novel multi-level attention model for inverse question answering.
The architecture of the proposed model
is illustrated in Figure <a href="#S2.F1" title="Figure 1 ‣ 2 Related Work ‣ Inverse Visual Question Answering with Multi-Level Attentions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">Comparing to previous iVQA methods, our proposed model has strengths in the following aspects:
(1) We encode the input image with
a Faster R-CNN module,
which generates both object level semantic labels (e.g., “brown horse”)
and associated regional visual features.
For iVQA, this image encoder
enables consistent alignment of the visual image features
and textual answer cue,
while providing a suitable foundation for regional selective attention mechanisms.
(2) We use a dual guiding attention
mechanism to attend the visual and semantic features based on the answer cue
for partial question encoding.
(3) We adopt the powerful
Multi-modal Factorized Bilinear-pooling (MFB) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>
method to capture complex interactions between image and answer features
and fuse them into answer-aware image representations for dynamic attention
and question decoding (next word generation).
Below we present the key component modules of the proposed iVQA model.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/1909.07583/assets/figures/bottomUpModel.jpg" id="S3.F2.1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="319" height="364" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.3.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S3.F2.4.2" class="ltx_text" style="font-size:90%;">
Illustration of the Faster R-CNN image encoder module.
The detected objects are illustrated in the bottom picture.
Each object is localized with a bounding box and annotated with attribute and object labels.
</span></figcaption>
</figure>
<section id="S3.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.1 </span>Semantic Answer Encoder</h4>

<div id="S3.SS1.SSS1.p1" class="ltx_para">
<p id="S3.SS1.SSS1.p1.3" class="ltx_p">Comparing to questions, answers are typically very short phrases such that <math id="S3.SS1.SSS1.p1.1.m1.3" class="ltx_Math" alttext="A=[w_{1},\cdots,w_{m}]" display="inline"><semantics id="S3.SS1.SSS1.p1.1.m1.3a"><mrow id="S3.SS1.SSS1.p1.1.m1.3.3" xref="S3.SS1.SSS1.p1.1.m1.3.3.cmml"><mi id="S3.SS1.SSS1.p1.1.m1.3.3.4" xref="S3.SS1.SSS1.p1.1.m1.3.3.4.cmml">A</mi><mo id="S3.SS1.SSS1.p1.1.m1.3.3.3" xref="S3.SS1.SSS1.p1.1.m1.3.3.3.cmml">=</mo><mrow id="S3.SS1.SSS1.p1.1.m1.3.3.2.2" xref="S3.SS1.SSS1.p1.1.m1.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p1.1.m1.3.3.2.2.3" xref="S3.SS1.SSS1.p1.1.m1.3.3.2.3.cmml">[</mo><msub id="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1" xref="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.2" xref="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.2.cmml">w</mi><mn id="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.3" xref="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.SSS1.p1.1.m1.3.3.2.2.4" xref="S3.SS1.SSS1.p1.1.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS1.p1.1.m1.1.1" xref="S3.SS1.SSS1.p1.1.m1.1.1.cmml">⋯</mi><mo id="S3.SS1.SSS1.p1.1.m1.3.3.2.2.5" xref="S3.SS1.SSS1.p1.1.m1.3.3.2.3.cmml">,</mo><msub id="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2" xref="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.2" xref="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.2.cmml">w</mi><mi id="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.3" xref="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.3.cmml">m</mi></msub><mo stretchy="false" id="S3.SS1.SSS1.p1.1.m1.3.3.2.2.6" xref="S3.SS1.SSS1.p1.1.m1.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.1.m1.3b"><apply id="S3.SS1.SSS1.p1.1.m1.3.3.cmml" xref="S3.SS1.SSS1.p1.1.m1.3.3"><eq id="S3.SS1.SSS1.p1.1.m1.3.3.3.cmml" xref="S3.SS1.SSS1.p1.1.m1.3.3.3"></eq><ci id="S3.SS1.SSS1.p1.1.m1.3.3.4.cmml" xref="S3.SS1.SSS1.p1.1.m1.3.3.4">𝐴</ci><list id="S3.SS1.SSS1.p1.1.m1.3.3.2.3.cmml" xref="S3.SS1.SSS1.p1.1.m1.3.3.2.2"><apply id="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.2">𝑤</ci><cn type="integer" id="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS1.SSS1.p1.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1">⋯</ci><apply id="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.2">𝑤</ci><ci id="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS1.SSS1.p1.1.m1.3.3.2.2.2.3">𝑚</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.1.m1.3c">A=[w_{1},\cdots,w_{m}]</annotation></semantics></math>.
Each word in the phrase has semantic meanings.
To produce a semantically informative encoding for an answer phrase,
we propose to exploit a natural language processing
technique, GloVe <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, to encode
each word into a 300-dimensional semantic embedding vector.
Moreover,
we use a recurrent neural network, Gated Recurrent Units (GRUs) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>,
to capture the dependencies between the sequence of words in an answer phrase
and use the hidden state output of the last GRU cell as the answer encoding vector,
<math id="S3.SS1.SSS1.p1.2.m2.1" class="ltx_Math" alttext="{\bf a}\in\mathbb{R}^{H}" display="inline"><semantics id="S3.SS1.SSS1.p1.2.m2.1a"><mrow id="S3.SS1.SSS1.p1.2.m2.1.1" xref="S3.SS1.SSS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.SSS1.p1.2.m2.1.1.2" xref="S3.SS1.SSS1.p1.2.m2.1.1.2.cmml">𝐚</mi><mo id="S3.SS1.SSS1.p1.2.m2.1.1.1" xref="S3.SS1.SSS1.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS1.p1.2.m2.1.1.3" xref="S3.SS1.SSS1.p1.2.m2.1.1.3.cmml"><mi id="S3.SS1.SSS1.p1.2.m2.1.1.3.2" xref="S3.SS1.SSS1.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.SSS1.p1.2.m2.1.1.3.3" xref="S3.SS1.SSS1.p1.2.m2.1.1.3.3.cmml">H</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.2.m2.1b"><apply id="S3.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1"><in id="S3.SS1.SSS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1.1"></in><ci id="S3.SS1.SSS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1.2">𝐚</ci><apply id="S3.SS1.SSS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.2.m2.1.1.3.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS1.p1.2.m2.1.1.3.2.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1.3.2">ℝ</ci><ci id="S3.SS1.SSS1.p1.2.m2.1.1.3.3.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1.3.3">𝐻</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.2.m2.1c">{\bf a}\in\mathbb{R}^{H}</annotation></semantics></math>, with <math id="S3.SS1.SSS1.p1.3.m3.1" class="ltx_Math" alttext="H=1280" display="inline"><semantics id="S3.SS1.SSS1.p1.3.m3.1a"><mrow id="S3.SS1.SSS1.p1.3.m3.1.1" xref="S3.SS1.SSS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.SSS1.p1.3.m3.1.1.2" xref="S3.SS1.SSS1.p1.3.m3.1.1.2.cmml">H</mi><mo id="S3.SS1.SSS1.p1.3.m3.1.1.1" xref="S3.SS1.SSS1.p1.3.m3.1.1.1.cmml">=</mo><mn id="S3.SS1.SSS1.p1.3.m3.1.1.3" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.cmml">1280</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.3.m3.1b"><apply id="S3.SS1.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1"><eq id="S3.SS1.SSS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.1"></eq><ci id="S3.SS1.SSS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.2">𝐻</ci><cn type="integer" id="S3.SS1.SSS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3">1280</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.3.m3.1c">H=1280</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.2 </span>Semantic and Visual Image Encoder</h4>

<div id="S3.SS1.SSS2.p1" class="ltx_para">
<p id="S3.SS1.SSS2.p1.1" class="ltx_p">Different from previous iVQA approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, which use visual features extracted from deep CNN models, <em id="S3.SS1.SSS2.p1.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S3.SS1.SSS2.p1.1.2" class="ltx_text"></span> ResNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>,
we adopt an object-based regional feature extraction model,
Faster R-CNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> (with ResNet101 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> pre-trained on ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>),
to perform image encoding.
Faster R-CNN has been used as a state-of-the-art tool for object detection in computer vision.
We use it to extract object-level visual features and associated object and attribute labels
from input images. The process is illustrated in Figure <a href="#S3.F2" title="Figure 2 ‣ 3.1 iVQA Model with Multi-Level Attentions ‣ 3 Approach ‣ Inverse Visual Question Answering with Multi-Level Attentions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
This encoding module has two main steps.
In the first step, the Faster R-CNN generates region proposals with their corresponding bounding boxes.
Specifically we first pass a given image into a residual network (ResNet101) to extract a spatial feature map,
which is then passed into a Region Proposal Network (RPN) to generate object proposals
with a sliding window.
For each window, there are multiple anchors
that consider different possibilities for a potential object location.
At each anchor, RPN uses binary classification to predict the potential of
the current anchor forming an object-of-interest.
Whenever RPN finds an object, it predicts a bounding box to localize this object.
In the second step, the shapes of the region proposals are unified by applying a region-Of-Interest (ROI) pooling layer.
The generated visual features are then passed to the final classification module,
which predicts objects and their corresponding attribute classes (<em id="S3.SS1.SSS2.p1.1.3" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S3.SS1.SSS2.p1.1.4" class="ltx_text"></span> “brown horse”),
while refining the corresponding boxes with regression.</p>
</div>
<div id="S3.SS1.SSS2.p2" class="ltx_para">
<p id="S3.SS1.SSS2.p2.7" class="ltx_p">The model is trained on the Visual Genome dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>.
For each image, we apply the encoder model to
extract visual features from the top <math id="S3.SS1.SSS2.p2.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.SSS2.p2.1.m1.1a"><mi id="S3.SS1.SSS2.p2.1.m1.1.1" xref="S3.SS1.SSS2.p2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.1.m1.1b"><ci id="S3.SS1.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.1.m1.1c">k</annotation></semantics></math> most probably predicted object regions
and obtain final visual features,
<math id="S3.SS1.SSS2.p2.2.m2.5" class="ltx_Math" alttext="V=\{{\bf v}_{i}\in\mathbb{R}^{2048}|i=1,\cdots,k\}" display="inline"><semantics id="S3.SS1.SSS2.p2.2.m2.5a"><mrow id="S3.SS1.SSS2.p2.2.m2.5.5" xref="S3.SS1.SSS2.p2.2.m2.5.5.cmml"><mi id="S3.SS1.SSS2.p2.2.m2.5.5.4" xref="S3.SS1.SSS2.p2.2.m2.5.5.4.cmml">V</mi><mo id="S3.SS1.SSS2.p2.2.m2.5.5.3" xref="S3.SS1.SSS2.p2.2.m2.5.5.3.cmml">=</mo><mrow id="S3.SS1.SSS2.p2.2.m2.5.5.2.2" xref="S3.SS1.SSS2.p2.2.m2.5.5.2.3.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p2.2.m2.5.5.2.2.3" xref="S3.SS1.SSS2.p2.2.m2.5.5.2.3.1.cmml">{</mo><mrow id="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1" xref="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.cmml"><msub id="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.2" xref="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.2.cmml"><mi id="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.2.2" xref="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.2.2.cmml">𝐯</mi><mi id="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.2.3" xref="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.1" xref="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.3" xref="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.3.cmml"><mi id="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.3.2" xref="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.3.2.cmml">ℝ</mi><mn id="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.3.3" xref="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.3.3.cmml">2048</mn></msup></mrow><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p2.2.m2.5.5.2.2.4" xref="S3.SS1.SSS2.p2.2.m2.5.5.2.3.1.cmml">|</mo><mrow id="S3.SS1.SSS2.p2.2.m2.5.5.2.2.2" xref="S3.SS1.SSS2.p2.2.m2.5.5.2.2.2.cmml"><mi id="S3.SS1.SSS2.p2.2.m2.5.5.2.2.2.2" xref="S3.SS1.SSS2.p2.2.m2.5.5.2.2.2.2.cmml">i</mi><mo id="S3.SS1.SSS2.p2.2.m2.5.5.2.2.2.1" xref="S3.SS1.SSS2.p2.2.m2.5.5.2.2.2.1.cmml">=</mo><mrow id="S3.SS1.SSS2.p2.2.m2.5.5.2.2.2.3.2" xref="S3.SS1.SSS2.p2.2.m2.5.5.2.2.2.3.1.cmml"><mn id="S3.SS1.SSS2.p2.2.m2.1.1" xref="S3.SS1.SSS2.p2.2.m2.1.1.cmml">1</mn><mo id="S3.SS1.SSS2.p2.2.m2.5.5.2.2.2.3.2.1" xref="S3.SS1.SSS2.p2.2.m2.5.5.2.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS2.p2.2.m2.2.2" xref="S3.SS1.SSS2.p2.2.m2.2.2.cmml">⋯</mi><mo id="S3.SS1.SSS2.p2.2.m2.5.5.2.2.2.3.2.2" xref="S3.SS1.SSS2.p2.2.m2.5.5.2.2.2.3.1.cmml">,</mo><mi id="S3.SS1.SSS2.p2.2.m2.3.3" xref="S3.SS1.SSS2.p2.2.m2.3.3.cmml">k</mi></mrow></mrow><mo stretchy="false" id="S3.SS1.SSS2.p2.2.m2.5.5.2.2.5" xref="S3.SS1.SSS2.p2.2.m2.5.5.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.2.m2.5b"><apply id="S3.SS1.SSS2.p2.2.m2.5.5.cmml" xref="S3.SS1.SSS2.p2.2.m2.5.5"><eq id="S3.SS1.SSS2.p2.2.m2.5.5.3.cmml" xref="S3.SS1.SSS2.p2.2.m2.5.5.3"></eq><ci id="S3.SS1.SSS2.p2.2.m2.5.5.4.cmml" xref="S3.SS1.SSS2.p2.2.m2.5.5.4">𝑉</ci><apply id="S3.SS1.SSS2.p2.2.m2.5.5.2.3.cmml" xref="S3.SS1.SSS2.p2.2.m2.5.5.2.2"><csymbol cd="latexml" id="S3.SS1.SSS2.p2.2.m2.5.5.2.3.1.cmml" xref="S3.SS1.SSS2.p2.2.m2.5.5.2.2.3">conditional-set</csymbol><apply id="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.cmml" xref="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1"><in id="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.1.cmml" xref="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.1"></in><apply id="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.2.cmml" xref="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.2.1.cmml" xref="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.2.2.cmml" xref="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.2.2">𝐯</ci><ci id="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.2.3.cmml" xref="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.3.cmml" xref="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.3.1.cmml" xref="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.3.2.cmml" xref="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.3.2">ℝ</ci><cn type="integer" id="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.3.3.cmml" xref="S3.SS1.SSS2.p2.2.m2.4.4.1.1.1.3.3">2048</cn></apply></apply><apply id="S3.SS1.SSS2.p2.2.m2.5.5.2.2.2.cmml" xref="S3.SS1.SSS2.p2.2.m2.5.5.2.2.2"><eq id="S3.SS1.SSS2.p2.2.m2.5.5.2.2.2.1.cmml" xref="S3.SS1.SSS2.p2.2.m2.5.5.2.2.2.1"></eq><ci id="S3.SS1.SSS2.p2.2.m2.5.5.2.2.2.2.cmml" xref="S3.SS1.SSS2.p2.2.m2.5.5.2.2.2.2">𝑖</ci><list id="S3.SS1.SSS2.p2.2.m2.5.5.2.2.2.3.1.cmml" xref="S3.SS1.SSS2.p2.2.m2.5.5.2.2.2.3.2"><cn type="integer" id="S3.SS1.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1">1</cn><ci id="S3.SS1.SSS2.p2.2.m2.2.2.cmml" xref="S3.SS1.SSS2.p2.2.m2.2.2">⋯</ci><ci id="S3.SS1.SSS2.p2.2.m2.3.3.cmml" xref="S3.SS1.SSS2.p2.2.m2.3.3">𝑘</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.2.m2.5c">V=\{{\bf v}_{i}\in\mathbb{R}^{2048}|i=1,\cdots,k\}</annotation></semantics></math>.
To enhance these visual features
with semantic information,
we use the predicted attribute label (e.g., “brown”) and object label (e.g., “horse”) on each of these regions.
Similar to the answer encoder, we encode each label into a 300-dimensional embedding vector with GloVe <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>.
This leads to k regional attribute embeddings, <math id="S3.SS1.SSS2.p2.3.m3.5" class="ltx_Math" alttext="B=\{{\bf b}_{i}\in\mathbb{R}^{300}|i=1,\cdots,k\}" display="inline"><semantics id="S3.SS1.SSS2.p2.3.m3.5a"><mrow id="S3.SS1.SSS2.p2.3.m3.5.5" xref="S3.SS1.SSS2.p2.3.m3.5.5.cmml"><mi id="S3.SS1.SSS2.p2.3.m3.5.5.4" xref="S3.SS1.SSS2.p2.3.m3.5.5.4.cmml">B</mi><mo id="S3.SS1.SSS2.p2.3.m3.5.5.3" xref="S3.SS1.SSS2.p2.3.m3.5.5.3.cmml">=</mo><mrow id="S3.SS1.SSS2.p2.3.m3.5.5.2.2" xref="S3.SS1.SSS2.p2.3.m3.5.5.2.3.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p2.3.m3.5.5.2.2.3" xref="S3.SS1.SSS2.p2.3.m3.5.5.2.3.1.cmml">{</mo><mrow id="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1" xref="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.cmml"><msub id="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.2" xref="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.2.cmml"><mi id="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.2.2" xref="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.2.2.cmml">𝐛</mi><mi id="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.2.3" xref="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.1" xref="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.3" xref="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.3.cmml"><mi id="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.3.2" xref="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.3.2.cmml">ℝ</mi><mn id="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.3.3" xref="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.3.3.cmml">300</mn></msup></mrow><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p2.3.m3.5.5.2.2.4" xref="S3.SS1.SSS2.p2.3.m3.5.5.2.3.1.cmml">|</mo><mrow id="S3.SS1.SSS2.p2.3.m3.5.5.2.2.2" xref="S3.SS1.SSS2.p2.3.m3.5.5.2.2.2.cmml"><mi id="S3.SS1.SSS2.p2.3.m3.5.5.2.2.2.2" xref="S3.SS1.SSS2.p2.3.m3.5.5.2.2.2.2.cmml">i</mi><mo id="S3.SS1.SSS2.p2.3.m3.5.5.2.2.2.1" xref="S3.SS1.SSS2.p2.3.m3.5.5.2.2.2.1.cmml">=</mo><mrow id="S3.SS1.SSS2.p2.3.m3.5.5.2.2.2.3.2" xref="S3.SS1.SSS2.p2.3.m3.5.5.2.2.2.3.1.cmml"><mn id="S3.SS1.SSS2.p2.3.m3.1.1" xref="S3.SS1.SSS2.p2.3.m3.1.1.cmml">1</mn><mo id="S3.SS1.SSS2.p2.3.m3.5.5.2.2.2.3.2.1" xref="S3.SS1.SSS2.p2.3.m3.5.5.2.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS2.p2.3.m3.2.2" xref="S3.SS1.SSS2.p2.3.m3.2.2.cmml">⋯</mi><mo id="S3.SS1.SSS2.p2.3.m3.5.5.2.2.2.3.2.2" xref="S3.SS1.SSS2.p2.3.m3.5.5.2.2.2.3.1.cmml">,</mo><mi id="S3.SS1.SSS2.p2.3.m3.3.3" xref="S3.SS1.SSS2.p2.3.m3.3.3.cmml">k</mi></mrow></mrow><mo stretchy="false" id="S3.SS1.SSS2.p2.3.m3.5.5.2.2.5" xref="S3.SS1.SSS2.p2.3.m3.5.5.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.3.m3.5b"><apply id="S3.SS1.SSS2.p2.3.m3.5.5.cmml" xref="S3.SS1.SSS2.p2.3.m3.5.5"><eq id="S3.SS1.SSS2.p2.3.m3.5.5.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.5.5.3"></eq><ci id="S3.SS1.SSS2.p2.3.m3.5.5.4.cmml" xref="S3.SS1.SSS2.p2.3.m3.5.5.4">𝐵</ci><apply id="S3.SS1.SSS2.p2.3.m3.5.5.2.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.5.5.2.2"><csymbol cd="latexml" id="S3.SS1.SSS2.p2.3.m3.5.5.2.3.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.5.5.2.2.3">conditional-set</csymbol><apply id="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1"><in id="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.1"></in><apply id="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.2.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.2.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.2.2">𝐛</ci><ci id="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.2.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.3.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.3.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.3.2">ℝ</ci><cn type="integer" id="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.3.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.4.4.1.1.1.3.3">300</cn></apply></apply><apply id="S3.SS1.SSS2.p2.3.m3.5.5.2.2.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.5.5.2.2.2"><eq id="S3.SS1.SSS2.p2.3.m3.5.5.2.2.2.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.5.5.2.2.2.1"></eq><ci id="S3.SS1.SSS2.p2.3.m3.5.5.2.2.2.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.5.5.2.2.2.2">𝑖</ci><list id="S3.SS1.SSS2.p2.3.m3.5.5.2.2.2.3.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.5.5.2.2.2.3.2"><cn type="integer" id="S3.SS1.SSS2.p2.3.m3.1.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.1.1">1</cn><ci id="S3.SS1.SSS2.p2.3.m3.2.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.2.2">⋯</ci><ci id="S3.SS1.SSS2.p2.3.m3.3.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.3.3">𝑘</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.3.m3.5c">B=\{{\bf b}_{i}\in\mathbb{R}^{300}|i=1,\cdots,k\}</annotation></semantics></math>,
and object label embeddings, <math id="S3.SS1.SSS2.p2.4.m4.5" class="ltx_Math" alttext="O=\{{\bf o}_{i}\in\mathbb{R}^{300}|i=1,\cdots,k\}" display="inline"><semantics id="S3.SS1.SSS2.p2.4.m4.5a"><mrow id="S3.SS1.SSS2.p2.4.m4.5.5" xref="S3.SS1.SSS2.p2.4.m4.5.5.cmml"><mi id="S3.SS1.SSS2.p2.4.m4.5.5.4" xref="S3.SS1.SSS2.p2.4.m4.5.5.4.cmml">O</mi><mo id="S3.SS1.SSS2.p2.4.m4.5.5.3" xref="S3.SS1.SSS2.p2.4.m4.5.5.3.cmml">=</mo><mrow id="S3.SS1.SSS2.p2.4.m4.5.5.2.2" xref="S3.SS1.SSS2.p2.4.m4.5.5.2.3.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p2.4.m4.5.5.2.2.3" xref="S3.SS1.SSS2.p2.4.m4.5.5.2.3.1.cmml">{</mo><mrow id="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1" xref="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.cmml"><msub id="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.2" xref="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.2.cmml"><mi id="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.2.2" xref="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.2.2.cmml">𝐨</mi><mi id="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.2.3" xref="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.1" xref="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.3" xref="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.3.cmml"><mi id="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.3.2" xref="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.3.2.cmml">ℝ</mi><mn id="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.3.3" xref="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.3.3.cmml">300</mn></msup></mrow><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p2.4.m4.5.5.2.2.4" xref="S3.SS1.SSS2.p2.4.m4.5.5.2.3.1.cmml">|</mo><mrow id="S3.SS1.SSS2.p2.4.m4.5.5.2.2.2" xref="S3.SS1.SSS2.p2.4.m4.5.5.2.2.2.cmml"><mi id="S3.SS1.SSS2.p2.4.m4.5.5.2.2.2.2" xref="S3.SS1.SSS2.p2.4.m4.5.5.2.2.2.2.cmml">i</mi><mo id="S3.SS1.SSS2.p2.4.m4.5.5.2.2.2.1" xref="S3.SS1.SSS2.p2.4.m4.5.5.2.2.2.1.cmml">=</mo><mrow id="S3.SS1.SSS2.p2.4.m4.5.5.2.2.2.3.2" xref="S3.SS1.SSS2.p2.4.m4.5.5.2.2.2.3.1.cmml"><mn id="S3.SS1.SSS2.p2.4.m4.1.1" xref="S3.SS1.SSS2.p2.4.m4.1.1.cmml">1</mn><mo id="S3.SS1.SSS2.p2.4.m4.5.5.2.2.2.3.2.1" xref="S3.SS1.SSS2.p2.4.m4.5.5.2.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS2.p2.4.m4.2.2" xref="S3.SS1.SSS2.p2.4.m4.2.2.cmml">⋯</mi><mo id="S3.SS1.SSS2.p2.4.m4.5.5.2.2.2.3.2.2" xref="S3.SS1.SSS2.p2.4.m4.5.5.2.2.2.3.1.cmml">,</mo><mi id="S3.SS1.SSS2.p2.4.m4.3.3" xref="S3.SS1.SSS2.p2.4.m4.3.3.cmml">k</mi></mrow></mrow><mo stretchy="false" id="S3.SS1.SSS2.p2.4.m4.5.5.2.2.5" xref="S3.SS1.SSS2.p2.4.m4.5.5.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.4.m4.5b"><apply id="S3.SS1.SSS2.p2.4.m4.5.5.cmml" xref="S3.SS1.SSS2.p2.4.m4.5.5"><eq id="S3.SS1.SSS2.p2.4.m4.5.5.3.cmml" xref="S3.SS1.SSS2.p2.4.m4.5.5.3"></eq><ci id="S3.SS1.SSS2.p2.4.m4.5.5.4.cmml" xref="S3.SS1.SSS2.p2.4.m4.5.5.4">𝑂</ci><apply id="S3.SS1.SSS2.p2.4.m4.5.5.2.3.cmml" xref="S3.SS1.SSS2.p2.4.m4.5.5.2.2"><csymbol cd="latexml" id="S3.SS1.SSS2.p2.4.m4.5.5.2.3.1.cmml" xref="S3.SS1.SSS2.p2.4.m4.5.5.2.2.3">conditional-set</csymbol><apply id="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.cmml" xref="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1"><in id="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.1.cmml" xref="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.1"></in><apply id="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.2.cmml" xref="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.2.1.cmml" xref="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.2.2.cmml" xref="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.2.2">𝐨</ci><ci id="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.2.3.cmml" xref="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.3.cmml" xref="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.3.1.cmml" xref="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.3.2.cmml" xref="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.3.2">ℝ</ci><cn type="integer" id="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.3.3.cmml" xref="S3.SS1.SSS2.p2.4.m4.4.4.1.1.1.3.3">300</cn></apply></apply><apply id="S3.SS1.SSS2.p2.4.m4.5.5.2.2.2.cmml" xref="S3.SS1.SSS2.p2.4.m4.5.5.2.2.2"><eq id="S3.SS1.SSS2.p2.4.m4.5.5.2.2.2.1.cmml" xref="S3.SS1.SSS2.p2.4.m4.5.5.2.2.2.1"></eq><ci id="S3.SS1.SSS2.p2.4.m4.5.5.2.2.2.2.cmml" xref="S3.SS1.SSS2.p2.4.m4.5.5.2.2.2.2">𝑖</ci><list id="S3.SS1.SSS2.p2.4.m4.5.5.2.2.2.3.1.cmml" xref="S3.SS1.SSS2.p2.4.m4.5.5.2.2.2.3.2"><cn type="integer" id="S3.SS1.SSS2.p2.4.m4.1.1.cmml" xref="S3.SS1.SSS2.p2.4.m4.1.1">1</cn><ci id="S3.SS1.SSS2.p2.4.m4.2.2.cmml" xref="S3.SS1.SSS2.p2.4.m4.2.2">⋯</ci><ci id="S3.SS1.SSS2.p2.4.m4.3.3.cmml" xref="S3.SS1.SSS2.p2.4.m4.3.3">𝑘</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.4.m4.5c">O=\{{\bf o}_{i}\in\mathbb{R}^{300}|i=1,\cdots,k\}</annotation></semantics></math>.
Together they form the textual semantic features,
<math id="S3.SS1.SSS2.p2.5.m5.5" class="ltx_Math" alttext="S=\{{\bf s}_{i}=[{\bf b}_{i};{\bf o}_{i}]|i=1,\cdots,k\}" display="inline"><semantics id="S3.SS1.SSS2.p2.5.m5.5a"><mrow id="S3.SS1.SSS2.p2.5.m5.5.5" xref="S3.SS1.SSS2.p2.5.m5.5.5.cmml"><mi id="S3.SS1.SSS2.p2.5.m5.5.5.4" xref="S3.SS1.SSS2.p2.5.m5.5.5.4.cmml">S</mi><mo id="S3.SS1.SSS2.p2.5.m5.5.5.3" xref="S3.SS1.SSS2.p2.5.m5.5.5.3.cmml">=</mo><mrow id="S3.SS1.SSS2.p2.5.m5.5.5.2.2" xref="S3.SS1.SSS2.p2.5.m5.5.5.2.3.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p2.5.m5.5.5.2.2.3" xref="S3.SS1.SSS2.p2.5.m5.5.5.2.3.1.cmml">{</mo><mrow id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.cmml"><msub id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.4" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.4.cmml"><mi id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.4.2" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.4.2.cmml">𝐬</mi><mi id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.4.3" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.4.3.cmml">i</mi></msub><mo id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.3" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.3.cmml">=</mo><mrow id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.2.2" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.2.2.3" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.2.3.cmml">[</mo><msub id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.1.1.1" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.1.1.1.2" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.1.1.1.2.cmml">𝐛</mi><mi id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.1.1.1.3" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.2.2.4" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.2.3.cmml">;</mo><msub id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.2.2.2" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.2.2.2.cmml"><mi id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.2.2.2.2" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.2.2.2.2.cmml">𝐨</mi><mi id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.2.2.2.3" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.2.2.5" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p2.5.m5.5.5.2.2.4" xref="S3.SS1.SSS2.p2.5.m5.5.5.2.3.1.cmml">|</mo><mrow id="S3.SS1.SSS2.p2.5.m5.5.5.2.2.2" xref="S3.SS1.SSS2.p2.5.m5.5.5.2.2.2.cmml"><mi id="S3.SS1.SSS2.p2.5.m5.5.5.2.2.2.2" xref="S3.SS1.SSS2.p2.5.m5.5.5.2.2.2.2.cmml">i</mi><mo id="S3.SS1.SSS2.p2.5.m5.5.5.2.2.2.1" xref="S3.SS1.SSS2.p2.5.m5.5.5.2.2.2.1.cmml">=</mo><mrow id="S3.SS1.SSS2.p2.5.m5.5.5.2.2.2.3.2" xref="S3.SS1.SSS2.p2.5.m5.5.5.2.2.2.3.1.cmml"><mn id="S3.SS1.SSS2.p2.5.m5.1.1" xref="S3.SS1.SSS2.p2.5.m5.1.1.cmml">1</mn><mo id="S3.SS1.SSS2.p2.5.m5.5.5.2.2.2.3.2.1" xref="S3.SS1.SSS2.p2.5.m5.5.5.2.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS2.p2.5.m5.2.2" xref="S3.SS1.SSS2.p2.5.m5.2.2.cmml">⋯</mi><mo id="S3.SS1.SSS2.p2.5.m5.5.5.2.2.2.3.2.2" xref="S3.SS1.SSS2.p2.5.m5.5.5.2.2.2.3.1.cmml">,</mo><mi id="S3.SS1.SSS2.p2.5.m5.3.3" xref="S3.SS1.SSS2.p2.5.m5.3.3.cmml">k</mi></mrow></mrow><mo stretchy="false" id="S3.SS1.SSS2.p2.5.m5.5.5.2.2.5" xref="S3.SS1.SSS2.p2.5.m5.5.5.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.5.m5.5b"><apply id="S3.SS1.SSS2.p2.5.m5.5.5.cmml" xref="S3.SS1.SSS2.p2.5.m5.5.5"><eq id="S3.SS1.SSS2.p2.5.m5.5.5.3.cmml" xref="S3.SS1.SSS2.p2.5.m5.5.5.3"></eq><ci id="S3.SS1.SSS2.p2.5.m5.5.5.4.cmml" xref="S3.SS1.SSS2.p2.5.m5.5.5.4">𝑆</ci><apply id="S3.SS1.SSS2.p2.5.m5.5.5.2.3.cmml" xref="S3.SS1.SSS2.p2.5.m5.5.5.2.2"><csymbol cd="latexml" id="S3.SS1.SSS2.p2.5.m5.5.5.2.3.1.cmml" xref="S3.SS1.SSS2.p2.5.m5.5.5.2.2.3">conditional-set</csymbol><apply id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.cmml" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1"><eq id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.3.cmml" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.3"></eq><apply id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.4.cmml" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.4.1.cmml" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.4">subscript</csymbol><ci id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.4.2.cmml" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.4.2">𝐬</ci><ci id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.4.3.cmml" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.4.3">𝑖</ci></apply><list id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.2.3.cmml" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.2.2"><apply id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.1.1.1.2">𝐛</ci><ci id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.2.2.2.cmml" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.2.2.2.1.cmml" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.2.2.2.2.cmml" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.2.2.2.2">𝐨</ci><ci id="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.2.2.2.3.cmml" xref="S3.SS1.SSS2.p2.5.m5.4.4.1.1.1.2.2.2.3">𝑖</ci></apply></list></apply><apply id="S3.SS1.SSS2.p2.5.m5.5.5.2.2.2.cmml" xref="S3.SS1.SSS2.p2.5.m5.5.5.2.2.2"><eq id="S3.SS1.SSS2.p2.5.m5.5.5.2.2.2.1.cmml" xref="S3.SS1.SSS2.p2.5.m5.5.5.2.2.2.1"></eq><ci id="S3.SS1.SSS2.p2.5.m5.5.5.2.2.2.2.cmml" xref="S3.SS1.SSS2.p2.5.m5.5.5.2.2.2.2">𝑖</ci><list id="S3.SS1.SSS2.p2.5.m5.5.5.2.2.2.3.1.cmml" xref="S3.SS1.SSS2.p2.5.m5.5.5.2.2.2.3.2"><cn type="integer" id="S3.SS1.SSS2.p2.5.m5.1.1.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1">1</cn><ci id="S3.SS1.SSS2.p2.5.m5.2.2.cmml" xref="S3.SS1.SSS2.p2.5.m5.2.2">⋯</ci><ci id="S3.SS1.SSS2.p2.5.m5.3.3.cmml" xref="S3.SS1.SSS2.p2.5.m5.3.3">𝑘</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.5.m5.5c">S=\{{\bf s}_{i}=[{\bf b}_{i};{\bf o}_{i}]|i=1,\cdots,k\}</annotation></semantics></math>,
in the same semantic space as the answer cue.
The visual and semantic features can also be concatenated to form
enhanced image representation <math id="S3.SS1.SSS2.p2.6.m6.1" class="ltx_Math" alttext="E_{v}" display="inline"><semantics id="S3.SS1.SSS2.p2.6.m6.1a"><msub id="S3.SS1.SSS2.p2.6.m6.1.1" xref="S3.SS1.SSS2.p2.6.m6.1.1.cmml"><mi id="S3.SS1.SSS2.p2.6.m6.1.1.2" xref="S3.SS1.SSS2.p2.6.m6.1.1.2.cmml">E</mi><mi id="S3.SS1.SSS2.p2.6.m6.1.1.3" xref="S3.SS1.SSS2.p2.6.m6.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.6.m6.1b"><apply id="S3.SS1.SSS2.p2.6.m6.1.1.cmml" xref="S3.SS1.SSS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.6.m6.1.1.1.cmml" xref="S3.SS1.SSS2.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p2.6.m6.1.1.2.cmml" xref="S3.SS1.SSS2.p2.6.m6.1.1.2">𝐸</ci><ci id="S3.SS1.SSS2.p2.6.m6.1.1.3.cmml" xref="S3.SS1.SSS2.p2.6.m6.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.6.m6.1c">E_{v}</annotation></semantics></math>, such that
<math id="S3.SS1.SSS2.p2.7.m7.5" class="ltx_Math" alttext="E_{v}=\{E_{vi}=[{\bf v}_{i};{\bf s}_{i}]|i=1,\cdots,k\}" display="inline"><semantics id="S3.SS1.SSS2.p2.7.m7.5a"><mrow id="S3.SS1.SSS2.p2.7.m7.5.5" xref="S3.SS1.SSS2.p2.7.m7.5.5.cmml"><msub id="S3.SS1.SSS2.p2.7.m7.5.5.4" xref="S3.SS1.SSS2.p2.7.m7.5.5.4.cmml"><mi id="S3.SS1.SSS2.p2.7.m7.5.5.4.2" xref="S3.SS1.SSS2.p2.7.m7.5.5.4.2.cmml">E</mi><mi id="S3.SS1.SSS2.p2.7.m7.5.5.4.3" xref="S3.SS1.SSS2.p2.7.m7.5.5.4.3.cmml">v</mi></msub><mo id="S3.SS1.SSS2.p2.7.m7.5.5.3" xref="S3.SS1.SSS2.p2.7.m7.5.5.3.cmml">=</mo><mrow id="S3.SS1.SSS2.p2.7.m7.5.5.2.2" xref="S3.SS1.SSS2.p2.7.m7.5.5.2.3.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p2.7.m7.5.5.2.2.3" xref="S3.SS1.SSS2.p2.7.m7.5.5.2.3.1.cmml">{</mo><mrow id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.cmml"><msub id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.4" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.4.cmml"><mi id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.4.2" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.4.2.cmml">E</mi><mrow id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.4.3" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.4.3.cmml"><mi id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.4.3.2" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.4.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.4.3.1" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.4.3.1.cmml">​</mo><mi id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.4.3.3" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.4.3.3.cmml">i</mi></mrow></msub><mo id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.3" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.3.cmml">=</mo><mrow id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.2.2" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.2.2.3" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.2.3.cmml">[</mo><msub id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.1.1.1" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.1.1.1.2" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.1.1.1.2.cmml">𝐯</mi><mi id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.1.1.1.3" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.2.2.4" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.2.3.cmml">;</mo><msub id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.2.2.2" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.2.2.2.cmml"><mi id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.2.2.2.2" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.2.2.2.2.cmml">𝐬</mi><mi id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.2.2.2.3" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.2.2.5" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p2.7.m7.5.5.2.2.4" xref="S3.SS1.SSS2.p2.7.m7.5.5.2.3.1.cmml">|</mo><mrow id="S3.SS1.SSS2.p2.7.m7.5.5.2.2.2" xref="S3.SS1.SSS2.p2.7.m7.5.5.2.2.2.cmml"><mi id="S3.SS1.SSS2.p2.7.m7.5.5.2.2.2.2" xref="S3.SS1.SSS2.p2.7.m7.5.5.2.2.2.2.cmml">i</mi><mo id="S3.SS1.SSS2.p2.7.m7.5.5.2.2.2.1" xref="S3.SS1.SSS2.p2.7.m7.5.5.2.2.2.1.cmml">=</mo><mrow id="S3.SS1.SSS2.p2.7.m7.5.5.2.2.2.3.2" xref="S3.SS1.SSS2.p2.7.m7.5.5.2.2.2.3.1.cmml"><mn id="S3.SS1.SSS2.p2.7.m7.1.1" xref="S3.SS1.SSS2.p2.7.m7.1.1.cmml">1</mn><mo id="S3.SS1.SSS2.p2.7.m7.5.5.2.2.2.3.2.1" xref="S3.SS1.SSS2.p2.7.m7.5.5.2.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS2.p2.7.m7.2.2" xref="S3.SS1.SSS2.p2.7.m7.2.2.cmml">⋯</mi><mo id="S3.SS1.SSS2.p2.7.m7.5.5.2.2.2.3.2.2" xref="S3.SS1.SSS2.p2.7.m7.5.5.2.2.2.3.1.cmml">,</mo><mi id="S3.SS1.SSS2.p2.7.m7.3.3" xref="S3.SS1.SSS2.p2.7.m7.3.3.cmml">k</mi></mrow></mrow><mo stretchy="false" id="S3.SS1.SSS2.p2.7.m7.5.5.2.2.5" xref="S3.SS1.SSS2.p2.7.m7.5.5.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.7.m7.5b"><apply id="S3.SS1.SSS2.p2.7.m7.5.5.cmml" xref="S3.SS1.SSS2.p2.7.m7.5.5"><eq id="S3.SS1.SSS2.p2.7.m7.5.5.3.cmml" xref="S3.SS1.SSS2.p2.7.m7.5.5.3"></eq><apply id="S3.SS1.SSS2.p2.7.m7.5.5.4.cmml" xref="S3.SS1.SSS2.p2.7.m7.5.5.4"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.7.m7.5.5.4.1.cmml" xref="S3.SS1.SSS2.p2.7.m7.5.5.4">subscript</csymbol><ci id="S3.SS1.SSS2.p2.7.m7.5.5.4.2.cmml" xref="S3.SS1.SSS2.p2.7.m7.5.5.4.2">𝐸</ci><ci id="S3.SS1.SSS2.p2.7.m7.5.5.4.3.cmml" xref="S3.SS1.SSS2.p2.7.m7.5.5.4.3">𝑣</ci></apply><apply id="S3.SS1.SSS2.p2.7.m7.5.5.2.3.cmml" xref="S3.SS1.SSS2.p2.7.m7.5.5.2.2"><csymbol cd="latexml" id="S3.SS1.SSS2.p2.7.m7.5.5.2.3.1.cmml" xref="S3.SS1.SSS2.p2.7.m7.5.5.2.2.3">conditional-set</csymbol><apply id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.cmml" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1"><eq id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.3.cmml" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.3"></eq><apply id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.4.cmml" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.4.1.cmml" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.4">subscript</csymbol><ci id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.4.2.cmml" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.4.2">𝐸</ci><apply id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.4.3.cmml" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.4.3"><times id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.4.3.1.cmml" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.4.3.1"></times><ci id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.4.3.2.cmml" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.4.3.2">𝑣</ci><ci id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.4.3.3.cmml" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.4.3.3">𝑖</ci></apply></apply><list id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.2.3.cmml" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.2.2"><apply id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.1.1.1.2">𝐯</ci><ci id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.2.2.2.cmml" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.2.2.2.1.cmml" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.2.2.2.2.cmml" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.2.2.2.2">𝐬</ci><ci id="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.2.2.2.3.cmml" xref="S3.SS1.SSS2.p2.7.m7.4.4.1.1.1.2.2.2.3">𝑖</ci></apply></list></apply><apply id="S3.SS1.SSS2.p2.7.m7.5.5.2.2.2.cmml" xref="S3.SS1.SSS2.p2.7.m7.5.5.2.2.2"><eq id="S3.SS1.SSS2.p2.7.m7.5.5.2.2.2.1.cmml" xref="S3.SS1.SSS2.p2.7.m7.5.5.2.2.2.1"></eq><ci id="S3.SS1.SSS2.p2.7.m7.5.5.2.2.2.2.cmml" xref="S3.SS1.SSS2.p2.7.m7.5.5.2.2.2.2">𝑖</ci><list id="S3.SS1.SSS2.p2.7.m7.5.5.2.2.2.3.1.cmml" xref="S3.SS1.SSS2.p2.7.m7.5.5.2.2.2.3.2"><cn type="integer" id="S3.SS1.SSS2.p2.7.m7.1.1.cmml" xref="S3.SS1.SSS2.p2.7.m7.1.1">1</cn><ci id="S3.SS1.SSS2.p2.7.m7.2.2.cmml" xref="S3.SS1.SSS2.p2.7.m7.2.2">⋯</ci><ci id="S3.SS1.SSS2.p2.7.m7.3.3.cmml" xref="S3.SS1.SSS2.p2.7.m7.3.3">𝑘</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.7.m7.5c">E_{v}=\{E_{vi}=[{\bf v}_{i};{\bf s}_{i}]|i=1,\cdots,k\}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.3 </span>Dual Guiding Attention</h4>

<div id="S3.SS1.SSS3.p1" class="ltx_para">
<p id="S3.SS1.SSS3.p1.1" class="ltx_p">Given the outputs of the answer encoder and image encoder, <math id="S3.SS1.SSS3.p1.1.m1.3" class="ltx_Math" alttext="\{{\bf a},V,S\}" display="inline"><semantics id="S3.SS1.SSS3.p1.1.m1.3a"><mrow id="S3.SS1.SSS3.p1.1.m1.3.4.2" xref="S3.SS1.SSS3.p1.1.m1.3.4.1.cmml"><mo stretchy="false" id="S3.SS1.SSS3.p1.1.m1.3.4.2.1" xref="S3.SS1.SSS3.p1.1.m1.3.4.1.cmml">{</mo><mi id="S3.SS1.SSS3.p1.1.m1.1.1" xref="S3.SS1.SSS3.p1.1.m1.1.1.cmml">𝐚</mi><mo id="S3.SS1.SSS3.p1.1.m1.3.4.2.2" xref="S3.SS1.SSS3.p1.1.m1.3.4.1.cmml">,</mo><mi id="S3.SS1.SSS3.p1.1.m1.2.2" xref="S3.SS1.SSS3.p1.1.m1.2.2.cmml">V</mi><mo id="S3.SS1.SSS3.p1.1.m1.3.4.2.3" xref="S3.SS1.SSS3.p1.1.m1.3.4.1.cmml">,</mo><mi id="S3.SS1.SSS3.p1.1.m1.3.3" xref="S3.SS1.SSS3.p1.1.m1.3.3.cmml">S</mi><mo stretchy="false" id="S3.SS1.SSS3.p1.1.m1.3.4.2.4" xref="S3.SS1.SSS3.p1.1.m1.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.1.m1.3b"><set id="S3.SS1.SSS3.p1.1.m1.3.4.1.cmml" xref="S3.SS1.SSS3.p1.1.m1.3.4.2"><ci id="S3.SS1.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS3.p1.1.m1.1.1">𝐚</ci><ci id="S3.SS1.SSS3.p1.1.m1.2.2.cmml" xref="S3.SS1.SSS3.p1.1.m1.2.2">𝑉</ci><ci id="S3.SS1.SSS3.p1.1.m1.3.3.cmml" xref="S3.SS1.SSS3.p1.1.m1.3.3">𝑆</ci></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.1.m1.3c">\{{\bf a},V,S\}</annotation></semantics></math>,
question generation is conducted by using a two-layer GRU model.
In order to provide the GRU model an initial idea about the
importance of the semantic and visual concepts based on the answer cue
and guide the question generation,
we use a dual guiding attention mechanism to
attend the visual and semantic representations in parallel. 
<br class="ltx_break"></p>
</div>
<div id="S3.SS1.SSS3.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.SSS3.p2.2" class="ltx_p"><span id="S3.SS1.SSS3.p2.2.1" class="ltx_text ltx_font_bold">Visual Attention.</span>
The visual attention <math id="S3.SS1.SSS3.p2.1.m1.1" class="ltx_Math" alttext="Att_{v}" display="inline"><semantics id="S3.SS1.SSS3.p2.1.m1.1a"><mrow id="S3.SS1.SSS3.p2.1.m1.1.1" xref="S3.SS1.SSS3.p2.1.m1.1.1.cmml"><mi id="S3.SS1.SSS3.p2.1.m1.1.1.2" xref="S3.SS1.SSS3.p2.1.m1.1.1.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.p2.1.m1.1.1.1" xref="S3.SS1.SSS3.p2.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS1.SSS3.p2.1.m1.1.1.3" xref="S3.SS1.SSS3.p2.1.m1.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.p2.1.m1.1.1.1a" xref="S3.SS1.SSS3.p2.1.m1.1.1.1.cmml">​</mo><msub id="S3.SS1.SSS3.p2.1.m1.1.1.4" xref="S3.SS1.SSS3.p2.1.m1.1.1.4.cmml"><mi id="S3.SS1.SSS3.p2.1.m1.1.1.4.2" xref="S3.SS1.SSS3.p2.1.m1.1.1.4.2.cmml">t</mi><mi id="S3.SS1.SSS3.p2.1.m1.1.1.4.3" xref="S3.SS1.SSS3.p2.1.m1.1.1.4.3.cmml">v</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.1.m1.1b"><apply id="S3.SS1.SSS3.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS3.p2.1.m1.1.1"><times id="S3.SS1.SSS3.p2.1.m1.1.1.1.cmml" xref="S3.SS1.SSS3.p2.1.m1.1.1.1"></times><ci id="S3.SS1.SSS3.p2.1.m1.1.1.2.cmml" xref="S3.SS1.SSS3.p2.1.m1.1.1.2">𝐴</ci><ci id="S3.SS1.SSS3.p2.1.m1.1.1.3.cmml" xref="S3.SS1.SSS3.p2.1.m1.1.1.3">𝑡</ci><apply id="S3.SS1.SSS3.p2.1.m1.1.1.4.cmml" xref="S3.SS1.SSS3.p2.1.m1.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.1.m1.1.1.4.1.cmml" xref="S3.SS1.SSS3.p2.1.m1.1.1.4">subscript</csymbol><ci id="S3.SS1.SSS3.p2.1.m1.1.1.4.2.cmml" xref="S3.SS1.SSS3.p2.1.m1.1.1.4.2">𝑡</ci><ci id="S3.SS1.SSS3.p2.1.m1.1.1.4.3.cmml" xref="S3.SS1.SSS3.p2.1.m1.1.1.4.3">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.1.m1.1c">Att_{v}</annotation></semantics></math> aims to attend to the most important objects in the image based on the answer cue.
The attention weight for each regional visual vector, <math id="S3.SS1.SSS3.p2.2.m2.1" class="ltx_Math" alttext="{\bf v}_{i}\in V" display="inline"><semantics id="S3.SS1.SSS3.p2.2.m2.1a"><mrow id="S3.SS1.SSS3.p2.2.m2.1.1" xref="S3.SS1.SSS3.p2.2.m2.1.1.cmml"><msub id="S3.SS1.SSS3.p2.2.m2.1.1.2" xref="S3.SS1.SSS3.p2.2.m2.1.1.2.cmml"><mi id="S3.SS1.SSS3.p2.2.m2.1.1.2.2" xref="S3.SS1.SSS3.p2.2.m2.1.1.2.2.cmml">𝐯</mi><mi id="S3.SS1.SSS3.p2.2.m2.1.1.2.3" xref="S3.SS1.SSS3.p2.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.SSS3.p2.2.m2.1.1.1" xref="S3.SS1.SSS3.p2.2.m2.1.1.1.cmml">∈</mo><mi id="S3.SS1.SSS3.p2.2.m2.1.1.3" xref="S3.SS1.SSS3.p2.2.m2.1.1.3.cmml">V</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.2.m2.1b"><apply id="S3.SS1.SSS3.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS3.p2.2.m2.1.1"><in id="S3.SS1.SSS3.p2.2.m2.1.1.1.cmml" xref="S3.SS1.SSS3.p2.2.m2.1.1.1"></in><apply id="S3.SS1.SSS3.p2.2.m2.1.1.2.cmml" xref="S3.SS1.SSS3.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.2.m2.1.1.2.1.cmml" xref="S3.SS1.SSS3.p2.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS3.p2.2.m2.1.1.2.2.cmml" xref="S3.SS1.SSS3.p2.2.m2.1.1.2.2">𝐯</ci><ci id="S3.SS1.SSS3.p2.2.m2.1.1.2.3.cmml" xref="S3.SS1.SSS3.p2.2.m2.1.1.2.3">𝑖</ci></apply><ci id="S3.SS1.SSS3.p2.2.m2.1.1.3.cmml" xref="S3.SS1.SSS3.p2.2.m2.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.2.m2.1c">{\bf v}_{i}\in V</annotation></semantics></math>, is computed as follows:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.7" class="ltx_Math" alttext="\alpha_{i,v}=W_{att,v}^{\top}(\tanh(U_{v}{\bf v}_{i}+{\bf b}_{v})\odot\tanh(U_{a}{\bf a}+{\bf b}_{a}))" display="block"><semantics id="S3.E2.m1.7a"><mrow id="S3.E2.m1.7.7" xref="S3.E2.m1.7.7.cmml"><msub id="S3.E2.m1.7.7.3" xref="S3.E2.m1.7.7.3.cmml"><mi id="S3.E2.m1.7.7.3.2" xref="S3.E2.m1.7.7.3.2.cmml">α</mi><mrow id="S3.E2.m1.2.2.2.4" xref="S3.E2.m1.2.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">i</mi><mo id="S3.E2.m1.2.2.2.4.1" xref="S3.E2.m1.2.2.2.3.cmml">,</mo><mi id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml">v</mi></mrow></msub><mo id="S3.E2.m1.7.7.2" xref="S3.E2.m1.7.7.2.cmml">=</mo><mrow id="S3.E2.m1.7.7.1" xref="S3.E2.m1.7.7.1.cmml"><msubsup id="S3.E2.m1.7.7.1.3" xref="S3.E2.m1.7.7.1.3.cmml"><mi id="S3.E2.m1.7.7.1.3.2.2" xref="S3.E2.m1.7.7.1.3.2.2.cmml">W</mi><mrow id="S3.E2.m1.4.4.2.2" xref="S3.E2.m1.4.4.2.3.cmml"><mrow id="S3.E2.m1.4.4.2.2.1" xref="S3.E2.m1.4.4.2.2.1.cmml"><mi id="S3.E2.m1.4.4.2.2.1.2" xref="S3.E2.m1.4.4.2.2.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.2.2.1.1" xref="S3.E2.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S3.E2.m1.4.4.2.2.1.3" xref="S3.E2.m1.4.4.2.2.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.2.2.1.1a" xref="S3.E2.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S3.E2.m1.4.4.2.2.1.4" xref="S3.E2.m1.4.4.2.2.1.4.cmml">t</mi></mrow><mo id="S3.E2.m1.4.4.2.2.2" xref="S3.E2.m1.4.4.2.3.cmml">,</mo><mi id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml">v</mi></mrow><mo id="S3.E2.m1.7.7.1.3.3" xref="S3.E2.m1.7.7.1.3.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="S3.E2.m1.7.7.1.2" xref="S3.E2.m1.7.7.1.2.cmml">​</mo><mrow id="S3.E2.m1.7.7.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.7.7.1.1.1.2" xref="S3.E2.m1.7.7.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.7.7.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.cmml"><mrow id="S3.E2.m1.7.7.1.1.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml">tanh</mi><mo id="S3.E2.m1.7.7.1.1.1.1.1.1a" xref="S3.E2.m1.7.7.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E2.m1.7.7.1.1.1.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.7.7.1.1.1.1.1.1.1.2" xref="S3.E2.m1.7.7.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.cmml">U</mi><mi id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.2.3.cmml">v</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.3.2.cmml">𝐯</mi><mi id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.3.3.cmml">i</mi></msub></mrow><mo id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3.2.cmml">𝐛</mi><mi id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3.3.cmml">v</mi></msub></mrow><mo rspace="0.055em" stretchy="false" id="S3.E2.m1.7.7.1.1.1.1.1.1.1.3" xref="S3.E2.m1.7.7.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S3.E2.m1.7.7.1.1.1.1.3" xref="S3.E2.m1.7.7.1.1.1.1.3.cmml">⊙</mo><mrow id="S3.E2.m1.7.7.1.1.1.1.2.1" xref="S3.E2.m1.7.7.1.1.1.1.2.2.cmml"><mi id="S3.E2.m1.6.6" xref="S3.E2.m1.6.6.cmml">tanh</mi><mo id="S3.E2.m1.7.7.1.1.1.1.2.1a" xref="S3.E2.m1.7.7.1.1.1.1.2.2.cmml">⁡</mo><mrow id="S3.E2.m1.7.7.1.1.1.1.2.1.1" xref="S3.E2.m1.7.7.1.1.1.1.2.2.cmml"><mo stretchy="false" id="S3.E2.m1.7.7.1.1.1.1.2.1.1.2" xref="S3.E2.m1.7.7.1.1.1.1.2.2.cmml">(</mo><mrow id="S3.E2.m1.7.7.1.1.1.1.2.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.cmml"><mrow id="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.2" xref="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.2.cmml"><msub id="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.2.2" xref="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.2.2.cmml"><mi id="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.2.2.2" xref="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.2.2.2.cmml">U</mi><mi id="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.2.2.3" xref="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.2.2.3.cmml">a</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.2.1" xref="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.2.1.cmml">​</mo><mi id="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.2.3" xref="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.2.3.cmml">𝐚</mi></mrow><mo id="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.1.cmml">+</mo><msub id="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.3" xref="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.3.cmml"><mi id="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.3.2" xref="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.3.2.cmml">𝐛</mi><mi id="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.3.3" xref="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.3.3.cmml">a</mi></msub></mrow><mo stretchy="false" id="S3.E2.m1.7.7.1.1.1.1.2.1.1.3" xref="S3.E2.m1.7.7.1.1.1.1.2.2.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E2.m1.7.7.1.1.1.3" xref="S3.E2.m1.7.7.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.7b"><apply id="S3.E2.m1.7.7.cmml" xref="S3.E2.m1.7.7"><eq id="S3.E2.m1.7.7.2.cmml" xref="S3.E2.m1.7.7.2"></eq><apply id="S3.E2.m1.7.7.3.cmml" xref="S3.E2.m1.7.7.3"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.3.1.cmml" xref="S3.E2.m1.7.7.3">subscript</csymbol><ci id="S3.E2.m1.7.7.3.2.cmml" xref="S3.E2.m1.7.7.3.2">𝛼</ci><list id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.4"><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑖</ci><ci id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2">𝑣</ci></list></apply><apply id="S3.E2.m1.7.7.1.cmml" xref="S3.E2.m1.7.7.1"><times id="S3.E2.m1.7.7.1.2.cmml" xref="S3.E2.m1.7.7.1.2"></times><apply id="S3.E2.m1.7.7.1.3.cmml" xref="S3.E2.m1.7.7.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.3.1.cmml" xref="S3.E2.m1.7.7.1.3">superscript</csymbol><apply id="S3.E2.m1.7.7.1.3.2.cmml" xref="S3.E2.m1.7.7.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.3.2.1.cmml" xref="S3.E2.m1.7.7.1.3">subscript</csymbol><ci id="S3.E2.m1.7.7.1.3.2.2.cmml" xref="S3.E2.m1.7.7.1.3.2.2">𝑊</ci><list id="S3.E2.m1.4.4.2.3.cmml" xref="S3.E2.m1.4.4.2.2"><apply id="S3.E2.m1.4.4.2.2.1.cmml" xref="S3.E2.m1.4.4.2.2.1"><times id="S3.E2.m1.4.4.2.2.1.1.cmml" xref="S3.E2.m1.4.4.2.2.1.1"></times><ci id="S3.E2.m1.4.4.2.2.1.2.cmml" xref="S3.E2.m1.4.4.2.2.1.2">𝑎</ci><ci id="S3.E2.m1.4.4.2.2.1.3.cmml" xref="S3.E2.m1.4.4.2.2.1.3">𝑡</ci><ci id="S3.E2.m1.4.4.2.2.1.4.cmml" xref="S3.E2.m1.4.4.2.2.1.4">𝑡</ci></apply><ci id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1.1">𝑣</ci></list></apply><csymbol cd="latexml" id="S3.E2.m1.7.7.1.3.3.cmml" xref="S3.E2.m1.7.7.1.3.3">top</csymbol></apply><apply id="S3.E2.m1.7.7.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.7.7.1.1.1.1.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.3">direct-product</csymbol><apply id="S3.E2.m1.7.7.1.1.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1"><tanh id="S3.E2.m1.5.5.cmml" xref="S3.E2.m1.5.5"></tanh><apply id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1"><plus id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2"><times id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.2.2">𝑈</ci><ci id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.2.3">𝑣</ci></apply><apply id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.3.2">𝐯</ci><ci id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3.2">𝐛</ci><ci id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3.3">𝑣</ci></apply></apply></apply><apply id="S3.E2.m1.7.7.1.1.1.1.2.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2.1"><tanh id="S3.E2.m1.6.6.cmml" xref="S3.E2.m1.6.6"></tanh><apply id="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2.1.1.1"><plus id="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.1"></plus><apply id="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.2"><times id="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.2.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.2.1"></times><apply id="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.2.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.2.2.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.2.2">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.2.2.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.2.2.2">𝑈</ci><ci id="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.2.2.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.2.2.3">𝑎</ci></apply><ci id="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.2.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.2.3">𝐚</ci></apply><apply id="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.3.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.3.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.3.2">𝐛</ci><ci id="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.3.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2.1.1.1.3.3">𝑎</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.7c">\alpha_{i,v}=W_{att,v}^{\top}(\tanh(U_{v}{\bf v}_{i}+{\bf b}_{v})\odot\tanh(U_{a}{\bf a}+{\bf b}_{a}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS3.p2.8" class="ltx_p">where <math id="S3.SS1.SSS3.p2.3.m1.2" class="ltx_Math" alttext="W_{att,v}\in\mathbb{R}^{N}" display="inline"><semantics id="S3.SS1.SSS3.p2.3.m1.2a"><mrow id="S3.SS1.SSS3.p2.3.m1.2.3" xref="S3.SS1.SSS3.p2.3.m1.2.3.cmml"><msub id="S3.SS1.SSS3.p2.3.m1.2.3.2" xref="S3.SS1.SSS3.p2.3.m1.2.3.2.cmml"><mi id="S3.SS1.SSS3.p2.3.m1.2.3.2.2" xref="S3.SS1.SSS3.p2.3.m1.2.3.2.2.cmml">W</mi><mrow id="S3.SS1.SSS3.p2.3.m1.2.2.2.2" xref="S3.SS1.SSS3.p2.3.m1.2.2.2.3.cmml"><mrow id="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1" xref="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.cmml"><mi id="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.2" xref="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.1" xref="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.3" xref="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.1a" xref="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.4" xref="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.4.cmml">t</mi></mrow><mo id="S3.SS1.SSS3.p2.3.m1.2.2.2.2.2" xref="S3.SS1.SSS3.p2.3.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS3.p2.3.m1.1.1.1.1" xref="S3.SS1.SSS3.p2.3.m1.1.1.1.1.cmml">v</mi></mrow></msub><mo id="S3.SS1.SSS3.p2.3.m1.2.3.1" xref="S3.SS1.SSS3.p2.3.m1.2.3.1.cmml">∈</mo><msup id="S3.SS1.SSS3.p2.3.m1.2.3.3" xref="S3.SS1.SSS3.p2.3.m1.2.3.3.cmml"><mi id="S3.SS1.SSS3.p2.3.m1.2.3.3.2" xref="S3.SS1.SSS3.p2.3.m1.2.3.3.2.cmml">ℝ</mi><mi id="S3.SS1.SSS3.p2.3.m1.2.3.3.3" xref="S3.SS1.SSS3.p2.3.m1.2.3.3.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.3.m1.2b"><apply id="S3.SS1.SSS3.p2.3.m1.2.3.cmml" xref="S3.SS1.SSS3.p2.3.m1.2.3"><in id="S3.SS1.SSS3.p2.3.m1.2.3.1.cmml" xref="S3.SS1.SSS3.p2.3.m1.2.3.1"></in><apply id="S3.SS1.SSS3.p2.3.m1.2.3.2.cmml" xref="S3.SS1.SSS3.p2.3.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.3.m1.2.3.2.1.cmml" xref="S3.SS1.SSS3.p2.3.m1.2.3.2">subscript</csymbol><ci id="S3.SS1.SSS3.p2.3.m1.2.3.2.2.cmml" xref="S3.SS1.SSS3.p2.3.m1.2.3.2.2">𝑊</ci><list id="S3.SS1.SSS3.p2.3.m1.2.2.2.3.cmml" xref="S3.SS1.SSS3.p2.3.m1.2.2.2.2"><apply id="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.cmml" xref="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1"><times id="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.1.cmml" xref="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.1"></times><ci id="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.2.cmml" xref="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.2">𝑎</ci><ci id="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.3.cmml" xref="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.3">𝑡</ci><ci id="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.4.cmml" xref="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.4">𝑡</ci></apply><ci id="S3.SS1.SSS3.p2.3.m1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p2.3.m1.1.1.1.1">𝑣</ci></list></apply><apply id="S3.SS1.SSS3.p2.3.m1.2.3.3.cmml" xref="S3.SS1.SSS3.p2.3.m1.2.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.3.m1.2.3.3.1.cmml" xref="S3.SS1.SSS3.p2.3.m1.2.3.3">superscript</csymbol><ci id="S3.SS1.SSS3.p2.3.m1.2.3.3.2.cmml" xref="S3.SS1.SSS3.p2.3.m1.2.3.3.2">ℝ</ci><ci id="S3.SS1.SSS3.p2.3.m1.2.3.3.3.cmml" xref="S3.SS1.SSS3.p2.3.m1.2.3.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.3.m1.2c">W_{att,v}\in\mathbb{R}^{N}</annotation></semantics></math>, <math id="S3.SS1.SSS3.p2.4.m2.1" class="ltx_Math" alttext="U_{v}\in\mathbb{R}^{N\times N_{v}}" display="inline"><semantics id="S3.SS1.SSS3.p2.4.m2.1a"><mrow id="S3.SS1.SSS3.p2.4.m2.1.1" xref="S3.SS1.SSS3.p2.4.m2.1.1.cmml"><msub id="S3.SS1.SSS3.p2.4.m2.1.1.2" xref="S3.SS1.SSS3.p2.4.m2.1.1.2.cmml"><mi id="S3.SS1.SSS3.p2.4.m2.1.1.2.2" xref="S3.SS1.SSS3.p2.4.m2.1.1.2.2.cmml">U</mi><mi id="S3.SS1.SSS3.p2.4.m2.1.1.2.3" xref="S3.SS1.SSS3.p2.4.m2.1.1.2.3.cmml">v</mi></msub><mo id="S3.SS1.SSS3.p2.4.m2.1.1.1" xref="S3.SS1.SSS3.p2.4.m2.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS3.p2.4.m2.1.1.3" xref="S3.SS1.SSS3.p2.4.m2.1.1.3.cmml"><mi id="S3.SS1.SSS3.p2.4.m2.1.1.3.2" xref="S3.SS1.SSS3.p2.4.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS3.p2.4.m2.1.1.3.3" xref="S3.SS1.SSS3.p2.4.m2.1.1.3.3.cmml"><mi id="S3.SS1.SSS3.p2.4.m2.1.1.3.3.2" xref="S3.SS1.SSS3.p2.4.m2.1.1.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS3.p2.4.m2.1.1.3.3.1" xref="S3.SS1.SSS3.p2.4.m2.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.SSS3.p2.4.m2.1.1.3.3.3" xref="S3.SS1.SSS3.p2.4.m2.1.1.3.3.3.cmml"><mi id="S3.SS1.SSS3.p2.4.m2.1.1.3.3.3.2" xref="S3.SS1.SSS3.p2.4.m2.1.1.3.3.3.2.cmml">N</mi><mi id="S3.SS1.SSS3.p2.4.m2.1.1.3.3.3.3" xref="S3.SS1.SSS3.p2.4.m2.1.1.3.3.3.3.cmml">v</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.4.m2.1b"><apply id="S3.SS1.SSS3.p2.4.m2.1.1.cmml" xref="S3.SS1.SSS3.p2.4.m2.1.1"><in id="S3.SS1.SSS3.p2.4.m2.1.1.1.cmml" xref="S3.SS1.SSS3.p2.4.m2.1.1.1"></in><apply id="S3.SS1.SSS3.p2.4.m2.1.1.2.cmml" xref="S3.SS1.SSS3.p2.4.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.4.m2.1.1.2.1.cmml" xref="S3.SS1.SSS3.p2.4.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS3.p2.4.m2.1.1.2.2.cmml" xref="S3.SS1.SSS3.p2.4.m2.1.1.2.2">𝑈</ci><ci id="S3.SS1.SSS3.p2.4.m2.1.1.2.3.cmml" xref="S3.SS1.SSS3.p2.4.m2.1.1.2.3">𝑣</ci></apply><apply id="S3.SS1.SSS3.p2.4.m2.1.1.3.cmml" xref="S3.SS1.SSS3.p2.4.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.4.m2.1.1.3.1.cmml" xref="S3.SS1.SSS3.p2.4.m2.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS3.p2.4.m2.1.1.3.2.cmml" xref="S3.SS1.SSS3.p2.4.m2.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS3.p2.4.m2.1.1.3.3.cmml" xref="S3.SS1.SSS3.p2.4.m2.1.1.3.3"><times id="S3.SS1.SSS3.p2.4.m2.1.1.3.3.1.cmml" xref="S3.SS1.SSS3.p2.4.m2.1.1.3.3.1"></times><ci id="S3.SS1.SSS3.p2.4.m2.1.1.3.3.2.cmml" xref="S3.SS1.SSS3.p2.4.m2.1.1.3.3.2">𝑁</ci><apply id="S3.SS1.SSS3.p2.4.m2.1.1.3.3.3.cmml" xref="S3.SS1.SSS3.p2.4.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.4.m2.1.1.3.3.3.1.cmml" xref="S3.SS1.SSS3.p2.4.m2.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.SSS3.p2.4.m2.1.1.3.3.3.2.cmml" xref="S3.SS1.SSS3.p2.4.m2.1.1.3.3.3.2">𝑁</ci><ci id="S3.SS1.SSS3.p2.4.m2.1.1.3.3.3.3.cmml" xref="S3.SS1.SSS3.p2.4.m2.1.1.3.3.3.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.4.m2.1c">U_{v}\in\mathbb{R}^{N\times N_{v}}</annotation></semantics></math>, <math id="S3.SS1.SSS3.p2.5.m3.2" class="ltx_Math" alttext="{\bf b}_{v},{\bf b}_{a}\in\mathbb{R}^{N}" display="inline"><semantics id="S3.SS1.SSS3.p2.5.m3.2a"><mrow id="S3.SS1.SSS3.p2.5.m3.2.2" xref="S3.SS1.SSS3.p2.5.m3.2.2.cmml"><mrow id="S3.SS1.SSS3.p2.5.m3.2.2.2.2" xref="S3.SS1.SSS3.p2.5.m3.2.2.2.3.cmml"><msub id="S3.SS1.SSS3.p2.5.m3.1.1.1.1.1" xref="S3.SS1.SSS3.p2.5.m3.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS3.p2.5.m3.1.1.1.1.1.2" xref="S3.SS1.SSS3.p2.5.m3.1.1.1.1.1.2.cmml">𝐛</mi><mi id="S3.SS1.SSS3.p2.5.m3.1.1.1.1.1.3" xref="S3.SS1.SSS3.p2.5.m3.1.1.1.1.1.3.cmml">v</mi></msub><mo id="S3.SS1.SSS3.p2.5.m3.2.2.2.2.3" xref="S3.SS1.SSS3.p2.5.m3.2.2.2.3.cmml">,</mo><msub id="S3.SS1.SSS3.p2.5.m3.2.2.2.2.2" xref="S3.SS1.SSS3.p2.5.m3.2.2.2.2.2.cmml"><mi id="S3.SS1.SSS3.p2.5.m3.2.2.2.2.2.2" xref="S3.SS1.SSS3.p2.5.m3.2.2.2.2.2.2.cmml">𝐛</mi><mi id="S3.SS1.SSS3.p2.5.m3.2.2.2.2.2.3" xref="S3.SS1.SSS3.p2.5.m3.2.2.2.2.2.3.cmml">a</mi></msub></mrow><mo id="S3.SS1.SSS3.p2.5.m3.2.2.3" xref="S3.SS1.SSS3.p2.5.m3.2.2.3.cmml">∈</mo><msup id="S3.SS1.SSS3.p2.5.m3.2.2.4" xref="S3.SS1.SSS3.p2.5.m3.2.2.4.cmml"><mi id="S3.SS1.SSS3.p2.5.m3.2.2.4.2" xref="S3.SS1.SSS3.p2.5.m3.2.2.4.2.cmml">ℝ</mi><mi id="S3.SS1.SSS3.p2.5.m3.2.2.4.3" xref="S3.SS1.SSS3.p2.5.m3.2.2.4.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.5.m3.2b"><apply id="S3.SS1.SSS3.p2.5.m3.2.2.cmml" xref="S3.SS1.SSS3.p2.5.m3.2.2"><in id="S3.SS1.SSS3.p2.5.m3.2.2.3.cmml" xref="S3.SS1.SSS3.p2.5.m3.2.2.3"></in><list id="S3.SS1.SSS3.p2.5.m3.2.2.2.3.cmml" xref="S3.SS1.SSS3.p2.5.m3.2.2.2.2"><apply id="S3.SS1.SSS3.p2.5.m3.1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p2.5.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.5.m3.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p2.5.m3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p2.5.m3.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS3.p2.5.m3.1.1.1.1.1.2">𝐛</ci><ci id="S3.SS1.SSS3.p2.5.m3.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS3.p2.5.m3.1.1.1.1.1.3">𝑣</ci></apply><apply id="S3.SS1.SSS3.p2.5.m3.2.2.2.2.2.cmml" xref="S3.SS1.SSS3.p2.5.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.5.m3.2.2.2.2.2.1.cmml" xref="S3.SS1.SSS3.p2.5.m3.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS3.p2.5.m3.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS3.p2.5.m3.2.2.2.2.2.2">𝐛</ci><ci id="S3.SS1.SSS3.p2.5.m3.2.2.2.2.2.3.cmml" xref="S3.SS1.SSS3.p2.5.m3.2.2.2.2.2.3">𝑎</ci></apply></list><apply id="S3.SS1.SSS3.p2.5.m3.2.2.4.cmml" xref="S3.SS1.SSS3.p2.5.m3.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.5.m3.2.2.4.1.cmml" xref="S3.SS1.SSS3.p2.5.m3.2.2.4">superscript</csymbol><ci id="S3.SS1.SSS3.p2.5.m3.2.2.4.2.cmml" xref="S3.SS1.SSS3.p2.5.m3.2.2.4.2">ℝ</ci><ci id="S3.SS1.SSS3.p2.5.m3.2.2.4.3.cmml" xref="S3.SS1.SSS3.p2.5.m3.2.2.4.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.5.m3.2c">{\bf b}_{v},{\bf b}_{a}\in\mathbb{R}^{N}</annotation></semantics></math>,
and <math id="S3.SS1.SSS3.p2.6.m4.1" class="ltx_Math" alttext="U_{a}\in\mathbb{R}^{N\times H}" display="inline"><semantics id="S3.SS1.SSS3.p2.6.m4.1a"><mrow id="S3.SS1.SSS3.p2.6.m4.1.1" xref="S3.SS1.SSS3.p2.6.m4.1.1.cmml"><msub id="S3.SS1.SSS3.p2.6.m4.1.1.2" xref="S3.SS1.SSS3.p2.6.m4.1.1.2.cmml"><mi id="S3.SS1.SSS3.p2.6.m4.1.1.2.2" xref="S3.SS1.SSS3.p2.6.m4.1.1.2.2.cmml">U</mi><mi id="S3.SS1.SSS3.p2.6.m4.1.1.2.3" xref="S3.SS1.SSS3.p2.6.m4.1.1.2.3.cmml">a</mi></msub><mo id="S3.SS1.SSS3.p2.6.m4.1.1.1" xref="S3.SS1.SSS3.p2.6.m4.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS3.p2.6.m4.1.1.3" xref="S3.SS1.SSS3.p2.6.m4.1.1.3.cmml"><mi id="S3.SS1.SSS3.p2.6.m4.1.1.3.2" xref="S3.SS1.SSS3.p2.6.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS3.p2.6.m4.1.1.3.3" xref="S3.SS1.SSS3.p2.6.m4.1.1.3.3.cmml"><mi id="S3.SS1.SSS3.p2.6.m4.1.1.3.3.2" xref="S3.SS1.SSS3.p2.6.m4.1.1.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS3.p2.6.m4.1.1.3.3.1" xref="S3.SS1.SSS3.p2.6.m4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.SSS3.p2.6.m4.1.1.3.3.3" xref="S3.SS1.SSS3.p2.6.m4.1.1.3.3.3.cmml">H</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.6.m4.1b"><apply id="S3.SS1.SSS3.p2.6.m4.1.1.cmml" xref="S3.SS1.SSS3.p2.6.m4.1.1"><in id="S3.SS1.SSS3.p2.6.m4.1.1.1.cmml" xref="S3.SS1.SSS3.p2.6.m4.1.1.1"></in><apply id="S3.SS1.SSS3.p2.6.m4.1.1.2.cmml" xref="S3.SS1.SSS3.p2.6.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.6.m4.1.1.2.1.cmml" xref="S3.SS1.SSS3.p2.6.m4.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS3.p2.6.m4.1.1.2.2.cmml" xref="S3.SS1.SSS3.p2.6.m4.1.1.2.2">𝑈</ci><ci id="S3.SS1.SSS3.p2.6.m4.1.1.2.3.cmml" xref="S3.SS1.SSS3.p2.6.m4.1.1.2.3">𝑎</ci></apply><apply id="S3.SS1.SSS3.p2.6.m4.1.1.3.cmml" xref="S3.SS1.SSS3.p2.6.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.6.m4.1.1.3.1.cmml" xref="S3.SS1.SSS3.p2.6.m4.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS3.p2.6.m4.1.1.3.2.cmml" xref="S3.SS1.SSS3.p2.6.m4.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS3.p2.6.m4.1.1.3.3.cmml" xref="S3.SS1.SSS3.p2.6.m4.1.1.3.3"><times id="S3.SS1.SSS3.p2.6.m4.1.1.3.3.1.cmml" xref="S3.SS1.SSS3.p2.6.m4.1.1.3.3.1"></times><ci id="S3.SS1.SSS3.p2.6.m4.1.1.3.3.2.cmml" xref="S3.SS1.SSS3.p2.6.m4.1.1.3.3.2">𝑁</ci><ci id="S3.SS1.SSS3.p2.6.m4.1.1.3.3.3.cmml" xref="S3.SS1.SSS3.p2.6.m4.1.1.3.3.3">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.6.m4.1c">U_{a}\in\mathbb{R}^{N\times H}</annotation></semantics></math>
are the model parameters,
and <math id="S3.SS1.SSS3.p2.7.m5.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="S3.SS1.SSS3.p2.7.m5.1a"><mo id="S3.SS1.SSS3.p2.7.m5.1.1" xref="S3.SS1.SSS3.p2.7.m5.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.7.m5.1b"><csymbol cd="latexml" id="S3.SS1.SSS3.p2.7.m5.1.1.cmml" xref="S3.SS1.SSS3.p2.7.m5.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.7.m5.1c">\odot</annotation></semantics></math> denotes the Hadamard product operator.
We then pass the visual attention weights into a softmax layer to compute the
attended visual representation of the image, <math id="S3.SS1.SSS3.p2.8.m6.1" class="ltx_Math" alttext="{\bf\hat{c}}_{v}" display="inline"><semantics id="S3.SS1.SSS3.p2.8.m6.1a"><msub id="S3.SS1.SSS3.p2.8.m6.1.1" xref="S3.SS1.SSS3.p2.8.m6.1.1.cmml"><mover accent="true" id="S3.SS1.SSS3.p2.8.m6.1.1.2" xref="S3.SS1.SSS3.p2.8.m6.1.1.2.cmml"><mi id="S3.SS1.SSS3.p2.8.m6.1.1.2.2" xref="S3.SS1.SSS3.p2.8.m6.1.1.2.2.cmml">𝐜</mi><mo id="S3.SS1.SSS3.p2.8.m6.1.1.2.1" xref="S3.SS1.SSS3.p2.8.m6.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS1.SSS3.p2.8.m6.1.1.3" xref="S3.SS1.SSS3.p2.8.m6.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.8.m6.1b"><apply id="S3.SS1.SSS3.p2.8.m6.1.1.cmml" xref="S3.SS1.SSS3.p2.8.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.8.m6.1.1.1.cmml" xref="S3.SS1.SSS3.p2.8.m6.1.1">subscript</csymbol><apply id="S3.SS1.SSS3.p2.8.m6.1.1.2.cmml" xref="S3.SS1.SSS3.p2.8.m6.1.1.2"><ci id="S3.SS1.SSS3.p2.8.m6.1.1.2.1.cmml" xref="S3.SS1.SSS3.p2.8.m6.1.1.2.1">^</ci><ci id="S3.SS1.SSS3.p2.8.m6.1.1.2.2.cmml" xref="S3.SS1.SSS3.p2.8.m6.1.1.2.2">𝐜</ci></apply><ci id="S3.SS1.SSS3.p2.8.m6.1.1.3.cmml" xref="S3.SS1.SSS3.p2.8.m6.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.8.m6.1c">{\bf\hat{c}}_{v}</annotation></semantics></math>:</p>
<table id="S5.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3.m1.4" class="ltx_Math" alttext="\displaystyle{\bf\beta}_{v}=\mbox{softmax}({\bf\alpha}_{v}),\qquad{\bf\hat{c}}_{v}=\sum_{i=1}^{i=k}\beta_{i,v}{\bf v}_{i}" display="inline"><semantics id="S3.E3.m1.4a"><mrow id="S3.E3.m1.4.4.2" xref="S3.E3.m1.4.4.3.cmml"><mrow id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml"><msub id="S3.E3.m1.3.3.1.1.3" xref="S3.E3.m1.3.3.1.1.3.cmml"><mi id="S3.E3.m1.3.3.1.1.3.2" xref="S3.E3.m1.3.3.1.1.3.2.cmml">β</mi><mi id="S3.E3.m1.3.3.1.1.3.3" xref="S3.E3.m1.3.3.1.1.3.3.cmml">v</mi></msub><mo id="S3.E3.m1.3.3.1.1.2" xref="S3.E3.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.3.3.1.1.1" xref="S3.E3.m1.3.3.1.1.1.cmml"><mtext id="S3.E3.m1.3.3.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.3a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E3.m1.3.3.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.cmml">α</mi><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.cmml">v</mi></msub><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="2.167em" id="S3.E3.m1.4.4.2.3" xref="S3.E3.m1.4.4.3a.cmml">,</mo><mrow id="S3.E3.m1.4.4.2.2" xref="S3.E3.m1.4.4.2.2.cmml"><msub id="S3.E3.m1.4.4.2.2.2" xref="S3.E3.m1.4.4.2.2.2.cmml"><mover accent="true" id="S3.E3.m1.4.4.2.2.2.2" xref="S3.E3.m1.4.4.2.2.2.2.cmml"><mi id="S3.E3.m1.4.4.2.2.2.2.2" xref="S3.E3.m1.4.4.2.2.2.2.2.cmml">𝐜</mi><mo id="S3.E3.m1.4.4.2.2.2.2.1" xref="S3.E3.m1.4.4.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E3.m1.4.4.2.2.2.3" xref="S3.E3.m1.4.4.2.2.2.3.cmml">v</mi></msub><mo id="S3.E3.m1.4.4.2.2.1" xref="S3.E3.m1.4.4.2.2.1.cmml">=</mo><mrow id="S3.E3.m1.4.4.2.2.3" xref="S3.E3.m1.4.4.2.2.3.cmml"><mstyle displaystyle="true" id="S3.E3.m1.4.4.2.2.3.1" xref="S3.E3.m1.4.4.2.2.3.1.cmml"><munderover id="S3.E3.m1.4.4.2.2.3.1a" xref="S3.E3.m1.4.4.2.2.3.1.cmml"><mo movablelimits="false" id="S3.E3.m1.4.4.2.2.3.1.2.2" xref="S3.E3.m1.4.4.2.2.3.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.4.4.2.2.3.1.2.3" xref="S3.E3.m1.4.4.2.2.3.1.2.3.cmml"><mi id="S3.E3.m1.4.4.2.2.3.1.2.3.2" xref="S3.E3.m1.4.4.2.2.3.1.2.3.2.cmml">i</mi><mo id="S3.E3.m1.4.4.2.2.3.1.2.3.1" xref="S3.E3.m1.4.4.2.2.3.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.4.4.2.2.3.1.2.3.3" xref="S3.E3.m1.4.4.2.2.3.1.2.3.3.cmml">1</mn></mrow><mrow id="S3.E3.m1.4.4.2.2.3.1.3" xref="S3.E3.m1.4.4.2.2.3.1.3.cmml"><mi id="S3.E3.m1.4.4.2.2.3.1.3.2" xref="S3.E3.m1.4.4.2.2.3.1.3.2.cmml">i</mi><mo id="S3.E3.m1.4.4.2.2.3.1.3.1" xref="S3.E3.m1.4.4.2.2.3.1.3.1.cmml">=</mo><mi id="S3.E3.m1.4.4.2.2.3.1.3.3" xref="S3.E3.m1.4.4.2.2.3.1.3.3.cmml">k</mi></mrow></munderover></mstyle><mrow id="S3.E3.m1.4.4.2.2.3.2" xref="S3.E3.m1.4.4.2.2.3.2.cmml"><msub id="S3.E3.m1.4.4.2.2.3.2.2" xref="S3.E3.m1.4.4.2.2.3.2.2.cmml"><mi id="S3.E3.m1.4.4.2.2.3.2.2.2" xref="S3.E3.m1.4.4.2.2.3.2.2.2.cmml">β</mi><mrow id="S3.E3.m1.2.2.2.4" xref="S3.E3.m1.2.2.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">i</mi><mo id="S3.E3.m1.2.2.2.4.1" xref="S3.E3.m1.2.2.2.3.cmml">,</mo><mi id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml">v</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.4.4.2.2.3.2.1" xref="S3.E3.m1.4.4.2.2.3.2.1.cmml">​</mo><msub id="S3.E3.m1.4.4.2.2.3.2.3" xref="S3.E3.m1.4.4.2.2.3.2.3.cmml"><mi id="S3.E3.m1.4.4.2.2.3.2.3.2" xref="S3.E3.m1.4.4.2.2.3.2.3.2.cmml">𝐯</mi><mi id="S3.E3.m1.4.4.2.2.3.2.3.3" xref="S3.E3.m1.4.4.2.2.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.4b"><apply id="S3.E3.m1.4.4.3.cmml" xref="S3.E3.m1.4.4.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.3a.cmml" xref="S3.E3.m1.4.4.2.3">formulae-sequence</csymbol><apply id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1.1"><eq id="S3.E3.m1.3.3.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.2"></eq><apply id="S3.E3.m1.3.3.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.3.1.cmml" xref="S3.E3.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.3.2.cmml" xref="S3.E3.m1.3.3.1.1.3.2">𝛽</ci><ci id="S3.E3.m1.3.3.1.1.3.3.cmml" xref="S3.E3.m1.3.3.1.1.3.3">𝑣</ci></apply><apply id="S3.E3.m1.3.3.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1"><times id="S3.E3.m1.3.3.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.2"></times><ci id="S3.E3.m1.3.3.1.1.1.3a.cmml" xref="S3.E3.m1.3.3.1.1.1.3"><mtext id="S3.E3.m1.3.3.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.3">softmax</mtext></ci><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2">𝛼</ci><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3">𝑣</ci></apply></apply></apply><apply id="S3.E3.m1.4.4.2.2.cmml" xref="S3.E3.m1.4.4.2.2"><eq id="S3.E3.m1.4.4.2.2.1.cmml" xref="S3.E3.m1.4.4.2.2.1"></eq><apply id="S3.E3.m1.4.4.2.2.2.cmml" xref="S3.E3.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.2.2.2.1.cmml" xref="S3.E3.m1.4.4.2.2.2">subscript</csymbol><apply id="S3.E3.m1.4.4.2.2.2.2.cmml" xref="S3.E3.m1.4.4.2.2.2.2"><ci id="S3.E3.m1.4.4.2.2.2.2.1.cmml" xref="S3.E3.m1.4.4.2.2.2.2.1">^</ci><ci id="S3.E3.m1.4.4.2.2.2.2.2.cmml" xref="S3.E3.m1.4.4.2.2.2.2.2">𝐜</ci></apply><ci id="S3.E3.m1.4.4.2.2.2.3.cmml" xref="S3.E3.m1.4.4.2.2.2.3">𝑣</ci></apply><apply id="S3.E3.m1.4.4.2.2.3.cmml" xref="S3.E3.m1.4.4.2.2.3"><apply id="S3.E3.m1.4.4.2.2.3.1.cmml" xref="S3.E3.m1.4.4.2.2.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.2.2.3.1.1.cmml" xref="S3.E3.m1.4.4.2.2.3.1">superscript</csymbol><apply id="S3.E3.m1.4.4.2.2.3.1.2.cmml" xref="S3.E3.m1.4.4.2.2.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.2.2.3.1.2.1.cmml" xref="S3.E3.m1.4.4.2.2.3.1">subscript</csymbol><sum id="S3.E3.m1.4.4.2.2.3.1.2.2.cmml" xref="S3.E3.m1.4.4.2.2.3.1.2.2"></sum><apply id="S3.E3.m1.4.4.2.2.3.1.2.3.cmml" xref="S3.E3.m1.4.4.2.2.3.1.2.3"><eq id="S3.E3.m1.4.4.2.2.3.1.2.3.1.cmml" xref="S3.E3.m1.4.4.2.2.3.1.2.3.1"></eq><ci id="S3.E3.m1.4.4.2.2.3.1.2.3.2.cmml" xref="S3.E3.m1.4.4.2.2.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E3.m1.4.4.2.2.3.1.2.3.3.cmml" xref="S3.E3.m1.4.4.2.2.3.1.2.3.3">1</cn></apply></apply><apply id="S3.E3.m1.4.4.2.2.3.1.3.cmml" xref="S3.E3.m1.4.4.2.2.3.1.3"><eq id="S3.E3.m1.4.4.2.2.3.1.3.1.cmml" xref="S3.E3.m1.4.4.2.2.3.1.3.1"></eq><ci id="S3.E3.m1.4.4.2.2.3.1.3.2.cmml" xref="S3.E3.m1.4.4.2.2.3.1.3.2">𝑖</ci><ci id="S3.E3.m1.4.4.2.2.3.1.3.3.cmml" xref="S3.E3.m1.4.4.2.2.3.1.3.3">𝑘</ci></apply></apply><apply id="S3.E3.m1.4.4.2.2.3.2.cmml" xref="S3.E3.m1.4.4.2.2.3.2"><times id="S3.E3.m1.4.4.2.2.3.2.1.cmml" xref="S3.E3.m1.4.4.2.2.3.2.1"></times><apply id="S3.E3.m1.4.4.2.2.3.2.2.cmml" xref="S3.E3.m1.4.4.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.2.2.3.2.2.1.cmml" xref="S3.E3.m1.4.4.2.2.3.2.2">subscript</csymbol><ci id="S3.E3.m1.4.4.2.2.3.2.2.2.cmml" xref="S3.E3.m1.4.4.2.2.3.2.2.2">𝛽</ci><list id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.4"><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑖</ci><ci id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2">𝑣</ci></list></apply><apply id="S3.E3.m1.4.4.2.2.3.2.3.cmml" xref="S3.E3.m1.4.4.2.2.3.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.2.2.3.2.3.1.cmml" xref="S3.E3.m1.4.4.2.2.3.2.3">subscript</csymbol><ci id="S3.E3.m1.4.4.2.2.3.2.3.2.cmml" xref="S3.E3.m1.4.4.2.2.3.2.3.2">𝐯</ci><ci id="S3.E3.m1.4.4.2.2.3.2.3.3.cmml" xref="S3.E3.m1.4.4.2.2.3.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.4c">\displaystyle{\bf\beta}_{v}=\mbox{softmax}({\bf\alpha}_{v}),\qquad{\bf\hat{c}}_{v}=\sum_{i=1}^{i=k}\beta_{i,v}{\bf v}_{i}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.SSS3.p3" class="ltx_para ltx_noindent">
<p id="S3.SS1.SSS3.p3.1" class="ltx_p"><span id="S3.SS1.SSS3.p3.1.1" class="ltx_text ltx_font_bold">Semantic Attention.</span>
We compute the attended semantic representation of the image in a similar way.
The attention weight for
each semantic feature vector, <math id="S3.SS1.SSS3.p3.1.m1.1" class="ltx_Math" alttext="{\bf s}_{i}\in S" display="inline"><semantics id="S3.SS1.SSS3.p3.1.m1.1a"><mrow id="S3.SS1.SSS3.p3.1.m1.1.1" xref="S3.SS1.SSS3.p3.1.m1.1.1.cmml"><msub id="S3.SS1.SSS3.p3.1.m1.1.1.2" xref="S3.SS1.SSS3.p3.1.m1.1.1.2.cmml"><mi id="S3.SS1.SSS3.p3.1.m1.1.1.2.2" xref="S3.SS1.SSS3.p3.1.m1.1.1.2.2.cmml">𝐬</mi><mi id="S3.SS1.SSS3.p3.1.m1.1.1.2.3" xref="S3.SS1.SSS3.p3.1.m1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.SSS3.p3.1.m1.1.1.1" xref="S3.SS1.SSS3.p3.1.m1.1.1.1.cmml">∈</mo><mi id="S3.SS1.SSS3.p3.1.m1.1.1.3" xref="S3.SS1.SSS3.p3.1.m1.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p3.1.m1.1b"><apply id="S3.SS1.SSS3.p3.1.m1.1.1.cmml" xref="S3.SS1.SSS3.p3.1.m1.1.1"><in id="S3.SS1.SSS3.p3.1.m1.1.1.1.cmml" xref="S3.SS1.SSS3.p3.1.m1.1.1.1"></in><apply id="S3.SS1.SSS3.p3.1.m1.1.1.2.cmml" xref="S3.SS1.SSS3.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.1.m1.1.1.2.1.cmml" xref="S3.SS1.SSS3.p3.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS3.p3.1.m1.1.1.2.2.cmml" xref="S3.SS1.SSS3.p3.1.m1.1.1.2.2">𝐬</ci><ci id="S3.SS1.SSS3.p3.1.m1.1.1.2.3.cmml" xref="S3.SS1.SSS3.p3.1.m1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS1.SSS3.p3.1.m1.1.1.3.cmml" xref="S3.SS1.SSS3.p3.1.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p3.1.m1.1c">{\bf s}_{i}\in S</annotation></semantics></math>, is computed as follows:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.7" class="ltx_Math" alttext="\alpha_{i,s}=W_{att,s}^{\top}(\tanh(U_{s}{\bf s}_{i}+{\bf b}_{s})\odot\tanh(U^{\prime}_{a}{\bf a}+{\bf b^{\prime}}_{a}))" display="block"><semantics id="S3.E4.m1.7a"><mrow id="S3.E4.m1.7.7" xref="S3.E4.m1.7.7.cmml"><msub id="S3.E4.m1.7.7.3" xref="S3.E4.m1.7.7.3.cmml"><mi id="S3.E4.m1.7.7.3.2" xref="S3.E4.m1.7.7.3.2.cmml">α</mi><mrow id="S3.E4.m1.2.2.2.4" xref="S3.E4.m1.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">i</mi><mo id="S3.E4.m1.2.2.2.4.1" xref="S3.E4.m1.2.2.2.3.cmml">,</mo><mi id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.2.cmml">s</mi></mrow></msub><mo id="S3.E4.m1.7.7.2" xref="S3.E4.m1.7.7.2.cmml">=</mo><mrow id="S3.E4.m1.7.7.1" xref="S3.E4.m1.7.7.1.cmml"><msubsup id="S3.E4.m1.7.7.1.3" xref="S3.E4.m1.7.7.1.3.cmml"><mi id="S3.E4.m1.7.7.1.3.2.2" xref="S3.E4.m1.7.7.1.3.2.2.cmml">W</mi><mrow id="S3.E4.m1.4.4.2.2" xref="S3.E4.m1.4.4.2.3.cmml"><mrow id="S3.E4.m1.4.4.2.2.1" xref="S3.E4.m1.4.4.2.2.1.cmml"><mi id="S3.E4.m1.4.4.2.2.1.2" xref="S3.E4.m1.4.4.2.2.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.2.2.1.1" xref="S3.E4.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S3.E4.m1.4.4.2.2.1.3" xref="S3.E4.m1.4.4.2.2.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.2.2.1.1a" xref="S3.E4.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S3.E4.m1.4.4.2.2.1.4" xref="S3.E4.m1.4.4.2.2.1.4.cmml">t</mi></mrow><mo id="S3.E4.m1.4.4.2.2.2" xref="S3.E4.m1.4.4.2.3.cmml">,</mo><mi id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.1.cmml">s</mi></mrow><mo id="S3.E4.m1.7.7.1.3.3" xref="S3.E4.m1.7.7.1.3.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="S3.E4.m1.7.7.1.2" xref="S3.E4.m1.7.7.1.2.cmml">​</mo><mrow id="S3.E4.m1.7.7.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.7.7.1.1.1.2" xref="S3.E4.m1.7.7.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.7.7.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.cmml"><mrow id="S3.E4.m1.7.7.1.1.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.5.5" xref="S3.E4.m1.5.5.cmml">tanh</mi><mo id="S3.E4.m1.7.7.1.1.1.1.1.1a" xref="S3.E4.m1.7.7.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E4.m1.7.7.1.1.1.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.7.7.1.1.1.1.1.1.1.2" xref="S3.E4.m1.7.7.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.cmml">U</mi><mi id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.2.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.1" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.3" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.3.2.cmml">𝐬</mi><mi id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.3.3.cmml">i</mi></msub></mrow><mo id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.3.2.cmml">𝐛</mi><mi id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo rspace="0.055em" stretchy="false" id="S3.E4.m1.7.7.1.1.1.1.1.1.1.3" xref="S3.E4.m1.7.7.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S3.E4.m1.7.7.1.1.1.1.3" xref="S3.E4.m1.7.7.1.1.1.1.3.cmml">⊙</mo><mrow id="S3.E4.m1.7.7.1.1.1.1.2.1" xref="S3.E4.m1.7.7.1.1.1.1.2.2.cmml"><mi id="S3.E4.m1.6.6" xref="S3.E4.m1.6.6.cmml">tanh</mi><mo id="S3.E4.m1.7.7.1.1.1.1.2.1a" xref="S3.E4.m1.7.7.1.1.1.1.2.2.cmml">⁡</mo><mrow id="S3.E4.m1.7.7.1.1.1.1.2.1.1" xref="S3.E4.m1.7.7.1.1.1.1.2.2.cmml"><mo stretchy="false" id="S3.E4.m1.7.7.1.1.1.1.2.1.1.2" xref="S3.E4.m1.7.7.1.1.1.1.2.2.cmml">(</mo><mrow id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.cmml"><mrow id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.cmml"><msubsup id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.2" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.2.cmml"><mi id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.2.2.2" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.2.2.2.cmml">U</mi><mi id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.2.3" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.2.3.cmml">a</mi><mo id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.2.2.3" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.2.2.3.cmml">′</mo></msubsup><mo lspace="0em" rspace="0em" id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.1" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.1.cmml">​</mo><mi id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.3" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.3.cmml">𝐚</mi></mrow><mo id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.1.cmml">+</mo><mmultiscripts id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.3" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.3.cmml"><mi id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.3.2.2" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.3.2.2.cmml">𝐛</mi><mrow id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.3a" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.3.cmml"></mrow><mo id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.3.2.3" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.3.2.3.cmml">′</mo><mi id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.3.3" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.3.3.cmml">a</mi><mrow id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.3b" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.3.cmml"></mrow></mmultiscripts></mrow><mo stretchy="false" id="S3.E4.m1.7.7.1.1.1.1.2.1.1.3" xref="S3.E4.m1.7.7.1.1.1.1.2.2.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E4.m1.7.7.1.1.1.3" xref="S3.E4.m1.7.7.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.7b"><apply id="S3.E4.m1.7.7.cmml" xref="S3.E4.m1.7.7"><eq id="S3.E4.m1.7.7.2.cmml" xref="S3.E4.m1.7.7.2"></eq><apply id="S3.E4.m1.7.7.3.cmml" xref="S3.E4.m1.7.7.3"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.3.1.cmml" xref="S3.E4.m1.7.7.3">subscript</csymbol><ci id="S3.E4.m1.7.7.3.2.cmml" xref="S3.E4.m1.7.7.3.2">𝛼</ci><list id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.4"><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝑖</ci><ci id="S3.E4.m1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2">𝑠</ci></list></apply><apply id="S3.E4.m1.7.7.1.cmml" xref="S3.E4.m1.7.7.1"><times id="S3.E4.m1.7.7.1.2.cmml" xref="S3.E4.m1.7.7.1.2"></times><apply id="S3.E4.m1.7.7.1.3.cmml" xref="S3.E4.m1.7.7.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.3.1.cmml" xref="S3.E4.m1.7.7.1.3">superscript</csymbol><apply id="S3.E4.m1.7.7.1.3.2.cmml" xref="S3.E4.m1.7.7.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.3.2.1.cmml" xref="S3.E4.m1.7.7.1.3">subscript</csymbol><ci id="S3.E4.m1.7.7.1.3.2.2.cmml" xref="S3.E4.m1.7.7.1.3.2.2">𝑊</ci><list id="S3.E4.m1.4.4.2.3.cmml" xref="S3.E4.m1.4.4.2.2"><apply id="S3.E4.m1.4.4.2.2.1.cmml" xref="S3.E4.m1.4.4.2.2.1"><times id="S3.E4.m1.4.4.2.2.1.1.cmml" xref="S3.E4.m1.4.4.2.2.1.1"></times><ci id="S3.E4.m1.4.4.2.2.1.2.cmml" xref="S3.E4.m1.4.4.2.2.1.2">𝑎</ci><ci id="S3.E4.m1.4.4.2.2.1.3.cmml" xref="S3.E4.m1.4.4.2.2.1.3">𝑡</ci><ci id="S3.E4.m1.4.4.2.2.1.4.cmml" xref="S3.E4.m1.4.4.2.2.1.4">𝑡</ci></apply><ci id="S3.E4.m1.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1.1">𝑠</ci></list></apply><csymbol cd="latexml" id="S3.E4.m1.7.7.1.3.3.cmml" xref="S3.E4.m1.7.7.1.3.3">top</csymbol></apply><apply id="S3.E4.m1.7.7.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.7.7.1.1.1.1.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.3">direct-product</csymbol><apply id="S3.E4.m1.7.7.1.1.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1"><tanh id="S3.E4.m1.5.5.cmml" xref="S3.E4.m1.5.5"></tanh><apply id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1"><plus id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2"><times id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.2.2">𝑈</ci><ci id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.2.3">𝑠</ci></apply><apply id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.3.2">𝐬</ci><ci id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.3.2">𝐛</ci><ci id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply></apply><apply id="S3.E4.m1.7.7.1.1.1.1.2.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2.1"><tanh id="S3.E4.m1.6.6.cmml" xref="S3.E4.m1.6.6"></tanh><apply id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1"><plus id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.1"></plus><apply id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2"><times id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.1"></times><apply id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.2.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.2">subscript</csymbol><apply id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.2.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.2.2.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.2">superscript</csymbol><ci id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.2.2.2">𝑈</ci><ci id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.2.2.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.2.2.3">′</ci></apply><ci id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.2.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.2.3">𝑎</ci></apply><ci id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.2.3">𝐚</ci></apply><apply id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.3.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.3">subscript</csymbol><apply id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.3.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.3.2.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.3">superscript</csymbol><ci id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.3.2.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.3.2.2">𝐛</ci><ci id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.3.2.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.3.2.3">′</ci></apply><ci id="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.3.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2.1.1.1.3.3">𝑎</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.7c">\alpha_{i,s}=W_{att,s}^{\top}(\tanh(U_{s}{\bf s}_{i}+{\bf b}_{s})\odot\tanh(U^{\prime}_{a}{\bf a}+{\bf b^{\prime}}_{a}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS3.p3.6" class="ltx_p">where <math id="S3.SS1.SSS3.p3.2.m1.2" class="ltx_Math" alttext="W_{att,s}\in\mathbb{R}^{N}" display="inline"><semantics id="S3.SS1.SSS3.p3.2.m1.2a"><mrow id="S3.SS1.SSS3.p3.2.m1.2.3" xref="S3.SS1.SSS3.p3.2.m1.2.3.cmml"><msub id="S3.SS1.SSS3.p3.2.m1.2.3.2" xref="S3.SS1.SSS3.p3.2.m1.2.3.2.cmml"><mi id="S3.SS1.SSS3.p3.2.m1.2.3.2.2" xref="S3.SS1.SSS3.p3.2.m1.2.3.2.2.cmml">W</mi><mrow id="S3.SS1.SSS3.p3.2.m1.2.2.2.2" xref="S3.SS1.SSS3.p3.2.m1.2.2.2.3.cmml"><mrow id="S3.SS1.SSS3.p3.2.m1.2.2.2.2.1" xref="S3.SS1.SSS3.p3.2.m1.2.2.2.2.1.cmml"><mi id="S3.SS1.SSS3.p3.2.m1.2.2.2.2.1.2" xref="S3.SS1.SSS3.p3.2.m1.2.2.2.2.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.p3.2.m1.2.2.2.2.1.1" xref="S3.SS1.SSS3.p3.2.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS1.SSS3.p3.2.m1.2.2.2.2.1.3" xref="S3.SS1.SSS3.p3.2.m1.2.2.2.2.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.p3.2.m1.2.2.2.2.1.1a" xref="S3.SS1.SSS3.p3.2.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS1.SSS3.p3.2.m1.2.2.2.2.1.4" xref="S3.SS1.SSS3.p3.2.m1.2.2.2.2.1.4.cmml">t</mi></mrow><mo id="S3.SS1.SSS3.p3.2.m1.2.2.2.2.2" xref="S3.SS1.SSS3.p3.2.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS3.p3.2.m1.1.1.1.1" xref="S3.SS1.SSS3.p3.2.m1.1.1.1.1.cmml">s</mi></mrow></msub><mo id="S3.SS1.SSS3.p3.2.m1.2.3.1" xref="S3.SS1.SSS3.p3.2.m1.2.3.1.cmml">∈</mo><msup id="S3.SS1.SSS3.p3.2.m1.2.3.3" xref="S3.SS1.SSS3.p3.2.m1.2.3.3.cmml"><mi id="S3.SS1.SSS3.p3.2.m1.2.3.3.2" xref="S3.SS1.SSS3.p3.2.m1.2.3.3.2.cmml">ℝ</mi><mi id="S3.SS1.SSS3.p3.2.m1.2.3.3.3" xref="S3.SS1.SSS3.p3.2.m1.2.3.3.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p3.2.m1.2b"><apply id="S3.SS1.SSS3.p3.2.m1.2.3.cmml" xref="S3.SS1.SSS3.p3.2.m1.2.3"><in id="S3.SS1.SSS3.p3.2.m1.2.3.1.cmml" xref="S3.SS1.SSS3.p3.2.m1.2.3.1"></in><apply id="S3.SS1.SSS3.p3.2.m1.2.3.2.cmml" xref="S3.SS1.SSS3.p3.2.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.2.m1.2.3.2.1.cmml" xref="S3.SS1.SSS3.p3.2.m1.2.3.2">subscript</csymbol><ci id="S3.SS1.SSS3.p3.2.m1.2.3.2.2.cmml" xref="S3.SS1.SSS3.p3.2.m1.2.3.2.2">𝑊</ci><list id="S3.SS1.SSS3.p3.2.m1.2.2.2.3.cmml" xref="S3.SS1.SSS3.p3.2.m1.2.2.2.2"><apply id="S3.SS1.SSS3.p3.2.m1.2.2.2.2.1.cmml" xref="S3.SS1.SSS3.p3.2.m1.2.2.2.2.1"><times id="S3.SS1.SSS3.p3.2.m1.2.2.2.2.1.1.cmml" xref="S3.SS1.SSS3.p3.2.m1.2.2.2.2.1.1"></times><ci id="S3.SS1.SSS3.p3.2.m1.2.2.2.2.1.2.cmml" xref="S3.SS1.SSS3.p3.2.m1.2.2.2.2.1.2">𝑎</ci><ci id="S3.SS1.SSS3.p3.2.m1.2.2.2.2.1.3.cmml" xref="S3.SS1.SSS3.p3.2.m1.2.2.2.2.1.3">𝑡</ci><ci id="S3.SS1.SSS3.p3.2.m1.2.2.2.2.1.4.cmml" xref="S3.SS1.SSS3.p3.2.m1.2.2.2.2.1.4">𝑡</ci></apply><ci id="S3.SS1.SSS3.p3.2.m1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p3.2.m1.1.1.1.1">𝑠</ci></list></apply><apply id="S3.SS1.SSS3.p3.2.m1.2.3.3.cmml" xref="S3.SS1.SSS3.p3.2.m1.2.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.2.m1.2.3.3.1.cmml" xref="S3.SS1.SSS3.p3.2.m1.2.3.3">superscript</csymbol><ci id="S3.SS1.SSS3.p3.2.m1.2.3.3.2.cmml" xref="S3.SS1.SSS3.p3.2.m1.2.3.3.2">ℝ</ci><ci id="S3.SS1.SSS3.p3.2.m1.2.3.3.3.cmml" xref="S3.SS1.SSS3.p3.2.m1.2.3.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p3.2.m1.2c">W_{att,s}\in\mathbb{R}^{N}</annotation></semantics></math>,
<math id="S3.SS1.SSS3.p3.3.m2.1" class="ltx_Math" alttext="U_{s}\in\mathbb{R}^{N\times 600}" display="inline"><semantics id="S3.SS1.SSS3.p3.3.m2.1a"><mrow id="S3.SS1.SSS3.p3.3.m2.1.1" xref="S3.SS1.SSS3.p3.3.m2.1.1.cmml"><msub id="S3.SS1.SSS3.p3.3.m2.1.1.2" xref="S3.SS1.SSS3.p3.3.m2.1.1.2.cmml"><mi id="S3.SS1.SSS3.p3.3.m2.1.1.2.2" xref="S3.SS1.SSS3.p3.3.m2.1.1.2.2.cmml">U</mi><mi id="S3.SS1.SSS3.p3.3.m2.1.1.2.3" xref="S3.SS1.SSS3.p3.3.m2.1.1.2.3.cmml">s</mi></msub><mo id="S3.SS1.SSS3.p3.3.m2.1.1.1" xref="S3.SS1.SSS3.p3.3.m2.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS3.p3.3.m2.1.1.3" xref="S3.SS1.SSS3.p3.3.m2.1.1.3.cmml"><mi id="S3.SS1.SSS3.p3.3.m2.1.1.3.2" xref="S3.SS1.SSS3.p3.3.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS3.p3.3.m2.1.1.3.3" xref="S3.SS1.SSS3.p3.3.m2.1.1.3.3.cmml"><mi id="S3.SS1.SSS3.p3.3.m2.1.1.3.3.2" xref="S3.SS1.SSS3.p3.3.m2.1.1.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS3.p3.3.m2.1.1.3.3.1" xref="S3.SS1.SSS3.p3.3.m2.1.1.3.3.1.cmml">×</mo><mn id="S3.SS1.SSS3.p3.3.m2.1.1.3.3.3" xref="S3.SS1.SSS3.p3.3.m2.1.1.3.3.3.cmml">600</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p3.3.m2.1b"><apply id="S3.SS1.SSS3.p3.3.m2.1.1.cmml" xref="S3.SS1.SSS3.p3.3.m2.1.1"><in id="S3.SS1.SSS3.p3.3.m2.1.1.1.cmml" xref="S3.SS1.SSS3.p3.3.m2.1.1.1"></in><apply id="S3.SS1.SSS3.p3.3.m2.1.1.2.cmml" xref="S3.SS1.SSS3.p3.3.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.3.m2.1.1.2.1.cmml" xref="S3.SS1.SSS3.p3.3.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS3.p3.3.m2.1.1.2.2.cmml" xref="S3.SS1.SSS3.p3.3.m2.1.1.2.2">𝑈</ci><ci id="S3.SS1.SSS3.p3.3.m2.1.1.2.3.cmml" xref="S3.SS1.SSS3.p3.3.m2.1.1.2.3">𝑠</ci></apply><apply id="S3.SS1.SSS3.p3.3.m2.1.1.3.cmml" xref="S3.SS1.SSS3.p3.3.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.3.m2.1.1.3.1.cmml" xref="S3.SS1.SSS3.p3.3.m2.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS3.p3.3.m2.1.1.3.2.cmml" xref="S3.SS1.SSS3.p3.3.m2.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS3.p3.3.m2.1.1.3.3.cmml" xref="S3.SS1.SSS3.p3.3.m2.1.1.3.3"><times id="S3.SS1.SSS3.p3.3.m2.1.1.3.3.1.cmml" xref="S3.SS1.SSS3.p3.3.m2.1.1.3.3.1"></times><ci id="S3.SS1.SSS3.p3.3.m2.1.1.3.3.2.cmml" xref="S3.SS1.SSS3.p3.3.m2.1.1.3.3.2">𝑁</ci><cn type="integer" id="S3.SS1.SSS3.p3.3.m2.1.1.3.3.3.cmml" xref="S3.SS1.SSS3.p3.3.m2.1.1.3.3.3">600</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p3.3.m2.1c">U_{s}\in\mathbb{R}^{N\times 600}</annotation></semantics></math>, <math id="S3.SS1.SSS3.p3.4.m3.2" class="ltx_Math" alttext="{\bf b}_{s},{\bf b^{\prime}}_{a}\in\mathbb{R}^{N}" display="inline"><semantics id="S3.SS1.SSS3.p3.4.m3.2a"><mrow id="S3.SS1.SSS3.p3.4.m3.2.2" xref="S3.SS1.SSS3.p3.4.m3.2.2.cmml"><mrow id="S3.SS1.SSS3.p3.4.m3.2.2.2.2" xref="S3.SS1.SSS3.p3.4.m3.2.2.2.3.cmml"><msub id="S3.SS1.SSS3.p3.4.m3.1.1.1.1.1" xref="S3.SS1.SSS3.p3.4.m3.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS3.p3.4.m3.1.1.1.1.1.2" xref="S3.SS1.SSS3.p3.4.m3.1.1.1.1.1.2.cmml">𝐛</mi><mi id="S3.SS1.SSS3.p3.4.m3.1.1.1.1.1.3" xref="S3.SS1.SSS3.p3.4.m3.1.1.1.1.1.3.cmml">s</mi></msub><mo id="S3.SS1.SSS3.p3.4.m3.2.2.2.2.3" xref="S3.SS1.SSS3.p3.4.m3.2.2.2.3.cmml">,</mo><mmultiscripts id="S3.SS1.SSS3.p3.4.m3.2.2.2.2.2" xref="S3.SS1.SSS3.p3.4.m3.2.2.2.2.2.cmml"><mi id="S3.SS1.SSS3.p3.4.m3.2.2.2.2.2.2.2" xref="S3.SS1.SSS3.p3.4.m3.2.2.2.2.2.2.2.cmml">𝐛</mi><mrow id="S3.SS1.SSS3.p3.4.m3.2.2.2.2.2a" xref="S3.SS1.SSS3.p3.4.m3.2.2.2.2.2.cmml"></mrow><mo id="S3.SS1.SSS3.p3.4.m3.2.2.2.2.2.2.3" xref="S3.SS1.SSS3.p3.4.m3.2.2.2.2.2.2.3.cmml">′</mo><mi id="S3.SS1.SSS3.p3.4.m3.2.2.2.2.2.3" xref="S3.SS1.SSS3.p3.4.m3.2.2.2.2.2.3.cmml">a</mi><mrow id="S3.SS1.SSS3.p3.4.m3.2.2.2.2.2b" xref="S3.SS1.SSS3.p3.4.m3.2.2.2.2.2.cmml"></mrow></mmultiscripts></mrow><mo id="S3.SS1.SSS3.p3.4.m3.2.2.3" xref="S3.SS1.SSS3.p3.4.m3.2.2.3.cmml">∈</mo><msup id="S3.SS1.SSS3.p3.4.m3.2.2.4" xref="S3.SS1.SSS3.p3.4.m3.2.2.4.cmml"><mi id="S3.SS1.SSS3.p3.4.m3.2.2.4.2" xref="S3.SS1.SSS3.p3.4.m3.2.2.4.2.cmml">ℝ</mi><mi id="S3.SS1.SSS3.p3.4.m3.2.2.4.3" xref="S3.SS1.SSS3.p3.4.m3.2.2.4.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p3.4.m3.2b"><apply id="S3.SS1.SSS3.p3.4.m3.2.2.cmml" xref="S3.SS1.SSS3.p3.4.m3.2.2"><in id="S3.SS1.SSS3.p3.4.m3.2.2.3.cmml" xref="S3.SS1.SSS3.p3.4.m3.2.2.3"></in><list id="S3.SS1.SSS3.p3.4.m3.2.2.2.3.cmml" xref="S3.SS1.SSS3.p3.4.m3.2.2.2.2"><apply id="S3.SS1.SSS3.p3.4.m3.1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p3.4.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.4.m3.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p3.4.m3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p3.4.m3.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS3.p3.4.m3.1.1.1.1.1.2">𝐛</ci><ci id="S3.SS1.SSS3.p3.4.m3.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS3.p3.4.m3.1.1.1.1.1.3">𝑠</ci></apply><apply id="S3.SS1.SSS3.p3.4.m3.2.2.2.2.2.cmml" xref="S3.SS1.SSS3.p3.4.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.4.m3.2.2.2.2.2.1.cmml" xref="S3.SS1.SSS3.p3.4.m3.2.2.2.2.2">subscript</csymbol><apply id="S3.SS1.SSS3.p3.4.m3.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS3.p3.4.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.4.m3.2.2.2.2.2.2.1.cmml" xref="S3.SS1.SSS3.p3.4.m3.2.2.2.2.2">superscript</csymbol><ci id="S3.SS1.SSS3.p3.4.m3.2.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS3.p3.4.m3.2.2.2.2.2.2.2">𝐛</ci><ci id="S3.SS1.SSS3.p3.4.m3.2.2.2.2.2.2.3.cmml" xref="S3.SS1.SSS3.p3.4.m3.2.2.2.2.2.2.3">′</ci></apply><ci id="S3.SS1.SSS3.p3.4.m3.2.2.2.2.2.3.cmml" xref="S3.SS1.SSS3.p3.4.m3.2.2.2.2.2.3">𝑎</ci></apply></list><apply id="S3.SS1.SSS3.p3.4.m3.2.2.4.cmml" xref="S3.SS1.SSS3.p3.4.m3.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.4.m3.2.2.4.1.cmml" xref="S3.SS1.SSS3.p3.4.m3.2.2.4">superscript</csymbol><ci id="S3.SS1.SSS3.p3.4.m3.2.2.4.2.cmml" xref="S3.SS1.SSS3.p3.4.m3.2.2.4.2">ℝ</ci><ci id="S3.SS1.SSS3.p3.4.m3.2.2.4.3.cmml" xref="S3.SS1.SSS3.p3.4.m3.2.2.4.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p3.4.m3.2c">{\bf b}_{s},{\bf b^{\prime}}_{a}\in\mathbb{R}^{N}</annotation></semantics></math>,
and <math id="S3.SS1.SSS3.p3.5.m4.1" class="ltx_Math" alttext="U^{\prime}_{a}\in\mathbb{R}^{N\times H}" display="inline"><semantics id="S3.SS1.SSS3.p3.5.m4.1a"><mrow id="S3.SS1.SSS3.p3.5.m4.1.1" xref="S3.SS1.SSS3.p3.5.m4.1.1.cmml"><msubsup id="S3.SS1.SSS3.p3.5.m4.1.1.2" xref="S3.SS1.SSS3.p3.5.m4.1.1.2.cmml"><mi id="S3.SS1.SSS3.p3.5.m4.1.1.2.2.2" xref="S3.SS1.SSS3.p3.5.m4.1.1.2.2.2.cmml">U</mi><mi id="S3.SS1.SSS3.p3.5.m4.1.1.2.3" xref="S3.SS1.SSS3.p3.5.m4.1.1.2.3.cmml">a</mi><mo id="S3.SS1.SSS3.p3.5.m4.1.1.2.2.3" xref="S3.SS1.SSS3.p3.5.m4.1.1.2.2.3.cmml">′</mo></msubsup><mo id="S3.SS1.SSS3.p3.5.m4.1.1.1" xref="S3.SS1.SSS3.p3.5.m4.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS3.p3.5.m4.1.1.3" xref="S3.SS1.SSS3.p3.5.m4.1.1.3.cmml"><mi id="S3.SS1.SSS3.p3.5.m4.1.1.3.2" xref="S3.SS1.SSS3.p3.5.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS3.p3.5.m4.1.1.3.3" xref="S3.SS1.SSS3.p3.5.m4.1.1.3.3.cmml"><mi id="S3.SS1.SSS3.p3.5.m4.1.1.3.3.2" xref="S3.SS1.SSS3.p3.5.m4.1.1.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS3.p3.5.m4.1.1.3.3.1" xref="S3.SS1.SSS3.p3.5.m4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.SSS3.p3.5.m4.1.1.3.3.3" xref="S3.SS1.SSS3.p3.5.m4.1.1.3.3.3.cmml">H</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p3.5.m4.1b"><apply id="S3.SS1.SSS3.p3.5.m4.1.1.cmml" xref="S3.SS1.SSS3.p3.5.m4.1.1"><in id="S3.SS1.SSS3.p3.5.m4.1.1.1.cmml" xref="S3.SS1.SSS3.p3.5.m4.1.1.1"></in><apply id="S3.SS1.SSS3.p3.5.m4.1.1.2.cmml" xref="S3.SS1.SSS3.p3.5.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.5.m4.1.1.2.1.cmml" xref="S3.SS1.SSS3.p3.5.m4.1.1.2">subscript</csymbol><apply id="S3.SS1.SSS3.p3.5.m4.1.1.2.2.cmml" xref="S3.SS1.SSS3.p3.5.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.5.m4.1.1.2.2.1.cmml" xref="S3.SS1.SSS3.p3.5.m4.1.1.2">superscript</csymbol><ci id="S3.SS1.SSS3.p3.5.m4.1.1.2.2.2.cmml" xref="S3.SS1.SSS3.p3.5.m4.1.1.2.2.2">𝑈</ci><ci id="S3.SS1.SSS3.p3.5.m4.1.1.2.2.3.cmml" xref="S3.SS1.SSS3.p3.5.m4.1.1.2.2.3">′</ci></apply><ci id="S3.SS1.SSS3.p3.5.m4.1.1.2.3.cmml" xref="S3.SS1.SSS3.p3.5.m4.1.1.2.3">𝑎</ci></apply><apply id="S3.SS1.SSS3.p3.5.m4.1.1.3.cmml" xref="S3.SS1.SSS3.p3.5.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.5.m4.1.1.3.1.cmml" xref="S3.SS1.SSS3.p3.5.m4.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS3.p3.5.m4.1.1.3.2.cmml" xref="S3.SS1.SSS3.p3.5.m4.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS3.p3.5.m4.1.1.3.3.cmml" xref="S3.SS1.SSS3.p3.5.m4.1.1.3.3"><times id="S3.SS1.SSS3.p3.5.m4.1.1.3.3.1.cmml" xref="S3.SS1.SSS3.p3.5.m4.1.1.3.3.1"></times><ci id="S3.SS1.SSS3.p3.5.m4.1.1.3.3.2.cmml" xref="S3.SS1.SSS3.p3.5.m4.1.1.3.3.2">𝑁</ci><ci id="S3.SS1.SSS3.p3.5.m4.1.1.3.3.3.cmml" xref="S3.SS1.SSS3.p3.5.m4.1.1.3.3.3">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p3.5.m4.1c">U^{\prime}_{a}\in\mathbb{R}^{N\times H}</annotation></semantics></math>
are the model parameters.
The attended semantic features,
<math id="S3.SS1.SSS3.p3.6.m5.1" class="ltx_Math" alttext="{\bf\hat{c}}_{s}" display="inline"><semantics id="S3.SS1.SSS3.p3.6.m5.1a"><msub id="S3.SS1.SSS3.p3.6.m5.1.1" xref="S3.SS1.SSS3.p3.6.m5.1.1.cmml"><mover accent="true" id="S3.SS1.SSS3.p3.6.m5.1.1.2" xref="S3.SS1.SSS3.p3.6.m5.1.1.2.cmml"><mi id="S3.SS1.SSS3.p3.6.m5.1.1.2.2" xref="S3.SS1.SSS3.p3.6.m5.1.1.2.2.cmml">𝐜</mi><mo id="S3.SS1.SSS3.p3.6.m5.1.1.2.1" xref="S3.SS1.SSS3.p3.6.m5.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS1.SSS3.p3.6.m5.1.1.3" xref="S3.SS1.SSS3.p3.6.m5.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p3.6.m5.1b"><apply id="S3.SS1.SSS3.p3.6.m5.1.1.cmml" xref="S3.SS1.SSS3.p3.6.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.6.m5.1.1.1.cmml" xref="S3.SS1.SSS3.p3.6.m5.1.1">subscript</csymbol><apply id="S3.SS1.SSS3.p3.6.m5.1.1.2.cmml" xref="S3.SS1.SSS3.p3.6.m5.1.1.2"><ci id="S3.SS1.SSS3.p3.6.m5.1.1.2.1.cmml" xref="S3.SS1.SSS3.p3.6.m5.1.1.2.1">^</ci><ci id="S3.SS1.SSS3.p3.6.m5.1.1.2.2.cmml" xref="S3.SS1.SSS3.p3.6.m5.1.1.2.2">𝐜</ci></apply><ci id="S3.SS1.SSS3.p3.6.m5.1.1.3.cmml" xref="S3.SS1.SSS3.p3.6.m5.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p3.6.m5.1c">{\bf\hat{c}}_{s}</annotation></semantics></math>, is then computed as:</p>
<table id="S5.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5.m1.4" class="ltx_Math" alttext="\displaystyle{\bf\beta}_{s}=\mbox{softmax}({\bf\alpha}_{s}),\qquad{\bf\hat{c}}_{s}=\sum_{i=1}^{i=k}\beta_{i,s}{\bf s}_{i}" display="inline"><semantics id="S3.E5.m1.4a"><mrow id="S3.E5.m1.4.4.2" xref="S3.E5.m1.4.4.3.cmml"><mrow id="S3.E5.m1.3.3.1.1" xref="S3.E5.m1.3.3.1.1.cmml"><msub id="S3.E5.m1.3.3.1.1.3" xref="S3.E5.m1.3.3.1.1.3.cmml"><mi id="S3.E5.m1.3.3.1.1.3.2" xref="S3.E5.m1.3.3.1.1.3.2.cmml">β</mi><mi id="S3.E5.m1.3.3.1.1.3.3" xref="S3.E5.m1.3.3.1.1.3.3.cmml">s</mi></msub><mo id="S3.E5.m1.3.3.1.1.2" xref="S3.E5.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E5.m1.3.3.1.1.1" xref="S3.E5.m1.3.3.1.1.1.cmml"><mtext id="S3.E5.m1.3.3.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.3a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.3.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.3.3.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.3.3.1.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E5.m1.3.3.1.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.3.3.1.1.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.1.1.2.cmml">α</mi><mi id="S3.E5.m1.3.3.1.1.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="S3.E5.m1.3.3.1.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="2.167em" id="S3.E5.m1.4.4.2.3" xref="S3.E5.m1.4.4.3a.cmml">,</mo><mrow id="S3.E5.m1.4.4.2.2" xref="S3.E5.m1.4.4.2.2.cmml"><msub id="S3.E5.m1.4.4.2.2.2" xref="S3.E5.m1.4.4.2.2.2.cmml"><mover accent="true" id="S3.E5.m1.4.4.2.2.2.2" xref="S3.E5.m1.4.4.2.2.2.2.cmml"><mi id="S3.E5.m1.4.4.2.2.2.2.2" xref="S3.E5.m1.4.4.2.2.2.2.2.cmml">𝐜</mi><mo id="S3.E5.m1.4.4.2.2.2.2.1" xref="S3.E5.m1.4.4.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.4.4.2.2.2.3" xref="S3.E5.m1.4.4.2.2.2.3.cmml">s</mi></msub><mo id="S3.E5.m1.4.4.2.2.1" xref="S3.E5.m1.4.4.2.2.1.cmml">=</mo><mrow id="S3.E5.m1.4.4.2.2.3" xref="S3.E5.m1.4.4.2.2.3.cmml"><mstyle displaystyle="true" id="S3.E5.m1.4.4.2.2.3.1" xref="S3.E5.m1.4.4.2.2.3.1.cmml"><munderover id="S3.E5.m1.4.4.2.2.3.1a" xref="S3.E5.m1.4.4.2.2.3.1.cmml"><mo movablelimits="false" id="S3.E5.m1.4.4.2.2.3.1.2.2" xref="S3.E5.m1.4.4.2.2.3.1.2.2.cmml">∑</mo><mrow id="S3.E5.m1.4.4.2.2.3.1.2.3" xref="S3.E5.m1.4.4.2.2.3.1.2.3.cmml"><mi id="S3.E5.m1.4.4.2.2.3.1.2.3.2" xref="S3.E5.m1.4.4.2.2.3.1.2.3.2.cmml">i</mi><mo id="S3.E5.m1.4.4.2.2.3.1.2.3.1" xref="S3.E5.m1.4.4.2.2.3.1.2.3.1.cmml">=</mo><mn id="S3.E5.m1.4.4.2.2.3.1.2.3.3" xref="S3.E5.m1.4.4.2.2.3.1.2.3.3.cmml">1</mn></mrow><mrow id="S3.E5.m1.4.4.2.2.3.1.3" xref="S3.E5.m1.4.4.2.2.3.1.3.cmml"><mi id="S3.E5.m1.4.4.2.2.3.1.3.2" xref="S3.E5.m1.4.4.2.2.3.1.3.2.cmml">i</mi><mo id="S3.E5.m1.4.4.2.2.3.1.3.1" xref="S3.E5.m1.4.4.2.2.3.1.3.1.cmml">=</mo><mi id="S3.E5.m1.4.4.2.2.3.1.3.3" xref="S3.E5.m1.4.4.2.2.3.1.3.3.cmml">k</mi></mrow></munderover></mstyle><mrow id="S3.E5.m1.4.4.2.2.3.2" xref="S3.E5.m1.4.4.2.2.3.2.cmml"><msub id="S3.E5.m1.4.4.2.2.3.2.2" xref="S3.E5.m1.4.4.2.2.3.2.2.cmml"><mi id="S3.E5.m1.4.4.2.2.3.2.2.2" xref="S3.E5.m1.4.4.2.2.3.2.2.2.cmml">β</mi><mrow id="S3.E5.m1.2.2.2.4" xref="S3.E5.m1.2.2.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">i</mi><mo id="S3.E5.m1.2.2.2.4.1" xref="S3.E5.m1.2.2.2.3.cmml">,</mo><mi id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.2.cmml">s</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.4.4.2.2.3.2.1" xref="S3.E5.m1.4.4.2.2.3.2.1.cmml">​</mo><msub id="S3.E5.m1.4.4.2.2.3.2.3" xref="S3.E5.m1.4.4.2.2.3.2.3.cmml"><mi id="S3.E5.m1.4.4.2.2.3.2.3.2" xref="S3.E5.m1.4.4.2.2.3.2.3.2.cmml">𝐬</mi><mi id="S3.E5.m1.4.4.2.2.3.2.3.3" xref="S3.E5.m1.4.4.2.2.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.4b"><apply id="S3.E5.m1.4.4.3.cmml" xref="S3.E5.m1.4.4.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.3a.cmml" xref="S3.E5.m1.4.4.2.3">formulae-sequence</csymbol><apply id="S3.E5.m1.3.3.1.1.cmml" xref="S3.E5.m1.3.3.1.1"><eq id="S3.E5.m1.3.3.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.2"></eq><apply id="S3.E5.m1.3.3.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.3.1.cmml" xref="S3.E5.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.3.2.cmml" xref="S3.E5.m1.3.3.1.1.3.2">𝛽</ci><ci id="S3.E5.m1.3.3.1.1.3.3.cmml" xref="S3.E5.m1.3.3.1.1.3.3">𝑠</ci></apply><apply id="S3.E5.m1.3.3.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1"><times id="S3.E5.m1.3.3.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.2"></times><ci id="S3.E5.m1.3.3.1.1.1.3a.cmml" xref="S3.E5.m1.3.3.1.1.1.3"><mtext id="S3.E5.m1.3.3.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.1.3">softmax</mtext></ci><apply id="S3.E5.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.2">𝛼</ci><ci id="S3.E5.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply><apply id="S3.E5.m1.4.4.2.2.cmml" xref="S3.E5.m1.4.4.2.2"><eq id="S3.E5.m1.4.4.2.2.1.cmml" xref="S3.E5.m1.4.4.2.2.1"></eq><apply id="S3.E5.m1.4.4.2.2.2.cmml" xref="S3.E5.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.2.2.2.1.cmml" xref="S3.E5.m1.4.4.2.2.2">subscript</csymbol><apply id="S3.E5.m1.4.4.2.2.2.2.cmml" xref="S3.E5.m1.4.4.2.2.2.2"><ci id="S3.E5.m1.4.4.2.2.2.2.1.cmml" xref="S3.E5.m1.4.4.2.2.2.2.1">^</ci><ci id="S3.E5.m1.4.4.2.2.2.2.2.cmml" xref="S3.E5.m1.4.4.2.2.2.2.2">𝐜</ci></apply><ci id="S3.E5.m1.4.4.2.2.2.3.cmml" xref="S3.E5.m1.4.4.2.2.2.3">𝑠</ci></apply><apply id="S3.E5.m1.4.4.2.2.3.cmml" xref="S3.E5.m1.4.4.2.2.3"><apply id="S3.E5.m1.4.4.2.2.3.1.cmml" xref="S3.E5.m1.4.4.2.2.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.2.2.3.1.1.cmml" xref="S3.E5.m1.4.4.2.2.3.1">superscript</csymbol><apply id="S3.E5.m1.4.4.2.2.3.1.2.cmml" xref="S3.E5.m1.4.4.2.2.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.2.2.3.1.2.1.cmml" xref="S3.E5.m1.4.4.2.2.3.1">subscript</csymbol><sum id="S3.E5.m1.4.4.2.2.3.1.2.2.cmml" xref="S3.E5.m1.4.4.2.2.3.1.2.2"></sum><apply id="S3.E5.m1.4.4.2.2.3.1.2.3.cmml" xref="S3.E5.m1.4.4.2.2.3.1.2.3"><eq id="S3.E5.m1.4.4.2.2.3.1.2.3.1.cmml" xref="S3.E5.m1.4.4.2.2.3.1.2.3.1"></eq><ci id="S3.E5.m1.4.4.2.2.3.1.2.3.2.cmml" xref="S3.E5.m1.4.4.2.2.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E5.m1.4.4.2.2.3.1.2.3.3.cmml" xref="S3.E5.m1.4.4.2.2.3.1.2.3.3">1</cn></apply></apply><apply id="S3.E5.m1.4.4.2.2.3.1.3.cmml" xref="S3.E5.m1.4.4.2.2.3.1.3"><eq id="S3.E5.m1.4.4.2.2.3.1.3.1.cmml" xref="S3.E5.m1.4.4.2.2.3.1.3.1"></eq><ci id="S3.E5.m1.4.4.2.2.3.1.3.2.cmml" xref="S3.E5.m1.4.4.2.2.3.1.3.2">𝑖</ci><ci id="S3.E5.m1.4.4.2.2.3.1.3.3.cmml" xref="S3.E5.m1.4.4.2.2.3.1.3.3">𝑘</ci></apply></apply><apply id="S3.E5.m1.4.4.2.2.3.2.cmml" xref="S3.E5.m1.4.4.2.2.3.2"><times id="S3.E5.m1.4.4.2.2.3.2.1.cmml" xref="S3.E5.m1.4.4.2.2.3.2.1"></times><apply id="S3.E5.m1.4.4.2.2.3.2.2.cmml" xref="S3.E5.m1.4.4.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.2.2.3.2.2.1.cmml" xref="S3.E5.m1.4.4.2.2.3.2.2">subscript</csymbol><ci id="S3.E5.m1.4.4.2.2.3.2.2.2.cmml" xref="S3.E5.m1.4.4.2.2.3.2.2.2">𝛽</ci><list id="S3.E5.m1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.4"><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">𝑖</ci><ci id="S3.E5.m1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2">𝑠</ci></list></apply><apply id="S3.E5.m1.4.4.2.2.3.2.3.cmml" xref="S3.E5.m1.4.4.2.2.3.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.2.2.3.2.3.1.cmml" xref="S3.E5.m1.4.4.2.2.3.2.3">subscript</csymbol><ci id="S3.E5.m1.4.4.2.2.3.2.3.2.cmml" xref="S3.E5.m1.4.4.2.2.3.2.3.2">𝐬</ci><ci id="S3.E5.m1.4.4.2.2.3.2.3.3.cmml" xref="S3.E5.m1.4.4.2.2.3.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.4c">\displaystyle{\bf\beta}_{s}=\mbox{softmax}({\bf\alpha}_{s}),\qquad{\bf\hat{c}}_{s}=\sum_{i=1}^{i=k}\beta_{i,s}{\bf s}_{i}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS3.p3.7" class="ltx_p">The attended visual and semantic features are then concatenated to form the input features,
<math id="S3.SS1.SSS3.p3.7.m1.2" class="ltx_Math" alttext="att_{0}=[{\bf\hat{c}}_{v};{\bf\hat{c}}_{s}]" display="inline"><semantics id="S3.SS1.SSS3.p3.7.m1.2a"><mrow id="S3.SS1.SSS3.p3.7.m1.2.2" xref="S3.SS1.SSS3.p3.7.m1.2.2.cmml"><mrow id="S3.SS1.SSS3.p3.7.m1.2.2.4" xref="S3.SS1.SSS3.p3.7.m1.2.2.4.cmml"><mi id="S3.SS1.SSS3.p3.7.m1.2.2.4.2" xref="S3.SS1.SSS3.p3.7.m1.2.2.4.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.p3.7.m1.2.2.4.1" xref="S3.SS1.SSS3.p3.7.m1.2.2.4.1.cmml">​</mo><mi id="S3.SS1.SSS3.p3.7.m1.2.2.4.3" xref="S3.SS1.SSS3.p3.7.m1.2.2.4.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.p3.7.m1.2.2.4.1a" xref="S3.SS1.SSS3.p3.7.m1.2.2.4.1.cmml">​</mo><msub id="S3.SS1.SSS3.p3.7.m1.2.2.4.4" xref="S3.SS1.SSS3.p3.7.m1.2.2.4.4.cmml"><mi id="S3.SS1.SSS3.p3.7.m1.2.2.4.4.2" xref="S3.SS1.SSS3.p3.7.m1.2.2.4.4.2.cmml">t</mi><mn id="S3.SS1.SSS3.p3.7.m1.2.2.4.4.3" xref="S3.SS1.SSS3.p3.7.m1.2.2.4.4.3.cmml">0</mn></msub></mrow><mo id="S3.SS1.SSS3.p3.7.m1.2.2.3" xref="S3.SS1.SSS3.p3.7.m1.2.2.3.cmml">=</mo><mrow id="S3.SS1.SSS3.p3.7.m1.2.2.2.2" xref="S3.SS1.SSS3.p3.7.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.SSS3.p3.7.m1.2.2.2.2.3" xref="S3.SS1.SSS3.p3.7.m1.2.2.2.3.cmml">[</mo><msub id="S3.SS1.SSS3.p3.7.m1.1.1.1.1.1" xref="S3.SS1.SSS3.p3.7.m1.1.1.1.1.1.cmml"><mover accent="true" id="S3.SS1.SSS3.p3.7.m1.1.1.1.1.1.2" xref="S3.SS1.SSS3.p3.7.m1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.SSS3.p3.7.m1.1.1.1.1.1.2.2" xref="S3.SS1.SSS3.p3.7.m1.1.1.1.1.1.2.2.cmml">𝐜</mi><mo id="S3.SS1.SSS3.p3.7.m1.1.1.1.1.1.2.1" xref="S3.SS1.SSS3.p3.7.m1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS1.SSS3.p3.7.m1.1.1.1.1.1.3" xref="S3.SS1.SSS3.p3.7.m1.1.1.1.1.1.3.cmml">v</mi></msub><mo id="S3.SS1.SSS3.p3.7.m1.2.2.2.2.4" xref="S3.SS1.SSS3.p3.7.m1.2.2.2.3.cmml">;</mo><msub id="S3.SS1.SSS3.p3.7.m1.2.2.2.2.2" xref="S3.SS1.SSS3.p3.7.m1.2.2.2.2.2.cmml"><mover accent="true" id="S3.SS1.SSS3.p3.7.m1.2.2.2.2.2.2" xref="S3.SS1.SSS3.p3.7.m1.2.2.2.2.2.2.cmml"><mi id="S3.SS1.SSS3.p3.7.m1.2.2.2.2.2.2.2" xref="S3.SS1.SSS3.p3.7.m1.2.2.2.2.2.2.2.cmml">𝐜</mi><mo id="S3.SS1.SSS3.p3.7.m1.2.2.2.2.2.2.1" xref="S3.SS1.SSS3.p3.7.m1.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS1.SSS3.p3.7.m1.2.2.2.2.2.3" xref="S3.SS1.SSS3.p3.7.m1.2.2.2.2.2.3.cmml">s</mi></msub><mo stretchy="false" id="S3.SS1.SSS3.p3.7.m1.2.2.2.2.5" xref="S3.SS1.SSS3.p3.7.m1.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p3.7.m1.2b"><apply id="S3.SS1.SSS3.p3.7.m1.2.2.cmml" xref="S3.SS1.SSS3.p3.7.m1.2.2"><eq id="S3.SS1.SSS3.p3.7.m1.2.2.3.cmml" xref="S3.SS1.SSS3.p3.7.m1.2.2.3"></eq><apply id="S3.SS1.SSS3.p3.7.m1.2.2.4.cmml" xref="S3.SS1.SSS3.p3.7.m1.2.2.4"><times id="S3.SS1.SSS3.p3.7.m1.2.2.4.1.cmml" xref="S3.SS1.SSS3.p3.7.m1.2.2.4.1"></times><ci id="S3.SS1.SSS3.p3.7.m1.2.2.4.2.cmml" xref="S3.SS1.SSS3.p3.7.m1.2.2.4.2">𝑎</ci><ci id="S3.SS1.SSS3.p3.7.m1.2.2.4.3.cmml" xref="S3.SS1.SSS3.p3.7.m1.2.2.4.3">𝑡</ci><apply id="S3.SS1.SSS3.p3.7.m1.2.2.4.4.cmml" xref="S3.SS1.SSS3.p3.7.m1.2.2.4.4"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.7.m1.2.2.4.4.1.cmml" xref="S3.SS1.SSS3.p3.7.m1.2.2.4.4">subscript</csymbol><ci id="S3.SS1.SSS3.p3.7.m1.2.2.4.4.2.cmml" xref="S3.SS1.SSS3.p3.7.m1.2.2.4.4.2">𝑡</ci><cn type="integer" id="S3.SS1.SSS3.p3.7.m1.2.2.4.4.3.cmml" xref="S3.SS1.SSS3.p3.7.m1.2.2.4.4.3">0</cn></apply></apply><list id="S3.SS1.SSS3.p3.7.m1.2.2.2.3.cmml" xref="S3.SS1.SSS3.p3.7.m1.2.2.2.2"><apply id="S3.SS1.SSS3.p3.7.m1.1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p3.7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.7.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p3.7.m1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS1.SSS3.p3.7.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS3.p3.7.m1.1.1.1.1.1.2"><ci id="S3.SS1.SSS3.p3.7.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.SSS3.p3.7.m1.1.1.1.1.1.2.1">^</ci><ci id="S3.SS1.SSS3.p3.7.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.SSS3.p3.7.m1.1.1.1.1.1.2.2">𝐜</ci></apply><ci id="S3.SS1.SSS3.p3.7.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS3.p3.7.m1.1.1.1.1.1.3">𝑣</ci></apply><apply id="S3.SS1.SSS3.p3.7.m1.2.2.2.2.2.cmml" xref="S3.SS1.SSS3.p3.7.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.7.m1.2.2.2.2.2.1.cmml" xref="S3.SS1.SSS3.p3.7.m1.2.2.2.2.2">subscript</csymbol><apply id="S3.SS1.SSS3.p3.7.m1.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS3.p3.7.m1.2.2.2.2.2.2"><ci id="S3.SS1.SSS3.p3.7.m1.2.2.2.2.2.2.1.cmml" xref="S3.SS1.SSS3.p3.7.m1.2.2.2.2.2.2.1">^</ci><ci id="S3.SS1.SSS3.p3.7.m1.2.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS3.p3.7.m1.2.2.2.2.2.2.2">𝐜</ci></apply><ci id="S3.SS1.SSS3.p3.7.m1.2.2.2.2.2.3.cmml" xref="S3.SS1.SSS3.p3.7.m1.2.2.2.2.2.3">𝑠</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p3.7.m1.2c">att_{0}=[{\bf\hat{c}}_{v};{\bf\hat{c}}_{s}]</annotation></semantics></math>, for the partial question encoding GRU.</p>
</div>
</section>
<section id="S3.SS1.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.4 </span>Multi-Modal Feature Fusion</h4>

<div id="S3.SS1.SSS4.p1" class="ltx_para">
<p id="S3.SS1.SSS4.p1.2" class="ltx_p">To capture complex interactions between the image and answer cue,
we use a multi-modal factorized bilinear pooling (MFB) operation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>
to fuse the image and answer representation vectors.
MFB is developed
to reduce the computational cost of the standard bilinear-pooling operation between question and visual features
for visual question answering.
We adopt MFB to fuse the answer encoding vector <math id="S3.SS1.SSS4.p1.1.m1.1" class="ltx_Math" alttext="{\bf a}" display="inline"><semantics id="S3.SS1.SSS4.p1.1.m1.1a"><mi id="S3.SS1.SSS4.p1.1.m1.1.1" xref="S3.SS1.SSS4.p1.1.m1.1.1.cmml">𝐚</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.1.m1.1b"><ci id="S3.SS1.SSS4.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS4.p1.1.m1.1.1">𝐚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.1.m1.1c">{\bf a}</annotation></semantics></math> and
the enhanced image representation <math id="S3.SS1.SSS4.p1.2.m2.1" class="ltx_Math" alttext="E_{v}" display="inline"><semantics id="S3.SS1.SSS4.p1.2.m2.1a"><msub id="S3.SS1.SSS4.p1.2.m2.1.1" xref="S3.SS1.SSS4.p1.2.m2.1.1.cmml"><mi id="S3.SS1.SSS4.p1.2.m2.1.1.2" xref="S3.SS1.SSS4.p1.2.m2.1.1.2.cmml">E</mi><mi id="S3.SS1.SSS4.p1.2.m2.1.1.3" xref="S3.SS1.SSS4.p1.2.m2.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.2.m2.1b"><apply id="S3.SS1.SSS4.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS4.p1.2.m2.1.1.1.cmml" xref="S3.SS1.SSS4.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS4.p1.2.m2.1.1.2.cmml" xref="S3.SS1.SSS4.p1.2.m2.1.1.2">𝐸</ci><ci id="S3.SS1.SSS4.p1.2.m2.1.1.3.cmml" xref="S3.SS1.SSS4.p1.2.m2.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.2.m2.1c">E_{v}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.SSS4.p2" class="ltx_para">
<p id="S3.SS1.SSS4.p2.3" class="ltx_p">MFB is a two-step algorithm with the expansion and squeeze steps.
For each enhanced visual feature vector
<math id="S3.SS1.SSS4.p2.1.m1.1" class="ltx_Math" alttext="E_{vi}" display="inline"><semantics id="S3.SS1.SSS4.p2.1.m1.1a"><msub id="S3.SS1.SSS4.p2.1.m1.1.1" xref="S3.SS1.SSS4.p2.1.m1.1.1.cmml"><mi id="S3.SS1.SSS4.p2.1.m1.1.1.2" xref="S3.SS1.SSS4.p2.1.m1.1.1.2.cmml">E</mi><mrow id="S3.SS1.SSS4.p2.1.m1.1.1.3" xref="S3.SS1.SSS4.p2.1.m1.1.1.3.cmml"><mi id="S3.SS1.SSS4.p2.1.m1.1.1.3.2" xref="S3.SS1.SSS4.p2.1.m1.1.1.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS4.p2.1.m1.1.1.3.1" xref="S3.SS1.SSS4.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS4.p2.1.m1.1.1.3.3" xref="S3.SS1.SSS4.p2.1.m1.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p2.1.m1.1b"><apply id="S3.SS1.SSS4.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS4.p2.1.m1.1.1.1.cmml" xref="S3.SS1.SSS4.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS4.p2.1.m1.1.1.2.cmml" xref="S3.SS1.SSS4.p2.1.m1.1.1.2">𝐸</ci><apply id="S3.SS1.SSS4.p2.1.m1.1.1.3.cmml" xref="S3.SS1.SSS4.p2.1.m1.1.1.3"><times id="S3.SS1.SSS4.p2.1.m1.1.1.3.1.cmml" xref="S3.SS1.SSS4.p2.1.m1.1.1.3.1"></times><ci id="S3.SS1.SSS4.p2.1.m1.1.1.3.2.cmml" xref="S3.SS1.SSS4.p2.1.m1.1.1.3.2">𝑣</ci><ci id="S3.SS1.SSS4.p2.1.m1.1.1.3.3.cmml" xref="S3.SS1.SSS4.p2.1.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p2.1.m1.1c">E_{vi}</annotation></semantics></math> and the answer encoding vector <math id="S3.SS1.SSS4.p2.2.m2.1" class="ltx_Math" alttext="{\bf a}" display="inline"><semantics id="S3.SS1.SSS4.p2.2.m2.1a"><mi id="S3.SS1.SSS4.p2.2.m2.1.1" xref="S3.SS1.SSS4.p2.2.m2.1.1.cmml">𝐚</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p2.2.m2.1b"><ci id="S3.SS1.SSS4.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS4.p2.2.m2.1.1">𝐚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p2.2.m2.1c">{\bf a}</annotation></semantics></math>,
we first project them into high dimensional space to fuse
and then squeeze the fused vector using
a sum pooling operation with window size <math id="S3.SS1.SSS4.p2.3.m3.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS1.SSS4.p2.3.m3.1a"><mi id="S3.SS1.SSS4.p2.3.m3.1.1" xref="S3.SS1.SSS4.p2.3.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p2.3.m3.1b"><ci id="S3.SS1.SSS4.p2.3.m3.1.1.cmml" xref="S3.SS1.SSS4.p2.3.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p2.3.m3.1c">j</annotation></semantics></math>:</p>
<table id="S5.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E6.m1.1" class="ltx_Math" alttext="\displaystyle{\bf f}_{i}" display="inline"><semantics id="S3.E6.m1.1a"><msub id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><mi id="S3.E6.m1.1.1.2" xref="S3.E6.m1.1.1.2.cmml">𝐟</mi><mi id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1">subscript</csymbol><ci id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1.2">𝐟</ci><ci id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\displaystyle{\bf f}_{i}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E6.m2.1" class="ltx_Math" alttext="\displaystyle=(U_{1}E_{vi}+{\bf b}_{1})\odot(U_{2}{\bf a}+{\bf b}_{2})," display="inline"><semantics id="S3.E6.m2.1a"><mrow id="S3.E6.m2.1.1.1" xref="S3.E6.m2.1.1.1.1.cmml"><mrow id="S3.E6.m2.1.1.1.1" xref="S3.E6.m2.1.1.1.1.cmml"><mi id="S3.E6.m2.1.1.1.1.4" xref="S3.E6.m2.1.1.1.1.4.cmml"></mi><mo id="S3.E6.m2.1.1.1.1.3" xref="S3.E6.m2.1.1.1.1.3.cmml">=</mo><mrow id="S3.E6.m2.1.1.1.1.2" xref="S3.E6.m2.1.1.1.1.2.cmml"><mrow id="S3.E6.m2.1.1.1.1.1.1.1" xref="S3.E6.m2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m2.1.1.1.1.1.1.1.2" xref="S3.E6.m2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m2.1.1.1.1.1.1.1.1" xref="S3.E6.m2.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E6.m2.1.1.1.1.1.1.1.1.2" xref="S3.E6.m2.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E6.m2.1.1.1.1.1.1.1.1.2.2" xref="S3.E6.m2.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E6.m2.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E6.m2.1.1.1.1.1.1.1.1.2.2.2.cmml">U</mi><mn id="S3.E6.m2.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E6.m2.1.1.1.1.1.1.1.1.2.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.E6.m2.1.1.1.1.1.1.1.1.2.1" xref="S3.E6.m2.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E6.m2.1.1.1.1.1.1.1.1.2.3" xref="S3.E6.m2.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E6.m2.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E6.m2.1.1.1.1.1.1.1.1.2.3.2.cmml">E</mi><mrow id="S3.E6.m2.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E6.m2.1.1.1.1.1.1.1.1.2.3.3.cmml"><mi id="S3.E6.m2.1.1.1.1.1.1.1.1.2.3.3.2" xref="S3.E6.m2.1.1.1.1.1.1.1.1.2.3.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.E6.m2.1.1.1.1.1.1.1.1.2.3.3.1" xref="S3.E6.m2.1.1.1.1.1.1.1.1.2.3.3.1.cmml">​</mo><mi id="S3.E6.m2.1.1.1.1.1.1.1.1.2.3.3.3" xref="S3.E6.m2.1.1.1.1.1.1.1.1.2.3.3.3.cmml">i</mi></mrow></msub></mrow><mo id="S3.E6.m2.1.1.1.1.1.1.1.1.1" xref="S3.E6.m2.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E6.m2.1.1.1.1.1.1.1.1.3" xref="S3.E6.m2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m2.1.1.1.1.1.1.1.1.3.2" xref="S3.E6.m2.1.1.1.1.1.1.1.1.3.2.cmml">𝐛</mi><mn id="S3.E6.m2.1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m2.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo rspace="0.055em" stretchy="false" id="S3.E6.m2.1.1.1.1.1.1.1.3" xref="S3.E6.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.E6.m2.1.1.1.1.2.3" xref="S3.E6.m2.1.1.1.1.2.3.cmml">⊙</mo><mrow id="S3.E6.m2.1.1.1.1.2.2.1" xref="S3.E6.m2.1.1.1.1.2.2.1.1.cmml"><mo stretchy="false" id="S3.E6.m2.1.1.1.1.2.2.1.2" xref="S3.E6.m2.1.1.1.1.2.2.1.1.cmml">(</mo><mrow id="S3.E6.m2.1.1.1.1.2.2.1.1" xref="S3.E6.m2.1.1.1.1.2.2.1.1.cmml"><mrow id="S3.E6.m2.1.1.1.1.2.2.1.1.2" xref="S3.E6.m2.1.1.1.1.2.2.1.1.2.cmml"><msub id="S3.E6.m2.1.1.1.1.2.2.1.1.2.2" xref="S3.E6.m2.1.1.1.1.2.2.1.1.2.2.cmml"><mi id="S3.E6.m2.1.1.1.1.2.2.1.1.2.2.2" xref="S3.E6.m2.1.1.1.1.2.2.1.1.2.2.2.cmml">U</mi><mn id="S3.E6.m2.1.1.1.1.2.2.1.1.2.2.3" xref="S3.E6.m2.1.1.1.1.2.2.1.1.2.2.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S3.E6.m2.1.1.1.1.2.2.1.1.2.1" xref="S3.E6.m2.1.1.1.1.2.2.1.1.2.1.cmml">​</mo><mi id="S3.E6.m2.1.1.1.1.2.2.1.1.2.3" xref="S3.E6.m2.1.1.1.1.2.2.1.1.2.3.cmml">𝐚</mi></mrow><mo id="S3.E6.m2.1.1.1.1.2.2.1.1.1" xref="S3.E6.m2.1.1.1.1.2.2.1.1.1.cmml">+</mo><msub id="S3.E6.m2.1.1.1.1.2.2.1.1.3" xref="S3.E6.m2.1.1.1.1.2.2.1.1.3.cmml"><mi id="S3.E6.m2.1.1.1.1.2.2.1.1.3.2" xref="S3.E6.m2.1.1.1.1.2.2.1.1.3.2.cmml">𝐛</mi><mn id="S3.E6.m2.1.1.1.1.2.2.1.1.3.3" xref="S3.E6.m2.1.1.1.1.2.2.1.1.3.3.cmml">2</mn></msub></mrow><mo stretchy="false" id="S3.E6.m2.1.1.1.1.2.2.1.3" xref="S3.E6.m2.1.1.1.1.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m2.1.1.1.2" xref="S3.E6.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m2.1b"><apply id="S3.E6.m2.1.1.1.1.cmml" xref="S3.E6.m2.1.1.1"><eq id="S3.E6.m2.1.1.1.1.3.cmml" xref="S3.E6.m2.1.1.1.1.3"></eq><csymbol cd="latexml" id="S3.E6.m2.1.1.1.1.4.cmml" xref="S3.E6.m2.1.1.1.1.4">absent</csymbol><apply id="S3.E6.m2.1.1.1.1.2.cmml" xref="S3.E6.m2.1.1.1.1.2"><csymbol cd="latexml" id="S3.E6.m2.1.1.1.1.2.3.cmml" xref="S3.E6.m2.1.1.1.1.2.3">direct-product</csymbol><apply id="S3.E6.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1"><plus id="S3.E6.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E6.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.2"><times id="S3.E6.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E6.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E6.m2.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E6.m2.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.2.2.2">𝑈</ci><cn type="integer" id="S3.E6.m2.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.2.2.3">1</cn></apply><apply id="S3.E6.m2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E6.m2.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E6.m2.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.2.3.2">𝐸</ci><apply id="S3.E6.m2.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.2.3.3"><times id="S3.E6.m2.1.1.1.1.1.1.1.1.2.3.3.1.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.2.3.3.1"></times><ci id="S3.E6.m2.1.1.1.1.1.1.1.1.2.3.3.2.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.2.3.3.2">𝑣</ci><ci id="S3.E6.m2.1.1.1.1.1.1.1.1.2.3.3.3.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.2.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E6.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.3.2">𝐛</ci><cn type="integer" id="S3.E6.m2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E6.m2.1.1.1.1.2.2.1.1.cmml" xref="S3.E6.m2.1.1.1.1.2.2.1"><plus id="S3.E6.m2.1.1.1.1.2.2.1.1.1.cmml" xref="S3.E6.m2.1.1.1.1.2.2.1.1.1"></plus><apply id="S3.E6.m2.1.1.1.1.2.2.1.1.2.cmml" xref="S3.E6.m2.1.1.1.1.2.2.1.1.2"><times id="S3.E6.m2.1.1.1.1.2.2.1.1.2.1.cmml" xref="S3.E6.m2.1.1.1.1.2.2.1.1.2.1"></times><apply id="S3.E6.m2.1.1.1.1.2.2.1.1.2.2.cmml" xref="S3.E6.m2.1.1.1.1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S3.E6.m2.1.1.1.1.2.2.1.1.2.2.1.cmml" xref="S3.E6.m2.1.1.1.1.2.2.1.1.2.2">subscript</csymbol><ci id="S3.E6.m2.1.1.1.1.2.2.1.1.2.2.2.cmml" xref="S3.E6.m2.1.1.1.1.2.2.1.1.2.2.2">𝑈</ci><cn type="integer" id="S3.E6.m2.1.1.1.1.2.2.1.1.2.2.3.cmml" xref="S3.E6.m2.1.1.1.1.2.2.1.1.2.2.3">2</cn></apply><ci id="S3.E6.m2.1.1.1.1.2.2.1.1.2.3.cmml" xref="S3.E6.m2.1.1.1.1.2.2.1.1.2.3">𝐚</ci></apply><apply id="S3.E6.m2.1.1.1.1.2.2.1.1.3.cmml" xref="S3.E6.m2.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m2.1.1.1.1.2.2.1.1.3.1.cmml" xref="S3.E6.m2.1.1.1.1.2.2.1.1.3">subscript</csymbol><ci id="S3.E6.m2.1.1.1.1.2.2.1.1.3.2.cmml" xref="S3.E6.m2.1.1.1.1.2.2.1.1.3.2">𝐛</ci><cn type="integer" id="S3.E6.m2.1.1.1.1.2.2.1.1.3.3.cmml" xref="S3.E6.m2.1.1.1.1.2.2.1.1.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m2.1c">\displaystyle=(U_{1}E_{vi}+{\bf b}_{1})\odot(U_{2}{\bf a}+{\bf b}_{2}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
<tbody id="S3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E7.m1.1" class="ltx_Math" alttext="\displaystyle{\bf z}_{i}" display="inline"><semantics id="S3.E7.m1.1a"><msub id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml"><mi id="S3.E7.m1.1.1.2" xref="S3.E7.m1.1.1.2.cmml">𝐳</mi><mi id="S3.E7.m1.1.1.3" xref="S3.E7.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.cmml" xref="S3.E7.m1.1.1">subscript</csymbol><ci id="S3.E7.m1.1.1.2.cmml" xref="S3.E7.m1.1.1.2">𝐳</ci><ci id="S3.E7.m1.1.1.3.cmml" xref="S3.E7.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">\displaystyle{\bf z}_{i}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7.m2.2" class="ltx_Math" alttext="\displaystyle=\mbox{sum-pooling}({\bf f}_{i},j)" display="inline"><semantics id="S3.E7.m2.2a"><mrow id="S3.E7.m2.2.2" xref="S3.E7.m2.2.2.cmml"><mi id="S3.E7.m2.2.2.3" xref="S3.E7.m2.2.2.3.cmml"></mi><mo id="S3.E7.m2.2.2.2" xref="S3.E7.m2.2.2.2.cmml">=</mo><mrow id="S3.E7.m2.2.2.1" xref="S3.E7.m2.2.2.1.cmml"><mtext id="S3.E7.m2.2.2.1.3" xref="S3.E7.m2.2.2.1.3a.cmml">sum-pooling</mtext><mo lspace="0em" rspace="0em" id="S3.E7.m2.2.2.1.2" xref="S3.E7.m2.2.2.1.2.cmml">​</mo><mrow id="S3.E7.m2.2.2.1.1.1" xref="S3.E7.m2.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.E7.m2.2.2.1.1.1.2" xref="S3.E7.m2.2.2.1.1.2.cmml">(</mo><msub id="S3.E7.m2.2.2.1.1.1.1" xref="S3.E7.m2.2.2.1.1.1.1.cmml"><mi id="S3.E7.m2.2.2.1.1.1.1.2" xref="S3.E7.m2.2.2.1.1.1.1.2.cmml">𝐟</mi><mi id="S3.E7.m2.2.2.1.1.1.1.3" xref="S3.E7.m2.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E7.m2.2.2.1.1.1.3" xref="S3.E7.m2.2.2.1.1.2.cmml">,</mo><mi id="S3.E7.m2.1.1" xref="S3.E7.m2.1.1.cmml">j</mi><mo stretchy="false" id="S3.E7.m2.2.2.1.1.1.4" xref="S3.E7.m2.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m2.2b"><apply id="S3.E7.m2.2.2.cmml" xref="S3.E7.m2.2.2"><eq id="S3.E7.m2.2.2.2.cmml" xref="S3.E7.m2.2.2.2"></eq><csymbol cd="latexml" id="S3.E7.m2.2.2.3.cmml" xref="S3.E7.m2.2.2.3">absent</csymbol><apply id="S3.E7.m2.2.2.1.cmml" xref="S3.E7.m2.2.2.1"><times id="S3.E7.m2.2.2.1.2.cmml" xref="S3.E7.m2.2.2.1.2"></times><ci id="S3.E7.m2.2.2.1.3a.cmml" xref="S3.E7.m2.2.2.1.3"><mtext id="S3.E7.m2.2.2.1.3.cmml" xref="S3.E7.m2.2.2.1.3">sum-pooling</mtext></ci><interval closure="open" id="S3.E7.m2.2.2.1.1.2.cmml" xref="S3.E7.m2.2.2.1.1.1"><apply id="S3.E7.m2.2.2.1.1.1.1.cmml" xref="S3.E7.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m2.2.2.1.1.1.1.1.cmml" xref="S3.E7.m2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E7.m2.2.2.1.1.1.1.2.cmml" xref="S3.E7.m2.2.2.1.1.1.1.2">𝐟</ci><ci id="S3.E7.m2.2.2.1.1.1.1.3.cmml" xref="S3.E7.m2.2.2.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E7.m2.1.1.cmml" xref="S3.E7.m2.1.1">𝑗</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m2.2c">\displaystyle=\mbox{sum-pooling}({\bf f}_{i},j)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS4.p2.11" class="ltx_p">where <math id="S3.SS1.SSS4.p2.4.m1.1" class="ltx_Math" alttext="U_{1}\in\mathbb{R}^{N_{f}\times N_{e}}" display="inline"><semantics id="S3.SS1.SSS4.p2.4.m1.1a"><mrow id="S3.SS1.SSS4.p2.4.m1.1.1" xref="S3.SS1.SSS4.p2.4.m1.1.1.cmml"><msub id="S3.SS1.SSS4.p2.4.m1.1.1.2" xref="S3.SS1.SSS4.p2.4.m1.1.1.2.cmml"><mi id="S3.SS1.SSS4.p2.4.m1.1.1.2.2" xref="S3.SS1.SSS4.p2.4.m1.1.1.2.2.cmml">U</mi><mn id="S3.SS1.SSS4.p2.4.m1.1.1.2.3" xref="S3.SS1.SSS4.p2.4.m1.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS1.SSS4.p2.4.m1.1.1.1" xref="S3.SS1.SSS4.p2.4.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS4.p2.4.m1.1.1.3" xref="S3.SS1.SSS4.p2.4.m1.1.1.3.cmml"><mi id="S3.SS1.SSS4.p2.4.m1.1.1.3.2" xref="S3.SS1.SSS4.p2.4.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS4.p2.4.m1.1.1.3.3" xref="S3.SS1.SSS4.p2.4.m1.1.1.3.3.cmml"><msub id="S3.SS1.SSS4.p2.4.m1.1.1.3.3.2" xref="S3.SS1.SSS4.p2.4.m1.1.1.3.3.2.cmml"><mi id="S3.SS1.SSS4.p2.4.m1.1.1.3.3.2.2" xref="S3.SS1.SSS4.p2.4.m1.1.1.3.3.2.2.cmml">N</mi><mi id="S3.SS1.SSS4.p2.4.m1.1.1.3.3.2.3" xref="S3.SS1.SSS4.p2.4.m1.1.1.3.3.2.3.cmml">f</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS4.p2.4.m1.1.1.3.3.1" xref="S3.SS1.SSS4.p2.4.m1.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.SSS4.p2.4.m1.1.1.3.3.3" xref="S3.SS1.SSS4.p2.4.m1.1.1.3.3.3.cmml"><mi id="S3.SS1.SSS4.p2.4.m1.1.1.3.3.3.2" xref="S3.SS1.SSS4.p2.4.m1.1.1.3.3.3.2.cmml">N</mi><mi id="S3.SS1.SSS4.p2.4.m1.1.1.3.3.3.3" xref="S3.SS1.SSS4.p2.4.m1.1.1.3.3.3.3.cmml">e</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p2.4.m1.1b"><apply id="S3.SS1.SSS4.p2.4.m1.1.1.cmml" xref="S3.SS1.SSS4.p2.4.m1.1.1"><in id="S3.SS1.SSS4.p2.4.m1.1.1.1.cmml" xref="S3.SS1.SSS4.p2.4.m1.1.1.1"></in><apply id="S3.SS1.SSS4.p2.4.m1.1.1.2.cmml" xref="S3.SS1.SSS4.p2.4.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS4.p2.4.m1.1.1.2.1.cmml" xref="S3.SS1.SSS4.p2.4.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS4.p2.4.m1.1.1.2.2.cmml" xref="S3.SS1.SSS4.p2.4.m1.1.1.2.2">𝑈</ci><cn type="integer" id="S3.SS1.SSS4.p2.4.m1.1.1.2.3.cmml" xref="S3.SS1.SSS4.p2.4.m1.1.1.2.3">1</cn></apply><apply id="S3.SS1.SSS4.p2.4.m1.1.1.3.cmml" xref="S3.SS1.SSS4.p2.4.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS4.p2.4.m1.1.1.3.1.cmml" xref="S3.SS1.SSS4.p2.4.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS4.p2.4.m1.1.1.3.2.cmml" xref="S3.SS1.SSS4.p2.4.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS4.p2.4.m1.1.1.3.3.cmml" xref="S3.SS1.SSS4.p2.4.m1.1.1.3.3"><times id="S3.SS1.SSS4.p2.4.m1.1.1.3.3.1.cmml" xref="S3.SS1.SSS4.p2.4.m1.1.1.3.3.1"></times><apply id="S3.SS1.SSS4.p2.4.m1.1.1.3.3.2.cmml" xref="S3.SS1.SSS4.p2.4.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS4.p2.4.m1.1.1.3.3.2.1.cmml" xref="S3.SS1.SSS4.p2.4.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.SS1.SSS4.p2.4.m1.1.1.3.3.2.2.cmml" xref="S3.SS1.SSS4.p2.4.m1.1.1.3.3.2.2">𝑁</ci><ci id="S3.SS1.SSS4.p2.4.m1.1.1.3.3.2.3.cmml" xref="S3.SS1.SSS4.p2.4.m1.1.1.3.3.2.3">𝑓</ci></apply><apply id="S3.SS1.SSS4.p2.4.m1.1.1.3.3.3.cmml" xref="S3.SS1.SSS4.p2.4.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS4.p2.4.m1.1.1.3.3.3.1.cmml" xref="S3.SS1.SSS4.p2.4.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.SSS4.p2.4.m1.1.1.3.3.3.2.cmml" xref="S3.SS1.SSS4.p2.4.m1.1.1.3.3.3.2">𝑁</ci><ci id="S3.SS1.SSS4.p2.4.m1.1.1.3.3.3.3.cmml" xref="S3.SS1.SSS4.p2.4.m1.1.1.3.3.3.3">𝑒</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p2.4.m1.1c">U_{1}\in\mathbb{R}^{N_{f}\times N_{e}}</annotation></semantics></math> and <math id="S3.SS1.SSS4.p2.5.m2.1" class="ltx_Math" alttext="U_{1}\in\mathbb{R}^{N_{f}\times H}" display="inline"><semantics id="S3.SS1.SSS4.p2.5.m2.1a"><mrow id="S3.SS1.SSS4.p2.5.m2.1.1" xref="S3.SS1.SSS4.p2.5.m2.1.1.cmml"><msub id="S3.SS1.SSS4.p2.5.m2.1.1.2" xref="S3.SS1.SSS4.p2.5.m2.1.1.2.cmml"><mi id="S3.SS1.SSS4.p2.5.m2.1.1.2.2" xref="S3.SS1.SSS4.p2.5.m2.1.1.2.2.cmml">U</mi><mn id="S3.SS1.SSS4.p2.5.m2.1.1.2.3" xref="S3.SS1.SSS4.p2.5.m2.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS1.SSS4.p2.5.m2.1.1.1" xref="S3.SS1.SSS4.p2.5.m2.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS4.p2.5.m2.1.1.3" xref="S3.SS1.SSS4.p2.5.m2.1.1.3.cmml"><mi id="S3.SS1.SSS4.p2.5.m2.1.1.3.2" xref="S3.SS1.SSS4.p2.5.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS4.p2.5.m2.1.1.3.3" xref="S3.SS1.SSS4.p2.5.m2.1.1.3.3.cmml"><msub id="S3.SS1.SSS4.p2.5.m2.1.1.3.3.2" xref="S3.SS1.SSS4.p2.5.m2.1.1.3.3.2.cmml"><mi id="S3.SS1.SSS4.p2.5.m2.1.1.3.3.2.2" xref="S3.SS1.SSS4.p2.5.m2.1.1.3.3.2.2.cmml">N</mi><mi id="S3.SS1.SSS4.p2.5.m2.1.1.3.3.2.3" xref="S3.SS1.SSS4.p2.5.m2.1.1.3.3.2.3.cmml">f</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS4.p2.5.m2.1.1.3.3.1" xref="S3.SS1.SSS4.p2.5.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.SSS4.p2.5.m2.1.1.3.3.3" xref="S3.SS1.SSS4.p2.5.m2.1.1.3.3.3.cmml">H</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p2.5.m2.1b"><apply id="S3.SS1.SSS4.p2.5.m2.1.1.cmml" xref="S3.SS1.SSS4.p2.5.m2.1.1"><in id="S3.SS1.SSS4.p2.5.m2.1.1.1.cmml" xref="S3.SS1.SSS4.p2.5.m2.1.1.1"></in><apply id="S3.SS1.SSS4.p2.5.m2.1.1.2.cmml" xref="S3.SS1.SSS4.p2.5.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS4.p2.5.m2.1.1.2.1.cmml" xref="S3.SS1.SSS4.p2.5.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS4.p2.5.m2.1.1.2.2.cmml" xref="S3.SS1.SSS4.p2.5.m2.1.1.2.2">𝑈</ci><cn type="integer" id="S3.SS1.SSS4.p2.5.m2.1.1.2.3.cmml" xref="S3.SS1.SSS4.p2.5.m2.1.1.2.3">1</cn></apply><apply id="S3.SS1.SSS4.p2.5.m2.1.1.3.cmml" xref="S3.SS1.SSS4.p2.5.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS4.p2.5.m2.1.1.3.1.cmml" xref="S3.SS1.SSS4.p2.5.m2.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS4.p2.5.m2.1.1.3.2.cmml" xref="S3.SS1.SSS4.p2.5.m2.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS4.p2.5.m2.1.1.3.3.cmml" xref="S3.SS1.SSS4.p2.5.m2.1.1.3.3"><times id="S3.SS1.SSS4.p2.5.m2.1.1.3.3.1.cmml" xref="S3.SS1.SSS4.p2.5.m2.1.1.3.3.1"></times><apply id="S3.SS1.SSS4.p2.5.m2.1.1.3.3.2.cmml" xref="S3.SS1.SSS4.p2.5.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS4.p2.5.m2.1.1.3.3.2.1.cmml" xref="S3.SS1.SSS4.p2.5.m2.1.1.3.3.2">subscript</csymbol><ci id="S3.SS1.SSS4.p2.5.m2.1.1.3.3.2.2.cmml" xref="S3.SS1.SSS4.p2.5.m2.1.1.3.3.2.2">𝑁</ci><ci id="S3.SS1.SSS4.p2.5.m2.1.1.3.3.2.3.cmml" xref="S3.SS1.SSS4.p2.5.m2.1.1.3.3.2.3">𝑓</ci></apply><ci id="S3.SS1.SSS4.p2.5.m2.1.1.3.3.3.cmml" xref="S3.SS1.SSS4.p2.5.m2.1.1.3.3.3">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p2.5.m2.1c">U_{1}\in\mathbb{R}^{N_{f}\times H}</annotation></semantics></math>
are the high dimensional projection weight matrices,
<math id="S3.SS1.SSS4.p2.6.m3.1" class="ltx_Math" alttext="{\bf b}_{1}" display="inline"><semantics id="S3.SS1.SSS4.p2.6.m3.1a"><msub id="S3.SS1.SSS4.p2.6.m3.1.1" xref="S3.SS1.SSS4.p2.6.m3.1.1.cmml"><mi id="S3.SS1.SSS4.p2.6.m3.1.1.2" xref="S3.SS1.SSS4.p2.6.m3.1.1.2.cmml">𝐛</mi><mn id="S3.SS1.SSS4.p2.6.m3.1.1.3" xref="S3.SS1.SSS4.p2.6.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p2.6.m3.1b"><apply id="S3.SS1.SSS4.p2.6.m3.1.1.cmml" xref="S3.SS1.SSS4.p2.6.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS4.p2.6.m3.1.1.1.cmml" xref="S3.SS1.SSS4.p2.6.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS4.p2.6.m3.1.1.2.cmml" xref="S3.SS1.SSS4.p2.6.m3.1.1.2">𝐛</ci><cn type="integer" id="S3.SS1.SSS4.p2.6.m3.1.1.3.cmml" xref="S3.SS1.SSS4.p2.6.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p2.6.m3.1c">{\bf b}_{1}</annotation></semantics></math> and <math id="S3.SS1.SSS4.p2.7.m4.1" class="ltx_Math" alttext="{\bf b}_{2}" display="inline"><semantics id="S3.SS1.SSS4.p2.7.m4.1a"><msub id="S3.SS1.SSS4.p2.7.m4.1.1" xref="S3.SS1.SSS4.p2.7.m4.1.1.cmml"><mi id="S3.SS1.SSS4.p2.7.m4.1.1.2" xref="S3.SS1.SSS4.p2.7.m4.1.1.2.cmml">𝐛</mi><mn id="S3.SS1.SSS4.p2.7.m4.1.1.3" xref="S3.SS1.SSS4.p2.7.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p2.7.m4.1b"><apply id="S3.SS1.SSS4.p2.7.m4.1.1.cmml" xref="S3.SS1.SSS4.p2.7.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS4.p2.7.m4.1.1.1.cmml" xref="S3.SS1.SSS4.p2.7.m4.1.1">subscript</csymbol><ci id="S3.SS1.SSS4.p2.7.m4.1.1.2.cmml" xref="S3.SS1.SSS4.p2.7.m4.1.1.2">𝐛</ci><cn type="integer" id="S3.SS1.SSS4.p2.7.m4.1.1.3.cmml" xref="S3.SS1.SSS4.p2.7.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p2.7.m4.1c">{\bf b}_{2}</annotation></semantics></math> are the bias parameter vectors,
<math id="S3.SS1.SSS4.p2.8.m5.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS1.SSS4.p2.8.m5.1a"><mi id="S3.SS1.SSS4.p2.8.m5.1.1" xref="S3.SS1.SSS4.p2.8.m5.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p2.8.m5.1b"><ci id="S3.SS1.SSS4.p2.8.m5.1.1.cmml" xref="S3.SS1.SSS4.p2.8.m5.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p2.8.m5.1c">j</annotation></semantics></math> is the MFB parameter (<math id="S3.SS1.SSS4.p2.9.m6.2" class="ltx_Math" alttext="\emph{e.g}.\hbox{}" display="inline"><semantics id="S3.SS1.SSS4.p2.9.m6.2a"><mrow id="S3.SS1.SSS4.p2.9.m6.2.3.2" xref="S3.SS1.SSS4.p2.9.m6.2.3.1.cmml"><mtext class="ltx_mathvariant_italic" id="S3.SS1.SSS4.p2.9.m6.1.1" xref="S3.SS1.SSS4.p2.9.m6.1.1b.cmml"><em id="S3.SS1.SSS4.p2.9.m6.1.1.1nest" class="ltx_emph ltx_font_italic">e.g</em></mtext><mo lspace="0em" id="S3.SS1.SSS4.p2.9.m6.2.3.2.1" xref="S3.SS1.SSS4.p2.9.m6.2.3.1a.cmml">.</mo><mrow id="S3.SS1.SSS4.p2.9.m6.2.2" xref="S3.SS1.SSS4.p2.9.m6.2.2a.cmml"></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p2.9.m6.2b"><apply id="S3.SS1.SSS4.p2.9.m6.2.3.1.cmml" xref="S3.SS1.SSS4.p2.9.m6.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS4.p2.9.m6.2.3.1a.cmml" xref="S3.SS1.SSS4.p2.9.m6.2.3.2.1">formulae-sequence</csymbol><ci id="S3.SS1.SSS4.p2.9.m6.1.1b.cmml" xref="S3.SS1.SSS4.p2.9.m6.1.1"><mtext class="ltx_mathvariant_italic" id="S3.SS1.SSS4.p2.9.m6.1.1.cmml" xref="S3.SS1.SSS4.p2.9.m6.1.1"><em id="S3.SS1.SSS4.p2.9.m6.1.1.1anest" class="ltx_emph ltx_font_italic">e.g</em></mtext></ci><ci id="S3.SS1.SSS4.p2.9.m6.2.2a.cmml" xref="S3.SS1.SSS4.p2.9.m6.2.2"><mrow id="S3.SS1.SSS4.p2.9.m6.2.2.cmml" xref="S3.SS1.SSS4.p2.9.m6.2.2"></mrow></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p2.9.m6.2c">\emph{e.g}.\hbox{}</annotation></semantics></math> 5).
The MFB feature vector <math id="S3.SS1.SSS4.p2.10.m7.1" class="ltx_Math" alttext="{\bf z}_{i}" display="inline"><semantics id="S3.SS1.SSS4.p2.10.m7.1a"><msub id="S3.SS1.SSS4.p2.10.m7.1.1" xref="S3.SS1.SSS4.p2.10.m7.1.1.cmml"><mi id="S3.SS1.SSS4.p2.10.m7.1.1.2" xref="S3.SS1.SSS4.p2.10.m7.1.1.2.cmml">𝐳</mi><mi id="S3.SS1.SSS4.p2.10.m7.1.1.3" xref="S3.SS1.SSS4.p2.10.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p2.10.m7.1b"><apply id="S3.SS1.SSS4.p2.10.m7.1.1.cmml" xref="S3.SS1.SSS4.p2.10.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS4.p2.10.m7.1.1.1.cmml" xref="S3.SS1.SSS4.p2.10.m7.1.1">subscript</csymbol><ci id="S3.SS1.SSS4.p2.10.m7.1.1.2.cmml" xref="S3.SS1.SSS4.p2.10.m7.1.1.2">𝐳</ci><ci id="S3.SS1.SSS4.p2.10.m7.1.1.3.cmml" xref="S3.SS1.SSS4.p2.10.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p2.10.m7.1c">{\bf z}_{i}</annotation></semantics></math> is then processed by a signed square root normalization and <math id="S3.SS1.SSS4.p2.11.m8.1" class="ltx_Math" alttext="L_{2}" display="inline"><semantics id="S3.SS1.SSS4.p2.11.m8.1a"><msub id="S3.SS1.SSS4.p2.11.m8.1.1" xref="S3.SS1.SSS4.p2.11.m8.1.1.cmml"><mi id="S3.SS1.SSS4.p2.11.m8.1.1.2" xref="S3.SS1.SSS4.p2.11.m8.1.1.2.cmml">L</mi><mn id="S3.SS1.SSS4.p2.11.m8.1.1.3" xref="S3.SS1.SSS4.p2.11.m8.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p2.11.m8.1b"><apply id="S3.SS1.SSS4.p2.11.m8.1.1.cmml" xref="S3.SS1.SSS4.p2.11.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS4.p2.11.m8.1.1.1.cmml" xref="S3.SS1.SSS4.p2.11.m8.1.1">subscript</csymbol><ci id="S3.SS1.SSS4.p2.11.m8.1.1.2.cmml" xref="S3.SS1.SSS4.p2.11.m8.1.1.2">𝐿</ci><cn type="integer" id="S3.SS1.SSS4.p2.11.m8.1.1.3.cmml" xref="S3.SS1.SSS4.p2.11.m8.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p2.11.m8.1c">L_{2}</annotation></semantics></math> normalization.</p>
</div>
</section>
<section id="S3.SS1.SSS5" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.5 </span>Recurrent Question Generation</h4>

<div id="S3.SS1.SSS5.p1" class="ltx_para">
<p id="S3.SS1.SSS5.p1.3" class="ltx_p">Given the concatenation of the attended visual and semantic vectors, <math id="S3.SS1.SSS5.p1.1.m1.1" class="ltx_Math" alttext="att_{0}" display="inline"><semantics id="S3.SS1.SSS5.p1.1.m1.1a"><mrow id="S3.SS1.SSS5.p1.1.m1.1.1" xref="S3.SS1.SSS5.p1.1.m1.1.1.cmml"><mi id="S3.SS1.SSS5.p1.1.m1.1.1.2" xref="S3.SS1.SSS5.p1.1.m1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS5.p1.1.m1.1.1.1" xref="S3.SS1.SSS5.p1.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS1.SSS5.p1.1.m1.1.1.3" xref="S3.SS1.SSS5.p1.1.m1.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS5.p1.1.m1.1.1.1a" xref="S3.SS1.SSS5.p1.1.m1.1.1.1.cmml">​</mo><msub id="S3.SS1.SSS5.p1.1.m1.1.1.4" xref="S3.SS1.SSS5.p1.1.m1.1.1.4.cmml"><mi id="S3.SS1.SSS5.p1.1.m1.1.1.4.2" xref="S3.SS1.SSS5.p1.1.m1.1.1.4.2.cmml">t</mi><mn id="S3.SS1.SSS5.p1.1.m1.1.1.4.3" xref="S3.SS1.SSS5.p1.1.m1.1.1.4.3.cmml">0</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p1.1.m1.1b"><apply id="S3.SS1.SSS5.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS5.p1.1.m1.1.1"><times id="S3.SS1.SSS5.p1.1.m1.1.1.1.cmml" xref="S3.SS1.SSS5.p1.1.m1.1.1.1"></times><ci id="S3.SS1.SSS5.p1.1.m1.1.1.2.cmml" xref="S3.SS1.SSS5.p1.1.m1.1.1.2">𝑎</ci><ci id="S3.SS1.SSS5.p1.1.m1.1.1.3.cmml" xref="S3.SS1.SSS5.p1.1.m1.1.1.3">𝑡</ci><apply id="S3.SS1.SSS5.p1.1.m1.1.1.4.cmml" xref="S3.SS1.SSS5.p1.1.m1.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p1.1.m1.1.1.4.1.cmml" xref="S3.SS1.SSS5.p1.1.m1.1.1.4">subscript</csymbol><ci id="S3.SS1.SSS5.p1.1.m1.1.1.4.2.cmml" xref="S3.SS1.SSS5.p1.1.m1.1.1.4.2">𝑡</ci><cn type="integer" id="S3.SS1.SSS5.p1.1.m1.1.1.4.3.cmml" xref="S3.SS1.SSS5.p1.1.m1.1.1.4.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p1.1.m1.1c">att_{0}</annotation></semantics></math>,
and the fused image and answer representation <math id="S3.SS1.SSS5.p1.2.m2.1" class="ltx_Math" alttext="\{{\bf z}_{i}\}" display="inline"><semantics id="S3.SS1.SSS5.p1.2.m2.1a"><mrow id="S3.SS1.SSS5.p1.2.m2.1.1.1" xref="S3.SS1.SSS5.p1.2.m2.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.SSS5.p1.2.m2.1.1.1.2" xref="S3.SS1.SSS5.p1.2.m2.1.1.2.cmml">{</mo><msub id="S3.SS1.SSS5.p1.2.m2.1.1.1.1" xref="S3.SS1.SSS5.p1.2.m2.1.1.1.1.cmml"><mi id="S3.SS1.SSS5.p1.2.m2.1.1.1.1.2" xref="S3.SS1.SSS5.p1.2.m2.1.1.1.1.2.cmml">𝐳</mi><mi id="S3.SS1.SSS5.p1.2.m2.1.1.1.1.3" xref="S3.SS1.SSS5.p1.2.m2.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.SSS5.p1.2.m2.1.1.1.3" xref="S3.SS1.SSS5.p1.2.m2.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p1.2.m2.1b"><set id="S3.SS1.SSS5.p1.2.m2.1.1.2.cmml" xref="S3.SS1.SSS5.p1.2.m2.1.1.1"><apply id="S3.SS1.SSS5.p1.2.m2.1.1.1.1.cmml" xref="S3.SS1.SSS5.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.SSS5.p1.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS5.p1.2.m2.1.1.1.1.2.cmml" xref="S3.SS1.SSS5.p1.2.m2.1.1.1.1.2">𝐳</ci><ci id="S3.SS1.SSS5.p1.2.m2.1.1.1.1.3.cmml" xref="S3.SS1.SSS5.p1.2.m2.1.1.1.1.3">𝑖</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p1.2.m2.1c">\{{\bf z}_{i}\}</annotation></semantics></math>,
we deploy a two-layer Gated recurrent unit (GRU) model
for question generation,
which generates the sequence of question words, <math id="S3.SS1.SSS5.p1.3.m3.3" class="ltx_Math" alttext="[q_{1},\cdots,q_{T}]" display="inline"><semantics id="S3.SS1.SSS5.p1.3.m3.3a"><mrow id="S3.SS1.SSS5.p1.3.m3.3.3.2" xref="S3.SS1.SSS5.p1.3.m3.3.3.3.cmml"><mo stretchy="false" id="S3.SS1.SSS5.p1.3.m3.3.3.2.3" xref="S3.SS1.SSS5.p1.3.m3.3.3.3.cmml">[</mo><msub id="S3.SS1.SSS5.p1.3.m3.2.2.1.1" xref="S3.SS1.SSS5.p1.3.m3.2.2.1.1.cmml"><mi id="S3.SS1.SSS5.p1.3.m3.2.2.1.1.2" xref="S3.SS1.SSS5.p1.3.m3.2.2.1.1.2.cmml">q</mi><mn id="S3.SS1.SSS5.p1.3.m3.2.2.1.1.3" xref="S3.SS1.SSS5.p1.3.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.SSS5.p1.3.m3.3.3.2.4" xref="S3.SS1.SSS5.p1.3.m3.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS5.p1.3.m3.1.1" xref="S3.SS1.SSS5.p1.3.m3.1.1.cmml">⋯</mi><mo id="S3.SS1.SSS5.p1.3.m3.3.3.2.5" xref="S3.SS1.SSS5.p1.3.m3.3.3.3.cmml">,</mo><msub id="S3.SS1.SSS5.p1.3.m3.3.3.2.2" xref="S3.SS1.SSS5.p1.3.m3.3.3.2.2.cmml"><mi id="S3.SS1.SSS5.p1.3.m3.3.3.2.2.2" xref="S3.SS1.SSS5.p1.3.m3.3.3.2.2.2.cmml">q</mi><mi id="S3.SS1.SSS5.p1.3.m3.3.3.2.2.3" xref="S3.SS1.SSS5.p1.3.m3.3.3.2.2.3.cmml">T</mi></msub><mo stretchy="false" id="S3.SS1.SSS5.p1.3.m3.3.3.2.6" xref="S3.SS1.SSS5.p1.3.m3.3.3.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p1.3.m3.3b"><list id="S3.SS1.SSS5.p1.3.m3.3.3.3.cmml" xref="S3.SS1.SSS5.p1.3.m3.3.3.2"><apply id="S3.SS1.SSS5.p1.3.m3.2.2.1.1.cmml" xref="S3.SS1.SSS5.p1.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p1.3.m3.2.2.1.1.1.cmml" xref="S3.SS1.SSS5.p1.3.m3.2.2.1.1">subscript</csymbol><ci id="S3.SS1.SSS5.p1.3.m3.2.2.1.1.2.cmml" xref="S3.SS1.SSS5.p1.3.m3.2.2.1.1.2">𝑞</ci><cn type="integer" id="S3.SS1.SSS5.p1.3.m3.2.2.1.1.3.cmml" xref="S3.SS1.SSS5.p1.3.m3.2.2.1.1.3">1</cn></apply><ci id="S3.SS1.SSS5.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS5.p1.3.m3.1.1">⋯</ci><apply id="S3.SS1.SSS5.p1.3.m3.3.3.2.2.cmml" xref="S3.SS1.SSS5.p1.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p1.3.m3.3.3.2.2.1.cmml" xref="S3.SS1.SSS5.p1.3.m3.3.3.2.2">subscript</csymbol><ci id="S3.SS1.SSS5.p1.3.m3.3.3.2.2.2.cmml" xref="S3.SS1.SSS5.p1.3.m3.3.3.2.2.2">𝑞</ci><ci id="S3.SS1.SSS5.p1.3.m3.3.3.2.2.3.cmml" xref="S3.SS1.SSS5.p1.3.m3.3.3.2.2.3">𝑇</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p1.3.m3.3c">[q_{1},\cdots,q_{T}]</annotation></semantics></math>, recurrently.
This module has three main components for each recurrent generation operation:
partial question encoder, dynamic attention, and question decoder. 
<br class="ltx_break"></p>
</div>
<div id="S3.SS1.SSS5.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.SSS5.p2.3" class="ltx_p"><span id="S3.SS1.SSS5.p2.3.1" class="ltx_text ltx_font_bold">Partial Question Encoder.</span>
At each recurrent step, a GRU encoder is deployed to encode
the current partial question generated, aiming to capture
the long-term dependencies in the question word sequence for next word generation.
Given the question word <math id="S3.SS1.SSS5.p2.1.m1.1" class="ltx_Math" alttext="q_{t}" display="inline"><semantics id="S3.SS1.SSS5.p2.1.m1.1a"><msub id="S3.SS1.SSS5.p2.1.m1.1.1" xref="S3.SS1.SSS5.p2.1.m1.1.1.cmml"><mi id="S3.SS1.SSS5.p2.1.m1.1.1.2" xref="S3.SS1.SSS5.p2.1.m1.1.1.2.cmml">q</mi><mi id="S3.SS1.SSS5.p2.1.m1.1.1.3" xref="S3.SS1.SSS5.p2.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p2.1.m1.1b"><apply id="S3.SS1.SSS5.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS5.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p2.1.m1.1.1.1.cmml" xref="S3.SS1.SSS5.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS5.p2.1.m1.1.1.2.cmml" xref="S3.SS1.SSS5.p2.1.m1.1.1.2">𝑞</ci><ci id="S3.SS1.SSS5.p2.1.m1.1.1.3.cmml" xref="S3.SS1.SSS5.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p2.1.m1.1c">q_{t}</annotation></semantics></math> generated from the immediate previous recurrent step,
we first embed
<math id="S3.SS1.SSS5.p2.2.m2.1" class="ltx_Math" alttext="q_{t}" display="inline"><semantics id="S3.SS1.SSS5.p2.2.m2.1a"><msub id="S3.SS1.SSS5.p2.2.m2.1.1" xref="S3.SS1.SSS5.p2.2.m2.1.1.cmml"><mi id="S3.SS1.SSS5.p2.2.m2.1.1.2" xref="S3.SS1.SSS5.p2.2.m2.1.1.2.cmml">q</mi><mi id="S3.SS1.SSS5.p2.2.m2.1.1.3" xref="S3.SS1.SSS5.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p2.2.m2.1b"><apply id="S3.SS1.SSS5.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS5.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p2.2.m2.1.1.1.cmml" xref="S3.SS1.SSS5.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS5.p2.2.m2.1.1.2.cmml" xref="S3.SS1.SSS5.p2.2.m2.1.1.2">𝑞</ci><ci id="S3.SS1.SSS5.p2.2.m2.1.1.3.cmml" xref="S3.SS1.SSS5.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p2.2.m2.1c">q_{t}</annotation></semantics></math> into the same semantic embedding space
as the answer cue
with a pre-trained GloVe model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>,
which produces an embedding vector <math id="S3.SS1.SSS5.p2.3.m3.1" class="ltx_Math" alttext="M_{t}\in\mathbb{R}^{300}" display="inline"><semantics id="S3.SS1.SSS5.p2.3.m3.1a"><mrow id="S3.SS1.SSS5.p2.3.m3.1.1" xref="S3.SS1.SSS5.p2.3.m3.1.1.cmml"><msub id="S3.SS1.SSS5.p2.3.m3.1.1.2" xref="S3.SS1.SSS5.p2.3.m3.1.1.2.cmml"><mi id="S3.SS1.SSS5.p2.3.m3.1.1.2.2" xref="S3.SS1.SSS5.p2.3.m3.1.1.2.2.cmml">M</mi><mi id="S3.SS1.SSS5.p2.3.m3.1.1.2.3" xref="S3.SS1.SSS5.p2.3.m3.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS1.SSS5.p2.3.m3.1.1.1" xref="S3.SS1.SSS5.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS5.p2.3.m3.1.1.3" xref="S3.SS1.SSS5.p2.3.m3.1.1.3.cmml"><mi id="S3.SS1.SSS5.p2.3.m3.1.1.3.2" xref="S3.SS1.SSS5.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mn id="S3.SS1.SSS5.p2.3.m3.1.1.3.3" xref="S3.SS1.SSS5.p2.3.m3.1.1.3.3.cmml">300</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p2.3.m3.1b"><apply id="S3.SS1.SSS5.p2.3.m3.1.1.cmml" xref="S3.SS1.SSS5.p2.3.m3.1.1"><in id="S3.SS1.SSS5.p2.3.m3.1.1.1.cmml" xref="S3.SS1.SSS5.p2.3.m3.1.1.1"></in><apply id="S3.SS1.SSS5.p2.3.m3.1.1.2.cmml" xref="S3.SS1.SSS5.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p2.3.m3.1.1.2.1.cmml" xref="S3.SS1.SSS5.p2.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS5.p2.3.m3.1.1.2.2.cmml" xref="S3.SS1.SSS5.p2.3.m3.1.1.2.2">𝑀</ci><ci id="S3.SS1.SSS5.p2.3.m3.1.1.2.3.cmml" xref="S3.SS1.SSS5.p2.3.m3.1.1.2.3">𝑡</ci></apply><apply id="S3.SS1.SSS5.p2.3.m3.1.1.3.cmml" xref="S3.SS1.SSS5.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p2.3.m3.1.1.3.1.cmml" xref="S3.SS1.SSS5.p2.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS5.p2.3.m3.1.1.3.2.cmml" xref="S3.SS1.SSS5.p2.3.m3.1.1.3.2">ℝ</ci><cn type="integer" id="S3.SS1.SSS5.p2.3.m3.1.1.3.3.cmml" xref="S3.SS1.SSS5.p2.3.m3.1.1.3.3">300</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p2.3.m3.1c">M_{t}\in\mathbb{R}^{300}</annotation></semantics></math>.
Specifically, we perform the word embedding as follows:</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.1" class="ltx_Math" alttext="M_{t}=W_{emb}{\bf 1}_{q_{t}}+{\bf b}_{emb}" display="block"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml"><msub id="S3.E8.m1.1.1.2" xref="S3.E8.m1.1.1.2.cmml"><mi id="S3.E8.m1.1.1.2.2" xref="S3.E8.m1.1.1.2.2.cmml">M</mi><mi id="S3.E8.m1.1.1.2.3" xref="S3.E8.m1.1.1.2.3.cmml">t</mi></msub><mo id="S3.E8.m1.1.1.1" xref="S3.E8.m1.1.1.1.cmml">=</mo><mrow id="S3.E8.m1.1.1.3" xref="S3.E8.m1.1.1.3.cmml"><mrow id="S3.E8.m1.1.1.3.2" xref="S3.E8.m1.1.1.3.2.cmml"><msub id="S3.E8.m1.1.1.3.2.2" xref="S3.E8.m1.1.1.3.2.2.cmml"><mi id="S3.E8.m1.1.1.3.2.2.2" xref="S3.E8.m1.1.1.3.2.2.2.cmml">W</mi><mrow id="S3.E8.m1.1.1.3.2.2.3" xref="S3.E8.m1.1.1.3.2.2.3.cmml"><mi id="S3.E8.m1.1.1.3.2.2.3.2" xref="S3.E8.m1.1.1.3.2.2.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.3.2.2.3.1" xref="S3.E8.m1.1.1.3.2.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.3.2.2.3.3" xref="S3.E8.m1.1.1.3.2.2.3.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.3.2.2.3.1a" xref="S3.E8.m1.1.1.3.2.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.3.2.2.3.4" xref="S3.E8.m1.1.1.3.2.2.3.4.cmml">b</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.3.2.1" xref="S3.E8.m1.1.1.3.2.1.cmml">​</mo><msub id="S3.E8.m1.1.1.3.2.3" xref="S3.E8.m1.1.1.3.2.3.cmml"><mn id="S3.E8.m1.1.1.3.2.3.2" xref="S3.E8.m1.1.1.3.2.3.2.cmml">𝟏</mn><msub id="S3.E8.m1.1.1.3.2.3.3" xref="S3.E8.m1.1.1.3.2.3.3.cmml"><mi id="S3.E8.m1.1.1.3.2.3.3.2" xref="S3.E8.m1.1.1.3.2.3.3.2.cmml">q</mi><mi id="S3.E8.m1.1.1.3.2.3.3.3" xref="S3.E8.m1.1.1.3.2.3.3.3.cmml">t</mi></msub></msub></mrow><mo id="S3.E8.m1.1.1.3.1" xref="S3.E8.m1.1.1.3.1.cmml">+</mo><msub id="S3.E8.m1.1.1.3.3" xref="S3.E8.m1.1.1.3.3.cmml"><mi id="S3.E8.m1.1.1.3.3.2" xref="S3.E8.m1.1.1.3.3.2.cmml">𝐛</mi><mrow id="S3.E8.m1.1.1.3.3.3" xref="S3.E8.m1.1.1.3.3.3.cmml"><mi id="S3.E8.m1.1.1.3.3.3.2" xref="S3.E8.m1.1.1.3.3.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.3.3.3.1" xref="S3.E8.m1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.3.3.3.3" xref="S3.E8.m1.1.1.3.3.3.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.3.3.3.1a" xref="S3.E8.m1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.3.3.3.4" xref="S3.E8.m1.1.1.3.3.3.4.cmml">b</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1"><eq id="S3.E8.m1.1.1.1.cmml" xref="S3.E8.m1.1.1.1"></eq><apply id="S3.E8.m1.1.1.2.cmml" xref="S3.E8.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.2">subscript</csymbol><ci id="S3.E8.m1.1.1.2.2.cmml" xref="S3.E8.m1.1.1.2.2">𝑀</ci><ci id="S3.E8.m1.1.1.2.3.cmml" xref="S3.E8.m1.1.1.2.3">𝑡</ci></apply><apply id="S3.E8.m1.1.1.3.cmml" xref="S3.E8.m1.1.1.3"><plus id="S3.E8.m1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.3.1"></plus><apply id="S3.E8.m1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.3.2"><times id="S3.E8.m1.1.1.3.2.1.cmml" xref="S3.E8.m1.1.1.3.2.1"></times><apply id="S3.E8.m1.1.1.3.2.2.cmml" xref="S3.E8.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.3.2.2.1.cmml" xref="S3.E8.m1.1.1.3.2.2">subscript</csymbol><ci id="S3.E8.m1.1.1.3.2.2.2.cmml" xref="S3.E8.m1.1.1.3.2.2.2">𝑊</ci><apply id="S3.E8.m1.1.1.3.2.2.3.cmml" xref="S3.E8.m1.1.1.3.2.2.3"><times id="S3.E8.m1.1.1.3.2.2.3.1.cmml" xref="S3.E8.m1.1.1.3.2.2.3.1"></times><ci id="S3.E8.m1.1.1.3.2.2.3.2.cmml" xref="S3.E8.m1.1.1.3.2.2.3.2">𝑒</ci><ci id="S3.E8.m1.1.1.3.2.2.3.3.cmml" xref="S3.E8.m1.1.1.3.2.2.3.3">𝑚</ci><ci id="S3.E8.m1.1.1.3.2.2.3.4.cmml" xref="S3.E8.m1.1.1.3.2.2.3.4">𝑏</ci></apply></apply><apply id="S3.E8.m1.1.1.3.2.3.cmml" xref="S3.E8.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.3.2.3.1.cmml" xref="S3.E8.m1.1.1.3.2.3">subscript</csymbol><cn type="integer" id="S3.E8.m1.1.1.3.2.3.2.cmml" xref="S3.E8.m1.1.1.3.2.3.2">1</cn><apply id="S3.E8.m1.1.1.3.2.3.3.cmml" xref="S3.E8.m1.1.1.3.2.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.3.2.3.3.1.cmml" xref="S3.E8.m1.1.1.3.2.3.3">subscript</csymbol><ci id="S3.E8.m1.1.1.3.2.3.3.2.cmml" xref="S3.E8.m1.1.1.3.2.3.3.2">𝑞</ci><ci id="S3.E8.m1.1.1.3.2.3.3.3.cmml" xref="S3.E8.m1.1.1.3.2.3.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E8.m1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.3.3.1.cmml" xref="S3.E8.m1.1.1.3.3">subscript</csymbol><ci id="S3.E8.m1.1.1.3.3.2.cmml" xref="S3.E8.m1.1.1.3.3.2">𝐛</ci><apply id="S3.E8.m1.1.1.3.3.3.cmml" xref="S3.E8.m1.1.1.3.3.3"><times id="S3.E8.m1.1.1.3.3.3.1.cmml" xref="S3.E8.m1.1.1.3.3.3.1"></times><ci id="S3.E8.m1.1.1.3.3.3.2.cmml" xref="S3.E8.m1.1.1.3.3.3.2">𝑒</ci><ci id="S3.E8.m1.1.1.3.3.3.3.cmml" xref="S3.E8.m1.1.1.3.3.3.3">𝑚</ci><ci id="S3.E8.m1.1.1.3.3.3.4.cmml" xref="S3.E8.m1.1.1.3.3.3.4">𝑏</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">M_{t}=W_{emb}{\bf 1}_{q_{t}}+{\bf b}_{emb}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS5.p2.10" class="ltx_p">where <math id="S3.SS1.SSS5.p2.4.m1.1" class="ltx_Math" alttext="W_{emb}\in\mathbb{R}^{300\times N_{w}}" display="inline"><semantics id="S3.SS1.SSS5.p2.4.m1.1a"><mrow id="S3.SS1.SSS5.p2.4.m1.1.1" xref="S3.SS1.SSS5.p2.4.m1.1.1.cmml"><msub id="S3.SS1.SSS5.p2.4.m1.1.1.2" xref="S3.SS1.SSS5.p2.4.m1.1.1.2.cmml"><mi id="S3.SS1.SSS5.p2.4.m1.1.1.2.2" xref="S3.SS1.SSS5.p2.4.m1.1.1.2.2.cmml">W</mi><mrow id="S3.SS1.SSS5.p2.4.m1.1.1.2.3" xref="S3.SS1.SSS5.p2.4.m1.1.1.2.3.cmml"><mi id="S3.SS1.SSS5.p2.4.m1.1.1.2.3.2" xref="S3.SS1.SSS5.p2.4.m1.1.1.2.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS5.p2.4.m1.1.1.2.3.1" xref="S3.SS1.SSS5.p2.4.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.SSS5.p2.4.m1.1.1.2.3.3" xref="S3.SS1.SSS5.p2.4.m1.1.1.2.3.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS5.p2.4.m1.1.1.2.3.1a" xref="S3.SS1.SSS5.p2.4.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.SSS5.p2.4.m1.1.1.2.3.4" xref="S3.SS1.SSS5.p2.4.m1.1.1.2.3.4.cmml">b</mi></mrow></msub><mo id="S3.SS1.SSS5.p2.4.m1.1.1.1" xref="S3.SS1.SSS5.p2.4.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS5.p2.4.m1.1.1.3" xref="S3.SS1.SSS5.p2.4.m1.1.1.3.cmml"><mi id="S3.SS1.SSS5.p2.4.m1.1.1.3.2" xref="S3.SS1.SSS5.p2.4.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS5.p2.4.m1.1.1.3.3" xref="S3.SS1.SSS5.p2.4.m1.1.1.3.3.cmml"><mn id="S3.SS1.SSS5.p2.4.m1.1.1.3.3.2" xref="S3.SS1.SSS5.p2.4.m1.1.1.3.3.2.cmml">300</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS5.p2.4.m1.1.1.3.3.1" xref="S3.SS1.SSS5.p2.4.m1.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.SSS5.p2.4.m1.1.1.3.3.3" xref="S3.SS1.SSS5.p2.4.m1.1.1.3.3.3.cmml"><mi id="S3.SS1.SSS5.p2.4.m1.1.1.3.3.3.2" xref="S3.SS1.SSS5.p2.4.m1.1.1.3.3.3.2.cmml">N</mi><mi id="S3.SS1.SSS5.p2.4.m1.1.1.3.3.3.3" xref="S3.SS1.SSS5.p2.4.m1.1.1.3.3.3.3.cmml">w</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p2.4.m1.1b"><apply id="S3.SS1.SSS5.p2.4.m1.1.1.cmml" xref="S3.SS1.SSS5.p2.4.m1.1.1"><in id="S3.SS1.SSS5.p2.4.m1.1.1.1.cmml" xref="S3.SS1.SSS5.p2.4.m1.1.1.1"></in><apply id="S3.SS1.SSS5.p2.4.m1.1.1.2.cmml" xref="S3.SS1.SSS5.p2.4.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p2.4.m1.1.1.2.1.cmml" xref="S3.SS1.SSS5.p2.4.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS5.p2.4.m1.1.1.2.2.cmml" xref="S3.SS1.SSS5.p2.4.m1.1.1.2.2">𝑊</ci><apply id="S3.SS1.SSS5.p2.4.m1.1.1.2.3.cmml" xref="S3.SS1.SSS5.p2.4.m1.1.1.2.3"><times id="S3.SS1.SSS5.p2.4.m1.1.1.2.3.1.cmml" xref="S3.SS1.SSS5.p2.4.m1.1.1.2.3.1"></times><ci id="S3.SS1.SSS5.p2.4.m1.1.1.2.3.2.cmml" xref="S3.SS1.SSS5.p2.4.m1.1.1.2.3.2">𝑒</ci><ci id="S3.SS1.SSS5.p2.4.m1.1.1.2.3.3.cmml" xref="S3.SS1.SSS5.p2.4.m1.1.1.2.3.3">𝑚</ci><ci id="S3.SS1.SSS5.p2.4.m1.1.1.2.3.4.cmml" xref="S3.SS1.SSS5.p2.4.m1.1.1.2.3.4">𝑏</ci></apply></apply><apply id="S3.SS1.SSS5.p2.4.m1.1.1.3.cmml" xref="S3.SS1.SSS5.p2.4.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p2.4.m1.1.1.3.1.cmml" xref="S3.SS1.SSS5.p2.4.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS5.p2.4.m1.1.1.3.2.cmml" xref="S3.SS1.SSS5.p2.4.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS5.p2.4.m1.1.1.3.3.cmml" xref="S3.SS1.SSS5.p2.4.m1.1.1.3.3"><times id="S3.SS1.SSS5.p2.4.m1.1.1.3.3.1.cmml" xref="S3.SS1.SSS5.p2.4.m1.1.1.3.3.1"></times><cn type="integer" id="S3.SS1.SSS5.p2.4.m1.1.1.3.3.2.cmml" xref="S3.SS1.SSS5.p2.4.m1.1.1.3.3.2">300</cn><apply id="S3.SS1.SSS5.p2.4.m1.1.1.3.3.3.cmml" xref="S3.SS1.SSS5.p2.4.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p2.4.m1.1.1.3.3.3.1.cmml" xref="S3.SS1.SSS5.p2.4.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.SSS5.p2.4.m1.1.1.3.3.3.2.cmml" xref="S3.SS1.SSS5.p2.4.m1.1.1.3.3.3.2">𝑁</ci><ci id="S3.SS1.SSS5.p2.4.m1.1.1.3.3.3.3.cmml" xref="S3.SS1.SSS5.p2.4.m1.1.1.3.3.3.3">𝑤</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p2.4.m1.1c">W_{emb}\in\mathbb{R}^{300\times N_{w}}</annotation></semantics></math> is initialized from the word embedding matrix produced by GloVe,
<math id="S3.SS1.SSS5.p2.5.m2.1" class="ltx_Math" alttext="N_{w}" display="inline"><semantics id="S3.SS1.SSS5.p2.5.m2.1a"><msub id="S3.SS1.SSS5.p2.5.m2.1.1" xref="S3.SS1.SSS5.p2.5.m2.1.1.cmml"><mi id="S3.SS1.SSS5.p2.5.m2.1.1.2" xref="S3.SS1.SSS5.p2.5.m2.1.1.2.cmml">N</mi><mi id="S3.SS1.SSS5.p2.5.m2.1.1.3" xref="S3.SS1.SSS5.p2.5.m2.1.1.3.cmml">w</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p2.5.m2.1b"><apply id="S3.SS1.SSS5.p2.5.m2.1.1.cmml" xref="S3.SS1.SSS5.p2.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p2.5.m2.1.1.1.cmml" xref="S3.SS1.SSS5.p2.5.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS5.p2.5.m2.1.1.2.cmml" xref="S3.SS1.SSS5.p2.5.m2.1.1.2">𝑁</ci><ci id="S3.SS1.SSS5.p2.5.m2.1.1.3.cmml" xref="S3.SS1.SSS5.p2.5.m2.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p2.5.m2.1c">N_{w}</annotation></semantics></math> denotes the vocabulary size,
<math id="S3.SS1.SSS5.p2.6.m3.1" class="ltx_Math" alttext="{\bf b}_{emb}" display="inline"><semantics id="S3.SS1.SSS5.p2.6.m3.1a"><msub id="S3.SS1.SSS5.p2.6.m3.1.1" xref="S3.SS1.SSS5.p2.6.m3.1.1.cmml"><mi id="S3.SS1.SSS5.p2.6.m3.1.1.2" xref="S3.SS1.SSS5.p2.6.m3.1.1.2.cmml">𝐛</mi><mrow id="S3.SS1.SSS5.p2.6.m3.1.1.3" xref="S3.SS1.SSS5.p2.6.m3.1.1.3.cmml"><mi id="S3.SS1.SSS5.p2.6.m3.1.1.3.2" xref="S3.SS1.SSS5.p2.6.m3.1.1.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS5.p2.6.m3.1.1.3.1" xref="S3.SS1.SSS5.p2.6.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS5.p2.6.m3.1.1.3.3" xref="S3.SS1.SSS5.p2.6.m3.1.1.3.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS5.p2.6.m3.1.1.3.1a" xref="S3.SS1.SSS5.p2.6.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS5.p2.6.m3.1.1.3.4" xref="S3.SS1.SSS5.p2.6.m3.1.1.3.4.cmml">b</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p2.6.m3.1b"><apply id="S3.SS1.SSS5.p2.6.m3.1.1.cmml" xref="S3.SS1.SSS5.p2.6.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p2.6.m3.1.1.1.cmml" xref="S3.SS1.SSS5.p2.6.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS5.p2.6.m3.1.1.2.cmml" xref="S3.SS1.SSS5.p2.6.m3.1.1.2">𝐛</ci><apply id="S3.SS1.SSS5.p2.6.m3.1.1.3.cmml" xref="S3.SS1.SSS5.p2.6.m3.1.1.3"><times id="S3.SS1.SSS5.p2.6.m3.1.1.3.1.cmml" xref="S3.SS1.SSS5.p2.6.m3.1.1.3.1"></times><ci id="S3.SS1.SSS5.p2.6.m3.1.1.3.2.cmml" xref="S3.SS1.SSS5.p2.6.m3.1.1.3.2">𝑒</ci><ci id="S3.SS1.SSS5.p2.6.m3.1.1.3.3.cmml" xref="S3.SS1.SSS5.p2.6.m3.1.1.3.3">𝑚</ci><ci id="S3.SS1.SSS5.p2.6.m3.1.1.3.4.cmml" xref="S3.SS1.SSS5.p2.6.m3.1.1.3.4">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p2.6.m3.1c">{\bf b}_{emb}</annotation></semantics></math> is the bias vector,
and <math id="S3.SS1.SSS5.p2.7.m4.1" class="ltx_Math" alttext="{\bf 1}_{q_{t}}" display="inline"><semantics id="S3.SS1.SSS5.p2.7.m4.1a"><msub id="S3.SS1.SSS5.p2.7.m4.1.1" xref="S3.SS1.SSS5.p2.7.m4.1.1.cmml"><mn id="S3.SS1.SSS5.p2.7.m4.1.1.2" xref="S3.SS1.SSS5.p2.7.m4.1.1.2.cmml">𝟏</mn><msub id="S3.SS1.SSS5.p2.7.m4.1.1.3" xref="S3.SS1.SSS5.p2.7.m4.1.1.3.cmml"><mi id="S3.SS1.SSS5.p2.7.m4.1.1.3.2" xref="S3.SS1.SSS5.p2.7.m4.1.1.3.2.cmml">q</mi><mi id="S3.SS1.SSS5.p2.7.m4.1.1.3.3" xref="S3.SS1.SSS5.p2.7.m4.1.1.3.3.cmml">t</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p2.7.m4.1b"><apply id="S3.SS1.SSS5.p2.7.m4.1.1.cmml" xref="S3.SS1.SSS5.p2.7.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p2.7.m4.1.1.1.cmml" xref="S3.SS1.SSS5.p2.7.m4.1.1">subscript</csymbol><cn type="integer" id="S3.SS1.SSS5.p2.7.m4.1.1.2.cmml" xref="S3.SS1.SSS5.p2.7.m4.1.1.2">1</cn><apply id="S3.SS1.SSS5.p2.7.m4.1.1.3.cmml" xref="S3.SS1.SSS5.p2.7.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p2.7.m4.1.1.3.1.cmml" xref="S3.SS1.SSS5.p2.7.m4.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS5.p2.7.m4.1.1.3.2.cmml" xref="S3.SS1.SSS5.p2.7.m4.1.1.3.2">𝑞</ci><ci id="S3.SS1.SSS5.p2.7.m4.1.1.3.3.cmml" xref="S3.SS1.SSS5.p2.7.m4.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p2.7.m4.1c">{\bf 1}_{q_{t}}</annotation></semantics></math> denotes an one-hot vector with length <math id="S3.SS1.SSS5.p2.8.m5.1" class="ltx_Math" alttext="N_{w}" display="inline"><semantics id="S3.SS1.SSS5.p2.8.m5.1a"><msub id="S3.SS1.SSS5.p2.8.m5.1.1" xref="S3.SS1.SSS5.p2.8.m5.1.1.cmml"><mi id="S3.SS1.SSS5.p2.8.m5.1.1.2" xref="S3.SS1.SSS5.p2.8.m5.1.1.2.cmml">N</mi><mi id="S3.SS1.SSS5.p2.8.m5.1.1.3" xref="S3.SS1.SSS5.p2.8.m5.1.1.3.cmml">w</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p2.8.m5.1b"><apply id="S3.SS1.SSS5.p2.8.m5.1.1.cmml" xref="S3.SS1.SSS5.p2.8.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p2.8.m5.1.1.1.cmml" xref="S3.SS1.SSS5.p2.8.m5.1.1">subscript</csymbol><ci id="S3.SS1.SSS5.p2.8.m5.1.1.2.cmml" xref="S3.SS1.SSS5.p2.8.m5.1.1.2">𝑁</ci><ci id="S3.SS1.SSS5.p2.8.m5.1.1.3.cmml" xref="S3.SS1.SSS5.p2.8.m5.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p2.8.m5.1c">N_{w}</annotation></semantics></math>, which has a single <math id="S3.SS1.SSS5.p2.9.m6.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S3.SS1.SSS5.p2.9.m6.1a"><mn id="S3.SS1.SSS5.p2.9.m6.1.1" xref="S3.SS1.SSS5.p2.9.m6.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p2.9.m6.1b"><cn type="integer" id="S3.SS1.SSS5.p2.9.m6.1.1.cmml" xref="S3.SS1.SSS5.p2.9.m6.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p2.9.m6.1c">1</annotation></semantics></math> for the entry corresponding to word <math id="S3.SS1.SSS5.p2.10.m7.1" class="ltx_Math" alttext="q_{t}" display="inline"><semantics id="S3.SS1.SSS5.p2.10.m7.1a"><msub id="S3.SS1.SSS5.p2.10.m7.1.1" xref="S3.SS1.SSS5.p2.10.m7.1.1.cmml"><mi id="S3.SS1.SSS5.p2.10.m7.1.1.2" xref="S3.SS1.SSS5.p2.10.m7.1.1.2.cmml">q</mi><mi id="S3.SS1.SSS5.p2.10.m7.1.1.3" xref="S3.SS1.SSS5.p2.10.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p2.10.m7.1b"><apply id="S3.SS1.SSS5.p2.10.m7.1.1.cmml" xref="S3.SS1.SSS5.p2.10.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p2.10.m7.1.1.1.cmml" xref="S3.SS1.SSS5.p2.10.m7.1.1">subscript</csymbol><ci id="S3.SS1.SSS5.p2.10.m7.1.1.2.cmml" xref="S3.SS1.SSS5.p2.10.m7.1.1.2">𝑞</ci><ci id="S3.SS1.SSS5.p2.10.m7.1.1.3.cmml" xref="S3.SS1.SSS5.p2.10.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p2.10.m7.1c">q_{t}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.SSS5.p3" class="ltx_para">
<p id="S3.SS1.SSS5.p3.4" class="ltx_p">Then we update the recurrent question encoding state <math id="S3.SS1.SSS5.p3.1.m1.1" class="ltx_Math" alttext="{\bf h}^{1}_{t}" display="inline"><semantics id="S3.SS1.SSS5.p3.1.m1.1a"><msubsup id="S3.SS1.SSS5.p3.1.m1.1.1" xref="S3.SS1.SSS5.p3.1.m1.1.1.cmml"><mi id="S3.SS1.SSS5.p3.1.m1.1.1.2.2" xref="S3.SS1.SSS5.p3.1.m1.1.1.2.2.cmml">𝐡</mi><mi id="S3.SS1.SSS5.p3.1.m1.1.1.3" xref="S3.SS1.SSS5.p3.1.m1.1.1.3.cmml">t</mi><mn id="S3.SS1.SSS5.p3.1.m1.1.1.2.3" xref="S3.SS1.SSS5.p3.1.m1.1.1.2.3.cmml">1</mn></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p3.1.m1.1b"><apply id="S3.SS1.SSS5.p3.1.m1.1.1.cmml" xref="S3.SS1.SSS5.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p3.1.m1.1.1.1.cmml" xref="S3.SS1.SSS5.p3.1.m1.1.1">subscript</csymbol><apply id="S3.SS1.SSS5.p3.1.m1.1.1.2.cmml" xref="S3.SS1.SSS5.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p3.1.m1.1.1.2.1.cmml" xref="S3.SS1.SSS5.p3.1.m1.1.1">superscript</csymbol><ci id="S3.SS1.SSS5.p3.1.m1.1.1.2.2.cmml" xref="S3.SS1.SSS5.p3.1.m1.1.1.2.2">𝐡</ci><cn type="integer" id="S3.SS1.SSS5.p3.1.m1.1.1.2.3.cmml" xref="S3.SS1.SSS5.p3.1.m1.1.1.2.3">1</cn></apply><ci id="S3.SS1.SSS5.p3.1.m1.1.1.3.cmml" xref="S3.SS1.SSS5.p3.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p3.1.m1.1c">{\bf h}^{1}_{t}</annotation></semantics></math> by using the concatenation
of the word embedding <math id="S3.SS1.SSS5.p3.2.m2.1" class="ltx_Math" alttext="M_{t}" display="inline"><semantics id="S3.SS1.SSS5.p3.2.m2.1a"><msub id="S3.SS1.SSS5.p3.2.m2.1.1" xref="S3.SS1.SSS5.p3.2.m2.1.1.cmml"><mi id="S3.SS1.SSS5.p3.2.m2.1.1.2" xref="S3.SS1.SSS5.p3.2.m2.1.1.2.cmml">M</mi><mi id="S3.SS1.SSS5.p3.2.m2.1.1.3" xref="S3.SS1.SSS5.p3.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p3.2.m2.1b"><apply id="S3.SS1.SSS5.p3.2.m2.1.1.cmml" xref="S3.SS1.SSS5.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p3.2.m2.1.1.1.cmml" xref="S3.SS1.SSS5.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS5.p3.2.m2.1.1.2.cmml" xref="S3.SS1.SSS5.p3.2.m2.1.1.2">𝑀</ci><ci id="S3.SS1.SSS5.p3.2.m2.1.1.3.cmml" xref="S3.SS1.SSS5.p3.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p3.2.m2.1c">M_{t}</annotation></semantics></math>, answer attended visual and semantic features <math id="S3.SS1.SSS5.p3.3.m3.1" class="ltx_Math" alttext="Att_{0}" display="inline"><semantics id="S3.SS1.SSS5.p3.3.m3.1a"><mrow id="S3.SS1.SSS5.p3.3.m3.1.1" xref="S3.SS1.SSS5.p3.3.m3.1.1.cmml"><mi id="S3.SS1.SSS5.p3.3.m3.1.1.2" xref="S3.SS1.SSS5.p3.3.m3.1.1.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS5.p3.3.m3.1.1.1" xref="S3.SS1.SSS5.p3.3.m3.1.1.1.cmml">​</mo><mi id="S3.SS1.SSS5.p3.3.m3.1.1.3" xref="S3.SS1.SSS5.p3.3.m3.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS5.p3.3.m3.1.1.1a" xref="S3.SS1.SSS5.p3.3.m3.1.1.1.cmml">​</mo><msub id="S3.SS1.SSS5.p3.3.m3.1.1.4" xref="S3.SS1.SSS5.p3.3.m3.1.1.4.cmml"><mi id="S3.SS1.SSS5.p3.3.m3.1.1.4.2" xref="S3.SS1.SSS5.p3.3.m3.1.1.4.2.cmml">t</mi><mn id="S3.SS1.SSS5.p3.3.m3.1.1.4.3" xref="S3.SS1.SSS5.p3.3.m3.1.1.4.3.cmml">0</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p3.3.m3.1b"><apply id="S3.SS1.SSS5.p3.3.m3.1.1.cmml" xref="S3.SS1.SSS5.p3.3.m3.1.1"><times id="S3.SS1.SSS5.p3.3.m3.1.1.1.cmml" xref="S3.SS1.SSS5.p3.3.m3.1.1.1"></times><ci id="S3.SS1.SSS5.p3.3.m3.1.1.2.cmml" xref="S3.SS1.SSS5.p3.3.m3.1.1.2">𝐴</ci><ci id="S3.SS1.SSS5.p3.3.m3.1.1.3.cmml" xref="S3.SS1.SSS5.p3.3.m3.1.1.3">𝑡</ci><apply id="S3.SS1.SSS5.p3.3.m3.1.1.4.cmml" xref="S3.SS1.SSS5.p3.3.m3.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p3.3.m3.1.1.4.1.cmml" xref="S3.SS1.SSS5.p3.3.m3.1.1.4">subscript</csymbol><ci id="S3.SS1.SSS5.p3.3.m3.1.1.4.2.cmml" xref="S3.SS1.SSS5.p3.3.m3.1.1.4.2">𝑡</ci><cn type="integer" id="S3.SS1.SSS5.p3.3.m3.1.1.4.3.cmml" xref="S3.SS1.SSS5.p3.3.m3.1.1.4.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p3.3.m3.1c">Att_{0}</annotation></semantics></math>,
and the previous question decoding state <math id="S3.SS1.SSS5.p3.4.m4.1" class="ltx_Math" alttext="{\bf h}^{2}_{t-1}" display="inline"><semantics id="S3.SS1.SSS5.p3.4.m4.1a"><msubsup id="S3.SS1.SSS5.p3.4.m4.1.1" xref="S3.SS1.SSS5.p3.4.m4.1.1.cmml"><mi id="S3.SS1.SSS5.p3.4.m4.1.1.2.2" xref="S3.SS1.SSS5.p3.4.m4.1.1.2.2.cmml">𝐡</mi><mrow id="S3.SS1.SSS5.p3.4.m4.1.1.3" xref="S3.SS1.SSS5.p3.4.m4.1.1.3.cmml"><mi id="S3.SS1.SSS5.p3.4.m4.1.1.3.2" xref="S3.SS1.SSS5.p3.4.m4.1.1.3.2.cmml">t</mi><mo id="S3.SS1.SSS5.p3.4.m4.1.1.3.1" xref="S3.SS1.SSS5.p3.4.m4.1.1.3.1.cmml">−</mo><mn id="S3.SS1.SSS5.p3.4.m4.1.1.3.3" xref="S3.SS1.SSS5.p3.4.m4.1.1.3.3.cmml">1</mn></mrow><mn id="S3.SS1.SSS5.p3.4.m4.1.1.2.3" xref="S3.SS1.SSS5.p3.4.m4.1.1.2.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p3.4.m4.1b"><apply id="S3.SS1.SSS5.p3.4.m4.1.1.cmml" xref="S3.SS1.SSS5.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p3.4.m4.1.1.1.cmml" xref="S3.SS1.SSS5.p3.4.m4.1.1">subscript</csymbol><apply id="S3.SS1.SSS5.p3.4.m4.1.1.2.cmml" xref="S3.SS1.SSS5.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p3.4.m4.1.1.2.1.cmml" xref="S3.SS1.SSS5.p3.4.m4.1.1">superscript</csymbol><ci id="S3.SS1.SSS5.p3.4.m4.1.1.2.2.cmml" xref="S3.SS1.SSS5.p3.4.m4.1.1.2.2">𝐡</ci><cn type="integer" id="S3.SS1.SSS5.p3.4.m4.1.1.2.3.cmml" xref="S3.SS1.SSS5.p3.4.m4.1.1.2.3">2</cn></apply><apply id="S3.SS1.SSS5.p3.4.m4.1.1.3.cmml" xref="S3.SS1.SSS5.p3.4.m4.1.1.3"><minus id="S3.SS1.SSS5.p3.4.m4.1.1.3.1.cmml" xref="S3.SS1.SSS5.p3.4.m4.1.1.3.1"></minus><ci id="S3.SS1.SSS5.p3.4.m4.1.1.3.2.cmml" xref="S3.SS1.SSS5.p3.4.m4.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS1.SSS5.p3.4.m4.1.1.3.3.cmml" xref="S3.SS1.SSS5.p3.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p3.4.m4.1c">{\bf h}^{2}_{t-1}</annotation></semantics></math> as input:</p>
<table id="S5.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E9.m1.1" class="ltx_Math" alttext="\displaystyle{\bf r}_{t}" display="inline"><semantics id="S3.E9.m1.1a"><msub id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml"><mi id="S3.E9.m1.1.1.2" xref="S3.E9.m1.1.1.2.cmml">𝐫</mi><mi id="S3.E9.m1.1.1.3" xref="S3.E9.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E9.m1.1b"><apply id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.cmml" xref="S3.E9.m1.1.1">subscript</csymbol><ci id="S3.E9.m1.1.1.2.cmml" xref="S3.E9.m1.1.1.2">𝐫</ci><ci id="S3.E9.m1.1.1.3.cmml" xref="S3.E9.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.1c">\displaystyle{\bf r}_{t}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E9.m2.3" class="ltx_Math" alttext="\displaystyle=[M_{t};{\bf h}^{2}_{t-1};att_{0}]" display="inline"><semantics id="S3.E9.m2.3a"><mrow id="S3.E9.m2.3.3" xref="S3.E9.m2.3.3.cmml"><mi id="S3.E9.m2.3.3.5" xref="S3.E9.m2.3.3.5.cmml"></mi><mo id="S3.E9.m2.3.3.4" xref="S3.E9.m2.3.3.4.cmml">=</mo><mrow id="S3.E9.m2.3.3.3.3" xref="S3.E9.m2.3.3.3.4.cmml"><mo stretchy="false" id="S3.E9.m2.3.3.3.3.4" xref="S3.E9.m2.3.3.3.4.cmml">[</mo><msub id="S3.E9.m2.1.1.1.1.1" xref="S3.E9.m2.1.1.1.1.1.cmml"><mi id="S3.E9.m2.1.1.1.1.1.2" xref="S3.E9.m2.1.1.1.1.1.2.cmml">M</mi><mi id="S3.E9.m2.1.1.1.1.1.3" xref="S3.E9.m2.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E9.m2.3.3.3.3.5" xref="S3.E9.m2.3.3.3.4.cmml">;</mo><msubsup id="S3.E9.m2.2.2.2.2.2" xref="S3.E9.m2.2.2.2.2.2.cmml"><mi id="S3.E9.m2.2.2.2.2.2.2.2" xref="S3.E9.m2.2.2.2.2.2.2.2.cmml">𝐡</mi><mrow id="S3.E9.m2.2.2.2.2.2.3" xref="S3.E9.m2.2.2.2.2.2.3.cmml"><mi id="S3.E9.m2.2.2.2.2.2.3.2" xref="S3.E9.m2.2.2.2.2.2.3.2.cmml">t</mi><mo id="S3.E9.m2.2.2.2.2.2.3.1" xref="S3.E9.m2.2.2.2.2.2.3.1.cmml">−</mo><mn id="S3.E9.m2.2.2.2.2.2.3.3" xref="S3.E9.m2.2.2.2.2.2.3.3.cmml">1</mn></mrow><mn id="S3.E9.m2.2.2.2.2.2.2.3" xref="S3.E9.m2.2.2.2.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.E9.m2.3.3.3.3.6" xref="S3.E9.m2.3.3.3.4.cmml">;</mo><mrow id="S3.E9.m2.3.3.3.3.3" xref="S3.E9.m2.3.3.3.3.3.cmml"><mi id="S3.E9.m2.3.3.3.3.3.2" xref="S3.E9.m2.3.3.3.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E9.m2.3.3.3.3.3.1" xref="S3.E9.m2.3.3.3.3.3.1.cmml">​</mo><mi id="S3.E9.m2.3.3.3.3.3.3" xref="S3.E9.m2.3.3.3.3.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E9.m2.3.3.3.3.3.1a" xref="S3.E9.m2.3.3.3.3.3.1.cmml">​</mo><msub id="S3.E9.m2.3.3.3.3.3.4" xref="S3.E9.m2.3.3.3.3.3.4.cmml"><mi id="S3.E9.m2.3.3.3.3.3.4.2" xref="S3.E9.m2.3.3.3.3.3.4.2.cmml">t</mi><mn id="S3.E9.m2.3.3.3.3.3.4.3" xref="S3.E9.m2.3.3.3.3.3.4.3.cmml">0</mn></msub></mrow><mo stretchy="false" id="S3.E9.m2.3.3.3.3.7" xref="S3.E9.m2.3.3.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m2.3b"><apply id="S3.E9.m2.3.3.cmml" xref="S3.E9.m2.3.3"><eq id="S3.E9.m2.3.3.4.cmml" xref="S3.E9.m2.3.3.4"></eq><csymbol cd="latexml" id="S3.E9.m2.3.3.5.cmml" xref="S3.E9.m2.3.3.5">absent</csymbol><list id="S3.E9.m2.3.3.3.4.cmml" xref="S3.E9.m2.3.3.3.3"><apply id="S3.E9.m2.1.1.1.1.1.cmml" xref="S3.E9.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m2.1.1.1.1.1.1.cmml" xref="S3.E9.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m2.1.1.1.1.1.2.cmml" xref="S3.E9.m2.1.1.1.1.1.2">𝑀</ci><ci id="S3.E9.m2.1.1.1.1.1.3.cmml" xref="S3.E9.m2.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E9.m2.2.2.2.2.2.cmml" xref="S3.E9.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E9.m2.2.2.2.2.2.1.cmml" xref="S3.E9.m2.2.2.2.2.2">subscript</csymbol><apply id="S3.E9.m2.2.2.2.2.2.2.cmml" xref="S3.E9.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E9.m2.2.2.2.2.2.2.1.cmml" xref="S3.E9.m2.2.2.2.2.2">superscript</csymbol><ci id="S3.E9.m2.2.2.2.2.2.2.2.cmml" xref="S3.E9.m2.2.2.2.2.2.2.2">𝐡</ci><cn type="integer" id="S3.E9.m2.2.2.2.2.2.2.3.cmml" xref="S3.E9.m2.2.2.2.2.2.2.3">2</cn></apply><apply id="S3.E9.m2.2.2.2.2.2.3.cmml" xref="S3.E9.m2.2.2.2.2.2.3"><minus id="S3.E9.m2.2.2.2.2.2.3.1.cmml" xref="S3.E9.m2.2.2.2.2.2.3.1"></minus><ci id="S3.E9.m2.2.2.2.2.2.3.2.cmml" xref="S3.E9.m2.2.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="S3.E9.m2.2.2.2.2.2.3.3.cmml" xref="S3.E9.m2.2.2.2.2.2.3.3">1</cn></apply></apply><apply id="S3.E9.m2.3.3.3.3.3.cmml" xref="S3.E9.m2.3.3.3.3.3"><times id="S3.E9.m2.3.3.3.3.3.1.cmml" xref="S3.E9.m2.3.3.3.3.3.1"></times><ci id="S3.E9.m2.3.3.3.3.3.2.cmml" xref="S3.E9.m2.3.3.3.3.3.2">𝑎</ci><ci id="S3.E9.m2.3.3.3.3.3.3.cmml" xref="S3.E9.m2.3.3.3.3.3.3">𝑡</ci><apply id="S3.E9.m2.3.3.3.3.3.4.cmml" xref="S3.E9.m2.3.3.3.3.3.4"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.3.3.3.4.1.cmml" xref="S3.E9.m2.3.3.3.3.3.4">subscript</csymbol><ci id="S3.E9.m2.3.3.3.3.3.4.2.cmml" xref="S3.E9.m2.3.3.3.3.3.4.2">𝑡</ci><cn type="integer" id="S3.E9.m2.3.3.3.3.3.4.3.cmml" xref="S3.E9.m2.3.3.3.3.3.4.3">0</cn></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m2.3c">\displaystyle=[M_{t};{\bf h}^{2}_{t-1};att_{0}]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
<tbody id="S3.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E10.m1.1" class="ltx_Math" alttext="\displaystyle{\bf h}^{1}_{t}" display="inline"><semantics id="S3.E10.m1.1a"><msubsup id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml"><mi id="S3.E10.m1.1.1.2.2" xref="S3.E10.m1.1.1.2.2.cmml">𝐡</mi><mi id="S3.E10.m1.1.1.3" xref="S3.E10.m1.1.1.3.cmml">t</mi><mn id="S3.E10.m1.1.1.2.3" xref="S3.E10.m1.1.1.2.3.cmml">1</mn></msubsup><annotation-xml encoding="MathML-Content" id="S3.E10.m1.1b"><apply id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.cmml" xref="S3.E10.m1.1.1">subscript</csymbol><apply id="S3.E10.m1.1.1.2.cmml" xref="S3.E10.m1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.2.1.cmml" xref="S3.E10.m1.1.1">superscript</csymbol><ci id="S3.E10.m1.1.1.2.2.cmml" xref="S3.E10.m1.1.1.2.2">𝐡</ci><cn type="integer" id="S3.E10.m1.1.1.2.3.cmml" xref="S3.E10.m1.1.1.2.3">1</cn></apply><ci id="S3.E10.m1.1.1.3.cmml" xref="S3.E10.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.1c">\displaystyle{\bf h}^{1}_{t}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E10.m2.2" class="ltx_Math" alttext="\displaystyle=\mbox{GRU}_{1}({\bf r}_{t},{\bf h}^{1}_{t-1}+{\bf a})" display="inline"><semantics id="S3.E10.m2.2a"><mrow id="S3.E10.m2.2.2" xref="S3.E10.m2.2.2.cmml"><mi id="S3.E10.m2.2.2.4" xref="S3.E10.m2.2.2.4.cmml"></mi><mo id="S3.E10.m2.2.2.3" xref="S3.E10.m2.2.2.3.cmml">=</mo><mrow id="S3.E10.m2.2.2.2" xref="S3.E10.m2.2.2.2.cmml"><msub id="S3.E10.m2.2.2.2.4" xref="S3.E10.m2.2.2.2.4.cmml"><mtext id="S3.E10.m2.2.2.2.4.2" xref="S3.E10.m2.2.2.2.4.2a.cmml">GRU</mtext><mn id="S3.E10.m2.2.2.2.4.3" xref="S3.E10.m2.2.2.2.4.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.E10.m2.2.2.2.3" xref="S3.E10.m2.2.2.2.3.cmml">​</mo><mrow id="S3.E10.m2.2.2.2.2.2" xref="S3.E10.m2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E10.m2.2.2.2.2.2.3" xref="S3.E10.m2.2.2.2.2.3.cmml">(</mo><msub id="S3.E10.m2.1.1.1.1.1.1" xref="S3.E10.m2.1.1.1.1.1.1.cmml"><mi id="S3.E10.m2.1.1.1.1.1.1.2" xref="S3.E10.m2.1.1.1.1.1.1.2.cmml">𝐫</mi><mi id="S3.E10.m2.1.1.1.1.1.1.3" xref="S3.E10.m2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E10.m2.2.2.2.2.2.4" xref="S3.E10.m2.2.2.2.2.3.cmml">,</mo><mrow id="S3.E10.m2.2.2.2.2.2.2" xref="S3.E10.m2.2.2.2.2.2.2.cmml"><msubsup id="S3.E10.m2.2.2.2.2.2.2.2" xref="S3.E10.m2.2.2.2.2.2.2.2.cmml"><mi id="S3.E10.m2.2.2.2.2.2.2.2.2.2" xref="S3.E10.m2.2.2.2.2.2.2.2.2.2.cmml">𝐡</mi><mrow id="S3.E10.m2.2.2.2.2.2.2.2.3" xref="S3.E10.m2.2.2.2.2.2.2.2.3.cmml"><mi id="S3.E10.m2.2.2.2.2.2.2.2.3.2" xref="S3.E10.m2.2.2.2.2.2.2.2.3.2.cmml">t</mi><mo id="S3.E10.m2.2.2.2.2.2.2.2.3.1" xref="S3.E10.m2.2.2.2.2.2.2.2.3.1.cmml">−</mo><mn id="S3.E10.m2.2.2.2.2.2.2.2.3.3" xref="S3.E10.m2.2.2.2.2.2.2.2.3.3.cmml">1</mn></mrow><mn id="S3.E10.m2.2.2.2.2.2.2.2.2.3" xref="S3.E10.m2.2.2.2.2.2.2.2.2.3.cmml">1</mn></msubsup><mo id="S3.E10.m2.2.2.2.2.2.2.1" xref="S3.E10.m2.2.2.2.2.2.2.1.cmml">+</mo><mi id="S3.E10.m2.2.2.2.2.2.2.3" xref="S3.E10.m2.2.2.2.2.2.2.3.cmml">𝐚</mi></mrow><mo stretchy="false" id="S3.E10.m2.2.2.2.2.2.5" xref="S3.E10.m2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m2.2b"><apply id="S3.E10.m2.2.2.cmml" xref="S3.E10.m2.2.2"><eq id="S3.E10.m2.2.2.3.cmml" xref="S3.E10.m2.2.2.3"></eq><csymbol cd="latexml" id="S3.E10.m2.2.2.4.cmml" xref="S3.E10.m2.2.2.4">absent</csymbol><apply id="S3.E10.m2.2.2.2.cmml" xref="S3.E10.m2.2.2.2"><times id="S3.E10.m2.2.2.2.3.cmml" xref="S3.E10.m2.2.2.2.3"></times><apply id="S3.E10.m2.2.2.2.4.cmml" xref="S3.E10.m2.2.2.2.4"><csymbol cd="ambiguous" id="S3.E10.m2.2.2.2.4.1.cmml" xref="S3.E10.m2.2.2.2.4">subscript</csymbol><ci id="S3.E10.m2.2.2.2.4.2a.cmml" xref="S3.E10.m2.2.2.2.4.2"><mtext id="S3.E10.m2.2.2.2.4.2.cmml" xref="S3.E10.m2.2.2.2.4.2">GRU</mtext></ci><cn type="integer" id="S3.E10.m2.2.2.2.4.3.cmml" xref="S3.E10.m2.2.2.2.4.3">1</cn></apply><interval closure="open" id="S3.E10.m2.2.2.2.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2"><apply id="S3.E10.m2.1.1.1.1.1.1.cmml" xref="S3.E10.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m2.1.1.1.1.1.1.1.cmml" xref="S3.E10.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m2.1.1.1.1.1.1.2.cmml" xref="S3.E10.m2.1.1.1.1.1.1.2">𝐫</ci><ci id="S3.E10.m2.1.1.1.1.1.1.3.cmml" xref="S3.E10.m2.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E10.m2.2.2.2.2.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.2"><plus id="S3.E10.m2.2.2.2.2.2.2.1.cmml" xref="S3.E10.m2.2.2.2.2.2.2.1"></plus><apply id="S3.E10.m2.2.2.2.2.2.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m2.2.2.2.2.2.2.2.1.cmml" xref="S3.E10.m2.2.2.2.2.2.2.2">subscript</csymbol><apply id="S3.E10.m2.2.2.2.2.2.2.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m2.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E10.m2.2.2.2.2.2.2.2">superscript</csymbol><ci id="S3.E10.m2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.2.2.2.2">𝐡</ci><cn type="integer" id="S3.E10.m2.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2.2.2.2.3">1</cn></apply><apply id="S3.E10.m2.2.2.2.2.2.2.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2.2.2.3"><minus id="S3.E10.m2.2.2.2.2.2.2.2.3.1.cmml" xref="S3.E10.m2.2.2.2.2.2.2.2.3.1"></minus><ci id="S3.E10.m2.2.2.2.2.2.2.2.3.2.cmml" xref="S3.E10.m2.2.2.2.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="S3.E10.m2.2.2.2.2.2.2.2.3.3.cmml" xref="S3.E10.m2.2.2.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E10.m2.2.2.2.2.2.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2.2.3">𝐚</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m2.2c">\displaystyle=\mbox{GRU}_{1}({\bf r}_{t},{\bf h}^{1}_{t-1}+{\bf a})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS5.p3.5" class="ltx_p">Note, we further emphasize the answer cue by adding it to
the previous hidden state vector of the encoder GRU<sub id="S3.SS1.SSS5.p3.5.1" class="ltx_sub">1</sub>. 
<br class="ltx_break"></p>
</div>
<div id="S3.SS1.SSS5.p4" class="ltx_para ltx_noindent">
<p id="S3.SS1.SSS5.p4.8" class="ltx_p"><span id="S3.SS1.SSS5.p4.8.1" class="ltx_text ltx_font_bold">Dynamic Attention.</span>
Given the current partial question encoding state, we use an attention module
to dynamically assign higher weights
to important regional visual features that are corresponding to current partial question context.
Specifically, the attention weights are determined by a triplet of image, answer, and partial question encoder state.
We compute them as follows:</p>
<table id="S3.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E11.m1.4" class="ltx_Math" alttext="\alpha_{i,t}=W_{att}^{\top}\tanh(W_{z}{\bf z}_{i}+{\bf b}_{z}+W_{h}{\bf h}^{1}_{t})" display="block"><semantics id="S3.E11.m1.4a"><mrow id="S3.E11.m1.4.4" xref="S3.E11.m1.4.4.cmml"><msub id="S3.E11.m1.4.4.3" xref="S3.E11.m1.4.4.3.cmml"><mi id="S3.E11.m1.4.4.3.2" xref="S3.E11.m1.4.4.3.2.cmml">α</mi><mrow id="S3.E11.m1.2.2.2.4" xref="S3.E11.m1.2.2.2.3.cmml"><mi id="S3.E11.m1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.cmml">i</mi><mo id="S3.E11.m1.2.2.2.4.1" xref="S3.E11.m1.2.2.2.3.cmml">,</mo><mi id="S3.E11.m1.2.2.2.2" xref="S3.E11.m1.2.2.2.2.cmml">t</mi></mrow></msub><mo id="S3.E11.m1.4.4.2" xref="S3.E11.m1.4.4.2.cmml">=</mo><mrow id="S3.E11.m1.4.4.1" xref="S3.E11.m1.4.4.1.cmml"><msubsup id="S3.E11.m1.4.4.1.3" xref="S3.E11.m1.4.4.1.3.cmml"><mi id="S3.E11.m1.4.4.1.3.2.2" xref="S3.E11.m1.4.4.1.3.2.2.cmml">W</mi><mrow id="S3.E11.m1.4.4.1.3.2.3" xref="S3.E11.m1.4.4.1.3.2.3.cmml"><mi id="S3.E11.m1.4.4.1.3.2.3.2" xref="S3.E11.m1.4.4.1.3.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.4.4.1.3.2.3.1" xref="S3.E11.m1.4.4.1.3.2.3.1.cmml">​</mo><mi id="S3.E11.m1.4.4.1.3.2.3.3" xref="S3.E11.m1.4.4.1.3.2.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.4.4.1.3.2.3.1a" xref="S3.E11.m1.4.4.1.3.2.3.1.cmml">​</mo><mi id="S3.E11.m1.4.4.1.3.2.3.4" xref="S3.E11.m1.4.4.1.3.2.3.4.cmml">t</mi></mrow><mo id="S3.E11.m1.4.4.1.3.3" xref="S3.E11.m1.4.4.1.3.3.cmml">⊤</mo></msubsup><mo lspace="0.167em" rspace="0em" id="S3.E11.m1.4.4.1.2" xref="S3.E11.m1.4.4.1.2.cmml">​</mo><mrow id="S3.E11.m1.4.4.1.1.1" xref="S3.E11.m1.4.4.1.1.2.cmml"><mi id="S3.E11.m1.3.3" xref="S3.E11.m1.3.3.cmml">tanh</mi><mo id="S3.E11.m1.4.4.1.1.1a" xref="S3.E11.m1.4.4.1.1.2.cmml">⁡</mo><mrow id="S3.E11.m1.4.4.1.1.1.1" xref="S3.E11.m1.4.4.1.1.2.cmml"><mo stretchy="false" id="S3.E11.m1.4.4.1.1.1.1.2" xref="S3.E11.m1.4.4.1.1.2.cmml">(</mo><mrow id="S3.E11.m1.4.4.1.1.1.1.1" xref="S3.E11.m1.4.4.1.1.1.1.1.cmml"><mrow id="S3.E11.m1.4.4.1.1.1.1.1.2" xref="S3.E11.m1.4.4.1.1.1.1.1.2.cmml"><msub id="S3.E11.m1.4.4.1.1.1.1.1.2.2" xref="S3.E11.m1.4.4.1.1.1.1.1.2.2.cmml"><mi id="S3.E11.m1.4.4.1.1.1.1.1.2.2.2" xref="S3.E11.m1.4.4.1.1.1.1.1.2.2.2.cmml">W</mi><mi id="S3.E11.m1.4.4.1.1.1.1.1.2.2.3" xref="S3.E11.m1.4.4.1.1.1.1.1.2.2.3.cmml">z</mi></msub><mo lspace="0em" rspace="0em" id="S3.E11.m1.4.4.1.1.1.1.1.2.1" xref="S3.E11.m1.4.4.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E11.m1.4.4.1.1.1.1.1.2.3" xref="S3.E11.m1.4.4.1.1.1.1.1.2.3.cmml"><mi id="S3.E11.m1.4.4.1.1.1.1.1.2.3.2" xref="S3.E11.m1.4.4.1.1.1.1.1.2.3.2.cmml">𝐳</mi><mi id="S3.E11.m1.4.4.1.1.1.1.1.2.3.3" xref="S3.E11.m1.4.4.1.1.1.1.1.2.3.3.cmml">i</mi></msub></mrow><mo id="S3.E11.m1.4.4.1.1.1.1.1.1" xref="S3.E11.m1.4.4.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E11.m1.4.4.1.1.1.1.1.3" xref="S3.E11.m1.4.4.1.1.1.1.1.3.cmml"><mi id="S3.E11.m1.4.4.1.1.1.1.1.3.2" xref="S3.E11.m1.4.4.1.1.1.1.1.3.2.cmml">𝐛</mi><mi id="S3.E11.m1.4.4.1.1.1.1.1.3.3" xref="S3.E11.m1.4.4.1.1.1.1.1.3.3.cmml">z</mi></msub><mo id="S3.E11.m1.4.4.1.1.1.1.1.1a" xref="S3.E11.m1.4.4.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E11.m1.4.4.1.1.1.1.1.4" xref="S3.E11.m1.4.4.1.1.1.1.1.4.cmml"><msub id="S3.E11.m1.4.4.1.1.1.1.1.4.2" xref="S3.E11.m1.4.4.1.1.1.1.1.4.2.cmml"><mi id="S3.E11.m1.4.4.1.1.1.1.1.4.2.2" xref="S3.E11.m1.4.4.1.1.1.1.1.4.2.2.cmml">W</mi><mi id="S3.E11.m1.4.4.1.1.1.1.1.4.2.3" xref="S3.E11.m1.4.4.1.1.1.1.1.4.2.3.cmml">h</mi></msub><mo lspace="0em" rspace="0em" id="S3.E11.m1.4.4.1.1.1.1.1.4.1" xref="S3.E11.m1.4.4.1.1.1.1.1.4.1.cmml">​</mo><msubsup id="S3.E11.m1.4.4.1.1.1.1.1.4.3" xref="S3.E11.m1.4.4.1.1.1.1.1.4.3.cmml"><mi id="S3.E11.m1.4.4.1.1.1.1.1.4.3.2.2" xref="S3.E11.m1.4.4.1.1.1.1.1.4.3.2.2.cmml">𝐡</mi><mi id="S3.E11.m1.4.4.1.1.1.1.1.4.3.3" xref="S3.E11.m1.4.4.1.1.1.1.1.4.3.3.cmml">t</mi><mn id="S3.E11.m1.4.4.1.1.1.1.1.4.3.2.3" xref="S3.E11.m1.4.4.1.1.1.1.1.4.3.2.3.cmml">1</mn></msubsup></mrow></mrow><mo stretchy="false" id="S3.E11.m1.4.4.1.1.1.1.3" xref="S3.E11.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.4b"><apply id="S3.E11.m1.4.4.cmml" xref="S3.E11.m1.4.4"><eq id="S3.E11.m1.4.4.2.cmml" xref="S3.E11.m1.4.4.2"></eq><apply id="S3.E11.m1.4.4.3.cmml" xref="S3.E11.m1.4.4.3"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.3.1.cmml" xref="S3.E11.m1.4.4.3">subscript</csymbol><ci id="S3.E11.m1.4.4.3.2.cmml" xref="S3.E11.m1.4.4.3.2">𝛼</ci><list id="S3.E11.m1.2.2.2.3.cmml" xref="S3.E11.m1.2.2.2.4"><ci id="S3.E11.m1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1">𝑖</ci><ci id="S3.E11.m1.2.2.2.2.cmml" xref="S3.E11.m1.2.2.2.2">𝑡</ci></list></apply><apply id="S3.E11.m1.4.4.1.cmml" xref="S3.E11.m1.4.4.1"><times id="S3.E11.m1.4.4.1.2.cmml" xref="S3.E11.m1.4.4.1.2"></times><apply id="S3.E11.m1.4.4.1.3.cmml" xref="S3.E11.m1.4.4.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.1.3.1.cmml" xref="S3.E11.m1.4.4.1.3">superscript</csymbol><apply id="S3.E11.m1.4.4.1.3.2.cmml" xref="S3.E11.m1.4.4.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.1.3.2.1.cmml" xref="S3.E11.m1.4.4.1.3">subscript</csymbol><ci id="S3.E11.m1.4.4.1.3.2.2.cmml" xref="S3.E11.m1.4.4.1.3.2.2">𝑊</ci><apply id="S3.E11.m1.4.4.1.3.2.3.cmml" xref="S3.E11.m1.4.4.1.3.2.3"><times id="S3.E11.m1.4.4.1.3.2.3.1.cmml" xref="S3.E11.m1.4.4.1.3.2.3.1"></times><ci id="S3.E11.m1.4.4.1.3.2.3.2.cmml" xref="S3.E11.m1.4.4.1.3.2.3.2">𝑎</ci><ci id="S3.E11.m1.4.4.1.3.2.3.3.cmml" xref="S3.E11.m1.4.4.1.3.2.3.3">𝑡</ci><ci id="S3.E11.m1.4.4.1.3.2.3.4.cmml" xref="S3.E11.m1.4.4.1.3.2.3.4">𝑡</ci></apply></apply><csymbol cd="latexml" id="S3.E11.m1.4.4.1.3.3.cmml" xref="S3.E11.m1.4.4.1.3.3">top</csymbol></apply><apply id="S3.E11.m1.4.4.1.1.2.cmml" xref="S3.E11.m1.4.4.1.1.1"><tanh id="S3.E11.m1.3.3.cmml" xref="S3.E11.m1.3.3"></tanh><apply id="S3.E11.m1.4.4.1.1.1.1.1.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1"><plus id="S3.E11.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.1"></plus><apply id="S3.E11.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.2"><times id="S3.E11.m1.4.4.1.1.1.1.1.2.1.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.2.1"></times><apply id="S3.E11.m1.4.4.1.1.1.1.1.2.2.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.1.1.1.1.1.2.2.1.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E11.m1.4.4.1.1.1.1.1.2.2.2.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.2.2.2">𝑊</ci><ci id="S3.E11.m1.4.4.1.1.1.1.1.2.2.3.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.2.2.3">𝑧</ci></apply><apply id="S3.E11.m1.4.4.1.1.1.1.1.2.3.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.1.1.1.1.1.2.3.1.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E11.m1.4.4.1.1.1.1.1.2.3.2.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.2.3.2">𝐳</ci><ci id="S3.E11.m1.4.4.1.1.1.1.1.2.3.3.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S3.E11.m1.4.4.1.1.1.1.1.3.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.1.1.1.1.1.3.1.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E11.m1.4.4.1.1.1.1.1.3.2.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.3.2">𝐛</ci><ci id="S3.E11.m1.4.4.1.1.1.1.1.3.3.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.3.3">𝑧</ci></apply><apply id="S3.E11.m1.4.4.1.1.1.1.1.4.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.4"><times id="S3.E11.m1.4.4.1.1.1.1.1.4.1.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.4.1"></times><apply id="S3.E11.m1.4.4.1.1.1.1.1.4.2.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.1.1.1.1.1.4.2.1.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E11.m1.4.4.1.1.1.1.1.4.2.2.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.4.2.2">𝑊</ci><ci id="S3.E11.m1.4.4.1.1.1.1.1.4.2.3.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.4.2.3">ℎ</ci></apply><apply id="S3.E11.m1.4.4.1.1.1.1.1.4.3.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.1.1.1.1.1.4.3.1.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.4.3">subscript</csymbol><apply id="S3.E11.m1.4.4.1.1.1.1.1.4.3.2.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.1.1.1.1.1.4.3.2.1.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.4.3">superscript</csymbol><ci id="S3.E11.m1.4.4.1.1.1.1.1.4.3.2.2.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.4.3.2.2">𝐡</ci><cn type="integer" id="S3.E11.m1.4.4.1.1.1.1.1.4.3.2.3.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.4.3.2.3">1</cn></apply><ci id="S3.E11.m1.4.4.1.1.1.1.1.4.3.3.cmml" xref="S3.E11.m1.4.4.1.1.1.1.1.4.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.4c">\alpha_{i,t}=W_{att}^{\top}\tanh(W_{z}{\bf z}_{i}+{\bf b}_{z}+W_{h}{\bf h}^{1}_{t})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS5.p4.4" class="ltx_p">where <math id="S3.SS1.SSS5.p4.1.m1.1" class="ltx_Math" alttext="W_{att}\in\mathbb{R}^{N}" display="inline"><semantics id="S3.SS1.SSS5.p4.1.m1.1a"><mrow id="S3.SS1.SSS5.p4.1.m1.1.1" xref="S3.SS1.SSS5.p4.1.m1.1.1.cmml"><msub id="S3.SS1.SSS5.p4.1.m1.1.1.2" xref="S3.SS1.SSS5.p4.1.m1.1.1.2.cmml"><mi id="S3.SS1.SSS5.p4.1.m1.1.1.2.2" xref="S3.SS1.SSS5.p4.1.m1.1.1.2.2.cmml">W</mi><mrow id="S3.SS1.SSS5.p4.1.m1.1.1.2.3" xref="S3.SS1.SSS5.p4.1.m1.1.1.2.3.cmml"><mi id="S3.SS1.SSS5.p4.1.m1.1.1.2.3.2" xref="S3.SS1.SSS5.p4.1.m1.1.1.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS5.p4.1.m1.1.1.2.3.1" xref="S3.SS1.SSS5.p4.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.SSS5.p4.1.m1.1.1.2.3.3" xref="S3.SS1.SSS5.p4.1.m1.1.1.2.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS5.p4.1.m1.1.1.2.3.1a" xref="S3.SS1.SSS5.p4.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.SSS5.p4.1.m1.1.1.2.3.4" xref="S3.SS1.SSS5.p4.1.m1.1.1.2.3.4.cmml">t</mi></mrow></msub><mo id="S3.SS1.SSS5.p4.1.m1.1.1.1" xref="S3.SS1.SSS5.p4.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS5.p4.1.m1.1.1.3" xref="S3.SS1.SSS5.p4.1.m1.1.1.3.cmml"><mi id="S3.SS1.SSS5.p4.1.m1.1.1.3.2" xref="S3.SS1.SSS5.p4.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.SSS5.p4.1.m1.1.1.3.3" xref="S3.SS1.SSS5.p4.1.m1.1.1.3.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p4.1.m1.1b"><apply id="S3.SS1.SSS5.p4.1.m1.1.1.cmml" xref="S3.SS1.SSS5.p4.1.m1.1.1"><in id="S3.SS1.SSS5.p4.1.m1.1.1.1.cmml" xref="S3.SS1.SSS5.p4.1.m1.1.1.1"></in><apply id="S3.SS1.SSS5.p4.1.m1.1.1.2.cmml" xref="S3.SS1.SSS5.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p4.1.m1.1.1.2.1.cmml" xref="S3.SS1.SSS5.p4.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS5.p4.1.m1.1.1.2.2.cmml" xref="S3.SS1.SSS5.p4.1.m1.1.1.2.2">𝑊</ci><apply id="S3.SS1.SSS5.p4.1.m1.1.1.2.3.cmml" xref="S3.SS1.SSS5.p4.1.m1.1.1.2.3"><times id="S3.SS1.SSS5.p4.1.m1.1.1.2.3.1.cmml" xref="S3.SS1.SSS5.p4.1.m1.1.1.2.3.1"></times><ci id="S3.SS1.SSS5.p4.1.m1.1.1.2.3.2.cmml" xref="S3.SS1.SSS5.p4.1.m1.1.1.2.3.2">𝑎</ci><ci id="S3.SS1.SSS5.p4.1.m1.1.1.2.3.3.cmml" xref="S3.SS1.SSS5.p4.1.m1.1.1.2.3.3">𝑡</ci><ci id="S3.SS1.SSS5.p4.1.m1.1.1.2.3.4.cmml" xref="S3.SS1.SSS5.p4.1.m1.1.1.2.3.4">𝑡</ci></apply></apply><apply id="S3.SS1.SSS5.p4.1.m1.1.1.3.cmml" xref="S3.SS1.SSS5.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p4.1.m1.1.1.3.1.cmml" xref="S3.SS1.SSS5.p4.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS5.p4.1.m1.1.1.3.2.cmml" xref="S3.SS1.SSS5.p4.1.m1.1.1.3.2">ℝ</ci><ci id="S3.SS1.SSS5.p4.1.m1.1.1.3.3.cmml" xref="S3.SS1.SSS5.p4.1.m1.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p4.1.m1.1c">W_{att}\in\mathbb{R}^{N}</annotation></semantics></math>, <math id="S3.SS1.SSS5.p4.2.m2.1" class="ltx_Math" alttext="W_{z}\in\mathbb{R}^{N\times N_{z}}" display="inline"><semantics id="S3.SS1.SSS5.p4.2.m2.1a"><mrow id="S3.SS1.SSS5.p4.2.m2.1.1" xref="S3.SS1.SSS5.p4.2.m2.1.1.cmml"><msub id="S3.SS1.SSS5.p4.2.m2.1.1.2" xref="S3.SS1.SSS5.p4.2.m2.1.1.2.cmml"><mi id="S3.SS1.SSS5.p4.2.m2.1.1.2.2" xref="S3.SS1.SSS5.p4.2.m2.1.1.2.2.cmml">W</mi><mi id="S3.SS1.SSS5.p4.2.m2.1.1.2.3" xref="S3.SS1.SSS5.p4.2.m2.1.1.2.3.cmml">z</mi></msub><mo id="S3.SS1.SSS5.p4.2.m2.1.1.1" xref="S3.SS1.SSS5.p4.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS5.p4.2.m2.1.1.3" xref="S3.SS1.SSS5.p4.2.m2.1.1.3.cmml"><mi id="S3.SS1.SSS5.p4.2.m2.1.1.3.2" xref="S3.SS1.SSS5.p4.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS5.p4.2.m2.1.1.3.3" xref="S3.SS1.SSS5.p4.2.m2.1.1.3.3.cmml"><mi id="S3.SS1.SSS5.p4.2.m2.1.1.3.3.2" xref="S3.SS1.SSS5.p4.2.m2.1.1.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS5.p4.2.m2.1.1.3.3.1" xref="S3.SS1.SSS5.p4.2.m2.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.SSS5.p4.2.m2.1.1.3.3.3" xref="S3.SS1.SSS5.p4.2.m2.1.1.3.3.3.cmml"><mi id="S3.SS1.SSS5.p4.2.m2.1.1.3.3.3.2" xref="S3.SS1.SSS5.p4.2.m2.1.1.3.3.3.2.cmml">N</mi><mi id="S3.SS1.SSS5.p4.2.m2.1.1.3.3.3.3" xref="S3.SS1.SSS5.p4.2.m2.1.1.3.3.3.3.cmml">z</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p4.2.m2.1b"><apply id="S3.SS1.SSS5.p4.2.m2.1.1.cmml" xref="S3.SS1.SSS5.p4.2.m2.1.1"><in id="S3.SS1.SSS5.p4.2.m2.1.1.1.cmml" xref="S3.SS1.SSS5.p4.2.m2.1.1.1"></in><apply id="S3.SS1.SSS5.p4.2.m2.1.1.2.cmml" xref="S3.SS1.SSS5.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p4.2.m2.1.1.2.1.cmml" xref="S3.SS1.SSS5.p4.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS5.p4.2.m2.1.1.2.2.cmml" xref="S3.SS1.SSS5.p4.2.m2.1.1.2.2">𝑊</ci><ci id="S3.SS1.SSS5.p4.2.m2.1.1.2.3.cmml" xref="S3.SS1.SSS5.p4.2.m2.1.1.2.3">𝑧</ci></apply><apply id="S3.SS1.SSS5.p4.2.m2.1.1.3.cmml" xref="S3.SS1.SSS5.p4.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p4.2.m2.1.1.3.1.cmml" xref="S3.SS1.SSS5.p4.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS5.p4.2.m2.1.1.3.2.cmml" xref="S3.SS1.SSS5.p4.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS5.p4.2.m2.1.1.3.3.cmml" xref="S3.SS1.SSS5.p4.2.m2.1.1.3.3"><times id="S3.SS1.SSS5.p4.2.m2.1.1.3.3.1.cmml" xref="S3.SS1.SSS5.p4.2.m2.1.1.3.3.1"></times><ci id="S3.SS1.SSS5.p4.2.m2.1.1.3.3.2.cmml" xref="S3.SS1.SSS5.p4.2.m2.1.1.3.3.2">𝑁</ci><apply id="S3.SS1.SSS5.p4.2.m2.1.1.3.3.3.cmml" xref="S3.SS1.SSS5.p4.2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p4.2.m2.1.1.3.3.3.1.cmml" xref="S3.SS1.SSS5.p4.2.m2.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.SSS5.p4.2.m2.1.1.3.3.3.2.cmml" xref="S3.SS1.SSS5.p4.2.m2.1.1.3.3.3.2">𝑁</ci><ci id="S3.SS1.SSS5.p4.2.m2.1.1.3.3.3.3.cmml" xref="S3.SS1.SSS5.p4.2.m2.1.1.3.3.3.3">𝑧</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p4.2.m2.1c">W_{z}\in\mathbb{R}^{N\times N_{z}}</annotation></semantics></math>,
<math id="S3.SS1.SSS5.p4.3.m3.1" class="ltx_Math" alttext="{\bf b}_{z}\in\mathbb{R}^{N}" display="inline"><semantics id="S3.SS1.SSS5.p4.3.m3.1a"><mrow id="S3.SS1.SSS5.p4.3.m3.1.1" xref="S3.SS1.SSS5.p4.3.m3.1.1.cmml"><msub id="S3.SS1.SSS5.p4.3.m3.1.1.2" xref="S3.SS1.SSS5.p4.3.m3.1.1.2.cmml"><mi id="S3.SS1.SSS5.p4.3.m3.1.1.2.2" xref="S3.SS1.SSS5.p4.3.m3.1.1.2.2.cmml">𝐛</mi><mi id="S3.SS1.SSS5.p4.3.m3.1.1.2.3" xref="S3.SS1.SSS5.p4.3.m3.1.1.2.3.cmml">z</mi></msub><mo id="S3.SS1.SSS5.p4.3.m3.1.1.1" xref="S3.SS1.SSS5.p4.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS5.p4.3.m3.1.1.3" xref="S3.SS1.SSS5.p4.3.m3.1.1.3.cmml"><mi id="S3.SS1.SSS5.p4.3.m3.1.1.3.2" xref="S3.SS1.SSS5.p4.3.m3.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.SSS5.p4.3.m3.1.1.3.3" xref="S3.SS1.SSS5.p4.3.m3.1.1.3.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p4.3.m3.1b"><apply id="S3.SS1.SSS5.p4.3.m3.1.1.cmml" xref="S3.SS1.SSS5.p4.3.m3.1.1"><in id="S3.SS1.SSS5.p4.3.m3.1.1.1.cmml" xref="S3.SS1.SSS5.p4.3.m3.1.1.1"></in><apply id="S3.SS1.SSS5.p4.3.m3.1.1.2.cmml" xref="S3.SS1.SSS5.p4.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p4.3.m3.1.1.2.1.cmml" xref="S3.SS1.SSS5.p4.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS5.p4.3.m3.1.1.2.2.cmml" xref="S3.SS1.SSS5.p4.3.m3.1.1.2.2">𝐛</ci><ci id="S3.SS1.SSS5.p4.3.m3.1.1.2.3.cmml" xref="S3.SS1.SSS5.p4.3.m3.1.1.2.3">𝑧</ci></apply><apply id="S3.SS1.SSS5.p4.3.m3.1.1.3.cmml" xref="S3.SS1.SSS5.p4.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p4.3.m3.1.1.3.1.cmml" xref="S3.SS1.SSS5.p4.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS5.p4.3.m3.1.1.3.2.cmml" xref="S3.SS1.SSS5.p4.3.m3.1.1.3.2">ℝ</ci><ci id="S3.SS1.SSS5.p4.3.m3.1.1.3.3.cmml" xref="S3.SS1.SSS5.p4.3.m3.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p4.3.m3.1c">{\bf b}_{z}\in\mathbb{R}^{N}</annotation></semantics></math> and <math id="S3.SS1.SSS5.p4.4.m4.1" class="ltx_Math" alttext="W_{h}\in\mathbb{R}^{N\times N_{h}}" display="inline"><semantics id="S3.SS1.SSS5.p4.4.m4.1a"><mrow id="S3.SS1.SSS5.p4.4.m4.1.1" xref="S3.SS1.SSS5.p4.4.m4.1.1.cmml"><msub id="S3.SS1.SSS5.p4.4.m4.1.1.2" xref="S3.SS1.SSS5.p4.4.m4.1.1.2.cmml"><mi id="S3.SS1.SSS5.p4.4.m4.1.1.2.2" xref="S3.SS1.SSS5.p4.4.m4.1.1.2.2.cmml">W</mi><mi id="S3.SS1.SSS5.p4.4.m4.1.1.2.3" xref="S3.SS1.SSS5.p4.4.m4.1.1.2.3.cmml">h</mi></msub><mo id="S3.SS1.SSS5.p4.4.m4.1.1.1" xref="S3.SS1.SSS5.p4.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS5.p4.4.m4.1.1.3" xref="S3.SS1.SSS5.p4.4.m4.1.1.3.cmml"><mi id="S3.SS1.SSS5.p4.4.m4.1.1.3.2" xref="S3.SS1.SSS5.p4.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS5.p4.4.m4.1.1.3.3" xref="S3.SS1.SSS5.p4.4.m4.1.1.3.3.cmml"><mi id="S3.SS1.SSS5.p4.4.m4.1.1.3.3.2" xref="S3.SS1.SSS5.p4.4.m4.1.1.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS5.p4.4.m4.1.1.3.3.1" xref="S3.SS1.SSS5.p4.4.m4.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.SSS5.p4.4.m4.1.1.3.3.3" xref="S3.SS1.SSS5.p4.4.m4.1.1.3.3.3.cmml"><mi id="S3.SS1.SSS5.p4.4.m4.1.1.3.3.3.2" xref="S3.SS1.SSS5.p4.4.m4.1.1.3.3.3.2.cmml">N</mi><mi id="S3.SS1.SSS5.p4.4.m4.1.1.3.3.3.3" xref="S3.SS1.SSS5.p4.4.m4.1.1.3.3.3.3.cmml">h</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p4.4.m4.1b"><apply id="S3.SS1.SSS5.p4.4.m4.1.1.cmml" xref="S3.SS1.SSS5.p4.4.m4.1.1"><in id="S3.SS1.SSS5.p4.4.m4.1.1.1.cmml" xref="S3.SS1.SSS5.p4.4.m4.1.1.1"></in><apply id="S3.SS1.SSS5.p4.4.m4.1.1.2.cmml" xref="S3.SS1.SSS5.p4.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p4.4.m4.1.1.2.1.cmml" xref="S3.SS1.SSS5.p4.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS5.p4.4.m4.1.1.2.2.cmml" xref="S3.SS1.SSS5.p4.4.m4.1.1.2.2">𝑊</ci><ci id="S3.SS1.SSS5.p4.4.m4.1.1.2.3.cmml" xref="S3.SS1.SSS5.p4.4.m4.1.1.2.3">ℎ</ci></apply><apply id="S3.SS1.SSS5.p4.4.m4.1.1.3.cmml" xref="S3.SS1.SSS5.p4.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p4.4.m4.1.1.3.1.cmml" xref="S3.SS1.SSS5.p4.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS5.p4.4.m4.1.1.3.2.cmml" xref="S3.SS1.SSS5.p4.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS5.p4.4.m4.1.1.3.3.cmml" xref="S3.SS1.SSS5.p4.4.m4.1.1.3.3"><times id="S3.SS1.SSS5.p4.4.m4.1.1.3.3.1.cmml" xref="S3.SS1.SSS5.p4.4.m4.1.1.3.3.1"></times><ci id="S3.SS1.SSS5.p4.4.m4.1.1.3.3.2.cmml" xref="S3.SS1.SSS5.p4.4.m4.1.1.3.3.2">𝑁</ci><apply id="S3.SS1.SSS5.p4.4.m4.1.1.3.3.3.cmml" xref="S3.SS1.SSS5.p4.4.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p4.4.m4.1.1.3.3.3.1.cmml" xref="S3.SS1.SSS5.p4.4.m4.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.SSS5.p4.4.m4.1.1.3.3.3.2.cmml" xref="S3.SS1.SSS5.p4.4.m4.1.1.3.3.3.2">𝑁</ci><ci id="S3.SS1.SSS5.p4.4.m4.1.1.3.3.3.3.cmml" xref="S3.SS1.SSS5.p4.4.m4.1.1.3.3.3.3">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p4.4.m4.1c">W_{h}\in\mathbb{R}^{N\times N_{h}}</annotation></semantics></math>
are the model parameters.
The attention weights are further normalized by a softmax function
to compute the dynamically attended image visual features:</p>
<table id="S5.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E12.m1.4" class="ltx_Math" alttext="\displaystyle{\bf\beta}_{t}=\mbox{softmax}({\bf\alpha}_{t}),\qquad{\bf\hat{c}}_{t}=\sum_{i=1}^{i=k}\beta_{i,t}{\bf v}_{i}" display="inline"><semantics id="S3.E12.m1.4a"><mrow id="S3.E12.m1.4.4.2" xref="S3.E12.m1.4.4.3.cmml"><mrow id="S3.E12.m1.3.3.1.1" xref="S3.E12.m1.3.3.1.1.cmml"><msub id="S3.E12.m1.3.3.1.1.3" xref="S3.E12.m1.3.3.1.1.3.cmml"><mi id="S3.E12.m1.3.3.1.1.3.2" xref="S3.E12.m1.3.3.1.1.3.2.cmml">β</mi><mi id="S3.E12.m1.3.3.1.1.3.3" xref="S3.E12.m1.3.3.1.1.3.3.cmml">t</mi></msub><mo id="S3.E12.m1.3.3.1.1.2" xref="S3.E12.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E12.m1.3.3.1.1.1" xref="S3.E12.m1.3.3.1.1.1.cmml"><mtext id="S3.E12.m1.3.3.1.1.1.3" xref="S3.E12.m1.3.3.1.1.1.3a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E12.m1.3.3.1.1.1.2" xref="S3.E12.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E12.m1.3.3.1.1.1.1.1" xref="S3.E12.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E12.m1.3.3.1.1.1.1.1.2" xref="S3.E12.m1.3.3.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E12.m1.3.3.1.1.1.1.1.1" xref="S3.E12.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.2" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.cmml">α</mi><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.3" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S3.E12.m1.3.3.1.1.1.1.1.3" xref="S3.E12.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="2.167em" id="S3.E12.m1.4.4.2.3" xref="S3.E12.m1.4.4.3a.cmml">,</mo><mrow id="S3.E12.m1.4.4.2.2" xref="S3.E12.m1.4.4.2.2.cmml"><msub id="S3.E12.m1.4.4.2.2.2" xref="S3.E12.m1.4.4.2.2.2.cmml"><mover accent="true" id="S3.E12.m1.4.4.2.2.2.2" xref="S3.E12.m1.4.4.2.2.2.2.cmml"><mi id="S3.E12.m1.4.4.2.2.2.2.2" xref="S3.E12.m1.4.4.2.2.2.2.2.cmml">𝐜</mi><mo id="S3.E12.m1.4.4.2.2.2.2.1" xref="S3.E12.m1.4.4.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E12.m1.4.4.2.2.2.3" xref="S3.E12.m1.4.4.2.2.2.3.cmml">t</mi></msub><mo id="S3.E12.m1.4.4.2.2.1" xref="S3.E12.m1.4.4.2.2.1.cmml">=</mo><mrow id="S3.E12.m1.4.4.2.2.3" xref="S3.E12.m1.4.4.2.2.3.cmml"><mstyle displaystyle="true" id="S3.E12.m1.4.4.2.2.3.1" xref="S3.E12.m1.4.4.2.2.3.1.cmml"><munderover id="S3.E12.m1.4.4.2.2.3.1a" xref="S3.E12.m1.4.4.2.2.3.1.cmml"><mo movablelimits="false" id="S3.E12.m1.4.4.2.2.3.1.2.2" xref="S3.E12.m1.4.4.2.2.3.1.2.2.cmml">∑</mo><mrow id="S3.E12.m1.4.4.2.2.3.1.2.3" xref="S3.E12.m1.4.4.2.2.3.1.2.3.cmml"><mi id="S3.E12.m1.4.4.2.2.3.1.2.3.2" xref="S3.E12.m1.4.4.2.2.3.1.2.3.2.cmml">i</mi><mo id="S3.E12.m1.4.4.2.2.3.1.2.3.1" xref="S3.E12.m1.4.4.2.2.3.1.2.3.1.cmml">=</mo><mn id="S3.E12.m1.4.4.2.2.3.1.2.3.3" xref="S3.E12.m1.4.4.2.2.3.1.2.3.3.cmml">1</mn></mrow><mrow id="S3.E12.m1.4.4.2.2.3.1.3" xref="S3.E12.m1.4.4.2.2.3.1.3.cmml"><mi id="S3.E12.m1.4.4.2.2.3.1.3.2" xref="S3.E12.m1.4.4.2.2.3.1.3.2.cmml">i</mi><mo id="S3.E12.m1.4.4.2.2.3.1.3.1" xref="S3.E12.m1.4.4.2.2.3.1.3.1.cmml">=</mo><mi id="S3.E12.m1.4.4.2.2.3.1.3.3" xref="S3.E12.m1.4.4.2.2.3.1.3.3.cmml">k</mi></mrow></munderover></mstyle><mrow id="S3.E12.m1.4.4.2.2.3.2" xref="S3.E12.m1.4.4.2.2.3.2.cmml"><msub id="S3.E12.m1.4.4.2.2.3.2.2" xref="S3.E12.m1.4.4.2.2.3.2.2.cmml"><mi id="S3.E12.m1.4.4.2.2.3.2.2.2" xref="S3.E12.m1.4.4.2.2.3.2.2.2.cmml">β</mi><mrow id="S3.E12.m1.2.2.2.4" xref="S3.E12.m1.2.2.2.3.cmml"><mi id="S3.E12.m1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.cmml">i</mi><mo id="S3.E12.m1.2.2.2.4.1" xref="S3.E12.m1.2.2.2.3.cmml">,</mo><mi id="S3.E12.m1.2.2.2.2" xref="S3.E12.m1.2.2.2.2.cmml">t</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E12.m1.4.4.2.2.3.2.1" xref="S3.E12.m1.4.4.2.2.3.2.1.cmml">​</mo><msub id="S3.E12.m1.4.4.2.2.3.2.3" xref="S3.E12.m1.4.4.2.2.3.2.3.cmml"><mi id="S3.E12.m1.4.4.2.2.3.2.3.2" xref="S3.E12.m1.4.4.2.2.3.2.3.2.cmml">𝐯</mi><mi id="S3.E12.m1.4.4.2.2.3.2.3.3" xref="S3.E12.m1.4.4.2.2.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.4b"><apply id="S3.E12.m1.4.4.3.cmml" xref="S3.E12.m1.4.4.2"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.3a.cmml" xref="S3.E12.m1.4.4.2.3">formulae-sequence</csymbol><apply id="S3.E12.m1.3.3.1.1.cmml" xref="S3.E12.m1.3.3.1.1"><eq id="S3.E12.m1.3.3.1.1.2.cmml" xref="S3.E12.m1.3.3.1.1.2"></eq><apply id="S3.E12.m1.3.3.1.1.3.cmml" xref="S3.E12.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.3.1.cmml" xref="S3.E12.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.E12.m1.3.3.1.1.3.2.cmml" xref="S3.E12.m1.3.3.1.1.3.2">𝛽</ci><ci id="S3.E12.m1.3.3.1.1.3.3.cmml" xref="S3.E12.m1.3.3.1.1.3.3">𝑡</ci></apply><apply id="S3.E12.m1.3.3.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.1"><times id="S3.E12.m1.3.3.1.1.1.2.cmml" xref="S3.E12.m1.3.3.1.1.1.2"></times><ci id="S3.E12.m1.3.3.1.1.1.3a.cmml" xref="S3.E12.m1.3.3.1.1.1.3"><mtext id="S3.E12.m1.3.3.1.1.1.3.cmml" xref="S3.E12.m1.3.3.1.1.1.3">softmax</mtext></ci><apply id="S3.E12.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2">𝛼</ci><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply><apply id="S3.E12.m1.4.4.2.2.cmml" xref="S3.E12.m1.4.4.2.2"><eq id="S3.E12.m1.4.4.2.2.1.cmml" xref="S3.E12.m1.4.4.2.2.1"></eq><apply id="S3.E12.m1.4.4.2.2.2.cmml" xref="S3.E12.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.2.2.2.1.cmml" xref="S3.E12.m1.4.4.2.2.2">subscript</csymbol><apply id="S3.E12.m1.4.4.2.2.2.2.cmml" xref="S3.E12.m1.4.4.2.2.2.2"><ci id="S3.E12.m1.4.4.2.2.2.2.1.cmml" xref="S3.E12.m1.4.4.2.2.2.2.1">^</ci><ci id="S3.E12.m1.4.4.2.2.2.2.2.cmml" xref="S3.E12.m1.4.4.2.2.2.2.2">𝐜</ci></apply><ci id="S3.E12.m1.4.4.2.2.2.3.cmml" xref="S3.E12.m1.4.4.2.2.2.3">𝑡</ci></apply><apply id="S3.E12.m1.4.4.2.2.3.cmml" xref="S3.E12.m1.4.4.2.2.3"><apply id="S3.E12.m1.4.4.2.2.3.1.cmml" xref="S3.E12.m1.4.4.2.2.3.1"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.2.2.3.1.1.cmml" xref="S3.E12.m1.4.4.2.2.3.1">superscript</csymbol><apply id="S3.E12.m1.4.4.2.2.3.1.2.cmml" xref="S3.E12.m1.4.4.2.2.3.1"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.2.2.3.1.2.1.cmml" xref="S3.E12.m1.4.4.2.2.3.1">subscript</csymbol><sum id="S3.E12.m1.4.4.2.2.3.1.2.2.cmml" xref="S3.E12.m1.4.4.2.2.3.1.2.2"></sum><apply id="S3.E12.m1.4.4.2.2.3.1.2.3.cmml" xref="S3.E12.m1.4.4.2.2.3.1.2.3"><eq id="S3.E12.m1.4.4.2.2.3.1.2.3.1.cmml" xref="S3.E12.m1.4.4.2.2.3.1.2.3.1"></eq><ci id="S3.E12.m1.4.4.2.2.3.1.2.3.2.cmml" xref="S3.E12.m1.4.4.2.2.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E12.m1.4.4.2.2.3.1.2.3.3.cmml" xref="S3.E12.m1.4.4.2.2.3.1.2.3.3">1</cn></apply></apply><apply id="S3.E12.m1.4.4.2.2.3.1.3.cmml" xref="S3.E12.m1.4.4.2.2.3.1.3"><eq id="S3.E12.m1.4.4.2.2.3.1.3.1.cmml" xref="S3.E12.m1.4.4.2.2.3.1.3.1"></eq><ci id="S3.E12.m1.4.4.2.2.3.1.3.2.cmml" xref="S3.E12.m1.4.4.2.2.3.1.3.2">𝑖</ci><ci id="S3.E12.m1.4.4.2.2.3.1.3.3.cmml" xref="S3.E12.m1.4.4.2.2.3.1.3.3">𝑘</ci></apply></apply><apply id="S3.E12.m1.4.4.2.2.3.2.cmml" xref="S3.E12.m1.4.4.2.2.3.2"><times id="S3.E12.m1.4.4.2.2.3.2.1.cmml" xref="S3.E12.m1.4.4.2.2.3.2.1"></times><apply id="S3.E12.m1.4.4.2.2.3.2.2.cmml" xref="S3.E12.m1.4.4.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.2.2.3.2.2.1.cmml" xref="S3.E12.m1.4.4.2.2.3.2.2">subscript</csymbol><ci id="S3.E12.m1.4.4.2.2.3.2.2.2.cmml" xref="S3.E12.m1.4.4.2.2.3.2.2.2">𝛽</ci><list id="S3.E12.m1.2.2.2.3.cmml" xref="S3.E12.m1.2.2.2.4"><ci id="S3.E12.m1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1">𝑖</ci><ci id="S3.E12.m1.2.2.2.2.cmml" xref="S3.E12.m1.2.2.2.2">𝑡</ci></list></apply><apply id="S3.E12.m1.4.4.2.2.3.2.3.cmml" xref="S3.E12.m1.4.4.2.2.3.2.3"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.2.2.3.2.3.1.cmml" xref="S3.E12.m1.4.4.2.2.3.2.3">subscript</csymbol><ci id="S3.E12.m1.4.4.2.2.3.2.3.2.cmml" xref="S3.E12.m1.4.4.2.2.3.2.3.2">𝐯</ci><ci id="S3.E12.m1.4.4.2.2.3.2.3.3.cmml" xref="S3.E12.m1.4.4.2.2.3.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.4c">\displaystyle{\bf\beta}_{t}=\mbox{softmax}({\bf\alpha}_{t}),\qquad{\bf\hat{c}}_{t}=\sum_{i=1}^{i=k}\beta_{i,t}{\bf v}_{i}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS5.p4.7" class="ltx_p">Note that the attention weights are determined by two factors, <math id="S3.SS1.SSS5.p4.5.m1.1" class="ltx_Math" alttext="\{{\bf z}_{i}\}" display="inline"><semantics id="S3.SS1.SSS5.p4.5.m1.1a"><mrow id="S3.SS1.SSS5.p4.5.m1.1.1.1" xref="S3.SS1.SSS5.p4.5.m1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.SSS5.p4.5.m1.1.1.1.2" xref="S3.SS1.SSS5.p4.5.m1.1.1.2.cmml">{</mo><msub id="S3.SS1.SSS5.p4.5.m1.1.1.1.1" xref="S3.SS1.SSS5.p4.5.m1.1.1.1.1.cmml"><mi id="S3.SS1.SSS5.p4.5.m1.1.1.1.1.2" xref="S3.SS1.SSS5.p4.5.m1.1.1.1.1.2.cmml">𝐳</mi><mi id="S3.SS1.SSS5.p4.5.m1.1.1.1.1.3" xref="S3.SS1.SSS5.p4.5.m1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.SSS5.p4.5.m1.1.1.1.3" xref="S3.SS1.SSS5.p4.5.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p4.5.m1.1b"><set id="S3.SS1.SSS5.p4.5.m1.1.1.2.cmml" xref="S3.SS1.SSS5.p4.5.m1.1.1.1"><apply id="S3.SS1.SSS5.p4.5.m1.1.1.1.1.cmml" xref="S3.SS1.SSS5.p4.5.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p4.5.m1.1.1.1.1.1.cmml" xref="S3.SS1.SSS5.p4.5.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS5.p4.5.m1.1.1.1.1.2.cmml" xref="S3.SS1.SSS5.p4.5.m1.1.1.1.1.2">𝐳</ci><ci id="S3.SS1.SSS5.p4.5.m1.1.1.1.1.3.cmml" xref="S3.SS1.SSS5.p4.5.m1.1.1.1.1.3">𝑖</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p4.5.m1.1c">\{{\bf z}_{i}\}</annotation></semantics></math> and <math id="S3.SS1.SSS5.p4.6.m2.1" class="ltx_Math" alttext="{\bf h}^{1}_{t}" display="inline"><semantics id="S3.SS1.SSS5.p4.6.m2.1a"><msubsup id="S3.SS1.SSS5.p4.6.m2.1.1" xref="S3.SS1.SSS5.p4.6.m2.1.1.cmml"><mi id="S3.SS1.SSS5.p4.6.m2.1.1.2.2" xref="S3.SS1.SSS5.p4.6.m2.1.1.2.2.cmml">𝐡</mi><mi id="S3.SS1.SSS5.p4.6.m2.1.1.3" xref="S3.SS1.SSS5.p4.6.m2.1.1.3.cmml">t</mi><mn id="S3.SS1.SSS5.p4.6.m2.1.1.2.3" xref="S3.SS1.SSS5.p4.6.m2.1.1.2.3.cmml">1</mn></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p4.6.m2.1b"><apply id="S3.SS1.SSS5.p4.6.m2.1.1.cmml" xref="S3.SS1.SSS5.p4.6.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p4.6.m2.1.1.1.cmml" xref="S3.SS1.SSS5.p4.6.m2.1.1">subscript</csymbol><apply id="S3.SS1.SSS5.p4.6.m2.1.1.2.cmml" xref="S3.SS1.SSS5.p4.6.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p4.6.m2.1.1.2.1.cmml" xref="S3.SS1.SSS5.p4.6.m2.1.1">superscript</csymbol><ci id="S3.SS1.SSS5.p4.6.m2.1.1.2.2.cmml" xref="S3.SS1.SSS5.p4.6.m2.1.1.2.2">𝐡</ci><cn type="integer" id="S3.SS1.SSS5.p4.6.m2.1.1.2.3.cmml" xref="S3.SS1.SSS5.p4.6.m2.1.1.2.3">1</cn></apply><ci id="S3.SS1.SSS5.p4.6.m2.1.1.3.cmml" xref="S3.SS1.SSS5.p4.6.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p4.6.m2.1c">{\bf h}^{1}_{t}</annotation></semantics></math>.
The former <math id="S3.SS1.SSS5.p4.7.m3.1" class="ltx_Math" alttext="\{{\bf z}_{i}\}" display="inline"><semantics id="S3.SS1.SSS5.p4.7.m3.1a"><mrow id="S3.SS1.SSS5.p4.7.m3.1.1.1" xref="S3.SS1.SSS5.p4.7.m3.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.SSS5.p4.7.m3.1.1.1.2" xref="S3.SS1.SSS5.p4.7.m3.1.1.2.cmml">{</mo><msub id="S3.SS1.SSS5.p4.7.m3.1.1.1.1" xref="S3.SS1.SSS5.p4.7.m3.1.1.1.1.cmml"><mi id="S3.SS1.SSS5.p4.7.m3.1.1.1.1.2" xref="S3.SS1.SSS5.p4.7.m3.1.1.1.1.2.cmml">𝐳</mi><mi id="S3.SS1.SSS5.p4.7.m3.1.1.1.1.3" xref="S3.SS1.SSS5.p4.7.m3.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.SSS5.p4.7.m3.1.1.1.3" xref="S3.SS1.SSS5.p4.7.m3.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p4.7.m3.1b"><set id="S3.SS1.SSS5.p4.7.m3.1.1.2.cmml" xref="S3.SS1.SSS5.p4.7.m3.1.1.1"><apply id="S3.SS1.SSS5.p4.7.m3.1.1.1.1.cmml" xref="S3.SS1.SSS5.p4.7.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p4.7.m3.1.1.1.1.1.cmml" xref="S3.SS1.SSS5.p4.7.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS5.p4.7.m3.1.1.1.1.2.cmml" xref="S3.SS1.SSS5.p4.7.m3.1.1.1.1.2">𝐳</ci><ci id="S3.SS1.SSS5.p4.7.m3.1.1.1.1.3.cmml" xref="S3.SS1.SSS5.p4.7.m3.1.1.1.1.3">𝑖</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p4.7.m3.1c">\{{\bf z}_{i}\}</annotation></semantics></math> fused the answer cue into each regional image representation vector with the MFB operation,
while the latter dynamically reflects the current partial question context.
<br class="ltx_break"></p>
</div>
<div id="S3.SS1.SSS5.p5" class="ltx_para ltx_noindent">
<p id="S3.SS1.SSS5.p5.2" class="ltx_p"><span id="S3.SS1.SSS5.p5.2.1" class="ltx_text ltx_font_bold">Question Decoder.</span>
In the top GRU decoding layer, which is referred to as language GRU,
we concatenate the dynamically attended image visual feature vector <math id="S3.SS1.SSS5.p5.1.m1.1" class="ltx_Math" alttext="{\bf\hat{c}}_{t}" display="inline"><semantics id="S3.SS1.SSS5.p5.1.m1.1a"><msub id="S3.SS1.SSS5.p5.1.m1.1.1" xref="S3.SS1.SSS5.p5.1.m1.1.1.cmml"><mover accent="true" id="S3.SS1.SSS5.p5.1.m1.1.1.2" xref="S3.SS1.SSS5.p5.1.m1.1.1.2.cmml"><mi id="S3.SS1.SSS5.p5.1.m1.1.1.2.2" xref="S3.SS1.SSS5.p5.1.m1.1.1.2.2.cmml">𝐜</mi><mo id="S3.SS1.SSS5.p5.1.m1.1.1.2.1" xref="S3.SS1.SSS5.p5.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS1.SSS5.p5.1.m1.1.1.3" xref="S3.SS1.SSS5.p5.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p5.1.m1.1b"><apply id="S3.SS1.SSS5.p5.1.m1.1.1.cmml" xref="S3.SS1.SSS5.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p5.1.m1.1.1.1.cmml" xref="S3.SS1.SSS5.p5.1.m1.1.1">subscript</csymbol><apply id="S3.SS1.SSS5.p5.1.m1.1.1.2.cmml" xref="S3.SS1.SSS5.p5.1.m1.1.1.2"><ci id="S3.SS1.SSS5.p5.1.m1.1.1.2.1.cmml" xref="S3.SS1.SSS5.p5.1.m1.1.1.2.1">^</ci><ci id="S3.SS1.SSS5.p5.1.m1.1.1.2.2.cmml" xref="S3.SS1.SSS5.p5.1.m1.1.1.2.2">𝐜</ci></apply><ci id="S3.SS1.SSS5.p5.1.m1.1.1.3.cmml" xref="S3.SS1.SSS5.p5.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p5.1.m1.1c">{\bf\hat{c}}_{t}</annotation></semantics></math>
with the output state of the GRU encoder <math id="S3.SS1.SSS5.p5.2.m2.1" class="ltx_Math" alttext="{\bf h}^{1}_{t}" display="inline"><semantics id="S3.SS1.SSS5.p5.2.m2.1a"><msubsup id="S3.SS1.SSS5.p5.2.m2.1.1" xref="S3.SS1.SSS5.p5.2.m2.1.1.cmml"><mi id="S3.SS1.SSS5.p5.2.m2.1.1.2.2" xref="S3.SS1.SSS5.p5.2.m2.1.1.2.2.cmml">𝐡</mi><mi id="S3.SS1.SSS5.p5.2.m2.1.1.3" xref="S3.SS1.SSS5.p5.2.m2.1.1.3.cmml">t</mi><mn id="S3.SS1.SSS5.p5.2.m2.1.1.2.3" xref="S3.SS1.SSS5.p5.2.m2.1.1.2.3.cmml">1</mn></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p5.2.m2.1b"><apply id="S3.SS1.SSS5.p5.2.m2.1.1.cmml" xref="S3.SS1.SSS5.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p5.2.m2.1.1.1.cmml" xref="S3.SS1.SSS5.p5.2.m2.1.1">subscript</csymbol><apply id="S3.SS1.SSS5.p5.2.m2.1.1.2.cmml" xref="S3.SS1.SSS5.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p5.2.m2.1.1.2.1.cmml" xref="S3.SS1.SSS5.p5.2.m2.1.1">superscript</csymbol><ci id="S3.SS1.SSS5.p5.2.m2.1.1.2.2.cmml" xref="S3.SS1.SSS5.p5.2.m2.1.1.2.2">𝐡</ci><cn type="integer" id="S3.SS1.SSS5.p5.2.m2.1.1.2.3.cmml" xref="S3.SS1.SSS5.p5.2.m2.1.1.2.3">1</cn></apply><ci id="S3.SS1.SSS5.p5.2.m2.1.1.3.cmml" xref="S3.SS1.SSS5.p5.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p5.2.m2.1c">{\bf h}^{1}_{t}</annotation></semantics></math>
to update the state of the recurrent GRU decoder:</p>
<table id="S3.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E13.m1.2" class="ltx_Math" alttext="\mbox{h}^{2}_{t}=\mbox{GRU}_{2}([{\bf\hat{c}}_{t},{\bf h}_{t}^{1}],{\bf h}^{2}_{t-1})" display="block"><semantics id="S3.E13.m1.2a"><mrow id="S3.E13.m1.2.2" xref="S3.E13.m1.2.2.cmml"><msubsup id="S3.E13.m1.2.2.4" xref="S3.E13.m1.2.2.4.cmml"><mtext id="S3.E13.m1.2.2.4.2.2" xref="S3.E13.m1.2.2.4.2.2a.cmml">h</mtext><mi id="S3.E13.m1.2.2.4.3" xref="S3.E13.m1.2.2.4.3.cmml">t</mi><mn id="S3.E13.m1.2.2.4.2.3" xref="S3.E13.m1.2.2.4.2.3.cmml">2</mn></msubsup><mo id="S3.E13.m1.2.2.3" xref="S3.E13.m1.2.2.3.cmml">=</mo><mrow id="S3.E13.m1.2.2.2" xref="S3.E13.m1.2.2.2.cmml"><msub id="S3.E13.m1.2.2.2.4" xref="S3.E13.m1.2.2.2.4.cmml"><mtext id="S3.E13.m1.2.2.2.4.2" xref="S3.E13.m1.2.2.2.4.2a.cmml">GRU</mtext><mn id="S3.E13.m1.2.2.2.4.3" xref="S3.E13.m1.2.2.2.4.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S3.E13.m1.2.2.2.3" xref="S3.E13.m1.2.2.2.3.cmml">​</mo><mrow id="S3.E13.m1.2.2.2.2.2" xref="S3.E13.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E13.m1.2.2.2.2.2.3" xref="S3.E13.m1.2.2.2.2.3.cmml">(</mo><mrow id="S3.E13.m1.1.1.1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.E13.m1.1.1.1.1.1.1.2.3" xref="S3.E13.m1.1.1.1.1.1.1.3.cmml">[</mo><msub id="S3.E13.m1.1.1.1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E13.m1.1.1.1.1.1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E13.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝐜</mi><mo id="S3.E13.m1.1.1.1.1.1.1.1.1.2.1" xref="S3.E13.m1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E13.m1.1.1.1.1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E13.m1.1.1.1.1.1.1.2.4" xref="S3.E13.m1.1.1.1.1.1.1.3.cmml">,</mo><msubsup id="S3.E13.m1.1.1.1.1.1.1.2.2" xref="S3.E13.m1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E13.m1.1.1.1.1.1.1.2.2.2.2" xref="S3.E13.m1.1.1.1.1.1.1.2.2.2.2.cmml">𝐡</mi><mi id="S3.E13.m1.1.1.1.1.1.1.2.2.2.3" xref="S3.E13.m1.1.1.1.1.1.1.2.2.2.3.cmml">t</mi><mn id="S3.E13.m1.1.1.1.1.1.1.2.2.3" xref="S3.E13.m1.1.1.1.1.1.1.2.2.3.cmml">1</mn></msubsup><mo stretchy="false" id="S3.E13.m1.1.1.1.1.1.1.2.5" xref="S3.E13.m1.1.1.1.1.1.1.3.cmml">]</mo></mrow><mo id="S3.E13.m1.2.2.2.2.2.4" xref="S3.E13.m1.2.2.2.2.3.cmml">,</mo><msubsup id="S3.E13.m1.2.2.2.2.2.2" xref="S3.E13.m1.2.2.2.2.2.2.cmml"><mi id="S3.E13.m1.2.2.2.2.2.2.2.2" xref="S3.E13.m1.2.2.2.2.2.2.2.2.cmml">𝐡</mi><mrow id="S3.E13.m1.2.2.2.2.2.2.3" xref="S3.E13.m1.2.2.2.2.2.2.3.cmml"><mi id="S3.E13.m1.2.2.2.2.2.2.3.2" xref="S3.E13.m1.2.2.2.2.2.2.3.2.cmml">t</mi><mo id="S3.E13.m1.2.2.2.2.2.2.3.1" xref="S3.E13.m1.2.2.2.2.2.2.3.1.cmml">−</mo><mn id="S3.E13.m1.2.2.2.2.2.2.3.3" xref="S3.E13.m1.2.2.2.2.2.2.3.3.cmml">1</mn></mrow><mn id="S3.E13.m1.2.2.2.2.2.2.2.3" xref="S3.E13.m1.2.2.2.2.2.2.2.3.cmml">2</mn></msubsup><mo stretchy="false" id="S3.E13.m1.2.2.2.2.2.5" xref="S3.E13.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.2b"><apply id="S3.E13.m1.2.2.cmml" xref="S3.E13.m1.2.2"><eq id="S3.E13.m1.2.2.3.cmml" xref="S3.E13.m1.2.2.3"></eq><apply id="S3.E13.m1.2.2.4.cmml" xref="S3.E13.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.4.1.cmml" xref="S3.E13.m1.2.2.4">subscript</csymbol><apply id="S3.E13.m1.2.2.4.2.cmml" xref="S3.E13.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.4.2.1.cmml" xref="S3.E13.m1.2.2.4">superscript</csymbol><ci id="S3.E13.m1.2.2.4.2.2a.cmml" xref="S3.E13.m1.2.2.4.2.2"><mtext id="S3.E13.m1.2.2.4.2.2.cmml" xref="S3.E13.m1.2.2.4.2.2">h</mtext></ci><cn type="integer" id="S3.E13.m1.2.2.4.2.3.cmml" xref="S3.E13.m1.2.2.4.2.3">2</cn></apply><ci id="S3.E13.m1.2.2.4.3.cmml" xref="S3.E13.m1.2.2.4.3">𝑡</ci></apply><apply id="S3.E13.m1.2.2.2.cmml" xref="S3.E13.m1.2.2.2"><times id="S3.E13.m1.2.2.2.3.cmml" xref="S3.E13.m1.2.2.2.3"></times><apply id="S3.E13.m1.2.2.2.4.cmml" xref="S3.E13.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.2.4.1.cmml" xref="S3.E13.m1.2.2.2.4">subscript</csymbol><ci id="S3.E13.m1.2.2.2.4.2a.cmml" xref="S3.E13.m1.2.2.2.4.2"><mtext id="S3.E13.m1.2.2.2.4.2.cmml" xref="S3.E13.m1.2.2.2.4.2">GRU</mtext></ci><cn type="integer" id="S3.E13.m1.2.2.2.4.3.cmml" xref="S3.E13.m1.2.2.2.4.3">2</cn></apply><interval closure="open" id="S3.E13.m1.2.2.2.2.3.cmml" xref="S3.E13.m1.2.2.2.2.2"><interval closure="closed" id="S3.E13.m1.1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.1.1.1.1.1.1.2"><apply id="S3.E13.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E13.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.2"><ci id="S3.E13.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.2.2">𝐜</ci></apply><ci id="S3.E13.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E13.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E13.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S3.E13.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E13.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E13.m1.1.1.1.1.1.1.2.2.2.2">𝐡</ci><ci id="S3.E13.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E13.m1.1.1.1.1.1.1.2.2.2.3">𝑡</ci></apply><cn type="integer" id="S3.E13.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E13.m1.1.1.1.1.1.1.2.2.3">1</cn></apply></interval><apply id="S3.E13.m1.2.2.2.2.2.2.cmml" xref="S3.E13.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.2.2.2.2.1.cmml" xref="S3.E13.m1.2.2.2.2.2.2">subscript</csymbol><apply id="S3.E13.m1.2.2.2.2.2.2.2.cmml" xref="S3.E13.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.E13.m1.2.2.2.2.2.2">superscript</csymbol><ci id="S3.E13.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E13.m1.2.2.2.2.2.2.2.2">𝐡</ci><cn type="integer" id="S3.E13.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.E13.m1.2.2.2.2.2.2.2.3">2</cn></apply><apply id="S3.E13.m1.2.2.2.2.2.2.3.cmml" xref="S3.E13.m1.2.2.2.2.2.2.3"><minus id="S3.E13.m1.2.2.2.2.2.2.3.1.cmml" xref="S3.E13.m1.2.2.2.2.2.2.3.1"></minus><ci id="S3.E13.m1.2.2.2.2.2.2.3.2.cmml" xref="S3.E13.m1.2.2.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="S3.E13.m1.2.2.2.2.2.2.3.3.cmml" xref="S3.E13.m1.2.2.2.2.2.2.3.3">1</cn></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.2c">\mbox{h}^{2}_{t}=\mbox{GRU}_{2}([{\bf\hat{c}}_{t},{\bf h}_{t}^{1}],{\bf h}^{2}_{t-1})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS5.p5.5" class="ltx_p">where <math id="S3.SS1.SSS5.p5.3.m1.1" class="ltx_Math" alttext="{\bf h}^{2}_{t-1}" display="inline"><semantics id="S3.SS1.SSS5.p5.3.m1.1a"><msubsup id="S3.SS1.SSS5.p5.3.m1.1.1" xref="S3.SS1.SSS5.p5.3.m1.1.1.cmml"><mi id="S3.SS1.SSS5.p5.3.m1.1.1.2.2" xref="S3.SS1.SSS5.p5.3.m1.1.1.2.2.cmml">𝐡</mi><mrow id="S3.SS1.SSS5.p5.3.m1.1.1.3" xref="S3.SS1.SSS5.p5.3.m1.1.1.3.cmml"><mi id="S3.SS1.SSS5.p5.3.m1.1.1.3.2" xref="S3.SS1.SSS5.p5.3.m1.1.1.3.2.cmml">t</mi><mo id="S3.SS1.SSS5.p5.3.m1.1.1.3.1" xref="S3.SS1.SSS5.p5.3.m1.1.1.3.1.cmml">−</mo><mn id="S3.SS1.SSS5.p5.3.m1.1.1.3.3" xref="S3.SS1.SSS5.p5.3.m1.1.1.3.3.cmml">1</mn></mrow><mn id="S3.SS1.SSS5.p5.3.m1.1.1.2.3" xref="S3.SS1.SSS5.p5.3.m1.1.1.2.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p5.3.m1.1b"><apply id="S3.SS1.SSS5.p5.3.m1.1.1.cmml" xref="S3.SS1.SSS5.p5.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p5.3.m1.1.1.1.cmml" xref="S3.SS1.SSS5.p5.3.m1.1.1">subscript</csymbol><apply id="S3.SS1.SSS5.p5.3.m1.1.1.2.cmml" xref="S3.SS1.SSS5.p5.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p5.3.m1.1.1.2.1.cmml" xref="S3.SS1.SSS5.p5.3.m1.1.1">superscript</csymbol><ci id="S3.SS1.SSS5.p5.3.m1.1.1.2.2.cmml" xref="S3.SS1.SSS5.p5.3.m1.1.1.2.2">𝐡</ci><cn type="integer" id="S3.SS1.SSS5.p5.3.m1.1.1.2.3.cmml" xref="S3.SS1.SSS5.p5.3.m1.1.1.2.3">2</cn></apply><apply id="S3.SS1.SSS5.p5.3.m1.1.1.3.cmml" xref="S3.SS1.SSS5.p5.3.m1.1.1.3"><minus id="S3.SS1.SSS5.p5.3.m1.1.1.3.1.cmml" xref="S3.SS1.SSS5.p5.3.m1.1.1.3.1"></minus><ci id="S3.SS1.SSS5.p5.3.m1.1.1.3.2.cmml" xref="S3.SS1.SSS5.p5.3.m1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS1.SSS5.p5.3.m1.1.1.3.3.cmml" xref="S3.SS1.SSS5.p5.3.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p5.3.m1.1c">{\bf h}^{2}_{t-1}</annotation></semantics></math> is the previous hidden state at step <math id="S3.SS1.SSS5.p5.4.m2.1" class="ltx_Math" alttext="t-1" display="inline"><semantics id="S3.SS1.SSS5.p5.4.m2.1a"><mrow id="S3.SS1.SSS5.p5.4.m2.1.1" xref="S3.SS1.SSS5.p5.4.m2.1.1.cmml"><mi id="S3.SS1.SSS5.p5.4.m2.1.1.2" xref="S3.SS1.SSS5.p5.4.m2.1.1.2.cmml">t</mi><mo id="S3.SS1.SSS5.p5.4.m2.1.1.1" xref="S3.SS1.SSS5.p5.4.m2.1.1.1.cmml">−</mo><mn id="S3.SS1.SSS5.p5.4.m2.1.1.3" xref="S3.SS1.SSS5.p5.4.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p5.4.m2.1b"><apply id="S3.SS1.SSS5.p5.4.m2.1.1.cmml" xref="S3.SS1.SSS5.p5.4.m2.1.1"><minus id="S3.SS1.SSS5.p5.4.m2.1.1.1.cmml" xref="S3.SS1.SSS5.p5.4.m2.1.1.1"></minus><ci id="S3.SS1.SSS5.p5.4.m2.1.1.2.cmml" xref="S3.SS1.SSS5.p5.4.m2.1.1.2">𝑡</ci><cn type="integer" id="S3.SS1.SSS5.p5.4.m2.1.1.3.cmml" xref="S3.SS1.SSS5.p5.4.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p5.4.m2.1c">t-1</annotation></semantics></math> and it is set to zero when <math id="S3.SS1.SSS5.p5.5.m3.1" class="ltx_Math" alttext="t=0" display="inline"><semantics id="S3.SS1.SSS5.p5.5.m3.1a"><mrow id="S3.SS1.SSS5.p5.5.m3.1.1" xref="S3.SS1.SSS5.p5.5.m3.1.1.cmml"><mi id="S3.SS1.SSS5.p5.5.m3.1.1.2" xref="S3.SS1.SSS5.p5.5.m3.1.1.2.cmml">t</mi><mo id="S3.SS1.SSS5.p5.5.m3.1.1.1" xref="S3.SS1.SSS5.p5.5.m3.1.1.1.cmml">=</mo><mn id="S3.SS1.SSS5.p5.5.m3.1.1.3" xref="S3.SS1.SSS5.p5.5.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p5.5.m3.1b"><apply id="S3.SS1.SSS5.p5.5.m3.1.1.cmml" xref="S3.SS1.SSS5.p5.5.m3.1.1"><eq id="S3.SS1.SSS5.p5.5.m3.1.1.1.cmml" xref="S3.SS1.SSS5.p5.5.m3.1.1.1"></eq><ci id="S3.SS1.SSS5.p5.5.m3.1.1.2.cmml" xref="S3.SS1.SSS5.p5.5.m3.1.1.2">𝑡</ci><cn type="integer" id="S3.SS1.SSS5.p5.5.m3.1.1.3.cmml" xref="S3.SS1.SSS5.p5.5.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p5.5.m3.1c">t=0</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.SSS5.p6" class="ltx_para">
<p id="S3.SS1.SSS5.p6.4" class="ltx_p">To predict the next word probability distribution over the set of vocabulary words,
we further pass the state vector of the GRU decoder through a fully connected layer and a softmax layer:</p>
<table id="S3.E14" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E14.m1.1" class="ltx_Math" alttext="{\bf p}^{*}=\mbox{softmax}(W_{dec}{\bf h}^{2}_{t}+{\bf b}_{dec})" display="block"><semantics id="S3.E14.m1.1a"><mrow id="S3.E14.m1.1.1" xref="S3.E14.m1.1.1.cmml"><msup id="S3.E14.m1.1.1.3" xref="S3.E14.m1.1.1.3.cmml"><mi id="S3.E14.m1.1.1.3.2" xref="S3.E14.m1.1.1.3.2.cmml">𝐩</mi><mo id="S3.E14.m1.1.1.3.3" xref="S3.E14.m1.1.1.3.3.cmml">∗</mo></msup><mo id="S3.E14.m1.1.1.2" xref="S3.E14.m1.1.1.2.cmml">=</mo><mrow id="S3.E14.m1.1.1.1" xref="S3.E14.m1.1.1.1.cmml"><mtext id="S3.E14.m1.1.1.1.3" xref="S3.E14.m1.1.1.1.3a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E14.m1.1.1.1.2" xref="S3.E14.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E14.m1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E14.m1.1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E14.m1.1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E14.m1.1.1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.1.1.2.cmml"><msub id="S3.E14.m1.1.1.1.1.1.1.2.2" xref="S3.E14.m1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.2.2.2" xref="S3.E14.m1.1.1.1.1.1.1.2.2.2.cmml">W</mi><mrow id="S3.E14.m1.1.1.1.1.1.1.2.2.3" xref="S3.E14.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.2.2.3.2" xref="S3.E14.m1.1.1.1.1.1.1.2.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.1.1.1.1.1.1.2.2.3.1" xref="S3.E14.m1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E14.m1.1.1.1.1.1.1.2.2.3.3" xref="S3.E14.m1.1.1.1.1.1.1.2.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.1.1.1.1.1.1.2.2.3.1a" xref="S3.E14.m1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E14.m1.1.1.1.1.1.1.2.2.3.4" xref="S3.E14.m1.1.1.1.1.1.1.2.2.3.4.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E14.m1.1.1.1.1.1.1.2.1" xref="S3.E14.m1.1.1.1.1.1.1.2.1.cmml">​</mo><msubsup id="S3.E14.m1.1.1.1.1.1.1.2.3" xref="S3.E14.m1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.2.3.2.2" xref="S3.E14.m1.1.1.1.1.1.1.2.3.2.2.cmml">𝐡</mi><mi id="S3.E14.m1.1.1.1.1.1.1.2.3.3" xref="S3.E14.m1.1.1.1.1.1.1.2.3.3.cmml">t</mi><mn id="S3.E14.m1.1.1.1.1.1.1.2.3.2.3" xref="S3.E14.m1.1.1.1.1.1.1.2.3.2.3.cmml">2</mn></msubsup></mrow><mo id="S3.E14.m1.1.1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E14.m1.1.1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.3.2" xref="S3.E14.m1.1.1.1.1.1.1.3.2.cmml">𝐛</mi><mrow id="S3.E14.m1.1.1.1.1.1.1.3.3" xref="S3.E14.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.3.3.2" xref="S3.E14.m1.1.1.1.1.1.1.3.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.1.1.1.1.1.1.3.3.1" xref="S3.E14.m1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E14.m1.1.1.1.1.1.1.3.3.3" xref="S3.E14.m1.1.1.1.1.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.1.1.1.1.1.1.3.3.1a" xref="S3.E14.m1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E14.m1.1.1.1.1.1.1.3.3.4" xref="S3.E14.m1.1.1.1.1.1.1.3.3.4.cmml">c</mi></mrow></msub></mrow><mo stretchy="false" id="S3.E14.m1.1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m1.1b"><apply id="S3.E14.m1.1.1.cmml" xref="S3.E14.m1.1.1"><eq id="S3.E14.m1.1.1.2.cmml" xref="S3.E14.m1.1.1.2"></eq><apply id="S3.E14.m1.1.1.3.cmml" xref="S3.E14.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.3.1.cmml" xref="S3.E14.m1.1.1.3">superscript</csymbol><ci id="S3.E14.m1.1.1.3.2.cmml" xref="S3.E14.m1.1.1.3.2">𝐩</ci><times id="S3.E14.m1.1.1.3.3.cmml" xref="S3.E14.m1.1.1.3.3"></times></apply><apply id="S3.E14.m1.1.1.1.cmml" xref="S3.E14.m1.1.1.1"><times id="S3.E14.m1.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.2"></times><ci id="S3.E14.m1.1.1.1.3a.cmml" xref="S3.E14.m1.1.1.1.3"><mtext id="S3.E14.m1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.3">softmax</mtext></ci><apply id="S3.E14.m1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1"><plus id="S3.E14.m1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1"></plus><apply id="S3.E14.m1.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2"><times id="S3.E14.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2.1"></times><apply id="S3.E14.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2.2.2">𝑊</ci><apply id="S3.E14.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2.2.3"><times id="S3.E14.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S3.E14.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2.2.3.2">𝑑</ci><ci id="S3.E14.m1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2.2.3.3">𝑒</ci><ci id="S3.E14.m1.1.1.1.1.1.1.2.2.3.4.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2.2.3.4">𝑐</ci></apply></apply><apply id="S3.E14.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2.3">subscript</csymbol><apply id="S3.E14.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="S3.E14.m1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2.3.2.2">𝐡</ci><cn type="integer" id="S3.E14.m1.1.1.1.1.1.1.2.3.2.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2.3.2.3">2</cn></apply><ci id="S3.E14.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S3.E14.m1.1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.2">𝐛</ci><apply id="S3.E14.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.3"><times id="S3.E14.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.3.1"></times><ci id="S3.E14.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.3.2">𝑑</ci><ci id="S3.E14.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.3.3">𝑒</ci><ci id="S3.E14.m1.1.1.1.1.1.1.3.3.4.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.3.4">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.1c">{\bf p}^{*}=\mbox{softmax}(W_{dec}{\bf h}^{2}_{t}+{\bf b}_{dec})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS5.p6.3" class="ltx_p">where <math id="S3.SS1.SSS5.p6.1.m1.1" class="ltx_Math" alttext="W_{dec}\in\mathbb{R}^{N_{w}\times N_{h}}" display="inline"><semantics id="S3.SS1.SSS5.p6.1.m1.1a"><mrow id="S3.SS1.SSS5.p6.1.m1.1.1" xref="S3.SS1.SSS5.p6.1.m1.1.1.cmml"><msub id="S3.SS1.SSS5.p6.1.m1.1.1.2" xref="S3.SS1.SSS5.p6.1.m1.1.1.2.cmml"><mi id="S3.SS1.SSS5.p6.1.m1.1.1.2.2" xref="S3.SS1.SSS5.p6.1.m1.1.1.2.2.cmml">W</mi><mrow id="S3.SS1.SSS5.p6.1.m1.1.1.2.3" xref="S3.SS1.SSS5.p6.1.m1.1.1.2.3.cmml"><mi id="S3.SS1.SSS5.p6.1.m1.1.1.2.3.2" xref="S3.SS1.SSS5.p6.1.m1.1.1.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS5.p6.1.m1.1.1.2.3.1" xref="S3.SS1.SSS5.p6.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.SSS5.p6.1.m1.1.1.2.3.3" xref="S3.SS1.SSS5.p6.1.m1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS5.p6.1.m1.1.1.2.3.1a" xref="S3.SS1.SSS5.p6.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.SSS5.p6.1.m1.1.1.2.3.4" xref="S3.SS1.SSS5.p6.1.m1.1.1.2.3.4.cmml">c</mi></mrow></msub><mo id="S3.SS1.SSS5.p6.1.m1.1.1.1" xref="S3.SS1.SSS5.p6.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS5.p6.1.m1.1.1.3" xref="S3.SS1.SSS5.p6.1.m1.1.1.3.cmml"><mi id="S3.SS1.SSS5.p6.1.m1.1.1.3.2" xref="S3.SS1.SSS5.p6.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS5.p6.1.m1.1.1.3.3" xref="S3.SS1.SSS5.p6.1.m1.1.1.3.3.cmml"><msub id="S3.SS1.SSS5.p6.1.m1.1.1.3.3.2" xref="S3.SS1.SSS5.p6.1.m1.1.1.3.3.2.cmml"><mi id="S3.SS1.SSS5.p6.1.m1.1.1.3.3.2.2" xref="S3.SS1.SSS5.p6.1.m1.1.1.3.3.2.2.cmml">N</mi><mi id="S3.SS1.SSS5.p6.1.m1.1.1.3.3.2.3" xref="S3.SS1.SSS5.p6.1.m1.1.1.3.3.2.3.cmml">w</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS5.p6.1.m1.1.1.3.3.1" xref="S3.SS1.SSS5.p6.1.m1.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.SSS5.p6.1.m1.1.1.3.3.3" xref="S3.SS1.SSS5.p6.1.m1.1.1.3.3.3.cmml"><mi id="S3.SS1.SSS5.p6.1.m1.1.1.3.3.3.2" xref="S3.SS1.SSS5.p6.1.m1.1.1.3.3.3.2.cmml">N</mi><mi id="S3.SS1.SSS5.p6.1.m1.1.1.3.3.3.3" xref="S3.SS1.SSS5.p6.1.m1.1.1.3.3.3.3.cmml">h</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p6.1.m1.1b"><apply id="S3.SS1.SSS5.p6.1.m1.1.1.cmml" xref="S3.SS1.SSS5.p6.1.m1.1.1"><in id="S3.SS1.SSS5.p6.1.m1.1.1.1.cmml" xref="S3.SS1.SSS5.p6.1.m1.1.1.1"></in><apply id="S3.SS1.SSS5.p6.1.m1.1.1.2.cmml" xref="S3.SS1.SSS5.p6.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p6.1.m1.1.1.2.1.cmml" xref="S3.SS1.SSS5.p6.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS5.p6.1.m1.1.1.2.2.cmml" xref="S3.SS1.SSS5.p6.1.m1.1.1.2.2">𝑊</ci><apply id="S3.SS1.SSS5.p6.1.m1.1.1.2.3.cmml" xref="S3.SS1.SSS5.p6.1.m1.1.1.2.3"><times id="S3.SS1.SSS5.p6.1.m1.1.1.2.3.1.cmml" xref="S3.SS1.SSS5.p6.1.m1.1.1.2.3.1"></times><ci id="S3.SS1.SSS5.p6.1.m1.1.1.2.3.2.cmml" xref="S3.SS1.SSS5.p6.1.m1.1.1.2.3.2">𝑑</ci><ci id="S3.SS1.SSS5.p6.1.m1.1.1.2.3.3.cmml" xref="S3.SS1.SSS5.p6.1.m1.1.1.2.3.3">𝑒</ci><ci id="S3.SS1.SSS5.p6.1.m1.1.1.2.3.4.cmml" xref="S3.SS1.SSS5.p6.1.m1.1.1.2.3.4">𝑐</ci></apply></apply><apply id="S3.SS1.SSS5.p6.1.m1.1.1.3.cmml" xref="S3.SS1.SSS5.p6.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p6.1.m1.1.1.3.1.cmml" xref="S3.SS1.SSS5.p6.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS5.p6.1.m1.1.1.3.2.cmml" xref="S3.SS1.SSS5.p6.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS5.p6.1.m1.1.1.3.3.cmml" xref="S3.SS1.SSS5.p6.1.m1.1.1.3.3"><times id="S3.SS1.SSS5.p6.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.SSS5.p6.1.m1.1.1.3.3.1"></times><apply id="S3.SS1.SSS5.p6.1.m1.1.1.3.3.2.cmml" xref="S3.SS1.SSS5.p6.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p6.1.m1.1.1.3.3.2.1.cmml" xref="S3.SS1.SSS5.p6.1.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.SS1.SSS5.p6.1.m1.1.1.3.3.2.2.cmml" xref="S3.SS1.SSS5.p6.1.m1.1.1.3.3.2.2">𝑁</ci><ci id="S3.SS1.SSS5.p6.1.m1.1.1.3.3.2.3.cmml" xref="S3.SS1.SSS5.p6.1.m1.1.1.3.3.2.3">𝑤</ci></apply><apply id="S3.SS1.SSS5.p6.1.m1.1.1.3.3.3.cmml" xref="S3.SS1.SSS5.p6.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p6.1.m1.1.1.3.3.3.1.cmml" xref="S3.SS1.SSS5.p6.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.SSS5.p6.1.m1.1.1.3.3.3.2.cmml" xref="S3.SS1.SSS5.p6.1.m1.1.1.3.3.3.2">𝑁</ci><ci id="S3.SS1.SSS5.p6.1.m1.1.1.3.3.3.3.cmml" xref="S3.SS1.SSS5.p6.1.m1.1.1.3.3.3.3">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p6.1.m1.1c">W_{dec}\in\mathbb{R}^{N_{w}\times N_{h}}</annotation></semantics></math> and <math id="S3.SS1.SSS5.p6.2.m2.1" class="ltx_Math" alttext="{\bf b}_{dec}\in\mathbb{R}^{N_{w}}" display="inline"><semantics id="S3.SS1.SSS5.p6.2.m2.1a"><mrow id="S3.SS1.SSS5.p6.2.m2.1.1" xref="S3.SS1.SSS5.p6.2.m2.1.1.cmml"><msub id="S3.SS1.SSS5.p6.2.m2.1.1.2" xref="S3.SS1.SSS5.p6.2.m2.1.1.2.cmml"><mi id="S3.SS1.SSS5.p6.2.m2.1.1.2.2" xref="S3.SS1.SSS5.p6.2.m2.1.1.2.2.cmml">𝐛</mi><mrow id="S3.SS1.SSS5.p6.2.m2.1.1.2.3" xref="S3.SS1.SSS5.p6.2.m2.1.1.2.3.cmml"><mi id="S3.SS1.SSS5.p6.2.m2.1.1.2.3.2" xref="S3.SS1.SSS5.p6.2.m2.1.1.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS5.p6.2.m2.1.1.2.3.1" xref="S3.SS1.SSS5.p6.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.SSS5.p6.2.m2.1.1.2.3.3" xref="S3.SS1.SSS5.p6.2.m2.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS5.p6.2.m2.1.1.2.3.1a" xref="S3.SS1.SSS5.p6.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.SSS5.p6.2.m2.1.1.2.3.4" xref="S3.SS1.SSS5.p6.2.m2.1.1.2.3.4.cmml">c</mi></mrow></msub><mo id="S3.SS1.SSS5.p6.2.m2.1.1.1" xref="S3.SS1.SSS5.p6.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS5.p6.2.m2.1.1.3" xref="S3.SS1.SSS5.p6.2.m2.1.1.3.cmml"><mi id="S3.SS1.SSS5.p6.2.m2.1.1.3.2" xref="S3.SS1.SSS5.p6.2.m2.1.1.3.2.cmml">ℝ</mi><msub id="S3.SS1.SSS5.p6.2.m2.1.1.3.3" xref="S3.SS1.SSS5.p6.2.m2.1.1.3.3.cmml"><mi id="S3.SS1.SSS5.p6.2.m2.1.1.3.3.2" xref="S3.SS1.SSS5.p6.2.m2.1.1.3.3.2.cmml">N</mi><mi id="S3.SS1.SSS5.p6.2.m2.1.1.3.3.3" xref="S3.SS1.SSS5.p6.2.m2.1.1.3.3.3.cmml">w</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p6.2.m2.1b"><apply id="S3.SS1.SSS5.p6.2.m2.1.1.cmml" xref="S3.SS1.SSS5.p6.2.m2.1.1"><in id="S3.SS1.SSS5.p6.2.m2.1.1.1.cmml" xref="S3.SS1.SSS5.p6.2.m2.1.1.1"></in><apply id="S3.SS1.SSS5.p6.2.m2.1.1.2.cmml" xref="S3.SS1.SSS5.p6.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p6.2.m2.1.1.2.1.cmml" xref="S3.SS1.SSS5.p6.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS5.p6.2.m2.1.1.2.2.cmml" xref="S3.SS1.SSS5.p6.2.m2.1.1.2.2">𝐛</ci><apply id="S3.SS1.SSS5.p6.2.m2.1.1.2.3.cmml" xref="S3.SS1.SSS5.p6.2.m2.1.1.2.3"><times id="S3.SS1.SSS5.p6.2.m2.1.1.2.3.1.cmml" xref="S3.SS1.SSS5.p6.2.m2.1.1.2.3.1"></times><ci id="S3.SS1.SSS5.p6.2.m2.1.1.2.3.2.cmml" xref="S3.SS1.SSS5.p6.2.m2.1.1.2.3.2">𝑑</ci><ci id="S3.SS1.SSS5.p6.2.m2.1.1.2.3.3.cmml" xref="S3.SS1.SSS5.p6.2.m2.1.1.2.3.3">𝑒</ci><ci id="S3.SS1.SSS5.p6.2.m2.1.1.2.3.4.cmml" xref="S3.SS1.SSS5.p6.2.m2.1.1.2.3.4">𝑐</ci></apply></apply><apply id="S3.SS1.SSS5.p6.2.m2.1.1.3.cmml" xref="S3.SS1.SSS5.p6.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p6.2.m2.1.1.3.1.cmml" xref="S3.SS1.SSS5.p6.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS5.p6.2.m2.1.1.3.2.cmml" xref="S3.SS1.SSS5.p6.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS5.p6.2.m2.1.1.3.3.cmml" xref="S3.SS1.SSS5.p6.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p6.2.m2.1.1.3.3.1.cmml" xref="S3.SS1.SSS5.p6.2.m2.1.1.3.3">subscript</csymbol><ci id="S3.SS1.SSS5.p6.2.m2.1.1.3.3.2.cmml" xref="S3.SS1.SSS5.p6.2.m2.1.1.3.3.2">𝑁</ci><ci id="S3.SS1.SSS5.p6.2.m2.1.1.3.3.3.cmml" xref="S3.SS1.SSS5.p6.2.m2.1.1.3.3.3">𝑤</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p6.2.m2.1c">{\bf b}_{dec}\in\mathbb{R}^{N_{w}}</annotation></semantics></math> are the model parameters.
With beam size =1, the next <math id="S3.SS1.SSS5.p6.3.m3.1" class="ltx_Math" alttext="(t+1)" display="inline"><semantics id="S3.SS1.SSS5.p6.3.m3.1a"><mrow id="S3.SS1.SSS5.p6.3.m3.1.1.1" xref="S3.SS1.SSS5.p6.3.m3.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.SSS5.p6.3.m3.1.1.1.2" xref="S3.SS1.SSS5.p6.3.m3.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.SSS5.p6.3.m3.1.1.1.1" xref="S3.SS1.SSS5.p6.3.m3.1.1.1.1.cmml"><mi id="S3.SS1.SSS5.p6.3.m3.1.1.1.1.2" xref="S3.SS1.SSS5.p6.3.m3.1.1.1.1.2.cmml">t</mi><mo id="S3.SS1.SSS5.p6.3.m3.1.1.1.1.1" xref="S3.SS1.SSS5.p6.3.m3.1.1.1.1.1.cmml">+</mo><mn id="S3.SS1.SSS5.p6.3.m3.1.1.1.1.3" xref="S3.SS1.SSS5.p6.3.m3.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS1.SSS5.p6.3.m3.1.1.1.3" xref="S3.SS1.SSS5.p6.3.m3.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p6.3.m3.1b"><apply id="S3.SS1.SSS5.p6.3.m3.1.1.1.1.cmml" xref="S3.SS1.SSS5.p6.3.m3.1.1.1"><plus id="S3.SS1.SSS5.p6.3.m3.1.1.1.1.1.cmml" xref="S3.SS1.SSS5.p6.3.m3.1.1.1.1.1"></plus><ci id="S3.SS1.SSS5.p6.3.m3.1.1.1.1.2.cmml" xref="S3.SS1.SSS5.p6.3.m3.1.1.1.1.2">𝑡</ci><cn type="integer" id="S3.SS1.SSS5.p6.3.m3.1.1.1.1.3.cmml" xref="S3.SS1.SSS5.p6.3.m3.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p6.3.m3.1c">(t+1)</annotation></semantics></math>-th word can then be generated as:</p>
<table id="S3.E15" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E15.m1.2" class="ltx_Math" alttext="q_{t+1}=\mbox{VOC}(j^{*}),\qquad j^{*}={\arg\max}_{j}\;{\bf p}_{j}^{*}" display="block"><semantics id="S3.E15.m1.2a"><mrow id="S3.E15.m1.2.2.2" xref="S3.E15.m1.2.2.3.cmml"><mrow id="S3.E15.m1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.cmml"><msub id="S3.E15.m1.1.1.1.1.3" xref="S3.E15.m1.1.1.1.1.3.cmml"><mi id="S3.E15.m1.1.1.1.1.3.2" xref="S3.E15.m1.1.1.1.1.3.2.cmml">q</mi><mrow id="S3.E15.m1.1.1.1.1.3.3" xref="S3.E15.m1.1.1.1.1.3.3.cmml"><mi id="S3.E15.m1.1.1.1.1.3.3.2" xref="S3.E15.m1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S3.E15.m1.1.1.1.1.3.3.1" xref="S3.E15.m1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S3.E15.m1.1.1.1.1.3.3.3" xref="S3.E15.m1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S3.E15.m1.1.1.1.1.2" xref="S3.E15.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E15.m1.1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.1.cmml"><mtext id="S3.E15.m1.1.1.1.1.1.3" xref="S3.E15.m1.1.1.1.1.1.3a.cmml">VOC</mtext><mo lspace="0em" rspace="0em" id="S3.E15.m1.1.1.1.1.1.2" xref="S3.E15.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E15.m1.1.1.1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E15.m1.1.1.1.1.1.1.1.2" xref="S3.E15.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E15.m1.1.1.1.1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E15.m1.1.1.1.1.1.1.1.1.2" xref="S3.E15.m1.1.1.1.1.1.1.1.1.2.cmml">j</mi><mo id="S3.E15.m1.1.1.1.1.1.1.1.1.3" xref="S3.E15.m1.1.1.1.1.1.1.1.1.3.cmml">∗</mo></msup><mo stretchy="false" id="S3.E15.m1.1.1.1.1.1.1.1.3" xref="S3.E15.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="2.167em" id="S3.E15.m1.2.2.2.3" xref="S3.E15.m1.2.2.3a.cmml">,</mo><mrow id="S3.E15.m1.2.2.2.2" xref="S3.E15.m1.2.2.2.2.cmml"><msup id="S3.E15.m1.2.2.2.2.2" xref="S3.E15.m1.2.2.2.2.2.cmml"><mi id="S3.E15.m1.2.2.2.2.2.2" xref="S3.E15.m1.2.2.2.2.2.2.cmml">j</mi><mo id="S3.E15.m1.2.2.2.2.2.3" xref="S3.E15.m1.2.2.2.2.2.3.cmml">∗</mo></msup><mo id="S3.E15.m1.2.2.2.2.1" xref="S3.E15.m1.2.2.2.2.1.cmml">=</mo><mrow id="S3.E15.m1.2.2.2.2.3" xref="S3.E15.m1.2.2.2.2.3.cmml"><mi id="S3.E15.m1.2.2.2.2.3.1" xref="S3.E15.m1.2.2.2.2.3.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E15.m1.2.2.2.2.3a" xref="S3.E15.m1.2.2.2.2.3.cmml">⁡</mo><mrow id="S3.E15.m1.2.2.2.2.3.2" xref="S3.E15.m1.2.2.2.2.3.2.cmml"><munder id="S3.E15.m1.2.2.2.2.3.2.1" xref="S3.E15.m1.2.2.2.2.3.2.1.cmml"><mi id="S3.E15.m1.2.2.2.2.3.2.1.2" xref="S3.E15.m1.2.2.2.2.3.2.1.2.cmml">max</mi><mi id="S3.E15.m1.2.2.2.2.3.2.1.3" xref="S3.E15.m1.2.2.2.2.3.2.1.3.cmml">j</mi></munder><mo lspace="0.167em" id="S3.E15.m1.2.2.2.2.3.2a" xref="S3.E15.m1.2.2.2.2.3.2.cmml">⁡</mo><msubsup id="S3.E15.m1.2.2.2.2.3.2.2" xref="S3.E15.m1.2.2.2.2.3.2.2.cmml"><mi id="S3.E15.m1.2.2.2.2.3.2.2.2.2" xref="S3.E15.m1.2.2.2.2.3.2.2.2.2.cmml">𝐩</mi><mi id="S3.E15.m1.2.2.2.2.3.2.2.2.3" xref="S3.E15.m1.2.2.2.2.3.2.2.2.3.cmml">j</mi><mo id="S3.E15.m1.2.2.2.2.3.2.2.3" xref="S3.E15.m1.2.2.2.2.3.2.2.3.cmml">∗</mo></msubsup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E15.m1.2b"><apply id="S3.E15.m1.2.2.3.cmml" xref="S3.E15.m1.2.2.2"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.3a.cmml" xref="S3.E15.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E15.m1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1.1"><eq id="S3.E15.m1.1.1.1.1.2.cmml" xref="S3.E15.m1.1.1.1.1.2"></eq><apply id="S3.E15.m1.1.1.1.1.3.cmml" xref="S3.E15.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E15.m1.1.1.1.1.3.1.cmml" xref="S3.E15.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E15.m1.1.1.1.1.3.2.cmml" xref="S3.E15.m1.1.1.1.1.3.2">𝑞</ci><apply id="S3.E15.m1.1.1.1.1.3.3.cmml" xref="S3.E15.m1.1.1.1.1.3.3"><plus id="S3.E15.m1.1.1.1.1.3.3.1.cmml" xref="S3.E15.m1.1.1.1.1.3.3.1"></plus><ci id="S3.E15.m1.1.1.1.1.3.3.2.cmml" xref="S3.E15.m1.1.1.1.1.3.3.2">𝑡</ci><cn type="integer" id="S3.E15.m1.1.1.1.1.3.3.3.cmml" xref="S3.E15.m1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="S3.E15.m1.1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1.1.1"><times id="S3.E15.m1.1.1.1.1.1.2.cmml" xref="S3.E15.m1.1.1.1.1.1.2"></times><ci id="S3.E15.m1.1.1.1.1.1.3a.cmml" xref="S3.E15.m1.1.1.1.1.1.3"><mtext id="S3.E15.m1.1.1.1.1.1.3.cmml" xref="S3.E15.m1.1.1.1.1.1.3">VOC</mtext></ci><apply id="S3.E15.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E15.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E15.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.2">𝑗</ci><times id="S3.E15.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.3"></times></apply></apply></apply><apply id="S3.E15.m1.2.2.2.2.cmml" xref="S3.E15.m1.2.2.2.2"><eq id="S3.E15.m1.2.2.2.2.1.cmml" xref="S3.E15.m1.2.2.2.2.1"></eq><apply id="S3.E15.m1.2.2.2.2.2.cmml" xref="S3.E15.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.2.2.2.1.cmml" xref="S3.E15.m1.2.2.2.2.2">superscript</csymbol><ci id="S3.E15.m1.2.2.2.2.2.2.cmml" xref="S3.E15.m1.2.2.2.2.2.2">𝑗</ci><times id="S3.E15.m1.2.2.2.2.2.3.cmml" xref="S3.E15.m1.2.2.2.2.2.3"></times></apply><apply id="S3.E15.m1.2.2.2.2.3.cmml" xref="S3.E15.m1.2.2.2.2.3"><arg id="S3.E15.m1.2.2.2.2.3.1.cmml" xref="S3.E15.m1.2.2.2.2.3.1"></arg><apply id="S3.E15.m1.2.2.2.2.3.2.cmml" xref="S3.E15.m1.2.2.2.2.3.2"><apply id="S3.E15.m1.2.2.2.2.3.2.1.cmml" xref="S3.E15.m1.2.2.2.2.3.2.1"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.2.2.3.2.1.1.cmml" xref="S3.E15.m1.2.2.2.2.3.2.1">subscript</csymbol><max id="S3.E15.m1.2.2.2.2.3.2.1.2.cmml" xref="S3.E15.m1.2.2.2.2.3.2.1.2"></max><ci id="S3.E15.m1.2.2.2.2.3.2.1.3.cmml" xref="S3.E15.m1.2.2.2.2.3.2.1.3">𝑗</ci></apply><apply id="S3.E15.m1.2.2.2.2.3.2.2.cmml" xref="S3.E15.m1.2.2.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.2.2.3.2.2.1.cmml" xref="S3.E15.m1.2.2.2.2.3.2.2">superscript</csymbol><apply id="S3.E15.m1.2.2.2.2.3.2.2.2.cmml" xref="S3.E15.m1.2.2.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.2.2.3.2.2.2.1.cmml" xref="S3.E15.m1.2.2.2.2.3.2.2">subscript</csymbol><ci id="S3.E15.m1.2.2.2.2.3.2.2.2.2.cmml" xref="S3.E15.m1.2.2.2.2.3.2.2.2.2">𝐩</ci><ci id="S3.E15.m1.2.2.2.2.3.2.2.2.3.cmml" xref="S3.E15.m1.2.2.2.2.3.2.2.2.3">𝑗</ci></apply><times id="S3.E15.m1.2.2.2.2.3.2.2.3.cmml" xref="S3.E15.m1.2.2.2.2.3.2.2.3"></times></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15.m1.2c">q_{t+1}=\mbox{VOC}(j^{*}),\qquad j^{*}={\arg\max}_{j}\;{\bf p}_{j}^{*}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS5.p6.5" class="ltx_p">where VOC denotes the vocabulary table.</p>
</div>
</section>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Training and Inference</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.4" class="ltx_p">We perform an end-to-end deep training over a set of training instances.
The <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">i</annotation></semantics></math>-th instance is a triplet that includes
an image <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="I^{i}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msup id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">I</mi><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝐼</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">I^{i}</annotation></semantics></math>,
an answer phrase <math id="S3.SS2.p1.3.m3.3" class="ltx_Math" alttext="A^{i}=[w^{i}_{1},\cdots,w^{i}_{m_{i}}]" display="inline"><semantics id="S3.SS2.p1.3.m3.3a"><mrow id="S3.SS2.p1.3.m3.3.3" xref="S3.SS2.p1.3.m3.3.3.cmml"><msup id="S3.SS2.p1.3.m3.3.3.4" xref="S3.SS2.p1.3.m3.3.3.4.cmml"><mi id="S3.SS2.p1.3.m3.3.3.4.2" xref="S3.SS2.p1.3.m3.3.3.4.2.cmml">A</mi><mi id="S3.SS2.p1.3.m3.3.3.4.3" xref="S3.SS2.p1.3.m3.3.3.4.3.cmml">i</mi></msup><mo id="S3.SS2.p1.3.m3.3.3.3" xref="S3.SS2.p1.3.m3.3.3.3.cmml">=</mo><mrow id="S3.SS2.p1.3.m3.3.3.2.2" xref="S3.SS2.p1.3.m3.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS2.p1.3.m3.3.3.2.2.3" xref="S3.SS2.p1.3.m3.3.3.2.3.cmml">[</mo><msubsup id="S3.SS2.p1.3.m3.2.2.1.1.1" xref="S3.SS2.p1.3.m3.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.3.m3.2.2.1.1.1.2.2" xref="S3.SS2.p1.3.m3.2.2.1.1.1.2.2.cmml">w</mi><mn id="S3.SS2.p1.3.m3.2.2.1.1.1.3" xref="S3.SS2.p1.3.m3.2.2.1.1.1.3.cmml">1</mn><mi id="S3.SS2.p1.3.m3.2.2.1.1.1.2.3" xref="S3.SS2.p1.3.m3.2.2.1.1.1.2.3.cmml">i</mi></msubsup><mo id="S3.SS2.p1.3.m3.3.3.2.2.4" xref="S3.SS2.p1.3.m3.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">⋯</mi><mo id="S3.SS2.p1.3.m3.3.3.2.2.5" xref="S3.SS2.p1.3.m3.3.3.2.3.cmml">,</mo><msubsup id="S3.SS2.p1.3.m3.3.3.2.2.2" xref="S3.SS2.p1.3.m3.3.3.2.2.2.cmml"><mi id="S3.SS2.p1.3.m3.3.3.2.2.2.2.2" xref="S3.SS2.p1.3.m3.3.3.2.2.2.2.2.cmml">w</mi><msub id="S3.SS2.p1.3.m3.3.3.2.2.2.3" xref="S3.SS2.p1.3.m3.3.3.2.2.2.3.cmml"><mi id="S3.SS2.p1.3.m3.3.3.2.2.2.3.2" xref="S3.SS2.p1.3.m3.3.3.2.2.2.3.2.cmml">m</mi><mi id="S3.SS2.p1.3.m3.3.3.2.2.2.3.3" xref="S3.SS2.p1.3.m3.3.3.2.2.2.3.3.cmml">i</mi></msub><mi id="S3.SS2.p1.3.m3.3.3.2.2.2.2.3" xref="S3.SS2.p1.3.m3.3.3.2.2.2.2.3.cmml">i</mi></msubsup><mo stretchy="false" id="S3.SS2.p1.3.m3.3.3.2.2.6" xref="S3.SS2.p1.3.m3.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.3b"><apply id="S3.SS2.p1.3.m3.3.3.cmml" xref="S3.SS2.p1.3.m3.3.3"><eq id="S3.SS2.p1.3.m3.3.3.3.cmml" xref="S3.SS2.p1.3.m3.3.3.3"></eq><apply id="S3.SS2.p1.3.m3.3.3.4.cmml" xref="S3.SS2.p1.3.m3.3.3.4"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.3.3.4.1.cmml" xref="S3.SS2.p1.3.m3.3.3.4">superscript</csymbol><ci id="S3.SS2.p1.3.m3.3.3.4.2.cmml" xref="S3.SS2.p1.3.m3.3.3.4.2">𝐴</ci><ci id="S3.SS2.p1.3.m3.3.3.4.3.cmml" xref="S3.SS2.p1.3.m3.3.3.4.3">𝑖</ci></apply><list id="S3.SS2.p1.3.m3.3.3.2.3.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2"><apply id="S3.SS2.p1.3.m3.2.2.1.1.1.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.1">subscript</csymbol><apply id="S3.SS2.p1.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.2.2.1.1.1.2.1.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.1">superscript</csymbol><ci id="S3.SS2.p1.3.m3.2.2.1.1.1.2.2.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.1.2.2">𝑤</ci><ci id="S3.SS2.p1.3.m3.2.2.1.1.1.2.3.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS2.p1.3.m3.2.2.1.1.1.3.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">⋯</ci><apply id="S3.SS2.p1.3.m3.3.3.2.2.2.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2.2">subscript</csymbol><apply id="S3.SS2.p1.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.3.3.2.2.2.2.1.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2.2">superscript</csymbol><ci id="S3.SS2.p1.3.m3.3.3.2.2.2.2.2.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2.2.2.2">𝑤</ci><ci id="S3.SS2.p1.3.m3.3.3.2.2.2.2.3.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2.2.2.3">𝑖</ci></apply><apply id="S3.SS2.p1.3.m3.3.3.2.2.2.3.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.3.3.2.2.2.3.1.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2.2.3">subscript</csymbol><ci id="S3.SS2.p1.3.m3.3.3.2.2.2.3.2.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2.2.3.2">𝑚</ci><ci id="S3.SS2.p1.3.m3.3.3.2.2.2.3.3.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2.2.3.3">𝑖</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.3c">A^{i}=[w^{i}_{1},\cdots,w^{i}_{m_{i}}]</annotation></semantics></math>,
and a ground truth question
<math id="S3.SS2.p1.4.m4.3" class="ltx_Math" alttext="Q^{i}=[q^{i}_{1},...,q^{i}_{T_{i}}]" display="inline"><semantics id="S3.SS2.p1.4.m4.3a"><mrow id="S3.SS2.p1.4.m4.3.3" xref="S3.SS2.p1.4.m4.3.3.cmml"><msup id="S3.SS2.p1.4.m4.3.3.4" xref="S3.SS2.p1.4.m4.3.3.4.cmml"><mi id="S3.SS2.p1.4.m4.3.3.4.2" xref="S3.SS2.p1.4.m4.3.3.4.2.cmml">Q</mi><mi id="S3.SS2.p1.4.m4.3.3.4.3" xref="S3.SS2.p1.4.m4.3.3.4.3.cmml">i</mi></msup><mo id="S3.SS2.p1.4.m4.3.3.3" xref="S3.SS2.p1.4.m4.3.3.3.cmml">=</mo><mrow id="S3.SS2.p1.4.m4.3.3.2.2" xref="S3.SS2.p1.4.m4.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS2.p1.4.m4.3.3.2.2.3" xref="S3.SS2.p1.4.m4.3.3.2.3.cmml">[</mo><msubsup id="S3.SS2.p1.4.m4.2.2.1.1.1" xref="S3.SS2.p1.4.m4.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.4.m4.2.2.1.1.1.2.2" xref="S3.SS2.p1.4.m4.2.2.1.1.1.2.2.cmml">q</mi><mn id="S3.SS2.p1.4.m4.2.2.1.1.1.3" xref="S3.SS2.p1.4.m4.2.2.1.1.1.3.cmml">1</mn><mi id="S3.SS2.p1.4.m4.2.2.1.1.1.2.3" xref="S3.SS2.p1.4.m4.2.2.1.1.1.2.3.cmml">i</mi></msubsup><mo id="S3.SS2.p1.4.m4.3.3.2.2.4" xref="S3.SS2.p1.4.m4.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">…</mi><mo id="S3.SS2.p1.4.m4.3.3.2.2.5" xref="S3.SS2.p1.4.m4.3.3.2.3.cmml">,</mo><msubsup id="S3.SS2.p1.4.m4.3.3.2.2.2" xref="S3.SS2.p1.4.m4.3.3.2.2.2.cmml"><mi id="S3.SS2.p1.4.m4.3.3.2.2.2.2.2" xref="S3.SS2.p1.4.m4.3.3.2.2.2.2.2.cmml">q</mi><msub id="S3.SS2.p1.4.m4.3.3.2.2.2.3" xref="S3.SS2.p1.4.m4.3.3.2.2.2.3.cmml"><mi id="S3.SS2.p1.4.m4.3.3.2.2.2.3.2" xref="S3.SS2.p1.4.m4.3.3.2.2.2.3.2.cmml">T</mi><mi id="S3.SS2.p1.4.m4.3.3.2.2.2.3.3" xref="S3.SS2.p1.4.m4.3.3.2.2.2.3.3.cmml">i</mi></msub><mi id="S3.SS2.p1.4.m4.3.3.2.2.2.2.3" xref="S3.SS2.p1.4.m4.3.3.2.2.2.2.3.cmml">i</mi></msubsup><mo stretchy="false" id="S3.SS2.p1.4.m4.3.3.2.2.6" xref="S3.SS2.p1.4.m4.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.3b"><apply id="S3.SS2.p1.4.m4.3.3.cmml" xref="S3.SS2.p1.4.m4.3.3"><eq id="S3.SS2.p1.4.m4.3.3.3.cmml" xref="S3.SS2.p1.4.m4.3.3.3"></eq><apply id="S3.SS2.p1.4.m4.3.3.4.cmml" xref="S3.SS2.p1.4.m4.3.3.4"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.3.3.4.1.cmml" xref="S3.SS2.p1.4.m4.3.3.4">superscript</csymbol><ci id="S3.SS2.p1.4.m4.3.3.4.2.cmml" xref="S3.SS2.p1.4.m4.3.3.4.2">𝑄</ci><ci id="S3.SS2.p1.4.m4.3.3.4.3.cmml" xref="S3.SS2.p1.4.m4.3.3.4.3">𝑖</ci></apply><list id="S3.SS2.p1.4.m4.3.3.2.3.cmml" xref="S3.SS2.p1.4.m4.3.3.2.2"><apply id="S3.SS2.p1.4.m4.2.2.1.1.1.cmml" xref="S3.SS2.p1.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.4.m4.2.2.1.1.1">subscript</csymbol><apply id="S3.SS2.p1.4.m4.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.2.2.1.1.1.2.1.cmml" xref="S3.SS2.p1.4.m4.2.2.1.1.1">superscript</csymbol><ci id="S3.SS2.p1.4.m4.2.2.1.1.1.2.2.cmml" xref="S3.SS2.p1.4.m4.2.2.1.1.1.2.2">𝑞</ci><ci id="S3.SS2.p1.4.m4.2.2.1.1.1.2.3.cmml" xref="S3.SS2.p1.4.m4.2.2.1.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS2.p1.4.m4.2.2.1.1.1.3.cmml" xref="S3.SS2.p1.4.m4.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">…</ci><apply id="S3.SS2.p1.4.m4.3.3.2.2.2.cmml" xref="S3.SS2.p1.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.4.m4.3.3.2.2.2">subscript</csymbol><apply id="S3.SS2.p1.4.m4.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.3.3.2.2.2.2.1.cmml" xref="S3.SS2.p1.4.m4.3.3.2.2.2">superscript</csymbol><ci id="S3.SS2.p1.4.m4.3.3.2.2.2.2.2.cmml" xref="S3.SS2.p1.4.m4.3.3.2.2.2.2.2">𝑞</ci><ci id="S3.SS2.p1.4.m4.3.3.2.2.2.2.3.cmml" xref="S3.SS2.p1.4.m4.3.3.2.2.2.2.3">𝑖</ci></apply><apply id="S3.SS2.p1.4.m4.3.3.2.2.2.3.cmml" xref="S3.SS2.p1.4.m4.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.3.3.2.2.2.3.1.cmml" xref="S3.SS2.p1.4.m4.3.3.2.2.2.3">subscript</csymbol><ci id="S3.SS2.p1.4.m4.3.3.2.2.2.3.2.cmml" xref="S3.SS2.p1.4.m4.3.3.2.2.2.3.2">𝑇</ci><ci id="S3.SS2.p1.4.m4.3.3.2.2.2.3.3.cmml" xref="S3.SS2.p1.4.m4.3.3.2.2.2.3.3">𝑖</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.3c">Q^{i}=[q^{i}_{1},...,q^{i}_{T_{i}}]</annotation></semantics></math>.
We train the proposed model
by minimizing the cross-entropy loss:</p>
<table id="S3.E16" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E16.m1.3" class="ltx_Math" alttext="L(\Theta)=-\sum_{i}\frac{1}{T_{i}}\sum_{t=1}^{t=T_{i}}\log P(q^{i}_{t}|q^{i}_{1},\cdots,q^{i}_{t-1};I^{i},A^{i})" display="block"><semantics id="S3.E16.m1.3a"><mrow id="S3.E16.m1.3.3" xref="S3.E16.m1.3.3.cmml"><mrow id="S3.E16.m1.3.3.3" xref="S3.E16.m1.3.3.3.cmml"><mi id="S3.E16.m1.3.3.3.2" xref="S3.E16.m1.3.3.3.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E16.m1.3.3.3.1" xref="S3.E16.m1.3.3.3.1.cmml">​</mo><mrow id="S3.E16.m1.3.3.3.3.2" xref="S3.E16.m1.3.3.3.cmml"><mo stretchy="false" id="S3.E16.m1.3.3.3.3.2.1" xref="S3.E16.m1.3.3.3.cmml">(</mo><mi mathvariant="normal" id="S3.E16.m1.1.1" xref="S3.E16.m1.1.1.cmml">Θ</mi><mo stretchy="false" id="S3.E16.m1.3.3.3.3.2.2" xref="S3.E16.m1.3.3.3.cmml">)</mo></mrow></mrow><mo id="S3.E16.m1.3.3.2" xref="S3.E16.m1.3.3.2.cmml">=</mo><mrow id="S3.E16.m1.3.3.1" xref="S3.E16.m1.3.3.1.cmml"><mo id="S3.E16.m1.3.3.1a" xref="S3.E16.m1.3.3.1.cmml">−</mo><mrow id="S3.E16.m1.3.3.1.1" xref="S3.E16.m1.3.3.1.1.cmml"><munder id="S3.E16.m1.3.3.1.1.2" xref="S3.E16.m1.3.3.1.1.2.cmml"><mo movablelimits="false" id="S3.E16.m1.3.3.1.1.2.2" xref="S3.E16.m1.3.3.1.1.2.2.cmml">∑</mo><mi id="S3.E16.m1.3.3.1.1.2.3" xref="S3.E16.m1.3.3.1.1.2.3.cmml">i</mi></munder><mrow id="S3.E16.m1.3.3.1.1.1" xref="S3.E16.m1.3.3.1.1.1.cmml"><mfrac id="S3.E16.m1.3.3.1.1.1.3" xref="S3.E16.m1.3.3.1.1.1.3.cmml"><mn id="S3.E16.m1.3.3.1.1.1.3.2" xref="S3.E16.m1.3.3.1.1.1.3.2.cmml">1</mn><msub id="S3.E16.m1.3.3.1.1.1.3.3" xref="S3.E16.m1.3.3.1.1.1.3.3.cmml"><mi id="S3.E16.m1.3.3.1.1.1.3.3.2" xref="S3.E16.m1.3.3.1.1.1.3.3.2.cmml">T</mi><mi id="S3.E16.m1.3.3.1.1.1.3.3.3" xref="S3.E16.m1.3.3.1.1.1.3.3.3.cmml">i</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S3.E16.m1.3.3.1.1.1.2" xref="S3.E16.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E16.m1.3.3.1.1.1.1" xref="S3.E16.m1.3.3.1.1.1.1.cmml"><munderover id="S3.E16.m1.3.3.1.1.1.1.2" xref="S3.E16.m1.3.3.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E16.m1.3.3.1.1.1.1.2.2.2" xref="S3.E16.m1.3.3.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E16.m1.3.3.1.1.1.1.2.2.3" xref="S3.E16.m1.3.3.1.1.1.1.2.2.3.cmml"><mi id="S3.E16.m1.3.3.1.1.1.1.2.2.3.2" xref="S3.E16.m1.3.3.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="S3.E16.m1.3.3.1.1.1.1.2.2.3.1" xref="S3.E16.m1.3.3.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E16.m1.3.3.1.1.1.1.2.2.3.3" xref="S3.E16.m1.3.3.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E16.m1.3.3.1.1.1.1.2.3" xref="S3.E16.m1.3.3.1.1.1.1.2.3.cmml"><mi id="S3.E16.m1.3.3.1.1.1.1.2.3.2" xref="S3.E16.m1.3.3.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.E16.m1.3.3.1.1.1.1.2.3.1" xref="S3.E16.m1.3.3.1.1.1.1.2.3.1.cmml">=</mo><msub id="S3.E16.m1.3.3.1.1.1.1.2.3.3" xref="S3.E16.m1.3.3.1.1.1.1.2.3.3.cmml"><mi id="S3.E16.m1.3.3.1.1.1.1.2.3.3.2" xref="S3.E16.m1.3.3.1.1.1.1.2.3.3.2.cmml">T</mi><mi id="S3.E16.m1.3.3.1.1.1.1.2.3.3.3" xref="S3.E16.m1.3.3.1.1.1.1.2.3.3.3.cmml">i</mi></msub></mrow></munderover><mrow id="S3.E16.m1.3.3.1.1.1.1.1" xref="S3.E16.m1.3.3.1.1.1.1.1.cmml"><mrow id="S3.E16.m1.3.3.1.1.1.1.1.3" xref="S3.E16.m1.3.3.1.1.1.1.1.3.cmml"><mi id="S3.E16.m1.3.3.1.1.1.1.1.3.1" xref="S3.E16.m1.3.3.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E16.m1.3.3.1.1.1.1.1.3a" xref="S3.E16.m1.3.3.1.1.1.1.1.3.cmml">⁡</mo><mi id="S3.E16.m1.3.3.1.1.1.1.1.3.2" xref="S3.E16.m1.3.3.1.1.1.1.1.3.2.cmml">P</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E16.m1.3.3.1.1.1.1.1.2" xref="S3.E16.m1.3.3.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E16.m1.3.3.1.1.1.1.1.1.1" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E16.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.6" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.6.cmml"><mi id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.6.2.2" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.6.2.2.cmml">q</mi><mi id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.6.3" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.6.3.cmml">t</mi><mi id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.6.2.3" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.6.2.3.cmml">i</mi></msubsup><mo fence="false" id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.5" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.5.cmml">|</mo><mrow id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.4.4" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.4.5.cmml"><msubsup id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">q</mi><mn id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn><mi id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.4.4.5" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.4.5.cmml">,</mo><mi mathvariant="normal" id="S3.E16.m1.2.2" xref="S3.E16.m1.2.2.cmml">⋯</mi><mo id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.4.4.6" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.4.5.cmml">,</mo><msubsup id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">q</mi><mrow id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3.2" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml">t</mi><mo id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3.1" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml">−</mo><mn id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3.3" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.4.4.7" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.4.5.cmml">;</mo><msup id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.2" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.2.cmml">I</mi><mi id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.3" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.3.cmml">i</mi></msup><mo id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.4.4.8" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.4.5.cmml">,</mo><msup id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.4.4.4" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.4.4.4.cmml"><mi id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.4.4.4.2" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.4.4.4.2.cmml">A</mi><mi id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.4.4.4.3" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.4.4.4.3.cmml">i</mi></msup></mrow></mrow><mo stretchy="false" id="S3.E16.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E16.m1.3b"><apply id="S3.E16.m1.3.3.cmml" xref="S3.E16.m1.3.3"><eq id="S3.E16.m1.3.3.2.cmml" xref="S3.E16.m1.3.3.2"></eq><apply id="S3.E16.m1.3.3.3.cmml" xref="S3.E16.m1.3.3.3"><times id="S3.E16.m1.3.3.3.1.cmml" xref="S3.E16.m1.3.3.3.1"></times><ci id="S3.E16.m1.3.3.3.2.cmml" xref="S3.E16.m1.3.3.3.2">𝐿</ci><ci id="S3.E16.m1.1.1.cmml" xref="S3.E16.m1.1.1">Θ</ci></apply><apply id="S3.E16.m1.3.3.1.cmml" xref="S3.E16.m1.3.3.1"><minus id="S3.E16.m1.3.3.1.2.cmml" xref="S3.E16.m1.3.3.1"></minus><apply id="S3.E16.m1.3.3.1.1.cmml" xref="S3.E16.m1.3.3.1.1"><apply id="S3.E16.m1.3.3.1.1.2.cmml" xref="S3.E16.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E16.m1.3.3.1.1.2.1.cmml" xref="S3.E16.m1.3.3.1.1.2">subscript</csymbol><sum id="S3.E16.m1.3.3.1.1.2.2.cmml" xref="S3.E16.m1.3.3.1.1.2.2"></sum><ci id="S3.E16.m1.3.3.1.1.2.3.cmml" xref="S3.E16.m1.3.3.1.1.2.3">𝑖</ci></apply><apply id="S3.E16.m1.3.3.1.1.1.cmml" xref="S3.E16.m1.3.3.1.1.1"><times id="S3.E16.m1.3.3.1.1.1.2.cmml" xref="S3.E16.m1.3.3.1.1.1.2"></times><apply id="S3.E16.m1.3.3.1.1.1.3.cmml" xref="S3.E16.m1.3.3.1.1.1.3"><divide id="S3.E16.m1.3.3.1.1.1.3.1.cmml" xref="S3.E16.m1.3.3.1.1.1.3"></divide><cn type="integer" id="S3.E16.m1.3.3.1.1.1.3.2.cmml" xref="S3.E16.m1.3.3.1.1.1.3.2">1</cn><apply id="S3.E16.m1.3.3.1.1.1.3.3.cmml" xref="S3.E16.m1.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E16.m1.3.3.1.1.1.3.3.1.cmml" xref="S3.E16.m1.3.3.1.1.1.3.3">subscript</csymbol><ci id="S3.E16.m1.3.3.1.1.1.3.3.2.cmml" xref="S3.E16.m1.3.3.1.1.1.3.3.2">𝑇</ci><ci id="S3.E16.m1.3.3.1.1.1.3.3.3.cmml" xref="S3.E16.m1.3.3.1.1.1.3.3.3">𝑖</ci></apply></apply><apply id="S3.E16.m1.3.3.1.1.1.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1"><apply id="S3.E16.m1.3.3.1.1.1.1.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E16.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.2">superscript</csymbol><apply id="S3.E16.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E16.m1.3.3.1.1.1.1.2.2.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.2">subscript</csymbol><sum id="S3.E16.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.2.2.2"></sum><apply id="S3.E16.m1.3.3.1.1.1.1.2.2.3.cmml" xref="S3.E16.m1.3.3.1.1.1.1.2.2.3"><eq id="S3.E16.m1.3.3.1.1.1.1.2.2.3.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.2.2.3.1"></eq><ci id="S3.E16.m1.3.3.1.1.1.1.2.2.3.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="S3.E16.m1.3.3.1.1.1.1.2.2.3.3.cmml" xref="S3.E16.m1.3.3.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E16.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E16.m1.3.3.1.1.1.1.2.3"><eq id="S3.E16.m1.3.3.1.1.1.1.2.3.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.2.3.1"></eq><ci id="S3.E16.m1.3.3.1.1.1.1.2.3.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.2.3.2">𝑡</ci><apply id="S3.E16.m1.3.3.1.1.1.1.2.3.3.cmml" xref="S3.E16.m1.3.3.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E16.m1.3.3.1.1.1.1.2.3.3.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.2.3.3">subscript</csymbol><ci id="S3.E16.m1.3.3.1.1.1.1.2.3.3.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.2.3.3.2">𝑇</ci><ci id="S3.E16.m1.3.3.1.1.1.1.2.3.3.3.cmml" xref="S3.E16.m1.3.3.1.1.1.1.2.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E16.m1.3.3.1.1.1.1.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1"><times id="S3.E16.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.2"></times><apply id="S3.E16.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.3"><log id="S3.E16.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.3.1"></log><ci id="S3.E16.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.3.2">𝑃</ci></apply><apply id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.5.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.5">conditional</csymbol><apply id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.6.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.6.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.6">subscript</csymbol><apply id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.6.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.6.2.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.6">superscript</csymbol><ci id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.6.2.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.6.2.2">𝑞</ci><ci id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.6.2.3.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.6.2.3">𝑖</ci></apply><ci id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.6.3.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.6.3">𝑡</ci></apply><list id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.4.5.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.4.4"><apply id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑞</ci><ci id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.E16.m1.2.2.cmml" xref="S3.E16.m1.2.2">⋯</ci><apply id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.2">𝑞</ci><ci id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.3">𝑖</ci></apply><apply id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3"><minus id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3.1"></minus><ci id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3.2">𝑡</ci><cn type="integer" id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3.3">1</cn></apply></apply><apply id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.3.3.3">superscript</csymbol><ci id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.2">𝐼</ci><ci id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.3">𝑖</ci></apply><apply id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.4.4.4.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.4.4.4.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.4.4.4">superscript</csymbol><ci id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.4.4.4.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.4.4.4.2">𝐴</ci><ci id="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.4.4.4.3.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.1.1.4.4.4.3">𝑖</ci></apply></list></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16.m1.3c">L(\Theta)=-\sum_{i}\frac{1}{T_{i}}\sum_{t=1}^{t=T_{i}}\log P(q^{i}_{t}|q^{i}_{1},\cdots,q^{i}_{t-1};I^{i},A^{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.6" class="ltx_p">where <math id="S3.SS2.p1.5.m1.1" class="ltx_Math" alttext="\Theta" display="inline"><semantics id="S3.SS2.p1.5.m1.1a"><mi mathvariant="normal" id="S3.SS2.p1.5.m1.1.1" xref="S3.SS2.p1.5.m1.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m1.1b"><ci id="S3.SS2.p1.5.m1.1.1.cmml" xref="S3.SS2.p1.5.m1.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m1.1c">\Theta</annotation></semantics></math> represents all the model parameters,
and <math id="S3.SS2.p1.6.m2.2" class="ltx_Math" alttext="P(q^{i}_{t}|q^{i}_{1},\cdots,q^{i}_{t-1};I^{i},A^{i})" display="inline"><semantics id="S3.SS2.p1.6.m2.2a"><mrow id="S3.SS2.p1.6.m2.2.2" xref="S3.SS2.p1.6.m2.2.2.cmml"><mi id="S3.SS2.p1.6.m2.2.2.3" xref="S3.SS2.p1.6.m2.2.2.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.6.m2.2.2.2" xref="S3.SS2.p1.6.m2.2.2.2.cmml">​</mo><mrow id="S3.SS2.p1.6.m2.2.2.1.1" xref="S3.SS2.p1.6.m2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.6.m2.2.2.1.1.2" xref="S3.SS2.p1.6.m2.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.6.m2.2.2.1.1.1" xref="S3.SS2.p1.6.m2.2.2.1.1.1.cmml"><msubsup id="S3.SS2.p1.6.m2.2.2.1.1.1.6" xref="S3.SS2.p1.6.m2.2.2.1.1.1.6.cmml"><mi id="S3.SS2.p1.6.m2.2.2.1.1.1.6.2.2" xref="S3.SS2.p1.6.m2.2.2.1.1.1.6.2.2.cmml">q</mi><mi id="S3.SS2.p1.6.m2.2.2.1.1.1.6.3" xref="S3.SS2.p1.6.m2.2.2.1.1.1.6.3.cmml">t</mi><mi id="S3.SS2.p1.6.m2.2.2.1.1.1.6.2.3" xref="S3.SS2.p1.6.m2.2.2.1.1.1.6.2.3.cmml">i</mi></msubsup><mo fence="false" id="S3.SS2.p1.6.m2.2.2.1.1.1.5" xref="S3.SS2.p1.6.m2.2.2.1.1.1.5.cmml">|</mo><mrow id="S3.SS2.p1.6.m2.2.2.1.1.1.4.4" xref="S3.SS2.p1.6.m2.2.2.1.1.1.4.5.cmml"><msubsup id="S3.SS2.p1.6.m2.2.2.1.1.1.1.1.1" xref="S3.SS2.p1.6.m2.2.2.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.6.m2.2.2.1.1.1.1.1.1.2.2" xref="S3.SS2.p1.6.m2.2.2.1.1.1.1.1.1.2.2.cmml">q</mi><mn id="S3.SS2.p1.6.m2.2.2.1.1.1.1.1.1.3" xref="S3.SS2.p1.6.m2.2.2.1.1.1.1.1.1.3.cmml">1</mn><mi id="S3.SS2.p1.6.m2.2.2.1.1.1.1.1.1.2.3" xref="S3.SS2.p1.6.m2.2.2.1.1.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="S3.SS2.p1.6.m2.2.2.1.1.1.4.4.5" xref="S3.SS2.p1.6.m2.2.2.1.1.1.4.5.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.6.m2.1.1" xref="S3.SS2.p1.6.m2.1.1.cmml">⋯</mi><mo id="S3.SS2.p1.6.m2.2.2.1.1.1.4.4.6" xref="S3.SS2.p1.6.m2.2.2.1.1.1.4.5.cmml">,</mo><msubsup id="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2" xref="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.cmml"><mi id="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.2.2" xref="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.2.2.cmml">q</mi><mrow id="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.3" xref="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.3.cmml"><mi id="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.3.2" xref="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.3.2.cmml">t</mi><mo id="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.3.1" xref="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.3.1.cmml">−</mo><mn id="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.3.3" xref="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.2.3" xref="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S3.SS2.p1.6.m2.2.2.1.1.1.4.4.7" xref="S3.SS2.p1.6.m2.2.2.1.1.1.4.5.cmml">;</mo><msup id="S3.SS2.p1.6.m2.2.2.1.1.1.3.3.3" xref="S3.SS2.p1.6.m2.2.2.1.1.1.3.3.3.cmml"><mi id="S3.SS2.p1.6.m2.2.2.1.1.1.3.3.3.2" xref="S3.SS2.p1.6.m2.2.2.1.1.1.3.3.3.2.cmml">I</mi><mi id="S3.SS2.p1.6.m2.2.2.1.1.1.3.3.3.3" xref="S3.SS2.p1.6.m2.2.2.1.1.1.3.3.3.3.cmml">i</mi></msup><mo id="S3.SS2.p1.6.m2.2.2.1.1.1.4.4.8" xref="S3.SS2.p1.6.m2.2.2.1.1.1.4.5.cmml">,</mo><msup id="S3.SS2.p1.6.m2.2.2.1.1.1.4.4.4" xref="S3.SS2.p1.6.m2.2.2.1.1.1.4.4.4.cmml"><mi id="S3.SS2.p1.6.m2.2.2.1.1.1.4.4.4.2" xref="S3.SS2.p1.6.m2.2.2.1.1.1.4.4.4.2.cmml">A</mi><mi id="S3.SS2.p1.6.m2.2.2.1.1.1.4.4.4.3" xref="S3.SS2.p1.6.m2.2.2.1.1.1.4.4.4.3.cmml">i</mi></msup></mrow></mrow><mo stretchy="false" id="S3.SS2.p1.6.m2.2.2.1.1.3" xref="S3.SS2.p1.6.m2.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m2.2b"><apply id="S3.SS2.p1.6.m2.2.2.cmml" xref="S3.SS2.p1.6.m2.2.2"><times id="S3.SS2.p1.6.m2.2.2.2.cmml" xref="S3.SS2.p1.6.m2.2.2.2"></times><ci id="S3.SS2.p1.6.m2.2.2.3.cmml" xref="S3.SS2.p1.6.m2.2.2.3">𝑃</ci><apply id="S3.SS2.p1.6.m2.2.2.1.1.1.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1"><csymbol cd="latexml" id="S3.SS2.p1.6.m2.2.2.1.1.1.5.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.5">conditional</csymbol><apply id="S3.SS2.p1.6.m2.2.2.1.1.1.6.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.6"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m2.2.2.1.1.1.6.1.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.6">subscript</csymbol><apply id="S3.SS2.p1.6.m2.2.2.1.1.1.6.2.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.6"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m2.2.2.1.1.1.6.2.1.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.6">superscript</csymbol><ci id="S3.SS2.p1.6.m2.2.2.1.1.1.6.2.2.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.6.2.2">𝑞</ci><ci id="S3.SS2.p1.6.m2.2.2.1.1.1.6.2.3.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.6.2.3">𝑖</ci></apply><ci id="S3.SS2.p1.6.m2.2.2.1.1.1.6.3.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.6.3">𝑡</ci></apply><list id="S3.SS2.p1.6.m2.2.2.1.1.1.4.5.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.4.4"><apply id="S3.SS2.p1.6.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS2.p1.6.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p1.6.m2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.1.1.1.2.2">𝑞</ci><ci id="S3.SS2.p1.6.m2.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.1.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS2.p1.6.m2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.SS2.p1.6.m2.1.1.cmml" xref="S3.SS2.p1.6.m2.1.1">⋯</ci><apply id="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.1.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2">subscript</csymbol><apply id="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.2.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.2.1.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2">superscript</csymbol><ci id="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.2.2.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.2.2">𝑞</ci><ci id="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.2.3.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.2.3">𝑖</ci></apply><apply id="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.3.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.3"><minus id="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.3.1.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.3.1"></minus><ci id="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.3.2.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.3.2">𝑡</ci><cn type="integer" id="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.3.3.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.2.2.2.3.3">1</cn></apply></apply><apply id="S3.SS2.p1.6.m2.2.2.1.1.1.3.3.3.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m2.2.2.1.1.1.3.3.3.1.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.3.3.3">superscript</csymbol><ci id="S3.SS2.p1.6.m2.2.2.1.1.1.3.3.3.2.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.3.3.3.2">𝐼</ci><ci id="S3.SS2.p1.6.m2.2.2.1.1.1.3.3.3.3.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.3.3.3.3">𝑖</ci></apply><apply id="S3.SS2.p1.6.m2.2.2.1.1.1.4.4.4.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.4.4.4"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m2.2.2.1.1.1.4.4.4.1.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.4.4.4">superscript</csymbol><ci id="S3.SS2.p1.6.m2.2.2.1.1.1.4.4.4.2.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.4.4.4.2">𝐴</ci><ci id="S3.SS2.p1.6.m2.2.2.1.1.1.4.4.4.3.cmml" xref="S3.SS2.p1.6.m2.2.2.1.1.1.4.4.4.3">𝑖</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m2.2c">P(q^{i}_{t}|q^{i}_{1},\cdots,q^{i}_{t-1};I^{i},A^{i})</annotation></semantics></math> is determined from Eq.(<a href="#S3.E14" title="In 3.1.5 Recurrent Question Generation ‣ 3.1 iVQA Model with Multi-Level Attentions ‣ 3 Approach ‣ Inverse Visual Question Answering with Multi-Level Attentions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a>).</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">During the test phase, given the trained model and an image-answer pair,
we recurrently predict
the probability distribution of the next word in the question sequence over our vocabulary
using Eq.(<a href="#S3.E14" title="In 3.1.5 Recurrent Question Generation ‣ 3.1 iVQA Model with Multi-Level Attentions ‣ 3 Approach ‣ Inverse Visual Question Answering with Multi-Level Attentions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a>).
We use a beam size 1 (greedy search) to select the most probable word as the output,
as in Eq.(<a href="#S3.E15" title="In 3.1.5 Recurrent Question Generation ‣ 3.1 iVQA Model with Multi-Level Attentions ‣ 3 Approach ‣ Inverse Visual Question Answering with Multi-Level Attentions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">15</span></a>).
The question generation terminates after generating the question mark.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S3.T1.2.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S3.T1.3.2" class="ltx_text" style="font-size:90%;">
Comparison results between our proposed iVQA model
and the other three comparison models on the popular Karpathy test split.
The numbers in bold denote the highest scores.
</span></figcaption>
<table id="S3.T1.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.4.1.1" class="ltx_tr">
<th id="S3.T1.4.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">Method</th>
<th id="S3.T1.4.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">BLEU-1</th>
<th id="S3.T1.4.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">BLEU-2</th>
<th id="S3.T1.4.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">BLEU-3</th>
<th id="S3.T1.4.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">BLEU-4</th>
<th id="S3.T1.4.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">METEOR</th>
<th id="S3.T1.4.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">ROUGE-L</th>
<th id="S3.T1.4.1.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">CIDEr</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.4.2.1" class="ltx_tr">
<th id="S3.T1.4.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">SAT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>
</th>
<td id="S3.T1.4.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0.417</td>
<td id="S3.T1.4.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0.311</td>
<td id="S3.T1.4.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0.241</td>
<td id="S3.T1.4.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0.192</td>
<td id="S3.T1.4.2.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0.195</td>
<td id="S3.T1.4.2.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0.456</td>
<td id="S3.T1.4.2.1.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">1.533</td>
</tr>
<tr id="S3.T1.4.3.2" class="ltx_tr">
<th id="S3.T1.4.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">iVQA+VAE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>
</th>
<td id="S3.T1.4.3.2.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">0.421</td>
<td id="S3.T1.4.3.2.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">0.320</td>
<td id="S3.T1.4.3.2.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">0.253</td>
<td id="S3.T1.4.3.2.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">0.205</td>
<td id="S3.T1.4.3.2.6" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">0.201</td>
<td id="S3.T1.4.3.2.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">0.466</td>
<td id="S3.T1.4.3.2.8" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">1.682</td>
</tr>
<tr id="S3.T1.4.4.3" class="ltx_tr">
<th id="S3.T1.4.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">iVQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>
</th>
<td id="S3.T1.4.4.3.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">0.430</td>
<td id="S3.T1.4.4.3.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">0.326</td>
<td id="S3.T1.4.4.3.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">0.256</td>
<td id="S3.T1.4.4.3.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S3.T1.4.4.3.5.1" class="ltx_text ltx_font_bold">0.208</span></td>
<td id="S3.T1.4.4.3.6" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">0.205</td>
<td id="S3.T1.4.4.3.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">0.468</td>
<td id="S3.T1.4.4.3.8" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S3.T1.4.4.3.8.1" class="ltx_text ltx_font_bold">1.714</span></td>
</tr>
<tr id="S3.T1.4.5.4" class="ltx_tr">
<th id="S3.T1.4.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">Ours</th>
<td id="S3.T1.4.5.4.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S3.T1.4.5.4.2.1" class="ltx_text ltx_font_bold">0.452</span></td>
<td id="S3.T1.4.5.4.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S3.T1.4.5.4.3.1" class="ltx_text ltx_font_bold">0.339</span></td>
<td id="S3.T1.4.5.4.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S3.T1.4.5.4.4.1" class="ltx_text ltx_font_bold">0.262</span></td>
<td id="S3.T1.4.5.4.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0.207</td>
<td id="S3.T1.4.5.4.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S3.T1.4.5.4.6.1" class="ltx_text ltx_font_bold">0.209</span></td>
<td id="S3.T1.4.5.4.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S3.T1.4.5.4.7.1" class="ltx_text ltx_font_bold">0.472</span></td>
<td id="S3.T1.4.5.4.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">1.673</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section we present our empirical study and report both quantitative and qualitative results.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental Setting</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.1" class="ltx_p"><span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_bold">Dataset.</span>
We used the VQA V1 dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> to conduct experiments and evaluate the proposed approach.
This dataset was initially created for visual question answering
and repurposed for iVQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> later.
The images are collected from the MS COCO dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>.
The dataset is divided into three parts: training set, validation set and testing set.
The training set consists of 82,783 images. The validation and testing sets include 40,504 and 81,434 images respectively.
The answers however are not available for the testing set.
Therefore, we followed <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> to use the Karpathy data split,
and get
5000 images for testing and 5000 images for validation.
Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, we use three question-answer pairs for each image.
This results in about 250k instances ((image, answer, question)-triplets) for training
and 15k instances for testing.
<br class="ltx_break"></p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.3" class="ltx_p"><span id="S4.SS1.p2.3.1" class="ltx_text ltx_font_bold">Implementation Details.</span>
Before conducting experiments,
we first performed pre-processing over the data.
We follow <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> to extract the most frequent 3,000 answers from the training set
and then build the vocabulary from the questions corresponding to these answers.
This leads to a vocabulary set of about 12,900 words.
The answers and questions are tokenized
into lists of words.
We standardized the lengths of questions and answers to be 19 and 3 respectively
by padding zeros to shorter sequences and trimming longer sequences.
To extract the visual and semantic information,
we use the publicly available bottom-up attention model, Faster R-CNN, in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>.
We use the model to extract the top <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="k=36" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mrow id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mi id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml">k</mi><mo id="S4.SS1.p2.1.m1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml">36</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><eq id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1"></eq><ci id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2">𝑘</ci><cn type="integer" id="S4.SS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3">36</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">k=36</annotation></semantics></math> salient regions of visual features <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">V</annotation></semantics></math> and their corresponding semantic information <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><mi id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><ci id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">S</annotation></semantics></math>.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.4" class="ltx_p">We performed training by using one GPU with 16 GB of memory.
We fed the data in batches of 1000 instances.
We use <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="N_{h}=1280" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><mrow id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><msub id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml"><mi id="S4.SS1.p3.1.m1.1.1.2.2" xref="S4.SS1.p3.1.m1.1.1.2.2.cmml">N</mi><mi id="S4.SS1.p3.1.m1.1.1.2.3" xref="S4.SS1.p3.1.m1.1.1.2.3.cmml">h</mi></msub><mo id="S4.SS1.p3.1.m1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml">1280</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><eq id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1"></eq><apply id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.2.1.cmml" xref="S4.SS1.p3.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS1.p3.1.m1.1.1.2.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2.2">𝑁</ci><ci id="S4.SS1.p3.1.m1.1.1.2.3.cmml" xref="S4.SS1.p3.1.m1.1.1.2.3">ℎ</ci></apply><cn type="integer" id="S4.SS1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3">1280</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">N_{h}=1280</annotation></semantics></math> hidden units for each GRU cell and <math id="S4.SS1.p3.2.m2.1" class="ltx_Math" alttext="N=512" display="inline"><semantics id="S4.SS1.p3.2.m2.1a"><mrow id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml"><mi id="S4.SS1.p3.2.m2.1.1.2" xref="S4.SS1.p3.2.m2.1.1.2.cmml">N</mi><mo id="S4.SS1.p3.2.m2.1.1.1" xref="S4.SS1.p3.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.p3.2.m2.1.1.3" xref="S4.SS1.p3.2.m2.1.1.3.cmml">512</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><apply id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1"><eq id="S4.SS1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1"></eq><ci id="S4.SS1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2">𝑁</ci><cn type="integer" id="S4.SS1.p3.2.m2.1.1.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3">512</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">N=512</annotation></semantics></math> for each attention module.
We trained our model by using the back-propagation algorithm with the Adam <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> optimizer.
During training, we initially set the learning rate as <math id="S4.SS1.p3.3.m3.1" class="ltx_Math" alttext="9.9e^{-4}" display="inline"><semantics id="S4.SS1.p3.3.m3.1a"><mrow id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml"><mn id="S4.SS1.p3.3.m3.1.1.2" xref="S4.SS1.p3.3.m3.1.1.2.cmml">9.9</mn><mo lspace="0em" rspace="0em" id="S4.SS1.p3.3.m3.1.1.1" xref="S4.SS1.p3.3.m3.1.1.1.cmml">​</mo><msup id="S4.SS1.p3.3.m3.1.1.3" xref="S4.SS1.p3.3.m3.1.1.3.cmml"><mi id="S4.SS1.p3.3.m3.1.1.3.2" xref="S4.SS1.p3.3.m3.1.1.3.2.cmml">e</mi><mrow id="S4.SS1.p3.3.m3.1.1.3.3" xref="S4.SS1.p3.3.m3.1.1.3.3.cmml"><mo id="S4.SS1.p3.3.m3.1.1.3.3a" xref="S4.SS1.p3.3.m3.1.1.3.3.cmml">−</mo><mn id="S4.SS1.p3.3.m3.1.1.3.3.2" xref="S4.SS1.p3.3.m3.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><apply id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1"><times id="S4.SS1.p3.3.m3.1.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1.1"></times><cn type="float" id="S4.SS1.p3.3.m3.1.1.2.cmml" xref="S4.SS1.p3.3.m3.1.1.2">9.9</cn><apply id="S4.SS1.p3.3.m3.1.1.3.cmml" xref="S4.SS1.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.1.1.3.1.cmml" xref="S4.SS1.p3.3.m3.1.1.3">superscript</csymbol><ci id="S4.SS1.p3.3.m3.1.1.3.2.cmml" xref="S4.SS1.p3.3.m3.1.1.3.2">𝑒</ci><apply id="S4.SS1.p3.3.m3.1.1.3.3.cmml" xref="S4.SS1.p3.3.m3.1.1.3.3"><minus id="S4.SS1.p3.3.m3.1.1.3.3.1.cmml" xref="S4.SS1.p3.3.m3.1.1.3.3"></minus><cn type="integer" id="S4.SS1.p3.3.m3.1.1.3.3.2.cmml" xref="S4.SS1.p3.3.m3.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">9.9e^{-4}</annotation></semantics></math>.
After the fifth epoch, we decreased it to <math id="S4.SS1.p3.4.m4.1" class="ltx_Math" alttext="9.9e^{-5}" display="inline"><semantics id="S4.SS1.p3.4.m4.1a"><mrow id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml"><mn id="S4.SS1.p3.4.m4.1.1.2" xref="S4.SS1.p3.4.m4.1.1.2.cmml">9.9</mn><mo lspace="0em" rspace="0em" id="S4.SS1.p3.4.m4.1.1.1" xref="S4.SS1.p3.4.m4.1.1.1.cmml">​</mo><msup id="S4.SS1.p3.4.m4.1.1.3" xref="S4.SS1.p3.4.m4.1.1.3.cmml"><mi id="S4.SS1.p3.4.m4.1.1.3.2" xref="S4.SS1.p3.4.m4.1.1.3.2.cmml">e</mi><mrow id="S4.SS1.p3.4.m4.1.1.3.3" xref="S4.SS1.p3.4.m4.1.1.3.3.cmml"><mo id="S4.SS1.p3.4.m4.1.1.3.3a" xref="S4.SS1.p3.4.m4.1.1.3.3.cmml">−</mo><mn id="S4.SS1.p3.4.m4.1.1.3.3.2" xref="S4.SS1.p3.4.m4.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><apply id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1"><times id="S4.SS1.p3.4.m4.1.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1.1"></times><cn type="float" id="S4.SS1.p3.4.m4.1.1.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2">9.9</cn><apply id="S4.SS1.p3.4.m4.1.1.3.cmml" xref="S4.SS1.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.1.1.3.1.cmml" xref="S4.SS1.p3.4.m4.1.1.3">superscript</csymbol><ci id="S4.SS1.p3.4.m4.1.1.3.2.cmml" xref="S4.SS1.p3.4.m4.1.1.3.2">𝑒</ci><apply id="S4.SS1.p3.4.m4.1.1.3.3.cmml" xref="S4.SS1.p3.4.m4.1.1.3.3"><minus id="S4.SS1.p3.4.m4.1.1.3.3.1.cmml" xref="S4.SS1.p3.4.m4.1.1.3.3"></minus><cn type="integer" id="S4.SS1.p3.4.m4.1.1.3.3.2.cmml" xref="S4.SS1.p3.4.m4.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">9.9e^{-5}</annotation></semantics></math>
and stopped training at the 14th epoch. 
<br class="ltx_break"></p>
</div>
<div id="S4.SS1.p4" class="ltx_para ltx_noindent">
<p id="S4.SS1.p4.1" class="ltx_p"><span id="S4.SS1.p4.1.1" class="ltx_text ltx_font_bold">Model Evaluation.</span>
We evaluate our model by using the standard evaluation metrics,
specifically, BLEU, METEOR, ROUGE-L and CIDEr<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a target="_blank" href="https://github.com/tylin/coco-caption" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/tylin/coco-caption</a></span></span></span>.
These metrics are used extensively for image captioning evaluation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>
and have also been used for iVQA evaluation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Quantitative Results</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">To validate the effectiveness of the proposed model,
we compare its performance with one baseline and two iVQA competitors <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>.
The baseline is the powerful Show Attend and Tell (SAT) model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>,
which was mainly developed for the task of image captioning and modified by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> to take a given answer cue.
The model is compared to ours in the context of using dynamic attention to focus on different salient regions at each time step.
The competitors are the original iVQA method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> and its modified version (iVQA+VAE) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>
which incorporates the variational autoencoder (VAE) to increase the question diversity.
We report the comparison results in Table <a href="#S4.T2" title="Table 2 ‣ 4.2 Quantitative Results ‣ 4 Experiments ‣ Inverse Visual Question Answering with Multi-Level Attentions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">From the comparison scores,
we can see that the proposed model with the multi-level attentions and semantically enhanced visual features
performs better than the baseline SAT by remarkable margins.
This suggests that the iVQA task presents different challenges than the caption generation task,
while a state-of-the-art image captioning model can fail to produce effective results on the iVQA task
even after adaptation.
Moreover, we can also see that the proposed model also
outperforms the state-of-the-art iVQA models, iVQA and iVQA+VAE,
in terms of most of the linguistic evaluation metrics,
including BLEU-1, BLEU-2, BLEU-3, METEROR, and ROUGE-L.
The results are also achieved under an inference setting that is favorable to the competitors
–
the two competitors used a beam search of size 3, while we only used a beam search of size 1.
These impressive results demonstrate the efficacy of the proposed multi-level attention model.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T2.2.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S4.T2.3.2" class="ltx_text" style="font-size:90%;">Performance comparison of our main model variants.</span></figcaption>
<table id="S4.T2.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.4.1.1" class="ltx_tr">
<th id="S4.T2.4.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">Method</th>
<th id="S4.T2.4.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">BLEU-1</th>
<th id="S4.T2.4.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">BLEU-2</th>
<th id="S4.T2.4.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">BLEU-3</th>
<th id="S4.T2.4.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">BLEU-4</th>
<th id="S4.T2.4.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">METEOR</th>
<th id="S4.T2.4.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">ROUGE-L</th>
<th id="S4.T2.4.1.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">CIDEr</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.4.2.1" class="ltx_tr">
<th id="S4.T2.4.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">Variant w/o {S, att_0}</th>
<td id="S4.T2.4.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">0.450</td>
<td id="S4.T2.4.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">0.336</td>
<td id="S4.T2.4.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">0.259</td>
<td id="S4.T2.4.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">0.204</td>
<td id="S4.T2.4.2.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">0.208</td>
<td id="S4.T2.4.2.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">0.467</td>
<td id="S4.T2.4.2.1.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">1.649</td>
</tr>
<tr id="S4.T2.4.3.2" class="ltx_tr">
<th id="S4.T2.4.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">Full Model</th>
<td id="S4.T2.4.3.2.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">0.452</td>
<td id="S4.T2.4.3.2.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">0.339</td>
<td id="S4.T2.4.3.2.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">0.262</td>
<td id="S4.T2.4.3.2.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">0.207</td>
<td id="S4.T2.4.3.2.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">0.209</td>
<td id="S4.T2.4.3.2.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">0.472</td>
<td id="S4.T2.4.3.2.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">1.673</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Ablation Study</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.6" class="ltx_p">The proposed model incorporates additional semantic information <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mi id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">S</annotation></semantics></math>
based on the object and attribute labels.
It uses <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><mi id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><ci id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">S</annotation></semantics></math> to produce enhanced visual features <math id="S4.SS3.p1.3.m3.1" class="ltx_Math" alttext="E_{v}" display="inline"><semantics id="S4.SS3.p1.3.m3.1a"><msub id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml"><mi id="S4.SS3.p1.3.m3.1.1.2" xref="S4.SS3.p1.3.m3.1.1.2.cmml">E</mi><mi id="S4.SS3.p1.3.m3.1.1.3" xref="S4.SS3.p1.3.m3.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><apply id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.p1.3.m3.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1.2">𝐸</ci><ci id="S4.SS3.p1.3.m3.1.1.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">E_{v}</annotation></semantics></math>
and obtain <math id="S4.SS3.p1.4.m4.1" class="ltx_Math" alttext="att0" display="inline"><semantics id="S4.SS3.p1.4.m4.1a"><mrow id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml"><mi id="S4.SS3.p1.4.m4.1.1.2" xref="S4.SS3.p1.4.m4.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.4.m4.1.1.1" xref="S4.SS3.p1.4.m4.1.1.1.cmml">​</mo><mi id="S4.SS3.p1.4.m4.1.1.3" xref="S4.SS3.p1.4.m4.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.4.m4.1.1.1a" xref="S4.SS3.p1.4.m4.1.1.1.cmml">​</mo><mi id="S4.SS3.p1.4.m4.1.1.4" xref="S4.SS3.p1.4.m4.1.1.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.4.m4.1.1.1b" xref="S4.SS3.p1.4.m4.1.1.1.cmml">​</mo><mn id="S4.SS3.p1.4.m4.1.1.5" xref="S4.SS3.p1.4.m4.1.1.5.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><apply id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1"><times id="S4.SS3.p1.4.m4.1.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1.1"></times><ci id="S4.SS3.p1.4.m4.1.1.2.cmml" xref="S4.SS3.p1.4.m4.1.1.2">𝑎</ci><ci id="S4.SS3.p1.4.m4.1.1.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3">𝑡</ci><ci id="S4.SS3.p1.4.m4.1.1.4.cmml" xref="S4.SS3.p1.4.m4.1.1.4">𝑡</ci><cn type="integer" id="S4.SS3.p1.4.m4.1.1.5.cmml" xref="S4.SS3.p1.4.m4.1.1.5">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">att0</annotation></semantics></math> through dual guiding attention.
To investigate whether and how much this semantic information contributes to the major performance gain
for the proposed model, we create a variant of the proposed model
by dropping the semantic information <math id="S4.SS3.p1.5.m5.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S4.SS3.p1.5.m5.1a"><mi id="S4.SS3.p1.5.m5.1.1" xref="S4.SS3.p1.5.m5.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.1b"><ci id="S4.SS3.p1.5.m5.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.1c">S</annotation></semantics></math> and dual guiding attention features <math id="S4.SS3.p1.6.m6.1" class="ltx_Math" alttext="att0" display="inline"><semantics id="S4.SS3.p1.6.m6.1a"><mrow id="S4.SS3.p1.6.m6.1.1" xref="S4.SS3.p1.6.m6.1.1.cmml"><mi id="S4.SS3.p1.6.m6.1.1.2" xref="S4.SS3.p1.6.m6.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.6.m6.1.1.1" xref="S4.SS3.p1.6.m6.1.1.1.cmml">​</mo><mi id="S4.SS3.p1.6.m6.1.1.3" xref="S4.SS3.p1.6.m6.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.6.m6.1.1.1a" xref="S4.SS3.p1.6.m6.1.1.1.cmml">​</mo><mi id="S4.SS3.p1.6.m6.1.1.4" xref="S4.SS3.p1.6.m6.1.1.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.6.m6.1.1.1b" xref="S4.SS3.p1.6.m6.1.1.1.cmml">​</mo><mn id="S4.SS3.p1.6.m6.1.1.5" xref="S4.SS3.p1.6.m6.1.1.5.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.6.m6.1b"><apply id="S4.SS3.p1.6.m6.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1"><times id="S4.SS3.p1.6.m6.1.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1.1"></times><ci id="S4.SS3.p1.6.m6.1.1.2.cmml" xref="S4.SS3.p1.6.m6.1.1.2">𝑎</ci><ci id="S4.SS3.p1.6.m6.1.1.3.cmml" xref="S4.SS3.p1.6.m6.1.1.3">𝑡</ci><ci id="S4.SS3.p1.6.m6.1.1.4.cmml" xref="S4.SS3.p1.6.m6.1.1.4">𝑡</ci><cn type="integer" id="S4.SS3.p1.6.m6.1.1.5.cmml" xref="S4.SS3.p1.6.m6.1.1.5">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.6.m6.1c">att0</annotation></semantics></math>.
We compared this variant with the full model and reported the results in
Table <a href="#S4.T2" title="Table 2 ‣ 4.2 Quantitative Results ‣ 4 Experiments ‣ Inverse Visual Question Answering with Multi-Level Attentions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
We can see that the performance of the variant model
is comparable to the state-of-the-art iVQA model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>.
It actually outperforms the iVQA model in terms of BLEU-1, BLEU-2, BLEU-3 and METEOR.
This validates
the visual features extracted at the object-level salient regions more suitable for the task of iVQA
than the visual features extracted with conventional deep networks.
Nevertheless, the full model still beats the variant in terms of all evaluation metrics.
This suggests that the use of semantic information and dual guiding attention is beneficial for iVQA.
Enhancing visual features with semantic information that has the same textual modality with the answer
and generated partial question is useful for our model to precisely attend to corresponding objects,
and consequently improve the overall performance.
</p>
</div>
<figure id="S4.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F3.sf1" class="ltx_figure ltx_figure_panel"><img src="/html/1909.07583/assets/figures/green.jpg" id="S4.F3.sf1.g1" class="ltx_graphics ltx_img_square" width="100" height="88" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S4.F3.sf1.3.2" class="ltx_text" style="font-size:90%;">(a) Answer: green</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F3.sf2" class="ltx_figure ltx_figure_panel"><img src="/html/1909.07583/assets/figures/green0.jpg" id="S4.F3.sf2.g1" class="ltx_graphics ltx_img_square" width="100" height="88" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S4.F3.sf2.3.2" class="ltx_text" style="font-size:90%;">What</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F3.sf3" class="ltx_figure ltx_figure_panel"><img src="/html/1909.07583/assets/figures/green1.jpg" id="S4.F3.sf3.g1" class="ltx_graphics ltx_img_square" width="100" height="88" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="S4.F3.sf3.3.2" class="ltx_text" style="font-size:90%;">color</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F3.sf4" class="ltx_figure ltx_figure_panel"><img src="/html/1909.07583/assets/figures/green2.jpg" id="S4.F3.sf4.g1" class="ltx_graphics ltx_img_square" width="100" height="88" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf4.2.1.1" class="ltx_text" style="font-size:90%;">(d)</span> </span><span id="S4.F3.sf4.3.2" class="ltx_text" style="font-size:90%;">is</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F3.sf5" class="ltx_figure ltx_figure_panel"><img src="/html/1909.07583/assets/figures/green3.jpg" id="S4.F3.sf5.g1" class="ltx_graphics ltx_img_square" width="100" height="88" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf5.2.1.1" class="ltx_text" style="font-size:90%;">(e)</span> </span><span id="S4.F3.sf5.3.2" class="ltx_text" style="font-size:90%;">the</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F3.sf6" class="ltx_figure ltx_figure_panel"><img src="/html/1909.07583/assets/figures/green4.jpg" id="S4.F3.sf6.g1" class="ltx_graphics ltx_img_square" width="100" height="88" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf6.2.1.1" class="ltx_text" style="font-size:90%;">(f)</span> </span><span id="S4.F3.sf6.3.2" class="ltx_text" style="font-size:90%;">sign</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F3.sf7" class="ltx_figure ltx_figure_panel"><img src="/html/1909.07583/assets/figures/red.jpg" id="S4.F3.sf7.g1" class="ltx_graphics ltx_img_square" width="100" height="88" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf7.2.1.1" class="ltx_text" style="font-size:90%;">(g)</span> </span><span id="S4.F3.sf7.3.2" class="ltx_text" style="font-size:90%;">(b) Answer: red</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F3.sf8" class="ltx_figure ltx_figure_panel"><img src="/html/1909.07583/assets/figures/red0.jpg" id="S4.F3.sf8.g1" class="ltx_graphics ltx_img_square" width="100" height="88" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf8.2.1.1" class="ltx_text" style="font-size:90%;">(h)</span> </span><span id="S4.F3.sf8.3.2" class="ltx_text" style="font-size:90%;">What</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F3.sf9" class="ltx_figure ltx_figure_panel"><img src="/html/1909.07583/assets/figures/red1.jpg" id="S4.F3.sf9.g1" class="ltx_graphics ltx_img_square" width="100" height="88" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf9.2.1.1" class="ltx_text" style="font-size:90%;">(i)</span> </span><span id="S4.F3.sf9.3.2" class="ltx_text" style="font-size:90%;">color</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F3.sf10" class="ltx_figure ltx_figure_panel"><img src="/html/1909.07583/assets/figures/red2.jpg" id="S4.F3.sf10.g1" class="ltx_graphics ltx_img_square" width="100" height="88" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf10.2.1.1" class="ltx_text" style="font-size:90%;">(j)</span> </span><span id="S4.F3.sf10.3.2" class="ltx_text" style="font-size:90%;">is</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F3.sf11" class="ltx_figure ltx_figure_panel"><img src="/html/1909.07583/assets/figures/red3.jpg" id="S4.F3.sf11.g1" class="ltx_graphics ltx_img_square" width="100" height="88" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf11.2.1.1" class="ltx_text" style="font-size:90%;">(k)</span> </span><span id="S4.F3.sf11.3.2" class="ltx_text" style="font-size:90%;">the</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F3.sf12" class="ltx_figure ltx_figure_panel"><img src="/html/1909.07583/assets/figures/red4.jpg" id="S4.F3.sf12.g1" class="ltx_graphics ltx_img_square" width="100" height="88" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf12.2.1.1" class="ltx_text" style="font-size:90%;">(l)</span> </span><span id="S4.F3.sf12.3.2" class="ltx_text" style="font-size:90%;">hydrant</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F3.sf13" class="ltx_figure ltx_figure_panel"><img src="/html/1909.07583/assets/figures/turban.jpg" id="S4.F3.sf13.g1" class="ltx_graphics ltx_img_landscape" width="603" height="437" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf13.2.1.1" class="ltx_text" style="font-size:90%;">(m)</span> </span><span id="S4.F3.sf13.3.2" class="ltx_text" style="font-size:90%;">(c) Answer: turban</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F3.sf14" class="ltx_figure ltx_figure_panel"><img src="/html/1909.07583/assets/figures/turban0.jpg" id="S4.F3.sf14.g1" class="ltx_graphics ltx_img_landscape" width="603" height="437" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf14.2.1.1" class="ltx_text" style="font-size:90%;">(n)</span> </span><span id="S4.F3.sf14.3.2" class="ltx_text" style="font-size:90%;">What</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F3.sf15" class="ltx_figure ltx_figure_panel"><img src="/html/1909.07583/assets/figures/turban1.jpg" id="S4.F3.sf15.g1" class="ltx_graphics ltx_img_landscape" width="603" height="437" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf15.2.1.1" class="ltx_text" style="font-size:90%;">(o)</span> </span><span id="S4.F3.sf15.3.2" class="ltx_text" style="font-size:90%;">is</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F3.sf16" class="ltx_figure ltx_figure_panel"><img src="/html/1909.07583/assets/figures/turban2.jpg" id="S4.F3.sf16.g1" class="ltx_graphics ltx_img_landscape" width="603" height="437" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf16.2.1.1" class="ltx_text" style="font-size:90%;">(p)</span> </span><span id="S4.F3.sf16.3.2" class="ltx_text" style="font-size:90%;">the</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F3.sf17" class="ltx_figure ltx_figure_panel"><img src="/html/1909.07583/assets/figures/turban3.jpg" id="S4.F3.sf17.g1" class="ltx_graphics ltx_img_landscape" width="603" height="437" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf17.2.1.1" class="ltx_text" style="font-size:90%;">(q)</span> </span><span id="S4.F3.sf17.3.2" class="ltx_text" style="font-size:90%;">man</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F3.sf18" class="ltx_figure ltx_figure_panel"><img src="/html/1909.07583/assets/figures/turban4.jpg" id="S4.F3.sf18.g1" class="ltx_graphics ltx_img_landscape" width="603" height="437" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf18.2.1.1" class="ltx_text" style="font-size:90%;">(r)</span> </span><span id="S4.F3.sf18.3.2" class="ltx_text" style="font-size:90%;">wearing</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F3.fig1" class="ltx_figure ltx_figure_panel">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F3.sf19" class="ltx_figure ltx_figure_panel"><img src="/html/1909.07583/assets/figures/turban5.jpg" id="S4.F3.sf19.g1" class="ltx_graphics ltx_img_landscape" width="603" height="437" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf19.2.1.1" class="ltx_text" style="font-size:90%;">(s)</span> </span><span id="S4.F3.sf19.3.2" class="ltx_text" style="font-size:90%;">on</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F3.sf20" class="ltx_figure ltx_figure_panel"><img src="/html/1909.07583/assets/figures/turban6.jpg" id="S4.F3.sf20.g1" class="ltx_graphics ltx_img_landscape" width="603" height="437" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf20.2.1.1" class="ltx_text" style="font-size:90%;">(t)</span> </span><span id="S4.F3.sf20.3.2" class="ltx_text" style="font-size:90%;">his</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F3.sf21" class="ltx_figure ltx_figure_panel"><img src="/html/1909.07583/assets/figures/turban7.jpg" id="S4.F3.sf21.g1" class="ltx_graphics ltx_img_landscape" width="603" height="437" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf21.2.1.1" class="ltx_text" style="font-size:90%;">(u)</span> </span><span id="S4.F3.sf21.3.2" class="ltx_text" style="font-size:90%;">head</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F3.sf22" class="ltx_figure ltx_figure_panel"><img src="/html/1909.07583/assets/figures/horse.jpg" id="S4.F3.sf22.g1" class="ltx_graphics ltx_img_square" width="100" height="88" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf22.2.1.1" class="ltx_text" style="font-size:90%;">(v)</span> </span><span id="S4.F3.sf22.3.2" class="ltx_text" style="font-size:90%;">(d) Answer: hay</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F3.sf23" class="ltx_figure ltx_figure_panel"><img src="/html/1909.07583/assets/figures/horse0.jpg" id="S4.F3.sf23.g1" class="ltx_graphics ltx_img_square" width="100" height="88" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf23.2.1.1" class="ltx_text" style="font-size:90%;">(w)</span> </span><span id="S4.F3.sf23.3.2" class="ltx_text" style="font-size:90%;">what</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F3.sf24" class="ltx_figure ltx_figure_panel"><img src="/html/1909.07583/assets/figures/horse1.jpg" id="S4.F3.sf24.g1" class="ltx_graphics ltx_img_square" width="100" height="88" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf24.2.1.1" class="ltx_text" style="font-size:90%;">(x)</span> </span><span id="S4.F3.sf24.3.2" class="ltx_text" style="font-size:90%;">is</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F3.sf25" class="ltx_figure ltx_figure_panel"><img src="/html/1909.07583/assets/figures/horse2.jpg" id="S4.F3.sf25.g1" class="ltx_graphics ltx_img_square" width="100" height="88" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf25.2.1.1" class="ltx_text" style="font-size:90%;">(y)</span> </span><span id="S4.F3.sf25.3.2" class="ltx_text" style="font-size:90%;">the</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F3.sf26" class="ltx_figure ltx_figure_panel"><img src="/html/1909.07583/assets/figures/horse3.jpg" id="S4.F3.sf26.g1" class="ltx_graphics ltx_img_square" width="100" height="88" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf26.2.1.1" class="ltx_text" style="font-size:90%;">(z)</span> </span><span id="S4.F3.sf26.3.2" class="ltx_text" style="font-size:90%;">horse</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F3.sf27" class="ltx_figure ltx_figure_panel"><img src="/html/1909.07583/assets/figures/horse4.jpg" id="S4.F3.sf27.g1" class="ltx_graphics ltx_img_square" width="100" height="88" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf27.2.1.1" class="ltx_text" style="font-size:90%;">(aa)</span> </span><span id="S4.F3.sf27.3.2" class="ltx_text" style="font-size:90%;">eating</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S4.F3.3.2" class="ltx_text" style="font-size:90%;">Examples of question generation process by our model with corresponding dynamic attention visualization.
The red and white bounding boxes localize regions with the largest and second largest attention weights respectively.
White regions have very low attention weights.
</span></figcaption>
</figure>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Qualitative Analysis</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">To illustrate the function of our model’s attention mechanism in generating corresponding questions
for given image-answer pairs,
we demonstrate a few examples of the question generation process of our proposed approach
with dynamic attention visualization
in Figure <a href="#S4.F3" title="Figure 3 ‣ 4.3 Ablation Study ‣ 4 Experiments ‣ Inverse Visual Question Answering with Multi-Level Attentions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.
The red box marks the salient region with the largest attention weight,
while the white box marks the salient region with the second largest attention weight, according to
Eq.(<a href="#S3.E11" title="In 3.1.5 Recurrent Question Generation ‣ 3.1 iVQA Model with Multi-Level Attentions ‣ 3 Approach ‣ Inverse Visual Question Answering with Multi-Level Attentions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>).</p>
</div>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.1" class="ltx_p">For the first two examples, we used the same image but with two different answers belonging to the same category (colour)
to check the effectiveness of our proposed multi-level attention mechanism in capturing the fine-grained visual information based on a given answer.
We can see that
the proposed model generates very suitable corresponding questions for the given answers.
Importantly,
through our attention mechanism, the answer cue guide the model
to attend to the exact corresponding objects (<em id="S4.SS4.p2.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S4.SS4.p2.1.2" class="ltx_text"></span> the green sign in the first example and red hydrant in the second).</p>
</div>
<div id="S4.SS4.p3" class="ltx_para">
<p id="S4.SS4.p3.1" class="ltx_p">In the third example, we used a more complex answer, specifically ”turban”.
We notice that our model can semantically understand that the turban represents an object that people wear on their heads.
Consequently, we can see our model tends to ignore most parts of the image and only focuses
on those objects corresponding to the currently predicted word (<em id="S4.SS4.p3.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S4.SS4.p3.1.2" class="ltx_text"></span>, <span id="S4.SS4.p3.1.3" class="ltx_text ltx_font_italic">man, wearing, head</span>).
Similarly in the last example, the model focuses on the horse object
while generating the word “<span id="S4.SS4.p3.1.4" class="ltx_text ltx_font_italic">horse</span>” and
on the horse’ head and mouth while generating the word “<span id="S4.SS4.p3.1.5" class="ltx_text ltx_font_italic">eating</span>.
These examples demonstrate that our approach has the capacity to correlate a given answer
with specific corresponding regions in a given image.
Meanwhile, it also has the capacity to dynamically change its attention according to the previously generated word.
These results again validated the effectiveness of the proposed model.
</p>
</div>
<div id="S4.SS4.p4" class="ltx_para">
<p id="S4.SS4.p4.1" class="ltx_p">Another issue that is worth mentioning is that
for a given image-answer pair, intuitively there could be multiple reasonable questions.
For example, in the first example in Figure <a href="#S4.F3" title="Figure 3 ‣ 4.3 Ablation Study ‣ 4 Experiments ‣ Inverse Visual Question Answering with Multi-Level Attentions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>,
given the answer “<span id="S4.SS4.p4.1.1" class="ltx_text ltx_font_italic">green</span>”, one could ask “What color is the tree leaves”.
However, although this question makes sense, it misses the focus of the image,
while our model generates the question focusing on the more salient region.</p>
</div>
<div id="S4.SS4.p5" class="ltx_para">
<p id="S4.SS4.p5.1" class="ltx_p">Nevertheless, given an image and a very short answer phrase,
a human can ask multiple questions with similar qualities.
To examine the capacity of the proposed model in generating diverse questions
for the same given image and answer pair,
we used a beam size of 4 to perform inference and present the top 3 questions
with the highest probability scores.
In Figure <a href="#S4.F4" title="Figure 4 ‣ 4.4 Qualitative Analysis ‣ 4 Experiments ‣ Inverse Visual Question Answering with Multi-Level Attentions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, we presented two examples.
We can see that the short answer phrase admits
enormous possibilities for generating corresponding questions.
The top questions generated by our model all seem to be very reasonable,
while focusing on the salient objects.</p>
</div>
<figure id="S4.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F4.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1909.07583/assets/figures/dessert-diverse.jpg" id="S4.F4.1.g1" class="ltx_graphics ltx_img_square" width="100" height="85" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F4.sf1" class="ltx_figure ltx_figure_panel ltx_align_center">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.sf1.3.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S4.F4.sf1.4.2" class="ltx_text" style="font-size:90%;">Answer: yes
<br class="ltx_break">
<br class="ltx_break"><span id="S4.F4.sf1.4.2.1" class="ltx_text ltx_font_bold">Is this a dessert?
<br class="ltx_break"></span>Is this a cake?
<br class="ltx_break">Is there a cake?
</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F4.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1909.07583/assets/figures/chineese-diverse.jpg" id="S4.F4.2.g1" class="ltx_graphics ltx_img_square" width="100" height="85" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F4.sf2" class="ltx_figure ltx_figure_panel ltx_align_center">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.sf2.3.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S4.F4.sf2.4.2" class="ltx_text" style="font-size:90%;">Answer: chinese
<br class="ltx_break">
<br class="ltx_break"><span id="S4.F4.sf2.4.2.1" class="ltx_text ltx_font_bold">What type of cuisine is this?
<br class="ltx_break"></span>What kind of cuisine is this?
<br class="ltx_break">What type of food is this?</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.4.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S4.F4.5.2" class="ltx_text" style="font-size:90%;">Examples of the diverse questions generated by our proposed model.
Questions in bold refer to the top questions selected by our model.</span></figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we proposed a novel multi-level attention model to tackle the new task of iVQA,
which has broader capacity for interacted visual and textual understanding than VQA.
Different from existing iVQA approaches, we enhance the visual representation extracted at the level of objects with their corresponding semantic information to reduce the semantic gap between visual and textual modalities.
In addition, we deploy a dual guiding attention to help the model focus
on the
parts corresponding to a given answer
and use a dynamic attention to attend to the most relevant image visual features in each recurrent question generation context.
We conducted experiments on the VQA V1 dataset to compare the proposed model with existing iVQA methods.
The results show the effectiveness of the proposed approach by demonstrating state-of-the-art performance.
</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
P. Anderson, X. He, C. Buehler, D. Teney, M. Johnson, S. Gould, and L. Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">Bottom-up and top-down attention for image captioning and visual
question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib1.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib1.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
S. Antol, A. Agrawal, J. Lu, M. Mitchell, D. Batra, C. L. Zitnick, and
D. Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">VQA: Visual Question Answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib2.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib2.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
H. Ben-younes, R. Cadène, M. Cord, and N. Thome.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">Mutan: Multimodal tucker fusion for visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib3.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib3.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
K. Chen, J. Wang, L.-C. Chen, H. Gao, W. Xu, and R. Nevatia.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">ABC-CNN: An attention based convolutional neural network for visual
question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">CoRR</span><span id="bib.bib4.4.2" class="ltx_text" style="font-size:90%;">, abs/1511.05960, 2015.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
X. Chen, H. Fang, T.-Y. Lin, R. Vedantam, S. Gupta, P. Dollár, and C. L.
Zitnick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">Microsoft COCO captions: Data collection and evaluation server.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">CoRR</span><span id="bib.bib5.4.2" class="ltx_text" style="font-size:90%;">, abs/1504.00325, 2015.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
K. Cho, B. van Merrienboer, Ç. Gülçehre, F. Bougares,
H. Schwenk, and Y. Bengio.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">Learning phrase representations using RNN encoder-decoder for
statistical machine translation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib6.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">EMNLP</span><span id="bib.bib6.5.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
Y. Goyal, T. Khot, D. Summers-Stay, D. Batra, and D. Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">Making the V in VQA matter: Elevating the role of image
understanding in visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib7.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib7.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
K. He, X. Zhang, S. Ren, and J. Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">Deep residual learning for image recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib8.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib8.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
U. Jain, Z. Zhang, and A. G. Schwing.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">Creativity: Generating diverse questions using variational
autoencoders.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib9.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib9.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
J. Johnson, A. Karpathy, and F. Li.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">DenseCap: Fully convolutional localization networks for dense
captioning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib10.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib10.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
A. Karpathy and L. Fei-Fei.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">Deep visual-semantic alignments for generating image descriptions.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib11.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib11.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
J. Kim, K. W. On, W. Lim, J. Kim, J. Ha, and B. Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">Hadamard product for low-rank bilinear pooling.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib12.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib12.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
D. P. Kingma and J. Ba.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">Adam: A method for stochastic optimization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib13.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib13.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
D. P. Kingma and M. Welling.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">Auto-encoding variational Bayes.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib14.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib14.5.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
R. Krishna, Y. Zhu, O. Groth, J. Johnson, K. Hata, J. Kravitz, S. Chen,
Y. Kalantidis, L.-J. Li, D. A. Shamma, M. S. Bernstein, and L. Fei-Fei.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">Visual genome: Connecting language and vision using crowdsourced
dense image annotations.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Inter. Journal of Computer Vision</span><span id="bib.bib15.4.2" class="ltx_text" style="font-size:90%;">, 123:32–73, 2016.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
Y. Li, N. Duan, B. Zhou, X. Chu, W. Ouyang, and X. Wang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">Visual question generation as dual task of visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib16.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib16.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
Y. Lin, Z. Pang, D. Wang, and Y. Zhuang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">Feature enhancement in attention for visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib17.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IJCAI</span><span id="bib.bib17.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
F. Liu, T. Xiang, T. M. Hospedales, W. Yang, and C. Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">Inverse visual question answering: A new benchmark and VQA
diagnosis tool.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE transactions on pattern analysis and machine intelligence</span><span id="bib.bib18.4.2" class="ltx_text" style="font-size:90%;">,
2018.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
F. Liu, T. Xiang, T. M. Hospedales, W. Yang, and C. Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">iVQA: Inverse visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib19.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib19.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
J. Lu, X. Lin, D. Batra, and D. Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">Deeper LSTM and normalized CNN visual question answering model.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">GitHub repository</span><span id="bib.bib20.4.2" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
J. Lu, C. Xiong, D. Parikh, and R. Socher.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">Knowing when to look: Adaptive attention via a visual sentinel for
image captioning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib21.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib21.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
J. Lu, J. Yang, D. Batra, and D. Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">Hierarchical question-image co-attention for visual question
answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib22.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NIPS</span><span id="bib.bib22.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
N. Mostafazadeh, I. Misra, J. Devlin, L. Zitnick, M. Mitchell, X. He, and
L. Vanderwende.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">Generating natural questions about an image.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib23.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ACL</span><span id="bib.bib23.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
J. Pennington, R. Socher, and C. D. Manning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">Glove: Global vectors for word representation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib24.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">EMNLP</span><span id="bib.bib24.5.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
S. Ren, K. He, R. B. Girshick, and J. Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">Faster r-cnn: Towards real-time object detection with region proposal
networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Transactions on Pattern Analysis and Machine Intelligence</span><span id="bib.bib25.4.2" class="ltx_text" style="font-size:90%;">,
39:1137–1149, 2015.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
O. Russakovsky, J. Deng, H. Su, J. Krause, S. Satheesh, S. Ma, Z. Huang,
A. Karpathy, A. Khosla, M. S. Bernstein, A. C. Berg, and L. Fei-Fei.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.2.1" class="ltx_text" style="font-size:90%;">ImageNet large scale visual recognition challenge.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Inter. Journal of Computer Vision</span><span id="bib.bib26.4.2" class="ltx_text" style="font-size:90%;">, 115:211–252, 2015.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
O. Vinyals, A. Toshev, S. Bengio, and D. Erhan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.2.1" class="ltx_text" style="font-size:90%;">Show and tell: A neural image caption generator.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib27.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib27.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
K. Xu, J. Ba, R. Kiros, K. Cho, A. C. Courville, R. Salakhutdinov, R. S. Zemel,
and Y. Bengio.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.2.1" class="ltx_text" style="font-size:90%;">Show, attend and tell: Neural image caption generation with visual
attention.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib28.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib28.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text" style="font-size:90%;">
K. Xu, J. Ba, R. Kiros, K. Cho, A. C. Courville, R. Salakhutdinov, R. S. Zemel,
and Y. Bengio.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.2.1" class="ltx_text" style="font-size:90%;">Show, attend and tell: Neural image caption generation with visual
attention.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib29.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib29.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text" style="font-size:90%;">
Z. Yang, X. He, J. Gao, L. Deng, and A. J. Smola.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.2.1" class="ltx_text" style="font-size:90%;">Stacked attention networks for image question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib30.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib30.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text" style="font-size:90%;">
Q. You, H. Jin, Z. Wang, C. Fang, and J. Luo.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.2.1" class="ltx_text" style="font-size:90%;">Image captioning with semantic attention.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib31.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib31.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text" style="font-size:90%;">
D. Yu, J. Fu, T. Mei, and Y. Rui.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.2.1" class="ltx_text" style="font-size:90%;">Multi-level attention networks for visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib32.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib32.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text" style="font-size:90%;">
Z. Yu, J. Yu, J. Fan, and D. Tao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.2.1" class="ltx_text" style="font-size:90%;">Multi-modal factorized bilinear pooling with co-attention learning
for visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib33.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib33.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"><span id="bib.bib34.1.1" class="ltx_text" style="font-size:90%;">
S. Zhang, L. Qu, S. You, Z. Yang, and J. Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.2.1" class="ltx_text" style="font-size:90%;">Automatic generation of grounded visual questions.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib34.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IJCAI</span><span id="bib.bib34.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text" style="font-size:90%;">
B. Zhou, Y. Tian, S. Sukhbaatar, A. Szlam, and R. Fergus.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.2.1" class="ltx_text" style="font-size:90%;">Simple baseline for visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">CoRR</span><span id="bib.bib35.4.2" class="ltx_text" style="font-size:90%;">, abs/1512.02167, 2015.
</span>
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1909.07582" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1909.07583" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1909.07583">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1909.07583" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1909.07584" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Mon Mar 11 17:08:52 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
