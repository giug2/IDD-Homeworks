<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2202.08036] No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices</title><meta property="og:description" content="Federated learning (FL) is an important paradigm for training global models from decentralized data in a privacy-preserving way.
Existing FL methods usually assume the global model can be trained on any participating c…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2202.08036">

<!--Generated on Thu Mar  7 20:02:04 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Federated learning,  Heterogeneous device,  Knowledge distillation">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Ruixuan Liu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id1.1.id1" class="ltx_text ltx_affiliation_institution">
School of Information, Renmin University of China
</span><span id="id2.2.id2" class="ltx_text ltx_affiliation_city">Beijing</span><span id="id3.3.id3" class="ltx_text ltx_affiliation_postcode">100872</span><span id="id4.4.id4" class="ltx_text ltx_affiliation_country">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:ruixuan.liu@ruc.edu.cn">ruixuan.liu@ruc.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Fangzhao Wu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id5.1.id1" class="ltx_text ltx_affiliation_institution">Microsoft Research Asia</span><span id="id6.2.id2" class="ltx_text ltx_affiliation_city">Beijing</span><span id="id7.3.id3" class="ltx_text ltx_affiliation_postcode">100080</span><span id="id8.4.id4" class="ltx_text ltx_affiliation_country">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:wufangzhao@gmail.com">wufangzhao@gmail.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Chuhan Wu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id9.1.id1" class="ltx_text ltx_affiliation_institution">Department of Electronic Engineering, Tsinghua University</span><span id="id10.2.id2" class="ltx_text ltx_affiliation_city">Beijing</span><span id="id11.3.id3" class="ltx_text ltx_affiliation_postcode">100084</span><span id="id12.4.id4" class="ltx_text ltx_affiliation_country">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:wuchuhan15@gmail.com">wuchuhan15@gmail.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yanlin Wang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id13.1.id1" class="ltx_text ltx_affiliation_institution">Microsoft Research Asia</span><span id="id14.2.id2" class="ltx_text ltx_affiliation_city">Beijing</span><span id="id15.3.id3" class="ltx_text ltx_affiliation_postcode">100080</span><span id="id16.4.id4" class="ltx_text ltx_affiliation_country">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:yanlwang@microsoft.com">yanlwang@microsoft.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Lingjuan Lyu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id17.1.id1" class="ltx_text ltx_affiliation_institution">Sony AI</span><span id="id18.2.id2" class="ltx_text ltx_affiliation_city">Tokyo</span><span id="id19.3.id3" class="ltx_text ltx_affiliation_postcode">xxx</span><span id="id20.4.id4" class="ltx_text ltx_affiliation_country">Japan</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:lingjuan.lv@sony.com">lingjuan.lv@sony.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hong Chen
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id21.1.id1" class="ltx_text ltx_affiliation_institution">
School of Information, Renmin University of China
</span><span id="id22.2.id2" class="ltx_text ltx_affiliation_city">Beijing</span><span id="id23.3.id3" class="ltx_text ltx_affiliation_postcode">100872</span><span id="id24.4.id4" class="ltx_text ltx_affiliation_country">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:chong@ruc.edu.cn">chong@ruc.edu.cn</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xing Xie
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id25.1.id1" class="ltx_text ltx_affiliation_institution">Microsoft Research Asia</span><span id="id26.2.id2" class="ltx_text ltx_affiliation_city">Beijing</span><span id="id27.3.id3" class="ltx_text ltx_affiliation_postcode">100080</span><span id="id28.4.id4" class="ltx_text ltx_affiliation_country">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:xingx@microsoft.com">xingx@microsoft.com</a>
</span></span></span>
</div>
<div class="ltx_dates">(2022)</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p id="id29.id1" class="ltx_p">Federated learning (FL) is an important paradigm for training global models from decentralized data in a privacy-preserving way.
Existing FL methods usually assume the global model can be trained on any participating client.
However, in real applications, the devices of clients are usually heterogeneous, and have different computing power.
Although big models like BERT have achieved huge success in AI, it is difficult to apply them to heterogeneous FL with weak clients.
The straightforward solutions like removing the weak clients or using a small model to fit all clients will lead to some problems, such as under-representation of dropped clients and inferior accuracy due to data loss or limited model representation ability.
In this work, we propose InclusiveFL, a client-inclusive federated learning method to handle this problem.
The core idea of InclusiveFL is to assign models of different sizes to clients with different computing capabilities, bigger models for powerful clients and smaller ones for weak clients.
We also propose an effective method to share the knowledge among local models with different sizes.
In this way, all the clients can participate in FL training, and the final model can be big and powerful enough.
Besides, we propose a momentum knowledge distillation method to better transfer knowledge in big models on powerful clients to the small models on weak clients.
Extensive experiments on many real-world benchmark datasets demonstrate the effectiveness of InclusiveFL in learning accurate models from clients with heterogeneous devices under the FL framework.</p>
</div>
<div class="ltx_keywords">Federated learning, Heterogeneous device, Knowledge distillation
</div>
<span id="id1" class="ltx_note ltx_note_frontmatter ltx_role_copyright"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmcopyright</span></span></span><span id="id2" class="ltx_note ltx_note_frontmatter ltx_role_journalyear"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2022</span></span></span><span id="id3" class="ltx_note ltx_note_frontmatter ltx_role_copyright"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmcopyright</span></span></span><span id="id4" class="ltx_note ltx_note_frontmatter ltx_role_conference"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining; August 14–18, 2022; Washington, DC, USA</span></span></span><span id="id5" class="ltx_note ltx_note_frontmatter ltx_role_booktitle"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining (KDD ’22), August 14–18, 2022, Washington, DC, USA</span></span></span><span id="id6" class="ltx_note ltx_note_frontmatter ltx_role_price"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">price: </span>15.00</span></span></span><span id="id7" class="ltx_note ltx_note_frontmatter ltx_role_doi"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/3534678.3539086</span></span></span><span id="id8" class="ltx_note ltx_note_frontmatter ltx_role_isbn"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>978-1-4503-9385-0/22/08</span></span></span><span id="id9" class="ltx_note ltx_note_frontmatter ltx_role_ccs"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computing methodologies Distributed computing methodologies</span></span></span><span id="id10" class="ltx_note ltx_note_frontmatter ltx_role_ccs"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computing methodologies Distributed artificial intelligence</span></span></span>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Nowadays, huge amounts of data are generated every day from a wide range of devices such as mobile phones, autonomous vehicles, or servers <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib27" title="" class="ltx_ref">2021</a>)</cite>.
Exchanging data from different sources to train machine learning models is attractive but challenging under the privacy regularization such as GDPR<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a target="_blank" href="https://gdpr-info.eu/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://gdpr-info.eu/</a></span></span></span>.
Based on the principles of focused collection and data minimization to avoid privacy issues, federated learning (FL) <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib26" title="" class="ltx_ref">2017</a>)</cite> emerges as a privacy-aware paradigm to train a global model while keeping decentralized data stay on local devices.
In each round, sampled clients pull a copy of the global model and optimize models in parallel on local datasets.
Then, the server aggregates local models to update the global model.
Hence, conventional federated learning methods <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib26" title="" class="ltx_ref">2017</a>; Reddi et al<span class="ltx_text">.</span>, <a href="#bib.bib32" title="" class="ltx_ref">2020</a>)</cite> make an essential assumption that all clients have sufficient local resources to train models with the same architecture.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2202.08036/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="149" height="93" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>. </span><span id="S1.F1.3.2" class="ltx_text" style="font-size:90%;">InclusiveFL over heterogeneous devices.</span></figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">However, as shown in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, in the real world, devices of clients are usually heterogeneous and they may have the significantly different computing power and memory size <cite class="ltx_cite ltx_citemacro_citep">(Varghese et al<span class="ltx_text">.</span>, <a href="#bib.bib38" title="" class="ltx_ref">2016</a>; Xu et al<span class="ltx_text">.</span>, <a href="#bib.bib48" title="" class="ltx_ref">2021</a>; Hou et al<span class="ltx_text">.</span>, <a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite>.
Although a large global model (e.g., BERT with 12-layer Transformer <cite class="ltx_cite ltx_citemacro_citep">(Kenton and Toutanova, <a href="#bib.bib19" title="" class="ltx_ref">2018</a>; Liu et al<span class="ltx_text">.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2019</a>)</cite>) is promising to achieve a good performance, it is difficult to apply it in heterogeneous FL because weak clients that are constrained by hardware resources cannot afford the cost of local training.
A straightforward way <cite class="ltx_cite ltx_citemacro_citep">(Bonawitz et al<span class="ltx_text">.</span>, <a href="#bib.bib2" title="" class="ltx_ref">2019</a>)</cite> is to drop weak clients and only aggregate parameters from powerful clients with sufficient resources.
But excluding data on weak devices in training leads to fairness issues <cite class="ltx_cite ltx_citemacro_citep">(Hao et al<span class="ltx_text">.</span>, <a href="#bib.bib14" title="" class="ltx_ref">2021</a>; Mehrabi et al<span class="ltx_text">.</span>, <a href="#bib.bib29" title="" class="ltx_ref">2021</a>)</cite> because weak clients would be underrepresented in the final global model.
Furthermore, the loss of data on weak clients causes an inferior accuracy <cite class="ltx_cite ltx_citemacro_citep">(Prusa et al<span class="ltx_text">.</span>, <a href="#bib.bib30" title="" class="ltx_ref">2015</a>)</cite>, especially when the amount of weak clients is enormous (e.g., in less developed areas).
Alternatively, a client-inclusive baseline is choosing a small global model to fit the minimum capability that all clients can offer.
However, the representation ability of the final global model would be largely limited by the small model architecture <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a href="#bib.bib25" title="" class="ltx_ref">2018</a>)</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Due to the limitations of the above methods, it is attractive to include all clients with heterogeneous devices while utilizing the capabilities of large models.
Thus, an intuitive way is training bigger local models on powerful clients and smaller local models on weak clients.
To exchange knowledge over heterogeneous models, several works <cite class="ltx_cite ltx_citemacro_citep">(Li and Wang, <a href="#bib.bib21" title="" class="ltx_ref">2019</a>; Chang et al<span class="ltx_text">.</span>, <a href="#bib.bib6" title="" class="ltx_ref">2019</a>; Sun and Lyu, <a href="#bib.bib37" title="" class="ltx_ref">2020</a>)</cite> utilize the knowledge distillation technique <cite class="ltx_cite ltx_citemacro_citep">(Hinton et al<span class="ltx_text">.</span>, <a href="#bib.bib16" title="" class="ltx_ref">2015</a>)</cite> to enhance the global model with an ensemble of local predictions.
However, they assume clients share a public proxy dataset, which is impractical for weak clients with a limited memory.
A recent work <span id="S1.p3.1.1" class="ltx_text ltx_font_italic">HeteroFL</span> <cite class="ltx_cite ltx_citemacro_citep">(Diao et al<span class="ltx_text">.</span>, <a href="#bib.bib8" title="" class="ltx_ref">2021</a>)</cite> does not require a proxy dataset and proposes to train heterogeneous local models by averaging the overlapped sub-matrices of all parameter matrices across various models.
However, this method is not beneficial for retaining large models’ knowledge in smaller models because the width pruning operation breaks the original model structure.
In addition, even the same sub-matrix may have different behaviors in the small and large models due to the model structure differences, which may lead to a suboptimal performance due to the mismatch of feature spaces.
Moreover, simply sharing parts of parameters across different models cannot effectively transfer useful knowledge encoded by strong models to other weaker models <cite class="ltx_cite ltx_citemacro_citep">(Hinton et al<span class="ltx_text">.</span>, <a href="#bib.bib16" title="" class="ltx_ref">2015</a>)</cite>.
Thus, how to learn models with different sizes and aligned feature spaces via effective knowledge transfer is a challenging problem in FL with heterogeneous devices.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this paper, we propose a client-inclusive federated training solution <span id="S1.p4.1.1" class="ltx_text ltx_font_italic">InclusiveFL</span> that can train a large model over devices with heterogeneous capabilities, and address the above key challenges.
<span id="S1.p4.1.2" class="ltx_text ltx_font_italic">InclusiveFL</span> assigns models of different sizes to clients with different computing capabilities, bigger models for powerful clients and smaller ones for weak clients.
To eliminate the mismatch between small and large models, we propose to share shallow bottom model layers in the largest model with other smaller models.
It has been empirically investigated that the lower layers are most critical for retaining the pre-trained knowledge in downstream tasks <cite class="ltx_cite ltx_citemacro_citep">(Sajjad et al<span class="ltx_text">.</span>, <a href="#bib.bib33" title="" class="ltx_ref">2020</a>)</cite>, and the feature spaces among different layers have much consistency <cite class="ltx_cite ltx_citemacro_citep">(Dodge et al<span class="ltx_text">.</span>, <a href="#bib.bib9" title="" class="ltx_ref">2020</a>)</cite>.
We propose a layer-wise heterogeneous aggregation method to update the parameters of shared bottom layers.
Furthermore, since the small model on weak clients may not be strong enough, we propose to transfer the knowledge learned by large models on powerful clients to small models on weak clients via a momentum distillation method <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a href="#bib.bib47" title="" class="ltx_ref">2021</a>)</cite>.
Intuitively, by encouraging the top encoder layer in small models to imitate the behavior of top encoder layers in a larger model, we can achieve effective knowledge transfer in <span id="S1.p4.1.3" class="ltx_text ltx_font_italic">InclusiveFL</span>.
Contributions of this paper are summarized as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose <span id="S1.I1.i1.p1.1.1" class="ltx_text ltx_font_italic">InclusiveFL</span> for effective federated learning over heterogeneous client devices.
Clients with different computing capabilities are assigned models of different sizes, and all of them can contribute to learning a large and powerful global model.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We propose an effective method to share the knowledge in the heterogeneous models from heterogeneous clients.
Besides, we propose a momentum knowledge distillation method to boost knowledge sharing from large models to small models.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We conduct extensive experiments to verify the effectiveness of the proposed method in learning an accurate global model from heterogeneous clients in the FL framework.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Background and Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.5" class="ltx_p">Federated learning <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib26" title="" class="ltx_ref">2017</a>)</cite> is a machine learning technique that trains an algorithm across multiple decentralized edge devices (cross-device) <cite class="ltx_cite ltx_citemacro_citep">(Hard et al<span class="ltx_text">.</span>, <a href="#bib.bib15" title="" class="ltx_ref">2018</a>; McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib28" title="" class="ltx_ref">2018</a>; Yang et al<span class="ltx_text">.</span>, <a href="#bib.bib49" title="" class="ltx_ref">2018</a>)</cite> or servers holding local data samples (cross-silo) <cite class="ltx_cite ltx_citemacro_citep">(Warnat-Herresthal et al<span class="ltx_text">.</span>, <a href="#bib.bib42" title="" class="ltx_ref">2021</a>; Courtiol et al<span class="ltx_text">.</span>, <a href="#bib.bib7" title="" class="ltx_ref">2019</a>; Wu et al<span class="ltx_text">.</span>, <a href="#bib.bib46" title="" class="ltx_ref">2022</a>)</cite>, without exchanging them.
Conventional federated learning protocol typically adopts <span id="S2.p1.5.1" class="ltx_text ltx_font_italic">FedAvg</span> <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib26" title="" class="ltx_ref">2017</a>)</cite> to aggregate local parameters as follows:</p>
<table id="S2.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.Ex1.m1.1" class="ltx_Math" alttext="w_{t+1}\leftarrow\sum_{k=1}^{K}\frac{n_{k}}{n}w_{t+1}^{k}," display="block"><semantics id="S2.Ex1.m1.1a"><mrow id="S2.Ex1.m1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.cmml"><mrow id="S2.Ex1.m1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.cmml"><msub id="S2.Ex1.m1.1.1.1.1.2" xref="S2.Ex1.m1.1.1.1.1.2.cmml"><mi id="S2.Ex1.m1.1.1.1.1.2.2" xref="S2.Ex1.m1.1.1.1.1.2.2.cmml">w</mi><mrow id="S2.Ex1.m1.1.1.1.1.2.3" xref="S2.Ex1.m1.1.1.1.1.2.3.cmml"><mi id="S2.Ex1.m1.1.1.1.1.2.3.2" xref="S2.Ex1.m1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S2.Ex1.m1.1.1.1.1.2.3.1" xref="S2.Ex1.m1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S2.Ex1.m1.1.1.1.1.2.3.3" xref="S2.Ex1.m1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo rspace="0.111em" stretchy="false" id="S2.Ex1.m1.1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.1.cmml">←</mo><mrow id="S2.Ex1.m1.1.1.1.1.3" xref="S2.Ex1.m1.1.1.1.1.3.cmml"><munderover id="S2.Ex1.m1.1.1.1.1.3.1" xref="S2.Ex1.m1.1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S2.Ex1.m1.1.1.1.1.3.1.2.2" xref="S2.Ex1.m1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.Ex1.m1.1.1.1.1.3.1.2.3" xref="S2.Ex1.m1.1.1.1.1.3.1.2.3.cmml"><mi id="S2.Ex1.m1.1.1.1.1.3.1.2.3.2" xref="S2.Ex1.m1.1.1.1.1.3.1.2.3.2.cmml">k</mi><mo id="S2.Ex1.m1.1.1.1.1.3.1.2.3.1" xref="S2.Ex1.m1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S2.Ex1.m1.1.1.1.1.3.1.2.3.3" xref="S2.Ex1.m1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.Ex1.m1.1.1.1.1.3.1.3" xref="S2.Ex1.m1.1.1.1.1.3.1.3.cmml">K</mi></munderover><mrow id="S2.Ex1.m1.1.1.1.1.3.2" xref="S2.Ex1.m1.1.1.1.1.3.2.cmml"><mfrac id="S2.Ex1.m1.1.1.1.1.3.2.2" xref="S2.Ex1.m1.1.1.1.1.3.2.2.cmml"><msub id="S2.Ex1.m1.1.1.1.1.3.2.2.2" xref="S2.Ex1.m1.1.1.1.1.3.2.2.2.cmml"><mi id="S2.Ex1.m1.1.1.1.1.3.2.2.2.2" xref="S2.Ex1.m1.1.1.1.1.3.2.2.2.2.cmml">n</mi><mi id="S2.Ex1.m1.1.1.1.1.3.2.2.2.3" xref="S2.Ex1.m1.1.1.1.1.3.2.2.2.3.cmml">k</mi></msub><mi id="S2.Ex1.m1.1.1.1.1.3.2.2.3" xref="S2.Ex1.m1.1.1.1.1.3.2.2.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.1.1.1.1.3.2.1" xref="S2.Ex1.m1.1.1.1.1.3.2.1.cmml">​</mo><msubsup id="S2.Ex1.m1.1.1.1.1.3.2.3" xref="S2.Ex1.m1.1.1.1.1.3.2.3.cmml"><mi id="S2.Ex1.m1.1.1.1.1.3.2.3.2.2" xref="S2.Ex1.m1.1.1.1.1.3.2.3.2.2.cmml">w</mi><mrow id="S2.Ex1.m1.1.1.1.1.3.2.3.2.3" xref="S2.Ex1.m1.1.1.1.1.3.2.3.2.3.cmml"><mi id="S2.Ex1.m1.1.1.1.1.3.2.3.2.3.2" xref="S2.Ex1.m1.1.1.1.1.3.2.3.2.3.2.cmml">t</mi><mo id="S2.Ex1.m1.1.1.1.1.3.2.3.2.3.1" xref="S2.Ex1.m1.1.1.1.1.3.2.3.2.3.1.cmml">+</mo><mn id="S2.Ex1.m1.1.1.1.1.3.2.3.2.3.3" xref="S2.Ex1.m1.1.1.1.1.3.2.3.2.3.3.cmml">1</mn></mrow><mi id="S2.Ex1.m1.1.1.1.1.3.2.3.3" xref="S2.Ex1.m1.1.1.1.1.3.2.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><mo id="S2.Ex1.m1.1.1.1.2" xref="S2.Ex1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.1b"><apply id="S2.Ex1.m1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1"><ci id="S2.Ex1.m1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1">←</ci><apply id="S2.Ex1.m1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.2.1.cmml" xref="S2.Ex1.m1.1.1.1.1.2">subscript</csymbol><ci id="S2.Ex1.m1.1.1.1.1.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.2.2">𝑤</ci><apply id="S2.Ex1.m1.1.1.1.1.2.3.cmml" xref="S2.Ex1.m1.1.1.1.1.2.3"><plus id="S2.Ex1.m1.1.1.1.1.2.3.1.cmml" xref="S2.Ex1.m1.1.1.1.1.2.3.1"></plus><ci id="S2.Ex1.m1.1.1.1.1.2.3.2.cmml" xref="S2.Ex1.m1.1.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S2.Ex1.m1.1.1.1.1.2.3.3.cmml" xref="S2.Ex1.m1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S2.Ex1.m1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.1.1.1.1.3"><apply id="S2.Ex1.m1.1.1.1.1.3.1.cmml" xref="S2.Ex1.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.3.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.3.1">superscript</csymbol><apply id="S2.Ex1.m1.1.1.1.1.3.1.2.cmml" xref="S2.Ex1.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.3.1.2.1.cmml" xref="S2.Ex1.m1.1.1.1.1.3.1">subscript</csymbol><sum id="S2.Ex1.m1.1.1.1.1.3.1.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.3.1.2.2"></sum><apply id="S2.Ex1.m1.1.1.1.1.3.1.2.3.cmml" xref="S2.Ex1.m1.1.1.1.1.3.1.2.3"><eq id="S2.Ex1.m1.1.1.1.1.3.1.2.3.1.cmml" xref="S2.Ex1.m1.1.1.1.1.3.1.2.3.1"></eq><ci id="S2.Ex1.m1.1.1.1.1.3.1.2.3.2.cmml" xref="S2.Ex1.m1.1.1.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="S2.Ex1.m1.1.1.1.1.3.1.2.3.3.cmml" xref="S2.Ex1.m1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S2.Ex1.m1.1.1.1.1.3.1.3.cmml" xref="S2.Ex1.m1.1.1.1.1.3.1.3">𝐾</ci></apply><apply id="S2.Ex1.m1.1.1.1.1.3.2.cmml" xref="S2.Ex1.m1.1.1.1.1.3.2"><times id="S2.Ex1.m1.1.1.1.1.3.2.1.cmml" xref="S2.Ex1.m1.1.1.1.1.3.2.1"></times><apply id="S2.Ex1.m1.1.1.1.1.3.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.3.2.2"><divide id="S2.Ex1.m1.1.1.1.1.3.2.2.1.cmml" xref="S2.Ex1.m1.1.1.1.1.3.2.2"></divide><apply id="S2.Ex1.m1.1.1.1.1.3.2.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.3.2.2.2.1.cmml" xref="S2.Ex1.m1.1.1.1.1.3.2.2.2">subscript</csymbol><ci id="S2.Ex1.m1.1.1.1.1.3.2.2.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.3.2.2.2.2">𝑛</ci><ci id="S2.Ex1.m1.1.1.1.1.3.2.2.2.3.cmml" xref="S2.Ex1.m1.1.1.1.1.3.2.2.2.3">𝑘</ci></apply><ci id="S2.Ex1.m1.1.1.1.1.3.2.2.3.cmml" xref="S2.Ex1.m1.1.1.1.1.3.2.2.3">𝑛</ci></apply><apply id="S2.Ex1.m1.1.1.1.1.3.2.3.cmml" xref="S2.Ex1.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.3.2.3.1.cmml" xref="S2.Ex1.m1.1.1.1.1.3.2.3">superscript</csymbol><apply id="S2.Ex1.m1.1.1.1.1.3.2.3.2.cmml" xref="S2.Ex1.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.3.2.3.2.1.cmml" xref="S2.Ex1.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S2.Ex1.m1.1.1.1.1.3.2.3.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.3.2.3.2.2">𝑤</ci><apply id="S2.Ex1.m1.1.1.1.1.3.2.3.2.3.cmml" xref="S2.Ex1.m1.1.1.1.1.3.2.3.2.3"><plus id="S2.Ex1.m1.1.1.1.1.3.2.3.2.3.1.cmml" xref="S2.Ex1.m1.1.1.1.1.3.2.3.2.3.1"></plus><ci id="S2.Ex1.m1.1.1.1.1.3.2.3.2.3.2.cmml" xref="S2.Ex1.m1.1.1.1.1.3.2.3.2.3.2">𝑡</ci><cn type="integer" id="S2.Ex1.m1.1.1.1.1.3.2.3.2.3.3.cmml" xref="S2.Ex1.m1.1.1.1.1.3.2.3.2.3.3">1</cn></apply></apply><ci id="S2.Ex1.m1.1.1.1.1.3.2.3.3.cmml" xref="S2.Ex1.m1.1.1.1.1.3.2.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.1c">w_{t+1}\leftarrow\sum_{k=1}^{K}\frac{n_{k}}{n}w_{t+1}^{k},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S2.p1.4" class="ltx_p">where <math id="S2.p1.1.m1.1" class="ltx_Math" alttext="n=\sum_{k=1}^{K}n_{k}" display="inline"><semantics id="S2.p1.1.m1.1a"><mrow id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml"><mi id="S2.p1.1.m1.1.1.2" xref="S2.p1.1.m1.1.1.2.cmml">n</mi><mo rspace="0.111em" id="S2.p1.1.m1.1.1.1" xref="S2.p1.1.m1.1.1.1.cmml">=</mo><mrow id="S2.p1.1.m1.1.1.3" xref="S2.p1.1.m1.1.1.3.cmml"><msubsup id="S2.p1.1.m1.1.1.3.1" xref="S2.p1.1.m1.1.1.3.1.cmml"><mo id="S2.p1.1.m1.1.1.3.1.2.2" xref="S2.p1.1.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.p1.1.m1.1.1.3.1.2.3" xref="S2.p1.1.m1.1.1.3.1.2.3.cmml"><mi id="S2.p1.1.m1.1.1.3.1.2.3.2" xref="S2.p1.1.m1.1.1.3.1.2.3.2.cmml">k</mi><mo id="S2.p1.1.m1.1.1.3.1.2.3.1" xref="S2.p1.1.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S2.p1.1.m1.1.1.3.1.2.3.3" xref="S2.p1.1.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.p1.1.m1.1.1.3.1.3" xref="S2.p1.1.m1.1.1.3.1.3.cmml">K</mi></msubsup><msub id="S2.p1.1.m1.1.1.3.2" xref="S2.p1.1.m1.1.1.3.2.cmml"><mi id="S2.p1.1.m1.1.1.3.2.2" xref="S2.p1.1.m1.1.1.3.2.2.cmml">n</mi><mi id="S2.p1.1.m1.1.1.3.2.3" xref="S2.p1.1.m1.1.1.3.2.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><apply id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1"><eq id="S2.p1.1.m1.1.1.1.cmml" xref="S2.p1.1.m1.1.1.1"></eq><ci id="S2.p1.1.m1.1.1.2.cmml" xref="S2.p1.1.m1.1.1.2">𝑛</ci><apply id="S2.p1.1.m1.1.1.3.cmml" xref="S2.p1.1.m1.1.1.3"><apply id="S2.p1.1.m1.1.1.3.1.cmml" xref="S2.p1.1.m1.1.1.3.1"><csymbol cd="ambiguous" id="S2.p1.1.m1.1.1.3.1.1.cmml" xref="S2.p1.1.m1.1.1.3.1">superscript</csymbol><apply id="S2.p1.1.m1.1.1.3.1.2.cmml" xref="S2.p1.1.m1.1.1.3.1"><csymbol cd="ambiguous" id="S2.p1.1.m1.1.1.3.1.2.1.cmml" xref="S2.p1.1.m1.1.1.3.1">subscript</csymbol><sum id="S2.p1.1.m1.1.1.3.1.2.2.cmml" xref="S2.p1.1.m1.1.1.3.1.2.2"></sum><apply id="S2.p1.1.m1.1.1.3.1.2.3.cmml" xref="S2.p1.1.m1.1.1.3.1.2.3"><eq id="S2.p1.1.m1.1.1.3.1.2.3.1.cmml" xref="S2.p1.1.m1.1.1.3.1.2.3.1"></eq><ci id="S2.p1.1.m1.1.1.3.1.2.3.2.cmml" xref="S2.p1.1.m1.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="S2.p1.1.m1.1.1.3.1.2.3.3.cmml" xref="S2.p1.1.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S2.p1.1.m1.1.1.3.1.3.cmml" xref="S2.p1.1.m1.1.1.3.1.3">𝐾</ci></apply><apply id="S2.p1.1.m1.1.1.3.2.cmml" xref="S2.p1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.p1.1.m1.1.1.3.2.1.cmml" xref="S2.p1.1.m1.1.1.3.2">subscript</csymbol><ci id="S2.p1.1.m1.1.1.3.2.2.cmml" xref="S2.p1.1.m1.1.1.3.2.2">𝑛</ci><ci id="S2.p1.1.m1.1.1.3.2.3.cmml" xref="S2.p1.1.m1.1.1.3.2.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">n=\sum_{k=1}^{K}n_{k}</annotation></semantics></math> denotes the total number of local samples.
For a better training convergence, <span id="S2.p1.4.1" class="ltx_text ltx_font_italic">FedAdam</span> <cite class="ltx_cite ltx_citemacro_citep">(Reddi et al<span class="ltx_text">.</span>, <a href="#bib.bib32" title="" class="ltx_ref">2020</a>)</cite> is recently proposed to use adaptive methods on the server and SGD on the clients.
For each round, a sampled client <math id="S2.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.p1.2.m2.1a"><mi id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">i</annotation></semantics></math> computes the local update <math id="S2.p1.3.m3.1" class="ltx_Math" alttext="g_{t}^{i}" display="inline"><semantics id="S2.p1.3.m3.1a"><msubsup id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml"><mi id="S2.p1.3.m3.1.1.2.2" xref="S2.p1.3.m3.1.1.2.2.cmml">g</mi><mi id="S2.p1.3.m3.1.1.2.3" xref="S2.p1.3.m3.1.1.2.3.cmml">t</mi><mi id="S2.p1.3.m3.1.1.3" xref="S2.p1.3.m3.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><apply id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p1.3.m3.1.1.1.cmml" xref="S2.p1.3.m3.1.1">superscript</csymbol><apply id="S2.p1.3.m3.1.1.2.cmml" xref="S2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p1.3.m3.1.1.2.1.cmml" xref="S2.p1.3.m3.1.1">subscript</csymbol><ci id="S2.p1.3.m3.1.1.2.2.cmml" xref="S2.p1.3.m3.1.1.2.2">𝑔</ci><ci id="S2.p1.3.m3.1.1.2.3.cmml" xref="S2.p1.3.m3.1.1.2.3">𝑡</ci></apply><ci id="S2.p1.3.m3.1.1.3.cmml" xref="S2.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">g_{t}^{i}</annotation></semantics></math> after iterating over several rounds of local SGDs.
Then, the server averages local updates <math id="S2.p1.4.m4.2" class="ltx_Math" alttext="g_{t}\leftarrow\frac{1}{|\mathcal{S}|}\sum_{i\in|\mathcal{S}|}g_{t}^{i}" display="inline"><semantics id="S2.p1.4.m4.2a"><mrow id="S2.p1.4.m4.2.3" xref="S2.p1.4.m4.2.3.cmml"><msub id="S2.p1.4.m4.2.3.2" xref="S2.p1.4.m4.2.3.2.cmml"><mi id="S2.p1.4.m4.2.3.2.2" xref="S2.p1.4.m4.2.3.2.2.cmml">g</mi><mi id="S2.p1.4.m4.2.3.2.3" xref="S2.p1.4.m4.2.3.2.3.cmml">t</mi></msub><mo stretchy="false" id="S2.p1.4.m4.2.3.1" xref="S2.p1.4.m4.2.3.1.cmml">←</mo><mrow id="S2.p1.4.m4.2.3.3" xref="S2.p1.4.m4.2.3.3.cmml"><mfrac id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml"><mn id="S2.p1.4.m4.1.1.3" xref="S2.p1.4.m4.1.1.3.cmml">1</mn><mrow id="S2.p1.4.m4.1.1.1.3" xref="S2.p1.4.m4.1.1.1.2.cmml"><mo stretchy="false" id="S2.p1.4.m4.1.1.1.3.1" xref="S2.p1.4.m4.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.4.m4.1.1.1.1" xref="S2.p1.4.m4.1.1.1.1.cmml">𝒮</mi><mo stretchy="false" id="S2.p1.4.m4.1.1.1.3.2" xref="S2.p1.4.m4.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S2.p1.4.m4.2.3.3.1" xref="S2.p1.4.m4.2.3.3.1.cmml">​</mo><mrow id="S2.p1.4.m4.2.3.3.2" xref="S2.p1.4.m4.2.3.3.2.cmml"><msub id="S2.p1.4.m4.2.3.3.2.1" xref="S2.p1.4.m4.2.3.3.2.1.cmml"><mo id="S2.p1.4.m4.2.3.3.2.1.2" xref="S2.p1.4.m4.2.3.3.2.1.2.cmml">∑</mo><mrow id="S2.p1.4.m4.2.2.1" xref="S2.p1.4.m4.2.2.1.cmml"><mi id="S2.p1.4.m4.2.2.1.3" xref="S2.p1.4.m4.2.2.1.3.cmml">i</mi><mo id="S2.p1.4.m4.2.2.1.2" xref="S2.p1.4.m4.2.2.1.2.cmml">∈</mo><mrow id="S2.p1.4.m4.2.2.1.4.2" xref="S2.p1.4.m4.2.2.1.4.1.cmml"><mo stretchy="false" id="S2.p1.4.m4.2.2.1.4.2.1" xref="S2.p1.4.m4.2.2.1.4.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.4.m4.2.2.1.1" xref="S2.p1.4.m4.2.2.1.1.cmml">𝒮</mi><mo stretchy="false" id="S2.p1.4.m4.2.2.1.4.2.2" xref="S2.p1.4.m4.2.2.1.4.1.1.cmml">|</mo></mrow></mrow></msub><msubsup id="S2.p1.4.m4.2.3.3.2.2" xref="S2.p1.4.m4.2.3.3.2.2.cmml"><mi id="S2.p1.4.m4.2.3.3.2.2.2.2" xref="S2.p1.4.m4.2.3.3.2.2.2.2.cmml">g</mi><mi id="S2.p1.4.m4.2.3.3.2.2.2.3" xref="S2.p1.4.m4.2.3.3.2.2.2.3.cmml">t</mi><mi id="S2.p1.4.m4.2.3.3.2.2.3" xref="S2.p1.4.m4.2.3.3.2.2.3.cmml">i</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.2b"><apply id="S2.p1.4.m4.2.3.cmml" xref="S2.p1.4.m4.2.3"><ci id="S2.p1.4.m4.2.3.1.cmml" xref="S2.p1.4.m4.2.3.1">←</ci><apply id="S2.p1.4.m4.2.3.2.cmml" xref="S2.p1.4.m4.2.3.2"><csymbol cd="ambiguous" id="S2.p1.4.m4.2.3.2.1.cmml" xref="S2.p1.4.m4.2.3.2">subscript</csymbol><ci id="S2.p1.4.m4.2.3.2.2.cmml" xref="S2.p1.4.m4.2.3.2.2">𝑔</ci><ci id="S2.p1.4.m4.2.3.2.3.cmml" xref="S2.p1.4.m4.2.3.2.3">𝑡</ci></apply><apply id="S2.p1.4.m4.2.3.3.cmml" xref="S2.p1.4.m4.2.3.3"><times id="S2.p1.4.m4.2.3.3.1.cmml" xref="S2.p1.4.m4.2.3.3.1"></times><apply id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1"><divide id="S2.p1.4.m4.1.1.2.cmml" xref="S2.p1.4.m4.1.1"></divide><cn type="integer" id="S2.p1.4.m4.1.1.3.cmml" xref="S2.p1.4.m4.1.1.3">1</cn><apply id="S2.p1.4.m4.1.1.1.2.cmml" xref="S2.p1.4.m4.1.1.1.3"><abs id="S2.p1.4.m4.1.1.1.2.1.cmml" xref="S2.p1.4.m4.1.1.1.3.1"></abs><ci id="S2.p1.4.m4.1.1.1.1.cmml" xref="S2.p1.4.m4.1.1.1.1">𝒮</ci></apply></apply><apply id="S2.p1.4.m4.2.3.3.2.cmml" xref="S2.p1.4.m4.2.3.3.2"><apply id="S2.p1.4.m4.2.3.3.2.1.cmml" xref="S2.p1.4.m4.2.3.3.2.1"><csymbol cd="ambiguous" id="S2.p1.4.m4.2.3.3.2.1.1.cmml" xref="S2.p1.4.m4.2.3.3.2.1">subscript</csymbol><sum id="S2.p1.4.m4.2.3.3.2.1.2.cmml" xref="S2.p1.4.m4.2.3.3.2.1.2"></sum><apply id="S2.p1.4.m4.2.2.1.cmml" xref="S2.p1.4.m4.2.2.1"><in id="S2.p1.4.m4.2.2.1.2.cmml" xref="S2.p1.4.m4.2.2.1.2"></in><ci id="S2.p1.4.m4.2.2.1.3.cmml" xref="S2.p1.4.m4.2.2.1.3">𝑖</ci><apply id="S2.p1.4.m4.2.2.1.4.1.cmml" xref="S2.p1.4.m4.2.2.1.4.2"><abs id="S2.p1.4.m4.2.2.1.4.1.1.cmml" xref="S2.p1.4.m4.2.2.1.4.2.1"></abs><ci id="S2.p1.4.m4.2.2.1.1.cmml" xref="S2.p1.4.m4.2.2.1.1">𝒮</ci></apply></apply></apply><apply id="S2.p1.4.m4.2.3.3.2.2.cmml" xref="S2.p1.4.m4.2.3.3.2.2"><csymbol cd="ambiguous" id="S2.p1.4.m4.2.3.3.2.2.1.cmml" xref="S2.p1.4.m4.2.3.3.2.2">superscript</csymbol><apply id="S2.p1.4.m4.2.3.3.2.2.2.cmml" xref="S2.p1.4.m4.2.3.3.2.2"><csymbol cd="ambiguous" id="S2.p1.4.m4.2.3.3.2.2.2.1.cmml" xref="S2.p1.4.m4.2.3.3.2.2">subscript</csymbol><ci id="S2.p1.4.m4.2.3.3.2.2.2.2.cmml" xref="S2.p1.4.m4.2.3.3.2.2.2.2">𝑔</ci><ci id="S2.p1.4.m4.2.3.3.2.2.2.3.cmml" xref="S2.p1.4.m4.2.3.3.2.2.2.3">𝑡</ci></apply><ci id="S2.p1.4.m4.2.3.3.2.2.3.cmml" xref="S2.p1.4.m4.2.3.3.2.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.2c">g_{t}\leftarrow\frac{1}{|\mathcal{S}|}\sum_{i\in|\mathcal{S}|}g_{t}^{i}</annotation></semantics></math> and updates the global model as follows:</p>
<table id="S2.Ex2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.Ex2.m1.46" class="ltx_Math" alttext="\begin{split}m_{t}\leftarrow&amp;\beta_{1}m_{t-1}+(1-\beta_{1})g_{t}\\
v_{t}\leftarrow&amp;\beta_{2}v_{t-1}+(1-\beta_{2})g_{t}^{2}\\
w_{t+1}\leftarrow&amp;w_{t}+\eta\frac{m_{t}}{\sqrt{v_{t}}+\tau}.\\
\end{split}" display="block"><semantics id="S2.Ex2.m1.46a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="S2.Ex2.m1.46.46.4"><mtr id="S2.Ex2.m1.46.46.4a"><mtd class="ltx_align_right" columnalign="right" id="S2.Ex2.m1.46.46.4b"><mrow id="S2.Ex2.m1.3.3.3.3.3"><msub id="S2.Ex2.m1.3.3.3.3.3.4"><mi id="S2.Ex2.m1.1.1.1.1.1.1" xref="S2.Ex2.m1.1.1.1.1.1.1.cmml">m</mi><mi id="S2.Ex2.m1.2.2.2.2.2.2.1" xref="S2.Ex2.m1.2.2.2.2.2.2.1.cmml">t</mi></msub><mo stretchy="false" id="S2.Ex2.m1.3.3.3.3.3.3" xref="S2.Ex2.m1.3.3.3.3.3.3.cmml">←</mo><mi id="S2.Ex2.m1.3.3.3.3.3.5" xref="S2.Ex2.m1.43.43.1.1.1.cmml"></mi></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.Ex2.m1.46.46.4c"><mrow id="S2.Ex2.m1.44.44.2.43.17.14"><mrow id="S2.Ex2.m1.44.44.2.43.17.14.15"><msub id="S2.Ex2.m1.44.44.2.43.17.14.15.2"><mi id="S2.Ex2.m1.4.4.4.4.1.1" xref="S2.Ex2.m1.4.4.4.4.1.1.cmml">β</mi><mn id="S2.Ex2.m1.5.5.5.5.2.2.1" xref="S2.Ex2.m1.5.5.5.5.2.2.1.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S2.Ex2.m1.44.44.2.43.17.14.15.1" xref="S2.Ex2.m1.43.43.1.1.1.cmml">​</mo><msub id="S2.Ex2.m1.44.44.2.43.17.14.15.3"><mi id="S2.Ex2.m1.6.6.6.6.3.3" xref="S2.Ex2.m1.6.6.6.6.3.3.cmml">m</mi><mrow id="S2.Ex2.m1.7.7.7.7.4.4.1" xref="S2.Ex2.m1.7.7.7.7.4.4.1.cmml"><mi id="S2.Ex2.m1.7.7.7.7.4.4.1.2" xref="S2.Ex2.m1.7.7.7.7.4.4.1.2.cmml">t</mi><mo id="S2.Ex2.m1.7.7.7.7.4.4.1.1" xref="S2.Ex2.m1.7.7.7.7.4.4.1.1.cmml">−</mo><mn id="S2.Ex2.m1.7.7.7.7.4.4.1.3" xref="S2.Ex2.m1.7.7.7.7.4.4.1.3.cmml">1</mn></mrow></msub></mrow><mo id="S2.Ex2.m1.8.8.8.8.5.5" xref="S2.Ex2.m1.8.8.8.8.5.5.cmml">+</mo><mrow id="S2.Ex2.m1.44.44.2.43.17.14.14"><mrow id="S2.Ex2.m1.44.44.2.43.17.14.14.1.1"><mo stretchy="false" id="S2.Ex2.m1.9.9.9.9.6.6" xref="S2.Ex2.m1.43.43.1.1.1.cmml">(</mo><mrow id="S2.Ex2.m1.44.44.2.43.17.14.14.1.1.1"><mn id="S2.Ex2.m1.10.10.10.10.7.7" xref="S2.Ex2.m1.10.10.10.10.7.7.cmml">1</mn><mo id="S2.Ex2.m1.11.11.11.11.8.8" xref="S2.Ex2.m1.11.11.11.11.8.8.cmml">−</mo><msub id="S2.Ex2.m1.44.44.2.43.17.14.14.1.1.1.1"><mi id="S2.Ex2.m1.12.12.12.12.9.9" xref="S2.Ex2.m1.12.12.12.12.9.9.cmml">β</mi><mn id="S2.Ex2.m1.13.13.13.13.10.10.1" xref="S2.Ex2.m1.13.13.13.13.10.10.1.cmml">1</mn></msub></mrow><mo stretchy="false" id="S2.Ex2.m1.14.14.14.14.11.11" xref="S2.Ex2.m1.43.43.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.Ex2.m1.44.44.2.43.17.14.14.2" xref="S2.Ex2.m1.43.43.1.1.1.cmml">​</mo><msub id="S2.Ex2.m1.44.44.2.43.17.14.14.3"><mi id="S2.Ex2.m1.15.15.15.15.12.12" xref="S2.Ex2.m1.15.15.15.15.12.12.cmml">g</mi><mi id="S2.Ex2.m1.16.16.16.16.13.13.1" xref="S2.Ex2.m1.16.16.16.16.13.13.1.cmml">t</mi></msub></mrow></mrow></mtd></mtr><mtr id="S2.Ex2.m1.46.46.4d"><mtd class="ltx_align_right" columnalign="right" id="S2.Ex2.m1.46.46.4e"><mrow id="S2.Ex2.m1.19.19.19.3.3"><msub id="S2.Ex2.m1.19.19.19.3.3.4"><mi id="S2.Ex2.m1.17.17.17.1.1.1" xref="S2.Ex2.m1.17.17.17.1.1.1.cmml">v</mi><mi id="S2.Ex2.m1.18.18.18.2.2.2.1" xref="S2.Ex2.m1.18.18.18.2.2.2.1.cmml">t</mi></msub><mo stretchy="false" id="S2.Ex2.m1.19.19.19.3.3.3" xref="S2.Ex2.m1.19.19.19.3.3.3.cmml">←</mo><mi id="S2.Ex2.m1.19.19.19.3.3.5" xref="S2.Ex2.m1.43.43.1.1.1.cmml"></mi></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.Ex2.m1.46.46.4f"><mrow id="S2.Ex2.m1.45.45.3.44.18.15"><mrow id="S2.Ex2.m1.45.45.3.44.18.15.16"><msub id="S2.Ex2.m1.45.45.3.44.18.15.16.2"><mi id="S2.Ex2.m1.20.20.20.4.1.1" xref="S2.Ex2.m1.20.20.20.4.1.1.cmml">β</mi><mn id="S2.Ex2.m1.21.21.21.5.2.2.1" xref="S2.Ex2.m1.21.21.21.5.2.2.1.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S2.Ex2.m1.45.45.3.44.18.15.16.1" xref="S2.Ex2.m1.43.43.1.1.1.cmml">​</mo><msub id="S2.Ex2.m1.45.45.3.44.18.15.16.3"><mi id="S2.Ex2.m1.22.22.22.6.3.3" xref="S2.Ex2.m1.22.22.22.6.3.3.cmml">v</mi><mrow id="S2.Ex2.m1.23.23.23.7.4.4.1" xref="S2.Ex2.m1.23.23.23.7.4.4.1.cmml"><mi id="S2.Ex2.m1.23.23.23.7.4.4.1.2" xref="S2.Ex2.m1.23.23.23.7.4.4.1.2.cmml">t</mi><mo id="S2.Ex2.m1.23.23.23.7.4.4.1.1" xref="S2.Ex2.m1.23.23.23.7.4.4.1.1.cmml">−</mo><mn id="S2.Ex2.m1.23.23.23.7.4.4.1.3" xref="S2.Ex2.m1.23.23.23.7.4.4.1.3.cmml">1</mn></mrow></msub></mrow><mo id="S2.Ex2.m1.24.24.24.8.5.5" xref="S2.Ex2.m1.24.24.24.8.5.5.cmml">+</mo><mrow id="S2.Ex2.m1.45.45.3.44.18.15.15"><mrow id="S2.Ex2.m1.45.45.3.44.18.15.15.1.1"><mo stretchy="false" id="S2.Ex2.m1.25.25.25.9.6.6" xref="S2.Ex2.m1.43.43.1.1.1.cmml">(</mo><mrow id="S2.Ex2.m1.45.45.3.44.18.15.15.1.1.1"><mn id="S2.Ex2.m1.26.26.26.10.7.7" xref="S2.Ex2.m1.26.26.26.10.7.7.cmml">1</mn><mo id="S2.Ex2.m1.27.27.27.11.8.8" xref="S2.Ex2.m1.27.27.27.11.8.8.cmml">−</mo><msub id="S2.Ex2.m1.45.45.3.44.18.15.15.1.1.1.1"><mi id="S2.Ex2.m1.28.28.28.12.9.9" xref="S2.Ex2.m1.28.28.28.12.9.9.cmml">β</mi><mn id="S2.Ex2.m1.29.29.29.13.10.10.1" xref="S2.Ex2.m1.29.29.29.13.10.10.1.cmml">2</mn></msub></mrow><mo stretchy="false" id="S2.Ex2.m1.30.30.30.14.11.11" xref="S2.Ex2.m1.43.43.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.Ex2.m1.45.45.3.44.18.15.15.2" xref="S2.Ex2.m1.43.43.1.1.1.cmml">​</mo><msubsup id="S2.Ex2.m1.45.45.3.44.18.15.15.3"><mi id="S2.Ex2.m1.31.31.31.15.12.12" xref="S2.Ex2.m1.31.31.31.15.12.12.cmml">g</mi><mi id="S2.Ex2.m1.32.32.32.16.13.13.1" xref="S2.Ex2.m1.32.32.32.16.13.13.1.cmml">t</mi><mn id="S2.Ex2.m1.33.33.33.17.14.14.1" xref="S2.Ex2.m1.33.33.33.17.14.14.1.cmml">2</mn></msubsup></mrow></mrow></mtd></mtr><mtr id="S2.Ex2.m1.46.46.4g"><mtd class="ltx_align_right" columnalign="right" id="S2.Ex2.m1.46.46.4h"><mrow id="S2.Ex2.m1.36.36.36.3.3"><msub id="S2.Ex2.m1.36.36.36.3.3.4"><mi id="S2.Ex2.m1.34.34.34.1.1.1" xref="S2.Ex2.m1.34.34.34.1.1.1.cmml">w</mi><mrow id="S2.Ex2.m1.35.35.35.2.2.2.1" xref="S2.Ex2.m1.35.35.35.2.2.2.1.cmml"><mi id="S2.Ex2.m1.35.35.35.2.2.2.1.2" xref="S2.Ex2.m1.35.35.35.2.2.2.1.2.cmml">t</mi><mo id="S2.Ex2.m1.35.35.35.2.2.2.1.1" xref="S2.Ex2.m1.35.35.35.2.2.2.1.1.cmml">+</mo><mn id="S2.Ex2.m1.35.35.35.2.2.2.1.3" xref="S2.Ex2.m1.35.35.35.2.2.2.1.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S2.Ex2.m1.36.36.36.3.3.3" xref="S2.Ex2.m1.36.36.36.3.3.3.cmml">←</mo><mi id="S2.Ex2.m1.36.36.36.3.3.5" xref="S2.Ex2.m1.43.43.1.1.1.cmml"></mi></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.Ex2.m1.46.46.4i"><mrow id="S2.Ex2.m1.46.46.4.45.10.7.7"><mrow id="S2.Ex2.m1.46.46.4.45.10.7.7.1"><msub id="S2.Ex2.m1.46.46.4.45.10.7.7.1.1"><mi id="S2.Ex2.m1.37.37.37.4.1.1" xref="S2.Ex2.m1.37.37.37.4.1.1.cmml">w</mi><mi id="S2.Ex2.m1.38.38.38.5.2.2.1" xref="S2.Ex2.m1.38.38.38.5.2.2.1.cmml">t</mi></msub><mo id="S2.Ex2.m1.39.39.39.6.3.3" xref="S2.Ex2.m1.39.39.39.6.3.3.cmml">+</mo><mrow id="S2.Ex2.m1.46.46.4.45.10.7.7.1.2"><mi id="S2.Ex2.m1.40.40.40.7.4.4" xref="S2.Ex2.m1.40.40.40.7.4.4.cmml">η</mi><mo lspace="0em" rspace="0em" id="S2.Ex2.m1.46.46.4.45.10.7.7.1.2.1" xref="S2.Ex2.m1.43.43.1.1.1.cmml">​</mo><mfrac id="S2.Ex2.m1.41.41.41.8.5.5" xref="S2.Ex2.m1.41.41.41.8.5.5.cmml"><msub id="S2.Ex2.m1.41.41.41.8.5.5.2" xref="S2.Ex2.m1.41.41.41.8.5.5.2.cmml"><mi id="S2.Ex2.m1.41.41.41.8.5.5.2.2" xref="S2.Ex2.m1.41.41.41.8.5.5.2.2.cmml">m</mi><mi id="S2.Ex2.m1.41.41.41.8.5.5.2.3" xref="S2.Ex2.m1.41.41.41.8.5.5.2.3.cmml">t</mi></msub><mrow id="S2.Ex2.m1.41.41.41.8.5.5.3" xref="S2.Ex2.m1.41.41.41.8.5.5.3.cmml"><msqrt id="S2.Ex2.m1.41.41.41.8.5.5.3.2" xref="S2.Ex2.m1.41.41.41.8.5.5.3.2.cmml"><msub id="S2.Ex2.m1.41.41.41.8.5.5.3.2.2" xref="S2.Ex2.m1.41.41.41.8.5.5.3.2.2.cmml"><mi id="S2.Ex2.m1.41.41.41.8.5.5.3.2.2.2" xref="S2.Ex2.m1.41.41.41.8.5.5.3.2.2.2.cmml">v</mi><mi id="S2.Ex2.m1.41.41.41.8.5.5.3.2.2.3" xref="S2.Ex2.m1.41.41.41.8.5.5.3.2.2.3.cmml">t</mi></msub></msqrt><mo id="S2.Ex2.m1.41.41.41.8.5.5.3.1" xref="S2.Ex2.m1.41.41.41.8.5.5.3.1.cmml">+</mo><mi id="S2.Ex2.m1.41.41.41.8.5.5.3.3" xref="S2.Ex2.m1.41.41.41.8.5.5.3.3.cmml">τ</mi></mrow></mfrac></mrow></mrow><mo lspace="0em" id="S2.Ex2.m1.42.42.42.9.6.6" xref="S2.Ex2.m1.43.43.1.1.1.cmml">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S2.Ex2.m1.46b"><apply id="S2.Ex2.m1.43.43.1.1.1.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"><and id="S2.Ex2.m1.43.43.1.1.1a.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"></and><apply id="S2.Ex2.m1.43.43.1.1.1b.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"><ci id="S2.Ex2.m1.3.3.3.3.3.3.cmml" xref="S2.Ex2.m1.3.3.3.3.3.3">←</ci><apply id="S2.Ex2.m1.43.43.1.1.1.4.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S2.Ex2.m1.43.43.1.1.1.4.1.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S2.Ex2.m1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1">𝑚</ci><ci id="S2.Ex2.m1.2.2.2.2.2.2.1.cmml" xref="S2.Ex2.m1.2.2.2.2.2.2.1">𝑡</ci></apply><apply id="S2.Ex2.m1.43.43.1.1.1.1.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"><plus id="S2.Ex2.m1.8.8.8.8.5.5.cmml" xref="S2.Ex2.m1.8.8.8.8.5.5"></plus><apply id="S2.Ex2.m1.43.43.1.1.1.1.3.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"><times id="S2.Ex2.m1.43.43.1.1.1.1.3.1.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"></times><apply id="S2.Ex2.m1.43.43.1.1.1.1.3.2.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S2.Ex2.m1.43.43.1.1.1.1.3.2.1.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S2.Ex2.m1.4.4.4.4.1.1.cmml" xref="S2.Ex2.m1.4.4.4.4.1.1">𝛽</ci><cn type="integer" id="S2.Ex2.m1.5.5.5.5.2.2.1.cmml" xref="S2.Ex2.m1.5.5.5.5.2.2.1">1</cn></apply><apply id="S2.Ex2.m1.43.43.1.1.1.1.3.3.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S2.Ex2.m1.43.43.1.1.1.1.3.3.1.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S2.Ex2.m1.6.6.6.6.3.3.cmml" xref="S2.Ex2.m1.6.6.6.6.3.3">𝑚</ci><apply id="S2.Ex2.m1.7.7.7.7.4.4.1.cmml" xref="S2.Ex2.m1.7.7.7.7.4.4.1"><minus id="S2.Ex2.m1.7.7.7.7.4.4.1.1.cmml" xref="S2.Ex2.m1.7.7.7.7.4.4.1.1"></minus><ci id="S2.Ex2.m1.7.7.7.7.4.4.1.2.cmml" xref="S2.Ex2.m1.7.7.7.7.4.4.1.2">𝑡</ci><cn type="integer" id="S2.Ex2.m1.7.7.7.7.4.4.1.3.cmml" xref="S2.Ex2.m1.7.7.7.7.4.4.1.3">1</cn></apply></apply></apply><apply id="S2.Ex2.m1.43.43.1.1.1.1.1.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"><times id="S2.Ex2.m1.43.43.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"></times><apply id="S2.Ex2.m1.43.43.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"><minus id="S2.Ex2.m1.11.11.11.11.8.8.cmml" xref="S2.Ex2.m1.11.11.11.11.8.8"></minus><cn type="integer" id="S2.Ex2.m1.10.10.10.10.7.7.cmml" xref="S2.Ex2.m1.10.10.10.10.7.7">1</cn><apply id="S2.Ex2.m1.43.43.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S2.Ex2.m1.43.43.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S2.Ex2.m1.12.12.12.12.9.9.cmml" xref="S2.Ex2.m1.12.12.12.12.9.9">𝛽</ci><cn type="integer" id="S2.Ex2.m1.13.13.13.13.10.10.1.cmml" xref="S2.Ex2.m1.13.13.13.13.10.10.1">1</cn></apply></apply><apply id="S2.Ex2.m1.43.43.1.1.1.1.1.3.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S2.Ex2.m1.43.43.1.1.1.1.1.3.1.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S2.Ex2.m1.15.15.15.15.12.12.cmml" xref="S2.Ex2.m1.15.15.15.15.12.12">𝑔</ci><ci id="S2.Ex2.m1.16.16.16.16.13.13.1.cmml" xref="S2.Ex2.m1.16.16.16.16.13.13.1">𝑡</ci></apply><apply id="S2.Ex2.m1.43.43.1.1.1.1.1.4.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S2.Ex2.m1.43.43.1.1.1.1.1.4.1.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S2.Ex2.m1.17.17.17.1.1.1.cmml" xref="S2.Ex2.m1.17.17.17.1.1.1">𝑣</ci><ci id="S2.Ex2.m1.18.18.18.2.2.2.1.cmml" xref="S2.Ex2.m1.18.18.18.2.2.2.1">𝑡</ci></apply></apply></apply></apply><apply id="S2.Ex2.m1.43.43.1.1.1c.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"><ci id="S2.Ex2.m1.19.19.19.3.3.3.cmml" xref="S2.Ex2.m1.19.19.19.3.3.3">←</ci><share href="#S2.Ex2.m1.43.43.1.1.1.1.cmml" id="S2.Ex2.m1.43.43.1.1.1d.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"></share><apply id="S2.Ex2.m1.43.43.1.1.1.2.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"><plus id="S2.Ex2.m1.24.24.24.8.5.5.cmml" xref="S2.Ex2.m1.24.24.24.8.5.5"></plus><apply id="S2.Ex2.m1.43.43.1.1.1.2.3.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"><times id="S2.Ex2.m1.43.43.1.1.1.2.3.1.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"></times><apply id="S2.Ex2.m1.43.43.1.1.1.2.3.2.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S2.Ex2.m1.43.43.1.1.1.2.3.2.1.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S2.Ex2.m1.20.20.20.4.1.1.cmml" xref="S2.Ex2.m1.20.20.20.4.1.1">𝛽</ci><cn type="integer" id="S2.Ex2.m1.21.21.21.5.2.2.1.cmml" xref="S2.Ex2.m1.21.21.21.5.2.2.1">2</cn></apply><apply id="S2.Ex2.m1.43.43.1.1.1.2.3.3.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S2.Ex2.m1.43.43.1.1.1.2.3.3.1.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S2.Ex2.m1.22.22.22.6.3.3.cmml" xref="S2.Ex2.m1.22.22.22.6.3.3">𝑣</ci><apply id="S2.Ex2.m1.23.23.23.7.4.4.1.cmml" xref="S2.Ex2.m1.23.23.23.7.4.4.1"><minus id="S2.Ex2.m1.23.23.23.7.4.4.1.1.cmml" xref="S2.Ex2.m1.23.23.23.7.4.4.1.1"></minus><ci id="S2.Ex2.m1.23.23.23.7.4.4.1.2.cmml" xref="S2.Ex2.m1.23.23.23.7.4.4.1.2">𝑡</ci><cn type="integer" id="S2.Ex2.m1.23.23.23.7.4.4.1.3.cmml" xref="S2.Ex2.m1.23.23.23.7.4.4.1.3">1</cn></apply></apply></apply><apply id="S2.Ex2.m1.43.43.1.1.1.2.1.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"><times id="S2.Ex2.m1.43.43.1.1.1.2.1.2.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"></times><apply id="S2.Ex2.m1.43.43.1.1.1.2.1.1.1.1.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"><minus id="S2.Ex2.m1.27.27.27.11.8.8.cmml" xref="S2.Ex2.m1.27.27.27.11.8.8"></minus><cn type="integer" id="S2.Ex2.m1.26.26.26.10.7.7.cmml" xref="S2.Ex2.m1.26.26.26.10.7.7">1</cn><apply id="S2.Ex2.m1.43.43.1.1.1.2.1.1.1.1.3.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S2.Ex2.m1.43.43.1.1.1.2.1.1.1.1.3.1.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S2.Ex2.m1.28.28.28.12.9.9.cmml" xref="S2.Ex2.m1.28.28.28.12.9.9">𝛽</ci><cn type="integer" id="S2.Ex2.m1.29.29.29.13.10.10.1.cmml" xref="S2.Ex2.m1.29.29.29.13.10.10.1">2</cn></apply></apply><apply id="S2.Ex2.m1.43.43.1.1.1.2.1.3.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S2.Ex2.m1.43.43.1.1.1.2.1.3.1.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5">superscript</csymbol><apply id="S2.Ex2.m1.43.43.1.1.1.2.1.3.2.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S2.Ex2.m1.43.43.1.1.1.2.1.3.2.1.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S2.Ex2.m1.31.31.31.15.12.12.cmml" xref="S2.Ex2.m1.31.31.31.15.12.12">𝑔</ci><ci id="S2.Ex2.m1.32.32.32.16.13.13.1.cmml" xref="S2.Ex2.m1.32.32.32.16.13.13.1">𝑡</ci></apply><cn type="integer" id="S2.Ex2.m1.33.33.33.17.14.14.1.cmml" xref="S2.Ex2.m1.33.33.33.17.14.14.1">2</cn></apply><apply id="S2.Ex2.m1.43.43.1.1.1.2.1.4.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S2.Ex2.m1.43.43.1.1.1.2.1.4.1.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S2.Ex2.m1.34.34.34.1.1.1.cmml" xref="S2.Ex2.m1.34.34.34.1.1.1">𝑤</ci><apply id="S2.Ex2.m1.35.35.35.2.2.2.1.cmml" xref="S2.Ex2.m1.35.35.35.2.2.2.1"><plus id="S2.Ex2.m1.35.35.35.2.2.2.1.1.cmml" xref="S2.Ex2.m1.35.35.35.2.2.2.1.1"></plus><ci id="S2.Ex2.m1.35.35.35.2.2.2.1.2.cmml" xref="S2.Ex2.m1.35.35.35.2.2.2.1.2">𝑡</ci><cn type="integer" id="S2.Ex2.m1.35.35.35.2.2.2.1.3.cmml" xref="S2.Ex2.m1.35.35.35.2.2.2.1.3">1</cn></apply></apply></apply></apply></apply><apply id="S2.Ex2.m1.43.43.1.1.1e.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"><ci id="S2.Ex2.m1.36.36.36.3.3.3.cmml" xref="S2.Ex2.m1.36.36.36.3.3.3">←</ci><share href="#S2.Ex2.m1.43.43.1.1.1.2.cmml" id="S2.Ex2.m1.43.43.1.1.1f.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"></share><apply id="S2.Ex2.m1.43.43.1.1.1.8.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"><plus id="S2.Ex2.m1.39.39.39.6.3.3.cmml" xref="S2.Ex2.m1.39.39.39.6.3.3"></plus><apply id="S2.Ex2.m1.43.43.1.1.1.8.2.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S2.Ex2.m1.43.43.1.1.1.8.2.1.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S2.Ex2.m1.37.37.37.4.1.1.cmml" xref="S2.Ex2.m1.37.37.37.4.1.1">𝑤</ci><ci id="S2.Ex2.m1.38.38.38.5.2.2.1.cmml" xref="S2.Ex2.m1.38.38.38.5.2.2.1">𝑡</ci></apply><apply id="S2.Ex2.m1.43.43.1.1.1.8.3.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"><times id="S2.Ex2.m1.43.43.1.1.1.8.3.1.cmml" xref="S2.Ex2.m1.3.3.3.3.3.5"></times><ci id="S2.Ex2.m1.40.40.40.7.4.4.cmml" xref="S2.Ex2.m1.40.40.40.7.4.4">𝜂</ci><apply id="S2.Ex2.m1.41.41.41.8.5.5.cmml" xref="S2.Ex2.m1.41.41.41.8.5.5"><divide id="S2.Ex2.m1.41.41.41.8.5.5.1.cmml" xref="S2.Ex2.m1.41.41.41.8.5.5"></divide><apply id="S2.Ex2.m1.41.41.41.8.5.5.2.cmml" xref="S2.Ex2.m1.41.41.41.8.5.5.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.41.41.41.8.5.5.2.1.cmml" xref="S2.Ex2.m1.41.41.41.8.5.5.2">subscript</csymbol><ci id="S2.Ex2.m1.41.41.41.8.5.5.2.2.cmml" xref="S2.Ex2.m1.41.41.41.8.5.5.2.2">𝑚</ci><ci id="S2.Ex2.m1.41.41.41.8.5.5.2.3.cmml" xref="S2.Ex2.m1.41.41.41.8.5.5.2.3">𝑡</ci></apply><apply id="S2.Ex2.m1.41.41.41.8.5.5.3.cmml" xref="S2.Ex2.m1.41.41.41.8.5.5.3"><plus id="S2.Ex2.m1.41.41.41.8.5.5.3.1.cmml" xref="S2.Ex2.m1.41.41.41.8.5.5.3.1"></plus><apply id="S2.Ex2.m1.41.41.41.8.5.5.3.2.cmml" xref="S2.Ex2.m1.41.41.41.8.5.5.3.2"><root id="S2.Ex2.m1.41.41.41.8.5.5.3.2a.cmml" xref="S2.Ex2.m1.41.41.41.8.5.5.3.2"></root><apply id="S2.Ex2.m1.41.41.41.8.5.5.3.2.2.cmml" xref="S2.Ex2.m1.41.41.41.8.5.5.3.2.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.41.41.41.8.5.5.3.2.2.1.cmml" xref="S2.Ex2.m1.41.41.41.8.5.5.3.2.2">subscript</csymbol><ci id="S2.Ex2.m1.41.41.41.8.5.5.3.2.2.2.cmml" xref="S2.Ex2.m1.41.41.41.8.5.5.3.2.2.2">𝑣</ci><ci id="S2.Ex2.m1.41.41.41.8.5.5.3.2.2.3.cmml" xref="S2.Ex2.m1.41.41.41.8.5.5.3.2.2.3">𝑡</ci></apply></apply><ci id="S2.Ex2.m1.41.41.41.8.5.5.3.3.cmml" xref="S2.Ex2.m1.41.41.41.8.5.5.3.3">𝜏</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex2.m1.46c">\begin{split}m_{t}\leftarrow&amp;\beta_{1}m_{t-1}+(1-\beta_{1})g_{t}\\
v_{t}\leftarrow&amp;\beta_{2}v_{t-1}+(1-\beta_{2})g_{t}^{2}\\
w_{t+1}\leftarrow&amp;w_{t}+\eta\frac{m_{t}}{\sqrt{v_{t}}+\tau}.\\
\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">Basic federated learning methods make an essential assumption that all clients have sufficient local resources to train models with the same architecture.
However, weak clients cannot even compute over the global model when local hardware is constrained.
Previous works <cite class="ltx_cite ltx_citemacro_citep">(Li and Wang, <a href="#bib.bib21" title="" class="ltx_ref">2019</a>; Chang et al<span class="ltx_text">.</span>, <a href="#bib.bib6" title="" class="ltx_ref">2019</a>)</cite> provide solutions for federated learning with heterogeneous local models based on knowledge distillation<cite class="ltx_cite ltx_citemacro_citep">(Hinton et al<span class="ltx_text">.</span>, <a href="#bib.bib16" title="" class="ltx_ref">2015</a>)</cite>.
A server student model is updated by distilling from the ensemble of predictions <cite class="ltx_cite ltx_citemacro_citep">(Lin et al<span class="ltx_text">.</span>, <a href="#bib.bib22" title="" class="ltx_ref">2020b</a>)</cite>.
Alternatively, local models are optimized sequentially <cite class="ltx_cite ltx_citemacro_citep">(Li and Wang, <a href="#bib.bib21" title="" class="ltx_ref">2019</a>)</cite> or jointly <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a href="#bib.bib6" title="" class="ltx_ref">2019</a>)</cite> over the augmented dataset and the local private dataset.
However, it is hard to guarantee the domain and quality of the public data.
And it is impractical for weak clients with limited hardware to store the public dataset.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.3" class="ltx_p">Recently, <span id="S2.p3.3.1" class="ltx_text ltx_font_italic">HeteroFL</span> <cite class="ltx_cite ltx_citemacro_citep">(Diao et al<span class="ltx_text">.</span>, <a href="#bib.bib8" title="" class="ltx_ref">2021</a>)</cite> removes this assumption and conduct parameter-averaging over heterogeneous models.
Authors scale model architectures for clients with variant local resources with variant widths.
For each matrix <math id="S2.p3.1.m1.1" class="ltx_Math" alttext="W\in\mathbb{R}^{d_{g}\times k_{g}}" display="inline"><semantics id="S2.p3.1.m1.1a"><mrow id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml"><mi id="S2.p3.1.m1.1.1.2" xref="S2.p3.1.m1.1.1.2.cmml">W</mi><mo id="S2.p3.1.m1.1.1.1" xref="S2.p3.1.m1.1.1.1.cmml">∈</mo><msup id="S2.p3.1.m1.1.1.3" xref="S2.p3.1.m1.1.1.3.cmml"><mi id="S2.p3.1.m1.1.1.3.2" xref="S2.p3.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.p3.1.m1.1.1.3.3" xref="S2.p3.1.m1.1.1.3.3.cmml"><msub id="S2.p3.1.m1.1.1.3.3.2" xref="S2.p3.1.m1.1.1.3.3.2.cmml"><mi id="S2.p3.1.m1.1.1.3.3.2.2" xref="S2.p3.1.m1.1.1.3.3.2.2.cmml">d</mi><mi id="S2.p3.1.m1.1.1.3.3.2.3" xref="S2.p3.1.m1.1.1.3.3.2.3.cmml">g</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S2.p3.1.m1.1.1.3.3.1" xref="S2.p3.1.m1.1.1.3.3.1.cmml">×</mo><msub id="S2.p3.1.m1.1.1.3.3.3" xref="S2.p3.1.m1.1.1.3.3.3.cmml"><mi id="S2.p3.1.m1.1.1.3.3.3.2" xref="S2.p3.1.m1.1.1.3.3.3.2.cmml">k</mi><mi id="S2.p3.1.m1.1.1.3.3.3.3" xref="S2.p3.1.m1.1.1.3.3.3.3.cmml">g</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><apply id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1"><in id="S2.p3.1.m1.1.1.1.cmml" xref="S2.p3.1.m1.1.1.1"></in><ci id="S2.p3.1.m1.1.1.2.cmml" xref="S2.p3.1.m1.1.1.2">𝑊</ci><apply id="S2.p3.1.m1.1.1.3.cmml" xref="S2.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.p3.1.m1.1.1.3.1.cmml" xref="S2.p3.1.m1.1.1.3">superscript</csymbol><ci id="S2.p3.1.m1.1.1.3.2.cmml" xref="S2.p3.1.m1.1.1.3.2">ℝ</ci><apply id="S2.p3.1.m1.1.1.3.3.cmml" xref="S2.p3.1.m1.1.1.3.3"><times id="S2.p3.1.m1.1.1.3.3.1.cmml" xref="S2.p3.1.m1.1.1.3.3.1"></times><apply id="S2.p3.1.m1.1.1.3.3.2.cmml" xref="S2.p3.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.p3.1.m1.1.1.3.3.2.1.cmml" xref="S2.p3.1.m1.1.1.3.3.2">subscript</csymbol><ci id="S2.p3.1.m1.1.1.3.3.2.2.cmml" xref="S2.p3.1.m1.1.1.3.3.2.2">𝑑</ci><ci id="S2.p3.1.m1.1.1.3.3.2.3.cmml" xref="S2.p3.1.m1.1.1.3.3.2.3">𝑔</ci></apply><apply id="S2.p3.1.m1.1.1.3.3.3.cmml" xref="S2.p3.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.p3.1.m1.1.1.3.3.3.1.cmml" xref="S2.p3.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S2.p3.1.m1.1.1.3.3.3.2.cmml" xref="S2.p3.1.m1.1.1.3.3.3.2">𝑘</ci><ci id="S2.p3.1.m1.1.1.3.3.3.3.cmml" xref="S2.p3.1.m1.1.1.3.3.3.3">𝑔</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">W\in\mathbb{R}^{d_{g}\times k_{g}}</annotation></semantics></math> in the large model, they reduce the parameters for a smaller model as the upper left sub-matrix <math id="S2.p3.2.m2.1" class="ltx_math_unparsed" alttext="W_{s}=W[:d_{s},:k_{s}]" display="inline"><semantics id="S2.p3.2.m2.1a"><mrow id="S2.p3.2.m2.1b"><msub id="S2.p3.2.m2.1.1"><mi id="S2.p3.2.m2.1.1.2">W</mi><mi id="S2.p3.2.m2.1.1.3">s</mi></msub><mo id="S2.p3.2.m2.1.2">=</mo><mi id="S2.p3.2.m2.1.3">W</mi><mrow id="S2.p3.2.m2.1.4"><mo stretchy="false" id="S2.p3.2.m2.1.4.1">[</mo><mo rspace="0.278em" id="S2.p3.2.m2.1.4.2">:</mo><msub id="S2.p3.2.m2.1.4.3"><mi id="S2.p3.2.m2.1.4.3.2">d</mi><mi id="S2.p3.2.m2.1.4.3.3">s</mi></msub><mo id="S2.p3.2.m2.1.4.4">,</mo><mo rspace="0.278em" id="S2.p3.2.m2.1.4.5">:</mo><msub id="S2.p3.2.m2.1.4.6"><mi id="S2.p3.2.m2.1.4.6.2">k</mi><mi id="S2.p3.2.m2.1.4.6.3">s</mi></msub><mo stretchy="false" id="S2.p3.2.m2.1.4.7">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S2.p3.2.m2.1c">W_{s}=W[:d_{s},:k_{s}]</annotation></semantics></math> with size <math id="S2.p3.3.m3.1" class="ltx_Math" alttext="d_{s}\times k_{s}" display="inline"><semantics id="S2.p3.3.m3.1a"><mrow id="S2.p3.3.m3.1.1" xref="S2.p3.3.m3.1.1.cmml"><msub id="S2.p3.3.m3.1.1.2" xref="S2.p3.3.m3.1.1.2.cmml"><mi id="S2.p3.3.m3.1.1.2.2" xref="S2.p3.3.m3.1.1.2.2.cmml">d</mi><mi id="S2.p3.3.m3.1.1.2.3" xref="S2.p3.3.m3.1.1.2.3.cmml">s</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S2.p3.3.m3.1.1.1" xref="S2.p3.3.m3.1.1.1.cmml">×</mo><msub id="S2.p3.3.m3.1.1.3" xref="S2.p3.3.m3.1.1.3.cmml"><mi id="S2.p3.3.m3.1.1.3.2" xref="S2.p3.3.m3.1.1.3.2.cmml">k</mi><mi id="S2.p3.3.m3.1.1.3.3" xref="S2.p3.3.m3.1.1.3.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.3.m3.1b"><apply id="S2.p3.3.m3.1.1.cmml" xref="S2.p3.3.m3.1.1"><times id="S2.p3.3.m3.1.1.1.cmml" xref="S2.p3.3.m3.1.1.1"></times><apply id="S2.p3.3.m3.1.1.2.cmml" xref="S2.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S2.p3.3.m3.1.1.2.1.cmml" xref="S2.p3.3.m3.1.1.2">subscript</csymbol><ci id="S2.p3.3.m3.1.1.2.2.cmml" xref="S2.p3.3.m3.1.1.2.2">𝑑</ci><ci id="S2.p3.3.m3.1.1.2.3.cmml" xref="S2.p3.3.m3.1.1.2.3">𝑠</ci></apply><apply id="S2.p3.3.m3.1.1.3.cmml" xref="S2.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.p3.3.m3.1.1.3.1.cmml" xref="S2.p3.3.m3.1.1.3">subscript</csymbol><ci id="S2.p3.3.m3.1.1.3.2.cmml" xref="S2.p3.3.m3.1.1.3.2">𝑘</ci><ci id="S2.p3.3.m3.1.1.3.3.cmml" xref="S2.p3.3.m3.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.3.m3.1c">d_{s}\times k_{s}</annotation></semantics></math>.
To exchange knowledge, heterogeneous models share the overlapped matrix with a parameter averaging.
However, <span id="S2.p3.3.2" class="ltx_text ltx_font_italic">HeteroFL</span> has limitations of a biased initial pruning and parameter mismatch across heterogeneous models.
Instead, we reduce number of layers for small models and propose methods to solve these problems.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">Other related works that consider weak capabilities include solutions to reduce the communicational cost <cite class="ltx_cite ltx_citemacro_citep">(Li and Wang, <a href="#bib.bib21" title="" class="ltx_ref">2019</a>; Sattler et al<span class="ltx_text">.</span>, <a href="#bib.bib34" title="" class="ltx_ref">2019</a>)</cite>.
Several works aim to mitigate the up-link communication bottlenecks from client to server<cite class="ltx_cite ltx_citemacro_citep">(Lin et al<span class="ltx_text">.</span>, <a href="#bib.bib23" title="" class="ltx_ref">2020a</a>; Wangni et al<span class="ltx_text">.</span>, <a href="#bib.bib41" title="" class="ltx_ref">2018</a>; Dutta et al<span class="ltx_text">.</span>, <a href="#bib.bib11" title="" class="ltx_ref">2020</a>; Konečnỳ et al<span class="ltx_text">.</span>, <a href="#bib.bib20" title="" class="ltx_ref">2016</a>; Wang et al<span class="ltx_text">.</span>, <a href="#bib.bib40" title="" class="ltx_ref">2018a</a>)</cite>.
Local model updates can be sparsified, quantized or randomly sub-sampled before uploading to the central server.
<cite class="ltx_cite ltx_citemacro_citet">Konečnỳ et al<span class="ltx_text">.</span> (<a href="#bib.bib20" title="" class="ltx_ref">2016</a>)</cite> performs a lossy compression on the model updates and reduces the error incurred by the subsequent quantization with the randomized Hadamard transform.
To reduce the server-to-client communication, <cite class="ltx_cite ltx_citemacro_citet">Caldas et al<span class="ltx_text">.</span> (<a href="#bib.bib4" title="" class="ltx_ref">2018</a>)</cite> extends the idea of dropout <cite class="ltx_cite ltx_citemacro_citep">(Srivastava et al<span class="ltx_text">.</span>, <a href="#bib.bib36" title="" class="ltx_ref">2014</a>)</cite> and drops a fixed number of activation units at each full-connected layer before distributing a local model to each client.
<cite class="ltx_cite ltx_citemacro_citet">Bouacida et al<span class="ltx_text">.</span> (<a href="#bib.bib3" title="" class="ltx_ref">2021</a>)</cite> adopts an adaptive strategy and selects the dropped activation based on the activation score map.
It should be noted that local optimization is conducted on decompressed models.
Also, above works do not consider federated training over heterogeneous models and are compatible to our solution when aggregating local models with the same architecture in <span id="S2.p4.1.1" class="ltx_text ltx_font_italic">InclusiveFL</span>.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Methodology</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this section, we introduce our solution <span id="S3.p1.1.1" class="ltx_text ltx_font_italic">InclusiveFL</span>, which trains a global model across client devices with heterogeneous capabilities.
We will first introduce the layer-wise heterogeneous aggregation framework in <span id="S3.p1.1.2" class="ltx_text ltx_font_italic">InclusiveFL</span>, and then introduce details of our proposed momentum distillation in federated learning for more effective knowledge exchange in the heterogeneous setting.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2202.08036/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="332" height="194" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.3.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>. </span><span id="S3.F2.4.2" class="ltx_text" style="font-size:90%;">Overview of <span id="S3.F2.4.2.1" class="ltx_text ltx_font_italic">InclusiveFL</span>.</span></figcaption>
</figure>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Layer-wise Heterogeneous Aggregation Framework</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.7" class="ltx_p">The overview of <span id="S3.SS1.p1.7.1" class="ltx_text ltx_font_italic">InclusiveFL</span> framework is shown in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3. Methodology ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
Without loss of generality, we denote three groups that hold different device capabilities as weak, medium, and strong clients.
Our core idea is to assign models of different sizes to clients with different computing capabilities, bigger models for strong clients and smaller models for weak clients.
We reduce the number of parameters for weaker clients by decreasing the depth of network.
Since the bottom layers are most critical for retraining the pre-trained knowledge <cite class="ltx_cite ltx_citemacro_citep">(Sajjad et al<span class="ltx_text">.</span>, <a href="#bib.bib33" title="" class="ltx_ref">2020</a>)</cite>, the sub-model with pre-trained bottom layers would benefit from the pre-trained parameters, which results in better initialization for small models.
Accordingly, the clients in weak, medium or strong client groups own small, medium or a large local models with <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="L_{a}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">L</mi><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝐿</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">L_{a}</annotation></semantics></math>, <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="L_{b}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">L</mi><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝐿</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">L_{b}</annotation></semantics></math>, <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="L_{c}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">L</mi><mi id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝐿</ci><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">L_{c}</annotation></semantics></math> layers, where <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="L_{a}&lt;L_{b}&lt;L_{c}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><mrow id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><msub id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2.2" xref="S3.SS1.p1.4.m4.1.1.2.2.cmml">L</mi><mi id="S3.SS1.p1.4.m4.1.1.2.3" xref="S3.SS1.p1.4.m4.1.1.2.3.cmml">a</mi></msub><mo id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">&lt;</mo><msub id="S3.SS1.p1.4.m4.1.1.4" xref="S3.SS1.p1.4.m4.1.1.4.cmml"><mi id="S3.SS1.p1.4.m4.1.1.4.2" xref="S3.SS1.p1.4.m4.1.1.4.2.cmml">L</mi><mi id="S3.SS1.p1.4.m4.1.1.4.3" xref="S3.SS1.p1.4.m4.1.1.4.3.cmml">b</mi></msub><mo id="S3.SS1.p1.4.m4.1.1.5" xref="S3.SS1.p1.4.m4.1.1.5.cmml">&lt;</mo><msub id="S3.SS1.p1.4.m4.1.1.6" xref="S3.SS1.p1.4.m4.1.1.6.cmml"><mi id="S3.SS1.p1.4.m4.1.1.6.2" xref="S3.SS1.p1.4.m4.1.1.6.2.cmml">L</mi><mi id="S3.SS1.p1.4.m4.1.1.6.3" xref="S3.SS1.p1.4.m4.1.1.6.3.cmml">c</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><and id="S3.SS1.p1.4.m4.1.1a.cmml" xref="S3.SS1.p1.4.m4.1.1"></and><apply id="S3.SS1.p1.4.m4.1.1b.cmml" xref="S3.SS1.p1.4.m4.1.1"><lt id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3"></lt><apply id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.2.1.cmml" xref="S3.SS1.p1.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2.2">𝐿</ci><ci id="S3.SS1.p1.4.m4.1.1.2.3.cmml" xref="S3.SS1.p1.4.m4.1.1.2.3">𝑎</ci></apply><apply id="S3.SS1.p1.4.m4.1.1.4.cmml" xref="S3.SS1.p1.4.m4.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.4.1.cmml" xref="S3.SS1.p1.4.m4.1.1.4">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.4.2.cmml" xref="S3.SS1.p1.4.m4.1.1.4.2">𝐿</ci><ci id="S3.SS1.p1.4.m4.1.1.4.3.cmml" xref="S3.SS1.p1.4.m4.1.1.4.3">𝑏</ci></apply></apply><apply id="S3.SS1.p1.4.m4.1.1c.cmml" xref="S3.SS1.p1.4.m4.1.1"><lt id="S3.SS1.p1.4.m4.1.1.5.cmml" xref="S3.SS1.p1.4.m4.1.1.5"></lt><share href="#S3.SS1.p1.4.m4.1.1.4.cmml" id="S3.SS1.p1.4.m4.1.1d.cmml" xref="S3.SS1.p1.4.m4.1.1"></share><apply id="S3.SS1.p1.4.m4.1.1.6.cmml" xref="S3.SS1.p1.4.m4.1.1.6"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.6.1.cmml" xref="S3.SS1.p1.4.m4.1.1.6">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.6.2.cmml" xref="S3.SS1.p1.4.m4.1.1.6.2">𝐿</ci><ci id="S3.SS1.p1.4.m4.1.1.6.3.cmml" xref="S3.SS1.p1.4.m4.1.1.6.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">L_{a}&lt;L_{b}&lt;L_{c}</annotation></semantics></math>.
In general, we conduct a homomorphic aggregation within the same client group and denote the aggregated model as the sub-global models <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="w^{a}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><msup id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">w</mi><mi id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml">a</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">superscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝑤</ci><ci id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">w^{a}</annotation></semantics></math>, <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="w^{b}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><msup id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">w</mi><mi id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">b</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">superscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝑤</ci><ci id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">w^{b}</annotation></semantics></math>, and <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="w^{c}" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><msup id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><mi id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml">w</mi><mi id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml">c</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">superscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2">𝑤</ci><ci id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">w^{c}</annotation></semantics></math>.
Then we run a heterogeneous aggregation across different client groups to update all sub-global models.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span id="alg1.6.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Framework of <span id="alg1.7.2" class="ltx_text ltx_font_italic">InclusiveFL</span>.</figcaption>
<div id="alg1.8" class="ltx_listing ltx_listing">
<div id="alg1.l0" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l0.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span><span id="alg1.l0.2" class="ltx_text" style="font-size:90%;">  </span>
</div>
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg1.l1.2" class="ltx_text" style="font-size:90%;">  Initialize </span><math id="alg1.l1.m1.2" class="ltx_Math" alttext="\theta_{0}^{c},f_{0}^{a},f_{0}^{b},f_{0}^{c},m_{0}^{b}\leftarrow 0,m_{0}^{c}\leftarrow 0" display="inline"><semantics id="alg1.l1.m1.2a"><mrow id="alg1.l1.m1.2.2.2" xref="alg1.l1.m1.2.2.3.cmml"><mrow id="alg1.l1.m1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.cmml"><mrow id="alg1.l1.m1.1.1.1.1.5.5" xref="alg1.l1.m1.1.1.1.1.5.6.cmml"><msubsup id="alg1.l1.m1.1.1.1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l1.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l1.m1.1.1.1.1.1.1.1.2.2.cmml">θ</mi><mn mathsize="90%" id="alg1.l1.m1.1.1.1.1.1.1.1.2.3" xref="alg1.l1.m1.1.1.1.1.1.1.1.2.3.cmml">0</mn><mi mathsize="90%" id="alg1.l1.m1.1.1.1.1.1.1.1.3" xref="alg1.l1.m1.1.1.1.1.1.1.1.3.cmml">c</mi></msubsup><mo mathsize="90%" id="alg1.l1.m1.1.1.1.1.5.5.6" xref="alg1.l1.m1.1.1.1.1.5.6.cmml">,</mo><msubsup id="alg1.l1.m1.1.1.1.1.2.2.2" xref="alg1.l1.m1.1.1.1.1.2.2.2.cmml"><mi mathsize="90%" id="alg1.l1.m1.1.1.1.1.2.2.2.2.2" xref="alg1.l1.m1.1.1.1.1.2.2.2.2.2.cmml">f</mi><mn mathsize="90%" id="alg1.l1.m1.1.1.1.1.2.2.2.2.3" xref="alg1.l1.m1.1.1.1.1.2.2.2.2.3.cmml">0</mn><mi mathsize="90%" id="alg1.l1.m1.1.1.1.1.2.2.2.3" xref="alg1.l1.m1.1.1.1.1.2.2.2.3.cmml">a</mi></msubsup><mo mathsize="90%" id="alg1.l1.m1.1.1.1.1.5.5.7" xref="alg1.l1.m1.1.1.1.1.5.6.cmml">,</mo><msubsup id="alg1.l1.m1.1.1.1.1.3.3.3" xref="alg1.l1.m1.1.1.1.1.3.3.3.cmml"><mi mathsize="90%" id="alg1.l1.m1.1.1.1.1.3.3.3.2.2" xref="alg1.l1.m1.1.1.1.1.3.3.3.2.2.cmml">f</mi><mn mathsize="90%" id="alg1.l1.m1.1.1.1.1.3.3.3.2.3" xref="alg1.l1.m1.1.1.1.1.3.3.3.2.3.cmml">0</mn><mi mathsize="90%" id="alg1.l1.m1.1.1.1.1.3.3.3.3" xref="alg1.l1.m1.1.1.1.1.3.3.3.3.cmml">b</mi></msubsup><mo mathsize="90%" id="alg1.l1.m1.1.1.1.1.5.5.8" xref="alg1.l1.m1.1.1.1.1.5.6.cmml">,</mo><msubsup id="alg1.l1.m1.1.1.1.1.4.4.4" xref="alg1.l1.m1.1.1.1.1.4.4.4.cmml"><mi mathsize="90%" id="alg1.l1.m1.1.1.1.1.4.4.4.2.2" xref="alg1.l1.m1.1.1.1.1.4.4.4.2.2.cmml">f</mi><mn mathsize="90%" id="alg1.l1.m1.1.1.1.1.4.4.4.2.3" xref="alg1.l1.m1.1.1.1.1.4.4.4.2.3.cmml">0</mn><mi mathsize="90%" id="alg1.l1.m1.1.1.1.1.4.4.4.3" xref="alg1.l1.m1.1.1.1.1.4.4.4.3.cmml">c</mi></msubsup><mo mathsize="90%" id="alg1.l1.m1.1.1.1.1.5.5.9" xref="alg1.l1.m1.1.1.1.1.5.6.cmml">,</mo><msubsup id="alg1.l1.m1.1.1.1.1.5.5.5" xref="alg1.l1.m1.1.1.1.1.5.5.5.cmml"><mi mathsize="90%" id="alg1.l1.m1.1.1.1.1.5.5.5.2.2" xref="alg1.l1.m1.1.1.1.1.5.5.5.2.2.cmml">m</mi><mn mathsize="90%" id="alg1.l1.m1.1.1.1.1.5.5.5.2.3" xref="alg1.l1.m1.1.1.1.1.5.5.5.2.3.cmml">0</mn><mi mathsize="90%" id="alg1.l1.m1.1.1.1.1.5.5.5.3" xref="alg1.l1.m1.1.1.1.1.5.5.5.3.cmml">b</mi></msubsup></mrow><mo mathsize="90%" stretchy="false" id="alg1.l1.m1.1.1.1.1.6" xref="alg1.l1.m1.1.1.1.1.6.cmml">←</mo><mn mathsize="90%" id="alg1.l1.m1.1.1.1.1.7" xref="alg1.l1.m1.1.1.1.1.7.cmml">0</mn></mrow><mo mathsize="90%" id="alg1.l1.m1.2.2.2.3" xref="alg1.l1.m1.2.2.3a.cmml">,</mo><mrow id="alg1.l1.m1.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.cmml"><msubsup id="alg1.l1.m1.2.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.2.cmml"><mi mathsize="90%" id="alg1.l1.m1.2.2.2.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.2.2.2.cmml">m</mi><mn mathsize="90%" id="alg1.l1.m1.2.2.2.2.2.2.3" xref="alg1.l1.m1.2.2.2.2.2.2.3.cmml">0</mn><mi mathsize="90%" id="alg1.l1.m1.2.2.2.2.2.3" xref="alg1.l1.m1.2.2.2.2.2.3.cmml">c</mi></msubsup><mo mathsize="90%" stretchy="false" id="alg1.l1.m1.2.2.2.2.1" xref="alg1.l1.m1.2.2.2.2.1.cmml">←</mo><mn mathsize="90%" id="alg1.l1.m1.2.2.2.2.3" xref="alg1.l1.m1.2.2.2.2.3.cmml">0</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.2b"><apply id="alg1.l1.m1.2.2.3.cmml" xref="alg1.l1.m1.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.3a.cmml" xref="alg1.l1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.l1.m1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1"><ci id="alg1.l1.m1.1.1.1.1.6.cmml" xref="alg1.l1.m1.1.1.1.1.6">←</ci><list id="alg1.l1.m1.1.1.1.1.5.6.cmml" xref="alg1.l1.m1.1.1.1.1.5.5"><apply id="alg1.l1.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l1.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1.2.2">𝜃</ci><cn type="integer" id="alg1.l1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1.2.3">0</cn></apply><ci id="alg1.l1.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1.3">𝑐</ci></apply><apply id="alg1.l1.m1.1.1.1.1.2.2.2.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.2">superscript</csymbol><apply id="alg1.l1.m1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.2.2.2.2.1.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.2">subscript</csymbol><ci id="alg1.l1.m1.1.1.1.1.2.2.2.2.2.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.2.2.2">𝑓</ci><cn type="integer" id="alg1.l1.m1.1.1.1.1.2.2.2.2.3.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.2.2.3">0</cn></apply><ci id="alg1.l1.m1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.2.3">𝑎</ci></apply><apply id="alg1.l1.m1.1.1.1.1.3.3.3.cmml" xref="alg1.l1.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.3.3.3.1.cmml" xref="alg1.l1.m1.1.1.1.1.3.3.3">superscript</csymbol><apply id="alg1.l1.m1.1.1.1.1.3.3.3.2.cmml" xref="alg1.l1.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.3.3.3.2.1.cmml" xref="alg1.l1.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="alg1.l1.m1.1.1.1.1.3.3.3.2.2.cmml" xref="alg1.l1.m1.1.1.1.1.3.3.3.2.2">𝑓</ci><cn type="integer" id="alg1.l1.m1.1.1.1.1.3.3.3.2.3.cmml" xref="alg1.l1.m1.1.1.1.1.3.3.3.2.3">0</cn></apply><ci id="alg1.l1.m1.1.1.1.1.3.3.3.3.cmml" xref="alg1.l1.m1.1.1.1.1.3.3.3.3">𝑏</ci></apply><apply id="alg1.l1.m1.1.1.1.1.4.4.4.cmml" xref="alg1.l1.m1.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.4.4.4.1.cmml" xref="alg1.l1.m1.1.1.1.1.4.4.4">superscript</csymbol><apply id="alg1.l1.m1.1.1.1.1.4.4.4.2.cmml" xref="alg1.l1.m1.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.4.4.4.2.1.cmml" xref="alg1.l1.m1.1.1.1.1.4.4.4">subscript</csymbol><ci id="alg1.l1.m1.1.1.1.1.4.4.4.2.2.cmml" xref="alg1.l1.m1.1.1.1.1.4.4.4.2.2">𝑓</ci><cn type="integer" id="alg1.l1.m1.1.1.1.1.4.4.4.2.3.cmml" xref="alg1.l1.m1.1.1.1.1.4.4.4.2.3">0</cn></apply><ci id="alg1.l1.m1.1.1.1.1.4.4.4.3.cmml" xref="alg1.l1.m1.1.1.1.1.4.4.4.3">𝑐</ci></apply><apply id="alg1.l1.m1.1.1.1.1.5.5.5.cmml" xref="alg1.l1.m1.1.1.1.1.5.5.5"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.5.5.5.1.cmml" xref="alg1.l1.m1.1.1.1.1.5.5.5">superscript</csymbol><apply id="alg1.l1.m1.1.1.1.1.5.5.5.2.cmml" xref="alg1.l1.m1.1.1.1.1.5.5.5"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.5.5.5.2.1.cmml" xref="alg1.l1.m1.1.1.1.1.5.5.5">subscript</csymbol><ci id="alg1.l1.m1.1.1.1.1.5.5.5.2.2.cmml" xref="alg1.l1.m1.1.1.1.1.5.5.5.2.2">𝑚</ci><cn type="integer" id="alg1.l1.m1.1.1.1.1.5.5.5.2.3.cmml" xref="alg1.l1.m1.1.1.1.1.5.5.5.2.3">0</cn></apply><ci id="alg1.l1.m1.1.1.1.1.5.5.5.3.cmml" xref="alg1.l1.m1.1.1.1.1.5.5.5.3">𝑏</ci></apply></list><cn type="integer" id="alg1.l1.m1.1.1.1.1.7.cmml" xref="alg1.l1.m1.1.1.1.1.7">0</cn></apply><apply id="alg1.l1.m1.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2"><ci id="alg1.l1.m1.2.2.2.2.1.cmml" xref="alg1.l1.m1.2.2.2.2.1">←</ci><apply id="alg1.l1.m1.2.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.2.2.2.1.cmml" xref="alg1.l1.m1.2.2.2.2.2">superscript</csymbol><apply id="alg1.l1.m1.2.2.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l1.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l1.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2.2.2.2">𝑚</ci><cn type="integer" id="alg1.l1.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l1.m1.2.2.2.2.2.2.3">0</cn></apply><ci id="alg1.l1.m1.2.2.2.2.2.3.cmml" xref="alg1.l1.m1.2.2.2.2.2.3">𝑐</ci></apply><cn type="integer" id="alg1.l1.m1.2.2.2.2.3.cmml" xref="alg1.l1.m1.2.2.2.2.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.2c">\theta_{0}^{c},f_{0}^{a},f_{0}^{b},f_{0}^{c},m_{0}^{b}\leftarrow 0,m_{0}^{c}\leftarrow 0</annotation></semantics></math><span id="alg1.l1.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span><span id="alg1.l2.2" class="ltx_text" style="font-size:90%;">  Set shared layers </span><math id="alg1.l2.m1.6" class="ltx_Math" alttext="\theta_{0}^{a}\leftarrow\theta_{0}^{c,1:L_{a}},\theta_{0}^{b}\leftarrow\theta_{0}^{c,1:L_{b}}" display="inline"><semantics id="alg1.l2.m1.6a"><mrow id="alg1.l2.m1.6.6.2" xref="alg1.l2.m1.6.6.3.cmml"><mrow id="alg1.l2.m1.5.5.1.1" xref="alg1.l2.m1.5.5.1.1.cmml"><msubsup id="alg1.l2.m1.5.5.1.1.2" xref="alg1.l2.m1.5.5.1.1.2.cmml"><mi mathsize="90%" id="alg1.l2.m1.5.5.1.1.2.2.2" xref="alg1.l2.m1.5.5.1.1.2.2.2.cmml">θ</mi><mn mathsize="90%" id="alg1.l2.m1.5.5.1.1.2.2.3" xref="alg1.l2.m1.5.5.1.1.2.2.3.cmml">0</mn><mi mathsize="90%" id="alg1.l2.m1.5.5.1.1.2.3" xref="alg1.l2.m1.5.5.1.1.2.3.cmml">a</mi></msubsup><mo mathsize="90%" stretchy="false" id="alg1.l2.m1.5.5.1.1.1" xref="alg1.l2.m1.5.5.1.1.1.cmml">←</mo><msubsup id="alg1.l2.m1.5.5.1.1.3" xref="alg1.l2.m1.5.5.1.1.3.cmml"><mi mathsize="90%" id="alg1.l2.m1.5.5.1.1.3.2.2" xref="alg1.l2.m1.5.5.1.1.3.2.2.cmml">θ</mi><mn mathsize="90%" id="alg1.l2.m1.5.5.1.1.3.2.3" xref="alg1.l2.m1.5.5.1.1.3.2.3.cmml">0</mn><mrow id="alg1.l2.m1.2.2.2" xref="alg1.l2.m1.2.2.2.cmml"><mrow id="alg1.l2.m1.2.2.2.4.2" xref="alg1.l2.m1.2.2.2.4.1.cmml"><mi mathsize="90%" id="alg1.l2.m1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.cmml">c</mi><mo mathsize="90%" id="alg1.l2.m1.2.2.2.4.2.1" xref="alg1.l2.m1.2.2.2.4.1.cmml">,</mo><mn mathsize="90%" id="alg1.l2.m1.2.2.2.2" xref="alg1.l2.m1.2.2.2.2.cmml">1</mn></mrow><mo lspace="0.278em" mathsize="90%" rspace="0.278em" id="alg1.l2.m1.2.2.2.3" xref="alg1.l2.m1.2.2.2.3.cmml">:</mo><msub id="alg1.l2.m1.2.2.2.5" xref="alg1.l2.m1.2.2.2.5.cmml"><mi mathsize="90%" id="alg1.l2.m1.2.2.2.5.2" xref="alg1.l2.m1.2.2.2.5.2.cmml">L</mi><mi mathsize="90%" id="alg1.l2.m1.2.2.2.5.3" xref="alg1.l2.m1.2.2.2.5.3.cmml">a</mi></msub></mrow></msubsup></mrow><mo mathsize="90%" id="alg1.l2.m1.6.6.2.3" xref="alg1.l2.m1.6.6.3a.cmml">,</mo><mrow id="alg1.l2.m1.6.6.2.2" xref="alg1.l2.m1.6.6.2.2.cmml"><msubsup id="alg1.l2.m1.6.6.2.2.2" xref="alg1.l2.m1.6.6.2.2.2.cmml"><mi mathsize="90%" id="alg1.l2.m1.6.6.2.2.2.2.2" xref="alg1.l2.m1.6.6.2.2.2.2.2.cmml">θ</mi><mn mathsize="90%" id="alg1.l2.m1.6.6.2.2.2.2.3" xref="alg1.l2.m1.6.6.2.2.2.2.3.cmml">0</mn><mi mathsize="90%" id="alg1.l2.m1.6.6.2.2.2.3" xref="alg1.l2.m1.6.6.2.2.2.3.cmml">b</mi></msubsup><mo mathsize="90%" stretchy="false" id="alg1.l2.m1.6.6.2.2.1" xref="alg1.l2.m1.6.6.2.2.1.cmml">←</mo><msubsup id="alg1.l2.m1.6.6.2.2.3" xref="alg1.l2.m1.6.6.2.2.3.cmml"><mi mathsize="90%" id="alg1.l2.m1.6.6.2.2.3.2.2" xref="alg1.l2.m1.6.6.2.2.3.2.2.cmml">θ</mi><mn mathsize="90%" id="alg1.l2.m1.6.6.2.2.3.2.3" xref="alg1.l2.m1.6.6.2.2.3.2.3.cmml">0</mn><mrow id="alg1.l2.m1.4.4.2" xref="alg1.l2.m1.4.4.2.cmml"><mrow id="alg1.l2.m1.4.4.2.4.2" xref="alg1.l2.m1.4.4.2.4.1.cmml"><mi mathsize="90%" id="alg1.l2.m1.3.3.1.1" xref="alg1.l2.m1.3.3.1.1.cmml">c</mi><mo mathsize="90%" id="alg1.l2.m1.4.4.2.4.2.1" xref="alg1.l2.m1.4.4.2.4.1.cmml">,</mo><mn mathsize="90%" id="alg1.l2.m1.4.4.2.2" xref="alg1.l2.m1.4.4.2.2.cmml">1</mn></mrow><mo lspace="0.278em" mathsize="90%" rspace="0.278em" id="alg1.l2.m1.4.4.2.3" xref="alg1.l2.m1.4.4.2.3.cmml">:</mo><msub id="alg1.l2.m1.4.4.2.5" xref="alg1.l2.m1.4.4.2.5.cmml"><mi mathsize="90%" id="alg1.l2.m1.4.4.2.5.2" xref="alg1.l2.m1.4.4.2.5.2.cmml">L</mi><mi mathsize="90%" id="alg1.l2.m1.4.4.2.5.3" xref="alg1.l2.m1.4.4.2.5.3.cmml">b</mi></msub></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.6b"><apply id="alg1.l2.m1.6.6.3.cmml" xref="alg1.l2.m1.6.6.2"><csymbol cd="ambiguous" id="alg1.l2.m1.6.6.3a.cmml" xref="alg1.l2.m1.6.6.2.3">formulae-sequence</csymbol><apply id="alg1.l2.m1.5.5.1.1.cmml" xref="alg1.l2.m1.5.5.1.1"><ci id="alg1.l2.m1.5.5.1.1.1.cmml" xref="alg1.l2.m1.5.5.1.1.1">←</ci><apply id="alg1.l2.m1.5.5.1.1.2.cmml" xref="alg1.l2.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="alg1.l2.m1.5.5.1.1.2.1.cmml" xref="alg1.l2.m1.5.5.1.1.2">superscript</csymbol><apply id="alg1.l2.m1.5.5.1.1.2.2.cmml" xref="alg1.l2.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="alg1.l2.m1.5.5.1.1.2.2.1.cmml" xref="alg1.l2.m1.5.5.1.1.2">subscript</csymbol><ci id="alg1.l2.m1.5.5.1.1.2.2.2.cmml" xref="alg1.l2.m1.5.5.1.1.2.2.2">𝜃</ci><cn type="integer" id="alg1.l2.m1.5.5.1.1.2.2.3.cmml" xref="alg1.l2.m1.5.5.1.1.2.2.3">0</cn></apply><ci id="alg1.l2.m1.5.5.1.1.2.3.cmml" xref="alg1.l2.m1.5.5.1.1.2.3">𝑎</ci></apply><apply id="alg1.l2.m1.5.5.1.1.3.cmml" xref="alg1.l2.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="alg1.l2.m1.5.5.1.1.3.1.cmml" xref="alg1.l2.m1.5.5.1.1.3">superscript</csymbol><apply id="alg1.l2.m1.5.5.1.1.3.2.cmml" xref="alg1.l2.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="alg1.l2.m1.5.5.1.1.3.2.1.cmml" xref="alg1.l2.m1.5.5.1.1.3">subscript</csymbol><ci id="alg1.l2.m1.5.5.1.1.3.2.2.cmml" xref="alg1.l2.m1.5.5.1.1.3.2.2">𝜃</ci><cn type="integer" id="alg1.l2.m1.5.5.1.1.3.2.3.cmml" xref="alg1.l2.m1.5.5.1.1.3.2.3">0</cn></apply><apply id="alg1.l2.m1.2.2.2.cmml" xref="alg1.l2.m1.2.2.2"><ci id="alg1.l2.m1.2.2.2.3.cmml" xref="alg1.l2.m1.2.2.2.3">:</ci><list id="alg1.l2.m1.2.2.2.4.1.cmml" xref="alg1.l2.m1.2.2.2.4.2"><ci id="alg1.l2.m1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1">𝑐</ci><cn type="integer" id="alg1.l2.m1.2.2.2.2.cmml" xref="alg1.l2.m1.2.2.2.2">1</cn></list><apply id="alg1.l2.m1.2.2.2.5.cmml" xref="alg1.l2.m1.2.2.2.5"><csymbol cd="ambiguous" id="alg1.l2.m1.2.2.2.5.1.cmml" xref="alg1.l2.m1.2.2.2.5">subscript</csymbol><ci id="alg1.l2.m1.2.2.2.5.2.cmml" xref="alg1.l2.m1.2.2.2.5.2">𝐿</ci><ci id="alg1.l2.m1.2.2.2.5.3.cmml" xref="alg1.l2.m1.2.2.2.5.3">𝑎</ci></apply></apply></apply></apply><apply id="alg1.l2.m1.6.6.2.2.cmml" xref="alg1.l2.m1.6.6.2.2"><ci id="alg1.l2.m1.6.6.2.2.1.cmml" xref="alg1.l2.m1.6.6.2.2.1">←</ci><apply id="alg1.l2.m1.6.6.2.2.2.cmml" xref="alg1.l2.m1.6.6.2.2.2"><csymbol cd="ambiguous" id="alg1.l2.m1.6.6.2.2.2.1.cmml" xref="alg1.l2.m1.6.6.2.2.2">superscript</csymbol><apply id="alg1.l2.m1.6.6.2.2.2.2.cmml" xref="alg1.l2.m1.6.6.2.2.2"><csymbol cd="ambiguous" id="alg1.l2.m1.6.6.2.2.2.2.1.cmml" xref="alg1.l2.m1.6.6.2.2.2">subscript</csymbol><ci id="alg1.l2.m1.6.6.2.2.2.2.2.cmml" xref="alg1.l2.m1.6.6.2.2.2.2.2">𝜃</ci><cn type="integer" id="alg1.l2.m1.6.6.2.2.2.2.3.cmml" xref="alg1.l2.m1.6.6.2.2.2.2.3">0</cn></apply><ci id="alg1.l2.m1.6.6.2.2.2.3.cmml" xref="alg1.l2.m1.6.6.2.2.2.3">𝑏</ci></apply><apply id="alg1.l2.m1.6.6.2.2.3.cmml" xref="alg1.l2.m1.6.6.2.2.3"><csymbol cd="ambiguous" id="alg1.l2.m1.6.6.2.2.3.1.cmml" xref="alg1.l2.m1.6.6.2.2.3">superscript</csymbol><apply id="alg1.l2.m1.6.6.2.2.3.2.cmml" xref="alg1.l2.m1.6.6.2.2.3"><csymbol cd="ambiguous" id="alg1.l2.m1.6.6.2.2.3.2.1.cmml" xref="alg1.l2.m1.6.6.2.2.3">subscript</csymbol><ci id="alg1.l2.m1.6.6.2.2.3.2.2.cmml" xref="alg1.l2.m1.6.6.2.2.3.2.2">𝜃</ci><cn type="integer" id="alg1.l2.m1.6.6.2.2.3.2.3.cmml" xref="alg1.l2.m1.6.6.2.2.3.2.3">0</cn></apply><apply id="alg1.l2.m1.4.4.2.cmml" xref="alg1.l2.m1.4.4.2"><ci id="alg1.l2.m1.4.4.2.3.cmml" xref="alg1.l2.m1.4.4.2.3">:</ci><list id="alg1.l2.m1.4.4.2.4.1.cmml" xref="alg1.l2.m1.4.4.2.4.2"><ci id="alg1.l2.m1.3.3.1.1.cmml" xref="alg1.l2.m1.3.3.1.1">𝑐</ci><cn type="integer" id="alg1.l2.m1.4.4.2.2.cmml" xref="alg1.l2.m1.4.4.2.2">1</cn></list><apply id="alg1.l2.m1.4.4.2.5.cmml" xref="alg1.l2.m1.4.4.2.5"><csymbol cd="ambiguous" id="alg1.l2.m1.4.4.2.5.1.cmml" xref="alg1.l2.m1.4.4.2.5">subscript</csymbol><ci id="alg1.l2.m1.4.4.2.5.2.cmml" xref="alg1.l2.m1.4.4.2.5.2">𝐿</ci><ci id="alg1.l2.m1.4.4.2.5.3.cmml" xref="alg1.l2.m1.4.4.2.5.3">𝑏</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.6c">\theta_{0}^{a}\leftarrow\theta_{0}^{c,1:L_{a}},\theta_{0}^{b}\leftarrow\theta_{0}^{c,1:L_{b}}</annotation></semantics></math><span id="alg1.l2.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span><span id="alg1.l3.2" class="ltx_text" style="font-size:90%;">  Get models </span><math id="alg1.l3.m1.2" class="ltx_Math" alttext="w_{0}^{a}\leftarrow\theta_{0}^{a}\circ f_{0}^{a},w_{0}^{b}\leftarrow\theta_{0}^{b}\circ f_{0}^{b},w_{0}^{c}\leftarrow\theta_{0}^{c}\circ f_{0}^{c}" display="inline"><semantics id="alg1.l3.m1.2a"><mrow id="alg1.l3.m1.2.2.2" xref="alg1.l3.m1.2.2.3.cmml"><mrow id="alg1.l3.m1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.cmml"><msubsup id="alg1.l3.m1.1.1.1.1.2" xref="alg1.l3.m1.1.1.1.1.2.cmml"><mi mathsize="90%" id="alg1.l3.m1.1.1.1.1.2.2.2" xref="alg1.l3.m1.1.1.1.1.2.2.2.cmml">w</mi><mn mathsize="90%" id="alg1.l3.m1.1.1.1.1.2.2.3" xref="alg1.l3.m1.1.1.1.1.2.2.3.cmml">0</mn><mi mathsize="90%" id="alg1.l3.m1.1.1.1.1.2.3" xref="alg1.l3.m1.1.1.1.1.2.3.cmml">a</mi></msubsup><mo mathsize="90%" stretchy="false" id="alg1.l3.m1.1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.1.cmml">←</mo><mrow id="alg1.l3.m1.1.1.1.1.3" xref="alg1.l3.m1.1.1.1.1.3.cmml"><msubsup id="alg1.l3.m1.1.1.1.1.3.2" xref="alg1.l3.m1.1.1.1.1.3.2.cmml"><mi mathsize="90%" id="alg1.l3.m1.1.1.1.1.3.2.2.2" xref="alg1.l3.m1.1.1.1.1.3.2.2.2.cmml">θ</mi><mn mathsize="90%" id="alg1.l3.m1.1.1.1.1.3.2.2.3" xref="alg1.l3.m1.1.1.1.1.3.2.2.3.cmml">0</mn><mi mathsize="90%" id="alg1.l3.m1.1.1.1.1.3.2.3" xref="alg1.l3.m1.1.1.1.1.3.2.3.cmml">a</mi></msubsup><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="alg1.l3.m1.1.1.1.1.3.1" xref="alg1.l3.m1.1.1.1.1.3.1.cmml">∘</mo><msubsup id="alg1.l3.m1.1.1.1.1.3.3" xref="alg1.l3.m1.1.1.1.1.3.3.cmml"><mi mathsize="90%" id="alg1.l3.m1.1.1.1.1.3.3.2.2" xref="alg1.l3.m1.1.1.1.1.3.3.2.2.cmml">f</mi><mn mathsize="90%" id="alg1.l3.m1.1.1.1.1.3.3.2.3" xref="alg1.l3.m1.1.1.1.1.3.3.2.3.cmml">0</mn><mi mathsize="90%" id="alg1.l3.m1.1.1.1.1.3.3.3" xref="alg1.l3.m1.1.1.1.1.3.3.3.cmml">a</mi></msubsup></mrow></mrow><mo mathsize="90%" id="alg1.l3.m1.2.2.2.3" xref="alg1.l3.m1.2.2.3a.cmml">,</mo><mrow id="alg1.l3.m1.2.2.2.2.2" xref="alg1.l3.m1.2.2.2.2.3.cmml"><mrow id="alg1.l3.m1.2.2.2.2.1.1" xref="alg1.l3.m1.2.2.2.2.1.1.cmml"><msubsup id="alg1.l3.m1.2.2.2.2.1.1.2" xref="alg1.l3.m1.2.2.2.2.1.1.2.cmml"><mi mathsize="90%" id="alg1.l3.m1.2.2.2.2.1.1.2.2.2" xref="alg1.l3.m1.2.2.2.2.1.1.2.2.2.cmml">w</mi><mn mathsize="90%" id="alg1.l3.m1.2.2.2.2.1.1.2.2.3" xref="alg1.l3.m1.2.2.2.2.1.1.2.2.3.cmml">0</mn><mi mathsize="90%" id="alg1.l3.m1.2.2.2.2.1.1.2.3" xref="alg1.l3.m1.2.2.2.2.1.1.2.3.cmml">b</mi></msubsup><mo mathsize="90%" stretchy="false" id="alg1.l3.m1.2.2.2.2.1.1.1" xref="alg1.l3.m1.2.2.2.2.1.1.1.cmml">←</mo><mrow id="alg1.l3.m1.2.2.2.2.1.1.3" xref="alg1.l3.m1.2.2.2.2.1.1.3.cmml"><msubsup id="alg1.l3.m1.2.2.2.2.1.1.3.2" xref="alg1.l3.m1.2.2.2.2.1.1.3.2.cmml"><mi mathsize="90%" id="alg1.l3.m1.2.2.2.2.1.1.3.2.2.2" xref="alg1.l3.m1.2.2.2.2.1.1.3.2.2.2.cmml">θ</mi><mn mathsize="90%" id="alg1.l3.m1.2.2.2.2.1.1.3.2.2.3" xref="alg1.l3.m1.2.2.2.2.1.1.3.2.2.3.cmml">0</mn><mi mathsize="90%" id="alg1.l3.m1.2.2.2.2.1.1.3.2.3" xref="alg1.l3.m1.2.2.2.2.1.1.3.2.3.cmml">b</mi></msubsup><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="alg1.l3.m1.2.2.2.2.1.1.3.1" xref="alg1.l3.m1.2.2.2.2.1.1.3.1.cmml">∘</mo><msubsup id="alg1.l3.m1.2.2.2.2.1.1.3.3" xref="alg1.l3.m1.2.2.2.2.1.1.3.3.cmml"><mi mathsize="90%" id="alg1.l3.m1.2.2.2.2.1.1.3.3.2.2" xref="alg1.l3.m1.2.2.2.2.1.1.3.3.2.2.cmml">f</mi><mn mathsize="90%" id="alg1.l3.m1.2.2.2.2.1.1.3.3.2.3" xref="alg1.l3.m1.2.2.2.2.1.1.3.3.2.3.cmml">0</mn><mi mathsize="90%" id="alg1.l3.m1.2.2.2.2.1.1.3.3.3" xref="alg1.l3.m1.2.2.2.2.1.1.3.3.3.cmml">b</mi></msubsup></mrow></mrow><mo mathsize="90%" id="alg1.l3.m1.2.2.2.2.2.3" xref="alg1.l3.m1.2.2.2.2.3a.cmml">,</mo><mrow id="alg1.l3.m1.2.2.2.2.2.2" xref="alg1.l3.m1.2.2.2.2.2.2.cmml"><msubsup id="alg1.l3.m1.2.2.2.2.2.2.2" xref="alg1.l3.m1.2.2.2.2.2.2.2.cmml"><mi mathsize="90%" id="alg1.l3.m1.2.2.2.2.2.2.2.2.2" xref="alg1.l3.m1.2.2.2.2.2.2.2.2.2.cmml">w</mi><mn mathsize="90%" id="alg1.l3.m1.2.2.2.2.2.2.2.2.3" xref="alg1.l3.m1.2.2.2.2.2.2.2.2.3.cmml">0</mn><mi mathsize="90%" id="alg1.l3.m1.2.2.2.2.2.2.2.3" xref="alg1.l3.m1.2.2.2.2.2.2.2.3.cmml">c</mi></msubsup><mo mathsize="90%" stretchy="false" id="alg1.l3.m1.2.2.2.2.2.2.1" xref="alg1.l3.m1.2.2.2.2.2.2.1.cmml">←</mo><mrow id="alg1.l3.m1.2.2.2.2.2.2.3" xref="alg1.l3.m1.2.2.2.2.2.2.3.cmml"><msubsup id="alg1.l3.m1.2.2.2.2.2.2.3.2" xref="alg1.l3.m1.2.2.2.2.2.2.3.2.cmml"><mi mathsize="90%" id="alg1.l3.m1.2.2.2.2.2.2.3.2.2.2" xref="alg1.l3.m1.2.2.2.2.2.2.3.2.2.2.cmml">θ</mi><mn mathsize="90%" id="alg1.l3.m1.2.2.2.2.2.2.3.2.2.3" xref="alg1.l3.m1.2.2.2.2.2.2.3.2.2.3.cmml">0</mn><mi mathsize="90%" id="alg1.l3.m1.2.2.2.2.2.2.3.2.3" xref="alg1.l3.m1.2.2.2.2.2.2.3.2.3.cmml">c</mi></msubsup><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="alg1.l3.m1.2.2.2.2.2.2.3.1" xref="alg1.l3.m1.2.2.2.2.2.2.3.1.cmml">∘</mo><msubsup id="alg1.l3.m1.2.2.2.2.2.2.3.3" xref="alg1.l3.m1.2.2.2.2.2.2.3.3.cmml"><mi mathsize="90%" id="alg1.l3.m1.2.2.2.2.2.2.3.3.2.2" xref="alg1.l3.m1.2.2.2.2.2.2.3.3.2.2.cmml">f</mi><mn mathsize="90%" id="alg1.l3.m1.2.2.2.2.2.2.3.3.2.3" xref="alg1.l3.m1.2.2.2.2.2.2.3.3.2.3.cmml">0</mn><mi mathsize="90%" id="alg1.l3.m1.2.2.2.2.2.2.3.3.3" xref="alg1.l3.m1.2.2.2.2.2.2.3.3.3.cmml">c</mi></msubsup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.2b"><apply id="alg1.l3.m1.2.2.3.cmml" xref="alg1.l3.m1.2.2.2"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.3a.cmml" xref="alg1.l3.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.l3.m1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1"><ci id="alg1.l3.m1.1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1.1">←</ci><apply id="alg1.l3.m1.1.1.1.1.2.cmml" xref="alg1.l3.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.1.2.1.cmml" xref="alg1.l3.m1.1.1.1.1.2">superscript</csymbol><apply id="alg1.l3.m1.1.1.1.1.2.2.cmml" xref="alg1.l3.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.1.2.2.1.cmml" xref="alg1.l3.m1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l3.m1.1.1.1.1.2.2.2.cmml" xref="alg1.l3.m1.1.1.1.1.2.2.2">𝑤</ci><cn type="integer" id="alg1.l3.m1.1.1.1.1.2.2.3.cmml" xref="alg1.l3.m1.1.1.1.1.2.2.3">0</cn></apply><ci id="alg1.l3.m1.1.1.1.1.2.3.cmml" xref="alg1.l3.m1.1.1.1.1.2.3">𝑎</ci></apply><apply id="alg1.l3.m1.1.1.1.1.3.cmml" xref="alg1.l3.m1.1.1.1.1.3"><compose id="alg1.l3.m1.1.1.1.1.3.1.cmml" xref="alg1.l3.m1.1.1.1.1.3.1"></compose><apply id="alg1.l3.m1.1.1.1.1.3.2.cmml" xref="alg1.l3.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.1.3.2.1.cmml" xref="alg1.l3.m1.1.1.1.1.3.2">superscript</csymbol><apply id="alg1.l3.m1.1.1.1.1.3.2.2.cmml" xref="alg1.l3.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.1.3.2.2.1.cmml" xref="alg1.l3.m1.1.1.1.1.3.2">subscript</csymbol><ci id="alg1.l3.m1.1.1.1.1.3.2.2.2.cmml" xref="alg1.l3.m1.1.1.1.1.3.2.2.2">𝜃</ci><cn type="integer" id="alg1.l3.m1.1.1.1.1.3.2.2.3.cmml" xref="alg1.l3.m1.1.1.1.1.3.2.2.3">0</cn></apply><ci id="alg1.l3.m1.1.1.1.1.3.2.3.cmml" xref="alg1.l3.m1.1.1.1.1.3.2.3">𝑎</ci></apply><apply id="alg1.l3.m1.1.1.1.1.3.3.cmml" xref="alg1.l3.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.1.3.3.1.cmml" xref="alg1.l3.m1.1.1.1.1.3.3">superscript</csymbol><apply id="alg1.l3.m1.1.1.1.1.3.3.2.cmml" xref="alg1.l3.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.1.3.3.2.1.cmml" xref="alg1.l3.m1.1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l3.m1.1.1.1.1.3.3.2.2.cmml" xref="alg1.l3.m1.1.1.1.1.3.3.2.2">𝑓</ci><cn type="integer" id="alg1.l3.m1.1.1.1.1.3.3.2.3.cmml" xref="alg1.l3.m1.1.1.1.1.3.3.2.3">0</cn></apply><ci id="alg1.l3.m1.1.1.1.1.3.3.3.cmml" xref="alg1.l3.m1.1.1.1.1.3.3.3">𝑎</ci></apply></apply></apply><apply id="alg1.l3.m1.2.2.2.2.3.cmml" xref="alg1.l3.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.2.2.3a.cmml" xref="alg1.l3.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.l3.m1.2.2.2.2.1.1.cmml" xref="alg1.l3.m1.2.2.2.2.1.1"><ci id="alg1.l3.m1.2.2.2.2.1.1.1.cmml" xref="alg1.l3.m1.2.2.2.2.1.1.1">←</ci><apply id="alg1.l3.m1.2.2.2.2.1.1.2.cmml" xref="alg1.l3.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.2.2.1.1.2.1.cmml" xref="alg1.l3.m1.2.2.2.2.1.1.2">superscript</csymbol><apply id="alg1.l3.m1.2.2.2.2.1.1.2.2.cmml" xref="alg1.l3.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.2.2.1.1.2.2.1.cmml" xref="alg1.l3.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="alg1.l3.m1.2.2.2.2.1.1.2.2.2.cmml" xref="alg1.l3.m1.2.2.2.2.1.1.2.2.2">𝑤</ci><cn type="integer" id="alg1.l3.m1.2.2.2.2.1.1.2.2.3.cmml" xref="alg1.l3.m1.2.2.2.2.1.1.2.2.3">0</cn></apply><ci id="alg1.l3.m1.2.2.2.2.1.1.2.3.cmml" xref="alg1.l3.m1.2.2.2.2.1.1.2.3">𝑏</ci></apply><apply id="alg1.l3.m1.2.2.2.2.1.1.3.cmml" xref="alg1.l3.m1.2.2.2.2.1.1.3"><compose id="alg1.l3.m1.2.2.2.2.1.1.3.1.cmml" xref="alg1.l3.m1.2.2.2.2.1.1.3.1"></compose><apply id="alg1.l3.m1.2.2.2.2.1.1.3.2.cmml" xref="alg1.l3.m1.2.2.2.2.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.2.2.1.1.3.2.1.cmml" xref="alg1.l3.m1.2.2.2.2.1.1.3.2">superscript</csymbol><apply id="alg1.l3.m1.2.2.2.2.1.1.3.2.2.cmml" xref="alg1.l3.m1.2.2.2.2.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.2.2.1.1.3.2.2.1.cmml" xref="alg1.l3.m1.2.2.2.2.1.1.3.2">subscript</csymbol><ci id="alg1.l3.m1.2.2.2.2.1.1.3.2.2.2.cmml" xref="alg1.l3.m1.2.2.2.2.1.1.3.2.2.2">𝜃</ci><cn type="integer" id="alg1.l3.m1.2.2.2.2.1.1.3.2.2.3.cmml" xref="alg1.l3.m1.2.2.2.2.1.1.3.2.2.3">0</cn></apply><ci id="alg1.l3.m1.2.2.2.2.1.1.3.2.3.cmml" xref="alg1.l3.m1.2.2.2.2.1.1.3.2.3">𝑏</ci></apply><apply id="alg1.l3.m1.2.2.2.2.1.1.3.3.cmml" xref="alg1.l3.m1.2.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.2.2.1.1.3.3.1.cmml" xref="alg1.l3.m1.2.2.2.2.1.1.3.3">superscript</csymbol><apply id="alg1.l3.m1.2.2.2.2.1.1.3.3.2.cmml" xref="alg1.l3.m1.2.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.2.2.1.1.3.3.2.1.cmml" xref="alg1.l3.m1.2.2.2.2.1.1.3.3">subscript</csymbol><ci id="alg1.l3.m1.2.2.2.2.1.1.3.3.2.2.cmml" xref="alg1.l3.m1.2.2.2.2.1.1.3.3.2.2">𝑓</ci><cn type="integer" id="alg1.l3.m1.2.2.2.2.1.1.3.3.2.3.cmml" xref="alg1.l3.m1.2.2.2.2.1.1.3.3.2.3">0</cn></apply><ci id="alg1.l3.m1.2.2.2.2.1.1.3.3.3.cmml" xref="alg1.l3.m1.2.2.2.2.1.1.3.3.3">𝑏</ci></apply></apply></apply><apply id="alg1.l3.m1.2.2.2.2.2.2.cmml" xref="alg1.l3.m1.2.2.2.2.2.2"><ci id="alg1.l3.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l3.m1.2.2.2.2.2.2.1">←</ci><apply id="alg1.l3.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l3.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l3.m1.2.2.2.2.2.2.2">superscript</csymbol><apply id="alg1.l3.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l3.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.2.2.2.2.2.2.1.cmml" xref="alg1.l3.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l3.m1.2.2.2.2.2.2.2.2.2.cmml" xref="alg1.l3.m1.2.2.2.2.2.2.2.2.2">𝑤</ci><cn type="integer" id="alg1.l3.m1.2.2.2.2.2.2.2.2.3.cmml" xref="alg1.l3.m1.2.2.2.2.2.2.2.2.3">0</cn></apply><ci id="alg1.l3.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.l3.m1.2.2.2.2.2.2.2.3">𝑐</ci></apply><apply id="alg1.l3.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l3.m1.2.2.2.2.2.2.3"><compose id="alg1.l3.m1.2.2.2.2.2.2.3.1.cmml" xref="alg1.l3.m1.2.2.2.2.2.2.3.1"></compose><apply id="alg1.l3.m1.2.2.2.2.2.2.3.2.cmml" xref="alg1.l3.m1.2.2.2.2.2.2.3.2"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.2.2.2.2.3.2.1.cmml" xref="alg1.l3.m1.2.2.2.2.2.2.3.2">superscript</csymbol><apply id="alg1.l3.m1.2.2.2.2.2.2.3.2.2.cmml" xref="alg1.l3.m1.2.2.2.2.2.2.3.2"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.2.2.2.2.3.2.2.1.cmml" xref="alg1.l3.m1.2.2.2.2.2.2.3.2">subscript</csymbol><ci id="alg1.l3.m1.2.2.2.2.2.2.3.2.2.2.cmml" xref="alg1.l3.m1.2.2.2.2.2.2.3.2.2.2">𝜃</ci><cn type="integer" id="alg1.l3.m1.2.2.2.2.2.2.3.2.2.3.cmml" xref="alg1.l3.m1.2.2.2.2.2.2.3.2.2.3">0</cn></apply><ci id="alg1.l3.m1.2.2.2.2.2.2.3.2.3.cmml" xref="alg1.l3.m1.2.2.2.2.2.2.3.2.3">𝑐</ci></apply><apply id="alg1.l3.m1.2.2.2.2.2.2.3.3.cmml" xref="alg1.l3.m1.2.2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.2.2.2.2.3.3.1.cmml" xref="alg1.l3.m1.2.2.2.2.2.2.3.3">superscript</csymbol><apply id="alg1.l3.m1.2.2.2.2.2.2.3.3.2.cmml" xref="alg1.l3.m1.2.2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.2.2.2.2.3.3.2.1.cmml" xref="alg1.l3.m1.2.2.2.2.2.2.3.3">subscript</csymbol><ci id="alg1.l3.m1.2.2.2.2.2.2.3.3.2.2.cmml" xref="alg1.l3.m1.2.2.2.2.2.2.3.3.2.2">𝑓</ci><cn type="integer" id="alg1.l3.m1.2.2.2.2.2.2.3.3.2.3.cmml" xref="alg1.l3.m1.2.2.2.2.2.2.3.3.2.3">0</cn></apply><ci id="alg1.l3.m1.2.2.2.2.2.2.3.3.3.cmml" xref="alg1.l3.m1.2.2.2.2.2.2.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.2c">w_{0}^{a}\leftarrow\theta_{0}^{a}\circ f_{0}^{a},w_{0}^{b}\leftarrow\theta_{0}^{b}\circ f_{0}^{b},w_{0}^{c}\leftarrow\theta_{0}^{c}\circ f_{0}^{c}</annotation></semantics></math><span id="alg1.l3.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span><span id="alg1.l4.2" class="ltx_text" style="font-size:90%;">  </span><span id="alg1.l4.3" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg1.l4.4" class="ltx_text" style="font-size:90%;"> </span><math id="alg1.l4.m1.3" class="ltx_Math" alttext="t\in\{1,\cdots,T\}" display="inline"><semantics id="alg1.l4.m1.3a"><mrow id="alg1.l4.m1.3.4" xref="alg1.l4.m1.3.4.cmml"><mi mathsize="90%" id="alg1.l4.m1.3.4.2" xref="alg1.l4.m1.3.4.2.cmml">t</mi><mo mathsize="90%" id="alg1.l4.m1.3.4.1" xref="alg1.l4.m1.3.4.1.cmml">∈</mo><mrow id="alg1.l4.m1.3.4.3.2" xref="alg1.l4.m1.3.4.3.1.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l4.m1.3.4.3.2.1" xref="alg1.l4.m1.3.4.3.1.cmml">{</mo><mn mathsize="90%" id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">1</mn><mo mathsize="90%" id="alg1.l4.m1.3.4.3.2.2" xref="alg1.l4.m1.3.4.3.1.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="alg1.l4.m1.2.2" xref="alg1.l4.m1.2.2.cmml">⋯</mi><mo mathsize="90%" id="alg1.l4.m1.3.4.3.2.3" xref="alg1.l4.m1.3.4.3.1.cmml">,</mo><mi mathsize="90%" id="alg1.l4.m1.3.3" xref="alg1.l4.m1.3.3.cmml">T</mi><mo maxsize="90%" minsize="90%" id="alg1.l4.m1.3.4.3.2.4" xref="alg1.l4.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.3b"><apply id="alg1.l4.m1.3.4.cmml" xref="alg1.l4.m1.3.4"><in id="alg1.l4.m1.3.4.1.cmml" xref="alg1.l4.m1.3.4.1"></in><ci id="alg1.l4.m1.3.4.2.cmml" xref="alg1.l4.m1.3.4.2">𝑡</ci><set id="alg1.l4.m1.3.4.3.1.cmml" xref="alg1.l4.m1.3.4.3.2"><cn type="integer" id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">1</cn><ci id="alg1.l4.m1.2.2.cmml" xref="alg1.l4.m1.2.2">⋯</ci><ci id="alg1.l4.m1.3.3.cmml" xref="alg1.l4.m1.3.3">𝑇</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.3c">t\in\{1,\cdots,T\}</annotation></semantics></math><span id="alg1.l4.5" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l4.6" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="alg1.l4.7" class="ltx_text" style="font-size:90%;">


</span>
</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span><span id="alg1.l5.2" class="ltx_text" style="font-size:90%;">     </span><math id="alg1.l5.m1.1" class="ltx_Math" alttext="U_{t}\leftarrow" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><msub id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml"><mi mathsize="90%" id="alg1.l5.m1.1.1.2.2" xref="alg1.l5.m1.1.1.2.2.cmml">U</mi><mi mathsize="90%" id="alg1.l5.m1.1.1.2.3" xref="alg1.l5.m1.1.1.2.3.cmml">t</mi></msub><mo mathsize="90%" stretchy="false" id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">←</mo><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><ci id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1">←</ci><apply id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.2">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.2.2">𝑈</ci><ci id="alg1.l5.m1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">U_{t}\leftarrow</annotation></semantics></math><span id="alg1.l5.3" class="ltx_text" style="font-size:90%;"> (randomly sample a portion of </span><math id="alg1.l5.m2.1" class="ltx_Math" alttext="r" display="inline"><semantics id="alg1.l5.m2.1a"><mi mathsize="90%" id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><ci id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">r</annotation></semantics></math><span id="alg1.l5.4" class="ltx_text" style="font-size:90%;"> users)
</span>
</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span><span id="alg1.l6.2" class="ltx_text" style="font-size:90%;">     </span><math id="alg1.l6.m1.3" class="ltx_Math" alttext="U_{t}^{a},U_{t}^{b},U_{t}^{c}\leftarrow" display="inline"><semantics id="alg1.l6.m1.3a"><mrow id="alg1.l6.m1.3.3" xref="alg1.l6.m1.3.3.cmml"><mrow id="alg1.l6.m1.3.3.3.3" xref="alg1.l6.m1.3.3.3.4.cmml"><msubsup id="alg1.l6.m1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l6.m1.1.1.1.1.1.2.2" xref="alg1.l6.m1.1.1.1.1.1.2.2.cmml">U</mi><mi mathsize="90%" id="alg1.l6.m1.1.1.1.1.1.2.3" xref="alg1.l6.m1.1.1.1.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.l6.m1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.3.cmml">a</mi></msubsup><mo mathsize="90%" id="alg1.l6.m1.3.3.3.3.4" xref="alg1.l6.m1.3.3.3.4.cmml">,</mo><msubsup id="alg1.l6.m1.2.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.2.cmml"><mi mathsize="90%" id="alg1.l6.m1.2.2.2.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.2.2.2.cmml">U</mi><mi mathsize="90%" id="alg1.l6.m1.2.2.2.2.2.2.3" xref="alg1.l6.m1.2.2.2.2.2.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.l6.m1.2.2.2.2.2.3" xref="alg1.l6.m1.2.2.2.2.2.3.cmml">b</mi></msubsup><mo mathsize="90%" id="alg1.l6.m1.3.3.3.3.5" xref="alg1.l6.m1.3.3.3.4.cmml">,</mo><msubsup id="alg1.l6.m1.3.3.3.3.3" xref="alg1.l6.m1.3.3.3.3.3.cmml"><mi mathsize="90%" id="alg1.l6.m1.3.3.3.3.3.2.2" xref="alg1.l6.m1.3.3.3.3.3.2.2.cmml">U</mi><mi mathsize="90%" id="alg1.l6.m1.3.3.3.3.3.2.3" xref="alg1.l6.m1.3.3.3.3.3.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.l6.m1.3.3.3.3.3.3" xref="alg1.l6.m1.3.3.3.3.3.3.cmml">c</mi></msubsup></mrow><mo mathsize="90%" stretchy="false" id="alg1.l6.m1.3.3.4" xref="alg1.l6.m1.3.3.4.cmml">←</mo><mi id="alg1.l6.m1.3.3.5" xref="alg1.l6.m1.3.3.5.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.3b"><apply id="alg1.l6.m1.3.3.cmml" xref="alg1.l6.m1.3.3"><ci id="alg1.l6.m1.3.3.4.cmml" xref="alg1.l6.m1.3.3.4">←</ci><list id="alg1.l6.m1.3.3.3.4.cmml" xref="alg1.l6.m1.3.3.3.3"><apply id="alg1.l6.m1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l6.m1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.2.2">𝑈</ci><ci id="alg1.l6.m1.1.1.1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l6.m1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.3">𝑎</ci></apply><apply id="alg1.l6.m1.2.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.2.2.1.cmml" xref="alg1.l6.m1.2.2.2.2.2">superscript</csymbol><apply id="alg1.l6.m1.2.2.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l6.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l6.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.2.2.2">𝑈</ci><ci id="alg1.l6.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="alg1.l6.m1.2.2.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.2.2.3">𝑏</ci></apply><apply id="alg1.l6.m1.3.3.3.3.3.cmml" xref="alg1.l6.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l6.m1.3.3.3.3.3.1.cmml" xref="alg1.l6.m1.3.3.3.3.3">superscript</csymbol><apply id="alg1.l6.m1.3.3.3.3.3.2.cmml" xref="alg1.l6.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l6.m1.3.3.3.3.3.2.1.cmml" xref="alg1.l6.m1.3.3.3.3.3">subscript</csymbol><ci id="alg1.l6.m1.3.3.3.3.3.2.2.cmml" xref="alg1.l6.m1.3.3.3.3.3.2.2">𝑈</ci><ci id="alg1.l6.m1.3.3.3.3.3.2.3.cmml" xref="alg1.l6.m1.3.3.3.3.3.2.3">𝑡</ci></apply><ci id="alg1.l6.m1.3.3.3.3.3.3.cmml" xref="alg1.l6.m1.3.3.3.3.3.3">𝑐</ci></apply></list><csymbol cd="latexml" id="alg1.l6.m1.3.3.5.cmml" xref="alg1.l6.m1.3.3.5">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.3c">U_{t}^{a},U_{t}^{b},U_{t}^{c}\leftarrow</annotation></semantics></math><span id="alg1.l6.3" class="ltx_text" style="font-size:90%;"> (group </span><math id="alg1.l6.m2.1" class="ltx_Math" alttext="U_{t}" display="inline"><semantics id="alg1.l6.m2.1a"><msub id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml"><mi mathsize="90%" id="alg1.l6.m2.1.1.2" xref="alg1.l6.m2.1.1.2.cmml">U</mi><mi mathsize="90%" id="alg1.l6.m2.1.1.3" xref="alg1.l6.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><apply id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.1.cmml" xref="alg1.l6.m2.1.1">subscript</csymbol><ci id="alg1.l6.m2.1.1.2.cmml" xref="alg1.l6.m2.1.1.2">𝑈</ci><ci id="alg1.l6.m2.1.1.3.cmml" xref="alg1.l6.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">U_{t}</annotation></semantics></math><span id="alg1.l6.4" class="ltx_text" style="font-size:90%;"> into the same device type)
</span>
</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span><span id="alg1.l7.2" class="ltx_text" style="font-size:90%;">     </span><math id="alg1.l7.m1.3" class="ltx_Math" alttext="n_{a},n_{b},n_{c}\leftarrow" display="inline"><semantics id="alg1.l7.m1.3a"><mrow id="alg1.l7.m1.3.3" xref="alg1.l7.m1.3.3.cmml"><mrow id="alg1.l7.m1.3.3.3.3" xref="alg1.l7.m1.3.3.3.4.cmml"><msub id="alg1.l7.m1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l7.m1.1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.1.2.cmml">n</mi><mi mathsize="90%" id="alg1.l7.m1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.3.cmml">a</mi></msub><mo mathsize="90%" id="alg1.l7.m1.3.3.3.3.4" xref="alg1.l7.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l7.m1.2.2.2.2.2" xref="alg1.l7.m1.2.2.2.2.2.cmml"><mi mathsize="90%" id="alg1.l7.m1.2.2.2.2.2.2" xref="alg1.l7.m1.2.2.2.2.2.2.cmml">n</mi><mi mathsize="90%" id="alg1.l7.m1.2.2.2.2.2.3" xref="alg1.l7.m1.2.2.2.2.2.3.cmml">b</mi></msub><mo mathsize="90%" id="alg1.l7.m1.3.3.3.3.5" xref="alg1.l7.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l7.m1.3.3.3.3.3" xref="alg1.l7.m1.3.3.3.3.3.cmml"><mi mathsize="90%" id="alg1.l7.m1.3.3.3.3.3.2" xref="alg1.l7.m1.3.3.3.3.3.2.cmml">n</mi><mi mathsize="90%" id="alg1.l7.m1.3.3.3.3.3.3" xref="alg1.l7.m1.3.3.3.3.3.3.cmml">c</mi></msub></mrow><mo mathsize="90%" stretchy="false" id="alg1.l7.m1.3.3.4" xref="alg1.l7.m1.3.3.4.cmml">←</mo><mi id="alg1.l7.m1.3.3.5" xref="alg1.l7.m1.3.3.5.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.3b"><apply id="alg1.l7.m1.3.3.cmml" xref="alg1.l7.m1.3.3"><ci id="alg1.l7.m1.3.3.4.cmml" xref="alg1.l7.m1.3.3.4">←</ci><list id="alg1.l7.m1.3.3.3.4.cmml" xref="alg1.l7.m1.3.3.3.3"><apply id="alg1.l7.m1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l7.m1.1.1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.2">𝑛</ci><ci id="alg1.l7.m1.1.1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.3">𝑎</ci></apply><apply id="alg1.l7.m1.2.2.2.2.2.cmml" xref="alg1.l7.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.2.2.2.1.cmml" xref="alg1.l7.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l7.m1.2.2.2.2.2.2.cmml" xref="alg1.l7.m1.2.2.2.2.2.2">𝑛</ci><ci id="alg1.l7.m1.2.2.2.2.2.3.cmml" xref="alg1.l7.m1.2.2.2.2.2.3">𝑏</ci></apply><apply id="alg1.l7.m1.3.3.3.3.3.cmml" xref="alg1.l7.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l7.m1.3.3.3.3.3.1.cmml" xref="alg1.l7.m1.3.3.3.3.3">subscript</csymbol><ci id="alg1.l7.m1.3.3.3.3.3.2.cmml" xref="alg1.l7.m1.3.3.3.3.3.2">𝑛</ci><ci id="alg1.l7.m1.3.3.3.3.3.3.cmml" xref="alg1.l7.m1.3.3.3.3.3.3">𝑐</ci></apply></list><csymbol cd="latexml" id="alg1.l7.m1.3.3.5.cmml" xref="alg1.l7.m1.3.3.5">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.3c">n_{a},n_{b},n_{c}\leftarrow</annotation></semantics></math><span id="alg1.l7.3" class="ltx_text" style="font-size:90%;"> (the number of users for each group)
</span>
</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span><span id="alg1.l8.2" class="ltx_text" style="font-size:90%;">     </span><math id="alg1.l8.m1.2" class="ltx_Math" alttext="//" display="inline"><semantics id="alg1.l8.m1.2a"><mrow id="alg1.l8.m1.2.3.2" xref="alg1.l8.m1.2.3.1.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" symmetric="true" id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">/</mo><mo lspace="0em" id="alg1.l8.m1.2.3.2.1" xref="alg1.l8.m1.2.3.1.cmml">⁣</mo><mo maxsize="90%" minsize="90%" stretchy="true" symmetric="true" id="alg1.l8.m1.2.2" xref="alg1.l8.m1.2.2.cmml">/</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.2b"><list id="alg1.l8.m1.2.3.1.cmml" xref="alg1.l8.m1.2.3.2"><divide id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"></divide><divide id="alg1.l8.m1.2.2.cmml" xref="alg1.l8.m1.2.2"></divide></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.2c">//</annotation></semantics></math><span id="alg1.l8.3" class="ltx_text ltx_font_bold" style="font-size:90%;"> Homomorphic aggregation</span><span id="alg1.l8.4" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span><span id="alg1.l9.2" class="ltx_text" style="font-size:90%;">     </span><span id="alg1.l9.3" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg1.l9.4" class="ltx_text" style="font-size:90%;"> device type </span><math id="alg1.l9.m1.3" class="ltx_Math" alttext="j\in\{a,b,c\}" display="inline"><semantics id="alg1.l9.m1.3a"><mrow id="alg1.l9.m1.3.4" xref="alg1.l9.m1.3.4.cmml"><mi mathsize="90%" id="alg1.l9.m1.3.4.2" xref="alg1.l9.m1.3.4.2.cmml">j</mi><mo mathsize="90%" id="alg1.l9.m1.3.4.1" xref="alg1.l9.m1.3.4.1.cmml">∈</mo><mrow id="alg1.l9.m1.3.4.3.2" xref="alg1.l9.m1.3.4.3.1.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l9.m1.3.4.3.2.1" xref="alg1.l9.m1.3.4.3.1.cmml">{</mo><mi mathsize="90%" id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml">a</mi><mo mathsize="90%" id="alg1.l9.m1.3.4.3.2.2" xref="alg1.l9.m1.3.4.3.1.cmml">,</mo><mi mathsize="90%" id="alg1.l9.m1.2.2" xref="alg1.l9.m1.2.2.cmml">b</mi><mo mathsize="90%" id="alg1.l9.m1.3.4.3.2.3" xref="alg1.l9.m1.3.4.3.1.cmml">,</mo><mi mathsize="90%" id="alg1.l9.m1.3.3" xref="alg1.l9.m1.3.3.cmml">c</mi><mo maxsize="90%" minsize="90%" id="alg1.l9.m1.3.4.3.2.4" xref="alg1.l9.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.3b"><apply id="alg1.l9.m1.3.4.cmml" xref="alg1.l9.m1.3.4"><in id="alg1.l9.m1.3.4.1.cmml" xref="alg1.l9.m1.3.4.1"></in><ci id="alg1.l9.m1.3.4.2.cmml" xref="alg1.l9.m1.3.4.2">𝑗</ci><set id="alg1.l9.m1.3.4.3.1.cmml" xref="alg1.l9.m1.3.4.3.2"><ci id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1">𝑎</ci><ci id="alg1.l9.m1.2.2.cmml" xref="alg1.l9.m1.2.2">𝑏</ci><ci id="alg1.l9.m1.3.3.cmml" xref="alg1.l9.m1.3.3">𝑐</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.3c">j\in\{a,b,c\}</annotation></semantics></math><span id="alg1.l9.5" class="ltx_text" style="font-size:90%;">  </span><span id="alg1.l9.6" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="alg1.l9.7" class="ltx_text" style="font-size:90%;">


</span>
</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span><span id="alg1.l10.2" class="ltx_text" style="font-size:90%;">        </span><span id="alg1.l10.3" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg1.l10.4" class="ltx_text" style="font-size:90%;"> user </span><math id="alg1.l10.m1.1" class="ltx_Math" alttext="i\in U_{t}^{j}" display="inline"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi mathsize="90%" id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">i</mi><mo mathsize="90%" id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml">∈</mo><msubsup id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><mi mathsize="90%" id="alg1.l10.m1.1.1.3.2.2" xref="alg1.l10.m1.1.1.3.2.2.cmml">U</mi><mi mathsize="90%" id="alg1.l10.m1.1.1.3.2.3" xref="alg1.l10.m1.1.1.3.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.l10.m1.1.1.3.3" xref="alg1.l10.m1.1.1.3.3.cmml">j</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><in id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1"></in><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝑖</ci><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3">superscript</csymbol><apply id="alg1.l10.m1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.3.2.1.cmml" xref="alg1.l10.m1.1.1.3">subscript</csymbol><ci id="alg1.l10.m1.1.1.3.2.2.cmml" xref="alg1.l10.m1.1.1.3.2.2">𝑈</ci><ci id="alg1.l10.m1.1.1.3.2.3.cmml" xref="alg1.l10.m1.1.1.3.2.3">𝑡</ci></apply><ci id="alg1.l10.m1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">i\in U_{t}^{j}</annotation></semantics></math><span id="alg1.l10.5" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l10.6" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="alg1.l10.7" class="ltx_text" style="font-size:90%;">


</span>
</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span><span id="alg1.l11.2" class="ltx_text" style="font-size:90%;">           Pull the sub-global model </span><math id="alg1.l11.m1.1" class="ltx_Math" alttext="w_{t}^{j}" display="inline"><semantics id="alg1.l11.m1.1a"><msubsup id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi mathsize="90%" id="alg1.l11.m1.1.1.2.2" xref="alg1.l11.m1.1.1.2.2.cmml">w</mi><mi mathsize="90%" id="alg1.l11.m1.1.1.2.3" xref="alg1.l11.m1.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1">superscript</csymbol><apply id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.2.1.cmml" xref="alg1.l11.m1.1.1">subscript</csymbol><ci id="alg1.l11.m1.1.1.2.2.cmml" xref="alg1.l11.m1.1.1.2.2">𝑤</ci><ci id="alg1.l11.m1.1.1.2.3.cmml" xref="alg1.l11.m1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">w_{t}^{j}</annotation></semantics></math><span id="alg1.l11.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span><span id="alg1.l12.2" class="ltx_text" style="font-size:90%;">           </span><math id="alg1.l12.m1.4" class="ltx_Math" alttext="g_{t}^{i,j}\leftarrow\text{LocalUpdate}(w_{t}^{j},D_{i})" display="inline"><semantics id="alg1.l12.m1.4a"><mrow id="alg1.l12.m1.4.4" xref="alg1.l12.m1.4.4.cmml"><msubsup id="alg1.l12.m1.4.4.4" xref="alg1.l12.m1.4.4.4.cmml"><mi mathsize="90%" id="alg1.l12.m1.4.4.4.2.2" xref="alg1.l12.m1.4.4.4.2.2.cmml">g</mi><mi mathsize="90%" id="alg1.l12.m1.4.4.4.2.3" xref="alg1.l12.m1.4.4.4.2.3.cmml">t</mi><mrow id="alg1.l12.m1.2.2.2.4" xref="alg1.l12.m1.2.2.2.3.cmml"><mi mathsize="90%" id="alg1.l12.m1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.cmml">i</mi><mo mathsize="90%" id="alg1.l12.m1.2.2.2.4.1" xref="alg1.l12.m1.2.2.2.3.cmml">,</mo><mi mathsize="90%" id="alg1.l12.m1.2.2.2.2" xref="alg1.l12.m1.2.2.2.2.cmml">j</mi></mrow></msubsup><mo mathsize="90%" stretchy="false" id="alg1.l12.m1.4.4.3" xref="alg1.l12.m1.4.4.3.cmml">←</mo><mrow id="alg1.l12.m1.4.4.2" xref="alg1.l12.m1.4.4.2.cmml"><mtext mathsize="90%" id="alg1.l12.m1.4.4.2.4" xref="alg1.l12.m1.4.4.2.4a.cmml">LocalUpdate</mtext><mo lspace="0em" rspace="0em" id="alg1.l12.m1.4.4.2.3" xref="alg1.l12.m1.4.4.2.3.cmml">​</mo><mrow id="alg1.l12.m1.4.4.2.2.2" xref="alg1.l12.m1.4.4.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l12.m1.4.4.2.2.2.3" xref="alg1.l12.m1.4.4.2.2.3.cmml">(</mo><msubsup id="alg1.l12.m1.3.3.1.1.1.1" xref="alg1.l12.m1.3.3.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l12.m1.3.3.1.1.1.1.2.2" xref="alg1.l12.m1.3.3.1.1.1.1.2.2.cmml">w</mi><mi mathsize="90%" id="alg1.l12.m1.3.3.1.1.1.1.2.3" xref="alg1.l12.m1.3.3.1.1.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.l12.m1.3.3.1.1.1.1.3" xref="alg1.l12.m1.3.3.1.1.1.1.3.cmml">j</mi></msubsup><mo mathsize="90%" id="alg1.l12.m1.4.4.2.2.2.4" xref="alg1.l12.m1.4.4.2.2.3.cmml">,</mo><msub id="alg1.l12.m1.4.4.2.2.2.2" xref="alg1.l12.m1.4.4.2.2.2.2.cmml"><mi mathsize="90%" id="alg1.l12.m1.4.4.2.2.2.2.2" xref="alg1.l12.m1.4.4.2.2.2.2.2.cmml">D</mi><mi mathsize="90%" id="alg1.l12.m1.4.4.2.2.2.2.3" xref="alg1.l12.m1.4.4.2.2.2.2.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="alg1.l12.m1.4.4.2.2.2.5" xref="alg1.l12.m1.4.4.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.4b"><apply id="alg1.l12.m1.4.4.cmml" xref="alg1.l12.m1.4.4"><ci id="alg1.l12.m1.4.4.3.cmml" xref="alg1.l12.m1.4.4.3">←</ci><apply id="alg1.l12.m1.4.4.4.cmml" xref="alg1.l12.m1.4.4.4"><csymbol cd="ambiguous" id="alg1.l12.m1.4.4.4.1.cmml" xref="alg1.l12.m1.4.4.4">superscript</csymbol><apply id="alg1.l12.m1.4.4.4.2.cmml" xref="alg1.l12.m1.4.4.4"><csymbol cd="ambiguous" id="alg1.l12.m1.4.4.4.2.1.cmml" xref="alg1.l12.m1.4.4.4">subscript</csymbol><ci id="alg1.l12.m1.4.4.4.2.2.cmml" xref="alg1.l12.m1.4.4.4.2.2">𝑔</ci><ci id="alg1.l12.m1.4.4.4.2.3.cmml" xref="alg1.l12.m1.4.4.4.2.3">𝑡</ci></apply><list id="alg1.l12.m1.2.2.2.3.cmml" xref="alg1.l12.m1.2.2.2.4"><ci id="alg1.l12.m1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1">𝑖</ci><ci id="alg1.l12.m1.2.2.2.2.cmml" xref="alg1.l12.m1.2.2.2.2">𝑗</ci></list></apply><apply id="alg1.l12.m1.4.4.2.cmml" xref="alg1.l12.m1.4.4.2"><times id="alg1.l12.m1.4.4.2.3.cmml" xref="alg1.l12.m1.4.4.2.3"></times><ci id="alg1.l12.m1.4.4.2.4a.cmml" xref="alg1.l12.m1.4.4.2.4"><mtext mathsize="90%" id="alg1.l12.m1.4.4.2.4.cmml" xref="alg1.l12.m1.4.4.2.4">LocalUpdate</mtext></ci><interval closure="open" id="alg1.l12.m1.4.4.2.2.3.cmml" xref="alg1.l12.m1.4.4.2.2.2"><apply id="alg1.l12.m1.3.3.1.1.1.1.cmml" xref="alg1.l12.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l12.m1.3.3.1.1.1.1">superscript</csymbol><apply id="alg1.l12.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l12.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.3.3.1.1.1.1.2.1.cmml" xref="alg1.l12.m1.3.3.1.1.1.1">subscript</csymbol><ci id="alg1.l12.m1.3.3.1.1.1.1.2.2.cmml" xref="alg1.l12.m1.3.3.1.1.1.1.2.2">𝑤</ci><ci id="alg1.l12.m1.3.3.1.1.1.1.2.3.cmml" xref="alg1.l12.m1.3.3.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l12.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l12.m1.3.3.1.1.1.1.3">𝑗</ci></apply><apply id="alg1.l12.m1.4.4.2.2.2.2.cmml" xref="alg1.l12.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l12.m1.4.4.2.2.2.2.1.cmml" xref="alg1.l12.m1.4.4.2.2.2.2">subscript</csymbol><ci id="alg1.l12.m1.4.4.2.2.2.2.2.cmml" xref="alg1.l12.m1.4.4.2.2.2.2.2">𝐷</ci><ci id="alg1.l12.m1.4.4.2.2.2.2.3.cmml" xref="alg1.l12.m1.4.4.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.4c">g_{t}^{i,j}\leftarrow\text{LocalUpdate}(w_{t}^{j},D_{i})</annotation></semantics></math><span id="alg1.l12.3" class="ltx_text" style="font-size:90%;">  </span><math id="alg1.l12.m2.1" class="ltx_Math" alttext="\triangleright D_{i}" display="inline"><semantics id="alg1.l12.m2.1a"><mrow id="alg1.l12.m2.1.1" xref="alg1.l12.m2.1.1.cmml"><mo mathsize="90%" rspace="0em" id="alg1.l12.m2.1.1a" xref="alg1.l12.m2.1.1.cmml">▷</mo><msub id="alg1.l12.m2.1.1.2" xref="alg1.l12.m2.1.1.2.cmml"><mi mathsize="90%" id="alg1.l12.m2.1.1.2.2" xref="alg1.l12.m2.1.1.2.2.cmml">D</mi><mi mathsize="90%" id="alg1.l12.m2.1.1.2.3" xref="alg1.l12.m2.1.1.2.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m2.1b"><apply id="alg1.l12.m2.1.1.cmml" xref="alg1.l12.m2.1.1"><ci id="alg1.l12.m2.1.1.1.cmml" xref="alg1.l12.m2.1.1">▷</ci><apply id="alg1.l12.m2.1.1.2.cmml" xref="alg1.l12.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l12.m2.1.1.2.1.cmml" xref="alg1.l12.m2.1.1.2">subscript</csymbol><ci id="alg1.l12.m2.1.1.2.2.cmml" xref="alg1.l12.m2.1.1.2.2">𝐷</ci><ci id="alg1.l12.m2.1.1.2.3.cmml" xref="alg1.l12.m2.1.1.2.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m2.1c">\triangleright D_{i}</annotation></semantics></math><span id="alg1.l12.4" class="ltx_text" style="font-size:90%;"> is the local dataset
</span>
</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span><span id="alg1.l13.2" class="ltx_text" style="font-size:90%;">        </span><span id="alg1.l13.3" class="ltx_text ltx_font_bold" style="font-size:90%;">end</span><span id="alg1.l13.4" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l13.5" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span>
</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span><span id="alg1.l14.2" class="ltx_text" style="font-size:90%;">        </span><math id="alg1.l14.m1.3" class="ltx_Math" alttext="g_{t}^{j}\leftarrow\frac{1}{|U_{t}^{j}|}\sum_{i\in U_{t}^{j}}g_{t}^{i,j}" display="inline"><semantics id="alg1.l14.m1.3a"><mrow id="alg1.l14.m1.3.4" xref="alg1.l14.m1.3.4.cmml"><msubsup id="alg1.l14.m1.3.4.2" xref="alg1.l14.m1.3.4.2.cmml"><mi mathsize="90%" id="alg1.l14.m1.3.4.2.2.2" xref="alg1.l14.m1.3.4.2.2.2.cmml">g</mi><mi mathsize="90%" id="alg1.l14.m1.3.4.2.2.3" xref="alg1.l14.m1.3.4.2.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.l14.m1.3.4.2.3" xref="alg1.l14.m1.3.4.2.3.cmml">j</mi></msubsup><mo mathsize="90%" stretchy="false" id="alg1.l14.m1.3.4.1" xref="alg1.l14.m1.3.4.1.cmml">←</mo><mrow id="alg1.l14.m1.3.4.3" xref="alg1.l14.m1.3.4.3.cmml"><mfrac id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><mn mathsize="90%" id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml">1</mn><mrow id="alg1.l14.m1.1.1.1.1" xref="alg1.l14.m1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l14.m1.1.1.1.1.2" xref="alg1.l14.m1.1.1.1.2.1.cmml">|</mo><msubsup id="alg1.l14.m1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l14.m1.1.1.1.1.1.2.2" xref="alg1.l14.m1.1.1.1.1.1.2.2.cmml">U</mi><mi mathsize="90%" id="alg1.l14.m1.1.1.1.1.1.2.3" xref="alg1.l14.m1.1.1.1.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.l14.m1.1.1.1.1.1.3" xref="alg1.l14.m1.1.1.1.1.1.3.cmml">j</mi></msubsup><mo maxsize="90%" minsize="90%" id="alg1.l14.m1.1.1.1.1.3" xref="alg1.l14.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg1.l14.m1.3.4.3.1" xref="alg1.l14.m1.3.4.3.1.cmml">​</mo><mrow id="alg1.l14.m1.3.4.3.2" xref="alg1.l14.m1.3.4.3.2.cmml"><msub id="alg1.l14.m1.3.4.3.2.1" xref="alg1.l14.m1.3.4.3.2.1.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" id="alg1.l14.m1.3.4.3.2.1.2" xref="alg1.l14.m1.3.4.3.2.1.2.cmml">∑</mo><mrow id="alg1.l14.m1.3.4.3.2.1.3" xref="alg1.l14.m1.3.4.3.2.1.3.cmml"><mi mathsize="90%" id="alg1.l14.m1.3.4.3.2.1.3.2" xref="alg1.l14.m1.3.4.3.2.1.3.2.cmml">i</mi><mo mathsize="90%" id="alg1.l14.m1.3.4.3.2.1.3.1" xref="alg1.l14.m1.3.4.3.2.1.3.1.cmml">∈</mo><msubsup id="alg1.l14.m1.3.4.3.2.1.3.3" xref="alg1.l14.m1.3.4.3.2.1.3.3.cmml"><mi mathsize="90%" id="alg1.l14.m1.3.4.3.2.1.3.3.2.2" xref="alg1.l14.m1.3.4.3.2.1.3.3.2.2.cmml">U</mi><mi mathsize="90%" id="alg1.l14.m1.3.4.3.2.1.3.3.2.3" xref="alg1.l14.m1.3.4.3.2.1.3.3.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.l14.m1.3.4.3.2.1.3.3.3" xref="alg1.l14.m1.3.4.3.2.1.3.3.3.cmml">j</mi></msubsup></mrow></msub><msubsup id="alg1.l14.m1.3.4.3.2.2" xref="alg1.l14.m1.3.4.3.2.2.cmml"><mi mathsize="90%" id="alg1.l14.m1.3.4.3.2.2.2.2" xref="alg1.l14.m1.3.4.3.2.2.2.2.cmml">g</mi><mi mathsize="90%" id="alg1.l14.m1.3.4.3.2.2.2.3" xref="alg1.l14.m1.3.4.3.2.2.2.3.cmml">t</mi><mrow id="alg1.l14.m1.3.3.2.4" xref="alg1.l14.m1.3.3.2.3.cmml"><mi mathsize="90%" id="alg1.l14.m1.2.2.1.1" xref="alg1.l14.m1.2.2.1.1.cmml">i</mi><mo mathsize="90%" id="alg1.l14.m1.3.3.2.4.1" xref="alg1.l14.m1.3.3.2.3.cmml">,</mo><mi mathsize="90%" id="alg1.l14.m1.3.3.2.2" xref="alg1.l14.m1.3.3.2.2.cmml">j</mi></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.3b"><apply id="alg1.l14.m1.3.4.cmml" xref="alg1.l14.m1.3.4"><ci id="alg1.l14.m1.3.4.1.cmml" xref="alg1.l14.m1.3.4.1">←</ci><apply id="alg1.l14.m1.3.4.2.cmml" xref="alg1.l14.m1.3.4.2"><csymbol cd="ambiguous" id="alg1.l14.m1.3.4.2.1.cmml" xref="alg1.l14.m1.3.4.2">superscript</csymbol><apply id="alg1.l14.m1.3.4.2.2.cmml" xref="alg1.l14.m1.3.4.2"><csymbol cd="ambiguous" id="alg1.l14.m1.3.4.2.2.1.cmml" xref="alg1.l14.m1.3.4.2">subscript</csymbol><ci id="alg1.l14.m1.3.4.2.2.2.cmml" xref="alg1.l14.m1.3.4.2.2.2">𝑔</ci><ci id="alg1.l14.m1.3.4.2.2.3.cmml" xref="alg1.l14.m1.3.4.2.2.3">𝑡</ci></apply><ci id="alg1.l14.m1.3.4.2.3.cmml" xref="alg1.l14.m1.3.4.2.3">𝑗</ci></apply><apply id="alg1.l14.m1.3.4.3.cmml" xref="alg1.l14.m1.3.4.3"><times id="alg1.l14.m1.3.4.3.1.cmml" xref="alg1.l14.m1.3.4.3.1"></times><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><divide id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1"></divide><cn type="integer" id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3">1</cn><apply id="alg1.l14.m1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.1"><abs id="alg1.l14.m1.1.1.1.2.1.cmml" xref="alg1.l14.m1.1.1.1.1.2"></abs><apply id="alg1.l14.m1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l14.m1.1.1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l14.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l14.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.2.2">𝑈</ci><ci id="alg1.l14.m1.1.1.1.1.1.2.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l14.m1.1.1.1.1.1.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply><apply id="alg1.l14.m1.3.4.3.2.cmml" xref="alg1.l14.m1.3.4.3.2"><apply id="alg1.l14.m1.3.4.3.2.1.cmml" xref="alg1.l14.m1.3.4.3.2.1"><csymbol cd="ambiguous" id="alg1.l14.m1.3.4.3.2.1.1.cmml" xref="alg1.l14.m1.3.4.3.2.1">subscript</csymbol><sum id="alg1.l14.m1.3.4.3.2.1.2.cmml" xref="alg1.l14.m1.3.4.3.2.1.2"></sum><apply id="alg1.l14.m1.3.4.3.2.1.3.cmml" xref="alg1.l14.m1.3.4.3.2.1.3"><in id="alg1.l14.m1.3.4.3.2.1.3.1.cmml" xref="alg1.l14.m1.3.4.3.2.1.3.1"></in><ci id="alg1.l14.m1.3.4.3.2.1.3.2.cmml" xref="alg1.l14.m1.3.4.3.2.1.3.2">𝑖</ci><apply id="alg1.l14.m1.3.4.3.2.1.3.3.cmml" xref="alg1.l14.m1.3.4.3.2.1.3.3"><csymbol cd="ambiguous" id="alg1.l14.m1.3.4.3.2.1.3.3.1.cmml" xref="alg1.l14.m1.3.4.3.2.1.3.3">superscript</csymbol><apply id="alg1.l14.m1.3.4.3.2.1.3.3.2.cmml" xref="alg1.l14.m1.3.4.3.2.1.3.3"><csymbol cd="ambiguous" id="alg1.l14.m1.3.4.3.2.1.3.3.2.1.cmml" xref="alg1.l14.m1.3.4.3.2.1.3.3">subscript</csymbol><ci id="alg1.l14.m1.3.4.3.2.1.3.3.2.2.cmml" xref="alg1.l14.m1.3.4.3.2.1.3.3.2.2">𝑈</ci><ci id="alg1.l14.m1.3.4.3.2.1.3.3.2.3.cmml" xref="alg1.l14.m1.3.4.3.2.1.3.3.2.3">𝑡</ci></apply><ci id="alg1.l14.m1.3.4.3.2.1.3.3.3.cmml" xref="alg1.l14.m1.3.4.3.2.1.3.3.3">𝑗</ci></apply></apply></apply><apply id="alg1.l14.m1.3.4.3.2.2.cmml" xref="alg1.l14.m1.3.4.3.2.2"><csymbol cd="ambiguous" id="alg1.l14.m1.3.4.3.2.2.1.cmml" xref="alg1.l14.m1.3.4.3.2.2">superscript</csymbol><apply id="alg1.l14.m1.3.4.3.2.2.2.cmml" xref="alg1.l14.m1.3.4.3.2.2"><csymbol cd="ambiguous" id="alg1.l14.m1.3.4.3.2.2.2.1.cmml" xref="alg1.l14.m1.3.4.3.2.2">subscript</csymbol><ci id="alg1.l14.m1.3.4.3.2.2.2.2.cmml" xref="alg1.l14.m1.3.4.3.2.2.2.2">𝑔</ci><ci id="alg1.l14.m1.3.4.3.2.2.2.3.cmml" xref="alg1.l14.m1.3.4.3.2.2.2.3">𝑡</ci></apply><list id="alg1.l14.m1.3.3.2.3.cmml" xref="alg1.l14.m1.3.3.2.4"><ci id="alg1.l14.m1.2.2.1.1.cmml" xref="alg1.l14.m1.2.2.1.1">𝑖</ci><ci id="alg1.l14.m1.3.3.2.2.cmml" xref="alg1.l14.m1.3.3.2.2">𝑗</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.3c">g_{t}^{j}\leftarrow\frac{1}{|U_{t}^{j}|}\sum_{i\in U_{t}^{j}}g_{t}^{i,j}</annotation></semantics></math><span id="alg1.l14.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span><span id="alg1.l15.2" class="ltx_text" style="font-size:90%;">        </span><span id="alg1.l15.3" class="ltx_text ltx_font_bold" style="font-size:90%;">if</span><span id="alg1.l15.4" class="ltx_text" style="font-size:90%;"> </span><math id="alg1.l15.m1.1" class="ltx_Math" alttext="j" display="inline"><semantics id="alg1.l15.m1.1a"><mi mathsize="90%" id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><ci id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">j</annotation></semantics></math><span id="alg1.l15.5" class="ltx_text" style="font-size:90%;"> is not </span><math id="alg1.l15.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="alg1.l15.m2.1a"><mi mathsize="90%" id="alg1.l15.m2.1.1" xref="alg1.l15.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="alg1.l15.m2.1b"><ci id="alg1.l15.m2.1.1.cmml" xref="alg1.l15.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m2.1c">c</annotation></semantics></math><span id="alg1.l15.6" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l15.7" class="ltx_text ltx_font_bold" style="font-size:90%;">then</span><span id="alg1.l15.8" class="ltx_text" style="font-size:90%;">

 
</span>
</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span><span id="alg1.l16.2" class="ltx_text" style="font-size:90%;">           </span><math id="alg1.l16.m1.1" class="ltx_Math" alttext="k\leftarrow" display="inline"><semantics id="alg1.l16.m1.1a"><mrow id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml"><mi mathsize="90%" id="alg1.l16.m1.1.1.2" xref="alg1.l16.m1.1.1.2.cmml">k</mi><mo mathsize="90%" stretchy="false" id="alg1.l16.m1.1.1.1" xref="alg1.l16.m1.1.1.1.cmml">←</mo><mi id="alg1.l16.m1.1.1.3" xref="alg1.l16.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><apply id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1"><ci id="alg1.l16.m1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1">←</ci><ci id="alg1.l16.m1.1.1.2.cmml" xref="alg1.l16.m1.1.1.2">𝑘</ci><csymbol cd="latexml" id="alg1.l16.m1.1.1.3.cmml" xref="alg1.l16.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">k\leftarrow</annotation></semantics></math><span id="alg1.l16.3" class="ltx_text" style="font-size:90%;"> (the device type that is greater than </span><math id="alg1.l16.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="alg1.l16.m2.1a"><mi mathsize="90%" id="alg1.l16.m2.1.1" xref="alg1.l16.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="alg1.l16.m2.1b"><ci id="alg1.l16.m2.1.1.cmml" xref="alg1.l16.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m2.1c">j</annotation></semantics></math><span id="alg1.l16.4" class="ltx_text" style="font-size:90%;"> )
</span>
</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span><span id="alg1.l17.2" class="ltx_text" style="font-size:90%;">           </span><math id="alg1.l17.m1.5" class="ltx_Math" alttext="g_{t}^{j,L_{j}}\leftarrow\beta\cdot m_{t-1}^{k}+(1-\beta)\cdot g_{t}^{j,L_{j}}" display="inline"><semantics id="alg1.l17.m1.5a"><mrow id="alg1.l17.m1.5.5" xref="alg1.l17.m1.5.5.cmml"><msubsup id="alg1.l17.m1.5.5.3" xref="alg1.l17.m1.5.5.3.cmml"><mi mathsize="90%" id="alg1.l17.m1.5.5.3.2.2" xref="alg1.l17.m1.5.5.3.2.2.cmml">g</mi><mi mathsize="90%" id="alg1.l17.m1.5.5.3.2.3" xref="alg1.l17.m1.5.5.3.2.3.cmml">t</mi><mrow id="alg1.l17.m1.2.2.2.2" xref="alg1.l17.m1.2.2.2.3.cmml"><mi mathsize="90%" id="alg1.l17.m1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.cmml">j</mi><mo mathsize="90%" id="alg1.l17.m1.2.2.2.2.2" xref="alg1.l17.m1.2.2.2.3.cmml">,</mo><msub id="alg1.l17.m1.2.2.2.2.1" xref="alg1.l17.m1.2.2.2.2.1.cmml"><mi mathsize="90%" id="alg1.l17.m1.2.2.2.2.1.2" xref="alg1.l17.m1.2.2.2.2.1.2.cmml">L</mi><mi mathsize="90%" id="alg1.l17.m1.2.2.2.2.1.3" xref="alg1.l17.m1.2.2.2.2.1.3.cmml">j</mi></msub></mrow></msubsup><mo mathsize="90%" stretchy="false" id="alg1.l17.m1.5.5.2" xref="alg1.l17.m1.5.5.2.cmml">←</mo><mrow id="alg1.l17.m1.5.5.1" xref="alg1.l17.m1.5.5.1.cmml"><mrow id="alg1.l17.m1.5.5.1.3" xref="alg1.l17.m1.5.5.1.3.cmml"><mi mathsize="90%" id="alg1.l17.m1.5.5.1.3.2" xref="alg1.l17.m1.5.5.1.3.2.cmml">β</mi><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="alg1.l17.m1.5.5.1.3.1" xref="alg1.l17.m1.5.5.1.3.1.cmml">⋅</mo><msubsup id="alg1.l17.m1.5.5.1.3.3" xref="alg1.l17.m1.5.5.1.3.3.cmml"><mi mathsize="90%" id="alg1.l17.m1.5.5.1.3.3.2.2" xref="alg1.l17.m1.5.5.1.3.3.2.2.cmml">m</mi><mrow id="alg1.l17.m1.5.5.1.3.3.2.3" xref="alg1.l17.m1.5.5.1.3.3.2.3.cmml"><mi mathsize="90%" id="alg1.l17.m1.5.5.1.3.3.2.3.2" xref="alg1.l17.m1.5.5.1.3.3.2.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.l17.m1.5.5.1.3.3.2.3.1" xref="alg1.l17.m1.5.5.1.3.3.2.3.1.cmml">−</mo><mn mathsize="90%" id="alg1.l17.m1.5.5.1.3.3.2.3.3" xref="alg1.l17.m1.5.5.1.3.3.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="alg1.l17.m1.5.5.1.3.3.3" xref="alg1.l17.m1.5.5.1.3.3.3.cmml">k</mi></msubsup></mrow><mo mathsize="90%" id="alg1.l17.m1.5.5.1.2" xref="alg1.l17.m1.5.5.1.2.cmml">+</mo><mrow id="alg1.l17.m1.5.5.1.1" xref="alg1.l17.m1.5.5.1.1.cmml"><mrow id="alg1.l17.m1.5.5.1.1.1.1" xref="alg1.l17.m1.5.5.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l17.m1.5.5.1.1.1.1.2" xref="alg1.l17.m1.5.5.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l17.m1.5.5.1.1.1.1.1" xref="alg1.l17.m1.5.5.1.1.1.1.1.cmml"><mn mathsize="90%" id="alg1.l17.m1.5.5.1.1.1.1.1.2" xref="alg1.l17.m1.5.5.1.1.1.1.1.2.cmml">1</mn><mo mathsize="90%" id="alg1.l17.m1.5.5.1.1.1.1.1.1" xref="alg1.l17.m1.5.5.1.1.1.1.1.1.cmml">−</mo><mi mathsize="90%" id="alg1.l17.m1.5.5.1.1.1.1.1.3" xref="alg1.l17.m1.5.5.1.1.1.1.1.3.cmml">β</mi></mrow><mo maxsize="90%" minsize="90%" rspace="0.055em" id="alg1.l17.m1.5.5.1.1.1.1.3" xref="alg1.l17.m1.5.5.1.1.1.1.1.cmml">)</mo></mrow><mo mathsize="90%" rspace="0.222em" id="alg1.l17.m1.5.5.1.1.2" xref="alg1.l17.m1.5.5.1.1.2.cmml">⋅</mo><msubsup id="alg1.l17.m1.5.5.1.1.3" xref="alg1.l17.m1.5.5.1.1.3.cmml"><mi mathsize="90%" id="alg1.l17.m1.5.5.1.1.3.2.2" xref="alg1.l17.m1.5.5.1.1.3.2.2.cmml">g</mi><mi mathsize="90%" id="alg1.l17.m1.5.5.1.1.3.2.3" xref="alg1.l17.m1.5.5.1.1.3.2.3.cmml">t</mi><mrow id="alg1.l17.m1.4.4.2.2" xref="alg1.l17.m1.4.4.2.3.cmml"><mi mathsize="90%" id="alg1.l17.m1.3.3.1.1" xref="alg1.l17.m1.3.3.1.1.cmml">j</mi><mo mathsize="90%" id="alg1.l17.m1.4.4.2.2.2" xref="alg1.l17.m1.4.4.2.3.cmml">,</mo><msub id="alg1.l17.m1.4.4.2.2.1" xref="alg1.l17.m1.4.4.2.2.1.cmml"><mi mathsize="90%" id="alg1.l17.m1.4.4.2.2.1.2" xref="alg1.l17.m1.4.4.2.2.1.2.cmml">L</mi><mi mathsize="90%" id="alg1.l17.m1.4.4.2.2.1.3" xref="alg1.l17.m1.4.4.2.2.1.3.cmml">j</mi></msub></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.5b"><apply id="alg1.l17.m1.5.5.cmml" xref="alg1.l17.m1.5.5"><ci id="alg1.l17.m1.5.5.2.cmml" xref="alg1.l17.m1.5.5.2">←</ci><apply id="alg1.l17.m1.5.5.3.cmml" xref="alg1.l17.m1.5.5.3"><csymbol cd="ambiguous" id="alg1.l17.m1.5.5.3.1.cmml" xref="alg1.l17.m1.5.5.3">superscript</csymbol><apply id="alg1.l17.m1.5.5.3.2.cmml" xref="alg1.l17.m1.5.5.3"><csymbol cd="ambiguous" id="alg1.l17.m1.5.5.3.2.1.cmml" xref="alg1.l17.m1.5.5.3">subscript</csymbol><ci id="alg1.l17.m1.5.5.3.2.2.cmml" xref="alg1.l17.m1.5.5.3.2.2">𝑔</ci><ci id="alg1.l17.m1.5.5.3.2.3.cmml" xref="alg1.l17.m1.5.5.3.2.3">𝑡</ci></apply><list id="alg1.l17.m1.2.2.2.3.cmml" xref="alg1.l17.m1.2.2.2.2"><ci id="alg1.l17.m1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1">𝑗</ci><apply id="alg1.l17.m1.2.2.2.2.1.cmml" xref="alg1.l17.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="alg1.l17.m1.2.2.2.2.1.1.cmml" xref="alg1.l17.m1.2.2.2.2.1">subscript</csymbol><ci id="alg1.l17.m1.2.2.2.2.1.2.cmml" xref="alg1.l17.m1.2.2.2.2.1.2">𝐿</ci><ci id="alg1.l17.m1.2.2.2.2.1.3.cmml" xref="alg1.l17.m1.2.2.2.2.1.3">𝑗</ci></apply></list></apply><apply id="alg1.l17.m1.5.5.1.cmml" xref="alg1.l17.m1.5.5.1"><plus id="alg1.l17.m1.5.5.1.2.cmml" xref="alg1.l17.m1.5.5.1.2"></plus><apply id="alg1.l17.m1.5.5.1.3.cmml" xref="alg1.l17.m1.5.5.1.3"><ci id="alg1.l17.m1.5.5.1.3.1.cmml" xref="alg1.l17.m1.5.5.1.3.1">⋅</ci><ci id="alg1.l17.m1.5.5.1.3.2.cmml" xref="alg1.l17.m1.5.5.1.3.2">𝛽</ci><apply id="alg1.l17.m1.5.5.1.3.3.cmml" xref="alg1.l17.m1.5.5.1.3.3"><csymbol cd="ambiguous" id="alg1.l17.m1.5.5.1.3.3.1.cmml" xref="alg1.l17.m1.5.5.1.3.3">superscript</csymbol><apply id="alg1.l17.m1.5.5.1.3.3.2.cmml" xref="alg1.l17.m1.5.5.1.3.3"><csymbol cd="ambiguous" id="alg1.l17.m1.5.5.1.3.3.2.1.cmml" xref="alg1.l17.m1.5.5.1.3.3">subscript</csymbol><ci id="alg1.l17.m1.5.5.1.3.3.2.2.cmml" xref="alg1.l17.m1.5.5.1.3.3.2.2">𝑚</ci><apply id="alg1.l17.m1.5.5.1.3.3.2.3.cmml" xref="alg1.l17.m1.5.5.1.3.3.2.3"><minus id="alg1.l17.m1.5.5.1.3.3.2.3.1.cmml" xref="alg1.l17.m1.5.5.1.3.3.2.3.1"></minus><ci id="alg1.l17.m1.5.5.1.3.3.2.3.2.cmml" xref="alg1.l17.m1.5.5.1.3.3.2.3.2">𝑡</ci><cn type="integer" id="alg1.l17.m1.5.5.1.3.3.2.3.3.cmml" xref="alg1.l17.m1.5.5.1.3.3.2.3.3">1</cn></apply></apply><ci id="alg1.l17.m1.5.5.1.3.3.3.cmml" xref="alg1.l17.m1.5.5.1.3.3.3">𝑘</ci></apply></apply><apply id="alg1.l17.m1.5.5.1.1.cmml" xref="alg1.l17.m1.5.5.1.1"><ci id="alg1.l17.m1.5.5.1.1.2.cmml" xref="alg1.l17.m1.5.5.1.1.2">⋅</ci><apply id="alg1.l17.m1.5.5.1.1.1.1.1.cmml" xref="alg1.l17.m1.5.5.1.1.1.1"><minus id="alg1.l17.m1.5.5.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.5.5.1.1.1.1.1.1"></minus><cn type="integer" id="alg1.l17.m1.5.5.1.1.1.1.1.2.cmml" xref="alg1.l17.m1.5.5.1.1.1.1.1.2">1</cn><ci id="alg1.l17.m1.5.5.1.1.1.1.1.3.cmml" xref="alg1.l17.m1.5.5.1.1.1.1.1.3">𝛽</ci></apply><apply id="alg1.l17.m1.5.5.1.1.3.cmml" xref="alg1.l17.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="alg1.l17.m1.5.5.1.1.3.1.cmml" xref="alg1.l17.m1.5.5.1.1.3">superscript</csymbol><apply id="alg1.l17.m1.5.5.1.1.3.2.cmml" xref="alg1.l17.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="alg1.l17.m1.5.5.1.1.3.2.1.cmml" xref="alg1.l17.m1.5.5.1.1.3">subscript</csymbol><ci id="alg1.l17.m1.5.5.1.1.3.2.2.cmml" xref="alg1.l17.m1.5.5.1.1.3.2.2">𝑔</ci><ci id="alg1.l17.m1.5.5.1.1.3.2.3.cmml" xref="alg1.l17.m1.5.5.1.1.3.2.3">𝑡</ci></apply><list id="alg1.l17.m1.4.4.2.3.cmml" xref="alg1.l17.m1.4.4.2.2"><ci id="alg1.l17.m1.3.3.1.1.cmml" xref="alg1.l17.m1.3.3.1.1">𝑗</ci><apply id="alg1.l17.m1.4.4.2.2.1.cmml" xref="alg1.l17.m1.4.4.2.2.1"><csymbol cd="ambiguous" id="alg1.l17.m1.4.4.2.2.1.1.cmml" xref="alg1.l17.m1.4.4.2.2.1">subscript</csymbol><ci id="alg1.l17.m1.4.4.2.2.1.2.cmml" xref="alg1.l17.m1.4.4.2.2.1.2">𝐿</ci><ci id="alg1.l17.m1.4.4.2.2.1.3.cmml" xref="alg1.l17.m1.4.4.2.2.1.3">𝑗</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.5c">g_{t}^{j,L_{j}}\leftarrow\beta\cdot m_{t-1}^{k}+(1-\beta)\cdot g_{t}^{j,L_{j}}</annotation></semantics></math><span id="alg1.l17.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l18.1.1.1" class="ltx_text" style="font-size:80%;">18:</span></span><span id="alg1.l18.2" class="ltx_text" style="font-size:90%;">        </span><span id="alg1.l18.3" class="ltx_text ltx_font_bold" style="font-size:90%;">end</span><span id="alg1.l18.4" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l18.5" class="ltx_text ltx_font_bold" style="font-size:90%;">if</span>
</div>
<div id="alg1.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l19.1.1.1" class="ltx_text" style="font-size:80%;">19:</span></span><span id="alg1.l19.2" class="ltx_text" style="font-size:90%;">        </span><math id="alg1.l19.m1.2" class="ltx_Math" alttext="w_{t+1}^{j}\leftarrow\text{FedAdam}(g_{t}^{j},w_{t}^{j})" display="inline"><semantics id="alg1.l19.m1.2a"><mrow id="alg1.l19.m1.2.2" xref="alg1.l19.m1.2.2.cmml"><msubsup id="alg1.l19.m1.2.2.4" xref="alg1.l19.m1.2.2.4.cmml"><mi mathsize="90%" id="alg1.l19.m1.2.2.4.2.2" xref="alg1.l19.m1.2.2.4.2.2.cmml">w</mi><mrow id="alg1.l19.m1.2.2.4.2.3" xref="alg1.l19.m1.2.2.4.2.3.cmml"><mi mathsize="90%" id="alg1.l19.m1.2.2.4.2.3.2" xref="alg1.l19.m1.2.2.4.2.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.l19.m1.2.2.4.2.3.1" xref="alg1.l19.m1.2.2.4.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.l19.m1.2.2.4.2.3.3" xref="alg1.l19.m1.2.2.4.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="alg1.l19.m1.2.2.4.3" xref="alg1.l19.m1.2.2.4.3.cmml">j</mi></msubsup><mo mathsize="90%" stretchy="false" id="alg1.l19.m1.2.2.3" xref="alg1.l19.m1.2.2.3.cmml">←</mo><mrow id="alg1.l19.m1.2.2.2" xref="alg1.l19.m1.2.2.2.cmml"><mtext mathsize="90%" id="alg1.l19.m1.2.2.2.4" xref="alg1.l19.m1.2.2.2.4a.cmml">FedAdam</mtext><mo lspace="0em" rspace="0em" id="alg1.l19.m1.2.2.2.3" xref="alg1.l19.m1.2.2.2.3.cmml">​</mo><mrow id="alg1.l19.m1.2.2.2.2.2" xref="alg1.l19.m1.2.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l19.m1.2.2.2.2.2.3" xref="alg1.l19.m1.2.2.2.2.3.cmml">(</mo><msubsup id="alg1.l19.m1.1.1.1.1.1.1" xref="alg1.l19.m1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l19.m1.1.1.1.1.1.1.2.2" xref="alg1.l19.m1.1.1.1.1.1.1.2.2.cmml">g</mi><mi mathsize="90%" id="alg1.l19.m1.1.1.1.1.1.1.2.3" xref="alg1.l19.m1.1.1.1.1.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.l19.m1.1.1.1.1.1.1.3" xref="alg1.l19.m1.1.1.1.1.1.1.3.cmml">j</mi></msubsup><mo mathsize="90%" id="alg1.l19.m1.2.2.2.2.2.4" xref="alg1.l19.m1.2.2.2.2.3.cmml">,</mo><msubsup id="alg1.l19.m1.2.2.2.2.2.2" xref="alg1.l19.m1.2.2.2.2.2.2.cmml"><mi mathsize="90%" id="alg1.l19.m1.2.2.2.2.2.2.2.2" xref="alg1.l19.m1.2.2.2.2.2.2.2.2.cmml">w</mi><mi mathsize="90%" id="alg1.l19.m1.2.2.2.2.2.2.2.3" xref="alg1.l19.m1.2.2.2.2.2.2.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.l19.m1.2.2.2.2.2.2.3" xref="alg1.l19.m1.2.2.2.2.2.2.3.cmml">j</mi></msubsup><mo maxsize="90%" minsize="90%" id="alg1.l19.m1.2.2.2.2.2.5" xref="alg1.l19.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.2b"><apply id="alg1.l19.m1.2.2.cmml" xref="alg1.l19.m1.2.2"><ci id="alg1.l19.m1.2.2.3.cmml" xref="alg1.l19.m1.2.2.3">←</ci><apply id="alg1.l19.m1.2.2.4.cmml" xref="alg1.l19.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l19.m1.2.2.4.1.cmml" xref="alg1.l19.m1.2.2.4">superscript</csymbol><apply id="alg1.l19.m1.2.2.4.2.cmml" xref="alg1.l19.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l19.m1.2.2.4.2.1.cmml" xref="alg1.l19.m1.2.2.4">subscript</csymbol><ci id="alg1.l19.m1.2.2.4.2.2.cmml" xref="alg1.l19.m1.2.2.4.2.2">𝑤</ci><apply id="alg1.l19.m1.2.2.4.2.3.cmml" xref="alg1.l19.m1.2.2.4.2.3"><plus id="alg1.l19.m1.2.2.4.2.3.1.cmml" xref="alg1.l19.m1.2.2.4.2.3.1"></plus><ci id="alg1.l19.m1.2.2.4.2.3.2.cmml" xref="alg1.l19.m1.2.2.4.2.3.2">𝑡</ci><cn type="integer" id="alg1.l19.m1.2.2.4.2.3.3.cmml" xref="alg1.l19.m1.2.2.4.2.3.3">1</cn></apply></apply><ci id="alg1.l19.m1.2.2.4.3.cmml" xref="alg1.l19.m1.2.2.4.3">𝑗</ci></apply><apply id="alg1.l19.m1.2.2.2.cmml" xref="alg1.l19.m1.2.2.2"><times id="alg1.l19.m1.2.2.2.3.cmml" xref="alg1.l19.m1.2.2.2.3"></times><ci id="alg1.l19.m1.2.2.2.4a.cmml" xref="alg1.l19.m1.2.2.2.4"><mtext mathsize="90%" id="alg1.l19.m1.2.2.2.4.cmml" xref="alg1.l19.m1.2.2.2.4">FedAdam</mtext></ci><interval closure="open" id="alg1.l19.m1.2.2.2.2.3.cmml" xref="alg1.l19.m1.2.2.2.2.2"><apply id="alg1.l19.m1.1.1.1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l19.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l19.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l19.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l19.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.2.2">𝑔</ci><ci id="alg1.l19.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l19.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="alg1.l19.m1.2.2.2.2.2.2.cmml" xref="alg1.l19.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l19.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l19.m1.2.2.2.2.2.2">superscript</csymbol><apply id="alg1.l19.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l19.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l19.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l19.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l19.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l19.m1.2.2.2.2.2.2.2.2">𝑤</ci><ci id="alg1.l19.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.l19.m1.2.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="alg1.l19.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l19.m1.2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.2c">w_{t+1}^{j}\leftarrow\text{FedAdam}(g_{t}^{j},w_{t}^{j})</annotation></semantics></math><span id="alg1.l19.3" class="ltx_text" style="font-size:90%;">  </span><math id="alg1.l19.m2.1" class="ltx_Math" alttext="\triangleright w_{t+1}^{j}" display="inline"><semantics id="alg1.l19.m2.1a"><mrow id="alg1.l19.m2.1.1" xref="alg1.l19.m2.1.1.cmml"><mo mathsize="90%" rspace="0em" id="alg1.l19.m2.1.1a" xref="alg1.l19.m2.1.1.cmml">▷</mo><msubsup id="alg1.l19.m2.1.1.2" xref="alg1.l19.m2.1.1.2.cmml"><mi mathsize="90%" id="alg1.l19.m2.1.1.2.2.2" xref="alg1.l19.m2.1.1.2.2.2.cmml">w</mi><mrow id="alg1.l19.m2.1.1.2.2.3" xref="alg1.l19.m2.1.1.2.2.3.cmml"><mi mathsize="90%" id="alg1.l19.m2.1.1.2.2.3.2" xref="alg1.l19.m2.1.1.2.2.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.l19.m2.1.1.2.2.3.1" xref="alg1.l19.m2.1.1.2.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.l19.m2.1.1.2.2.3.3" xref="alg1.l19.m2.1.1.2.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="alg1.l19.m2.1.1.2.3" xref="alg1.l19.m2.1.1.2.3.cmml">j</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m2.1b"><apply id="alg1.l19.m2.1.1.cmml" xref="alg1.l19.m2.1.1"><ci id="alg1.l19.m2.1.1.1.cmml" xref="alg1.l19.m2.1.1">▷</ci><apply id="alg1.l19.m2.1.1.2.cmml" xref="alg1.l19.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l19.m2.1.1.2.1.cmml" xref="alg1.l19.m2.1.1.2">superscript</csymbol><apply id="alg1.l19.m2.1.1.2.2.cmml" xref="alg1.l19.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l19.m2.1.1.2.2.1.cmml" xref="alg1.l19.m2.1.1.2">subscript</csymbol><ci id="alg1.l19.m2.1.1.2.2.2.cmml" xref="alg1.l19.m2.1.1.2.2.2">𝑤</ci><apply id="alg1.l19.m2.1.1.2.2.3.cmml" xref="alg1.l19.m2.1.1.2.2.3"><plus id="alg1.l19.m2.1.1.2.2.3.1.cmml" xref="alg1.l19.m2.1.1.2.2.3.1"></plus><ci id="alg1.l19.m2.1.1.2.2.3.2.cmml" xref="alg1.l19.m2.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l19.m2.1.1.2.2.3.3.cmml" xref="alg1.l19.m2.1.1.2.2.3.3">1</cn></apply></apply><ci id="alg1.l19.m2.1.1.2.3.cmml" xref="alg1.l19.m2.1.1.2.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m2.1c">\triangleright w_{t+1}^{j}</annotation></semantics></math><span id="alg1.l19.4" class="ltx_text" style="font-size:90%;"> includes </span><math id="alg1.l19.m3.1" class="ltx_Math" alttext="\theta_{t+1}^{j}\circ f_{t+1}^{j}" display="inline"><semantics id="alg1.l19.m3.1a"><mrow id="alg1.l19.m3.1.1" xref="alg1.l19.m3.1.1.cmml"><msubsup id="alg1.l19.m3.1.1.2" xref="alg1.l19.m3.1.1.2.cmml"><mi mathsize="90%" id="alg1.l19.m3.1.1.2.2.2" xref="alg1.l19.m3.1.1.2.2.2.cmml">θ</mi><mrow id="alg1.l19.m3.1.1.2.2.3" xref="alg1.l19.m3.1.1.2.2.3.cmml"><mi mathsize="90%" id="alg1.l19.m3.1.1.2.2.3.2" xref="alg1.l19.m3.1.1.2.2.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.l19.m3.1.1.2.2.3.1" xref="alg1.l19.m3.1.1.2.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.l19.m3.1.1.2.2.3.3" xref="alg1.l19.m3.1.1.2.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="alg1.l19.m3.1.1.2.3" xref="alg1.l19.m3.1.1.2.3.cmml">j</mi></msubsup><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="alg1.l19.m3.1.1.1" xref="alg1.l19.m3.1.1.1.cmml">∘</mo><msubsup id="alg1.l19.m3.1.1.3" xref="alg1.l19.m3.1.1.3.cmml"><mi mathsize="90%" id="alg1.l19.m3.1.1.3.2.2" xref="alg1.l19.m3.1.1.3.2.2.cmml">f</mi><mrow id="alg1.l19.m3.1.1.3.2.3" xref="alg1.l19.m3.1.1.3.2.3.cmml"><mi mathsize="90%" id="alg1.l19.m3.1.1.3.2.3.2" xref="alg1.l19.m3.1.1.3.2.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.l19.m3.1.1.3.2.3.1" xref="alg1.l19.m3.1.1.3.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.l19.m3.1.1.3.2.3.3" xref="alg1.l19.m3.1.1.3.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="alg1.l19.m3.1.1.3.3" xref="alg1.l19.m3.1.1.3.3.cmml">j</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m3.1b"><apply id="alg1.l19.m3.1.1.cmml" xref="alg1.l19.m3.1.1"><compose id="alg1.l19.m3.1.1.1.cmml" xref="alg1.l19.m3.1.1.1"></compose><apply id="alg1.l19.m3.1.1.2.cmml" xref="alg1.l19.m3.1.1.2"><csymbol cd="ambiguous" id="alg1.l19.m3.1.1.2.1.cmml" xref="alg1.l19.m3.1.1.2">superscript</csymbol><apply id="alg1.l19.m3.1.1.2.2.cmml" xref="alg1.l19.m3.1.1.2"><csymbol cd="ambiguous" id="alg1.l19.m3.1.1.2.2.1.cmml" xref="alg1.l19.m3.1.1.2">subscript</csymbol><ci id="alg1.l19.m3.1.1.2.2.2.cmml" xref="alg1.l19.m3.1.1.2.2.2">𝜃</ci><apply id="alg1.l19.m3.1.1.2.2.3.cmml" xref="alg1.l19.m3.1.1.2.2.3"><plus id="alg1.l19.m3.1.1.2.2.3.1.cmml" xref="alg1.l19.m3.1.1.2.2.3.1"></plus><ci id="alg1.l19.m3.1.1.2.2.3.2.cmml" xref="alg1.l19.m3.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l19.m3.1.1.2.2.3.3.cmml" xref="alg1.l19.m3.1.1.2.2.3.3">1</cn></apply></apply><ci id="alg1.l19.m3.1.1.2.3.cmml" xref="alg1.l19.m3.1.1.2.3">𝑗</ci></apply><apply id="alg1.l19.m3.1.1.3.cmml" xref="alg1.l19.m3.1.1.3"><csymbol cd="ambiguous" id="alg1.l19.m3.1.1.3.1.cmml" xref="alg1.l19.m3.1.1.3">superscript</csymbol><apply id="alg1.l19.m3.1.1.3.2.cmml" xref="alg1.l19.m3.1.1.3"><csymbol cd="ambiguous" id="alg1.l19.m3.1.1.3.2.1.cmml" xref="alg1.l19.m3.1.1.3">subscript</csymbol><ci id="alg1.l19.m3.1.1.3.2.2.cmml" xref="alg1.l19.m3.1.1.3.2.2">𝑓</ci><apply id="alg1.l19.m3.1.1.3.2.3.cmml" xref="alg1.l19.m3.1.1.3.2.3"><plus id="alg1.l19.m3.1.1.3.2.3.1.cmml" xref="alg1.l19.m3.1.1.3.2.3.1"></plus><ci id="alg1.l19.m3.1.1.3.2.3.2.cmml" xref="alg1.l19.m3.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="alg1.l19.m3.1.1.3.2.3.3.cmml" xref="alg1.l19.m3.1.1.3.2.3.3">1</cn></apply></apply><ci id="alg1.l19.m3.1.1.3.3.cmml" xref="alg1.l19.m3.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m3.1c">\theta_{t+1}^{j}\circ f_{t+1}^{j}</annotation></semantics></math><span id="alg1.l19.5" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l20.1.1.1" class="ltx_text" style="font-size:80%;">20:</span></span><span id="alg1.l20.2" class="ltx_text" style="font-size:90%;">        </span><span id="alg1.l20.3" class="ltx_text ltx_font_bold" style="font-size:90%;">if</span><span id="alg1.l20.4" class="ltx_text" style="font-size:90%;"> </span><math id="alg1.l20.m1.1" class="ltx_Math" alttext="j" display="inline"><semantics id="alg1.l20.m1.1a"><mi mathsize="90%" id="alg1.l20.m1.1.1" xref="alg1.l20.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="alg1.l20.m1.1b"><ci id="alg1.l20.m1.1.1.cmml" xref="alg1.l20.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m1.1c">j</annotation></semantics></math><span id="alg1.l20.5" class="ltx_text" style="font-size:90%;"> is not </span><math id="alg1.l20.m2.1" class="ltx_Math" alttext="a" display="inline"><semantics id="alg1.l20.m2.1a"><mi mathsize="90%" id="alg1.l20.m2.1.1" xref="alg1.l20.m2.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="alg1.l20.m2.1b"><ci id="alg1.l20.m2.1.1.cmml" xref="alg1.l20.m2.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m2.1c">a</annotation></semantics></math><span id="alg1.l20.6" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l20.7" class="ltx_text ltx_font_bold" style="font-size:90%;">then</span><span id="alg1.l20.8" class="ltx_text" style="font-size:90%;">


</span>
</div>
<div id="alg1.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l21.1.1.1" class="ltx_text" style="font-size:80%;">21:</span></span><span id="alg1.l21.2" class="ltx_text" style="font-size:90%;">           </span><math id="alg1.l21.m1.1" class="ltx_Math" alttext="L^{-}\leftarrow" display="inline"><semantics id="alg1.l21.m1.1a"><mrow id="alg1.l21.m1.1.1" xref="alg1.l21.m1.1.1.cmml"><msup id="alg1.l21.m1.1.1.2" xref="alg1.l21.m1.1.1.2.cmml"><mi mathsize="90%" id="alg1.l21.m1.1.1.2.2" xref="alg1.l21.m1.1.1.2.2.cmml">L</mi><mo mathsize="90%" id="alg1.l21.m1.1.1.2.3" xref="alg1.l21.m1.1.1.2.3.cmml">−</mo></msup><mo mathsize="90%" stretchy="false" id="alg1.l21.m1.1.1.1" xref="alg1.l21.m1.1.1.1.cmml">←</mo><mi id="alg1.l21.m1.1.1.3" xref="alg1.l21.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.1b"><apply id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1"><ci id="alg1.l21.m1.1.1.1.cmml" xref="alg1.l21.m1.1.1.1">←</ci><apply id="alg1.l21.m1.1.1.2.cmml" xref="alg1.l21.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.2.1.cmml" xref="alg1.l21.m1.1.1.2">superscript</csymbol><ci id="alg1.l21.m1.1.1.2.2.cmml" xref="alg1.l21.m1.1.1.2.2">𝐿</ci><minus id="alg1.l21.m1.1.1.2.3.cmml" xref="alg1.l21.m1.1.1.2.3"></minus></apply><csymbol cd="latexml" id="alg1.l21.m1.1.1.3.cmml" xref="alg1.l21.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.1c">L^{-}\leftarrow</annotation></semantics></math><span id="alg1.l21.3" class="ltx_text" style="font-size:90%;"> (the number of layers in the next smaller model)
</span>
</div>
<div id="alg1.l22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l22.1.1.1" class="ltx_text" style="font-size:80%;">22:</span></span><span id="alg1.l22.2" class="ltx_text" style="font-size:90%;">           </span><math id="alg1.l22.m1.5" class="ltx_Math" alttext="m_{t}^{j}\leftarrow\frac{1}{L_{j}-L^{-}+1}\cdot\sum_{l\in[L^{-}:L_{j}]}g_{t}^{j,l}" display="inline"><semantics id="alg1.l22.m1.5a"><mrow id="alg1.l22.m1.5.6" xref="alg1.l22.m1.5.6.cmml"><msubsup id="alg1.l22.m1.5.6.2" xref="alg1.l22.m1.5.6.2.cmml"><mi mathsize="90%" id="alg1.l22.m1.5.6.2.2.2" xref="alg1.l22.m1.5.6.2.2.2.cmml">m</mi><mi mathsize="90%" id="alg1.l22.m1.5.6.2.2.3" xref="alg1.l22.m1.5.6.2.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.l22.m1.5.6.2.3" xref="alg1.l22.m1.5.6.2.3.cmml">j</mi></msubsup><mo mathsize="90%" stretchy="false" id="alg1.l22.m1.5.6.1" xref="alg1.l22.m1.5.6.1.cmml">←</mo><mrow id="alg1.l22.m1.5.6.3" xref="alg1.l22.m1.5.6.3.cmml"><mfrac id="alg1.l22.m1.5.6.3.2" xref="alg1.l22.m1.5.6.3.2.cmml"><mn mathsize="90%" id="alg1.l22.m1.5.6.3.2.2" xref="alg1.l22.m1.5.6.3.2.2.cmml">1</mn><mrow id="alg1.l22.m1.5.6.3.2.3" xref="alg1.l22.m1.5.6.3.2.3.cmml"><mrow id="alg1.l22.m1.5.6.3.2.3.2" xref="alg1.l22.m1.5.6.3.2.3.2.cmml"><msub id="alg1.l22.m1.5.6.3.2.3.2.2" xref="alg1.l22.m1.5.6.3.2.3.2.2.cmml"><mi mathsize="90%" id="alg1.l22.m1.5.6.3.2.3.2.2.2" xref="alg1.l22.m1.5.6.3.2.3.2.2.2.cmml">L</mi><mi mathsize="90%" id="alg1.l22.m1.5.6.3.2.3.2.2.3" xref="alg1.l22.m1.5.6.3.2.3.2.2.3.cmml">j</mi></msub><mo mathsize="90%" id="alg1.l22.m1.5.6.3.2.3.2.1" xref="alg1.l22.m1.5.6.3.2.3.2.1.cmml">−</mo><msup id="alg1.l22.m1.5.6.3.2.3.2.3" xref="alg1.l22.m1.5.6.3.2.3.2.3.cmml"><mi mathsize="90%" id="alg1.l22.m1.5.6.3.2.3.2.3.2" xref="alg1.l22.m1.5.6.3.2.3.2.3.2.cmml">L</mi><mo mathsize="90%" id="alg1.l22.m1.5.6.3.2.3.2.3.3" xref="alg1.l22.m1.5.6.3.2.3.2.3.3.cmml">−</mo></msup></mrow><mo mathsize="90%" id="alg1.l22.m1.5.6.3.2.3.1" xref="alg1.l22.m1.5.6.3.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.l22.m1.5.6.3.2.3.3" xref="alg1.l22.m1.5.6.3.2.3.3.cmml">1</mn></mrow></mfrac><mo lspace="0.222em" mathsize="90%" rspace="0.055em" id="alg1.l22.m1.5.6.3.1" xref="alg1.l22.m1.5.6.3.1.cmml">⋅</mo><mrow id="alg1.l22.m1.5.6.3.3" xref="alg1.l22.m1.5.6.3.3.cmml"><msub id="alg1.l22.m1.5.6.3.3.1" xref="alg1.l22.m1.5.6.3.3.1.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" id="alg1.l22.m1.5.6.3.3.1.2" xref="alg1.l22.m1.5.6.3.3.1.2.cmml">∑</mo><mrow id="alg1.l22.m1.3.3.3.3" xref="alg1.l22.m1.3.3.3.4.cmml"><mi mathsize="90%" id="alg1.l22.m1.1.1.1.1" xref="alg1.l22.m1.1.1.1.1.cmml">l</mi><mo id="alg1.l22.m1.3.3.3.3.2" xref="alg1.l22.m1.3.3.3.4.cmml">⁣</mo><mo mathsize="90%" id="alg1.l22.m1.2.2.2.2" xref="alg1.l22.m1.2.2.2.2.cmml">∈</mo><mo id="alg1.l22.m1.3.3.3.3.3" xref="alg1.l22.m1.3.3.3.4.cmml">⁣</mo><mrow id="alg1.l22.m1.3.3.3.3.1.1" xref="alg1.l22.m1.3.3.3.3.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l22.m1.3.3.3.3.1.1.2" xref="alg1.l22.m1.3.3.3.3.1.2.1.cmml">[</mo><mrow id="alg1.l22.m1.3.3.3.3.1.1.1" xref="alg1.l22.m1.3.3.3.3.1.1.1.cmml"><msup id="alg1.l22.m1.3.3.3.3.1.1.1.2" xref="alg1.l22.m1.3.3.3.3.1.1.1.2.cmml"><mi mathsize="90%" id="alg1.l22.m1.3.3.3.3.1.1.1.2.2" xref="alg1.l22.m1.3.3.3.3.1.1.1.2.2.cmml">L</mi><mo mathsize="90%" id="alg1.l22.m1.3.3.3.3.1.1.1.2.3" xref="alg1.l22.m1.3.3.3.3.1.1.1.2.3.cmml">−</mo></msup><mo lspace="0.278em" mathsize="90%" rspace="0.278em" id="alg1.l22.m1.3.3.3.3.1.1.1.1" xref="alg1.l22.m1.3.3.3.3.1.1.1.1.cmml">:</mo><msub id="alg1.l22.m1.3.3.3.3.1.1.1.3" xref="alg1.l22.m1.3.3.3.3.1.1.1.3.cmml"><mi mathsize="90%" id="alg1.l22.m1.3.3.3.3.1.1.1.3.2" xref="alg1.l22.m1.3.3.3.3.1.1.1.3.2.cmml">L</mi><mi mathsize="90%" id="alg1.l22.m1.3.3.3.3.1.1.1.3.3" xref="alg1.l22.m1.3.3.3.3.1.1.1.3.3.cmml">j</mi></msub></mrow><mo maxsize="90%" minsize="90%" id="alg1.l22.m1.3.3.3.3.1.1.3" xref="alg1.l22.m1.3.3.3.3.1.2.1.cmml">]</mo></mrow></mrow></msub><msubsup id="alg1.l22.m1.5.6.3.3.2" xref="alg1.l22.m1.5.6.3.3.2.cmml"><mi mathsize="90%" id="alg1.l22.m1.5.6.3.3.2.2.2" xref="alg1.l22.m1.5.6.3.3.2.2.2.cmml">g</mi><mi mathsize="90%" id="alg1.l22.m1.5.6.3.3.2.2.3" xref="alg1.l22.m1.5.6.3.3.2.2.3.cmml">t</mi><mrow id="alg1.l22.m1.5.5.2.4" xref="alg1.l22.m1.5.5.2.3.cmml"><mi mathsize="90%" id="alg1.l22.m1.4.4.1.1" xref="alg1.l22.m1.4.4.1.1.cmml">j</mi><mo mathsize="90%" id="alg1.l22.m1.5.5.2.4.1" xref="alg1.l22.m1.5.5.2.3.cmml">,</mo><mi mathsize="90%" id="alg1.l22.m1.5.5.2.2" xref="alg1.l22.m1.5.5.2.2.cmml">l</mi></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l22.m1.5b"><apply id="alg1.l22.m1.5.6.cmml" xref="alg1.l22.m1.5.6"><ci id="alg1.l22.m1.5.6.1.cmml" xref="alg1.l22.m1.5.6.1">←</ci><apply id="alg1.l22.m1.5.6.2.cmml" xref="alg1.l22.m1.5.6.2"><csymbol cd="ambiguous" id="alg1.l22.m1.5.6.2.1.cmml" xref="alg1.l22.m1.5.6.2">superscript</csymbol><apply id="alg1.l22.m1.5.6.2.2.cmml" xref="alg1.l22.m1.5.6.2"><csymbol cd="ambiguous" id="alg1.l22.m1.5.6.2.2.1.cmml" xref="alg1.l22.m1.5.6.2">subscript</csymbol><ci id="alg1.l22.m1.5.6.2.2.2.cmml" xref="alg1.l22.m1.5.6.2.2.2">𝑚</ci><ci id="alg1.l22.m1.5.6.2.2.3.cmml" xref="alg1.l22.m1.5.6.2.2.3">𝑡</ci></apply><ci id="alg1.l22.m1.5.6.2.3.cmml" xref="alg1.l22.m1.5.6.2.3">𝑗</ci></apply><apply id="alg1.l22.m1.5.6.3.cmml" xref="alg1.l22.m1.5.6.3"><ci id="alg1.l22.m1.5.6.3.1.cmml" xref="alg1.l22.m1.5.6.3.1">⋅</ci><apply id="alg1.l22.m1.5.6.3.2.cmml" xref="alg1.l22.m1.5.6.3.2"><divide id="alg1.l22.m1.5.6.3.2.1.cmml" xref="alg1.l22.m1.5.6.3.2"></divide><cn type="integer" id="alg1.l22.m1.5.6.3.2.2.cmml" xref="alg1.l22.m1.5.6.3.2.2">1</cn><apply id="alg1.l22.m1.5.6.3.2.3.cmml" xref="alg1.l22.m1.5.6.3.2.3"><plus id="alg1.l22.m1.5.6.3.2.3.1.cmml" xref="alg1.l22.m1.5.6.3.2.3.1"></plus><apply id="alg1.l22.m1.5.6.3.2.3.2.cmml" xref="alg1.l22.m1.5.6.3.2.3.2"><minus id="alg1.l22.m1.5.6.3.2.3.2.1.cmml" xref="alg1.l22.m1.5.6.3.2.3.2.1"></minus><apply id="alg1.l22.m1.5.6.3.2.3.2.2.cmml" xref="alg1.l22.m1.5.6.3.2.3.2.2"><csymbol cd="ambiguous" id="alg1.l22.m1.5.6.3.2.3.2.2.1.cmml" xref="alg1.l22.m1.5.6.3.2.3.2.2">subscript</csymbol><ci id="alg1.l22.m1.5.6.3.2.3.2.2.2.cmml" xref="alg1.l22.m1.5.6.3.2.3.2.2.2">𝐿</ci><ci id="alg1.l22.m1.5.6.3.2.3.2.2.3.cmml" xref="alg1.l22.m1.5.6.3.2.3.2.2.3">𝑗</ci></apply><apply id="alg1.l22.m1.5.6.3.2.3.2.3.cmml" xref="alg1.l22.m1.5.6.3.2.3.2.3"><csymbol cd="ambiguous" id="alg1.l22.m1.5.6.3.2.3.2.3.1.cmml" xref="alg1.l22.m1.5.6.3.2.3.2.3">superscript</csymbol><ci id="alg1.l22.m1.5.6.3.2.3.2.3.2.cmml" xref="alg1.l22.m1.5.6.3.2.3.2.3.2">𝐿</ci><minus id="alg1.l22.m1.5.6.3.2.3.2.3.3.cmml" xref="alg1.l22.m1.5.6.3.2.3.2.3.3"></minus></apply></apply><cn type="integer" id="alg1.l22.m1.5.6.3.2.3.3.cmml" xref="alg1.l22.m1.5.6.3.2.3.3">1</cn></apply></apply><apply id="alg1.l22.m1.5.6.3.3.cmml" xref="alg1.l22.m1.5.6.3.3"><apply id="alg1.l22.m1.5.6.3.3.1.cmml" xref="alg1.l22.m1.5.6.3.3.1"><csymbol cd="ambiguous" id="alg1.l22.m1.5.6.3.3.1.1.cmml" xref="alg1.l22.m1.5.6.3.3.1">subscript</csymbol><sum id="alg1.l22.m1.5.6.3.3.1.2.cmml" xref="alg1.l22.m1.5.6.3.3.1.2"></sum><list id="alg1.l22.m1.3.3.3.4.cmml" xref="alg1.l22.m1.3.3.3.3"><ci id="alg1.l22.m1.1.1.1.1.cmml" xref="alg1.l22.m1.1.1.1.1">𝑙</ci><in id="alg1.l22.m1.2.2.2.2.cmml" xref="alg1.l22.m1.2.2.2.2"></in><apply id="alg1.l22.m1.3.3.3.3.1.2.cmml" xref="alg1.l22.m1.3.3.3.3.1.1"><csymbol cd="latexml" id="alg1.l22.m1.3.3.3.3.1.2.1.cmml" xref="alg1.l22.m1.3.3.3.3.1.1.2">delimited-[]</csymbol><apply id="alg1.l22.m1.3.3.3.3.1.1.1.cmml" xref="alg1.l22.m1.3.3.3.3.1.1.1"><ci id="alg1.l22.m1.3.3.3.3.1.1.1.1.cmml" xref="alg1.l22.m1.3.3.3.3.1.1.1.1">:</ci><apply id="alg1.l22.m1.3.3.3.3.1.1.1.2.cmml" xref="alg1.l22.m1.3.3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l22.m1.3.3.3.3.1.1.1.2.1.cmml" xref="alg1.l22.m1.3.3.3.3.1.1.1.2">superscript</csymbol><ci id="alg1.l22.m1.3.3.3.3.1.1.1.2.2.cmml" xref="alg1.l22.m1.3.3.3.3.1.1.1.2.2">𝐿</ci><minus id="alg1.l22.m1.3.3.3.3.1.1.1.2.3.cmml" xref="alg1.l22.m1.3.3.3.3.1.1.1.2.3"></minus></apply><apply id="alg1.l22.m1.3.3.3.3.1.1.1.3.cmml" xref="alg1.l22.m1.3.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l22.m1.3.3.3.3.1.1.1.3.1.cmml" xref="alg1.l22.m1.3.3.3.3.1.1.1.3">subscript</csymbol><ci id="alg1.l22.m1.3.3.3.3.1.1.1.3.2.cmml" xref="alg1.l22.m1.3.3.3.3.1.1.1.3.2">𝐿</ci><ci id="alg1.l22.m1.3.3.3.3.1.1.1.3.3.cmml" xref="alg1.l22.m1.3.3.3.3.1.1.1.3.3">𝑗</ci></apply></apply></apply></list></apply><apply id="alg1.l22.m1.5.6.3.3.2.cmml" xref="alg1.l22.m1.5.6.3.3.2"><csymbol cd="ambiguous" id="alg1.l22.m1.5.6.3.3.2.1.cmml" xref="alg1.l22.m1.5.6.3.3.2">superscript</csymbol><apply id="alg1.l22.m1.5.6.3.3.2.2.cmml" xref="alg1.l22.m1.5.6.3.3.2"><csymbol cd="ambiguous" id="alg1.l22.m1.5.6.3.3.2.2.1.cmml" xref="alg1.l22.m1.5.6.3.3.2">subscript</csymbol><ci id="alg1.l22.m1.5.6.3.3.2.2.2.cmml" xref="alg1.l22.m1.5.6.3.3.2.2.2">𝑔</ci><ci id="alg1.l22.m1.5.6.3.3.2.2.3.cmml" xref="alg1.l22.m1.5.6.3.3.2.2.3">𝑡</ci></apply><list id="alg1.l22.m1.5.5.2.3.cmml" xref="alg1.l22.m1.5.5.2.4"><ci id="alg1.l22.m1.4.4.1.1.cmml" xref="alg1.l22.m1.4.4.1.1">𝑗</ci><ci id="alg1.l22.m1.5.5.2.2.cmml" xref="alg1.l22.m1.5.5.2.2">𝑙</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m1.5c">m_{t}^{j}\leftarrow\frac{1}{L_{j}-L^{-}+1}\cdot\sum_{l\in[L^{-}:L_{j}]}g_{t}^{j,l}</annotation></semantics></math><span id="alg1.l22.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l23.1.1.1" class="ltx_text" style="font-size:80%;">23:</span></span><span id="alg1.l23.2" class="ltx_text" style="font-size:90%;">        </span><span id="alg1.l23.3" class="ltx_text ltx_font_bold" style="font-size:90%;">end</span><span id="alg1.l23.4" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l23.5" class="ltx_text ltx_font_bold" style="font-size:90%;">if</span><span id="alg1.l23.6" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l24.1.1.1" class="ltx_text" style="font-size:80%;">24:</span></span><span id="alg1.l24.2" class="ltx_text" style="font-size:90%;">     </span><span id="alg1.l24.3" class="ltx_text ltx_font_bold" style="font-size:90%;">end</span><span id="alg1.l24.4" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l24.5" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span>
</div>
<div id="alg1.l25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l25.1.1.1" class="ltx_text" style="font-size:80%;">25:</span></span><span id="alg1.l25.2" class="ltx_text" style="font-size:90%;">     </span><math id="alg1.l25.m1.2" class="ltx_Math" alttext="//" display="inline"><semantics id="alg1.l25.m1.2a"><mrow id="alg1.l25.m1.2.3.2" xref="alg1.l25.m1.2.3.1.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" symmetric="true" id="alg1.l25.m1.1.1" xref="alg1.l25.m1.1.1.cmml">/</mo><mo lspace="0em" id="alg1.l25.m1.2.3.2.1" xref="alg1.l25.m1.2.3.1.cmml">⁣</mo><mo maxsize="90%" minsize="90%" stretchy="true" symmetric="true" id="alg1.l25.m1.2.2" xref="alg1.l25.m1.2.2.cmml">/</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l25.m1.2b"><list id="alg1.l25.m1.2.3.1.cmml" xref="alg1.l25.m1.2.3.2"><divide id="alg1.l25.m1.1.1.cmml" xref="alg1.l25.m1.1.1"></divide><divide id="alg1.l25.m1.2.2.cmml" xref="alg1.l25.m1.2.2"></divide></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m1.2c">//</annotation></semantics></math><span id="alg1.l25.3" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l25.4" class="ltx_text ltx_font_bold" style="font-size:90%;">Heterogeneous aggregation</span><span id="alg1.l25.5" class="ltx_text" style="font-size:90%;"> 
</span>
</div>
<div id="alg1.l26" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l26.1.1.1" class="ltx_text" style="font-size:80%;">26:</span></span><span id="alg1.l26.2" class="ltx_text" style="font-size:90%;">     </span><math id="alg1.l26.m1.7" class="ltx_Math" alttext="\theta_{t+1}^{c,l}\leftarrow\sum_{i\in\{a,b,c\}}\frac{n_{i}}{n_{a}+n_{b}+n_{c}}\theta_{t+1}^{i,l}" display="inline"><semantics id="alg1.l26.m1.7a"><mrow id="alg1.l26.m1.7.8" xref="alg1.l26.m1.7.8.cmml"><msubsup id="alg1.l26.m1.7.8.2" xref="alg1.l26.m1.7.8.2.cmml"><mi mathsize="90%" id="alg1.l26.m1.7.8.2.2.2" xref="alg1.l26.m1.7.8.2.2.2.cmml">θ</mi><mrow id="alg1.l26.m1.7.8.2.2.3" xref="alg1.l26.m1.7.8.2.2.3.cmml"><mi mathsize="90%" id="alg1.l26.m1.7.8.2.2.3.2" xref="alg1.l26.m1.7.8.2.2.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.l26.m1.7.8.2.2.3.1" xref="alg1.l26.m1.7.8.2.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.l26.m1.7.8.2.2.3.3" xref="alg1.l26.m1.7.8.2.2.3.3.cmml">1</mn></mrow><mrow id="alg1.l26.m1.2.2.2.4" xref="alg1.l26.m1.2.2.2.3.cmml"><mi mathsize="90%" id="alg1.l26.m1.1.1.1.1" xref="alg1.l26.m1.1.1.1.1.cmml">c</mi><mo mathsize="90%" id="alg1.l26.m1.2.2.2.4.1" xref="alg1.l26.m1.2.2.2.3.cmml">,</mo><mi mathsize="90%" id="alg1.l26.m1.2.2.2.2" xref="alg1.l26.m1.2.2.2.2.cmml">l</mi></mrow></msubsup><mo mathsize="90%" rspace="0.111em" stretchy="false" id="alg1.l26.m1.7.8.1" xref="alg1.l26.m1.7.8.1.cmml">←</mo><mrow id="alg1.l26.m1.7.8.3" xref="alg1.l26.m1.7.8.3.cmml"><msub id="alg1.l26.m1.7.8.3.1" xref="alg1.l26.m1.7.8.3.1.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" id="alg1.l26.m1.7.8.3.1.2" xref="alg1.l26.m1.7.8.3.1.2.cmml">∑</mo><mrow id="alg1.l26.m1.5.5.3" xref="alg1.l26.m1.5.5.3.cmml"><mi mathsize="90%" id="alg1.l26.m1.5.5.3.5" xref="alg1.l26.m1.5.5.3.5.cmml">i</mi><mo mathsize="90%" id="alg1.l26.m1.5.5.3.4" xref="alg1.l26.m1.5.5.3.4.cmml">∈</mo><mrow id="alg1.l26.m1.5.5.3.6.2" xref="alg1.l26.m1.5.5.3.6.1.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l26.m1.5.5.3.6.2.1" xref="alg1.l26.m1.5.5.3.6.1.cmml">{</mo><mi mathsize="90%" id="alg1.l26.m1.3.3.1.1" xref="alg1.l26.m1.3.3.1.1.cmml">a</mi><mo mathsize="90%" id="alg1.l26.m1.5.5.3.6.2.2" xref="alg1.l26.m1.5.5.3.6.1.cmml">,</mo><mi mathsize="90%" id="alg1.l26.m1.4.4.2.2" xref="alg1.l26.m1.4.4.2.2.cmml">b</mi><mo mathsize="90%" id="alg1.l26.m1.5.5.3.6.2.3" xref="alg1.l26.m1.5.5.3.6.1.cmml">,</mo><mi mathsize="90%" id="alg1.l26.m1.5.5.3.3" xref="alg1.l26.m1.5.5.3.3.cmml">c</mi><mo maxsize="90%" minsize="90%" id="alg1.l26.m1.5.5.3.6.2.4" xref="alg1.l26.m1.5.5.3.6.1.cmml">}</mo></mrow></mrow></msub><mrow id="alg1.l26.m1.7.8.3.2" xref="alg1.l26.m1.7.8.3.2.cmml"><mfrac id="alg1.l26.m1.7.8.3.2.2" xref="alg1.l26.m1.7.8.3.2.2.cmml"><msub id="alg1.l26.m1.7.8.3.2.2.2" xref="alg1.l26.m1.7.8.3.2.2.2.cmml"><mi mathsize="90%" id="alg1.l26.m1.7.8.3.2.2.2.2" xref="alg1.l26.m1.7.8.3.2.2.2.2.cmml">n</mi><mi mathsize="90%" id="alg1.l26.m1.7.8.3.2.2.2.3" xref="alg1.l26.m1.7.8.3.2.2.2.3.cmml">i</mi></msub><mrow id="alg1.l26.m1.7.8.3.2.2.3" xref="alg1.l26.m1.7.8.3.2.2.3.cmml"><msub id="alg1.l26.m1.7.8.3.2.2.3.2" xref="alg1.l26.m1.7.8.3.2.2.3.2.cmml"><mi mathsize="90%" id="alg1.l26.m1.7.8.3.2.2.3.2.2" xref="alg1.l26.m1.7.8.3.2.2.3.2.2.cmml">n</mi><mi mathsize="90%" id="alg1.l26.m1.7.8.3.2.2.3.2.3" xref="alg1.l26.m1.7.8.3.2.2.3.2.3.cmml">a</mi></msub><mo mathsize="90%" id="alg1.l26.m1.7.8.3.2.2.3.1" xref="alg1.l26.m1.7.8.3.2.2.3.1.cmml">+</mo><msub id="alg1.l26.m1.7.8.3.2.2.3.3" xref="alg1.l26.m1.7.8.3.2.2.3.3.cmml"><mi mathsize="90%" id="alg1.l26.m1.7.8.3.2.2.3.3.2" xref="alg1.l26.m1.7.8.3.2.2.3.3.2.cmml">n</mi><mi mathsize="90%" id="alg1.l26.m1.7.8.3.2.2.3.3.3" xref="alg1.l26.m1.7.8.3.2.2.3.3.3.cmml">b</mi></msub><mo mathsize="90%" id="alg1.l26.m1.7.8.3.2.2.3.1a" xref="alg1.l26.m1.7.8.3.2.2.3.1.cmml">+</mo><msub id="alg1.l26.m1.7.8.3.2.2.3.4" xref="alg1.l26.m1.7.8.3.2.2.3.4.cmml"><mi mathsize="90%" id="alg1.l26.m1.7.8.3.2.2.3.4.2" xref="alg1.l26.m1.7.8.3.2.2.3.4.2.cmml">n</mi><mi mathsize="90%" id="alg1.l26.m1.7.8.3.2.2.3.4.3" xref="alg1.l26.m1.7.8.3.2.2.3.4.3.cmml">c</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg1.l26.m1.7.8.3.2.1" xref="alg1.l26.m1.7.8.3.2.1.cmml">​</mo><msubsup id="alg1.l26.m1.7.8.3.2.3" xref="alg1.l26.m1.7.8.3.2.3.cmml"><mi mathsize="90%" id="alg1.l26.m1.7.8.3.2.3.2.2" xref="alg1.l26.m1.7.8.3.2.3.2.2.cmml">θ</mi><mrow id="alg1.l26.m1.7.8.3.2.3.2.3" xref="alg1.l26.m1.7.8.3.2.3.2.3.cmml"><mi mathsize="90%" id="alg1.l26.m1.7.8.3.2.3.2.3.2" xref="alg1.l26.m1.7.8.3.2.3.2.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.l26.m1.7.8.3.2.3.2.3.1" xref="alg1.l26.m1.7.8.3.2.3.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.l26.m1.7.8.3.2.3.2.3.3" xref="alg1.l26.m1.7.8.3.2.3.2.3.3.cmml">1</mn></mrow><mrow id="alg1.l26.m1.7.7.2.4" xref="alg1.l26.m1.7.7.2.3.cmml"><mi mathsize="90%" id="alg1.l26.m1.6.6.1.1" xref="alg1.l26.m1.6.6.1.1.cmml">i</mi><mo mathsize="90%" id="alg1.l26.m1.7.7.2.4.1" xref="alg1.l26.m1.7.7.2.3.cmml">,</mo><mi mathsize="90%" id="alg1.l26.m1.7.7.2.2" xref="alg1.l26.m1.7.7.2.2.cmml">l</mi></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l26.m1.7b"><apply id="alg1.l26.m1.7.8.cmml" xref="alg1.l26.m1.7.8"><ci id="alg1.l26.m1.7.8.1.cmml" xref="alg1.l26.m1.7.8.1">←</ci><apply id="alg1.l26.m1.7.8.2.cmml" xref="alg1.l26.m1.7.8.2"><csymbol cd="ambiguous" id="alg1.l26.m1.7.8.2.1.cmml" xref="alg1.l26.m1.7.8.2">superscript</csymbol><apply id="alg1.l26.m1.7.8.2.2.cmml" xref="alg1.l26.m1.7.8.2"><csymbol cd="ambiguous" id="alg1.l26.m1.7.8.2.2.1.cmml" xref="alg1.l26.m1.7.8.2">subscript</csymbol><ci id="alg1.l26.m1.7.8.2.2.2.cmml" xref="alg1.l26.m1.7.8.2.2.2">𝜃</ci><apply id="alg1.l26.m1.7.8.2.2.3.cmml" xref="alg1.l26.m1.7.8.2.2.3"><plus id="alg1.l26.m1.7.8.2.2.3.1.cmml" xref="alg1.l26.m1.7.8.2.2.3.1"></plus><ci id="alg1.l26.m1.7.8.2.2.3.2.cmml" xref="alg1.l26.m1.7.8.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l26.m1.7.8.2.2.3.3.cmml" xref="alg1.l26.m1.7.8.2.2.3.3">1</cn></apply></apply><list id="alg1.l26.m1.2.2.2.3.cmml" xref="alg1.l26.m1.2.2.2.4"><ci id="alg1.l26.m1.1.1.1.1.cmml" xref="alg1.l26.m1.1.1.1.1">𝑐</ci><ci id="alg1.l26.m1.2.2.2.2.cmml" xref="alg1.l26.m1.2.2.2.2">𝑙</ci></list></apply><apply id="alg1.l26.m1.7.8.3.cmml" xref="alg1.l26.m1.7.8.3"><apply id="alg1.l26.m1.7.8.3.1.cmml" xref="alg1.l26.m1.7.8.3.1"><csymbol cd="ambiguous" id="alg1.l26.m1.7.8.3.1.1.cmml" xref="alg1.l26.m1.7.8.3.1">subscript</csymbol><sum id="alg1.l26.m1.7.8.3.1.2.cmml" xref="alg1.l26.m1.7.8.3.1.2"></sum><apply id="alg1.l26.m1.5.5.3.cmml" xref="alg1.l26.m1.5.5.3"><in id="alg1.l26.m1.5.5.3.4.cmml" xref="alg1.l26.m1.5.5.3.4"></in><ci id="alg1.l26.m1.5.5.3.5.cmml" xref="alg1.l26.m1.5.5.3.5">𝑖</ci><set id="alg1.l26.m1.5.5.3.6.1.cmml" xref="alg1.l26.m1.5.5.3.6.2"><ci id="alg1.l26.m1.3.3.1.1.cmml" xref="alg1.l26.m1.3.3.1.1">𝑎</ci><ci id="alg1.l26.m1.4.4.2.2.cmml" xref="alg1.l26.m1.4.4.2.2">𝑏</ci><ci id="alg1.l26.m1.5.5.3.3.cmml" xref="alg1.l26.m1.5.5.3.3">𝑐</ci></set></apply></apply><apply id="alg1.l26.m1.7.8.3.2.cmml" xref="alg1.l26.m1.7.8.3.2"><times id="alg1.l26.m1.7.8.3.2.1.cmml" xref="alg1.l26.m1.7.8.3.2.1"></times><apply id="alg1.l26.m1.7.8.3.2.2.cmml" xref="alg1.l26.m1.7.8.3.2.2"><divide id="alg1.l26.m1.7.8.3.2.2.1.cmml" xref="alg1.l26.m1.7.8.3.2.2"></divide><apply id="alg1.l26.m1.7.8.3.2.2.2.cmml" xref="alg1.l26.m1.7.8.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l26.m1.7.8.3.2.2.2.1.cmml" xref="alg1.l26.m1.7.8.3.2.2.2">subscript</csymbol><ci id="alg1.l26.m1.7.8.3.2.2.2.2.cmml" xref="alg1.l26.m1.7.8.3.2.2.2.2">𝑛</ci><ci id="alg1.l26.m1.7.8.3.2.2.2.3.cmml" xref="alg1.l26.m1.7.8.3.2.2.2.3">𝑖</ci></apply><apply id="alg1.l26.m1.7.8.3.2.2.3.cmml" xref="alg1.l26.m1.7.8.3.2.2.3"><plus id="alg1.l26.m1.7.8.3.2.2.3.1.cmml" xref="alg1.l26.m1.7.8.3.2.2.3.1"></plus><apply id="alg1.l26.m1.7.8.3.2.2.3.2.cmml" xref="alg1.l26.m1.7.8.3.2.2.3.2"><csymbol cd="ambiguous" id="alg1.l26.m1.7.8.3.2.2.3.2.1.cmml" xref="alg1.l26.m1.7.8.3.2.2.3.2">subscript</csymbol><ci id="alg1.l26.m1.7.8.3.2.2.3.2.2.cmml" xref="alg1.l26.m1.7.8.3.2.2.3.2.2">𝑛</ci><ci id="alg1.l26.m1.7.8.3.2.2.3.2.3.cmml" xref="alg1.l26.m1.7.8.3.2.2.3.2.3">𝑎</ci></apply><apply id="alg1.l26.m1.7.8.3.2.2.3.3.cmml" xref="alg1.l26.m1.7.8.3.2.2.3.3"><csymbol cd="ambiguous" id="alg1.l26.m1.7.8.3.2.2.3.3.1.cmml" xref="alg1.l26.m1.7.8.3.2.2.3.3">subscript</csymbol><ci id="alg1.l26.m1.7.8.3.2.2.3.3.2.cmml" xref="alg1.l26.m1.7.8.3.2.2.3.3.2">𝑛</ci><ci id="alg1.l26.m1.7.8.3.2.2.3.3.3.cmml" xref="alg1.l26.m1.7.8.3.2.2.3.3.3">𝑏</ci></apply><apply id="alg1.l26.m1.7.8.3.2.2.3.4.cmml" xref="alg1.l26.m1.7.8.3.2.2.3.4"><csymbol cd="ambiguous" id="alg1.l26.m1.7.8.3.2.2.3.4.1.cmml" xref="alg1.l26.m1.7.8.3.2.2.3.4">subscript</csymbol><ci id="alg1.l26.m1.7.8.3.2.2.3.4.2.cmml" xref="alg1.l26.m1.7.8.3.2.2.3.4.2">𝑛</ci><ci id="alg1.l26.m1.7.8.3.2.2.3.4.3.cmml" xref="alg1.l26.m1.7.8.3.2.2.3.4.3">𝑐</ci></apply></apply></apply><apply id="alg1.l26.m1.7.8.3.2.3.cmml" xref="alg1.l26.m1.7.8.3.2.3"><csymbol cd="ambiguous" id="alg1.l26.m1.7.8.3.2.3.1.cmml" xref="alg1.l26.m1.7.8.3.2.3">superscript</csymbol><apply id="alg1.l26.m1.7.8.3.2.3.2.cmml" xref="alg1.l26.m1.7.8.3.2.3"><csymbol cd="ambiguous" id="alg1.l26.m1.7.8.3.2.3.2.1.cmml" xref="alg1.l26.m1.7.8.3.2.3">subscript</csymbol><ci id="alg1.l26.m1.7.8.3.2.3.2.2.cmml" xref="alg1.l26.m1.7.8.3.2.3.2.2">𝜃</ci><apply id="alg1.l26.m1.7.8.3.2.3.2.3.cmml" xref="alg1.l26.m1.7.8.3.2.3.2.3"><plus id="alg1.l26.m1.7.8.3.2.3.2.3.1.cmml" xref="alg1.l26.m1.7.8.3.2.3.2.3.1"></plus><ci id="alg1.l26.m1.7.8.3.2.3.2.3.2.cmml" xref="alg1.l26.m1.7.8.3.2.3.2.3.2">𝑡</ci><cn type="integer" id="alg1.l26.m1.7.8.3.2.3.2.3.3.cmml" xref="alg1.l26.m1.7.8.3.2.3.2.3.3">1</cn></apply></apply><list id="alg1.l26.m1.7.7.2.3.cmml" xref="alg1.l26.m1.7.7.2.4"><ci id="alg1.l26.m1.6.6.1.1.cmml" xref="alg1.l26.m1.6.6.1.1">𝑖</ci><ci id="alg1.l26.m1.7.7.2.2.cmml" xref="alg1.l26.m1.7.7.2.2">𝑙</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l26.m1.7c">\theta_{t+1}^{c,l}\leftarrow\sum_{i\in\{a,b,c\}}\frac{n_{i}}{n_{a}+n_{b}+n_{c}}\theta_{t+1}^{i,l}</annotation></semantics></math><span id="alg1.l26.3" class="ltx_text" style="font-size:90%;"> for </span><math id="alg1.l26.m2.3" class="ltx_Math" alttext="l\in[1,\cdots,L_{a}-1]" display="inline"><semantics id="alg1.l26.m2.3a"><mrow id="alg1.l26.m2.3.3" xref="alg1.l26.m2.3.3.cmml"><mi mathsize="90%" id="alg1.l26.m2.3.3.3" xref="alg1.l26.m2.3.3.3.cmml">l</mi><mo mathsize="90%" id="alg1.l26.m2.3.3.2" xref="alg1.l26.m2.3.3.2.cmml">∈</mo><mrow id="alg1.l26.m2.3.3.1.1" xref="alg1.l26.m2.3.3.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l26.m2.3.3.1.1.2" xref="alg1.l26.m2.3.3.1.2.cmml">[</mo><mn mathsize="90%" id="alg1.l26.m2.1.1" xref="alg1.l26.m2.1.1.cmml">1</mn><mo mathsize="90%" id="alg1.l26.m2.3.3.1.1.3" xref="alg1.l26.m2.3.3.1.2.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="alg1.l26.m2.2.2" xref="alg1.l26.m2.2.2.cmml">⋯</mi><mo mathsize="90%" id="alg1.l26.m2.3.3.1.1.4" xref="alg1.l26.m2.3.3.1.2.cmml">,</mo><mrow id="alg1.l26.m2.3.3.1.1.1" xref="alg1.l26.m2.3.3.1.1.1.cmml"><msub id="alg1.l26.m2.3.3.1.1.1.2" xref="alg1.l26.m2.3.3.1.1.1.2.cmml"><mi mathsize="90%" id="alg1.l26.m2.3.3.1.1.1.2.2" xref="alg1.l26.m2.3.3.1.1.1.2.2.cmml">L</mi><mi mathsize="90%" id="alg1.l26.m2.3.3.1.1.1.2.3" xref="alg1.l26.m2.3.3.1.1.1.2.3.cmml">a</mi></msub><mo mathsize="90%" id="alg1.l26.m2.3.3.1.1.1.1" xref="alg1.l26.m2.3.3.1.1.1.1.cmml">−</mo><mn mathsize="90%" id="alg1.l26.m2.3.3.1.1.1.3" xref="alg1.l26.m2.3.3.1.1.1.3.cmml">1</mn></mrow><mo maxsize="90%" minsize="90%" id="alg1.l26.m2.3.3.1.1.5" xref="alg1.l26.m2.3.3.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l26.m2.3b"><apply id="alg1.l26.m2.3.3.cmml" xref="alg1.l26.m2.3.3"><in id="alg1.l26.m2.3.3.2.cmml" xref="alg1.l26.m2.3.3.2"></in><ci id="alg1.l26.m2.3.3.3.cmml" xref="alg1.l26.m2.3.3.3">𝑙</ci><list id="alg1.l26.m2.3.3.1.2.cmml" xref="alg1.l26.m2.3.3.1.1"><cn type="integer" id="alg1.l26.m2.1.1.cmml" xref="alg1.l26.m2.1.1">1</cn><ci id="alg1.l26.m2.2.2.cmml" xref="alg1.l26.m2.2.2">⋯</ci><apply id="alg1.l26.m2.3.3.1.1.1.cmml" xref="alg1.l26.m2.3.3.1.1.1"><minus id="alg1.l26.m2.3.3.1.1.1.1.cmml" xref="alg1.l26.m2.3.3.1.1.1.1"></minus><apply id="alg1.l26.m2.3.3.1.1.1.2.cmml" xref="alg1.l26.m2.3.3.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l26.m2.3.3.1.1.1.2.1.cmml" xref="alg1.l26.m2.3.3.1.1.1.2">subscript</csymbol><ci id="alg1.l26.m2.3.3.1.1.1.2.2.cmml" xref="alg1.l26.m2.3.3.1.1.1.2.2">𝐿</ci><ci id="alg1.l26.m2.3.3.1.1.1.2.3.cmml" xref="alg1.l26.m2.3.3.1.1.1.2.3">𝑎</ci></apply><cn type="integer" id="alg1.l26.m2.3.3.1.1.1.3.cmml" xref="alg1.l26.m2.3.3.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l26.m2.3c">l\in[1,\cdots,L_{a}-1]</annotation></semantics></math><span id="alg1.l26.4" class="ltx_text" style="font-size:90%;"> 
</span>
</div>
<div id="alg1.l27" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l27.1.1.1" class="ltx_text" style="font-size:80%;">27:</span></span><span id="alg1.l27.2" class="ltx_text" style="font-size:90%;">     </span><math id="alg1.l27.m1.6" class="ltx_Math" alttext="\theta_{t+1}^{c,l}\leftarrow\sum_{i\in\{b,c\}}\frac{n_{i}}{n_{b}+n_{c}}\theta_{t+1}^{i,l}" display="inline"><semantics id="alg1.l27.m1.6a"><mrow id="alg1.l27.m1.6.7" xref="alg1.l27.m1.6.7.cmml"><msubsup id="alg1.l27.m1.6.7.2" xref="alg1.l27.m1.6.7.2.cmml"><mi mathsize="90%" id="alg1.l27.m1.6.7.2.2.2" xref="alg1.l27.m1.6.7.2.2.2.cmml">θ</mi><mrow id="alg1.l27.m1.6.7.2.2.3" xref="alg1.l27.m1.6.7.2.2.3.cmml"><mi mathsize="90%" id="alg1.l27.m1.6.7.2.2.3.2" xref="alg1.l27.m1.6.7.2.2.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.l27.m1.6.7.2.2.3.1" xref="alg1.l27.m1.6.7.2.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.l27.m1.6.7.2.2.3.3" xref="alg1.l27.m1.6.7.2.2.3.3.cmml">1</mn></mrow><mrow id="alg1.l27.m1.2.2.2.4" xref="alg1.l27.m1.2.2.2.3.cmml"><mi mathsize="90%" id="alg1.l27.m1.1.1.1.1" xref="alg1.l27.m1.1.1.1.1.cmml">c</mi><mo mathsize="90%" id="alg1.l27.m1.2.2.2.4.1" xref="alg1.l27.m1.2.2.2.3.cmml">,</mo><mi mathsize="90%" id="alg1.l27.m1.2.2.2.2" xref="alg1.l27.m1.2.2.2.2.cmml">l</mi></mrow></msubsup><mo mathsize="90%" rspace="0.111em" stretchy="false" id="alg1.l27.m1.6.7.1" xref="alg1.l27.m1.6.7.1.cmml">←</mo><mrow id="alg1.l27.m1.6.7.3" xref="alg1.l27.m1.6.7.3.cmml"><msub id="alg1.l27.m1.6.7.3.1" xref="alg1.l27.m1.6.7.3.1.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" id="alg1.l27.m1.6.7.3.1.2" xref="alg1.l27.m1.6.7.3.1.2.cmml">∑</mo><mrow id="alg1.l27.m1.4.4.2" xref="alg1.l27.m1.4.4.2.cmml"><mi mathsize="90%" id="alg1.l27.m1.4.4.2.4" xref="alg1.l27.m1.4.4.2.4.cmml">i</mi><mo mathsize="90%" id="alg1.l27.m1.4.4.2.3" xref="alg1.l27.m1.4.4.2.3.cmml">∈</mo><mrow id="alg1.l27.m1.4.4.2.5.2" xref="alg1.l27.m1.4.4.2.5.1.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l27.m1.4.4.2.5.2.1" xref="alg1.l27.m1.4.4.2.5.1.cmml">{</mo><mi mathsize="90%" id="alg1.l27.m1.3.3.1.1" xref="alg1.l27.m1.3.3.1.1.cmml">b</mi><mo mathsize="90%" id="alg1.l27.m1.4.4.2.5.2.2" xref="alg1.l27.m1.4.4.2.5.1.cmml">,</mo><mi mathsize="90%" id="alg1.l27.m1.4.4.2.2" xref="alg1.l27.m1.4.4.2.2.cmml">c</mi><mo maxsize="90%" minsize="90%" id="alg1.l27.m1.4.4.2.5.2.3" xref="alg1.l27.m1.4.4.2.5.1.cmml">}</mo></mrow></mrow></msub><mrow id="alg1.l27.m1.6.7.3.2" xref="alg1.l27.m1.6.7.3.2.cmml"><mfrac id="alg1.l27.m1.6.7.3.2.2" xref="alg1.l27.m1.6.7.3.2.2.cmml"><msub id="alg1.l27.m1.6.7.3.2.2.2" xref="alg1.l27.m1.6.7.3.2.2.2.cmml"><mi mathsize="90%" id="alg1.l27.m1.6.7.3.2.2.2.2" xref="alg1.l27.m1.6.7.3.2.2.2.2.cmml">n</mi><mi mathsize="90%" id="alg1.l27.m1.6.7.3.2.2.2.3" xref="alg1.l27.m1.6.7.3.2.2.2.3.cmml">i</mi></msub><mrow id="alg1.l27.m1.6.7.3.2.2.3" xref="alg1.l27.m1.6.7.3.2.2.3.cmml"><msub id="alg1.l27.m1.6.7.3.2.2.3.2" xref="alg1.l27.m1.6.7.3.2.2.3.2.cmml"><mi mathsize="90%" id="alg1.l27.m1.6.7.3.2.2.3.2.2" xref="alg1.l27.m1.6.7.3.2.2.3.2.2.cmml">n</mi><mi mathsize="90%" id="alg1.l27.m1.6.7.3.2.2.3.2.3" xref="alg1.l27.m1.6.7.3.2.2.3.2.3.cmml">b</mi></msub><mo mathsize="90%" id="alg1.l27.m1.6.7.3.2.2.3.1" xref="alg1.l27.m1.6.7.3.2.2.3.1.cmml">+</mo><msub id="alg1.l27.m1.6.7.3.2.2.3.3" xref="alg1.l27.m1.6.7.3.2.2.3.3.cmml"><mi mathsize="90%" id="alg1.l27.m1.6.7.3.2.2.3.3.2" xref="alg1.l27.m1.6.7.3.2.2.3.3.2.cmml">n</mi><mi mathsize="90%" id="alg1.l27.m1.6.7.3.2.2.3.3.3" xref="alg1.l27.m1.6.7.3.2.2.3.3.3.cmml">c</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg1.l27.m1.6.7.3.2.1" xref="alg1.l27.m1.6.7.3.2.1.cmml">​</mo><msubsup id="alg1.l27.m1.6.7.3.2.3" xref="alg1.l27.m1.6.7.3.2.3.cmml"><mi mathsize="90%" id="alg1.l27.m1.6.7.3.2.3.2.2" xref="alg1.l27.m1.6.7.3.2.3.2.2.cmml">θ</mi><mrow id="alg1.l27.m1.6.7.3.2.3.2.3" xref="alg1.l27.m1.6.7.3.2.3.2.3.cmml"><mi mathsize="90%" id="alg1.l27.m1.6.7.3.2.3.2.3.2" xref="alg1.l27.m1.6.7.3.2.3.2.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.l27.m1.6.7.3.2.3.2.3.1" xref="alg1.l27.m1.6.7.3.2.3.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.l27.m1.6.7.3.2.3.2.3.3" xref="alg1.l27.m1.6.7.3.2.3.2.3.3.cmml">1</mn></mrow><mrow id="alg1.l27.m1.6.6.2.4" xref="alg1.l27.m1.6.6.2.3.cmml"><mi mathsize="90%" id="alg1.l27.m1.5.5.1.1" xref="alg1.l27.m1.5.5.1.1.cmml">i</mi><mo mathsize="90%" id="alg1.l27.m1.6.6.2.4.1" xref="alg1.l27.m1.6.6.2.3.cmml">,</mo><mi mathsize="90%" id="alg1.l27.m1.6.6.2.2" xref="alg1.l27.m1.6.6.2.2.cmml">l</mi></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l27.m1.6b"><apply id="alg1.l27.m1.6.7.cmml" xref="alg1.l27.m1.6.7"><ci id="alg1.l27.m1.6.7.1.cmml" xref="alg1.l27.m1.6.7.1">←</ci><apply id="alg1.l27.m1.6.7.2.cmml" xref="alg1.l27.m1.6.7.2"><csymbol cd="ambiguous" id="alg1.l27.m1.6.7.2.1.cmml" xref="alg1.l27.m1.6.7.2">superscript</csymbol><apply id="alg1.l27.m1.6.7.2.2.cmml" xref="alg1.l27.m1.6.7.2"><csymbol cd="ambiguous" id="alg1.l27.m1.6.7.2.2.1.cmml" xref="alg1.l27.m1.6.7.2">subscript</csymbol><ci id="alg1.l27.m1.6.7.2.2.2.cmml" xref="alg1.l27.m1.6.7.2.2.2">𝜃</ci><apply id="alg1.l27.m1.6.7.2.2.3.cmml" xref="alg1.l27.m1.6.7.2.2.3"><plus id="alg1.l27.m1.6.7.2.2.3.1.cmml" xref="alg1.l27.m1.6.7.2.2.3.1"></plus><ci id="alg1.l27.m1.6.7.2.2.3.2.cmml" xref="alg1.l27.m1.6.7.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l27.m1.6.7.2.2.3.3.cmml" xref="alg1.l27.m1.6.7.2.2.3.3">1</cn></apply></apply><list id="alg1.l27.m1.2.2.2.3.cmml" xref="alg1.l27.m1.2.2.2.4"><ci id="alg1.l27.m1.1.1.1.1.cmml" xref="alg1.l27.m1.1.1.1.1">𝑐</ci><ci id="alg1.l27.m1.2.2.2.2.cmml" xref="alg1.l27.m1.2.2.2.2">𝑙</ci></list></apply><apply id="alg1.l27.m1.6.7.3.cmml" xref="alg1.l27.m1.6.7.3"><apply id="alg1.l27.m1.6.7.3.1.cmml" xref="alg1.l27.m1.6.7.3.1"><csymbol cd="ambiguous" id="alg1.l27.m1.6.7.3.1.1.cmml" xref="alg1.l27.m1.6.7.3.1">subscript</csymbol><sum id="alg1.l27.m1.6.7.3.1.2.cmml" xref="alg1.l27.m1.6.7.3.1.2"></sum><apply id="alg1.l27.m1.4.4.2.cmml" xref="alg1.l27.m1.4.4.2"><in id="alg1.l27.m1.4.4.2.3.cmml" xref="alg1.l27.m1.4.4.2.3"></in><ci id="alg1.l27.m1.4.4.2.4.cmml" xref="alg1.l27.m1.4.4.2.4">𝑖</ci><set id="alg1.l27.m1.4.4.2.5.1.cmml" xref="alg1.l27.m1.4.4.2.5.2"><ci id="alg1.l27.m1.3.3.1.1.cmml" xref="alg1.l27.m1.3.3.1.1">𝑏</ci><ci id="alg1.l27.m1.4.4.2.2.cmml" xref="alg1.l27.m1.4.4.2.2">𝑐</ci></set></apply></apply><apply id="alg1.l27.m1.6.7.3.2.cmml" xref="alg1.l27.m1.6.7.3.2"><times id="alg1.l27.m1.6.7.3.2.1.cmml" xref="alg1.l27.m1.6.7.3.2.1"></times><apply id="alg1.l27.m1.6.7.3.2.2.cmml" xref="alg1.l27.m1.6.7.3.2.2"><divide id="alg1.l27.m1.6.7.3.2.2.1.cmml" xref="alg1.l27.m1.6.7.3.2.2"></divide><apply id="alg1.l27.m1.6.7.3.2.2.2.cmml" xref="alg1.l27.m1.6.7.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l27.m1.6.7.3.2.2.2.1.cmml" xref="alg1.l27.m1.6.7.3.2.2.2">subscript</csymbol><ci id="alg1.l27.m1.6.7.3.2.2.2.2.cmml" xref="alg1.l27.m1.6.7.3.2.2.2.2">𝑛</ci><ci id="alg1.l27.m1.6.7.3.2.2.2.3.cmml" xref="alg1.l27.m1.6.7.3.2.2.2.3">𝑖</ci></apply><apply id="alg1.l27.m1.6.7.3.2.2.3.cmml" xref="alg1.l27.m1.6.7.3.2.2.3"><plus id="alg1.l27.m1.6.7.3.2.2.3.1.cmml" xref="alg1.l27.m1.6.7.3.2.2.3.1"></plus><apply id="alg1.l27.m1.6.7.3.2.2.3.2.cmml" xref="alg1.l27.m1.6.7.3.2.2.3.2"><csymbol cd="ambiguous" id="alg1.l27.m1.6.7.3.2.2.3.2.1.cmml" xref="alg1.l27.m1.6.7.3.2.2.3.2">subscript</csymbol><ci id="alg1.l27.m1.6.7.3.2.2.3.2.2.cmml" xref="alg1.l27.m1.6.7.3.2.2.3.2.2">𝑛</ci><ci id="alg1.l27.m1.6.7.3.2.2.3.2.3.cmml" xref="alg1.l27.m1.6.7.3.2.2.3.2.3">𝑏</ci></apply><apply id="alg1.l27.m1.6.7.3.2.2.3.3.cmml" xref="alg1.l27.m1.6.7.3.2.2.3.3"><csymbol cd="ambiguous" id="alg1.l27.m1.6.7.3.2.2.3.3.1.cmml" xref="alg1.l27.m1.6.7.3.2.2.3.3">subscript</csymbol><ci id="alg1.l27.m1.6.7.3.2.2.3.3.2.cmml" xref="alg1.l27.m1.6.7.3.2.2.3.3.2">𝑛</ci><ci id="alg1.l27.m1.6.7.3.2.2.3.3.3.cmml" xref="alg1.l27.m1.6.7.3.2.2.3.3.3">𝑐</ci></apply></apply></apply><apply id="alg1.l27.m1.6.7.3.2.3.cmml" xref="alg1.l27.m1.6.7.3.2.3"><csymbol cd="ambiguous" id="alg1.l27.m1.6.7.3.2.3.1.cmml" xref="alg1.l27.m1.6.7.3.2.3">superscript</csymbol><apply id="alg1.l27.m1.6.7.3.2.3.2.cmml" xref="alg1.l27.m1.6.7.3.2.3"><csymbol cd="ambiguous" id="alg1.l27.m1.6.7.3.2.3.2.1.cmml" xref="alg1.l27.m1.6.7.3.2.3">subscript</csymbol><ci id="alg1.l27.m1.6.7.3.2.3.2.2.cmml" xref="alg1.l27.m1.6.7.3.2.3.2.2">𝜃</ci><apply id="alg1.l27.m1.6.7.3.2.3.2.3.cmml" xref="alg1.l27.m1.6.7.3.2.3.2.3"><plus id="alg1.l27.m1.6.7.3.2.3.2.3.1.cmml" xref="alg1.l27.m1.6.7.3.2.3.2.3.1"></plus><ci id="alg1.l27.m1.6.7.3.2.3.2.3.2.cmml" xref="alg1.l27.m1.6.7.3.2.3.2.3.2">𝑡</ci><cn type="integer" id="alg1.l27.m1.6.7.3.2.3.2.3.3.cmml" xref="alg1.l27.m1.6.7.3.2.3.2.3.3">1</cn></apply></apply><list id="alg1.l27.m1.6.6.2.3.cmml" xref="alg1.l27.m1.6.6.2.4"><ci id="alg1.l27.m1.5.5.1.1.cmml" xref="alg1.l27.m1.5.5.1.1">𝑖</ci><ci id="alg1.l27.m1.6.6.2.2.cmml" xref="alg1.l27.m1.6.6.2.2">𝑙</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l27.m1.6c">\theta_{t+1}^{c,l}\leftarrow\sum_{i\in\{b,c\}}\frac{n_{i}}{n_{b}+n_{c}}\theta_{t+1}^{i,l}</annotation></semantics></math><span id="alg1.l27.3" class="ltx_text" style="font-size:90%;"> for </span><math id="alg1.l27.m2.3" class="ltx_Math" alttext="l\in[L_{a},\cdots,L_{b}-1]" display="inline"><semantics id="alg1.l27.m2.3a"><mrow id="alg1.l27.m2.3.3" xref="alg1.l27.m2.3.3.cmml"><mi mathsize="90%" id="alg1.l27.m2.3.3.4" xref="alg1.l27.m2.3.3.4.cmml">l</mi><mo mathsize="90%" id="alg1.l27.m2.3.3.3" xref="alg1.l27.m2.3.3.3.cmml">∈</mo><mrow id="alg1.l27.m2.3.3.2.2" xref="alg1.l27.m2.3.3.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l27.m2.3.3.2.2.3" xref="alg1.l27.m2.3.3.2.3.cmml">[</mo><msub id="alg1.l27.m2.2.2.1.1.1" xref="alg1.l27.m2.2.2.1.1.1.cmml"><mi mathsize="90%" id="alg1.l27.m2.2.2.1.1.1.2" xref="alg1.l27.m2.2.2.1.1.1.2.cmml">L</mi><mi mathsize="90%" id="alg1.l27.m2.2.2.1.1.1.3" xref="alg1.l27.m2.2.2.1.1.1.3.cmml">a</mi></msub><mo mathsize="90%" id="alg1.l27.m2.3.3.2.2.4" xref="alg1.l27.m2.3.3.2.3.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="alg1.l27.m2.1.1" xref="alg1.l27.m2.1.1.cmml">⋯</mi><mo mathsize="90%" id="alg1.l27.m2.3.3.2.2.5" xref="alg1.l27.m2.3.3.2.3.cmml">,</mo><mrow id="alg1.l27.m2.3.3.2.2.2" xref="alg1.l27.m2.3.3.2.2.2.cmml"><msub id="alg1.l27.m2.3.3.2.2.2.2" xref="alg1.l27.m2.3.3.2.2.2.2.cmml"><mi mathsize="90%" id="alg1.l27.m2.3.3.2.2.2.2.2" xref="alg1.l27.m2.3.3.2.2.2.2.2.cmml">L</mi><mi mathsize="90%" id="alg1.l27.m2.3.3.2.2.2.2.3" xref="alg1.l27.m2.3.3.2.2.2.2.3.cmml">b</mi></msub><mo mathsize="90%" id="alg1.l27.m2.3.3.2.2.2.1" xref="alg1.l27.m2.3.3.2.2.2.1.cmml">−</mo><mn mathsize="90%" id="alg1.l27.m2.3.3.2.2.2.3" xref="alg1.l27.m2.3.3.2.2.2.3.cmml">1</mn></mrow><mo maxsize="90%" minsize="90%" id="alg1.l27.m2.3.3.2.2.6" xref="alg1.l27.m2.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l27.m2.3b"><apply id="alg1.l27.m2.3.3.cmml" xref="alg1.l27.m2.3.3"><in id="alg1.l27.m2.3.3.3.cmml" xref="alg1.l27.m2.3.3.3"></in><ci id="alg1.l27.m2.3.3.4.cmml" xref="alg1.l27.m2.3.3.4">𝑙</ci><list id="alg1.l27.m2.3.3.2.3.cmml" xref="alg1.l27.m2.3.3.2.2"><apply id="alg1.l27.m2.2.2.1.1.1.cmml" xref="alg1.l27.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l27.m2.2.2.1.1.1.1.cmml" xref="alg1.l27.m2.2.2.1.1.1">subscript</csymbol><ci id="alg1.l27.m2.2.2.1.1.1.2.cmml" xref="alg1.l27.m2.2.2.1.1.1.2">𝐿</ci><ci id="alg1.l27.m2.2.2.1.1.1.3.cmml" xref="alg1.l27.m2.2.2.1.1.1.3">𝑎</ci></apply><ci id="alg1.l27.m2.1.1.cmml" xref="alg1.l27.m2.1.1">⋯</ci><apply id="alg1.l27.m2.3.3.2.2.2.cmml" xref="alg1.l27.m2.3.3.2.2.2"><minus id="alg1.l27.m2.3.3.2.2.2.1.cmml" xref="alg1.l27.m2.3.3.2.2.2.1"></minus><apply id="alg1.l27.m2.3.3.2.2.2.2.cmml" xref="alg1.l27.m2.3.3.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l27.m2.3.3.2.2.2.2.1.cmml" xref="alg1.l27.m2.3.3.2.2.2.2">subscript</csymbol><ci id="alg1.l27.m2.3.3.2.2.2.2.2.cmml" xref="alg1.l27.m2.3.3.2.2.2.2.2">𝐿</ci><ci id="alg1.l27.m2.3.3.2.2.2.2.3.cmml" xref="alg1.l27.m2.3.3.2.2.2.2.3">𝑏</ci></apply><cn type="integer" id="alg1.l27.m2.3.3.2.2.2.3.cmml" xref="alg1.l27.m2.3.3.2.2.2.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l27.m2.3c">l\in[L_{a},\cdots,L_{b}-1]</annotation></semantics></math><span id="alg1.l27.4" class="ltx_text" style="font-size:90%;">

</span>
</div>
<div id="alg1.l28" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l28.1.1.1" class="ltx_text" style="font-size:80%;">28:</span></span><span id="alg1.l28.2" class="ltx_text" style="font-size:90%;">     Update </span><math id="alg1.l28.m1.10" class="ltx_Math" alttext="\theta_{t+1}^{a}\leftarrow\theta_{t+1}^{c,1:L_{a}-1}\circ\theta_{t+1}^{a,L_{a}},\theta_{t+1}^{b}\leftarrow\theta_{t+1}^{c,1:L_{b}-1}\circ\theta_{t+1}^{b,L_{b}}" display="inline"><semantics id="alg1.l28.m1.10a"><mrow id="alg1.l28.m1.10.10.2" xref="alg1.l28.m1.10.10.3.cmml"><mrow id="alg1.l28.m1.9.9.1.1" xref="alg1.l28.m1.9.9.1.1.cmml"><msubsup id="alg1.l28.m1.9.9.1.1.2" xref="alg1.l28.m1.9.9.1.1.2.cmml"><mi mathsize="90%" id="alg1.l28.m1.9.9.1.1.2.2.2" xref="alg1.l28.m1.9.9.1.1.2.2.2.cmml">θ</mi><mrow id="alg1.l28.m1.9.9.1.1.2.2.3" xref="alg1.l28.m1.9.9.1.1.2.2.3.cmml"><mi mathsize="90%" id="alg1.l28.m1.9.9.1.1.2.2.3.2" xref="alg1.l28.m1.9.9.1.1.2.2.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.l28.m1.9.9.1.1.2.2.3.1" xref="alg1.l28.m1.9.9.1.1.2.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.l28.m1.9.9.1.1.2.2.3.3" xref="alg1.l28.m1.9.9.1.1.2.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="alg1.l28.m1.9.9.1.1.2.3" xref="alg1.l28.m1.9.9.1.1.2.3.cmml">a</mi></msubsup><mo mathsize="90%" stretchy="false" id="alg1.l28.m1.9.9.1.1.1" xref="alg1.l28.m1.9.9.1.1.1.cmml">←</mo><mrow id="alg1.l28.m1.9.9.1.1.3" xref="alg1.l28.m1.9.9.1.1.3.cmml"><msubsup id="alg1.l28.m1.9.9.1.1.3.2" xref="alg1.l28.m1.9.9.1.1.3.2.cmml"><mi mathsize="90%" id="alg1.l28.m1.9.9.1.1.3.2.2.2" xref="alg1.l28.m1.9.9.1.1.3.2.2.2.cmml">θ</mi><mrow id="alg1.l28.m1.9.9.1.1.3.2.2.3" xref="alg1.l28.m1.9.9.1.1.3.2.2.3.cmml"><mi mathsize="90%" id="alg1.l28.m1.9.9.1.1.3.2.2.3.2" xref="alg1.l28.m1.9.9.1.1.3.2.2.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.l28.m1.9.9.1.1.3.2.2.3.1" xref="alg1.l28.m1.9.9.1.1.3.2.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.l28.m1.9.9.1.1.3.2.2.3.3" xref="alg1.l28.m1.9.9.1.1.3.2.2.3.3.cmml">1</mn></mrow><mrow id="alg1.l28.m1.2.2.2" xref="alg1.l28.m1.2.2.2.cmml"><mrow id="alg1.l28.m1.2.2.2.4.2" xref="alg1.l28.m1.2.2.2.4.1.cmml"><mi mathsize="90%" id="alg1.l28.m1.1.1.1.1" xref="alg1.l28.m1.1.1.1.1.cmml">c</mi><mo mathsize="90%" id="alg1.l28.m1.2.2.2.4.2.1" xref="alg1.l28.m1.2.2.2.4.1.cmml">,</mo><mn mathsize="90%" id="alg1.l28.m1.2.2.2.2" xref="alg1.l28.m1.2.2.2.2.cmml">1</mn></mrow><mo lspace="0.278em" mathsize="90%" rspace="0.278em" id="alg1.l28.m1.2.2.2.3" xref="alg1.l28.m1.2.2.2.3.cmml">:</mo><mrow id="alg1.l28.m1.2.2.2.5" xref="alg1.l28.m1.2.2.2.5.cmml"><msub id="alg1.l28.m1.2.2.2.5.2" xref="alg1.l28.m1.2.2.2.5.2.cmml"><mi mathsize="90%" id="alg1.l28.m1.2.2.2.5.2.2" xref="alg1.l28.m1.2.2.2.5.2.2.cmml">L</mi><mi mathsize="90%" id="alg1.l28.m1.2.2.2.5.2.3" xref="alg1.l28.m1.2.2.2.5.2.3.cmml">a</mi></msub><mo mathsize="90%" id="alg1.l28.m1.2.2.2.5.1" xref="alg1.l28.m1.2.2.2.5.1.cmml">−</mo><mn mathsize="90%" id="alg1.l28.m1.2.2.2.5.3" xref="alg1.l28.m1.2.2.2.5.3.cmml">1</mn></mrow></mrow></msubsup><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="alg1.l28.m1.9.9.1.1.3.1" xref="alg1.l28.m1.9.9.1.1.3.1.cmml">∘</mo><msubsup id="alg1.l28.m1.9.9.1.1.3.3" xref="alg1.l28.m1.9.9.1.1.3.3.cmml"><mi mathsize="90%" id="alg1.l28.m1.9.9.1.1.3.3.2.2" xref="alg1.l28.m1.9.9.1.1.3.3.2.2.cmml">θ</mi><mrow id="alg1.l28.m1.9.9.1.1.3.3.2.3" xref="alg1.l28.m1.9.9.1.1.3.3.2.3.cmml"><mi mathsize="90%" id="alg1.l28.m1.9.9.1.1.3.3.2.3.2" xref="alg1.l28.m1.9.9.1.1.3.3.2.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.l28.m1.9.9.1.1.3.3.2.3.1" xref="alg1.l28.m1.9.9.1.1.3.3.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.l28.m1.9.9.1.1.3.3.2.3.3" xref="alg1.l28.m1.9.9.1.1.3.3.2.3.3.cmml">1</mn></mrow><mrow id="alg1.l28.m1.4.4.2.2" xref="alg1.l28.m1.4.4.2.3.cmml"><mi mathsize="90%" id="alg1.l28.m1.3.3.1.1" xref="alg1.l28.m1.3.3.1.1.cmml">a</mi><mo mathsize="90%" id="alg1.l28.m1.4.4.2.2.2" xref="alg1.l28.m1.4.4.2.3.cmml">,</mo><msub id="alg1.l28.m1.4.4.2.2.1" xref="alg1.l28.m1.4.4.2.2.1.cmml"><mi mathsize="90%" id="alg1.l28.m1.4.4.2.2.1.2" xref="alg1.l28.m1.4.4.2.2.1.2.cmml">L</mi><mi mathsize="90%" id="alg1.l28.m1.4.4.2.2.1.3" xref="alg1.l28.m1.4.4.2.2.1.3.cmml">a</mi></msub></mrow></msubsup></mrow></mrow><mo mathsize="90%" id="alg1.l28.m1.10.10.2.3" xref="alg1.l28.m1.10.10.3a.cmml">,</mo><mrow id="alg1.l28.m1.10.10.2.2" xref="alg1.l28.m1.10.10.2.2.cmml"><msubsup id="alg1.l28.m1.10.10.2.2.2" xref="alg1.l28.m1.10.10.2.2.2.cmml"><mi mathsize="90%" id="alg1.l28.m1.10.10.2.2.2.2.2" xref="alg1.l28.m1.10.10.2.2.2.2.2.cmml">θ</mi><mrow id="alg1.l28.m1.10.10.2.2.2.2.3" xref="alg1.l28.m1.10.10.2.2.2.2.3.cmml"><mi mathsize="90%" id="alg1.l28.m1.10.10.2.2.2.2.3.2" xref="alg1.l28.m1.10.10.2.2.2.2.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.l28.m1.10.10.2.2.2.2.3.1" xref="alg1.l28.m1.10.10.2.2.2.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.l28.m1.10.10.2.2.2.2.3.3" xref="alg1.l28.m1.10.10.2.2.2.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="alg1.l28.m1.10.10.2.2.2.3" xref="alg1.l28.m1.10.10.2.2.2.3.cmml">b</mi></msubsup><mo mathsize="90%" stretchy="false" id="alg1.l28.m1.10.10.2.2.1" xref="alg1.l28.m1.10.10.2.2.1.cmml">←</mo><mrow id="alg1.l28.m1.10.10.2.2.3" xref="alg1.l28.m1.10.10.2.2.3.cmml"><msubsup id="alg1.l28.m1.10.10.2.2.3.2" xref="alg1.l28.m1.10.10.2.2.3.2.cmml"><mi mathsize="90%" id="alg1.l28.m1.10.10.2.2.3.2.2.2" xref="alg1.l28.m1.10.10.2.2.3.2.2.2.cmml">θ</mi><mrow id="alg1.l28.m1.10.10.2.2.3.2.2.3" xref="alg1.l28.m1.10.10.2.2.3.2.2.3.cmml"><mi mathsize="90%" id="alg1.l28.m1.10.10.2.2.3.2.2.3.2" xref="alg1.l28.m1.10.10.2.2.3.2.2.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.l28.m1.10.10.2.2.3.2.2.3.1" xref="alg1.l28.m1.10.10.2.2.3.2.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.l28.m1.10.10.2.2.3.2.2.3.3" xref="alg1.l28.m1.10.10.2.2.3.2.2.3.3.cmml">1</mn></mrow><mrow id="alg1.l28.m1.6.6.2" xref="alg1.l28.m1.6.6.2.cmml"><mrow id="alg1.l28.m1.6.6.2.4.2" xref="alg1.l28.m1.6.6.2.4.1.cmml"><mi mathsize="90%" id="alg1.l28.m1.5.5.1.1" xref="alg1.l28.m1.5.5.1.1.cmml">c</mi><mo mathsize="90%" id="alg1.l28.m1.6.6.2.4.2.1" xref="alg1.l28.m1.6.6.2.4.1.cmml">,</mo><mn mathsize="90%" id="alg1.l28.m1.6.6.2.2" xref="alg1.l28.m1.6.6.2.2.cmml">1</mn></mrow><mo lspace="0.278em" mathsize="90%" rspace="0.278em" id="alg1.l28.m1.6.6.2.3" xref="alg1.l28.m1.6.6.2.3.cmml">:</mo><mrow id="alg1.l28.m1.6.6.2.5" xref="alg1.l28.m1.6.6.2.5.cmml"><msub id="alg1.l28.m1.6.6.2.5.2" xref="alg1.l28.m1.6.6.2.5.2.cmml"><mi mathsize="90%" id="alg1.l28.m1.6.6.2.5.2.2" xref="alg1.l28.m1.6.6.2.5.2.2.cmml">L</mi><mi mathsize="90%" id="alg1.l28.m1.6.6.2.5.2.3" xref="alg1.l28.m1.6.6.2.5.2.3.cmml">b</mi></msub><mo mathsize="90%" id="alg1.l28.m1.6.6.2.5.1" xref="alg1.l28.m1.6.6.2.5.1.cmml">−</mo><mn mathsize="90%" id="alg1.l28.m1.6.6.2.5.3" xref="alg1.l28.m1.6.6.2.5.3.cmml">1</mn></mrow></mrow></msubsup><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="alg1.l28.m1.10.10.2.2.3.1" xref="alg1.l28.m1.10.10.2.2.3.1.cmml">∘</mo><msubsup id="alg1.l28.m1.10.10.2.2.3.3" xref="alg1.l28.m1.10.10.2.2.3.3.cmml"><mi mathsize="90%" id="alg1.l28.m1.10.10.2.2.3.3.2.2" xref="alg1.l28.m1.10.10.2.2.3.3.2.2.cmml">θ</mi><mrow id="alg1.l28.m1.10.10.2.2.3.3.2.3" xref="alg1.l28.m1.10.10.2.2.3.3.2.3.cmml"><mi mathsize="90%" id="alg1.l28.m1.10.10.2.2.3.3.2.3.2" xref="alg1.l28.m1.10.10.2.2.3.3.2.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.l28.m1.10.10.2.2.3.3.2.3.1" xref="alg1.l28.m1.10.10.2.2.3.3.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.l28.m1.10.10.2.2.3.3.2.3.3" xref="alg1.l28.m1.10.10.2.2.3.3.2.3.3.cmml">1</mn></mrow><mrow id="alg1.l28.m1.8.8.2.2" xref="alg1.l28.m1.8.8.2.3.cmml"><mi mathsize="90%" id="alg1.l28.m1.7.7.1.1" xref="alg1.l28.m1.7.7.1.1.cmml">b</mi><mo mathsize="90%" id="alg1.l28.m1.8.8.2.2.2" xref="alg1.l28.m1.8.8.2.3.cmml">,</mo><msub id="alg1.l28.m1.8.8.2.2.1" xref="alg1.l28.m1.8.8.2.2.1.cmml"><mi mathsize="90%" id="alg1.l28.m1.8.8.2.2.1.2" xref="alg1.l28.m1.8.8.2.2.1.2.cmml">L</mi><mi mathsize="90%" id="alg1.l28.m1.8.8.2.2.1.3" xref="alg1.l28.m1.8.8.2.2.1.3.cmml">b</mi></msub></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l28.m1.10b"><apply id="alg1.l28.m1.10.10.3.cmml" xref="alg1.l28.m1.10.10.2"><csymbol cd="ambiguous" id="alg1.l28.m1.10.10.3a.cmml" xref="alg1.l28.m1.10.10.2.3">formulae-sequence</csymbol><apply id="alg1.l28.m1.9.9.1.1.cmml" xref="alg1.l28.m1.9.9.1.1"><ci id="alg1.l28.m1.9.9.1.1.1.cmml" xref="alg1.l28.m1.9.9.1.1.1">←</ci><apply id="alg1.l28.m1.9.9.1.1.2.cmml" xref="alg1.l28.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="alg1.l28.m1.9.9.1.1.2.1.cmml" xref="alg1.l28.m1.9.9.1.1.2">superscript</csymbol><apply id="alg1.l28.m1.9.9.1.1.2.2.cmml" xref="alg1.l28.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="alg1.l28.m1.9.9.1.1.2.2.1.cmml" xref="alg1.l28.m1.9.9.1.1.2">subscript</csymbol><ci id="alg1.l28.m1.9.9.1.1.2.2.2.cmml" xref="alg1.l28.m1.9.9.1.1.2.2.2">𝜃</ci><apply id="alg1.l28.m1.9.9.1.1.2.2.3.cmml" xref="alg1.l28.m1.9.9.1.1.2.2.3"><plus id="alg1.l28.m1.9.9.1.1.2.2.3.1.cmml" xref="alg1.l28.m1.9.9.1.1.2.2.3.1"></plus><ci id="alg1.l28.m1.9.9.1.1.2.2.3.2.cmml" xref="alg1.l28.m1.9.9.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l28.m1.9.9.1.1.2.2.3.3.cmml" xref="alg1.l28.m1.9.9.1.1.2.2.3.3">1</cn></apply></apply><ci id="alg1.l28.m1.9.9.1.1.2.3.cmml" xref="alg1.l28.m1.9.9.1.1.2.3">𝑎</ci></apply><apply id="alg1.l28.m1.9.9.1.1.3.cmml" xref="alg1.l28.m1.9.9.1.1.3"><compose id="alg1.l28.m1.9.9.1.1.3.1.cmml" xref="alg1.l28.m1.9.9.1.1.3.1"></compose><apply id="alg1.l28.m1.9.9.1.1.3.2.cmml" xref="alg1.l28.m1.9.9.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l28.m1.9.9.1.1.3.2.1.cmml" xref="alg1.l28.m1.9.9.1.1.3.2">superscript</csymbol><apply id="alg1.l28.m1.9.9.1.1.3.2.2.cmml" xref="alg1.l28.m1.9.9.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l28.m1.9.9.1.1.3.2.2.1.cmml" xref="alg1.l28.m1.9.9.1.1.3.2">subscript</csymbol><ci id="alg1.l28.m1.9.9.1.1.3.2.2.2.cmml" xref="alg1.l28.m1.9.9.1.1.3.2.2.2">𝜃</ci><apply id="alg1.l28.m1.9.9.1.1.3.2.2.3.cmml" xref="alg1.l28.m1.9.9.1.1.3.2.2.3"><plus id="alg1.l28.m1.9.9.1.1.3.2.2.3.1.cmml" xref="alg1.l28.m1.9.9.1.1.3.2.2.3.1"></plus><ci id="alg1.l28.m1.9.9.1.1.3.2.2.3.2.cmml" xref="alg1.l28.m1.9.9.1.1.3.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l28.m1.9.9.1.1.3.2.2.3.3.cmml" xref="alg1.l28.m1.9.9.1.1.3.2.2.3.3">1</cn></apply></apply><apply id="alg1.l28.m1.2.2.2.cmml" xref="alg1.l28.m1.2.2.2"><ci id="alg1.l28.m1.2.2.2.3.cmml" xref="alg1.l28.m1.2.2.2.3">:</ci><list id="alg1.l28.m1.2.2.2.4.1.cmml" xref="alg1.l28.m1.2.2.2.4.2"><ci id="alg1.l28.m1.1.1.1.1.cmml" xref="alg1.l28.m1.1.1.1.1">𝑐</ci><cn type="integer" id="alg1.l28.m1.2.2.2.2.cmml" xref="alg1.l28.m1.2.2.2.2">1</cn></list><apply id="alg1.l28.m1.2.2.2.5.cmml" xref="alg1.l28.m1.2.2.2.5"><minus id="alg1.l28.m1.2.2.2.5.1.cmml" xref="alg1.l28.m1.2.2.2.5.1"></minus><apply id="alg1.l28.m1.2.2.2.5.2.cmml" xref="alg1.l28.m1.2.2.2.5.2"><csymbol cd="ambiguous" id="alg1.l28.m1.2.2.2.5.2.1.cmml" xref="alg1.l28.m1.2.2.2.5.2">subscript</csymbol><ci id="alg1.l28.m1.2.2.2.5.2.2.cmml" xref="alg1.l28.m1.2.2.2.5.2.2">𝐿</ci><ci id="alg1.l28.m1.2.2.2.5.2.3.cmml" xref="alg1.l28.m1.2.2.2.5.2.3">𝑎</ci></apply><cn type="integer" id="alg1.l28.m1.2.2.2.5.3.cmml" xref="alg1.l28.m1.2.2.2.5.3">1</cn></apply></apply></apply><apply id="alg1.l28.m1.9.9.1.1.3.3.cmml" xref="alg1.l28.m1.9.9.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l28.m1.9.9.1.1.3.3.1.cmml" xref="alg1.l28.m1.9.9.1.1.3.3">superscript</csymbol><apply id="alg1.l28.m1.9.9.1.1.3.3.2.cmml" xref="alg1.l28.m1.9.9.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l28.m1.9.9.1.1.3.3.2.1.cmml" xref="alg1.l28.m1.9.9.1.1.3.3">subscript</csymbol><ci id="alg1.l28.m1.9.9.1.1.3.3.2.2.cmml" xref="alg1.l28.m1.9.9.1.1.3.3.2.2">𝜃</ci><apply id="alg1.l28.m1.9.9.1.1.3.3.2.3.cmml" xref="alg1.l28.m1.9.9.1.1.3.3.2.3"><plus id="alg1.l28.m1.9.9.1.1.3.3.2.3.1.cmml" xref="alg1.l28.m1.9.9.1.1.3.3.2.3.1"></plus><ci id="alg1.l28.m1.9.9.1.1.3.3.2.3.2.cmml" xref="alg1.l28.m1.9.9.1.1.3.3.2.3.2">𝑡</ci><cn type="integer" id="alg1.l28.m1.9.9.1.1.3.3.2.3.3.cmml" xref="alg1.l28.m1.9.9.1.1.3.3.2.3.3">1</cn></apply></apply><list id="alg1.l28.m1.4.4.2.3.cmml" xref="alg1.l28.m1.4.4.2.2"><ci id="alg1.l28.m1.3.3.1.1.cmml" xref="alg1.l28.m1.3.3.1.1">𝑎</ci><apply id="alg1.l28.m1.4.4.2.2.1.cmml" xref="alg1.l28.m1.4.4.2.2.1"><csymbol cd="ambiguous" id="alg1.l28.m1.4.4.2.2.1.1.cmml" xref="alg1.l28.m1.4.4.2.2.1">subscript</csymbol><ci id="alg1.l28.m1.4.4.2.2.1.2.cmml" xref="alg1.l28.m1.4.4.2.2.1.2">𝐿</ci><ci id="alg1.l28.m1.4.4.2.2.1.3.cmml" xref="alg1.l28.m1.4.4.2.2.1.3">𝑎</ci></apply></list></apply></apply></apply><apply id="alg1.l28.m1.10.10.2.2.cmml" xref="alg1.l28.m1.10.10.2.2"><ci id="alg1.l28.m1.10.10.2.2.1.cmml" xref="alg1.l28.m1.10.10.2.2.1">←</ci><apply id="alg1.l28.m1.10.10.2.2.2.cmml" xref="alg1.l28.m1.10.10.2.2.2"><csymbol cd="ambiguous" id="alg1.l28.m1.10.10.2.2.2.1.cmml" xref="alg1.l28.m1.10.10.2.2.2">superscript</csymbol><apply id="alg1.l28.m1.10.10.2.2.2.2.cmml" xref="alg1.l28.m1.10.10.2.2.2"><csymbol cd="ambiguous" id="alg1.l28.m1.10.10.2.2.2.2.1.cmml" xref="alg1.l28.m1.10.10.2.2.2">subscript</csymbol><ci id="alg1.l28.m1.10.10.2.2.2.2.2.cmml" xref="alg1.l28.m1.10.10.2.2.2.2.2">𝜃</ci><apply id="alg1.l28.m1.10.10.2.2.2.2.3.cmml" xref="alg1.l28.m1.10.10.2.2.2.2.3"><plus id="alg1.l28.m1.10.10.2.2.2.2.3.1.cmml" xref="alg1.l28.m1.10.10.2.2.2.2.3.1"></plus><ci id="alg1.l28.m1.10.10.2.2.2.2.3.2.cmml" xref="alg1.l28.m1.10.10.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l28.m1.10.10.2.2.2.2.3.3.cmml" xref="alg1.l28.m1.10.10.2.2.2.2.3.3">1</cn></apply></apply><ci id="alg1.l28.m1.10.10.2.2.2.3.cmml" xref="alg1.l28.m1.10.10.2.2.2.3">𝑏</ci></apply><apply id="alg1.l28.m1.10.10.2.2.3.cmml" xref="alg1.l28.m1.10.10.2.2.3"><compose id="alg1.l28.m1.10.10.2.2.3.1.cmml" xref="alg1.l28.m1.10.10.2.2.3.1"></compose><apply id="alg1.l28.m1.10.10.2.2.3.2.cmml" xref="alg1.l28.m1.10.10.2.2.3.2"><csymbol cd="ambiguous" id="alg1.l28.m1.10.10.2.2.3.2.1.cmml" xref="alg1.l28.m1.10.10.2.2.3.2">superscript</csymbol><apply id="alg1.l28.m1.10.10.2.2.3.2.2.cmml" xref="alg1.l28.m1.10.10.2.2.3.2"><csymbol cd="ambiguous" id="alg1.l28.m1.10.10.2.2.3.2.2.1.cmml" xref="alg1.l28.m1.10.10.2.2.3.2">subscript</csymbol><ci id="alg1.l28.m1.10.10.2.2.3.2.2.2.cmml" xref="alg1.l28.m1.10.10.2.2.3.2.2.2">𝜃</ci><apply id="alg1.l28.m1.10.10.2.2.3.2.2.3.cmml" xref="alg1.l28.m1.10.10.2.2.3.2.2.3"><plus id="alg1.l28.m1.10.10.2.2.3.2.2.3.1.cmml" xref="alg1.l28.m1.10.10.2.2.3.2.2.3.1"></plus><ci id="alg1.l28.m1.10.10.2.2.3.2.2.3.2.cmml" xref="alg1.l28.m1.10.10.2.2.3.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l28.m1.10.10.2.2.3.2.2.3.3.cmml" xref="alg1.l28.m1.10.10.2.2.3.2.2.3.3">1</cn></apply></apply><apply id="alg1.l28.m1.6.6.2.cmml" xref="alg1.l28.m1.6.6.2"><ci id="alg1.l28.m1.6.6.2.3.cmml" xref="alg1.l28.m1.6.6.2.3">:</ci><list id="alg1.l28.m1.6.6.2.4.1.cmml" xref="alg1.l28.m1.6.6.2.4.2"><ci id="alg1.l28.m1.5.5.1.1.cmml" xref="alg1.l28.m1.5.5.1.1">𝑐</ci><cn type="integer" id="alg1.l28.m1.6.6.2.2.cmml" xref="alg1.l28.m1.6.6.2.2">1</cn></list><apply id="alg1.l28.m1.6.6.2.5.cmml" xref="alg1.l28.m1.6.6.2.5"><minus id="alg1.l28.m1.6.6.2.5.1.cmml" xref="alg1.l28.m1.6.6.2.5.1"></minus><apply id="alg1.l28.m1.6.6.2.5.2.cmml" xref="alg1.l28.m1.6.6.2.5.2"><csymbol cd="ambiguous" id="alg1.l28.m1.6.6.2.5.2.1.cmml" xref="alg1.l28.m1.6.6.2.5.2">subscript</csymbol><ci id="alg1.l28.m1.6.6.2.5.2.2.cmml" xref="alg1.l28.m1.6.6.2.5.2.2">𝐿</ci><ci id="alg1.l28.m1.6.6.2.5.2.3.cmml" xref="alg1.l28.m1.6.6.2.5.2.3">𝑏</ci></apply><cn type="integer" id="alg1.l28.m1.6.6.2.5.3.cmml" xref="alg1.l28.m1.6.6.2.5.3">1</cn></apply></apply></apply><apply id="alg1.l28.m1.10.10.2.2.3.3.cmml" xref="alg1.l28.m1.10.10.2.2.3.3"><csymbol cd="ambiguous" id="alg1.l28.m1.10.10.2.2.3.3.1.cmml" xref="alg1.l28.m1.10.10.2.2.3.3">superscript</csymbol><apply id="alg1.l28.m1.10.10.2.2.3.3.2.cmml" xref="alg1.l28.m1.10.10.2.2.3.3"><csymbol cd="ambiguous" id="alg1.l28.m1.10.10.2.2.3.3.2.1.cmml" xref="alg1.l28.m1.10.10.2.2.3.3">subscript</csymbol><ci id="alg1.l28.m1.10.10.2.2.3.3.2.2.cmml" xref="alg1.l28.m1.10.10.2.2.3.3.2.2">𝜃</ci><apply id="alg1.l28.m1.10.10.2.2.3.3.2.3.cmml" xref="alg1.l28.m1.10.10.2.2.3.3.2.3"><plus id="alg1.l28.m1.10.10.2.2.3.3.2.3.1.cmml" xref="alg1.l28.m1.10.10.2.2.3.3.2.3.1"></plus><ci id="alg1.l28.m1.10.10.2.2.3.3.2.3.2.cmml" xref="alg1.l28.m1.10.10.2.2.3.3.2.3.2">𝑡</ci><cn type="integer" id="alg1.l28.m1.10.10.2.2.3.3.2.3.3.cmml" xref="alg1.l28.m1.10.10.2.2.3.3.2.3.3">1</cn></apply></apply><list id="alg1.l28.m1.8.8.2.3.cmml" xref="alg1.l28.m1.8.8.2.2"><ci id="alg1.l28.m1.7.7.1.1.cmml" xref="alg1.l28.m1.7.7.1.1">𝑏</ci><apply id="alg1.l28.m1.8.8.2.2.1.cmml" xref="alg1.l28.m1.8.8.2.2.1"><csymbol cd="ambiguous" id="alg1.l28.m1.8.8.2.2.1.1.cmml" xref="alg1.l28.m1.8.8.2.2.1">subscript</csymbol><ci id="alg1.l28.m1.8.8.2.2.1.2.cmml" xref="alg1.l28.m1.8.8.2.2.1.2">𝐿</ci><ci id="alg1.l28.m1.8.8.2.2.1.3.cmml" xref="alg1.l28.m1.8.8.2.2.1.3">𝑏</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l28.m1.10c">\theta_{t+1}^{a}\leftarrow\theta_{t+1}^{c,1:L_{a}-1}\circ\theta_{t+1}^{a,L_{a}},\theta_{t+1}^{b}\leftarrow\theta_{t+1}^{c,1:L_{b}-1}\circ\theta_{t+1}^{b,L_{b}}</annotation></semantics></math><span id="alg1.l28.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l29" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l29.1.1.1" class="ltx_text" style="font-size:80%;">29:</span></span><span id="alg1.l29.2" class="ltx_text" style="font-size:90%;">     </span><math id="alg1.l29.m1.2" class="ltx_Math" alttext="w_{t+1}^{a}\leftarrow\theta_{t+1}^{a}\circ f_{t+1}^{a},w_{t+1}^{b}\leftarrow\theta_{t+1}^{b}\circ f_{t+1}^{b},w_{t+1}^{c}\leftarrow\theta_{t+1}^{c}\circ f_{t+1}^{c}" display="inline"><semantics id="alg1.l29.m1.2a"><mrow id="alg1.l29.m1.2.2.2" xref="alg1.l29.m1.2.2.3.cmml"><mrow id="alg1.l29.m1.1.1.1.1" xref="alg1.l29.m1.1.1.1.1.cmml"><msubsup id="alg1.l29.m1.1.1.1.1.2" xref="alg1.l29.m1.1.1.1.1.2.cmml"><mi mathsize="90%" id="alg1.l29.m1.1.1.1.1.2.2.2" xref="alg1.l29.m1.1.1.1.1.2.2.2.cmml">w</mi><mrow id="alg1.l29.m1.1.1.1.1.2.2.3" xref="alg1.l29.m1.1.1.1.1.2.2.3.cmml"><mi mathsize="90%" id="alg1.l29.m1.1.1.1.1.2.2.3.2" xref="alg1.l29.m1.1.1.1.1.2.2.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.l29.m1.1.1.1.1.2.2.3.1" xref="alg1.l29.m1.1.1.1.1.2.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.l29.m1.1.1.1.1.2.2.3.3" xref="alg1.l29.m1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="alg1.l29.m1.1.1.1.1.2.3" xref="alg1.l29.m1.1.1.1.1.2.3.cmml">a</mi></msubsup><mo mathsize="90%" stretchy="false" id="alg1.l29.m1.1.1.1.1.1" xref="alg1.l29.m1.1.1.1.1.1.cmml">←</mo><mrow id="alg1.l29.m1.1.1.1.1.3" xref="alg1.l29.m1.1.1.1.1.3.cmml"><msubsup id="alg1.l29.m1.1.1.1.1.3.2" xref="alg1.l29.m1.1.1.1.1.3.2.cmml"><mi mathsize="90%" id="alg1.l29.m1.1.1.1.1.3.2.2.2" xref="alg1.l29.m1.1.1.1.1.3.2.2.2.cmml">θ</mi><mrow id="alg1.l29.m1.1.1.1.1.3.2.2.3" xref="alg1.l29.m1.1.1.1.1.3.2.2.3.cmml"><mi mathsize="90%" id="alg1.l29.m1.1.1.1.1.3.2.2.3.2" xref="alg1.l29.m1.1.1.1.1.3.2.2.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.l29.m1.1.1.1.1.3.2.2.3.1" xref="alg1.l29.m1.1.1.1.1.3.2.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.l29.m1.1.1.1.1.3.2.2.3.3" xref="alg1.l29.m1.1.1.1.1.3.2.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="alg1.l29.m1.1.1.1.1.3.2.3" xref="alg1.l29.m1.1.1.1.1.3.2.3.cmml">a</mi></msubsup><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="alg1.l29.m1.1.1.1.1.3.1" xref="alg1.l29.m1.1.1.1.1.3.1.cmml">∘</mo><msubsup id="alg1.l29.m1.1.1.1.1.3.3" xref="alg1.l29.m1.1.1.1.1.3.3.cmml"><mi mathsize="90%" id="alg1.l29.m1.1.1.1.1.3.3.2.2" xref="alg1.l29.m1.1.1.1.1.3.3.2.2.cmml">f</mi><mrow id="alg1.l29.m1.1.1.1.1.3.3.2.3" xref="alg1.l29.m1.1.1.1.1.3.3.2.3.cmml"><mi mathsize="90%" id="alg1.l29.m1.1.1.1.1.3.3.2.3.2" xref="alg1.l29.m1.1.1.1.1.3.3.2.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.l29.m1.1.1.1.1.3.3.2.3.1" xref="alg1.l29.m1.1.1.1.1.3.3.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.l29.m1.1.1.1.1.3.3.2.3.3" xref="alg1.l29.m1.1.1.1.1.3.3.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="alg1.l29.m1.1.1.1.1.3.3.3" xref="alg1.l29.m1.1.1.1.1.3.3.3.cmml">a</mi></msubsup></mrow></mrow><mo mathsize="90%" id="alg1.l29.m1.2.2.2.3" xref="alg1.l29.m1.2.2.3a.cmml">,</mo><mrow id="alg1.l29.m1.2.2.2.2.2" xref="alg1.l29.m1.2.2.2.2.3.cmml"><mrow id="alg1.l29.m1.2.2.2.2.1.1" xref="alg1.l29.m1.2.2.2.2.1.1.cmml"><msubsup id="alg1.l29.m1.2.2.2.2.1.1.2" xref="alg1.l29.m1.2.2.2.2.1.1.2.cmml"><mi mathsize="90%" id="alg1.l29.m1.2.2.2.2.1.1.2.2.2" xref="alg1.l29.m1.2.2.2.2.1.1.2.2.2.cmml">w</mi><mrow id="alg1.l29.m1.2.2.2.2.1.1.2.2.3" xref="alg1.l29.m1.2.2.2.2.1.1.2.2.3.cmml"><mi mathsize="90%" id="alg1.l29.m1.2.2.2.2.1.1.2.2.3.2" xref="alg1.l29.m1.2.2.2.2.1.1.2.2.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.l29.m1.2.2.2.2.1.1.2.2.3.1" xref="alg1.l29.m1.2.2.2.2.1.1.2.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.l29.m1.2.2.2.2.1.1.2.2.3.3" xref="alg1.l29.m1.2.2.2.2.1.1.2.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="alg1.l29.m1.2.2.2.2.1.1.2.3" xref="alg1.l29.m1.2.2.2.2.1.1.2.3.cmml">b</mi></msubsup><mo mathsize="90%" stretchy="false" id="alg1.l29.m1.2.2.2.2.1.1.1" xref="alg1.l29.m1.2.2.2.2.1.1.1.cmml">←</mo><mrow id="alg1.l29.m1.2.2.2.2.1.1.3" xref="alg1.l29.m1.2.2.2.2.1.1.3.cmml"><msubsup id="alg1.l29.m1.2.2.2.2.1.1.3.2" xref="alg1.l29.m1.2.2.2.2.1.1.3.2.cmml"><mi mathsize="90%" id="alg1.l29.m1.2.2.2.2.1.1.3.2.2.2" xref="alg1.l29.m1.2.2.2.2.1.1.3.2.2.2.cmml">θ</mi><mrow id="alg1.l29.m1.2.2.2.2.1.1.3.2.2.3" xref="alg1.l29.m1.2.2.2.2.1.1.3.2.2.3.cmml"><mi mathsize="90%" id="alg1.l29.m1.2.2.2.2.1.1.3.2.2.3.2" xref="alg1.l29.m1.2.2.2.2.1.1.3.2.2.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.l29.m1.2.2.2.2.1.1.3.2.2.3.1" xref="alg1.l29.m1.2.2.2.2.1.1.3.2.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.l29.m1.2.2.2.2.1.1.3.2.2.3.3" xref="alg1.l29.m1.2.2.2.2.1.1.3.2.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="alg1.l29.m1.2.2.2.2.1.1.3.2.3" xref="alg1.l29.m1.2.2.2.2.1.1.3.2.3.cmml">b</mi></msubsup><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="alg1.l29.m1.2.2.2.2.1.1.3.1" xref="alg1.l29.m1.2.2.2.2.1.1.3.1.cmml">∘</mo><msubsup id="alg1.l29.m1.2.2.2.2.1.1.3.3" xref="alg1.l29.m1.2.2.2.2.1.1.3.3.cmml"><mi mathsize="90%" id="alg1.l29.m1.2.2.2.2.1.1.3.3.2.2" xref="alg1.l29.m1.2.2.2.2.1.1.3.3.2.2.cmml">f</mi><mrow id="alg1.l29.m1.2.2.2.2.1.1.3.3.2.3" xref="alg1.l29.m1.2.2.2.2.1.1.3.3.2.3.cmml"><mi mathsize="90%" id="alg1.l29.m1.2.2.2.2.1.1.3.3.2.3.2" xref="alg1.l29.m1.2.2.2.2.1.1.3.3.2.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.l29.m1.2.2.2.2.1.1.3.3.2.3.1" xref="alg1.l29.m1.2.2.2.2.1.1.3.3.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.l29.m1.2.2.2.2.1.1.3.3.2.3.3" xref="alg1.l29.m1.2.2.2.2.1.1.3.3.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="alg1.l29.m1.2.2.2.2.1.1.3.3.3" xref="alg1.l29.m1.2.2.2.2.1.1.3.3.3.cmml">b</mi></msubsup></mrow></mrow><mo mathsize="90%" id="alg1.l29.m1.2.2.2.2.2.3" xref="alg1.l29.m1.2.2.2.2.3a.cmml">,</mo><mrow id="alg1.l29.m1.2.2.2.2.2.2" xref="alg1.l29.m1.2.2.2.2.2.2.cmml"><msubsup id="alg1.l29.m1.2.2.2.2.2.2.2" xref="alg1.l29.m1.2.2.2.2.2.2.2.cmml"><mi mathsize="90%" id="alg1.l29.m1.2.2.2.2.2.2.2.2.2" xref="alg1.l29.m1.2.2.2.2.2.2.2.2.2.cmml">w</mi><mrow id="alg1.l29.m1.2.2.2.2.2.2.2.2.3" xref="alg1.l29.m1.2.2.2.2.2.2.2.2.3.cmml"><mi mathsize="90%" id="alg1.l29.m1.2.2.2.2.2.2.2.2.3.2" xref="alg1.l29.m1.2.2.2.2.2.2.2.2.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.l29.m1.2.2.2.2.2.2.2.2.3.1" xref="alg1.l29.m1.2.2.2.2.2.2.2.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.l29.m1.2.2.2.2.2.2.2.2.3.3" xref="alg1.l29.m1.2.2.2.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="alg1.l29.m1.2.2.2.2.2.2.2.3" xref="alg1.l29.m1.2.2.2.2.2.2.2.3.cmml">c</mi></msubsup><mo mathsize="90%" stretchy="false" id="alg1.l29.m1.2.2.2.2.2.2.1" xref="alg1.l29.m1.2.2.2.2.2.2.1.cmml">←</mo><mrow id="alg1.l29.m1.2.2.2.2.2.2.3" xref="alg1.l29.m1.2.2.2.2.2.2.3.cmml"><msubsup id="alg1.l29.m1.2.2.2.2.2.2.3.2" xref="alg1.l29.m1.2.2.2.2.2.2.3.2.cmml"><mi mathsize="90%" id="alg1.l29.m1.2.2.2.2.2.2.3.2.2.2" xref="alg1.l29.m1.2.2.2.2.2.2.3.2.2.2.cmml">θ</mi><mrow id="alg1.l29.m1.2.2.2.2.2.2.3.2.2.3" xref="alg1.l29.m1.2.2.2.2.2.2.3.2.2.3.cmml"><mi mathsize="90%" id="alg1.l29.m1.2.2.2.2.2.2.3.2.2.3.2" xref="alg1.l29.m1.2.2.2.2.2.2.3.2.2.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.l29.m1.2.2.2.2.2.2.3.2.2.3.1" xref="alg1.l29.m1.2.2.2.2.2.2.3.2.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.l29.m1.2.2.2.2.2.2.3.2.2.3.3" xref="alg1.l29.m1.2.2.2.2.2.2.3.2.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="alg1.l29.m1.2.2.2.2.2.2.3.2.3" xref="alg1.l29.m1.2.2.2.2.2.2.3.2.3.cmml">c</mi></msubsup><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="alg1.l29.m1.2.2.2.2.2.2.3.1" xref="alg1.l29.m1.2.2.2.2.2.2.3.1.cmml">∘</mo><msubsup id="alg1.l29.m1.2.2.2.2.2.2.3.3" xref="alg1.l29.m1.2.2.2.2.2.2.3.3.cmml"><mi mathsize="90%" id="alg1.l29.m1.2.2.2.2.2.2.3.3.2.2" xref="alg1.l29.m1.2.2.2.2.2.2.3.3.2.2.cmml">f</mi><mrow id="alg1.l29.m1.2.2.2.2.2.2.3.3.2.3" xref="alg1.l29.m1.2.2.2.2.2.2.3.3.2.3.cmml"><mi mathsize="90%" id="alg1.l29.m1.2.2.2.2.2.2.3.3.2.3.2" xref="alg1.l29.m1.2.2.2.2.2.2.3.3.2.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.l29.m1.2.2.2.2.2.2.3.3.2.3.1" xref="alg1.l29.m1.2.2.2.2.2.2.3.3.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.l29.m1.2.2.2.2.2.2.3.3.2.3.3" xref="alg1.l29.m1.2.2.2.2.2.2.3.3.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="alg1.l29.m1.2.2.2.2.2.2.3.3.3" xref="alg1.l29.m1.2.2.2.2.2.2.3.3.3.cmml">c</mi></msubsup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l29.m1.2b"><apply id="alg1.l29.m1.2.2.3.cmml" xref="alg1.l29.m1.2.2.2"><csymbol cd="ambiguous" id="alg1.l29.m1.2.2.3a.cmml" xref="alg1.l29.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.l29.m1.1.1.1.1.cmml" xref="alg1.l29.m1.1.1.1.1"><ci id="alg1.l29.m1.1.1.1.1.1.cmml" xref="alg1.l29.m1.1.1.1.1.1">←</ci><apply id="alg1.l29.m1.1.1.1.1.2.cmml" xref="alg1.l29.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l29.m1.1.1.1.1.2.1.cmml" xref="alg1.l29.m1.1.1.1.1.2">superscript</csymbol><apply id="alg1.l29.m1.1.1.1.1.2.2.cmml" xref="alg1.l29.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l29.m1.1.1.1.1.2.2.1.cmml" xref="alg1.l29.m1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l29.m1.1.1.1.1.2.2.2.cmml" xref="alg1.l29.m1.1.1.1.1.2.2.2">𝑤</ci><apply id="alg1.l29.m1.1.1.1.1.2.2.3.cmml" xref="alg1.l29.m1.1.1.1.1.2.2.3"><plus id="alg1.l29.m1.1.1.1.1.2.2.3.1.cmml" xref="alg1.l29.m1.1.1.1.1.2.2.3.1"></plus><ci id="alg1.l29.m1.1.1.1.1.2.2.3.2.cmml" xref="alg1.l29.m1.1.1.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l29.m1.1.1.1.1.2.2.3.3.cmml" xref="alg1.l29.m1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="alg1.l29.m1.1.1.1.1.2.3.cmml" xref="alg1.l29.m1.1.1.1.1.2.3">𝑎</ci></apply><apply id="alg1.l29.m1.1.1.1.1.3.cmml" xref="alg1.l29.m1.1.1.1.1.3"><compose id="alg1.l29.m1.1.1.1.1.3.1.cmml" xref="alg1.l29.m1.1.1.1.1.3.1"></compose><apply id="alg1.l29.m1.1.1.1.1.3.2.cmml" xref="alg1.l29.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l29.m1.1.1.1.1.3.2.1.cmml" xref="alg1.l29.m1.1.1.1.1.3.2">superscript</csymbol><apply id="alg1.l29.m1.1.1.1.1.3.2.2.cmml" xref="alg1.l29.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l29.m1.1.1.1.1.3.2.2.1.cmml" xref="alg1.l29.m1.1.1.1.1.3.2">subscript</csymbol><ci id="alg1.l29.m1.1.1.1.1.3.2.2.2.cmml" xref="alg1.l29.m1.1.1.1.1.3.2.2.2">𝜃</ci><apply id="alg1.l29.m1.1.1.1.1.3.2.2.3.cmml" xref="alg1.l29.m1.1.1.1.1.3.2.2.3"><plus id="alg1.l29.m1.1.1.1.1.3.2.2.3.1.cmml" xref="alg1.l29.m1.1.1.1.1.3.2.2.3.1"></plus><ci id="alg1.l29.m1.1.1.1.1.3.2.2.3.2.cmml" xref="alg1.l29.m1.1.1.1.1.3.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l29.m1.1.1.1.1.3.2.2.3.3.cmml" xref="alg1.l29.m1.1.1.1.1.3.2.2.3.3">1</cn></apply></apply><ci id="alg1.l29.m1.1.1.1.1.3.2.3.cmml" xref="alg1.l29.m1.1.1.1.1.3.2.3">𝑎</ci></apply><apply id="alg1.l29.m1.1.1.1.1.3.3.cmml" xref="alg1.l29.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l29.m1.1.1.1.1.3.3.1.cmml" xref="alg1.l29.m1.1.1.1.1.3.3">superscript</csymbol><apply id="alg1.l29.m1.1.1.1.1.3.3.2.cmml" xref="alg1.l29.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l29.m1.1.1.1.1.3.3.2.1.cmml" xref="alg1.l29.m1.1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l29.m1.1.1.1.1.3.3.2.2.cmml" xref="alg1.l29.m1.1.1.1.1.3.3.2.2">𝑓</ci><apply id="alg1.l29.m1.1.1.1.1.3.3.2.3.cmml" xref="alg1.l29.m1.1.1.1.1.3.3.2.3"><plus id="alg1.l29.m1.1.1.1.1.3.3.2.3.1.cmml" xref="alg1.l29.m1.1.1.1.1.3.3.2.3.1"></plus><ci id="alg1.l29.m1.1.1.1.1.3.3.2.3.2.cmml" xref="alg1.l29.m1.1.1.1.1.3.3.2.3.2">𝑡</ci><cn type="integer" id="alg1.l29.m1.1.1.1.1.3.3.2.3.3.cmml" xref="alg1.l29.m1.1.1.1.1.3.3.2.3.3">1</cn></apply></apply><ci id="alg1.l29.m1.1.1.1.1.3.3.3.cmml" xref="alg1.l29.m1.1.1.1.1.3.3.3">𝑎</ci></apply></apply></apply><apply id="alg1.l29.m1.2.2.2.2.3.cmml" xref="alg1.l29.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l29.m1.2.2.2.2.3a.cmml" xref="alg1.l29.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.l29.m1.2.2.2.2.1.1.cmml" xref="alg1.l29.m1.2.2.2.2.1.1"><ci id="alg1.l29.m1.2.2.2.2.1.1.1.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.1">←</ci><apply id="alg1.l29.m1.2.2.2.2.1.1.2.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="alg1.l29.m1.2.2.2.2.1.1.2.1.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.2">superscript</csymbol><apply id="alg1.l29.m1.2.2.2.2.1.1.2.2.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="alg1.l29.m1.2.2.2.2.1.1.2.2.1.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="alg1.l29.m1.2.2.2.2.1.1.2.2.2.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.2.2.2">𝑤</ci><apply id="alg1.l29.m1.2.2.2.2.1.1.2.2.3.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.2.2.3"><plus id="alg1.l29.m1.2.2.2.2.1.1.2.2.3.1.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.2.2.3.1"></plus><ci id="alg1.l29.m1.2.2.2.2.1.1.2.2.3.2.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l29.m1.2.2.2.2.1.1.2.2.3.3.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.2.2.3.3">1</cn></apply></apply><ci id="alg1.l29.m1.2.2.2.2.1.1.2.3.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.2.3">𝑏</ci></apply><apply id="alg1.l29.m1.2.2.2.2.1.1.3.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.3"><compose id="alg1.l29.m1.2.2.2.2.1.1.3.1.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.3.1"></compose><apply id="alg1.l29.m1.2.2.2.2.1.1.3.2.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l29.m1.2.2.2.2.1.1.3.2.1.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.3.2">superscript</csymbol><apply id="alg1.l29.m1.2.2.2.2.1.1.3.2.2.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l29.m1.2.2.2.2.1.1.3.2.2.1.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.3.2">subscript</csymbol><ci id="alg1.l29.m1.2.2.2.2.1.1.3.2.2.2.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.3.2.2.2">𝜃</ci><apply id="alg1.l29.m1.2.2.2.2.1.1.3.2.2.3.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.3.2.2.3"><plus id="alg1.l29.m1.2.2.2.2.1.1.3.2.2.3.1.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.3.2.2.3.1"></plus><ci id="alg1.l29.m1.2.2.2.2.1.1.3.2.2.3.2.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.3.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l29.m1.2.2.2.2.1.1.3.2.2.3.3.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.3.2.2.3.3">1</cn></apply></apply><ci id="alg1.l29.m1.2.2.2.2.1.1.3.2.3.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.3.2.3">𝑏</ci></apply><apply id="alg1.l29.m1.2.2.2.2.1.1.3.3.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l29.m1.2.2.2.2.1.1.3.3.1.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.3.3">superscript</csymbol><apply id="alg1.l29.m1.2.2.2.2.1.1.3.3.2.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l29.m1.2.2.2.2.1.1.3.3.2.1.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.3.3">subscript</csymbol><ci id="alg1.l29.m1.2.2.2.2.1.1.3.3.2.2.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.3.3.2.2">𝑓</ci><apply id="alg1.l29.m1.2.2.2.2.1.1.3.3.2.3.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.3.3.2.3"><plus id="alg1.l29.m1.2.2.2.2.1.1.3.3.2.3.1.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.3.3.2.3.1"></plus><ci id="alg1.l29.m1.2.2.2.2.1.1.3.3.2.3.2.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.3.3.2.3.2">𝑡</ci><cn type="integer" id="alg1.l29.m1.2.2.2.2.1.1.3.3.2.3.3.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.3.3.2.3.3">1</cn></apply></apply><ci id="alg1.l29.m1.2.2.2.2.1.1.3.3.3.cmml" xref="alg1.l29.m1.2.2.2.2.1.1.3.3.3">𝑏</ci></apply></apply></apply><apply id="alg1.l29.m1.2.2.2.2.2.2.cmml" xref="alg1.l29.m1.2.2.2.2.2.2"><ci id="alg1.l29.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.1">←</ci><apply id="alg1.l29.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l29.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.2">superscript</csymbol><apply id="alg1.l29.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l29.m1.2.2.2.2.2.2.2.2.1.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l29.m1.2.2.2.2.2.2.2.2.2.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.2.2.2">𝑤</ci><apply id="alg1.l29.m1.2.2.2.2.2.2.2.2.3.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.2.2.3"><plus id="alg1.l29.m1.2.2.2.2.2.2.2.2.3.1.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.2.2.3.1"></plus><ci id="alg1.l29.m1.2.2.2.2.2.2.2.2.3.2.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l29.m1.2.2.2.2.2.2.2.2.3.3.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="alg1.l29.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.2.3">𝑐</ci></apply><apply id="alg1.l29.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.3"><compose id="alg1.l29.m1.2.2.2.2.2.2.3.1.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.3.1"></compose><apply id="alg1.l29.m1.2.2.2.2.2.2.3.2.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.3.2"><csymbol cd="ambiguous" id="alg1.l29.m1.2.2.2.2.2.2.3.2.1.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.3.2">superscript</csymbol><apply id="alg1.l29.m1.2.2.2.2.2.2.3.2.2.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.3.2"><csymbol cd="ambiguous" id="alg1.l29.m1.2.2.2.2.2.2.3.2.2.1.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.3.2">subscript</csymbol><ci id="alg1.l29.m1.2.2.2.2.2.2.3.2.2.2.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.3.2.2.2">𝜃</ci><apply id="alg1.l29.m1.2.2.2.2.2.2.3.2.2.3.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.3.2.2.3"><plus id="alg1.l29.m1.2.2.2.2.2.2.3.2.2.3.1.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.3.2.2.3.1"></plus><ci id="alg1.l29.m1.2.2.2.2.2.2.3.2.2.3.2.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.3.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l29.m1.2.2.2.2.2.2.3.2.2.3.3.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.3.2.2.3.3">1</cn></apply></apply><ci id="alg1.l29.m1.2.2.2.2.2.2.3.2.3.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.3.2.3">𝑐</ci></apply><apply id="alg1.l29.m1.2.2.2.2.2.2.3.3.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="alg1.l29.m1.2.2.2.2.2.2.3.3.1.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.3.3">superscript</csymbol><apply id="alg1.l29.m1.2.2.2.2.2.2.3.3.2.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="alg1.l29.m1.2.2.2.2.2.2.3.3.2.1.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.3.3">subscript</csymbol><ci id="alg1.l29.m1.2.2.2.2.2.2.3.3.2.2.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.3.3.2.2">𝑓</ci><apply id="alg1.l29.m1.2.2.2.2.2.2.3.3.2.3.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.3.3.2.3"><plus id="alg1.l29.m1.2.2.2.2.2.2.3.3.2.3.1.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.3.3.2.3.1"></plus><ci id="alg1.l29.m1.2.2.2.2.2.2.3.3.2.3.2.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.3.3.2.3.2">𝑡</ci><cn type="integer" id="alg1.l29.m1.2.2.2.2.2.2.3.3.2.3.3.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.3.3.2.3.3">1</cn></apply></apply><ci id="alg1.l29.m1.2.2.2.2.2.2.3.3.3.cmml" xref="alg1.l29.m1.2.2.2.2.2.2.3.3.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l29.m1.2c">w_{t+1}^{a}\leftarrow\theta_{t+1}^{a}\circ f_{t+1}^{a},w_{t+1}^{b}\leftarrow\theta_{t+1}^{b}\circ f_{t+1}^{b},w_{t+1}^{c}\leftarrow\theta_{t+1}^{c}\circ f_{t+1}^{c}</annotation></semantics></math><span id="alg1.l29.3" class="ltx_text" style="font-size:90%;"> 
</span>
</div>
<div id="alg1.l30" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l30.1.1.1" class="ltx_text" style="font-size:80%;">30:</span></span><span id="alg1.l30.2" class="ltx_text" style="font-size:90%;">  </span><span id="alg1.l30.3" class="ltx_text ltx_font_bold" style="font-size:90%;">end</span><span id="alg1.l30.4" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l30.5" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span>
</div>
</div>
</figure>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.13" class="ltx_p">As shown in Algorithm <a href="#alg1" title="Algorithm 1 ‣ 3.1. Layer-wise Heterogeneous Aggregation Framework ‣ 3. Methodology ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, in the <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="t^{th}" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><msup id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">t</mi><mrow id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml"><mi id="S3.SS1.p2.1.m1.1.1.3.2" xref="S3.SS1.p2.1.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.1.m1.1.1.3.1" xref="S3.SS1.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p2.1.m1.1.1.3.3" xref="S3.SS1.p2.1.m1.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">superscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">𝑡</ci><apply id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3"><times id="S3.SS1.p2.1.m1.1.1.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.3.1"></times><ci id="S3.SS1.p2.1.m1.1.1.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.3.2">𝑡</ci><ci id="S3.SS1.p2.1.m1.1.1.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">t^{th}</annotation></semantics></math> round of communication, the server first randomly samples a subset of clients with heterogeneous devices.
The sampled clients are grouped by the device type as <math id="S3.SS1.p2.2.m2.2" class="ltx_Math" alttext="U_{t}^{a},U_{t}^{b}" display="inline"><semantics id="S3.SS1.p2.2.m2.2a"><mrow id="S3.SS1.p2.2.m2.2.2.2" xref="S3.SS1.p2.2.m2.2.2.3.cmml"><msubsup id="S3.SS1.p2.2.m2.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.1.1.2.2" xref="S3.SS1.p2.2.m2.1.1.1.1.2.2.cmml">U</mi><mi id="S3.SS1.p2.2.m2.1.1.1.1.2.3" xref="S3.SS1.p2.2.m2.1.1.1.1.2.3.cmml">t</mi><mi id="S3.SS1.p2.2.m2.1.1.1.1.3" xref="S3.SS1.p2.2.m2.1.1.1.1.3.cmml">a</mi></msubsup><mo id="S3.SS1.p2.2.m2.2.2.2.3" xref="S3.SS1.p2.2.m2.2.2.3.cmml">,</mo><msubsup id="S3.SS1.p2.2.m2.2.2.2.2" xref="S3.SS1.p2.2.m2.2.2.2.2.cmml"><mi id="S3.SS1.p2.2.m2.2.2.2.2.2.2" xref="S3.SS1.p2.2.m2.2.2.2.2.2.2.cmml">U</mi><mi id="S3.SS1.p2.2.m2.2.2.2.2.2.3" xref="S3.SS1.p2.2.m2.2.2.2.2.2.3.cmml">t</mi><mi id="S3.SS1.p2.2.m2.2.2.2.2.3" xref="S3.SS1.p2.2.m2.2.2.2.2.3.cmml">b</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.2b"><list id="S3.SS1.p2.2.m2.2.2.3.cmml" xref="S3.SS1.p2.2.m2.2.2.2"><apply id="S3.SS1.p2.2.m2.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1">superscript</csymbol><apply id="S3.SS1.p2.2.m2.1.1.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.2.2">𝑈</ci><ci id="S3.SS1.p2.2.m2.1.1.1.1.2.3.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.p2.2.m2.1.1.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.3">𝑎</ci></apply><apply id="S3.SS1.p2.2.m2.2.2.2.2.cmml" xref="S3.SS1.p2.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.2.2.2.2.1.cmml" xref="S3.SS1.p2.2.m2.2.2.2.2">superscript</csymbol><apply id="S3.SS1.p2.2.m2.2.2.2.2.2.cmml" xref="S3.SS1.p2.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS1.p2.2.m2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS1.p2.2.m2.2.2.2.2.2.2">𝑈</ci><ci id="S3.SS1.p2.2.m2.2.2.2.2.2.3.cmml" xref="S3.SS1.p2.2.m2.2.2.2.2.2.3">𝑡</ci></apply><ci id="S3.SS1.p2.2.m2.2.2.2.2.3.cmml" xref="S3.SS1.p2.2.m2.2.2.2.2.3">𝑏</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.2c">U_{t}^{a},U_{t}^{b}</annotation></semantics></math> and <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="U_{t}^{c}" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><msubsup id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2.2" xref="S3.SS1.p2.3.m3.1.1.2.2.cmml">U</mi><mi id="S3.SS1.p2.3.m3.1.1.2.3" xref="S3.SS1.p2.3.m3.1.1.2.3.cmml">t</mi><mi id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">superscript</csymbol><apply id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.2.1.cmml" xref="S3.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2.2">𝑈</ci><ci id="S3.SS1.p2.3.m3.1.1.2.3.cmml" xref="S3.SS1.p2.3.m3.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">U_{t}^{c}</annotation></semantics></math> and the proportion <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="n_{a}:n_{b}:n_{c}" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><mrow id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><msub id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml"><mi id="S3.SS1.p2.4.m4.1.1.2.2" xref="S3.SS1.p2.4.m4.1.1.2.2.cmml">n</mi><mi id="S3.SS1.p2.4.m4.1.1.2.3" xref="S3.SS1.p2.4.m4.1.1.2.3.cmml">a</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml">:</mo><msub id="S3.SS1.p2.4.m4.1.1.4" xref="S3.SS1.p2.4.m4.1.1.4.cmml"><mi id="S3.SS1.p2.4.m4.1.1.4.2" xref="S3.SS1.p2.4.m4.1.1.4.2.cmml">n</mi><mi id="S3.SS1.p2.4.m4.1.1.4.3" xref="S3.SS1.p2.4.m4.1.1.4.3.cmml">b</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p2.4.m4.1.1.5" xref="S3.SS1.p2.4.m4.1.1.5.cmml">:</mo><msub id="S3.SS1.p2.4.m4.1.1.6" xref="S3.SS1.p2.4.m4.1.1.6.cmml"><mi id="S3.SS1.p2.4.m4.1.1.6.2" xref="S3.SS1.p2.4.m4.1.1.6.2.cmml">n</mi><mi id="S3.SS1.p2.4.m4.1.1.6.3" xref="S3.SS1.p2.4.m4.1.1.6.3.cmml">c</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><and id="S3.SS1.p2.4.m4.1.1a.cmml" xref="S3.SS1.p2.4.m4.1.1"></and><apply id="S3.SS1.p2.4.m4.1.1b.cmml" xref="S3.SS1.p2.4.m4.1.1"><ci id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3">:</ci><apply id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.2.1.cmml" xref="S3.SS1.p2.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.2.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2.2">𝑛</ci><ci id="S3.SS1.p2.4.m4.1.1.2.3.cmml" xref="S3.SS1.p2.4.m4.1.1.2.3">𝑎</ci></apply><apply id="S3.SS1.p2.4.m4.1.1.4.cmml" xref="S3.SS1.p2.4.m4.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.4.1.cmml" xref="S3.SS1.p2.4.m4.1.1.4">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.4.2.cmml" xref="S3.SS1.p2.4.m4.1.1.4.2">𝑛</ci><ci id="S3.SS1.p2.4.m4.1.1.4.3.cmml" xref="S3.SS1.p2.4.m4.1.1.4.3">𝑏</ci></apply></apply><apply id="S3.SS1.p2.4.m4.1.1c.cmml" xref="S3.SS1.p2.4.m4.1.1"><ci id="S3.SS1.p2.4.m4.1.1.5.cmml" xref="S3.SS1.p2.4.m4.1.1.5">:</ci><share href="#S3.SS1.p2.4.m4.1.1.4.cmml" id="S3.SS1.p2.4.m4.1.1d.cmml" xref="S3.SS1.p2.4.m4.1.1"></share><apply id="S3.SS1.p2.4.m4.1.1.6.cmml" xref="S3.SS1.p2.4.m4.1.1.6"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.6.1.cmml" xref="S3.SS1.p2.4.m4.1.1.6">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.6.2.cmml" xref="S3.SS1.p2.4.m4.1.1.6.2">𝑛</ci><ci id="S3.SS1.p2.4.m4.1.1.6.3.cmml" xref="S3.SS1.p2.4.m4.1.1.6.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">n_{a}:n_{b}:n_{c}</annotation></semantics></math> for each device type is dynamic for each round.
Then, for a client <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">i</annotation></semantics></math> in the group of device <math id="S3.SS1.p2.6.m6.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS1.p2.6.m6.1a"><mi id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><ci id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">j</annotation></semantics></math>, we conduct the local optimization with SGD as in conventional FL <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib26" title="" class="ltx_ref">2017</a>)</cite> and get the local update as <math id="S3.SS1.p2.7.m7.2" class="ltx_Math" alttext="g_{t}^{i,j}" display="inline"><semantics id="S3.SS1.p2.7.m7.2a"><msubsup id="S3.SS1.p2.7.m7.2.3" xref="S3.SS1.p2.7.m7.2.3.cmml"><mi id="S3.SS1.p2.7.m7.2.3.2.2" xref="S3.SS1.p2.7.m7.2.3.2.2.cmml">g</mi><mi id="S3.SS1.p2.7.m7.2.3.2.3" xref="S3.SS1.p2.7.m7.2.3.2.3.cmml">t</mi><mrow id="S3.SS1.p2.7.m7.2.2.2.4" xref="S3.SS1.p2.7.m7.2.2.2.3.cmml"><mi id="S3.SS1.p2.7.m7.1.1.1.1" xref="S3.SS1.p2.7.m7.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p2.7.m7.2.2.2.4.1" xref="S3.SS1.p2.7.m7.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p2.7.m7.2.2.2.2" xref="S3.SS1.p2.7.m7.2.2.2.2.cmml">j</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.2b"><apply id="S3.SS1.p2.7.m7.2.3.cmml" xref="S3.SS1.p2.7.m7.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.2.3.1.cmml" xref="S3.SS1.p2.7.m7.2.3">superscript</csymbol><apply id="S3.SS1.p2.7.m7.2.3.2.cmml" xref="S3.SS1.p2.7.m7.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.2.3.2.1.cmml" xref="S3.SS1.p2.7.m7.2.3">subscript</csymbol><ci id="S3.SS1.p2.7.m7.2.3.2.2.cmml" xref="S3.SS1.p2.7.m7.2.3.2.2">𝑔</ci><ci id="S3.SS1.p2.7.m7.2.3.2.3.cmml" xref="S3.SS1.p2.7.m7.2.3.2.3">𝑡</ci></apply><list id="S3.SS1.p2.7.m7.2.2.2.3.cmml" xref="S3.SS1.p2.7.m7.2.2.2.4"><ci id="S3.SS1.p2.7.m7.1.1.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1.1.1">𝑖</ci><ci id="S3.SS1.p2.7.m7.2.2.2.2.cmml" xref="S3.SS1.p2.7.m7.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.2c">g_{t}^{i,j}</annotation></semantics></math>.
Within each client group, we average the update as <math id="S3.SS1.p2.8.m8.1" class="ltx_Math" alttext="g_{t}^{j}" display="inline"><semantics id="S3.SS1.p2.8.m8.1a"><msubsup id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml"><mi id="S3.SS1.p2.8.m8.1.1.2.2" xref="S3.SS1.p2.8.m8.1.1.2.2.cmml">g</mi><mi id="S3.SS1.p2.8.m8.1.1.2.3" xref="S3.SS1.p2.8.m8.1.1.2.3.cmml">t</mi><mi id="S3.SS1.p2.8.m8.1.1.3" xref="S3.SS1.p2.8.m8.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><apply id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">superscript</csymbol><apply id="S3.SS1.p2.8.m8.1.1.2.cmml" xref="S3.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.2.1.cmml" xref="S3.SS1.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p2.8.m8.1.1.2.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2.2">𝑔</ci><ci id="S3.SS1.p2.8.m8.1.1.2.3.cmml" xref="S3.SS1.p2.8.m8.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.p2.8.m8.1.1.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">g_{t}^{j}</annotation></semantics></math>, where <math id="S3.SS1.p2.9.m9.3" class="ltx_Math" alttext="j\in\{a,b,c\}" display="inline"><semantics id="S3.SS1.p2.9.m9.3a"><mrow id="S3.SS1.p2.9.m9.3.4" xref="S3.SS1.p2.9.m9.3.4.cmml"><mi id="S3.SS1.p2.9.m9.3.4.2" xref="S3.SS1.p2.9.m9.3.4.2.cmml">j</mi><mo id="S3.SS1.p2.9.m9.3.4.1" xref="S3.SS1.p2.9.m9.3.4.1.cmml">∈</mo><mrow id="S3.SS1.p2.9.m9.3.4.3.2" xref="S3.SS1.p2.9.m9.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS1.p2.9.m9.3.4.3.2.1" xref="S3.SS1.p2.9.m9.3.4.3.1.cmml">{</mo><mi id="S3.SS1.p2.9.m9.1.1" xref="S3.SS1.p2.9.m9.1.1.cmml">a</mi><mo id="S3.SS1.p2.9.m9.3.4.3.2.2" xref="S3.SS1.p2.9.m9.3.4.3.1.cmml">,</mo><mi id="S3.SS1.p2.9.m9.2.2" xref="S3.SS1.p2.9.m9.2.2.cmml">b</mi><mo id="S3.SS1.p2.9.m9.3.4.3.2.3" xref="S3.SS1.p2.9.m9.3.4.3.1.cmml">,</mo><mi id="S3.SS1.p2.9.m9.3.3" xref="S3.SS1.p2.9.m9.3.3.cmml">c</mi><mo stretchy="false" id="S3.SS1.p2.9.m9.3.4.3.2.4" xref="S3.SS1.p2.9.m9.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.3b"><apply id="S3.SS1.p2.9.m9.3.4.cmml" xref="S3.SS1.p2.9.m9.3.4"><in id="S3.SS1.p2.9.m9.3.4.1.cmml" xref="S3.SS1.p2.9.m9.3.4.1"></in><ci id="S3.SS1.p2.9.m9.3.4.2.cmml" xref="S3.SS1.p2.9.m9.3.4.2">𝑗</ci><set id="S3.SS1.p2.9.m9.3.4.3.1.cmml" xref="S3.SS1.p2.9.m9.3.4.3.2"><ci id="S3.SS1.p2.9.m9.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1">𝑎</ci><ci id="S3.SS1.p2.9.m9.2.2.cmml" xref="S3.SS1.p2.9.m9.2.2">𝑏</ci><ci id="S3.SS1.p2.9.m9.3.3.cmml" xref="S3.SS1.p2.9.m9.3.3">𝑐</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.3c">j\in\{a,b,c\}</annotation></semantics></math>.
Then we update the sub-global model into <math id="S3.SS1.p2.10.m10.1" class="ltx_Math" alttext="w_{t+1}^{j}" display="inline"><semantics id="S3.SS1.p2.10.m10.1a"><msubsup id="S3.SS1.p2.10.m10.1.1" xref="S3.SS1.p2.10.m10.1.1.cmml"><mi id="S3.SS1.p2.10.m10.1.1.2.2" xref="S3.SS1.p2.10.m10.1.1.2.2.cmml">w</mi><mrow id="S3.SS1.p2.10.m10.1.1.2.3" xref="S3.SS1.p2.10.m10.1.1.2.3.cmml"><mi id="S3.SS1.p2.10.m10.1.1.2.3.2" xref="S3.SS1.p2.10.m10.1.1.2.3.2.cmml">t</mi><mo id="S3.SS1.p2.10.m10.1.1.2.3.1" xref="S3.SS1.p2.10.m10.1.1.2.3.1.cmml">+</mo><mn id="S3.SS1.p2.10.m10.1.1.2.3.3" xref="S3.SS1.p2.10.m10.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p2.10.m10.1.1.3" xref="S3.SS1.p2.10.m10.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m10.1b"><apply id="S3.SS1.p2.10.m10.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.1.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1">superscript</csymbol><apply id="S3.SS1.p2.10.m10.1.1.2.cmml" xref="S3.SS1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.1.1.2.1.cmml" xref="S3.SS1.p2.10.m10.1.1">subscript</csymbol><ci id="S3.SS1.p2.10.m10.1.1.2.2.cmml" xref="S3.SS1.p2.10.m10.1.1.2.2">𝑤</ci><apply id="S3.SS1.p2.10.m10.1.1.2.3.cmml" xref="S3.SS1.p2.10.m10.1.1.2.3"><plus id="S3.SS1.p2.10.m10.1.1.2.3.1.cmml" xref="S3.SS1.p2.10.m10.1.1.2.3.1"></plus><ci id="S3.SS1.p2.10.m10.1.1.2.3.2.cmml" xref="S3.SS1.p2.10.m10.1.1.2.3.2">𝑡</ci><cn type="integer" id="S3.SS1.p2.10.m10.1.1.2.3.3.cmml" xref="S3.SS1.p2.10.m10.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p2.10.m10.1.1.3.cmml" xref="S3.SS1.p2.10.m10.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m10.1c">w_{t+1}^{j}</annotation></semantics></math> with the averaged updates and the momentum <math id="S3.SS1.p2.11.m11.1" class="ltx_Math" alttext="m_{t-1}^{k}" display="inline"><semantics id="S3.SS1.p2.11.m11.1a"><msubsup id="S3.SS1.p2.11.m11.1.1" xref="S3.SS1.p2.11.m11.1.1.cmml"><mi id="S3.SS1.p2.11.m11.1.1.2.2" xref="S3.SS1.p2.11.m11.1.1.2.2.cmml">m</mi><mrow id="S3.SS1.p2.11.m11.1.1.2.3" xref="S3.SS1.p2.11.m11.1.1.2.3.cmml"><mi id="S3.SS1.p2.11.m11.1.1.2.3.2" xref="S3.SS1.p2.11.m11.1.1.2.3.2.cmml">t</mi><mo id="S3.SS1.p2.11.m11.1.1.2.3.1" xref="S3.SS1.p2.11.m11.1.1.2.3.1.cmml">−</mo><mn id="S3.SS1.p2.11.m11.1.1.2.3.3" xref="S3.SS1.p2.11.m11.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p2.11.m11.1.1.3" xref="S3.SS1.p2.11.m11.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m11.1b"><apply id="S3.SS1.p2.11.m11.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.1.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1">superscript</csymbol><apply id="S3.SS1.p2.11.m11.1.1.2.cmml" xref="S3.SS1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.1.1.2.1.cmml" xref="S3.SS1.p2.11.m11.1.1">subscript</csymbol><ci id="S3.SS1.p2.11.m11.1.1.2.2.cmml" xref="S3.SS1.p2.11.m11.1.1.2.2">𝑚</ci><apply id="S3.SS1.p2.11.m11.1.1.2.3.cmml" xref="S3.SS1.p2.11.m11.1.1.2.3"><minus id="S3.SS1.p2.11.m11.1.1.2.3.1.cmml" xref="S3.SS1.p2.11.m11.1.1.2.3.1"></minus><ci id="S3.SS1.p2.11.m11.1.1.2.3.2.cmml" xref="S3.SS1.p2.11.m11.1.1.2.3.2">𝑡</ci><cn type="integer" id="S3.SS1.p2.11.m11.1.1.2.3.3.cmml" xref="S3.SS1.p2.11.m11.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p2.11.m11.1.1.3.cmml" xref="S3.SS1.p2.11.m11.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m11.1c">m_{t-1}^{k}</annotation></semantics></math> to merge local knowledge from clients with the same device type.
The momentum <math id="S3.SS1.p2.12.m12.1" class="ltx_Math" alttext="m_{t-1}^{k}" display="inline"><semantics id="S3.SS1.p2.12.m12.1a"><msubsup id="S3.SS1.p2.12.m12.1.1" xref="S3.SS1.p2.12.m12.1.1.cmml"><mi id="S3.SS1.p2.12.m12.1.1.2.2" xref="S3.SS1.p2.12.m12.1.1.2.2.cmml">m</mi><mrow id="S3.SS1.p2.12.m12.1.1.2.3" xref="S3.SS1.p2.12.m12.1.1.2.3.cmml"><mi id="S3.SS1.p2.12.m12.1.1.2.3.2" xref="S3.SS1.p2.12.m12.1.1.2.3.2.cmml">t</mi><mo id="S3.SS1.p2.12.m12.1.1.2.3.1" xref="S3.SS1.p2.12.m12.1.1.2.3.1.cmml">−</mo><mn id="S3.SS1.p2.12.m12.1.1.2.3.3" xref="S3.SS1.p2.12.m12.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p2.12.m12.1.1.3" xref="S3.SS1.p2.12.m12.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.12.m12.1b"><apply id="S3.SS1.p2.12.m12.1.1.cmml" xref="S3.SS1.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m12.1.1.1.cmml" xref="S3.SS1.p2.12.m12.1.1">superscript</csymbol><apply id="S3.SS1.p2.12.m12.1.1.2.cmml" xref="S3.SS1.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m12.1.1.2.1.cmml" xref="S3.SS1.p2.12.m12.1.1">subscript</csymbol><ci id="S3.SS1.p2.12.m12.1.1.2.2.cmml" xref="S3.SS1.p2.12.m12.1.1.2.2">𝑚</ci><apply id="S3.SS1.p2.12.m12.1.1.2.3.cmml" xref="S3.SS1.p2.12.m12.1.1.2.3"><minus id="S3.SS1.p2.12.m12.1.1.2.3.1.cmml" xref="S3.SS1.p2.12.m12.1.1.2.3.1"></minus><ci id="S3.SS1.p2.12.m12.1.1.2.3.2.cmml" xref="S3.SS1.p2.12.m12.1.1.2.3.2">𝑡</ci><cn type="integer" id="S3.SS1.p2.12.m12.1.1.2.3.3.cmml" xref="S3.SS1.p2.12.m12.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p2.12.m12.1.1.3.cmml" xref="S3.SS1.p2.12.m12.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.12.m12.1c">m_{t-1}^{k}</annotation></semantics></math> is distilled from a larger model on client group <math id="S3.SS1.p2.13.m13.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p2.13.m13.1a"><mi id="S3.SS1.p2.13.m13.1.1" xref="S3.SS1.p2.13.m13.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.13.m13.1b"><ci id="S3.SS1.p2.13.m13.1.1.cmml" xref="S3.SS1.p2.13.m13.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.13.m13.1c">k</annotation></semantics></math> and we explain details in Section <a href="#S3.SS2" title="3.2. Momentum Distillation ‣ 3. Methodology ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.17" class="ltx_p">With sub-models <math id="S3.SS1.p3.1.m1.3" class="ltx_Math" alttext="w_{t+1}^{a},w_{t+1}^{b},w_{t+1}^{c}" display="inline"><semantics id="S3.SS1.p3.1.m1.3a"><mrow id="S3.SS1.p3.1.m1.3.3.3" xref="S3.SS1.p3.1.m1.3.3.4.cmml"><msubsup id="S3.SS1.p3.1.m1.1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.1.1.2.2" xref="S3.SS1.p3.1.m1.1.1.1.1.2.2.cmml">w</mi><mrow id="S3.SS1.p3.1.m1.1.1.1.1.2.3" xref="S3.SS1.p3.1.m1.1.1.1.1.2.3.cmml"><mi id="S3.SS1.p3.1.m1.1.1.1.1.2.3.2" xref="S3.SS1.p3.1.m1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.SS1.p3.1.m1.1.1.1.1.2.3.1" xref="S3.SS1.p3.1.m1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S3.SS1.p3.1.m1.1.1.1.1.2.3.3" xref="S3.SS1.p3.1.m1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p3.1.m1.1.1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.1.1.3.cmml">a</mi></msubsup><mo id="S3.SS1.p3.1.m1.3.3.3.4" xref="S3.SS1.p3.1.m1.3.3.4.cmml">,</mo><msubsup id="S3.SS1.p3.1.m1.2.2.2.2" xref="S3.SS1.p3.1.m1.2.2.2.2.cmml"><mi id="S3.SS1.p3.1.m1.2.2.2.2.2.2" xref="S3.SS1.p3.1.m1.2.2.2.2.2.2.cmml">w</mi><mrow id="S3.SS1.p3.1.m1.2.2.2.2.2.3" xref="S3.SS1.p3.1.m1.2.2.2.2.2.3.cmml"><mi id="S3.SS1.p3.1.m1.2.2.2.2.2.3.2" xref="S3.SS1.p3.1.m1.2.2.2.2.2.3.2.cmml">t</mi><mo id="S3.SS1.p3.1.m1.2.2.2.2.2.3.1" xref="S3.SS1.p3.1.m1.2.2.2.2.2.3.1.cmml">+</mo><mn id="S3.SS1.p3.1.m1.2.2.2.2.2.3.3" xref="S3.SS1.p3.1.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p3.1.m1.2.2.2.2.3" xref="S3.SS1.p3.1.m1.2.2.2.2.3.cmml">b</mi></msubsup><mo id="S3.SS1.p3.1.m1.3.3.3.5" xref="S3.SS1.p3.1.m1.3.3.4.cmml">,</mo><msubsup id="S3.SS1.p3.1.m1.3.3.3.3" xref="S3.SS1.p3.1.m1.3.3.3.3.cmml"><mi id="S3.SS1.p3.1.m1.3.3.3.3.2.2" xref="S3.SS1.p3.1.m1.3.3.3.3.2.2.cmml">w</mi><mrow id="S3.SS1.p3.1.m1.3.3.3.3.2.3" xref="S3.SS1.p3.1.m1.3.3.3.3.2.3.cmml"><mi id="S3.SS1.p3.1.m1.3.3.3.3.2.3.2" xref="S3.SS1.p3.1.m1.3.3.3.3.2.3.2.cmml">t</mi><mo id="S3.SS1.p3.1.m1.3.3.3.3.2.3.1" xref="S3.SS1.p3.1.m1.3.3.3.3.2.3.1.cmml">+</mo><mn id="S3.SS1.p3.1.m1.3.3.3.3.2.3.3" xref="S3.SS1.p3.1.m1.3.3.3.3.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p3.1.m1.3.3.3.3.3" xref="S3.SS1.p3.1.m1.3.3.3.3.3.cmml">c</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.3b"><list id="S3.SS1.p3.1.m1.3.3.4.cmml" xref="S3.SS1.p3.1.m1.3.3.3"><apply id="S3.SS1.p3.1.m1.1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1">superscript</csymbol><apply id="S3.SS1.p3.1.m1.1.1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.1.2.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.1.1.2.2.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.2.2">𝑤</ci><apply id="S3.SS1.p3.1.m1.1.1.1.1.2.3.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.2.3"><plus id="S3.SS1.p3.1.m1.1.1.1.1.2.3.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.2.3.1"></plus><ci id="S3.SS1.p3.1.m1.1.1.1.1.2.3.2.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S3.SS1.p3.1.m1.1.1.1.1.2.3.3.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p3.1.m1.1.1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.3">𝑎</ci></apply><apply id="S3.SS1.p3.1.m1.2.2.2.2.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.2.2.2.2.1.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2">superscript</csymbol><apply id="S3.SS1.p3.1.m1.2.2.2.2.2.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p3.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2.2.2">𝑤</ci><apply id="S3.SS1.p3.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2.2.3"><plus id="S3.SS1.p3.1.m1.2.2.2.2.2.3.1.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2.2.3.1"></plus><ci id="S3.SS1.p3.1.m1.2.2.2.2.2.3.2.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="S3.SS1.p3.1.m1.2.2.2.2.2.3.3.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p3.1.m1.2.2.2.2.3.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2.3">𝑏</ci></apply><apply id="S3.SS1.p3.1.m1.3.3.3.3.cmml" xref="S3.SS1.p3.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.3.3.3.3.1.cmml" xref="S3.SS1.p3.1.m1.3.3.3.3">superscript</csymbol><apply id="S3.SS1.p3.1.m1.3.3.3.3.2.cmml" xref="S3.SS1.p3.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.3.3.3.3.2.1.cmml" xref="S3.SS1.p3.1.m1.3.3.3.3">subscript</csymbol><ci id="S3.SS1.p3.1.m1.3.3.3.3.2.2.cmml" xref="S3.SS1.p3.1.m1.3.3.3.3.2.2">𝑤</ci><apply id="S3.SS1.p3.1.m1.3.3.3.3.2.3.cmml" xref="S3.SS1.p3.1.m1.3.3.3.3.2.3"><plus id="S3.SS1.p3.1.m1.3.3.3.3.2.3.1.cmml" xref="S3.SS1.p3.1.m1.3.3.3.3.2.3.1"></plus><ci id="S3.SS1.p3.1.m1.3.3.3.3.2.3.2.cmml" xref="S3.SS1.p3.1.m1.3.3.3.3.2.3.2">𝑡</ci><cn type="integer" id="S3.SS1.p3.1.m1.3.3.3.3.2.3.3.cmml" xref="S3.SS1.p3.1.m1.3.3.3.3.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p3.1.m1.3.3.3.3.3.cmml" xref="S3.SS1.p3.1.m1.3.3.3.3.3">𝑐</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.3c">w_{t+1}^{a},w_{t+1}^{b},w_{t+1}^{c}</annotation></semantics></math> after the homomorphic aggregation over local models with an identical architecture, we start the heterogeneous aggregation from Line <a href="#alg1.l25" title="In Algorithm 1 ‣ 3.1. Layer-wise Heterogeneous Aggregation Framework ‣ 3. Methodology ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">25</span></a> in Algorithm <a href="#alg1" title="Algorithm 1 ‣ 3.1. Layer-wise Heterogeneous Aggregation Framework ‣ 3. Methodology ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> to exchange knowledge across variant model architectures.
It should be noted that we decompose the model <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><mi id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><ci id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">w</annotation></semantics></math> into a shared module <math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><mi id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><ci id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">\theta</annotation></semantics></math> and an isolated module <math id="S3.SS1.p3.4.m4.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S3.SS1.p3.4.m4.1a"><mi id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><ci id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">f</annotation></semantics></math> for each group.
The shared module includes bottom encoding layers <math id="S3.SS1.p3.5.m5.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS1.p3.5.m5.1a"><mi id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><ci id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">\theta</annotation></semantics></math> and the isolated module includes the last encoder layer and top task-specific layers, such as the pooling and dense layer and the classifier layer in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3. Methodology ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
<span id="S3.SS1.p3.17.1" class="ltx_text ltx_font_italic">InclusiveFL</span> is a general framework for other tasks by only changing the architecture of the top layers <math id="S3.SS1.p3.6.m6.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S3.SS1.p3.6.m6.1a"><mi id="S3.SS1.p3.6.m6.1.1" xref="S3.SS1.p3.6.m6.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m6.1b"><ci id="S3.SS1.p3.6.m6.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m6.1c">f</annotation></semantics></math>.
Thus, we first exclude the updated <math id="S3.SS1.p3.7.m7.1" class="ltx_Math" alttext="f_{t+1}" display="inline"><semantics id="S3.SS1.p3.7.m7.1a"><msub id="S3.SS1.p3.7.m7.1.1" xref="S3.SS1.p3.7.m7.1.1.cmml"><mi id="S3.SS1.p3.7.m7.1.1.2" xref="S3.SS1.p3.7.m7.1.1.2.cmml">f</mi><mrow id="S3.SS1.p3.7.m7.1.1.3" xref="S3.SS1.p3.7.m7.1.1.3.cmml"><mi id="S3.SS1.p3.7.m7.1.1.3.2" xref="S3.SS1.p3.7.m7.1.1.3.2.cmml">t</mi><mo id="S3.SS1.p3.7.m7.1.1.3.1" xref="S3.SS1.p3.7.m7.1.1.3.1.cmml">+</mo><mn id="S3.SS1.p3.7.m7.1.1.3.3" xref="S3.SS1.p3.7.m7.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m7.1b"><apply id="S3.SS1.p3.7.m7.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m7.1.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p3.7.m7.1.1.2.cmml" xref="S3.SS1.p3.7.m7.1.1.2">𝑓</ci><apply id="S3.SS1.p3.7.m7.1.1.3.cmml" xref="S3.SS1.p3.7.m7.1.1.3"><plus id="S3.SS1.p3.7.m7.1.1.3.1.cmml" xref="S3.SS1.p3.7.m7.1.1.3.1"></plus><ci id="S3.SS1.p3.7.m7.1.1.3.2.cmml" xref="S3.SS1.p3.7.m7.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS1.p3.7.m7.1.1.3.3.cmml" xref="S3.SS1.p3.7.m7.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m7.1c">f_{t+1}</annotation></semantics></math> in the heterogeneous parameter aggregation and conduct the standard <span id="S3.SS1.p3.17.2" class="ltx_text ltx_font_italic">FedAvg</span> for each overlapped layer in shared module <math id="S3.SS1.p3.8.m8.1" class="ltx_Math" alttext="\theta_{t+1}^{c}" display="inline"><semantics id="S3.SS1.p3.8.m8.1a"><msubsup id="S3.SS1.p3.8.m8.1.1" xref="S3.SS1.p3.8.m8.1.1.cmml"><mi id="S3.SS1.p3.8.m8.1.1.2.2" xref="S3.SS1.p3.8.m8.1.1.2.2.cmml">θ</mi><mrow id="S3.SS1.p3.8.m8.1.1.2.3" xref="S3.SS1.p3.8.m8.1.1.2.3.cmml"><mi id="S3.SS1.p3.8.m8.1.1.2.3.2" xref="S3.SS1.p3.8.m8.1.1.2.3.2.cmml">t</mi><mo id="S3.SS1.p3.8.m8.1.1.2.3.1" xref="S3.SS1.p3.8.m8.1.1.2.3.1.cmml">+</mo><mn id="S3.SS1.p3.8.m8.1.1.2.3.3" xref="S3.SS1.p3.8.m8.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p3.8.m8.1.1.3" xref="S3.SS1.p3.8.m8.1.1.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.8.m8.1b"><apply id="S3.SS1.p3.8.m8.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m8.1.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1">superscript</csymbol><apply id="S3.SS1.p3.8.m8.1.1.2.cmml" xref="S3.SS1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m8.1.1.2.1.cmml" xref="S3.SS1.p3.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p3.8.m8.1.1.2.2.cmml" xref="S3.SS1.p3.8.m8.1.1.2.2">𝜃</ci><apply id="S3.SS1.p3.8.m8.1.1.2.3.cmml" xref="S3.SS1.p3.8.m8.1.1.2.3"><plus id="S3.SS1.p3.8.m8.1.1.2.3.1.cmml" xref="S3.SS1.p3.8.m8.1.1.2.3.1"></plus><ci id="S3.SS1.p3.8.m8.1.1.2.3.2.cmml" xref="S3.SS1.p3.8.m8.1.1.2.3.2">𝑡</ci><cn type="integer" id="S3.SS1.p3.8.m8.1.1.2.3.3.cmml" xref="S3.SS1.p3.8.m8.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p3.8.m8.1.1.3.cmml" xref="S3.SS1.p3.8.m8.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.8.m8.1c">\theta_{t+1}^{c}</annotation></semantics></math>, as shown in Line <a href="#alg1.l26" title="In Algorithm 1 ‣ 3.1. Layer-wise Heterogeneous Aggregation Framework ‣ 3. Methodology ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">26</span></a> and <a href="#alg1.l27" title="In Algorithm 1 ‣ 3.1. Layer-wise Heterogeneous Aggregation Framework ‣ 3. Methodology ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">27</span></a>.
Specifically, we use the notation <math id="S3.SS1.p3.9.m9.2" class="ltx_Math" alttext="\theta_{t+1}^{i,l}" display="inline"><semantics id="S3.SS1.p3.9.m9.2a"><msubsup id="S3.SS1.p3.9.m9.2.3" xref="S3.SS1.p3.9.m9.2.3.cmml"><mi id="S3.SS1.p3.9.m9.2.3.2.2" xref="S3.SS1.p3.9.m9.2.3.2.2.cmml">θ</mi><mrow id="S3.SS1.p3.9.m9.2.3.2.3" xref="S3.SS1.p3.9.m9.2.3.2.3.cmml"><mi id="S3.SS1.p3.9.m9.2.3.2.3.2" xref="S3.SS1.p3.9.m9.2.3.2.3.2.cmml">t</mi><mo id="S3.SS1.p3.9.m9.2.3.2.3.1" xref="S3.SS1.p3.9.m9.2.3.2.3.1.cmml">+</mo><mn id="S3.SS1.p3.9.m9.2.3.2.3.3" xref="S3.SS1.p3.9.m9.2.3.2.3.3.cmml">1</mn></mrow><mrow id="S3.SS1.p3.9.m9.2.2.2.4" xref="S3.SS1.p3.9.m9.2.2.2.3.cmml"><mi id="S3.SS1.p3.9.m9.1.1.1.1" xref="S3.SS1.p3.9.m9.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p3.9.m9.2.2.2.4.1" xref="S3.SS1.p3.9.m9.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p3.9.m9.2.2.2.2" xref="S3.SS1.p3.9.m9.2.2.2.2.cmml">l</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.9.m9.2b"><apply id="S3.SS1.p3.9.m9.2.3.cmml" xref="S3.SS1.p3.9.m9.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.9.m9.2.3.1.cmml" xref="S3.SS1.p3.9.m9.2.3">superscript</csymbol><apply id="S3.SS1.p3.9.m9.2.3.2.cmml" xref="S3.SS1.p3.9.m9.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.9.m9.2.3.2.1.cmml" xref="S3.SS1.p3.9.m9.2.3">subscript</csymbol><ci id="S3.SS1.p3.9.m9.2.3.2.2.cmml" xref="S3.SS1.p3.9.m9.2.3.2.2">𝜃</ci><apply id="S3.SS1.p3.9.m9.2.3.2.3.cmml" xref="S3.SS1.p3.9.m9.2.3.2.3"><plus id="S3.SS1.p3.9.m9.2.3.2.3.1.cmml" xref="S3.SS1.p3.9.m9.2.3.2.3.1"></plus><ci id="S3.SS1.p3.9.m9.2.3.2.3.2.cmml" xref="S3.SS1.p3.9.m9.2.3.2.3.2">𝑡</ci><cn type="integer" id="S3.SS1.p3.9.m9.2.3.2.3.3.cmml" xref="S3.SS1.p3.9.m9.2.3.2.3.3">1</cn></apply></apply><list id="S3.SS1.p3.9.m9.2.2.2.3.cmml" xref="S3.SS1.p3.9.m9.2.2.2.4"><ci id="S3.SS1.p3.9.m9.1.1.1.1.cmml" xref="S3.SS1.p3.9.m9.1.1.1.1">𝑖</ci><ci id="S3.SS1.p3.9.m9.2.2.2.2.cmml" xref="S3.SS1.p3.9.m9.2.2.2.2">𝑙</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.9.m9.2c">\theta_{t+1}^{i,l}</annotation></semantics></math> to indicate the <math id="S3.SS1.p3.10.m10.1" class="ltx_Math" alttext="l^{th}" display="inline"><semantics id="S3.SS1.p3.10.m10.1a"><msup id="S3.SS1.p3.10.m10.1.1" xref="S3.SS1.p3.10.m10.1.1.cmml"><mi id="S3.SS1.p3.10.m10.1.1.2" xref="S3.SS1.p3.10.m10.1.1.2.cmml">l</mi><mrow id="S3.SS1.p3.10.m10.1.1.3" xref="S3.SS1.p3.10.m10.1.1.3.cmml"><mi id="S3.SS1.p3.10.m10.1.1.3.2" xref="S3.SS1.p3.10.m10.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.10.m10.1.1.3.1" xref="S3.SS1.p3.10.m10.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p3.10.m10.1.1.3.3" xref="S3.SS1.p3.10.m10.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.10.m10.1b"><apply id="S3.SS1.p3.10.m10.1.1.cmml" xref="S3.SS1.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.10.m10.1.1.1.cmml" xref="S3.SS1.p3.10.m10.1.1">superscript</csymbol><ci id="S3.SS1.p3.10.m10.1.1.2.cmml" xref="S3.SS1.p3.10.m10.1.1.2">𝑙</ci><apply id="S3.SS1.p3.10.m10.1.1.3.cmml" xref="S3.SS1.p3.10.m10.1.1.3"><times id="S3.SS1.p3.10.m10.1.1.3.1.cmml" xref="S3.SS1.p3.10.m10.1.1.3.1"></times><ci id="S3.SS1.p3.10.m10.1.1.3.2.cmml" xref="S3.SS1.p3.10.m10.1.1.3.2">𝑡</ci><ci id="S3.SS1.p3.10.m10.1.1.3.3.cmml" xref="S3.SS1.p3.10.m10.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.10.m10.1c">l^{th}</annotation></semantics></math> encoder layer in the model for device type <math id="S3.SS1.p3.11.m11.3" class="ltx_Math" alttext="j\in\{a,b,c\}" display="inline"><semantics id="S3.SS1.p3.11.m11.3a"><mrow id="S3.SS1.p3.11.m11.3.4" xref="S3.SS1.p3.11.m11.3.4.cmml"><mi id="S3.SS1.p3.11.m11.3.4.2" xref="S3.SS1.p3.11.m11.3.4.2.cmml">j</mi><mo id="S3.SS1.p3.11.m11.3.4.1" xref="S3.SS1.p3.11.m11.3.4.1.cmml">∈</mo><mrow id="S3.SS1.p3.11.m11.3.4.3.2" xref="S3.SS1.p3.11.m11.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS1.p3.11.m11.3.4.3.2.1" xref="S3.SS1.p3.11.m11.3.4.3.1.cmml">{</mo><mi id="S3.SS1.p3.11.m11.1.1" xref="S3.SS1.p3.11.m11.1.1.cmml">a</mi><mo id="S3.SS1.p3.11.m11.3.4.3.2.2" xref="S3.SS1.p3.11.m11.3.4.3.1.cmml">,</mo><mi id="S3.SS1.p3.11.m11.2.2" xref="S3.SS1.p3.11.m11.2.2.cmml">b</mi><mo id="S3.SS1.p3.11.m11.3.4.3.2.3" xref="S3.SS1.p3.11.m11.3.4.3.1.cmml">,</mo><mi id="S3.SS1.p3.11.m11.3.3" xref="S3.SS1.p3.11.m11.3.3.cmml">c</mi><mo stretchy="false" id="S3.SS1.p3.11.m11.3.4.3.2.4" xref="S3.SS1.p3.11.m11.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.11.m11.3b"><apply id="S3.SS1.p3.11.m11.3.4.cmml" xref="S3.SS1.p3.11.m11.3.4"><in id="S3.SS1.p3.11.m11.3.4.1.cmml" xref="S3.SS1.p3.11.m11.3.4.1"></in><ci id="S3.SS1.p3.11.m11.3.4.2.cmml" xref="S3.SS1.p3.11.m11.3.4.2">𝑗</ci><set id="S3.SS1.p3.11.m11.3.4.3.1.cmml" xref="S3.SS1.p3.11.m11.3.4.3.2"><ci id="S3.SS1.p3.11.m11.1.1.cmml" xref="S3.SS1.p3.11.m11.1.1">𝑎</ci><ci id="S3.SS1.p3.11.m11.2.2.cmml" xref="S3.SS1.p3.11.m11.2.2">𝑏</ci><ci id="S3.SS1.p3.11.m11.3.3.cmml" xref="S3.SS1.p3.11.m11.3.3">𝑐</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.11.m11.3c">j\in\{a,b,c\}</annotation></semantics></math>.
Similarly, layers from <math id="S3.SS1.p3.12.m12.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S3.SS1.p3.12.m12.1a"><mn id="S3.SS1.p3.12.m12.1.1" xref="S3.SS1.p3.12.m12.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.12.m12.1b"><cn type="integer" id="S3.SS1.p3.12.m12.1.1.cmml" xref="S3.SS1.p3.12.m12.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.12.m12.1c">1</annotation></semantics></math> to <math id="S3.SS1.p3.13.m13.1" class="ltx_Math" alttext="L_{a}-1" display="inline"><semantics id="S3.SS1.p3.13.m13.1a"><mrow id="S3.SS1.p3.13.m13.1.1" xref="S3.SS1.p3.13.m13.1.1.cmml"><msub id="S3.SS1.p3.13.m13.1.1.2" xref="S3.SS1.p3.13.m13.1.1.2.cmml"><mi id="S3.SS1.p3.13.m13.1.1.2.2" xref="S3.SS1.p3.13.m13.1.1.2.2.cmml">L</mi><mi id="S3.SS1.p3.13.m13.1.1.2.3" xref="S3.SS1.p3.13.m13.1.1.2.3.cmml">a</mi></msub><mo id="S3.SS1.p3.13.m13.1.1.1" xref="S3.SS1.p3.13.m13.1.1.1.cmml">−</mo><mn id="S3.SS1.p3.13.m13.1.1.3" xref="S3.SS1.p3.13.m13.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.13.m13.1b"><apply id="S3.SS1.p3.13.m13.1.1.cmml" xref="S3.SS1.p3.13.m13.1.1"><minus id="S3.SS1.p3.13.m13.1.1.1.cmml" xref="S3.SS1.p3.13.m13.1.1.1"></minus><apply id="S3.SS1.p3.13.m13.1.1.2.cmml" xref="S3.SS1.p3.13.m13.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.13.m13.1.1.2.1.cmml" xref="S3.SS1.p3.13.m13.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.13.m13.1.1.2.2.cmml" xref="S3.SS1.p3.13.m13.1.1.2.2">𝐿</ci><ci id="S3.SS1.p3.13.m13.1.1.2.3.cmml" xref="S3.SS1.p3.13.m13.1.1.2.3">𝑎</ci></apply><cn type="integer" id="S3.SS1.p3.13.m13.1.1.3.cmml" xref="S3.SS1.p3.13.m13.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.13.m13.1c">L_{a}-1</annotation></semantics></math> in the sub-global model with type <math id="S3.SS1.p3.14.m14.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS1.p3.14.m14.1a"><mi id="S3.SS1.p3.14.m14.1.1" xref="S3.SS1.p3.14.m14.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.14.m14.1b"><ci id="S3.SS1.p3.14.m14.1.1.cmml" xref="S3.SS1.p3.14.m14.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.14.m14.1c">c</annotation></semantics></math> is denoted as <math id="S3.SS1.p3.15.m15.2" class="ltx_Math" alttext="\theta_{t+1}^{c,1:L_{a}-1}" display="inline"><semantics id="S3.SS1.p3.15.m15.2a"><msubsup id="S3.SS1.p3.15.m15.2.3" xref="S3.SS1.p3.15.m15.2.3.cmml"><mi id="S3.SS1.p3.15.m15.2.3.2.2" xref="S3.SS1.p3.15.m15.2.3.2.2.cmml">θ</mi><mrow id="S3.SS1.p3.15.m15.2.3.2.3" xref="S3.SS1.p3.15.m15.2.3.2.3.cmml"><mi id="S3.SS1.p3.15.m15.2.3.2.3.2" xref="S3.SS1.p3.15.m15.2.3.2.3.2.cmml">t</mi><mo id="S3.SS1.p3.15.m15.2.3.2.3.1" xref="S3.SS1.p3.15.m15.2.3.2.3.1.cmml">+</mo><mn id="S3.SS1.p3.15.m15.2.3.2.3.3" xref="S3.SS1.p3.15.m15.2.3.2.3.3.cmml">1</mn></mrow><mrow id="S3.SS1.p3.15.m15.2.2.2" xref="S3.SS1.p3.15.m15.2.2.2.cmml"><mrow id="S3.SS1.p3.15.m15.2.2.2.4.2" xref="S3.SS1.p3.15.m15.2.2.2.4.1.cmml"><mi id="S3.SS1.p3.15.m15.1.1.1.1" xref="S3.SS1.p3.15.m15.1.1.1.1.cmml">c</mi><mo id="S3.SS1.p3.15.m15.2.2.2.4.2.1" xref="S3.SS1.p3.15.m15.2.2.2.4.1.cmml">,</mo><mn id="S3.SS1.p3.15.m15.2.2.2.2" xref="S3.SS1.p3.15.m15.2.2.2.2.cmml">1</mn></mrow><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p3.15.m15.2.2.2.3" xref="S3.SS1.p3.15.m15.2.2.2.3.cmml">:</mo><mrow id="S3.SS1.p3.15.m15.2.2.2.5" xref="S3.SS1.p3.15.m15.2.2.2.5.cmml"><msub id="S3.SS1.p3.15.m15.2.2.2.5.2" xref="S3.SS1.p3.15.m15.2.2.2.5.2.cmml"><mi id="S3.SS1.p3.15.m15.2.2.2.5.2.2" xref="S3.SS1.p3.15.m15.2.2.2.5.2.2.cmml">L</mi><mi id="S3.SS1.p3.15.m15.2.2.2.5.2.3" xref="S3.SS1.p3.15.m15.2.2.2.5.2.3.cmml">a</mi></msub><mo id="S3.SS1.p3.15.m15.2.2.2.5.1" xref="S3.SS1.p3.15.m15.2.2.2.5.1.cmml">−</mo><mn id="S3.SS1.p3.15.m15.2.2.2.5.3" xref="S3.SS1.p3.15.m15.2.2.2.5.3.cmml">1</mn></mrow></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.15.m15.2b"><apply id="S3.SS1.p3.15.m15.2.3.cmml" xref="S3.SS1.p3.15.m15.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.15.m15.2.3.1.cmml" xref="S3.SS1.p3.15.m15.2.3">superscript</csymbol><apply id="S3.SS1.p3.15.m15.2.3.2.cmml" xref="S3.SS1.p3.15.m15.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.15.m15.2.3.2.1.cmml" xref="S3.SS1.p3.15.m15.2.3">subscript</csymbol><ci id="S3.SS1.p3.15.m15.2.3.2.2.cmml" xref="S3.SS1.p3.15.m15.2.3.2.2">𝜃</ci><apply id="S3.SS1.p3.15.m15.2.3.2.3.cmml" xref="S3.SS1.p3.15.m15.2.3.2.3"><plus id="S3.SS1.p3.15.m15.2.3.2.3.1.cmml" xref="S3.SS1.p3.15.m15.2.3.2.3.1"></plus><ci id="S3.SS1.p3.15.m15.2.3.2.3.2.cmml" xref="S3.SS1.p3.15.m15.2.3.2.3.2">𝑡</ci><cn type="integer" id="S3.SS1.p3.15.m15.2.3.2.3.3.cmml" xref="S3.SS1.p3.15.m15.2.3.2.3.3">1</cn></apply></apply><apply id="S3.SS1.p3.15.m15.2.2.2.cmml" xref="S3.SS1.p3.15.m15.2.2.2"><ci id="S3.SS1.p3.15.m15.2.2.2.3.cmml" xref="S3.SS1.p3.15.m15.2.2.2.3">:</ci><list id="S3.SS1.p3.15.m15.2.2.2.4.1.cmml" xref="S3.SS1.p3.15.m15.2.2.2.4.2"><ci id="S3.SS1.p3.15.m15.1.1.1.1.cmml" xref="S3.SS1.p3.15.m15.1.1.1.1">𝑐</ci><cn type="integer" id="S3.SS1.p3.15.m15.2.2.2.2.cmml" xref="S3.SS1.p3.15.m15.2.2.2.2">1</cn></list><apply id="S3.SS1.p3.15.m15.2.2.2.5.cmml" xref="S3.SS1.p3.15.m15.2.2.2.5"><minus id="S3.SS1.p3.15.m15.2.2.2.5.1.cmml" xref="S3.SS1.p3.15.m15.2.2.2.5.1"></minus><apply id="S3.SS1.p3.15.m15.2.2.2.5.2.cmml" xref="S3.SS1.p3.15.m15.2.2.2.5.2"><csymbol cd="ambiguous" id="S3.SS1.p3.15.m15.2.2.2.5.2.1.cmml" xref="S3.SS1.p3.15.m15.2.2.2.5.2">subscript</csymbol><ci id="S3.SS1.p3.15.m15.2.2.2.5.2.2.cmml" xref="S3.SS1.p3.15.m15.2.2.2.5.2.2">𝐿</ci><ci id="S3.SS1.p3.15.m15.2.2.2.5.2.3.cmml" xref="S3.SS1.p3.15.m15.2.2.2.5.2.3">𝑎</ci></apply><cn type="integer" id="S3.SS1.p3.15.m15.2.2.2.5.3.cmml" xref="S3.SS1.p3.15.m15.2.2.2.5.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.15.m15.2c">\theta_{t+1}^{c,1:L_{a}-1}</annotation></semantics></math>.
Combining with the within-group updated top layers <math id="S3.SS1.p3.16.m16.1" class="ltx_Math" alttext="f_{t+1}" display="inline"><semantics id="S3.SS1.p3.16.m16.1a"><msub id="S3.SS1.p3.16.m16.1.1" xref="S3.SS1.p3.16.m16.1.1.cmml"><mi id="S3.SS1.p3.16.m16.1.1.2" xref="S3.SS1.p3.16.m16.1.1.2.cmml">f</mi><mrow id="S3.SS1.p3.16.m16.1.1.3" xref="S3.SS1.p3.16.m16.1.1.3.cmml"><mi id="S3.SS1.p3.16.m16.1.1.3.2" xref="S3.SS1.p3.16.m16.1.1.3.2.cmml">t</mi><mo id="S3.SS1.p3.16.m16.1.1.3.1" xref="S3.SS1.p3.16.m16.1.1.3.1.cmml">+</mo><mn id="S3.SS1.p3.16.m16.1.1.3.3" xref="S3.SS1.p3.16.m16.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.16.m16.1b"><apply id="S3.SS1.p3.16.m16.1.1.cmml" xref="S3.SS1.p3.16.m16.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.16.m16.1.1.1.cmml" xref="S3.SS1.p3.16.m16.1.1">subscript</csymbol><ci id="S3.SS1.p3.16.m16.1.1.2.cmml" xref="S3.SS1.p3.16.m16.1.1.2">𝑓</ci><apply id="S3.SS1.p3.16.m16.1.1.3.cmml" xref="S3.SS1.p3.16.m16.1.1.3"><plus id="S3.SS1.p3.16.m16.1.1.3.1.cmml" xref="S3.SS1.p3.16.m16.1.1.3.1"></plus><ci id="S3.SS1.p3.16.m16.1.1.3.2.cmml" xref="S3.SS1.p3.16.m16.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS1.p3.16.m16.1.1.3.3.cmml" xref="S3.SS1.p3.16.m16.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.16.m16.1c">f_{t+1}</annotation></semantics></math> for <math id="S3.SS1.p3.17.m17.3" class="ltx_Math" alttext="\{a,b,c\}" display="inline"><semantics id="S3.SS1.p3.17.m17.3a"><mrow id="S3.SS1.p3.17.m17.3.4.2" xref="S3.SS1.p3.17.m17.3.4.1.cmml"><mo stretchy="false" id="S3.SS1.p3.17.m17.3.4.2.1" xref="S3.SS1.p3.17.m17.3.4.1.cmml">{</mo><mi id="S3.SS1.p3.17.m17.1.1" xref="S3.SS1.p3.17.m17.1.1.cmml">a</mi><mo id="S3.SS1.p3.17.m17.3.4.2.2" xref="S3.SS1.p3.17.m17.3.4.1.cmml">,</mo><mi id="S3.SS1.p3.17.m17.2.2" xref="S3.SS1.p3.17.m17.2.2.cmml">b</mi><mo id="S3.SS1.p3.17.m17.3.4.2.3" xref="S3.SS1.p3.17.m17.3.4.1.cmml">,</mo><mi id="S3.SS1.p3.17.m17.3.3" xref="S3.SS1.p3.17.m17.3.3.cmml">c</mi><mo stretchy="false" id="S3.SS1.p3.17.m17.3.4.2.4" xref="S3.SS1.p3.17.m17.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.17.m17.3b"><set id="S3.SS1.p3.17.m17.3.4.1.cmml" xref="S3.SS1.p3.17.m17.3.4.2"><ci id="S3.SS1.p3.17.m17.1.1.cmml" xref="S3.SS1.p3.17.m17.1.1">𝑎</ci><ci id="S3.SS1.p3.17.m17.2.2.cmml" xref="S3.SS1.p3.17.m17.2.2">𝑏</ci><ci id="S3.SS1.p3.17.m17.3.3.cmml" xref="S3.SS1.p3.17.m17.3.3">𝑐</ci></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.17.m17.3c">\{a,b,c\}</annotation></semantics></math> in Line <a href="#alg1.l29" title="In Algorithm 1 ‣ 3.1. Layer-wise Heterogeneous Aggregation Framework ‣ 3. Methodology ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">29</span></a>, the server derives the updated sub-global model and distributes to clients for the next round.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.10" class="ltx_p">Intuitively, the bottom layers can be shared because they can capture basic features across heterogeneous models.
Also, the overlapped layers across three models have the same initialization, which help to align them keep aligned from the beginning of training.
We are motivated to isolate the last encoder layer and top layers for two considerations.
First, isolating top layers help mitigate the parameter mismatch in each sub-global model.
For the example of a text classification task in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3. Methodology ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, the bottom <math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="L_{a}-1" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><mrow id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml"><msub id="S3.SS1.p4.1.m1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.2.cmml"><mi id="S3.SS1.p4.1.m1.1.1.2.2" xref="S3.SS1.p4.1.m1.1.1.2.2.cmml">L</mi><mi id="S3.SS1.p4.1.m1.1.1.2.3" xref="S3.SS1.p4.1.m1.1.1.2.3.cmml">a</mi></msub><mo id="S3.SS1.p4.1.m1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.cmml">−</mo><mn id="S3.SS1.p4.1.m1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1"><minus id="S3.SS1.p4.1.m1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1"></minus><apply id="S3.SS1.p4.1.m1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.1.2.1.cmml" xref="S3.SS1.p4.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.p4.1.m1.1.1.2.2.cmml" xref="S3.SS1.p4.1.m1.1.1.2.2">𝐿</ci><ci id="S3.SS1.p4.1.m1.1.1.2.3.cmml" xref="S3.SS1.p4.1.m1.1.1.2.3">𝑎</ci></apply><cn type="integer" id="S3.SS1.p4.1.m1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">L_{a}-1</annotation></semantics></math> layers in <math id="S3.SS1.p4.2.m2.1" class="ltx_Math" alttext="w^{a}" display="inline"><semantics id="S3.SS1.p4.2.m2.1a"><msup id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml"><mi id="S3.SS1.p4.2.m2.1.1.2" xref="S3.SS1.p4.2.m2.1.1.2.cmml">w</mi><mi id="S3.SS1.p4.2.m2.1.1.3" xref="S3.SS1.p4.2.m2.1.1.3.cmml">a</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><apply id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.1.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">superscript</csymbol><ci id="S3.SS1.p4.2.m2.1.1.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2">𝑤</ci><ci id="S3.SS1.p4.2.m2.1.1.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">w^{a}</annotation></semantics></math> will produce a sequence of hidden states as the input to a pooling and dense layer for getting a sentence embedding.
However, the output of the bottom <math id="S3.SS1.p4.3.m3.1" class="ltx_Math" alttext="L_{a}-1" display="inline"><semantics id="S3.SS1.p4.3.m3.1a"><mrow id="S3.SS1.p4.3.m3.1.1" xref="S3.SS1.p4.3.m3.1.1.cmml"><msub id="S3.SS1.p4.3.m3.1.1.2" xref="S3.SS1.p4.3.m3.1.1.2.cmml"><mi id="S3.SS1.p4.3.m3.1.1.2.2" xref="S3.SS1.p4.3.m3.1.1.2.2.cmml">L</mi><mi id="S3.SS1.p4.3.m3.1.1.2.3" xref="S3.SS1.p4.3.m3.1.1.2.3.cmml">a</mi></msub><mo id="S3.SS1.p4.3.m3.1.1.1" xref="S3.SS1.p4.3.m3.1.1.1.cmml">−</mo><mn id="S3.SS1.p4.3.m3.1.1.3" xref="S3.SS1.p4.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.1b"><apply id="S3.SS1.p4.3.m3.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1"><minus id="S3.SS1.p4.3.m3.1.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1.1"></minus><apply id="S3.SS1.p4.3.m3.1.1.2.cmml" xref="S3.SS1.p4.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.3.m3.1.1.2.1.cmml" xref="S3.SS1.p4.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.p4.3.m3.1.1.2.2.cmml" xref="S3.SS1.p4.3.m3.1.1.2.2">𝐿</ci><ci id="S3.SS1.p4.3.m3.1.1.2.3.cmml" xref="S3.SS1.p4.3.m3.1.1.2.3">𝑎</ci></apply><cn type="integer" id="S3.SS1.p4.3.m3.1.1.3.cmml" xref="S3.SS1.p4.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.1c">L_{a}-1</annotation></semantics></math> layers in <math id="S3.SS1.p4.4.m4.1" class="ltx_Math" alttext="w_{b}" display="inline"><semantics id="S3.SS1.p4.4.m4.1a"><msub id="S3.SS1.p4.4.m4.1.1" xref="S3.SS1.p4.4.m4.1.1.cmml"><mi id="S3.SS1.p4.4.m4.1.1.2" xref="S3.SS1.p4.4.m4.1.1.2.cmml">w</mi><mi id="S3.SS1.p4.4.m4.1.1.3" xref="S3.SS1.p4.4.m4.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m4.1b"><apply id="S3.SS1.p4.4.m4.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.4.m4.1.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p4.4.m4.1.1.2.cmml" xref="S3.SS1.p4.4.m4.1.1.2">𝑤</ci><ci id="S3.SS1.p4.4.m4.1.1.3.cmml" xref="S3.SS1.p4.4.m4.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m4.1c">w_{b}</annotation></semantics></math> can be further extracted with other <math id="S3.SS1.p4.5.m5.1" class="ltx_Math" alttext="L_{b}-L_{a}+1" display="inline"><semantics id="S3.SS1.p4.5.m5.1a"><mrow id="S3.SS1.p4.5.m5.1.1" xref="S3.SS1.p4.5.m5.1.1.cmml"><mrow id="S3.SS1.p4.5.m5.1.1.2" xref="S3.SS1.p4.5.m5.1.1.2.cmml"><msub id="S3.SS1.p4.5.m5.1.1.2.2" xref="S3.SS1.p4.5.m5.1.1.2.2.cmml"><mi id="S3.SS1.p4.5.m5.1.1.2.2.2" xref="S3.SS1.p4.5.m5.1.1.2.2.2.cmml">L</mi><mi id="S3.SS1.p4.5.m5.1.1.2.2.3" xref="S3.SS1.p4.5.m5.1.1.2.2.3.cmml">b</mi></msub><mo id="S3.SS1.p4.5.m5.1.1.2.1" xref="S3.SS1.p4.5.m5.1.1.2.1.cmml">−</mo><msub id="S3.SS1.p4.5.m5.1.1.2.3" xref="S3.SS1.p4.5.m5.1.1.2.3.cmml"><mi id="S3.SS1.p4.5.m5.1.1.2.3.2" xref="S3.SS1.p4.5.m5.1.1.2.3.2.cmml">L</mi><mi id="S3.SS1.p4.5.m5.1.1.2.3.3" xref="S3.SS1.p4.5.m5.1.1.2.3.3.cmml">a</mi></msub></mrow><mo id="S3.SS1.p4.5.m5.1.1.1" xref="S3.SS1.p4.5.m5.1.1.1.cmml">+</mo><mn id="S3.SS1.p4.5.m5.1.1.3" xref="S3.SS1.p4.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.5.m5.1b"><apply id="S3.SS1.p4.5.m5.1.1.cmml" xref="S3.SS1.p4.5.m5.1.1"><plus id="S3.SS1.p4.5.m5.1.1.1.cmml" xref="S3.SS1.p4.5.m5.1.1.1"></plus><apply id="S3.SS1.p4.5.m5.1.1.2.cmml" xref="S3.SS1.p4.5.m5.1.1.2"><minus id="S3.SS1.p4.5.m5.1.1.2.1.cmml" xref="S3.SS1.p4.5.m5.1.1.2.1"></minus><apply id="S3.SS1.p4.5.m5.1.1.2.2.cmml" xref="S3.SS1.p4.5.m5.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p4.5.m5.1.1.2.2.1.cmml" xref="S3.SS1.p4.5.m5.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p4.5.m5.1.1.2.2.2.cmml" xref="S3.SS1.p4.5.m5.1.1.2.2.2">𝐿</ci><ci id="S3.SS1.p4.5.m5.1.1.2.2.3.cmml" xref="S3.SS1.p4.5.m5.1.1.2.2.3">𝑏</ci></apply><apply id="S3.SS1.p4.5.m5.1.1.2.3.cmml" xref="S3.SS1.p4.5.m5.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p4.5.m5.1.1.2.3.1.cmml" xref="S3.SS1.p4.5.m5.1.1.2.3">subscript</csymbol><ci id="S3.SS1.p4.5.m5.1.1.2.3.2.cmml" xref="S3.SS1.p4.5.m5.1.1.2.3.2">𝐿</ci><ci id="S3.SS1.p4.5.m5.1.1.2.3.3.cmml" xref="S3.SS1.p4.5.m5.1.1.2.3.3">𝑎</ci></apply></apply><cn type="integer" id="S3.SS1.p4.5.m5.1.1.3.cmml" xref="S3.SS1.p4.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.5.m5.1c">L_{b}-L_{a}+1</annotation></semantics></math> layers before the pooling and dense layer.
Thus, the top parameters behave differently due to the heterogeneous model architectures.
If sharing <math id="S3.SS1.p4.6.m6.1" class="ltx_Math" alttext="f_{t+1}^{a}" display="inline"><semantics id="S3.SS1.p4.6.m6.1a"><msubsup id="S3.SS1.p4.6.m6.1.1" xref="S3.SS1.p4.6.m6.1.1.cmml"><mi id="S3.SS1.p4.6.m6.1.1.2.2" xref="S3.SS1.p4.6.m6.1.1.2.2.cmml">f</mi><mrow id="S3.SS1.p4.6.m6.1.1.2.3" xref="S3.SS1.p4.6.m6.1.1.2.3.cmml"><mi id="S3.SS1.p4.6.m6.1.1.2.3.2" xref="S3.SS1.p4.6.m6.1.1.2.3.2.cmml">t</mi><mo id="S3.SS1.p4.6.m6.1.1.2.3.1" xref="S3.SS1.p4.6.m6.1.1.2.3.1.cmml">+</mo><mn id="S3.SS1.p4.6.m6.1.1.2.3.3" xref="S3.SS1.p4.6.m6.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p4.6.m6.1.1.3" xref="S3.SS1.p4.6.m6.1.1.3.cmml">a</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.6.m6.1b"><apply id="S3.SS1.p4.6.m6.1.1.cmml" xref="S3.SS1.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.6.m6.1.1.1.cmml" xref="S3.SS1.p4.6.m6.1.1">superscript</csymbol><apply id="S3.SS1.p4.6.m6.1.1.2.cmml" xref="S3.SS1.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.6.m6.1.1.2.1.cmml" xref="S3.SS1.p4.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p4.6.m6.1.1.2.2.cmml" xref="S3.SS1.p4.6.m6.1.1.2.2">𝑓</ci><apply id="S3.SS1.p4.6.m6.1.1.2.3.cmml" xref="S3.SS1.p4.6.m6.1.1.2.3"><plus id="S3.SS1.p4.6.m6.1.1.2.3.1.cmml" xref="S3.SS1.p4.6.m6.1.1.2.3.1"></plus><ci id="S3.SS1.p4.6.m6.1.1.2.3.2.cmml" xref="S3.SS1.p4.6.m6.1.1.2.3.2">𝑡</ci><cn type="integer" id="S3.SS1.p4.6.m6.1.1.2.3.3.cmml" xref="S3.SS1.p4.6.m6.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p4.6.m6.1.1.3.cmml" xref="S3.SS1.p4.6.m6.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.6.m6.1c">f_{t+1}^{a}</annotation></semantics></math> with <math id="S3.SS1.p4.7.m7.1" class="ltx_Math" alttext="f_{t+1}^{b}" display="inline"><semantics id="S3.SS1.p4.7.m7.1a"><msubsup id="S3.SS1.p4.7.m7.1.1" xref="S3.SS1.p4.7.m7.1.1.cmml"><mi id="S3.SS1.p4.7.m7.1.1.2.2" xref="S3.SS1.p4.7.m7.1.1.2.2.cmml">f</mi><mrow id="S3.SS1.p4.7.m7.1.1.2.3" xref="S3.SS1.p4.7.m7.1.1.2.3.cmml"><mi id="S3.SS1.p4.7.m7.1.1.2.3.2" xref="S3.SS1.p4.7.m7.1.1.2.3.2.cmml">t</mi><mo id="S3.SS1.p4.7.m7.1.1.2.3.1" xref="S3.SS1.p4.7.m7.1.1.2.3.1.cmml">+</mo><mn id="S3.SS1.p4.7.m7.1.1.2.3.3" xref="S3.SS1.p4.7.m7.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p4.7.m7.1.1.3" xref="S3.SS1.p4.7.m7.1.1.3.cmml">b</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.7.m7.1b"><apply id="S3.SS1.p4.7.m7.1.1.cmml" xref="S3.SS1.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.7.m7.1.1.1.cmml" xref="S3.SS1.p4.7.m7.1.1">superscript</csymbol><apply id="S3.SS1.p4.7.m7.1.1.2.cmml" xref="S3.SS1.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.7.m7.1.1.2.1.cmml" xref="S3.SS1.p4.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p4.7.m7.1.1.2.2.cmml" xref="S3.SS1.p4.7.m7.1.1.2.2">𝑓</ci><apply id="S3.SS1.p4.7.m7.1.1.2.3.cmml" xref="S3.SS1.p4.7.m7.1.1.2.3"><plus id="S3.SS1.p4.7.m7.1.1.2.3.1.cmml" xref="S3.SS1.p4.7.m7.1.1.2.3.1"></plus><ci id="S3.SS1.p4.7.m7.1.1.2.3.2.cmml" xref="S3.SS1.p4.7.m7.1.1.2.3.2">𝑡</ci><cn type="integer" id="S3.SS1.p4.7.m7.1.1.2.3.3.cmml" xref="S3.SS1.p4.7.m7.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p4.7.m7.1.1.3.cmml" xref="S3.SS1.p4.7.m7.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.7.m7.1c">f_{t+1}^{b}</annotation></semantics></math> and <math id="S3.SS1.p4.8.m8.1" class="ltx_Math" alttext="f_{t+1}^{c}" display="inline"><semantics id="S3.SS1.p4.8.m8.1a"><msubsup id="S3.SS1.p4.8.m8.1.1" xref="S3.SS1.p4.8.m8.1.1.cmml"><mi id="S3.SS1.p4.8.m8.1.1.2.2" xref="S3.SS1.p4.8.m8.1.1.2.2.cmml">f</mi><mrow id="S3.SS1.p4.8.m8.1.1.2.3" xref="S3.SS1.p4.8.m8.1.1.2.3.cmml"><mi id="S3.SS1.p4.8.m8.1.1.2.3.2" xref="S3.SS1.p4.8.m8.1.1.2.3.2.cmml">t</mi><mo id="S3.SS1.p4.8.m8.1.1.2.3.1" xref="S3.SS1.p4.8.m8.1.1.2.3.1.cmml">+</mo><mn id="S3.SS1.p4.8.m8.1.1.2.3.3" xref="S3.SS1.p4.8.m8.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p4.8.m8.1.1.3" xref="S3.SS1.p4.8.m8.1.1.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.8.m8.1b"><apply id="S3.SS1.p4.8.m8.1.1.cmml" xref="S3.SS1.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.8.m8.1.1.1.cmml" xref="S3.SS1.p4.8.m8.1.1">superscript</csymbol><apply id="S3.SS1.p4.8.m8.1.1.2.cmml" xref="S3.SS1.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.8.m8.1.1.2.1.cmml" xref="S3.SS1.p4.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p4.8.m8.1.1.2.2.cmml" xref="S3.SS1.p4.8.m8.1.1.2.2">𝑓</ci><apply id="S3.SS1.p4.8.m8.1.1.2.3.cmml" xref="S3.SS1.p4.8.m8.1.1.2.3"><plus id="S3.SS1.p4.8.m8.1.1.2.3.1.cmml" xref="S3.SS1.p4.8.m8.1.1.2.3.1"></plus><ci id="S3.SS1.p4.8.m8.1.1.2.3.2.cmml" xref="S3.SS1.p4.8.m8.1.1.2.3.2">𝑡</ci><cn type="integer" id="S3.SS1.p4.8.m8.1.1.2.3.3.cmml" xref="S3.SS1.p4.8.m8.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p4.8.m8.1.1.3.cmml" xref="S3.SS1.p4.8.m8.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.8.m8.1c">f_{t+1}^{c}</annotation></semantics></math>, the averaged model applied to <math id="S3.SS1.p4.9.m9.1" class="ltx_Math" alttext="w^{a}" display="inline"><semantics id="S3.SS1.p4.9.m9.1a"><msup id="S3.SS1.p4.9.m9.1.1" xref="S3.SS1.p4.9.m9.1.1.cmml"><mi id="S3.SS1.p4.9.m9.1.1.2" xref="S3.SS1.p4.9.m9.1.1.2.cmml">w</mi><mi id="S3.SS1.p4.9.m9.1.1.3" xref="S3.SS1.p4.9.m9.1.1.3.cmml">a</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.9.m9.1b"><apply id="S3.SS1.p4.9.m9.1.1.cmml" xref="S3.SS1.p4.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.9.m9.1.1.1.cmml" xref="S3.SS1.p4.9.m9.1.1">superscript</csymbol><ci id="S3.SS1.p4.9.m9.1.1.2.cmml" xref="S3.SS1.p4.9.m9.1.1.2">𝑤</ci><ci id="S3.SS1.p4.9.m9.1.1.3.cmml" xref="S3.SS1.p4.9.m9.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.9.m9.1c">w^{a}</annotation></semantics></math> would lack several layers of feature extraction, which would lead to a poor performance of <math id="S3.SS1.p4.10.m10.1" class="ltx_Math" alttext="w_{a}" display="inline"><semantics id="S3.SS1.p4.10.m10.1a"><msub id="S3.SS1.p4.10.m10.1.1" xref="S3.SS1.p4.10.m10.1.1.cmml"><mi id="S3.SS1.p4.10.m10.1.1.2" xref="S3.SS1.p4.10.m10.1.1.2.cmml">w</mi><mi id="S3.SS1.p4.10.m10.1.1.3" xref="S3.SS1.p4.10.m10.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.10.m10.1b"><apply id="S3.SS1.p4.10.m10.1.1.cmml" xref="S3.SS1.p4.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.10.m10.1.1.1.cmml" xref="S3.SS1.p4.10.m10.1.1">subscript</csymbol><ci id="S3.SS1.p4.10.m10.1.1.2.cmml" xref="S3.SS1.p4.10.m10.1.1.2">𝑤</ci><ci id="S3.SS1.p4.10.m10.1.1.3.cmml" xref="S3.SS1.p4.10.m10.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.10.m10.1c">w_{a}</annotation></semantics></math>.
Second, isolating top layers makes <span id="S3.SS1.p4.10.1" class="ltx_text ltx_font_italic">InclusiveFL</span> capable of training separate local model with different target labels.
For example in the cross-silo scenario such as federated named entity recognition <cite class="ltx_cite ltx_citemacro_citep">(Ge et al<span class="ltx_text">.</span>, <a href="#bib.bib12" title="" class="ltx_ref">2020</a>)</cite>, medical data stored at different medical institutions may have different characteristics and annotation criterion, which leads to personalized top layers.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Momentum Distillation</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">Now we introduce details of the momentum distillation for accelerating the heterogeneous federated training, as shown from Line <a href="#alg1.l15" title="In Algorithm 1 ‣ 3.1. Layer-wise Heterogeneous Aggregation Framework ‣ 3. Methodology ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">15</span></a> to <a href="#alg1.l23" title="In Algorithm 1 ‣ 3.1. Layer-wise Heterogeneous Aggregation Framework ‣ 3. Methodology ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">23</span></a> in Algorithm <a href="#alg1" title="Algorithm 1 ‣ 3.1. Layer-wise Heterogeneous Aggregation Framework ‣ 3. Methodology ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
Intuitively, a larger model is more capable of extracting knowledge from data than a small model.
Thus, we are motivated to distill knowledge from larger models to smaller models.
The knowledge distillation <cite class="ltx_cite ltx_citemacro_citep">(Hinton et al<span class="ltx_text">.</span>, <a href="#bib.bib16" title="" class="ltx_ref">2015</a>)</cite> in the centralized setting typically uses a hidden loss to align hidden representations of a small student model and a large teacher model.
However, the hidden loss does not apply to the heterogeneous federated learning with data separated for the small model and teacher model.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.11" class="ltx_p">Instead, we notice that the key to align small models and large models when bottom layers are shared is to align the behaviors of the isolated encoder layer in a small model to the corresponding top layers in the larger model.
Hence, taking the small model and the medium model for instance, we calculate a gradient momentum as the average over updates for a stack of layers from <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="L_{a}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">L</mi><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝐿</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">L_{a}</annotation></semantics></math> to <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="L_{b}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><msub id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">L</mi><mi id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝐿</ci><ci id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">L_{b}</annotation></semantics></math> in the medium sub-global model.
For the averaged update <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="g_{t}^{a}" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><msubsup id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2.2" xref="S3.SS2.p2.3.m3.1.1.2.2.cmml">g</mi><mi id="S3.SS2.p2.3.m3.1.1.2.3" xref="S3.SS2.p2.3.m3.1.1.2.3.cmml">t</mi><mi id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml">a</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">superscript</csymbol><apply id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.2.1.cmml" xref="S3.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2.2">𝑔</ci><ci id="S3.SS2.p2.3.m3.1.1.2.3.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3">𝑡</ci></apply><ci id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">g_{t}^{a}</annotation></semantics></math>, we inject a distilled gradient momentum <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="m_{t-1}^{b}" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><msubsup id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.2.2" xref="S3.SS2.p2.4.m4.1.1.2.2.cmml">m</mi><mrow id="S3.SS2.p2.4.m4.1.1.2.3" xref="S3.SS2.p2.4.m4.1.1.2.3.cmml"><mi id="S3.SS2.p2.4.m4.1.1.2.3.2" xref="S3.SS2.p2.4.m4.1.1.2.3.2.cmml">t</mi><mo id="S3.SS2.p2.4.m4.1.1.2.3.1" xref="S3.SS2.p2.4.m4.1.1.2.3.1.cmml">−</mo><mn id="S3.SS2.p2.4.m4.1.1.2.3.3" xref="S3.SS2.p2.4.m4.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml">b</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">superscript</csymbol><apply id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.2.1.cmml" xref="S3.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.2.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2.2">𝑚</ci><apply id="S3.SS2.p2.4.m4.1.1.2.3.cmml" xref="S3.SS2.p2.4.m4.1.1.2.3"><minus id="S3.SS2.p2.4.m4.1.1.2.3.1.cmml" xref="S3.SS2.p2.4.m4.1.1.2.3.1"></minus><ci id="S3.SS2.p2.4.m4.1.1.2.3.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2.3.2">𝑡</ci><cn type="integer" id="S3.SS2.p2.4.m4.1.1.2.3.3.cmml" xref="S3.SS2.p2.4.m4.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">m_{t-1}^{b}</annotation></semantics></math> to the update <math id="S3.SS2.p2.5.m5.2" class="ltx_Math" alttext="g_{t}^{a,L_{a}}" display="inline"><semantics id="S3.SS2.p2.5.m5.2a"><msubsup id="S3.SS2.p2.5.m5.2.3" xref="S3.SS2.p2.5.m5.2.3.cmml"><mi id="S3.SS2.p2.5.m5.2.3.2.2" xref="S3.SS2.p2.5.m5.2.3.2.2.cmml">g</mi><mi id="S3.SS2.p2.5.m5.2.3.2.3" xref="S3.SS2.p2.5.m5.2.3.2.3.cmml">t</mi><mrow id="S3.SS2.p2.5.m5.2.2.2.2" xref="S3.SS2.p2.5.m5.2.2.2.3.cmml"><mi id="S3.SS2.p2.5.m5.1.1.1.1" xref="S3.SS2.p2.5.m5.1.1.1.1.cmml">a</mi><mo id="S3.SS2.p2.5.m5.2.2.2.2.2" xref="S3.SS2.p2.5.m5.2.2.2.3.cmml">,</mo><msub id="S3.SS2.p2.5.m5.2.2.2.2.1" xref="S3.SS2.p2.5.m5.2.2.2.2.1.cmml"><mi id="S3.SS2.p2.5.m5.2.2.2.2.1.2" xref="S3.SS2.p2.5.m5.2.2.2.2.1.2.cmml">L</mi><mi id="S3.SS2.p2.5.m5.2.2.2.2.1.3" xref="S3.SS2.p2.5.m5.2.2.2.2.1.3.cmml">a</mi></msub></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.2b"><apply id="S3.SS2.p2.5.m5.2.3.cmml" xref="S3.SS2.p2.5.m5.2.3"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.2.3.1.cmml" xref="S3.SS2.p2.5.m5.2.3">superscript</csymbol><apply id="S3.SS2.p2.5.m5.2.3.2.cmml" xref="S3.SS2.p2.5.m5.2.3"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.2.3.2.1.cmml" xref="S3.SS2.p2.5.m5.2.3">subscript</csymbol><ci id="S3.SS2.p2.5.m5.2.3.2.2.cmml" xref="S3.SS2.p2.5.m5.2.3.2.2">𝑔</ci><ci id="S3.SS2.p2.5.m5.2.3.2.3.cmml" xref="S3.SS2.p2.5.m5.2.3.2.3">𝑡</ci></apply><list id="S3.SS2.p2.5.m5.2.2.2.3.cmml" xref="S3.SS2.p2.5.m5.2.2.2.2"><ci id="S3.SS2.p2.5.m5.1.1.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1.1.1">𝑎</ci><apply id="S3.SS2.p2.5.m5.2.2.2.2.1.cmml" xref="S3.SS2.p2.5.m5.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.2.2.2.2.1.1.cmml" xref="S3.SS2.p2.5.m5.2.2.2.2.1">subscript</csymbol><ci id="S3.SS2.p2.5.m5.2.2.2.2.1.2.cmml" xref="S3.SS2.p2.5.m5.2.2.2.2.1.2">𝐿</ci><ci id="S3.SS2.p2.5.m5.2.2.2.2.1.3.cmml" xref="S3.SS2.p2.5.m5.2.2.2.2.1.3">𝑎</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.2c">g_{t}^{a,L_{a}}</annotation></semantics></math> of the isolated encoder layer <math id="S3.SS2.p2.6.m6.1" class="ltx_Math" alttext="L_{a}" display="inline"><semantics id="S3.SS2.p2.6.m6.1a"><msub id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml"><mi id="S3.SS2.p2.6.m6.1.1.2" xref="S3.SS2.p2.6.m6.1.1.2.cmml">L</mi><mi id="S3.SS2.p2.6.m6.1.1.3" xref="S3.SS2.p2.6.m6.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><apply id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.1.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p2.6.m6.1.1.2.cmml" xref="S3.SS2.p2.6.m6.1.1.2">𝐿</ci><ci id="S3.SS2.p2.6.m6.1.1.3.cmml" xref="S3.SS2.p2.6.m6.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">L_{a}</annotation></semantics></math>, which helps the <math id="S3.SS2.p2.7.m7.1" class="ltx_Math" alttext="L_{a}" display="inline"><semantics id="S3.SS2.p2.7.m7.1a"><msub id="S3.SS2.p2.7.m7.1.1" xref="S3.SS2.p2.7.m7.1.1.cmml"><mi id="S3.SS2.p2.7.m7.1.1.2" xref="S3.SS2.p2.7.m7.1.1.2.cmml">L</mi><mi id="S3.SS2.p2.7.m7.1.1.3" xref="S3.SS2.p2.7.m7.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.1b"><apply id="S3.SS2.p2.7.m7.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.1.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p2.7.m7.1.1.2.cmml" xref="S3.SS2.p2.7.m7.1.1.2">𝐿</ci><ci id="S3.SS2.p2.7.m7.1.1.3.cmml" xref="S3.SS2.p2.7.m7.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.1c">L_{a}</annotation></semantics></math> layer in the small model imitate the block of layer <math id="S3.SS2.p2.8.m8.1" class="ltx_Math" alttext="L_{a}" display="inline"><semantics id="S3.SS2.p2.8.m8.1a"><msub id="S3.SS2.p2.8.m8.1.1" xref="S3.SS2.p2.8.m8.1.1.cmml"><mi id="S3.SS2.p2.8.m8.1.1.2" xref="S3.SS2.p2.8.m8.1.1.2.cmml">L</mi><mi id="S3.SS2.p2.8.m8.1.1.3" xref="S3.SS2.p2.8.m8.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m8.1b"><apply id="S3.SS2.p2.8.m8.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.1.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.p2.8.m8.1.1.2.cmml" xref="S3.SS2.p2.8.m8.1.1.2">𝐿</ci><ci id="S3.SS2.p2.8.m8.1.1.3.cmml" xref="S3.SS2.p2.8.m8.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m8.1c">L_{a}</annotation></semantics></math> to <math id="S3.SS2.p2.9.m9.1" class="ltx_Math" alttext="L_{b}" display="inline"><semantics id="S3.SS2.p2.9.m9.1a"><msub id="S3.SS2.p2.9.m9.1.1" xref="S3.SS2.p2.9.m9.1.1.cmml"><mi id="S3.SS2.p2.9.m9.1.1.2" xref="S3.SS2.p2.9.m9.1.1.2.cmml">L</mi><mi id="S3.SS2.p2.9.m9.1.1.3" xref="S3.SS2.p2.9.m9.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m9.1b"><apply id="S3.SS2.p2.9.m9.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m9.1.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.p2.9.m9.1.1.2.cmml" xref="S3.SS2.p2.9.m9.1.1.2">𝐿</ci><ci id="S3.SS2.p2.9.m9.1.1.3.cmml" xref="S3.SS2.p2.9.m9.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m9.1c">L_{b}</annotation></semantics></math> in the medium model.
Similarly, we use the averaged update from the large model as the gradient momentum for the layer <math id="S3.SS2.p2.10.m10.1" class="ltx_Math" alttext="L_{b}" display="inline"><semantics id="S3.SS2.p2.10.m10.1a"><msub id="S3.SS2.p2.10.m10.1.1" xref="S3.SS2.p2.10.m10.1.1.cmml"><mi id="S3.SS2.p2.10.m10.1.1.2" xref="S3.SS2.p2.10.m10.1.1.2.cmml">L</mi><mi id="S3.SS2.p2.10.m10.1.1.3" xref="S3.SS2.p2.10.m10.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.m10.1b"><apply id="S3.SS2.p2.10.m10.1.1.cmml" xref="S3.SS2.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.10.m10.1.1.1.cmml" xref="S3.SS2.p2.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.p2.10.m10.1.1.2.cmml" xref="S3.SS2.p2.10.m10.1.1.2">𝐿</ci><ci id="S3.SS2.p2.10.m10.1.1.3.cmml" xref="S3.SS2.p2.10.m10.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m10.1c">L_{b}</annotation></semantics></math> in the medium model.
In general, the distillation transfers knowledge from a larger model to a smaller model without the limitation on the number of model types.
The gradient momentum is initialized as zero and applied with a momentum factor <math id="S3.SS2.p2.11.m11.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S3.SS2.p2.11.m11.1a"><mi id="S3.SS2.p2.11.m11.1.1" xref="S3.SS2.p2.11.m11.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.11.m11.1b"><ci id="S3.SS2.p2.11.m11.1.1.cmml" xref="S3.SS2.p2.11.m11.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.11.m11.1c">\beta</annotation></semantics></math>, which is an important hyper-parameter to tune the strength of the distillation.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Experiments</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we evaluate <span id="S4.p1.1.1" class="ltx_text ltx_font_italic">InclusiveFL</span> for federated learning over heterogeneous devices on IID and non-IID datasets and compare with both naive baselines and HeteroFL <cite class="ltx_cite ltx_citemacro_citep">(Diao et al<span class="ltx_text">.</span>, <a href="#bib.bib8" title="" class="ltx_ref">2021</a>)</cite>.
To simulate the heterogeneous device scenario, we set up three types of clients: weak clients, medium clients and powerful clients.
Accordingly, they can store and compute over 4-layer, 8-layer and 12-layer transformer models, respectively.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p"><span id="S4.p2.1.1" class="ltx_text ltx_font_bold">Datasets.</span>
Our experiments are conducted on the text classification task in the GLUE benchmark and token classification task (NER) on three medical corpora.
GLUE benchmark <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a href="#bib.bib39" title="" class="ltx_ref">2018b</a>)</cite> is a collection of multiple natural language understanding tasks, including
MNLI <cite class="ltx_cite ltx_citemacro_citep">(Williams et al<span class="ltx_text">.</span>, <a href="#bib.bib45" title="" class="ltx_ref">2018</a>)</cite> (inference),
SST-2 <cite class="ltx_cite ltx_citemacro_citep">(Socher et al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2013</a>)</cite> (sentimental analysis),
MRPC <cite class="ltx_cite ltx_citemacro_citep">(Dolan and Brockett, <a href="#bib.bib10" title="" class="ltx_ref">2005</a>)</cite> (paraphrase detection),
CoLA <cite class="ltx_cite ltx_citemacro_citep">(Warstadt et al<span class="ltx_text">.</span>, <a href="#bib.bib43" title="" class="ltx_ref">2019</a>)</cite> (linguistic acceptability),
QNLI <cite class="ltx_cite ltx_citemacro_citep">(Rajpurkar et al<span class="ltx_text">.</span>, <a href="#bib.bib31" title="" class="ltx_ref">2018</a>)</cite> (inference), QQP<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a target="_blank" href="https://quoradata.quora.com/First-Quora-Dataset-Release-Question-Pairs" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://quoradata.quora.com/First-Quora-Dataset-Release-Question-Pairs</a></span></span></span> (question-answering),
RTE <span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><a target="_blank" href="https://huggingface.co/datasets/glue/viewer/rte/train" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://huggingface.co/datasets/glue/viewer/rte/train</a></span></span></span> (inference),
and STSB <cite class="ltx_cite ltx_citemacro_citep">(Cera et al<span class="ltx_text">.</span>, <a href="#bib.bib5" title="" class="ltx_ref">2017</a>)</cite> (textual similarity).
The generality makes the GLUE dataset a standard benchmark to evaluate NLU models.</p>
</div>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.1" class="ltx_p">Three medical datasets includes SMM4H <cite class="ltx_cite ltx_citemacro_citep">(Weissenbacher et al<span class="ltx_text">.</span>, <a href="#bib.bib44" title="" class="ltx_ref">2019</a>)</cite>, CADEC <cite class="ltx_cite ltx_citemacro_citep">(Karimi et al<span class="ltx_text">.</span>, <a href="#bib.bib18" title="" class="ltx_ref">2015</a>)</cite> and ADE <cite class="ltx_cite ltx_citemacro_citep">(Gurulingappa et al<span class="ltx_text">.</span>, <a href="#bib.bib13" title="" class="ltx_ref">2012</a>)</cite>, which are widely used to evaluate NER tasks.
The statistics of the medical datasets are shown in Table <a href="#S4.T1" title="Table 1 ‣ 4. Experiments ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 1. </span>Statistics of the medical NER datasets.</figcaption>
<table id="S4.T1.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T1.1.2" class="ltx_tr">
<td id="S4.T1.1.2.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt"><span id="S4.T1.1.2.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Dataset</span></td>
<td id="S4.T1.1.2.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt"><span id="S4.T1.1.2.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;"># Sentences</span></td>
<td id="S4.T1.1.2.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt"><span id="S4.T1.1.2.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Entity Types</span></td>
<td id="S4.T1.1.2.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_tt"><span id="S4.T1.1.2.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;"># Entity</span></td>
</tr>
<tr id="S4.T1.1.3" class="ltx_tr">
<td id="S4.T1.1.3.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T1.1.3.1.1" class="ltx_text" style="font-size:90%;">SMM4H</span></td>
<td id="S4.T1.1.3.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T1.1.3.2.1" class="ltx_text" style="font-size:90%;">3,824</span></td>
<td id="S4.T1.1.3.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T1.1.3.3.1" class="ltx_text" style="font-size:90%;">ADE (1,707)</span></td>
<td id="S4.T1.1.3.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t"><span id="S4.T1.1.3.4.1" class="ltx_text" style="font-size:90%;">1,707</span></td>
</tr>
<tr id="S4.T1.1.4" class="ltx_tr">
<td id="S4.T1.1.4.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T1.1.4.1.1" class="ltx_text" style="font-size:90%;">ADE</span></td>
<td id="S4.T1.1.4.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T1.1.4.2.1" class="ltx_text" style="font-size:90%;">4,483</span></td>
<td id="S4.T1.1.4.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">
<table id="S4.T1.1.4.3.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T1.1.4.3.1.1" class="ltx_tr">
<td id="S4.T1.1.4.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left"><span id="S4.T1.1.4.3.1.1.1.1" class="ltx_text" style="font-size:90%;">ADE (5,678), Drug (5,076),</span></td>
</tr>
<tr id="S4.T1.1.4.3.1.2" class="ltx_tr">
<td id="S4.T1.1.4.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left"><span id="S4.T1.1.4.3.1.2.1.1" class="ltx_text" style="font-size:90%;">Dosage (222)</span></td>
</tr>
</table>
</td>
<td id="S4.T1.1.4.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t"><span id="S4.T1.1.4.4.1" class="ltx_text" style="font-size:90%;">10,976</span></td>
</tr>
<tr id="S4.T1.1.1" class="ltx_tr">
<td id="S4.T1.1.1.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t"><math id="S4.T1.1.1.1.m1.1" class="ltx_Math" alttext="{\rm CADEC}" display="inline"><semantics id="S4.T1.1.1.1.m1.1a"><mi mathsize="90%" id="S4.T1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.m1.1.1.cmml">CADEC</mi><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.m1.1b"><ci id="S4.T1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1">CADEC</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">{\rm CADEC}</annotation></semantics></math></td>
<td id="S4.T1.1.1.2" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t"><span id="S4.T1.1.1.2.1" class="ltx_text" style="font-size:90%;">7,683</span></td>
<td id="S4.T1.1.1.3" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t">
<table id="S4.T1.1.1.3.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T1.1.1.3.1.1" class="ltx_tr">
<td id="S4.T1.1.1.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left"><span id="S4.T1.1.1.3.1.1.1.1" class="ltx_text" style="font-size:90%;">ADE (5,937),
Drug(1,796),</span></td>
</tr>
<tr id="S4.T1.1.1.3.1.2" class="ltx_tr">
<td id="S4.T1.1.1.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left"><span id="S4.T1.1.1.3.1.2.1.1" class="ltx_text" style="font-size:90%;">Disease(282), Finding(425),</span></td>
</tr>
<tr id="S4.T1.1.1.3.1.3" class="ltx_tr">
<td id="S4.T1.1.1.3.1.3.1" class="ltx_td ltx_nopad_r ltx_align_left"><span id="S4.T1.1.1.3.1.3.1.1" class="ltx_text" style="font-size:90%;">Symptom(268)</span></td>
</tr>
</table>
</td>
<td id="S4.T1.1.1.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_t"><span id="S4.T1.1.1.4.1" class="ltx_text" style="font-size:90%;">8,535</span></td>
</tr>
</table>
</figure>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T2.2.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>. </span><span id="S4.T2.3.2" class="ltx_text" style="font-size:90%;">Performance comparison of federated learning methods on the GLUE benchmark for text classification tasks. Performance is evaluated on the final large model in a global inference scenario.
Bold faces indicate the best method for inclusive FL training with heterogeneous devices.
</span></figcaption>
<table id="S4.T2.4" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T2.4.1" class="ltx_tr">
<td id="S4.T2.4.1.1" class="ltx_td ltx_border_r ltx_border_tt"></td>
<td id="S4.T2.4.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">Inclusive?</td>
<td id="S4.T2.4.1.3" class="ltx_td ltx_align_center ltx_border_tt">COLA</td>
<td id="S4.T2.4.1.4" class="ltx_td ltx_align_center ltx_border_tt">MNLI</td>
<td id="S4.T2.4.1.5" class="ltx_td ltx_align_center ltx_border_tt">MRPC</td>
<td id="S4.T2.4.1.6" class="ltx_td ltx_align_center ltx_border_tt">QNLI</td>
<td id="S4.T2.4.1.7" class="ltx_td ltx_align_center ltx_border_tt">QQP</td>
<td id="S4.T2.4.1.8" class="ltx_td ltx_align_center ltx_border_tt">RTE</td>
<td id="S4.T2.4.1.9" class="ltx_td ltx_align_center ltx_border_tt">SST2</td>
<td id="S4.T2.4.1.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">STSB</td>
<td id="S4.T2.4.1.11" class="ltx_td ltx_align_center ltx_border_tt">Avg.</td>
</tr>
<tr id="S4.T2.4.2" class="ltx_tr">
<td id="S4.T2.4.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">All-Large</td>
<td id="S4.T2.4.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">N/A</td>
<td id="S4.T2.4.2.3" class="ltx_td ltx_align_center ltx_border_t">63.03</td>
<td id="S4.T2.4.2.4" class="ltx_td ltx_align_center ltx_border_t">86.48</td>
<td id="S4.T2.4.2.5" class="ltx_td ltx_align_center ltx_border_t">91.50</td>
<td id="S4.T2.4.2.6" class="ltx_td ltx_align_center ltx_border_t">92.09</td>
<td id="S4.T2.4.2.7" class="ltx_td ltx_align_center ltx_border_t">91.49</td>
<td id="S4.T2.4.2.8" class="ltx_td ltx_align_center ltx_border_t">76.12</td>
<td id="S4.T2.4.2.9" class="ltx_td ltx_align_center ltx_border_t">94.43</td>
<td id="S4.T2.4.2.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">90.60</td>
<td id="S4.T2.4.2.11" class="ltx_td ltx_align_center ltx_border_t">85.72</td>
</tr>
<tr id="S4.T2.4.3" class="ltx_tr">
<td id="S4.T2.4.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">ExclusiveFL</td>
<td id="S4.T2.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">No</td>
<td id="S4.T2.4.3.3" class="ltx_td ltx_align_center ltx_border_t">37.77</td>
<td id="S4.T2.4.3.4" class="ltx_td ltx_align_center ltx_border_t">85.98</td>
<td id="S4.T2.4.3.5" class="ltx_td ltx_align_center ltx_border_t">89.87</td>
<td id="S4.T2.4.3.6" class="ltx_td ltx_align_center ltx_border_t">91.24</td>
<td id="S4.T2.4.3.7" class="ltx_td ltx_align_center ltx_border_t">89.47</td>
<td id="S4.T2.4.3.8" class="ltx_td ltx_align_center ltx_border_t">62.17</td>
<td id="S4.T2.4.3.9" class="ltx_td ltx_align_center ltx_border_t">94.06</td>
<td id="S4.T2.4.3.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">89.26</td>
<td id="S4.T2.4.3.11" class="ltx_td ltx_align_center ltx_border_t">79.98</td>
</tr>
<tr id="S4.T2.4.4" class="ltx_tr">
<td id="S4.T2.4.4.1" class="ltx_td ltx_align_center ltx_border_r">All-Small</td>
<td id="S4.T2.4.4.2" class="ltx_td ltx_align_center ltx_border_r">Yes</td>
<td id="S4.T2.4.4.3" class="ltx_td ltx_align_center">34.91</td>
<td id="S4.T2.4.4.4" class="ltx_td ltx_align_center">78.83</td>
<td id="S4.T2.4.4.5" class="ltx_td ltx_align_center">82.50</td>
<td id="S4.T2.4.4.6" class="ltx_td ltx_align_center">85.93</td>
<td id="S4.T2.4.4.7" class="ltx_td ltx_align_center">79.37</td>
<td id="S4.T2.4.4.8" class="ltx_td ltx_align_center">58.94</td>
<td id="S4.T2.4.4.9" class="ltx_td ltx_align_center">90.14</td>
<td id="S4.T2.4.4.10" class="ltx_td ltx_align_center ltx_border_r">83.68</td>
<td id="S4.T2.4.4.11" class="ltx_td ltx_align_center">74.29</td>
</tr>
<tr id="S4.T2.4.5" class="ltx_tr">
<td id="S4.T2.4.5.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">HeteroFL</td>
<td id="S4.T2.4.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Yes</td>
<td id="S4.T2.4.5.3" class="ltx_td ltx_align_center ltx_border_t">8.15</td>
<td id="S4.T2.4.5.4" class="ltx_td ltx_align_center ltx_border_t">31.83</td>
<td id="S4.T2.4.5.5" class="ltx_td ltx_align_center ltx_border_t">81.51</td>
<td id="S4.T2.4.5.6" class="ltx_td ltx_align_center ltx_border_t">62.70</td>
<td id="S4.T2.4.5.7" class="ltx_td ltx_align_center ltx_border_t">73.79</td>
<td id="S4.T2.4.5.8" class="ltx_td ltx_align_center ltx_border_t">52.71</td>
<td id="S4.T2.4.5.9" class="ltx_td ltx_align_center ltx_border_t">84.98</td>
<td id="S4.T2.4.5.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">30.54</td>
<td id="S4.T2.4.5.11" class="ltx_td ltx_align_center ltx_border_t">53.28</td>
</tr>
<tr id="S4.T2.4.6" class="ltx_tr">
<td id="S4.T2.4.6.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">InclusiveFL</td>
<td id="S4.T2.4.6.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">Yes</td>
<td id="S4.T2.4.6.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T2.4.6.3.1" class="ltx_text ltx_font_bold">54.85</span></td>
<td id="S4.T2.4.6.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T2.4.6.4.1" class="ltx_text ltx_font_bold">86.36</span></td>
<td id="S4.T2.4.6.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T2.4.6.5.1" class="ltx_text ltx_font_bold">91.42</span></td>
<td id="S4.T2.4.6.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T2.4.6.6.1" class="ltx_text ltx_font_bold">91.76</span></td>
<td id="S4.T2.4.6.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T2.4.6.7.1" class="ltx_text ltx_font_bold">90.55</span></td>
<td id="S4.T2.4.6.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T2.4.6.8.1" class="ltx_text ltx_font_bold">66.14</span></td>
<td id="S4.T2.4.6.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T2.4.6.9.1" class="ltx_text ltx_font_bold">94.17</span></td>
<td id="S4.T2.4.6.10" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t"><span id="S4.T2.4.6.10.1" class="ltx_text ltx_font_bold">89.94</span></td>
<td id="S4.T2.4.6.11" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T2.4.6.11.1" class="ltx_text ltx_font_bold">83.15</span></td>
</tr>
</table>
</figure>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S4.T3.2.1.1" class="ltx_text" style="font-size:90%;">Table 3</span>. </span><span id="S4.T3.3.2" class="ltx_text" style="font-size:90%;">Performance comparison of federated learning methods on medical datasets for named entity recognition.
Performances are evaluated for each named entity on each local model (SMM4H with 4-layer model, ADE with 9-layer model and CADEC with 12-layer model) in the local inference scenario.
Best method for heterogeneous training is shown in bold face.
</span></figcaption>
<table id="S4.T3.4" class="ltx_tabular ltx_align_middle">
<tr id="S4.T3.4.1" class="ltx_tr">
<td id="S4.T3.4.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" rowspan="2"><span id="S4.T3.4.1.1.1" class="ltx_text">Methods</span></td>
<td id="S4.T3.4.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" rowspan="2"><span id="S4.T3.4.1.2.1" class="ltx_text">Inclusive?</span></td>
<td id="S4.T3.4.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">SMM4H</td>
<td id="S4.T3.4.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="3">ADE</td>
<td id="S4.T3.4.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="5">CADEC</td>
<td id="S4.T3.4.1.6" class="ltx_td ltx_align_center ltx_border_tt" rowspan="2"><span id="S4.T3.4.1.6.1" class="ltx_text">Avg.</span></td>
</tr>
<tr id="S4.T3.4.2" class="ltx_tr">
<td id="S4.T3.4.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">ADE</td>
<td id="S4.T3.4.2.2" class="ltx_td ltx_align_center ltx_border_t">Drug</td>
<td id="S4.T3.4.2.3" class="ltx_td ltx_align_center ltx_border_t">ADE</td>
<td id="S4.T3.4.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Dose</td>
<td id="S4.T3.4.2.5" class="ltx_td ltx_align_center ltx_border_t">ADE</td>
<td id="S4.T3.4.2.6" class="ltx_td ltx_align_center ltx_border_t">Symptom</td>
<td id="S4.T3.4.2.7" class="ltx_td ltx_align_center ltx_border_t">Drug</td>
<td id="S4.T3.4.2.8" class="ltx_td ltx_align_center ltx_border_t">Disease</td>
<td id="S4.T3.4.2.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Finding</td>
</tr>
<tr id="S4.T3.4.3" class="ltx_tr">
<td id="S4.T3.4.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">AllLarge</td>
<td id="S4.T3.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">N/A</td>
<td id="S4.T3.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">55.08</td>
<td id="S4.T3.4.3.4" class="ltx_td ltx_align_center ltx_border_t">95.21</td>
<td id="S4.T3.4.3.5" class="ltx_td ltx_align_center ltx_border_t">80.91</td>
<td id="S4.T3.4.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">18.97</td>
<td id="S4.T3.4.3.7" class="ltx_td ltx_align_center ltx_border_t">71.23</td>
<td id="S4.T3.4.3.8" class="ltx_td ltx_align_center ltx_border_t">43.37</td>
<td id="S4.T3.4.3.9" class="ltx_td ltx_align_center ltx_border_t">90.43</td>
<td id="S4.T3.4.3.10" class="ltx_td ltx_align_center ltx_border_t">33.55</td>
<td id="S4.T3.4.3.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">29.85</td>
<td id="S4.T3.4.3.12" class="ltx_td ltx_align_center ltx_border_t">57.62</td>
</tr>
<tr id="S4.T3.4.4" class="ltx_tr">
<td id="S4.T3.4.4.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Local</td>
<td id="S4.T3.4.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">No</td>
<td id="S4.T3.4.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">46.77</td>
<td id="S4.T3.4.4.4" class="ltx_td ltx_align_center ltx_border_t">95.12</td>
<td id="S4.T3.4.4.5" class="ltx_td ltx_align_center ltx_border_t">80.14</td>
<td id="S4.T3.4.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">11.25</td>
<td id="S4.T3.4.4.7" class="ltx_td ltx_align_center ltx_border_t">44.15</td>
<td id="S4.T3.4.4.8" class="ltx_td ltx_align_center ltx_border_t">19.90</td>
<td id="S4.T3.4.4.9" class="ltx_td ltx_align_center ltx_border_t">53.53</td>
<td id="S4.T3.4.4.10" class="ltx_td ltx_align_center ltx_border_t">20.58</td>
<td id="S4.T3.4.4.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">16.53</td>
<td id="S4.T3.4.4.12" class="ltx_td ltx_align_center ltx_border_t">43.11</td>
</tr>
<tr id="S4.T3.4.5" class="ltx_tr">
<td id="S4.T3.4.5.1" class="ltx_td ltx_align_center ltx_border_r">AllSmall</td>
<td id="S4.T3.4.5.2" class="ltx_td ltx_align_center ltx_border_r">Yes</td>
<td id="S4.T3.4.5.3" class="ltx_td ltx_align_center ltx_border_r">49.56</td>
<td id="S4.T3.4.5.4" class="ltx_td ltx_align_center">92.76</td>
<td id="S4.T3.4.5.5" class="ltx_td ltx_align_center">75.67</td>
<td id="S4.T3.4.5.6" class="ltx_td ltx_align_center ltx_border_r">13.51</td>
<td id="S4.T3.4.5.7" class="ltx_td ltx_align_center">64.82</td>
<td id="S4.T3.4.5.8" class="ltx_td ltx_align_center">26.71</td>
<td id="S4.T3.4.5.9" class="ltx_td ltx_align_center">87.91</td>
<td id="S4.T3.4.5.10" class="ltx_td ltx_align_center">21.07</td>
<td id="S4.T3.4.5.11" class="ltx_td ltx_align_center ltx_border_r">20.23</td>
<td id="S4.T3.4.5.12" class="ltx_td ltx_align_center">40.89</td>
</tr>
<tr id="S4.T3.4.6" class="ltx_tr">
<td id="S4.T3.4.6.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">HeteroFL</td>
<td id="S4.T3.4.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Yes</td>
<td id="S4.T3.4.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">27.94</td>
<td id="S4.T3.4.6.4" class="ltx_td ltx_align_center ltx_border_t">73.90</td>
<td id="S4.T3.4.6.5" class="ltx_td ltx_align_center ltx_border_t">37.57</td>
<td id="S4.T3.4.6.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">11.57</td>
<td id="S4.T3.4.6.7" class="ltx_td ltx_align_center ltx_border_t">59.90</td>
<td id="S4.T3.4.6.8" class="ltx_td ltx_align_center ltx_border_t">26.92</td>
<td id="S4.T3.4.6.9" class="ltx_td ltx_align_center ltx_border_t">84.58</td>
<td id="S4.T3.4.6.10" class="ltx_td ltx_align_center ltx_border_t">25.77</td>
<td id="S4.T3.4.6.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">19.88</td>
<td id="S4.T3.4.6.12" class="ltx_td ltx_align_center ltx_border_t">42.51</td>
</tr>
<tr id="S4.T3.4.7" class="ltx_tr">
<td id="S4.T3.4.7.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">InclusiveFL</td>
<td id="S4.T3.4.7.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">Yes</td>
<td id="S4.T3.4.7.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t"><span id="S4.T3.4.7.3.1" class="ltx_text ltx_font_bold">49.90</span></td>
<td id="S4.T3.4.7.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T3.4.7.4.1" class="ltx_text ltx_font_bold">95.49</span></td>
<td id="S4.T3.4.7.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T3.4.7.5.1" class="ltx_text ltx_font_bold">80.34</span></td>
<td id="S4.T3.4.7.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t"><span id="S4.T3.4.7.6.1" class="ltx_text ltx_font_bold">13.91</span></td>
<td id="S4.T3.4.7.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T3.4.7.7.1" class="ltx_text ltx_font_bold">71.10</span></td>
<td id="S4.T3.4.7.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T3.4.7.8.1" class="ltx_text ltx_font_bold">40.91</span></td>
<td id="S4.T3.4.7.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T3.4.7.9.1" class="ltx_text ltx_font_bold">90.21</span></td>
<td id="S4.T3.4.7.10" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T3.4.7.10.1" class="ltx_text ltx_font_bold">39.34</span></td>
<td id="S4.T3.4.7.11" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t"><span id="S4.T3.4.7.11.1" class="ltx_text ltx_font_bold">22.97</span></td>
<td id="S4.T3.4.7.12" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T3.4.7.12.1" class="ltx_text ltx_font_bold">56.02</span></td>
</tr>
</table>
</figure>
<div id="S4.p4" class="ltx_para">
<p id="S4.p4.1" class="ltx_p"><span id="S4.p4.1.1" class="ltx_text ltx_font_bold">Evaluation Protocols.</span>
For the evaluation on cross-device <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib27" title="" class="ltx_ref">2021</a>)</cite> federated learning with IID data, we randomly split the training dataset of each GLUE benchmark to 1000 clients and report the best performance of the evaluation dataset.
By default, we report the matched accuracy for MNLI, the Matthew’s correlation for CoLA, Pearson correlation for STSB, F1-score for MRPC and the accuracy metric for all other tasks.
Higher value indicates better performance.
To evaluate over non-IID data distribution, we take each medical corpus as the local dataset of one client (e.g. a hospital) and simulate the cross-silo <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib27" title="" class="ltx_ref">2021</a>)</cite> federated setting.
We set SMM4H as the local data for a weak client, ADE as the local data for a medium client and CADEC as the local data for the powerful client.
We validate the generality of this setting by rotating datasets and client types and draw similar observations.
For each client, we randomly take 80% of the local dataset as the training dataset and the rest as the evaluation dataset.
We use the seqeval framework<span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span><a target="_blank" href="https://github.com/chakki-works/seqeval" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/chakki-works/seqeval</a></span></span></span> to report the maximum averaged F1-score, precision, recall and accuracy on the evaluation dataset to indicate the overall performance or the performance over each type of entity for each client.
Results for the two settings are reported by averaging over 5 independent repeats.</p>
</div>
<div id="S4.p5" class="ltx_para">
<p id="S4.p5.1" class="ltx_p"><span id="S4.p5.1.1" class="ltx_text ltx_font_bold">Baselines.</span>
We compare our proposed <span id="S4.p5.1.2" class="ltx_text ltx_font_italic">InclusiveFL</span> solution with the following naive baselines:</p>
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.1" class="ltx_p"><span id="S4.I1.i1.p1.1.1" class="ltx_text ltx_font_italic">AllLarge</span>: an ideal baseline to indicate the performance upper bound of training over heterogeneous devices.
We remove the resource limitation on weak and medium clients and conduct federated training over all clients participant with a 12-layer RoBERTa model.</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p id="S4.I1.i2.p1.1" class="ltx_p"><span id="S4.I1.i2.p1.1.1" class="ltx_text ltx_font_italic">AllSmall</span>: a naive baseline to include all clients with heterogeneous devices and conduct training over the smallest model with 4 layers.</p>
</div>
</li>
<li id="S4.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i3.p1" class="ltx_para">
<p id="S4.I1.i3.p1.1" class="ltx_p"><span id="S4.I1.i3.p1.1.1" class="ltx_text ltx_font_italic">ExclusiveFL</span>: a naive baseline where weak and medium clients are dropped off in federated training due to the resource limitation on the largest model.</p>
</div>
</li>
<li id="S4.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i4.p1" class="ltx_para">
<p id="S4.I1.i4.p1.1" class="ltx_p"><span id="S4.I1.i4.p1.1.1" class="ltx_text ltx_font_italic">Local</span>: a naive baseline for cross-silo setting where each client trains the model with the size that fits their local resources.</p>
</div>
</li>
<li id="S4.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i5.p1" class="ltx_para">
<p id="S4.I1.i5.p1.1" class="ltx_p"><span id="S4.I1.i5.p1.1.1" class="ltx_text ltx_font_italic">HeteroFL</span> <cite class="ltx_cite ltx_citemacro_citep">(Diao et al<span class="ltx_text">.</span>, <a href="#bib.bib8" title="" class="ltx_ref">2021</a>)</cite>: the most related work for training across all clients over heterogeneous devices.
The number of parameters in smaller models are reduced in width by cropping each parameter matrix of the largest model into sub-matrix with various reduction radio.</p>
</div>
</li>
</ul>
</div>
<div id="S4.p6" class="ltx_para">
<p id="S4.p6.2" class="ltx_p"><span id="S4.p6.2.1" class="ltx_text ltx_font_bold">Hyper-Parameter Settings.</span>
For federated training over heterogeneous devices, we assign each client a client type with equal probability before training and fix it during training by default.
The effect of different ratios of device types is investigated in our hyper-parameter analysis.
For a fair comparison, we keep the number of parameters for each model type in <span id="S4.p6.2.2" class="ltx_text ltx_font_italic">HeteroFL</span> equal to 4-layer, 8-layer and 12-layer models in other baselines by reducing the hidden size from 768 to 456, 624 for weak and medium clients respectively.
For <span id="S4.p6.2.3" class="ltx_text ltx_font_italic">InclusiveFL</span>, we set the momentum factor <math id="S4.p6.1.m1.1" class="ltx_Math" alttext="\beta=0.2" display="inline"><semantics id="S4.p6.1.m1.1a"><mrow id="S4.p6.1.m1.1.1" xref="S4.p6.1.m1.1.1.cmml"><mi id="S4.p6.1.m1.1.1.2" xref="S4.p6.1.m1.1.1.2.cmml">β</mi><mo id="S4.p6.1.m1.1.1.1" xref="S4.p6.1.m1.1.1.1.cmml">=</mo><mn id="S4.p6.1.m1.1.1.3" xref="S4.p6.1.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p6.1.m1.1b"><apply id="S4.p6.1.m1.1.1.cmml" xref="S4.p6.1.m1.1.1"><eq id="S4.p6.1.m1.1.1.1.cmml" xref="S4.p6.1.m1.1.1.1"></eq><ci id="S4.p6.1.m1.1.1.2.cmml" xref="S4.p6.1.m1.1.1.2">𝛽</ci><cn type="float" id="S4.p6.1.m1.1.1.3.cmml" xref="S4.p6.1.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.1.m1.1c">\beta=0.2</annotation></semantics></math> for all GLUE benchmark and <math id="S4.p6.2.m2.1" class="ltx_Math" alttext="\beta=0.5" display="inline"><semantics id="S4.p6.2.m2.1a"><mrow id="S4.p6.2.m2.1.1" xref="S4.p6.2.m2.1.1.cmml"><mi id="S4.p6.2.m2.1.1.2" xref="S4.p6.2.m2.1.1.2.cmml">β</mi><mo id="S4.p6.2.m2.1.1.1" xref="S4.p6.2.m2.1.1.1.cmml">=</mo><mn id="S4.p6.2.m2.1.1.3" xref="S4.p6.2.m2.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p6.2.m2.1b"><apply id="S4.p6.2.m2.1.1.cmml" xref="S4.p6.2.m2.1.1"><eq id="S4.p6.2.m2.1.1.1.cmml" xref="S4.p6.2.m2.1.1.1"></eq><ci id="S4.p6.2.m2.1.1.2.cmml" xref="S4.p6.2.m2.1.1.2">𝛽</ci><cn type="float" id="S4.p6.2.m2.1.1.3.cmml" xref="S4.p6.2.m2.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.2.m2.1c">\beta=0.5</annotation></semantics></math> for medical NER datasets.</p>
</div>
<div id="S4.p7" class="ltx_para">
<p id="S4.p7.3" class="ltx_p">For GLUE dataset, we randomly sample a fraction of <math id="S4.p7.1.m1.1" class="ltx_Math" alttext="0.02" display="inline"><semantics id="S4.p7.1.m1.1a"><mn id="S4.p7.1.m1.1.1" xref="S4.p7.1.m1.1.1.cmml">0.02</mn><annotation-xml encoding="MathML-Content" id="S4.p7.1.m1.1b"><cn type="float" id="S4.p7.1.m1.1.1.cmml" xref="S4.p7.1.m1.1.1">0.02</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.1.m1.1c">0.02</annotation></semantics></math> clients in each round with <math id="S4.p7.2.m2.1" class="ltx_Math" alttext="R=1000" display="inline"><semantics id="S4.p7.2.m2.1a"><mrow id="S4.p7.2.m2.1.1" xref="S4.p7.2.m2.1.1.cmml"><mi id="S4.p7.2.m2.1.1.2" xref="S4.p7.2.m2.1.1.2.cmml">R</mi><mo id="S4.p7.2.m2.1.1.1" xref="S4.p7.2.m2.1.1.1.cmml">=</mo><mn id="S4.p7.2.m2.1.1.3" xref="S4.p7.2.m2.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p7.2.m2.1b"><apply id="S4.p7.2.m2.1.1.cmml" xref="S4.p7.2.m2.1.1"><eq id="S4.p7.2.m2.1.1.1.cmml" xref="S4.p7.2.m2.1.1.1"></eq><ci id="S4.p7.2.m2.1.1.2.cmml" xref="S4.p7.2.m2.1.1.2">𝑅</ci><cn type="integer" id="S4.p7.2.m2.1.1.3.cmml" xref="S4.p7.2.m2.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.2.m2.1c">R=1000</annotation></semantics></math>.
For NER datasets, we conduct 5 local steps with batch size 64 in each communication round with <math id="S4.p7.3.m3.1" class="ltx_Math" alttext="R=100" display="inline"><semantics id="S4.p7.3.m3.1a"><mrow id="S4.p7.3.m3.1.1" xref="S4.p7.3.m3.1.1.cmml"><mi id="S4.p7.3.m3.1.1.2" xref="S4.p7.3.m3.1.1.2.cmml">R</mi><mo id="S4.p7.3.m3.1.1.1" xref="S4.p7.3.m3.1.1.1.cmml">=</mo><mn id="S4.p7.3.m3.1.1.3" xref="S4.p7.3.m3.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p7.3.m3.1b"><apply id="S4.p7.3.m3.1.1.cmml" xref="S4.p7.3.m3.1.1"><eq id="S4.p7.3.m3.1.1.1.cmml" xref="S4.p7.3.m3.1.1.1"></eq><ci id="S4.p7.3.m3.1.1.2.cmml" xref="S4.p7.3.m3.1.1.2">𝑅</ci><cn type="integer" id="S4.p7.3.m3.1.1.3.cmml" xref="S4.p7.3.m3.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.3.m3.1c">R=100</annotation></semantics></math>.
We set the same learning rate for each type of the model over all baselines.
We use FedAdam <cite class="ltx_cite ltx_citemacro_citep">(Reddi et al<span class="ltx_text">.</span>, <a href="#bib.bib32" title="" class="ltx_ref">2020</a>)</cite> as the global aggregation protocol over homogeneous models for all baselines.</p>
</div>
<figure id="S4.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2202.08036/assets/x3.png" id="S4.F3.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="332" height="213" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S4.F3.sf1.3.2" class="ltx_text" style="font-size:90%;">F1-score (MRPC).</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2202.08036/assets/x4.png" id="S4.F3.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="332" height="213" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S4.F3.sf2.3.2" class="ltx_text" style="font-size:90%;">Training loss (MRPC).</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F3.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2202.08036/assets/x5.png" id="S4.F3.sf3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="332" height="213" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="S4.F3.sf3.3.2" class="ltx_text" style="font-size:90%;">Accuracy (RTE).</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F3.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2202.08036/assets/x6.png" id="S4.F3.sf4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="332" height="213" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf4.2.1.1" class="ltx_text" style="font-size:90%;">(d)</span> </span><span id="S4.F3.sf4.3.2" class="ltx_text" style="font-size:90%;">Training loss (RTE).</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F3.sf5" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2202.08036/assets/x7.png" id="S4.F3.sf5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="332" height="213" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf5.2.1.1" class="ltx_text" style="font-size:90%;">(e)</span> </span><span id="S4.F3.sf5.3.2" class="ltx_text" style="font-size:90%;">Training loss (CADEC).</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F3.sf6" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2202.08036/assets/x8.png" id="S4.F3.sf6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="332" height="213" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf6.2.1.1" class="ltx_text" style="font-size:90%;">(f)</span> </span><span id="S4.F3.sf6.3.2" class="ltx_text" style="font-size:90%;">Overall F1-score (CADEC).</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F3.sf7" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2202.08036/assets/x9.png" id="S4.F3.sf7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="332" height="213" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf7.2.1.1" class="ltx_text" style="font-size:90%;">(g)</span> </span><span id="S4.F3.sf7.3.2" class="ltx_text" style="font-size:90%;">Overall F1-score (ADE).</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F3.sf8" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2202.08036/assets/x10.png" id="S4.F3.sf8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="332" height="213" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf8.2.1.1" class="ltx_text" style="font-size:90%;">(h)</span> </span><span id="S4.F3.sf8.3.2" class="ltx_text" style="font-size:90%;">Overall F1-score (SMM4H).</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>. </span><span id="S4.F3.3.2" class="ltx_text" style="font-size:90%;">Federated training convergence and best performance. Error band shows the standard error of 5 independent repeats.</span></figcaption>
</figure>
<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T4.2.1.1" class="ltx_text" style="font-size:90%;">Table 4</span>. </span><span id="S4.T4.3.2" class="ltx_text" style="font-size:90%;">Averaged number of rounds for achieving the best performance in Table <a href="#S4.T2" title="Table 2 ‣ 4. Experiments ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</span></figcaption>
<table id="S4.T4.4" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T4.4.1" class="ltx_tr">
<td id="S4.T4.4.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">Methods</td>
<td id="S4.T4.4.1.2" class="ltx_td ltx_align_center ltx_border_tt">CoLA</td>
<td id="S4.T4.4.1.3" class="ltx_td ltx_align_center ltx_border_tt">MNLI</td>
<td id="S4.T4.4.1.4" class="ltx_td ltx_align_center ltx_border_tt">MRPC</td>
<td id="S4.T4.4.1.5" class="ltx_td ltx_align_center ltx_border_tt">QNLI</td>
<td id="S4.T4.4.1.6" class="ltx_td ltx_align_center ltx_border_tt">QQP</td>
<td id="S4.T4.4.1.7" class="ltx_td ltx_align_center ltx_border_tt">RTE</td>
<td id="S4.T4.4.1.8" class="ltx_td ltx_align_center ltx_border_tt">SST2</td>
<td id="S4.T4.4.1.9" class="ltx_td ltx_align_center ltx_border_tt">STSB</td>
<td id="S4.T4.4.1.10" class="ltx_td ltx_align_center ltx_border_tt">NER</td>
</tr>
<tr id="S4.T4.4.2" class="ltx_tr">
<td id="S4.T4.4.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">InclusiveFL-w/o MD</td>
<td id="S4.T4.4.2.2" class="ltx_td ltx_align_center ltx_border_t">630</td>
<td id="S4.T4.4.2.3" class="ltx_td ltx_align_center ltx_border_t">665</td>
<td id="S4.T4.4.2.4" class="ltx_td ltx_align_center ltx_border_t">616</td>
<td id="S4.T4.4.2.5" class="ltx_td ltx_align_center ltx_border_t">600</td>
<td id="S4.T4.4.2.6" class="ltx_td ltx_align_center ltx_border_t">850</td>
<td id="S4.T4.4.2.7" class="ltx_td ltx_align_center ltx_border_t">620</td>
<td id="S4.T4.4.2.8" class="ltx_td ltx_align_center ltx_border_t">810</td>
<td id="S4.T4.4.2.9" class="ltx_td ltx_align_center ltx_border_t">870</td>
<td id="S4.T4.4.2.10" class="ltx_td ltx_align_center ltx_border_t">90</td>
</tr>
<tr id="S4.T4.4.3" class="ltx_tr">
<td id="S4.T4.4.3.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">InclusiveFL</td>
<td id="S4.T4.4.3.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T4.4.3.2.1" class="ltx_text ltx_font_bold">580</span></td>
<td id="S4.T4.4.3.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T4.4.3.3.1" class="ltx_text ltx_font_bold">570</span></td>
<td id="S4.T4.4.3.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T4.4.3.4.1" class="ltx_text ltx_font_bold">515</span></td>
<td id="S4.T4.4.3.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T4.4.3.5.1" class="ltx_text ltx_font_bold">585</span></td>
<td id="S4.T4.4.3.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T4.4.3.6.1" class="ltx_text ltx_font_bold">740</span></td>
<td id="S4.T4.4.3.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T4.4.3.7.1" class="ltx_text ltx_font_bold">510</span></td>
<td id="S4.T4.4.3.8" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T4.4.3.8.1" class="ltx_text ltx_font_bold">520</span></td>
<td id="S4.T4.4.3.9" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T4.4.3.9.1" class="ltx_text ltx_font_bold">805</span></td>
<td id="S4.T4.4.3.10" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T4.4.3.10.1" class="ltx_text ltx_font_bold">75</span></td>
</tr>
</table>
</figure>
<figure id="S4.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F4.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2202.08036/assets/x11.png" id="S4.F4.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="332" height="228" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S4.F4.sf1.3.2" class="ltx_text" style="font-size:90%;">Averaged best F1-score (MRPC).</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F4.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2202.08036/assets/x12.png" id="S4.F4.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="332" height="221" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S4.F4.sf2.3.2" class="ltx_text" style="font-size:90%;">Averaged rounds (MRPC).</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F4.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2202.08036/assets/x13.png" id="S4.F4.sf3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="332" height="228" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="S4.F4.sf3.3.2" class="ltx_text" style="font-size:90%;">Averaged best accuracy (RTE).</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F4.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2202.08036/assets/x14.png" id="S4.F4.sf4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="332" height="221" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.sf4.2.1.1" class="ltx_text" style="font-size:90%;">(d)</span> </span><span id="S4.F4.sf4.3.2" class="ltx_text" style="font-size:90%;">Averaged rounds (RTE).</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.2.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>. </span><span id="S4.F4.3.2" class="ltx_text" style="font-size:90%;">Local inference performance in cross-device federated learning.</span></figcaption>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Performance Evaluation</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">We evaluate the effectiveness of proposed methods by comparing the averaged best performance that each method can achieve after convergence within 1,000 training rounds.
Then we evaluate the efficiency and analyze the reason for improvement by showing the convergence curve and the average rounds required to achieve the best performance.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p"><span id="S4.SS1.p2.1.1" class="ltx_text ltx_font_bold">Effectiveness.</span>
Results of IID setting on GLUE datasets and results of non-IID setting on medical NER datasets are shown in Table <a href="#S4.T2" title="Table 2 ‣ 4. Experiments ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> and <a href="#S4.T3" title="Table 3 ‣ 4. Experiments ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> respectively.
We observe that for all datasets, <span id="S4.SS1.p2.1.2" class="ltx_text ltx_font_italic">AllLarge</span> achieves the overall best performance, which indicates that training a large global model with all clients’ data can achieve the optimal performance.
However, it is impractical for training participants with less resources to train large models locally.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p">For all other approaches that can be implemented across heterogeneous devices, our proposed approach <span id="S4.SS1.p3.1.1" class="ltx_text ltx_font_italic">InclusiveFL</span> achieves the best performance.
It is reasonable because involving large models (<span id="S4.SS1.p3.1.2" class="ltx_text ltx_font_italic">InclusiveFL</span>) is better than only utilizing small models (<span id="S4.SS1.p3.1.3" class="ltx_text ltx_font_italic">AllSmall</span>) and training over all data (<span id="S4.SS1.p3.1.4" class="ltx_text ltx_font_italic">InclusiveFL</span>) is better than only training over partial data (<span id="S4.SS1.p3.1.5" class="ltx_text ltx_font_italic">ExclusiveFL</span> / <span id="S4.SS1.p3.1.6" class="ltx_text ltx_font_italic">Local</span>).
This observation also validates the effectiveness of our proposed momentum distillation.</p>
</div>
<div id="S4.SS1.p4" class="ltx_para">
<p id="S4.SS1.p4.1" class="ltx_p">We find that the most related work <span id="S4.SS1.p4.1.1" class="ltx_text ltx_font_italic">HeteroFL</span> <cite class="ltx_cite ltx_citemacro_citep">(Diao et al<span class="ltx_text">.</span>, <a href="#bib.bib8" title="" class="ltx_ref">2021</a>)</cite> performs worse than the naive baselines <span id="S4.SS1.p4.1.2" class="ltx_text ltx_font_italic">AllSmall</span> and <span id="S4.SS1.p4.1.3" class="ltx_text ltx_font_italic">ExclusiveFL</span> on all GLUE datasets.
And the averaged performance of <span id="S4.SS1.p4.1.4" class="ltx_text ltx_font_italic">HeteroFL</span> is also inferior to <span id="S4.SS1.p4.1.5" class="ltx_text ltx_font_italic">AllSmall</span> and <span id="S4.SS1.p4.1.6" class="ltx_text ltx_font_italic">ExclusiveFL</span> on medical datasets as shown in Table <a href="#S4.T3" title="Table 3 ‣ 4. Experiments ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.
This indicates that the method of sharing the top-left sub-matrix across heterogeneous devices in <span id="S4.SS1.p4.1.7" class="ltx_text ltx_font_italic">HeteroFL</span> may work for simple models with shallow layers (such as CNN in <cite class="ltx_cite ltx_citemacro_citep">(Diao et al<span class="ltx_text">.</span>, <a href="#bib.bib8" title="" class="ltx_ref">2021</a>)</cite>) but not for more complex deep models (such as 12-layer RoBERTa).
Furthermore, we observe in Fig. <a href="#S4.F3" title="Figure 3 ‣ 4. Experiments ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> that the starting performance of local models on weak and medium clients <span id="S4.SS1.p4.1.8" class="ltx_text ltx_font_italic">InclusiveFL</span> is better than <span id="S4.SS1.p4.1.9" class="ltx_text ltx_font_italic">HeteroFL</span>, which indicates that the small model in <span id="S4.SS1.p4.1.10" class="ltx_text ltx_font_italic">InclusiveFL</span> has a better parameter initialization than <span id="S4.SS1.p4.1.11" class="ltx_text ltx_font_italic">HeteroFL</span>.
Thus, one reason of the inferior utility is that cropping the network in <span id="S4.SS1.p4.1.12" class="ltx_text ltx_font_italic">HeteroFL</span> cannot fully utilized the pre-trained parameters while a layer-wise sharing in <span id="S4.SS1.p4.1.13" class="ltx_text ltx_font_italic">InclusiveFL</span> can better maintain the utility of a pre-trained model naturally.</p>
</div>
<div id="S4.SS1.p5" class="ltx_para">
<p id="S4.SS1.p5.1" class="ltx_p">In addition, we observe that <span id="S4.SS1.p5.1.1" class="ltx_text ltx_font_italic">ExclusiveFL</span> performs better than <span id="S4.SS1.p5.1.2" class="ltx_text ltx_font_italic">AllSmall</span> on GLUE benchmark and <span id="S4.SS1.p5.1.3" class="ltx_text ltx_font_italic">Local</span> performs worse than <span id="S4.SS1.p5.1.4" class="ltx_text ltx_font_italic">AllSmall</span>.
Thus, the performance gain from including more data and the gain from utilizing a large global model depends on the task and are hard to trade-off.
This observation enhances the contribution of <span id="S4.SS1.p5.1.5" class="ltx_text ltx_font_italic">InclusiveFL</span> for finding an effective way to aggregate over heterogeneous models and utilize performance gain from both inclusive data training and large models.</p>
</div>
<div id="S4.SS1.p6" class="ltx_para">
<p id="S4.SS1.p6.1" class="ltx_p"><span id="S4.SS1.p6.1.1" class="ltx_text ltx_font_bold">Efficiency.</span>
By observing the convergence curve in Fig. <a href="#S4.F3" title="Figure 3 ‣ 4. Experiments ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we find <span id="S4.SS1.p6.1.2" class="ltx_text ltx_font_italic">InclusiveFL</span> is approaching the performance of <span id="S4.SS1.p6.1.3" class="ltx_text ltx_font_italic">AllLarge</span> with a faster speed than <span id="S4.SS1.p6.1.4" class="ltx_text ltx_font_italic">InclusiveFL-w/o MD</span>, especially for the largest model with 12 layers.
For the IID setting as shown in Fig. <a href="#S4.F3.sf1" title="In Figure 3 ‣ 4. Experiments ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(a)</span></a>, <span id="S4.SS1.p6.1.5" class="ltx_text ltx_font_italic">InclusiveFL</span> achieves the F1-score of 89.43 within 400 rounds while <span id="S4.SS1.p6.1.6" class="ltx_text ltx_font_italic">InclusiveFL-w/o MD</span> requires 550 rounds.
For the non-IID setting in Fig. <a href="#S4.F3.sf6" title="In Figure 3 ‣ 4. Experiments ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(f)</span></a>, <span id="S4.SS1.p6.1.7" class="ltx_text ltx_font_italic">InclusiveFL</span> achieves the accuracy of 60.5 within 650 while <span id="S4.SS1.p6.1.8" class="ltx_text ltx_font_italic">InclusiveFL-w/o MD</span> requires 950 rounds.
For all datasets, we list the averaged number of rounds required by <span id="S4.SS1.p6.1.9" class="ltx_text ltx_font_italic">InclusiveFL</span> with or without momentum distillation to achieve the best performance in Table <a href="#S4.T2" title="Table 2 ‣ 4. Experiments ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> and <a href="#S4.T3" title="Table 3 ‣ 4. Experiments ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.
Thus, we can conclude that the proposed momentum distillation accelerates the performance of the largest global model by requiring less communication rounds.</p>
</div>
<div id="S4.SS1.p7" class="ltx_para">
<p id="S4.SS1.p7.1" class="ltx_p"><span id="S4.SS1.p7.1.1" class="ltx_text ltx_font_bold">Discussion on the local model inference.</span>
To further investigate the reason for performance improvement, we observe the evaluation results on the local model for each group of clients.
For the cross-silo setting, local model inference is essential because each client has her own top layers of classifier for fitting local targets.
For the medium model in Fig. <a href="#S4.F3.sf7" title="In Figure 3 ‣ 4. Experiments ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(g)</span></a> and small model in <a href="#S4.F3.sf8" title="In Figure 3 ‣ 4. Experiments ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(h)</span></a>, we find the effect of boosting convergence is less obvious but still exists and leads to a higher performance in Table <a href="#S4.T3" title="Table 3 ‣ 4. Experiments ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> when the local model (8-layer for ADE and 4-layer for SMM4H) converges.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/2202.08036/assets/x15.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="282" height="67" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.2.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>. </span><span id="S4.F5.3.2" class="ltx_text" style="font-size:90%;">No one left behind: Ablation study of ignoring every single party for GLUE benchmark and medical NER datasets.</span></figcaption>
</figure>
<div id="S4.SS1.p8" class="ltx_para">
<p id="S4.SS1.p8.1" class="ltx_p">In the cross-device setting, the local model inference is also necessary when the inference is conducted on personal devices.
As shown in Fig. <a href="#S4.F4" title="Figure 4 ‣ 4. Experiments ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, the final global model of <span id="S4.SS1.p8.1.1" class="ltx_text ltx_font_italic">ExclusiveFL</span> can only be deployed on devices of powerful clients while client-inclusive federated learning solutions (<span id="S4.SS1.p8.1.2" class="ltx_text ltx_font_italic">InclusiveFL</span>, <span id="S4.SS1.p8.1.3" class="ltx_text ltx_font_italic">HeteroFL</span>) and <span id="S4.SS1.p8.1.4" class="ltx_text ltx_font_italic">AllSmall</span> can be deployed on other clients with less storage and computation power.
We notice that <span id="S4.SS1.p8.1.5" class="ltx_text ltx_font_italic">InclusiveFL</span> performs best on each sub-global model, which validates the advantage of <span id="S4.SS1.p8.1.6" class="ltx_text ltx_font_italic">InclusiveFL</span> in local inference.
This also explains the performance advantage than another heterogeneous aggregation method <span id="S4.SS1.p8.1.7" class="ltx_text ltx_font_italic">HeteroFL</span> in a global inference scenario, because better sub-global models lay the foundation for a better large inference model.
In addition, the averaged rounds for achieving the best F1-score for MRPC and best accuracy for RTE is less for <span id="S4.SS1.p8.1.8" class="ltx_text ltx_font_italic">InclusiveFL</span> than <span id="S4.SS1.p8.1.9" class="ltx_text ltx_font_italic">InclusiveFL-w/o MD</span>, which shows the advantage of the proposed momentum distillation.</p>
</div>
<figure id="S4.T5" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S4.T5.3.1.1" class="ltx_text" style="font-size:90%;">Table 5</span>. </span><span id="S4.T5.4.2" class="ltx_text" style="font-size:90%;">Influence of different proportions of device types on the CoLA dataset.</span></figcaption>
<table id="S4.T5.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T5.1.2" class="ltx_tr">
<td id="S4.T5.1.2.1" class="ltx_td ltx_border_r ltx_border_tt"></td>
<td id="S4.T5.1.2.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T5.1.2.2.1" class="ltx_text ltx_font_bold">1:1:1</span></td>
<td id="S4.T5.1.2.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T5.1.2.3.1" class="ltx_text ltx_font_bold">1:2:7</span></td>
<td id="S4.T5.1.2.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T5.1.2.4.1" class="ltx_text ltx_font_bold">7:2:1</span></td>
</tr>
<tr id="S4.T5.1.3" class="ltx_tr">
<td id="S4.T5.1.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">AllLarge</td>
<td id="S4.T5.1.3.2" class="ltx_td ltx_align_center ltx_border_t">63.03</td>
<td id="S4.T5.1.3.3" class="ltx_td ltx_align_center ltx_border_t">63.03</td>
<td id="S4.T5.1.3.4" class="ltx_td ltx_align_center ltx_border_t">63.03</td>
</tr>
<tr id="S4.T5.1.4" class="ltx_tr">
<td id="S4.T5.1.4.1" class="ltx_td ltx_align_center ltx_border_r">AllSmall</td>
<td id="S4.T5.1.4.2" class="ltx_td ltx_align_center">34.91</td>
<td id="S4.T5.1.4.3" class="ltx_td ltx_align_center">34.91</td>
<td id="S4.T5.1.4.4" class="ltx_td ltx_align_center">34.91</td>
</tr>
<tr id="S4.T5.1.5" class="ltx_tr">
<td id="S4.T5.1.5.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">ExclusiveFL</td>
<td id="S4.T5.1.5.2" class="ltx_td ltx_align_center ltx_border_t">37.77</td>
<td id="S4.T5.1.5.3" class="ltx_td ltx_align_center ltx_border_t">59.15</td>
<td id="S4.T5.1.5.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T5.1.5.4.1" class="ltx_text ltx_font_bold">36.87</span></td>
</tr>
<tr id="S4.T5.1.6" class="ltx_tr">
<td id="S4.T5.1.6.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">HeteroFL</td>
<td id="S4.T5.1.6.2" class="ltx_td ltx_align_center ltx_border_t">8.15</td>
<td id="S4.T5.1.6.3" class="ltx_td ltx_align_center ltx_border_t">9.60</td>
<td id="S4.T5.1.6.4" class="ltx_td ltx_align_center ltx_border_t">N/A</td>
</tr>
<tr id="S4.T5.1.7" class="ltx_tr">
<td id="S4.T5.1.7.1" class="ltx_td ltx_align_center ltx_border_r">InclusiveFL w/o MD</td>
<td id="S4.T5.1.7.2" class="ltx_td ltx_align_center">52.69</td>
<td id="S4.T5.1.7.3" class="ltx_td ltx_align_center">60.35</td>
<td id="S4.T5.1.7.4" class="ltx_td ltx_align_center">N/A</td>
</tr>
<tr id="S4.T5.1.1" class="ltx_tr">
<td id="S4.T5.1.1.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">InclusiveFL</td>
<td id="S4.T5.1.1.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T5.1.1.3.1" class="ltx_text ltx_font_bold">54.85</span></td>
<td id="S4.T5.1.1.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T5.1.1.4.1" class="ltx_text ltx_font_bold">61.23</span></td>
<td id="S4.T5.1.1.1" class="ltx_td ltx_align_center ltx_border_bb"><math id="S4.T5.1.1.1.m1.1" class="ltx_Math" alttext="34.96^{*}" display="inline"><semantics id="S4.T5.1.1.1.m1.1a"><msup id="S4.T5.1.1.1.m1.1.1" xref="S4.T5.1.1.1.m1.1.1.cmml"><mn id="S4.T5.1.1.1.m1.1.1.2" xref="S4.T5.1.1.1.m1.1.1.2.cmml">34.96</mn><mo id="S4.T5.1.1.1.m1.1.1.3" xref="S4.T5.1.1.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T5.1.1.1.m1.1b"><apply id="S4.T5.1.1.1.m1.1.1.cmml" xref="S4.T5.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T5.1.1.1.m1.1.1.1.cmml" xref="S4.T5.1.1.1.m1.1.1">superscript</csymbol><cn type="float" id="S4.T5.1.1.1.m1.1.1.2.cmml" xref="S4.T5.1.1.1.m1.1.1.2">34.96</cn><times id="S4.T5.1.1.1.m1.1.1.3.cmml" xref="S4.T5.1.1.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.1.1.1.m1.1c">34.96^{*}</annotation></semantics></math></td>
</tr>
</table>
</figure>
<figure id="S4.F6" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F6.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2202.08036/assets/x16.png" id="S4.F6.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="332" height="234" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.sf1.4.2.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S4.F6.sf1.2.1" class="ltx_text" style="font-size:90%;">CoLA with <span id="S4.F6.sf1.2.1.1" class="ltx_text ltx_font_italic">InclusiveFL<sup id="S4.F6.sf1.2.1.1.1" class="ltx_sup"><span id="S4.F6.sf1.2.1.1.1.1" class="ltx_text ltx_font_upright">∗</span></sup></span>.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F6.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2202.08036/assets/x17.png" id="S4.F6.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="332" height="237" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.sf2.3.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S4.F6.sf2.4.2" class="ltx_text" style="font-size:90%;">Medical NER with <span id="S4.F6.sf2.4.2.1" class="ltx_text ltx_font_italic">InclusiveFL</span></span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.4.2.1" class="ltx_text" style="font-size:90%;">Figure 6</span>. </span><span id="S4.F6.2.1" class="ltx_text" style="font-size:90%;">Influence of momentum distillation <math id="S4.F6.2.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.F6.2.1.m1.1b"><mi id="S4.F6.2.1.m1.1.1" xref="S4.F6.2.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.F6.2.1.m1.1c"><ci id="S4.F6.2.1.m1.1.1.cmml" xref="S4.F6.2.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.2.1.m1.1d">\beta</annotation></semantics></math>.</span></figcaption>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Ablation Study</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">To validate the principle of “No one left behind”, we conduct the ablation study in Fig. <a href="#S4.F5" title="Figure 5 ‣ 4.1. Performance Evaluation ‣ 4. Experiments ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> by ignoring each type of devices in heterogeneous federated learning on both GLUE benchmark and medical NER datasets.
For non-IID setting, <span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_italic">InclusiveFL-w/o weak</span> for SMM4H, <span id="S4.SS2.p1.1.2" class="ltx_text ltx_font_italic">InclusiveFL-w/o medium</span> for ADE and <span id="S4.SS2.p1.1.3" class="ltx_text ltx_font_italic">InclusiveFL-w/o strong</span> for CADEC are not applicable because each client has different local token classification task and cannot be trained without the local dataset.
Among the three device types, we notice that <span id="S4.SS2.p1.1.4" class="ltx_text ltx_font_italic">InclusiveFL w/o strong</span> performs worse than <span id="S4.SS2.p1.1.5" class="ltx_text ltx_font_italic">InclusiveFL-w/o medium</span> and <span id="S4.SS2.p1.1.6" class="ltx_text ltx_font_italic">InclusiveFL-w/o weak</span>, which indicates that the contribution of powerful clients, medium clients and weak clients decrease progressively.
Powerful clients with more resources can learn knowledge with a larger model and contribute more.
We can observe that the client-inclusive federated learning (<span id="S4.SS2.p1.1.7" class="ltx_text ltx_font_italic">InclusiveFL</span> and <span id="S4.SS2.p1.1.8" class="ltx_text ltx_font_italic">InclusiveFL-w/o MD</span>) perform better than excluding each type of device, which validates our motivation that every single device should be included and contribute to federated training.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Hyper-Parameter Analysis</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">At last, we analyze two important hyper-parameters for <span id="S4.SS3.p1.1.1" class="ltx_text ltx_font_italic">InclusiveFL</span>.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p"><span id="S4.SS3.p2.1.1" class="ltx_text ltx_font_bold">Device type proportion.</span>
To investigate the effectiveness of <span id="S4.SS3.p2.1.2" class="ltx_text ltx_font_italic">InclusiveFL</span> under different proportions of strong, medium, and weak devices, we present results with 1:2:7, 7:2:1 and a default setting of 1:1:1 on the CoLA dataset in Table <a href="#S4.T5" title="Table 5 ‣ 4.1. Performance Evaluation ‣ 4. Experiments ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.
In general, increasing the proportion of strong devices results in a better performance of <span id="S4.SS3.p2.1.3" class="ltx_text ltx_font_italic">ExclusiveFL</span> and <span id="S4.SS3.p2.1.4" class="ltx_text ltx_font_italic">HeteroFL</span>.
We can observe that the performance advantage of <span id="S4.SS3.p2.1.5" class="ltx_text ltx_font_italic">InclusiveFL</span> is consistent for two device proportions, compared with naive baselines and <span id="S4.SS3.p2.1.6" class="ltx_text ltx_font_italic">HeteroFL</span>.
But we notice that when the powerful client group is the minority (e.g., 7:2:1), the convergence of the largest model is slow and aggregating over heterogeneous devices is not stable.
Thus, we indicate one result in Table <a href="#S4.T5" title="Table 5 ‣ 4.1. Performance Evaluation ‣ 4. Experiments ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> with a superscript of * when only adopt the momentum distillation without sharing layer-wise parameters across heterogeneous models.
And the performance is slightly worse than the best baseline <span id="S4.SS3.p2.1.7" class="ltx_text ltx_font_italic">ExclusiveFL</span> with a Matthew’s correlation of 36.87.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.9" class="ltx_p"><span id="S4.SS3.p3.1.1" class="ltx_text ltx_font_bold">Momentum factor <math id="S4.SS3.p3.1.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS3.p3.1.1.m1.1a"><mi id="S4.SS3.p3.1.1.m1.1.1" xref="S4.SS3.p3.1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.1.m1.1b"><ci id="S4.SS3.p3.1.1.m1.1.1.cmml" xref="S4.SS3.p3.1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.1.m1.1c">\beta</annotation></semantics></math>.</span>
Then we tune the momentum factor <math id="S4.SS3.p3.2.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS3.p3.2.m1.1a"><mi id="S4.SS3.p3.2.m1.1.1" xref="S4.SS3.p3.2.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m1.1b"><ci id="S4.SS3.p3.2.m1.1.1.cmml" xref="S4.SS3.p3.2.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m1.1c">\beta</annotation></semantics></math> of <span id="S4.SS3.p3.9.3" class="ltx_text ltx_font_italic">InclusiveFL</span> with various choices of <math id="S4.SS3.p3.3.m2.5" class="ltx_Math" alttext="\{0,0.2,0.5,0.8,1\}" display="inline"><semantics id="S4.SS3.p3.3.m2.5a"><mrow id="S4.SS3.p3.3.m2.5.6.2" xref="S4.SS3.p3.3.m2.5.6.1.cmml"><mo stretchy="false" id="S4.SS3.p3.3.m2.5.6.2.1" xref="S4.SS3.p3.3.m2.5.6.1.cmml">{</mo><mn id="S4.SS3.p3.3.m2.1.1" xref="S4.SS3.p3.3.m2.1.1.cmml">0</mn><mo id="S4.SS3.p3.3.m2.5.6.2.2" xref="S4.SS3.p3.3.m2.5.6.1.cmml">,</mo><mn id="S4.SS3.p3.3.m2.2.2" xref="S4.SS3.p3.3.m2.2.2.cmml">0.2</mn><mo id="S4.SS3.p3.3.m2.5.6.2.3" xref="S4.SS3.p3.3.m2.5.6.1.cmml">,</mo><mn id="S4.SS3.p3.3.m2.3.3" xref="S4.SS3.p3.3.m2.3.3.cmml">0.5</mn><mo id="S4.SS3.p3.3.m2.5.6.2.4" xref="S4.SS3.p3.3.m2.5.6.1.cmml">,</mo><mn id="S4.SS3.p3.3.m2.4.4" xref="S4.SS3.p3.3.m2.4.4.cmml">0.8</mn><mo id="S4.SS3.p3.3.m2.5.6.2.5" xref="S4.SS3.p3.3.m2.5.6.1.cmml">,</mo><mn id="S4.SS3.p3.3.m2.5.5" xref="S4.SS3.p3.3.m2.5.5.cmml">1</mn><mo stretchy="false" id="S4.SS3.p3.3.m2.5.6.2.6" xref="S4.SS3.p3.3.m2.5.6.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m2.5b"><set id="S4.SS3.p3.3.m2.5.6.1.cmml" xref="S4.SS3.p3.3.m2.5.6.2"><cn type="integer" id="S4.SS3.p3.3.m2.1.1.cmml" xref="S4.SS3.p3.3.m2.1.1">0</cn><cn type="float" id="S4.SS3.p3.3.m2.2.2.cmml" xref="S4.SS3.p3.3.m2.2.2">0.2</cn><cn type="float" id="S4.SS3.p3.3.m2.3.3.cmml" xref="S4.SS3.p3.3.m2.3.3">0.5</cn><cn type="float" id="S4.SS3.p3.3.m2.4.4.cmml" xref="S4.SS3.p3.3.m2.4.4">0.8</cn><cn type="integer" id="S4.SS3.p3.3.m2.5.5.cmml" xref="S4.SS3.p3.3.m2.5.5">1</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m2.5c">\{0,0.2,0.5,0.8,1\}</annotation></semantics></math>.
This parameter indicates the weight of gradient from larger model when applying the homophobic gradients to update each sub-global.
And <math id="S4.SS3.p3.4.m3.1" class="ltx_Math" alttext="\beta=0" display="inline"><semantics id="S4.SS3.p3.4.m3.1a"><mrow id="S4.SS3.p3.4.m3.1.1" xref="S4.SS3.p3.4.m3.1.1.cmml"><mi id="S4.SS3.p3.4.m3.1.1.2" xref="S4.SS3.p3.4.m3.1.1.2.cmml">β</mi><mo id="S4.SS3.p3.4.m3.1.1.1" xref="S4.SS3.p3.4.m3.1.1.1.cmml">=</mo><mn id="S4.SS3.p3.4.m3.1.1.3" xref="S4.SS3.p3.4.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.4.m3.1b"><apply id="S4.SS3.p3.4.m3.1.1.cmml" xref="S4.SS3.p3.4.m3.1.1"><eq id="S4.SS3.p3.4.m3.1.1.1.cmml" xref="S4.SS3.p3.4.m3.1.1.1"></eq><ci id="S4.SS3.p3.4.m3.1.1.2.cmml" xref="S4.SS3.p3.4.m3.1.1.2">𝛽</ci><cn type="integer" id="S4.SS3.p3.4.m3.1.1.3.cmml" xref="S4.SS3.p3.4.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.4.m3.1c">\beta=0</annotation></semantics></math> equals the the version of <span id="S4.SS3.p3.9.4" class="ltx_text ltx_font_italic">InclusiveFL-w/o MD</span>.
We conduct evaluation on each type of sub-global model for the two cases:
1) <span id="S4.SS3.p3.5.2" class="ltx_text ltx_font_italic">InclusiveFL<sup id="S4.SS3.p3.5.2.1" class="ltx_sup"><span id="S4.SS3.p3.5.2.1.1" class="ltx_text ltx_font_upright">∗</span></sup></span> that only applies the momentum distillation without heterogeneous parameter exchange on CoLA dataset in the IID cross-device setting.
2) <span id="S4.SS3.p3.9.5" class="ltx_text ltx_font_italic">InclusiveFL</span> on Medical NER dataset in non-IID cross-silo setting.
In Fig. <a href="#S4.F6" title="Figure 6 ‣ 4.1. Performance Evaluation ‣ 4. Experiments ‣ No One Left Behind: Inclusive Federated Learning over Heterogeneous Devices" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, we indicate results that are superior than <span id="S4.SS3.p3.9.6" class="ltx_text ltx_font_italic">ExclusiveFL</span>, <span id="S4.SS3.p3.9.7" class="ltx_text ltx_font_italic">AllSmall</span> and <span id="S4.SS3.p3.9.8" class="ltx_text ltx_font_italic">HeteroFL</span> with the circle dot.
We notice that the optimal value of <math id="S4.SS3.p3.6.m4.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS3.p3.6.m4.1a"><mi id="S4.SS3.p3.6.m4.1.1" xref="S4.SS3.p3.6.m4.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.6.m4.1b"><ci id="S4.SS3.p3.6.m4.1.1.cmml" xref="S4.SS3.p3.6.m4.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.6.m4.1c">\beta</annotation></semantics></math> is around 0.5 for powerful clients under both settings.
The model on medium and weak devices also performs well when <math id="S4.SS3.p3.7.m5.1" class="ltx_Math" alttext="\beta=0.2" display="inline"><semantics id="S4.SS3.p3.7.m5.1a"><mrow id="S4.SS3.p3.7.m5.1.1" xref="S4.SS3.p3.7.m5.1.1.cmml"><mi id="S4.SS3.p3.7.m5.1.1.2" xref="S4.SS3.p3.7.m5.1.1.2.cmml">β</mi><mo id="S4.SS3.p3.7.m5.1.1.1" xref="S4.SS3.p3.7.m5.1.1.1.cmml">=</mo><mn id="S4.SS3.p3.7.m5.1.1.3" xref="S4.SS3.p3.7.m5.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.7.m5.1b"><apply id="S4.SS3.p3.7.m5.1.1.cmml" xref="S4.SS3.p3.7.m5.1.1"><eq id="S4.SS3.p3.7.m5.1.1.1.cmml" xref="S4.SS3.p3.7.m5.1.1.1"></eq><ci id="S4.SS3.p3.7.m5.1.1.2.cmml" xref="S4.SS3.p3.7.m5.1.1.2">𝛽</ci><cn type="float" id="S4.SS3.p3.7.m5.1.1.3.cmml" xref="S4.SS3.p3.7.m5.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.7.m5.1c">\beta=0.2</annotation></semantics></math> or <math id="S4.SS3.p3.8.m6.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="S4.SS3.p3.8.m6.1a"><mn id="S4.SS3.p3.8.m6.1.1" xref="S4.SS3.p3.8.m6.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.8.m6.1b"><cn type="float" id="S4.SS3.p3.8.m6.1.1.cmml" xref="S4.SS3.p3.8.m6.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.8.m6.1c">0.5</annotation></semantics></math>.
The performance of a <math id="S4.SS3.p3.9.m7.1" class="ltx_Math" alttext="\beta&gt;0.8" display="inline"><semantics id="S4.SS3.p3.9.m7.1a"><mrow id="S4.SS3.p3.9.m7.1.1" xref="S4.SS3.p3.9.m7.1.1.cmml"><mi id="S4.SS3.p3.9.m7.1.1.2" xref="S4.SS3.p3.9.m7.1.1.2.cmml">β</mi><mo id="S4.SS3.p3.9.m7.1.1.1" xref="S4.SS3.p3.9.m7.1.1.1.cmml">&gt;</mo><mn id="S4.SS3.p3.9.m7.1.1.3" xref="S4.SS3.p3.9.m7.1.1.3.cmml">0.8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.9.m7.1b"><apply id="S4.SS3.p3.9.m7.1.1.cmml" xref="S4.SS3.p3.9.m7.1.1"><gt id="S4.SS3.p3.9.m7.1.1.1.cmml" xref="S4.SS3.p3.9.m7.1.1.1"></gt><ci id="S4.SS3.p3.9.m7.1.1.2.cmml" xref="S4.SS3.p3.9.m7.1.1.2">𝛽</ci><cn type="float" id="S4.SS3.p3.9.m7.1.1.3.cmml" xref="S4.SS3.p3.9.m7.1.1.3">0.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.9.m7.1c">\beta&gt;0.8</annotation></semantics></math> may be ruined by injecting too much momentum from larger model to smaller model’s gradients.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Conclusions</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we propose a client-inclusive framework <span id="S5.p1.1.1" class="ltx_text ltx_font_italic">InclusiveFL</span> for federated training over heterogeneous devices and remove the ideal assumption in conventional FL that all clients have sufficient device capability.
<span id="S5.p1.1.2" class="ltx_text ltx_font_italic">InclusiveFL</span> enables us to train a large global model with contributions from all clients by assigning models of different sizes to clients with different computing capabilities.
Thus, we avoid problems caused by ignoring weak clients or training with a small model.
Then, we propose an effective method to share the knowledge among multiple local models with different sizes by a layer-wise heterogeneous aggregation.
Besides, we propose a momentum knowledge distillation method for better transferring knowledge in big models of strong powerful clients to small models on weak clients.
Extensive experiments are conducted on benchmark data and real-world medical corpora with comparisons of both naive baselines and the existing state-of-the-art work under IID and Non-IID settings.
Results validate the accuracy improvement of <span id="S5.p1.1.3" class="ltx_text ltx_font_italic">InclusiveFL</span> on the large global model as well as smaller models when inference is conducted on local devices.</p>
</div>
<div class="ltx_acknowledgements">
<h6 class="ltx_title ltx_title_acknowledgements">Acknowledgements.</h6>
This work was supported by the National Natural Science Foundation of China under Grant numbers 62072460, 62076245, 62172424 and Beijing Natural Science Foundation under Grant number 4212022.

</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">        




</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bonawitz et al<span id="bib.bib2.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Keith Bonawitz, Hubert
Eichner, Wolfgang Grieskamp, Dzmitry
Huba, Alex Ingerman, Vladimir Ivanov,
Chloe Kiddon, Jakub Konečnỳ,
Stefano Mazzocchi, Brendan McMahan,
et al<span id="bib.bib2.3.1" class="ltx_text">.</span> 2019.

</span>
<span class="ltx_bibblock">Towards federated learning at scale: System
design.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.4.1" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning and Systems</em>
1 (2019), 374–388.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bouacida et al<span id="bib.bib3.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Nader Bouacida, Jiahui
Hou, Hui Zang, and Xin Liu.
2021.

</span>
<span class="ltx_bibblock">Adaptive federated dropout: Improving communication
efficiency and generalization for federated learning. In
<em id="bib.bib3.3.1" class="ltx_emph ltx_font_italic">IEEE INFOCOM 2021-IEEE Conference on Computer
Communications Workshops (INFOCOM WKSHPS)</em>. IEEE, 1–6.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Caldas et al<span id="bib.bib4.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Sebastian Caldas, Jakub
Konečny, H Brendan McMahan, and
Ameet Talwalkar. 2018.

</span>
<span class="ltx_bibblock">Expanding the reach of federated learning by
reducing client resource requirements.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1812.07210</em>
(2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cera et al<span id="bib.bib5.2.2.1" class="ltx_text">.</span> (2017)</span>
<span class="ltx_bibblock">
Daniel Cera, Mona Diabb,
Eneko Agirrec, Inigo Lopez-Gazpioc,
Lucia Speciad, and Basque Country
Donostia. 2017.

</span>
<span class="ltx_bibblock">SemEval-2017 Task 1 Semantic Textual Similarity
Multilingual and Cross-lingual Focused Evaluation.

</span>
<span class="ltx_bibblock">(2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chang et al<span id="bib.bib6.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Hongyan Chang, Virat
Shejwalkar, Reza Shokri, and Amir
Houmansadr. 2019.

</span>
<span class="ltx_bibblock">Cronus: Robust and heterogeneous collaborative
learning with black-box knowledge transfer.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1912.11279</em>
(2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Courtiol et al<span id="bib.bib7.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Pierre Courtiol, Charles
Maussion, Matahi Moarii, Elodie Pronier,
Samuel Pilcer, Meriem Sefta, and
Pierre Manceron. 2019.

</span>
<span class="ltx_bibblock">Deep learning-based classification of mesothelioma
improves prediction of patient outcome.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.3.1" class="ltx_emph ltx_font_italic">Nature Medicine</em> 25,
10 (2019), 1519–1526.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Diao et al<span id="bib.bib8.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Enmao Diao, Jie Ding,
and Vahid Tarokh. 2021.

</span>
<span class="ltx_bibblock">HeteroFL: Computation and Communication Efficient
Federated Learning for Heterogeneous Clients. In
<em id="bib.bib8.3.1" class="ltx_emph ltx_font_italic">9th International Conference on Learning
Representations, ICLR 2021, Virtual Event, Austria, May 3-7, 2021</em>.
OpenReview.net.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://openreview.net/forum?id=TNkPBBYFkXg" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=TNkPBBYFkXg</a>

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dodge et al<span id="bib.bib9.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Jesse Dodge, Gabriel
Ilharco, Roy Schwartz, Ali Farhadi,
Hannaneh Hajishirzi, and Noah Smith.
2020.

</span>
<span class="ltx_bibblock">Fine-tuning pretrained language models: Weight
initializations, data orders, and early stopping.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.06305</em>
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dolan and Brockett (2005)</span>
<span class="ltx_bibblock">
Bill Dolan and Chris
Brockett. 2005.

</span>
<span class="ltx_bibblock">Automatically constructing a corpus of sentential
paraphrases. In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Third International Workshop on
Paraphrasing (IWP2005)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dutta et al<span id="bib.bib11.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Aritra Dutta, El Houcine
Bergou, Ahmed M Abdelmoniem, Chen-Yu Ho,
Atal Narayan Sahu, Marco Canini, and
Panos Kalnis. 2020.

</span>
<span class="ltx_bibblock">On the discrepancy between the theoretical analysis
and practical implementations of compressed communication for distributed
deep learning. In <em id="bib.bib11.3.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI
Conference on Artificial Intelligence</em>, Vol. 34.
3817–3824.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ge et al<span id="bib.bib12.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Suyu Ge, Fangzhao Wu,
Chuhan Wu, Tao Qi,
Yongfeng Huang, and Xing Xie.
2020.

</span>
<span class="ltx_bibblock">FedNER: Privacy-preserving Medical Named Entity
Recognition with Federated Learning.

</span>
<span class="ltx_bibblock">(2020).

</span>
<span class="ltx_bibblock">arXiv:2003.09288

<a target="_blank" href="https://arxiv.org/abs/2003.09288" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2003.09288</a>

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gurulingappa et al<span id="bib.bib13.2.2.1" class="ltx_text">.</span> (2012)</span>
<span class="ltx_bibblock">
Harsha Gurulingappa,
Abdul Mateen Rajput, Angus Roberts,
Juliane Fluck, Martin Hofmann-Apitius,
and Luca Toldo. 2012.

</span>
<span class="ltx_bibblock">Development of a Benchmark Corpus to Support the
Automatic Extraction of Drug-Related Adverse Effects from Medical Case
Reports.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.3.1" class="ltx_emph ltx_font_italic">JBI</em> 45
(Oct. 2012), 885–892.

</span>
<span class="ltx_bibblock">

<a target="_blank" href="https://doi.org/10.1016/j.jbi.2012.04.008" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1016/j.jbi.2012.04.008</a>

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hao et al<span id="bib.bib14.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Weituo Hao, Mostafa
El-Khamy, Jungwon Lee, Jianyi Zhang,
Kevin J. Liang, Changyou Chen, and
Lawrence Carin. 2021.

</span>
<span class="ltx_bibblock">Towards Fair Federated Learning With Zero-Shot Data
Augmentation. In <em id="bib.bib14.3.1" class="ltx_emph ltx_font_italic">CVPR Workshops</em>.
3310–3319.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hard et al<span id="bib.bib15.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Andrew Hard, Kanishka
Rao, Rajiv Mathews, Swaroop Ramaswamy,
Françoise Beaufays, Sean
Augenstein, Hubert Eichner, Chloé
Kiddon, and Daniel Ramage.
2018.

</span>
<span class="ltx_bibblock">Federated learning for mobile keyboard prediction.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1811.03604</em>
(2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hinton et al<span id="bib.bib16.2.2.1" class="ltx_text">.</span> (2015)</span>
<span class="ltx_bibblock">
Geoffrey Hinton, Oriol
Vinyals, Jeff Dean, et al<span id="bib.bib16.3.1" class="ltx_text">.</span>
2015.

</span>
<span class="ltx_bibblock">Distilling the knowledge in a neural network.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.4.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1503.02531</em>
2, 7 (2015).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hou et al<span id="bib.bib17.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Lu Hou, Zhiqi Huang,
Lifeng Shang, Xin Jiang,
Xiao Chen, and Qun Liu.
2020.

</span>
<span class="ltx_bibblock">Dynabert: Dynamic bert with adaptive width and
depth.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.3.1" class="ltx_emph ltx_font_italic">NeurIPS</em> 33
(2020), 9782–9793.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimi et al<span id="bib.bib18.2.2.1" class="ltx_text">.</span> (2015)</span>
<span class="ltx_bibblock">
Sarvnaz Karimi, Alejandro
Metke-Jimenez, Madonna Kemp, and Chen
Wang. 2015.

</span>
<span class="ltx_bibblock">Cadec: A Corpus of Adverse Drug Event
Annotations.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.3.1" class="ltx_emph ltx_font_italic">Journal of Biomedical Informatics</em>
55 (June 2015),
73–81.

</span>
<span class="ltx_bibblock">

<a target="_blank" href="https://doi.org/10.1016/j.jbi.2015.03.010" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1016/j.jbi.2015.03.010</a>

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kenton and Toutanova (2018)</span>
<span class="ltx_bibblock">
Jacob Devlin Ming-Wei Chang Kenton and
Lee Kristina Toutanova. 2018.

</span>
<span class="ltx_bibblock">BERT: Pre-training of Deep Bidirectional
Transformers for Language Understanding.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Universal Language Model Fine-tuning for Text
Classification</em> (2018), 278.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Konečnỳ et al<span id="bib.bib20.2.2.1" class="ltx_text">.</span> (2016)</span>
<span class="ltx_bibblock">
Jakub Konečnỳ,
H Brendan McMahan, Felix X Yu,
Peter Richtárik, Ananda Theertha
Suresh, and Dave Bacon.
2016.

</span>
<span class="ltx_bibblock">Federated learning: Strategies for improving
communication efficiency.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1610.05492</em>
(2016).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li and Wang (2019)</span>
<span class="ltx_bibblock">
Daliang Li and Junpu
Wang. 2019.

</span>
<span class="ltx_bibblock">Fedmd: Heterogenous federated learning via model
distillation.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1910.03581</em>
(2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al<span id="bib.bib22.2.2.1" class="ltx_text">.</span> (2020b)</span>
<span class="ltx_bibblock">
Tao Lin, Lingjing Kong,
Sebastian U Stich, and Martin Jaggi.
2020b.

</span>
<span class="ltx_bibblock">Ensemble distillation for robust model fusion in
federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.3.1" class="ltx_emph ltx_font_italic">NeurIPS</em> 33
(2020), 2351–2363.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al<span id="bib.bib23.2.2.1" class="ltx_text">.</span> (2020a)</span>
<span class="ltx_bibblock">
Yujun Lin, Song Han,
Huizi Mao, Yu Wang, and
William J. Dally. 2020a.

</span>
<span class="ltx_bibblock">Deep Gradient Compression: Reducing the Communication
Bandwidth for Distributed Training.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:1712.01887 [cs.CV]

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span id="bib.bib24.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Yinhan Liu, Myle Ott,
Naman Goyal, Jingfei Du,
Mandar Joshi, Danqi Chen,
Omer Levy, Mike Lewis,
Luke Zettlemoyer, and Veselin
Stoyanov. 2019.

</span>
<span class="ltx_bibblock">Roberta: A robustly optimized bert pretraining
approach.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.3.1" class="ltx_emph ltx_font_italic">arXiv:1907.11692</em> (2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span id="bib.bib25.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Zhuang Liu, Mingjie Sun,
Tinghui Zhou, Gao Huang, and
Trevor Darrell. 2018.

</span>
<span class="ltx_bibblock">Rethinking the Value of Network Pruning. In
<em id="bib.bib25.3.1" class="ltx_emph ltx_font_italic">ICLR</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al<span id="bib.bib26.2.2.1" class="ltx_text">.</span> (2017)</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider
Moore, Daniel Ramage, Seth Hampson,
and Blaise Aguera y Arcas.
2017.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks
from decentralized data. In <em id="bib.bib26.3.1" class="ltx_emph ltx_font_italic">Artificial
intelligence and statistics</em>. PMLR, 1273–1282.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al<span id="bib.bib27.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
H Brendan McMahan et al<span id="bib.bib27.3.1" class="ltx_text">.</span>
2021.

</span>
<span class="ltx_bibblock">Advances and open problems in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.4.1" class="ltx_emph ltx_font_italic">Foundations and Trends® in
Machine Learning</em> 14, 1
(2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al<span id="bib.bib28.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
H Brendan McMahan, Daniel
Ramage, Kunal Talwar, and Li Zhang.
2018.

</span>
<span class="ltx_bibblock">Learning Differentially Private Recurrent Language
Models. In <em id="bib.bib28.3.1" class="ltx_emph ltx_font_italic">International Conference on Learning
Representations</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mehrabi et al<span id="bib.bib29.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Ninareh Mehrabi, Fred
Morstatter, Nripsuta Saxena, Kristina
Lerman, and Aram Galstyan.
2021.

</span>
<span class="ltx_bibblock">A survey on bias and fairness in machine learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.3.1" class="ltx_emph ltx_font_italic">ACM Computing Surveys (CSUR)</em>
54, 6 (2021),
1–35.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Prusa et al<span id="bib.bib30.2.2.1" class="ltx_text">.</span> (2015)</span>
<span class="ltx_bibblock">
Joseph Prusa, Taghi M.
Khoshgoftaar, and Naeem Seliya.
2015.

</span>
<span class="ltx_bibblock">The Effect of Dataset Size on Training Tweet
Sentiment Classifiers. In <em id="bib.bib30.3.1" class="ltx_emph ltx_font_italic">2015 IEEE 14th
International Conference on Machine Learning and Applications (ICMLA)</em>.
96–102.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://doi.org/10.1109/ICMLA.2015.22" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1109/ICMLA.2015.22</a>

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rajpurkar et al<span id="bib.bib31.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Pranav Rajpurkar, Robin
Jia, and Percy Liang. 2018.

</span>
<span class="ltx_bibblock">Know what you don’t know: Unanswerable questions
for SQuAD.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1806.03822</em>
(2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reddi et al<span id="bib.bib32.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Sashank Reddi, Zachary
Charles, Manzil Zaheer, Zachary Garrett,
Keith Rush, Jakub Konečnỳ,
Sanjiv Kumar, and H Brendan McMahan.
2020.

</span>
<span class="ltx_bibblock">Adaptive federated optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2003.00295</em>
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sajjad et al<span id="bib.bib33.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Hassan Sajjad, Fahim
Dalvi, Nadir Durrani, and Preslav
Nakov. 2020.

</span>
<span class="ltx_bibblock">On the effect of dropping layers of pre-trained
transformer models.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2004.03844</em>
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sattler et al<span id="bib.bib34.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Felix Sattler, Simon
Wiedemann, Klaus-Robert Müller, and
Wojciech Samek. 2019.

</span>
<span class="ltx_bibblock">Robust and communication-efficient federated
learning from non-iid data.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.3.1" class="ltx_emph ltx_font_italic">TNNLS</em> 31,
9 (2019), 3400–3413.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Socher et al<span id="bib.bib35.2.2.1" class="ltx_text">.</span> (2013)</span>
<span class="ltx_bibblock">
Richard Socher, Alex
Perelygin, Jean Wu, Jason Chuang,
Christopher D Manning, Andrew Y Ng, and
Christopher Potts. 2013.

</span>
<span class="ltx_bibblock">Recursive deep models for semantic compositionality
over a sentiment treebank. In <em id="bib.bib35.3.1" class="ltx_emph ltx_font_italic">Proceedings of the
2013 conference on empirical methods in natural language processing</em>.
1631–1642.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Srivastava et al<span id="bib.bib36.2.2.1" class="ltx_text">.</span> (2014)</span>
<span class="ltx_bibblock">
Nitish Srivastava,
Geoffrey Hinton, Alex Krizhevsky,
Ilya Sutskever, and Ruslan
Salakhutdinov. 2014.

</span>
<span class="ltx_bibblock">Dropout: A Simple Way to Prevent Neural Networks
from Overfitting.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.3.1" class="ltx_emph ltx_font_italic">J. Mach. Learn. Res.</em> 15,
1 (jan 2014),
1929–1958.

</span>
<span class="ltx_bibblock">

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun and Lyu (2020)</span>
<span class="ltx_bibblock">
Lichao Sun and Lingjuan
Lyu. 2020.

</span>
<span class="ltx_bibblock">Federated model distillation with noise-free
differential privacy.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2009.05537</em>
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Varghese et al<span id="bib.bib38.2.2.1" class="ltx_text">.</span> (2016)</span>
<span class="ltx_bibblock">
Blesson Varghese, Nan
Wang, Sakil Barbhuiya, Peter Kilpatrick,
and Dimitrios S Nikolopoulos.
2016.

</span>
<span class="ltx_bibblock">Challenges and opportunities in edge computing. In
<em id="bib.bib38.3.1" class="ltx_emph ltx_font_italic">SmartCloud</em>. IEEE, 20–26.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span id="bib.bib39.2.2.1" class="ltx_text">.</span> (2018b)</span>
<span class="ltx_bibblock">
Alex Wang, Amanpreet
Singh, Julian Michael, Felix Hill,
Omer Levy, and Samuel R Bowman.
2018b.

</span>
<span class="ltx_bibblock">GLUE: A multi-task benchmark and analysis platform
for natural language understanding.

</span>
<span class="ltx_bibblock"><em id="bib.bib39.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1804.07461</em>
(2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span id="bib.bib40.2.2.1" class="ltx_text">.</span> (2018a)</span>
<span class="ltx_bibblock">
Hongyi Wang, Scott
Sievert, Shengchao Liu, Zachary Charles,
Dimitris Papailiopoulos, and Stephen
Wright. 2018a.

</span>
<span class="ltx_bibblock">Atomo: Communication-efficient learning via atomic
sparsification.

</span>
<span class="ltx_bibblock"><em id="bib.bib40.3.1" class="ltx_emph ltx_font_italic">NeurIPS</em> 31
(2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wangni et al<span id="bib.bib41.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Jianqiao Wangni, Jialei
Wang, Ji Liu, and Tong Zhang.
2018.

</span>
<span class="ltx_bibblock">Gradient sparsification for communication-efficient
distributed optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib41.3.1" class="ltx_emph ltx_font_italic">NeurIPS</em> 31
(2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Warnat-Herresthal et al<span id="bib.bib42.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Stefanie Warnat-Herresthal,
Hartmut Schultze,
Krishnaprasad Lingadahalli Shastry,
Sathyanarayanan Manamohan, Saikat
Mukherjee, Vishesh Garg, Ravi
Sarveswara, Kristian Händler, Peter
Pickkers, N Ahmad Aziz, et al<span id="bib.bib42.3.1" class="ltx_text">.</span>
2021.

</span>
<span class="ltx_bibblock">Swarm learning for decentralized and confidential
clinical machine learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.4.1" class="ltx_emph ltx_font_italic">Nature</em> 594,
7862 (2021), 265–270.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Warstadt et al<span id="bib.bib43.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Alex Warstadt, Amanpreet
Singh, and Samuel R Bowman.
2019.

</span>
<span class="ltx_bibblock">Neural network acceptability judgments.

</span>
<span class="ltx_bibblock"><em id="bib.bib43.3.1" class="ltx_emph ltx_font_italic">Transactions of the Association for
Computational Linguistics</em> 7 (2019),
625–641.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Weissenbacher et al<span id="bib.bib44.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Davy Weissenbacher, Abeed
Sarker, Arjun Magge, Ashlynn Daughton,
Karen O’Connor, Michael J. Paul, and
Graciela Gonzalez-Hernandez.
2019.

</span>
<span class="ltx_bibblock">Overview of the Fourth Social Media Mining for
Health (SMM4H) Shared Tasks at ACL 2019. In
<em id="bib.bib44.3.1" class="ltx_emph ltx_font_italic">Proceedings of the Fourth Social Media Mining
for Health Applications (#SMM4H) Workshop &amp; Shared Task</em>.
21–30.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://doi.org/10.18653/v1/W19-3203" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.18653/v1/W19-3203</a>

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Williams et al<span id="bib.bib45.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Adina Williams, Nikita
Nangia, and Samuel Bowman.
2018.

</span>
<span class="ltx_bibblock">A Broad-Coverage Challenge Corpus for Sentence
Understanding through Inference. In <em id="bib.bib45.3.1" class="ltx_emph ltx_font_italic">Proceedings of
the 2018 Conference of the North American Chapter of the Association for
Computational Linguistics: Human Language Technologies, Volume 1</em>.
1112–1122.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span id="bib.bib46.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Chuhan Wu, Fangzhao Wu,
Lingjuan Lyu, Yongfeng Huang, and
Xing Xie. 2022.

</span>
<span class="ltx_bibblock">FedCTR: Federated Native Ad CTR Prediction with
Cross Platform User Behavior Data.

</span>
<span class="ltx_bibblock"><em id="bib.bib46.3.1" class="ltx_emph ltx_font_italic">ACM Transactions on Intelligent Systems and
Technology (TIST)</em> (2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span id="bib.bib47.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Chuhan Wu, Fangzhao Wu,
Yang Yu, Tao Qi,
Yongfeng Huang, and Qi Liu.
2021.

</span>
<span class="ltx_bibblock">NewsBERT: Distilling Pre-trained Language Model for
Intelligent News Application.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2102.04887 [cs.CL]

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al<span id="bib.bib48.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Chenhao Xu, Youyang Qu,
Yong Xiang, and Longxiang Gao.
2021.

</span>
<span class="ltx_bibblock">Asynchronous federated learning on heterogeneous
devices: A survey.

</span>
<span class="ltx_bibblock"><em id="bib.bib48.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2109.04269</em>
(2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span id="bib.bib49.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Timothy Yang, Galen
Andrew, Hubert Eichner, Haicheng Sun,
Wei Li, Nicholas Kong,
Daniel Ramage, and Françoise
Beaufays. 2018.

</span>
<span class="ltx_bibblock">Applied federated learning: Improving google
keyboard query suggestions.

</span>
<span class="ltx_bibblock"><em id="bib.bib49.3.1" class="ltx_emph ltx_font_italic">arXiv:1812.02903</em> (2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2202.08035" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2202.08036" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2202.08036">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2202.08036" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2202.08037" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Mar  7 20:02:04 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
