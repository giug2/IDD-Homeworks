<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2202.09472] FedEmbed: Personalized Private Federated Learning</title><meta property="og:description" content="Federated learning enables the deployment of machine learning to problems for which centralized data collection is impractical. Adding differential privacy guarantees bounds on privacy while data are contributed to a g…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FedEmbed: Personalized Private Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="FedEmbed: Personalized Private Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2202.09472">

<!--Generated on Thu Mar  7 19:54:07 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">FedEmbed: Personalized Private Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Andrew Silva<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Work done as an intern at Apple.</span></span></span>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Georgia Institute of Technology
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Katherine Metcalf
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Apple
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Nicholas Apostoloff
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Apple
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Barry-John Theobald
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Apple
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Federated learning enables the deployment of machine learning to problems for which centralized data collection is impractical. Adding differential privacy guarantees bounds on privacy while data are contributed to a global model. Adding personalization to federated learning introduces new challenges as we must account for preferences of individual users, where a data sample could have conflicting labels because one sub-population of users might view an input positively, but other sub-populations view the same input negatively. We present FedEmbed, a new approach to private federated learning for personalizing a global model that uses (1) sub-populations of similar users, and (2) personal embeddings. We demonstrate that current approaches to federated learning are inadequate for handling data with conflicting labels, and we show that FedEmbed achieves up to 45% improvement over baseline approaches to personalized private federated learning.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">As the scale and diversity of problems tackled with machine learning increases, so too does the challenge of acquiring sufficiently large, centralized, real-world datasets. For example, legal restrictions may explicitly restrict or prohibit collecting centralized datasets containing personally identifiable information <cite class="ltx_cite ltx_citemacro_citep">(Roberts et al., <a href="#bib.bib30" title="" class="ltx_ref">2017</a>; Gerke et al., <a href="#bib.bib10" title="" class="ltx_ref">2019</a>, <a href="#bib.bib11" title="" class="ltx_ref">2020</a>)</cite>. Federated learning <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite> learns from <span id="S1.p1.1.1" class="ltx_text ltx_font_italic">decentralized</span> data to address many of the challenges associated with centralized datasets: clients obtain a model from a server and perform gradient updates on their local data; the gradients are sent to the server; the server updates the model, e.g., using <span id="S1.p1.1.2" class="ltx_text ltx_font_italic">federated averaging</span>; then the updated model is pushed to all clients.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">However, naively applying federated averaging, or any traditional machine learning technique, will fail in domains where either data are distributed unevenly amongst the available classes, or where data contain conflicting labels. In the former case, under-represented data will not meaningfully contribute to the model since they are lost when averaging across all user gradients. This problem is compounded with the addition of differential privacy <cite class="ltx_cite ltx_citemacro_citep">(Chuanxin et al., <a href="#bib.bib2" title="" class="ltx_ref">2020</a>; Li et al., <a href="#bib.bib23" title="" class="ltx_ref">2020</a>)</cite>, where the shared model will either default to fit the “average user”, or will collapse entirely. For the latter case, consider a customer service robot that interacts using speech. Some users may prefer a monotone and terse speech, whereas others may prefer an emotive voice and conversational speech <cite class="ltx_cite ltx_citemacro_citep">(Metcalf et al., <a href="#bib.bib26" title="" class="ltx_ref">2019</a>)</cite>. Crucially, the label associated with a given utterance is conditioned on the customer’s preferences. If we naively average all customer preference labels, it is impossible to personalize a model adequately, as illustrated in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2202.09472/assets/fig/overview_fig.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="198" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.3.2" class="ltx_text" style="font-size:90%;">FedEmbed addresses the problem of using federated learning with user preferences, where the same data can have multiple labels. Federated averaging ignores individual user preferences, whereas FedEmbed learns a unique model head for each sub-population of users.</span></figcaption>
</figure>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">FedEmbed, our novel approach to personalized federated learning, works both to model user preferences, where each data sample can take conflicting labels to represent the preference of different users, and to mitigate data sparsity issues for under-represented sub-populations of users. The model is comprised of a common backbone that allows a shared feature encoder to be learned from all users, which feeds a shared representation to a separate classification head tailored for each specific sub-population. A key contribution of FedEmbed lies in learning a globally shared, sub-population independent, model using person-specific embeddings for conditioning predictions on specific users.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Our main contributions are as follows:</p>
</div>
<div id="S1.p5" class="ltx_para">
<ol id="S1.I1" class="ltx_enumerate">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">FedEmbed, a novel approach to personalized, private federated learning from distributed datasets with conflicting labels.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">An evaluation of FedEmbed and several baselines. In the presence of differential privacy, FedEmbed allows models to personalize even as the baselines fail. We show up to 45% improvement over baselines.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">A synthetic speech-preference dataset<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>Details for acquiring these data will be provided upon acceptance.</span></span></span>, presenting a challenge for future research within personalized private federated learning.</p>
</div>
</li>
</ol>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Personalized Federated Learning</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">While the introduction of federated averaging <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite> enabled decentralized learning for many tasks, it has not addressed domains where data may have conflicting labels or some classes may be under-represented, which are key to personalization. Proposed solutions for such domains typically fall into one of two categories: split learning <cite class="ltx_cite ltx_citemacro_citep">(Gupta &amp; Raskar, <a href="#bib.bib12" title="" class="ltx_ref">2018</a>)</cite> or meta learning <cite class="ltx_cite ltx_citemacro_citep">(Finn et al., <a href="#bib.bib9" title="" class="ltx_ref">2017</a>; Nichol et al., <a href="#bib.bib27" title="" class="ltx_ref">2018</a>)</cite>.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p"><span id="S2.SS1.p2.1.1" class="ltx_text ltx_font_bold">Split learning</span> assigns a different classification head to each user, separating the learning process into representation learning and classification learning. Gradients are shared for representation learning, but each client makes local independent gradient updates to its classification head. This paradigm has been adapted for personalized federated learning: PFedMe <cite class="ltx_cite ltx_citemacro_citep">(Dinh et al., <a href="#bib.bib6" title="" class="ltx_ref">2020</a>)</cite>, PFedKM <cite class="ltx_cite ltx_citemacro_citep">(Tang et al., <a href="#bib.bib36" title="" class="ltx_ref">2021</a>)</cite>, FedRep <cite class="ltx_cite ltx_citemacro_citep">(Collins et al., <a href="#bib.bib3" title="" class="ltx_ref">2021</a>)</cite>, FedMD <cite class="ltx_cite ltx_citemacro_citep">(Li &amp; Wang, <a href="#bib.bib22" title="" class="ltx_ref">2019</a>)</cite>, and others <cite class="ltx_cite ltx_citemacro_citep">(Arivazhagan et al., <a href="#bib.bib1" title="" class="ltx_ref">2019</a>; Kim et al., <a href="#bib.bib19" title="" class="ltx_ref">2021</a>; Rudovic et al., <a href="#bib.bib32" title="" class="ltx_ref">2021</a>; Paulik et al., <a href="#bib.bib29" title="" class="ltx_ref">2021</a>)</cite>. For each of these adaptations, all users contribute gradients to a shared encoder, helping the centralized model learn a robust feature representation of the data (e.g., medical images). At the same time, local classification heads learn to use the feature representation from the shared encoder to make personalized predictions (e.g., a diagnosis of a particular ailment). The personalized model head balances accurately accommodating the individuality of each user with the power of deep learning for feature extraction.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.1" class="ltx_p"><span id="S2.SS1.p3.1.1" class="ltx_text ltx_font_bold">Meta-learning</span> learns a function that simultaneously satisfies multiple objectives and avoids negative transfer <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib37" title="" class="ltx_ref">2019</a>)</cite>. Negative transfer occurs when improvement on one task harms performance on other tasks, forcing a trade-off between objectives. Meta-learning methods, such as MAML <cite class="ltx_cite ltx_citemacro_citep">(Finn et al., <a href="#bib.bib9" title="" class="ltx_ref">2017</a>)</cite> and Reptile <cite class="ltx_cite ltx_citemacro_citep">(Nichol et al., <a href="#bib.bib27" title="" class="ltx_ref">2018</a>)</cite>, attempt to mitigate this trade-off by considering all task objectives before making gradient updates. By considering multiple objectives and averaging out gradients, federated averaging can be viewed as a form of meta learning <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al., <a href="#bib.bib18" title="" class="ltx_ref">2019</a>)</cite>. While prior work has applied meta-learning to federated learning on data with multimodal distributions <cite class="ltx_cite ltx_citemacro_citep">(Smith et al., <a href="#bib.bib33" title="" class="ltx_ref">2017</a>)</cite>, the approach does not work when there is a single task or the labels differ across users. The prior approaches learned mixtures of local and global models, where local models adapt the global model to handle individual deviations from the global mean <cite class="ltx_cite ltx_citemacro_citep">(Deng et al., <a href="#bib.bib5" title="" class="ltx_ref">2020</a>; Hanzely &amp; Richtárik, <a href="#bib.bib13" title="" class="ltx_ref">2020</a>; Hanzely et al., <a href="#bib.bib14" title="" class="ltx_ref">2020</a>)</cite>. However, in situations where user labels are directly conflicting, our results show that a global model reinforces the dominance of the average user’s label, thereby not offering useful information for under-represented user models.</p>
</div>
<div id="S2.SS1.p4" class="ltx_para">
<p id="S2.SS1.p4.1" class="ltx_p">For real-world applications, federated learning must be extended to <span id="S2.SS1.p4.1.1" class="ltx_text ltx_font_italic">private</span> federated learning. Crucially, while private personalized learning has been applied to linear problems <cite class="ltx_cite ltx_citemacro_cite">Jain et al. (<a href="#bib.bib17" title="" class="ltx_ref">2021</a>)</cite>, no prior work has examined private personalized federated learning for deep networks. While prior work claims that split learning and federated learning approaches are privacy-preserving, <cite class="ltx_cite ltx_citemacro_citet">Rudovic et al. (<a href="#bib.bib32" title="" class="ltx_ref">2021</a>)</cite> identify that split learning masks a user’s identity, but does not guarantee privacy. For guarantees of privacy, the addition of differential privacy <cite class="ltx_cite ltx_citemacro_citep">(Dwork et al., <a href="#bib.bib8" title="" class="ltx_ref">2006b</a>, <a href="#bib.bib7" title="" class="ltx_ref">a</a>)</cite> to a federated learning framework is necessary. In this work, we consider the use of Gaussian differential privacy <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib23" title="" class="ltx_ref">2020</a>; Chuanxin et al., <a href="#bib.bib2" title="" class="ltx_ref">2020</a>)</cite>, a widely-used approach with guaranteed bounds within which a population distribution can be accurately approximated whilst ensuring user data remain private. Our results (Section <a href="#S4" title="4 Experiments and Results ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) show that prior approaches to personalized federated learning cannot personalize in the presence of differential privacy.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Personal Embeddings</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Unique personal embeddings (kept on-device) are central to the success of FedEmbed. Inspired by the use of user-specific embeddings in imitation learning <cite class="ltx_cite ltx_citemacro_citep">(Tamar et al., <a href="#bib.bib35" title="" class="ltx_ref">2018</a>; Hsiao et al., <a href="#bib.bib15" title="" class="ltx_ref">2019</a>; Paleja et al., <a href="#bib.bib28" title="" class="ltx_ref">2020</a>)</cite>, we use personal embeddings to personalize to sub-populations of users with similar preferences.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">To cluster users with similar preferences, we make use of prototypical examples for each sub-population. Prototypes have been used for few-shot classification, where embedding networks and nearest-neighbor lookup produce accurate few-shot classifiers <cite class="ltx_cite ltx_citemacro_citep">(Snell et al., <a href="#bib.bib34" title="" class="ltx_ref">2017</a>)</cite>. In our work, we use nearest-neighbor lookup with personal embeddings to define clusters around a set of known prototypes.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>FedEmbed</h2>

<figure id="S3.F2" class="ltx_figure"><img src="/html/2202.09472/assets/fig/alternate_pipeline_whitebg.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="538" height="161" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.6.3.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S3.F2.4.2" class="ltx_text" style="font-size:90%;">Overview of the FedEmbed architecture. Each client maintains a unique personal embedding on-device. The personal embedding is concatenated both to the input data and to the intermediate representations from the global parameters of a common backbone model. The output from the common backbone is a feature embedding that is passed to: 1) the client’s assigned sub-population model head to classify if the input is preferred for that sub-population of users (binary classification), 2) a global model head that classifies if the input is preferred for a user, but receives gradient updates from all users (binary classification), and 3) a global sub-population prediction model-head, which predicts which of the <math id="S3.F2.3.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.F2.3.1.m1.1b"><mi id="S3.F2.3.1.m1.1.1" xref="S3.F2.3.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.F2.3.1.m1.1c"><ci id="S3.F2.3.1.m1.1.1.cmml" xref="S3.F2.3.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.3.1.m1.1d">k</annotation></semantics></math> sub-population model-heads should predict true (<math id="S3.F2.4.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.F2.4.2.m2.1b"><mi id="S3.F2.4.2.m2.1.1" xref="S3.F2.4.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.F2.4.2.m2.1c"><ci id="S3.F2.4.2.m2.1.1.cmml" xref="S3.F2.4.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.4.2.m2.1d">k</annotation></semantics></math>-way classification). The purpose of the sub-population prediction head is to give structure to the feature embeddings from the common backbone (see Appendix <a href="#A3" title="Appendix C Effect of 𝑘-way classification on user embeddings structure ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a>), which we observe typically provides model training with a 2x speed up, and the purpose of the global in-distribution model head is to provide a latent space that is consistent across all users for learning personal embeddings.</span></figcaption>
</figure>
<div id="S3.p1" class="ltx_para">
<p id="S3.p1.2" class="ltx_p">FedEmbed extends federated averaging to consider user-specific labels (e.g., preferences for a certain type of input data) by learning: (1) user-specific embeddings, (2) a globally shared feature encoder, (3) <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">k</annotation></semantics></math> sub-population specific model heads that predict if a given input is in a preferred category for the respective sub-population, and (4) global model heads for predicting which of the <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">k</annotation></semantics></math> sub-populations have a preference for the input sample and if an input sample is classified positively by a particular user. Both global heads are updated using aggregated data from all users rather than just a sub-population of similar users. The personal embeddings enable FedEmbed to cluster similar users into sub-populations that share a model head. Sub-population model heads see more data than an individual model head would, and therefore improve robustness compared to user-specific model heads. Furthermore, sub-population model heads do not receive gradients from users with conflicting labels and, therefore, offer improved personalization compared to a globally-shared model head. In this section, we present a unified overview of the learning process for FedEmbed, and then provide details on each of FedEmbed’s components. Pseudocode and related training details for FedEmbed are given in Appendix <a href="#A1" title="Appendix A FedEmbed Algorithm ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Learning Process</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.8" class="ltx_p">Given a classification objective <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{C}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">ℒ</mi><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">ℒ</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathcal{L}_{C}</annotation></semantics></math>, FedEmbed learns (1) the parameters, <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\theta</annotation></semantics></math>, of a global feature encoder, (2) the parameters, <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="\phi_{k}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">ϕ</mi><mi id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">italic-ϕ</ci><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\phi_{k}</annotation></semantics></math>, for a set of sub-population model heads <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="k\in[K]" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><mrow id="S3.SS1.p1.4.m4.1.2" xref="S3.SS1.p1.4.m4.1.2.cmml"><mi id="S3.SS1.p1.4.m4.1.2.2" xref="S3.SS1.p1.4.m4.1.2.2.cmml">k</mi><mo id="S3.SS1.p1.4.m4.1.2.1" xref="S3.SS1.p1.4.m4.1.2.1.cmml">∈</mo><mrow id="S3.SS1.p1.4.m4.1.2.3.2" xref="S3.SS1.p1.4.m4.1.2.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.4.m4.1.2.3.2.1" xref="S3.SS1.p1.4.m4.1.2.3.1.1.cmml">[</mo><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">K</mi><mo stretchy="false" id="S3.SS1.p1.4.m4.1.2.3.2.2" xref="S3.SS1.p1.4.m4.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.2.cmml" xref="S3.SS1.p1.4.m4.1.2"><in id="S3.SS1.p1.4.m4.1.2.1.cmml" xref="S3.SS1.p1.4.m4.1.2.1"></in><ci id="S3.SS1.p1.4.m4.1.2.2.cmml" xref="S3.SS1.p1.4.m4.1.2.2">𝑘</ci><apply id="S3.SS1.p1.4.m4.1.2.3.1.cmml" xref="S3.SS1.p1.4.m4.1.2.3.2"><csymbol cd="latexml" id="S3.SS1.p1.4.m4.1.2.3.1.1.cmml" xref="S3.SS1.p1.4.m4.1.2.3.2.1">delimited-[]</csymbol><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">k\in[K]</annotation></semantics></math>, where <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">K</annotation></semantics></math> is the number of sub-populations, (3) the parameters, <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="\nu" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">ν</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝜈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">\nu</annotation></semantics></math>, of a global model head that predicts if an input is viewed positively or negatively for every user (regardless of their sub-population), and (4) the parameters, <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">\gamma</annotation></semantics></math>, of a global model head that predicts which of the <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">k</annotation></semantics></math> sub-populations have a preference for the style of the given input data.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.3" class="ltx_p">The parameters <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\gamma</annotation></semantics></math> for the <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">k</annotation></semantics></math>-way classification head can be shared across all users without resulting in conflicting labels, because the type of the input data is user-independent, e.g., emotive speech is emotive regardless if it is preferred by any particular user. Furthermore, including the <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">k</annotation></semantics></math>-way prediction task embeds knowledge of the different data types within the global feature encoder. Although we find this task is not necessary for learning a shared feature encoder, it does provide structure to the shared feature representation (see Appendix <a href="#A3" title="Appendix C Effect of 𝑘-way classification on user embeddings structure ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a>), which regularly leads to a 2x speed up in model convergence.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.4" class="ltx_p">When updating the model, clients pull the latest model parameters <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\theta</annotation></semantics></math>, <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><mi id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><ci id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">\phi</annotation></semantics></math>, <math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><mi id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><ci id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">\gamma</annotation></semantics></math>, and <math id="S3.SS1.p3.4.m4.1" class="ltx_Math" alttext="\nu" display="inline"><semantics id="S3.SS1.p3.4.m4.1a"><mi id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml">ν</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><ci id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">𝜈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">\nu</annotation></semantics></math> from the server. Each client identifies, via SOM (Section <a href="#S3.SS3.SSS1" title="3.3.1 SOM Assignment ‣ 3.3 Sub-Population Assignment ‣ 3 FedEmbed ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3.1</span></a>) or prototype (Section <a href="#S3.SS3.SSS2" title="3.3.2 Prototype Assignment ‣ 3.3 Sub-Population Assignment ‣ 3 FedEmbed ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3.2</span></a>) assignment, a sub-population model-head. Next, clients calculate gradient updates for all parameters using their local datasets. Note that the clients maintain zero-gradients for unused model-heads, i.e., the model-heads for the sub-populations to which the user does not belong. After finishing the gradient calculation, the clients optionally add differential privacy to their computed gradients (for all parameters, including unused model heads) before sending them back to the server. In our experiments, we compare performance both with and without differential privacy.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.5" class="ltx_p">After all clients have pushed their gradients to the server, the central server generates the updates. The <math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="\phi_{k}" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><msub id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml"><mi id="S3.SS1.p4.1.m1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.2.cmml">ϕ</mi><mi id="S3.SS1.p4.1.m1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p4.1.m1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.2">italic-ϕ</ci><ci id="S3.SS1.p4.1.m1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">\phi_{k}</annotation></semantics></math> gradients are averaged over all users for each of the <math id="S3.SS1.p4.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p4.2.m2.1a"><mi id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><ci id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">k</annotation></semantics></math> classification heads, as the server is unaware of each client’s identity or sub-population membership. The <math id="S3.SS1.p4.3.m3.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS1.p4.3.m3.1a"><mi id="S3.SS1.p4.3.m3.1.1" xref="S3.SS1.p4.3.m3.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.1b"><ci id="S3.SS1.p4.3.m3.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.1c">\theta</annotation></semantics></math>, <math id="S3.SS1.p4.4.m4.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.SS1.p4.4.m4.1a"><mi id="S3.SS1.p4.4.m4.1.1" xref="S3.SS1.p4.4.m4.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m4.1b"><ci id="S3.SS1.p4.4.m4.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m4.1c">\gamma</annotation></semantics></math> and <math id="S3.SS1.p4.5.m5.1" class="ltx_Math" alttext="\nu" display="inline"><semantics id="S3.SS1.p4.5.m5.1a"><mi id="S3.SS1.p4.5.m5.1.1" xref="S3.SS1.p4.5.m5.1.1.cmml">ν</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.5.m5.1b"><ci id="S3.SS1.p4.5.m5.1.1.cmml" xref="S3.SS1.p4.5.m5.1.1">𝜈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.5.m5.1c">\nu</annotation></semantics></math> gradients are averaged over all users and applied to the shared feature encoder, and the two global model heads respectively.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Personal Embeddings</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.3" class="ltx_p">FedEmbed uses personal embeddings, <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\vec{\epsilon}_{u}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mover accent="true" id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2.2" xref="S3.SS2.p1.1.m1.1.1.2.2.cmml">ϵ</mi><mo stretchy="false" id="S3.SS2.p1.1.m1.1.1.2.1" xref="S3.SS2.p1.1.m1.1.1.2.1.cmml">→</mo></mover><mi id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><apply id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2"><ci id="S3.SS2.p1.1.m1.1.1.2.1.cmml" xref="S3.SS2.p1.1.m1.1.1.2.1">→</ci><ci id="S3.SS2.p1.1.m1.1.1.2.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2.2">italic-ϵ</ci></apply><ci id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\vec{\epsilon}_{u}</annotation></semantics></math>, to cluster similar users. To begin, each user (i.e., client device) is assigned a personal embedding that is initialized from a uniform distribution of size <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="D_{E}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">D</mi><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝐷</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">D_{E}</annotation></semantics></math>, where <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="D_{E}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">D</mi><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝐷</ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">D_{E}</annotation></semantics></math> is a tuned hyper-parameter. The personal embeddings are <span id="S3.SS2.p1.3.1" class="ltx_text ltx_font_bold">never</span> sent to the central server. At inference time on the client device, a user’s personal embedding is appended to both their input samples and intermediary network representations (Figure <a href="#S3.F2" title="Figure 2 ‣ 3 FedEmbed ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), which explicitly conditions the network predictions on relevant, user-specific details  <cite class="ltx_cite ltx_citemacro_citep">(Rownicka et al., <a href="#bib.bib31" title="" class="ltx_ref">2019</a>; Cui et al., <a href="#bib.bib4" title="" class="ltx_ref">2017</a>)</cite>.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">At train time, following <cite class="ltx_cite ltx_citemacro_citet">Paleja et al. (<a href="#bib.bib28" title="" class="ltx_ref">2020</a>)</cite>, a user’s personal embedding receives gradient updates from all FedEmbed steps involving the user’s sample-label pairs. Unlike <cite class="ltx_cite ltx_citemacro_citet">Paleja et al. (<a href="#bib.bib28" title="" class="ltx_ref">2020</a>)</cite>, which used evidence lower-bound regularization on the gradients from the task objective function (<math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{C}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">ℒ</mi><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">ℒ</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\mathcal{L}_{C}</annotation></semantics></math>), we found empirically that such regularization offers no benefit to the separability nor the utility of our embeddings. Additionally, because the personal embeddings stay on-device, applying privacy-preserving noise to their gradient updates is unnecessary. Therefore, the personal embeddings are updated locally without any added regularization or noise.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">Embeddings learned via classification errors from different model heads may eventually occupy distinct latent spaces. However, to compare embeddings and identify meaningful user sub-populations, the embeddings must occupy a common latent space. Therefore, to obtain gradients that keep all personal embeddings in a shared latent space, we learn a globally shared classification head on the target task (<math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{C}" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><msub id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">ℒ</mi><mi id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">ℒ</ci><ci id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">\mathcal{L}_{C}</annotation></semantics></math>). The gradients from the global classification head only update the personal embeddings, ensuring that personal embeddings are drawn from the same latent space while preventing conflicting gradients from different sub-populations from affecting the global feature encoder.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Sub-Population Assignment</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">A sub-population represents a group of users with consistent labeling patterns (e.g., similar preferences) whose data are classified by a shared prediction head. A prior approach, PFedKM <cite class="ltx_cite ltx_citemacro_citep">(Tang et al., <a href="#bib.bib36" title="" class="ltx_ref">2021</a>)</cite>, groups users via <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">k</annotation></semantics></math>-means clustering <cite class="ltx_cite ltx_citemacro_citep">(MacQueen et al., <a href="#bib.bib24" title="" class="ltx_ref">1967</a>)</cite> on raw model weights and gradients. However, we observe that such clustering is noisy, impractically slow, and requires access to all user gradients simultaneously (a privacy vulnerability). Therefore, we investigated two separate approaches to sub-population assignment: (1) unsupervised clustering via self-organizing maps (SOMs) <cite class="ltx_cite ltx_citemacro_cite">Kohonen (<a href="#bib.bib20" title="" class="ltx_ref">1990</a>)</cite>, and (2) nearest-neighbor lookup with <em id="S3.SS3.p1.1.1" class="ltx_emph ltx_font_italic">sub-population prototypes</em>.</p>
</div>
<section id="S3.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1 </span>SOM Assignment</h4>

<div id="S3.SS3.SSS1.p1" class="ltx_para">
<p id="S3.SS3.SSS1.p1.1" class="ltx_p">We learn a SOM to map from personal embeddings to user sub-populations. To avoid training new model heads from scratch at every update, we reuse the model heads from the previous SOM by comparing user cluster membership in the new versus old SOMs and identify which clusters maximally overlap. For each cluster in the new SOM, the weights of the equivalent model head from the previous iteration initialize the model head associated with the new SOM cluster.</p>
</div>
<div id="S3.SS3.SSS1.p2" class="ltx_para">
<p id="S3.SS3.SSS1.p2.1" class="ltx_p">Learning the parameters of the SOM requires access to only one embedding at a time, so the SOM parameters are sent to each client. A SOM-weight update and similarity score for the client are sent back to the server, and the update from the best-scoring client is applied to each node in the SOM <cite class="ltx_cite ltx_citemacro_cite">Kohonen (<a href="#bib.bib20" title="" class="ltx_ref">1990</a>)</cite>.
User privacy is preserved as personal embeddings are not aggregated on the server nor is information about original client data exposed.</p>
</div>
</section>
<section id="S3.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.2 </span>Prototype Assignment</h4>

<div id="S3.SS3.SSS2.p1" class="ltx_para">
<p id="S3.SS3.SSS2.p1.1" class="ltx_p">While it is possible to learn sub-populations without prior knowledge via SOM assignment, the SOM can be slow to converge. If we instead assume a prototypical latent embedding exists for each known sub-population, clusters can be made denser, better-separated, and faster to converge.</p>
</div>
<div id="S3.SS3.SSS2.p2" class="ltx_para">
<p id="S3.SS3.SSS2.p2.8" class="ltx_p">We assume access to one or more prototypical users for each sub-population. Each time a user makes local gradient updates to their copy of the model, their personal embedding, <math id="S3.SS3.SSS2.p2.1.m1.1" class="ltx_Math" alttext="\vec{\epsilon}_{u}" display="inline"><semantics id="S3.SS3.SSS2.p2.1.m1.1a"><msub id="S3.SS3.SSS2.p2.1.m1.1.1" xref="S3.SS3.SSS2.p2.1.m1.1.1.cmml"><mover accent="true" id="S3.SS3.SSS2.p2.1.m1.1.1.2" xref="S3.SS3.SSS2.p2.1.m1.1.1.2.cmml"><mi id="S3.SS3.SSS2.p2.1.m1.1.1.2.2" xref="S3.SS3.SSS2.p2.1.m1.1.1.2.2.cmml">ϵ</mi><mo stretchy="false" id="S3.SS3.SSS2.p2.1.m1.1.1.2.1" xref="S3.SS3.SSS2.p2.1.m1.1.1.2.1.cmml">→</mo></mover><mi id="S3.SS3.SSS2.p2.1.m1.1.1.3" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.1.m1.1b"><apply id="S3.SS3.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.1.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p2.1.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.2"><ci id="S3.SS3.SSS2.p2.1.m1.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.2.1">→</ci><ci id="S3.SS3.SSS2.p2.1.m1.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.2.2">italic-ϵ</ci></apply><ci id="S3.SS3.SSS2.p2.1.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.1.m1.1c">\vec{\epsilon}_{u}</annotation></semantics></math>, is first updated via a triplet loss over the prototype for the input data’s current sub-population (the positive sample, <math id="S3.SS3.SSS2.p2.2.m2.1" class="ltx_Math" alttext="\vec{\epsilon}_{p}" display="inline"><semantics id="S3.SS3.SSS2.p2.2.m2.1a"><msub id="S3.SS3.SSS2.p2.2.m2.1.1" xref="S3.SS3.SSS2.p2.2.m2.1.1.cmml"><mover accent="true" id="S3.SS3.SSS2.p2.2.m2.1.1.2" xref="S3.SS3.SSS2.p2.2.m2.1.1.2.cmml"><mi id="S3.SS3.SSS2.p2.2.m2.1.1.2.2" xref="S3.SS3.SSS2.p2.2.m2.1.1.2.2.cmml">ϵ</mi><mo stretchy="false" id="S3.SS3.SSS2.p2.2.m2.1.1.2.1" xref="S3.SS3.SSS2.p2.2.m2.1.1.2.1.cmml">→</mo></mover><mi id="S3.SS3.SSS2.p2.2.m2.1.1.3" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.2.m2.1b"><apply id="S3.SS3.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.2.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p2.2.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.2"><ci id="S3.SS3.SSS2.p2.2.m2.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.2.1">→</ci><ci id="S3.SS3.SSS2.p2.2.m2.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.2.2">italic-ϵ</ci></apply><ci id="S3.SS3.SSS2.p2.2.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.2.m2.1c">\vec{\epsilon}_{p}</annotation></semantics></math>) and a prototype for a different sub-population (the negative sample, <math id="S3.SS3.SSS2.p2.3.m3.1" class="ltx_Math" alttext="\vec{\epsilon}_{n}" display="inline"><semantics id="S3.SS3.SSS2.p2.3.m3.1a"><msub id="S3.SS3.SSS2.p2.3.m3.1.1" xref="S3.SS3.SSS2.p2.3.m3.1.1.cmml"><mover accent="true" id="S3.SS3.SSS2.p2.3.m3.1.1.2" xref="S3.SS3.SSS2.p2.3.m3.1.1.2.cmml"><mi id="S3.SS3.SSS2.p2.3.m3.1.1.2.2" xref="S3.SS3.SSS2.p2.3.m3.1.1.2.2.cmml">ϵ</mi><mo stretchy="false" id="S3.SS3.SSS2.p2.3.m3.1.1.2.1" xref="S3.SS3.SSS2.p2.3.m3.1.1.2.1.cmml">→</mo></mover><mi id="S3.SS3.SSS2.p2.3.m3.1.1.3" xref="S3.SS3.SSS2.p2.3.m3.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.3.m3.1b"><apply id="S3.SS3.SSS2.p2.3.m3.1.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.3.m3.1.1.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p2.3.m3.1.1.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.2"><ci id="S3.SS3.SSS2.p2.3.m3.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.2.1">→</ci><ci id="S3.SS3.SSS2.p2.3.m3.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.2.2">italic-ϵ</ci></apply><ci id="S3.SS3.SSS2.p2.3.m3.1.1.3.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.3.m3.1c">\vec{\epsilon}_{n}</annotation></semantics></math>). The goal is to move the personal embedding towards <math id="S3.SS3.SSS2.p2.4.m4.1" class="ltx_Math" alttext="\vec{\epsilon}_{p}" display="inline"><semantics id="S3.SS3.SSS2.p2.4.m4.1a"><msub id="S3.SS3.SSS2.p2.4.m4.1.1" xref="S3.SS3.SSS2.p2.4.m4.1.1.cmml"><mover accent="true" id="S3.SS3.SSS2.p2.4.m4.1.1.2" xref="S3.SS3.SSS2.p2.4.m4.1.1.2.cmml"><mi id="S3.SS3.SSS2.p2.4.m4.1.1.2.2" xref="S3.SS3.SSS2.p2.4.m4.1.1.2.2.cmml">ϵ</mi><mo stretchy="false" id="S3.SS3.SSS2.p2.4.m4.1.1.2.1" xref="S3.SS3.SSS2.p2.4.m4.1.1.2.1.cmml">→</mo></mover><mi id="S3.SS3.SSS2.p2.4.m4.1.1.3" xref="S3.SS3.SSS2.p2.4.m4.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.4.m4.1b"><apply id="S3.SS3.SSS2.p2.4.m4.1.1.cmml" xref="S3.SS3.SSS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.4.m4.1.1.1.cmml" xref="S3.SS3.SSS2.p2.4.m4.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p2.4.m4.1.1.2.cmml" xref="S3.SS3.SSS2.p2.4.m4.1.1.2"><ci id="S3.SS3.SSS2.p2.4.m4.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.4.m4.1.1.2.1">→</ci><ci id="S3.SS3.SSS2.p2.4.m4.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.4.m4.1.1.2.2">italic-ϵ</ci></apply><ci id="S3.SS3.SSS2.p2.4.m4.1.1.3.cmml" xref="S3.SS3.SSS2.p2.4.m4.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.4.m4.1c">\vec{\epsilon}_{p}</annotation></semantics></math> and away from <math id="S3.SS3.SSS2.p2.5.m5.1" class="ltx_Math" alttext="\vec{\epsilon}_{n}" display="inline"><semantics id="S3.SS3.SSS2.p2.5.m5.1a"><msub id="S3.SS3.SSS2.p2.5.m5.1.1" xref="S3.SS3.SSS2.p2.5.m5.1.1.cmml"><mover accent="true" id="S3.SS3.SSS2.p2.5.m5.1.1.2" xref="S3.SS3.SSS2.p2.5.m5.1.1.2.cmml"><mi id="S3.SS3.SSS2.p2.5.m5.1.1.2.2" xref="S3.SS3.SSS2.p2.5.m5.1.1.2.2.cmml">ϵ</mi><mo stretchy="false" id="S3.SS3.SSS2.p2.5.m5.1.1.2.1" xref="S3.SS3.SSS2.p2.5.m5.1.1.2.1.cmml">→</mo></mover><mi id="S3.SS3.SSS2.p2.5.m5.1.1.3" xref="S3.SS3.SSS2.p2.5.m5.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.5.m5.1b"><apply id="S3.SS3.SSS2.p2.5.m5.1.1.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.5.m5.1.1.1.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p2.5.m5.1.1.2.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.2"><ci id="S3.SS3.SSS2.p2.5.m5.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.2.1">→</ci><ci id="S3.SS3.SSS2.p2.5.m5.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.2.2">italic-ϵ</ci></apply><ci id="S3.SS3.SSS2.p2.5.m5.1.1.3.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.5.m5.1c">\vec{\epsilon}_{n}</annotation></semantics></math>, where <math id="S3.SS3.SSS2.p2.6.m6.1" class="ltx_Math" alttext="\vec{\epsilon}_{n}" display="inline"><semantics id="S3.SS3.SSS2.p2.6.m6.1a"><msub id="S3.SS3.SSS2.p2.6.m6.1.1" xref="S3.SS3.SSS2.p2.6.m6.1.1.cmml"><mover accent="true" id="S3.SS3.SSS2.p2.6.m6.1.1.2" xref="S3.SS3.SSS2.p2.6.m6.1.1.2.cmml"><mi id="S3.SS3.SSS2.p2.6.m6.1.1.2.2" xref="S3.SS3.SSS2.p2.6.m6.1.1.2.2.cmml">ϵ</mi><mo stretchy="false" id="S3.SS3.SSS2.p2.6.m6.1.1.2.1" xref="S3.SS3.SSS2.p2.6.m6.1.1.2.1.cmml">→</mo></mover><mi id="S3.SS3.SSS2.p2.6.m6.1.1.3" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.6.m6.1b"><apply id="S3.SS3.SSS2.p2.6.m6.1.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.6.m6.1.1.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p2.6.m6.1.1.2.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.2"><ci id="S3.SS3.SSS2.p2.6.m6.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.2.1">→</ci><ci id="S3.SS3.SSS2.p2.6.m6.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.2.2">italic-ϵ</ci></apply><ci id="S3.SS3.SSS2.p2.6.m6.1.1.3.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.6.m6.1c">\vec{\epsilon}_{n}</annotation></semantics></math> is randomly sampled from all other preference prototypes. <math id="S3.SS3.SSS2.p2.7.m7.1" class="ltx_Math" alttext="\vec{\epsilon}_{u}" display="inline"><semantics id="S3.SS3.SSS2.p2.7.m7.1a"><msub id="S3.SS3.SSS2.p2.7.m7.1.1" xref="S3.SS3.SSS2.p2.7.m7.1.1.cmml"><mover accent="true" id="S3.SS3.SSS2.p2.7.m7.1.1.2" xref="S3.SS3.SSS2.p2.7.m7.1.1.2.cmml"><mi id="S3.SS3.SSS2.p2.7.m7.1.1.2.2" xref="S3.SS3.SSS2.p2.7.m7.1.1.2.2.cmml">ϵ</mi><mo stretchy="false" id="S3.SS3.SSS2.p2.7.m7.1.1.2.1" xref="S3.SS3.SSS2.p2.7.m7.1.1.2.1.cmml">→</mo></mover><mi id="S3.SS3.SSS2.p2.7.m7.1.1.3" xref="S3.SS3.SSS2.p2.7.m7.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.7.m7.1b"><apply id="S3.SS3.SSS2.p2.7.m7.1.1.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.7.m7.1.1.1.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p2.7.m7.1.1.2.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.2"><ci id="S3.SS3.SSS2.p2.7.m7.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.2.1">→</ci><ci id="S3.SS3.SSS2.p2.7.m7.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.2.2">italic-ϵ</ci></apply><ci id="S3.SS3.SSS2.p2.7.m7.1.1.3.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.7.m7.1c">\vec{\epsilon}_{u}</annotation></semantics></math> is then updated according to the loss in Equation <a href="#S3.E1" title="In 3.3.2 Prototype Assignment ‣ 3.3 Sub-Population Assignment ‣ 3 FedEmbed ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, where <math id="S3.SS3.SSS2.p2.8.m8.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS3.SSS2.p2.8.m8.1a"><mi id="S3.SS3.SSS2.p2.8.m8.1.1" xref="S3.SS3.SSS2.p2.8.m8.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.8.m8.1b"><ci id="S3.SS3.SSS2.p2.8.m8.1.1.cmml" xref="S3.SS3.SSS2.p2.8.m8.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.8.m8.1c">\alpha</annotation></semantics></math> is a hyper-parameter to enforce a margin on the distance between negative samples <cite class="ltx_cite ltx_citemacro_citep">(Weinberger et al., <a href="#bib.bib38" title="" class="ltx_ref">2005</a>)</cite>.</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.1" class="ltx_Math" alttext="L(\vec{\epsilon}_{u},\vec{\epsilon}_{p},\vec{\epsilon}_{n})=(\vec{\epsilon}_{u}-\vec{\epsilon}_{p})^{2}-(\vec{\epsilon}_{u}-\vec{\epsilon}_{n})^{2}+\alpha." display="block"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.3.5" xref="S3.E1.m1.1.1.1.1.3.5.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.3.4" xref="S3.E1.m1.1.1.1.1.3.4.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.3.3.3" xref="S3.E1.m1.1.1.1.1.3.3.4.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.3.3.3.4" xref="S3.E1.m1.1.1.1.1.3.3.4.cmml">(</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.cmml">ϵ</mi><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.cmml">→</mo></mover><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.cmml">u</mi></msub><mo id="S3.E1.m1.1.1.1.1.3.3.3.5" xref="S3.E1.m1.1.1.1.1.3.3.4.cmml">,</mo><msub id="S3.E1.m1.1.1.1.1.2.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.cmml"><mover accent="true" id="S3.E1.m1.1.1.1.1.2.2.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.2.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.cmml">ϵ</mi><mo stretchy="false" id="S3.E1.m1.1.1.1.1.2.2.2.2.2.1" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.cmml">→</mo></mover><mi id="S3.E1.m1.1.1.1.1.2.2.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.2.2.3.cmml">p</mi></msub><mo id="S3.E1.m1.1.1.1.1.3.3.3.6" xref="S3.E1.m1.1.1.1.1.3.3.4.cmml">,</mo><msub id="S3.E1.m1.1.1.1.1.3.3.3.3" xref="S3.E1.m1.1.1.1.1.3.3.3.3.cmml"><mover accent="true" id="S3.E1.m1.1.1.1.1.3.3.3.3.2" xref="S3.E1.m1.1.1.1.1.3.3.3.3.2.cmml"><mi id="S3.E1.m1.1.1.1.1.3.3.3.3.2.2" xref="S3.E1.m1.1.1.1.1.3.3.3.3.2.2.cmml">ϵ</mi><mo stretchy="false" id="S3.E1.m1.1.1.1.1.3.3.3.3.2.1" xref="S3.E1.m1.1.1.1.1.3.3.3.3.2.1.cmml">→</mo></mover><mi id="S3.E1.m1.1.1.1.1.3.3.3.3.3" xref="S3.E1.m1.1.1.1.1.3.3.3.3.3.cmml">n</mi></msub><mo stretchy="false" id="S3.E1.m1.1.1.1.1.3.3.3.7" xref="S3.E1.m1.1.1.1.1.3.3.4.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.1.1.1.1.6" xref="S3.E1.m1.1.1.1.1.6.cmml">=</mo><mrow id="S3.E1.m1.1.1.1.1.5" xref="S3.E1.m1.1.1.1.1.5.cmml"><mrow id="S3.E1.m1.1.1.1.1.5.2" xref="S3.E1.m1.1.1.1.1.5.2.cmml"><msup id="S3.E1.m1.1.1.1.1.4.1.1" xref="S3.E1.m1.1.1.1.1.4.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.4.1.1.1.1" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.4.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.4.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.2.2.cmml"><mi id="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.2.2.2.cmml">ϵ</mi><mo stretchy="false" id="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.2.2.1" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.2.2.1.cmml">→</mo></mover><mi id="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.2.3.cmml">u</mi></msub><mo id="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.3.2.cmml"><mi id="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.3.2.2" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.3.2.2.cmml">ϵ</mi><mo stretchy="false" id="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.3.2.1" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.3.2.1.cmml">→</mo></mover><mi id="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.3.3.cmml">p</mi></msub></mrow><mo stretchy="false" id="S3.E1.m1.1.1.1.1.4.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E1.m1.1.1.1.1.4.1.1.3" xref="S3.E1.m1.1.1.1.1.4.1.1.3.cmml">2</mn></msup><mo id="S3.E1.m1.1.1.1.1.5.2.3" xref="S3.E1.m1.1.1.1.1.5.2.3.cmml">−</mo><msup id="S3.E1.m1.1.1.1.1.5.2.2" xref="S3.E1.m1.1.1.1.1.5.2.2.cmml"><mrow id="S3.E1.m1.1.1.1.1.5.2.2.1.1" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.5.2.2.1.1.2" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.5.2.2.1.1.1" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.2" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.2.cmml"><mover accent="true" id="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.2.2.cmml"><mi id="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.2.2.2.cmml">ϵ</mi><mo stretchy="false" id="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.2.2.1" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.2.2.1.cmml">→</mo></mover><mi id="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.2.3.cmml">u</mi></msub><mo id="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.1" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.1.cmml">−</mo><msub id="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.3" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.3.cmml"><mover accent="true" id="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.3.2.cmml"><mi id="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.3.2.2" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.3.2.2.cmml">ϵ</mi><mo stretchy="false" id="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.3.2.1" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.3.2.1.cmml">→</mo></mover><mi id="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.3.3.cmml">n</mi></msub></mrow><mo stretchy="false" id="S3.E1.m1.1.1.1.1.5.2.2.1.1.3" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.cmml">)</mo></mrow><mn id="S3.E1.m1.1.1.1.1.5.2.2.3" xref="S3.E1.m1.1.1.1.1.5.2.2.3.cmml">2</mn></msup></mrow><mo id="S3.E1.m1.1.1.1.1.5.3" xref="S3.E1.m1.1.1.1.1.5.3.cmml">+</mo><mi id="S3.E1.m1.1.1.1.1.5.4" xref="S3.E1.m1.1.1.1.1.5.4.cmml">α</mi></mrow></mrow><mo lspace="0em" id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><eq id="S3.E1.m1.1.1.1.1.6.cmml" xref="S3.E1.m1.1.1.1.1.6"></eq><apply id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3"><times id="S3.E1.m1.1.1.1.1.3.4.cmml" xref="S3.E1.m1.1.1.1.1.3.4"></times><ci id="S3.E1.m1.1.1.1.1.3.5.cmml" xref="S3.E1.m1.1.1.1.1.3.5">𝐿</ci><vector id="S3.E1.m1.1.1.1.1.3.3.4.cmml" xref="S3.E1.m1.1.1.1.1.3.3.3"><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2"><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.1">→</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2">italic-ϵ</ci></apply><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3">𝑢</ci></apply><apply id="S3.E1.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2">subscript</csymbol><apply id="S3.E1.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2"><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.1">→</ci><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.2">italic-ϵ</ci></apply><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.3">𝑝</ci></apply><apply id="S3.E1.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E1.m1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.3.3.3.3">subscript</csymbol><apply id="S3.E1.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E1.m1.1.1.1.1.3.3.3.3.2"><ci id="S3.E1.m1.1.1.1.1.3.3.3.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.3.3.3.3.2.1">→</ci><ci id="S3.E1.m1.1.1.1.1.3.3.3.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.3.3.3.3.2.2">italic-ϵ</ci></apply><ci id="S3.E1.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E1.m1.1.1.1.1.3.3.3.3.3">𝑛</ci></apply></vector></apply><apply id="S3.E1.m1.1.1.1.1.5.cmml" xref="S3.E1.m1.1.1.1.1.5"><plus id="S3.E1.m1.1.1.1.1.5.3.cmml" xref="S3.E1.m1.1.1.1.1.5.3"></plus><apply id="S3.E1.m1.1.1.1.1.5.2.cmml" xref="S3.E1.m1.1.1.1.1.5.2"><minus id="S3.E1.m1.1.1.1.1.5.2.3.cmml" xref="S3.E1.m1.1.1.1.1.5.2.3"></minus><apply id="S3.E1.m1.1.1.1.1.4.1.1.cmml" xref="S3.E1.m1.1.1.1.1.4.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.4.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.4.1.1">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1"><minus id="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.1"></minus><apply id="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.2.2"><ci id="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.2.2.1">→</ci><ci id="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.2.2.2">italic-ϵ</ci></apply><ci id="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.2.3">𝑢</ci></apply><apply id="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.3.2"><ci id="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.3.2.1">→</ci><ci id="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.3.2.2">italic-ϵ</ci></apply><ci id="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.4.1.1.1.1.1.3.3">𝑝</ci></apply></apply><cn type="integer" id="S3.E1.m1.1.1.1.1.4.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.4.1.1.3">2</cn></apply><apply id="S3.E1.m1.1.1.1.1.5.2.2.cmml" xref="S3.E1.m1.1.1.1.1.5.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.5.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.5.2.2">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1"><minus id="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.1"></minus><apply id="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.2">subscript</csymbol><apply id="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.2.2"><ci id="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.2.2.1">→</ci><ci id="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.2.2.2">italic-ϵ</ci></apply><ci id="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.2.3">𝑢</ci></apply><apply id="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.3">subscript</csymbol><apply id="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.3.2"><ci id="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.3.2.1">→</ci><ci id="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.3.2.2">italic-ϵ</ci></apply><ci id="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.5.2.2.1.1.1.3.3">𝑛</ci></apply></apply><cn type="integer" id="S3.E1.m1.1.1.1.1.5.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.5.2.2.3">2</cn></apply></apply><ci id="S3.E1.m1.1.1.1.1.5.4.cmml" xref="S3.E1.m1.1.1.1.1.5.4">𝛼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">L(\vec{\epsilon}_{u},\vec{\epsilon}_{p},\vec{\epsilon}_{n})=(\vec{\epsilon}_{u}-\vec{\epsilon}_{p})^{2}-(\vec{\epsilon}_{u}-\vec{\epsilon}_{n})^{2}+\alpha.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS2.p2.9" class="ltx_p">After the triplet-loss updates are made to <math id="S3.SS3.SSS2.p2.9.m1.1" class="ltx_Math" alttext="\vec{\epsilon}_{u}" display="inline"><semantics id="S3.SS3.SSS2.p2.9.m1.1a"><msub id="S3.SS3.SSS2.p2.9.m1.1.1" xref="S3.SS3.SSS2.p2.9.m1.1.1.cmml"><mover accent="true" id="S3.SS3.SSS2.p2.9.m1.1.1.2" xref="S3.SS3.SSS2.p2.9.m1.1.1.2.cmml"><mi id="S3.SS3.SSS2.p2.9.m1.1.1.2.2" xref="S3.SS3.SSS2.p2.9.m1.1.1.2.2.cmml">ϵ</mi><mo stretchy="false" id="S3.SS3.SSS2.p2.9.m1.1.1.2.1" xref="S3.SS3.SSS2.p2.9.m1.1.1.2.1.cmml">→</mo></mover><mi id="S3.SS3.SSS2.p2.9.m1.1.1.3" xref="S3.SS3.SSS2.p2.9.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.9.m1.1b"><apply id="S3.SS3.SSS2.p2.9.m1.1.1.cmml" xref="S3.SS3.SSS2.p2.9.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.9.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.9.m1.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p2.9.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p2.9.m1.1.1.2"><ci id="S3.SS3.SSS2.p2.9.m1.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.9.m1.1.1.2.1">→</ci><ci id="S3.SS3.SSS2.p2.9.m1.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.9.m1.1.1.2.2">italic-ϵ</ci></apply><ci id="S3.SS3.SSS2.p2.9.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p2.9.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.9.m1.1c">\vec{\epsilon}_{u}</annotation></semantics></math>, the user is assigned the model head corresponding to the nearest prototype embedding based on Euclidean distance. Prototype vectors are continually updated alongside the global model, keeping them in the same latent space as user embeddings.</p>
</div>
</section>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Shared Feature Encoder</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.1" class="ltx_p">FedEmbed uses feedback from all users to learn a shared feature encoder in the form of a backbone common to all model heads. To learn this encoder, a user provides three sets of gradients to update the model by back-propogating through: 1) their sub-population model head, 2) the <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><mi id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><ci id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">k</annotation></semantics></math>-way classification task, and 3) the shared feature encoder.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments and Results</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We evaluate FedEmbed on two datasets: (1) MNIST <cite class="ltx_cite ltx_citemacro_citep">(LeCun et al., <a href="#bib.bib21" title="" class="ltx_ref">1989</a>)</cite>, and (2) a synthetic speech dataset derived from the LibriTTS corpus <cite class="ltx_cite ltx_citemacro_citep">(Zen et al., <a href="#bib.bib39" title="" class="ltx_ref">2019</a>)</cite>. MNIST allows us to test FedEmbed on a common federated learning test-bed with clear and discrete sub-populations (i.e., digits) <cite class="ltx_cite ltx_citemacro_cite">McMahan et al. (<a href="#bib.bib25" title="" class="ltx_ref">2017</a>); Dinh et al. (<a href="#bib.bib6" title="" class="ltx_ref">2020</a>); Tang et al. (<a href="#bib.bib36" title="" class="ltx_ref">2021</a>)</cite>. Our synthetic speech dataset consists of 12,420 utterances from 20 synthetic voices created by interpolating the parameterized form of voices from eight human speakers using the method in <cite class="ltx_cite ltx_citemacro_citet">Hu et al. (<a href="#bib.bib16" title="" class="ltx_ref">2021</a>)</cite>. All speech samples are transformed into spectrograms. Interpolated voices present a unique challenge, because the sub-populations are less distinct than is the case for MNIST digits. Additionally, the dimensionality of the spectrograms used as input to the networks is larger than that of MNIST images — we trim or pad all spectrograms to be 200x375 compared to 28x28 images for MNIST.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.5" class="ltx_p">For each dataset, we construct a set of simulated users according to a set of rules (see Sections <a href="#S4.SS2" title="4.2 MNIST Experiments ‣ 4 Experiments and Results ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a> and <a href="#S4.SS3" title="4.3 Speaker Preference Experiments ‣ 4 Experiments and Results ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a> for MNIST and speech experiments respectively). Each user has a local dataset, <math id="S4.p2.1.m1.1" class="ltx_Math" alttext="D_{u}" display="inline"><semantics id="S4.p2.1.m1.1a"><msub id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml"><mi id="S4.p2.1.m1.1.1.2" xref="S4.p2.1.m1.1.1.2.cmml">D</mi><mi id="S4.p2.1.m1.1.1.3" xref="S4.p2.1.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><apply id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.1.cmml" xref="S4.p2.1.m1.1.1">subscript</csymbol><ci id="S4.p2.1.m1.1.1.2.cmml" xref="S4.p2.1.m1.1.1.2">𝐷</ci><ci id="S4.p2.1.m1.1.1.3.cmml" xref="S4.p2.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">D_{u}</annotation></semantics></math>, of uniform size, and is assigned to a sub-population <math id="S4.p2.2.m2.1" class="ltx_Math" alttext="k\in[K]" display="inline"><semantics id="S4.p2.2.m2.1a"><mrow id="S4.p2.2.m2.1.2" xref="S4.p2.2.m2.1.2.cmml"><mi id="S4.p2.2.m2.1.2.2" xref="S4.p2.2.m2.1.2.2.cmml">k</mi><mo id="S4.p2.2.m2.1.2.1" xref="S4.p2.2.m2.1.2.1.cmml">∈</mo><mrow id="S4.p2.2.m2.1.2.3.2" xref="S4.p2.2.m2.1.2.3.1.cmml"><mo stretchy="false" id="S4.p2.2.m2.1.2.3.2.1" xref="S4.p2.2.m2.1.2.3.1.1.cmml">[</mo><mi id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml">K</mi><mo stretchy="false" id="S4.p2.2.m2.1.2.3.2.2" xref="S4.p2.2.m2.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><apply id="S4.p2.2.m2.1.2.cmml" xref="S4.p2.2.m2.1.2"><in id="S4.p2.2.m2.1.2.1.cmml" xref="S4.p2.2.m2.1.2.1"></in><ci id="S4.p2.2.m2.1.2.2.cmml" xref="S4.p2.2.m2.1.2.2">𝑘</ci><apply id="S4.p2.2.m2.1.2.3.1.cmml" xref="S4.p2.2.m2.1.2.3.2"><csymbol cd="latexml" id="S4.p2.2.m2.1.2.3.1.1.cmml" xref="S4.p2.2.m2.1.2.3.2.1">delimited-[]</csymbol><ci id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">k\in[K]</annotation></semantics></math>. For MNIST, the user sub-populations correspond to digits, whereas for our speech dataset user sub-populations correspond to a particular interpolated voice. For each sample in <math id="S4.p2.3.m3.1" class="ltx_Math" alttext="D_{u}" display="inline"><semantics id="S4.p2.3.m3.1a"><msub id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml"><mi id="S4.p2.3.m3.1.1.2" xref="S4.p2.3.m3.1.1.2.cmml">D</mi><mi id="S4.p2.3.m3.1.1.3" xref="S4.p2.3.m3.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.1b"><apply id="S4.p2.3.m3.1.1.cmml" xref="S4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p2.3.m3.1.1.1.cmml" xref="S4.p2.3.m3.1.1">subscript</csymbol><ci id="S4.p2.3.m3.1.1.2.cmml" xref="S4.p2.3.m3.1.1.2">𝐷</ci><ci id="S4.p2.3.m3.1.1.3.cmml" xref="S4.p2.3.m3.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.1c">D_{u}</annotation></semantics></math>, if the digit/voice for the sample matches the assigned sub-population preference, <math id="S4.p2.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.p2.4.m4.1a"><mi id="S4.p2.4.m4.1.1" xref="S4.p2.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.p2.4.m4.1b"><ci id="S4.p2.4.m4.1.1.cmml" xref="S4.p2.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.4.m4.1c">k</annotation></semantics></math>, then the sample is labeled positive, otherwise the sample is labeled negative. In our experiments, each user has 30 samples (<math id="S4.p2.5.m5.1" class="ltx_Math" alttext="D_{u}" display="inline"><semantics id="S4.p2.5.m5.1a"><msub id="S4.p2.5.m5.1.1" xref="S4.p2.5.m5.1.1.cmml"><mi id="S4.p2.5.m5.1.1.2" xref="S4.p2.5.m5.1.1.2.cmml">D</mi><mi id="S4.p2.5.m5.1.1.3" xref="S4.p2.5.m5.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.5.m5.1b"><apply id="S4.p2.5.m5.1.1.cmml" xref="S4.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.p2.5.m5.1.1.1.cmml" xref="S4.p2.5.m5.1.1">subscript</csymbol><ci id="S4.p2.5.m5.1.1.2.cmml" xref="S4.p2.5.m5.1.1.2">𝐷</ci><ci id="S4.p2.5.m5.1.1.3.cmml" xref="S4.p2.5.m5.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.5.m5.1c">D_{u}</annotation></semantics></math>), 20 of which are used for training and 10 of which are used for testing. The data for each user are split evenly between positive and negative labels.</p>
</div>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.5" class="ltx_p">In our experiments, we consider single-channel image data. To concatenate a user embedding, <math id="S4.p3.1.m1.1" class="ltx_Math" alttext="\vec{\epsilon}_{u}" display="inline"><semantics id="S4.p3.1.m1.1a"><msub id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml"><mover accent="true" id="S4.p3.1.m1.1.1.2" xref="S4.p3.1.m1.1.1.2.cmml"><mi id="S4.p3.1.m1.1.1.2.2" xref="S4.p3.1.m1.1.1.2.2.cmml">ϵ</mi><mo stretchy="false" id="S4.p3.1.m1.1.1.2.1" xref="S4.p3.1.m1.1.1.2.1.cmml">→</mo></mover><mi id="S4.p3.1.m1.1.1.3" xref="S4.p3.1.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><apply id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p3.1.m1.1.1.1.cmml" xref="S4.p3.1.m1.1.1">subscript</csymbol><apply id="S4.p3.1.m1.1.1.2.cmml" xref="S4.p3.1.m1.1.1.2"><ci id="S4.p3.1.m1.1.1.2.1.cmml" xref="S4.p3.1.m1.1.1.2.1">→</ci><ci id="S4.p3.1.m1.1.1.2.2.cmml" xref="S4.p3.1.m1.1.1.2.2">italic-ϵ</ci></apply><ci id="S4.p3.1.m1.1.1.3.cmml" xref="S4.p3.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">\vec{\epsilon}_{u}</annotation></semantics></math>, of size <math id="S4.p3.2.m2.1" class="ltx_Math" alttext="D_{E}\times 1" display="inline"><semantics id="S4.p3.2.m2.1a"><mrow id="S4.p3.2.m2.1.1" xref="S4.p3.2.m2.1.1.cmml"><msub id="S4.p3.2.m2.1.1.2" xref="S4.p3.2.m2.1.1.2.cmml"><mi id="S4.p3.2.m2.1.1.2.2" xref="S4.p3.2.m2.1.1.2.2.cmml">D</mi><mi id="S4.p3.2.m2.1.1.2.3" xref="S4.p3.2.m2.1.1.2.3.cmml">E</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.p3.2.m2.1.1.1" xref="S4.p3.2.m2.1.1.1.cmml">×</mo><mn id="S4.p3.2.m2.1.1.3" xref="S4.p3.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.2.m2.1b"><apply id="S4.p3.2.m2.1.1.cmml" xref="S4.p3.2.m2.1.1"><times id="S4.p3.2.m2.1.1.1.cmml" xref="S4.p3.2.m2.1.1.1"></times><apply id="S4.p3.2.m2.1.1.2.cmml" xref="S4.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.p3.2.m2.1.1.2.1.cmml" xref="S4.p3.2.m2.1.1.2">subscript</csymbol><ci id="S4.p3.2.m2.1.1.2.2.cmml" xref="S4.p3.2.m2.1.1.2.2">𝐷</ci><ci id="S4.p3.2.m2.1.1.2.3.cmml" xref="S4.p3.2.m2.1.1.2.3">𝐸</ci></apply><cn type="integer" id="S4.p3.2.m2.1.1.3.cmml" xref="S4.p3.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.2.m2.1c">D_{E}\times 1</annotation></semantics></math> with the input data, we concatenate
a given input image, <math id="S4.p3.3.m3.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S4.p3.3.m3.1a"><mi id="S4.p3.3.m3.1.1" xref="S4.p3.3.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S4.p3.3.m3.1b"><ci id="S4.p3.3.m3.1.1.cmml" xref="S4.p3.3.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.3.m3.1c">X</annotation></semantics></math>, with a diagonal matrix, <math id="S4.p3.4.m4.1" class="ltx_Math" alttext="I\vec{\epsilon}_{u}" display="inline"><semantics id="S4.p3.4.m4.1a"><mrow id="S4.p3.4.m4.1.1" xref="S4.p3.4.m4.1.1.cmml"><mi id="S4.p3.4.m4.1.1.2" xref="S4.p3.4.m4.1.1.2.cmml">I</mi><mo lspace="0em" rspace="0em" id="S4.p3.4.m4.1.1.1" xref="S4.p3.4.m4.1.1.1.cmml">​</mo><msub id="S4.p3.4.m4.1.1.3" xref="S4.p3.4.m4.1.1.3.cmml"><mover accent="true" id="S4.p3.4.m4.1.1.3.2" xref="S4.p3.4.m4.1.1.3.2.cmml"><mi id="S4.p3.4.m4.1.1.3.2.2" xref="S4.p3.4.m4.1.1.3.2.2.cmml">ϵ</mi><mo stretchy="false" id="S4.p3.4.m4.1.1.3.2.1" xref="S4.p3.4.m4.1.1.3.2.1.cmml">→</mo></mover><mi id="S4.p3.4.m4.1.1.3.3" xref="S4.p3.4.m4.1.1.3.3.cmml">u</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.4.m4.1b"><apply id="S4.p3.4.m4.1.1.cmml" xref="S4.p3.4.m4.1.1"><times id="S4.p3.4.m4.1.1.1.cmml" xref="S4.p3.4.m4.1.1.1"></times><ci id="S4.p3.4.m4.1.1.2.cmml" xref="S4.p3.4.m4.1.1.2">𝐼</ci><apply id="S4.p3.4.m4.1.1.3.cmml" xref="S4.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.p3.4.m4.1.1.3.1.cmml" xref="S4.p3.4.m4.1.1.3">subscript</csymbol><apply id="S4.p3.4.m4.1.1.3.2.cmml" xref="S4.p3.4.m4.1.1.3.2"><ci id="S4.p3.4.m4.1.1.3.2.1.cmml" xref="S4.p3.4.m4.1.1.3.2.1">→</ci><ci id="S4.p3.4.m4.1.1.3.2.2.cmml" xref="S4.p3.4.m4.1.1.3.2.2">italic-ϵ</ci></apply><ci id="S4.p3.4.m4.1.1.3.3.cmml" xref="S4.p3.4.m4.1.1.3.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.4.m4.1c">I\vec{\epsilon}_{u}</annotation></semantics></math>, where <math id="S4.p3.5.m5.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S4.p3.5.m5.1a"><mi id="S4.p3.5.m5.1.1" xref="S4.p3.5.m5.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.p3.5.m5.1b"><ci id="S4.p3.5.m5.1.1.cmml" xref="S4.p3.5.m5.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.5.m5.1c">I</annotation></semantics></math> is the identity matrix, forming a multi-channel image. This process enables gradient information to back-propagate to the original embedding.</p>
</div>
<div id="S4.p4" class="ltx_para">
<p id="S4.p4.1" class="ltx_p">A centralized model without specialized model heads nor personal embeddings is incapable of fitting the preference datasets, because the label for a sample is conditioned on the user. There is no way to predict the label without information about the user, which could come from a sub-population model head or from a preference embedding.</p>
</div>
<div id="S4.p5" class="ltx_para">
<p id="S4.p5.1" class="ltx_p">For each dataset, we evaluate FedEmbed using average F1 score across all <math id="S4.p5.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.p5.1.m1.1a"><mi id="S4.p5.1.m1.1.1" xref="S4.p5.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.p5.1.m1.1b"><ci id="S4.p5.1.m1.1.1.cmml" xref="S4.p5.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.1.m1.1c">K</annotation></semantics></math> sub-populations in both a class balanced and class imbalanced setting. For the balanced data, all sub-populations are equally represented; for the imbalanced data, we select two sub-populations to be over-represented, while the others are under-represented. The class imbalanced experiments evaluate the robustness of the shared feature encoder and determine whether different approaches to personalized federated learning are well-suited to class imbalanced problems. Finally, we experiment with adding Gaussian differential privacy to all of our experiments <cite class="ltx_cite ltx_citemacro_citep">(Chuanxin et al., <a href="#bib.bib2" title="" class="ltx_ref">2020</a>; Li et al., <a href="#bib.bib23" title="" class="ltx_ref">2020</a>)</cite>, representing, to the best of our knowledge, the first personalized federated learning experiments to feature differential privacy. For all experimental settings we compare FedEmbed, FedEmbed derivatives, and all of our baseline approaches.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Baselines</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">We compare FedEmbed to standard federated averaging, three personalized federated learning frameworks from prior work, and ablations of FedEmbed. Specifically, we compare the approaches outlined in Table <a href="#S4.T1" title="Table 1 ‣ 4.1 Baselines ‣ 4 Experiments and Results ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.3.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S4.T1.4.2" class="ltx_text" style="font-size:90%;">The approaches to personalized private federated learning considered in our work.</span></figcaption>
<table id="S4.T1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.1.2.1" class="ltx_tr">
<th id="S4.T1.1.2.1.1" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T1.1.2.1.1.1" class="ltx_text ltx_font_bold">Global</span></th>
<th id="S4.T1.1.2.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_t">
<span id="S4.T1.1.2.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.1.2.1.2.1.1" class="ltx_p" style="width:341.4pt;">standard federated averaging, with a single model head <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.1.3.1" class="ltx_tr">
<th id="S4.T1.1.3.1.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T1.1.3.1.1.1" class="ltx_text ltx_font_bold">Global+</span></th>
<td id="S4.T1.1.3.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S4.T1.1.3.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.1.3.1.2.1.1" class="ltx_p" style="width:341.4pt;">federated averaging with personal embeddings for each user</span>
</span>
</td>
</tr>
<tr id="S4.T1.1.4.2" class="ltx_tr">
<th id="S4.T1.1.4.2.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T1.1.4.2.1.1" class="ltx_text ltx_font_bold">PFedM</span></th>
<td id="S4.T1.1.4.2.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S4.T1.1.4.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.1.4.2.2.1.1" class="ltx_p" style="width:341.4pt;">a shared feature encoder with <em id="S4.T1.1.4.2.2.1.1.1" class="ltx_emph ltx_font_italic">personal</em> model heads regularized to minimize parameter difference from a global model head <cite class="ltx_cite ltx_citemacro_citep">(Dinh et al., <a href="#bib.bib6" title="" class="ltx_ref">2020</a>)</cite></span>
</span>
</td>
</tr>
<tr id="S4.T1.1.5.3" class="ltx_tr">
<th id="S4.T1.1.5.3.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T1.1.5.3.1.1" class="ltx_text ltx_font_bold">FedRep</span></th>
<td id="S4.T1.1.5.3.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S4.T1.1.5.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.1.5.3.2.1.1" class="ltx_p" style="width:341.4pt;">a shared feature encoder with <em id="S4.T1.1.5.3.2.1.1.1" class="ltx_emph ltx_font_italic">personal</em> model heads and no regularization <cite class="ltx_cite ltx_citemacro_citep">(Collins et al., <a href="#bib.bib3" title="" class="ltx_ref">2021</a>)</cite></span>
</span>
</td>
</tr>
<tr id="S4.T1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T1.1.1.2.1" class="ltx_text ltx_font_bold">PFedKM</span></th>
<td id="S4.T1.1.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.1.1.1.1.1" class="ltx_p" style="width:341.4pt;">a shared feature encoder with sub-population model heads assigned by <math id="S4.T1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.T1.1.1.1.1.1.m1.1a"><mi id="S4.T1.1.1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.1.m1.1b"><ci id="S4.T1.1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.1.m1.1c">K</annotation></semantics></math>-means clustering over user gradients <cite class="ltx_cite ltx_citemacro_citep">(Tang et al., <a href="#bib.bib36" title="" class="ltx_ref">2021</a>)</cite> <span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>Empirically, we found SOM clustering to be more accurate than K-Means, even for PFedKM’s gradient clustering , and so our implementation of PFedKM uses SOM for clustering to provide a fair comparison.</span></span></span></span>
</span>
</td>
</tr>
<tr id="S4.T1.1.6.4" class="ltx_tr">
<th id="S4.T1.1.6.4.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T1.1.6.4.1.1" class="ltx_text ltx_font_bold">FedEmbed-SOM</span></th>
<td id="S4.T1.1.6.4.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S4.T1.1.6.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.1.6.4.2.1.1" class="ltx_p" style="width:341.4pt;">FedEmbed with SOM sub-population assignment</span>
</span>
</td>
</tr>
<tr id="S4.T1.1.7.5" class="ltx_tr">
<th id="S4.T1.1.7.5.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T1.1.7.5.1.1" class="ltx_text ltx_font_bold">FedEmbed-Personal</span></th>
<td id="S4.T1.1.7.5.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S4.T1.1.7.5.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.1.7.5.2.1.1" class="ltx_p" style="width:341.4pt;">FedEmbed with each user assigned to their own personal cluster</span>
</span>
</td>
</tr>
<tr id="S4.T1.1.8.6" class="ltx_tr">
<th id="S4.T1.1.8.6.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T1.1.8.6.1.1" class="ltx_text ltx_font_bold">FedEmbed-Prototype</span></th>
<td id="S4.T1.1.8.6.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S4.T1.1.8.6.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.1.8.6.2.1.1" class="ltx_p" style="width:341.4pt;">FedEmbed with prototype sub-population assignment</span>
</span>
</td>
</tr>
<tr id="S4.T1.1.9.7" class="ltx_tr">
<th id="S4.T1.1.9.7.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T1.1.9.7.1.1" class="ltx_text ltx_font_bold">FedEmbed-Type</span></th>
<td id="S4.T1.1.9.7.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t">
<span id="S4.T1.1.9.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T1.1.9.7.2.1.1" class="ltx_p" style="width:341.4pt;">FedEmbed with the ground-truth preference sub-population for each user</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">FedEmbed-Type provides an estimate on the upper-bound on the performance of FedEmbed, as this removes clustering errors from our approach as we assume the sub-population of each user is known and we assign the user the corresponding model head. FedEmbed-Personal is similar to PFedMe and FedRep, but it includes the addition of personal embeddings for users.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>MNIST Experiments</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">Our MNIST experiments feature 10 sub-populations, one for each unique digit (i.e., a user will label a single digit type positively and all others negatively). We use all 60,000 training MNIST images for a total of 900 users per sub-population, reflecting a real-world federated learning deployment in which each user has only a few labeled samples (making it too small to learn an individual model), but the full dataset is large enough to learn a useful model.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">For our balanced-data experiments, all 10 sub-populations are equally represented. For our imbalanced dataset, type 0 represents 25% of users, type 1 represents 15% of users, types 2–5 are 10% each, and types 6–9 are 5% each, enabling us to examine performance on a clear majority class, and a set of larger and smaller minority classes.</p>
</div>
<section id="S4.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1 </span>MNIST Results</h4>

<figure id="S4.F3" class="ltx_figure"><img src="/html/2202.09472/assets/fig/mnist_confusion.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="164" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S4.F3.3.2" class="ltx_text" style="font-size:90%;">Confusion matrices for ground-truth user preferences and predicted user-preferences using personal embeddings derived from our balanced MNIST dataset. FedEmbed-Prototype perfectly recovers user preferences, and all approaches are able to separate most preferences.</span></figcaption>
</figure>
<div id="S4.SS2.SSS1.p1" class="ltx_para">
<p id="S4.SS2.SSS1.p1.1" class="ltx_p">We present final average F1 scores for all four experiments in Table <a href="#S4.T2" title="Table 2 ‣ 4.2.1 MNIST Results ‣ 4.2 MNIST Experiments ‣ 4 Experiments and Results ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, and preference-assignment confusion matrices in Figure <a href="#S4.F3" title="Figure 3 ‣ 4.2.1 MNIST Results ‣ 4.2 MNIST Experiments ‣ 4 Experiments and Results ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. As expected, FedEmbed-Type presents an upper-bound and exceeds all baselines for both balanced and imbalanced data, with and without differential privacy, achieving between 12% and 41% gains relative to prior work. The performance of all personalization approaches using personal model heads (FedRep, PFedMe, and FedEmbed-Personal) severely deteriorates when differential privacy is added due to insufficient gradient information to overcome the privacy-preserving noise. Finally, we note that Global, Global+, PFedKM, and FedEmbed-SOM appear to improve with imbalanced data relative to balanced data. However, closer examination of their class-wise performance (Table <a href="#A4.T4" title="Table 4 ‣ D.1 MNIST ‣ Appendix D Class-wise Preference Performance on Imbalanced Data ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) shows these methods have fit the most common preference type (i.e., the 25% majority) at the expense of all other preference types.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T2.38.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S4.T2.39.2" class="ltx_text" style="font-size:90%;">Mean and standard deviation F1 scores over five independent trails with MNIST data (bold indicates best)</span></figcaption>
<table id="S4.T2.36" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.36.37.1" class="ltx_tr">
<th id="S4.T2.36.37.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r">Method</th>
<th id="S4.T2.36.37.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" colspan="2">Balanced Data</th>
<th id="S4.T2.36.37.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column" colspan="2">Imbalanced Data</th>
</tr>
<tr id="S4.T2.36.38.2" class="ltx_tr">
<th id="S4.T2.36.38.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t">Privacy</th>
<th id="S4.T2.36.38.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">None</th>
<th id="S4.T2.36.38.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Gaussian</th>
<th id="S4.T2.36.38.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">None</th>
<th id="S4.T2.36.38.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Gaussian</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.4.4" class="ltx_tr">
<th id="S4.T2.4.4.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt">FedRep</th>
<td id="S4.T2.1.1.1" class="ltx_td ltx_align_center ltx_border_tt">0.78 <math id="S4.T2.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.1.1.1.m1.1a"><mo id="S4.T2.1.1.1.m1.1.1" xref="S4.T2.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.1b"><csymbol cd="latexml" id="S4.T2.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.1c">\pm</annotation></semantics></math> 0.02</td>
<td id="S4.T2.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">0.51 <math id="S4.T2.2.2.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.2.2.2.m1.1a"><mo id="S4.T2.2.2.2.m1.1.1" xref="S4.T2.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.m1.1b"><csymbol cd="latexml" id="S4.T2.2.2.2.m1.1.1.cmml" xref="S4.T2.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.m1.1c">\pm</annotation></semantics></math> 0.02</td>
<td id="S4.T2.3.3.3" class="ltx_td ltx_align_center ltx_border_tt">0.78 <math id="S4.T2.3.3.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.3.3.3.m1.1a"><mo id="S4.T2.3.3.3.m1.1.1" xref="S4.T2.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.m1.1b"><csymbol cd="latexml" id="S4.T2.3.3.3.m1.1.1.cmml" xref="S4.T2.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.m1.1c">\pm</annotation></semantics></math> 0.02</td>
<td id="S4.T2.4.4.4" class="ltx_td ltx_align_center ltx_border_tt">0.53 <math id="S4.T2.4.4.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.4.4.4.m1.1a"><mo id="S4.T2.4.4.4.m1.1.1" xref="S4.T2.4.4.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.4.m1.1b"><csymbol cd="latexml" id="S4.T2.4.4.4.m1.1.1.cmml" xref="S4.T2.4.4.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.4.m1.1c">\pm</annotation></semantics></math> 0.01</td>
</tr>
<tr id="S4.T2.8.8" class="ltx_tr">
<th id="S4.T2.8.8.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">PFedMe</th>
<td id="S4.T2.5.5.1" class="ltx_td ltx_align_center">0.76 <math id="S4.T2.5.5.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.5.5.1.m1.1a"><mo id="S4.T2.5.5.1.m1.1.1" xref="S4.T2.5.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.1.m1.1b"><csymbol cd="latexml" id="S4.T2.5.5.1.m1.1.1.cmml" xref="S4.T2.5.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.1.m1.1c">\pm</annotation></semantics></math> 0.04</td>
<td id="S4.T2.6.6.2" class="ltx_td ltx_align_center ltx_border_r">0.50 <math id="S4.T2.6.6.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.6.6.2.m1.1a"><mo id="S4.T2.6.6.2.m1.1.1" xref="S4.T2.6.6.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.6.6.2.m1.1b"><csymbol cd="latexml" id="S4.T2.6.6.2.m1.1.1.cmml" xref="S4.T2.6.6.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.6.2.m1.1c">\pm</annotation></semantics></math> 0.02</td>
<td id="S4.T2.7.7.3" class="ltx_td ltx_align_center">0.76 <math id="S4.T2.7.7.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.7.7.3.m1.1a"><mo id="S4.T2.7.7.3.m1.1.1" xref="S4.T2.7.7.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.7.7.3.m1.1b"><csymbol cd="latexml" id="S4.T2.7.7.3.m1.1.1.cmml" xref="S4.T2.7.7.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.7.3.m1.1c">\pm</annotation></semantics></math> 0.05</td>
<td id="S4.T2.8.8.4" class="ltx_td ltx_align_center">0.50 <math id="S4.T2.8.8.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.8.8.4.m1.1a"><mo id="S4.T2.8.8.4.m1.1.1" xref="S4.T2.8.8.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.8.8.4.m1.1b"><csymbol cd="latexml" id="S4.T2.8.8.4.m1.1.1.cmml" xref="S4.T2.8.8.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.8.4.m1.1c">\pm</annotation></semantics></math> 0.04</td>
</tr>
<tr id="S4.T2.12.12" class="ltx_tr">
<th id="S4.T2.12.12.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">PFedKM</th>
<td id="S4.T2.9.9.1" class="ltx_td ltx_align_center">0.48 <math id="S4.T2.9.9.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.9.9.1.m1.1a"><mo id="S4.T2.9.9.1.m1.1.1" xref="S4.T2.9.9.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.9.9.1.m1.1b"><csymbol cd="latexml" id="S4.T2.9.9.1.m1.1.1.cmml" xref="S4.T2.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.9.9.1.m1.1c">\pm</annotation></semantics></math> 0.00</td>
<td id="S4.T2.10.10.2" class="ltx_td ltx_align_center ltx_border_r">0.49 <math id="S4.T2.10.10.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.10.10.2.m1.1a"><mo id="S4.T2.10.10.2.m1.1.1" xref="S4.T2.10.10.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.10.10.2.m1.1b"><csymbol cd="latexml" id="S4.T2.10.10.2.m1.1.1.cmml" xref="S4.T2.10.10.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.10.10.2.m1.1c">\pm</annotation></semantics></math> 0.00</td>
<td id="S4.T2.11.11.3" class="ltx_td ltx_align_center">0.55 <math id="S4.T2.11.11.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.11.11.3.m1.1a"><mo id="S4.T2.11.11.3.m1.1.1" xref="S4.T2.11.11.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.11.11.3.m1.1b"><csymbol cd="latexml" id="S4.T2.11.11.3.m1.1.1.cmml" xref="S4.T2.11.11.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.11.11.3.m1.1c">\pm</annotation></semantics></math> 0.02</td>
<td id="S4.T2.12.12.4" class="ltx_td ltx_align_center">0.48 <math id="S4.T2.12.12.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.12.12.4.m1.1a"><mo id="S4.T2.12.12.4.m1.1.1" xref="S4.T2.12.12.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.12.12.4.m1.1b"><csymbol cd="latexml" id="S4.T2.12.12.4.m1.1.1.cmml" xref="S4.T2.12.12.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.12.12.4.m1.1c">\pm</annotation></semantics></math> 0.03</td>
</tr>
<tr id="S4.T2.16.16" class="ltx_tr">
<th id="S4.T2.16.16.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Global</th>
<td id="S4.T2.13.13.1" class="ltx_td ltx_align_center">0.40 <math id="S4.T2.13.13.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.13.13.1.m1.1a"><mo id="S4.T2.13.13.1.m1.1.1" xref="S4.T2.13.13.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.13.13.1.m1.1b"><csymbol cd="latexml" id="S4.T2.13.13.1.m1.1.1.cmml" xref="S4.T2.13.13.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.13.13.1.m1.1c">\pm</annotation></semantics></math> 0.02</td>
<td id="S4.T2.14.14.2" class="ltx_td ltx_align_center ltx_border_r">0.38 <math id="S4.T2.14.14.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.14.14.2.m1.1a"><mo id="S4.T2.14.14.2.m1.1.1" xref="S4.T2.14.14.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.14.14.2.m1.1b"><csymbol cd="latexml" id="S4.T2.14.14.2.m1.1.1.cmml" xref="S4.T2.14.14.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.14.14.2.m1.1c">\pm</annotation></semantics></math> 0.06</td>
<td id="S4.T2.15.15.3" class="ltx_td ltx_align_center">0.55 <math id="S4.T2.15.15.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.15.15.3.m1.1a"><mo id="S4.T2.15.15.3.m1.1.1" xref="S4.T2.15.15.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.15.15.3.m1.1b"><csymbol cd="latexml" id="S4.T2.15.15.3.m1.1.1.cmml" xref="S4.T2.15.15.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.15.15.3.m1.1c">\pm</annotation></semantics></math> 0.06</td>
<td id="S4.T2.16.16.4" class="ltx_td ltx_align_center">0.38 <math id="S4.T2.16.16.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.16.16.4.m1.1a"><mo id="S4.T2.16.16.4.m1.1.1" xref="S4.T2.16.16.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.16.16.4.m1.1b"><csymbol cd="latexml" id="S4.T2.16.16.4.m1.1.1.cmml" xref="S4.T2.16.16.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.16.16.4.m1.1c">\pm</annotation></semantics></math> 0.06</td>
</tr>
<tr id="S4.T2.20.20" class="ltx_tr">
<th id="S4.T2.20.20.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Global+</th>
<td id="S4.T2.17.17.1" class="ltx_td ltx_align_center">0.39 <math id="S4.T2.17.17.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.17.17.1.m1.1a"><mo id="S4.T2.17.17.1.m1.1.1" xref="S4.T2.17.17.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.17.17.1.m1.1b"><csymbol cd="latexml" id="S4.T2.17.17.1.m1.1.1.cmml" xref="S4.T2.17.17.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.17.17.1.m1.1c">\pm</annotation></semantics></math> 0.06</td>
<td id="S4.T2.18.18.2" class="ltx_td ltx_align_center ltx_border_r">0.36 <math id="S4.T2.18.18.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.18.18.2.m1.1a"><mo id="S4.T2.18.18.2.m1.1.1" xref="S4.T2.18.18.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.18.18.2.m1.1b"><csymbol cd="latexml" id="S4.T2.18.18.2.m1.1.1.cmml" xref="S4.T2.18.18.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.18.18.2.m1.1c">\pm</annotation></semantics></math> 0.04</td>
<td id="S4.T2.19.19.3" class="ltx_td ltx_align_center">0.54 <math id="S4.T2.19.19.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.19.19.3.m1.1a"><mo id="S4.T2.19.19.3.m1.1.1" xref="S4.T2.19.19.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.19.19.3.m1.1b"><csymbol cd="latexml" id="S4.T2.19.19.3.m1.1.1.cmml" xref="S4.T2.19.19.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.19.19.3.m1.1c">\pm</annotation></semantics></math> 0.08</td>
<td id="S4.T2.20.20.4" class="ltx_td ltx_align_center">0.34 <math id="S4.T2.20.20.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.20.20.4.m1.1a"><mo id="S4.T2.20.20.4.m1.1.1" xref="S4.T2.20.20.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.20.20.4.m1.1b"><csymbol cd="latexml" id="S4.T2.20.20.4.m1.1.1.cmml" xref="S4.T2.20.20.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.20.20.4.m1.1c">\pm</annotation></semantics></math> 0.00</td>
</tr>
<tr id="S4.T2.24.24" class="ltx_tr">
<th id="S4.T2.24.24.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">FedEmbed-Personal</th>
<td id="S4.T2.21.21.1" class="ltx_td ltx_align_center">0.76 <math id="S4.T2.21.21.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.21.21.1.m1.1a"><mo id="S4.T2.21.21.1.m1.1.1" xref="S4.T2.21.21.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.21.21.1.m1.1b"><csymbol cd="latexml" id="S4.T2.21.21.1.m1.1.1.cmml" xref="S4.T2.21.21.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.21.21.1.m1.1c">\pm</annotation></semantics></math> 0.01</td>
<td id="S4.T2.22.22.2" class="ltx_td ltx_align_center ltx_border_r">0.52 <math id="S4.T2.22.22.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.22.22.2.m1.1a"><mo id="S4.T2.22.22.2.m1.1.1" xref="S4.T2.22.22.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.22.22.2.m1.1b"><csymbol cd="latexml" id="S4.T2.22.22.2.m1.1.1.cmml" xref="S4.T2.22.22.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.22.22.2.m1.1c">\pm</annotation></semantics></math> 0.01</td>
<td id="S4.T2.23.23.3" class="ltx_td ltx_align_center">0.73 <math id="S4.T2.23.23.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.23.23.3.m1.1a"><mo id="S4.T2.23.23.3.m1.1.1" xref="S4.T2.23.23.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.23.23.3.m1.1b"><csymbol cd="latexml" id="S4.T2.23.23.3.m1.1.1.cmml" xref="S4.T2.23.23.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.23.23.3.m1.1c">\pm</annotation></semantics></math> 0.02</td>
<td id="S4.T2.24.24.4" class="ltx_td ltx_align_center">0.52 <math id="S4.T2.24.24.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.24.24.4.m1.1a"><mo id="S4.T2.24.24.4.m1.1.1" xref="S4.T2.24.24.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.24.24.4.m1.1b"><csymbol cd="latexml" id="S4.T2.24.24.4.m1.1.1.cmml" xref="S4.T2.24.24.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.24.24.4.m1.1c">\pm</annotation></semantics></math> 0.02</td>
</tr>
<tr id="S4.T2.28.28" class="ltx_tr">
<th id="S4.T2.28.28.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">FedEmbed-SOM</th>
<td id="S4.T2.25.25.1" class="ltx_td ltx_align_center">0.60 <math id="S4.T2.25.25.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.25.25.1.m1.1a"><mo id="S4.T2.25.25.1.m1.1.1" xref="S4.T2.25.25.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.25.25.1.m1.1b"><csymbol cd="latexml" id="S4.T2.25.25.1.m1.1.1.cmml" xref="S4.T2.25.25.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.25.25.1.m1.1c">\pm</annotation></semantics></math> 0.05</td>
<td id="S4.T2.26.26.2" class="ltx_td ltx_align_center ltx_border_r">0.47 <math id="S4.T2.26.26.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.26.26.2.m1.1a"><mo id="S4.T2.26.26.2.m1.1.1" xref="S4.T2.26.26.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.26.26.2.m1.1b"><csymbol cd="latexml" id="S4.T2.26.26.2.m1.1.1.cmml" xref="S4.T2.26.26.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.26.26.2.m1.1c">\pm</annotation></semantics></math> 0.07</td>
<td id="S4.T2.27.27.3" class="ltx_td ltx_align_center">0.69 <math id="S4.T2.27.27.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.27.27.3.m1.1a"><mo id="S4.T2.27.27.3.m1.1.1" xref="S4.T2.27.27.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.27.27.3.m1.1b"><csymbol cd="latexml" id="S4.T2.27.27.3.m1.1.1.cmml" xref="S4.T2.27.27.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.27.27.3.m1.1c">\pm</annotation></semantics></math> 0.02</td>
<td id="S4.T2.28.28.4" class="ltx_td ltx_align_center">0.53 <math id="S4.T2.28.28.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.28.28.4.m1.1a"><mo id="S4.T2.28.28.4.m1.1.1" xref="S4.T2.28.28.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.28.28.4.m1.1b"><csymbol cd="latexml" id="S4.T2.28.28.4.m1.1.1.cmml" xref="S4.T2.28.28.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.28.28.4.m1.1c">\pm</annotation></semantics></math> 0.02</td>
</tr>
<tr id="S4.T2.32.32" class="ltx_tr">
<th id="S4.T2.32.32.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="S4.T2.32.32.5.1" class="ltx_text ltx_font_bold">FedEmbed-Prototype</span></th>
<td id="S4.T2.29.29.1" class="ltx_td ltx_align_center"><span id="S4.T2.29.29.1.1" class="ltx_text ltx_font_bold">0.88 <math id="S4.T2.29.29.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.29.29.1.1.m1.1a"><mo id="S4.T2.29.29.1.1.m1.1.1" xref="S4.T2.29.29.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.29.29.1.1.m1.1b"><csymbol cd="latexml" id="S4.T2.29.29.1.1.m1.1.1.cmml" xref="S4.T2.29.29.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.29.29.1.1.m1.1c">\pm</annotation></semantics></math> 0.02</span></td>
<td id="S4.T2.30.30.2" class="ltx_td ltx_align_center ltx_border_r">0.69 <math id="S4.T2.30.30.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.30.30.2.m1.1a"><mo id="S4.T2.30.30.2.m1.1.1" xref="S4.T2.30.30.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.30.30.2.m1.1b"><csymbol cd="latexml" id="S4.T2.30.30.2.m1.1.1.cmml" xref="S4.T2.30.30.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.30.30.2.m1.1c">\pm</annotation></semantics></math> 0.04</td>
<td id="S4.T2.31.31.3" class="ltx_td ltx_align_center">0.87 <math id="S4.T2.31.31.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.31.31.3.m1.1a"><mo id="S4.T2.31.31.3.m1.1.1" xref="S4.T2.31.31.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.31.31.3.m1.1b"><csymbol cd="latexml" id="S4.T2.31.31.3.m1.1.1.cmml" xref="S4.T2.31.31.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.31.31.3.m1.1c">\pm</annotation></semantics></math> 0.02</td>
<td id="S4.T2.32.32.4" class="ltx_td ltx_align_center">0.69 <math id="S4.T2.32.32.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.32.32.4.m1.1a"><mo id="S4.T2.32.32.4.m1.1.1" xref="S4.T2.32.32.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.32.32.4.m1.1b"><csymbol cd="latexml" id="S4.T2.32.32.4.m1.1.1.cmml" xref="S4.T2.32.32.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.32.32.4.m1.1c">\pm</annotation></semantics></math> 0.05</td>
</tr>
<tr id="S4.T2.36.36" class="ltx_tr">
<th id="S4.T2.36.36.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="S4.T2.36.36.5.1" class="ltx_text ltx_font_bold">FedEmbed-Type</span></th>
<td id="S4.T2.33.33.1" class="ltx_td ltx_align_center"><span id="S4.T2.33.33.1.1" class="ltx_text ltx_font_bold">0.88 <math id="S4.T2.33.33.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.33.33.1.1.m1.1a"><mo id="S4.T2.33.33.1.1.m1.1.1" xref="S4.T2.33.33.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.33.33.1.1.m1.1b"><csymbol cd="latexml" id="S4.T2.33.33.1.1.m1.1.1.cmml" xref="S4.T2.33.33.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.33.33.1.1.m1.1c">\pm</annotation></semantics></math> 0.01</span></td>
<td id="S4.T2.34.34.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.34.34.2.1" class="ltx_text ltx_font_bold">0.72 <math id="S4.T2.34.34.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.34.34.2.1.m1.1a"><mo id="S4.T2.34.34.2.1.m1.1.1" xref="S4.T2.34.34.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.34.34.2.1.m1.1b"><csymbol cd="latexml" id="S4.T2.34.34.2.1.m1.1.1.cmml" xref="S4.T2.34.34.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.34.34.2.1.m1.1c">\pm</annotation></semantics></math> 0.05</span></td>
<td id="S4.T2.35.35.3" class="ltx_td ltx_align_center"><span id="S4.T2.35.35.3.1" class="ltx_text ltx_font_bold">0.88 <math id="S4.T2.35.35.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.35.35.3.1.m1.1a"><mo id="S4.T2.35.35.3.1.m1.1.1" xref="S4.T2.35.35.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.35.35.3.1.m1.1b"><csymbol cd="latexml" id="S4.T2.35.35.3.1.m1.1.1.cmml" xref="S4.T2.35.35.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.35.35.3.1.m1.1c">\pm</annotation></semantics></math> 0.03</span></td>
<td id="S4.T2.36.36.4" class="ltx_td ltx_align_center"><span id="S4.T2.36.36.4.1" class="ltx_text ltx_font_bold">0.77 <math id="S4.T2.36.36.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.36.36.4.1.m1.1a"><mo id="S4.T2.36.36.4.1.m1.1.1" xref="S4.T2.36.36.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.36.36.4.1.m1.1b"><csymbol cd="latexml" id="S4.T2.36.36.4.1.m1.1.1.cmml" xref="S4.T2.36.36.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.36.36.4.1.m1.1c">\pm</annotation></semantics></math> 0.05</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Speaker Preference Experiments</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">Our synthetic speech experiments use a population of 900 split into 20 sub-populations, one for each synthetic voice (i.e., a user will label one voice positively and all others negatively, regardless of the spoken words). This presents a significantly more challenging problem than our MNIST experiment. The objective is to assess a scenario where user preferences are not necessarily distinct — in our case, two different voice-types might be two different mixtures of the same source voices.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">For our balanced dataset experiments, all 20 sub-populations are represented with the same number of users. For our imbalanced dataset, voice 0 is preferred by 20% of the users, voice 5 is preferred by 8% of the users, and all other voices are preferred 4% of the time, again presenting a comparison between one clear majority class, a larger minority, and a long tail of minority classes.</p>
</div>
<section id="S4.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1 </span>Speaker Preference Results</h4>

<div id="S4.SS3.SSS1.p1" class="ltx_para">
<p id="S4.SS3.SSS1.p1.1" class="ltx_p">Table <a href="#S4.T3" title="Table 3 ‣ 4.3.1 Speaker Preference Results ‣ 4.3 Speaker Preference Experiments ‣ 4 Experiments and Results ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows mean and standard deviation F1 scores for our four speaker-preference experiments (balanced/imbalanced, with/without differential privacy), and preference-assignment confusion matrics are given in Figure <a href="#A5.F5" title="Figure 5 ‣ Appendix E Speaker Preference Clustering Results ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. Across the board, performance on the speaker-preference data is lower than on the MNIST dataset, signaling the significant increase in dataset-difficulty. As in the MNIST experiments, we observe FedEmbed-Type and FedEmbed-Prototype exceed all other personalized federated learning approaches both with and without differential privacy, achieving between 15% and 35% improvements relative to prior work. We again observe that Gaussian differential privacy adversely affects performance, with the F1 score for all baselines dropping below 0.5. As in the MNIST experiments, only approaches with effective grouping of similar users (i.e., FedEmbed-Prototype and FedEmbed-Type) overcome the noise of differential privacy to learn a useful model that personalizes. Finally, we again note an apparent increase in performance when the dataset is imbalanced. As in the MNIST results, we observe that this can be attributed to the models fitting the most populous classes at the expense of the under-represented preferences (Table <a href="#A4.T5" title="Table 5 ‣ D.2 Speaker Preference ‣ Appendix D Class-wise Preference Performance on Imbalanced Data ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>).</p>
</div>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T3.38.1.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="S4.T3.39.2" class="ltx_text" style="font-size:90%;">Mean and standard deviation F1 scores for five independent runs with speech data (bold indicates best)</span></figcaption>
<table id="S4.T3.36" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.36.37.1" class="ltx_tr">
<th id="S4.T3.36.37.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r">Method</th>
<th id="S4.T3.36.37.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" colspan="2">Balanced Data</th>
<th id="S4.T3.36.37.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column" colspan="2">Imbalanced Data</th>
</tr>
<tr id="S4.T3.36.38.2" class="ltx_tr">
<th id="S4.T3.36.38.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t">Privacy</th>
<th id="S4.T3.36.38.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">None</th>
<th id="S4.T3.36.38.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Gaussian</th>
<th id="S4.T3.36.38.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">None</th>
<th id="S4.T3.36.38.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Gaussian</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.4.4" class="ltx_tr">
<th id="S4.T3.4.4.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt">FedRep</th>
<td id="S4.T3.1.1.1" class="ltx_td ltx_align_center ltx_border_tt">0.52 <math id="S4.T3.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.1.1.1.m1.1a"><mo id="S4.T3.1.1.1.m1.1.1" xref="S4.T3.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.m1.1b"><csymbol cd="latexml" id="S4.T3.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.1.1.1.m1.1c">\pm</annotation></semantics></math> 0.09</td>
<td id="S4.T3.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">0.49 <math id="S4.T3.2.2.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.2.2.2.m1.1a"><mo id="S4.T3.2.2.2.m1.1.1" xref="S4.T3.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.2.2.2.m1.1b"><csymbol cd="latexml" id="S4.T3.2.2.2.m1.1.1.cmml" xref="S4.T3.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.2.2.m1.1c">\pm</annotation></semantics></math> 0.00</td>
<td id="S4.T3.3.3.3" class="ltx_td ltx_align_center ltx_border_tt">0.65 <math id="S4.T3.3.3.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.3.3.3.m1.1a"><mo id="S4.T3.3.3.3.m1.1.1" xref="S4.T3.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.3.3.3.m1.1b"><csymbol cd="latexml" id="S4.T3.3.3.3.m1.1.1.cmml" xref="S4.T3.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.3.3.m1.1c">\pm</annotation></semantics></math> 0.10</td>
<td id="S4.T3.4.4.4" class="ltx_td ltx_align_center ltx_border_tt">0.49 <math id="S4.T3.4.4.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.4.4.4.m1.1a"><mo id="S4.T3.4.4.4.m1.1.1" xref="S4.T3.4.4.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.4.4.4.m1.1b"><csymbol cd="latexml" id="S4.T3.4.4.4.m1.1.1.cmml" xref="S4.T3.4.4.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.4.4.m1.1c">\pm</annotation></semantics></math> 0.00</td>
</tr>
<tr id="S4.T3.8.8" class="ltx_tr">
<th id="S4.T3.8.8.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">PFedMe</th>
<td id="S4.T3.5.5.1" class="ltx_td ltx_align_center">0.57 <math id="S4.T3.5.5.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.5.5.1.m1.1a"><mo id="S4.T3.5.5.1.m1.1.1" xref="S4.T3.5.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.5.5.1.m1.1b"><csymbol cd="latexml" id="S4.T3.5.5.1.m1.1.1.cmml" xref="S4.T3.5.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.5.5.1.m1.1c">\pm</annotation></semantics></math> 0.05</td>
<td id="S4.T3.6.6.2" class="ltx_td ltx_align_center ltx_border_r">0.49 <math id="S4.T3.6.6.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.6.6.2.m1.1a"><mo id="S4.T3.6.6.2.m1.1.1" xref="S4.T3.6.6.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.6.6.2.m1.1b"><csymbol cd="latexml" id="S4.T3.6.6.2.m1.1.1.cmml" xref="S4.T3.6.6.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.6.6.2.m1.1c">\pm</annotation></semantics></math> 0.01</td>
<td id="S4.T3.7.7.3" class="ltx_td ltx_align_center">0.57 <math id="S4.T3.7.7.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.7.7.3.m1.1a"><mo id="S4.T3.7.7.3.m1.1.1" xref="S4.T3.7.7.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.7.7.3.m1.1b"><csymbol cd="latexml" id="S4.T3.7.7.3.m1.1.1.cmml" xref="S4.T3.7.7.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.7.7.3.m1.1c">\pm</annotation></semantics></math> 0.05</td>
<td id="S4.T3.8.8.4" class="ltx_td ltx_align_center">0.49 <math id="S4.T3.8.8.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.8.8.4.m1.1a"><mo id="S4.T3.8.8.4.m1.1.1" xref="S4.T3.8.8.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.8.8.4.m1.1b"><csymbol cd="latexml" id="S4.T3.8.8.4.m1.1.1.cmml" xref="S4.T3.8.8.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.8.8.4.m1.1c">\pm</annotation></semantics></math> 0.03</td>
</tr>
<tr id="S4.T3.12.12" class="ltx_tr">
<th id="S4.T3.12.12.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">PFedKM</th>
<td id="S4.T3.9.9.1" class="ltx_td ltx_align_center">0.49 <math id="S4.T3.9.9.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.9.9.1.m1.1a"><mo id="S4.T3.9.9.1.m1.1.1" xref="S4.T3.9.9.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.9.9.1.m1.1b"><csymbol cd="latexml" id="S4.T3.9.9.1.m1.1.1.cmml" xref="S4.T3.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.9.9.1.m1.1c">\pm</annotation></semantics></math> 0.02</td>
<td id="S4.T3.10.10.2" class="ltx_td ltx_align_center ltx_border_r">0.49 <math id="S4.T3.10.10.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.10.10.2.m1.1a"><mo id="S4.T3.10.10.2.m1.1.1" xref="S4.T3.10.10.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.10.10.2.m1.1b"><csymbol cd="latexml" id="S4.T3.10.10.2.m1.1.1.cmml" xref="S4.T3.10.10.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.10.10.2.m1.1c">\pm</annotation></semantics></math> 0.01</td>
<td id="S4.T3.11.11.3" class="ltx_td ltx_align_center">0.49 <math id="S4.T3.11.11.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.11.11.3.m1.1a"><mo id="S4.T3.11.11.3.m1.1.1" xref="S4.T3.11.11.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.11.11.3.m1.1b"><csymbol cd="latexml" id="S4.T3.11.11.3.m1.1.1.cmml" xref="S4.T3.11.11.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.11.11.3.m1.1c">\pm</annotation></semantics></math> 0.01</td>
<td id="S4.T3.12.12.4" class="ltx_td ltx_align_center">0.49 <math id="S4.T3.12.12.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.12.12.4.m1.1a"><mo id="S4.T3.12.12.4.m1.1.1" xref="S4.T3.12.12.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.12.12.4.m1.1b"><csymbol cd="latexml" id="S4.T3.12.12.4.m1.1.1.cmml" xref="S4.T3.12.12.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.12.12.4.m1.1c">\pm</annotation></semantics></math> 0.00</td>
</tr>
<tr id="S4.T3.16.16" class="ltx_tr">
<th id="S4.T3.16.16.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Global</th>
<td id="S4.T3.13.13.1" class="ltx_td ltx_align_center">0.34 <math id="S4.T3.13.13.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.13.13.1.m1.1a"><mo id="S4.T3.13.13.1.m1.1.1" xref="S4.T3.13.13.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.13.13.1.m1.1b"><csymbol cd="latexml" id="S4.T3.13.13.1.m1.1.1.cmml" xref="S4.T3.13.13.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.13.13.1.m1.1c">\pm</annotation></semantics></math> 0.01</td>
<td id="S4.T3.14.14.2" class="ltx_td ltx_align_center ltx_border_r">0.38 <math id="S4.T3.14.14.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.14.14.2.m1.1a"><mo id="S4.T3.14.14.2.m1.1.1" xref="S4.T3.14.14.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.14.14.2.m1.1b"><csymbol cd="latexml" id="S4.T3.14.14.2.m1.1.1.cmml" xref="S4.T3.14.14.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.14.14.2.m1.1c">\pm</annotation></semantics></math> 0.06</td>
<td id="S4.T3.15.15.3" class="ltx_td ltx_align_center">0.44 <math id="S4.T3.15.15.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.15.15.3.m1.1a"><mo id="S4.T3.15.15.3.m1.1.1" xref="S4.T3.15.15.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.15.15.3.m1.1b"><csymbol cd="latexml" id="S4.T3.15.15.3.m1.1.1.cmml" xref="S4.T3.15.15.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.15.15.3.m1.1c">\pm</annotation></semantics></math> 0.05</td>
<td id="S4.T3.16.16.4" class="ltx_td ltx_align_center">0.34 <math id="S4.T3.16.16.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.16.16.4.m1.1a"><mo id="S4.T3.16.16.4.m1.1.1" xref="S4.T3.16.16.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.16.16.4.m1.1b"><csymbol cd="latexml" id="S4.T3.16.16.4.m1.1.1.cmml" xref="S4.T3.16.16.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.16.16.4.m1.1c">\pm</annotation></semantics></math> 0.02</td>
</tr>
<tr id="S4.T3.20.20" class="ltx_tr">
<th id="S4.T3.20.20.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Global+</th>
<td id="S4.T3.17.17.1" class="ltx_td ltx_align_center">0.35 <math id="S4.T3.17.17.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.17.17.1.m1.1a"><mo id="S4.T3.17.17.1.m1.1.1" xref="S4.T3.17.17.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.17.17.1.m1.1b"><csymbol cd="latexml" id="S4.T3.17.17.1.m1.1.1.cmml" xref="S4.T3.17.17.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.17.17.1.m1.1c">\pm</annotation></semantics></math> 0.01</td>
<td id="S4.T3.18.18.2" class="ltx_td ltx_align_center ltx_border_r">0.33 <math id="S4.T3.18.18.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.18.18.2.m1.1a"><mo id="S4.T3.18.18.2.m1.1.1" xref="S4.T3.18.18.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.18.18.2.m1.1b"><csymbol cd="latexml" id="S4.T3.18.18.2.m1.1.1.cmml" xref="S4.T3.18.18.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.18.18.2.m1.1c">\pm</annotation></semantics></math> 0.00</td>
<td id="S4.T3.19.19.3" class="ltx_td ltx_align_center">0.42 <math id="S4.T3.19.19.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.19.19.3.m1.1a"><mo id="S4.T3.19.19.3.m1.1.1" xref="S4.T3.19.19.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.19.19.3.m1.1b"><csymbol cd="latexml" id="S4.T3.19.19.3.m1.1.1.cmml" xref="S4.T3.19.19.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.19.19.3.m1.1c">\pm</annotation></semantics></math> 0.12</td>
<td id="S4.T3.20.20.4" class="ltx_td ltx_align_center">0.33 <math id="S4.T3.20.20.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.20.20.4.m1.1a"><mo id="S4.T3.20.20.4.m1.1.1" xref="S4.T3.20.20.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.20.20.4.m1.1b"><csymbol cd="latexml" id="S4.T3.20.20.4.m1.1.1.cmml" xref="S4.T3.20.20.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.20.20.4.m1.1c">\pm</annotation></semantics></math> 0.00</td>
</tr>
<tr id="S4.T3.24.24" class="ltx_tr">
<th id="S4.T3.24.24.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">FedEmbed-Personal</th>
<td id="S4.T3.21.21.1" class="ltx_td ltx_align_center">0.63 <math id="S4.T3.21.21.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.21.21.1.m1.1a"><mo id="S4.T3.21.21.1.m1.1.1" xref="S4.T3.21.21.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.21.21.1.m1.1b"><csymbol cd="latexml" id="S4.T3.21.21.1.m1.1.1.cmml" xref="S4.T3.21.21.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.21.21.1.m1.1c">\pm</annotation></semantics></math> 0.02</td>
<td id="S4.T3.22.22.2" class="ltx_td ltx_align_center ltx_border_r">0.44 <math id="S4.T3.22.22.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.22.22.2.m1.1a"><mo id="S4.T3.22.22.2.m1.1.1" xref="S4.T3.22.22.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.22.22.2.m1.1b"><csymbol cd="latexml" id="S4.T3.22.22.2.m1.1.1.cmml" xref="S4.T3.22.22.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.22.22.2.m1.1c">\pm</annotation></semantics></math> 0.05</td>
<td id="S4.T3.23.23.3" class="ltx_td ltx_align_center">0.68 <math id="S4.T3.23.23.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.23.23.3.m1.1a"><mo id="S4.T3.23.23.3.m1.1.1" xref="S4.T3.23.23.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.23.23.3.m1.1b"><csymbol cd="latexml" id="S4.T3.23.23.3.m1.1.1.cmml" xref="S4.T3.23.23.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.23.23.3.m1.1c">\pm</annotation></semantics></math> 0.01</td>
<td id="S4.T3.24.24.4" class="ltx_td ltx_align_center">0.49 <math id="S4.T3.24.24.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.24.24.4.m1.1a"><mo id="S4.T3.24.24.4.m1.1.1" xref="S4.T3.24.24.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.24.24.4.m1.1b"><csymbol cd="latexml" id="S4.T3.24.24.4.m1.1.1.cmml" xref="S4.T3.24.24.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.24.24.4.m1.1c">\pm</annotation></semantics></math> 0.00</td>
</tr>
<tr id="S4.T3.28.28" class="ltx_tr">
<th id="S4.T3.28.28.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">FedEmbed-SOM</th>
<td id="S4.T3.25.25.1" class="ltx_td ltx_align_center">0.51 <math id="S4.T3.25.25.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.25.25.1.m1.1a"><mo id="S4.T3.25.25.1.m1.1.1" xref="S4.T3.25.25.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.25.25.1.m1.1b"><csymbol cd="latexml" id="S4.T3.25.25.1.m1.1.1.cmml" xref="S4.T3.25.25.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.25.25.1.m1.1c">\pm</annotation></semantics></math> 0.02</td>
<td id="S4.T3.26.26.2" class="ltx_td ltx_align_center ltx_border_r">0.47 <math id="S4.T3.26.26.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.26.26.2.m1.1a"><mo id="S4.T3.26.26.2.m1.1.1" xref="S4.T3.26.26.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.26.26.2.m1.1b"><csymbol cd="latexml" id="S4.T3.26.26.2.m1.1.1.cmml" xref="S4.T3.26.26.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.26.26.2.m1.1c">\pm</annotation></semantics></math> 0.07</td>
<td id="S4.T3.27.27.3" class="ltx_td ltx_align_center">0.54 <math id="S4.T3.27.27.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.27.27.3.m1.1a"><mo id="S4.T3.27.27.3.m1.1.1" xref="S4.T3.27.27.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.27.27.3.m1.1b"><csymbol cd="latexml" id="S4.T3.27.27.3.m1.1.1.cmml" xref="S4.T3.27.27.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.27.27.3.m1.1c">\pm</annotation></semantics></math> 0.03</td>
<td id="S4.T3.28.28.4" class="ltx_td ltx_align_center">0.47 <math id="S4.T3.28.28.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.28.28.4.m1.1a"><mo id="S4.T3.28.28.4.m1.1.1" xref="S4.T3.28.28.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.28.28.4.m1.1b"><csymbol cd="latexml" id="S4.T3.28.28.4.m1.1.1.cmml" xref="S4.T3.28.28.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.28.28.4.m1.1c">\pm</annotation></semantics></math> 0.02</td>
</tr>
<tr id="S4.T3.32.32" class="ltx_tr">
<th id="S4.T3.32.32.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="S4.T3.32.32.5.1" class="ltx_text ltx_font_bold">FedEmbed-Prototype</span></th>
<td id="S4.T3.29.29.1" class="ltx_td ltx_align_center"><span id="S4.T3.29.29.1.1" class="ltx_text ltx_font_bold">0.78 <math id="S4.T3.29.29.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.29.29.1.1.m1.1a"><mo id="S4.T3.29.29.1.1.m1.1.1" xref="S4.T3.29.29.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.29.29.1.1.m1.1b"><csymbol cd="latexml" id="S4.T3.29.29.1.1.m1.1.1.cmml" xref="S4.T3.29.29.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.29.29.1.1.m1.1c">\pm</annotation></semantics></math> 0.01</span></td>
<td id="S4.T3.30.30.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T3.30.30.2.1" class="ltx_text ltx_font_bold">0.61 <math id="S4.T3.30.30.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.30.30.2.1.m1.1a"><mo id="S4.T3.30.30.2.1.m1.1.1" xref="S4.T3.30.30.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.30.30.2.1.m1.1b"><csymbol cd="latexml" id="S4.T3.30.30.2.1.m1.1.1.cmml" xref="S4.T3.30.30.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.30.30.2.1.m1.1c">\pm</annotation></semantics></math> 0.06</span></td>
<td id="S4.T3.31.31.3" class="ltx_td ltx_align_center">0.63 <math id="S4.T3.31.31.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.31.31.3.m1.1a"><mo id="S4.T3.31.31.3.m1.1.1" xref="S4.T3.31.31.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.31.31.3.m1.1b"><csymbol cd="latexml" id="S4.T3.31.31.3.m1.1.1.cmml" xref="S4.T3.31.31.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.31.31.3.m1.1c">\pm</annotation></semantics></math> 0.07</td>
<td id="S4.T3.32.32.4" class="ltx_td ltx_align_center">0.53 <math id="S4.T3.32.32.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.32.32.4.m1.1a"><mo id="S4.T3.32.32.4.m1.1.1" xref="S4.T3.32.32.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.32.32.4.m1.1b"><csymbol cd="latexml" id="S4.T3.32.32.4.m1.1.1.cmml" xref="S4.T3.32.32.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.32.32.4.m1.1c">\pm</annotation></semantics></math> 0.06</td>
</tr>
<tr id="S4.T3.36.36" class="ltx_tr">
<th id="S4.T3.36.36.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="S4.T3.36.36.5.1" class="ltx_text ltx_font_bold">FedEmbed-Type</span></th>
<td id="S4.T3.33.33.1" class="ltx_td ltx_align_center"><span id="S4.T3.33.33.1.1" class="ltx_text ltx_font_bold">0.78 <math id="S4.T3.33.33.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.33.33.1.1.m1.1a"><mo id="S4.T3.33.33.1.1.m1.1.1" xref="S4.T3.33.33.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.33.33.1.1.m1.1b"><csymbol cd="latexml" id="S4.T3.33.33.1.1.m1.1.1.cmml" xref="S4.T3.33.33.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.33.33.1.1.m1.1c">\pm</annotation></semantics></math> 0.05</span></td>
<td id="S4.T3.34.34.2" class="ltx_td ltx_align_center ltx_border_r">0.60 <math id="S4.T3.34.34.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.34.34.2.m1.1a"><mo id="S4.T3.34.34.2.m1.1.1" xref="S4.T3.34.34.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.34.34.2.m1.1b"><csymbol cd="latexml" id="S4.T3.34.34.2.m1.1.1.cmml" xref="S4.T3.34.34.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.34.34.2.m1.1c">\pm</annotation></semantics></math> 0.08</td>
<td id="S4.T3.35.35.3" class="ltx_td ltx_align_center"><span id="S4.T3.35.35.3.1" class="ltx_text ltx_font_bold">0.76 <math id="S4.T3.35.35.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.35.35.3.1.m1.1a"><mo id="S4.T3.35.35.3.1.m1.1.1" xref="S4.T3.35.35.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.35.35.3.1.m1.1b"><csymbol cd="latexml" id="S4.T3.35.35.3.1.m1.1.1.cmml" xref="S4.T3.35.35.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.35.35.3.1.m1.1c">\pm</annotation></semantics></math> 0.00</span></td>
<td id="S4.T3.36.36.4" class="ltx_td ltx_align_center"><span id="S4.T3.36.36.4.1" class="ltx_text ltx_font_bold">0.56 <math id="S4.T3.36.36.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.36.36.4.1.m1.1a"><mo id="S4.T3.36.36.4.1.m1.1.1" xref="S4.T3.36.36.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.36.36.4.1.m1.1b"><csymbol cd="latexml" id="S4.T3.36.36.4.1.m1.1.1.cmml" xref="S4.T3.36.36.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.36.36.4.1.m1.1c">\pm</annotation></semantics></math> 0.08</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Discussion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">Comparing with existing work, we observe that FedEmbed offers improvements over the state of the art in private federated learning when personalizing models. While previous approaches, such as PFedMe and FedRep, offer useful advances for personalized federated learning, no prior approach offers accurate personalization with differential privacy. By enabling private personalized federated learning, FedEmbed represents an advancement for private and personalized federated learning.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">FedEmbed further improves performance for under-represented sub-populations relative to all baseline approaches. While a global approach may appear successful on over-represented classes, existing approaches reduce performance for under-represented classes. Our results suggest that fairness (i.e., equitable performance) in federated learning has a long way to go, but that intelligently grouping related users can, in part, mitigate this problem and provide improved performance for under-represented classes (Table <a href="#A4.T4" title="Table 4 ‣ D.1 MNIST ‣ Appendix D Class-wise Preference Performance on Imbalanced Data ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) even with a shared feature encoder.</p>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.1" class="ltx_p">By ablating FedEmbed’s component contributions, we see how FedEmbed compares to baselines and identify the components of FedEmbed that contribute most to its performance. As noted above, FedEmbed-Personal is similar to FedRep and PFedMe, while Global+ is similar to Global with the addition of personal embeddings. Across these comparisons, we see that personal embeddings on their own do not make a difference on the simpler MNIST task as performance is comparable for methods with and without personal embeddings. On the more challenging speaker-preference task, we observe a more pronounced difference between methods with and without personal embeddings, with FedEmbed-Personal outperforming baselines by nearly 20% on the balanced dataset without differential privacy. This result suggests that the personal embeddings in FedEmbed provide performance benefits for more challenging problems, but on simpler problems the benefits can be attributed to meaningful sub-group assignment by clustering personal embeddings.</p>
</div>
<div id="S5.p4" class="ltx_para">
<p id="S5.p4.1" class="ltx_p">The clustering results from our MNIST dataset (Figure <a href="#S4.F3" title="Figure 3 ‣ 4.2.1 MNIST Results ‣ 4.2 MNIST Experiments ‣ 4 Experiments and Results ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) suggest that all embedding-based approaches (i.e., Global+, FedEmbed-Personal, FedEmbed-SOM, and FedEmbed-Prototype) should discover similar user sub-groups and have the same ability to accurately cluster users to the appropriate sub-groups. This result suggests that an approach like Global+ can achieve similar performance to FedEmbed, if the global model learns to condition on the personal embedding. However, we observe that Global+ performs significantly worse than FedEmbed approaches.</p>
</div>
<div id="S5.p5" class="ltx_para">
<p id="S5.p5.1" class="ltx_p">Results from our speaker-preference dataset (Figure <a href="#A5.F5" title="Figure 5 ‣ Appendix E Speaker Preference Clustering Results ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>) help to shed light on the discrepancy in performance between embedding-based approaches. The speaker-preference results suggest that less-structured approaches (i.e. Global+, FedEmbed-SOM, and FedEmbed-Personal) are significantly worse at accurately clustering users. This disparity in cluster assignment may help to explain the disparity in mean F1 performance between FedEmbed-Prototype and other techniques (Tables <a href="#S4.T2" title="Table 2 ‣ 4.2.1 MNIST Results ‣ 4.2 MNIST Experiments ‣ 4 Experiments and Results ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> and <a href="#S4.T3" title="Table 3 ‣ 4.3.1 Speaker Preference Results ‣ 4.3 Speaker Preference Experiments ‣ 4 Experiments and Results ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>). Techniques with less prior knowledge may assign users to the wrong sub-populations and therefore train model-heads on conflicting preference labels. For example, Global+ and FedEmbed-SOM have no prototypical user information, potentially leading these approaches to form inaccurate clusters and impede the learning process. This result may have only appeared in the speaker-preference task because the speech data has much higher dimensionality and represents twice as many classes as MNIST.</p>
</div>
<div id="S5.p6" class="ltx_para">
<p id="S5.p6.1" class="ltx_p">Considering SOM- and prototype-assignment to ground-truth types, we see the importance of correctly clustering users. Ground-truth assignment is almost always the best, while naive clustering with SOM is consistently the least reliable approach, having little prior knowledge to solve the unsupervised learning problem. Despite the under-performance of FedEmbed-SOM, we find FedEmbed-SOM far exceeds PFedKM both in performance and runtime. Because PFedKM clusters gradients for an entire federated learning model, the approach is extremely slow, memory-demanding, and computationally intensive. FedEmbed-SOM is faster and performs better than PFedKM, as personal embeddings are easier to cluster than entire models. Finally, we observe that prototype assignment (FedEmbed-Prototype) works well, often performance is close to the ground-truth type assignment (FedEmbed-Type).</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Limitations and Future Work</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">While FedEmbed represents a significant step forward for private and personalized federated learning, there are limitations that must be addressed in future work. First, we assume knowledge of at least the number of sub-populations within our global population (for FedEmbed-SOM), or access to a prototypical member of each sub-population (for FedEmbed-Prototype). While such data could be captured through a small user study, observation, or discussions with domain experts, it does represent an area for improvement. In follow-up experiments, we determined that overestimating the number of clusters (e.g., looking for 20 types of MNIST users instead of 10) did not adversely affect performance, but more study is needed in this area.</p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.1" class="ltx_p">Second, we observe that the performance of FedEmbed deteriorates as class representation declines and Gaussian privacy is enabled. While FedEmbed preserves under-represented class performance better than alternative methods, there is room to improve for under-represented sub-populations. We believe FedEmbed can offer a path to improved fairness in federated learning, though such improvements must be carefully monitored to ensure that overall performance gains are reflected in improvements across all classes. Our results show that naive SOM-assignment does not work as well as prototype-assignment for imbalanced data, indicating that domain-knowledge about the distribution of users will yield improved results.</p>
</div>
<div id="S6.p3" class="ltx_para">
<p id="S6.p3.1" class="ltx_p">Finally, FedEmbed inherently assigns users to sub-populations that will maximize the number of positive predictions for their preferred type. This assignment could present problems with users who change preferences over time, or for whom a sub-population does not yet exist (e.g., the user does not like monotone or emotive speech, but the robot expects only those two preference types). Future work will study ways to improve personalization over time, techiques to capture changes in preferences over time, and methods to discover new sub-populations over time.</p>
</div>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusions</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">We have presented FedEmbed, a new approach to personalized federated learning by clustering related users into sub-populations that share a model head, rather than assigning each user their own unique model head or averaging over all preferences. We showed that such clustering enables more robust preference learning for balanced and imbalanced datasets, outperforming baselines when considering under-represented sub-populations. We showed that FedEmbed learns preferences when applying differential privacy, unlike our baselines. We presented an ablation of FedEmbed examining the effects of different clustering approaches and showing that prototype-assignment perfectly recovers user preferences. Finally, we outlined areas for future work to improve personalized federated learning, such as removing clustering assumptions or improved preference learning over time.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Arivazhagan et al. (2019)</span>
<span class="ltx_bibblock">
Manoj Ghuhan Arivazhagan, Vinay Aggarwal, Aaditya Kumar Singh, and Sunav
Choudhary.

</span>
<span class="ltx_bibblock">Federated learning with personalization layers.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1912.00818</em>, 2019.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chuanxin et al. (2020)</span>
<span class="ltx_bibblock">
Zhou Chuanxin, Sun Yi, and Wang Degang.

</span>
<span class="ltx_bibblock">Federated learning with gaussian differential privacy.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2020 2nd International Conference on
Robotics, Intelligent Control and Artificial Intelligence</em>, pp.  296–301,
2020.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Collins et al. (2021)</span>
<span class="ltx_bibblock">
Liam Collins, Hamed Hassani, Aryan Mokhtari, and Sanjay Shakkottai.

</span>
<span class="ltx_bibblock">Exploiting shared representations for personalized federated
learning.

</span>
<span class="ltx_bibblock">In Marina Meila and Tong Zhang (eds.), <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 38th
International Conference on Machine Learning</em>, volume 139 of
<em id="bib.bib3.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>, pp.  2089–2099, 18–24 Jul
2021.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cui et al. (2017)</span>
<span class="ltx_bibblock">
Xiaodong Cui, Vaibhava Goel, and George Saon.

</span>
<span class="ltx_bibblock">Embedding-based speaker adaptive training of deep neural networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1710.06937</em>, 2017.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al. (2020)</span>
<span class="ltx_bibblock">
Yuyang Deng, Mohammad Mahdi Kamani, and Mehrdad Mahdavi.

</span>
<span class="ltx_bibblock">Adaptive personalized federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2003.13461</em>, 2020.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dinh et al. (2020)</span>
<span class="ltx_bibblock">
Canh T Dinh, Nguyen H Tran, and Tuan Dung Nguyen.

</span>
<span class="ltx_bibblock">Personalized federated learning with moreau envelopes.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2006.08848</em>, 2020.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dwork et al. (2006a)</span>
<span class="ltx_bibblock">
Cynthia Dwork, Krishnaram Kenthapadi, Frank McSherry, Ilya Mironov, and Moni
Naor.

</span>
<span class="ltx_bibblock">Our data, ourselves: Privacy via distributed noise generation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Annual International Conference on the Theory and
Applications of Cryptographic Techniques</em>, pp.  486–503. Springer,
2006a.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dwork et al. (2006b)</span>
<span class="ltx_bibblock">
Cynthia Dwork, Frank McSherry, Kobbi Nissim, and Adam Smith.

</span>
<span class="ltx_bibblock">Calibrating noise to sensitivity in private data analysis.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Theory of cryptography conference</em>, pp.  265–284.
Springer, 2006b.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Finn et al. (2017)</span>
<span class="ltx_bibblock">
Chelsea Finn, Pieter Abbeel, and Sergey Levine.

</span>
<span class="ltx_bibblock">Model-agnostic meta-learning for fast adaptation of deep networks.

</span>
<span class="ltx_bibblock">In Doina Precup and Yee Whye Teh (eds.), <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proceedings of the
34th International Conference on Machine Learning</em>, volume 70 of
<em id="bib.bib9.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>, pp.  1126–1135, 06–11 Aug
2017.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gerke et al. (2019)</span>
<span class="ltx_bibblock">
Sara Gerke, Timo Minssen, Helen Yu, and I Glenn Cohen.

</span>
<span class="ltx_bibblock">Ethical and legal issues of ingestible electronic sensors.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Nature Electronics</em>, 2(8):329–334, 2019.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gerke et al. (2020)</span>
<span class="ltx_bibblock">
Sara Gerke, Timo Minssen, and Glenn Cohen.

</span>
<span class="ltx_bibblock">Ethical and legal challenges of artificial intelligence-driven
healthcare.

</span>
<span class="ltx_bibblock">In <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence in healthcare</em>, pp.  295–336.
Elsevier, 2020.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gupta &amp; Raskar (2018)</span>
<span class="ltx_bibblock">
Otkrist Gupta and Ramesh Raskar.

</span>
<span class="ltx_bibblock">Distributed learning of deep neural network over multiple agents.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Journal of Network and Computer Applications</em>, 116:1–8, 2018.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hanzely &amp; Richtárik (2020)</span>
<span class="ltx_bibblock">
Filip Hanzely and Peter Richtárik.

</span>
<span class="ltx_bibblock">Federated learning of a mixture of global and local models.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.05516</em>, 2020.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hanzely et al. (2020)</span>
<span class="ltx_bibblock">
Filip Hanzely, Slavomír Hanzely, Samuel Horváth, and Peter
Richtárik.

</span>
<span class="ltx_bibblock">Lower bounds and optimal algorithms for personalized federated
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2010.02372</em>, 2020.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsiao et al. (2019)</span>
<span class="ltx_bibblock">
Fang-I Hsiao, Jui-Hsuan Kuo, and Min Sun.

</span>
<span class="ltx_bibblock">Learning a multi-modal policy via imitating demonstrations with mixed
behaviors.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1903.10304</em>, 2019.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2021)</span>
<span class="ltx_bibblock">
Ting-Yao Hu, Ashish Shrivastava, Jen-Hao Rick Chang, Hema Koppula, Stefan
Braun, Kyuyeon Hwang, Ozlem Kalinli, and Oncel Tuzel.

</span>
<span class="ltx_bibblock">Sapaugment: Learning a sample adaptive policy for data augmentation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">ICASSP 2021 - 2021 IEEE International Conference on
Acoustics, Speech and Signal Processing (ICASSP)</em>, pp.  4040–4044, 2021.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/ICASSP39728.2021.9413928</span>.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jain et al. (2021)</span>
<span class="ltx_bibblock">
Prateek Jain, Keith Rush, Adam Smith, Shuang Song, and Abhradeep Thuakurta.

</span>
<span class="ltx_bibblock">Differentially private model personalization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
volume 35, 2021.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2019)</span>
<span class="ltx_bibblock">
Yihan Jiang, Jakub Konečnỳ, Keith Rush, and Sreeram Kannan.

</span>
<span class="ltx_bibblock">Improving federated learning personalization via model agnostic meta
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1909.12488</em>, 2019.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al. (2021)</span>
<span class="ltx_bibblock">
Joongheon Kim, Seunghoon Park, Soyi Jung, and Seehwan Yoo.

</span>
<span class="ltx_bibblock">Spatio-temporal split learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">2021 51st Annual IEEE/IFIP International Conference on
Dependable Systems and Networks-Supplemental Volume (DSN-S)</em>, pp.  11–12.
IEEE, 2021.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kohonen (1990)</span>
<span class="ltx_bibblock">
Teuvo Kohonen.

</span>
<span class="ltx_bibblock">The self-organizing map.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE</em>, 78(9):1464–1480,
1990.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">LeCun et al. (1989)</span>
<span class="ltx_bibblock">
Yann LeCun, Bernhard Boser, John Denker, Donnie Henderson, Richard Howard,
Wayne Hubbard, and Lawrence Jackel.

</span>
<span class="ltx_bibblock">Handwritten digit recognition with a back-propagation network.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 2, 1989.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li &amp; Wang (2019)</span>
<span class="ltx_bibblock">
Daliang Li and Junpu Wang.

</span>
<span class="ltx_bibblock">Fedmd: Heterogenous federated learning via model distillation.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1910.03581</em>, 2019.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020)</span>
<span class="ltx_bibblock">
Yiwei Li, Tsung-Hui Chang, and Chong-Yung Chi.

</span>
<span class="ltx_bibblock">Secure federated averaging algorithm with differential privacy.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">2020 IEEE 30th International Workshop on Machine Learning
for Signal Processing (MLSP)</em>, pp.  1–6. IEEE, 2020.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">MacQueen et al. (1967)</span>
<span class="ltx_bibblock">
James MacQueen et al.

</span>
<span class="ltx_bibblock">Some methods for classification and analysis of multivariate
observations.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Proceedings of the fifth Berkeley symposium on mathematical
statistics and probability</em>, pp.  281–297, 1967.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera
y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence and statistics</em>, pp.  1273–1282.
PMLR, 2017.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Metcalf et al. (2019)</span>
<span class="ltx_bibblock">
Katherine Metcalf, Barry-John Theobald, Garrett Weinberg, Robert Lee, Ing-Marie
Jonsson, Russ Webb, and Nicholas Apostoloff.

</span>
<span class="ltx_bibblock">Mirroring to build trust in digital assistants.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1904.01664</em>, 2019.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nichol et al. (2018)</span>
<span class="ltx_bibblock">
Alex Nichol, Joshua Achiam, and John Schulman.

</span>
<span class="ltx_bibblock">On first-order meta-learning algorithms.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1803.02999</em>, 2018.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paleja et al. (2020)</span>
<span class="ltx_bibblock">
Rohan Paleja, Andrew Silva, Letian Chen, and Matthew Gombolay.

</span>
<span class="ltx_bibblock">Interpretable and personalized apprenticeship scheduling: Learning
interpretable scheduling policies from heterogeneous user demonstrations.

</span>
<span class="ltx_bibblock">In H. Larochelle, M. Ranzato, R. Hadsell, M. F. Balcan, and H. Lin
(eds.), <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, volume 33,
pp.  6417–6428. Curran Associates, Inc., 2020.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paulik et al. (2021)</span>
<span class="ltx_bibblock">
Matthias Paulik, Matt Seigel, Henry Mason, Dominic Telaar, Joris Kluivers,
Rogier van Dalen, Chi Wai Lau, Luke Carlson, Filip Granqvist, Chris
Vandevelde, et al.

</span>
<span class="ltx_bibblock">Federated evaluation and tuning for on-device personalization: System
design &amp; applications.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2102.08503</em>, 2021.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Roberts et al. (2017)</span>
<span class="ltx_bibblock">
Jessica L Roberts, I Glenn Cohen, Christopher R Deubert, and Holly Fernandez
Lynch.

</span>
<span class="ltx_bibblock">Evaluating nfl player health and performance: legal and ethical
issues.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">University of Pennsylvania Law Review</em>, pp.  227–314, 2017.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rownicka et al. (2019)</span>
<span class="ltx_bibblock">
Joanna Rownicka, Peter Bell, and Steve Renals.

</span>
<span class="ltx_bibblock">Embeddings for dnn speaker adaptive training.

</span>
<span class="ltx_bibblock">In <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">2019 IEEE Automatic Speech Recognition and Understanding
Workshop (ASRU)</em>, pp.  479–486. IEEE, 2019.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rudovic et al. (2021)</span>
<span class="ltx_bibblock">
Ognjen Rudovic, Nicolas Tobis, Sebastian Kaltwang, Björn Schuller, Daniel
Rueckert, Jeffrey F Cohn, and Rosalind W Picard.

</span>
<span class="ltx_bibblock">Personalized federated deep learning for pain estimation from face
images.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2101.04800</em>, 2021.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Smith et al. (2017)</span>
<span class="ltx_bibblock">
Virginia Smith, Chao-Kai Chiang, Maziar Sanjabi, and Ameet Talwalkar.

</span>
<span class="ltx_bibblock">Federated multi-task learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1705.10467</em>, 2017.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Snell et al. (2017)</span>
<span class="ltx_bibblock">
Jake Snell, Kevin Swersky, and Richard S Zemel.

</span>
<span class="ltx_bibblock">Prototypical networks for few-shot learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1703.05175</em>, 2017.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tamar et al. (2018)</span>
<span class="ltx_bibblock">
Aviv Tamar, Khashayar Rohanimanesh, Yinlam Chow, Chris Vigorito, Ben Goodrich,
Michael Kahane, and Derik Pridmore.

</span>
<span class="ltx_bibblock">Imitation learning from visual data with multiple intentions.

</span>
<span class="ltx_bibblock">In <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2018.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang et al. (2021)</span>
<span class="ltx_bibblock">
Xueyang Tang, Song Guo, and Jingcai Guo.

</span>
<span class="ltx_bibblock">Personalized federated learning with clustered generalization.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2106.13044</em>, 2021.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2019)</span>
<span class="ltx_bibblock">
Zirui Wang, Zihang Dai, Barnabás Póczos, and Jaime Carbonell.

</span>
<span class="ltx_bibblock">Characterizing and avoiding negative transfer.

</span>
<span class="ltx_bibblock">In <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, pp.  11293–11302, 2019.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Weinberger et al. (2005)</span>
<span class="ltx_bibblock">
Kilian Q Weinberger, John Blitzer, and Lawrence Saul.

</span>
<span class="ltx_bibblock">Distance metric learning for large margin nearest neighbor
classification.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 18, 2005.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zen et al. (2019)</span>
<span class="ltx_bibblock">
Heiga Zen, Rob Clark, Ron J. Weiss, Viet Dang, Ye Jia, Yonghui Wu, Yu Zhang,
and Zhifeng Chen.

</span>
<span class="ltx_bibblock">Libritts: A corpus derived from librispeech for text-to-speech.

</span>
<span class="ltx_bibblock">In <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Interspeech</em>, 2019.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>FedEmbed Algorithm</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p">To more clearly explain the learning and update procedures for FedEmbed, in Algorithm <a href="#alg1" title="Algorithm 1 ‣ Appendix A FedEmbed Algorithm ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> we present an algorithmic overview of the update process. Our training process is repeated here from the main paper, but now annotated by lines in Algorithm <a href="#alg1" title="Algorithm 1 ‣ Appendix A FedEmbed Algorithm ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> for improved clarity.</p>
</div>
<div id="A1.p2" class="ltx_para">
<p id="A1.p2.6" class="ltx_p">At the beginning of each training update, clients pull down the latest set of model parameters <math id="A1.p2.1.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="A1.p2.1.m1.1a"><mi id="A1.p2.1.m1.1.1" xref="A1.p2.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="A1.p2.1.m1.1b"><ci id="A1.p2.1.m1.1.1.cmml" xref="A1.p2.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.1.m1.1c">\theta</annotation></semantics></math> and <math id="A1.p2.2.m2.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="A1.p2.2.m2.1a"><mi id="A1.p2.2.m2.1.1" xref="A1.p2.2.m2.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="A1.p2.2.m2.1b"><ci id="A1.p2.2.m2.1.1.cmml" xref="A1.p2.2.m2.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.2.m2.1c">\phi</annotation></semantics></math> from the server (Algorithm <a href="#alg1" title="Algorithm 1 ‣ Appendix A FedEmbed Algorithm ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>: line 6). Each client <math id="A1.p2.3.m3.1" class="ltx_Math" alttext="u\in[U]" display="inline"><semantics id="A1.p2.3.m3.1a"><mrow id="A1.p2.3.m3.1.2" xref="A1.p2.3.m3.1.2.cmml"><mi id="A1.p2.3.m3.1.2.2" xref="A1.p2.3.m3.1.2.2.cmml">u</mi><mo id="A1.p2.3.m3.1.2.1" xref="A1.p2.3.m3.1.2.1.cmml">∈</mo><mrow id="A1.p2.3.m3.1.2.3.2" xref="A1.p2.3.m3.1.2.3.1.cmml"><mo stretchy="false" id="A1.p2.3.m3.1.2.3.2.1" xref="A1.p2.3.m3.1.2.3.1.1.cmml">[</mo><mi id="A1.p2.3.m3.1.1" xref="A1.p2.3.m3.1.1.cmml">U</mi><mo stretchy="false" id="A1.p2.3.m3.1.2.3.2.2" xref="A1.p2.3.m3.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.3.m3.1b"><apply id="A1.p2.3.m3.1.2.cmml" xref="A1.p2.3.m3.1.2"><in id="A1.p2.3.m3.1.2.1.cmml" xref="A1.p2.3.m3.1.2.1"></in><ci id="A1.p2.3.m3.1.2.2.cmml" xref="A1.p2.3.m3.1.2.2">𝑢</ci><apply id="A1.p2.3.m3.1.2.3.1.cmml" xref="A1.p2.3.m3.1.2.3.2"><csymbol cd="latexml" id="A1.p2.3.m3.1.2.3.1.1.cmml" xref="A1.p2.3.m3.1.2.3.2.1">delimited-[]</csymbol><ci id="A1.p2.3.m3.1.1.cmml" xref="A1.p2.3.m3.1.1">𝑈</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.3.m3.1c">u\in[U]</annotation></semantics></math> first identifies which model-head to use for inference and training (Algorithm <a href="#alg1" title="Algorithm 1 ‣ Appendix A FedEmbed Algorithm ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>: lines 8–14). This model-head selection can be accomplished through the SOM-assignment process or prototype assignment. Once a client has selected a model head, the client calculates gradient updates for <math id="A1.p2.4.m4.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="A1.p2.4.m4.1a"><mi id="A1.p2.4.m4.1.1" xref="A1.p2.4.m4.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="A1.p2.4.m4.1b"><ci id="A1.p2.4.m4.1.1.cmml" xref="A1.p2.4.m4.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.4.m4.1c">\theta</annotation></semantics></math> and their model head, <math id="A1.p2.5.m5.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="A1.p2.5.m5.1a"><mi id="A1.p2.5.m5.1.1" xref="A1.p2.5.m5.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="A1.p2.5.m5.1b"><ci id="A1.p2.5.m5.1.1.cmml" xref="A1.p2.5.m5.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.5.m5.1c">\phi</annotation></semantics></math>, using their local dataset, <math id="A1.p2.6.m6.1" class="ltx_Math" alttext="D_{u}" display="inline"><semantics id="A1.p2.6.m6.1a"><msub id="A1.p2.6.m6.1.1" xref="A1.p2.6.m6.1.1.cmml"><mi id="A1.p2.6.m6.1.1.2" xref="A1.p2.6.m6.1.1.2.cmml">D</mi><mi id="A1.p2.6.m6.1.1.3" xref="A1.p2.6.m6.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p2.6.m6.1b"><apply id="A1.p2.6.m6.1.1.cmml" xref="A1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="A1.p2.6.m6.1.1.1.cmml" xref="A1.p2.6.m6.1.1">subscript</csymbol><ci id="A1.p2.6.m6.1.1.2.cmml" xref="A1.p2.6.m6.1.1.2">𝐷</ci><ci id="A1.p2.6.m6.1.1.3.cmml" xref="A1.p2.6.m6.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.6.m6.1c">D_{u}</annotation></semantics></math> (Algorithm <a href="#alg1" title="Algorithm 1 ‣ Appendix A FedEmbed Algorithm ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>: lines 15–21). Note that the client maintains zero-gradients for model-heads they do not use. After finishing the gradient calculation, the client can optionally add differential privacy to their computed gradients before sending them back to the server.</p>
</div>
<div id="A1.p3" class="ltx_para">
<p id="A1.p3.2" class="ltx_p">After all clients have computed gradients and pushed them to the server, the central server averages <math id="A1.p3.1.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="A1.p3.1.m1.1a"><mi id="A1.p3.1.m1.1.1" xref="A1.p3.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="A1.p3.1.m1.1b"><ci id="A1.p3.1.m1.1.1.cmml" xref="A1.p3.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.1.m1.1c">\theta</annotation></semantics></math> and <math id="A1.p3.2.m2.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="A1.p3.2.m2.1a"><mi id="A1.p3.2.m2.1.1" xref="A1.p3.2.m2.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="A1.p3.2.m2.1b"><ci id="A1.p3.2.m2.1.1.cmml" xref="A1.p3.2.m2.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.2.m2.1c">\phi</annotation></semantics></math> gradients, again optionally adding differential privacy to the result (Algorithm <a href="#alg1" title="Algorithm 1 ‣ Appendix A FedEmbed Algorithm ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>: lines 24–26). The server then applies the gradient steps to the shared feature encoder parameters and the model-head parameters (Algorithm <a href="#alg1" title="Algorithm 1 ‣ Appendix A FedEmbed Algorithm ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>: lines 27–2), and the process repeats.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> FedEmbed Training Procedure</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="algx1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  <span id="algx1.l1.2" class="ltx_text ltx_font_bold">Given:</span> Classification objective, <math id="algx1.l1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{C}" display="inline"><semantics id="algx1.l1.m1.1a"><msub id="algx1.l1.m1.1.1" xref="algx1.l1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algx1.l1.m1.1.1.2" xref="algx1.l1.m1.1.1.2.cmml">ℒ</mi><mi id="algx1.l1.m1.1.1.3" xref="algx1.l1.m1.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="algx1.l1.m1.1b"><apply id="algx1.l1.m1.1.1.cmml" xref="algx1.l1.m1.1.1"><csymbol cd="ambiguous" id="algx1.l1.m1.1.1.1.cmml" xref="algx1.l1.m1.1.1">subscript</csymbol><ci id="algx1.l1.m1.1.1.2.cmml" xref="algx1.l1.m1.1.1.2">ℒ</ci><ci id="algx1.l1.m1.1.1.3.cmml" xref="algx1.l1.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l1.m1.1c">\mathcal{L}_{C}</annotation></semantics></math>, Mode-prediction objective, <math id="algx1.l1.m2.1" class="ltx_Math" alttext="\mathcal{L}_{M}" display="inline"><semantics id="algx1.l1.m2.1a"><msub id="algx1.l1.m2.1.1" xref="algx1.l1.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algx1.l1.m2.1.1.2" xref="algx1.l1.m2.1.1.2.cmml">ℒ</mi><mi id="algx1.l1.m2.1.1.3" xref="algx1.l1.m2.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="algx1.l1.m2.1b"><apply id="algx1.l1.m2.1.1.cmml" xref="algx1.l1.m2.1.1"><csymbol cd="ambiguous" id="algx1.l1.m2.1.1.1.cmml" xref="algx1.l1.m2.1.1">subscript</csymbol><ci id="algx1.l1.m2.1.1.2.cmml" xref="algx1.l1.m2.1.1.2">ℒ</ci><ci id="algx1.l1.m2.1.1.3.cmml" xref="algx1.l1.m2.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l1.m2.1c">\mathcal{L}_{M}</annotation></semantics></math>, Learning rate <math id="algx1.l1.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="algx1.l1.m3.1a"><mi id="algx1.l1.m3.1.1" xref="algx1.l1.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="algx1.l1.m3.1b"><ci id="algx1.l1.m3.1.1.cmml" xref="algx1.l1.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l1.m3.1c">\alpha</annotation></semantics></math>

</div>
<div id="algx1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  <span id="algx1.l2.2" class="ltx_text ltx_font_bold">Server Initializes:</span> Global encoder, <math id="algx1.l2.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="algx1.l2.m1.1a"><mi id="algx1.l2.m1.1.1" xref="algx1.l2.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="algx1.l2.m1.1b"><ci id="algx1.l2.m1.1.1.cmml" xref="algx1.l2.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l2.m1.1c">\theta</annotation></semantics></math>, <math id="algx1.l2.m2.1" class="ltx_Math" alttext="\phi_{k}" display="inline"><semantics id="algx1.l2.m2.1a"><msub id="algx1.l2.m2.1.1" xref="algx1.l2.m2.1.1.cmml"><mi id="algx1.l2.m2.1.1.2" xref="algx1.l2.m2.1.1.2.cmml">ϕ</mi><mi id="algx1.l2.m2.1.1.3" xref="algx1.l2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="algx1.l2.m2.1b"><apply id="algx1.l2.m2.1.1.cmml" xref="algx1.l2.m2.1.1"><csymbol cd="ambiguous" id="algx1.l2.m2.1.1.1.cmml" xref="algx1.l2.m2.1.1">subscript</csymbol><ci id="algx1.l2.m2.1.1.2.cmml" xref="algx1.l2.m2.1.1.2">italic-ϕ</ci><ci id="algx1.l2.m2.1.1.3.cmml" xref="algx1.l2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l2.m2.1c">\phi_{k}</annotation></semantics></math> model heads,

</div>
<div id="algx1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>  <span id="algx1.l3.2" class="ltx_text ltx_font_bold">Clustering Initialization:</span> SOM <math id="algx1.l3.m1.1" class="ltx_Math" alttext="\Psi" display="inline"><semantics id="algx1.l3.m1.1a"><mi mathvariant="normal" id="algx1.l3.m1.1.1" xref="algx1.l3.m1.1.1.cmml">Ψ</mi><annotation-xml encoding="MathML-Content" id="algx1.l3.m1.1b"><ci id="algx1.l3.m1.1.1.cmml" xref="algx1.l3.m1.1.1">Ψ</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l3.m1.1c">\Psi</annotation></semantics></math> or Prototype Embeddings <math id="algx1.l3.m2.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="algx1.l3.m2.1a"><mi class="ltx_font_mathcaligraphic" id="algx1.l3.m2.1.1" xref="algx1.l3.m2.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="algx1.l3.m2.1b"><ci id="algx1.l3.m2.1.1.cmml" xref="algx1.l3.m2.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l3.m2.1c">\mathcal{E}</annotation></semantics></math>

</div>
<div id="algx1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>  <span id="algx1.l4.2" class="ltx_text ltx_font_bold">Client Initializes:</span> Personal embedding, <math id="algx1.l4.m1.1" class="ltx_Math" alttext="\vec{\epsilon}_{u}" display="inline"><semantics id="algx1.l4.m1.1a"><msub id="algx1.l4.m1.1.1" xref="algx1.l4.m1.1.1.cmml"><mover accent="true" id="algx1.l4.m1.1.1.2" xref="algx1.l4.m1.1.1.2.cmml"><mi id="algx1.l4.m1.1.1.2.2" xref="algx1.l4.m1.1.1.2.2.cmml">ϵ</mi><mo stretchy="false" id="algx1.l4.m1.1.1.2.1" xref="algx1.l4.m1.1.1.2.1.cmml">→</mo></mover><mi id="algx1.l4.m1.1.1.3" xref="algx1.l4.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="algx1.l4.m1.1b"><apply id="algx1.l4.m1.1.1.cmml" xref="algx1.l4.m1.1.1"><csymbol cd="ambiguous" id="algx1.l4.m1.1.1.1.cmml" xref="algx1.l4.m1.1.1">subscript</csymbol><apply id="algx1.l4.m1.1.1.2.cmml" xref="algx1.l4.m1.1.1.2"><ci id="algx1.l4.m1.1.1.2.1.cmml" xref="algx1.l4.m1.1.1.2.1">→</ci><ci id="algx1.l4.m1.1.1.2.2.cmml" xref="algx1.l4.m1.1.1.2.2">italic-ϵ</ci></apply><ci id="algx1.l4.m1.1.1.3.cmml" xref="algx1.l4.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l4.m1.1c">\vec{\epsilon}_{u}</annotation></semantics></math>

</div>
<div id="algx1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>  <span id="algx1.l5.2" class="ltx_text ltx_font_bold">while</span> Training: <span id="algx1.l5.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="algx1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>     Clients pull down <math id="algx1.l6.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="algx1.l6.m1.1a"><mi id="algx1.l6.m1.1.1" xref="algx1.l6.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="algx1.l6.m1.1b"><ci id="algx1.l6.m1.1.1.cmml" xref="algx1.l6.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l6.m1.1c">\theta</annotation></semantics></math> and <math id="algx1.l6.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="algx1.l6.m2.1a"><mi id="algx1.l6.m2.1.1" xref="algx1.l6.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="algx1.l6.m2.1b"><ci id="algx1.l6.m2.1.1.cmml" xref="algx1.l6.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l6.m2.1c">k</annotation></semantics></math> model heads
<span id="algx1.l6.2" class="ltx_text ltx_font_bold">Client Update</span>

</div>
<div id="algx1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>     <span id="algx1.l7.2" class="ltx_text ltx_font_bold">Given: </span> Local user dataset, <math id="algx1.l7.m1.1" class="ltx_Math" alttext="D_{u}" display="inline"><semantics id="algx1.l7.m1.1a"><msub id="algx1.l7.m1.1.1" xref="algx1.l7.m1.1.1.cmml"><mi id="algx1.l7.m1.1.1.2" xref="algx1.l7.m1.1.1.2.cmml">D</mi><mi id="algx1.l7.m1.1.1.3" xref="algx1.l7.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="algx1.l7.m1.1b"><apply id="algx1.l7.m1.1.1.cmml" xref="algx1.l7.m1.1.1"><csymbol cd="ambiguous" id="algx1.l7.m1.1.1.1.cmml" xref="algx1.l7.m1.1.1">subscript</csymbol><ci id="algx1.l7.m1.1.1.2.cmml" xref="algx1.l7.m1.1.1.2">𝐷</ci><ci id="algx1.l7.m1.1.1.3.cmml" xref="algx1.l7.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l7.m1.1c">D_{u}</annotation></semantics></math>

</div>
<div id="algx1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>     <span id="algx1.l8.2" class="ltx_text ltx_font_bold">if</span> Prototype-assignment <span id="algx1.l8.3" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="algx1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>        Identify <math id="algx1.l9.m1.1" class="ltx_Math" alttext="\vec{\epsilon}_{p}" display="inline"><semantics id="algx1.l9.m1.1a"><msub id="algx1.l9.m1.1.1" xref="algx1.l9.m1.1.1.cmml"><mover accent="true" id="algx1.l9.m1.1.1.2" xref="algx1.l9.m1.1.1.2.cmml"><mi id="algx1.l9.m1.1.1.2.2" xref="algx1.l9.m1.1.1.2.2.cmml">ϵ</mi><mo stretchy="false" id="algx1.l9.m1.1.1.2.1" xref="algx1.l9.m1.1.1.2.1.cmml">→</mo></mover><mi id="algx1.l9.m1.1.1.3" xref="algx1.l9.m1.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="algx1.l9.m1.1b"><apply id="algx1.l9.m1.1.1.cmml" xref="algx1.l9.m1.1.1"><csymbol cd="ambiguous" id="algx1.l9.m1.1.1.1.cmml" xref="algx1.l9.m1.1.1">subscript</csymbol><apply id="algx1.l9.m1.1.1.2.cmml" xref="algx1.l9.m1.1.1.2"><ci id="algx1.l9.m1.1.1.2.1.cmml" xref="algx1.l9.m1.1.1.2.1">→</ci><ci id="algx1.l9.m1.1.1.2.2.cmml" xref="algx1.l9.m1.1.1.2.2">italic-ϵ</ci></apply><ci id="algx1.l9.m1.1.1.3.cmml" xref="algx1.l9.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l9.m1.1c">\vec{\epsilon}_{p}</annotation></semantics></math> from <math id="algx1.l9.m2.1" class="ltx_Math" alttext="D_{u}" display="inline"><semantics id="algx1.l9.m2.1a"><msub id="algx1.l9.m2.1.1" xref="algx1.l9.m2.1.1.cmml"><mi id="algx1.l9.m2.1.1.2" xref="algx1.l9.m2.1.1.2.cmml">D</mi><mi id="algx1.l9.m2.1.1.3" xref="algx1.l9.m2.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="algx1.l9.m2.1b"><apply id="algx1.l9.m2.1.1.cmml" xref="algx1.l9.m2.1.1"><csymbol cd="ambiguous" id="algx1.l9.m2.1.1.1.cmml" xref="algx1.l9.m2.1.1">subscript</csymbol><ci id="algx1.l9.m2.1.1.2.cmml" xref="algx1.l9.m2.1.1.2">𝐷</ci><ci id="algx1.l9.m2.1.1.3.cmml" xref="algx1.l9.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l9.m2.1c">D_{u}</annotation></semantics></math>, sample <math id="algx1.l9.m3.1" class="ltx_Math" alttext="\vec{\epsilon}_{n}" display="inline"><semantics id="algx1.l9.m3.1a"><msub id="algx1.l9.m3.1.1" xref="algx1.l9.m3.1.1.cmml"><mover accent="true" id="algx1.l9.m3.1.1.2" xref="algx1.l9.m3.1.1.2.cmml"><mi id="algx1.l9.m3.1.1.2.2" xref="algx1.l9.m3.1.1.2.2.cmml">ϵ</mi><mo stretchy="false" id="algx1.l9.m3.1.1.2.1" xref="algx1.l9.m3.1.1.2.1.cmml">→</mo></mover><mi id="algx1.l9.m3.1.1.3" xref="algx1.l9.m3.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="algx1.l9.m3.1b"><apply id="algx1.l9.m3.1.1.cmml" xref="algx1.l9.m3.1.1"><csymbol cd="ambiguous" id="algx1.l9.m3.1.1.1.cmml" xref="algx1.l9.m3.1.1">subscript</csymbol><apply id="algx1.l9.m3.1.1.2.cmml" xref="algx1.l9.m3.1.1.2"><ci id="algx1.l9.m3.1.1.2.1.cmml" xref="algx1.l9.m3.1.1.2.1">→</ci><ci id="algx1.l9.m3.1.1.2.2.cmml" xref="algx1.l9.m3.1.1.2.2">italic-ϵ</ci></apply><ci id="algx1.l9.m3.1.1.3.cmml" xref="algx1.l9.m3.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l9.m3.1c">\vec{\epsilon}_{n}</annotation></semantics></math> from <math id="algx1.l9.m4.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="algx1.l9.m4.1a"><mi class="ltx_font_mathcaligraphic" id="algx1.l9.m4.1.1" xref="algx1.l9.m4.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="algx1.l9.m4.1b"><ci id="algx1.l9.m4.1.1.cmml" xref="algx1.l9.m4.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l9.m4.1c">\mathcal{E}</annotation></semantics></math>

</div>
<div id="algx1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>        <math id="algx1.l10.m1.3" class="ltx_Math" alttext="\vec{\epsilon}_{u}\leftarrow\vec{\epsilon}_{u}+\nabla_{\vec{\epsilon}_{u}}L(\vec{\epsilon}_{u},\vec{\epsilon}_{p},\vec{\epsilon}_{n})" display="inline"><semantics id="algx1.l10.m1.3a"><mrow id="algx1.l10.m1.3.3" xref="algx1.l10.m1.3.3.cmml"><msub id="algx1.l10.m1.3.3.5" xref="algx1.l10.m1.3.3.5.cmml"><mover accent="true" id="algx1.l10.m1.3.3.5.2" xref="algx1.l10.m1.3.3.5.2.cmml"><mi id="algx1.l10.m1.3.3.5.2.2" xref="algx1.l10.m1.3.3.5.2.2.cmml">ϵ</mi><mo stretchy="false" id="algx1.l10.m1.3.3.5.2.1" xref="algx1.l10.m1.3.3.5.2.1.cmml">→</mo></mover><mi id="algx1.l10.m1.3.3.5.3" xref="algx1.l10.m1.3.3.5.3.cmml">u</mi></msub><mo stretchy="false" id="algx1.l10.m1.3.3.4" xref="algx1.l10.m1.3.3.4.cmml">←</mo><mrow id="algx1.l10.m1.3.3.3" xref="algx1.l10.m1.3.3.3.cmml"><msub id="algx1.l10.m1.3.3.3.5" xref="algx1.l10.m1.3.3.3.5.cmml"><mover accent="true" id="algx1.l10.m1.3.3.3.5.2" xref="algx1.l10.m1.3.3.3.5.2.cmml"><mi id="algx1.l10.m1.3.3.3.5.2.2" xref="algx1.l10.m1.3.3.3.5.2.2.cmml">ϵ</mi><mo stretchy="false" id="algx1.l10.m1.3.3.3.5.2.1" xref="algx1.l10.m1.3.3.3.5.2.1.cmml">→</mo></mover><mi id="algx1.l10.m1.3.3.3.5.3" xref="algx1.l10.m1.3.3.3.5.3.cmml">u</mi></msub><mo id="algx1.l10.m1.3.3.3.4" xref="algx1.l10.m1.3.3.3.4.cmml">+</mo><mrow id="algx1.l10.m1.3.3.3.3" xref="algx1.l10.m1.3.3.3.3.cmml"><mrow id="algx1.l10.m1.3.3.3.3.5" xref="algx1.l10.m1.3.3.3.3.5.cmml"><msub id="algx1.l10.m1.3.3.3.3.5.1" xref="algx1.l10.m1.3.3.3.3.5.1.cmml"><mo rspace="0.167em" id="algx1.l10.m1.3.3.3.3.5.1.2" xref="algx1.l10.m1.3.3.3.3.5.1.2.cmml">∇</mo><msub id="algx1.l10.m1.3.3.3.3.5.1.3" xref="algx1.l10.m1.3.3.3.3.5.1.3.cmml"><mover accent="true" id="algx1.l10.m1.3.3.3.3.5.1.3.2" xref="algx1.l10.m1.3.3.3.3.5.1.3.2.cmml"><mi id="algx1.l10.m1.3.3.3.3.5.1.3.2.2" xref="algx1.l10.m1.3.3.3.3.5.1.3.2.2.cmml">ϵ</mi><mo stretchy="false" id="algx1.l10.m1.3.3.3.3.5.1.3.2.1" xref="algx1.l10.m1.3.3.3.3.5.1.3.2.1.cmml">→</mo></mover><mi id="algx1.l10.m1.3.3.3.3.5.1.3.3" xref="algx1.l10.m1.3.3.3.3.5.1.3.3.cmml">u</mi></msub></msub><mi id="algx1.l10.m1.3.3.3.3.5.2" xref="algx1.l10.m1.3.3.3.3.5.2.cmml">L</mi></mrow><mo lspace="0em" rspace="0em" id="algx1.l10.m1.3.3.3.3.4" xref="algx1.l10.m1.3.3.3.3.4.cmml">​</mo><mrow id="algx1.l10.m1.3.3.3.3.3.3" xref="algx1.l10.m1.3.3.3.3.3.4.cmml"><mo stretchy="false" id="algx1.l10.m1.3.3.3.3.3.3.4" xref="algx1.l10.m1.3.3.3.3.3.4.cmml">(</mo><msub id="algx1.l10.m1.1.1.1.1.1.1.1" xref="algx1.l10.m1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="algx1.l10.m1.1.1.1.1.1.1.1.2" xref="algx1.l10.m1.1.1.1.1.1.1.1.2.cmml"><mi id="algx1.l10.m1.1.1.1.1.1.1.1.2.2" xref="algx1.l10.m1.1.1.1.1.1.1.1.2.2.cmml">ϵ</mi><mo stretchy="false" id="algx1.l10.m1.1.1.1.1.1.1.1.2.1" xref="algx1.l10.m1.1.1.1.1.1.1.1.2.1.cmml">→</mo></mover><mi id="algx1.l10.m1.1.1.1.1.1.1.1.3" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.cmml">u</mi></msub><mo id="algx1.l10.m1.3.3.3.3.3.3.5" xref="algx1.l10.m1.3.3.3.3.3.4.cmml">,</mo><msub id="algx1.l10.m1.2.2.2.2.2.2.2" xref="algx1.l10.m1.2.2.2.2.2.2.2.cmml"><mover accent="true" id="algx1.l10.m1.2.2.2.2.2.2.2.2" xref="algx1.l10.m1.2.2.2.2.2.2.2.2.cmml"><mi id="algx1.l10.m1.2.2.2.2.2.2.2.2.2" xref="algx1.l10.m1.2.2.2.2.2.2.2.2.2.cmml">ϵ</mi><mo stretchy="false" id="algx1.l10.m1.2.2.2.2.2.2.2.2.1" xref="algx1.l10.m1.2.2.2.2.2.2.2.2.1.cmml">→</mo></mover><mi id="algx1.l10.m1.2.2.2.2.2.2.2.3" xref="algx1.l10.m1.2.2.2.2.2.2.2.3.cmml">p</mi></msub><mo id="algx1.l10.m1.3.3.3.3.3.3.6" xref="algx1.l10.m1.3.3.3.3.3.4.cmml">,</mo><msub id="algx1.l10.m1.3.3.3.3.3.3.3" xref="algx1.l10.m1.3.3.3.3.3.3.3.cmml"><mover accent="true" id="algx1.l10.m1.3.3.3.3.3.3.3.2" xref="algx1.l10.m1.3.3.3.3.3.3.3.2.cmml"><mi id="algx1.l10.m1.3.3.3.3.3.3.3.2.2" xref="algx1.l10.m1.3.3.3.3.3.3.3.2.2.cmml">ϵ</mi><mo stretchy="false" id="algx1.l10.m1.3.3.3.3.3.3.3.2.1" xref="algx1.l10.m1.3.3.3.3.3.3.3.2.1.cmml">→</mo></mover><mi id="algx1.l10.m1.3.3.3.3.3.3.3.3" xref="algx1.l10.m1.3.3.3.3.3.3.3.3.cmml">n</mi></msub><mo stretchy="false" id="algx1.l10.m1.3.3.3.3.3.3.7" xref="algx1.l10.m1.3.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l10.m1.3b"><apply id="algx1.l10.m1.3.3.cmml" xref="algx1.l10.m1.3.3"><ci id="algx1.l10.m1.3.3.4.cmml" xref="algx1.l10.m1.3.3.4">←</ci><apply id="algx1.l10.m1.3.3.5.cmml" xref="algx1.l10.m1.3.3.5"><csymbol cd="ambiguous" id="algx1.l10.m1.3.3.5.1.cmml" xref="algx1.l10.m1.3.3.5">subscript</csymbol><apply id="algx1.l10.m1.3.3.5.2.cmml" xref="algx1.l10.m1.3.3.5.2"><ci id="algx1.l10.m1.3.3.5.2.1.cmml" xref="algx1.l10.m1.3.3.5.2.1">→</ci><ci id="algx1.l10.m1.3.3.5.2.2.cmml" xref="algx1.l10.m1.3.3.5.2.2">italic-ϵ</ci></apply><ci id="algx1.l10.m1.3.3.5.3.cmml" xref="algx1.l10.m1.3.3.5.3">𝑢</ci></apply><apply id="algx1.l10.m1.3.3.3.cmml" xref="algx1.l10.m1.3.3.3"><plus id="algx1.l10.m1.3.3.3.4.cmml" xref="algx1.l10.m1.3.3.3.4"></plus><apply id="algx1.l10.m1.3.3.3.5.cmml" xref="algx1.l10.m1.3.3.3.5"><csymbol cd="ambiguous" id="algx1.l10.m1.3.3.3.5.1.cmml" xref="algx1.l10.m1.3.3.3.5">subscript</csymbol><apply id="algx1.l10.m1.3.3.3.5.2.cmml" xref="algx1.l10.m1.3.3.3.5.2"><ci id="algx1.l10.m1.3.3.3.5.2.1.cmml" xref="algx1.l10.m1.3.3.3.5.2.1">→</ci><ci id="algx1.l10.m1.3.3.3.5.2.2.cmml" xref="algx1.l10.m1.3.3.3.5.2.2">italic-ϵ</ci></apply><ci id="algx1.l10.m1.3.3.3.5.3.cmml" xref="algx1.l10.m1.3.3.3.5.3">𝑢</ci></apply><apply id="algx1.l10.m1.3.3.3.3.cmml" xref="algx1.l10.m1.3.3.3.3"><times id="algx1.l10.m1.3.3.3.3.4.cmml" xref="algx1.l10.m1.3.3.3.3.4"></times><apply id="algx1.l10.m1.3.3.3.3.5.cmml" xref="algx1.l10.m1.3.3.3.3.5"><apply id="algx1.l10.m1.3.3.3.3.5.1.cmml" xref="algx1.l10.m1.3.3.3.3.5.1"><csymbol cd="ambiguous" id="algx1.l10.m1.3.3.3.3.5.1.1.cmml" xref="algx1.l10.m1.3.3.3.3.5.1">subscript</csymbol><ci id="algx1.l10.m1.3.3.3.3.5.1.2.cmml" xref="algx1.l10.m1.3.3.3.3.5.1.2">∇</ci><apply id="algx1.l10.m1.3.3.3.3.5.1.3.cmml" xref="algx1.l10.m1.3.3.3.3.5.1.3"><csymbol cd="ambiguous" id="algx1.l10.m1.3.3.3.3.5.1.3.1.cmml" xref="algx1.l10.m1.3.3.3.3.5.1.3">subscript</csymbol><apply id="algx1.l10.m1.3.3.3.3.5.1.3.2.cmml" xref="algx1.l10.m1.3.3.3.3.5.1.3.2"><ci id="algx1.l10.m1.3.3.3.3.5.1.3.2.1.cmml" xref="algx1.l10.m1.3.3.3.3.5.1.3.2.1">→</ci><ci id="algx1.l10.m1.3.3.3.3.5.1.3.2.2.cmml" xref="algx1.l10.m1.3.3.3.3.5.1.3.2.2">italic-ϵ</ci></apply><ci id="algx1.l10.m1.3.3.3.3.5.1.3.3.cmml" xref="algx1.l10.m1.3.3.3.3.5.1.3.3">𝑢</ci></apply></apply><ci id="algx1.l10.m1.3.3.3.3.5.2.cmml" xref="algx1.l10.m1.3.3.3.3.5.2">𝐿</ci></apply><vector id="algx1.l10.m1.3.3.3.3.3.4.cmml" xref="algx1.l10.m1.3.3.3.3.3.3"><apply id="algx1.l10.m1.1.1.1.1.1.1.1.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algx1.l10.m1.1.1.1.1.1.1.1.1.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="algx1.l10.m1.1.1.1.1.1.1.1.2.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1.2"><ci id="algx1.l10.m1.1.1.1.1.1.1.1.2.1.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1.2.1">→</ci><ci id="algx1.l10.m1.1.1.1.1.1.1.1.2.2.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1.2.2">italic-ϵ</ci></apply><ci id="algx1.l10.m1.1.1.1.1.1.1.1.3.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1.3">𝑢</ci></apply><apply id="algx1.l10.m1.2.2.2.2.2.2.2.cmml" xref="algx1.l10.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algx1.l10.m1.2.2.2.2.2.2.2.1.cmml" xref="algx1.l10.m1.2.2.2.2.2.2.2">subscript</csymbol><apply id="algx1.l10.m1.2.2.2.2.2.2.2.2.cmml" xref="algx1.l10.m1.2.2.2.2.2.2.2.2"><ci id="algx1.l10.m1.2.2.2.2.2.2.2.2.1.cmml" xref="algx1.l10.m1.2.2.2.2.2.2.2.2.1">→</ci><ci id="algx1.l10.m1.2.2.2.2.2.2.2.2.2.cmml" xref="algx1.l10.m1.2.2.2.2.2.2.2.2.2">italic-ϵ</ci></apply><ci id="algx1.l10.m1.2.2.2.2.2.2.2.3.cmml" xref="algx1.l10.m1.2.2.2.2.2.2.2.3">𝑝</ci></apply><apply id="algx1.l10.m1.3.3.3.3.3.3.3.cmml" xref="algx1.l10.m1.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="algx1.l10.m1.3.3.3.3.3.3.3.1.cmml" xref="algx1.l10.m1.3.3.3.3.3.3.3">subscript</csymbol><apply id="algx1.l10.m1.3.3.3.3.3.3.3.2.cmml" xref="algx1.l10.m1.3.3.3.3.3.3.3.2"><ci id="algx1.l10.m1.3.3.3.3.3.3.3.2.1.cmml" xref="algx1.l10.m1.3.3.3.3.3.3.3.2.1">→</ci><ci id="algx1.l10.m1.3.3.3.3.3.3.3.2.2.cmml" xref="algx1.l10.m1.3.3.3.3.3.3.3.2.2">italic-ϵ</ci></apply><ci id="algx1.l10.m1.3.3.3.3.3.3.3.3.cmml" xref="algx1.l10.m1.3.3.3.3.3.3.3.3">𝑛</ci></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l10.m1.3c">\vec{\epsilon}_{u}\leftarrow\vec{\epsilon}_{u}+\nabla_{\vec{\epsilon}_{u}}L(\vec{\epsilon}_{u},\vec{\epsilon}_{p},\vec{\epsilon}_{n})</annotation></semantics></math>

</div>
<div id="algx1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>        Model head, <math id="algx1.l11.m1.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="algx1.l11.m1.1a"><mi id="algx1.l11.m1.1.1" xref="algx1.l11.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="algx1.l11.m1.1b"><ci id="algx1.l11.m1.1.1.cmml" xref="algx1.l11.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l11.m1.1c">\phi</annotation></semantics></math>, assigned as nearest neighbor to <math id="algx1.l11.m2.1" class="ltx_Math" alttext="\vec{\epsilon}_{u}" display="inline"><semantics id="algx1.l11.m2.1a"><msub id="algx1.l11.m2.1.1" xref="algx1.l11.m2.1.1.cmml"><mover accent="true" id="algx1.l11.m2.1.1.2" xref="algx1.l11.m2.1.1.2.cmml"><mi id="algx1.l11.m2.1.1.2.2" xref="algx1.l11.m2.1.1.2.2.cmml">ϵ</mi><mo stretchy="false" id="algx1.l11.m2.1.1.2.1" xref="algx1.l11.m2.1.1.2.1.cmml">→</mo></mover><mi id="algx1.l11.m2.1.1.3" xref="algx1.l11.m2.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="algx1.l11.m2.1b"><apply id="algx1.l11.m2.1.1.cmml" xref="algx1.l11.m2.1.1"><csymbol cd="ambiguous" id="algx1.l11.m2.1.1.1.cmml" xref="algx1.l11.m2.1.1">subscript</csymbol><apply id="algx1.l11.m2.1.1.2.cmml" xref="algx1.l11.m2.1.1.2"><ci id="algx1.l11.m2.1.1.2.1.cmml" xref="algx1.l11.m2.1.1.2.1">→</ci><ci id="algx1.l11.m2.1.1.2.2.cmml" xref="algx1.l11.m2.1.1.2.2">italic-ϵ</ci></apply><ci id="algx1.l11.m2.1.1.3.cmml" xref="algx1.l11.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l11.m2.1c">\vec{\epsilon}_{u}</annotation></semantics></math> in <math id="algx1.l11.m3.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="algx1.l11.m3.1a"><mi class="ltx_font_mathcaligraphic" id="algx1.l11.m3.1.1" xref="algx1.l11.m3.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="algx1.l11.m3.1b"><ci id="algx1.l11.m3.1.1.cmml" xref="algx1.l11.m3.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l11.m3.1c">\mathcal{E}</annotation></semantics></math>

</div>
<div id="algx1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>     <span id="algx1.l12.2" class="ltx_text ltx_font_bold">else</span>


</div>
<div id="algx1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>        Model head, <math id="algx1.l13.m1.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="algx1.l13.m1.1a"><mi id="algx1.l13.m1.1.1" xref="algx1.l13.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="algx1.l13.m1.1b"><ci id="algx1.l13.m1.1.1.cmml" xref="algx1.l13.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l13.m1.1c">\phi</annotation></semantics></math>, assigned by <math id="algx1.l13.m2.1" class="ltx_Math" alttext="\Psi(\vec{\epsilon}_{u})" display="inline"><semantics id="algx1.l13.m2.1a"><mrow id="algx1.l13.m2.1.1" xref="algx1.l13.m2.1.1.cmml"><mi mathvariant="normal" id="algx1.l13.m2.1.1.3" xref="algx1.l13.m2.1.1.3.cmml">Ψ</mi><mo lspace="0em" rspace="0em" id="algx1.l13.m2.1.1.2" xref="algx1.l13.m2.1.1.2.cmml">​</mo><mrow id="algx1.l13.m2.1.1.1.1" xref="algx1.l13.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="algx1.l13.m2.1.1.1.1.2" xref="algx1.l13.m2.1.1.1.1.1.cmml">(</mo><msub id="algx1.l13.m2.1.1.1.1.1" xref="algx1.l13.m2.1.1.1.1.1.cmml"><mover accent="true" id="algx1.l13.m2.1.1.1.1.1.2" xref="algx1.l13.m2.1.1.1.1.1.2.cmml"><mi id="algx1.l13.m2.1.1.1.1.1.2.2" xref="algx1.l13.m2.1.1.1.1.1.2.2.cmml">ϵ</mi><mo stretchy="false" id="algx1.l13.m2.1.1.1.1.1.2.1" xref="algx1.l13.m2.1.1.1.1.1.2.1.cmml">→</mo></mover><mi id="algx1.l13.m2.1.1.1.1.1.3" xref="algx1.l13.m2.1.1.1.1.1.3.cmml">u</mi></msub><mo stretchy="false" id="algx1.l13.m2.1.1.1.1.3" xref="algx1.l13.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l13.m2.1b"><apply id="algx1.l13.m2.1.1.cmml" xref="algx1.l13.m2.1.1"><times id="algx1.l13.m2.1.1.2.cmml" xref="algx1.l13.m2.1.1.2"></times><ci id="algx1.l13.m2.1.1.3.cmml" xref="algx1.l13.m2.1.1.3">Ψ</ci><apply id="algx1.l13.m2.1.1.1.1.1.cmml" xref="algx1.l13.m2.1.1.1.1"><csymbol cd="ambiguous" id="algx1.l13.m2.1.1.1.1.1.1.cmml" xref="algx1.l13.m2.1.1.1.1">subscript</csymbol><apply id="algx1.l13.m2.1.1.1.1.1.2.cmml" xref="algx1.l13.m2.1.1.1.1.1.2"><ci id="algx1.l13.m2.1.1.1.1.1.2.1.cmml" xref="algx1.l13.m2.1.1.1.1.1.2.1">→</ci><ci id="algx1.l13.m2.1.1.1.1.1.2.2.cmml" xref="algx1.l13.m2.1.1.1.1.1.2.2">italic-ϵ</ci></apply><ci id="algx1.l13.m2.1.1.1.1.1.3.cmml" xref="algx1.l13.m2.1.1.1.1.1.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l13.m2.1c">\Psi(\vec{\epsilon}_{u})</annotation></semantics></math>

</div>
<div id="algx1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>     <span id="algx1.l14.2" class="ltx_text ltx_font_bold">end</span> <span id="algx1.l14.3" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="algx1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>     <math id="algx1.l15.m1.1" class="ltx_Math" alttext="\nabla_{u_{\theta}}=0" display="inline"><semantics id="algx1.l15.m1.1a"><mrow id="algx1.l15.m1.1.1" xref="algx1.l15.m1.1.1.cmml"><msub id="algx1.l15.m1.1.1.2" xref="algx1.l15.m1.1.1.2.cmml"><mo id="algx1.l15.m1.1.1.2.2" xref="algx1.l15.m1.1.1.2.2.cmml">∇</mo><msub id="algx1.l15.m1.1.1.2.3" xref="algx1.l15.m1.1.1.2.3.cmml"><mi id="algx1.l15.m1.1.1.2.3.2" xref="algx1.l15.m1.1.1.2.3.2.cmml">u</mi><mi id="algx1.l15.m1.1.1.2.3.3" xref="algx1.l15.m1.1.1.2.3.3.cmml">θ</mi></msub></msub><mo id="algx1.l15.m1.1.1.1" xref="algx1.l15.m1.1.1.1.cmml">=</mo><mn id="algx1.l15.m1.1.1.3" xref="algx1.l15.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="algx1.l15.m1.1b"><apply id="algx1.l15.m1.1.1.cmml" xref="algx1.l15.m1.1.1"><eq id="algx1.l15.m1.1.1.1.cmml" xref="algx1.l15.m1.1.1.1"></eq><apply id="algx1.l15.m1.1.1.2.cmml" xref="algx1.l15.m1.1.1.2"><csymbol cd="ambiguous" id="algx1.l15.m1.1.1.2.1.cmml" xref="algx1.l15.m1.1.1.2">subscript</csymbol><ci id="algx1.l15.m1.1.1.2.2.cmml" xref="algx1.l15.m1.1.1.2.2">∇</ci><apply id="algx1.l15.m1.1.1.2.3.cmml" xref="algx1.l15.m1.1.1.2.3"><csymbol cd="ambiguous" id="algx1.l15.m1.1.1.2.3.1.cmml" xref="algx1.l15.m1.1.1.2.3">subscript</csymbol><ci id="algx1.l15.m1.1.1.2.3.2.cmml" xref="algx1.l15.m1.1.1.2.3.2">𝑢</ci><ci id="algx1.l15.m1.1.1.2.3.3.cmml" xref="algx1.l15.m1.1.1.2.3.3">𝜃</ci></apply></apply><cn type="integer" id="algx1.l15.m1.1.1.3.cmml" xref="algx1.l15.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l15.m1.1c">\nabla_{u_{\theta}}=0</annotation></semantics></math>

</div>
<div id="algx1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>     <math id="algx1.l16.m1.1" class="ltx_Math" alttext="\nabla_{u_{\phi}}=0" display="inline"><semantics id="algx1.l16.m1.1a"><mrow id="algx1.l16.m1.1.1" xref="algx1.l16.m1.1.1.cmml"><msub id="algx1.l16.m1.1.1.2" xref="algx1.l16.m1.1.1.2.cmml"><mo id="algx1.l16.m1.1.1.2.2" xref="algx1.l16.m1.1.1.2.2.cmml">∇</mo><msub id="algx1.l16.m1.1.1.2.3" xref="algx1.l16.m1.1.1.2.3.cmml"><mi id="algx1.l16.m1.1.1.2.3.2" xref="algx1.l16.m1.1.1.2.3.2.cmml">u</mi><mi id="algx1.l16.m1.1.1.2.3.3" xref="algx1.l16.m1.1.1.2.3.3.cmml">ϕ</mi></msub></msub><mo id="algx1.l16.m1.1.1.1" xref="algx1.l16.m1.1.1.1.cmml">=</mo><mn id="algx1.l16.m1.1.1.3" xref="algx1.l16.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="algx1.l16.m1.1b"><apply id="algx1.l16.m1.1.1.cmml" xref="algx1.l16.m1.1.1"><eq id="algx1.l16.m1.1.1.1.cmml" xref="algx1.l16.m1.1.1.1"></eq><apply id="algx1.l16.m1.1.1.2.cmml" xref="algx1.l16.m1.1.1.2"><csymbol cd="ambiguous" id="algx1.l16.m1.1.1.2.1.cmml" xref="algx1.l16.m1.1.1.2">subscript</csymbol><ci id="algx1.l16.m1.1.1.2.2.cmml" xref="algx1.l16.m1.1.1.2.2">∇</ci><apply id="algx1.l16.m1.1.1.2.3.cmml" xref="algx1.l16.m1.1.1.2.3"><csymbol cd="ambiguous" id="algx1.l16.m1.1.1.2.3.1.cmml" xref="algx1.l16.m1.1.1.2.3">subscript</csymbol><ci id="algx1.l16.m1.1.1.2.3.2.cmml" xref="algx1.l16.m1.1.1.2.3.2">𝑢</ci><ci id="algx1.l16.m1.1.1.2.3.3.cmml" xref="algx1.l16.m1.1.1.2.3.3">italic-ϕ</ci></apply></apply><cn type="integer" id="algx1.l16.m1.1.1.3.cmml" xref="algx1.l16.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l16.m1.1c">\nabla_{u_{\phi}}=0</annotation></semantics></math>

</div>
<div id="algx1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span>     <span id="algx1.l17.2" class="ltx_text ltx_font_bold">for</span> <math id="algx1.l17.m1.3" class="ltx_Math" alttext="\vec{x},y,m" display="inline"><semantics id="algx1.l17.m1.3a"><mrow id="algx1.l17.m1.3.4.2" xref="algx1.l17.m1.3.4.1.cmml"><mover accent="true" id="algx1.l17.m1.1.1" xref="algx1.l17.m1.1.1.cmml"><mi id="algx1.l17.m1.1.1.2" xref="algx1.l17.m1.1.1.2.cmml">x</mi><mo stretchy="false" id="algx1.l17.m1.1.1.1" xref="algx1.l17.m1.1.1.1.cmml">→</mo></mover><mo id="algx1.l17.m1.3.4.2.1" xref="algx1.l17.m1.3.4.1.cmml">,</mo><mi id="algx1.l17.m1.2.2" xref="algx1.l17.m1.2.2.cmml">y</mi><mo id="algx1.l17.m1.3.4.2.2" xref="algx1.l17.m1.3.4.1.cmml">,</mo><mi id="algx1.l17.m1.3.3" xref="algx1.l17.m1.3.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="algx1.l17.m1.3b"><list id="algx1.l17.m1.3.4.1.cmml" xref="algx1.l17.m1.3.4.2"><apply id="algx1.l17.m1.1.1.cmml" xref="algx1.l17.m1.1.1"><ci id="algx1.l17.m1.1.1.1.cmml" xref="algx1.l17.m1.1.1.1">→</ci><ci id="algx1.l17.m1.1.1.2.cmml" xref="algx1.l17.m1.1.1.2">𝑥</ci></apply><ci id="algx1.l17.m1.2.2.cmml" xref="algx1.l17.m1.2.2">𝑦</ci><ci id="algx1.l17.m1.3.3.cmml" xref="algx1.l17.m1.3.3">𝑚</ci></list></annotation-xml><annotation encoding="application/x-tex" id="algx1.l17.m1.3c">\vec{x},y,m</annotation></semantics></math> in <math id="algx1.l17.m2.1" class="ltx_Math" alttext="D_{u}" display="inline"><semantics id="algx1.l17.m2.1a"><msub id="algx1.l17.m2.1.1" xref="algx1.l17.m2.1.1.cmml"><mi id="algx1.l17.m2.1.1.2" xref="algx1.l17.m2.1.1.2.cmml">D</mi><mi id="algx1.l17.m2.1.1.3" xref="algx1.l17.m2.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="algx1.l17.m2.1b"><apply id="algx1.l17.m2.1.1.cmml" xref="algx1.l17.m2.1.1"><csymbol cd="ambiguous" id="algx1.l17.m2.1.1.1.cmml" xref="algx1.l17.m2.1.1">subscript</csymbol><ci id="algx1.l17.m2.1.1.2.cmml" xref="algx1.l17.m2.1.1.2">𝐷</ci><ci id="algx1.l17.m2.1.1.3.cmml" xref="algx1.l17.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l17.m2.1c">D_{u}</annotation></semantics></math> <span id="algx1.l17.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="algx1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l18.1.1.1" class="ltx_text" style="font-size:80%;">18:</span></span>        <math id="algx1.l18.m1.4" class="ltx_math_unparsed" alttext="\nabla_{u_{\theta}}=\nabla_{u_{\theta}}+\nabla_{\theta}\mathcal{L}_{C}(\phi(\theta(\vec{x})),y)+\nabla_{\theta}\mathcal{L}_{M}(\theta(\vec{x},m)" display="inline"><semantics id="algx1.l18.m1.4a"><mrow id="algx1.l18.m1.4b"><msub id="algx1.l18.m1.4.5"><mo id="algx1.l18.m1.4.5.2">∇</mo><msub id="algx1.l18.m1.4.5.3"><mi id="algx1.l18.m1.4.5.3.2">u</mi><mi id="algx1.l18.m1.4.5.3.3">θ</mi></msub></msub><mo id="algx1.l18.m1.4.6">=</mo><msub id="algx1.l18.m1.4.7"><mo id="algx1.l18.m1.4.7.2">∇</mo><msub id="algx1.l18.m1.4.7.3"><mi id="algx1.l18.m1.4.7.3.2">u</mi><mi id="algx1.l18.m1.4.7.3.3">θ</mi></msub></msub><mo lspace="0em" id="algx1.l18.m1.4.8">+</mo><msub id="algx1.l18.m1.4.9"><mo rspace="0.167em" id="algx1.l18.m1.4.9.2">∇</mo><mi id="algx1.l18.m1.4.9.3">θ</mi></msub><msub id="algx1.l18.m1.4.10"><mi class="ltx_font_mathcaligraphic" id="algx1.l18.m1.4.10.2">ℒ</mi><mi id="algx1.l18.m1.4.10.3">C</mi></msub><mrow id="algx1.l18.m1.4.11"><mo stretchy="false" id="algx1.l18.m1.4.11.1">(</mo><mi id="algx1.l18.m1.4.11.2">ϕ</mi><mrow id="algx1.l18.m1.4.11.3"><mo stretchy="false" id="algx1.l18.m1.4.11.3.1">(</mo><mi id="algx1.l18.m1.4.11.3.2">θ</mi><mrow id="algx1.l18.m1.4.11.3.3"><mo stretchy="false" id="algx1.l18.m1.4.11.3.3.1">(</mo><mover accent="true" id="algx1.l18.m1.1.1"><mi id="algx1.l18.m1.1.1.2">x</mi><mo stretchy="false" id="algx1.l18.m1.1.1.1">→</mo></mover><mo stretchy="false" id="algx1.l18.m1.4.11.3.3.2">)</mo></mrow><mo stretchy="false" id="algx1.l18.m1.4.11.3.4">)</mo></mrow><mo id="algx1.l18.m1.4.11.4">,</mo><mi id="algx1.l18.m1.2.2">y</mi><mo stretchy="false" id="algx1.l18.m1.4.11.5">)</mo></mrow><mo id="algx1.l18.m1.4.12">+</mo><msub id="algx1.l18.m1.4.13"><mo rspace="0.167em" id="algx1.l18.m1.4.13.2">∇</mo><mi id="algx1.l18.m1.4.13.3">θ</mi></msub><msub id="algx1.l18.m1.4.14"><mi class="ltx_font_mathcaligraphic" id="algx1.l18.m1.4.14.2">ℒ</mi><mi id="algx1.l18.m1.4.14.3">M</mi></msub><mrow id="algx1.l18.m1.4.15"><mo stretchy="false" id="algx1.l18.m1.4.15.1">(</mo><mi id="algx1.l18.m1.4.15.2">θ</mi><mrow id="algx1.l18.m1.4.15.3"><mo stretchy="false" id="algx1.l18.m1.4.15.3.1">(</mo><mover accent="true" id="algx1.l18.m1.3.3"><mi id="algx1.l18.m1.3.3.2">x</mi><mo stretchy="false" id="algx1.l18.m1.3.3.1">→</mo></mover><mo id="algx1.l18.m1.4.15.3.2">,</mo><mi id="algx1.l18.m1.4.4">m</mi><mo stretchy="false" id="algx1.l18.m1.4.15.3.3">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="algx1.l18.m1.4c">\nabla_{u_{\theta}}=\nabla_{u_{\theta}}+\nabla_{\theta}\mathcal{L}_{C}(\phi(\theta(\vec{x})),y)+\nabla_{\theta}\mathcal{L}_{M}(\theta(\vec{x},m)</annotation></semantics></math>

</div>
<div id="algx1.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l19.1.1.1" class="ltx_text" style="font-size:80%;">19:</span></span>        <math id="algx1.l19.m1.3" class="ltx_Math" alttext="\nabla_{u_{\phi}}=\nabla_{u_{\phi}}+\nabla_{\phi}\mathcal{L}_{C}(\phi(\theta(\vec{x})),y)" display="inline"><semantics id="algx1.l19.m1.3a"><mrow id="algx1.l19.m1.3.3" xref="algx1.l19.m1.3.3.cmml"><msub id="algx1.l19.m1.3.3.3" xref="algx1.l19.m1.3.3.3.cmml"><mo id="algx1.l19.m1.3.3.3.2" xref="algx1.l19.m1.3.3.3.2.cmml">∇</mo><msub id="algx1.l19.m1.3.3.3.3" xref="algx1.l19.m1.3.3.3.3.cmml"><mi id="algx1.l19.m1.3.3.3.3.2" xref="algx1.l19.m1.3.3.3.3.2.cmml">u</mi><mi id="algx1.l19.m1.3.3.3.3.3" xref="algx1.l19.m1.3.3.3.3.3.cmml">ϕ</mi></msub></msub><mo id="algx1.l19.m1.3.3.2" xref="algx1.l19.m1.3.3.2.cmml">=</mo><mrow id="algx1.l19.m1.3.3.1" xref="algx1.l19.m1.3.3.1.cmml"><msub id="algx1.l19.m1.3.3.1.3" xref="algx1.l19.m1.3.3.1.3.cmml"><mo id="algx1.l19.m1.3.3.1.3.2" xref="algx1.l19.m1.3.3.1.3.2.cmml">∇</mo><msub id="algx1.l19.m1.3.3.1.3.3" xref="algx1.l19.m1.3.3.1.3.3.cmml"><mi id="algx1.l19.m1.3.3.1.3.3.2" xref="algx1.l19.m1.3.3.1.3.3.2.cmml">u</mi><mi id="algx1.l19.m1.3.3.1.3.3.3" xref="algx1.l19.m1.3.3.1.3.3.3.cmml">ϕ</mi></msub></msub><mo lspace="0em" id="algx1.l19.m1.3.3.1.2" xref="algx1.l19.m1.3.3.1.2.cmml">+</mo><mrow id="algx1.l19.m1.3.3.1.1" xref="algx1.l19.m1.3.3.1.1.cmml"><mrow id="algx1.l19.m1.3.3.1.1.3" xref="algx1.l19.m1.3.3.1.1.3.cmml"><msub id="algx1.l19.m1.3.3.1.1.3.1" xref="algx1.l19.m1.3.3.1.1.3.1.cmml"><mo rspace="0.167em" id="algx1.l19.m1.3.3.1.1.3.1.2" xref="algx1.l19.m1.3.3.1.1.3.1.2.cmml">∇</mo><mi id="algx1.l19.m1.3.3.1.1.3.1.3" xref="algx1.l19.m1.3.3.1.1.3.1.3.cmml">ϕ</mi></msub><msub id="algx1.l19.m1.3.3.1.1.3.2" xref="algx1.l19.m1.3.3.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algx1.l19.m1.3.3.1.1.3.2.2" xref="algx1.l19.m1.3.3.1.1.3.2.2.cmml">ℒ</mi><mi id="algx1.l19.m1.3.3.1.1.3.2.3" xref="algx1.l19.m1.3.3.1.1.3.2.3.cmml">C</mi></msub></mrow><mo lspace="0em" rspace="0em" id="algx1.l19.m1.3.3.1.1.2" xref="algx1.l19.m1.3.3.1.1.2.cmml">​</mo><mrow id="algx1.l19.m1.3.3.1.1.1.1" xref="algx1.l19.m1.3.3.1.1.1.2.cmml"><mo stretchy="false" id="algx1.l19.m1.3.3.1.1.1.1.2" xref="algx1.l19.m1.3.3.1.1.1.2.cmml">(</mo><mrow id="algx1.l19.m1.3.3.1.1.1.1.1" xref="algx1.l19.m1.3.3.1.1.1.1.1.cmml"><mi id="algx1.l19.m1.3.3.1.1.1.1.1.3" xref="algx1.l19.m1.3.3.1.1.1.1.1.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="algx1.l19.m1.3.3.1.1.1.1.1.2" xref="algx1.l19.m1.3.3.1.1.1.1.1.2.cmml">​</mo><mrow id="algx1.l19.m1.3.3.1.1.1.1.1.1.1" xref="algx1.l19.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="algx1.l19.m1.3.3.1.1.1.1.1.1.1.2" xref="algx1.l19.m1.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="algx1.l19.m1.3.3.1.1.1.1.1.1.1.1" xref="algx1.l19.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="algx1.l19.m1.3.3.1.1.1.1.1.1.1.1.2" xref="algx1.l19.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mo lspace="0em" rspace="0em" id="algx1.l19.m1.3.3.1.1.1.1.1.1.1.1.1" xref="algx1.l19.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="algx1.l19.m1.3.3.1.1.1.1.1.1.1.1.3.2" xref="algx1.l19.m1.1.1.cmml"><mo stretchy="false" id="algx1.l19.m1.3.3.1.1.1.1.1.1.1.1.3.2.1" xref="algx1.l19.m1.1.1.cmml">(</mo><mover accent="true" id="algx1.l19.m1.1.1" xref="algx1.l19.m1.1.1.cmml"><mi id="algx1.l19.m1.1.1.2" xref="algx1.l19.m1.1.1.2.cmml">x</mi><mo stretchy="false" id="algx1.l19.m1.1.1.1" xref="algx1.l19.m1.1.1.1.cmml">→</mo></mover><mo stretchy="false" id="algx1.l19.m1.3.3.1.1.1.1.1.1.1.1.3.2.2" xref="algx1.l19.m1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="algx1.l19.m1.3.3.1.1.1.1.1.1.1.3" xref="algx1.l19.m1.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="algx1.l19.m1.3.3.1.1.1.1.3" xref="algx1.l19.m1.3.3.1.1.1.2.cmml">,</mo><mi id="algx1.l19.m1.2.2" xref="algx1.l19.m1.2.2.cmml">y</mi><mo stretchy="false" id="algx1.l19.m1.3.3.1.1.1.1.4" xref="algx1.l19.m1.3.3.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l19.m1.3b"><apply id="algx1.l19.m1.3.3.cmml" xref="algx1.l19.m1.3.3"><eq id="algx1.l19.m1.3.3.2.cmml" xref="algx1.l19.m1.3.3.2"></eq><apply id="algx1.l19.m1.3.3.3.cmml" xref="algx1.l19.m1.3.3.3"><csymbol cd="ambiguous" id="algx1.l19.m1.3.3.3.1.cmml" xref="algx1.l19.m1.3.3.3">subscript</csymbol><ci id="algx1.l19.m1.3.3.3.2.cmml" xref="algx1.l19.m1.3.3.3.2">∇</ci><apply id="algx1.l19.m1.3.3.3.3.cmml" xref="algx1.l19.m1.3.3.3.3"><csymbol cd="ambiguous" id="algx1.l19.m1.3.3.3.3.1.cmml" xref="algx1.l19.m1.3.3.3.3">subscript</csymbol><ci id="algx1.l19.m1.3.3.3.3.2.cmml" xref="algx1.l19.m1.3.3.3.3.2">𝑢</ci><ci id="algx1.l19.m1.3.3.3.3.3.cmml" xref="algx1.l19.m1.3.3.3.3.3">italic-ϕ</ci></apply></apply><apply id="algx1.l19.m1.3.3.1.cmml" xref="algx1.l19.m1.3.3.1"><plus id="algx1.l19.m1.3.3.1.2.cmml" xref="algx1.l19.m1.3.3.1.2"></plus><apply id="algx1.l19.m1.3.3.1.3.cmml" xref="algx1.l19.m1.3.3.1.3"><csymbol cd="ambiguous" id="algx1.l19.m1.3.3.1.3.1.cmml" xref="algx1.l19.m1.3.3.1.3">subscript</csymbol><ci id="algx1.l19.m1.3.3.1.3.2.cmml" xref="algx1.l19.m1.3.3.1.3.2">∇</ci><apply id="algx1.l19.m1.3.3.1.3.3.cmml" xref="algx1.l19.m1.3.3.1.3.3"><csymbol cd="ambiguous" id="algx1.l19.m1.3.3.1.3.3.1.cmml" xref="algx1.l19.m1.3.3.1.3.3">subscript</csymbol><ci id="algx1.l19.m1.3.3.1.3.3.2.cmml" xref="algx1.l19.m1.3.3.1.3.3.2">𝑢</ci><ci id="algx1.l19.m1.3.3.1.3.3.3.cmml" xref="algx1.l19.m1.3.3.1.3.3.3">italic-ϕ</ci></apply></apply><apply id="algx1.l19.m1.3.3.1.1.cmml" xref="algx1.l19.m1.3.3.1.1"><times id="algx1.l19.m1.3.3.1.1.2.cmml" xref="algx1.l19.m1.3.3.1.1.2"></times><apply id="algx1.l19.m1.3.3.1.1.3.cmml" xref="algx1.l19.m1.3.3.1.1.3"><apply id="algx1.l19.m1.3.3.1.1.3.1.cmml" xref="algx1.l19.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="algx1.l19.m1.3.3.1.1.3.1.1.cmml" xref="algx1.l19.m1.3.3.1.1.3.1">subscript</csymbol><ci id="algx1.l19.m1.3.3.1.1.3.1.2.cmml" xref="algx1.l19.m1.3.3.1.1.3.1.2">∇</ci><ci id="algx1.l19.m1.3.3.1.1.3.1.3.cmml" xref="algx1.l19.m1.3.3.1.1.3.1.3">italic-ϕ</ci></apply><apply id="algx1.l19.m1.3.3.1.1.3.2.cmml" xref="algx1.l19.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="algx1.l19.m1.3.3.1.1.3.2.1.cmml" xref="algx1.l19.m1.3.3.1.1.3.2">subscript</csymbol><ci id="algx1.l19.m1.3.3.1.1.3.2.2.cmml" xref="algx1.l19.m1.3.3.1.1.3.2.2">ℒ</ci><ci id="algx1.l19.m1.3.3.1.1.3.2.3.cmml" xref="algx1.l19.m1.3.3.1.1.3.2.3">𝐶</ci></apply></apply><interval closure="open" id="algx1.l19.m1.3.3.1.1.1.2.cmml" xref="algx1.l19.m1.3.3.1.1.1.1"><apply id="algx1.l19.m1.3.3.1.1.1.1.1.cmml" xref="algx1.l19.m1.3.3.1.1.1.1.1"><times id="algx1.l19.m1.3.3.1.1.1.1.1.2.cmml" xref="algx1.l19.m1.3.3.1.1.1.1.1.2"></times><ci id="algx1.l19.m1.3.3.1.1.1.1.1.3.cmml" xref="algx1.l19.m1.3.3.1.1.1.1.1.3">italic-ϕ</ci><apply id="algx1.l19.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="algx1.l19.m1.3.3.1.1.1.1.1.1.1"><times id="algx1.l19.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="algx1.l19.m1.3.3.1.1.1.1.1.1.1.1.1"></times><ci id="algx1.l19.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="algx1.l19.m1.3.3.1.1.1.1.1.1.1.1.2">𝜃</ci><apply id="algx1.l19.m1.1.1.cmml" xref="algx1.l19.m1.3.3.1.1.1.1.1.1.1.1.3.2"><ci id="algx1.l19.m1.1.1.1.cmml" xref="algx1.l19.m1.1.1.1">→</ci><ci id="algx1.l19.m1.1.1.2.cmml" xref="algx1.l19.m1.1.1.2">𝑥</ci></apply></apply></apply><ci id="algx1.l19.m1.2.2.cmml" xref="algx1.l19.m1.2.2">𝑦</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l19.m1.3c">\nabla_{u_{\phi}}=\nabla_{u_{\phi}}+\nabla_{\phi}\mathcal{L}_{C}(\phi(\theta(\vec{x})),y)</annotation></semantics></math>

</div>
<div id="algx1.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l20.1.1.1" class="ltx_text" style="font-size:80%;">20:</span></span>        <math id="algx1.l20.m1.3" class="ltx_Math" alttext="\vec{\epsilon}_{u}\leftarrow\vec{\epsilon}_{u}+\nabla_{\vec{\epsilon}_{u}}\mathcal{L}_{C}(\phi(\theta(\vec{x})),y)" display="inline"><semantics id="algx1.l20.m1.3a"><mrow id="algx1.l20.m1.3.3" xref="algx1.l20.m1.3.3.cmml"><msub id="algx1.l20.m1.3.3.3" xref="algx1.l20.m1.3.3.3.cmml"><mover accent="true" id="algx1.l20.m1.3.3.3.2" xref="algx1.l20.m1.3.3.3.2.cmml"><mi id="algx1.l20.m1.3.3.3.2.2" xref="algx1.l20.m1.3.3.3.2.2.cmml">ϵ</mi><mo stretchy="false" id="algx1.l20.m1.3.3.3.2.1" xref="algx1.l20.m1.3.3.3.2.1.cmml">→</mo></mover><mi id="algx1.l20.m1.3.3.3.3" xref="algx1.l20.m1.3.3.3.3.cmml">u</mi></msub><mo stretchy="false" id="algx1.l20.m1.3.3.2" xref="algx1.l20.m1.3.3.2.cmml">←</mo><mrow id="algx1.l20.m1.3.3.1" xref="algx1.l20.m1.3.3.1.cmml"><msub id="algx1.l20.m1.3.3.1.3" xref="algx1.l20.m1.3.3.1.3.cmml"><mover accent="true" id="algx1.l20.m1.3.3.1.3.2" xref="algx1.l20.m1.3.3.1.3.2.cmml"><mi id="algx1.l20.m1.3.3.1.3.2.2" xref="algx1.l20.m1.3.3.1.3.2.2.cmml">ϵ</mi><mo stretchy="false" id="algx1.l20.m1.3.3.1.3.2.1" xref="algx1.l20.m1.3.3.1.3.2.1.cmml">→</mo></mover><mi id="algx1.l20.m1.3.3.1.3.3" xref="algx1.l20.m1.3.3.1.3.3.cmml">u</mi></msub><mo id="algx1.l20.m1.3.3.1.2" xref="algx1.l20.m1.3.3.1.2.cmml">+</mo><mrow id="algx1.l20.m1.3.3.1.1" xref="algx1.l20.m1.3.3.1.1.cmml"><mrow id="algx1.l20.m1.3.3.1.1.3" xref="algx1.l20.m1.3.3.1.1.3.cmml"><msub id="algx1.l20.m1.3.3.1.1.3.1" xref="algx1.l20.m1.3.3.1.1.3.1.cmml"><mo rspace="0.167em" id="algx1.l20.m1.3.3.1.1.3.1.2" xref="algx1.l20.m1.3.3.1.1.3.1.2.cmml">∇</mo><msub id="algx1.l20.m1.3.3.1.1.3.1.3" xref="algx1.l20.m1.3.3.1.1.3.1.3.cmml"><mover accent="true" id="algx1.l20.m1.3.3.1.1.3.1.3.2" xref="algx1.l20.m1.3.3.1.1.3.1.3.2.cmml"><mi id="algx1.l20.m1.3.3.1.1.3.1.3.2.2" xref="algx1.l20.m1.3.3.1.1.3.1.3.2.2.cmml">ϵ</mi><mo stretchy="false" id="algx1.l20.m1.3.3.1.1.3.1.3.2.1" xref="algx1.l20.m1.3.3.1.1.3.1.3.2.1.cmml">→</mo></mover><mi id="algx1.l20.m1.3.3.1.1.3.1.3.3" xref="algx1.l20.m1.3.3.1.1.3.1.3.3.cmml">u</mi></msub></msub><msub id="algx1.l20.m1.3.3.1.1.3.2" xref="algx1.l20.m1.3.3.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algx1.l20.m1.3.3.1.1.3.2.2" xref="algx1.l20.m1.3.3.1.1.3.2.2.cmml">ℒ</mi><mi id="algx1.l20.m1.3.3.1.1.3.2.3" xref="algx1.l20.m1.3.3.1.1.3.2.3.cmml">C</mi></msub></mrow><mo lspace="0em" rspace="0em" id="algx1.l20.m1.3.3.1.1.2" xref="algx1.l20.m1.3.3.1.1.2.cmml">​</mo><mrow id="algx1.l20.m1.3.3.1.1.1.1" xref="algx1.l20.m1.3.3.1.1.1.2.cmml"><mo stretchy="false" id="algx1.l20.m1.3.3.1.1.1.1.2" xref="algx1.l20.m1.3.3.1.1.1.2.cmml">(</mo><mrow id="algx1.l20.m1.3.3.1.1.1.1.1" xref="algx1.l20.m1.3.3.1.1.1.1.1.cmml"><mi id="algx1.l20.m1.3.3.1.1.1.1.1.3" xref="algx1.l20.m1.3.3.1.1.1.1.1.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="algx1.l20.m1.3.3.1.1.1.1.1.2" xref="algx1.l20.m1.3.3.1.1.1.1.1.2.cmml">​</mo><mrow id="algx1.l20.m1.3.3.1.1.1.1.1.1.1" xref="algx1.l20.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="algx1.l20.m1.3.3.1.1.1.1.1.1.1.2" xref="algx1.l20.m1.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="algx1.l20.m1.3.3.1.1.1.1.1.1.1.1" xref="algx1.l20.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="algx1.l20.m1.3.3.1.1.1.1.1.1.1.1.2" xref="algx1.l20.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mo lspace="0em" rspace="0em" id="algx1.l20.m1.3.3.1.1.1.1.1.1.1.1.1" xref="algx1.l20.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="algx1.l20.m1.3.3.1.1.1.1.1.1.1.1.3.2" xref="algx1.l20.m1.1.1.cmml"><mo stretchy="false" id="algx1.l20.m1.3.3.1.1.1.1.1.1.1.1.3.2.1" xref="algx1.l20.m1.1.1.cmml">(</mo><mover accent="true" id="algx1.l20.m1.1.1" xref="algx1.l20.m1.1.1.cmml"><mi id="algx1.l20.m1.1.1.2" xref="algx1.l20.m1.1.1.2.cmml">x</mi><mo stretchy="false" id="algx1.l20.m1.1.1.1" xref="algx1.l20.m1.1.1.1.cmml">→</mo></mover><mo stretchy="false" id="algx1.l20.m1.3.3.1.1.1.1.1.1.1.1.3.2.2" xref="algx1.l20.m1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="algx1.l20.m1.3.3.1.1.1.1.1.1.1.3" xref="algx1.l20.m1.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="algx1.l20.m1.3.3.1.1.1.1.3" xref="algx1.l20.m1.3.3.1.1.1.2.cmml">,</mo><mi id="algx1.l20.m1.2.2" xref="algx1.l20.m1.2.2.cmml">y</mi><mo stretchy="false" id="algx1.l20.m1.3.3.1.1.1.1.4" xref="algx1.l20.m1.3.3.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l20.m1.3b"><apply id="algx1.l20.m1.3.3.cmml" xref="algx1.l20.m1.3.3"><ci id="algx1.l20.m1.3.3.2.cmml" xref="algx1.l20.m1.3.3.2">←</ci><apply id="algx1.l20.m1.3.3.3.cmml" xref="algx1.l20.m1.3.3.3"><csymbol cd="ambiguous" id="algx1.l20.m1.3.3.3.1.cmml" xref="algx1.l20.m1.3.3.3">subscript</csymbol><apply id="algx1.l20.m1.3.3.3.2.cmml" xref="algx1.l20.m1.3.3.3.2"><ci id="algx1.l20.m1.3.3.3.2.1.cmml" xref="algx1.l20.m1.3.3.3.2.1">→</ci><ci id="algx1.l20.m1.3.3.3.2.2.cmml" xref="algx1.l20.m1.3.3.3.2.2">italic-ϵ</ci></apply><ci id="algx1.l20.m1.3.3.3.3.cmml" xref="algx1.l20.m1.3.3.3.3">𝑢</ci></apply><apply id="algx1.l20.m1.3.3.1.cmml" xref="algx1.l20.m1.3.3.1"><plus id="algx1.l20.m1.3.3.1.2.cmml" xref="algx1.l20.m1.3.3.1.2"></plus><apply id="algx1.l20.m1.3.3.1.3.cmml" xref="algx1.l20.m1.3.3.1.3"><csymbol cd="ambiguous" id="algx1.l20.m1.3.3.1.3.1.cmml" xref="algx1.l20.m1.3.3.1.3">subscript</csymbol><apply id="algx1.l20.m1.3.3.1.3.2.cmml" xref="algx1.l20.m1.3.3.1.3.2"><ci id="algx1.l20.m1.3.3.1.3.2.1.cmml" xref="algx1.l20.m1.3.3.1.3.2.1">→</ci><ci id="algx1.l20.m1.3.3.1.3.2.2.cmml" xref="algx1.l20.m1.3.3.1.3.2.2">italic-ϵ</ci></apply><ci id="algx1.l20.m1.3.3.1.3.3.cmml" xref="algx1.l20.m1.3.3.1.3.3">𝑢</ci></apply><apply id="algx1.l20.m1.3.3.1.1.cmml" xref="algx1.l20.m1.3.3.1.1"><times id="algx1.l20.m1.3.3.1.1.2.cmml" xref="algx1.l20.m1.3.3.1.1.2"></times><apply id="algx1.l20.m1.3.3.1.1.3.cmml" xref="algx1.l20.m1.3.3.1.1.3"><apply id="algx1.l20.m1.3.3.1.1.3.1.cmml" xref="algx1.l20.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="algx1.l20.m1.3.3.1.1.3.1.1.cmml" xref="algx1.l20.m1.3.3.1.1.3.1">subscript</csymbol><ci id="algx1.l20.m1.3.3.1.1.3.1.2.cmml" xref="algx1.l20.m1.3.3.1.1.3.1.2">∇</ci><apply id="algx1.l20.m1.3.3.1.1.3.1.3.cmml" xref="algx1.l20.m1.3.3.1.1.3.1.3"><csymbol cd="ambiguous" id="algx1.l20.m1.3.3.1.1.3.1.3.1.cmml" xref="algx1.l20.m1.3.3.1.1.3.1.3">subscript</csymbol><apply id="algx1.l20.m1.3.3.1.1.3.1.3.2.cmml" xref="algx1.l20.m1.3.3.1.1.3.1.3.2"><ci id="algx1.l20.m1.3.3.1.1.3.1.3.2.1.cmml" xref="algx1.l20.m1.3.3.1.1.3.1.3.2.1">→</ci><ci id="algx1.l20.m1.3.3.1.1.3.1.3.2.2.cmml" xref="algx1.l20.m1.3.3.1.1.3.1.3.2.2">italic-ϵ</ci></apply><ci id="algx1.l20.m1.3.3.1.1.3.1.3.3.cmml" xref="algx1.l20.m1.3.3.1.1.3.1.3.3">𝑢</ci></apply></apply><apply id="algx1.l20.m1.3.3.1.1.3.2.cmml" xref="algx1.l20.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="algx1.l20.m1.3.3.1.1.3.2.1.cmml" xref="algx1.l20.m1.3.3.1.1.3.2">subscript</csymbol><ci id="algx1.l20.m1.3.3.1.1.3.2.2.cmml" xref="algx1.l20.m1.3.3.1.1.3.2.2">ℒ</ci><ci id="algx1.l20.m1.3.3.1.1.3.2.3.cmml" xref="algx1.l20.m1.3.3.1.1.3.2.3">𝐶</ci></apply></apply><interval closure="open" id="algx1.l20.m1.3.3.1.1.1.2.cmml" xref="algx1.l20.m1.3.3.1.1.1.1"><apply id="algx1.l20.m1.3.3.1.1.1.1.1.cmml" xref="algx1.l20.m1.3.3.1.1.1.1.1"><times id="algx1.l20.m1.3.3.1.1.1.1.1.2.cmml" xref="algx1.l20.m1.3.3.1.1.1.1.1.2"></times><ci id="algx1.l20.m1.3.3.1.1.1.1.1.3.cmml" xref="algx1.l20.m1.3.3.1.1.1.1.1.3">italic-ϕ</ci><apply id="algx1.l20.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="algx1.l20.m1.3.3.1.1.1.1.1.1.1"><times id="algx1.l20.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="algx1.l20.m1.3.3.1.1.1.1.1.1.1.1.1"></times><ci id="algx1.l20.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="algx1.l20.m1.3.3.1.1.1.1.1.1.1.1.2">𝜃</ci><apply id="algx1.l20.m1.1.1.cmml" xref="algx1.l20.m1.3.3.1.1.1.1.1.1.1.1.3.2"><ci id="algx1.l20.m1.1.1.1.cmml" xref="algx1.l20.m1.1.1.1">→</ci><ci id="algx1.l20.m1.1.1.2.cmml" xref="algx1.l20.m1.1.1.2">𝑥</ci></apply></apply></apply><ci id="algx1.l20.m1.2.2.cmml" xref="algx1.l20.m1.2.2">𝑦</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l20.m1.3c">\vec{\epsilon}_{u}\leftarrow\vec{\epsilon}_{u}+\nabla_{\vec{\epsilon}_{u}}\mathcal{L}_{C}(\phi(\theta(\vec{x})),y)</annotation></semantics></math>

</div>
<div id="algx1.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l21.1.1.1" class="ltx_text" style="font-size:80%;">21:</span></span>     <span id="algx1.l21.2" class="ltx_text ltx_font_bold">end</span> <span id="algx1.l21.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="algx1.l22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l22.1.1.1" class="ltx_text" style="font-size:80%;">22:</span></span>     Optionally, add differential privacy to <math id="algx1.l22.m1.1" class="ltx_Math" alttext="\nabla_{u_{\theta}}" display="inline"><semantics id="algx1.l22.m1.1a"><msub id="algx1.l22.m1.1.1" xref="algx1.l22.m1.1.1.cmml"><mo id="algx1.l22.m1.1.1.2" xref="algx1.l22.m1.1.1.2.cmml">∇</mo><msub id="algx1.l22.m1.1.1.3" xref="algx1.l22.m1.1.1.3.cmml"><mi id="algx1.l22.m1.1.1.3.2" xref="algx1.l22.m1.1.1.3.2.cmml">u</mi><mi id="algx1.l22.m1.1.1.3.3" xref="algx1.l22.m1.1.1.3.3.cmml">θ</mi></msub></msub><annotation-xml encoding="MathML-Content" id="algx1.l22.m1.1b"><apply id="algx1.l22.m1.1.1.cmml" xref="algx1.l22.m1.1.1"><csymbol cd="ambiguous" id="algx1.l22.m1.1.1.1.cmml" xref="algx1.l22.m1.1.1">subscript</csymbol><ci id="algx1.l22.m1.1.1.2.cmml" xref="algx1.l22.m1.1.1.2">∇</ci><apply id="algx1.l22.m1.1.1.3.cmml" xref="algx1.l22.m1.1.1.3"><csymbol cd="ambiguous" id="algx1.l22.m1.1.1.3.1.cmml" xref="algx1.l22.m1.1.1.3">subscript</csymbol><ci id="algx1.l22.m1.1.1.3.2.cmml" xref="algx1.l22.m1.1.1.3.2">𝑢</ci><ci id="algx1.l22.m1.1.1.3.3.cmml" xref="algx1.l22.m1.1.1.3.3">𝜃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l22.m1.1c">\nabla_{u_{\theta}}</annotation></semantics></math> and <math id="algx1.l22.m2.1" class="ltx_Math" alttext="\nabla_{u_{\phi}}" display="inline"><semantics id="algx1.l22.m2.1a"><msub id="algx1.l22.m2.1.1" xref="algx1.l22.m2.1.1.cmml"><mo id="algx1.l22.m2.1.1.2" xref="algx1.l22.m2.1.1.2.cmml">∇</mo><msub id="algx1.l22.m2.1.1.3" xref="algx1.l22.m2.1.1.3.cmml"><mi id="algx1.l22.m2.1.1.3.2" xref="algx1.l22.m2.1.1.3.2.cmml">u</mi><mi id="algx1.l22.m2.1.1.3.3" xref="algx1.l22.m2.1.1.3.3.cmml">ϕ</mi></msub></msub><annotation-xml encoding="MathML-Content" id="algx1.l22.m2.1b"><apply id="algx1.l22.m2.1.1.cmml" xref="algx1.l22.m2.1.1"><csymbol cd="ambiguous" id="algx1.l22.m2.1.1.1.cmml" xref="algx1.l22.m2.1.1">subscript</csymbol><ci id="algx1.l22.m2.1.1.2.cmml" xref="algx1.l22.m2.1.1.2">∇</ci><apply id="algx1.l22.m2.1.1.3.cmml" xref="algx1.l22.m2.1.1.3"><csymbol cd="ambiguous" id="algx1.l22.m2.1.1.3.1.cmml" xref="algx1.l22.m2.1.1.3">subscript</csymbol><ci id="algx1.l22.m2.1.1.3.2.cmml" xref="algx1.l22.m2.1.1.3.2">𝑢</ci><ci id="algx1.l22.m2.1.1.3.3.cmml" xref="algx1.l22.m2.1.1.3.3">italic-ϕ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l22.m2.1c">\nabla_{u_{\phi}}</annotation></semantics></math>
<span id="algx1.l22.2" class="ltx_text ltx_font_bold">Server Update</span>

</div>
<div id="algx1.l23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l23.1.1.1" class="ltx_text" style="font-size:80%;">23:</span></span>     <span id="algx1.l23.2" class="ltx_text ltx_font_bold">Given: </span> Gradient updates <math id="algx1.l23.m1.1" class="ltx_Math" alttext="\nabla_{u_{\theta}}" display="inline"><semantics id="algx1.l23.m1.1a"><msub id="algx1.l23.m1.1.1" xref="algx1.l23.m1.1.1.cmml"><mo id="algx1.l23.m1.1.1.2" xref="algx1.l23.m1.1.1.2.cmml">∇</mo><msub id="algx1.l23.m1.1.1.3" xref="algx1.l23.m1.1.1.3.cmml"><mi id="algx1.l23.m1.1.1.3.2" xref="algx1.l23.m1.1.1.3.2.cmml">u</mi><mi id="algx1.l23.m1.1.1.3.3" xref="algx1.l23.m1.1.1.3.3.cmml">θ</mi></msub></msub><annotation-xml encoding="MathML-Content" id="algx1.l23.m1.1b"><apply id="algx1.l23.m1.1.1.cmml" xref="algx1.l23.m1.1.1"><csymbol cd="ambiguous" id="algx1.l23.m1.1.1.1.cmml" xref="algx1.l23.m1.1.1">subscript</csymbol><ci id="algx1.l23.m1.1.1.2.cmml" xref="algx1.l23.m1.1.1.2">∇</ci><apply id="algx1.l23.m1.1.1.3.cmml" xref="algx1.l23.m1.1.1.3"><csymbol cd="ambiguous" id="algx1.l23.m1.1.1.3.1.cmml" xref="algx1.l23.m1.1.1.3">subscript</csymbol><ci id="algx1.l23.m1.1.1.3.2.cmml" xref="algx1.l23.m1.1.1.3.2">𝑢</ci><ci id="algx1.l23.m1.1.1.3.3.cmml" xref="algx1.l23.m1.1.1.3.3">𝜃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l23.m1.1c">\nabla_{u_{\theta}}</annotation></semantics></math> and <math id="algx1.l23.m2.1" class="ltx_Math" alttext="\nabla_{u_{\phi}}" display="inline"><semantics id="algx1.l23.m2.1a"><msub id="algx1.l23.m2.1.1" xref="algx1.l23.m2.1.1.cmml"><mo id="algx1.l23.m2.1.1.2" xref="algx1.l23.m2.1.1.2.cmml">∇</mo><msub id="algx1.l23.m2.1.1.3" xref="algx1.l23.m2.1.1.3.cmml"><mi id="algx1.l23.m2.1.1.3.2" xref="algx1.l23.m2.1.1.3.2.cmml">u</mi><mi id="algx1.l23.m2.1.1.3.3" xref="algx1.l23.m2.1.1.3.3.cmml">ϕ</mi></msub></msub><annotation-xml encoding="MathML-Content" id="algx1.l23.m2.1b"><apply id="algx1.l23.m2.1.1.cmml" xref="algx1.l23.m2.1.1"><csymbol cd="ambiguous" id="algx1.l23.m2.1.1.1.cmml" xref="algx1.l23.m2.1.1">subscript</csymbol><ci id="algx1.l23.m2.1.1.2.cmml" xref="algx1.l23.m2.1.1.2">∇</ci><apply id="algx1.l23.m2.1.1.3.cmml" xref="algx1.l23.m2.1.1.3"><csymbol cd="ambiguous" id="algx1.l23.m2.1.1.3.1.cmml" xref="algx1.l23.m2.1.1.3">subscript</csymbol><ci id="algx1.l23.m2.1.1.3.2.cmml" xref="algx1.l23.m2.1.1.3.2">𝑢</ci><ci id="algx1.l23.m2.1.1.3.3.cmml" xref="algx1.l23.m2.1.1.3.3">italic-ϕ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l23.m2.1c">\nabla_{u_{\phi}}</annotation></semantics></math> from active users <math id="algx1.l23.m3.1" class="ltx_Math" alttext="u\in[U]" display="inline"><semantics id="algx1.l23.m3.1a"><mrow id="algx1.l23.m3.1.2" xref="algx1.l23.m3.1.2.cmml"><mi id="algx1.l23.m3.1.2.2" xref="algx1.l23.m3.1.2.2.cmml">u</mi><mo id="algx1.l23.m3.1.2.1" xref="algx1.l23.m3.1.2.1.cmml">∈</mo><mrow id="algx1.l23.m3.1.2.3.2" xref="algx1.l23.m3.1.2.3.1.cmml"><mo stretchy="false" id="algx1.l23.m3.1.2.3.2.1" xref="algx1.l23.m3.1.2.3.1.1.cmml">[</mo><mi id="algx1.l23.m3.1.1" xref="algx1.l23.m3.1.1.cmml">U</mi><mo stretchy="false" id="algx1.l23.m3.1.2.3.2.2" xref="algx1.l23.m3.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l23.m3.1b"><apply id="algx1.l23.m3.1.2.cmml" xref="algx1.l23.m3.1.2"><in id="algx1.l23.m3.1.2.1.cmml" xref="algx1.l23.m3.1.2.1"></in><ci id="algx1.l23.m3.1.2.2.cmml" xref="algx1.l23.m3.1.2.2">𝑢</ci><apply id="algx1.l23.m3.1.2.3.1.cmml" xref="algx1.l23.m3.1.2.3.2"><csymbol cd="latexml" id="algx1.l23.m3.1.2.3.1.1.cmml" xref="algx1.l23.m3.1.2.3.2.1">delimited-[]</csymbol><ci id="algx1.l23.m3.1.1.cmml" xref="algx1.l23.m3.1.1">𝑈</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l23.m3.1c">u\in[U]</annotation></semantics></math>

</div>
<div id="algx1.l24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l24.1.1.1" class="ltx_text" style="font-size:80%;">24:</span></span>     <math id="algx1.l24.m1.1" class="ltx_Math" alttext="\nabla_{\theta}=\frac{1}{U}\sum_{u=0}^{U}\nabla_{u_{\theta}}" display="inline"><semantics id="algx1.l24.m1.1a"><mrow id="algx1.l24.m1.1.1" xref="algx1.l24.m1.1.1.cmml"><msub id="algx1.l24.m1.1.1.2" xref="algx1.l24.m1.1.1.2.cmml"><mo id="algx1.l24.m1.1.1.2.2" xref="algx1.l24.m1.1.1.2.2.cmml">∇</mo><mi id="algx1.l24.m1.1.1.2.3" xref="algx1.l24.m1.1.1.2.3.cmml">θ</mi></msub><mo id="algx1.l24.m1.1.1.1" xref="algx1.l24.m1.1.1.1.cmml">=</mo><mrow id="algx1.l24.m1.1.1.3" xref="algx1.l24.m1.1.1.3.cmml"><mfrac id="algx1.l24.m1.1.1.3.2" xref="algx1.l24.m1.1.1.3.2.cmml"><mn id="algx1.l24.m1.1.1.3.2.2" xref="algx1.l24.m1.1.1.3.2.2.cmml">1</mn><mi id="algx1.l24.m1.1.1.3.2.3" xref="algx1.l24.m1.1.1.3.2.3.cmml">U</mi></mfrac><mo lspace="0em" rspace="0em" id="algx1.l24.m1.1.1.3.1" xref="algx1.l24.m1.1.1.3.1.cmml">​</mo><mrow id="algx1.l24.m1.1.1.3.3" xref="algx1.l24.m1.1.1.3.3.cmml"><msubsup id="algx1.l24.m1.1.1.3.3.1" xref="algx1.l24.m1.1.1.3.3.1.cmml"><mo id="algx1.l24.m1.1.1.3.3.1.2.2" xref="algx1.l24.m1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="algx1.l24.m1.1.1.3.3.1.2.3" xref="algx1.l24.m1.1.1.3.3.1.2.3.cmml"><mi id="algx1.l24.m1.1.1.3.3.1.2.3.2" xref="algx1.l24.m1.1.1.3.3.1.2.3.2.cmml">u</mi><mo id="algx1.l24.m1.1.1.3.3.1.2.3.1" xref="algx1.l24.m1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="algx1.l24.m1.1.1.3.3.1.2.3.3" xref="algx1.l24.m1.1.1.3.3.1.2.3.3.cmml">0</mn></mrow><mi id="algx1.l24.m1.1.1.3.3.1.3" xref="algx1.l24.m1.1.1.3.3.1.3.cmml">U</mi></msubsup><msub id="algx1.l24.m1.1.1.3.3.2" xref="algx1.l24.m1.1.1.3.3.2.cmml"><mo id="algx1.l24.m1.1.1.3.3.2.2" xref="algx1.l24.m1.1.1.3.3.2.2.cmml">∇</mo><msub id="algx1.l24.m1.1.1.3.3.2.3" xref="algx1.l24.m1.1.1.3.3.2.3.cmml"><mi id="algx1.l24.m1.1.1.3.3.2.3.2" xref="algx1.l24.m1.1.1.3.3.2.3.2.cmml">u</mi><mi id="algx1.l24.m1.1.1.3.3.2.3.3" xref="algx1.l24.m1.1.1.3.3.2.3.3.cmml">θ</mi></msub></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l24.m1.1b"><apply id="algx1.l24.m1.1.1.cmml" xref="algx1.l24.m1.1.1"><eq id="algx1.l24.m1.1.1.1.cmml" xref="algx1.l24.m1.1.1.1"></eq><apply id="algx1.l24.m1.1.1.2.cmml" xref="algx1.l24.m1.1.1.2"><csymbol cd="ambiguous" id="algx1.l24.m1.1.1.2.1.cmml" xref="algx1.l24.m1.1.1.2">subscript</csymbol><ci id="algx1.l24.m1.1.1.2.2.cmml" xref="algx1.l24.m1.1.1.2.2">∇</ci><ci id="algx1.l24.m1.1.1.2.3.cmml" xref="algx1.l24.m1.1.1.2.3">𝜃</ci></apply><apply id="algx1.l24.m1.1.1.3.cmml" xref="algx1.l24.m1.1.1.3"><times id="algx1.l24.m1.1.1.3.1.cmml" xref="algx1.l24.m1.1.1.3.1"></times><apply id="algx1.l24.m1.1.1.3.2.cmml" xref="algx1.l24.m1.1.1.3.2"><divide id="algx1.l24.m1.1.1.3.2.1.cmml" xref="algx1.l24.m1.1.1.3.2"></divide><cn type="integer" id="algx1.l24.m1.1.1.3.2.2.cmml" xref="algx1.l24.m1.1.1.3.2.2">1</cn><ci id="algx1.l24.m1.1.1.3.2.3.cmml" xref="algx1.l24.m1.1.1.3.2.3">𝑈</ci></apply><apply id="algx1.l24.m1.1.1.3.3.cmml" xref="algx1.l24.m1.1.1.3.3"><apply id="algx1.l24.m1.1.1.3.3.1.cmml" xref="algx1.l24.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="algx1.l24.m1.1.1.3.3.1.1.cmml" xref="algx1.l24.m1.1.1.3.3.1">superscript</csymbol><apply id="algx1.l24.m1.1.1.3.3.1.2.cmml" xref="algx1.l24.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="algx1.l24.m1.1.1.3.3.1.2.1.cmml" xref="algx1.l24.m1.1.1.3.3.1">subscript</csymbol><sum id="algx1.l24.m1.1.1.3.3.1.2.2.cmml" xref="algx1.l24.m1.1.1.3.3.1.2.2"></sum><apply id="algx1.l24.m1.1.1.3.3.1.2.3.cmml" xref="algx1.l24.m1.1.1.3.3.1.2.3"><eq id="algx1.l24.m1.1.1.3.3.1.2.3.1.cmml" xref="algx1.l24.m1.1.1.3.3.1.2.3.1"></eq><ci id="algx1.l24.m1.1.1.3.3.1.2.3.2.cmml" xref="algx1.l24.m1.1.1.3.3.1.2.3.2">𝑢</ci><cn type="integer" id="algx1.l24.m1.1.1.3.3.1.2.3.3.cmml" xref="algx1.l24.m1.1.1.3.3.1.2.3.3">0</cn></apply></apply><ci id="algx1.l24.m1.1.1.3.3.1.3.cmml" xref="algx1.l24.m1.1.1.3.3.1.3">𝑈</ci></apply><apply id="algx1.l24.m1.1.1.3.3.2.cmml" xref="algx1.l24.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="algx1.l24.m1.1.1.3.3.2.1.cmml" xref="algx1.l24.m1.1.1.3.3.2">subscript</csymbol><ci id="algx1.l24.m1.1.1.3.3.2.2.cmml" xref="algx1.l24.m1.1.1.3.3.2.2">∇</ci><apply id="algx1.l24.m1.1.1.3.3.2.3.cmml" xref="algx1.l24.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="algx1.l24.m1.1.1.3.3.2.3.1.cmml" xref="algx1.l24.m1.1.1.3.3.2.3">subscript</csymbol><ci id="algx1.l24.m1.1.1.3.3.2.3.2.cmml" xref="algx1.l24.m1.1.1.3.3.2.3.2">𝑢</ci><ci id="algx1.l24.m1.1.1.3.3.2.3.3.cmml" xref="algx1.l24.m1.1.1.3.3.2.3.3">𝜃</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l24.m1.1c">\nabla_{\theta}=\frac{1}{U}\sum_{u=0}^{U}\nabla_{u_{\theta}}</annotation></semantics></math>

</div>
<div id="algx1.l25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l25.1.1.1" class="ltx_text" style="font-size:80%;">25:</span></span>     <math id="algx1.l25.m1.1" class="ltx_Math" alttext="\nabla_{\phi}=\frac{1}{U}\sum_{u=0}^{U}\nabla_{u_{\phi}}" display="inline"><semantics id="algx1.l25.m1.1a"><mrow id="algx1.l25.m1.1.1" xref="algx1.l25.m1.1.1.cmml"><msub id="algx1.l25.m1.1.1.2" xref="algx1.l25.m1.1.1.2.cmml"><mo id="algx1.l25.m1.1.1.2.2" xref="algx1.l25.m1.1.1.2.2.cmml">∇</mo><mi id="algx1.l25.m1.1.1.2.3" xref="algx1.l25.m1.1.1.2.3.cmml">ϕ</mi></msub><mo id="algx1.l25.m1.1.1.1" xref="algx1.l25.m1.1.1.1.cmml">=</mo><mrow id="algx1.l25.m1.1.1.3" xref="algx1.l25.m1.1.1.3.cmml"><mfrac id="algx1.l25.m1.1.1.3.2" xref="algx1.l25.m1.1.1.3.2.cmml"><mn id="algx1.l25.m1.1.1.3.2.2" xref="algx1.l25.m1.1.1.3.2.2.cmml">1</mn><mi id="algx1.l25.m1.1.1.3.2.3" xref="algx1.l25.m1.1.1.3.2.3.cmml">U</mi></mfrac><mo lspace="0em" rspace="0em" id="algx1.l25.m1.1.1.3.1" xref="algx1.l25.m1.1.1.3.1.cmml">​</mo><mrow id="algx1.l25.m1.1.1.3.3" xref="algx1.l25.m1.1.1.3.3.cmml"><msubsup id="algx1.l25.m1.1.1.3.3.1" xref="algx1.l25.m1.1.1.3.3.1.cmml"><mo id="algx1.l25.m1.1.1.3.3.1.2.2" xref="algx1.l25.m1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="algx1.l25.m1.1.1.3.3.1.2.3" xref="algx1.l25.m1.1.1.3.3.1.2.3.cmml"><mi id="algx1.l25.m1.1.1.3.3.1.2.3.2" xref="algx1.l25.m1.1.1.3.3.1.2.3.2.cmml">u</mi><mo id="algx1.l25.m1.1.1.3.3.1.2.3.1" xref="algx1.l25.m1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="algx1.l25.m1.1.1.3.3.1.2.3.3" xref="algx1.l25.m1.1.1.3.3.1.2.3.3.cmml">0</mn></mrow><mi id="algx1.l25.m1.1.1.3.3.1.3" xref="algx1.l25.m1.1.1.3.3.1.3.cmml">U</mi></msubsup><msub id="algx1.l25.m1.1.1.3.3.2" xref="algx1.l25.m1.1.1.3.3.2.cmml"><mo id="algx1.l25.m1.1.1.3.3.2.2" xref="algx1.l25.m1.1.1.3.3.2.2.cmml">∇</mo><msub id="algx1.l25.m1.1.1.3.3.2.3" xref="algx1.l25.m1.1.1.3.3.2.3.cmml"><mi id="algx1.l25.m1.1.1.3.3.2.3.2" xref="algx1.l25.m1.1.1.3.3.2.3.2.cmml">u</mi><mi id="algx1.l25.m1.1.1.3.3.2.3.3" xref="algx1.l25.m1.1.1.3.3.2.3.3.cmml">ϕ</mi></msub></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l25.m1.1b"><apply id="algx1.l25.m1.1.1.cmml" xref="algx1.l25.m1.1.1"><eq id="algx1.l25.m1.1.1.1.cmml" xref="algx1.l25.m1.1.1.1"></eq><apply id="algx1.l25.m1.1.1.2.cmml" xref="algx1.l25.m1.1.1.2"><csymbol cd="ambiguous" id="algx1.l25.m1.1.1.2.1.cmml" xref="algx1.l25.m1.1.1.2">subscript</csymbol><ci id="algx1.l25.m1.1.1.2.2.cmml" xref="algx1.l25.m1.1.1.2.2">∇</ci><ci id="algx1.l25.m1.1.1.2.3.cmml" xref="algx1.l25.m1.1.1.2.3">italic-ϕ</ci></apply><apply id="algx1.l25.m1.1.1.3.cmml" xref="algx1.l25.m1.1.1.3"><times id="algx1.l25.m1.1.1.3.1.cmml" xref="algx1.l25.m1.1.1.3.1"></times><apply id="algx1.l25.m1.1.1.3.2.cmml" xref="algx1.l25.m1.1.1.3.2"><divide id="algx1.l25.m1.1.1.3.2.1.cmml" xref="algx1.l25.m1.1.1.3.2"></divide><cn type="integer" id="algx1.l25.m1.1.1.3.2.2.cmml" xref="algx1.l25.m1.1.1.3.2.2">1</cn><ci id="algx1.l25.m1.1.1.3.2.3.cmml" xref="algx1.l25.m1.1.1.3.2.3">𝑈</ci></apply><apply id="algx1.l25.m1.1.1.3.3.cmml" xref="algx1.l25.m1.1.1.3.3"><apply id="algx1.l25.m1.1.1.3.3.1.cmml" xref="algx1.l25.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="algx1.l25.m1.1.1.3.3.1.1.cmml" xref="algx1.l25.m1.1.1.3.3.1">superscript</csymbol><apply id="algx1.l25.m1.1.1.3.3.1.2.cmml" xref="algx1.l25.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="algx1.l25.m1.1.1.3.3.1.2.1.cmml" xref="algx1.l25.m1.1.1.3.3.1">subscript</csymbol><sum id="algx1.l25.m1.1.1.3.3.1.2.2.cmml" xref="algx1.l25.m1.1.1.3.3.1.2.2"></sum><apply id="algx1.l25.m1.1.1.3.3.1.2.3.cmml" xref="algx1.l25.m1.1.1.3.3.1.2.3"><eq id="algx1.l25.m1.1.1.3.3.1.2.3.1.cmml" xref="algx1.l25.m1.1.1.3.3.1.2.3.1"></eq><ci id="algx1.l25.m1.1.1.3.3.1.2.3.2.cmml" xref="algx1.l25.m1.1.1.3.3.1.2.3.2">𝑢</ci><cn type="integer" id="algx1.l25.m1.1.1.3.3.1.2.3.3.cmml" xref="algx1.l25.m1.1.1.3.3.1.2.3.3">0</cn></apply></apply><ci id="algx1.l25.m1.1.1.3.3.1.3.cmml" xref="algx1.l25.m1.1.1.3.3.1.3">𝑈</ci></apply><apply id="algx1.l25.m1.1.1.3.3.2.cmml" xref="algx1.l25.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="algx1.l25.m1.1.1.3.3.2.1.cmml" xref="algx1.l25.m1.1.1.3.3.2">subscript</csymbol><ci id="algx1.l25.m1.1.1.3.3.2.2.cmml" xref="algx1.l25.m1.1.1.3.3.2.2">∇</ci><apply id="algx1.l25.m1.1.1.3.3.2.3.cmml" xref="algx1.l25.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="algx1.l25.m1.1.1.3.3.2.3.1.cmml" xref="algx1.l25.m1.1.1.3.3.2.3">subscript</csymbol><ci id="algx1.l25.m1.1.1.3.3.2.3.2.cmml" xref="algx1.l25.m1.1.1.3.3.2.3.2">𝑢</ci><ci id="algx1.l25.m1.1.1.3.3.2.3.3.cmml" xref="algx1.l25.m1.1.1.3.3.2.3.3">italic-ϕ</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l25.m1.1c">\nabla_{\phi}=\frac{1}{U}\sum_{u=0}^{U}\nabla_{u_{\phi}}</annotation></semantics></math>

</div>
<div id="algx1.l26" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l26.1.1.1" class="ltx_text" style="font-size:80%;">26:</span></span>     Optionally, add differential privacy to <math id="algx1.l26.m1.1" class="ltx_Math" alttext="\nabla_{\theta}" display="inline"><semantics id="algx1.l26.m1.1a"><msub id="algx1.l26.m1.1.1" xref="algx1.l26.m1.1.1.cmml"><mo id="algx1.l26.m1.1.1.2" xref="algx1.l26.m1.1.1.2.cmml">∇</mo><mi id="algx1.l26.m1.1.1.3" xref="algx1.l26.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="algx1.l26.m1.1b"><apply id="algx1.l26.m1.1.1.cmml" xref="algx1.l26.m1.1.1"><csymbol cd="ambiguous" id="algx1.l26.m1.1.1.1.cmml" xref="algx1.l26.m1.1.1">subscript</csymbol><ci id="algx1.l26.m1.1.1.2.cmml" xref="algx1.l26.m1.1.1.2">∇</ci><ci id="algx1.l26.m1.1.1.3.cmml" xref="algx1.l26.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l26.m1.1c">\nabla_{\theta}</annotation></semantics></math> and <math id="algx1.l26.m2.1" class="ltx_Math" alttext="\nabla_{\phi}" display="inline"><semantics id="algx1.l26.m2.1a"><msub id="algx1.l26.m2.1.1" xref="algx1.l26.m2.1.1.cmml"><mo id="algx1.l26.m2.1.1.2" xref="algx1.l26.m2.1.1.2.cmml">∇</mo><mi id="algx1.l26.m2.1.1.3" xref="algx1.l26.m2.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="algx1.l26.m2.1b"><apply id="algx1.l26.m2.1.1.cmml" xref="algx1.l26.m2.1.1"><csymbol cd="ambiguous" id="algx1.l26.m2.1.1.1.cmml" xref="algx1.l26.m2.1.1">subscript</csymbol><ci id="algx1.l26.m2.1.1.2.cmml" xref="algx1.l26.m2.1.1.2">∇</ci><ci id="algx1.l26.m2.1.1.3.cmml" xref="algx1.l26.m2.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l26.m2.1c">\nabla_{\phi}</annotation></semantics></math>

</div>
<div id="algx1.l27" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l27.1.1.1" class="ltx_text" style="font-size:80%;">27:</span></span>     <math id="algx1.l27.m1.1" class="ltx_Math" alttext="\theta\leftarrow\theta+\alpha\nabla_{\theta}" display="inline"><semantics id="algx1.l27.m1.1a"><mrow id="algx1.l27.m1.1.1" xref="algx1.l27.m1.1.1.cmml"><mi id="algx1.l27.m1.1.1.2" xref="algx1.l27.m1.1.1.2.cmml">θ</mi><mo stretchy="false" id="algx1.l27.m1.1.1.1" xref="algx1.l27.m1.1.1.1.cmml">←</mo><mrow id="algx1.l27.m1.1.1.3" xref="algx1.l27.m1.1.1.3.cmml"><mi id="algx1.l27.m1.1.1.3.2" xref="algx1.l27.m1.1.1.3.2.cmml">θ</mi><mo id="algx1.l27.m1.1.1.3.1" xref="algx1.l27.m1.1.1.3.1.cmml">+</mo><mrow id="algx1.l27.m1.1.1.3.3" xref="algx1.l27.m1.1.1.3.3.cmml"><mi id="algx1.l27.m1.1.1.3.3.2" xref="algx1.l27.m1.1.1.3.3.2.cmml">α</mi><mo lspace="0.167em" rspace="0em" id="algx1.l27.m1.1.1.3.3.1" xref="algx1.l27.m1.1.1.3.3.1.cmml">​</mo><msub id="algx1.l27.m1.1.1.3.3.3" xref="algx1.l27.m1.1.1.3.3.3.cmml"><mo id="algx1.l27.m1.1.1.3.3.3.2" xref="algx1.l27.m1.1.1.3.3.3.2.cmml">∇</mo><mi id="algx1.l27.m1.1.1.3.3.3.3" xref="algx1.l27.m1.1.1.3.3.3.3.cmml">θ</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l27.m1.1b"><apply id="algx1.l27.m1.1.1.cmml" xref="algx1.l27.m1.1.1"><ci id="algx1.l27.m1.1.1.1.cmml" xref="algx1.l27.m1.1.1.1">←</ci><ci id="algx1.l27.m1.1.1.2.cmml" xref="algx1.l27.m1.1.1.2">𝜃</ci><apply id="algx1.l27.m1.1.1.3.cmml" xref="algx1.l27.m1.1.1.3"><plus id="algx1.l27.m1.1.1.3.1.cmml" xref="algx1.l27.m1.1.1.3.1"></plus><ci id="algx1.l27.m1.1.1.3.2.cmml" xref="algx1.l27.m1.1.1.3.2">𝜃</ci><apply id="algx1.l27.m1.1.1.3.3.cmml" xref="algx1.l27.m1.1.1.3.3"><times id="algx1.l27.m1.1.1.3.3.1.cmml" xref="algx1.l27.m1.1.1.3.3.1"></times><ci id="algx1.l27.m1.1.1.3.3.2.cmml" xref="algx1.l27.m1.1.1.3.3.2">𝛼</ci><apply id="algx1.l27.m1.1.1.3.3.3.cmml" xref="algx1.l27.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="algx1.l27.m1.1.1.3.3.3.1.cmml" xref="algx1.l27.m1.1.1.3.3.3">subscript</csymbol><ci id="algx1.l27.m1.1.1.3.3.3.2.cmml" xref="algx1.l27.m1.1.1.3.3.3.2">∇</ci><ci id="algx1.l27.m1.1.1.3.3.3.3.cmml" xref="algx1.l27.m1.1.1.3.3.3.3">𝜃</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l27.m1.1c">\theta\leftarrow\theta+\alpha\nabla_{\theta}</annotation></semantics></math>

</div>
<div id="algx1.l28" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l28.1.1.1" class="ltx_text" style="font-size:80%;">28:</span></span>     <math id="algx1.l28.m1.1" class="ltx_Math" alttext="\phi\leftarrow\phi+\alpha\nabla_{\phi}" display="inline"><semantics id="algx1.l28.m1.1a"><mrow id="algx1.l28.m1.1.1" xref="algx1.l28.m1.1.1.cmml"><mi id="algx1.l28.m1.1.1.2" xref="algx1.l28.m1.1.1.2.cmml">ϕ</mi><mo stretchy="false" id="algx1.l28.m1.1.1.1" xref="algx1.l28.m1.1.1.1.cmml">←</mo><mrow id="algx1.l28.m1.1.1.3" xref="algx1.l28.m1.1.1.3.cmml"><mi id="algx1.l28.m1.1.1.3.2" xref="algx1.l28.m1.1.1.3.2.cmml">ϕ</mi><mo id="algx1.l28.m1.1.1.3.1" xref="algx1.l28.m1.1.1.3.1.cmml">+</mo><mrow id="algx1.l28.m1.1.1.3.3" xref="algx1.l28.m1.1.1.3.3.cmml"><mi id="algx1.l28.m1.1.1.3.3.2" xref="algx1.l28.m1.1.1.3.3.2.cmml">α</mi><mo lspace="0.167em" rspace="0em" id="algx1.l28.m1.1.1.3.3.1" xref="algx1.l28.m1.1.1.3.3.1.cmml">​</mo><msub id="algx1.l28.m1.1.1.3.3.3" xref="algx1.l28.m1.1.1.3.3.3.cmml"><mo id="algx1.l28.m1.1.1.3.3.3.2" xref="algx1.l28.m1.1.1.3.3.3.2.cmml">∇</mo><mi id="algx1.l28.m1.1.1.3.3.3.3" xref="algx1.l28.m1.1.1.3.3.3.3.cmml">ϕ</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l28.m1.1b"><apply id="algx1.l28.m1.1.1.cmml" xref="algx1.l28.m1.1.1"><ci id="algx1.l28.m1.1.1.1.cmml" xref="algx1.l28.m1.1.1.1">←</ci><ci id="algx1.l28.m1.1.1.2.cmml" xref="algx1.l28.m1.1.1.2">italic-ϕ</ci><apply id="algx1.l28.m1.1.1.3.cmml" xref="algx1.l28.m1.1.1.3"><plus id="algx1.l28.m1.1.1.3.1.cmml" xref="algx1.l28.m1.1.1.3.1"></plus><ci id="algx1.l28.m1.1.1.3.2.cmml" xref="algx1.l28.m1.1.1.3.2">italic-ϕ</ci><apply id="algx1.l28.m1.1.1.3.3.cmml" xref="algx1.l28.m1.1.1.3.3"><times id="algx1.l28.m1.1.1.3.3.1.cmml" xref="algx1.l28.m1.1.1.3.3.1"></times><ci id="algx1.l28.m1.1.1.3.3.2.cmml" xref="algx1.l28.m1.1.1.3.3.2">𝛼</ci><apply id="algx1.l28.m1.1.1.3.3.3.cmml" xref="algx1.l28.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="algx1.l28.m1.1.1.3.3.3.1.cmml" xref="algx1.l28.m1.1.1.3.3.3">subscript</csymbol><ci id="algx1.l28.m1.1.1.3.3.3.2.cmml" xref="algx1.l28.m1.1.1.3.3.3.2">∇</ci><ci id="algx1.l28.m1.1.1.3.3.3.3.cmml" xref="algx1.l28.m1.1.1.3.3.3.3">italic-ϕ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l28.m1.1c">\phi\leftarrow\phi+\alpha\nabla_{\phi}</annotation></semantics></math>

</div>
<div id="algx1.l29" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algx1.l29.1.1.1" class="ltx_text" style="font-size:80%;">29:</span></span>  <span id="algx1.l29.2" class="ltx_text ltx_font_bold">end</span> <span id="algx1.l29.3" class="ltx_text ltx_font_bold">while</span>
</div>
</div>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Architecture Descriptions</h2>

<section id="A2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>MNIST Models</h3>

<div id="A2.SS1.p1" class="ltx_para">
<p id="A2.SS1.p1.2" class="ltx_p">The architectures for the MNIST experiments are as follows (following the PyTorch API), where an input image <math id="A2.SS1.p1.1.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="A2.SS1.p1.1.m1.1a"><mi id="A2.SS1.p1.1.m1.1.1" xref="A2.SS1.p1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.1.m1.1b"><ci id="A2.SS1.p1.1.m1.1.1.cmml" xref="A2.SS1.p1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.1.m1.1c">x</annotation></semantics></math> has dimensions <math id="A2.SS1.p1.2.m2.1" class="ltx_Math" alttext="x\in\mathbb{R}^{(28\times 28\times 2)}" display="inline"><semantics id="A2.SS1.p1.2.m2.1a"><mrow id="A2.SS1.p1.2.m2.1.2" xref="A2.SS1.p1.2.m2.1.2.cmml"><mi id="A2.SS1.p1.2.m2.1.2.2" xref="A2.SS1.p1.2.m2.1.2.2.cmml">x</mi><mo id="A2.SS1.p1.2.m2.1.2.1" xref="A2.SS1.p1.2.m2.1.2.1.cmml">∈</mo><msup id="A2.SS1.p1.2.m2.1.2.3" xref="A2.SS1.p1.2.m2.1.2.3.cmml"><mi id="A2.SS1.p1.2.m2.1.2.3.2" xref="A2.SS1.p1.2.m2.1.2.3.2.cmml">ℝ</mi><mrow id="A2.SS1.p1.2.m2.1.1.1.1" xref="A2.SS1.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.SS1.p1.2.m2.1.1.1.1.2" xref="A2.SS1.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="A2.SS1.p1.2.m2.1.1.1.1.1" xref="A2.SS1.p1.2.m2.1.1.1.1.1.cmml"><mn id="A2.SS1.p1.2.m2.1.1.1.1.1.2" xref="A2.SS1.p1.2.m2.1.1.1.1.1.2.cmml">28</mn><mo lspace="0.222em" rspace="0.222em" id="A2.SS1.p1.2.m2.1.1.1.1.1.1" xref="A2.SS1.p1.2.m2.1.1.1.1.1.1.cmml">×</mo><mn id="A2.SS1.p1.2.m2.1.1.1.1.1.3" xref="A2.SS1.p1.2.m2.1.1.1.1.1.3.cmml">28</mn><mo lspace="0.222em" rspace="0.222em" id="A2.SS1.p1.2.m2.1.1.1.1.1.1a" xref="A2.SS1.p1.2.m2.1.1.1.1.1.1.cmml">×</mo><mn id="A2.SS1.p1.2.m2.1.1.1.1.1.4" xref="A2.SS1.p1.2.m2.1.1.1.1.1.4.cmml">2</mn></mrow><mo stretchy="false" id="A2.SS1.p1.2.m2.1.1.1.1.3" xref="A2.SS1.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.2.m2.1b"><apply id="A2.SS1.p1.2.m2.1.2.cmml" xref="A2.SS1.p1.2.m2.1.2"><in id="A2.SS1.p1.2.m2.1.2.1.cmml" xref="A2.SS1.p1.2.m2.1.2.1"></in><ci id="A2.SS1.p1.2.m2.1.2.2.cmml" xref="A2.SS1.p1.2.m2.1.2.2">𝑥</ci><apply id="A2.SS1.p1.2.m2.1.2.3.cmml" xref="A2.SS1.p1.2.m2.1.2.3"><csymbol cd="ambiguous" id="A2.SS1.p1.2.m2.1.2.3.1.cmml" xref="A2.SS1.p1.2.m2.1.2.3">superscript</csymbol><ci id="A2.SS1.p1.2.m2.1.2.3.2.cmml" xref="A2.SS1.p1.2.m2.1.2.3.2">ℝ</ci><apply id="A2.SS1.p1.2.m2.1.1.1.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1.1.1"><times id="A2.SS1.p1.2.m2.1.1.1.1.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1.1.1.1.1"></times><cn type="integer" id="A2.SS1.p1.2.m2.1.1.1.1.1.2.cmml" xref="A2.SS1.p1.2.m2.1.1.1.1.1.2">28</cn><cn type="integer" id="A2.SS1.p1.2.m2.1.1.1.1.1.3.cmml" xref="A2.SS1.p1.2.m2.1.1.1.1.1.3">28</cn><cn type="integer" id="A2.SS1.p1.2.m2.1.1.1.1.1.4.cmml" xref="A2.SS1.p1.2.m2.1.1.1.1.1.4">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.2.m2.1c">x\in\mathbb{R}^{(28\times 28\times 2)}</annotation></semantics></math>:</p>
</div>
<div id="A2.SS1.p2" class="ltx_para ltx_minipage ltx_align_top" style="width:238.5pt;">
<div id="A2.SS1.p2.1" class="ltx_listing ltx_lst_language_Python ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain;base64,IyBmZWF0dXJlIGVuY29kZXIgc2hhcmVkIGJ5IGFsbAojIHN1Yi1wb3B1bGF0aW9uIHByZWRpY3Rpb24gaGVhZHMKZ2xvYmFsX2VuY29kZXIgPSBTZXF1ZW50aWFsKAogICAgIENvbnYyZCgyLCAxNiwgMywgc3RyaWRlPTIsIHBhZGRpbmc9MSksCiAgICAgTGF5ZXJOb3JtKFsxNiwgMTQsIDE0XSksCiAgICAgQ29udjJkKDE2LCAzMiwgMywgc3RyaWRlPTIsIHBhZGRpbmc9MSksCiAgICAgTGF5ZXJOb3JtKFszMiwgNywgN10pLAogICAgIENvbnYyZCgzMiwgNjQsIDcsIHN0cmlkZT0xLCBwYWRkaW5nPTApLAogICAgIExheWVyTm9ybShbNjQsIDEsIDFdKQogICkK" download="">⬇</a></div>
<div id="lstnumberx1" class="ltx_listingline">
<span id="lstnumberx1.1" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="font-size:80%;color:#009900;">#<span id="lstnumberx1.1.1" class="ltx_text ltx_lst_space"> </span>feature<span id="lstnumberx1.1.2" class="ltx_text ltx_lst_space"> </span>encoder<span id="lstnumberx1.1.3" class="ltx_text ltx_lst_space"> </span>shared<span id="lstnumberx1.1.4" class="ltx_text ltx_lst_space"> </span>by<span id="lstnumberx1.1.5" class="ltx_text ltx_lst_space"> </span>all</span>
</div>
<div id="lstnumberx2" class="ltx_listingline">
<span id="lstnumberx2.1" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="font-size:80%;color:#009900;">#<span id="lstnumberx2.1.1" class="ltx_text ltx_lst_space"> </span>sub-population<span id="lstnumberx2.1.2" class="ltx_text ltx_lst_space"> </span>prediction<span id="lstnumberx2.1.3" class="ltx_text ltx_lst_space"> </span>heads</span>
</div>
<div id="lstnumberx3" class="ltx_listingline">
<span id="lstnumberx3.1" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">global_encoder</span><span id="lstnumberx3.2" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx3.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">=</span><span id="lstnumberx3.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx3.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">Sequential</span><span id="lstnumberx3.6" class="ltx_text ltx_font_typewriter" style="font-size:80%;">(</span>
</div>
<div id="lstnumberx4" class="ltx_listingline">
<span id="lstnumberx4.1" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;">     </span><span id="lstnumberx4.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">Conv2d</span><span id="lstnumberx4.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">(2,</span><span id="lstnumberx4.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx4.5" class="ltx_text ltx_font_typewriter" style="font-size:80%;">16,</span><span id="lstnumberx4.6" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx4.7" class="ltx_text ltx_font_typewriter" style="font-size:80%;">3,</span><span id="lstnumberx4.8" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx4.9" class="ltx_text ltx_lst_emph ltx_font_typewriter" style="font-size:80%;color:#ED9121;">stride</span><span id="lstnumberx4.10" class="ltx_text ltx_font_typewriter" style="font-size:80%;">=2,</span><span id="lstnumberx4.11" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx4.12" class="ltx_text ltx_lst_emph ltx_font_typewriter" style="font-size:80%;color:#ED9121;">padding</span><span id="lstnumberx4.13" class="ltx_text ltx_font_typewriter" style="font-size:80%;">=1),</span>
</div>
<div id="lstnumberx5" class="ltx_listingline">
<span id="lstnumberx5.1" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;">     </span><span id="lstnumberx5.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">LayerNorm</span><span id="lstnumberx5.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">([16,</span><span id="lstnumberx5.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx5.5" class="ltx_text ltx_font_typewriter" style="font-size:80%;">14,</span><span id="lstnumberx5.6" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx5.7" class="ltx_text ltx_font_typewriter" style="font-size:80%;">14]),</span>
</div>
<div id="lstnumberx6" class="ltx_listingline">
<span id="lstnumberx6.1" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;">     </span><span id="lstnumberx6.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">Conv2d</span><span id="lstnumberx6.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">(16,</span><span id="lstnumberx6.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx6.5" class="ltx_text ltx_font_typewriter" style="font-size:80%;">32,</span><span id="lstnumberx6.6" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx6.7" class="ltx_text ltx_font_typewriter" style="font-size:80%;">3,</span><span id="lstnumberx6.8" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx6.9" class="ltx_text ltx_lst_emph ltx_font_typewriter" style="font-size:80%;color:#ED9121;">stride</span><span id="lstnumberx6.10" class="ltx_text ltx_font_typewriter" style="font-size:80%;">=2,</span><span id="lstnumberx6.11" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx6.12" class="ltx_text ltx_lst_emph ltx_font_typewriter" style="font-size:80%;color:#ED9121;">padding</span><span id="lstnumberx6.13" class="ltx_text ltx_font_typewriter" style="font-size:80%;">=1),</span>
</div>
<div id="lstnumberx7" class="ltx_listingline">
<span id="lstnumberx7.1" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;">     </span><span id="lstnumberx7.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">LayerNorm</span><span id="lstnumberx7.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">([32,</span><span id="lstnumberx7.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx7.5" class="ltx_text ltx_font_typewriter" style="font-size:80%;">7,</span><span id="lstnumberx7.6" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx7.7" class="ltx_text ltx_font_typewriter" style="font-size:80%;">7]),</span>
</div>
<div id="lstnumberx8" class="ltx_listingline">
<span id="lstnumberx8.1" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;">     </span><span id="lstnumberx8.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">Conv2d</span><span id="lstnumberx8.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">(32,</span><span id="lstnumberx8.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx8.5" class="ltx_text ltx_font_typewriter" style="font-size:80%;">64,</span><span id="lstnumberx8.6" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx8.7" class="ltx_text ltx_font_typewriter" style="font-size:80%;">7,</span><span id="lstnumberx8.8" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx8.9" class="ltx_text ltx_lst_emph ltx_font_typewriter" style="font-size:80%;color:#ED9121;">stride</span><span id="lstnumberx8.10" class="ltx_text ltx_font_typewriter" style="font-size:80%;">=1,</span><span id="lstnumberx8.11" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx8.12" class="ltx_text ltx_lst_emph ltx_font_typewriter" style="font-size:80%;color:#ED9121;">padding</span><span id="lstnumberx8.13" class="ltx_text ltx_font_typewriter" style="font-size:80%;">=0),</span>
</div>
<div id="lstnumberx9" class="ltx_listingline">
<span id="lstnumberx9.1" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;">     </span><span id="lstnumberx9.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">LayerNorm</span><span id="lstnumberx9.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">([64,</span><span id="lstnumberx9.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx9.5" class="ltx_text ltx_font_typewriter" style="font-size:80%;">1,</span><span id="lstnumberx9.6" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx9.7" class="ltx_text ltx_font_typewriter" style="font-size:80%;">1])</span>
</div>
<div id="lstnumberx10" class="ltx_listingline">
<span id="lstnumberx10.1" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;">  </span><span id="lstnumberx10.2" class="ltx_text ltx_font_typewriter" style="font-size:80%;">)</span>
</div>
</div>
</div>
<div id="A2.SS1.p3" class="ltx_para ltx_minipage ltx_align_top" style="width:195.1pt;">
<div id="A2.SS1.p3.1" class="ltx_listing ltx_lst_language_Python ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain;base64,IyB0aGUgZ2xvYmFsIGhlYWQgdXNlZCB0byBwcmVkaWN0CiMgcHJlZmVyZW5jZXMgZm9yIGFsbCB1c2VycyBhbmQKIyBzdWItcG9wdWxhdGlvbnMKZ2xvYmFsX3ByZWRpY3Rpb25faGVhZCA9IExpbmVhcig5MiwgMikKCiMgdGhlIHByZWRpY3Rpb24gaGVhZHMgZm9yIGVhY2gKIyBzdWItcG9wdWxhdGlvbgptb2RlbF9oZWFkXzAgPSBMaW5lYXIoOTIsIDIpCi4uLgptb2RlbF9oZWFkXzkgPSBMaW5lYXIoOTIsIDIpCgojIHRoZSBrLXdheSBjbGFzc2lmaWVyIHRoYXQgcHJlZGljdHMKIyBncm91cCBJRApjbGFzc2lmaWVyX2hlYWQgPSBMaW5lYXIoOTIsIDEwKQ==" download="">⬇</a></div>
<div id="lstnumberx11" class="ltx_listingline">
<span id="lstnumberx11.1" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="font-size:80%;color:#009900;">#<span id="lstnumberx11.1.1" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx11.1.2" class="ltx_text ltx_lst_space"> </span>global<span id="lstnumberx11.1.3" class="ltx_text ltx_lst_space"> </span>head<span id="lstnumberx11.1.4" class="ltx_text ltx_lst_space"> </span>used<span id="lstnumberx11.1.5" class="ltx_text ltx_lst_space"> </span>to<span id="lstnumberx11.1.6" class="ltx_text ltx_lst_space"> </span>predict</span>
</div>
<div id="lstnumberx12" class="ltx_listingline">
<span id="lstnumberx12.1" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="font-size:80%;color:#009900;">#<span id="lstnumberx12.1.1" class="ltx_text ltx_lst_space"> </span>preferences<span id="lstnumberx12.1.2" class="ltx_text ltx_lst_space"> </span>for<span id="lstnumberx12.1.3" class="ltx_text ltx_lst_space"> </span>all<span id="lstnumberx12.1.4" class="ltx_text ltx_lst_space"> </span>users<span id="lstnumberx12.1.5" class="ltx_text ltx_lst_space"> </span>and</span>
</div>
<div id="lstnumberx13" class="ltx_listingline">
<span id="lstnumberx13.1" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="font-size:80%;color:#009900;">#<span id="lstnumberx13.1.1" class="ltx_text ltx_lst_space"> </span>sub-populations</span>
</div>
<div id="lstnumberx14" class="ltx_listingline">
<span id="lstnumberx14.1" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">global_prediction_head</span><span id="lstnumberx14.2" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx14.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">=</span><span id="lstnumberx14.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx14.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">Linear</span><span id="lstnumberx14.6" class="ltx_text ltx_font_typewriter" style="font-size:80%;">(92,</span><span id="lstnumberx14.7" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx14.8" class="ltx_text ltx_font_typewriter" style="font-size:80%;">2)</span>
</div>
<div id="lstnumberx15" class="ltx_listingline">
</div>
<div id="lstnumberx16" class="ltx_listingline">
<span id="lstnumberx16.1" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="font-size:80%;color:#009900;">#<span id="lstnumberx16.1.1" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx16.1.2" class="ltx_text ltx_lst_space"> </span>prediction<span id="lstnumberx16.1.3" class="ltx_text ltx_lst_space"> </span>heads<span id="lstnumberx16.1.4" class="ltx_text ltx_lst_space"> </span>for<span id="lstnumberx16.1.5" class="ltx_text ltx_lst_space"> </span>each</span>
</div>
<div id="lstnumberx17" class="ltx_listingline">
<span id="lstnumberx17.1" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="font-size:80%;color:#009900;">#<span id="lstnumberx17.1.1" class="ltx_text ltx_lst_space"> </span>sub-population</span>
</div>
<div id="lstnumberx18" class="ltx_listingline">
<span id="lstnumberx18.1" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">model_head_0</span><span id="lstnumberx18.2" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx18.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">=</span><span id="lstnumberx18.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx18.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">Linear</span><span id="lstnumberx18.6" class="ltx_text ltx_font_typewriter" style="font-size:80%;">(92,</span><span id="lstnumberx18.7" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx18.8" class="ltx_text ltx_font_typewriter" style="font-size:80%;">2)</span>
</div>
<div id="lstnumberx19" class="ltx_listingline">
<span id="lstnumberx19.1" class="ltx_text ltx_font_typewriter" style="font-size:80%;">...</span>
</div>
<div id="lstnumberx20" class="ltx_listingline">
<span id="lstnumberx20.1" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">model_head_9</span><span id="lstnumberx20.2" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx20.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">=</span><span id="lstnumberx20.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx20.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">Linear</span><span id="lstnumberx20.6" class="ltx_text ltx_font_typewriter" style="font-size:80%;">(92,</span><span id="lstnumberx20.7" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx20.8" class="ltx_text ltx_font_typewriter" style="font-size:80%;">2)</span>
</div>
<div id="lstnumberx21" class="ltx_listingline">
</div>
<div id="lstnumberx22" class="ltx_listingline">
<span id="lstnumberx22.1" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="font-size:80%;color:#009900;">#<span id="lstnumberx22.1.1" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx22.1.2" class="ltx_text ltx_lst_space"> </span>k-way<span id="lstnumberx22.1.3" class="ltx_text ltx_lst_space"> </span>classifier<span id="lstnumberx22.1.4" class="ltx_text ltx_lst_space"> </span>that<span id="lstnumberx22.1.5" class="ltx_text ltx_lst_space"> </span>predicts</span>
</div>
<div id="lstnumberx23" class="ltx_listingline">
<span id="lstnumberx23.1" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="font-size:80%;color:#009900;">#<span id="lstnumberx23.1.1" class="ltx_text ltx_lst_space"> </span>group<span id="lstnumberx23.1.2" class="ltx_text ltx_lst_space"> </span>ID</span>
</div>
<div id="lstnumberx24" class="ltx_listingline">
<span id="lstnumberx24.1" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">classifier_head</span><span id="lstnumberx24.2" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx24.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">=</span><span id="lstnumberx24.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx24.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">Linear</span><span id="lstnumberx24.6" class="ltx_text ltx_font_typewriter" style="font-size:80%;">(92,</span><span id="lstnumberx24.7" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx24.8" class="ltx_text ltx_font_typewriter" style="font-size:80%;">10)</span>
</div>
</div>
</div>
<div id="A2.SS1.p4" class="ltx_para">
<p id="A2.SS1.p4.5" class="ltx_p">The local optimizer is Adam with PyTorch’s default parameters, and the central optimizer is Adam with <math id="A2.SS1.p4.1.m1.1" class="ltx_Math" alttext="lr=1" display="inline"><semantics id="A2.SS1.p4.1.m1.1a"><mrow id="A2.SS1.p4.1.m1.1.1" xref="A2.SS1.p4.1.m1.1.1.cmml"><mrow id="A2.SS1.p4.1.m1.1.1.2" xref="A2.SS1.p4.1.m1.1.1.2.cmml"><mi id="A2.SS1.p4.1.m1.1.1.2.2" xref="A2.SS1.p4.1.m1.1.1.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="A2.SS1.p4.1.m1.1.1.2.1" xref="A2.SS1.p4.1.m1.1.1.2.1.cmml">​</mo><mi id="A2.SS1.p4.1.m1.1.1.2.3" xref="A2.SS1.p4.1.m1.1.1.2.3.cmml">r</mi></mrow><mo id="A2.SS1.p4.1.m1.1.1.1" xref="A2.SS1.p4.1.m1.1.1.1.cmml">=</mo><mn id="A2.SS1.p4.1.m1.1.1.3" xref="A2.SS1.p4.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.1.m1.1b"><apply id="A2.SS1.p4.1.m1.1.1.cmml" xref="A2.SS1.p4.1.m1.1.1"><eq id="A2.SS1.p4.1.m1.1.1.1.cmml" xref="A2.SS1.p4.1.m1.1.1.1"></eq><apply id="A2.SS1.p4.1.m1.1.1.2.cmml" xref="A2.SS1.p4.1.m1.1.1.2"><times id="A2.SS1.p4.1.m1.1.1.2.1.cmml" xref="A2.SS1.p4.1.m1.1.1.2.1"></times><ci id="A2.SS1.p4.1.m1.1.1.2.2.cmml" xref="A2.SS1.p4.1.m1.1.1.2.2">𝑙</ci><ci id="A2.SS1.p4.1.m1.1.1.2.3.cmml" xref="A2.SS1.p4.1.m1.1.1.2.3">𝑟</ci></apply><cn type="integer" id="A2.SS1.p4.1.m1.1.1.3.cmml" xref="A2.SS1.p4.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.1.m1.1c">lr=1</annotation></semantics></math>. The value of <math id="A2.SS1.p4.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A2.SS1.p4.2.m2.1a"><mi id="A2.SS1.p4.2.m2.1.1" xref="A2.SS1.p4.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.2.m2.1b"><ci id="A2.SS1.p4.2.m2.1.1.cmml" xref="A2.SS1.p4.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.2.m2.1c">\alpha</annotation></semantics></math> for the triplet margin loss (Equation <a href="#S3.E1" title="In 3.3.2 Prototype Assignment ‣ 3.3 Sub-Population Assignment ‣ 3 FedEmbed ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) is <math id="A2.SS1.p4.3.m3.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="A2.SS1.p4.3.m3.1a"><mn id="A2.SS1.p4.3.m3.1.1" xref="A2.SS1.p4.3.m3.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.3.m3.1b"><cn type="float" id="A2.SS1.p4.3.m3.1.1.cmml" xref="A2.SS1.p4.3.m3.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.3.m3.1c">1.0</annotation></semantics></math>. The size of the personal embedding, <math id="A2.SS1.p4.4.m4.1" class="ltx_Math" alttext="\vec{\epsilon}_{u}" display="inline"><semantics id="A2.SS1.p4.4.m4.1a"><msub id="A2.SS1.p4.4.m4.1.1" xref="A2.SS1.p4.4.m4.1.1.cmml"><mover accent="true" id="A2.SS1.p4.4.m4.1.1.2" xref="A2.SS1.p4.4.m4.1.1.2.cmml"><mi id="A2.SS1.p4.4.m4.1.1.2.2" xref="A2.SS1.p4.4.m4.1.1.2.2.cmml">ϵ</mi><mo stretchy="false" id="A2.SS1.p4.4.m4.1.1.2.1" xref="A2.SS1.p4.4.m4.1.1.2.1.cmml">→</mo></mover><mi id="A2.SS1.p4.4.m4.1.1.3" xref="A2.SS1.p4.4.m4.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.4.m4.1b"><apply id="A2.SS1.p4.4.m4.1.1.cmml" xref="A2.SS1.p4.4.m4.1.1"><csymbol cd="ambiguous" id="A2.SS1.p4.4.m4.1.1.1.cmml" xref="A2.SS1.p4.4.m4.1.1">subscript</csymbol><apply id="A2.SS1.p4.4.m4.1.1.2.cmml" xref="A2.SS1.p4.4.m4.1.1.2"><ci id="A2.SS1.p4.4.m4.1.1.2.1.cmml" xref="A2.SS1.p4.4.m4.1.1.2.1">→</ci><ci id="A2.SS1.p4.4.m4.1.1.2.2.cmml" xref="A2.SS1.p4.4.m4.1.1.2.2">italic-ϵ</ci></apply><ci id="A2.SS1.p4.4.m4.1.1.3.cmml" xref="A2.SS1.p4.4.m4.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.4.m4.1c">\vec{\epsilon}_{u}</annotation></semantics></math>, is <math id="A2.SS1.p4.5.m5.1" class="ltx_Math" alttext="28\times 1" display="inline"><semantics id="A2.SS1.p4.5.m5.1a"><mrow id="A2.SS1.p4.5.m5.1.1" xref="A2.SS1.p4.5.m5.1.1.cmml"><mn id="A2.SS1.p4.5.m5.1.1.2" xref="A2.SS1.p4.5.m5.1.1.2.cmml">28</mn><mo lspace="0.222em" rspace="0.222em" id="A2.SS1.p4.5.m5.1.1.1" xref="A2.SS1.p4.5.m5.1.1.1.cmml">×</mo><mn id="A2.SS1.p4.5.m5.1.1.3" xref="A2.SS1.p4.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.5.m5.1b"><apply id="A2.SS1.p4.5.m5.1.1.cmml" xref="A2.SS1.p4.5.m5.1.1"><times id="A2.SS1.p4.5.m5.1.1.1.cmml" xref="A2.SS1.p4.5.m5.1.1.1"></times><cn type="integer" id="A2.SS1.p4.5.m5.1.1.2.cmml" xref="A2.SS1.p4.5.m5.1.1.2">28</cn><cn type="integer" id="A2.SS1.p4.5.m5.1.1.3.cmml" xref="A2.SS1.p4.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.5.m5.1c">28\times 1</annotation></semantics></math>.</p>
</div>
</section>
<section id="A2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Speech Models</h3>

<div id="A2.SS2.p1" class="ltx_para">
<p id="A2.SS2.p1.2" class="ltx_p">The architectures for the speech experiments are as follows (following the PyTorch API), where an input spectrogram <math id="A2.SS2.p1.1.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="A2.SS2.p1.1.m1.1a"><mi id="A2.SS2.p1.1.m1.1.1" xref="A2.SS2.p1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.1.m1.1b"><ci id="A2.SS2.p1.1.m1.1.1.cmml" xref="A2.SS2.p1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.1.m1.1c">x</annotation></semantics></math> has dimensions <math id="A2.SS2.p1.2.m2.1" class="ltx_Math" alttext="x\in\mathbb{R}^{(200\times 375\times 2)}" display="inline"><semantics id="A2.SS2.p1.2.m2.1a"><mrow id="A2.SS2.p1.2.m2.1.2" xref="A2.SS2.p1.2.m2.1.2.cmml"><mi id="A2.SS2.p1.2.m2.1.2.2" xref="A2.SS2.p1.2.m2.1.2.2.cmml">x</mi><mo id="A2.SS2.p1.2.m2.1.2.1" xref="A2.SS2.p1.2.m2.1.2.1.cmml">∈</mo><msup id="A2.SS2.p1.2.m2.1.2.3" xref="A2.SS2.p1.2.m2.1.2.3.cmml"><mi id="A2.SS2.p1.2.m2.1.2.3.2" xref="A2.SS2.p1.2.m2.1.2.3.2.cmml">ℝ</mi><mrow id="A2.SS2.p1.2.m2.1.1.1.1" xref="A2.SS2.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.SS2.p1.2.m2.1.1.1.1.2" xref="A2.SS2.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="A2.SS2.p1.2.m2.1.1.1.1.1" xref="A2.SS2.p1.2.m2.1.1.1.1.1.cmml"><mn id="A2.SS2.p1.2.m2.1.1.1.1.1.2" xref="A2.SS2.p1.2.m2.1.1.1.1.1.2.cmml">200</mn><mo lspace="0.222em" rspace="0.222em" id="A2.SS2.p1.2.m2.1.1.1.1.1.1" xref="A2.SS2.p1.2.m2.1.1.1.1.1.1.cmml">×</mo><mn id="A2.SS2.p1.2.m2.1.1.1.1.1.3" xref="A2.SS2.p1.2.m2.1.1.1.1.1.3.cmml">375</mn><mo lspace="0.222em" rspace="0.222em" id="A2.SS2.p1.2.m2.1.1.1.1.1.1a" xref="A2.SS2.p1.2.m2.1.1.1.1.1.1.cmml">×</mo><mn id="A2.SS2.p1.2.m2.1.1.1.1.1.4" xref="A2.SS2.p1.2.m2.1.1.1.1.1.4.cmml">2</mn></mrow><mo stretchy="false" id="A2.SS2.p1.2.m2.1.1.1.1.3" xref="A2.SS2.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.2.m2.1b"><apply id="A2.SS2.p1.2.m2.1.2.cmml" xref="A2.SS2.p1.2.m2.1.2"><in id="A2.SS2.p1.2.m2.1.2.1.cmml" xref="A2.SS2.p1.2.m2.1.2.1"></in><ci id="A2.SS2.p1.2.m2.1.2.2.cmml" xref="A2.SS2.p1.2.m2.1.2.2">𝑥</ci><apply id="A2.SS2.p1.2.m2.1.2.3.cmml" xref="A2.SS2.p1.2.m2.1.2.3"><csymbol cd="ambiguous" id="A2.SS2.p1.2.m2.1.2.3.1.cmml" xref="A2.SS2.p1.2.m2.1.2.3">superscript</csymbol><ci id="A2.SS2.p1.2.m2.1.2.3.2.cmml" xref="A2.SS2.p1.2.m2.1.2.3.2">ℝ</ci><apply id="A2.SS2.p1.2.m2.1.1.1.1.1.cmml" xref="A2.SS2.p1.2.m2.1.1.1.1"><times id="A2.SS2.p1.2.m2.1.1.1.1.1.1.cmml" xref="A2.SS2.p1.2.m2.1.1.1.1.1.1"></times><cn type="integer" id="A2.SS2.p1.2.m2.1.1.1.1.1.2.cmml" xref="A2.SS2.p1.2.m2.1.1.1.1.1.2">200</cn><cn type="integer" id="A2.SS2.p1.2.m2.1.1.1.1.1.3.cmml" xref="A2.SS2.p1.2.m2.1.1.1.1.1.3">375</cn><cn type="integer" id="A2.SS2.p1.2.m2.1.1.1.1.1.4.cmml" xref="A2.SS2.p1.2.m2.1.1.1.1.1.4">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.2.m2.1c">x\in\mathbb{R}^{(200\times 375\times 2)}</annotation></semantics></math>:</p>
</div>
<div id="A2.SS2.p2" class="ltx_para ltx_minipage ltx_align_top" style="width:238.5pt;">
<div id="A2.SS2.p2.1" class="ltx_listing ltx_lst_language_Python ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain;base64,IyBmZWF0dXJlIGVuY29kZXIgc2hhcmVkIGJ5IGFsbAojIHN1Yi1wb3B1bGF0aW9uIHByZWRpY3Rpb24gaGVhZHMKZ2xvYmFsX2VuY29kZXIgPSBTZXF1ZW50aWFsKAogICAgIENvbnYyZCgyLCAxNiwga2VybmVsPSgzLCA1KSwgc3RyaWRlPSgyLCAzKSksCiAgICAgQXZnUG9vbDJkKCgyLCAzKSksCiAgICAgTGF5ZXJOb3JtKFsxNiwgNTAsIDQxXSksCiAgICAgQ29udjJkKDE2LCAzMiwga2VybmVsPSg1LCA1KSwgc3RyaWRlPSgyLCAyKSksCiAgICAgQXZnUG9vbDJkKDMsIDMpKSwKICAgICBMYXllck5vcm0oWzMyLCA3LCA2XSksCiAgICAgQ29udjJkKDMyLCA2NCwga2VybmVsPSgzLCAyKSwgc3RyaWRlPSgyLCAyKSksCiAgICAgTGF5ZXJOb3JtKFs2NCwgMywgM10pLAogICAgIEZsYXR0ZW4oMSksCiAgICAgTGluZWFyKDU3NiwgMjU2KSwKICAgICBMYXllck5vcm0oWzI1Nl0pCiAgKQ==" download="">⬇</a></div>
<div id="lstnumberx25" class="ltx_listingline">
<span id="lstnumberx25.1" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="font-size:80%;color:#009900;">#<span id="lstnumberx25.1.1" class="ltx_text ltx_lst_space"> </span>feature<span id="lstnumberx25.1.2" class="ltx_text ltx_lst_space"> </span>encoder<span id="lstnumberx25.1.3" class="ltx_text ltx_lst_space"> </span>shared<span id="lstnumberx25.1.4" class="ltx_text ltx_lst_space"> </span>by<span id="lstnumberx25.1.5" class="ltx_text ltx_lst_space"> </span>all</span>
</div>
<div id="lstnumberx26" class="ltx_listingline">
<span id="lstnumberx26.1" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="font-size:80%;color:#009900;">#<span id="lstnumberx26.1.1" class="ltx_text ltx_lst_space"> </span>sub-population<span id="lstnumberx26.1.2" class="ltx_text ltx_lst_space"> </span>prediction<span id="lstnumberx26.1.3" class="ltx_text ltx_lst_space"> </span>heads</span>
</div>
<div id="lstnumberx27" class="ltx_listingline">
<span id="lstnumberx27.1" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">global_encoder</span><span id="lstnumberx27.2" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx27.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">=</span><span id="lstnumberx27.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx27.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">Sequential</span><span id="lstnumberx27.6" class="ltx_text ltx_font_typewriter" style="font-size:80%;">(</span>
</div>
<div id="lstnumberx28" class="ltx_listingline">
<span id="lstnumberx28.1" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;">     </span><span id="lstnumberx28.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">Conv2d</span><span id="lstnumberx28.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">(2,</span><span id="lstnumberx28.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx28.5" class="ltx_text ltx_font_typewriter" style="font-size:80%;">16,</span><span id="lstnumberx28.6" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx28.7" class="ltx_text ltx_lst_emph ltx_font_typewriter" style="font-size:80%;color:#ED9121;">kernel</span><span id="lstnumberx28.8" class="ltx_text ltx_font_typewriter" style="font-size:80%;">=(3,</span><span id="lstnumberx28.9" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx28.10" class="ltx_text ltx_font_typewriter" style="font-size:80%;">5),</span><span id="lstnumberx28.11" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx28.12" class="ltx_text ltx_lst_emph ltx_font_typewriter" style="font-size:80%;color:#ED9121;">stride</span><span id="lstnumberx28.13" class="ltx_text ltx_font_typewriter" style="font-size:80%;">=(2,</span><span id="lstnumberx28.14" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx28.15" class="ltx_text ltx_font_typewriter" style="font-size:80%;">3)),</span>
</div>
<div id="lstnumberx29" class="ltx_listingline">
<span id="lstnumberx29.1" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;">     </span><span id="lstnumberx29.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">AvgPool2d</span><span id="lstnumberx29.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">((2,</span><span id="lstnumberx29.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx29.5" class="ltx_text ltx_font_typewriter" style="font-size:80%;">3)),</span>
</div>
<div id="lstnumberx30" class="ltx_listingline">
<span id="lstnumberx30.1" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;">     </span><span id="lstnumberx30.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">LayerNorm</span><span id="lstnumberx30.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">([16,</span><span id="lstnumberx30.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx30.5" class="ltx_text ltx_font_typewriter" style="font-size:80%;">50,</span><span id="lstnumberx30.6" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx30.7" class="ltx_text ltx_font_typewriter" style="font-size:80%;">41]),</span>
</div>
<div id="lstnumberx31" class="ltx_listingline">
<span id="lstnumberx31.1" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;">     </span><span id="lstnumberx31.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">Conv2d</span><span id="lstnumberx31.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">(16,</span><span id="lstnumberx31.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx31.5" class="ltx_text ltx_font_typewriter" style="font-size:80%;">32,</span><span id="lstnumberx31.6" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx31.7" class="ltx_text ltx_lst_emph ltx_font_typewriter" style="font-size:80%;color:#ED9121;">kernel</span><span id="lstnumberx31.8" class="ltx_text ltx_font_typewriter" style="font-size:80%;">=(5,</span><span id="lstnumberx31.9" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx31.10" class="ltx_text ltx_font_typewriter" style="font-size:80%;">5),</span><span id="lstnumberx31.11" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx31.12" class="ltx_text ltx_lst_emph ltx_font_typewriter" style="font-size:80%;color:#ED9121;">stride</span><span id="lstnumberx31.13" class="ltx_text ltx_font_typewriter" style="font-size:80%;">=(2,</span><span id="lstnumberx31.14" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx31.15" class="ltx_text ltx_font_typewriter" style="font-size:80%;">2)),</span>
</div>
<div id="lstnumberx32" class="ltx_listingline">
<span id="lstnumberx32.1" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;">     </span><span id="lstnumberx32.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">AvgPool2d</span><span id="lstnumberx32.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">(3,</span><span id="lstnumberx32.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx32.5" class="ltx_text ltx_font_typewriter" style="font-size:80%;">3)),</span>
</div>
<div id="lstnumberx33" class="ltx_listingline">
<span id="lstnumberx33.1" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;">     </span><span id="lstnumberx33.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">LayerNorm</span><span id="lstnumberx33.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">([32,</span><span id="lstnumberx33.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx33.5" class="ltx_text ltx_font_typewriter" style="font-size:80%;">7,</span><span id="lstnumberx33.6" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx33.7" class="ltx_text ltx_font_typewriter" style="font-size:80%;">6]),</span>
</div>
<div id="lstnumberx34" class="ltx_listingline">
<span id="lstnumberx34.1" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;">     </span><span id="lstnumberx34.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">Conv2d</span><span id="lstnumberx34.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">(32,</span><span id="lstnumberx34.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx34.5" class="ltx_text ltx_font_typewriter" style="font-size:80%;">64,</span><span id="lstnumberx34.6" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx34.7" class="ltx_text ltx_lst_emph ltx_font_typewriter" style="font-size:80%;color:#ED9121;">kernel</span><span id="lstnumberx34.8" class="ltx_text ltx_font_typewriter" style="font-size:80%;">=(3,</span><span id="lstnumberx34.9" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx34.10" class="ltx_text ltx_font_typewriter" style="font-size:80%;">2),</span><span id="lstnumberx34.11" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx34.12" class="ltx_text ltx_lst_emph ltx_font_typewriter" style="font-size:80%;color:#ED9121;">stride</span><span id="lstnumberx34.13" class="ltx_text ltx_font_typewriter" style="font-size:80%;">=(2,</span><span id="lstnumberx34.14" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx34.15" class="ltx_text ltx_font_typewriter" style="font-size:80%;">2)),</span>
</div>
<div id="lstnumberx35" class="ltx_listingline">
<span id="lstnumberx35.1" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;">     </span><span id="lstnumberx35.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">LayerNorm</span><span id="lstnumberx35.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">([64,</span><span id="lstnumberx35.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx35.5" class="ltx_text ltx_font_typewriter" style="font-size:80%;">3,</span><span id="lstnumberx35.6" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx35.7" class="ltx_text ltx_font_typewriter" style="font-size:80%;">3]),</span>
</div>
<div id="lstnumberx36" class="ltx_listingline">
<span id="lstnumberx36.1" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;">     </span><span id="lstnumberx36.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">Flatten</span><span id="lstnumberx36.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">(1),</span>
</div>
<div id="lstnumberx37" class="ltx_listingline">
<span id="lstnumberx37.1" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;">     </span><span id="lstnumberx37.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">Linear</span><span id="lstnumberx37.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">(576,</span><span id="lstnumberx37.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx37.5" class="ltx_text ltx_font_typewriter" style="font-size:80%;">256),</span>
</div>
<div id="lstnumberx38" class="ltx_listingline">
<span id="lstnumberx38.1" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;">     </span><span id="lstnumberx38.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">LayerNorm</span><span id="lstnumberx38.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">([256])</span>
</div>
<div id="lstnumberx39" class="ltx_listingline">
<span id="lstnumberx39.1" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;">  </span><span id="lstnumberx39.2" class="ltx_text ltx_font_typewriter" style="font-size:80%;">)</span>
</div>
</div>
</div>
<div id="A2.SS2.p3" class="ltx_para ltx_minipage ltx_align_top" style="width:195.1pt;">
<div id="A2.SS2.p3.1" class="ltx_listing ltx_lst_language_Python ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain;base64,IyB0aGUgZ2xvYmFsIGhlYWQgdXNlZCB0byBwcmVkaWN0CiMgcHJlZmVyZW5jZXMgZm9yIGFsbCB1c2VycyBhbmQKIyBzdWItcG9wdWxhdGlvbnMKZ2xvYmFsX3ByZWRpY3Rpb25faGVhZCA9IExpbmVhcig5MiwgMikKCiMgdGhlIHByZWRpY3Rpb24gaGVhZHMgZm9yIGVhY2gKIyBzdWItcG9wdWxhdGlvbgptb2RlbF9oZWFkXzAgPSBMaW5lYXIoOTIsIDIpCi4uLgptb2RlbF9oZWFkXzIwID0gTGluZWFyKDkyLCAyKQoKIyB0aGUgay13YXkgY2xhc3NpZmllciB0aGF0IHByZWRpY3RzCiMgZ3JvdXAgSUQKY2xhc3NpZmllcl9oZWFkID0gTGluZWFyKDkyLCAyMCk=" download="">⬇</a></div>
<div id="lstnumberx40" class="ltx_listingline">
<span id="lstnumberx40.1" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="font-size:80%;color:#009900;">#<span id="lstnumberx40.1.1" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx40.1.2" class="ltx_text ltx_lst_space"> </span>global<span id="lstnumberx40.1.3" class="ltx_text ltx_lst_space"> </span>head<span id="lstnumberx40.1.4" class="ltx_text ltx_lst_space"> </span>used<span id="lstnumberx40.1.5" class="ltx_text ltx_lst_space"> </span>to<span id="lstnumberx40.1.6" class="ltx_text ltx_lst_space"> </span>predict</span>
</div>
<div id="lstnumberx41" class="ltx_listingline">
<span id="lstnumberx41.1" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="font-size:80%;color:#009900;">#<span id="lstnumberx41.1.1" class="ltx_text ltx_lst_space"> </span>preferences<span id="lstnumberx41.1.2" class="ltx_text ltx_lst_space"> </span>for<span id="lstnumberx41.1.3" class="ltx_text ltx_lst_space"> </span>all<span id="lstnumberx41.1.4" class="ltx_text ltx_lst_space"> </span>users<span id="lstnumberx41.1.5" class="ltx_text ltx_lst_space"> </span>and</span>
</div>
<div id="lstnumberx42" class="ltx_listingline">
<span id="lstnumberx42.1" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="font-size:80%;color:#009900;">#<span id="lstnumberx42.1.1" class="ltx_text ltx_lst_space"> </span>sub-populations</span>
</div>
<div id="lstnumberx43" class="ltx_listingline">
<span id="lstnumberx43.1" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">global_prediction_head</span><span id="lstnumberx43.2" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx43.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">=</span><span id="lstnumberx43.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx43.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">Linear</span><span id="lstnumberx43.6" class="ltx_text ltx_font_typewriter" style="font-size:80%;">(92,</span><span id="lstnumberx43.7" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx43.8" class="ltx_text ltx_font_typewriter" style="font-size:80%;">2)</span>
</div>
<div id="lstnumberx44" class="ltx_listingline">
</div>
<div id="lstnumberx45" class="ltx_listingline">
<span id="lstnumberx45.1" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="font-size:80%;color:#009900;">#<span id="lstnumberx45.1.1" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx45.1.2" class="ltx_text ltx_lst_space"> </span>prediction<span id="lstnumberx45.1.3" class="ltx_text ltx_lst_space"> </span>heads<span id="lstnumberx45.1.4" class="ltx_text ltx_lst_space"> </span>for<span id="lstnumberx45.1.5" class="ltx_text ltx_lst_space"> </span>each</span>
</div>
<div id="lstnumberx46" class="ltx_listingline">
<span id="lstnumberx46.1" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="font-size:80%;color:#009900;">#<span id="lstnumberx46.1.1" class="ltx_text ltx_lst_space"> </span>sub-population</span>
</div>
<div id="lstnumberx47" class="ltx_listingline">
<span id="lstnumberx47.1" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">model_head_0</span><span id="lstnumberx47.2" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx47.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">=</span><span id="lstnumberx47.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx47.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">Linear</span><span id="lstnumberx47.6" class="ltx_text ltx_font_typewriter" style="font-size:80%;">(92,</span><span id="lstnumberx47.7" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx47.8" class="ltx_text ltx_font_typewriter" style="font-size:80%;">2)</span>
</div>
<div id="lstnumberx48" class="ltx_listingline">
<span id="lstnumberx48.1" class="ltx_text ltx_font_typewriter" style="font-size:80%;">...</span>
</div>
<div id="lstnumberx49" class="ltx_listingline">
<span id="lstnumberx49.1" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">model_head_20</span><span id="lstnumberx49.2" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx49.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">=</span><span id="lstnumberx49.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx49.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">Linear</span><span id="lstnumberx49.6" class="ltx_text ltx_font_typewriter" style="font-size:80%;">(92,</span><span id="lstnumberx49.7" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx49.8" class="ltx_text ltx_font_typewriter" style="font-size:80%;">2)</span>
</div>
<div id="lstnumberx50" class="ltx_listingline">
</div>
<div id="lstnumberx51" class="ltx_listingline">
<span id="lstnumberx51.1" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="font-size:80%;color:#009900;">#<span id="lstnumberx51.1.1" class="ltx_text ltx_lst_space"> </span>the<span id="lstnumberx51.1.2" class="ltx_text ltx_lst_space"> </span>k-way<span id="lstnumberx51.1.3" class="ltx_text ltx_lst_space"> </span>classifier<span id="lstnumberx51.1.4" class="ltx_text ltx_lst_space"> </span>that<span id="lstnumberx51.1.5" class="ltx_text ltx_lst_space"> </span>predicts</span>
</div>
<div id="lstnumberx52" class="ltx_listingline">
<span id="lstnumberx52.1" class="ltx_text ltx_lst_comment ltx_font_typewriter" style="font-size:80%;color:#009900;">#<span id="lstnumberx52.1.1" class="ltx_text ltx_lst_space"> </span>group<span id="lstnumberx52.1.2" class="ltx_text ltx_lst_space"> </span>ID</span>
</div>
<div id="lstnumberx53" class="ltx_listingline">
<span id="lstnumberx53.1" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">classifier_head</span><span id="lstnumberx53.2" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx53.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">=</span><span id="lstnumberx53.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx53.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">Linear</span><span id="lstnumberx53.6" class="ltx_text ltx_font_typewriter" style="font-size:80%;">(92,</span><span id="lstnumberx53.7" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx53.8" class="ltx_text ltx_font_typewriter" style="font-size:80%;">20)</span>
</div>
</div>
</div>
<div id="A2.SS2.p4" class="ltx_para">
<p id="A2.SS2.p4.5" class="ltx_p">The local optimizer is Adam with PyTorch’s default parameters, and the central optimizer is Adam with <math id="A2.SS2.p4.1.m1.1" class="ltx_Math" alttext="lr=1" display="inline"><semantics id="A2.SS2.p4.1.m1.1a"><mrow id="A2.SS2.p4.1.m1.1.1" xref="A2.SS2.p4.1.m1.1.1.cmml"><mrow id="A2.SS2.p4.1.m1.1.1.2" xref="A2.SS2.p4.1.m1.1.1.2.cmml"><mi id="A2.SS2.p4.1.m1.1.1.2.2" xref="A2.SS2.p4.1.m1.1.1.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="A2.SS2.p4.1.m1.1.1.2.1" xref="A2.SS2.p4.1.m1.1.1.2.1.cmml">​</mo><mi id="A2.SS2.p4.1.m1.1.1.2.3" xref="A2.SS2.p4.1.m1.1.1.2.3.cmml">r</mi></mrow><mo id="A2.SS2.p4.1.m1.1.1.1" xref="A2.SS2.p4.1.m1.1.1.1.cmml">=</mo><mn id="A2.SS2.p4.1.m1.1.1.3" xref="A2.SS2.p4.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p4.1.m1.1b"><apply id="A2.SS2.p4.1.m1.1.1.cmml" xref="A2.SS2.p4.1.m1.1.1"><eq id="A2.SS2.p4.1.m1.1.1.1.cmml" xref="A2.SS2.p4.1.m1.1.1.1"></eq><apply id="A2.SS2.p4.1.m1.1.1.2.cmml" xref="A2.SS2.p4.1.m1.1.1.2"><times id="A2.SS2.p4.1.m1.1.1.2.1.cmml" xref="A2.SS2.p4.1.m1.1.1.2.1"></times><ci id="A2.SS2.p4.1.m1.1.1.2.2.cmml" xref="A2.SS2.p4.1.m1.1.1.2.2">𝑙</ci><ci id="A2.SS2.p4.1.m1.1.1.2.3.cmml" xref="A2.SS2.p4.1.m1.1.1.2.3">𝑟</ci></apply><cn type="integer" id="A2.SS2.p4.1.m1.1.1.3.cmml" xref="A2.SS2.p4.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p4.1.m1.1c">lr=1</annotation></semantics></math>. The value of <math id="A2.SS2.p4.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A2.SS2.p4.2.m2.1a"><mi id="A2.SS2.p4.2.m2.1.1" xref="A2.SS2.p4.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p4.2.m2.1b"><ci id="A2.SS2.p4.2.m2.1.1.cmml" xref="A2.SS2.p4.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p4.2.m2.1c">\alpha</annotation></semantics></math> for the triplet margin loss (Equation <a href="#S3.E1" title="In 3.3.2 Prototype Assignment ‣ 3.3 Sub-Population Assignment ‣ 3 FedEmbed ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) is <math id="A2.SS2.p4.3.m3.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="A2.SS2.p4.3.m3.1a"><mn id="A2.SS2.p4.3.m3.1.1" xref="A2.SS2.p4.3.m3.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="A2.SS2.p4.3.m3.1b"><cn type="float" id="A2.SS2.p4.3.m3.1.1.cmml" xref="A2.SS2.p4.3.m3.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p4.3.m3.1c">1.0</annotation></semantics></math>. The size of the personal embedding, <math id="A2.SS2.p4.4.m4.1" class="ltx_Math" alttext="\vec{\epsilon}_{u}" display="inline"><semantics id="A2.SS2.p4.4.m4.1a"><msub id="A2.SS2.p4.4.m4.1.1" xref="A2.SS2.p4.4.m4.1.1.cmml"><mover accent="true" id="A2.SS2.p4.4.m4.1.1.2" xref="A2.SS2.p4.4.m4.1.1.2.cmml"><mi id="A2.SS2.p4.4.m4.1.1.2.2" xref="A2.SS2.p4.4.m4.1.1.2.2.cmml">ϵ</mi><mo stretchy="false" id="A2.SS2.p4.4.m4.1.1.2.1" xref="A2.SS2.p4.4.m4.1.1.2.1.cmml">→</mo></mover><mi id="A2.SS2.p4.4.m4.1.1.3" xref="A2.SS2.p4.4.m4.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS2.p4.4.m4.1b"><apply id="A2.SS2.p4.4.m4.1.1.cmml" xref="A2.SS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="A2.SS2.p4.4.m4.1.1.1.cmml" xref="A2.SS2.p4.4.m4.1.1">subscript</csymbol><apply id="A2.SS2.p4.4.m4.1.1.2.cmml" xref="A2.SS2.p4.4.m4.1.1.2"><ci id="A2.SS2.p4.4.m4.1.1.2.1.cmml" xref="A2.SS2.p4.4.m4.1.1.2.1">→</ci><ci id="A2.SS2.p4.4.m4.1.1.2.2.cmml" xref="A2.SS2.p4.4.m4.1.1.2.2">italic-ϵ</ci></apply><ci id="A2.SS2.p4.4.m4.1.1.3.cmml" xref="A2.SS2.p4.4.m4.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p4.4.m4.1c">\vec{\epsilon}_{u}</annotation></semantics></math>, is <math id="A2.SS2.p4.5.m5.1" class="ltx_Math" alttext="200\times 1" display="inline"><semantics id="A2.SS2.p4.5.m5.1a"><mrow id="A2.SS2.p4.5.m5.1.1" xref="A2.SS2.p4.5.m5.1.1.cmml"><mn id="A2.SS2.p4.5.m5.1.1.2" xref="A2.SS2.p4.5.m5.1.1.2.cmml">200</mn><mo lspace="0.222em" rspace="0.222em" id="A2.SS2.p4.5.m5.1.1.1" xref="A2.SS2.p4.5.m5.1.1.1.cmml">×</mo><mn id="A2.SS2.p4.5.m5.1.1.3" xref="A2.SS2.p4.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p4.5.m5.1b"><apply id="A2.SS2.p4.5.m5.1.1.cmml" xref="A2.SS2.p4.5.m5.1.1"><times id="A2.SS2.p4.5.m5.1.1.1.cmml" xref="A2.SS2.p4.5.m5.1.1.1"></times><cn type="integer" id="A2.SS2.p4.5.m5.1.1.2.cmml" xref="A2.SS2.p4.5.m5.1.1.2">200</cn><cn type="integer" id="A2.SS2.p4.5.m5.1.1.3.cmml" xref="A2.SS2.p4.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p4.5.m5.1c">200\times 1</annotation></semantics></math>.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Effect of <math id="A3.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A3.1.m1.1b"><mi id="A3.1.m1.1.1" xref="A3.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A3.1.m1.1c"><ci id="A3.1.m1.1.1.cmml" xref="A3.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.1.m1.1d">k</annotation></semantics></math>-way classification on user embeddings structure</h2>

<div id="A3.p1" class="ltx_para">
<p id="A3.p1.3" class="ltx_p">Figure <a href="#A3.F4" title="Figure 4 ‣ Appendix C Effect of 𝑘-way classification on user embeddings structure ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> visualizes the impact of the <math id="A3.p1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A3.p1.1.m1.1a"><mi id="A3.p1.1.m1.1.1" xref="A3.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A3.p1.1.m1.1b"><ci id="A3.p1.1.m1.1.1.cmml" xref="A3.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.1.m1.1c">k</annotation></semantics></math>-way classification head on how the learned user embeddings cluster in a 2D space (projected via TSNE). Without the use of the <math id="A3.p1.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A3.p1.2.m2.1a"><mi id="A3.p1.2.m2.1.1" xref="A3.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A3.p1.2.m2.1b"><ci id="A3.p1.2.m2.1.1.cmml" xref="A3.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.2.m2.1c">k</annotation></semantics></math>-way classification head (Figure <a href="#A3.F4" title="Figure 4 ‣ Appendix C Effect of 𝑘-way classification on user embeddings structure ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>(a)), the user embeddings do not separate by sub-population. However, with the use of the <math id="A3.p1.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A3.p1.3.m3.1a"><mi id="A3.p1.3.m3.1.1" xref="A3.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A3.p1.3.m3.1b"><ci id="A3.p1.3.m3.1.1.cmml" xref="A3.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.3.m3.1c">k</annotation></semantics></math>-way classification head, we can see the user embeddings separating by sub-population <a href="#A3.F4" title="Figure 4 ‣ Appendix C Effect of 𝑘-way classification on user embeddings structure ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>(b)). These figures illustrate the information about the user types that the k-way classification head transfers into the user embeddings.</p>
</div>
<figure id="A3.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A3.F4.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2202.09472/assets/fig/embeddings_no_kway_classification_cropped.png" id="A3.F4.sf1.g1" class="ltx_graphics ltx_img_square" width="598" height="570" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A3.F4.sf1.4.2.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="A3.F4.sf1.2.1" class="ltx_text" style="font-size:90%;">User embeddings from a model without <math id="A3.F4.sf1.2.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A3.F4.sf1.2.1.m1.1b"><mi id="A3.F4.sf1.2.1.m1.1.1" xref="A3.F4.sf1.2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A3.F4.sf1.2.1.m1.1c"><ci id="A3.F4.sf1.2.1.m1.1.1.cmml" xref="A3.F4.sf1.2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.F4.sf1.2.1.m1.1d">k</annotation></semantics></math>-way classification</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A3.F4.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2202.09472/assets/fig/embeddings_with_kway_classification_cropped.png" id="A3.F4.sf2.g1" class="ltx_graphics ltx_img_square" width="598" height="571" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A3.F4.sf2.4.2.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="A3.F4.sf2.2.1" class="ltx_text" style="font-size:90%;">User embeddings from a model with <math id="A3.F4.sf2.2.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A3.F4.sf2.2.1.m1.1b"><mi id="A3.F4.sf2.2.1.m1.1.1" xref="A3.F4.sf2.2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A3.F4.sf2.2.1.m1.1c"><ci id="A3.F4.sf2.2.1.m1.1.1.cmml" xref="A3.F4.sf2.2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.F4.sf2.2.1.m1.1d">k</annotation></semantics></math>-way classification</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A3.F4.6.3.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="A3.F4.4.2" class="ltx_text" style="font-size:90%;">A TSNE projection of the user embeddings from an MNIST model both: (a) without the <math id="A3.F4.3.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A3.F4.3.1.m1.1b"><mi id="A3.F4.3.1.m1.1.1" xref="A3.F4.3.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A3.F4.3.1.m1.1c"><ci id="A3.F4.3.1.m1.1.1.cmml" xref="A3.F4.3.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.F4.3.1.m1.1d">k</annotation></semantics></math>-way classification head, and (b) with the <math id="A3.F4.4.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A3.F4.4.2.m2.1b"><mi id="A3.F4.4.2.m2.1.1" xref="A3.F4.4.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A3.F4.4.2.m2.1c"><ci id="A3.F4.4.2.m2.1.1.cmml" xref="A3.F4.4.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.F4.4.2.m2.1d">k</annotation></semantics></math>-way classification head.</span></figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Class-wise Preference Performance on Imbalanced Data</h2>

<section id="A4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.1 </span>MNIST</h3>

<div id="A4.SS1.p1" class="ltx_para">
<p id="A4.SS1.p1.1" class="ltx_p">The mean and standard deviation F1-score per federated learning approach (with and without Gaussian privacy) broken down by the prevalence of a user preference type in the training dataset are reported in Table <a href="#A4.T4" title="Table 4 ‣ D.1 MNIST ‣ Appendix D Class-wise Preference Performance on Imbalanced Data ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. For the imbalanced dataset scenario, 25% of the dataset consists of users with a preference for digit 0, 15% of users with a preference for digit 1, 10% each with a preference for digits 2 - 5, and 5% each with a preference for digits 6-9.</p>
</div>
<figure id="A4.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A4.T4.74.1.1" class="ltx_text" style="font-size:90%;">Table 4</span>: </span><span id="A4.T4.75.2" class="ltx_text" style="font-size:90%;">Mean F1 scores over five independent trails for imbalanced MNIST data (bold indicates best)</span></figcaption>
<table id="A4.T4.72" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A4.T4.72.73.1" class="ltx_tr">
<th id="A4.T4.72.73.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">Method</th>
<td id="A4.T4.72.73.1.2" class="ltx_td ltx_align_center ltx_border_t" colspan="4">No Privacy</td>
</tr>
<tr id="A4.T4.72.74.2" class="ltx_tr">
<th id="A4.T4.72.74.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">Sub-population representation</th>
<td id="A4.T4.72.74.2.2" class="ltx_td ltx_align_center ltx_border_t">25%</td>
<td id="A4.T4.72.74.2.3" class="ltx_td ltx_align_center ltx_border_t">15%</td>
<td id="A4.T4.72.74.2.4" class="ltx_td ltx_align_center ltx_border_t">10%</td>
<td id="A4.T4.72.74.2.5" class="ltx_td ltx_align_center ltx_border_t">5%</td>
</tr>
<tr id="A4.T4.4.4" class="ltx_tr">
<th id="A4.T4.4.4.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt">PFedMe</th>
<td id="A4.T4.1.1.1" class="ltx_td ltx_align_left ltx_border_tt">0.77 <math id="A4.T4.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.1.1.1.m1.1a"><mo id="A4.T4.1.1.1.m1.1.1" xref="A4.T4.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.1.1.1.m1.1b"><csymbol cd="latexml" id="A4.T4.1.1.1.m1.1.1.cmml" xref="A4.T4.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.1.1.1.m1.1c">\pm</annotation></semantics></math> 0.19</td>
<td id="A4.T4.2.2.2" class="ltx_td ltx_align_left ltx_border_tt">0.79 <math id="A4.T4.2.2.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.2.2.2.m1.1a"><mo id="A4.T4.2.2.2.m1.1.1" xref="A4.T4.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.2.2.2.m1.1b"><csymbol cd="latexml" id="A4.T4.2.2.2.m1.1.1.cmml" xref="A4.T4.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.2.2.2.m1.1c">\pm</annotation></semantics></math> 0.17</td>
<td id="A4.T4.3.3.3" class="ltx_td ltx_align_left ltx_border_tt">0.74 <math id="A4.T4.3.3.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.3.3.3.m1.1a"><mo id="A4.T4.3.3.3.m1.1.1" xref="A4.T4.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.3.3.3.m1.1b"><csymbol cd="latexml" id="A4.T4.3.3.3.m1.1.1.cmml" xref="A4.T4.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.3.3.3.m1.1c">\pm</annotation></semantics></math> 0.14</td>
<td id="A4.T4.4.4.4" class="ltx_td ltx_align_left ltx_border_tt">0.76 <math id="A4.T4.4.4.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.4.4.4.m1.1a"><mo id="A4.T4.4.4.4.m1.1.1" xref="A4.T4.4.4.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.4.4.4.m1.1b"><csymbol cd="latexml" id="A4.T4.4.4.4.m1.1.1.cmml" xref="A4.T4.4.4.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.4.4.4.m1.1c">\pm</annotation></semantics></math> 0.15</td>
</tr>
<tr id="A4.T4.8.8" class="ltx_tr">
<th id="A4.T4.8.8.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">PFedKM</th>
<td id="A4.T4.5.5.1" class="ltx_td ltx_align_left">0.66 <math id="A4.T4.5.5.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.5.5.1.m1.1a"><mo id="A4.T4.5.5.1.m1.1.1" xref="A4.T4.5.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.5.5.1.m1.1b"><csymbol cd="latexml" id="A4.T4.5.5.1.m1.1.1.cmml" xref="A4.T4.5.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.5.5.1.m1.1c">\pm</annotation></semantics></math> 0.04</td>
<td id="A4.T4.6.6.2" class="ltx_td ltx_align_left">0.57 <math id="A4.T4.6.6.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.6.6.2.m1.1a"><mo id="A4.T4.6.6.2.m1.1.1" xref="A4.T4.6.6.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.6.6.2.m1.1b"><csymbol cd="latexml" id="A4.T4.6.6.2.m1.1.1.cmml" xref="A4.T4.6.6.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.6.6.2.m1.1c">\pm</annotation></semantics></math> 0.04</td>
<td id="A4.T4.7.7.3" class="ltx_td ltx_align_left">0.49 <math id="A4.T4.7.7.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.7.7.3.m1.1a"><mo id="A4.T4.7.7.3.m1.1.1" xref="A4.T4.7.7.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.7.7.3.m1.1b"><csymbol cd="latexml" id="A4.T4.7.7.3.m1.1.1.cmml" xref="A4.T4.7.7.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.7.7.3.m1.1c">\pm</annotation></semantics></math> 0.03</td>
<td id="A4.T4.8.8.4" class="ltx_td ltx_align_left">0.43 <math id="A4.T4.8.8.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.8.8.4.m1.1a"><mo id="A4.T4.8.8.4.m1.1.1" xref="A4.T4.8.8.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.8.8.4.m1.1b"><csymbol cd="latexml" id="A4.T4.8.8.4.m1.1.1.cmml" xref="A4.T4.8.8.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.8.8.4.m1.1c">\pm</annotation></semantics></math> 0.03</td>
</tr>
<tr id="A4.T4.12.12" class="ltx_tr">
<th id="A4.T4.12.12.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">FedRep</th>
<td id="A4.T4.9.9.1" class="ltx_td ltx_align_left">0.80 <math id="A4.T4.9.9.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.9.9.1.m1.1a"><mo id="A4.T4.9.9.1.m1.1.1" xref="A4.T4.9.9.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.9.9.1.m1.1b"><csymbol cd="latexml" id="A4.T4.9.9.1.m1.1.1.cmml" xref="A4.T4.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.9.9.1.m1.1c">\pm</annotation></semantics></math> 0.18</td>
<td id="A4.T4.10.10.2" class="ltx_td ltx_align_left">0.79 <math id="A4.T4.10.10.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.10.10.2.m1.1a"><mo id="A4.T4.10.10.2.m1.1.1" xref="A4.T4.10.10.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.10.10.2.m1.1b"><csymbol cd="latexml" id="A4.T4.10.10.2.m1.1.1.cmml" xref="A4.T4.10.10.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.10.10.2.m1.1c">\pm</annotation></semantics></math> 0.15</td>
<td id="A4.T4.11.11.3" class="ltx_td ltx_align_left">0.75 <math id="A4.T4.11.11.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.11.11.3.m1.1a"><mo id="A4.T4.11.11.3.m1.1.1" xref="A4.T4.11.11.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.11.11.3.m1.1b"><csymbol cd="latexml" id="A4.T4.11.11.3.m1.1.1.cmml" xref="A4.T4.11.11.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.11.11.3.m1.1c">\pm</annotation></semantics></math> 0.14</td>
<td id="A4.T4.12.12.4" class="ltx_td ltx_align_left">0.77 <math id="A4.T4.12.12.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.12.12.4.m1.1a"><mo id="A4.T4.12.12.4.m1.1.1" xref="A4.T4.12.12.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.12.12.4.m1.1b"><csymbol cd="latexml" id="A4.T4.12.12.4.m1.1.1.cmml" xref="A4.T4.12.12.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.12.12.4.m1.1c">\pm</annotation></semantics></math> 0.15</td>
</tr>
<tr id="A4.T4.16.16" class="ltx_tr">
<th id="A4.T4.16.16.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Global</th>
<td id="A4.T4.13.13.1" class="ltx_td ltx_align_left">0.82 <math id="A4.T4.13.13.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.13.13.1.m1.1a"><mo id="A4.T4.13.13.1.m1.1.1" xref="A4.T4.13.13.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.13.13.1.m1.1b"><csymbol cd="latexml" id="A4.T4.13.13.1.m1.1.1.cmml" xref="A4.T4.13.13.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.13.13.1.m1.1c">\pm</annotation></semantics></math> 0.10</td>
<td id="A4.T4.14.14.2" class="ltx_td ltx_align_left">0.43 <math id="A4.T4.14.14.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.14.14.2.m1.1a"><mo id="A4.T4.14.14.2.m1.1.1" xref="A4.T4.14.14.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.14.14.2.m1.1b"><csymbol cd="latexml" id="A4.T4.14.14.2.m1.1.1.cmml" xref="A4.T4.14.14.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.14.14.2.m1.1c">\pm</annotation></semantics></math> 0.09</td>
<td id="A4.T4.15.15.3" class="ltx_td ltx_align_left">0.38 <math id="A4.T4.15.15.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.15.15.3.m1.1a"><mo id="A4.T4.15.15.3.m1.1.1" xref="A4.T4.15.15.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.15.15.3.m1.1b"><csymbol cd="latexml" id="A4.T4.15.15.3.m1.1.1.cmml" xref="A4.T4.15.15.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.15.15.3.m1.1c">\pm</annotation></semantics></math> 0.03</td>
<td id="A4.T4.16.16.4" class="ltx_td ltx_align_left">0.36 <math id="A4.T4.16.16.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.16.16.4.m1.1a"><mo id="A4.T4.16.16.4.m1.1.1" xref="A4.T4.16.16.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.16.16.4.m1.1b"><csymbol cd="latexml" id="A4.T4.16.16.4.m1.1.1.cmml" xref="A4.T4.16.16.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.16.16.4.m1.1c">\pm</annotation></semantics></math> 0.02</td>
</tr>
<tr id="A4.T4.20.20" class="ltx_tr">
<th id="A4.T4.20.20.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Global+</th>
<td id="A4.T4.17.17.1" class="ltx_td ltx_align_left">0.83 <math id="A4.T4.17.17.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.17.17.1.m1.1a"><mo id="A4.T4.17.17.1.m1.1.1" xref="A4.T4.17.17.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.17.17.1.m1.1b"><csymbol cd="latexml" id="A4.T4.17.17.1.m1.1.1.cmml" xref="A4.T4.17.17.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.17.17.1.m1.1c">\pm</annotation></semantics></math> 0.10</td>
<td id="A4.T4.18.18.2" class="ltx_td ltx_align_left">0.40 <math id="A4.T4.18.18.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.18.18.2.m1.1a"><mo id="A4.T4.18.18.2.m1.1.1" xref="A4.T4.18.18.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.18.18.2.m1.1b"><csymbol cd="latexml" id="A4.T4.18.18.2.m1.1.1.cmml" xref="A4.T4.18.18.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.18.18.2.m1.1c">\pm</annotation></semantics></math> 0.16</td>
<td id="A4.T4.19.19.3" class="ltx_td ltx_align_left">0.41 <math id="A4.T4.19.19.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.19.19.3.m1.1a"><mo id="A4.T4.19.19.3.m1.1.1" xref="A4.T4.19.19.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.19.19.3.m1.1b"><csymbol cd="latexml" id="A4.T4.19.19.3.m1.1.1.cmml" xref="A4.T4.19.19.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.19.19.3.m1.1c">\pm</annotation></semantics></math> 0.08</td>
<td id="A4.T4.20.20.4" class="ltx_td ltx_align_left">0.36 <math id="A4.T4.20.20.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.20.20.4.m1.1a"><mo id="A4.T4.20.20.4.m1.1.1" xref="A4.T4.20.20.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.20.20.4.m1.1b"><csymbol cd="latexml" id="A4.T4.20.20.4.m1.1.1.cmml" xref="A4.T4.20.20.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.20.20.4.m1.1c">\pm</annotation></semantics></math> 0.10</td>
</tr>
<tr id="A4.T4.24.24" class="ltx_tr">
<th id="A4.T4.24.24.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">FedEmbed-Personal</th>
<td id="A4.T4.21.21.1" class="ltx_td ltx_align_left">0.72 <math id="A4.T4.21.21.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.21.21.1.m1.1a"><mo id="A4.T4.21.21.1.m1.1.1" xref="A4.T4.21.21.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.21.21.1.m1.1b"><csymbol cd="latexml" id="A4.T4.21.21.1.m1.1.1.cmml" xref="A4.T4.21.21.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.21.21.1.m1.1c">\pm</annotation></semantics></math> 0.16</td>
<td id="A4.T4.22.22.2" class="ltx_td ltx_align_left">0.75 <math id="A4.T4.22.22.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.22.22.2.m1.1a"><mo id="A4.T4.22.22.2.m1.1.1" xref="A4.T4.22.22.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.22.22.2.m1.1b"><csymbol cd="latexml" id="A4.T4.22.22.2.m1.1.1.cmml" xref="A4.T4.22.22.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.22.22.2.m1.1c">\pm</annotation></semantics></math> 0.13</td>
<td id="A4.T4.23.23.3" class="ltx_td ltx_align_left">0.74 <math id="A4.T4.23.23.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.23.23.3.m1.1a"><mo id="A4.T4.23.23.3.m1.1.1" xref="A4.T4.23.23.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.23.23.3.m1.1b"><csymbol cd="latexml" id="A4.T4.23.23.3.m1.1.1.cmml" xref="A4.T4.23.23.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.23.23.3.m1.1c">\pm</annotation></semantics></math> 0.12</td>
<td id="A4.T4.24.24.4" class="ltx_td ltx_align_left">0.74 <math id="A4.T4.24.24.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.24.24.4.m1.1a"><mo id="A4.T4.24.24.4.m1.1.1" xref="A4.T4.24.24.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.24.24.4.m1.1b"><csymbol cd="latexml" id="A4.T4.24.24.4.m1.1.1.cmml" xref="A4.T4.24.24.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.24.24.4.m1.1c">\pm</annotation></semantics></math> 0.15</td>
</tr>
<tr id="A4.T4.28.28" class="ltx_tr">
<th id="A4.T4.28.28.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">FedEmbed-SOM</th>
<td id="A4.T4.25.25.1" class="ltx_td ltx_align_left">0.91 <math id="A4.T4.25.25.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.25.25.1.m1.1a"><mo id="A4.T4.25.25.1.m1.1.1" xref="A4.T4.25.25.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.25.25.1.m1.1b"><csymbol cd="latexml" id="A4.T4.25.25.1.m1.1.1.cmml" xref="A4.T4.25.25.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.25.25.1.m1.1c">\pm</annotation></semantics></math> 0.14</td>
<td id="A4.T4.26.26.2" class="ltx_td ltx_align_left">0.69 <math id="A4.T4.26.26.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.26.26.2.m1.1a"><mo id="A4.T4.26.26.2.m1.1.1" xref="A4.T4.26.26.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.26.26.2.m1.1b"><csymbol cd="latexml" id="A4.T4.26.26.2.m1.1.1.cmml" xref="A4.T4.26.26.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.26.26.2.m1.1c">\pm</annotation></semantics></math> 0.08</td>
<td id="A4.T4.27.27.3" class="ltx_td ltx_align_left">0.61 <math id="A4.T4.27.27.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.27.27.3.m1.1a"><mo id="A4.T4.27.27.3.m1.1.1" xref="A4.T4.27.27.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.27.27.3.m1.1b"><csymbol cd="latexml" id="A4.T4.27.27.3.m1.1.1.cmml" xref="A4.T4.27.27.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.27.27.3.m1.1c">\pm</annotation></semantics></math> 0.13</td>
<td id="A4.T4.28.28.4" class="ltx_td ltx_align_left">0.45 <math id="A4.T4.28.28.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.28.28.4.m1.1a"><mo id="A4.T4.28.28.4.m1.1.1" xref="A4.T4.28.28.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.28.28.4.m1.1b"><csymbol cd="latexml" id="A4.T4.28.28.4.m1.1.1.cmml" xref="A4.T4.28.28.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.28.28.4.m1.1c">\pm</annotation></semantics></math> 0.14</td>
</tr>
<tr id="A4.T4.32.32" class="ltx_tr">
<th id="A4.T4.32.32.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="A4.T4.32.32.5.1" class="ltx_text ltx_font_bold">FedEmbed-Prototype</span></th>
<td id="A4.T4.29.29.1" class="ltx_td ltx_align_left">0.82 <math id="A4.T4.29.29.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.29.29.1.m1.1a"><mo id="A4.T4.29.29.1.m1.1.1" xref="A4.T4.29.29.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.29.29.1.m1.1b"><csymbol cd="latexml" id="A4.T4.29.29.1.m1.1.1.cmml" xref="A4.T4.29.29.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.29.29.1.m1.1c">\pm</annotation></semantics></math> 0.16</td>
<td id="A4.T4.30.30.2" class="ltx_td ltx_align_left">0.86 <math id="A4.T4.30.30.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.30.30.2.m1.1a"><mo id="A4.T4.30.30.2.m1.1.1" xref="A4.T4.30.30.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.30.30.2.m1.1b"><csymbol cd="latexml" id="A4.T4.30.30.2.m1.1.1.cmml" xref="A4.T4.30.30.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.30.30.2.m1.1c">\pm</annotation></semantics></math> 0.06</td>
<td id="A4.T4.31.31.3" class="ltx_td ltx_align_left"><span id="A4.T4.31.31.3.1" class="ltx_text ltx_font_bold">0.85 <math id="A4.T4.31.31.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.31.31.3.1.m1.1a"><mo id="A4.T4.31.31.3.1.m1.1.1" xref="A4.T4.31.31.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.31.31.3.1.m1.1b"><csymbol cd="latexml" id="A4.T4.31.31.3.1.m1.1.1.cmml" xref="A4.T4.31.31.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.31.31.3.1.m1.1c">\pm</annotation></semantics></math> 0.07</span></td>
<td id="A4.T4.32.32.4" class="ltx_td ltx_align_left"><span id="A4.T4.32.32.4.1" class="ltx_text ltx_font_bold">0.89 <math id="A4.T4.32.32.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.32.32.4.1.m1.1a"><mo id="A4.T4.32.32.4.1.m1.1.1" xref="A4.T4.32.32.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.32.32.4.1.m1.1b"><csymbol cd="latexml" id="A4.T4.32.32.4.1.m1.1.1.cmml" xref="A4.T4.32.32.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.32.32.4.1.m1.1c">\pm</annotation></semantics></math> 0.05</span></td>
</tr>
<tr id="A4.T4.36.36" class="ltx_tr">
<th id="A4.T4.36.36.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="A4.T4.36.36.5.1" class="ltx_text ltx_font_bold">FedEmbed-Type</span></th>
<td id="A4.T4.33.33.1" class="ltx_td ltx_align_left"><span id="A4.T4.33.33.1.1" class="ltx_text ltx_font_bold">0.92 <math id="A4.T4.33.33.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.33.33.1.1.m1.1a"><mo id="A4.T4.33.33.1.1.m1.1.1" xref="A4.T4.33.33.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.33.33.1.1.m1.1b"><csymbol cd="latexml" id="A4.T4.33.33.1.1.m1.1.1.cmml" xref="A4.T4.33.33.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.33.33.1.1.m1.1c">\pm</annotation></semantics></math> 0.27</span></td>
<td id="A4.T4.34.34.2" class="ltx_td ltx_align_left"><span id="A4.T4.34.34.2.1" class="ltx_text ltx_font_bold">0.91 <math id="A4.T4.34.34.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.34.34.2.1.m1.1a"><mo id="A4.T4.34.34.2.1.m1.1.1" xref="A4.T4.34.34.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.34.34.2.1.m1.1b"><csymbol cd="latexml" id="A4.T4.34.34.2.1.m1.1.1.cmml" xref="A4.T4.34.34.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.34.34.2.1.m1.1c">\pm</annotation></semantics></math> 0.26</span></td>
<td id="A4.T4.35.35.3" class="ltx_td ltx_align_left">0.84 <math id="A4.T4.35.35.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.35.35.3.m1.1a"><mo id="A4.T4.35.35.3.m1.1.1" xref="A4.T4.35.35.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.35.35.3.m1.1b"><csymbol cd="latexml" id="A4.T4.35.35.3.m1.1.1.cmml" xref="A4.T4.35.35.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.35.35.3.m1.1c">\pm</annotation></semantics></math> 0.23</td>
<td id="A4.T4.36.36.4" class="ltx_td ltx_align_left">0.83 <math id="A4.T4.36.36.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.36.36.4.m1.1a"><mo id="A4.T4.36.36.4.m1.1.1" xref="A4.T4.36.36.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.36.36.4.m1.1b"><csymbol cd="latexml" id="A4.T4.36.36.4.m1.1.1.cmml" xref="A4.T4.36.36.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.36.36.4.m1.1c">\pm</annotation></semantics></math> 0.24</td>
</tr>
<tr id="A4.T4.72.75.3" class="ltx_tr">
<th id="A4.T4.72.75.3.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="A4.T4.72.75.3.2" class="ltx_td ltx_align_center ltx_border_t" colspan="4">Gaussian Privacy</td>
</tr>
<tr id="A4.T4.40.40" class="ltx_tr">
<th id="A4.T4.40.40.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt">PFedMe</th>
<td id="A4.T4.37.37.1" class="ltx_td ltx_align_left ltx_border_tt">0.49 <math id="A4.T4.37.37.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.37.37.1.m1.1a"><mo id="A4.T4.37.37.1.m1.1.1" xref="A4.T4.37.37.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.37.37.1.m1.1b"><csymbol cd="latexml" id="A4.T4.37.37.1.m1.1.1.cmml" xref="A4.T4.37.37.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.37.37.1.m1.1c">\pm</annotation></semantics></math> 0.06</td>
<td id="A4.T4.38.38.2" class="ltx_td ltx_align_left ltx_border_tt">0.50 <math id="A4.T4.38.38.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.38.38.2.m1.1a"><mo id="A4.T4.38.38.2.m1.1.1" xref="A4.T4.38.38.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.38.38.2.m1.1b"><csymbol cd="latexml" id="A4.T4.38.38.2.m1.1.1.cmml" xref="A4.T4.38.38.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.38.38.2.m1.1c">\pm</annotation></semantics></math> 0.07</td>
<td id="A4.T4.39.39.3" class="ltx_td ltx_align_left ltx_border_tt">0.49 <math id="A4.T4.39.39.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.39.39.3.m1.1a"><mo id="A4.T4.39.39.3.m1.1.1" xref="A4.T4.39.39.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.39.39.3.m1.1b"><csymbol cd="latexml" id="A4.T4.39.39.3.m1.1.1.cmml" xref="A4.T4.39.39.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.39.39.3.m1.1c">\pm</annotation></semantics></math> 0.05</td>
<td id="A4.T4.40.40.4" class="ltx_td ltx_align_left ltx_border_tt">0.48 <math id="A4.T4.40.40.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.40.40.4.m1.1a"><mo id="A4.T4.40.40.4.m1.1.1" xref="A4.T4.40.40.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.40.40.4.m1.1b"><csymbol cd="latexml" id="A4.T4.40.40.4.m1.1.1.cmml" xref="A4.T4.40.40.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.40.40.4.m1.1c">\pm</annotation></semantics></math> 0.05</td>
</tr>
<tr id="A4.T4.44.44" class="ltx_tr">
<th id="A4.T4.44.44.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">PFedKM</th>
<td id="A4.T4.41.41.1" class="ltx_td ltx_align_left">0.49 <math id="A4.T4.41.41.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.41.41.1.m1.1a"><mo id="A4.T4.41.41.1.m1.1.1" xref="A4.T4.41.41.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.41.41.1.m1.1b"><csymbol cd="latexml" id="A4.T4.41.41.1.m1.1.1.cmml" xref="A4.T4.41.41.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.41.41.1.m1.1c">\pm</annotation></semantics></math> 0.02</td>
<td id="A4.T4.42.42.2" class="ltx_td ltx_align_left">0.47 <math id="A4.T4.42.42.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.42.42.2.m1.1a"><mo id="A4.T4.42.42.2.m1.1.1" xref="A4.T4.42.42.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.42.42.2.m1.1b"><csymbol cd="latexml" id="A4.T4.42.42.2.m1.1.1.cmml" xref="A4.T4.42.42.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.42.42.2.m1.1c">\pm</annotation></semantics></math> 0.03</td>
<td id="A4.T4.43.43.3" class="ltx_td ltx_align_left">0.48 <math id="A4.T4.43.43.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.43.43.3.m1.1a"><mo id="A4.T4.43.43.3.m1.1.1" xref="A4.T4.43.43.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.43.43.3.m1.1b"><csymbol cd="latexml" id="A4.T4.43.43.3.m1.1.1.cmml" xref="A4.T4.43.43.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.43.43.3.m1.1c">\pm</annotation></semantics></math> 0.02</td>
<td id="A4.T4.44.44.4" class="ltx_td ltx_align_left">0.48 <math id="A4.T4.44.44.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.44.44.4.m1.1a"><mo id="A4.T4.44.44.4.m1.1.1" xref="A4.T4.44.44.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.44.44.4.m1.1b"><csymbol cd="latexml" id="A4.T4.44.44.4.m1.1.1.cmml" xref="A4.T4.44.44.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.44.44.4.m1.1c">\pm</annotation></semantics></math> 0.02</td>
</tr>
<tr id="A4.T4.48.48" class="ltx_tr">
<th id="A4.T4.48.48.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">FedRep</th>
<td id="A4.T4.45.45.1" class="ltx_td ltx_align_left">0.55 <math id="A4.T4.45.45.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.45.45.1.m1.1a"><mo id="A4.T4.45.45.1.m1.1.1" xref="A4.T4.45.45.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.45.45.1.m1.1b"><csymbol cd="latexml" id="A4.T4.45.45.1.m1.1.1.cmml" xref="A4.T4.45.45.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.45.45.1.m1.1c">\pm</annotation></semantics></math> 0.05</td>
<td id="A4.T4.46.46.2" class="ltx_td ltx_align_left">0.49 <math id="A4.T4.46.46.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.46.46.2.m1.1a"><mo id="A4.T4.46.46.2.m1.1.1" xref="A4.T4.46.46.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.46.46.2.m1.1b"><csymbol cd="latexml" id="A4.T4.46.46.2.m1.1.1.cmml" xref="A4.T4.46.46.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.46.46.2.m1.1c">\pm</annotation></semantics></math> 0.05</td>
<td id="A4.T4.47.47.3" class="ltx_td ltx_align_left">0.51 <math id="A4.T4.47.47.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.47.47.3.m1.1a"><mo id="A4.T4.47.47.3.m1.1.1" xref="A4.T4.47.47.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.47.47.3.m1.1b"><csymbol cd="latexml" id="A4.T4.47.47.3.m1.1.1.cmml" xref="A4.T4.47.47.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.47.47.3.m1.1c">\pm</annotation></semantics></math> 0.03</td>
<td id="A4.T4.48.48.4" class="ltx_td ltx_align_left">0.50 <math id="A4.T4.48.48.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.48.48.4.m1.1a"><mo id="A4.T4.48.48.4.m1.1.1" xref="A4.T4.48.48.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.48.48.4.m1.1b"><csymbol cd="latexml" id="A4.T4.48.48.4.m1.1.1.cmml" xref="A4.T4.48.48.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.48.48.4.m1.1c">\pm</annotation></semantics></math> 0.03</td>
</tr>
<tr id="A4.T4.52.52" class="ltx_tr">
<th id="A4.T4.52.52.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Global</th>
<td id="A4.T4.49.49.1" class="ltx_td ltx_align_left">0.39 <math id="A4.T4.49.49.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.49.49.1.m1.1a"><mo id="A4.T4.49.49.1.m1.1.1" xref="A4.T4.49.49.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.49.49.1.m1.1b"><csymbol cd="latexml" id="A4.T4.49.49.1.m1.1.1.cmml" xref="A4.T4.49.49.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.49.49.1.m1.1c">\pm</annotation></semantics></math> 0.10</td>
<td id="A4.T4.50.50.2" class="ltx_td ltx_align_left">0.37 <math id="A4.T4.50.50.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.50.50.2.m1.1a"><mo id="A4.T4.50.50.2.m1.1.1" xref="A4.T4.50.50.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.50.50.2.m1.1b"><csymbol cd="latexml" id="A4.T4.50.50.2.m1.1.1.cmml" xref="A4.T4.50.50.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.50.50.2.m1.1c">\pm</annotation></semantics></math> 0.10</td>
<td id="A4.T4.51.51.3" class="ltx_td ltx_align_left">0.38 <math id="A4.T4.51.51.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.51.51.3.m1.1a"><mo id="A4.T4.51.51.3.m1.1.1" xref="A4.T4.51.51.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.51.51.3.m1.1b"><csymbol cd="latexml" id="A4.T4.51.51.3.m1.1.1.cmml" xref="A4.T4.51.51.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.51.51.3.m1.1c">\pm</annotation></semantics></math> 0.09</td>
<td id="A4.T4.52.52.4" class="ltx_td ltx_align_left">0.37 <math id="A4.T4.52.52.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.52.52.4.m1.1a"><mo id="A4.T4.52.52.4.m1.1.1" xref="A4.T4.52.52.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.52.52.4.m1.1b"><csymbol cd="latexml" id="A4.T4.52.52.4.m1.1.1.cmml" xref="A4.T4.52.52.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.52.52.4.m1.1c">\pm</annotation></semantics></math> 0.08</td>
</tr>
<tr id="A4.T4.56.56" class="ltx_tr">
<th id="A4.T4.56.56.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Global+</th>
<td id="A4.T4.53.53.1" class="ltx_td ltx_align_left">0.33 <math id="A4.T4.53.53.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.53.53.1.m1.1a"><mo id="A4.T4.53.53.1.m1.1.1" xref="A4.T4.53.53.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.53.53.1.m1.1b"><csymbol cd="latexml" id="A4.T4.53.53.1.m1.1.1.cmml" xref="A4.T4.53.53.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.53.53.1.m1.1c">\pm</annotation></semantics></math> 0.10</td>
<td id="A4.T4.54.54.2" class="ltx_td ltx_align_left">0.34 <math id="A4.T4.54.54.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.54.54.2.m1.1a"><mo id="A4.T4.54.54.2.m1.1.1" xref="A4.T4.54.54.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.54.54.2.m1.1b"><csymbol cd="latexml" id="A4.T4.54.54.2.m1.1.1.cmml" xref="A4.T4.54.54.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.54.54.2.m1.1c">\pm</annotation></semantics></math> 0.08</td>
<td id="A4.T4.55.55.3" class="ltx_td ltx_align_left">0.34 <math id="A4.T4.55.55.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.55.55.3.m1.1a"><mo id="A4.T4.55.55.3.m1.1.1" xref="A4.T4.55.55.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.55.55.3.m1.1b"><csymbol cd="latexml" id="A4.T4.55.55.3.m1.1.1.cmml" xref="A4.T4.55.55.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.55.55.3.m1.1c">\pm</annotation></semantics></math> 0.07</td>
<td id="A4.T4.56.56.4" class="ltx_td ltx_align_left">0.34 <math id="A4.T4.56.56.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.56.56.4.m1.1a"><mo id="A4.T4.56.56.4.m1.1.1" xref="A4.T4.56.56.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.56.56.4.m1.1b"><csymbol cd="latexml" id="A4.T4.56.56.4.m1.1.1.cmml" xref="A4.T4.56.56.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.56.56.4.m1.1c">\pm</annotation></semantics></math> 0.07</td>
</tr>
<tr id="A4.T4.60.60" class="ltx_tr">
<th id="A4.T4.60.60.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">FedEmbed-Personal</th>
<td id="A4.T4.57.57.1" class="ltx_td ltx_align_left">0.51 <math id="A4.T4.57.57.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.57.57.1.m1.1a"><mo id="A4.T4.57.57.1.m1.1.1" xref="A4.T4.57.57.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.57.57.1.m1.1b"><csymbol cd="latexml" id="A4.T4.57.57.1.m1.1.1.cmml" xref="A4.T4.57.57.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.57.57.1.m1.1c">\pm</annotation></semantics></math> 0.06</td>
<td id="A4.T4.58.58.2" class="ltx_td ltx_align_left">0.49 <math id="A4.T4.58.58.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.58.58.2.m1.1a"><mo id="A4.T4.58.58.2.m1.1.1" xref="A4.T4.58.58.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.58.58.2.m1.1b"><csymbol cd="latexml" id="A4.T4.58.58.2.m1.1.1.cmml" xref="A4.T4.58.58.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.58.58.2.m1.1c">\pm</annotation></semantics></math> 0.05</td>
<td id="A4.T4.59.59.3" class="ltx_td ltx_align_left">0.50 <math id="A4.T4.59.59.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.59.59.3.m1.1a"><mo id="A4.T4.59.59.3.m1.1.1" xref="A4.T4.59.59.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.59.59.3.m1.1b"><csymbol cd="latexml" id="A4.T4.59.59.3.m1.1.1.cmml" xref="A4.T4.59.59.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.59.59.3.m1.1c">\pm</annotation></semantics></math> 0.03</td>
<td id="A4.T4.60.60.4" class="ltx_td ltx_align_left">0.50 <math id="A4.T4.60.60.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.60.60.4.m1.1a"><mo id="A4.T4.60.60.4.m1.1.1" xref="A4.T4.60.60.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.60.60.4.m1.1b"><csymbol cd="latexml" id="A4.T4.60.60.4.m1.1.1.cmml" xref="A4.T4.60.60.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.60.60.4.m1.1c">\pm</annotation></semantics></math> 0.04</td>
</tr>
<tr id="A4.T4.64.64" class="ltx_tr">
<th id="A4.T4.64.64.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">FedEmbed-SOM</th>
<td id="A4.T4.61.61.1" class="ltx_td ltx_align_left">0.65 <math id="A4.T4.61.61.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.61.61.1.m1.1a"><mo id="A4.T4.61.61.1.m1.1.1" xref="A4.T4.61.61.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.61.61.1.m1.1b"><csymbol cd="latexml" id="A4.T4.61.61.1.m1.1.1.cmml" xref="A4.T4.61.61.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.61.61.1.m1.1c">\pm</annotation></semantics></math> 0.13</td>
<td id="A4.T4.62.62.2" class="ltx_td ltx_align_left">0.49 <math id="A4.T4.62.62.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.62.62.2.m1.1a"><mo id="A4.T4.62.62.2.m1.1.1" xref="A4.T4.62.62.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.62.62.2.m1.1b"><csymbol cd="latexml" id="A4.T4.62.62.2.m1.1.1.cmml" xref="A4.T4.62.62.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.62.62.2.m1.1c">\pm</annotation></semantics></math> 0.13</td>
<td id="A4.T4.63.63.3" class="ltx_td ltx_align_left">0.49 <math id="A4.T4.63.63.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.63.63.3.m1.1a"><mo id="A4.T4.63.63.3.m1.1.1" xref="A4.T4.63.63.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.63.63.3.m1.1b"><csymbol cd="latexml" id="A4.T4.63.63.3.m1.1.1.cmml" xref="A4.T4.63.63.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.63.63.3.m1.1c">\pm</annotation></semantics></math> 0.08</td>
<td id="A4.T4.64.64.4" class="ltx_td ltx_align_left">0.45 <math id="A4.T4.64.64.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.64.64.4.m1.1a"><mo id="A4.T4.64.64.4.m1.1.1" xref="A4.T4.64.64.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.64.64.4.m1.1b"><csymbol cd="latexml" id="A4.T4.64.64.4.m1.1.1.cmml" xref="A4.T4.64.64.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.64.64.4.m1.1c">\pm</annotation></semantics></math> 0.07</td>
</tr>
<tr id="A4.T4.68.68" class="ltx_tr">
<th id="A4.T4.68.68.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="A4.T4.68.68.5.1" class="ltx_text ltx_font_bold">FedEmbed-Prototype</span></th>
<td id="A4.T4.65.65.1" class="ltx_td ltx_align_left"><span id="A4.T4.65.65.1.1" class="ltx_text ltx_font_bold">0.85 <math id="A4.T4.65.65.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.65.65.1.1.m1.1a"><mo id="A4.T4.65.65.1.1.m1.1.1" xref="A4.T4.65.65.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.65.65.1.1.m1.1b"><csymbol cd="latexml" id="A4.T4.65.65.1.1.m1.1.1.cmml" xref="A4.T4.65.65.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.65.65.1.1.m1.1c">\pm</annotation></semantics></math> 0.13</span></td>
<td id="A4.T4.66.66.2" class="ltx_td ltx_align_left">0.59 <math id="A4.T4.66.66.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.66.66.2.m1.1a"><mo id="A4.T4.66.66.2.m1.1.1" xref="A4.T4.66.66.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.66.66.2.m1.1b"><csymbol cd="latexml" id="A4.T4.66.66.2.m1.1.1.cmml" xref="A4.T4.66.66.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.66.66.2.m1.1c">\pm</annotation></semantics></math> 0.14</td>
<td id="A4.T4.67.67.3" class="ltx_td ltx_align_left">0.69 <math id="A4.T4.67.67.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.67.67.3.m1.1a"><mo id="A4.T4.67.67.3.m1.1.1" xref="A4.T4.67.67.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.67.67.3.m1.1b"><csymbol cd="latexml" id="A4.T4.67.67.3.m1.1.1.cmml" xref="A4.T4.67.67.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.67.67.3.m1.1c">\pm</annotation></semantics></math> 0.18</td>
<td id="A4.T4.68.68.4" class="ltx_td ltx_align_left"><span id="A4.T4.68.68.4.1" class="ltx_text ltx_font_bold">0.69 <math id="A4.T4.68.68.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.68.68.4.1.m1.1a"><mo id="A4.T4.68.68.4.1.m1.1.1" xref="A4.T4.68.68.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.68.68.4.1.m1.1b"><csymbol cd="latexml" id="A4.T4.68.68.4.1.m1.1.1.cmml" xref="A4.T4.68.68.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.68.68.4.1.m1.1c">\pm</annotation></semantics></math> 0.16</span></td>
</tr>
<tr id="A4.T4.72.72" class="ltx_tr">
<th id="A4.T4.72.72.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="A4.T4.72.72.5.1" class="ltx_text ltx_font_bold">FedEmbed-Type</span></th>
<td id="A4.T4.69.69.1" class="ltx_td ltx_align_left">0.79 <math id="A4.T4.69.69.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.69.69.1.m1.1a"><mo id="A4.T4.69.69.1.m1.1.1" xref="A4.T4.69.69.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.69.69.1.m1.1b"><csymbol cd="latexml" id="A4.T4.69.69.1.m1.1.1.cmml" xref="A4.T4.69.69.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.69.69.1.m1.1c">\pm</annotation></semantics></math> 0.20</td>
<td id="A4.T4.70.70.2" class="ltx_td ltx_align_left"><span id="A4.T4.70.70.2.1" class="ltx_text ltx_font_bold">0.90 <math id="A4.T4.70.70.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.70.70.2.1.m1.1a"><mo id="A4.T4.70.70.2.1.m1.1.1" xref="A4.T4.70.70.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.70.70.2.1.m1.1b"><csymbol cd="latexml" id="A4.T4.70.70.2.1.m1.1.1.cmml" xref="A4.T4.70.70.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.70.70.2.1.m1.1c">\pm</annotation></semantics></math> 0.22</span></td>
<td id="A4.T4.71.71.3" class="ltx_td ltx_align_left"><span id="A4.T4.71.71.3.1" class="ltx_text ltx_font_bold">0.72 <math id="A4.T4.71.71.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.71.71.3.1.m1.1a"><mo id="A4.T4.71.71.3.1.m1.1.1" xref="A4.T4.71.71.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.71.71.3.1.m1.1b"><csymbol cd="latexml" id="A4.T4.71.71.3.1.m1.1.1.cmml" xref="A4.T4.71.71.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.71.71.3.1.m1.1c">\pm</annotation></semantics></math> 0.19</span></td>
<td id="A4.T4.72.72.4" class="ltx_td ltx_align_left">0.67 <math id="A4.T4.72.72.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T4.72.72.4.m1.1a"><mo id="A4.T4.72.72.4.m1.1.1" xref="A4.T4.72.72.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.72.72.4.m1.1b"><csymbol cd="latexml" id="A4.T4.72.72.4.m1.1.1.cmml" xref="A4.T4.72.72.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.72.72.4.m1.1c">\pm</annotation></semantics></math> 0.19</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="A4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.2 </span>Speaker Preference</h3>

<div id="A4.SS2.p1" class="ltx_para">
<p id="A4.SS2.p1.1" class="ltx_p">The mean and standard deviation F1-score per federated learning approach (with and without Gaussian privacy) broken down by the prevalence of a user preference type in the dataset are presented in Table <a href="#A4.T5" title="Table 5 ‣ D.2 Speaker Preference ‣ Appendix D Class-wise Preference Performance on Imbalanced Data ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. For the imbalanced speaker preference data scenario, 20% of the users prefer voice 0, 8% prefer voice 5, and 4% each for the remaining 18 voices.</p>
</div>
<figure id="A4.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A4.T5.56.1.1" class="ltx_text" style="font-size:90%;">Table 5</span>: </span><span id="A4.T5.57.2" class="ltx_text" style="font-size:90%;">Mean F1 scores over five independent trails for imbalanced Speaker preference data (bold indicates best)</span></figcaption>
<table id="A4.T5.54" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A4.T5.54.55.1" class="ltx_tr">
<th id="A4.T5.54.55.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">Method</th>
<td id="A4.T5.54.55.1.2" class="ltx_td ltx_align_center ltx_border_t" colspan="3">No Privacy</td>
</tr>
<tr id="A4.T5.54.56.2" class="ltx_tr">
<th id="A4.T5.54.56.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">Sub-population representation</th>
<td id="A4.T5.54.56.2.2" class="ltx_td ltx_align_center ltx_border_t">20%</td>
<td id="A4.T5.54.56.2.3" class="ltx_td ltx_align_center ltx_border_t">8%</td>
<td id="A4.T5.54.56.2.4" class="ltx_td ltx_align_center ltx_border_t">4%</td>
</tr>
<tr id="A4.T5.3.3" class="ltx_tr">
<th id="A4.T5.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt">PFedMe</th>
<td id="A4.T5.1.1.1" class="ltx_td ltx_align_left ltx_border_tt">0.66 <math id="A4.T5.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.1.1.1.m1.1a"><mo id="A4.T5.1.1.1.m1.1.1" xref="A4.T5.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.1.1.1.m1.1b"><csymbol cd="latexml" id="A4.T5.1.1.1.m1.1.1.cmml" xref="A4.T5.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.1.1.1.m1.1c">\pm</annotation></semantics></math> 0.11</td>
<td id="A4.T5.2.2.2" class="ltx_td ltx_align_left ltx_border_tt">0.62 <math id="A4.T5.2.2.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.2.2.2.m1.1a"><mo id="A4.T5.2.2.2.m1.1.1" xref="A4.T5.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.2.2.2.m1.1b"><csymbol cd="latexml" id="A4.T5.2.2.2.m1.1.1.cmml" xref="A4.T5.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.2.2.2.m1.1c">\pm</annotation></semantics></math> 0.10</td>
<td id="A4.T5.3.3.3" class="ltx_td ltx_align_left ltx_border_tt">0.54 <math id="A4.T5.3.3.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.3.3.3.m1.1a"><mo id="A4.T5.3.3.3.m1.1.1" xref="A4.T5.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.3.3.3.m1.1b"><csymbol cd="latexml" id="A4.T5.3.3.3.m1.1.1.cmml" xref="A4.T5.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.3.3.3.m1.1c">\pm</annotation></semantics></math> 0.06</td>
</tr>
<tr id="A4.T5.6.6" class="ltx_tr">
<th id="A4.T5.6.6.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">PFedKM</th>
<td id="A4.T5.4.4.1" class="ltx_td ltx_align_left">0.49 <math id="A4.T5.4.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.4.4.1.m1.1a"><mo id="A4.T5.4.4.1.m1.1.1" xref="A4.T5.4.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.4.4.1.m1.1b"><csymbol cd="latexml" id="A4.T5.4.4.1.m1.1.1.cmml" xref="A4.T5.4.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.4.4.1.m1.1c">\pm</annotation></semantics></math> 0.01</td>
<td id="A4.T5.5.5.2" class="ltx_td ltx_align_left">0.49 <math id="A4.T5.5.5.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.5.5.2.m1.1a"><mo id="A4.T5.5.5.2.m1.1.1" xref="A4.T5.5.5.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.5.5.2.m1.1b"><csymbol cd="latexml" id="A4.T5.5.5.2.m1.1.1.cmml" xref="A4.T5.5.5.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.5.5.2.m1.1c">\pm</annotation></semantics></math> 0.02</td>
<td id="A4.T5.6.6.3" class="ltx_td ltx_align_left">0.48 <math id="A4.T5.6.6.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.6.6.3.m1.1a"><mo id="A4.T5.6.6.3.m1.1.1" xref="A4.T5.6.6.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.6.6.3.m1.1b"><csymbol cd="latexml" id="A4.T5.6.6.3.m1.1.1.cmml" xref="A4.T5.6.6.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.6.6.3.m1.1c">\pm</annotation></semantics></math> 0.02</td>
</tr>
<tr id="A4.T5.9.9" class="ltx_tr">
<th id="A4.T5.9.9.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">FedRep</th>
<td id="A4.T5.7.7.1" class="ltx_td ltx_align_left">0.65 <math id="A4.T5.7.7.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.7.7.1.m1.1a"><mo id="A4.T5.7.7.1.m1.1.1" xref="A4.T5.7.7.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.7.7.1.m1.1b"><csymbol cd="latexml" id="A4.T5.7.7.1.m1.1.1.cmml" xref="A4.T5.7.7.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.7.7.1.m1.1c">\pm</annotation></semantics></math> 0.15</td>
<td id="A4.T5.8.8.2" class="ltx_td ltx_align_left">0.52 <math id="A4.T5.8.8.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.8.8.2.m1.1a"><mo id="A4.T5.8.8.2.m1.1.1" xref="A4.T5.8.8.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.8.8.2.m1.1b"><csymbol cd="latexml" id="A4.T5.8.8.2.m1.1.1.cmml" xref="A4.T5.8.8.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.8.8.2.m1.1c">\pm</annotation></semantics></math> 0.08</td>
<td id="A4.T5.9.9.3" class="ltx_td ltx_align_left">0.55 <math id="A4.T5.9.9.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.9.9.3.m1.1a"><mo id="A4.T5.9.9.3.m1.1.1" xref="A4.T5.9.9.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.9.9.3.m1.1b"><csymbol cd="latexml" id="A4.T5.9.9.3.m1.1.1.cmml" xref="A4.T5.9.9.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.9.9.3.m1.1c">\pm</annotation></semantics></math> 0.09</td>
</tr>
<tr id="A4.T5.12.12" class="ltx_tr">
<th id="A4.T5.12.12.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Global</th>
<td id="A4.T5.10.10.1" class="ltx_td ltx_align_left">0.57 <math id="A4.T5.10.10.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.10.10.1.m1.1a"><mo id="A4.T5.10.10.1.m1.1.1" xref="A4.T5.10.10.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.10.10.1.m1.1b"><csymbol cd="latexml" id="A4.T5.10.10.1.m1.1.1.cmml" xref="A4.T5.10.10.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.10.10.1.m1.1c">\pm</annotation></semantics></math> 0.24</td>
<td id="A4.T5.11.11.2" class="ltx_td ltx_align_left">0.49 <math id="A4.T5.11.11.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.11.11.2.m1.1a"><mo id="A4.T5.11.11.2.m1.1.1" xref="A4.T5.11.11.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.11.11.2.m1.1b"><csymbol cd="latexml" id="A4.T5.11.11.2.m1.1.1.cmml" xref="A4.T5.11.11.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.11.11.2.m1.1c">\pm</annotation></semantics></math> 0.16</td>
<td id="A4.T5.12.12.3" class="ltx_td ltx_align_left">0.38 <math id="A4.T5.12.12.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.12.12.3.m1.1a"><mo id="A4.T5.12.12.3.m1.1.1" xref="A4.T5.12.12.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.12.12.3.m1.1b"><csymbol cd="latexml" id="A4.T5.12.12.3.m1.1.1.cmml" xref="A4.T5.12.12.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.12.12.3.m1.1c">\pm</annotation></semantics></math> 0.11</td>
</tr>
<tr id="A4.T5.15.15" class="ltx_tr">
<th id="A4.T5.15.15.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Global+</th>
<td id="A4.T5.13.13.1" class="ltx_td ltx_align_left">0.51 <math id="A4.T5.13.13.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.13.13.1.m1.1a"><mo id="A4.T5.13.13.1.m1.1.1" xref="A4.T5.13.13.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.13.13.1.m1.1b"><csymbol cd="latexml" id="A4.T5.13.13.1.m1.1.1.cmml" xref="A4.T5.13.13.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.13.13.1.m1.1c">\pm</annotation></semantics></math> 0.22</td>
<td id="A4.T5.14.14.2" class="ltx_td ltx_align_left">0.53 <math id="A4.T5.14.14.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.14.14.2.m1.1a"><mo id="A4.T5.14.14.2.m1.1.1" xref="A4.T5.14.14.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.14.14.2.m1.1b"><csymbol cd="latexml" id="A4.T5.14.14.2.m1.1.1.cmml" xref="A4.T5.14.14.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.14.14.2.m1.1c">\pm</annotation></semantics></math> 0.20</td>
<td id="A4.T5.15.15.3" class="ltx_td ltx_align_left">0.38 <math id="A4.T5.15.15.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.15.15.3.m1.1a"><mo id="A4.T5.15.15.3.m1.1.1" xref="A4.T5.15.15.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.15.15.3.m1.1b"><csymbol cd="latexml" id="A4.T5.15.15.3.m1.1.1.cmml" xref="A4.T5.15.15.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.15.15.3.m1.1c">\pm</annotation></semantics></math> 0.12</td>
</tr>
<tr id="A4.T5.18.18" class="ltx_tr">
<th id="A4.T5.18.18.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">FedEmbed-Personal</th>
<td id="A4.T5.16.16.1" class="ltx_td ltx_align_left">0.78 <math id="A4.T5.16.16.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.16.16.1.m1.1a"><mo id="A4.T5.16.16.1.m1.1.1" xref="A4.T5.16.16.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.16.16.1.m1.1b"><csymbol cd="latexml" id="A4.T5.16.16.1.m1.1.1.cmml" xref="A4.T5.16.16.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.16.16.1.m1.1c">\pm</annotation></semantics></math> 0.01</td>
<td id="A4.T5.17.17.2" class="ltx_td ltx_align_left">0.68 <math id="A4.T5.17.17.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.17.17.2.m1.1a"><mo id="A4.T5.17.17.2.m1.1.1" xref="A4.T5.17.17.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.17.17.2.m1.1b"><csymbol cd="latexml" id="A4.T5.17.17.2.m1.1.1.cmml" xref="A4.T5.17.17.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.17.17.2.m1.1c">\pm</annotation></semantics></math> 0.08</td>
<td id="A4.T5.18.18.3" class="ltx_td ltx_align_left">0.65 <math id="A4.T5.18.18.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.18.18.3.m1.1a"><mo id="A4.T5.18.18.3.m1.1.1" xref="A4.T5.18.18.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.18.18.3.m1.1b"><csymbol cd="latexml" id="A4.T5.18.18.3.m1.1.1.cmml" xref="A4.T5.18.18.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.18.18.3.m1.1c">\pm</annotation></semantics></math> 0.07</td>
</tr>
<tr id="A4.T5.21.21" class="ltx_tr">
<th id="A4.T5.21.21.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">FedEmbed-SOM</th>
<td id="A4.T5.19.19.1" class="ltx_td ltx_align_left">0.65 <math id="A4.T5.19.19.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.19.19.1.m1.1a"><mo id="A4.T5.19.19.1.m1.1.1" xref="A4.T5.19.19.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.19.19.1.m1.1b"><csymbol cd="latexml" id="A4.T5.19.19.1.m1.1.1.cmml" xref="A4.T5.19.19.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.19.19.1.m1.1c">\pm</annotation></semantics></math> 0.13</td>
<td id="A4.T5.20.20.2" class="ltx_td ltx_align_left">0.60 <math id="A4.T5.20.20.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.20.20.2.m1.1a"><mo id="A4.T5.20.20.2.m1.1.1" xref="A4.T5.20.20.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.20.20.2.m1.1b"><csymbol cd="latexml" id="A4.T5.20.20.2.m1.1.1.cmml" xref="A4.T5.20.20.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.20.20.2.m1.1c">\pm</annotation></semantics></math> 0.09</td>
<td id="A4.T5.21.21.3" class="ltx_td ltx_align_left">0.50 <math id="A4.T5.21.21.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.21.21.3.m1.1a"><mo id="A4.T5.21.21.3.m1.1.1" xref="A4.T5.21.21.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.21.21.3.m1.1b"><csymbol cd="latexml" id="A4.T5.21.21.3.m1.1.1.cmml" xref="A4.T5.21.21.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.21.21.3.m1.1c">\pm</annotation></semantics></math> 0.08</td>
</tr>
<tr id="A4.T5.24.24" class="ltx_tr">
<th id="A4.T5.24.24.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="A4.T5.24.24.4.1" class="ltx_text ltx_font_bold">FedEmbed-Prototype</span></th>
<td id="A4.T5.22.22.1" class="ltx_td ltx_align_left"><span id="A4.T5.22.22.1.1" class="ltx_text ltx_font_bold">0.79 <math id="A4.T5.22.22.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.22.22.1.1.m1.1a"><mo id="A4.T5.22.22.1.1.m1.1.1" xref="A4.T5.22.22.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.22.22.1.1.m1.1b"><csymbol cd="latexml" id="A4.T5.22.22.1.1.m1.1.1.cmml" xref="A4.T5.22.22.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.22.22.1.1.m1.1c">\pm</annotation></semantics></math> 0.09</span></td>
<td id="A4.T5.23.23.2" class="ltx_td ltx_align_left">0.71 <math id="A4.T5.23.23.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.23.23.2.m1.1a"><mo id="A4.T5.23.23.2.m1.1.1" xref="A4.T5.23.23.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.23.23.2.m1.1b"><csymbol cd="latexml" id="A4.T5.23.23.2.m1.1.1.cmml" xref="A4.T5.23.23.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.23.23.2.m1.1c">\pm</annotation></semantics></math> 0.20</td>
<td id="A4.T5.24.24.3" class="ltx_td ltx_align_left">0.54 <math id="A4.T5.24.24.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.24.24.3.m1.1a"><mo id="A4.T5.24.24.3.m1.1.1" xref="A4.T5.24.24.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.24.24.3.m1.1b"><csymbol cd="latexml" id="A4.T5.24.24.3.m1.1.1.cmml" xref="A4.T5.24.24.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.24.24.3.m1.1c">\pm</annotation></semantics></math> 0.18</td>
</tr>
<tr id="A4.T5.27.27" class="ltx_tr">
<th id="A4.T5.27.27.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="A4.T5.27.27.4.1" class="ltx_text ltx_font_bold">FedEmbed-Type</span></th>
<td id="A4.T5.25.25.1" class="ltx_td ltx_align_left">0.73 <math id="A4.T5.25.25.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.25.25.1.m1.1a"><mo id="A4.T5.25.25.1.m1.1.1" xref="A4.T5.25.25.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.25.25.1.m1.1b"><csymbol cd="latexml" id="A4.T5.25.25.1.m1.1.1.cmml" xref="A4.T5.25.25.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.25.25.1.m1.1c">\pm</annotation></semantics></math> 0.05</td>
<td id="A4.T5.26.26.2" class="ltx_td ltx_align_left"><span id="A4.T5.26.26.2.1" class="ltx_text ltx_font_bold">0.92 <math id="A4.T5.26.26.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.26.26.2.1.m1.1a"><mo id="A4.T5.26.26.2.1.m1.1.1" xref="A4.T5.26.26.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.26.26.2.1.m1.1b"><csymbol cd="latexml" id="A4.T5.26.26.2.1.m1.1.1.cmml" xref="A4.T5.26.26.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.26.26.2.1.m1.1c">\pm</annotation></semantics></math> 0.04</span></td>
<td id="A4.T5.27.27.3" class="ltx_td ltx_align_left"><span id="A4.T5.27.27.3.1" class="ltx_text ltx_font_bold">0.73 <math id="A4.T5.27.27.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.27.27.3.1.m1.1a"><mo id="A4.T5.27.27.3.1.m1.1.1" xref="A4.T5.27.27.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.27.27.3.1.m1.1b"><csymbol cd="latexml" id="A4.T5.27.27.3.1.m1.1.1.cmml" xref="A4.T5.27.27.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.27.27.3.1.m1.1c">\pm</annotation></semantics></math> 0.13</span></td>
</tr>
<tr id="A4.T5.54.57.3" class="ltx_tr">
<th id="A4.T5.54.57.3.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="A4.T5.54.57.3.2" class="ltx_td ltx_align_center ltx_border_t" colspan="3">Gaussian Privacy</td>
</tr>
<tr id="A4.T5.30.30" class="ltx_tr">
<th id="A4.T5.30.30.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt">PFedMe</th>
<td id="A4.T5.28.28.1" class="ltx_td ltx_align_left ltx_border_tt">0.49 <math id="A4.T5.28.28.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.28.28.1.m1.1a"><mo id="A4.T5.28.28.1.m1.1.1" xref="A4.T5.28.28.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.28.28.1.m1.1b"><csymbol cd="latexml" id="A4.T5.28.28.1.m1.1.1.cmml" xref="A4.T5.28.28.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.28.28.1.m1.1c">\pm</annotation></semantics></math> 0.01</td>
<td id="A4.T5.29.29.2" class="ltx_td ltx_align_left ltx_border_tt">0.49 <math id="A4.T5.29.29.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.29.29.2.m1.1a"><mo id="A4.T5.29.29.2.m1.1.1" xref="A4.T5.29.29.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.29.29.2.m1.1b"><csymbol cd="latexml" id="A4.T5.29.29.2.m1.1.1.cmml" xref="A4.T5.29.29.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.29.29.2.m1.1c">\pm</annotation></semantics></math> 0.02</td>
<td id="A4.T5.30.30.3" class="ltx_td ltx_align_left ltx_border_tt">0.49 <math id="A4.T5.30.30.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.30.30.3.m1.1a"><mo id="A4.T5.30.30.3.m1.1.1" xref="A4.T5.30.30.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.30.30.3.m1.1b"><csymbol cd="latexml" id="A4.T5.30.30.3.m1.1.1.cmml" xref="A4.T5.30.30.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.30.30.3.m1.1c">\pm</annotation></semantics></math> 0.01</td>
</tr>
<tr id="A4.T5.33.33" class="ltx_tr">
<th id="A4.T5.33.33.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">PFedKM</th>
<td id="A4.T5.31.31.1" class="ltx_td ltx_align_left">0.50 <math id="A4.T5.31.31.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.31.31.1.m1.1a"><mo id="A4.T5.31.31.1.m1.1.1" xref="A4.T5.31.31.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.31.31.1.m1.1b"><csymbol cd="latexml" id="A4.T5.31.31.1.m1.1.1.cmml" xref="A4.T5.31.31.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.31.31.1.m1.1c">\pm</annotation></semantics></math> 0.02</td>
<td id="A4.T5.32.32.2" class="ltx_td ltx_align_left">0.50 <math id="A4.T5.32.32.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.32.32.2.m1.1a"><mo id="A4.T5.32.32.2.m1.1.1" xref="A4.T5.32.32.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.32.32.2.m1.1b"><csymbol cd="latexml" id="A4.T5.32.32.2.m1.1.1.cmml" xref="A4.T5.32.32.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.32.32.2.m1.1c">\pm</annotation></semantics></math> 0.02</td>
<td id="A4.T5.33.33.3" class="ltx_td ltx_align_left">0.48 <math id="A4.T5.33.33.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.33.33.3.m1.1a"><mo id="A4.T5.33.33.3.m1.1.1" xref="A4.T5.33.33.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.33.33.3.m1.1b"><csymbol cd="latexml" id="A4.T5.33.33.3.m1.1.1.cmml" xref="A4.T5.33.33.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.33.33.3.m1.1c">\pm</annotation></semantics></math> 0.02</td>
</tr>
<tr id="A4.T5.36.36" class="ltx_tr">
<th id="A4.T5.36.36.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">FedRep</th>
<td id="A4.T5.34.34.1" class="ltx_td ltx_align_left">0.47 <math id="A4.T5.34.34.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.34.34.1.m1.1a"><mo id="A4.T5.34.34.1.m1.1.1" xref="A4.T5.34.34.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.34.34.1.m1.1b"><csymbol cd="latexml" id="A4.T5.34.34.1.m1.1.1.cmml" xref="A4.T5.34.34.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.34.34.1.m1.1c">\pm</annotation></semantics></math> 0.03</td>
<td id="A4.T5.35.35.2" class="ltx_td ltx_align_left">0.50 <math id="A4.T5.35.35.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.35.35.2.m1.1a"><mo id="A4.T5.35.35.2.m1.1.1" xref="A4.T5.35.35.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.35.35.2.m1.1b"><csymbol cd="latexml" id="A4.T5.35.35.2.m1.1.1.cmml" xref="A4.T5.35.35.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.35.35.2.m1.1c">\pm</annotation></semantics></math> 0.01</td>
<td id="A4.T5.36.36.3" class="ltx_td ltx_align_left">0.49 <math id="A4.T5.36.36.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.36.36.3.m1.1a"><mo id="A4.T5.36.36.3.m1.1.1" xref="A4.T5.36.36.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.36.36.3.m1.1b"><csymbol cd="latexml" id="A4.T5.36.36.3.m1.1.1.cmml" xref="A4.T5.36.36.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.36.36.3.m1.1c">\pm</annotation></semantics></math> 0.01</td>
</tr>
<tr id="A4.T5.39.39" class="ltx_tr">
<th id="A4.T5.39.39.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Global</th>
<td id="A4.T5.37.37.1" class="ltx_td ltx_align_left">0.34 <math id="A4.T5.37.37.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.37.37.1.m1.1a"><mo id="A4.T5.37.37.1.m1.1.1" xref="A4.T5.37.37.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.37.37.1.m1.1b"><csymbol cd="latexml" id="A4.T5.37.37.1.m1.1.1.cmml" xref="A4.T5.37.37.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.37.37.1.m1.1c">\pm</annotation></semantics></math> 0.01</td>
<td id="A4.T5.38.38.2" class="ltx_td ltx_align_left">0.34 <math id="A4.T5.38.38.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.38.38.2.m1.1a"><mo id="A4.T5.38.38.2.m1.1.1" xref="A4.T5.38.38.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.38.38.2.m1.1b"><csymbol cd="latexml" id="A4.T5.38.38.2.m1.1.1.cmml" xref="A4.T5.38.38.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.38.38.2.m1.1c">\pm</annotation></semantics></math> 0.01</td>
<td id="A4.T5.39.39.3" class="ltx_td ltx_align_left">0.35 <math id="A4.T5.39.39.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.39.39.3.m1.1a"><mo id="A4.T5.39.39.3.m1.1.1" xref="A4.T5.39.39.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.39.39.3.m1.1b"><csymbol cd="latexml" id="A4.T5.39.39.3.m1.1.1.cmml" xref="A4.T5.39.39.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.39.39.3.m1.1c">\pm</annotation></semantics></math> 0.03</td>
</tr>
<tr id="A4.T5.42.42" class="ltx_tr">
<th id="A4.T5.42.42.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Global+</th>
<td id="A4.T5.40.40.1" class="ltx_td ltx_align_left">0.33 <math id="A4.T5.40.40.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.40.40.1.m1.1a"><mo id="A4.T5.40.40.1.m1.1.1" xref="A4.T5.40.40.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.40.40.1.m1.1b"><csymbol cd="latexml" id="A4.T5.40.40.1.m1.1.1.cmml" xref="A4.T5.40.40.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.40.40.1.m1.1c">\pm</annotation></semantics></math> 0.00</td>
<td id="A4.T5.41.41.2" class="ltx_td ltx_align_left">0.33 <math id="A4.T5.41.41.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.41.41.2.m1.1a"><mo id="A4.T5.41.41.2.m1.1.1" xref="A4.T5.41.41.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.41.41.2.m1.1b"><csymbol cd="latexml" id="A4.T5.41.41.2.m1.1.1.cmml" xref="A4.T5.41.41.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.41.41.2.m1.1c">\pm</annotation></semantics></math> 0.00</td>
<td id="A4.T5.42.42.3" class="ltx_td ltx_align_left">0.33 <math id="A4.T5.42.42.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.42.42.3.m1.1a"><mo id="A4.T5.42.42.3.m1.1.1" xref="A4.T5.42.42.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.42.42.3.m1.1b"><csymbol cd="latexml" id="A4.T5.42.42.3.m1.1.1.cmml" xref="A4.T5.42.42.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.42.42.3.m1.1c">\pm</annotation></semantics></math> 0.00</td>
</tr>
<tr id="A4.T5.45.45" class="ltx_tr">
<th id="A4.T5.45.45.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">FedEmbed-Personal</th>
<td id="A4.T5.43.43.1" class="ltx_td ltx_align_left">0.49 <math id="A4.T5.43.43.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.43.43.1.m1.1a"><mo id="A4.T5.43.43.1.m1.1.1" xref="A4.T5.43.43.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.43.43.1.m1.1b"><csymbol cd="latexml" id="A4.T5.43.43.1.m1.1.1.cmml" xref="A4.T5.43.43.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.43.43.1.m1.1c">\pm</annotation></semantics></math> 0.01</td>
<td id="A4.T5.44.44.2" class="ltx_td ltx_align_left">0.50 <math id="A4.T5.44.44.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.44.44.2.m1.1a"><mo id="A4.T5.44.44.2.m1.1.1" xref="A4.T5.44.44.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.44.44.2.m1.1b"><csymbol cd="latexml" id="A4.T5.44.44.2.m1.1.1.cmml" xref="A4.T5.44.44.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.44.44.2.m1.1c">\pm</annotation></semantics></math> 0.02</td>
<td id="A4.T5.45.45.3" class="ltx_td ltx_align_left">0.49 <math id="A4.T5.45.45.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.45.45.3.m1.1a"><mo id="A4.T5.45.45.3.m1.1.1" xref="A4.T5.45.45.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.45.45.3.m1.1b"><csymbol cd="latexml" id="A4.T5.45.45.3.m1.1.1.cmml" xref="A4.T5.45.45.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.45.45.3.m1.1c">\pm</annotation></semantics></math> 0.01</td>
</tr>
<tr id="A4.T5.48.48" class="ltx_tr">
<th id="A4.T5.48.48.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">FedEmbed-SOM</th>
<td id="A4.T5.46.46.1" class="ltx_td ltx_align_left">0.50 <math id="A4.T5.46.46.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.46.46.1.m1.1a"><mo id="A4.T5.46.46.1.m1.1.1" xref="A4.T5.46.46.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.46.46.1.m1.1b"><csymbol cd="latexml" id="A4.T5.46.46.1.m1.1.1.cmml" xref="A4.T5.46.46.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.46.46.1.m1.1c">\pm</annotation></semantics></math> 0.07</td>
<td id="A4.T5.47.47.2" class="ltx_td ltx_align_left">0.49 <math id="A4.T5.47.47.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.47.47.2.m1.1a"><mo id="A4.T5.47.47.2.m1.1.1" xref="A4.T5.47.47.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.47.47.2.m1.1b"><csymbol cd="latexml" id="A4.T5.47.47.2.m1.1.1.cmml" xref="A4.T5.47.47.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.47.47.2.m1.1c">\pm</annotation></semantics></math> 0.05</td>
<td id="A4.T5.48.48.3" class="ltx_td ltx_align_left">0.45 <math id="A4.T5.48.48.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.48.48.3.m1.1a"><mo id="A4.T5.48.48.3.m1.1.1" xref="A4.T5.48.48.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.48.48.3.m1.1b"><csymbol cd="latexml" id="A4.T5.48.48.3.m1.1.1.cmml" xref="A4.T5.48.48.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.48.48.3.m1.1c">\pm</annotation></semantics></math> 0.05</td>
</tr>
<tr id="A4.T5.51.51" class="ltx_tr">
<th id="A4.T5.51.51.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="A4.T5.51.51.4.1" class="ltx_text ltx_font_bold">FedEmbed-Prototype</span></th>
<td id="A4.T5.49.49.1" class="ltx_td ltx_align_left">0.52 <math id="A4.T5.49.49.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.49.49.1.m1.1a"><mo id="A4.T5.49.49.1.m1.1.1" xref="A4.T5.49.49.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.49.49.1.m1.1b"><csymbol cd="latexml" id="A4.T5.49.49.1.m1.1.1.cmml" xref="A4.T5.49.49.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.49.49.1.m1.1c">\pm</annotation></semantics></math> 0.21</td>
<td id="A4.T5.50.50.2" class="ltx_td ltx_align_left">0.55 <math id="A4.T5.50.50.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.50.50.2.m1.1a"><mo id="A4.T5.50.50.2.m1.1.1" xref="A4.T5.50.50.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.50.50.2.m1.1b"><csymbol cd="latexml" id="A4.T5.50.50.2.m1.1.1.cmml" xref="A4.T5.50.50.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.50.50.2.m1.1c">\pm</annotation></semantics></math> 0.27</td>
<td id="A4.T5.51.51.3" class="ltx_td ltx_align_left"><span id="A4.T5.51.51.3.1" class="ltx_text ltx_font_bold">0.48 <math id="A4.T5.51.51.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.51.51.3.1.m1.1a"><mo id="A4.T5.51.51.3.1.m1.1.1" xref="A4.T5.51.51.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.51.51.3.1.m1.1b"><csymbol cd="latexml" id="A4.T5.51.51.3.1.m1.1.1.cmml" xref="A4.T5.51.51.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.51.51.3.1.m1.1c">\pm</annotation></semantics></math> 0.13</span></td>
</tr>
<tr id="A4.T5.54.54" class="ltx_tr">
<th id="A4.T5.54.54.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="A4.T5.54.54.4.1" class="ltx_text ltx_font_bold">FedEmbed-Type</span></th>
<td id="A4.T5.52.52.1" class="ltx_td ltx_align_left"><span id="A4.T5.52.52.1.1" class="ltx_text ltx_font_bold">0.54 <math id="A4.T5.52.52.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.52.52.1.1.m1.1a"><mo id="A4.T5.52.52.1.1.m1.1.1" xref="A4.T5.52.52.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.52.52.1.1.m1.1b"><csymbol cd="latexml" id="A4.T5.52.52.1.1.m1.1.1.cmml" xref="A4.T5.52.52.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.52.52.1.1.m1.1c">\pm</annotation></semantics></math> 0.20</span></td>
<td id="A4.T5.53.53.2" class="ltx_td ltx_align_left"><span id="A4.T5.53.53.2.1" class="ltx_text ltx_font_bold">0.60 <math id="A4.T5.53.53.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.53.53.2.1.m1.1a"><mo id="A4.T5.53.53.2.1.m1.1.1" xref="A4.T5.53.53.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.53.53.2.1.m1.1b"><csymbol cd="latexml" id="A4.T5.53.53.2.1.m1.1.1.cmml" xref="A4.T5.53.53.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.53.53.2.1.m1.1c">\pm</annotation></semantics></math> 0.14</span></td>
<td id="A4.T5.54.54.3" class="ltx_td ltx_align_left"><span id="A4.T5.54.54.3.1" class="ltx_text ltx_font_bold">0.48 <math id="A4.T5.54.54.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A4.T5.54.54.3.1.m1.1a"><mo id="A4.T5.54.54.3.1.m1.1.1" xref="A4.T5.54.54.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.54.54.3.1.m1.1b"><csymbol cd="latexml" id="A4.T5.54.54.3.1.m1.1.1.cmml" xref="A4.T5.54.54.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.54.54.3.1.m1.1c">\pm</annotation></semantics></math> 0.18</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Speaker Preference Clustering Results</h2>

<figure id="A5.F5" class="ltx_figure"><img src="/html/2202.09472/assets/fig/speaker_confusion.png" id="A5.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="157" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A5.F5.3.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="A5.F5.4.2" class="ltx_text" style="font-size:90%;">Confusion matrices for ground-truth user preferences and predicted user-preferences using personal embeddings derived from our balanced speaker preference dataset. <span id="A5.F5.4.2.1" class="ltx_text ltx_font_italic">FedEmbed-Prototype</span> perfectly recovers user preferences, but other approaches suffer from significant confusion on this more challenging dataset.</span></figcaption>
</figure>
<div id="A5.p1" class="ltx_para">
<p id="A5.p1.1" class="ltx_p">To better understand personalization performance on our more challenging speaker-preference dataset, we present preference-assignment confusion matrices in Figure <a href="#A5.F5" title="Figure 5 ‣ Appendix E Speaker Preference Clustering Results ‣ FedEmbed: Personalized Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. From these confusion matrices, we observe that the FedEmbed-Prototype approach is able to accurately separate client preferences in this domain. Other approaches instead exhibit significant error, often recovering only a handful of preferences and showing significant confusion across the board.</p>
</div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2202.09471" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2202.09472" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2202.09472">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2202.09472" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2202.09473" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Mar  7 19:54:07 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
