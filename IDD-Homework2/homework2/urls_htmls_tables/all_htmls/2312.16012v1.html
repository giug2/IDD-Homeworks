<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2312.16012] Detection-based Intermediate Supervision for Visual Question Answering</title><meta property="og:description" content="Recently, neural module networks (NMNs) have yielded ongoing success in answering compositional visual questions, especially those involving multi-hop visual and logical reasoning. NMNs decompose the complex question i…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Detection-based Intermediate Supervision for Visual Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Detection-based Intermediate Supervision for Visual Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2312.16012">

<!--Generated on Tue Feb 27 12:17:24 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Detection-based Intermediate Supervision for Visual Question Answering</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Yuhang Liu<span id="id1.1.id1" class="ltx_ERROR undefined">\equalcontrib</span><sup id="id2.2.id2" class="ltx_sup">1,2,4</sup>,
Daowan Peng<span id="id3.3.id3" class="ltx_ERROR undefined">\equalcontrib</span><sup id="id4.4.id4" class="ltx_sup">1,2</sup>,
Wei Wei<sup id="id5.5.id5" class="ltx_sup">1,2</sup>,
Yuanyuan Fu<sup id="id6.6.id6" class="ltx_sup">2,3</sup>,
Wenfeng Xie<sup id="id7.7.id7" class="ltx_sup">2,3</sup>,
Dangyang Chen<sup id="id8.8.id8" class="ltx_sup">2,3</sup>
</span><span class="ltx_author_notes">Corresponding author.</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id9.id1" class="ltx_p">Recently, neural module networks (NMNs) have yielded ongoing success in answering compositional visual questions, especially those involving multi-hop visual and logical reasoning. NMNs decompose the complex question into several sub-tasks using instance-modules from the reasoning paths of that question and then exploit intermediate supervisions to guide answer prediction, thereby improving inference interpretability.
However, their performance may be hindered due to sketchy modeling of intermediate supervisions. For instance, (1) a prior assumption that each instance-module refers to only one grounded object yet overlooks other potentially associated grounded objects, impeding full cross-modal alignment learning; (2) IoU-based intermediate supervisions may introduce noise signals as the bounding box overlap issue might guide the model’s focus towards irrelevant objects.
To address these issues, a novel method, <span id="id9.id1.1" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">D</span>etection-based <span id="id9.id1.2" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">I</span>ntermediate <span id="id9.id1.3" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">S</span>upervision (DIS), is proposed, which adopts a generative detection framework to facilitate multiple grounding supervisions via sequence generation. As such, DIS offers more comprehensive and accurate intermediate supervisions, thereby boosting answer prediction performance. Furthermore, by considering intermediate results, DIS enhances the consistency in answering compositional questions and their sub-questions.
Extensive experiments demonstrate the superiority of our proposed DIS, showcasing both improved accuracy and state-of-the-art reasoning consistency compared to prior approaches.</p>
</div>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Introduction</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">Compositional visual question answering (VQA) <cite class="ltx_cite ltx_citemacro_citep">(Hudson and Manning <a href="#bib.bib16" title="" class="ltx_ref">2019b</a>; Chen et al. <a href="#bib.bib8" title="" class="ltx_ref">2021</a>; Jing et al. <a href="#bib.bib19" title="" class="ltx_ref">2022b</a>)</cite> has been an emerging research topic in multimodal domain, and received increasing attention from both computer vision and the language processing communities. Specifically, given input images and questions, it is required to generate answers for the questions according the content of images. Generally, compositional questions involve multiple visual entities or concepts (<em id="Sx1.p1.1.1" class="ltx_emph ltx_font_italic">i.e.,</em> objects, attributes, and relations), and the models demand a rich set of abilities (semantic understanding, object detections, visual/logical reasoning) to get the right answer.
One of the challenges in compositional visual question answering lies in modeling the reasoning process. From this perspective, VQA models can be divided into two categories, <em id="Sx1.p1.1.2" class="ltx_emph ltx_font_italic">i.e.,</em> holistic and modular. Holistic models <cite class="ltx_cite ltx_citemacro_citep">(Hu et al. <a href="#bib.bib13" title="" class="ltx_ref">2019</a>; Yu et al. <a href="#bib.bib32" title="" class="ltx_ref">2019</a>; Yang et al. <a href="#bib.bib31" title="" class="ltx_ref">2020</a>)</cite> generate answers for all types of questions through a unified multimodal fusion model, and the reasoning process is implicitly performed during the encoding and fusion stages. Despite the effectiveness, holistic models cannot reflect the intermediate reasoning process. On the contrary, modular model, <em id="Sx1.p1.1.3" class="ltx_emph ltx_font_italic">i.e.,</em> neural module network (NMN) <cite class="ltx_cite ltx_citemacro_citep">(Andreas et al. <a href="#bib.bib3" title="" class="ltx_ref">2016</a>; Hu et al. <a href="#bib.bib12" title="" class="ltx_ref">2018</a>; Hudson and Manning <a href="#bib.bib15" title="" class="ltx_ref">2018</a>; Chen et al. <a href="#bib.bib8" title="" class="ltx_ref">2021</a>)</cite>, has been a mainstream approach due to its explicit reasoning procedure and interpretable characteristics. Specifically, NMN parses questions into predefined reasoning modules and composes these modules into an executive program, thus deconstructing complex questions into several easy-to-solve problems. During the process of multi-hop visual/logical reasoning and answering generation, the intermediate status and results can be explicitly reflected from each module. Moreover, in order to restrict the reasoning process of NMN models, extra intermediate supervisions <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib8" title="" class="ltx_ref">2021</a>; Zhao et al. <a href="#bib.bib33" title="" class="ltx_ref">2021</a>)</cite> are proposed to improve the answer prediction performance, which restricts models to focus on pivotal objects via Intersection over Union (IoU) constraint between predicted bounding boxes and ground truth ones.</p>
</div>
<div id="Sx1.p2" class="ltx_para">
<p id="Sx1.p2.1" class="ltx_p">Despite the significant improvement in the accuracy metric, there are several shortcomings in the IoU-based intermediate supervisions of previous methods. For example, MMN <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib8" title="" class="ltx_ref">2021</a>)</cite> directly exploits the ground-truth scene graph paths corresponding to questions for intermediate result generation, which ignores other potentially correct intermediate objects and hinders the model to fully learn cross-modal alignment and reasoning process. As Figure <a href="#Sx1.F1" title="Figure 1 ‣ Introduction ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> (a) shows, MMN adopts the leftmost <em id="Sx1.p2.1.1" class="ltx_emph ltx_font_italic">pillow</em> to supervise the first step result (<em id="Sx1.p2.1.2" class="ltx_emph ltx_font_italic">i.e.,</em> <em id="Sx1.p2.1.3" class="ltx_emph ltx_font_italic">Select(pillow)</em>), while our proposed DIS method takes into account all possible correct results. Such comprehensive supervisions alleviate the missing-in-the-middle problem, thus facilitating the model to generate correct answers. Besides, previous IoU-based intermediate supervisions are possible to introduce noise signals due to the bounding-box overlap problem, which induces the model to focus on irrelevant objects. This is exemplified in Figure <a href="#Sx1.F1" title="Figure 1 ‣ Introduction ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> (b). In the first reasoning step, the model is required to focus on the <em id="Sx1.p2.1.4" class="ltx_emph ltx_font_italic">napkin</em> (<em id="Sx1.p2.1.5" class="ltx_emph ltx_font_italic">i.e.,</em> probability distribution corresponding to the green lines). However, due to the overlap between <em id="Sx1.p2.1.6" class="ltx_emph ltx_font_italic">napkin</em> and other objects (<em id="Sx1.p2.1.7" class="ltx_emph ltx_font_italic">e.g.,</em> <em id="Sx1.p2.1.8" class="ltx_emph ltx_font_italic">table</em>, <em id="Sx1.p2.1.9" class="ltx_emph ltx_font_italic">laptop</em>, <em id="Sx1.p2.1.10" class="ltx_emph ltx_font_italic">cup</em>, <em id="Sx1.p2.1.11" class="ltx_emph ltx_font_italic">etc.</em>), the IoU-based supervisions prompt the model to focus on irrelevant areas (<em id="Sx1.p2.1.12" class="ltx_emph ltx_font_italic">i.e.,</em> probability distribution corresponding to the red lines), thus leading to grounding ambiguity and generating wrong answers.</p>
</div>
<figure id="Sx1.F1" class="ltx_figure"><img src="/html/2312.16012/assets/x1.png" id="Sx1.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="461" height="466" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Illustrations of the differences in intermediate supervisions between MMN and DIS: (a) Number of grounded objects, and (b) IoU-based and detection-based supervisions (green and red lines indicate the ground-truth and IoU-based probability distributions over objects).</figcaption>
</figure>
<div id="Sx1.p3" class="ltx_para">
<p id="Sx1.p3.1" class="ltx_p">To this end, we propose a novel Detection-based Intermediate Supervision (DIS) method to resolve aforementioned issues. Specifically, to obtain comprehensive intermediate results, executive programs are parsed from the questions, and then step-by-step inference is performed on the scene graphs, which generates complete intermediate results (illustrated in Figure <a href="#Sx1.F1" title="Figure 1 ‣ Introduction ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> (a)). Afterwards, a generative framework is proposed to supervise VQA model using the intermediate results, which transforms the intermediate supervisions into sequences, and constrains model states via sequence generation (illustrated in Figure <a href="#Sx1.F1" title="Figure 1 ‣ Introduction ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> (b)). Compared to previous methods, our proposed DIS provides more comprehensive supervision signals for the reasoning process, and exploits a unified generative framework to constrain the intermediate states, thereby improving the answer prediction performance. Moreover, due to the consideration of intermediate results, the answering consistency among compositional questions and their sub-questions is significantly improved.
In summary, the main contributions are the following,</p>
<ul id="Sx1.I1" class="ltx_itemize">
<li id="Sx1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx1.I1.i1.p1" class="ltx_para">
<p id="Sx1.I1.i1.p1.1" class="ltx_p">We introduce Detection-based Intermediate Supervision (DIS), a novel method that provides more comprehensive intermediate supervisions via a unified generative framework. To the best of our knowledge, this is the first attempt in the usage of a generative framework for intermediate supervisions in visual question answering.</p>
</div>
</li>
<li id="Sx1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx1.I1.i2.p1" class="ltx_para">
<p id="Sx1.I1.i2.p1.1" class="ltx_p">We propose a scene graph inference framework, which step-by-step executes programs parsed from questions on scene graphs to obtain intermediate results. The supervision signals are further constructed by converting the results into a unified sequential form.</p>
</div>
</li>
<li id="Sx1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx1.I1.i3.p1" class="ltx_para">
<p id="Sx1.I1.i3.p1.1" class="ltx_p">We conduct extensive experiments to evaluate the effectiveness of our proposed DIS algorithm, in which our method achieves competitive answer prediction performance (61.31% <em id="Sx1.I1.i3.p1.1.1" class="ltx_emph ltx_font_italic">vs.</em> 60.83%), and superior reasoning consistency (73.11% <em id="Sx1.I1.i3.p1.1.2" class="ltx_emph ltx_font_italic">vs.</em> 71.47%, 64.20% <em id="Sx1.I1.i3.p1.1.3" class="ltx_emph ltx_font_italic">vs.</em> 61.94%, and 55.28% <em id="Sx1.I1.i3.p1.1.4" class="ltx_emph ltx_font_italic">vs.</em> 52.80%) compared to previous methods.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="Sx2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Related Work</h2>

<section id="Sx2.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Visual Question Answering</h3>

<div id="Sx2.SSx1.p1" class="ltx_para">
<p id="Sx2.SSx1.p1.1" class="ltx_p">Compositional visual question answering task is defined to generate answers for given compositional questions based on the image content. Generally, compositional questions consist of multiple visual concepts (<em id="Sx2.SSx1.p1.1.1" class="ltx_emph ltx_font_italic">i.e.,</em> objects, attributes, and relations), and require VQA models to perform multi-hop reasoning to get the right answers. Recently, several attempts have been made to facilitate visual and logical reasoning, and these methods can be divided into two categories: holistic and modular. Holistic methods <cite class="ltx_cite ltx_citemacro_citep">(Anderson et al. <a href="#bib.bib2" title="" class="ltx_ref">2018</a>; Kim, Jun, and Zhang <a href="#bib.bib20" title="" class="ltx_ref">2018</a>; Tan and Bansal <a href="#bib.bib28" title="" class="ltx_ref">2019</a>; Hu et al. <a href="#bib.bib13" title="" class="ltx_ref">2019</a>; Yu et al. <a href="#bib.bib32" title="" class="ltx_ref">2019</a>; Yang et al. <a href="#bib.bib31" title="" class="ltx_ref">2020</a>)</cite> exploit a unified multimodal fusion model to solve all types of question, and achieve implicit visual/logical reasoning through graph structures <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib23" title="" class="ltx_ref">2019</a>; Hu et al. <a href="#bib.bib13" title="" class="ltx_ref">2019</a>)</cite> and relational attention mechanisms<cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib23" title="" class="ltx_ref">2019</a>; Hu et al. <a href="#bib.bib13" title="" class="ltx_ref">2019</a>; Yang et al. <a href="#bib.bib31" title="" class="ltx_ref">2020</a>)</cite>. With the help of scene graph structure, images are represented as graphical webs, containing information about objects, attributes and relationships among interconnected objects, which can be used for visual reasoning via graph traversal. For example, NSM <cite class="ltx_cite ltx_citemacro_citep">(Hudson and Manning <a href="#bib.bib14" title="" class="ltx_ref">2019a</a>)</cite> performs sequential reasoning over the probabilistic scene graph of the image, and achieves multi-hop inference by shifting probability distributions. RPR <cite class="ltx_cite ltx_citemacro_citep">(Jing et al. <a href="#bib.bib18" title="" class="ltx_ref">2022a</a>)</cite> casts visual reasoning as a path routing task, and adopts reinforcement learning to explore the inference path.</p>
</div>
<figure id="Sx2.F2" class="ltx_figure"><img src="/html/2312.16012/assets/x2.png" id="Sx2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="537" height="204" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The framework of our proposed Detection-based Intermediate Supervision (DIS) method. Questions are parsed into programs, and step-by-step program execution is performed to generate answers. The intermediate states are supervised by our DIS algorithm.</figcaption>
</figure>
<div id="Sx2.SSx1.p2" class="ltx_para">
<p id="Sx2.SSx1.p2.1" class="ltx_p">Despite the overwhelming successes achieved, holistic models process all types of questions via a unified model, which ignores the reasoning structure implicit in the question. Therefore, modular methods <cite class="ltx_cite ltx_citemacro_citep">(Andreas et al. <a href="#bib.bib3" title="" class="ltx_ref">2016</a>; Hu et al. <a href="#bib.bib12" title="" class="ltx_ref">2018</a>; Hudson and Manning <a href="#bib.bib15" title="" class="ltx_ref">2018</a>; Chen et al. <a href="#bib.bib8" title="" class="ltx_ref">2021</a>; Zhao et al. <a href="#bib.bib33" title="" class="ltx_ref">2021</a>)</cite> are proposed to make up for the above-mentioned issues. Specifically, modular methods parse the question into a structured tree that reflects the reasoning process, and construct the question-specific model using pre-defined modules. Due to the explicit reasoning structure, such methods have strong interpretability and controllability. In addition, extra intermediate supervisions can be provided to constrain models to reason along prescribed directions, <em id="Sx2.SSx1.p2.1.1" class="ltx_emph ltx_font_italic">e.g.,</em> IoU-based Kullback-Leible (KL) divergence <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib8" title="" class="ltx_ref">2021</a>; Zhao et al. <a href="#bib.bib33" title="" class="ltx_ref">2021</a>)</cite>, thereby improving answer prediction performance. However, such IoU-based supervisions suffer from two issues, <em id="Sx2.SSx1.p2.1.2" class="ltx_emph ltx_font_italic">i.e.,</em> ignorance of multiple grounded objects and grounding ambiguity, underutilizing the intermediate supervisions for model optimization.</p>
</div>
</section>
<section id="Sx2.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Object Detection</h3>

<div id="Sx2.SSx2.p1" class="ltx_para">
<p id="Sx2.SSx2.p1.1" class="ltx_p">There has been a tremendous amount of work in object detection tasks, which require extracting objects from images. Traditional object detection algorithms introduce explicit prior knowledge via producing a set of proposals <cite class="ltx_cite ltx_citemacro_citep">(Girshick <a href="#bib.bib9" title="" class="ltx_ref">2015</a>; Ren et al. <a href="#bib.bib27" title="" class="ltx_ref">2017</a>)</cite>, anchors <cite class="ltx_cite ltx_citemacro_citep">(Redmon et al. <a href="#bib.bib26" title="" class="ltx_ref">2016</a>)</cite>, or window centers <cite class="ltx_cite ltx_citemacro_citep">(Tian et al. <a href="#bib.bib29" title="" class="ltx_ref">2019</a>)</cite>, and then perform non-maximum suppression <cite class="ltx_cite ltx_citemacro_citep">(Bodla et al. <a href="#bib.bib4" title="" class="ltx_ref">2017</a>)</cite> to remove duplicate predictions. To avoid complex processing procedures, DETR <cite class="ltx_cite ltx_citemacro_citep">(Carion et al. <a href="#bib.bib6" title="" class="ltx_ref">2020</a>)</cite> exploits Transformer-based encoder-decoder framework <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al. <a href="#bib.bib30" title="" class="ltx_ref">2017</a>)</cite> for object detection, which learns a set of “object queries” to directly generate bounding boxes and object labels. All of these detectors require extra modules for bounding box regression and label prediction to obtain final predictions. To further avoid such complexities, Pix2Seq <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib7" title="" class="ltx_ref">2022</a>)</cite> directly predicts the raw pixel coordinates through an encoder-decoder network, which achieves competitive performance while simplifying the detection framework. Inspired from Pix2Seq and language modeling <cite class="ltx_cite ltx_citemacro_citep">(Brown et al. <a href="#bib.bib5" title="" class="ltx_ref">2020</a>)</cite>, we propose a detection-based supervision framework, which converts the intermediate results into a unified sequential form that consists of pixels and tokens, thereby providing more comprehensive supervision signals.</p>
</div>
</section>
</section>
<section id="Sx3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Methodology</h2>

<div id="Sx3.p1" class="ltx_para">
<p id="Sx3.p1.1" class="ltx_p">We propose Detection-based Intermediate Supervision (DIS) methods to facilitate the constraint of intermediate reasoning state, thereby improving the answer prediction performance. The overall framework is depicted in Figure <a href="#Sx2.F2" title="Figure 2 ‣ Visual Question Answering ‣ Related Work ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Specifically, image features are first extracted via convolutional neural networks (CNN). Then, the question is parsed into program tree, followed by the program execution network to get the final answer. Finally, we introduce detection-based intermediate supervision framework to enhance reasoning ability of the VQA model.</p>
</div>
<section id="Sx3.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Image Features Extraction</h3>

<div id="Sx3.SSx1.p1" class="ltx_para">
<p id="Sx3.SSx1.p1.5" class="ltx_p">Image feature extraction is based on the pre-trained Faster R-CNN model <cite class="ltx_cite ltx_citemacro_citep">(Ren et al. <a href="#bib.bib27" title="" class="ltx_ref">2017</a>; Jiang et al. <a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite>. In contrast to previous methods <cite class="ltx_cite ltx_citemacro_citep">(Anderson et al. <a href="#bib.bib2" title="" class="ltx_ref">2018</a>; Hu et al. <a href="#bib.bib13" title="" class="ltx_ref">2019</a>)</cite> that adopt bottom-up features, we adopt the feature maps output from <math id="Sx3.SSx1.p1.1.m1.1" class="ltx_Math" alttext="C5" display="inline"><semantics id="Sx3.SSx1.p1.1.m1.1a"><mrow id="Sx3.SSx1.p1.1.m1.1.1" xref="Sx3.SSx1.p1.1.m1.1.1.cmml"><mi id="Sx3.SSx1.p1.1.m1.1.1.2" xref="Sx3.SSx1.p1.1.m1.1.1.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.1.m1.1.1.1" xref="Sx3.SSx1.p1.1.m1.1.1.1.cmml">​</mo><mn id="Sx3.SSx1.p1.1.m1.1.1.3" xref="Sx3.SSx1.p1.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.1.m1.1b"><apply id="Sx3.SSx1.p1.1.m1.1.1.cmml" xref="Sx3.SSx1.p1.1.m1.1.1"><times id="Sx3.SSx1.p1.1.m1.1.1.1.cmml" xref="Sx3.SSx1.p1.1.m1.1.1.1"></times><ci id="Sx3.SSx1.p1.1.m1.1.1.2.cmml" xref="Sx3.SSx1.p1.1.m1.1.1.2">𝐶</ci><cn type="integer" id="Sx3.SSx1.p1.1.m1.1.1.3.cmml" xref="Sx3.SSx1.p1.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.1.m1.1c">C5</annotation></semantics></math> layer of Faster R-CNN <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al. <a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite> for image representation. Specifically, given an image <math id="Sx3.SSx1.p1.2.m2.1" class="ltx_Math" alttext="I" display="inline"><semantics id="Sx3.SSx1.p1.2.m2.1a"><mi id="Sx3.SSx1.p1.2.m2.1.1" xref="Sx3.SSx1.p1.2.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.2.m2.1b"><ci id="Sx3.SSx1.p1.2.m2.1.1.cmml" xref="Sx3.SSx1.p1.2.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.2.m2.1c">I</annotation></semantics></math>, the pre-trained CNN backbone of Faster R-CNN is utilized to extract the feature map <math id="Sx3.SSx1.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{V}\in\mathbb{R}^{HW\times{d_{v}}}" display="inline"><semantics id="Sx3.SSx1.p1.3.m3.1a"><mrow id="Sx3.SSx1.p1.3.m3.1.1" xref="Sx3.SSx1.p1.3.m3.1.1.cmml"><mi id="Sx3.SSx1.p1.3.m3.1.1.2" xref="Sx3.SSx1.p1.3.m3.1.1.2.cmml">𝐕</mi><mo id="Sx3.SSx1.p1.3.m3.1.1.1" xref="Sx3.SSx1.p1.3.m3.1.1.1.cmml">∈</mo><msup id="Sx3.SSx1.p1.3.m3.1.1.3" xref="Sx3.SSx1.p1.3.m3.1.1.3.cmml"><mi id="Sx3.SSx1.p1.3.m3.1.1.3.2" xref="Sx3.SSx1.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx1.p1.3.m3.1.1.3.3" xref="Sx3.SSx1.p1.3.m3.1.1.3.3.cmml"><mrow id="Sx3.SSx1.p1.3.m3.1.1.3.3.2" xref="Sx3.SSx1.p1.3.m3.1.1.3.3.2.cmml"><mi id="Sx3.SSx1.p1.3.m3.1.1.3.3.2.2" xref="Sx3.SSx1.p1.3.m3.1.1.3.3.2.2.cmml">H</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.3.m3.1.1.3.3.2.1" xref="Sx3.SSx1.p1.3.m3.1.1.3.3.2.1.cmml">​</mo><mi id="Sx3.SSx1.p1.3.m3.1.1.3.3.2.3" xref="Sx3.SSx1.p1.3.m3.1.1.3.3.2.3.cmml">W</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="Sx3.SSx1.p1.3.m3.1.1.3.3.1" xref="Sx3.SSx1.p1.3.m3.1.1.3.3.1.cmml">×</mo><msub id="Sx3.SSx1.p1.3.m3.1.1.3.3.3" xref="Sx3.SSx1.p1.3.m3.1.1.3.3.3.cmml"><mi id="Sx3.SSx1.p1.3.m3.1.1.3.3.3.2" xref="Sx3.SSx1.p1.3.m3.1.1.3.3.3.2.cmml">d</mi><mi id="Sx3.SSx1.p1.3.m3.1.1.3.3.3.3" xref="Sx3.SSx1.p1.3.m3.1.1.3.3.3.3.cmml">v</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.3.m3.1b"><apply id="Sx3.SSx1.p1.3.m3.1.1.cmml" xref="Sx3.SSx1.p1.3.m3.1.1"><in id="Sx3.SSx1.p1.3.m3.1.1.1.cmml" xref="Sx3.SSx1.p1.3.m3.1.1.1"></in><ci id="Sx3.SSx1.p1.3.m3.1.1.2.cmml" xref="Sx3.SSx1.p1.3.m3.1.1.2">𝐕</ci><apply id="Sx3.SSx1.p1.3.m3.1.1.3.cmml" xref="Sx3.SSx1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.3.m3.1.1.3.1.cmml" xref="Sx3.SSx1.p1.3.m3.1.1.3">superscript</csymbol><ci id="Sx3.SSx1.p1.3.m3.1.1.3.2.cmml" xref="Sx3.SSx1.p1.3.m3.1.1.3.2">ℝ</ci><apply id="Sx3.SSx1.p1.3.m3.1.1.3.3.cmml" xref="Sx3.SSx1.p1.3.m3.1.1.3.3"><times id="Sx3.SSx1.p1.3.m3.1.1.3.3.1.cmml" xref="Sx3.SSx1.p1.3.m3.1.1.3.3.1"></times><apply id="Sx3.SSx1.p1.3.m3.1.1.3.3.2.cmml" xref="Sx3.SSx1.p1.3.m3.1.1.3.3.2"><times id="Sx3.SSx1.p1.3.m3.1.1.3.3.2.1.cmml" xref="Sx3.SSx1.p1.3.m3.1.1.3.3.2.1"></times><ci id="Sx3.SSx1.p1.3.m3.1.1.3.3.2.2.cmml" xref="Sx3.SSx1.p1.3.m3.1.1.3.3.2.2">𝐻</ci><ci id="Sx3.SSx1.p1.3.m3.1.1.3.3.2.3.cmml" xref="Sx3.SSx1.p1.3.m3.1.1.3.3.2.3">𝑊</ci></apply><apply id="Sx3.SSx1.p1.3.m3.1.1.3.3.3.cmml" xref="Sx3.SSx1.p1.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.3.m3.1.1.3.3.3.1.cmml" xref="Sx3.SSx1.p1.3.m3.1.1.3.3.3">subscript</csymbol><ci id="Sx3.SSx1.p1.3.m3.1.1.3.3.3.2.cmml" xref="Sx3.SSx1.p1.3.m3.1.1.3.3.3.2">𝑑</ci><ci id="Sx3.SSx1.p1.3.m3.1.1.3.3.3.3.cmml" xref="Sx3.SSx1.p1.3.m3.1.1.3.3.3.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.3.m3.1c">\mathbf{V}\in\mathbb{R}^{HW\times{d_{v}}}</annotation></semantics></math>, where <math id="Sx3.SSx1.p1.4.m4.2" class="ltx_Math" alttext="H,W" display="inline"><semantics id="Sx3.SSx1.p1.4.m4.2a"><mrow id="Sx3.SSx1.p1.4.m4.2.3.2" xref="Sx3.SSx1.p1.4.m4.2.3.1.cmml"><mi id="Sx3.SSx1.p1.4.m4.1.1" xref="Sx3.SSx1.p1.4.m4.1.1.cmml">H</mi><mo id="Sx3.SSx1.p1.4.m4.2.3.2.1" xref="Sx3.SSx1.p1.4.m4.2.3.1.cmml">,</mo><mi id="Sx3.SSx1.p1.4.m4.2.2" xref="Sx3.SSx1.p1.4.m4.2.2.cmml">W</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.4.m4.2b"><list id="Sx3.SSx1.p1.4.m4.2.3.1.cmml" xref="Sx3.SSx1.p1.4.m4.2.3.2"><ci id="Sx3.SSx1.p1.4.m4.1.1.cmml" xref="Sx3.SSx1.p1.4.m4.1.1">𝐻</ci><ci id="Sx3.SSx1.p1.4.m4.2.2.cmml" xref="Sx3.SSx1.p1.4.m4.2.2">𝑊</ci></list></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.4.m4.2c">H,W</annotation></semantics></math> indicate height and width of the feature map, respectively. <math id="Sx3.SSx1.p1.5.m5.1" class="ltx_Math" alttext="d_{v}" display="inline"><semantics id="Sx3.SSx1.p1.5.m5.1a"><msub id="Sx3.SSx1.p1.5.m5.1.1" xref="Sx3.SSx1.p1.5.m5.1.1.cmml"><mi id="Sx3.SSx1.p1.5.m5.1.1.2" xref="Sx3.SSx1.p1.5.m5.1.1.2.cmml">d</mi><mi id="Sx3.SSx1.p1.5.m5.1.1.3" xref="Sx3.SSx1.p1.5.m5.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.5.m5.1b"><apply id="Sx3.SSx1.p1.5.m5.1.1.cmml" xref="Sx3.SSx1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.5.m5.1.1.1.cmml" xref="Sx3.SSx1.p1.5.m5.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.5.m5.1.1.2.cmml" xref="Sx3.SSx1.p1.5.m5.1.1.2">𝑑</ci><ci id="Sx3.SSx1.p1.5.m5.1.1.3.cmml" xref="Sx3.SSx1.p1.5.m5.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.5.m5.1c">d_{v}</annotation></semantics></math> denotes the feature dimension.</p>
</div>
<div id="Sx3.SSx1.p2" class="ltx_para">
<p id="Sx3.SSx1.p2.3" class="ltx_p">To endow the image features with visual contexts and cross-modal textual information, we follow MCAN <cite class="ltx_cite ltx_citemacro_citep">(Yu et al. <a href="#bib.bib32" title="" class="ltx_ref">2019</a>)</cite> method, which adopts Transformer block to encode the question and image. Specifically, given a question <math id="Sx3.SSx1.p2.1.m1.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="Sx3.SSx1.p2.1.m1.1a"><mi id="Sx3.SSx1.p2.1.m1.1.1" xref="Sx3.SSx1.p2.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.1.m1.1b"><ci id="Sx3.SSx1.p2.1.m1.1.1.cmml" xref="Sx3.SSx1.p2.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.1.m1.1c">Q</annotation></semantics></math> of length <math id="Sx3.SSx1.p2.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="Sx3.SSx1.p2.2.m2.1a"><mi id="Sx3.SSx1.p2.2.m2.1.1" xref="Sx3.SSx1.p2.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.2.m2.1b"><ci id="Sx3.SSx1.p2.2.m2.1.1.cmml" xref="Sx3.SSx1.p2.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.2.m2.1c">T</annotation></semantics></math>, which is embedded into latent space <math id="Sx3.SSx1.p2.3.m3.1" class="ltx_Math" alttext="\mathbf{E}\in\mathbb{R}^{T\times{d_{h}}}" display="inline"><semantics id="Sx3.SSx1.p2.3.m3.1a"><mrow id="Sx3.SSx1.p2.3.m3.1.1" xref="Sx3.SSx1.p2.3.m3.1.1.cmml"><mi id="Sx3.SSx1.p2.3.m3.1.1.2" xref="Sx3.SSx1.p2.3.m3.1.1.2.cmml">𝐄</mi><mo id="Sx3.SSx1.p2.3.m3.1.1.1" xref="Sx3.SSx1.p2.3.m3.1.1.1.cmml">∈</mo><msup id="Sx3.SSx1.p2.3.m3.1.1.3" xref="Sx3.SSx1.p2.3.m3.1.1.3.cmml"><mi id="Sx3.SSx1.p2.3.m3.1.1.3.2" xref="Sx3.SSx1.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx1.p2.3.m3.1.1.3.3" xref="Sx3.SSx1.p2.3.m3.1.1.3.3.cmml"><mi id="Sx3.SSx1.p2.3.m3.1.1.3.3.2" xref="Sx3.SSx1.p2.3.m3.1.1.3.3.2.cmml">T</mi><mo lspace="0.222em" rspace="0.222em" id="Sx3.SSx1.p2.3.m3.1.1.3.3.1" xref="Sx3.SSx1.p2.3.m3.1.1.3.3.1.cmml">×</mo><msub id="Sx3.SSx1.p2.3.m3.1.1.3.3.3" xref="Sx3.SSx1.p2.3.m3.1.1.3.3.3.cmml"><mi id="Sx3.SSx1.p2.3.m3.1.1.3.3.3.2" xref="Sx3.SSx1.p2.3.m3.1.1.3.3.3.2.cmml">d</mi><mi id="Sx3.SSx1.p2.3.m3.1.1.3.3.3.3" xref="Sx3.SSx1.p2.3.m3.1.1.3.3.3.3.cmml">h</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.3.m3.1b"><apply id="Sx3.SSx1.p2.3.m3.1.1.cmml" xref="Sx3.SSx1.p2.3.m3.1.1"><in id="Sx3.SSx1.p2.3.m3.1.1.1.cmml" xref="Sx3.SSx1.p2.3.m3.1.1.1"></in><ci id="Sx3.SSx1.p2.3.m3.1.1.2.cmml" xref="Sx3.SSx1.p2.3.m3.1.1.2">𝐄</ci><apply id="Sx3.SSx1.p2.3.m3.1.1.3.cmml" xref="Sx3.SSx1.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.3.m3.1.1.3.1.cmml" xref="Sx3.SSx1.p2.3.m3.1.1.3">superscript</csymbol><ci id="Sx3.SSx1.p2.3.m3.1.1.3.2.cmml" xref="Sx3.SSx1.p2.3.m3.1.1.3.2">ℝ</ci><apply id="Sx3.SSx1.p2.3.m3.1.1.3.3.cmml" xref="Sx3.SSx1.p2.3.m3.1.1.3.3"><times id="Sx3.SSx1.p2.3.m3.1.1.3.3.1.cmml" xref="Sx3.SSx1.p2.3.m3.1.1.3.3.1"></times><ci id="Sx3.SSx1.p2.3.m3.1.1.3.3.2.cmml" xref="Sx3.SSx1.p2.3.m3.1.1.3.3.2">𝑇</ci><apply id="Sx3.SSx1.p2.3.m3.1.1.3.3.3.cmml" xref="Sx3.SSx1.p2.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.3.m3.1.1.3.3.3.1.cmml" xref="Sx3.SSx1.p2.3.m3.1.1.3.3.3">subscript</csymbol><ci id="Sx3.SSx1.p2.3.m3.1.1.3.3.3.2.cmml" xref="Sx3.SSx1.p2.3.m3.1.1.3.3.3.2">𝑑</ci><ci id="Sx3.SSx1.p2.3.m3.1.1.3.3.3.3.cmml" xref="Sx3.SSx1.p2.3.m3.1.1.3.3.3.3">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.3.m3.1c">\mathbf{E}\in\mathbb{R}^{T\times{d_{h}}}</annotation></semantics></math>, a two-layer Transformer is adopted to encode the questions as follows:</p>
<table id="Sx3.E1" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="Sx3.E1X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.E1X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\hat{\mathbf{E}}" display="inline"><semantics id="Sx3.E1X.2.1.1.m1.1a"><mover accent="true" id="Sx3.E1X.2.1.1.m1.1.1" xref="Sx3.E1X.2.1.1.m1.1.1.cmml"><mi id="Sx3.E1X.2.1.1.m1.1.1.2" xref="Sx3.E1X.2.1.1.m1.1.1.2.cmml">𝐄</mi><mo id="Sx3.E1X.2.1.1.m1.1.1.1" xref="Sx3.E1X.2.1.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="Sx3.E1X.2.1.1.m1.1b"><apply id="Sx3.E1X.2.1.1.m1.1.1.cmml" xref="Sx3.E1X.2.1.1.m1.1.1"><ci id="Sx3.E1X.2.1.1.m1.1.1.1.cmml" xref="Sx3.E1X.2.1.1.m1.1.1.1">^</ci><ci id="Sx3.E1X.2.1.1.m1.1.1.2.cmml" xref="Sx3.E1X.2.1.1.m1.1.1.2">𝐄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E1X.2.1.1.m1.1c">\displaystyle\hat{\mathbf{E}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx3.E1X.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle=\textrm{LN}(\mathbf{E}+\textrm{SA}(\mathbf{E}))" display="inline"><semantics id="Sx3.E1X.3.2.2.m1.2a"><mrow id="Sx3.E1X.3.2.2.m1.2.2" xref="Sx3.E1X.3.2.2.m1.2.2.cmml"><mi id="Sx3.E1X.3.2.2.m1.2.2.3" xref="Sx3.E1X.3.2.2.m1.2.2.3.cmml"></mi><mo id="Sx3.E1X.3.2.2.m1.2.2.2" xref="Sx3.E1X.3.2.2.m1.2.2.2.cmml">=</mo><mrow id="Sx3.E1X.3.2.2.m1.2.2.1" xref="Sx3.E1X.3.2.2.m1.2.2.1.cmml"><mtext id="Sx3.E1X.3.2.2.m1.2.2.1.3" xref="Sx3.E1X.3.2.2.m1.2.2.1.3a.cmml">LN</mtext><mo lspace="0em" rspace="0em" id="Sx3.E1X.3.2.2.m1.2.2.1.2" xref="Sx3.E1X.3.2.2.m1.2.2.1.2.cmml">​</mo><mrow id="Sx3.E1X.3.2.2.m1.2.2.1.1.1" xref="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E1X.3.2.2.m1.2.2.1.1.1.2" xref="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1" xref="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.cmml"><mi id="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.2" xref="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.2.cmml">𝐄</mi><mo id="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.1" xref="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.1.cmml">+</mo><mrow id="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.3" xref="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.3.cmml"><mtext id="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.3.2" xref="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.3.2a.cmml">SA</mtext><mo lspace="0em" rspace="0em" id="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.3.1" xref="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.3.1.cmml">​</mo><mrow id="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.3.3.2" xref="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.3.cmml"><mo stretchy="false" id="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.3.3.2.1" xref="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.3.cmml">(</mo><mi id="Sx3.E1X.3.2.2.m1.1.1" xref="Sx3.E1X.3.2.2.m1.1.1.cmml">𝐄</mi><mo stretchy="false" id="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.3.3.2.2" xref="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="Sx3.E1X.3.2.2.m1.2.2.1.1.1.3" xref="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E1X.3.2.2.m1.2b"><apply id="Sx3.E1X.3.2.2.m1.2.2.cmml" xref="Sx3.E1X.3.2.2.m1.2.2"><eq id="Sx3.E1X.3.2.2.m1.2.2.2.cmml" xref="Sx3.E1X.3.2.2.m1.2.2.2"></eq><csymbol cd="latexml" id="Sx3.E1X.3.2.2.m1.2.2.3.cmml" xref="Sx3.E1X.3.2.2.m1.2.2.3">absent</csymbol><apply id="Sx3.E1X.3.2.2.m1.2.2.1.cmml" xref="Sx3.E1X.3.2.2.m1.2.2.1"><times id="Sx3.E1X.3.2.2.m1.2.2.1.2.cmml" xref="Sx3.E1X.3.2.2.m1.2.2.1.2"></times><ci id="Sx3.E1X.3.2.2.m1.2.2.1.3a.cmml" xref="Sx3.E1X.3.2.2.m1.2.2.1.3"><mtext id="Sx3.E1X.3.2.2.m1.2.2.1.3.cmml" xref="Sx3.E1X.3.2.2.m1.2.2.1.3">LN</mtext></ci><apply id="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.cmml" xref="Sx3.E1X.3.2.2.m1.2.2.1.1.1"><plus id="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.1.cmml" xref="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.1"></plus><ci id="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.2.cmml" xref="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.2">𝐄</ci><apply id="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.3.cmml" xref="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.3"><times id="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.3.1.cmml" xref="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.3.1"></times><ci id="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.3.2a.cmml" xref="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.3.2"><mtext id="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.3.2.cmml" xref="Sx3.E1X.3.2.2.m1.2.2.1.1.1.1.3.2">SA</mtext></ci><ci id="Sx3.E1X.3.2.2.m1.1.1.cmml" xref="Sx3.E1X.3.2.2.m1.1.1">𝐄</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E1X.3.2.2.m1.2c">\displaystyle=\textrm{LN}(\mathbf{E}+\textrm{SA}(\mathbf{E}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(1)</span></td>
</tr>
<tr id="Sx3.E1Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.E1Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\tilde{\mathbf{E}}" display="inline"><semantics id="Sx3.E1Xa.2.1.1.m1.1a"><mover accent="true" id="Sx3.E1Xa.2.1.1.m1.1.1" xref="Sx3.E1Xa.2.1.1.m1.1.1.cmml"><mi id="Sx3.E1Xa.2.1.1.m1.1.1.2" xref="Sx3.E1Xa.2.1.1.m1.1.1.2.cmml">𝐄</mi><mo id="Sx3.E1Xa.2.1.1.m1.1.1.1" xref="Sx3.E1Xa.2.1.1.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="Sx3.E1Xa.2.1.1.m1.1b"><apply id="Sx3.E1Xa.2.1.1.m1.1.1.cmml" xref="Sx3.E1Xa.2.1.1.m1.1.1"><ci id="Sx3.E1Xa.2.1.1.m1.1.1.1.cmml" xref="Sx3.E1Xa.2.1.1.m1.1.1.1">~</ci><ci id="Sx3.E1Xa.2.1.1.m1.1.1.2.cmml" xref="Sx3.E1Xa.2.1.1.m1.1.1.2">𝐄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E1Xa.2.1.1.m1.1c">\displaystyle\tilde{\mathbf{E}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx3.E1Xa.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle=\textrm{LN}(\hat{\mathbf{\mathbf{E}}}+\textrm{FFN}(\hat{\mathbf{\mathbf{E}}}))," display="inline"><semantics id="Sx3.E1Xa.3.2.2.m1.2a"><mrow id="Sx3.E1Xa.3.2.2.m1.2.2.1" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.cmml"><mrow id="Sx3.E1Xa.3.2.2.m1.2.2.1.1" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.cmml"><mi id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.3" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.3.cmml"></mi><mo id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.2" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.2.cmml">=</mo><mrow id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.cmml"><mtext id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.3" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.3a.cmml">LN</mtext><mo lspace="0em" rspace="0em" id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.2" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.2" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.cmml"><mover accent="true" id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.2" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.2.cmml">𝐄</mi><mo id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.1" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml">+</mo><mrow id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.cmml"><mtext id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.2" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.2a.cmml">FFN</mtext><mo lspace="0em" rspace="0em" id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.1" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.3.2" xref="Sx3.E1Xa.3.2.2.m1.1.1.cmml"><mo stretchy="false" id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.3.2.1" xref="Sx3.E1Xa.3.2.2.m1.1.1.cmml">(</mo><mover accent="true" id="Sx3.E1Xa.3.2.2.m1.1.1" xref="Sx3.E1Xa.3.2.2.m1.1.1.cmml"><mi id="Sx3.E1Xa.3.2.2.m1.1.1.2" xref="Sx3.E1Xa.3.2.2.m1.1.1.2.cmml">𝐄</mi><mo id="Sx3.E1Xa.3.2.2.m1.1.1.1" xref="Sx3.E1Xa.3.2.2.m1.1.1.1.cmml">^</mo></mover><mo stretchy="false" id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.3.2.2" xref="Sx3.E1Xa.3.2.2.m1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.3" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="Sx3.E1Xa.3.2.2.m1.2.2.1.2" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E1Xa.3.2.2.m1.2b"><apply id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.cmml" xref="Sx3.E1Xa.3.2.2.m1.2.2.1"><eq id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.2.cmml" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.2"></eq><csymbol cd="latexml" id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.3.cmml" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.3">absent</csymbol><apply id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.cmml" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1"><times id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.2.cmml" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.2"></times><ci id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.3a.cmml" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.3"><mtext id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.3.cmml" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.3">LN</mtext></ci><apply id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.cmml" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1"><plus id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1"></plus><apply id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2"><ci id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.1">^</ci><ci id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.2">𝐄</ci></apply><apply id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3"><times id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.1"></times><ci id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.2a.cmml" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.2"><mtext id="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.2">FFN</mtext></ci><apply id="Sx3.E1Xa.3.2.2.m1.1.1.cmml" xref="Sx3.E1Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.3.2"><ci id="Sx3.E1Xa.3.2.2.m1.1.1.1.cmml" xref="Sx3.E1Xa.3.2.2.m1.1.1.1">^</ci><ci id="Sx3.E1Xa.3.2.2.m1.1.1.2.cmml" xref="Sx3.E1Xa.3.2.2.m1.1.1.2">𝐄</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E1Xa.3.2.2.m1.2c">\displaystyle=\textrm{LN}(\hat{\mathbf{\mathbf{E}}}+\textrm{FFN}(\hat{\mathbf{\mathbf{E}}})),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="Sx3.SSx1.p2.6" class="ltx_p">where <math id="Sx3.SSx1.p2.4.m1.3" class="ltx_Math" alttext="\textrm{SA},\textrm{LN},\textrm{FFN}" display="inline"><semantics id="Sx3.SSx1.p2.4.m1.3a"><mrow id="Sx3.SSx1.p2.4.m1.3.4.2" xref="Sx3.SSx1.p2.4.m1.3.4.1.cmml"><mtext id="Sx3.SSx1.p2.4.m1.1.1" xref="Sx3.SSx1.p2.4.m1.1.1a.cmml">SA</mtext><mo id="Sx3.SSx1.p2.4.m1.3.4.2.1" xref="Sx3.SSx1.p2.4.m1.3.4.1.cmml">,</mo><mtext id="Sx3.SSx1.p2.4.m1.2.2" xref="Sx3.SSx1.p2.4.m1.2.2a.cmml">LN</mtext><mo id="Sx3.SSx1.p2.4.m1.3.4.2.2" xref="Sx3.SSx1.p2.4.m1.3.4.1.cmml">,</mo><mtext id="Sx3.SSx1.p2.4.m1.3.3" xref="Sx3.SSx1.p2.4.m1.3.3a.cmml">FFN</mtext></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.4.m1.3b"><list id="Sx3.SSx1.p2.4.m1.3.4.1.cmml" xref="Sx3.SSx1.p2.4.m1.3.4.2"><ci id="Sx3.SSx1.p2.4.m1.1.1a.cmml" xref="Sx3.SSx1.p2.4.m1.1.1"><mtext id="Sx3.SSx1.p2.4.m1.1.1.cmml" xref="Sx3.SSx1.p2.4.m1.1.1">SA</mtext></ci><ci id="Sx3.SSx1.p2.4.m1.2.2a.cmml" xref="Sx3.SSx1.p2.4.m1.2.2"><mtext id="Sx3.SSx1.p2.4.m1.2.2.cmml" xref="Sx3.SSx1.p2.4.m1.2.2">LN</mtext></ci><ci id="Sx3.SSx1.p2.4.m1.3.3a.cmml" xref="Sx3.SSx1.p2.4.m1.3.3"><mtext id="Sx3.SSx1.p2.4.m1.3.3.cmml" xref="Sx3.SSx1.p2.4.m1.3.3">FFN</mtext></ci></list></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.4.m1.3c">\textrm{SA},\textrm{LN},\textrm{FFN}</annotation></semantics></math> denote self-attention, layer normalization and feed forward network, respectively. Afterwards, the image feature <math id="Sx3.SSx1.p2.5.m2.1" class="ltx_Math" alttext="\mathbf{V}" display="inline"><semantics id="Sx3.SSx1.p2.5.m2.1a"><mi id="Sx3.SSx1.p2.5.m2.1.1" xref="Sx3.SSx1.p2.5.m2.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.5.m2.1b"><ci id="Sx3.SSx1.p2.5.m2.1.1.cmml" xref="Sx3.SSx1.p2.5.m2.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.5.m2.1c">\mathbf{V}</annotation></semantics></math> is enriched via a two-layer Transformer using visual contexts and question semantics <math id="Sx3.SSx1.p2.6.m3.1" class="ltx_Math" alttext="\mathbf{\tilde{E}}" display="inline"><semantics id="Sx3.SSx1.p2.6.m3.1a"><mover accent="true" id="Sx3.SSx1.p2.6.m3.1.1" xref="Sx3.SSx1.p2.6.m3.1.1.cmml"><mi id="Sx3.SSx1.p2.6.m3.1.1.2" xref="Sx3.SSx1.p2.6.m3.1.1.2.cmml">𝐄</mi><mo id="Sx3.SSx1.p2.6.m3.1.1.1" xref="Sx3.SSx1.p2.6.m3.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.6.m3.1b"><apply id="Sx3.SSx1.p2.6.m3.1.1.cmml" xref="Sx3.SSx1.p2.6.m3.1.1"><ci id="Sx3.SSx1.p2.6.m3.1.1.1.cmml" xref="Sx3.SSx1.p2.6.m3.1.1.1">~</ci><ci id="Sx3.SSx1.p2.6.m3.1.1.2.cmml" xref="Sx3.SSx1.p2.6.m3.1.1.2">𝐄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.6.m3.1c">\mathbf{\tilde{E}}</annotation></semantics></math> as follows:</p>
<table id="Sx3.E2" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="Sx3.E2X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.E2X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{V^{\prime}}" display="inline"><semantics id="Sx3.E2X.2.1.1.m1.1a"><msup id="Sx3.E2X.2.1.1.m1.1.1" xref="Sx3.E2X.2.1.1.m1.1.1.cmml"><mi id="Sx3.E2X.2.1.1.m1.1.1.2" xref="Sx3.E2X.2.1.1.m1.1.1.2.cmml">𝐕</mi><mo id="Sx3.E2X.2.1.1.m1.1.1.3" xref="Sx3.E2X.2.1.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="Sx3.E2X.2.1.1.m1.1b"><apply id="Sx3.E2X.2.1.1.m1.1.1.cmml" xref="Sx3.E2X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E2X.2.1.1.m1.1.1.1.cmml" xref="Sx3.E2X.2.1.1.m1.1.1">superscript</csymbol><ci id="Sx3.E2X.2.1.1.m1.1.1.2.cmml" xref="Sx3.E2X.2.1.1.m1.1.1.2">𝐕</ci><ci id="Sx3.E2X.2.1.1.m1.1.1.3.cmml" xref="Sx3.E2X.2.1.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E2X.2.1.1.m1.1c">\displaystyle\mathbf{V^{\prime}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx3.E2X.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle=\textrm{FC}(\mathbf{V}+\textrm{PosEmb})" display="inline"><semantics id="Sx3.E2X.3.2.2.m1.1a"><mrow id="Sx3.E2X.3.2.2.m1.1.1" xref="Sx3.E2X.3.2.2.m1.1.1.cmml"><mi id="Sx3.E2X.3.2.2.m1.1.1.3" xref="Sx3.E2X.3.2.2.m1.1.1.3.cmml"></mi><mo id="Sx3.E2X.3.2.2.m1.1.1.2" xref="Sx3.E2X.3.2.2.m1.1.1.2.cmml">=</mo><mrow id="Sx3.E2X.3.2.2.m1.1.1.1" xref="Sx3.E2X.3.2.2.m1.1.1.1.cmml"><mtext id="Sx3.E2X.3.2.2.m1.1.1.1.3" xref="Sx3.E2X.3.2.2.m1.1.1.1.3a.cmml">FC</mtext><mo lspace="0em" rspace="0em" id="Sx3.E2X.3.2.2.m1.1.1.1.2" xref="Sx3.E2X.3.2.2.m1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E2X.3.2.2.m1.1.1.1.1.1" xref="Sx3.E2X.3.2.2.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E2X.3.2.2.m1.1.1.1.1.1.2" xref="Sx3.E2X.3.2.2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E2X.3.2.2.m1.1.1.1.1.1.1" xref="Sx3.E2X.3.2.2.m1.1.1.1.1.1.1.cmml"><mi id="Sx3.E2X.3.2.2.m1.1.1.1.1.1.1.2" xref="Sx3.E2X.3.2.2.m1.1.1.1.1.1.1.2.cmml">𝐕</mi><mo id="Sx3.E2X.3.2.2.m1.1.1.1.1.1.1.1" xref="Sx3.E2X.3.2.2.m1.1.1.1.1.1.1.1.cmml">+</mo><mtext id="Sx3.E2X.3.2.2.m1.1.1.1.1.1.1.3" xref="Sx3.E2X.3.2.2.m1.1.1.1.1.1.1.3a.cmml">PosEmb</mtext></mrow><mo stretchy="false" id="Sx3.E2X.3.2.2.m1.1.1.1.1.1.3" xref="Sx3.E2X.3.2.2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E2X.3.2.2.m1.1b"><apply id="Sx3.E2X.3.2.2.m1.1.1.cmml" xref="Sx3.E2X.3.2.2.m1.1.1"><eq id="Sx3.E2X.3.2.2.m1.1.1.2.cmml" xref="Sx3.E2X.3.2.2.m1.1.1.2"></eq><csymbol cd="latexml" id="Sx3.E2X.3.2.2.m1.1.1.3.cmml" xref="Sx3.E2X.3.2.2.m1.1.1.3">absent</csymbol><apply id="Sx3.E2X.3.2.2.m1.1.1.1.cmml" xref="Sx3.E2X.3.2.2.m1.1.1.1"><times id="Sx3.E2X.3.2.2.m1.1.1.1.2.cmml" xref="Sx3.E2X.3.2.2.m1.1.1.1.2"></times><ci id="Sx3.E2X.3.2.2.m1.1.1.1.3a.cmml" xref="Sx3.E2X.3.2.2.m1.1.1.1.3"><mtext id="Sx3.E2X.3.2.2.m1.1.1.1.3.cmml" xref="Sx3.E2X.3.2.2.m1.1.1.1.3">FC</mtext></ci><apply id="Sx3.E2X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="Sx3.E2X.3.2.2.m1.1.1.1.1.1"><plus id="Sx3.E2X.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="Sx3.E2X.3.2.2.m1.1.1.1.1.1.1.1"></plus><ci id="Sx3.E2X.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="Sx3.E2X.3.2.2.m1.1.1.1.1.1.1.2">𝐕</ci><ci id="Sx3.E2X.3.2.2.m1.1.1.1.1.1.1.3a.cmml" xref="Sx3.E2X.3.2.2.m1.1.1.1.1.1.1.3"><mtext id="Sx3.E2X.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="Sx3.E2X.3.2.2.m1.1.1.1.1.1.1.3">PosEmb</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E2X.3.2.2.m1.1c">\displaystyle=\textrm{FC}(\mathbf{V}+\textrm{PosEmb})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="4" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(2)</span></td>
</tr>
<tr id="Sx3.E2Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.E2Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\bar{\mathbf{V}}" display="inline"><semantics id="Sx3.E2Xa.2.1.1.m1.1a"><mover accent="true" id="Sx3.E2Xa.2.1.1.m1.1.1" xref="Sx3.E2Xa.2.1.1.m1.1.1.cmml"><mi id="Sx3.E2Xa.2.1.1.m1.1.1.2" xref="Sx3.E2Xa.2.1.1.m1.1.1.2.cmml">𝐕</mi><mo id="Sx3.E2Xa.2.1.1.m1.1.1.1" xref="Sx3.E2Xa.2.1.1.m1.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="Sx3.E2Xa.2.1.1.m1.1b"><apply id="Sx3.E2Xa.2.1.1.m1.1.1.cmml" xref="Sx3.E2Xa.2.1.1.m1.1.1"><ci id="Sx3.E2Xa.2.1.1.m1.1.1.1.cmml" xref="Sx3.E2Xa.2.1.1.m1.1.1.1">¯</ci><ci id="Sx3.E2Xa.2.1.1.m1.1.1.2.cmml" xref="Sx3.E2Xa.2.1.1.m1.1.1.2">𝐕</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E2Xa.2.1.1.m1.1c">\displaystyle\bar{\mathbf{V}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx3.E2Xa.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle=\textrm{LN}(\mathbf{V^{\prime}}+\textrm{SA}(\mathbf{V^{\prime}}))" display="inline"><semantics id="Sx3.E2Xa.3.2.2.m1.1a"><mrow id="Sx3.E2Xa.3.2.2.m1.1.1" xref="Sx3.E2Xa.3.2.2.m1.1.1.cmml"><mi id="Sx3.E2Xa.3.2.2.m1.1.1.3" xref="Sx3.E2Xa.3.2.2.m1.1.1.3.cmml"></mi><mo id="Sx3.E2Xa.3.2.2.m1.1.1.2" xref="Sx3.E2Xa.3.2.2.m1.1.1.2.cmml">=</mo><mrow id="Sx3.E2Xa.3.2.2.m1.1.1.1" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.cmml"><mtext id="Sx3.E2Xa.3.2.2.m1.1.1.1.3" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.3a.cmml">LN</mtext><mo lspace="0em" rspace="0em" id="Sx3.E2Xa.3.2.2.m1.1.1.1.2" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.2" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.cmml"><msup id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.3" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml"><mi id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.3.2" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.3.2.cmml">𝐕</mi><mo id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.3.3" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.3.3.cmml">′</mo></msup><mo id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.2" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mtext id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.3" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.3a.cmml">SA</mtext><mo lspace="0em" rspace="0em" id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.2" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐕</mi><mo id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo stretchy="false" id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.3" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E2Xa.3.2.2.m1.1b"><apply id="Sx3.E2Xa.3.2.2.m1.1.1.cmml" xref="Sx3.E2Xa.3.2.2.m1.1.1"><eq id="Sx3.E2Xa.3.2.2.m1.1.1.2.cmml" xref="Sx3.E2Xa.3.2.2.m1.1.1.2"></eq><csymbol cd="latexml" id="Sx3.E2Xa.3.2.2.m1.1.1.3.cmml" xref="Sx3.E2Xa.3.2.2.m1.1.1.3">absent</csymbol><apply id="Sx3.E2Xa.3.2.2.m1.1.1.1.cmml" xref="Sx3.E2Xa.3.2.2.m1.1.1.1"><times id="Sx3.E2Xa.3.2.2.m1.1.1.1.2.cmml" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.2"></times><ci id="Sx3.E2Xa.3.2.2.m1.1.1.1.3a.cmml" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.3"><mtext id="Sx3.E2Xa.3.2.2.m1.1.1.1.3.cmml" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.3">LN</mtext></ci><apply id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.cmml" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1"><plus id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.2"></plus><apply id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.3.2">𝐕</ci><ci id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.3.3">′</ci></apply><apply id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1"><times id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.2"></times><ci id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.3a.cmml" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.3"><mtext id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.3">SA</mtext></ci><apply id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2">𝐕</ci><ci id="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3">′</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E2Xa.3.2.2.m1.1c">\displaystyle=\textrm{LN}(\mathbf{V^{\prime}}+\textrm{SA}(\mathbf{V^{\prime}}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="Sx3.E2Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.E2Xb.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\hat{\mathbf{\mathbf{V}}}" display="inline"><semantics id="Sx3.E2Xb.2.1.1.m1.1a"><mover accent="true" id="Sx3.E2Xb.2.1.1.m1.1.1" xref="Sx3.E2Xb.2.1.1.m1.1.1.cmml"><mi id="Sx3.E2Xb.2.1.1.m1.1.1.2" xref="Sx3.E2Xb.2.1.1.m1.1.1.2.cmml">𝐕</mi><mo id="Sx3.E2Xb.2.1.1.m1.1.1.1" xref="Sx3.E2Xb.2.1.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="Sx3.E2Xb.2.1.1.m1.1b"><apply id="Sx3.E2Xb.2.1.1.m1.1.1.cmml" xref="Sx3.E2Xb.2.1.1.m1.1.1"><ci id="Sx3.E2Xb.2.1.1.m1.1.1.1.cmml" xref="Sx3.E2Xb.2.1.1.m1.1.1.1">^</ci><ci id="Sx3.E2Xb.2.1.1.m1.1.1.2.cmml" xref="Sx3.E2Xb.2.1.1.m1.1.1.2">𝐕</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E2Xb.2.1.1.m1.1c">\displaystyle\hat{\mathbf{\mathbf{V}}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx3.E2Xb.3.2.2.m1.3" class="ltx_Math" alttext="\displaystyle=\textrm{LN}(\bar{\mathbf{V}}+\textrm{GA}(\bar{\mathbf{V}},\hat{\mathbf{\mathbf{E}}}))" display="inline"><semantics id="Sx3.E2Xb.3.2.2.m1.3a"><mrow id="Sx3.E2Xb.3.2.2.m1.3.3" xref="Sx3.E2Xb.3.2.2.m1.3.3.cmml"><mi id="Sx3.E2Xb.3.2.2.m1.3.3.3" xref="Sx3.E2Xb.3.2.2.m1.3.3.3.cmml"></mi><mo id="Sx3.E2Xb.3.2.2.m1.3.3.2" xref="Sx3.E2Xb.3.2.2.m1.3.3.2.cmml">=</mo><mrow id="Sx3.E2Xb.3.2.2.m1.3.3.1" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.cmml"><mtext id="Sx3.E2Xb.3.2.2.m1.3.3.1.3" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.3a.cmml">LN</mtext><mo lspace="0em" rspace="0em" id="Sx3.E2Xb.3.2.2.m1.3.3.1.2" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.2.cmml">​</mo><mrow id="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.2" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.cmml"><mover accent="true" id="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.2" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.2.cmml"><mi id="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.2.2" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.2.2.cmml">𝐕</mi><mo id="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.2.1" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.2.1.cmml">¯</mo></mover><mo id="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.1" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.1.cmml">+</mo><mrow id="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.3" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.3.cmml"><mtext id="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.3.2" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.3.2a.cmml">GA</mtext><mo lspace="0em" rspace="0em" id="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.3.1" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.3.1.cmml">​</mo><mrow id="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.3.3.2" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.3.3.1.cmml"><mo stretchy="false" id="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.3.3.2.1" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.3.3.1.cmml">(</mo><mover accent="true" id="Sx3.E2Xb.3.2.2.m1.1.1" xref="Sx3.E2Xb.3.2.2.m1.1.1.cmml"><mi id="Sx3.E2Xb.3.2.2.m1.1.1.2" xref="Sx3.E2Xb.3.2.2.m1.1.1.2.cmml">𝐕</mi><mo id="Sx3.E2Xb.3.2.2.m1.1.1.1" xref="Sx3.E2Xb.3.2.2.m1.1.1.1.cmml">¯</mo></mover><mo id="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.3.3.2.2" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.3.3.1.cmml">,</mo><mover accent="true" id="Sx3.E2Xb.3.2.2.m1.2.2" xref="Sx3.E2Xb.3.2.2.m1.2.2.cmml"><mi id="Sx3.E2Xb.3.2.2.m1.2.2.2" xref="Sx3.E2Xb.3.2.2.m1.2.2.2.cmml">𝐄</mi><mo id="Sx3.E2Xb.3.2.2.m1.2.2.1" xref="Sx3.E2Xb.3.2.2.m1.2.2.1.cmml">^</mo></mover><mo stretchy="false" id="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.3.3.2.3" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.3" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E2Xb.3.2.2.m1.3b"><apply id="Sx3.E2Xb.3.2.2.m1.3.3.cmml" xref="Sx3.E2Xb.3.2.2.m1.3.3"><eq id="Sx3.E2Xb.3.2.2.m1.3.3.2.cmml" xref="Sx3.E2Xb.3.2.2.m1.3.3.2"></eq><csymbol cd="latexml" id="Sx3.E2Xb.3.2.2.m1.3.3.3.cmml" xref="Sx3.E2Xb.3.2.2.m1.3.3.3">absent</csymbol><apply id="Sx3.E2Xb.3.2.2.m1.3.3.1.cmml" xref="Sx3.E2Xb.3.2.2.m1.3.3.1"><times id="Sx3.E2Xb.3.2.2.m1.3.3.1.2.cmml" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.2"></times><ci id="Sx3.E2Xb.3.2.2.m1.3.3.1.3a.cmml" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.3"><mtext id="Sx3.E2Xb.3.2.2.m1.3.3.1.3.cmml" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.3">LN</mtext></ci><apply id="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.cmml" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1"><plus id="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.1.cmml" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.1"></plus><apply id="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.2.cmml" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.2"><ci id="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.2.1.cmml" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.2.1">¯</ci><ci id="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.2.2.cmml" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.2.2">𝐕</ci></apply><apply id="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.3.cmml" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.3"><times id="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.3.1.cmml" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.3.1"></times><ci id="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.3.2a.cmml" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.3.2"><mtext id="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.3.2.cmml" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.3.2">GA</mtext></ci><interval closure="open" id="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.3.3.1.cmml" xref="Sx3.E2Xb.3.2.2.m1.3.3.1.1.1.1.3.3.2"><apply id="Sx3.E2Xb.3.2.2.m1.1.1.cmml" xref="Sx3.E2Xb.3.2.2.m1.1.1"><ci id="Sx3.E2Xb.3.2.2.m1.1.1.1.cmml" xref="Sx3.E2Xb.3.2.2.m1.1.1.1">¯</ci><ci id="Sx3.E2Xb.3.2.2.m1.1.1.2.cmml" xref="Sx3.E2Xb.3.2.2.m1.1.1.2">𝐕</ci></apply><apply id="Sx3.E2Xb.3.2.2.m1.2.2.cmml" xref="Sx3.E2Xb.3.2.2.m1.2.2"><ci id="Sx3.E2Xb.3.2.2.m1.2.2.1.cmml" xref="Sx3.E2Xb.3.2.2.m1.2.2.1">^</ci><ci id="Sx3.E2Xb.3.2.2.m1.2.2.2.cmml" xref="Sx3.E2Xb.3.2.2.m1.2.2.2">𝐄</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E2Xb.3.2.2.m1.3c">\displaystyle=\textrm{LN}(\bar{\mathbf{V}}+\textrm{GA}(\bar{\mathbf{V}},\hat{\mathbf{\mathbf{E}}}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="Sx3.E2Xc" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.E2Xc.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\tilde{\mathbf{V}}" display="inline"><semantics id="Sx3.E2Xc.2.1.1.m1.1a"><mover accent="true" id="Sx3.E2Xc.2.1.1.m1.1.1" xref="Sx3.E2Xc.2.1.1.m1.1.1.cmml"><mi id="Sx3.E2Xc.2.1.1.m1.1.1.2" xref="Sx3.E2Xc.2.1.1.m1.1.1.2.cmml">𝐕</mi><mo id="Sx3.E2Xc.2.1.1.m1.1.1.1" xref="Sx3.E2Xc.2.1.1.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="Sx3.E2Xc.2.1.1.m1.1b"><apply id="Sx3.E2Xc.2.1.1.m1.1.1.cmml" xref="Sx3.E2Xc.2.1.1.m1.1.1"><ci id="Sx3.E2Xc.2.1.1.m1.1.1.1.cmml" xref="Sx3.E2Xc.2.1.1.m1.1.1.1">~</ci><ci id="Sx3.E2Xc.2.1.1.m1.1.1.2.cmml" xref="Sx3.E2Xc.2.1.1.m1.1.1.2">𝐕</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E2Xc.2.1.1.m1.1c">\displaystyle\tilde{\mathbf{V}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx3.E2Xc.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle=\textrm{LN}(\hat{\mathbf{\mathbf{V}}}+\textrm{FFN}(\hat{\mathbf{\mathbf{V}}}))," display="inline"><semantics id="Sx3.E2Xc.3.2.2.m1.2a"><mrow id="Sx3.E2Xc.3.2.2.m1.2.2.1" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.cmml"><mrow id="Sx3.E2Xc.3.2.2.m1.2.2.1.1" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.cmml"><mi id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.3" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.3.cmml"></mi><mo id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.2" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.2.cmml">=</mo><mrow id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.cmml"><mtext id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.3" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.3a.cmml">LN</mtext><mo lspace="0em" rspace="0em" id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.2" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.2" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.cmml"><mover accent="true" id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.2" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.2.2" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.2.2.cmml">𝐕</mi><mo id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.2.1" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml">+</mo><mrow id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.cmml"><mtext id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.2" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.2a.cmml">FFN</mtext><mo lspace="0em" rspace="0em" id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.1" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.3.2" xref="Sx3.E2Xc.3.2.2.m1.1.1.cmml"><mo stretchy="false" id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.3.2.1" xref="Sx3.E2Xc.3.2.2.m1.1.1.cmml">(</mo><mover accent="true" id="Sx3.E2Xc.3.2.2.m1.1.1" xref="Sx3.E2Xc.3.2.2.m1.1.1.cmml"><mi id="Sx3.E2Xc.3.2.2.m1.1.1.2" xref="Sx3.E2Xc.3.2.2.m1.1.1.2.cmml">𝐕</mi><mo id="Sx3.E2Xc.3.2.2.m1.1.1.1" xref="Sx3.E2Xc.3.2.2.m1.1.1.1.cmml">^</mo></mover><mo stretchy="false" id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.3.2.2" xref="Sx3.E2Xc.3.2.2.m1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.3" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="Sx3.E2Xc.3.2.2.m1.2.2.1.2" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E2Xc.3.2.2.m1.2b"><apply id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.cmml" xref="Sx3.E2Xc.3.2.2.m1.2.2.1"><eq id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.2.cmml" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.2"></eq><csymbol cd="latexml" id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.3.cmml" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.3">absent</csymbol><apply id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.cmml" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1"><times id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.2.cmml" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.2"></times><ci id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.3a.cmml" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.3"><mtext id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.3.cmml" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.3">LN</mtext></ci><apply id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.cmml" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1"><plus id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1"></plus><apply id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.2"><ci id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.2.1">^</ci><ci id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.2.2">𝐕</ci></apply><apply id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3"><times id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.1"></times><ci id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.2a.cmml" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.2"><mtext id="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.2">FFN</mtext></ci><apply id="Sx3.E2Xc.3.2.2.m1.1.1.cmml" xref="Sx3.E2Xc.3.2.2.m1.2.2.1.1.1.1.1.1.3.3.2"><ci id="Sx3.E2Xc.3.2.2.m1.1.1.1.cmml" xref="Sx3.E2Xc.3.2.2.m1.1.1.1">^</ci><ci id="Sx3.E2Xc.3.2.2.m1.1.1.2.cmml" xref="Sx3.E2Xc.3.2.2.m1.1.1.2">𝐕</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E2Xc.3.2.2.m1.2c">\displaystyle=\textrm{LN}(\hat{\mathbf{\mathbf{V}}}+\textrm{FFN}(\hat{\mathbf{\mathbf{V}}})),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="Sx3.SSx1.p2.12" class="ltx_p">where <span id="Sx3.SSx1.p2.12.1" class="ltx_text ltx_markedasmath">PosEmb</span> indicates position embedding. <span id="Sx3.SSx1.p2.12.2" class="ltx_text ltx_markedasmath">FC</span> denotes fully-connected layer, converting feature dimension from <math id="Sx3.SSx1.p2.9.m3.1" class="ltx_Math" alttext="d_{v}" display="inline"><semantics id="Sx3.SSx1.p2.9.m3.1a"><msub id="Sx3.SSx1.p2.9.m3.1.1" xref="Sx3.SSx1.p2.9.m3.1.1.cmml"><mi id="Sx3.SSx1.p2.9.m3.1.1.2" xref="Sx3.SSx1.p2.9.m3.1.1.2.cmml">d</mi><mi id="Sx3.SSx1.p2.9.m3.1.1.3" xref="Sx3.SSx1.p2.9.m3.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.9.m3.1b"><apply id="Sx3.SSx1.p2.9.m3.1.1.cmml" xref="Sx3.SSx1.p2.9.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.9.m3.1.1.1.cmml" xref="Sx3.SSx1.p2.9.m3.1.1">subscript</csymbol><ci id="Sx3.SSx1.p2.9.m3.1.1.2.cmml" xref="Sx3.SSx1.p2.9.m3.1.1.2">𝑑</ci><ci id="Sx3.SSx1.p2.9.m3.1.1.3.cmml" xref="Sx3.SSx1.p2.9.m3.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.9.m3.1c">d_{v}</annotation></semantics></math> to <math id="Sx3.SSx1.p2.10.m4.1" class="ltx_Math" alttext="d_{h}" display="inline"><semantics id="Sx3.SSx1.p2.10.m4.1a"><msub id="Sx3.SSx1.p2.10.m4.1.1" xref="Sx3.SSx1.p2.10.m4.1.1.cmml"><mi id="Sx3.SSx1.p2.10.m4.1.1.2" xref="Sx3.SSx1.p2.10.m4.1.1.2.cmml">d</mi><mi id="Sx3.SSx1.p2.10.m4.1.1.3" xref="Sx3.SSx1.p2.10.m4.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.10.m4.1b"><apply id="Sx3.SSx1.p2.10.m4.1.1.cmml" xref="Sx3.SSx1.p2.10.m4.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.10.m4.1.1.1.cmml" xref="Sx3.SSx1.p2.10.m4.1.1">subscript</csymbol><ci id="Sx3.SSx1.p2.10.m4.1.1.2.cmml" xref="Sx3.SSx1.p2.10.m4.1.1.2">𝑑</ci><ci id="Sx3.SSx1.p2.10.m4.1.1.3.cmml" xref="Sx3.SSx1.p2.10.m4.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.10.m4.1c">d_{h}</annotation></semantics></math>. <span id="Sx3.SSx1.p2.12.3" class="ltx_text ltx_markedasmath">GA</span> denotes guided attention, which exploits question semantics to enhance the relevant visual features. The resulting image representation <math id="Sx3.SSx1.p2.12.m6.1" class="ltx_Math" alttext="\tilde{\mathbf{V}}" display="inline"><semantics id="Sx3.SSx1.p2.12.m6.1a"><mover accent="true" id="Sx3.SSx1.p2.12.m6.1.1" xref="Sx3.SSx1.p2.12.m6.1.1.cmml"><mi id="Sx3.SSx1.p2.12.m6.1.1.2" xref="Sx3.SSx1.p2.12.m6.1.1.2.cmml">𝐕</mi><mo id="Sx3.SSx1.p2.12.m6.1.1.1" xref="Sx3.SSx1.p2.12.m6.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.12.m6.1b"><apply id="Sx3.SSx1.p2.12.m6.1.1.cmml" xref="Sx3.SSx1.p2.12.m6.1.1"><ci id="Sx3.SSx1.p2.12.m6.1.1.1.cmml" xref="Sx3.SSx1.p2.12.m6.1.1.1">~</ci><ci id="Sx3.SSx1.p2.12.m6.1.1.2.cmml" xref="Sx3.SSx1.p2.12.m6.1.1.2">𝐕</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.12.m6.1c">\tilde{\mathbf{V}}</annotation></semantics></math> can be used for program execution to get the final answer.</p>
</div>
</section>
<section id="Sx3.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Program Generation</h3>

<div id="Sx3.SSx2.p1" class="ltx_para">
<p id="Sx3.SSx2.p1.1" class="ltx_p">Program generation aims to parse questions into program trees that reflect the reasoning procedures inferred by questions, and the program trees can be further used for model construction. We follow MMN <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib8" title="" class="ltx_ref">2021</a>)</cite> to generate programs from questions. Specifically, the nodes of the program tree are formalized as “Function(Arg1,…ArgN)”, where “Function” can be categorized into 10 different abstract types (<em id="Sx3.SSx2.p1.1.1" class="ltx_emph ltx_font_italic">e.g.,</em> select, relate, exist, or, <em id="Sx3.SSx2.p1.1.2" class="ltx_emph ltx_font_italic">etc.</em>), and each abstract type is further subdivided into more subtypes (<em id="Sx3.SSx2.p1.1.3" class="ltx_emph ltx_font_italic">e.g.,</em> relate: relate_attr, relate_name, relate_inv_name, <em id="Sx3.SSx2.p1.1.4" class="ltx_emph ltx_font_italic">etc.</em>), which take a variable number of arguments as inputs.</p>
</div>
<figure id="Sx3.F3" class="ltx_figure"><img src="/html/2312.16012/assets/x3.png" id="Sx3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="202" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Illustration of the program generation based on encoder-decoder network.</figcaption>
</figure>
<div id="Sx3.SSx2.p2" class="ltx_para">
<p id="Sx3.SSx2.p2.1" class="ltx_p">Based on the abovementioned program types, the complete program tree can be viewed as the sequence of functional nodes, and generated from an encoder-decoder network, <em id="Sx3.SSx2.p2.1.1" class="ltx_emph ltx_font_italic">e.g.,</em> T5 <cite class="ltx_cite ltx_citemacro_citep">(Raffel et al. <a href="#bib.bib25" title="" class="ltx_ref">2020</a>)</cite>. As illustrated in Figure <a href="#Sx3.F3" title="Figure 3 ‣ Program Generation ‣ Methodology ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, a prompt (<em id="Sx3.SSx2.p2.1.2" class="ltx_emph ltx_font_italic">i.e.,</em> “transform question into programs:”) is added in front of the question, and fed to T5 model for program generation. The output sequence consists of inter-dependent functions, where “[N]” denotes the dependencies. Afterwards, a structured program tree with <math id="Sx3.SSx2.p2.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="Sx3.SSx2.p2.1.m1.1a"><mi id="Sx3.SSx2.p2.1.m1.1.1" xref="Sx3.SSx2.p2.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p2.1.m1.1b"><ci id="Sx3.SSx2.p2.1.m1.1.1.cmml" xref="Sx3.SSx2.p2.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p2.1.m1.1c">L</annotation></semantics></math> layers is constructed from the sequence according to the dependencies, which can be used to guide step-by-step program execution.</p>
</div>
</section>
<section id="Sx3.SSx3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Program Execution</h3>

<div id="Sx3.SSx3.p1" class="ltx_para">
<p id="Sx3.SSx3.p1.6" class="ltx_p">Given image features <math id="Sx3.SSx3.p1.1.m1.1" class="ltx_Math" alttext="\tilde{\mathbf{V}}" display="inline"><semantics id="Sx3.SSx3.p1.1.m1.1a"><mover accent="true" id="Sx3.SSx3.p1.1.m1.1.1" xref="Sx3.SSx3.p1.1.m1.1.1.cmml"><mi id="Sx3.SSx3.p1.1.m1.1.1.2" xref="Sx3.SSx3.p1.1.m1.1.1.2.cmml">𝐕</mi><mo id="Sx3.SSx3.p1.1.m1.1.1.1" xref="Sx3.SSx3.p1.1.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.1.m1.1b"><apply id="Sx3.SSx3.p1.1.m1.1.1.cmml" xref="Sx3.SSx3.p1.1.m1.1.1"><ci id="Sx3.SSx3.p1.1.m1.1.1.1.cmml" xref="Sx3.SSx3.p1.1.m1.1.1.1">~</ci><ci id="Sx3.SSx3.p1.1.m1.1.1.2.cmml" xref="Sx3.SSx3.p1.1.m1.1.1.2">𝐕</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.1.m1.1c">\tilde{\mathbf{V}}</annotation></semantics></math> and the <math id="Sx3.SSx3.p1.2.m2.1" class="ltx_Math" alttext="L" display="inline"><semantics id="Sx3.SSx3.p1.2.m2.1a"><mi id="Sx3.SSx3.p1.2.m2.1.1" xref="Sx3.SSx3.p1.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.2.m2.1b"><ci id="Sx3.SSx3.p1.2.m2.1.1.cmml" xref="Sx3.SSx3.p1.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.2.m2.1c">L</annotation></semantics></math>-layer program tree, program execution performs step-by-step inference from Layer-<math id="Sx3.SSx3.p1.3.m3.1" class="ltx_Math" alttext="1" display="inline"><semantics id="Sx3.SSx3.p1.3.m3.1a"><mn id="Sx3.SSx3.p1.3.m3.1.1" xref="Sx3.SSx3.p1.3.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.3.m3.1b"><cn type="integer" id="Sx3.SSx3.p1.3.m3.1.1.cmml" xref="Sx3.SSx3.p1.3.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.3.m3.1c">1</annotation></semantics></math> to Layer-<math id="Sx3.SSx3.p1.4.m4.1" class="ltx_Math" alttext="L" display="inline"><semantics id="Sx3.SSx3.p1.4.m4.1a"><mi id="Sx3.SSx3.p1.4.m4.1.1" xref="Sx3.SSx3.p1.4.m4.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.4.m4.1b"><ci id="Sx3.SSx3.p1.4.m4.1.1.cmml" xref="Sx3.SSx3.p1.4.m4.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.4.m4.1c">L</annotation></semantics></math> based on image features to get the answer, and all layers share model parameters, making it parameter-efficient and scalable to any number of layers. Specifically, suppose the program tree contains <math id="Sx3.SSx3.p1.5.m5.1" class="ltx_Math" alttext="N" display="inline"><semantics id="Sx3.SSx3.p1.5.m5.1a"><mi id="Sx3.SSx3.p1.5.m5.1.1" xref="Sx3.SSx3.p1.5.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.5.m5.1b"><ci id="Sx3.SSx3.p1.5.m5.1.1.cmml" xref="Sx3.SSx3.p1.5.m5.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.5.m5.1c">N</annotation></semantics></math> nodes, and each node corresponds to a program text (<em id="Sx3.SSx3.p1.6.1" class="ltx_emph ltx_font_italic">e.g.,</em> “Select(giraffe)”, “Select(elephant)”, <em id="Sx3.SSx3.p1.6.2" class="ltx_emph ltx_font_italic">etc.</em>), a state matrix <math id="Sx3.SSx3.p1.6.m6.1" class="ltx_Math" alttext="\mathbf{S}\in\mathbb{R}^{N\times{d_{h}}}" display="inline"><semantics id="Sx3.SSx3.p1.6.m6.1a"><mrow id="Sx3.SSx3.p1.6.m6.1.1" xref="Sx3.SSx3.p1.6.m6.1.1.cmml"><mi id="Sx3.SSx3.p1.6.m6.1.1.2" xref="Sx3.SSx3.p1.6.m6.1.1.2.cmml">𝐒</mi><mo id="Sx3.SSx3.p1.6.m6.1.1.1" xref="Sx3.SSx3.p1.6.m6.1.1.1.cmml">∈</mo><msup id="Sx3.SSx3.p1.6.m6.1.1.3" xref="Sx3.SSx3.p1.6.m6.1.1.3.cmml"><mi id="Sx3.SSx3.p1.6.m6.1.1.3.2" xref="Sx3.SSx3.p1.6.m6.1.1.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx3.p1.6.m6.1.1.3.3" xref="Sx3.SSx3.p1.6.m6.1.1.3.3.cmml"><mi id="Sx3.SSx3.p1.6.m6.1.1.3.3.2" xref="Sx3.SSx3.p1.6.m6.1.1.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="Sx3.SSx3.p1.6.m6.1.1.3.3.1" xref="Sx3.SSx3.p1.6.m6.1.1.3.3.1.cmml">×</mo><msub id="Sx3.SSx3.p1.6.m6.1.1.3.3.3" xref="Sx3.SSx3.p1.6.m6.1.1.3.3.3.cmml"><mi id="Sx3.SSx3.p1.6.m6.1.1.3.3.3.2" xref="Sx3.SSx3.p1.6.m6.1.1.3.3.3.2.cmml">d</mi><mi id="Sx3.SSx3.p1.6.m6.1.1.3.3.3.3" xref="Sx3.SSx3.p1.6.m6.1.1.3.3.3.3.cmml">h</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.6.m6.1b"><apply id="Sx3.SSx3.p1.6.m6.1.1.cmml" xref="Sx3.SSx3.p1.6.m6.1.1"><in id="Sx3.SSx3.p1.6.m6.1.1.1.cmml" xref="Sx3.SSx3.p1.6.m6.1.1.1"></in><ci id="Sx3.SSx3.p1.6.m6.1.1.2.cmml" xref="Sx3.SSx3.p1.6.m6.1.1.2">𝐒</ci><apply id="Sx3.SSx3.p1.6.m6.1.1.3.cmml" xref="Sx3.SSx3.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.6.m6.1.1.3.1.cmml" xref="Sx3.SSx3.p1.6.m6.1.1.3">superscript</csymbol><ci id="Sx3.SSx3.p1.6.m6.1.1.3.2.cmml" xref="Sx3.SSx3.p1.6.m6.1.1.3.2">ℝ</ci><apply id="Sx3.SSx3.p1.6.m6.1.1.3.3.cmml" xref="Sx3.SSx3.p1.6.m6.1.1.3.3"><times id="Sx3.SSx3.p1.6.m6.1.1.3.3.1.cmml" xref="Sx3.SSx3.p1.6.m6.1.1.3.3.1"></times><ci id="Sx3.SSx3.p1.6.m6.1.1.3.3.2.cmml" xref="Sx3.SSx3.p1.6.m6.1.1.3.3.2">𝑁</ci><apply id="Sx3.SSx3.p1.6.m6.1.1.3.3.3.cmml" xref="Sx3.SSx3.p1.6.m6.1.1.3.3.3"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.6.m6.1.1.3.3.3.1.cmml" xref="Sx3.SSx3.p1.6.m6.1.1.3.3.3">subscript</csymbol><ci id="Sx3.SSx3.p1.6.m6.1.1.3.3.3.2.cmml" xref="Sx3.SSx3.p1.6.m6.1.1.3.3.3.2">𝑑</ci><ci id="Sx3.SSx3.p1.6.m6.1.1.3.3.3.3.cmml" xref="Sx3.SSx3.p1.6.m6.1.1.3.3.3.3">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.6.m6.1c">\mathbf{S}\in\mathbb{R}^{N\times{d_{h}}}</annotation></semantics></math> is initialized with the program semantics as follows:</p>
<table id="A4.EGx1" class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table">

<tbody id="Sx3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E3.m1.7" class="ltx_Math" alttext="\displaystyle\begin{aligned} \{\mathbf{e}_{0}^{i},\mathbf{e}_{1}^{i},...,\mathbf{e}_{k}^{i}\}&amp;=\textrm{GloVe}(prog_{i})\\
\mathbf{S}_{i}&amp;=\textrm{FC}(\textrm{Concat}(\{\mathbf{e}_{0}^{i},\mathbf{e}_{1}^{i},...,\mathbf{e}_{l}^{i}\})),\end{aligned}" display="block"><semantics id="Sx3.E3.m1.7a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="Sx3.E3.m1.7.7" xref="Sx3.E3.m1.7.7.cmml"><mtr id="Sx3.E3.m1.7.7a" xref="Sx3.E3.m1.7.7.cmml"><mtd class="ltx_align_right" columnalign="right" id="Sx3.E3.m1.7.7b" xref="Sx3.E3.m1.7.7.cmml"><mrow id="Sx3.E3.m1.4.4.4.4.4.4" xref="Sx3.E3.m1.4.4.4.4.4.5.cmml"><mo stretchy="false" id="Sx3.E3.m1.4.4.4.4.4.4.4" xref="Sx3.E3.m1.4.4.4.4.4.5.cmml">{</mo><msubsup id="Sx3.E3.m1.2.2.2.2.2.2.1" xref="Sx3.E3.m1.2.2.2.2.2.2.1.cmml"><mi id="Sx3.E3.m1.2.2.2.2.2.2.1.2.2" xref="Sx3.E3.m1.2.2.2.2.2.2.1.2.2.cmml">𝐞</mi><mn id="Sx3.E3.m1.2.2.2.2.2.2.1.2.3" xref="Sx3.E3.m1.2.2.2.2.2.2.1.2.3.cmml">0</mn><mi id="Sx3.E3.m1.2.2.2.2.2.2.1.3" xref="Sx3.E3.m1.2.2.2.2.2.2.1.3.cmml">i</mi></msubsup><mo id="Sx3.E3.m1.4.4.4.4.4.4.5" xref="Sx3.E3.m1.4.4.4.4.4.5.cmml">,</mo><msubsup id="Sx3.E3.m1.3.3.3.3.3.3.2" xref="Sx3.E3.m1.3.3.3.3.3.3.2.cmml"><mi id="Sx3.E3.m1.3.3.3.3.3.3.2.2.2" xref="Sx3.E3.m1.3.3.3.3.3.3.2.2.2.cmml">𝐞</mi><mn id="Sx3.E3.m1.3.3.3.3.3.3.2.2.3" xref="Sx3.E3.m1.3.3.3.3.3.3.2.2.3.cmml">1</mn><mi id="Sx3.E3.m1.3.3.3.3.3.3.2.3" xref="Sx3.E3.m1.3.3.3.3.3.3.2.3.cmml">i</mi></msubsup><mo id="Sx3.E3.m1.4.4.4.4.4.4.6" xref="Sx3.E3.m1.4.4.4.4.4.5.cmml">,</mo><mi mathvariant="normal" id="Sx3.E3.m1.1.1.1.1.1.1" xref="Sx3.E3.m1.1.1.1.1.1.1.cmml">…</mi><mo id="Sx3.E3.m1.4.4.4.4.4.4.7" xref="Sx3.E3.m1.4.4.4.4.4.5.cmml">,</mo><msubsup id="Sx3.E3.m1.4.4.4.4.4.4.3" xref="Sx3.E3.m1.4.4.4.4.4.4.3.cmml"><mi id="Sx3.E3.m1.4.4.4.4.4.4.3.2.2" xref="Sx3.E3.m1.4.4.4.4.4.4.3.2.2.cmml">𝐞</mi><mi id="Sx3.E3.m1.4.4.4.4.4.4.3.2.3" xref="Sx3.E3.m1.4.4.4.4.4.4.3.2.3.cmml">k</mi><mi id="Sx3.E3.m1.4.4.4.4.4.4.3.3" xref="Sx3.E3.m1.4.4.4.4.4.4.3.3.cmml">i</mi></msubsup><mo stretchy="false" id="Sx3.E3.m1.4.4.4.4.4.4.8" xref="Sx3.E3.m1.4.4.4.4.4.5.cmml">}</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx3.E3.m1.7.7c" xref="Sx3.E3.m1.7.7.cmml"><mrow id="Sx3.E3.m1.5.5.5.5.1" xref="Sx3.E3.m1.5.5.5.5.1.cmml"><mi id="Sx3.E3.m1.5.5.5.5.1.3" xref="Sx3.E3.m1.5.5.5.5.1.3.cmml"></mi><mo id="Sx3.E3.m1.5.5.5.5.1.2" xref="Sx3.E3.m1.5.5.5.5.1.2.cmml">=</mo><mrow id="Sx3.E3.m1.5.5.5.5.1.1" xref="Sx3.E3.m1.5.5.5.5.1.1.cmml"><mtext id="Sx3.E3.m1.5.5.5.5.1.1.3" xref="Sx3.E3.m1.5.5.5.5.1.1.3a.cmml">GloVe</mtext><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.5.5.5.5.1.1.2" xref="Sx3.E3.m1.5.5.5.5.1.1.2.cmml">​</mo><mrow id="Sx3.E3.m1.5.5.5.5.1.1.1.1" xref="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E3.m1.5.5.5.5.1.1.1.1.2" xref="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E3.m1.5.5.5.5.1.1.1.1.1" xref="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.cmml"><mi id="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.2" xref="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.1" xref="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.1.cmml">​</mo><mi id="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.3" xref="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.1a" xref="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.1.cmml">​</mo><mi id="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.4" xref="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.1b" xref="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.1.cmml">​</mo><msub id="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.5" xref="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.5.cmml"><mi id="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.5.2" xref="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.5.2.cmml">g</mi><mi id="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.5.3" xref="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.5.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="Sx3.E3.m1.5.5.5.5.1.1.1.1.3" xref="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="Sx3.E3.m1.7.7d" xref="Sx3.E3.m1.7.7.cmml"><mtd class="ltx_align_right" columnalign="right" id="Sx3.E3.m1.7.7e" xref="Sx3.E3.m1.7.7.cmml"><msub id="Sx3.E3.m1.7.7.7.3.1" xref="Sx3.E3.m1.7.7.7.3.1.cmml"><mi id="Sx3.E3.m1.7.7.7.3.1.2" xref="Sx3.E3.m1.7.7.7.3.1.2.cmml">𝐒</mi><mi id="Sx3.E3.m1.7.7.7.3.1.3" xref="Sx3.E3.m1.7.7.7.3.1.3.cmml">i</mi></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx3.E3.m1.7.7f" xref="Sx3.E3.m1.7.7.cmml"><mrow id="Sx3.E3.m1.7.7.7.2.2.2" xref="Sx3.E3.m1.7.7.7.2.2.2.1.cmml"><mrow id="Sx3.E3.m1.7.7.7.2.2.2.1" xref="Sx3.E3.m1.7.7.7.2.2.2.1.cmml"><mi id="Sx3.E3.m1.7.7.7.2.2.2.1.3" xref="Sx3.E3.m1.7.7.7.2.2.2.1.3.cmml"></mi><mo id="Sx3.E3.m1.7.7.7.2.2.2.1.2" xref="Sx3.E3.m1.7.7.7.2.2.2.1.2.cmml">=</mo><mrow id="Sx3.E3.m1.7.7.7.2.2.2.1.1" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.cmml"><mtext id="Sx3.E3.m1.7.7.7.2.2.2.1.1.3" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.3a.cmml">FC</mtext><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.7.7.7.2.2.2.1.1.2" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.2.cmml">​</mo><mrow id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.2" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.cmml"><mtext id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.3" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.3a.cmml">Concat</mtext><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.2" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.2" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.4.cmml"><mo stretchy="false" id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3.4" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.4.cmml">{</mo><msubsup id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐞</mi><mn id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.1.1.2.3" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml">0</mn><mi id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3.5" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.4.cmml">,</mo><msubsup id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.2.2" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.2.2.2.2" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml">𝐞</mi><mn id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.2.2.2.3" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.2.2.2.3.cmml">1</mn><mi id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.2.2.3" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msubsup><mo id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3.6" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.4.cmml">,</mo><mi mathvariant="normal" id="Sx3.E3.m1.6.6.6.1.1.1" xref="Sx3.E3.m1.6.6.6.1.1.1.cmml">…</mi><mo id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3.7" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.4.cmml">,</mo><msubsup id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3.3" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3.3.2.2" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3.3.2.2.cmml">𝐞</mi><mi id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3.3.2.3" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3.3.2.3.cmml">l</mi><mi id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3.3.3" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3.3.3.cmml">i</mi></msubsup><mo stretchy="false" id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3.8" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.4.cmml">}</mo></mrow><mo stretchy="false" id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.3" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.3" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="Sx3.E3.m1.7.7.7.2.2.2.2" xref="Sx3.E3.m1.7.7.7.2.2.2.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="Sx3.E3.m1.7b"><matrix id="Sx3.E3.m1.7.7.cmml" xref="Sx3.E3.m1.7.7"><matrixrow id="Sx3.E3.m1.7.7a.cmml" xref="Sx3.E3.m1.7.7"><set id="Sx3.E3.m1.4.4.4.4.4.5.cmml" xref="Sx3.E3.m1.4.4.4.4.4.4"><apply id="Sx3.E3.m1.2.2.2.2.2.2.1.cmml" xref="Sx3.E3.m1.2.2.2.2.2.2.1"><csymbol cd="ambiguous" id="Sx3.E3.m1.2.2.2.2.2.2.1.1.cmml" xref="Sx3.E3.m1.2.2.2.2.2.2.1">superscript</csymbol><apply id="Sx3.E3.m1.2.2.2.2.2.2.1.2.cmml" xref="Sx3.E3.m1.2.2.2.2.2.2.1"><csymbol cd="ambiguous" id="Sx3.E3.m1.2.2.2.2.2.2.1.2.1.cmml" xref="Sx3.E3.m1.2.2.2.2.2.2.1">subscript</csymbol><ci id="Sx3.E3.m1.2.2.2.2.2.2.1.2.2.cmml" xref="Sx3.E3.m1.2.2.2.2.2.2.1.2.2">𝐞</ci><cn type="integer" id="Sx3.E3.m1.2.2.2.2.2.2.1.2.3.cmml" xref="Sx3.E3.m1.2.2.2.2.2.2.1.2.3">0</cn></apply><ci id="Sx3.E3.m1.2.2.2.2.2.2.1.3.cmml" xref="Sx3.E3.m1.2.2.2.2.2.2.1.3">𝑖</ci></apply><apply id="Sx3.E3.m1.3.3.3.3.3.3.2.cmml" xref="Sx3.E3.m1.3.3.3.3.3.3.2"><csymbol cd="ambiguous" id="Sx3.E3.m1.3.3.3.3.3.3.2.1.cmml" xref="Sx3.E3.m1.3.3.3.3.3.3.2">superscript</csymbol><apply id="Sx3.E3.m1.3.3.3.3.3.3.2.2.cmml" xref="Sx3.E3.m1.3.3.3.3.3.3.2"><csymbol cd="ambiguous" id="Sx3.E3.m1.3.3.3.3.3.3.2.2.1.cmml" xref="Sx3.E3.m1.3.3.3.3.3.3.2">subscript</csymbol><ci id="Sx3.E3.m1.3.3.3.3.3.3.2.2.2.cmml" xref="Sx3.E3.m1.3.3.3.3.3.3.2.2.2">𝐞</ci><cn type="integer" id="Sx3.E3.m1.3.3.3.3.3.3.2.2.3.cmml" xref="Sx3.E3.m1.3.3.3.3.3.3.2.2.3">1</cn></apply><ci id="Sx3.E3.m1.3.3.3.3.3.3.2.3.cmml" xref="Sx3.E3.m1.3.3.3.3.3.3.2.3">𝑖</ci></apply><ci id="Sx3.E3.m1.1.1.1.1.1.1.cmml" xref="Sx3.E3.m1.1.1.1.1.1.1">…</ci><apply id="Sx3.E3.m1.4.4.4.4.4.4.3.cmml" xref="Sx3.E3.m1.4.4.4.4.4.4.3"><csymbol cd="ambiguous" id="Sx3.E3.m1.4.4.4.4.4.4.3.1.cmml" xref="Sx3.E3.m1.4.4.4.4.4.4.3">superscript</csymbol><apply id="Sx3.E3.m1.4.4.4.4.4.4.3.2.cmml" xref="Sx3.E3.m1.4.4.4.4.4.4.3"><csymbol cd="ambiguous" id="Sx3.E3.m1.4.4.4.4.4.4.3.2.1.cmml" xref="Sx3.E3.m1.4.4.4.4.4.4.3">subscript</csymbol><ci id="Sx3.E3.m1.4.4.4.4.4.4.3.2.2.cmml" xref="Sx3.E3.m1.4.4.4.4.4.4.3.2.2">𝐞</ci><ci id="Sx3.E3.m1.4.4.4.4.4.4.3.2.3.cmml" xref="Sx3.E3.m1.4.4.4.4.4.4.3.2.3">𝑘</ci></apply><ci id="Sx3.E3.m1.4.4.4.4.4.4.3.3.cmml" xref="Sx3.E3.m1.4.4.4.4.4.4.3.3">𝑖</ci></apply></set><apply id="Sx3.E3.m1.5.5.5.5.1.cmml" xref="Sx3.E3.m1.5.5.5.5.1"><eq id="Sx3.E3.m1.5.5.5.5.1.2.cmml" xref="Sx3.E3.m1.5.5.5.5.1.2"></eq><csymbol cd="latexml" id="Sx3.E3.m1.5.5.5.5.1.3.cmml" xref="Sx3.E3.m1.5.5.5.5.1.3">absent</csymbol><apply id="Sx3.E3.m1.5.5.5.5.1.1.cmml" xref="Sx3.E3.m1.5.5.5.5.1.1"><times id="Sx3.E3.m1.5.5.5.5.1.1.2.cmml" xref="Sx3.E3.m1.5.5.5.5.1.1.2"></times><ci id="Sx3.E3.m1.5.5.5.5.1.1.3a.cmml" xref="Sx3.E3.m1.5.5.5.5.1.1.3"><mtext id="Sx3.E3.m1.5.5.5.5.1.1.3.cmml" xref="Sx3.E3.m1.5.5.5.5.1.1.3">GloVe</mtext></ci><apply id="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.cmml" xref="Sx3.E3.m1.5.5.5.5.1.1.1.1"><times id="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.1.cmml" xref="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.1"></times><ci id="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.2.cmml" xref="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.2">𝑝</ci><ci id="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.3.cmml" xref="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.3">𝑟</ci><ci id="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.4.cmml" xref="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.4">𝑜</ci><apply id="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.5.cmml" xref="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.5"><csymbol cd="ambiguous" id="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.5.1.cmml" xref="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.5">subscript</csymbol><ci id="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.5.2.cmml" xref="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.5.2">𝑔</ci><ci id="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.5.3.cmml" xref="Sx3.E3.m1.5.5.5.5.1.1.1.1.1.5.3">𝑖</ci></apply></apply></apply></apply></matrixrow><matrixrow id="Sx3.E3.m1.7.7b.cmml" xref="Sx3.E3.m1.7.7"><apply id="Sx3.E3.m1.7.7.7.3.1.cmml" xref="Sx3.E3.m1.7.7.7.3.1"><csymbol cd="ambiguous" id="Sx3.E3.m1.7.7.7.3.1.1.cmml" xref="Sx3.E3.m1.7.7.7.3.1">subscript</csymbol><ci id="Sx3.E3.m1.7.7.7.3.1.2.cmml" xref="Sx3.E3.m1.7.7.7.3.1.2">𝐒</ci><ci id="Sx3.E3.m1.7.7.7.3.1.3.cmml" xref="Sx3.E3.m1.7.7.7.3.1.3">𝑖</ci></apply><apply id="Sx3.E3.m1.7.7.7.2.2.2.1.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2"><eq id="Sx3.E3.m1.7.7.7.2.2.2.1.2.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.2"></eq><csymbol cd="latexml" id="Sx3.E3.m1.7.7.7.2.2.2.1.3.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.3">absent</csymbol><apply id="Sx3.E3.m1.7.7.7.2.2.2.1.1.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1"><times id="Sx3.E3.m1.7.7.7.2.2.2.1.1.2.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.2"></times><ci id="Sx3.E3.m1.7.7.7.2.2.2.1.1.3a.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.3"><mtext id="Sx3.E3.m1.7.7.7.2.2.2.1.1.3.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.3">FC</mtext></ci><apply id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1"><times id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.2.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.2"></times><ci id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.3a.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.3"><mtext id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.3.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.3">Concat</mtext></ci><set id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.4.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3"><apply id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.1.1.2.2">𝐞</ci><cn type="integer" id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.1.1.2.3">0</cn></apply><ci id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.2.2.2.2">𝐞</ci><cn type="integer" id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.2.2.2.3">1</cn></apply><ci id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="Sx3.E3.m1.6.6.6.1.1.1.cmml" xref="Sx3.E3.m1.6.6.6.1.1.1">…</ci><apply id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3.3">superscript</csymbol><apply id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3.3.2.2">𝐞</ci><ci id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3.3.2.3">𝑙</ci></apply><ci id="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="Sx3.E3.m1.7.7.7.2.2.2.1.1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></set></apply></apply></apply></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E3.m1.7c">\displaystyle\begin{aligned} \{\mathbf{e}_{0}^{i},\mathbf{e}_{1}^{i},...,\mathbf{e}_{k}^{i}\}&amp;=\textrm{GloVe}(prog_{i})\\
\mathbf{S}_{i}&amp;=\textrm{FC}(\textrm{Concat}(\{\mathbf{e}_{0}^{i},\mathbf{e}_{1}^{i},...,\mathbf{e}_{l}^{i}\})),\end{aligned}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx3.p1.11" class="ltx_p">where <math id="Sx3.SSx3.p1.7.m1.1" class="ltx_Math" alttext="prog_{i}" display="inline"><semantics id="Sx3.SSx3.p1.7.m1.1a"><mrow id="Sx3.SSx3.p1.7.m1.1.1" xref="Sx3.SSx3.p1.7.m1.1.1.cmml"><mi id="Sx3.SSx3.p1.7.m1.1.1.2" xref="Sx3.SSx3.p1.7.m1.1.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p1.7.m1.1.1.1" xref="Sx3.SSx3.p1.7.m1.1.1.1.cmml">​</mo><mi id="Sx3.SSx3.p1.7.m1.1.1.3" xref="Sx3.SSx3.p1.7.m1.1.1.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p1.7.m1.1.1.1a" xref="Sx3.SSx3.p1.7.m1.1.1.1.cmml">​</mo><mi id="Sx3.SSx3.p1.7.m1.1.1.4" xref="Sx3.SSx3.p1.7.m1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p1.7.m1.1.1.1b" xref="Sx3.SSx3.p1.7.m1.1.1.1.cmml">​</mo><msub id="Sx3.SSx3.p1.7.m1.1.1.5" xref="Sx3.SSx3.p1.7.m1.1.1.5.cmml"><mi id="Sx3.SSx3.p1.7.m1.1.1.5.2" xref="Sx3.SSx3.p1.7.m1.1.1.5.2.cmml">g</mi><mi id="Sx3.SSx3.p1.7.m1.1.1.5.3" xref="Sx3.SSx3.p1.7.m1.1.1.5.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.7.m1.1b"><apply id="Sx3.SSx3.p1.7.m1.1.1.cmml" xref="Sx3.SSx3.p1.7.m1.1.1"><times id="Sx3.SSx3.p1.7.m1.1.1.1.cmml" xref="Sx3.SSx3.p1.7.m1.1.1.1"></times><ci id="Sx3.SSx3.p1.7.m1.1.1.2.cmml" xref="Sx3.SSx3.p1.7.m1.1.1.2">𝑝</ci><ci id="Sx3.SSx3.p1.7.m1.1.1.3.cmml" xref="Sx3.SSx3.p1.7.m1.1.1.3">𝑟</ci><ci id="Sx3.SSx3.p1.7.m1.1.1.4.cmml" xref="Sx3.SSx3.p1.7.m1.1.1.4">𝑜</ci><apply id="Sx3.SSx3.p1.7.m1.1.1.5.cmml" xref="Sx3.SSx3.p1.7.m1.1.1.5"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.7.m1.1.1.5.1.cmml" xref="Sx3.SSx3.p1.7.m1.1.1.5">subscript</csymbol><ci id="Sx3.SSx3.p1.7.m1.1.1.5.2.cmml" xref="Sx3.SSx3.p1.7.m1.1.1.5.2">𝑔</ci><ci id="Sx3.SSx3.p1.7.m1.1.1.5.3.cmml" xref="Sx3.SSx3.p1.7.m1.1.1.5.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.7.m1.1c">prog_{i}</annotation></semantics></math> denotes the program text of <math id="Sx3.SSx3.p1.8.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="Sx3.SSx3.p1.8.m2.1a"><mi id="Sx3.SSx3.p1.8.m2.1.1" xref="Sx3.SSx3.p1.8.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.8.m2.1b"><ci id="Sx3.SSx3.p1.8.m2.1.1.cmml" xref="Sx3.SSx3.p1.8.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.8.m2.1c">i</annotation></semantics></math>-th node, and is truncated or padded to fixed length <math id="Sx3.SSx3.p1.9.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="Sx3.SSx3.p1.9.m3.1a"><mi id="Sx3.SSx3.p1.9.m3.1.1" xref="Sx3.SSx3.p1.9.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.9.m3.1b"><ci id="Sx3.SSx3.p1.9.m3.1.1.cmml" xref="Sx3.SSx3.p1.9.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.9.m3.1c">k</annotation></semantics></math>. <span id="Sx3.SSx3.p1.11.1" class="ltx_text ltx_markedasmath">GloVe</span> denotes the GloVe embedding layer <cite class="ltx_cite ltx_citemacro_citep">(Pennington, Socher, and Manning <a href="#bib.bib24" title="" class="ltx_ref">2014</a>)</cite>. In the process of step-by-step inference, the matrix <math id="Sx3.SSx3.p1.11.m5.1" class="ltx_Math" alttext="\mathbf{S}" display="inline"><semantics id="Sx3.SSx3.p1.11.m5.1a"><mi id="Sx3.SSx3.p1.11.m5.1.1" xref="Sx3.SSx3.p1.11.m5.1.1.cmml">𝐒</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.11.m5.1b"><ci id="Sx3.SSx3.p1.11.m5.1.1.cmml" xref="Sx3.SSx3.p1.11.m5.1.1">𝐒</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.11.m5.1c">\mathbf{S}</annotation></semantics></math> implicitly contains the intermediate reasoning states and results, and can be used to decode outputs for our proposed DIS algorithm.</p>
</div>
<div id="Sx3.SSx3.p2" class="ltx_para">
<p id="Sx3.SSx3.p2.4" class="ltx_p">Denote the input state of the <math id="Sx3.SSx3.p2.1.m1.1" class="ltx_Math" alttext="l" display="inline"><semantics id="Sx3.SSx3.p2.1.m1.1a"><mi id="Sx3.SSx3.p2.1.m1.1.1" xref="Sx3.SSx3.p2.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.1.m1.1b"><ci id="Sx3.SSx3.p2.1.m1.1.1.cmml" xref="Sx3.SSx3.p2.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.1.m1.1c">l</annotation></semantics></math>-th layer as <math id="Sx3.SSx3.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{S}^{l-1}" display="inline"><semantics id="Sx3.SSx3.p2.2.m2.1a"><msup id="Sx3.SSx3.p2.2.m2.1.1" xref="Sx3.SSx3.p2.2.m2.1.1.cmml"><mi id="Sx3.SSx3.p2.2.m2.1.1.2" xref="Sx3.SSx3.p2.2.m2.1.1.2.cmml">𝐒</mi><mrow id="Sx3.SSx3.p2.2.m2.1.1.3" xref="Sx3.SSx3.p2.2.m2.1.1.3.cmml"><mi id="Sx3.SSx3.p2.2.m2.1.1.3.2" xref="Sx3.SSx3.p2.2.m2.1.1.3.2.cmml">l</mi><mo id="Sx3.SSx3.p2.2.m2.1.1.3.1" xref="Sx3.SSx3.p2.2.m2.1.1.3.1.cmml">−</mo><mn id="Sx3.SSx3.p2.2.m2.1.1.3.3" xref="Sx3.SSx3.p2.2.m2.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.2.m2.1b"><apply id="Sx3.SSx3.p2.2.m2.1.1.cmml" xref="Sx3.SSx3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.2.m2.1.1.1.cmml" xref="Sx3.SSx3.p2.2.m2.1.1">superscript</csymbol><ci id="Sx3.SSx3.p2.2.m2.1.1.2.cmml" xref="Sx3.SSx3.p2.2.m2.1.1.2">𝐒</ci><apply id="Sx3.SSx3.p2.2.m2.1.1.3.cmml" xref="Sx3.SSx3.p2.2.m2.1.1.3"><minus id="Sx3.SSx3.p2.2.m2.1.1.3.1.cmml" xref="Sx3.SSx3.p2.2.m2.1.1.3.1"></minus><ci id="Sx3.SSx3.p2.2.m2.1.1.3.2.cmml" xref="Sx3.SSx3.p2.2.m2.1.1.3.2">𝑙</ci><cn type="integer" id="Sx3.SSx3.p2.2.m2.1.1.3.3.cmml" xref="Sx3.SSx3.p2.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.2.m2.1c">\mathbf{S}^{l-1}</annotation></semantics></math>, we exploit Transformer framework to obtain the output state <math id="Sx3.SSx3.p2.3.m3.1" class="ltx_Math" alttext="\mathbf{S}^{l}" display="inline"><semantics id="Sx3.SSx3.p2.3.m3.1a"><msup id="Sx3.SSx3.p2.3.m3.1.1" xref="Sx3.SSx3.p2.3.m3.1.1.cmml"><mi id="Sx3.SSx3.p2.3.m3.1.1.2" xref="Sx3.SSx3.p2.3.m3.1.1.2.cmml">𝐒</mi><mi id="Sx3.SSx3.p2.3.m3.1.1.3" xref="Sx3.SSx3.p2.3.m3.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.3.m3.1b"><apply id="Sx3.SSx3.p2.3.m3.1.1.cmml" xref="Sx3.SSx3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.3.m3.1.1.1.cmml" xref="Sx3.SSx3.p2.3.m3.1.1">superscript</csymbol><ci id="Sx3.SSx3.p2.3.m3.1.1.2.cmml" xref="Sx3.SSx3.p2.3.m3.1.1.2">𝐒</ci><ci id="Sx3.SSx3.p2.3.m3.1.1.3.cmml" xref="Sx3.SSx3.p2.3.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.3.m3.1c">\mathbf{S}^{l}</annotation></semantics></math>. Specifically, a masked self-attention layer is firstly exploited to gather dependencies from the state of last layer, and then a guided attention layer is utilized to find visual clues from image features <math id="Sx3.SSx3.p2.4.m4.1" class="ltx_Math" alttext="\tilde{\mathbf{V}}" display="inline"><semantics id="Sx3.SSx3.p2.4.m4.1a"><mover accent="true" id="Sx3.SSx3.p2.4.m4.1.1" xref="Sx3.SSx3.p2.4.m4.1.1.cmml"><mi id="Sx3.SSx3.p2.4.m4.1.1.2" xref="Sx3.SSx3.p2.4.m4.1.1.2.cmml">𝐕</mi><mo id="Sx3.SSx3.p2.4.m4.1.1.1" xref="Sx3.SSx3.p2.4.m4.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.4.m4.1b"><apply id="Sx3.SSx3.p2.4.m4.1.1.cmml" xref="Sx3.SSx3.p2.4.m4.1.1"><ci id="Sx3.SSx3.p2.4.m4.1.1.1.cmml" xref="Sx3.SSx3.p2.4.m4.1.1.1">~</ci><ci id="Sx3.SSx3.p2.4.m4.1.1.2.cmml" xref="Sx3.SSx3.p2.4.m4.1.1.2">𝐕</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.4.m4.1c">\tilde{\mathbf{V}}</annotation></semantics></math>, formulated as follows:</p>
<table id="A4.EGx2" class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table">

<tbody id="Sx3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E4.m1.3" class="ltx_Math" alttext="\displaystyle\begin{aligned} \hat{\mathbf{\mathbf{S}}}^{l-1}&amp;=\textrm{LN}(\mathbf{S}^{l-1}+\textrm{MaskSA}(\mathbf{S}^{l-1},\mathbf{M}^{l}))\\
\mathbf{S}^{l}&amp;=\textrm{LN}(\hat{\mathbf{\mathbf{S}}}^{l-1}+\textrm{GA}(\hat{\mathbf{\mathbf{S}}}^{l-1},\tilde{\mathbf{V}})),\end{aligned}" display="block"><semantics id="Sx3.E4.m1.3a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="Sx3.E4.m1.3.3" xref="Sx3.E4.m1.3.3.cmml"><mtr id="Sx3.E4.m1.3.3a" xref="Sx3.E4.m1.3.3.cmml"><mtd class="ltx_align_right" columnalign="right" id="Sx3.E4.m1.3.3b" xref="Sx3.E4.m1.3.3.cmml"><msup id="Sx3.E4.m1.1.1.1.2.1" xref="Sx3.E4.m1.1.1.1.2.1.cmml"><mover accent="true" id="Sx3.E4.m1.1.1.1.2.1.2" xref="Sx3.E4.m1.1.1.1.2.1.2.cmml"><mi id="Sx3.E4.m1.1.1.1.2.1.2.2" xref="Sx3.E4.m1.1.1.1.2.1.2.2.cmml">𝐒</mi><mo id="Sx3.E4.m1.1.1.1.2.1.2.1" xref="Sx3.E4.m1.1.1.1.2.1.2.1.cmml">^</mo></mover><mrow id="Sx3.E4.m1.1.1.1.2.1.3" xref="Sx3.E4.m1.1.1.1.2.1.3.cmml"><mi id="Sx3.E4.m1.1.1.1.2.1.3.2" xref="Sx3.E4.m1.1.1.1.2.1.3.2.cmml">l</mi><mo id="Sx3.E4.m1.1.1.1.2.1.3.1" xref="Sx3.E4.m1.1.1.1.2.1.3.1.cmml">−</mo><mn id="Sx3.E4.m1.1.1.1.2.1.3.3" xref="Sx3.E4.m1.1.1.1.2.1.3.3.cmml">1</mn></mrow></msup></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx3.E4.m1.3.3c" xref="Sx3.E4.m1.3.3.cmml"><mrow id="Sx3.E4.m1.1.1.1.1.1" xref="Sx3.E4.m1.1.1.1.1.1.cmml"><mi id="Sx3.E4.m1.1.1.1.1.1.3" xref="Sx3.E4.m1.1.1.1.1.1.3.cmml"></mi><mo id="Sx3.E4.m1.1.1.1.1.1.2" xref="Sx3.E4.m1.1.1.1.1.1.2.cmml">=</mo><mrow id="Sx3.E4.m1.1.1.1.1.1.1" xref="Sx3.E4.m1.1.1.1.1.1.1.cmml"><mtext id="Sx3.E4.m1.1.1.1.1.1.1.3" xref="Sx3.E4.m1.1.1.1.1.1.1.3a.cmml">LN</mtext><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.1.1.1.1.1.1.2" xref="Sx3.E4.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E4.m1.1.1.1.1.1.1.1.1" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E4.m1.1.1.1.1.1.1.1.1.2" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><msup id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.4" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.4.2" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.4.2.cmml">𝐒</mi><mrow id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.4.3" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.4.3.cmml"><mi id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.4.3.2" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.4.3.2.cmml">l</mi><mo id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.4.3.1" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.4.3.1.cmml">−</mo><mn id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.4.3.3" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.4.3.3.cmml">1</mn></mrow></msup><mo id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml">+</mo><mrow id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mtext id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.4" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.4a.cmml">MaskSA</mtext><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">(</mo><msup id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐒</mi><mrow id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msup><mo id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.4" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msup id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">𝐌</mi><mi id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">l</mi></msup><mo stretchy="false" id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.5" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="Sx3.E4.m1.1.1.1.1.1.1.1.1.3" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="Sx3.E4.m1.3.3d" xref="Sx3.E4.m1.3.3.cmml"><mtd class="ltx_align_right" columnalign="right" id="Sx3.E4.m1.3.3e" xref="Sx3.E4.m1.3.3.cmml"><msup id="Sx3.E4.m1.3.3.3.3.1" xref="Sx3.E4.m1.3.3.3.3.1.cmml"><mi id="Sx3.E4.m1.3.3.3.3.1.2" xref="Sx3.E4.m1.3.3.3.3.1.2.cmml">𝐒</mi><mi id="Sx3.E4.m1.3.3.3.3.1.3" xref="Sx3.E4.m1.3.3.3.3.1.3.cmml">l</mi></msup></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx3.E4.m1.3.3f" xref="Sx3.E4.m1.3.3.cmml"><mrow id="Sx3.E4.m1.3.3.3.2.2.2" xref="Sx3.E4.m1.3.3.3.2.2.2.1.cmml"><mrow id="Sx3.E4.m1.3.3.3.2.2.2.1" xref="Sx3.E4.m1.3.3.3.2.2.2.1.cmml"><mi id="Sx3.E4.m1.3.3.3.2.2.2.1.3" xref="Sx3.E4.m1.3.3.3.2.2.2.1.3.cmml"></mi><mo id="Sx3.E4.m1.3.3.3.2.2.2.1.2" xref="Sx3.E4.m1.3.3.3.2.2.2.1.2.cmml">=</mo><mrow id="Sx3.E4.m1.3.3.3.2.2.2.1.1" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.cmml"><mtext id="Sx3.E4.m1.3.3.3.2.2.2.1.1.3" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.3a.cmml">LN</mtext><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.3.3.3.2.2.2.1.1.2" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.2.cmml">​</mo><mrow id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.2" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.cmml"><msup id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.cmml"><mover accent="true" id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.2" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.2.cmml"><mi id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.2.2" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.2.2.cmml">𝐒</mi><mo id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.2.1" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mrow id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.3" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.3.cmml"><mi id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.3.2" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.3.2.cmml">l</mi><mo id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.3.1" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.3.3" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msup><mo id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.2" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.2.cmml">+</mo><mrow id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.cmml"><mtext id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.3" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.3a.cmml">GA</mtext><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.2" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.2" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.2.cmml">(</mo><msup id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐒</mi><mo id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.2.1" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.3.1" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msup><mo id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.3" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.2.cmml">,</mo><mover accent="true" id="Sx3.E4.m1.2.2.2.1.1.1" xref="Sx3.E4.m1.2.2.2.1.1.1.cmml"><mi id="Sx3.E4.m1.2.2.2.1.1.1.2" xref="Sx3.E4.m1.2.2.2.1.1.1.2.cmml">𝐕</mi><mo id="Sx3.E4.m1.2.2.2.1.1.1.1" xref="Sx3.E4.m1.2.2.2.1.1.1.1.cmml">~</mo></mover><mo stretchy="false" id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.4" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.3" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="Sx3.E4.m1.3.3.3.2.2.2.2" xref="Sx3.E4.m1.3.3.3.2.2.2.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="Sx3.E4.m1.3b"><matrix id="Sx3.E4.m1.3.3.cmml" xref="Sx3.E4.m1.3.3"><matrixrow id="Sx3.E4.m1.3.3a.cmml" xref="Sx3.E4.m1.3.3"><apply id="Sx3.E4.m1.1.1.1.2.1.cmml" xref="Sx3.E4.m1.1.1.1.2.1"><csymbol cd="ambiguous" id="Sx3.E4.m1.1.1.1.2.1.1.cmml" xref="Sx3.E4.m1.1.1.1.2.1">superscript</csymbol><apply id="Sx3.E4.m1.1.1.1.2.1.2.cmml" xref="Sx3.E4.m1.1.1.1.2.1.2"><ci id="Sx3.E4.m1.1.1.1.2.1.2.1.cmml" xref="Sx3.E4.m1.1.1.1.2.1.2.1">^</ci><ci id="Sx3.E4.m1.1.1.1.2.1.2.2.cmml" xref="Sx3.E4.m1.1.1.1.2.1.2.2">𝐒</ci></apply><apply id="Sx3.E4.m1.1.1.1.2.1.3.cmml" xref="Sx3.E4.m1.1.1.1.2.1.3"><minus id="Sx3.E4.m1.1.1.1.2.1.3.1.cmml" xref="Sx3.E4.m1.1.1.1.2.1.3.1"></minus><ci id="Sx3.E4.m1.1.1.1.2.1.3.2.cmml" xref="Sx3.E4.m1.1.1.1.2.1.3.2">𝑙</ci><cn type="integer" id="Sx3.E4.m1.1.1.1.2.1.3.3.cmml" xref="Sx3.E4.m1.1.1.1.2.1.3.3">1</cn></apply></apply><apply id="Sx3.E4.m1.1.1.1.1.1.cmml" xref="Sx3.E4.m1.1.1.1.1.1"><eq id="Sx3.E4.m1.1.1.1.1.1.2.cmml" xref="Sx3.E4.m1.1.1.1.1.1.2"></eq><csymbol cd="latexml" id="Sx3.E4.m1.1.1.1.1.1.3.cmml" xref="Sx3.E4.m1.1.1.1.1.1.3">absent</csymbol><apply id="Sx3.E4.m1.1.1.1.1.1.1.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1"><times id="Sx3.E4.m1.1.1.1.1.1.1.2.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.2"></times><ci id="Sx3.E4.m1.1.1.1.1.1.1.3a.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.3"><mtext id="Sx3.E4.m1.1.1.1.1.1.1.3.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.3">LN</mtext></ci><apply id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1"><plus id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.3"></plus><apply id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.4.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.4.2">𝐒</ci><apply id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.4.3"><minus id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.4.3.1.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.4.3.1"></minus><ci id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.4.3.2.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.4.3.2">𝑙</ci><cn type="integer" id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.4.3.3.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.4.3.3">1</cn></apply></apply><apply id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2"><times id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.3"></times><ci id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.4a.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.4"><mtext id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.4.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.4">MaskSA</mtext></ci><interval closure="open" id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2"><apply id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐒</ci><apply id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><minus id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑙</ci><cn type="integer" id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2">𝐌</ci><ci id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.3">𝑙</ci></apply></interval></apply></apply></apply></apply></matrixrow><matrixrow id="Sx3.E4.m1.3.3b.cmml" xref="Sx3.E4.m1.3.3"><apply id="Sx3.E4.m1.3.3.3.3.1.cmml" xref="Sx3.E4.m1.3.3.3.3.1"><csymbol cd="ambiguous" id="Sx3.E4.m1.3.3.3.3.1.1.cmml" xref="Sx3.E4.m1.3.3.3.3.1">superscript</csymbol><ci id="Sx3.E4.m1.3.3.3.3.1.2.cmml" xref="Sx3.E4.m1.3.3.3.3.1.2">𝐒</ci><ci id="Sx3.E4.m1.3.3.3.3.1.3.cmml" xref="Sx3.E4.m1.3.3.3.3.1.3">𝑙</ci></apply><apply id="Sx3.E4.m1.3.3.3.2.2.2.1.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2"><eq id="Sx3.E4.m1.3.3.3.2.2.2.1.2.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.2"></eq><csymbol cd="latexml" id="Sx3.E4.m1.3.3.3.2.2.2.1.3.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.3">absent</csymbol><apply id="Sx3.E4.m1.3.3.3.2.2.2.1.1.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1"><times id="Sx3.E4.m1.3.3.3.2.2.2.1.1.2.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.2"></times><ci id="Sx3.E4.m1.3.3.3.2.2.2.1.1.3a.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.3"><mtext id="Sx3.E4.m1.3.3.3.2.2.2.1.1.3.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.3">LN</mtext></ci><apply id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1"><plus id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.2.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.2"></plus><apply id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.1.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3">superscript</csymbol><apply id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.2.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.2"><ci id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.2.1.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.2.1">^</ci><ci id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.2.2.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.2.2">𝐒</ci></apply><apply id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.3.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.3"><minus id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.3.1.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.3.1"></minus><ci id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.3.2.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.3.2">𝑙</ci><cn type="integer" id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.3.3.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1"><times id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.2.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.2"></times><ci id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.3a.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.3"><mtext id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.3.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.3">GA</mtext></ci><interval closure="open" id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1"><apply id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.2"><ci id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.2.2">𝐒</ci></apply><apply id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.3"><minus id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.3.2">𝑙</ci><cn type="integer" id="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E4.m1.3.3.3.2.2.2.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="Sx3.E4.m1.2.2.2.1.1.1.cmml" xref="Sx3.E4.m1.2.2.2.1.1.1"><ci id="Sx3.E4.m1.2.2.2.1.1.1.1.cmml" xref="Sx3.E4.m1.2.2.2.1.1.1.1">~</ci><ci id="Sx3.E4.m1.2.2.2.1.1.1.2.cmml" xref="Sx3.E4.m1.2.2.2.1.1.1.2">𝐕</ci></apply></interval></apply></apply></apply></apply></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E4.m1.3c">\displaystyle\begin{aligned} \hat{\mathbf{\mathbf{S}}}^{l-1}&amp;=\textrm{LN}(\mathbf{S}^{l-1}+\textrm{MaskSA}(\mathbf{S}^{l-1},\mathbf{M}^{l}))\\
\mathbf{S}^{l}&amp;=\textrm{LN}(\hat{\mathbf{\mathbf{S}}}^{l-1}+\textrm{GA}(\hat{\mathbf{\mathbf{S}}}^{l-1},\tilde{\mathbf{V}})),\end{aligned}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx3.p2.7" class="ltx_p">where <math id="Sx3.SSx3.p2.5.m1.2" class="ltx_Math" alttext="\textrm{MaskSA},\textrm{GA}" display="inline"><semantics id="Sx3.SSx3.p2.5.m1.2a"><mrow id="Sx3.SSx3.p2.5.m1.2.3.2" xref="Sx3.SSx3.p2.5.m1.2.3.1.cmml"><mtext id="Sx3.SSx3.p2.5.m1.1.1" xref="Sx3.SSx3.p2.5.m1.1.1a.cmml">MaskSA</mtext><mo id="Sx3.SSx3.p2.5.m1.2.3.2.1" xref="Sx3.SSx3.p2.5.m1.2.3.1.cmml">,</mo><mtext id="Sx3.SSx3.p2.5.m1.2.2" xref="Sx3.SSx3.p2.5.m1.2.2a.cmml">GA</mtext></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.5.m1.2b"><list id="Sx3.SSx3.p2.5.m1.2.3.1.cmml" xref="Sx3.SSx3.p2.5.m1.2.3.2"><ci id="Sx3.SSx3.p2.5.m1.1.1a.cmml" xref="Sx3.SSx3.p2.5.m1.1.1"><mtext id="Sx3.SSx3.p2.5.m1.1.1.cmml" xref="Sx3.SSx3.p2.5.m1.1.1">MaskSA</mtext></ci><ci id="Sx3.SSx3.p2.5.m1.2.2a.cmml" xref="Sx3.SSx3.p2.5.m1.2.2"><mtext id="Sx3.SSx3.p2.5.m1.2.2.cmml" xref="Sx3.SSx3.p2.5.m1.2.2">GA</mtext></ci></list></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.5.m1.2c">\textrm{MaskSA},\textrm{GA}</annotation></semantics></math> denote mask self-attention and guided attention layer, respectively. <span id="Sx3.SSx3.p2.7.1" class="ltx_text ltx_markedasmath">MaskSA</span> uses weight matrix <math id="Sx3.SSx3.p2.7.m3.1" class="ltx_Math" alttext="\mathbf{M}^{l}" display="inline"><semantics id="Sx3.SSx3.p2.7.m3.1a"><msup id="Sx3.SSx3.p2.7.m3.1.1" xref="Sx3.SSx3.p2.7.m3.1.1.cmml"><mi id="Sx3.SSx3.p2.7.m3.1.1.2" xref="Sx3.SSx3.p2.7.m3.1.1.2.cmml">𝐌</mi><mi id="Sx3.SSx3.p2.7.m3.1.1.3" xref="Sx3.SSx3.p2.7.m3.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.7.m3.1b"><apply id="Sx3.SSx3.p2.7.m3.1.1.cmml" xref="Sx3.SSx3.p2.7.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.7.m3.1.1.1.cmml" xref="Sx3.SSx3.p2.7.m3.1.1">superscript</csymbol><ci id="Sx3.SSx3.p2.7.m3.1.1.2.cmml" xref="Sx3.SSx3.p2.7.m3.1.1.2">𝐌</ci><ci id="Sx3.SSx3.p2.7.m3.1.1.3.cmml" xref="Sx3.SSx3.p2.7.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.7.m3.1c">\mathbf{M}^{l}</annotation></semantics></math> to mask non-dependent nodes, formulated as follows:</p>
<table id="A4.EGx3" class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table">

<tbody id="Sx3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E5.m1.5" class="ltx_Math" alttext="\displaystyle\begin{aligned} \textrm{MaskSA}(\mathbf{S},\mathbf{M})&amp;=\textrm{Softmax}(\frac{(\mathbf{Q}^{S})(\mathbf{K}^{S})^{T}}{\sqrt{d_{h}}}+\mathbf{M})\mathbf{V}^{S},\end{aligned}" display="block"><semantics id="Sx3.E5.m1.5a"><mtable columnspacing="0pt" displaystyle="true" id="Sx3.E5.m1.5.5" xref="Sx3.E5.m1.5.5.cmml"><mtr id="Sx3.E5.m1.5.5a" xref="Sx3.E5.m1.5.5.cmml"><mtd class="ltx_align_right" columnalign="right" id="Sx3.E5.m1.5.5b" xref="Sx3.E5.m1.5.5.cmml"><mrow id="Sx3.E5.m1.2.2.2.2.2" xref="Sx3.E5.m1.2.2.2.2.2.cmml"><mtext id="Sx3.E5.m1.2.2.2.2.2.4" xref="Sx3.E5.m1.2.2.2.2.2.4a.cmml">MaskSA</mtext><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.2.2.2.2.2.3" xref="Sx3.E5.m1.2.2.2.2.2.3.cmml">​</mo><mrow id="Sx3.E5.m1.2.2.2.2.2.5.2" xref="Sx3.E5.m1.2.2.2.2.2.5.1.cmml"><mo stretchy="false" id="Sx3.E5.m1.2.2.2.2.2.5.2.1" xref="Sx3.E5.m1.2.2.2.2.2.5.1.cmml">(</mo><mi id="Sx3.E5.m1.1.1.1.1.1.1" xref="Sx3.E5.m1.1.1.1.1.1.1.cmml">𝐒</mi><mo id="Sx3.E5.m1.2.2.2.2.2.5.2.2" xref="Sx3.E5.m1.2.2.2.2.2.5.1.cmml">,</mo><mi id="Sx3.E5.m1.2.2.2.2.2.2" xref="Sx3.E5.m1.2.2.2.2.2.2.cmml">𝐌</mi><mo stretchy="false" id="Sx3.E5.m1.2.2.2.2.2.5.2.3" xref="Sx3.E5.m1.2.2.2.2.2.5.1.cmml">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx3.E5.m1.5.5c" xref="Sx3.E5.m1.5.5.cmml"><mrow id="Sx3.E5.m1.5.5.5.5.3.3" xref="Sx3.E5.m1.5.5.5.5.3.3.1.cmml"><mrow id="Sx3.E5.m1.5.5.5.5.3.3.1" xref="Sx3.E5.m1.5.5.5.5.3.3.1.cmml"><mi id="Sx3.E5.m1.5.5.5.5.3.3.1.3" xref="Sx3.E5.m1.5.5.5.5.3.3.1.3.cmml"></mi><mo id="Sx3.E5.m1.5.5.5.5.3.3.1.2" xref="Sx3.E5.m1.5.5.5.5.3.3.1.2.cmml">=</mo><mrow id="Sx3.E5.m1.5.5.5.5.3.3.1.1" xref="Sx3.E5.m1.5.5.5.5.3.3.1.1.cmml"><mtext id="Sx3.E5.m1.5.5.5.5.3.3.1.1.3" xref="Sx3.E5.m1.5.5.5.5.3.3.1.1.3a.cmml">Softmax</mtext><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.5.5.5.5.3.3.1.1.2" xref="Sx3.E5.m1.5.5.5.5.3.3.1.1.2.cmml">​</mo><mrow id="Sx3.E5.m1.5.5.5.5.3.3.1.1.1.1" xref="Sx3.E5.m1.5.5.5.5.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E5.m1.5.5.5.5.3.3.1.1.1.1.2" xref="Sx3.E5.m1.5.5.5.5.3.3.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E5.m1.5.5.5.5.3.3.1.1.1.1.1" xref="Sx3.E5.m1.5.5.5.5.3.3.1.1.1.1.1.cmml"><mfrac id="Sx3.E5.m1.4.4.4.4.2.2" xref="Sx3.E5.m1.4.4.4.4.2.2.cmml"><mrow id="Sx3.E5.m1.4.4.4.4.2.2.2" xref="Sx3.E5.m1.4.4.4.4.2.2.2.cmml"><mrow id="Sx3.E5.m1.3.3.3.3.1.1.1.1.1" xref="Sx3.E5.m1.3.3.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E5.m1.3.3.3.3.1.1.1.1.1.2" xref="Sx3.E5.m1.3.3.3.3.1.1.1.1.1.1.cmml">(</mo><msup id="Sx3.E5.m1.3.3.3.3.1.1.1.1.1.1" xref="Sx3.E5.m1.3.3.3.3.1.1.1.1.1.1.cmml"><mi id="Sx3.E5.m1.3.3.3.3.1.1.1.1.1.1.2" xref="Sx3.E5.m1.3.3.3.3.1.1.1.1.1.1.2.cmml">𝐐</mi><mi id="Sx3.E5.m1.3.3.3.3.1.1.1.1.1.1.3" xref="Sx3.E5.m1.3.3.3.3.1.1.1.1.1.1.3.cmml">S</mi></msup><mo stretchy="false" id="Sx3.E5.m1.3.3.3.3.1.1.1.1.1.3" xref="Sx3.E5.m1.3.3.3.3.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.4.4.4.4.2.2.2.3" xref="Sx3.E5.m1.4.4.4.4.2.2.2.3.cmml">​</mo><msup id="Sx3.E5.m1.4.4.4.4.2.2.2.2" xref="Sx3.E5.m1.4.4.4.4.2.2.2.2.cmml"><mrow id="Sx3.E5.m1.4.4.4.4.2.2.2.2.1.1" xref="Sx3.E5.m1.4.4.4.4.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="Sx3.E5.m1.4.4.4.4.2.2.2.2.1.1.2" xref="Sx3.E5.m1.4.4.4.4.2.2.2.2.1.1.1.cmml">(</mo><msup id="Sx3.E5.m1.4.4.4.4.2.2.2.2.1.1.1" xref="Sx3.E5.m1.4.4.4.4.2.2.2.2.1.1.1.cmml"><mi id="Sx3.E5.m1.4.4.4.4.2.2.2.2.1.1.1.2" xref="Sx3.E5.m1.4.4.4.4.2.2.2.2.1.1.1.2.cmml">𝐊</mi><mi id="Sx3.E5.m1.4.4.4.4.2.2.2.2.1.1.1.3" xref="Sx3.E5.m1.4.4.4.4.2.2.2.2.1.1.1.3.cmml">S</mi></msup><mo stretchy="false" id="Sx3.E5.m1.4.4.4.4.2.2.2.2.1.1.3" xref="Sx3.E5.m1.4.4.4.4.2.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="Sx3.E5.m1.4.4.4.4.2.2.2.2.3" xref="Sx3.E5.m1.4.4.4.4.2.2.2.2.3.cmml">T</mi></msup></mrow><msqrt id="Sx3.E5.m1.4.4.4.4.2.2.4" xref="Sx3.E5.m1.4.4.4.4.2.2.4.cmml"><msub id="Sx3.E5.m1.4.4.4.4.2.2.4.2" xref="Sx3.E5.m1.4.4.4.4.2.2.4.2.cmml"><mi id="Sx3.E5.m1.4.4.4.4.2.2.4.2.2" xref="Sx3.E5.m1.4.4.4.4.2.2.4.2.2.cmml">d</mi><mi id="Sx3.E5.m1.4.4.4.4.2.2.4.2.3" xref="Sx3.E5.m1.4.4.4.4.2.2.4.2.3.cmml">h</mi></msub></msqrt></mfrac><mo id="Sx3.E5.m1.5.5.5.5.3.3.1.1.1.1.1.1" xref="Sx3.E5.m1.5.5.5.5.3.3.1.1.1.1.1.1.cmml">+</mo><mi id="Sx3.E5.m1.5.5.5.5.3.3.1.1.1.1.1.2" xref="Sx3.E5.m1.5.5.5.5.3.3.1.1.1.1.1.2.cmml">𝐌</mi></mrow><mo stretchy="false" id="Sx3.E5.m1.5.5.5.5.3.3.1.1.1.1.3" xref="Sx3.E5.m1.5.5.5.5.3.3.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.5.5.5.5.3.3.1.1.2a" xref="Sx3.E5.m1.5.5.5.5.3.3.1.1.2.cmml">​</mo><msup id="Sx3.E5.m1.5.5.5.5.3.3.1.1.4" xref="Sx3.E5.m1.5.5.5.5.3.3.1.1.4.cmml"><mi id="Sx3.E5.m1.5.5.5.5.3.3.1.1.4.2" xref="Sx3.E5.m1.5.5.5.5.3.3.1.1.4.2.cmml">𝐕</mi><mi id="Sx3.E5.m1.5.5.5.5.3.3.1.1.4.3" xref="Sx3.E5.m1.5.5.5.5.3.3.1.1.4.3.cmml">S</mi></msup></mrow></mrow><mo id="Sx3.E5.m1.5.5.5.5.3.3.2" xref="Sx3.E5.m1.5.5.5.5.3.3.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="Sx3.E5.m1.5b"><matrix id="Sx3.E5.m1.5.5.cmml" xref="Sx3.E5.m1.5.5"><matrixrow id="Sx3.E5.m1.5.5a.cmml" xref="Sx3.E5.m1.5.5"><apply id="Sx3.E5.m1.2.2.2.2.2.cmml" xref="Sx3.E5.m1.2.2.2.2.2"><times id="Sx3.E5.m1.2.2.2.2.2.3.cmml" xref="Sx3.E5.m1.2.2.2.2.2.3"></times><ci id="Sx3.E5.m1.2.2.2.2.2.4a.cmml" xref="Sx3.E5.m1.2.2.2.2.2.4"><mtext id="Sx3.E5.m1.2.2.2.2.2.4.cmml" xref="Sx3.E5.m1.2.2.2.2.2.4">MaskSA</mtext></ci><interval closure="open" id="Sx3.E5.m1.2.2.2.2.2.5.1.cmml" xref="Sx3.E5.m1.2.2.2.2.2.5.2"><ci id="Sx3.E5.m1.1.1.1.1.1.1.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1">𝐒</ci><ci id="Sx3.E5.m1.2.2.2.2.2.2.cmml" xref="Sx3.E5.m1.2.2.2.2.2.2">𝐌</ci></interval></apply><apply id="Sx3.E5.m1.5.5.5.5.3.3.1.cmml" xref="Sx3.E5.m1.5.5.5.5.3.3"><eq id="Sx3.E5.m1.5.5.5.5.3.3.1.2.cmml" xref="Sx3.E5.m1.5.5.5.5.3.3.1.2"></eq><csymbol cd="latexml" id="Sx3.E5.m1.5.5.5.5.3.3.1.3.cmml" xref="Sx3.E5.m1.5.5.5.5.3.3.1.3">absent</csymbol><apply id="Sx3.E5.m1.5.5.5.5.3.3.1.1.cmml" xref="Sx3.E5.m1.5.5.5.5.3.3.1.1"><times id="Sx3.E5.m1.5.5.5.5.3.3.1.1.2.cmml" xref="Sx3.E5.m1.5.5.5.5.3.3.1.1.2"></times><ci id="Sx3.E5.m1.5.5.5.5.3.3.1.1.3a.cmml" xref="Sx3.E5.m1.5.5.5.5.3.3.1.1.3"><mtext id="Sx3.E5.m1.5.5.5.5.3.3.1.1.3.cmml" xref="Sx3.E5.m1.5.5.5.5.3.3.1.1.3">Softmax</mtext></ci><apply id="Sx3.E5.m1.5.5.5.5.3.3.1.1.1.1.1.cmml" xref="Sx3.E5.m1.5.5.5.5.3.3.1.1.1.1"><plus id="Sx3.E5.m1.5.5.5.5.3.3.1.1.1.1.1.1.cmml" xref="Sx3.E5.m1.5.5.5.5.3.3.1.1.1.1.1.1"></plus><apply id="Sx3.E5.m1.4.4.4.4.2.2.cmml" xref="Sx3.E5.m1.4.4.4.4.2.2"><divide id="Sx3.E5.m1.4.4.4.4.2.2.3.cmml" xref="Sx3.E5.m1.4.4.4.4.2.2"></divide><apply id="Sx3.E5.m1.4.4.4.4.2.2.2.cmml" xref="Sx3.E5.m1.4.4.4.4.2.2.2"><times id="Sx3.E5.m1.4.4.4.4.2.2.2.3.cmml" xref="Sx3.E5.m1.4.4.4.4.2.2.2.3"></times><apply id="Sx3.E5.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="Sx3.E5.m1.3.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="Sx3.E5.m1.3.3.3.3.1.1.1.1.1">superscript</csymbol><ci id="Sx3.E5.m1.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="Sx3.E5.m1.3.3.3.3.1.1.1.1.1.1.2">𝐐</ci><ci id="Sx3.E5.m1.3.3.3.3.1.1.1.1.1.1.3.cmml" xref="Sx3.E5.m1.3.3.3.3.1.1.1.1.1.1.3">𝑆</ci></apply><apply id="Sx3.E5.m1.4.4.4.4.2.2.2.2.cmml" xref="Sx3.E5.m1.4.4.4.4.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.E5.m1.4.4.4.4.2.2.2.2.2.cmml" xref="Sx3.E5.m1.4.4.4.4.2.2.2.2">superscript</csymbol><apply id="Sx3.E5.m1.4.4.4.4.2.2.2.2.1.1.1.cmml" xref="Sx3.E5.m1.4.4.4.4.2.2.2.2.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.4.4.4.4.2.2.2.2.1.1.1.1.cmml" xref="Sx3.E5.m1.4.4.4.4.2.2.2.2.1.1">superscript</csymbol><ci id="Sx3.E5.m1.4.4.4.4.2.2.2.2.1.1.1.2.cmml" xref="Sx3.E5.m1.4.4.4.4.2.2.2.2.1.1.1.2">𝐊</ci><ci id="Sx3.E5.m1.4.4.4.4.2.2.2.2.1.1.1.3.cmml" xref="Sx3.E5.m1.4.4.4.4.2.2.2.2.1.1.1.3">𝑆</ci></apply><ci id="Sx3.E5.m1.4.4.4.4.2.2.2.2.3.cmml" xref="Sx3.E5.m1.4.4.4.4.2.2.2.2.3">𝑇</ci></apply></apply><apply id="Sx3.E5.m1.4.4.4.4.2.2.4.cmml" xref="Sx3.E5.m1.4.4.4.4.2.2.4"><root id="Sx3.E5.m1.4.4.4.4.2.2.4a.cmml" xref="Sx3.E5.m1.4.4.4.4.2.2.4"></root><apply id="Sx3.E5.m1.4.4.4.4.2.2.4.2.cmml" xref="Sx3.E5.m1.4.4.4.4.2.2.4.2"><csymbol cd="ambiguous" id="Sx3.E5.m1.4.4.4.4.2.2.4.2.1.cmml" xref="Sx3.E5.m1.4.4.4.4.2.2.4.2">subscript</csymbol><ci id="Sx3.E5.m1.4.4.4.4.2.2.4.2.2.cmml" xref="Sx3.E5.m1.4.4.4.4.2.2.4.2.2">𝑑</ci><ci id="Sx3.E5.m1.4.4.4.4.2.2.4.2.3.cmml" xref="Sx3.E5.m1.4.4.4.4.2.2.4.2.3">ℎ</ci></apply></apply></apply><ci id="Sx3.E5.m1.5.5.5.5.3.3.1.1.1.1.1.2.cmml" xref="Sx3.E5.m1.5.5.5.5.3.3.1.1.1.1.1.2">𝐌</ci></apply><apply id="Sx3.E5.m1.5.5.5.5.3.3.1.1.4.cmml" xref="Sx3.E5.m1.5.5.5.5.3.3.1.1.4"><csymbol cd="ambiguous" id="Sx3.E5.m1.5.5.5.5.3.3.1.1.4.1.cmml" xref="Sx3.E5.m1.5.5.5.5.3.3.1.1.4">superscript</csymbol><ci id="Sx3.E5.m1.5.5.5.5.3.3.1.1.4.2.cmml" xref="Sx3.E5.m1.5.5.5.5.3.3.1.1.4.2">𝐕</ci><ci id="Sx3.E5.m1.5.5.5.5.3.3.1.1.4.3.cmml" xref="Sx3.E5.m1.5.5.5.5.3.3.1.1.4.3">𝑆</ci></apply></apply></apply></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E5.m1.5c">\displaystyle\begin{aligned} \textrm{MaskSA}(\mathbf{S},\mathbf{M})&amp;=\textrm{Softmax}(\frac{(\mathbf{Q}^{S})(\mathbf{K}^{S})^{T}}{\sqrt{d_{h}}}+\mathbf{M})\mathbf{V}^{S},\end{aligned}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx3.p2.14" class="ltx_p">where <math id="Sx3.SSx3.p2.8.m1.1" class="ltx_Math" alttext="\mathbf{M}\in\mathbb{R}^{N\times{N}}" display="inline"><semantics id="Sx3.SSx3.p2.8.m1.1a"><mrow id="Sx3.SSx3.p2.8.m1.1.1" xref="Sx3.SSx3.p2.8.m1.1.1.cmml"><mi id="Sx3.SSx3.p2.8.m1.1.1.2" xref="Sx3.SSx3.p2.8.m1.1.1.2.cmml">𝐌</mi><mo id="Sx3.SSx3.p2.8.m1.1.1.1" xref="Sx3.SSx3.p2.8.m1.1.1.1.cmml">∈</mo><msup id="Sx3.SSx3.p2.8.m1.1.1.3" xref="Sx3.SSx3.p2.8.m1.1.1.3.cmml"><mi id="Sx3.SSx3.p2.8.m1.1.1.3.2" xref="Sx3.SSx3.p2.8.m1.1.1.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx3.p2.8.m1.1.1.3.3" xref="Sx3.SSx3.p2.8.m1.1.1.3.3.cmml"><mi id="Sx3.SSx3.p2.8.m1.1.1.3.3.2" xref="Sx3.SSx3.p2.8.m1.1.1.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="Sx3.SSx3.p2.8.m1.1.1.3.3.1" xref="Sx3.SSx3.p2.8.m1.1.1.3.3.1.cmml">×</mo><mi id="Sx3.SSx3.p2.8.m1.1.1.3.3.3" xref="Sx3.SSx3.p2.8.m1.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.8.m1.1b"><apply id="Sx3.SSx3.p2.8.m1.1.1.cmml" xref="Sx3.SSx3.p2.8.m1.1.1"><in id="Sx3.SSx3.p2.8.m1.1.1.1.cmml" xref="Sx3.SSx3.p2.8.m1.1.1.1"></in><ci id="Sx3.SSx3.p2.8.m1.1.1.2.cmml" xref="Sx3.SSx3.p2.8.m1.1.1.2">𝐌</ci><apply id="Sx3.SSx3.p2.8.m1.1.1.3.cmml" xref="Sx3.SSx3.p2.8.m1.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.8.m1.1.1.3.1.cmml" xref="Sx3.SSx3.p2.8.m1.1.1.3">superscript</csymbol><ci id="Sx3.SSx3.p2.8.m1.1.1.3.2.cmml" xref="Sx3.SSx3.p2.8.m1.1.1.3.2">ℝ</ci><apply id="Sx3.SSx3.p2.8.m1.1.1.3.3.cmml" xref="Sx3.SSx3.p2.8.m1.1.1.3.3"><times id="Sx3.SSx3.p2.8.m1.1.1.3.3.1.cmml" xref="Sx3.SSx3.p2.8.m1.1.1.3.3.1"></times><ci id="Sx3.SSx3.p2.8.m1.1.1.3.3.2.cmml" xref="Sx3.SSx3.p2.8.m1.1.1.3.3.2">𝑁</ci><ci id="Sx3.SSx3.p2.8.m1.1.1.3.3.3.cmml" xref="Sx3.SSx3.p2.8.m1.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.8.m1.1c">\mathbf{M}\in\mathbb{R}^{N\times{N}}</annotation></semantics></math> denotes the mask matrix. <math id="Sx3.SSx3.p2.9.m2.1" class="ltx_Math" alttext="\mathbf{M}_{ij}=0" display="inline"><semantics id="Sx3.SSx3.p2.9.m2.1a"><mrow id="Sx3.SSx3.p2.9.m2.1.1" xref="Sx3.SSx3.p2.9.m2.1.1.cmml"><msub id="Sx3.SSx3.p2.9.m2.1.1.2" xref="Sx3.SSx3.p2.9.m2.1.1.2.cmml"><mi id="Sx3.SSx3.p2.9.m2.1.1.2.2" xref="Sx3.SSx3.p2.9.m2.1.1.2.2.cmml">𝐌</mi><mrow id="Sx3.SSx3.p2.9.m2.1.1.2.3" xref="Sx3.SSx3.p2.9.m2.1.1.2.3.cmml"><mi id="Sx3.SSx3.p2.9.m2.1.1.2.3.2" xref="Sx3.SSx3.p2.9.m2.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p2.9.m2.1.1.2.3.1" xref="Sx3.SSx3.p2.9.m2.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx3.p2.9.m2.1.1.2.3.3" xref="Sx3.SSx3.p2.9.m2.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="Sx3.SSx3.p2.9.m2.1.1.1" xref="Sx3.SSx3.p2.9.m2.1.1.1.cmml">=</mo><mn id="Sx3.SSx3.p2.9.m2.1.1.3" xref="Sx3.SSx3.p2.9.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.9.m2.1b"><apply id="Sx3.SSx3.p2.9.m2.1.1.cmml" xref="Sx3.SSx3.p2.9.m2.1.1"><eq id="Sx3.SSx3.p2.9.m2.1.1.1.cmml" xref="Sx3.SSx3.p2.9.m2.1.1.1"></eq><apply id="Sx3.SSx3.p2.9.m2.1.1.2.cmml" xref="Sx3.SSx3.p2.9.m2.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.9.m2.1.1.2.1.cmml" xref="Sx3.SSx3.p2.9.m2.1.1.2">subscript</csymbol><ci id="Sx3.SSx3.p2.9.m2.1.1.2.2.cmml" xref="Sx3.SSx3.p2.9.m2.1.1.2.2">𝐌</ci><apply id="Sx3.SSx3.p2.9.m2.1.1.2.3.cmml" xref="Sx3.SSx3.p2.9.m2.1.1.2.3"><times id="Sx3.SSx3.p2.9.m2.1.1.2.3.1.cmml" xref="Sx3.SSx3.p2.9.m2.1.1.2.3.1"></times><ci id="Sx3.SSx3.p2.9.m2.1.1.2.3.2.cmml" xref="Sx3.SSx3.p2.9.m2.1.1.2.3.2">𝑖</ci><ci id="Sx3.SSx3.p2.9.m2.1.1.2.3.3.cmml" xref="Sx3.SSx3.p2.9.m2.1.1.2.3.3">𝑗</ci></apply></apply><cn type="integer" id="Sx3.SSx3.p2.9.m2.1.1.3.cmml" xref="Sx3.SSx3.p2.9.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.9.m2.1c">\mathbf{M}_{ij}=0</annotation></semantics></math> if and only if <math id="Sx3.SSx3.p2.10.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="Sx3.SSx3.p2.10.m3.1a"><mi id="Sx3.SSx3.p2.10.m3.1.1" xref="Sx3.SSx3.p2.10.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.10.m3.1b"><ci id="Sx3.SSx3.p2.10.m3.1.1.cmml" xref="Sx3.SSx3.p2.10.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.10.m3.1c">i</annotation></semantics></math>-th node is the parent node of <math id="Sx3.SSx3.p2.11.m4.1" class="ltx_Math" alttext="j" display="inline"><semantics id="Sx3.SSx3.p2.11.m4.1a"><mi id="Sx3.SSx3.p2.11.m4.1.1" xref="Sx3.SSx3.p2.11.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.11.m4.1b"><ci id="Sx3.SSx3.p2.11.m4.1.1.cmml" xref="Sx3.SSx3.p2.11.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.11.m4.1c">j</annotation></semantics></math>-th node, and otherwise <math id="Sx3.SSx3.p2.12.m5.1" class="ltx_Math" alttext="\mathbf{M}_{ij}=-\infty" display="inline"><semantics id="Sx3.SSx3.p2.12.m5.1a"><mrow id="Sx3.SSx3.p2.12.m5.1.1" xref="Sx3.SSx3.p2.12.m5.1.1.cmml"><msub id="Sx3.SSx3.p2.12.m5.1.1.2" xref="Sx3.SSx3.p2.12.m5.1.1.2.cmml"><mi id="Sx3.SSx3.p2.12.m5.1.1.2.2" xref="Sx3.SSx3.p2.12.m5.1.1.2.2.cmml">𝐌</mi><mrow id="Sx3.SSx3.p2.12.m5.1.1.2.3" xref="Sx3.SSx3.p2.12.m5.1.1.2.3.cmml"><mi id="Sx3.SSx3.p2.12.m5.1.1.2.3.2" xref="Sx3.SSx3.p2.12.m5.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p2.12.m5.1.1.2.3.1" xref="Sx3.SSx3.p2.12.m5.1.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx3.p2.12.m5.1.1.2.3.3" xref="Sx3.SSx3.p2.12.m5.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="Sx3.SSx3.p2.12.m5.1.1.1" xref="Sx3.SSx3.p2.12.m5.1.1.1.cmml">=</mo><mrow id="Sx3.SSx3.p2.12.m5.1.1.3" xref="Sx3.SSx3.p2.12.m5.1.1.3.cmml"><mo id="Sx3.SSx3.p2.12.m5.1.1.3a" xref="Sx3.SSx3.p2.12.m5.1.1.3.cmml">−</mo><mi mathvariant="normal" id="Sx3.SSx3.p2.12.m5.1.1.3.2" xref="Sx3.SSx3.p2.12.m5.1.1.3.2.cmml">∞</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.12.m5.1b"><apply id="Sx3.SSx3.p2.12.m5.1.1.cmml" xref="Sx3.SSx3.p2.12.m5.1.1"><eq id="Sx3.SSx3.p2.12.m5.1.1.1.cmml" xref="Sx3.SSx3.p2.12.m5.1.1.1"></eq><apply id="Sx3.SSx3.p2.12.m5.1.1.2.cmml" xref="Sx3.SSx3.p2.12.m5.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.12.m5.1.1.2.1.cmml" xref="Sx3.SSx3.p2.12.m5.1.1.2">subscript</csymbol><ci id="Sx3.SSx3.p2.12.m5.1.1.2.2.cmml" xref="Sx3.SSx3.p2.12.m5.1.1.2.2">𝐌</ci><apply id="Sx3.SSx3.p2.12.m5.1.1.2.3.cmml" xref="Sx3.SSx3.p2.12.m5.1.1.2.3"><times id="Sx3.SSx3.p2.12.m5.1.1.2.3.1.cmml" xref="Sx3.SSx3.p2.12.m5.1.1.2.3.1"></times><ci id="Sx3.SSx3.p2.12.m5.1.1.2.3.2.cmml" xref="Sx3.SSx3.p2.12.m5.1.1.2.3.2">𝑖</ci><ci id="Sx3.SSx3.p2.12.m5.1.1.2.3.3.cmml" xref="Sx3.SSx3.p2.12.m5.1.1.2.3.3">𝑗</ci></apply></apply><apply id="Sx3.SSx3.p2.12.m5.1.1.3.cmml" xref="Sx3.SSx3.p2.12.m5.1.1.3"><minus id="Sx3.SSx3.p2.12.m5.1.1.3.1.cmml" xref="Sx3.SSx3.p2.12.m5.1.1.3"></minus><infinity id="Sx3.SSx3.p2.12.m5.1.1.3.2.cmml" xref="Sx3.SSx3.p2.12.m5.1.1.3.2"></infinity></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.12.m5.1c">\mathbf{M}_{ij}=-\infty</annotation></semantics></math>. <math id="Sx3.SSx3.p2.13.m6.3" class="ltx_Math" alttext="\mathbf{Q}^{S},\mathbf{K}^{S},\mathbf{V}^{S}" display="inline"><semantics id="Sx3.SSx3.p2.13.m6.3a"><mrow id="Sx3.SSx3.p2.13.m6.3.3.3" xref="Sx3.SSx3.p2.13.m6.3.3.4.cmml"><msup id="Sx3.SSx3.p2.13.m6.1.1.1.1" xref="Sx3.SSx3.p2.13.m6.1.1.1.1.cmml"><mi id="Sx3.SSx3.p2.13.m6.1.1.1.1.2" xref="Sx3.SSx3.p2.13.m6.1.1.1.1.2.cmml">𝐐</mi><mi id="Sx3.SSx3.p2.13.m6.1.1.1.1.3" xref="Sx3.SSx3.p2.13.m6.1.1.1.1.3.cmml">S</mi></msup><mo id="Sx3.SSx3.p2.13.m6.3.3.3.4" xref="Sx3.SSx3.p2.13.m6.3.3.4.cmml">,</mo><msup id="Sx3.SSx3.p2.13.m6.2.2.2.2" xref="Sx3.SSx3.p2.13.m6.2.2.2.2.cmml"><mi id="Sx3.SSx3.p2.13.m6.2.2.2.2.2" xref="Sx3.SSx3.p2.13.m6.2.2.2.2.2.cmml">𝐊</mi><mi id="Sx3.SSx3.p2.13.m6.2.2.2.2.3" xref="Sx3.SSx3.p2.13.m6.2.2.2.2.3.cmml">S</mi></msup><mo id="Sx3.SSx3.p2.13.m6.3.3.3.5" xref="Sx3.SSx3.p2.13.m6.3.3.4.cmml">,</mo><msup id="Sx3.SSx3.p2.13.m6.3.3.3.3" xref="Sx3.SSx3.p2.13.m6.3.3.3.3.cmml"><mi id="Sx3.SSx3.p2.13.m6.3.3.3.3.2" xref="Sx3.SSx3.p2.13.m6.3.3.3.3.2.cmml">𝐕</mi><mi id="Sx3.SSx3.p2.13.m6.3.3.3.3.3" xref="Sx3.SSx3.p2.13.m6.3.3.3.3.3.cmml">S</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.13.m6.3b"><list id="Sx3.SSx3.p2.13.m6.3.3.4.cmml" xref="Sx3.SSx3.p2.13.m6.3.3.3"><apply id="Sx3.SSx3.p2.13.m6.1.1.1.1.cmml" xref="Sx3.SSx3.p2.13.m6.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.13.m6.1.1.1.1.1.cmml" xref="Sx3.SSx3.p2.13.m6.1.1.1.1">superscript</csymbol><ci id="Sx3.SSx3.p2.13.m6.1.1.1.1.2.cmml" xref="Sx3.SSx3.p2.13.m6.1.1.1.1.2">𝐐</ci><ci id="Sx3.SSx3.p2.13.m6.1.1.1.1.3.cmml" xref="Sx3.SSx3.p2.13.m6.1.1.1.1.3">𝑆</ci></apply><apply id="Sx3.SSx3.p2.13.m6.2.2.2.2.cmml" xref="Sx3.SSx3.p2.13.m6.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.13.m6.2.2.2.2.1.cmml" xref="Sx3.SSx3.p2.13.m6.2.2.2.2">superscript</csymbol><ci id="Sx3.SSx3.p2.13.m6.2.2.2.2.2.cmml" xref="Sx3.SSx3.p2.13.m6.2.2.2.2.2">𝐊</ci><ci id="Sx3.SSx3.p2.13.m6.2.2.2.2.3.cmml" xref="Sx3.SSx3.p2.13.m6.2.2.2.2.3">𝑆</ci></apply><apply id="Sx3.SSx3.p2.13.m6.3.3.3.3.cmml" xref="Sx3.SSx3.p2.13.m6.3.3.3.3"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.13.m6.3.3.3.3.1.cmml" xref="Sx3.SSx3.p2.13.m6.3.3.3.3">superscript</csymbol><ci id="Sx3.SSx3.p2.13.m6.3.3.3.3.2.cmml" xref="Sx3.SSx3.p2.13.m6.3.3.3.3.2">𝐕</ci><ci id="Sx3.SSx3.p2.13.m6.3.3.3.3.3.cmml" xref="Sx3.SSx3.p2.13.m6.3.3.3.3.3">𝑆</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.13.m6.3c">\mathbf{Q}^{S},\mathbf{K}^{S},\mathbf{V}^{S}</annotation></semantics></math> are derived from <math id="Sx3.SSx3.p2.14.m7.1" class="ltx_Math" alttext="\mathbf{S}" display="inline"><semantics id="Sx3.SSx3.p2.14.m7.1a"><mi id="Sx3.SSx3.p2.14.m7.1.1" xref="Sx3.SSx3.p2.14.m7.1.1.cmml">𝐒</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.14.m7.1b"><ci id="Sx3.SSx3.p2.14.m7.1.1.cmml" xref="Sx3.SSx3.p2.14.m7.1.1">𝐒</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.14.m7.1c">\mathbf{S}</annotation></semantics></math> via three fully-connected layers, formulated as follows:</p>
<table id="A4.EGx4" class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table">

<tbody id="Sx3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E6.m1.4" class="ltx_Math" alttext="\displaystyle\begin{aligned} \mathbf{Q}^{S}&amp;=\textrm{FC}^{Q}(\mathbf{S})\\
\mathbf{K}^{S}&amp;=\textrm{FC}^{K}(\mathbf{S})\\
\mathbf{V}^{S}&amp;=\textrm{FC}^{V}(\mathbf{S}).\\
\end{aligned}" display="block"><semantics id="Sx3.E6.m1.4a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="Sx3.E6.m1.4.4" xref="Sx3.E6.m1.4.4.cmml"><mtr id="Sx3.E6.m1.4.4a" xref="Sx3.E6.m1.4.4.cmml"><mtd class="ltx_align_right" columnalign="right" id="Sx3.E6.m1.4.4b" xref="Sx3.E6.m1.4.4.cmml"><msup id="Sx3.E6.m1.1.1.1.2.1" xref="Sx3.E6.m1.1.1.1.2.1.cmml"><mi id="Sx3.E6.m1.1.1.1.2.1.2" xref="Sx3.E6.m1.1.1.1.2.1.2.cmml">𝐐</mi><mi id="Sx3.E6.m1.1.1.1.2.1.3" xref="Sx3.E6.m1.1.1.1.2.1.3.cmml">S</mi></msup></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx3.E6.m1.4.4c" xref="Sx3.E6.m1.4.4.cmml"><mrow id="Sx3.E6.m1.1.1.1.1.1" xref="Sx3.E6.m1.1.1.1.1.1.cmml"><mi id="Sx3.E6.m1.1.1.1.1.1.3" xref="Sx3.E6.m1.1.1.1.1.1.3.cmml"></mi><mo id="Sx3.E6.m1.1.1.1.1.1.2" xref="Sx3.E6.m1.1.1.1.1.1.2.cmml">=</mo><mrow id="Sx3.E6.m1.1.1.1.1.1.4" xref="Sx3.E6.m1.1.1.1.1.1.4.cmml"><msup id="Sx3.E6.m1.1.1.1.1.1.4.2" xref="Sx3.E6.m1.1.1.1.1.1.4.2.cmml"><mtext id="Sx3.E6.m1.1.1.1.1.1.4.2.2" xref="Sx3.E6.m1.1.1.1.1.1.4.2.2a.cmml">FC</mtext><mi id="Sx3.E6.m1.1.1.1.1.1.4.2.3" xref="Sx3.E6.m1.1.1.1.1.1.4.2.3.cmml">Q</mi></msup><mo lspace="0em" rspace="0em" id="Sx3.E6.m1.1.1.1.1.1.4.1" xref="Sx3.E6.m1.1.1.1.1.1.4.1.cmml">​</mo><mrow id="Sx3.E6.m1.1.1.1.1.1.4.3.2" xref="Sx3.E6.m1.1.1.1.1.1.4.cmml"><mo stretchy="false" id="Sx3.E6.m1.1.1.1.1.1.4.3.2.1" xref="Sx3.E6.m1.1.1.1.1.1.4.cmml">(</mo><mi id="Sx3.E6.m1.1.1.1.1.1.1" xref="Sx3.E6.m1.1.1.1.1.1.1.cmml">𝐒</mi><mo stretchy="false" id="Sx3.E6.m1.1.1.1.1.1.4.3.2.2" xref="Sx3.E6.m1.1.1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="Sx3.E6.m1.4.4d" xref="Sx3.E6.m1.4.4.cmml"><mtd class="ltx_align_right" columnalign="right" id="Sx3.E6.m1.4.4e" xref="Sx3.E6.m1.4.4.cmml"><msup id="Sx3.E6.m1.2.2.2.2.1" xref="Sx3.E6.m1.2.2.2.2.1.cmml"><mi id="Sx3.E6.m1.2.2.2.2.1.2" xref="Sx3.E6.m1.2.2.2.2.1.2.cmml">𝐊</mi><mi id="Sx3.E6.m1.2.2.2.2.1.3" xref="Sx3.E6.m1.2.2.2.2.1.3.cmml">S</mi></msup></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx3.E6.m1.4.4f" xref="Sx3.E6.m1.4.4.cmml"><mrow id="Sx3.E6.m1.2.2.2.1.1" xref="Sx3.E6.m1.2.2.2.1.1.cmml"><mi id="Sx3.E6.m1.2.2.2.1.1.3" xref="Sx3.E6.m1.2.2.2.1.1.3.cmml"></mi><mo id="Sx3.E6.m1.2.2.2.1.1.2" xref="Sx3.E6.m1.2.2.2.1.1.2.cmml">=</mo><mrow id="Sx3.E6.m1.2.2.2.1.1.4" xref="Sx3.E6.m1.2.2.2.1.1.4.cmml"><msup id="Sx3.E6.m1.2.2.2.1.1.4.2" xref="Sx3.E6.m1.2.2.2.1.1.4.2.cmml"><mtext id="Sx3.E6.m1.2.2.2.1.1.4.2.2" xref="Sx3.E6.m1.2.2.2.1.1.4.2.2a.cmml">FC</mtext><mi id="Sx3.E6.m1.2.2.2.1.1.4.2.3" xref="Sx3.E6.m1.2.2.2.1.1.4.2.3.cmml">K</mi></msup><mo lspace="0em" rspace="0em" id="Sx3.E6.m1.2.2.2.1.1.4.1" xref="Sx3.E6.m1.2.2.2.1.1.4.1.cmml">​</mo><mrow id="Sx3.E6.m1.2.2.2.1.1.4.3.2" xref="Sx3.E6.m1.2.2.2.1.1.4.cmml"><mo stretchy="false" id="Sx3.E6.m1.2.2.2.1.1.4.3.2.1" xref="Sx3.E6.m1.2.2.2.1.1.4.cmml">(</mo><mi id="Sx3.E6.m1.2.2.2.1.1.1" xref="Sx3.E6.m1.2.2.2.1.1.1.cmml">𝐒</mi><mo stretchy="false" id="Sx3.E6.m1.2.2.2.1.1.4.3.2.2" xref="Sx3.E6.m1.2.2.2.1.1.4.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="Sx3.E6.m1.4.4g" xref="Sx3.E6.m1.4.4.cmml"><mtd class="ltx_align_right" columnalign="right" id="Sx3.E6.m1.4.4h" xref="Sx3.E6.m1.4.4.cmml"><msup id="Sx3.E6.m1.4.4.4.3.1" xref="Sx3.E6.m1.4.4.4.3.1.cmml"><mi id="Sx3.E6.m1.4.4.4.3.1.2" xref="Sx3.E6.m1.4.4.4.3.1.2.cmml">𝐕</mi><mi id="Sx3.E6.m1.4.4.4.3.1.3" xref="Sx3.E6.m1.4.4.4.3.1.3.cmml">S</mi></msup></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx3.E6.m1.4.4i" xref="Sx3.E6.m1.4.4.cmml"><mrow id="Sx3.E6.m1.4.4.4.2.2.2" xref="Sx3.E6.m1.4.4.4.2.2.2.1.cmml"><mrow id="Sx3.E6.m1.4.4.4.2.2.2.1" xref="Sx3.E6.m1.4.4.4.2.2.2.1.cmml"><mi id="Sx3.E6.m1.4.4.4.2.2.2.1.2" xref="Sx3.E6.m1.4.4.4.2.2.2.1.2.cmml"></mi><mo id="Sx3.E6.m1.4.4.4.2.2.2.1.1" xref="Sx3.E6.m1.4.4.4.2.2.2.1.1.cmml">=</mo><mrow id="Sx3.E6.m1.4.4.4.2.2.2.1.3" xref="Sx3.E6.m1.4.4.4.2.2.2.1.3.cmml"><msup id="Sx3.E6.m1.4.4.4.2.2.2.1.3.2" xref="Sx3.E6.m1.4.4.4.2.2.2.1.3.2.cmml"><mtext id="Sx3.E6.m1.4.4.4.2.2.2.1.3.2.2" xref="Sx3.E6.m1.4.4.4.2.2.2.1.3.2.2a.cmml">FC</mtext><mi id="Sx3.E6.m1.4.4.4.2.2.2.1.3.2.3" xref="Sx3.E6.m1.4.4.4.2.2.2.1.3.2.3.cmml">V</mi></msup><mo lspace="0em" rspace="0em" id="Sx3.E6.m1.4.4.4.2.2.2.1.3.1" xref="Sx3.E6.m1.4.4.4.2.2.2.1.3.1.cmml">​</mo><mrow id="Sx3.E6.m1.4.4.4.2.2.2.1.3.3.2" xref="Sx3.E6.m1.4.4.4.2.2.2.1.3.cmml"><mo stretchy="false" id="Sx3.E6.m1.4.4.4.2.2.2.1.3.3.2.1" xref="Sx3.E6.m1.4.4.4.2.2.2.1.3.cmml">(</mo><mi id="Sx3.E6.m1.3.3.3.1.1.1" xref="Sx3.E6.m1.3.3.3.1.1.1.cmml">𝐒</mi><mo stretchy="false" id="Sx3.E6.m1.4.4.4.2.2.2.1.3.3.2.2" xref="Sx3.E6.m1.4.4.4.2.2.2.1.3.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="Sx3.E6.m1.4.4.4.2.2.2.2" xref="Sx3.E6.m1.4.4.4.2.2.2.1.cmml">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="Sx3.E6.m1.4b"><matrix id="Sx3.E6.m1.4.4.cmml" xref="Sx3.E6.m1.4.4"><matrixrow id="Sx3.E6.m1.4.4a.cmml" xref="Sx3.E6.m1.4.4"><apply id="Sx3.E6.m1.1.1.1.2.1.cmml" xref="Sx3.E6.m1.1.1.1.2.1"><csymbol cd="ambiguous" id="Sx3.E6.m1.1.1.1.2.1.1.cmml" xref="Sx3.E6.m1.1.1.1.2.1">superscript</csymbol><ci id="Sx3.E6.m1.1.1.1.2.1.2.cmml" xref="Sx3.E6.m1.1.1.1.2.1.2">𝐐</ci><ci id="Sx3.E6.m1.1.1.1.2.1.3.cmml" xref="Sx3.E6.m1.1.1.1.2.1.3">𝑆</ci></apply><apply id="Sx3.E6.m1.1.1.1.1.1.cmml" xref="Sx3.E6.m1.1.1.1.1.1"><eq id="Sx3.E6.m1.1.1.1.1.1.2.cmml" xref="Sx3.E6.m1.1.1.1.1.1.2"></eq><csymbol cd="latexml" id="Sx3.E6.m1.1.1.1.1.1.3.cmml" xref="Sx3.E6.m1.1.1.1.1.1.3">absent</csymbol><apply id="Sx3.E6.m1.1.1.1.1.1.4.cmml" xref="Sx3.E6.m1.1.1.1.1.1.4"><times id="Sx3.E6.m1.1.1.1.1.1.4.1.cmml" xref="Sx3.E6.m1.1.1.1.1.1.4.1"></times><apply id="Sx3.E6.m1.1.1.1.1.1.4.2.cmml" xref="Sx3.E6.m1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.1.1.1.1.1.4.2.1.cmml" xref="Sx3.E6.m1.1.1.1.1.1.4.2">superscript</csymbol><ci id="Sx3.E6.m1.1.1.1.1.1.4.2.2a.cmml" xref="Sx3.E6.m1.1.1.1.1.1.4.2.2"><mtext id="Sx3.E6.m1.1.1.1.1.1.4.2.2.cmml" xref="Sx3.E6.m1.1.1.1.1.1.4.2.2">FC</mtext></ci><ci id="Sx3.E6.m1.1.1.1.1.1.4.2.3.cmml" xref="Sx3.E6.m1.1.1.1.1.1.4.2.3">𝑄</ci></apply><ci id="Sx3.E6.m1.1.1.1.1.1.1.cmml" xref="Sx3.E6.m1.1.1.1.1.1.1">𝐒</ci></apply></apply></matrixrow><matrixrow id="Sx3.E6.m1.4.4b.cmml" xref="Sx3.E6.m1.4.4"><apply id="Sx3.E6.m1.2.2.2.2.1.cmml" xref="Sx3.E6.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="Sx3.E6.m1.2.2.2.2.1.1.cmml" xref="Sx3.E6.m1.2.2.2.2.1">superscript</csymbol><ci id="Sx3.E6.m1.2.2.2.2.1.2.cmml" xref="Sx3.E6.m1.2.2.2.2.1.2">𝐊</ci><ci id="Sx3.E6.m1.2.2.2.2.1.3.cmml" xref="Sx3.E6.m1.2.2.2.2.1.3">𝑆</ci></apply><apply id="Sx3.E6.m1.2.2.2.1.1.cmml" xref="Sx3.E6.m1.2.2.2.1.1"><eq id="Sx3.E6.m1.2.2.2.1.1.2.cmml" xref="Sx3.E6.m1.2.2.2.1.1.2"></eq><csymbol cd="latexml" id="Sx3.E6.m1.2.2.2.1.1.3.cmml" xref="Sx3.E6.m1.2.2.2.1.1.3">absent</csymbol><apply id="Sx3.E6.m1.2.2.2.1.1.4.cmml" xref="Sx3.E6.m1.2.2.2.1.1.4"><times id="Sx3.E6.m1.2.2.2.1.1.4.1.cmml" xref="Sx3.E6.m1.2.2.2.1.1.4.1"></times><apply id="Sx3.E6.m1.2.2.2.1.1.4.2.cmml" xref="Sx3.E6.m1.2.2.2.1.1.4.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.2.2.2.1.1.4.2.1.cmml" xref="Sx3.E6.m1.2.2.2.1.1.4.2">superscript</csymbol><ci id="Sx3.E6.m1.2.2.2.1.1.4.2.2a.cmml" xref="Sx3.E6.m1.2.2.2.1.1.4.2.2"><mtext id="Sx3.E6.m1.2.2.2.1.1.4.2.2.cmml" xref="Sx3.E6.m1.2.2.2.1.1.4.2.2">FC</mtext></ci><ci id="Sx3.E6.m1.2.2.2.1.1.4.2.3.cmml" xref="Sx3.E6.m1.2.2.2.1.1.4.2.3">𝐾</ci></apply><ci id="Sx3.E6.m1.2.2.2.1.1.1.cmml" xref="Sx3.E6.m1.2.2.2.1.1.1">𝐒</ci></apply></apply></matrixrow><matrixrow id="Sx3.E6.m1.4.4c.cmml" xref="Sx3.E6.m1.4.4"><apply id="Sx3.E6.m1.4.4.4.3.1.cmml" xref="Sx3.E6.m1.4.4.4.3.1"><csymbol cd="ambiguous" id="Sx3.E6.m1.4.4.4.3.1.1.cmml" xref="Sx3.E6.m1.4.4.4.3.1">superscript</csymbol><ci id="Sx3.E6.m1.4.4.4.3.1.2.cmml" xref="Sx3.E6.m1.4.4.4.3.1.2">𝐕</ci><ci id="Sx3.E6.m1.4.4.4.3.1.3.cmml" xref="Sx3.E6.m1.4.4.4.3.1.3">𝑆</ci></apply><apply id="Sx3.E6.m1.4.4.4.2.2.2.1.cmml" xref="Sx3.E6.m1.4.4.4.2.2.2"><eq id="Sx3.E6.m1.4.4.4.2.2.2.1.1.cmml" xref="Sx3.E6.m1.4.4.4.2.2.2.1.1"></eq><csymbol cd="latexml" id="Sx3.E6.m1.4.4.4.2.2.2.1.2.cmml" xref="Sx3.E6.m1.4.4.4.2.2.2.1.2">absent</csymbol><apply id="Sx3.E6.m1.4.4.4.2.2.2.1.3.cmml" xref="Sx3.E6.m1.4.4.4.2.2.2.1.3"><times id="Sx3.E6.m1.4.4.4.2.2.2.1.3.1.cmml" xref="Sx3.E6.m1.4.4.4.2.2.2.1.3.1"></times><apply id="Sx3.E6.m1.4.4.4.2.2.2.1.3.2.cmml" xref="Sx3.E6.m1.4.4.4.2.2.2.1.3.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.4.4.4.2.2.2.1.3.2.1.cmml" xref="Sx3.E6.m1.4.4.4.2.2.2.1.3.2">superscript</csymbol><ci id="Sx3.E6.m1.4.4.4.2.2.2.1.3.2.2a.cmml" xref="Sx3.E6.m1.4.4.4.2.2.2.1.3.2.2"><mtext id="Sx3.E6.m1.4.4.4.2.2.2.1.3.2.2.cmml" xref="Sx3.E6.m1.4.4.4.2.2.2.1.3.2.2">FC</mtext></ci><ci id="Sx3.E6.m1.4.4.4.2.2.2.1.3.2.3.cmml" xref="Sx3.E6.m1.4.4.4.2.2.2.1.3.2.3">𝑉</ci></apply><ci id="Sx3.E6.m1.3.3.3.1.1.1.cmml" xref="Sx3.E6.m1.3.3.3.1.1.1">𝐒</ci></apply></apply></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E6.m1.4c">\displaystyle\begin{aligned} \mathbf{Q}^{S}&amp;=\textrm{FC}^{Q}(\mathbf{S})\\
\mathbf{K}^{S}&amp;=\textrm{FC}^{K}(\mathbf{S})\\
\mathbf{V}^{S}&amp;=\textrm{FC}^{V}(\mathbf{S}).\\
\end{aligned}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div id="Sx3.SSx3.p3" class="ltx_para">
<p id="Sx3.SSx3.p3.1" class="ltx_p">Different from <span id="Sx3.SSx3.p3.1.1" class="ltx_text ltx_markedasmath">SA</span> that gathers information from itself, guided attention gathers features from other source (<em id="Sx3.SSx3.p3.1.2" class="ltx_emph ltx_font_italic">e.g.,</em> visual clues), formulated as follows:</p>
<table id="A4.EGx5" class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table">

<tbody id="Sx3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E7.m1.5" class="ltx_Math" alttext="\displaystyle\textrm{GA}(\mathbf{S},\tilde{\mathbf{V}})=(\frac{(\mathbf{Q}^{S})(\mathbf{K}^{\tilde{V}})^{T}}{\sqrt{d_{h}}})\mathbf{V}^{\tilde{V}}," display="block"><semantics id="Sx3.E7.m1.5a"><mrow id="Sx3.E7.m1.5.5.1" xref="Sx3.E7.m1.5.5.1.1.cmml"><mrow id="Sx3.E7.m1.5.5.1.1" xref="Sx3.E7.m1.5.5.1.1.cmml"><mrow id="Sx3.E7.m1.5.5.1.1.2" xref="Sx3.E7.m1.5.5.1.1.2.cmml"><mtext id="Sx3.E7.m1.5.5.1.1.2.2" xref="Sx3.E7.m1.5.5.1.1.2.2a.cmml">GA</mtext><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.5.5.1.1.2.1" xref="Sx3.E7.m1.5.5.1.1.2.1.cmml">​</mo><mrow id="Sx3.E7.m1.5.5.1.1.2.3.2" xref="Sx3.E7.m1.5.5.1.1.2.3.1.cmml"><mo stretchy="false" id="Sx3.E7.m1.5.5.1.1.2.3.2.1" xref="Sx3.E7.m1.5.5.1.1.2.3.1.cmml">(</mo><mi id="Sx3.E7.m1.3.3" xref="Sx3.E7.m1.3.3.cmml">𝐒</mi><mo id="Sx3.E7.m1.5.5.1.1.2.3.2.2" xref="Sx3.E7.m1.5.5.1.1.2.3.1.cmml">,</mo><mover accent="true" id="Sx3.E7.m1.4.4" xref="Sx3.E7.m1.4.4.cmml"><mi id="Sx3.E7.m1.4.4.2" xref="Sx3.E7.m1.4.4.2.cmml">𝐕</mi><mo id="Sx3.E7.m1.4.4.1" xref="Sx3.E7.m1.4.4.1.cmml">~</mo></mover><mo stretchy="false" id="Sx3.E7.m1.5.5.1.1.2.3.2.3" xref="Sx3.E7.m1.5.5.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="Sx3.E7.m1.5.5.1.1.1" xref="Sx3.E7.m1.5.5.1.1.1.cmml">=</mo><mrow id="Sx3.E7.m1.5.5.1.1.3" xref="Sx3.E7.m1.5.5.1.1.3.cmml"><mrow id="Sx3.E7.m1.5.5.1.1.3.2.2" xref="Sx3.E7.m1.2.2.cmml"><mo stretchy="false" id="Sx3.E7.m1.5.5.1.1.3.2.2.1" xref="Sx3.E7.m1.2.2.cmml">(</mo><mfrac id="Sx3.E7.m1.2.2" xref="Sx3.E7.m1.2.2.cmml"><mrow id="Sx3.E7.m1.2.2.2" xref="Sx3.E7.m1.2.2.2.cmml"><mrow id="Sx3.E7.m1.1.1.1.1.1" xref="Sx3.E7.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E7.m1.1.1.1.1.1.2" xref="Sx3.E7.m1.1.1.1.1.1.1.cmml">(</mo><msup id="Sx3.E7.m1.1.1.1.1.1.1" xref="Sx3.E7.m1.1.1.1.1.1.1.cmml"><mi id="Sx3.E7.m1.1.1.1.1.1.1.2" xref="Sx3.E7.m1.1.1.1.1.1.1.2.cmml">𝐐</mi><mi id="Sx3.E7.m1.1.1.1.1.1.1.3" xref="Sx3.E7.m1.1.1.1.1.1.1.3.cmml">S</mi></msup><mo stretchy="false" id="Sx3.E7.m1.1.1.1.1.1.3" xref="Sx3.E7.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.2.2.2.3" xref="Sx3.E7.m1.2.2.2.3.cmml">​</mo><msup id="Sx3.E7.m1.2.2.2.2" xref="Sx3.E7.m1.2.2.2.2.cmml"><mrow id="Sx3.E7.m1.2.2.2.2.1.1" xref="Sx3.E7.m1.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="Sx3.E7.m1.2.2.2.2.1.1.2" xref="Sx3.E7.m1.2.2.2.2.1.1.1.cmml">(</mo><msup id="Sx3.E7.m1.2.2.2.2.1.1.1" xref="Sx3.E7.m1.2.2.2.2.1.1.1.cmml"><mi id="Sx3.E7.m1.2.2.2.2.1.1.1.2" xref="Sx3.E7.m1.2.2.2.2.1.1.1.2.cmml">𝐊</mi><mover accent="true" id="Sx3.E7.m1.2.2.2.2.1.1.1.3" xref="Sx3.E7.m1.2.2.2.2.1.1.1.3.cmml"><mi id="Sx3.E7.m1.2.2.2.2.1.1.1.3.2" xref="Sx3.E7.m1.2.2.2.2.1.1.1.3.2.cmml">V</mi><mo id="Sx3.E7.m1.2.2.2.2.1.1.1.3.1" xref="Sx3.E7.m1.2.2.2.2.1.1.1.3.1.cmml">~</mo></mover></msup><mo stretchy="false" id="Sx3.E7.m1.2.2.2.2.1.1.3" xref="Sx3.E7.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="Sx3.E7.m1.2.2.2.2.3" xref="Sx3.E7.m1.2.2.2.2.3.cmml">T</mi></msup></mrow><msqrt id="Sx3.E7.m1.2.2.4" xref="Sx3.E7.m1.2.2.4.cmml"><msub id="Sx3.E7.m1.2.2.4.2" xref="Sx3.E7.m1.2.2.4.2.cmml"><mi id="Sx3.E7.m1.2.2.4.2.2" xref="Sx3.E7.m1.2.2.4.2.2.cmml">d</mi><mi id="Sx3.E7.m1.2.2.4.2.3" xref="Sx3.E7.m1.2.2.4.2.3.cmml">h</mi></msub></msqrt></mfrac><mo stretchy="false" id="Sx3.E7.m1.5.5.1.1.3.2.2.2" xref="Sx3.E7.m1.2.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.5.5.1.1.3.1" xref="Sx3.E7.m1.5.5.1.1.3.1.cmml">​</mo><msup id="Sx3.E7.m1.5.5.1.1.3.3" xref="Sx3.E7.m1.5.5.1.1.3.3.cmml"><mi id="Sx3.E7.m1.5.5.1.1.3.3.2" xref="Sx3.E7.m1.5.5.1.1.3.3.2.cmml">𝐕</mi><mover accent="true" id="Sx3.E7.m1.5.5.1.1.3.3.3" xref="Sx3.E7.m1.5.5.1.1.3.3.3.cmml"><mi id="Sx3.E7.m1.5.5.1.1.3.3.3.2" xref="Sx3.E7.m1.5.5.1.1.3.3.3.2.cmml">V</mi><mo id="Sx3.E7.m1.5.5.1.1.3.3.3.1" xref="Sx3.E7.m1.5.5.1.1.3.3.3.1.cmml">~</mo></mover></msup></mrow></mrow><mo id="Sx3.E7.m1.5.5.1.2" xref="Sx3.E7.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E7.m1.5b"><apply id="Sx3.E7.m1.5.5.1.1.cmml" xref="Sx3.E7.m1.5.5.1"><eq id="Sx3.E7.m1.5.5.1.1.1.cmml" xref="Sx3.E7.m1.5.5.1.1.1"></eq><apply id="Sx3.E7.m1.5.5.1.1.2.cmml" xref="Sx3.E7.m1.5.5.1.1.2"><times id="Sx3.E7.m1.5.5.1.1.2.1.cmml" xref="Sx3.E7.m1.5.5.1.1.2.1"></times><ci id="Sx3.E7.m1.5.5.1.1.2.2a.cmml" xref="Sx3.E7.m1.5.5.1.1.2.2"><mtext id="Sx3.E7.m1.5.5.1.1.2.2.cmml" xref="Sx3.E7.m1.5.5.1.1.2.2">GA</mtext></ci><interval closure="open" id="Sx3.E7.m1.5.5.1.1.2.3.1.cmml" xref="Sx3.E7.m1.5.5.1.1.2.3.2"><ci id="Sx3.E7.m1.3.3.cmml" xref="Sx3.E7.m1.3.3">𝐒</ci><apply id="Sx3.E7.m1.4.4.cmml" xref="Sx3.E7.m1.4.4"><ci id="Sx3.E7.m1.4.4.1.cmml" xref="Sx3.E7.m1.4.4.1">~</ci><ci id="Sx3.E7.m1.4.4.2.cmml" xref="Sx3.E7.m1.4.4.2">𝐕</ci></apply></interval></apply><apply id="Sx3.E7.m1.5.5.1.1.3.cmml" xref="Sx3.E7.m1.5.5.1.1.3"><times id="Sx3.E7.m1.5.5.1.1.3.1.cmml" xref="Sx3.E7.m1.5.5.1.1.3.1"></times><apply id="Sx3.E7.m1.2.2.cmml" xref="Sx3.E7.m1.5.5.1.1.3.2.2"><divide id="Sx3.E7.m1.2.2.3.cmml" xref="Sx3.E7.m1.5.5.1.1.3.2.2"></divide><apply id="Sx3.E7.m1.2.2.2.cmml" xref="Sx3.E7.m1.2.2.2"><times id="Sx3.E7.m1.2.2.2.3.cmml" xref="Sx3.E7.m1.2.2.2.3"></times><apply id="Sx3.E7.m1.1.1.1.1.1.1.cmml" xref="Sx3.E7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E7.m1.1.1.1.1.1.1.1.cmml" xref="Sx3.E7.m1.1.1.1.1.1">superscript</csymbol><ci id="Sx3.E7.m1.1.1.1.1.1.1.2.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.2">𝐐</ci><ci id="Sx3.E7.m1.1.1.1.1.1.1.3.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.3">𝑆</ci></apply><apply id="Sx3.E7.m1.2.2.2.2.cmml" xref="Sx3.E7.m1.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.E7.m1.2.2.2.2.2.cmml" xref="Sx3.E7.m1.2.2.2.2">superscript</csymbol><apply id="Sx3.E7.m1.2.2.2.2.1.1.1.cmml" xref="Sx3.E7.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="Sx3.E7.m1.2.2.2.2.1.1.1.1.cmml" xref="Sx3.E7.m1.2.2.2.2.1.1">superscript</csymbol><ci id="Sx3.E7.m1.2.2.2.2.1.1.1.2.cmml" xref="Sx3.E7.m1.2.2.2.2.1.1.1.2">𝐊</ci><apply id="Sx3.E7.m1.2.2.2.2.1.1.1.3.cmml" xref="Sx3.E7.m1.2.2.2.2.1.1.1.3"><ci id="Sx3.E7.m1.2.2.2.2.1.1.1.3.1.cmml" xref="Sx3.E7.m1.2.2.2.2.1.1.1.3.1">~</ci><ci id="Sx3.E7.m1.2.2.2.2.1.1.1.3.2.cmml" xref="Sx3.E7.m1.2.2.2.2.1.1.1.3.2">𝑉</ci></apply></apply><ci id="Sx3.E7.m1.2.2.2.2.3.cmml" xref="Sx3.E7.m1.2.2.2.2.3">𝑇</ci></apply></apply><apply id="Sx3.E7.m1.2.2.4.cmml" xref="Sx3.E7.m1.2.2.4"><root id="Sx3.E7.m1.2.2.4a.cmml" xref="Sx3.E7.m1.2.2.4"></root><apply id="Sx3.E7.m1.2.2.4.2.cmml" xref="Sx3.E7.m1.2.2.4.2"><csymbol cd="ambiguous" id="Sx3.E7.m1.2.2.4.2.1.cmml" xref="Sx3.E7.m1.2.2.4.2">subscript</csymbol><ci id="Sx3.E7.m1.2.2.4.2.2.cmml" xref="Sx3.E7.m1.2.2.4.2.2">𝑑</ci><ci id="Sx3.E7.m1.2.2.4.2.3.cmml" xref="Sx3.E7.m1.2.2.4.2.3">ℎ</ci></apply></apply></apply><apply id="Sx3.E7.m1.5.5.1.1.3.3.cmml" xref="Sx3.E7.m1.5.5.1.1.3.3"><csymbol cd="ambiguous" id="Sx3.E7.m1.5.5.1.1.3.3.1.cmml" xref="Sx3.E7.m1.5.5.1.1.3.3">superscript</csymbol><ci id="Sx3.E7.m1.5.5.1.1.3.3.2.cmml" xref="Sx3.E7.m1.5.5.1.1.3.3.2">𝐕</ci><apply id="Sx3.E7.m1.5.5.1.1.3.3.3.cmml" xref="Sx3.E7.m1.5.5.1.1.3.3.3"><ci id="Sx3.E7.m1.5.5.1.1.3.3.3.1.cmml" xref="Sx3.E7.m1.5.5.1.1.3.3.3.1">~</ci><ci id="Sx3.E7.m1.5.5.1.1.3.3.3.2.cmml" xref="Sx3.E7.m1.5.5.1.1.3.3.3.2">𝑉</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E7.m1.5c">\displaystyle\textrm{GA}(\mathbf{S},\tilde{\mathbf{V}})=(\frac{(\mathbf{Q}^{S})(\mathbf{K}^{\tilde{V}})^{T}}{\sqrt{d_{h}}})\mathbf{V}^{\tilde{V}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx3.p3.3" class="ltx_p">where <math id="Sx3.SSx3.p3.2.m1.2" class="ltx_Math" alttext="\mathbf{K}^{\tilde{V}},\mathbf{V}^{\tilde{V}}" display="inline"><semantics id="Sx3.SSx3.p3.2.m1.2a"><mrow id="Sx3.SSx3.p3.2.m1.2.2.2" xref="Sx3.SSx3.p3.2.m1.2.2.3.cmml"><msup id="Sx3.SSx3.p3.2.m1.1.1.1.1" xref="Sx3.SSx3.p3.2.m1.1.1.1.1.cmml"><mi id="Sx3.SSx3.p3.2.m1.1.1.1.1.2" xref="Sx3.SSx3.p3.2.m1.1.1.1.1.2.cmml">𝐊</mi><mover accent="true" id="Sx3.SSx3.p3.2.m1.1.1.1.1.3" xref="Sx3.SSx3.p3.2.m1.1.1.1.1.3.cmml"><mi id="Sx3.SSx3.p3.2.m1.1.1.1.1.3.2" xref="Sx3.SSx3.p3.2.m1.1.1.1.1.3.2.cmml">V</mi><mo id="Sx3.SSx3.p3.2.m1.1.1.1.1.3.1" xref="Sx3.SSx3.p3.2.m1.1.1.1.1.3.1.cmml">~</mo></mover></msup><mo id="Sx3.SSx3.p3.2.m1.2.2.2.3" xref="Sx3.SSx3.p3.2.m1.2.2.3.cmml">,</mo><msup id="Sx3.SSx3.p3.2.m1.2.2.2.2" xref="Sx3.SSx3.p3.2.m1.2.2.2.2.cmml"><mi id="Sx3.SSx3.p3.2.m1.2.2.2.2.2" xref="Sx3.SSx3.p3.2.m1.2.2.2.2.2.cmml">𝐕</mi><mover accent="true" id="Sx3.SSx3.p3.2.m1.2.2.2.2.3" xref="Sx3.SSx3.p3.2.m1.2.2.2.2.3.cmml"><mi id="Sx3.SSx3.p3.2.m1.2.2.2.2.3.2" xref="Sx3.SSx3.p3.2.m1.2.2.2.2.3.2.cmml">V</mi><mo id="Sx3.SSx3.p3.2.m1.2.2.2.2.3.1" xref="Sx3.SSx3.p3.2.m1.2.2.2.2.3.1.cmml">~</mo></mover></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p3.2.m1.2b"><list id="Sx3.SSx3.p3.2.m1.2.2.3.cmml" xref="Sx3.SSx3.p3.2.m1.2.2.2"><apply id="Sx3.SSx3.p3.2.m1.1.1.1.1.cmml" xref="Sx3.SSx3.p3.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p3.2.m1.1.1.1.1.1.cmml" xref="Sx3.SSx3.p3.2.m1.1.1.1.1">superscript</csymbol><ci id="Sx3.SSx3.p3.2.m1.1.1.1.1.2.cmml" xref="Sx3.SSx3.p3.2.m1.1.1.1.1.2">𝐊</ci><apply id="Sx3.SSx3.p3.2.m1.1.1.1.1.3.cmml" xref="Sx3.SSx3.p3.2.m1.1.1.1.1.3"><ci id="Sx3.SSx3.p3.2.m1.1.1.1.1.3.1.cmml" xref="Sx3.SSx3.p3.2.m1.1.1.1.1.3.1">~</ci><ci id="Sx3.SSx3.p3.2.m1.1.1.1.1.3.2.cmml" xref="Sx3.SSx3.p3.2.m1.1.1.1.1.3.2">𝑉</ci></apply></apply><apply id="Sx3.SSx3.p3.2.m1.2.2.2.2.cmml" xref="Sx3.SSx3.p3.2.m1.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx3.p3.2.m1.2.2.2.2.1.cmml" xref="Sx3.SSx3.p3.2.m1.2.2.2.2">superscript</csymbol><ci id="Sx3.SSx3.p3.2.m1.2.2.2.2.2.cmml" xref="Sx3.SSx3.p3.2.m1.2.2.2.2.2">𝐕</ci><apply id="Sx3.SSx3.p3.2.m1.2.2.2.2.3.cmml" xref="Sx3.SSx3.p3.2.m1.2.2.2.2.3"><ci id="Sx3.SSx3.p3.2.m1.2.2.2.2.3.1.cmml" xref="Sx3.SSx3.p3.2.m1.2.2.2.2.3.1">~</ci><ci id="Sx3.SSx3.p3.2.m1.2.2.2.2.3.2.cmml" xref="Sx3.SSx3.p3.2.m1.2.2.2.2.3.2">𝑉</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p3.2.m1.2c">\mathbf{K}^{\tilde{V}},\mathbf{V}^{\tilde{V}}</annotation></semantics></math> are derived from <math id="Sx3.SSx3.p3.3.m2.1" class="ltx_Math" alttext="\tilde{\mathbf{V}}" display="inline"><semantics id="Sx3.SSx3.p3.3.m2.1a"><mover accent="true" id="Sx3.SSx3.p3.3.m2.1.1" xref="Sx3.SSx3.p3.3.m2.1.1.cmml"><mi id="Sx3.SSx3.p3.3.m2.1.1.2" xref="Sx3.SSx3.p3.3.m2.1.1.2.cmml">𝐕</mi><mo id="Sx3.SSx3.p3.3.m2.1.1.1" xref="Sx3.SSx3.p3.3.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p3.3.m2.1b"><apply id="Sx3.SSx3.p3.3.m2.1.1.cmml" xref="Sx3.SSx3.p3.3.m2.1.1"><ci id="Sx3.SSx3.p3.3.m2.1.1.1.cmml" xref="Sx3.SSx3.p3.3.m2.1.1.1">~</ci><ci id="Sx3.SSx3.p3.3.m2.1.1.2.cmml" xref="Sx3.SSx3.p3.3.m2.1.1.2">𝐕</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p3.3.m2.1c">\tilde{\mathbf{V}}</annotation></semantics></math> similar to Equation <a href="#Sx3.E6" title="In Program Execution ‣ Methodology ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
<div id="Sx3.SSx3.p4" class="ltx_para">
<p id="Sx3.SSx3.p4.2" class="ltx_p">After <math id="Sx3.SSx3.p4.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="Sx3.SSx3.p4.1.m1.1a"><mi id="Sx3.SSx3.p4.1.m1.1.1" xref="Sx3.SSx3.p4.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p4.1.m1.1b"><ci id="Sx3.SSx3.p4.1.m1.1.1.cmml" xref="Sx3.SSx3.p4.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p4.1.m1.1c">L</annotation></semantics></math> iterations of program inference, the final state <math id="Sx3.SSx3.p4.2.m2.1" class="ltx_Math" alttext="\mathbf{S}^{L}_{N-1}" display="inline"><semantics id="Sx3.SSx3.p4.2.m2.1a"><msubsup id="Sx3.SSx3.p4.2.m2.1.1" xref="Sx3.SSx3.p4.2.m2.1.1.cmml"><mi id="Sx3.SSx3.p4.2.m2.1.1.2.2" xref="Sx3.SSx3.p4.2.m2.1.1.2.2.cmml">𝐒</mi><mrow id="Sx3.SSx3.p4.2.m2.1.1.3" xref="Sx3.SSx3.p4.2.m2.1.1.3.cmml"><mi id="Sx3.SSx3.p4.2.m2.1.1.3.2" xref="Sx3.SSx3.p4.2.m2.1.1.3.2.cmml">N</mi><mo id="Sx3.SSx3.p4.2.m2.1.1.3.1" xref="Sx3.SSx3.p4.2.m2.1.1.3.1.cmml">−</mo><mn id="Sx3.SSx3.p4.2.m2.1.1.3.3" xref="Sx3.SSx3.p4.2.m2.1.1.3.3.cmml">1</mn></mrow><mi id="Sx3.SSx3.p4.2.m2.1.1.2.3" xref="Sx3.SSx3.p4.2.m2.1.1.2.3.cmml">L</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p4.2.m2.1b"><apply id="Sx3.SSx3.p4.2.m2.1.1.cmml" xref="Sx3.SSx3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p4.2.m2.1.1.1.cmml" xref="Sx3.SSx3.p4.2.m2.1.1">subscript</csymbol><apply id="Sx3.SSx3.p4.2.m2.1.1.2.cmml" xref="Sx3.SSx3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p4.2.m2.1.1.2.1.cmml" xref="Sx3.SSx3.p4.2.m2.1.1">superscript</csymbol><ci id="Sx3.SSx3.p4.2.m2.1.1.2.2.cmml" xref="Sx3.SSx3.p4.2.m2.1.1.2.2">𝐒</ci><ci id="Sx3.SSx3.p4.2.m2.1.1.2.3.cmml" xref="Sx3.SSx3.p4.2.m2.1.1.2.3">𝐿</ci></apply><apply id="Sx3.SSx3.p4.2.m2.1.1.3.cmml" xref="Sx3.SSx3.p4.2.m2.1.1.3"><minus id="Sx3.SSx3.p4.2.m2.1.1.3.1.cmml" xref="Sx3.SSx3.p4.2.m2.1.1.3.1"></minus><ci id="Sx3.SSx3.p4.2.m2.1.1.3.2.cmml" xref="Sx3.SSx3.p4.2.m2.1.1.3.2">𝑁</ci><cn type="integer" id="Sx3.SSx3.p4.2.m2.1.1.3.3.cmml" xref="Sx3.SSx3.p4.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p4.2.m2.1c">\mathbf{S}^{L}_{N-1}</annotation></semantics></math> is used to predict the answer via a
multi-layer perception (MLP) layer:</p>
<table id="A4.EGx6" class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table">

<tbody id="Sx3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E8.m1.7" class="ltx_Math" alttext="\displaystyle\begin{aligned} \mathbf{s}&amp;=\textrm{MLP}(\mathbf{S}^{L}_{N-1})\\
p(a|I,Q;\Theta)&amp;=\textrm{Softmax}(\mathbf{s}),\end{aligned}" display="block"><semantics id="Sx3.E8.m1.7a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="Sx3.E8.m1.7.7" xref="Sx3.E8.m1.7.7.cmml"><mtr id="Sx3.E8.m1.7.7a" xref="Sx3.E8.m1.7.7.cmml"><mtd class="ltx_align_right" columnalign="right" id="Sx3.E8.m1.7.7b" xref="Sx3.E8.m1.7.7.cmml"><mi id="Sx3.E8.m1.1.1.1.2.1" xref="Sx3.E8.m1.1.1.1.2.1.cmml">𝐬</mi></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx3.E8.m1.7.7c" xref="Sx3.E8.m1.7.7.cmml"><mrow id="Sx3.E8.m1.1.1.1.1.1" xref="Sx3.E8.m1.1.1.1.1.1.cmml"><mi id="Sx3.E8.m1.1.1.1.1.1.3" xref="Sx3.E8.m1.1.1.1.1.1.3.cmml"></mi><mo id="Sx3.E8.m1.1.1.1.1.1.2" xref="Sx3.E8.m1.1.1.1.1.1.2.cmml">=</mo><mrow id="Sx3.E8.m1.1.1.1.1.1.1" xref="Sx3.E8.m1.1.1.1.1.1.1.cmml"><mtext id="Sx3.E8.m1.1.1.1.1.1.1.3" xref="Sx3.E8.m1.1.1.1.1.1.1.3a.cmml">MLP</mtext><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.1.1.1.1.1.1.2" xref="Sx3.E8.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E8.m1.1.1.1.1.1.1.1.1" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E8.m1.1.1.1.1.1.1.1.1.2" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.2.2" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐒</mi><mrow id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.3.2" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">N</mi><mo id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.3.1" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.3.3" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.2.3" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">L</mi></msubsup><mo stretchy="false" id="Sx3.E8.m1.1.1.1.1.1.1.1.1.3" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="Sx3.E8.m1.7.7d" xref="Sx3.E8.m1.7.7.cmml"><mtd class="ltx_align_right" columnalign="right" id="Sx3.E8.m1.7.7e" xref="Sx3.E8.m1.7.7.cmml"><mrow id="Sx3.E8.m1.5.5.5.4.4" xref="Sx3.E8.m1.5.5.5.4.4.cmml"><mi id="Sx3.E8.m1.5.5.5.4.4.6" xref="Sx3.E8.m1.5.5.5.4.4.6.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.5.5.5.4.4.5" xref="Sx3.E8.m1.5.5.5.4.4.5.cmml">​</mo><mrow id="Sx3.E8.m1.5.5.5.4.4.4.1" xref="Sx3.E8.m1.5.5.5.4.4.4.1.1.cmml"><mo stretchy="false" id="Sx3.E8.m1.5.5.5.4.4.4.1.2" xref="Sx3.E8.m1.5.5.5.4.4.4.1.1.cmml">(</mo><mrow id="Sx3.E8.m1.5.5.5.4.4.4.1.1" xref="Sx3.E8.m1.5.5.5.4.4.4.1.1.cmml"><mi id="Sx3.E8.m1.5.5.5.4.4.4.1.1.2" xref="Sx3.E8.m1.5.5.5.4.4.4.1.1.2.cmml">a</mi><mo fence="false" id="Sx3.E8.m1.5.5.5.4.4.4.1.1.1" xref="Sx3.E8.m1.5.5.5.4.4.4.1.1.1.cmml">|</mo><mrow id="Sx3.E8.m1.5.5.5.4.4.4.1.1.3.2" xref="Sx3.E8.m1.5.5.5.4.4.4.1.1.3.1.cmml"><mi id="Sx3.E8.m1.2.2.2.1.1.1" xref="Sx3.E8.m1.2.2.2.1.1.1.cmml">I</mi><mo id="Sx3.E8.m1.5.5.5.4.4.4.1.1.3.2.1" xref="Sx3.E8.m1.5.5.5.4.4.4.1.1.3.1.cmml">,</mo><mi id="Sx3.E8.m1.3.3.3.2.2.2" xref="Sx3.E8.m1.3.3.3.2.2.2.cmml">Q</mi><mo id="Sx3.E8.m1.5.5.5.4.4.4.1.1.3.2.2" xref="Sx3.E8.m1.5.5.5.4.4.4.1.1.3.1.cmml">;</mo><mi mathvariant="normal" id="Sx3.E8.m1.4.4.4.3.3.3" xref="Sx3.E8.m1.4.4.4.3.3.3.cmml">Θ</mi></mrow></mrow><mo stretchy="false" id="Sx3.E8.m1.5.5.5.4.4.4.1.3" xref="Sx3.E8.m1.5.5.5.4.4.4.1.1.cmml">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx3.E8.m1.7.7f" xref="Sx3.E8.m1.7.7.cmml"><mrow id="Sx3.E8.m1.7.7.7.6.2.2" xref="Sx3.E8.m1.7.7.7.6.2.2.1.cmml"><mrow id="Sx3.E8.m1.7.7.7.6.2.2.1" xref="Sx3.E8.m1.7.7.7.6.2.2.1.cmml"><mi id="Sx3.E8.m1.7.7.7.6.2.2.1.2" xref="Sx3.E8.m1.7.7.7.6.2.2.1.2.cmml"></mi><mo id="Sx3.E8.m1.7.7.7.6.2.2.1.1" xref="Sx3.E8.m1.7.7.7.6.2.2.1.1.cmml">=</mo><mrow id="Sx3.E8.m1.7.7.7.6.2.2.1.3" xref="Sx3.E8.m1.7.7.7.6.2.2.1.3.cmml"><mtext id="Sx3.E8.m1.7.7.7.6.2.2.1.3.2" xref="Sx3.E8.m1.7.7.7.6.2.2.1.3.2a.cmml">Softmax</mtext><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.7.7.7.6.2.2.1.3.1" xref="Sx3.E8.m1.7.7.7.6.2.2.1.3.1.cmml">​</mo><mrow id="Sx3.E8.m1.7.7.7.6.2.2.1.3.3.2" xref="Sx3.E8.m1.7.7.7.6.2.2.1.3.cmml"><mo stretchy="false" id="Sx3.E8.m1.7.7.7.6.2.2.1.3.3.2.1" xref="Sx3.E8.m1.7.7.7.6.2.2.1.3.cmml">(</mo><mi id="Sx3.E8.m1.6.6.6.5.1.1" xref="Sx3.E8.m1.6.6.6.5.1.1.cmml">𝐬</mi><mo stretchy="false" id="Sx3.E8.m1.7.7.7.6.2.2.1.3.3.2.2" xref="Sx3.E8.m1.7.7.7.6.2.2.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="Sx3.E8.m1.7.7.7.6.2.2.2" xref="Sx3.E8.m1.7.7.7.6.2.2.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="Sx3.E8.m1.7b"><matrix id="Sx3.E8.m1.7.7.cmml" xref="Sx3.E8.m1.7.7"><matrixrow id="Sx3.E8.m1.7.7a.cmml" xref="Sx3.E8.m1.7.7"><ci id="Sx3.E8.m1.1.1.1.2.1.cmml" xref="Sx3.E8.m1.1.1.1.2.1">𝐬</ci><apply id="Sx3.E8.m1.1.1.1.1.1.cmml" xref="Sx3.E8.m1.1.1.1.1.1"><eq id="Sx3.E8.m1.1.1.1.1.1.2.cmml" xref="Sx3.E8.m1.1.1.1.1.1.2"></eq><csymbol cd="latexml" id="Sx3.E8.m1.1.1.1.1.1.3.cmml" xref="Sx3.E8.m1.1.1.1.1.1.3">absent</csymbol><apply id="Sx3.E8.m1.1.1.1.1.1.1.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1"><times id="Sx3.E8.m1.1.1.1.1.1.1.2.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.2"></times><ci id="Sx3.E8.m1.1.1.1.1.1.1.3a.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.3"><mtext id="Sx3.E8.m1.1.1.1.1.1.1.3.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.3">MLP</mtext></ci><apply id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.2.2">𝐒</ci><ci id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.2.3">𝐿</ci></apply><apply id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.3"><minus id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.3.2">𝑁</ci><cn type="integer" id="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E8.m1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply></matrixrow><matrixrow id="Sx3.E8.m1.7.7b.cmml" xref="Sx3.E8.m1.7.7"><apply id="Sx3.E8.m1.5.5.5.4.4.cmml" xref="Sx3.E8.m1.5.5.5.4.4"><times id="Sx3.E8.m1.5.5.5.4.4.5.cmml" xref="Sx3.E8.m1.5.5.5.4.4.5"></times><ci id="Sx3.E8.m1.5.5.5.4.4.6.cmml" xref="Sx3.E8.m1.5.5.5.4.4.6">𝑝</ci><apply id="Sx3.E8.m1.5.5.5.4.4.4.1.1.cmml" xref="Sx3.E8.m1.5.5.5.4.4.4.1"><csymbol cd="latexml" id="Sx3.E8.m1.5.5.5.4.4.4.1.1.1.cmml" xref="Sx3.E8.m1.5.5.5.4.4.4.1.1.1">conditional</csymbol><ci id="Sx3.E8.m1.5.5.5.4.4.4.1.1.2.cmml" xref="Sx3.E8.m1.5.5.5.4.4.4.1.1.2">𝑎</ci><list id="Sx3.E8.m1.5.5.5.4.4.4.1.1.3.1.cmml" xref="Sx3.E8.m1.5.5.5.4.4.4.1.1.3.2"><ci id="Sx3.E8.m1.2.2.2.1.1.1.cmml" xref="Sx3.E8.m1.2.2.2.1.1.1">𝐼</ci><ci id="Sx3.E8.m1.3.3.3.2.2.2.cmml" xref="Sx3.E8.m1.3.3.3.2.2.2">𝑄</ci><ci id="Sx3.E8.m1.4.4.4.3.3.3.cmml" xref="Sx3.E8.m1.4.4.4.3.3.3">Θ</ci></list></apply></apply><apply id="Sx3.E8.m1.7.7.7.6.2.2.1.cmml" xref="Sx3.E8.m1.7.7.7.6.2.2"><eq id="Sx3.E8.m1.7.7.7.6.2.2.1.1.cmml" xref="Sx3.E8.m1.7.7.7.6.2.2.1.1"></eq><csymbol cd="latexml" id="Sx3.E8.m1.7.7.7.6.2.2.1.2.cmml" xref="Sx3.E8.m1.7.7.7.6.2.2.1.2">absent</csymbol><apply id="Sx3.E8.m1.7.7.7.6.2.2.1.3.cmml" xref="Sx3.E8.m1.7.7.7.6.2.2.1.3"><times id="Sx3.E8.m1.7.7.7.6.2.2.1.3.1.cmml" xref="Sx3.E8.m1.7.7.7.6.2.2.1.3.1"></times><ci id="Sx3.E8.m1.7.7.7.6.2.2.1.3.2a.cmml" xref="Sx3.E8.m1.7.7.7.6.2.2.1.3.2"><mtext id="Sx3.E8.m1.7.7.7.6.2.2.1.3.2.cmml" xref="Sx3.E8.m1.7.7.7.6.2.2.1.3.2">Softmax</mtext></ci><ci id="Sx3.E8.m1.6.6.6.5.1.1.cmml" xref="Sx3.E8.m1.6.6.6.5.1.1">𝐬</ci></apply></apply></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E8.m1.7c">\displaystyle\begin{aligned} \mathbf{s}&amp;=\textrm{MLP}(\mathbf{S}^{L}_{N-1})\\
p(a|I,Q;\Theta)&amp;=\textrm{Softmax}(\mathbf{s}),\end{aligned}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx3.p4.5" class="ltx_p">where <math id="Sx3.SSx3.p4.3.m1.1" class="ltx_Math" alttext="\mathbf{s}\in\mathbb{R}^{|\mathcal{A}|}" display="inline"><semantics id="Sx3.SSx3.p4.3.m1.1a"><mrow id="Sx3.SSx3.p4.3.m1.1.2" xref="Sx3.SSx3.p4.3.m1.1.2.cmml"><mi id="Sx3.SSx3.p4.3.m1.1.2.2" xref="Sx3.SSx3.p4.3.m1.1.2.2.cmml">𝐬</mi><mo id="Sx3.SSx3.p4.3.m1.1.2.1" xref="Sx3.SSx3.p4.3.m1.1.2.1.cmml">∈</mo><msup id="Sx3.SSx3.p4.3.m1.1.2.3" xref="Sx3.SSx3.p4.3.m1.1.2.3.cmml"><mi id="Sx3.SSx3.p4.3.m1.1.2.3.2" xref="Sx3.SSx3.p4.3.m1.1.2.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx3.p4.3.m1.1.1.1.3" xref="Sx3.SSx3.p4.3.m1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx3.p4.3.m1.1.1.1.3.1" xref="Sx3.SSx3.p4.3.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx3.p4.3.m1.1.1.1.1" xref="Sx3.SSx3.p4.3.m1.1.1.1.1.cmml">𝒜</mi><mo stretchy="false" id="Sx3.SSx3.p4.3.m1.1.1.1.3.2" xref="Sx3.SSx3.p4.3.m1.1.1.1.2.1.cmml">|</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p4.3.m1.1b"><apply id="Sx3.SSx3.p4.3.m1.1.2.cmml" xref="Sx3.SSx3.p4.3.m1.1.2"><in id="Sx3.SSx3.p4.3.m1.1.2.1.cmml" xref="Sx3.SSx3.p4.3.m1.1.2.1"></in><ci id="Sx3.SSx3.p4.3.m1.1.2.2.cmml" xref="Sx3.SSx3.p4.3.m1.1.2.2">𝐬</ci><apply id="Sx3.SSx3.p4.3.m1.1.2.3.cmml" xref="Sx3.SSx3.p4.3.m1.1.2.3"><csymbol cd="ambiguous" id="Sx3.SSx3.p4.3.m1.1.2.3.1.cmml" xref="Sx3.SSx3.p4.3.m1.1.2.3">superscript</csymbol><ci id="Sx3.SSx3.p4.3.m1.1.2.3.2.cmml" xref="Sx3.SSx3.p4.3.m1.1.2.3.2">ℝ</ci><apply id="Sx3.SSx3.p4.3.m1.1.1.1.2.cmml" xref="Sx3.SSx3.p4.3.m1.1.1.1.3"><abs id="Sx3.SSx3.p4.3.m1.1.1.1.2.1.cmml" xref="Sx3.SSx3.p4.3.m1.1.1.1.3.1"></abs><ci id="Sx3.SSx3.p4.3.m1.1.1.1.1.cmml" xref="Sx3.SSx3.p4.3.m1.1.1.1.1">𝒜</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p4.3.m1.1c">\mathbf{s}\in\mathbb{R}^{|\mathcal{A}|}</annotation></semantics></math> denotes the predicted scores of the answers in <math id="Sx3.SSx3.p4.4.m2.1" class="ltx_Math" alttext="\mathcal{A}" display="inline"><semantics id="Sx3.SSx3.p4.4.m2.1a"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx3.p4.4.m2.1.1" xref="Sx3.SSx3.p4.4.m2.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p4.4.m2.1b"><ci id="Sx3.SSx3.p4.4.m2.1.1.cmml" xref="Sx3.SSx3.p4.4.m2.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p4.4.m2.1c">\mathcal{A}</annotation></semantics></math>, and the answer with the highest score is chosen as the final answer. <math id="Sx3.SSx3.p4.5.m3.1" class="ltx_Math" alttext="\Theta" display="inline"><semantics id="Sx3.SSx3.p4.5.m3.1a"><mi mathvariant="normal" id="Sx3.SSx3.p4.5.m3.1.1" xref="Sx3.SSx3.p4.5.m3.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p4.5.m3.1b"><ci id="Sx3.SSx3.p4.5.m3.1.1.cmml" xref="Sx3.SSx3.p4.5.m3.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p4.5.m3.1c">\Theta</annotation></semantics></math> denotes the model parameters. Finally, cross-entropy loss is used to optimize the model, formulated as follows:</p>
<table id="A4.EGx7" class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table">

<tbody id="Sx3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E9.m1.5" class="ltx_Math" alttext="\displaystyle\mathcal{L}^{VQA}=-\mathbb{E}_{\mathcal{D}}[\log(p(a=a^{gt}|I,Q;\Theta))]," display="block"><semantics id="Sx3.E9.m1.5a"><mrow id="Sx3.E9.m1.5.5.1" xref="Sx3.E9.m1.5.5.1.1.cmml"><mrow id="Sx3.E9.m1.5.5.1.1" xref="Sx3.E9.m1.5.5.1.1.cmml"><msup id="Sx3.E9.m1.5.5.1.1.3" xref="Sx3.E9.m1.5.5.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E9.m1.5.5.1.1.3.2" xref="Sx3.E9.m1.5.5.1.1.3.2.cmml">ℒ</mi><mrow id="Sx3.E9.m1.5.5.1.1.3.3" xref="Sx3.E9.m1.5.5.1.1.3.3.cmml"><mi id="Sx3.E9.m1.5.5.1.1.3.3.2" xref="Sx3.E9.m1.5.5.1.1.3.3.2.cmml">V</mi><mo lspace="0em" rspace="0em" id="Sx3.E9.m1.5.5.1.1.3.3.1" xref="Sx3.E9.m1.5.5.1.1.3.3.1.cmml">​</mo><mi id="Sx3.E9.m1.5.5.1.1.3.3.3" xref="Sx3.E9.m1.5.5.1.1.3.3.3.cmml">Q</mi><mo lspace="0em" rspace="0em" id="Sx3.E9.m1.5.5.1.1.3.3.1a" xref="Sx3.E9.m1.5.5.1.1.3.3.1.cmml">​</mo><mi id="Sx3.E9.m1.5.5.1.1.3.3.4" xref="Sx3.E9.m1.5.5.1.1.3.3.4.cmml">A</mi></mrow></msup><mo id="Sx3.E9.m1.5.5.1.1.2" xref="Sx3.E9.m1.5.5.1.1.2.cmml">=</mo><mrow id="Sx3.E9.m1.5.5.1.1.1" xref="Sx3.E9.m1.5.5.1.1.1.cmml"><mo id="Sx3.E9.m1.5.5.1.1.1a" xref="Sx3.E9.m1.5.5.1.1.1.cmml">−</mo><mrow id="Sx3.E9.m1.5.5.1.1.1.1" xref="Sx3.E9.m1.5.5.1.1.1.1.cmml"><msub id="Sx3.E9.m1.5.5.1.1.1.1.3" xref="Sx3.E9.m1.5.5.1.1.1.1.3.cmml"><mi id="Sx3.E9.m1.5.5.1.1.1.1.3.2" xref="Sx3.E9.m1.5.5.1.1.1.1.3.2.cmml">𝔼</mi><mi class="ltx_font_mathcaligraphic" id="Sx3.E9.m1.5.5.1.1.1.1.3.3" xref="Sx3.E9.m1.5.5.1.1.1.1.3.3.cmml">𝒟</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.E9.m1.5.5.1.1.1.1.2" xref="Sx3.E9.m1.5.5.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E9.m1.5.5.1.1.1.1.1.1" xref="Sx3.E9.m1.5.5.1.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.E9.m1.5.5.1.1.1.1.1.1.2" xref="Sx3.E9.m1.5.5.1.1.1.1.1.2.1.cmml">[</mo><mrow id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.2.cmml"><mi id="Sx3.E9.m1.4.4" xref="Sx3.E9.m1.4.4.cmml">log</mi><mo id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1a" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.2.cmml">(</mo><mrow id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">a</mi><mo id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">=</mo><mrow id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><msup id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">a</mi><mrow id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.2" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.3" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.3.cmml">t</mi></mrow></msup><mo fence="false" id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">|</mo><mrow id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml"><mi id="Sx3.E9.m1.1.1" xref="Sx3.E9.m1.1.1.cmml">I</mi><mo id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.1" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">,</mo><mi id="Sx3.E9.m1.2.2" xref="Sx3.E9.m1.2.2.cmml">Q</mi><mo id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">;</mo><mi mathvariant="normal" id="Sx3.E9.m1.3.3" xref="Sx3.E9.m1.3.3.cmml">Θ</mi></mrow></mrow></mrow><mo stretchy="false" id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="Sx3.E9.m1.5.5.1.1.1.1.1.1.3" xref="Sx3.E9.m1.5.5.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="Sx3.E9.m1.5.5.1.2" xref="Sx3.E9.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E9.m1.5b"><apply id="Sx3.E9.m1.5.5.1.1.cmml" xref="Sx3.E9.m1.5.5.1"><eq id="Sx3.E9.m1.5.5.1.1.2.cmml" xref="Sx3.E9.m1.5.5.1.1.2"></eq><apply id="Sx3.E9.m1.5.5.1.1.3.cmml" xref="Sx3.E9.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="Sx3.E9.m1.5.5.1.1.3.1.cmml" xref="Sx3.E9.m1.5.5.1.1.3">superscript</csymbol><ci id="Sx3.E9.m1.5.5.1.1.3.2.cmml" xref="Sx3.E9.m1.5.5.1.1.3.2">ℒ</ci><apply id="Sx3.E9.m1.5.5.1.1.3.3.cmml" xref="Sx3.E9.m1.5.5.1.1.3.3"><times id="Sx3.E9.m1.5.5.1.1.3.3.1.cmml" xref="Sx3.E9.m1.5.5.1.1.3.3.1"></times><ci id="Sx3.E9.m1.5.5.1.1.3.3.2.cmml" xref="Sx3.E9.m1.5.5.1.1.3.3.2">𝑉</ci><ci id="Sx3.E9.m1.5.5.1.1.3.3.3.cmml" xref="Sx3.E9.m1.5.5.1.1.3.3.3">𝑄</ci><ci id="Sx3.E9.m1.5.5.1.1.3.3.4.cmml" xref="Sx3.E9.m1.5.5.1.1.3.3.4">𝐴</ci></apply></apply><apply id="Sx3.E9.m1.5.5.1.1.1.cmml" xref="Sx3.E9.m1.5.5.1.1.1"><minus id="Sx3.E9.m1.5.5.1.1.1.2.cmml" xref="Sx3.E9.m1.5.5.1.1.1"></minus><apply id="Sx3.E9.m1.5.5.1.1.1.1.cmml" xref="Sx3.E9.m1.5.5.1.1.1.1"><times id="Sx3.E9.m1.5.5.1.1.1.1.2.cmml" xref="Sx3.E9.m1.5.5.1.1.1.1.2"></times><apply id="Sx3.E9.m1.5.5.1.1.1.1.3.cmml" xref="Sx3.E9.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E9.m1.5.5.1.1.1.1.3.1.cmml" xref="Sx3.E9.m1.5.5.1.1.1.1.3">subscript</csymbol><ci id="Sx3.E9.m1.5.5.1.1.1.1.3.2.cmml" xref="Sx3.E9.m1.5.5.1.1.1.1.3.2">𝔼</ci><ci id="Sx3.E9.m1.5.5.1.1.1.1.3.3.cmml" xref="Sx3.E9.m1.5.5.1.1.1.1.3.3">𝒟</ci></apply><apply id="Sx3.E9.m1.5.5.1.1.1.1.1.2.cmml" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1"><csymbol cd="latexml" id="Sx3.E9.m1.5.5.1.1.1.1.1.2.1.cmml" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1"><log id="Sx3.E9.m1.4.4.cmml" xref="Sx3.E9.m1.4.4"></log><apply id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1"><times id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.3">𝑝</ci><apply id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1"><eq id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></eq><ci id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑎</ci><apply id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1">conditional</csymbol><apply id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝑎</ci><apply id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3"><times id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1"></times><ci id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.2">𝑔</ci><ci id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.3">𝑡</ci></apply></apply><list id="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="Sx3.E9.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2"><ci id="Sx3.E9.m1.1.1.cmml" xref="Sx3.E9.m1.1.1">𝐼</ci><ci id="Sx3.E9.m1.2.2.cmml" xref="Sx3.E9.m1.2.2">𝑄</ci><ci id="Sx3.E9.m1.3.3.cmml" xref="Sx3.E9.m1.3.3">Θ</ci></list></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E9.m1.5c">\displaystyle\mathcal{L}^{VQA}=-\mathbb{E}_{\mathcal{D}}[\log(p(a=a^{gt}|I,Q;\Theta))],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx3.p4.6" class="ltx_p">where <math id="Sx3.SSx3.p4.6.m1.2" class="ltx_Math" alttext="\mathcal{D},a^{gt}" display="inline"><semantics id="Sx3.SSx3.p4.6.m1.2a"><mrow id="Sx3.SSx3.p4.6.m1.2.2.1" xref="Sx3.SSx3.p4.6.m1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx3.p4.6.m1.1.1" xref="Sx3.SSx3.p4.6.m1.1.1.cmml">𝒟</mi><mo id="Sx3.SSx3.p4.6.m1.2.2.1.2" xref="Sx3.SSx3.p4.6.m1.2.2.2.cmml">,</mo><msup id="Sx3.SSx3.p4.6.m1.2.2.1.1" xref="Sx3.SSx3.p4.6.m1.2.2.1.1.cmml"><mi id="Sx3.SSx3.p4.6.m1.2.2.1.1.2" xref="Sx3.SSx3.p4.6.m1.2.2.1.1.2.cmml">a</mi><mrow id="Sx3.SSx3.p4.6.m1.2.2.1.1.3" xref="Sx3.SSx3.p4.6.m1.2.2.1.1.3.cmml"><mi id="Sx3.SSx3.p4.6.m1.2.2.1.1.3.2" xref="Sx3.SSx3.p4.6.m1.2.2.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p4.6.m1.2.2.1.1.3.1" xref="Sx3.SSx3.p4.6.m1.2.2.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx3.p4.6.m1.2.2.1.1.3.3" xref="Sx3.SSx3.p4.6.m1.2.2.1.1.3.3.cmml">t</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p4.6.m1.2b"><list id="Sx3.SSx3.p4.6.m1.2.2.2.cmml" xref="Sx3.SSx3.p4.6.m1.2.2.1"><ci id="Sx3.SSx3.p4.6.m1.1.1.cmml" xref="Sx3.SSx3.p4.6.m1.1.1">𝒟</ci><apply id="Sx3.SSx3.p4.6.m1.2.2.1.1.cmml" xref="Sx3.SSx3.p4.6.m1.2.2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p4.6.m1.2.2.1.1.1.cmml" xref="Sx3.SSx3.p4.6.m1.2.2.1.1">superscript</csymbol><ci id="Sx3.SSx3.p4.6.m1.2.2.1.1.2.cmml" xref="Sx3.SSx3.p4.6.m1.2.2.1.1.2">𝑎</ci><apply id="Sx3.SSx3.p4.6.m1.2.2.1.1.3.cmml" xref="Sx3.SSx3.p4.6.m1.2.2.1.1.3"><times id="Sx3.SSx3.p4.6.m1.2.2.1.1.3.1.cmml" xref="Sx3.SSx3.p4.6.m1.2.2.1.1.3.1"></times><ci id="Sx3.SSx3.p4.6.m1.2.2.1.1.3.2.cmml" xref="Sx3.SSx3.p4.6.m1.2.2.1.1.3.2">𝑔</ci><ci id="Sx3.SSx3.p4.6.m1.2.2.1.1.3.3.cmml" xref="Sx3.SSx3.p4.6.m1.2.2.1.1.3.3">𝑡</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p4.6.m1.2c">\mathcal{D},a^{gt}</annotation></semantics></math> denotes the VQA dataset and ground truth answer, respectively.</p>
</div>
</section>
<section id="Sx3.SSx4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Intermediate Supervision</h3>

<figure id="Sx3.F4" class="ltx_figure"><img src="/html/2312.16012/assets/x4.png" id="Sx3.F4.g1" class="ltx_graphics ltx_centering ltx_img_square" width="460" height="407" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Illustrations of Detection-based Intermediate Supervision (DIS) algorithm. The intermediate results are generated via symbolic graph reasoning based on the ground-truth scene graph and program tree, and transformed into sequences to supervise the intermediate states.</figcaption>
</figure>
<div id="Sx3.SSx4.p1" class="ltx_para">
<p id="Sx3.SSx4.p1.1" class="ltx_p">On top of the above-mentioned program execution, intermediate supervisions are proposed to constrain the reasoning process, and improve the answer prediction performance <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib8" title="" class="ltx_ref">2021</a>; Zhao et al. <a href="#bib.bib33" title="" class="ltx_ref">2021</a>)</cite>. However, previous methods calculate probability distributions based on IoU between object bounding boxes and ground-truth ones, which easily induces the model to focus on irrelevant objects (ref to Figure <a href="#Sx1.F1" title="Figure 1 ‣ Introduction ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> (b)). To this end, we propose detection-based intermediate supervision (DIS) algorithm, which formulates the intermediate supervisions into a unified sequence form, thereby endowing the model with the abilities of exploiting diverse supervision types (<em id="Sx3.SSx4.p1.1.1" class="ltx_emph ltx_font_italic">e.g.,</em> bounding boxes, logical words (true/false), text).
As shown in Figure <a href="#Sx3.F4" title="Figure 4 ‣ Intermediate Supervision ‣ Methodology ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, DIS algorithm consists of two steps: (1) <em id="Sx3.SSx4.p1.1.2" class="ltx_emph ltx_font_italic">symbolic graph reasoning</em> designs manual rules to execute the program tree on the ground-truth scene graph<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>GQA <cite class="ltx_cite ltx_citemacro_citep">(Hudson and Manning <a href="#bib.bib16" title="" class="ltx_ref">2019b</a>)</cite> dataset provides ground-truth scene graph only for <em id="footnote1.1" class="ltx_emph ltx_font_italic">train</em> and <em id="footnote1.2" class="ltx_emph ltx_font_italic">val</em> splits. Therefore, DIS is used to optimize the model only in the training phase, and removed during testing phase.</span></span></span>, resulting in intermediate results (<em id="Sx3.SSx4.p1.1.3" class="ltx_emph ltx_font_italic">e.g.,</em> <em id="Sx3.SSx4.p1.1.4" class="ltx_emph ltx_font_italic">Objects</em>, <em id="Sx3.SSx4.p1.1.5" class="ltx_emph ltx_font_italic">True/False</em>, <em id="Sx3.SSx4.p1.1.6" class="ltx_emph ltx_font_italic">Answer</em>), and (2) <em id="Sx3.SSx4.p1.1.7" class="ltx_emph ltx_font_italic">intermediate result decoder</em> decodes the intermediate outputs, which is optimized using auto-regression loss.</p>
</div>
<section id="Sx3.SSx4.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Symbolic Graph Reasoning</h4>

<div id="Sx3.SSx4.SSSx1.p1" class="ltx_para">
<p id="Sx3.SSx4.SSSx1.p1.1" class="ltx_p">To obtain the intermediate supervisions, we follow MMN <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib8" title="" class="ltx_ref">2021</a>)</cite>, which executes the <em id="Sx3.SSx4.SSSx1.p1.1.1" class="ltx_emph ltx_font_italic">Program</em> on the ground truth <em id="Sx3.SSx4.SSSx1.p1.1.2" class="ltx_emph ltx_font_italic">Scene Graph</em> (as illustrated at the top of Figure <a href="#Sx3.F4" title="Figure 4 ‣ Intermediate Supervision ‣ Methodology ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>). Specifically, we manually design the symbolic reasoning rules for each function type (<em id="Sx3.SSx4.SSSx1.p1.1.3" class="ltx_emph ltx_font_italic">e.g.,</em> Select, Relate, Verify, <em id="Sx3.SSx4.SSSx1.p1.1.4" class="ltx_emph ltx_font_italic">etc.</em>). For example, <em id="Sx3.SSx4.SSSx1.p1.1.5" class="ltx_emph ltx_font_italic">Select(x)</em> is defined to <em id="Sx3.SSx4.SSSx1.p1.1.6" class="ltx_emph ltx_font_italic">select the nodes corresponding to x</em>, and <em id="Sx3.SSx4.SSSx1.p1.1.7" class="ltx_emph ltx_font_italic">Relate(x, to the left of)</em> is defined to <em id="Sx3.SSx4.SSSx1.p1.1.8" class="ltx_emph ltx_font_italic">find the nodes to the left of x</em>. With the <em id="Sx3.SSx4.SSSx1.p1.1.9" class="ltx_emph ltx_font_italic">Program</em> and <em id="Sx3.SSx4.SSSx1.p1.1.10" class="ltx_emph ltx_font_italic">Scene Graph</em>, the intermediate supervisions are inferred step by step, as illustrated at the bottom of Figure <a href="#Sx3.F4" title="Figure 4 ‣ Intermediate Supervision ‣ Methodology ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.
Generally, the supervisions are categorized into three types: <em id="Sx3.SSx4.SSSx1.p1.1.11" class="ltx_emph ltx_font_italic">Objects</em> with bounding boxes, <em id="Sx3.SSx4.SSSx1.p1.1.12" class="ltx_emph ltx_font_italic">True/False</em>, and <em id="Sx3.SSx4.SSSx1.p1.1.13" class="ltx_emph ltx_font_italic">Answers</em>. Regarding <em id="Sx3.SSx4.SSSx1.p1.1.14" class="ltx_emph ltx_font_italic">Objects</em>, we follow Pix2Seq <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib7" title="" class="ltx_ref">2022</a>)</cite> to quantize coordinates into bins, which can be regarded as discrete labels. If multiple objects exist, their bounding boxes are randomly shuffled and concatenated to form the result sequence. For <em id="Sx3.SSx4.SSSx1.p1.1.15" class="ltx_emph ltx_font_italic">True/False</em> and <em id="Sx3.SSx4.SSSx1.p1.1.16" class="ltx_emph ltx_font_italic">Answer</em>, we directly use the textual tokens to form the sequence. Additionally, several special tokens are added to sequence for further generation, <em id="Sx3.SSx4.SSSx1.p1.1.17" class="ltx_emph ltx_font_italic">e.g.,</em> [BEG], [SEP], [END], <em id="Sx3.SSx4.SSSx1.p1.1.18" class="ltx_emph ltx_font_italic">etc.</em></p>
</div>
</section>
<section id="Sx3.SSx4.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Intermediate Result Decoder</h4>

<div id="Sx3.SSx4.SSSx2.p1" class="ltx_para">
<p id="Sx3.SSx4.SSSx2.p1.2" class="ltx_p">With the help of intermediate results, VQA model can be optimized using these supervisions. Specifically, a two-layer Transformer is proposed to decode the intermediate outputs from the states <math id="Sx3.SSx4.SSSx2.p1.1.m1.1" class="ltx_Math" alttext="\tilde{\mathbf{S}}^{L}" display="inline"><semantics id="Sx3.SSx4.SSSx2.p1.1.m1.1a"><msup id="Sx3.SSx4.SSSx2.p1.1.m1.1.1" xref="Sx3.SSx4.SSSx2.p1.1.m1.1.1.cmml"><mover accent="true" id="Sx3.SSx4.SSSx2.p1.1.m1.1.1.2" xref="Sx3.SSx4.SSSx2.p1.1.m1.1.1.2.cmml"><mi id="Sx3.SSx4.SSSx2.p1.1.m1.1.1.2.2" xref="Sx3.SSx4.SSSx2.p1.1.m1.1.1.2.2.cmml">𝐒</mi><mo id="Sx3.SSx4.SSSx2.p1.1.m1.1.1.2.1" xref="Sx3.SSx4.SSSx2.p1.1.m1.1.1.2.1.cmml">~</mo></mover><mi id="Sx3.SSx4.SSSx2.p1.1.m1.1.1.3" xref="Sx3.SSx4.SSSx2.p1.1.m1.1.1.3.cmml">L</mi></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx2.p1.1.m1.1b"><apply id="Sx3.SSx4.SSSx2.p1.1.m1.1.1.cmml" xref="Sx3.SSx4.SSSx2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx2.p1.1.m1.1.1.1.cmml" xref="Sx3.SSx4.SSSx2.p1.1.m1.1.1">superscript</csymbol><apply id="Sx3.SSx4.SSSx2.p1.1.m1.1.1.2.cmml" xref="Sx3.SSx4.SSSx2.p1.1.m1.1.1.2"><ci id="Sx3.SSx4.SSSx2.p1.1.m1.1.1.2.1.cmml" xref="Sx3.SSx4.SSSx2.p1.1.m1.1.1.2.1">~</ci><ci id="Sx3.SSx4.SSSx2.p1.1.m1.1.1.2.2.cmml" xref="Sx3.SSx4.SSSx2.p1.1.m1.1.1.2.2">𝐒</ci></apply><ci id="Sx3.SSx4.SSSx2.p1.1.m1.1.1.3.cmml" xref="Sx3.SSx4.SSSx2.p1.1.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx2.p1.1.m1.1c">\tilde{\mathbf{S}}^{L}</annotation></semantics></math>. Firstly, [BEG] token is initialized with the state <math id="Sx3.SSx4.SSSx2.p1.2.m2.1" class="ltx_Math" alttext="\tilde{\mathbf{S}}^{L}_{i}" display="inline"><semantics id="Sx3.SSx4.SSSx2.p1.2.m2.1a"><msubsup id="Sx3.SSx4.SSSx2.p1.2.m2.1.1" xref="Sx3.SSx4.SSSx2.p1.2.m2.1.1.cmml"><mover accent="true" id="Sx3.SSx4.SSSx2.p1.2.m2.1.1.2.2" xref="Sx3.SSx4.SSSx2.p1.2.m2.1.1.2.2.cmml"><mi id="Sx3.SSx4.SSSx2.p1.2.m2.1.1.2.2.2" xref="Sx3.SSx4.SSSx2.p1.2.m2.1.1.2.2.2.cmml">𝐒</mi><mo id="Sx3.SSx4.SSSx2.p1.2.m2.1.1.2.2.1" xref="Sx3.SSx4.SSSx2.p1.2.m2.1.1.2.2.1.cmml">~</mo></mover><mi id="Sx3.SSx4.SSSx2.p1.2.m2.1.1.3" xref="Sx3.SSx4.SSSx2.p1.2.m2.1.1.3.cmml">i</mi><mi id="Sx3.SSx4.SSSx2.p1.2.m2.1.1.2.3" xref="Sx3.SSx4.SSSx2.p1.2.m2.1.1.2.3.cmml">L</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx2.p1.2.m2.1b"><apply id="Sx3.SSx4.SSSx2.p1.2.m2.1.1.cmml" xref="Sx3.SSx4.SSSx2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx2.p1.2.m2.1.1.1.cmml" xref="Sx3.SSx4.SSSx2.p1.2.m2.1.1">subscript</csymbol><apply id="Sx3.SSx4.SSSx2.p1.2.m2.1.1.2.cmml" xref="Sx3.SSx4.SSSx2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx2.p1.2.m2.1.1.2.1.cmml" xref="Sx3.SSx4.SSSx2.p1.2.m2.1.1">superscript</csymbol><apply id="Sx3.SSx4.SSSx2.p1.2.m2.1.1.2.2.cmml" xref="Sx3.SSx4.SSSx2.p1.2.m2.1.1.2.2"><ci id="Sx3.SSx4.SSSx2.p1.2.m2.1.1.2.2.1.cmml" xref="Sx3.SSx4.SSSx2.p1.2.m2.1.1.2.2.1">~</ci><ci id="Sx3.SSx4.SSSx2.p1.2.m2.1.1.2.2.2.cmml" xref="Sx3.SSx4.SSSx2.p1.2.m2.1.1.2.2.2">𝐒</ci></apply><ci id="Sx3.SSx4.SSSx2.p1.2.m2.1.1.2.3.cmml" xref="Sx3.SSx4.SSSx2.p1.2.m2.1.1.2.3">𝐿</ci></apply><ci id="Sx3.SSx4.SSSx2.p1.2.m2.1.1.3.cmml" xref="Sx3.SSx4.SSSx2.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx2.p1.2.m2.1c">\tilde{\mathbf{S}}^{L}_{i}</annotation></semantics></math>, and prompts the decoder to generate output sequence. In the training phase, we use teacher-forcing and auto-regression loss to optimize the model, formulated as follows:</p>
<table id="A4.EGx8" class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table">

<tbody id="Sx3.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E10.m1.10" class="ltx_Math" alttext="\displaystyle\begin{aligned} \{y_{0},y_{1},...,y_{o-1}\}&amp;=\textrm{Decoder}(\tilde{\mathbf{S}}^{L}_{i},\tilde{\mathbf{V}})\\
\mathcal{L}^{DIS}&amp;=-\frac{1}{o}\sum_{i=0}^{o-1}\log(p(y_{i}|y_{0},...,y_{i-1},\tilde{\mathbf{S}}^{L}_{i},\tilde{\mathbf{V}})),\end{aligned}" display="block"><semantics id="Sx3.E10.m1.10a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="Sx3.E10.m1.10.10" xref="Sx3.E10.m1.10.10.cmml"><mtr id="Sx3.E10.m1.10.10a" xref="Sx3.E10.m1.10.10.cmml"><mtd class="ltx_align_right" columnalign="right" id="Sx3.E10.m1.10.10b" xref="Sx3.E10.m1.10.10.cmml"><mrow id="Sx3.E10.m1.4.4.4.4.4.4" xref="Sx3.E10.m1.4.4.4.4.4.5.cmml"><mo stretchy="false" id="Sx3.E10.m1.4.4.4.4.4.4.4" xref="Sx3.E10.m1.4.4.4.4.4.5.cmml">{</mo><msub id="Sx3.E10.m1.2.2.2.2.2.2.1" xref="Sx3.E10.m1.2.2.2.2.2.2.1.cmml"><mi id="Sx3.E10.m1.2.2.2.2.2.2.1.2" xref="Sx3.E10.m1.2.2.2.2.2.2.1.2.cmml">y</mi><mn id="Sx3.E10.m1.2.2.2.2.2.2.1.3" xref="Sx3.E10.m1.2.2.2.2.2.2.1.3.cmml">0</mn></msub><mo id="Sx3.E10.m1.4.4.4.4.4.4.5" xref="Sx3.E10.m1.4.4.4.4.4.5.cmml">,</mo><msub id="Sx3.E10.m1.3.3.3.3.3.3.2" xref="Sx3.E10.m1.3.3.3.3.3.3.2.cmml"><mi id="Sx3.E10.m1.3.3.3.3.3.3.2.2" xref="Sx3.E10.m1.3.3.3.3.3.3.2.2.cmml">y</mi><mn id="Sx3.E10.m1.3.3.3.3.3.3.2.3" xref="Sx3.E10.m1.3.3.3.3.3.3.2.3.cmml">1</mn></msub><mo id="Sx3.E10.m1.4.4.4.4.4.4.6" xref="Sx3.E10.m1.4.4.4.4.4.5.cmml">,</mo><mi mathvariant="normal" id="Sx3.E10.m1.1.1.1.1.1.1" xref="Sx3.E10.m1.1.1.1.1.1.1.cmml">…</mi><mo id="Sx3.E10.m1.4.4.4.4.4.4.7" xref="Sx3.E10.m1.4.4.4.4.4.5.cmml">,</mo><msub id="Sx3.E10.m1.4.4.4.4.4.4.3" xref="Sx3.E10.m1.4.4.4.4.4.4.3.cmml"><mi id="Sx3.E10.m1.4.4.4.4.4.4.3.2" xref="Sx3.E10.m1.4.4.4.4.4.4.3.2.cmml">y</mi><mrow id="Sx3.E10.m1.4.4.4.4.4.4.3.3" xref="Sx3.E10.m1.4.4.4.4.4.4.3.3.cmml"><mi id="Sx3.E10.m1.4.4.4.4.4.4.3.3.2" xref="Sx3.E10.m1.4.4.4.4.4.4.3.3.2.cmml">o</mi><mo id="Sx3.E10.m1.4.4.4.4.4.4.3.3.1" xref="Sx3.E10.m1.4.4.4.4.4.4.3.3.1.cmml">−</mo><mn id="Sx3.E10.m1.4.4.4.4.4.4.3.3.3" xref="Sx3.E10.m1.4.4.4.4.4.4.3.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="Sx3.E10.m1.4.4.4.4.4.4.8" xref="Sx3.E10.m1.4.4.4.4.4.5.cmml">}</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx3.E10.m1.10.10c" xref="Sx3.E10.m1.10.10.cmml"><mrow id="Sx3.E10.m1.6.6.6.6.2" xref="Sx3.E10.m1.6.6.6.6.2.cmml"><mi id="Sx3.E10.m1.6.6.6.6.2.4" xref="Sx3.E10.m1.6.6.6.6.2.4.cmml"></mi><mo id="Sx3.E10.m1.6.6.6.6.2.3" xref="Sx3.E10.m1.6.6.6.6.2.3.cmml">=</mo><mrow id="Sx3.E10.m1.6.6.6.6.2.2" xref="Sx3.E10.m1.6.6.6.6.2.2.cmml"><mtext id="Sx3.E10.m1.6.6.6.6.2.2.3" xref="Sx3.E10.m1.6.6.6.6.2.2.3a.cmml">Decoder</mtext><mo lspace="0em" rspace="0em" id="Sx3.E10.m1.6.6.6.6.2.2.2" xref="Sx3.E10.m1.6.6.6.6.2.2.2.cmml">​</mo><mrow id="Sx3.E10.m1.6.6.6.6.2.2.1.1" xref="Sx3.E10.m1.6.6.6.6.2.2.1.2.cmml"><mo stretchy="false" id="Sx3.E10.m1.6.6.6.6.2.2.1.1.2" xref="Sx3.E10.m1.6.6.6.6.2.2.1.2.cmml">(</mo><msubsup id="Sx3.E10.m1.6.6.6.6.2.2.1.1.1" xref="Sx3.E10.m1.6.6.6.6.2.2.1.1.1.cmml"><mover accent="true" id="Sx3.E10.m1.6.6.6.6.2.2.1.1.1.2.2" xref="Sx3.E10.m1.6.6.6.6.2.2.1.1.1.2.2.cmml"><mi id="Sx3.E10.m1.6.6.6.6.2.2.1.1.1.2.2.2" xref="Sx3.E10.m1.6.6.6.6.2.2.1.1.1.2.2.2.cmml">𝐒</mi><mo id="Sx3.E10.m1.6.6.6.6.2.2.1.1.1.2.2.1" xref="Sx3.E10.m1.6.6.6.6.2.2.1.1.1.2.2.1.cmml">~</mo></mover><mi id="Sx3.E10.m1.6.6.6.6.2.2.1.1.1.3" xref="Sx3.E10.m1.6.6.6.6.2.2.1.1.1.3.cmml">i</mi><mi id="Sx3.E10.m1.6.6.6.6.2.2.1.1.1.2.3" xref="Sx3.E10.m1.6.6.6.6.2.2.1.1.1.2.3.cmml">L</mi></msubsup><mo id="Sx3.E10.m1.6.6.6.6.2.2.1.1.3" xref="Sx3.E10.m1.6.6.6.6.2.2.1.2.cmml">,</mo><mover accent="true" id="Sx3.E10.m1.5.5.5.5.1.1" xref="Sx3.E10.m1.5.5.5.5.1.1.cmml"><mi id="Sx3.E10.m1.5.5.5.5.1.1.2" xref="Sx3.E10.m1.5.5.5.5.1.1.2.cmml">𝐕</mi><mo id="Sx3.E10.m1.5.5.5.5.1.1.1" xref="Sx3.E10.m1.5.5.5.5.1.1.1.cmml">~</mo></mover><mo stretchy="false" id="Sx3.E10.m1.6.6.6.6.2.2.1.1.4" xref="Sx3.E10.m1.6.6.6.6.2.2.1.2.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="Sx3.E10.m1.10.10d" xref="Sx3.E10.m1.10.10.cmml"><mtd class="ltx_align_right" columnalign="right" id="Sx3.E10.m1.10.10e" xref="Sx3.E10.m1.10.10.cmml"><msup id="Sx3.E10.m1.10.10.10.5.1" xref="Sx3.E10.m1.10.10.10.5.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E10.m1.10.10.10.5.1.2" xref="Sx3.E10.m1.10.10.10.5.1.2.cmml">ℒ</mi><mrow id="Sx3.E10.m1.10.10.10.5.1.3" xref="Sx3.E10.m1.10.10.10.5.1.3.cmml"><mi id="Sx3.E10.m1.10.10.10.5.1.3.2" xref="Sx3.E10.m1.10.10.10.5.1.3.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="Sx3.E10.m1.10.10.10.5.1.3.1" xref="Sx3.E10.m1.10.10.10.5.1.3.1.cmml">​</mo><mi id="Sx3.E10.m1.10.10.10.5.1.3.3" xref="Sx3.E10.m1.10.10.10.5.1.3.3.cmml">I</mi><mo lspace="0em" rspace="0em" id="Sx3.E10.m1.10.10.10.5.1.3.1a" xref="Sx3.E10.m1.10.10.10.5.1.3.1.cmml">​</mo><mi id="Sx3.E10.m1.10.10.10.5.1.3.4" xref="Sx3.E10.m1.10.10.10.5.1.3.4.cmml">S</mi></mrow></msup></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx3.E10.m1.10.10f" xref="Sx3.E10.m1.10.10.cmml"><mrow id="Sx3.E10.m1.10.10.10.4.4.4" xref="Sx3.E10.m1.10.10.10.4.4.4.1.cmml"><mrow id="Sx3.E10.m1.10.10.10.4.4.4.1" xref="Sx3.E10.m1.10.10.10.4.4.4.1.cmml"><mi id="Sx3.E10.m1.10.10.10.4.4.4.1.3" xref="Sx3.E10.m1.10.10.10.4.4.4.1.3.cmml"></mi><mo id="Sx3.E10.m1.10.10.10.4.4.4.1.2" xref="Sx3.E10.m1.10.10.10.4.4.4.1.2.cmml">=</mo><mrow id="Sx3.E10.m1.10.10.10.4.4.4.1.1" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.cmml"><mo id="Sx3.E10.m1.10.10.10.4.4.4.1.1a" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.cmml">−</mo><mrow id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.cmml"><mfrac id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.3" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.3.cmml"><mn id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.3.2" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.3.2.cmml">1</mn><mi id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.3.3" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.3.3.cmml">o</mi></mfrac><mo lspace="0em" rspace="0em" id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.2" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.2.cmml">​</mo><mrow id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.cmml"><munderover id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.cmml"><mo movablelimits="false" id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.2.2" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.2.3" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.2.3.cmml"><mi id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.2.3.2" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.2.3.1" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.2.3.3" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.2.3.3.cmml">0</mn></mrow><mrow id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.3" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.3.cmml"><mi id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.3.2" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.3.2.cmml">o</mi><mo id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.3.1" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.3.1.cmml">−</mo><mn id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.3.3" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.3.3.cmml">1</mn></mrow></munderover><mrow id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.2.cmml"><mi id="Sx3.E10.m1.9.9.9.3.3.3" xref="Sx3.E10.m1.9.9.9.3.3.3.cmml">log</mi><mo id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1a" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.2.cmml">⁡</mo><mrow id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.2" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.2.cmml">(</mo><mrow id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.3" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.2" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.5" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.5.cmml"><mi id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.5.2" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.5.2.cmml">y</mi><mi id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.5.3" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.5.3.cmml">i</mi></msub><mo fence="false" id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.4" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.4.cmml">|</mo><mrow id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.4.cmml"><msub id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mn id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.4" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.4.cmml">,</mo><mi mathvariant="normal" id="Sx3.E10.m1.7.7.7.1.1.1" xref="Sx3.E10.m1.7.7.7.1.1.1.cmml">…</mi><mo id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.5" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.4.cmml">,</mo><msub id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mrow id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.2" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml">i</mi><mo id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.1" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml">−</mo><mn id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.3" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.6" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.4.cmml">,</mo><msubsup id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml"><mover accent="true" id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.2.2" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.2.2.cmml"><mi id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.2.2.2" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.2.2.2.cmml">𝐒</mi><mo id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.2.2.1" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.2.2.1.cmml">~</mo></mover><mi id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.3" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml">i</mi><mi id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.2.3" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.2.3.cmml">L</mi></msubsup><mo id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.7" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.4.cmml">,</mo><mover accent="true" id="Sx3.E10.m1.8.8.8.2.2.2" xref="Sx3.E10.m1.8.8.8.2.2.2.cmml"><mi id="Sx3.E10.m1.8.8.8.2.2.2.2" xref="Sx3.E10.m1.8.8.8.2.2.2.2.cmml">𝐕</mi><mo id="Sx3.E10.m1.8.8.8.2.2.2.1" xref="Sx3.E10.m1.8.8.8.2.2.2.1.cmml">~</mo></mover></mrow></mrow><mo stretchy="false" id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.3" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="Sx3.E10.m1.10.10.10.4.4.4.2" xref="Sx3.E10.m1.10.10.10.4.4.4.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="Sx3.E10.m1.10b"><matrix id="Sx3.E10.m1.10.10.cmml" xref="Sx3.E10.m1.10.10"><matrixrow id="Sx3.E10.m1.10.10a.cmml" xref="Sx3.E10.m1.10.10"><set id="Sx3.E10.m1.4.4.4.4.4.5.cmml" xref="Sx3.E10.m1.4.4.4.4.4.4"><apply id="Sx3.E10.m1.2.2.2.2.2.2.1.cmml" xref="Sx3.E10.m1.2.2.2.2.2.2.1"><csymbol cd="ambiguous" id="Sx3.E10.m1.2.2.2.2.2.2.1.1.cmml" xref="Sx3.E10.m1.2.2.2.2.2.2.1">subscript</csymbol><ci id="Sx3.E10.m1.2.2.2.2.2.2.1.2.cmml" xref="Sx3.E10.m1.2.2.2.2.2.2.1.2">𝑦</ci><cn type="integer" id="Sx3.E10.m1.2.2.2.2.2.2.1.3.cmml" xref="Sx3.E10.m1.2.2.2.2.2.2.1.3">0</cn></apply><apply id="Sx3.E10.m1.3.3.3.3.3.3.2.cmml" xref="Sx3.E10.m1.3.3.3.3.3.3.2"><csymbol cd="ambiguous" id="Sx3.E10.m1.3.3.3.3.3.3.2.1.cmml" xref="Sx3.E10.m1.3.3.3.3.3.3.2">subscript</csymbol><ci id="Sx3.E10.m1.3.3.3.3.3.3.2.2.cmml" xref="Sx3.E10.m1.3.3.3.3.3.3.2.2">𝑦</ci><cn type="integer" id="Sx3.E10.m1.3.3.3.3.3.3.2.3.cmml" xref="Sx3.E10.m1.3.3.3.3.3.3.2.3">1</cn></apply><ci id="Sx3.E10.m1.1.1.1.1.1.1.cmml" xref="Sx3.E10.m1.1.1.1.1.1.1">…</ci><apply id="Sx3.E10.m1.4.4.4.4.4.4.3.cmml" xref="Sx3.E10.m1.4.4.4.4.4.4.3"><csymbol cd="ambiguous" id="Sx3.E10.m1.4.4.4.4.4.4.3.1.cmml" xref="Sx3.E10.m1.4.4.4.4.4.4.3">subscript</csymbol><ci id="Sx3.E10.m1.4.4.4.4.4.4.3.2.cmml" xref="Sx3.E10.m1.4.4.4.4.4.4.3.2">𝑦</ci><apply id="Sx3.E10.m1.4.4.4.4.4.4.3.3.cmml" xref="Sx3.E10.m1.4.4.4.4.4.4.3.3"><minus id="Sx3.E10.m1.4.4.4.4.4.4.3.3.1.cmml" xref="Sx3.E10.m1.4.4.4.4.4.4.3.3.1"></minus><ci id="Sx3.E10.m1.4.4.4.4.4.4.3.3.2.cmml" xref="Sx3.E10.m1.4.4.4.4.4.4.3.3.2">𝑜</ci><cn type="integer" id="Sx3.E10.m1.4.4.4.4.4.4.3.3.3.cmml" xref="Sx3.E10.m1.4.4.4.4.4.4.3.3.3">1</cn></apply></apply></set><apply id="Sx3.E10.m1.6.6.6.6.2.cmml" xref="Sx3.E10.m1.6.6.6.6.2"><eq id="Sx3.E10.m1.6.6.6.6.2.3.cmml" xref="Sx3.E10.m1.6.6.6.6.2.3"></eq><csymbol cd="latexml" id="Sx3.E10.m1.6.6.6.6.2.4.cmml" xref="Sx3.E10.m1.6.6.6.6.2.4">absent</csymbol><apply id="Sx3.E10.m1.6.6.6.6.2.2.cmml" xref="Sx3.E10.m1.6.6.6.6.2.2"><times id="Sx3.E10.m1.6.6.6.6.2.2.2.cmml" xref="Sx3.E10.m1.6.6.6.6.2.2.2"></times><ci id="Sx3.E10.m1.6.6.6.6.2.2.3a.cmml" xref="Sx3.E10.m1.6.6.6.6.2.2.3"><mtext id="Sx3.E10.m1.6.6.6.6.2.2.3.cmml" xref="Sx3.E10.m1.6.6.6.6.2.2.3">Decoder</mtext></ci><interval closure="open" id="Sx3.E10.m1.6.6.6.6.2.2.1.2.cmml" xref="Sx3.E10.m1.6.6.6.6.2.2.1.1"><apply id="Sx3.E10.m1.6.6.6.6.2.2.1.1.1.cmml" xref="Sx3.E10.m1.6.6.6.6.2.2.1.1.1"><csymbol cd="ambiguous" id="Sx3.E10.m1.6.6.6.6.2.2.1.1.1.1.cmml" xref="Sx3.E10.m1.6.6.6.6.2.2.1.1.1">subscript</csymbol><apply id="Sx3.E10.m1.6.6.6.6.2.2.1.1.1.2.cmml" xref="Sx3.E10.m1.6.6.6.6.2.2.1.1.1"><csymbol cd="ambiguous" id="Sx3.E10.m1.6.6.6.6.2.2.1.1.1.2.1.cmml" xref="Sx3.E10.m1.6.6.6.6.2.2.1.1.1">superscript</csymbol><apply id="Sx3.E10.m1.6.6.6.6.2.2.1.1.1.2.2.cmml" xref="Sx3.E10.m1.6.6.6.6.2.2.1.1.1.2.2"><ci id="Sx3.E10.m1.6.6.6.6.2.2.1.1.1.2.2.1.cmml" xref="Sx3.E10.m1.6.6.6.6.2.2.1.1.1.2.2.1">~</ci><ci id="Sx3.E10.m1.6.6.6.6.2.2.1.1.1.2.2.2.cmml" xref="Sx3.E10.m1.6.6.6.6.2.2.1.1.1.2.2.2">𝐒</ci></apply><ci id="Sx3.E10.m1.6.6.6.6.2.2.1.1.1.2.3.cmml" xref="Sx3.E10.m1.6.6.6.6.2.2.1.1.1.2.3">𝐿</ci></apply><ci id="Sx3.E10.m1.6.6.6.6.2.2.1.1.1.3.cmml" xref="Sx3.E10.m1.6.6.6.6.2.2.1.1.1.3">𝑖</ci></apply><apply id="Sx3.E10.m1.5.5.5.5.1.1.cmml" xref="Sx3.E10.m1.5.5.5.5.1.1"><ci id="Sx3.E10.m1.5.5.5.5.1.1.1.cmml" xref="Sx3.E10.m1.5.5.5.5.1.1.1">~</ci><ci id="Sx3.E10.m1.5.5.5.5.1.1.2.cmml" xref="Sx3.E10.m1.5.5.5.5.1.1.2">𝐕</ci></apply></interval></apply></apply></matrixrow><matrixrow id="Sx3.E10.m1.10.10b.cmml" xref="Sx3.E10.m1.10.10"><apply id="Sx3.E10.m1.10.10.10.5.1.cmml" xref="Sx3.E10.m1.10.10.10.5.1"><csymbol cd="ambiguous" id="Sx3.E10.m1.10.10.10.5.1.1.cmml" xref="Sx3.E10.m1.10.10.10.5.1">superscript</csymbol><ci id="Sx3.E10.m1.10.10.10.5.1.2.cmml" xref="Sx3.E10.m1.10.10.10.5.1.2">ℒ</ci><apply id="Sx3.E10.m1.10.10.10.5.1.3.cmml" xref="Sx3.E10.m1.10.10.10.5.1.3"><times id="Sx3.E10.m1.10.10.10.5.1.3.1.cmml" xref="Sx3.E10.m1.10.10.10.5.1.3.1"></times><ci id="Sx3.E10.m1.10.10.10.5.1.3.2.cmml" xref="Sx3.E10.m1.10.10.10.5.1.3.2">𝐷</ci><ci id="Sx3.E10.m1.10.10.10.5.1.3.3.cmml" xref="Sx3.E10.m1.10.10.10.5.1.3.3">𝐼</ci><ci id="Sx3.E10.m1.10.10.10.5.1.3.4.cmml" xref="Sx3.E10.m1.10.10.10.5.1.3.4">𝑆</ci></apply></apply><apply id="Sx3.E10.m1.10.10.10.4.4.4.1.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4"><eq id="Sx3.E10.m1.10.10.10.4.4.4.1.2.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.2"></eq><csymbol cd="latexml" id="Sx3.E10.m1.10.10.10.4.4.4.1.3.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.3">absent</csymbol><apply id="Sx3.E10.m1.10.10.10.4.4.4.1.1.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1"><minus id="Sx3.E10.m1.10.10.10.4.4.4.1.1.2.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1"></minus><apply id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1"><times id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.2.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.2"></times><apply id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.3.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.3"><divide id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.3.1.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.3"></divide><cn type="integer" id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.3.2.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.3.2">1</cn><ci id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.3.3.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.3.3">𝑜</ci></apply><apply id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1"><apply id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.1.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2">superscript</csymbol><apply id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.2.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.2.1.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2">subscript</csymbol><sum id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.2.2.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.2.2"></sum><apply id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.2.3.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.2.3"><eq id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.2.3.1.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.2.3.1"></eq><ci id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.2.3.2.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.2.3.3.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.2.3.3">0</cn></apply></apply><apply id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.3.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.3"><minus id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.3.1.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.3.1"></minus><ci id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.3.2.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.3.2">𝑜</ci><cn type="integer" id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.3.3.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.2.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1"><log id="Sx3.E10.m1.9.9.9.3.3.3.cmml" xref="Sx3.E10.m1.9.9.9.3.3.3"></log><apply id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1"><times id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.2"></times><ci id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.3">𝑝</ci><apply id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.4">conditional</csymbol><apply id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.5.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.5.1.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.5">subscript</csymbol><ci id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.5.2.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.5.2">𝑦</ci><ci id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.5.3.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.5.3">𝑖</ci></apply><list id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.4.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3"><apply id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑦</ci><cn type="integer" id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">0</cn></apply><ci id="Sx3.E10.m1.7.7.7.1.1.1.cmml" xref="Sx3.E10.m1.7.7.7.1.1.1">…</ci><apply id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝑦</ci><apply id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3"><minus id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.1"></minus><ci id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.2">𝑖</ci><cn type="integer" id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.3">1</cn></apply></apply><apply id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3">subscript</csymbol><apply id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.2.1.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3">superscript</csymbol><apply id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.2.2.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.2.2"><ci id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.2.2.1.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.2.2.1">~</ci><ci id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.2.2.2.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.2.2.2">𝐒</ci></apply><ci id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.2.3.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.2.3">𝐿</ci></apply><ci id="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="Sx3.E10.m1.10.10.10.4.4.4.1.1.1.1.1.1.1.1.1.1.1.3.3.3.3">𝑖</ci></apply><apply id="Sx3.E10.m1.8.8.8.2.2.2.cmml" xref="Sx3.E10.m1.8.8.8.2.2.2"><ci id="Sx3.E10.m1.8.8.8.2.2.2.1.cmml" xref="Sx3.E10.m1.8.8.8.2.2.2.1">~</ci><ci id="Sx3.E10.m1.8.8.8.2.2.2.2.cmml" xref="Sx3.E10.m1.8.8.8.2.2.2.2">𝐕</ci></apply></list></apply></apply></apply></apply></apply></apply></apply></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E10.m1.10c">\displaystyle\begin{aligned} \{y_{0},y_{1},...,y_{o-1}\}&amp;=\textrm{Decoder}(\tilde{\mathbf{S}}^{L}_{i},\tilde{\mathbf{V}})\\
\mathcal{L}^{DIS}&amp;=-\frac{1}{o}\sum_{i=0}^{o-1}\log(p(y_{i}|y_{0},...,y_{i-1},\tilde{\mathbf{S}}^{L}_{i},\tilde{\mathbf{V}})),\end{aligned}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx4.SSSx2.p1.5" class="ltx_p">where <math id="Sx3.SSx4.SSSx2.p1.3.m1.1" class="ltx_Math" alttext="o" display="inline"><semantics id="Sx3.SSx4.SSSx2.p1.3.m1.1a"><mi id="Sx3.SSx4.SSSx2.p1.3.m1.1.1" xref="Sx3.SSx4.SSSx2.p1.3.m1.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx2.p1.3.m1.1b"><ci id="Sx3.SSx4.SSSx2.p1.3.m1.1.1.cmml" xref="Sx3.SSx4.SSSx2.p1.3.m1.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx2.p1.3.m1.1c">o</annotation></semantics></math> denotes the length of the result sequence. <math id="Sx3.SSx4.SSSx2.p1.4.m2.1" class="ltx_Math" alttext="\tilde{\mathbf{S}}^{L}_{i}\in\mathbb{R}^{d_{h}}" display="inline"><semantics id="Sx3.SSx4.SSSx2.p1.4.m2.1a"><mrow id="Sx3.SSx4.SSSx2.p1.4.m2.1.1" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.cmml"><msubsup id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2.cmml"><mover accent="true" id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2.2.2" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2.2.2.cmml"><mi id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2.2.2.2" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2.2.2.2.cmml">𝐒</mi><mo id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2.2.2.1" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2.2.2.1.cmml">~</mo></mover><mi id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2.3" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2.3.cmml">i</mi><mi id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2.2.3" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2.2.3.cmml">L</mi></msubsup><mo id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.1" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.1.cmml">∈</mo><msup id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.3" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.3.cmml"><mi id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.3.2" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.3.2.cmml">ℝ</mi><msub id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.3.3" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.3.3.cmml"><mi id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.3.3.2" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.3.3.2.cmml">d</mi><mi id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.3.3.3" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.3.3.3.cmml">h</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx2.p1.4.m2.1b"><apply id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.cmml" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1"><in id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.1.cmml" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.1"></in><apply id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2.cmml" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2.1.cmml" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2">subscript</csymbol><apply id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2.2.cmml" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2.2.1.cmml" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2">superscript</csymbol><apply id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2.2.2.cmml" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2.2.2"><ci id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2.2.2.1.cmml" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2.2.2.1">~</ci><ci id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2.2.2.2.cmml" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2.2.2.2">𝐒</ci></apply><ci id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2.2.3.cmml" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2.2.3">𝐿</ci></apply><ci id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2.3.cmml" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.2.3">𝑖</ci></apply><apply id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.3.cmml" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.3.1.cmml" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.3">superscript</csymbol><ci id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.3.2.cmml" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.3.2">ℝ</ci><apply id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.3.3.cmml" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.3.3"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.3.3.1.cmml" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.3.3">subscript</csymbol><ci id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.3.3.2.cmml" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.3.3.2">𝑑</ci><ci id="Sx3.SSx4.SSSx2.p1.4.m2.1.1.3.3.3.cmml" xref="Sx3.SSx4.SSSx2.p1.4.m2.1.1.3.3.3">ℎ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx2.p1.4.m2.1c">\tilde{\mathbf{S}}^{L}_{i}\in\mathbb{R}^{d_{h}}</annotation></semantics></math>
denotes the intermediate state from the <math id="Sx3.SSx4.SSSx2.p1.5.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="Sx3.SSx4.SSSx2.p1.5.m3.1a"><mi id="Sx3.SSx4.SSSx2.p1.5.m3.1.1" xref="Sx3.SSx4.SSSx2.p1.5.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx2.p1.5.m3.1b"><ci id="Sx3.SSx4.SSSx2.p1.5.m3.1.1.cmml" xref="Sx3.SSx4.SSSx2.p1.5.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx2.p1.5.m3.1c">i</annotation></semantics></math>-th program node.</p>
</div>
</section>
<section id="Sx3.SSx4.SSSx3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Model Optimization</h4>

<div id="Sx3.SSx4.SSSx3.p1" class="ltx_para">
<p id="Sx3.SSx4.SSSx3.p1.2" class="ltx_p">In the training phase, the answer prediction loss (Equation <a href="#Sx3.E9" title="In Program Execution ‣ Methodology ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>) and detection-based intermediate supervision loss (Equation <a href="#Sx3.E10" title="In Intermediate Result Decoder ‣ Intermediate Supervision ‣ Methodology ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>) are combined to optimize the model:</p>
<table id="A4.EGx9" class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table">

<tbody id="Sx3.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E11.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}=\mathcal{L}^{VQA}+\alpha\mathcal{L}^{DIS}," display="block"><semantics id="Sx3.E11.m1.1a"><mrow id="Sx3.E11.m1.1.1.1" xref="Sx3.E11.m1.1.1.1.1.cmml"><mrow id="Sx3.E11.m1.1.1.1.1" xref="Sx3.E11.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E11.m1.1.1.1.1.2" xref="Sx3.E11.m1.1.1.1.1.2.cmml">ℒ</mi><mo id="Sx3.E11.m1.1.1.1.1.1" xref="Sx3.E11.m1.1.1.1.1.1.cmml">=</mo><mrow id="Sx3.E11.m1.1.1.1.1.3" xref="Sx3.E11.m1.1.1.1.1.3.cmml"><msup id="Sx3.E11.m1.1.1.1.1.3.2" xref="Sx3.E11.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E11.m1.1.1.1.1.3.2.2" xref="Sx3.E11.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mrow id="Sx3.E11.m1.1.1.1.1.3.2.3" xref="Sx3.E11.m1.1.1.1.1.3.2.3.cmml"><mi id="Sx3.E11.m1.1.1.1.1.3.2.3.2" xref="Sx3.E11.m1.1.1.1.1.3.2.3.2.cmml">V</mi><mo lspace="0em" rspace="0em" id="Sx3.E11.m1.1.1.1.1.3.2.3.1" xref="Sx3.E11.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="Sx3.E11.m1.1.1.1.1.3.2.3.3" xref="Sx3.E11.m1.1.1.1.1.3.2.3.3.cmml">Q</mi><mo lspace="0em" rspace="0em" id="Sx3.E11.m1.1.1.1.1.3.2.3.1a" xref="Sx3.E11.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="Sx3.E11.m1.1.1.1.1.3.2.3.4" xref="Sx3.E11.m1.1.1.1.1.3.2.3.4.cmml">A</mi></mrow></msup><mo id="Sx3.E11.m1.1.1.1.1.3.1" xref="Sx3.E11.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="Sx3.E11.m1.1.1.1.1.3.3" xref="Sx3.E11.m1.1.1.1.1.3.3.cmml"><mi id="Sx3.E11.m1.1.1.1.1.3.3.2" xref="Sx3.E11.m1.1.1.1.1.3.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="Sx3.E11.m1.1.1.1.1.3.3.1" xref="Sx3.E11.m1.1.1.1.1.3.3.1.cmml">​</mo><msup id="Sx3.E11.m1.1.1.1.1.3.3.3" xref="Sx3.E11.m1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E11.m1.1.1.1.1.3.3.3.2" xref="Sx3.E11.m1.1.1.1.1.3.3.3.2.cmml">ℒ</mi><mrow id="Sx3.E11.m1.1.1.1.1.3.3.3.3" xref="Sx3.E11.m1.1.1.1.1.3.3.3.3.cmml"><mi id="Sx3.E11.m1.1.1.1.1.3.3.3.3.2" xref="Sx3.E11.m1.1.1.1.1.3.3.3.3.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="Sx3.E11.m1.1.1.1.1.3.3.3.3.1" xref="Sx3.E11.m1.1.1.1.1.3.3.3.3.1.cmml">​</mo><mi id="Sx3.E11.m1.1.1.1.1.3.3.3.3.3" xref="Sx3.E11.m1.1.1.1.1.3.3.3.3.3.cmml">I</mi><mo lspace="0em" rspace="0em" id="Sx3.E11.m1.1.1.1.1.3.3.3.3.1a" xref="Sx3.E11.m1.1.1.1.1.3.3.3.3.1.cmml">​</mo><mi id="Sx3.E11.m1.1.1.1.1.3.3.3.3.4" xref="Sx3.E11.m1.1.1.1.1.3.3.3.3.4.cmml">S</mi></mrow></msup></mrow></mrow></mrow><mo id="Sx3.E11.m1.1.1.1.2" xref="Sx3.E11.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E11.m1.1b"><apply id="Sx3.E11.m1.1.1.1.1.cmml" xref="Sx3.E11.m1.1.1.1"><eq id="Sx3.E11.m1.1.1.1.1.1.cmml" xref="Sx3.E11.m1.1.1.1.1.1"></eq><ci id="Sx3.E11.m1.1.1.1.1.2.cmml" xref="Sx3.E11.m1.1.1.1.1.2">ℒ</ci><apply id="Sx3.E11.m1.1.1.1.1.3.cmml" xref="Sx3.E11.m1.1.1.1.1.3"><plus id="Sx3.E11.m1.1.1.1.1.3.1.cmml" xref="Sx3.E11.m1.1.1.1.1.3.1"></plus><apply id="Sx3.E11.m1.1.1.1.1.3.2.cmml" xref="Sx3.E11.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="Sx3.E11.m1.1.1.1.1.3.2.1.cmml" xref="Sx3.E11.m1.1.1.1.1.3.2">superscript</csymbol><ci id="Sx3.E11.m1.1.1.1.1.3.2.2.cmml" xref="Sx3.E11.m1.1.1.1.1.3.2.2">ℒ</ci><apply id="Sx3.E11.m1.1.1.1.1.3.2.3.cmml" xref="Sx3.E11.m1.1.1.1.1.3.2.3"><times id="Sx3.E11.m1.1.1.1.1.3.2.3.1.cmml" xref="Sx3.E11.m1.1.1.1.1.3.2.3.1"></times><ci id="Sx3.E11.m1.1.1.1.1.3.2.3.2.cmml" xref="Sx3.E11.m1.1.1.1.1.3.2.3.2">𝑉</ci><ci id="Sx3.E11.m1.1.1.1.1.3.2.3.3.cmml" xref="Sx3.E11.m1.1.1.1.1.3.2.3.3">𝑄</ci><ci id="Sx3.E11.m1.1.1.1.1.3.2.3.4.cmml" xref="Sx3.E11.m1.1.1.1.1.3.2.3.4">𝐴</ci></apply></apply><apply id="Sx3.E11.m1.1.1.1.1.3.3.cmml" xref="Sx3.E11.m1.1.1.1.1.3.3"><times id="Sx3.E11.m1.1.1.1.1.3.3.1.cmml" xref="Sx3.E11.m1.1.1.1.1.3.3.1"></times><ci id="Sx3.E11.m1.1.1.1.1.3.3.2.cmml" xref="Sx3.E11.m1.1.1.1.1.3.3.2">𝛼</ci><apply id="Sx3.E11.m1.1.1.1.1.3.3.3.cmml" xref="Sx3.E11.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="Sx3.E11.m1.1.1.1.1.3.3.3.1.cmml" xref="Sx3.E11.m1.1.1.1.1.3.3.3">superscript</csymbol><ci id="Sx3.E11.m1.1.1.1.1.3.3.3.2.cmml" xref="Sx3.E11.m1.1.1.1.1.3.3.3.2">ℒ</ci><apply id="Sx3.E11.m1.1.1.1.1.3.3.3.3.cmml" xref="Sx3.E11.m1.1.1.1.1.3.3.3.3"><times id="Sx3.E11.m1.1.1.1.1.3.3.3.3.1.cmml" xref="Sx3.E11.m1.1.1.1.1.3.3.3.3.1"></times><ci id="Sx3.E11.m1.1.1.1.1.3.3.3.3.2.cmml" xref="Sx3.E11.m1.1.1.1.1.3.3.3.3.2">𝐷</ci><ci id="Sx3.E11.m1.1.1.1.1.3.3.3.3.3.cmml" xref="Sx3.E11.m1.1.1.1.1.3.3.3.3.3">𝐼</ci><ci id="Sx3.E11.m1.1.1.1.1.3.3.3.3.4.cmml" xref="Sx3.E11.m1.1.1.1.1.3.3.3.3.4">𝑆</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E11.m1.1c">\displaystyle\mathcal{L}=\mathcal{L}^{VQA}+\alpha\mathcal{L}^{DIS},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx4.SSSx3.p1.1" class="ltx_p">where <math id="Sx3.SSx4.SSSx3.p1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="Sx3.SSx4.SSSx3.p1.1.m1.1a"><mi id="Sx3.SSx4.SSSx3.p1.1.m1.1.1" xref="Sx3.SSx4.SSSx3.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx3.p1.1.m1.1b"><ci id="Sx3.SSx4.SSSx3.p1.1.m1.1.1.cmml" xref="Sx3.SSx4.SSSx3.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx3.p1.1.m1.1c">\alpha</annotation></semantics></math> denotes the loss weight of DIS. In the testing phase, DIS module can be removed because only the final answer needs to be predicted.</p>
</div>
</section>
</section>
</section>
<section id="Sx4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Experiments</h2>

<section id="Sx4.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Datasets</h3>

<div id="Sx4.SSx1.p1" class="ltx_para">
<p id="Sx4.SSx1.p1.1" class="ltx_p">To evaluate the answer prediction performance and answering consistency, the reported results in the following sections are evaluated on the widely used GQA <cite class="ltx_cite ltx_citemacro_citep">(Hudson and Manning <a href="#bib.bib16" title="" class="ltx_ref">2019b</a>)</cite> dataset, and its variant GQA-Sub <cite class="ltx_cite ltx_citemacro_citep">(Jing et al. <a href="#bib.bib19" title="" class="ltx_ref">2022b</a>)</cite>.
<span id="Sx4.SSx1.p1.1.1" class="ltx_text ltx_font_bold">GQA</span> <cite class="ltx_cite ltx_citemacro_citep">(Hudson and Manning <a href="#bib.bib16" title="" class="ltx_ref">2019b</a>)</cite> is a compositional visual question-answer dataset, which features compositional questions over the real-world images. It is designed to provide accurate indications of visual understanding capacities and mitigate the language priors that exist widely in previous VQA datasets <cite class="ltx_cite ltx_citemacro_citep">(Agrawal et al. <a href="#bib.bib1" title="" class="ltx_ref">2017</a>)</cite>.
<span id="Sx4.SSx1.p1.1.2" class="ltx_text ltx_font_bold">GQA-Sub</span> <cite class="ltx_cite ltx_citemacro_citep">(Jing et al. <a href="#bib.bib19" title="" class="ltx_ref">2022b</a>)</cite> is derived from the well-organized GQA dataset, and creates sub-questions for <em id="Sx4.SSx1.p1.1.3" class="ltx_emph ltx_font_italic">train</em> and <em id="Sx4.SSx1.p1.1.4" class="ltx_emph ltx_font_italic">val</em> splits, thereby enabling quantitative evaluation of reasoning consistency. More information about GQA and GQA-Sub, as well as their respective evaluation metrics, can be found in Appendix-A.</p>
</div>
</section>
<section id="Sx4.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Implementation Details</h3>

<div id="Sx4.SSx2.p1" class="ltx_para ltx_noindent">
<p id="Sx4.SSx2.p1.1" class="ltx_p"><span id="Sx4.SSx2.p1.1.1" class="ltx_text ltx_font_bold">Program Generation.</span> T5-base<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><span class="ltx_ref ltx_nolink ltx_url ltx_ref_self">https://huggingface.co/docs/transformers/model˙doc/t5</span></span></span></span> is utilized for text transformation, where source and target texts are limited to a maximum length of 40 and 100, respectively. We exploit AdamW optimizer with learning of <math id="Sx4.SSx2.p1.1.m1.1" class="ltx_Math" alttext="1e^{-4}" display="inline"><semantics id="Sx4.SSx2.p1.1.m1.1a"><mrow id="Sx4.SSx2.p1.1.m1.1.1" xref="Sx4.SSx2.p1.1.m1.1.1.cmml"><mn id="Sx4.SSx2.p1.1.m1.1.1.2" xref="Sx4.SSx2.p1.1.m1.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="Sx4.SSx2.p1.1.m1.1.1.1" xref="Sx4.SSx2.p1.1.m1.1.1.1.cmml">​</mo><msup id="Sx4.SSx2.p1.1.m1.1.1.3" xref="Sx4.SSx2.p1.1.m1.1.1.3.cmml"><mi id="Sx4.SSx2.p1.1.m1.1.1.3.2" xref="Sx4.SSx2.p1.1.m1.1.1.3.2.cmml">e</mi><mrow id="Sx4.SSx2.p1.1.m1.1.1.3.3" xref="Sx4.SSx2.p1.1.m1.1.1.3.3.cmml"><mo id="Sx4.SSx2.p1.1.m1.1.1.3.3a" xref="Sx4.SSx2.p1.1.m1.1.1.3.3.cmml">−</mo><mn id="Sx4.SSx2.p1.1.m1.1.1.3.3.2" xref="Sx4.SSx2.p1.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p1.1.m1.1b"><apply id="Sx4.SSx2.p1.1.m1.1.1.cmml" xref="Sx4.SSx2.p1.1.m1.1.1"><times id="Sx4.SSx2.p1.1.m1.1.1.1.cmml" xref="Sx4.SSx2.p1.1.m1.1.1.1"></times><cn type="integer" id="Sx4.SSx2.p1.1.m1.1.1.2.cmml" xref="Sx4.SSx2.p1.1.m1.1.1.2">1</cn><apply id="Sx4.SSx2.p1.1.m1.1.1.3.cmml" xref="Sx4.SSx2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="Sx4.SSx2.p1.1.m1.1.1.3.1.cmml" xref="Sx4.SSx2.p1.1.m1.1.1.3">superscript</csymbol><ci id="Sx4.SSx2.p1.1.m1.1.1.3.2.cmml" xref="Sx4.SSx2.p1.1.m1.1.1.3.2">𝑒</ci><apply id="Sx4.SSx2.p1.1.m1.1.1.3.3.cmml" xref="Sx4.SSx2.p1.1.m1.1.1.3.3"><minus id="Sx4.SSx2.p1.1.m1.1.1.3.3.1.cmml" xref="Sx4.SSx2.p1.1.m1.1.1.3.3"></minus><cn type="integer" id="Sx4.SSx2.p1.1.m1.1.1.3.3.2.cmml" xref="Sx4.SSx2.p1.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p1.1.m1.1c">1e^{-4}</annotation></semantics></math> and batch size of 32 to finetune T5 for 400k steps.</p>
</div>
<div id="Sx4.SSx2.p2" class="ltx_para ltx_noindent">
<p id="Sx4.SSx2.p2.1" class="ltx_p"><span id="Sx4.SSx2.p2.1.1" class="ltx_text ltx_font_bold">Visual Question Answering.</span> Following the settings from MMN <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib8" title="" class="ltx_ref">2021</a>)</cite>, the questions are truncated or padding to the fixed length of 32. The number of nodes in each program tree is limited to 9, and the maximum length <math id="Sx4.SSx2.p2.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="Sx4.SSx2.p2.1.m1.1a"><mi id="Sx4.SSx2.p2.1.m1.1.1" xref="Sx4.SSx2.p2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p2.1.m1.1b"><ci id="Sx4.SSx2.p2.1.m1.1.1.cmml" xref="Sx4.SSx2.p2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p2.1.m1.1c">k</annotation></semantics></math> of each program is set to 8. See the Appendix-B for more implementation details.</p>
</div>
<figure id="Sx4.T1" class="ltx_table">
<table id="Sx4.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="Sx4.T1.1.1.1" class="ltx_tr">
<th id="Sx4.T1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:2.8pt;padding-right:2.8pt;"><span id="Sx4.T1.1.1.1.1.1" class="ltx_text ltx_font_bold">Model</span></th>
<th id="Sx4.T1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:2.8pt;padding-right:2.8pt;"><span id="Sx4.T1.1.1.1.2.1" class="ltx_text ltx_font_bold">Required Inputs</span></th>
<td id="Sx4.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.8pt;padding-right:2.8pt;"><span id="Sx4.T1.1.1.1.3.1" class="ltx_text ltx_font_bold">Binary</span></td>
<td id="Sx4.T1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.8pt;padding-right:2.8pt;"><span id="Sx4.T1.1.1.1.4.1" class="ltx_text ltx_font_bold">Open</span></td>
<td id="Sx4.T1.1.1.1.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.8pt;padding-right:2.8pt;"><span id="Sx4.T1.1.1.1.5.1" class="ltx_text ltx_font_bold">Accuracy</span></td>
</tr>
<tr id="Sx4.T1.1.2.2" class="ltx_tr">
<th id="Sx4.T1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">BUTD</th>
<th id="Sx4.T1.1.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">V+L</th>
<td id="Sx4.T1.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">66.64</td>
<td id="Sx4.T1.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">34.83</td>
<td id="Sx4.T1.1.2.2.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">49.74</td>
</tr>
<tr id="Sx4.T1.1.3.3" class="ltx_tr">
<th id="Sx4.T1.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">MAC</th>
<th id="Sx4.T1.1.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">V+L</th>
<td id="Sx4.T1.1.3.3.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">71.23</td>
<td id="Sx4.T1.1.3.3.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">38.91</td>
<td id="Sx4.T1.1.3.3.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">54.06</td>
</tr>
<tr id="Sx4.T1.1.4.4" class="ltx_tr">
<th id="Sx4.T1.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">GRN</th>
<th id="Sx4.T1.1.4.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">V+L</th>
<td id="Sx4.T1.1.4.4.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">74.93</td>
<td id="Sx4.T1.1.4.4.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">41.24</td>
<td id="Sx4.T1.1.4.4.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">57.04</td>
</tr>
<tr id="Sx4.T1.1.5.5" class="ltx_tr">
<th id="Sx4.T1.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">LCGN</th>
<th id="Sx4.T1.1.5.5.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">V+L</th>
<td id="Sx4.T1.1.5.5.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">73.77</td>
<td id="Sx4.T1.1.5.5.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">42.33</td>
<td id="Sx4.T1.1.5.5.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">57.07</td>
</tr>
<tr id="Sx4.T1.1.6.6" class="ltx_tr">
<th id="Sx4.T1.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">BAN</th>
<th id="Sx4.T1.1.6.6.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">V+L</th>
<td id="Sx4.T1.1.6.6.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">76.00</td>
<td id="Sx4.T1.1.6.6.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">40.41</td>
<td id="Sx4.T1.1.6.6.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">57.10</td>
</tr>
<tr id="Sx4.T1.1.7.7" class="ltx_tr">
<th id="Sx4.T1.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">PVR</th>
<th id="Sx4.T1.1.7.7.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">V+L+Program</th>
<td id="Sx4.T1.1.7.7.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">74.58</td>
<td id="Sx4.T1.1.7.7.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">42.10</td>
<td id="Sx4.T1.1.7.7.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">57.33</td>
</tr>
<tr id="Sx4.T1.1.8.8" class="ltx_tr">
<th id="Sx4.T1.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">LXMERT</th>
<th id="Sx4.T1.1.8.8.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">V+L+Pre-training</th>
<td id="Sx4.T1.1.8.8.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">77.16</td>
<td id="Sx4.T1.1.8.8.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;"><span id="Sx4.T1.1.8.8.4.1" class="ltx_text ltx_font_bold">45.47</span></td>
<td id="Sx4.T1.1.8.8.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">60.33</td>
</tr>
<tr id="Sx4.T1.1.9.9" class="ltx_tr">
<th id="Sx4.T1.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">MCAN</th>
<th id="Sx4.T1.1.9.9.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">V+L</th>
<td id="Sx4.T1.1.9.9.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">75.87</td>
<td id="Sx4.T1.1.9.9.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">42.15</td>
<td id="Sx4.T1.1.9.9.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">57.96</td>
</tr>
<tr id="Sx4.T1.1.10.10" class="ltx_tr">
<th id="Sx4.T1.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">RPR</th>
<th id="Sx4.T1.1.10.10.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">V+L</th>
<td id="Sx4.T1.1.10.10.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">-</td>
<td id="Sx4.T1.1.10.10.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">-</td>
<td id="Sx4.T1.1.10.10.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">59.43</td>
</tr>
<tr id="Sx4.T1.1.11.11" class="ltx_tr">
<th id="Sx4.T1.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">RCVQA</th>
<th id="Sx4.T1.1.11.11.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">V+L+DataAug</th>
<td id="Sx4.T1.1.11.11.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">-</td>
<td id="Sx4.T1.1.11.11.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">-</td>
<td id="Sx4.T1.1.11.11.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">59.58</td>
</tr>
<tr id="Sx4.T1.1.12.12" class="ltx_tr">
<th id="Sx4.T1.1.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">MMN</th>
<th id="Sx4.T1.1.12.12.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">V+L+Program</th>
<td id="Sx4.T1.1.12.12.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">78.90</td>
<td id="Sx4.T1.1.12.12.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">44.89</td>
<td id="Sx4.T1.1.12.12.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">60.83</td>
</tr>
<tr id="Sx4.T1.1.13.13" class="ltx_tr">
<th id="Sx4.T1.1.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:2.8pt;padding-right:2.8pt;">DIS</th>
<th id="Sx4.T1.1.13.13.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:2.8pt;padding-right:2.8pt;">V+L+Program</th>
<td id="Sx4.T1.1.13.13.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.8pt;padding-right:2.8pt;"><span id="Sx4.T1.1.13.13.3.1" class="ltx_text ltx_font_bold">79.36</span></td>
<td id="Sx4.T1.1.13.13.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.8pt;padding-right:2.8pt;">45.36</td>
<td id="Sx4.T1.1.13.13.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.8pt;padding-right:2.8pt;"><span id="Sx4.T1.1.13.13.5.1" class="ltx_text ltx_font_bold">61.31</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Comparison of DIS single model with the state-of-the-art methods on the blind test2019 leaderboard of GQA.</figcaption>
</figure>
<div id="Sx4.SSx2.p3" class="ltx_para ltx_noindent">
<p id="Sx4.SSx2.p3.1" class="ltx_p"><span id="Sx4.SSx2.p3.1.1" class="ltx_text ltx_font_bold">Baselines.</span> Our model is compared with various state-of-the-art approaches excerpted from MMN, including BUTD <cite class="ltx_cite ltx_citemacro_citep">(Anderson et al. <a href="#bib.bib2" title="" class="ltx_ref">2018</a>)</cite>, MAC <cite class="ltx_cite ltx_citemacro_citep">(Hudson and Manning <a href="#bib.bib15" title="" class="ltx_ref">2018</a>)</cite>, GRN <cite class="ltx_cite ltx_citemacro_citep">(Guo, Xu, and Tao <a href="#bib.bib11" title="" class="ltx_ref">2019</a>)</cite>, LCGN <cite class="ltx_cite ltx_citemacro_citep">(Hu et al. <a href="#bib.bib13" title="" class="ltx_ref">2019</a>)</cite>, BAN<cite class="ltx_cite ltx_citemacro_citep">(Kim, Jun, and Zhang <a href="#bib.bib20" title="" class="ltx_ref">2018</a>)</cite>, PVR <cite class="ltx_cite ltx_citemacro_citep">(Li, Wang, and Zhu <a href="#bib.bib22" title="" class="ltx_ref">2019</a>)</cite>, LXMERT <cite class="ltx_cite ltx_citemacro_citep">(Tan and Bansal <a href="#bib.bib28" title="" class="ltx_ref">2019</a>)</cite>, MCAN <cite class="ltx_cite ltx_citemacro_citep">(Yu et al. <a href="#bib.bib32" title="" class="ltx_ref">2019</a>)</cite>, MMN <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib8" title="" class="ltx_ref">2021</a>)</cite>, RPR <cite class="ltx_cite ltx_citemacro_citep">(Jing et al. <a href="#bib.bib18" title="" class="ltx_ref">2022a</a>)</cite>, and RCVQA <cite class="ltx_cite ltx_citemacro_citep">(Jing et al. <a href="#bib.bib19" title="" class="ltx_ref">2022b</a>)</cite>. We did not compare with the NSM <cite class="ltx_cite ltx_citemacro_citep">(Hudson and Manning <a href="#bib.bib14" title="" class="ltx_ref">2019a</a>)</cite> because it utilizes a well-tuned external scene graph generation model.
More information about baselines are provided in Appendix-C.</p>
</div>
</section>
<section id="Sx4.SSx3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Experimental Results</h3>

<div id="Sx4.SSx3.p1" class="ltx_para">
<p id="Sx4.SSx3.p1.1" class="ltx_p">In the experiments, we primarily assessed the performance of our model on answering compositional questions as well as its performance in reasoning consistency. The corresponding experimental results are presented in Table <a href="#Sx4.T1" title="Table 1 ‣ Implementation Details ‣ Experiments ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and Table <a href="#Sx4.T2" title="Table 2 ‣ Experimental Results ‣ Experiments ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, respectively.
The online test results of the state-of-the-art models and our proposed DIS method on the GQA dataset are shown in Table <a href="#Sx4.T1" title="Table 1 ‣ Implementation Details ‣ Experiments ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>,
and these results also reflect the performance of all models on compositional questions.
The required inputs represent the information necessary for the model to predict the answers, where V and L indicate vision and language, respectively, while DataAug represents data augmentation.
As shown, our proposed DIS achieves the best on <em id="Sx4.SSx3.p1.1.1" class="ltx_emph ltx_font_italic">Binary</em>, <em id="Sx4.SSx3.p1.1.2" class="ltx_emph ltx_font_italic">Open</em>, and <em id="Sx4.SSx3.p1.1.3" class="ltx_emph ltx_font_italic">Overall</em> accuracies among the methods listed in Table <a href="#Sx4.T1" title="Table 1 ‣ Implementation Details ‣ Experiments ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Specifically, with basically the same inputs and settings as MMN, DIS method outperforms MMN by a margin of +0.46% and +0.47% for <em id="Sx4.SSx3.p1.1.4" class="ltx_emph ltx_font_italic">Binary</em> and <em id="Sx4.SSx3.p1.1.5" class="ltx_emph ltx_font_italic">Open</em> questions, respectively.</p>
</div>
<figure id="Sx4.T2" class="ltx_table">
<table id="Sx4.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="Sx4.T2.1.1.1" class="ltx_tr">
<th id="Sx4.T2.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:2.8pt;padding-right:2.8pt;"><span id="Sx4.T2.1.1.1.1.1" class="ltx_text ltx_font_bold">Methods</span></th>
<td id="Sx4.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.8pt;padding-right:2.8pt;"><span id="Sx4.T2.1.1.1.2.1" class="ltx_text ltx_font_bold">Acc</span></td>
<td id="Sx4.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.8pt;padding-right:2.8pt;"><span id="Sx4.T2.1.1.1.3.1" class="ltx_text ltx_font_bold">Acc(Sub)</span></td>
<td id="Sx4.T2.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.8pt;padding-right:2.8pt;"><span id="Sx4.T2.1.1.1.4.1" class="ltx_text ltx_font_bold">RC(1)</span></td>
<td id="Sx4.T2.1.1.1.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.8pt;padding-right:2.8pt;"><span id="Sx4.T2.1.1.1.5.1" class="ltx_text ltx_font_bold">RC(2)</span></td>
<td id="Sx4.T2.1.1.1.6" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.8pt;padding-right:2.8pt;"><span id="Sx4.T2.1.1.1.6.1" class="ltx_text ltx_font_bold">RC(3)</span></td>
</tr>
<tr id="Sx4.T2.1.2.2" class="ltx_tr">
<th id="Sx4.T2.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">Language-only</th>
<td id="Sx4.T2.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">43.86</td>
<td id="Sx4.T2.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">41.16</td>
<td id="Sx4.T2.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">31.61</td>
<td id="Sx4.T2.1.2.2.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">18.81</td>
<td id="Sx4.T2.1.2.2.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">7.31</td>
</tr>
<tr id="Sx4.T2.1.3.3" class="ltx_tr">
<th id="Sx4.T2.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">Visual-only</th>
<td id="Sx4.T2.1.3.3.2" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">56.63</td>
<td id="Sx4.T2.1.3.3.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">53.97</td>
<td id="Sx4.T2.1.3.3.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">46.63</td>
<td id="Sx4.T2.1.3.3.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">28.16</td>
<td id="Sx4.T2.1.3.3.6" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">16.26</td>
</tr>
<tr id="Sx4.T2.1.4.4" class="ltx_tr">
<th id="Sx4.T2.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">MAC</th>
<td id="Sx4.T2.1.4.4.2" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">62.08</td>
<td id="Sx4.T2.1.4.4.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">62.63</td>
<td id="Sx4.T2.1.4.4.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">56.10</td>
<td id="Sx4.T2.1.4.4.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">41.67</td>
<td id="Sx4.T2.1.4.4.6" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">33.96</td>
</tr>
<tr id="Sx4.T2.1.5.5" class="ltx_tr">
<th id="Sx4.T2.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">MAC + DA</th>
<td id="Sx4.T2.1.5.5.2" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">61.04</td>
<td id="Sx4.T2.1.5.5.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">71.42</td>
<td id="Sx4.T2.1.5.5.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">65.78</td>
<td id="Sx4.T2.1.5.5.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">54.09</td>
<td id="Sx4.T2.1.5.5.6" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">43.14</td>
</tr>
<tr id="Sx4.T2.1.6.6" class="ltx_tr">
<th id="Sx4.T2.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">LCGN</th>
<td id="Sx4.T2.1.6.6.2" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">64.16</td>
<td id="Sx4.T2.1.6.6.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">63.74</td>
<td id="Sx4.T2.1.6.6.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">57.37</td>
<td id="Sx4.T2.1.6.6.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">44.32</td>
<td id="Sx4.T2.1.6.6.6" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">35.09</td>
</tr>
<tr id="Sx4.T2.1.7.7" class="ltx_tr">
<th id="Sx4.T2.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">LCGN + DA</th>
<td id="Sx4.T2.1.7.7.2" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">64.14</td>
<td id="Sx4.T2.1.7.7.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">73.46</td>
<td id="Sx4.T2.1.7.7.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">68.93</td>
<td id="Sx4.T2.1.7.7.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">58.94</td>
<td id="Sx4.T2.1.7.7.6" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">50.05</td>
</tr>
<tr id="Sx4.T2.1.8.8" class="ltx_tr">
<th id="Sx4.T2.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">MMN</th>
<td id="Sx4.T2.1.8.8.2" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">65.05</td>
<td id="Sx4.T2.1.8.8.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">64.46</td>
<td id="Sx4.T2.1.8.8.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">58.79</td>
<td id="Sx4.T2.1.8.8.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">43.98</td>
<td id="Sx4.T2.1.8.8.6" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">33.96</td>
</tr>
<tr id="Sx4.T2.1.9.9" class="ltx_tr">
<th id="Sx4.T2.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">MMN + DA</th>
<td id="Sx4.T2.1.9.9.2" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">65.65</td>
<td id="Sx4.T2.1.9.9.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">74.60</td>
<td id="Sx4.T2.1.9.9.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">69.59</td>
<td id="Sx4.T2.1.9.9.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">57.98</td>
<td id="Sx4.T2.1.9.9.6" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">48.17</td>
</tr>
<tr id="Sx4.T2.1.10.10" class="ltx_tr">
<th id="Sx4.T2.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">RCVQA + DA</th>
<td id="Sx4.T2.1.10.10.2" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">66.26</td>
<td id="Sx4.T2.1.10.10.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">76.02</td>
<td id="Sx4.T2.1.10.10.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">71.47</td>
<td id="Sx4.T2.1.10.10.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">61.94</td>
<td id="Sx4.T2.1.10.10.6" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">52.80</td>
</tr>
<tr id="Sx4.T2.1.11.11" class="ltx_tr">
<th id="Sx4.T2.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">DIS</th>
<td id="Sx4.T2.1.11.11.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">69.71</td>
<td id="Sx4.T2.1.11.11.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">70.31</td>
<td id="Sx4.T2.1.11.11.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">64.98</td>
<td id="Sx4.T2.1.11.11.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">53.55</td>
<td id="Sx4.T2.1.11.11.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">48.86</td>
</tr>
<tr id="Sx4.T2.1.12.12" class="ltx_tr">
<th id="Sx4.T2.1.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:2.8pt;padding-right:2.8pt;">DIS + DA</th>
<td id="Sx4.T2.1.12.12.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.8pt;padding-right:2.8pt;"><span id="Sx4.T2.1.12.12.2.1" class="ltx_text ltx_font_bold">69.81</span></td>
<td id="Sx4.T2.1.12.12.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.8pt;padding-right:2.8pt;"><span id="Sx4.T2.1.12.12.3.1" class="ltx_text ltx_font_bold">77.91</span></td>
<td id="Sx4.T2.1.12.12.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.8pt;padding-right:2.8pt;"><span id="Sx4.T2.1.12.12.4.1" class="ltx_text ltx_font_bold">73.11</span></td>
<td id="Sx4.T2.1.12.12.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.8pt;padding-right:2.8pt;"><span id="Sx4.T2.1.12.12.5.1" class="ltx_text ltx_font_bold">64.20</span></td>
<td id="Sx4.T2.1.12.12.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.8pt;padding-right:2.8pt;"><span id="Sx4.T2.1.12.12.6.1" class="ltx_text ltx_font_bold">55.28</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Results of our proposed DIS method and the state-of-the-arts on GQA-Sub. The “DA” denotes the data augmentation.</figcaption>
</figure>
<div id="Sx4.SSx3.p2" class="ltx_para">
<p id="Sx4.SSx3.p2.5" class="ltx_p">Also, we evaluate the performance of the proposed DIS in terms of reasoning consistency. The results regarding accuracy (<em id="Sx4.SSx3.p2.5.1" class="ltx_emph ltx_font_italic">i.e.,</em> Acc and Acc(Sub)) and reasoning consistency (<em id="Sx4.SSx3.p2.5.2" class="ltx_emph ltx_font_italic">i.e.,</em> <math id="Sx4.SSx3.p2.1.m1.1" class="ltx_Math" alttext="\textrm{RC}(k)" display="inline"><semantics id="Sx4.SSx3.p2.1.m1.1a"><mrow id="Sx4.SSx3.p2.1.m1.1.2" xref="Sx4.SSx3.p2.1.m1.1.2.cmml"><mtext id="Sx4.SSx3.p2.1.m1.1.2.2" xref="Sx4.SSx3.p2.1.m1.1.2.2a.cmml">RC</mtext><mo lspace="0em" rspace="0em" id="Sx4.SSx3.p2.1.m1.1.2.1" xref="Sx4.SSx3.p2.1.m1.1.2.1.cmml">​</mo><mrow id="Sx4.SSx3.p2.1.m1.1.2.3.2" xref="Sx4.SSx3.p2.1.m1.1.2.cmml"><mo stretchy="false" id="Sx4.SSx3.p2.1.m1.1.2.3.2.1" xref="Sx4.SSx3.p2.1.m1.1.2.cmml">(</mo><mi id="Sx4.SSx3.p2.1.m1.1.1" xref="Sx4.SSx3.p2.1.m1.1.1.cmml">k</mi><mo stretchy="false" id="Sx4.SSx3.p2.1.m1.1.2.3.2.2" xref="Sx4.SSx3.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.p2.1.m1.1b"><apply id="Sx4.SSx3.p2.1.m1.1.2.cmml" xref="Sx4.SSx3.p2.1.m1.1.2"><times id="Sx4.SSx3.p2.1.m1.1.2.1.cmml" xref="Sx4.SSx3.p2.1.m1.1.2.1"></times><ci id="Sx4.SSx3.p2.1.m1.1.2.2a.cmml" xref="Sx4.SSx3.p2.1.m1.1.2.2"><mtext id="Sx4.SSx3.p2.1.m1.1.2.2.cmml" xref="Sx4.SSx3.p2.1.m1.1.2.2">RC</mtext></ci><ci id="Sx4.SSx3.p2.1.m1.1.1.cmml" xref="Sx4.SSx3.p2.1.m1.1.1">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.p2.1.m1.1c">\textrm{RC}(k)</annotation></semantics></math>, refer to Appendix-A for details) of our proposed DIS and state-of-the-art methods are presented in Table <a href="#Sx4.T2" title="Table 2 ‣ Experimental Results ‣ Experiments ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Acc and Acc(Sub) denote the accuracies on <em id="Sx4.SSx3.p2.5.3" class="ltx_emph ltx_font_italic">val</em> and <em id="Sx4.SSx3.p2.5.4" class="ltx_emph ltx_font_italic">val-sub</em> splits, respectively. <span id="Sx4.SSx3.p2.5.5" class="ltx_text ltx_markedasmath">DA</span> indicates the usage of augmented sub-questions for model training. As Table <a href="#Sx4.T2" title="Table 2 ‣ Experimental Results ‣ Experiments ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows, our proposed DIS surpasses the other state-of-the-art methods on both accuracy and reasoning consistency metrics.
Specifically, without data augmentation of sub-questions, DIS outperforms MMN by a large margin of 4.66% and 5.85% on <em id="Sx4.SSx3.p2.5.6" class="ltx_emph ltx_font_italic">val</em> and <em id="Sx4.SSx3.p2.5.7" class="ltx_emph ltx_font_italic">val-sub</em> splits, respectively. The reasoning consistency is also significantly improved by using our DIS algorithm, <em id="Sx4.SSx3.p2.5.8" class="ltx_emph ltx_font_italic">i.e.,</em> a margin of <span id="Sx4.SSx3.p2.5.9" class="ltx_text ltx_font_bold">6.19</span>%, <span id="Sx4.SSx3.p2.5.10" class="ltx_text ltx_font_bold">9.57</span>%, and <span id="Sx4.SSx3.p2.5.11" class="ltx_text ltx_font_bold">14.9</span>% on <math id="Sx4.SSx3.p2.3.m3.1" class="ltx_Math" alttext="\textrm{RC}(1)" display="inline"><semantics id="Sx4.SSx3.p2.3.m3.1a"><mrow id="Sx4.SSx3.p2.3.m3.1.2" xref="Sx4.SSx3.p2.3.m3.1.2.cmml"><mtext id="Sx4.SSx3.p2.3.m3.1.2.2" xref="Sx4.SSx3.p2.3.m3.1.2.2a.cmml">RC</mtext><mo lspace="0em" rspace="0em" id="Sx4.SSx3.p2.3.m3.1.2.1" xref="Sx4.SSx3.p2.3.m3.1.2.1.cmml">​</mo><mrow id="Sx4.SSx3.p2.3.m3.1.2.3.2" xref="Sx4.SSx3.p2.3.m3.1.2.cmml"><mo stretchy="false" id="Sx4.SSx3.p2.3.m3.1.2.3.2.1" xref="Sx4.SSx3.p2.3.m3.1.2.cmml">(</mo><mn id="Sx4.SSx3.p2.3.m3.1.1" xref="Sx4.SSx3.p2.3.m3.1.1.cmml">1</mn><mo stretchy="false" id="Sx4.SSx3.p2.3.m3.1.2.3.2.2" xref="Sx4.SSx3.p2.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.p2.3.m3.1b"><apply id="Sx4.SSx3.p2.3.m3.1.2.cmml" xref="Sx4.SSx3.p2.3.m3.1.2"><times id="Sx4.SSx3.p2.3.m3.1.2.1.cmml" xref="Sx4.SSx3.p2.3.m3.1.2.1"></times><ci id="Sx4.SSx3.p2.3.m3.1.2.2a.cmml" xref="Sx4.SSx3.p2.3.m3.1.2.2"><mtext id="Sx4.SSx3.p2.3.m3.1.2.2.cmml" xref="Sx4.SSx3.p2.3.m3.1.2.2">RC</mtext></ci><cn type="integer" id="Sx4.SSx3.p2.3.m3.1.1.cmml" xref="Sx4.SSx3.p2.3.m3.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.p2.3.m3.1c">\textrm{RC}(1)</annotation></semantics></math>, <math id="Sx4.SSx3.p2.4.m4.1" class="ltx_Math" alttext="\textrm{RC}(2)" display="inline"><semantics id="Sx4.SSx3.p2.4.m4.1a"><mrow id="Sx4.SSx3.p2.4.m4.1.2" xref="Sx4.SSx3.p2.4.m4.1.2.cmml"><mtext id="Sx4.SSx3.p2.4.m4.1.2.2" xref="Sx4.SSx3.p2.4.m4.1.2.2a.cmml">RC</mtext><mo lspace="0em" rspace="0em" id="Sx4.SSx3.p2.4.m4.1.2.1" xref="Sx4.SSx3.p2.4.m4.1.2.1.cmml">​</mo><mrow id="Sx4.SSx3.p2.4.m4.1.2.3.2" xref="Sx4.SSx3.p2.4.m4.1.2.cmml"><mo stretchy="false" id="Sx4.SSx3.p2.4.m4.1.2.3.2.1" xref="Sx4.SSx3.p2.4.m4.1.2.cmml">(</mo><mn id="Sx4.SSx3.p2.4.m4.1.1" xref="Sx4.SSx3.p2.4.m4.1.1.cmml">2</mn><mo stretchy="false" id="Sx4.SSx3.p2.4.m4.1.2.3.2.2" xref="Sx4.SSx3.p2.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.p2.4.m4.1b"><apply id="Sx4.SSx3.p2.4.m4.1.2.cmml" xref="Sx4.SSx3.p2.4.m4.1.2"><times id="Sx4.SSx3.p2.4.m4.1.2.1.cmml" xref="Sx4.SSx3.p2.4.m4.1.2.1"></times><ci id="Sx4.SSx3.p2.4.m4.1.2.2a.cmml" xref="Sx4.SSx3.p2.4.m4.1.2.2"><mtext id="Sx4.SSx3.p2.4.m4.1.2.2.cmml" xref="Sx4.SSx3.p2.4.m4.1.2.2">RC</mtext></ci><cn type="integer" id="Sx4.SSx3.p2.4.m4.1.1.cmml" xref="Sx4.SSx3.p2.4.m4.1.1">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.p2.4.m4.1c">\textrm{RC}(2)</annotation></semantics></math>, and <math id="Sx4.SSx3.p2.5.m5.1" class="ltx_Math" alttext="\textrm{RC}(3)" display="inline"><semantics id="Sx4.SSx3.p2.5.m5.1a"><mrow id="Sx4.SSx3.p2.5.m5.1.2" xref="Sx4.SSx3.p2.5.m5.1.2.cmml"><mtext id="Sx4.SSx3.p2.5.m5.1.2.2" xref="Sx4.SSx3.p2.5.m5.1.2.2a.cmml">RC</mtext><mo lspace="0em" rspace="0em" id="Sx4.SSx3.p2.5.m5.1.2.1" xref="Sx4.SSx3.p2.5.m5.1.2.1.cmml">​</mo><mrow id="Sx4.SSx3.p2.5.m5.1.2.3.2" xref="Sx4.SSx3.p2.5.m5.1.2.cmml"><mo stretchy="false" id="Sx4.SSx3.p2.5.m5.1.2.3.2.1" xref="Sx4.SSx3.p2.5.m5.1.2.cmml">(</mo><mn id="Sx4.SSx3.p2.5.m5.1.1" xref="Sx4.SSx3.p2.5.m5.1.1.cmml">3</mn><mo stretchy="false" id="Sx4.SSx3.p2.5.m5.1.2.3.2.2" xref="Sx4.SSx3.p2.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.p2.5.m5.1b"><apply id="Sx4.SSx3.p2.5.m5.1.2.cmml" xref="Sx4.SSx3.p2.5.m5.1.2"><times id="Sx4.SSx3.p2.5.m5.1.2.1.cmml" xref="Sx4.SSx3.p2.5.m5.1.2.1"></times><ci id="Sx4.SSx3.p2.5.m5.1.2.2a.cmml" xref="Sx4.SSx3.p2.5.m5.1.2.2"><mtext id="Sx4.SSx3.p2.5.m5.1.2.2.cmml" xref="Sx4.SSx3.p2.5.m5.1.2.2">RC</mtext></ci><cn type="integer" id="Sx4.SSx3.p2.5.m5.1.1.cmml" xref="Sx4.SSx3.p2.5.m5.1.1">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.p2.5.m5.1c">\textrm{RC}(3)</annotation></semantics></math>, respectively.
Such superiority stems from the comprehensive yet noise-free supervisions of intermediate results provided by DIS, significantly enhancing the ability of the model to answer compositional questions and corresponding sub-questions.
When we trained the DIS with sub-questions in <em id="Sx4.SSx3.p2.5.12" class="ltx_emph ltx_font_italic">train-sub</em> as a form of data augmentation, our proposed DIS even outperforms the best-performing RCVQA model that is tailored for enhancing reasoning consistency through the incorporation of a consistency constraint loss. Specifically, DIS surpasses RCVQA by a significant margin of 3.55% on Acc and over 1.64%, 2.26% and 2.48% on the three reasoning consistency metrics, respectively, which indicates the effectiveness of our proposed method.</p>
</div>
</section>
<section id="Sx4.SSx4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Ablation Studies</h3>

<figure id="Sx4.F5" class="ltx_figure"><img src="/html/2312.16012/assets/x5.png" id="Sx4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="538" height="198" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Visualization of intermediate results and predicted answers from MMN and our proposed DIS model. </figcaption>
</figure>
<div id="Sx4.SSx4.p1" class="ltx_para">
<p id="Sx4.SSx4.p1.1" class="ltx_p">In this section, a series of ablations are conducted on GQA dataset to investigate the effectiveness of our proposed method. All the models are trained on <em id="Sx4.SSx4.p1.1.1" class="ltx_emph ltx_font_italic">train+val</em> split, and evaluated on <em id="Sx4.SSx4.p1.1.2" class="ltx_emph ltx_font_italic">testdev</em> split. The experimental settings are kept consistent throughout ablation studies.</p>
</div>
<figure id="Sx4.T3" class="ltx_table">
<table id="Sx4.T3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="Sx4.T3.1.1.1" class="ltx_tr">
<th id="Sx4.T3.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="Sx4.T3.1.1.1.1.1" class="ltx_text ltx_font_bold">Format</span></th>
<th id="Sx4.T3.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="Sx4.T3.1.1.1.2.1" class="ltx_text ltx_font_bold">Accuracy</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="Sx4.T3.1.2.1" class="ltx_tr">
<th id="Sx4.T3.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">name, x1, y1, x2, y2</th>
<td id="Sx4.T3.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">59.40</td>
</tr>
<tr id="Sx4.T3.1.3.2" class="ltx_tr">
<th id="Sx4.T3.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">x1, y1, x2, y2, name</th>
<td id="Sx4.T3.1.3.2.2" class="ltx_td ltx_align_center">59.85</td>
</tr>
<tr id="Sx4.T3.1.4.3" class="ltx_tr">
<th id="Sx4.T3.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">x1, y1, x2, y2</th>
<td id="Sx4.T3.1.4.3.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="Sx4.T3.1.4.3.2.1" class="ltx_text ltx_font_bold">59.97</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Results of different object supervision formats.</figcaption>
</figure>
<div id="Sx4.SSx4.p2" class="ltx_para ltx_noindent">
<p id="Sx4.SSx4.p2.3" class="ltx_p"><span id="Sx4.SSx4.p2.3.1" class="ltx_text ltx_font_bold">Different <em id="Sx4.SSx4.p2.3.1.1" class="ltx_emph ltx_font_italic">Object</em> supervision format: </span>Table <a href="#Sx4.T3" title="Table 3 ‣ Ablation Studies ‣ Experiments ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the results with different object supervision formats. <math id="Sx4.SSx4.p2.1.m1.2" class="ltx_Math" alttext="(x1,y1)" display="inline"><semantics id="Sx4.SSx4.p2.1.m1.2a"><mrow id="Sx4.SSx4.p2.1.m1.2.2.2" xref="Sx4.SSx4.p2.1.m1.2.2.3.cmml"><mo stretchy="false" id="Sx4.SSx4.p2.1.m1.2.2.2.3" xref="Sx4.SSx4.p2.1.m1.2.2.3.cmml">(</mo><mrow id="Sx4.SSx4.p2.1.m1.1.1.1.1" xref="Sx4.SSx4.p2.1.m1.1.1.1.1.cmml"><mi id="Sx4.SSx4.p2.1.m1.1.1.1.1.2" xref="Sx4.SSx4.p2.1.m1.1.1.1.1.2.cmml">x</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx4.p2.1.m1.1.1.1.1.1" xref="Sx4.SSx4.p2.1.m1.1.1.1.1.1.cmml">​</mo><mn id="Sx4.SSx4.p2.1.m1.1.1.1.1.3" xref="Sx4.SSx4.p2.1.m1.1.1.1.1.3.cmml">1</mn></mrow><mo id="Sx4.SSx4.p2.1.m1.2.2.2.4" xref="Sx4.SSx4.p2.1.m1.2.2.3.cmml">,</mo><mrow id="Sx4.SSx4.p2.1.m1.2.2.2.2" xref="Sx4.SSx4.p2.1.m1.2.2.2.2.cmml"><mi id="Sx4.SSx4.p2.1.m1.2.2.2.2.2" xref="Sx4.SSx4.p2.1.m1.2.2.2.2.2.cmml">y</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx4.p2.1.m1.2.2.2.2.1" xref="Sx4.SSx4.p2.1.m1.2.2.2.2.1.cmml">​</mo><mn id="Sx4.SSx4.p2.1.m1.2.2.2.2.3" xref="Sx4.SSx4.p2.1.m1.2.2.2.2.3.cmml">1</mn></mrow><mo stretchy="false" id="Sx4.SSx4.p2.1.m1.2.2.2.5" xref="Sx4.SSx4.p2.1.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx4.p2.1.m1.2b"><interval closure="open" id="Sx4.SSx4.p2.1.m1.2.2.3.cmml" xref="Sx4.SSx4.p2.1.m1.2.2.2"><apply id="Sx4.SSx4.p2.1.m1.1.1.1.1.cmml" xref="Sx4.SSx4.p2.1.m1.1.1.1.1"><times id="Sx4.SSx4.p2.1.m1.1.1.1.1.1.cmml" xref="Sx4.SSx4.p2.1.m1.1.1.1.1.1"></times><ci id="Sx4.SSx4.p2.1.m1.1.1.1.1.2.cmml" xref="Sx4.SSx4.p2.1.m1.1.1.1.1.2">𝑥</ci><cn type="integer" id="Sx4.SSx4.p2.1.m1.1.1.1.1.3.cmml" xref="Sx4.SSx4.p2.1.m1.1.1.1.1.3">1</cn></apply><apply id="Sx4.SSx4.p2.1.m1.2.2.2.2.cmml" xref="Sx4.SSx4.p2.1.m1.2.2.2.2"><times id="Sx4.SSx4.p2.1.m1.2.2.2.2.1.cmml" xref="Sx4.SSx4.p2.1.m1.2.2.2.2.1"></times><ci id="Sx4.SSx4.p2.1.m1.2.2.2.2.2.cmml" xref="Sx4.SSx4.p2.1.m1.2.2.2.2.2">𝑦</ci><cn type="integer" id="Sx4.SSx4.p2.1.m1.2.2.2.2.3.cmml" xref="Sx4.SSx4.p2.1.m1.2.2.2.2.3">1</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx4.p2.1.m1.2c">(x1,y1)</annotation></semantics></math>, <math id="Sx4.SSx4.p2.2.m2.2" class="ltx_Math" alttext="(x2,y2)" display="inline"><semantics id="Sx4.SSx4.p2.2.m2.2a"><mrow id="Sx4.SSx4.p2.2.m2.2.2.2" xref="Sx4.SSx4.p2.2.m2.2.2.3.cmml"><mo stretchy="false" id="Sx4.SSx4.p2.2.m2.2.2.2.3" xref="Sx4.SSx4.p2.2.m2.2.2.3.cmml">(</mo><mrow id="Sx4.SSx4.p2.2.m2.1.1.1.1" xref="Sx4.SSx4.p2.2.m2.1.1.1.1.cmml"><mi id="Sx4.SSx4.p2.2.m2.1.1.1.1.2" xref="Sx4.SSx4.p2.2.m2.1.1.1.1.2.cmml">x</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx4.p2.2.m2.1.1.1.1.1" xref="Sx4.SSx4.p2.2.m2.1.1.1.1.1.cmml">​</mo><mn id="Sx4.SSx4.p2.2.m2.1.1.1.1.3" xref="Sx4.SSx4.p2.2.m2.1.1.1.1.3.cmml">2</mn></mrow><mo id="Sx4.SSx4.p2.2.m2.2.2.2.4" xref="Sx4.SSx4.p2.2.m2.2.2.3.cmml">,</mo><mrow id="Sx4.SSx4.p2.2.m2.2.2.2.2" xref="Sx4.SSx4.p2.2.m2.2.2.2.2.cmml"><mi id="Sx4.SSx4.p2.2.m2.2.2.2.2.2" xref="Sx4.SSx4.p2.2.m2.2.2.2.2.2.cmml">y</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx4.p2.2.m2.2.2.2.2.1" xref="Sx4.SSx4.p2.2.m2.2.2.2.2.1.cmml">​</mo><mn id="Sx4.SSx4.p2.2.m2.2.2.2.2.3" xref="Sx4.SSx4.p2.2.m2.2.2.2.2.3.cmml">2</mn></mrow><mo stretchy="false" id="Sx4.SSx4.p2.2.m2.2.2.2.5" xref="Sx4.SSx4.p2.2.m2.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx4.p2.2.m2.2b"><interval closure="open" id="Sx4.SSx4.p2.2.m2.2.2.3.cmml" xref="Sx4.SSx4.p2.2.m2.2.2.2"><apply id="Sx4.SSx4.p2.2.m2.1.1.1.1.cmml" xref="Sx4.SSx4.p2.2.m2.1.1.1.1"><times id="Sx4.SSx4.p2.2.m2.1.1.1.1.1.cmml" xref="Sx4.SSx4.p2.2.m2.1.1.1.1.1"></times><ci id="Sx4.SSx4.p2.2.m2.1.1.1.1.2.cmml" xref="Sx4.SSx4.p2.2.m2.1.1.1.1.2">𝑥</ci><cn type="integer" id="Sx4.SSx4.p2.2.m2.1.1.1.1.3.cmml" xref="Sx4.SSx4.p2.2.m2.1.1.1.1.3">2</cn></apply><apply id="Sx4.SSx4.p2.2.m2.2.2.2.2.cmml" xref="Sx4.SSx4.p2.2.m2.2.2.2.2"><times id="Sx4.SSx4.p2.2.m2.2.2.2.2.1.cmml" xref="Sx4.SSx4.p2.2.m2.2.2.2.2.1"></times><ci id="Sx4.SSx4.p2.2.m2.2.2.2.2.2.cmml" xref="Sx4.SSx4.p2.2.m2.2.2.2.2.2">𝑦</ci><cn type="integer" id="Sx4.SSx4.p2.2.m2.2.2.2.2.3.cmml" xref="Sx4.SSx4.p2.2.m2.2.2.2.2.3">2</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx4.p2.2.m2.2c">(x2,y2)</annotation></semantics></math> and <math id="Sx4.SSx4.p2.3.m3.1" class="ltx_Math" alttext="name" display="inline"><semantics id="Sx4.SSx4.p2.3.m3.1a"><mrow id="Sx4.SSx4.p2.3.m3.1.1" xref="Sx4.SSx4.p2.3.m3.1.1.cmml"><mi id="Sx4.SSx4.p2.3.m3.1.1.2" xref="Sx4.SSx4.p2.3.m3.1.1.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx4.p2.3.m3.1.1.1" xref="Sx4.SSx4.p2.3.m3.1.1.1.cmml">​</mo><mi id="Sx4.SSx4.p2.3.m3.1.1.3" xref="Sx4.SSx4.p2.3.m3.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx4.p2.3.m3.1.1.1a" xref="Sx4.SSx4.p2.3.m3.1.1.1.cmml">​</mo><mi id="Sx4.SSx4.p2.3.m3.1.1.4" xref="Sx4.SSx4.p2.3.m3.1.1.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx4.p2.3.m3.1.1.1b" xref="Sx4.SSx4.p2.3.m3.1.1.1.cmml">​</mo><mi id="Sx4.SSx4.p2.3.m3.1.1.5" xref="Sx4.SSx4.p2.3.m3.1.1.5.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx4.p2.3.m3.1b"><apply id="Sx4.SSx4.p2.3.m3.1.1.cmml" xref="Sx4.SSx4.p2.3.m3.1.1"><times id="Sx4.SSx4.p2.3.m3.1.1.1.cmml" xref="Sx4.SSx4.p2.3.m3.1.1.1"></times><ci id="Sx4.SSx4.p2.3.m3.1.1.2.cmml" xref="Sx4.SSx4.p2.3.m3.1.1.2">𝑛</ci><ci id="Sx4.SSx4.p2.3.m3.1.1.3.cmml" xref="Sx4.SSx4.p2.3.m3.1.1.3">𝑎</ci><ci id="Sx4.SSx4.p2.3.m3.1.1.4.cmml" xref="Sx4.SSx4.p2.3.m3.1.1.4">𝑚</ci><ci id="Sx4.SSx4.p2.3.m3.1.1.5.cmml" xref="Sx4.SSx4.p2.3.m3.1.1.5">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx4.p2.3.m3.1c">name</annotation></semantics></math> denote the top-left, bottom-right coordinates of bounding box, and object label, respectively. As Table <a href="#Sx4.T3" title="Table 3 ‣ Ablation Studies ‣ Experiments ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows, the bounding box information is enough for intermediate supervision, which achieves the highest score (<em id="Sx4.SSx4.p2.3.2" class="ltx_emph ltx_font_italic">i.e.,</em> 59.97%), and the extra object names decrease the performance. It is conjectured that extra supervisions (<em id="Sx4.SSx4.p2.3.3" class="ltx_emph ltx_font_italic">i.e.,</em> object names) enforce the VQA model focus more on intermediate results than final answer prediction, thus decreasing the answer prediction performance.</p>
</div>
<div id="Sx4.SSx4.p3" class="ltx_para ltx_noindent">
<p id="Sx4.SSx4.p3.2" class="ltx_p"><span id="Sx4.SSx4.p3.2.1" class="ltx_text ltx_font_bold">Different loss weights of DIS and bootstrapping epochs: </span>Table <a href="#Sx4.T4" title="Table 4 ‣ Ablation Studies ‣ Experiments ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows the results of different DIS loss weights, and different epochs for bootstrapping. As shown, the best accuracy (59.97%) is achieved when DIS loss weight <math id="Sx4.SSx4.p3.1.m1.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="Sx4.SSx4.p3.1.m1.1a"><mrow id="Sx4.SSx4.p3.1.m1.1.1" xref="Sx4.SSx4.p3.1.m1.1.1.cmml"><mi id="Sx4.SSx4.p3.1.m1.1.1.2" xref="Sx4.SSx4.p3.1.m1.1.1.2.cmml">α</mi><mo id="Sx4.SSx4.p3.1.m1.1.1.1" xref="Sx4.SSx4.p3.1.m1.1.1.1.cmml">=</mo><mn id="Sx4.SSx4.p3.1.m1.1.1.3" xref="Sx4.SSx4.p3.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx4.p3.1.m1.1b"><apply id="Sx4.SSx4.p3.1.m1.1.1.cmml" xref="Sx4.SSx4.p3.1.m1.1.1"><eq id="Sx4.SSx4.p3.1.m1.1.1.1.cmml" xref="Sx4.SSx4.p3.1.m1.1.1.1"></eq><ci id="Sx4.SSx4.p3.1.m1.1.1.2.cmml" xref="Sx4.SSx4.p3.1.m1.1.1.2">𝛼</ci><cn type="float" id="Sx4.SSx4.p3.1.m1.1.1.3.cmml" xref="Sx4.SSx4.p3.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx4.p3.1.m1.1c">\alpha=0.5</annotation></semantics></math>, which surpasses the baseline <math id="Sx4.SSx4.p3.2.m2.1" class="ltx_Math" alttext="\alpha=0" display="inline"><semantics id="Sx4.SSx4.p3.2.m2.1a"><mrow id="Sx4.SSx4.p3.2.m2.1.1" xref="Sx4.SSx4.p3.2.m2.1.1.cmml"><mi id="Sx4.SSx4.p3.2.m2.1.1.2" xref="Sx4.SSx4.p3.2.m2.1.1.2.cmml">α</mi><mo id="Sx4.SSx4.p3.2.m2.1.1.1" xref="Sx4.SSx4.p3.2.m2.1.1.1.cmml">=</mo><mn id="Sx4.SSx4.p3.2.m2.1.1.3" xref="Sx4.SSx4.p3.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx4.p3.2.m2.1b"><apply id="Sx4.SSx4.p3.2.m2.1.1.cmml" xref="Sx4.SSx4.p3.2.m2.1.1"><eq id="Sx4.SSx4.p3.2.m2.1.1.1.cmml" xref="Sx4.SSx4.p3.2.m2.1.1.1"></eq><ci id="Sx4.SSx4.p3.2.m2.1.1.2.cmml" xref="Sx4.SSx4.p3.2.m2.1.1.2">𝛼</ci><cn type="integer" id="Sx4.SSx4.p3.2.m2.1.1.3.cmml" xref="Sx4.SSx4.p3.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx4.p3.2.m2.1c">\alpha=0</annotation></semantics></math> by a significant margin of 1.22%, demonstrating the effectiveness of our proposed DIS method. In addition, it can be observed that the bootstrapping of 1 epoch has achieved the best accuracy (61.31%), while decreasing the performance with more bootstrapping epochs. It is conjectured that more training epochs on <em id="Sx4.SSx4.p3.2.2" class="ltx_emph ltx_font_italic">all-split</em> bring biases for the VQA model, which is harmful for further fine-tuning.
<span id="Sx4.SSx4.p3.2.3" class="ltx_text ltx_font_bold">Additionally</span>, the results regarding how different quantized bins and maximum number of generated objects and the shuffle mode of object order affect the performance are shown in Appendix-D.</p>
</div>
<figure id="Sx4.T4" class="ltx_table">
<table id="Sx4.T4.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="Sx4.T4.1.1" class="ltx_tr">
<th id="Sx4.T4.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><math id="Sx4.T4.1.1.1.m1.1" class="ltx_Math" alttext="\mathbf{\alpha}" display="inline"><semantics id="Sx4.T4.1.1.1.m1.1a"><mi id="Sx4.T4.1.1.1.m1.1.1" xref="Sx4.T4.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="Sx4.T4.1.1.1.m1.1b"><ci id="Sx4.T4.1.1.1.m1.1.1.cmml" xref="Sx4.T4.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T4.1.1.1.m1.1c">\mathbf{\alpha}</annotation></semantics></math></th>
<th id="Sx4.T4.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt"><span id="Sx4.T4.1.1.2.1" class="ltx_text ltx_font_bold">Accuracy</span></th>
<th id="Sx4.T4.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="Sx4.T4.1.1.3.1" class="ltx_text ltx_font_bold">BS Epoch</span></th>
<th id="Sx4.T4.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="Sx4.T4.1.1.4.1" class="ltx_text ltx_font_bold">Accuracy</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="Sx4.T4.1.2.1" class="ltx_tr">
<td id="Sx4.T4.1.2.1.1" class="ltx_td ltx_align_center ltx_border_t">0.00</td>
<td id="Sx4.T4.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">58.75</td>
<td id="Sx4.T4.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">1</td>
<td id="Sx4.T4.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="Sx4.T4.1.2.1.4.1" class="ltx_text ltx_font_bold">61.31</span></td>
</tr>
<tr id="Sx4.T4.1.3.2" class="ltx_tr">
<td id="Sx4.T4.1.3.2.1" class="ltx_td ltx_align_center">0.25</td>
<td id="Sx4.T4.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r">58.91</td>
<td id="Sx4.T4.1.3.2.3" class="ltx_td ltx_align_center">2</td>
<td id="Sx4.T4.1.3.2.4" class="ltx_td ltx_align_center">61.04</td>
</tr>
<tr id="Sx4.T4.1.4.3" class="ltx_tr">
<td id="Sx4.T4.1.4.3.1" class="ltx_td ltx_align_center">0.50</td>
<td id="Sx4.T4.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r"><span id="Sx4.T4.1.4.3.2.1" class="ltx_text ltx_font_bold">59.97</span></td>
<td id="Sx4.T4.1.4.3.3" class="ltx_td ltx_align_center">3</td>
<td id="Sx4.T4.1.4.3.4" class="ltx_td ltx_align_center">60.95</td>
</tr>
<tr id="Sx4.T4.1.5.4" class="ltx_tr">
<td id="Sx4.T4.1.5.4.1" class="ltx_td ltx_align_center">0.75</td>
<td id="Sx4.T4.1.5.4.2" class="ltx_td ltx_align_center ltx_border_r">59.47</td>
<td id="Sx4.T4.1.5.4.3" class="ltx_td ltx_align_center">4</td>
<td id="Sx4.T4.1.5.4.4" class="ltx_td ltx_align_center">60.61</td>
</tr>
<tr id="Sx4.T4.1.6.5" class="ltx_tr">
<td id="Sx4.T4.1.6.5.1" class="ltx_td ltx_align_center ltx_border_bb">1.00</td>
<td id="Sx4.T4.1.6.5.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">59.74</td>
<td id="Sx4.T4.1.6.5.3" class="ltx_td ltx_align_center ltx_border_bb">5</td>
<td id="Sx4.T4.1.6.5.4" class="ltx_td ltx_align_center ltx_border_bb">60.59</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Results of different DIS loss weights and bootstrapping epochs.</figcaption>
</figure>
</section>
<section id="Sx4.SSx5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Visualization</h3>

<div id="Sx4.SSx5.p1" class="ltx_para">
<p id="Sx4.SSx5.p1.1" class="ltx_p">We visualize several cases from the GQA <em id="Sx4.SSx5.p1.1.1" class="ltx_emph ltx_font_italic">testdev</em> split, showcasing the intermediate results and predicted answers from MMN and DIS. As depicted in Figure <a href="#Sx4.F5" title="Figure 5 ‣ Ablation Studies ‣ Experiments ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, it is evident that MMN tends to focus on a large area of the image, <em id="Sx4.SSx5.p1.1.2" class="ltx_emph ltx_font_italic">e.g.,</em> the attention maps of the <em id="Sx4.SSx5.p1.1.3" class="ltx_emph ltx_font_italic">store</em>, <em id="Sx4.SSx5.p1.1.4" class="ltx_emph ltx_font_italic">cloth</em>, and <em id="Sx4.SSx5.p1.1.5" class="ltx_emph ltx_font_italic">fire truck</em> in Figure <a href="#Sx4.F5" title="Figure 5 ‣ Ablation Studies ‣ Experiments ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> (a), (b), and (d) are not tightly focused on. It might be the reason that the large bounding boxes are more likely to overlap with others. Consequently, these bounding boxes are frequently used for training, leading the model to prioritize larger areas for IoU-based intermediate supervision methods. On the contrary, our proposed DIS method is able to predict the tight bounding boxes, <em id="Sx4.SSx5.p1.1.6" class="ltx_emph ltx_font_italic">e.g.,</em> the <em id="Sx4.SSx5.p1.1.7" class="ltx_emph ltx_font_italic">crosswalk</em>, <em id="Sx4.SSx5.p1.1.8" class="ltx_emph ltx_font_italic">store</em> in Figure <a href="#Sx4.F5" title="Figure 5 ‣ Ablation Studies ‣ Experiments ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> (a), <em id="Sx4.SSx5.p1.1.9" class="ltx_emph ltx_font_italic">cloth</em> in Figure <a href="#Sx4.F5" title="Figure 5 ‣ Ablation Studies ‣ Experiments ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> (b), and <em id="Sx4.SSx5.p1.1.10" class="ltx_emph ltx_font_italic">street</em>, <em id="Sx4.SSx5.p1.1.11" class="ltx_emph ltx_font_italic">fire truck</em> in Figure <a href="#Sx4.F5" title="Figure 5 ‣ Ablation Studies ‣ Experiments ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> (d), which facilitates the model to learn more fine-grained cross-modal alignments and accurate reasoning procedures.
In addition, as depicted in Figure <a href="#Sx4.F5" title="Figure 5 ‣ Ablation Studies ‣ Experiments ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> (b) and (c), there may exist multiple intermediate supervisions. However, MMN does not precisely focus on these areas, <em id="Sx4.SSx5.p1.1.12" class="ltx_emph ltx_font_italic">e.g.,</em> the <em id="Sx4.SSx5.p1.1.13" class="ltx_emph ltx_font_italic">cloth</em> in Figure <a href="#Sx4.F5" title="Figure 5 ‣ Ablation Studies ‣ Experiments ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> (b). The incomplete prediction of intermediate results makes it easy for the models to infer incorrect answers. In contrast, our proposed DIS is able to predict multiple object results in one sequence and unify the different result forms (<em id="Sx4.SSx5.p1.1.14" class="ltx_emph ltx_font_italic">i.e.,</em> logical true/false and objects) using one single framework.</p>
</div>
</section>
</section>
<section id="Sx5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Conclusion</h2>

<div id="Sx5.p1" class="ltx_para">
<p id="Sx5.p1.1" class="ltx_p">We propose the DIS algorithm for compositional visual question answering. Specifically, DIS exploits a unified generative framework to provide intermediate supervisions in a sequential form that provides more fine-grained and accurate supervisions, addressing the issue of supervision ambiguity and promoting cross-modal knowledge alignment.
We conducted experiments on the GQA and GQA-Sub datasets and the experimental results demonstrate that DIS achieves competitive answer prediction performance and superior reasoning consistency compared to previous state-of-the-arts.</p>
</div>
</section>
<section id="Sx6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2>

<div id="Sx6.p1" class="ltx_para">
<p id="Sx6.p1.1" class="ltx_p">This work was supported in part by the National Natural Science Foundation of China under Grant No. 62276110, No. 62172039 and in part by the fund of Joint Laboratory of HUST and Pingan Property &amp; Casualty Research (HPL). The authors would also like to thank the anonymous reviewers for their comments on improving the quality of this paper.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Agrawal et al. (2017)</span>
<span class="ltx_bibblock">
Agrawal, A.; Lu, J.; Antol, S.; Mitchell, M.; Zitnick, C. L.; Parikh, D.; and Batra, D. 2017.

</span>
<span class="ltx_bibblock">VQA: Visual Question Answering.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">International Journal of Computer Vision</em>, 123(1): 4–31.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Anderson et al. (2018)</span>
<span class="ltx_bibblock">
Anderson, P.; He, X.; Buehler, C.; Teney, D.; Johnson, M.; Gould, S.; and Zhang, L. 2018.

</span>
<span class="ltx_bibblock">Bottom-Up and Top-Down Attention for Image Captioning and Visual Question Answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 6077–6086.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Andreas et al. (2016)</span>
<span class="ltx_bibblock">
Andreas, J.; Rohrbach, M.; Darrell, T.; and Klein, D. 2016.

</span>
<span class="ltx_bibblock">Neural Module Networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 39–48.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bodla et al. (2017)</span>
<span class="ltx_bibblock">
Bodla, N.; Singh, B.; Chellappa, R.; and Davis, L. S. 2017.

</span>
<span class="ltx_bibblock">Soft-NMS — Improving Object Detection with One Line of Code.

</span>
<span class="ltx_bibblock">In <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">IEEE/CVF International Conference on Computer Vision (ICCV)</em>, 5562–5570.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et al. (2020)</span>
<span class="ltx_bibblock">
Brown, T. B.; Mann, B.; Ryder, N.; Subbiah, M.; Kaplan, J.; Dhariwal, P.; Neelakantan, A.; Shyam, P.; Sastry, G.; Askell, A.; Agarwal, S.; Herbert-Voss, A.; Krueger, G.; Henighan, T. J.; Child, R.; Ramesh, A.; Ziegler, D. M.; Wu, J.; Winter, C.; Hesse, C.; Chen, M.; Sigler, E.; Litwin, M.; Gray, S.; Chess, B.; Clark, J.; Berner, C.; McCandlish, S.; Radford, A.; Sutskever, I.; and Amodei, D. 2020.

</span>
<span class="ltx_bibblock">Language Models are Few-Shot Learners.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, volume 33, 1877–1901.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Carion et al. (2020)</span>
<span class="ltx_bibblock">
Carion, N.; Massa, F.; Synnaeve, G.; Usunier, N.; Kirillov, A.; and Zagoruyko, S. 2020.

</span>
<span class="ltx_bibblock">End-to-end object detection with transformers.

</span>
<span class="ltx_bibblock">In <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">European conference on computer vision</em>, 213–229. Springer.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2022)</span>
<span class="ltx_bibblock">
Chen, T.; Saxena, S.; Li, L.; Fleet, D. J.; and Hinton, G. 2022.

</span>
<span class="ltx_bibblock">Pix2seq: A Language Modeling Framework for Object Detection.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2021)</span>
<span class="ltx_bibblock">
Chen, W.; Gan, Z.; Li, L.; Cheng, Y.; Wang, W. Y.; and Liu, J. 2021.

</span>
<span class="ltx_bibblock">Meta Module Network for Compositional Visual Reasoning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">IEEE Winter Conference on Applications of Computer Vision, WACV</em>, 655–664.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Girshick (2015)</span>
<span class="ltx_bibblock">
Girshick, R. B. 2015.

</span>
<span class="ltx_bibblock">Fast R-CNN.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">IEEE International Conference on Computer Vision (ICCV)</em>, 1440–1448.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goyal et al. (2017)</span>
<span class="ltx_bibblock">
Goyal, P.; Dollár, P.; Girshick, R. B.; Noordhuis, P.; Wesolowski, L.; Kyrola, A.; Tulloch, A.; Jia, Y.; and He, K. 2017.

</span>
<span class="ltx_bibblock">Accurate, Large Minibatch SGD: Training ImageNet in 1 Hour.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/1706.02677.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo, Xu, and Tao (2019)</span>
<span class="ltx_bibblock">
Guo, D.; Xu, C.; and Tao, D. 2019.

</span>
<span class="ltx_bibblock">Graph Reasoning Networks for Visual Question Answering.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/1907.09815.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2018)</span>
<span class="ltx_bibblock">
Hu, R.; Andreas, J.; Darrell, T.; and Saenko, K. 2018.

</span>
<span class="ltx_bibblock">Explainable neural computation via stack neural module networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Proceedings of the European conference on computer vision (ECCV)</em>, 53–69.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2019)</span>
<span class="ltx_bibblock">
Hu, R.; Rohrbach, A.; Darrell, T.; and Saenko, K. 2019.

</span>
<span class="ltx_bibblock">Language-Conditioned Graph Networks for Relational Reasoning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">IEEE/CVF International Conference on Computer Vision (ICCV)</em>, 10293–10302.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hudson and Manning (2019a)</span>
<span class="ltx_bibblock">
Hudson, D.; and Manning, C. D. 2019a.

</span>
<span class="ltx_bibblock">Learning by abstraction: The neural state machine.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, volume 32, 5901–5914.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hudson and Manning (2018)</span>
<span class="ltx_bibblock">
Hudson, D. A.; and Manning, C. D. 2018.

</span>
<span class="ltx_bibblock">Compositional Attention Networks for Machine Reasoning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hudson and Manning (2019b)</span>
<span class="ltx_bibblock">
Hudson, D. A.; and Manning, C. D. 2019b.

</span>
<span class="ltx_bibblock">GQA: A New Dataset for Real-World Visual Reasoning and Compositional Question Answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 6693–6702.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2020)</span>
<span class="ltx_bibblock">
Jiang, H.; Misra, I.; Rohrbach, M.; Learned-Miller, E. G.; and Chen, X. 2020.

</span>
<span class="ltx_bibblock">In Defense of Grid Features for Visual Question Answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 10264–10273.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jing et al. (2022a)</span>
<span class="ltx_bibblock">
Jing, C.; Jia, Y.; Wu, Y.; Li, C.; and Wu, Q. 2022a.

</span>
<span class="ltx_bibblock">Learning the dynamics of visual relational reasoning via reinforced path routing.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial Intelligence</em>, 1122–1130.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jing et al. (2022b)</span>
<span class="ltx_bibblock">
Jing, C.; Jia, Y.; Wu, Y.; Liu, X.; and Wu, Q. 2022b.

</span>
<span class="ltx_bibblock">Maintaining Reasoning Consistency in Compositional Visual Question Answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 5089–5098.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim, Jun, and Zhang (2018)</span>
<span class="ltx_bibblock">
Kim, J.-H.; Jun, J.; and Zhang, B.-T. 2018.

</span>
<span class="ltx_bibblock">Bilinear Attention Networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 1571–1581.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krishna et al. (2017)</span>
<span class="ltx_bibblock">
Krishna, R.; Zhu, Y.; Groth, O.; Johnson, J.; Hata, K.; Kravitz, J.; Chen, S.; Kalantidis, Y.; Li, L.-J.; Shamma, D. A.; Bernstein, M. S.; and Fei-Fei, L. 2017.

</span>
<span class="ltx_bibblock">Visual Genome: Connecting Language and Vision Using Crowdsourced Dense Image Annotations.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">International Journal of Computer Vision</em>, 123: 32–73.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li, Wang, and Zhu (2019)</span>
<span class="ltx_bibblock">
Li, G.; Wang, X.; and Zhu, W. 2019.

</span>
<span class="ltx_bibblock">Perceptual Visual Reasoning with Knowledge Propagation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 27th ACM International Conference on Multimedia</em>, 530–538.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2019)</span>
<span class="ltx_bibblock">
Li, L.; Gan, Z.; Cheng, Y.; and Liu, J. 2019.

</span>
<span class="ltx_bibblock">Relation-Aware Graph Attention Network for Visual Question Answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">IEEE/CVF International Conference on Computer Vision (ICCV)</em>, 10312–10321.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pennington, Socher, and Manning (2014)</span>
<span class="ltx_bibblock">
Pennington, J.; Socher, R.; and Manning, C. D. 2014.

</span>
<span class="ltx_bibblock">GloVe: Global Vectors for Word Representation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Conference on Empirical Methods in Natural Language Processing</em>, 1532–1543.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raffel et al. (2020)</span>
<span class="ltx_bibblock">
Raffel, C.; Shazeer, N. M.; Roberts, A.; Lee, K.; Narang, S.; Matena, M.; Zhou, Y.; Li, W.; and Liu, P. J. 2020.

</span>
<span class="ltx_bibblock">Exploring the Limits of Transfer Learning with a Unified Text-to-Text Transformer.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Journal of Machine Learning Research</em>, 21: 140:1–140:67.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Redmon et al. (2016)</span>
<span class="ltx_bibblock">
Redmon, J.; Divvala, S. K.; Girshick, R. B.; and Farhadi, A. 2016.

</span>
<span class="ltx_bibblock">You Only Look Once: Unified, Real-Time Object Detection.

</span>
<span class="ltx_bibblock">In <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 779–788.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et al. (2017)</span>
<span class="ltx_bibblock">
Ren, S.; He, K.; Girshick, R. B.; and Sun, J. 2017.

</span>
<span class="ltx_bibblock">Faster R-CNN: Towards Real-Time Object Detection with Region Proposal Networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Pattern Analysis and Machine Intelligence</em>, 39: 1137–1149.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan and Bansal (2019)</span>
<span class="ltx_bibblock">
Tan, H.; and Bansal, M. 2019.

</span>
<span class="ltx_bibblock">LXMERT: Learning Cross-Modality Encoder Representations from Transformers.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on Natural Language Processing (EMNLP-IJCNLP)</em>, 5100–5111.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tian et al. (2019)</span>
<span class="ltx_bibblock">
Tian, Z.; Shen, C.; Chen, H.; and He, T. 2019.

</span>
<span class="ltx_bibblock">FCOS: Fully Convolutional One-Stage Object Detection.

</span>
<span class="ltx_bibblock">In <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">IEEE/CVF International Conference on Computer Vision (ICCV)</em>, 9626–9635.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Vaswani, A.; Shazeer, N. M.; Parmar, N.; Uszkoreit, J.; Jones, L.; Gomez, A. N.; Kaiser, L.; and Polosukhin, I. 2017.

</span>
<span class="ltx_bibblock">Attention is All you Need.

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, volume 30, 5998–6008.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2020)</span>
<span class="ltx_bibblock">
Yang, X.; Lin, G.; Lv, F.; and Liu, F. 2020.

</span>
<span class="ltx_bibblock">Trrnet: Tiered relation reasoning for compositional visual question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">Computer Vision–ECCV 2020: 16th European Conference, Glasgow, UK, August 23–28, 2020, Proceedings, Part XXI 16</em>, 414–430. Springer.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2019)</span>
<span class="ltx_bibblock">
Yu, Z.; Yu, J.; Cui, Y.; Tao, D.; and Tian, Q. 2019.

</span>
<span class="ltx_bibblock">Deep Modular Co-Attention Networks for Visual Question Answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 6281–6290.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2021)</span>
<span class="ltx_bibblock">
Zhao, Z.; Samel, K.; Chen, B.; and Song, L. 2021.

</span>
<span class="ltx_bibblock">ProTo: Program-Guided Transformer for Program-Guided Tasks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 17021–17036.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<div id="p1" class="ltx_para ltx_noindent">
<p id="p1.1" class="ltx_p">This part serves as the appendix of the main paper. Section A provides detailed information about the GQA and GQA-Sub datasets, along with their respective evaluation metrics. Implementation details of the visual question answering model are presented in Section B. Additionally, Section C covers baselines, while Section D introduces more ablation studies.</p>
</div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>A. Datasets</h2>

<div id="A1.p1" class="ltx_para ltx_noindent">
<p id="A1.p1.1" class="ltx_p"><span id="A1.p1.1.1" class="ltx_text ltx_font_bold">GQA</span>: Specifically, GQA <cite class="ltx_cite ltx_citemacro_citep">(Hudson and Manning <a href="#bib.bib16" title="" class="ltx_ref">2019b</a>)</cite> is generated by leveraging Visual Genome <cite class="ltx_cite ltx_citemacro_citep">(Krishna et al. <a href="#bib.bib21" title="" class="ltx_ref">2017</a>)</cite> scene graphs to create diverse reasoning questions with less language bias. Therefore, it requires more complicated reasoning capacities to answer the questions. GQA consists of two splits (<em id="A1.p1.1.2" class="ltx_emph ltx_font_italic">i.e.,</em> <span id="A1.p1.1.3" class="ltx_text ltx_font_italic">balance-split</span> and <span id="A1.p1.1.4" class="ltx_text ltx_font_italic">all-split</span>). The <em id="A1.p1.1.5" class="ltx_emph ltx_font_italic">balance-split</em> consists of QA pairs with re-sampled question-answer distribution. Following the common practice <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib8" title="" class="ltx_ref">2021</a>)</cite>, we use <em id="A1.p1.1.6" class="ltx_emph ltx_font_italic">all-split</em> for bootstrapping, and <em id="A1.p1.1.7" class="ltx_emph ltx_font_italic">balance-split</em> for finetuning and online evaluation. The dataset is split into 70% train, 10% validation, 10% test and 10% challenge. The metrics utilized in this paper include accuracy regarding the <span id="A1.p1.1.8" class="ltx_text ltx_font_italic">Open</span> questions, <span id="A1.p1.1.9" class="ltx_text ltx_font_italic">Binary</span> questions and the overall accuracy.</p>
</div>
<div id="A1.p2" class="ltx_para ltx_noindent">
<p id="A1.p2.1" class="ltx_p"><span id="A1.p2.1.1" class="ltx_text ltx_font_bold">GQA-Sub</span>:
Specifically, GQA-Sub <cite class="ltx_cite ltx_citemacro_citep">(Jing et al. <a href="#bib.bib19" title="" class="ltx_ref">2022b</a>)</cite> transforms compositional questions into language graphs and extracts sub-graphs to construct sub-questions. To obtain the answer labels for these questions, GQA-Sub exploits ground-truth scene graphs and language graph traversing to get the answers. Additionally, to avoid the language biases, GQA-Sub performs three times of sampling for these generated samples, resulting in 351,271 and 45,043 sub-questions for <em id="A1.p2.1.2" class="ltx_emph ltx_font_italic">train</em> and <em id="A1.p2.1.3" class="ltx_emph ltx_font_italic">val</em> splits, respectively. Finally, a total of 4 splits are generated, <em id="A1.p2.1.4" class="ltx_emph ltx_font_italic">i.e.,</em> <em id="A1.p2.1.5" class="ltx_emph ltx_font_italic">train</em>, <em id="A1.p2.1.6" class="ltx_emph ltx_font_italic">train-sub</em>, <em id="A1.p2.1.7" class="ltx_emph ltx_font_italic">val</em>, and <em id="A1.p2.1.8" class="ltx_emph ltx_font_italic">val-sub</em>, where the <em id="A1.p2.1.9" class="ltx_emph ltx_font_italic">train/val-sub</em> split contains sub-questions corresponding to <em id="A1.p2.1.10" class="ltx_emph ltx_font_italic">train/val</em> split. Following the common settings <cite class="ltx_cite ltx_citemacro_citep">(Jing et al. <a href="#bib.bib19" title="" class="ltx_ref">2022b</a>)</cite>, the VQA model is trained on <em id="A1.p2.1.11" class="ltx_emph ltx_font_italic">train(-sub)</em>, and evaluated on <em id="A1.p2.1.12" class="ltx_emph ltx_font_italic">val(-sub)</em>.</p>
</div>
<div id="A1.p3" class="ltx_para">
<p id="A1.p3.1" class="ltx_p">To measure the reasoning consistency of VQA models, GQA-Sub designes a metric, <em id="A1.p3.1.1" class="ltx_emph ltx_font_italic">i.e.,</em> reasoning consistency score <math id="A1.p3.1.m1.1" class="ltx_Math" alttext="\textrm{RC}(k)" display="inline"><semantics id="A1.p3.1.m1.1a"><mrow id="A1.p3.1.m1.1.2" xref="A1.p3.1.m1.1.2.cmml"><mtext id="A1.p3.1.m1.1.2.2" xref="A1.p3.1.m1.1.2.2a.cmml">RC</mtext><mo lspace="0em" rspace="0em" id="A1.p3.1.m1.1.2.1" xref="A1.p3.1.m1.1.2.1.cmml">​</mo><mrow id="A1.p3.1.m1.1.2.3.2" xref="A1.p3.1.m1.1.2.cmml"><mo stretchy="false" id="A1.p3.1.m1.1.2.3.2.1" xref="A1.p3.1.m1.1.2.cmml">(</mo><mi id="A1.p3.1.m1.1.1" xref="A1.p3.1.m1.1.1.cmml">k</mi><mo stretchy="false" id="A1.p3.1.m1.1.2.3.2.2" xref="A1.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.1.m1.1b"><apply id="A1.p3.1.m1.1.2.cmml" xref="A1.p3.1.m1.1.2"><times id="A1.p3.1.m1.1.2.1.cmml" xref="A1.p3.1.m1.1.2.1"></times><ci id="A1.p3.1.m1.1.2.2a.cmml" xref="A1.p3.1.m1.1.2.2"><mtext id="A1.p3.1.m1.1.2.2.cmml" xref="A1.p3.1.m1.1.2.2">RC</mtext></ci><ci id="A1.p3.1.m1.1.1.cmml" xref="A1.p3.1.m1.1.1">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.1.m1.1c">\textrm{RC}(k)</annotation></semantics></math>, computed by:</p>
<table id="A4.EGx10" class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table">

<tbody id="A1.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E12.m1.8" class="ltx_Math" alttext="\displaystyle\textrm{RC}(k)=\frac{\sum_{Q\subset\mathbb{Q},N\geq{k}}\textrm{Correct}^{f}(Q,\{Q_{i}\}_{i=1}^{N})}{\sum_{Q\subset\mathbb{Q},N\geq{k}}\textrm{Correct}^{f}(Q)}" display="block"><semantics id="A1.E12.m1.8a"><mrow id="A1.E12.m1.8.9" xref="A1.E12.m1.8.9.cmml"><mrow id="A1.E12.m1.8.9.2" xref="A1.E12.m1.8.9.2.cmml"><mtext id="A1.E12.m1.8.9.2.2" xref="A1.E12.m1.8.9.2.2a.cmml">RC</mtext><mo lspace="0em" rspace="0em" id="A1.E12.m1.8.9.2.1" xref="A1.E12.m1.8.9.2.1.cmml">​</mo><mrow id="A1.E12.m1.8.9.2.3.2" xref="A1.E12.m1.8.9.2.cmml"><mo stretchy="false" id="A1.E12.m1.8.9.2.3.2.1" xref="A1.E12.m1.8.9.2.cmml">(</mo><mi id="A1.E12.m1.8.8" xref="A1.E12.m1.8.8.cmml">k</mi><mo stretchy="false" id="A1.E12.m1.8.9.2.3.2.2" xref="A1.E12.m1.8.9.2.cmml">)</mo></mrow></mrow><mo id="A1.E12.m1.8.9.1" xref="A1.E12.m1.8.9.1.cmml">=</mo><mfrac id="A1.E12.m1.7.7" xref="A1.E12.m1.7.7.cmml"><mrow id="A1.E12.m1.4.4.4" xref="A1.E12.m1.4.4.4.cmml"><msub id="A1.E12.m1.4.4.4.5" xref="A1.E12.m1.4.4.4.5.cmml"><mo id="A1.E12.m1.4.4.4.5.2" xref="A1.E12.m1.4.4.4.5.2.cmml">∑</mo><mrow id="A1.E12.m1.2.2.2.2.2.2" xref="A1.E12.m1.2.2.2.2.2.3.cmml"><mrow id="A1.E12.m1.1.1.1.1.1.1.1" xref="A1.E12.m1.1.1.1.1.1.1.1.cmml"><mi id="A1.E12.m1.1.1.1.1.1.1.1.2" xref="A1.E12.m1.1.1.1.1.1.1.1.2.cmml">Q</mi><mo id="A1.E12.m1.1.1.1.1.1.1.1.1" xref="A1.E12.m1.1.1.1.1.1.1.1.1.cmml">⊂</mo><mi id="A1.E12.m1.1.1.1.1.1.1.1.3" xref="A1.E12.m1.1.1.1.1.1.1.1.3.cmml">ℚ</mi></mrow><mo id="A1.E12.m1.2.2.2.2.2.2.3" xref="A1.E12.m1.2.2.2.2.2.3a.cmml">,</mo><mrow id="A1.E12.m1.2.2.2.2.2.2.2" xref="A1.E12.m1.2.2.2.2.2.2.2.cmml"><mi id="A1.E12.m1.2.2.2.2.2.2.2.2" xref="A1.E12.m1.2.2.2.2.2.2.2.2.cmml">N</mi><mo id="A1.E12.m1.2.2.2.2.2.2.2.1" xref="A1.E12.m1.2.2.2.2.2.2.2.1.cmml">≥</mo><mi id="A1.E12.m1.2.2.2.2.2.2.2.3" xref="A1.E12.m1.2.2.2.2.2.2.2.3.cmml">k</mi></mrow></mrow></msub><mrow id="A1.E12.m1.4.4.4.4" xref="A1.E12.m1.4.4.4.4.cmml"><msup id="A1.E12.m1.4.4.4.4.3" xref="A1.E12.m1.4.4.4.4.3.cmml"><mtext id="A1.E12.m1.4.4.4.4.3.2" xref="A1.E12.m1.4.4.4.4.3.2a.cmml">Correct</mtext><mi id="A1.E12.m1.4.4.4.4.3.3" xref="A1.E12.m1.4.4.4.4.3.3.cmml">f</mi></msup><mo lspace="0em" rspace="0em" id="A1.E12.m1.4.4.4.4.2" xref="A1.E12.m1.4.4.4.4.2.cmml">​</mo><mrow id="A1.E12.m1.4.4.4.4.1.1" xref="A1.E12.m1.4.4.4.4.1.2.cmml"><mo stretchy="false" id="A1.E12.m1.4.4.4.4.1.1.2" xref="A1.E12.m1.4.4.4.4.1.2.cmml">(</mo><mi id="A1.E12.m1.3.3.3.3" xref="A1.E12.m1.3.3.3.3.cmml">Q</mi><mo id="A1.E12.m1.4.4.4.4.1.1.3" xref="A1.E12.m1.4.4.4.4.1.2.cmml">,</mo><msubsup id="A1.E12.m1.4.4.4.4.1.1.1" xref="A1.E12.m1.4.4.4.4.1.1.1.cmml"><mrow id="A1.E12.m1.4.4.4.4.1.1.1.1.1.1" xref="A1.E12.m1.4.4.4.4.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.E12.m1.4.4.4.4.1.1.1.1.1.1.2" xref="A1.E12.m1.4.4.4.4.1.1.1.1.1.2.cmml">{</mo><msub id="A1.E12.m1.4.4.4.4.1.1.1.1.1.1.1" xref="A1.E12.m1.4.4.4.4.1.1.1.1.1.1.1.cmml"><mi id="A1.E12.m1.4.4.4.4.1.1.1.1.1.1.1.2" xref="A1.E12.m1.4.4.4.4.1.1.1.1.1.1.1.2.cmml">Q</mi><mi id="A1.E12.m1.4.4.4.4.1.1.1.1.1.1.1.3" xref="A1.E12.m1.4.4.4.4.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A1.E12.m1.4.4.4.4.1.1.1.1.1.1.3" xref="A1.E12.m1.4.4.4.4.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="A1.E12.m1.4.4.4.4.1.1.1.1.3" xref="A1.E12.m1.4.4.4.4.1.1.1.1.3.cmml"><mi id="A1.E12.m1.4.4.4.4.1.1.1.1.3.2" xref="A1.E12.m1.4.4.4.4.1.1.1.1.3.2.cmml">i</mi><mo id="A1.E12.m1.4.4.4.4.1.1.1.1.3.1" xref="A1.E12.m1.4.4.4.4.1.1.1.1.3.1.cmml">=</mo><mn id="A1.E12.m1.4.4.4.4.1.1.1.1.3.3" xref="A1.E12.m1.4.4.4.4.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="A1.E12.m1.4.4.4.4.1.1.1.3" xref="A1.E12.m1.4.4.4.4.1.1.1.3.cmml">N</mi></msubsup><mo stretchy="false" id="A1.E12.m1.4.4.4.4.1.1.4" xref="A1.E12.m1.4.4.4.4.1.2.cmml">)</mo></mrow></mrow></mrow><mrow id="A1.E12.m1.7.7.7" xref="A1.E12.m1.7.7.7.cmml"><msub id="A1.E12.m1.7.7.7.4" xref="A1.E12.m1.7.7.7.4.cmml"><mo id="A1.E12.m1.7.7.7.4.2" xref="A1.E12.m1.7.7.7.4.2.cmml">∑</mo><mrow id="A1.E12.m1.6.6.6.2.2.2" xref="A1.E12.m1.6.6.6.2.2.3.cmml"><mrow id="A1.E12.m1.5.5.5.1.1.1.1" xref="A1.E12.m1.5.5.5.1.1.1.1.cmml"><mi id="A1.E12.m1.5.5.5.1.1.1.1.2" xref="A1.E12.m1.5.5.5.1.1.1.1.2.cmml">Q</mi><mo id="A1.E12.m1.5.5.5.1.1.1.1.1" xref="A1.E12.m1.5.5.5.1.1.1.1.1.cmml">⊂</mo><mi id="A1.E12.m1.5.5.5.1.1.1.1.3" xref="A1.E12.m1.5.5.5.1.1.1.1.3.cmml">ℚ</mi></mrow><mo id="A1.E12.m1.6.6.6.2.2.2.3" xref="A1.E12.m1.6.6.6.2.2.3a.cmml">,</mo><mrow id="A1.E12.m1.6.6.6.2.2.2.2" xref="A1.E12.m1.6.6.6.2.2.2.2.cmml"><mi id="A1.E12.m1.6.6.6.2.2.2.2.2" xref="A1.E12.m1.6.6.6.2.2.2.2.2.cmml">N</mi><mo id="A1.E12.m1.6.6.6.2.2.2.2.1" xref="A1.E12.m1.6.6.6.2.2.2.2.1.cmml">≥</mo><mi id="A1.E12.m1.6.6.6.2.2.2.2.3" xref="A1.E12.m1.6.6.6.2.2.2.2.3.cmml">k</mi></mrow></mrow></msub><mrow id="A1.E12.m1.7.7.7.5" xref="A1.E12.m1.7.7.7.5.cmml"><msup id="A1.E12.m1.7.7.7.5.2" xref="A1.E12.m1.7.7.7.5.2.cmml"><mtext id="A1.E12.m1.7.7.7.5.2.2" xref="A1.E12.m1.7.7.7.5.2.2a.cmml">Correct</mtext><mi id="A1.E12.m1.7.7.7.5.2.3" xref="A1.E12.m1.7.7.7.5.2.3.cmml">f</mi></msup><mo lspace="0em" rspace="0em" id="A1.E12.m1.7.7.7.5.1" xref="A1.E12.m1.7.7.7.5.1.cmml">​</mo><mrow id="A1.E12.m1.7.7.7.5.3.2" xref="A1.E12.m1.7.7.7.5.cmml"><mo stretchy="false" id="A1.E12.m1.7.7.7.5.3.2.1" xref="A1.E12.m1.7.7.7.5.cmml">(</mo><mi id="A1.E12.m1.7.7.7.3" xref="A1.E12.m1.7.7.7.3.cmml">Q</mi><mo stretchy="false" id="A1.E12.m1.7.7.7.5.3.2.2" xref="A1.E12.m1.7.7.7.5.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A1.E12.m1.8b"><apply id="A1.E12.m1.8.9.cmml" xref="A1.E12.m1.8.9"><eq id="A1.E12.m1.8.9.1.cmml" xref="A1.E12.m1.8.9.1"></eq><apply id="A1.E12.m1.8.9.2.cmml" xref="A1.E12.m1.8.9.2"><times id="A1.E12.m1.8.9.2.1.cmml" xref="A1.E12.m1.8.9.2.1"></times><ci id="A1.E12.m1.8.9.2.2a.cmml" xref="A1.E12.m1.8.9.2.2"><mtext id="A1.E12.m1.8.9.2.2.cmml" xref="A1.E12.m1.8.9.2.2">RC</mtext></ci><ci id="A1.E12.m1.8.8.cmml" xref="A1.E12.m1.8.8">𝑘</ci></apply><apply id="A1.E12.m1.7.7.cmml" xref="A1.E12.m1.7.7"><divide id="A1.E12.m1.7.7.8.cmml" xref="A1.E12.m1.7.7"></divide><apply id="A1.E12.m1.4.4.4.cmml" xref="A1.E12.m1.4.4.4"><apply id="A1.E12.m1.4.4.4.5.cmml" xref="A1.E12.m1.4.4.4.5"><csymbol cd="ambiguous" id="A1.E12.m1.4.4.4.5.1.cmml" xref="A1.E12.m1.4.4.4.5">subscript</csymbol><sum id="A1.E12.m1.4.4.4.5.2.cmml" xref="A1.E12.m1.4.4.4.5.2"></sum><apply id="A1.E12.m1.2.2.2.2.2.3.cmml" xref="A1.E12.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.E12.m1.2.2.2.2.2.3a.cmml" xref="A1.E12.m1.2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="A1.E12.m1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.1.1.1.1.1.1.1"><subset id="A1.E12.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.1.1.1.1.1.1.1.1"></subset><ci id="A1.E12.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.1.1.1.1.1.1.1.2">𝑄</ci><ci id="A1.E12.m1.1.1.1.1.1.1.1.3.cmml" xref="A1.E12.m1.1.1.1.1.1.1.1.3">ℚ</ci></apply><apply id="A1.E12.m1.2.2.2.2.2.2.2.cmml" xref="A1.E12.m1.2.2.2.2.2.2.2"><geq id="A1.E12.m1.2.2.2.2.2.2.2.1.cmml" xref="A1.E12.m1.2.2.2.2.2.2.2.1"></geq><ci id="A1.E12.m1.2.2.2.2.2.2.2.2.cmml" xref="A1.E12.m1.2.2.2.2.2.2.2.2">𝑁</ci><ci id="A1.E12.m1.2.2.2.2.2.2.2.3.cmml" xref="A1.E12.m1.2.2.2.2.2.2.2.3">𝑘</ci></apply></apply></apply><apply id="A1.E12.m1.4.4.4.4.cmml" xref="A1.E12.m1.4.4.4.4"><times id="A1.E12.m1.4.4.4.4.2.cmml" xref="A1.E12.m1.4.4.4.4.2"></times><apply id="A1.E12.m1.4.4.4.4.3.cmml" xref="A1.E12.m1.4.4.4.4.3"><csymbol cd="ambiguous" id="A1.E12.m1.4.4.4.4.3.1.cmml" xref="A1.E12.m1.4.4.4.4.3">superscript</csymbol><ci id="A1.E12.m1.4.4.4.4.3.2a.cmml" xref="A1.E12.m1.4.4.4.4.3.2"><mtext id="A1.E12.m1.4.4.4.4.3.2.cmml" xref="A1.E12.m1.4.4.4.4.3.2">Correct</mtext></ci><ci id="A1.E12.m1.4.4.4.4.3.3.cmml" xref="A1.E12.m1.4.4.4.4.3.3">𝑓</ci></apply><interval closure="open" id="A1.E12.m1.4.4.4.4.1.2.cmml" xref="A1.E12.m1.4.4.4.4.1.1"><ci id="A1.E12.m1.3.3.3.3.cmml" xref="A1.E12.m1.3.3.3.3">𝑄</ci><apply id="A1.E12.m1.4.4.4.4.1.1.1.cmml" xref="A1.E12.m1.4.4.4.4.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.4.4.4.4.1.1.1.2.cmml" xref="A1.E12.m1.4.4.4.4.1.1.1">superscript</csymbol><apply id="A1.E12.m1.4.4.4.4.1.1.1.1.cmml" xref="A1.E12.m1.4.4.4.4.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.4.4.4.4.1.1.1.1.2.cmml" xref="A1.E12.m1.4.4.4.4.1.1.1">subscript</csymbol><set id="A1.E12.m1.4.4.4.4.1.1.1.1.1.2.cmml" xref="A1.E12.m1.4.4.4.4.1.1.1.1.1.1"><apply id="A1.E12.m1.4.4.4.4.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.4.4.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.4.4.4.4.1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.4.4.4.4.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E12.m1.4.4.4.4.1.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.4.4.4.4.1.1.1.1.1.1.1.2">𝑄</ci><ci id="A1.E12.m1.4.4.4.4.1.1.1.1.1.1.1.3.cmml" xref="A1.E12.m1.4.4.4.4.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="A1.E12.m1.4.4.4.4.1.1.1.1.3.cmml" xref="A1.E12.m1.4.4.4.4.1.1.1.1.3"><eq id="A1.E12.m1.4.4.4.4.1.1.1.1.3.1.cmml" xref="A1.E12.m1.4.4.4.4.1.1.1.1.3.1"></eq><ci id="A1.E12.m1.4.4.4.4.1.1.1.1.3.2.cmml" xref="A1.E12.m1.4.4.4.4.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="A1.E12.m1.4.4.4.4.1.1.1.1.3.3.cmml" xref="A1.E12.m1.4.4.4.4.1.1.1.1.3.3">1</cn></apply></apply><ci id="A1.E12.m1.4.4.4.4.1.1.1.3.cmml" xref="A1.E12.m1.4.4.4.4.1.1.1.3">𝑁</ci></apply></interval></apply></apply><apply id="A1.E12.m1.7.7.7.cmml" xref="A1.E12.m1.7.7.7"><apply id="A1.E12.m1.7.7.7.4.cmml" xref="A1.E12.m1.7.7.7.4"><csymbol cd="ambiguous" id="A1.E12.m1.7.7.7.4.1.cmml" xref="A1.E12.m1.7.7.7.4">subscript</csymbol><sum id="A1.E12.m1.7.7.7.4.2.cmml" xref="A1.E12.m1.7.7.7.4.2"></sum><apply id="A1.E12.m1.6.6.6.2.2.3.cmml" xref="A1.E12.m1.6.6.6.2.2.2"><csymbol cd="ambiguous" id="A1.E12.m1.6.6.6.2.2.3a.cmml" xref="A1.E12.m1.6.6.6.2.2.2.3">formulae-sequence</csymbol><apply id="A1.E12.m1.5.5.5.1.1.1.1.cmml" xref="A1.E12.m1.5.5.5.1.1.1.1"><subset id="A1.E12.m1.5.5.5.1.1.1.1.1.cmml" xref="A1.E12.m1.5.5.5.1.1.1.1.1"></subset><ci id="A1.E12.m1.5.5.5.1.1.1.1.2.cmml" xref="A1.E12.m1.5.5.5.1.1.1.1.2">𝑄</ci><ci id="A1.E12.m1.5.5.5.1.1.1.1.3.cmml" xref="A1.E12.m1.5.5.5.1.1.1.1.3">ℚ</ci></apply><apply id="A1.E12.m1.6.6.6.2.2.2.2.cmml" xref="A1.E12.m1.6.6.6.2.2.2.2"><geq id="A1.E12.m1.6.6.6.2.2.2.2.1.cmml" xref="A1.E12.m1.6.6.6.2.2.2.2.1"></geq><ci id="A1.E12.m1.6.6.6.2.2.2.2.2.cmml" xref="A1.E12.m1.6.6.6.2.2.2.2.2">𝑁</ci><ci id="A1.E12.m1.6.6.6.2.2.2.2.3.cmml" xref="A1.E12.m1.6.6.6.2.2.2.2.3">𝑘</ci></apply></apply></apply><apply id="A1.E12.m1.7.7.7.5.cmml" xref="A1.E12.m1.7.7.7.5"><times id="A1.E12.m1.7.7.7.5.1.cmml" xref="A1.E12.m1.7.7.7.5.1"></times><apply id="A1.E12.m1.7.7.7.5.2.cmml" xref="A1.E12.m1.7.7.7.5.2"><csymbol cd="ambiguous" id="A1.E12.m1.7.7.7.5.2.1.cmml" xref="A1.E12.m1.7.7.7.5.2">superscript</csymbol><ci id="A1.E12.m1.7.7.7.5.2.2a.cmml" xref="A1.E12.m1.7.7.7.5.2.2"><mtext id="A1.E12.m1.7.7.7.5.2.2.cmml" xref="A1.E12.m1.7.7.7.5.2.2">Correct</mtext></ci><ci id="A1.E12.m1.7.7.7.5.2.3.cmml" xref="A1.E12.m1.7.7.7.5.2.3">𝑓</ci></apply><ci id="A1.E12.m1.7.7.7.3.cmml" xref="A1.E12.m1.7.7.7.3">𝑄</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E12.m1.8c">\displaystyle\textrm{RC}(k)=\frac{\sum_{Q\subset\mathbb{Q},N\geq{k}}\textrm{Correct}^{f}(Q,\{Q_{i}\}_{i=1}^{N})}{\sum_{Q\subset\mathbb{Q},N\geq{k}}\textrm{Correct}^{f}(Q)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="A1.p3.11" class="ltx_p">where <math id="A1.p3.2.m1.1" class="ltx_Math" alttext="\mathbb{Q}" display="inline"><semantics id="A1.p3.2.m1.1a"><mi id="A1.p3.2.m1.1.1" xref="A1.p3.2.m1.1.1.cmml">ℚ</mi><annotation-xml encoding="MathML-Content" id="A1.p3.2.m1.1b"><ci id="A1.p3.2.m1.1.1.cmml" xref="A1.p3.2.m1.1.1">ℚ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.2.m1.1c">\mathbb{Q}</annotation></semantics></math> denotes the set of compositional questions. <math id="A1.p3.3.m2.1" class="ltx_Math" alttext="\textrm{Correct}(q)=1" display="inline"><semantics id="A1.p3.3.m2.1a"><mrow id="A1.p3.3.m2.1.2" xref="A1.p3.3.m2.1.2.cmml"><mrow id="A1.p3.3.m2.1.2.2" xref="A1.p3.3.m2.1.2.2.cmml"><mtext id="A1.p3.3.m2.1.2.2.2" xref="A1.p3.3.m2.1.2.2.2a.cmml">Correct</mtext><mo lspace="0em" rspace="0em" id="A1.p3.3.m2.1.2.2.1" xref="A1.p3.3.m2.1.2.2.1.cmml">​</mo><mrow id="A1.p3.3.m2.1.2.2.3.2" xref="A1.p3.3.m2.1.2.2.cmml"><mo stretchy="false" id="A1.p3.3.m2.1.2.2.3.2.1" xref="A1.p3.3.m2.1.2.2.cmml">(</mo><mi id="A1.p3.3.m2.1.1" xref="A1.p3.3.m2.1.1.cmml">q</mi><mo stretchy="false" id="A1.p3.3.m2.1.2.2.3.2.2" xref="A1.p3.3.m2.1.2.2.cmml">)</mo></mrow></mrow><mo id="A1.p3.3.m2.1.2.1" xref="A1.p3.3.m2.1.2.1.cmml">=</mo><mn id="A1.p3.3.m2.1.2.3" xref="A1.p3.3.m2.1.2.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.3.m2.1b"><apply id="A1.p3.3.m2.1.2.cmml" xref="A1.p3.3.m2.1.2"><eq id="A1.p3.3.m2.1.2.1.cmml" xref="A1.p3.3.m2.1.2.1"></eq><apply id="A1.p3.3.m2.1.2.2.cmml" xref="A1.p3.3.m2.1.2.2"><times id="A1.p3.3.m2.1.2.2.1.cmml" xref="A1.p3.3.m2.1.2.2.1"></times><ci id="A1.p3.3.m2.1.2.2.2a.cmml" xref="A1.p3.3.m2.1.2.2.2"><mtext id="A1.p3.3.m2.1.2.2.2.cmml" xref="A1.p3.3.m2.1.2.2.2">Correct</mtext></ci><ci id="A1.p3.3.m2.1.1.cmml" xref="A1.p3.3.m2.1.1">𝑞</ci></apply><cn type="integer" id="A1.p3.3.m2.1.2.3.cmml" xref="A1.p3.3.m2.1.2.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.3.m2.1c">\textrm{Correct}(q)=1</annotation></semantics></math> only when <math id="A1.p3.4.m3.1" class="ltx_Math" alttext="q" display="inline"><semantics id="A1.p3.4.m3.1a"><mi id="A1.p3.4.m3.1.1" xref="A1.p3.4.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="A1.p3.4.m3.1b"><ci id="A1.p3.4.m3.1.1.cmml" xref="A1.p3.4.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.4.m3.1c">q</annotation></semantics></math> is correctly answered by the VQA model, or <math id="A1.p3.5.m4.1" class="ltx_Math" alttext="\textrm{Correct}(q)=0" display="inline"><semantics id="A1.p3.5.m4.1a"><mrow id="A1.p3.5.m4.1.2" xref="A1.p3.5.m4.1.2.cmml"><mrow id="A1.p3.5.m4.1.2.2" xref="A1.p3.5.m4.1.2.2.cmml"><mtext id="A1.p3.5.m4.1.2.2.2" xref="A1.p3.5.m4.1.2.2.2a.cmml">Correct</mtext><mo lspace="0em" rspace="0em" id="A1.p3.5.m4.1.2.2.1" xref="A1.p3.5.m4.1.2.2.1.cmml">​</mo><mrow id="A1.p3.5.m4.1.2.2.3.2" xref="A1.p3.5.m4.1.2.2.cmml"><mo stretchy="false" id="A1.p3.5.m4.1.2.2.3.2.1" xref="A1.p3.5.m4.1.2.2.cmml">(</mo><mi id="A1.p3.5.m4.1.1" xref="A1.p3.5.m4.1.1.cmml">q</mi><mo stretchy="false" id="A1.p3.5.m4.1.2.2.3.2.2" xref="A1.p3.5.m4.1.2.2.cmml">)</mo></mrow></mrow><mo id="A1.p3.5.m4.1.2.1" xref="A1.p3.5.m4.1.2.1.cmml">=</mo><mn id="A1.p3.5.m4.1.2.3" xref="A1.p3.5.m4.1.2.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.5.m4.1b"><apply id="A1.p3.5.m4.1.2.cmml" xref="A1.p3.5.m4.1.2"><eq id="A1.p3.5.m4.1.2.1.cmml" xref="A1.p3.5.m4.1.2.1"></eq><apply id="A1.p3.5.m4.1.2.2.cmml" xref="A1.p3.5.m4.1.2.2"><times id="A1.p3.5.m4.1.2.2.1.cmml" xref="A1.p3.5.m4.1.2.2.1"></times><ci id="A1.p3.5.m4.1.2.2.2a.cmml" xref="A1.p3.5.m4.1.2.2.2"><mtext id="A1.p3.5.m4.1.2.2.2.cmml" xref="A1.p3.5.m4.1.2.2.2">Correct</mtext></ci><ci id="A1.p3.5.m4.1.1.cmml" xref="A1.p3.5.m4.1.1">𝑞</ci></apply><cn type="integer" id="A1.p3.5.m4.1.2.3.cmml" xref="A1.p3.5.m4.1.2.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.5.m4.1c">\textrm{Correct}(q)=0</annotation></semantics></math> otherwise. <math id="A1.p3.6.m5.2" class="ltx_Math" alttext="\textrm{Correct}^{f}(Q,\{Q_{i}\}_{i=1}^{N})=1" display="inline"><semantics id="A1.p3.6.m5.2a"><mrow id="A1.p3.6.m5.2.2" xref="A1.p3.6.m5.2.2.cmml"><mrow id="A1.p3.6.m5.2.2.1" xref="A1.p3.6.m5.2.2.1.cmml"><msup id="A1.p3.6.m5.2.2.1.3" xref="A1.p3.6.m5.2.2.1.3.cmml"><mtext id="A1.p3.6.m5.2.2.1.3.2" xref="A1.p3.6.m5.2.2.1.3.2a.cmml">Correct</mtext><mi id="A1.p3.6.m5.2.2.1.3.3" xref="A1.p3.6.m5.2.2.1.3.3.cmml">f</mi></msup><mo lspace="0em" rspace="0em" id="A1.p3.6.m5.2.2.1.2" xref="A1.p3.6.m5.2.2.1.2.cmml">​</mo><mrow id="A1.p3.6.m5.2.2.1.1.1" xref="A1.p3.6.m5.2.2.1.1.2.cmml"><mo stretchy="false" id="A1.p3.6.m5.2.2.1.1.1.2" xref="A1.p3.6.m5.2.2.1.1.2.cmml">(</mo><mi id="A1.p3.6.m5.1.1" xref="A1.p3.6.m5.1.1.cmml">Q</mi><mo id="A1.p3.6.m5.2.2.1.1.1.3" xref="A1.p3.6.m5.2.2.1.1.2.cmml">,</mo><msubsup id="A1.p3.6.m5.2.2.1.1.1.1" xref="A1.p3.6.m5.2.2.1.1.1.1.cmml"><mrow id="A1.p3.6.m5.2.2.1.1.1.1.1.1.1" xref="A1.p3.6.m5.2.2.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.p3.6.m5.2.2.1.1.1.1.1.1.1.2" xref="A1.p3.6.m5.2.2.1.1.1.1.1.1.2.cmml">{</mo><msub id="A1.p3.6.m5.2.2.1.1.1.1.1.1.1.1" xref="A1.p3.6.m5.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="A1.p3.6.m5.2.2.1.1.1.1.1.1.1.1.2" xref="A1.p3.6.m5.2.2.1.1.1.1.1.1.1.1.2.cmml">Q</mi><mi id="A1.p3.6.m5.2.2.1.1.1.1.1.1.1.1.3" xref="A1.p3.6.m5.2.2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A1.p3.6.m5.2.2.1.1.1.1.1.1.1.3" xref="A1.p3.6.m5.2.2.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="A1.p3.6.m5.2.2.1.1.1.1.1.3" xref="A1.p3.6.m5.2.2.1.1.1.1.1.3.cmml"><mi id="A1.p3.6.m5.2.2.1.1.1.1.1.3.2" xref="A1.p3.6.m5.2.2.1.1.1.1.1.3.2.cmml">i</mi><mo id="A1.p3.6.m5.2.2.1.1.1.1.1.3.1" xref="A1.p3.6.m5.2.2.1.1.1.1.1.3.1.cmml">=</mo><mn id="A1.p3.6.m5.2.2.1.1.1.1.1.3.3" xref="A1.p3.6.m5.2.2.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="A1.p3.6.m5.2.2.1.1.1.1.3" xref="A1.p3.6.m5.2.2.1.1.1.1.3.cmml">N</mi></msubsup><mo stretchy="false" id="A1.p3.6.m5.2.2.1.1.1.4" xref="A1.p3.6.m5.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.p3.6.m5.2.2.2" xref="A1.p3.6.m5.2.2.2.cmml">=</mo><mn id="A1.p3.6.m5.2.2.3" xref="A1.p3.6.m5.2.2.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.6.m5.2b"><apply id="A1.p3.6.m5.2.2.cmml" xref="A1.p3.6.m5.2.2"><eq id="A1.p3.6.m5.2.2.2.cmml" xref="A1.p3.6.m5.2.2.2"></eq><apply id="A1.p3.6.m5.2.2.1.cmml" xref="A1.p3.6.m5.2.2.1"><times id="A1.p3.6.m5.2.2.1.2.cmml" xref="A1.p3.6.m5.2.2.1.2"></times><apply id="A1.p3.6.m5.2.2.1.3.cmml" xref="A1.p3.6.m5.2.2.1.3"><csymbol cd="ambiguous" id="A1.p3.6.m5.2.2.1.3.1.cmml" xref="A1.p3.6.m5.2.2.1.3">superscript</csymbol><ci id="A1.p3.6.m5.2.2.1.3.2a.cmml" xref="A1.p3.6.m5.2.2.1.3.2"><mtext id="A1.p3.6.m5.2.2.1.3.2.cmml" xref="A1.p3.6.m5.2.2.1.3.2">Correct</mtext></ci><ci id="A1.p3.6.m5.2.2.1.3.3.cmml" xref="A1.p3.6.m5.2.2.1.3.3">𝑓</ci></apply><interval closure="open" id="A1.p3.6.m5.2.2.1.1.2.cmml" xref="A1.p3.6.m5.2.2.1.1.1"><ci id="A1.p3.6.m5.1.1.cmml" xref="A1.p3.6.m5.1.1">𝑄</ci><apply id="A1.p3.6.m5.2.2.1.1.1.1.cmml" xref="A1.p3.6.m5.2.2.1.1.1.1"><csymbol cd="ambiguous" id="A1.p3.6.m5.2.2.1.1.1.1.2.cmml" xref="A1.p3.6.m5.2.2.1.1.1.1">superscript</csymbol><apply id="A1.p3.6.m5.2.2.1.1.1.1.1.cmml" xref="A1.p3.6.m5.2.2.1.1.1.1"><csymbol cd="ambiguous" id="A1.p3.6.m5.2.2.1.1.1.1.1.2.cmml" xref="A1.p3.6.m5.2.2.1.1.1.1">subscript</csymbol><set id="A1.p3.6.m5.2.2.1.1.1.1.1.1.2.cmml" xref="A1.p3.6.m5.2.2.1.1.1.1.1.1.1"><apply id="A1.p3.6.m5.2.2.1.1.1.1.1.1.1.1.cmml" xref="A1.p3.6.m5.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.p3.6.m5.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.p3.6.m5.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.p3.6.m5.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A1.p3.6.m5.2.2.1.1.1.1.1.1.1.1.2">𝑄</ci><ci id="A1.p3.6.m5.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="A1.p3.6.m5.2.2.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="A1.p3.6.m5.2.2.1.1.1.1.1.3.cmml" xref="A1.p3.6.m5.2.2.1.1.1.1.1.3"><eq id="A1.p3.6.m5.2.2.1.1.1.1.1.3.1.cmml" xref="A1.p3.6.m5.2.2.1.1.1.1.1.3.1"></eq><ci id="A1.p3.6.m5.2.2.1.1.1.1.1.3.2.cmml" xref="A1.p3.6.m5.2.2.1.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="A1.p3.6.m5.2.2.1.1.1.1.1.3.3.cmml" xref="A1.p3.6.m5.2.2.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="A1.p3.6.m5.2.2.1.1.1.1.3.cmml" xref="A1.p3.6.m5.2.2.1.1.1.1.3">𝑁</ci></apply></interval></apply><cn type="integer" id="A1.p3.6.m5.2.2.3.cmml" xref="A1.p3.6.m5.2.2.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.6.m5.2c">\textrm{Correct}^{f}(Q,\{Q_{i}\}_{i=1}^{N})=1</annotation></semantics></math> only when the compositional question <math id="A1.p3.7.m6.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="A1.p3.7.m6.1a"><mi id="A1.p3.7.m6.1.1" xref="A1.p3.7.m6.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="A1.p3.7.m6.1b"><ci id="A1.p3.7.m6.1.1.cmml" xref="A1.p3.7.m6.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.7.m6.1c">Q</annotation></semantics></math> and all of its sub-questions <math id="A1.p3.8.m7.1" class="ltx_Math" alttext="\{Q_{i}\}_{i=1}^{N}" display="inline"><semantics id="A1.p3.8.m7.1a"><msubsup id="A1.p3.8.m7.1.1" xref="A1.p3.8.m7.1.1.cmml"><mrow id="A1.p3.8.m7.1.1.1.1.1" xref="A1.p3.8.m7.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.p3.8.m7.1.1.1.1.1.2" xref="A1.p3.8.m7.1.1.1.1.2.cmml">{</mo><msub id="A1.p3.8.m7.1.1.1.1.1.1" xref="A1.p3.8.m7.1.1.1.1.1.1.cmml"><mi id="A1.p3.8.m7.1.1.1.1.1.1.2" xref="A1.p3.8.m7.1.1.1.1.1.1.2.cmml">Q</mi><mi id="A1.p3.8.m7.1.1.1.1.1.1.3" xref="A1.p3.8.m7.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A1.p3.8.m7.1.1.1.1.1.3" xref="A1.p3.8.m7.1.1.1.1.2.cmml">}</mo></mrow><mrow id="A1.p3.8.m7.1.1.1.3" xref="A1.p3.8.m7.1.1.1.3.cmml"><mi id="A1.p3.8.m7.1.1.1.3.2" xref="A1.p3.8.m7.1.1.1.3.2.cmml">i</mi><mo id="A1.p3.8.m7.1.1.1.3.1" xref="A1.p3.8.m7.1.1.1.3.1.cmml">=</mo><mn id="A1.p3.8.m7.1.1.1.3.3" xref="A1.p3.8.m7.1.1.1.3.3.cmml">1</mn></mrow><mi id="A1.p3.8.m7.1.1.3" xref="A1.p3.8.m7.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.p3.8.m7.1b"><apply id="A1.p3.8.m7.1.1.cmml" xref="A1.p3.8.m7.1.1"><csymbol cd="ambiguous" id="A1.p3.8.m7.1.1.2.cmml" xref="A1.p3.8.m7.1.1">superscript</csymbol><apply id="A1.p3.8.m7.1.1.1.cmml" xref="A1.p3.8.m7.1.1"><csymbol cd="ambiguous" id="A1.p3.8.m7.1.1.1.2.cmml" xref="A1.p3.8.m7.1.1">subscript</csymbol><set id="A1.p3.8.m7.1.1.1.1.2.cmml" xref="A1.p3.8.m7.1.1.1.1.1"><apply id="A1.p3.8.m7.1.1.1.1.1.1.cmml" xref="A1.p3.8.m7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.p3.8.m7.1.1.1.1.1.1.1.cmml" xref="A1.p3.8.m7.1.1.1.1.1.1">subscript</csymbol><ci id="A1.p3.8.m7.1.1.1.1.1.1.2.cmml" xref="A1.p3.8.m7.1.1.1.1.1.1.2">𝑄</ci><ci id="A1.p3.8.m7.1.1.1.1.1.1.3.cmml" xref="A1.p3.8.m7.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="A1.p3.8.m7.1.1.1.3.cmml" xref="A1.p3.8.m7.1.1.1.3"><eq id="A1.p3.8.m7.1.1.1.3.1.cmml" xref="A1.p3.8.m7.1.1.1.3.1"></eq><ci id="A1.p3.8.m7.1.1.1.3.2.cmml" xref="A1.p3.8.m7.1.1.1.3.2">𝑖</ci><cn type="integer" id="A1.p3.8.m7.1.1.1.3.3.cmml" xref="A1.p3.8.m7.1.1.1.3.3">1</cn></apply></apply><ci id="A1.p3.8.m7.1.1.3.cmml" xref="A1.p3.8.m7.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.8.m7.1c">\{Q_{i}\}_{i=1}^{N}</annotation></semantics></math> are correctly answered, or <math id="A1.p3.9.m8.2" class="ltx_Math" alttext="\textrm{Correct}^{f}(Q,\{Q_{i}\}_{i=1}^{N})=0" display="inline"><semantics id="A1.p3.9.m8.2a"><mrow id="A1.p3.9.m8.2.2" xref="A1.p3.9.m8.2.2.cmml"><mrow id="A1.p3.9.m8.2.2.1" xref="A1.p3.9.m8.2.2.1.cmml"><msup id="A1.p3.9.m8.2.2.1.3" xref="A1.p3.9.m8.2.2.1.3.cmml"><mtext id="A1.p3.9.m8.2.2.1.3.2" xref="A1.p3.9.m8.2.2.1.3.2a.cmml">Correct</mtext><mi id="A1.p3.9.m8.2.2.1.3.3" xref="A1.p3.9.m8.2.2.1.3.3.cmml">f</mi></msup><mo lspace="0em" rspace="0em" id="A1.p3.9.m8.2.2.1.2" xref="A1.p3.9.m8.2.2.1.2.cmml">​</mo><mrow id="A1.p3.9.m8.2.2.1.1.1" xref="A1.p3.9.m8.2.2.1.1.2.cmml"><mo stretchy="false" id="A1.p3.9.m8.2.2.1.1.1.2" xref="A1.p3.9.m8.2.2.1.1.2.cmml">(</mo><mi id="A1.p3.9.m8.1.1" xref="A1.p3.9.m8.1.1.cmml">Q</mi><mo id="A1.p3.9.m8.2.2.1.1.1.3" xref="A1.p3.9.m8.2.2.1.1.2.cmml">,</mo><msubsup id="A1.p3.9.m8.2.2.1.1.1.1" xref="A1.p3.9.m8.2.2.1.1.1.1.cmml"><mrow id="A1.p3.9.m8.2.2.1.1.1.1.1.1.1" xref="A1.p3.9.m8.2.2.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.p3.9.m8.2.2.1.1.1.1.1.1.1.2" xref="A1.p3.9.m8.2.2.1.1.1.1.1.1.2.cmml">{</mo><msub id="A1.p3.9.m8.2.2.1.1.1.1.1.1.1.1" xref="A1.p3.9.m8.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="A1.p3.9.m8.2.2.1.1.1.1.1.1.1.1.2" xref="A1.p3.9.m8.2.2.1.1.1.1.1.1.1.1.2.cmml">Q</mi><mi id="A1.p3.9.m8.2.2.1.1.1.1.1.1.1.1.3" xref="A1.p3.9.m8.2.2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A1.p3.9.m8.2.2.1.1.1.1.1.1.1.3" xref="A1.p3.9.m8.2.2.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="A1.p3.9.m8.2.2.1.1.1.1.1.3" xref="A1.p3.9.m8.2.2.1.1.1.1.1.3.cmml"><mi id="A1.p3.9.m8.2.2.1.1.1.1.1.3.2" xref="A1.p3.9.m8.2.2.1.1.1.1.1.3.2.cmml">i</mi><mo id="A1.p3.9.m8.2.2.1.1.1.1.1.3.1" xref="A1.p3.9.m8.2.2.1.1.1.1.1.3.1.cmml">=</mo><mn id="A1.p3.9.m8.2.2.1.1.1.1.1.3.3" xref="A1.p3.9.m8.2.2.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="A1.p3.9.m8.2.2.1.1.1.1.3" xref="A1.p3.9.m8.2.2.1.1.1.1.3.cmml">N</mi></msubsup><mo stretchy="false" id="A1.p3.9.m8.2.2.1.1.1.4" xref="A1.p3.9.m8.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.p3.9.m8.2.2.2" xref="A1.p3.9.m8.2.2.2.cmml">=</mo><mn id="A1.p3.9.m8.2.2.3" xref="A1.p3.9.m8.2.2.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.9.m8.2b"><apply id="A1.p3.9.m8.2.2.cmml" xref="A1.p3.9.m8.2.2"><eq id="A1.p3.9.m8.2.2.2.cmml" xref="A1.p3.9.m8.2.2.2"></eq><apply id="A1.p3.9.m8.2.2.1.cmml" xref="A1.p3.9.m8.2.2.1"><times id="A1.p3.9.m8.2.2.1.2.cmml" xref="A1.p3.9.m8.2.2.1.2"></times><apply id="A1.p3.9.m8.2.2.1.3.cmml" xref="A1.p3.9.m8.2.2.1.3"><csymbol cd="ambiguous" id="A1.p3.9.m8.2.2.1.3.1.cmml" xref="A1.p3.9.m8.2.2.1.3">superscript</csymbol><ci id="A1.p3.9.m8.2.2.1.3.2a.cmml" xref="A1.p3.9.m8.2.2.1.3.2"><mtext id="A1.p3.9.m8.2.2.1.3.2.cmml" xref="A1.p3.9.m8.2.2.1.3.2">Correct</mtext></ci><ci id="A1.p3.9.m8.2.2.1.3.3.cmml" xref="A1.p3.9.m8.2.2.1.3.3">𝑓</ci></apply><interval closure="open" id="A1.p3.9.m8.2.2.1.1.2.cmml" xref="A1.p3.9.m8.2.2.1.1.1"><ci id="A1.p3.9.m8.1.1.cmml" xref="A1.p3.9.m8.1.1">𝑄</ci><apply id="A1.p3.9.m8.2.2.1.1.1.1.cmml" xref="A1.p3.9.m8.2.2.1.1.1.1"><csymbol cd="ambiguous" id="A1.p3.9.m8.2.2.1.1.1.1.2.cmml" xref="A1.p3.9.m8.2.2.1.1.1.1">superscript</csymbol><apply id="A1.p3.9.m8.2.2.1.1.1.1.1.cmml" xref="A1.p3.9.m8.2.2.1.1.1.1"><csymbol cd="ambiguous" id="A1.p3.9.m8.2.2.1.1.1.1.1.2.cmml" xref="A1.p3.9.m8.2.2.1.1.1.1">subscript</csymbol><set id="A1.p3.9.m8.2.2.1.1.1.1.1.1.2.cmml" xref="A1.p3.9.m8.2.2.1.1.1.1.1.1.1"><apply id="A1.p3.9.m8.2.2.1.1.1.1.1.1.1.1.cmml" xref="A1.p3.9.m8.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.p3.9.m8.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.p3.9.m8.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.p3.9.m8.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A1.p3.9.m8.2.2.1.1.1.1.1.1.1.1.2">𝑄</ci><ci id="A1.p3.9.m8.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="A1.p3.9.m8.2.2.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="A1.p3.9.m8.2.2.1.1.1.1.1.3.cmml" xref="A1.p3.9.m8.2.2.1.1.1.1.1.3"><eq id="A1.p3.9.m8.2.2.1.1.1.1.1.3.1.cmml" xref="A1.p3.9.m8.2.2.1.1.1.1.1.3.1"></eq><ci id="A1.p3.9.m8.2.2.1.1.1.1.1.3.2.cmml" xref="A1.p3.9.m8.2.2.1.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="A1.p3.9.m8.2.2.1.1.1.1.1.3.3.cmml" xref="A1.p3.9.m8.2.2.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="A1.p3.9.m8.2.2.1.1.1.1.3.cmml" xref="A1.p3.9.m8.2.2.1.1.1.1.3">𝑁</ci></apply></interval></apply><cn type="integer" id="A1.p3.9.m8.2.2.3.cmml" xref="A1.p3.9.m8.2.2.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.9.m8.2c">\textrm{Correct}^{f}(Q,\{Q_{i}\}_{i=1}^{N})=0</annotation></semantics></math> otherwise. The value of <math id="A1.p3.10.m9.1" class="ltx_Math" alttext="\textrm{RC}(k)" display="inline"><semantics id="A1.p3.10.m9.1a"><mrow id="A1.p3.10.m9.1.2" xref="A1.p3.10.m9.1.2.cmml"><mtext id="A1.p3.10.m9.1.2.2" xref="A1.p3.10.m9.1.2.2a.cmml">RC</mtext><mo lspace="0em" rspace="0em" id="A1.p3.10.m9.1.2.1" xref="A1.p3.10.m9.1.2.1.cmml">​</mo><mrow id="A1.p3.10.m9.1.2.3.2" xref="A1.p3.10.m9.1.2.cmml"><mo stretchy="false" id="A1.p3.10.m9.1.2.3.2.1" xref="A1.p3.10.m9.1.2.cmml">(</mo><mi id="A1.p3.10.m9.1.1" xref="A1.p3.10.m9.1.1.cmml">k</mi><mo stretchy="false" id="A1.p3.10.m9.1.2.3.2.2" xref="A1.p3.10.m9.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.10.m9.1b"><apply id="A1.p3.10.m9.1.2.cmml" xref="A1.p3.10.m9.1.2"><times id="A1.p3.10.m9.1.2.1.cmml" xref="A1.p3.10.m9.1.2.1"></times><ci id="A1.p3.10.m9.1.2.2a.cmml" xref="A1.p3.10.m9.1.2.2"><mtext id="A1.p3.10.m9.1.2.2.cmml" xref="A1.p3.10.m9.1.2.2">RC</mtext></ci><ci id="A1.p3.10.m9.1.1.cmml" xref="A1.p3.10.m9.1.1">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.10.m9.1c">\textrm{RC}(k)</annotation></semantics></math> ranges from 0 to 1, and indicates better consistency when <math id="A1.p3.11.m10.1" class="ltx_Math" alttext="\textrm{RC}(k)" display="inline"><semantics id="A1.p3.11.m10.1a"><mrow id="A1.p3.11.m10.1.2" xref="A1.p3.11.m10.1.2.cmml"><mtext id="A1.p3.11.m10.1.2.2" xref="A1.p3.11.m10.1.2.2a.cmml">RC</mtext><mo lspace="0em" rspace="0em" id="A1.p3.11.m10.1.2.1" xref="A1.p3.11.m10.1.2.1.cmml">​</mo><mrow id="A1.p3.11.m10.1.2.3.2" xref="A1.p3.11.m10.1.2.cmml"><mo stretchy="false" id="A1.p3.11.m10.1.2.3.2.1" xref="A1.p3.11.m10.1.2.cmml">(</mo><mi id="A1.p3.11.m10.1.1" xref="A1.p3.11.m10.1.1.cmml">k</mi><mo stretchy="false" id="A1.p3.11.m10.1.2.3.2.2" xref="A1.p3.11.m10.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.11.m10.1b"><apply id="A1.p3.11.m10.1.2.cmml" xref="A1.p3.11.m10.1.2"><times id="A1.p3.11.m10.1.2.1.cmml" xref="A1.p3.11.m10.1.2.1"></times><ci id="A1.p3.11.m10.1.2.2a.cmml" xref="A1.p3.11.m10.1.2.2"><mtext id="A1.p3.11.m10.1.2.2.cmml" xref="A1.p3.11.m10.1.2.2">RC</mtext></ci><ci id="A1.p3.11.m10.1.1.cmml" xref="A1.p3.11.m10.1.1">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.11.m10.1c">\textrm{RC}(k)</annotation></semantics></math> is higher.</p>
</div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>B. Implementation Details</h2>

<div id="A2.p1" class="ltx_para ltx_noindent">
<p id="A2.p1.6" class="ltx_p"><span id="A2.p1.6.1" class="ltx_text ltx_font_bold">Visual Question Answering.</span> As for program execution, the number of reasoning layers <math id="A2.p1.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="A2.p1.1.m1.1a"><mi id="A2.p1.1.m1.1.1" xref="A2.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="A2.p1.1.m1.1b"><ci id="A2.p1.1.m1.1.1.cmml" xref="A2.p1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.1.m1.1c">L</annotation></semantics></math> is set to 5. In the process of intermediate output decoding, the maximum number of generated objects is set to 4. The bins for quantizing coordinates are set to 256. Regarding model training, the loss weight of DIS <math id="A2.p1.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A2.p1.2.m2.1a"><mi id="A2.p1.2.m2.1.1" xref="A2.p1.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A2.p1.2.m2.1b"><ci id="A2.p1.2.m2.1.1.cmml" xref="A2.p1.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.2.m2.1c">\alpha</annotation></semantics></math> is 0.5. Following the settings from MMN <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib8" title="" class="ltx_ref">2021</a>)</cite>, the VQA model is firstly bootstrapped for 5 epochs on <em id="A2.p1.6.2" class="ltx_emph ltx_font_italic">all-split</em>, and then finetuned on <em id="A2.p1.6.3" class="ltx_emph ltx_font_italic">balance-split</em>. In the bootstrapping stage, the model is trained using Adam optimizer with a fixed learning rate of <math id="A2.p1.3.m3.1" class="ltx_Math" alttext="1e^{-4}" display="inline"><semantics id="A2.p1.3.m3.1a"><mrow id="A2.p1.3.m3.1.1" xref="A2.p1.3.m3.1.1.cmml"><mn id="A2.p1.3.m3.1.1.2" xref="A2.p1.3.m3.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A2.p1.3.m3.1.1.1" xref="A2.p1.3.m3.1.1.1.cmml">​</mo><msup id="A2.p1.3.m3.1.1.3" xref="A2.p1.3.m3.1.1.3.cmml"><mi id="A2.p1.3.m3.1.1.3.2" xref="A2.p1.3.m3.1.1.3.2.cmml">e</mi><mrow id="A2.p1.3.m3.1.1.3.3" xref="A2.p1.3.m3.1.1.3.3.cmml"><mo id="A2.p1.3.m3.1.1.3.3a" xref="A2.p1.3.m3.1.1.3.3.cmml">−</mo><mn id="A2.p1.3.m3.1.1.3.3.2" xref="A2.p1.3.m3.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.3.m3.1b"><apply id="A2.p1.3.m3.1.1.cmml" xref="A2.p1.3.m3.1.1"><times id="A2.p1.3.m3.1.1.1.cmml" xref="A2.p1.3.m3.1.1.1"></times><cn type="integer" id="A2.p1.3.m3.1.1.2.cmml" xref="A2.p1.3.m3.1.1.2">1</cn><apply id="A2.p1.3.m3.1.1.3.cmml" xref="A2.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="A2.p1.3.m3.1.1.3.1.cmml" xref="A2.p1.3.m3.1.1.3">superscript</csymbol><ci id="A2.p1.3.m3.1.1.3.2.cmml" xref="A2.p1.3.m3.1.1.3.2">𝑒</ci><apply id="A2.p1.3.m3.1.1.3.3.cmml" xref="A2.p1.3.m3.1.1.3.3"><minus id="A2.p1.3.m3.1.1.3.3.1.cmml" xref="A2.p1.3.m3.1.1.3.3"></minus><cn type="integer" id="A2.p1.3.m3.1.1.3.3.2.cmml" xref="A2.p1.3.m3.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.3.m3.1c">1e^{-4}</annotation></semantics></math> and batch size of 128. In the fine-tuning stage, the model is optimized using Adam optimizer with batch size of 128 and base learning rate of <math id="A2.p1.4.m4.1" class="ltx_Math" alttext="2e^{-4}" display="inline"><semantics id="A2.p1.4.m4.1a"><mrow id="A2.p1.4.m4.1.1" xref="A2.p1.4.m4.1.1.cmml"><mn id="A2.p1.4.m4.1.1.2" xref="A2.p1.4.m4.1.1.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="A2.p1.4.m4.1.1.1" xref="A2.p1.4.m4.1.1.1.cmml">​</mo><msup id="A2.p1.4.m4.1.1.3" xref="A2.p1.4.m4.1.1.3.cmml"><mi id="A2.p1.4.m4.1.1.3.2" xref="A2.p1.4.m4.1.1.3.2.cmml">e</mi><mrow id="A2.p1.4.m4.1.1.3.3" xref="A2.p1.4.m4.1.1.3.3.cmml"><mo id="A2.p1.4.m4.1.1.3.3a" xref="A2.p1.4.m4.1.1.3.3.cmml">−</mo><mn id="A2.p1.4.m4.1.1.3.3.2" xref="A2.p1.4.m4.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.4.m4.1b"><apply id="A2.p1.4.m4.1.1.cmml" xref="A2.p1.4.m4.1.1"><times id="A2.p1.4.m4.1.1.1.cmml" xref="A2.p1.4.m4.1.1.1"></times><cn type="integer" id="A2.p1.4.m4.1.1.2.cmml" xref="A2.p1.4.m4.1.1.2">2</cn><apply id="A2.p1.4.m4.1.1.3.cmml" xref="A2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="A2.p1.4.m4.1.1.3.1.cmml" xref="A2.p1.4.m4.1.1.3">superscript</csymbol><ci id="A2.p1.4.m4.1.1.3.2.cmml" xref="A2.p1.4.m4.1.1.3.2">𝑒</ci><apply id="A2.p1.4.m4.1.1.3.3.cmml" xref="A2.p1.4.m4.1.1.3.3"><minus id="A2.p1.4.m4.1.1.3.3.1.cmml" xref="A2.p1.4.m4.1.1.3.3"></minus><cn type="integer" id="A2.p1.4.m4.1.1.3.3.2.cmml" xref="A2.p1.4.m4.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.4.m4.1c">2e^{-4}</annotation></semantics></math>. In addition, warmup <cite class="ltx_cite ltx_citemacro_citep">(Goyal et al. <a href="#bib.bib10" title="" class="ltx_ref">2017</a>)</cite> strategy is exploited to facilitate model fine-tuning. Specifically, the learning rate increases linearly from <math id="A2.p1.5.m5.1" class="ltx_Math" alttext="1e^{-4}" display="inline"><semantics id="A2.p1.5.m5.1a"><mrow id="A2.p1.5.m5.1.1" xref="A2.p1.5.m5.1.1.cmml"><mn id="A2.p1.5.m5.1.1.2" xref="A2.p1.5.m5.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A2.p1.5.m5.1.1.1" xref="A2.p1.5.m5.1.1.1.cmml">​</mo><msup id="A2.p1.5.m5.1.1.3" xref="A2.p1.5.m5.1.1.3.cmml"><mi id="A2.p1.5.m5.1.1.3.2" xref="A2.p1.5.m5.1.1.3.2.cmml">e</mi><mrow id="A2.p1.5.m5.1.1.3.3" xref="A2.p1.5.m5.1.1.3.3.cmml"><mo id="A2.p1.5.m5.1.1.3.3a" xref="A2.p1.5.m5.1.1.3.3.cmml">−</mo><mn id="A2.p1.5.m5.1.1.3.3.2" xref="A2.p1.5.m5.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.5.m5.1b"><apply id="A2.p1.5.m5.1.1.cmml" xref="A2.p1.5.m5.1.1"><times id="A2.p1.5.m5.1.1.1.cmml" xref="A2.p1.5.m5.1.1.1"></times><cn type="integer" id="A2.p1.5.m5.1.1.2.cmml" xref="A2.p1.5.m5.1.1.2">1</cn><apply id="A2.p1.5.m5.1.1.3.cmml" xref="A2.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="A2.p1.5.m5.1.1.3.1.cmml" xref="A2.p1.5.m5.1.1.3">superscript</csymbol><ci id="A2.p1.5.m5.1.1.3.2.cmml" xref="A2.p1.5.m5.1.1.3.2">𝑒</ci><apply id="A2.p1.5.m5.1.1.3.3.cmml" xref="A2.p1.5.m5.1.1.3.3"><minus id="A2.p1.5.m5.1.1.3.3.1.cmml" xref="A2.p1.5.m5.1.1.3.3"></minus><cn type="integer" id="A2.p1.5.m5.1.1.3.3.2.cmml" xref="A2.p1.5.m5.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.5.m5.1c">1e^{-4}</annotation></semantics></math> to <math id="A2.p1.6.m6.1" class="ltx_Math" alttext="2e^{-4}" display="inline"><semantics id="A2.p1.6.m6.1a"><mrow id="A2.p1.6.m6.1.1" xref="A2.p1.6.m6.1.1.cmml"><mn id="A2.p1.6.m6.1.1.2" xref="A2.p1.6.m6.1.1.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="A2.p1.6.m6.1.1.1" xref="A2.p1.6.m6.1.1.1.cmml">​</mo><msup id="A2.p1.6.m6.1.1.3" xref="A2.p1.6.m6.1.1.3.cmml"><mi id="A2.p1.6.m6.1.1.3.2" xref="A2.p1.6.m6.1.1.3.2.cmml">e</mi><mrow id="A2.p1.6.m6.1.1.3.3" xref="A2.p1.6.m6.1.1.3.3.cmml"><mo id="A2.p1.6.m6.1.1.3.3a" xref="A2.p1.6.m6.1.1.3.3.cmml">−</mo><mn id="A2.p1.6.m6.1.1.3.3.2" xref="A2.p1.6.m6.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.6.m6.1b"><apply id="A2.p1.6.m6.1.1.cmml" xref="A2.p1.6.m6.1.1"><times id="A2.p1.6.m6.1.1.1.cmml" xref="A2.p1.6.m6.1.1.1"></times><cn type="integer" id="A2.p1.6.m6.1.1.2.cmml" xref="A2.p1.6.m6.1.1.2">2</cn><apply id="A2.p1.6.m6.1.1.3.cmml" xref="A2.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="A2.p1.6.m6.1.1.3.1.cmml" xref="A2.p1.6.m6.1.1.3">superscript</csymbol><ci id="A2.p1.6.m6.1.1.3.2.cmml" xref="A2.p1.6.m6.1.1.3.2">𝑒</ci><apply id="A2.p1.6.m6.1.1.3.3.cmml" xref="A2.p1.6.m6.1.1.3.3"><minus id="A2.p1.6.m6.1.1.3.3.1.cmml" xref="A2.p1.6.m6.1.1.3.3"></minus><cn type="integer" id="A2.p1.6.m6.1.1.3.3.2.cmml" xref="A2.p1.6.m6.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.6.m6.1c">2e^{-4}</annotation></semantics></math> for the first 4 epochs, and decays by 0.5 for every 2 epochs at epoch 10. The model is trained for 18 epochs in total.</p>
</div>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>C. Baselines</h2>

<div id="A3.p1" class="ltx_para">
<p id="A3.p1.1" class="ltx_p">The baselines include BUTD <cite class="ltx_cite ltx_citemacro_citep">(Anderson et al. <a href="#bib.bib2" title="" class="ltx_ref">2018</a>)</cite>, MAC <cite class="ltx_cite ltx_citemacro_citep">(Hudson and Manning <a href="#bib.bib15" title="" class="ltx_ref">2018</a>)</cite>, GRN <cite class="ltx_cite ltx_citemacro_citep">(Guo, Xu, and Tao <a href="#bib.bib11" title="" class="ltx_ref">2019</a>)</cite>, LCGN <cite class="ltx_cite ltx_citemacro_citep">(Hu et al. <a href="#bib.bib13" title="" class="ltx_ref">2019</a>)</cite>, BAN<cite class="ltx_cite ltx_citemacro_citep">(Kim, Jun, and Zhang <a href="#bib.bib20" title="" class="ltx_ref">2018</a>)</cite>, PVR <cite class="ltx_cite ltx_citemacro_citep">(Li, Wang, and Zhu <a href="#bib.bib22" title="" class="ltx_ref">2019</a>)</cite>, LXMERT <cite class="ltx_cite ltx_citemacro_citep">(Tan and Bansal <a href="#bib.bib28" title="" class="ltx_ref">2019</a>)</cite>,
MCAN <cite class="ltx_cite ltx_citemacro_citep">(Yu et al. <a href="#bib.bib32" title="" class="ltx_ref">2019</a>)</cite>, MMN <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib8" title="" class="ltx_ref">2021</a>)</cite>, RPR <cite class="ltx_cite ltx_citemacro_citep">(Jing et al. <a href="#bib.bib18" title="" class="ltx_ref">2022a</a>)</cite>, and RCVQA <cite class="ltx_cite ltx_citemacro_citep">(Jing et al. <a href="#bib.bib19" title="" class="ltx_ref">2022b</a>)</cite>. A brief introduction of these baseline methods is described as follows.</p>
<ul id="A3.I1" class="ltx_itemize">
<li id="A3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A3.I1.i1.p1" class="ltx_para">
<p id="A3.I1.i1.p1.1" class="ltx_p"><span id="A3.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">BUTD.</span> The classic attention-based model for visual question answering and image caption, which exploits top-down attention to capture the question-relevant visual features for answer prediction.</p>
</div>
</li>
<li id="A3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A3.I1.i2.p1" class="ltx_para">
<p id="A3.I1.i2.p1.1" class="ltx_p"><span id="A3.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">MAC.</span> The memory-based reasoning model, which decomposes the question into a series of attention-based reasoning steps, and performs control and memory iteratively to get the answer.</p>
</div>
</li>
<li id="A3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A3.I1.i3.p1" class="ltx_para">
<p id="A3.I1.i3.p1.1" class="ltx_p"><span id="A3.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">GRN.</span> The graph-based reasoning model, which considers the relationships between words in the question, and designs intra- and inter-modal graph to exchange information from multi-modal inputs, thereby realizing implicit multi-step reasoning.</p>
</div>
</li>
<li id="A3.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A3.I1.i4.p1" class="ltx_para">
<p id="A3.I1.i4.p1.1" class="ltx_p"><span id="A3.I1.i4.p1.1.1" class="ltx_text ltx_font_bold">LCGN.</span> The graph-based reasoning model, which constructs fully-connected object graph, and exploits graph attention network (GAT) to perform implicit visual reasoning based on the graph structure.</p>
</div>
</li>
<li id="A3.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A3.I1.i5.p1" class="ltx_para">
<p id="A3.I1.i5.p1.1" class="ltx_p"><span id="A3.I1.i5.p1.1.1" class="ltx_text ltx_font_bold">BAN.</span> The bilinear attention network, which calculates bilinear attention distributions via low-rank bilinear pooling to facilitate interactions between multimodal inputs.</p>
</div>
</li>
<li id="A3.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A3.I1.i6.p1" class="ltx_para">
<p id="A3.I1.i6.p1.1" class="ltx_p"><span id="A3.I1.i6.p1.1.1" class="ltx_text ltx_font_bold">PVR.</span> The module-based approach that incorporates the concepts of logical and/or for logical inference, and introduces more perceptual modules for better logical generalization.</p>
</div>
</li>
<li id="A3.I1.i7" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A3.I1.i7.p1" class="ltx_para">
<p id="A3.I1.i7.p1.1" class="ltx_p"><span id="A3.I1.i7.p1.1.1" class="ltx_text ltx_font_bold">LXMERT.</span> The multi-modal pretrained model, which first pretrains transform-based models on large-scale image-text corpus to learn task-agnostic representations, and then finetunes the models on downstream VQA task.</p>
</div>
</li>
<li id="A3.I1.i8" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A3.I1.i8.p1" class="ltx_para">
<p id="A3.I1.i8.p1.1" class="ltx_p"><span id="A3.I1.i8.p1.1.1" class="ltx_text ltx_font_bold">MCAN.</span> The transformer-based multi-modal fusion model, which interacts intra- and inter-modal features using multi-head self-attention and guided attention, resulting in multi-modal joint representations for visual question answering.</p>
</div>
</li>
<li id="A3.I1.i9" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A3.I1.i9.p1" class="ltx_para">
<p id="A3.I1.i9.p1.1" class="ltx_p"><span id="A3.I1.i9.p1.1.1" class="ltx_text ltx_font_bold">MMN.</span> The module-based network, which decomposes questions into an interdependent program sequence, and assembles parametric modules to construct reasoning model for answer generation.</p>
</div>
</li>
<li id="A3.I1.i10" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A3.I1.i10.p1" class="ltx_para">
<p id="A3.I1.i10.p1.1" class="ltx_p"><span id="A3.I1.i10.p1.1.1" class="ltx_text ltx_font_bold">RPR.</span> The graph-based reasoning model, which formulates the reasoning process as a reinforced path routing problem, and exploits reinforcement learning to optimize the reasoning process.</p>
</div>
</li>
<li id="A3.I1.i11" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A3.I1.i11.p1" class="ltx_para">
<p id="A3.I1.i11.p1.1" class="ltx_p"><span id="A3.I1.i11.p1.1.1" class="ltx_text ltx_font_bold">RCVQA.</span> The VQA model which focuses on the answering consistency problem and designs a consistency constraint loss to improve the answering consistency between a compositional question and its sub-questions.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>D. Ablation Studies</h2>

<div id="A4.p1" class="ltx_para ltx_noindent">
<p id="A4.p1.5" class="ltx_p"><span id="A4.p1.5.1" class="ltx_text ltx_font_bold">Different quantized bins and maximum number of generated objects: </span> Table <a href="#A4.T5" title="Table 5 ‣ Appendix D D. Ablation Studies ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows the results when quantizing coordinates into different bins and generating different number of intermediate results. As Table <a href="#A4.T5" title="Table 5 ‣ Appendix D D. Ablation Studies ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows, the highest accuracy (<em id="A4.p1.5.2" class="ltx_emph ltx_font_italic">i.e.,</em> 59.97%) is achieved when quantized bins are set to <math id="A4.p1.1.m1.1" class="ltx_Math" alttext="256" display="inline"><semantics id="A4.p1.1.m1.1a"><mn id="A4.p1.1.m1.1.1" xref="A4.p1.1.m1.1.1.cmml">256</mn><annotation-xml encoding="MathML-Content" id="A4.p1.1.m1.1b"><cn type="integer" id="A4.p1.1.m1.1.1.cmml" xref="A4.p1.1.m1.1.1">256</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.1.m1.1c">256</annotation></semantics></math> and the maximum number of generated objects is set to <math id="A4.p1.2.m2.1" class="ltx_Math" alttext="4" display="inline"><semantics id="A4.p1.2.m2.1a"><mn id="A4.p1.2.m2.1.1" xref="A4.p1.2.m2.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="A4.p1.2.m2.1b"><cn type="integer" id="A4.p1.2.m2.1.1.cmml" xref="A4.p1.2.m2.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.2.m2.1c">4</annotation></semantics></math>. Intuitively, the quantized bins are limited by the size of feature maps. The reason why the accuracy does not increase when # bins <math id="A4.p1.3.m3.1" class="ltx_Math" alttext="&gt;{256}" display="inline"><semantics id="A4.p1.3.m3.1a"><mrow id="A4.p1.3.m3.1.1" xref="A4.p1.3.m3.1.1.cmml"><mi id="A4.p1.3.m3.1.1.2" xref="A4.p1.3.m3.1.1.2.cmml"></mi><mo id="A4.p1.3.m3.1.1.1" xref="A4.p1.3.m3.1.1.1.cmml">&gt;</mo><mn id="A4.p1.3.m3.1.1.3" xref="A4.p1.3.m3.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.3.m3.1b"><apply id="A4.p1.3.m3.1.1.cmml" xref="A4.p1.3.m3.1.1"><gt id="A4.p1.3.m3.1.1.1.cmml" xref="A4.p1.3.m3.1.1.1"></gt><csymbol cd="latexml" id="A4.p1.3.m3.1.1.2.cmml" xref="A4.p1.3.m3.1.1.2">absent</csymbol><cn type="integer" id="A4.p1.3.m3.1.1.3.cmml" xref="A4.p1.3.m3.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.3.m3.1c">&gt;{256}</annotation></semantics></math> might be that the feature map with size of <math id="A4.p1.4.m4.1" class="ltx_Math" alttext="10\times{10}" display="inline"><semantics id="A4.p1.4.m4.1a"><mrow id="A4.p1.4.m4.1.1" xref="A4.p1.4.m4.1.1.cmml"><mn id="A4.p1.4.m4.1.1.2" xref="A4.p1.4.m4.1.1.2.cmml">10</mn><mo lspace="0.222em" rspace="0.222em" id="A4.p1.4.m4.1.1.1" xref="A4.p1.4.m4.1.1.1.cmml">×</mo><mn id="A4.p1.4.m4.1.1.3" xref="A4.p1.4.m4.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.4.m4.1b"><apply id="A4.p1.4.m4.1.1.cmml" xref="A4.p1.4.m4.1.1"><times id="A4.p1.4.m4.1.1.1.cmml" xref="A4.p1.4.m4.1.1.1"></times><cn type="integer" id="A4.p1.4.m4.1.1.2.cmml" xref="A4.p1.4.m4.1.1.2">10</cn><cn type="integer" id="A4.p1.4.m4.1.1.3.cmml" xref="A4.p1.4.m4.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.4.m4.1c">10\times{10}</annotation></semantics></math> is unable to predict such fine-grained coordinates. From Table <a href="#A4.T5" title="Table 5 ‣ Appendix D D. Ablation Studies ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, it can also be observed that generating <math id="A4.p1.5.m5.1" class="ltx_Math" alttext="1\sim{3}" display="inline"><semantics id="A4.p1.5.m5.1a"><mrow id="A4.p1.5.m5.1.1" xref="A4.p1.5.m5.1.1.cmml"><mn id="A4.p1.5.m5.1.1.2" xref="A4.p1.5.m5.1.1.2.cmml">1</mn><mo id="A4.p1.5.m5.1.1.1" xref="A4.p1.5.m5.1.1.1.cmml">∼</mo><mn id="A4.p1.5.m5.1.1.3" xref="A4.p1.5.m5.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.5.m5.1b"><apply id="A4.p1.5.m5.1.1.cmml" xref="A4.p1.5.m5.1.1"><csymbol cd="latexml" id="A4.p1.5.m5.1.1.1.cmml" xref="A4.p1.5.m5.1.1.1">similar-to</csymbol><cn type="integer" id="A4.p1.5.m5.1.1.2.cmml" xref="A4.p1.5.m5.1.1.2">1</cn><cn type="integer" id="A4.p1.5.m5.1.1.3.cmml" xref="A4.p1.5.m5.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.5.m5.1c">1\sim{3}</annotation></semantics></math> intermediate results decreases the VQA performance, indicating that more intermediate supervisions are helpful for the model to learn visual reasoning and achieve higher performance.</p>
</div>
<figure id="A4.T5" class="ltx_table">
<table id="A4.T5.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A4.T5.1.1.1" class="ltx_tr">
<th id="A4.T5.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="A4.T5.1.1.1.1.1" class="ltx_text ltx_font_bold">Bins</span></th>
<th id="A4.T5.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt"><span id="A4.T5.1.1.1.2.1" class="ltx_text ltx_font_bold">Accuracy</span></th>
<th id="A4.T5.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="A4.T5.1.1.1.3.1" class="ltx_text ltx_font_bold">Number</span></th>
<th id="A4.T5.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="A4.T5.1.1.1.4.1" class="ltx_text ltx_font_bold">Accuracy</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A4.T5.1.2.1" class="ltx_tr">
<th id="A4.T5.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">64</th>
<td id="A4.T5.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">59.35</td>
<th id="A4.T5.1.2.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">1</th>
<td id="A4.T5.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">59.16</td>
</tr>
<tr id="A4.T5.1.3.2" class="ltx_tr">
<th id="A4.T5.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">128</th>
<td id="A4.T5.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r">59.63</td>
<th id="A4.T5.1.3.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_row">2</th>
<td id="A4.T5.1.3.2.4" class="ltx_td ltx_align_center">59.56</td>
</tr>
<tr id="A4.T5.1.4.3" class="ltx_tr">
<th id="A4.T5.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">256</th>
<td id="A4.T5.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r"><span id="A4.T5.1.4.3.2.1" class="ltx_text ltx_font_bold">59.97</span></td>
<th id="A4.T5.1.4.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_row">3</th>
<td id="A4.T5.1.4.3.4" class="ltx_td ltx_align_center">59.78</td>
</tr>
<tr id="A4.T5.1.5.4" class="ltx_tr">
<th id="A4.T5.1.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">384</th>
<td id="A4.T5.1.5.4.2" class="ltx_td ltx_align_center ltx_border_r">59.44</td>
<th id="A4.T5.1.5.4.3" class="ltx_td ltx_align_center ltx_th ltx_th_row">4</th>
<td id="A4.T5.1.5.4.4" class="ltx_td ltx_align_center"><span id="A4.T5.1.5.4.4.1" class="ltx_text ltx_font_bold">59.97</span></td>
</tr>
<tr id="A4.T5.1.6.5" class="ltx_tr">
<th id="A4.T5.1.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb">512</th>
<td id="A4.T5.1.6.5.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">59.66</td>
<th id="A4.T5.1.6.5.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb">5</th>
<td id="A4.T5.1.6.5.4" class="ltx_td ltx_align_center ltx_border_bb">59.25</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Results of different quantized bins and maximum number of generated objects for intermediate supervisions.</figcaption>
</figure>
<figure id="A4.T6" class="ltx_table">
<table id="A4.T6.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A4.T6.1.1.1" class="ltx_tr">
<th id="A4.T6.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="A4.T6.1.1.1.1.1" class="ltx_text ltx_font_bold">Use Shuffle</span></th>
<th id="A4.T6.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="A4.T6.1.1.1.2.1" class="ltx_text ltx_font_bold">Accuracy</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A4.T6.1.2.1" class="ltx_tr">
<td id="A4.T6.1.2.1.1" class="ltx_td ltx_align_center ltx_border_t">✗</td>
<td id="A4.T6.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">59.57</td>
</tr>
<tr id="A4.T6.1.3.2" class="ltx_tr">
<td id="A4.T6.1.3.2.1" class="ltx_td ltx_align_center ltx_border_bb">✓</td>
<td id="A4.T6.1.3.2.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="A4.T6.1.3.2.2.1" class="ltx_text ltx_font_bold">59.97</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Results of different shuffle modes for the intermediate result order.</figcaption>
</figure>
<div id="A4.p2" class="ltx_para ltx_noindent">
<p id="A4.p2.1" class="ltx_p"><span id="A4.p2.1.1" class="ltx_text ltx_font_bold">Shuffle mode of object order: </span> Table <a href="#A4.T6" title="Table 6 ‣ Appendix D D. Ablation Studies ‣ Detection-based Intermediate Supervision for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> shows the results of different shuffle modes when providing intermediate results. As illustrated in Figure 1(a), there might exist multiple results during program inference. Therefore, if we do not shuffle the order of the intermediate results, only part of the objects are used for supervision, hindering the model to learn comprehensive reasoning process. As expected, using the shuffle strategy improves the VQA performance (<em id="A4.p2.1.2" class="ltx_emph ltx_font_italic">i.e.,</em> 59.97% <em id="A4.p2.1.3" class="ltx_emph ltx_font_italic">vs</em> 59.57%).</p>
</div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2312.16011" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2312.16012" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2312.16012">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2312.16012" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2312.16013" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Feb 27 12:17:24 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
