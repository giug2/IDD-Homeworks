<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2303.15168] Personalized Federated Learning on Long-Tailed Data via Adversarial Feature Augmentation</title><meta property="og:description" content="Personalized Federated Learning (PFL) aims to learn personalized models for each client based on the knowledge across all clients in a privacy-preserving manner. Existing PFL methods generally assume that the underlyin…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Personalized Federated Learning on Long-Tailed Data via Adversarial Feature Augmentation">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Personalized Federated Learning on Long-Tailed Data via Adversarial Feature Augmentation">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2303.15168">

<!--Generated on Thu Feb 29 18:15:21 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Personalized Federated Learning on Long-Tailed Data
<br class="ltx_break">via Adversarial Feature Augmentation</h1>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Personalized Federated Learning (PFL) aims to learn personalized models for each client based on the knowledge across all clients in a privacy-preserving manner. Existing PFL methods generally assume that the underlying global data across all clients are uniformly distributed without considering the long-tail distribution. The joint problem of data heterogeneity and long-tail distribution in the FL environment is more challenging and severely affects the performance of personalized models. In this paper, we propose a PFL method called Federated Learning with Adversarial Feature Augmentation (FedAFA) to address this joint problem in PFL. FedAFA optimizes the personalized model for each client by producing a balanced feature set to enhance the local minority classes. The local minority class features are generated by transferring the knowledge from the local majority class features extracted by the global model in an adversarial example learning manner. The experimental results on benchmarks under different settings of data heterogeneity and long-tail distribution demonstrate that FedAFA significantly improves the personalized performance of each client compared with the state-of-the-art PFL algorithm. The code is available at <span id="id1.id1.1" class="ltx_text" style="color:#0000FF;">https://github.com/pxqian/FedAFA<span id="id1.id1.1.1" class="ltx_text" style="color:#000000;">.</span></span></p>
</div>
<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p"><span id="p1.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Index Terms<span id="p1.1.1.1" class="ltx_text ltx_font_upright">— <span id="p1.1.1.1.1" class="ltx_text ltx_font_medium">
Federated Learning, Long-Tail, Adversarial Sample, Feature Augmentation</span></span></span></p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">A common way to build a deep learning model is to collect the training data and train the model on a server, called centralized training.
However, with the increasing data security awareness, such a centralized training paradigm is not applicable in some applications when sensitive data is stored in each data holder. Federated Learning (FL) develops a paradigm to train models without transmitting private data from each data holder (called client in FL) to a centralized server to address the privacy issue in deep learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. However, one major problem in FL is that the aggregated global model is usually not guaranteed to generalize overall clients well because each client’s data distribution is not-independent and identically distributed (non-IID), which is usually defined as the <span id="S1.p1.1.1" class="ltx_text ltx_font_italic">data heterogeneity problem</span> in FL. Therefore, targeting the model generalization ability on each client, Personalized Federated Learning (PFL) aims to obtain a ‘tailored’ local model that utilizes the global model’s generalization ability and simultaneously fits the client’s local data distribution.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Existing PFL methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> have generally achieved promising personalized performance of each client on heterogeneous data. However, the data usually exhibits long-tail distribution in real-world scenarios, where a few head classes contain most samples while a large number of tail classes contain only a few samples. Therefore, it is reasonable to assume that the global data (data across all clients) is in long-tail distribution. In the PFL environment with data heterogeneity, the global tail class samples will be sporadically distributed on only a few clients, and each client’s data distribution is also locally imbalanced. In addition, the local data distributions are likely to differ from the global data distribution, which yields different data imbalance degrees among clients. In this case, the generalization ability of PFL models will further deteriorate because the global tail classes are under-represented by the aggregated global model, which mainly provides the knowledge of the global head classes. In addition, the PFL models are prone to overfitting the local minority classes with only a few samples in personalized optimization on each client. Some existing long-tail learning methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> are also not applicable in the PFL environment because the global data distribution is unknown to both the server and clients due to privacy issues.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">To address the joint problem of data heterogeneity and long-tail distribution in PFL, we propose a PFL method called Federated Learning with Adversarial Feature Augmentation (FedAFA) that utilizes the global model learned across clients to rebalance the local feature set for robust personalized training. Specifically, inspired by the targeted adversarial attack <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, we generate new local minority class features by adding specific small perturbations to the local majority
class features. To not affect the performance of the original local majority classes, we also propose a new optimization objective during personalized training. Experimental results on various heterogeneous and long-tailed benchmarks show that FedAFA surpasses the state-of-the-art PFL and long-tail learning methods.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Proposed Method</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Basics of Personalized Federated Learning</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.25" class="ltx_p">In a typical PFL setting, there are <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">K</annotation></semantics></math> clients participating in the training process and each client <math id="S2.SS1.p1.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">k</annotation></semantics></math> has a private dataset <math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{k}=\{(\mathbf{x}_{i},\mathbf{y}_{i})\}_{i=1}^{n_{k}}" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><mrow id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml"><msub id="S2.SS1.p1.3.m3.1.1.3" xref="S2.SS1.p1.3.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.3.m3.1.1.3.2" xref="S2.SS1.p1.3.m3.1.1.3.2.cmml">𝒟</mi><mi id="S2.SS1.p1.3.m3.1.1.3.3" xref="S2.SS1.p1.3.m3.1.1.3.3.cmml">k</mi></msub><mo id="S2.SS1.p1.3.m3.1.1.2" xref="S2.SS1.p1.3.m3.1.1.2.cmml">=</mo><msubsup id="S2.SS1.p1.3.m3.1.1.1" xref="S2.SS1.p1.3.m3.1.1.1.cmml"><mrow id="S2.SS1.p1.3.m3.1.1.1.1.1.1" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS1.p1.3.m3.1.1.1.1.1.1.2" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2.cmml">{</mo><mrow id="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.2" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.2.3" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.3.cmml">(</mo><msub id="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.2" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.3" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.2.4" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.cmml"><mi id="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.2" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.2.cmml">𝐲</mi><mi id="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.3" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.2.5" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S2.SS1.p1.3.m3.1.1.1.1.1.1.3" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS1.p1.3.m3.1.1.1.1.3" xref="S2.SS1.p1.3.m3.1.1.1.1.3.cmml"><mi id="S2.SS1.p1.3.m3.1.1.1.1.3.2" xref="S2.SS1.p1.3.m3.1.1.1.1.3.2.cmml">i</mi><mo id="S2.SS1.p1.3.m3.1.1.1.1.3.1" xref="S2.SS1.p1.3.m3.1.1.1.1.3.1.cmml">=</mo><mn id="S2.SS1.p1.3.m3.1.1.1.1.3.3" xref="S2.SS1.p1.3.m3.1.1.1.1.3.3.cmml">1</mn></mrow><msub id="S2.SS1.p1.3.m3.1.1.1.3" xref="S2.SS1.p1.3.m3.1.1.1.3.cmml"><mi id="S2.SS1.p1.3.m3.1.1.1.3.2" xref="S2.SS1.p1.3.m3.1.1.1.3.2.cmml">n</mi><mi id="S2.SS1.p1.3.m3.1.1.1.3.3" xref="S2.SS1.p1.3.m3.1.1.1.3.3.cmml">k</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"><eq id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2"></eq><apply id="S2.SS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.3.1.cmml" xref="S2.SS1.p1.3.m3.1.1.3">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.3.2.cmml" xref="S2.SS1.p1.3.m3.1.1.3.2">𝒟</ci><ci id="S2.SS1.p1.3.m3.1.1.3.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3.3">𝑘</ci></apply><apply id="S2.SS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.1">superscript</csymbol><apply id="S2.SS1.p1.3.m3.1.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.1">subscript</csymbol><set id="S2.SS1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1"><interval closure="open" id="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.2"><apply id="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.2">𝐲</ci><ci id="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval></set><apply id="S2.SS1.p1.3.m3.1.1.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.3"><eq id="S2.SS1.p1.3.m3.1.1.1.1.3.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.3.1"></eq><ci id="S2.SS1.p1.3.m3.1.1.1.1.3.2.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S2.SS1.p1.3.m3.1.1.1.1.3.3.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.3.3">1</cn></apply></apply><apply id="S2.SS1.p1.3.m3.1.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.3.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.3">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.1.3.2.cmml" xref="S2.SS1.p1.3.m3.1.1.1.3.2">𝑛</ci><ci id="S2.SS1.p1.3.m3.1.1.1.3.3.cmml" xref="S2.SS1.p1.3.m3.1.1.1.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">\mathcal{D}_{k}=\{(\mathbf{x}_{i},\mathbf{y}_{i})\}_{i=1}^{n_{k}}</annotation></semantics></math>, where <math id="S2.SS1.p1.4.m4.1" class="ltx_Math" alttext="\mathbf{x}_{i}" display="inline"><semantics id="S2.SS1.p1.4.m4.1a"><msub id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml">𝐱</mi><mi id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2">𝐱</ci><ci id="S2.SS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">\mathbf{x}_{i}</annotation></semantics></math> denotes the <math id="S2.SS1.p1.5.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS1.p1.5.m5.1a"><mi id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">i</annotation></semantics></math>th sample in <math id="S2.SS1.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="S2.SS1.p1.6.m6.1a"><msub id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.6.m6.1.1.2" xref="S2.SS1.p1.6.m6.1.1.2.cmml">𝒟</mi><mi id="S2.SS1.p1.6.m6.1.1.3" xref="S2.SS1.p1.6.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><apply id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1.2">𝒟</ci><ci id="S2.SS1.p1.6.m6.1.1.3.cmml" xref="S2.SS1.p1.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">\mathcal{D}_{k}</annotation></semantics></math>, <math id="S2.SS1.p1.7.m7.2" class="ltx_Math" alttext="\mathbf{y}_{i}\in\{0,1\}^{C}" display="inline"><semantics id="S2.SS1.p1.7.m7.2a"><mrow id="S2.SS1.p1.7.m7.2.3" xref="S2.SS1.p1.7.m7.2.3.cmml"><msub id="S2.SS1.p1.7.m7.2.3.2" xref="S2.SS1.p1.7.m7.2.3.2.cmml"><mi id="S2.SS1.p1.7.m7.2.3.2.2" xref="S2.SS1.p1.7.m7.2.3.2.2.cmml">𝐲</mi><mi id="S2.SS1.p1.7.m7.2.3.2.3" xref="S2.SS1.p1.7.m7.2.3.2.3.cmml">i</mi></msub><mo id="S2.SS1.p1.7.m7.2.3.1" xref="S2.SS1.p1.7.m7.2.3.1.cmml">∈</mo><msup id="S2.SS1.p1.7.m7.2.3.3" xref="S2.SS1.p1.7.m7.2.3.3.cmml"><mrow id="S2.SS1.p1.7.m7.2.3.3.2.2" xref="S2.SS1.p1.7.m7.2.3.3.2.1.cmml"><mo stretchy="false" id="S2.SS1.p1.7.m7.2.3.3.2.2.1" xref="S2.SS1.p1.7.m7.2.3.3.2.1.cmml">{</mo><mn id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml">0</mn><mo id="S2.SS1.p1.7.m7.2.3.3.2.2.2" xref="S2.SS1.p1.7.m7.2.3.3.2.1.cmml">,</mo><mn id="S2.SS1.p1.7.m7.2.2" xref="S2.SS1.p1.7.m7.2.2.cmml">1</mn><mo stretchy="false" id="S2.SS1.p1.7.m7.2.3.3.2.2.3" xref="S2.SS1.p1.7.m7.2.3.3.2.1.cmml">}</mo></mrow><mi id="S2.SS1.p1.7.m7.2.3.3.3" xref="S2.SS1.p1.7.m7.2.3.3.3.cmml">C</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.2b"><apply id="S2.SS1.p1.7.m7.2.3.cmml" xref="S2.SS1.p1.7.m7.2.3"><in id="S2.SS1.p1.7.m7.2.3.1.cmml" xref="S2.SS1.p1.7.m7.2.3.1"></in><apply id="S2.SS1.p1.7.m7.2.3.2.cmml" xref="S2.SS1.p1.7.m7.2.3.2"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.2.3.2.1.cmml" xref="S2.SS1.p1.7.m7.2.3.2">subscript</csymbol><ci id="S2.SS1.p1.7.m7.2.3.2.2.cmml" xref="S2.SS1.p1.7.m7.2.3.2.2">𝐲</ci><ci id="S2.SS1.p1.7.m7.2.3.2.3.cmml" xref="S2.SS1.p1.7.m7.2.3.2.3">𝑖</ci></apply><apply id="S2.SS1.p1.7.m7.2.3.3.cmml" xref="S2.SS1.p1.7.m7.2.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.2.3.3.1.cmml" xref="S2.SS1.p1.7.m7.2.3.3">superscript</csymbol><set id="S2.SS1.p1.7.m7.2.3.3.2.1.cmml" xref="S2.SS1.p1.7.m7.2.3.3.2.2"><cn type="integer" id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">0</cn><cn type="integer" id="S2.SS1.p1.7.m7.2.2.cmml" xref="S2.SS1.p1.7.m7.2.2">1</cn></set><ci id="S2.SS1.p1.7.m7.2.3.3.3.cmml" xref="S2.SS1.p1.7.m7.2.3.3.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.2c">\mathbf{y}_{i}\in\{0,1\}^{C}</annotation></semantics></math> is the corresponding label over <math id="S2.SS1.p1.8.m8.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S2.SS1.p1.8.m8.1a"><mi id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.1b"><ci id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.1c">C</annotation></semantics></math> classes, and <math id="S2.SS1.p1.9.m9.1" class="ltx_Math" alttext="n_{k}" display="inline"><semantics id="S2.SS1.p1.9.m9.1a"><msub id="S2.SS1.p1.9.m9.1.1" xref="S2.SS1.p1.9.m9.1.1.cmml"><mi id="S2.SS1.p1.9.m9.1.1.2" xref="S2.SS1.p1.9.m9.1.1.2.cmml">n</mi><mi id="S2.SS1.p1.9.m9.1.1.3" xref="S2.SS1.p1.9.m9.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m9.1b"><apply id="S2.SS1.p1.9.m9.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.1.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1">subscript</csymbol><ci id="S2.SS1.p1.9.m9.1.1.2.cmml" xref="S2.SS1.p1.9.m9.1.1.2">𝑛</ci><ci id="S2.SS1.p1.9.m9.1.1.3.cmml" xref="S2.SS1.p1.9.m9.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m9.1c">n_{k}</annotation></semantics></math> is the number of samples in <math id="S2.SS1.p1.10.m10.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="S2.SS1.p1.10.m10.1a"><msub id="S2.SS1.p1.10.m10.1.1" xref="S2.SS1.p1.10.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.10.m10.1.1.2" xref="S2.SS1.p1.10.m10.1.1.2.cmml">𝒟</mi><mi id="S2.SS1.p1.10.m10.1.1.3" xref="S2.SS1.p1.10.m10.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m10.1b"><apply id="S2.SS1.p1.10.m10.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.1.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1">subscript</csymbol><ci id="S2.SS1.p1.10.m10.1.1.2.cmml" xref="S2.SS1.p1.10.m10.1.1.2">𝒟</ci><ci id="S2.SS1.p1.10.m10.1.1.3.cmml" xref="S2.SS1.p1.10.m10.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m10.1c">\mathcal{D}_{k}</annotation></semantics></math>. PFL aims to look for good local models (personalized models) for all <math id="S2.SS1.p1.11.m11.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS1.p1.11.m11.1a"><mi id="S2.SS1.p1.11.m11.1.1" xref="S2.SS1.p1.11.m11.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m11.1b"><ci id="S2.SS1.p1.11.m11.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m11.1c">K</annotation></semantics></math> clients, which are usually adapted from the global model <math id="S2.SS1.p1.12.m12.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S2.SS1.p1.12.m12.1a"><mi id="S2.SS1.p1.12.m12.1.1" xref="S2.SS1.p1.12.m12.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.12.m12.1b"><ci id="S2.SS1.p1.12.m12.1.1.cmml" xref="S2.SS1.p1.12.m12.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.12.m12.1c">\mathbf{w}</annotation></semantics></math>. FedAvg-FT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> is the most straightforward PFL method. It is a locally adaptive algorithm based on fine-tuning the global model by <math id="S2.SS1.p1.13.m13.2" class="ltx_Math" alttext="\mathbf{w}_{k}=\mathbf{w}-\eta\nabla\mathcal{L}_{k}(\mathcal{D}_{k};\mathbf{w})" display="inline"><semantics id="S2.SS1.p1.13.m13.2a"><mrow id="S2.SS1.p1.13.m13.2.2" xref="S2.SS1.p1.13.m13.2.2.cmml"><msub id="S2.SS1.p1.13.m13.2.2.3" xref="S2.SS1.p1.13.m13.2.2.3.cmml"><mi id="S2.SS1.p1.13.m13.2.2.3.2" xref="S2.SS1.p1.13.m13.2.2.3.2.cmml">𝐰</mi><mi id="S2.SS1.p1.13.m13.2.2.3.3" xref="S2.SS1.p1.13.m13.2.2.3.3.cmml">k</mi></msub><mo id="S2.SS1.p1.13.m13.2.2.2" xref="S2.SS1.p1.13.m13.2.2.2.cmml">=</mo><mrow id="S2.SS1.p1.13.m13.2.2.1" xref="S2.SS1.p1.13.m13.2.2.1.cmml"><mi id="S2.SS1.p1.13.m13.2.2.1.3" xref="S2.SS1.p1.13.m13.2.2.1.3.cmml">𝐰</mi><mo id="S2.SS1.p1.13.m13.2.2.1.2" xref="S2.SS1.p1.13.m13.2.2.1.2.cmml">−</mo><mrow id="S2.SS1.p1.13.m13.2.2.1.1" xref="S2.SS1.p1.13.m13.2.2.1.1.cmml"><mi id="S2.SS1.p1.13.m13.2.2.1.1.3" xref="S2.SS1.p1.13.m13.2.2.1.1.3.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="S2.SS1.p1.13.m13.2.2.1.1.2" xref="S2.SS1.p1.13.m13.2.2.1.1.2.cmml">​</mo><mrow id="S2.SS1.p1.13.m13.2.2.1.1.4" xref="S2.SS1.p1.13.m13.2.2.1.1.4.cmml"><mo rspace="0.167em" id="S2.SS1.p1.13.m13.2.2.1.1.4.1" xref="S2.SS1.p1.13.m13.2.2.1.1.4.1.cmml">∇</mo><msub id="S2.SS1.p1.13.m13.2.2.1.1.4.2" xref="S2.SS1.p1.13.m13.2.2.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.13.m13.2.2.1.1.4.2.2" xref="S2.SS1.p1.13.m13.2.2.1.1.4.2.2.cmml">ℒ</mi><mi id="S2.SS1.p1.13.m13.2.2.1.1.4.2.3" xref="S2.SS1.p1.13.m13.2.2.1.1.4.2.3.cmml">k</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.SS1.p1.13.m13.2.2.1.1.2a" xref="S2.SS1.p1.13.m13.2.2.1.1.2.cmml">​</mo><mrow id="S2.SS1.p1.13.m13.2.2.1.1.1.1" xref="S2.SS1.p1.13.m13.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS1.p1.13.m13.2.2.1.1.1.1.2" xref="S2.SS1.p1.13.m13.2.2.1.1.1.2.cmml">(</mo><msub id="S2.SS1.p1.13.m13.2.2.1.1.1.1.1" xref="S2.SS1.p1.13.m13.2.2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.13.m13.2.2.1.1.1.1.1.2" xref="S2.SS1.p1.13.m13.2.2.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S2.SS1.p1.13.m13.2.2.1.1.1.1.1.3" xref="S2.SS1.p1.13.m13.2.2.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S2.SS1.p1.13.m13.2.2.1.1.1.1.3" xref="S2.SS1.p1.13.m13.2.2.1.1.1.2.cmml">;</mo><mi id="S2.SS1.p1.13.m13.1.1" xref="S2.SS1.p1.13.m13.1.1.cmml">𝐰</mi><mo stretchy="false" id="S2.SS1.p1.13.m13.2.2.1.1.1.1.4" xref="S2.SS1.p1.13.m13.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.13.m13.2b"><apply id="S2.SS1.p1.13.m13.2.2.cmml" xref="S2.SS1.p1.13.m13.2.2"><eq id="S2.SS1.p1.13.m13.2.2.2.cmml" xref="S2.SS1.p1.13.m13.2.2.2"></eq><apply id="S2.SS1.p1.13.m13.2.2.3.cmml" xref="S2.SS1.p1.13.m13.2.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.13.m13.2.2.3.1.cmml" xref="S2.SS1.p1.13.m13.2.2.3">subscript</csymbol><ci id="S2.SS1.p1.13.m13.2.2.3.2.cmml" xref="S2.SS1.p1.13.m13.2.2.3.2">𝐰</ci><ci id="S2.SS1.p1.13.m13.2.2.3.3.cmml" xref="S2.SS1.p1.13.m13.2.2.3.3">𝑘</ci></apply><apply id="S2.SS1.p1.13.m13.2.2.1.cmml" xref="S2.SS1.p1.13.m13.2.2.1"><minus id="S2.SS1.p1.13.m13.2.2.1.2.cmml" xref="S2.SS1.p1.13.m13.2.2.1.2"></minus><ci id="S2.SS1.p1.13.m13.2.2.1.3.cmml" xref="S2.SS1.p1.13.m13.2.2.1.3">𝐰</ci><apply id="S2.SS1.p1.13.m13.2.2.1.1.cmml" xref="S2.SS1.p1.13.m13.2.2.1.1"><times id="S2.SS1.p1.13.m13.2.2.1.1.2.cmml" xref="S2.SS1.p1.13.m13.2.2.1.1.2"></times><ci id="S2.SS1.p1.13.m13.2.2.1.1.3.cmml" xref="S2.SS1.p1.13.m13.2.2.1.1.3">𝜂</ci><apply id="S2.SS1.p1.13.m13.2.2.1.1.4.cmml" xref="S2.SS1.p1.13.m13.2.2.1.1.4"><ci id="S2.SS1.p1.13.m13.2.2.1.1.4.1.cmml" xref="S2.SS1.p1.13.m13.2.2.1.1.4.1">∇</ci><apply id="S2.SS1.p1.13.m13.2.2.1.1.4.2.cmml" xref="S2.SS1.p1.13.m13.2.2.1.1.4.2"><csymbol cd="ambiguous" id="S2.SS1.p1.13.m13.2.2.1.1.4.2.1.cmml" xref="S2.SS1.p1.13.m13.2.2.1.1.4.2">subscript</csymbol><ci id="S2.SS1.p1.13.m13.2.2.1.1.4.2.2.cmml" xref="S2.SS1.p1.13.m13.2.2.1.1.4.2.2">ℒ</ci><ci id="S2.SS1.p1.13.m13.2.2.1.1.4.2.3.cmml" xref="S2.SS1.p1.13.m13.2.2.1.1.4.2.3">𝑘</ci></apply></apply><list id="S2.SS1.p1.13.m13.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.13.m13.2.2.1.1.1.1"><apply id="S2.SS1.p1.13.m13.2.2.1.1.1.1.1.cmml" xref="S2.SS1.p1.13.m13.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.13.m13.2.2.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.13.m13.2.2.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.13.m13.2.2.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.13.m13.2.2.1.1.1.1.1.2">𝒟</ci><ci id="S2.SS1.p1.13.m13.2.2.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.13.m13.2.2.1.1.1.1.1.3">𝑘</ci></apply><ci id="S2.SS1.p1.13.m13.1.1.cmml" xref="S2.SS1.p1.13.m13.1.1">𝐰</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.13.m13.2c">\mathbf{w}_{k}=\mathbf{w}-\eta\nabla\mathcal{L}_{k}(\mathcal{D}_{k};\mathbf{w})</annotation></semantics></math> on <math id="S2.SS1.p1.14.m14.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="S2.SS1.p1.14.m14.1a"><msub id="S2.SS1.p1.14.m14.1.1" xref="S2.SS1.p1.14.m14.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.14.m14.1.1.2" xref="S2.SS1.p1.14.m14.1.1.2.cmml">𝒟</mi><mi id="S2.SS1.p1.14.m14.1.1.3" xref="S2.SS1.p1.14.m14.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.14.m14.1b"><apply id="S2.SS1.p1.14.m14.1.1.cmml" xref="S2.SS1.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.14.m14.1.1.1.cmml" xref="S2.SS1.p1.14.m14.1.1">subscript</csymbol><ci id="S2.SS1.p1.14.m14.1.1.2.cmml" xref="S2.SS1.p1.14.m14.1.1.2">𝒟</ci><ci id="S2.SS1.p1.14.m14.1.1.3.cmml" xref="S2.SS1.p1.14.m14.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.14.m14.1c">\mathcal{D}_{k}</annotation></semantics></math>, where <math id="S2.SS1.p1.15.m15.2" class="ltx_Math" alttext="\mathcal{L}_{k}(\mathcal{D}_{k};\mathbf{w})" display="inline"><semantics id="S2.SS1.p1.15.m15.2a"><mrow id="S2.SS1.p1.15.m15.2.2" xref="S2.SS1.p1.15.m15.2.2.cmml"><msub id="S2.SS1.p1.15.m15.2.2.3" xref="S2.SS1.p1.15.m15.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.15.m15.2.2.3.2" xref="S2.SS1.p1.15.m15.2.2.3.2.cmml">ℒ</mi><mi id="S2.SS1.p1.15.m15.2.2.3.3" xref="S2.SS1.p1.15.m15.2.2.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS1.p1.15.m15.2.2.2" xref="S2.SS1.p1.15.m15.2.2.2.cmml">​</mo><mrow id="S2.SS1.p1.15.m15.2.2.1.1" xref="S2.SS1.p1.15.m15.2.2.1.2.cmml"><mo stretchy="false" id="S2.SS1.p1.15.m15.2.2.1.1.2" xref="S2.SS1.p1.15.m15.2.2.1.2.cmml">(</mo><msub id="S2.SS1.p1.15.m15.2.2.1.1.1" xref="S2.SS1.p1.15.m15.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.15.m15.2.2.1.1.1.2" xref="S2.SS1.p1.15.m15.2.2.1.1.1.2.cmml">𝒟</mi><mi id="S2.SS1.p1.15.m15.2.2.1.1.1.3" xref="S2.SS1.p1.15.m15.2.2.1.1.1.3.cmml">k</mi></msub><mo id="S2.SS1.p1.15.m15.2.2.1.1.3" xref="S2.SS1.p1.15.m15.2.2.1.2.cmml">;</mo><mi id="S2.SS1.p1.15.m15.1.1" xref="S2.SS1.p1.15.m15.1.1.cmml">𝐰</mi><mo stretchy="false" id="S2.SS1.p1.15.m15.2.2.1.1.4" xref="S2.SS1.p1.15.m15.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.15.m15.2b"><apply id="S2.SS1.p1.15.m15.2.2.cmml" xref="S2.SS1.p1.15.m15.2.2"><times id="S2.SS1.p1.15.m15.2.2.2.cmml" xref="S2.SS1.p1.15.m15.2.2.2"></times><apply id="S2.SS1.p1.15.m15.2.2.3.cmml" xref="S2.SS1.p1.15.m15.2.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.15.m15.2.2.3.1.cmml" xref="S2.SS1.p1.15.m15.2.2.3">subscript</csymbol><ci id="S2.SS1.p1.15.m15.2.2.3.2.cmml" xref="S2.SS1.p1.15.m15.2.2.3.2">ℒ</ci><ci id="S2.SS1.p1.15.m15.2.2.3.3.cmml" xref="S2.SS1.p1.15.m15.2.2.3.3">𝑘</ci></apply><list id="S2.SS1.p1.15.m15.2.2.1.2.cmml" xref="S2.SS1.p1.15.m15.2.2.1.1"><apply id="S2.SS1.p1.15.m15.2.2.1.1.1.cmml" xref="S2.SS1.p1.15.m15.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.15.m15.2.2.1.1.1.1.cmml" xref="S2.SS1.p1.15.m15.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.15.m15.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.15.m15.2.2.1.1.1.2">𝒟</ci><ci id="S2.SS1.p1.15.m15.2.2.1.1.1.3.cmml" xref="S2.SS1.p1.15.m15.2.2.1.1.1.3">𝑘</ci></apply><ci id="S2.SS1.p1.15.m15.1.1.cmml" xref="S2.SS1.p1.15.m15.1.1">𝐰</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.15.m15.2c">\mathcal{L}_{k}(\mathcal{D}_{k};\mathbf{w})</annotation></semantics></math> is the local training loss of the model <math id="S2.SS1.p1.16.m16.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S2.SS1.p1.16.m16.1a"><mi id="S2.SS1.p1.16.m16.1.1" xref="S2.SS1.p1.16.m16.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.16.m16.1b"><ci id="S2.SS1.p1.16.m16.1.1.cmml" xref="S2.SS1.p1.16.m16.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.16.m16.1c">\mathbf{w}</annotation></semantics></math> on <math id="S2.SS1.p1.17.m17.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="S2.SS1.p1.17.m17.1a"><msub id="S2.SS1.p1.17.m17.1.1" xref="S2.SS1.p1.17.m17.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.17.m17.1.1.2" xref="S2.SS1.p1.17.m17.1.1.2.cmml">𝒟</mi><mi id="S2.SS1.p1.17.m17.1.1.3" xref="S2.SS1.p1.17.m17.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.17.m17.1b"><apply id="S2.SS1.p1.17.m17.1.1.cmml" xref="S2.SS1.p1.17.m17.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.17.m17.1.1.1.cmml" xref="S2.SS1.p1.17.m17.1.1">subscript</csymbol><ci id="S2.SS1.p1.17.m17.1.1.2.cmml" xref="S2.SS1.p1.17.m17.1.1.2">𝒟</ci><ci id="S2.SS1.p1.17.m17.1.1.3.cmml" xref="S2.SS1.p1.17.m17.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.17.m17.1c">\mathcal{D}_{k}</annotation></semantics></math>. <math id="S2.SS1.p1.18.m18.9" class="ltx_Math" alttext="\mathcal{L}_{k}(\mathcal{D}_{k};\mathbf{w})=\frac{1}{|\mathcal{D}_{k}|}\sum_{(\mathbf{x},\mathbf{y})\in\mathcal{D}_{k}}\ell(\mathbf{y},f(\mathbf{x};\mathbf{w}))" display="inline"><semantics id="S2.SS1.p1.18.m18.9a"><mrow id="S2.SS1.p1.18.m18.9.9" xref="S2.SS1.p1.18.m18.9.9.cmml"><mrow id="S2.SS1.p1.18.m18.8.8.1" xref="S2.SS1.p1.18.m18.8.8.1.cmml"><msub id="S2.SS1.p1.18.m18.8.8.1.3" xref="S2.SS1.p1.18.m18.8.8.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.18.m18.8.8.1.3.2" xref="S2.SS1.p1.18.m18.8.8.1.3.2.cmml">ℒ</mi><mi id="S2.SS1.p1.18.m18.8.8.1.3.3" xref="S2.SS1.p1.18.m18.8.8.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS1.p1.18.m18.8.8.1.2" xref="S2.SS1.p1.18.m18.8.8.1.2.cmml">​</mo><mrow id="S2.SS1.p1.18.m18.8.8.1.1.1" xref="S2.SS1.p1.18.m18.8.8.1.1.2.cmml"><mo stretchy="false" id="S2.SS1.p1.18.m18.8.8.1.1.1.2" xref="S2.SS1.p1.18.m18.8.8.1.1.2.cmml">(</mo><msub id="S2.SS1.p1.18.m18.8.8.1.1.1.1" xref="S2.SS1.p1.18.m18.8.8.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.18.m18.8.8.1.1.1.1.2" xref="S2.SS1.p1.18.m18.8.8.1.1.1.1.2.cmml">𝒟</mi><mi id="S2.SS1.p1.18.m18.8.8.1.1.1.1.3" xref="S2.SS1.p1.18.m18.8.8.1.1.1.1.3.cmml">k</mi></msub><mo id="S2.SS1.p1.18.m18.8.8.1.1.1.3" xref="S2.SS1.p1.18.m18.8.8.1.1.2.cmml">;</mo><mi id="S2.SS1.p1.18.m18.4.4" xref="S2.SS1.p1.18.m18.4.4.cmml">𝐰</mi><mo stretchy="false" id="S2.SS1.p1.18.m18.8.8.1.1.1.4" xref="S2.SS1.p1.18.m18.8.8.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.SS1.p1.18.m18.9.9.3" xref="S2.SS1.p1.18.m18.9.9.3.cmml">=</mo><mrow id="S2.SS1.p1.18.m18.9.9.2" xref="S2.SS1.p1.18.m18.9.9.2.cmml"><mfrac id="S2.SS1.p1.18.m18.1.1" xref="S2.SS1.p1.18.m18.1.1.cmml"><mn id="S2.SS1.p1.18.m18.1.1.3" xref="S2.SS1.p1.18.m18.1.1.3.cmml">1</mn><mrow id="S2.SS1.p1.18.m18.1.1.1.1" xref="S2.SS1.p1.18.m18.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS1.p1.18.m18.1.1.1.1.2" xref="S2.SS1.p1.18.m18.1.1.1.2.1.cmml">|</mo><msub id="S2.SS1.p1.18.m18.1.1.1.1.1" xref="S2.SS1.p1.18.m18.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.18.m18.1.1.1.1.1.2" xref="S2.SS1.p1.18.m18.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S2.SS1.p1.18.m18.1.1.1.1.1.3" xref="S2.SS1.p1.18.m18.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S2.SS1.p1.18.m18.1.1.1.1.3" xref="S2.SS1.p1.18.m18.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S2.SS1.p1.18.m18.9.9.2.2" xref="S2.SS1.p1.18.m18.9.9.2.2.cmml">​</mo><mrow id="S2.SS1.p1.18.m18.9.9.2.1" xref="S2.SS1.p1.18.m18.9.9.2.1.cmml"><msub id="S2.SS1.p1.18.m18.9.9.2.1.2" xref="S2.SS1.p1.18.m18.9.9.2.1.2.cmml"><mo id="S2.SS1.p1.18.m18.9.9.2.1.2.2" xref="S2.SS1.p1.18.m18.9.9.2.1.2.2.cmml">∑</mo><mrow id="S2.SS1.p1.18.m18.3.3.2" xref="S2.SS1.p1.18.m18.3.3.2.cmml"><mrow id="S2.SS1.p1.18.m18.3.3.2.4.2" xref="S2.SS1.p1.18.m18.3.3.2.4.1.cmml"><mo stretchy="false" id="S2.SS1.p1.18.m18.3.3.2.4.2.1" xref="S2.SS1.p1.18.m18.3.3.2.4.1.cmml">(</mo><mi id="S2.SS1.p1.18.m18.2.2.1.1" xref="S2.SS1.p1.18.m18.2.2.1.1.cmml">𝐱</mi><mo id="S2.SS1.p1.18.m18.3.3.2.4.2.2" xref="S2.SS1.p1.18.m18.3.3.2.4.1.cmml">,</mo><mi id="S2.SS1.p1.18.m18.3.3.2.2" xref="S2.SS1.p1.18.m18.3.3.2.2.cmml">𝐲</mi><mo stretchy="false" id="S2.SS1.p1.18.m18.3.3.2.4.2.3" xref="S2.SS1.p1.18.m18.3.3.2.4.1.cmml">)</mo></mrow><mo id="S2.SS1.p1.18.m18.3.3.2.3" xref="S2.SS1.p1.18.m18.3.3.2.3.cmml">∈</mo><msub id="S2.SS1.p1.18.m18.3.3.2.5" xref="S2.SS1.p1.18.m18.3.3.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.18.m18.3.3.2.5.2" xref="S2.SS1.p1.18.m18.3.3.2.5.2.cmml">𝒟</mi><mi id="S2.SS1.p1.18.m18.3.3.2.5.3" xref="S2.SS1.p1.18.m18.3.3.2.5.3.cmml">k</mi></msub></mrow></msub><mrow id="S2.SS1.p1.18.m18.9.9.2.1.1" xref="S2.SS1.p1.18.m18.9.9.2.1.1.cmml"><mi mathvariant="normal" id="S2.SS1.p1.18.m18.9.9.2.1.1.3" xref="S2.SS1.p1.18.m18.9.9.2.1.1.3.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.18.m18.9.9.2.1.1.2" xref="S2.SS1.p1.18.m18.9.9.2.1.1.2.cmml">​</mo><mrow id="S2.SS1.p1.18.m18.9.9.2.1.1.1.1" xref="S2.SS1.p1.18.m18.9.9.2.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS1.p1.18.m18.9.9.2.1.1.1.1.2" xref="S2.SS1.p1.18.m18.9.9.2.1.1.1.2.cmml">(</mo><mi id="S2.SS1.p1.18.m18.7.7" xref="S2.SS1.p1.18.m18.7.7.cmml">𝐲</mi><mo id="S2.SS1.p1.18.m18.9.9.2.1.1.1.1.3" xref="S2.SS1.p1.18.m18.9.9.2.1.1.1.2.cmml">,</mo><mrow id="S2.SS1.p1.18.m18.9.9.2.1.1.1.1.1" xref="S2.SS1.p1.18.m18.9.9.2.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.18.m18.9.9.2.1.1.1.1.1.2" xref="S2.SS1.p1.18.m18.9.9.2.1.1.1.1.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.18.m18.9.9.2.1.1.1.1.1.1" xref="S2.SS1.p1.18.m18.9.9.2.1.1.1.1.1.1.cmml">​</mo><mrow id="S2.SS1.p1.18.m18.9.9.2.1.1.1.1.1.3.2" xref="S2.SS1.p1.18.m18.9.9.2.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S2.SS1.p1.18.m18.9.9.2.1.1.1.1.1.3.2.1" xref="S2.SS1.p1.18.m18.9.9.2.1.1.1.1.1.3.1.cmml">(</mo><mi id="S2.SS1.p1.18.m18.5.5" xref="S2.SS1.p1.18.m18.5.5.cmml">𝐱</mi><mo id="S2.SS1.p1.18.m18.9.9.2.1.1.1.1.1.3.2.2" xref="S2.SS1.p1.18.m18.9.9.2.1.1.1.1.1.3.1.cmml">;</mo><mi id="S2.SS1.p1.18.m18.6.6" xref="S2.SS1.p1.18.m18.6.6.cmml">𝐰</mi><mo stretchy="false" id="S2.SS1.p1.18.m18.9.9.2.1.1.1.1.1.3.2.3" xref="S2.SS1.p1.18.m18.9.9.2.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.SS1.p1.18.m18.9.9.2.1.1.1.1.4" xref="S2.SS1.p1.18.m18.9.9.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.18.m18.9b"><apply id="S2.SS1.p1.18.m18.9.9.cmml" xref="S2.SS1.p1.18.m18.9.9"><eq id="S2.SS1.p1.18.m18.9.9.3.cmml" xref="S2.SS1.p1.18.m18.9.9.3"></eq><apply id="S2.SS1.p1.18.m18.8.8.1.cmml" xref="S2.SS1.p1.18.m18.8.8.1"><times id="S2.SS1.p1.18.m18.8.8.1.2.cmml" xref="S2.SS1.p1.18.m18.8.8.1.2"></times><apply id="S2.SS1.p1.18.m18.8.8.1.3.cmml" xref="S2.SS1.p1.18.m18.8.8.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.18.m18.8.8.1.3.1.cmml" xref="S2.SS1.p1.18.m18.8.8.1.3">subscript</csymbol><ci id="S2.SS1.p1.18.m18.8.8.1.3.2.cmml" xref="S2.SS1.p1.18.m18.8.8.1.3.2">ℒ</ci><ci id="S2.SS1.p1.18.m18.8.8.1.3.3.cmml" xref="S2.SS1.p1.18.m18.8.8.1.3.3">𝑘</ci></apply><list id="S2.SS1.p1.18.m18.8.8.1.1.2.cmml" xref="S2.SS1.p1.18.m18.8.8.1.1.1"><apply id="S2.SS1.p1.18.m18.8.8.1.1.1.1.cmml" xref="S2.SS1.p1.18.m18.8.8.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.18.m18.8.8.1.1.1.1.1.cmml" xref="S2.SS1.p1.18.m18.8.8.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.18.m18.8.8.1.1.1.1.2.cmml" xref="S2.SS1.p1.18.m18.8.8.1.1.1.1.2">𝒟</ci><ci id="S2.SS1.p1.18.m18.8.8.1.1.1.1.3.cmml" xref="S2.SS1.p1.18.m18.8.8.1.1.1.1.3">𝑘</ci></apply><ci id="S2.SS1.p1.18.m18.4.4.cmml" xref="S2.SS1.p1.18.m18.4.4">𝐰</ci></list></apply><apply id="S2.SS1.p1.18.m18.9.9.2.cmml" xref="S2.SS1.p1.18.m18.9.9.2"><times id="S2.SS1.p1.18.m18.9.9.2.2.cmml" xref="S2.SS1.p1.18.m18.9.9.2.2"></times><apply id="S2.SS1.p1.18.m18.1.1.cmml" xref="S2.SS1.p1.18.m18.1.1"><divide id="S2.SS1.p1.18.m18.1.1.2.cmml" xref="S2.SS1.p1.18.m18.1.1"></divide><cn type="integer" id="S2.SS1.p1.18.m18.1.1.3.cmml" xref="S2.SS1.p1.18.m18.1.1.3">1</cn><apply id="S2.SS1.p1.18.m18.1.1.1.2.cmml" xref="S2.SS1.p1.18.m18.1.1.1.1"><abs id="S2.SS1.p1.18.m18.1.1.1.2.1.cmml" xref="S2.SS1.p1.18.m18.1.1.1.1.2"></abs><apply id="S2.SS1.p1.18.m18.1.1.1.1.1.cmml" xref="S2.SS1.p1.18.m18.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.18.m18.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.18.m18.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.18.m18.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.18.m18.1.1.1.1.1.2">𝒟</ci><ci id="S2.SS1.p1.18.m18.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.18.m18.1.1.1.1.1.3">𝑘</ci></apply></apply></apply><apply id="S2.SS1.p1.18.m18.9.9.2.1.cmml" xref="S2.SS1.p1.18.m18.9.9.2.1"><apply id="S2.SS1.p1.18.m18.9.9.2.1.2.cmml" xref="S2.SS1.p1.18.m18.9.9.2.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.18.m18.9.9.2.1.2.1.cmml" xref="S2.SS1.p1.18.m18.9.9.2.1.2">subscript</csymbol><sum id="S2.SS1.p1.18.m18.9.9.2.1.2.2.cmml" xref="S2.SS1.p1.18.m18.9.9.2.1.2.2"></sum><apply id="S2.SS1.p1.18.m18.3.3.2.cmml" xref="S2.SS1.p1.18.m18.3.3.2"><in id="S2.SS1.p1.18.m18.3.3.2.3.cmml" xref="S2.SS1.p1.18.m18.3.3.2.3"></in><interval closure="open" id="S2.SS1.p1.18.m18.3.3.2.4.1.cmml" xref="S2.SS1.p1.18.m18.3.3.2.4.2"><ci id="S2.SS1.p1.18.m18.2.2.1.1.cmml" xref="S2.SS1.p1.18.m18.2.2.1.1">𝐱</ci><ci id="S2.SS1.p1.18.m18.3.3.2.2.cmml" xref="S2.SS1.p1.18.m18.3.3.2.2">𝐲</ci></interval><apply id="S2.SS1.p1.18.m18.3.3.2.5.cmml" xref="S2.SS1.p1.18.m18.3.3.2.5"><csymbol cd="ambiguous" id="S2.SS1.p1.18.m18.3.3.2.5.1.cmml" xref="S2.SS1.p1.18.m18.3.3.2.5">subscript</csymbol><ci id="S2.SS1.p1.18.m18.3.3.2.5.2.cmml" xref="S2.SS1.p1.18.m18.3.3.2.5.2">𝒟</ci><ci id="S2.SS1.p1.18.m18.3.3.2.5.3.cmml" xref="S2.SS1.p1.18.m18.3.3.2.5.3">𝑘</ci></apply></apply></apply><apply id="S2.SS1.p1.18.m18.9.9.2.1.1.cmml" xref="S2.SS1.p1.18.m18.9.9.2.1.1"><times id="S2.SS1.p1.18.m18.9.9.2.1.1.2.cmml" xref="S2.SS1.p1.18.m18.9.9.2.1.1.2"></times><ci id="S2.SS1.p1.18.m18.9.9.2.1.1.3.cmml" xref="S2.SS1.p1.18.m18.9.9.2.1.1.3">ℓ</ci><interval closure="open" id="S2.SS1.p1.18.m18.9.9.2.1.1.1.2.cmml" xref="S2.SS1.p1.18.m18.9.9.2.1.1.1.1"><ci id="S2.SS1.p1.18.m18.7.7.cmml" xref="S2.SS1.p1.18.m18.7.7">𝐲</ci><apply id="S2.SS1.p1.18.m18.9.9.2.1.1.1.1.1.cmml" xref="S2.SS1.p1.18.m18.9.9.2.1.1.1.1.1"><times id="S2.SS1.p1.18.m18.9.9.2.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.18.m18.9.9.2.1.1.1.1.1.1"></times><ci id="S2.SS1.p1.18.m18.9.9.2.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.18.m18.9.9.2.1.1.1.1.1.2">𝑓</ci><list id="S2.SS1.p1.18.m18.9.9.2.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p1.18.m18.9.9.2.1.1.1.1.1.3.2"><ci id="S2.SS1.p1.18.m18.5.5.cmml" xref="S2.SS1.p1.18.m18.5.5">𝐱</ci><ci id="S2.SS1.p1.18.m18.6.6.cmml" xref="S2.SS1.p1.18.m18.6.6">𝐰</ci></list></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.18.m18.9c">\mathcal{L}_{k}(\mathcal{D}_{k};\mathbf{w})=\frac{1}{|\mathcal{D}_{k}|}\sum_{(\mathbf{x},\mathbf{y})\in\mathcal{D}_{k}}\ell(\mathbf{y},f(\mathbf{x};\mathbf{w}))</annotation></semantics></math> is calculated by averaging sample losses in <math id="S2.SS1.p1.19.m19.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="S2.SS1.p1.19.m19.1a"><msub id="S2.SS1.p1.19.m19.1.1" xref="S2.SS1.p1.19.m19.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.19.m19.1.1.2" xref="S2.SS1.p1.19.m19.1.1.2.cmml">𝒟</mi><mi id="S2.SS1.p1.19.m19.1.1.3" xref="S2.SS1.p1.19.m19.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.19.m19.1b"><apply id="S2.SS1.p1.19.m19.1.1.cmml" xref="S2.SS1.p1.19.m19.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.19.m19.1.1.1.cmml" xref="S2.SS1.p1.19.m19.1.1">subscript</csymbol><ci id="S2.SS1.p1.19.m19.1.1.2.cmml" xref="S2.SS1.p1.19.m19.1.1.2">𝒟</ci><ci id="S2.SS1.p1.19.m19.1.1.3.cmml" xref="S2.SS1.p1.19.m19.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.19.m19.1c">\mathcal{D}_{k}</annotation></semantics></math>,
where <math id="S2.SS1.p1.20.m20.2" class="ltx_Math" alttext="\ell(\cdot,\cdot)" display="inline"><semantics id="S2.SS1.p1.20.m20.2a"><mrow id="S2.SS1.p1.20.m20.2.3" xref="S2.SS1.p1.20.m20.2.3.cmml"><mi mathvariant="normal" id="S2.SS1.p1.20.m20.2.3.2" xref="S2.SS1.p1.20.m20.2.3.2.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.20.m20.2.3.1" xref="S2.SS1.p1.20.m20.2.3.1.cmml">​</mo><mrow id="S2.SS1.p1.20.m20.2.3.3.2" xref="S2.SS1.p1.20.m20.2.3.3.1.cmml"><mo stretchy="false" id="S2.SS1.p1.20.m20.2.3.3.2.1" xref="S2.SS1.p1.20.m20.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS1.p1.20.m20.1.1" xref="S2.SS1.p1.20.m20.1.1.cmml">⋅</mo><mo rspace="0em" id="S2.SS1.p1.20.m20.2.3.3.2.2" xref="S2.SS1.p1.20.m20.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S2.SS1.p1.20.m20.2.2" xref="S2.SS1.p1.20.m20.2.2.cmml">⋅</mo><mo stretchy="false" id="S2.SS1.p1.20.m20.2.3.3.2.3" xref="S2.SS1.p1.20.m20.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.20.m20.2b"><apply id="S2.SS1.p1.20.m20.2.3.cmml" xref="S2.SS1.p1.20.m20.2.3"><times id="S2.SS1.p1.20.m20.2.3.1.cmml" xref="S2.SS1.p1.20.m20.2.3.1"></times><ci id="S2.SS1.p1.20.m20.2.3.2.cmml" xref="S2.SS1.p1.20.m20.2.3.2">ℓ</ci><interval closure="open" id="S2.SS1.p1.20.m20.2.3.3.1.cmml" xref="S2.SS1.p1.20.m20.2.3.3.2"><ci id="S2.SS1.p1.20.m20.1.1.cmml" xref="S2.SS1.p1.20.m20.1.1">⋅</ci><ci id="S2.SS1.p1.20.m20.2.2.cmml" xref="S2.SS1.p1.20.m20.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.20.m20.2c">\ell(\cdot,\cdot)</annotation></semantics></math> is the sample loss and <math id="S2.SS1.p1.21.m21.2" class="ltx_Math" alttext="f(\mathbf{x};\mathbf{w})" display="inline"><semantics id="S2.SS1.p1.21.m21.2a"><mrow id="S2.SS1.p1.21.m21.2.3" xref="S2.SS1.p1.21.m21.2.3.cmml"><mi id="S2.SS1.p1.21.m21.2.3.2" xref="S2.SS1.p1.21.m21.2.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.21.m21.2.3.1" xref="S2.SS1.p1.21.m21.2.3.1.cmml">​</mo><mrow id="S2.SS1.p1.21.m21.2.3.3.2" xref="S2.SS1.p1.21.m21.2.3.3.1.cmml"><mo stretchy="false" id="S2.SS1.p1.21.m21.2.3.3.2.1" xref="S2.SS1.p1.21.m21.2.3.3.1.cmml">(</mo><mi id="S2.SS1.p1.21.m21.1.1" xref="S2.SS1.p1.21.m21.1.1.cmml">𝐱</mi><mo id="S2.SS1.p1.21.m21.2.3.3.2.2" xref="S2.SS1.p1.21.m21.2.3.3.1.cmml">;</mo><mi id="S2.SS1.p1.21.m21.2.2" xref="S2.SS1.p1.21.m21.2.2.cmml">𝐰</mi><mo stretchy="false" id="S2.SS1.p1.21.m21.2.3.3.2.3" xref="S2.SS1.p1.21.m21.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.21.m21.2b"><apply id="S2.SS1.p1.21.m21.2.3.cmml" xref="S2.SS1.p1.21.m21.2.3"><times id="S2.SS1.p1.21.m21.2.3.1.cmml" xref="S2.SS1.p1.21.m21.2.3.1"></times><ci id="S2.SS1.p1.21.m21.2.3.2.cmml" xref="S2.SS1.p1.21.m21.2.3.2">𝑓</ci><list id="S2.SS1.p1.21.m21.2.3.3.1.cmml" xref="S2.SS1.p1.21.m21.2.3.3.2"><ci id="S2.SS1.p1.21.m21.1.1.cmml" xref="S2.SS1.p1.21.m21.1.1">𝐱</ci><ci id="S2.SS1.p1.21.m21.2.2.cmml" xref="S2.SS1.p1.21.m21.2.2">𝐰</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.21.m21.2c">f(\mathbf{x};\mathbf{w})</annotation></semantics></math> is the prediction result of sample <math id="S2.SS1.p1.22.m22.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S2.SS1.p1.22.m22.1a"><mi id="S2.SS1.p1.22.m22.1.1" xref="S2.SS1.p1.22.m22.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.22.m22.1b"><ci id="S2.SS1.p1.22.m22.1.1.cmml" xref="S2.SS1.p1.22.m22.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.22.m22.1c">\mathbf{x}</annotation></semantics></math> by model <math id="S2.SS1.p1.23.m23.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S2.SS1.p1.23.m23.1a"><mi id="S2.SS1.p1.23.m23.1.1" xref="S2.SS1.p1.23.m23.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.23.m23.1b"><ci id="S2.SS1.p1.23.m23.1.1.cmml" xref="S2.SS1.p1.23.m23.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.23.m23.1c">\mathbf{w}</annotation></semantics></math>. However, this method slightly improves heterogeneous data because local model <math id="S2.SS1.p1.24.m24.1" class="ltx_Math" alttext="\mathbf{w}_{k}" display="inline"><semantics id="S2.SS1.p1.24.m24.1a"><msub id="S2.SS1.p1.24.m24.1.1" xref="S2.SS1.p1.24.m24.1.1.cmml"><mi id="S2.SS1.p1.24.m24.1.1.2" xref="S2.SS1.p1.24.m24.1.1.2.cmml">𝐰</mi><mi id="S2.SS1.p1.24.m24.1.1.3" xref="S2.SS1.p1.24.m24.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.24.m24.1b"><apply id="S2.SS1.p1.24.m24.1.1.cmml" xref="S2.SS1.p1.24.m24.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.24.m24.1.1.1.cmml" xref="S2.SS1.p1.24.m24.1.1">subscript</csymbol><ci id="S2.SS1.p1.24.m24.1.1.2.cmml" xref="S2.SS1.p1.24.m24.1.1.2">𝐰</ci><ci id="S2.SS1.p1.24.m24.1.1.3.cmml" xref="S2.SS1.p1.24.m24.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.24.m24.1c">\mathbf{w}_{k}</annotation></semantics></math> is prone to overfit the local data <math id="S2.SS1.p1.25.m25.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="S2.SS1.p1.25.m25.1a"><msub id="S2.SS1.p1.25.m25.1.1" xref="S2.SS1.p1.25.m25.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.25.m25.1.1.2" xref="S2.SS1.p1.25.m25.1.1.2.cmml">𝒟</mi><mi id="S2.SS1.p1.25.m25.1.1.3" xref="S2.SS1.p1.25.m25.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.25.m25.1b"><apply id="S2.SS1.p1.25.m25.1.1.cmml" xref="S2.SS1.p1.25.m25.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.25.m25.1.1.1.cmml" xref="S2.SS1.p1.25.m25.1.1">subscript</csymbol><ci id="S2.SS1.p1.25.m25.1.1.2.cmml" xref="S2.SS1.p1.25.m25.1.1.2">𝒟</ci><ci id="S2.SS1.p1.25.m25.1.1.3.cmml" xref="S2.SS1.p1.25.m25.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.25.m25.1c">\mathcal{D}_{k}</annotation></semantics></math>, which results in poor local generalization performance.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>FedAFA Framework</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">FedAFA is based on the following intuitions. First, the global model of FL is usually more robust than local models because it obtains the information from each client, although it is in an indirect manner. Second, it has been empirically shown that the feature extractor in a neural network is less affected by the data distribution compared with its classifier <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. It means that the features extracted by the global model are still of high quality despite the negative influence of data heterogeneity and long-tail distribution. Based on the above observations, we propose to utilize the feature extractor of the global model to transfer information from the local majority classes to the local minority classes in the feature space.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.4" class="ltx_p">We randomly select pairs of classes as the <span id="S2.SS2.p2.4.1" class="ltx_text ltx_font_italic">source majority class</span> <math id="S2.SS2.p2.1.m1.1" class="ltx_Math" alttext="y_{s}" display="inline"><semantics id="S2.SS2.p2.1.m1.1a"><msub id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml"><mi id="S2.SS2.p2.1.m1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.2.cmml">y</mi><mi id="S2.SS2.p2.1.m1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><apply id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p2.1.m1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.1.2">𝑦</ci><ci id="S2.SS2.p2.1.m1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">y_{s}</annotation></semantics></math> and the <span id="S2.SS2.p2.4.2" class="ltx_text ltx_font_italic">target minority class</span> <math id="S2.SS2.p2.2.m2.1" class="ltx_Math" alttext="y_{t}" display="inline"><semantics id="S2.SS2.p2.2.m2.1a"><msub id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml"><mi id="S2.SS2.p2.2.m2.1.1.2" xref="S2.SS2.p2.2.m2.1.1.2.cmml">y</mi><mi id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2">𝑦</ci><ci id="S2.SS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">y_{t}</annotation></semantics></math> depending on their corresponding number of samples denoted as <math id="S2.SS2.p2.3.m3.1" class="ltx_Math" alttext="n_{s}" display="inline"><semantics id="S2.SS2.p2.3.m3.1a"><msub id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml"><mi id="S2.SS2.p2.3.m3.1.1.2" xref="S2.SS2.p2.3.m3.1.1.2.cmml">n</mi><mi id="S2.SS2.p2.3.m3.1.1.3" xref="S2.SS2.p2.3.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><apply id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p2.3.m3.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2">𝑛</ci><ci id="S2.SS2.p2.3.m3.1.1.3.cmml" xref="S2.SS2.p2.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">n_{s}</annotation></semantics></math> and <math id="S2.SS2.p2.4.m4.1" class="ltx_Math" alttext="n_{t}" display="inline"><semantics id="S2.SS2.p2.4.m4.1a"><msub id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml"><mi id="S2.SS2.p2.4.m4.1.1.2" xref="S2.SS2.p2.4.m4.1.1.2.cmml">n</mi><mi id="S2.SS2.p2.4.m4.1.1.3" xref="S2.SS2.p2.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><apply id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m4.1.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.p2.4.m4.1.1.2.cmml" xref="S2.SS2.p2.4.m4.1.1.2">𝑛</ci><ci id="S2.SS2.p2.4.m4.1.1.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">n_{t}</annotation></semantics></math>. We use the idea of adversarial samples <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> to generate the features of the target minority class by adding specific perturbations to the features of source majority class samples. The perturbations are obtained from the gradients of the loss of predicting the source majority class sample into the target minority class. However, unlike generating adversarial samples, the input and output of FedAFA are in the feature space. After generating a certain number of features to achieve a balanced feature set for all local classes, we combine them with the original local samples with class-balanced sampling to train the local personalized model. Thus, the PFL model of FedAFA is constructed by the feature extractor of the global model and the personalized classifier trained on the rebalanced feature set, which is illustrated in Figure <a href="#S2.F1" title="Figure 1 ‣ 2.2 FedAFA Framework ‣ 2 Proposed Method ‣ Personalized Federated Learning on Long-Tailed Data via Adversarial Feature Augmentation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="S2.F1" class="ltx_figure"><img src="/html/2303.15168/assets/x1.png" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="242" height="139" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F1.2.1.1" class="ltx_text ltx_font_bold">Fig. 1</span>: </span>An overview of personalized training of proposed FedAFA.</figcaption>
</figure>
<div id="S2.SS2.p3" class="ltx_para">
<p id="S2.SS2.p3.10" class="ltx_p">In order to explain FedAFA with better notations, we split the model into two parts: a feature extractor <math id="S2.SS2.p3.1.m1.1" class="ltx_Math" alttext="g" display="inline"><semantics id="S2.SS2.p3.1.m1.1a"><mi id="S2.SS2.p3.1.m1.1.1" xref="S2.SS2.p3.1.m1.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.1b"><ci id="S2.SS2.p3.1.m1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.1c">g</annotation></semantics></math> parameterized by <math id="S2.SS2.p3.2.m2.1" class="ltx_Math" alttext="\mathbf{u}" display="inline"><semantics id="S2.SS2.p3.2.m2.1a"><mi id="S2.SS2.p3.2.m2.1.1" xref="S2.SS2.p3.2.m2.1.1.cmml">𝐮</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.2.m2.1b"><ci id="S2.SS2.p3.2.m2.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1">𝐮</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.2.m2.1c">\mathbf{u}</annotation></semantics></math> and a classifier <math id="S2.SS2.p3.3.m3.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S2.SS2.p3.3.m3.1a"><mi id="S2.SS2.p3.3.m3.1.1" xref="S2.SS2.p3.3.m3.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.3.m3.1b"><ci id="S2.SS2.p3.3.m3.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.3.m3.1c">f</annotation></semantics></math> parameterized by <math id="S2.SS2.p3.4.m4.1" class="ltx_Math" alttext="\mathbf{v}" display="inline"><semantics id="S2.SS2.p3.4.m4.1a"><mi id="S2.SS2.p3.4.m4.1.1" xref="S2.SS2.p3.4.m4.1.1.cmml">𝐯</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.4.m4.1b"><ci id="S2.SS2.p3.4.m4.1.1.cmml" xref="S2.SS2.p3.4.m4.1.1">𝐯</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.4.m4.1c">\mathbf{v}</annotation></semantics></math>. Thus, the features of a sample <math id="S2.SS2.p3.5.m5.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S2.SS2.p3.5.m5.1a"><mi id="S2.SS2.p3.5.m5.1.1" xref="S2.SS2.p3.5.m5.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.5.m5.1b"><ci id="S2.SS2.p3.5.m5.1.1.cmml" xref="S2.SS2.p3.5.m5.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.5.m5.1c">\mathbf{x}</annotation></semantics></math> is generated by <math id="S2.SS2.p3.6.m6.2" class="ltx_Math" alttext="\mathbf{h}=g(\mathbf{x};\mathbf{u})" display="inline"><semantics id="S2.SS2.p3.6.m6.2a"><mrow id="S2.SS2.p3.6.m6.2.3" xref="S2.SS2.p3.6.m6.2.3.cmml"><mi id="S2.SS2.p3.6.m6.2.3.2" xref="S2.SS2.p3.6.m6.2.3.2.cmml">𝐡</mi><mo id="S2.SS2.p3.6.m6.2.3.1" xref="S2.SS2.p3.6.m6.2.3.1.cmml">=</mo><mrow id="S2.SS2.p3.6.m6.2.3.3" xref="S2.SS2.p3.6.m6.2.3.3.cmml"><mi id="S2.SS2.p3.6.m6.2.3.3.2" xref="S2.SS2.p3.6.m6.2.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p3.6.m6.2.3.3.1" xref="S2.SS2.p3.6.m6.2.3.3.1.cmml">​</mo><mrow id="S2.SS2.p3.6.m6.2.3.3.3.2" xref="S2.SS2.p3.6.m6.2.3.3.3.1.cmml"><mo stretchy="false" id="S2.SS2.p3.6.m6.2.3.3.3.2.1" xref="S2.SS2.p3.6.m6.2.3.3.3.1.cmml">(</mo><mi id="S2.SS2.p3.6.m6.1.1" xref="S2.SS2.p3.6.m6.1.1.cmml">𝐱</mi><mo id="S2.SS2.p3.6.m6.2.3.3.3.2.2" xref="S2.SS2.p3.6.m6.2.3.3.3.1.cmml">;</mo><mi id="S2.SS2.p3.6.m6.2.2" xref="S2.SS2.p3.6.m6.2.2.cmml">𝐮</mi><mo stretchy="false" id="S2.SS2.p3.6.m6.2.3.3.3.2.3" xref="S2.SS2.p3.6.m6.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.6.m6.2b"><apply id="S2.SS2.p3.6.m6.2.3.cmml" xref="S2.SS2.p3.6.m6.2.3"><eq id="S2.SS2.p3.6.m6.2.3.1.cmml" xref="S2.SS2.p3.6.m6.2.3.1"></eq><ci id="S2.SS2.p3.6.m6.2.3.2.cmml" xref="S2.SS2.p3.6.m6.2.3.2">𝐡</ci><apply id="S2.SS2.p3.6.m6.2.3.3.cmml" xref="S2.SS2.p3.6.m6.2.3.3"><times id="S2.SS2.p3.6.m6.2.3.3.1.cmml" xref="S2.SS2.p3.6.m6.2.3.3.1"></times><ci id="S2.SS2.p3.6.m6.2.3.3.2.cmml" xref="S2.SS2.p3.6.m6.2.3.3.2">𝑔</ci><list id="S2.SS2.p3.6.m6.2.3.3.3.1.cmml" xref="S2.SS2.p3.6.m6.2.3.3.3.2"><ci id="S2.SS2.p3.6.m6.1.1.cmml" xref="S2.SS2.p3.6.m6.1.1">𝐱</ci><ci id="S2.SS2.p3.6.m6.2.2.cmml" xref="S2.SS2.p3.6.m6.2.2">𝐮</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.6.m6.2c">\mathbf{h}=g(\mathbf{x};\mathbf{u})</annotation></semantics></math>, and the prediction result is given by <math id="S2.SS2.p3.7.m7.2" class="ltx_Math" alttext="f(\mathbf{h};\mathbf{v})" display="inline"><semantics id="S2.SS2.p3.7.m7.2a"><mrow id="S2.SS2.p3.7.m7.2.3" xref="S2.SS2.p3.7.m7.2.3.cmml"><mi id="S2.SS2.p3.7.m7.2.3.2" xref="S2.SS2.p3.7.m7.2.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p3.7.m7.2.3.1" xref="S2.SS2.p3.7.m7.2.3.1.cmml">​</mo><mrow id="S2.SS2.p3.7.m7.2.3.3.2" xref="S2.SS2.p3.7.m7.2.3.3.1.cmml"><mo stretchy="false" id="S2.SS2.p3.7.m7.2.3.3.2.1" xref="S2.SS2.p3.7.m7.2.3.3.1.cmml">(</mo><mi id="S2.SS2.p3.7.m7.1.1" xref="S2.SS2.p3.7.m7.1.1.cmml">𝐡</mi><mo id="S2.SS2.p3.7.m7.2.3.3.2.2" xref="S2.SS2.p3.7.m7.2.3.3.1.cmml">;</mo><mi id="S2.SS2.p3.7.m7.2.2" xref="S2.SS2.p3.7.m7.2.2.cmml">𝐯</mi><mo stretchy="false" id="S2.SS2.p3.7.m7.2.3.3.2.3" xref="S2.SS2.p3.7.m7.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.7.m7.2b"><apply id="S2.SS2.p3.7.m7.2.3.cmml" xref="S2.SS2.p3.7.m7.2.3"><times id="S2.SS2.p3.7.m7.2.3.1.cmml" xref="S2.SS2.p3.7.m7.2.3.1"></times><ci id="S2.SS2.p3.7.m7.2.3.2.cmml" xref="S2.SS2.p3.7.m7.2.3.2">𝑓</ci><list id="S2.SS2.p3.7.m7.2.3.3.1.cmml" xref="S2.SS2.p3.7.m7.2.3.3.2"><ci id="S2.SS2.p3.7.m7.1.1.cmml" xref="S2.SS2.p3.7.m7.1.1">𝐡</ci><ci id="S2.SS2.p3.7.m7.2.2.cmml" xref="S2.SS2.p3.7.m7.2.2">𝐯</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.7.m7.2c">f(\mathbf{h};\mathbf{v})</annotation></semantics></math>. In FedAFA, client <math id="S2.SS2.p3.8.m8.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS2.p3.8.m8.1a"><mi id="S2.SS2.p3.8.m8.1.1" xref="S2.SS2.p3.8.m8.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.8.m8.1b"><ci id="S2.SS2.p3.8.m8.1.1.cmml" xref="S2.SS2.p3.8.m8.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.8.m8.1c">k</annotation></semantics></math> uses the feature extractor of the global model <math id="S2.SS2.p3.9.m9.1" class="ltx_Math" alttext="\mathbf{u}" display="inline"><semantics id="S2.SS2.p3.9.m9.1a"><mi id="S2.SS2.p3.9.m9.1.1" xref="S2.SS2.p3.9.m9.1.1.cmml">𝐮</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.9.m9.1b"><ci id="S2.SS2.p3.9.m9.1.1.cmml" xref="S2.SS2.p3.9.m9.1.1">𝐮</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.9.m9.1c">\mathbf{u}</annotation></semantics></math> and has its own personalized classifier with parameters <math id="S2.SS2.p3.10.m10.1" class="ltx_Math" alttext="\mathbf{\mathbf{v}}_{k}" display="inline"><semantics id="S2.SS2.p3.10.m10.1a"><msub id="S2.SS2.p3.10.m10.1.1" xref="S2.SS2.p3.10.m10.1.1.cmml"><mi id="S2.SS2.p3.10.m10.1.1.2" xref="S2.SS2.p3.10.m10.1.1.2.cmml">𝐯</mi><mi id="S2.SS2.p3.10.m10.1.1.3" xref="S2.SS2.p3.10.m10.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.10.m10.1b"><apply id="S2.SS2.p3.10.m10.1.1.cmml" xref="S2.SS2.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.10.m10.1.1.1.cmml" xref="S2.SS2.p3.10.m10.1.1">subscript</csymbol><ci id="S2.SS2.p3.10.m10.1.1.2.cmml" xref="S2.SS2.p3.10.m10.1.1.2">𝐯</ci><ci id="S2.SS2.p3.10.m10.1.1.3.cmml" xref="S2.SS2.p3.10.m10.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.10.m10.1c">\mathbf{\mathbf{v}}_{k}</annotation></semantics></math>. Next, two major steps in FedAFA, i.e., local feature augmentation and personalized model optimization, are described in detail.</p>
</div>
<section id="S2.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.1 </span>Local Feature Augmentation</h4>

<div id="S2.SS2.SSS1.p1" class="ltx_para">
<p id="S2.SS2.SSS1.p1.10" class="ltx_p">First, we introduce how to adversarially generate features of the target minority class by utilizing the information of the source majority class. Given a target minority class <math id="S2.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{y}_{t}" display="inline"><semantics id="S2.SS2.SSS1.p1.1.m1.1a"><msub id="S2.SS2.SSS1.p1.1.m1.1.1" xref="S2.SS2.SSS1.p1.1.m1.1.1.cmml"><mi id="S2.SS2.SSS1.p1.1.m1.1.1.2" xref="S2.SS2.SSS1.p1.1.m1.1.1.2.cmml">𝐲</mi><mi id="S2.SS2.SSS1.p1.1.m1.1.1.3" xref="S2.SS2.SSS1.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.1.m1.1b"><apply id="S2.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.1.m1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1.2">𝐲</ci><ci id="S2.SS2.SSS1.p1.1.m1.1.1.3.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.1.m1.1c">\mathbf{y}_{t}</annotation></semantics></math>, the probability <math id="S2.SS2.SSS1.p1.2.m2.1" class="ltx_Math" alttext="p(\mathbf{y}_{s}|\mathbf{y}_{t})" display="inline"><semantics id="S2.SS2.SSS1.p1.2.m2.1a"><mrow id="S2.SS2.SSS1.p1.2.m2.1.1" xref="S2.SS2.SSS1.p1.2.m2.1.1.cmml"><mi id="S2.SS2.SSS1.p1.2.m2.1.1.3" xref="S2.SS2.SSS1.p1.2.m2.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p1.2.m2.1.1.2" xref="S2.SS2.SSS1.p1.2.m2.1.1.2.cmml">​</mo><mrow id="S2.SS2.SSS1.p1.2.m2.1.1.1.1" xref="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p1.2.m2.1.1.1.1.2" xref="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1" xref="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.cmml"><msub id="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.2" xref="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.2.cmml"><mi id="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.2.2" xref="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.2.2.cmml">𝐲</mi><mi id="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.2.3" xref="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.1" xref="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.1.cmml">|</mo><msub id="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.3" xref="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.3.cmml"><mi id="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.3.2" xref="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.3.2.cmml">𝐲</mi><mi id="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.3.3" xref="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S2.SS2.SSS1.p1.2.m2.1.1.1.1.3" xref="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.2.m2.1b"><apply id="S2.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1"><times id="S2.SS2.SSS1.p1.2.m2.1.1.2.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.2"></times><ci id="S2.SS2.SSS1.p1.2.m2.1.1.3.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.3">𝑝</ci><apply id="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.1">conditional</csymbol><apply id="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.2.1.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.2.2.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.2.2">𝐲</ci><ci id="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.2.3.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.3.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.3.1.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.3.2.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.3.2">𝐲</ci><ci id="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.3.3.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.2.m2.1c">p(\mathbf{y}_{s}|\mathbf{y}_{t})</annotation></semantics></math> of selecting the source majority class <math id="S2.SS2.SSS1.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{y}_{s}" display="inline"><semantics id="S2.SS2.SSS1.p1.3.m3.1a"><msub id="S2.SS2.SSS1.p1.3.m3.1.1" xref="S2.SS2.SSS1.p1.3.m3.1.1.cmml"><mi id="S2.SS2.SSS1.p1.3.m3.1.1.2" xref="S2.SS2.SSS1.p1.3.m3.1.1.2.cmml">𝐲</mi><mi id="S2.SS2.SSS1.p1.3.m3.1.1.3" xref="S2.SS2.SSS1.p1.3.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.3.m3.1b"><apply id="S2.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S2.SS2.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.3.m3.1.1.1.cmml" xref="S2.SS2.SSS1.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.3.m3.1.1.2.cmml" xref="S2.SS2.SSS1.p1.3.m3.1.1.2">𝐲</ci><ci id="S2.SS2.SSS1.p1.3.m3.1.1.3.cmml" xref="S2.SS2.SSS1.p1.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.3.m3.1c">\mathbf{y}_{s}</annotation></semantics></math> is proportional to <math id="S2.SS2.SSS1.p1.4.m4.1" class="ltx_Math" alttext="Bernoulli(\frac{n_{s}-n_{t}}{n_{k}})" display="inline"><semantics id="S2.SS2.SSS1.p1.4.m4.1a"><mrow id="S2.SS2.SSS1.p1.4.m4.1.2" xref="S2.SS2.SSS1.p1.4.m4.1.2.cmml"><mi id="S2.SS2.SSS1.p1.4.m4.1.2.2" xref="S2.SS2.SSS1.p1.4.m4.1.2.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p1.4.m4.1.2.1" xref="S2.SS2.SSS1.p1.4.m4.1.2.1.cmml">​</mo><mi id="S2.SS2.SSS1.p1.4.m4.1.2.3" xref="S2.SS2.SSS1.p1.4.m4.1.2.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p1.4.m4.1.2.1a" xref="S2.SS2.SSS1.p1.4.m4.1.2.1.cmml">​</mo><mi id="S2.SS2.SSS1.p1.4.m4.1.2.4" xref="S2.SS2.SSS1.p1.4.m4.1.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p1.4.m4.1.2.1b" xref="S2.SS2.SSS1.p1.4.m4.1.2.1.cmml">​</mo><mi id="S2.SS2.SSS1.p1.4.m4.1.2.5" xref="S2.SS2.SSS1.p1.4.m4.1.2.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p1.4.m4.1.2.1c" xref="S2.SS2.SSS1.p1.4.m4.1.2.1.cmml">​</mo><mi id="S2.SS2.SSS1.p1.4.m4.1.2.6" xref="S2.SS2.SSS1.p1.4.m4.1.2.6.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p1.4.m4.1.2.1d" xref="S2.SS2.SSS1.p1.4.m4.1.2.1.cmml">​</mo><mi id="S2.SS2.SSS1.p1.4.m4.1.2.7" xref="S2.SS2.SSS1.p1.4.m4.1.2.7.cmml">u</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p1.4.m4.1.2.1e" xref="S2.SS2.SSS1.p1.4.m4.1.2.1.cmml">​</mo><mi id="S2.SS2.SSS1.p1.4.m4.1.2.8" xref="S2.SS2.SSS1.p1.4.m4.1.2.8.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p1.4.m4.1.2.1f" xref="S2.SS2.SSS1.p1.4.m4.1.2.1.cmml">​</mo><mi id="S2.SS2.SSS1.p1.4.m4.1.2.9" xref="S2.SS2.SSS1.p1.4.m4.1.2.9.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p1.4.m4.1.2.1g" xref="S2.SS2.SSS1.p1.4.m4.1.2.1.cmml">​</mo><mi id="S2.SS2.SSS1.p1.4.m4.1.2.10" xref="S2.SS2.SSS1.p1.4.m4.1.2.10.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p1.4.m4.1.2.1h" xref="S2.SS2.SSS1.p1.4.m4.1.2.1.cmml">​</mo><mrow id="S2.SS2.SSS1.p1.4.m4.1.2.11.2" xref="S2.SS2.SSS1.p1.4.m4.1.1.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p1.4.m4.1.2.11.2.1" xref="S2.SS2.SSS1.p1.4.m4.1.1.cmml">(</mo><mfrac id="S2.SS2.SSS1.p1.4.m4.1.1" xref="S2.SS2.SSS1.p1.4.m4.1.1.cmml"><mrow id="S2.SS2.SSS1.p1.4.m4.1.1.2" xref="S2.SS2.SSS1.p1.4.m4.1.1.2.cmml"><msub id="S2.SS2.SSS1.p1.4.m4.1.1.2.2" xref="S2.SS2.SSS1.p1.4.m4.1.1.2.2.cmml"><mi id="S2.SS2.SSS1.p1.4.m4.1.1.2.2.2" xref="S2.SS2.SSS1.p1.4.m4.1.1.2.2.2.cmml">n</mi><mi id="S2.SS2.SSS1.p1.4.m4.1.1.2.2.3" xref="S2.SS2.SSS1.p1.4.m4.1.1.2.2.3.cmml">s</mi></msub><mo id="S2.SS2.SSS1.p1.4.m4.1.1.2.1" xref="S2.SS2.SSS1.p1.4.m4.1.1.2.1.cmml">−</mo><msub id="S2.SS2.SSS1.p1.4.m4.1.1.2.3" xref="S2.SS2.SSS1.p1.4.m4.1.1.2.3.cmml"><mi id="S2.SS2.SSS1.p1.4.m4.1.1.2.3.2" xref="S2.SS2.SSS1.p1.4.m4.1.1.2.3.2.cmml">n</mi><mi id="S2.SS2.SSS1.p1.4.m4.1.1.2.3.3" xref="S2.SS2.SSS1.p1.4.m4.1.1.2.3.3.cmml">t</mi></msub></mrow><msub id="S2.SS2.SSS1.p1.4.m4.1.1.3" xref="S2.SS2.SSS1.p1.4.m4.1.1.3.cmml"><mi id="S2.SS2.SSS1.p1.4.m4.1.1.3.2" xref="S2.SS2.SSS1.p1.4.m4.1.1.3.2.cmml">n</mi><mi id="S2.SS2.SSS1.p1.4.m4.1.1.3.3" xref="S2.SS2.SSS1.p1.4.m4.1.1.3.3.cmml">k</mi></msub></mfrac><mo stretchy="false" id="S2.SS2.SSS1.p1.4.m4.1.2.11.2.2" xref="S2.SS2.SSS1.p1.4.m4.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.4.m4.1b"><apply id="S2.SS2.SSS1.p1.4.m4.1.2.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.2"><times id="S2.SS2.SSS1.p1.4.m4.1.2.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.2.1"></times><ci id="S2.SS2.SSS1.p1.4.m4.1.2.2.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.2.2">𝐵</ci><ci id="S2.SS2.SSS1.p1.4.m4.1.2.3.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.2.3">𝑒</ci><ci id="S2.SS2.SSS1.p1.4.m4.1.2.4.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.2.4">𝑟</ci><ci id="S2.SS2.SSS1.p1.4.m4.1.2.5.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.2.5">𝑛</ci><ci id="S2.SS2.SSS1.p1.4.m4.1.2.6.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.2.6">𝑜</ci><ci id="S2.SS2.SSS1.p1.4.m4.1.2.7.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.2.7">𝑢</ci><ci id="S2.SS2.SSS1.p1.4.m4.1.2.8.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.2.8">𝑙</ci><ci id="S2.SS2.SSS1.p1.4.m4.1.2.9.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.2.9">𝑙</ci><ci id="S2.SS2.SSS1.p1.4.m4.1.2.10.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.2.10">𝑖</ci><apply id="S2.SS2.SSS1.p1.4.m4.1.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.2.11.2"><divide id="S2.SS2.SSS1.p1.4.m4.1.1.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.2.11.2"></divide><apply id="S2.SS2.SSS1.p1.4.m4.1.1.2.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.1.2"><minus id="S2.SS2.SSS1.p1.4.m4.1.1.2.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.1.2.1"></minus><apply id="S2.SS2.SSS1.p1.4.m4.1.1.2.2.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.4.m4.1.1.2.2.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.1.2.2">subscript</csymbol><ci id="S2.SS2.SSS1.p1.4.m4.1.1.2.2.2.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.1.2.2.2">𝑛</ci><ci id="S2.SS2.SSS1.p1.4.m4.1.1.2.2.3.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.1.2.2.3">𝑠</ci></apply><apply id="S2.SS2.SSS1.p1.4.m4.1.1.2.3.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.4.m4.1.1.2.3.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.1.2.3">subscript</csymbol><ci id="S2.SS2.SSS1.p1.4.m4.1.1.2.3.2.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.1.2.3.2">𝑛</ci><ci id="S2.SS2.SSS1.p1.4.m4.1.1.2.3.3.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S2.SS2.SSS1.p1.4.m4.1.1.3.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.4.m4.1.1.3.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.1.3">subscript</csymbol><ci id="S2.SS2.SSS1.p1.4.m4.1.1.3.2.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.1.3.2">𝑛</ci><ci id="S2.SS2.SSS1.p1.4.m4.1.1.3.3.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.1.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.4.m4.1c">Bernoulli(\frac{n_{s}-n_{t}}{n_{k}})</annotation></semantics></math>. Once a source majority class <math id="S2.SS2.SSS1.p1.5.m5.1" class="ltx_Math" alttext="\mathbf{y}_{s}" display="inline"><semantics id="S2.SS2.SSS1.p1.5.m5.1a"><msub id="S2.SS2.SSS1.p1.5.m5.1.1" xref="S2.SS2.SSS1.p1.5.m5.1.1.cmml"><mi id="S2.SS2.SSS1.p1.5.m5.1.1.2" xref="S2.SS2.SSS1.p1.5.m5.1.1.2.cmml">𝐲</mi><mi id="S2.SS2.SSS1.p1.5.m5.1.1.3" xref="S2.SS2.SSS1.p1.5.m5.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.5.m5.1b"><apply id="S2.SS2.SSS1.p1.5.m5.1.1.cmml" xref="S2.SS2.SSS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.5.m5.1.1.1.cmml" xref="S2.SS2.SSS1.p1.5.m5.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.5.m5.1.1.2.cmml" xref="S2.SS2.SSS1.p1.5.m5.1.1.2">𝐲</ci><ci id="S2.SS2.SSS1.p1.5.m5.1.1.3.cmml" xref="S2.SS2.SSS1.p1.5.m5.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.5.m5.1c">\mathbf{y}_{s}</annotation></semantics></math> is determined, a sample <math id="S2.SS2.SSS1.p1.6.m6.2" class="ltx_Math" alttext="(\mathbf{x}_{s},\mathbf{y}_{s})\in\mathcal{D}_{k}" display="inline"><semantics id="S2.SS2.SSS1.p1.6.m6.2a"><mrow id="S2.SS2.SSS1.p1.6.m6.2.2" xref="S2.SS2.SSS1.p1.6.m6.2.2.cmml"><mrow id="S2.SS2.SSS1.p1.6.m6.2.2.2.2" xref="S2.SS2.SSS1.p1.6.m6.2.2.2.3.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p1.6.m6.2.2.2.2.3" xref="S2.SS2.SSS1.p1.6.m6.2.2.2.3.cmml">(</mo><msub id="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1" xref="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.cmml"><mi id="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.2" xref="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.3" xref="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.3.cmml">s</mi></msub><mo id="S2.SS2.SSS1.p1.6.m6.2.2.2.2.4" xref="S2.SS2.SSS1.p1.6.m6.2.2.2.3.cmml">,</mo><msub id="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2" xref="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.cmml"><mi id="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.2" xref="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.2.cmml">𝐲</mi><mi id="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.3" xref="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.3.cmml">s</mi></msub><mo stretchy="false" id="S2.SS2.SSS1.p1.6.m6.2.2.2.2.5" xref="S2.SS2.SSS1.p1.6.m6.2.2.2.3.cmml">)</mo></mrow><mo id="S2.SS2.SSS1.p1.6.m6.2.2.3" xref="S2.SS2.SSS1.p1.6.m6.2.2.3.cmml">∈</mo><msub id="S2.SS2.SSS1.p1.6.m6.2.2.4" xref="S2.SS2.SSS1.p1.6.m6.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS1.p1.6.m6.2.2.4.2" xref="S2.SS2.SSS1.p1.6.m6.2.2.4.2.cmml">𝒟</mi><mi id="S2.SS2.SSS1.p1.6.m6.2.2.4.3" xref="S2.SS2.SSS1.p1.6.m6.2.2.4.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.6.m6.2b"><apply id="S2.SS2.SSS1.p1.6.m6.2.2.cmml" xref="S2.SS2.SSS1.p1.6.m6.2.2"><in id="S2.SS2.SSS1.p1.6.m6.2.2.3.cmml" xref="S2.SS2.SSS1.p1.6.m6.2.2.3"></in><interval closure="open" id="S2.SS2.SSS1.p1.6.m6.2.2.2.3.cmml" xref="S2.SS2.SSS1.p1.6.m6.2.2.2.2"><apply id="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.2">𝐱</ci><ci id="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.3.cmml" xref="S2.SS2.SSS1.p1.6.m6.1.1.1.1.1.3">𝑠</ci></apply><apply id="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.cmml" xref="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.1.cmml" xref="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2">subscript</csymbol><ci id="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.2.cmml" xref="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.2">𝐲</ci><ci id="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.3.cmml" xref="S2.SS2.SSS1.p1.6.m6.2.2.2.2.2.3">𝑠</ci></apply></interval><apply id="S2.SS2.SSS1.p1.6.m6.2.2.4.cmml" xref="S2.SS2.SSS1.p1.6.m6.2.2.4"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.6.m6.2.2.4.1.cmml" xref="S2.SS2.SSS1.p1.6.m6.2.2.4">subscript</csymbol><ci id="S2.SS2.SSS1.p1.6.m6.2.2.4.2.cmml" xref="S2.SS2.SSS1.p1.6.m6.2.2.4.2">𝒟</ci><ci id="S2.SS2.SSS1.p1.6.m6.2.2.4.3.cmml" xref="S2.SS2.SSS1.p1.6.m6.2.2.4.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.6.m6.2c">(\mathbf{x}_{s},\mathbf{y}_{s})\in\mathcal{D}_{k}</annotation></semantics></math> is randomly selected. Then, the sample is fed into the feature extractor of the global model to obtain its original features <math id="S2.SS2.SSS1.p1.7.m7.2" class="ltx_Math" alttext="\mathbf{h}_{s}=g(\mathbf{x}_{s};\mathbf{u})" display="inline"><semantics id="S2.SS2.SSS1.p1.7.m7.2a"><mrow id="S2.SS2.SSS1.p1.7.m7.2.2" xref="S2.SS2.SSS1.p1.7.m7.2.2.cmml"><msub id="S2.SS2.SSS1.p1.7.m7.2.2.3" xref="S2.SS2.SSS1.p1.7.m7.2.2.3.cmml"><mi id="S2.SS2.SSS1.p1.7.m7.2.2.3.2" xref="S2.SS2.SSS1.p1.7.m7.2.2.3.2.cmml">𝐡</mi><mi id="S2.SS2.SSS1.p1.7.m7.2.2.3.3" xref="S2.SS2.SSS1.p1.7.m7.2.2.3.3.cmml">s</mi></msub><mo id="S2.SS2.SSS1.p1.7.m7.2.2.2" xref="S2.SS2.SSS1.p1.7.m7.2.2.2.cmml">=</mo><mrow id="S2.SS2.SSS1.p1.7.m7.2.2.1" xref="S2.SS2.SSS1.p1.7.m7.2.2.1.cmml"><mi id="S2.SS2.SSS1.p1.7.m7.2.2.1.3" xref="S2.SS2.SSS1.p1.7.m7.2.2.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p1.7.m7.2.2.1.2" xref="S2.SS2.SSS1.p1.7.m7.2.2.1.2.cmml">​</mo><mrow id="S2.SS2.SSS1.p1.7.m7.2.2.1.1.1" xref="S2.SS2.SSS1.p1.7.m7.2.2.1.1.2.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p1.7.m7.2.2.1.1.1.2" xref="S2.SS2.SSS1.p1.7.m7.2.2.1.1.2.cmml">(</mo><msub id="S2.SS2.SSS1.p1.7.m7.2.2.1.1.1.1" xref="S2.SS2.SSS1.p1.7.m7.2.2.1.1.1.1.cmml"><mi id="S2.SS2.SSS1.p1.7.m7.2.2.1.1.1.1.2" xref="S2.SS2.SSS1.p1.7.m7.2.2.1.1.1.1.2.cmml">𝐱</mi><mi id="S2.SS2.SSS1.p1.7.m7.2.2.1.1.1.1.3" xref="S2.SS2.SSS1.p1.7.m7.2.2.1.1.1.1.3.cmml">s</mi></msub><mo id="S2.SS2.SSS1.p1.7.m7.2.2.1.1.1.3" xref="S2.SS2.SSS1.p1.7.m7.2.2.1.1.2.cmml">;</mo><mi id="S2.SS2.SSS1.p1.7.m7.1.1" xref="S2.SS2.SSS1.p1.7.m7.1.1.cmml">𝐮</mi><mo stretchy="false" id="S2.SS2.SSS1.p1.7.m7.2.2.1.1.1.4" xref="S2.SS2.SSS1.p1.7.m7.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.7.m7.2b"><apply id="S2.SS2.SSS1.p1.7.m7.2.2.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.2"><eq id="S2.SS2.SSS1.p1.7.m7.2.2.2.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.2.2"></eq><apply id="S2.SS2.SSS1.p1.7.m7.2.2.3.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.7.m7.2.2.3.1.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.2.3">subscript</csymbol><ci id="S2.SS2.SSS1.p1.7.m7.2.2.3.2.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.2.3.2">𝐡</ci><ci id="S2.SS2.SSS1.p1.7.m7.2.2.3.3.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.2.3.3">𝑠</ci></apply><apply id="S2.SS2.SSS1.p1.7.m7.2.2.1.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.2.1"><times id="S2.SS2.SSS1.p1.7.m7.2.2.1.2.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.2.1.2"></times><ci id="S2.SS2.SSS1.p1.7.m7.2.2.1.3.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.2.1.3">𝑔</ci><list id="S2.SS2.SSS1.p1.7.m7.2.2.1.1.2.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.2.1.1.1"><apply id="S2.SS2.SSS1.p1.7.m7.2.2.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.7.m7.2.2.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.2.1.1.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.7.m7.2.2.1.1.1.1.2.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.2.1.1.1.1.2">𝐱</ci><ci id="S2.SS2.SSS1.p1.7.m7.2.2.1.1.1.1.3.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.2.1.1.1.1.3">𝑠</ci></apply><ci id="S2.SS2.SSS1.p1.7.m7.1.1.cmml" xref="S2.SS2.SSS1.p1.7.m7.1.1">𝐮</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.7.m7.2c">\mathbf{h}_{s}=g(\mathbf{x}_{s};\mathbf{u})</annotation></semantics></math>. The original features <math id="S2.SS2.SSS1.p1.8.m8.1" class="ltx_Math" alttext="\mathbf{h}_{s}" display="inline"><semantics id="S2.SS2.SSS1.p1.8.m8.1a"><msub id="S2.SS2.SSS1.p1.8.m8.1.1" xref="S2.SS2.SSS1.p1.8.m8.1.1.cmml"><mi id="S2.SS2.SSS1.p1.8.m8.1.1.2" xref="S2.SS2.SSS1.p1.8.m8.1.1.2.cmml">𝐡</mi><mi id="S2.SS2.SSS1.p1.8.m8.1.1.3" xref="S2.SS2.SSS1.p1.8.m8.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.8.m8.1b"><apply id="S2.SS2.SSS1.p1.8.m8.1.1.cmml" xref="S2.SS2.SSS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.8.m8.1.1.1.cmml" xref="S2.SS2.SSS1.p1.8.m8.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.8.m8.1.1.2.cmml" xref="S2.SS2.SSS1.p1.8.m8.1.1.2">𝐡</ci><ci id="S2.SS2.SSS1.p1.8.m8.1.1.3.cmml" xref="S2.SS2.SSS1.p1.8.m8.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.8.m8.1c">\mathbf{h}_{s}</annotation></semantics></math> is going to be transformed into generated features <math id="S2.SS2.SSS1.p1.9.m9.1" class="ltx_Math" alttext="\widehat{\mathbf{h}}_{t}" display="inline"><semantics id="S2.SS2.SSS1.p1.9.m9.1a"><msub id="S2.SS2.SSS1.p1.9.m9.1.1" xref="S2.SS2.SSS1.p1.9.m9.1.1.cmml"><mover accent="true" id="S2.SS2.SSS1.p1.9.m9.1.1.2" xref="S2.SS2.SSS1.p1.9.m9.1.1.2.cmml"><mi id="S2.SS2.SSS1.p1.9.m9.1.1.2.2" xref="S2.SS2.SSS1.p1.9.m9.1.1.2.2.cmml">𝐡</mi><mo id="S2.SS2.SSS1.p1.9.m9.1.1.2.1" xref="S2.SS2.SSS1.p1.9.m9.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS2.SSS1.p1.9.m9.1.1.3" xref="S2.SS2.SSS1.p1.9.m9.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.9.m9.1b"><apply id="S2.SS2.SSS1.p1.9.m9.1.1.cmml" xref="S2.SS2.SSS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.9.m9.1.1.1.cmml" xref="S2.SS2.SSS1.p1.9.m9.1.1">subscript</csymbol><apply id="S2.SS2.SSS1.p1.9.m9.1.1.2.cmml" xref="S2.SS2.SSS1.p1.9.m9.1.1.2"><ci id="S2.SS2.SSS1.p1.9.m9.1.1.2.1.cmml" xref="S2.SS2.SSS1.p1.9.m9.1.1.2.1">^</ci><ci id="S2.SS2.SSS1.p1.9.m9.1.1.2.2.cmml" xref="S2.SS2.SSS1.p1.9.m9.1.1.2.2">𝐡</ci></apply><ci id="S2.SS2.SSS1.p1.9.m9.1.1.3.cmml" xref="S2.SS2.SSS1.p1.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.9.m9.1c">\widehat{\mathbf{h}}_{t}</annotation></semantics></math> in the target class <math id="S2.SS2.SSS1.p1.10.m10.1" class="ltx_Math" alttext="\mathbf{y}_{t}" display="inline"><semantics id="S2.SS2.SSS1.p1.10.m10.1a"><msub id="S2.SS2.SSS1.p1.10.m10.1.1" xref="S2.SS2.SSS1.p1.10.m10.1.1.cmml"><mi id="S2.SS2.SSS1.p1.10.m10.1.1.2" xref="S2.SS2.SSS1.p1.10.m10.1.1.2.cmml">𝐲</mi><mi id="S2.SS2.SSS1.p1.10.m10.1.1.3" xref="S2.SS2.SSS1.p1.10.m10.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.10.m10.1b"><apply id="S2.SS2.SSS1.p1.10.m10.1.1.cmml" xref="S2.SS2.SSS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.10.m10.1.1.1.cmml" xref="S2.SS2.SSS1.p1.10.m10.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.10.m10.1.1.2.cmml" xref="S2.SS2.SSS1.p1.10.m10.1.1.2">𝐲</ci><ci id="S2.SS2.SSS1.p1.10.m10.1.1.3.cmml" xref="S2.SS2.SSS1.p1.10.m10.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.10.m10.1c">\mathbf{y}_{t}</annotation></semantics></math>. The objective of feature transformation is formulated as:</p>
<table id="S4.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E1.m1.2" class="ltx_Math" alttext="\displaystyle\widehat{\mathbf{h}}_{t}=\operatorname*{arg\,min}_{\widehat{\mathbf{h}}_{t}:=\mathbf{h}_{s}+\delta}\ell(\mathbf{y}_{t},f(\widehat{\mathbf{h}}_{t};\mathbf{\mathbf{v}}))," display="inline"><semantics id="S2.E1.m1.2a"><mrow id="S2.E1.m1.2.2.1" xref="S2.E1.m1.2.2.1.1.cmml"><mrow id="S2.E1.m1.2.2.1.1" xref="S2.E1.m1.2.2.1.1.cmml"><msub id="S2.E1.m1.2.2.1.1.4" xref="S2.E1.m1.2.2.1.1.4.cmml"><mover accent="true" id="S2.E1.m1.2.2.1.1.4.2" xref="S2.E1.m1.2.2.1.1.4.2.cmml"><mi id="S2.E1.m1.2.2.1.1.4.2.2" xref="S2.E1.m1.2.2.1.1.4.2.2.cmml">𝐡</mi><mo id="S2.E1.m1.2.2.1.1.4.2.1" xref="S2.E1.m1.2.2.1.1.4.2.1.cmml">^</mo></mover><mi id="S2.E1.m1.2.2.1.1.4.3" xref="S2.E1.m1.2.2.1.1.4.3.cmml">t</mi></msub><mo id="S2.E1.m1.2.2.1.1.3" xref="S2.E1.m1.2.2.1.1.3.cmml">=</mo><mrow id="S2.E1.m1.2.2.1.1.2" xref="S2.E1.m1.2.2.1.1.2.cmml"><mrow id="S2.E1.m1.2.2.1.1.2.4" xref="S2.E1.m1.2.2.1.1.2.4.cmml"><munder id="S2.E1.m1.2.2.1.1.2.4.1" xref="S2.E1.m1.2.2.1.1.2.4.1.cmml"><mrow id="S2.E1.m1.2.2.1.1.2.4.1.2" xref="S2.E1.m1.2.2.1.1.2.4.1.2.cmml"><mi id="S2.E1.m1.2.2.1.1.2.4.1.2.2" xref="S2.E1.m1.2.2.1.1.2.4.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S2.E1.m1.2.2.1.1.2.4.1.2.1" xref="S2.E1.m1.2.2.1.1.2.4.1.2.1.cmml">​</mo><mi id="S2.E1.m1.2.2.1.1.2.4.1.2.3" xref="S2.E1.m1.2.2.1.1.2.4.1.2.3.cmml">min</mi></mrow><mrow id="S2.E1.m1.2.2.1.1.2.4.1.3" xref="S2.E1.m1.2.2.1.1.2.4.1.3.cmml"><msub id="S2.E1.m1.2.2.1.1.2.4.1.3.2" xref="S2.E1.m1.2.2.1.1.2.4.1.3.2.cmml"><mover accent="true" id="S2.E1.m1.2.2.1.1.2.4.1.3.2.2" xref="S2.E1.m1.2.2.1.1.2.4.1.3.2.2.cmml"><mi id="S2.E1.m1.2.2.1.1.2.4.1.3.2.2.2" xref="S2.E1.m1.2.2.1.1.2.4.1.3.2.2.2.cmml">𝐡</mi><mo id="S2.E1.m1.2.2.1.1.2.4.1.3.2.2.1" xref="S2.E1.m1.2.2.1.1.2.4.1.3.2.2.1.cmml">^</mo></mover><mi id="S2.E1.m1.2.2.1.1.2.4.1.3.2.3" xref="S2.E1.m1.2.2.1.1.2.4.1.3.2.3.cmml">t</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S2.E1.m1.2.2.1.1.2.4.1.3.1" xref="S2.E1.m1.2.2.1.1.2.4.1.3.1.cmml">:=</mo><mrow id="S2.E1.m1.2.2.1.1.2.4.1.3.3" xref="S2.E1.m1.2.2.1.1.2.4.1.3.3.cmml"><msub id="S2.E1.m1.2.2.1.1.2.4.1.3.3.2" xref="S2.E1.m1.2.2.1.1.2.4.1.3.3.2.cmml"><mi id="S2.E1.m1.2.2.1.1.2.4.1.3.3.2.2" xref="S2.E1.m1.2.2.1.1.2.4.1.3.3.2.2.cmml">𝐡</mi><mi id="S2.E1.m1.2.2.1.1.2.4.1.3.3.2.3" xref="S2.E1.m1.2.2.1.1.2.4.1.3.3.2.3.cmml">s</mi></msub><mo id="S2.E1.m1.2.2.1.1.2.4.1.3.3.1" xref="S2.E1.m1.2.2.1.1.2.4.1.3.3.1.cmml">+</mo><mi id="S2.E1.m1.2.2.1.1.2.4.1.3.3.3" xref="S2.E1.m1.2.2.1.1.2.4.1.3.3.3.cmml">δ</mi></mrow></mrow></munder><mo id="S2.E1.m1.2.2.1.1.2.4a" xref="S2.E1.m1.2.2.1.1.2.4.cmml">⁡</mo><mi mathvariant="normal" id="S2.E1.m1.2.2.1.1.2.4.2" xref="S2.E1.m1.2.2.1.1.2.4.2.cmml">ℓ</mi></mrow><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.1.1.2.3" xref="S2.E1.m1.2.2.1.1.2.3.cmml">​</mo><mrow id="S2.E1.m1.2.2.1.1.2.2.2" xref="S2.E1.m1.2.2.1.1.2.2.3.cmml"><mo stretchy="false" id="S2.E1.m1.2.2.1.1.2.2.2.3" xref="S2.E1.m1.2.2.1.1.2.2.3.cmml">(</mo><msub id="S2.E1.m1.2.2.1.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.2.2.1.1.1.1.1.1.2" xref="S2.E1.m1.2.2.1.1.1.1.1.1.2.cmml">𝐲</mi><mi id="S2.E1.m1.2.2.1.1.1.1.1.1.3" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.E1.m1.2.2.1.1.2.2.2.4" xref="S2.E1.m1.2.2.1.1.2.2.3.cmml">,</mo><mrow id="S2.E1.m1.2.2.1.1.2.2.2.2" xref="S2.E1.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S2.E1.m1.2.2.1.1.2.2.2.2.3" xref="S2.E1.m1.2.2.1.1.2.2.2.2.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.1.1.2.2.2.2.2" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.cmml">​</mo><mrow id="S2.E1.m1.2.2.1.1.2.2.2.2.1.1" xref="S2.E1.m1.2.2.1.1.2.2.2.2.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.2.2.1.1.2.2.2.2.1.1.2" xref="S2.E1.m1.2.2.1.1.2.2.2.2.1.2.cmml">(</mo><msub id="S2.E1.m1.2.2.1.1.2.2.2.2.1.1.1" xref="S2.E1.m1.2.2.1.1.2.2.2.2.1.1.1.cmml"><mover accent="true" id="S2.E1.m1.2.2.1.1.2.2.2.2.1.1.1.2" xref="S2.E1.m1.2.2.1.1.2.2.2.2.1.1.1.2.cmml"><mi id="S2.E1.m1.2.2.1.1.2.2.2.2.1.1.1.2.2" xref="S2.E1.m1.2.2.1.1.2.2.2.2.1.1.1.2.2.cmml">𝐡</mi><mo id="S2.E1.m1.2.2.1.1.2.2.2.2.1.1.1.2.1" xref="S2.E1.m1.2.2.1.1.2.2.2.2.1.1.1.2.1.cmml">^</mo></mover><mi id="S2.E1.m1.2.2.1.1.2.2.2.2.1.1.1.3" xref="S2.E1.m1.2.2.1.1.2.2.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S2.E1.m1.2.2.1.1.2.2.2.2.1.1.3" xref="S2.E1.m1.2.2.1.1.2.2.2.2.1.2.cmml">;</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">𝐯</mi><mo stretchy="false" id="S2.E1.m1.2.2.1.1.2.2.2.2.1.1.4" xref="S2.E1.m1.2.2.1.1.2.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E1.m1.2.2.1.1.2.2.2.5" xref="S2.E1.m1.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.2.2.1.2" xref="S2.E1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.2b"><apply id="S2.E1.m1.2.2.1.1.cmml" xref="S2.E1.m1.2.2.1"><eq id="S2.E1.m1.2.2.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.3"></eq><apply id="S2.E1.m1.2.2.1.1.4.cmml" xref="S2.E1.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.4.1.cmml" xref="S2.E1.m1.2.2.1.1.4">subscript</csymbol><apply id="S2.E1.m1.2.2.1.1.4.2.cmml" xref="S2.E1.m1.2.2.1.1.4.2"><ci id="S2.E1.m1.2.2.1.1.4.2.1.cmml" xref="S2.E1.m1.2.2.1.1.4.2.1">^</ci><ci id="S2.E1.m1.2.2.1.1.4.2.2.cmml" xref="S2.E1.m1.2.2.1.1.4.2.2">𝐡</ci></apply><ci id="S2.E1.m1.2.2.1.1.4.3.cmml" xref="S2.E1.m1.2.2.1.1.4.3">𝑡</ci></apply><apply id="S2.E1.m1.2.2.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.2"><times id="S2.E1.m1.2.2.1.1.2.3.cmml" xref="S2.E1.m1.2.2.1.1.2.3"></times><apply id="S2.E1.m1.2.2.1.1.2.4.cmml" xref="S2.E1.m1.2.2.1.1.2.4"><apply id="S2.E1.m1.2.2.1.1.2.4.1.cmml" xref="S2.E1.m1.2.2.1.1.2.4.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.2.4.1.1.cmml" xref="S2.E1.m1.2.2.1.1.2.4.1">subscript</csymbol><apply id="S2.E1.m1.2.2.1.1.2.4.1.2.cmml" xref="S2.E1.m1.2.2.1.1.2.4.1.2"><times id="S2.E1.m1.2.2.1.1.2.4.1.2.1.cmml" xref="S2.E1.m1.2.2.1.1.2.4.1.2.1"></times><ci id="S2.E1.m1.2.2.1.1.2.4.1.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.4.1.2.2">arg</ci><ci id="S2.E1.m1.2.2.1.1.2.4.1.2.3.cmml" xref="S2.E1.m1.2.2.1.1.2.4.1.2.3">min</ci></apply><apply id="S2.E1.m1.2.2.1.1.2.4.1.3.cmml" xref="S2.E1.m1.2.2.1.1.2.4.1.3"><csymbol cd="latexml" id="S2.E1.m1.2.2.1.1.2.4.1.3.1.cmml" xref="S2.E1.m1.2.2.1.1.2.4.1.3.1">assign</csymbol><apply id="S2.E1.m1.2.2.1.1.2.4.1.3.2.cmml" xref="S2.E1.m1.2.2.1.1.2.4.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.2.4.1.3.2.1.cmml" xref="S2.E1.m1.2.2.1.1.2.4.1.3.2">subscript</csymbol><apply id="S2.E1.m1.2.2.1.1.2.4.1.3.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.4.1.3.2.2"><ci id="S2.E1.m1.2.2.1.1.2.4.1.3.2.2.1.cmml" xref="S2.E1.m1.2.2.1.1.2.4.1.3.2.2.1">^</ci><ci id="S2.E1.m1.2.2.1.1.2.4.1.3.2.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.4.1.3.2.2.2">𝐡</ci></apply><ci id="S2.E1.m1.2.2.1.1.2.4.1.3.2.3.cmml" xref="S2.E1.m1.2.2.1.1.2.4.1.3.2.3">𝑡</ci></apply><apply id="S2.E1.m1.2.2.1.1.2.4.1.3.3.cmml" xref="S2.E1.m1.2.2.1.1.2.4.1.3.3"><plus id="S2.E1.m1.2.2.1.1.2.4.1.3.3.1.cmml" xref="S2.E1.m1.2.2.1.1.2.4.1.3.3.1"></plus><apply id="S2.E1.m1.2.2.1.1.2.4.1.3.3.2.cmml" xref="S2.E1.m1.2.2.1.1.2.4.1.3.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.2.4.1.3.3.2.1.cmml" xref="S2.E1.m1.2.2.1.1.2.4.1.3.3.2">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.2.4.1.3.3.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.4.1.3.3.2.2">𝐡</ci><ci id="S2.E1.m1.2.2.1.1.2.4.1.3.3.2.3.cmml" xref="S2.E1.m1.2.2.1.1.2.4.1.3.3.2.3">𝑠</ci></apply><ci id="S2.E1.m1.2.2.1.1.2.4.1.3.3.3.cmml" xref="S2.E1.m1.2.2.1.1.2.4.1.3.3.3">𝛿</ci></apply></apply></apply><ci id="S2.E1.m1.2.2.1.1.2.4.2.cmml" xref="S2.E1.m1.2.2.1.1.2.4.2">ℓ</ci></apply><interval closure="open" id="S2.E1.m1.2.2.1.1.2.2.3.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2"><apply id="S2.E1.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.2">𝐲</ci><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.E1.m1.2.2.1.1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2"><times id="S2.E1.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2"></times><ci id="S2.E1.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.3">𝑓</ci><list id="S2.E1.m1.2.2.1.1.2.2.2.2.1.2.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.1.1"><apply id="S2.E1.m1.2.2.1.1.2.2.2.2.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.2.2.2.2.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.1.1.1">subscript</csymbol><apply id="S2.E1.m1.2.2.1.1.2.2.2.2.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.1.1.1.2"><ci id="S2.E1.m1.2.2.1.1.2.2.2.2.1.1.1.2.1.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.1.1.1.2.1">^</ci><ci id="S2.E1.m1.2.2.1.1.2.2.2.2.1.1.1.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.1.1.1.2.2">𝐡</ci></apply><ci id="S2.E1.m1.2.2.1.1.2.2.2.2.1.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.1.1.1.3">𝑡</ci></apply><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝐯</ci></list></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.2c">\displaystyle\widehat{\mathbf{h}}_{t}=\operatorname*{arg\,min}_{\widehat{\mathbf{h}}_{t}:=\mathbf{h}_{s}+\delta}\ell(\mathbf{y}_{t},f(\widehat{\mathbf{h}}_{t};\mathbf{\mathbf{v}})),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.SSS1.p1.17" class="ltx_p">where <math id="S2.SS2.SSS1.p1.11.m1.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="S2.SS2.SSS1.p1.11.m1.1a"><mi id="S2.SS2.SSS1.p1.11.m1.1.1" xref="S2.SS2.SSS1.p1.11.m1.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.11.m1.1b"><ci id="S2.SS2.SSS1.p1.11.m1.1.1.cmml" xref="S2.SS2.SSS1.p1.11.m1.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.11.m1.1c">\delta</annotation></semantics></math> denotes the perturbation added to the original features <math id="S2.SS2.SSS1.p1.12.m2.1" class="ltx_Math" alttext="\mathbf{h}_{s}" display="inline"><semantics id="S2.SS2.SSS1.p1.12.m2.1a"><msub id="S2.SS2.SSS1.p1.12.m2.1.1" xref="S2.SS2.SSS1.p1.12.m2.1.1.cmml"><mi id="S2.SS2.SSS1.p1.12.m2.1.1.2" xref="S2.SS2.SSS1.p1.12.m2.1.1.2.cmml">𝐡</mi><mi id="S2.SS2.SSS1.p1.12.m2.1.1.3" xref="S2.SS2.SSS1.p1.12.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.12.m2.1b"><apply id="S2.SS2.SSS1.p1.12.m2.1.1.cmml" xref="S2.SS2.SSS1.p1.12.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.12.m2.1.1.1.cmml" xref="S2.SS2.SSS1.p1.12.m2.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.12.m2.1.1.2.cmml" xref="S2.SS2.SSS1.p1.12.m2.1.1.2">𝐡</ci><ci id="S2.SS2.SSS1.p1.12.m2.1.1.3.cmml" xref="S2.SS2.SSS1.p1.12.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.12.m2.1c">\mathbf{h}_{s}</annotation></semantics></math>, such that <math id="S2.SS2.SSS1.p1.13.m3.1" class="ltx_Math" alttext="\mathbf{h}_{s}+\delta" display="inline"><semantics id="S2.SS2.SSS1.p1.13.m3.1a"><mrow id="S2.SS2.SSS1.p1.13.m3.1.1" xref="S2.SS2.SSS1.p1.13.m3.1.1.cmml"><msub id="S2.SS2.SSS1.p1.13.m3.1.1.2" xref="S2.SS2.SSS1.p1.13.m3.1.1.2.cmml"><mi id="S2.SS2.SSS1.p1.13.m3.1.1.2.2" xref="S2.SS2.SSS1.p1.13.m3.1.1.2.2.cmml">𝐡</mi><mi id="S2.SS2.SSS1.p1.13.m3.1.1.2.3" xref="S2.SS2.SSS1.p1.13.m3.1.1.2.3.cmml">s</mi></msub><mo id="S2.SS2.SSS1.p1.13.m3.1.1.1" xref="S2.SS2.SSS1.p1.13.m3.1.1.1.cmml">+</mo><mi id="S2.SS2.SSS1.p1.13.m3.1.1.3" xref="S2.SS2.SSS1.p1.13.m3.1.1.3.cmml">δ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.13.m3.1b"><apply id="S2.SS2.SSS1.p1.13.m3.1.1.cmml" xref="S2.SS2.SSS1.p1.13.m3.1.1"><plus id="S2.SS2.SSS1.p1.13.m3.1.1.1.cmml" xref="S2.SS2.SSS1.p1.13.m3.1.1.1"></plus><apply id="S2.SS2.SSS1.p1.13.m3.1.1.2.cmml" xref="S2.SS2.SSS1.p1.13.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.13.m3.1.1.2.1.cmml" xref="S2.SS2.SSS1.p1.13.m3.1.1.2">subscript</csymbol><ci id="S2.SS2.SSS1.p1.13.m3.1.1.2.2.cmml" xref="S2.SS2.SSS1.p1.13.m3.1.1.2.2">𝐡</ci><ci id="S2.SS2.SSS1.p1.13.m3.1.1.2.3.cmml" xref="S2.SS2.SSS1.p1.13.m3.1.1.2.3">𝑠</ci></apply><ci id="S2.SS2.SSS1.p1.13.m3.1.1.3.cmml" xref="S2.SS2.SSS1.p1.13.m3.1.1.3">𝛿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.13.m3.1c">\mathbf{h}_{s}+\delta</annotation></semantics></math> can be predicted as the target minority class <math id="S2.SS2.SSS1.p1.14.m4.1" class="ltx_Math" alttext="\mathbf{y}_{t}" display="inline"><semantics id="S2.SS2.SSS1.p1.14.m4.1a"><msub id="S2.SS2.SSS1.p1.14.m4.1.1" xref="S2.SS2.SSS1.p1.14.m4.1.1.cmml"><mi id="S2.SS2.SSS1.p1.14.m4.1.1.2" xref="S2.SS2.SSS1.p1.14.m4.1.1.2.cmml">𝐲</mi><mi id="S2.SS2.SSS1.p1.14.m4.1.1.3" xref="S2.SS2.SSS1.p1.14.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.14.m4.1b"><apply id="S2.SS2.SSS1.p1.14.m4.1.1.cmml" xref="S2.SS2.SSS1.p1.14.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.14.m4.1.1.1.cmml" xref="S2.SS2.SSS1.p1.14.m4.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.14.m4.1.1.2.cmml" xref="S2.SS2.SSS1.p1.14.m4.1.1.2">𝐲</ci><ci id="S2.SS2.SSS1.p1.14.m4.1.1.3.cmml" xref="S2.SS2.SSS1.p1.14.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.14.m4.1c">\mathbf{y}_{t}</annotation></semantics></math> by minimizing the loss <math id="S2.SS2.SSS1.p1.15.m5.3" class="ltx_Math" alttext="\ell(\mathbf{y}_{t},f(\widehat{\mathbf{h}}_{t};\mathbf{\mathbf{v}}))" display="inline"><semantics id="S2.SS2.SSS1.p1.15.m5.3a"><mrow id="S2.SS2.SSS1.p1.15.m5.3.3" xref="S2.SS2.SSS1.p1.15.m5.3.3.cmml"><mi mathvariant="normal" id="S2.SS2.SSS1.p1.15.m5.3.3.4" xref="S2.SS2.SSS1.p1.15.m5.3.3.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p1.15.m5.3.3.3" xref="S2.SS2.SSS1.p1.15.m5.3.3.3.cmml">​</mo><mrow id="S2.SS2.SSS1.p1.15.m5.3.3.2.2" xref="S2.SS2.SSS1.p1.15.m5.3.3.2.3.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p1.15.m5.3.3.2.2.3" xref="S2.SS2.SSS1.p1.15.m5.3.3.2.3.cmml">(</mo><msub id="S2.SS2.SSS1.p1.15.m5.2.2.1.1.1" xref="S2.SS2.SSS1.p1.15.m5.2.2.1.1.1.cmml"><mi id="S2.SS2.SSS1.p1.15.m5.2.2.1.1.1.2" xref="S2.SS2.SSS1.p1.15.m5.2.2.1.1.1.2.cmml">𝐲</mi><mi id="S2.SS2.SSS1.p1.15.m5.2.2.1.1.1.3" xref="S2.SS2.SSS1.p1.15.m5.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS2.SSS1.p1.15.m5.3.3.2.2.4" xref="S2.SS2.SSS1.p1.15.m5.3.3.2.3.cmml">,</mo><mrow id="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2" xref="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.cmml"><mi id="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.3" xref="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.2" xref="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.2.cmml">​</mo><mrow id="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.1" xref="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.2.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.1.2" xref="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.2.cmml">(</mo><msub id="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.1.1" xref="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.1.1.cmml"><mover accent="true" id="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.1.1.2" xref="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.1.1.2.cmml"><mi id="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.1.1.2.2" xref="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.1.1.2.2.cmml">𝐡</mi><mo id="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.1.1.2.1" xref="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.1.1.3" xref="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.1.3" xref="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.2.cmml">;</mo><mi id="S2.SS2.SSS1.p1.15.m5.1.1" xref="S2.SS2.SSS1.p1.15.m5.1.1.cmml">𝐯</mi><mo stretchy="false" id="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.1.4" xref="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.SS2.SSS1.p1.15.m5.3.3.2.2.5" xref="S2.SS2.SSS1.p1.15.m5.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.15.m5.3b"><apply id="S2.SS2.SSS1.p1.15.m5.3.3.cmml" xref="S2.SS2.SSS1.p1.15.m5.3.3"><times id="S2.SS2.SSS1.p1.15.m5.3.3.3.cmml" xref="S2.SS2.SSS1.p1.15.m5.3.3.3"></times><ci id="S2.SS2.SSS1.p1.15.m5.3.3.4.cmml" xref="S2.SS2.SSS1.p1.15.m5.3.3.4">ℓ</ci><interval closure="open" id="S2.SS2.SSS1.p1.15.m5.3.3.2.3.cmml" xref="S2.SS2.SSS1.p1.15.m5.3.3.2.2"><apply id="S2.SS2.SSS1.p1.15.m5.2.2.1.1.1.cmml" xref="S2.SS2.SSS1.p1.15.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.15.m5.2.2.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.15.m5.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.15.m5.2.2.1.1.1.2.cmml" xref="S2.SS2.SSS1.p1.15.m5.2.2.1.1.1.2">𝐲</ci><ci id="S2.SS2.SSS1.p1.15.m5.2.2.1.1.1.3.cmml" xref="S2.SS2.SSS1.p1.15.m5.2.2.1.1.1.3">𝑡</ci></apply><apply id="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.cmml" xref="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2"><times id="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.2.cmml" xref="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.2"></times><ci id="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.3.cmml" xref="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.3">𝑓</ci><list id="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.2.cmml" xref="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.1"><apply id="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.1.1.cmml" xref="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.1.1">subscript</csymbol><apply id="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.1.1.2.cmml" xref="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.1.1.2"><ci id="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.1.1.2.1.cmml" xref="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.1.1.2.1">^</ci><ci id="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.1.1.2.2.cmml" xref="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.1.1.2.2">𝐡</ci></apply><ci id="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.1.1.3.cmml" xref="S2.SS2.SSS1.p1.15.m5.3.3.2.2.2.1.1.1.3">𝑡</ci></apply><ci id="S2.SS2.SSS1.p1.15.m5.1.1.cmml" xref="S2.SS2.SSS1.p1.15.m5.1.1">𝐯</ci></list></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.15.m5.3c">\ell(\mathbf{y}_{t},f(\widehat{\mathbf{h}}_{t};\mathbf{\mathbf{v}}))</annotation></semantics></math>. An intuitive strategy to optimize Eq. (<a href="#S2.E1" title="In 2.2.1 Local Feature Augmentation ‣ 2.2 FedAFA Framework ‣ 2 Proposed Method ‣ Personalized Federated Learning on Long-Tailed Data via Adversarial Feature Augmentation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) is to obtain the perturbations <math id="S2.SS2.SSS1.p1.16.m6.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="S2.SS2.SSS1.p1.16.m6.1a"><mi id="S2.SS2.SSS1.p1.16.m6.1.1" xref="S2.SS2.SSS1.p1.16.m6.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.16.m6.1b"><ci id="S2.SS2.SSS1.p1.16.m6.1.1.cmml" xref="S2.SS2.SSS1.p1.16.m6.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.16.m6.1c">\delta</annotation></semantics></math> by the negative normalized gradients of classifier <math id="S2.SS2.SSS1.p1.17.m7.1" class="ltx_Math" alttext="\mathbf{v}" display="inline"><semantics id="S2.SS2.SSS1.p1.17.m7.1a"><mi id="S2.SS2.SSS1.p1.17.m7.1.1" xref="S2.SS2.SSS1.p1.17.m7.1.1.cmml">𝐯</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.17.m7.1b"><ci id="S2.SS2.SSS1.p1.17.m7.1.1.cmml" xref="S2.SS2.SSS1.p1.17.m7.1.1">𝐯</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.17.m7.1c">\mathbf{v}</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>:</p>
<table id="S4.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E2.m1.1" class="ltx_Math" alttext="\displaystyle\nabla_{\widehat{\mathbf{h}}_{t}}" display="inline"><semantics id="S2.E2.m1.1a"><msub id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml"><mo id="S2.E2.m1.1.1.2" xref="S2.E2.m1.1.1.2.cmml">∇</mo><msub id="S2.E2.m1.1.1.3" xref="S2.E2.m1.1.1.3.cmml"><mover accent="true" id="S2.E2.m1.1.1.3.2" xref="S2.E2.m1.1.1.3.2.cmml"><mi id="S2.E2.m1.1.1.3.2.2" xref="S2.E2.m1.1.1.3.2.2.cmml">𝐡</mi><mo id="S2.E2.m1.1.1.3.2.1" xref="S2.E2.m1.1.1.3.2.1.cmml">^</mo></mover><mi id="S2.E2.m1.1.1.3.3" xref="S2.E2.m1.1.1.3.3.cmml">t</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1">subscript</csymbol><ci id="S2.E2.m1.1.1.2.cmml" xref="S2.E2.m1.1.1.2">∇</ci><apply id="S2.E2.m1.1.1.3.cmml" xref="S2.E2.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.3">subscript</csymbol><apply id="S2.E2.m1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.3.2"><ci id="S2.E2.m1.1.1.3.2.1.cmml" xref="S2.E2.m1.1.1.3.2.1">^</ci><ci id="S2.E2.m1.1.1.3.2.2.cmml" xref="S2.E2.m1.1.1.3.2.2">𝐡</ci></apply><ci id="S2.E2.m1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\displaystyle\nabla_{\widehat{\mathbf{h}}_{t}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E2.m2.4" class="ltx_Math" alttext="\displaystyle=\frac{\partial\ell(\mathbf{y}_{t},f(\widehat{\mathbf{h}}_{t};\mathbf{\mathbf{v}}))}{\partial\widehat{\mathbf{h}}_{t}}," display="inline"><semantics id="S2.E2.m2.4a"><mrow id="S2.E2.m2.4.4.1" xref="S2.E2.m2.4.4.1.1.cmml"><mrow id="S2.E2.m2.4.4.1.1" xref="S2.E2.m2.4.4.1.1.cmml"><mi id="S2.E2.m2.4.4.1.1.2" xref="S2.E2.m2.4.4.1.1.2.cmml"></mi><mo id="S2.E2.m2.4.4.1.1.1" xref="S2.E2.m2.4.4.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="S2.E2.m2.3.3" xref="S2.E2.m2.3.3.cmml"><mfrac id="S2.E2.m2.3.3a" xref="S2.E2.m2.3.3.cmml"><mrow id="S2.E2.m2.3.3.3" xref="S2.E2.m2.3.3.3.cmml"><mo rspace="0em" id="S2.E2.m2.3.3.3.4" xref="S2.E2.m2.3.3.3.4.cmml">∂</mo><mrow id="S2.E2.m2.3.3.3.3" xref="S2.E2.m2.3.3.3.3.cmml"><mi mathvariant="normal" id="S2.E2.m2.3.3.3.3.4" xref="S2.E2.m2.3.3.3.3.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S2.E2.m2.3.3.3.3.3" xref="S2.E2.m2.3.3.3.3.3.cmml">​</mo><mrow id="S2.E2.m2.3.3.3.3.2.2" xref="S2.E2.m2.3.3.3.3.2.3.cmml"><mo stretchy="false" id="S2.E2.m2.3.3.3.3.2.2.3" xref="S2.E2.m2.3.3.3.3.2.3.cmml">(</mo><msub id="S2.E2.m2.2.2.2.2.1.1.1" xref="S2.E2.m2.2.2.2.2.1.1.1.cmml"><mi id="S2.E2.m2.2.2.2.2.1.1.1.2" xref="S2.E2.m2.2.2.2.2.1.1.1.2.cmml">𝐲</mi><mi id="S2.E2.m2.2.2.2.2.1.1.1.3" xref="S2.E2.m2.2.2.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S2.E2.m2.3.3.3.3.2.2.4" xref="S2.E2.m2.3.3.3.3.2.3.cmml">,</mo><mrow id="S2.E2.m2.3.3.3.3.2.2.2" xref="S2.E2.m2.3.3.3.3.2.2.2.cmml"><mi id="S2.E2.m2.3.3.3.3.2.2.2.3" xref="S2.E2.m2.3.3.3.3.2.2.2.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.E2.m2.3.3.3.3.2.2.2.2" xref="S2.E2.m2.3.3.3.3.2.2.2.2.cmml">​</mo><mrow id="S2.E2.m2.3.3.3.3.2.2.2.1.1" xref="S2.E2.m2.3.3.3.3.2.2.2.1.2.cmml"><mo stretchy="false" id="S2.E2.m2.3.3.3.3.2.2.2.1.1.2" xref="S2.E2.m2.3.3.3.3.2.2.2.1.2.cmml">(</mo><msub id="S2.E2.m2.3.3.3.3.2.2.2.1.1.1" xref="S2.E2.m2.3.3.3.3.2.2.2.1.1.1.cmml"><mover accent="true" id="S2.E2.m2.3.3.3.3.2.2.2.1.1.1.2" xref="S2.E2.m2.3.3.3.3.2.2.2.1.1.1.2.cmml"><mi id="S2.E2.m2.3.3.3.3.2.2.2.1.1.1.2.2" xref="S2.E2.m2.3.3.3.3.2.2.2.1.1.1.2.2.cmml">𝐡</mi><mo id="S2.E2.m2.3.3.3.3.2.2.2.1.1.1.2.1" xref="S2.E2.m2.3.3.3.3.2.2.2.1.1.1.2.1.cmml">^</mo></mover><mi id="S2.E2.m2.3.3.3.3.2.2.2.1.1.1.3" xref="S2.E2.m2.3.3.3.3.2.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S2.E2.m2.3.3.3.3.2.2.2.1.1.3" xref="S2.E2.m2.3.3.3.3.2.2.2.1.2.cmml">;</mo><mi id="S2.E2.m2.1.1.1.1" xref="S2.E2.m2.1.1.1.1.cmml">𝐯</mi><mo stretchy="false" id="S2.E2.m2.3.3.3.3.2.2.2.1.1.4" xref="S2.E2.m2.3.3.3.3.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E2.m2.3.3.3.3.2.2.5" xref="S2.E2.m2.3.3.3.3.2.3.cmml">)</mo></mrow></mrow></mrow><mrow id="S2.E2.m2.3.3.5" xref="S2.E2.m2.3.3.5.cmml"><mo rspace="0em" id="S2.E2.m2.3.3.5.1" xref="S2.E2.m2.3.3.5.1.cmml">∂</mo><msub id="S2.E2.m2.3.3.5.2" xref="S2.E2.m2.3.3.5.2.cmml"><mover accent="true" id="S2.E2.m2.3.3.5.2.2" xref="S2.E2.m2.3.3.5.2.2.cmml"><mi id="S2.E2.m2.3.3.5.2.2.2" xref="S2.E2.m2.3.3.5.2.2.2.cmml">𝐡</mi><mo id="S2.E2.m2.3.3.5.2.2.1" xref="S2.E2.m2.3.3.5.2.2.1.cmml">^</mo></mover><mi id="S2.E2.m2.3.3.5.2.3" xref="S2.E2.m2.3.3.5.2.3.cmml">t</mi></msub></mrow></mfrac></mstyle></mrow><mo id="S2.E2.m2.4.4.1.2" xref="S2.E2.m2.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m2.4b"><apply id="S2.E2.m2.4.4.1.1.cmml" xref="S2.E2.m2.4.4.1"><eq id="S2.E2.m2.4.4.1.1.1.cmml" xref="S2.E2.m2.4.4.1.1.1"></eq><csymbol cd="latexml" id="S2.E2.m2.4.4.1.1.2.cmml" xref="S2.E2.m2.4.4.1.1.2">absent</csymbol><apply id="S2.E2.m2.3.3.cmml" xref="S2.E2.m2.3.3"><divide id="S2.E2.m2.3.3.4.cmml" xref="S2.E2.m2.3.3"></divide><apply id="S2.E2.m2.3.3.3.cmml" xref="S2.E2.m2.3.3.3"><partialdiff id="S2.E2.m2.3.3.3.4.cmml" xref="S2.E2.m2.3.3.3.4"></partialdiff><apply id="S2.E2.m2.3.3.3.3.cmml" xref="S2.E2.m2.3.3.3.3"><times id="S2.E2.m2.3.3.3.3.3.cmml" xref="S2.E2.m2.3.3.3.3.3"></times><ci id="S2.E2.m2.3.3.3.3.4.cmml" xref="S2.E2.m2.3.3.3.3.4">ℓ</ci><interval closure="open" id="S2.E2.m2.3.3.3.3.2.3.cmml" xref="S2.E2.m2.3.3.3.3.2.2"><apply id="S2.E2.m2.2.2.2.2.1.1.1.cmml" xref="S2.E2.m2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m2.2.2.2.2.1.1.1.1.cmml" xref="S2.E2.m2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S2.E2.m2.2.2.2.2.1.1.1.2.cmml" xref="S2.E2.m2.2.2.2.2.1.1.1.2">𝐲</ci><ci id="S2.E2.m2.2.2.2.2.1.1.1.3.cmml" xref="S2.E2.m2.2.2.2.2.1.1.1.3">𝑡</ci></apply><apply id="S2.E2.m2.3.3.3.3.2.2.2.cmml" xref="S2.E2.m2.3.3.3.3.2.2.2"><times id="S2.E2.m2.3.3.3.3.2.2.2.2.cmml" xref="S2.E2.m2.3.3.3.3.2.2.2.2"></times><ci id="S2.E2.m2.3.3.3.3.2.2.2.3.cmml" xref="S2.E2.m2.3.3.3.3.2.2.2.3">𝑓</ci><list id="S2.E2.m2.3.3.3.3.2.2.2.1.2.cmml" xref="S2.E2.m2.3.3.3.3.2.2.2.1.1"><apply id="S2.E2.m2.3.3.3.3.2.2.2.1.1.1.cmml" xref="S2.E2.m2.3.3.3.3.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m2.3.3.3.3.2.2.2.1.1.1.1.cmml" xref="S2.E2.m2.3.3.3.3.2.2.2.1.1.1">subscript</csymbol><apply id="S2.E2.m2.3.3.3.3.2.2.2.1.1.1.2.cmml" xref="S2.E2.m2.3.3.3.3.2.2.2.1.1.1.2"><ci id="S2.E2.m2.3.3.3.3.2.2.2.1.1.1.2.1.cmml" xref="S2.E2.m2.3.3.3.3.2.2.2.1.1.1.2.1">^</ci><ci id="S2.E2.m2.3.3.3.3.2.2.2.1.1.1.2.2.cmml" xref="S2.E2.m2.3.3.3.3.2.2.2.1.1.1.2.2">𝐡</ci></apply><ci id="S2.E2.m2.3.3.3.3.2.2.2.1.1.1.3.cmml" xref="S2.E2.m2.3.3.3.3.2.2.2.1.1.1.3">𝑡</ci></apply><ci id="S2.E2.m2.1.1.1.1.cmml" xref="S2.E2.m2.1.1.1.1">𝐯</ci></list></apply></interval></apply></apply><apply id="S2.E2.m2.3.3.5.cmml" xref="S2.E2.m2.3.3.5"><partialdiff id="S2.E2.m2.3.3.5.1.cmml" xref="S2.E2.m2.3.3.5.1"></partialdiff><apply id="S2.E2.m2.3.3.5.2.cmml" xref="S2.E2.m2.3.3.5.2"><csymbol cd="ambiguous" id="S2.E2.m2.3.3.5.2.1.cmml" xref="S2.E2.m2.3.3.5.2">subscript</csymbol><apply id="S2.E2.m2.3.3.5.2.2.cmml" xref="S2.E2.m2.3.3.5.2.2"><ci id="S2.E2.m2.3.3.5.2.2.1.cmml" xref="S2.E2.m2.3.3.5.2.2.1">^</ci><ci id="S2.E2.m2.3.3.5.2.2.2.cmml" xref="S2.E2.m2.3.3.5.2.2.2">𝐡</ci></apply><ci id="S2.E2.m2.3.3.5.2.3.cmml" xref="S2.E2.m2.3.3.5.2.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m2.4c">\displaystyle=\frac{\partial\ell(\mathbf{y}_{t},f(\widehat{\mathbf{h}}_{t};\mathbf{\mathbf{v}}))}{\partial\widehat{\mathbf{h}}_{t}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E3.m1.1" class="ltx_Math" alttext="\displaystyle\delta" display="inline"><semantics id="S2.E3.m1.1a"><mi id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><ci id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">\displaystyle\delta</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E3.m2.2" class="ltx_Math" alttext="\displaystyle=-\frac{\nabla_{\widehat{\mathbf{h}}_{t}}}{\|\nabla_{\widehat{\mathbf{h}}_{t}}\|}_{2}." display="inline"><semantics id="S2.E3.m2.2a"><mrow id="S2.E3.m2.2.2.1" xref="S2.E3.m2.2.2.1.1.cmml"><mrow id="S2.E3.m2.2.2.1.1" xref="S2.E3.m2.2.2.1.1.cmml"><mi id="S2.E3.m2.2.2.1.1.2" xref="S2.E3.m2.2.2.1.1.2.cmml"></mi><mo id="S2.E3.m2.2.2.1.1.1" xref="S2.E3.m2.2.2.1.1.1.cmml">=</mo><mrow id="S2.E3.m2.2.2.1.1.3" xref="S2.E3.m2.2.2.1.1.3.cmml"><mo id="S2.E3.m2.2.2.1.1.3a" xref="S2.E3.m2.2.2.1.1.3.cmml">−</mo><msub id="S2.E3.m2.2.2.1.1.3.2" xref="S2.E3.m2.2.2.1.1.3.2.cmml"><mstyle displaystyle="true" id="S2.E3.m2.1.1" xref="S2.E3.m2.1.1.cmml"><mfrac id="S2.E3.m2.1.1a" xref="S2.E3.m2.1.1.cmml"><msub id="S2.E3.m2.1.1.3" xref="S2.E3.m2.1.1.3.cmml"><mo id="S2.E3.m2.1.1.3.2" xref="S2.E3.m2.1.1.3.2.cmml">∇</mo><msub id="S2.E3.m2.1.1.3.3" xref="S2.E3.m2.1.1.3.3.cmml"><mover accent="true" id="S2.E3.m2.1.1.3.3.2" xref="S2.E3.m2.1.1.3.3.2.cmml"><mi id="S2.E3.m2.1.1.3.3.2.2" xref="S2.E3.m2.1.1.3.3.2.2.cmml">𝐡</mi><mo id="S2.E3.m2.1.1.3.3.2.1" xref="S2.E3.m2.1.1.3.3.2.1.cmml">^</mo></mover><mi id="S2.E3.m2.1.1.3.3.3" xref="S2.E3.m2.1.1.3.3.3.cmml">t</mi></msub></msub><mrow id="S2.E3.m2.1.1.1.1" xref="S2.E3.m2.1.1.1.2.cmml"><mo stretchy="false" id="S2.E3.m2.1.1.1.1.2" xref="S2.E3.m2.1.1.1.2.1.cmml">‖</mo><msub id="S2.E3.m2.1.1.1.1.1" xref="S2.E3.m2.1.1.1.1.1.cmml"><mo id="S2.E3.m2.1.1.1.1.1.2" xref="S2.E3.m2.1.1.1.1.1.2.cmml">∇</mo><msub id="S2.E3.m2.1.1.1.1.1.3" xref="S2.E3.m2.1.1.1.1.1.3.cmml"><mover accent="true" id="S2.E3.m2.1.1.1.1.1.3.2" xref="S2.E3.m2.1.1.1.1.1.3.2.cmml"><mi id="S2.E3.m2.1.1.1.1.1.3.2.2" xref="S2.E3.m2.1.1.1.1.1.3.2.2.cmml">𝐡</mi><mo id="S2.E3.m2.1.1.1.1.1.3.2.1" xref="S2.E3.m2.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S2.E3.m2.1.1.1.1.1.3.3" xref="S2.E3.m2.1.1.1.1.1.3.3.cmml">t</mi></msub></msub><mo stretchy="false" id="S2.E3.m2.1.1.1.1.3" xref="S2.E3.m2.1.1.1.2.1.cmml">‖</mo></mrow></mfrac></mstyle><mn id="S2.E3.m2.2.2.1.1.3.2.2" xref="S2.E3.m2.2.2.1.1.3.2.2.cmml">2</mn></msub></mrow></mrow><mo lspace="0em" id="S2.E3.m2.2.2.1.2" xref="S2.E3.m2.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m2.2b"><apply id="S2.E3.m2.2.2.1.1.cmml" xref="S2.E3.m2.2.2.1"><eq id="S2.E3.m2.2.2.1.1.1.cmml" xref="S2.E3.m2.2.2.1.1.1"></eq><csymbol cd="latexml" id="S2.E3.m2.2.2.1.1.2.cmml" xref="S2.E3.m2.2.2.1.1.2">absent</csymbol><apply id="S2.E3.m2.2.2.1.1.3.cmml" xref="S2.E3.m2.2.2.1.1.3"><minus id="S2.E3.m2.2.2.1.1.3.1.cmml" xref="S2.E3.m2.2.2.1.1.3"></minus><apply id="S2.E3.m2.2.2.1.1.3.2.cmml" xref="S2.E3.m2.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S2.E3.m2.2.2.1.1.3.2.1.cmml" xref="S2.E3.m2.2.2.1.1.3.2">subscript</csymbol><apply id="S2.E3.m2.1.1.cmml" xref="S2.E3.m2.1.1"><divide id="S2.E3.m2.1.1.2.cmml" xref="S2.E3.m2.1.1"></divide><apply id="S2.E3.m2.1.1.3.cmml" xref="S2.E3.m2.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m2.1.1.3.1.cmml" xref="S2.E3.m2.1.1.3">subscript</csymbol><ci id="S2.E3.m2.1.1.3.2.cmml" xref="S2.E3.m2.1.1.3.2">∇</ci><apply id="S2.E3.m2.1.1.3.3.cmml" xref="S2.E3.m2.1.1.3.3"><csymbol cd="ambiguous" id="S2.E3.m2.1.1.3.3.1.cmml" xref="S2.E3.m2.1.1.3.3">subscript</csymbol><apply id="S2.E3.m2.1.1.3.3.2.cmml" xref="S2.E3.m2.1.1.3.3.2"><ci id="S2.E3.m2.1.1.3.3.2.1.cmml" xref="S2.E3.m2.1.1.3.3.2.1">^</ci><ci id="S2.E3.m2.1.1.3.3.2.2.cmml" xref="S2.E3.m2.1.1.3.3.2.2">𝐡</ci></apply><ci id="S2.E3.m2.1.1.3.3.3.cmml" xref="S2.E3.m2.1.1.3.3.3">𝑡</ci></apply></apply><apply id="S2.E3.m2.1.1.1.2.cmml" xref="S2.E3.m2.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m2.1.1.1.2.1.cmml" xref="S2.E3.m2.1.1.1.1.2">norm</csymbol><apply id="S2.E3.m2.1.1.1.1.1.cmml" xref="S2.E3.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m2.1.1.1.1.1.1.cmml" xref="S2.E3.m2.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m2.1.1.1.1.1.2.cmml" xref="S2.E3.m2.1.1.1.1.1.2">∇</ci><apply id="S2.E3.m2.1.1.1.1.1.3.cmml" xref="S2.E3.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m2.1.1.1.1.1.3.1.cmml" xref="S2.E3.m2.1.1.1.1.1.3">subscript</csymbol><apply id="S2.E3.m2.1.1.1.1.1.3.2.cmml" xref="S2.E3.m2.1.1.1.1.1.3.2"><ci id="S2.E3.m2.1.1.1.1.1.3.2.1.cmml" xref="S2.E3.m2.1.1.1.1.1.3.2.1">^</ci><ci id="S2.E3.m2.1.1.1.1.1.3.2.2.cmml" xref="S2.E3.m2.1.1.1.1.1.3.2.2">𝐡</ci></apply><ci id="S2.E3.m2.1.1.1.1.1.3.3.cmml" xref="S2.E3.m2.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply><cn type="integer" id="S2.E3.m2.2.2.1.1.3.2.2.cmml" xref="S2.E3.m2.2.2.1.1.3.2.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m2.2c">\displaystyle=-\frac{\nabla_{\widehat{\mathbf{h}}_{t}}}{\|\nabla_{\widehat{\mathbf{h}}_{t}}\|}_{2}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.SSS1.p1.22" class="ltx_p">The gradient <math id="S2.SS2.SSS1.p1.18.m1.1" class="ltx_Math" alttext="\nabla_{\widehat{\mathbf{h}}_{t}}" display="inline"><semantics id="S2.SS2.SSS1.p1.18.m1.1a"><msub id="S2.SS2.SSS1.p1.18.m1.1.1" xref="S2.SS2.SSS1.p1.18.m1.1.1.cmml"><mo id="S2.SS2.SSS1.p1.18.m1.1.1.2" xref="S2.SS2.SSS1.p1.18.m1.1.1.2.cmml">∇</mo><msub id="S2.SS2.SSS1.p1.18.m1.1.1.3" xref="S2.SS2.SSS1.p1.18.m1.1.1.3.cmml"><mover accent="true" id="S2.SS2.SSS1.p1.18.m1.1.1.3.2" xref="S2.SS2.SSS1.p1.18.m1.1.1.3.2.cmml"><mi id="S2.SS2.SSS1.p1.18.m1.1.1.3.2.2" xref="S2.SS2.SSS1.p1.18.m1.1.1.3.2.2.cmml">𝐡</mi><mo id="S2.SS2.SSS1.p1.18.m1.1.1.3.2.1" xref="S2.SS2.SSS1.p1.18.m1.1.1.3.2.1.cmml">^</mo></mover><mi id="S2.SS2.SSS1.p1.18.m1.1.1.3.3" xref="S2.SS2.SSS1.p1.18.m1.1.1.3.3.cmml">t</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.18.m1.1b"><apply id="S2.SS2.SSS1.p1.18.m1.1.1.cmml" xref="S2.SS2.SSS1.p1.18.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.18.m1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.18.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.18.m1.1.1.2.cmml" xref="S2.SS2.SSS1.p1.18.m1.1.1.2">∇</ci><apply id="S2.SS2.SSS1.p1.18.m1.1.1.3.cmml" xref="S2.SS2.SSS1.p1.18.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.18.m1.1.1.3.1.cmml" xref="S2.SS2.SSS1.p1.18.m1.1.1.3">subscript</csymbol><apply id="S2.SS2.SSS1.p1.18.m1.1.1.3.2.cmml" xref="S2.SS2.SSS1.p1.18.m1.1.1.3.2"><ci id="S2.SS2.SSS1.p1.18.m1.1.1.3.2.1.cmml" xref="S2.SS2.SSS1.p1.18.m1.1.1.3.2.1">^</ci><ci id="S2.SS2.SSS1.p1.18.m1.1.1.3.2.2.cmml" xref="S2.SS2.SSS1.p1.18.m1.1.1.3.2.2">𝐡</ci></apply><ci id="S2.SS2.SSS1.p1.18.m1.1.1.3.3.cmml" xref="S2.SS2.SSS1.p1.18.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.18.m1.1c">\nabla_{\widehat{\mathbf{h}}_{t}}</annotation></semantics></math> carries the information of how to predict <math id="S2.SS2.SSS1.p1.19.m2.1" class="ltx_Math" alttext="\widehat{\mathbf{h}}_{t}" display="inline"><semantics id="S2.SS2.SSS1.p1.19.m2.1a"><msub id="S2.SS2.SSS1.p1.19.m2.1.1" xref="S2.SS2.SSS1.p1.19.m2.1.1.cmml"><mover accent="true" id="S2.SS2.SSS1.p1.19.m2.1.1.2" xref="S2.SS2.SSS1.p1.19.m2.1.1.2.cmml"><mi id="S2.SS2.SSS1.p1.19.m2.1.1.2.2" xref="S2.SS2.SSS1.p1.19.m2.1.1.2.2.cmml">𝐡</mi><mo id="S2.SS2.SSS1.p1.19.m2.1.1.2.1" xref="S2.SS2.SSS1.p1.19.m2.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS2.SSS1.p1.19.m2.1.1.3" xref="S2.SS2.SSS1.p1.19.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.19.m2.1b"><apply id="S2.SS2.SSS1.p1.19.m2.1.1.cmml" xref="S2.SS2.SSS1.p1.19.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.19.m2.1.1.1.cmml" xref="S2.SS2.SSS1.p1.19.m2.1.1">subscript</csymbol><apply id="S2.SS2.SSS1.p1.19.m2.1.1.2.cmml" xref="S2.SS2.SSS1.p1.19.m2.1.1.2"><ci id="S2.SS2.SSS1.p1.19.m2.1.1.2.1.cmml" xref="S2.SS2.SSS1.p1.19.m2.1.1.2.1">^</ci><ci id="S2.SS2.SSS1.p1.19.m2.1.1.2.2.cmml" xref="S2.SS2.SSS1.p1.19.m2.1.1.2.2">𝐡</ci></apply><ci id="S2.SS2.SSS1.p1.19.m2.1.1.3.cmml" xref="S2.SS2.SSS1.p1.19.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.19.m2.1c">\widehat{\mathbf{h}}_{t}</annotation></semantics></math> into class <math id="S2.SS2.SSS1.p1.20.m3.1" class="ltx_Math" alttext="\mathbf{y}_{t}" display="inline"><semantics id="S2.SS2.SSS1.p1.20.m3.1a"><msub id="S2.SS2.SSS1.p1.20.m3.1.1" xref="S2.SS2.SSS1.p1.20.m3.1.1.cmml"><mi id="S2.SS2.SSS1.p1.20.m3.1.1.2" xref="S2.SS2.SSS1.p1.20.m3.1.1.2.cmml">𝐲</mi><mi id="S2.SS2.SSS1.p1.20.m3.1.1.3" xref="S2.SS2.SSS1.p1.20.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.20.m3.1b"><apply id="S2.SS2.SSS1.p1.20.m3.1.1.cmml" xref="S2.SS2.SSS1.p1.20.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.20.m3.1.1.1.cmml" xref="S2.SS2.SSS1.p1.20.m3.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.20.m3.1.1.2.cmml" xref="S2.SS2.SSS1.p1.20.m3.1.1.2">𝐲</ci><ci id="S2.SS2.SSS1.p1.20.m3.1.1.3.cmml" xref="S2.SS2.SSS1.p1.20.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.20.m3.1c">\mathbf{y}_{t}</annotation></semantics></math>. Therefore, iteratively adding its negative normalized value <math id="S2.SS2.SSS1.p1.21.m4.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="S2.SS2.SSS1.p1.21.m4.1a"><mi id="S2.SS2.SSS1.p1.21.m4.1.1" xref="S2.SS2.SSS1.p1.21.m4.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.21.m4.1b"><ci id="S2.SS2.SSS1.p1.21.m4.1.1.cmml" xref="S2.SS2.SSS1.p1.21.m4.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.21.m4.1c">\delta</annotation></semantics></math> to <math id="S2.SS2.SSS1.p1.22.m5.1" class="ltx_Math" alttext="\widehat{\mathbf{h}}_{t}" display="inline"><semantics id="S2.SS2.SSS1.p1.22.m5.1a"><msub id="S2.SS2.SSS1.p1.22.m5.1.1" xref="S2.SS2.SSS1.p1.22.m5.1.1.cmml"><mover accent="true" id="S2.SS2.SSS1.p1.22.m5.1.1.2" xref="S2.SS2.SSS1.p1.22.m5.1.1.2.cmml"><mi id="S2.SS2.SSS1.p1.22.m5.1.1.2.2" xref="S2.SS2.SSS1.p1.22.m5.1.1.2.2.cmml">𝐡</mi><mo id="S2.SS2.SSS1.p1.22.m5.1.1.2.1" xref="S2.SS2.SSS1.p1.22.m5.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS2.SSS1.p1.22.m5.1.1.3" xref="S2.SS2.SSS1.p1.22.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.22.m5.1b"><apply id="S2.SS2.SSS1.p1.22.m5.1.1.cmml" xref="S2.SS2.SSS1.p1.22.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.22.m5.1.1.1.cmml" xref="S2.SS2.SSS1.p1.22.m5.1.1">subscript</csymbol><apply id="S2.SS2.SSS1.p1.22.m5.1.1.2.cmml" xref="S2.SS2.SSS1.p1.22.m5.1.1.2"><ci id="S2.SS2.SSS1.p1.22.m5.1.1.2.1.cmml" xref="S2.SS2.SSS1.p1.22.m5.1.1.2.1">^</ci><ci id="S2.SS2.SSS1.p1.22.m5.1.1.2.2.cmml" xref="S2.SS2.SSS1.p1.22.m5.1.1.2.2">𝐡</ci></apply><ci id="S2.SS2.SSS1.p1.22.m5.1.1.3.cmml" xref="S2.SS2.SSS1.p1.22.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.22.m5.1c">\widehat{\mathbf{h}}_{t}</annotation></semantics></math> is towards the direction of loss decreasing of the next optimization iteration.</p>
</div>
<div id="S2.SS2.SSS1.p2" class="ltx_para">
<p id="S2.SS2.SSS1.p2.9" class="ltx_p">After obtaining the features <math id="S2.SS2.SSS1.p2.1.m1.1" class="ltx_Math" alttext="\widehat{\mathbf{h}}_{t}" display="inline"><semantics id="S2.SS2.SSS1.p2.1.m1.1a"><msub id="S2.SS2.SSS1.p2.1.m1.1.1" xref="S2.SS2.SSS1.p2.1.m1.1.1.cmml"><mover accent="true" id="S2.SS2.SSS1.p2.1.m1.1.1.2" xref="S2.SS2.SSS1.p2.1.m1.1.1.2.cmml"><mi id="S2.SS2.SSS1.p2.1.m1.1.1.2.2" xref="S2.SS2.SSS1.p2.1.m1.1.1.2.2.cmml">𝐡</mi><mo id="S2.SS2.SSS1.p2.1.m1.1.1.2.1" xref="S2.SS2.SSS1.p2.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS2.SSS1.p2.1.m1.1.1.3" xref="S2.SS2.SSS1.p2.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.1.m1.1b"><apply id="S2.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.1.m1.1.1.1.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1">subscript</csymbol><apply id="S2.SS2.SSS1.p2.1.m1.1.1.2.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1.2"><ci id="S2.SS2.SSS1.p2.1.m1.1.1.2.1.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1.2.1">^</ci><ci id="S2.SS2.SSS1.p2.1.m1.1.1.2.2.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1.2.2">𝐡</ci></apply><ci id="S2.SS2.SSS1.p2.1.m1.1.1.3.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.1.m1.1c">\widehat{\mathbf{h}}_{t}</annotation></semantics></math>, we cannot guarantee that <math id="S2.SS2.SSS1.p2.2.m2.1" class="ltx_Math" alttext="\widehat{\mathbf{h}}_{t}" display="inline"><semantics id="S2.SS2.SSS1.p2.2.m2.1a"><msub id="S2.SS2.SSS1.p2.2.m2.1.1" xref="S2.SS2.SSS1.p2.2.m2.1.1.cmml"><mover accent="true" id="S2.SS2.SSS1.p2.2.m2.1.1.2" xref="S2.SS2.SSS1.p2.2.m2.1.1.2.cmml"><mi id="S2.SS2.SSS1.p2.2.m2.1.1.2.2" xref="S2.SS2.SSS1.p2.2.m2.1.1.2.2.cmml">𝐡</mi><mo id="S2.SS2.SSS1.p2.2.m2.1.1.2.1" xref="S2.SS2.SSS1.p2.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS2.SSS1.p2.2.m2.1.1.3" xref="S2.SS2.SSS1.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.2.m2.1b"><apply id="S2.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S2.SS2.SSS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.2.m2.1.1.1.cmml" xref="S2.SS2.SSS1.p2.2.m2.1.1">subscript</csymbol><apply id="S2.SS2.SSS1.p2.2.m2.1.1.2.cmml" xref="S2.SS2.SSS1.p2.2.m2.1.1.2"><ci id="S2.SS2.SSS1.p2.2.m2.1.1.2.1.cmml" xref="S2.SS2.SSS1.p2.2.m2.1.1.2.1">^</ci><ci id="S2.SS2.SSS1.p2.2.m2.1.1.2.2.cmml" xref="S2.SS2.SSS1.p2.2.m2.1.1.2.2">𝐡</ci></apply><ci id="S2.SS2.SSS1.p2.2.m2.1.1.3.cmml" xref="S2.SS2.SSS1.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.2.m2.1c">\widehat{\mathbf{h}}_{t}</annotation></semantics></math> is certainly classified into the target minority class <math id="S2.SS2.SSS1.p2.3.m3.1" class="ltx_Math" alttext="\mathbf{y}_{t}" display="inline"><semantics id="S2.SS2.SSS1.p2.3.m3.1a"><msub id="S2.SS2.SSS1.p2.3.m3.1.1" xref="S2.SS2.SSS1.p2.3.m3.1.1.cmml"><mi id="S2.SS2.SSS1.p2.3.m3.1.1.2" xref="S2.SS2.SSS1.p2.3.m3.1.1.2.cmml">𝐲</mi><mi id="S2.SS2.SSS1.p2.3.m3.1.1.3" xref="S2.SS2.SSS1.p2.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.3.m3.1b"><apply id="S2.SS2.SSS1.p2.3.m3.1.1.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.3.m3.1.1.1.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p2.3.m3.1.1.2.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.1.2">𝐲</ci><ci id="S2.SS2.SSS1.p2.3.m3.1.1.3.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.3.m3.1c">\mathbf{y}_{t}</annotation></semantics></math>. Therefore, we check out its prediction confidence of <math id="S2.SS2.SSS1.p2.4.m4.1" class="ltx_Math" alttext="\mathbf{y}_{t}" display="inline"><semantics id="S2.SS2.SSS1.p2.4.m4.1a"><msub id="S2.SS2.SSS1.p2.4.m4.1.1" xref="S2.SS2.SSS1.p2.4.m4.1.1.cmml"><mi id="S2.SS2.SSS1.p2.4.m4.1.1.2" xref="S2.SS2.SSS1.p2.4.m4.1.1.2.cmml">𝐲</mi><mi id="S2.SS2.SSS1.p2.4.m4.1.1.3" xref="S2.SS2.SSS1.p2.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.4.m4.1b"><apply id="S2.SS2.SSS1.p2.4.m4.1.1.cmml" xref="S2.SS2.SSS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.4.m4.1.1.1.cmml" xref="S2.SS2.SSS1.p2.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p2.4.m4.1.1.2.cmml" xref="S2.SS2.SSS1.p2.4.m4.1.1.2">𝐲</ci><ci id="S2.SS2.SSS1.p2.4.m4.1.1.3.cmml" xref="S2.SS2.SSS1.p2.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.4.m4.1c">\mathbf{y}_{t}</annotation></semantics></math> and consider if it can be used for personalized training. We accept all transformed features whose prediction confidence higher than a threshold <math id="S2.SS2.SSS1.p2.5.m5.1" class="ltx_Math" alttext="p_{d}" display="inline"><semantics id="S2.SS2.SSS1.p2.5.m5.1a"><msub id="S2.SS2.SSS1.p2.5.m5.1.1" xref="S2.SS2.SSS1.p2.5.m5.1.1.cmml"><mi id="S2.SS2.SSS1.p2.5.m5.1.1.2" xref="S2.SS2.SSS1.p2.5.m5.1.1.2.cmml">p</mi><mi id="S2.SS2.SSS1.p2.5.m5.1.1.3" xref="S2.SS2.SSS1.p2.5.m5.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.5.m5.1b"><apply id="S2.SS2.SSS1.p2.5.m5.1.1.cmml" xref="S2.SS2.SSS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.5.m5.1.1.1.cmml" xref="S2.SS2.SSS1.p2.5.m5.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p2.5.m5.1.1.2.cmml" xref="S2.SS2.SSS1.p2.5.m5.1.1.2">𝑝</ci><ci id="S2.SS2.SSS1.p2.5.m5.1.1.3.cmml" xref="S2.SS2.SSS1.p2.5.m5.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.5.m5.1c">p_{d}</annotation></semantics></math> called <span id="S2.SS2.SSS1.p2.9.1" class="ltx_text ltx_font_italic">drop probability</span> in FedAFA. We also empirically validate the influence of <math id="S2.SS2.SSS1.p2.6.m6.1" class="ltx_Math" alttext="p_{d}" display="inline"><semantics id="S2.SS2.SSS1.p2.6.m6.1a"><msub id="S2.SS2.SSS1.p2.6.m6.1.1" xref="S2.SS2.SSS1.p2.6.m6.1.1.cmml"><mi id="S2.SS2.SSS1.p2.6.m6.1.1.2" xref="S2.SS2.SSS1.p2.6.m6.1.1.2.cmml">p</mi><mi id="S2.SS2.SSS1.p2.6.m6.1.1.3" xref="S2.SS2.SSS1.p2.6.m6.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.6.m6.1b"><apply id="S2.SS2.SSS1.p2.6.m6.1.1.cmml" xref="S2.SS2.SSS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.6.m6.1.1.1.cmml" xref="S2.SS2.SSS1.p2.6.m6.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p2.6.m6.1.1.2.cmml" xref="S2.SS2.SSS1.p2.6.m6.1.1.2">𝑝</ci><ci id="S2.SS2.SSS1.p2.6.m6.1.1.3.cmml" xref="S2.SS2.SSS1.p2.6.m6.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.6.m6.1c">p_{d}</annotation></semantics></math> in Section <a href="#S3.SS3" title="3.3 Effects of Hyperparameters ‣ 3 Experiments ‣ Personalized Federated Learning on Long-Tailed Data via Adversarial Feature Augmentation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>. After selection by the drop probability, we put the selected generated features <math id="S2.SS2.SSS1.p2.7.m7.2" class="ltx_Math" alttext="(\widehat{\mathbf{h}}_{t},\mathbf{y}_{t})" display="inline"><semantics id="S2.SS2.SSS1.p2.7.m7.2a"><mrow id="S2.SS2.SSS1.p2.7.m7.2.2.2" xref="S2.SS2.SSS1.p2.7.m7.2.2.3.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p2.7.m7.2.2.2.3" xref="S2.SS2.SSS1.p2.7.m7.2.2.3.cmml">(</mo><msub id="S2.SS2.SSS1.p2.7.m7.1.1.1.1" xref="S2.SS2.SSS1.p2.7.m7.1.1.1.1.cmml"><mover accent="true" id="S2.SS2.SSS1.p2.7.m7.1.1.1.1.2" xref="S2.SS2.SSS1.p2.7.m7.1.1.1.1.2.cmml"><mi id="S2.SS2.SSS1.p2.7.m7.1.1.1.1.2.2" xref="S2.SS2.SSS1.p2.7.m7.1.1.1.1.2.2.cmml">𝐡</mi><mo id="S2.SS2.SSS1.p2.7.m7.1.1.1.1.2.1" xref="S2.SS2.SSS1.p2.7.m7.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS2.SSS1.p2.7.m7.1.1.1.1.3" xref="S2.SS2.SSS1.p2.7.m7.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS2.SSS1.p2.7.m7.2.2.2.4" xref="S2.SS2.SSS1.p2.7.m7.2.2.3.cmml">,</mo><msub id="S2.SS2.SSS1.p2.7.m7.2.2.2.2" xref="S2.SS2.SSS1.p2.7.m7.2.2.2.2.cmml"><mi id="S2.SS2.SSS1.p2.7.m7.2.2.2.2.2" xref="S2.SS2.SSS1.p2.7.m7.2.2.2.2.2.cmml">𝐲</mi><mi id="S2.SS2.SSS1.p2.7.m7.2.2.2.2.3" xref="S2.SS2.SSS1.p2.7.m7.2.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="S2.SS2.SSS1.p2.7.m7.2.2.2.5" xref="S2.SS2.SSS1.p2.7.m7.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.7.m7.2b"><interval closure="open" id="S2.SS2.SSS1.p2.7.m7.2.2.3.cmml" xref="S2.SS2.SSS1.p2.7.m7.2.2.2"><apply id="S2.SS2.SSS1.p2.7.m7.1.1.1.1.cmml" xref="S2.SS2.SSS1.p2.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.7.m7.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p2.7.m7.1.1.1.1">subscript</csymbol><apply id="S2.SS2.SSS1.p2.7.m7.1.1.1.1.2.cmml" xref="S2.SS2.SSS1.p2.7.m7.1.1.1.1.2"><ci id="S2.SS2.SSS1.p2.7.m7.1.1.1.1.2.1.cmml" xref="S2.SS2.SSS1.p2.7.m7.1.1.1.1.2.1">^</ci><ci id="S2.SS2.SSS1.p2.7.m7.1.1.1.1.2.2.cmml" xref="S2.SS2.SSS1.p2.7.m7.1.1.1.1.2.2">𝐡</ci></apply><ci id="S2.SS2.SSS1.p2.7.m7.1.1.1.1.3.cmml" xref="S2.SS2.SSS1.p2.7.m7.1.1.1.1.3">𝑡</ci></apply><apply id="S2.SS2.SSS1.p2.7.m7.2.2.2.2.cmml" xref="S2.SS2.SSS1.p2.7.m7.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.7.m7.2.2.2.2.1.cmml" xref="S2.SS2.SSS1.p2.7.m7.2.2.2.2">subscript</csymbol><ci id="S2.SS2.SSS1.p2.7.m7.2.2.2.2.2.cmml" xref="S2.SS2.SSS1.p2.7.m7.2.2.2.2.2">𝐲</ci><ci id="S2.SS2.SSS1.p2.7.m7.2.2.2.2.3.cmml" xref="S2.SS2.SSS1.p2.7.m7.2.2.2.2.3">𝑡</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.7.m7.2c">(\widehat{\mathbf{h}}_{t},\mathbf{y}_{t})</annotation></semantics></math>, as well as the source majority class features <math id="S2.SS2.SSS1.p2.8.m8.2" class="ltx_Math" alttext="(\mathbf{h}_{s},\mathbf{y}_{s})" display="inline"><semantics id="S2.SS2.SSS1.p2.8.m8.2a"><mrow id="S2.SS2.SSS1.p2.8.m8.2.2.2" xref="S2.SS2.SSS1.p2.8.m8.2.2.3.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p2.8.m8.2.2.2.3" xref="S2.SS2.SSS1.p2.8.m8.2.2.3.cmml">(</mo><msub id="S2.SS2.SSS1.p2.8.m8.1.1.1.1" xref="S2.SS2.SSS1.p2.8.m8.1.1.1.1.cmml"><mi id="S2.SS2.SSS1.p2.8.m8.1.1.1.1.2" xref="S2.SS2.SSS1.p2.8.m8.1.1.1.1.2.cmml">𝐡</mi><mi id="S2.SS2.SSS1.p2.8.m8.1.1.1.1.3" xref="S2.SS2.SSS1.p2.8.m8.1.1.1.1.3.cmml">s</mi></msub><mo id="S2.SS2.SSS1.p2.8.m8.2.2.2.4" xref="S2.SS2.SSS1.p2.8.m8.2.2.3.cmml">,</mo><msub id="S2.SS2.SSS1.p2.8.m8.2.2.2.2" xref="S2.SS2.SSS1.p2.8.m8.2.2.2.2.cmml"><mi id="S2.SS2.SSS1.p2.8.m8.2.2.2.2.2" xref="S2.SS2.SSS1.p2.8.m8.2.2.2.2.2.cmml">𝐲</mi><mi id="S2.SS2.SSS1.p2.8.m8.2.2.2.2.3" xref="S2.SS2.SSS1.p2.8.m8.2.2.2.2.3.cmml">s</mi></msub><mo stretchy="false" id="S2.SS2.SSS1.p2.8.m8.2.2.2.5" xref="S2.SS2.SSS1.p2.8.m8.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.8.m8.2b"><interval closure="open" id="S2.SS2.SSS1.p2.8.m8.2.2.3.cmml" xref="S2.SS2.SSS1.p2.8.m8.2.2.2"><apply id="S2.SS2.SSS1.p2.8.m8.1.1.1.1.cmml" xref="S2.SS2.SSS1.p2.8.m8.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.8.m8.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p2.8.m8.1.1.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p2.8.m8.1.1.1.1.2.cmml" xref="S2.SS2.SSS1.p2.8.m8.1.1.1.1.2">𝐡</ci><ci id="S2.SS2.SSS1.p2.8.m8.1.1.1.1.3.cmml" xref="S2.SS2.SSS1.p2.8.m8.1.1.1.1.3">𝑠</ci></apply><apply id="S2.SS2.SSS1.p2.8.m8.2.2.2.2.cmml" xref="S2.SS2.SSS1.p2.8.m8.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.8.m8.2.2.2.2.1.cmml" xref="S2.SS2.SSS1.p2.8.m8.2.2.2.2">subscript</csymbol><ci id="S2.SS2.SSS1.p2.8.m8.2.2.2.2.2.cmml" xref="S2.SS2.SSS1.p2.8.m8.2.2.2.2.2">𝐲</ci><ci id="S2.SS2.SSS1.p2.8.m8.2.2.2.2.3.cmml" xref="S2.SS2.SSS1.p2.8.m8.2.2.2.2.3">𝑠</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.8.m8.2c">(\mathbf{h}_{s},\mathbf{y}_{s})</annotation></semantics></math> into a set <math id="S2.SS2.SSS1.p2.9.m9.1" class="ltx_Math" alttext="\mathcal{G}_{k}" display="inline"><semantics id="S2.SS2.SSS1.p2.9.m9.1a"><msub id="S2.SS2.SSS1.p2.9.m9.1.1" xref="S2.SS2.SSS1.p2.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS1.p2.9.m9.1.1.2" xref="S2.SS2.SSS1.p2.9.m9.1.1.2.cmml">𝒢</mi><mi id="S2.SS2.SSS1.p2.9.m9.1.1.3" xref="S2.SS2.SSS1.p2.9.m9.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.9.m9.1b"><apply id="S2.SS2.SSS1.p2.9.m9.1.1.cmml" xref="S2.SS2.SSS1.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.9.m9.1.1.1.cmml" xref="S2.SS2.SSS1.p2.9.m9.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p2.9.m9.1.1.2.cmml" xref="S2.SS2.SSS1.p2.9.m9.1.1.2">𝒢</ci><ci id="S2.SS2.SSS1.p2.9.m9.1.1.3.cmml" xref="S2.SS2.SSS1.p2.9.m9.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.9.m9.1c">\mathcal{G}_{k}</annotation></semantics></math> for personalized training.</p>
</div>
</section>
<section id="S2.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.2 </span>Personalized Model Optimization</h4>

<div id="S2.SS2.SSS2.p1" class="ltx_para">
<p id="S2.SS2.SSS2.p1.10" class="ltx_p">One potential risk of using the above feature augmentation method is that it may damage the performance of the source majority classes. While the high-quality generated features of the target minority class <math id="S2.SS2.SSS2.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{y}_{t}" display="inline"><semantics id="S2.SS2.SSS2.p1.1.m1.1a"><msub id="S2.SS2.SSS2.p1.1.m1.1.1" xref="S2.SS2.SSS2.p1.1.m1.1.1.cmml"><mi id="S2.SS2.SSS2.p1.1.m1.1.1.2" xref="S2.SS2.SSS2.p1.1.m1.1.1.2.cmml">𝐲</mi><mi id="S2.SS2.SSS2.p1.1.m1.1.1.3" xref="S2.SS2.SSS2.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.1.m1.1b"><apply id="S2.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1.2">𝐲</ci><ci id="S2.SS2.SSS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.1.m1.1c">\mathbf{y}_{t}</annotation></semantics></math> enhance the performance of the local minority classes, some original samples in the source majority class <math id="S2.SS2.SSS2.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{y}_{s}" display="inline"><semantics id="S2.SS2.SSS2.p1.2.m2.1a"><msub id="S2.SS2.SSS2.p1.2.m2.1.1" xref="S2.SS2.SSS2.p1.2.m2.1.1.cmml"><mi id="S2.SS2.SSS2.p1.2.m2.1.1.2" xref="S2.SS2.SSS2.p1.2.m2.1.1.2.cmml">𝐲</mi><mi id="S2.SS2.SSS2.p1.2.m2.1.1.3" xref="S2.SS2.SSS2.p1.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.2.m2.1b"><apply id="S2.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S2.SS2.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.2.m2.1.1.1.cmml" xref="S2.SS2.SSS2.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p1.2.m2.1.1.2.cmml" xref="S2.SS2.SSS2.p1.2.m2.1.1.2">𝐲</ci><ci id="S2.SS2.SSS2.p1.2.m2.1.1.3.cmml" xref="S2.SS2.SSS2.p1.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.2.m2.1c">\mathbf{y}_{s}</annotation></semantics></math>, which are used for augmentation, are likely to be misclassified to the target minority class <math id="S2.SS2.SSS2.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{y}_{t}" display="inline"><semantics id="S2.SS2.SSS2.p1.3.m3.1a"><msub id="S2.SS2.SSS2.p1.3.m3.1.1" xref="S2.SS2.SSS2.p1.3.m3.1.1.cmml"><mi id="S2.SS2.SSS2.p1.3.m3.1.1.2" xref="S2.SS2.SSS2.p1.3.m3.1.1.2.cmml">𝐲</mi><mi id="S2.SS2.SSS2.p1.3.m3.1.1.3" xref="S2.SS2.SSS2.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.3.m3.1b"><apply id="S2.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.3.m3.1.1.1.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p1.3.m3.1.1.2.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1.2">𝐲</ci><ci id="S2.SS2.SSS2.p1.3.m3.1.1.3.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.3.m3.1c">\mathbf{y}_{t}</annotation></semantics></math>. This is because the original and generated features <math id="S2.SS2.SSS2.p1.4.m4.1" class="ltx_Math" alttext="\mathbf{h}_{s}" display="inline"><semantics id="S2.SS2.SSS2.p1.4.m4.1a"><msub id="S2.SS2.SSS2.p1.4.m4.1.1" xref="S2.SS2.SSS2.p1.4.m4.1.1.cmml"><mi id="S2.SS2.SSS2.p1.4.m4.1.1.2" xref="S2.SS2.SSS2.p1.4.m4.1.1.2.cmml">𝐡</mi><mi id="S2.SS2.SSS2.p1.4.m4.1.1.3" xref="S2.SS2.SSS2.p1.4.m4.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.4.m4.1b"><apply id="S2.SS2.SSS2.p1.4.m4.1.1.cmml" xref="S2.SS2.SSS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.4.m4.1.1.1.cmml" xref="S2.SS2.SSS2.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p1.4.m4.1.1.2.cmml" xref="S2.SS2.SSS2.p1.4.m4.1.1.2">𝐡</ci><ci id="S2.SS2.SSS2.p1.4.m4.1.1.3.cmml" xref="S2.SS2.SSS2.p1.4.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.4.m4.1c">\mathbf{h}_{s}</annotation></semantics></math> and <math id="S2.SS2.SSS2.p1.5.m5.1" class="ltx_Math" alttext="\widehat{\mathbf{h}}_{t}" display="inline"><semantics id="S2.SS2.SSS2.p1.5.m5.1a"><msub id="S2.SS2.SSS2.p1.5.m5.1.1" xref="S2.SS2.SSS2.p1.5.m5.1.1.cmml"><mover accent="true" id="S2.SS2.SSS2.p1.5.m5.1.1.2" xref="S2.SS2.SSS2.p1.5.m5.1.1.2.cmml"><mi id="S2.SS2.SSS2.p1.5.m5.1.1.2.2" xref="S2.SS2.SSS2.p1.5.m5.1.1.2.2.cmml">𝐡</mi><mo id="S2.SS2.SSS2.p1.5.m5.1.1.2.1" xref="S2.SS2.SSS2.p1.5.m5.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS2.SSS2.p1.5.m5.1.1.3" xref="S2.SS2.SSS2.p1.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.5.m5.1b"><apply id="S2.SS2.SSS2.p1.5.m5.1.1.cmml" xref="S2.SS2.SSS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.5.m5.1.1.1.cmml" xref="S2.SS2.SSS2.p1.5.m5.1.1">subscript</csymbol><apply id="S2.SS2.SSS2.p1.5.m5.1.1.2.cmml" xref="S2.SS2.SSS2.p1.5.m5.1.1.2"><ci id="S2.SS2.SSS2.p1.5.m5.1.1.2.1.cmml" xref="S2.SS2.SSS2.p1.5.m5.1.1.2.1">^</ci><ci id="S2.SS2.SSS2.p1.5.m5.1.1.2.2.cmml" xref="S2.SS2.SSS2.p1.5.m5.1.1.2.2">𝐡</ci></apply><ci id="S2.SS2.SSS2.p1.5.m5.1.1.3.cmml" xref="S2.SS2.SSS2.p1.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.5.m5.1c">\widehat{\mathbf{h}}_{t}</annotation></semantics></math> are still close in the feature space, although they can be classified into different classes. Therefore, to make the classification boundary separate the original and generated features, we proposed a new objective of the local personalized training <math id="S2.SS2.SSS2.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{L}_{AFA}" display="inline"><semantics id="S2.SS2.SSS2.p1.6.m6.1a"><msub id="S2.SS2.SSS2.p1.6.m6.1.1" xref="S2.SS2.SSS2.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p1.6.m6.1.1.2" xref="S2.SS2.SSS2.p1.6.m6.1.1.2.cmml">ℒ</mi><mrow id="S2.SS2.SSS2.p1.6.m6.1.1.3" xref="S2.SS2.SSS2.p1.6.m6.1.1.3.cmml"><mi id="S2.SS2.SSS2.p1.6.m6.1.1.3.2" xref="S2.SS2.SSS2.p1.6.m6.1.1.3.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS2.p1.6.m6.1.1.3.1" xref="S2.SS2.SSS2.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="S2.SS2.SSS2.p1.6.m6.1.1.3.3" xref="S2.SS2.SSS2.p1.6.m6.1.1.3.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS2.p1.6.m6.1.1.3.1a" xref="S2.SS2.SSS2.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="S2.SS2.SSS2.p1.6.m6.1.1.3.4" xref="S2.SS2.SSS2.p1.6.m6.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.6.m6.1b"><apply id="S2.SS2.SSS2.p1.6.m6.1.1.cmml" xref="S2.SS2.SSS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.6.m6.1.1.1.cmml" xref="S2.SS2.SSS2.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p1.6.m6.1.1.2.cmml" xref="S2.SS2.SSS2.p1.6.m6.1.1.2">ℒ</ci><apply id="S2.SS2.SSS2.p1.6.m6.1.1.3.cmml" xref="S2.SS2.SSS2.p1.6.m6.1.1.3"><times id="S2.SS2.SSS2.p1.6.m6.1.1.3.1.cmml" xref="S2.SS2.SSS2.p1.6.m6.1.1.3.1"></times><ci id="S2.SS2.SSS2.p1.6.m6.1.1.3.2.cmml" xref="S2.SS2.SSS2.p1.6.m6.1.1.3.2">𝐴</ci><ci id="S2.SS2.SSS2.p1.6.m6.1.1.3.3.cmml" xref="S2.SS2.SSS2.p1.6.m6.1.1.3.3">𝐹</ci><ci id="S2.SS2.SSS2.p1.6.m6.1.1.3.4.cmml" xref="S2.SS2.SSS2.p1.6.m6.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.6.m6.1c">\mathcal{L}_{AFA}</annotation></semantics></math> consisting of two parts: <math id="S2.SS2.SSS2.p1.7.m7.1" class="ltx_Math" alttext="\mathcal{L}_{gen}" display="inline"><semantics id="S2.SS2.SSS2.p1.7.m7.1a"><msub id="S2.SS2.SSS2.p1.7.m7.1.1" xref="S2.SS2.SSS2.p1.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p1.7.m7.1.1.2" xref="S2.SS2.SSS2.p1.7.m7.1.1.2.cmml">ℒ</mi><mrow id="S2.SS2.SSS2.p1.7.m7.1.1.3" xref="S2.SS2.SSS2.p1.7.m7.1.1.3.cmml"><mi id="S2.SS2.SSS2.p1.7.m7.1.1.3.2" xref="S2.SS2.SSS2.p1.7.m7.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS2.p1.7.m7.1.1.3.1" xref="S2.SS2.SSS2.p1.7.m7.1.1.3.1.cmml">​</mo><mi id="S2.SS2.SSS2.p1.7.m7.1.1.3.3" xref="S2.SS2.SSS2.p1.7.m7.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS2.p1.7.m7.1.1.3.1a" xref="S2.SS2.SSS2.p1.7.m7.1.1.3.1.cmml">​</mo><mi id="S2.SS2.SSS2.p1.7.m7.1.1.3.4" xref="S2.SS2.SSS2.p1.7.m7.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.7.m7.1b"><apply id="S2.SS2.SSS2.p1.7.m7.1.1.cmml" xref="S2.SS2.SSS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.7.m7.1.1.1.cmml" xref="S2.SS2.SSS2.p1.7.m7.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p1.7.m7.1.1.2.cmml" xref="S2.SS2.SSS2.p1.7.m7.1.1.2">ℒ</ci><apply id="S2.SS2.SSS2.p1.7.m7.1.1.3.cmml" xref="S2.SS2.SSS2.p1.7.m7.1.1.3"><times id="S2.SS2.SSS2.p1.7.m7.1.1.3.1.cmml" xref="S2.SS2.SSS2.p1.7.m7.1.1.3.1"></times><ci id="S2.SS2.SSS2.p1.7.m7.1.1.3.2.cmml" xref="S2.SS2.SSS2.p1.7.m7.1.1.3.2">𝑔</ci><ci id="S2.SS2.SSS2.p1.7.m7.1.1.3.3.cmml" xref="S2.SS2.SSS2.p1.7.m7.1.1.3.3">𝑒</ci><ci id="S2.SS2.SSS2.p1.7.m7.1.1.3.4.cmml" xref="S2.SS2.SSS2.p1.7.m7.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.7.m7.1c">\mathcal{L}_{gen}</annotation></semantics></math> and <math id="S2.SS2.SSS2.p1.8.m8.1" class="ltx_Math" alttext="\mathcal{L}_{ori}" display="inline"><semantics id="S2.SS2.SSS2.p1.8.m8.1a"><msub id="S2.SS2.SSS2.p1.8.m8.1.1" xref="S2.SS2.SSS2.p1.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p1.8.m8.1.1.2" xref="S2.SS2.SSS2.p1.8.m8.1.1.2.cmml">ℒ</mi><mrow id="S2.SS2.SSS2.p1.8.m8.1.1.3" xref="S2.SS2.SSS2.p1.8.m8.1.1.3.cmml"><mi id="S2.SS2.SSS2.p1.8.m8.1.1.3.2" xref="S2.SS2.SSS2.p1.8.m8.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS2.p1.8.m8.1.1.3.1" xref="S2.SS2.SSS2.p1.8.m8.1.1.3.1.cmml">​</mo><mi id="S2.SS2.SSS2.p1.8.m8.1.1.3.3" xref="S2.SS2.SSS2.p1.8.m8.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS2.p1.8.m8.1.1.3.1a" xref="S2.SS2.SSS2.p1.8.m8.1.1.3.1.cmml">​</mo><mi id="S2.SS2.SSS2.p1.8.m8.1.1.3.4" xref="S2.SS2.SSS2.p1.8.m8.1.1.3.4.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.8.m8.1b"><apply id="S2.SS2.SSS2.p1.8.m8.1.1.cmml" xref="S2.SS2.SSS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.8.m8.1.1.1.cmml" xref="S2.SS2.SSS2.p1.8.m8.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p1.8.m8.1.1.2.cmml" xref="S2.SS2.SSS2.p1.8.m8.1.1.2">ℒ</ci><apply id="S2.SS2.SSS2.p1.8.m8.1.1.3.cmml" xref="S2.SS2.SSS2.p1.8.m8.1.1.3"><times id="S2.SS2.SSS2.p1.8.m8.1.1.3.1.cmml" xref="S2.SS2.SSS2.p1.8.m8.1.1.3.1"></times><ci id="S2.SS2.SSS2.p1.8.m8.1.1.3.2.cmml" xref="S2.SS2.SSS2.p1.8.m8.1.1.3.2">𝑜</ci><ci id="S2.SS2.SSS2.p1.8.m8.1.1.3.3.cmml" xref="S2.SS2.SSS2.p1.8.m8.1.1.3.3">𝑟</ci><ci id="S2.SS2.SSS2.p1.8.m8.1.1.3.4.cmml" xref="S2.SS2.SSS2.p1.8.m8.1.1.3.4">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.8.m8.1c">\mathcal{L}_{ori}</annotation></semantics></math>. They are the averaged training loss on the generated balanced feature set <math id="S2.SS2.SSS2.p1.9.m9.1" class="ltx_Math" alttext="\mathcal{G}_{k}^{bal}" display="inline"><semantics id="S2.SS2.SSS2.p1.9.m9.1a"><msubsup id="S2.SS2.SSS2.p1.9.m9.1.1" xref="S2.SS2.SSS2.p1.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p1.9.m9.1.1.2.2" xref="S2.SS2.SSS2.p1.9.m9.1.1.2.2.cmml">𝒢</mi><mi id="S2.SS2.SSS2.p1.9.m9.1.1.2.3" xref="S2.SS2.SSS2.p1.9.m9.1.1.2.3.cmml">k</mi><mrow id="S2.SS2.SSS2.p1.9.m9.1.1.3" xref="S2.SS2.SSS2.p1.9.m9.1.1.3.cmml"><mi id="S2.SS2.SSS2.p1.9.m9.1.1.3.2" xref="S2.SS2.SSS2.p1.9.m9.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS2.p1.9.m9.1.1.3.1" xref="S2.SS2.SSS2.p1.9.m9.1.1.3.1.cmml">​</mo><mi id="S2.SS2.SSS2.p1.9.m9.1.1.3.3" xref="S2.SS2.SSS2.p1.9.m9.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS2.p1.9.m9.1.1.3.1a" xref="S2.SS2.SSS2.p1.9.m9.1.1.3.1.cmml">​</mo><mi id="S2.SS2.SSS2.p1.9.m9.1.1.3.4" xref="S2.SS2.SSS2.p1.9.m9.1.1.3.4.cmml">l</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.9.m9.1b"><apply id="S2.SS2.SSS2.p1.9.m9.1.1.cmml" xref="S2.SS2.SSS2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.9.m9.1.1.1.cmml" xref="S2.SS2.SSS2.p1.9.m9.1.1">superscript</csymbol><apply id="S2.SS2.SSS2.p1.9.m9.1.1.2.cmml" xref="S2.SS2.SSS2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.9.m9.1.1.2.1.cmml" xref="S2.SS2.SSS2.p1.9.m9.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p1.9.m9.1.1.2.2.cmml" xref="S2.SS2.SSS2.p1.9.m9.1.1.2.2">𝒢</ci><ci id="S2.SS2.SSS2.p1.9.m9.1.1.2.3.cmml" xref="S2.SS2.SSS2.p1.9.m9.1.1.2.3">𝑘</ci></apply><apply id="S2.SS2.SSS2.p1.9.m9.1.1.3.cmml" xref="S2.SS2.SSS2.p1.9.m9.1.1.3"><times id="S2.SS2.SSS2.p1.9.m9.1.1.3.1.cmml" xref="S2.SS2.SSS2.p1.9.m9.1.1.3.1"></times><ci id="S2.SS2.SSS2.p1.9.m9.1.1.3.2.cmml" xref="S2.SS2.SSS2.p1.9.m9.1.1.3.2">𝑏</ci><ci id="S2.SS2.SSS2.p1.9.m9.1.1.3.3.cmml" xref="S2.SS2.SSS2.p1.9.m9.1.1.3.3">𝑎</ci><ci id="S2.SS2.SSS2.p1.9.m9.1.1.3.4.cmml" xref="S2.SS2.SSS2.p1.9.m9.1.1.3.4">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.9.m9.1c">\mathcal{G}_{k}^{bal}</annotation></semantics></math> and the class-balanced local dataset <math id="S2.SS2.SSS2.p1.10.m10.1" class="ltx_Math" alttext="\mathcal{D}_{k}^{bal}" display="inline"><semantics id="S2.SS2.SSS2.p1.10.m10.1a"><msubsup id="S2.SS2.SSS2.p1.10.m10.1.1" xref="S2.SS2.SSS2.p1.10.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p1.10.m10.1.1.2.2" xref="S2.SS2.SSS2.p1.10.m10.1.1.2.2.cmml">𝒟</mi><mi id="S2.SS2.SSS2.p1.10.m10.1.1.2.3" xref="S2.SS2.SSS2.p1.10.m10.1.1.2.3.cmml">k</mi><mrow id="S2.SS2.SSS2.p1.10.m10.1.1.3" xref="S2.SS2.SSS2.p1.10.m10.1.1.3.cmml"><mi id="S2.SS2.SSS2.p1.10.m10.1.1.3.2" xref="S2.SS2.SSS2.p1.10.m10.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS2.p1.10.m10.1.1.3.1" xref="S2.SS2.SSS2.p1.10.m10.1.1.3.1.cmml">​</mo><mi id="S2.SS2.SSS2.p1.10.m10.1.1.3.3" xref="S2.SS2.SSS2.p1.10.m10.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS2.p1.10.m10.1.1.3.1a" xref="S2.SS2.SSS2.p1.10.m10.1.1.3.1.cmml">​</mo><mi id="S2.SS2.SSS2.p1.10.m10.1.1.3.4" xref="S2.SS2.SSS2.p1.10.m10.1.1.3.4.cmml">l</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.10.m10.1b"><apply id="S2.SS2.SSS2.p1.10.m10.1.1.cmml" xref="S2.SS2.SSS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.10.m10.1.1.1.cmml" xref="S2.SS2.SSS2.p1.10.m10.1.1">superscript</csymbol><apply id="S2.SS2.SSS2.p1.10.m10.1.1.2.cmml" xref="S2.SS2.SSS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.10.m10.1.1.2.1.cmml" xref="S2.SS2.SSS2.p1.10.m10.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p1.10.m10.1.1.2.2.cmml" xref="S2.SS2.SSS2.p1.10.m10.1.1.2.2">𝒟</ci><ci id="S2.SS2.SSS2.p1.10.m10.1.1.2.3.cmml" xref="S2.SS2.SSS2.p1.10.m10.1.1.2.3">𝑘</ci></apply><apply id="S2.SS2.SSS2.p1.10.m10.1.1.3.cmml" xref="S2.SS2.SSS2.p1.10.m10.1.1.3"><times id="S2.SS2.SSS2.p1.10.m10.1.1.3.1.cmml" xref="S2.SS2.SSS2.p1.10.m10.1.1.3.1"></times><ci id="S2.SS2.SSS2.p1.10.m10.1.1.3.2.cmml" xref="S2.SS2.SSS2.p1.10.m10.1.1.3.2">𝑏</ci><ci id="S2.SS2.SSS2.p1.10.m10.1.1.3.3.cmml" xref="S2.SS2.SSS2.p1.10.m10.1.1.3.3">𝑎</ci><ci id="S2.SS2.SSS2.p1.10.m10.1.1.3.4.cmml" xref="S2.SS2.SSS2.p1.10.m10.1.1.3.4">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.10.m10.1c">\mathcal{D}_{k}^{bal}</annotation></semantics></math>, respectively:</p>
<table id="S4.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E4.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{gen}" display="inline"><semantics id="S2.E4.m1.1a"><msub id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.1.1.2" xref="S2.E4.m1.1.1.2.cmml">ℒ</mi><mrow id="S2.E4.m1.1.1.3" xref="S2.E4.m1.1.1.3.cmml"><mi id="S2.E4.m1.1.1.3.2" xref="S2.E4.m1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.1.1.3.1" xref="S2.E4.m1.1.1.3.1.cmml">​</mo><mi id="S2.E4.m1.1.1.3.3" xref="S2.E4.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.1.1.3.1a" xref="S2.E4.m1.1.1.3.1.cmml">​</mo><mi id="S2.E4.m1.1.1.3.4" xref="S2.E4.m1.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.E4.m1.1b"><apply id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.cmml" xref="S2.E4.m1.1.1">subscript</csymbol><ci id="S2.E4.m1.1.1.2.cmml" xref="S2.E4.m1.1.1.2">ℒ</ci><apply id="S2.E4.m1.1.1.3.cmml" xref="S2.E4.m1.1.1.3"><times id="S2.E4.m1.1.1.3.1.cmml" xref="S2.E4.m1.1.1.3.1"></times><ci id="S2.E4.m1.1.1.3.2.cmml" xref="S2.E4.m1.1.1.3.2">𝑔</ci><ci id="S2.E4.m1.1.1.3.3.cmml" xref="S2.E4.m1.1.1.3.3">𝑒</ci><ci id="S2.E4.m1.1.1.3.4.cmml" xref="S2.E4.m1.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.1c">\displaystyle\mathcal{L}_{gen}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E4.m2.6" class="ltx_Math" alttext="\displaystyle=\frac{1}{|\mathcal{G}^{bal}_{k}|}\sum_{(\mathbf{h},\mathbf{y})\in\mathcal{G}^{bal}_{k}}\ell(\mathbf{y},f(\mathbf{h};\mathbf{v}_{k}))," display="inline"><semantics id="S2.E4.m2.6a"><mrow id="S2.E4.m2.6.6.1" xref="S2.E4.m2.6.6.1.1.cmml"><mrow id="S2.E4.m2.6.6.1.1" xref="S2.E4.m2.6.6.1.1.cmml"><mi id="S2.E4.m2.6.6.1.1.3" xref="S2.E4.m2.6.6.1.1.3.cmml"></mi><mo id="S2.E4.m2.6.6.1.1.2" xref="S2.E4.m2.6.6.1.1.2.cmml">=</mo><mrow id="S2.E4.m2.6.6.1.1.1" xref="S2.E4.m2.6.6.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E4.m2.1.1" xref="S2.E4.m2.1.1.cmml"><mfrac id="S2.E4.m2.1.1a" xref="S2.E4.m2.1.1.cmml"><mn id="S2.E4.m2.1.1.3" xref="S2.E4.m2.1.1.3.cmml">1</mn><mrow id="S2.E4.m2.1.1.1.1" xref="S2.E4.m2.1.1.1.2.cmml"><mo stretchy="false" id="S2.E4.m2.1.1.1.1.2" xref="S2.E4.m2.1.1.1.2.1.cmml">|</mo><msubsup id="S2.E4.m2.1.1.1.1.1" xref="S2.E4.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m2.1.1.1.1.1.2.2" xref="S2.E4.m2.1.1.1.1.1.2.2.cmml">𝒢</mi><mi id="S2.E4.m2.1.1.1.1.1.3" xref="S2.E4.m2.1.1.1.1.1.3.cmml">k</mi><mrow id="S2.E4.m2.1.1.1.1.1.2.3" xref="S2.E4.m2.1.1.1.1.1.2.3.cmml"><mi id="S2.E4.m2.1.1.1.1.1.2.3.2" xref="S2.E4.m2.1.1.1.1.1.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S2.E4.m2.1.1.1.1.1.2.3.1" xref="S2.E4.m2.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.E4.m2.1.1.1.1.1.2.3.3" xref="S2.E4.m2.1.1.1.1.1.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.E4.m2.1.1.1.1.1.2.3.1a" xref="S2.E4.m2.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.E4.m2.1.1.1.1.1.2.3.4" xref="S2.E4.m2.1.1.1.1.1.2.3.4.cmml">l</mi></mrow></msubsup><mo stretchy="false" id="S2.E4.m2.1.1.1.1.3" xref="S2.E4.m2.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S2.E4.m2.6.6.1.1.1.2" xref="S2.E4.m2.6.6.1.1.1.2.cmml">​</mo><mrow id="S2.E4.m2.6.6.1.1.1.1" xref="S2.E4.m2.6.6.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E4.m2.6.6.1.1.1.1.2" xref="S2.E4.m2.6.6.1.1.1.1.2.cmml"><munder id="S2.E4.m2.6.6.1.1.1.1.2a" xref="S2.E4.m2.6.6.1.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E4.m2.6.6.1.1.1.1.2.2" xref="S2.E4.m2.6.6.1.1.1.1.2.2.cmml">∑</mo><mrow id="S2.E4.m2.3.3.2" xref="S2.E4.m2.3.3.2.cmml"><mrow id="S2.E4.m2.3.3.2.4.2" xref="S2.E4.m2.3.3.2.4.1.cmml"><mo stretchy="false" id="S2.E4.m2.3.3.2.4.2.1" xref="S2.E4.m2.3.3.2.4.1.cmml">(</mo><mi id="S2.E4.m2.2.2.1.1" xref="S2.E4.m2.2.2.1.1.cmml">𝐡</mi><mo id="S2.E4.m2.3.3.2.4.2.2" xref="S2.E4.m2.3.3.2.4.1.cmml">,</mo><mi id="S2.E4.m2.3.3.2.2" xref="S2.E4.m2.3.3.2.2.cmml">𝐲</mi><mo stretchy="false" id="S2.E4.m2.3.3.2.4.2.3" xref="S2.E4.m2.3.3.2.4.1.cmml">)</mo></mrow><mo id="S2.E4.m2.3.3.2.3" xref="S2.E4.m2.3.3.2.3.cmml">∈</mo><msubsup id="S2.E4.m2.3.3.2.5" xref="S2.E4.m2.3.3.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m2.3.3.2.5.2.2" xref="S2.E4.m2.3.3.2.5.2.2.cmml">𝒢</mi><mi id="S2.E4.m2.3.3.2.5.3" xref="S2.E4.m2.3.3.2.5.3.cmml">k</mi><mrow id="S2.E4.m2.3.3.2.5.2.3" xref="S2.E4.m2.3.3.2.5.2.3.cmml"><mi id="S2.E4.m2.3.3.2.5.2.3.2" xref="S2.E4.m2.3.3.2.5.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S2.E4.m2.3.3.2.5.2.3.1" xref="S2.E4.m2.3.3.2.5.2.3.1.cmml">​</mo><mi id="S2.E4.m2.3.3.2.5.2.3.3" xref="S2.E4.m2.3.3.2.5.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.E4.m2.3.3.2.5.2.3.1a" xref="S2.E4.m2.3.3.2.5.2.3.1.cmml">​</mo><mi id="S2.E4.m2.3.3.2.5.2.3.4" xref="S2.E4.m2.3.3.2.5.2.3.4.cmml">l</mi></mrow></msubsup></mrow></munder></mstyle><mrow id="S2.E4.m2.6.6.1.1.1.1.1" xref="S2.E4.m2.6.6.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S2.E4.m2.6.6.1.1.1.1.1.3" xref="S2.E4.m2.6.6.1.1.1.1.1.3.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S2.E4.m2.6.6.1.1.1.1.1.2" xref="S2.E4.m2.6.6.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E4.m2.6.6.1.1.1.1.1.1.1" xref="S2.E4.m2.6.6.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E4.m2.6.6.1.1.1.1.1.1.1.2" xref="S2.E4.m2.6.6.1.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E4.m2.5.5" xref="S2.E4.m2.5.5.cmml">𝐲</mi><mo id="S2.E4.m2.6.6.1.1.1.1.1.1.1.3" xref="S2.E4.m2.6.6.1.1.1.1.1.1.2.cmml">,</mo><mrow id="S2.E4.m2.6.6.1.1.1.1.1.1.1.1" xref="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.3" xref="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.2" xref="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1" xref="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E4.m2.4.4" xref="S2.E4.m2.4.4.cmml">𝐡</mi><mo id="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.1.2.cmml">;</mo><msub id="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐯</mi><mi id="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.4" xref="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E4.m2.6.6.1.1.1.1.1.1.1.4" xref="S2.E4.m2.6.6.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E4.m2.6.6.1.2" xref="S2.E4.m2.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m2.6b"><apply id="S2.E4.m2.6.6.1.1.cmml" xref="S2.E4.m2.6.6.1"><eq id="S2.E4.m2.6.6.1.1.2.cmml" xref="S2.E4.m2.6.6.1.1.2"></eq><csymbol cd="latexml" id="S2.E4.m2.6.6.1.1.3.cmml" xref="S2.E4.m2.6.6.1.1.3">absent</csymbol><apply id="S2.E4.m2.6.6.1.1.1.cmml" xref="S2.E4.m2.6.6.1.1.1"><times id="S2.E4.m2.6.6.1.1.1.2.cmml" xref="S2.E4.m2.6.6.1.1.1.2"></times><apply id="S2.E4.m2.1.1.cmml" xref="S2.E4.m2.1.1"><divide id="S2.E4.m2.1.1.2.cmml" xref="S2.E4.m2.1.1"></divide><cn type="integer" id="S2.E4.m2.1.1.3.cmml" xref="S2.E4.m2.1.1.3">1</cn><apply id="S2.E4.m2.1.1.1.2.cmml" xref="S2.E4.m2.1.1.1.1"><abs id="S2.E4.m2.1.1.1.2.1.cmml" xref="S2.E4.m2.1.1.1.1.2"></abs><apply id="S2.E4.m2.1.1.1.1.1.cmml" xref="S2.E4.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m2.1.1.1.1.1.1.cmml" xref="S2.E4.m2.1.1.1.1.1">subscript</csymbol><apply id="S2.E4.m2.1.1.1.1.1.2.cmml" xref="S2.E4.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m2.1.1.1.1.1.2.1.cmml" xref="S2.E4.m2.1.1.1.1.1">superscript</csymbol><ci id="S2.E4.m2.1.1.1.1.1.2.2.cmml" xref="S2.E4.m2.1.1.1.1.1.2.2">𝒢</ci><apply id="S2.E4.m2.1.1.1.1.1.2.3.cmml" xref="S2.E4.m2.1.1.1.1.1.2.3"><times id="S2.E4.m2.1.1.1.1.1.2.3.1.cmml" xref="S2.E4.m2.1.1.1.1.1.2.3.1"></times><ci id="S2.E4.m2.1.1.1.1.1.2.3.2.cmml" xref="S2.E4.m2.1.1.1.1.1.2.3.2">𝑏</ci><ci id="S2.E4.m2.1.1.1.1.1.2.3.3.cmml" xref="S2.E4.m2.1.1.1.1.1.2.3.3">𝑎</ci><ci id="S2.E4.m2.1.1.1.1.1.2.3.4.cmml" xref="S2.E4.m2.1.1.1.1.1.2.3.4">𝑙</ci></apply></apply><ci id="S2.E4.m2.1.1.1.1.1.3.cmml" xref="S2.E4.m2.1.1.1.1.1.3">𝑘</ci></apply></apply></apply><apply id="S2.E4.m2.6.6.1.1.1.1.cmml" xref="S2.E4.m2.6.6.1.1.1.1"><apply id="S2.E4.m2.6.6.1.1.1.1.2.cmml" xref="S2.E4.m2.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m2.6.6.1.1.1.1.2.1.cmml" xref="S2.E4.m2.6.6.1.1.1.1.2">subscript</csymbol><sum id="S2.E4.m2.6.6.1.1.1.1.2.2.cmml" xref="S2.E4.m2.6.6.1.1.1.1.2.2"></sum><apply id="S2.E4.m2.3.3.2.cmml" xref="S2.E4.m2.3.3.2"><in id="S2.E4.m2.3.3.2.3.cmml" xref="S2.E4.m2.3.3.2.3"></in><interval closure="open" id="S2.E4.m2.3.3.2.4.1.cmml" xref="S2.E4.m2.3.3.2.4.2"><ci id="S2.E4.m2.2.2.1.1.cmml" xref="S2.E4.m2.2.2.1.1">𝐡</ci><ci id="S2.E4.m2.3.3.2.2.cmml" xref="S2.E4.m2.3.3.2.2">𝐲</ci></interval><apply id="S2.E4.m2.3.3.2.5.cmml" xref="S2.E4.m2.3.3.2.5"><csymbol cd="ambiguous" id="S2.E4.m2.3.3.2.5.1.cmml" xref="S2.E4.m2.3.3.2.5">subscript</csymbol><apply id="S2.E4.m2.3.3.2.5.2.cmml" xref="S2.E4.m2.3.3.2.5"><csymbol cd="ambiguous" id="S2.E4.m2.3.3.2.5.2.1.cmml" xref="S2.E4.m2.3.3.2.5">superscript</csymbol><ci id="S2.E4.m2.3.3.2.5.2.2.cmml" xref="S2.E4.m2.3.3.2.5.2.2">𝒢</ci><apply id="S2.E4.m2.3.3.2.5.2.3.cmml" xref="S2.E4.m2.3.3.2.5.2.3"><times id="S2.E4.m2.3.3.2.5.2.3.1.cmml" xref="S2.E4.m2.3.3.2.5.2.3.1"></times><ci id="S2.E4.m2.3.3.2.5.2.3.2.cmml" xref="S2.E4.m2.3.3.2.5.2.3.2">𝑏</ci><ci id="S2.E4.m2.3.3.2.5.2.3.3.cmml" xref="S2.E4.m2.3.3.2.5.2.3.3">𝑎</ci><ci id="S2.E4.m2.3.3.2.5.2.3.4.cmml" xref="S2.E4.m2.3.3.2.5.2.3.4">𝑙</ci></apply></apply><ci id="S2.E4.m2.3.3.2.5.3.cmml" xref="S2.E4.m2.3.3.2.5.3">𝑘</ci></apply></apply></apply><apply id="S2.E4.m2.6.6.1.1.1.1.1.cmml" xref="S2.E4.m2.6.6.1.1.1.1.1"><times id="S2.E4.m2.6.6.1.1.1.1.1.2.cmml" xref="S2.E4.m2.6.6.1.1.1.1.1.2"></times><ci id="S2.E4.m2.6.6.1.1.1.1.1.3.cmml" xref="S2.E4.m2.6.6.1.1.1.1.1.3">ℓ</ci><interval closure="open" id="S2.E4.m2.6.6.1.1.1.1.1.1.2.cmml" xref="S2.E4.m2.6.6.1.1.1.1.1.1.1"><ci id="S2.E4.m2.5.5.cmml" xref="S2.E4.m2.5.5">𝐲</ci><apply id="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m2.6.6.1.1.1.1.1.1.1.1"><times id="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.2"></times><ci id="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.3">𝑓</ci><list id="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1"><ci id="S2.E4.m2.4.4.cmml" xref="S2.E4.m2.4.4">𝐡</ci><apply id="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1.2">𝐯</ci><ci id="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></list></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m2.6c">\displaystyle=\frac{1}{|\mathcal{G}^{bal}_{k}|}\sum_{(\mathbf{h},\mathbf{y})\in\mathcal{G}^{bal}_{k}}\ell(\mathbf{y},f(\mathbf{h};\mathbf{v}_{k})),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
<tbody id="S2.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E5.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{ori}" display="inline"><semantics id="S2.E5.m1.1a"><msub id="S2.E5.m1.1.1" xref="S2.E5.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E5.m1.1.1.2" xref="S2.E5.m1.1.1.2.cmml">ℒ</mi><mrow id="S2.E5.m1.1.1.3" xref="S2.E5.m1.1.1.3.cmml"><mi id="S2.E5.m1.1.1.3.2" xref="S2.E5.m1.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.E5.m1.1.1.3.1" xref="S2.E5.m1.1.1.3.1.cmml">​</mo><mi id="S2.E5.m1.1.1.3.3" xref="S2.E5.m1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.E5.m1.1.1.3.1a" xref="S2.E5.m1.1.1.3.1.cmml">​</mo><mi id="S2.E5.m1.1.1.3.4" xref="S2.E5.m1.1.1.3.4.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.E5.m1.1b"><apply id="S2.E5.m1.1.1.cmml" xref="S2.E5.m1.1.1"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.cmml" xref="S2.E5.m1.1.1">subscript</csymbol><ci id="S2.E5.m1.1.1.2.cmml" xref="S2.E5.m1.1.1.2">ℒ</ci><apply id="S2.E5.m1.1.1.3.cmml" xref="S2.E5.m1.1.1.3"><times id="S2.E5.m1.1.1.3.1.cmml" xref="S2.E5.m1.1.1.3.1"></times><ci id="S2.E5.m1.1.1.3.2.cmml" xref="S2.E5.m1.1.1.3.2">𝑜</ci><ci id="S2.E5.m1.1.1.3.3.cmml" xref="S2.E5.m1.1.1.3.3">𝑟</ci><ci id="S2.E5.m1.1.1.3.4.cmml" xref="S2.E5.m1.1.1.3.4">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.1c">\displaystyle\mathcal{L}_{ori}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E5.m2.7" class="ltx_Math" alttext="\displaystyle=\frac{1}{|\mathcal{D}^{bal}_{k}|}\sum_{(\mathbf{x},\mathbf{y})\in\mathcal{D}^{bal}_{k}}\ell(\mathbf{y},f(g(\mathbf{x};\mathbf{u});\mathbf{\mathbf{v}}_{k}))," display="inline"><semantics id="S2.E5.m2.7a"><mrow id="S2.E5.m2.7.7.1" xref="S2.E5.m2.7.7.1.1.cmml"><mrow id="S2.E5.m2.7.7.1.1" xref="S2.E5.m2.7.7.1.1.cmml"><mi id="S2.E5.m2.7.7.1.1.3" xref="S2.E5.m2.7.7.1.1.3.cmml"></mi><mo id="S2.E5.m2.7.7.1.1.2" xref="S2.E5.m2.7.7.1.1.2.cmml">=</mo><mrow id="S2.E5.m2.7.7.1.1.1" xref="S2.E5.m2.7.7.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E5.m2.1.1" xref="S2.E5.m2.1.1.cmml"><mfrac id="S2.E5.m2.1.1a" xref="S2.E5.m2.1.1.cmml"><mn id="S2.E5.m2.1.1.3" xref="S2.E5.m2.1.1.3.cmml">1</mn><mrow id="S2.E5.m2.1.1.1.1" xref="S2.E5.m2.1.1.1.2.cmml"><mo stretchy="false" id="S2.E5.m2.1.1.1.1.2" xref="S2.E5.m2.1.1.1.2.1.cmml">|</mo><msubsup id="S2.E5.m2.1.1.1.1.1" xref="S2.E5.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E5.m2.1.1.1.1.1.2.2" xref="S2.E5.m2.1.1.1.1.1.2.2.cmml">𝒟</mi><mi id="S2.E5.m2.1.1.1.1.1.3" xref="S2.E5.m2.1.1.1.1.1.3.cmml">k</mi><mrow id="S2.E5.m2.1.1.1.1.1.2.3" xref="S2.E5.m2.1.1.1.1.1.2.3.cmml"><mi id="S2.E5.m2.1.1.1.1.1.2.3.2" xref="S2.E5.m2.1.1.1.1.1.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S2.E5.m2.1.1.1.1.1.2.3.1" xref="S2.E5.m2.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.E5.m2.1.1.1.1.1.2.3.3" xref="S2.E5.m2.1.1.1.1.1.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.E5.m2.1.1.1.1.1.2.3.1a" xref="S2.E5.m2.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.E5.m2.1.1.1.1.1.2.3.4" xref="S2.E5.m2.1.1.1.1.1.2.3.4.cmml">l</mi></mrow></msubsup><mo stretchy="false" id="S2.E5.m2.1.1.1.1.3" xref="S2.E5.m2.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S2.E5.m2.7.7.1.1.1.2" xref="S2.E5.m2.7.7.1.1.1.2.cmml">​</mo><mrow id="S2.E5.m2.7.7.1.1.1.1" xref="S2.E5.m2.7.7.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E5.m2.7.7.1.1.1.1.2" xref="S2.E5.m2.7.7.1.1.1.1.2.cmml"><munder id="S2.E5.m2.7.7.1.1.1.1.2a" xref="S2.E5.m2.7.7.1.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E5.m2.7.7.1.1.1.1.2.2" xref="S2.E5.m2.7.7.1.1.1.1.2.2.cmml">∑</mo><mrow id="S2.E5.m2.3.3.2" xref="S2.E5.m2.3.3.2.cmml"><mrow id="S2.E5.m2.3.3.2.4.2" xref="S2.E5.m2.3.3.2.4.1.cmml"><mo stretchy="false" id="S2.E5.m2.3.3.2.4.2.1" xref="S2.E5.m2.3.3.2.4.1.cmml">(</mo><mi id="S2.E5.m2.2.2.1.1" xref="S2.E5.m2.2.2.1.1.cmml">𝐱</mi><mo id="S2.E5.m2.3.3.2.4.2.2" xref="S2.E5.m2.3.3.2.4.1.cmml">,</mo><mi id="S2.E5.m2.3.3.2.2" xref="S2.E5.m2.3.3.2.2.cmml">𝐲</mi><mo stretchy="false" id="S2.E5.m2.3.3.2.4.2.3" xref="S2.E5.m2.3.3.2.4.1.cmml">)</mo></mrow><mo id="S2.E5.m2.3.3.2.3" xref="S2.E5.m2.3.3.2.3.cmml">∈</mo><msubsup id="S2.E5.m2.3.3.2.5" xref="S2.E5.m2.3.3.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E5.m2.3.3.2.5.2.2" xref="S2.E5.m2.3.3.2.5.2.2.cmml">𝒟</mi><mi id="S2.E5.m2.3.3.2.5.3" xref="S2.E5.m2.3.3.2.5.3.cmml">k</mi><mrow id="S2.E5.m2.3.3.2.5.2.3" xref="S2.E5.m2.3.3.2.5.2.3.cmml"><mi id="S2.E5.m2.3.3.2.5.2.3.2" xref="S2.E5.m2.3.3.2.5.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S2.E5.m2.3.3.2.5.2.3.1" xref="S2.E5.m2.3.3.2.5.2.3.1.cmml">​</mo><mi id="S2.E5.m2.3.3.2.5.2.3.3" xref="S2.E5.m2.3.3.2.5.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.E5.m2.3.3.2.5.2.3.1a" xref="S2.E5.m2.3.3.2.5.2.3.1.cmml">​</mo><mi id="S2.E5.m2.3.3.2.5.2.3.4" xref="S2.E5.m2.3.3.2.5.2.3.4.cmml">l</mi></mrow></msubsup></mrow></munder></mstyle><mrow id="S2.E5.m2.7.7.1.1.1.1.1" xref="S2.E5.m2.7.7.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S2.E5.m2.7.7.1.1.1.1.1.3" xref="S2.E5.m2.7.7.1.1.1.1.1.3.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S2.E5.m2.7.7.1.1.1.1.1.2" xref="S2.E5.m2.7.7.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E5.m2.7.7.1.1.1.1.1.1.1" xref="S2.E5.m2.7.7.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E5.m2.7.7.1.1.1.1.1.1.1.2" xref="S2.E5.m2.7.7.1.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E5.m2.6.6" xref="S2.E5.m2.6.6.cmml">𝐲</mi><mo id="S2.E5.m2.7.7.1.1.1.1.1.1.1.3" xref="S2.E5.m2.7.7.1.1.1.1.1.1.2.cmml">,</mo><mrow id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.4" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.3" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.2.2" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.2.2.3" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.2.3.cmml">(</mo><mrow id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S2.E5.m2.4.4" xref="S2.E5.m2.4.4.cmml">𝐱</mi><mo id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">;</mo><mi id="S2.E5.m2.5.5" xref="S2.E5.m2.5.5.cmml">𝐮</mi><mo stretchy="false" id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.2.2.4" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.2.3.cmml">;</mo><msub id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.2.2.2.2" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.2.2.2.2.cmml">𝐯</mi><mi id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.2.2.2.3" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.2.2.2.3.cmml">k</mi></msub><mo stretchy="false" id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.2.2.5" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E5.m2.7.7.1.1.1.1.1.1.1.4" xref="S2.E5.m2.7.7.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E5.m2.7.7.1.2" xref="S2.E5.m2.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m2.7b"><apply id="S2.E5.m2.7.7.1.1.cmml" xref="S2.E5.m2.7.7.1"><eq id="S2.E5.m2.7.7.1.1.2.cmml" xref="S2.E5.m2.7.7.1.1.2"></eq><csymbol cd="latexml" id="S2.E5.m2.7.7.1.1.3.cmml" xref="S2.E5.m2.7.7.1.1.3">absent</csymbol><apply id="S2.E5.m2.7.7.1.1.1.cmml" xref="S2.E5.m2.7.7.1.1.1"><times id="S2.E5.m2.7.7.1.1.1.2.cmml" xref="S2.E5.m2.7.7.1.1.1.2"></times><apply id="S2.E5.m2.1.1.cmml" xref="S2.E5.m2.1.1"><divide id="S2.E5.m2.1.1.2.cmml" xref="S2.E5.m2.1.1"></divide><cn type="integer" id="S2.E5.m2.1.1.3.cmml" xref="S2.E5.m2.1.1.3">1</cn><apply id="S2.E5.m2.1.1.1.2.cmml" xref="S2.E5.m2.1.1.1.1"><abs id="S2.E5.m2.1.1.1.2.1.cmml" xref="S2.E5.m2.1.1.1.1.2"></abs><apply id="S2.E5.m2.1.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1.1.1">subscript</csymbol><apply id="S2.E5.m2.1.1.1.1.1.2.cmml" xref="S2.E5.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.1.2.1.cmml" xref="S2.E5.m2.1.1.1.1.1">superscript</csymbol><ci id="S2.E5.m2.1.1.1.1.1.2.2.cmml" xref="S2.E5.m2.1.1.1.1.1.2.2">𝒟</ci><apply id="S2.E5.m2.1.1.1.1.1.2.3.cmml" xref="S2.E5.m2.1.1.1.1.1.2.3"><times id="S2.E5.m2.1.1.1.1.1.2.3.1.cmml" xref="S2.E5.m2.1.1.1.1.1.2.3.1"></times><ci id="S2.E5.m2.1.1.1.1.1.2.3.2.cmml" xref="S2.E5.m2.1.1.1.1.1.2.3.2">𝑏</ci><ci id="S2.E5.m2.1.1.1.1.1.2.3.3.cmml" xref="S2.E5.m2.1.1.1.1.1.2.3.3">𝑎</ci><ci id="S2.E5.m2.1.1.1.1.1.2.3.4.cmml" xref="S2.E5.m2.1.1.1.1.1.2.3.4">𝑙</ci></apply></apply><ci id="S2.E5.m2.1.1.1.1.1.3.cmml" xref="S2.E5.m2.1.1.1.1.1.3">𝑘</ci></apply></apply></apply><apply id="S2.E5.m2.7.7.1.1.1.1.cmml" xref="S2.E5.m2.7.7.1.1.1.1"><apply id="S2.E5.m2.7.7.1.1.1.1.2.cmml" xref="S2.E5.m2.7.7.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m2.7.7.1.1.1.1.2.1.cmml" xref="S2.E5.m2.7.7.1.1.1.1.2">subscript</csymbol><sum id="S2.E5.m2.7.7.1.1.1.1.2.2.cmml" xref="S2.E5.m2.7.7.1.1.1.1.2.2"></sum><apply id="S2.E5.m2.3.3.2.cmml" xref="S2.E5.m2.3.3.2"><in id="S2.E5.m2.3.3.2.3.cmml" xref="S2.E5.m2.3.3.2.3"></in><interval closure="open" id="S2.E5.m2.3.3.2.4.1.cmml" xref="S2.E5.m2.3.3.2.4.2"><ci id="S2.E5.m2.2.2.1.1.cmml" xref="S2.E5.m2.2.2.1.1">𝐱</ci><ci id="S2.E5.m2.3.3.2.2.cmml" xref="S2.E5.m2.3.3.2.2">𝐲</ci></interval><apply id="S2.E5.m2.3.3.2.5.cmml" xref="S2.E5.m2.3.3.2.5"><csymbol cd="ambiguous" id="S2.E5.m2.3.3.2.5.1.cmml" xref="S2.E5.m2.3.3.2.5">subscript</csymbol><apply id="S2.E5.m2.3.3.2.5.2.cmml" xref="S2.E5.m2.3.3.2.5"><csymbol cd="ambiguous" id="S2.E5.m2.3.3.2.5.2.1.cmml" xref="S2.E5.m2.3.3.2.5">superscript</csymbol><ci id="S2.E5.m2.3.3.2.5.2.2.cmml" xref="S2.E5.m2.3.3.2.5.2.2">𝒟</ci><apply id="S2.E5.m2.3.3.2.5.2.3.cmml" xref="S2.E5.m2.3.3.2.5.2.3"><times id="S2.E5.m2.3.3.2.5.2.3.1.cmml" xref="S2.E5.m2.3.3.2.5.2.3.1"></times><ci id="S2.E5.m2.3.3.2.5.2.3.2.cmml" xref="S2.E5.m2.3.3.2.5.2.3.2">𝑏</ci><ci id="S2.E5.m2.3.3.2.5.2.3.3.cmml" xref="S2.E5.m2.3.3.2.5.2.3.3">𝑎</ci><ci id="S2.E5.m2.3.3.2.5.2.3.4.cmml" xref="S2.E5.m2.3.3.2.5.2.3.4">𝑙</ci></apply></apply><ci id="S2.E5.m2.3.3.2.5.3.cmml" xref="S2.E5.m2.3.3.2.5.3">𝑘</ci></apply></apply></apply><apply id="S2.E5.m2.7.7.1.1.1.1.1.cmml" xref="S2.E5.m2.7.7.1.1.1.1.1"><times id="S2.E5.m2.7.7.1.1.1.1.1.2.cmml" xref="S2.E5.m2.7.7.1.1.1.1.1.2"></times><ci id="S2.E5.m2.7.7.1.1.1.1.1.3.cmml" xref="S2.E5.m2.7.7.1.1.1.1.1.3">ℓ</ci><interval closure="open" id="S2.E5.m2.7.7.1.1.1.1.1.1.2.cmml" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1"><ci id="S2.E5.m2.6.6.cmml" xref="S2.E5.m2.6.6">𝐲</ci><apply id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1"><times id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.3"></times><ci id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.4">𝑓</ci><list id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.2.2"><apply id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.1.1.1"><times id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.2">𝑔</ci><list id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.3.2"><ci id="S2.E5.m2.4.4.cmml" xref="S2.E5.m2.4.4">𝐱</ci><ci id="S2.E5.m2.5.5.cmml" xref="S2.E5.m2.5.5">𝐮</ci></list></apply><apply id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.2.2.2.2">𝐯</ci><ci id="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E5.m2.7.7.1.1.1.1.1.1.1.1.2.2.2.3">𝑘</ci></apply></list></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m2.7c">\displaystyle=\frac{1}{|\mathcal{D}^{bal}_{k}|}\sum_{(\mathbf{x},\mathbf{y})\in\mathcal{D}^{bal}_{k}}\ell(\mathbf{y},f(g(\mathbf{x};\mathbf{u});\mathbf{\mathbf{v}}_{k})),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
<tbody id="S2.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E6.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{AFA}" display="inline"><semantics id="S2.E6.m1.1a"><msub id="S2.E6.m1.1.1" xref="S2.E6.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E6.m1.1.1.2" xref="S2.E6.m1.1.1.2.cmml">ℒ</mi><mrow id="S2.E6.m1.1.1.3" xref="S2.E6.m1.1.1.3.cmml"><mi id="S2.E6.m1.1.1.3.2" xref="S2.E6.m1.1.1.3.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S2.E6.m1.1.1.3.1" xref="S2.E6.m1.1.1.3.1.cmml">​</mo><mi id="S2.E6.m1.1.1.3.3" xref="S2.E6.m1.1.1.3.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.E6.m1.1.1.3.1a" xref="S2.E6.m1.1.1.3.1.cmml">​</mo><mi id="S2.E6.m1.1.1.3.4" xref="S2.E6.m1.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.E6.m1.1b"><apply id="S2.E6.m1.1.1.cmml" xref="S2.E6.m1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.cmml" xref="S2.E6.m1.1.1">subscript</csymbol><ci id="S2.E6.m1.1.1.2.cmml" xref="S2.E6.m1.1.1.2">ℒ</ci><apply id="S2.E6.m1.1.1.3.cmml" xref="S2.E6.m1.1.1.3"><times id="S2.E6.m1.1.1.3.1.cmml" xref="S2.E6.m1.1.1.3.1"></times><ci id="S2.E6.m1.1.1.3.2.cmml" xref="S2.E6.m1.1.1.3.2">𝐴</ci><ci id="S2.E6.m1.1.1.3.3.cmml" xref="S2.E6.m1.1.1.3.3">𝐹</ci><ci id="S2.E6.m1.1.1.3.4.cmml" xref="S2.E6.m1.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.1c">\displaystyle\mathcal{L}_{AFA}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E6.m2.1" class="ltx_Math" alttext="\displaystyle=\lambda\mathcal{L}_{gen}+(1-\lambda)\mathcal{L}_{ori}," display="inline"><semantics id="S2.E6.m2.1a"><mrow id="S2.E6.m2.1.1.1" xref="S2.E6.m2.1.1.1.1.cmml"><mrow id="S2.E6.m2.1.1.1.1" xref="S2.E6.m2.1.1.1.1.cmml"><mi id="S2.E6.m2.1.1.1.1.3" xref="S2.E6.m2.1.1.1.1.3.cmml"></mi><mo id="S2.E6.m2.1.1.1.1.2" xref="S2.E6.m2.1.1.1.1.2.cmml">=</mo><mrow id="S2.E6.m2.1.1.1.1.1" xref="S2.E6.m2.1.1.1.1.1.cmml"><mrow id="S2.E6.m2.1.1.1.1.1.3" xref="S2.E6.m2.1.1.1.1.1.3.cmml"><mi id="S2.E6.m2.1.1.1.1.1.3.2" xref="S2.E6.m2.1.1.1.1.1.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S2.E6.m2.1.1.1.1.1.3.1" xref="S2.E6.m2.1.1.1.1.1.3.1.cmml">​</mo><msub id="S2.E6.m2.1.1.1.1.1.3.3" xref="S2.E6.m2.1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E6.m2.1.1.1.1.1.3.3.2" xref="S2.E6.m2.1.1.1.1.1.3.3.2.cmml">ℒ</mi><mrow id="S2.E6.m2.1.1.1.1.1.3.3.3" xref="S2.E6.m2.1.1.1.1.1.3.3.3.cmml"><mi id="S2.E6.m2.1.1.1.1.1.3.3.3.2" xref="S2.E6.m2.1.1.1.1.1.3.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S2.E6.m2.1.1.1.1.1.3.3.3.1" xref="S2.E6.m2.1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S2.E6.m2.1.1.1.1.1.3.3.3.3" xref="S2.E6.m2.1.1.1.1.1.3.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.E6.m2.1.1.1.1.1.3.3.3.1a" xref="S2.E6.m2.1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S2.E6.m2.1.1.1.1.1.3.3.3.4" xref="S2.E6.m2.1.1.1.1.1.3.3.3.4.cmml">n</mi></mrow></msub></mrow><mo id="S2.E6.m2.1.1.1.1.1.2" xref="S2.E6.m2.1.1.1.1.1.2.cmml">+</mo><mrow id="S2.E6.m2.1.1.1.1.1.1" xref="S2.E6.m2.1.1.1.1.1.1.cmml"><mrow id="S2.E6.m2.1.1.1.1.1.1.1.1" xref="S2.E6.m2.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E6.m2.1.1.1.1.1.1.1.1.2" xref="S2.E6.m2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E6.m2.1.1.1.1.1.1.1.1.1" xref="S2.E6.m2.1.1.1.1.1.1.1.1.1.cmml"><mn id="S2.E6.m2.1.1.1.1.1.1.1.1.1.2" xref="S2.E6.m2.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S2.E6.m2.1.1.1.1.1.1.1.1.1.1" xref="S2.E6.m2.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S2.E6.m2.1.1.1.1.1.1.1.1.1.3" xref="S2.E6.m2.1.1.1.1.1.1.1.1.1.3.cmml">λ</mi></mrow><mo stretchy="false" id="S2.E6.m2.1.1.1.1.1.1.1.1.3" xref="S2.E6.m2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E6.m2.1.1.1.1.1.1.2" xref="S2.E6.m2.1.1.1.1.1.1.2.cmml">​</mo><msub id="S2.E6.m2.1.1.1.1.1.1.3" xref="S2.E6.m2.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E6.m2.1.1.1.1.1.1.3.2" xref="S2.E6.m2.1.1.1.1.1.1.3.2.cmml">ℒ</mi><mrow id="S2.E6.m2.1.1.1.1.1.1.3.3" xref="S2.E6.m2.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E6.m2.1.1.1.1.1.1.3.3.2" xref="S2.E6.m2.1.1.1.1.1.1.3.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.E6.m2.1.1.1.1.1.1.3.3.1" xref="S2.E6.m2.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.E6.m2.1.1.1.1.1.1.3.3.3" xref="S2.E6.m2.1.1.1.1.1.1.3.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.E6.m2.1.1.1.1.1.1.3.3.1a" xref="S2.E6.m2.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.E6.m2.1.1.1.1.1.1.3.3.4" xref="S2.E6.m2.1.1.1.1.1.1.3.3.4.cmml">i</mi></mrow></msub></mrow></mrow></mrow><mo id="S2.E6.m2.1.1.1.2" xref="S2.E6.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m2.1b"><apply id="S2.E6.m2.1.1.1.1.cmml" xref="S2.E6.m2.1.1.1"><eq id="S2.E6.m2.1.1.1.1.2.cmml" xref="S2.E6.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S2.E6.m2.1.1.1.1.3.cmml" xref="S2.E6.m2.1.1.1.1.3">absent</csymbol><apply id="S2.E6.m2.1.1.1.1.1.cmml" xref="S2.E6.m2.1.1.1.1.1"><plus id="S2.E6.m2.1.1.1.1.1.2.cmml" xref="S2.E6.m2.1.1.1.1.1.2"></plus><apply id="S2.E6.m2.1.1.1.1.1.3.cmml" xref="S2.E6.m2.1.1.1.1.1.3"><times id="S2.E6.m2.1.1.1.1.1.3.1.cmml" xref="S2.E6.m2.1.1.1.1.1.3.1"></times><ci id="S2.E6.m2.1.1.1.1.1.3.2.cmml" xref="S2.E6.m2.1.1.1.1.1.3.2">𝜆</ci><apply id="S2.E6.m2.1.1.1.1.1.3.3.cmml" xref="S2.E6.m2.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E6.m2.1.1.1.1.1.3.3.1.cmml" xref="S2.E6.m2.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E6.m2.1.1.1.1.1.3.3.2.cmml" xref="S2.E6.m2.1.1.1.1.1.3.3.2">ℒ</ci><apply id="S2.E6.m2.1.1.1.1.1.3.3.3.cmml" xref="S2.E6.m2.1.1.1.1.1.3.3.3"><times id="S2.E6.m2.1.1.1.1.1.3.3.3.1.cmml" xref="S2.E6.m2.1.1.1.1.1.3.3.3.1"></times><ci id="S2.E6.m2.1.1.1.1.1.3.3.3.2.cmml" xref="S2.E6.m2.1.1.1.1.1.3.3.3.2">𝑔</ci><ci id="S2.E6.m2.1.1.1.1.1.3.3.3.3.cmml" xref="S2.E6.m2.1.1.1.1.1.3.3.3.3">𝑒</ci><ci id="S2.E6.m2.1.1.1.1.1.3.3.3.4.cmml" xref="S2.E6.m2.1.1.1.1.1.3.3.3.4">𝑛</ci></apply></apply></apply><apply id="S2.E6.m2.1.1.1.1.1.1.cmml" xref="S2.E6.m2.1.1.1.1.1.1"><times id="S2.E6.m2.1.1.1.1.1.1.2.cmml" xref="S2.E6.m2.1.1.1.1.1.1.2"></times><apply id="S2.E6.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m2.1.1.1.1.1.1.1.1"><minus id="S2.E6.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m2.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S2.E6.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m2.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="S2.E6.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m2.1.1.1.1.1.1.1.1.1.3">𝜆</ci></apply><apply id="S2.E6.m2.1.1.1.1.1.1.3.cmml" xref="S2.E6.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m2.1.1.1.1.1.1.3.1.cmml" xref="S2.E6.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E6.m2.1.1.1.1.1.1.3.2.cmml" xref="S2.E6.m2.1.1.1.1.1.1.3.2">ℒ</ci><apply id="S2.E6.m2.1.1.1.1.1.1.3.3.cmml" xref="S2.E6.m2.1.1.1.1.1.1.3.3"><times id="S2.E6.m2.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E6.m2.1.1.1.1.1.1.3.3.1"></times><ci id="S2.E6.m2.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E6.m2.1.1.1.1.1.1.3.3.2">𝑜</ci><ci id="S2.E6.m2.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E6.m2.1.1.1.1.1.1.3.3.3">𝑟</ci><ci id="S2.E6.m2.1.1.1.1.1.1.3.3.4.cmml" xref="S2.E6.m2.1.1.1.1.1.1.3.3.4">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m2.1c">\displaystyle=\lambda\mathcal{L}_{gen}+(1-\lambda)\mathcal{L}_{ori},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.SSS2.p1.11" class="ltx_p">where <math id="S2.SS2.SSS2.p1.11.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S2.SS2.SSS2.p1.11.m1.1a"><mi id="S2.SS2.SSS2.p1.11.m1.1.1" xref="S2.SS2.SSS2.p1.11.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.11.m1.1b"><ci id="S2.SS2.SSS2.p1.11.m1.1.1.cmml" xref="S2.SS2.SSS2.p1.11.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.11.m1.1c">\lambda</annotation></semantics></math> is a hyperparameter called <span id="S2.SS2.SSS2.p1.11.1" class="ltx_text ltx_font_italic">balance factor</span> to control the balance of adjusting the decision boundary between the original and generated features.</p>
</div>
</section>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experiments</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Experiment Setup</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.8" class="ltx_p">We evaluate FedAFA on two image classification datasets: CIFAR-10-LT and CIFAR-100-LT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> <span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>We refer to the long-tailed versions of these three benchmarks as CIFAR-10-LT and CIFAR-100-LT.</span></span></span>. Specifically, the number of samples in class <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">k</annotation></semantics></math> decay exponentially by <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="\rho^{k}n_{c}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mrow id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><msup id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2.2" xref="S3.SS1.p1.2.m2.1.1.2.2.cmml">ρ</mi><mi id="S3.SS1.p1.2.m2.1.1.2.3" xref="S3.SS1.p1.2.m2.1.1.2.3.cmml">k</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS1.p1.2.m2.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.cmml">​</mo><msub id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml"><mi id="S3.SS1.p1.2.m2.1.1.3.2" xref="S3.SS1.p1.2.m2.1.1.3.2.cmml">n</mi><mi id="S3.SS1.p1.2.m2.1.1.3.3" xref="S3.SS1.p1.2.m2.1.1.3.3.cmml">c</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><times id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1"></times><apply id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.2.1.cmml" xref="S3.SS1.p1.2.m2.1.1.2">superscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2.2">𝜌</ci><ci id="S3.SS1.p1.2.m2.1.1.2.3.cmml" xref="S3.SS1.p1.2.m2.1.1.2.3">𝑘</ci></apply><apply id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.3.1.cmml" xref="S3.SS1.p1.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.3.2.cmml" xref="S3.SS1.p1.2.m2.1.1.3.2">𝑛</ci><ci id="S3.SS1.p1.2.m2.1.1.3.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\rho^{k}n_{c}</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, where <math id="S3.SS1.p1.3.m3.2" class="ltx_Math" alttext="\rho^{k}\in(0,1)" display="inline"><semantics id="S3.SS1.p1.3.m3.2a"><mrow id="S3.SS1.p1.3.m3.2.3" xref="S3.SS1.p1.3.m3.2.3.cmml"><msup id="S3.SS1.p1.3.m3.2.3.2" xref="S3.SS1.p1.3.m3.2.3.2.cmml"><mi id="S3.SS1.p1.3.m3.2.3.2.2" xref="S3.SS1.p1.3.m3.2.3.2.2.cmml">ρ</mi><mi id="S3.SS1.p1.3.m3.2.3.2.3" xref="S3.SS1.p1.3.m3.2.3.2.3.cmml">k</mi></msup><mo id="S3.SS1.p1.3.m3.2.3.1" xref="S3.SS1.p1.3.m3.2.3.1.cmml">∈</mo><mrow id="S3.SS1.p1.3.m3.2.3.3.2" xref="S3.SS1.p1.3.m3.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.3.m3.2.3.3.2.1" xref="S3.SS1.p1.3.m3.2.3.3.1.cmml">(</mo><mn id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">0</mn><mo id="S3.SS1.p1.3.m3.2.3.3.2.2" xref="S3.SS1.p1.3.m3.2.3.3.1.cmml">,</mo><mn id="S3.SS1.p1.3.m3.2.2" xref="S3.SS1.p1.3.m3.2.2.cmml">1</mn><mo stretchy="false" id="S3.SS1.p1.3.m3.2.3.3.2.3" xref="S3.SS1.p1.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.2b"><apply id="S3.SS1.p1.3.m3.2.3.cmml" xref="S3.SS1.p1.3.m3.2.3"><in id="S3.SS1.p1.3.m3.2.3.1.cmml" xref="S3.SS1.p1.3.m3.2.3.1"></in><apply id="S3.SS1.p1.3.m3.2.3.2.cmml" xref="S3.SS1.p1.3.m3.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.2.3.2.1.cmml" xref="S3.SS1.p1.3.m3.2.3.2">superscript</csymbol><ci id="S3.SS1.p1.3.m3.2.3.2.2.cmml" xref="S3.SS1.p1.3.m3.2.3.2.2">𝜌</ci><ci id="S3.SS1.p1.3.m3.2.3.2.3.cmml" xref="S3.SS1.p1.3.m3.2.3.2.3">𝑘</ci></apply><interval closure="open" id="S3.SS1.p1.3.m3.2.3.3.1.cmml" xref="S3.SS1.p1.3.m3.2.3.3.2"><cn type="integer" id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">0</cn><cn type="integer" id="S3.SS1.p1.3.m3.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.2c">\rho^{k}\in(0,1)</annotation></semantics></math> controls the degree of long-tail and <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="n_{c}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">n</mi><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝑛</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">n_{c}</annotation></semantics></math> is the number of samples in each class of the original balanced dataset. In all experiments, we set the degree of data imbalance at 100, calculated by the number of samples in the largest class divided by the ones in the smallest class. We adopt the Dirichlet Distribution with the hyperparameter <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\alpha</annotation></semantics></math> to simulate different degrees of data heterogeneity <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. A larger value of <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">\alpha</annotation></semantics></math> means higher similarity between data distributions. We choose <math id="S3.SS1.p1.7.m7.2" class="ltx_Math" alttext="\alpha=[0.5,0.2]" display="inline"><semantics id="S3.SS1.p1.7.m7.2a"><mrow id="S3.SS1.p1.7.m7.2.3" xref="S3.SS1.p1.7.m7.2.3.cmml"><mi id="S3.SS1.p1.7.m7.2.3.2" xref="S3.SS1.p1.7.m7.2.3.2.cmml">α</mi><mo id="S3.SS1.p1.7.m7.2.3.1" xref="S3.SS1.p1.7.m7.2.3.1.cmml">=</mo><mrow id="S3.SS1.p1.7.m7.2.3.3.2" xref="S3.SS1.p1.7.m7.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.7.m7.2.3.3.2.1" xref="S3.SS1.p1.7.m7.2.3.3.1.cmml">[</mo><mn id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">0.5</mn><mo id="S3.SS1.p1.7.m7.2.3.3.2.2" xref="S3.SS1.p1.7.m7.2.3.3.1.cmml">,</mo><mn id="S3.SS1.p1.7.m7.2.2" xref="S3.SS1.p1.7.m7.2.2.cmml">0.2</mn><mo stretchy="false" id="S3.SS1.p1.7.m7.2.3.3.2.3" xref="S3.SS1.p1.7.m7.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.2b"><apply id="S3.SS1.p1.7.m7.2.3.cmml" xref="S3.SS1.p1.7.m7.2.3"><eq id="S3.SS1.p1.7.m7.2.3.1.cmml" xref="S3.SS1.p1.7.m7.2.3.1"></eq><ci id="S3.SS1.p1.7.m7.2.3.2.cmml" xref="S3.SS1.p1.7.m7.2.3.2">𝛼</ci><interval closure="closed" id="S3.SS1.p1.7.m7.2.3.3.1.cmml" xref="S3.SS1.p1.7.m7.2.3.3.2"><cn type="float" id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">0.5</cn><cn type="float" id="S3.SS1.p1.7.m7.2.2.cmml" xref="S3.SS1.p1.7.m7.2.2">0.2</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.2c">\alpha=[0.5,0.2]</annotation></semantics></math> to make heterogeneous data across clients. Figure <a href="#S3.F2" title="Figure 2 ‣ 3.1 Experiment Setup ‣ 3 Experiments ‣ Personalized Federated Learning on Long-Tailed Data via Adversarial Feature Augmentation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows the data distributions of each client for two long-tailed datasets used in our experiments with <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="\alpha=0.2" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><mrow id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml">α</mi><mo id="S3.SS1.p1.8.m8.1.1.1" xref="S3.SS1.p1.8.m8.1.1.1.cmml">=</mo><mn id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><eq id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1"></eq><ci id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2">𝛼</ci><cn type="float" id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">\alpha=0.2</annotation></semantics></math>.</p>
</div>
<figure id="S3.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S3.F2.1" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_bottom" style="width:116.5pt;">
<img src="/html/2303.15168/assets/x2.png" id="S3.F2.1.g1" class="ltx_graphics ltx_img_landscape" width="538" height="277" alt="Refer to caption">
<p id="S3.F2.1.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S3.F2.1.1.1" class="ltx_text">(a) CIFAR-10-LT</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S3.F2.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_bottom" style="width:116.5pt;">
<img src="/html/2303.15168/assets/x3.png" id="S3.F2.2.g1" class="ltx_graphics ltx_img_landscape" width="538" height="276" alt="Refer to caption">
<p id="S3.F2.2.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S3.F2.2.1.1" class="ltx_text">(b) CIFAR-100-LT</span></p>
</div>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.6.1.1" class="ltx_text ltx_font_bold">Fig. 2</span>: </span>Class distributions of each client on CIFAR-10/100-LT with <math id="S3.F2.4.m1.1" class="ltx_Math" alttext="\alpha=0.2" display="inline"><semantics id="S3.F2.4.m1.1b"><mrow id="S3.F2.4.m1.1.1" xref="S3.F2.4.m1.1.1.cmml"><mi id="S3.F2.4.m1.1.1.2" xref="S3.F2.4.m1.1.1.2.cmml">α</mi><mo id="S3.F2.4.m1.1.1.1" xref="S3.F2.4.m1.1.1.1.cmml">=</mo><mn id="S3.F2.4.m1.1.1.3" xref="S3.F2.4.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.4.m1.1c"><apply id="S3.F2.4.m1.1.1.cmml" xref="S3.F2.4.m1.1.1"><eq id="S3.F2.4.m1.1.1.1.cmml" xref="S3.F2.4.m1.1.1.1"></eq><ci id="S3.F2.4.m1.1.1.2.cmml" xref="S3.F2.4.m1.1.1.2">𝛼</ci><cn type="float" id="S3.F2.4.m1.1.1.3.cmml" xref="S3.F2.4.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.4.m1.1d">\alpha=0.2</annotation></semantics></math>. Different colors represent different classes, and the length of the color block represents the number of samples in this class.</figcaption>
</figure>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">We choose ResNet32 as the learning model. The features of the second block of ResNet32 are selected to do feature augmentation of FedAFA. SGD is the optimizer with a learning rate of 0.005, a momentum of 0.9, and a weight decay of <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="5\times 10^{-4}" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mn id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">5</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.1.m1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.cmml">×</mo><msup id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml"><mn id="S3.SS1.p2.1.m1.1.1.3.2" xref="S3.SS1.p2.1.m1.1.1.3.2.cmml">10</mn><mrow id="S3.SS1.p2.1.m1.1.1.3.3" xref="S3.SS1.p2.1.m1.1.1.3.3.cmml"><mo id="S3.SS1.p2.1.m1.1.1.3.3a" xref="S3.SS1.p2.1.m1.1.1.3.3.cmml">−</mo><mn id="S3.SS1.p2.1.m1.1.1.3.3.2" xref="S3.SS1.p2.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><times id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1"></times><cn type="integer" id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">5</cn><apply id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S3.SS1.p2.1.m1.1.1.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.3.2">10</cn><apply id="S3.SS1.p2.1.m1.1.1.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3.3"><minus id="S3.SS1.p2.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.3.3"></minus><cn type="integer" id="S3.SS1.p2.1.m1.1.1.3.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">5\times 10^{-4}</annotation></semantics></math> for local model optimization of all methods. We set the total number of clients at 20, the number of clients selected in each round at 10, the batch size at 64, the local epoch for personalized training at 1, and the global communication round at 500.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Experimental Results</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">In this subsection, we first compare FedAFA with two groups of state-of-the-art PFL methods. The methods in the first group are all PFL methods but do not specifically design for imbalanced data. The methods in the other group apply the long-tail learning methods to the PFL framework, including random oversampling (ROS), M2m <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, and cRT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. To verify that the features obtained by the global model are more robust, we also compare FedAFA and FedAFA_Loc, whose balanced feature sets are generated by the global model and the local personalization model, respectively.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<table id="S3.T1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T1.1.2.1" class="ltx_tr">
<th id="S3.T1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.2.1.1.1" class="ltx_text" style="font-size:90%;">Dataset</span></th>
<td id="S3.T1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;" colspan="2"><span id="S3.T1.1.2.1.2.1" class="ltx_text" style="font-size:90%;">CIFAR-10-LT</span></td>
<td id="S3.T1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;" colspan="2"><span id="S3.T1.1.2.1.3.1" class="ltx_text" style="font-size:90%;">CIFAR-100-LT</span></td>
</tr>
<tr id="S3.T1.1.1" class="ltx_tr">
<th id="S3.T1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><math id="S3.T1.1.1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.T1.1.1.1.m1.1a"><mi mathsize="90%" id="S3.T1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.m1.1b"><ci id="S3.T1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.m1.1c">\alpha</annotation></semantics></math></th>
<td id="S3.T1.1.1.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.1.2.1" class="ltx_text" style="font-size:90%;">0.5</span></td>
<td id="S3.T1.1.1.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.1.3.1" class="ltx_text" style="font-size:90%;">0.2</span></td>
<td id="S3.T1.1.1.4" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.1.4.1" class="ltx_text" style="font-size:90%;">0.5</span></td>
<td id="S3.T1.1.1.5" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.1.5.1" class="ltx_text" style="font-size:90%;">0.2</span></td>
</tr>
<tr id="S3.T1.1.3.2" class="ltx_tr">
<th id="S3.T1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.3.2.1.1" class="ltx_text" style="font-size:90%;">Local training</span></th>
<td id="S3.T1.1.3.2.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.3.2.2.1" class="ltx_text" style="font-size:90%;">28.06</span></td>
<td id="S3.T1.1.3.2.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.3.2.3.1" class="ltx_text" style="font-size:90%;">27.88</span></td>
<td id="S3.T1.1.3.2.4" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.3.2.4.1" class="ltx_text" style="font-size:90%;">9.82</span></td>
<td id="S3.T1.1.3.2.5" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.3.2.5.1" class="ltx_text" style="font-size:90%;">8.37</span></td>
</tr>
<tr id="S3.T1.1.4.3" class="ltx_tr">
<th id="S3.T1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.9pt;padding-bottom:0.9pt;">
<span id="S3.T1.1.4.3.1.1" class="ltx_text" style="font-size:90%;">FedAvg-FT </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.T1.1.4.3.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib14" title="" class="ltx_ref">14</a><span id="S3.T1.1.4.3.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S3.T1.1.4.3.2" class="ltx_td ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.4.3.2.1" class="ltx_text" style="font-size:90%;">48.21</span></td>
<td id="S3.T1.1.4.3.3" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.4.3.3.1" class="ltx_text" style="font-size:90%;">48.11</span></td>
<td id="S3.T1.1.4.3.4" class="ltx_td ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.4.3.4.1" class="ltx_text" style="font-size:90%;">30.66</span></td>
<td id="S3.T1.1.4.3.5" class="ltx_td ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.4.3.5.1" class="ltx_text" style="font-size:90%;">26.32</span></td>
</tr>
<tr id="S3.T1.1.5.4" class="ltx_tr">
<th id="S3.T1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.9pt;padding-bottom:0.9pt;">
<span id="S3.T1.1.5.4.1.1" class="ltx_text" style="font-size:90%;">FedProx </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.T1.1.5.4.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib21" title="" class="ltx_ref">21</a><span id="S3.T1.1.5.4.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S3.T1.1.5.4.2" class="ltx_td ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.5.4.2.1" class="ltx_text" style="font-size:90%;">51.07</span></td>
<td id="S3.T1.1.5.4.3" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.5.4.3.1" class="ltx_text" style="font-size:90%;">50.26</span></td>
<td id="S3.T1.1.5.4.4" class="ltx_td ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.5.4.4.1" class="ltx_text" style="font-size:90%;">31.40</span></td>
<td id="S3.T1.1.5.4.5" class="ltx_td ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.5.4.5.1" class="ltx_text" style="font-size:90%;">30.58</span></td>
</tr>
<tr id="S3.T1.1.6.5" class="ltx_tr">
<th id="S3.T1.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.9pt;padding-bottom:0.9pt;">
<span id="S3.T1.1.6.5.1.1" class="ltx_text" style="font-size:90%;">LG-FedAvg </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.T1.1.6.5.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib5" title="" class="ltx_ref">5</a><span id="S3.T1.1.6.5.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S3.T1.1.6.5.2" class="ltx_td ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.6.5.2.1" class="ltx_text" style="font-size:90%;">51.13</span></td>
<td id="S3.T1.1.6.5.3" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.6.5.3.1" class="ltx_text" style="font-size:90%;">50.93</span></td>
<td id="S3.T1.1.6.5.4" class="ltx_td ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.6.5.4.1" class="ltx_text" style="font-size:90%;">32.65</span></td>
<td id="S3.T1.1.6.5.5" class="ltx_td ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.6.5.5.1" class="ltx_text" style="font-size:90%;">31.18</span></td>
</tr>
<tr id="S3.T1.1.7.6" class="ltx_tr">
<th id="S3.T1.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.9pt;padding-bottom:0.9pt;">
<span id="S3.T1.1.7.6.1.1" class="ltx_text" style="font-size:90%;">Per-FedAvg </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.T1.1.7.6.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib8" title="" class="ltx_ref">8</a><span id="S3.T1.1.7.6.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S3.T1.1.7.6.2" class="ltx_td ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.7.6.2.1" class="ltx_text" style="font-size:90%;">49.96</span></td>
<td id="S3.T1.1.7.6.3" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.7.6.3.1" class="ltx_text" style="font-size:90%;">49.81</span></td>
<td id="S3.T1.1.7.6.4" class="ltx_td ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.7.6.4.1" class="ltx_text" style="font-size:90%;">32.27</span></td>
<td id="S3.T1.1.7.6.5" class="ltx_td ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.7.6.5.1" class="ltx_text" style="font-size:90%;">30.60</span></td>
</tr>
<tr id="S3.T1.1.8.7" class="ltx_tr">
<th id="S3.T1.1.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.9pt;padding-bottom:0.9pt;">
<span id="S3.T1.1.8.7.1.1" class="ltx_text" style="font-size:90%;">pFedMe </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.T1.1.8.7.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib6" title="" class="ltx_ref">6</a><span id="S3.T1.1.8.7.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S3.T1.1.8.7.2" class="ltx_td ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.8.7.2.1" class="ltx_text" style="font-size:90%;">50.05</span></td>
<td id="S3.T1.1.8.7.3" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.8.7.3.1" class="ltx_text" style="font-size:90%;">49.59</span></td>
<td id="S3.T1.1.8.7.4" class="ltx_td ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.8.7.4.1" class="ltx_text" style="font-size:90%;">32.82</span></td>
<td id="S3.T1.1.8.7.5" class="ltx_td ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.8.7.5.1" class="ltx_text" style="font-size:90%;">30.05</span></td>
</tr>
<tr id="S3.T1.1.9.8" class="ltx_tr">
<th id="S3.T1.1.9.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.9pt;padding-bottom:0.9pt;">
<span id="S3.T1.1.9.8.1.1" class="ltx_text" style="font-size:90%;">Ditto </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.T1.1.9.8.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib7" title="" class="ltx_ref">7</a><span id="S3.T1.1.9.8.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S3.T1.1.9.8.2" class="ltx_td ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.9.8.2.1" class="ltx_text" style="font-size:90%;">50.84</span></td>
<td id="S3.T1.1.9.8.3" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.9.8.3.1" class="ltx_text" style="font-size:90%;">50.26</span></td>
<td id="S3.T1.1.9.8.4" class="ltx_td ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.9.8.4.1" class="ltx_text" style="font-size:90%;">31.98</span></td>
<td id="S3.T1.1.9.8.5" class="ltx_td ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.9.8.5.1" class="ltx_text" style="font-size:90%;">31.11</span></td>
</tr>
<tr id="S3.T1.1.10.9" class="ltx_tr">
<th id="S3.T1.1.10.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.9pt;padding-bottom:0.9pt;">
<span id="S3.T1.1.10.9.1.1" class="ltx_text" style="font-size:90%;">FedBN </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.T1.1.10.9.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib22" title="" class="ltx_ref">22</a><span id="S3.T1.1.10.9.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S3.T1.1.10.9.2" class="ltx_td ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.10.9.2.1" class="ltx_text" style="font-size:90%;">50.98</span></td>
<td id="S3.T1.1.10.9.3" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.10.9.3.1" class="ltx_text" style="font-size:90%;">50.17</span></td>
<td id="S3.T1.1.10.9.4" class="ltx_td ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.10.9.4.1" class="ltx_text" style="font-size:90%;">31.62</span></td>
<td id="S3.T1.1.10.9.5" class="ltx_td ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.10.9.5.1" class="ltx_text" style="font-size:90%;">30.37</span></td>
</tr>
<tr id="S3.T1.1.11.10" class="ltx_tr">
<th id="S3.T1.1.11.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.11.10.1.1" class="ltx_text" style="font-size:90%;">FedAvg+ROS</span></th>
<td id="S3.T1.1.11.10.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.11.10.2.1" class="ltx_text" style="font-size:90%;">59.29</span></td>
<td id="S3.T1.1.11.10.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.11.10.3.1" class="ltx_text" style="font-size:90%;">56.51</span></td>
<td id="S3.T1.1.11.10.4" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.11.10.4.1" class="ltx_text" style="font-size:90%;">34.04</span></td>
<td id="S3.T1.1.11.10.5" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.11.10.5.1" class="ltx_text" style="font-size:90%;">32.02</span></td>
</tr>
<tr id="S3.T1.1.12.11" class="ltx_tr">
<th id="S3.T1.1.12.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.12.11.1.1" class="ltx_text" style="font-size:90%;">FedAvg+M2m</span></th>
<td id="S3.T1.1.12.11.2" class="ltx_td ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.12.11.2.1" class="ltx_text" style="font-size:90%;">62.85</span></td>
<td id="S3.T1.1.12.11.3" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.12.11.3.1" class="ltx_text" style="font-size:90%;">56.30</span></td>
<td id="S3.T1.1.12.11.4" class="ltx_td ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.12.11.4.1" class="ltx_text" style="font-size:90%;">32.63</span></td>
<td id="S3.T1.1.12.11.5" class="ltx_td ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.12.11.5.1" class="ltx_text" style="font-size:90%;">32.69</span></td>
</tr>
<tr id="S3.T1.1.13.12" class="ltx_tr">
<th id="S3.T1.1.13.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.13.12.1.1" class="ltx_text" style="font-size:90%;">FedAvg+cRT</span></th>
<td id="S3.T1.1.13.12.2" class="ltx_td ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.13.12.2.1" class="ltx_text" style="font-size:90%;">63.33</span></td>
<td id="S3.T1.1.13.12.3" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.13.12.3.1" class="ltx_text" style="font-size:90%;">59.55</span></td>
<td id="S3.T1.1.13.12.4" class="ltx_td ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.13.12.4.1" class="ltx_text" style="font-size:90%;">34.42</span></td>
<td id="S3.T1.1.13.12.5" class="ltx_td ltx_align_left" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.13.12.5.1" class="ltx_text" style="font-size:90%;">33.11</span></td>
</tr>
<tr id="S3.T1.1.14.13" class="ltx_tr">
<th id="S3.T1.1.14.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.14.13.1.1" class="ltx_text" style="font-size:90%;">FedAFA_Loc</span></th>
<td id="S3.T1.1.14.13.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.14.13.2.1" class="ltx_text" style="font-size:90%;">62.24</span></td>
<td id="S3.T1.1.14.13.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.14.13.3.1" class="ltx_text" style="font-size:90%;">62.15</span></td>
<td id="S3.T1.1.14.13.4" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.14.13.4.1" class="ltx_text" style="font-size:90%;">34.12</span></td>
<td id="S3.T1.1.14.13.5" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.14.13.5.1" class="ltx_text" style="font-size:90%;">33.06</span></td>
</tr>
<tr id="S3.T1.1.15.14" class="ltx_tr">
<th id="S3.T1.1.15.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S3.T1.1.15.14.1.1" class="ltx_text" style="font-size:90%;">FedAFA</span></th>
<td id="S3.T1.1.15.14.2" class="ltx_td ltx_align_left ltx_border_b" style="padding-top:0.9pt;padding-bottom:0.9pt;">
<div id="S3.T1.1.15.14.2.1" class="ltx_inline-block ltx_transformed_outer" style="width:20.5pt;height:5.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<p id="S3.T1.1.15.14.2.1.1" class="ltx_p"><span id="S3.T1.1.15.14.2.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">64.52</span></p>
</span></div>
</td>
<td id="S3.T1.1.15.14.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_r" style="padding-top:0.9pt;padding-bottom:0.9pt;">
<div id="S3.T1.1.15.14.3.1" class="ltx_inline-block ltx_transformed_outer" style="width:20.5pt;height:5.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<p id="S3.T1.1.15.14.3.1.1" class="ltx_p"><span id="S3.T1.1.15.14.3.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">63.70</span></p>
</span></div>
</td>
<td id="S3.T1.1.15.14.4" class="ltx_td ltx_align_left ltx_border_b" style="padding-top:0.9pt;padding-bottom:0.9pt;">
<div id="S3.T1.1.15.14.4.1" class="ltx_inline-block ltx_transformed_outer" style="width:20.5pt;height:5.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<p id="S3.T1.1.15.14.4.1.1" class="ltx_p"><span id="S3.T1.1.15.14.4.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">36.57</span></p>
</span></div>
</td>
<td id="S3.T1.1.15.14.5" class="ltx_td ltx_align_left ltx_border_b" style="padding-top:0.9pt;padding-bottom:0.9pt;">
<div id="S3.T1.1.15.14.5.1" class="ltx_inline-block ltx_transformed_outer" style="width:20.5pt;height:5.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<p id="S3.T1.1.15.14.5.1.1" class="ltx_p"><span id="S3.T1.1.15.14.5.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">35.44</span></p>
</span></div>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table"><span id="S3.T1.5.1.1" class="ltx_text ltx_font_bold">Table 1</span>: </span>Test accuracy (%) of FedAFA compared with different methods. The best results are shown in bold.</figcaption>
</figure>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">As shown in Table 1, the performance of local training is poor because the model is only trained locally without any communication with other clients. Other PFL methods that only take data heterogeneity into account without considering the long-tail distribution also underperform compared with the methods that specifically address the long-tail distribution. Although these two groups of PFL methods improve FedAvg-FT from different perspectives, FedAFA is the only method consistently achieving promising personalized performance. In addition, by comparing the test accuracy of FedAFA_Loc and FedAFA, it is verified that the features extracted by the global model are more robust because more local noise is introduced when selecting the local personalized model to generate features.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">To show that FedAFA produces better personalized models for each client, we evaluate the performance boost by FedAFA on each class against the baseline FedAvg-FT from the global perspective in Figure <a href="#S3.F3" title="Figure 3 ‣ 3.3 Effects of Hyperparameters ‣ 3 Experiments ‣ Personalized Federated Learning on Long-Tailed Data via Adversarial Feature Augmentation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>(a). It can be observed that FedAFA improves the performance for almost every class. In addition, we randomly select one client from all clients to illustrate the improvement of FedAFA on local minority classes. As shown in Figure <a href="#S3.F3" title="Figure 3 ‣ 3.3 Effects of Hyperparameters ‣ 3 Experiments ‣ Personalized Federated Learning on Long-Tailed Data via Adversarial Feature Augmentation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>(b), FedAFA can significantly improve the accuracy of local minority classes with only a few samples while keeping the same accuracy on the majority classes. These two experiments validate that FedAFA can improve the tail classes’ generalization ability while guaranteeing the head classes’ performance.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Effects of Hyperparameters</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.2" class="ltx_p">In FedAFA, there are three hyperparameters: the balance factor <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\lambda</annotation></semantics></math>, the drop probability <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="p_{d}" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><msub id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">p</mi><mi id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2">𝑝</ci><ci id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">p_{d}</annotation></semantics></math>, and the selected layer for feature augmentation. We conduct various experiments on CIFAR-10-LT to evaluate their influences.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.7" class="ltx_p">We first compare the performance of FedAFA with <math id="S3.SS3.p2.1.m1.2" class="ltx_Math" alttext="\lambda\in[0,1]" display="inline"><semantics id="S3.SS3.p2.1.m1.2a"><mrow id="S3.SS3.p2.1.m1.2.3" xref="S3.SS3.p2.1.m1.2.3.cmml"><mi id="S3.SS3.p2.1.m1.2.3.2" xref="S3.SS3.p2.1.m1.2.3.2.cmml">λ</mi><mo id="S3.SS3.p2.1.m1.2.3.1" xref="S3.SS3.p2.1.m1.2.3.1.cmml">∈</mo><mrow id="S3.SS3.p2.1.m1.2.3.3.2" xref="S3.SS3.p2.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS3.p2.1.m1.2.3.3.2.1" xref="S3.SS3.p2.1.m1.2.3.3.1.cmml">[</mo><mn id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">0</mn><mo id="S3.SS3.p2.1.m1.2.3.3.2.2" xref="S3.SS3.p2.1.m1.2.3.3.1.cmml">,</mo><mn id="S3.SS3.p2.1.m1.2.2" xref="S3.SS3.p2.1.m1.2.2.cmml">1</mn><mo stretchy="false" id="S3.SS3.p2.1.m1.2.3.3.2.3" xref="S3.SS3.p2.1.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.2b"><apply id="S3.SS3.p2.1.m1.2.3.cmml" xref="S3.SS3.p2.1.m1.2.3"><in id="S3.SS3.p2.1.m1.2.3.1.cmml" xref="S3.SS3.p2.1.m1.2.3.1"></in><ci id="S3.SS3.p2.1.m1.2.3.2.cmml" xref="S3.SS3.p2.1.m1.2.3.2">𝜆</ci><interval closure="closed" id="S3.SS3.p2.1.m1.2.3.3.1.cmml" xref="S3.SS3.p2.1.m1.2.3.3.2"><cn type="integer" id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">0</cn><cn type="integer" id="S3.SS3.p2.1.m1.2.2.cmml" xref="S3.SS3.p2.1.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.2c">\lambda\in[0,1]</annotation></semantics></math> in Figure <a href="#S3.F4" title="Figure 4 ‣ 3.3 Effects of Hyperparameters ‣ 3 Experiments ‣ Personalized Federated Learning on Long-Tailed Data via Adversarial Feature Augmentation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>(a). FedAFA degenerates into the case of only training on <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{k}^{bal}" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><msubsup id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.2.m2.1.1.2.2" xref="S3.SS3.p2.2.m2.1.1.2.2.cmml">𝒟</mi><mi id="S3.SS3.p2.2.m2.1.1.2.3" xref="S3.SS3.p2.2.m2.1.1.2.3.cmml">k</mi><mrow id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml"><mi id="S3.SS3.p2.2.m2.1.1.3.2" xref="S3.SS3.p2.2.m2.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.2.m2.1.1.3.1" xref="S3.SS3.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.2.m2.1.1.3.3" xref="S3.SS3.p2.2.m2.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.2.m2.1.1.3.1a" xref="S3.SS3.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.2.m2.1.1.3.4" xref="S3.SS3.p2.2.m2.1.1.3.4.cmml">l</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">superscript</csymbol><apply id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.2.1.cmml" xref="S3.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2.2">𝒟</ci><ci id="S3.SS3.p2.2.m2.1.1.2.3.cmml" xref="S3.SS3.p2.2.m2.1.1.2.3">𝑘</ci></apply><apply id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3"><times id="S3.SS3.p2.2.m2.1.1.3.1.cmml" xref="S3.SS3.p2.2.m2.1.1.3.1"></times><ci id="S3.SS3.p2.2.m2.1.1.3.2.cmml" xref="S3.SS3.p2.2.m2.1.1.3.2">𝑏</ci><ci id="S3.SS3.p2.2.m2.1.1.3.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3.3">𝑎</ci><ci id="S3.SS3.p2.2.m2.1.1.3.4.cmml" xref="S3.SS3.p2.2.m2.1.1.3.4">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">\mathcal{D}_{k}^{bal}</annotation></semantics></math> when <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="\lambda=0" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><mrow id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">λ</mi><mo id="S3.SS3.p2.3.m3.1.1.1" xref="S3.SS3.p2.3.m3.1.1.1.cmml">=</mo><mn id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><eq id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1.1"></eq><ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">𝜆</ci><cn type="integer" id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">\lambda=0</annotation></semantics></math>, and FedAFA is equivalent to the case of only training on <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{G}_{k}" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><msub id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml">𝒢</mi><mi id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2">𝒢</ci><ci id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">\mathcal{G}_{k}</annotation></semantics></math> when <math id="S3.SS3.p2.5.m5.1" class="ltx_Math" alttext="\lambda=1" display="inline"><semantics id="S3.SS3.p2.5.m5.1a"><mrow id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml"><mi id="S3.SS3.p2.5.m5.1.1.2" xref="S3.SS3.p2.5.m5.1.1.2.cmml">λ</mi><mo id="S3.SS3.p2.5.m5.1.1.1" xref="S3.SS3.p2.5.m5.1.1.1.cmml">=</mo><mn id="S3.SS3.p2.5.m5.1.1.3" xref="S3.SS3.p2.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><apply id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1"><eq id="S3.SS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1.1"></eq><ci id="S3.SS3.p2.5.m5.1.1.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2">𝜆</ci><cn type="integer" id="S3.SS3.p2.5.m5.1.1.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">\lambda=1</annotation></semantics></math>. It can be observed that <math id="S3.SS3.p2.6.m6.2" class="ltx_Math" alttext="\lambda\in[0.6,0.8]" display="inline"><semantics id="S3.SS3.p2.6.m6.2a"><mrow id="S3.SS3.p2.6.m6.2.3" xref="S3.SS3.p2.6.m6.2.3.cmml"><mi id="S3.SS3.p2.6.m6.2.3.2" xref="S3.SS3.p2.6.m6.2.3.2.cmml">λ</mi><mo id="S3.SS3.p2.6.m6.2.3.1" xref="S3.SS3.p2.6.m6.2.3.1.cmml">∈</mo><mrow id="S3.SS3.p2.6.m6.2.3.3.2" xref="S3.SS3.p2.6.m6.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS3.p2.6.m6.2.3.3.2.1" xref="S3.SS3.p2.6.m6.2.3.3.1.cmml">[</mo><mn id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml">0.6</mn><mo id="S3.SS3.p2.6.m6.2.3.3.2.2" xref="S3.SS3.p2.6.m6.2.3.3.1.cmml">,</mo><mn id="S3.SS3.p2.6.m6.2.2" xref="S3.SS3.p2.6.m6.2.2.cmml">0.8</mn><mo stretchy="false" id="S3.SS3.p2.6.m6.2.3.3.2.3" xref="S3.SS3.p2.6.m6.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.2b"><apply id="S3.SS3.p2.6.m6.2.3.cmml" xref="S3.SS3.p2.6.m6.2.3"><in id="S3.SS3.p2.6.m6.2.3.1.cmml" xref="S3.SS3.p2.6.m6.2.3.1"></in><ci id="S3.SS3.p2.6.m6.2.3.2.cmml" xref="S3.SS3.p2.6.m6.2.3.2">𝜆</ci><interval closure="closed" id="S3.SS3.p2.6.m6.2.3.3.1.cmml" xref="S3.SS3.p2.6.m6.2.3.3.2"><cn type="float" id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">0.6</cn><cn type="float" id="S3.SS3.p2.6.m6.2.2.cmml" xref="S3.SS3.p2.6.m6.2.2">0.8</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.2c">\lambda\in[0.6,0.8]</annotation></semantics></math> generally performs better than either extreme case, which validates the effectiveness of the proposed loss function <math id="S3.SS3.p2.7.m7.1" class="ltx_Math" alttext="L_{AFA}" display="inline"><semantics id="S3.SS3.p2.7.m7.1a"><msub id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml"><mi id="S3.SS3.p2.7.m7.1.1.2" xref="S3.SS3.p2.7.m7.1.1.2.cmml">L</mi><mrow id="S3.SS3.p2.7.m7.1.1.3" xref="S3.SS3.p2.7.m7.1.1.3.cmml"><mi id="S3.SS3.p2.7.m7.1.1.3.2" xref="S3.SS3.p2.7.m7.1.1.3.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.7.m7.1.1.3.1" xref="S3.SS3.p2.7.m7.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.7.m7.1.1.3.3" xref="S3.SS3.p2.7.m7.1.1.3.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.7.m7.1.1.3.1a" xref="S3.SS3.p2.7.m7.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.7.m7.1.1.3.4" xref="S3.SS3.p2.7.m7.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.1b"><apply id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.7.m7.1.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.p2.7.m7.1.1.2.cmml" xref="S3.SS3.p2.7.m7.1.1.2">𝐿</ci><apply id="S3.SS3.p2.7.m7.1.1.3.cmml" xref="S3.SS3.p2.7.m7.1.1.3"><times id="S3.SS3.p2.7.m7.1.1.3.1.cmml" xref="S3.SS3.p2.7.m7.1.1.3.1"></times><ci id="S3.SS3.p2.7.m7.1.1.3.2.cmml" xref="S3.SS3.p2.7.m7.1.1.3.2">𝐴</ci><ci id="S3.SS3.p2.7.m7.1.1.3.3.cmml" xref="S3.SS3.p2.7.m7.1.1.3.3">𝐹</ci><ci id="S3.SS3.p2.7.m7.1.1.3.4.cmml" xref="S3.SS3.p2.7.m7.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.1c">L_{AFA}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.5" class="ltx_p">The performance of FedAFA with <math id="S3.SS3.p3.1.m1.2" class="ltx_Math" alttext="p_{d}\in(0,1)" display="inline"><semantics id="S3.SS3.p3.1.m1.2a"><mrow id="S3.SS3.p3.1.m1.2.3" xref="S3.SS3.p3.1.m1.2.3.cmml"><msub id="S3.SS3.p3.1.m1.2.3.2" xref="S3.SS3.p3.1.m1.2.3.2.cmml"><mi id="S3.SS3.p3.1.m1.2.3.2.2" xref="S3.SS3.p3.1.m1.2.3.2.2.cmml">p</mi><mi id="S3.SS3.p3.1.m1.2.3.2.3" xref="S3.SS3.p3.1.m1.2.3.2.3.cmml">d</mi></msub><mo id="S3.SS3.p3.1.m1.2.3.1" xref="S3.SS3.p3.1.m1.2.3.1.cmml">∈</mo><mrow id="S3.SS3.p3.1.m1.2.3.3.2" xref="S3.SS3.p3.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS3.p3.1.m1.2.3.3.2.1" xref="S3.SS3.p3.1.m1.2.3.3.1.cmml">(</mo><mn id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">0</mn><mo id="S3.SS3.p3.1.m1.2.3.3.2.2" xref="S3.SS3.p3.1.m1.2.3.3.1.cmml">,</mo><mn id="S3.SS3.p3.1.m1.2.2" xref="S3.SS3.p3.1.m1.2.2.cmml">1</mn><mo stretchy="false" id="S3.SS3.p3.1.m1.2.3.3.2.3" xref="S3.SS3.p3.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.2b"><apply id="S3.SS3.p3.1.m1.2.3.cmml" xref="S3.SS3.p3.1.m1.2.3"><in id="S3.SS3.p3.1.m1.2.3.1.cmml" xref="S3.SS3.p3.1.m1.2.3.1"></in><apply id="S3.SS3.p3.1.m1.2.3.2.cmml" xref="S3.SS3.p3.1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.2.3.2.1.cmml" xref="S3.SS3.p3.1.m1.2.3.2">subscript</csymbol><ci id="S3.SS3.p3.1.m1.2.3.2.2.cmml" xref="S3.SS3.p3.1.m1.2.3.2.2">𝑝</ci><ci id="S3.SS3.p3.1.m1.2.3.2.3.cmml" xref="S3.SS3.p3.1.m1.2.3.2.3">𝑑</ci></apply><interval closure="open" id="S3.SS3.p3.1.m1.2.3.3.1.cmml" xref="S3.SS3.p3.1.m1.2.3.3.2"><cn type="integer" id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">0</cn><cn type="integer" id="S3.SS3.p3.1.m1.2.2.cmml" xref="S3.SS3.p3.1.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.2c">p_{d}\in(0,1)</annotation></semantics></math> is also shown in Figure <a href="#S3.F4" title="Figure 4 ‣ 3.3 Effects of Hyperparameters ‣ 3 Experiments ‣ Personalized Federated Learning on Long-Tailed Data via Adversarial Feature Augmentation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>(b). It can be observed that the performance increases as <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="p_{d}" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><msub id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml"><mi id="S3.SS3.p3.2.m2.1.1.2" xref="S3.SS3.p3.2.m2.1.1.2.cmml">p</mi><mi id="S3.SS3.p3.2.m2.1.1.3" xref="S3.SS3.p3.2.m2.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2">𝑝</ci><ci id="S3.SS3.p3.2.m2.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">p_{d}</annotation></semantics></math> reaches 0.5 and then decreases when <math id="S3.SS3.p3.3.m3.1" class="ltx_Math" alttext="p_{d}" display="inline"><semantics id="S3.SS3.p3.3.m3.1a"><msub id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml"><mi id="S3.SS3.p3.3.m3.1.1.2" xref="S3.SS3.p3.3.m3.1.1.2.cmml">p</mi><mi id="S3.SS3.p3.3.m3.1.1.3" xref="S3.SS3.p3.3.m3.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><apply id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p3.3.m3.1.1.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2">𝑝</ci><ci id="S3.SS3.p3.3.m3.1.1.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">p_{d}</annotation></semantics></math> reaches 1. When <math id="S3.SS3.p3.4.m4.1" class="ltx_Math" alttext="p_{d}" display="inline"><semantics id="S3.SS3.p3.4.m4.1a"><msub id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml"><mi id="S3.SS3.p3.4.m4.1.1.2" xref="S3.SS3.p3.4.m4.1.1.2.cmml">p</mi><mi id="S3.SS3.p3.4.m4.1.1.3" xref="S3.SS3.p3.4.m4.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><apply id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.1.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p3.4.m4.1.1.2.cmml" xref="S3.SS3.p3.4.m4.1.1.2">𝑝</ci><ci id="S3.SS3.p3.4.m4.1.1.3.cmml" xref="S3.SS3.p3.4.m4.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">p_{d}</annotation></semantics></math> is close to 1, only a few generated features can be selected for personalized training, which may only provide limited help.
On the other hand, when <math id="S3.SS3.p3.5.m5.1" class="ltx_Math" alttext="p_{d}" display="inline"><semantics id="S3.SS3.p3.5.m5.1a"><msub id="S3.SS3.p3.5.m5.1.1" xref="S3.SS3.p3.5.m5.1.1.cmml"><mi id="S3.SS3.p3.5.m5.1.1.2" xref="S3.SS3.p3.5.m5.1.1.2.cmml">p</mi><mi id="S3.SS3.p3.5.m5.1.1.3" xref="S3.SS3.p3.5.m5.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.1b"><apply id="S3.SS3.p3.5.m5.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.1.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p3.5.m5.1.1.2.cmml" xref="S3.SS3.p3.5.m5.1.1.2">𝑝</ci><ci id="S3.SS3.p3.5.m5.1.1.3.cmml" xref="S3.SS3.p3.5.m5.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.1c">p_{d}</annotation></semantics></math> is close to 0, generated features with any confidence are used for personalized training. They cannot focus on improving the decision boundary between the local majority and minority classes. Therefore, this experiment validates that drop probability can effectively select generated features helpful for personalized training.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<p id="S3.SS3.p4.1" class="ltx_p">Finally, Figure <a href="#S3.F4" title="Figure 4 ‣ 3.3 Effects of Hyperparameters ‣ 3 Experiments ‣ Personalized Federated Learning on Long-Tailed Data via Adversarial Feature Augmentation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>(c) shows the performance of FedAFA by augmenting features on different blocks of ResNet32. It can be seen that FedAFA performs best when we select the features of Block 3 or Block 4. This observation confirms that selecting the feature space for augmentation is more effective than the sample space.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2303.15168/assets/x4.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="178" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.4.1.1" class="ltx_text ltx_font_bold">Fig. 3</span>: </span>Visualization of test accuracy change on each class with <math id="S3.F3.2.m1.1" class="ltx_Math" alttext="\alpha=0.2" display="inline"><semantics id="S3.F3.2.m1.1b"><mrow id="S3.F3.2.m1.1.1" xref="S3.F3.2.m1.1.1.cmml"><mi id="S3.F3.2.m1.1.1.2" xref="S3.F3.2.m1.1.1.2.cmml">α</mi><mo id="S3.F3.2.m1.1.1.1" xref="S3.F3.2.m1.1.1.1.cmml">=</mo><mn id="S3.F3.2.m1.1.1.3" xref="S3.F3.2.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F3.2.m1.1c"><apply id="S3.F3.2.m1.1.1.cmml" xref="S3.F3.2.m1.1.1"><eq id="S3.F3.2.m1.1.1.1.cmml" xref="S3.F3.2.m1.1.1.1"></eq><ci id="S3.F3.2.m1.1.1.2.cmml" xref="S3.F3.2.m1.1.1.2">𝛼</ci><cn type="float" id="S3.F3.2.m1.1.1.3.cmml" xref="S3.F3.2.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.2.m1.1d">\alpha=0.2</annotation></semantics></math>. (a) The class index is sorted from head classes to tail classes from the global perspective. (b) The numbers of samples of each class from left to right are {8, 933, 9, 6}.</figcaption>
</figure>
<figure id="S3.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S3.F4.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_bottom" style="width:76.0pt;">
<img src="/html/2303.15168/assets/x5.png" id="S3.F4.1.g1" class="ltx_graphics ltx_img_portrait" width="540" height="693" alt="Refer to caption">
<p id="S3.F4.2.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S3.F4.2.1.1" class="ltx_text">(a) <math id="S3.F4.2.1.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.F4.2.1.1.m1.1a"><mi id="S3.F4.2.1.1.m1.1.1" xref="S3.F4.2.1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.F4.2.1.1.m1.1b"><ci id="S3.F4.2.1.1.m1.1.1.cmml" xref="S3.F4.2.1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.2.1.1.m1.1c">\lambda</annotation></semantics></math></span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S3.F4.4" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_bottom" style="width:76.0pt;">
<img src="/html/2303.15168/assets/x6.png" id="S3.F4.3.g1" class="ltx_graphics ltx_img_portrait" width="537" height="691" alt="Refer to caption">
<p id="S3.F4.4.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S3.F4.4.1.1" class="ltx_text">(b) <math id="S3.F4.4.1.1.m1.1" class="ltx_Math" alttext="p_{d}" display="inline"><semantics id="S3.F4.4.1.1.m1.1a"><msub id="S3.F4.4.1.1.m1.1.1" xref="S3.F4.4.1.1.m1.1.1.cmml"><mi id="S3.F4.4.1.1.m1.1.1.2" xref="S3.F4.4.1.1.m1.1.1.2.cmml">p</mi><mi id="S3.F4.4.1.1.m1.1.1.3" xref="S3.F4.4.1.1.m1.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F4.4.1.1.m1.1b"><apply id="S3.F4.4.1.1.m1.1.1.cmml" xref="S3.F4.4.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.F4.4.1.1.m1.1.1.1.cmml" xref="S3.F4.4.1.1.m1.1.1">subscript</csymbol><ci id="S3.F4.4.1.1.m1.1.1.2.cmml" xref="S3.F4.4.1.1.m1.1.1.2">𝑝</ci><ci id="S3.F4.4.1.1.m1.1.1.3.cmml" xref="S3.F4.4.1.1.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.4.1.1.m1.1c">p_{d}</annotation></semantics></math></span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S3.F4.5" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_bottom" style="width:76.0pt;">
<img src="/html/2303.15168/assets/x7.png" id="S3.F4.5.g1" class="ltx_graphics ltx_img_portrait" width="537" height="691" alt="Refer to caption">
<p id="S3.F4.5.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S3.F4.5.1.1" class="ltx_text">(c) Selected layer</span></p>
</div>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S3.F4.7.1.1" class="ltx_text ltx_font_bold">Fig. 4</span>: </span>Effects of hyperparameters of FedAFA.</figcaption>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Conclusion</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this paper, FedAFA is proposed to solve the problem of PFL with heterogeneous and long-tailed data. FedAFA first transfers the knowledge of the local majority class to the local minority class to improve the performance of the local minority class. At the same time, FedAFA proposes a new optimization objective to maintain the performance of local majority classes. Therefore, FedAFA can enhance the generalization ability of the local minority classes while preserving the robust performance of the local majority classes. Experimental results show the superiority of FedAFA compared to other state-of-the-art PFL methods under different settings.</p>
</div>
<div id="S4.p2" class="ltx_para ltx_noindent">
<p id="S4.p2.1" class="ltx_p"><span id="S4.p2.1.1" class="ltx_text ltx_font_bold">Acknowledgement </span>This study was supported by the National Natural Science Foundation of China under Grants 62002302 and U21A20514, the Open Research Projects of Zhejiang Lab under Grant 2021KB0AB03, the FuXiaQuan National Independent Innovation Demonstration Zone Collaborative Innovation Platform under Grant 3502ZCQXT2022008 and the Natural Science Foundation of Fujian Province under Grant 2020J01005.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Dhruv Guliani, Françoise Beaufays, and Giovanni Motta,

</span>
<span class="ltx_bibblock">“Training speech recognition models with federated learning: A
quality/cost framework,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">IEEE International Conference on Acoustics, Speech and Signal
Processing</span>, 2021, pp. 3080–3084.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Xiaodong Cui, Songtao Lu, and Brian Kingsbury,

</span>
<span class="ltx_bibblock">“Federated acoustic modeling for automatic speech recognition,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">IEEE International Conference on Acoustics, Speech and Signal
Processing</span>, 2021, pp. 6748–6752.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Mehdi Salehi Heydar Abad, Emre Ozfatura, Deniz Gunduz, and Ozgur Ercetin,

</span>
<span class="ltx_bibblock">“Hierarchical federated learning across heterogeneous cellular
networks,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">IEEE International Conference on Acoustics, Speech and Signal
Processing</span>, 2020, pp. 8866–8870.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Hasin Us Sami and Başak Güler,

</span>
<span class="ltx_bibblock">“Over-the-air personalized federated learning,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">IEEE International Conference on Acoustics, Speech and Signal
Processing</span>, 2022, pp. 8777–8781.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Filip Hanzely and Peter Richtárik,

</span>
<span class="ltx_bibblock">“Federated learning of a mixture of global and local models,”

</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">arXiv</span>, 2020.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Canh T. Dinh, Nguyen Tran, and Josh Nguyen,

</span>
<span class="ltx_bibblock">“Personalized federated learning with moreau envelopes,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, 2020, pp.
21394–21405.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Tian Li, Shengyuan Hu, Ahmad Beirami, and Virginia Smith,

</span>
<span class="ltx_bibblock">“Ditto: Fair and robust federated learning through
personalization,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, 2021, pp.
6357–6368.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Alireza Fallah, Aryan Mokhtari, and Asuman Ozdaglar,

</span>
<span class="ltx_bibblock">“Personalized federated learning with theoretical guarantees: A
model-agnostic meta-learning approach,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, 2020, pp.
3557–3568.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Yin Cui, Menglin Jia, Tsung-Yi Lin, Yang Song, and Serge Belongie,

</span>
<span class="ltx_bibblock">“Class-balanced loss based on effective number of samples,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">IEEE/CVF International Conference on Computer Vision</span>, 2019,
pp. 9268–9277.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Seulki Park, Jongin Lim, Younghan Jeon, and Jin Young Choi,

</span>
<span class="ltx_bibblock">“Influence-balanced loss for imbalanced visual classification,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">IEEE/CVF International Conference on Computer Vision</span>, 2021,
pp. 735–744.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Kaidi Cao, Colin Wei, Adrien Gaidon, Nikos Arechiga, and Tengyu Ma,

</span>
<span class="ltx_bibblock">“Learning imbalanced datasets with label-distribution-aware margin
loss,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">International Conference on Neural Information Processing
Systems</span>, 2019, pp. 1567–1578.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Andrew Ilyas, Shibani Santurkar, Dimitris Tsipras, Logan Engstrom, Brandon
Tran, and Aleksander Madry,

</span>
<span class="ltx_bibblock">“Adversarial examples are not bugs, they are features,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">International Conference on Neural Information Processing
Systems</span>, 2019, pp. 125–136.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Ian J Goodfellow, Jonathon Shlens, and Christian Szegedy,

</span>
<span class="ltx_bibblock">“Explaining and harnessing adversarial examples,”

</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">arXiv</span>, 2014.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Kangkang Wang, Rajiv Mathews, Chloé Kiddon, Hubert Eichner, Françoise
Beaufays, and Daniel Ramage,

</span>
<span class="ltx_bibblock">“Federated evaluation of on-device personalization,”

</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">arXiv</span>, 2019.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Boyan Zhou, Quan Cui, Xiu-Shen Wei, and Zhao-Min Chen,

</span>
<span class="ltx_bibblock">“Bbn: Bilateral-branch network with cumulative learning for
long-tailed visual recognition,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">IEEE/CVF Conference on Computer Vision and Pattern
Recognition</span>, 2020, pp. 9719–9728.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Bingyi Kang, Saining Xie, Marcus Rohrbach, Zhicheng Yan, Albert Gordo, Jiashi
Feng, and Yannis Kalantidis,

</span>
<span class="ltx_bibblock">“Decoupling representation and classifier for long-tailed
recognition,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations</span>, 2020,
pp. 1–16.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Mi Luo, Fei Chen, Dapeng Hu, Yifan Zhang, Jian Liang, and Jiashi Feng,

</span>
<span class="ltx_bibblock">“No fear of heterogeneity: Classifier calibration for federated
learning with non-iid data,”

</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, vol. 34, pp.
5972–5984, 2021.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Alex Krizhevsky, Geoffrey Hinton, et al.,

</span>
<span class="ltx_bibblock">“Learning multiple layers of features from tiny images,”

</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">Technical Reports</span>, 2009.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Tzu-Ming Harry Hsu, Hang Qi, and Matthew Brown,

</span>
<span class="ltx_bibblock">“Measuring the effects of non-identical data distribution for
federated visual classification,”

</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">arXiv</span>, 2019.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Jaehyung Kim, Jongheon Jeong, and Jinwoo Shin,

</span>
<span class="ltx_bibblock">“M2m: Imbalanced classification via major-to-minor translation,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">IEEE/CVF Conference on Computer Vision and Pattern
Recognition</span>, 2020, pp. 13896–13905.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and
Virginia Smith,

</span>
<span class="ltx_bibblock">“Federated optimization in heterogeneous networks,”

</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">arXiv</span>, 2018.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Xiaoxiao Li, Meirui Jiang, Xiaofei Zhang, Michael Kamp, and Qi Dou,

</span>
<span class="ltx_bibblock">“Fedbn: Federated learning on non-iid features via local batch
normalization,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations</span>, 2021,
pp. 1–27.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2303.15167" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2303.15168" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2303.15168">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2303.15168" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2303.15169" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Feb 29 18:15:21 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
