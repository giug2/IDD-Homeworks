<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Segmentation by Factorization: Unsupervised Semantic Segmentation for Pathology by Factorizing Foundation Model Features</title>
<!--Generated on Mon Sep  9 15:11:41 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2409.05697v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.05697v1#S1" title="In Segmentation by Factorization: Unsupervised Semantic Segmentation for Pathology by Factorizing Foundation Model Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.05697v1#S2" title="In Segmentation by Factorization: Unsupervised Semantic Segmentation for Pathology by Factorizing Foundation Model Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.05697v1#S3" title="In Segmentation by Factorization: Unsupervised Semantic Segmentation for Pathology by Factorizing Foundation Model Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methods</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.05697v1#S3.SS1" title="In 3 Methods ‣ Segmentation by Factorization: Unsupervised Semantic Segmentation for Pathology by Factorizing Foundation Model Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Factorizing spatial features of deep neural networks into concepts and segmentation masks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.05697v1#S3.SS2" title="In 3 Methods ‣ Segmentation by Factorization: Unsupervised Semantic Segmentation for Pathology by Factorizing Foundation Model Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Methods for achieving consistent concepts between images</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.05697v1#S3.SS2.SSS1" title="In 3.2 Methods for achieving consistent concepts between images ‣ 3 Methods ‣ Segmentation by Factorization: Unsupervised Semantic Segmentation for Pathology by Factorizing Foundation Model Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Assigning factorized concepts to similar clusters</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.05697v1#S3.SS2.SSS2" title="In 3.2 Methods for achieving consistent concepts between images ‣ 3 Methods ‣ Segmentation by Factorization: Unsupervised Semantic Segmentation for Pathology by Factorizing Foundation Model Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>Solving for segmentation masks that correspond to cluster centers</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.05697v1#S3.SS3" title="In 3 Methods ‣ Segmentation by Factorization: Unsupervised Semantic Segmentation for Pathology by Factorizing Foundation Model Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Unsupervised semantic segmentation for H&amp;E images</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.05697v1#S3.SS4" title="In 3 Methods ‣ Segmentation by Factorization: Unsupervised Semantic Segmentation for Pathology by Factorizing Foundation Model Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Evaluation Datasets</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.05697v1#S3.SS4.SSS1" title="In 3.4 Evaluation Datasets ‣ 3 Methods ‣ Segmentation by Factorization: Unsupervised Semantic Segmentation for Pathology by Factorizing Foundation Model Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4.1 </span>Breast Cancer Semantic Segmentation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.05697v1#S3.SS4.SSS2" title="In 3.4 Evaluation Datasets ‣ 3 Methods ‣ Segmentation by Factorization: Unsupervised Semantic Segmentation for Pathology by Factorizing Foundation Model Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4.2 </span>WSSS4LUAD</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.05697v1#S3.SS5" title="In 3 Methods ‣ Segmentation by Factorization: Unsupervised Semantic Segmentation for Pathology by Factorizing Foundation Model Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>Evaluation methods</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.05697v1#S3.SS5.SSS1" title="In 3.5 Evaluation methods ‣ 3 Methods ‣ Segmentation by Factorization: Unsupervised Semantic Segmentation for Pathology by Factorizing Foundation Model Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5.1 </span>Linear probing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.05697v1#S3.SS5.SSS2" title="In 3.5 Evaluation methods ‣ 3 Methods ‣ Segmentation by Factorization: Unsupervised Semantic Segmentation for Pathology by Factorizing Foundation Model Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5.2 </span>Matching based on cluster-category frequencies</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.05697v1#S4" title="In Segmentation by Factorization: Unsupervised Semantic Segmentation for Pathology by Factorizing Foundation Model Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.05697v1#S5" title="In Segmentation by Factorization: Unsupervised Semantic Segmentation for Pathology by Factorizing Foundation Model Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Discussion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2409.05697v1#A1" title="In Segmentation by Factorization: Unsupervised Semantic Segmentation for Pathology by Factorizing Foundation Model Features"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Examples of F-SEG unsupervised semantic segmentation</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div class="ltx_para" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">\addbibresource</span>
<p class="ltx_p" id="p1.2">references.bibl
















</p>
</div>
<h1 class="ltx_title ltx_title_document">Segmentation by Factorization: Unsupervised Semantic Segmentation for Pathology by Factorizing Foundation Model Features </h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Jacob Gildenblat<sup class="ltx_sup" id="id3.2.id1">∗</sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">DeePathology.ai
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Ofir Hadar<sup class="ltx_sup" id="id4.2.id1">∗</sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">DeePathology.ai
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id5.id1">We introduce Segmentation by Factorization (F-SEG), an unsupervised segmentation method for pathology that generates segmentation masks from pre-trained deep learning models. F-SEG allows the use of pre-trained deep neural networks, including recently developed pathology foundation models, for semantic segmentation. It achieves this without requiring additional training or fine-tuning, by factorizing the spatial features extracted by the models into segmentation masks and their associated concept features. We create generic tissue phenotypes for H&amp;E images by training clustering models for multiple numbers of clusters on features extracted from several deep learning models on TCGA <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">tcga_dataset</span>]</cite>, and then show how the clusters can be used for factorizing corresponding segmentation masks using off-the-shelf deep learning models. Our results show that F-SEG provides robust unsupervised segmentation capabilities for H&amp;E pathology images, and that the segmentation quality is greatly improved by utilizing pathology foundation models. We discuss and propose methods for evaluating the performance of unsupervised segmentation in pathology.</p>
</div>
<span class="ltx_note ltx_role_footnotetext" id="footnotex1"><sup class="ltx_note_mark">${}^{\ast}$</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">${}^{\ast}$</sup><span class="ltx_note_type">footnotetext: </span>These authors contributed equally to this work</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Segmentation models are widely used in applications of digital pathology for focusing on regions of interest, such as detecting tumor regions, or performing a subsequent analysis only inside specific regions, or excluding non-cellular areas <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">xu2015deep</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">xu2016deep</span>]</cite>. These segmentation masks can also serve as predictive features by quantifying the area of a specific region or counting cells within that region (e.g., <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">diao2021human</span>]</cite>). We explore the use of existing pre-trained neural networks for semantic segmentation, without the need to train dedicated segmentation models for new datasets. As research progresses in developing pre-trained models for pathology, often referred to as foundation models when these are large models trained on large datasets, leveraging these off-the-shelf models can reduce barriers to create segmentation models and potentially enhance segmentation accuracy as the pre-trained models improve.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">This capability is useful in various tasks, such as expediting semantic segmentation annotations through automatic annotations, proposing regions of interests in slides, quantifying objects in different region types, or enabling interpretability by examining how model outputs interact with different region types.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Our contributions are as follows:</p>
</div>
<div class="ltx_para" id="S1.p4">
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We demonstrate that Non-Negative Matrix Factorization (NMF) <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">NIPS2005_d58e2f07</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">tandon2010sparse</span>]</cite> on top of spatial activations extracted from deep neural networks can be used to generate consistent and meaningful semantic segmentation masks for pathology. We propose two ways of achieving this. One is by applying NMF on top of the spatial activations to factorize them into a segmentation mask and concept features, and then classifying the concept features with a clustering model that can be created on a different dataset. The second way is to apply NMF where one of the matrices is fixed and set to be the cluster centers, and then solve for a segmentation mask that corresponds to these clusters. The achieved segmentation does not require training deep networks, allows utilizing off-the-shelf deep learning models, and allows segmentation into a varying number of categories depending on the need.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We use this to create a generic unsupervised semantic segmentation method for H&amp;E for a varying number of categories and for several deep learning models, and benchmark the proposed unsupervised segmentation method on H&amp;E segmentation tasks to show that the achieved segmentation correspond with annotated categories in semantic segmentation datasets. Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.05697v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Segmentation by Factorization: Unsupervised Semantic Segmentation for Pathology by Factorizing Foundation Model Features"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates an example of the output segmentation.</p>
</div>
</li>
</ol>
</div>
<figure class="ltx_figure" id="S1.F1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>An example of F-SEG semantic segmentation with the UNI foundation model and k=64 TCGA clusters</figcaption><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="463" id="S1.F1.g1" src="extracted/5841227/images/uni_luad_64.png" width="463"/>
</figure>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">Image segmentation has been a central topic in computer vision research for decades. It is typically categorized into three types: semantic segmentation <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">asgari2021deep</span>]</cite>, instance segmentation <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">minaee2021image</span>]</cite>, and panoptic segmentation <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">kirillov2019panoptic</span>]</cite>. This paper focuses on semantic segmentation, where the objective is to classify each pixel in an image into one of several categories. In supervised semantic segmentation, the process involves images with known categories and detailed pixel-wise annotations. Deep learning models like U-Net <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">ronneberger2015u</span>]</cite> have achieved impressive results in this area and are commonly used across various domains, including medical imaging <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">azad2022medical</span>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">In contrast, unsupervised semantic segmentation does not rely on predefined categories or pixel-wise annotations. Instead, the goal is to discover representative categories from the data itself and then generate pixel-wise classifications based on these categories. Previous approaches often involve designing a specific loss function for unsupervised segmentation and training a deep learning model such as U-Net using this loss. For example, <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">wnet</span>]</cite> introduces an encoder/decoder framework where the encoder performs a k-way segmentation into k unknown categories, and the decoder reconstructs the image from features produced by the encoder. They employ a soft normalized cut loss to ensure similarity within the same category and dissimilarity between different categories. On the other hand, <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">useg2020</span>]</cite> uses a loss function applied to the output of a U-Net decoder to ensure that pixels with the same label have similar features, ensuring spatial continuity while promoting a larger amount of clusters.</p>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.1">Weakly supervised semantic segmentation, another related approach <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">wei2016stc</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">huang2018weakly</span>]</cite>, involves the use of weaker labels such as bounding boxes or image-level labels rather than pixel-wise annotations. Methods like Grad-CAM <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">GradCAM</span>]</cite> use these weaker labels to generate attribution maps, which are then processed to create pseudo-segmentation masks for training purposes. Affinity-Net <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">Ahn_2018_CVPR</span>]</cite> is one such method that leverages these pseudo-masks for training. Our approach shares similarities with this method in that it uses activations from a model to create pseudo-segmentation masks, but unlike these methods, we do not use any predefined image labels.</p>
</div>
<div class="ltx_para" id="S2.p4">
<p class="ltx_p" id="S2.p4.1">Deep Feature Factorization <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">collins2018deep</span>]</cite> applies NMF on the activations of deep neural networks to visualize similar features in different parts of an image and perform co-segmentation <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">rother2006cosegmentation</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">mukherjee2009half</span>]</cite> across multiple images. Unlike methods that rely on attribution maps, this approach does not require tile labels. Inspired by Deep Feature Factorization, our method aims to utilize the features of a pretrained network based solely on its activations, without the need for annotations.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methods</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Factorizing spatial features of deep neural networks into concepts and segmentation masks</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.5">Following the approach proposed in Deep Feature Factorization <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">collins2018deep</span>]</cite>, we apply NMF on the spatial activations of a pre-trained neural network on an image. The goal is to factorize these activations into a concept feature matrix and a semantic segmentation of the concepts. We start by extracting the spatial activations of a pre-trained network, assumed here to be non negative, resulting in a tensor of shape <math alttext="rows\times cols\times channels" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mrow id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml"><mrow id="S3.SS1.p1.1.m1.1.1.2.2" xref="S3.SS1.p1.1.m1.1.1.2.2.cmml"><mrow id="S3.SS1.p1.1.m1.1.1.2.2.2" xref="S3.SS1.p1.1.m1.1.1.2.2.2.cmml"><mrow id="S3.SS1.p1.1.m1.1.1.2.2.2.2" xref="S3.SS1.p1.1.m1.1.1.2.2.2.2.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2.2.2.2.2" xref="S3.SS1.p1.1.m1.1.1.2.2.2.2.2.cmml">r</mi><mo id="S3.SS1.p1.1.m1.1.1.2.2.2.2.1" xref="S3.SS1.p1.1.m1.1.1.2.2.2.2.1.cmml">⁢</mo><mi id="S3.SS1.p1.1.m1.1.1.2.2.2.2.3" xref="S3.SS1.p1.1.m1.1.1.2.2.2.2.3.cmml">o</mi><mo id="S3.SS1.p1.1.m1.1.1.2.2.2.2.1a" xref="S3.SS1.p1.1.m1.1.1.2.2.2.2.1.cmml">⁢</mo><mi id="S3.SS1.p1.1.m1.1.1.2.2.2.2.4" xref="S3.SS1.p1.1.m1.1.1.2.2.2.2.4.cmml">w</mi><mo id="S3.SS1.p1.1.m1.1.1.2.2.2.2.1b" xref="S3.SS1.p1.1.m1.1.1.2.2.2.2.1.cmml">⁢</mo><mi id="S3.SS1.p1.1.m1.1.1.2.2.2.2.5" xref="S3.SS1.p1.1.m1.1.1.2.2.2.2.5.cmml">s</mi></mrow><mo id="S3.SS1.p1.1.m1.1.1.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.1.m1.1.1.2.2.2.1.cmml">×</mo><mi id="S3.SS1.p1.1.m1.1.1.2.2.2.3" xref="S3.SS1.p1.1.m1.1.1.2.2.2.3.cmml">c</mi></mrow><mo id="S3.SS1.p1.1.m1.1.1.2.2.1" xref="S3.SS1.p1.1.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S3.SS1.p1.1.m1.1.1.2.2.3" xref="S3.SS1.p1.1.m1.1.1.2.2.3.cmml">o</mi><mo id="S3.SS1.p1.1.m1.1.1.2.2.1a" xref="S3.SS1.p1.1.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S3.SS1.p1.1.m1.1.1.2.2.4" xref="S3.SS1.p1.1.m1.1.1.2.2.4.cmml">l</mi><mo id="S3.SS1.p1.1.m1.1.1.2.2.1b" xref="S3.SS1.p1.1.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S3.SS1.p1.1.m1.1.1.2.2.5" xref="S3.SS1.p1.1.m1.1.1.2.2.5.cmml">s</mi></mrow><mo id="S3.SS1.p1.1.m1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.1.m1.1.1.2.1.cmml">×</mo><mi id="S3.SS1.p1.1.m1.1.1.2.3" xref="S3.SS1.p1.1.m1.1.1.2.3.cmml">c</mi></mrow><mo id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">h</mi><mo id="S3.SS1.p1.1.m1.1.1.1a" xref="S3.SS1.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p1.1.m1.1.1.4" xref="S3.SS1.p1.1.m1.1.1.4.cmml">a</mi><mo id="S3.SS1.p1.1.m1.1.1.1b" xref="S3.SS1.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p1.1.m1.1.1.5" xref="S3.SS1.p1.1.m1.1.1.5.cmml">n</mi><mo id="S3.SS1.p1.1.m1.1.1.1c" xref="S3.SS1.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p1.1.m1.1.1.6" xref="S3.SS1.p1.1.m1.1.1.6.cmml">n</mi><mo id="S3.SS1.p1.1.m1.1.1.1d" xref="S3.SS1.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p1.1.m1.1.1.7" xref="S3.SS1.p1.1.m1.1.1.7.cmml">e</mi><mo id="S3.SS1.p1.1.m1.1.1.1e" xref="S3.SS1.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p1.1.m1.1.1.8" xref="S3.SS1.p1.1.m1.1.1.8.cmml">l</mi><mo id="S3.SS1.p1.1.m1.1.1.1f" xref="S3.SS1.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p1.1.m1.1.1.9" xref="S3.SS1.p1.1.m1.1.1.9.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><times id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"></times><apply id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2"><times id="S3.SS1.p1.1.m1.1.1.2.1.cmml" xref="S3.SS1.p1.1.m1.1.1.2.1"></times><apply id="S3.SS1.p1.1.m1.1.1.2.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2.2"><times id="S3.SS1.p1.1.m1.1.1.2.2.1.cmml" xref="S3.SS1.p1.1.m1.1.1.2.2.1"></times><apply id="S3.SS1.p1.1.m1.1.1.2.2.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2.2.2"><times id="S3.SS1.p1.1.m1.1.1.2.2.2.1.cmml" xref="S3.SS1.p1.1.m1.1.1.2.2.2.1"></times><apply id="S3.SS1.p1.1.m1.1.1.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2.2.2.2"><times id="S3.SS1.p1.1.m1.1.1.2.2.2.2.1.cmml" xref="S3.SS1.p1.1.m1.1.1.2.2.2.2.1"></times><ci id="S3.SS1.p1.1.m1.1.1.2.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2.2.2.2.2">𝑟</ci><ci id="S3.SS1.p1.1.m1.1.1.2.2.2.2.3.cmml" xref="S3.SS1.p1.1.m1.1.1.2.2.2.2.3">𝑜</ci><ci id="S3.SS1.p1.1.m1.1.1.2.2.2.2.4.cmml" xref="S3.SS1.p1.1.m1.1.1.2.2.2.2.4">𝑤</ci><ci id="S3.SS1.p1.1.m1.1.1.2.2.2.2.5.cmml" xref="S3.SS1.p1.1.m1.1.1.2.2.2.2.5">𝑠</ci></apply><ci id="S3.SS1.p1.1.m1.1.1.2.2.2.3.cmml" xref="S3.SS1.p1.1.m1.1.1.2.2.2.3">𝑐</ci></apply><ci id="S3.SS1.p1.1.m1.1.1.2.2.3.cmml" xref="S3.SS1.p1.1.m1.1.1.2.2.3">𝑜</ci><ci id="S3.SS1.p1.1.m1.1.1.2.2.4.cmml" xref="S3.SS1.p1.1.m1.1.1.2.2.4">𝑙</ci><ci id="S3.SS1.p1.1.m1.1.1.2.2.5.cmml" xref="S3.SS1.p1.1.m1.1.1.2.2.5">𝑠</ci></apply><ci id="S3.SS1.p1.1.m1.1.1.2.3.cmml" xref="S3.SS1.p1.1.m1.1.1.2.3">𝑐</ci></apply><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">ℎ</ci><ci id="S3.SS1.p1.1.m1.1.1.4.cmml" xref="S3.SS1.p1.1.m1.1.1.4">𝑎</ci><ci id="S3.SS1.p1.1.m1.1.1.5.cmml" xref="S3.SS1.p1.1.m1.1.1.5">𝑛</ci><ci id="S3.SS1.p1.1.m1.1.1.6.cmml" xref="S3.SS1.p1.1.m1.1.1.6">𝑛</ci><ci id="S3.SS1.p1.1.m1.1.1.7.cmml" xref="S3.SS1.p1.1.m1.1.1.7">𝑒</ci><ci id="S3.SS1.p1.1.m1.1.1.8.cmml" xref="S3.SS1.p1.1.m1.1.1.8">𝑙</ci><ci id="S3.SS1.p1.1.m1.1.1.9.cmml" xref="S3.SS1.p1.1.m1.1.1.9">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">rows\times cols\times channels</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_r italic_o italic_w italic_s × italic_c italic_o italic_l italic_s × italic_c italic_h italic_a italic_n italic_n italic_e italic_l italic_s</annotation></semantics></math>. In the case of a vision transformer model, each token in the output origins from an input location in the image, so we ignore the class token. We then reshape this tensor into a matrix <math alttext="A" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_A</annotation></semantics></math> of shape <math alttext="(rows\times cols)\times channels" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mrow id="S3.SS1.p1.3.m3.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.cmml"><mrow id="S3.SS1.p1.3.m3.1.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.3.m3.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.3.m3.1.1.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.cmml"><mrow id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.cmml"><mrow id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.2" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.2.cmml">r</mi><mo id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.1" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.3" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.3.cmml">o</mi><mo id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.1a" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.4" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.4.cmml">w</mi><mo id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.1b" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.5" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.5.cmml">s</mi></mrow><mo id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.1.cmml">×</mo><mi id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.3" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.3.cmml">c</mi></mrow><mo id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p1.3.m3.1.1.1.1.1.1.3" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.3.cmml">o</mi><mo id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1a" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p1.3.m3.1.1.1.1.1.1.4" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.4.cmml">l</mi><mo id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1b" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p1.3.m3.1.1.1.1.1.1.5" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.5.cmml">s</mi></mrow><mo id="S3.SS1.p1.3.m3.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS1.p1.3.m3.1.1.1.2" rspace="0.222em" xref="S3.SS1.p1.3.m3.1.1.1.2.cmml">×</mo><mi id="S3.SS1.p1.3.m3.1.1.1.3" xref="S3.SS1.p1.3.m3.1.1.1.3.cmml">c</mi></mrow><mo id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">⁢</mo><mi id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">h</mi><mo id="S3.SS1.p1.3.m3.1.1.2a" xref="S3.SS1.p1.3.m3.1.1.2.cmml">⁢</mo><mi id="S3.SS1.p1.3.m3.1.1.4" xref="S3.SS1.p1.3.m3.1.1.4.cmml">a</mi><mo id="S3.SS1.p1.3.m3.1.1.2b" xref="S3.SS1.p1.3.m3.1.1.2.cmml">⁢</mo><mi id="S3.SS1.p1.3.m3.1.1.5" xref="S3.SS1.p1.3.m3.1.1.5.cmml">n</mi><mo id="S3.SS1.p1.3.m3.1.1.2c" xref="S3.SS1.p1.3.m3.1.1.2.cmml">⁢</mo><mi id="S3.SS1.p1.3.m3.1.1.6" xref="S3.SS1.p1.3.m3.1.1.6.cmml">n</mi><mo id="S3.SS1.p1.3.m3.1.1.2d" xref="S3.SS1.p1.3.m3.1.1.2.cmml">⁢</mo><mi id="S3.SS1.p1.3.m3.1.1.7" xref="S3.SS1.p1.3.m3.1.1.7.cmml">e</mi><mo id="S3.SS1.p1.3.m3.1.1.2e" xref="S3.SS1.p1.3.m3.1.1.2.cmml">⁢</mo><mi id="S3.SS1.p1.3.m3.1.1.8" xref="S3.SS1.p1.3.m3.1.1.8.cmml">l</mi><mo id="S3.SS1.p1.3.m3.1.1.2f" xref="S3.SS1.p1.3.m3.1.1.2.cmml">⁢</mo><mi id="S3.SS1.p1.3.m3.1.1.9" xref="S3.SS1.p1.3.m3.1.1.9.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><times id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2"></times><apply id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1"><times id="S3.SS1.p1.3.m3.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.2"></times><apply id="S3.SS1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1"><times id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1"></times><apply id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.2"><times id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.1"></times><apply id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2"><times id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.1"></times><ci id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.2">𝑟</ci><ci id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.3">𝑜</ci><ci id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.4.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.4">𝑤</ci><ci id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.5.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.5">𝑠</ci></apply><ci id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.3">𝑐</ci></apply><ci id="S3.SS1.p1.3.m3.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.3">𝑜</ci><ci id="S3.SS1.p1.3.m3.1.1.1.1.1.1.4.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.4">𝑙</ci><ci id="S3.SS1.p1.3.m3.1.1.1.1.1.1.5.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.5">𝑠</ci></apply><ci id="S3.SS1.p1.3.m3.1.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.1.3">𝑐</ci></apply><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">ℎ</ci><ci id="S3.SS1.p1.3.m3.1.1.4.cmml" xref="S3.SS1.p1.3.m3.1.1.4">𝑎</ci><ci id="S3.SS1.p1.3.m3.1.1.5.cmml" xref="S3.SS1.p1.3.m3.1.1.5">𝑛</ci><ci id="S3.SS1.p1.3.m3.1.1.6.cmml" xref="S3.SS1.p1.3.m3.1.1.6">𝑛</ci><ci id="S3.SS1.p1.3.m3.1.1.7.cmml" xref="S3.SS1.p1.3.m3.1.1.7">𝑒</ci><ci id="S3.SS1.p1.3.m3.1.1.8.cmml" xref="S3.SS1.p1.3.m3.1.1.8">𝑙</ci><ci id="S3.SS1.p1.3.m3.1.1.9.cmml" xref="S3.SS1.p1.3.m3.1.1.9">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">(rows\times cols)\times channels</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">( italic_r italic_o italic_w italic_s × italic_c italic_o italic_l italic_s ) × italic_c italic_h italic_a italic_n italic_n italic_e italic_l italic_s</annotation></semantics></math> and then factorize <math alttext="A" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_A</annotation></semantics></math> with NMF into <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_k</annotation></semantics></math> components:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="A_{(rows\times cols)\times channels}\approx W_{(rows\times cols)\times k}%
\times H_{k\times channels}" class="ltx_Math" display="block" id="S3.Ex1.m1.2"><semantics id="S3.Ex1.m1.2a"><mrow id="S3.Ex1.m1.2.3" xref="S3.Ex1.m1.2.3.cmml"><msub id="S3.Ex1.m1.2.3.2" xref="S3.Ex1.m1.2.3.2.cmml"><mi id="S3.Ex1.m1.2.3.2.2" xref="S3.Ex1.m1.2.3.2.2.cmml">A</mi><mrow id="S3.Ex1.m1.1.1.1" xref="S3.Ex1.m1.1.1.1.cmml"><mrow id="S3.Ex1.m1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.cmml"><mrow id="S3.Ex1.m1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.Ex1.m1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.cmml"><mrow id="S3.Ex1.m1.1.1.1.1.1.1.1.2.2" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.2" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.2.cmml">r</mi><mo id="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.3.cmml">o</mi><mo id="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.1a" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.4" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.4.cmml">w</mi><mo id="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.1b" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.5" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.5.cmml">s</mi></mrow><mo id="S3.Ex1.m1.1.1.1.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.1.cmml">×</mo><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.2.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.3.cmml">c</mi></mrow><mo id="S3.Ex1.m1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3.cmml">o</mi><mo id="S3.Ex1.m1.1.1.1.1.1.1.1.1a" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.4" xref="S3.Ex1.m1.1.1.1.1.1.1.1.4.cmml">l</mi><mo id="S3.Ex1.m1.1.1.1.1.1.1.1.1b" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.5" xref="S3.Ex1.m1.1.1.1.1.1.1.1.5.cmml">s</mi></mrow><mo id="S3.Ex1.m1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.Ex1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.Ex1.m1.1.1.1.1.2" rspace="0.222em" xref="S3.Ex1.m1.1.1.1.1.2.cmml">×</mo><mi id="S3.Ex1.m1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.3.cmml">c</mi></mrow><mo id="S3.Ex1.m1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex1.m1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.3.cmml">h</mi><mo id="S3.Ex1.m1.1.1.1.2a" xref="S3.Ex1.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex1.m1.1.1.1.4" xref="S3.Ex1.m1.1.1.1.4.cmml">a</mi><mo id="S3.Ex1.m1.1.1.1.2b" xref="S3.Ex1.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex1.m1.1.1.1.5" xref="S3.Ex1.m1.1.1.1.5.cmml">n</mi><mo id="S3.Ex1.m1.1.1.1.2c" xref="S3.Ex1.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex1.m1.1.1.1.6" xref="S3.Ex1.m1.1.1.1.6.cmml">n</mi><mo id="S3.Ex1.m1.1.1.1.2d" xref="S3.Ex1.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex1.m1.1.1.1.7" xref="S3.Ex1.m1.1.1.1.7.cmml">e</mi><mo id="S3.Ex1.m1.1.1.1.2e" xref="S3.Ex1.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex1.m1.1.1.1.8" xref="S3.Ex1.m1.1.1.1.8.cmml">l</mi><mo id="S3.Ex1.m1.1.1.1.2f" xref="S3.Ex1.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex1.m1.1.1.1.9" xref="S3.Ex1.m1.1.1.1.9.cmml">s</mi></mrow></msub><mo id="S3.Ex1.m1.2.3.1" xref="S3.Ex1.m1.2.3.1.cmml">≈</mo><mrow id="S3.Ex1.m1.2.3.3" xref="S3.Ex1.m1.2.3.3.cmml"><msub id="S3.Ex1.m1.2.3.3.2" xref="S3.Ex1.m1.2.3.3.2.cmml"><mi id="S3.Ex1.m1.2.3.3.2.2" xref="S3.Ex1.m1.2.3.3.2.2.cmml">W</mi><mrow id="S3.Ex1.m1.2.2.1" xref="S3.Ex1.m1.2.2.1.cmml"><mrow id="S3.Ex1.m1.2.2.1.1.1" xref="S3.Ex1.m1.2.2.1.1.1.1.cmml"><mo id="S3.Ex1.m1.2.2.1.1.1.2" stretchy="false" xref="S3.Ex1.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.2.2.1.1.1.1" xref="S3.Ex1.m1.2.2.1.1.1.1.cmml"><mrow id="S3.Ex1.m1.2.2.1.1.1.1.2" xref="S3.Ex1.m1.2.2.1.1.1.1.2.cmml"><mrow id="S3.Ex1.m1.2.2.1.1.1.1.2.2" xref="S3.Ex1.m1.2.2.1.1.1.1.2.2.cmml"><mi id="S3.Ex1.m1.2.2.1.1.1.1.2.2.2" xref="S3.Ex1.m1.2.2.1.1.1.1.2.2.2.cmml">r</mi><mo id="S3.Ex1.m1.2.2.1.1.1.1.2.2.1" xref="S3.Ex1.m1.2.2.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="S3.Ex1.m1.2.2.1.1.1.1.2.2.3" xref="S3.Ex1.m1.2.2.1.1.1.1.2.2.3.cmml">o</mi><mo id="S3.Ex1.m1.2.2.1.1.1.1.2.2.1a" xref="S3.Ex1.m1.2.2.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="S3.Ex1.m1.2.2.1.1.1.1.2.2.4" xref="S3.Ex1.m1.2.2.1.1.1.1.2.2.4.cmml">w</mi><mo id="S3.Ex1.m1.2.2.1.1.1.1.2.2.1b" xref="S3.Ex1.m1.2.2.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="S3.Ex1.m1.2.2.1.1.1.1.2.2.5" xref="S3.Ex1.m1.2.2.1.1.1.1.2.2.5.cmml">s</mi></mrow><mo id="S3.Ex1.m1.2.2.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex1.m1.2.2.1.1.1.1.2.1.cmml">×</mo><mi id="S3.Ex1.m1.2.2.1.1.1.1.2.3" xref="S3.Ex1.m1.2.2.1.1.1.1.2.3.cmml">c</mi></mrow><mo id="S3.Ex1.m1.2.2.1.1.1.1.1" xref="S3.Ex1.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="S3.Ex1.m1.2.2.1.1.1.1.3" xref="S3.Ex1.m1.2.2.1.1.1.1.3.cmml">o</mi><mo id="S3.Ex1.m1.2.2.1.1.1.1.1a" xref="S3.Ex1.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="S3.Ex1.m1.2.2.1.1.1.1.4" xref="S3.Ex1.m1.2.2.1.1.1.1.4.cmml">l</mi><mo id="S3.Ex1.m1.2.2.1.1.1.1.1b" xref="S3.Ex1.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="S3.Ex1.m1.2.2.1.1.1.1.5" xref="S3.Ex1.m1.2.2.1.1.1.1.5.cmml">s</mi></mrow><mo id="S3.Ex1.m1.2.2.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.Ex1.m1.2.2.1.1.1.1.cmml">)</mo></mrow><mo id="S3.Ex1.m1.2.2.1.2" rspace="0.222em" xref="S3.Ex1.m1.2.2.1.2.cmml">×</mo><mi id="S3.Ex1.m1.2.2.1.3" xref="S3.Ex1.m1.2.2.1.3.cmml">k</mi></mrow></msub><mo id="S3.Ex1.m1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex1.m1.2.3.3.1.cmml">×</mo><msub id="S3.Ex1.m1.2.3.3.3" xref="S3.Ex1.m1.2.3.3.3.cmml"><mi id="S3.Ex1.m1.2.3.3.3.2" xref="S3.Ex1.m1.2.3.3.3.2.cmml">H</mi><mrow id="S3.Ex1.m1.2.3.3.3.3" xref="S3.Ex1.m1.2.3.3.3.3.cmml"><mrow id="S3.Ex1.m1.2.3.3.3.3.2" xref="S3.Ex1.m1.2.3.3.3.3.2.cmml"><mi id="S3.Ex1.m1.2.3.3.3.3.2.2" xref="S3.Ex1.m1.2.3.3.3.3.2.2.cmml">k</mi><mo id="S3.Ex1.m1.2.3.3.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex1.m1.2.3.3.3.3.2.1.cmml">×</mo><mi id="S3.Ex1.m1.2.3.3.3.3.2.3" xref="S3.Ex1.m1.2.3.3.3.3.2.3.cmml">c</mi></mrow><mo id="S3.Ex1.m1.2.3.3.3.3.1" xref="S3.Ex1.m1.2.3.3.3.3.1.cmml">⁢</mo><mi id="S3.Ex1.m1.2.3.3.3.3.3" xref="S3.Ex1.m1.2.3.3.3.3.3.cmml">h</mi><mo id="S3.Ex1.m1.2.3.3.3.3.1a" xref="S3.Ex1.m1.2.3.3.3.3.1.cmml">⁢</mo><mi id="S3.Ex1.m1.2.3.3.3.3.4" xref="S3.Ex1.m1.2.3.3.3.3.4.cmml">a</mi><mo id="S3.Ex1.m1.2.3.3.3.3.1b" xref="S3.Ex1.m1.2.3.3.3.3.1.cmml">⁢</mo><mi id="S3.Ex1.m1.2.3.3.3.3.5" xref="S3.Ex1.m1.2.3.3.3.3.5.cmml">n</mi><mo id="S3.Ex1.m1.2.3.3.3.3.1c" xref="S3.Ex1.m1.2.3.3.3.3.1.cmml">⁢</mo><mi id="S3.Ex1.m1.2.3.3.3.3.6" xref="S3.Ex1.m1.2.3.3.3.3.6.cmml">n</mi><mo id="S3.Ex1.m1.2.3.3.3.3.1d" xref="S3.Ex1.m1.2.3.3.3.3.1.cmml">⁢</mo><mi id="S3.Ex1.m1.2.3.3.3.3.7" xref="S3.Ex1.m1.2.3.3.3.3.7.cmml">e</mi><mo id="S3.Ex1.m1.2.3.3.3.3.1e" xref="S3.Ex1.m1.2.3.3.3.3.1.cmml">⁢</mo><mi id="S3.Ex1.m1.2.3.3.3.3.8" xref="S3.Ex1.m1.2.3.3.3.3.8.cmml">l</mi><mo id="S3.Ex1.m1.2.3.3.3.3.1f" xref="S3.Ex1.m1.2.3.3.3.3.1.cmml">⁢</mo><mi id="S3.Ex1.m1.2.3.3.3.3.9" xref="S3.Ex1.m1.2.3.3.3.3.9.cmml">s</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.2b"><apply id="S3.Ex1.m1.2.3.cmml" xref="S3.Ex1.m1.2.3"><approx id="S3.Ex1.m1.2.3.1.cmml" xref="S3.Ex1.m1.2.3.1"></approx><apply id="S3.Ex1.m1.2.3.2.cmml" xref="S3.Ex1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.3.2.1.cmml" xref="S3.Ex1.m1.2.3.2">subscript</csymbol><ci id="S3.Ex1.m1.2.3.2.2.cmml" xref="S3.Ex1.m1.2.3.2.2">𝐴</ci><apply id="S3.Ex1.m1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1"><times id="S3.Ex1.m1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.2"></times><apply id="S3.Ex1.m1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1"><times id="S3.Ex1.m1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.2"></times><apply id="S3.Ex1.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1"><times id="S3.Ex1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1"></times><apply id="S3.Ex1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2"><times id="S3.Ex1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.1"></times><apply id="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.2"><times id="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.1"></times><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.2">𝑟</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.3">𝑜</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.4.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.4">𝑤</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.5.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.5">𝑠</ci></apply><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.3">𝑐</ci></apply><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3">𝑜</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.4.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.4">𝑙</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.5.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.5">𝑠</ci></apply><ci id="S3.Ex1.m1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3">𝑐</ci></apply><ci id="S3.Ex1.m1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.3">ℎ</ci><ci id="S3.Ex1.m1.1.1.1.4.cmml" xref="S3.Ex1.m1.1.1.1.4">𝑎</ci><ci id="S3.Ex1.m1.1.1.1.5.cmml" xref="S3.Ex1.m1.1.1.1.5">𝑛</ci><ci id="S3.Ex1.m1.1.1.1.6.cmml" xref="S3.Ex1.m1.1.1.1.6">𝑛</ci><ci id="S3.Ex1.m1.1.1.1.7.cmml" xref="S3.Ex1.m1.1.1.1.7">𝑒</ci><ci id="S3.Ex1.m1.1.1.1.8.cmml" xref="S3.Ex1.m1.1.1.1.8">𝑙</ci><ci id="S3.Ex1.m1.1.1.1.9.cmml" xref="S3.Ex1.m1.1.1.1.9">𝑠</ci></apply></apply><apply id="S3.Ex1.m1.2.3.3.cmml" xref="S3.Ex1.m1.2.3.3"><times id="S3.Ex1.m1.2.3.3.1.cmml" xref="S3.Ex1.m1.2.3.3.1"></times><apply id="S3.Ex1.m1.2.3.3.2.cmml" xref="S3.Ex1.m1.2.3.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.3.3.2.1.cmml" xref="S3.Ex1.m1.2.3.3.2">subscript</csymbol><ci id="S3.Ex1.m1.2.3.3.2.2.cmml" xref="S3.Ex1.m1.2.3.3.2.2">𝑊</ci><apply id="S3.Ex1.m1.2.2.1.cmml" xref="S3.Ex1.m1.2.2.1"><times id="S3.Ex1.m1.2.2.1.2.cmml" xref="S3.Ex1.m1.2.2.1.2"></times><apply id="S3.Ex1.m1.2.2.1.1.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1"><times id="S3.Ex1.m1.2.2.1.1.1.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1"></times><apply id="S3.Ex1.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.2"><times id="S3.Ex1.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.2.1"></times><apply id="S3.Ex1.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.2.2"><times id="S3.Ex1.m1.2.2.1.1.1.1.2.2.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.2.2.1"></times><ci id="S3.Ex1.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.2.2.2">𝑟</ci><ci id="S3.Ex1.m1.2.2.1.1.1.1.2.2.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.2.2.3">𝑜</ci><ci id="S3.Ex1.m1.2.2.1.1.1.1.2.2.4.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.2.2.4">𝑤</ci><ci id="S3.Ex1.m1.2.2.1.1.1.1.2.2.5.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.2.2.5">𝑠</ci></apply><ci id="S3.Ex1.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.2.3">𝑐</ci></apply><ci id="S3.Ex1.m1.2.2.1.1.1.1.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.3">𝑜</ci><ci id="S3.Ex1.m1.2.2.1.1.1.1.4.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.4">𝑙</ci><ci id="S3.Ex1.m1.2.2.1.1.1.1.5.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.5">𝑠</ci></apply><ci id="S3.Ex1.m1.2.2.1.3.cmml" xref="S3.Ex1.m1.2.2.1.3">𝑘</ci></apply></apply><apply id="S3.Ex1.m1.2.3.3.3.cmml" xref="S3.Ex1.m1.2.3.3.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.3.3.3.1.cmml" xref="S3.Ex1.m1.2.3.3.3">subscript</csymbol><ci id="S3.Ex1.m1.2.3.3.3.2.cmml" xref="S3.Ex1.m1.2.3.3.3.2">𝐻</ci><apply id="S3.Ex1.m1.2.3.3.3.3.cmml" xref="S3.Ex1.m1.2.3.3.3.3"><times id="S3.Ex1.m1.2.3.3.3.3.1.cmml" xref="S3.Ex1.m1.2.3.3.3.3.1"></times><apply id="S3.Ex1.m1.2.3.3.3.3.2.cmml" xref="S3.Ex1.m1.2.3.3.3.3.2"><times id="S3.Ex1.m1.2.3.3.3.3.2.1.cmml" xref="S3.Ex1.m1.2.3.3.3.3.2.1"></times><ci id="S3.Ex1.m1.2.3.3.3.3.2.2.cmml" xref="S3.Ex1.m1.2.3.3.3.3.2.2">𝑘</ci><ci id="S3.Ex1.m1.2.3.3.3.3.2.3.cmml" xref="S3.Ex1.m1.2.3.3.3.3.2.3">𝑐</ci></apply><ci id="S3.Ex1.m1.2.3.3.3.3.3.cmml" xref="S3.Ex1.m1.2.3.3.3.3.3">ℎ</ci><ci id="S3.Ex1.m1.2.3.3.3.3.4.cmml" xref="S3.Ex1.m1.2.3.3.3.3.4">𝑎</ci><ci id="S3.Ex1.m1.2.3.3.3.3.5.cmml" xref="S3.Ex1.m1.2.3.3.3.3.5">𝑛</ci><ci id="S3.Ex1.m1.2.3.3.3.3.6.cmml" xref="S3.Ex1.m1.2.3.3.3.3.6">𝑛</ci><ci id="S3.Ex1.m1.2.3.3.3.3.7.cmml" xref="S3.Ex1.m1.2.3.3.3.3.7">𝑒</ci><ci id="S3.Ex1.m1.2.3.3.3.3.8.cmml" xref="S3.Ex1.m1.2.3.3.3.3.8">𝑙</ci><ci id="S3.Ex1.m1.2.3.3.3.3.9.cmml" xref="S3.Ex1.m1.2.3.3.3.3.9">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.2c">A_{(rows\times cols)\times channels}\approx W_{(rows\times cols)\times k}%
\times H_{k\times channels}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.2d">italic_A start_POSTSUBSCRIPT ( italic_r italic_o italic_w italic_s × italic_c italic_o italic_l italic_s ) × italic_c italic_h italic_a italic_n italic_n italic_e italic_l italic_s end_POSTSUBSCRIPT ≈ italic_W start_POSTSUBSCRIPT ( italic_r italic_o italic_w italic_s × italic_c italic_o italic_l italic_s ) × italic_k end_POSTSUBSCRIPT × italic_H start_POSTSUBSCRIPT italic_k × italic_c italic_h italic_a italic_n italic_n italic_e italic_l italic_s end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.7">In this factorization, <math alttext="W" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">W</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_W</annotation></semantics></math> represents a per-pixel contribution matrix, indicating the contribution of every pixel to the <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_k</annotation></semantics></math> concepts.
For simplicity, we refer to <math alttext="W_{ijm}" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><msub id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">W</mi><mrow id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml"><mi id="S3.SS1.p2.3.m3.1.1.3.2" xref="S3.SS1.p2.3.m3.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p2.3.m3.1.1.3.1" xref="S3.SS1.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.3.m3.1.1.3.3" xref="S3.SS1.p2.3.m3.1.1.3.3.cmml">j</mi><mo id="S3.SS1.p2.3.m3.1.1.3.1a" xref="S3.SS1.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.3.m3.1.1.3.4" xref="S3.SS1.p2.3.m3.1.1.3.4.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2">𝑊</ci><apply id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3"><times id="S3.SS1.p2.3.m3.1.1.3.1.cmml" xref="S3.SS1.p2.3.m3.1.1.3.1"></times><ci id="S3.SS1.p2.3.m3.1.1.3.2.cmml" xref="S3.SS1.p2.3.m3.1.1.3.2">𝑖</ci><ci id="S3.SS1.p2.3.m3.1.1.3.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3">𝑗</ci><ci id="S3.SS1.p2.3.m3.1.1.3.4.cmml" xref="S3.SS1.p2.3.m3.1.1.3.4">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">W_{ijm}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_W start_POSTSUBSCRIPT italic_i italic_j italic_m end_POSTSUBSCRIPT</annotation></semantics></math> as the contribution of the pixel <math alttext="ij" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mrow id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">i</mi><mo id="S3.SS1.p2.4.m4.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml">j</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><times id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1"></times><ci id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">𝑖</ci><ci id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">ij</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_i italic_j</annotation></semantics></math> to the <math alttext="m" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">italic_m</annotation></semantics></math>’th concept.
<math alttext="H" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m6.1"><semantics id="S3.SS1.p2.6.m6.1a"><mi id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><ci id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m6.1d">italic_H</annotation></semantics></math> represents a concept feature matrix, storing the <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m7.1"><semantics id="S3.SS1.p2.7.m7.1a"><mi id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><ci id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.7.m7.1d">italic_k</annotation></semantics></math> representative feature vectors of the concepts.</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.1">We assign each pixel a concept <math alttext="\beta_{ij}" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><msub id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">β</mi><mrow id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml"><mi id="S3.SS1.p3.1.m1.1.1.3.2" xref="S3.SS1.p3.1.m1.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p3.1.m1.1.1.3.1" xref="S3.SS1.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.1.m1.1.1.3.3" xref="S3.SS1.p3.1.m1.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝛽</ci><apply id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3"><times id="S3.SS1.p3.1.m1.1.1.3.1.cmml" xref="S3.SS1.p3.1.m1.1.1.3.1"></times><ci id="S3.SS1.p3.1.m1.1.1.3.2.cmml" xref="S3.SS1.p3.1.m1.1.1.3.2">𝑖</ci><ci id="S3.SS1.p3.1.m1.1.1.3.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\beta_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">italic_β start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> by identifying the concept with the largest contribution to that pixel:</p>
</div>
<div class="ltx_para" id="S3.SS1.p4">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\beta_{ij}=argmax_{m}W_{ijm}" class="ltx_Math" display="block" id="S3.Ex2.m1.1"><semantics id="S3.Ex2.m1.1a"><mrow id="S3.Ex2.m1.1.1" xref="S3.Ex2.m1.1.1.cmml"><msub id="S3.Ex2.m1.1.1.2" xref="S3.Ex2.m1.1.1.2.cmml"><mi id="S3.Ex2.m1.1.1.2.2" xref="S3.Ex2.m1.1.1.2.2.cmml">β</mi><mrow id="S3.Ex2.m1.1.1.2.3" xref="S3.Ex2.m1.1.1.2.3.cmml"><mi id="S3.Ex2.m1.1.1.2.3.2" xref="S3.Ex2.m1.1.1.2.3.2.cmml">i</mi><mo id="S3.Ex2.m1.1.1.2.3.1" xref="S3.Ex2.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.Ex2.m1.1.1.2.3.3" xref="S3.Ex2.m1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.Ex2.m1.1.1.1" xref="S3.Ex2.m1.1.1.1.cmml">=</mo><mrow id="S3.Ex2.m1.1.1.3" xref="S3.Ex2.m1.1.1.3.cmml"><mi id="S3.Ex2.m1.1.1.3.2" xref="S3.Ex2.m1.1.1.3.2.cmml">a</mi><mo id="S3.Ex2.m1.1.1.3.1" xref="S3.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex2.m1.1.1.3.3" xref="S3.Ex2.m1.1.1.3.3.cmml">r</mi><mo id="S3.Ex2.m1.1.1.3.1a" xref="S3.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex2.m1.1.1.3.4" xref="S3.Ex2.m1.1.1.3.4.cmml">g</mi><mo id="S3.Ex2.m1.1.1.3.1b" xref="S3.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex2.m1.1.1.3.5" xref="S3.Ex2.m1.1.1.3.5.cmml">m</mi><mo id="S3.Ex2.m1.1.1.3.1c" xref="S3.Ex2.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex2.m1.1.1.3.6" xref="S3.Ex2.m1.1.1.3.6.cmml">a</mi><mo id="S3.Ex2.m1.1.1.3.1d" xref="S3.Ex2.m1.1.1.3.1.cmml">⁢</mo><msub id="S3.Ex2.m1.1.1.3.7" xref="S3.Ex2.m1.1.1.3.7.cmml"><mi id="S3.Ex2.m1.1.1.3.7.2" xref="S3.Ex2.m1.1.1.3.7.2.cmml">x</mi><mi id="S3.Ex2.m1.1.1.3.7.3" xref="S3.Ex2.m1.1.1.3.7.3.cmml">m</mi></msub><mo id="S3.Ex2.m1.1.1.3.1e" xref="S3.Ex2.m1.1.1.3.1.cmml">⁢</mo><msub id="S3.Ex2.m1.1.1.3.8" xref="S3.Ex2.m1.1.1.3.8.cmml"><mi id="S3.Ex2.m1.1.1.3.8.2" xref="S3.Ex2.m1.1.1.3.8.2.cmml">W</mi><mrow id="S3.Ex2.m1.1.1.3.8.3" xref="S3.Ex2.m1.1.1.3.8.3.cmml"><mi id="S3.Ex2.m1.1.1.3.8.3.2" xref="S3.Ex2.m1.1.1.3.8.3.2.cmml">i</mi><mo id="S3.Ex2.m1.1.1.3.8.3.1" xref="S3.Ex2.m1.1.1.3.8.3.1.cmml">⁢</mo><mi id="S3.Ex2.m1.1.1.3.8.3.3" xref="S3.Ex2.m1.1.1.3.8.3.3.cmml">j</mi><mo id="S3.Ex2.m1.1.1.3.8.3.1a" xref="S3.Ex2.m1.1.1.3.8.3.1.cmml">⁢</mo><mi id="S3.Ex2.m1.1.1.3.8.3.4" xref="S3.Ex2.m1.1.1.3.8.3.4.cmml">m</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.1b"><apply id="S3.Ex2.m1.1.1.cmml" xref="S3.Ex2.m1.1.1"><eq id="S3.Ex2.m1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1"></eq><apply id="S3.Ex2.m1.1.1.2.cmml" xref="S3.Ex2.m1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.2.1.cmml" xref="S3.Ex2.m1.1.1.2">subscript</csymbol><ci id="S3.Ex2.m1.1.1.2.2.cmml" xref="S3.Ex2.m1.1.1.2.2">𝛽</ci><apply id="S3.Ex2.m1.1.1.2.3.cmml" xref="S3.Ex2.m1.1.1.2.3"><times id="S3.Ex2.m1.1.1.2.3.1.cmml" xref="S3.Ex2.m1.1.1.2.3.1"></times><ci id="S3.Ex2.m1.1.1.2.3.2.cmml" xref="S3.Ex2.m1.1.1.2.3.2">𝑖</ci><ci id="S3.Ex2.m1.1.1.2.3.3.cmml" xref="S3.Ex2.m1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.Ex2.m1.1.1.3.cmml" xref="S3.Ex2.m1.1.1.3"><times id="S3.Ex2.m1.1.1.3.1.cmml" xref="S3.Ex2.m1.1.1.3.1"></times><ci id="S3.Ex2.m1.1.1.3.2.cmml" xref="S3.Ex2.m1.1.1.3.2">𝑎</ci><ci id="S3.Ex2.m1.1.1.3.3.cmml" xref="S3.Ex2.m1.1.1.3.3">𝑟</ci><ci id="S3.Ex2.m1.1.1.3.4.cmml" xref="S3.Ex2.m1.1.1.3.4">𝑔</ci><ci id="S3.Ex2.m1.1.1.3.5.cmml" xref="S3.Ex2.m1.1.1.3.5">𝑚</ci><ci id="S3.Ex2.m1.1.1.3.6.cmml" xref="S3.Ex2.m1.1.1.3.6">𝑎</ci><apply id="S3.Ex2.m1.1.1.3.7.cmml" xref="S3.Ex2.m1.1.1.3.7"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.3.7.1.cmml" xref="S3.Ex2.m1.1.1.3.7">subscript</csymbol><ci id="S3.Ex2.m1.1.1.3.7.2.cmml" xref="S3.Ex2.m1.1.1.3.7.2">𝑥</ci><ci id="S3.Ex2.m1.1.1.3.7.3.cmml" xref="S3.Ex2.m1.1.1.3.7.3">𝑚</ci></apply><apply id="S3.Ex2.m1.1.1.3.8.cmml" xref="S3.Ex2.m1.1.1.3.8"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.3.8.1.cmml" xref="S3.Ex2.m1.1.1.3.8">subscript</csymbol><ci id="S3.Ex2.m1.1.1.3.8.2.cmml" xref="S3.Ex2.m1.1.1.3.8.2">𝑊</ci><apply id="S3.Ex2.m1.1.1.3.8.3.cmml" xref="S3.Ex2.m1.1.1.3.8.3"><times id="S3.Ex2.m1.1.1.3.8.3.1.cmml" xref="S3.Ex2.m1.1.1.3.8.3.1"></times><ci id="S3.Ex2.m1.1.1.3.8.3.2.cmml" xref="S3.Ex2.m1.1.1.3.8.3.2">𝑖</ci><ci id="S3.Ex2.m1.1.1.3.8.3.3.cmml" xref="S3.Ex2.m1.1.1.3.8.3.3">𝑗</ci><ci id="S3.Ex2.m1.1.1.3.8.3.4.cmml" xref="S3.Ex2.m1.1.1.3.8.3.4">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.1c">\beta_{ij}=argmax_{m}W_{ijm}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2.m1.1d">italic_β start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = italic_a italic_r italic_g italic_m italic_a italic_x start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT italic_W start_POSTSUBSCRIPT italic_i italic_j italic_m end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Methods for achieving consistent concepts between images</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">The factorized concepts in <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_β</annotation></semantics></math> might have different meanings and ordering in different images. For example, a factorized concept corresponding to "Tumor" might be the first concept in one image, but the third in another. To achieve consistent semantic segmentation across images, we map these concepts to a common set of labels. This can be done using any method that assigns feature vectors into categories, for example by utilizing existing classification models. We achieve this by fitting a k-means clustering model <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">hartigan1979algorithm</span>]</cite> on 1D features extracted from neural networks by taking the spatial average of the features from the layer of choice in the neural network.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">Finally, at the end of the pipeline, the factorized segmentation mask is resized to match the shape of the input image. We next propose two methods for utilizing the clustering model centers for consistent concepts.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Assigning factorized concepts to similar clusters</h4>
<div class="ltx_para" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.2">For each pixel <math alttext="i,j" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.1.m1.2"><semantics id="S3.SS2.SSS1.p1.1.m1.2a"><mrow id="S3.SS2.SSS1.p1.1.m1.2.3.2" xref="S3.SS2.SSS1.p1.1.m1.2.3.1.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.cmml">i</mi><mo id="S3.SS2.SSS1.p1.1.m1.2.3.2.1" xref="S3.SS2.SSS1.p1.1.m1.2.3.1.cmml">,</mo><mi id="S3.SS2.SSS1.p1.1.m1.2.2" xref="S3.SS2.SSS1.p1.1.m1.2.2.cmml">j</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.1.m1.2b"><list id="S3.SS2.SSS1.p1.1.m1.2.3.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.3.2"><ci id="S3.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1">𝑖</ci><ci id="S3.SS2.SSS1.p1.1.m1.2.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2">𝑗</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.1.m1.2c">i,j</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.1.m1.2d">italic_i , italic_j</annotation></semantics></math> the semantic segmentation category <math alttext="\hat{y}_{ij}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.2.m2.1"><semantics id="S3.SS2.SSS1.p1.2.m2.1a"><msub id="S3.SS2.SSS1.p1.2.m2.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.cmml"><mover accent="true" id="S3.SS2.SSS1.p1.2.m2.1.1.2" xref="S3.SS2.SSS1.p1.2.m2.1.1.2.cmml"><mi id="S3.SS2.SSS1.p1.2.m2.1.1.2.2" xref="S3.SS2.SSS1.p1.2.m2.1.1.2.2.cmml">y</mi><mo id="S3.SS2.SSS1.p1.2.m2.1.1.2.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS2.SSS1.p1.2.m2.1.1.3" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.2.m2.1.1.3.2" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.2.cmml">i</mi><mo id="S3.SS2.SSS1.p1.2.m2.1.1.3.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.SSS1.p1.2.m2.1.1.3.3" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.2.m2.1b"><apply id="S3.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1">subscript</csymbol><apply id="S3.SS2.SSS1.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.2"><ci id="S3.SS2.SSS1.p1.2.m2.1.1.2.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.2.1">^</ci><ci id="S3.SS2.SSS1.p1.2.m2.1.1.2.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.2.2">𝑦</ci></apply><apply id="S3.SS2.SSS1.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3"><times id="S3.SS2.SSS1.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.1"></times><ci id="S3.SS2.SSS1.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.2">𝑖</ci><ci id="S3.SS2.SSS1.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.2.m2.1c">\hat{y}_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.2.m2.1d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is selected by taking the cluster center with the highest cosine similarity to the factorized concept feature at that pixel:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{y_{ij}}=\operatorname*{argmax}_{k}\frac{\mathbf{\mu}_{k}\cdot\mathbf{H_{%
\beta_{ij}}}}{\|\mathbf{\mu}_{k}\|\ \|\mathbf{H_{\beta_{ij}}}\|}" class="ltx_Math" display="block" id="S3.Ex3.m1.2"><semantics id="S3.Ex3.m1.2a"><mrow id="S3.Ex3.m1.2.3" xref="S3.Ex3.m1.2.3.cmml"><mover accent="true" id="S3.Ex3.m1.2.3.2" xref="S3.Ex3.m1.2.3.2.cmml"><msub id="S3.Ex3.m1.2.3.2.2" xref="S3.Ex3.m1.2.3.2.2.cmml"><mi id="S3.Ex3.m1.2.3.2.2.2" xref="S3.Ex3.m1.2.3.2.2.2.cmml">y</mi><mrow id="S3.Ex3.m1.2.3.2.2.3" xref="S3.Ex3.m1.2.3.2.2.3.cmml"><mi id="S3.Ex3.m1.2.3.2.2.3.2" xref="S3.Ex3.m1.2.3.2.2.3.2.cmml">i</mi><mo id="S3.Ex3.m1.2.3.2.2.3.1" xref="S3.Ex3.m1.2.3.2.2.3.1.cmml">⁢</mo><mi id="S3.Ex3.m1.2.3.2.2.3.3" xref="S3.Ex3.m1.2.3.2.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.Ex3.m1.2.3.2.1" xref="S3.Ex3.m1.2.3.2.1.cmml">^</mo></mover><mo id="S3.Ex3.m1.2.3.1" rspace="0.1389em" xref="S3.Ex3.m1.2.3.1.cmml">=</mo><mrow id="S3.Ex3.m1.2.3.3" xref="S3.Ex3.m1.2.3.3.cmml"><munder id="S3.Ex3.m1.2.3.3.1" xref="S3.Ex3.m1.2.3.3.1.cmml"><mo id="S3.Ex3.m1.2.3.3.1.2" lspace="0.1389em" rspace="0.167em" xref="S3.Ex3.m1.2.3.3.1.2.cmml">argmax</mo><mi id="S3.Ex3.m1.2.3.3.1.3" xref="S3.Ex3.m1.2.3.3.1.3.cmml">k</mi></munder><mfrac id="S3.Ex3.m1.2.2" xref="S3.Ex3.m1.2.2.cmml"><mrow id="S3.Ex3.m1.2.2.4" xref="S3.Ex3.m1.2.2.4.cmml"><msub id="S3.Ex3.m1.2.2.4.2" xref="S3.Ex3.m1.2.2.4.2.cmml"><mi id="S3.Ex3.m1.2.2.4.2.2" xref="S3.Ex3.m1.2.2.4.2.2.cmml">μ</mi><mi id="S3.Ex3.m1.2.2.4.2.3" xref="S3.Ex3.m1.2.2.4.2.3.cmml">k</mi></msub><mo id="S3.Ex3.m1.2.2.4.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex3.m1.2.2.4.1.cmml">⋅</mo><msub id="S3.Ex3.m1.2.2.4.3" xref="S3.Ex3.m1.2.2.4.3.cmml"><mi id="S3.Ex3.m1.2.2.4.3.2" xref="S3.Ex3.m1.2.2.4.3.2.cmml">𝐇</mi><msub id="S3.Ex3.m1.2.2.4.3.3" xref="S3.Ex3.m1.2.2.4.3.3.cmml"><mi id="S3.Ex3.m1.2.2.4.3.3.2" xref="S3.Ex3.m1.2.2.4.3.3.2.cmml">β</mi><mi id="S3.Ex3.m1.2.2.4.3.3.3" xref="S3.Ex3.m1.2.2.4.3.3.3.cmml">𝐢𝐣</mi></msub></msub></mrow><mrow id="S3.Ex3.m1.2.2.2" xref="S3.Ex3.m1.2.2.2.cmml"><mrow id="S3.Ex3.m1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.2.cmml"><mo id="S3.Ex3.m1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex3.m1.1.1.1.1.2.1.cmml">‖</mo><msub id="S3.Ex3.m1.1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.cmml"><mi id="S3.Ex3.m1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.1.1.1.2.cmml">μ</mi><mi id="S3.Ex3.m1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.Ex3.m1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex3.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="S3.Ex3.m1.2.2.2.3" lspace="0.500em" xref="S3.Ex3.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.Ex3.m1.2.2.2.2.1" xref="S3.Ex3.m1.2.2.2.2.2.cmml"><mo id="S3.Ex3.m1.2.2.2.2.1.2" stretchy="false" xref="S3.Ex3.m1.2.2.2.2.2.1.cmml">‖</mo><msub id="S3.Ex3.m1.2.2.2.2.1.1" xref="S3.Ex3.m1.2.2.2.2.1.1.cmml"><mi id="S3.Ex3.m1.2.2.2.2.1.1.2" xref="S3.Ex3.m1.2.2.2.2.1.1.2.cmml">𝐇</mi><msub id="S3.Ex3.m1.2.2.2.2.1.1.3" xref="S3.Ex3.m1.2.2.2.2.1.1.3.cmml"><mi id="S3.Ex3.m1.2.2.2.2.1.1.3.2" xref="S3.Ex3.m1.2.2.2.2.1.1.3.2.cmml">β</mi><mi id="S3.Ex3.m1.2.2.2.2.1.1.3.3" xref="S3.Ex3.m1.2.2.2.2.1.1.3.3.cmml">𝐢𝐣</mi></msub></msub><mo id="S3.Ex3.m1.2.2.2.2.1.3" stretchy="false" xref="S3.Ex3.m1.2.2.2.2.2.1.cmml">‖</mo></mrow></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.2b"><apply id="S3.Ex3.m1.2.3.cmml" xref="S3.Ex3.m1.2.3"><eq id="S3.Ex3.m1.2.3.1.cmml" xref="S3.Ex3.m1.2.3.1"></eq><apply id="S3.Ex3.m1.2.3.2.cmml" xref="S3.Ex3.m1.2.3.2"><ci id="S3.Ex3.m1.2.3.2.1.cmml" xref="S3.Ex3.m1.2.3.2.1">^</ci><apply id="S3.Ex3.m1.2.3.2.2.cmml" xref="S3.Ex3.m1.2.3.2.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.2.3.2.2.1.cmml" xref="S3.Ex3.m1.2.3.2.2">subscript</csymbol><ci id="S3.Ex3.m1.2.3.2.2.2.cmml" xref="S3.Ex3.m1.2.3.2.2.2">𝑦</ci><apply id="S3.Ex3.m1.2.3.2.2.3.cmml" xref="S3.Ex3.m1.2.3.2.2.3"><times id="S3.Ex3.m1.2.3.2.2.3.1.cmml" xref="S3.Ex3.m1.2.3.2.2.3.1"></times><ci id="S3.Ex3.m1.2.3.2.2.3.2.cmml" xref="S3.Ex3.m1.2.3.2.2.3.2">𝑖</ci><ci id="S3.Ex3.m1.2.3.2.2.3.3.cmml" xref="S3.Ex3.m1.2.3.2.2.3.3">𝑗</ci></apply></apply></apply><apply id="S3.Ex3.m1.2.3.3.cmml" xref="S3.Ex3.m1.2.3.3"><apply id="S3.Ex3.m1.2.3.3.1.cmml" xref="S3.Ex3.m1.2.3.3.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.2.3.3.1.1.cmml" xref="S3.Ex3.m1.2.3.3.1">subscript</csymbol><ci id="S3.Ex3.m1.2.3.3.1.2.cmml" xref="S3.Ex3.m1.2.3.3.1.2">argmax</ci><ci id="S3.Ex3.m1.2.3.3.1.3.cmml" xref="S3.Ex3.m1.2.3.3.1.3">𝑘</ci></apply><apply id="S3.Ex3.m1.2.2.cmml" xref="S3.Ex3.m1.2.2"><divide id="S3.Ex3.m1.2.2.3.cmml" xref="S3.Ex3.m1.2.2"></divide><apply id="S3.Ex3.m1.2.2.4.cmml" xref="S3.Ex3.m1.2.2.4"><ci id="S3.Ex3.m1.2.2.4.1.cmml" xref="S3.Ex3.m1.2.2.4.1">⋅</ci><apply id="S3.Ex3.m1.2.2.4.2.cmml" xref="S3.Ex3.m1.2.2.4.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.2.2.4.2.1.cmml" xref="S3.Ex3.m1.2.2.4.2">subscript</csymbol><ci id="S3.Ex3.m1.2.2.4.2.2.cmml" xref="S3.Ex3.m1.2.2.4.2.2">𝜇</ci><ci id="S3.Ex3.m1.2.2.4.2.3.cmml" xref="S3.Ex3.m1.2.2.4.2.3">𝑘</ci></apply><apply id="S3.Ex3.m1.2.2.4.3.cmml" xref="S3.Ex3.m1.2.2.4.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.2.2.4.3.1.cmml" xref="S3.Ex3.m1.2.2.4.3">subscript</csymbol><ci id="S3.Ex3.m1.2.2.4.3.2.cmml" xref="S3.Ex3.m1.2.2.4.3.2">𝐇</ci><apply id="S3.Ex3.m1.2.2.4.3.3.cmml" xref="S3.Ex3.m1.2.2.4.3.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.2.2.4.3.3.1.cmml" xref="S3.Ex3.m1.2.2.4.3.3">subscript</csymbol><ci id="S3.Ex3.m1.2.2.4.3.3.2.cmml" xref="S3.Ex3.m1.2.2.4.3.3.2">𝛽</ci><ci id="S3.Ex3.m1.2.2.4.3.3.3.cmml" xref="S3.Ex3.m1.2.2.4.3.3.3">𝐢𝐣</ci></apply></apply></apply><apply id="S3.Ex3.m1.2.2.2.cmml" xref="S3.Ex3.m1.2.2.2"><times id="S3.Ex3.m1.2.2.2.3.cmml" xref="S3.Ex3.m1.2.2.2.3"></times><apply id="S3.Ex3.m1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex3.m1.1.1.1.1.2.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.2">norm</csymbol><apply id="S3.Ex3.m1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex3.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.2">𝜇</ci><ci id="S3.Ex3.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="S3.Ex3.m1.2.2.2.2.2.cmml" xref="S3.Ex3.m1.2.2.2.2.1"><csymbol cd="latexml" id="S3.Ex3.m1.2.2.2.2.2.1.cmml" xref="S3.Ex3.m1.2.2.2.2.1.2">norm</csymbol><apply id="S3.Ex3.m1.2.2.2.2.1.1.cmml" xref="S3.Ex3.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.2.2.2.2.1.1.1.cmml" xref="S3.Ex3.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S3.Ex3.m1.2.2.2.2.1.1.2.cmml" xref="S3.Ex3.m1.2.2.2.2.1.1.2">𝐇</ci><apply id="S3.Ex3.m1.2.2.2.2.1.1.3.cmml" xref="S3.Ex3.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.Ex3.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S3.Ex3.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.Ex3.m1.2.2.2.2.1.1.3.2">𝛽</ci><ci id="S3.Ex3.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.Ex3.m1.2.2.2.2.1.1.3.3">𝐢𝐣</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.2c">\hat{y_{ij}}=\operatorname*{argmax}_{k}\frac{\mathbf{\mu}_{k}\cdot\mathbf{H_{%
\beta_{ij}}}}{\|\mathbf{\mu}_{k}\|\ \|\mathbf{H_{\beta_{ij}}}\|}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex3.m1.2d">over^ start_ARG italic_y start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT end_ARG = roman_argmax start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT divide start_ARG italic_μ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ⋅ bold_H start_POSTSUBSCRIPT italic_β start_POSTSUBSCRIPT bold_ij end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_ARG start_ARG ∥ italic_μ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∥ ∥ bold_H start_POSTSUBSCRIPT italic_β start_POSTSUBSCRIPT bold_ij end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS1.p2">
<p class="ltx_p" id="S3.SS2.SSS1.p2.3">Where <math alttext="\mathbf{\mu}_{k}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.1.m1.1"><semantics id="S3.SS2.SSS1.p2.1.m1.1a"><msub id="S3.SS2.SSS1.p2.1.m1.1.1" xref="S3.SS2.SSS1.p2.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p2.1.m1.1.1.2" xref="S3.SS2.SSS1.p2.1.m1.1.1.2.cmml">μ</mi><mi id="S3.SS2.SSS1.p2.1.m1.1.1.3" xref="S3.SS2.SSS1.p2.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.1.m1.1b"><apply id="S3.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.2">𝜇</ci><ci id="S3.SS2.SSS1.p2.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.1.m1.1c">\mathbf{\mu}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.1.m1.1d">italic_μ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is the k’th clustering center, and <math alttext="\mathbf{H_{\beta_{ij}}}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.2.m2.1"><semantics id="S3.SS2.SSS1.p2.2.m2.1a"><msub id="S3.SS2.SSS1.p2.2.m2.1.1" xref="S3.SS2.SSS1.p2.2.m2.1.1.cmml"><mi id="S3.SS2.SSS1.p2.2.m2.1.1.2" xref="S3.SS2.SSS1.p2.2.m2.1.1.2.cmml">𝐇</mi><msub id="S3.SS2.SSS1.p2.2.m2.1.1.3" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.cmml"><mi id="S3.SS2.SSS1.p2.2.m2.1.1.3.2" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.2.cmml">β</mi><mi id="S3.SS2.SSS1.p2.2.m2.1.1.3.3" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.3.cmml">𝐢𝐣</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.2.m2.1b"><apply id="S3.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.2.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.2.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.2">𝐇</ci><apply id="S3.SS2.SSS1.p2.2.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS1.p2.2.m2.1.1.3.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.2">𝛽</ci><ci id="S3.SS2.SSS1.p2.2.m2.1.1.3.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.3">𝐢𝐣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.2.m2.1c">\mathbf{H_{\beta_{ij}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.2.m2.1d">bold_H start_POSTSUBSCRIPT italic_β start_POSTSUBSCRIPT bold_ij end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> is the concept feature vector from the concept feature matrix <math alttext="H" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.3.m3.1"><semantics id="S3.SS2.SSS1.p2.3.m3.1a"><mi id="S3.SS2.SSS1.p2.3.m3.1.1" xref="S3.SS2.SSS1.p2.3.m3.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.3.m3.1b"><ci id="S3.SS2.SSS1.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.3.m3.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.3.m3.1d">italic_H</annotation></semantics></math></p>
</div>
<div class="ltx_para" id="S3.SS2.SSS1.p3">
<p class="ltx_p" id="S3.SS2.SSS1.p3.1">The pipeline for F-SEG when classifying factorized concepts into the most similar cluster is illustrated in figure <a class="ltx_ref" href="https://arxiv.org/html/2409.05697v1#S3.F2" title="Figure 2 ‣ 3.2.1 Assigning factorized concepts to similar clusters ‣ 3.2 Methods for achieving consistent concepts between images ‣ 3 Methods ‣ Segmentation by Factorization: Unsupervised Semantic Segmentation for Pathology by Factorizing Foundation Model Features"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure class="ltx_figure" id="S3.F2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Overview of F-SEG when classifying factorized concepts into the most similar cluster</figcaption><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="108" id="S3.F2.g1" src="extracted/5841227/images/pipeline_cosine_similarity.png" width="423"/>
</figure>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Solving for segmentation masks that correspond to cluster centers</h4>
<div class="ltx_para" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.4">Here instead of applying NMF to solve for both the <math alttext="H" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.1.m1.1"><semantics id="S3.SS2.SSS2.p1.1.m1.1a"><mi id="S3.SS2.SSS2.p1.1.m1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.1.m1.1b"><ci id="S3.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.1.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.1.m1.1d">italic_H</annotation></semantics></math> and <math alttext="W" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.2.m2.1"><semantics id="S3.SS2.SSS2.p1.2.m2.1a"><mi id="S3.SS2.SSS2.p1.2.m2.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.2.m2.1b"><ci id="S3.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.2.m2.1c">W</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.2.m2.1d">italic_W</annotation></semantics></math> matrices, we set the matrix <math alttext="H" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.3.m3.1"><semantics id="S3.SS2.SSS2.p1.3.m3.1a"><mi id="S3.SS2.SSS2.p1.3.m3.1.1" xref="S3.SS2.SSS2.p1.3.m3.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.3.m3.1b"><ci id="S3.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.3.m3.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.3.m3.1d">italic_H</annotation></semantics></math> to be equal to the cluster centers, and solve only for <math alttext="W" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.4.m4.1"><semantics id="S3.SS2.SSS2.p1.4.m4.1a"><mi id="S3.SS2.SSS2.p1.4.m4.1.1" xref="S3.SS2.SSS2.p1.4.m4.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.4.m4.1b"><ci id="S3.SS2.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.4.m4.1c">W</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.4.m4.1d">italic_W</annotation></semantics></math>. This finds a segmentation mask that corresponds to these clusters.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS2.p2">
<p class="ltx_p" id="S3.SS2.SSS2.p2.1">The pipeline for F-SEG when fixing the concept matrix is illustrated in figure <a class="ltx_ref" href="https://arxiv.org/html/2409.05697v1#S3.F3" title="Figure 3 ‣ 3.2.2 Solving for segmentation masks that correspond to cluster centers ‣ 3.2 Methods for achieving consistent concepts between images ‣ 3 Methods ‣ Segmentation by Factorization: Unsupervised Semantic Segmentation for Pathology by Factorizing Foundation Model Features"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure class="ltx_figure" id="S3.F3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Overview of F-SEG when fixing the concept matrix to be cluster centers</figcaption><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="108" id="S3.F3.g1" src="extracted/5841227/images/pipeline_fixed_h.png" width="349"/>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Unsupervised semantic segmentation for H&amp;E images</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Here we apply F-SEG for unsupervised semantic segmentation of H&amp;E histology images. To create clustering models used by the factorization, we extract image tiles of size <math alttext="256\times 256" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mrow id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mn id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">256</mn><mo id="S3.SS3.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p1.1.m1.1.1.1.cmml">×</mo><mn id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><times id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1"></times><cn id="S3.SS3.p1.1.m1.1.1.2.cmml" type="integer" xref="S3.SS3.p1.1.m1.1.1.2">256</cn><cn id="S3.SS3.p1.1.m1.1.1.3.cmml" type="integer" xref="S3.SS3.p1.1.m1.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">256\times 256</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">256 × 256</annotation></semantics></math> from whole-slide images (WSIs) at a magnification of 10x from the TCGA dataset. The tiles are randomly sampled, with 200 tiles taken per slide from a total of 11,000 slides, covering a wide variety of tissue types and morphologies.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">For clustering we use k-means with varying values of <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">italic_k</annotation></semantics></math> (16, 32, 64, 128, and 256) allowing segmentation into different numbers of categories. By adjusting the k-value, we can classify the image regions into varying levels of granularity, allowing the segmentation to capture either broad tissue regions or finer anatomical structures, allowing a quick adaptation of the segmentation to different requirements.</p>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.1">We compare F-SEG with three deep learning models: the Resnet50 model <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">he2016deep</span>]</cite>, and two recent foundation models, the UNI model <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">chen2024uni</span>]</cite> and the Prov-GigaPath model <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">xu2024gigapath</span>]</cite>, both of which are based on vision transformers <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">dosovitskiy2020vit</span>]</cite>. The Resnet50 model serves as our baseline, having been pre-trained on the ImageNet dataset, which is commonly used for general image classification tasks. In contrast, the UNI and Prov-GigaPath models are state-of-the-art vision transformers, designed specifically for large-scale image analysis and particularly suited to extracting complex spatial relationships in digital pathology images.</p>
</div>
<div class="ltx_para" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.1">For feature extraction using Resnet50, we observed through early experimentation that better clustering performance was achieved when using the activations from the second-to-last Resnet block, that has a higher spatial resolution at it’s output, rather than the final block.
For the foundation vision transformer models, we use the activations from the final self-attention block. However, since the outputs of these vision transformer models can contain negative values, in contrast to the Resnet50 model, which includes a Rectified Linear Unit (ReLU) activation <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">agarap2018deep</span>]</cite> to zero out negative values, we apply a ReLU to these features as a post-processing step. This ensures that there are no negative values in the activations factorized with Non Negative Matrix Factorization. However this is the most simple choice, and other ways could be potentially explored.</p>
</div>
<div class="ltx_para" id="S3.SS3.p5">
<p class="ltx_p" id="S3.SS3.p5.1">Finally we apply a Global Average Pooling (GAP) layer on top of the extracted features, and remove their spatial dimensions, resulting in 1D features suitable for clustering with k-means.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Evaluation Datasets</h3>
<section class="ltx_subsubsection" id="S3.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.4.1 </span>Breast Cancer Semantic Segmentation</h4>
<div class="ltx_para" id="S3.SS4.SSS1.p1">
<p class="ltx_p" id="S3.SS4.SSS1.p1.1">The Breast Cancer Semantic Segmentation (BCSS) dataset <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">amgad2019structured</span>]</cite> contains over 20,000 segmentation annotations of tissue regions from breast cancer images sourced from The Cancer Genome Atlas (TCGA).
The dataset is divided into training and test sets, with pixel-wise category labels for both sets. In the training set, the Tumor category constitutes 15.17% of the pixels, the Stroma category 34.89%, the Inflammatory category 30.37%, the Necrosis category 9.47%, and the Other category 5.86%.</p>
</div>
<div class="ltx_para" id="S3.SS4.SSS1.p2">
<p class="ltx_p" id="S3.SS4.SSS1.p2.1">The test set shows a different distribution, with the Tumor category making up 33.55% of the pixels, the Stroma category 24.3%, the Inflammatory category 26.24%, the Necrosis category 9.23%, and the Other category 3.26%. The variation in pixel distribution between the training and test sets provides a robust basis for evaluating the performance and generalization capabilities of segmentation models.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS4.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.4.2 </span>WSSS4LUAD</h4>
<div class="ltx_para" id="S3.SS4.SSS2.p1">
<p class="ltx_p" id="S3.SS4.SSS2.p1.1">The Weakly-supervised Tissue Semantic Segmentation
for Lung Adenocarcinoma (WSSS4LUAD) challenge <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">graham2021lizard</span>]</cite> aims to perform tissue semantic segmentation in H&amp;E stained Whole Slide Images (WSIs) for lung adenocarcinoma.</p>
</div>
<div class="ltx_para" id="S3.SS4.SSS2.p2">
<p class="ltx_p" id="S3.SS4.SSS2.p2.12">For the validation set, a total of 40 patches were manually cropped by the label review board. This set included 9 large patches (approximately <math alttext="1500-5000" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p2.1.m1.1"><semantics id="S3.SS4.SSS2.p2.1.m1.1a"><mrow id="S3.SS4.SSS2.p2.1.m1.1.1" xref="S3.SS4.SSS2.p2.1.m1.1.1.cmml"><mn id="S3.SS4.SSS2.p2.1.m1.1.1.2" xref="S3.SS4.SSS2.p2.1.m1.1.1.2.cmml">1500</mn><mo id="S3.SS4.SSS2.p2.1.m1.1.1.1" xref="S3.SS4.SSS2.p2.1.m1.1.1.1.cmml">−</mo><mn id="S3.SS4.SSS2.p2.1.m1.1.1.3" xref="S3.SS4.SSS2.p2.1.m1.1.1.3.cmml">5000</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p2.1.m1.1b"><apply id="S3.SS4.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS4.SSS2.p2.1.m1.1.1"><minus id="S3.SS4.SSS2.p2.1.m1.1.1.1.cmml" xref="S3.SS4.SSS2.p2.1.m1.1.1.1"></minus><cn id="S3.SS4.SSS2.p2.1.m1.1.1.2.cmml" type="integer" xref="S3.SS4.SSS2.p2.1.m1.1.1.2">1500</cn><cn id="S3.SS4.SSS2.p2.1.m1.1.1.3.cmml" type="integer" xref="S3.SS4.SSS2.p2.1.m1.1.1.3">5000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p2.1.m1.1c">1500-5000</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p2.1.m1.1d">1500 - 5000</annotation></semantics></math> <math alttext="\times" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p2.2.m2.1"><semantics id="S3.SS4.SSS2.p2.2.m2.1a"><mo id="S3.SS4.SSS2.p2.2.m2.1.1" xref="S3.SS4.SSS2.p2.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p2.2.m2.1b"><times id="S3.SS4.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS4.SSS2.p2.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p2.2.m2.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p2.2.m2.1d">×</annotation></semantics></math> <math alttext="1500-5000" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p2.3.m3.1"><semantics id="S3.SS4.SSS2.p2.3.m3.1a"><mrow id="S3.SS4.SSS2.p2.3.m3.1.1" xref="S3.SS4.SSS2.p2.3.m3.1.1.cmml"><mn id="S3.SS4.SSS2.p2.3.m3.1.1.2" xref="S3.SS4.SSS2.p2.3.m3.1.1.2.cmml">1500</mn><mo id="S3.SS4.SSS2.p2.3.m3.1.1.1" xref="S3.SS4.SSS2.p2.3.m3.1.1.1.cmml">−</mo><mn id="S3.SS4.SSS2.p2.3.m3.1.1.3" xref="S3.SS4.SSS2.p2.3.m3.1.1.3.cmml">5000</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p2.3.m3.1b"><apply id="S3.SS4.SSS2.p2.3.m3.1.1.cmml" xref="S3.SS4.SSS2.p2.3.m3.1.1"><minus id="S3.SS4.SSS2.p2.3.m3.1.1.1.cmml" xref="S3.SS4.SSS2.p2.3.m3.1.1.1"></minus><cn id="S3.SS4.SSS2.p2.3.m3.1.1.2.cmml" type="integer" xref="S3.SS4.SSS2.p2.3.m3.1.1.2">1500</cn><cn id="S3.SS4.SSS2.p2.3.m3.1.1.3.cmml" type="integer" xref="S3.SS4.SSS2.p2.3.m3.1.1.3">5000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p2.3.m3.1c">1500-5000</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p2.3.m3.1d">1500 - 5000</annotation></semantics></math> pixels) and 31 small patches (approximately <math alttext="200-500" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p2.4.m4.1"><semantics id="S3.SS4.SSS2.p2.4.m4.1a"><mrow id="S3.SS4.SSS2.p2.4.m4.1.1" xref="S3.SS4.SSS2.p2.4.m4.1.1.cmml"><mn id="S3.SS4.SSS2.p2.4.m4.1.1.2" xref="S3.SS4.SSS2.p2.4.m4.1.1.2.cmml">200</mn><mo id="S3.SS4.SSS2.p2.4.m4.1.1.1" xref="S3.SS4.SSS2.p2.4.m4.1.1.1.cmml">−</mo><mn id="S3.SS4.SSS2.p2.4.m4.1.1.3" xref="S3.SS4.SSS2.p2.4.m4.1.1.3.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p2.4.m4.1b"><apply id="S3.SS4.SSS2.p2.4.m4.1.1.cmml" xref="S3.SS4.SSS2.p2.4.m4.1.1"><minus id="S3.SS4.SSS2.p2.4.m4.1.1.1.cmml" xref="S3.SS4.SSS2.p2.4.m4.1.1.1"></minus><cn id="S3.SS4.SSS2.p2.4.m4.1.1.2.cmml" type="integer" xref="S3.SS4.SSS2.p2.4.m4.1.1.2">200</cn><cn id="S3.SS4.SSS2.p2.4.m4.1.1.3.cmml" type="integer" xref="S3.SS4.SSS2.p2.4.m4.1.1.3">500</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p2.4.m4.1c">200-500</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p2.4.m4.1d">200 - 500</annotation></semantics></math> <math alttext="\times" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p2.5.m5.1"><semantics id="S3.SS4.SSS2.p2.5.m5.1a"><mo id="S3.SS4.SSS2.p2.5.m5.1.1" xref="S3.SS4.SSS2.p2.5.m5.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p2.5.m5.1b"><times id="S3.SS4.SSS2.p2.5.m5.1.1.cmml" xref="S3.SS4.SSS2.p2.5.m5.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p2.5.m5.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p2.5.m5.1d">×</annotation></semantics></math> <math alttext="200-500" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p2.6.m6.1"><semantics id="S3.SS4.SSS2.p2.6.m6.1a"><mrow id="S3.SS4.SSS2.p2.6.m6.1.1" xref="S3.SS4.SSS2.p2.6.m6.1.1.cmml"><mn id="S3.SS4.SSS2.p2.6.m6.1.1.2" xref="S3.SS4.SSS2.p2.6.m6.1.1.2.cmml">200</mn><mo id="S3.SS4.SSS2.p2.6.m6.1.1.1" xref="S3.SS4.SSS2.p2.6.m6.1.1.1.cmml">−</mo><mn id="S3.SS4.SSS2.p2.6.m6.1.1.3" xref="S3.SS4.SSS2.p2.6.m6.1.1.3.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p2.6.m6.1b"><apply id="S3.SS4.SSS2.p2.6.m6.1.1.cmml" xref="S3.SS4.SSS2.p2.6.m6.1.1"><minus id="S3.SS4.SSS2.p2.6.m6.1.1.1.cmml" xref="S3.SS4.SSS2.p2.6.m6.1.1.1"></minus><cn id="S3.SS4.SSS2.p2.6.m6.1.1.2.cmml" type="integer" xref="S3.SS4.SSS2.p2.6.m6.1.1.2">200</cn><cn id="S3.SS4.SSS2.p2.6.m6.1.1.3.cmml" type="integer" xref="S3.SS4.SSS2.p2.6.m6.1.1.3">500</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p2.6.m6.1c">200-500</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p2.6.m6.1d">200 - 500</annotation></semantics></math> pixels). For the test set, a total of 80 patches were manually cropped, consisting of 14 large patches (approximately <math alttext="1500-5000" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p2.7.m7.1"><semantics id="S3.SS4.SSS2.p2.7.m7.1a"><mrow id="S3.SS4.SSS2.p2.7.m7.1.1" xref="S3.SS4.SSS2.p2.7.m7.1.1.cmml"><mn id="S3.SS4.SSS2.p2.7.m7.1.1.2" xref="S3.SS4.SSS2.p2.7.m7.1.1.2.cmml">1500</mn><mo id="S3.SS4.SSS2.p2.7.m7.1.1.1" xref="S3.SS4.SSS2.p2.7.m7.1.1.1.cmml">−</mo><mn id="S3.SS4.SSS2.p2.7.m7.1.1.3" xref="S3.SS4.SSS2.p2.7.m7.1.1.3.cmml">5000</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p2.7.m7.1b"><apply id="S3.SS4.SSS2.p2.7.m7.1.1.cmml" xref="S3.SS4.SSS2.p2.7.m7.1.1"><minus id="S3.SS4.SSS2.p2.7.m7.1.1.1.cmml" xref="S3.SS4.SSS2.p2.7.m7.1.1.1"></minus><cn id="S3.SS4.SSS2.p2.7.m7.1.1.2.cmml" type="integer" xref="S3.SS4.SSS2.p2.7.m7.1.1.2">1500</cn><cn id="S3.SS4.SSS2.p2.7.m7.1.1.3.cmml" type="integer" xref="S3.SS4.SSS2.p2.7.m7.1.1.3">5000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p2.7.m7.1c">1500-5000</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p2.7.m7.1d">1500 - 5000</annotation></semantics></math> <math alttext="\times" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p2.8.m8.1"><semantics id="S3.SS4.SSS2.p2.8.m8.1a"><mo id="S3.SS4.SSS2.p2.8.m8.1.1" xref="S3.SS4.SSS2.p2.8.m8.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p2.8.m8.1b"><times id="S3.SS4.SSS2.p2.8.m8.1.1.cmml" xref="S3.SS4.SSS2.p2.8.m8.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p2.8.m8.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p2.8.m8.1d">×</annotation></semantics></math> <math alttext="1500-5000" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p2.9.m9.1"><semantics id="S3.SS4.SSS2.p2.9.m9.1a"><mrow id="S3.SS4.SSS2.p2.9.m9.1.1" xref="S3.SS4.SSS2.p2.9.m9.1.1.cmml"><mn id="S3.SS4.SSS2.p2.9.m9.1.1.2" xref="S3.SS4.SSS2.p2.9.m9.1.1.2.cmml">1500</mn><mo id="S3.SS4.SSS2.p2.9.m9.1.1.1" xref="S3.SS4.SSS2.p2.9.m9.1.1.1.cmml">−</mo><mn id="S3.SS4.SSS2.p2.9.m9.1.1.3" xref="S3.SS4.SSS2.p2.9.m9.1.1.3.cmml">5000</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p2.9.m9.1b"><apply id="S3.SS4.SSS2.p2.9.m9.1.1.cmml" xref="S3.SS4.SSS2.p2.9.m9.1.1"><minus id="S3.SS4.SSS2.p2.9.m9.1.1.1.cmml" xref="S3.SS4.SSS2.p2.9.m9.1.1.1"></minus><cn id="S3.SS4.SSS2.p2.9.m9.1.1.2.cmml" type="integer" xref="S3.SS4.SSS2.p2.9.m9.1.1.2">1500</cn><cn id="S3.SS4.SSS2.p2.9.m9.1.1.3.cmml" type="integer" xref="S3.SS4.SSS2.p2.9.m9.1.1.3">5000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p2.9.m9.1c">1500-5000</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p2.9.m9.1d">1500 - 5000</annotation></semantics></math> pixels) and 66 small patches (approximately <math alttext="200-500" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p2.10.m10.1"><semantics id="S3.SS4.SSS2.p2.10.m10.1a"><mrow id="S3.SS4.SSS2.p2.10.m10.1.1" xref="S3.SS4.SSS2.p2.10.m10.1.1.cmml"><mn id="S3.SS4.SSS2.p2.10.m10.1.1.2" xref="S3.SS4.SSS2.p2.10.m10.1.1.2.cmml">200</mn><mo id="S3.SS4.SSS2.p2.10.m10.1.1.1" xref="S3.SS4.SSS2.p2.10.m10.1.1.1.cmml">−</mo><mn id="S3.SS4.SSS2.p2.10.m10.1.1.3" xref="S3.SS4.SSS2.p2.10.m10.1.1.3.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p2.10.m10.1b"><apply id="S3.SS4.SSS2.p2.10.m10.1.1.cmml" xref="S3.SS4.SSS2.p2.10.m10.1.1"><minus id="S3.SS4.SSS2.p2.10.m10.1.1.1.cmml" xref="S3.SS4.SSS2.p2.10.m10.1.1.1"></minus><cn id="S3.SS4.SSS2.p2.10.m10.1.1.2.cmml" type="integer" xref="S3.SS4.SSS2.p2.10.m10.1.1.2">200</cn><cn id="S3.SS4.SSS2.p2.10.m10.1.1.3.cmml" type="integer" xref="S3.SS4.SSS2.p2.10.m10.1.1.3">500</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p2.10.m10.1c">200-500</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p2.10.m10.1d">200 - 500</annotation></semantics></math> <math alttext="\times" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p2.11.m11.1"><semantics id="S3.SS4.SSS2.p2.11.m11.1a"><mo id="S3.SS4.SSS2.p2.11.m11.1.1" xref="S3.SS4.SSS2.p2.11.m11.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p2.11.m11.1b"><times id="S3.SS4.SSS2.p2.11.m11.1.1.cmml" xref="S3.SS4.SSS2.p2.11.m11.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p2.11.m11.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p2.11.m11.1d">×</annotation></semantics></math> <math alttext="200-500" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p2.12.m12.1"><semantics id="S3.SS4.SSS2.p2.12.m12.1a"><mrow id="S3.SS4.SSS2.p2.12.m12.1.1" xref="S3.SS4.SSS2.p2.12.m12.1.1.cmml"><mn id="S3.SS4.SSS2.p2.12.m12.1.1.2" xref="S3.SS4.SSS2.p2.12.m12.1.1.2.cmml">200</mn><mo id="S3.SS4.SSS2.p2.12.m12.1.1.1" xref="S3.SS4.SSS2.p2.12.m12.1.1.1.cmml">−</mo><mn id="S3.SS4.SSS2.p2.12.m12.1.1.3" xref="S3.SS4.SSS2.p2.12.m12.1.1.3.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p2.12.m12.1b"><apply id="S3.SS4.SSS2.p2.12.m12.1.1.cmml" xref="S3.SS4.SSS2.p2.12.m12.1.1"><minus id="S3.SS4.SSS2.p2.12.m12.1.1.1.cmml" xref="S3.SS4.SSS2.p2.12.m12.1.1.1"></minus><cn id="S3.SS4.SSS2.p2.12.m12.1.1.2.cmml" type="integer" xref="S3.SS4.SSS2.p2.12.m12.1.1.2">200</cn><cn id="S3.SS4.SSS2.p2.12.m12.1.1.3.cmml" type="integer" xref="S3.SS4.SSS2.p2.12.m12.1.1.3">500</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p2.12.m12.1c">200-500</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p2.12.m12.1d">200 - 500</annotation></semantics></math> pixels).</p>
</div>
<div class="ltx_para" id="S3.SS4.SSS2.p3">
<p class="ltx_p" id="S3.SS4.SSS2.p3.1">The distribution of pixel labels across different categories in the validation set is 42.18% pixels for the Tumor category, 27.78% pixels for the Stroma category, 26.63% pixels for the Background category, and 3.39% pixels for the Normal category. In the test set, the distribution is 46.25% pixels for the Tumor category, 33.63% pixels for the Stroma category, 17.66% pixels for the Background category, and 2.44% pixels for the Normal category.</p>
</div>
<div class="ltx_para" id="S3.SS4.SSS2.p4">
<p class="ltx_p" id="S3.SS4.SSS2.p4.1">Since the training set is labeled weakly with only image-level annotations, we focused our evaluation on the validation and test sets, which have precise pixel-level annotations.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Evaluation methods</h3>
<div class="ltx_para" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.1">In this section, we outline the evaluation methods used to assess the performance of our methods. We propose two evaluation methods for unsupervised segmentation. First, a "linear probing" method specific to F-SEG that benchmarks the potential of the factorized features and segmentation masks, where a linear classifier on top of the factorized features is used to classify them into ground truth categories, evaluating both the factorized features, and the segmentation quality. And a second matching-based approach, suitable for unsupervised segmentation methods in general, that benchmarks the unsupervised segmentation by matching the predicted unsupervised categories with the ground truth categories.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS5.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.5.1 </span>Linear probing</h4>
<div class="ltx_para" id="S3.SS5.SSS1.p1">
<p class="ltx_p" id="S3.SS5.SSS1.p1.1">In this evaluation method we replaced the clustering model with a linear classifier to classify concept features into specific categories. The classifier is trained on top of factorized features that are found to be co-occuring with ground truth categories.To train the classifier, we followed these steps:</p>
</div>
<div class="ltx_para" id="S3.SS5.SSS1.p2">
<p class="ltx_p" id="S3.SS5.SSS1.p2.2">1. <span class="ltx_text ltx_font_bold" id="S3.SS5.SSS1.p2.2.1">Concept-Category Association:</span> For each tile, we identified concepts obtained with NMF that were highly associated with certain categories. For each concept <math alttext="m" class="ltx_Math" display="inline" id="S3.SS5.SSS1.p2.1.m1.1"><semantics id="S3.SS5.SSS1.p2.1.m1.1a"><mi id="S3.SS5.SSS1.p2.1.m1.1.1" xref="S3.SS5.SSS1.p2.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS1.p2.1.m1.1b"><ci id="S3.SS5.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS5.SSS1.p2.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS1.p2.1.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS1.p2.1.m1.1d">italic_m</annotation></semantics></math>, we calculated the percentage of pixels corresponding to that concept which fell into a ground truth category <math alttext="n" class="ltx_Math" display="inline" id="S3.SS5.SSS1.p2.2.m2.1"><semantics id="S3.SS5.SSS1.p2.2.m2.1a"><mi id="S3.SS5.SSS1.p2.2.m2.1.1" xref="S3.SS5.SSS1.p2.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS1.p2.2.m2.1b"><ci id="S3.SS5.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS5.SSS1.p2.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS1.p2.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS1.p2.2.m2.1d">italic_n</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS5.SSS1.p3">
<p class="ltx_p" id="S3.SS5.SSS1.p3.5">2. <span class="ltx_text ltx_font_bold" id="S3.SS5.SSS1.p3.5.1">Thresholding:</span> If the percentage of pixels for concept <math alttext="m" class="ltx_Math" display="inline" id="S3.SS5.SSS1.p3.1.m1.1"><semantics id="S3.SS5.SSS1.p3.1.m1.1a"><mi id="S3.SS5.SSS1.p3.1.m1.1.1" xref="S3.SS5.SSS1.p3.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS1.p3.1.m1.1b"><ci id="S3.SS5.SSS1.p3.1.m1.1.1.cmml" xref="S3.SS5.SSS1.p3.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS1.p3.1.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS1.p3.1.m1.1d">italic_m</annotation></semantics></math> in category <math alttext="n" class="ltx_Math" display="inline" id="S3.SS5.SSS1.p3.2.m2.1"><semantics id="S3.SS5.SSS1.p3.2.m2.1a"><mi id="S3.SS5.SSS1.p3.2.m2.1.1" xref="S3.SS5.SSS1.p3.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS1.p3.2.m2.1b"><ci id="S3.SS5.SSS1.p3.2.m2.1.1.cmml" xref="S3.SS5.SSS1.p3.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS1.p3.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS1.p3.2.m2.1d">italic_n</annotation></semantics></math> exceeded a predefined threshold, we assigned category <math alttext="n" class="ltx_Math" display="inline" id="S3.SS5.SSS1.p3.3.m3.1"><semantics id="S3.SS5.SSS1.p3.3.m3.1a"><mi id="S3.SS5.SSS1.p3.3.m3.1.1" xref="S3.SS5.SSS1.p3.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS1.p3.3.m3.1b"><ci id="S3.SS5.SSS1.p3.3.m3.1.1.cmml" xref="S3.SS5.SSS1.p3.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS1.p3.3.m3.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS1.p3.3.m3.1d">italic_n</annotation></semantics></math> to that concept. We then recorded the concept feautures <math alttext="H_{m}" class="ltx_Math" display="inline" id="S3.SS5.SSS1.p3.4.m4.1"><semantics id="S3.SS5.SSS1.p3.4.m4.1a"><msub id="S3.SS5.SSS1.p3.4.m4.1.1" xref="S3.SS5.SSS1.p3.4.m4.1.1.cmml"><mi id="S3.SS5.SSS1.p3.4.m4.1.1.2" xref="S3.SS5.SSS1.p3.4.m4.1.1.2.cmml">H</mi><mi id="S3.SS5.SSS1.p3.4.m4.1.1.3" xref="S3.SS5.SSS1.p3.4.m4.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS1.p3.4.m4.1b"><apply id="S3.SS5.SSS1.p3.4.m4.1.1.cmml" xref="S3.SS5.SSS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS5.SSS1.p3.4.m4.1.1.1.cmml" xref="S3.SS5.SSS1.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS5.SSS1.p3.4.m4.1.1.2.cmml" xref="S3.SS5.SSS1.p3.4.m4.1.1.2">𝐻</ci><ci id="S3.SS5.SSS1.p3.4.m4.1.1.3.cmml" xref="S3.SS5.SSS1.p3.4.m4.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS1.p3.4.m4.1c">H_{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS1.p3.4.m4.1d">italic_H start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> along with its label <math alttext="n" class="ltx_Math" display="inline" id="S3.SS5.SSS1.p3.5.m5.1"><semantics id="S3.SS5.SSS1.p3.5.m5.1a"><mi id="S3.SS5.SSS1.p3.5.m5.1.1" xref="S3.SS5.SSS1.p3.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS1.p3.5.m5.1b"><ci id="S3.SS5.SSS1.p3.5.m5.1.1.cmml" xref="S3.SS5.SSS1.p3.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS1.p3.5.m5.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS1.p3.5.m5.1d">italic_n</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS5.SSS1.p4">
<p class="ltx_p" id="S3.SS5.SSS1.p4.1">3. <span class="ltx_text ltx_font_bold" id="S3.SS5.SSS1.p4.1.1">Training the Linear Classifier:</span> We used the generated pairs of concept features and their corresponding labels to train a linear classifier <math alttext="w" class="ltx_Math" display="inline" id="S3.SS5.SSS1.p4.1.m1.1"><semantics id="S3.SS5.SSS1.p4.1.m1.1a"><mi id="S3.SS5.SSS1.p4.1.m1.1.1" xref="S3.SS5.SSS1.p4.1.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS1.p4.1.m1.1b"><ci id="S3.SS5.SSS1.p4.1.m1.1.1.cmml" xref="S3.SS5.SSS1.p4.1.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS1.p4.1.m1.1c">w</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS1.p4.1.m1.1d">italic_w</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS5.SSS1.p5">
<p class="ltx_p" id="S3.SS5.SSS1.p5.1">4. <span class="ltx_text ltx_font_bold" id="S3.SS5.SSS1.p5.1.1">Generating Semantic Segmentation Labels:</span> Finally, we utilized the trained linear classifier to classify the concept features, resulting in the semantic segmentation labels <math alttext="\hat{y}" class="ltx_Math" display="inline" id="S3.SS5.SSS1.p5.1.m1.1"><semantics id="S3.SS5.SSS1.p5.1.m1.1a"><mover accent="true" id="S3.SS5.SSS1.p5.1.m1.1.1" xref="S3.SS5.SSS1.p5.1.m1.1.1.cmml"><mi id="S3.SS5.SSS1.p5.1.m1.1.1.2" xref="S3.SS5.SSS1.p5.1.m1.1.1.2.cmml">y</mi><mo id="S3.SS5.SSS1.p5.1.m1.1.1.1" xref="S3.SS5.SSS1.p5.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS1.p5.1.m1.1b"><apply id="S3.SS5.SSS1.p5.1.m1.1.1.cmml" xref="S3.SS5.SSS1.p5.1.m1.1.1"><ci id="S3.SS5.SSS1.p5.1.m1.1.1.1.cmml" xref="S3.SS5.SSS1.p5.1.m1.1.1.1">^</ci><ci id="S3.SS5.SSS1.p5.1.m1.1.1.2.cmml" xref="S3.SS5.SSS1.p5.1.m1.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS1.p5.1.m1.1c">\hat{y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS1.p5.1.m1.1d">over^ start_ARG italic_y end_ARG</annotation></semantics></math>.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{y_{ij}}=\operatorname*{argmax}_{c=1..n}{w_{c}\cdot{H_{\beta_{ij}}}}" class="ltx_math_unparsed" display="block" id="S3.Ex4.m1.1"><semantics id="S3.Ex4.m1.1a"><mrow id="S3.Ex4.m1.1.1"><mover accent="true" id="S3.Ex4.m1.1.1.2"><msub id="S3.Ex4.m1.1.1.2.2"><mi id="S3.Ex4.m1.1.1.2.2.2">y</mi><mrow id="S3.Ex4.m1.1.1.2.2.3"><mi id="S3.Ex4.m1.1.1.2.2.3.2">i</mi><mo id="S3.Ex4.m1.1.1.2.2.3.1">⁢</mo><mi id="S3.Ex4.m1.1.1.2.2.3.3">j</mi></mrow></msub><mo id="S3.Ex4.m1.1.1.2.1">^</mo></mover><mo id="S3.Ex4.m1.1.1.1" rspace="0.1389em">=</mo><mrow id="S3.Ex4.m1.1.1.3"><munder id="S3.Ex4.m1.1.1.3.1"><mo id="S3.Ex4.m1.1.1.3.1.2" lspace="0.1389em" rspace="0.167em">argmax</mo><mrow id="S3.Ex4.m1.1.1.3.1.3"><mi id="S3.Ex4.m1.1.1.3.1.3.1">c</mi><mo id="S3.Ex4.m1.1.1.3.1.3.2">=</mo><mn id="S3.Ex4.m1.1.1.3.1.3.3">1</mn><mo id="S3.Ex4.m1.1.1.3.1.3.4" lspace="0em" rspace="0.0835em">.</mo><mo id="S3.Ex4.m1.1.1.3.1.3.5" lspace="0.0835em" rspace="0.167em">.</mo><mi id="S3.Ex4.m1.1.1.3.1.3.6">n</mi></mrow></munder><mrow id="S3.Ex4.m1.1.1.3.2"><msub id="S3.Ex4.m1.1.1.3.2.2"><mi id="S3.Ex4.m1.1.1.3.2.2.2">w</mi><mi id="S3.Ex4.m1.1.1.3.2.2.3">c</mi></msub><mo id="S3.Ex4.m1.1.1.3.2.1" lspace="0.222em" rspace="0.222em">⋅</mo><msub id="S3.Ex4.m1.1.1.3.2.3"><mi id="S3.Ex4.m1.1.1.3.2.3.2">H</mi><msub id="S3.Ex4.m1.1.1.3.2.3.3"><mi id="S3.Ex4.m1.1.1.3.2.3.3.2">β</mi><mrow id="S3.Ex4.m1.1.1.3.2.3.3.3"><mi id="S3.Ex4.m1.1.1.3.2.3.3.3.2">i</mi><mo id="S3.Ex4.m1.1.1.3.2.3.3.3.1">⁢</mo><mi id="S3.Ex4.m1.1.1.3.2.3.3.3.3">j</mi></mrow></msub></msub></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S3.Ex4.m1.1b">\hat{y_{ij}}=\operatorname*{argmax}_{c=1..n}{w_{c}\cdot{H_{\beta_{ij}}}}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex4.m1.1c">over^ start_ARG italic_y start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT end_ARG = roman_argmax start_POSTSUBSCRIPT italic_c = 1 . . italic_n end_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ⋅ italic_H start_POSTSUBSCRIPT italic_β start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS5.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.5.2 </span>Matching based on cluster-category frequencies</h4>
<div class="ltx_para" id="S3.SS5.SSS2.p1">
<p class="ltx_p" id="S3.SS5.SSS2.p1.1">In this section, we describe the process of matching cluster indices with ground truth categories. Each cluster is associated with a single ground truth category, though a ground truth category can correspond to multiple clusters.</p>
</div>
<div class="ltx_para" id="S3.SS5.SSS2.p2">
<p class="ltx_p" id="S3.SS5.SSS2.p2.1">- Matching Clusters to Ground Truth Categories: For each cluster, we calculate the frequency of pixels from each ground truth category that fall within the cluster. We then match each cluster to the ground truth category that has the highest frequency of pixels within that cluster.</p>
</div>
<div class="ltx_para" id="S3.SS5.SSS2.p3">
<p class="ltx_p" id="S3.SS5.SSS2.p3.1">- Handling Unbalanced Categories: The distribution of ground truth categories can be uneven, with some categories being very common and others quite rare. To address this imbalance, we provide an alternative matching method. In this method, we normalize the frequency of pixels in each cluster by the total number of pixels in the respective ground truth category. This normalization allows for matching clusters with ground truth categories when there is a high unbalance in the number of pixels belonging to different ground truth categories.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Results</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">The results for all models and evaluation methods are shown in Figures <a class="ltx_ref" href="https://arxiv.org/html/2409.05697v1#S4.F4" title="Figure 4 ‣ 4 Results ‣ Segmentation by Factorization: Unsupervised Semantic Segmentation for Pathology by Factorizing Foundation Model Features"><span class="ltx_text ltx_ref_tag">4</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2409.05697v1#S4.F5" title="Figure 5 ‣ 4 Results ‣ Segmentation by Factorization: Unsupervised Semantic Segmentation for Pathology by Factorizing Foundation Model Features"><span class="ltx_text ltx_ref_tag">5</span></a>. The foundation models demonstrate a significant improvement over the baseline Resnet50 model pretrained on ImageNet. Specifically, our experiments show that the foundation models consistently outperform Resnet50 across all tested scenarios, achieving better performance in terms of F1 score, and overall robustness.
Fixing the concept matrix <math alttext="H" class="ltx_Math" display="inline" id="S4.p1.1.m1.1"><semantics id="S4.p1.1.m1.1a"><mi id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><ci id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="S4.p1.1.m1.1d">italic_H</annotation></semantics></math> leads to improved performance in all settings, compared to performing full NMF and classifying the factorized concepts.</p>
</div>
<figure class="ltx_figure" id="S4.F4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Evaluating Segmentation by Factorization on the Breast Cancer Semantic Segmentation Dataset</figcaption><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="263" id="S4.F4.g1" src="extracted/5841227/images/fseg-bcss.png" width="428"/>
</figure>
<figure class="ltx_figure" id="S4.F5">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Evaluating Segmentation by Factorization on the WSSS4LUAD Dataset</figcaption><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="263" id="S4.F5.g1" src="extracted/5841227/images/fseg-luad.png" width="428"/>
</figure>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Discussion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We demonstrated how pre-trained deep learning models can be used for unsupervised semantic segmentation, without being required to further train or fine time them. This method allows leveraging large foundation models developed for pathology, and can be used to segment pathology images without any performing any annotations, or without clear definitions of categories. We show that the unsupervised segmentation correspond with meaningful tissue types on semantic datasets datasets.</p>
</div>
<div class="ltx_para" id="S5.p2">
<span class="ltx_ERROR undefined" id="S5.p2.1">\printbibliography</span>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Examples of F-SEG unsupervised semantic segmentation</h2>
<figure class="ltx_figure" id="A1.F6">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>An example of F-SEG semantic segmentation with the Prov-GigaPath foundation model and k=16 TCGA clusters</figcaption><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="384" id="A1.F6.g1" src="extracted/5841227/images/gigapath_bcss_16.png" width="340"/>
</figure>
<figure class="ltx_figure" id="A1.F7">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>An example of F-SEG semantic segmentation with the Prov-GigaPath foundation model and k=16 TCGA clusters</figcaption><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="262" id="A1.F7.g1" src="extracted/5841227/images/gigapath_bcss_16_2.png" width="407"/>
</figure>
<figure class="ltx_figure" id="A1.F8">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>An example of F-SEG semantic segmentation with the Prov-GigaPath foundation model and k=64 TCGA clusters</figcaption><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="221" id="A1.F8.g1" src="extracted/5841227/images/gigapath_bcss_64.png" width="383"/>
</figure>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Sep  9 15:11:41 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
