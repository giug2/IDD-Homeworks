<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation</title>
<!--Generated on Sun Jun  2 12:15:11 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Offline Reinforcement Learning,  Recommender Systems,  Deep Learning" lang="en" name="keywords"/>
<base href="/html/2406.00725v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S1" title="In Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S2" title="In Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Problem Formulation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S3" title="In Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S4" title="In Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S4.SS1" title="In 4. Methodology ‣ Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Decision Transformer and Overall Model Architecture</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S4.SS2" title="In 4. Methodology ‣ Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Max-Entropy Enhanced Exploration</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S4.SS3" title="In 4. Methodology ‣ Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>RTG Relabeling</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S4.SS4" title="In 4. Methodology ‣ Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Training Procedure</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S5" title="In Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S5.SS1" title="In 5. Experiments ‣ Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Datasets and Environments</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S5.SS2" title="In 5. Experiments ‣ Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S5.SS3" title="In 5. Experiments ‣ Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Overall Comparison (RQ1)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S5.SS4" title="In 5. Experiments ‣ Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Hyperparameter Study (RQ2)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S5.SS5" title="In 5. Experiments ‣ Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.5 </span>Ablation Study (RQ3)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S6" title="In Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xiaocong Chen
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">Data 61, CSIRO</span><span class="ltx_text ltx_affiliation_city" id="id2.2.id2">Eveleigh</span><span class="ltx_text ltx_affiliation_country" id="id3.3.id3">Australia</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:xiaocong.chen@data61.csiro.au">xiaocong.chen@data61.csiro.au</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Siyu Wang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id4.1.id1">The University of New South Wales</span><span class="ltx_text ltx_affiliation_city" id="id5.2.id2">Sydney</span><span class="ltx_text ltx_affiliation_country" id="id6.3.id3">Australia</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:siyu.wang5@unsw.edu.au">siyu.wang5@unsw.edu.au</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Lina Yao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.1.id1">Data 61, CSIRO</span><span class="ltx_text ltx_affiliation_city" id="id8.2.id2">Eveleigh</span><span class="ltx_text ltx_affiliation_country" id="id9.3.id3">Australia</span>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id10.4.id1">The University of New South Wales</span><span class="ltx_text ltx_affiliation_city" id="id11.5.id2">Sydney</span><span class="ltx_text ltx_affiliation_country" id="id12.6.id3">Australia</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:lina.yao@data61.csiro.au">lina.yao@data61.csiro.au</a>
</span></span></span>
</div>
<div class="ltx_dates">(2018)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id13.id1">Reinforcement learning-based recommender systems have recently gained popularity. However, due to the typical limitations of simulation environments (e.g., data inefficiency), most of the work cannot be broadly applied in all domains. To counter these challenges, recent advancements have leveraged offline reinforcement learning methods, notable for their data-driven approach utilizing offline datasets. A prominent example of this is the Decision Transformer. Despite its popularity, the Decision Transformer approach has inherent drawbacks, particularly evident in recommendation methods based on it. This paper identifies two key shortcomings in existing Decision Transformer-based methods: a lack of stitching capability and limited effectiveness in online adoption. In response, we introduce a novel methodology named Max-Entropy enhanced Decision Transformer with Reward Relabeling for Offline RLRS (EDT4Rec). Our approach begins with a max entropy perspective, leading to the development of a max-entropy enhanced exploration strategy. This strategy is designed to facilitate more effective exploration in online environments. Additionally, to augment the model’s capability to stitch sub-optimal trajectories, we incorporate a unique reward relabeling technique. To validate the effectiveness and superiority of EDT4Rec, we have conducted comprehensive experiments across six real-world offline datasets and in an online simulator.</p>
</div>
<div class="ltx_keywords">Offline Reinforcement Learning, Recommender Systems, Deep Learning
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>none</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2018</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>XXXXXXX.XXXXXXX</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>ACM KDD 24; August 25–29,
2024; Barcelona, Spain</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_price" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">price: </span>15.00</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>978-1-4503-XXXX-X/18/06</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Reinforcement Learning (RL)-based Recommender Systems (RS) have emerged as powerful tools in a variety of domains, ranging from e-commerce <cite class="ltx_cite ltx_citemacro_citep">(Hu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib16" title="">2018</a>; Cai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib4" title="">2018</a>)</cite> and advertising <cite class="ltx_cite ltx_citemacro_citep">(Cai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib3" title="">2017</a>)</cite> to streaming services. Their effectiveness is particularly pronounced in dynamic environments, where users’ interests are dynamic <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib10" title="">2023b</a>)</cite>. In RLRS, an agent interacts with users by recommending items and receiving feedback. This feedback, typically in the form of user responses to recommendations, serves as rewards that inform the agent’s decisions. Utilizing this feedback loop, the agent continually refines its policy to better align with user preferences, ultimately aiming to maximize long-term rewards. This goal often translates into enhancing user click with the system. Despite their proven utility, RLRS frequently suffers data inefficiency, a challenge inherent to the interaction-centric nature of RL algorithms. This inefficiency arises as the systems must learn from limited user interactions, making the process of policy improvement slower and less robust.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Recent studies have proposed using offline RL to address the challenges faced by RL-based Recommender Systems (RS) <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib25" title="">2023</a>; Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib27" title="">2023</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib8" title="">2023a</a>)</cite>. Known as data-driven RL, offline RL <cite class="ltx_cite ltx_citemacro_citep">(Levine et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib18" title="">2020</a>)</cite> leverages extensive offline datasets for the preliminary training of agents, allowing for the utilization of pre-existing data to train RLRS agents. A notable implementation is CDT4Rec <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib25" title="">2023</a>)</cite>, which integrates the Decision Transformer(DT) <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib5" title="">2021a</a>)</cite> as its foundational structure, coupled with a causal mechanism for reward estimation. Similarly, DT4Rec, proposed by <cite class="ltx_cite ltx_citemacro_citet">Zhao et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib27" title="">2023</a>)</cite>, utilizes DT to focus on capturing user retention, implementing an efficient reward prompting method for RLRS.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.11">However, directly applying the DT to RS still has several obstacles which require further investigation. The DT requires an offline dataset that contains sufficient <em class="ltx_emph ltx_font_italic" id="S1.p3.11.1">expert</em> trajectories (i.e., those trajectories should be optimal and dense) that can cover almost all of the possibilities that the agent may face when interacting with the real environment. It will lead to two problems when applying the DT algorithm in RS. Firstly, in RS, the offline dataset is highly sparse <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib9" title="">2022</a>)</cite> which may not be able to generate enough expert trajectories. Under such a scenario, the DT needs to have the capability to learn from the sub-optimal trajectories. However, recent literature <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib19" title="">2023</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib30" title="">2022</a>; Yamagata et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib26" title="">2023</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib8" title="">2023a</a>; Nair et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib22" title="">2020</a>)</cite> indicate that the vanilla DT lacks the capability of learning from sub-optimal trajectories (i.e., stitching). To better understand the stitching capability in DT, we have provided an illustration example under recommendation scenario in <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S1.F1" title="In 1. Introduction ‣ Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">1</span></a> to explain. Consider a user has three previous trajectories consisting of item click sequences: <math alttext="(i_{1},i_{2},i_{3},i_{4},i_{8})" class="ltx_Math" display="inline" id="S1.p3.1.m1.5"><semantics id="S1.p3.1.m1.5a"><mrow id="S1.p3.1.m1.5.5.5" xref="S1.p3.1.m1.5.5.6.cmml"><mo id="S1.p3.1.m1.5.5.5.6" stretchy="false" xref="S1.p3.1.m1.5.5.6.cmml">(</mo><msub id="S1.p3.1.m1.1.1.1.1" xref="S1.p3.1.m1.1.1.1.1.cmml"><mi id="S1.p3.1.m1.1.1.1.1.2" xref="S1.p3.1.m1.1.1.1.1.2.cmml">i</mi><mn id="S1.p3.1.m1.1.1.1.1.3" xref="S1.p3.1.m1.1.1.1.1.3.cmml">1</mn></msub><mo id="S1.p3.1.m1.5.5.5.7" xref="S1.p3.1.m1.5.5.6.cmml">,</mo><msub id="S1.p3.1.m1.2.2.2.2" xref="S1.p3.1.m1.2.2.2.2.cmml"><mi id="S1.p3.1.m1.2.2.2.2.2" xref="S1.p3.1.m1.2.2.2.2.2.cmml">i</mi><mn id="S1.p3.1.m1.2.2.2.2.3" xref="S1.p3.1.m1.2.2.2.2.3.cmml">2</mn></msub><mo id="S1.p3.1.m1.5.5.5.8" xref="S1.p3.1.m1.5.5.6.cmml">,</mo><msub id="S1.p3.1.m1.3.3.3.3" xref="S1.p3.1.m1.3.3.3.3.cmml"><mi id="S1.p3.1.m1.3.3.3.3.2" xref="S1.p3.1.m1.3.3.3.3.2.cmml">i</mi><mn id="S1.p3.1.m1.3.3.3.3.3" xref="S1.p3.1.m1.3.3.3.3.3.cmml">3</mn></msub><mo id="S1.p3.1.m1.5.5.5.9" xref="S1.p3.1.m1.5.5.6.cmml">,</mo><msub id="S1.p3.1.m1.4.4.4.4" xref="S1.p3.1.m1.4.4.4.4.cmml"><mi id="S1.p3.1.m1.4.4.4.4.2" xref="S1.p3.1.m1.4.4.4.4.2.cmml">i</mi><mn id="S1.p3.1.m1.4.4.4.4.3" xref="S1.p3.1.m1.4.4.4.4.3.cmml">4</mn></msub><mo id="S1.p3.1.m1.5.5.5.10" xref="S1.p3.1.m1.5.5.6.cmml">,</mo><msub id="S1.p3.1.m1.5.5.5.5" xref="S1.p3.1.m1.5.5.5.5.cmml"><mi id="S1.p3.1.m1.5.5.5.5.2" xref="S1.p3.1.m1.5.5.5.5.2.cmml">i</mi><mn id="S1.p3.1.m1.5.5.5.5.3" xref="S1.p3.1.m1.5.5.5.5.3.cmml">8</mn></msub><mo id="S1.p3.1.m1.5.5.5.11" stretchy="false" xref="S1.p3.1.m1.5.5.6.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.5b"><vector id="S1.p3.1.m1.5.5.6.cmml" xref="S1.p3.1.m1.5.5.5"><apply id="S1.p3.1.m1.1.1.1.1.cmml" xref="S1.p3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S1.p3.1.m1.1.1.1.1.1.cmml" xref="S1.p3.1.m1.1.1.1.1">subscript</csymbol><ci id="S1.p3.1.m1.1.1.1.1.2.cmml" xref="S1.p3.1.m1.1.1.1.1.2">𝑖</ci><cn id="S1.p3.1.m1.1.1.1.1.3.cmml" type="integer" xref="S1.p3.1.m1.1.1.1.1.3">1</cn></apply><apply id="S1.p3.1.m1.2.2.2.2.cmml" xref="S1.p3.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S1.p3.1.m1.2.2.2.2.1.cmml" xref="S1.p3.1.m1.2.2.2.2">subscript</csymbol><ci id="S1.p3.1.m1.2.2.2.2.2.cmml" xref="S1.p3.1.m1.2.2.2.2.2">𝑖</ci><cn id="S1.p3.1.m1.2.2.2.2.3.cmml" type="integer" xref="S1.p3.1.m1.2.2.2.2.3">2</cn></apply><apply id="S1.p3.1.m1.3.3.3.3.cmml" xref="S1.p3.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S1.p3.1.m1.3.3.3.3.1.cmml" xref="S1.p3.1.m1.3.3.3.3">subscript</csymbol><ci id="S1.p3.1.m1.3.3.3.3.2.cmml" xref="S1.p3.1.m1.3.3.3.3.2">𝑖</ci><cn id="S1.p3.1.m1.3.3.3.3.3.cmml" type="integer" xref="S1.p3.1.m1.3.3.3.3.3">3</cn></apply><apply id="S1.p3.1.m1.4.4.4.4.cmml" xref="S1.p3.1.m1.4.4.4.4"><csymbol cd="ambiguous" id="S1.p3.1.m1.4.4.4.4.1.cmml" xref="S1.p3.1.m1.4.4.4.4">subscript</csymbol><ci id="S1.p3.1.m1.4.4.4.4.2.cmml" xref="S1.p3.1.m1.4.4.4.4.2">𝑖</ci><cn id="S1.p3.1.m1.4.4.4.4.3.cmml" type="integer" xref="S1.p3.1.m1.4.4.4.4.3">4</cn></apply><apply id="S1.p3.1.m1.5.5.5.5.cmml" xref="S1.p3.1.m1.5.5.5.5"><csymbol cd="ambiguous" id="S1.p3.1.m1.5.5.5.5.1.cmml" xref="S1.p3.1.m1.5.5.5.5">subscript</csymbol><ci id="S1.p3.1.m1.5.5.5.5.2.cmml" xref="S1.p3.1.m1.5.5.5.5.2">𝑖</ci><cn id="S1.p3.1.m1.5.5.5.5.3.cmml" type="integer" xref="S1.p3.1.m1.5.5.5.5.3">8</cn></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.5c">(i_{1},i_{2},i_{3},i_{4},i_{8})</annotation><annotation encoding="application/x-llamapun" id="S1.p3.1.m1.5d">( italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 8 end_POSTSUBSCRIPT )</annotation></semantics></math>, <math alttext="(i_{1},i_{2},i_{6},i_{7})" class="ltx_Math" display="inline" id="S1.p3.2.m2.4"><semantics id="S1.p3.2.m2.4a"><mrow id="S1.p3.2.m2.4.4.4" xref="S1.p3.2.m2.4.4.5.cmml"><mo id="S1.p3.2.m2.4.4.4.5" stretchy="false" xref="S1.p3.2.m2.4.4.5.cmml">(</mo><msub id="S1.p3.2.m2.1.1.1.1" xref="S1.p3.2.m2.1.1.1.1.cmml"><mi id="S1.p3.2.m2.1.1.1.1.2" xref="S1.p3.2.m2.1.1.1.1.2.cmml">i</mi><mn id="S1.p3.2.m2.1.1.1.1.3" xref="S1.p3.2.m2.1.1.1.1.3.cmml">1</mn></msub><mo id="S1.p3.2.m2.4.4.4.6" xref="S1.p3.2.m2.4.4.5.cmml">,</mo><msub id="S1.p3.2.m2.2.2.2.2" xref="S1.p3.2.m2.2.2.2.2.cmml"><mi id="S1.p3.2.m2.2.2.2.2.2" xref="S1.p3.2.m2.2.2.2.2.2.cmml">i</mi><mn id="S1.p3.2.m2.2.2.2.2.3" xref="S1.p3.2.m2.2.2.2.2.3.cmml">2</mn></msub><mo id="S1.p3.2.m2.4.4.4.7" xref="S1.p3.2.m2.4.4.5.cmml">,</mo><msub id="S1.p3.2.m2.3.3.3.3" xref="S1.p3.2.m2.3.3.3.3.cmml"><mi id="S1.p3.2.m2.3.3.3.3.2" xref="S1.p3.2.m2.3.3.3.3.2.cmml">i</mi><mn id="S1.p3.2.m2.3.3.3.3.3" xref="S1.p3.2.m2.3.3.3.3.3.cmml">6</mn></msub><mo id="S1.p3.2.m2.4.4.4.8" xref="S1.p3.2.m2.4.4.5.cmml">,</mo><msub id="S1.p3.2.m2.4.4.4.4" xref="S1.p3.2.m2.4.4.4.4.cmml"><mi id="S1.p3.2.m2.4.4.4.4.2" xref="S1.p3.2.m2.4.4.4.4.2.cmml">i</mi><mn id="S1.p3.2.m2.4.4.4.4.3" xref="S1.p3.2.m2.4.4.4.4.3.cmml">7</mn></msub><mo id="S1.p3.2.m2.4.4.4.9" stretchy="false" xref="S1.p3.2.m2.4.4.5.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.2.m2.4b"><vector id="S1.p3.2.m2.4.4.5.cmml" xref="S1.p3.2.m2.4.4.4"><apply id="S1.p3.2.m2.1.1.1.1.cmml" xref="S1.p3.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S1.p3.2.m2.1.1.1.1.1.cmml" xref="S1.p3.2.m2.1.1.1.1">subscript</csymbol><ci id="S1.p3.2.m2.1.1.1.1.2.cmml" xref="S1.p3.2.m2.1.1.1.1.2">𝑖</ci><cn id="S1.p3.2.m2.1.1.1.1.3.cmml" type="integer" xref="S1.p3.2.m2.1.1.1.1.3">1</cn></apply><apply id="S1.p3.2.m2.2.2.2.2.cmml" xref="S1.p3.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S1.p3.2.m2.2.2.2.2.1.cmml" xref="S1.p3.2.m2.2.2.2.2">subscript</csymbol><ci id="S1.p3.2.m2.2.2.2.2.2.cmml" xref="S1.p3.2.m2.2.2.2.2.2">𝑖</ci><cn id="S1.p3.2.m2.2.2.2.2.3.cmml" type="integer" xref="S1.p3.2.m2.2.2.2.2.3">2</cn></apply><apply id="S1.p3.2.m2.3.3.3.3.cmml" xref="S1.p3.2.m2.3.3.3.3"><csymbol cd="ambiguous" id="S1.p3.2.m2.3.3.3.3.1.cmml" xref="S1.p3.2.m2.3.3.3.3">subscript</csymbol><ci id="S1.p3.2.m2.3.3.3.3.2.cmml" xref="S1.p3.2.m2.3.3.3.3.2">𝑖</ci><cn id="S1.p3.2.m2.3.3.3.3.3.cmml" type="integer" xref="S1.p3.2.m2.3.3.3.3.3">6</cn></apply><apply id="S1.p3.2.m2.4.4.4.4.cmml" xref="S1.p3.2.m2.4.4.4.4"><csymbol cd="ambiguous" id="S1.p3.2.m2.4.4.4.4.1.cmml" xref="S1.p3.2.m2.4.4.4.4">subscript</csymbol><ci id="S1.p3.2.m2.4.4.4.4.2.cmml" xref="S1.p3.2.m2.4.4.4.4.2">𝑖</ci><cn id="S1.p3.2.m2.4.4.4.4.3.cmml" type="integer" xref="S1.p3.2.m2.4.4.4.4.3">7</cn></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.2.m2.4c">(i_{1},i_{2},i_{6},i_{7})</annotation><annotation encoding="application/x-llamapun" id="S1.p3.2.m2.4d">( italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 6 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 7 end_POSTSUBSCRIPT )</annotation></semantics></math>, and <math alttext="(i_{1},i_{2},i_{3},i_{5})" class="ltx_Math" display="inline" id="S1.p3.3.m3.4"><semantics id="S1.p3.3.m3.4a"><mrow id="S1.p3.3.m3.4.4.4" xref="S1.p3.3.m3.4.4.5.cmml"><mo id="S1.p3.3.m3.4.4.4.5" stretchy="false" xref="S1.p3.3.m3.4.4.5.cmml">(</mo><msub id="S1.p3.3.m3.1.1.1.1" xref="S1.p3.3.m3.1.1.1.1.cmml"><mi id="S1.p3.3.m3.1.1.1.1.2" xref="S1.p3.3.m3.1.1.1.1.2.cmml">i</mi><mn id="S1.p3.3.m3.1.1.1.1.3" xref="S1.p3.3.m3.1.1.1.1.3.cmml">1</mn></msub><mo id="S1.p3.3.m3.4.4.4.6" xref="S1.p3.3.m3.4.4.5.cmml">,</mo><msub id="S1.p3.3.m3.2.2.2.2" xref="S1.p3.3.m3.2.2.2.2.cmml"><mi id="S1.p3.3.m3.2.2.2.2.2" xref="S1.p3.3.m3.2.2.2.2.2.cmml">i</mi><mn id="S1.p3.3.m3.2.2.2.2.3" xref="S1.p3.3.m3.2.2.2.2.3.cmml">2</mn></msub><mo id="S1.p3.3.m3.4.4.4.7" xref="S1.p3.3.m3.4.4.5.cmml">,</mo><msub id="S1.p3.3.m3.3.3.3.3" xref="S1.p3.3.m3.3.3.3.3.cmml"><mi id="S1.p3.3.m3.3.3.3.3.2" xref="S1.p3.3.m3.3.3.3.3.2.cmml">i</mi><mn id="S1.p3.3.m3.3.3.3.3.3" xref="S1.p3.3.m3.3.3.3.3.3.cmml">3</mn></msub><mo id="S1.p3.3.m3.4.4.4.8" xref="S1.p3.3.m3.4.4.5.cmml">,</mo><msub id="S1.p3.3.m3.4.4.4.4" xref="S1.p3.3.m3.4.4.4.4.cmml"><mi id="S1.p3.3.m3.4.4.4.4.2" xref="S1.p3.3.m3.4.4.4.4.2.cmml">i</mi><mn id="S1.p3.3.m3.4.4.4.4.3" xref="S1.p3.3.m3.4.4.4.4.3.cmml">5</mn></msub><mo id="S1.p3.3.m3.4.4.4.9" stretchy="false" xref="S1.p3.3.m3.4.4.5.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.3.m3.4b"><vector id="S1.p3.3.m3.4.4.5.cmml" xref="S1.p3.3.m3.4.4.4"><apply id="S1.p3.3.m3.1.1.1.1.cmml" xref="S1.p3.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S1.p3.3.m3.1.1.1.1.1.cmml" xref="S1.p3.3.m3.1.1.1.1">subscript</csymbol><ci id="S1.p3.3.m3.1.1.1.1.2.cmml" xref="S1.p3.3.m3.1.1.1.1.2">𝑖</ci><cn id="S1.p3.3.m3.1.1.1.1.3.cmml" type="integer" xref="S1.p3.3.m3.1.1.1.1.3">1</cn></apply><apply id="S1.p3.3.m3.2.2.2.2.cmml" xref="S1.p3.3.m3.2.2.2.2"><csymbol cd="ambiguous" id="S1.p3.3.m3.2.2.2.2.1.cmml" xref="S1.p3.3.m3.2.2.2.2">subscript</csymbol><ci id="S1.p3.3.m3.2.2.2.2.2.cmml" xref="S1.p3.3.m3.2.2.2.2.2">𝑖</ci><cn id="S1.p3.3.m3.2.2.2.2.3.cmml" type="integer" xref="S1.p3.3.m3.2.2.2.2.3">2</cn></apply><apply id="S1.p3.3.m3.3.3.3.3.cmml" xref="S1.p3.3.m3.3.3.3.3"><csymbol cd="ambiguous" id="S1.p3.3.m3.3.3.3.3.1.cmml" xref="S1.p3.3.m3.3.3.3.3">subscript</csymbol><ci id="S1.p3.3.m3.3.3.3.3.2.cmml" xref="S1.p3.3.m3.3.3.3.3.2">𝑖</ci><cn id="S1.p3.3.m3.3.3.3.3.3.cmml" type="integer" xref="S1.p3.3.m3.3.3.3.3.3">3</cn></apply><apply id="S1.p3.3.m3.4.4.4.4.cmml" xref="S1.p3.3.m3.4.4.4.4"><csymbol cd="ambiguous" id="S1.p3.3.m3.4.4.4.4.1.cmml" xref="S1.p3.3.m3.4.4.4.4">subscript</csymbol><ci id="S1.p3.3.m3.4.4.4.4.2.cmml" xref="S1.p3.3.m3.4.4.4.4.2">𝑖</ci><cn id="S1.p3.3.m3.4.4.4.4.3.cmml" type="integer" xref="S1.p3.3.m3.4.4.4.4.3">5</cn></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.3.m3.4c">(i_{1},i_{2},i_{3},i_{5})</annotation><annotation encoding="application/x-llamapun" id="S1.p3.3.m3.4d">( italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 5 end_POSTSUBSCRIPT )</annotation></semantics></math>. In this illustration, each node represents an item. Notably, the trajectory <math alttext="(i_{1},i_{2},i_{3},i_{4},i_{8})" class="ltx_Math" display="inline" id="S1.p3.4.m4.5"><semantics id="S1.p3.4.m4.5a"><mrow id="S1.p3.4.m4.5.5.5" xref="S1.p3.4.m4.5.5.6.cmml"><mo id="S1.p3.4.m4.5.5.5.6" stretchy="false" xref="S1.p3.4.m4.5.5.6.cmml">(</mo><msub id="S1.p3.4.m4.1.1.1.1" xref="S1.p3.4.m4.1.1.1.1.cmml"><mi id="S1.p3.4.m4.1.1.1.1.2" xref="S1.p3.4.m4.1.1.1.1.2.cmml">i</mi><mn id="S1.p3.4.m4.1.1.1.1.3" xref="S1.p3.4.m4.1.1.1.1.3.cmml">1</mn></msub><mo id="S1.p3.4.m4.5.5.5.7" xref="S1.p3.4.m4.5.5.6.cmml">,</mo><msub id="S1.p3.4.m4.2.2.2.2" xref="S1.p3.4.m4.2.2.2.2.cmml"><mi id="S1.p3.4.m4.2.2.2.2.2" xref="S1.p3.4.m4.2.2.2.2.2.cmml">i</mi><mn id="S1.p3.4.m4.2.2.2.2.3" xref="S1.p3.4.m4.2.2.2.2.3.cmml">2</mn></msub><mo id="S1.p3.4.m4.5.5.5.8" xref="S1.p3.4.m4.5.5.6.cmml">,</mo><msub id="S1.p3.4.m4.3.3.3.3" xref="S1.p3.4.m4.3.3.3.3.cmml"><mi id="S1.p3.4.m4.3.3.3.3.2" xref="S1.p3.4.m4.3.3.3.3.2.cmml">i</mi><mn id="S1.p3.4.m4.3.3.3.3.3" xref="S1.p3.4.m4.3.3.3.3.3.cmml">3</mn></msub><mo id="S1.p3.4.m4.5.5.5.9" xref="S1.p3.4.m4.5.5.6.cmml">,</mo><msub id="S1.p3.4.m4.4.4.4.4" xref="S1.p3.4.m4.4.4.4.4.cmml"><mi id="S1.p3.4.m4.4.4.4.4.2" xref="S1.p3.4.m4.4.4.4.4.2.cmml">i</mi><mn id="S1.p3.4.m4.4.4.4.4.3" xref="S1.p3.4.m4.4.4.4.4.3.cmml">4</mn></msub><mo id="S1.p3.4.m4.5.5.5.10" xref="S1.p3.4.m4.5.5.6.cmml">,</mo><msub id="S1.p3.4.m4.5.5.5.5" xref="S1.p3.4.m4.5.5.5.5.cmml"><mi id="S1.p3.4.m4.5.5.5.5.2" xref="S1.p3.4.m4.5.5.5.5.2.cmml">i</mi><mn id="S1.p3.4.m4.5.5.5.5.3" xref="S1.p3.4.m4.5.5.5.5.3.cmml">8</mn></msub><mo id="S1.p3.4.m4.5.5.5.11" stretchy="false" xref="S1.p3.4.m4.5.5.6.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.4.m4.5b"><vector id="S1.p3.4.m4.5.5.6.cmml" xref="S1.p3.4.m4.5.5.5"><apply id="S1.p3.4.m4.1.1.1.1.cmml" xref="S1.p3.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S1.p3.4.m4.1.1.1.1.1.cmml" xref="S1.p3.4.m4.1.1.1.1">subscript</csymbol><ci id="S1.p3.4.m4.1.1.1.1.2.cmml" xref="S1.p3.4.m4.1.1.1.1.2">𝑖</ci><cn id="S1.p3.4.m4.1.1.1.1.3.cmml" type="integer" xref="S1.p3.4.m4.1.1.1.1.3">1</cn></apply><apply id="S1.p3.4.m4.2.2.2.2.cmml" xref="S1.p3.4.m4.2.2.2.2"><csymbol cd="ambiguous" id="S1.p3.4.m4.2.2.2.2.1.cmml" xref="S1.p3.4.m4.2.2.2.2">subscript</csymbol><ci id="S1.p3.4.m4.2.2.2.2.2.cmml" xref="S1.p3.4.m4.2.2.2.2.2">𝑖</ci><cn id="S1.p3.4.m4.2.2.2.2.3.cmml" type="integer" xref="S1.p3.4.m4.2.2.2.2.3">2</cn></apply><apply id="S1.p3.4.m4.3.3.3.3.cmml" xref="S1.p3.4.m4.3.3.3.3"><csymbol cd="ambiguous" id="S1.p3.4.m4.3.3.3.3.1.cmml" xref="S1.p3.4.m4.3.3.3.3">subscript</csymbol><ci id="S1.p3.4.m4.3.3.3.3.2.cmml" xref="S1.p3.4.m4.3.3.3.3.2">𝑖</ci><cn id="S1.p3.4.m4.3.3.3.3.3.cmml" type="integer" xref="S1.p3.4.m4.3.3.3.3.3">3</cn></apply><apply id="S1.p3.4.m4.4.4.4.4.cmml" xref="S1.p3.4.m4.4.4.4.4"><csymbol cd="ambiguous" id="S1.p3.4.m4.4.4.4.4.1.cmml" xref="S1.p3.4.m4.4.4.4.4">subscript</csymbol><ci id="S1.p3.4.m4.4.4.4.4.2.cmml" xref="S1.p3.4.m4.4.4.4.4.2">𝑖</ci><cn id="S1.p3.4.m4.4.4.4.4.3.cmml" type="integer" xref="S1.p3.4.m4.4.4.4.4.3">4</cn></apply><apply id="S1.p3.4.m4.5.5.5.5.cmml" xref="S1.p3.4.m4.5.5.5.5"><csymbol cd="ambiguous" id="S1.p3.4.m4.5.5.5.5.1.cmml" xref="S1.p3.4.m4.5.5.5.5">subscript</csymbol><ci id="S1.p3.4.m4.5.5.5.5.2.cmml" xref="S1.p3.4.m4.5.5.5.5.2">𝑖</ci><cn id="S1.p3.4.m4.5.5.5.5.3.cmml" type="integer" xref="S1.p3.4.m4.5.5.5.5.3">8</cn></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.4.m4.5c">(i_{1},i_{2},i_{3},i_{4},i_{8})</annotation><annotation encoding="application/x-llamapun" id="S1.p3.4.m4.5d">( italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 8 end_POSTSUBSCRIPT )</annotation></semantics></math> receives a reward of 0 (i.e., the user does not click it), whereas a similar trajectory <math alttext="(i_{1},i_{2},i_{6},i_{7})" class="ltx_Math" display="inline" id="S1.p3.5.m5.4"><semantics id="S1.p3.5.m5.4a"><mrow id="S1.p3.5.m5.4.4.4" xref="S1.p3.5.m5.4.4.5.cmml"><mo id="S1.p3.5.m5.4.4.4.5" stretchy="false" xref="S1.p3.5.m5.4.4.5.cmml">(</mo><msub id="S1.p3.5.m5.1.1.1.1" xref="S1.p3.5.m5.1.1.1.1.cmml"><mi id="S1.p3.5.m5.1.1.1.1.2" xref="S1.p3.5.m5.1.1.1.1.2.cmml">i</mi><mn id="S1.p3.5.m5.1.1.1.1.3" xref="S1.p3.5.m5.1.1.1.1.3.cmml">1</mn></msub><mo id="S1.p3.5.m5.4.4.4.6" xref="S1.p3.5.m5.4.4.5.cmml">,</mo><msub id="S1.p3.5.m5.2.2.2.2" xref="S1.p3.5.m5.2.2.2.2.cmml"><mi id="S1.p3.5.m5.2.2.2.2.2" xref="S1.p3.5.m5.2.2.2.2.2.cmml">i</mi><mn id="S1.p3.5.m5.2.2.2.2.3" xref="S1.p3.5.m5.2.2.2.2.3.cmml">2</mn></msub><mo id="S1.p3.5.m5.4.4.4.7" xref="S1.p3.5.m5.4.4.5.cmml">,</mo><msub id="S1.p3.5.m5.3.3.3.3" xref="S1.p3.5.m5.3.3.3.3.cmml"><mi id="S1.p3.5.m5.3.3.3.3.2" xref="S1.p3.5.m5.3.3.3.3.2.cmml">i</mi><mn id="S1.p3.5.m5.3.3.3.3.3" xref="S1.p3.5.m5.3.3.3.3.3.cmml">6</mn></msub><mo id="S1.p3.5.m5.4.4.4.8" xref="S1.p3.5.m5.4.4.5.cmml">,</mo><msub id="S1.p3.5.m5.4.4.4.4" xref="S1.p3.5.m5.4.4.4.4.cmml"><mi id="S1.p3.5.m5.4.4.4.4.2" xref="S1.p3.5.m5.4.4.4.4.2.cmml">i</mi><mn id="S1.p3.5.m5.4.4.4.4.3" xref="S1.p3.5.m5.4.4.4.4.3.cmml">7</mn></msub><mo id="S1.p3.5.m5.4.4.4.9" stretchy="false" xref="S1.p3.5.m5.4.4.5.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.5.m5.4b"><vector id="S1.p3.5.m5.4.4.5.cmml" xref="S1.p3.5.m5.4.4.4"><apply id="S1.p3.5.m5.1.1.1.1.cmml" xref="S1.p3.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S1.p3.5.m5.1.1.1.1.1.cmml" xref="S1.p3.5.m5.1.1.1.1">subscript</csymbol><ci id="S1.p3.5.m5.1.1.1.1.2.cmml" xref="S1.p3.5.m5.1.1.1.1.2">𝑖</ci><cn id="S1.p3.5.m5.1.1.1.1.3.cmml" type="integer" xref="S1.p3.5.m5.1.1.1.1.3">1</cn></apply><apply id="S1.p3.5.m5.2.2.2.2.cmml" xref="S1.p3.5.m5.2.2.2.2"><csymbol cd="ambiguous" id="S1.p3.5.m5.2.2.2.2.1.cmml" xref="S1.p3.5.m5.2.2.2.2">subscript</csymbol><ci id="S1.p3.5.m5.2.2.2.2.2.cmml" xref="S1.p3.5.m5.2.2.2.2.2">𝑖</ci><cn id="S1.p3.5.m5.2.2.2.2.3.cmml" type="integer" xref="S1.p3.5.m5.2.2.2.2.3">2</cn></apply><apply id="S1.p3.5.m5.3.3.3.3.cmml" xref="S1.p3.5.m5.3.3.3.3"><csymbol cd="ambiguous" id="S1.p3.5.m5.3.3.3.3.1.cmml" xref="S1.p3.5.m5.3.3.3.3">subscript</csymbol><ci id="S1.p3.5.m5.3.3.3.3.2.cmml" xref="S1.p3.5.m5.3.3.3.3.2">𝑖</ci><cn id="S1.p3.5.m5.3.3.3.3.3.cmml" type="integer" xref="S1.p3.5.m5.3.3.3.3.3">6</cn></apply><apply id="S1.p3.5.m5.4.4.4.4.cmml" xref="S1.p3.5.m5.4.4.4.4"><csymbol cd="ambiguous" id="S1.p3.5.m5.4.4.4.4.1.cmml" xref="S1.p3.5.m5.4.4.4.4">subscript</csymbol><ci id="S1.p3.5.m5.4.4.4.4.2.cmml" xref="S1.p3.5.m5.4.4.4.4.2">𝑖</ci><cn id="S1.p3.5.m5.4.4.4.4.3.cmml" type="integer" xref="S1.p3.5.m5.4.4.4.4.3">7</cn></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.5.m5.4c">(i_{1},i_{2},i_{6},i_{7})</annotation><annotation encoding="application/x-llamapun" id="S1.p3.5.m5.4d">( italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 6 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 7 end_POSTSUBSCRIPT )</annotation></semantics></math> yields a positive reward. We categorize the 0 reward scenario as sub-optimal. Upon closer examination, we observe a linkage between items <math alttext="i_{4}" class="ltx_Math" display="inline" id="S1.p3.6.m6.1"><semantics id="S1.p3.6.m6.1a"><msub id="S1.p3.6.m6.1.1" xref="S1.p3.6.m6.1.1.cmml"><mi id="S1.p3.6.m6.1.1.2" xref="S1.p3.6.m6.1.1.2.cmml">i</mi><mn id="S1.p3.6.m6.1.1.3" xref="S1.p3.6.m6.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p3.6.m6.1b"><apply id="S1.p3.6.m6.1.1.cmml" xref="S1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S1.p3.6.m6.1.1.1.cmml" xref="S1.p3.6.m6.1.1">subscript</csymbol><ci id="S1.p3.6.m6.1.1.2.cmml" xref="S1.p3.6.m6.1.1.2">𝑖</ci><cn id="S1.p3.6.m6.1.1.3.cmml" type="integer" xref="S1.p3.6.m6.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.6.m6.1c">i_{4}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.6.m6.1d">italic_i start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="i_{7}" class="ltx_Math" display="inline" id="S1.p3.7.m7.1"><semantics id="S1.p3.7.m7.1a"><msub id="S1.p3.7.m7.1.1" xref="S1.p3.7.m7.1.1.cmml"><mi id="S1.p3.7.m7.1.1.2" xref="S1.p3.7.m7.1.1.2.cmml">i</mi><mn id="S1.p3.7.m7.1.1.3" xref="S1.p3.7.m7.1.1.3.cmml">7</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p3.7.m7.1b"><apply id="S1.p3.7.m7.1.1.cmml" xref="S1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S1.p3.7.m7.1.1.1.cmml" xref="S1.p3.7.m7.1.1">subscript</csymbol><ci id="S1.p3.7.m7.1.1.2.cmml" xref="S1.p3.7.m7.1.1.2">𝑖</ci><cn id="S1.p3.7.m7.1.1.3.cmml" type="integer" xref="S1.p3.7.m7.1.1.3">7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.7.m7.1c">i_{7}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.7.m7.1d">italic_i start_POSTSUBSCRIPT 7 end_POSTSUBSCRIPT</annotation></semantics></math>, suggesting the potential to create a more rewarding trajectory by combining elements from <math alttext="(i_{1},i_{2},i_{3},i_{4},i_{8})" class="ltx_Math" display="inline" id="S1.p3.8.m8.5"><semantics id="S1.p3.8.m8.5a"><mrow id="S1.p3.8.m8.5.5.5" xref="S1.p3.8.m8.5.5.6.cmml"><mo id="S1.p3.8.m8.5.5.5.6" stretchy="false" xref="S1.p3.8.m8.5.5.6.cmml">(</mo><msub id="S1.p3.8.m8.1.1.1.1" xref="S1.p3.8.m8.1.1.1.1.cmml"><mi id="S1.p3.8.m8.1.1.1.1.2" xref="S1.p3.8.m8.1.1.1.1.2.cmml">i</mi><mn id="S1.p3.8.m8.1.1.1.1.3" xref="S1.p3.8.m8.1.1.1.1.3.cmml">1</mn></msub><mo id="S1.p3.8.m8.5.5.5.7" xref="S1.p3.8.m8.5.5.6.cmml">,</mo><msub id="S1.p3.8.m8.2.2.2.2" xref="S1.p3.8.m8.2.2.2.2.cmml"><mi id="S1.p3.8.m8.2.2.2.2.2" xref="S1.p3.8.m8.2.2.2.2.2.cmml">i</mi><mn id="S1.p3.8.m8.2.2.2.2.3" xref="S1.p3.8.m8.2.2.2.2.3.cmml">2</mn></msub><mo id="S1.p3.8.m8.5.5.5.8" xref="S1.p3.8.m8.5.5.6.cmml">,</mo><msub id="S1.p3.8.m8.3.3.3.3" xref="S1.p3.8.m8.3.3.3.3.cmml"><mi id="S1.p3.8.m8.3.3.3.3.2" xref="S1.p3.8.m8.3.3.3.3.2.cmml">i</mi><mn id="S1.p3.8.m8.3.3.3.3.3" xref="S1.p3.8.m8.3.3.3.3.3.cmml">3</mn></msub><mo id="S1.p3.8.m8.5.5.5.9" xref="S1.p3.8.m8.5.5.6.cmml">,</mo><msub id="S1.p3.8.m8.4.4.4.4" xref="S1.p3.8.m8.4.4.4.4.cmml"><mi id="S1.p3.8.m8.4.4.4.4.2" xref="S1.p3.8.m8.4.4.4.4.2.cmml">i</mi><mn id="S1.p3.8.m8.4.4.4.4.3" xref="S1.p3.8.m8.4.4.4.4.3.cmml">4</mn></msub><mo id="S1.p3.8.m8.5.5.5.10" xref="S1.p3.8.m8.5.5.6.cmml">,</mo><msub id="S1.p3.8.m8.5.5.5.5" xref="S1.p3.8.m8.5.5.5.5.cmml"><mi id="S1.p3.8.m8.5.5.5.5.2" xref="S1.p3.8.m8.5.5.5.5.2.cmml">i</mi><mn id="S1.p3.8.m8.5.5.5.5.3" xref="S1.p3.8.m8.5.5.5.5.3.cmml">8</mn></msub><mo id="S1.p3.8.m8.5.5.5.11" stretchy="false" xref="S1.p3.8.m8.5.5.6.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.8.m8.5b"><vector id="S1.p3.8.m8.5.5.6.cmml" xref="S1.p3.8.m8.5.5.5"><apply id="S1.p3.8.m8.1.1.1.1.cmml" xref="S1.p3.8.m8.1.1.1.1"><csymbol cd="ambiguous" id="S1.p3.8.m8.1.1.1.1.1.cmml" xref="S1.p3.8.m8.1.1.1.1">subscript</csymbol><ci id="S1.p3.8.m8.1.1.1.1.2.cmml" xref="S1.p3.8.m8.1.1.1.1.2">𝑖</ci><cn id="S1.p3.8.m8.1.1.1.1.3.cmml" type="integer" xref="S1.p3.8.m8.1.1.1.1.3">1</cn></apply><apply id="S1.p3.8.m8.2.2.2.2.cmml" xref="S1.p3.8.m8.2.2.2.2"><csymbol cd="ambiguous" id="S1.p3.8.m8.2.2.2.2.1.cmml" xref="S1.p3.8.m8.2.2.2.2">subscript</csymbol><ci id="S1.p3.8.m8.2.2.2.2.2.cmml" xref="S1.p3.8.m8.2.2.2.2.2">𝑖</ci><cn id="S1.p3.8.m8.2.2.2.2.3.cmml" type="integer" xref="S1.p3.8.m8.2.2.2.2.3">2</cn></apply><apply id="S1.p3.8.m8.3.3.3.3.cmml" xref="S1.p3.8.m8.3.3.3.3"><csymbol cd="ambiguous" id="S1.p3.8.m8.3.3.3.3.1.cmml" xref="S1.p3.8.m8.3.3.3.3">subscript</csymbol><ci id="S1.p3.8.m8.3.3.3.3.2.cmml" xref="S1.p3.8.m8.3.3.3.3.2">𝑖</ci><cn id="S1.p3.8.m8.3.3.3.3.3.cmml" type="integer" xref="S1.p3.8.m8.3.3.3.3.3">3</cn></apply><apply id="S1.p3.8.m8.4.4.4.4.cmml" xref="S1.p3.8.m8.4.4.4.4"><csymbol cd="ambiguous" id="S1.p3.8.m8.4.4.4.4.1.cmml" xref="S1.p3.8.m8.4.4.4.4">subscript</csymbol><ci id="S1.p3.8.m8.4.4.4.4.2.cmml" xref="S1.p3.8.m8.4.4.4.4.2">𝑖</ci><cn id="S1.p3.8.m8.4.4.4.4.3.cmml" type="integer" xref="S1.p3.8.m8.4.4.4.4.3">4</cn></apply><apply id="S1.p3.8.m8.5.5.5.5.cmml" xref="S1.p3.8.m8.5.5.5.5"><csymbol cd="ambiguous" id="S1.p3.8.m8.5.5.5.5.1.cmml" xref="S1.p3.8.m8.5.5.5.5">subscript</csymbol><ci id="S1.p3.8.m8.5.5.5.5.2.cmml" xref="S1.p3.8.m8.5.5.5.5.2">𝑖</ci><cn id="S1.p3.8.m8.5.5.5.5.3.cmml" type="integer" xref="S1.p3.8.m8.5.5.5.5.3">8</cn></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.8.m8.5c">(i_{1},i_{2},i_{3},i_{4},i_{8})</annotation><annotation encoding="application/x-llamapun" id="S1.p3.8.m8.5d">( italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 8 end_POSTSUBSCRIPT )</annotation></semantics></math> and <math alttext="(i_{1},i_{2},i_{6},i_{7})" class="ltx_Math" display="inline" id="S1.p3.9.m9.4"><semantics id="S1.p3.9.m9.4a"><mrow id="S1.p3.9.m9.4.4.4" xref="S1.p3.9.m9.4.4.5.cmml"><mo id="S1.p3.9.m9.4.4.4.5" stretchy="false" xref="S1.p3.9.m9.4.4.5.cmml">(</mo><msub id="S1.p3.9.m9.1.1.1.1" xref="S1.p3.9.m9.1.1.1.1.cmml"><mi id="S1.p3.9.m9.1.1.1.1.2" xref="S1.p3.9.m9.1.1.1.1.2.cmml">i</mi><mn id="S1.p3.9.m9.1.1.1.1.3" xref="S1.p3.9.m9.1.1.1.1.3.cmml">1</mn></msub><mo id="S1.p3.9.m9.4.4.4.6" xref="S1.p3.9.m9.4.4.5.cmml">,</mo><msub id="S1.p3.9.m9.2.2.2.2" xref="S1.p3.9.m9.2.2.2.2.cmml"><mi id="S1.p3.9.m9.2.2.2.2.2" xref="S1.p3.9.m9.2.2.2.2.2.cmml">i</mi><mn id="S1.p3.9.m9.2.2.2.2.3" xref="S1.p3.9.m9.2.2.2.2.3.cmml">2</mn></msub><mo id="S1.p3.9.m9.4.4.4.7" xref="S1.p3.9.m9.4.4.5.cmml">,</mo><msub id="S1.p3.9.m9.3.3.3.3" xref="S1.p3.9.m9.3.3.3.3.cmml"><mi id="S1.p3.9.m9.3.3.3.3.2" xref="S1.p3.9.m9.3.3.3.3.2.cmml">i</mi><mn id="S1.p3.9.m9.3.3.3.3.3" xref="S1.p3.9.m9.3.3.3.3.3.cmml">6</mn></msub><mo id="S1.p3.9.m9.4.4.4.8" xref="S1.p3.9.m9.4.4.5.cmml">,</mo><msub id="S1.p3.9.m9.4.4.4.4" xref="S1.p3.9.m9.4.4.4.4.cmml"><mi id="S1.p3.9.m9.4.4.4.4.2" xref="S1.p3.9.m9.4.4.4.4.2.cmml">i</mi><mn id="S1.p3.9.m9.4.4.4.4.3" xref="S1.p3.9.m9.4.4.4.4.3.cmml">7</mn></msub><mo id="S1.p3.9.m9.4.4.4.9" stretchy="false" xref="S1.p3.9.m9.4.4.5.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.9.m9.4b"><vector id="S1.p3.9.m9.4.4.5.cmml" xref="S1.p3.9.m9.4.4.4"><apply id="S1.p3.9.m9.1.1.1.1.cmml" xref="S1.p3.9.m9.1.1.1.1"><csymbol cd="ambiguous" id="S1.p3.9.m9.1.1.1.1.1.cmml" xref="S1.p3.9.m9.1.1.1.1">subscript</csymbol><ci id="S1.p3.9.m9.1.1.1.1.2.cmml" xref="S1.p3.9.m9.1.1.1.1.2">𝑖</ci><cn id="S1.p3.9.m9.1.1.1.1.3.cmml" type="integer" xref="S1.p3.9.m9.1.1.1.1.3">1</cn></apply><apply id="S1.p3.9.m9.2.2.2.2.cmml" xref="S1.p3.9.m9.2.2.2.2"><csymbol cd="ambiguous" id="S1.p3.9.m9.2.2.2.2.1.cmml" xref="S1.p3.9.m9.2.2.2.2">subscript</csymbol><ci id="S1.p3.9.m9.2.2.2.2.2.cmml" xref="S1.p3.9.m9.2.2.2.2.2">𝑖</ci><cn id="S1.p3.9.m9.2.2.2.2.3.cmml" type="integer" xref="S1.p3.9.m9.2.2.2.2.3">2</cn></apply><apply id="S1.p3.9.m9.3.3.3.3.cmml" xref="S1.p3.9.m9.3.3.3.3"><csymbol cd="ambiguous" id="S1.p3.9.m9.3.3.3.3.1.cmml" xref="S1.p3.9.m9.3.3.3.3">subscript</csymbol><ci id="S1.p3.9.m9.3.3.3.3.2.cmml" xref="S1.p3.9.m9.3.3.3.3.2">𝑖</ci><cn id="S1.p3.9.m9.3.3.3.3.3.cmml" type="integer" xref="S1.p3.9.m9.3.3.3.3.3">6</cn></apply><apply id="S1.p3.9.m9.4.4.4.4.cmml" xref="S1.p3.9.m9.4.4.4.4"><csymbol cd="ambiguous" id="S1.p3.9.m9.4.4.4.4.1.cmml" xref="S1.p3.9.m9.4.4.4.4">subscript</csymbol><ci id="S1.p3.9.m9.4.4.4.4.2.cmml" xref="S1.p3.9.m9.4.4.4.4.2">𝑖</ci><cn id="S1.p3.9.m9.4.4.4.4.3.cmml" type="integer" xref="S1.p3.9.m9.4.4.4.4.3">7</cn></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.9.m9.4c">(i_{1},i_{2},i_{6},i_{7})</annotation><annotation encoding="application/x-llamapun" id="S1.p3.9.m9.4d">( italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 6 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 7 end_POSTSUBSCRIPT )</annotation></semantics></math>. For instance, a newly synthesized trajectory <math alttext="(i_{1},i_{2},i_{3},i_{4},i_{7})" class="ltx_Math" display="inline" id="S1.p3.10.m10.5"><semantics id="S1.p3.10.m10.5a"><mrow id="S1.p3.10.m10.5.5.5" xref="S1.p3.10.m10.5.5.6.cmml"><mo id="S1.p3.10.m10.5.5.5.6" stretchy="false" xref="S1.p3.10.m10.5.5.6.cmml">(</mo><msub id="S1.p3.10.m10.1.1.1.1" xref="S1.p3.10.m10.1.1.1.1.cmml"><mi id="S1.p3.10.m10.1.1.1.1.2" xref="S1.p3.10.m10.1.1.1.1.2.cmml">i</mi><mn id="S1.p3.10.m10.1.1.1.1.3" xref="S1.p3.10.m10.1.1.1.1.3.cmml">1</mn></msub><mo id="S1.p3.10.m10.5.5.5.7" xref="S1.p3.10.m10.5.5.6.cmml">,</mo><msub id="S1.p3.10.m10.2.2.2.2" xref="S1.p3.10.m10.2.2.2.2.cmml"><mi id="S1.p3.10.m10.2.2.2.2.2" xref="S1.p3.10.m10.2.2.2.2.2.cmml">i</mi><mn id="S1.p3.10.m10.2.2.2.2.3" xref="S1.p3.10.m10.2.2.2.2.3.cmml">2</mn></msub><mo id="S1.p3.10.m10.5.5.5.8" xref="S1.p3.10.m10.5.5.6.cmml">,</mo><msub id="S1.p3.10.m10.3.3.3.3" xref="S1.p3.10.m10.3.3.3.3.cmml"><mi id="S1.p3.10.m10.3.3.3.3.2" xref="S1.p3.10.m10.3.3.3.3.2.cmml">i</mi><mn id="S1.p3.10.m10.3.3.3.3.3" xref="S1.p3.10.m10.3.3.3.3.3.cmml">3</mn></msub><mo id="S1.p3.10.m10.5.5.5.9" xref="S1.p3.10.m10.5.5.6.cmml">,</mo><msub id="S1.p3.10.m10.4.4.4.4" xref="S1.p3.10.m10.4.4.4.4.cmml"><mi id="S1.p3.10.m10.4.4.4.4.2" xref="S1.p3.10.m10.4.4.4.4.2.cmml">i</mi><mn id="S1.p3.10.m10.4.4.4.4.3" xref="S1.p3.10.m10.4.4.4.4.3.cmml">4</mn></msub><mo id="S1.p3.10.m10.5.5.5.10" xref="S1.p3.10.m10.5.5.6.cmml">,</mo><msub id="S1.p3.10.m10.5.5.5.5" xref="S1.p3.10.m10.5.5.5.5.cmml"><mi id="S1.p3.10.m10.5.5.5.5.2" xref="S1.p3.10.m10.5.5.5.5.2.cmml">i</mi><mn id="S1.p3.10.m10.5.5.5.5.3" xref="S1.p3.10.m10.5.5.5.5.3.cmml">7</mn></msub><mo id="S1.p3.10.m10.5.5.5.11" stretchy="false" xref="S1.p3.10.m10.5.5.6.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.10.m10.5b"><vector id="S1.p3.10.m10.5.5.6.cmml" xref="S1.p3.10.m10.5.5.5"><apply id="S1.p3.10.m10.1.1.1.1.cmml" xref="S1.p3.10.m10.1.1.1.1"><csymbol cd="ambiguous" id="S1.p3.10.m10.1.1.1.1.1.cmml" xref="S1.p3.10.m10.1.1.1.1">subscript</csymbol><ci id="S1.p3.10.m10.1.1.1.1.2.cmml" xref="S1.p3.10.m10.1.1.1.1.2">𝑖</ci><cn id="S1.p3.10.m10.1.1.1.1.3.cmml" type="integer" xref="S1.p3.10.m10.1.1.1.1.3">1</cn></apply><apply id="S1.p3.10.m10.2.2.2.2.cmml" xref="S1.p3.10.m10.2.2.2.2"><csymbol cd="ambiguous" id="S1.p3.10.m10.2.2.2.2.1.cmml" xref="S1.p3.10.m10.2.2.2.2">subscript</csymbol><ci id="S1.p3.10.m10.2.2.2.2.2.cmml" xref="S1.p3.10.m10.2.2.2.2.2">𝑖</ci><cn id="S1.p3.10.m10.2.2.2.2.3.cmml" type="integer" xref="S1.p3.10.m10.2.2.2.2.3">2</cn></apply><apply id="S1.p3.10.m10.3.3.3.3.cmml" xref="S1.p3.10.m10.3.3.3.3"><csymbol cd="ambiguous" id="S1.p3.10.m10.3.3.3.3.1.cmml" xref="S1.p3.10.m10.3.3.3.3">subscript</csymbol><ci id="S1.p3.10.m10.3.3.3.3.2.cmml" xref="S1.p3.10.m10.3.3.3.3.2">𝑖</ci><cn id="S1.p3.10.m10.3.3.3.3.3.cmml" type="integer" xref="S1.p3.10.m10.3.3.3.3.3">3</cn></apply><apply id="S1.p3.10.m10.4.4.4.4.cmml" xref="S1.p3.10.m10.4.4.4.4"><csymbol cd="ambiguous" id="S1.p3.10.m10.4.4.4.4.1.cmml" xref="S1.p3.10.m10.4.4.4.4">subscript</csymbol><ci id="S1.p3.10.m10.4.4.4.4.2.cmml" xref="S1.p3.10.m10.4.4.4.4.2">𝑖</ci><cn id="S1.p3.10.m10.4.4.4.4.3.cmml" type="integer" xref="S1.p3.10.m10.4.4.4.4.3">4</cn></apply><apply id="S1.p3.10.m10.5.5.5.5.cmml" xref="S1.p3.10.m10.5.5.5.5"><csymbol cd="ambiguous" id="S1.p3.10.m10.5.5.5.5.1.cmml" xref="S1.p3.10.m10.5.5.5.5">subscript</csymbol><ci id="S1.p3.10.m10.5.5.5.5.2.cmml" xref="S1.p3.10.m10.5.5.5.5.2">𝑖</ci><cn id="S1.p3.10.m10.5.5.5.5.3.cmml" type="integer" xref="S1.p3.10.m10.5.5.5.5.3">7</cn></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.10.m10.5c">(i_{1},i_{2},i_{3},i_{4},i_{7})</annotation><annotation encoding="application/x-llamapun" id="S1.p3.10.m10.5d">( italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 7 end_POSTSUBSCRIPT )</annotation></semantics></math> is predicted to achieve a positive reward. Our reward relabeling strategy addresses this by assigning weights to each node, ensuring the agent avoids less rewarding paths like reaching node <math alttext="i_{8}" class="ltx_Math" display="inline" id="S1.p3.11.m11.1"><semantics id="S1.p3.11.m11.1a"><msub id="S1.p3.11.m11.1.1" xref="S1.p3.11.m11.1.1.cmml"><mi id="S1.p3.11.m11.1.1.2" xref="S1.p3.11.m11.1.1.2.cmml">i</mi><mn id="S1.p3.11.m11.1.1.3" xref="S1.p3.11.m11.1.1.3.cmml">8</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p3.11.m11.1b"><apply id="S1.p3.11.m11.1.1.cmml" xref="S1.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S1.p3.11.m11.1.1.1.cmml" xref="S1.p3.11.m11.1.1">subscript</csymbol><ci id="S1.p3.11.m11.1.1.2.cmml" xref="S1.p3.11.m11.1.1.2">𝑖</ci><cn id="S1.p3.11.m11.1.1.3.cmml" type="integer" xref="S1.p3.11.m11.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.11.m11.1c">i_{8}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.11.m11.1d">italic_i start_POSTSUBSCRIPT 8 end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="350" id="S1.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.2.1.1" style="font-size:90%;">Figure 1</span>. </span><span class="ltx_text" id="S1.F1.3.2" style="font-size:90%;">An example demonstrates that when DT is directly applied to RS will face the stitching problem (i.e., cannot learn from the sub-optimal trajectory). </span></figcaption>
</figure>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Moreover, since the DT believes that all of the possibilities are covered in the offline dataset, the exploration will be abandoned when fine-tuning the online environments <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib19" title="">2023</a>)</cite>. It will be crucial when applying to the RS, since the users’ interests are dynamic and rapidly changing, and the recorded offline dataset can not reflect users’ intentions completely. The agent still needs to conduct certain steps of exploration to collect trajectories as suggested by recent works <cite class="ltx_cite ltx_citemacro_citep">(Chen, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib6" title="">2021</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib10" title="">2023b</a>)</cite>. These limitations hinder the agent’s performance, particularly when working with sub-optimal offline datasets that do not fully encapsulate the range of possible user actions, a situation more akin to real-world scenarios.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">To address those two challenges, in this study, we introduce a novel model, named Max-Entropy enhanced Decision Transformer with Reward Relabeling for Offline RLRS (EDT4Rec), to overcome the identified challenges in RL-based Recommender Systems. Drawing inspiration from the Soft Actor-Critic (SAC) approach <cite class="ltx_cite ltx_citemacro_citep">(Haarnoja et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib15" title="">2018</a>)</cite>, EDT4Rec incorporates the concept of max-entropy exploration. It also introduces an innovative reward relabeling strategy, whereby each node in a trajectory is assigned a reward to foster the generation of more optimal trajectories and facilitate the learning of a more effective recommendation policy<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>For clarity, we will use ”policy” as an abbreviation in subsequent sections.</span></span></span>.
Our contributions in this work are threefold:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose EDT4Rec, a novel model that integrates max-entropy exploration and a unique reward relabeling strategy, enhancing the offline RLRS framework.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">To address the stitching problem in DT, we design a novel reward relabeling strategy. Moreover, we design a new max-entropy exploration mechanism to enable the agent can conduct the exploration when fine-tuning on the online environments.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We validate the efficacy of EDT4Rec through extensive experiments on six public datasets and in an online simulation environment, demonstrating its superiority over existing methods.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Problem Formulation</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">The recommendation problem can be conceptualized as an agent striving to achieve a specific goal through learning from user interactions, such as item recommendations and subsequent feedback. This scenario is aptly formulated as a RL problem, where the agent is trained to interact within an environment, typically described as a Markov Decision Process (MDP) <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib10" title="">2023b</a>)</cite>.
The components of an MDP are represented as a tuple <math alttext="(\mathcal{S},\mathcal{A},\mathcal{P},\mathcal{R},\gamma)" class="ltx_Math" display="inline" id="S2.p1.1.m1.5"><semantics id="S2.p1.1.m1.5a"><mrow id="S2.p1.1.m1.5.6.2" xref="S2.p1.1.m1.5.6.1.cmml"><mo id="S2.p1.1.m1.5.6.2.1" stretchy="false" xref="S2.p1.1.m1.5.6.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">𝒮</mi><mo id="S2.p1.1.m1.5.6.2.2" xref="S2.p1.1.m1.5.6.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.1.m1.2.2" xref="S2.p1.1.m1.2.2.cmml">𝒜</mi><mo id="S2.p1.1.m1.5.6.2.3" xref="S2.p1.1.m1.5.6.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.1.m1.3.3" xref="S2.p1.1.m1.3.3.cmml">𝒫</mi><mo id="S2.p1.1.m1.5.6.2.4" xref="S2.p1.1.m1.5.6.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.1.m1.4.4" xref="S2.p1.1.m1.4.4.cmml">ℛ</mi><mo id="S2.p1.1.m1.5.6.2.5" xref="S2.p1.1.m1.5.6.1.cmml">,</mo><mi id="S2.p1.1.m1.5.5" xref="S2.p1.1.m1.5.5.cmml">γ</mi><mo id="S2.p1.1.m1.5.6.2.6" stretchy="false" xref="S2.p1.1.m1.5.6.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.5b"><vector id="S2.p1.1.m1.5.6.1.cmml" xref="S2.p1.1.m1.5.6.2"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">𝒮</ci><ci id="S2.p1.1.m1.2.2.cmml" xref="S2.p1.1.m1.2.2">𝒜</ci><ci id="S2.p1.1.m1.3.3.cmml" xref="S2.p1.1.m1.3.3">𝒫</ci><ci id="S2.p1.1.m1.4.4.cmml" xref="S2.p1.1.m1.4.4">ℛ</ci><ci id="S2.p1.1.m1.5.5.cmml" xref="S2.p1.1.m1.5.5">𝛾</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.5c">(\mathcal{S},\mathcal{A},\mathcal{P},\mathcal{R},\gamma)</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.5d">( caligraphic_S , caligraphic_A , caligraphic_P , caligraphic_R , italic_γ )</annotation></semantics></math> where,</p>
<ul class="ltx_itemize" id="S2.I1">
<li class="ltx_item" id="S2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i1.p1">
<p class="ltx_p" id="S2.I1.i1.p1.3">State <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S2.I1.i1.p1.1.m1.1"><semantics id="S2.I1.i1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.I1.i1.p1.1.m1.1.1" xref="S2.I1.i1.p1.1.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.1.m1.1b"><ci id="S2.I1.i1.p1.1.m1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.1.m1.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.1.m1.1d">caligraphic_S</annotation></semantics></math>: The state space, with <math alttext="s_{t}\in\mathcal{S}" class="ltx_Math" display="inline" id="S2.I1.i1.p1.2.m2.1"><semantics id="S2.I1.i1.p1.2.m2.1a"><mrow id="S2.I1.i1.p1.2.m2.1.1" xref="S2.I1.i1.p1.2.m2.1.1.cmml"><msub id="S2.I1.i1.p1.2.m2.1.1.2" xref="S2.I1.i1.p1.2.m2.1.1.2.cmml"><mi id="S2.I1.i1.p1.2.m2.1.1.2.2" xref="S2.I1.i1.p1.2.m2.1.1.2.2.cmml">s</mi><mi id="S2.I1.i1.p1.2.m2.1.1.2.3" xref="S2.I1.i1.p1.2.m2.1.1.2.3.cmml">t</mi></msub><mo id="S2.I1.i1.p1.2.m2.1.1.1" xref="S2.I1.i1.p1.2.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.I1.i1.p1.2.m2.1.1.3" xref="S2.I1.i1.p1.2.m2.1.1.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.2.m2.1b"><apply id="S2.I1.i1.p1.2.m2.1.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1"><in id="S2.I1.i1.p1.2.m2.1.1.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1"></in><apply id="S2.I1.i1.p1.2.m2.1.1.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.I1.i1.p1.2.m2.1.1.2.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1.2">subscript</csymbol><ci id="S2.I1.i1.p1.2.m2.1.1.2.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.2.2">𝑠</ci><ci id="S2.I1.i1.p1.2.m2.1.1.2.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.2.3">𝑡</ci></apply><ci id="S2.I1.i1.p1.2.m2.1.1.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.2.m2.1c">s_{t}\in\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.2.m2.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ caligraphic_S</annotation></semantics></math> representing the state at timestep <math alttext="t" class="ltx_Math" display="inline" id="S2.I1.i1.p1.3.m3.1"><semantics id="S2.I1.i1.p1.3.m3.1a"><mi id="S2.I1.i1.p1.3.m3.1.1" xref="S2.I1.i1.p1.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.3.m3.1b"><ci id="S2.I1.i1.p1.3.m3.1.1.cmml" xref="S2.I1.i1.p1.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.3.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.3.m3.1d">italic_t</annotation></semantics></math>, which normally contain users’ previous interest, users’ demographic information etc.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i2.p1">
<p class="ltx_p" id="S2.I1.i2.p1.4">Action <math alttext="\mathcal{A}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.1.m1.1"><semantics id="S2.I1.i2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.I1.i2.p1.1.m1.1.1" xref="S2.I1.i2.p1.1.m1.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.1.m1.1b"><ci id="S2.I1.i2.p1.1.m1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.1.m1.1c">\mathcal{A}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.1.m1.1d">caligraphic_A</annotation></semantics></math>: The action space, where <math alttext="a_{t}\in\mathcal{A}(s_{t})" class="ltx_Math" display="inline" id="S2.I1.i2.p1.2.m2.1"><semantics id="S2.I1.i2.p1.2.m2.1a"><mrow id="S2.I1.i2.p1.2.m2.1.1" xref="S2.I1.i2.p1.2.m2.1.1.cmml"><msub id="S2.I1.i2.p1.2.m2.1.1.3" xref="S2.I1.i2.p1.2.m2.1.1.3.cmml"><mi id="S2.I1.i2.p1.2.m2.1.1.3.2" xref="S2.I1.i2.p1.2.m2.1.1.3.2.cmml">a</mi><mi id="S2.I1.i2.p1.2.m2.1.1.3.3" xref="S2.I1.i2.p1.2.m2.1.1.3.3.cmml">t</mi></msub><mo id="S2.I1.i2.p1.2.m2.1.1.2" xref="S2.I1.i2.p1.2.m2.1.1.2.cmml">∈</mo><mrow id="S2.I1.i2.p1.2.m2.1.1.1" xref="S2.I1.i2.p1.2.m2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.I1.i2.p1.2.m2.1.1.1.3" xref="S2.I1.i2.p1.2.m2.1.1.1.3.cmml">𝒜</mi><mo id="S2.I1.i2.p1.2.m2.1.1.1.2" xref="S2.I1.i2.p1.2.m2.1.1.1.2.cmml">⁢</mo><mrow id="S2.I1.i2.p1.2.m2.1.1.1.1.1" xref="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.cmml"><mo id="S2.I1.i2.p1.2.m2.1.1.1.1.1.2" stretchy="false" xref="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.cmml">(</mo><msub id="S2.I1.i2.p1.2.m2.1.1.1.1.1.1" xref="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.cmml"><mi id="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.2" xref="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.3" xref="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.I1.i2.p1.2.m2.1.1.1.1.1.3" stretchy="false" xref="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.2.m2.1b"><apply id="S2.I1.i2.p1.2.m2.1.1.cmml" xref="S2.I1.i2.p1.2.m2.1.1"><in id="S2.I1.i2.p1.2.m2.1.1.2.cmml" xref="S2.I1.i2.p1.2.m2.1.1.2"></in><apply id="S2.I1.i2.p1.2.m2.1.1.3.cmml" xref="S2.I1.i2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.I1.i2.p1.2.m2.1.1.3.1.cmml" xref="S2.I1.i2.p1.2.m2.1.1.3">subscript</csymbol><ci id="S2.I1.i2.p1.2.m2.1.1.3.2.cmml" xref="S2.I1.i2.p1.2.m2.1.1.3.2">𝑎</ci><ci id="S2.I1.i2.p1.2.m2.1.1.3.3.cmml" xref="S2.I1.i2.p1.2.m2.1.1.3.3">𝑡</ci></apply><apply id="S2.I1.i2.p1.2.m2.1.1.1.cmml" xref="S2.I1.i2.p1.2.m2.1.1.1"><times id="S2.I1.i2.p1.2.m2.1.1.1.2.cmml" xref="S2.I1.i2.p1.2.m2.1.1.1.2"></times><ci id="S2.I1.i2.p1.2.m2.1.1.1.3.cmml" xref="S2.I1.i2.p1.2.m2.1.1.1.3">𝒜</ci><apply id="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S2.I1.i2.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S2.I1.i2.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.2.cmml" xref="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.3.cmml" xref="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.2.m2.1c">a_{t}\in\mathcal{A}(s_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.2.m2.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ caligraphic_A ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>. <math alttext="a_{t}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.3.m3.1"><semantics id="S2.I1.i2.p1.3.m3.1a"><msub id="S2.I1.i2.p1.3.m3.1.1" xref="S2.I1.i2.p1.3.m3.1.1.cmml"><mi id="S2.I1.i2.p1.3.m3.1.1.2" xref="S2.I1.i2.p1.3.m3.1.1.2.cmml">a</mi><mi id="S2.I1.i2.p1.3.m3.1.1.3" xref="S2.I1.i2.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.3.m3.1b"><apply id="S2.I1.i2.p1.3.m3.1.1.cmml" xref="S2.I1.i2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.3.m3.1.1.1.cmml" xref="S2.I1.i2.p1.3.m3.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.3.m3.1.1.2.cmml" xref="S2.I1.i2.p1.3.m3.1.1.2">𝑎</ci><ci id="S2.I1.i2.p1.3.m3.1.1.3.cmml" xref="S2.I1.i2.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.3.m3.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.3.m3.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is the action taken when given a state <math alttext="s_{t}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.4.m4.1"><semantics id="S2.I1.i2.p1.4.m4.1a"><msub id="S2.I1.i2.p1.4.m4.1.1" xref="S2.I1.i2.p1.4.m4.1.1.cmml"><mi id="S2.I1.i2.p1.4.m4.1.1.2" xref="S2.I1.i2.p1.4.m4.1.1.2.cmml">s</mi><mi id="S2.I1.i2.p1.4.m4.1.1.3" xref="S2.I1.i2.p1.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.4.m4.1b"><apply id="S2.I1.i2.p1.4.m4.1.1.cmml" xref="S2.I1.i2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.4.m4.1.1.1.cmml" xref="S2.I1.i2.p1.4.m4.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.4.m4.1.1.2.cmml" xref="S2.I1.i2.p1.4.m4.1.1.2">𝑠</ci><ci id="S2.I1.i2.p1.4.m4.1.1.3.cmml" xref="S2.I1.i2.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.4.m4.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.4.m4.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. It normally refers to recommended items.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i3.p1">
<p class="ltx_p" id="S2.I1.i3.p1.5">Transition Probability <math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="S2.I1.i3.p1.1.m1.1"><semantics id="S2.I1.i3.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.I1.i3.p1.1.m1.1.1" xref="S2.I1.i3.p1.1.m1.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.1.m1.1b"><ci id="S2.I1.i3.p1.1.m1.1.1.cmml" xref="S2.I1.i3.p1.1.m1.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.1.m1.1c">\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.1.m1.1d">caligraphic_P</annotation></semantics></math>: denoted as <math alttext="p(s_{t+1}|s_{t},a_{t})\in\mathcal{P}" class="ltx_Math" display="inline" id="S2.I1.i3.p1.2.m2.1"><semantics id="S2.I1.i3.p1.2.m2.1a"><mrow id="S2.I1.i3.p1.2.m2.1.1" xref="S2.I1.i3.p1.2.m2.1.1.cmml"><mrow id="S2.I1.i3.p1.2.m2.1.1.1" xref="S2.I1.i3.p1.2.m2.1.1.1.cmml"><mi id="S2.I1.i3.p1.2.m2.1.1.1.3" xref="S2.I1.i3.p1.2.m2.1.1.1.3.cmml">p</mi><mo id="S2.I1.i3.p1.2.m2.1.1.1.2" xref="S2.I1.i3.p1.2.m2.1.1.1.2.cmml">⁢</mo><mrow id="S2.I1.i3.p1.2.m2.1.1.1.1.1" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.cmml"><mo id="S2.I1.i3.p1.2.m2.1.1.1.1.1.2" stretchy="false" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.cmml"><msub id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.4" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.4.cmml"><mi id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.4.2" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.4.2.cmml">s</mi><mrow id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.4.3" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.4.3.cmml"><mi id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.4.3.2" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.4.3.2.cmml">t</mi><mo id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.4.3.1" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.4.3.1.cmml">+</mo><mn id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.4.3.3" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.4.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.3" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.2.2" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.2.3.cmml"><msub id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.1.1.1" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.1.1.1.2" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.1.1.1.3" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.2.2.3" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.2.2.2" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.2.2.2.2" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.2.2.2.2.cmml">a</mi><mi id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.2.2.2.3" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="S2.I1.i3.p1.2.m2.1.1.1.1.1.3" stretchy="false" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.I1.i3.p1.2.m2.1.1.2" xref="S2.I1.i3.p1.2.m2.1.1.2.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.I1.i3.p1.2.m2.1.1.3" xref="S2.I1.i3.p1.2.m2.1.1.3.cmml">𝒫</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.2.m2.1b"><apply id="S2.I1.i3.p1.2.m2.1.1.cmml" xref="S2.I1.i3.p1.2.m2.1.1"><in id="S2.I1.i3.p1.2.m2.1.1.2.cmml" xref="S2.I1.i3.p1.2.m2.1.1.2"></in><apply id="S2.I1.i3.p1.2.m2.1.1.1.cmml" xref="S2.I1.i3.p1.2.m2.1.1.1"><times id="S2.I1.i3.p1.2.m2.1.1.1.2.cmml" xref="S2.I1.i3.p1.2.m2.1.1.1.2"></times><ci id="S2.I1.i3.p1.2.m2.1.1.1.3.cmml" xref="S2.I1.i3.p1.2.m2.1.1.1.3">𝑝</ci><apply id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.cmml" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1"><csymbol cd="latexml" id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.3.cmml" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.3">conditional</csymbol><apply id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.4.cmml" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.4.1.cmml" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.4.2.cmml" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.4.2">𝑠</ci><apply id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.4.3.cmml" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.4.3"><plus id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.4.3.1.cmml" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.4.3.1"></plus><ci id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.4.3.2.cmml" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.4.3.2">𝑡</ci><cn id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.4.3.3.cmml" type="integer" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.4.3.3">1</cn></apply></apply><list id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.2.3.cmml" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.2.2"><apply id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.2.2.2.cmml" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.2.2.2.2">𝑎</ci><ci id="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.I1.i3.p1.2.m2.1.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></list></apply></apply><ci id="S2.I1.i3.p1.2.m2.1.1.3.cmml" xref="S2.I1.i3.p1.2.m2.1.1.3">𝒫</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.2.m2.1c">p(s_{t+1}|s_{t},a_{t})\in\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.2.m2.1d">italic_p ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ∈ caligraphic_P</annotation></semantics></math>, is the probability of transitioning from <math alttext="s_{t}" class="ltx_Math" display="inline" id="S2.I1.i3.p1.3.m3.1"><semantics id="S2.I1.i3.p1.3.m3.1a"><msub id="S2.I1.i3.p1.3.m3.1.1" xref="S2.I1.i3.p1.3.m3.1.1.cmml"><mi id="S2.I1.i3.p1.3.m3.1.1.2" xref="S2.I1.i3.p1.3.m3.1.1.2.cmml">s</mi><mi id="S2.I1.i3.p1.3.m3.1.1.3" xref="S2.I1.i3.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.3.m3.1b"><apply id="S2.I1.i3.p1.3.m3.1.1.cmml" xref="S2.I1.i3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.I1.i3.p1.3.m3.1.1.1.cmml" xref="S2.I1.i3.p1.3.m3.1.1">subscript</csymbol><ci id="S2.I1.i3.p1.3.m3.1.1.2.cmml" xref="S2.I1.i3.p1.3.m3.1.1.2">𝑠</ci><ci id="S2.I1.i3.p1.3.m3.1.1.3.cmml" xref="S2.I1.i3.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.3.m3.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.3.m3.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to <math alttext="s_{t+1}" class="ltx_Math" display="inline" id="S2.I1.i3.p1.4.m4.1"><semantics id="S2.I1.i3.p1.4.m4.1a"><msub id="S2.I1.i3.p1.4.m4.1.1" xref="S2.I1.i3.p1.4.m4.1.1.cmml"><mi id="S2.I1.i3.p1.4.m4.1.1.2" xref="S2.I1.i3.p1.4.m4.1.1.2.cmml">s</mi><mrow id="S2.I1.i3.p1.4.m4.1.1.3" xref="S2.I1.i3.p1.4.m4.1.1.3.cmml"><mi id="S2.I1.i3.p1.4.m4.1.1.3.2" xref="S2.I1.i3.p1.4.m4.1.1.3.2.cmml">t</mi><mo id="S2.I1.i3.p1.4.m4.1.1.3.1" xref="S2.I1.i3.p1.4.m4.1.1.3.1.cmml">+</mo><mn id="S2.I1.i3.p1.4.m4.1.1.3.3" xref="S2.I1.i3.p1.4.m4.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.4.m4.1b"><apply id="S2.I1.i3.p1.4.m4.1.1.cmml" xref="S2.I1.i3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.I1.i3.p1.4.m4.1.1.1.cmml" xref="S2.I1.i3.p1.4.m4.1.1">subscript</csymbol><ci id="S2.I1.i3.p1.4.m4.1.1.2.cmml" xref="S2.I1.i3.p1.4.m4.1.1.2">𝑠</ci><apply id="S2.I1.i3.p1.4.m4.1.1.3.cmml" xref="S2.I1.i3.p1.4.m4.1.1.3"><plus id="S2.I1.i3.p1.4.m4.1.1.3.1.cmml" xref="S2.I1.i3.p1.4.m4.1.1.3.1"></plus><ci id="S2.I1.i3.p1.4.m4.1.1.3.2.cmml" xref="S2.I1.i3.p1.4.m4.1.1.3.2">𝑡</ci><cn id="S2.I1.i3.p1.4.m4.1.1.3.3.cmml" type="integer" xref="S2.I1.i3.p1.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.4.m4.1c">s_{t+1}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.4.m4.1d">italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math> when action <math alttext="a_{t}" class="ltx_Math" display="inline" id="S2.I1.i3.p1.5.m5.1"><semantics id="S2.I1.i3.p1.5.m5.1a"><msub id="S2.I1.i3.p1.5.m5.1.1" xref="S2.I1.i3.p1.5.m5.1.1.cmml"><mi id="S2.I1.i3.p1.5.m5.1.1.2" xref="S2.I1.i3.p1.5.m5.1.1.2.cmml">a</mi><mi id="S2.I1.i3.p1.5.m5.1.1.3" xref="S2.I1.i3.p1.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.5.m5.1b"><apply id="S2.I1.i3.p1.5.m5.1.1.cmml" xref="S2.I1.i3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.I1.i3.p1.5.m5.1.1.1.cmml" xref="S2.I1.i3.p1.5.m5.1.1">subscript</csymbol><ci id="S2.I1.i3.p1.5.m5.1.1.2.cmml" xref="S2.I1.i3.p1.5.m5.1.1.2">𝑎</ci><ci id="S2.I1.i3.p1.5.m5.1.1.3.cmml" xref="S2.I1.i3.p1.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.5.m5.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.5.m5.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is taken.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i4.p1">
<p class="ltx_p" id="S2.I1.i4.p1.5">Reward <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="S2.I1.i4.p1.1.m1.1"><semantics id="S2.I1.i4.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.I1.i4.p1.1.m1.1.1" xref="S2.I1.i4.p1.1.m1.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i4.p1.1.m1.1b"><ci id="S2.I1.i4.p1.1.m1.1.1.cmml" xref="S2.I1.i4.p1.1.m1.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i4.p1.1.m1.1c">\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i4.p1.1.m1.1d">caligraphic_R</annotation></semantics></math>: <math alttext="\mathcal{S}\times\mathcal{A}\to\mathbb{R}" class="ltx_Math" display="inline" id="S2.I1.i4.p1.2.m2.1"><semantics id="S2.I1.i4.p1.2.m2.1a"><mrow id="S2.I1.i4.p1.2.m2.1.1" xref="S2.I1.i4.p1.2.m2.1.1.cmml"><mrow id="S2.I1.i4.p1.2.m2.1.1.2" xref="S2.I1.i4.p1.2.m2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.I1.i4.p1.2.m2.1.1.2.2" xref="S2.I1.i4.p1.2.m2.1.1.2.2.cmml">𝒮</mi><mo id="S2.I1.i4.p1.2.m2.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S2.I1.i4.p1.2.m2.1.1.2.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S2.I1.i4.p1.2.m2.1.1.2.3" xref="S2.I1.i4.p1.2.m2.1.1.2.3.cmml">𝒜</mi></mrow><mo id="S2.I1.i4.p1.2.m2.1.1.1" stretchy="false" xref="S2.I1.i4.p1.2.m2.1.1.1.cmml">→</mo><mi id="S2.I1.i4.p1.2.m2.1.1.3" xref="S2.I1.i4.p1.2.m2.1.1.3.cmml">ℝ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i4.p1.2.m2.1b"><apply id="S2.I1.i4.p1.2.m2.1.1.cmml" xref="S2.I1.i4.p1.2.m2.1.1"><ci id="S2.I1.i4.p1.2.m2.1.1.1.cmml" xref="S2.I1.i4.p1.2.m2.1.1.1">→</ci><apply id="S2.I1.i4.p1.2.m2.1.1.2.cmml" xref="S2.I1.i4.p1.2.m2.1.1.2"><times id="S2.I1.i4.p1.2.m2.1.1.2.1.cmml" xref="S2.I1.i4.p1.2.m2.1.1.2.1"></times><ci id="S2.I1.i4.p1.2.m2.1.1.2.2.cmml" xref="S2.I1.i4.p1.2.m2.1.1.2.2">𝒮</ci><ci id="S2.I1.i4.p1.2.m2.1.1.2.3.cmml" xref="S2.I1.i4.p1.2.m2.1.1.2.3">𝒜</ci></apply><ci id="S2.I1.i4.p1.2.m2.1.1.3.cmml" xref="S2.I1.i4.p1.2.m2.1.1.3">ℝ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i4.p1.2.m2.1c">\mathcal{S}\times\mathcal{A}\to\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i4.p1.2.m2.1d">caligraphic_S × caligraphic_A → blackboard_R</annotation></semantics></math> is the reward distribution, where <math alttext="r(s,a)" class="ltx_Math" display="inline" id="S2.I1.i4.p1.3.m3.2"><semantics id="S2.I1.i4.p1.3.m3.2a"><mrow id="S2.I1.i4.p1.3.m3.2.3" xref="S2.I1.i4.p1.3.m3.2.3.cmml"><mi id="S2.I1.i4.p1.3.m3.2.3.2" xref="S2.I1.i4.p1.3.m3.2.3.2.cmml">r</mi><mo id="S2.I1.i4.p1.3.m3.2.3.1" xref="S2.I1.i4.p1.3.m3.2.3.1.cmml">⁢</mo><mrow id="S2.I1.i4.p1.3.m3.2.3.3.2" xref="S2.I1.i4.p1.3.m3.2.3.3.1.cmml"><mo id="S2.I1.i4.p1.3.m3.2.3.3.2.1" stretchy="false" xref="S2.I1.i4.p1.3.m3.2.3.3.1.cmml">(</mo><mi id="S2.I1.i4.p1.3.m3.1.1" xref="S2.I1.i4.p1.3.m3.1.1.cmml">s</mi><mo id="S2.I1.i4.p1.3.m3.2.3.3.2.2" xref="S2.I1.i4.p1.3.m3.2.3.3.1.cmml">,</mo><mi id="S2.I1.i4.p1.3.m3.2.2" xref="S2.I1.i4.p1.3.m3.2.2.cmml">a</mi><mo id="S2.I1.i4.p1.3.m3.2.3.3.2.3" stretchy="false" xref="S2.I1.i4.p1.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i4.p1.3.m3.2b"><apply id="S2.I1.i4.p1.3.m3.2.3.cmml" xref="S2.I1.i4.p1.3.m3.2.3"><times id="S2.I1.i4.p1.3.m3.2.3.1.cmml" xref="S2.I1.i4.p1.3.m3.2.3.1"></times><ci id="S2.I1.i4.p1.3.m3.2.3.2.cmml" xref="S2.I1.i4.p1.3.m3.2.3.2">𝑟</ci><interval closure="open" id="S2.I1.i4.p1.3.m3.2.3.3.1.cmml" xref="S2.I1.i4.p1.3.m3.2.3.3.2"><ci id="S2.I1.i4.p1.3.m3.1.1.cmml" xref="S2.I1.i4.p1.3.m3.1.1">𝑠</ci><ci id="S2.I1.i4.p1.3.m3.2.2.cmml" xref="S2.I1.i4.p1.3.m3.2.2">𝑎</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i4.p1.3.m3.2c">r(s,a)</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i4.p1.3.m3.2d">italic_r ( italic_s , italic_a )</annotation></semantics></math> indicates the reward received for taking action <math alttext="a" class="ltx_Math" display="inline" id="S2.I1.i4.p1.4.m4.1"><semantics id="S2.I1.i4.p1.4.m4.1a"><mi id="S2.I1.i4.p1.4.m4.1.1" xref="S2.I1.i4.p1.4.m4.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i4.p1.4.m4.1b"><ci id="S2.I1.i4.p1.4.m4.1.1.cmml" xref="S2.I1.i4.p1.4.m4.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i4.p1.4.m4.1c">a</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i4.p1.4.m4.1d">italic_a</annotation></semantics></math> when observing the state <math alttext="s" class="ltx_Math" display="inline" id="S2.I1.i4.p1.5.m5.1"><semantics id="S2.I1.i4.p1.5.m5.1a"><mi id="S2.I1.i4.p1.5.m5.1.1" xref="S2.I1.i4.p1.5.m5.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i4.p1.5.m5.1b"><ci id="S2.I1.i4.p1.5.m5.1.1.cmml" xref="S2.I1.i4.p1.5.m5.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i4.p1.5.m5.1c">s</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i4.p1.5.m5.1d">italic_s</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i5.p1">
<p class="ltx_p" id="S2.I1.i5.p1.2">Discount-rate Parameter <math alttext="\mathcal{\gamma}" class="ltx_Math" display="inline" id="S2.I1.i5.p1.1.m1.1"><semantics id="S2.I1.i5.p1.1.m1.1a"><mi id="S2.I1.i5.p1.1.m1.1.1" xref="S2.I1.i5.p1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i5.p1.1.m1.1b"><ci id="S2.I1.i5.p1.1.m1.1.1.cmml" xref="S2.I1.i5.p1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i5.p1.1.m1.1c">\mathcal{\gamma}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i5.p1.1.m1.1d">italic_γ</annotation></semantics></math>: <math alttext="\mathcal{\gamma}\in[0,1]" class="ltx_Math" display="inline" id="S2.I1.i5.p1.2.m2.2"><semantics id="S2.I1.i5.p1.2.m2.2a"><mrow id="S2.I1.i5.p1.2.m2.2.3" xref="S2.I1.i5.p1.2.m2.2.3.cmml"><mi id="S2.I1.i5.p1.2.m2.2.3.2" xref="S2.I1.i5.p1.2.m2.2.3.2.cmml">γ</mi><mo id="S2.I1.i5.p1.2.m2.2.3.1" xref="S2.I1.i5.p1.2.m2.2.3.1.cmml">∈</mo><mrow id="S2.I1.i5.p1.2.m2.2.3.3.2" xref="S2.I1.i5.p1.2.m2.2.3.3.1.cmml"><mo id="S2.I1.i5.p1.2.m2.2.3.3.2.1" stretchy="false" xref="S2.I1.i5.p1.2.m2.2.3.3.1.cmml">[</mo><mn id="S2.I1.i5.p1.2.m2.1.1" xref="S2.I1.i5.p1.2.m2.1.1.cmml">0</mn><mo id="S2.I1.i5.p1.2.m2.2.3.3.2.2" xref="S2.I1.i5.p1.2.m2.2.3.3.1.cmml">,</mo><mn id="S2.I1.i5.p1.2.m2.2.2" xref="S2.I1.i5.p1.2.m2.2.2.cmml">1</mn><mo id="S2.I1.i5.p1.2.m2.2.3.3.2.3" stretchy="false" xref="S2.I1.i5.p1.2.m2.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i5.p1.2.m2.2b"><apply id="S2.I1.i5.p1.2.m2.2.3.cmml" xref="S2.I1.i5.p1.2.m2.2.3"><in id="S2.I1.i5.p1.2.m2.2.3.1.cmml" xref="S2.I1.i5.p1.2.m2.2.3.1"></in><ci id="S2.I1.i5.p1.2.m2.2.3.2.cmml" xref="S2.I1.i5.p1.2.m2.2.3.2">𝛾</ci><interval closure="closed" id="S2.I1.i5.p1.2.m2.2.3.3.1.cmml" xref="S2.I1.i5.p1.2.m2.2.3.3.2"><cn id="S2.I1.i5.p1.2.m2.1.1.cmml" type="integer" xref="S2.I1.i5.p1.2.m2.1.1">0</cn><cn id="S2.I1.i5.p1.2.m2.2.2.cmml" type="integer" xref="S2.I1.i5.p1.2.m2.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i5.p1.2.m2.2c">\mathcal{\gamma}\in[0,1]</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i5.p1.2.m2.2d">italic_γ ∈ [ 0 , 1 ]</annotation></semantics></math> is the discount factor which use to balance previous reward and immediate reward.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">In this context, an RL agent follows its policy <math alttext="\pi" class="ltx_Math" display="inline" id="S2.p2.1.m1.1"><semantics id="S2.p2.1.m1.1a"><mi id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><ci id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S2.p2.1.m1.1d">italic_π</annotation></semantics></math>, a mapping from states to actions to make recommendations. The objective of RL is expressed as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S6.EGx1">
<tbody id="S2.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbb{E}_{\tau}\bigg{[}\sum_{t=0}^{\infty}\gamma^{k}r(s_{t},a_{%
t})\bigg{]}" class="ltx_Math" display="inline" id="S2.Ex1.m1.1"><semantics id="S2.Ex1.m1.1a"><mrow id="S2.Ex1.m1.1.1" xref="S2.Ex1.m1.1.1.cmml"><msub id="S2.Ex1.m1.1.1.3" xref="S2.Ex1.m1.1.1.3.cmml"><mi id="S2.Ex1.m1.1.1.3.2" xref="S2.Ex1.m1.1.1.3.2.cmml">𝔼</mi><mi id="S2.Ex1.m1.1.1.3.3" xref="S2.Ex1.m1.1.1.3.3.cmml">τ</mi></msub><mo id="S2.Ex1.m1.1.1.2" xref="S2.Ex1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.Ex1.m1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.2.cmml"><mo id="S2.Ex1.m1.1.1.1.1.2" maxsize="210%" minsize="210%" xref="S2.Ex1.m1.1.1.1.2.1.cmml">[</mo><mrow id="S2.Ex1.m1.1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.Ex1.m1.1.1.1.1.1.3" xref="S2.Ex1.m1.1.1.1.1.1.3.cmml"><munderover id="S2.Ex1.m1.1.1.1.1.1.3a" xref="S2.Ex1.m1.1.1.1.1.1.3.cmml"><mo id="S2.Ex1.m1.1.1.1.1.1.3.2.2" movablelimits="false" xref="S2.Ex1.m1.1.1.1.1.1.3.2.2.cmml">∑</mo><mrow id="S2.Ex1.m1.1.1.1.1.1.3.2.3" xref="S2.Ex1.m1.1.1.1.1.1.3.2.3.cmml"><mi id="S2.Ex1.m1.1.1.1.1.1.3.2.3.2" xref="S2.Ex1.m1.1.1.1.1.1.3.2.3.2.cmml">t</mi><mo id="S2.Ex1.m1.1.1.1.1.1.3.2.3.1" xref="S2.Ex1.m1.1.1.1.1.1.3.2.3.1.cmml">=</mo><mn id="S2.Ex1.m1.1.1.1.1.1.3.2.3.3" xref="S2.Ex1.m1.1.1.1.1.1.3.2.3.3.cmml">0</mn></mrow><mi id="S2.Ex1.m1.1.1.1.1.1.3.3" mathvariant="normal" xref="S2.Ex1.m1.1.1.1.1.1.3.3.cmml">∞</mi></munderover></mstyle><mrow id="S2.Ex1.m1.1.1.1.1.1.2" xref="S2.Ex1.m1.1.1.1.1.1.2.cmml"><msup id="S2.Ex1.m1.1.1.1.1.1.2.4" xref="S2.Ex1.m1.1.1.1.1.1.2.4.cmml"><mi id="S2.Ex1.m1.1.1.1.1.1.2.4.2" xref="S2.Ex1.m1.1.1.1.1.1.2.4.2.cmml">γ</mi><mi id="S2.Ex1.m1.1.1.1.1.1.2.4.3" xref="S2.Ex1.m1.1.1.1.1.1.2.4.3.cmml">k</mi></msup><mo id="S2.Ex1.m1.1.1.1.1.1.2.3" xref="S2.Ex1.m1.1.1.1.1.1.2.3.cmml">⁢</mo><mi id="S2.Ex1.m1.1.1.1.1.1.2.5" xref="S2.Ex1.m1.1.1.1.1.1.2.5.cmml">r</mi><mo id="S2.Ex1.m1.1.1.1.1.1.2.3a" xref="S2.Ex1.m1.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S2.Ex1.m1.1.1.1.1.1.2.2.2" xref="S2.Ex1.m1.1.1.1.1.1.2.2.3.cmml"><mo id="S2.Ex1.m1.1.1.1.1.1.2.2.2.3" stretchy="false" xref="S2.Ex1.m1.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S2.Ex1.m1.1.1.1.1.1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.Ex1.m1.1.1.1.1.1.2.2.2.4" xref="S2.Ex1.m1.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S2.Ex1.m1.1.1.1.1.1.2.2.2.2" xref="S2.Ex1.m1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S2.Ex1.m1.1.1.1.1.1.2.2.2.2.2" xref="S2.Ex1.m1.1.1.1.1.1.2.2.2.2.2.cmml">a</mi><mi id="S2.Ex1.m1.1.1.1.1.1.2.2.2.2.3" xref="S2.Ex1.m1.1.1.1.1.1.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.Ex1.m1.1.1.1.1.1.2.2.2.5" stretchy="false" xref="S2.Ex1.m1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.Ex1.m1.1.1.1.1.3" maxsize="210%" minsize="210%" xref="S2.Ex1.m1.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.1b"><apply id="S2.Ex1.m1.1.1.cmml" xref="S2.Ex1.m1.1.1"><times id="S2.Ex1.m1.1.1.2.cmml" xref="S2.Ex1.m1.1.1.2"></times><apply id="S2.Ex1.m1.1.1.3.cmml" xref="S2.Ex1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.3.1.cmml" xref="S2.Ex1.m1.1.1.3">subscript</csymbol><ci id="S2.Ex1.m1.1.1.3.2.cmml" xref="S2.Ex1.m1.1.1.3.2">𝔼</ci><ci id="S2.Ex1.m1.1.1.3.3.cmml" xref="S2.Ex1.m1.1.1.3.3">𝜏</ci></apply><apply id="S2.Ex1.m1.1.1.1.2.cmml" xref="S2.Ex1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.Ex1.m1.1.1.1.2.1.cmml" xref="S2.Ex1.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.Ex1.m1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1"><apply id="S2.Ex1.m1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.1.3.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.3">superscript</csymbol><apply id="S2.Ex1.m1.1.1.1.1.1.3.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.1.3.2.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.3">subscript</csymbol><sum id="S2.Ex1.m1.1.1.1.1.1.3.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.3.2.2"></sum><apply id="S2.Ex1.m1.1.1.1.1.1.3.2.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.3.2.3"><eq id="S2.Ex1.m1.1.1.1.1.1.3.2.3.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.3.2.3.1"></eq><ci id="S2.Ex1.m1.1.1.1.1.1.3.2.3.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.3.2.3.2">𝑡</ci><cn id="S2.Ex1.m1.1.1.1.1.1.3.2.3.3.cmml" type="integer" xref="S2.Ex1.m1.1.1.1.1.1.3.2.3.3">0</cn></apply></apply><infinity id="S2.Ex1.m1.1.1.1.1.1.3.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.3.3"></infinity></apply><apply id="S2.Ex1.m1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.2"><times id="S2.Ex1.m1.1.1.1.1.1.2.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.2.3"></times><apply id="S2.Ex1.m1.1.1.1.1.1.2.4.cmml" xref="S2.Ex1.m1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.1.2.4.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.2.4">superscript</csymbol><ci id="S2.Ex1.m1.1.1.1.1.1.2.4.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.2.4.2">𝛾</ci><ci id="S2.Ex1.m1.1.1.1.1.1.2.4.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.2.4.3">𝑘</ci></apply><ci id="S2.Ex1.m1.1.1.1.1.1.2.5.cmml" xref="S2.Ex1.m1.1.1.1.1.1.2.5">𝑟</ci><interval closure="open" id="S2.Ex1.m1.1.1.1.1.1.2.2.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.2.2.2"><apply id="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.Ex1.m1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.Ex1.m1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.2.2.2.2.2">𝑎</ci><ci id="S2.Ex1.m1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.1c">\displaystyle\mathbb{E}_{\tau}\bigg{[}\sum_{t=0}^{\infty}\gamma^{k}r(s_{t},a_{%
t})\bigg{]}</annotation><annotation encoding="application/x-llamapun" id="S2.Ex1.m1.1d">blackboard_E start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT [ ∑ start_POSTSUBSCRIPT italic_t = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_r ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.9"><em class="ltx_emph ltx_font_italic" id="S2.p3.9.1">Offline</em> reinforcement learning diverges from traditional RL by exclusively utilizing pre-collected data for training, without the necessity for further online interaction <cite class="ltx_cite ltx_citemacro_citep">(Levine et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib18" title="">2020</a>)</cite>. In offline RL, the agent is trained to maximize total rewards relies on a static dataset of transitions <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S2.p3.1.m1.1"><semantics id="S2.p3.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><ci id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.1.m1.1d">caligraphic_D</annotation></semantics></math> for learning. This dataset could comprise previously collected data or human demonstrations. Consequently, the agent in offline RL lacks the capability to explore and interact with the environment for additional data collection. The dataset <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S2.p3.2.m2.1"><semantics id="S2.p3.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p3.2.m2.1.1" xref="S2.p3.2.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S2.p3.2.m2.1b"><ci id="S2.p3.2.m2.1.1.cmml" xref="S2.p3.2.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.2.m2.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.2.m2.1d">caligraphic_D</annotation></semantics></math> in an offline RL-based RS can be formally described as <math alttext="\{(s_{t}^{u},a_{t}^{u},s_{t+1}^{u},r_{t}^{u})\}" class="ltx_Math" display="inline" id="S2.p3.3.m3.1"><semantics id="S2.p3.3.m3.1a"><mrow id="S2.p3.3.m3.1.1.1" xref="S2.p3.3.m3.1.1.2.cmml"><mo id="S2.p3.3.m3.1.1.1.2" stretchy="false" xref="S2.p3.3.m3.1.1.2.cmml">{</mo><mrow id="S2.p3.3.m3.1.1.1.1.4" xref="S2.p3.3.m3.1.1.1.1.5.cmml"><mo id="S2.p3.3.m3.1.1.1.1.4.5" stretchy="false" xref="S2.p3.3.m3.1.1.1.1.5.cmml">(</mo><msubsup id="S2.p3.3.m3.1.1.1.1.1.1" xref="S2.p3.3.m3.1.1.1.1.1.1.cmml"><mi id="S2.p3.3.m3.1.1.1.1.1.1.2.2" xref="S2.p3.3.m3.1.1.1.1.1.1.2.2.cmml">s</mi><mi id="S2.p3.3.m3.1.1.1.1.1.1.2.3" xref="S2.p3.3.m3.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="S2.p3.3.m3.1.1.1.1.1.1.3" xref="S2.p3.3.m3.1.1.1.1.1.1.3.cmml">u</mi></msubsup><mo id="S2.p3.3.m3.1.1.1.1.4.6" xref="S2.p3.3.m3.1.1.1.1.5.cmml">,</mo><msubsup id="S2.p3.3.m3.1.1.1.1.2.2" xref="S2.p3.3.m3.1.1.1.1.2.2.cmml"><mi id="S2.p3.3.m3.1.1.1.1.2.2.2.2" xref="S2.p3.3.m3.1.1.1.1.2.2.2.2.cmml">a</mi><mi id="S2.p3.3.m3.1.1.1.1.2.2.2.3" xref="S2.p3.3.m3.1.1.1.1.2.2.2.3.cmml">t</mi><mi id="S2.p3.3.m3.1.1.1.1.2.2.3" xref="S2.p3.3.m3.1.1.1.1.2.2.3.cmml">u</mi></msubsup><mo id="S2.p3.3.m3.1.1.1.1.4.7" xref="S2.p3.3.m3.1.1.1.1.5.cmml">,</mo><msubsup id="S2.p3.3.m3.1.1.1.1.3.3" xref="S2.p3.3.m3.1.1.1.1.3.3.cmml"><mi id="S2.p3.3.m3.1.1.1.1.3.3.2.2" xref="S2.p3.3.m3.1.1.1.1.3.3.2.2.cmml">s</mi><mrow id="S2.p3.3.m3.1.1.1.1.3.3.2.3" xref="S2.p3.3.m3.1.1.1.1.3.3.2.3.cmml"><mi id="S2.p3.3.m3.1.1.1.1.3.3.2.3.2" xref="S2.p3.3.m3.1.1.1.1.3.3.2.3.2.cmml">t</mi><mo id="S2.p3.3.m3.1.1.1.1.3.3.2.3.1" xref="S2.p3.3.m3.1.1.1.1.3.3.2.3.1.cmml">+</mo><mn id="S2.p3.3.m3.1.1.1.1.3.3.2.3.3" xref="S2.p3.3.m3.1.1.1.1.3.3.2.3.3.cmml">1</mn></mrow><mi id="S2.p3.3.m3.1.1.1.1.3.3.3" xref="S2.p3.3.m3.1.1.1.1.3.3.3.cmml">u</mi></msubsup><mo id="S2.p3.3.m3.1.1.1.1.4.8" xref="S2.p3.3.m3.1.1.1.1.5.cmml">,</mo><msubsup id="S2.p3.3.m3.1.1.1.1.4.4" xref="S2.p3.3.m3.1.1.1.1.4.4.cmml"><mi id="S2.p3.3.m3.1.1.1.1.4.4.2.2" xref="S2.p3.3.m3.1.1.1.1.4.4.2.2.cmml">r</mi><mi id="S2.p3.3.m3.1.1.1.1.4.4.2.3" xref="S2.p3.3.m3.1.1.1.1.4.4.2.3.cmml">t</mi><mi id="S2.p3.3.m3.1.1.1.1.4.4.3" xref="S2.p3.3.m3.1.1.1.1.4.4.3.cmml">u</mi></msubsup><mo id="S2.p3.3.m3.1.1.1.1.4.9" stretchy="false" xref="S2.p3.3.m3.1.1.1.1.5.cmml">)</mo></mrow><mo id="S2.p3.3.m3.1.1.1.3" stretchy="false" xref="S2.p3.3.m3.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.3.m3.1b"><set id="S2.p3.3.m3.1.1.2.cmml" xref="S2.p3.3.m3.1.1.1"><vector id="S2.p3.3.m3.1.1.1.1.5.cmml" xref="S2.p3.3.m3.1.1.1.1.4"><apply id="S2.p3.3.m3.1.1.1.1.1.1.cmml" xref="S2.p3.3.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p3.3.m3.1.1.1.1.1.1.1.cmml" xref="S2.p3.3.m3.1.1.1.1.1.1">superscript</csymbol><apply id="S2.p3.3.m3.1.1.1.1.1.1.2.cmml" xref="S2.p3.3.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p3.3.m3.1.1.1.1.1.1.2.1.cmml" xref="S2.p3.3.m3.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p3.3.m3.1.1.1.1.1.1.2.2.cmml" xref="S2.p3.3.m3.1.1.1.1.1.1.2.2">𝑠</ci><ci id="S2.p3.3.m3.1.1.1.1.1.1.2.3.cmml" xref="S2.p3.3.m3.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S2.p3.3.m3.1.1.1.1.1.1.3.cmml" xref="S2.p3.3.m3.1.1.1.1.1.1.3">𝑢</ci></apply><apply id="S2.p3.3.m3.1.1.1.1.2.2.cmml" xref="S2.p3.3.m3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.p3.3.m3.1.1.1.1.2.2.1.cmml" xref="S2.p3.3.m3.1.1.1.1.2.2">superscript</csymbol><apply id="S2.p3.3.m3.1.1.1.1.2.2.2.cmml" xref="S2.p3.3.m3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.p3.3.m3.1.1.1.1.2.2.2.1.cmml" xref="S2.p3.3.m3.1.1.1.1.2.2">subscript</csymbol><ci id="S2.p3.3.m3.1.1.1.1.2.2.2.2.cmml" xref="S2.p3.3.m3.1.1.1.1.2.2.2.2">𝑎</ci><ci id="S2.p3.3.m3.1.1.1.1.2.2.2.3.cmml" xref="S2.p3.3.m3.1.1.1.1.2.2.2.3">𝑡</ci></apply><ci id="S2.p3.3.m3.1.1.1.1.2.2.3.cmml" xref="S2.p3.3.m3.1.1.1.1.2.2.3">𝑢</ci></apply><apply id="S2.p3.3.m3.1.1.1.1.3.3.cmml" xref="S2.p3.3.m3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.p3.3.m3.1.1.1.1.3.3.1.cmml" xref="S2.p3.3.m3.1.1.1.1.3.3">superscript</csymbol><apply id="S2.p3.3.m3.1.1.1.1.3.3.2.cmml" xref="S2.p3.3.m3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.p3.3.m3.1.1.1.1.3.3.2.1.cmml" xref="S2.p3.3.m3.1.1.1.1.3.3">subscript</csymbol><ci id="S2.p3.3.m3.1.1.1.1.3.3.2.2.cmml" xref="S2.p3.3.m3.1.1.1.1.3.3.2.2">𝑠</ci><apply id="S2.p3.3.m3.1.1.1.1.3.3.2.3.cmml" xref="S2.p3.3.m3.1.1.1.1.3.3.2.3"><plus id="S2.p3.3.m3.1.1.1.1.3.3.2.3.1.cmml" xref="S2.p3.3.m3.1.1.1.1.3.3.2.3.1"></plus><ci id="S2.p3.3.m3.1.1.1.1.3.3.2.3.2.cmml" xref="S2.p3.3.m3.1.1.1.1.3.3.2.3.2">𝑡</ci><cn id="S2.p3.3.m3.1.1.1.1.3.3.2.3.3.cmml" type="integer" xref="S2.p3.3.m3.1.1.1.1.3.3.2.3.3">1</cn></apply></apply><ci id="S2.p3.3.m3.1.1.1.1.3.3.3.cmml" xref="S2.p3.3.m3.1.1.1.1.3.3.3">𝑢</ci></apply><apply id="S2.p3.3.m3.1.1.1.1.4.4.cmml" xref="S2.p3.3.m3.1.1.1.1.4.4"><csymbol cd="ambiguous" id="S2.p3.3.m3.1.1.1.1.4.4.1.cmml" xref="S2.p3.3.m3.1.1.1.1.4.4">superscript</csymbol><apply id="S2.p3.3.m3.1.1.1.1.4.4.2.cmml" xref="S2.p3.3.m3.1.1.1.1.4.4"><csymbol cd="ambiguous" id="S2.p3.3.m3.1.1.1.1.4.4.2.1.cmml" xref="S2.p3.3.m3.1.1.1.1.4.4">subscript</csymbol><ci id="S2.p3.3.m3.1.1.1.1.4.4.2.2.cmml" xref="S2.p3.3.m3.1.1.1.1.4.4.2.2">𝑟</ci><ci id="S2.p3.3.m3.1.1.1.1.4.4.2.3.cmml" xref="S2.p3.3.m3.1.1.1.1.4.4.2.3">𝑡</ci></apply><ci id="S2.p3.3.m3.1.1.1.1.4.4.3.cmml" xref="S2.p3.3.m3.1.1.1.1.4.4.3">𝑢</ci></apply></vector></set></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.3.m3.1c">\{(s_{t}^{u},a_{t}^{u},s_{t+1}^{u},r_{t}^{u})\}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.3.m3.1d">{ ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) }</annotation></semantics></math>, adhering to the MDP framework <math alttext="(\mathcal{S},\mathcal{A},\mathcal{P},\mathcal{R},\gamma)" class="ltx_Math" display="inline" id="S2.p3.4.m4.5"><semantics id="S2.p3.4.m4.5a"><mrow id="S2.p3.4.m4.5.6.2" xref="S2.p3.4.m4.5.6.1.cmml"><mo id="S2.p3.4.m4.5.6.2.1" stretchy="false" xref="S2.p3.4.m4.5.6.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.p3.4.m4.1.1" xref="S2.p3.4.m4.1.1.cmml">𝒮</mi><mo id="S2.p3.4.m4.5.6.2.2" xref="S2.p3.4.m4.5.6.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.p3.4.m4.2.2" xref="S2.p3.4.m4.2.2.cmml">𝒜</mi><mo id="S2.p3.4.m4.5.6.2.3" xref="S2.p3.4.m4.5.6.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.p3.4.m4.3.3" xref="S2.p3.4.m4.3.3.cmml">𝒫</mi><mo id="S2.p3.4.m4.5.6.2.4" xref="S2.p3.4.m4.5.6.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.p3.4.m4.4.4" xref="S2.p3.4.m4.4.4.cmml">ℛ</mi><mo id="S2.p3.4.m4.5.6.2.5" xref="S2.p3.4.m4.5.6.1.cmml">,</mo><mi id="S2.p3.4.m4.5.5" xref="S2.p3.4.m4.5.5.cmml">γ</mi><mo id="S2.p3.4.m4.5.6.2.6" stretchy="false" xref="S2.p3.4.m4.5.6.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.4.m4.5b"><vector id="S2.p3.4.m4.5.6.1.cmml" xref="S2.p3.4.m4.5.6.2"><ci id="S2.p3.4.m4.1.1.cmml" xref="S2.p3.4.m4.1.1">𝒮</ci><ci id="S2.p3.4.m4.2.2.cmml" xref="S2.p3.4.m4.2.2">𝒜</ci><ci id="S2.p3.4.m4.3.3.cmml" xref="S2.p3.4.m4.3.3">𝒫</ci><ci id="S2.p3.4.m4.4.4.cmml" xref="S2.p3.4.m4.4.4">ℛ</ci><ci id="S2.p3.4.m4.5.5.cmml" xref="S2.p3.4.m4.5.5">𝛾</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.4.m4.5c">(\mathcal{S},\mathcal{A},\mathcal{P},\mathcal{R},\gamma)</annotation><annotation encoding="application/x-llamapun" id="S2.p3.4.m4.5d">( caligraphic_S , caligraphic_A , caligraphic_P , caligraphic_R , italic_γ )</annotation></semantics></math>. For each user <math alttext="u" class="ltx_Math" display="inline" id="S2.p3.5.m5.1"><semantics id="S2.p3.5.m5.1a"><mi id="S2.p3.5.m5.1.1" xref="S2.p3.5.m5.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.p3.5.m5.1b"><ci id="S2.p3.5.m5.1.1.cmml" xref="S2.p3.5.m5.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.5.m5.1c">u</annotation><annotation encoding="application/x-llamapun" id="S2.p3.5.m5.1d">italic_u</annotation></semantics></math> at timestep <math alttext="t" class="ltx_Math" display="inline" id="S2.p3.6.m6.1"><semantics id="S2.p3.6.m6.1a"><mi id="S2.p3.6.m6.1.1" xref="S2.p3.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.p3.6.m6.1b"><ci id="S2.p3.6.m6.1.1.cmml" xref="S2.p3.6.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.6.m6.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.p3.6.m6.1d">italic_t</annotation></semantics></math>, the dataset includes the current state <math alttext="s_{t}^{u}\in\mathcal{S}" class="ltx_Math" display="inline" id="S2.p3.7.m7.1"><semantics id="S2.p3.7.m7.1a"><mrow id="S2.p3.7.m7.1.1" xref="S2.p3.7.m7.1.1.cmml"><msubsup id="S2.p3.7.m7.1.1.2" xref="S2.p3.7.m7.1.1.2.cmml"><mi id="S2.p3.7.m7.1.1.2.2.2" xref="S2.p3.7.m7.1.1.2.2.2.cmml">s</mi><mi id="S2.p3.7.m7.1.1.2.2.3" xref="S2.p3.7.m7.1.1.2.2.3.cmml">t</mi><mi id="S2.p3.7.m7.1.1.2.3" xref="S2.p3.7.m7.1.1.2.3.cmml">u</mi></msubsup><mo id="S2.p3.7.m7.1.1.1" xref="S2.p3.7.m7.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.p3.7.m7.1.1.3" xref="S2.p3.7.m7.1.1.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.7.m7.1b"><apply id="S2.p3.7.m7.1.1.cmml" xref="S2.p3.7.m7.1.1"><in id="S2.p3.7.m7.1.1.1.cmml" xref="S2.p3.7.m7.1.1.1"></in><apply id="S2.p3.7.m7.1.1.2.cmml" xref="S2.p3.7.m7.1.1.2"><csymbol cd="ambiguous" id="S2.p3.7.m7.1.1.2.1.cmml" xref="S2.p3.7.m7.1.1.2">superscript</csymbol><apply id="S2.p3.7.m7.1.1.2.2.cmml" xref="S2.p3.7.m7.1.1.2"><csymbol cd="ambiguous" id="S2.p3.7.m7.1.1.2.2.1.cmml" xref="S2.p3.7.m7.1.1.2">subscript</csymbol><ci id="S2.p3.7.m7.1.1.2.2.2.cmml" xref="S2.p3.7.m7.1.1.2.2.2">𝑠</ci><ci id="S2.p3.7.m7.1.1.2.2.3.cmml" xref="S2.p3.7.m7.1.1.2.2.3">𝑡</ci></apply><ci id="S2.p3.7.m7.1.1.2.3.cmml" xref="S2.p3.7.m7.1.1.2.3">𝑢</ci></apply><ci id="S2.p3.7.m7.1.1.3.cmml" xref="S2.p3.7.m7.1.1.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.7.m7.1c">s_{t}^{u}\in\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.7.m7.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ∈ caligraphic_S</annotation></semantics></math>, the items recommended by the agent via action <math alttext="a_{t}^{u}" class="ltx_Math" display="inline" id="S2.p3.8.m8.1"><semantics id="S2.p3.8.m8.1a"><msubsup id="S2.p3.8.m8.1.1" xref="S2.p3.8.m8.1.1.cmml"><mi id="S2.p3.8.m8.1.1.2.2" xref="S2.p3.8.m8.1.1.2.2.cmml">a</mi><mi id="S2.p3.8.m8.1.1.2.3" xref="S2.p3.8.m8.1.1.2.3.cmml">t</mi><mi id="S2.p3.8.m8.1.1.3" xref="S2.p3.8.m8.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p3.8.m8.1b"><apply id="S2.p3.8.m8.1.1.cmml" xref="S2.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S2.p3.8.m8.1.1.1.cmml" xref="S2.p3.8.m8.1.1">superscript</csymbol><apply id="S2.p3.8.m8.1.1.2.cmml" xref="S2.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S2.p3.8.m8.1.1.2.1.cmml" xref="S2.p3.8.m8.1.1">subscript</csymbol><ci id="S2.p3.8.m8.1.1.2.2.cmml" xref="S2.p3.8.m8.1.1.2.2">𝑎</ci><ci id="S2.p3.8.m8.1.1.2.3.cmml" xref="S2.p3.8.m8.1.1.2.3">𝑡</ci></apply><ci id="S2.p3.8.m8.1.1.3.cmml" xref="S2.p3.8.m8.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.8.m8.1c">a_{t}^{u}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.8.m8.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math>, and the user feedback <math alttext="r_{t}^{u}" class="ltx_Math" display="inline" id="S2.p3.9.m9.1"><semantics id="S2.p3.9.m9.1a"><msubsup id="S2.p3.9.m9.1.1" xref="S2.p3.9.m9.1.1.cmml"><mi id="S2.p3.9.m9.1.1.2.2" xref="S2.p3.9.m9.1.1.2.2.cmml">r</mi><mi id="S2.p3.9.m9.1.1.2.3" xref="S2.p3.9.m9.1.1.2.3.cmml">t</mi><mi id="S2.p3.9.m9.1.1.3" xref="S2.p3.9.m9.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p3.9.m9.1b"><apply id="S2.p3.9.m9.1.1.cmml" xref="S2.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S2.p3.9.m9.1.1.1.cmml" xref="S2.p3.9.m9.1.1">superscript</csymbol><apply id="S2.p3.9.m9.1.1.2.cmml" xref="S2.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S2.p3.9.m9.1.1.2.1.cmml" xref="S2.p3.9.m9.1.1">subscript</csymbol><ci id="S2.p3.9.m9.1.1.2.2.cmml" xref="S2.p3.9.m9.1.1.2.2">𝑟</ci><ci id="S2.p3.9.m9.1.1.2.3.cmml" xref="S2.p3.9.m9.1.1.2.3">𝑡</ci></apply><ci id="S2.p3.9.m9.1.1.3.cmml" xref="S2.p3.9.m9.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.9.m9.1c">r_{t}^{u}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.9.m9.1d">italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Related Work</h2>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.1"><span class="ltx_text ltx_font_bold" id="S3.p1.1.1">RL-based Recommender Systems.</span>
Reinforcement learning-based recommendation methods approach the interactive process of making recommendations as a MDP <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib10" title="">2023b</a>)</cite>. This approach can be categorized into two primary branches: model-based and model-free methods. In the realm of model-based techniques, <cite class="ltx_cite ltx_citemacro_citet">Bai et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib2" title="">2019</a>)</cite> introduced a method employing generative adversarial training to simultaneously learn the user behavior model and update the recommendation policy. Recently, there has been a noticeable shift in the literature towards embracing model-free techniques for reinforcement learning-based recommendations. Notably, <cite class="ltx_cite ltx_citemacro_citet">Zheng et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib29" title="">2018</a>)</cite> pioneered the introduction of RL to enhance news recommender systems, and <cite class="ltx_cite ltx_citemacro_citet">Zhao et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib28" title="">2018</a>)</cite> further extended its application to the page-wise recommendation scenario.
Both of these approaches employ Deep Q-Networks (DQN) <cite class="ltx_cite ltx_citemacro_citep">(Mnih et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib21" title="">2013</a>)</cite> to encode user and item information, effectively improving the quality of news recommendations. Moreover, <cite class="ltx_cite ltx_citemacro_citet">Chen et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib7" title="">2020</a>)</cite> incorporated knowledge graphs into the reinforcement learning framework, resulting in enhanced decision-making efficiency. Additionally, <cite class="ltx_cite ltx_citemacro_citet">Chen et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib11" title="">2021b</a>)</cite> introduced a novel generative inverse reinforcement learning approach for online recommendations. This method autonomously extracts a reward function from user behavior, further advancing state-of-the-art in online recommendation systems.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p2">
<p class="ltx_p" id="S3.p2.1"><span class="ltx_text ltx_font_bold" id="S3.p2.1.1">Offline RL in RS.</span>
Recent studies have started exploring the prospect of integrating offline RLRS <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib8" title="">2023a</a>)</cite>. Notably, <cite class="ltx_cite ltx_citemacro_citet">Wang et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib25" title="">2023</a>)</cite> introduced a novel model called the Causal Decision Transformer for RS (CDT4Rec). This model incorporates a causal mechanism designed to estimate the reward function, offering promising insights into the offline RL-RS synergy. Similarly, <cite class="ltx_cite ltx_citemacro_citet">Zhao et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib27" title="">2023</a>)</cite> introduced the Decision Transformer for RS (DT4Rec), utilizing the vanilla Decision Transformer as its core architecture to provide recommendations, demonstrating its potential in the field.
Furthermore, <cite class="ltx_cite ltx_citemacro_citet">Gao et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib13" title="">2023</a>)</cite> delved into the examination of the Matthew effect within offline RL in Recommender Systems. This work contributes to our understanding of how offline RLRS can mitigate or address this phenomenon.</p>
</div>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Methodology</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Decision Transformer and Overall Model Architecture</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.13">In this work, we proposed a max-Entropy enhanced Decision Transformer with reward relabeling for offline RLRS(EDT4Rec).
Our proposed EDT4Rec leverages the DT framework <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib5" title="">2021a</a>)</cite>, a pivotal element in recent advancements in offline RLRS, as seen in works like <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib25" title="">2023</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib8" title="">2023a</a>; Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib27" title="">2023</a>)</cite>
The Decision Transformer processes a trajectory, denoted as <math alttext="\tau" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_τ</annotation></semantics></math>, by treating it as a sequence comprising three distinct types of input: return-to-go (RTG), states, and actions, represented as <math alttext="(g_{1},s_{1},a_{1},\cdots,g_{|\tau|},s_{|\tau|},a_{|\tau|})" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.10"><semantics id="S4.SS1.p1.2.m2.10a"><mrow id="S4.SS1.p1.2.m2.10.10.6" xref="S4.SS1.p1.2.m2.10.10.7.cmml"><mo id="S4.SS1.p1.2.m2.10.10.6.7" stretchy="false" xref="S4.SS1.p1.2.m2.10.10.7.cmml">(</mo><msub id="S4.SS1.p1.2.m2.5.5.1.1" xref="S4.SS1.p1.2.m2.5.5.1.1.cmml"><mi id="S4.SS1.p1.2.m2.5.5.1.1.2" xref="S4.SS1.p1.2.m2.5.5.1.1.2.cmml">g</mi><mn id="S4.SS1.p1.2.m2.5.5.1.1.3" xref="S4.SS1.p1.2.m2.5.5.1.1.3.cmml">1</mn></msub><mo id="S4.SS1.p1.2.m2.10.10.6.8" xref="S4.SS1.p1.2.m2.10.10.7.cmml">,</mo><msub id="S4.SS1.p1.2.m2.6.6.2.2" xref="S4.SS1.p1.2.m2.6.6.2.2.cmml"><mi id="S4.SS1.p1.2.m2.6.6.2.2.2" xref="S4.SS1.p1.2.m2.6.6.2.2.2.cmml">s</mi><mn id="S4.SS1.p1.2.m2.6.6.2.2.3" xref="S4.SS1.p1.2.m2.6.6.2.2.3.cmml">1</mn></msub><mo id="S4.SS1.p1.2.m2.10.10.6.9" xref="S4.SS1.p1.2.m2.10.10.7.cmml">,</mo><msub id="S4.SS1.p1.2.m2.7.7.3.3" xref="S4.SS1.p1.2.m2.7.7.3.3.cmml"><mi id="S4.SS1.p1.2.m2.7.7.3.3.2" xref="S4.SS1.p1.2.m2.7.7.3.3.2.cmml">a</mi><mn id="S4.SS1.p1.2.m2.7.7.3.3.3" xref="S4.SS1.p1.2.m2.7.7.3.3.3.cmml">1</mn></msub><mo id="S4.SS1.p1.2.m2.10.10.6.10" xref="S4.SS1.p1.2.m2.10.10.7.cmml">,</mo><mi id="S4.SS1.p1.2.m2.4.4" mathvariant="normal" xref="S4.SS1.p1.2.m2.4.4.cmml">⋯</mi><mo id="S4.SS1.p1.2.m2.10.10.6.11" xref="S4.SS1.p1.2.m2.10.10.7.cmml">,</mo><msub id="S4.SS1.p1.2.m2.8.8.4.4" xref="S4.SS1.p1.2.m2.8.8.4.4.cmml"><mi id="S4.SS1.p1.2.m2.8.8.4.4.2" xref="S4.SS1.p1.2.m2.8.8.4.4.2.cmml">g</mi><mrow id="S4.SS1.p1.2.m2.1.1.1.3" xref="S4.SS1.p1.2.m2.1.1.1.2.cmml"><mo id="S4.SS1.p1.2.m2.1.1.1.3.1" stretchy="false" xref="S4.SS1.p1.2.m2.1.1.1.2.1.cmml">|</mo><mi id="S4.SS1.p1.2.m2.1.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.1.cmml">τ</mi><mo id="S4.SS1.p1.2.m2.1.1.1.3.2" stretchy="false" xref="S4.SS1.p1.2.m2.1.1.1.2.1.cmml">|</mo></mrow></msub><mo id="S4.SS1.p1.2.m2.10.10.6.12" xref="S4.SS1.p1.2.m2.10.10.7.cmml">,</mo><msub id="S4.SS1.p1.2.m2.9.9.5.5" xref="S4.SS1.p1.2.m2.9.9.5.5.cmml"><mi id="S4.SS1.p1.2.m2.9.9.5.5.2" xref="S4.SS1.p1.2.m2.9.9.5.5.2.cmml">s</mi><mrow id="S4.SS1.p1.2.m2.2.2.1.3" xref="S4.SS1.p1.2.m2.2.2.1.2.cmml"><mo id="S4.SS1.p1.2.m2.2.2.1.3.1" stretchy="false" xref="S4.SS1.p1.2.m2.2.2.1.2.1.cmml">|</mo><mi id="S4.SS1.p1.2.m2.2.2.1.1" xref="S4.SS1.p1.2.m2.2.2.1.1.cmml">τ</mi><mo id="S4.SS1.p1.2.m2.2.2.1.3.2" stretchy="false" xref="S4.SS1.p1.2.m2.2.2.1.2.1.cmml">|</mo></mrow></msub><mo id="S4.SS1.p1.2.m2.10.10.6.13" xref="S4.SS1.p1.2.m2.10.10.7.cmml">,</mo><msub id="S4.SS1.p1.2.m2.10.10.6.6" xref="S4.SS1.p1.2.m2.10.10.6.6.cmml"><mi id="S4.SS1.p1.2.m2.10.10.6.6.2" xref="S4.SS1.p1.2.m2.10.10.6.6.2.cmml">a</mi><mrow id="S4.SS1.p1.2.m2.3.3.1.3" xref="S4.SS1.p1.2.m2.3.3.1.2.cmml"><mo id="S4.SS1.p1.2.m2.3.3.1.3.1" stretchy="false" xref="S4.SS1.p1.2.m2.3.3.1.2.1.cmml">|</mo><mi id="S4.SS1.p1.2.m2.3.3.1.1" xref="S4.SS1.p1.2.m2.3.3.1.1.cmml">τ</mi><mo id="S4.SS1.p1.2.m2.3.3.1.3.2" stretchy="false" xref="S4.SS1.p1.2.m2.3.3.1.2.1.cmml">|</mo></mrow></msub><mo id="S4.SS1.p1.2.m2.10.10.6.14" stretchy="false" xref="S4.SS1.p1.2.m2.10.10.7.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.10b"><vector id="S4.SS1.p1.2.m2.10.10.7.cmml" xref="S4.SS1.p1.2.m2.10.10.6"><apply id="S4.SS1.p1.2.m2.5.5.1.1.cmml" xref="S4.SS1.p1.2.m2.5.5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.5.5.1.1.1.cmml" xref="S4.SS1.p1.2.m2.5.5.1.1">subscript</csymbol><ci id="S4.SS1.p1.2.m2.5.5.1.1.2.cmml" xref="S4.SS1.p1.2.m2.5.5.1.1.2">𝑔</ci><cn id="S4.SS1.p1.2.m2.5.5.1.1.3.cmml" type="integer" xref="S4.SS1.p1.2.m2.5.5.1.1.3">1</cn></apply><apply id="S4.SS1.p1.2.m2.6.6.2.2.cmml" xref="S4.SS1.p1.2.m2.6.6.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.6.6.2.2.1.cmml" xref="S4.SS1.p1.2.m2.6.6.2.2">subscript</csymbol><ci id="S4.SS1.p1.2.m2.6.6.2.2.2.cmml" xref="S4.SS1.p1.2.m2.6.6.2.2.2">𝑠</ci><cn id="S4.SS1.p1.2.m2.6.6.2.2.3.cmml" type="integer" xref="S4.SS1.p1.2.m2.6.6.2.2.3">1</cn></apply><apply id="S4.SS1.p1.2.m2.7.7.3.3.cmml" xref="S4.SS1.p1.2.m2.7.7.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.7.7.3.3.1.cmml" xref="S4.SS1.p1.2.m2.7.7.3.3">subscript</csymbol><ci id="S4.SS1.p1.2.m2.7.7.3.3.2.cmml" xref="S4.SS1.p1.2.m2.7.7.3.3.2">𝑎</ci><cn id="S4.SS1.p1.2.m2.7.7.3.3.3.cmml" type="integer" xref="S4.SS1.p1.2.m2.7.7.3.3.3">1</cn></apply><ci id="S4.SS1.p1.2.m2.4.4.cmml" xref="S4.SS1.p1.2.m2.4.4">⋯</ci><apply id="S4.SS1.p1.2.m2.8.8.4.4.cmml" xref="S4.SS1.p1.2.m2.8.8.4.4"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.8.8.4.4.1.cmml" xref="S4.SS1.p1.2.m2.8.8.4.4">subscript</csymbol><ci id="S4.SS1.p1.2.m2.8.8.4.4.2.cmml" xref="S4.SS1.p1.2.m2.8.8.4.4.2">𝑔</ci><apply id="S4.SS1.p1.2.m2.1.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.1.3"><abs id="S4.SS1.p1.2.m2.1.1.1.2.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1.3.1"></abs><ci id="S4.SS1.p1.2.m2.1.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1">𝜏</ci></apply></apply><apply id="S4.SS1.p1.2.m2.9.9.5.5.cmml" xref="S4.SS1.p1.2.m2.9.9.5.5"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.9.9.5.5.1.cmml" xref="S4.SS1.p1.2.m2.9.9.5.5">subscript</csymbol><ci id="S4.SS1.p1.2.m2.9.9.5.5.2.cmml" xref="S4.SS1.p1.2.m2.9.9.5.5.2">𝑠</ci><apply id="S4.SS1.p1.2.m2.2.2.1.2.cmml" xref="S4.SS1.p1.2.m2.2.2.1.3"><abs id="S4.SS1.p1.2.m2.2.2.1.2.1.cmml" xref="S4.SS1.p1.2.m2.2.2.1.3.1"></abs><ci id="S4.SS1.p1.2.m2.2.2.1.1.cmml" xref="S4.SS1.p1.2.m2.2.2.1.1">𝜏</ci></apply></apply><apply id="S4.SS1.p1.2.m2.10.10.6.6.cmml" xref="S4.SS1.p1.2.m2.10.10.6.6"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.10.10.6.6.1.cmml" xref="S4.SS1.p1.2.m2.10.10.6.6">subscript</csymbol><ci id="S4.SS1.p1.2.m2.10.10.6.6.2.cmml" xref="S4.SS1.p1.2.m2.10.10.6.6.2">𝑎</ci><apply id="S4.SS1.p1.2.m2.3.3.1.2.cmml" xref="S4.SS1.p1.2.m2.3.3.1.3"><abs id="S4.SS1.p1.2.m2.3.3.1.2.1.cmml" xref="S4.SS1.p1.2.m2.3.3.1.3.1"></abs><ci id="S4.SS1.p1.2.m2.3.3.1.1.cmml" xref="S4.SS1.p1.2.m2.3.3.1.1">𝜏</ci></apply></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.10c">(g_{1},s_{1},a_{1},\cdots,g_{|\tau|},s_{|\tau|},a_{|\tau|})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.10d">( italic_g start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ⋯ , italic_g start_POSTSUBSCRIPT | italic_τ | end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT | italic_τ | end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT | italic_τ | end_POSTSUBSCRIPT )</annotation></semantics></math>. Specifically, the initial RTG <math alttext="R_{1}" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1"><semantics id="S4.SS1.p1.3.m3.1a"><msub id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml"><mi id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml">R</mi><mn id="S4.SS1.p1.3.m3.1.1.3" xref="S4.SS1.p1.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2">𝑅</ci><cn id="S4.SS1.p1.3.m3.1.1.3.cmml" type="integer" xref="S4.SS1.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">R_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.1d">italic_R start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, corresponds to the trajectory’s total return, calculated as <math alttext="\sum_{i=0}^{|\tau|}r_{i}" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.1"><semantics id="S4.SS1.p1.4.m4.1a"><mrow id="S4.SS1.p1.4.m4.1.2" xref="S4.SS1.p1.4.m4.1.2.cmml"><msubsup id="S4.SS1.p1.4.m4.1.2.1" xref="S4.SS1.p1.4.m4.1.2.1.cmml"><mo id="S4.SS1.p1.4.m4.1.2.1.2.2" xref="S4.SS1.p1.4.m4.1.2.1.2.2.cmml">∑</mo><mrow id="S4.SS1.p1.4.m4.1.2.1.2.3" xref="S4.SS1.p1.4.m4.1.2.1.2.3.cmml"><mi id="S4.SS1.p1.4.m4.1.2.1.2.3.2" xref="S4.SS1.p1.4.m4.1.2.1.2.3.2.cmml">i</mi><mo id="S4.SS1.p1.4.m4.1.2.1.2.3.1" xref="S4.SS1.p1.4.m4.1.2.1.2.3.1.cmml">=</mo><mn id="S4.SS1.p1.4.m4.1.2.1.2.3.3" xref="S4.SS1.p1.4.m4.1.2.1.2.3.3.cmml">0</mn></mrow><mrow id="S4.SS1.p1.4.m4.1.1.1.3" xref="S4.SS1.p1.4.m4.1.1.1.2.cmml"><mo id="S4.SS1.p1.4.m4.1.1.1.3.1" stretchy="false" xref="S4.SS1.p1.4.m4.1.1.1.2.1.cmml">|</mo><mi id="S4.SS1.p1.4.m4.1.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.1.cmml">τ</mi><mo id="S4.SS1.p1.4.m4.1.1.1.3.2" stretchy="false" xref="S4.SS1.p1.4.m4.1.1.1.2.1.cmml">|</mo></mrow></msubsup><msub id="S4.SS1.p1.4.m4.1.2.2" xref="S4.SS1.p1.4.m4.1.2.2.cmml"><mi id="S4.SS1.p1.4.m4.1.2.2.2" xref="S4.SS1.p1.4.m4.1.2.2.2.cmml">r</mi><mi id="S4.SS1.p1.4.m4.1.2.2.3" xref="S4.SS1.p1.4.m4.1.2.2.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.2.cmml" xref="S4.SS1.p1.4.m4.1.2"><apply id="S4.SS1.p1.4.m4.1.2.1.cmml" xref="S4.SS1.p1.4.m4.1.2.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.2.1.1.cmml" xref="S4.SS1.p1.4.m4.1.2.1">superscript</csymbol><apply id="S4.SS1.p1.4.m4.1.2.1.2.cmml" xref="S4.SS1.p1.4.m4.1.2.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.2.1.2.1.cmml" xref="S4.SS1.p1.4.m4.1.2.1">subscript</csymbol><sum id="S4.SS1.p1.4.m4.1.2.1.2.2.cmml" xref="S4.SS1.p1.4.m4.1.2.1.2.2"></sum><apply id="S4.SS1.p1.4.m4.1.2.1.2.3.cmml" xref="S4.SS1.p1.4.m4.1.2.1.2.3"><eq id="S4.SS1.p1.4.m4.1.2.1.2.3.1.cmml" xref="S4.SS1.p1.4.m4.1.2.1.2.3.1"></eq><ci id="S4.SS1.p1.4.m4.1.2.1.2.3.2.cmml" xref="S4.SS1.p1.4.m4.1.2.1.2.3.2">𝑖</ci><cn id="S4.SS1.p1.4.m4.1.2.1.2.3.3.cmml" type="integer" xref="S4.SS1.p1.4.m4.1.2.1.2.3.3">0</cn></apply></apply><apply id="S4.SS1.p1.4.m4.1.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.1.3"><abs id="S4.SS1.p1.4.m4.1.1.1.2.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.3.1"></abs><ci id="S4.SS1.p1.4.m4.1.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1">𝜏</ci></apply></apply><apply id="S4.SS1.p1.4.m4.1.2.2.cmml" xref="S4.SS1.p1.4.m4.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.2.2.1.cmml" xref="S4.SS1.p1.4.m4.1.2.2">subscript</csymbol><ci id="S4.SS1.p1.4.m4.1.2.2.2.cmml" xref="S4.SS1.p1.4.m4.1.2.2.2">𝑟</ci><ci id="S4.SS1.p1.4.m4.1.2.2.3.cmml" xref="S4.SS1.p1.4.m4.1.2.2.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">\sum_{i=0}^{|\tau|}r_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.1d">∑ start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_τ | end_POSTSUPERSCRIPT italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. At each timestep <math alttext="t" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m5.1"><semantics id="S4.SS1.p1.5.m5.1a"><mi id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><ci id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m5.1d">italic_t</annotation></semantics></math>, DT utilizes tokens from the most recent <math alttext="K" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m6.1"><semantics id="S4.SS1.p1.6.m6.1a"><mi id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><ci id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.6.m6.1d">italic_K</annotation></semantics></math> timesteps to generate an action <math alttext="a_{t}" class="ltx_Math" display="inline" id="S4.SS1.p1.7.m7.1"><semantics id="S4.SS1.p1.7.m7.1a"><msub id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml"><mi id="S4.SS1.p1.7.m7.1.1.2" xref="S4.SS1.p1.7.m7.1.1.2.cmml">a</mi><mi id="S4.SS1.p1.7.m7.1.1.3" xref="S4.SS1.p1.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><apply id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.p1.7.m7.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.2">𝑎</ci><ci id="S4.SS1.p1.7.m7.1.1.3.cmml" xref="S4.SS1.p1.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.7.m7.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. This <math alttext="K" class="ltx_Math" display="inline" id="S4.SS1.p1.8.m8.1"><semantics id="S4.SS1.p1.8.m8.1a"><mi id="S4.SS1.p1.8.m8.1.1" xref="S4.SS1.p1.8.m8.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m8.1b"><ci id="S4.SS1.p1.8.m8.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.8.m8.1d">italic_K</annotation></semantics></math> is a hyperparameter, defines the context length the transformer uses for its computations. The deterministic policy learned by DT, denoted as <math alttext="\pi_{DT}(a_{t}|\textbf{s}_{K,t},\textbf{g}_{K,t})" class="ltx_Math" display="inline" id="S4.SS1.p1.9.m9.5"><semantics id="S4.SS1.p1.9.m9.5a"><mrow id="S4.SS1.p1.9.m9.5.5" xref="S4.SS1.p1.9.m9.5.5.cmml"><msub id="S4.SS1.p1.9.m9.5.5.3" xref="S4.SS1.p1.9.m9.5.5.3.cmml"><mi id="S4.SS1.p1.9.m9.5.5.3.2" xref="S4.SS1.p1.9.m9.5.5.3.2.cmml">π</mi><mrow id="S4.SS1.p1.9.m9.5.5.3.3" xref="S4.SS1.p1.9.m9.5.5.3.3.cmml"><mi id="S4.SS1.p1.9.m9.5.5.3.3.2" xref="S4.SS1.p1.9.m9.5.5.3.3.2.cmml">D</mi><mo id="S4.SS1.p1.9.m9.5.5.3.3.1" xref="S4.SS1.p1.9.m9.5.5.3.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.9.m9.5.5.3.3.3" xref="S4.SS1.p1.9.m9.5.5.3.3.3.cmml">T</mi></mrow></msub><mo id="S4.SS1.p1.9.m9.5.5.2" xref="S4.SS1.p1.9.m9.5.5.2.cmml">⁢</mo><mrow id="S4.SS1.p1.9.m9.5.5.1.1" xref="S4.SS1.p1.9.m9.5.5.1.1.1.cmml"><mo id="S4.SS1.p1.9.m9.5.5.1.1.2" stretchy="false" xref="S4.SS1.p1.9.m9.5.5.1.1.1.cmml">(</mo><mrow id="S4.SS1.p1.9.m9.5.5.1.1.1" xref="S4.SS1.p1.9.m9.5.5.1.1.1.cmml"><msub id="S4.SS1.p1.9.m9.5.5.1.1.1.4" xref="S4.SS1.p1.9.m9.5.5.1.1.1.4.cmml"><mi id="S4.SS1.p1.9.m9.5.5.1.1.1.4.2" xref="S4.SS1.p1.9.m9.5.5.1.1.1.4.2.cmml">a</mi><mi id="S4.SS1.p1.9.m9.5.5.1.1.1.4.3" xref="S4.SS1.p1.9.m9.5.5.1.1.1.4.3.cmml">t</mi></msub><mo fence="false" id="S4.SS1.p1.9.m9.5.5.1.1.1.3" xref="S4.SS1.p1.9.m9.5.5.1.1.1.3.cmml">|</mo><mrow id="S4.SS1.p1.9.m9.5.5.1.1.1.2.2" xref="S4.SS1.p1.9.m9.5.5.1.1.1.2.3.cmml"><msub id="S4.SS1.p1.9.m9.5.5.1.1.1.1.1.1" xref="S4.SS1.p1.9.m9.5.5.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS1.p1.9.m9.5.5.1.1.1.1.1.1.2" xref="S4.SS1.p1.9.m9.5.5.1.1.1.1.1.1.2a.cmml">s</mtext><mrow id="S4.SS1.p1.9.m9.2.2.2.4" xref="S4.SS1.p1.9.m9.2.2.2.3.cmml"><mi id="S4.SS1.p1.9.m9.1.1.1.1" xref="S4.SS1.p1.9.m9.1.1.1.1.cmml">K</mi><mo id="S4.SS1.p1.9.m9.2.2.2.4.1" xref="S4.SS1.p1.9.m9.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p1.9.m9.2.2.2.2" xref="S4.SS1.p1.9.m9.2.2.2.2.cmml">t</mi></mrow></msub><mo id="S4.SS1.p1.9.m9.5.5.1.1.1.2.2.3" xref="S4.SS1.p1.9.m9.5.5.1.1.1.2.3.cmml">,</mo><msub id="S4.SS1.p1.9.m9.5.5.1.1.1.2.2.2" xref="S4.SS1.p1.9.m9.5.5.1.1.1.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS1.p1.9.m9.5.5.1.1.1.2.2.2.2" xref="S4.SS1.p1.9.m9.5.5.1.1.1.2.2.2.2a.cmml">g</mtext><mrow id="S4.SS1.p1.9.m9.4.4.2.4" xref="S4.SS1.p1.9.m9.4.4.2.3.cmml"><mi id="S4.SS1.p1.9.m9.3.3.1.1" xref="S4.SS1.p1.9.m9.3.3.1.1.cmml">K</mi><mo id="S4.SS1.p1.9.m9.4.4.2.4.1" xref="S4.SS1.p1.9.m9.4.4.2.3.cmml">,</mo><mi id="S4.SS1.p1.9.m9.4.4.2.2" xref="S4.SS1.p1.9.m9.4.4.2.2.cmml">t</mi></mrow></msub></mrow></mrow><mo id="S4.SS1.p1.9.m9.5.5.1.1.3" stretchy="false" xref="S4.SS1.p1.9.m9.5.5.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m9.5b"><apply id="S4.SS1.p1.9.m9.5.5.cmml" xref="S4.SS1.p1.9.m9.5.5"><times id="S4.SS1.p1.9.m9.5.5.2.cmml" xref="S4.SS1.p1.9.m9.5.5.2"></times><apply id="S4.SS1.p1.9.m9.5.5.3.cmml" xref="S4.SS1.p1.9.m9.5.5.3"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m9.5.5.3.1.cmml" xref="S4.SS1.p1.9.m9.5.5.3">subscript</csymbol><ci id="S4.SS1.p1.9.m9.5.5.3.2.cmml" xref="S4.SS1.p1.9.m9.5.5.3.2">𝜋</ci><apply id="S4.SS1.p1.9.m9.5.5.3.3.cmml" xref="S4.SS1.p1.9.m9.5.5.3.3"><times id="S4.SS1.p1.9.m9.5.5.3.3.1.cmml" xref="S4.SS1.p1.9.m9.5.5.3.3.1"></times><ci id="S4.SS1.p1.9.m9.5.5.3.3.2.cmml" xref="S4.SS1.p1.9.m9.5.5.3.3.2">𝐷</ci><ci id="S4.SS1.p1.9.m9.5.5.3.3.3.cmml" xref="S4.SS1.p1.9.m9.5.5.3.3.3">𝑇</ci></apply></apply><apply id="S4.SS1.p1.9.m9.5.5.1.1.1.cmml" xref="S4.SS1.p1.9.m9.5.5.1.1"><csymbol cd="latexml" id="S4.SS1.p1.9.m9.5.5.1.1.1.3.cmml" xref="S4.SS1.p1.9.m9.5.5.1.1.1.3">conditional</csymbol><apply id="S4.SS1.p1.9.m9.5.5.1.1.1.4.cmml" xref="S4.SS1.p1.9.m9.5.5.1.1.1.4"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m9.5.5.1.1.1.4.1.cmml" xref="S4.SS1.p1.9.m9.5.5.1.1.1.4">subscript</csymbol><ci id="S4.SS1.p1.9.m9.5.5.1.1.1.4.2.cmml" xref="S4.SS1.p1.9.m9.5.5.1.1.1.4.2">𝑎</ci><ci id="S4.SS1.p1.9.m9.5.5.1.1.1.4.3.cmml" xref="S4.SS1.p1.9.m9.5.5.1.1.1.4.3">𝑡</ci></apply><list id="S4.SS1.p1.9.m9.5.5.1.1.1.2.3.cmml" xref="S4.SS1.p1.9.m9.5.5.1.1.1.2.2"><apply id="S4.SS1.p1.9.m9.5.5.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.9.m9.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m9.5.5.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.9.m9.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.9.m9.5.5.1.1.1.1.1.1.2a.cmml" xref="S4.SS1.p1.9.m9.5.5.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS1.p1.9.m9.5.5.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.9.m9.5.5.1.1.1.1.1.1.2">s</mtext></ci><list id="S4.SS1.p1.9.m9.2.2.2.3.cmml" xref="S4.SS1.p1.9.m9.2.2.2.4"><ci id="S4.SS1.p1.9.m9.1.1.1.1.cmml" xref="S4.SS1.p1.9.m9.1.1.1.1">𝐾</ci><ci id="S4.SS1.p1.9.m9.2.2.2.2.cmml" xref="S4.SS1.p1.9.m9.2.2.2.2">𝑡</ci></list></apply><apply id="S4.SS1.p1.9.m9.5.5.1.1.1.2.2.2.cmml" xref="S4.SS1.p1.9.m9.5.5.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m9.5.5.1.1.1.2.2.2.1.cmml" xref="S4.SS1.p1.9.m9.5.5.1.1.1.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.9.m9.5.5.1.1.1.2.2.2.2a.cmml" xref="S4.SS1.p1.9.m9.5.5.1.1.1.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.SS1.p1.9.m9.5.5.1.1.1.2.2.2.2.cmml" xref="S4.SS1.p1.9.m9.5.5.1.1.1.2.2.2.2">g</mtext></ci><list id="S4.SS1.p1.9.m9.4.4.2.3.cmml" xref="S4.SS1.p1.9.m9.4.4.2.4"><ci id="S4.SS1.p1.9.m9.3.3.1.1.cmml" xref="S4.SS1.p1.9.m9.3.3.1.1">𝐾</ci><ci id="S4.SS1.p1.9.m9.4.4.2.2.cmml" xref="S4.SS1.p1.9.m9.4.4.2.2">𝑡</ci></list></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m9.5c">\pi_{DT}(a_{t}|\textbf{s}_{K,t},\textbf{g}_{K,t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.9.m9.5d">italic_π start_POSTSUBSCRIPT italic_D italic_T end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | s start_POSTSUBSCRIPT italic_K , italic_t end_POSTSUBSCRIPT , g start_POSTSUBSCRIPT italic_K , italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="\textbf{s}_{K,t}" class="ltx_Math" display="inline" id="S4.SS1.p1.10.m10.2"><semantics id="S4.SS1.p1.10.m10.2a"><msub id="S4.SS1.p1.10.m10.2.3" xref="S4.SS1.p1.10.m10.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS1.p1.10.m10.2.3.2" xref="S4.SS1.p1.10.m10.2.3.2a.cmml">s</mtext><mrow id="S4.SS1.p1.10.m10.2.2.2.4" xref="S4.SS1.p1.10.m10.2.2.2.3.cmml"><mi id="S4.SS1.p1.10.m10.1.1.1.1" xref="S4.SS1.p1.10.m10.1.1.1.1.cmml">K</mi><mo id="S4.SS1.p1.10.m10.2.2.2.4.1" xref="S4.SS1.p1.10.m10.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p1.10.m10.2.2.2.2" xref="S4.SS1.p1.10.m10.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m10.2b"><apply id="S4.SS1.p1.10.m10.2.3.cmml" xref="S4.SS1.p1.10.m10.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.2.3.1.cmml" xref="S4.SS1.p1.10.m10.2.3">subscript</csymbol><ci id="S4.SS1.p1.10.m10.2.3.2a.cmml" xref="S4.SS1.p1.10.m10.2.3.2"><mtext class="ltx_mathvariant_bold" id="S4.SS1.p1.10.m10.2.3.2.cmml" xref="S4.SS1.p1.10.m10.2.3.2">s</mtext></ci><list id="S4.SS1.p1.10.m10.2.2.2.3.cmml" xref="S4.SS1.p1.10.m10.2.2.2.4"><ci id="S4.SS1.p1.10.m10.1.1.1.1.cmml" xref="S4.SS1.p1.10.m10.1.1.1.1">𝐾</ci><ci id="S4.SS1.p1.10.m10.2.2.2.2.cmml" xref="S4.SS1.p1.10.m10.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.10.m10.2c">\textbf{s}_{K,t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.10.m10.2d">s start_POSTSUBSCRIPT italic_K , italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is shorthand for the sequence of <math alttext="K" class="ltx_Math" display="inline" id="S4.SS1.p1.11.m11.1"><semantics id="S4.SS1.p1.11.m11.1a"><mi id="S4.SS1.p1.11.m11.1.1" xref="S4.SS1.p1.11.m11.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.11.m11.1b"><ci id="S4.SS1.p1.11.m11.1.1.cmml" xref="S4.SS1.p1.11.m11.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.11.m11.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.11.m11.1d">italic_K</annotation></semantics></math> past states <math alttext="\textbf{s}_{\max(1,t-K+1):t}" class="ltx_Math" display="inline" id="S4.SS1.p1.12.m12.3"><semantics id="S4.SS1.p1.12.m12.3a"><msub id="S4.SS1.p1.12.m12.3.4" xref="S4.SS1.p1.12.m12.3.4.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS1.p1.12.m12.3.4.2" xref="S4.SS1.p1.12.m12.3.4.2a.cmml">s</mtext><mrow id="S4.SS1.p1.12.m12.3.3.3" xref="S4.SS1.p1.12.m12.3.3.3.cmml"><mrow id="S4.SS1.p1.12.m12.3.3.3.3.1" xref="S4.SS1.p1.12.m12.3.3.3.3.2.cmml"><mi id="S4.SS1.p1.12.m12.1.1.1.1" xref="S4.SS1.p1.12.m12.1.1.1.1.cmml">max</mi><mo id="S4.SS1.p1.12.m12.3.3.3.3.1a" xref="S4.SS1.p1.12.m12.3.3.3.3.2.cmml">⁡</mo><mrow id="S4.SS1.p1.12.m12.3.3.3.3.1.1" xref="S4.SS1.p1.12.m12.3.3.3.3.2.cmml"><mo id="S4.SS1.p1.12.m12.3.3.3.3.1.1.2" stretchy="false" xref="S4.SS1.p1.12.m12.3.3.3.3.2.cmml">(</mo><mn id="S4.SS1.p1.12.m12.2.2.2.2" xref="S4.SS1.p1.12.m12.2.2.2.2.cmml">1</mn><mo id="S4.SS1.p1.12.m12.3.3.3.3.1.1.3" xref="S4.SS1.p1.12.m12.3.3.3.3.2.cmml">,</mo><mrow id="S4.SS1.p1.12.m12.3.3.3.3.1.1.1" xref="S4.SS1.p1.12.m12.3.3.3.3.1.1.1.cmml"><mrow id="S4.SS1.p1.12.m12.3.3.3.3.1.1.1.2" xref="S4.SS1.p1.12.m12.3.3.3.3.1.1.1.2.cmml"><mi id="S4.SS1.p1.12.m12.3.3.3.3.1.1.1.2.2" xref="S4.SS1.p1.12.m12.3.3.3.3.1.1.1.2.2.cmml">t</mi><mo id="S4.SS1.p1.12.m12.3.3.3.3.1.1.1.2.1" xref="S4.SS1.p1.12.m12.3.3.3.3.1.1.1.2.1.cmml">−</mo><mi id="S4.SS1.p1.12.m12.3.3.3.3.1.1.1.2.3" xref="S4.SS1.p1.12.m12.3.3.3.3.1.1.1.2.3.cmml">K</mi></mrow><mo id="S4.SS1.p1.12.m12.3.3.3.3.1.1.1.1" xref="S4.SS1.p1.12.m12.3.3.3.3.1.1.1.1.cmml">+</mo><mn id="S4.SS1.p1.12.m12.3.3.3.3.1.1.1.3" xref="S4.SS1.p1.12.m12.3.3.3.3.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS1.p1.12.m12.3.3.3.3.1.1.4" rspace="0.278em" stretchy="false" xref="S4.SS1.p1.12.m12.3.3.3.3.2.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p1.12.m12.3.3.3.4" rspace="0.278em" xref="S4.SS1.p1.12.m12.3.3.3.4.cmml">:</mo><mi id="S4.SS1.p1.12.m12.3.3.3.5" xref="S4.SS1.p1.12.m12.3.3.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.12.m12.3b"><apply id="S4.SS1.p1.12.m12.3.4.cmml" xref="S4.SS1.p1.12.m12.3.4"><csymbol cd="ambiguous" id="S4.SS1.p1.12.m12.3.4.1.cmml" xref="S4.SS1.p1.12.m12.3.4">subscript</csymbol><ci id="S4.SS1.p1.12.m12.3.4.2a.cmml" xref="S4.SS1.p1.12.m12.3.4.2"><mtext class="ltx_mathvariant_bold" id="S4.SS1.p1.12.m12.3.4.2.cmml" xref="S4.SS1.p1.12.m12.3.4.2">s</mtext></ci><apply id="S4.SS1.p1.12.m12.3.3.3.cmml" xref="S4.SS1.p1.12.m12.3.3.3"><ci id="S4.SS1.p1.12.m12.3.3.3.4.cmml" xref="S4.SS1.p1.12.m12.3.3.3.4">:</ci><apply id="S4.SS1.p1.12.m12.3.3.3.3.2.cmml" xref="S4.SS1.p1.12.m12.3.3.3.3.1"><max id="S4.SS1.p1.12.m12.1.1.1.1.cmml" xref="S4.SS1.p1.12.m12.1.1.1.1"></max><cn id="S4.SS1.p1.12.m12.2.2.2.2.cmml" type="integer" xref="S4.SS1.p1.12.m12.2.2.2.2">1</cn><apply id="S4.SS1.p1.12.m12.3.3.3.3.1.1.1.cmml" xref="S4.SS1.p1.12.m12.3.3.3.3.1.1.1"><plus id="S4.SS1.p1.12.m12.3.3.3.3.1.1.1.1.cmml" xref="S4.SS1.p1.12.m12.3.3.3.3.1.1.1.1"></plus><apply id="S4.SS1.p1.12.m12.3.3.3.3.1.1.1.2.cmml" xref="S4.SS1.p1.12.m12.3.3.3.3.1.1.1.2"><minus id="S4.SS1.p1.12.m12.3.3.3.3.1.1.1.2.1.cmml" xref="S4.SS1.p1.12.m12.3.3.3.3.1.1.1.2.1"></minus><ci id="S4.SS1.p1.12.m12.3.3.3.3.1.1.1.2.2.cmml" xref="S4.SS1.p1.12.m12.3.3.3.3.1.1.1.2.2">𝑡</ci><ci id="S4.SS1.p1.12.m12.3.3.3.3.1.1.1.2.3.cmml" xref="S4.SS1.p1.12.m12.3.3.3.3.1.1.1.2.3">𝐾</ci></apply><cn id="S4.SS1.p1.12.m12.3.3.3.3.1.1.1.3.cmml" type="integer" xref="S4.SS1.p1.12.m12.3.3.3.3.1.1.1.3">1</cn></apply></apply><ci id="S4.SS1.p1.12.m12.3.3.3.5.cmml" xref="S4.SS1.p1.12.m12.3.3.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.12.m12.3c">\textbf{s}_{\max(1,t-K+1):t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.12.m12.3d">s start_POSTSUBSCRIPT roman_max ( 1 , italic_t - italic_K + 1 ) : italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and similarly for <math alttext="\textbf{g}_{K,t}" class="ltx_Math" display="inline" id="S4.SS1.p1.13.m13.2"><semantics id="S4.SS1.p1.13.m13.2a"><msub id="S4.SS1.p1.13.m13.2.3" xref="S4.SS1.p1.13.m13.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS1.p1.13.m13.2.3.2" xref="S4.SS1.p1.13.m13.2.3.2a.cmml">g</mtext><mrow id="S4.SS1.p1.13.m13.2.2.2.4" xref="S4.SS1.p1.13.m13.2.2.2.3.cmml"><mi id="S4.SS1.p1.13.m13.1.1.1.1" xref="S4.SS1.p1.13.m13.1.1.1.1.cmml">K</mi><mo id="S4.SS1.p1.13.m13.2.2.2.4.1" xref="S4.SS1.p1.13.m13.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p1.13.m13.2.2.2.2" xref="S4.SS1.p1.13.m13.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.13.m13.2b"><apply id="S4.SS1.p1.13.m13.2.3.cmml" xref="S4.SS1.p1.13.m13.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m13.2.3.1.cmml" xref="S4.SS1.p1.13.m13.2.3">subscript</csymbol><ci id="S4.SS1.p1.13.m13.2.3.2a.cmml" xref="S4.SS1.p1.13.m13.2.3.2"><mtext class="ltx_mathvariant_bold" id="S4.SS1.p1.13.m13.2.3.2.cmml" xref="S4.SS1.p1.13.m13.2.3.2">g</mtext></ci><list id="S4.SS1.p1.13.m13.2.2.2.3.cmml" xref="S4.SS1.p1.13.m13.2.2.2.4"><ci id="S4.SS1.p1.13.m13.1.1.1.1.cmml" xref="S4.SS1.p1.13.m13.1.1.1.1">𝐾</ci><ci id="S4.SS1.p1.13.m13.2.2.2.2.cmml" xref="S4.SS1.p1.13.m13.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.13.m13.2c">\textbf{g}_{K,t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.13.m13.2d">g start_POSTSUBSCRIPT italic_K , italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. A crucial aspect of DT in this context is the application of a causal mask to predict the sequence of actions.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.5">To simplify the following analysis, we postulate that the data distribution (i.e., for the dataset), denoted as <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">caligraphic_T</annotation></semantics></math>, produces subsequences of actions, states, and RTG values, each of length <math alttext="K" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.1"><semantics id="S4.SS1.p2.2.m2.1a"><mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.1d">italic_K</annotation></semantics></math>, originating from the same trajectory.
To facilitate our explanation, we slightly diverge from standard notation and represent a sample from <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S4.SS1.p2.3.m3.1"><semantics id="S4.SS1.p2.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><ci id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.3.m3.1d">caligraphic_T</annotation></semantics></math> as <math alttext="(\textbf{a},\textbf{s},\textbf{g})" class="ltx_Math" display="inline" id="S4.SS1.p2.4.m4.3"><semantics id="S4.SS1.p2.4.m4.3a"><mrow id="S4.SS1.p2.4.m4.3.4.2" xref="S4.SS1.p2.4.m4.3.4.1.cmml"><mo id="S4.SS1.p2.4.m4.3.4.2.1" stretchy="false" xref="S4.SS1.p2.4.m4.3.4.1.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1a.cmml">a</mtext><mo id="S4.SS1.p2.4.m4.3.4.2.2" xref="S4.SS1.p2.4.m4.3.4.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S4.SS1.p2.4.m4.2.2" xref="S4.SS1.p2.4.m4.2.2a.cmml">s</mtext><mo id="S4.SS1.p2.4.m4.3.4.2.3" xref="S4.SS1.p2.4.m4.3.4.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S4.SS1.p2.4.m4.3.3" xref="S4.SS1.p2.4.m4.3.3a.cmml">g</mtext><mo id="S4.SS1.p2.4.m4.3.4.2.4" stretchy="false" xref="S4.SS1.p2.4.m4.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.3b"><vector id="S4.SS1.p2.4.m4.3.4.1.cmml" xref="S4.SS1.p2.4.m4.3.4.2"><ci id="S4.SS1.p2.4.m4.1.1a.cmml" xref="S4.SS1.p2.4.m4.1.1"><mtext class="ltx_mathvariant_bold" id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1">a</mtext></ci><ci id="S4.SS1.p2.4.m4.2.2a.cmml" xref="S4.SS1.p2.4.m4.2.2"><mtext class="ltx_mathvariant_bold" id="S4.SS1.p2.4.m4.2.2.cmml" xref="S4.SS1.p2.4.m4.2.2">s</mtext></ci><ci id="S4.SS1.p2.4.m4.3.3a.cmml" xref="S4.SS1.p2.4.m4.3.3"><mtext class="ltx_mathvariant_bold" id="S4.SS1.p2.4.m4.3.3.cmml" xref="S4.SS1.p2.4.m4.3.3">g</mtext></ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.3c">(\textbf{a},\textbf{s},\textbf{g})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.4.m4.3d">( a , s , g )</annotation></semantics></math> where all the vectors contain subelements. This notation choice simplifies the presentation of our training objective.
The core of DT training strategy involves instructing the policy to accurately predict action tokens. This prediction adheres to the standard <math alttext="l_{2}" class="ltx_Math" display="inline" id="S4.SS1.p2.5.m5.1"><semantics id="S4.SS1.p2.5.m5.1a"><msub id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml"><mi id="S4.SS1.p2.5.m5.1.1.2" xref="S4.SS1.p2.5.m5.1.1.2.cmml">l</mi><mn id="S4.SS1.p2.5.m5.1.1.3" xref="S4.SS1.p2.5.m5.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b"><apply id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.5.m5.1.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.p2.5.m5.1.1.2.cmml" xref="S4.SS1.p2.5.m5.1.1.2">𝑙</ci><cn id="S4.SS1.p2.5.m5.1.1.3.cmml" type="integer" xref="S4.SS1.p2.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">l_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.5.m5.1d">italic_l start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> loss, which is mathematically represented as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S6.EGx2">
<tbody id="S4.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbb{E}_{(\textbf{a},\textbf{s},\textbf{g})\sim\mathcal{T}}%
\bigg{[}\frac{1}{K}\sum_{k=1}^{K}\big{(}a_{k}-\pi_{DT}(\textbf{s}_{K,k},%
\textbf{g}_{K,k})\big{)}^{2}\bigg{]}." class="ltx_Math" display="inline" id="S4.E1.m1.8"><semantics id="S4.E1.m1.8a"><mrow id="S4.E1.m1.8.8.1" xref="S4.E1.m1.8.8.1.1.cmml"><mrow id="S4.E1.m1.8.8.1.1" xref="S4.E1.m1.8.8.1.1.cmml"><msub id="S4.E1.m1.8.8.1.1.3" xref="S4.E1.m1.8.8.1.1.3.cmml"><mi id="S4.E1.m1.8.8.1.1.3.2" xref="S4.E1.m1.8.8.1.1.3.2.cmml">𝔼</mi><mrow id="S4.E1.m1.3.3.3" xref="S4.E1.m1.3.3.3.cmml"><mrow id="S4.E1.m1.3.3.3.5.2" xref="S4.E1.m1.3.3.3.5.1.cmml"><mo id="S4.E1.m1.3.3.3.5.2.1" stretchy="false" xref="S4.E1.m1.3.3.3.5.1.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S4.E1.m1.1.1.1.1" xref="S4.E1.m1.1.1.1.1a.cmml">a</mtext><mo id="S4.E1.m1.3.3.3.5.2.2" xref="S4.E1.m1.3.3.3.5.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S4.E1.m1.2.2.2.2" xref="S4.E1.m1.2.2.2.2a.cmml">s</mtext><mo id="S4.E1.m1.3.3.3.5.2.3" xref="S4.E1.m1.3.3.3.5.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S4.E1.m1.3.3.3.3" xref="S4.E1.m1.3.3.3.3a.cmml">g</mtext><mo id="S4.E1.m1.3.3.3.5.2.4" stretchy="false" xref="S4.E1.m1.3.3.3.5.1.cmml">)</mo></mrow><mo id="S4.E1.m1.3.3.3.4" xref="S4.E1.m1.3.3.3.4.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.3.3.3.6" xref="S4.E1.m1.3.3.3.6.cmml">𝒯</mi></mrow></msub><mo id="S4.E1.m1.8.8.1.1.2" xref="S4.E1.m1.8.8.1.1.2.cmml">⁢</mo><mrow id="S4.E1.m1.8.8.1.1.1.1" xref="S4.E1.m1.8.8.1.1.1.2.cmml"><mo id="S4.E1.m1.8.8.1.1.1.1.2" maxsize="210%" minsize="210%" xref="S4.E1.m1.8.8.1.1.1.2.1.cmml">[</mo><mrow id="S4.E1.m1.8.8.1.1.1.1.1" xref="S4.E1.m1.8.8.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E1.m1.8.8.1.1.1.1.1.3" xref="S4.E1.m1.8.8.1.1.1.1.1.3.cmml"><mfrac id="S4.E1.m1.8.8.1.1.1.1.1.3a" xref="S4.E1.m1.8.8.1.1.1.1.1.3.cmml"><mn id="S4.E1.m1.8.8.1.1.1.1.1.3.2" xref="S4.E1.m1.8.8.1.1.1.1.1.3.2.cmml">1</mn><mi id="S4.E1.m1.8.8.1.1.1.1.1.3.3" xref="S4.E1.m1.8.8.1.1.1.1.1.3.3.cmml">K</mi></mfrac></mstyle><mo id="S4.E1.m1.8.8.1.1.1.1.1.2" xref="S4.E1.m1.8.8.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E1.m1.8.8.1.1.1.1.1.1" xref="S4.E1.m1.8.8.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E1.m1.8.8.1.1.1.1.1.1.2" xref="S4.E1.m1.8.8.1.1.1.1.1.1.2.cmml"><munderover id="S4.E1.m1.8.8.1.1.1.1.1.1.2a" xref="S4.E1.m1.8.8.1.1.1.1.1.1.2.cmml"><mo id="S4.E1.m1.8.8.1.1.1.1.1.1.2.2.2" movablelimits="false" xref="S4.E1.m1.8.8.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E1.m1.8.8.1.1.1.1.1.1.2.2.3" xref="S4.E1.m1.8.8.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E1.m1.8.8.1.1.1.1.1.1.2.2.3.2" xref="S4.E1.m1.8.8.1.1.1.1.1.1.2.2.3.2.cmml">k</mi><mo id="S4.E1.m1.8.8.1.1.1.1.1.1.2.2.3.1" xref="S4.E1.m1.8.8.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E1.m1.8.8.1.1.1.1.1.1.2.2.3.3" xref="S4.E1.m1.8.8.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E1.m1.8.8.1.1.1.1.1.1.2.3" xref="S4.E1.m1.8.8.1.1.1.1.1.1.2.3.cmml">K</mi></munderover></mstyle><msup id="S4.E1.m1.8.8.1.1.1.1.1.1.1" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.cmml"><mrow id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.4" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.4.2" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.4.2.cmml">a</mi><mi id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.4.3" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.4.3.cmml">k</mi></msub><mo id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.4" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.4.cmml"><mi id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.4.2" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.4.2.cmml">π</mi><mrow id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.4.3" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.4.3.cmml"><mi id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.4.3.2" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.4.3.2.cmml">D</mi><mo id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.4.3.1" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.4.3.1.cmml">⁢</mo><mi id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.4.3.3" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.4.3.3.cmml">T</mi></mrow></msub><mo id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mo id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2.3" stretchy="false" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2a.cmml">s</mtext><mrow id="S4.E1.m1.5.5.2.4" xref="S4.E1.m1.5.5.2.3.cmml"><mi id="S4.E1.m1.4.4.1.1" xref="S4.E1.m1.4.4.1.1.cmml">K</mi><mo id="S4.E1.m1.5.5.2.4.1" xref="S4.E1.m1.5.5.2.3.cmml">,</mo><mi id="S4.E1.m1.5.5.2.2" xref="S4.E1.m1.5.5.2.2.cmml">k</mi></mrow></msub><mo id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2.4" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2a.cmml">g</mtext><mrow id="S4.E1.m1.7.7.2.4" xref="S4.E1.m1.7.7.2.3.cmml"><mi id="S4.E1.m1.6.6.1.1" xref="S4.E1.m1.6.6.1.1.cmml">K</mi><mo id="S4.E1.m1.7.7.2.4.1" xref="S4.E1.m1.7.7.2.3.cmml">,</mo><mi id="S4.E1.m1.7.7.2.2" xref="S4.E1.m1.7.7.2.2.cmml">k</mi></mrow></msub><mo id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2.5" stretchy="false" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.E1.m1.8.8.1.1.1.1.1.1.1.3" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo id="S4.E1.m1.8.8.1.1.1.1.3" maxsize="210%" minsize="210%" xref="S4.E1.m1.8.8.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S4.E1.m1.8.8.1.2" lspace="0em" xref="S4.E1.m1.8.8.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.8b"><apply id="S4.E1.m1.8.8.1.1.cmml" xref="S4.E1.m1.8.8.1"><times id="S4.E1.m1.8.8.1.1.2.cmml" xref="S4.E1.m1.8.8.1.1.2"></times><apply id="S4.E1.m1.8.8.1.1.3.cmml" xref="S4.E1.m1.8.8.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.8.8.1.1.3.1.cmml" xref="S4.E1.m1.8.8.1.1.3">subscript</csymbol><ci id="S4.E1.m1.8.8.1.1.3.2.cmml" xref="S4.E1.m1.8.8.1.1.3.2">𝔼</ci><apply id="S4.E1.m1.3.3.3.cmml" xref="S4.E1.m1.3.3.3"><csymbol cd="latexml" id="S4.E1.m1.3.3.3.4.cmml" xref="S4.E1.m1.3.3.3.4">similar-to</csymbol><vector id="S4.E1.m1.3.3.3.5.1.cmml" xref="S4.E1.m1.3.3.3.5.2"><ci id="S4.E1.m1.1.1.1.1a.cmml" xref="S4.E1.m1.1.1.1.1"><mtext class="ltx_mathvariant_bold" id="S4.E1.m1.1.1.1.1.cmml" mathsize="70%" xref="S4.E1.m1.1.1.1.1">a</mtext></ci><ci id="S4.E1.m1.2.2.2.2a.cmml" xref="S4.E1.m1.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.E1.m1.2.2.2.2.cmml" mathsize="70%" xref="S4.E1.m1.2.2.2.2">s</mtext></ci><ci id="S4.E1.m1.3.3.3.3a.cmml" xref="S4.E1.m1.3.3.3.3"><mtext class="ltx_mathvariant_bold" id="S4.E1.m1.3.3.3.3.cmml" mathsize="70%" xref="S4.E1.m1.3.3.3.3">g</mtext></ci></vector><ci id="S4.E1.m1.3.3.3.6.cmml" xref="S4.E1.m1.3.3.3.6">𝒯</ci></apply></apply><apply id="S4.E1.m1.8.8.1.1.1.2.cmml" xref="S4.E1.m1.8.8.1.1.1.1"><csymbol cd="latexml" id="S4.E1.m1.8.8.1.1.1.2.1.cmml" xref="S4.E1.m1.8.8.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E1.m1.8.8.1.1.1.1.1.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1"><times id="S4.E1.m1.8.8.1.1.1.1.1.2.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.2"></times><apply id="S4.E1.m1.8.8.1.1.1.1.1.3.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.3"><divide id="S4.E1.m1.8.8.1.1.1.1.1.3.1.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.3"></divide><cn id="S4.E1.m1.8.8.1.1.1.1.1.3.2.cmml" type="integer" xref="S4.E1.m1.8.8.1.1.1.1.1.3.2">1</cn><ci id="S4.E1.m1.8.8.1.1.1.1.1.3.3.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.3.3">𝐾</ci></apply><apply id="S4.E1.m1.8.8.1.1.1.1.1.1.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1"><apply id="S4.E1.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E1.m1.8.8.1.1.1.1.1.1.2.1.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E1.m1.8.8.1.1.1.1.1.1.2.2.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E1.m1.8.8.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E1.m1.8.8.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.2.2.2"></sum><apply id="S4.E1.m1.8.8.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.2.2.3"><eq id="S4.E1.m1.8.8.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E1.m1.8.8.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.2.2.3.2">𝑘</ci><cn id="S4.E1.m1.8.8.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E1.m1.8.8.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E1.m1.8.8.1.1.1.1.1.1.2.3.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.2.3">𝐾</ci></apply><apply id="S4.E1.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.8.8.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1"><minus id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.3"></minus><apply id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.4.2">𝑎</ci><ci id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.4.3">𝑘</ci></apply><apply id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2"><times id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.3"></times><apply id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.4.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.4.1.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.4.2.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.4.2">𝜋</ci><apply id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.4.3.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.4.3"><times id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.4.3.1.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.4.3.1"></times><ci id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.4.3.2.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.4.3.2">𝐷</ci><ci id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.4.3.3.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.4.3.3">𝑇</ci></apply></apply><interval closure="open" id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2"><apply id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2a.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">s</mtext></ci><list id="S4.E1.m1.5.5.2.3.cmml" xref="S4.E1.m1.5.5.2.4"><ci id="S4.E1.m1.4.4.1.1.cmml" xref="S4.E1.m1.4.4.1.1">𝐾</ci><ci id="S4.E1.m1.5.5.2.2.cmml" xref="S4.E1.m1.5.5.2.2">𝑘</ci></list></apply><apply id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2a.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2">g</mtext></ci><list id="S4.E1.m1.7.7.2.3.cmml" xref="S4.E1.m1.7.7.2.4"><ci id="S4.E1.m1.6.6.1.1.cmml" xref="S4.E1.m1.6.6.1.1">𝐾</ci><ci id="S4.E1.m1.7.7.2.2.cmml" xref="S4.E1.m1.7.7.2.2">𝑘</ci></list></apply></interval></apply></apply><cn id="S4.E1.m1.8.8.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E1.m1.8.8.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.8c">\displaystyle\mathbb{E}_{(\textbf{a},\textbf{s},\textbf{g})\sim\mathcal{T}}%
\bigg{[}\frac{1}{K}\sum_{k=1}^{K}\big{(}a_{k}-\pi_{DT}(\textbf{s}_{K,k},%
\textbf{g}_{K,k})\big{)}^{2}\bigg{]}.</annotation><annotation encoding="application/x-llamapun" id="S4.E1.m1.8d">blackboard_E start_POSTSUBSCRIPT ( a , s , g ) ∼ caligraphic_T end_POSTSUBSCRIPT [ divide start_ARG 1 end_ARG start_ARG italic_K end_ARG ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT ( italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT - italic_π start_POSTSUBSCRIPT italic_D italic_T end_POSTSUBSCRIPT ( s start_POSTSUBSCRIPT italic_K , italic_k end_POSTSUBSCRIPT , g start_POSTSUBSCRIPT italic_K , italic_k end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p2.8">This equation encapsulates the expectation of the mean squared difference between the actual action tokens and those predicted by the DT policy, averaged over all <math alttext="K" class="ltx_Math" display="inline" id="S4.SS1.p2.6.m1.1"><semantics id="S4.SS1.p2.6.m1.1a"><mi id="S4.SS1.p2.6.m1.1.1" xref="S4.SS1.p2.6.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m1.1b"><ci id="S4.SS1.p2.6.m1.1.1.cmml" xref="S4.SS1.p2.6.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.6.m1.1d">italic_K</annotation></semantics></math> elements in the subsequence.
In practice, to implement this approach within the framework of an offline dataset <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S4.SS1.p2.7.m2.1"><semantics id="S4.SS1.p2.7.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.7.m2.1.1" xref="S4.SS1.p2.7.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m2.1b"><ci id="S4.SS1.p2.7.m2.1.1.cmml" xref="S4.SS1.p2.7.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.7.m2.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.7.m2.1d">caligraphic_D</annotation></semantics></math>, we uniformly sample these length-<math alttext="K" class="ltx_Math" display="inline" id="S4.SS1.p2.8.m3.1"><semantics id="S4.SS1.p2.8.m3.1a"><mi id="S4.SS1.p2.8.m3.1.1" xref="S4.SS1.p2.8.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.8.m3.1b"><ci id="S4.SS1.p2.8.m3.1.1.cmml" xref="S4.SS1.p2.8.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.8.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.8.m3.1d">italic_K</annotation></semantics></math> subsequences.</p>
</div>
<figure class="ltx_figure" id="S4.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="224" id="S4.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F2.2.1.1" style="font-size:90%;">Figure 2</span>. </span><span class="ltx_text" id="S4.F2.3.2" style="font-size:90%;">The overall structure of the proposed EDT4Rec. The backbone is the causal decision transformer.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1">In EDT4Rec, we have introduced the following two key modifications: max-entropy enhanced Exploration and RTG relabeling.
The existing approach of training policies in decision-transformer-based offline RLRS <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib25" title="">2023</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib8" title="">2023a</a>)</cite> on purely offline datasets often encounters a critical limitation: the trajectories in these datasets usually do not yield high returns and cover only a restricted portion of the state space. This limitation stems from two parts: i). the potential distribution difference between the offline dataset and the online environment and, ii). the sub-optimality of the training data available offline. A straightforward strategy to mitigate the distribution difference is the fine-tuning of pre-trained RL agents through online interactions. However, the learning formulation of a standard decision transformer does not naturally lend itself to effective online learning. Moreover, in scenarios with sub-optimal trajectories, the lack of informative rewards (often zero) hinders effective policy updates.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Max-Entropy Enhanced Exploration</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">In the initial phase of our methodology, we propose a probabilistic learning objective, intended to augment exploration within the standard DT framework. This setup is geared towards developing a stochastic policy, with the primary goal of maximizing the likelihood of the observed dataset. For contexts involving continuous action spaces, we opt for the conventional approach of using a multivariate Gaussian distribution with a diagonal covariance matrix. This distribution models the action probabilities, conditional upon states and RTG values. The policy parameters are represented by <math alttext="\theta" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">italic_θ</annotation></semantics></math>,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S6.EGx3">
<tbody id="S4.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\pi_{\theta}(a_{t}|\textbf{s}_{K,t},\textbf{g}_{K,t})=\mathcal{N}%
\Big{(}\mu_{\theta}(\textbf{s}_{K,t},\textbf{g}_{K,t}),\sum_{\theta}(\textbf{s%
}_{K,t},\textbf{g}_{K,t})\Big{)},\forall t\in T," class="ltx_Math" display="inline" id="S4.E2.m1.13"><semantics id="S4.E2.m1.13a"><mrow id="S4.E2.m1.13.13.1"><mrow id="S4.E2.m1.13.13.1.1.2" xref="S4.E2.m1.13.13.1.1.3.cmml"><mrow id="S4.E2.m1.13.13.1.1.1.1" xref="S4.E2.m1.13.13.1.1.1.1.cmml"><mrow id="S4.E2.m1.13.13.1.1.1.1.1" xref="S4.E2.m1.13.13.1.1.1.1.1.cmml"><msub id="S4.E2.m1.13.13.1.1.1.1.1.3" xref="S4.E2.m1.13.13.1.1.1.1.1.3.cmml"><mi id="S4.E2.m1.13.13.1.1.1.1.1.3.2" xref="S4.E2.m1.13.13.1.1.1.1.1.3.2.cmml">π</mi><mi id="S4.E2.m1.13.13.1.1.1.1.1.3.3" xref="S4.E2.m1.13.13.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S4.E2.m1.13.13.1.1.1.1.1.2" xref="S4.E2.m1.13.13.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E2.m1.13.13.1.1.1.1.1.1.1" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E2.m1.13.13.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E2.m1.13.13.1.1.1.1.1.1.1.1" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.4" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.4.cmml"><mi id="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.4.2" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.4.2.cmml">a</mi><mi id="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.4.3" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.4.3.cmml">t</mi></msub><mo fence="false" id="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.2.2" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.2.3.cmml"><msub id="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.1.1.1.2a.cmml">s</mtext><mrow id="S4.E2.m1.2.2.2.4" xref="S4.E2.m1.2.2.2.3.cmml"><mi id="S4.E2.m1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.cmml">K</mi><mo id="S4.E2.m1.2.2.2.4.1" xref="S4.E2.m1.2.2.2.3.cmml">,</mo><mi id="S4.E2.m1.2.2.2.2" xref="S4.E2.m1.2.2.2.2.cmml">t</mi></mrow></msub><mo id="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.2.2.2.2a.cmml">g</mtext><mrow id="S4.E2.m1.4.4.2.4" xref="S4.E2.m1.4.4.2.3.cmml"><mi id="S4.E2.m1.3.3.1.1" xref="S4.E2.m1.3.3.1.1.cmml">K</mi><mo id="S4.E2.m1.4.4.2.4.1" xref="S4.E2.m1.4.4.2.3.cmml">,</mo><mi id="S4.E2.m1.4.4.2.2" xref="S4.E2.m1.4.4.2.2.cmml">t</mi></mrow></msub></mrow></mrow><mo id="S4.E2.m1.13.13.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.13.13.1.1.1.1.4" xref="S4.E2.m1.13.13.1.1.1.1.4.cmml">=</mo><mrow id="S4.E2.m1.13.13.1.1.1.1.3" xref="S4.E2.m1.13.13.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.13.13.1.1.1.1.3.4" xref="S4.E2.m1.13.13.1.1.1.1.3.4.cmml">𝒩</mi><mo id="S4.E2.m1.13.13.1.1.1.1.3.3" xref="S4.E2.m1.13.13.1.1.1.1.3.3.cmml">⁢</mo><mrow id="S4.E2.m1.13.13.1.1.1.1.3.2.2" xref="S4.E2.m1.13.13.1.1.1.1.3.2.3.cmml"><mo id="S4.E2.m1.13.13.1.1.1.1.3.2.2.3" maxsize="160%" minsize="160%" xref="S4.E2.m1.13.13.1.1.1.1.3.2.3.cmml">(</mo><mrow id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.cmml"><msub id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.4" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.4.cmml"><mi id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.4.2" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.4.2.cmml">μ</mi><mi id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.4.3" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.4.3.cmml">θ</mi></msub><mo id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.3" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.3.cmml">⁢</mo><mrow id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.2.2" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.2.3.cmml"><mo id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.2.2.3" stretchy="false" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.2.3.cmml">(</mo><msub id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.1.1.1" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.1.1.1.2" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.1.1.1.2a.cmml">s</mtext><mrow id="S4.E2.m1.6.6.2.4" xref="S4.E2.m1.6.6.2.3.cmml"><mi id="S4.E2.m1.5.5.1.1" xref="S4.E2.m1.5.5.1.1.cmml">K</mi><mo id="S4.E2.m1.6.6.2.4.1" xref="S4.E2.m1.6.6.2.3.cmml">,</mo><mi id="S4.E2.m1.6.6.2.2" xref="S4.E2.m1.6.6.2.2.cmml">t</mi></mrow></msub><mo id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.2.2.4" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.2.3.cmml">,</mo><msub id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.2.2.2" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.2.2.2.2" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.2.2.2.2a.cmml">g</mtext><mrow id="S4.E2.m1.8.8.2.4" xref="S4.E2.m1.8.8.2.3.cmml"><mi id="S4.E2.m1.7.7.1.1" xref="S4.E2.m1.7.7.1.1.cmml">K</mi><mo id="S4.E2.m1.8.8.2.4.1" xref="S4.E2.m1.8.8.2.3.cmml">,</mo><mi id="S4.E2.m1.8.8.2.2" xref="S4.E2.m1.8.8.2.2.cmml">t</mi></mrow></msub><mo id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.2.2.5" stretchy="false" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.13.13.1.1.1.1.3.2.2.4" xref="S4.E2.m1.13.13.1.1.1.1.3.2.3.cmml">,</mo><mrow id="S4.E2.m1.13.13.1.1.1.1.3.2.2.2" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.cmml"><mstyle displaystyle="true" id="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.3" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.3.cmml"><munder id="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.3a" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.3.cmml"><mo id="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.3.2" movablelimits="false" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.3.2.cmml">∑</mo><mi id="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.3.3" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.3.3.cmml">θ</mi></munder></mstyle><mrow id="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.2.2" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.2.3.cmml"><mo id="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.2.2.3" stretchy="false" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.2.3.cmml">(</mo><msub id="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.1.1.1" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.1.1.1.2" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.1.1.1.2a.cmml">s</mtext><mrow id="S4.E2.m1.10.10.2.4" xref="S4.E2.m1.10.10.2.3.cmml"><mi id="S4.E2.m1.9.9.1.1" xref="S4.E2.m1.9.9.1.1.cmml">K</mi><mo id="S4.E2.m1.10.10.2.4.1" xref="S4.E2.m1.10.10.2.3.cmml">,</mo><mi id="S4.E2.m1.10.10.2.2" xref="S4.E2.m1.10.10.2.2.cmml">t</mi></mrow></msub><mo id="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.2.2.4" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.2.3.cmml">,</mo><msub id="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.2.2.2" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.2.2.2.2" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.2.2.2.2a.cmml">g</mtext><mrow id="S4.E2.m1.12.12.2.4" xref="S4.E2.m1.12.12.2.3.cmml"><mi id="S4.E2.m1.11.11.1.1" xref="S4.E2.m1.11.11.1.1.cmml">K</mi><mo id="S4.E2.m1.12.12.2.4.1" xref="S4.E2.m1.12.12.2.3.cmml">,</mo><mi id="S4.E2.m1.12.12.2.2" xref="S4.E2.m1.12.12.2.2.cmml">t</mi></mrow></msub><mo id="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.2.2.5" stretchy="false" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.13.13.1.1.1.1.3.2.2.5" maxsize="160%" minsize="160%" xref="S4.E2.m1.13.13.1.1.1.1.3.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E2.m1.13.13.1.1.2.3" xref="S4.E2.m1.13.13.1.1.3a.cmml">,</mo><mrow id="S4.E2.m1.13.13.1.1.2.2" xref="S4.E2.m1.13.13.1.1.2.2.cmml"><mrow id="S4.E2.m1.13.13.1.1.2.2.2" xref="S4.E2.m1.13.13.1.1.2.2.2.cmml"><mo id="S4.E2.m1.13.13.1.1.2.2.2.1" rspace="0.167em" xref="S4.E2.m1.13.13.1.1.2.2.2.1.cmml">∀</mo><mi id="S4.E2.m1.13.13.1.1.2.2.2.2" xref="S4.E2.m1.13.13.1.1.2.2.2.2.cmml">t</mi></mrow><mo id="S4.E2.m1.13.13.1.1.2.2.1" xref="S4.E2.m1.13.13.1.1.2.2.1.cmml">∈</mo><mi id="S4.E2.m1.13.13.1.1.2.2.3" xref="S4.E2.m1.13.13.1.1.2.2.3.cmml">T</mi></mrow></mrow><mo id="S4.E2.m1.13.13.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.13b"><apply id="S4.E2.m1.13.13.1.1.3.cmml" xref="S4.E2.m1.13.13.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.13.13.1.1.3a.cmml" xref="S4.E2.m1.13.13.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E2.m1.13.13.1.1.1.1.cmml" xref="S4.E2.m1.13.13.1.1.1.1"><eq id="S4.E2.m1.13.13.1.1.1.1.4.cmml" xref="S4.E2.m1.13.13.1.1.1.1.4"></eq><apply id="S4.E2.m1.13.13.1.1.1.1.1.cmml" xref="S4.E2.m1.13.13.1.1.1.1.1"><times id="S4.E2.m1.13.13.1.1.1.1.1.2.cmml" xref="S4.E2.m1.13.13.1.1.1.1.1.2"></times><apply id="S4.E2.m1.13.13.1.1.1.1.1.3.cmml" xref="S4.E2.m1.13.13.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.13.13.1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.13.13.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E2.m1.13.13.1.1.1.1.1.3.2.cmml" xref="S4.E2.m1.13.13.1.1.1.1.1.3.2">𝜋</ci><ci id="S4.E2.m1.13.13.1.1.1.1.1.3.3.cmml" xref="S4.E2.m1.13.13.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.3">conditional</csymbol><apply id="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.4.1.cmml" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.4.2.cmml" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.4.2">𝑎</ci><ci id="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.4.3.cmml" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.4.3">𝑡</ci></apply><list id="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.2.2"><apply id="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.1.1.1.2a.cmml" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.1.1.1.2">s</mtext></ci><list id="S4.E2.m1.2.2.2.3.cmml" xref="S4.E2.m1.2.2.2.4"><ci id="S4.E2.m1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1">𝐾</ci><ci id="S4.E2.m1.2.2.2.2.cmml" xref="S4.E2.m1.2.2.2.2">𝑡</ci></list></apply><apply id="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.2.2.2.2a.cmml" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E2.m1.13.13.1.1.1.1.1.1.1.1.2.2.2.2">g</mtext></ci><list id="S4.E2.m1.4.4.2.3.cmml" xref="S4.E2.m1.4.4.2.4"><ci id="S4.E2.m1.3.3.1.1.cmml" xref="S4.E2.m1.3.3.1.1">𝐾</ci><ci id="S4.E2.m1.4.4.2.2.cmml" xref="S4.E2.m1.4.4.2.2">𝑡</ci></list></apply></list></apply></apply><apply id="S4.E2.m1.13.13.1.1.1.1.3.cmml" xref="S4.E2.m1.13.13.1.1.1.1.3"><times id="S4.E2.m1.13.13.1.1.1.1.3.3.cmml" xref="S4.E2.m1.13.13.1.1.1.1.3.3"></times><ci id="S4.E2.m1.13.13.1.1.1.1.3.4.cmml" xref="S4.E2.m1.13.13.1.1.1.1.3.4">𝒩</ci><interval closure="open" id="S4.E2.m1.13.13.1.1.1.1.3.2.3.cmml" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2"><apply id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.cmml" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1"><times id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.3.cmml" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.3"></times><apply id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.4.cmml" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.4"><csymbol cd="ambiguous" id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.4.1.cmml" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.4">subscript</csymbol><ci id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.4.2.cmml" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.4.2">𝜇</ci><ci id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.4.3.cmml" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.4.3">𝜃</ci></apply><interval closure="open" id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.2.3.cmml" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.2.2"><apply id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.1.1.1.2a.cmml" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.1.1.1.2">s</mtext></ci><list id="S4.E2.m1.6.6.2.3.cmml" xref="S4.E2.m1.6.6.2.4"><ci id="S4.E2.m1.5.5.1.1.cmml" xref="S4.E2.m1.5.5.1.1">𝐾</ci><ci id="S4.E2.m1.6.6.2.2.cmml" xref="S4.E2.m1.6.6.2.2">𝑡</ci></list></apply><apply id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.2.2.2.cmml" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.2.2.2.1.cmml" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.2.2.2.2a.cmml" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.2.2.2.2.cmml" xref="S4.E2.m1.13.13.1.1.1.1.2.1.1.1.2.2.2.2">g</mtext></ci><list id="S4.E2.m1.8.8.2.3.cmml" xref="S4.E2.m1.8.8.2.4"><ci id="S4.E2.m1.7.7.1.1.cmml" xref="S4.E2.m1.7.7.1.1">𝐾</ci><ci id="S4.E2.m1.8.8.2.2.cmml" xref="S4.E2.m1.8.8.2.2">𝑡</ci></list></apply></interval></apply><apply id="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.cmml" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2.2"><apply id="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.3.cmml" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.3"><csymbol cd="ambiguous" id="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.3.1.cmml" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.3">subscript</csymbol><sum id="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.3.2.cmml" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.3.2"></sum><ci id="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.3.3.cmml" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.3.3">𝜃</ci></apply><interval closure="open" id="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.2.3.cmml" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.2.2"><apply id="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.1.1.1.cmml" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.1.1.1.1.cmml" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.1.1.1">subscript</csymbol><ci id="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.1.1.1.2a.cmml" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.1.1.1.2.cmml" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.1.1.1.2">s</mtext></ci><list id="S4.E2.m1.10.10.2.3.cmml" xref="S4.E2.m1.10.10.2.4"><ci id="S4.E2.m1.9.9.1.1.cmml" xref="S4.E2.m1.9.9.1.1">𝐾</ci><ci id="S4.E2.m1.10.10.2.2.cmml" xref="S4.E2.m1.10.10.2.2">𝑡</ci></list></apply><apply id="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.2.2.2.cmml" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.2.2.2.1.cmml" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.2.2.2.2a.cmml" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.2.2.2.2.cmml" xref="S4.E2.m1.13.13.1.1.1.1.3.2.2.2.2.2.2.2">g</mtext></ci><list id="S4.E2.m1.12.12.2.3.cmml" xref="S4.E2.m1.12.12.2.4"><ci id="S4.E2.m1.11.11.1.1.cmml" xref="S4.E2.m1.11.11.1.1">𝐾</ci><ci id="S4.E2.m1.12.12.2.2.cmml" xref="S4.E2.m1.12.12.2.2">𝑡</ci></list></apply></interval></apply></interval></apply></apply><apply id="S4.E2.m1.13.13.1.1.2.2.cmml" xref="S4.E2.m1.13.13.1.1.2.2"><in id="S4.E2.m1.13.13.1.1.2.2.1.cmml" xref="S4.E2.m1.13.13.1.1.2.2.1"></in><apply id="S4.E2.m1.13.13.1.1.2.2.2.cmml" xref="S4.E2.m1.13.13.1.1.2.2.2"><csymbol cd="latexml" id="S4.E2.m1.13.13.1.1.2.2.2.1.cmml" xref="S4.E2.m1.13.13.1.1.2.2.2.1">for-all</csymbol><ci id="S4.E2.m1.13.13.1.1.2.2.2.2.cmml" xref="S4.E2.m1.13.13.1.1.2.2.2.2">𝑡</ci></apply><ci id="S4.E2.m1.13.13.1.1.2.2.3.cmml" xref="S4.E2.m1.13.13.1.1.2.2.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.13c">\displaystyle\pi_{\theta}(a_{t}|\textbf{s}_{K,t},\textbf{g}_{K,t})=\mathcal{N}%
\Big{(}\mu_{\theta}(\textbf{s}_{K,t},\textbf{g}_{K,t}),\sum_{\theta}(\textbf{s%
}_{K,t},\textbf{g}_{K,t})\Big{)},\forall t\in T,</annotation><annotation encoding="application/x-llamapun" id="S4.E2.m1.13d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | s start_POSTSUBSCRIPT italic_K , italic_t end_POSTSUBSCRIPT , g start_POSTSUBSCRIPT italic_K , italic_t end_POSTSUBSCRIPT ) = caligraphic_N ( italic_μ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( s start_POSTSUBSCRIPT italic_K , italic_t end_POSTSUBSCRIPT , g start_POSTSUBSCRIPT italic_K , italic_t end_POSTSUBSCRIPT ) , ∑ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( s start_POSTSUBSCRIPT italic_K , italic_t end_POSTSUBSCRIPT , g start_POSTSUBSCRIPT italic_K , italic_t end_POSTSUBSCRIPT ) ) , ∀ italic_t ∈ italic_T ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p1.2">where <math alttext="\sum_{\theta}" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m1.1"><semantics id="S4.SS2.p1.2.m1.1a"><msub id="S4.SS2.p1.2.m1.1.1" xref="S4.SS2.p1.2.m1.1.1.cmml"><mo id="S4.SS2.p1.2.m1.1.1.2" xref="S4.SS2.p1.2.m1.1.1.2.cmml">∑</mo><mi id="S4.SS2.p1.2.m1.1.1.3" xref="S4.SS2.p1.2.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m1.1b"><apply id="S4.SS2.p1.2.m1.1.1.cmml" xref="S4.SS2.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m1.1.1.1.cmml" xref="S4.SS2.p1.2.m1.1.1">subscript</csymbol><sum id="S4.SS2.p1.2.m1.1.1.2.cmml" xref="S4.SS2.p1.2.m1.1.1.2"></sum><ci id="S4.SS2.p1.2.m1.1.1.3.cmml" xref="S4.SS2.p1.2.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m1.1c">\sum_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m1.1d">∑ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> denotes the diagonal covariance matrix.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">Consider a stochastic policy, we aim to maximize the log-likelihood of the trajectories present in our training dataset. This objective is equivalently achieved by minimizing the negative log-likelihood (NLL) loss. The loss function, <math alttext="J(\theta)" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.2" xref="S4.SS2.p2.1.m1.1.2.cmml"><mi id="S4.SS2.p2.1.m1.1.2.2" xref="S4.SS2.p2.1.m1.1.2.2.cmml">J</mi><mo id="S4.SS2.p2.1.m1.1.2.1" xref="S4.SS2.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.p2.1.m1.1.2.3.2" xref="S4.SS2.p2.1.m1.1.2.cmml"><mo id="S4.SS2.p2.1.m1.1.2.3.2.1" stretchy="false" xref="S4.SS2.p2.1.m1.1.2.cmml">(</mo><mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">θ</mi><mo id="S4.SS2.p2.1.m1.1.2.3.2.2" stretchy="false" xref="S4.SS2.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.2"><times id="S4.SS2.p2.1.m1.1.2.1.cmml" xref="S4.SS2.p2.1.m1.1.2.1"></times><ci id="S4.SS2.p2.1.m1.1.2.2.cmml" xref="S4.SS2.p2.1.m1.1.2.2">𝐽</ci><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">J(\theta)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">italic_J ( italic_θ )</annotation></semantics></math>, is defined as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S6.EGx4">
<tbody id="S4.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle J(\theta)" class="ltx_Math" display="inline" id="S4.Ex2.m1.1"><semantics id="S4.Ex2.m1.1a"><mrow id="S4.Ex2.m1.1.2" xref="S4.Ex2.m1.1.2.cmml"><mi id="S4.Ex2.m1.1.2.2" xref="S4.Ex2.m1.1.2.2.cmml">J</mi><mo id="S4.Ex2.m1.1.2.1" xref="S4.Ex2.m1.1.2.1.cmml">⁢</mo><mrow id="S4.Ex2.m1.1.2.3.2" xref="S4.Ex2.m1.1.2.cmml"><mo id="S4.Ex2.m1.1.2.3.2.1" stretchy="false" xref="S4.Ex2.m1.1.2.cmml">(</mo><mi id="S4.Ex2.m1.1.1" xref="S4.Ex2.m1.1.1.cmml">θ</mi><mo id="S4.Ex2.m1.1.2.3.2.2" stretchy="false" xref="S4.Ex2.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex2.m1.1b"><apply id="S4.Ex2.m1.1.2.cmml" xref="S4.Ex2.m1.1.2"><times id="S4.Ex2.m1.1.2.1.cmml" xref="S4.Ex2.m1.1.2.1"></times><ci id="S4.Ex2.m1.1.2.2.cmml" xref="S4.Ex2.m1.1.2.2">𝐽</ci><ci id="S4.Ex2.m1.1.1.cmml" xref="S4.Ex2.m1.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex2.m1.1c">\displaystyle J(\theta)</annotation><annotation encoding="application/x-llamapun" id="S4.Ex2.m1.1d">italic_J ( italic_θ )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{K}\mathbb{E}_{(\textbf{a},\textbf{s},\textbf{g})\sim%
\mathcal{T}}[-\log\pi_{\theta}(\textbf{a}|\textbf{s},\textbf{g})]" class="ltx_Math" display="inline" id="S4.Ex2.m2.6"><semantics id="S4.Ex2.m2.6a"><mrow id="S4.Ex2.m2.6.6" xref="S4.Ex2.m2.6.6.cmml"><mi id="S4.Ex2.m2.6.6.3" xref="S4.Ex2.m2.6.6.3.cmml"></mi><mo id="S4.Ex2.m2.6.6.2" xref="S4.Ex2.m2.6.6.2.cmml">=</mo><mrow id="S4.Ex2.m2.6.6.1" xref="S4.Ex2.m2.6.6.1.cmml"><mstyle displaystyle="true" id="S4.Ex2.m2.6.6.1.3" xref="S4.Ex2.m2.6.6.1.3.cmml"><mfrac id="S4.Ex2.m2.6.6.1.3a" xref="S4.Ex2.m2.6.6.1.3.cmml"><mn id="S4.Ex2.m2.6.6.1.3.2" xref="S4.Ex2.m2.6.6.1.3.2.cmml">1</mn><mi id="S4.Ex2.m2.6.6.1.3.3" xref="S4.Ex2.m2.6.6.1.3.3.cmml">K</mi></mfrac></mstyle><mo id="S4.Ex2.m2.6.6.1.2" xref="S4.Ex2.m2.6.6.1.2.cmml">⁢</mo><msub id="S4.Ex2.m2.6.6.1.4" xref="S4.Ex2.m2.6.6.1.4.cmml"><mi id="S4.Ex2.m2.6.6.1.4.2" xref="S4.Ex2.m2.6.6.1.4.2.cmml">𝔼</mi><mrow id="S4.Ex2.m2.3.3.3" xref="S4.Ex2.m2.3.3.3.cmml"><mrow id="S4.Ex2.m2.3.3.3.5.2" xref="S4.Ex2.m2.3.3.3.5.1.cmml"><mo id="S4.Ex2.m2.3.3.3.5.2.1" stretchy="false" xref="S4.Ex2.m2.3.3.3.5.1.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S4.Ex2.m2.1.1.1.1" xref="S4.Ex2.m2.1.1.1.1a.cmml">a</mtext><mo id="S4.Ex2.m2.3.3.3.5.2.2" xref="S4.Ex2.m2.3.3.3.5.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S4.Ex2.m2.2.2.2.2" xref="S4.Ex2.m2.2.2.2.2a.cmml">s</mtext><mo id="S4.Ex2.m2.3.3.3.5.2.3" xref="S4.Ex2.m2.3.3.3.5.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S4.Ex2.m2.3.3.3.3" xref="S4.Ex2.m2.3.3.3.3a.cmml">g</mtext><mo id="S4.Ex2.m2.3.3.3.5.2.4" stretchy="false" xref="S4.Ex2.m2.3.3.3.5.1.cmml">)</mo></mrow><mo id="S4.Ex2.m2.3.3.3.4" xref="S4.Ex2.m2.3.3.3.4.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S4.Ex2.m2.3.3.3.6" xref="S4.Ex2.m2.3.3.3.6.cmml">𝒯</mi></mrow></msub><mo id="S4.Ex2.m2.6.6.1.2a" xref="S4.Ex2.m2.6.6.1.2.cmml">⁢</mo><mrow id="S4.Ex2.m2.6.6.1.1.1" xref="S4.Ex2.m2.6.6.1.1.2.cmml"><mo id="S4.Ex2.m2.6.6.1.1.1.2" stretchy="false" xref="S4.Ex2.m2.6.6.1.1.2.1.cmml">[</mo><mrow id="S4.Ex2.m2.6.6.1.1.1.1" xref="S4.Ex2.m2.6.6.1.1.1.1.cmml"><mo id="S4.Ex2.m2.6.6.1.1.1.1a" rspace="0.167em" xref="S4.Ex2.m2.6.6.1.1.1.1.cmml">−</mo><mrow id="S4.Ex2.m2.6.6.1.1.1.1.1" xref="S4.Ex2.m2.6.6.1.1.1.1.1.cmml"><mrow id="S4.Ex2.m2.6.6.1.1.1.1.1.3" xref="S4.Ex2.m2.6.6.1.1.1.1.1.3.cmml"><mi id="S4.Ex2.m2.6.6.1.1.1.1.1.3.1" xref="S4.Ex2.m2.6.6.1.1.1.1.1.3.1.cmml">log</mi><mo id="S4.Ex2.m2.6.6.1.1.1.1.1.3a" lspace="0.167em" xref="S4.Ex2.m2.6.6.1.1.1.1.1.3.cmml">⁡</mo><msub id="S4.Ex2.m2.6.6.1.1.1.1.1.3.2" xref="S4.Ex2.m2.6.6.1.1.1.1.1.3.2.cmml"><mi id="S4.Ex2.m2.6.6.1.1.1.1.1.3.2.2" xref="S4.Ex2.m2.6.6.1.1.1.1.1.3.2.2.cmml">π</mi><mi id="S4.Ex2.m2.6.6.1.1.1.1.1.3.2.3" xref="S4.Ex2.m2.6.6.1.1.1.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo id="S4.Ex2.m2.6.6.1.1.1.1.1.2" xref="S4.Ex2.m2.6.6.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex2.m2.6.6.1.1.1.1.1.1.1" xref="S4.Ex2.m2.6.6.1.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex2.m2.6.6.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex2.m2.6.6.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex2.m2.6.6.1.1.1.1.1.1.1.1" xref="S4.Ex2.m2.6.6.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.Ex2.m2.6.6.1.1.1.1.1.1.1.1.2" xref="S4.Ex2.m2.6.6.1.1.1.1.1.1.1.1.2a.cmml">a</mtext><mo fence="false" id="S4.Ex2.m2.6.6.1.1.1.1.1.1.1.1.1" xref="S4.Ex2.m2.6.6.1.1.1.1.1.1.1.1.1.cmml">|</mo><mrow id="S4.Ex2.m2.6.6.1.1.1.1.1.1.1.1.3.2" xref="S4.Ex2.m2.6.6.1.1.1.1.1.1.1.1.3.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.Ex2.m2.4.4" xref="S4.Ex2.m2.4.4a.cmml">s</mtext><mo id="S4.Ex2.m2.6.6.1.1.1.1.1.1.1.1.3.2.1" xref="S4.Ex2.m2.6.6.1.1.1.1.1.1.1.1.3.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S4.Ex2.m2.5.5" xref="S4.Ex2.m2.5.5a.cmml">g</mtext></mrow></mrow><mo id="S4.Ex2.m2.6.6.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex2.m2.6.6.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.Ex2.m2.6.6.1.1.1.3" stretchy="false" xref="S4.Ex2.m2.6.6.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex2.m2.6b"><apply id="S4.Ex2.m2.6.6.cmml" xref="S4.Ex2.m2.6.6"><eq id="S4.Ex2.m2.6.6.2.cmml" xref="S4.Ex2.m2.6.6.2"></eq><csymbol cd="latexml" id="S4.Ex2.m2.6.6.3.cmml" xref="S4.Ex2.m2.6.6.3">absent</csymbol><apply id="S4.Ex2.m2.6.6.1.cmml" xref="S4.Ex2.m2.6.6.1"><times id="S4.Ex2.m2.6.6.1.2.cmml" xref="S4.Ex2.m2.6.6.1.2"></times><apply id="S4.Ex2.m2.6.6.1.3.cmml" xref="S4.Ex2.m2.6.6.1.3"><divide id="S4.Ex2.m2.6.6.1.3.1.cmml" xref="S4.Ex2.m2.6.6.1.3"></divide><cn id="S4.Ex2.m2.6.6.1.3.2.cmml" type="integer" xref="S4.Ex2.m2.6.6.1.3.2">1</cn><ci id="S4.Ex2.m2.6.6.1.3.3.cmml" xref="S4.Ex2.m2.6.6.1.3.3">𝐾</ci></apply><apply id="S4.Ex2.m2.6.6.1.4.cmml" xref="S4.Ex2.m2.6.6.1.4"><csymbol cd="ambiguous" id="S4.Ex2.m2.6.6.1.4.1.cmml" xref="S4.Ex2.m2.6.6.1.4">subscript</csymbol><ci id="S4.Ex2.m2.6.6.1.4.2.cmml" xref="S4.Ex2.m2.6.6.1.4.2">𝔼</ci><apply id="S4.Ex2.m2.3.3.3.cmml" xref="S4.Ex2.m2.3.3.3"><csymbol cd="latexml" id="S4.Ex2.m2.3.3.3.4.cmml" xref="S4.Ex2.m2.3.3.3.4">similar-to</csymbol><vector id="S4.Ex2.m2.3.3.3.5.1.cmml" xref="S4.Ex2.m2.3.3.3.5.2"><ci id="S4.Ex2.m2.1.1.1.1a.cmml" xref="S4.Ex2.m2.1.1.1.1"><mtext class="ltx_mathvariant_bold" id="S4.Ex2.m2.1.1.1.1.cmml" mathsize="70%" xref="S4.Ex2.m2.1.1.1.1">a</mtext></ci><ci id="S4.Ex2.m2.2.2.2.2a.cmml" xref="S4.Ex2.m2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.Ex2.m2.2.2.2.2.cmml" mathsize="70%" xref="S4.Ex2.m2.2.2.2.2">s</mtext></ci><ci id="S4.Ex2.m2.3.3.3.3a.cmml" xref="S4.Ex2.m2.3.3.3.3"><mtext class="ltx_mathvariant_bold" id="S4.Ex2.m2.3.3.3.3.cmml" mathsize="70%" xref="S4.Ex2.m2.3.3.3.3">g</mtext></ci></vector><ci id="S4.Ex2.m2.3.3.3.6.cmml" xref="S4.Ex2.m2.3.3.3.6">𝒯</ci></apply></apply><apply id="S4.Ex2.m2.6.6.1.1.2.cmml" xref="S4.Ex2.m2.6.6.1.1.1"><csymbol cd="latexml" id="S4.Ex2.m2.6.6.1.1.2.1.cmml" xref="S4.Ex2.m2.6.6.1.1.1.2">delimited-[]</csymbol><apply id="S4.Ex2.m2.6.6.1.1.1.1.cmml" xref="S4.Ex2.m2.6.6.1.1.1.1"><minus id="S4.Ex2.m2.6.6.1.1.1.1.2.cmml" xref="S4.Ex2.m2.6.6.1.1.1.1"></minus><apply id="S4.Ex2.m2.6.6.1.1.1.1.1.cmml" xref="S4.Ex2.m2.6.6.1.1.1.1.1"><times id="S4.Ex2.m2.6.6.1.1.1.1.1.2.cmml" xref="S4.Ex2.m2.6.6.1.1.1.1.1.2"></times><apply id="S4.Ex2.m2.6.6.1.1.1.1.1.3.cmml" xref="S4.Ex2.m2.6.6.1.1.1.1.1.3"><log id="S4.Ex2.m2.6.6.1.1.1.1.1.3.1.cmml" xref="S4.Ex2.m2.6.6.1.1.1.1.1.3.1"></log><apply id="S4.Ex2.m2.6.6.1.1.1.1.1.3.2.cmml" xref="S4.Ex2.m2.6.6.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.Ex2.m2.6.6.1.1.1.1.1.3.2.1.cmml" xref="S4.Ex2.m2.6.6.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.Ex2.m2.6.6.1.1.1.1.1.3.2.2.cmml" xref="S4.Ex2.m2.6.6.1.1.1.1.1.3.2.2">𝜋</ci><ci id="S4.Ex2.m2.6.6.1.1.1.1.1.3.2.3.cmml" xref="S4.Ex2.m2.6.6.1.1.1.1.1.3.2.3">𝜃</ci></apply></apply><apply id="S4.Ex2.m2.6.6.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex2.m2.6.6.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex2.m2.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex2.m2.6.6.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.Ex2.m2.6.6.1.1.1.1.1.1.1.1.2a.cmml" xref="S4.Ex2.m2.6.6.1.1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.Ex2.m2.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex2.m2.6.6.1.1.1.1.1.1.1.1.2">a</mtext></ci><list id="S4.Ex2.m2.6.6.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex2.m2.6.6.1.1.1.1.1.1.1.1.3.2"><ci id="S4.Ex2.m2.4.4a.cmml" xref="S4.Ex2.m2.4.4"><mtext class="ltx_mathvariant_bold" id="S4.Ex2.m2.4.4.cmml" xref="S4.Ex2.m2.4.4">s</mtext></ci><ci id="S4.Ex2.m2.5.5a.cmml" xref="S4.Ex2.m2.5.5"><mtext class="ltx_mathvariant_bold" id="S4.Ex2.m2.5.5.cmml" xref="S4.Ex2.m2.5.5">g</mtext></ci></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex2.m2.6c">\displaystyle=\frac{1}{K}\mathbb{E}_{(\textbf{a},\textbf{s},\textbf{g})\sim%
\mathcal{T}}[-\log\pi_{\theta}(\textbf{a}|\textbf{s},\textbf{g})]</annotation><annotation encoding="application/x-llamapun" id="S4.Ex2.m2.6d">= divide start_ARG 1 end_ARG start_ARG italic_K end_ARG blackboard_E start_POSTSUBSCRIPT ( a , s , g ) ∼ caligraphic_T end_POSTSUBSCRIPT [ - roman_log italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( a | s , g ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{K}\mathbb{E}_{(\textbf{a},\textbf{s},\textbf{g})\sim%
\mathcal{T}}\bigg{[}\sum_{k=1}^{K}-\log\pi_{\theta}(a_{k}|\textbf{s}_{K,k},%
\textbf{g}_{K,k})\bigg{]}." class="ltx_Math" display="inline" id="S4.E3.m1.8"><semantics id="S4.E3.m1.8a"><mrow id="S4.E3.m1.8.8.1" xref="S4.E3.m1.8.8.1.1.cmml"><mrow id="S4.E3.m1.8.8.1.1" xref="S4.E3.m1.8.8.1.1.cmml"><mi id="S4.E3.m1.8.8.1.1.3" xref="S4.E3.m1.8.8.1.1.3.cmml"></mi><mo id="S4.E3.m1.8.8.1.1.2" xref="S4.E3.m1.8.8.1.1.2.cmml">=</mo><mrow id="S4.E3.m1.8.8.1.1.1" xref="S4.E3.m1.8.8.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E3.m1.8.8.1.1.1.3" xref="S4.E3.m1.8.8.1.1.1.3.cmml"><mfrac id="S4.E3.m1.8.8.1.1.1.3a" xref="S4.E3.m1.8.8.1.1.1.3.cmml"><mn id="S4.E3.m1.8.8.1.1.1.3.2" xref="S4.E3.m1.8.8.1.1.1.3.2.cmml">1</mn><mi id="S4.E3.m1.8.8.1.1.1.3.3" xref="S4.E3.m1.8.8.1.1.1.3.3.cmml">K</mi></mfrac></mstyle><mo id="S4.E3.m1.8.8.1.1.1.2" xref="S4.E3.m1.8.8.1.1.1.2.cmml">⁢</mo><msub id="S4.E3.m1.8.8.1.1.1.4" xref="S4.E3.m1.8.8.1.1.1.4.cmml"><mi id="S4.E3.m1.8.8.1.1.1.4.2" xref="S4.E3.m1.8.8.1.1.1.4.2.cmml">𝔼</mi><mrow id="S4.E3.m1.3.3.3" xref="S4.E3.m1.3.3.3.cmml"><mrow id="S4.E3.m1.3.3.3.5.2" xref="S4.E3.m1.3.3.3.5.1.cmml"><mo id="S4.E3.m1.3.3.3.5.2.1" stretchy="false" xref="S4.E3.m1.3.3.3.5.1.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S4.E3.m1.1.1.1.1" xref="S4.E3.m1.1.1.1.1a.cmml">a</mtext><mo id="S4.E3.m1.3.3.3.5.2.2" xref="S4.E3.m1.3.3.3.5.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S4.E3.m1.2.2.2.2" xref="S4.E3.m1.2.2.2.2a.cmml">s</mtext><mo id="S4.E3.m1.3.3.3.5.2.3" xref="S4.E3.m1.3.3.3.5.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S4.E3.m1.3.3.3.3" xref="S4.E3.m1.3.3.3.3a.cmml">g</mtext><mo id="S4.E3.m1.3.3.3.5.2.4" stretchy="false" xref="S4.E3.m1.3.3.3.5.1.cmml">)</mo></mrow><mo id="S4.E3.m1.3.3.3.4" xref="S4.E3.m1.3.3.3.4.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S4.E3.m1.3.3.3.6" xref="S4.E3.m1.3.3.3.6.cmml">𝒯</mi></mrow></msub><mo id="S4.E3.m1.8.8.1.1.1.2a" xref="S4.E3.m1.8.8.1.1.1.2.cmml">⁢</mo><mrow id="S4.E3.m1.8.8.1.1.1.1.1" xref="S4.E3.m1.8.8.1.1.1.1.2.cmml"><mo id="S4.E3.m1.8.8.1.1.1.1.1.2" maxsize="210%" minsize="210%" xref="S4.E3.m1.8.8.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E3.m1.8.8.1.1.1.1.1.1" xref="S4.E3.m1.8.8.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E3.m1.8.8.1.1.1.1.1.1.3" xref="S4.E3.m1.8.8.1.1.1.1.1.1.3.cmml"><munderover id="S4.E3.m1.8.8.1.1.1.1.1.1.3a" xref="S4.E3.m1.8.8.1.1.1.1.1.1.3.cmml"><mo id="S4.E3.m1.8.8.1.1.1.1.1.1.3.2.2" movablelimits="false" xref="S4.E3.m1.8.8.1.1.1.1.1.1.3.2.2.cmml">∑</mo><mrow id="S4.E3.m1.8.8.1.1.1.1.1.1.3.2.3" xref="S4.E3.m1.8.8.1.1.1.1.1.1.3.2.3.cmml"><mi id="S4.E3.m1.8.8.1.1.1.1.1.1.3.2.3.2" xref="S4.E3.m1.8.8.1.1.1.1.1.1.3.2.3.2.cmml">k</mi><mo id="S4.E3.m1.8.8.1.1.1.1.1.1.3.2.3.1" xref="S4.E3.m1.8.8.1.1.1.1.1.1.3.2.3.1.cmml">=</mo><mn id="S4.E3.m1.8.8.1.1.1.1.1.1.3.2.3.3" xref="S4.E3.m1.8.8.1.1.1.1.1.1.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E3.m1.8.8.1.1.1.1.1.1.3.3" xref="S4.E3.m1.8.8.1.1.1.1.1.1.3.3.cmml">K</mi></munderover></mstyle><mo id="S4.E3.m1.8.8.1.1.1.1.1.1.2" xref="S4.E3.m1.8.8.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S4.E3.m1.8.8.1.1.1.1.1.1.1" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.cmml"><mrow id="S4.E3.m1.8.8.1.1.1.1.1.1.1.3" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E3.m1.8.8.1.1.1.1.1.1.1.3.1" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S4.E3.m1.8.8.1.1.1.1.1.1.1.3a" lspace="0.167em" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S4.E3.m1.8.8.1.1.1.1.1.1.1.3.2" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.E3.m1.8.8.1.1.1.1.1.1.1.3.2.2" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.3.2.2.cmml">π</mi><mi id="S4.E3.m1.8.8.1.1.1.1.1.1.1.3.2.3" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo id="S4.E3.m1.8.8.1.1.1.1.1.1.1.2" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.4" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.4.2" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.4.2.cmml">a</mi><mi id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.4.3" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.4.3.cmml">k</mi></msub><mo fence="false" id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><msub id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.2a.cmml">s</mtext><mrow id="S4.E3.m1.5.5.2.4" xref="S4.E3.m1.5.5.2.3.cmml"><mi id="S4.E3.m1.4.4.1.1" xref="S4.E3.m1.4.4.1.1.cmml">K</mi><mo id="S4.E3.m1.5.5.2.4.1" xref="S4.E3.m1.5.5.2.3.cmml">,</mo><mi id="S4.E3.m1.5.5.2.2" xref="S4.E3.m1.5.5.2.2.cmml">k</mi></mrow></msub><mo id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2.2a.cmml">g</mtext><mrow id="S4.E3.m1.7.7.2.4" xref="S4.E3.m1.7.7.2.3.cmml"><mi id="S4.E3.m1.6.6.1.1" xref="S4.E3.m1.6.6.1.1.cmml">K</mi><mo id="S4.E3.m1.7.7.2.4.1" xref="S4.E3.m1.7.7.2.3.cmml">,</mo><mi id="S4.E3.m1.7.7.2.2" xref="S4.E3.m1.7.7.2.2.cmml">k</mi></mrow></msub></mrow></mrow><mo id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E3.m1.8.8.1.1.1.1.1.3" maxsize="210%" minsize="210%" xref="S4.E3.m1.8.8.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S4.E3.m1.8.8.1.2" lspace="0em" xref="S4.E3.m1.8.8.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.8b"><apply id="S4.E3.m1.8.8.1.1.cmml" xref="S4.E3.m1.8.8.1"><eq id="S4.E3.m1.8.8.1.1.2.cmml" xref="S4.E3.m1.8.8.1.1.2"></eq><csymbol cd="latexml" id="S4.E3.m1.8.8.1.1.3.cmml" xref="S4.E3.m1.8.8.1.1.3">absent</csymbol><apply id="S4.E3.m1.8.8.1.1.1.cmml" xref="S4.E3.m1.8.8.1.1.1"><times id="S4.E3.m1.8.8.1.1.1.2.cmml" xref="S4.E3.m1.8.8.1.1.1.2"></times><apply id="S4.E3.m1.8.8.1.1.1.3.cmml" xref="S4.E3.m1.8.8.1.1.1.3"><divide id="S4.E3.m1.8.8.1.1.1.3.1.cmml" xref="S4.E3.m1.8.8.1.1.1.3"></divide><cn id="S4.E3.m1.8.8.1.1.1.3.2.cmml" type="integer" xref="S4.E3.m1.8.8.1.1.1.3.2">1</cn><ci id="S4.E3.m1.8.8.1.1.1.3.3.cmml" xref="S4.E3.m1.8.8.1.1.1.3.3">𝐾</ci></apply><apply id="S4.E3.m1.8.8.1.1.1.4.cmml" xref="S4.E3.m1.8.8.1.1.1.4"><csymbol cd="ambiguous" id="S4.E3.m1.8.8.1.1.1.4.1.cmml" xref="S4.E3.m1.8.8.1.1.1.4">subscript</csymbol><ci id="S4.E3.m1.8.8.1.1.1.4.2.cmml" xref="S4.E3.m1.8.8.1.1.1.4.2">𝔼</ci><apply id="S4.E3.m1.3.3.3.cmml" xref="S4.E3.m1.3.3.3"><csymbol cd="latexml" id="S4.E3.m1.3.3.3.4.cmml" xref="S4.E3.m1.3.3.3.4">similar-to</csymbol><vector id="S4.E3.m1.3.3.3.5.1.cmml" xref="S4.E3.m1.3.3.3.5.2"><ci id="S4.E3.m1.1.1.1.1a.cmml" xref="S4.E3.m1.1.1.1.1"><mtext class="ltx_mathvariant_bold" id="S4.E3.m1.1.1.1.1.cmml" mathsize="70%" xref="S4.E3.m1.1.1.1.1">a</mtext></ci><ci id="S4.E3.m1.2.2.2.2a.cmml" xref="S4.E3.m1.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.E3.m1.2.2.2.2.cmml" mathsize="70%" xref="S4.E3.m1.2.2.2.2">s</mtext></ci><ci id="S4.E3.m1.3.3.3.3a.cmml" xref="S4.E3.m1.3.3.3.3"><mtext class="ltx_mathvariant_bold" id="S4.E3.m1.3.3.3.3.cmml" mathsize="70%" xref="S4.E3.m1.3.3.3.3">g</mtext></ci></vector><ci id="S4.E3.m1.3.3.3.6.cmml" xref="S4.E3.m1.3.3.3.6">𝒯</ci></apply></apply><apply id="S4.E3.m1.8.8.1.1.1.1.2.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1"><csymbol cd="latexml" id="S4.E3.m1.8.8.1.1.1.1.2.1.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E3.m1.8.8.1.1.1.1.1.1.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1"><minus id="S4.E3.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.2"></minus><apply id="S4.E3.m1.8.8.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.8.8.1.1.1.1.1.1.3.1.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E3.m1.8.8.1.1.1.1.1.1.3.2.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.8.8.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.3">subscript</csymbol><sum id="S4.E3.m1.8.8.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.3.2.2"></sum><apply id="S4.E3.m1.8.8.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.3.2.3"><eq id="S4.E3.m1.8.8.1.1.1.1.1.1.3.2.3.1.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.3.2.3.1"></eq><ci id="S4.E3.m1.8.8.1.1.1.1.1.1.3.2.3.2.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.3.2.3.2">𝑘</ci><cn id="S4.E3.m1.8.8.1.1.1.1.1.1.3.2.3.3.cmml" type="integer" xref="S4.E3.m1.8.8.1.1.1.1.1.1.3.2.3.3">1</cn></apply></apply><ci id="S4.E3.m1.8.8.1.1.1.1.1.1.3.3.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.3.3">𝐾</ci></apply><apply id="S4.E3.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1"><times id="S4.E3.m1.8.8.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.2"></times><apply id="S4.E3.m1.8.8.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.3"><log id="S4.E3.m1.8.8.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.3.1"></log><apply id="S4.E3.m1.8.8.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E3.m1.8.8.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E3.m1.8.8.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.3.2.2">𝜋</ci><ci id="S4.E3.m1.8.8.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.3.2.3">𝜃</ci></apply></apply><apply id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3">conditional</csymbol><apply id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.4.2">𝑎</ci><ci id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.4.3">𝑘</ci></apply><list id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2"><apply id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.2a.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.2">s</mtext></ci><list id="S4.E3.m1.5.5.2.3.cmml" xref="S4.E3.m1.5.5.2.4"><ci id="S4.E3.m1.4.4.1.1.cmml" xref="S4.E3.m1.4.4.1.1">𝐾</ci><ci id="S4.E3.m1.5.5.2.2.cmml" xref="S4.E3.m1.5.5.2.2">𝑘</ci></list></apply><apply id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2.2a.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.2.2.2">g</mtext></ci><list id="S4.E3.m1.7.7.2.3.cmml" xref="S4.E3.m1.7.7.2.4"><ci id="S4.E3.m1.6.6.1.1.cmml" xref="S4.E3.m1.6.6.1.1">𝐾</ci><ci id="S4.E3.m1.7.7.2.2.cmml" xref="S4.E3.m1.7.7.2.2">𝑘</ci></list></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.8c">\displaystyle=\frac{1}{K}\mathbb{E}_{(\textbf{a},\textbf{s},\textbf{g})\sim%
\mathcal{T}}\bigg{[}\sum_{k=1}^{K}-\log\pi_{\theta}(a_{k}|\textbf{s}_{K,k},%
\textbf{g}_{K,k})\bigg{]}.</annotation><annotation encoding="application/x-llamapun" id="S4.E3.m1.8d">= divide start_ARG 1 end_ARG start_ARG italic_K end_ARG blackboard_E start_POSTSUBSCRIPT ( a , s , g ) ∼ caligraphic_T end_POSTSUBSCRIPT [ ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT - roman_log italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT | s start_POSTSUBSCRIPT italic_K , italic_k end_POSTSUBSCRIPT , g start_POSTSUBSCRIPT italic_K , italic_k end_POSTSUBSCRIPT ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p2.2">It’s important to note that the policies considered here encompass the deterministic policies utilized by the standard DT. Optimizing <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S4.E1" title="In 4.1. Decision Transformer and Overall Model Architecture ‣ 4. Methodology ‣ Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">1</span></a> is effectively equivalent to optimizing <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S4.E3" title="In 4.2. Max-Entropy Enhanced Exploration ‣ 4. Methodology ‣ Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">3</span></a>, under the assumption that the covariance matrix <math alttext="\sum_{\theta}" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m1.1"><semantics id="S4.SS2.p2.2.m1.1a"><msub id="S4.SS2.p2.2.m1.1.1" xref="S4.SS2.p2.2.m1.1.1.cmml"><mo id="S4.SS2.p2.2.m1.1.1.2" xref="S4.SS2.p2.2.m1.1.1.2.cmml">∑</mo><mi id="S4.SS2.p2.2.m1.1.1.3" xref="S4.SS2.p2.2.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m1.1b"><apply id="S4.SS2.p2.2.m1.1.1.cmml" xref="S4.SS2.p2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m1.1.1.1.cmml" xref="S4.SS2.p2.2.m1.1.1">subscript</csymbol><sum id="S4.SS2.p2.2.m1.1.1.2.cmml" xref="S4.SS2.p2.2.m1.1.1.2"></sum><ci id="S4.SS2.p2.2.m1.1.1.3.cmml" xref="S4.SS2.p2.2.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m1.1c">\sum_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m1.1d">∑ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> is diagonal and the variances remain constant across all dimensions. This scenario represents a special case encompassed by our assumption.</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.11">A crucial aspect of an online RL algorithm is its capacity to balance exploration and exploitation. However, the traditional formulation of a DT, as seen in <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S4.E3" title="In 4.2. Max-Entropy Enhanced Exploration ‣ 4. Methodology ‣ Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">3</span></a>, does not inherently facilitate exploration. To remedy this, we can use the policy entropy to encourage exploration, defined as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S6.EGx5">
<tbody id="S4.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle H_{\theta}^{\mathcal{T}}[\textbf{a}|\textbf{s},\textbf{g}]=" class="ltx_Math" display="inline" id="S4.Ex3.m1.3"><semantics id="S4.Ex3.m1.3a"><mrow id="S4.Ex3.m1.3.3" xref="S4.Ex3.m1.3.3.cmml"><mrow id="S4.Ex3.m1.3.3.1" xref="S4.Ex3.m1.3.3.1.cmml"><msubsup id="S4.Ex3.m1.3.3.1.3" xref="S4.Ex3.m1.3.3.1.3.cmml"><mi id="S4.Ex3.m1.3.3.1.3.2.2" xref="S4.Ex3.m1.3.3.1.3.2.2.cmml">H</mi><mi id="S4.Ex3.m1.3.3.1.3.2.3" xref="S4.Ex3.m1.3.3.1.3.2.3.cmml">θ</mi><mi class="ltx_font_mathcaligraphic" id="S4.Ex3.m1.3.3.1.3.3" xref="S4.Ex3.m1.3.3.1.3.3.cmml">𝒯</mi></msubsup><mo id="S4.Ex3.m1.3.3.1.2" xref="S4.Ex3.m1.3.3.1.2.cmml">⁢</mo><mrow id="S4.Ex3.m1.3.3.1.1.1" xref="S4.Ex3.m1.3.3.1.1.2.cmml"><mo id="S4.Ex3.m1.3.3.1.1.1.2" stretchy="false" xref="S4.Ex3.m1.3.3.1.1.2.1.cmml">[</mo><mrow id="S4.Ex3.m1.3.3.1.1.1.1" xref="S4.Ex3.m1.3.3.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.Ex3.m1.3.3.1.1.1.1.2" xref="S4.Ex3.m1.3.3.1.1.1.1.2a.cmml">a</mtext><mo fence="false" id="S4.Ex3.m1.3.3.1.1.1.1.1" xref="S4.Ex3.m1.3.3.1.1.1.1.1.cmml">|</mo><mrow id="S4.Ex3.m1.3.3.1.1.1.1.3.2" xref="S4.Ex3.m1.3.3.1.1.1.1.3.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.Ex3.m1.1.1" xref="S4.Ex3.m1.1.1a.cmml">s</mtext><mo id="S4.Ex3.m1.3.3.1.1.1.1.3.2.1" xref="S4.Ex3.m1.3.3.1.1.1.1.3.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S4.Ex3.m1.2.2" xref="S4.Ex3.m1.2.2a.cmml">g</mtext></mrow></mrow><mo id="S4.Ex3.m1.3.3.1.1.1.3" stretchy="false" xref="S4.Ex3.m1.3.3.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S4.Ex3.m1.3.3.2" xref="S4.Ex3.m1.3.3.2.cmml">=</mo><mi id="S4.Ex3.m1.3.3.3" xref="S4.Ex3.m1.3.3.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex3.m1.3b"><apply id="S4.Ex3.m1.3.3.cmml" xref="S4.Ex3.m1.3.3"><eq id="S4.Ex3.m1.3.3.2.cmml" xref="S4.Ex3.m1.3.3.2"></eq><apply id="S4.Ex3.m1.3.3.1.cmml" xref="S4.Ex3.m1.3.3.1"><times id="S4.Ex3.m1.3.3.1.2.cmml" xref="S4.Ex3.m1.3.3.1.2"></times><apply id="S4.Ex3.m1.3.3.1.3.cmml" xref="S4.Ex3.m1.3.3.1.3"><csymbol cd="ambiguous" id="S4.Ex3.m1.3.3.1.3.1.cmml" xref="S4.Ex3.m1.3.3.1.3">superscript</csymbol><apply id="S4.Ex3.m1.3.3.1.3.2.cmml" xref="S4.Ex3.m1.3.3.1.3"><csymbol cd="ambiguous" id="S4.Ex3.m1.3.3.1.3.2.1.cmml" xref="S4.Ex3.m1.3.3.1.3">subscript</csymbol><ci id="S4.Ex3.m1.3.3.1.3.2.2.cmml" xref="S4.Ex3.m1.3.3.1.3.2.2">𝐻</ci><ci id="S4.Ex3.m1.3.3.1.3.2.3.cmml" xref="S4.Ex3.m1.3.3.1.3.2.3">𝜃</ci></apply><ci id="S4.Ex3.m1.3.3.1.3.3.cmml" xref="S4.Ex3.m1.3.3.1.3.3">𝒯</ci></apply><apply id="S4.Ex3.m1.3.3.1.1.2.cmml" xref="S4.Ex3.m1.3.3.1.1.1"><csymbol cd="latexml" id="S4.Ex3.m1.3.3.1.1.2.1.cmml" xref="S4.Ex3.m1.3.3.1.1.1.2">delimited-[]</csymbol><apply id="S4.Ex3.m1.3.3.1.1.1.1.cmml" xref="S4.Ex3.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="S4.Ex3.m1.3.3.1.1.1.1.1.cmml" xref="S4.Ex3.m1.3.3.1.1.1.1.1">conditional</csymbol><ci id="S4.Ex3.m1.3.3.1.1.1.1.2a.cmml" xref="S4.Ex3.m1.3.3.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.Ex3.m1.3.3.1.1.1.1.2.cmml" xref="S4.Ex3.m1.3.3.1.1.1.1.2">a</mtext></ci><list id="S4.Ex3.m1.3.3.1.1.1.1.3.1.cmml" xref="S4.Ex3.m1.3.3.1.1.1.1.3.2"><ci id="S4.Ex3.m1.1.1a.cmml" xref="S4.Ex3.m1.1.1"><mtext class="ltx_mathvariant_bold" id="S4.Ex3.m1.1.1.cmml" xref="S4.Ex3.m1.1.1">s</mtext></ci><ci id="S4.Ex3.m1.2.2a.cmml" xref="S4.Ex3.m1.2.2"><mtext class="ltx_mathvariant_bold" id="S4.Ex3.m1.2.2.cmml" xref="S4.Ex3.m1.2.2">g</mtext></ci></list></apply></apply></apply><csymbol cd="latexml" id="S4.Ex3.m1.3.3.3.cmml" xref="S4.Ex3.m1.3.3.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex3.m1.3c">\displaystyle H_{\theta}^{\mathcal{T}}[\textbf{a}|\textbf{s},\textbf{g}]=</annotation><annotation encoding="application/x-llamapun" id="S4.Ex3.m1.3d">italic_H start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_T end_POSTSUPERSCRIPT [ a | s , g ] =</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\frac{1}{K}\mathbb{E}_{(\textbf{s},\textbf{g})\sim\mathcal{T}}%
\big{[}H(\pi_{\theta}(\textbf{a}|\textbf{s},\textbf{g}))\big{]}" class="ltx_Math" display="inline" id="S4.Ex3.m2.5"><semantics id="S4.Ex3.m2.5a"><mrow id="S4.Ex3.m2.5.5" xref="S4.Ex3.m2.5.5.cmml"><mstyle displaystyle="true" id="S4.Ex3.m2.5.5.3" xref="S4.Ex3.m2.5.5.3.cmml"><mfrac id="S4.Ex3.m2.5.5.3a" xref="S4.Ex3.m2.5.5.3.cmml"><mn id="S4.Ex3.m2.5.5.3.2" xref="S4.Ex3.m2.5.5.3.2.cmml">1</mn><mi id="S4.Ex3.m2.5.5.3.3" xref="S4.Ex3.m2.5.5.3.3.cmml">K</mi></mfrac></mstyle><mo id="S4.Ex3.m2.5.5.2" xref="S4.Ex3.m2.5.5.2.cmml">⁢</mo><msub id="S4.Ex3.m2.5.5.4" xref="S4.Ex3.m2.5.5.4.cmml"><mi id="S4.Ex3.m2.5.5.4.2" xref="S4.Ex3.m2.5.5.4.2.cmml">𝔼</mi><mrow id="S4.Ex3.m2.2.2.2" xref="S4.Ex3.m2.2.2.2.cmml"><mrow id="S4.Ex3.m2.2.2.2.4.2" xref="S4.Ex3.m2.2.2.2.4.1.cmml"><mo id="S4.Ex3.m2.2.2.2.4.2.1" stretchy="false" xref="S4.Ex3.m2.2.2.2.4.1.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S4.Ex3.m2.1.1.1.1" xref="S4.Ex3.m2.1.1.1.1a.cmml">s</mtext><mo id="S4.Ex3.m2.2.2.2.4.2.2" xref="S4.Ex3.m2.2.2.2.4.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S4.Ex3.m2.2.2.2.2" xref="S4.Ex3.m2.2.2.2.2a.cmml">g</mtext><mo id="S4.Ex3.m2.2.2.2.4.2.3" stretchy="false" xref="S4.Ex3.m2.2.2.2.4.1.cmml">)</mo></mrow><mo id="S4.Ex3.m2.2.2.2.3" xref="S4.Ex3.m2.2.2.2.3.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S4.Ex3.m2.2.2.2.5" xref="S4.Ex3.m2.2.2.2.5.cmml">𝒯</mi></mrow></msub><mo id="S4.Ex3.m2.5.5.2a" xref="S4.Ex3.m2.5.5.2.cmml">⁢</mo><mrow id="S4.Ex3.m2.5.5.1.1" xref="S4.Ex3.m2.5.5.1.2.cmml"><mo id="S4.Ex3.m2.5.5.1.1.2" maxsize="120%" minsize="120%" xref="S4.Ex3.m2.5.5.1.2.1.cmml">[</mo><mrow id="S4.Ex3.m2.5.5.1.1.1" xref="S4.Ex3.m2.5.5.1.1.1.cmml"><mi id="S4.Ex3.m2.5.5.1.1.1.3" xref="S4.Ex3.m2.5.5.1.1.1.3.cmml">H</mi><mo id="S4.Ex3.m2.5.5.1.1.1.2" xref="S4.Ex3.m2.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex3.m2.5.5.1.1.1.1.1" xref="S4.Ex3.m2.5.5.1.1.1.1.1.1.cmml"><mo id="S4.Ex3.m2.5.5.1.1.1.1.1.2" stretchy="false" xref="S4.Ex3.m2.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex3.m2.5.5.1.1.1.1.1.1" xref="S4.Ex3.m2.5.5.1.1.1.1.1.1.cmml"><msub id="S4.Ex3.m2.5.5.1.1.1.1.1.1.3" xref="S4.Ex3.m2.5.5.1.1.1.1.1.1.3.cmml"><mi id="S4.Ex3.m2.5.5.1.1.1.1.1.1.3.2" xref="S4.Ex3.m2.5.5.1.1.1.1.1.1.3.2.cmml">π</mi><mi id="S4.Ex3.m2.5.5.1.1.1.1.1.1.3.3" xref="S4.Ex3.m2.5.5.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S4.Ex3.m2.5.5.1.1.1.1.1.1.2" xref="S4.Ex3.m2.5.5.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex3.m2.5.5.1.1.1.1.1.1.1.1" xref="S4.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1" xref="S4.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.2a.cmml">a</mtext><mo fence="false" id="S4.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><mrow id="S4.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.3.2" xref="S4.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.3.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.Ex3.m2.3.3" xref="S4.Ex3.m2.3.3a.cmml">s</mtext><mo id="S4.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.1" xref="S4.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.3.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S4.Ex3.m2.4.4" xref="S4.Ex3.m2.4.4a.cmml">g</mtext></mrow></mrow><mo id="S4.Ex3.m2.5.5.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex3.m2.5.5.1.1.1.1.1.3" stretchy="false" xref="S4.Ex3.m2.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex3.m2.5.5.1.1.3" maxsize="120%" minsize="120%" xref="S4.Ex3.m2.5.5.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex3.m2.5b"><apply id="S4.Ex3.m2.5.5.cmml" xref="S4.Ex3.m2.5.5"><times id="S4.Ex3.m2.5.5.2.cmml" xref="S4.Ex3.m2.5.5.2"></times><apply id="S4.Ex3.m2.5.5.3.cmml" xref="S4.Ex3.m2.5.5.3"><divide id="S4.Ex3.m2.5.5.3.1.cmml" xref="S4.Ex3.m2.5.5.3"></divide><cn id="S4.Ex3.m2.5.5.3.2.cmml" type="integer" xref="S4.Ex3.m2.5.5.3.2">1</cn><ci id="S4.Ex3.m2.5.5.3.3.cmml" xref="S4.Ex3.m2.5.5.3.3">𝐾</ci></apply><apply id="S4.Ex3.m2.5.5.4.cmml" xref="S4.Ex3.m2.5.5.4"><csymbol cd="ambiguous" id="S4.Ex3.m2.5.5.4.1.cmml" xref="S4.Ex3.m2.5.5.4">subscript</csymbol><ci id="S4.Ex3.m2.5.5.4.2.cmml" xref="S4.Ex3.m2.5.5.4.2">𝔼</ci><apply id="S4.Ex3.m2.2.2.2.cmml" xref="S4.Ex3.m2.2.2.2"><csymbol cd="latexml" id="S4.Ex3.m2.2.2.2.3.cmml" xref="S4.Ex3.m2.2.2.2.3">similar-to</csymbol><interval closure="open" id="S4.Ex3.m2.2.2.2.4.1.cmml" xref="S4.Ex3.m2.2.2.2.4.2"><ci id="S4.Ex3.m2.1.1.1.1a.cmml" xref="S4.Ex3.m2.1.1.1.1"><mtext class="ltx_mathvariant_bold" id="S4.Ex3.m2.1.1.1.1.cmml" mathsize="70%" xref="S4.Ex3.m2.1.1.1.1">s</mtext></ci><ci id="S4.Ex3.m2.2.2.2.2a.cmml" xref="S4.Ex3.m2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.Ex3.m2.2.2.2.2.cmml" mathsize="70%" xref="S4.Ex3.m2.2.2.2.2">g</mtext></ci></interval><ci id="S4.Ex3.m2.2.2.2.5.cmml" xref="S4.Ex3.m2.2.2.2.5">𝒯</ci></apply></apply><apply id="S4.Ex3.m2.5.5.1.2.cmml" xref="S4.Ex3.m2.5.5.1.1"><csymbol cd="latexml" id="S4.Ex3.m2.5.5.1.2.1.cmml" xref="S4.Ex3.m2.5.5.1.1.2">delimited-[]</csymbol><apply id="S4.Ex3.m2.5.5.1.1.1.cmml" xref="S4.Ex3.m2.5.5.1.1.1"><times id="S4.Ex3.m2.5.5.1.1.1.2.cmml" xref="S4.Ex3.m2.5.5.1.1.1.2"></times><ci id="S4.Ex3.m2.5.5.1.1.1.3.cmml" xref="S4.Ex3.m2.5.5.1.1.1.3">𝐻</ci><apply id="S4.Ex3.m2.5.5.1.1.1.1.1.1.cmml" xref="S4.Ex3.m2.5.5.1.1.1.1.1"><times id="S4.Ex3.m2.5.5.1.1.1.1.1.1.2.cmml" xref="S4.Ex3.m2.5.5.1.1.1.1.1.1.2"></times><apply id="S4.Ex3.m2.5.5.1.1.1.1.1.1.3.cmml" xref="S4.Ex3.m2.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex3.m2.5.5.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex3.m2.5.5.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.Ex3.m2.5.5.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex3.m2.5.5.1.1.1.1.1.1.3.2">𝜋</ci><ci id="S4.Ex3.m2.5.5.1.1.1.1.1.1.3.3.cmml" xref="S4.Ex3.m2.5.5.1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S4.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex3.m2.5.5.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.2a.cmml" xref="S4.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.2">a</mtext></ci><list id="S4.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.3.2"><ci id="S4.Ex3.m2.3.3a.cmml" xref="S4.Ex3.m2.3.3"><mtext class="ltx_mathvariant_bold" id="S4.Ex3.m2.3.3.cmml" xref="S4.Ex3.m2.3.3">s</mtext></ci><ci id="S4.Ex3.m2.4.4a.cmml" xref="S4.Ex3.m2.4.4"><mtext class="ltx_mathvariant_bold" id="S4.Ex3.m2.4.4.cmml" xref="S4.Ex3.m2.4.4">g</mtext></ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex3.m2.5c">\displaystyle\frac{1}{K}\mathbb{E}_{(\textbf{s},\textbf{g})\sim\mathcal{T}}%
\big{[}H(\pi_{\theta}(\textbf{a}|\textbf{s},\textbf{g}))\big{]}</annotation><annotation encoding="application/x-llamapun" id="S4.Ex3.m2.5d">divide start_ARG 1 end_ARG start_ARG italic_K end_ARG blackboard_E start_POSTSUBSCRIPT ( s , g ) ∼ caligraphic_T end_POSTSUBSCRIPT [ italic_H ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( a | s , g ) ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle=" class="ltx_Math" display="inline" id="S4.E4.m1.1"><semantics id="S4.E4.m1.1a"><mo id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S4.E4.m1.1b"><eq id="S4.E4.m1.1.1.cmml" xref="S4.E4.m1.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.1c">\displaystyle=</annotation><annotation encoding="application/x-llamapun" id="S4.E4.m1.1d">=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\frac{1}{K}\mathbb{E}_{(\textbf{s},\textbf{g})\sim\mathcal{T}}%
\big{[}\sum_{k=1}^{K}H[(\pi_{\theta}(a_{k}|\textbf{s}_{K,k},\textbf{g}_{K,k})]%
\big{]}," class="ltx_math_unparsed" display="inline" id="S4.E4.m2.6"><semantics id="S4.E4.m2.6a"><mrow id="S4.E4.m2.6b"><mstyle displaystyle="true" id="S4.E4.m2.6.7"><mfrac id="S4.E4.m2.6.7a"><mn id="S4.E4.m2.6.7.2">1</mn><mi id="S4.E4.m2.6.7.3">K</mi></mfrac></mstyle><msub id="S4.E4.m2.6.8"><mi id="S4.E4.m2.6.8.2">𝔼</mi><mrow id="S4.E4.m2.2.2.2"><mrow id="S4.E4.m2.2.2.2.4.2"><mo id="S4.E4.m2.2.2.2.4.2.1" stretchy="false">(</mo><mtext class="ltx_mathvariant_bold" id="S4.E4.m2.1.1.1.1">s</mtext><mo id="S4.E4.m2.2.2.2.4.2.2">,</mo><mtext class="ltx_mathvariant_bold" id="S4.E4.m2.2.2.2.2">g</mtext><mo id="S4.E4.m2.2.2.2.4.2.3" stretchy="false">)</mo></mrow><mo id="S4.E4.m2.2.2.2.3">∼</mo><mi class="ltx_font_mathcaligraphic" id="S4.E4.m2.2.2.2.5">𝒯</mi></mrow></msub><mrow id="S4.E4.m2.6.9"><mo id="S4.E4.m2.6.9.1" maxsize="120%" minsize="120%">[</mo><mstyle displaystyle="true" id="S4.E4.m2.6.9.2"><munderover id="S4.E4.m2.6.9.2a"><mo id="S4.E4.m2.6.9.2.2.2" movablelimits="false">∑</mo><mrow id="S4.E4.m2.6.9.2.2.3"><mi id="S4.E4.m2.6.9.2.2.3.2">k</mi><mo id="S4.E4.m2.6.9.2.2.3.1">=</mo><mn id="S4.E4.m2.6.9.2.2.3.3">1</mn></mrow><mi id="S4.E4.m2.6.9.2.3">K</mi></munderover></mstyle><mi id="S4.E4.m2.6.9.3">H</mi><mrow id="S4.E4.m2.6.9.4"><mo id="S4.E4.m2.6.9.4.1" stretchy="false">[</mo><mrow id="S4.E4.m2.6.9.4.2"><mo id="S4.E4.m2.6.9.4.2.1" stretchy="false">(</mo><msub id="S4.E4.m2.6.9.4.2.2"><mi id="S4.E4.m2.6.9.4.2.2.2">π</mi><mi id="S4.E4.m2.6.9.4.2.2.3">θ</mi></msub><mrow id="S4.E4.m2.6.9.4.2.3"><mo id="S4.E4.m2.6.9.4.2.3.1" stretchy="false">(</mo><msub id="S4.E4.m2.6.9.4.2.3.2"><mi id="S4.E4.m2.6.9.4.2.3.2.2">a</mi><mi id="S4.E4.m2.6.9.4.2.3.2.3">k</mi></msub><mo fence="false" id="S4.E4.m2.6.9.4.2.3.3" rspace="0.167em" stretchy="false">|</mo><msub id="S4.E4.m2.6.9.4.2.3.4"><mtext class="ltx_mathvariant_bold" id="S4.E4.m2.6.9.4.2.3.4.2">s</mtext><mrow id="S4.E4.m2.4.4.2.4"><mi id="S4.E4.m2.3.3.1.1">K</mi><mo id="S4.E4.m2.4.4.2.4.1">,</mo><mi id="S4.E4.m2.4.4.2.2">k</mi></mrow></msub><mo id="S4.E4.m2.6.9.4.2.3.5">,</mo><msub id="S4.E4.m2.6.9.4.2.3.6"><mtext class="ltx_mathvariant_bold" id="S4.E4.m2.6.9.4.2.3.6.2">g</mtext><mrow id="S4.E4.m2.6.6.2.4"><mi id="S4.E4.m2.5.5.1.1">K</mi><mo id="S4.E4.m2.6.6.2.4.1">,</mo><mi id="S4.E4.m2.6.6.2.2">k</mi></mrow></msub><mo id="S4.E4.m2.6.9.4.2.3.7" stretchy="false">)</mo></mrow><mo id="S4.E4.m2.6.9.4.2.4" stretchy="false">]</mo></mrow><mo id="S4.E4.m2.6.9.4.3" maxsize="120%" minsize="120%">]</mo></mrow><mo id="S4.E4.m2.6.9.5">,</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.E4.m2.6c">\displaystyle\frac{1}{K}\mathbb{E}_{(\textbf{s},\textbf{g})\sim\mathcal{T}}%
\big{[}\sum_{k=1}^{K}H[(\pi_{\theta}(a_{k}|\textbf{s}_{K,k},\textbf{g}_{K,k})]%
\big{]},</annotation><annotation encoding="application/x-llamapun" id="S4.E4.m2.6d">divide start_ARG 1 end_ARG start_ARG italic_K end_ARG blackboard_E start_POSTSUBSCRIPT ( s , g ) ∼ caligraphic_T end_POSTSUBSCRIPT [ ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_H [ ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT | s start_POSTSUBSCRIPT italic_K , italic_k end_POSTSUBSCRIPT , g start_POSTSUBSCRIPT italic_K , italic_k end_POSTSUBSCRIPT ) ] ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p3.3">where <math alttext="H[\pi_{\theta}(a_{k})]" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1"><semantics id="S4.SS2.p3.1.m1.1a"><mrow id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3.cmml">H</mi><mo id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.p3.1.m1.1.1.1.1" xref="S4.SS2.p3.1.m1.1.1.1.2.cmml"><mo id="S4.SS2.p3.1.m1.1.1.1.1.2" stretchy="false" xref="S4.SS2.p3.1.m1.1.1.1.2.1.cmml">[</mo><mrow id="S4.SS2.p3.1.m1.1.1.1.1.1" xref="S4.SS2.p3.1.m1.1.1.1.1.1.cmml"><msub id="S4.SS2.p3.1.m1.1.1.1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.1.1.1.3.cmml"><mi id="S4.SS2.p3.1.m1.1.1.1.1.1.3.2" xref="S4.SS2.p3.1.m1.1.1.1.1.1.3.2.cmml">π</mi><mi id="S4.SS2.p3.1.m1.1.1.1.1.1.3.3" xref="S4.SS2.p3.1.m1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S4.SS2.p3.1.m1.1.1.1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.p3.1.m1.1.1.1.1.1.1.1" xref="S4.SS2.p3.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.SS2.p3.1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS2.p3.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.SS2.p3.1.m1.1.1.1.1.1.1.1.1" xref="S4.SS2.p3.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.1.1.1.1.1.1.2.cmml">a</mi><mi id="S4.SS2.p3.1.m1.1.1.1.1.1.1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S4.SS2.p3.1.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.SS2.p3.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p3.1.m1.1.1.1.1.3" stretchy="false" xref="S4.SS2.p3.1.m1.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><times id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2"></times><ci id="S4.SS2.p3.1.m1.1.1.3.cmml" xref="S4.SS2.p3.1.m1.1.1.3">𝐻</ci><apply id="S4.SS2.p3.1.m1.1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.p3.1.m1.1.1.1.2.1.cmml" xref="S4.SS2.p3.1.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.SS2.p3.1.m1.1.1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1.1.1.1"><times id="S4.SS2.p3.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.1.1.1.2"></times><apply id="S4.SS2.p3.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS2.p3.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.1.1.1.1.3.1.cmml" xref="S4.SS2.p3.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p3.1.m1.1.1.1.1.1.3.2.cmml" xref="S4.SS2.p3.1.m1.1.1.1.1.1.3.2">𝜋</ci><ci id="S4.SS2.p3.1.m1.1.1.1.1.1.3.3.cmml" xref="S4.SS2.p3.1.m1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S4.SS2.p3.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p3.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.1.1.1.1.1.1.2">𝑎</ci><ci id="S4.SS2.p3.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p3.1.m1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">H[\pi_{\theta}(a_{k})]</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.1d">italic_H [ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) ]</annotation></semantics></math> denotes the entropy of the distribution <math alttext="\pi_{\theta}(a_{k})" class="ltx_Math" display="inline" id="S4.SS2.p3.2.m2.1"><semantics id="S4.SS2.p3.2.m2.1a"><mrow id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml"><msub id="S4.SS2.p3.2.m2.1.1.3" xref="S4.SS2.p3.2.m2.1.1.3.cmml"><mi id="S4.SS2.p3.2.m2.1.1.3.2" xref="S4.SS2.p3.2.m2.1.1.3.2.cmml">π</mi><mi id="S4.SS2.p3.2.m2.1.1.3.3" xref="S4.SS2.p3.2.m2.1.1.3.3.cmml">θ</mi></msub><mo id="S4.SS2.p3.2.m2.1.1.2" xref="S4.SS2.p3.2.m2.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.p3.2.m2.1.1.1.1" xref="S4.SS2.p3.2.m2.1.1.1.1.1.cmml"><mo id="S4.SS2.p3.2.m2.1.1.1.1.2" stretchy="false" xref="S4.SS2.p3.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S4.SS2.p3.2.m2.1.1.1.1.1" xref="S4.SS2.p3.2.m2.1.1.1.1.1.cmml"><mi id="S4.SS2.p3.2.m2.1.1.1.1.1.2" xref="S4.SS2.p3.2.m2.1.1.1.1.1.2.cmml">a</mi><mi id="S4.SS2.p3.2.m2.1.1.1.1.1.3" xref="S4.SS2.p3.2.m2.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S4.SS2.p3.2.m2.1.1.1.1.3" stretchy="false" xref="S4.SS2.p3.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1"><times id="S4.SS2.p3.2.m2.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2"></times><apply id="S4.SS2.p3.2.m2.1.1.3.cmml" xref="S4.SS2.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.1.3.1.cmml" xref="S4.SS2.p3.2.m2.1.1.3">subscript</csymbol><ci id="S4.SS2.p3.2.m2.1.1.3.2.cmml" xref="S4.SS2.p3.2.m2.1.1.3.2">𝜋</ci><ci id="S4.SS2.p3.2.m2.1.1.3.3.cmml" xref="S4.SS2.p3.2.m2.1.1.3.3">𝜃</ci></apply><apply id="S4.SS2.p3.2.m2.1.1.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p3.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.1.1.1.2">𝑎</ci><ci id="S4.SS2.p3.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS2.p3.2.m2.1.1.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">\pi_{\theta}(a_{k})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.2.m2.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math>. This policy entropy is contingent on the data distribution <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S4.SS2.p3.3.m3.1"><semantics id="S4.SS2.p3.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><ci id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.3.m3.1d">caligraphic_T</annotation></semantics></math>, which remains static during the offline pretraining phase but becomes dynamic in the finetuning phase as it incorporates online data acquired through exploration. In line with max-entropy RL algorithms like SAC <cite class="ltx_cite ltx_citemacro_citep">(Haarnoja et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib15" title="">2018</a>)</cite>, we explicitly impose a lower bound on the policy entropy to encourage exploration. We aim to solve the following constrained problem:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S6.EGx6">
<tbody id="S4.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\min_{\theta}J(\theta)\quad\text{subject to }H_{\theta}^{\mathcal%
{T}}[\textbf{a}|\textbf{s},\textbf{g}]\geq\beta," class="ltx_Math" display="inline" id="S4.E5.m1.4"><semantics id="S4.E5.m1.4a"><mrow id="S4.E5.m1.4.4.1" xref="S4.E5.m1.4.4.1.1.cmml"><mrow id="S4.E5.m1.4.4.1.1" xref="S4.E5.m1.4.4.1.1.cmml"><mrow id="S4.E5.m1.4.4.1.1.2.2" xref="S4.E5.m1.4.4.1.1.2.3.cmml"><mrow id="S4.E5.m1.4.4.1.1.1.1.1" xref="S4.E5.m1.4.4.1.1.1.1.1.cmml"><mrow id="S4.E5.m1.4.4.1.1.1.1.1.2" xref="S4.E5.m1.4.4.1.1.1.1.1.2.cmml"><munder id="S4.E5.m1.4.4.1.1.1.1.1.2.1" xref="S4.E5.m1.4.4.1.1.1.1.1.2.1.cmml"><mi id="S4.E5.m1.4.4.1.1.1.1.1.2.1.2" xref="S4.E5.m1.4.4.1.1.1.1.1.2.1.2.cmml">min</mi><mi id="S4.E5.m1.4.4.1.1.1.1.1.2.1.3" xref="S4.E5.m1.4.4.1.1.1.1.1.2.1.3.cmml">θ</mi></munder><mo id="S4.E5.m1.4.4.1.1.1.1.1.2a" lspace="0.167em" xref="S4.E5.m1.4.4.1.1.1.1.1.2.cmml">⁡</mo><mi id="S4.E5.m1.4.4.1.1.1.1.1.2.2" xref="S4.E5.m1.4.4.1.1.1.1.1.2.2.cmml">J</mi></mrow><mo id="S4.E5.m1.4.4.1.1.1.1.1.1" xref="S4.E5.m1.4.4.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E5.m1.4.4.1.1.1.1.1.3.2" xref="S4.E5.m1.4.4.1.1.1.1.1.cmml"><mo id="S4.E5.m1.4.4.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.E5.m1.4.4.1.1.1.1.1.cmml">(</mo><mi id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml">θ</mi><mo id="S4.E5.m1.4.4.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.E5.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow></mrow><mspace id="S4.E5.m1.4.4.1.1.2.2.3" width="1em" xref="S4.E5.m1.4.4.1.1.2.3.cmml"></mspace><mrow id="S4.E5.m1.4.4.1.1.2.2.2" xref="S4.E5.m1.4.4.1.1.2.2.2.cmml"><mtext id="S4.E5.m1.4.4.1.1.2.2.2.3" xref="S4.E5.m1.4.4.1.1.2.2.2.3a.cmml">subject to </mtext><mo id="S4.E5.m1.4.4.1.1.2.2.2.2" xref="S4.E5.m1.4.4.1.1.2.2.2.2.cmml">⁢</mo><msubsup id="S4.E5.m1.4.4.1.1.2.2.2.4" xref="S4.E5.m1.4.4.1.1.2.2.2.4.cmml"><mi id="S4.E5.m1.4.4.1.1.2.2.2.4.2.2" xref="S4.E5.m1.4.4.1.1.2.2.2.4.2.2.cmml">H</mi><mi id="S4.E5.m1.4.4.1.1.2.2.2.4.2.3" xref="S4.E5.m1.4.4.1.1.2.2.2.4.2.3.cmml">θ</mi><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.4.4.1.1.2.2.2.4.3" xref="S4.E5.m1.4.4.1.1.2.2.2.4.3.cmml">𝒯</mi></msubsup><mo id="S4.E5.m1.4.4.1.1.2.2.2.2a" xref="S4.E5.m1.4.4.1.1.2.2.2.2.cmml">⁢</mo><mrow id="S4.E5.m1.4.4.1.1.2.2.2.1.1" xref="S4.E5.m1.4.4.1.1.2.2.2.1.2.cmml"><mo id="S4.E5.m1.4.4.1.1.2.2.2.1.1.2" stretchy="false" xref="S4.E5.m1.4.4.1.1.2.2.2.1.2.1.cmml">[</mo><mrow id="S4.E5.m1.4.4.1.1.2.2.2.1.1.1" xref="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.2" xref="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.2a.cmml">a</mtext><mo fence="false" id="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.1" xref="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.1.cmml">|</mo><mrow id="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.3.2" xref="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.3.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E5.m1.2.2" xref="S4.E5.m1.2.2a.cmml">s</mtext><mo id="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.3.2.1" xref="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.3.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S4.E5.m1.3.3" xref="S4.E5.m1.3.3a.cmml">g</mtext></mrow></mrow><mo id="S4.E5.m1.4.4.1.1.2.2.2.1.1.3" stretchy="false" xref="S4.E5.m1.4.4.1.1.2.2.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S4.E5.m1.4.4.1.1.3" xref="S4.E5.m1.4.4.1.1.3.cmml">≥</mo><mi id="S4.E5.m1.4.4.1.1.4" xref="S4.E5.m1.4.4.1.1.4.cmml">β</mi></mrow><mo id="S4.E5.m1.4.4.1.2" xref="S4.E5.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.4b"><apply id="S4.E5.m1.4.4.1.1.cmml" xref="S4.E5.m1.4.4.1"><geq id="S4.E5.m1.4.4.1.1.3.cmml" xref="S4.E5.m1.4.4.1.1.3"></geq><list id="S4.E5.m1.4.4.1.1.2.3.cmml" xref="S4.E5.m1.4.4.1.1.2.2"><apply id="S4.E5.m1.4.4.1.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1"><times id="S4.E5.m1.4.4.1.1.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1"></times><apply id="S4.E5.m1.4.4.1.1.1.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.2"><apply id="S4.E5.m1.4.4.1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.1.1.1.2.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.2.1">subscript</csymbol><min id="S4.E5.m1.4.4.1.1.1.1.1.2.1.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.2.1.2"></min><ci id="S4.E5.m1.4.4.1.1.1.1.1.2.1.3.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.2.1.3">𝜃</ci></apply><ci id="S4.E5.m1.4.4.1.1.1.1.1.2.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.2.2">𝐽</ci></apply><ci id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1">𝜃</ci></apply><apply id="S4.E5.m1.4.4.1.1.2.2.2.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2"><times id="S4.E5.m1.4.4.1.1.2.2.2.2.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.2"></times><ci id="S4.E5.m1.4.4.1.1.2.2.2.3a.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.3"><mtext id="S4.E5.m1.4.4.1.1.2.2.2.3.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.3">subject to </mtext></ci><apply id="S4.E5.m1.4.4.1.1.2.2.2.4.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.4"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.2.2.2.4.1.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.4">superscript</csymbol><apply id="S4.E5.m1.4.4.1.1.2.2.2.4.2.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.4"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.2.2.2.4.2.1.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.4">subscript</csymbol><ci id="S4.E5.m1.4.4.1.1.2.2.2.4.2.2.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.4.2.2">𝐻</ci><ci id="S4.E5.m1.4.4.1.1.2.2.2.4.2.3.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.4.2.3">𝜃</ci></apply><ci id="S4.E5.m1.4.4.1.1.2.2.2.4.3.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.4.3">𝒯</ci></apply><apply id="S4.E5.m1.4.4.1.1.2.2.2.1.2.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.1.1"><csymbol cd="latexml" id="S4.E5.m1.4.4.1.1.2.2.2.1.2.1.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.1.1.2">delimited-[]</csymbol><apply id="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.1.1.1"><csymbol cd="latexml" id="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.1">conditional</csymbol><ci id="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.2a.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.2">a</mtext></ci><list id="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.3.1.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.3.2"><ci id="S4.E5.m1.2.2a.cmml" xref="S4.E5.m1.2.2"><mtext class="ltx_mathvariant_bold" id="S4.E5.m1.2.2.cmml" xref="S4.E5.m1.2.2">s</mtext></ci><ci id="S4.E5.m1.3.3a.cmml" xref="S4.E5.m1.3.3"><mtext class="ltx_mathvariant_bold" id="S4.E5.m1.3.3.cmml" xref="S4.E5.m1.3.3">g</mtext></ci></list></apply></apply></apply></list><ci id="S4.E5.m1.4.4.1.1.4.cmml" xref="S4.E5.m1.4.4.1.1.4">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.4c">\displaystyle\min_{\theta}J(\theta)\quad\text{subject to }H_{\theta}^{\mathcal%
{T}}[\textbf{a}|\textbf{s},\textbf{g}]\geq\beta,</annotation><annotation encoding="application/x-llamapun" id="S4.E5.m1.4d">roman_min start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT italic_J ( italic_θ ) subject to italic_H start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_T end_POSTSUPERSCRIPT [ a | s , g ] ≥ italic_β ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p3.4">where <math alttext="\beta" class="ltx_Math" display="inline" id="S4.SS2.p3.4.m1.1"><semantics id="S4.SS2.p3.4.m1.1a"><mi id="S4.SS2.p3.4.m1.1.1" xref="S4.SS2.p3.4.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m1.1b"><ci id="S4.SS2.p3.4.m1.1.1.cmml" xref="S4.SS2.p3.4.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.4.m1.1d">italic_β</annotation></semantics></math> is a predetermined hyperparameter. Practically, we address the dual problem of <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S4.E5" title="In 4.2. Max-Entropy Enhanced Exploration ‣ 4. Methodology ‣ Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">5</span></a> to avoid the direct handling of the inequality constraint. Thus, we consider the Lagrangian,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S6.EGx7">
<tbody id="S4.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\max_{\lambda\geq 0}\min_{\theta}L(\theta,\lambda)\text{ where }L%
(\theta,\lambda)=J(\theta)+\lambda(\beta-H_{\theta}^{\mathcal{T}}[\textbf{a}|%
\textbf{s},\textbf{g}])." class="ltx_Math" display="inline" id="S4.E6.m1.8"><semantics id="S4.E6.m1.8a"><mrow id="S4.E6.m1.8.8.1" xref="S4.E6.m1.8.8.1.1.cmml"><mrow id="S4.E6.m1.8.8.1.1" xref="S4.E6.m1.8.8.1.1.cmml"><mrow id="S4.E6.m1.8.8.1.1.3" xref="S4.E6.m1.8.8.1.1.3.cmml"><mrow id="S4.E6.m1.8.8.1.1.3.2" xref="S4.E6.m1.8.8.1.1.3.2.cmml"><munder id="S4.E6.m1.8.8.1.1.3.2.1" xref="S4.E6.m1.8.8.1.1.3.2.1.cmml"><mi id="S4.E6.m1.8.8.1.1.3.2.1.2" xref="S4.E6.m1.8.8.1.1.3.2.1.2.cmml">max</mi><mrow id="S4.E6.m1.8.8.1.1.3.2.1.3" xref="S4.E6.m1.8.8.1.1.3.2.1.3.cmml"><mi id="S4.E6.m1.8.8.1.1.3.2.1.3.2" xref="S4.E6.m1.8.8.1.1.3.2.1.3.2.cmml">λ</mi><mo id="S4.E6.m1.8.8.1.1.3.2.1.3.1" xref="S4.E6.m1.8.8.1.1.3.2.1.3.1.cmml">≥</mo><mn id="S4.E6.m1.8.8.1.1.3.2.1.3.3" xref="S4.E6.m1.8.8.1.1.3.2.1.3.3.cmml">0</mn></mrow></munder><mo id="S4.E6.m1.8.8.1.1.3.2a" lspace="0.167em" xref="S4.E6.m1.8.8.1.1.3.2.cmml">⁡</mo><mrow id="S4.E6.m1.8.8.1.1.3.2.2" xref="S4.E6.m1.8.8.1.1.3.2.2.cmml"><munder id="S4.E6.m1.8.8.1.1.3.2.2.1" xref="S4.E6.m1.8.8.1.1.3.2.2.1.cmml"><mi id="S4.E6.m1.8.8.1.1.3.2.2.1.2" xref="S4.E6.m1.8.8.1.1.3.2.2.1.2.cmml">min</mi><mi id="S4.E6.m1.8.8.1.1.3.2.2.1.3" xref="S4.E6.m1.8.8.1.1.3.2.2.1.3.cmml">θ</mi></munder><mo id="S4.E6.m1.8.8.1.1.3.2.2a" lspace="0.167em" xref="S4.E6.m1.8.8.1.1.3.2.2.cmml">⁡</mo><mi id="S4.E6.m1.8.8.1.1.3.2.2.2" xref="S4.E6.m1.8.8.1.1.3.2.2.2.cmml">L</mi></mrow></mrow><mo id="S4.E6.m1.8.8.1.1.3.1" xref="S4.E6.m1.8.8.1.1.3.1.cmml">⁢</mo><mrow id="S4.E6.m1.8.8.1.1.3.3.2" xref="S4.E6.m1.8.8.1.1.3.3.1.cmml"><mo id="S4.E6.m1.8.8.1.1.3.3.2.1" stretchy="false" xref="S4.E6.m1.8.8.1.1.3.3.1.cmml">(</mo><mi id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml">θ</mi><mo id="S4.E6.m1.8.8.1.1.3.3.2.2" xref="S4.E6.m1.8.8.1.1.3.3.1.cmml">,</mo><mi id="S4.E6.m1.2.2" xref="S4.E6.m1.2.2.cmml">λ</mi><mo id="S4.E6.m1.8.8.1.1.3.3.2.3" stretchy="false" xref="S4.E6.m1.8.8.1.1.3.3.1.cmml">)</mo></mrow><mo id="S4.E6.m1.8.8.1.1.3.1a" xref="S4.E6.m1.8.8.1.1.3.1.cmml">⁢</mo><mtext id="S4.E6.m1.8.8.1.1.3.4" xref="S4.E6.m1.8.8.1.1.3.4a.cmml"> where </mtext><mo id="S4.E6.m1.8.8.1.1.3.1b" xref="S4.E6.m1.8.8.1.1.3.1.cmml">⁢</mo><mi id="S4.E6.m1.8.8.1.1.3.5" xref="S4.E6.m1.8.8.1.1.3.5.cmml">L</mi><mo id="S4.E6.m1.8.8.1.1.3.1c" xref="S4.E6.m1.8.8.1.1.3.1.cmml">⁢</mo><mrow id="S4.E6.m1.8.8.1.1.3.6.2" xref="S4.E6.m1.8.8.1.1.3.6.1.cmml"><mo id="S4.E6.m1.8.8.1.1.3.6.2.1" stretchy="false" xref="S4.E6.m1.8.8.1.1.3.6.1.cmml">(</mo><mi id="S4.E6.m1.3.3" xref="S4.E6.m1.3.3.cmml">θ</mi><mo id="S4.E6.m1.8.8.1.1.3.6.2.2" xref="S4.E6.m1.8.8.1.1.3.6.1.cmml">,</mo><mi id="S4.E6.m1.4.4" xref="S4.E6.m1.4.4.cmml">λ</mi><mo id="S4.E6.m1.8.8.1.1.3.6.2.3" stretchy="false" xref="S4.E6.m1.8.8.1.1.3.6.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.8.8.1.1.2" xref="S4.E6.m1.8.8.1.1.2.cmml">=</mo><mrow id="S4.E6.m1.8.8.1.1.1" xref="S4.E6.m1.8.8.1.1.1.cmml"><mrow id="S4.E6.m1.8.8.1.1.1.3" xref="S4.E6.m1.8.8.1.1.1.3.cmml"><mi id="S4.E6.m1.8.8.1.1.1.3.2" xref="S4.E6.m1.8.8.1.1.1.3.2.cmml">J</mi><mo id="S4.E6.m1.8.8.1.1.1.3.1" xref="S4.E6.m1.8.8.1.1.1.3.1.cmml">⁢</mo><mrow id="S4.E6.m1.8.8.1.1.1.3.3.2" xref="S4.E6.m1.8.8.1.1.1.3.cmml"><mo id="S4.E6.m1.8.8.1.1.1.3.3.2.1" stretchy="false" xref="S4.E6.m1.8.8.1.1.1.3.cmml">(</mo><mi id="S4.E6.m1.5.5" xref="S4.E6.m1.5.5.cmml">θ</mi><mo id="S4.E6.m1.8.8.1.1.1.3.3.2.2" stretchy="false" xref="S4.E6.m1.8.8.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.8.8.1.1.1.2" xref="S4.E6.m1.8.8.1.1.1.2.cmml">+</mo><mrow id="S4.E6.m1.8.8.1.1.1.1" xref="S4.E6.m1.8.8.1.1.1.1.cmml"><mi id="S4.E6.m1.8.8.1.1.1.1.3" xref="S4.E6.m1.8.8.1.1.1.1.3.cmml">λ</mi><mo id="S4.E6.m1.8.8.1.1.1.1.2" xref="S4.E6.m1.8.8.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E6.m1.8.8.1.1.1.1.1.1" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.cmml"><mo id="S4.E6.m1.8.8.1.1.1.1.1.1.2" stretchy="false" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.8.8.1.1.1.1.1.1.1" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.8.8.1.1.1.1.1.1.1.3" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.3.cmml">β</mi><mo id="S4.E6.m1.8.8.1.1.1.1.1.1.1.2" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.3.2.2.cmml">H</mi><mi id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.3.2.3.cmml">θ</mi><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.3.3" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.3.3.cmml">𝒯</mi></msubsup><mo id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2a.cmml">a</mtext><mo fence="false" id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><mrow id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E6.m1.6.6" xref="S4.E6.m1.6.6a.cmml">s</mtext><mo id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S4.E6.m1.7.7" xref="S4.E6.m1.7.7a.cmml">g</mtext></mrow></mrow><mo id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S4.E6.m1.8.8.1.1.1.1.1.1.3" stretchy="false" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E6.m1.8.8.1.2" lspace="0em" xref="S4.E6.m1.8.8.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.8b"><apply id="S4.E6.m1.8.8.1.1.cmml" xref="S4.E6.m1.8.8.1"><eq id="S4.E6.m1.8.8.1.1.2.cmml" xref="S4.E6.m1.8.8.1.1.2"></eq><apply id="S4.E6.m1.8.8.1.1.3.cmml" xref="S4.E6.m1.8.8.1.1.3"><times id="S4.E6.m1.8.8.1.1.3.1.cmml" xref="S4.E6.m1.8.8.1.1.3.1"></times><apply id="S4.E6.m1.8.8.1.1.3.2.cmml" xref="S4.E6.m1.8.8.1.1.3.2"><apply id="S4.E6.m1.8.8.1.1.3.2.1.cmml" xref="S4.E6.m1.8.8.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E6.m1.8.8.1.1.3.2.1.1.cmml" xref="S4.E6.m1.8.8.1.1.3.2.1">subscript</csymbol><max id="S4.E6.m1.8.8.1.1.3.2.1.2.cmml" xref="S4.E6.m1.8.8.1.1.3.2.1.2"></max><apply id="S4.E6.m1.8.8.1.1.3.2.1.3.cmml" xref="S4.E6.m1.8.8.1.1.3.2.1.3"><geq id="S4.E6.m1.8.8.1.1.3.2.1.3.1.cmml" xref="S4.E6.m1.8.8.1.1.3.2.1.3.1"></geq><ci id="S4.E6.m1.8.8.1.1.3.2.1.3.2.cmml" xref="S4.E6.m1.8.8.1.1.3.2.1.3.2">𝜆</ci><cn id="S4.E6.m1.8.8.1.1.3.2.1.3.3.cmml" type="integer" xref="S4.E6.m1.8.8.1.1.3.2.1.3.3">0</cn></apply></apply><apply id="S4.E6.m1.8.8.1.1.3.2.2.cmml" xref="S4.E6.m1.8.8.1.1.3.2.2"><apply id="S4.E6.m1.8.8.1.1.3.2.2.1.cmml" xref="S4.E6.m1.8.8.1.1.3.2.2.1"><csymbol cd="ambiguous" id="S4.E6.m1.8.8.1.1.3.2.2.1.1.cmml" xref="S4.E6.m1.8.8.1.1.3.2.2.1">subscript</csymbol><min id="S4.E6.m1.8.8.1.1.3.2.2.1.2.cmml" xref="S4.E6.m1.8.8.1.1.3.2.2.1.2"></min><ci id="S4.E6.m1.8.8.1.1.3.2.2.1.3.cmml" xref="S4.E6.m1.8.8.1.1.3.2.2.1.3">𝜃</ci></apply><ci id="S4.E6.m1.8.8.1.1.3.2.2.2.cmml" xref="S4.E6.m1.8.8.1.1.3.2.2.2">𝐿</ci></apply></apply><interval closure="open" id="S4.E6.m1.8.8.1.1.3.3.1.cmml" xref="S4.E6.m1.8.8.1.1.3.3.2"><ci id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1">𝜃</ci><ci id="S4.E6.m1.2.2.cmml" xref="S4.E6.m1.2.2">𝜆</ci></interval><ci id="S4.E6.m1.8.8.1.1.3.4a.cmml" xref="S4.E6.m1.8.8.1.1.3.4"><mtext id="S4.E6.m1.8.8.1.1.3.4.cmml" xref="S4.E6.m1.8.8.1.1.3.4"> where </mtext></ci><ci id="S4.E6.m1.8.8.1.1.3.5.cmml" xref="S4.E6.m1.8.8.1.1.3.5">𝐿</ci><interval closure="open" id="S4.E6.m1.8.8.1.1.3.6.1.cmml" xref="S4.E6.m1.8.8.1.1.3.6.2"><ci id="S4.E6.m1.3.3.cmml" xref="S4.E6.m1.3.3">𝜃</ci><ci id="S4.E6.m1.4.4.cmml" xref="S4.E6.m1.4.4">𝜆</ci></interval></apply><apply id="S4.E6.m1.8.8.1.1.1.cmml" xref="S4.E6.m1.8.8.1.1.1"><plus id="S4.E6.m1.8.8.1.1.1.2.cmml" xref="S4.E6.m1.8.8.1.1.1.2"></plus><apply id="S4.E6.m1.8.8.1.1.1.3.cmml" xref="S4.E6.m1.8.8.1.1.1.3"><times id="S4.E6.m1.8.8.1.1.1.3.1.cmml" xref="S4.E6.m1.8.8.1.1.1.3.1"></times><ci id="S4.E6.m1.8.8.1.1.1.3.2.cmml" xref="S4.E6.m1.8.8.1.1.1.3.2">𝐽</ci><ci id="S4.E6.m1.5.5.cmml" xref="S4.E6.m1.5.5">𝜃</ci></apply><apply id="S4.E6.m1.8.8.1.1.1.1.cmml" xref="S4.E6.m1.8.8.1.1.1.1"><times id="S4.E6.m1.8.8.1.1.1.1.2.cmml" xref="S4.E6.m1.8.8.1.1.1.1.2"></times><ci id="S4.E6.m1.8.8.1.1.1.1.3.cmml" xref="S4.E6.m1.8.8.1.1.1.1.3">𝜆</ci><apply id="S4.E6.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.8.8.1.1.1.1.1.1"><minus id="S4.E6.m1.8.8.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.2"></minus><ci id="S4.E6.m1.8.8.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.3">𝛽</ci><apply id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1"><times id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.2"></times><apply id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.3.2.2">𝐻</ci><ci id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.3.2.3">𝜃</ci></apply><ci id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.3.3">𝒯</ci></apply><apply id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2a.cmml" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2">a</mtext></ci><list id="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.3.2"><ci id="S4.E6.m1.6.6a.cmml" xref="S4.E6.m1.6.6"><mtext class="ltx_mathvariant_bold" id="S4.E6.m1.6.6.cmml" xref="S4.E6.m1.6.6">s</mtext></ci><ci id="S4.E6.m1.7.7a.cmml" xref="S4.E6.m1.7.7"><mtext class="ltx_mathvariant_bold" id="S4.E6.m1.7.7.cmml" xref="S4.E6.m1.7.7">g</mtext></ci></list></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.8c">\displaystyle\max_{\lambda\geq 0}\min_{\theta}L(\theta,\lambda)\text{ where }L%
(\theta,\lambda)=J(\theta)+\lambda(\beta-H_{\theta}^{\mathcal{T}}[\textbf{a}|%
\textbf{s},\textbf{g}]).</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.8d">roman_max start_POSTSUBSCRIPT italic_λ ≥ 0 end_POSTSUBSCRIPT roman_min start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT italic_L ( italic_θ , italic_λ ) where italic_L ( italic_θ , italic_λ ) = italic_J ( italic_θ ) + italic_λ ( italic_β - italic_H start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_T end_POSTSUPERSCRIPT [ a | s , g ] ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p3.8">The solution involves alternating optimization of <math alttext="\theta" class="ltx_Math" display="inline" id="S4.SS2.p3.5.m1.1"><semantics id="S4.SS2.p3.5.m1.1a"><mi id="S4.SS2.p3.5.m1.1.1" xref="S4.SS2.p3.5.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.5.m1.1b"><ci id="S4.SS2.p3.5.m1.1.1.cmml" xref="S4.SS2.p3.5.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.5.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.5.m1.1d">italic_θ</annotation></semantics></math> and <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS2.p3.6.m2.1"><semantics id="S4.SS2.p3.6.m2.1a"><mi id="S4.SS2.p3.6.m2.1.1" xref="S4.SS2.p3.6.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.6.m2.1b"><ci id="S4.SS2.p3.6.m2.1.1.cmml" xref="S4.SS2.p3.6.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.6.m2.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.6.m2.1d">italic_λ</annotation></semantics></math>. Specifically, optimizing <math alttext="\theta" class="ltx_Math" display="inline" id="S4.SS2.p3.7.m3.1"><semantics id="S4.SS2.p3.7.m3.1a"><mi id="S4.SS2.p3.7.m3.1.1" xref="S4.SS2.p3.7.m3.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.7.m3.1b"><ci id="S4.SS2.p3.7.m3.1.1.cmml" xref="S4.SS2.p3.7.m3.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.7.m3.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.7.m3.1d">italic_θ</annotation></semantics></math> with fixed <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS2.p3.8.m4.1"><semantics id="S4.SS2.p3.8.m4.1a"><mi id="S4.SS2.p3.8.m4.1.1" xref="S4.SS2.p3.8.m4.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.8.m4.1b"><ci id="S4.SS2.p3.8.m4.1.1.cmml" xref="S4.SS2.p3.8.m4.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.8.m4.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.8.m4.1d">italic_λ</annotation></semantics></math> is is achieved by,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S6.EGx8">
<tbody id="S4.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\min_{\theta}J(\theta)-\lambda H_{\theta}^{\mathcal{T}}[\textbf{a%
}|\textbf{s},\textbf{g}]," class="ltx_Math" display="inline" id="S4.E7.m1.4"><semantics id="S4.E7.m1.4a"><mrow id="S4.E7.m1.4.4.1" xref="S4.E7.m1.4.4.1.1.cmml"><mrow id="S4.E7.m1.4.4.1.1" xref="S4.E7.m1.4.4.1.1.cmml"><mrow id="S4.E7.m1.4.4.1.1.3" xref="S4.E7.m1.4.4.1.1.3.cmml"><mrow id="S4.E7.m1.4.4.1.1.3.2" xref="S4.E7.m1.4.4.1.1.3.2.cmml"><munder id="S4.E7.m1.4.4.1.1.3.2.1" xref="S4.E7.m1.4.4.1.1.3.2.1.cmml"><mi id="S4.E7.m1.4.4.1.1.3.2.1.2" xref="S4.E7.m1.4.4.1.1.3.2.1.2.cmml">min</mi><mi id="S4.E7.m1.4.4.1.1.3.2.1.3" xref="S4.E7.m1.4.4.1.1.3.2.1.3.cmml">θ</mi></munder><mo id="S4.E7.m1.4.4.1.1.3.2a" lspace="0.167em" xref="S4.E7.m1.4.4.1.1.3.2.cmml">⁡</mo><mi id="S4.E7.m1.4.4.1.1.3.2.2" xref="S4.E7.m1.4.4.1.1.3.2.2.cmml">J</mi></mrow><mo id="S4.E7.m1.4.4.1.1.3.1" xref="S4.E7.m1.4.4.1.1.3.1.cmml">⁢</mo><mrow id="S4.E7.m1.4.4.1.1.3.3.2" xref="S4.E7.m1.4.4.1.1.3.cmml"><mo id="S4.E7.m1.4.4.1.1.3.3.2.1" stretchy="false" xref="S4.E7.m1.4.4.1.1.3.cmml">(</mo><mi id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml">θ</mi><mo id="S4.E7.m1.4.4.1.1.3.3.2.2" stretchy="false" xref="S4.E7.m1.4.4.1.1.3.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.4.4.1.1.2" xref="S4.E7.m1.4.4.1.1.2.cmml">−</mo><mrow id="S4.E7.m1.4.4.1.1.1" xref="S4.E7.m1.4.4.1.1.1.cmml"><mi id="S4.E7.m1.4.4.1.1.1.3" xref="S4.E7.m1.4.4.1.1.1.3.cmml">λ</mi><mo id="S4.E7.m1.4.4.1.1.1.2" xref="S4.E7.m1.4.4.1.1.1.2.cmml">⁢</mo><msubsup id="S4.E7.m1.4.4.1.1.1.4" xref="S4.E7.m1.4.4.1.1.1.4.cmml"><mi id="S4.E7.m1.4.4.1.1.1.4.2.2" xref="S4.E7.m1.4.4.1.1.1.4.2.2.cmml">H</mi><mi id="S4.E7.m1.4.4.1.1.1.4.2.3" xref="S4.E7.m1.4.4.1.1.1.4.2.3.cmml">θ</mi><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.4.4.1.1.1.4.3" xref="S4.E7.m1.4.4.1.1.1.4.3.cmml">𝒯</mi></msubsup><mo id="S4.E7.m1.4.4.1.1.1.2a" xref="S4.E7.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.4.4.1.1.1.1.1" xref="S4.E7.m1.4.4.1.1.1.1.2.cmml"><mo id="S4.E7.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="S4.E7.m1.4.4.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E7.m1.4.4.1.1.1.1.1.1" xref="S4.E7.m1.4.4.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E7.m1.4.4.1.1.1.1.1.1.2" xref="S4.E7.m1.4.4.1.1.1.1.1.1.2a.cmml">a</mtext><mo fence="false" id="S4.E7.m1.4.4.1.1.1.1.1.1.1" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.cmml">|</mo><mrow id="S4.E7.m1.4.4.1.1.1.1.1.1.3.2" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E7.m1.2.2" xref="S4.E7.m1.2.2a.cmml">s</mtext><mo id="S4.E7.m1.4.4.1.1.1.1.1.1.3.2.1" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S4.E7.m1.3.3" xref="S4.E7.m1.3.3a.cmml">g</mtext></mrow></mrow><mo id="S4.E7.m1.4.4.1.1.1.1.1.3" stretchy="false" xref="S4.E7.m1.4.4.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S4.E7.m1.4.4.1.2" xref="S4.E7.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.4b"><apply id="S4.E7.m1.4.4.1.1.cmml" xref="S4.E7.m1.4.4.1"><minus id="S4.E7.m1.4.4.1.1.2.cmml" xref="S4.E7.m1.4.4.1.1.2"></minus><apply id="S4.E7.m1.4.4.1.1.3.cmml" xref="S4.E7.m1.4.4.1.1.3"><times id="S4.E7.m1.4.4.1.1.3.1.cmml" xref="S4.E7.m1.4.4.1.1.3.1"></times><apply id="S4.E7.m1.4.4.1.1.3.2.cmml" xref="S4.E7.m1.4.4.1.1.3.2"><apply id="S4.E7.m1.4.4.1.1.3.2.1.cmml" xref="S4.E7.m1.4.4.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.3.2.1.1.cmml" xref="S4.E7.m1.4.4.1.1.3.2.1">subscript</csymbol><min id="S4.E7.m1.4.4.1.1.3.2.1.2.cmml" xref="S4.E7.m1.4.4.1.1.3.2.1.2"></min><ci id="S4.E7.m1.4.4.1.1.3.2.1.3.cmml" xref="S4.E7.m1.4.4.1.1.3.2.1.3">𝜃</ci></apply><ci id="S4.E7.m1.4.4.1.1.3.2.2.cmml" xref="S4.E7.m1.4.4.1.1.3.2.2">𝐽</ci></apply><ci id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1">𝜃</ci></apply><apply id="S4.E7.m1.4.4.1.1.1.cmml" xref="S4.E7.m1.4.4.1.1.1"><times id="S4.E7.m1.4.4.1.1.1.2.cmml" xref="S4.E7.m1.4.4.1.1.1.2"></times><ci id="S4.E7.m1.4.4.1.1.1.3.cmml" xref="S4.E7.m1.4.4.1.1.1.3">𝜆</ci><apply id="S4.E7.m1.4.4.1.1.1.4.cmml" xref="S4.E7.m1.4.4.1.1.1.4"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.1.4.1.cmml" xref="S4.E7.m1.4.4.1.1.1.4">superscript</csymbol><apply id="S4.E7.m1.4.4.1.1.1.4.2.cmml" xref="S4.E7.m1.4.4.1.1.1.4"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.1.4.2.1.cmml" xref="S4.E7.m1.4.4.1.1.1.4">subscript</csymbol><ci id="S4.E7.m1.4.4.1.1.1.4.2.2.cmml" xref="S4.E7.m1.4.4.1.1.1.4.2.2">𝐻</ci><ci id="S4.E7.m1.4.4.1.1.1.4.2.3.cmml" xref="S4.E7.m1.4.4.1.1.1.4.2.3">𝜃</ci></apply><ci id="S4.E7.m1.4.4.1.1.1.4.3.cmml" xref="S4.E7.m1.4.4.1.1.1.4.3">𝒯</ci></apply><apply id="S4.E7.m1.4.4.1.1.1.1.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1"><csymbol cd="latexml" id="S4.E7.m1.4.4.1.1.1.1.2.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E7.m1.4.4.1.1.1.1.1.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E7.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E7.m1.4.4.1.1.1.1.1.1.2a.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.E7.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.2">a</mtext></ci><list id="S4.E7.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.3.2"><ci id="S4.E7.m1.2.2a.cmml" xref="S4.E7.m1.2.2"><mtext class="ltx_mathvariant_bold" id="S4.E7.m1.2.2.cmml" xref="S4.E7.m1.2.2">s</mtext></ci><ci id="S4.E7.m1.3.3a.cmml" xref="S4.E7.m1.3.3"><mtext class="ltx_mathvariant_bold" id="S4.E7.m1.3.3.cmml" xref="S4.E7.m1.3.3">g</mtext></ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.4c">\displaystyle\min_{\theta}J(\theta)-\lambda H_{\theta}^{\mathcal{T}}[\textbf{a%
}|\textbf{s},\textbf{g}],</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.4d">roman_min start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT italic_J ( italic_θ ) - italic_λ italic_H start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_T end_POSTSUPERSCRIPT [ a | s , g ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p3.10">and optimizing <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS2.p3.9.m1.1"><semantics id="S4.SS2.p3.9.m1.1a"><mi id="S4.SS2.p3.9.m1.1.1" xref="S4.SS2.p3.9.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.9.m1.1b"><ci id="S4.SS2.p3.9.m1.1.1.cmml" xref="S4.SS2.p3.9.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.9.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.9.m1.1d">italic_λ</annotation></semantics></math> with a fixed <math alttext="\theta" class="ltx_Math" display="inline" id="S4.SS2.p3.10.m2.1"><semantics id="S4.SS2.p3.10.m2.1a"><mi id="S4.SS2.p3.10.m2.1.1" xref="S4.SS2.p3.10.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.10.m2.1b"><ci id="S4.SS2.p3.10.m2.1.1.cmml" xref="S4.SS2.p3.10.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.10.m2.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.10.m2.1d">italic_θ</annotation></semantics></math>,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S6.EGx9">
<tbody id="S4.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\min_{\lambda\geq 0}\lambda(H_{\theta}^{\mathcal{T}}[\textbf{a}|%
\textbf{s},\textbf{g}]-\beta)." class="ltx_Math" display="inline" id="S4.E8.m1.3"><semantics id="S4.E8.m1.3a"><mrow id="S4.E8.m1.3.3.1" xref="S4.E8.m1.3.3.1.1.cmml"><mrow id="S4.E8.m1.3.3.1.1" xref="S4.E8.m1.3.3.1.1.cmml"><mrow id="S4.E8.m1.3.3.1.1.3" xref="S4.E8.m1.3.3.1.1.3.cmml"><munder id="S4.E8.m1.3.3.1.1.3.1" xref="S4.E8.m1.3.3.1.1.3.1.cmml"><mi id="S4.E8.m1.3.3.1.1.3.1.2" xref="S4.E8.m1.3.3.1.1.3.1.2.cmml">min</mi><mrow id="S4.E8.m1.3.3.1.1.3.1.3" xref="S4.E8.m1.3.3.1.1.3.1.3.cmml"><mi id="S4.E8.m1.3.3.1.1.3.1.3.2" xref="S4.E8.m1.3.3.1.1.3.1.3.2.cmml">λ</mi><mo id="S4.E8.m1.3.3.1.1.3.1.3.1" xref="S4.E8.m1.3.3.1.1.3.1.3.1.cmml">≥</mo><mn id="S4.E8.m1.3.3.1.1.3.1.3.3" xref="S4.E8.m1.3.3.1.1.3.1.3.3.cmml">0</mn></mrow></munder><mo id="S4.E8.m1.3.3.1.1.3a" lspace="0.167em" xref="S4.E8.m1.3.3.1.1.3.cmml">⁡</mo><mi id="S4.E8.m1.3.3.1.1.3.2" xref="S4.E8.m1.3.3.1.1.3.2.cmml">λ</mi></mrow><mo id="S4.E8.m1.3.3.1.1.2" xref="S4.E8.m1.3.3.1.1.2.cmml">⁢</mo><mrow id="S4.E8.m1.3.3.1.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.1.cmml"><mo id="S4.E8.m1.3.3.1.1.1.1.2" stretchy="false" xref="S4.E8.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.3.3.1.1.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.1.cmml"><mrow id="S4.E8.m1.3.3.1.1.1.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.1.1.cmml"><msubsup id="S4.E8.m1.3.3.1.1.1.1.1.1.3" xref="S4.E8.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.3.3.1.1.1.1.1.1.3.2.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.3.2.2.cmml">H</mi><mi id="S4.E8.m1.3.3.1.1.1.1.1.1.3.2.3" xref="S4.E8.m1.3.3.1.1.1.1.1.1.3.2.3.cmml">θ</mi><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.3.3.1.1.1.1.1.1.3.3" xref="S4.E8.m1.3.3.1.1.1.1.1.1.3.3.cmml">𝒯</mi></msubsup><mo id="S4.E8.m1.3.3.1.1.1.1.1.1.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.2a.cmml">a</mtext><mo fence="false" id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><mrow id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E8.m1.1.1" xref="S4.E8.m1.1.1a.cmml">s</mtext><mo id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.1" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S4.E8.m1.2.2" xref="S4.E8.m1.2.2a.cmml">g</mtext></mrow></mrow><mo id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S4.E8.m1.3.3.1.1.1.1.1.2" xref="S4.E8.m1.3.3.1.1.1.1.1.2.cmml">−</mo><mi id="S4.E8.m1.3.3.1.1.1.1.1.3" xref="S4.E8.m1.3.3.1.1.1.1.1.3.cmml">β</mi></mrow><mo id="S4.E8.m1.3.3.1.1.1.1.3" stretchy="false" xref="S4.E8.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.3.3.1.2" lspace="0em" xref="S4.E8.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.3b"><apply id="S4.E8.m1.3.3.1.1.cmml" xref="S4.E8.m1.3.3.1"><times id="S4.E8.m1.3.3.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.2"></times><apply id="S4.E8.m1.3.3.1.1.3.cmml" xref="S4.E8.m1.3.3.1.1.3"><apply id="S4.E8.m1.3.3.1.1.3.1.cmml" xref="S4.E8.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.3.1.1.cmml" xref="S4.E8.m1.3.3.1.1.3.1">subscript</csymbol><min id="S4.E8.m1.3.3.1.1.3.1.2.cmml" xref="S4.E8.m1.3.3.1.1.3.1.2"></min><apply id="S4.E8.m1.3.3.1.1.3.1.3.cmml" xref="S4.E8.m1.3.3.1.1.3.1.3"><geq id="S4.E8.m1.3.3.1.1.3.1.3.1.cmml" xref="S4.E8.m1.3.3.1.1.3.1.3.1"></geq><ci id="S4.E8.m1.3.3.1.1.3.1.3.2.cmml" xref="S4.E8.m1.3.3.1.1.3.1.3.2">𝜆</ci><cn id="S4.E8.m1.3.3.1.1.3.1.3.3.cmml" type="integer" xref="S4.E8.m1.3.3.1.1.3.1.3.3">0</cn></apply></apply><ci id="S4.E8.m1.3.3.1.1.3.2.cmml" xref="S4.E8.m1.3.3.1.1.3.2">𝜆</ci></apply><apply id="S4.E8.m1.3.3.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1"><minus id="S4.E8.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.2"></minus><apply id="S4.E8.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1"><times id="S4.E8.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2"></times><apply id="S4.E8.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E8.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E8.m1.3.3.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.3.2.2">𝐻</ci><ci id="S4.E8.m1.3.3.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.3.2.3">𝜃</ci></apply><ci id="S4.E8.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.3.3">𝒯</ci></apply><apply id="S4.E8.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E8.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.2a.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.2">a</mtext></ci><list id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.3.2"><ci id="S4.E8.m1.1.1a.cmml" xref="S4.E8.m1.1.1"><mtext class="ltx_mathvariant_bold" id="S4.E8.m1.1.1.cmml" xref="S4.E8.m1.1.1">s</mtext></ci><ci id="S4.E8.m1.2.2a.cmml" xref="S4.E8.m1.2.2"><mtext class="ltx_mathvariant_bold" id="S4.E8.m1.2.2.cmml" xref="S4.E8.m1.2.2">g</mtext></ci></list></apply></apply></apply><ci id="S4.E8.m1.3.3.1.1.1.1.1.3.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.3">𝛽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.3c">\displaystyle\min_{\lambda\geq 0}\lambda(H_{\theta}^{\mathcal{T}}[\textbf{a}|%
\textbf{s},\textbf{g}]-\beta).</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m1.3d">roman_min start_POSTSUBSCRIPT italic_λ ≥ 0 end_POSTSUBSCRIPT italic_λ ( italic_H start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_T end_POSTSUPERSCRIPT [ a | s , g ] - italic_β ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p3.12">Next, we will conduct a theoretical analysis to delineate how our EDT4Rec differs from SAC.</p>
</div>
<div class="ltx_para" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.6"><a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S4.E7" title="In 4.2. Max-Entropy Enhanced Exploration ‣ 4. Methodology ‣ Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">7</span></a> represents the regularized form of our primal problem as outlined in <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S4.E6" title="In 4.2. Max-Entropy Enhanced Exploration ‣ 4. Methodology ‣ Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">6</span></a>, where the dual variable <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS2.p4.1.m1.1"><semantics id="S4.SS2.p4.1.m1.1a"><mi id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><ci id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.1.m1.1d">italic_λ</annotation></semantics></math> assumes the role of a temperature variable, a common element in many regularized RL formulations. A fundamental distinction of our approach from SAC and other traditional RL methods lies in our loss function <math alttext="J(\theta)" class="ltx_Math" display="inline" id="S4.SS2.p4.2.m2.1"><semantics id="S4.SS2.p4.2.m2.1a"><mrow id="S4.SS2.p4.2.m2.1.2" xref="S4.SS2.p4.2.m2.1.2.cmml"><mi id="S4.SS2.p4.2.m2.1.2.2" xref="S4.SS2.p4.2.m2.1.2.2.cmml">J</mi><mo id="S4.SS2.p4.2.m2.1.2.1" xref="S4.SS2.p4.2.m2.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.p4.2.m2.1.2.3.2" xref="S4.SS2.p4.2.m2.1.2.cmml"><mo id="S4.SS2.p4.2.m2.1.2.3.2.1" stretchy="false" xref="S4.SS2.p4.2.m2.1.2.cmml">(</mo><mi id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml">θ</mi><mo id="S4.SS2.p4.2.m2.1.2.3.2.2" stretchy="false" xref="S4.SS2.p4.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><apply id="S4.SS2.p4.2.m2.1.2.cmml" xref="S4.SS2.p4.2.m2.1.2"><times id="S4.SS2.p4.2.m2.1.2.1.cmml" xref="S4.SS2.p4.2.m2.1.2.1"></times><ci id="S4.SS2.p4.2.m2.1.2.2.cmml" xref="S4.SS2.p4.2.m2.1.2.2">𝐽</ci><ci id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">J(\theta)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.2.m2.1d">italic_J ( italic_θ )</annotation></semantics></math>, which is defined as the negative log-likelihood (NLL) rather than the discounted return. This shift signifies a focus on supervised learning of action sequences rather than explicitly aiming to maximize returns. Therefore, the objective in <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S4.E7" title="In 4.2. Max-Entropy Enhanced Exploration ‣ 4. Methodology ‣ Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">7</span></a> can be interpreted as minimizing the expected discrepancy between the log-probability of observed actions and the <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS2.p4.3.m3.1"><semantics id="S4.SS2.p4.3.m3.1a"><mi id="S4.SS2.p4.3.m3.1.1" xref="S4.SS2.p4.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.1b"><ci id="S4.SS2.p4.3.m3.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.3.m3.1d">italic_λ</annotation></semantics></math>-scaled log-probability of actions sampled from <math alttext="\pi_{\theta}(\cdot|\textbf{s},\textbf{g})" class="ltx_math_unparsed" display="inline" id="S4.SS2.p4.4.m4.1"><semantics id="S4.SS2.p4.4.m4.1a"><mrow id="S4.SS2.p4.4.m4.1b"><msub id="S4.SS2.p4.4.m4.1.1"><mi id="S4.SS2.p4.4.m4.1.1.2">π</mi><mi id="S4.SS2.p4.4.m4.1.1.3">θ</mi></msub><mrow id="S4.SS2.p4.4.m4.1.2"><mo id="S4.SS2.p4.4.m4.1.2.1" stretchy="false">(</mo><mo id="S4.SS2.p4.4.m4.1.2.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S4.SS2.p4.4.m4.1.2.3" rspace="0.167em" stretchy="false">|</mo><mtext class="ltx_mathvariant_bold" id="S4.SS2.p4.4.m4.1.2.4">s</mtext><mo id="S4.SS2.p4.4.m4.1.2.5">,</mo><mtext class="ltx_mathvariant_bold" id="S4.SS2.p4.4.m4.1.2.6">g</mtext><mo id="S4.SS2.p4.4.m4.1.2.7" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS2.p4.4.m4.1c">\pi_{\theta}(\cdot|\textbf{s},\textbf{g})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.4.m4.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( ⋅ | s , g )</annotation></semantics></math>. In essence, we aim to train <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S4.SS2.p4.5.m5.1"><semantics id="S4.SS2.p4.5.m5.1a"><msub id="S4.SS2.p4.5.m5.1.1" xref="S4.SS2.p4.5.m5.1.1.cmml"><mi id="S4.SS2.p4.5.m5.1.1.2" xref="S4.SS2.p4.5.m5.1.1.2.cmml">π</mi><mi id="S4.SS2.p4.5.m5.1.1.3" xref="S4.SS2.p4.5.m5.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.5.m5.1b"><apply id="S4.SS2.p4.5.m5.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.5.m5.1.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.p4.5.m5.1.1.2.cmml" xref="S4.SS2.p4.5.m5.1.1.2">𝜋</ci><ci id="S4.SS2.p4.5.m5.1.1.3.cmml" xref="S4.SS2.p4.5.m5.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.5.m5.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.5.m5.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> to approximate the observed action distribution, allowing for a controlled degree of deviation, with <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS2.p4.6.m6.1"><semantics id="S4.SS2.p4.6.m6.1a"><mi id="S4.SS2.p4.6.m6.1.1" xref="S4.SS2.p4.6.m6.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.6.m6.1b"><ci id="S4.SS2.p4.6.m6.1.1.cmml" xref="S4.SS2.p4.6.m6.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.6.m6.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.6.m6.1d">italic_λ</annotation></semantics></math> explicitly regulating this mismatch.</p>
</div>
<div class="ltx_para" id="S4.SS2.p5">
<p class="ltx_p" id="S4.SS2.p5.8">It’s important to note that <math alttext="H_{\theta}^{\mathcal{T}}[\textbf{a}|\textbf{s},\textbf{g}]" class="ltx_Math" display="inline" id="S4.SS2.p5.1.m1.3"><semantics id="S4.SS2.p5.1.m1.3a"><mrow id="S4.SS2.p5.1.m1.3.3" xref="S4.SS2.p5.1.m1.3.3.cmml"><msubsup id="S4.SS2.p5.1.m1.3.3.3" xref="S4.SS2.p5.1.m1.3.3.3.cmml"><mi id="S4.SS2.p5.1.m1.3.3.3.2.2" xref="S4.SS2.p5.1.m1.3.3.3.2.2.cmml">H</mi><mi id="S4.SS2.p5.1.m1.3.3.3.2.3" xref="S4.SS2.p5.1.m1.3.3.3.2.3.cmml">θ</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p5.1.m1.3.3.3.3" xref="S4.SS2.p5.1.m1.3.3.3.3.cmml">𝒯</mi></msubsup><mo id="S4.SS2.p5.1.m1.3.3.2" xref="S4.SS2.p5.1.m1.3.3.2.cmml">⁢</mo><mrow id="S4.SS2.p5.1.m1.3.3.1.1" xref="S4.SS2.p5.1.m1.3.3.1.2.cmml"><mo id="S4.SS2.p5.1.m1.3.3.1.1.2" stretchy="false" xref="S4.SS2.p5.1.m1.3.3.1.2.1.cmml">[</mo><mrow id="S4.SS2.p5.1.m1.3.3.1.1.1" xref="S4.SS2.p5.1.m1.3.3.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS2.p5.1.m1.3.3.1.1.1.2" xref="S4.SS2.p5.1.m1.3.3.1.1.1.2a.cmml">a</mtext><mo fence="false" id="S4.SS2.p5.1.m1.3.3.1.1.1.1" xref="S4.SS2.p5.1.m1.3.3.1.1.1.1.cmml">|</mo><mrow id="S4.SS2.p5.1.m1.3.3.1.1.1.3.2" xref="S4.SS2.p5.1.m1.3.3.1.1.1.3.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1a.cmml">s</mtext><mo id="S4.SS2.p5.1.m1.3.3.1.1.1.3.2.1" xref="S4.SS2.p5.1.m1.3.3.1.1.1.3.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S4.SS2.p5.1.m1.2.2" xref="S4.SS2.p5.1.m1.2.2a.cmml">g</mtext></mrow></mrow><mo id="S4.SS2.p5.1.m1.3.3.1.1.3" stretchy="false" xref="S4.SS2.p5.1.m1.3.3.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.3b"><apply id="S4.SS2.p5.1.m1.3.3.cmml" xref="S4.SS2.p5.1.m1.3.3"><times id="S4.SS2.p5.1.m1.3.3.2.cmml" xref="S4.SS2.p5.1.m1.3.3.2"></times><apply id="S4.SS2.p5.1.m1.3.3.3.cmml" xref="S4.SS2.p5.1.m1.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p5.1.m1.3.3.3.1.cmml" xref="S4.SS2.p5.1.m1.3.3.3">superscript</csymbol><apply id="S4.SS2.p5.1.m1.3.3.3.2.cmml" xref="S4.SS2.p5.1.m1.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p5.1.m1.3.3.3.2.1.cmml" xref="S4.SS2.p5.1.m1.3.3.3">subscript</csymbol><ci id="S4.SS2.p5.1.m1.3.3.3.2.2.cmml" xref="S4.SS2.p5.1.m1.3.3.3.2.2">𝐻</ci><ci id="S4.SS2.p5.1.m1.3.3.3.2.3.cmml" xref="S4.SS2.p5.1.m1.3.3.3.2.3">𝜃</ci></apply><ci id="S4.SS2.p5.1.m1.3.3.3.3.cmml" xref="S4.SS2.p5.1.m1.3.3.3.3">𝒯</ci></apply><apply id="S4.SS2.p5.1.m1.3.3.1.2.cmml" xref="S4.SS2.p5.1.m1.3.3.1.1"><csymbol cd="latexml" id="S4.SS2.p5.1.m1.3.3.1.2.1.cmml" xref="S4.SS2.p5.1.m1.3.3.1.1.2">delimited-[]</csymbol><apply id="S4.SS2.p5.1.m1.3.3.1.1.1.cmml" xref="S4.SS2.p5.1.m1.3.3.1.1.1"><csymbol cd="latexml" id="S4.SS2.p5.1.m1.3.3.1.1.1.1.cmml" xref="S4.SS2.p5.1.m1.3.3.1.1.1.1">conditional</csymbol><ci id="S4.SS2.p5.1.m1.3.3.1.1.1.2a.cmml" xref="S4.SS2.p5.1.m1.3.3.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS2.p5.1.m1.3.3.1.1.1.2.cmml" xref="S4.SS2.p5.1.m1.3.3.1.1.1.2">a</mtext></ci><list id="S4.SS2.p5.1.m1.3.3.1.1.1.3.1.cmml" xref="S4.SS2.p5.1.m1.3.3.1.1.1.3.2"><ci id="S4.SS2.p5.1.m1.1.1a.cmml" xref="S4.SS2.p5.1.m1.1.1"><mtext class="ltx_mathvariant_bold" id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1">s</mtext></ci><ci id="S4.SS2.p5.1.m1.2.2a.cmml" xref="S4.SS2.p5.1.m1.2.2"><mtext class="ltx_mathvariant_bold" id="S4.SS2.p5.1.m1.2.2.cmml" xref="S4.SS2.p5.1.m1.2.2">g</mtext></ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.3c">H_{\theta}^{\mathcal{T}}[\textbf{a}|\textbf{s},\textbf{g}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.1.m1.3d">italic_H start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_T end_POSTSUPERSCRIPT [ a | s , g ]</annotation></semantics></math> is technically a cross conditional entropy. This arises because the training data distribution <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S4.SS2.p5.2.m2.1"><semantics id="S4.SS2.p5.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p5.2.m2.1.1" xref="S4.SS2.p5.2.m2.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.2.m2.1b"><ci id="S4.SS2.p5.2.m2.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.2.m2.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.2.m2.1d">caligraphic_T</annotation></semantics></math> is not identical to the action-state-RTG marginals induced by the current policy <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S4.SS2.p5.3.m3.1"><semantics id="S4.SS2.p5.3.m3.1a"><msub id="S4.SS2.p5.3.m3.1.1" xref="S4.SS2.p5.3.m3.1.1.cmml"><mi id="S4.SS2.p5.3.m3.1.1.2" xref="S4.SS2.p5.3.m3.1.1.2.cmml">π</mi><mi id="S4.SS2.p5.3.m3.1.1.3" xref="S4.SS2.p5.3.m3.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.3.m3.1b"><apply id="S4.SS2.p5.3.m3.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.3.m3.1.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p5.3.m3.1.1.2.cmml" xref="S4.SS2.p5.3.m3.1.1.2">𝜋</ci><ci id="S4.SS2.p5.3.m3.1.1.3.cmml" xref="S4.SS2.p5.3.m3.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.3.m3.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.3.m3.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> and the transition probability <math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="S4.SS2.p5.4.m4.1"><semantics id="S4.SS2.p5.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p5.4.m4.1.1" xref="S4.SS2.p5.4.m4.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.4.m4.1b"><ci id="S4.SS2.p5.4.m4.1.1.cmml" xref="S4.SS2.p5.4.m4.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.4.m4.1c">\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.4.m4.1d">caligraphic_P</annotation></semantics></math>. In the offline training phase, <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S4.SS2.p5.5.m5.1"><semantics id="S4.SS2.p5.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p5.5.m5.1.1" xref="S4.SS2.p5.5.m5.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.5.m5.1b"><ci id="S4.SS2.p5.5.m5.1.1.cmml" xref="S4.SS2.p5.5.m5.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.5.m5.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.5.m5.1d">caligraphic_T</annotation></semantics></math> is a fixed offline data distribution, <math alttext="\mathcal{T}_{offline}" class="ltx_Math" display="inline" id="S4.SS2.p5.6.m6.1"><semantics id="S4.SS2.p5.6.m6.1a"><msub id="S4.SS2.p5.6.m6.1.1" xref="S4.SS2.p5.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p5.6.m6.1.1.2" xref="S4.SS2.p5.6.m6.1.1.2.cmml">𝒯</mi><mrow id="S4.SS2.p5.6.m6.1.1.3" xref="S4.SS2.p5.6.m6.1.1.3.cmml"><mi id="S4.SS2.p5.6.m6.1.1.3.2" xref="S4.SS2.p5.6.m6.1.1.3.2.cmml">o</mi><mo id="S4.SS2.p5.6.m6.1.1.3.1" xref="S4.SS2.p5.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p5.6.m6.1.1.3.3" xref="S4.SS2.p5.6.m6.1.1.3.3.cmml">f</mi><mo id="S4.SS2.p5.6.m6.1.1.3.1a" xref="S4.SS2.p5.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p5.6.m6.1.1.3.4" xref="S4.SS2.p5.6.m6.1.1.3.4.cmml">f</mi><mo id="S4.SS2.p5.6.m6.1.1.3.1b" xref="S4.SS2.p5.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p5.6.m6.1.1.3.5" xref="S4.SS2.p5.6.m6.1.1.3.5.cmml">l</mi><mo id="S4.SS2.p5.6.m6.1.1.3.1c" xref="S4.SS2.p5.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p5.6.m6.1.1.3.6" xref="S4.SS2.p5.6.m6.1.1.3.6.cmml">i</mi><mo id="S4.SS2.p5.6.m6.1.1.3.1d" xref="S4.SS2.p5.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p5.6.m6.1.1.3.7" xref="S4.SS2.p5.6.m6.1.1.3.7.cmml">n</mi><mo id="S4.SS2.p5.6.m6.1.1.3.1e" xref="S4.SS2.p5.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p5.6.m6.1.1.3.8" xref="S4.SS2.p5.6.m6.1.1.3.8.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.6.m6.1b"><apply id="S4.SS2.p5.6.m6.1.1.cmml" xref="S4.SS2.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.6.m6.1.1.1.cmml" xref="S4.SS2.p5.6.m6.1.1">subscript</csymbol><ci id="S4.SS2.p5.6.m6.1.1.2.cmml" xref="S4.SS2.p5.6.m6.1.1.2">𝒯</ci><apply id="S4.SS2.p5.6.m6.1.1.3.cmml" xref="S4.SS2.p5.6.m6.1.1.3"><times id="S4.SS2.p5.6.m6.1.1.3.1.cmml" xref="S4.SS2.p5.6.m6.1.1.3.1"></times><ci id="S4.SS2.p5.6.m6.1.1.3.2.cmml" xref="S4.SS2.p5.6.m6.1.1.3.2">𝑜</ci><ci id="S4.SS2.p5.6.m6.1.1.3.3.cmml" xref="S4.SS2.p5.6.m6.1.1.3.3">𝑓</ci><ci id="S4.SS2.p5.6.m6.1.1.3.4.cmml" xref="S4.SS2.p5.6.m6.1.1.3.4">𝑓</ci><ci id="S4.SS2.p5.6.m6.1.1.3.5.cmml" xref="S4.SS2.p5.6.m6.1.1.3.5">𝑙</ci><ci id="S4.SS2.p5.6.m6.1.1.3.6.cmml" xref="S4.SS2.p5.6.m6.1.1.3.6">𝑖</ci><ci id="S4.SS2.p5.6.m6.1.1.3.7.cmml" xref="S4.SS2.p5.6.m6.1.1.3.7">𝑛</ci><ci id="S4.SS2.p5.6.m6.1.1.3.8.cmml" xref="S4.SS2.p5.6.m6.1.1.3.8">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.6.m6.1c">\mathcal{T}_{offline}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.6.m6.1d">caligraphic_T start_POSTSUBSCRIPT italic_o italic_f italic_f italic_l italic_i italic_n italic_e end_POSTSUBSCRIPT</annotation></semantics></math>, while during the online phase, <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S4.SS2.p5.7.m7.1"><semantics id="S4.SS2.p5.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p5.7.m7.1.1" xref="S4.SS2.p5.7.m7.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.7.m7.1b"><ci id="S4.SS2.p5.7.m7.1.1.cmml" xref="S4.SS2.p5.7.m7.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.7.m7.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.7.m7.1d">caligraphic_T</annotation></semantics></math> is represented through a replay buffer that stores online data and is dependent on the current policy <math alttext="\pi_{t}heta" class="ltx_Math" display="inline" id="S4.SS2.p5.8.m8.1"><semantics id="S4.SS2.p5.8.m8.1a"><mrow id="S4.SS2.p5.8.m8.1.1" xref="S4.SS2.p5.8.m8.1.1.cmml"><msub id="S4.SS2.p5.8.m8.1.1.2" xref="S4.SS2.p5.8.m8.1.1.2.cmml"><mi id="S4.SS2.p5.8.m8.1.1.2.2" xref="S4.SS2.p5.8.m8.1.1.2.2.cmml">π</mi><mi id="S4.SS2.p5.8.m8.1.1.2.3" xref="S4.SS2.p5.8.m8.1.1.2.3.cmml">t</mi></msub><mo id="S4.SS2.p5.8.m8.1.1.1" xref="S4.SS2.p5.8.m8.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p5.8.m8.1.1.3" xref="S4.SS2.p5.8.m8.1.1.3.cmml">h</mi><mo id="S4.SS2.p5.8.m8.1.1.1a" xref="S4.SS2.p5.8.m8.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p5.8.m8.1.1.4" xref="S4.SS2.p5.8.m8.1.1.4.cmml">e</mi><mo id="S4.SS2.p5.8.m8.1.1.1b" xref="S4.SS2.p5.8.m8.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p5.8.m8.1.1.5" xref="S4.SS2.p5.8.m8.1.1.5.cmml">t</mi><mo id="S4.SS2.p5.8.m8.1.1.1c" xref="S4.SS2.p5.8.m8.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p5.8.m8.1.1.6" xref="S4.SS2.p5.8.m8.1.1.6.cmml">a</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.8.m8.1b"><apply id="S4.SS2.p5.8.m8.1.1.cmml" xref="S4.SS2.p5.8.m8.1.1"><times id="S4.SS2.p5.8.m8.1.1.1.cmml" xref="S4.SS2.p5.8.m8.1.1.1"></times><apply id="S4.SS2.p5.8.m8.1.1.2.cmml" xref="S4.SS2.p5.8.m8.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p5.8.m8.1.1.2.1.cmml" xref="S4.SS2.p5.8.m8.1.1.2">subscript</csymbol><ci id="S4.SS2.p5.8.m8.1.1.2.2.cmml" xref="S4.SS2.p5.8.m8.1.1.2.2">𝜋</ci><ci id="S4.SS2.p5.8.m8.1.1.2.3.cmml" xref="S4.SS2.p5.8.m8.1.1.2.3">𝑡</ci></apply><ci id="S4.SS2.p5.8.m8.1.1.3.cmml" xref="S4.SS2.p5.8.m8.1.1.3">ℎ</ci><ci id="S4.SS2.p5.8.m8.1.1.4.cmml" xref="S4.SS2.p5.8.m8.1.1.4">𝑒</ci><ci id="S4.SS2.p5.8.m8.1.1.5.cmml" xref="S4.SS2.p5.8.m8.1.1.5">𝑡</ci><ci id="S4.SS2.p5.8.m8.1.1.6.cmml" xref="S4.SS2.p5.8.m8.1.1.6">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.8.m8.1c">\pi_{t}heta</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.8.m8.1d">italic_π start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_h italic_e italic_t italic_a</annotation></semantics></math> and previously gathered data.</p>
</div>
<div class="ltx_para" id="S4.SS2.p6">
<p class="ltx_p" id="S4.SS2.p6.4">It is worth mentioning that our policy entropy, as defined in <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S4.E4" title="In 4.2. Max-Entropy Enhanced Exploration ‣ 4. Methodology ‣ Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">4</span></a>, operates at the sequence level rather than at the transition level. This distinction leads to a significant difference in the constraints applied in our primal problem (<a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S4.E6" title="In 4.2. Max-Entropy Enhanced Exploration ‣ 4. Methodology ‣ Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">6</span></a>) compared to those used in the SAC framework. For the sake of simplicity, if we momentarily set aside the RTG variable <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS2.p6.4.1">g</span> in our policy entropy calculation, we can see a clear contrast. While SAC imposes a lower bound <math alttext="\beta" class="ltx_Math" display="inline" id="S4.SS2.p6.2.m2.1"><semantics id="S4.SS2.p6.2.m2.1a"><mi id="S4.SS2.p6.2.m2.1.1" xref="S4.SS2.p6.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.2.m2.1b"><ci id="S4.SS2.p6.2.m2.1.1.cmml" xref="S4.SS2.p6.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p6.2.m2.1d">italic_β</annotation></semantics></math> on the policy entropy at each timestep, our entropy <math alttext="H_{\theta}^{\mathcal{T}}[\textbf{a}|\textbf{s},\textbf{g}]" class="ltx_Math" display="inline" id="S4.SS2.p6.3.m3.3"><semantics id="S4.SS2.p6.3.m3.3a"><mrow id="S4.SS2.p6.3.m3.3.3" xref="S4.SS2.p6.3.m3.3.3.cmml"><msubsup id="S4.SS2.p6.3.m3.3.3.3" xref="S4.SS2.p6.3.m3.3.3.3.cmml"><mi id="S4.SS2.p6.3.m3.3.3.3.2.2" xref="S4.SS2.p6.3.m3.3.3.3.2.2.cmml">H</mi><mi id="S4.SS2.p6.3.m3.3.3.3.2.3" xref="S4.SS2.p6.3.m3.3.3.3.2.3.cmml">θ</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p6.3.m3.3.3.3.3" xref="S4.SS2.p6.3.m3.3.3.3.3.cmml">𝒯</mi></msubsup><mo id="S4.SS2.p6.3.m3.3.3.2" xref="S4.SS2.p6.3.m3.3.3.2.cmml">⁢</mo><mrow id="S4.SS2.p6.3.m3.3.3.1.1" xref="S4.SS2.p6.3.m3.3.3.1.2.cmml"><mo id="S4.SS2.p6.3.m3.3.3.1.1.2" stretchy="false" xref="S4.SS2.p6.3.m3.3.3.1.2.1.cmml">[</mo><mrow id="S4.SS2.p6.3.m3.3.3.1.1.1" xref="S4.SS2.p6.3.m3.3.3.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS2.p6.3.m3.3.3.1.1.1.2" xref="S4.SS2.p6.3.m3.3.3.1.1.1.2a.cmml">a</mtext><mo fence="false" id="S4.SS2.p6.3.m3.3.3.1.1.1.1" xref="S4.SS2.p6.3.m3.3.3.1.1.1.1.cmml">|</mo><mrow id="S4.SS2.p6.3.m3.3.3.1.1.1.3.2" xref="S4.SS2.p6.3.m3.3.3.1.1.1.3.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS2.p6.3.m3.1.1" xref="S4.SS2.p6.3.m3.1.1a.cmml">s</mtext><mo id="S4.SS2.p6.3.m3.3.3.1.1.1.3.2.1" xref="S4.SS2.p6.3.m3.3.3.1.1.1.3.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S4.SS2.p6.3.m3.2.2" xref="S4.SS2.p6.3.m3.2.2a.cmml">g</mtext></mrow></mrow><mo id="S4.SS2.p6.3.m3.3.3.1.1.3" stretchy="false" xref="S4.SS2.p6.3.m3.3.3.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.3.m3.3b"><apply id="S4.SS2.p6.3.m3.3.3.cmml" xref="S4.SS2.p6.3.m3.3.3"><times id="S4.SS2.p6.3.m3.3.3.2.cmml" xref="S4.SS2.p6.3.m3.3.3.2"></times><apply id="S4.SS2.p6.3.m3.3.3.3.cmml" xref="S4.SS2.p6.3.m3.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p6.3.m3.3.3.3.1.cmml" xref="S4.SS2.p6.3.m3.3.3.3">superscript</csymbol><apply id="S4.SS2.p6.3.m3.3.3.3.2.cmml" xref="S4.SS2.p6.3.m3.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p6.3.m3.3.3.3.2.1.cmml" xref="S4.SS2.p6.3.m3.3.3.3">subscript</csymbol><ci id="S4.SS2.p6.3.m3.3.3.3.2.2.cmml" xref="S4.SS2.p6.3.m3.3.3.3.2.2">𝐻</ci><ci id="S4.SS2.p6.3.m3.3.3.3.2.3.cmml" xref="S4.SS2.p6.3.m3.3.3.3.2.3">𝜃</ci></apply><ci id="S4.SS2.p6.3.m3.3.3.3.3.cmml" xref="S4.SS2.p6.3.m3.3.3.3.3">𝒯</ci></apply><apply id="S4.SS2.p6.3.m3.3.3.1.2.cmml" xref="S4.SS2.p6.3.m3.3.3.1.1"><csymbol cd="latexml" id="S4.SS2.p6.3.m3.3.3.1.2.1.cmml" xref="S4.SS2.p6.3.m3.3.3.1.1.2">delimited-[]</csymbol><apply id="S4.SS2.p6.3.m3.3.3.1.1.1.cmml" xref="S4.SS2.p6.3.m3.3.3.1.1.1"><csymbol cd="latexml" id="S4.SS2.p6.3.m3.3.3.1.1.1.1.cmml" xref="S4.SS2.p6.3.m3.3.3.1.1.1.1">conditional</csymbol><ci id="S4.SS2.p6.3.m3.3.3.1.1.1.2a.cmml" xref="S4.SS2.p6.3.m3.3.3.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS2.p6.3.m3.3.3.1.1.1.2.cmml" xref="S4.SS2.p6.3.m3.3.3.1.1.1.2">a</mtext></ci><list id="S4.SS2.p6.3.m3.3.3.1.1.1.3.1.cmml" xref="S4.SS2.p6.3.m3.3.3.1.1.1.3.2"><ci id="S4.SS2.p6.3.m3.1.1a.cmml" xref="S4.SS2.p6.3.m3.1.1"><mtext class="ltx_mathvariant_bold" id="S4.SS2.p6.3.m3.1.1.cmml" xref="S4.SS2.p6.3.m3.1.1">s</mtext></ci><ci id="S4.SS2.p6.3.m3.2.2a.cmml" xref="S4.SS2.p6.3.m3.2.2"><mtext class="ltx_mathvariant_bold" id="S4.SS2.p6.3.m3.2.2.cmml" xref="S4.SS2.p6.3.m3.2.2">g</mtext></ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.3.m3.3c">H_{\theta}^{\mathcal{T}}[\textbf{a}|\textbf{s},\textbf{g}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p6.3.m3.3d">italic_H start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_T end_POSTSUPERSCRIPT [ a | s , g ]</annotation></semantics></math> is computed as an average over <math alttext="K" class="ltx_Math" display="inline" id="S4.SS2.p6.4.m4.1"><semantics id="S4.SS2.p6.4.m4.1a"><mi id="S4.SS2.p6.4.m4.1.1" xref="S4.SS2.p6.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.4.m4.1b"><ci id="S4.SS2.p6.4.m4.1.1.cmml" xref="S4.SS2.p6.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p6.4.m4.1d">italic_K</annotation></semantics></math> consecutive timesteps.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>RTG Relabeling</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">The reward conditioning approach prevalent in prior works typically involves conditioning on an entire trajectory sequence using the sum of rewards for that sequence (i.e.,<math alttext="\sum_{i=0}^{|\tau|}r_{i}" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><mrow id="S4.SS3.p1.1.m1.1.2" xref="S4.SS3.p1.1.m1.1.2.cmml"><msubsup id="S4.SS3.p1.1.m1.1.2.1" xref="S4.SS3.p1.1.m1.1.2.1.cmml"><mo id="S4.SS3.p1.1.m1.1.2.1.2.2" xref="S4.SS3.p1.1.m1.1.2.1.2.2.cmml">∑</mo><mrow id="S4.SS3.p1.1.m1.1.2.1.2.3" xref="S4.SS3.p1.1.m1.1.2.1.2.3.cmml"><mi id="S4.SS3.p1.1.m1.1.2.1.2.3.2" xref="S4.SS3.p1.1.m1.1.2.1.2.3.2.cmml">i</mi><mo id="S4.SS3.p1.1.m1.1.2.1.2.3.1" xref="S4.SS3.p1.1.m1.1.2.1.2.3.1.cmml">=</mo><mn id="S4.SS3.p1.1.m1.1.2.1.2.3.3" xref="S4.SS3.p1.1.m1.1.2.1.2.3.3.cmml">0</mn></mrow><mrow id="S4.SS3.p1.1.m1.1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.1.2.cmml"><mo id="S4.SS3.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S4.SS3.p1.1.m1.1.1.1.2.1.cmml">|</mo><mi id="S4.SS3.p1.1.m1.1.1.1.1" xref="S4.SS3.p1.1.m1.1.1.1.1.cmml">τ</mi><mo id="S4.SS3.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S4.SS3.p1.1.m1.1.1.1.2.1.cmml">|</mo></mrow></msubsup><msub id="S4.SS3.p1.1.m1.1.2.2" xref="S4.SS3.p1.1.m1.1.2.2.cmml"><mi id="S4.SS3.p1.1.m1.1.2.2.2" xref="S4.SS3.p1.1.m1.1.2.2.2.cmml">r</mi><mi id="S4.SS3.p1.1.m1.1.2.2.3" xref="S4.SS3.p1.1.m1.1.2.2.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.2"><apply id="S4.SS3.p1.1.m1.1.2.1.cmml" xref="S4.SS3.p1.1.m1.1.2.1"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.2.1.1.cmml" xref="S4.SS3.p1.1.m1.1.2.1">superscript</csymbol><apply id="S4.SS3.p1.1.m1.1.2.1.2.cmml" xref="S4.SS3.p1.1.m1.1.2.1"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.2.1.2.1.cmml" xref="S4.SS3.p1.1.m1.1.2.1">subscript</csymbol><sum id="S4.SS3.p1.1.m1.1.2.1.2.2.cmml" xref="S4.SS3.p1.1.m1.1.2.1.2.2"></sum><apply id="S4.SS3.p1.1.m1.1.2.1.2.3.cmml" xref="S4.SS3.p1.1.m1.1.2.1.2.3"><eq id="S4.SS3.p1.1.m1.1.2.1.2.3.1.cmml" xref="S4.SS3.p1.1.m1.1.2.1.2.3.1"></eq><ci id="S4.SS3.p1.1.m1.1.2.1.2.3.2.cmml" xref="S4.SS3.p1.1.m1.1.2.1.2.3.2">𝑖</ci><cn id="S4.SS3.p1.1.m1.1.2.1.2.3.3.cmml" type="integer" xref="S4.SS3.p1.1.m1.1.2.1.2.3.3">0</cn></apply></apply><apply id="S4.SS3.p1.1.m1.1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.1.3"><abs id="S4.SS3.p1.1.m1.1.1.1.2.1.cmml" xref="S4.SS3.p1.1.m1.1.1.1.3.1"></abs><ci id="S4.SS3.p1.1.m1.1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1.1.1">𝜏</ci></apply></apply><apply id="S4.SS3.p1.1.m1.1.2.2.cmml" xref="S4.SS3.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.2.2.1.cmml" xref="S4.SS3.p1.1.m1.1.2.2">subscript</csymbol><ci id="S4.SS3.p1.1.m1.1.2.2.2.cmml" xref="S4.SS3.p1.1.m1.1.2.2.2">𝑟</ci><ci id="S4.SS3.p1.1.m1.1.2.2.3.cmml" xref="S4.SS3.p1.1.m1.1.2.2.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\sum_{i=0}^{|\tau|}r_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">∑ start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_τ | end_POSTSUPERSCRIPT italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>). However, this method encounters difficulties in tasks that require stitching – the process of learning an optimal policy from sub-optimal trajectories by effectively combining them. By contrast, the Q-learning approach addresses this by independently propagating the value function backwards at each timestep using the Bellman backup. It integrates information for each state across different trajectories, thereby circumventing the stitching issue inherent in the reward conditioning approach. Our proposed solution to this challenge involves a novel approach: relabeling the RTG values using learned Q-functions. By applying this relabeling to the dataset, the reward conditioning approach can then effectively utilize optimal segments from within sub-optimal trajectories. This enhancement allows for the extraction and integration of valuable sub-trajectory segments, thus addressing the fundamental limitation of the original reward conditioning method in tasks requiring effective stitching of policy learning.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">In addressing the relabeling of RTG values with learned Q-functions, it’s important to recognize that simply substituting all RTG values with Q-function estimates is not always effective. This is particularly true in scenarios characterized by long time horizons and sparse rewards, where the accuracy of learned Q-functions can vary significantly. Our goal is to selectively replace RTG values in instances where the learned Q-functions provide reliable estimations. To achieve this, we incorporate the CQL framework <cite class="ltx_cite ltx_citemacro_citep">(Kumar et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib17" title="">2020</a>)</cite>, renowned for learning the lower bounds of value functions in offline Q-learning algorithms. The relabeling of RTG values is conducted selectively: it occurs when the RTG within a trajectory is lower than the lower bound estimated by CQL. This approach ensures that RTG values are replaced only when the learned value function is reasonably accurate or closer to the true value. Furthermore, our method extends the impact of this relabeling process through the trajectory. We apply reward recursion, defined as <math alttext="R_{t-1}=r_{t-1}+R_{t}" class="ltx_Math" display="inline" id="S4.SS3.p2.1.m1.1"><semantics id="S4.SS3.p2.1.m1.1a"><mrow id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml"><msub id="S4.SS3.p2.1.m1.1.1.2" xref="S4.SS3.p2.1.m1.1.1.2.cmml"><mi id="S4.SS3.p2.1.m1.1.1.2.2" xref="S4.SS3.p2.1.m1.1.1.2.2.cmml">R</mi><mrow id="S4.SS3.p2.1.m1.1.1.2.3" xref="S4.SS3.p2.1.m1.1.1.2.3.cmml"><mi id="S4.SS3.p2.1.m1.1.1.2.3.2" xref="S4.SS3.p2.1.m1.1.1.2.3.2.cmml">t</mi><mo id="S4.SS3.p2.1.m1.1.1.2.3.1" xref="S4.SS3.p2.1.m1.1.1.2.3.1.cmml">−</mo><mn id="S4.SS3.p2.1.m1.1.1.2.3.3" xref="S4.SS3.p2.1.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS3.p2.1.m1.1.1.1" xref="S4.SS3.p2.1.m1.1.1.1.cmml">=</mo><mrow id="S4.SS3.p2.1.m1.1.1.3" xref="S4.SS3.p2.1.m1.1.1.3.cmml"><msub id="S4.SS3.p2.1.m1.1.1.3.2" xref="S4.SS3.p2.1.m1.1.1.3.2.cmml"><mi id="S4.SS3.p2.1.m1.1.1.3.2.2" xref="S4.SS3.p2.1.m1.1.1.3.2.2.cmml">r</mi><mrow id="S4.SS3.p2.1.m1.1.1.3.2.3" xref="S4.SS3.p2.1.m1.1.1.3.2.3.cmml"><mi id="S4.SS3.p2.1.m1.1.1.3.2.3.2" xref="S4.SS3.p2.1.m1.1.1.3.2.3.2.cmml">t</mi><mo id="S4.SS3.p2.1.m1.1.1.3.2.3.1" xref="S4.SS3.p2.1.m1.1.1.3.2.3.1.cmml">−</mo><mn id="S4.SS3.p2.1.m1.1.1.3.2.3.3" xref="S4.SS3.p2.1.m1.1.1.3.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS3.p2.1.m1.1.1.3.1" xref="S4.SS3.p2.1.m1.1.1.3.1.cmml">+</mo><msub id="S4.SS3.p2.1.m1.1.1.3.3" xref="S4.SS3.p2.1.m1.1.1.3.3.cmml"><mi id="S4.SS3.p2.1.m1.1.1.3.3.2" xref="S4.SS3.p2.1.m1.1.1.3.3.2.cmml">R</mi><mi id="S4.SS3.p2.1.m1.1.1.3.3.3" xref="S4.SS3.p2.1.m1.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1"><eq id="S4.SS3.p2.1.m1.1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1.1"></eq><apply id="S4.SS3.p2.1.m1.1.1.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.1.1.2.1.cmml" xref="S4.SS3.p2.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS3.p2.1.m1.1.1.2.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2.2">𝑅</ci><apply id="S4.SS3.p2.1.m1.1.1.2.3.cmml" xref="S4.SS3.p2.1.m1.1.1.2.3"><minus id="S4.SS3.p2.1.m1.1.1.2.3.1.cmml" xref="S4.SS3.p2.1.m1.1.1.2.3.1"></minus><ci id="S4.SS3.p2.1.m1.1.1.2.3.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2.3.2">𝑡</ci><cn id="S4.SS3.p2.1.m1.1.1.2.3.3.cmml" type="integer" xref="S4.SS3.p2.1.m1.1.1.2.3.3">1</cn></apply></apply><apply id="S4.SS3.p2.1.m1.1.1.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3"><plus id="S4.SS3.p2.1.m1.1.1.3.1.cmml" xref="S4.SS3.p2.1.m1.1.1.3.1"></plus><apply id="S4.SS3.p2.1.m1.1.1.3.2.cmml" xref="S4.SS3.p2.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.1.1.3.2.1.cmml" xref="S4.SS3.p2.1.m1.1.1.3.2">subscript</csymbol><ci id="S4.SS3.p2.1.m1.1.1.3.2.2.cmml" xref="S4.SS3.p2.1.m1.1.1.3.2.2">𝑟</ci><apply id="S4.SS3.p2.1.m1.1.1.3.2.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3.2.3"><minus id="S4.SS3.p2.1.m1.1.1.3.2.3.1.cmml" xref="S4.SS3.p2.1.m1.1.1.3.2.3.1"></minus><ci id="S4.SS3.p2.1.m1.1.1.3.2.3.2.cmml" xref="S4.SS3.p2.1.m1.1.1.3.2.3.2">𝑡</ci><cn id="S4.SS3.p2.1.m1.1.1.3.2.3.3.cmml" type="integer" xref="S4.SS3.p2.1.m1.1.1.3.2.3.3">1</cn></apply></apply><apply id="S4.SS3.p2.1.m1.1.1.3.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.1.1.3.3.1.cmml" xref="S4.SS3.p2.1.m1.1.1.3.3">subscript</csymbol><ci id="S4.SS3.p2.1.m1.1.1.3.3.2.cmml" xref="S4.SS3.p2.1.m1.1.1.3.3.2">𝑅</ci><ci id="S4.SS3.p2.1.m1.1.1.3.3.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">R_{t-1}=r_{t-1}+R_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m1.1d">italic_R start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT = italic_r start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT + italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, to propagate the revised RTG values to all preceding timesteps in the trajectory. This ensures that the influence of the adjusted RTG is not isolated but is instead integrated throughout the trajectory, enhancing the overall consistency and accuracy of our approach.</p>
</div>
<div class="ltx_para" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.14">To implement our approach, we begin by initializing the RTG of the final state in a trajectory to zero, denoted as <math alttext="R_{T}=0" class="ltx_Math" display="inline" id="S4.SS3.p3.1.m1.1"><semantics id="S4.SS3.p3.1.m1.1a"><mrow id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml"><msub id="S4.SS3.p3.1.m1.1.1.2" xref="S4.SS3.p3.1.m1.1.1.2.cmml"><mi id="S4.SS3.p3.1.m1.1.1.2.2" xref="S4.SS3.p3.1.m1.1.1.2.2.cmml">R</mi><mi id="S4.SS3.p3.1.m1.1.1.2.3" xref="S4.SS3.p3.1.m1.1.1.2.3.cmml">T</mi></msub><mo id="S4.SS3.p3.1.m1.1.1.1" xref="S4.SS3.p3.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS3.p3.1.m1.1.1.3" xref="S4.SS3.p3.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><apply id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1"><eq id="S4.SS3.p3.1.m1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1.1"></eq><apply id="S4.SS3.p3.1.m1.1.1.2.cmml" xref="S4.SS3.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.1.1.2.1.cmml" xref="S4.SS3.p3.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS3.p3.1.m1.1.1.2.2.cmml" xref="S4.SS3.p3.1.m1.1.1.2.2">𝑅</ci><ci id="S4.SS3.p3.1.m1.1.1.2.3.cmml" xref="S4.SS3.p3.1.m1.1.1.2.3">𝑇</ci></apply><cn id="S4.SS3.p3.1.m1.1.1.3.cmml" type="integer" xref="S4.SS3.p3.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">R_{T}=0</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.1.m1.1d">italic_R start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT = 0</annotation></semantics></math>. Then, we proceed in reverse chronological order, starting from the end of the trajectory and moving backwards towards the initial state. The process involves a series of steps at each state in the trajectory. Firstly, for the current state <math alttext="s_{t}" class="ltx_Math" display="inline" id="S4.SS3.p3.2.m2.1"><semantics id="S4.SS3.p3.2.m2.1a"><msub id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml"><mi id="S4.SS3.p3.2.m2.1.1.2" xref="S4.SS3.p3.2.m2.1.1.2.cmml">s</mi><mi id="S4.SS3.p3.2.m2.1.1.3" xref="S4.SS3.p3.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><apply id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.1.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p3.2.m2.1.1.2.cmml" xref="S4.SS3.p3.2.m2.1.1.2">𝑠</ci><ci id="S4.SS3.p3.2.m2.1.1.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.2.m2.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, we compute its state value using the learned value function, expressed as <math alttext="\hat{V}(s_{t})=\mathbb{E}_{a\sim\pi(a|s_{t})}[\hat{Q}(s_{t},a)]" class="ltx_Math" display="inline" id="S4.SS3.p3.3.m3.4"><semantics id="S4.SS3.p3.3.m3.4a"><mrow id="S4.SS3.p3.3.m3.4.4" xref="S4.SS3.p3.3.m3.4.4.cmml"><mrow id="S4.SS3.p3.3.m3.3.3.1" xref="S4.SS3.p3.3.m3.3.3.1.cmml"><mover accent="true" id="S4.SS3.p3.3.m3.3.3.1.3" xref="S4.SS3.p3.3.m3.3.3.1.3.cmml"><mi id="S4.SS3.p3.3.m3.3.3.1.3.2" xref="S4.SS3.p3.3.m3.3.3.1.3.2.cmml">V</mi><mo id="S4.SS3.p3.3.m3.3.3.1.3.1" xref="S4.SS3.p3.3.m3.3.3.1.3.1.cmml">^</mo></mover><mo id="S4.SS3.p3.3.m3.3.3.1.2" xref="S4.SS3.p3.3.m3.3.3.1.2.cmml">⁢</mo><mrow id="S4.SS3.p3.3.m3.3.3.1.1.1" xref="S4.SS3.p3.3.m3.3.3.1.1.1.1.cmml"><mo id="S4.SS3.p3.3.m3.3.3.1.1.1.2" stretchy="false" xref="S4.SS3.p3.3.m3.3.3.1.1.1.1.cmml">(</mo><msub id="S4.SS3.p3.3.m3.3.3.1.1.1.1" xref="S4.SS3.p3.3.m3.3.3.1.1.1.1.cmml"><mi id="S4.SS3.p3.3.m3.3.3.1.1.1.1.2" xref="S4.SS3.p3.3.m3.3.3.1.1.1.1.2.cmml">s</mi><mi id="S4.SS3.p3.3.m3.3.3.1.1.1.1.3" xref="S4.SS3.p3.3.m3.3.3.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS3.p3.3.m3.3.3.1.1.1.3" stretchy="false" xref="S4.SS3.p3.3.m3.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS3.p3.3.m3.4.4.3" xref="S4.SS3.p3.3.m3.4.4.3.cmml">=</mo><mrow id="S4.SS3.p3.3.m3.4.4.2" xref="S4.SS3.p3.3.m3.4.4.2.cmml"><msub id="S4.SS3.p3.3.m3.4.4.2.3" xref="S4.SS3.p3.3.m3.4.4.2.3.cmml"><mi id="S4.SS3.p3.3.m3.4.4.2.3.2" xref="S4.SS3.p3.3.m3.4.4.2.3.2.cmml">𝔼</mi><mrow id="S4.SS3.p3.3.m3.1.1.1" xref="S4.SS3.p3.3.m3.1.1.1.cmml"><mi id="S4.SS3.p3.3.m3.1.1.1.3" xref="S4.SS3.p3.3.m3.1.1.1.3.cmml">a</mi><mo id="S4.SS3.p3.3.m3.1.1.1.2" xref="S4.SS3.p3.3.m3.1.1.1.2.cmml">∼</mo><mrow id="S4.SS3.p3.3.m3.1.1.1.1" xref="S4.SS3.p3.3.m3.1.1.1.1.cmml"><mi id="S4.SS3.p3.3.m3.1.1.1.1.3" xref="S4.SS3.p3.3.m3.1.1.1.1.3.cmml">π</mi><mo id="S4.SS3.p3.3.m3.1.1.1.1.2" xref="S4.SS3.p3.3.m3.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS3.p3.3.m3.1.1.1.1.1.1" xref="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.cmml"><mo id="S4.SS3.p3.3.m3.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p3.3.m3.1.1.1.1.1.1.1" xref="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.cmml"><mi id="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.2" xref="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.1" xref="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.3" xref="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.3.cmml"><mi id="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.3.2" xref="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.3.2.cmml">s</mi><mi id="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.3.3" xref="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S4.SS3.p3.3.m3.1.1.1.1.1.1.3" stretchy="false" xref="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></msub><mo id="S4.SS3.p3.3.m3.4.4.2.2" xref="S4.SS3.p3.3.m3.4.4.2.2.cmml">⁢</mo><mrow id="S4.SS3.p3.3.m3.4.4.2.1.1" xref="S4.SS3.p3.3.m3.4.4.2.1.2.cmml"><mo id="S4.SS3.p3.3.m3.4.4.2.1.1.2" stretchy="false" xref="S4.SS3.p3.3.m3.4.4.2.1.2.1.cmml">[</mo><mrow id="S4.SS3.p3.3.m3.4.4.2.1.1.1" xref="S4.SS3.p3.3.m3.4.4.2.1.1.1.cmml"><mover accent="true" id="S4.SS3.p3.3.m3.4.4.2.1.1.1.3" xref="S4.SS3.p3.3.m3.4.4.2.1.1.1.3.cmml"><mi id="S4.SS3.p3.3.m3.4.4.2.1.1.1.3.2" xref="S4.SS3.p3.3.m3.4.4.2.1.1.1.3.2.cmml">Q</mi><mo id="S4.SS3.p3.3.m3.4.4.2.1.1.1.3.1" xref="S4.SS3.p3.3.m3.4.4.2.1.1.1.3.1.cmml">^</mo></mover><mo id="S4.SS3.p3.3.m3.4.4.2.1.1.1.2" xref="S4.SS3.p3.3.m3.4.4.2.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS3.p3.3.m3.4.4.2.1.1.1.1.1" xref="S4.SS3.p3.3.m3.4.4.2.1.1.1.1.2.cmml"><mo id="S4.SS3.p3.3.m3.4.4.2.1.1.1.1.1.2" stretchy="false" xref="S4.SS3.p3.3.m3.4.4.2.1.1.1.1.2.cmml">(</mo><msub id="S4.SS3.p3.3.m3.4.4.2.1.1.1.1.1.1" xref="S4.SS3.p3.3.m3.4.4.2.1.1.1.1.1.1.cmml"><mi id="S4.SS3.p3.3.m3.4.4.2.1.1.1.1.1.1.2" xref="S4.SS3.p3.3.m3.4.4.2.1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS3.p3.3.m3.4.4.2.1.1.1.1.1.1.3" xref="S4.SS3.p3.3.m3.4.4.2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS3.p3.3.m3.4.4.2.1.1.1.1.1.3" xref="S4.SS3.p3.3.m3.4.4.2.1.1.1.1.2.cmml">,</mo><mi id="S4.SS3.p3.3.m3.2.2" xref="S4.SS3.p3.3.m3.2.2.cmml">a</mi><mo id="S4.SS3.p3.3.m3.4.4.2.1.1.1.1.1.4" stretchy="false" xref="S4.SS3.p3.3.m3.4.4.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.SS3.p3.3.m3.4.4.2.1.1.3" stretchy="false" xref="S4.SS3.p3.3.m3.4.4.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m3.4b"><apply id="S4.SS3.p3.3.m3.4.4.cmml" xref="S4.SS3.p3.3.m3.4.4"><eq id="S4.SS3.p3.3.m3.4.4.3.cmml" xref="S4.SS3.p3.3.m3.4.4.3"></eq><apply id="S4.SS3.p3.3.m3.3.3.1.cmml" xref="S4.SS3.p3.3.m3.3.3.1"><times id="S4.SS3.p3.3.m3.3.3.1.2.cmml" xref="S4.SS3.p3.3.m3.3.3.1.2"></times><apply id="S4.SS3.p3.3.m3.3.3.1.3.cmml" xref="S4.SS3.p3.3.m3.3.3.1.3"><ci id="S4.SS3.p3.3.m3.3.3.1.3.1.cmml" xref="S4.SS3.p3.3.m3.3.3.1.3.1">^</ci><ci id="S4.SS3.p3.3.m3.3.3.1.3.2.cmml" xref="S4.SS3.p3.3.m3.3.3.1.3.2">𝑉</ci></apply><apply id="S4.SS3.p3.3.m3.3.3.1.1.1.1.cmml" xref="S4.SS3.p3.3.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.3.m3.3.3.1.1.1.1.1.cmml" xref="S4.SS3.p3.3.m3.3.3.1.1.1">subscript</csymbol><ci id="S4.SS3.p3.3.m3.3.3.1.1.1.1.2.cmml" xref="S4.SS3.p3.3.m3.3.3.1.1.1.1.2">𝑠</ci><ci id="S4.SS3.p3.3.m3.3.3.1.1.1.1.3.cmml" xref="S4.SS3.p3.3.m3.3.3.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S4.SS3.p3.3.m3.4.4.2.cmml" xref="S4.SS3.p3.3.m3.4.4.2"><times id="S4.SS3.p3.3.m3.4.4.2.2.cmml" xref="S4.SS3.p3.3.m3.4.4.2.2"></times><apply id="S4.SS3.p3.3.m3.4.4.2.3.cmml" xref="S4.SS3.p3.3.m3.4.4.2.3"><csymbol cd="ambiguous" id="S4.SS3.p3.3.m3.4.4.2.3.1.cmml" xref="S4.SS3.p3.3.m3.4.4.2.3">subscript</csymbol><ci id="S4.SS3.p3.3.m3.4.4.2.3.2.cmml" xref="S4.SS3.p3.3.m3.4.4.2.3.2">𝔼</ci><apply id="S4.SS3.p3.3.m3.1.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1.1"><csymbol cd="latexml" id="S4.SS3.p3.3.m3.1.1.1.2.cmml" xref="S4.SS3.p3.3.m3.1.1.1.2">similar-to</csymbol><ci id="S4.SS3.p3.3.m3.1.1.1.3.cmml" xref="S4.SS3.p3.3.m3.1.1.1.3">𝑎</ci><apply id="S4.SS3.p3.3.m3.1.1.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1.1.1"><times id="S4.SS3.p3.3.m3.1.1.1.1.2.cmml" xref="S4.SS3.p3.3.m3.1.1.1.1.2"></times><ci id="S4.SS3.p3.3.m3.1.1.1.1.3.cmml" xref="S4.SS3.p3.3.m3.1.1.1.1.3">𝜋</ci><apply id="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.2">𝑎</ci><apply id="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.3.2">𝑠</ci><ci id="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.3.3.cmml" xref="S4.SS3.p3.3.m3.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply><apply id="S4.SS3.p3.3.m3.4.4.2.1.2.cmml" xref="S4.SS3.p3.3.m3.4.4.2.1.1"><csymbol cd="latexml" id="S4.SS3.p3.3.m3.4.4.2.1.2.1.cmml" xref="S4.SS3.p3.3.m3.4.4.2.1.1.2">delimited-[]</csymbol><apply id="S4.SS3.p3.3.m3.4.4.2.1.1.1.cmml" xref="S4.SS3.p3.3.m3.4.4.2.1.1.1"><times id="S4.SS3.p3.3.m3.4.4.2.1.1.1.2.cmml" xref="S4.SS3.p3.3.m3.4.4.2.1.1.1.2"></times><apply id="S4.SS3.p3.3.m3.4.4.2.1.1.1.3.cmml" xref="S4.SS3.p3.3.m3.4.4.2.1.1.1.3"><ci id="S4.SS3.p3.3.m3.4.4.2.1.1.1.3.1.cmml" xref="S4.SS3.p3.3.m3.4.4.2.1.1.1.3.1">^</ci><ci id="S4.SS3.p3.3.m3.4.4.2.1.1.1.3.2.cmml" xref="S4.SS3.p3.3.m3.4.4.2.1.1.1.3.2">𝑄</ci></apply><interval closure="open" id="S4.SS3.p3.3.m3.4.4.2.1.1.1.1.2.cmml" xref="S4.SS3.p3.3.m3.4.4.2.1.1.1.1.1"><apply id="S4.SS3.p3.3.m3.4.4.2.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.3.m3.4.4.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.3.m3.4.4.2.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.3.m3.4.4.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p3.3.m3.4.4.2.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p3.3.m3.4.4.2.1.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS3.p3.3.m3.4.4.2.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p3.3.m3.4.4.2.1.1.1.1.1.1.3">𝑡</ci></apply><ci id="S4.SS3.p3.3.m3.2.2.cmml" xref="S4.SS3.p3.3.m3.2.2">𝑎</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m3.4c">\hat{V}(s_{t})=\mathbb{E}_{a\sim\pi(a|s_{t})}[\hat{Q}(s_{t},a)]</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.3.m3.4d">over^ start_ARG italic_V end_ARG ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = blackboard_E start_POSTSUBSCRIPT italic_a ∼ italic_π ( italic_a | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT [ over^ start_ARG italic_Q end_ARG ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a ) ]</annotation></semantics></math>, where <math alttext="\pi" class="ltx_Math" display="inline" id="S4.SS3.p3.4.m4.1"><semantics id="S4.SS3.p3.4.m4.1a"><mi id="S4.SS3.p3.4.m4.1.1" xref="S4.SS3.p3.4.m4.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.4.m4.1b"><ci id="S4.SS3.p3.4.m4.1.1.cmml" xref="S4.SS3.p3.4.m4.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.4.m4.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.4.m4.1d">italic_π</annotation></semantics></math> represents the learned policy. This value function estimation reflects the expected value of actions taken in the current state according to the policy. Next, we compare this computed value function, <math alttext="\hat{V}(s_{t})" class="ltx_Math" display="inline" id="S4.SS3.p3.5.m5.1"><semantics id="S4.SS3.p3.5.m5.1a"><mrow id="S4.SS3.p3.5.m5.1.1" xref="S4.SS3.p3.5.m5.1.1.cmml"><mover accent="true" id="S4.SS3.p3.5.m5.1.1.3" xref="S4.SS3.p3.5.m5.1.1.3.cmml"><mi id="S4.SS3.p3.5.m5.1.1.3.2" xref="S4.SS3.p3.5.m5.1.1.3.2.cmml">V</mi><mo id="S4.SS3.p3.5.m5.1.1.3.1" xref="S4.SS3.p3.5.m5.1.1.3.1.cmml">^</mo></mover><mo id="S4.SS3.p3.5.m5.1.1.2" xref="S4.SS3.p3.5.m5.1.1.2.cmml">⁢</mo><mrow id="S4.SS3.p3.5.m5.1.1.1.1" xref="S4.SS3.p3.5.m5.1.1.1.1.1.cmml"><mo id="S4.SS3.p3.5.m5.1.1.1.1.2" stretchy="false" xref="S4.SS3.p3.5.m5.1.1.1.1.1.cmml">(</mo><msub id="S4.SS3.p3.5.m5.1.1.1.1.1" xref="S4.SS3.p3.5.m5.1.1.1.1.1.cmml"><mi id="S4.SS3.p3.5.m5.1.1.1.1.1.2" xref="S4.SS3.p3.5.m5.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS3.p3.5.m5.1.1.1.1.1.3" xref="S4.SS3.p3.5.m5.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS3.p3.5.m5.1.1.1.1.3" stretchy="false" xref="S4.SS3.p3.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.5.m5.1b"><apply id="S4.SS3.p3.5.m5.1.1.cmml" xref="S4.SS3.p3.5.m5.1.1"><times id="S4.SS3.p3.5.m5.1.1.2.cmml" xref="S4.SS3.p3.5.m5.1.1.2"></times><apply id="S4.SS3.p3.5.m5.1.1.3.cmml" xref="S4.SS3.p3.5.m5.1.1.3"><ci id="S4.SS3.p3.5.m5.1.1.3.1.cmml" xref="S4.SS3.p3.5.m5.1.1.3.1">^</ci><ci id="S4.SS3.p3.5.m5.1.1.3.2.cmml" xref="S4.SS3.p3.5.m5.1.1.3.2">𝑉</ci></apply><apply id="S4.SS3.p3.5.m5.1.1.1.1.1.cmml" xref="S4.SS3.p3.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.5.m5.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.5.m5.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p3.5.m5.1.1.1.1.1.2.cmml" xref="S4.SS3.p3.5.m5.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS3.p3.5.m5.1.1.1.1.1.3.cmml" xref="S4.SS3.p3.5.m5.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.5.m5.1c">\hat{V}(s_{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.5.m5.1d">over^ start_ARG italic_V end_ARG ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, with the existing RTG value at the same state (i.e., <math alttext="R(t)" class="ltx_Math" display="inline" id="S4.SS3.p3.6.m6.1"><semantics id="S4.SS3.p3.6.m6.1a"><mrow id="S4.SS3.p3.6.m6.1.2" xref="S4.SS3.p3.6.m6.1.2.cmml"><mi id="S4.SS3.p3.6.m6.1.2.2" xref="S4.SS3.p3.6.m6.1.2.2.cmml">R</mi><mo id="S4.SS3.p3.6.m6.1.2.1" xref="S4.SS3.p3.6.m6.1.2.1.cmml">⁢</mo><mrow id="S4.SS3.p3.6.m6.1.2.3.2" xref="S4.SS3.p3.6.m6.1.2.cmml"><mo id="S4.SS3.p3.6.m6.1.2.3.2.1" stretchy="false" xref="S4.SS3.p3.6.m6.1.2.cmml">(</mo><mi id="S4.SS3.p3.6.m6.1.1" xref="S4.SS3.p3.6.m6.1.1.cmml">t</mi><mo id="S4.SS3.p3.6.m6.1.2.3.2.2" stretchy="false" xref="S4.SS3.p3.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.6.m6.1b"><apply id="S4.SS3.p3.6.m6.1.2.cmml" xref="S4.SS3.p3.6.m6.1.2"><times id="S4.SS3.p3.6.m6.1.2.1.cmml" xref="S4.SS3.p3.6.m6.1.2.1"></times><ci id="S4.SS3.p3.6.m6.1.2.2.cmml" xref="S4.SS3.p3.6.m6.1.2.2">𝑅</ci><ci id="S4.SS3.p3.6.m6.1.1.cmml" xref="S4.SS3.p3.6.m6.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.6.m6.1c">R(t)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.6.m6.1d">italic_R ( italic_t )</annotation></semantics></math>). If <math alttext="\hat{V}(s_{t})" class="ltx_Math" display="inline" id="S4.SS3.p3.7.m7.1"><semantics id="S4.SS3.p3.7.m7.1a"><mrow id="S4.SS3.p3.7.m7.1.1" xref="S4.SS3.p3.7.m7.1.1.cmml"><mover accent="true" id="S4.SS3.p3.7.m7.1.1.3" xref="S4.SS3.p3.7.m7.1.1.3.cmml"><mi id="S4.SS3.p3.7.m7.1.1.3.2" xref="S4.SS3.p3.7.m7.1.1.3.2.cmml">V</mi><mo id="S4.SS3.p3.7.m7.1.1.3.1" xref="S4.SS3.p3.7.m7.1.1.3.1.cmml">^</mo></mover><mo id="S4.SS3.p3.7.m7.1.1.2" xref="S4.SS3.p3.7.m7.1.1.2.cmml">⁢</mo><mrow id="S4.SS3.p3.7.m7.1.1.1.1" xref="S4.SS3.p3.7.m7.1.1.1.1.1.cmml"><mo id="S4.SS3.p3.7.m7.1.1.1.1.2" stretchy="false" xref="S4.SS3.p3.7.m7.1.1.1.1.1.cmml">(</mo><msub id="S4.SS3.p3.7.m7.1.1.1.1.1" xref="S4.SS3.p3.7.m7.1.1.1.1.1.cmml"><mi id="S4.SS3.p3.7.m7.1.1.1.1.1.2" xref="S4.SS3.p3.7.m7.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS3.p3.7.m7.1.1.1.1.1.3" xref="S4.SS3.p3.7.m7.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS3.p3.7.m7.1.1.1.1.3" stretchy="false" xref="S4.SS3.p3.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.7.m7.1b"><apply id="S4.SS3.p3.7.m7.1.1.cmml" xref="S4.SS3.p3.7.m7.1.1"><times id="S4.SS3.p3.7.m7.1.1.2.cmml" xref="S4.SS3.p3.7.m7.1.1.2"></times><apply id="S4.SS3.p3.7.m7.1.1.3.cmml" xref="S4.SS3.p3.7.m7.1.1.3"><ci id="S4.SS3.p3.7.m7.1.1.3.1.cmml" xref="S4.SS3.p3.7.m7.1.1.3.1">^</ci><ci id="S4.SS3.p3.7.m7.1.1.3.2.cmml" xref="S4.SS3.p3.7.m7.1.1.3.2">𝑉</ci></apply><apply id="S4.SS3.p3.7.m7.1.1.1.1.1.cmml" xref="S4.SS3.p3.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.7.m7.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.7.m7.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p3.7.m7.1.1.1.1.1.2.cmml" xref="S4.SS3.p3.7.m7.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS3.p3.7.m7.1.1.1.1.1.3.cmml" xref="S4.SS3.p3.7.m7.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.7.m7.1c">\hat{V}(s_{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.7.m7.1d">over^ start_ARG italic_V end_ARG ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> is greater than <math alttext="R_{t}" class="ltx_Math" display="inline" id="S4.SS3.p3.8.m8.1"><semantics id="S4.SS3.p3.8.m8.1a"><msub id="S4.SS3.p3.8.m8.1.1" xref="S4.SS3.p3.8.m8.1.1.cmml"><mi id="S4.SS3.p3.8.m8.1.1.2" xref="S4.SS3.p3.8.m8.1.1.2.cmml">R</mi><mi id="S4.SS3.p3.8.m8.1.1.3" xref="S4.SS3.p3.8.m8.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.8.m8.1b"><apply id="S4.SS3.p3.8.m8.1.1.cmml" xref="S4.SS3.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.8.m8.1.1.1.cmml" xref="S4.SS3.p3.8.m8.1.1">subscript</csymbol><ci id="S4.SS3.p3.8.m8.1.1.2.cmml" xref="S4.SS3.p3.8.m8.1.1.2">𝑅</ci><ci id="S4.SS3.p3.8.m8.1.1.3.cmml" xref="S4.SS3.p3.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.8.m8.1c">R_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.8.m8.1d">italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, we update the RTG for the previous timestep <math alttext="R_{t-1}" class="ltx_Math" display="inline" id="S4.SS3.p3.9.m9.1"><semantics id="S4.SS3.p3.9.m9.1a"><msub id="S4.SS3.p3.9.m9.1.1" xref="S4.SS3.p3.9.m9.1.1.cmml"><mi id="S4.SS3.p3.9.m9.1.1.2" xref="S4.SS3.p3.9.m9.1.1.2.cmml">R</mi><mrow id="S4.SS3.p3.9.m9.1.1.3" xref="S4.SS3.p3.9.m9.1.1.3.cmml"><mi id="S4.SS3.p3.9.m9.1.1.3.2" xref="S4.SS3.p3.9.m9.1.1.3.2.cmml">t</mi><mo id="S4.SS3.p3.9.m9.1.1.3.1" xref="S4.SS3.p3.9.m9.1.1.3.1.cmml">−</mo><mn id="S4.SS3.p3.9.m9.1.1.3.3" xref="S4.SS3.p3.9.m9.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.9.m9.1b"><apply id="S4.SS3.p3.9.m9.1.1.cmml" xref="S4.SS3.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.9.m9.1.1.1.cmml" xref="S4.SS3.p3.9.m9.1.1">subscript</csymbol><ci id="S4.SS3.p3.9.m9.1.1.2.cmml" xref="S4.SS3.p3.9.m9.1.1.2">𝑅</ci><apply id="S4.SS3.p3.9.m9.1.1.3.cmml" xref="S4.SS3.p3.9.m9.1.1.3"><minus id="S4.SS3.p3.9.m9.1.1.3.1.cmml" xref="S4.SS3.p3.9.m9.1.1.3.1"></minus><ci id="S4.SS3.p3.9.m9.1.1.3.2.cmml" xref="S4.SS3.p3.9.m9.1.1.3.2">𝑡</ci><cn id="S4.SS3.p3.9.m9.1.1.3.3.cmml" type="integer" xref="S4.SS3.p3.9.m9.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.9.m9.1c">R_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.9.m9.1d">italic_R start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math> to the sum of the reward at timestep <math alttext="t-1" class="ltx_Math" display="inline" id="S4.SS3.p3.10.m10.1"><semantics id="S4.SS3.p3.10.m10.1a"><mrow id="S4.SS3.p3.10.m10.1.1" xref="S4.SS3.p3.10.m10.1.1.cmml"><mi id="S4.SS3.p3.10.m10.1.1.2" xref="S4.SS3.p3.10.m10.1.1.2.cmml">t</mi><mo id="S4.SS3.p3.10.m10.1.1.1" xref="S4.SS3.p3.10.m10.1.1.1.cmml">−</mo><mn id="S4.SS3.p3.10.m10.1.1.3" xref="S4.SS3.p3.10.m10.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.10.m10.1b"><apply id="S4.SS3.p3.10.m10.1.1.cmml" xref="S4.SS3.p3.10.m10.1.1"><minus id="S4.SS3.p3.10.m10.1.1.1.cmml" xref="S4.SS3.p3.10.m10.1.1.1"></minus><ci id="S4.SS3.p3.10.m10.1.1.2.cmml" xref="S4.SS3.p3.10.m10.1.1.2">𝑡</ci><cn id="S4.SS3.p3.10.m10.1.1.3.cmml" type="integer" xref="S4.SS3.p3.10.m10.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.10.m10.1c">t-1</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.10.m10.1d">italic_t - 1</annotation></semantics></math>, <math alttext="r_{t-1}" class="ltx_Math" display="inline" id="S4.SS3.p3.11.m11.1"><semantics id="S4.SS3.p3.11.m11.1a"><msub id="S4.SS3.p3.11.m11.1.1" xref="S4.SS3.p3.11.m11.1.1.cmml"><mi id="S4.SS3.p3.11.m11.1.1.2" xref="S4.SS3.p3.11.m11.1.1.2.cmml">r</mi><mrow id="S4.SS3.p3.11.m11.1.1.3" xref="S4.SS3.p3.11.m11.1.1.3.cmml"><mi id="S4.SS3.p3.11.m11.1.1.3.2" xref="S4.SS3.p3.11.m11.1.1.3.2.cmml">t</mi><mo id="S4.SS3.p3.11.m11.1.1.3.1" xref="S4.SS3.p3.11.m11.1.1.3.1.cmml">−</mo><mn id="S4.SS3.p3.11.m11.1.1.3.3" xref="S4.SS3.p3.11.m11.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.11.m11.1b"><apply id="S4.SS3.p3.11.m11.1.1.cmml" xref="S4.SS3.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.11.m11.1.1.1.cmml" xref="S4.SS3.p3.11.m11.1.1">subscript</csymbol><ci id="S4.SS3.p3.11.m11.1.1.2.cmml" xref="S4.SS3.p3.11.m11.1.1.2">𝑟</ci><apply id="S4.SS3.p3.11.m11.1.1.3.cmml" xref="S4.SS3.p3.11.m11.1.1.3"><minus id="S4.SS3.p3.11.m11.1.1.3.1.cmml" xref="S4.SS3.p3.11.m11.1.1.3.1"></minus><ci id="S4.SS3.p3.11.m11.1.1.3.2.cmml" xref="S4.SS3.p3.11.m11.1.1.3.2">𝑡</ci><cn id="S4.SS3.p3.11.m11.1.1.3.3.cmml" type="integer" xref="S4.SS3.p3.11.m11.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.11.m11.1c">r_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.11.m11.1d">italic_r start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math> and the estimated state value <math alttext="\hat{V}(s_{t})" class="ltx_Math" display="inline" id="S4.SS3.p3.12.m12.1"><semantics id="S4.SS3.p3.12.m12.1a"><mrow id="S4.SS3.p3.12.m12.1.1" xref="S4.SS3.p3.12.m12.1.1.cmml"><mover accent="true" id="S4.SS3.p3.12.m12.1.1.3" xref="S4.SS3.p3.12.m12.1.1.3.cmml"><mi id="S4.SS3.p3.12.m12.1.1.3.2" xref="S4.SS3.p3.12.m12.1.1.3.2.cmml">V</mi><mo id="S4.SS3.p3.12.m12.1.1.3.1" xref="S4.SS3.p3.12.m12.1.1.3.1.cmml">^</mo></mover><mo id="S4.SS3.p3.12.m12.1.1.2" xref="S4.SS3.p3.12.m12.1.1.2.cmml">⁢</mo><mrow id="S4.SS3.p3.12.m12.1.1.1.1" xref="S4.SS3.p3.12.m12.1.1.1.1.1.cmml"><mo id="S4.SS3.p3.12.m12.1.1.1.1.2" stretchy="false" xref="S4.SS3.p3.12.m12.1.1.1.1.1.cmml">(</mo><msub id="S4.SS3.p3.12.m12.1.1.1.1.1" xref="S4.SS3.p3.12.m12.1.1.1.1.1.cmml"><mi id="S4.SS3.p3.12.m12.1.1.1.1.1.2" xref="S4.SS3.p3.12.m12.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS3.p3.12.m12.1.1.1.1.1.3" xref="S4.SS3.p3.12.m12.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS3.p3.12.m12.1.1.1.1.3" stretchy="false" xref="S4.SS3.p3.12.m12.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.12.m12.1b"><apply id="S4.SS3.p3.12.m12.1.1.cmml" xref="S4.SS3.p3.12.m12.1.1"><times id="S4.SS3.p3.12.m12.1.1.2.cmml" xref="S4.SS3.p3.12.m12.1.1.2"></times><apply id="S4.SS3.p3.12.m12.1.1.3.cmml" xref="S4.SS3.p3.12.m12.1.1.3"><ci id="S4.SS3.p3.12.m12.1.1.3.1.cmml" xref="S4.SS3.p3.12.m12.1.1.3.1">^</ci><ci id="S4.SS3.p3.12.m12.1.1.3.2.cmml" xref="S4.SS3.p3.12.m12.1.1.3.2">𝑉</ci></apply><apply id="S4.SS3.p3.12.m12.1.1.1.1.1.cmml" xref="S4.SS3.p3.12.m12.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.12.m12.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.12.m12.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p3.12.m12.1.1.1.1.1.2.cmml" xref="S4.SS3.p3.12.m12.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS3.p3.12.m12.1.1.1.1.1.3.cmml" xref="S4.SS3.p3.12.m12.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.12.m12.1c">\hat{V}(s_{t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.12.m12.1d">over^ start_ARG italic_V end_ARG ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>. If not, <math alttext="R_{t-1}" class="ltx_Math" display="inline" id="S4.SS3.p3.13.m13.1"><semantics id="S4.SS3.p3.13.m13.1a"><msub id="S4.SS3.p3.13.m13.1.1" xref="S4.SS3.p3.13.m13.1.1.cmml"><mi id="S4.SS3.p3.13.m13.1.1.2" xref="S4.SS3.p3.13.m13.1.1.2.cmml">R</mi><mrow id="S4.SS3.p3.13.m13.1.1.3" xref="S4.SS3.p3.13.m13.1.1.3.cmml"><mi id="S4.SS3.p3.13.m13.1.1.3.2" xref="S4.SS3.p3.13.m13.1.1.3.2.cmml">t</mi><mo id="S4.SS3.p3.13.m13.1.1.3.1" xref="S4.SS3.p3.13.m13.1.1.3.1.cmml">−</mo><mn id="S4.SS3.p3.13.m13.1.1.3.3" xref="S4.SS3.p3.13.m13.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.13.m13.1b"><apply id="S4.SS3.p3.13.m13.1.1.cmml" xref="S4.SS3.p3.13.m13.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.13.m13.1.1.1.cmml" xref="S4.SS3.p3.13.m13.1.1">subscript</csymbol><ci id="S4.SS3.p3.13.m13.1.1.2.cmml" xref="S4.SS3.p3.13.m13.1.1.2">𝑅</ci><apply id="S4.SS3.p3.13.m13.1.1.3.cmml" xref="S4.SS3.p3.13.m13.1.1.3"><minus id="S4.SS3.p3.13.m13.1.1.3.1.cmml" xref="S4.SS3.p3.13.m13.1.1.3.1"></minus><ci id="S4.SS3.p3.13.m13.1.1.3.2.cmml" xref="S4.SS3.p3.13.m13.1.1.3.2">𝑡</ci><cn id="S4.SS3.p3.13.m13.1.1.3.3.cmml" type="integer" xref="S4.SS3.p3.13.m13.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.13.m13.1c">R_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.13.m13.1d">italic_R start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math> is set to <math alttext="r_{t-1}+R_{t}" class="ltx_Math" display="inline" id="S4.SS3.p3.14.m14.1"><semantics id="S4.SS3.p3.14.m14.1a"><mrow id="S4.SS3.p3.14.m14.1.1" xref="S4.SS3.p3.14.m14.1.1.cmml"><msub id="S4.SS3.p3.14.m14.1.1.2" xref="S4.SS3.p3.14.m14.1.1.2.cmml"><mi id="S4.SS3.p3.14.m14.1.1.2.2" xref="S4.SS3.p3.14.m14.1.1.2.2.cmml">r</mi><mrow id="S4.SS3.p3.14.m14.1.1.2.3" xref="S4.SS3.p3.14.m14.1.1.2.3.cmml"><mi id="S4.SS3.p3.14.m14.1.1.2.3.2" xref="S4.SS3.p3.14.m14.1.1.2.3.2.cmml">t</mi><mo id="S4.SS3.p3.14.m14.1.1.2.3.1" xref="S4.SS3.p3.14.m14.1.1.2.3.1.cmml">−</mo><mn id="S4.SS3.p3.14.m14.1.1.2.3.3" xref="S4.SS3.p3.14.m14.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS3.p3.14.m14.1.1.1" xref="S4.SS3.p3.14.m14.1.1.1.cmml">+</mo><msub id="S4.SS3.p3.14.m14.1.1.3" xref="S4.SS3.p3.14.m14.1.1.3.cmml"><mi id="S4.SS3.p3.14.m14.1.1.3.2" xref="S4.SS3.p3.14.m14.1.1.3.2.cmml">R</mi><mi id="S4.SS3.p3.14.m14.1.1.3.3" xref="S4.SS3.p3.14.m14.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.14.m14.1b"><apply id="S4.SS3.p3.14.m14.1.1.cmml" xref="S4.SS3.p3.14.m14.1.1"><plus id="S4.SS3.p3.14.m14.1.1.1.cmml" xref="S4.SS3.p3.14.m14.1.1.1"></plus><apply id="S4.SS3.p3.14.m14.1.1.2.cmml" xref="S4.SS3.p3.14.m14.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.14.m14.1.1.2.1.cmml" xref="S4.SS3.p3.14.m14.1.1.2">subscript</csymbol><ci id="S4.SS3.p3.14.m14.1.1.2.2.cmml" xref="S4.SS3.p3.14.m14.1.1.2.2">𝑟</ci><apply id="S4.SS3.p3.14.m14.1.1.2.3.cmml" xref="S4.SS3.p3.14.m14.1.1.2.3"><minus id="S4.SS3.p3.14.m14.1.1.2.3.1.cmml" xref="S4.SS3.p3.14.m14.1.1.2.3.1"></minus><ci id="S4.SS3.p3.14.m14.1.1.2.3.2.cmml" xref="S4.SS3.p3.14.m14.1.1.2.3.2">𝑡</ci><cn id="S4.SS3.p3.14.m14.1.1.2.3.3.cmml" type="integer" xref="S4.SS3.p3.14.m14.1.1.2.3.3">1</cn></apply></apply><apply id="S4.SS3.p3.14.m14.1.1.3.cmml" xref="S4.SS3.p3.14.m14.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.14.m14.1.1.3.1.cmml" xref="S4.SS3.p3.14.m14.1.1.3">subscript</csymbol><ci id="S4.SS3.p3.14.m14.1.1.3.2.cmml" xref="S4.SS3.p3.14.m14.1.1.3.2">𝑅</ci><ci id="S4.SS3.p3.14.m14.1.1.3.3.cmml" xref="S4.SS3.p3.14.m14.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.14.m14.1c">r_{t-1}+R_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.14.m14.1d">italic_r start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT + italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. This relabeling process is repeated for each state in the trajectory until we reach the initial state. Through this backward iteration, we effectively update the RTG values based on the learned value function, ensuring that the RTG reflects a more accurate estimate of the expected returns from each state.</p>
</div>
<div class="ltx_para" id="S4.SS3.p4">
<p class="ltx_p" id="S4.SS3.p4.5">The relabeling process described earlier, while effective, can potentially disrupt the inherent consistency between rewards and RTG values in the input sequence of a Decision Transformer (DT). Ideally, the RTG value should always align with the sum of future rewards, adhering to the relationship <math alttext="R_{t}=r_{t}+R_{t+1}" class="ltx_Math" display="inline" id="S4.SS3.p4.1.m1.1"><semantics id="S4.SS3.p4.1.m1.1a"><mrow id="S4.SS3.p4.1.m1.1.1" xref="S4.SS3.p4.1.m1.1.1.cmml"><msub id="S4.SS3.p4.1.m1.1.1.2" xref="S4.SS3.p4.1.m1.1.1.2.cmml"><mi id="S4.SS3.p4.1.m1.1.1.2.2" xref="S4.SS3.p4.1.m1.1.1.2.2.cmml">R</mi><mi id="S4.SS3.p4.1.m1.1.1.2.3" xref="S4.SS3.p4.1.m1.1.1.2.3.cmml">t</mi></msub><mo id="S4.SS3.p4.1.m1.1.1.1" xref="S4.SS3.p4.1.m1.1.1.1.cmml">=</mo><mrow id="S4.SS3.p4.1.m1.1.1.3" xref="S4.SS3.p4.1.m1.1.1.3.cmml"><msub id="S4.SS3.p4.1.m1.1.1.3.2" xref="S4.SS3.p4.1.m1.1.1.3.2.cmml"><mi id="S4.SS3.p4.1.m1.1.1.3.2.2" xref="S4.SS3.p4.1.m1.1.1.3.2.2.cmml">r</mi><mi id="S4.SS3.p4.1.m1.1.1.3.2.3" xref="S4.SS3.p4.1.m1.1.1.3.2.3.cmml">t</mi></msub><mo id="S4.SS3.p4.1.m1.1.1.3.1" xref="S4.SS3.p4.1.m1.1.1.3.1.cmml">+</mo><msub id="S4.SS3.p4.1.m1.1.1.3.3" xref="S4.SS3.p4.1.m1.1.1.3.3.cmml"><mi id="S4.SS3.p4.1.m1.1.1.3.3.2" xref="S4.SS3.p4.1.m1.1.1.3.3.2.cmml">R</mi><mrow id="S4.SS3.p4.1.m1.1.1.3.3.3" xref="S4.SS3.p4.1.m1.1.1.3.3.3.cmml"><mi id="S4.SS3.p4.1.m1.1.1.3.3.3.2" xref="S4.SS3.p4.1.m1.1.1.3.3.3.2.cmml">t</mi><mo id="S4.SS3.p4.1.m1.1.1.3.3.3.1" xref="S4.SS3.p4.1.m1.1.1.3.3.3.1.cmml">+</mo><mn id="S4.SS3.p4.1.m1.1.1.3.3.3.3" xref="S4.SS3.p4.1.m1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.1.m1.1b"><apply id="S4.SS3.p4.1.m1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1"><eq id="S4.SS3.p4.1.m1.1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1.1"></eq><apply id="S4.SS3.p4.1.m1.1.1.2.cmml" xref="S4.SS3.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p4.1.m1.1.1.2.1.cmml" xref="S4.SS3.p4.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS3.p4.1.m1.1.1.2.2.cmml" xref="S4.SS3.p4.1.m1.1.1.2.2">𝑅</ci><ci id="S4.SS3.p4.1.m1.1.1.2.3.cmml" xref="S4.SS3.p4.1.m1.1.1.2.3">𝑡</ci></apply><apply id="S4.SS3.p4.1.m1.1.1.3.cmml" xref="S4.SS3.p4.1.m1.1.1.3"><plus id="S4.SS3.p4.1.m1.1.1.3.1.cmml" xref="S4.SS3.p4.1.m1.1.1.3.1"></plus><apply id="S4.SS3.p4.1.m1.1.1.3.2.cmml" xref="S4.SS3.p4.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS3.p4.1.m1.1.1.3.2.1.cmml" xref="S4.SS3.p4.1.m1.1.1.3.2">subscript</csymbol><ci id="S4.SS3.p4.1.m1.1.1.3.2.2.cmml" xref="S4.SS3.p4.1.m1.1.1.3.2.2">𝑟</ci><ci id="S4.SS3.p4.1.m1.1.1.3.2.3.cmml" xref="S4.SS3.p4.1.m1.1.1.3.2.3">𝑡</ci></apply><apply id="S4.SS3.p4.1.m1.1.1.3.3.cmml" xref="S4.SS3.p4.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS3.p4.1.m1.1.1.3.3.1.cmml" xref="S4.SS3.p4.1.m1.1.1.3.3">subscript</csymbol><ci id="S4.SS3.p4.1.m1.1.1.3.3.2.cmml" xref="S4.SS3.p4.1.m1.1.1.3.3.2">𝑅</ci><apply id="S4.SS3.p4.1.m1.1.1.3.3.3.cmml" xref="S4.SS3.p4.1.m1.1.1.3.3.3"><plus id="S4.SS3.p4.1.m1.1.1.3.3.3.1.cmml" xref="S4.SS3.p4.1.m1.1.1.3.3.3.1"></plus><ci id="S4.SS3.p4.1.m1.1.1.3.3.3.2.cmml" xref="S4.SS3.p4.1.m1.1.1.3.3.3.2">𝑡</ci><cn id="S4.SS3.p4.1.m1.1.1.3.3.3.3.cmml" type="integer" xref="S4.SS3.p4.1.m1.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.1.m1.1c">R_{t}=r_{t}+R_{t+1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.1.m1.1d">italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_R start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math>. However, the relabeling process may inadvertently violate this rule. To preserve this critical consistency within the DT input sequence, we adopt a method of regenerating the RTG values. For an input sequence <math alttext="\{\hat{R}_{t-K+1},\cdots,\hat{R}_{t-1},\hat{R}_{t}\}" class="ltx_Math" display="inline" id="S4.SS3.p4.2.m2.4"><semantics id="S4.SS3.p4.2.m2.4a"><mrow id="S4.SS3.p4.2.m2.4.4.3" xref="S4.SS3.p4.2.m2.4.4.4.cmml"><mo id="S4.SS3.p4.2.m2.4.4.3.4" stretchy="false" xref="S4.SS3.p4.2.m2.4.4.4.cmml">{</mo><msub id="S4.SS3.p4.2.m2.2.2.1.1" xref="S4.SS3.p4.2.m2.2.2.1.1.cmml"><mover accent="true" id="S4.SS3.p4.2.m2.2.2.1.1.2" xref="S4.SS3.p4.2.m2.2.2.1.1.2.cmml"><mi id="S4.SS3.p4.2.m2.2.2.1.1.2.2" xref="S4.SS3.p4.2.m2.2.2.1.1.2.2.cmml">R</mi><mo id="S4.SS3.p4.2.m2.2.2.1.1.2.1" xref="S4.SS3.p4.2.m2.2.2.1.1.2.1.cmml">^</mo></mover><mrow id="S4.SS3.p4.2.m2.2.2.1.1.3" xref="S4.SS3.p4.2.m2.2.2.1.1.3.cmml"><mrow id="S4.SS3.p4.2.m2.2.2.1.1.3.2" xref="S4.SS3.p4.2.m2.2.2.1.1.3.2.cmml"><mi id="S4.SS3.p4.2.m2.2.2.1.1.3.2.2" xref="S4.SS3.p4.2.m2.2.2.1.1.3.2.2.cmml">t</mi><mo id="S4.SS3.p4.2.m2.2.2.1.1.3.2.1" xref="S4.SS3.p4.2.m2.2.2.1.1.3.2.1.cmml">−</mo><mi id="S4.SS3.p4.2.m2.2.2.1.1.3.2.3" xref="S4.SS3.p4.2.m2.2.2.1.1.3.2.3.cmml">K</mi></mrow><mo id="S4.SS3.p4.2.m2.2.2.1.1.3.1" xref="S4.SS3.p4.2.m2.2.2.1.1.3.1.cmml">+</mo><mn id="S4.SS3.p4.2.m2.2.2.1.1.3.3" xref="S4.SS3.p4.2.m2.2.2.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS3.p4.2.m2.4.4.3.5" xref="S4.SS3.p4.2.m2.4.4.4.cmml">,</mo><mi id="S4.SS3.p4.2.m2.1.1" mathvariant="normal" xref="S4.SS3.p4.2.m2.1.1.cmml">⋯</mi><mo id="S4.SS3.p4.2.m2.4.4.3.6" xref="S4.SS3.p4.2.m2.4.4.4.cmml">,</mo><msub id="S4.SS3.p4.2.m2.3.3.2.2" xref="S4.SS3.p4.2.m2.3.3.2.2.cmml"><mover accent="true" id="S4.SS3.p4.2.m2.3.3.2.2.2" xref="S4.SS3.p4.2.m2.3.3.2.2.2.cmml"><mi id="S4.SS3.p4.2.m2.3.3.2.2.2.2" xref="S4.SS3.p4.2.m2.3.3.2.2.2.2.cmml">R</mi><mo id="S4.SS3.p4.2.m2.3.3.2.2.2.1" xref="S4.SS3.p4.2.m2.3.3.2.2.2.1.cmml">^</mo></mover><mrow id="S4.SS3.p4.2.m2.3.3.2.2.3" xref="S4.SS3.p4.2.m2.3.3.2.2.3.cmml"><mi id="S4.SS3.p4.2.m2.3.3.2.2.3.2" xref="S4.SS3.p4.2.m2.3.3.2.2.3.2.cmml">t</mi><mo id="S4.SS3.p4.2.m2.3.3.2.2.3.1" xref="S4.SS3.p4.2.m2.3.3.2.2.3.1.cmml">−</mo><mn id="S4.SS3.p4.2.m2.3.3.2.2.3.3" xref="S4.SS3.p4.2.m2.3.3.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS3.p4.2.m2.4.4.3.7" xref="S4.SS3.p4.2.m2.4.4.4.cmml">,</mo><msub id="S4.SS3.p4.2.m2.4.4.3.3" xref="S4.SS3.p4.2.m2.4.4.3.3.cmml"><mover accent="true" id="S4.SS3.p4.2.m2.4.4.3.3.2" xref="S4.SS3.p4.2.m2.4.4.3.3.2.cmml"><mi id="S4.SS3.p4.2.m2.4.4.3.3.2.2" xref="S4.SS3.p4.2.m2.4.4.3.3.2.2.cmml">R</mi><mo id="S4.SS3.p4.2.m2.4.4.3.3.2.1" xref="S4.SS3.p4.2.m2.4.4.3.3.2.1.cmml">^</mo></mover><mi id="S4.SS3.p4.2.m2.4.4.3.3.3" xref="S4.SS3.p4.2.m2.4.4.3.3.3.cmml">t</mi></msub><mo id="S4.SS3.p4.2.m2.4.4.3.8" stretchy="false" xref="S4.SS3.p4.2.m2.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.2.m2.4b"><set id="S4.SS3.p4.2.m2.4.4.4.cmml" xref="S4.SS3.p4.2.m2.4.4.3"><apply id="S4.SS3.p4.2.m2.2.2.1.1.cmml" xref="S4.SS3.p4.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.2.m2.2.2.1.1.1.cmml" xref="S4.SS3.p4.2.m2.2.2.1.1">subscript</csymbol><apply id="S4.SS3.p4.2.m2.2.2.1.1.2.cmml" xref="S4.SS3.p4.2.m2.2.2.1.1.2"><ci id="S4.SS3.p4.2.m2.2.2.1.1.2.1.cmml" xref="S4.SS3.p4.2.m2.2.2.1.1.2.1">^</ci><ci id="S4.SS3.p4.2.m2.2.2.1.1.2.2.cmml" xref="S4.SS3.p4.2.m2.2.2.1.1.2.2">𝑅</ci></apply><apply id="S4.SS3.p4.2.m2.2.2.1.1.3.cmml" xref="S4.SS3.p4.2.m2.2.2.1.1.3"><plus id="S4.SS3.p4.2.m2.2.2.1.1.3.1.cmml" xref="S4.SS3.p4.2.m2.2.2.1.1.3.1"></plus><apply id="S4.SS3.p4.2.m2.2.2.1.1.3.2.cmml" xref="S4.SS3.p4.2.m2.2.2.1.1.3.2"><minus id="S4.SS3.p4.2.m2.2.2.1.1.3.2.1.cmml" xref="S4.SS3.p4.2.m2.2.2.1.1.3.2.1"></minus><ci id="S4.SS3.p4.2.m2.2.2.1.1.3.2.2.cmml" xref="S4.SS3.p4.2.m2.2.2.1.1.3.2.2">𝑡</ci><ci id="S4.SS3.p4.2.m2.2.2.1.1.3.2.3.cmml" xref="S4.SS3.p4.2.m2.2.2.1.1.3.2.3">𝐾</ci></apply><cn id="S4.SS3.p4.2.m2.2.2.1.1.3.3.cmml" type="integer" xref="S4.SS3.p4.2.m2.2.2.1.1.3.3">1</cn></apply></apply><ci id="S4.SS3.p4.2.m2.1.1.cmml" xref="S4.SS3.p4.2.m2.1.1">⋯</ci><apply id="S4.SS3.p4.2.m2.3.3.2.2.cmml" xref="S4.SS3.p4.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p4.2.m2.3.3.2.2.1.cmml" xref="S4.SS3.p4.2.m2.3.3.2.2">subscript</csymbol><apply id="S4.SS3.p4.2.m2.3.3.2.2.2.cmml" xref="S4.SS3.p4.2.m2.3.3.2.2.2"><ci id="S4.SS3.p4.2.m2.3.3.2.2.2.1.cmml" xref="S4.SS3.p4.2.m2.3.3.2.2.2.1">^</ci><ci id="S4.SS3.p4.2.m2.3.3.2.2.2.2.cmml" xref="S4.SS3.p4.2.m2.3.3.2.2.2.2">𝑅</ci></apply><apply id="S4.SS3.p4.2.m2.3.3.2.2.3.cmml" xref="S4.SS3.p4.2.m2.3.3.2.2.3"><minus id="S4.SS3.p4.2.m2.3.3.2.2.3.1.cmml" xref="S4.SS3.p4.2.m2.3.3.2.2.3.1"></minus><ci id="S4.SS3.p4.2.m2.3.3.2.2.3.2.cmml" xref="S4.SS3.p4.2.m2.3.3.2.2.3.2">𝑡</ci><cn id="S4.SS3.p4.2.m2.3.3.2.2.3.3.cmml" type="integer" xref="S4.SS3.p4.2.m2.3.3.2.2.3.3">1</cn></apply></apply><apply id="S4.SS3.p4.2.m2.4.4.3.3.cmml" xref="S4.SS3.p4.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS3.p4.2.m2.4.4.3.3.1.cmml" xref="S4.SS3.p4.2.m2.4.4.3.3">subscript</csymbol><apply id="S4.SS3.p4.2.m2.4.4.3.3.2.cmml" xref="S4.SS3.p4.2.m2.4.4.3.3.2"><ci id="S4.SS3.p4.2.m2.4.4.3.3.2.1.cmml" xref="S4.SS3.p4.2.m2.4.4.3.3.2.1">^</ci><ci id="S4.SS3.p4.2.m2.4.4.3.3.2.2.cmml" xref="S4.SS3.p4.2.m2.4.4.3.3.2.2">𝑅</ci></apply><ci id="S4.SS3.p4.2.m2.4.4.3.3.3.cmml" xref="S4.SS3.p4.2.m2.4.4.3.3.3">𝑡</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.2.m2.4c">\{\hat{R}_{t-K+1},\cdots,\hat{R}_{t-1},\hat{R}_{t}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.2.m2.4d">{ over^ start_ARG italic_R end_ARG start_POSTSUBSCRIPT italic_t - italic_K + 1 end_POSTSUBSCRIPT , ⋯ , over^ start_ARG italic_R end_ARG start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , over^ start_ARG italic_R end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math>, we start by setting the last RTG <math alttext="\hat{R}_{t}=R_{t}" class="ltx_Math" display="inline" id="S4.SS3.p4.3.m3.1"><semantics id="S4.SS3.p4.3.m3.1a"><mrow id="S4.SS3.p4.3.m3.1.1" xref="S4.SS3.p4.3.m3.1.1.cmml"><msub id="S4.SS3.p4.3.m3.1.1.2" xref="S4.SS3.p4.3.m3.1.1.2.cmml"><mover accent="true" id="S4.SS3.p4.3.m3.1.1.2.2" xref="S4.SS3.p4.3.m3.1.1.2.2.cmml"><mi id="S4.SS3.p4.3.m3.1.1.2.2.2" xref="S4.SS3.p4.3.m3.1.1.2.2.2.cmml">R</mi><mo id="S4.SS3.p4.3.m3.1.1.2.2.1" xref="S4.SS3.p4.3.m3.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.SS3.p4.3.m3.1.1.2.3" xref="S4.SS3.p4.3.m3.1.1.2.3.cmml">t</mi></msub><mo id="S4.SS3.p4.3.m3.1.1.1" xref="S4.SS3.p4.3.m3.1.1.1.cmml">=</mo><msub id="S4.SS3.p4.3.m3.1.1.3" xref="S4.SS3.p4.3.m3.1.1.3.cmml"><mi id="S4.SS3.p4.3.m3.1.1.3.2" xref="S4.SS3.p4.3.m3.1.1.3.2.cmml">R</mi><mi id="S4.SS3.p4.3.m3.1.1.3.3" xref="S4.SS3.p4.3.m3.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.3.m3.1b"><apply id="S4.SS3.p4.3.m3.1.1.cmml" xref="S4.SS3.p4.3.m3.1.1"><eq id="S4.SS3.p4.3.m3.1.1.1.cmml" xref="S4.SS3.p4.3.m3.1.1.1"></eq><apply id="S4.SS3.p4.3.m3.1.1.2.cmml" xref="S4.SS3.p4.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p4.3.m3.1.1.2.1.cmml" xref="S4.SS3.p4.3.m3.1.1.2">subscript</csymbol><apply id="S4.SS3.p4.3.m3.1.1.2.2.cmml" xref="S4.SS3.p4.3.m3.1.1.2.2"><ci id="S4.SS3.p4.3.m3.1.1.2.2.1.cmml" xref="S4.SS3.p4.3.m3.1.1.2.2.1">^</ci><ci id="S4.SS3.p4.3.m3.1.1.2.2.2.cmml" xref="S4.SS3.p4.3.m3.1.1.2.2.2">𝑅</ci></apply><ci id="S4.SS3.p4.3.m3.1.1.2.3.cmml" xref="S4.SS3.p4.3.m3.1.1.2.3">𝑡</ci></apply><apply id="S4.SS3.p4.3.m3.1.1.3.cmml" xref="S4.SS3.p4.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p4.3.m3.1.1.3.1.cmml" xref="S4.SS3.p4.3.m3.1.1.3">subscript</csymbol><ci id="S4.SS3.p4.3.m3.1.1.3.2.cmml" xref="S4.SS3.p4.3.m3.1.1.3.2">𝑅</ci><ci id="S4.SS3.p4.3.m3.1.1.3.3.cmml" xref="S4.SS3.p4.3.m3.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.3.m3.1c">\hat{R}_{t}=R_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.3.m3.1d">over^ start_ARG italic_R end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. Then, we apply the formula <math alttext="\hat{R}_{t^{\prime}}=r^{\prime}_{t}+\hat{R}_{t^{\prime}+1}" class="ltx_Math" display="inline" id="S4.SS3.p4.4.m4.1"><semantics id="S4.SS3.p4.4.m4.1a"><mrow id="S4.SS3.p4.4.m4.1.1" xref="S4.SS3.p4.4.m4.1.1.cmml"><msub id="S4.SS3.p4.4.m4.1.1.2" xref="S4.SS3.p4.4.m4.1.1.2.cmml"><mover accent="true" id="S4.SS3.p4.4.m4.1.1.2.2" xref="S4.SS3.p4.4.m4.1.1.2.2.cmml"><mi id="S4.SS3.p4.4.m4.1.1.2.2.2" xref="S4.SS3.p4.4.m4.1.1.2.2.2.cmml">R</mi><mo id="S4.SS3.p4.4.m4.1.1.2.2.1" xref="S4.SS3.p4.4.m4.1.1.2.2.1.cmml">^</mo></mover><msup id="S4.SS3.p4.4.m4.1.1.2.3" xref="S4.SS3.p4.4.m4.1.1.2.3.cmml"><mi id="S4.SS3.p4.4.m4.1.1.2.3.2" xref="S4.SS3.p4.4.m4.1.1.2.3.2.cmml">t</mi><mo id="S4.SS3.p4.4.m4.1.1.2.3.3" xref="S4.SS3.p4.4.m4.1.1.2.3.3.cmml">′</mo></msup></msub><mo id="S4.SS3.p4.4.m4.1.1.1" xref="S4.SS3.p4.4.m4.1.1.1.cmml">=</mo><mrow id="S4.SS3.p4.4.m4.1.1.3" xref="S4.SS3.p4.4.m4.1.1.3.cmml"><msubsup id="S4.SS3.p4.4.m4.1.1.3.2" xref="S4.SS3.p4.4.m4.1.1.3.2.cmml"><mi id="S4.SS3.p4.4.m4.1.1.3.2.2.2" xref="S4.SS3.p4.4.m4.1.1.3.2.2.2.cmml">r</mi><mi id="S4.SS3.p4.4.m4.1.1.3.2.3" xref="S4.SS3.p4.4.m4.1.1.3.2.3.cmml">t</mi><mo id="S4.SS3.p4.4.m4.1.1.3.2.2.3" xref="S4.SS3.p4.4.m4.1.1.3.2.2.3.cmml">′</mo></msubsup><mo id="S4.SS3.p4.4.m4.1.1.3.1" xref="S4.SS3.p4.4.m4.1.1.3.1.cmml">+</mo><msub id="S4.SS3.p4.4.m4.1.1.3.3" xref="S4.SS3.p4.4.m4.1.1.3.3.cmml"><mover accent="true" id="S4.SS3.p4.4.m4.1.1.3.3.2" xref="S4.SS3.p4.4.m4.1.1.3.3.2.cmml"><mi id="S4.SS3.p4.4.m4.1.1.3.3.2.2" xref="S4.SS3.p4.4.m4.1.1.3.3.2.2.cmml">R</mi><mo id="S4.SS3.p4.4.m4.1.1.3.3.2.1" xref="S4.SS3.p4.4.m4.1.1.3.3.2.1.cmml">^</mo></mover><mrow id="S4.SS3.p4.4.m4.1.1.3.3.3" xref="S4.SS3.p4.4.m4.1.1.3.3.3.cmml"><msup id="S4.SS3.p4.4.m4.1.1.3.3.3.2" xref="S4.SS3.p4.4.m4.1.1.3.3.3.2.cmml"><mi id="S4.SS3.p4.4.m4.1.1.3.3.3.2.2" xref="S4.SS3.p4.4.m4.1.1.3.3.3.2.2.cmml">t</mi><mo id="S4.SS3.p4.4.m4.1.1.3.3.3.2.3" xref="S4.SS3.p4.4.m4.1.1.3.3.3.2.3.cmml">′</mo></msup><mo id="S4.SS3.p4.4.m4.1.1.3.3.3.1" xref="S4.SS3.p4.4.m4.1.1.3.3.3.1.cmml">+</mo><mn id="S4.SS3.p4.4.m4.1.1.3.3.3.3" xref="S4.SS3.p4.4.m4.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.4.m4.1b"><apply id="S4.SS3.p4.4.m4.1.1.cmml" xref="S4.SS3.p4.4.m4.1.1"><eq id="S4.SS3.p4.4.m4.1.1.1.cmml" xref="S4.SS3.p4.4.m4.1.1.1"></eq><apply id="S4.SS3.p4.4.m4.1.1.2.cmml" xref="S4.SS3.p4.4.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p4.4.m4.1.1.2.1.cmml" xref="S4.SS3.p4.4.m4.1.1.2">subscript</csymbol><apply id="S4.SS3.p4.4.m4.1.1.2.2.cmml" xref="S4.SS3.p4.4.m4.1.1.2.2"><ci id="S4.SS3.p4.4.m4.1.1.2.2.1.cmml" xref="S4.SS3.p4.4.m4.1.1.2.2.1">^</ci><ci id="S4.SS3.p4.4.m4.1.1.2.2.2.cmml" xref="S4.SS3.p4.4.m4.1.1.2.2.2">𝑅</ci></apply><apply id="S4.SS3.p4.4.m4.1.1.2.3.cmml" xref="S4.SS3.p4.4.m4.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS3.p4.4.m4.1.1.2.3.1.cmml" xref="S4.SS3.p4.4.m4.1.1.2.3">superscript</csymbol><ci id="S4.SS3.p4.4.m4.1.1.2.3.2.cmml" xref="S4.SS3.p4.4.m4.1.1.2.3.2">𝑡</ci><ci id="S4.SS3.p4.4.m4.1.1.2.3.3.cmml" xref="S4.SS3.p4.4.m4.1.1.2.3.3">′</ci></apply></apply><apply id="S4.SS3.p4.4.m4.1.1.3.cmml" xref="S4.SS3.p4.4.m4.1.1.3"><plus id="S4.SS3.p4.4.m4.1.1.3.1.cmml" xref="S4.SS3.p4.4.m4.1.1.3.1"></plus><apply id="S4.SS3.p4.4.m4.1.1.3.2.cmml" xref="S4.SS3.p4.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS3.p4.4.m4.1.1.3.2.1.cmml" xref="S4.SS3.p4.4.m4.1.1.3.2">subscript</csymbol><apply id="S4.SS3.p4.4.m4.1.1.3.2.2.cmml" xref="S4.SS3.p4.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS3.p4.4.m4.1.1.3.2.2.1.cmml" xref="S4.SS3.p4.4.m4.1.1.3.2">superscript</csymbol><ci id="S4.SS3.p4.4.m4.1.1.3.2.2.2.cmml" xref="S4.SS3.p4.4.m4.1.1.3.2.2.2">𝑟</ci><ci id="S4.SS3.p4.4.m4.1.1.3.2.2.3.cmml" xref="S4.SS3.p4.4.m4.1.1.3.2.2.3">′</ci></apply><ci id="S4.SS3.p4.4.m4.1.1.3.2.3.cmml" xref="S4.SS3.p4.4.m4.1.1.3.2.3">𝑡</ci></apply><apply id="S4.SS3.p4.4.m4.1.1.3.3.cmml" xref="S4.SS3.p4.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS3.p4.4.m4.1.1.3.3.1.cmml" xref="S4.SS3.p4.4.m4.1.1.3.3">subscript</csymbol><apply id="S4.SS3.p4.4.m4.1.1.3.3.2.cmml" xref="S4.SS3.p4.4.m4.1.1.3.3.2"><ci id="S4.SS3.p4.4.m4.1.1.3.3.2.1.cmml" xref="S4.SS3.p4.4.m4.1.1.3.3.2.1">^</ci><ci id="S4.SS3.p4.4.m4.1.1.3.3.2.2.cmml" xref="S4.SS3.p4.4.m4.1.1.3.3.2.2">𝑅</ci></apply><apply id="S4.SS3.p4.4.m4.1.1.3.3.3.cmml" xref="S4.SS3.p4.4.m4.1.1.3.3.3"><plus id="S4.SS3.p4.4.m4.1.1.3.3.3.1.cmml" xref="S4.SS3.p4.4.m4.1.1.3.3.3.1"></plus><apply id="S4.SS3.p4.4.m4.1.1.3.3.3.2.cmml" xref="S4.SS3.p4.4.m4.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S4.SS3.p4.4.m4.1.1.3.3.3.2.1.cmml" xref="S4.SS3.p4.4.m4.1.1.3.3.3.2">superscript</csymbol><ci id="S4.SS3.p4.4.m4.1.1.3.3.3.2.2.cmml" xref="S4.SS3.p4.4.m4.1.1.3.3.3.2.2">𝑡</ci><ci id="S4.SS3.p4.4.m4.1.1.3.3.3.2.3.cmml" xref="S4.SS3.p4.4.m4.1.1.3.3.3.2.3">′</ci></apply><cn id="S4.SS3.p4.4.m4.1.1.3.3.3.3.cmml" type="integer" xref="S4.SS3.p4.4.m4.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.4.m4.1c">\hat{R}_{t^{\prime}}=r^{\prime}_{t}+\hat{R}_{t^{\prime}+1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.4.m4.1d">over^ start_ARG italic_R end_ARG start_POSTSUBSCRIPT italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT = italic_r start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + over^ start_ARG italic_R end_ARG start_POSTSUBSCRIPT italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT + 1 end_POSTSUBSCRIPT</annotation></semantics></math> in a backward sequence until we reach <math alttext="t^{\prime}=t-K+1" class="ltx_Math" display="inline" id="S4.SS3.p4.5.m5.1"><semantics id="S4.SS3.p4.5.m5.1a"><mrow id="S4.SS3.p4.5.m5.1.1" xref="S4.SS3.p4.5.m5.1.1.cmml"><msup id="S4.SS3.p4.5.m5.1.1.2" xref="S4.SS3.p4.5.m5.1.1.2.cmml"><mi id="S4.SS3.p4.5.m5.1.1.2.2" xref="S4.SS3.p4.5.m5.1.1.2.2.cmml">t</mi><mo id="S4.SS3.p4.5.m5.1.1.2.3" xref="S4.SS3.p4.5.m5.1.1.2.3.cmml">′</mo></msup><mo id="S4.SS3.p4.5.m5.1.1.1" xref="S4.SS3.p4.5.m5.1.1.1.cmml">=</mo><mrow id="S4.SS3.p4.5.m5.1.1.3" xref="S4.SS3.p4.5.m5.1.1.3.cmml"><mrow id="S4.SS3.p4.5.m5.1.1.3.2" xref="S4.SS3.p4.5.m5.1.1.3.2.cmml"><mi id="S4.SS3.p4.5.m5.1.1.3.2.2" xref="S4.SS3.p4.5.m5.1.1.3.2.2.cmml">t</mi><mo id="S4.SS3.p4.5.m5.1.1.3.2.1" xref="S4.SS3.p4.5.m5.1.1.3.2.1.cmml">−</mo><mi id="S4.SS3.p4.5.m5.1.1.3.2.3" xref="S4.SS3.p4.5.m5.1.1.3.2.3.cmml">K</mi></mrow><mo id="S4.SS3.p4.5.m5.1.1.3.1" xref="S4.SS3.p4.5.m5.1.1.3.1.cmml">+</mo><mn id="S4.SS3.p4.5.m5.1.1.3.3" xref="S4.SS3.p4.5.m5.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.5.m5.1b"><apply id="S4.SS3.p4.5.m5.1.1.cmml" xref="S4.SS3.p4.5.m5.1.1"><eq id="S4.SS3.p4.5.m5.1.1.1.cmml" xref="S4.SS3.p4.5.m5.1.1.1"></eq><apply id="S4.SS3.p4.5.m5.1.1.2.cmml" xref="S4.SS3.p4.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p4.5.m5.1.1.2.1.cmml" xref="S4.SS3.p4.5.m5.1.1.2">superscript</csymbol><ci id="S4.SS3.p4.5.m5.1.1.2.2.cmml" xref="S4.SS3.p4.5.m5.1.1.2.2">𝑡</ci><ci id="S4.SS3.p4.5.m5.1.1.2.3.cmml" xref="S4.SS3.p4.5.m5.1.1.2.3">′</ci></apply><apply id="S4.SS3.p4.5.m5.1.1.3.cmml" xref="S4.SS3.p4.5.m5.1.1.3"><plus id="S4.SS3.p4.5.m5.1.1.3.1.cmml" xref="S4.SS3.p4.5.m5.1.1.3.1"></plus><apply id="S4.SS3.p4.5.m5.1.1.3.2.cmml" xref="S4.SS3.p4.5.m5.1.1.3.2"><minus id="S4.SS3.p4.5.m5.1.1.3.2.1.cmml" xref="S4.SS3.p4.5.m5.1.1.3.2.1"></minus><ci id="S4.SS3.p4.5.m5.1.1.3.2.2.cmml" xref="S4.SS3.p4.5.m5.1.1.3.2.2">𝑡</ci><ci id="S4.SS3.p4.5.m5.1.1.3.2.3.cmml" xref="S4.SS3.p4.5.m5.1.1.3.2.3">𝐾</ci></apply><cn id="S4.SS3.p4.5.m5.1.1.3.3.cmml" type="integer" xref="S4.SS3.p4.5.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.5.m5.1c">t^{\prime}=t-K+1</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.5.m5.1d">italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_t - italic_K + 1</annotation></semantics></math>. By doing so, we maintain the consistency between rewards and RTGs throughout the sequences. The comprehensive algorithm of RTG relabeling process can be found in <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#algorithm1" title="In 4.3. RTG Relabeling ‣ 4. Methodology ‣ Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_float ltx_algorithm" id="algorithm1">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="algorithm1.15">
<div class="ltx_listingline" id="algorithm1.4.4">
<span class="ltx_text ltx_font_bold" id="algorithm1.4.4.1">input :</span> reward <math alttext="r_{1:T}" class="ltx_Math" display="inline" id="algorithm1.1.1.m1.1"><semantics id="algorithm1.1.1.m1.1a"><msub id="algorithm1.1.1.m1.1.1" xref="algorithm1.1.1.m1.1.1.cmml"><mi id="algorithm1.1.1.m1.1.1.2" xref="algorithm1.1.1.m1.1.1.2.cmml">r</mi><mrow id="algorithm1.1.1.m1.1.1.3" xref="algorithm1.1.1.m1.1.1.3.cmml"><mn id="algorithm1.1.1.m1.1.1.3.2" xref="algorithm1.1.1.m1.1.1.3.2.cmml">1</mn><mo id="algorithm1.1.1.m1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="algorithm1.1.1.m1.1.1.3.1.cmml">:</mo><mi id="algorithm1.1.1.m1.1.1.3.3" xref="algorithm1.1.1.m1.1.1.3.3.cmml">T</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.m1.1b"><apply id="algorithm1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.1.1.m1.1.1.1.cmml" xref="algorithm1.1.1.m1.1.1">subscript</csymbol><ci id="algorithm1.1.1.m1.1.1.2.cmml" xref="algorithm1.1.1.m1.1.1.2">𝑟</ci><apply id="algorithm1.1.1.m1.1.1.3.cmml" xref="algorithm1.1.1.m1.1.1.3"><ci id="algorithm1.1.1.m1.1.1.3.1.cmml" xref="algorithm1.1.1.m1.1.1.3.1">:</ci><cn id="algorithm1.1.1.m1.1.1.3.2.cmml" type="integer" xref="algorithm1.1.1.m1.1.1.3.2">1</cn><ci id="algorithm1.1.1.m1.1.1.3.3.cmml" xref="algorithm1.1.1.m1.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.m1.1c">r_{1:T}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.1.1.m1.1d">italic_r start_POSTSUBSCRIPT 1 : italic_T end_POSTSUBSCRIPT</annotation></semantics></math>, learned value function <math alttext="\hat{V}(s)" class="ltx_Math" display="inline" id="algorithm1.2.2.m2.1"><semantics id="algorithm1.2.2.m2.1a"><mrow id="algorithm1.2.2.m2.1.2" xref="algorithm1.2.2.m2.1.2.cmml"><mover accent="true" id="algorithm1.2.2.m2.1.2.2" xref="algorithm1.2.2.m2.1.2.2.cmml"><mi id="algorithm1.2.2.m2.1.2.2.2" xref="algorithm1.2.2.m2.1.2.2.2.cmml">V</mi><mo id="algorithm1.2.2.m2.1.2.2.1" xref="algorithm1.2.2.m2.1.2.2.1.cmml">^</mo></mover><mo id="algorithm1.2.2.m2.1.2.1" xref="algorithm1.2.2.m2.1.2.1.cmml">⁢</mo><mrow id="algorithm1.2.2.m2.1.2.3.2" xref="algorithm1.2.2.m2.1.2.cmml"><mo id="algorithm1.2.2.m2.1.2.3.2.1" stretchy="false" xref="algorithm1.2.2.m2.1.2.cmml">(</mo><mi id="algorithm1.2.2.m2.1.1" xref="algorithm1.2.2.m2.1.1.cmml">s</mi><mo id="algorithm1.2.2.m2.1.2.3.2.2" stretchy="false" xref="algorithm1.2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.m2.1b"><apply id="algorithm1.2.2.m2.1.2.cmml" xref="algorithm1.2.2.m2.1.2"><times id="algorithm1.2.2.m2.1.2.1.cmml" xref="algorithm1.2.2.m2.1.2.1"></times><apply id="algorithm1.2.2.m2.1.2.2.cmml" xref="algorithm1.2.2.m2.1.2.2"><ci id="algorithm1.2.2.m2.1.2.2.1.cmml" xref="algorithm1.2.2.m2.1.2.2.1">^</ci><ci id="algorithm1.2.2.m2.1.2.2.2.cmml" xref="algorithm1.2.2.m2.1.2.2.2">𝑉</ci></apply><ci id="algorithm1.2.2.m2.1.1.cmml" xref="algorithm1.2.2.m2.1.1">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.m2.1c">\hat{V}(s)</annotation><annotation encoding="application/x-llamapun" id="algorithm1.2.2.m2.1d">over^ start_ARG italic_V end_ARG ( italic_s )</annotation></semantics></math>, Trajectory length <math alttext="T" class="ltx_Math" display="inline" id="algorithm1.3.3.m3.1"><semantics id="algorithm1.3.3.m3.1a"><mi id="algorithm1.3.3.m3.1.1" xref="algorithm1.3.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.m3.1b"><ci id="algorithm1.3.3.m3.1.1.cmml" xref="algorithm1.3.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.m3.1c">T</annotation><annotation encoding="application/x-llamapun" id="algorithm1.3.3.m3.1d">italic_T</annotation></semantics></math>, context length <math alttext="K" class="ltx_Math" display="inline" id="algorithm1.4.4.m4.1"><semantics id="algorithm1.4.4.m4.1a"><mi id="algorithm1.4.4.m4.1.1" xref="algorithm1.4.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.m4.1b"><ci id="algorithm1.4.4.m4.1.1.cmml" xref="algorithm1.4.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="algorithm1.4.4.m4.1d">italic_K</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.5.5">
<span class="ltx_text ltx_font_bold" id="algorithm1.5.5.1">output :</span> RTG <math alttext="\hat{R}_{1:T}" class="ltx_Math" display="inline" id="algorithm1.5.5.m1.1"><semantics id="algorithm1.5.5.m1.1a"><msub id="algorithm1.5.5.m1.1.1" xref="algorithm1.5.5.m1.1.1.cmml"><mover accent="true" id="algorithm1.5.5.m1.1.1.2" xref="algorithm1.5.5.m1.1.1.2.cmml"><mi id="algorithm1.5.5.m1.1.1.2.2" xref="algorithm1.5.5.m1.1.1.2.2.cmml">R</mi><mo id="algorithm1.5.5.m1.1.1.2.1" xref="algorithm1.5.5.m1.1.1.2.1.cmml">^</mo></mover><mrow id="algorithm1.5.5.m1.1.1.3" xref="algorithm1.5.5.m1.1.1.3.cmml"><mn id="algorithm1.5.5.m1.1.1.3.2" xref="algorithm1.5.5.m1.1.1.3.2.cmml">1</mn><mo id="algorithm1.5.5.m1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="algorithm1.5.5.m1.1.1.3.1.cmml">:</mo><mi id="algorithm1.5.5.m1.1.1.3.3" xref="algorithm1.5.5.m1.1.1.3.3.cmml">T</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.m1.1b"><apply id="algorithm1.5.5.m1.1.1.cmml" xref="algorithm1.5.5.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.5.5.m1.1.1.1.cmml" xref="algorithm1.5.5.m1.1.1">subscript</csymbol><apply id="algorithm1.5.5.m1.1.1.2.cmml" xref="algorithm1.5.5.m1.1.1.2"><ci id="algorithm1.5.5.m1.1.1.2.1.cmml" xref="algorithm1.5.5.m1.1.1.2.1">^</ci><ci id="algorithm1.5.5.m1.1.1.2.2.cmml" xref="algorithm1.5.5.m1.1.1.2.2">𝑅</ci></apply><apply id="algorithm1.5.5.m1.1.1.3.cmml" xref="algorithm1.5.5.m1.1.1.3"><ci id="algorithm1.5.5.m1.1.1.3.1.cmml" xref="algorithm1.5.5.m1.1.1.3.1">:</ci><cn id="algorithm1.5.5.m1.1.1.3.2.cmml" type="integer" xref="algorithm1.5.5.m1.1.1.3.2">1</cn><ci id="algorithm1.5.5.m1.1.1.3.3.cmml" xref="algorithm1.5.5.m1.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.m1.1c">\hat{R}_{1:T}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.5.5.m1.1d">over^ start_ARG italic_R end_ARG start_POSTSUBSCRIPT 1 : italic_T end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.6.6">
<span class="ltx_text ltx_font_typewriter" id="algorithm1.6.6.2">// </span><span class="ltx_text ltx_font_typewriter" id="algorithm1.6.6.1">Step 1. relabel RTG <math alttext="R_{T}" class="ltx_Math" display="inline" id="algorithm1.6.6.1.m1.1"><semantics id="algorithm1.6.6.1.m1.1a"><msub id="algorithm1.6.6.1.m1.1.1" xref="algorithm1.6.6.1.m1.1.1.cmml"><mi id="algorithm1.6.6.1.m1.1.1.2" xref="algorithm1.6.6.1.m1.1.1.2.cmml">R</mi><mi id="algorithm1.6.6.1.m1.1.1.3" xref="algorithm1.6.6.1.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.1.m1.1b"><apply id="algorithm1.6.6.1.m1.1.1.cmml" xref="algorithm1.6.6.1.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.6.6.1.m1.1.1.1.cmml" xref="algorithm1.6.6.1.m1.1.1">subscript</csymbol><ci id="algorithm1.6.6.1.m1.1.1.2.cmml" xref="algorithm1.6.6.1.m1.1.1.2">𝑅</ci><ci id="algorithm1.6.6.1.m1.1.1.3.cmml" xref="algorithm1.6.6.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.1.m1.1c">R_{T}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.6.6.1.m1.1d">italic_R start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math> </span>
</div>
<div class="ltx_listingline" id="algorithm1.7.7">
<span class="ltx_tag ltx_tag_listingline">1</span>
<math alttext="R_{T}\leftarrow 0" class="ltx_Math" display="inline" id="algorithm1.7.7.m1.1"><semantics id="algorithm1.7.7.m1.1a"><mrow id="algorithm1.7.7.m1.1.1" xref="algorithm1.7.7.m1.1.1.cmml"><msub id="algorithm1.7.7.m1.1.1.2" xref="algorithm1.7.7.m1.1.1.2.cmml"><mi id="algorithm1.7.7.m1.1.1.2.2" xref="algorithm1.7.7.m1.1.1.2.2.cmml">R</mi><mi id="algorithm1.7.7.m1.1.1.2.3" xref="algorithm1.7.7.m1.1.1.2.3.cmml">T</mi></msub><mo id="algorithm1.7.7.m1.1.1.1" stretchy="false" xref="algorithm1.7.7.m1.1.1.1.cmml">←</mo><mn id="algorithm1.7.7.m1.1.1.3" xref="algorithm1.7.7.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.m1.1b"><apply id="algorithm1.7.7.m1.1.1.cmml" xref="algorithm1.7.7.m1.1.1"><ci id="algorithm1.7.7.m1.1.1.1.cmml" xref="algorithm1.7.7.m1.1.1.1">←</ci><apply id="algorithm1.7.7.m1.1.1.2.cmml" xref="algorithm1.7.7.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.7.7.m1.1.1.2.1.cmml" xref="algorithm1.7.7.m1.1.1.2">subscript</csymbol><ci id="algorithm1.7.7.m1.1.1.2.2.cmml" xref="algorithm1.7.7.m1.1.1.2.2">𝑅</ci><ci id="algorithm1.7.7.m1.1.1.2.3.cmml" xref="algorithm1.7.7.m1.1.1.2.3">𝑇</ci></apply><cn id="algorithm1.7.7.m1.1.1.3.cmml" type="integer" xref="algorithm1.7.7.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.m1.1c">R_{T}\leftarrow 0</annotation><annotation encoding="application/x-llamapun" id="algorithm1.7.7.m1.1d">italic_R start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ← 0</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="algorithm1.8.8">
<span class="ltx_tag ltx_tag_listingline">2</span>
<math alttext="i\leftarrow T" class="ltx_Math" display="inline" id="algorithm1.8.8.m1.1"><semantics id="algorithm1.8.8.m1.1a"><mrow id="algorithm1.8.8.m1.1.1" xref="algorithm1.8.8.m1.1.1.cmml"><mi id="algorithm1.8.8.m1.1.1.2" xref="algorithm1.8.8.m1.1.1.2.cmml">i</mi><mo id="algorithm1.8.8.m1.1.1.1" stretchy="false" xref="algorithm1.8.8.m1.1.1.1.cmml">←</mo><mi id="algorithm1.8.8.m1.1.1.3" xref="algorithm1.8.8.m1.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.8.8.m1.1b"><apply id="algorithm1.8.8.m1.1.1.cmml" xref="algorithm1.8.8.m1.1.1"><ci id="algorithm1.8.8.m1.1.1.1.cmml" xref="algorithm1.8.8.m1.1.1.1">←</ci><ci id="algorithm1.8.8.m1.1.1.2.cmml" xref="algorithm1.8.8.m1.1.1.2">𝑖</ci><ci id="algorithm1.8.8.m1.1.1.3.cmml" xref="algorithm1.8.8.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.8.m1.1c">i\leftarrow T</annotation><annotation encoding="application/x-llamapun" id="algorithm1.8.8.m1.1d">italic_i ← italic_T</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="algorithm1.15.16">
<span class="ltx_tag ltx_tag_listingline">3</span>
<span class="ltx_text ltx_font_bold" id="algorithm1.15.16.1">while</span> <em class="ltx_emph ltx_font_italic" id="algorithm1.15.16.2">i ¿ 0</em> <span class="ltx_text ltx_font_bold" id="algorithm1.15.16.3">do</span>
</div>
<div class="ltx_listingline" id="algorithm1.9.9">
<span class="ltx_tag ltx_tag_listingline">4</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="R_{t-1}\leftarrow r_{i}+\max(R_{t},\hat{V}(s_{i})" class="ltx_math_unparsed" display="inline" id="algorithm1.9.9.m1.1"><semantics id="algorithm1.9.9.m1.1a"><mrow id="algorithm1.9.9.m1.1b"><msub id="algorithm1.9.9.m1.1.1"><mi id="algorithm1.9.9.m1.1.1.2">R</mi><mrow id="algorithm1.9.9.m1.1.1.3"><mi id="algorithm1.9.9.m1.1.1.3.2">t</mi><mo id="algorithm1.9.9.m1.1.1.3.1">−</mo><mn id="algorithm1.9.9.m1.1.1.3.3">1</mn></mrow></msub><mo id="algorithm1.9.9.m1.1.2" stretchy="false">←</mo><msub id="algorithm1.9.9.m1.1.3"><mi id="algorithm1.9.9.m1.1.3.2">r</mi><mi id="algorithm1.9.9.m1.1.3.3">i</mi></msub><mo id="algorithm1.9.9.m1.1.4">+</mo><mi id="algorithm1.9.9.m1.1.5">max</mi><mrow id="algorithm1.9.9.m1.1.6"><mo id="algorithm1.9.9.m1.1.6.1" stretchy="false">(</mo><msub id="algorithm1.9.9.m1.1.6.2"><mi id="algorithm1.9.9.m1.1.6.2.2">R</mi><mi id="algorithm1.9.9.m1.1.6.2.3">t</mi></msub><mo id="algorithm1.9.9.m1.1.6.3">,</mo><mover accent="true" id="algorithm1.9.9.m1.1.6.4"><mi id="algorithm1.9.9.m1.1.6.4.2">V</mi><mo id="algorithm1.9.9.m1.1.6.4.1">^</mo></mover><mrow id="algorithm1.9.9.m1.1.6.5"><mo id="algorithm1.9.9.m1.1.6.5.1" stretchy="false">(</mo><msub id="algorithm1.9.9.m1.1.6.5.2"><mi id="algorithm1.9.9.m1.1.6.5.2.2">s</mi><mi id="algorithm1.9.9.m1.1.6.5.2.3">i</mi></msub><mo id="algorithm1.9.9.m1.1.6.5.3" stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="algorithm1.9.9.m1.1c">R_{t-1}\leftarrow r_{i}+\max(R_{t},\hat{V}(s_{i})</annotation><annotation encoding="application/x-llamapun" id="algorithm1.9.9.m1.1d">italic_R start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ← italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + roman_max ( italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , over^ start_ARG italic_V end_ARG ( italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="algorithm1.10.10">
<span class="ltx_tag ltx_tag_listingline">5</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="i\leftarrow i-1" class="ltx_Math" display="inline" id="algorithm1.10.10.m1.1"><semantics id="algorithm1.10.10.m1.1a"><mrow id="algorithm1.10.10.m1.1.1" xref="algorithm1.10.10.m1.1.1.cmml"><mi id="algorithm1.10.10.m1.1.1.2" xref="algorithm1.10.10.m1.1.1.2.cmml">i</mi><mo id="algorithm1.10.10.m1.1.1.1" stretchy="false" xref="algorithm1.10.10.m1.1.1.1.cmml">←</mo><mrow id="algorithm1.10.10.m1.1.1.3" xref="algorithm1.10.10.m1.1.1.3.cmml"><mi id="algorithm1.10.10.m1.1.1.3.2" xref="algorithm1.10.10.m1.1.1.3.2.cmml">i</mi><mo id="algorithm1.10.10.m1.1.1.3.1" xref="algorithm1.10.10.m1.1.1.3.1.cmml">−</mo><mn id="algorithm1.10.10.m1.1.1.3.3" xref="algorithm1.10.10.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.m1.1b"><apply id="algorithm1.10.10.m1.1.1.cmml" xref="algorithm1.10.10.m1.1.1"><ci id="algorithm1.10.10.m1.1.1.1.cmml" xref="algorithm1.10.10.m1.1.1.1">←</ci><ci id="algorithm1.10.10.m1.1.1.2.cmml" xref="algorithm1.10.10.m1.1.1.2">𝑖</ci><apply id="algorithm1.10.10.m1.1.1.3.cmml" xref="algorithm1.10.10.m1.1.1.3"><minus id="algorithm1.10.10.m1.1.1.3.1.cmml" xref="algorithm1.10.10.m1.1.1.3.1"></minus><ci id="algorithm1.10.10.m1.1.1.3.2.cmml" xref="algorithm1.10.10.m1.1.1.3.2">𝑖</ci><cn id="algorithm1.10.10.m1.1.1.3.3.cmml" type="integer" xref="algorithm1.10.10.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.m1.1c">i\leftarrow i-1</annotation><annotation encoding="application/x-llamapun" id="algorithm1.10.10.m1.1d">italic_i ← italic_i - 1</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="algorithm1.15.17">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm1.15.18">
<span class="ltx_tag ltx_tag_listingline">7</span> end while
</div>
<div class="ltx_listingline" id="algorithm1.11.11">
<span class="ltx_text ltx_font_typewriter" id="algorithm1.11.11.2">// </span><span class="ltx_text ltx_font_typewriter" id="algorithm1.11.11.1">Step 2. relabel RTG <math alttext="\hat{R}_{T}" class="ltx_Math" display="inline" id="algorithm1.11.11.1.m1.1"><semantics id="algorithm1.11.11.1.m1.1a"><msub id="algorithm1.11.11.1.m1.1.1" xref="algorithm1.11.11.1.m1.1.1.cmml"><mover accent="true" id="algorithm1.11.11.1.m1.1.1.2" xref="algorithm1.11.11.1.m1.1.1.2.cmml"><mi id="algorithm1.11.11.1.m1.1.1.2.2" xref="algorithm1.11.11.1.m1.1.1.2.2.cmml">R</mi><mo id="algorithm1.11.11.1.m1.1.1.2.1" xref="algorithm1.11.11.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="algorithm1.11.11.1.m1.1.1.3" xref="algorithm1.11.11.1.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.11.11.1.m1.1b"><apply id="algorithm1.11.11.1.m1.1.1.cmml" xref="algorithm1.11.11.1.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.11.11.1.m1.1.1.1.cmml" xref="algorithm1.11.11.1.m1.1.1">subscript</csymbol><apply id="algorithm1.11.11.1.m1.1.1.2.cmml" xref="algorithm1.11.11.1.m1.1.1.2"><ci id="algorithm1.11.11.1.m1.1.1.2.1.cmml" xref="algorithm1.11.11.1.m1.1.1.2.1">^</ci><ci id="algorithm1.11.11.1.m1.1.1.2.2.cmml" xref="algorithm1.11.11.1.m1.1.1.2.2">𝑅</ci></apply><ci id="algorithm1.11.11.1.m1.1.1.3.cmml" xref="algorithm1.11.11.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.11.1.m1.1c">\hat{R}_{T}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.11.11.1.m1.1d">over^ start_ARG italic_R end_ARG start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math> by considering the inconsistency </span>
</div>
<div class="ltx_listingline" id="algorithm1.12.12">
<span class="ltx_tag ltx_tag_listingline">8</span>
<math alttext="\hat{R}_{T}\leftarrow R_{t}" class="ltx_Math" display="inline" id="algorithm1.12.12.m1.1"><semantics id="algorithm1.12.12.m1.1a"><mrow id="algorithm1.12.12.m1.1.1" xref="algorithm1.12.12.m1.1.1.cmml"><msub id="algorithm1.12.12.m1.1.1.2" xref="algorithm1.12.12.m1.1.1.2.cmml"><mover accent="true" id="algorithm1.12.12.m1.1.1.2.2" xref="algorithm1.12.12.m1.1.1.2.2.cmml"><mi id="algorithm1.12.12.m1.1.1.2.2.2" xref="algorithm1.12.12.m1.1.1.2.2.2.cmml">R</mi><mo id="algorithm1.12.12.m1.1.1.2.2.1" xref="algorithm1.12.12.m1.1.1.2.2.1.cmml">^</mo></mover><mi id="algorithm1.12.12.m1.1.1.2.3" xref="algorithm1.12.12.m1.1.1.2.3.cmml">T</mi></msub><mo id="algorithm1.12.12.m1.1.1.1" stretchy="false" xref="algorithm1.12.12.m1.1.1.1.cmml">←</mo><msub id="algorithm1.12.12.m1.1.1.3" xref="algorithm1.12.12.m1.1.1.3.cmml"><mi id="algorithm1.12.12.m1.1.1.3.2" xref="algorithm1.12.12.m1.1.1.3.2.cmml">R</mi><mi id="algorithm1.12.12.m1.1.1.3.3" xref="algorithm1.12.12.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.12.12.m1.1b"><apply id="algorithm1.12.12.m1.1.1.cmml" xref="algorithm1.12.12.m1.1.1"><ci id="algorithm1.12.12.m1.1.1.1.cmml" xref="algorithm1.12.12.m1.1.1.1">←</ci><apply id="algorithm1.12.12.m1.1.1.2.cmml" xref="algorithm1.12.12.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.1.1.2.1.cmml" xref="algorithm1.12.12.m1.1.1.2">subscript</csymbol><apply id="algorithm1.12.12.m1.1.1.2.2.cmml" xref="algorithm1.12.12.m1.1.1.2.2"><ci id="algorithm1.12.12.m1.1.1.2.2.1.cmml" xref="algorithm1.12.12.m1.1.1.2.2.1">^</ci><ci id="algorithm1.12.12.m1.1.1.2.2.2.cmml" xref="algorithm1.12.12.m1.1.1.2.2.2">𝑅</ci></apply><ci id="algorithm1.12.12.m1.1.1.2.3.cmml" xref="algorithm1.12.12.m1.1.1.2.3">𝑇</ci></apply><apply id="algorithm1.12.12.m1.1.1.3.cmml" xref="algorithm1.12.12.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.1.1.3.1.cmml" xref="algorithm1.12.12.m1.1.1.3">subscript</csymbol><ci id="algorithm1.12.12.m1.1.1.3.2.cmml" xref="algorithm1.12.12.m1.1.1.3.2">𝑅</ci><ci id="algorithm1.12.12.m1.1.1.3.3.cmml" xref="algorithm1.12.12.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.12.m1.1c">\hat{R}_{T}\leftarrow R_{t}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.12.12.m1.1d">over^ start_ARG italic_R end_ARG start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ← italic_R start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="algorithm1.13.13">
<span class="ltx_tag ltx_tag_listingline">9</span>
<math alttext="i\leftarrow T" class="ltx_Math" display="inline" id="algorithm1.13.13.m1.1"><semantics id="algorithm1.13.13.m1.1a"><mrow id="algorithm1.13.13.m1.1.1" xref="algorithm1.13.13.m1.1.1.cmml"><mi id="algorithm1.13.13.m1.1.1.2" xref="algorithm1.13.13.m1.1.1.2.cmml">i</mi><mo id="algorithm1.13.13.m1.1.1.1" stretchy="false" xref="algorithm1.13.13.m1.1.1.1.cmml">←</mo><mi id="algorithm1.13.13.m1.1.1.3" xref="algorithm1.13.13.m1.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.13.13.m1.1b"><apply id="algorithm1.13.13.m1.1.1.cmml" xref="algorithm1.13.13.m1.1.1"><ci id="algorithm1.13.13.m1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1">←</ci><ci id="algorithm1.13.13.m1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1.2">𝑖</ci><ci id="algorithm1.13.13.m1.1.1.3.cmml" xref="algorithm1.13.13.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.13.m1.1c">i\leftarrow T</annotation><annotation encoding="application/x-llamapun" id="algorithm1.13.13.m1.1d">italic_i ← italic_T</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="algorithm1.15.19">
<span class="ltx_tag ltx_tag_listingline">10</span>
<span class="ltx_text ltx_font_bold" id="algorithm1.15.19.1">while</span> <em class="ltx_emph ltx_font_italic" id="algorithm1.15.19.2">i ¿ 0</em> <span class="ltx_text ltx_font_bold" id="algorithm1.15.19.3">do</span>
</div>
<div class="ltx_listingline" id="algorithm1.14.14">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="\hat{R}_{t}\leftarrow r_{i}+\hat{R}_{i+1}" class="ltx_Math" display="inline" id="algorithm1.14.14.m1.1"><semantics id="algorithm1.14.14.m1.1a"><mrow id="algorithm1.14.14.m1.1.1" xref="algorithm1.14.14.m1.1.1.cmml"><msub id="algorithm1.14.14.m1.1.1.2" xref="algorithm1.14.14.m1.1.1.2.cmml"><mover accent="true" id="algorithm1.14.14.m1.1.1.2.2" xref="algorithm1.14.14.m1.1.1.2.2.cmml"><mi id="algorithm1.14.14.m1.1.1.2.2.2" xref="algorithm1.14.14.m1.1.1.2.2.2.cmml">R</mi><mo id="algorithm1.14.14.m1.1.1.2.2.1" xref="algorithm1.14.14.m1.1.1.2.2.1.cmml">^</mo></mover><mi id="algorithm1.14.14.m1.1.1.2.3" xref="algorithm1.14.14.m1.1.1.2.3.cmml">t</mi></msub><mo id="algorithm1.14.14.m1.1.1.1" stretchy="false" xref="algorithm1.14.14.m1.1.1.1.cmml">←</mo><mrow id="algorithm1.14.14.m1.1.1.3" xref="algorithm1.14.14.m1.1.1.3.cmml"><msub id="algorithm1.14.14.m1.1.1.3.2" xref="algorithm1.14.14.m1.1.1.3.2.cmml"><mi id="algorithm1.14.14.m1.1.1.3.2.2" xref="algorithm1.14.14.m1.1.1.3.2.2.cmml">r</mi><mi id="algorithm1.14.14.m1.1.1.3.2.3" xref="algorithm1.14.14.m1.1.1.3.2.3.cmml">i</mi></msub><mo id="algorithm1.14.14.m1.1.1.3.1" xref="algorithm1.14.14.m1.1.1.3.1.cmml">+</mo><msub id="algorithm1.14.14.m1.1.1.3.3" xref="algorithm1.14.14.m1.1.1.3.3.cmml"><mover accent="true" id="algorithm1.14.14.m1.1.1.3.3.2" xref="algorithm1.14.14.m1.1.1.3.3.2.cmml"><mi id="algorithm1.14.14.m1.1.1.3.3.2.2" xref="algorithm1.14.14.m1.1.1.3.3.2.2.cmml">R</mi><mo id="algorithm1.14.14.m1.1.1.3.3.2.1" xref="algorithm1.14.14.m1.1.1.3.3.2.1.cmml">^</mo></mover><mrow id="algorithm1.14.14.m1.1.1.3.3.3" xref="algorithm1.14.14.m1.1.1.3.3.3.cmml"><mi id="algorithm1.14.14.m1.1.1.3.3.3.2" xref="algorithm1.14.14.m1.1.1.3.3.3.2.cmml">i</mi><mo id="algorithm1.14.14.m1.1.1.3.3.3.1" xref="algorithm1.14.14.m1.1.1.3.3.3.1.cmml">+</mo><mn id="algorithm1.14.14.m1.1.1.3.3.3.3" xref="algorithm1.14.14.m1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.14.14.m1.1b"><apply id="algorithm1.14.14.m1.1.1.cmml" xref="algorithm1.14.14.m1.1.1"><ci id="algorithm1.14.14.m1.1.1.1.cmml" xref="algorithm1.14.14.m1.1.1.1">←</ci><apply id="algorithm1.14.14.m1.1.1.2.cmml" xref="algorithm1.14.14.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.14.14.m1.1.1.2.1.cmml" xref="algorithm1.14.14.m1.1.1.2">subscript</csymbol><apply id="algorithm1.14.14.m1.1.1.2.2.cmml" xref="algorithm1.14.14.m1.1.1.2.2"><ci id="algorithm1.14.14.m1.1.1.2.2.1.cmml" xref="algorithm1.14.14.m1.1.1.2.2.1">^</ci><ci id="algorithm1.14.14.m1.1.1.2.2.2.cmml" xref="algorithm1.14.14.m1.1.1.2.2.2">𝑅</ci></apply><ci id="algorithm1.14.14.m1.1.1.2.3.cmml" xref="algorithm1.14.14.m1.1.1.2.3">𝑡</ci></apply><apply id="algorithm1.14.14.m1.1.1.3.cmml" xref="algorithm1.14.14.m1.1.1.3"><plus id="algorithm1.14.14.m1.1.1.3.1.cmml" xref="algorithm1.14.14.m1.1.1.3.1"></plus><apply id="algorithm1.14.14.m1.1.1.3.2.cmml" xref="algorithm1.14.14.m1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.14.14.m1.1.1.3.2.1.cmml" xref="algorithm1.14.14.m1.1.1.3.2">subscript</csymbol><ci id="algorithm1.14.14.m1.1.1.3.2.2.cmml" xref="algorithm1.14.14.m1.1.1.3.2.2">𝑟</ci><ci id="algorithm1.14.14.m1.1.1.3.2.3.cmml" xref="algorithm1.14.14.m1.1.1.3.2.3">𝑖</ci></apply><apply id="algorithm1.14.14.m1.1.1.3.3.cmml" xref="algorithm1.14.14.m1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm1.14.14.m1.1.1.3.3.1.cmml" xref="algorithm1.14.14.m1.1.1.3.3">subscript</csymbol><apply id="algorithm1.14.14.m1.1.1.3.3.2.cmml" xref="algorithm1.14.14.m1.1.1.3.3.2"><ci id="algorithm1.14.14.m1.1.1.3.3.2.1.cmml" xref="algorithm1.14.14.m1.1.1.3.3.2.1">^</ci><ci id="algorithm1.14.14.m1.1.1.3.3.2.2.cmml" xref="algorithm1.14.14.m1.1.1.3.3.2.2">𝑅</ci></apply><apply id="algorithm1.14.14.m1.1.1.3.3.3.cmml" xref="algorithm1.14.14.m1.1.1.3.3.3"><plus id="algorithm1.14.14.m1.1.1.3.3.3.1.cmml" xref="algorithm1.14.14.m1.1.1.3.3.3.1"></plus><ci id="algorithm1.14.14.m1.1.1.3.3.3.2.cmml" xref="algorithm1.14.14.m1.1.1.3.3.3.2">𝑖</ci><cn id="algorithm1.14.14.m1.1.1.3.3.3.3.cmml" type="integer" xref="algorithm1.14.14.m1.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.14.14.m1.1c">\hat{R}_{t}\leftarrow r_{i}+\hat{R}_{i+1}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.14.14.m1.1d">over^ start_ARG italic_R end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ← italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + over^ start_ARG italic_R end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="algorithm1.15.15">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="i\leftarrow i-1" class="ltx_Math" display="inline" id="algorithm1.15.15.m1.1"><semantics id="algorithm1.15.15.m1.1a"><mrow id="algorithm1.15.15.m1.1.1" xref="algorithm1.15.15.m1.1.1.cmml"><mi id="algorithm1.15.15.m1.1.1.2" xref="algorithm1.15.15.m1.1.1.2.cmml">i</mi><mo id="algorithm1.15.15.m1.1.1.1" stretchy="false" xref="algorithm1.15.15.m1.1.1.1.cmml">←</mo><mrow id="algorithm1.15.15.m1.1.1.3" xref="algorithm1.15.15.m1.1.1.3.cmml"><mi id="algorithm1.15.15.m1.1.1.3.2" xref="algorithm1.15.15.m1.1.1.3.2.cmml">i</mi><mo id="algorithm1.15.15.m1.1.1.3.1" xref="algorithm1.15.15.m1.1.1.3.1.cmml">−</mo><mn id="algorithm1.15.15.m1.1.1.3.3" xref="algorithm1.15.15.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.15.15.m1.1b"><apply id="algorithm1.15.15.m1.1.1.cmml" xref="algorithm1.15.15.m1.1.1"><ci id="algorithm1.15.15.m1.1.1.1.cmml" xref="algorithm1.15.15.m1.1.1.1">←</ci><ci id="algorithm1.15.15.m1.1.1.2.cmml" xref="algorithm1.15.15.m1.1.1.2">𝑖</ci><apply id="algorithm1.15.15.m1.1.1.3.cmml" xref="algorithm1.15.15.m1.1.1.3"><minus id="algorithm1.15.15.m1.1.1.3.1.cmml" xref="algorithm1.15.15.m1.1.1.3.1"></minus><ci id="algorithm1.15.15.m1.1.1.3.2.cmml" xref="algorithm1.15.15.m1.1.1.3.2">𝑖</ci><cn id="algorithm1.15.15.m1.1.1.3.3.cmml" type="integer" xref="algorithm1.15.15.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.15.15.m1.1c">i\leftarrow i-1</annotation><annotation encoding="application/x-llamapun" id="algorithm1.15.15.m1.1d">italic_i ← italic_i - 1</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="algorithm1.15.20">
<span class="ltx_tag ltx_tag_listingline">13</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm1.15.21">
<span class="ltx_tag ltx_tag_listingline">14</span> end while
</div>
<div class="ltx_listingline" id="algorithm1.15.22">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="algorithm1.17.1.1">Algorithm 1</span> </span>RTG Relabeling without inconsistency</figcaption>
</figure>
<div class="ltx_para" id="S4.SS3.p5">
<p class="ltx_p" id="S4.SS3.p5.1">A potential concern with our relabeling strategy is validating that the learned value function indeed represents the lower bound of the true value function, meaning it should be as close as possible to the optimal value function. To address this, we utilize the CQL <cite class="ltx_cite ltx_citemacro_citep">(Kumar et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib17" title="">2020</a>)</cite> to learn the Q-value which is defined as,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S6.EGx10">
<tbody id="S4.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\hat{Q}\leftarrow" class="ltx_Math" display="inline" id="S4.Ex4.m1.1"><semantics id="S4.Ex4.m1.1a"><mrow id="S4.Ex4.m1.1.1" xref="S4.Ex4.m1.1.1.cmml"><mover accent="true" id="S4.Ex4.m1.1.1.2" xref="S4.Ex4.m1.1.1.2.cmml"><mi id="S4.Ex4.m1.1.1.2.2" xref="S4.Ex4.m1.1.1.2.2.cmml">Q</mi><mo id="S4.Ex4.m1.1.1.2.1" xref="S4.Ex4.m1.1.1.2.1.cmml">^</mo></mover><mo id="S4.Ex4.m1.1.1.1" stretchy="false" xref="S4.Ex4.m1.1.1.1.cmml">←</mo><mi id="S4.Ex4.m1.1.1.3" xref="S4.Ex4.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex4.m1.1b"><apply id="S4.Ex4.m1.1.1.cmml" xref="S4.Ex4.m1.1.1"><ci id="S4.Ex4.m1.1.1.1.cmml" xref="S4.Ex4.m1.1.1.1">←</ci><apply id="S4.Ex4.m1.1.1.2.cmml" xref="S4.Ex4.m1.1.1.2"><ci id="S4.Ex4.m1.1.1.2.1.cmml" xref="S4.Ex4.m1.1.1.2.1">^</ci><ci id="S4.Ex4.m1.1.1.2.2.cmml" xref="S4.Ex4.m1.1.1.2.2">𝑄</ci></apply><csymbol cd="latexml" id="S4.Ex4.m1.1.1.3.cmml" xref="S4.Ex4.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex4.m1.1c">\displaystyle\hat{Q}\leftarrow</annotation><annotation encoding="application/x-llamapun" id="S4.Ex4.m1.1d">over^ start_ARG italic_Q end_ARG ←</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\arg\min_{Q}\alpha(\mathbb{E}_{s\sim\mathcal{D},a\sim\mu(a|s)}[Q(%
s,a)]-\mathbb{E}_{s,a\sim\mathcal{D}}[Q(s,a)])" class="ltx_Math" display="inline" id="S4.Ex4.m2.9"><semantics id="S4.Ex4.m2.9a"><mrow id="S4.Ex4.m2.9.9" xref="S4.Ex4.m2.9.9.cmml"><mrow id="S4.Ex4.m2.9.9.3" xref="S4.Ex4.m2.9.9.3.cmml"><mi id="S4.Ex4.m2.9.9.3.1" xref="S4.Ex4.m2.9.9.3.1.cmml">arg</mi><mo id="S4.Ex4.m2.9.9.3a" lspace="0.167em" xref="S4.Ex4.m2.9.9.3.cmml">⁡</mo><mrow id="S4.Ex4.m2.9.9.3.2" xref="S4.Ex4.m2.9.9.3.2.cmml"><munder id="S4.Ex4.m2.9.9.3.2.1" xref="S4.Ex4.m2.9.9.3.2.1.cmml"><mi id="S4.Ex4.m2.9.9.3.2.1.2" xref="S4.Ex4.m2.9.9.3.2.1.2.cmml">min</mi><mi id="S4.Ex4.m2.9.9.3.2.1.3" xref="S4.Ex4.m2.9.9.3.2.1.3.cmml">Q</mi></munder><mo id="S4.Ex4.m2.9.9.3.2a" lspace="0.167em" xref="S4.Ex4.m2.9.9.3.2.cmml">⁡</mo><mi id="S4.Ex4.m2.9.9.3.2.2" xref="S4.Ex4.m2.9.9.3.2.2.cmml">α</mi></mrow></mrow><mo id="S4.Ex4.m2.9.9.2" xref="S4.Ex4.m2.9.9.2.cmml">⁢</mo><mrow id="S4.Ex4.m2.9.9.1.1" xref="S4.Ex4.m2.9.9.1.1.1.cmml"><mo id="S4.Ex4.m2.9.9.1.1.2" stretchy="false" xref="S4.Ex4.m2.9.9.1.1.1.cmml">(</mo><mrow id="S4.Ex4.m2.9.9.1.1.1" xref="S4.Ex4.m2.9.9.1.1.1.cmml"><mrow id="S4.Ex4.m2.9.9.1.1.1.1" xref="S4.Ex4.m2.9.9.1.1.1.1.cmml"><msub id="S4.Ex4.m2.9.9.1.1.1.1.3" xref="S4.Ex4.m2.9.9.1.1.1.1.3.cmml"><mi id="S4.Ex4.m2.9.9.1.1.1.1.3.2" xref="S4.Ex4.m2.9.9.1.1.1.1.3.2.cmml">𝔼</mi><mrow id="S4.Ex4.m2.2.2.2.2" xref="S4.Ex4.m2.2.2.2.3.cmml"><mrow id="S4.Ex4.m2.1.1.1.1.1" xref="S4.Ex4.m2.1.1.1.1.1.cmml"><mi id="S4.Ex4.m2.1.1.1.1.1.2" xref="S4.Ex4.m2.1.1.1.1.1.2.cmml">s</mi><mo id="S4.Ex4.m2.1.1.1.1.1.1" xref="S4.Ex4.m2.1.1.1.1.1.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S4.Ex4.m2.1.1.1.1.1.3" xref="S4.Ex4.m2.1.1.1.1.1.3.cmml">𝒟</mi></mrow><mo id="S4.Ex4.m2.2.2.2.2.3" xref="S4.Ex4.m2.2.2.2.3a.cmml">,</mo><mrow id="S4.Ex4.m2.2.2.2.2.2" xref="S4.Ex4.m2.2.2.2.2.2.cmml"><mi id="S4.Ex4.m2.2.2.2.2.2.3" xref="S4.Ex4.m2.2.2.2.2.2.3.cmml">a</mi><mo id="S4.Ex4.m2.2.2.2.2.2.2" xref="S4.Ex4.m2.2.2.2.2.2.2.cmml">∼</mo><mrow id="S4.Ex4.m2.2.2.2.2.2.1" xref="S4.Ex4.m2.2.2.2.2.2.1.cmml"><mi id="S4.Ex4.m2.2.2.2.2.2.1.3" xref="S4.Ex4.m2.2.2.2.2.2.1.3.cmml">μ</mi><mo id="S4.Ex4.m2.2.2.2.2.2.1.2" xref="S4.Ex4.m2.2.2.2.2.2.1.2.cmml">⁢</mo><mrow id="S4.Ex4.m2.2.2.2.2.2.1.1.1" xref="S4.Ex4.m2.2.2.2.2.2.1.1.1.1.cmml"><mo id="S4.Ex4.m2.2.2.2.2.2.1.1.1.2" stretchy="false" xref="S4.Ex4.m2.2.2.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.Ex4.m2.2.2.2.2.2.1.1.1.1" xref="S4.Ex4.m2.2.2.2.2.2.1.1.1.1.cmml"><mi id="S4.Ex4.m2.2.2.2.2.2.1.1.1.1.2" xref="S4.Ex4.m2.2.2.2.2.2.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S4.Ex4.m2.2.2.2.2.2.1.1.1.1.1" xref="S4.Ex4.m2.2.2.2.2.2.1.1.1.1.1.cmml">|</mo><mi id="S4.Ex4.m2.2.2.2.2.2.1.1.1.1.3" xref="S4.Ex4.m2.2.2.2.2.2.1.1.1.1.3.cmml">s</mi></mrow><mo id="S4.Ex4.m2.2.2.2.2.2.1.1.1.3" stretchy="false" xref="S4.Ex4.m2.2.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></msub><mo id="S4.Ex4.m2.9.9.1.1.1.1.2" xref="S4.Ex4.m2.9.9.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex4.m2.9.9.1.1.1.1.1.1" xref="S4.Ex4.m2.9.9.1.1.1.1.1.2.cmml"><mo id="S4.Ex4.m2.9.9.1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex4.m2.9.9.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.Ex4.m2.9.9.1.1.1.1.1.1.1" xref="S4.Ex4.m2.9.9.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex4.m2.9.9.1.1.1.1.1.1.1.2" xref="S4.Ex4.m2.9.9.1.1.1.1.1.1.1.2.cmml">Q</mi><mo id="S4.Ex4.m2.9.9.1.1.1.1.1.1.1.1" xref="S4.Ex4.m2.9.9.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.Ex4.m2.9.9.1.1.1.1.1.1.1.3.2" xref="S4.Ex4.m2.9.9.1.1.1.1.1.1.1.3.1.cmml"><mo id="S4.Ex4.m2.9.9.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.Ex4.m2.9.9.1.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S4.Ex4.m2.5.5" xref="S4.Ex4.m2.5.5.cmml">s</mi><mo id="S4.Ex4.m2.9.9.1.1.1.1.1.1.1.3.2.2" xref="S4.Ex4.m2.9.9.1.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="S4.Ex4.m2.6.6" xref="S4.Ex4.m2.6.6.cmml">a</mi><mo id="S4.Ex4.m2.9.9.1.1.1.1.1.1.1.3.2.3" stretchy="false" xref="S4.Ex4.m2.9.9.1.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex4.m2.9.9.1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex4.m2.9.9.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S4.Ex4.m2.9.9.1.1.1.3" xref="S4.Ex4.m2.9.9.1.1.1.3.cmml">−</mo><mrow id="S4.Ex4.m2.9.9.1.1.1.2" xref="S4.Ex4.m2.9.9.1.1.1.2.cmml"><msub id="S4.Ex4.m2.9.9.1.1.1.2.3" xref="S4.Ex4.m2.9.9.1.1.1.2.3.cmml"><mi id="S4.Ex4.m2.9.9.1.1.1.2.3.2" xref="S4.Ex4.m2.9.9.1.1.1.2.3.2.cmml">𝔼</mi><mrow id="S4.Ex4.m2.4.4.2" xref="S4.Ex4.m2.4.4.2.cmml"><mrow id="S4.Ex4.m2.4.4.2.4.2" xref="S4.Ex4.m2.4.4.2.4.1.cmml"><mi id="S4.Ex4.m2.3.3.1.1" xref="S4.Ex4.m2.3.3.1.1.cmml">s</mi><mo id="S4.Ex4.m2.4.4.2.4.2.1" xref="S4.Ex4.m2.4.4.2.4.1.cmml">,</mo><mi id="S4.Ex4.m2.4.4.2.2" xref="S4.Ex4.m2.4.4.2.2.cmml">a</mi></mrow><mo id="S4.Ex4.m2.4.4.2.3" xref="S4.Ex4.m2.4.4.2.3.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S4.Ex4.m2.4.4.2.5" xref="S4.Ex4.m2.4.4.2.5.cmml">𝒟</mi></mrow></msub><mo id="S4.Ex4.m2.9.9.1.1.1.2.2" xref="S4.Ex4.m2.9.9.1.1.1.2.2.cmml">⁢</mo><mrow id="S4.Ex4.m2.9.9.1.1.1.2.1.1" xref="S4.Ex4.m2.9.9.1.1.1.2.1.2.cmml"><mo id="S4.Ex4.m2.9.9.1.1.1.2.1.1.2" stretchy="false" xref="S4.Ex4.m2.9.9.1.1.1.2.1.2.1.cmml">[</mo><mrow id="S4.Ex4.m2.9.9.1.1.1.2.1.1.1" xref="S4.Ex4.m2.9.9.1.1.1.2.1.1.1.cmml"><mi id="S4.Ex4.m2.9.9.1.1.1.2.1.1.1.2" xref="S4.Ex4.m2.9.9.1.1.1.2.1.1.1.2.cmml">Q</mi><mo id="S4.Ex4.m2.9.9.1.1.1.2.1.1.1.1" xref="S4.Ex4.m2.9.9.1.1.1.2.1.1.1.1.cmml">⁢</mo><mrow id="S4.Ex4.m2.9.9.1.1.1.2.1.1.1.3.2" xref="S4.Ex4.m2.9.9.1.1.1.2.1.1.1.3.1.cmml"><mo id="S4.Ex4.m2.9.9.1.1.1.2.1.1.1.3.2.1" stretchy="false" xref="S4.Ex4.m2.9.9.1.1.1.2.1.1.1.3.1.cmml">(</mo><mi id="S4.Ex4.m2.7.7" xref="S4.Ex4.m2.7.7.cmml">s</mi><mo id="S4.Ex4.m2.9.9.1.1.1.2.1.1.1.3.2.2" xref="S4.Ex4.m2.9.9.1.1.1.2.1.1.1.3.1.cmml">,</mo><mi id="S4.Ex4.m2.8.8" xref="S4.Ex4.m2.8.8.cmml">a</mi><mo id="S4.Ex4.m2.9.9.1.1.1.2.1.1.1.3.2.3" stretchy="false" xref="S4.Ex4.m2.9.9.1.1.1.2.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex4.m2.9.9.1.1.1.2.1.1.3" stretchy="false" xref="S4.Ex4.m2.9.9.1.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S4.Ex4.m2.9.9.1.1.3" stretchy="false" xref="S4.Ex4.m2.9.9.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex4.m2.9b"><apply id="S4.Ex4.m2.9.9.cmml" xref="S4.Ex4.m2.9.9"><times id="S4.Ex4.m2.9.9.2.cmml" xref="S4.Ex4.m2.9.9.2"></times><apply id="S4.Ex4.m2.9.9.3.cmml" xref="S4.Ex4.m2.9.9.3"><arg id="S4.Ex4.m2.9.9.3.1.cmml" xref="S4.Ex4.m2.9.9.3.1"></arg><apply id="S4.Ex4.m2.9.9.3.2.cmml" xref="S4.Ex4.m2.9.9.3.2"><apply id="S4.Ex4.m2.9.9.3.2.1.cmml" xref="S4.Ex4.m2.9.9.3.2.1"><csymbol cd="ambiguous" id="S4.Ex4.m2.9.9.3.2.1.1.cmml" xref="S4.Ex4.m2.9.9.3.2.1">subscript</csymbol><min id="S4.Ex4.m2.9.9.3.2.1.2.cmml" xref="S4.Ex4.m2.9.9.3.2.1.2"></min><ci id="S4.Ex4.m2.9.9.3.2.1.3.cmml" xref="S4.Ex4.m2.9.9.3.2.1.3">𝑄</ci></apply><ci id="S4.Ex4.m2.9.9.3.2.2.cmml" xref="S4.Ex4.m2.9.9.3.2.2">𝛼</ci></apply></apply><apply id="S4.Ex4.m2.9.9.1.1.1.cmml" xref="S4.Ex4.m2.9.9.1.1"><minus id="S4.Ex4.m2.9.9.1.1.1.3.cmml" xref="S4.Ex4.m2.9.9.1.1.1.3"></minus><apply id="S4.Ex4.m2.9.9.1.1.1.1.cmml" xref="S4.Ex4.m2.9.9.1.1.1.1"><times id="S4.Ex4.m2.9.9.1.1.1.1.2.cmml" xref="S4.Ex4.m2.9.9.1.1.1.1.2"></times><apply id="S4.Ex4.m2.9.9.1.1.1.1.3.cmml" xref="S4.Ex4.m2.9.9.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex4.m2.9.9.1.1.1.1.3.1.cmml" xref="S4.Ex4.m2.9.9.1.1.1.1.3">subscript</csymbol><ci id="S4.Ex4.m2.9.9.1.1.1.1.3.2.cmml" xref="S4.Ex4.m2.9.9.1.1.1.1.3.2">𝔼</ci><apply id="S4.Ex4.m2.2.2.2.3.cmml" xref="S4.Ex4.m2.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex4.m2.2.2.2.3a.cmml" xref="S4.Ex4.m2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S4.Ex4.m2.1.1.1.1.1.cmml" xref="S4.Ex4.m2.1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex4.m2.1.1.1.1.1.1.cmml" xref="S4.Ex4.m2.1.1.1.1.1.1">similar-to</csymbol><ci id="S4.Ex4.m2.1.1.1.1.1.2.cmml" xref="S4.Ex4.m2.1.1.1.1.1.2">𝑠</ci><ci id="S4.Ex4.m2.1.1.1.1.1.3.cmml" xref="S4.Ex4.m2.1.1.1.1.1.3">𝒟</ci></apply><apply id="S4.Ex4.m2.2.2.2.2.2.cmml" xref="S4.Ex4.m2.2.2.2.2.2"><csymbol cd="latexml" id="S4.Ex4.m2.2.2.2.2.2.2.cmml" xref="S4.Ex4.m2.2.2.2.2.2.2">similar-to</csymbol><ci id="S4.Ex4.m2.2.2.2.2.2.3.cmml" xref="S4.Ex4.m2.2.2.2.2.2.3">𝑎</ci><apply id="S4.Ex4.m2.2.2.2.2.2.1.cmml" xref="S4.Ex4.m2.2.2.2.2.2.1"><times id="S4.Ex4.m2.2.2.2.2.2.1.2.cmml" xref="S4.Ex4.m2.2.2.2.2.2.1.2"></times><ci id="S4.Ex4.m2.2.2.2.2.2.1.3.cmml" xref="S4.Ex4.m2.2.2.2.2.2.1.3">𝜇</ci><apply id="S4.Ex4.m2.2.2.2.2.2.1.1.1.1.cmml" xref="S4.Ex4.m2.2.2.2.2.2.1.1.1"><csymbol cd="latexml" id="S4.Ex4.m2.2.2.2.2.2.1.1.1.1.1.cmml" xref="S4.Ex4.m2.2.2.2.2.2.1.1.1.1.1">conditional</csymbol><ci id="S4.Ex4.m2.2.2.2.2.2.1.1.1.1.2.cmml" xref="S4.Ex4.m2.2.2.2.2.2.1.1.1.1.2">𝑎</ci><ci id="S4.Ex4.m2.2.2.2.2.2.1.1.1.1.3.cmml" xref="S4.Ex4.m2.2.2.2.2.2.1.1.1.1.3">𝑠</ci></apply></apply></apply></apply></apply><apply id="S4.Ex4.m2.9.9.1.1.1.1.1.2.cmml" xref="S4.Ex4.m2.9.9.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex4.m2.9.9.1.1.1.1.1.2.1.cmml" xref="S4.Ex4.m2.9.9.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.Ex4.m2.9.9.1.1.1.1.1.1.1.cmml" xref="S4.Ex4.m2.9.9.1.1.1.1.1.1.1"><times id="S4.Ex4.m2.9.9.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex4.m2.9.9.1.1.1.1.1.1.1.1"></times><ci id="S4.Ex4.m2.9.9.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex4.m2.9.9.1.1.1.1.1.1.1.2">𝑄</ci><interval closure="open" id="S4.Ex4.m2.9.9.1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex4.m2.9.9.1.1.1.1.1.1.1.3.2"><ci id="S4.Ex4.m2.5.5.cmml" xref="S4.Ex4.m2.5.5">𝑠</ci><ci id="S4.Ex4.m2.6.6.cmml" xref="S4.Ex4.m2.6.6">𝑎</ci></interval></apply></apply></apply><apply id="S4.Ex4.m2.9.9.1.1.1.2.cmml" xref="S4.Ex4.m2.9.9.1.1.1.2"><times id="S4.Ex4.m2.9.9.1.1.1.2.2.cmml" xref="S4.Ex4.m2.9.9.1.1.1.2.2"></times><apply id="S4.Ex4.m2.9.9.1.1.1.2.3.cmml" xref="S4.Ex4.m2.9.9.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.Ex4.m2.9.9.1.1.1.2.3.1.cmml" xref="S4.Ex4.m2.9.9.1.1.1.2.3">subscript</csymbol><ci id="S4.Ex4.m2.9.9.1.1.1.2.3.2.cmml" xref="S4.Ex4.m2.9.9.1.1.1.2.3.2">𝔼</ci><apply id="S4.Ex4.m2.4.4.2.cmml" xref="S4.Ex4.m2.4.4.2"><csymbol cd="latexml" id="S4.Ex4.m2.4.4.2.3.cmml" xref="S4.Ex4.m2.4.4.2.3">similar-to</csymbol><list id="S4.Ex4.m2.4.4.2.4.1.cmml" xref="S4.Ex4.m2.4.4.2.4.2"><ci id="S4.Ex4.m2.3.3.1.1.cmml" xref="S4.Ex4.m2.3.3.1.1">𝑠</ci><ci id="S4.Ex4.m2.4.4.2.2.cmml" xref="S4.Ex4.m2.4.4.2.2">𝑎</ci></list><ci id="S4.Ex4.m2.4.4.2.5.cmml" xref="S4.Ex4.m2.4.4.2.5">𝒟</ci></apply></apply><apply id="S4.Ex4.m2.9.9.1.1.1.2.1.2.cmml" xref="S4.Ex4.m2.9.9.1.1.1.2.1.1"><csymbol cd="latexml" id="S4.Ex4.m2.9.9.1.1.1.2.1.2.1.cmml" xref="S4.Ex4.m2.9.9.1.1.1.2.1.1.2">delimited-[]</csymbol><apply id="S4.Ex4.m2.9.9.1.1.1.2.1.1.1.cmml" xref="S4.Ex4.m2.9.9.1.1.1.2.1.1.1"><times id="S4.Ex4.m2.9.9.1.1.1.2.1.1.1.1.cmml" xref="S4.Ex4.m2.9.9.1.1.1.2.1.1.1.1"></times><ci id="S4.Ex4.m2.9.9.1.1.1.2.1.1.1.2.cmml" xref="S4.Ex4.m2.9.9.1.1.1.2.1.1.1.2">𝑄</ci><interval closure="open" id="S4.Ex4.m2.9.9.1.1.1.2.1.1.1.3.1.cmml" xref="S4.Ex4.m2.9.9.1.1.1.2.1.1.1.3.2"><ci id="S4.Ex4.m2.7.7.cmml" xref="S4.Ex4.m2.7.7">𝑠</ci><ci id="S4.Ex4.m2.8.8.cmml" xref="S4.Ex4.m2.8.8">𝑎</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex4.m2.9c">\displaystyle\arg\min_{Q}\alpha(\mathbb{E}_{s\sim\mathcal{D},a\sim\mu(a|s)}[Q(%
s,a)]-\mathbb{E}_{s,a\sim\mathcal{D}}[Q(s,a)])</annotation><annotation encoding="application/x-llamapun" id="S4.Ex4.m2.9d">roman_arg roman_min start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT italic_α ( blackboard_E start_POSTSUBSCRIPT italic_s ∼ caligraphic_D , italic_a ∼ italic_μ ( italic_a | italic_s ) end_POSTSUBSCRIPT [ italic_Q ( italic_s , italic_a ) ] - blackboard_E start_POSTSUBSCRIPT italic_s , italic_a ∼ caligraphic_D end_POSTSUBSCRIPT [ italic_Q ( italic_s , italic_a ) ] )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(9)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+\frac{1}{2}\mathbb{E}_{s,a,s^{\prime}\sim\mathcal{D},a^{\prime}%
\sim\mu(a^{\prime}|s^{\prime})}[(r(s,a)+\gamma\hat{Q}(s^{\prime},a^{\prime})-Q%
(s,a))^{2}]." class="ltx_Math" display="inline" id="S4.E9.m1.9"><semantics id="S4.E9.m1.9a"><mrow id="S4.E9.m1.9.9.1" xref="S4.E9.m1.9.9.1.1.cmml"><mrow id="S4.E9.m1.9.9.1.1" xref="S4.E9.m1.9.9.1.1.cmml"><mo id="S4.E9.m1.9.9.1.1a" xref="S4.E9.m1.9.9.1.1.cmml">+</mo><mrow id="S4.E9.m1.9.9.1.1.1" xref="S4.E9.m1.9.9.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E9.m1.9.9.1.1.1.3" xref="S4.E9.m1.9.9.1.1.1.3.cmml"><mfrac id="S4.E9.m1.9.9.1.1.1.3a" xref="S4.E9.m1.9.9.1.1.1.3.cmml"><mn id="S4.E9.m1.9.9.1.1.1.3.2" xref="S4.E9.m1.9.9.1.1.1.3.2.cmml">1</mn><mn id="S4.E9.m1.9.9.1.1.1.3.3" xref="S4.E9.m1.9.9.1.1.1.3.3.cmml">2</mn></mfrac></mstyle><mo id="S4.E9.m1.9.9.1.1.1.2" xref="S4.E9.m1.9.9.1.1.1.2.cmml">⁢</mo><msub id="S4.E9.m1.9.9.1.1.1.4" xref="S4.E9.m1.9.9.1.1.1.4.cmml"><mi id="S4.E9.m1.9.9.1.1.1.4.2" xref="S4.E9.m1.9.9.1.1.1.4.2.cmml">𝔼</mi><mrow id="S4.E9.m1.4.4.4.4" xref="S4.E9.m1.4.4.4.5.cmml"><mrow id="S4.E9.m1.3.3.3.3.1" xref="S4.E9.m1.3.3.3.3.1.cmml"><mrow id="S4.E9.m1.3.3.3.3.1.1.1" xref="S4.E9.m1.3.3.3.3.1.1.2.cmml"><mi id="S4.E9.m1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml">s</mi><mo id="S4.E9.m1.3.3.3.3.1.1.1.2" xref="S4.E9.m1.3.3.3.3.1.1.2.cmml">,</mo><mi id="S4.E9.m1.2.2.2.2" xref="S4.E9.m1.2.2.2.2.cmml">a</mi><mo id="S4.E9.m1.3.3.3.3.1.1.1.3" xref="S4.E9.m1.3.3.3.3.1.1.2.cmml">,</mo><msup id="S4.E9.m1.3.3.3.3.1.1.1.1" xref="S4.E9.m1.3.3.3.3.1.1.1.1.cmml"><mi id="S4.E9.m1.3.3.3.3.1.1.1.1.2" xref="S4.E9.m1.3.3.3.3.1.1.1.1.2.cmml">s</mi><mo id="S4.E9.m1.3.3.3.3.1.1.1.1.3" xref="S4.E9.m1.3.3.3.3.1.1.1.1.3.cmml">′</mo></msup></mrow><mo id="S4.E9.m1.3.3.3.3.1.2" xref="S4.E9.m1.3.3.3.3.1.2.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.3.3.3.3.1.3" xref="S4.E9.m1.3.3.3.3.1.3.cmml">𝒟</mi></mrow><mo id="S4.E9.m1.4.4.4.4.3" xref="S4.E9.m1.4.4.4.5a.cmml">,</mo><mrow id="S4.E9.m1.4.4.4.4.2" xref="S4.E9.m1.4.4.4.4.2.cmml"><msup id="S4.E9.m1.4.4.4.4.2.3" xref="S4.E9.m1.4.4.4.4.2.3.cmml"><mi id="S4.E9.m1.4.4.4.4.2.3.2" xref="S4.E9.m1.4.4.4.4.2.3.2.cmml">a</mi><mo id="S4.E9.m1.4.4.4.4.2.3.3" xref="S4.E9.m1.4.4.4.4.2.3.3.cmml">′</mo></msup><mo id="S4.E9.m1.4.4.4.4.2.2" xref="S4.E9.m1.4.4.4.4.2.2.cmml">∼</mo><mrow id="S4.E9.m1.4.4.4.4.2.1" xref="S4.E9.m1.4.4.4.4.2.1.cmml"><mi id="S4.E9.m1.4.4.4.4.2.1.3" xref="S4.E9.m1.4.4.4.4.2.1.3.cmml">μ</mi><mo id="S4.E9.m1.4.4.4.4.2.1.2" xref="S4.E9.m1.4.4.4.4.2.1.2.cmml">⁢</mo><mrow id="S4.E9.m1.4.4.4.4.2.1.1.1" xref="S4.E9.m1.4.4.4.4.2.1.1.1.1.cmml"><mo id="S4.E9.m1.4.4.4.4.2.1.1.1.2" stretchy="false" xref="S4.E9.m1.4.4.4.4.2.1.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.4.4.4.4.2.1.1.1.1" xref="S4.E9.m1.4.4.4.4.2.1.1.1.1.cmml"><msup id="S4.E9.m1.4.4.4.4.2.1.1.1.1.2" xref="S4.E9.m1.4.4.4.4.2.1.1.1.1.2.cmml"><mi id="S4.E9.m1.4.4.4.4.2.1.1.1.1.2.2" xref="S4.E9.m1.4.4.4.4.2.1.1.1.1.2.2.cmml">a</mi><mo id="S4.E9.m1.4.4.4.4.2.1.1.1.1.2.3" xref="S4.E9.m1.4.4.4.4.2.1.1.1.1.2.3.cmml">′</mo></msup><mo fence="false" id="S4.E9.m1.4.4.4.4.2.1.1.1.1.1" xref="S4.E9.m1.4.4.4.4.2.1.1.1.1.1.cmml">|</mo><msup id="S4.E9.m1.4.4.4.4.2.1.1.1.1.3" xref="S4.E9.m1.4.4.4.4.2.1.1.1.1.3.cmml"><mi id="S4.E9.m1.4.4.4.4.2.1.1.1.1.3.2" xref="S4.E9.m1.4.4.4.4.2.1.1.1.1.3.2.cmml">s</mi><mo id="S4.E9.m1.4.4.4.4.2.1.1.1.1.3.3" xref="S4.E9.m1.4.4.4.4.2.1.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="S4.E9.m1.4.4.4.4.2.1.1.1.3" stretchy="false" xref="S4.E9.m1.4.4.4.4.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></msub><mo id="S4.E9.m1.9.9.1.1.1.2a" xref="S4.E9.m1.9.9.1.1.1.2.cmml">⁢</mo><mrow id="S4.E9.m1.9.9.1.1.1.1.1" xref="S4.E9.m1.9.9.1.1.1.1.2.cmml"><mo id="S4.E9.m1.9.9.1.1.1.1.1.2" stretchy="false" xref="S4.E9.m1.9.9.1.1.1.1.2.1.cmml">[</mo><msup id="S4.E9.m1.9.9.1.1.1.1.1.1" xref="S4.E9.m1.9.9.1.1.1.1.1.1.cmml"><mrow id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.4" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.4.cmml"><mi id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.4.2" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.4.2.cmml">r</mi><mo id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.4.1" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.4.1.cmml">⁢</mo><mrow id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.4.3.2" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.4.3.1.cmml"><mo id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.4.3.2.1" stretchy="false" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.4.3.1.cmml">(</mo><mi id="S4.E9.m1.5.5" xref="S4.E9.m1.5.5.cmml">s</mi><mo id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.4.3.2.2" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.4.3.1.cmml">,</mo><mi id="S4.E9.m1.6.6" xref="S4.E9.m1.6.6.cmml">a</mi><mo id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.4.3.2.3" stretchy="false" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.4.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.3.cmml">+</mo><mrow id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.4" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.4.cmml">γ</mi><mo id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.3.cmml">⁢</mo><mover accent="true" id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.5" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.5.cmml"><mi id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.5.2" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.5.2.cmml">Q</mi><mo id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.5.1" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.5.1.cmml">^</mo></mover><mo id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.3a" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.3.cmml">⁢</mo><mrow id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml"><mo id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.2.3" stretchy="false" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">(</mo><msup id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mo id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.2.4" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">,</mo><msup id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml"><mi id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml">a</mi><mo id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.2.2.3" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.2.2.3.cmml">′</mo></msup><mo id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.2.5" stretchy="false" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.4" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.4.2" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.4.2.cmml">Q</mi><mo id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.4.1" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.4.1.cmml">⁢</mo><mrow id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.4.3.2" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.4.3.1.cmml"><mo id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.4.3.2.1" stretchy="false" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.4.3.1.cmml">(</mo><mi id="S4.E9.m1.7.7" xref="S4.E9.m1.7.7.cmml">s</mi><mo id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.4.3.2.2" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.4.3.1.cmml">,</mo><mi id="S4.E9.m1.8.8" xref="S4.E9.m1.8.8.cmml">a</mi><mo id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.4.3.2.3" stretchy="false" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.4.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.E9.m1.9.9.1.1.1.1.1.1.3" xref="S4.E9.m1.9.9.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S4.E9.m1.9.9.1.1.1.1.1.3" stretchy="false" xref="S4.E9.m1.9.9.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S4.E9.m1.9.9.1.2" lspace="0em" xref="S4.E9.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.9b"><apply id="S4.E9.m1.9.9.1.1.cmml" xref="S4.E9.m1.9.9.1"><plus id="S4.E9.m1.9.9.1.1.2.cmml" xref="S4.E9.m1.9.9.1"></plus><apply id="S4.E9.m1.9.9.1.1.1.cmml" xref="S4.E9.m1.9.9.1.1.1"><times id="S4.E9.m1.9.9.1.1.1.2.cmml" xref="S4.E9.m1.9.9.1.1.1.2"></times><apply id="S4.E9.m1.9.9.1.1.1.3.cmml" xref="S4.E9.m1.9.9.1.1.1.3"><divide id="S4.E9.m1.9.9.1.1.1.3.1.cmml" xref="S4.E9.m1.9.9.1.1.1.3"></divide><cn id="S4.E9.m1.9.9.1.1.1.3.2.cmml" type="integer" xref="S4.E9.m1.9.9.1.1.1.3.2">1</cn><cn id="S4.E9.m1.9.9.1.1.1.3.3.cmml" type="integer" xref="S4.E9.m1.9.9.1.1.1.3.3">2</cn></apply><apply id="S4.E9.m1.9.9.1.1.1.4.cmml" xref="S4.E9.m1.9.9.1.1.1.4"><csymbol cd="ambiguous" id="S4.E9.m1.9.9.1.1.1.4.1.cmml" xref="S4.E9.m1.9.9.1.1.1.4">subscript</csymbol><ci id="S4.E9.m1.9.9.1.1.1.4.2.cmml" xref="S4.E9.m1.9.9.1.1.1.4.2">𝔼</ci><apply id="S4.E9.m1.4.4.4.5.cmml" xref="S4.E9.m1.4.4.4.4"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.4.5a.cmml" xref="S4.E9.m1.4.4.4.4.3">formulae-sequence</csymbol><apply id="S4.E9.m1.3.3.3.3.1.cmml" xref="S4.E9.m1.3.3.3.3.1"><csymbol cd="latexml" id="S4.E9.m1.3.3.3.3.1.2.cmml" xref="S4.E9.m1.3.3.3.3.1.2">similar-to</csymbol><list id="S4.E9.m1.3.3.3.3.1.1.2.cmml" xref="S4.E9.m1.3.3.3.3.1.1.1"><ci id="S4.E9.m1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1">𝑠</ci><ci id="S4.E9.m1.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2">𝑎</ci><apply id="S4.E9.m1.3.3.3.3.1.1.1.1.cmml" xref="S4.E9.m1.3.3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S4.E9.m1.3.3.3.3.1.1.1.1">superscript</csymbol><ci id="S4.E9.m1.3.3.3.3.1.1.1.1.2.cmml" xref="S4.E9.m1.3.3.3.3.1.1.1.1.2">𝑠</ci><ci id="S4.E9.m1.3.3.3.3.1.1.1.1.3.cmml" xref="S4.E9.m1.3.3.3.3.1.1.1.1.3">′</ci></apply></list><ci id="S4.E9.m1.3.3.3.3.1.3.cmml" xref="S4.E9.m1.3.3.3.3.1.3">𝒟</ci></apply><apply id="S4.E9.m1.4.4.4.4.2.cmml" xref="S4.E9.m1.4.4.4.4.2"><csymbol cd="latexml" id="S4.E9.m1.4.4.4.4.2.2.cmml" xref="S4.E9.m1.4.4.4.4.2.2">similar-to</csymbol><apply id="S4.E9.m1.4.4.4.4.2.3.cmml" xref="S4.E9.m1.4.4.4.4.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.4.4.2.3.1.cmml" xref="S4.E9.m1.4.4.4.4.2.3">superscript</csymbol><ci id="S4.E9.m1.4.4.4.4.2.3.2.cmml" xref="S4.E9.m1.4.4.4.4.2.3.2">𝑎</ci><ci id="S4.E9.m1.4.4.4.4.2.3.3.cmml" xref="S4.E9.m1.4.4.4.4.2.3.3">′</ci></apply><apply id="S4.E9.m1.4.4.4.4.2.1.cmml" xref="S4.E9.m1.4.4.4.4.2.1"><times id="S4.E9.m1.4.4.4.4.2.1.2.cmml" xref="S4.E9.m1.4.4.4.4.2.1.2"></times><ci id="S4.E9.m1.4.4.4.4.2.1.3.cmml" xref="S4.E9.m1.4.4.4.4.2.1.3">𝜇</ci><apply id="S4.E9.m1.4.4.4.4.2.1.1.1.1.cmml" xref="S4.E9.m1.4.4.4.4.2.1.1.1"><csymbol cd="latexml" id="S4.E9.m1.4.4.4.4.2.1.1.1.1.1.cmml" xref="S4.E9.m1.4.4.4.4.2.1.1.1.1.1">conditional</csymbol><apply id="S4.E9.m1.4.4.4.4.2.1.1.1.1.2.cmml" xref="S4.E9.m1.4.4.4.4.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.4.4.2.1.1.1.1.2.1.cmml" xref="S4.E9.m1.4.4.4.4.2.1.1.1.1.2">superscript</csymbol><ci id="S4.E9.m1.4.4.4.4.2.1.1.1.1.2.2.cmml" xref="S4.E9.m1.4.4.4.4.2.1.1.1.1.2.2">𝑎</ci><ci id="S4.E9.m1.4.4.4.4.2.1.1.1.1.2.3.cmml" xref="S4.E9.m1.4.4.4.4.2.1.1.1.1.2.3">′</ci></apply><apply id="S4.E9.m1.4.4.4.4.2.1.1.1.1.3.cmml" xref="S4.E9.m1.4.4.4.4.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.4.4.2.1.1.1.1.3.1.cmml" xref="S4.E9.m1.4.4.4.4.2.1.1.1.1.3">superscript</csymbol><ci id="S4.E9.m1.4.4.4.4.2.1.1.1.1.3.2.cmml" xref="S4.E9.m1.4.4.4.4.2.1.1.1.1.3.2">𝑠</ci><ci id="S4.E9.m1.4.4.4.4.2.1.1.1.1.3.3.cmml" xref="S4.E9.m1.4.4.4.4.2.1.1.1.1.3.3">′</ci></apply></apply></apply></apply></apply></apply><apply id="S4.E9.m1.9.9.1.1.1.1.2.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1"><csymbol cd="latexml" id="S4.E9.m1.9.9.1.1.1.1.2.1.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E9.m1.9.9.1.1.1.1.1.1.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.9.9.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1"><minus id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.3"></minus><apply id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2"><plus id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.3"></plus><apply id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.4.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.4"><times id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.4.1.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.4.1"></times><ci id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.4.2.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.4.2">𝑟</ci><interval closure="open" id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.4.3.1.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.4.3.2"><ci id="S4.E9.m1.5.5.cmml" xref="S4.E9.m1.5.5">𝑠</ci><ci id="S4.E9.m1.6.6.cmml" xref="S4.E9.m1.6.6">𝑎</ci></interval></apply><apply id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2"><times id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.3"></times><ci id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.4.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.4">𝛾</ci><apply id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.5.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.5"><ci id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.5.1.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.5.1">^</ci><ci id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.5.2.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.5.2">𝑄</ci></apply><interval closure="open" id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.2"><apply id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">′</ci></apply><apply id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.2.2">superscript</csymbol><ci id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.2.2.2">𝑎</ci><ci id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.2.2.2.2.2.3">′</ci></apply></interval></apply></apply><apply id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.4"><times id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.4.1"></times><ci id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.4.2">𝑄</ci><interval closure="open" id="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.4.3.1.cmml" xref="S4.E9.m1.9.9.1.1.1.1.1.1.1.1.1.4.3.2"><ci id="S4.E9.m1.7.7.cmml" xref="S4.E9.m1.7.7">𝑠</ci><ci id="S4.E9.m1.8.8.cmml" xref="S4.E9.m1.8.8">𝑎</ci></interval></apply></apply><cn id="S4.E9.m1.9.9.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E9.m1.9.9.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.9c">\displaystyle+\frac{1}{2}\mathbb{E}_{s,a,s^{\prime}\sim\mathcal{D},a^{\prime}%
\sim\mu(a^{\prime}|s^{\prime})}[(r(s,a)+\gamma\hat{Q}(s^{\prime},a^{\prime})-Q%
(s,a))^{2}].</annotation><annotation encoding="application/x-llamapun" id="S4.E9.m1.9d">+ divide start_ARG 1 end_ARG start_ARG 2 end_ARG blackboard_E start_POSTSUBSCRIPT italic_s , italic_a , italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∼ caligraphic_D , italic_a start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∼ italic_μ ( italic_a start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) end_POSTSUBSCRIPT [ ( italic_r ( italic_s , italic_a ) + italic_γ over^ start_ARG italic_Q end_ARG ( italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_a start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) - italic_Q ( italic_s , italic_a ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p5.2">Supporting this approach, we reference a theorem from the CQL framework (the proof of which can be found in the original paper):</p>
</div>
<div class="ltx_theorem ltx_theorem_theorem" id="S4.Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_font_smallcaps ltx_title_theorem">Theorem 1 (Lower Bound of CQL <cite class="ltx_cite ltx_citemacro_citep">(Kumar et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib17" title="">2020</a>)</cite>).</h6>
<div class="ltx_para" id="S4.Thmtheorem1.p1">
<p class="ltx_p" id="S4.Thmtheorem1.p1.1"><span class="ltx_text ltx_font_italic" id="S4.Thmtheorem1.p1.1.1">The value of the policy under the Q-function from <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S4.E9" title="In 4.3. RTG Relabeling ‣ 4. Methodology ‣ Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">9</span></a>, <math alttext="\hat{V}_{\pi}(\textbf{s})=\mathbb{E}_{\pi(\textbf{a}|\textbf{s})}[\hat{Q}_{\pi%
}(\textbf{s},\textbf{a})]" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.1.1.m1.5"><semantics id="S4.Thmtheorem1.p1.1.1.m1.5a"><mrow id="S4.Thmtheorem1.p1.1.1.m1.5.5" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.cmml"><mrow id="S4.Thmtheorem1.p1.1.1.m1.5.5.3" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.3.cmml"><msub id="S4.Thmtheorem1.p1.1.1.m1.5.5.3.2" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.3.2.cmml"><mover accent="true" id="S4.Thmtheorem1.p1.1.1.m1.5.5.3.2.2" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.3.2.2.cmml"><mi id="S4.Thmtheorem1.p1.1.1.m1.5.5.3.2.2.2" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.3.2.2.2.cmml">V</mi><mo id="S4.Thmtheorem1.p1.1.1.m1.5.5.3.2.2.1" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.3.2.2.1.cmml">^</mo></mover><mi id="S4.Thmtheorem1.p1.1.1.m1.5.5.3.2.3" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.3.2.3.cmml">π</mi></msub><mo id="S4.Thmtheorem1.p1.1.1.m1.5.5.3.1" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.3.1.cmml">⁢</mo><mrow id="S4.Thmtheorem1.p1.1.1.m1.5.5.3.3.2" xref="S4.Thmtheorem1.p1.1.1.m1.2.2a.cmml"><mo id="S4.Thmtheorem1.p1.1.1.m1.5.5.3.3.2.1" stretchy="false" xref="S4.Thmtheorem1.p1.1.1.m1.2.2a.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S4.Thmtheorem1.p1.1.1.m1.2.2" xref="S4.Thmtheorem1.p1.1.1.m1.2.2.cmml">s</mtext><mo id="S4.Thmtheorem1.p1.1.1.m1.5.5.3.3.2.2" stretchy="false" xref="S4.Thmtheorem1.p1.1.1.m1.2.2a.cmml">)</mo></mrow></mrow><mo id="S4.Thmtheorem1.p1.1.1.m1.5.5.2" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.2.cmml">=</mo><mrow id="S4.Thmtheorem1.p1.1.1.m1.5.5.1" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.cmml"><msub id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.3" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.3.cmml"><mi id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.3.2" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.3.2.cmml">𝔼</mi><mrow id="S4.Thmtheorem1.p1.1.1.m1.1.1.1" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.1.cmml"><mi id="S4.Thmtheorem1.p1.1.1.m1.1.1.1.3" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.1.3.cmml">π</mi><mo id="S4.Thmtheorem1.p1.1.1.m1.1.1.1.2" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Thmtheorem1.p1.1.1.m1.1.1.1.1.1" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.cmml"><mo id="S4.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.2" stretchy="false" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.2" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.2a.cmml">a</mtext><mo fence="false" id="S4.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.1" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.1.cmml">|</mo><mtext class="ltx_mathvariant_bold" id="S4.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.3" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.3a.cmml">s</mtext></mrow><mo id="S4.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.3" stretchy="false" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.2" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.2.cmml">⁢</mo><mrow id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.2.cmml"><mo id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.2" stretchy="false" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.2.1.cmml">[</mo><mrow id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.cmml"><msub id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.2" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.2.cmml"><mover accent="true" id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.2.2" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.2.2.cmml"><mi id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.2.2.2" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.2.2.2.cmml">Q</mi><mo id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.2.2.1" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.2.3" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.2.3.cmml">π</mi></msub><mo id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.1" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.3.2" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.3.1.cmml"><mo id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.3.2.1" stretchy="false" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.3.1.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S4.Thmtheorem1.p1.1.1.m1.3.3" xref="S4.Thmtheorem1.p1.1.1.m1.3.3a.cmml">s</mtext><mo id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.3.2.2" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.3.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S4.Thmtheorem1.p1.1.1.m1.4.4" xref="S4.Thmtheorem1.p1.1.1.m1.4.4a.cmml">a</mtext><mo id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.3.2.3" stretchy="false" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.3" stretchy="false" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.1.1.m1.5b"><apply id="S4.Thmtheorem1.p1.1.1.m1.5.5.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.5.5"><eq id="S4.Thmtheorem1.p1.1.1.m1.5.5.2.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.2"></eq><apply id="S4.Thmtheorem1.p1.1.1.m1.5.5.3.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.3"><times id="S4.Thmtheorem1.p1.1.1.m1.5.5.3.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.3.1"></times><apply id="S4.Thmtheorem1.p1.1.1.m1.5.5.3.2.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.3.2"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.1.1.m1.5.5.3.2.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.3.2">subscript</csymbol><apply id="S4.Thmtheorem1.p1.1.1.m1.5.5.3.2.2.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.3.2.2"><ci id="S4.Thmtheorem1.p1.1.1.m1.5.5.3.2.2.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.3.2.2.1">^</ci><ci id="S4.Thmtheorem1.p1.1.1.m1.5.5.3.2.2.2.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.3.2.2.2">𝑉</ci></apply><ci id="S4.Thmtheorem1.p1.1.1.m1.5.5.3.2.3.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.3.2.3">𝜋</ci></apply><ci id="S4.Thmtheorem1.p1.1.1.m1.2.2a.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.3.3.2"><mtext class="ltx_mathvariant_bold" id="S4.Thmtheorem1.p1.1.1.m1.2.2.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.2.2">s</mtext></ci></apply><apply id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1"><times id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.2.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.2"></times><apply id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.3.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.3"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.3.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.3">subscript</csymbol><ci id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.3.2.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.3.2">𝔼</ci><apply id="S4.Thmtheorem1.p1.1.1.m1.1.1.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.1"><times id="S4.Thmtheorem1.p1.1.1.m1.1.1.1.2.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.1.2"></times><ci id="S4.Thmtheorem1.p1.1.1.m1.1.1.1.3.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.1.3">𝜋</ci><apply id="S4.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S4.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.2a.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.2.cmml" mathsize="70%" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.2">a</mtext></ci><ci id="S4.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.3a.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_bold" id="S4.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.3">s</mtext></ci></apply></apply></apply><apply id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.2.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1"><csymbol cd="latexml" id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.2.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.2">delimited-[]</csymbol><apply id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1"><times id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.1"></times><apply id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.2.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.2.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.2">subscript</csymbol><apply id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.2.2.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.2.2"><ci id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.2.2.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.2.2.1">^</ci><ci id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.2.2.2.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.2.2.2">𝑄</ci></apply><ci id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.2.3.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.2.3">𝜋</ci></apply><interval closure="open" id="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.3.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.5.5.1.1.1.1.3.2"><ci id="S4.Thmtheorem1.p1.1.1.m1.3.3a.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.3.3"><mtext class="ltx_mathvariant_bold" id="S4.Thmtheorem1.p1.1.1.m1.3.3.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.3.3">s</mtext></ci><ci id="S4.Thmtheorem1.p1.1.1.m1.4.4a.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.4.4"><mtext class="ltx_mathvariant_bold" id="S4.Thmtheorem1.p1.1.1.m1.4.4.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.4.4">a</mtext></ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.1.1.m1.5c">\hat{V}_{\pi}(\textbf{s})=\mathbb{E}_{\pi(\textbf{a}|\textbf{s})}[\hat{Q}_{\pi%
}(\textbf{s},\textbf{a})]</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.1.1.m1.5d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT ( s ) = blackboard_E start_POSTSUBSCRIPT italic_π ( a | s ) end_POSTSUBSCRIPT [ over^ start_ARG italic_Q end_ARG start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT ( s , a ) ]</annotation></semantics></math>, lower-bounds the true value of the policy obtained via exact policy evaluation.</span></p>
</div>
</div>
<div class="ltx_para" id="S4.SS3.p6">
<p class="ltx_p" id="S4.SS3.p6.2">In practice, the optimal value function <math alttext="Q^{*}(s,a)" class="ltx_Math" display="inline" id="S4.SS3.p6.1.m1.2"><semantics id="S4.SS3.p6.1.m1.2a"><mrow id="S4.SS3.p6.1.m1.2.3" xref="S4.SS3.p6.1.m1.2.3.cmml"><msup id="S4.SS3.p6.1.m1.2.3.2" xref="S4.SS3.p6.1.m1.2.3.2.cmml"><mi id="S4.SS3.p6.1.m1.2.3.2.2" xref="S4.SS3.p6.1.m1.2.3.2.2.cmml">Q</mi><mo id="S4.SS3.p6.1.m1.2.3.2.3" xref="S4.SS3.p6.1.m1.2.3.2.3.cmml">∗</mo></msup><mo id="S4.SS3.p6.1.m1.2.3.1" xref="S4.SS3.p6.1.m1.2.3.1.cmml">⁢</mo><mrow id="S4.SS3.p6.1.m1.2.3.3.2" xref="S4.SS3.p6.1.m1.2.3.3.1.cmml"><mo id="S4.SS3.p6.1.m1.2.3.3.2.1" stretchy="false" xref="S4.SS3.p6.1.m1.2.3.3.1.cmml">(</mo><mi id="S4.SS3.p6.1.m1.1.1" xref="S4.SS3.p6.1.m1.1.1.cmml">s</mi><mo id="S4.SS3.p6.1.m1.2.3.3.2.2" xref="S4.SS3.p6.1.m1.2.3.3.1.cmml">,</mo><mi id="S4.SS3.p6.1.m1.2.2" xref="S4.SS3.p6.1.m1.2.2.cmml">a</mi><mo id="S4.SS3.p6.1.m1.2.3.3.2.3" stretchy="false" xref="S4.SS3.p6.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.1.m1.2b"><apply id="S4.SS3.p6.1.m1.2.3.cmml" xref="S4.SS3.p6.1.m1.2.3"><times id="S4.SS3.p6.1.m1.2.3.1.cmml" xref="S4.SS3.p6.1.m1.2.3.1"></times><apply id="S4.SS3.p6.1.m1.2.3.2.cmml" xref="S4.SS3.p6.1.m1.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.p6.1.m1.2.3.2.1.cmml" xref="S4.SS3.p6.1.m1.2.3.2">superscript</csymbol><ci id="S4.SS3.p6.1.m1.2.3.2.2.cmml" xref="S4.SS3.p6.1.m1.2.3.2.2">𝑄</ci><times id="S4.SS3.p6.1.m1.2.3.2.3.cmml" xref="S4.SS3.p6.1.m1.2.3.2.3"></times></apply><interval closure="open" id="S4.SS3.p6.1.m1.2.3.3.1.cmml" xref="S4.SS3.p6.1.m1.2.3.3.2"><ci id="S4.SS3.p6.1.m1.1.1.cmml" xref="S4.SS3.p6.1.m1.1.1">𝑠</ci><ci id="S4.SS3.p6.1.m1.2.2.cmml" xref="S4.SS3.p6.1.m1.2.2">𝑎</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.1.m1.2c">Q^{*}(s,a)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p6.1.m1.2d">italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a )</annotation></semantics></math> is unknown, compelling DT to rely on RTG as an alternative. RTG values, typically gathered through the behavior policy or policies, are often not optimal and tend to be significantly lower than their optimal value function counterparts, <math alttext="Q^{*}(s,a)" class="ltx_Math" display="inline" id="S4.SS3.p6.2.m2.2"><semantics id="S4.SS3.p6.2.m2.2a"><mrow id="S4.SS3.p6.2.m2.2.3" xref="S4.SS3.p6.2.m2.2.3.cmml"><msup id="S4.SS3.p6.2.m2.2.3.2" xref="S4.SS3.p6.2.m2.2.3.2.cmml"><mi id="S4.SS3.p6.2.m2.2.3.2.2" xref="S4.SS3.p6.2.m2.2.3.2.2.cmml">Q</mi><mo id="S4.SS3.p6.2.m2.2.3.2.3" xref="S4.SS3.p6.2.m2.2.3.2.3.cmml">∗</mo></msup><mo id="S4.SS3.p6.2.m2.2.3.1" xref="S4.SS3.p6.2.m2.2.3.1.cmml">⁢</mo><mrow id="S4.SS3.p6.2.m2.2.3.3.2" xref="S4.SS3.p6.2.m2.2.3.3.1.cmml"><mo id="S4.SS3.p6.2.m2.2.3.3.2.1" stretchy="false" xref="S4.SS3.p6.2.m2.2.3.3.1.cmml">(</mo><mi id="S4.SS3.p6.2.m2.1.1" xref="S4.SS3.p6.2.m2.1.1.cmml">s</mi><mo id="S4.SS3.p6.2.m2.2.3.3.2.2" xref="S4.SS3.p6.2.m2.2.3.3.1.cmml">,</mo><mi id="S4.SS3.p6.2.m2.2.2" xref="S4.SS3.p6.2.m2.2.2.cmml">a</mi><mo id="S4.SS3.p6.2.m2.2.3.3.2.3" stretchy="false" xref="S4.SS3.p6.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.2.m2.2b"><apply id="S4.SS3.p6.2.m2.2.3.cmml" xref="S4.SS3.p6.2.m2.2.3"><times id="S4.SS3.p6.2.m2.2.3.1.cmml" xref="S4.SS3.p6.2.m2.2.3.1"></times><apply id="S4.SS3.p6.2.m2.2.3.2.cmml" xref="S4.SS3.p6.2.m2.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.p6.2.m2.2.3.2.1.cmml" xref="S4.SS3.p6.2.m2.2.3.2">superscript</csymbol><ci id="S4.SS3.p6.2.m2.2.3.2.2.cmml" xref="S4.SS3.p6.2.m2.2.3.2.2">𝑄</ci><times id="S4.SS3.p6.2.m2.2.3.2.3.cmml" xref="S4.SS3.p6.2.m2.2.3.2.3"></times></apply><interval closure="open" id="S4.SS3.p6.2.m2.2.3.3.1.cmml" xref="S4.SS3.p6.2.m2.2.3.3.2"><ci id="S4.SS3.p6.2.m2.1.1.cmml" xref="S4.SS3.p6.2.m2.1.1">𝑠</ci><ci id="S4.SS3.p6.2.m2.2.2.cmml" xref="S4.SS3.p6.2.m2.2.2">𝑎</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.2.m2.2c">Q^{*}(s,a)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p6.2.m2.2d">italic_Q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s , italic_a )</annotation></semantics></math> This discrepancy presents a challenge in accurately modeling the optimal policy. However, by employing CQL for learning the Q-function, we can effectively address this challenge. The aforementioned theorem from the CQL framework assures that the value function estimated under CQL acts as a reliable lower bound of the true policy value. Consequently, this theorem supports the premise that our relabeling process, guided by the learned Q-function, shifts the RTG values in the training dataset closer to the optimal value function.To further substantiate this claim, we also provide a straightforward proof. This proof demonstrates how the application of CQL in learning the Q-function ensures that the relabeled RTG values in our training dataset are more aligned with what would be expected from the optimal value function, thus enhancing the overall accuracy and effectiveness of the DT in policy modeling.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4. </span>Training Procedure</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">We implement the aforementioned formulation through a transformer architecture, adapting and extending the existing DT framework. In EDT4RRec, we introduce modifications that align with the changes we’ve previously outlined. To predict the policy’s mean and log variance, we utilize two separate fully connected layers at the output stage of the model. This architectural choice allows for a more nuanced and effective representation of the policy’s characteristics. <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:{alg:overall_training}</span> summarizes the overall training pipeline in the proposed method.</p>
</div>
<figure class="ltx_float ltx_algorithm" id="algorithm2">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="algorithm2.25">
<div class="ltx_listingline" id="algorithm2.7.7">
<span class="ltx_text ltx_font_bold" id="algorithm2.7.7.1">input :</span> offline dataset <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="algorithm2.1.1.m1.1"><semantics id="algorithm2.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="algorithm2.1.1.m1.1.1" xref="algorithm2.1.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="algorithm2.1.1.m1.1b"><ci id="algorithm2.1.1.m1.1.1.cmml" xref="algorithm2.1.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.1.1.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.1.1.m1.1d">caligraphic_D</annotation></semantics></math>, exploration RTG <math alttext="\textbf{g}_{online}" class="ltx_Math" display="inline" id="algorithm2.2.2.m2.1"><semantics id="algorithm2.2.2.m2.1a"><msub id="algorithm2.2.2.m2.1.1" xref="algorithm2.2.2.m2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="algorithm2.2.2.m2.1.1.2" xref="algorithm2.2.2.m2.1.1.2a.cmml">g</mtext><mrow id="algorithm2.2.2.m2.1.1.3" xref="algorithm2.2.2.m2.1.1.3.cmml"><mi id="algorithm2.2.2.m2.1.1.3.2" xref="algorithm2.2.2.m2.1.1.3.2.cmml">o</mi><mo id="algorithm2.2.2.m2.1.1.3.1" xref="algorithm2.2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="algorithm2.2.2.m2.1.1.3.3" xref="algorithm2.2.2.m2.1.1.3.3.cmml">n</mi><mo id="algorithm2.2.2.m2.1.1.3.1a" xref="algorithm2.2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="algorithm2.2.2.m2.1.1.3.4" xref="algorithm2.2.2.m2.1.1.3.4.cmml">l</mi><mo id="algorithm2.2.2.m2.1.1.3.1b" xref="algorithm2.2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="algorithm2.2.2.m2.1.1.3.5" xref="algorithm2.2.2.m2.1.1.3.5.cmml">i</mi><mo id="algorithm2.2.2.m2.1.1.3.1c" xref="algorithm2.2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="algorithm2.2.2.m2.1.1.3.6" xref="algorithm2.2.2.m2.1.1.3.6.cmml">n</mi><mo id="algorithm2.2.2.m2.1.1.3.1d" xref="algorithm2.2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="algorithm2.2.2.m2.1.1.3.7" xref="algorithm2.2.2.m2.1.1.3.7.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm2.2.2.m2.1b"><apply id="algorithm2.2.2.m2.1.1.cmml" xref="algorithm2.2.2.m2.1.1"><csymbol cd="ambiguous" id="algorithm2.2.2.m2.1.1.1.cmml" xref="algorithm2.2.2.m2.1.1">subscript</csymbol><ci id="algorithm2.2.2.m2.1.1.2a.cmml" xref="algorithm2.2.2.m2.1.1.2"><mtext class="ltx_mathvariant_bold" id="algorithm2.2.2.m2.1.1.2.cmml" xref="algorithm2.2.2.m2.1.1.2">g</mtext></ci><apply id="algorithm2.2.2.m2.1.1.3.cmml" xref="algorithm2.2.2.m2.1.1.3"><times id="algorithm2.2.2.m2.1.1.3.1.cmml" xref="algorithm2.2.2.m2.1.1.3.1"></times><ci id="algorithm2.2.2.m2.1.1.3.2.cmml" xref="algorithm2.2.2.m2.1.1.3.2">𝑜</ci><ci id="algorithm2.2.2.m2.1.1.3.3.cmml" xref="algorithm2.2.2.m2.1.1.3.3">𝑛</ci><ci id="algorithm2.2.2.m2.1.1.3.4.cmml" xref="algorithm2.2.2.m2.1.1.3.4">𝑙</ci><ci id="algorithm2.2.2.m2.1.1.3.5.cmml" xref="algorithm2.2.2.m2.1.1.3.5">𝑖</ci><ci id="algorithm2.2.2.m2.1.1.3.6.cmml" xref="algorithm2.2.2.m2.1.1.3.6">𝑛</ci><ci id="algorithm2.2.2.m2.1.1.3.7.cmml" xref="algorithm2.2.2.m2.1.1.3.7">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.2.2.m2.1c">\textbf{g}_{online}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.2.2.m2.1d">g start_POSTSUBSCRIPT italic_o italic_n italic_l italic_i italic_n italic_e end_POSTSUBSCRIPT</annotation></semantics></math>, reply buffer <math alttext="\mathcal{D}_{re}" class="ltx_Math" display="inline" id="algorithm2.3.3.m3.1"><semantics id="algorithm2.3.3.m3.1a"><msub id="algorithm2.3.3.m3.1.1" xref="algorithm2.3.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.3.3.m3.1.1.2" xref="algorithm2.3.3.m3.1.1.2.cmml">𝒟</mi><mrow id="algorithm2.3.3.m3.1.1.3" xref="algorithm2.3.3.m3.1.1.3.cmml"><mi id="algorithm2.3.3.m3.1.1.3.2" xref="algorithm2.3.3.m3.1.1.3.2.cmml">r</mi><mo id="algorithm2.3.3.m3.1.1.3.1" xref="algorithm2.3.3.m3.1.1.3.1.cmml">⁢</mo><mi id="algorithm2.3.3.m3.1.1.3.3" xref="algorithm2.3.3.m3.1.1.3.3.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm2.3.3.m3.1b"><apply id="algorithm2.3.3.m3.1.1.cmml" xref="algorithm2.3.3.m3.1.1"><csymbol cd="ambiguous" id="algorithm2.3.3.m3.1.1.1.cmml" xref="algorithm2.3.3.m3.1.1">subscript</csymbol><ci id="algorithm2.3.3.m3.1.1.2.cmml" xref="algorithm2.3.3.m3.1.1.2">𝒟</ci><apply id="algorithm2.3.3.m3.1.1.3.cmml" xref="algorithm2.3.3.m3.1.1.3"><times id="algorithm2.3.3.m3.1.1.3.1.cmml" xref="algorithm2.3.3.m3.1.1.3.1"></times><ci id="algorithm2.3.3.m3.1.1.3.2.cmml" xref="algorithm2.3.3.m3.1.1.3.2">𝑟</ci><ci id="algorithm2.3.3.m3.1.1.3.3.cmml" xref="algorithm2.3.3.m3.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.3.3.m3.1c">\mathcal{D}_{re}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.3.3.m3.1d">caligraphic_D start_POSTSUBSCRIPT italic_r italic_e end_POSTSUBSCRIPT</annotation></semantics></math>, number of round <math alttext="i" class="ltx_Math" display="inline" id="algorithm2.4.4.m4.1"><semantics id="algorithm2.4.4.m4.1a"><mi id="algorithm2.4.4.m4.1.1" xref="algorithm2.4.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="algorithm2.4.4.m4.1b"><ci id="algorithm2.4.4.m4.1.1.cmml" xref="algorithm2.4.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.4.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="algorithm2.4.4.m4.1d">italic_i</annotation></semantics></math>, number of iteration <math alttext="I" class="ltx_Math" display="inline" id="algorithm2.5.5.m5.1"><semantics id="algorithm2.5.5.m5.1a"><mi id="algorithm2.5.5.m5.1.1" xref="algorithm2.5.5.m5.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="algorithm2.5.5.m5.1b"><ci id="algorithm2.5.5.m5.1.1.cmml" xref="algorithm2.5.5.m5.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.5.5.m5.1c">I</annotation><annotation encoding="application/x-llamapun" id="algorithm2.5.5.m5.1d">italic_I</annotation></semantics></math>, batch size <math alttext="B" class="ltx_Math" display="inline" id="algorithm2.6.6.m6.1"><semantics id="algorithm2.6.6.m6.1a"><mi id="algorithm2.6.6.m6.1.1" xref="algorithm2.6.6.m6.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="algorithm2.6.6.m6.1b"><ci id="algorithm2.6.6.m6.1.1.cmml" xref="algorithm2.6.6.m6.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.6.6.m6.1c">B</annotation><annotation encoding="application/x-llamapun" id="algorithm2.6.6.m6.1d">italic_B</annotation></semantics></math>, target policy parameter <math alttext="\theta" class="ltx_Math" display="inline" id="algorithm2.7.7.m7.1"><semantics id="algorithm2.7.7.m7.1a"><mi id="algorithm2.7.7.m7.1.1" xref="algorithm2.7.7.m7.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="algorithm2.7.7.m7.1b"><ci id="algorithm2.7.7.m7.1.1.cmml" xref="algorithm2.7.7.m7.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.7.7.m7.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="algorithm2.7.7.m7.1d">italic_θ</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.10.10">
<span class="ltx_tag ltx_tag_listingline">1</span>
<math alttext="\mathcal{D}_{re}\leftarrow" class="ltx_Math" display="inline" id="algorithm2.8.8.m1.1"><semantics id="algorithm2.8.8.m1.1a"><mrow id="algorithm2.8.8.m1.1.1" xref="algorithm2.8.8.m1.1.1.cmml"><msub id="algorithm2.8.8.m1.1.1.2" xref="algorithm2.8.8.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.8.8.m1.1.1.2.2" xref="algorithm2.8.8.m1.1.1.2.2.cmml">𝒟</mi><mrow id="algorithm2.8.8.m1.1.1.2.3" xref="algorithm2.8.8.m1.1.1.2.3.cmml"><mi id="algorithm2.8.8.m1.1.1.2.3.2" xref="algorithm2.8.8.m1.1.1.2.3.2.cmml">r</mi><mo id="algorithm2.8.8.m1.1.1.2.3.1" xref="algorithm2.8.8.m1.1.1.2.3.1.cmml">⁢</mo><mi id="algorithm2.8.8.m1.1.1.2.3.3" xref="algorithm2.8.8.m1.1.1.2.3.3.cmml">e</mi></mrow></msub><mo id="algorithm2.8.8.m1.1.1.1" stretchy="false" xref="algorithm2.8.8.m1.1.1.1.cmml">←</mo><mi id="algorithm2.8.8.m1.1.1.3" xref="algorithm2.8.8.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.8.8.m1.1b"><apply id="algorithm2.8.8.m1.1.1.cmml" xref="algorithm2.8.8.m1.1.1"><ci id="algorithm2.8.8.m1.1.1.1.cmml" xref="algorithm2.8.8.m1.1.1.1">←</ci><apply id="algorithm2.8.8.m1.1.1.2.cmml" xref="algorithm2.8.8.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm2.8.8.m1.1.1.2.1.cmml" xref="algorithm2.8.8.m1.1.1.2">subscript</csymbol><ci id="algorithm2.8.8.m1.1.1.2.2.cmml" xref="algorithm2.8.8.m1.1.1.2.2">𝒟</ci><apply id="algorithm2.8.8.m1.1.1.2.3.cmml" xref="algorithm2.8.8.m1.1.1.2.3"><times id="algorithm2.8.8.m1.1.1.2.3.1.cmml" xref="algorithm2.8.8.m1.1.1.2.3.1"></times><ci id="algorithm2.8.8.m1.1.1.2.3.2.cmml" xref="algorithm2.8.8.m1.1.1.2.3.2">𝑟</ci><ci id="algorithm2.8.8.m1.1.1.2.3.3.cmml" xref="algorithm2.8.8.m1.1.1.2.3.3">𝑒</ci></apply></apply><csymbol cd="latexml" id="algorithm2.8.8.m1.1.1.3.cmml" xref="algorithm2.8.8.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.8.8.m1.1c">\mathcal{D}_{re}\leftarrow</annotation><annotation encoding="application/x-llamapun" id="algorithm2.8.8.m1.1d">caligraphic_D start_POSTSUBSCRIPT italic_r italic_e end_POSTSUBSCRIPT ←</annotation></semantics></math> top <math alttext="N" class="ltx_Math" display="inline" id="algorithm2.9.9.m2.1"><semantics id="algorithm2.9.9.m2.1a"><mi id="algorithm2.9.9.m2.1.1" xref="algorithm2.9.9.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="algorithm2.9.9.m2.1b"><ci id="algorithm2.9.9.m2.1.1.cmml" xref="algorithm2.9.9.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.9.9.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="algorithm2.9.9.m2.1d">italic_N</annotation></semantics></math> trajectories from <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="algorithm2.10.10.m3.1"><semantics id="algorithm2.10.10.m3.1a"><mi class="ltx_font_mathcaligraphic" id="algorithm2.10.10.m3.1.1" xref="algorithm2.10.10.m3.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="algorithm2.10.10.m3.1b"><ci id="algorithm2.10.10.m3.1.1.cmml" xref="algorithm2.10.10.m3.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.10.10.m3.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.10.10.m3.1d">caligraphic_D</annotation></semantics></math> ;
</div>
<div class="ltx_listingline" id="algorithm2.11.11">
<span class="ltx_tag ltx_tag_listingline">2</span>
<span class="ltx_text ltx_font_bold" id="algorithm2.11.11.2">for</span> <em class="ltx_emph ltx_font_italic" id="algorithm2.11.11.1">round <math alttext="1\cdots i" class="ltx_Math" display="inline" id="algorithm2.11.11.1.m1.1"><semantics id="algorithm2.11.11.1.m1.1a"><mrow id="algorithm2.11.11.1.m1.1.1" xref="algorithm2.11.11.1.m1.1.1.cmml"><mn id="algorithm2.11.11.1.m1.1.1.2" xref="algorithm2.11.11.1.m1.1.1.2.cmml">1</mn><mo id="algorithm2.11.11.1.m1.1.1.1" xref="algorithm2.11.11.1.m1.1.1.1.cmml">⁢</mo><mi id="algorithm2.11.11.1.m1.1.1.3" mathvariant="normal" xref="algorithm2.11.11.1.m1.1.1.3.cmml">⋯</mi><mo id="algorithm2.11.11.1.m1.1.1.1a" xref="algorithm2.11.11.1.m1.1.1.1.cmml">⁢</mo><mi id="algorithm2.11.11.1.m1.1.1.4" xref="algorithm2.11.11.1.m1.1.1.4.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.11.11.1.m1.1b"><apply id="algorithm2.11.11.1.m1.1.1.cmml" xref="algorithm2.11.11.1.m1.1.1"><times id="algorithm2.11.11.1.m1.1.1.1.cmml" xref="algorithm2.11.11.1.m1.1.1.1"></times><cn id="algorithm2.11.11.1.m1.1.1.2.cmml" type="integer" xref="algorithm2.11.11.1.m1.1.1.2">1</cn><ci id="algorithm2.11.11.1.m1.1.1.3.cmml" xref="algorithm2.11.11.1.m1.1.1.3">⋯</ci><ci id="algorithm2.11.11.1.m1.1.1.4.cmml" xref="algorithm2.11.11.1.m1.1.1.4">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.11.11.1.m1.1c">1\cdots i</annotation><annotation encoding="application/x-llamapun" id="algorithm2.11.11.1.m1.1d">1 ⋯ italic_i</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="algorithm2.11.11.3">do</span>
</div>
<div class="ltx_listingline" id="algorithm2.12.12">
<span class="ltx_tag ltx_tag_listingline">3</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Trajectory <math alttext="\tau\leftarrow\pi_{\theta}(\cdot|\textbf{s},\textbf{g}_{online})" class="ltx_math_unparsed" display="inline" id="algorithm2.12.12.m1.1"><semantics id="algorithm2.12.12.m1.1a"><mrow id="algorithm2.12.12.m1.1b"><mi id="algorithm2.12.12.m1.1.1">τ</mi><mo id="algorithm2.12.12.m1.1.2" stretchy="false">←</mo><msub id="algorithm2.12.12.m1.1.3"><mi id="algorithm2.12.12.m1.1.3.2">π</mi><mi id="algorithm2.12.12.m1.1.3.3">θ</mi></msub><mrow id="algorithm2.12.12.m1.1.4"><mo id="algorithm2.12.12.m1.1.4.1" stretchy="false">(</mo><mo id="algorithm2.12.12.m1.1.4.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="algorithm2.12.12.m1.1.4.3" rspace="0.167em" stretchy="false">|</mo><mtext class="ltx_mathvariant_bold" id="algorithm2.12.12.m1.1.4.4">s</mtext><mo id="algorithm2.12.12.m1.1.4.5">,</mo><msub id="algorithm2.12.12.m1.1.4.6"><mtext class="ltx_mathvariant_bold" id="algorithm2.12.12.m1.1.4.6.2">g</mtext><mrow id="algorithm2.12.12.m1.1.4.6.3"><mi id="algorithm2.12.12.m1.1.4.6.3.2">o</mi><mo id="algorithm2.12.12.m1.1.4.6.3.1">⁢</mo><mi id="algorithm2.12.12.m1.1.4.6.3.3">n</mi><mo id="algorithm2.12.12.m1.1.4.6.3.1a">⁢</mo><mi id="algorithm2.12.12.m1.1.4.6.3.4">l</mi><mo id="algorithm2.12.12.m1.1.4.6.3.1b">⁢</mo><mi id="algorithm2.12.12.m1.1.4.6.3.5">i</mi><mo id="algorithm2.12.12.m1.1.4.6.3.1c">⁢</mo><mi id="algorithm2.12.12.m1.1.4.6.3.6">n</mi><mo id="algorithm2.12.12.m1.1.4.6.3.1d">⁢</mo><mi id="algorithm2.12.12.m1.1.4.6.3.7">e</mi></mrow></msub><mo id="algorithm2.12.12.m1.1.4.7" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="algorithm2.12.12.m1.1c">\tau\leftarrow\pi_{\theta}(\cdot|\textbf{s},\textbf{g}_{online})</annotation><annotation encoding="application/x-llamapun" id="algorithm2.12.12.m1.1d">italic_τ ← italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( ⋅ | s , g start_POSTSUBSCRIPT italic_o italic_n italic_l italic_i italic_n italic_e end_POSTSUBSCRIPT )</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="algorithm2.13.13">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_typewriter" id="algorithm2.13.13.2">// </span><span class="ltx_text ltx_font_typewriter" id="algorithm2.13.13.1">if the <math alttext="\mathcal{D}_{re}" class="ltx_Math" display="inline" id="algorithm2.13.13.1.m1.1"><semantics id="algorithm2.13.13.1.m1.1a"><msub id="algorithm2.13.13.1.m1.1.1" xref="algorithm2.13.13.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.13.13.1.m1.1.1.2" xref="algorithm2.13.13.1.m1.1.1.2.cmml">𝒟</mi><mrow id="algorithm2.13.13.1.m1.1.1.3" xref="algorithm2.13.13.1.m1.1.1.3.cmml"><mi id="algorithm2.13.13.1.m1.1.1.3.2" xref="algorithm2.13.13.1.m1.1.1.3.2.cmml">r</mi><mo id="algorithm2.13.13.1.m1.1.1.3.1" xref="algorithm2.13.13.1.m1.1.1.3.1.cmml">⁢</mo><mi id="algorithm2.13.13.1.m1.1.1.3.3" xref="algorithm2.13.13.1.m1.1.1.3.3.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm2.13.13.1.m1.1b"><apply id="algorithm2.13.13.1.m1.1.1.cmml" xref="algorithm2.13.13.1.m1.1.1"><csymbol cd="ambiguous" id="algorithm2.13.13.1.m1.1.1.1.cmml" xref="algorithm2.13.13.1.m1.1.1">subscript</csymbol><ci id="algorithm2.13.13.1.m1.1.1.2.cmml" xref="algorithm2.13.13.1.m1.1.1.2">𝒟</ci><apply id="algorithm2.13.13.1.m1.1.1.3.cmml" xref="algorithm2.13.13.1.m1.1.1.3"><times id="algorithm2.13.13.1.m1.1.1.3.1.cmml" xref="algorithm2.13.13.1.m1.1.1.3.1"></times><ci id="algorithm2.13.13.1.m1.1.1.3.2.cmml" xref="algorithm2.13.13.1.m1.1.1.3.2">𝑟</ci><ci id="algorithm2.13.13.1.m1.1.1.3.3.cmml" xref="algorithm2.13.13.1.m1.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.13.13.1.m1.1c">\mathcal{D}_{re}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.13.13.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT italic_r italic_e end_POSTSUBSCRIPT</annotation></semantics></math> is full, the oldest trajectories will be removed.  </span>
</div>
<div class="ltx_listingline" id="algorithm2.14.14">
<span class="ltx_tag ltx_tag_listingline">4</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="\mathcal{D}_{re}\leftarrow\mathcal{D}_{re}\cup\tau" class="ltx_Math" display="inline" id="algorithm2.14.14.m1.1"><semantics id="algorithm2.14.14.m1.1a"><mrow id="algorithm2.14.14.m1.1.1" xref="algorithm2.14.14.m1.1.1.cmml"><msub id="algorithm2.14.14.m1.1.1.2" xref="algorithm2.14.14.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.14.14.m1.1.1.2.2" xref="algorithm2.14.14.m1.1.1.2.2.cmml">𝒟</mi><mrow id="algorithm2.14.14.m1.1.1.2.3" xref="algorithm2.14.14.m1.1.1.2.3.cmml"><mi id="algorithm2.14.14.m1.1.1.2.3.2" xref="algorithm2.14.14.m1.1.1.2.3.2.cmml">r</mi><mo id="algorithm2.14.14.m1.1.1.2.3.1" xref="algorithm2.14.14.m1.1.1.2.3.1.cmml">⁢</mo><mi id="algorithm2.14.14.m1.1.1.2.3.3" xref="algorithm2.14.14.m1.1.1.2.3.3.cmml">e</mi></mrow></msub><mo id="algorithm2.14.14.m1.1.1.1" stretchy="false" xref="algorithm2.14.14.m1.1.1.1.cmml">←</mo><mrow id="algorithm2.14.14.m1.1.1.3" xref="algorithm2.14.14.m1.1.1.3.cmml"><msub id="algorithm2.14.14.m1.1.1.3.2" xref="algorithm2.14.14.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.14.14.m1.1.1.3.2.2" xref="algorithm2.14.14.m1.1.1.3.2.2.cmml">𝒟</mi><mrow id="algorithm2.14.14.m1.1.1.3.2.3" xref="algorithm2.14.14.m1.1.1.3.2.3.cmml"><mi id="algorithm2.14.14.m1.1.1.3.2.3.2" xref="algorithm2.14.14.m1.1.1.3.2.3.2.cmml">r</mi><mo id="algorithm2.14.14.m1.1.1.3.2.3.1" xref="algorithm2.14.14.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="algorithm2.14.14.m1.1.1.3.2.3.3" xref="algorithm2.14.14.m1.1.1.3.2.3.3.cmml">e</mi></mrow></msub><mo id="algorithm2.14.14.m1.1.1.3.1" xref="algorithm2.14.14.m1.1.1.3.1.cmml">∪</mo><mi id="algorithm2.14.14.m1.1.1.3.3" xref="algorithm2.14.14.m1.1.1.3.3.cmml">τ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.14.14.m1.1b"><apply id="algorithm2.14.14.m1.1.1.cmml" xref="algorithm2.14.14.m1.1.1"><ci id="algorithm2.14.14.m1.1.1.1.cmml" xref="algorithm2.14.14.m1.1.1.1">←</ci><apply id="algorithm2.14.14.m1.1.1.2.cmml" xref="algorithm2.14.14.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm2.14.14.m1.1.1.2.1.cmml" xref="algorithm2.14.14.m1.1.1.2">subscript</csymbol><ci id="algorithm2.14.14.m1.1.1.2.2.cmml" xref="algorithm2.14.14.m1.1.1.2.2">𝒟</ci><apply id="algorithm2.14.14.m1.1.1.2.3.cmml" xref="algorithm2.14.14.m1.1.1.2.3"><times id="algorithm2.14.14.m1.1.1.2.3.1.cmml" xref="algorithm2.14.14.m1.1.1.2.3.1"></times><ci id="algorithm2.14.14.m1.1.1.2.3.2.cmml" xref="algorithm2.14.14.m1.1.1.2.3.2">𝑟</ci><ci id="algorithm2.14.14.m1.1.1.2.3.3.cmml" xref="algorithm2.14.14.m1.1.1.2.3.3">𝑒</ci></apply></apply><apply id="algorithm2.14.14.m1.1.1.3.cmml" xref="algorithm2.14.14.m1.1.1.3"><union id="algorithm2.14.14.m1.1.1.3.1.cmml" xref="algorithm2.14.14.m1.1.1.3.1"></union><apply id="algorithm2.14.14.m1.1.1.3.2.cmml" xref="algorithm2.14.14.m1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm2.14.14.m1.1.1.3.2.1.cmml" xref="algorithm2.14.14.m1.1.1.3.2">subscript</csymbol><ci id="algorithm2.14.14.m1.1.1.3.2.2.cmml" xref="algorithm2.14.14.m1.1.1.3.2.2">𝒟</ci><apply id="algorithm2.14.14.m1.1.1.3.2.3.cmml" xref="algorithm2.14.14.m1.1.1.3.2.3"><times id="algorithm2.14.14.m1.1.1.3.2.3.1.cmml" xref="algorithm2.14.14.m1.1.1.3.2.3.1"></times><ci id="algorithm2.14.14.m1.1.1.3.2.3.2.cmml" xref="algorithm2.14.14.m1.1.1.3.2.3.2">𝑟</ci><ci id="algorithm2.14.14.m1.1.1.3.2.3.3.cmml" xref="algorithm2.14.14.m1.1.1.3.2.3.3">𝑒</ci></apply></apply><ci id="algorithm2.14.14.m1.1.1.3.3.cmml" xref="algorithm2.14.14.m1.1.1.3.3">𝜏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.14.14.m1.1c">\mathcal{D}_{re}\leftarrow\mathcal{D}_{re}\cup\tau</annotation><annotation encoding="application/x-llamapun" id="algorithm2.14.14.m1.1d">caligraphic_D start_POSTSUBSCRIPT italic_r italic_e end_POSTSUBSCRIPT ← caligraphic_D start_POSTSUBSCRIPT italic_r italic_e end_POSTSUBSCRIPT ∪ italic_τ</annotation></semantics></math> ;
</div>
<div class="ltx_listingline" id="algorithm2.15.15">
<span class="ltx_tag ltx_tag_listingline">5</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Compute the trajectory sampling probability <math alttext="p(\tau)=|\tau|/\sum_{\tau\in\mathcal{D}}|\tau|" class="ltx_Math" display="inline" id="algorithm2.15.15.m1.3"><semantics id="algorithm2.15.15.m1.3a"><mrow id="algorithm2.15.15.m1.3.4" xref="algorithm2.15.15.m1.3.4.cmml"><mrow id="algorithm2.15.15.m1.3.4.2" xref="algorithm2.15.15.m1.3.4.2.cmml"><mi id="algorithm2.15.15.m1.3.4.2.2" xref="algorithm2.15.15.m1.3.4.2.2.cmml">p</mi><mo id="algorithm2.15.15.m1.3.4.2.1" xref="algorithm2.15.15.m1.3.4.2.1.cmml">⁢</mo><mrow id="algorithm2.15.15.m1.3.4.2.3.2" xref="algorithm2.15.15.m1.3.4.2.cmml"><mo id="algorithm2.15.15.m1.3.4.2.3.2.1" stretchy="false" xref="algorithm2.15.15.m1.3.4.2.cmml">(</mo><mi id="algorithm2.15.15.m1.1.1" xref="algorithm2.15.15.m1.1.1.cmml">τ</mi><mo id="algorithm2.15.15.m1.3.4.2.3.2.2" stretchy="false" xref="algorithm2.15.15.m1.3.4.2.cmml">)</mo></mrow></mrow><mo id="algorithm2.15.15.m1.3.4.1" xref="algorithm2.15.15.m1.3.4.1.cmml">=</mo><mrow id="algorithm2.15.15.m1.3.4.3" xref="algorithm2.15.15.m1.3.4.3.cmml"><mrow id="algorithm2.15.15.m1.3.4.3.2.2" xref="algorithm2.15.15.m1.3.4.3.2.1.cmml"><mo id="algorithm2.15.15.m1.3.4.3.2.2.1" stretchy="false" xref="algorithm2.15.15.m1.3.4.3.2.1.1.cmml">|</mo><mi id="algorithm2.15.15.m1.2.2" xref="algorithm2.15.15.m1.2.2.cmml">τ</mi><mo id="algorithm2.15.15.m1.3.4.3.2.2.2" stretchy="false" xref="algorithm2.15.15.m1.3.4.3.2.1.1.cmml">|</mo></mrow><mo id="algorithm2.15.15.m1.3.4.3.1" rspace="0.055em" xref="algorithm2.15.15.m1.3.4.3.1.cmml">/</mo><mrow id="algorithm2.15.15.m1.3.4.3.3" xref="algorithm2.15.15.m1.3.4.3.3.cmml"><msub id="algorithm2.15.15.m1.3.4.3.3.1" xref="algorithm2.15.15.m1.3.4.3.3.1.cmml"><mo id="algorithm2.15.15.m1.3.4.3.3.1.2" rspace="0em" xref="algorithm2.15.15.m1.3.4.3.3.1.2.cmml">∑</mo><mrow id="algorithm2.15.15.m1.3.4.3.3.1.3" xref="algorithm2.15.15.m1.3.4.3.3.1.3.cmml"><mi id="algorithm2.15.15.m1.3.4.3.3.1.3.2" xref="algorithm2.15.15.m1.3.4.3.3.1.3.2.cmml">τ</mi><mo id="algorithm2.15.15.m1.3.4.3.3.1.3.1" xref="algorithm2.15.15.m1.3.4.3.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="algorithm2.15.15.m1.3.4.3.3.1.3.3" xref="algorithm2.15.15.m1.3.4.3.3.1.3.3.cmml">𝒟</mi></mrow></msub><mrow id="algorithm2.15.15.m1.3.4.3.3.2.2" xref="algorithm2.15.15.m1.3.4.3.3.2.1.cmml"><mo id="algorithm2.15.15.m1.3.4.3.3.2.2.1" stretchy="false" xref="algorithm2.15.15.m1.3.4.3.3.2.1.1.cmml">|</mo><mi id="algorithm2.15.15.m1.3.3" xref="algorithm2.15.15.m1.3.3.cmml">τ</mi><mo id="algorithm2.15.15.m1.3.4.3.3.2.2.2" stretchy="false" xref="algorithm2.15.15.m1.3.4.3.3.2.1.1.cmml">|</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.15.15.m1.3b"><apply id="algorithm2.15.15.m1.3.4.cmml" xref="algorithm2.15.15.m1.3.4"><eq id="algorithm2.15.15.m1.3.4.1.cmml" xref="algorithm2.15.15.m1.3.4.1"></eq><apply id="algorithm2.15.15.m1.3.4.2.cmml" xref="algorithm2.15.15.m1.3.4.2"><times id="algorithm2.15.15.m1.3.4.2.1.cmml" xref="algorithm2.15.15.m1.3.4.2.1"></times><ci id="algorithm2.15.15.m1.3.4.2.2.cmml" xref="algorithm2.15.15.m1.3.4.2.2">𝑝</ci><ci id="algorithm2.15.15.m1.1.1.cmml" xref="algorithm2.15.15.m1.1.1">𝜏</ci></apply><apply id="algorithm2.15.15.m1.3.4.3.cmml" xref="algorithm2.15.15.m1.3.4.3"><divide id="algorithm2.15.15.m1.3.4.3.1.cmml" xref="algorithm2.15.15.m1.3.4.3.1"></divide><apply id="algorithm2.15.15.m1.3.4.3.2.1.cmml" xref="algorithm2.15.15.m1.3.4.3.2.2"><abs id="algorithm2.15.15.m1.3.4.3.2.1.1.cmml" xref="algorithm2.15.15.m1.3.4.3.2.2.1"></abs><ci id="algorithm2.15.15.m1.2.2.cmml" xref="algorithm2.15.15.m1.2.2">𝜏</ci></apply><apply id="algorithm2.15.15.m1.3.4.3.3.cmml" xref="algorithm2.15.15.m1.3.4.3.3"><apply id="algorithm2.15.15.m1.3.4.3.3.1.cmml" xref="algorithm2.15.15.m1.3.4.3.3.1"><csymbol cd="ambiguous" id="algorithm2.15.15.m1.3.4.3.3.1.1.cmml" xref="algorithm2.15.15.m1.3.4.3.3.1">subscript</csymbol><sum id="algorithm2.15.15.m1.3.4.3.3.1.2.cmml" xref="algorithm2.15.15.m1.3.4.3.3.1.2"></sum><apply id="algorithm2.15.15.m1.3.4.3.3.1.3.cmml" xref="algorithm2.15.15.m1.3.4.3.3.1.3"><in id="algorithm2.15.15.m1.3.4.3.3.1.3.1.cmml" xref="algorithm2.15.15.m1.3.4.3.3.1.3.1"></in><ci id="algorithm2.15.15.m1.3.4.3.3.1.3.2.cmml" xref="algorithm2.15.15.m1.3.4.3.3.1.3.2">𝜏</ci><ci id="algorithm2.15.15.m1.3.4.3.3.1.3.3.cmml" xref="algorithm2.15.15.m1.3.4.3.3.1.3.3">𝒟</ci></apply></apply><apply id="algorithm2.15.15.m1.3.4.3.3.2.1.cmml" xref="algorithm2.15.15.m1.3.4.3.3.2.2"><abs id="algorithm2.15.15.m1.3.4.3.3.2.1.1.cmml" xref="algorithm2.15.15.m1.3.4.3.3.2.2.1"></abs><ci id="algorithm2.15.15.m1.3.3.cmml" xref="algorithm2.15.15.m1.3.3">𝜏</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.15.15.m1.3c">p(\tau)=|\tau|/\sum_{\tau\in\mathcal{D}}|\tau|</annotation><annotation encoding="application/x-llamapun" id="algorithm2.15.15.m1.3d">italic_p ( italic_τ ) = | italic_τ | / ∑ start_POSTSUBSCRIPT italic_τ ∈ caligraphic_D end_POSTSUBSCRIPT | italic_τ |</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="algorithm2.16.16">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_bold" id="algorithm2.16.16.2">for</span> <em class="ltx_emph ltx_font_italic" id="algorithm2.16.16.1"><math alttext="t=1\cdots I" class="ltx_Math" display="inline" id="algorithm2.16.16.1.m1.1"><semantics id="algorithm2.16.16.1.m1.1a"><mrow id="algorithm2.16.16.1.m1.1.1" xref="algorithm2.16.16.1.m1.1.1.cmml"><mi id="algorithm2.16.16.1.m1.1.1.2" xref="algorithm2.16.16.1.m1.1.1.2.cmml">t</mi><mo id="algorithm2.16.16.1.m1.1.1.1" xref="algorithm2.16.16.1.m1.1.1.1.cmml">=</mo><mrow id="algorithm2.16.16.1.m1.1.1.3" xref="algorithm2.16.16.1.m1.1.1.3.cmml"><mn id="algorithm2.16.16.1.m1.1.1.3.2" xref="algorithm2.16.16.1.m1.1.1.3.2.cmml">1</mn><mo id="algorithm2.16.16.1.m1.1.1.3.1" xref="algorithm2.16.16.1.m1.1.1.3.1.cmml">⁢</mo><mi id="algorithm2.16.16.1.m1.1.1.3.3" mathvariant="normal" xref="algorithm2.16.16.1.m1.1.1.3.3.cmml">⋯</mi><mo id="algorithm2.16.16.1.m1.1.1.3.1a" xref="algorithm2.16.16.1.m1.1.1.3.1.cmml">⁢</mo><mi id="algorithm2.16.16.1.m1.1.1.3.4" xref="algorithm2.16.16.1.m1.1.1.3.4.cmml">I</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.16.16.1.m1.1b"><apply id="algorithm2.16.16.1.m1.1.1.cmml" xref="algorithm2.16.16.1.m1.1.1"><eq id="algorithm2.16.16.1.m1.1.1.1.cmml" xref="algorithm2.16.16.1.m1.1.1.1"></eq><ci id="algorithm2.16.16.1.m1.1.1.2.cmml" xref="algorithm2.16.16.1.m1.1.1.2">𝑡</ci><apply id="algorithm2.16.16.1.m1.1.1.3.cmml" xref="algorithm2.16.16.1.m1.1.1.3"><times id="algorithm2.16.16.1.m1.1.1.3.1.cmml" xref="algorithm2.16.16.1.m1.1.1.3.1"></times><cn id="algorithm2.16.16.1.m1.1.1.3.2.cmml" type="integer" xref="algorithm2.16.16.1.m1.1.1.3.2">1</cn><ci id="algorithm2.16.16.1.m1.1.1.3.3.cmml" xref="algorithm2.16.16.1.m1.1.1.3.3">⋯</ci><ci id="algorithm2.16.16.1.m1.1.1.3.4.cmml" xref="algorithm2.16.16.1.m1.1.1.3.4">𝐼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.16.16.1.m1.1c">t=1\cdots I</annotation><annotation encoding="application/x-llamapun" id="algorithm2.16.16.1.m1.1d">italic_t = 1 ⋯ italic_I</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="algorithm2.16.16.3">do</span>
</div>
<div class="ltx_listingline" id="algorithm2.18.18">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Sample <math alttext="B" class="ltx_Math" display="inline" id="algorithm2.17.17.m1.1"><semantics id="algorithm2.17.17.m1.1a"><mi id="algorithm2.17.17.m1.1.1" xref="algorithm2.17.17.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="algorithm2.17.17.m1.1b"><ci id="algorithm2.17.17.m1.1.1.cmml" xref="algorithm2.17.17.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.17.17.m1.1c">B</annotation><annotation encoding="application/x-llamapun" id="algorithm2.17.17.m1.1d">italic_B</annotation></semantics></math> trajectories from <math alttext="\mathcal{D}_{re}" class="ltx_Math" display="inline" id="algorithm2.18.18.m2.1"><semantics id="algorithm2.18.18.m2.1a"><msub id="algorithm2.18.18.m2.1.1" xref="algorithm2.18.18.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.18.18.m2.1.1.2" xref="algorithm2.18.18.m2.1.1.2.cmml">𝒟</mi><mrow id="algorithm2.18.18.m2.1.1.3" xref="algorithm2.18.18.m2.1.1.3.cmml"><mi id="algorithm2.18.18.m2.1.1.3.2" xref="algorithm2.18.18.m2.1.1.3.2.cmml">r</mi><mo id="algorithm2.18.18.m2.1.1.3.1" xref="algorithm2.18.18.m2.1.1.3.1.cmml">⁢</mo><mi id="algorithm2.18.18.m2.1.1.3.3" xref="algorithm2.18.18.m2.1.1.3.3.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm2.18.18.m2.1b"><apply id="algorithm2.18.18.m2.1.1.cmml" xref="algorithm2.18.18.m2.1.1"><csymbol cd="ambiguous" id="algorithm2.18.18.m2.1.1.1.cmml" xref="algorithm2.18.18.m2.1.1">subscript</csymbol><ci id="algorithm2.18.18.m2.1.1.2.cmml" xref="algorithm2.18.18.m2.1.1.2">𝒟</ci><apply id="algorithm2.18.18.m2.1.1.3.cmml" xref="algorithm2.18.18.m2.1.1.3"><times id="algorithm2.18.18.m2.1.1.3.1.cmml" xref="algorithm2.18.18.m2.1.1.3.1"></times><ci id="algorithm2.18.18.m2.1.1.3.2.cmml" xref="algorithm2.18.18.m2.1.1.3.2">𝑟</ci><ci id="algorithm2.18.18.m2.1.1.3.3.cmml" xref="algorithm2.18.18.m2.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.18.18.m2.1c">\mathcal{D}_{re}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.18.18.m2.1d">caligraphic_D start_POSTSUBSCRIPT italic_r italic_e end_POSTSUBSCRIPT</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="algorithm2.19.19">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_bold" id="algorithm2.19.19.2">for</span> <em class="ltx_emph ltx_font_italic" id="algorithm2.19.19.1">each trajectory <math alttext="\tau" class="ltx_Math" display="inline" id="algorithm2.19.19.1.m1.1"><semantics id="algorithm2.19.19.1.m1.1a"><mi id="algorithm2.19.19.1.m1.1.1" xref="algorithm2.19.19.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="algorithm2.19.19.1.m1.1b"><ci id="algorithm2.19.19.1.m1.1.1.cmml" xref="algorithm2.19.19.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.19.19.1.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="algorithm2.19.19.1.m1.1d">italic_τ</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="algorithm2.19.19.3">do</span>
</div>
<div class="ltx_listingline" id="algorithm2.20.20">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="\textbf{g}\leftarrow" class="ltx_Math" display="inline" id="algorithm2.20.20.m1.1"><semantics id="algorithm2.20.20.m1.1a"><mrow id="algorithm2.20.20.m1.1.1" xref="algorithm2.20.20.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="algorithm2.20.20.m1.1.1.2" xref="algorithm2.20.20.m1.1.1.2a.cmml">g</mtext><mo id="algorithm2.20.20.m1.1.1.1" stretchy="false" xref="algorithm2.20.20.m1.1.1.1.cmml">←</mo><mi id="algorithm2.20.20.m1.1.1.3" xref="algorithm2.20.20.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.20.20.m1.1b"><apply id="algorithm2.20.20.m1.1.1.cmml" xref="algorithm2.20.20.m1.1.1"><ci id="algorithm2.20.20.m1.1.1.1.cmml" xref="algorithm2.20.20.m1.1.1.1">←</ci><ci id="algorithm2.20.20.m1.1.1.2a.cmml" xref="algorithm2.20.20.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="algorithm2.20.20.m1.1.1.2.cmml" xref="algorithm2.20.20.m1.1.1.2">g</mtext></ci><csymbol cd="latexml" id="algorithm2.20.20.m1.1.1.3.cmml" xref="algorithm2.20.20.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.20.20.m1.1c">\textbf{g}\leftarrow</annotation><annotation encoding="application/x-llamapun" id="algorithm2.20.20.m1.1d">g ←</annotation></semantics></math> relabeling using <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#algorithm1" title="In 4.3. RTG Relabeling ‣ 4. Methodology ‣ Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">1</span></a>;
</div>
<div class="ltx_listingline" id="algorithm2.23.23">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="(\textbf{a},\textbf{s},\textbf{g})\leftarrow" class="ltx_Math" display="inline" id="algorithm2.21.21.m1.3"><semantics id="algorithm2.21.21.m1.3a"><mrow id="algorithm2.21.21.m1.3.4" xref="algorithm2.21.21.m1.3.4.cmml"><mrow id="algorithm2.21.21.m1.3.4.2.2" xref="algorithm2.21.21.m1.3.4.2.1.cmml"><mo id="algorithm2.21.21.m1.3.4.2.2.1" stretchy="false" xref="algorithm2.21.21.m1.3.4.2.1.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="algorithm2.21.21.m1.1.1" xref="algorithm2.21.21.m1.1.1a.cmml">a</mtext><mo id="algorithm2.21.21.m1.3.4.2.2.2" xref="algorithm2.21.21.m1.3.4.2.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="algorithm2.21.21.m1.2.2" xref="algorithm2.21.21.m1.2.2a.cmml">s</mtext><mo id="algorithm2.21.21.m1.3.4.2.2.3" xref="algorithm2.21.21.m1.3.4.2.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="algorithm2.21.21.m1.3.3" xref="algorithm2.21.21.m1.3.3a.cmml">g</mtext><mo id="algorithm2.21.21.m1.3.4.2.2.4" stretchy="false" xref="algorithm2.21.21.m1.3.4.2.1.cmml">)</mo></mrow><mo id="algorithm2.21.21.m1.3.4.1" stretchy="false" xref="algorithm2.21.21.m1.3.4.1.cmml">←</mo><mi id="algorithm2.21.21.m1.3.4.3" xref="algorithm2.21.21.m1.3.4.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.21.21.m1.3b"><apply id="algorithm2.21.21.m1.3.4.cmml" xref="algorithm2.21.21.m1.3.4"><ci id="algorithm2.21.21.m1.3.4.1.cmml" xref="algorithm2.21.21.m1.3.4.1">←</ci><vector id="algorithm2.21.21.m1.3.4.2.1.cmml" xref="algorithm2.21.21.m1.3.4.2.2"><ci id="algorithm2.21.21.m1.1.1a.cmml" xref="algorithm2.21.21.m1.1.1"><mtext class="ltx_mathvariant_bold" id="algorithm2.21.21.m1.1.1.cmml" xref="algorithm2.21.21.m1.1.1">a</mtext></ci><ci id="algorithm2.21.21.m1.2.2a.cmml" xref="algorithm2.21.21.m1.2.2"><mtext class="ltx_mathvariant_bold" id="algorithm2.21.21.m1.2.2.cmml" xref="algorithm2.21.21.m1.2.2">s</mtext></ci><ci id="algorithm2.21.21.m1.3.3a.cmml" xref="algorithm2.21.21.m1.3.3"><mtext class="ltx_mathvariant_bold" id="algorithm2.21.21.m1.3.3.cmml" xref="algorithm2.21.21.m1.3.3">g</mtext></ci></vector><csymbol cd="latexml" id="algorithm2.21.21.m1.3.4.3.cmml" xref="algorithm2.21.21.m1.3.4.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.21.21.m1.3c">(\textbf{a},\textbf{s},\textbf{g})\leftarrow</annotation><annotation encoding="application/x-llamapun" id="algorithm2.21.21.m1.3d">( a , s , g ) ←</annotation></semantics></math> a length of <math alttext="K" class="ltx_Math" display="inline" id="algorithm2.22.22.m2.1"><semantics id="algorithm2.22.22.m2.1a"><mi id="algorithm2.22.22.m2.1.1" xref="algorithm2.22.22.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="algorithm2.22.22.m2.1b"><ci id="algorithm2.22.22.m2.1.1.cmml" xref="algorithm2.22.22.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.22.22.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="algorithm2.22.22.m2.1d">italic_K</annotation></semantics></math> sub-trajectory uniformly sampled from <math alttext="\tau" class="ltx_Math" display="inline" id="algorithm2.23.23.m3.1"><semantics id="algorithm2.23.23.m3.1a"><mi id="algorithm2.23.23.m3.1.1" xref="algorithm2.23.23.m3.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="algorithm2.23.23.m3.1b"><ci id="algorithm2.23.23.m3.1.1.cmml" xref="algorithm2.23.23.m3.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.23.23.m3.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="algorithm2.23.23.m3.1d">italic_τ</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="algorithm2.25.26">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm2.25.27">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div class="ltx_listingline" id="algorithm2.25.25">
<span class="ltx_tag ltx_tag_listingline">13</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="\theta\leftarrow" class="ltx_Math" display="inline" id="algorithm2.24.24.m1.1"><semantics id="algorithm2.24.24.m1.1a"><mrow id="algorithm2.24.24.m1.1.1" xref="algorithm2.24.24.m1.1.1.cmml"><mi id="algorithm2.24.24.m1.1.1.2" xref="algorithm2.24.24.m1.1.1.2.cmml">θ</mi><mo id="algorithm2.24.24.m1.1.1.1" stretchy="false" xref="algorithm2.24.24.m1.1.1.1.cmml">←</mo><mi id="algorithm2.24.24.m1.1.1.3" xref="algorithm2.24.24.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.24.24.m1.1b"><apply id="algorithm2.24.24.m1.1.1.cmml" xref="algorithm2.24.24.m1.1.1"><ci id="algorithm2.24.24.m1.1.1.1.cmml" xref="algorithm2.24.24.m1.1.1.1">←</ci><ci id="algorithm2.24.24.m1.1.1.2.cmml" xref="algorithm2.24.24.m1.1.1.2">𝜃</ci><csymbol cd="latexml" id="algorithm2.24.24.m1.1.1.3.cmml" xref="algorithm2.24.24.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.24.24.m1.1c">\theta\leftarrow</annotation><annotation encoding="application/x-llamapun" id="algorithm2.24.24.m1.1d">italic_θ ←</annotation></semantics></math> one gradient update using the sampled <math alttext="(\textbf{a},\textbf{s},\textbf{g})" class="ltx_Math" display="inline" id="algorithm2.25.25.m2.3"><semantics id="algorithm2.25.25.m2.3a"><mrow id="algorithm2.25.25.m2.3.4.2" xref="algorithm2.25.25.m2.3.4.1.cmml"><mo id="algorithm2.25.25.m2.3.4.2.1" stretchy="false" xref="algorithm2.25.25.m2.3.4.1.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="algorithm2.25.25.m2.1.1" xref="algorithm2.25.25.m2.1.1a.cmml">a</mtext><mo id="algorithm2.25.25.m2.3.4.2.2" xref="algorithm2.25.25.m2.3.4.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="algorithm2.25.25.m2.2.2" xref="algorithm2.25.25.m2.2.2a.cmml">s</mtext><mo id="algorithm2.25.25.m2.3.4.2.3" xref="algorithm2.25.25.m2.3.4.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="algorithm2.25.25.m2.3.3" xref="algorithm2.25.25.m2.3.3a.cmml">g</mtext><mo id="algorithm2.25.25.m2.3.4.2.4" stretchy="false" xref="algorithm2.25.25.m2.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.25.25.m2.3b"><vector id="algorithm2.25.25.m2.3.4.1.cmml" xref="algorithm2.25.25.m2.3.4.2"><ci id="algorithm2.25.25.m2.1.1a.cmml" xref="algorithm2.25.25.m2.1.1"><mtext class="ltx_mathvariant_bold" id="algorithm2.25.25.m2.1.1.cmml" xref="algorithm2.25.25.m2.1.1">a</mtext></ci><ci id="algorithm2.25.25.m2.2.2a.cmml" xref="algorithm2.25.25.m2.2.2"><mtext class="ltx_mathvariant_bold" id="algorithm2.25.25.m2.2.2.cmml" xref="algorithm2.25.25.m2.2.2">s</mtext></ci><ci id="algorithm2.25.25.m2.3.3a.cmml" xref="algorithm2.25.25.m2.3.3"><mtext class="ltx_mathvariant_bold" id="algorithm2.25.25.m2.3.3.cmml" xref="algorithm2.25.25.m2.3.3">g</mtext></ci></vector></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.25.25.m2.3c">(\textbf{a},\textbf{s},\textbf{g})</annotation><annotation encoding="application/x-llamapun" id="algorithm2.25.25.m2.3d">( a , s , g )</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="algorithm2.25.28">
<span class="ltx_tag ltx_tag_listingline">14</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm2.25.29">
<span class="ltx_tag ltx_tag_listingline">15</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div class="ltx_listingline" id="algorithm2.25.30">
<span class="ltx_tag ltx_tag_listingline">16</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div class="ltx_listingline" id="algorithm2.25.31">
<span class="ltx_tag ltx_tag_listingline">17</span> end for
</div>
<div class="ltx_listingline" id="algorithm2.25.32">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="algorithm2.27.1.1">Algorithm 2</span> </span>Overall training algorithm</figcaption>
</figure>
<div class="ltx_para" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.2">In our implementation, both the online goal <math alttext="\textbf{g}_{online}" class="ltx_Math" display="inline" id="S4.SS4.p2.1.m1.1"><semantics id="S4.SS4.p2.1.m1.1a"><msub id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS4.p2.1.m1.1.1.2" xref="S4.SS4.p2.1.m1.1.1.2a.cmml">g</mtext><mrow id="S4.SS4.p2.1.m1.1.1.3" xref="S4.SS4.p2.1.m1.1.1.3.cmml"><mi id="S4.SS4.p2.1.m1.1.1.3.2" xref="S4.SS4.p2.1.m1.1.1.3.2.cmml">o</mi><mo id="S4.SS4.p2.1.m1.1.1.3.1" xref="S4.SS4.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p2.1.m1.1.1.3.3" xref="S4.SS4.p2.1.m1.1.1.3.3.cmml">n</mi><mo id="S4.SS4.p2.1.m1.1.1.3.1a" xref="S4.SS4.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p2.1.m1.1.1.3.4" xref="S4.SS4.p2.1.m1.1.1.3.4.cmml">l</mi><mo id="S4.SS4.p2.1.m1.1.1.3.1b" xref="S4.SS4.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p2.1.m1.1.1.3.5" xref="S4.SS4.p2.1.m1.1.1.3.5.cmml">i</mi><mo id="S4.SS4.p2.1.m1.1.1.3.1c" xref="S4.SS4.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p2.1.m1.1.1.3.6" xref="S4.SS4.p2.1.m1.1.1.3.6.cmml">n</mi><mo id="S4.SS4.p2.1.m1.1.1.3.1d" xref="S4.SS4.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p2.1.m1.1.1.3.7" xref="S4.SS4.p2.1.m1.1.1.3.7.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><apply id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.1.m1.1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.p2.1.m1.1.1.2a.cmml" xref="S4.SS4.p2.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS4.p2.1.m1.1.1.2.cmml" xref="S4.SS4.p2.1.m1.1.1.2">g</mtext></ci><apply id="S4.SS4.p2.1.m1.1.1.3.cmml" xref="S4.SS4.p2.1.m1.1.1.3"><times id="S4.SS4.p2.1.m1.1.1.3.1.cmml" xref="S4.SS4.p2.1.m1.1.1.3.1"></times><ci id="S4.SS4.p2.1.m1.1.1.3.2.cmml" xref="S4.SS4.p2.1.m1.1.1.3.2">𝑜</ci><ci id="S4.SS4.p2.1.m1.1.1.3.3.cmml" xref="S4.SS4.p2.1.m1.1.1.3.3">𝑛</ci><ci id="S4.SS4.p2.1.m1.1.1.3.4.cmml" xref="S4.SS4.p2.1.m1.1.1.3.4">𝑙</ci><ci id="S4.SS4.p2.1.m1.1.1.3.5.cmml" xref="S4.SS4.p2.1.m1.1.1.3.5">𝑖</ci><ci id="S4.SS4.p2.1.m1.1.1.3.6.cmml" xref="S4.SS4.p2.1.m1.1.1.3.6">𝑛</ci><ci id="S4.SS4.p2.1.m1.1.1.3.7.cmml" xref="S4.SS4.p2.1.m1.1.1.3.7">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">\textbf{g}_{online}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.1.m1.1d">g start_POSTSUBSCRIPT italic_o italic_n italic_l italic_i italic_n italic_e end_POSTSUBSCRIPT</annotation></semantics></math> and the context length <math alttext="K" class="ltx_Math" display="inline" id="S4.SS4.p2.2.m2.1"><semantics id="S4.SS4.p2.2.m2.1a"><mi id="S4.SS4.p2.2.m2.1.1" xref="S4.SS4.p2.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.2.m2.1b"><ci id="S4.SS4.p2.2.m2.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.2.m2.1d">italic_K</annotation></semantics></math> are set to 2, a decision whose rationale and implications are further explored in our hyperparameter study.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Experiments</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this section, we report the outcomes of experiments that focus on
the following three main research questions:</p>
<ul class="ltx_itemize" id="S5.I1">
<li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i1.p1">
<p class="ltx_p" id="S5.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i1.p1.1.1">RQ1</span>: How does EDT4Rec compare with other DT-based methods and traditional deep RL algorithms in online recommendation environments and offline dataset environments?</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i2.p1">
<p class="ltx_p" id="S5.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i2.p1.1.1">RQ2</span>: How do the hyper-parameters affect the performance in the <em class="ltx_emph ltx_font_italic" id="S5.I1.i2.p1.1.2">online</em> simulation environment?</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i3.p1">
<p class="ltx_p" id="S5.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i3.p1.1.1">RQ3</span>: How does each component in EDT4Rec contribute to the final performance in the <em class="ltx_emph ltx_font_italic" id="S5.I1.i3.p1.1.2">online</em> simulation environment?</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S5.p1.2">We concentrate our hyper-parameters and ablation study (i.e., RQ2 and RQ3) on online simulation settings since they are more closely suited to real-world environments, whereas offline datasets are fixed and do not reflect users’ dynamic interests.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>Datasets and Environments</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">In this section, we evaluate the performance of our proposed algorithm, EDT4Rec, against other state-of-the-art algorithms, employing both real-world datasets and an online simulation environment. We first introduce six diverse, public real-world datasets from various recommendation domains for our offline experiments:</p>
<ul class="ltx_itemize" id="S5.I2">
<li class="ltx_item" id="S5.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i1.p1">
<p class="ltx_p" id="S5.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i1.p1.1.1">Kuairand-1k-15policies</span> <cite class="ltx_cite ltx_citemacro_citep">(Gao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib14" title="">2022</a>)</cite>: An unbiased sequential recommendation dataset sourced from recommendation logs of a video-sharing mobile app.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i2.p1">
<p class="ltx_p" id="S5.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i2.p1.1.1">LibraryThing</span>: This online service facilitates book cataloging for users <span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://www.librarything.com/</span></span></span>. It is notable for its inclusion of social relationships between users, making it ideal for studying social recommendation algorithms.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i3.p1">
<p class="ltx_p" id="S5.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i3.p1.1.1">MovieLens</span>: We utilize the MovieLens-20M dataset<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>https://grouplens.org/datasets/movielens/20m/</span></span></span>, a widely recognized benchmark in recommender system research.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i4.p1">
<p class="ltx_p" id="S5.I2.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i4.p1.1.1">GoodReads</span>: Sourced from the book review website <span class="ltx_text ltx_font_italic" id="S5.I2.i4.p1.1.2">GoodReads</span>, this dataset, compiled by <cite class="ltx_cite ltx_citemacro_citep">(Wan and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib24" title="">2018</a>)</cite>, includes various user interactions like ratings and reviews.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i5.p1">
<p class="ltx_p" id="S5.I2.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i5.p1.1.1">Netflix</span>: Originating from the Netflix Prize Challenge<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>https://www.kaggle.com/datasets/netflix-inc/netflix-prize-data</span></span></span>, this well-known dataset primarily consists of user ratings.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i6.p1">
<p class="ltx_p" id="S5.I2.i6.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i6.p1.1.1">Book-Crossing</span>: Similar to MovieLens, this book-related dataset by <cite class="ltx_cite ltx_citemacro_citep">(Ziegler et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib31" title="">2005</a>)</cite> focuses on rating information.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1">To evaluate EDT4Rec’s performance, we transformed the offline datasets into simulation environments that allow for interactive reinforcement learning experiences. This conversion aligns with methodologies outlined in existing research <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib7" title="">2020</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib25" title="">2023</a>; Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib27" title="">2023</a>)</cite>. Specifically, user interactions are converted into binary click behaviors to construct trajectories. For datasets containing ratings, any rating exceeding 75% of the maximum rating is considered positive feedback, while the rest are treated as negative. The evaluation process adheres to the standards established in previous works <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib25" title="">2023</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S5.SS1.p3">
<p class="ltx_p" id="S5.SS1.p3.1">In addition, we also experiment on a real online simulation platform to validate the proposed method. We use VirtualTB <cite class="ltx_cite ltx_citemacro_citep">(Shi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib23" title="">2019</a>)</cite> as the major online platform in this work. In terms of evaluation metrics, we use the click-through rate (CTR) for the online simulation platform as the CTR is one of the built-in evaluation metrics of the VirtualTB simulation environment.
For offline dataset evaluation, we employ a variety of evaluation metrics, including recall, precision, and normalized discounted cumulative gain (nDCG).</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>Baselines</h3>
<figure class="ltx_table" id="S5.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T1.128.1.1" style="font-size:90%;">Table 1</span>. </span><span class="ltx_text" id="S5.T1.129.2" style="font-size:90%;">The overall results of our model comparison with several state-of-the-art models on different datasets. The highest results are in bold and significant under the 95% confidence interval</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_inline-block ltx_figure_panel ltx_minipage ltx_align_middle ltx_transformed_outer" id="S5.T1.42.42" style="width:411.9pt;height:132.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-48.1pt,14.7pt) scale(0.818277890174438,0.818277890174438) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T1.42.42.42">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T1.42.42.42.43.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.42.42.42.43.1.1">Dataset</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3" id="S5.T1.42.42.42.43.1.2">Kuairand-1k</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="3" id="S5.T1.42.42.42.43.1.3">Librarything</th>
</tr>
<tr class="ltx_tr" id="S5.T1.42.42.42.44.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.42.42.42.44.2.1">Measure (%)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T1.42.42.42.44.2.2">Recall</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T1.42.42.42.44.2.3">Precision</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T1.42.42.42.44.2.4">nDCG</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T1.42.42.42.44.2.5">Recall</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T1.42.42.42.44.2.6">Precision</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T1.42.42.42.44.2.7">nDCG</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.6.6.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.6.6.6.6.7">DDPG</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.1.1.1">29.441 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.1.1.1.1.1.m1.1"><semantics id="S5.T1.1.1.1.1.1.m1.1a"><mo id="S5.T1.1.1.1.1.1.m1.1.1" xref="S5.T1.1.1.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.1.1.1.1.1.m1.1b"><csymbol cd="latexml" id="S5.T1.1.1.1.1.1.m1.1.1.cmml" xref="S5.T1.1.1.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.1.1.1.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.1.1.1.1.1.m1.1d">±</annotation></semantics></math> 0.321</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.2.2.2.2.2">28.774 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.2.2.2.2.2.m1.1"><semantics id="S5.T1.2.2.2.2.2.m1.1a"><mo id="S5.T1.2.2.2.2.2.m1.1.1" xref="S5.T1.2.2.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.2.2.2.2.2.m1.1b"><csymbol cd="latexml" id="S5.T1.2.2.2.2.2.m1.1.1.cmml" xref="S5.T1.2.2.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.2.2.2.2.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.2.2.2.2.2.m1.1d">±</annotation></semantics></math> 0.233</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.3.3.3.3.3">29.773 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.3.3.3.3.3.m1.1"><semantics id="S5.T1.3.3.3.3.3.m1.1a"><mo id="S5.T1.3.3.3.3.3.m1.1.1" xref="S5.T1.3.3.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.3.3.3.3.3.m1.1b"><csymbol cd="latexml" id="S5.T1.3.3.3.3.3.m1.1.1.cmml" xref="S5.T1.3.3.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.3.3.3.3.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.3.3.3.3.3.m1.1d">±</annotation></semantics></math> 0.298</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.4.4.4.4.4">12.128 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.4.4.4.4.4.m1.1"><semantics id="S5.T1.4.4.4.4.4.m1.1a"><mo id="S5.T1.4.4.4.4.4.m1.1.1" xref="S5.T1.4.4.4.4.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.4.4.4.4.4.m1.1b"><csymbol cd="latexml" id="S5.T1.4.4.4.4.4.m1.1.1.cmml" xref="S5.T1.4.4.4.4.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.4.4.4.4.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.4.4.4.4.4.m1.1d">±</annotation></semantics></math> 0.241</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.5.5.5.5.5">12.451 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.5.5.5.5.5.m1.1"><semantics id="S5.T1.5.5.5.5.5.m1.1a"><mo id="S5.T1.5.5.5.5.5.m1.1.1" xref="S5.T1.5.5.5.5.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.5.5.5.5.5.m1.1b"><csymbol cd="latexml" id="S5.T1.5.5.5.5.5.m1.1.1.cmml" xref="S5.T1.5.5.5.5.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.5.5.5.5.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.5.5.5.5.5.m1.1d">±</annotation></semantics></math> 0.242</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.6.6.6.6">13.925 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.6.6.6.6.6.m1.1"><semantics id="S5.T1.6.6.6.6.6.m1.1a"><mo id="S5.T1.6.6.6.6.6.m1.1.1" xref="S5.T1.6.6.6.6.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.6.6.6.6.6.m1.1b"><csymbol cd="latexml" id="S5.T1.6.6.6.6.6.m1.1.1.cmml" xref="S5.T1.6.6.6.6.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.6.6.6.6.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.6.6.6.6.6.m1.1d">±</annotation></semantics></math> 0.252</td>
</tr>
<tr class="ltx_tr" id="S5.T1.12.12.12.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.12.12.12.12.7">SAC</th>
<td class="ltx_td ltx_align_center" id="S5.T1.7.7.7.7.1">29.204 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.7.7.7.7.1.m1.1"><semantics id="S5.T1.7.7.7.7.1.m1.1a"><mo id="S5.T1.7.7.7.7.1.m1.1.1" xref="S5.T1.7.7.7.7.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.7.7.7.7.1.m1.1b"><csymbol cd="latexml" id="S5.T1.7.7.7.7.1.m1.1.1.cmml" xref="S5.T1.7.7.7.7.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.7.7.7.7.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.7.7.7.7.1.m1.1d">±</annotation></semantics></math> 0.292</td>
<td class="ltx_td ltx_align_center" id="S5.T1.8.8.8.8.2">28.162 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.8.8.8.8.2.m1.1"><semantics id="S5.T1.8.8.8.8.2.m1.1a"><mo id="S5.T1.8.8.8.8.2.m1.1.1" xref="S5.T1.8.8.8.8.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.8.8.8.8.2.m1.1b"><csymbol cd="latexml" id="S5.T1.8.8.8.8.2.m1.1.1.cmml" xref="S5.T1.8.8.8.8.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.8.8.8.8.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.8.8.8.8.2.m1.1d">±</annotation></semantics></math> 0.205</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.9.9.9.9.3">29.455 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.9.9.9.9.3.m1.1"><semantics id="S5.T1.9.9.9.9.3.m1.1a"><mo id="S5.T1.9.9.9.9.3.m1.1.1" xref="S5.T1.9.9.9.9.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.9.9.9.9.3.m1.1b"><csymbol cd="latexml" id="S5.T1.9.9.9.9.3.m1.1.1.cmml" xref="S5.T1.9.9.9.9.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.9.9.9.9.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.9.9.9.9.3.m1.1d">±</annotation></semantics></math> 0.201</td>
<td class="ltx_td ltx_align_center" id="S5.T1.10.10.10.10.4">12.028 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.10.10.10.10.4.m1.1"><semantics id="S5.T1.10.10.10.10.4.m1.1a"><mo id="S5.T1.10.10.10.10.4.m1.1.1" xref="S5.T1.10.10.10.10.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.10.10.10.10.4.m1.1b"><csymbol cd="latexml" id="S5.T1.10.10.10.10.4.m1.1.1.cmml" xref="S5.T1.10.10.10.10.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.10.10.10.10.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.10.10.10.10.4.m1.1d">±</annotation></semantics></math> 0.237</td>
<td class="ltx_td ltx_align_center" id="S5.T1.11.11.11.11.5">12.311 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.11.11.11.11.5.m1.1"><semantics id="S5.T1.11.11.11.11.5.m1.1a"><mo id="S5.T1.11.11.11.11.5.m1.1.1" xref="S5.T1.11.11.11.11.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.11.11.11.11.5.m1.1b"><csymbol cd="latexml" id="S5.T1.11.11.11.11.5.m1.1.1.cmml" xref="S5.T1.11.11.11.11.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.11.11.11.11.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.11.11.11.11.5.m1.1d">±</annotation></semantics></math> 0.255</td>
<td class="ltx_td ltx_align_center" id="S5.T1.12.12.12.12.6">13.125 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.12.12.12.12.6.m1.1"><semantics id="S5.T1.12.12.12.12.6.m1.1a"><mo id="S5.T1.12.12.12.12.6.m1.1.1" xref="S5.T1.12.12.12.12.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.12.12.12.12.6.m1.1b"><csymbol cd="latexml" id="S5.T1.12.12.12.12.6.m1.1.1.cmml" xref="S5.T1.12.12.12.12.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.12.12.12.12.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.12.12.12.12.6.m1.1d">±</annotation></semantics></math> 0.204</td>
</tr>
<tr class="ltx_tr" id="S5.T1.18.18.18.18">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.18.18.18.18.7">TD3</th>
<td class="ltx_td ltx_align_center" id="S5.T1.13.13.13.13.1">29.115 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.13.13.13.13.1.m1.1"><semantics id="S5.T1.13.13.13.13.1.m1.1a"><mo id="S5.T1.13.13.13.13.1.m1.1.1" xref="S5.T1.13.13.13.13.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.13.13.13.13.1.m1.1b"><csymbol cd="latexml" id="S5.T1.13.13.13.13.1.m1.1.1.cmml" xref="S5.T1.13.13.13.13.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.13.13.13.13.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.13.13.13.13.1.m1.1d">±</annotation></semantics></math> 0.281</td>
<td class="ltx_td ltx_align_center" id="S5.T1.14.14.14.14.2">27.989 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.14.14.14.14.2.m1.1"><semantics id="S5.T1.14.14.14.14.2.m1.1a"><mo id="S5.T1.14.14.14.14.2.m1.1.1" xref="S5.T1.14.14.14.14.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.14.14.14.14.2.m1.1b"><csymbol cd="latexml" id="S5.T1.14.14.14.14.2.m1.1.1.cmml" xref="S5.T1.14.14.14.14.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.14.14.14.14.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.14.14.14.14.2.m1.1d">±</annotation></semantics></math> 0.247</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.15.15.15.15.3">29.107 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.15.15.15.15.3.m1.1"><semantics id="S5.T1.15.15.15.15.3.m1.1a"><mo id="S5.T1.15.15.15.15.3.m1.1.1" xref="S5.T1.15.15.15.15.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.15.15.15.15.3.m1.1b"><csymbol cd="latexml" id="S5.T1.15.15.15.15.3.m1.1.1.cmml" xref="S5.T1.15.15.15.15.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.15.15.15.15.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.15.15.15.15.3.m1.1d">±</annotation></semantics></math> 0.188</td>
<td class="ltx_td ltx_align_center" id="S5.T1.16.16.16.16.4">11.943 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.16.16.16.16.4.m1.1"><semantics id="S5.T1.16.16.16.16.4.m1.1a"><mo id="S5.T1.16.16.16.16.4.m1.1.1" xref="S5.T1.16.16.16.16.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.16.16.16.16.4.m1.1b"><csymbol cd="latexml" id="S5.T1.16.16.16.16.4.m1.1.1.cmml" xref="S5.T1.16.16.16.16.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.16.16.16.16.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.16.16.16.16.4.m1.1d">±</annotation></semantics></math> 0.205</td>
<td class="ltx_td ltx_align_center" id="S5.T1.17.17.17.17.5">12.018 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.17.17.17.17.5.m1.1"><semantics id="S5.T1.17.17.17.17.5.m1.1a"><mo id="S5.T1.17.17.17.17.5.m1.1.1" xref="S5.T1.17.17.17.17.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.17.17.17.17.5.m1.1b"><csymbol cd="latexml" id="S5.T1.17.17.17.17.5.m1.1.1.cmml" xref="S5.T1.17.17.17.17.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.17.17.17.17.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.17.17.17.17.5.m1.1d">±</annotation></semantics></math> 0.278</td>
<td class="ltx_td ltx_align_center" id="S5.T1.18.18.18.18.6">12.878 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.18.18.18.18.6.m1.1"><semantics id="S5.T1.18.18.18.18.6.m1.1a"><mo id="S5.T1.18.18.18.18.6.m1.1.1" xref="S5.T1.18.18.18.18.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.18.18.18.18.6.m1.1b"><csymbol cd="latexml" id="S5.T1.18.18.18.18.6.m1.1.1.cmml" xref="S5.T1.18.18.18.18.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.18.18.18.18.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.18.18.18.18.6.m1.1d">±</annotation></semantics></math> 0.218</td>
</tr>
<tr class="ltx_tr" id="S5.T1.24.24.24.24">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.24.24.24.24.7">DT</th>
<td class="ltx_td ltx_align_center" id="S5.T1.19.19.19.19.1">30.082 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.19.19.19.19.1.m1.1"><semantics id="S5.T1.19.19.19.19.1.m1.1a"><mo id="S5.T1.19.19.19.19.1.m1.1.1" xref="S5.T1.19.19.19.19.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.19.19.19.19.1.m1.1b"><csymbol cd="latexml" id="S5.T1.19.19.19.19.1.m1.1.1.cmml" xref="S5.T1.19.19.19.19.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.19.19.19.19.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.19.19.19.19.1.m1.1d">±</annotation></semantics></math> 0.212</td>
<td class="ltx_td ltx_align_center" id="S5.T1.20.20.20.20.2">29.951 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.20.20.20.20.2.m1.1"><semantics id="S5.T1.20.20.20.20.2.m1.1a"><mo id="S5.T1.20.20.20.20.2.m1.1.1" xref="S5.T1.20.20.20.20.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.20.20.20.20.2.m1.1b"><csymbol cd="latexml" id="S5.T1.20.20.20.20.2.m1.1.1.cmml" xref="S5.T1.20.20.20.20.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.20.20.20.20.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.20.20.20.20.2.m1.1d">±</annotation></semantics></math> 0.215</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.21.21.21.21.3">30.134 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.21.21.21.21.3.m1.1"><semantics id="S5.T1.21.21.21.21.3.m1.1a"><mo id="S5.T1.21.21.21.21.3.m1.1.1" xref="S5.T1.21.21.21.21.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.21.21.21.21.3.m1.1b"><csymbol cd="latexml" id="S5.T1.21.21.21.21.3.m1.1.1.cmml" xref="S5.T1.21.21.21.21.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.21.21.21.21.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.21.21.21.21.3.m1.1d">±</annotation></semantics></math> 0.160</td>
<td class="ltx_td ltx_align_center" id="S5.T1.22.22.22.22.4">14.225<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.22.22.22.22.4.m1.1"><semantics id="S5.T1.22.22.22.22.4.m1.1a"><mo id="S5.T1.22.22.22.22.4.m1.1.1" xref="S5.T1.22.22.22.22.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.22.22.22.22.4.m1.1b"><csymbol cd="latexml" id="S5.T1.22.22.22.22.4.m1.1.1.cmml" xref="S5.T1.22.22.22.22.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.22.22.22.22.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.22.22.22.22.4.m1.1d">±</annotation></semantics></math> 0.147</td>
<td class="ltx_td ltx_align_center" id="S5.T1.23.23.23.23.5">13.967 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.23.23.23.23.5.m1.1"><semantics id="S5.T1.23.23.23.23.5.m1.1a"><mo id="S5.T1.23.23.23.23.5.m1.1.1" xref="S5.T1.23.23.23.23.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.23.23.23.23.5.m1.1b"><csymbol cd="latexml" id="S5.T1.23.23.23.23.5.m1.1.1.cmml" xref="S5.T1.23.23.23.23.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.23.23.23.23.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.23.23.23.23.5.m1.1d">±</annotation></semantics></math> 0.207</td>
<td class="ltx_td ltx_align_center" id="S5.T1.24.24.24.24.6">13.987 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.24.24.24.24.6.m1.1"><semantics id="S5.T1.24.24.24.24.6.m1.1a"><mo id="S5.T1.24.24.24.24.6.m1.1.1" xref="S5.T1.24.24.24.24.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.24.24.24.24.6.m1.1b"><csymbol cd="latexml" id="S5.T1.24.24.24.24.6.m1.1.1.cmml" xref="S5.T1.24.24.24.24.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.24.24.24.24.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.24.24.24.24.6.m1.1d">±</annotation></semantics></math> 0.102</td>
</tr>
<tr class="ltx_tr" id="S5.T1.30.30.30.30">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.30.30.30.30.7">DT4Rec</th>
<td class="ltx_td ltx_align_center" id="S5.T1.25.25.25.25.1">30.104 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.25.25.25.25.1.m1.1"><semantics id="S5.T1.25.25.25.25.1.m1.1a"><mo id="S5.T1.25.25.25.25.1.m1.1.1" xref="S5.T1.25.25.25.25.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.25.25.25.25.1.m1.1b"><csymbol cd="latexml" id="S5.T1.25.25.25.25.1.m1.1.1.cmml" xref="S5.T1.25.25.25.25.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.25.25.25.25.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.25.25.25.25.1.m1.1d">±</annotation></semantics></math> 0.233</td>
<td class="ltx_td ltx_align_center" id="S5.T1.26.26.26.26.2">29.989 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.26.26.26.26.2.m1.1"><semantics id="S5.T1.26.26.26.26.2.m1.1a"><mo id="S5.T1.26.26.26.26.2.m1.1.1" xref="S5.T1.26.26.26.26.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.26.26.26.26.2.m1.1b"><csymbol cd="latexml" id="S5.T1.26.26.26.26.2.m1.1.1.cmml" xref="S5.T1.26.26.26.26.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.26.26.26.26.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.26.26.26.26.2.m1.1d">±</annotation></semantics></math> 0.201</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.27.27.27.27.3">30.156 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.27.27.27.27.3.m1.1"><semantics id="S5.T1.27.27.27.27.3.m1.1a"><mo id="S5.T1.27.27.27.27.3.m1.1.1" xref="S5.T1.27.27.27.27.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.27.27.27.27.3.m1.1b"><csymbol cd="latexml" id="S5.T1.27.27.27.27.3.m1.1.1.cmml" xref="S5.T1.27.27.27.27.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.27.27.27.27.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.27.27.27.27.3.m1.1d">±</annotation></semantics></math> 0.145</td>
<td class="ltx_td ltx_align_center" id="S5.T1.28.28.28.28.4">14.333<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.28.28.28.28.4.m1.1"><semantics id="S5.T1.28.28.28.28.4.m1.1a"><mo id="S5.T1.28.28.28.28.4.m1.1.1" xref="S5.T1.28.28.28.28.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.28.28.28.28.4.m1.1b"><csymbol cd="latexml" id="S5.T1.28.28.28.28.4.m1.1.1.cmml" xref="S5.T1.28.28.28.28.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.28.28.28.28.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.28.28.28.28.4.m1.1d">±</annotation></semantics></math> 0.156</td>
<td class="ltx_td ltx_align_center" id="S5.T1.29.29.29.29.5">13.984 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.29.29.29.29.5.m1.1"><semantics id="S5.T1.29.29.29.29.5.m1.1a"><mo id="S5.T1.29.29.29.29.5.m1.1.1" xref="S5.T1.29.29.29.29.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.29.29.29.29.5.m1.1b"><csymbol cd="latexml" id="S5.T1.29.29.29.29.5.m1.1.1.cmml" xref="S5.T1.29.29.29.29.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.29.29.29.29.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.29.29.29.29.5.m1.1d">±</annotation></semantics></math> 0.224</td>
<td class="ltx_td ltx_align_center" id="S5.T1.30.30.30.30.6">14.024 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.30.30.30.30.6.m1.1"><semantics id="S5.T1.30.30.30.30.6.m1.1a"><mo id="S5.T1.30.30.30.30.6.m1.1.1" xref="S5.T1.30.30.30.30.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.30.30.30.30.6.m1.1b"><csymbol cd="latexml" id="S5.T1.30.30.30.30.6.m1.1.1.cmml" xref="S5.T1.30.30.30.30.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.30.30.30.30.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.30.30.30.30.6.m1.1d">±</annotation></semantics></math> 0.146</td>
</tr>
<tr class="ltx_tr" id="S5.T1.36.36.36.36">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.36.36.36.36.7">CDT4Rec</th>
<td class="ltx_td ltx_align_center" id="S5.T1.31.31.31.31.1">30.322 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.31.31.31.31.1.m1.1"><semantics id="S5.T1.31.31.31.31.1.m1.1a"><mo id="S5.T1.31.31.31.31.1.m1.1.1" xref="S5.T1.31.31.31.31.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.31.31.31.31.1.m1.1b"><csymbol cd="latexml" id="S5.T1.31.31.31.31.1.m1.1.1.cmml" xref="S5.T1.31.31.31.31.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.31.31.31.31.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.31.31.31.31.1.m1.1d">±</annotation></semantics></math> 0.208</td>
<td class="ltx_td ltx_align_center" id="S5.T1.32.32.32.32.2">30.014 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.32.32.32.32.2.m1.1"><semantics id="S5.T1.32.32.32.32.2.m1.1a"><mo id="S5.T1.32.32.32.32.2.m1.1.1" xref="S5.T1.32.32.32.32.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.32.32.32.32.2.m1.1b"><csymbol cd="latexml" id="S5.T1.32.32.32.32.2.m1.1.1.cmml" xref="S5.T1.32.32.32.32.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.32.32.32.32.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.32.32.32.32.2.m1.1d">±</annotation></semantics></math> 0.178</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.33.33.33.33.3">30.525 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.33.33.33.33.3.m1.1"><semantics id="S5.T1.33.33.33.33.3.m1.1a"><mo id="S5.T1.33.33.33.33.3.m1.1.1" xref="S5.T1.33.33.33.33.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.33.33.33.33.3.m1.1b"><csymbol cd="latexml" id="S5.T1.33.33.33.33.3.m1.1.1.cmml" xref="S5.T1.33.33.33.33.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.33.33.33.33.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.33.33.33.33.3.m1.1d">±</annotation></semantics></math> 0.168</td>
<td class="ltx_td ltx_align_center" id="S5.T1.34.34.34.34.4">15.229 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.34.34.34.34.4.m1.1"><semantics id="S5.T1.34.34.34.34.4.m1.1a"><mo id="S5.T1.34.34.34.34.4.m1.1.1" xref="S5.T1.34.34.34.34.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.34.34.34.34.4.m1.1b"><csymbol cd="latexml" id="S5.T1.34.34.34.34.4.m1.1.1.cmml" xref="S5.T1.34.34.34.34.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.34.34.34.34.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.34.34.34.34.4.m1.1d">±</annotation></semantics></math> 0.128</td>
<td class="ltx_td ltx_align_center" id="S5.T1.35.35.35.35.5">14.020 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.35.35.35.35.5.m1.1"><semantics id="S5.T1.35.35.35.35.5.m1.1a"><mo id="S5.T1.35.35.35.35.5.m1.1.1" xref="S5.T1.35.35.35.35.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.35.35.35.35.5.m1.1b"><csymbol cd="latexml" id="S5.T1.35.35.35.35.5.m1.1.1.cmml" xref="S5.T1.35.35.35.35.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.35.35.35.35.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.35.35.35.35.5.m1.1d">±</annotation></semantics></math> 0.201</td>
<td class="ltx_td ltx_align_center" id="S5.T1.36.36.36.36.6">14.768 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.36.36.36.36.6.m1.1"><semantics id="S5.T1.36.36.36.36.6.m1.1a"><mo id="S5.T1.36.36.36.36.6.m1.1.1" xref="S5.T1.36.36.36.36.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.36.36.36.36.6.m1.1b"><csymbol cd="latexml" id="S5.T1.36.36.36.36.6.m1.1.1.cmml" xref="S5.T1.36.36.36.36.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.36.36.36.36.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.36.36.36.36.6.m1.1d">±</annotation></semantics></math> 0.176</td>
</tr>
<tr class="ltx_tr" id="S5.T1.42.42.42.42">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S5.T1.42.42.42.42.7">EDT4Rec</th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T1.37.37.37.37.1"><span class="ltx_text ltx_font_bold" id="S5.T1.37.37.37.37.1.1">31.256 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.37.37.37.37.1.1.m1.1"><semantics id="S5.T1.37.37.37.37.1.1.m1.1a"><mo id="S5.T1.37.37.37.37.1.1.m1.1.1" xref="S5.T1.37.37.37.37.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.37.37.37.37.1.1.m1.1b"><csymbol cd="latexml" id="S5.T1.37.37.37.37.1.1.m1.1.1.cmml" xref="S5.T1.37.37.37.37.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.37.37.37.37.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.37.37.37.37.1.1.m1.1d">±</annotation></semantics></math> 0.241</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T1.38.38.38.38.2"><span class="ltx_text ltx_font_bold" id="S5.T1.38.38.38.38.2.1">31.322 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.38.38.38.38.2.1.m1.1"><semantics id="S5.T1.38.38.38.38.2.1.m1.1a"><mo id="S5.T1.38.38.38.38.2.1.m1.1.1" xref="S5.T1.38.38.38.38.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.38.38.38.38.2.1.m1.1b"><csymbol cd="latexml" id="S5.T1.38.38.38.38.2.1.m1.1.1.cmml" xref="S5.T1.38.38.38.38.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.38.38.38.38.2.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.38.38.38.38.2.1.m1.1d">±</annotation></semantics></math> 0.203</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T1.39.39.39.39.3"><span class="ltx_text ltx_font_bold" id="S5.T1.39.39.39.39.3.1">31.321 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.39.39.39.39.3.1.m1.1"><semantics id="S5.T1.39.39.39.39.3.1.m1.1a"><mo id="S5.T1.39.39.39.39.3.1.m1.1.1" xref="S5.T1.39.39.39.39.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.39.39.39.39.3.1.m1.1b"><csymbol cd="latexml" id="S5.T1.39.39.39.39.3.1.m1.1.1.cmml" xref="S5.T1.39.39.39.39.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.39.39.39.39.3.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.39.39.39.39.3.1.m1.1d">±</annotation></semantics></math> 0.203</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T1.40.40.40.40.4"><span class="ltx_text ltx_font_bold" id="S5.T1.40.40.40.40.4.1">16.021 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.40.40.40.40.4.1.m1.1"><semantics id="S5.T1.40.40.40.40.4.1.m1.1a"><mo id="S5.T1.40.40.40.40.4.1.m1.1.1" xref="S5.T1.40.40.40.40.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.40.40.40.40.4.1.m1.1b"><csymbol cd="latexml" id="S5.T1.40.40.40.40.4.1.m1.1.1.cmml" xref="S5.T1.40.40.40.40.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.40.40.40.40.4.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.40.40.40.40.4.1.m1.1d">±</annotation></semantics></math> 0.244</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T1.41.41.41.41.5"><span class="ltx_text ltx_font_bold" id="S5.T1.41.41.41.41.5.1">15.124 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.41.41.41.41.5.1.m1.1"><semantics id="S5.T1.41.41.41.41.5.1.m1.1a"><mo id="S5.T1.41.41.41.41.5.1.m1.1.1" xref="S5.T1.41.41.41.41.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.41.41.41.41.5.1.m1.1b"><csymbol cd="latexml" id="S5.T1.41.41.41.41.5.1.m1.1.1.cmml" xref="S5.T1.41.41.41.41.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.41.41.41.41.5.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.41.41.41.41.5.1.m1.1d">±</annotation></semantics></math> 0.244</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T1.42.42.42.42.6"><span class="ltx_text ltx_font_bold" id="S5.T1.42.42.42.42.6.1">15.642 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.42.42.42.42.6.1.m1.1"><semantics id="S5.T1.42.42.42.42.6.1.m1.1a"><mo id="S5.T1.42.42.42.42.6.1.m1.1.1" xref="S5.T1.42.42.42.42.6.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.42.42.42.42.6.1.m1.1b"><csymbol cd="latexml" id="S5.T1.42.42.42.42.6.1.m1.1.1.cmml" xref="S5.T1.42.42.42.42.6.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.42.42.42.42.6.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.42.42.42.42.6.1.m1.1d">±</annotation></semantics></math> 0.201</span></td>
</tr>
</tbody>
</table>
</span></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_inline-block ltx_figure_panel ltx_minipage ltx_align_middle ltx_transformed_outer" id="S5.T1.84.42" style="width:411.9pt;height:135.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-43.1pt,13.4pt) scale(0.834016541207347,0.834016541207347) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T1.84.42.42">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T1.84.42.42.43.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.84.42.42.43.1.1">Dataset</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3" id="S5.T1.84.42.42.43.1.2">Book-Crossing</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="3" id="S5.T1.84.42.42.43.1.3">GoodReads</th>
</tr>
<tr class="ltx_tr" id="S5.T1.84.42.42.44.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.84.42.42.44.2.1">Measure (%)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T1.84.42.42.44.2.2">Recall</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T1.84.42.42.44.2.3">Precision</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T1.84.42.42.44.2.4">nDCG</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T1.84.42.42.44.2.5">Recall</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T1.84.42.42.44.2.6">Precision</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T1.84.42.42.44.2.7">nDCG</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.48.6.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.48.6.6.6.7">DDPG</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.43.1.1.1.1">7.442 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.43.1.1.1.1.m1.1"><semantics id="S5.T1.43.1.1.1.1.m1.1a"><mo id="S5.T1.43.1.1.1.1.m1.1.1" xref="S5.T1.43.1.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.43.1.1.1.1.m1.1b"><csymbol cd="latexml" id="S5.T1.43.1.1.1.1.m1.1.1.cmml" xref="S5.T1.43.1.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.43.1.1.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.43.1.1.1.1.m1.1d">±</annotation></semantics></math> 0.452</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.44.2.2.2.2">5.315 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.44.2.2.2.2.m1.1"><semantics id="S5.T1.44.2.2.2.2.m1.1a"><mo id="S5.T1.44.2.2.2.2.m1.1.1" xref="S5.T1.44.2.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.44.2.2.2.2.m1.1b"><csymbol cd="latexml" id="S5.T1.44.2.2.2.2.m1.1.1.cmml" xref="S5.T1.44.2.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.44.2.2.2.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.44.2.2.2.2.m1.1d">±</annotation></semantics></math> 0.232</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.45.3.3.3.3">5.824 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.45.3.3.3.3.m1.1"><semantics id="S5.T1.45.3.3.3.3.m1.1a"><mo id="S5.T1.45.3.3.3.3.m1.1.1" xref="S5.T1.45.3.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.45.3.3.3.3.m1.1b"><csymbol cd="latexml" id="S5.T1.45.3.3.3.3.m1.1.1.cmml" xref="S5.T1.45.3.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.45.3.3.3.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.45.3.3.3.3.m1.1d">±</annotation></semantics></math> 0.281</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.46.4.4.4.4">11.652 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.46.4.4.4.4.m1.1"><semantics id="S5.T1.46.4.4.4.4.m1.1a"><mo id="S5.T1.46.4.4.4.4.m1.1.1" xref="S5.T1.46.4.4.4.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.46.4.4.4.4.m1.1b"><csymbol cd="latexml" id="S5.T1.46.4.4.4.4.m1.1.1.cmml" xref="S5.T1.46.4.4.4.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.46.4.4.4.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.46.4.4.4.4.m1.1d">±</annotation></semantics></math> 0.188</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.47.5.5.5.5">10.246 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.47.5.5.5.5.m1.1"><semantics id="S5.T1.47.5.5.5.5.m1.1a"><mo id="S5.T1.47.5.5.5.5.m1.1.1" xref="S5.T1.47.5.5.5.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.47.5.5.5.5.m1.1b"><csymbol cd="latexml" id="S5.T1.47.5.5.5.5.m1.1.1.cmml" xref="S5.T1.47.5.5.5.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.47.5.5.5.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.47.5.5.5.5.m1.1d">±</annotation></semantics></math> 0.142</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.48.6.6.6.6">9.941 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.48.6.6.6.6.m1.1"><semantics id="S5.T1.48.6.6.6.6.m1.1a"><mo id="S5.T1.48.6.6.6.6.m1.1.1" xref="S5.T1.48.6.6.6.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.48.6.6.6.6.m1.1b"><csymbol cd="latexml" id="S5.T1.48.6.6.6.6.m1.1.1.cmml" xref="S5.T1.48.6.6.6.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.48.6.6.6.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.48.6.6.6.6.m1.1d">±</annotation></semantics></math> 0.189</td>
</tr>
<tr class="ltx_tr" id="S5.T1.54.12.12.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.54.12.12.12.7">SAC</th>
<td class="ltx_td ltx_align_center" id="S5.T1.49.7.7.7.1">7.211 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.49.7.7.7.1.m1.1"><semantics id="S5.T1.49.7.7.7.1.m1.1a"><mo id="S5.T1.49.7.7.7.1.m1.1.1" xref="S5.T1.49.7.7.7.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.49.7.7.7.1.m1.1b"><csymbol cd="latexml" id="S5.T1.49.7.7.7.1.m1.1.1.cmml" xref="S5.T1.49.7.7.7.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.49.7.7.7.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.49.7.7.7.1.m1.1d">±</annotation></semantics></math> 0.293</td>
<td class="ltx_td ltx_align_center" id="S5.T1.50.8.8.8.2">5.114 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.50.8.8.8.2.m1.1"><semantics id="S5.T1.50.8.8.8.2.m1.1a"><mo id="S5.T1.50.8.8.8.2.m1.1.1" xref="S5.T1.50.8.8.8.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.50.8.8.8.2.m1.1b"><csymbol cd="latexml" id="S5.T1.50.8.8.8.2.m1.1.1.cmml" xref="S5.T1.50.8.8.8.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.50.8.8.8.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.50.8.8.8.2.m1.1d">±</annotation></semantics></math> 0.390</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.51.9.9.9.3">5.724 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.51.9.9.9.3.m1.1"><semantics id="S5.T1.51.9.9.9.3.m1.1a"><mo id="S5.T1.51.9.9.9.3.m1.1.1" xref="S5.T1.51.9.9.9.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.51.9.9.9.3.m1.1b"><csymbol cd="latexml" id="S5.T1.51.9.9.9.3.m1.1.1.cmml" xref="S5.T1.51.9.9.9.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.51.9.9.9.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.51.9.9.9.3.m1.1d">±</annotation></semantics></math> 0.226</td>
<td class="ltx_td ltx_align_center" id="S5.T1.52.10.10.10.4">11.452 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.52.10.10.10.4.m1.1"><semantics id="S5.T1.52.10.10.10.4.m1.1a"><mo id="S5.T1.52.10.10.10.4.m1.1.1" xref="S5.T1.52.10.10.10.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.52.10.10.10.4.m1.1b"><csymbol cd="latexml" id="S5.T1.52.10.10.10.4.m1.1.1.cmml" xref="S5.T1.52.10.10.10.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.52.10.10.10.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.52.10.10.10.4.m1.1d">±</annotation></semantics></math> 0.242</td>
<td class="ltx_td ltx_align_center" id="S5.T1.53.11.11.11.5">10.027 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.53.11.11.11.5.m1.1"><semantics id="S5.T1.53.11.11.11.5.m1.1a"><mo id="S5.T1.53.11.11.11.5.m1.1.1" xref="S5.T1.53.11.11.11.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.53.11.11.11.5.m1.1b"><csymbol cd="latexml" id="S5.T1.53.11.11.11.5.m1.1.1.cmml" xref="S5.T1.53.11.11.11.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.53.11.11.11.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.53.11.11.11.5.m1.1d">±</annotation></semantics></math> 0.181</td>
<td class="ltx_td ltx_align_center" id="S5.T1.54.12.12.12.6">9.721 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.54.12.12.12.6.m1.1"><semantics id="S5.T1.54.12.12.12.6.m1.1a"><mo id="S5.T1.54.12.12.12.6.m1.1.1" xref="S5.T1.54.12.12.12.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.54.12.12.12.6.m1.1b"><csymbol cd="latexml" id="S5.T1.54.12.12.12.6.m1.1.1.cmml" xref="S5.T1.54.12.12.12.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.54.12.12.12.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.54.12.12.12.6.m1.1d">±</annotation></semantics></math> 0.220</td>
</tr>
<tr class="ltx_tr" id="S5.T1.60.18.18.18">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.60.18.18.18.7">TD3</th>
<td class="ltx_td ltx_align_center" id="S5.T1.55.13.13.13.1">7.025 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.55.13.13.13.1.m1.1"><semantics id="S5.T1.55.13.13.13.1.m1.1a"><mo id="S5.T1.55.13.13.13.1.m1.1.1" xref="S5.T1.55.13.13.13.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.55.13.13.13.1.m1.1b"><csymbol cd="latexml" id="S5.T1.55.13.13.13.1.m1.1.1.cmml" xref="S5.T1.55.13.13.13.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.55.13.13.13.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.55.13.13.13.1.m1.1d">±</annotation></semantics></math> 0.193</td>
<td class="ltx_td ltx_align_center" id="S5.T1.56.14.14.14.2">5.105 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.56.14.14.14.2.m1.1"><semantics id="S5.T1.56.14.14.14.2.m1.1a"><mo id="S5.T1.56.14.14.14.2.m1.1.1" xref="S5.T1.56.14.14.14.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.56.14.14.14.2.m1.1b"><csymbol cd="latexml" id="S5.T1.56.14.14.14.2.m1.1.1.cmml" xref="S5.T1.56.14.14.14.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.56.14.14.14.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.56.14.14.14.2.m1.1d">±</annotation></semantics></math> 0.179</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.57.15.15.15.3">5.665 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.57.15.15.15.3.m1.1"><semantics id="S5.T1.57.15.15.15.3.m1.1a"><mo id="S5.T1.57.15.15.15.3.m1.1.1" xref="S5.T1.57.15.15.15.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.57.15.15.15.3.m1.1b"><csymbol cd="latexml" id="S5.T1.57.15.15.15.3.m1.1.1.cmml" xref="S5.T1.57.15.15.15.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.57.15.15.15.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.57.15.15.15.3.m1.1d">±</annotation></semantics></math> 0.332</td>
<td class="ltx_td ltx_align_center" id="S5.T1.58.16.16.16.4">11.028 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.58.16.16.16.4.m1.1"><semantics id="S5.T1.58.16.16.16.4.m1.1a"><mo id="S5.T1.58.16.16.16.4.m1.1.1" xref="S5.T1.58.16.16.16.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.58.16.16.16.4.m1.1b"><csymbol cd="latexml" id="S5.T1.58.16.16.16.4.m1.1.1.cmml" xref="S5.T1.58.16.16.16.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.58.16.16.16.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.58.16.16.16.4.m1.1d">±</annotation></semantics></math> 0.199</td>
<td class="ltx_td ltx_align_center" id="S5.T1.59.17.17.17.5">9.876 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.59.17.17.17.5.m1.1"><semantics id="S5.T1.59.17.17.17.5.m1.1a"><mo id="S5.T1.59.17.17.17.5.m1.1.1" xref="S5.T1.59.17.17.17.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.59.17.17.17.5.m1.1b"><csymbol cd="latexml" id="S5.T1.59.17.17.17.5.m1.1.1.cmml" xref="S5.T1.59.17.17.17.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.59.17.17.17.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.59.17.17.17.5.m1.1d">±</annotation></semantics></math> 0.167</td>
<td class="ltx_td ltx_align_center" id="S5.T1.60.18.18.18.6">9.521 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.60.18.18.18.6.m1.1"><semantics id="S5.T1.60.18.18.18.6.m1.1a"><mo id="S5.T1.60.18.18.18.6.m1.1.1" xref="S5.T1.60.18.18.18.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.60.18.18.18.6.m1.1b"><csymbol cd="latexml" id="S5.T1.60.18.18.18.6.m1.1.1.cmml" xref="S5.T1.60.18.18.18.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.60.18.18.18.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.60.18.18.18.6.m1.1d">±</annotation></semantics></math> 0.246</td>
</tr>
<tr class="ltx_tr" id="S5.T1.66.24.24.24">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.66.24.24.24.7">DT</th>
<td class="ltx_td ltx_align_center" id="S5.T1.61.19.19.19.1">8.375 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.61.19.19.19.1.m1.1"><semantics id="S5.T1.61.19.19.19.1.m1.1a"><mo id="S5.T1.61.19.19.19.1.m1.1.1" xref="S5.T1.61.19.19.19.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.61.19.19.19.1.m1.1b"><csymbol cd="latexml" id="S5.T1.61.19.19.19.1.m1.1.1.cmml" xref="S5.T1.61.19.19.19.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.61.19.19.19.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.61.19.19.19.1.m1.1d">±</annotation></semantics></math> 0.322</td>
<td class="ltx_td ltx_align_center" id="S5.T1.62.20.20.20.2">6.892 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.62.20.20.20.2.m1.1"><semantics id="S5.T1.62.20.20.20.2.m1.1a"><mo id="S5.T1.62.20.20.20.2.m1.1.1" xref="S5.T1.62.20.20.20.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.62.20.20.20.2.m1.1b"><csymbol cd="latexml" id="S5.T1.62.20.20.20.2.m1.1.1.cmml" xref="S5.T1.62.20.20.20.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.62.20.20.20.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.62.20.20.20.2.m1.1d">±</annotation></semantics></math> 0.188</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.63.21.21.21.3">7.587 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.63.21.21.21.3.m1.1"><semantics id="S5.T1.63.21.21.21.3.m1.1a"><mo id="S5.T1.63.21.21.21.3.m1.1.1" xref="S5.T1.63.21.21.21.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.63.21.21.21.3.m1.1b"><csymbol cd="latexml" id="S5.T1.63.21.21.21.3.m1.1.1.cmml" xref="S5.T1.63.21.21.21.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.63.21.21.21.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.63.21.21.21.3.m1.1d">±</annotation></semantics></math> 0.228</td>
<td class="ltx_td ltx_align_center" id="S5.T1.64.22.22.22.4">12.957 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.64.22.22.22.4.m1.1"><semantics id="S5.T1.64.22.22.22.4.m1.1a"><mo id="S5.T1.64.22.22.22.4.m1.1.1" xref="S5.T1.64.22.22.22.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.64.22.22.22.4.m1.1b"><csymbol cd="latexml" id="S5.T1.64.22.22.22.4.m1.1.1.cmml" xref="S5.T1.64.22.22.22.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.64.22.22.22.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.64.22.22.22.4.m1.1d">±</annotation></semantics></math> 0.177</td>
<td class="ltx_td ltx_align_center" id="S5.T1.65.23.23.23.5">10.998 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.65.23.23.23.5.m1.1"><semantics id="S5.T1.65.23.23.23.5.m1.1a"><mo id="S5.T1.65.23.23.23.5.m1.1.1" xref="S5.T1.65.23.23.23.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.65.23.23.23.5.m1.1b"><csymbol cd="latexml" id="S5.T1.65.23.23.23.5.m1.1.1.cmml" xref="S5.T1.65.23.23.23.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.65.23.23.23.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.65.23.23.23.5.m1.1d">±</annotation></semantics></math> 0.169</td>
<td class="ltx_td ltx_align_center" id="S5.T1.66.24.24.24.6">10.291 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.66.24.24.24.6.m1.1"><semantics id="S5.T1.66.24.24.24.6.m1.1a"><mo id="S5.T1.66.24.24.24.6.m1.1.1" xref="S5.T1.66.24.24.24.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.66.24.24.24.6.m1.1b"><csymbol cd="latexml" id="S5.T1.66.24.24.24.6.m1.1.1.cmml" xref="S5.T1.66.24.24.24.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.66.24.24.24.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.66.24.24.24.6.m1.1d">±</annotation></semantics></math> 0.206</td>
</tr>
<tr class="ltx_tr" id="S5.T1.72.30.30.30">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.72.30.30.30.7">DT4Rec</th>
<td class="ltx_td ltx_align_center" id="S5.T1.67.25.25.25.1">8.667 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.67.25.25.25.1.m1.1"><semantics id="S5.T1.67.25.25.25.1.m1.1a"><mo id="S5.T1.67.25.25.25.1.m1.1.1" xref="S5.T1.67.25.25.25.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.67.25.25.25.1.m1.1b"><csymbol cd="latexml" id="S5.T1.67.25.25.25.1.m1.1.1.cmml" xref="S5.T1.67.25.25.25.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.67.25.25.25.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.67.25.25.25.1.m1.1d">±</annotation></semantics></math> 0.221</td>
<td class="ltx_td ltx_align_center" id="S5.T1.68.26.26.26.2">6.984 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.68.26.26.26.2.m1.1"><semantics id="S5.T1.68.26.26.26.2.m1.1a"><mo id="S5.T1.68.26.26.26.2.m1.1.1" xref="S5.T1.68.26.26.26.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.68.26.26.26.2.m1.1b"><csymbol cd="latexml" id="S5.T1.68.26.26.26.2.m1.1.1.cmml" xref="S5.T1.68.26.26.26.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.68.26.26.26.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.68.26.26.26.2.m1.1d">±</annotation></semantics></math> 0.149</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.69.27.27.27.3">7.833 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.69.27.27.27.3.m1.1"><semantics id="S5.T1.69.27.27.27.3.m1.1a"><mo id="S5.T1.69.27.27.27.3.m1.1.1" xref="S5.T1.69.27.27.27.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.69.27.27.27.3.m1.1b"><csymbol cd="latexml" id="S5.T1.69.27.27.27.3.m1.1.1.cmml" xref="S5.T1.69.27.27.27.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.69.27.27.27.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.69.27.27.27.3.m1.1d">±</annotation></semantics></math> 0.189</td>
<td class="ltx_td ltx_align_center" id="S5.T1.70.28.28.28.4">12.972 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.70.28.28.28.4.m1.1"><semantics id="S5.T1.70.28.28.28.4.m1.1a"><mo id="S5.T1.70.28.28.28.4.m1.1.1" xref="S5.T1.70.28.28.28.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.70.28.28.28.4.m1.1b"><csymbol cd="latexml" id="S5.T1.70.28.28.28.4.m1.1.1.cmml" xref="S5.T1.70.28.28.28.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.70.28.28.28.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.70.28.28.28.4.m1.1d">±</annotation></semantics></math> 0.189</td>
<td class="ltx_td ltx_align_center" id="S5.T1.71.29.29.29.5">10.994 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.71.29.29.29.5.m1.1"><semantics id="S5.T1.71.29.29.29.5.m1.1a"><mo id="S5.T1.71.29.29.29.5.m1.1.1" xref="S5.T1.71.29.29.29.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.71.29.29.29.5.m1.1b"><csymbol cd="latexml" id="S5.T1.71.29.29.29.5.m1.1.1.cmml" xref="S5.T1.71.29.29.29.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.71.29.29.29.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.71.29.29.29.5.m1.1d">±</annotation></semantics></math> 0.191</td>
<td class="ltx_td ltx_align_center" id="S5.T1.72.30.30.30.6">10.425 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.72.30.30.30.6.m1.1"><semantics id="S5.T1.72.30.30.30.6.m1.1a"><mo id="S5.T1.72.30.30.30.6.m1.1.1" xref="S5.T1.72.30.30.30.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.72.30.30.30.6.m1.1b"><csymbol cd="latexml" id="S5.T1.72.30.30.30.6.m1.1.1.cmml" xref="S5.T1.72.30.30.30.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.72.30.30.30.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.72.30.30.30.6.m1.1d">±</annotation></semantics></math> 0.298</td>
</tr>
<tr class="ltx_tr" id="S5.T1.78.36.36.36">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.78.36.36.36.7">CDT4Rec</th>
<td class="ltx_td ltx_align_center" id="S5.T1.73.31.31.31.1">9.234 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.73.31.31.31.1.m1.1"><semantics id="S5.T1.73.31.31.31.1.m1.1a"><mo id="S5.T1.73.31.31.31.1.m1.1.1" xref="S5.T1.73.31.31.31.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.73.31.31.31.1.m1.1b"><csymbol cd="latexml" id="S5.T1.73.31.31.31.1.m1.1.1.cmml" xref="S5.T1.73.31.31.31.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.73.31.31.31.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.73.31.31.31.1.m1.1d">±</annotation></semantics></math> 0.123</td>
<td class="ltx_td ltx_align_center" id="S5.T1.74.32.32.32.2">7.226 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.74.32.32.32.2.m1.1"><semantics id="S5.T1.74.32.32.32.2.m1.1a"><mo id="S5.T1.74.32.32.32.2.m1.1.1" xref="S5.T1.74.32.32.32.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.74.32.32.32.2.m1.1b"><csymbol cd="latexml" id="S5.T1.74.32.32.32.2.m1.1.1.cmml" xref="S5.T1.74.32.32.32.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.74.32.32.32.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.74.32.32.32.2.m1.1d">±</annotation></semantics></math> 0.289</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.75.33.33.33.3">8.276 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.75.33.33.33.3.m1.1"><semantics id="S5.T1.75.33.33.33.3.m1.1a"><mo id="S5.T1.75.33.33.33.3.m1.1.1" xref="S5.T1.75.33.33.33.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.75.33.33.33.3.m1.1b"><csymbol cd="latexml" id="S5.T1.75.33.33.33.3.m1.1.1.cmml" xref="S5.T1.75.33.33.33.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.75.33.33.33.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.75.33.33.33.3.m1.1d">±</annotation></semantics></math> 0.279</td>
<td class="ltx_td ltx_align_center" id="S5.T1.76.34.34.34.4">13.274 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.76.34.34.34.4.m1.1"><semantics id="S5.T1.76.34.34.34.4.m1.1a"><mo id="S5.T1.76.34.34.34.4.m1.1.1" xref="S5.T1.76.34.34.34.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.76.34.34.34.4.m1.1b"><csymbol cd="latexml" id="S5.T1.76.34.34.34.4.m1.1.1.cmml" xref="S5.T1.76.34.34.34.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.76.34.34.34.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.76.34.34.34.4.m1.1d">±</annotation></semantics></math> 0.287</td>
<td class="ltx_td ltx_align_center" id="S5.T1.77.35.35.35.5">11.276 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.77.35.35.35.5.m1.1"><semantics id="S5.T1.77.35.35.35.5.m1.1a"><mo id="S5.T1.77.35.35.35.5.m1.1.1" xref="S5.T1.77.35.35.35.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.77.35.35.35.5.m1.1b"><csymbol cd="latexml" id="S5.T1.77.35.35.35.5.m1.1.1.cmml" xref="S5.T1.77.35.35.35.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.77.35.35.35.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.77.35.35.35.5.m1.1d">±</annotation></semantics></math> 0.175</td>
<td class="ltx_td ltx_align_center" id="S5.T1.78.36.36.36.6">10.768 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.78.36.36.36.6.m1.1"><semantics id="S5.T1.78.36.36.36.6.m1.1a"><mo id="S5.T1.78.36.36.36.6.m1.1.1" xref="S5.T1.78.36.36.36.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.78.36.36.36.6.m1.1b"><csymbol cd="latexml" id="S5.T1.78.36.36.36.6.m1.1.1.cmml" xref="S5.T1.78.36.36.36.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.78.36.36.36.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.78.36.36.36.6.m1.1d">±</annotation></semantics></math> 0.372</td>
</tr>
<tr class="ltx_tr" id="S5.T1.84.42.42.42">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S5.T1.84.42.42.42.7">EDT4Rec</th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T1.79.37.37.37.1"><span class="ltx_text ltx_font_bold" id="S5.T1.79.37.37.37.1.1">10.345 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.79.37.37.37.1.1.m1.1"><semantics id="S5.T1.79.37.37.37.1.1.m1.1a"><mo id="S5.T1.79.37.37.37.1.1.m1.1.1" xref="S5.T1.79.37.37.37.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.79.37.37.37.1.1.m1.1b"><csymbol cd="latexml" id="S5.T1.79.37.37.37.1.1.m1.1.1.cmml" xref="S5.T1.79.37.37.37.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.79.37.37.37.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.79.37.37.37.1.1.m1.1d">±</annotation></semantics></math> 0.102</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T1.80.38.38.38.2"><span class="ltx_text ltx_font_bold" id="S5.T1.80.38.38.38.2.1">8.254 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.80.38.38.38.2.1.m1.1"><semantics id="S5.T1.80.38.38.38.2.1.m1.1a"><mo id="S5.T1.80.38.38.38.2.1.m1.1.1" xref="S5.T1.80.38.38.38.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.80.38.38.38.2.1.m1.1b"><csymbol cd="latexml" id="S5.T1.80.38.38.38.2.1.m1.1.1.cmml" xref="S5.T1.80.38.38.38.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.80.38.38.38.2.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.80.38.38.38.2.1.m1.1d">±</annotation></semantics></math> 0.176</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T1.81.39.39.39.3"><span class="ltx_text ltx_font_bold" id="S5.T1.81.39.39.39.3.1">9.141 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.81.39.39.39.3.1.m1.1"><semantics id="S5.T1.81.39.39.39.3.1.m1.1a"><mo id="S5.T1.81.39.39.39.3.1.m1.1.1" xref="S5.T1.81.39.39.39.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.81.39.39.39.3.1.m1.1b"><csymbol cd="latexml" id="S5.T1.81.39.39.39.3.1.m1.1.1.cmml" xref="S5.T1.81.39.39.39.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.81.39.39.39.3.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.81.39.39.39.3.1.m1.1d">±</annotation></semantics></math> 0.234</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T1.82.40.40.40.4"><span class="ltx_text ltx_font_bold" id="S5.T1.82.40.40.40.4.1">14.144 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.82.40.40.40.4.1.m1.1"><semantics id="S5.T1.82.40.40.40.4.1.m1.1a"><mo id="S5.T1.82.40.40.40.4.1.m1.1.1" xref="S5.T1.82.40.40.40.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.82.40.40.40.4.1.m1.1b"><csymbol cd="latexml" id="S5.T1.82.40.40.40.4.1.m1.1.1.cmml" xref="S5.T1.82.40.40.40.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.82.40.40.40.4.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.82.40.40.40.4.1.m1.1d">±</annotation></semantics></math> 0.201</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T1.83.41.41.41.5"><span class="ltx_text ltx_font_bold" id="S5.T1.83.41.41.41.5.1">12.422 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.83.41.41.41.5.1.m1.1"><semantics id="S5.T1.83.41.41.41.5.1.m1.1a"><mo id="S5.T1.83.41.41.41.5.1.m1.1.1" xref="S5.T1.83.41.41.41.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.83.41.41.41.5.1.m1.1b"><csymbol cd="latexml" id="S5.T1.83.41.41.41.5.1.m1.1.1.cmml" xref="S5.T1.83.41.41.41.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.83.41.41.41.5.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.83.41.41.41.5.1.m1.1d">±</annotation></semantics></math> 0.145</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T1.84.42.42.42.6"><span class="ltx_text ltx_font_bold" id="S5.T1.84.42.42.42.6.1">11.641 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.84.42.42.42.6.1.m1.1"><semantics id="S5.T1.84.42.42.42.6.1.m1.1a"><mo id="S5.T1.84.42.42.42.6.1.m1.1.1" xref="S5.T1.84.42.42.42.6.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.84.42.42.42.6.1.m1.1b"><csymbol cd="latexml" id="S5.T1.84.42.42.42.6.1.m1.1.1.cmml" xref="S5.T1.84.42.42.42.6.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.84.42.42.42.6.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.84.42.42.42.6.1.m1.1d">±</annotation></semantics></math> 0.245</span></td>
</tr>
</tbody>
</table>
</span></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_inline-block ltx_figure_panel ltx_minipage ltx_align_middle ltx_transformed_outer" id="S5.T1.126.42" style="width:411.9pt;height:132.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-48.1pt,14.7pt) scale(0.818277890174438,0.818277890174438) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T1.126.42.42">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T1.126.42.42.43.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.126.42.42.43.1.1">Dataset</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3" id="S5.T1.126.42.42.43.1.2">MovieLens-20M</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="3" id="S5.T1.126.42.42.43.1.3">Netflix</th>
</tr>
<tr class="ltx_tr" id="S5.T1.126.42.42.44.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.126.42.42.44.2.1">Measure (%)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T1.126.42.42.44.2.2">Recall</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T1.126.42.42.44.2.3">Precision</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T1.126.42.42.44.2.4">nDCG</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T1.126.42.42.44.2.5">Recall</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T1.126.42.42.44.2.6">Precision</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T1.126.42.42.44.2.7">nDCG</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.90.6.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.90.6.6.6.7">DDPG</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.85.1.1.1.1">17.622 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.85.1.1.1.1.m1.1"><semantics id="S5.T1.85.1.1.1.1.m1.1a"><mo id="S5.T1.85.1.1.1.1.m1.1.1" xref="S5.T1.85.1.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.85.1.1.1.1.m1.1b"><csymbol cd="latexml" id="S5.T1.85.1.1.1.1.m1.1.1.cmml" xref="S5.T1.85.1.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.85.1.1.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.85.1.1.1.1.m1.1d">±</annotation></semantics></math> 0.251</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.86.2.2.2.2">15.889 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.86.2.2.2.2.m1.1"><semantics id="S5.T1.86.2.2.2.2.m1.1a"><mo id="S5.T1.86.2.2.2.2.m1.1.1" xref="S5.T1.86.2.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.86.2.2.2.2.m1.1b"><csymbol cd="latexml" id="S5.T1.86.2.2.2.2.m1.1.1.cmml" xref="S5.T1.86.2.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.86.2.2.2.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.86.2.2.2.2.m1.1d">±</annotation></semantics></math> 0.241</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.87.3.3.3.3">15.802 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.87.3.3.3.3.m1.1"><semantics id="S5.T1.87.3.3.3.3.m1.1a"><mo id="S5.T1.87.3.3.3.3.m1.1.1" xref="S5.T1.87.3.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.87.3.3.3.3.m1.1b"><csymbol cd="latexml" id="S5.T1.87.3.3.3.3.m1.1.1.cmml" xref="S5.T1.87.3.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.87.3.3.3.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.87.3.3.3.3.m1.1d">±</annotation></semantics></math> 0.201</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.88.4.4.4.4">13.305 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.88.4.4.4.4.m1.1"><semantics id="S5.T1.88.4.4.4.4.m1.1a"><mo id="S5.T1.88.4.4.4.4.m1.1.1" xref="S5.T1.88.4.4.4.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.88.4.4.4.4.m1.1b"><csymbol cd="latexml" id="S5.T1.88.4.4.4.4.m1.1.1.cmml" xref="S5.T1.88.4.4.4.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.88.4.4.4.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.88.4.4.4.4.m1.1d">±</annotation></semantics></math> 0.235</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.89.5.5.5.5">11.788 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.89.5.5.5.5.m1.1"><semantics id="S5.T1.89.5.5.5.5.m1.1a"><mo id="S5.T1.89.5.5.5.5.m1.1.1" xref="S5.T1.89.5.5.5.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.89.5.5.5.5.m1.1b"><csymbol cd="latexml" id="S5.T1.89.5.5.5.5.m1.1.1.cmml" xref="S5.T1.89.5.5.5.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.89.5.5.5.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.89.5.5.5.5.m1.1d">±</annotation></semantics></math> 0.213</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.90.6.6.6.6">10.834 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.90.6.6.6.6.m1.1"><semantics id="S5.T1.90.6.6.6.6.m1.1a"><mo id="S5.T1.90.6.6.6.6.m1.1.1" xref="S5.T1.90.6.6.6.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.90.6.6.6.6.m1.1b"><csymbol cd="latexml" id="S5.T1.90.6.6.6.6.m1.1.1.cmml" xref="S5.T1.90.6.6.6.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.90.6.6.6.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.90.6.6.6.6.m1.1d">±</annotation></semantics></math> 0.214</td>
</tr>
<tr class="ltx_tr" id="S5.T1.96.12.12.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.96.12.12.12.7">SAC</th>
<td class="ltx_td ltx_align_center" id="S5.T1.91.7.7.7.1">17.782 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.91.7.7.7.1.m1.1"><semantics id="S5.T1.91.7.7.7.1.m1.1a"><mo id="S5.T1.91.7.7.7.1.m1.1.1" xref="S5.T1.91.7.7.7.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.91.7.7.7.1.m1.1b"><csymbol cd="latexml" id="S5.T1.91.7.7.7.1.m1.1.1.cmml" xref="S5.T1.91.7.7.7.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.91.7.7.7.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.91.7.7.7.1.m1.1d">±</annotation></semantics></math> 0.204</td>
<td class="ltx_td ltx_align_center" id="S5.T1.92.8.8.8.2">15.989 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.92.8.8.8.2.m1.1"><semantics id="S5.T1.92.8.8.8.2.m1.1a"><mo id="S5.T1.92.8.8.8.2.m1.1.1" xref="S5.T1.92.8.8.8.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.92.8.8.8.2.m1.1b"><csymbol cd="latexml" id="S5.T1.92.8.8.8.2.m1.1.1.cmml" xref="S5.T1.92.8.8.8.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.92.8.8.8.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.92.8.8.8.2.m1.1d">±</annotation></semantics></math> 0.229</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.93.9.9.9.3">15.821 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.93.9.9.9.3.m1.1"><semantics id="S5.T1.93.9.9.9.3.m1.1a"><mo id="S5.T1.93.9.9.9.3.m1.1.1" xref="S5.T1.93.9.9.9.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.93.9.9.9.3.m1.1b"><csymbol cd="latexml" id="S5.T1.93.9.9.9.3.m1.1.1.cmml" xref="S5.T1.93.9.9.9.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.93.9.9.9.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.93.9.9.9.3.m1.1d">±</annotation></semantics></math> 0.212</td>
<td class="ltx_td ltx_align_center" id="S5.T1.94.10.10.10.4">13.324 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.94.10.10.10.4.m1.1"><semantics id="S5.T1.94.10.10.10.4.m1.1a"><mo id="S5.T1.94.10.10.10.4.m1.1.1" xref="S5.T1.94.10.10.10.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.94.10.10.10.4.m1.1b"><csymbol cd="latexml" id="S5.T1.94.10.10.10.4.m1.1.1.cmml" xref="S5.T1.94.10.10.10.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.94.10.10.10.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.94.10.10.10.4.m1.1d">±</annotation></semantics></math> 0.210</td>
<td class="ltx_td ltx_align_center" id="S5.T1.95.11.11.11.5">11.981 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.95.11.11.11.5.m1.1"><semantics id="S5.T1.95.11.11.11.5.m1.1a"><mo id="S5.T1.95.11.11.11.5.m1.1.1" xref="S5.T1.95.11.11.11.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.95.11.11.11.5.m1.1b"><csymbol cd="latexml" id="S5.T1.95.11.11.11.5.m1.1.1.cmml" xref="S5.T1.95.11.11.11.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.95.11.11.11.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.95.11.11.11.5.m1.1d">±</annotation></semantics></math> 0.246</td>
<td class="ltx_td ltx_align_center" id="S5.T1.96.12.12.12.6">10.970 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.96.12.12.12.6.m1.1"><semantics id="S5.T1.96.12.12.12.6.m1.1a"><mo id="S5.T1.96.12.12.12.6.m1.1.1" xref="S5.T1.96.12.12.12.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.96.12.12.12.6.m1.1b"><csymbol cd="latexml" id="S5.T1.96.12.12.12.6.m1.1.1.cmml" xref="S5.T1.96.12.12.12.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.96.12.12.12.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.96.12.12.12.6.m1.1d">±</annotation></semantics></math> 0.270</td>
</tr>
<tr class="ltx_tr" id="S5.T1.102.18.18.18">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.102.18.18.18.7">TD3</th>
<td class="ltx_td ltx_align_center" id="S5.T1.97.13.13.13.1">17.531 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.97.13.13.13.1.m1.1"><semantics id="S5.T1.97.13.13.13.1.m1.1a"><mo id="S5.T1.97.13.13.13.1.m1.1.1" xref="S5.T1.97.13.13.13.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.97.13.13.13.1.m1.1b"><csymbol cd="latexml" id="S5.T1.97.13.13.13.1.m1.1.1.cmml" xref="S5.T1.97.13.13.13.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.97.13.13.13.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.97.13.13.13.1.m1.1d">±</annotation></semantics></math> 0.291</td>
<td class="ltx_td ltx_align_center" id="S5.T1.98.14.14.14.2">15.866 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.98.14.14.14.2.m1.1"><semantics id="S5.T1.98.14.14.14.2.m1.1a"><mo id="S5.T1.98.14.14.14.2.m1.1.1" xref="S5.T1.98.14.14.14.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.98.14.14.14.2.m1.1b"><csymbol cd="latexml" id="S5.T1.98.14.14.14.2.m1.1.1.cmml" xref="S5.T1.98.14.14.14.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.98.14.14.14.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.98.14.14.14.2.m1.1d">±</annotation></semantics></math> 0.261</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.99.15.15.15.3">15.731 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.99.15.15.15.3.m1.1"><semantics id="S5.T1.99.15.15.15.3.m1.1a"><mo id="S5.T1.99.15.15.15.3.m1.1.1" xref="S5.T1.99.15.15.15.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.99.15.15.15.3.m1.1b"><csymbol cd="latexml" id="S5.T1.99.15.15.15.3.m1.1.1.cmml" xref="S5.T1.99.15.15.15.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.99.15.15.15.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.99.15.15.15.3.m1.1d">±</annotation></semantics></math> 0.302</td>
<td class="ltx_td ltx_align_center" id="S5.T1.100.16.16.16.4">13.231 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.100.16.16.16.4.m1.1"><semantics id="S5.T1.100.16.16.16.4.m1.1a"><mo id="S5.T1.100.16.16.16.4.m1.1.1" xref="S5.T1.100.16.16.16.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.100.16.16.16.4.m1.1b"><csymbol cd="latexml" id="S5.T1.100.16.16.16.4.m1.1.1.cmml" xref="S5.T1.100.16.16.16.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.100.16.16.16.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.100.16.16.16.4.m1.1d">±</annotation></semantics></math> 0.284</td>
<td class="ltx_td ltx_align_center" id="S5.T1.101.17.17.17.5">11.676 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.101.17.17.17.5.m1.1"><semantics id="S5.T1.101.17.17.17.5.m1.1a"><mo id="S5.T1.101.17.17.17.5.m1.1.1" xref="S5.T1.101.17.17.17.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.101.17.17.17.5.m1.1b"><csymbol cd="latexml" id="S5.T1.101.17.17.17.5.m1.1.1.cmml" xref="S5.T1.101.17.17.17.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.101.17.17.17.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.101.17.17.17.5.m1.1d">±</annotation></semantics></math> 0.204</td>
<td class="ltx_td ltx_align_center" id="S5.T1.102.18.18.18.6">10.789 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.102.18.18.18.6.m1.1"><semantics id="S5.T1.102.18.18.18.6.m1.1a"><mo id="S5.T1.102.18.18.18.6.m1.1.1" xref="S5.T1.102.18.18.18.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.102.18.18.18.6.m1.1b"><csymbol cd="latexml" id="S5.T1.102.18.18.18.6.m1.1.1.cmml" xref="S5.T1.102.18.18.18.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.102.18.18.18.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.102.18.18.18.6.m1.1d">±</annotation></semantics></math> 0.266</td>
</tr>
<tr class="ltx_tr" id="S5.T1.108.24.24.24">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.108.24.24.24.7">DT</th>
<td class="ltx_td ltx_align_center" id="S5.T1.103.19.19.19.1">18.889 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.103.19.19.19.1.m1.1"><semantics id="S5.T1.103.19.19.19.1.m1.1a"><mo id="S5.T1.103.19.19.19.1.m1.1.1" xref="S5.T1.103.19.19.19.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.103.19.19.19.1.m1.1b"><csymbol cd="latexml" id="S5.T1.103.19.19.19.1.m1.1.1.cmml" xref="S5.T1.103.19.19.19.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.103.19.19.19.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.103.19.19.19.1.m1.1d">±</annotation></semantics></math> 0.224</td>
<td class="ltx_td ltx_align_center" id="S5.T1.104.20.20.20.2">16.989 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.104.20.20.20.2.m1.1"><semantics id="S5.T1.104.20.20.20.2.m1.1a"><mo id="S5.T1.104.20.20.20.2.m1.1.1" xref="S5.T1.104.20.20.20.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.104.20.20.20.2.m1.1b"><csymbol cd="latexml" id="S5.T1.104.20.20.20.2.m1.1.1.cmml" xref="S5.T1.104.20.20.20.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.104.20.20.20.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.104.20.20.20.2.m1.1d">±</annotation></semantics></math> 0.242</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.105.21.21.21.3">16.912 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.105.21.21.21.3.m1.1"><semantics id="S5.T1.105.21.21.21.3.m1.1a"><mo id="S5.T1.105.21.21.21.3.m1.1.1" xref="S5.T1.105.21.21.21.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.105.21.21.21.3.m1.1b"><csymbol cd="latexml" id="S5.T1.105.21.21.21.3.m1.1.1.cmml" xref="S5.T1.105.21.21.21.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.105.21.21.21.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.105.21.21.21.3.m1.1d">±</annotation></semantics></math> 0.202</td>
<td class="ltx_td ltx_align_center" id="S5.T1.106.22.22.22.4">14.598 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.106.22.22.22.4.m1.1"><semantics id="S5.T1.106.22.22.22.4.m1.1a"><mo id="S5.T1.106.22.22.22.4.m1.1.1" xref="S5.T1.106.22.22.22.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.106.22.22.22.4.m1.1b"><csymbol cd="latexml" id="S5.T1.106.22.22.22.4.m1.1.1.cmml" xref="S5.T1.106.22.22.22.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.106.22.22.22.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.106.22.22.22.4.m1.1d">±</annotation></semantics></math> 0.202</td>
<td class="ltx_td ltx_align_center" id="S5.T1.107.23.23.23.5">12.251 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.107.23.23.23.5.m1.1"><semantics id="S5.T1.107.23.23.23.5.m1.1a"><mo id="S5.T1.107.23.23.23.5.m1.1.1" xref="S5.T1.107.23.23.23.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.107.23.23.23.5.m1.1b"><csymbol cd="latexml" id="S5.T1.107.23.23.23.5.m1.1.1.cmml" xref="S5.T1.107.23.23.23.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.107.23.23.23.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.107.23.23.23.5.m1.1d">±</annotation></semantics></math> 0.141</td>
<td class="ltx_td ltx_align_center" id="S5.T1.108.24.24.24.6">11.864 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.108.24.24.24.6.m1.1"><semantics id="S5.T1.108.24.24.24.6.m1.1a"><mo id="S5.T1.108.24.24.24.6.m1.1.1" xref="S5.T1.108.24.24.24.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.108.24.24.24.6.m1.1b"><csymbol cd="latexml" id="S5.T1.108.24.24.24.6.m1.1.1.cmml" xref="S5.T1.108.24.24.24.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.108.24.24.24.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.108.24.24.24.6.m1.1d">±</annotation></semantics></math> 0.242</td>
</tr>
<tr class="ltx_tr" id="S5.T1.114.30.30.30">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.114.30.30.30.7">DT4Rec</th>
<td class="ltx_td ltx_align_center" id="S5.T1.109.25.25.25.1">18.971 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.109.25.25.25.1.m1.1"><semantics id="S5.T1.109.25.25.25.1.m1.1a"><mo id="S5.T1.109.25.25.25.1.m1.1.1" xref="S5.T1.109.25.25.25.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.109.25.25.25.1.m1.1b"><csymbol cd="latexml" id="S5.T1.109.25.25.25.1.m1.1.1.cmml" xref="S5.T1.109.25.25.25.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.109.25.25.25.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.109.25.25.25.1.m1.1d">±</annotation></semantics></math> 0.254</td>
<td class="ltx_td ltx_align_center" id="S5.T1.110.26.26.26.2">17.013 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.110.26.26.26.2.m1.1"><semantics id="S5.T1.110.26.26.26.2.m1.1a"><mo id="S5.T1.110.26.26.26.2.m1.1.1" xref="S5.T1.110.26.26.26.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.110.26.26.26.2.m1.1b"><csymbol cd="latexml" id="S5.T1.110.26.26.26.2.m1.1.1.cmml" xref="S5.T1.110.26.26.26.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.110.26.26.26.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.110.26.26.26.2.m1.1d">±</annotation></semantics></math> 0.289</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.111.27.27.27.3">16.942 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.111.27.27.27.3.m1.1"><semantics id="S5.T1.111.27.27.27.3.m1.1a"><mo id="S5.T1.111.27.27.27.3.m1.1.1" xref="S5.T1.111.27.27.27.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.111.27.27.27.3.m1.1b"><csymbol cd="latexml" id="S5.T1.111.27.27.27.3.m1.1.1.cmml" xref="S5.T1.111.27.27.27.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.111.27.27.27.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.111.27.27.27.3.m1.1d">±</annotation></semantics></math> 0.248</td>
<td class="ltx_td ltx_align_center" id="S5.T1.112.28.28.28.4">14.879 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.112.28.28.28.4.m1.1"><semantics id="S5.T1.112.28.28.28.4.m1.1a"><mo id="S5.T1.112.28.28.28.4.m1.1.1" xref="S5.T1.112.28.28.28.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.112.28.28.28.4.m1.1b"><csymbol cd="latexml" id="S5.T1.112.28.28.28.4.m1.1.1.cmml" xref="S5.T1.112.28.28.28.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.112.28.28.28.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.112.28.28.28.4.m1.1d">±</annotation></semantics></math> 0.254</td>
<td class="ltx_td ltx_align_center" id="S5.T1.113.29.29.29.5">12.786 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.113.29.29.29.5.m1.1"><semantics id="S5.T1.113.29.29.29.5.m1.1a"><mo id="S5.T1.113.29.29.29.5.m1.1.1" xref="S5.T1.113.29.29.29.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.113.29.29.29.5.m1.1b"><csymbol cd="latexml" id="S5.T1.113.29.29.29.5.m1.1.1.cmml" xref="S5.T1.113.29.29.29.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.113.29.29.29.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.113.29.29.29.5.m1.1d">±</annotation></semantics></math> 0.198</td>
<td class="ltx_td ltx_align_center" id="S5.T1.114.30.30.30.6">11.961 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.114.30.30.30.6.m1.1"><semantics id="S5.T1.114.30.30.30.6.m1.1a"><mo id="S5.T1.114.30.30.30.6.m1.1.1" xref="S5.T1.114.30.30.30.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.114.30.30.30.6.m1.1b"><csymbol cd="latexml" id="S5.T1.114.30.30.30.6.m1.1.1.cmml" xref="S5.T1.114.30.30.30.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.114.30.30.30.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.114.30.30.30.6.m1.1d">±</annotation></semantics></math> 0.261</td>
</tr>
<tr class="ltx_tr" id="S5.T1.120.36.36.36">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.120.36.36.36.7">CDT4Rec</th>
<td class="ltx_td ltx_align_center" id="S5.T1.115.31.31.31.1">19.273 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.115.31.31.31.1.m1.1"><semantics id="S5.T1.115.31.31.31.1.m1.1a"><mo id="S5.T1.115.31.31.31.1.m1.1.1" xref="S5.T1.115.31.31.31.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.115.31.31.31.1.m1.1b"><csymbol cd="latexml" id="S5.T1.115.31.31.31.1.m1.1.1.cmml" xref="S5.T1.115.31.31.31.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.115.31.31.31.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.115.31.31.31.1.m1.1d">±</annotation></semantics></math> 0.212</td>
<td class="ltx_td ltx_align_center" id="S5.T1.116.32.32.32.2">17.371 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.116.32.32.32.2.m1.1"><semantics id="S5.T1.116.32.32.32.2.m1.1a"><mo id="S5.T1.116.32.32.32.2.m1.1.1" xref="S5.T1.116.32.32.32.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.116.32.32.32.2.m1.1b"><csymbol cd="latexml" id="S5.T1.116.32.32.32.2.m1.1.1.cmml" xref="S5.T1.116.32.32.32.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.116.32.32.32.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.116.32.32.32.2.m1.1d">±</annotation></semantics></math> 0.276</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.117.33.33.33.3">17.311 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.117.33.33.33.3.m1.1"><semantics id="S5.T1.117.33.33.33.3.m1.1a"><mo id="S5.T1.117.33.33.33.3.m1.1.1" xref="S5.T1.117.33.33.33.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.117.33.33.33.3.m1.1b"><csymbol cd="latexml" id="S5.T1.117.33.33.33.3.m1.1.1.cmml" xref="S5.T1.117.33.33.33.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.117.33.33.33.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.117.33.33.33.3.m1.1d">±</annotation></semantics></math> 0.216</td>
<td class="ltx_td ltx_align_center" id="S5.T1.118.34.34.34.4">15.271 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.118.34.34.34.4.m1.1"><semantics id="S5.T1.118.34.34.34.4.m1.1a"><mo id="S5.T1.118.34.34.34.4.m1.1.1" xref="S5.T1.118.34.34.34.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.118.34.34.34.4.m1.1b"><csymbol cd="latexml" id="S5.T1.118.34.34.34.4.m1.1.1.cmml" xref="S5.T1.118.34.34.34.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.118.34.34.34.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.118.34.34.34.4.m1.1d">±</annotation></semantics></math> 0.127</td>
<td class="ltx_td ltx_align_center" id="S5.T1.119.35.35.35.5">13.274 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.119.35.35.35.5.m1.1"><semantics id="S5.T1.119.35.35.35.5.m1.1a"><mo id="S5.T1.119.35.35.35.5.m1.1.1" xref="S5.T1.119.35.35.35.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.119.35.35.35.5.m1.1b"><csymbol cd="latexml" id="S5.T1.119.35.35.35.5.m1.1.1.cmml" xref="S5.T1.119.35.35.35.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.119.35.35.35.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.119.35.35.35.5.m1.1d">±</annotation></semantics></math> 0.168</td>
<td class="ltx_td ltx_align_center" id="S5.T1.120.36.36.36.6">12.479 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.120.36.36.36.6.m1.1"><semantics id="S5.T1.120.36.36.36.6.m1.1a"><mo id="S5.T1.120.36.36.36.6.m1.1.1" xref="S5.T1.120.36.36.36.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.120.36.36.36.6.m1.1b"><csymbol cd="latexml" id="S5.T1.120.36.36.36.6.m1.1.1.cmml" xref="S5.T1.120.36.36.36.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.120.36.36.36.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.120.36.36.36.6.m1.1d">±</annotation></semantics></math> 0.198</td>
</tr>
<tr class="ltx_tr" id="S5.T1.126.42.42.42">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S5.T1.126.42.42.42.7">EDT4Rec</th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T1.121.37.37.37.1"><span class="ltx_text ltx_font_bold" id="S5.T1.121.37.37.37.1.1">20.314 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.121.37.37.37.1.1.m1.1"><semantics id="S5.T1.121.37.37.37.1.1.m1.1a"><mo id="S5.T1.121.37.37.37.1.1.m1.1.1" xref="S5.T1.121.37.37.37.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.121.37.37.37.1.1.m1.1b"><csymbol cd="latexml" id="S5.T1.121.37.37.37.1.1.m1.1.1.cmml" xref="S5.T1.121.37.37.37.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.121.37.37.37.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.121.37.37.37.1.1.m1.1d">±</annotation></semantics></math> 0.201</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T1.122.38.38.38.2"><span class="ltx_text ltx_font_bold" id="S5.T1.122.38.38.38.2.1">18.341 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.122.38.38.38.2.1.m1.1"><semantics id="S5.T1.122.38.38.38.2.1.m1.1a"><mo id="S5.T1.122.38.38.38.2.1.m1.1.1" xref="S5.T1.122.38.38.38.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.122.38.38.38.2.1.m1.1b"><csymbol cd="latexml" id="S5.T1.122.38.38.38.2.1.m1.1.1.cmml" xref="S5.T1.122.38.38.38.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.122.38.38.38.2.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.122.38.38.38.2.1.m1.1d">±</annotation></semantics></math> 0.221</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T1.123.39.39.39.3"><span class="ltx_text ltx_font_bold" id="S5.T1.123.39.39.39.3.1">18.234 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.123.39.39.39.3.1.m1.1"><semantics id="S5.T1.123.39.39.39.3.1.m1.1a"><mo id="S5.T1.123.39.39.39.3.1.m1.1.1" xref="S5.T1.123.39.39.39.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.123.39.39.39.3.1.m1.1b"><csymbol cd="latexml" id="S5.T1.123.39.39.39.3.1.m1.1.1.cmml" xref="S5.T1.123.39.39.39.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.123.39.39.39.3.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.123.39.39.39.3.1.m1.1d">±</annotation></semantics></math> 0.186</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T1.124.40.40.40.4"><span class="ltx_text ltx_font_bold" id="S5.T1.124.40.40.40.4.1">16.541 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.124.40.40.40.4.1.m1.1"><semantics id="S5.T1.124.40.40.40.4.1.m1.1a"><mo id="S5.T1.124.40.40.40.4.1.m1.1.1" xref="S5.T1.124.40.40.40.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.124.40.40.40.4.1.m1.1b"><csymbol cd="latexml" id="S5.T1.124.40.40.40.4.1.m1.1.1.cmml" xref="S5.T1.124.40.40.40.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.124.40.40.40.4.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.124.40.40.40.4.1.m1.1d">±</annotation></semantics></math> 0.201</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T1.125.41.41.41.5"><span class="ltx_text ltx_font_bold" id="S5.T1.125.41.41.41.5.1">14.356 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.125.41.41.41.5.1.m1.1"><semantics id="S5.T1.125.41.41.41.5.1.m1.1a"><mo id="S5.T1.125.41.41.41.5.1.m1.1.1" xref="S5.T1.125.41.41.41.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.125.41.41.41.5.1.m1.1b"><csymbol cd="latexml" id="S5.T1.125.41.41.41.5.1.m1.1.1.cmml" xref="S5.T1.125.41.41.41.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.125.41.41.41.5.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.125.41.41.41.5.1.m1.1d">±</annotation></semantics></math> 0.181</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T1.126.42.42.42.6"><span class="ltx_text ltx_font_bold" id="S5.T1.126.42.42.42.6.1">13.661 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T1.126.42.42.42.6.1.m1.1"><semantics id="S5.T1.126.42.42.42.6.1.m1.1a"><mo id="S5.T1.126.42.42.42.6.1.m1.1.1" xref="S5.T1.126.42.42.42.6.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.126.42.42.42.6.1.m1.1b"><csymbol cd="latexml" id="S5.T1.126.42.42.42.6.1.m1.1.1.cmml" xref="S5.T1.126.42.42.42.6.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.126.42.42.42.6.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T1.126.42.42.42.6.1.m1.1d">±</annotation></semantics></math> 0.145</span></td>
</tr>
</tbody>
</table>
</span></div>
</div>
</div>
</figure>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">In our study, we focus on evaluating EDT4Rec within the context of DT-based methods. Most existing works in RLRS have been assessed using customized settings, which makes fair comparison challenging <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib10" title="">2023b</a>)</cite>. To address this, we have selected a range of baselines, encompassing both prominent DT-based methods and well-established RL algorithms, for a comprehensive evaluation:</p>
<ul class="ltx_itemize" id="S5.I3">
<li class="ltx_item" id="S5.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i1.p1">
<p class="ltx_p" id="S5.I3.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I3.i1.p1.1.1">Deep Deterministic Policy Gradient (DDPG)</span> <cite class="ltx_cite ltx_citemacro_citep">(Lillicrap et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib20" title="">2016</a>)</cite>: An off-policy method designed for environments with continuous action spaces.</p>
</div>
</li>
<li class="ltx_item" id="S5.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i2.p1">
<p class="ltx_p" id="S5.I3.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I3.i2.p1.1.1">SAC</span> <cite class="ltx_cite ltx_citemacro_citep">(Haarnoja et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib15" title="">2018</a>)</cite>: This approach is an off-policy, maximum entropy Deep RL method that focuses on optimizing a stochastic policy. While we are using deterministic policy here.</p>
</div>
</li>
<li class="ltx_item" id="S5.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i3.p1">
<p class="ltx_p" id="S5.I3.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I3.i3.p1.1.1">Twin Delayed DDPG (TD3)</span> <cite class="ltx_cite ltx_citemacro_citep">(Fujimoto et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib12" title="">2018</a>)</cite>: An enhancement of the baseline DDPG, TD3 improves performance by learning two Q-functions, updating the policy less frequently.</p>
</div>
</li>
<li class="ltx_item" id="S5.I3.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i4.p1">
<p class="ltx_p" id="S5.I3.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I3.i4.p1.1.1">DT</span> <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib5" title="">2021a</a>)</cite>: An offline RL algorithm that leverages the transformer architecture to infer actions.</p>
</div>
</li>
<li class="ltx_item" id="S5.I3.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i5.p1">
<p class="ltx_p" id="S5.I3.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I3.i5.p1.1.1">DT4Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib27" title="">2023</a>)</cite>: Building on the standard DT framework, DT4Rec integrates a conservative learning method to better understand users’ intentions in offline RLRS.</p>
</div>
</li>
<li class="ltx_item" id="S5.I3.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i6.p1">
<p class="ltx_p" id="S5.I3.i6.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I3.i6.p1.1.1">CDT4Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib25" title="">2023</a>)</cite>: This model introduces a causal layer to the DT framework, aiming to more effectively capture user intentions and preferences in offline RLRS.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_figure" id="S5.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F3.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="449" id="S5.F3.sf1.g1" src="extracted/5637914/EDT_overall.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F3.sf1.2.1.1" style="font-size:90%;">(a)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F3.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="449" id="S5.F3.sf2.g1" src="extracted/5637914/g_online.jpg" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F3.sf2.2.1.1" style="font-size:90%;">(b)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F3.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="449" id="S5.F3.sf3.g1" src="extracted/5637914/K.jpg" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F3.sf3.2.1.1" style="font-size:90%;">(c)</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F3.10.5.1" style="font-size:90%;">Figure 3</span>. </span><span class="ltx_text" id="S5.F3.8.4" style="font-size:90%;">(a). Overall comparison result with variance between the baselines and EDT4Rec in the VirtualTaobao simulation environment. (b).Hyperparameter <math alttext="g_{online}" class="ltx_Math" display="inline" id="S5.F3.5.1.m1.1"><semantics id="S5.F3.5.1.m1.1b"><msub id="S5.F3.5.1.m1.1.1" xref="S5.F3.5.1.m1.1.1.cmml"><mi id="S5.F3.5.1.m1.1.1.2" xref="S5.F3.5.1.m1.1.1.2.cmml">g</mi><mrow id="S5.F3.5.1.m1.1.1.3" xref="S5.F3.5.1.m1.1.1.3.cmml"><mi id="S5.F3.5.1.m1.1.1.3.2" xref="S5.F3.5.1.m1.1.1.3.2.cmml">o</mi><mo id="S5.F3.5.1.m1.1.1.3.1" xref="S5.F3.5.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.F3.5.1.m1.1.1.3.3" xref="S5.F3.5.1.m1.1.1.3.3.cmml">n</mi><mo id="S5.F3.5.1.m1.1.1.3.1b" xref="S5.F3.5.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.F3.5.1.m1.1.1.3.4" xref="S5.F3.5.1.m1.1.1.3.4.cmml">l</mi><mo id="S5.F3.5.1.m1.1.1.3.1c" xref="S5.F3.5.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.F3.5.1.m1.1.1.3.5" xref="S5.F3.5.1.m1.1.1.3.5.cmml">i</mi><mo id="S5.F3.5.1.m1.1.1.3.1d" xref="S5.F3.5.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.F3.5.1.m1.1.1.3.6" xref="S5.F3.5.1.m1.1.1.3.6.cmml">n</mi><mo id="S5.F3.5.1.m1.1.1.3.1e" xref="S5.F3.5.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.F3.5.1.m1.1.1.3.7" xref="S5.F3.5.1.m1.1.1.3.7.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.F3.5.1.m1.1c"><apply id="S5.F3.5.1.m1.1.1.cmml" xref="S5.F3.5.1.m1.1.1"><csymbol cd="ambiguous" id="S5.F3.5.1.m1.1.1.1.cmml" xref="S5.F3.5.1.m1.1.1">subscript</csymbol><ci id="S5.F3.5.1.m1.1.1.2.cmml" xref="S5.F3.5.1.m1.1.1.2">𝑔</ci><apply id="S5.F3.5.1.m1.1.1.3.cmml" xref="S5.F3.5.1.m1.1.1.3"><times id="S5.F3.5.1.m1.1.1.3.1.cmml" xref="S5.F3.5.1.m1.1.1.3.1"></times><ci id="S5.F3.5.1.m1.1.1.3.2.cmml" xref="S5.F3.5.1.m1.1.1.3.2">𝑜</ci><ci id="S5.F3.5.1.m1.1.1.3.3.cmml" xref="S5.F3.5.1.m1.1.1.3.3">𝑛</ci><ci id="S5.F3.5.1.m1.1.1.3.4.cmml" xref="S5.F3.5.1.m1.1.1.3.4">𝑙</ci><ci id="S5.F3.5.1.m1.1.1.3.5.cmml" xref="S5.F3.5.1.m1.1.1.3.5">𝑖</ci><ci id="S5.F3.5.1.m1.1.1.3.6.cmml" xref="S5.F3.5.1.m1.1.1.3.6">𝑛</ci><ci id="S5.F3.5.1.m1.1.1.3.7.cmml" xref="S5.F3.5.1.m1.1.1.3.7">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.5.1.m1.1d">g_{online}</annotation><annotation encoding="application/x-llamapun" id="S5.F3.5.1.m1.1e">italic_g start_POSTSUBSCRIPT italic_o italic_n italic_l italic_i italic_n italic_e end_POSTSUBSCRIPT</annotation></semantics></math> Study, the value reported in the average CTR over <math alttext="100,000" class="ltx_Math" display="inline" id="S5.F3.6.2.m2.2"><semantics id="S5.F3.6.2.m2.2b"><mrow id="S5.F3.6.2.m2.2.3.2" xref="S5.F3.6.2.m2.2.3.1.cmml"><mn id="S5.F3.6.2.m2.1.1" xref="S5.F3.6.2.m2.1.1.cmml">100</mn><mo id="S5.F3.6.2.m2.2.3.2.1" xref="S5.F3.6.2.m2.2.3.1.cmml">,</mo><mn id="S5.F3.6.2.m2.2.2" xref="S5.F3.6.2.m2.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F3.6.2.m2.2c"><list id="S5.F3.6.2.m2.2.3.1.cmml" xref="S5.F3.6.2.m2.2.3.2"><cn id="S5.F3.6.2.m2.1.1.cmml" type="integer" xref="S5.F3.6.2.m2.1.1">100</cn><cn id="S5.F3.6.2.m2.2.2.cmml" type="integer" xref="S5.F3.6.2.m2.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.6.2.m2.2d">100,000</annotation><annotation encoding="application/x-llamapun" id="S5.F3.6.2.m2.2e">100 , 000</annotation></semantics></math> timesteps. (c).Hyperparameter <math alttext="K" class="ltx_Math" display="inline" id="S5.F3.7.3.m3.1"><semantics id="S5.F3.7.3.m3.1b"><mi id="S5.F3.7.3.m3.1.1" xref="S5.F3.7.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.F3.7.3.m3.1c"><ci id="S5.F3.7.3.m3.1.1.cmml" xref="S5.F3.7.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.7.3.m3.1d">K</annotation><annotation encoding="application/x-llamapun" id="S5.F3.7.3.m3.1e">italic_K</annotation></semantics></math> Study, the value reported in the average CTR over <math alttext="100,000" class="ltx_Math" display="inline" id="S5.F3.8.4.m4.2"><semantics id="S5.F3.8.4.m4.2b"><mrow id="S5.F3.8.4.m4.2.3.2" xref="S5.F3.8.4.m4.2.3.1.cmml"><mn id="S5.F3.8.4.m4.1.1" xref="S5.F3.8.4.m4.1.1.cmml">100</mn><mo id="S5.F3.8.4.m4.2.3.2.1" xref="S5.F3.8.4.m4.2.3.1.cmml">,</mo><mn id="S5.F3.8.4.m4.2.2" xref="S5.F3.8.4.m4.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F3.8.4.m4.2c"><list id="S5.F3.8.4.m4.2.3.1.cmml" xref="S5.F3.8.4.m4.2.3.2"><cn id="S5.F3.8.4.m4.1.1.cmml" type="integer" xref="S5.F3.8.4.m4.1.1">100</cn><cn id="S5.F3.8.4.m4.2.2.cmml" type="integer" xref="S5.F3.8.4.m4.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.8.4.m4.2d">100,000</annotation><annotation encoding="application/x-llamapun" id="S5.F3.8.4.m4.2e">100 , 000</annotation></semantics></math> timesteps</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3. </span>Overall Comparison (RQ1)</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">The summarized results of our experiments with the offline dataset are presented in <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S5.T1" title="In 5.2. Baselines ‣ 5. Experiments ‣ Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">1</span></a>. Notably, EDT4Rec demonstrates superior performance over all baseline methods, including those DT based offline RLRS and traditional RL approaches. A key observation is the general superiority of DT-based methods over RL-based methods, likely attributable to the transformer framework’s expressiveness.</p>
</div>
<div class="ltx_para" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.1">In our online simulator experiments, EDT4Rec was compared against the baselines mentioned earlier. The comparative results, as detailed in <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S5.F3.sf1" title="In Figure 3 ‣ 5.2. Baselines ‣ 5. Experiments ‣ Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">3(a)</span></a>, reveal a significant improvement by EDT4Rec, particularly in the later timesteps. Moreover, we observe that DT-based methods outperform traditional RL algorithms. The reason would be those methods accessing more recorded offline trajectories and benefiting from the transformer’s high expressiveness.</p>
</div>
<div class="ltx_para" id="S5.SS3.p3">
<p class="ltx_p" id="S5.SS3.p3.1">However, it’s observed that DT, DT4Rec, and CDT4Rec perform worse than EDT4Rec, given that the pre-collected data are sub-optimal. This observation reinforces our assertion that DT lacks exploration capability and that its pre-training stage closely resembles behavior cloning.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4. </span>Hyperparameter Study (RQ2)</h3>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.14">In this section, we delve into the hyperparameter analysis for our proposed EDT4Rec model, particularly examining the impacts of <math alttext="\textbf{g}_{online}" class="ltx_Math" display="inline" id="S5.SS4.p1.1.m1.1"><semantics id="S5.SS4.p1.1.m1.1a"><msub id="S5.SS4.p1.1.m1.1.1" xref="S5.SS4.p1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S5.SS4.p1.1.m1.1.1.2" xref="S5.SS4.p1.1.m1.1.1.2a.cmml">g</mtext><mrow id="S5.SS4.p1.1.m1.1.1.3" xref="S5.SS4.p1.1.m1.1.1.3.cmml"><mi id="S5.SS4.p1.1.m1.1.1.3.2" xref="S5.SS4.p1.1.m1.1.1.3.2.cmml">o</mi><mo id="S5.SS4.p1.1.m1.1.1.3.1" xref="S5.SS4.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.1.m1.1.1.3.3" xref="S5.SS4.p1.1.m1.1.1.3.3.cmml">n</mi><mo id="S5.SS4.p1.1.m1.1.1.3.1a" xref="S5.SS4.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.1.m1.1.1.3.4" xref="S5.SS4.p1.1.m1.1.1.3.4.cmml">l</mi><mo id="S5.SS4.p1.1.m1.1.1.3.1b" xref="S5.SS4.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.1.m1.1.1.3.5" xref="S5.SS4.p1.1.m1.1.1.3.5.cmml">i</mi><mo id="S5.SS4.p1.1.m1.1.1.3.1c" xref="S5.SS4.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.1.m1.1.1.3.6" xref="S5.SS4.p1.1.m1.1.1.3.6.cmml">n</mi><mo id="S5.SS4.p1.1.m1.1.1.3.1d" xref="S5.SS4.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.1.m1.1.1.3.7" xref="S5.SS4.p1.1.m1.1.1.3.7.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.1.m1.1b"><apply id="S5.SS4.p1.1.m1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.1.m1.1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS4.p1.1.m1.1.1.2a.cmml" xref="S5.SS4.p1.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S5.SS4.p1.1.m1.1.1.2.cmml" xref="S5.SS4.p1.1.m1.1.1.2">g</mtext></ci><apply id="S5.SS4.p1.1.m1.1.1.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3"><times id="S5.SS4.p1.1.m1.1.1.3.1.cmml" xref="S5.SS4.p1.1.m1.1.1.3.1"></times><ci id="S5.SS4.p1.1.m1.1.1.3.2.cmml" xref="S5.SS4.p1.1.m1.1.1.3.2">𝑜</ci><ci id="S5.SS4.p1.1.m1.1.1.3.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3">𝑛</ci><ci id="S5.SS4.p1.1.m1.1.1.3.4.cmml" xref="S5.SS4.p1.1.m1.1.1.3.4">𝑙</ci><ci id="S5.SS4.p1.1.m1.1.1.3.5.cmml" xref="S5.SS4.p1.1.m1.1.1.3.5">𝑖</ci><ci id="S5.SS4.p1.1.m1.1.1.3.6.cmml" xref="S5.SS4.p1.1.m1.1.1.3.6">𝑛</ci><ci id="S5.SS4.p1.1.m1.1.1.3.7.cmml" xref="S5.SS4.p1.1.m1.1.1.3.7">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.1.m1.1c">\textbf{g}_{online}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.1.m1.1d">g start_POSTSUBSCRIPT italic_o italic_n italic_l italic_i italic_n italic_e end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="K" class="ltx_Math" display="inline" id="S5.SS4.p1.2.m2.1"><semantics id="S5.SS4.p1.2.m2.1a"><mi id="S5.SS4.p1.2.m2.1.1" xref="S5.SS4.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.2.m2.1b"><ci id="S5.SS4.p1.2.m2.1.1.cmml" xref="S5.SS4.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.2.m2.1d">italic_K</annotation></semantics></math>. The hyperparameter <math alttext="\textbf{g}_{online}" class="ltx_Math" display="inline" id="S5.SS4.p1.3.m3.1"><semantics id="S5.SS4.p1.3.m3.1a"><msub id="S5.SS4.p1.3.m3.1.1" xref="S5.SS4.p1.3.m3.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S5.SS4.p1.3.m3.1.1.2" xref="S5.SS4.p1.3.m3.1.1.2a.cmml">g</mtext><mrow id="S5.SS4.p1.3.m3.1.1.3" xref="S5.SS4.p1.3.m3.1.1.3.cmml"><mi id="S5.SS4.p1.3.m3.1.1.3.2" xref="S5.SS4.p1.3.m3.1.1.3.2.cmml">o</mi><mo id="S5.SS4.p1.3.m3.1.1.3.1" xref="S5.SS4.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.3.m3.1.1.3.3" xref="S5.SS4.p1.3.m3.1.1.3.3.cmml">n</mi><mo id="S5.SS4.p1.3.m3.1.1.3.1a" xref="S5.SS4.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.3.m3.1.1.3.4" xref="S5.SS4.p1.3.m3.1.1.3.4.cmml">l</mi><mo id="S5.SS4.p1.3.m3.1.1.3.1b" xref="S5.SS4.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.3.m3.1.1.3.5" xref="S5.SS4.p1.3.m3.1.1.3.5.cmml">i</mi><mo id="S5.SS4.p1.3.m3.1.1.3.1c" xref="S5.SS4.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.3.m3.1.1.3.6" xref="S5.SS4.p1.3.m3.1.1.3.6.cmml">n</mi><mo id="S5.SS4.p1.3.m3.1.1.3.1d" xref="S5.SS4.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.3.m3.1.1.3.7" xref="S5.SS4.p1.3.m3.1.1.3.7.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.3.m3.1b"><apply id="S5.SS4.p1.3.m3.1.1.cmml" xref="S5.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.3.m3.1.1.1.cmml" xref="S5.SS4.p1.3.m3.1.1">subscript</csymbol><ci id="S5.SS4.p1.3.m3.1.1.2a.cmml" xref="S5.SS4.p1.3.m3.1.1.2"><mtext class="ltx_mathvariant_bold" id="S5.SS4.p1.3.m3.1.1.2.cmml" xref="S5.SS4.p1.3.m3.1.1.2">g</mtext></ci><apply id="S5.SS4.p1.3.m3.1.1.3.cmml" xref="S5.SS4.p1.3.m3.1.1.3"><times id="S5.SS4.p1.3.m3.1.1.3.1.cmml" xref="S5.SS4.p1.3.m3.1.1.3.1"></times><ci id="S5.SS4.p1.3.m3.1.1.3.2.cmml" xref="S5.SS4.p1.3.m3.1.1.3.2">𝑜</ci><ci id="S5.SS4.p1.3.m3.1.1.3.3.cmml" xref="S5.SS4.p1.3.m3.1.1.3.3">𝑛</ci><ci id="S5.SS4.p1.3.m3.1.1.3.4.cmml" xref="S5.SS4.p1.3.m3.1.1.3.4">𝑙</ci><ci id="S5.SS4.p1.3.m3.1.1.3.5.cmml" xref="S5.SS4.p1.3.m3.1.1.3.5">𝑖</ci><ci id="S5.SS4.p1.3.m3.1.1.3.6.cmml" xref="S5.SS4.p1.3.m3.1.1.3.6">𝑛</ci><ci id="S5.SS4.p1.3.m3.1.1.3.7.cmml" xref="S5.SS4.p1.3.m3.1.1.3.7">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.3.m3.1c">\textbf{g}_{online}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.3.m3.1d">g start_POSTSUBSCRIPT italic_o italic_n italic_l italic_i italic_n italic_e end_POSTSUBSCRIPT</annotation></semantics></math>, set at 2 in our experiments, plays a crucial role in regulating exploration. Considering that the maximum reward per interaction is capped (e.g., at 10 in the VirtualTB environment), a smaller <math alttext="\textbf{g}_{online}" class="ltx_Math" display="inline" id="S5.SS4.p1.4.m4.1"><semantics id="S5.SS4.p1.4.m4.1a"><msub id="S5.SS4.p1.4.m4.1.1" xref="S5.SS4.p1.4.m4.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S5.SS4.p1.4.m4.1.1.2" xref="S5.SS4.p1.4.m4.1.1.2a.cmml">g</mtext><mrow id="S5.SS4.p1.4.m4.1.1.3" xref="S5.SS4.p1.4.m4.1.1.3.cmml"><mi id="S5.SS4.p1.4.m4.1.1.3.2" xref="S5.SS4.p1.4.m4.1.1.3.2.cmml">o</mi><mo id="S5.SS4.p1.4.m4.1.1.3.1" xref="S5.SS4.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.4.m4.1.1.3.3" xref="S5.SS4.p1.4.m4.1.1.3.3.cmml">n</mi><mo id="S5.SS4.p1.4.m4.1.1.3.1a" xref="S5.SS4.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.4.m4.1.1.3.4" xref="S5.SS4.p1.4.m4.1.1.3.4.cmml">l</mi><mo id="S5.SS4.p1.4.m4.1.1.3.1b" xref="S5.SS4.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.4.m4.1.1.3.5" xref="S5.SS4.p1.4.m4.1.1.3.5.cmml">i</mi><mo id="S5.SS4.p1.4.m4.1.1.3.1c" xref="S5.SS4.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.4.m4.1.1.3.6" xref="S5.SS4.p1.4.m4.1.1.3.6.cmml">n</mi><mo id="S5.SS4.p1.4.m4.1.1.3.1d" xref="S5.SS4.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.4.m4.1.1.3.7" xref="S5.SS4.p1.4.m4.1.1.3.7.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.4.m4.1b"><apply id="S5.SS4.p1.4.m4.1.1.cmml" xref="S5.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.4.m4.1.1.1.cmml" xref="S5.SS4.p1.4.m4.1.1">subscript</csymbol><ci id="S5.SS4.p1.4.m4.1.1.2a.cmml" xref="S5.SS4.p1.4.m4.1.1.2"><mtext class="ltx_mathvariant_bold" id="S5.SS4.p1.4.m4.1.1.2.cmml" xref="S5.SS4.p1.4.m4.1.1.2">g</mtext></ci><apply id="S5.SS4.p1.4.m4.1.1.3.cmml" xref="S5.SS4.p1.4.m4.1.1.3"><times id="S5.SS4.p1.4.m4.1.1.3.1.cmml" xref="S5.SS4.p1.4.m4.1.1.3.1"></times><ci id="S5.SS4.p1.4.m4.1.1.3.2.cmml" xref="S5.SS4.p1.4.m4.1.1.3.2">𝑜</ci><ci id="S5.SS4.p1.4.m4.1.1.3.3.cmml" xref="S5.SS4.p1.4.m4.1.1.3.3">𝑛</ci><ci id="S5.SS4.p1.4.m4.1.1.3.4.cmml" xref="S5.SS4.p1.4.m4.1.1.3.4">𝑙</ci><ci id="S5.SS4.p1.4.m4.1.1.3.5.cmml" xref="S5.SS4.p1.4.m4.1.1.3.5">𝑖</ci><ci id="S5.SS4.p1.4.m4.1.1.3.6.cmml" xref="S5.SS4.p1.4.m4.1.1.3.6">𝑛</ci><ci id="S5.SS4.p1.4.m4.1.1.3.7.cmml" xref="S5.SS4.p1.4.m4.1.1.3.7">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.4.m4.1c">\textbf{g}_{online}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.4.m4.1d">g start_POSTSUBSCRIPT italic_o italic_n italic_l italic_i italic_n italic_e end_POSTSUBSCRIPT</annotation></semantics></math> value is preferable to encourage exploration over exploitation during the fine-tuning phase. The results, illustrating the performance of EDT4Rec with varying <math alttext="\textbf{g}_{online}" class="ltx_Math" display="inline" id="S5.SS4.p1.5.m5.1"><semantics id="S5.SS4.p1.5.m5.1a"><msub id="S5.SS4.p1.5.m5.1.1" xref="S5.SS4.p1.5.m5.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S5.SS4.p1.5.m5.1.1.2" xref="S5.SS4.p1.5.m5.1.1.2a.cmml">g</mtext><mrow id="S5.SS4.p1.5.m5.1.1.3" xref="S5.SS4.p1.5.m5.1.1.3.cmml"><mi id="S5.SS4.p1.5.m5.1.1.3.2" xref="S5.SS4.p1.5.m5.1.1.3.2.cmml">o</mi><mo id="S5.SS4.p1.5.m5.1.1.3.1" xref="S5.SS4.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.5.m5.1.1.3.3" xref="S5.SS4.p1.5.m5.1.1.3.3.cmml">n</mi><mo id="S5.SS4.p1.5.m5.1.1.3.1a" xref="S5.SS4.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.5.m5.1.1.3.4" xref="S5.SS4.p1.5.m5.1.1.3.4.cmml">l</mi><mo id="S5.SS4.p1.5.m5.1.1.3.1b" xref="S5.SS4.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.5.m5.1.1.3.5" xref="S5.SS4.p1.5.m5.1.1.3.5.cmml">i</mi><mo id="S5.SS4.p1.5.m5.1.1.3.1c" xref="S5.SS4.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.5.m5.1.1.3.6" xref="S5.SS4.p1.5.m5.1.1.3.6.cmml">n</mi><mo id="S5.SS4.p1.5.m5.1.1.3.1d" xref="S5.SS4.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.5.m5.1.1.3.7" xref="S5.SS4.p1.5.m5.1.1.3.7.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.5.m5.1b"><apply id="S5.SS4.p1.5.m5.1.1.cmml" xref="S5.SS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.5.m5.1.1.1.cmml" xref="S5.SS4.p1.5.m5.1.1">subscript</csymbol><ci id="S5.SS4.p1.5.m5.1.1.2a.cmml" xref="S5.SS4.p1.5.m5.1.1.2"><mtext class="ltx_mathvariant_bold" id="S5.SS4.p1.5.m5.1.1.2.cmml" xref="S5.SS4.p1.5.m5.1.1.2">g</mtext></ci><apply id="S5.SS4.p1.5.m5.1.1.3.cmml" xref="S5.SS4.p1.5.m5.1.1.3"><times id="S5.SS4.p1.5.m5.1.1.3.1.cmml" xref="S5.SS4.p1.5.m5.1.1.3.1"></times><ci id="S5.SS4.p1.5.m5.1.1.3.2.cmml" xref="S5.SS4.p1.5.m5.1.1.3.2">𝑜</ci><ci id="S5.SS4.p1.5.m5.1.1.3.3.cmml" xref="S5.SS4.p1.5.m5.1.1.3.3">𝑛</ci><ci id="S5.SS4.p1.5.m5.1.1.3.4.cmml" xref="S5.SS4.p1.5.m5.1.1.3.4">𝑙</ci><ci id="S5.SS4.p1.5.m5.1.1.3.5.cmml" xref="S5.SS4.p1.5.m5.1.1.3.5">𝑖</ci><ci id="S5.SS4.p1.5.m5.1.1.3.6.cmml" xref="S5.SS4.p1.5.m5.1.1.3.6">𝑛</ci><ci id="S5.SS4.p1.5.m5.1.1.3.7.cmml" xref="S5.SS4.p1.5.m5.1.1.3.7">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.5.m5.1c">\textbf{g}_{online}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.5.m5.1d">g start_POSTSUBSCRIPT italic_o italic_n italic_l italic_i italic_n italic_e end_POSTSUBSCRIPT</annotation></semantics></math>, are presented in <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S5.F3.sf2" title="In Figure 3 ‣ 5.2. Baselines ‣ 5. Experiments ‣ Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">3(b)</span></a>. We observe that the optimal performance is achieved when <math alttext="\textbf{g}_{online}" class="ltx_Math" display="inline" id="S5.SS4.p1.6.m6.1"><semantics id="S5.SS4.p1.6.m6.1a"><msub id="S5.SS4.p1.6.m6.1.1" xref="S5.SS4.p1.6.m6.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S5.SS4.p1.6.m6.1.1.2" xref="S5.SS4.p1.6.m6.1.1.2a.cmml">g</mtext><mrow id="S5.SS4.p1.6.m6.1.1.3" xref="S5.SS4.p1.6.m6.1.1.3.cmml"><mi id="S5.SS4.p1.6.m6.1.1.3.2" xref="S5.SS4.p1.6.m6.1.1.3.2.cmml">o</mi><mo id="S5.SS4.p1.6.m6.1.1.3.1" xref="S5.SS4.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.6.m6.1.1.3.3" xref="S5.SS4.p1.6.m6.1.1.3.3.cmml">n</mi><mo id="S5.SS4.p1.6.m6.1.1.3.1a" xref="S5.SS4.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.6.m6.1.1.3.4" xref="S5.SS4.p1.6.m6.1.1.3.4.cmml">l</mi><mo id="S5.SS4.p1.6.m6.1.1.3.1b" xref="S5.SS4.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.6.m6.1.1.3.5" xref="S5.SS4.p1.6.m6.1.1.3.5.cmml">i</mi><mo id="S5.SS4.p1.6.m6.1.1.3.1c" xref="S5.SS4.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.6.m6.1.1.3.6" xref="S5.SS4.p1.6.m6.1.1.3.6.cmml">n</mi><mo id="S5.SS4.p1.6.m6.1.1.3.1d" xref="S5.SS4.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.6.m6.1.1.3.7" xref="S5.SS4.p1.6.m6.1.1.3.7.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.6.m6.1b"><apply id="S5.SS4.p1.6.m6.1.1.cmml" xref="S5.SS4.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.6.m6.1.1.1.cmml" xref="S5.SS4.p1.6.m6.1.1">subscript</csymbol><ci id="S5.SS4.p1.6.m6.1.1.2a.cmml" xref="S5.SS4.p1.6.m6.1.1.2"><mtext class="ltx_mathvariant_bold" id="S5.SS4.p1.6.m6.1.1.2.cmml" xref="S5.SS4.p1.6.m6.1.1.2">g</mtext></ci><apply id="S5.SS4.p1.6.m6.1.1.3.cmml" xref="S5.SS4.p1.6.m6.1.1.3"><times id="S5.SS4.p1.6.m6.1.1.3.1.cmml" xref="S5.SS4.p1.6.m6.1.1.3.1"></times><ci id="S5.SS4.p1.6.m6.1.1.3.2.cmml" xref="S5.SS4.p1.6.m6.1.1.3.2">𝑜</ci><ci id="S5.SS4.p1.6.m6.1.1.3.3.cmml" xref="S5.SS4.p1.6.m6.1.1.3.3">𝑛</ci><ci id="S5.SS4.p1.6.m6.1.1.3.4.cmml" xref="S5.SS4.p1.6.m6.1.1.3.4">𝑙</ci><ci id="S5.SS4.p1.6.m6.1.1.3.5.cmml" xref="S5.SS4.p1.6.m6.1.1.3.5">𝑖</ci><ci id="S5.SS4.p1.6.m6.1.1.3.6.cmml" xref="S5.SS4.p1.6.m6.1.1.3.6">𝑛</ci><ci id="S5.SS4.p1.6.m6.1.1.3.7.cmml" xref="S5.SS4.p1.6.m6.1.1.3.7">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.6.m6.1c">\textbf{g}_{online}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.6.m6.1d">g start_POSTSUBSCRIPT italic_o italic_n italic_l italic_i italic_n italic_e end_POSTSUBSCRIPT</annotation></semantics></math> is set to 2.
Turning our attention to the context length <math alttext="K" class="ltx_Math" display="inline" id="S5.SS4.p1.7.m7.1"><semantics id="S5.SS4.p1.7.m7.1a"><mi id="S5.SS4.p1.7.m7.1.1" xref="S5.SS4.p1.7.m7.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.7.m7.1b"><ci id="S5.SS4.p1.7.m7.1.1.cmml" xref="S5.SS4.p1.7.m7.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.7.m7.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.7.m7.1d">italic_K</annotation></semantics></math>, this parameter determines the number of previous actions accessible to the RTG. Following insights from previous work <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#bib.bib25" title="">2023</a>)</cite> that suggest a smaller context length is beneficial, we explore a range of <math alttext="K" class="ltx_Math" display="inline" id="S5.SS4.p1.8.m8.1"><semantics id="S5.SS4.p1.8.m8.1a"><mi id="S5.SS4.p1.8.m8.1.1" xref="S5.SS4.p1.8.m8.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.8.m8.1b"><ci id="S5.SS4.p1.8.m8.1.1.cmml" xref="S5.SS4.p1.8.m8.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.8.m8.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.8.m8.1d">italic_K</annotation></semantics></math> values: <math alttext="\{2,4,6,8,10\}" class="ltx_Math" display="inline" id="S5.SS4.p1.9.m9.5"><semantics id="S5.SS4.p1.9.m9.5a"><mrow id="S5.SS4.p1.9.m9.5.6.2" xref="S5.SS4.p1.9.m9.5.6.1.cmml"><mo id="S5.SS4.p1.9.m9.5.6.2.1" stretchy="false" xref="S5.SS4.p1.9.m9.5.6.1.cmml">{</mo><mn id="S5.SS4.p1.9.m9.1.1" xref="S5.SS4.p1.9.m9.1.1.cmml">2</mn><mo id="S5.SS4.p1.9.m9.5.6.2.2" xref="S5.SS4.p1.9.m9.5.6.1.cmml">,</mo><mn id="S5.SS4.p1.9.m9.2.2" xref="S5.SS4.p1.9.m9.2.2.cmml">4</mn><mo id="S5.SS4.p1.9.m9.5.6.2.3" xref="S5.SS4.p1.9.m9.5.6.1.cmml">,</mo><mn id="S5.SS4.p1.9.m9.3.3" xref="S5.SS4.p1.9.m9.3.3.cmml">6</mn><mo id="S5.SS4.p1.9.m9.5.6.2.4" xref="S5.SS4.p1.9.m9.5.6.1.cmml">,</mo><mn id="S5.SS4.p1.9.m9.4.4" xref="S5.SS4.p1.9.m9.4.4.cmml">8</mn><mo id="S5.SS4.p1.9.m9.5.6.2.5" xref="S5.SS4.p1.9.m9.5.6.1.cmml">,</mo><mn id="S5.SS4.p1.9.m9.5.5" xref="S5.SS4.p1.9.m9.5.5.cmml">10</mn><mo id="S5.SS4.p1.9.m9.5.6.2.6" stretchy="false" xref="S5.SS4.p1.9.m9.5.6.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.9.m9.5b"><set id="S5.SS4.p1.9.m9.5.6.1.cmml" xref="S5.SS4.p1.9.m9.5.6.2"><cn id="S5.SS4.p1.9.m9.1.1.cmml" type="integer" xref="S5.SS4.p1.9.m9.1.1">2</cn><cn id="S5.SS4.p1.9.m9.2.2.cmml" type="integer" xref="S5.SS4.p1.9.m9.2.2">4</cn><cn id="S5.SS4.p1.9.m9.3.3.cmml" type="integer" xref="S5.SS4.p1.9.m9.3.3">6</cn><cn id="S5.SS4.p1.9.m9.4.4.cmml" type="integer" xref="S5.SS4.p1.9.m9.4.4">8</cn><cn id="S5.SS4.p1.9.m9.5.5.cmml" type="integer" xref="S5.SS4.p1.9.m9.5.5">10</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.9.m9.5c">\{2,4,6,8,10\}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.9.m9.5d">{ 2 , 4 , 6 , 8 , 10 }</annotation></semantics></math>, while keeping <math alttext="\textbf{g}_{online}" class="ltx_Math" display="inline" id="S5.SS4.p1.10.m10.1"><semantics id="S5.SS4.p1.10.m10.1a"><msub id="S5.SS4.p1.10.m10.1.1" xref="S5.SS4.p1.10.m10.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S5.SS4.p1.10.m10.1.1.2" xref="S5.SS4.p1.10.m10.1.1.2a.cmml">g</mtext><mrow id="S5.SS4.p1.10.m10.1.1.3" xref="S5.SS4.p1.10.m10.1.1.3.cmml"><mi id="S5.SS4.p1.10.m10.1.1.3.2" xref="S5.SS4.p1.10.m10.1.1.3.2.cmml">o</mi><mo id="S5.SS4.p1.10.m10.1.1.3.1" xref="S5.SS4.p1.10.m10.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.10.m10.1.1.3.3" xref="S5.SS4.p1.10.m10.1.1.3.3.cmml">n</mi><mo id="S5.SS4.p1.10.m10.1.1.3.1a" xref="S5.SS4.p1.10.m10.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.10.m10.1.1.3.4" xref="S5.SS4.p1.10.m10.1.1.3.4.cmml">l</mi><mo id="S5.SS4.p1.10.m10.1.1.3.1b" xref="S5.SS4.p1.10.m10.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.10.m10.1.1.3.5" xref="S5.SS4.p1.10.m10.1.1.3.5.cmml">i</mi><mo id="S5.SS4.p1.10.m10.1.1.3.1c" xref="S5.SS4.p1.10.m10.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.10.m10.1.1.3.6" xref="S5.SS4.p1.10.m10.1.1.3.6.cmml">n</mi><mo id="S5.SS4.p1.10.m10.1.1.3.1d" xref="S5.SS4.p1.10.m10.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.10.m10.1.1.3.7" xref="S5.SS4.p1.10.m10.1.1.3.7.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.10.m10.1b"><apply id="S5.SS4.p1.10.m10.1.1.cmml" xref="S5.SS4.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.10.m10.1.1.1.cmml" xref="S5.SS4.p1.10.m10.1.1">subscript</csymbol><ci id="S5.SS4.p1.10.m10.1.1.2a.cmml" xref="S5.SS4.p1.10.m10.1.1.2"><mtext class="ltx_mathvariant_bold" id="S5.SS4.p1.10.m10.1.1.2.cmml" xref="S5.SS4.p1.10.m10.1.1.2">g</mtext></ci><apply id="S5.SS4.p1.10.m10.1.1.3.cmml" xref="S5.SS4.p1.10.m10.1.1.3"><times id="S5.SS4.p1.10.m10.1.1.3.1.cmml" xref="S5.SS4.p1.10.m10.1.1.3.1"></times><ci id="S5.SS4.p1.10.m10.1.1.3.2.cmml" xref="S5.SS4.p1.10.m10.1.1.3.2">𝑜</ci><ci id="S5.SS4.p1.10.m10.1.1.3.3.cmml" xref="S5.SS4.p1.10.m10.1.1.3.3">𝑛</ci><ci id="S5.SS4.p1.10.m10.1.1.3.4.cmml" xref="S5.SS4.p1.10.m10.1.1.3.4">𝑙</ci><ci id="S5.SS4.p1.10.m10.1.1.3.5.cmml" xref="S5.SS4.p1.10.m10.1.1.3.5">𝑖</ci><ci id="S5.SS4.p1.10.m10.1.1.3.6.cmml" xref="S5.SS4.p1.10.m10.1.1.3.6">𝑛</ci><ci id="S5.SS4.p1.10.m10.1.1.3.7.cmml" xref="S5.SS4.p1.10.m10.1.1.3.7">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.10.m10.1c">\textbf{g}_{online}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.10.m10.1d">g start_POSTSUBSCRIPT italic_o italic_n italic_l italic_i italic_n italic_e end_POSTSUBSCRIPT</annotation></semantics></math> fixed at 2. Similar to <math alttext="\textbf{g}_{online}" class="ltx_Math" display="inline" id="S5.SS4.p1.11.m11.1"><semantics id="S5.SS4.p1.11.m11.1a"><msub id="S5.SS4.p1.11.m11.1.1" xref="S5.SS4.p1.11.m11.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S5.SS4.p1.11.m11.1.1.2" xref="S5.SS4.p1.11.m11.1.1.2a.cmml">g</mtext><mrow id="S5.SS4.p1.11.m11.1.1.3" xref="S5.SS4.p1.11.m11.1.1.3.cmml"><mi id="S5.SS4.p1.11.m11.1.1.3.2" xref="S5.SS4.p1.11.m11.1.1.3.2.cmml">o</mi><mo id="S5.SS4.p1.11.m11.1.1.3.1" xref="S5.SS4.p1.11.m11.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.11.m11.1.1.3.3" xref="S5.SS4.p1.11.m11.1.1.3.3.cmml">n</mi><mo id="S5.SS4.p1.11.m11.1.1.3.1a" xref="S5.SS4.p1.11.m11.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.11.m11.1.1.3.4" xref="S5.SS4.p1.11.m11.1.1.3.4.cmml">l</mi><mo id="S5.SS4.p1.11.m11.1.1.3.1b" xref="S5.SS4.p1.11.m11.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.11.m11.1.1.3.5" xref="S5.SS4.p1.11.m11.1.1.3.5.cmml">i</mi><mo id="S5.SS4.p1.11.m11.1.1.3.1c" xref="S5.SS4.p1.11.m11.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.11.m11.1.1.3.6" xref="S5.SS4.p1.11.m11.1.1.3.6.cmml">n</mi><mo id="S5.SS4.p1.11.m11.1.1.3.1d" xref="S5.SS4.p1.11.m11.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.11.m11.1.1.3.7" xref="S5.SS4.p1.11.m11.1.1.3.7.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.11.m11.1b"><apply id="S5.SS4.p1.11.m11.1.1.cmml" xref="S5.SS4.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.11.m11.1.1.1.cmml" xref="S5.SS4.p1.11.m11.1.1">subscript</csymbol><ci id="S5.SS4.p1.11.m11.1.1.2a.cmml" xref="S5.SS4.p1.11.m11.1.1.2"><mtext class="ltx_mathvariant_bold" id="S5.SS4.p1.11.m11.1.1.2.cmml" xref="S5.SS4.p1.11.m11.1.1.2">g</mtext></ci><apply id="S5.SS4.p1.11.m11.1.1.3.cmml" xref="S5.SS4.p1.11.m11.1.1.3"><times id="S5.SS4.p1.11.m11.1.1.3.1.cmml" xref="S5.SS4.p1.11.m11.1.1.3.1"></times><ci id="S5.SS4.p1.11.m11.1.1.3.2.cmml" xref="S5.SS4.p1.11.m11.1.1.3.2">𝑜</ci><ci id="S5.SS4.p1.11.m11.1.1.3.3.cmml" xref="S5.SS4.p1.11.m11.1.1.3.3">𝑛</ci><ci id="S5.SS4.p1.11.m11.1.1.3.4.cmml" xref="S5.SS4.p1.11.m11.1.1.3.4">𝑙</ci><ci id="S5.SS4.p1.11.m11.1.1.3.5.cmml" xref="S5.SS4.p1.11.m11.1.1.3.5">𝑖</ci><ci id="S5.SS4.p1.11.m11.1.1.3.6.cmml" xref="S5.SS4.p1.11.m11.1.1.3.6">𝑛</ci><ci id="S5.SS4.p1.11.m11.1.1.3.7.cmml" xref="S5.SS4.p1.11.m11.1.1.3.7">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.11.m11.1c">\textbf{g}_{online}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.11.m11.1d">g start_POSTSUBSCRIPT italic_o italic_n italic_l italic_i italic_n italic_e end_POSTSUBSCRIPT</annotation></semantics></math>, the average CTR over 100,000 timesteps for different <math alttext="K" class="ltx_Math" display="inline" id="S5.SS4.p1.12.m12.1"><semantics id="S5.SS4.p1.12.m12.1a"><mi id="S5.SS4.p1.12.m12.1.1" xref="S5.SS4.p1.12.m12.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.12.m12.1b"><ci id="S5.SS4.p1.12.m12.1.1.cmml" xref="S5.SS4.p1.12.m12.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.12.m12.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.12.m12.1d">italic_K</annotation></semantics></math> values is reported in <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S5.F3.sf3" title="In Figure 3 ‣ 5.2. Baselines ‣ 5. Experiments ‣ Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">3(c)</span></a>. It becomes evident that the proposed EDT4Rec model reaches its peak performance when both <math alttext="K" class="ltx_Math" display="inline" id="S5.SS4.p1.13.m13.1"><semantics id="S5.SS4.p1.13.m13.1a"><mi id="S5.SS4.p1.13.m13.1.1" xref="S5.SS4.p1.13.m13.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.13.m13.1b"><ci id="S5.SS4.p1.13.m13.1.1.cmml" xref="S5.SS4.p1.13.m13.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.13.m13.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.13.m13.1d">italic_K</annotation></semantics></math> and <math alttext="\textbf{g}_{online}" class="ltx_Math" display="inline" id="S5.SS4.p1.14.m14.1"><semantics id="S5.SS4.p1.14.m14.1a"><msub id="S5.SS4.p1.14.m14.1.1" xref="S5.SS4.p1.14.m14.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S5.SS4.p1.14.m14.1.1.2" xref="S5.SS4.p1.14.m14.1.1.2a.cmml">g</mtext><mrow id="S5.SS4.p1.14.m14.1.1.3" xref="S5.SS4.p1.14.m14.1.1.3.cmml"><mi id="S5.SS4.p1.14.m14.1.1.3.2" xref="S5.SS4.p1.14.m14.1.1.3.2.cmml">o</mi><mo id="S5.SS4.p1.14.m14.1.1.3.1" xref="S5.SS4.p1.14.m14.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.14.m14.1.1.3.3" xref="S5.SS4.p1.14.m14.1.1.3.3.cmml">n</mi><mo id="S5.SS4.p1.14.m14.1.1.3.1a" xref="S5.SS4.p1.14.m14.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.14.m14.1.1.3.4" xref="S5.SS4.p1.14.m14.1.1.3.4.cmml">l</mi><mo id="S5.SS4.p1.14.m14.1.1.3.1b" xref="S5.SS4.p1.14.m14.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.14.m14.1.1.3.5" xref="S5.SS4.p1.14.m14.1.1.3.5.cmml">i</mi><mo id="S5.SS4.p1.14.m14.1.1.3.1c" xref="S5.SS4.p1.14.m14.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.14.m14.1.1.3.6" xref="S5.SS4.p1.14.m14.1.1.3.6.cmml">n</mi><mo id="S5.SS4.p1.14.m14.1.1.3.1d" xref="S5.SS4.p1.14.m14.1.1.3.1.cmml">⁢</mo><mi id="S5.SS4.p1.14.m14.1.1.3.7" xref="S5.SS4.p1.14.m14.1.1.3.7.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.14.m14.1b"><apply id="S5.SS4.p1.14.m14.1.1.cmml" xref="S5.SS4.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.14.m14.1.1.1.cmml" xref="S5.SS4.p1.14.m14.1.1">subscript</csymbol><ci id="S5.SS4.p1.14.m14.1.1.2a.cmml" xref="S5.SS4.p1.14.m14.1.1.2"><mtext class="ltx_mathvariant_bold" id="S5.SS4.p1.14.m14.1.1.2.cmml" xref="S5.SS4.p1.14.m14.1.1.2">g</mtext></ci><apply id="S5.SS4.p1.14.m14.1.1.3.cmml" xref="S5.SS4.p1.14.m14.1.1.3"><times id="S5.SS4.p1.14.m14.1.1.3.1.cmml" xref="S5.SS4.p1.14.m14.1.1.3.1"></times><ci id="S5.SS4.p1.14.m14.1.1.3.2.cmml" xref="S5.SS4.p1.14.m14.1.1.3.2">𝑜</ci><ci id="S5.SS4.p1.14.m14.1.1.3.3.cmml" xref="S5.SS4.p1.14.m14.1.1.3.3">𝑛</ci><ci id="S5.SS4.p1.14.m14.1.1.3.4.cmml" xref="S5.SS4.p1.14.m14.1.1.3.4">𝑙</ci><ci id="S5.SS4.p1.14.m14.1.1.3.5.cmml" xref="S5.SS4.p1.14.m14.1.1.3.5">𝑖</ci><ci id="S5.SS4.p1.14.m14.1.1.3.6.cmml" xref="S5.SS4.p1.14.m14.1.1.3.6">𝑛</ci><ci id="S5.SS4.p1.14.m14.1.1.3.7.cmml" xref="S5.SS4.p1.14.m14.1.1.3.7">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.14.m14.1c">\textbf{g}_{online}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.14.m14.1d">g start_POSTSUBSCRIPT italic_o italic_n italic_l italic_i italic_n italic_e end_POSTSUBSCRIPT</annotation></semantics></math> are set to 2.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5. </span>Ablation Study (RQ3)</h3>
<div class="ltx_para" id="S5.SS5.p1">
<p class="ltx_p" id="S5.SS5.p1.1">In order to comprehensively understand the impact of exploration and reward relabeling on the proposed EDT4Rec model, we conducted an ablation study. This study isolates the effects of these components by evaluating two variations of EDT4Rec: EDT4Rec-E, which excludes the online exploration goal, and EDT4Rec-R, which omits the reward relabeling feature.
The results of this study, shows in <a class="ltx_ref" href="https://arxiv.org/html/2406.00725v1#S5.F4" title="In 5.5. Ablation Study (RQ3) ‣ 5. Experiments ‣ Maximum-Entropy Regularized Decision Transformer with Reward Relabelling for Dynamic Recommendation"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">4</span></a>, provides some insightful trends. Notably, in the absence of the exploration component (EDT4Rec-E), the model initially outperforms the complete EDT4Rec. This could be attributed to EDT4Rec-E solely leveraging exploitation based on previously learned policies without engaging in exploration. However, as the agent encounters unfamiliar states over time, the lack of exploration leads to a decline in performance due to the inadequacy of the existing policy in making accurate recommendations in these new scenarios.
In addition, the removal of the reward relabeling component in EDT4Rec-R results in a significant drop in performance. This outcome underscores the critical role of online exploration in the effectiveness of EDT4Rec. The inability to adaptively relabel rewards based on online experiences evidently hampers the model’s ability to effectively navigate and learn from the environment, thereby highlighting the essential contribution of each component to the overall success of the EDT4Rec model. It also support out claim about that DT lacks the capability of stitching.</p>
</div>
<figure class="ltx_figure" id="S5.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="359" id="S5.F4.g1" src="extracted/5637914/EDT_ablation.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F4.2.1.1" style="font-size:90%;">Figure 4</span>. </span><span class="ltx_text" id="S5.F4.3.2" style="font-size:90%;">Ablation Study</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this study, we introduced Max-Entropy enhanced Decision Transformer with Reward Relabeling for Offline RLRS (EDT4Rec), a novel model crafted to overcome two significant challenges in Decision Transformer (DT)-based systems: i) the lack of stitching capability, and ii) insufficient online exploration, which can lead to sub-optimal performance in scenarios with sub-optimal datasets. Our comprehensive experiments demonstrate that EDT4Rec surpasses existing DT-based methods in performance.
Looking ahead, our future work will delve deeper into the stitching problem. Although the current reward relabeling strategy in EDT4Rec relies on learned value functions from optimal trajectories, such trajectories may not always be available. Therefore, we aim to develop a more straightforward method of reward relabeling, one that does not necessitate reliance on optimal trajectories. This advancement will further enhance the applicability and robustness of EDT4Rec in diverse real-world scenarios.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Xueying Bai, Jian Guan, and Hongning Wang. 2019.

</span>
<span class="ltx_bibblock">A model-based reinforcement learning with adversarial training for online recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.3.1">Advances in Neural Information Processing Systems</em> 32 (2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cai et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Han Cai, Kan Ren, Weinan Zhang, Kleanthis Malialis, Jun Wang, Yong Yu, and Defeng Guo. 2017.

</span>
<span class="ltx_bibblock">Real-time bidding by reinforcement learning in display advertising. In <em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">Proceedings of the tenth ACM international conference on web search and data mining</em>. 661–670.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cai et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Qingpeng Cai, Aris Filos-Ratsikas, Pingzhong Tang, and Yiwei Zhang. 2018.

</span>
<span class="ltx_bibblock">Reinforcement Mechanism Design for e-commerce. In <em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">Proceedings of the 2018 World Wide Web Conference</em>. 1339–1348.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2021a)</span>
<span class="ltx_bibblock">
Lili Chen, Kevin Lu, Aravind Rajeswaran, Kimin Lee, Aditya Grover, Misha Laskin, Pieter Abbeel, Aravind Srinivas, and Igor Mordatch. 2021a.

</span>
<span class="ltx_bibblock">Decision transformer: Reinforcement learning via sequence modeling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">Advances in neural information processing systems</em> 34 (2021), 15084–15097.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen (2021)</span>
<span class="ltx_bibblock">
Minmin Chen. 2021.

</span>
<span class="ltx_bibblock">Exploration in recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Proceedings of the 15th ACM Conference on Recommender Systems</em>. 551–553.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Xiaocong Chen, Chaoran Huang, Lina Yao, Xianzhi Wang, Wenjie Zhang, et al<span class="ltx_text" id="bib.bib7.3.1">.</span> 2020.

</span>
<span class="ltx_bibblock">Knowledge-guided deep reinforcement learning for interactive recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib7.4.1">2020 International Joint Conference on Neural Networks (IJCNN)</em>. IEEE, 1–8.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Xiaocong Chen, Siyu Wang, Julian McAuley, Dietmar Jannach, and Lina Yao. 2023a.

</span>
<span class="ltx_bibblock">On the Opportunities and Challenges of Offline Reinforcement Learning for Recommender Systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">arXiv preprint arXiv:2308.11336</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Xiaocong Chen, Lina Yao, Julian McAuley, Weili Guan, Xiaojun Chang, and Xianzhi Wang. 2022.

</span>
<span class="ltx_bibblock">Locality-sensitive state-guided experience replay optimization for sparse rewards in online recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">Proceedings of the 45th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>. 1316–1325.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Xiaocong Chen, Lina Yao, Julian McAuley, Guanglin Zhou, and Xianzhi Wang. 2023b.

</span>
<span class="ltx_bibblock">Deep reinforcement learning in recommender systems: A survey and new perspectives.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">Knowledge-Based Systems</em> 264 (2023), 110335.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2021b)</span>
<span class="ltx_bibblock">
Xiaocong Chen, Lina Yao, Aixin Sun, Xianzhi Wang, Xiwei Xu, and Liming Zhu. 2021b.

</span>
<span class="ltx_bibblock">Generative inverse deep reinforcement learning for online recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">Proceedings of the 30th ACM International Conference on Information &amp; Knowledge Management</em>. 201–210.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fujimoto et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Scott Fujimoto, Herke van Hoof, and David Meger. 2018.

</span>
<span class="ltx_bibblock">Addressing Function Approximation Error in Actor-Critic Methods. In <em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">Proceedings of the 35th International Conference on Machine Learning, ICML 2018, Stockholmsmässan, Stockholm, Sweden, July 10-15, 2018</em> <em class="ltx_emph ltx_font_italic" id="bib.bib12.4.2">(Proceedings of Machine Learning Research, Vol. 80)</em>. PMLR, 1582–1591.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="http://proceedings.mlr.press/v80/fujimoto18a.html" title="">http://proceedings.mlr.press/v80/fujimoto18a.html</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Chongming Gao, Kexin Huang, Jiawei Chen, Yuan Zhang, Biao Li, Peng Jiang, Shiqi Wang, Zhong Zhang, and Xiangnan He. 2023.

</span>
<span class="ltx_bibblock">Alleviating matthew effect of offline reinforcement learning in interactive recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">arXiv preprint arXiv:2307.04571</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Chongming Gao, Shijun Li, Yuan Zhang, Jiawei Chen, Biao Li, Wenqiang Lei, Peng Jiang, and Xiangnan He. 2022.

</span>
<span class="ltx_bibblock">KuaiRand: An Unbiased Sequential Recommendation Dataset with Randomly Exposed Videos. In <em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">Proceedings of the 31st ACM International Conference on Information and Knowledge Management</em> (Atlanta, GA, USA) <em class="ltx_emph ltx_font_italic" id="bib.bib14.4.2">(CIKM ’22)</em>. 3953–3957.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3511808.3557624" title="">https://doi.org/10.1145/3511808.3557624</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Haarnoja et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Tuomas Haarnoja, Aurick Zhou, Pieter Abbeel, and Sergey Levine. 2018.

</span>
<span class="ltx_bibblock">Soft actor-critic: Off-policy maximum entropy deep reinforcement learning with a stochastic actor. In <em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">International conference on machine learning</em>. PMLR, 1861–1870.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Yujing Hu, Qing Da, Anxiang Zeng, Yang Yu, and Yinghui Xu. 2018.

</span>
<span class="ltx_bibblock">Reinforcement learning to rank in e-commerce search engine: Formalization, analysis, and application. In <em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">Proceedings of the 24th ACM SIGKDD international conference on knowledge discovery &amp; data mining</em>. 368–377.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kumar et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Aviral Kumar, Aurick Zhou, George Tucker, and Sergey Levine. 2020.

</span>
<span class="ltx_bibblock">Conservative q-learning for offline reinforcement learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">Advances in Neural Information Processing Systems</em> 33 (2020), 1179–1191.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Levine et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Sergey Levine, Aviral Kumar, George Tucker, and Justin Fu. 2020.

</span>
<span class="ltx_bibblock">Offline reinforcement learning: Tutorial, review, and perspectives on open problems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">arXiv preprint arXiv:2005.01643</em> (2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Wenzhe Li, Hao Luo, Zichuan Lin, Chongjie Zhang, Zongqing Lu, and Deheng Ye. 2023.

</span>
<span class="ltx_bibblock">A survey on transformers in reinforcement learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">arXiv preprint arXiv:2301.03044</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lillicrap et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Timothy P. Lillicrap, Jonathan J. Hunt, Alexander Pritzel, Nicolas Heess, Tom Erez, Yuval Tassa, David Silver, and Daan Wierstra. 2016.

</span>
<span class="ltx_bibblock">Continuous control with deep reinforcement learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">4th International Conference on Learning Representations, ICLR 2016, San Juan, Puerto Rico, May 2-4, 2016, Conference Track Proceedings</em>.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="http://arxiv.org/abs/1509.02971" title="">http://arxiv.org/abs/1509.02971</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mnih et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2013)</span>
<span class="ltx_bibblock">
Volodymyr Mnih, Koray Kavukcuoglu, David Silver, Alex Graves, Ioannis Antonoglou, Daan Wierstra, and Martin Riedmiller. 2013.

</span>
<span class="ltx_bibblock">Playing atari with deep reinforcement learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">arXiv preprint arXiv:1312.5602</em> (2013).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nair et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Ashvin Nair, Abhishek Gupta, Murtaza Dalal, and Sergey Levine. 2020.

</span>
<span class="ltx_bibblock">Awac: Accelerating online reinforcement learning with offline datasets.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">arXiv preprint arXiv:2006.09359</em> (2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shi et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Jing-Cheng Shi, Yang Yu, Qing Da, Shi-Yong Chen, and An-Xiang Zeng. 2019.

</span>
<span class="ltx_bibblock">Virtual-Taobao: Virtualizing Real-World Online Retail Environment for Reinforcement Learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, Vol. 33. 4902–4909.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wan and McAuley (2018)</span>
<span class="ltx_bibblock">
Mengting Wan and Julian McAuley. 2018.

</span>
<span class="ltx_bibblock">Item Recommendation on Monotonic Behavior Chains. In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Proceedings of the 12th ACM Conference on Recommender Systems</em> (Vancouver, British Columbia, Canada) <em class="ltx_emph ltx_font_italic" id="bib.bib24.2.2">(RecSys ’18)</em>. Association for Computing Machinery, New York, NY, USA, 86–94.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3240323.3240369" title="">https://doi.org/10.1145/3240323.3240369</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Siyu Wang, Xiaocong Chen, Dietmar Jannach, and Lina Yao. 2023.

</span>
<span class="ltx_bibblock">Causal Decision Transformer for Recommender Systems via Offline Reinforcement Learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval</em> (Taipei, Taiwan) <em class="ltx_emph ltx_font_italic" id="bib.bib25.4.2">(SIGIR ’23)</em>. Association for Computing Machinery, New York, NY, USA, 1599–1608.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3539618.3591648" title="">https://doi.org/10.1145/3539618.3591648</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yamagata et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Taku Yamagata, Ahmed Khalil, and Raul Santos-Rodriguez. 2023.

</span>
<span class="ltx_bibblock">Q-learning decision transformer: Leveraging dynamic programming for conditional sequence modelling in offline rl. In <em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">International Conference on Machine Learning</em>. PMLR, 38989–39007.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Kesen Zhao, Lixin Zou, Xiangyu Zhao, Maolin Wang, and Dawei Yin. 2023.

</span>
<span class="ltx_bibblock">User Retention-oriented Recommendation with Decision Transformer. In <em class="ltx_emph ltx_font_italic" id="bib.bib27.3.1">Proceedings of the ACM Web Conference 2023</em>. 1141–1149.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Xiangyu Zhao, Long Xia, Liang Zhang, Zhuoye Ding, Dawei Yin, and Jiliang Tang. 2018.

</span>
<span class="ltx_bibblock">Deep reinforcement learning for page-wise recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">Proceedings of the 12th ACM Conference on Recommender Systems</em>. 95–103.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Guanjie Zheng, Fuzheng Zhang, Zihan Zheng, Yang Xiang, Nicholas Jing Yuan, Xing Xie, and Zhenhui Li. 2018.

</span>
<span class="ltx_bibblock">DRN: A deep reinforcement learning framework for news recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib29.3.1">Proceedings of the 2018 World Wide Web Conference</em>. 167–176.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Qinqing Zheng, Amy Zhang, and Aditya Grover. 2022.

</span>
<span class="ltx_bibblock">Online decision transformer. In <em class="ltx_emph ltx_font_italic" id="bib.bib30.3.1">international conference on machine learning</em>. PMLR, 27042–27059.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ziegler et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2005)</span>
<span class="ltx_bibblock">
Cai-Nicolas Ziegler, Sean M. McNee, Joseph A. Konstan, and Georg Lausen. 2005.

</span>
<span class="ltx_bibblock">Improving Recommendation Lists through Topic Diversification. In <em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">Proceedings of the 14th International Conference on World Wide Web</em> (Chiba, Japan) <em class="ltx_emph ltx_font_italic" id="bib.bib31.4.2">(WWW ’05)</em>. Association for Computing Machinery, New York, NY, USA, 22–32.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/1060745.1060754" title="">https://doi.org/10.1145/1060745.1060754</a>
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sun Jun  2 12:15:11 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
