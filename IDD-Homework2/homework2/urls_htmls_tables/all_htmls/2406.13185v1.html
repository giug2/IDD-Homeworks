<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2406.13185] Learnable In-Context Vector for Visual Question Answering</title><meta property="og:description" content="As language models continue to scale, Large Language Models (LLMs) have exhibited emerging capabilities in In-Context Learning (ICL), enabling them to solve language tasks by prefixing a few in-context demonstrations (…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Learnable In-Context Vector for Visual Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Learnable In-Context Vector for Visual Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2406.13185">

<!--Generated on Fri Jul  5 20:05:51 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Learnable In-Context Vector for Visual Question Answering</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yingzhe Peng<sup id="id9.9.id1" class="ltx_sup"><span id="id9.9.id1.1" class="ltx_text ltx_font_italic">1</span></sup>, Chenduo Hao<sup id="id10.10.id2" class="ltx_sup"><span id="id10.10.id2.1" class="ltx_text ltx_font_italic">1</span></sup>, Xu Yang<sup id="id11.11.id3" class="ltx_sup">1</sup><span id="footnotex1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Corresponding author.</span></span></span>, Jiawei Peng<sup id="id12.12.id4" class="ltx_sup">1</sup>, Xinting Hu<sup id="id13.13.id5" class="ltx_sup"><span id="id13.13.id5.1" class="ltx_text ltx_font_italic">2</span></sup>, Xin Geng<sup id="id14.14.id6" class="ltx_sup">1</sup> 
<br class="ltx_break"><sup id="id15.15.id7" class="ltx_sup">1</sup> Key Laboratory of New Generation Artificial Intelligence Technology &amp; 
<br class="ltx_break">Its Interdisciplinary Applications, (Southeast University), Ministry of Education
<br class="ltx_break"><span id="id16.16.id8" class="ltx_text ltx_font_typewriter">{yingzhe.peng, 213201447, xuyang_palm, pengjiawei, xgeng}@seu.edu.cn</span> 
<br class="ltx_break"><sup id="id17.17.id9" class="ltx_sup">2</sup> Nanyang Technological University
<br class="ltx_break"><span id="id18.18.id10" class="ltx_text ltx_font_typewriter">xinting001@e.ntu.edu.sg</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id19.id1" class="ltx_p">As language models continue to scale, Large Language Models (LLMs) have exhibited emerging capabilities in In-Context Learning (ICL), enabling them to solve language tasks by prefixing a few in-context demonstrations (ICDs) as context. Inspired by these advancements, researchers have extended these techniques to develop Large Multimodal Models (LMMs) with ICL capabilities. However, applying ICL usually faces two major challenges: 1) using more ICDs will largely increase the inference time and 2) the performance is sensitive to the selection of ICDs. These challenges are further exacerbated in LMMs due to the integration of multiple data types and the combinational complexity of multimodal ICDs. Recently, to address these challenges, some NLP studies introduce non-learnable In-Context Vectors (ICVs) which extract useful task information from ICDs into a single vector and then insert it into the LLM to help solve the corresponding task. However, although useful in simple NLP tasks, these non-learnable methods fail to handle complex multimodal tasks like Visual Question Answering (VQA). In this study, we propose <span id="id19.id1.1" class="ltx_text ltx_font_bold">Learnable ICV</span> (L-ICV) to distill essential task information from demonstrations, improving ICL performance in LMMs. Experiments show that L-ICV can significantly reduce computational costs while enhancing accuracy in VQA tasks compared to traditional ICL and other non-learnable ICV methods.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">As language models continue to scale up, Large Language Models (LLMs) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> have demonstrated emerging capabilities in In-Context Learning (ICL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>: these models can solve language tasks when provided with a few similar examples, termed in-context demonstrations (ICDs), as context.
Unlike traditional task-specific fine-tuning, ICL achieves comparable performance without necessitating updates to millions or trillions of model parameters <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>.
By prefixing just a handful of data samples to the query input, ICL configures a model’s behavior to produce the corresponding output, thus facilitating rapid adaptation across a wide range of downstream tasks. Inspired by these advancements in the language domain, researchers have extended these techniques to develop Large Multimodal Models (LMMs) with ICL capabilities <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Employing ICL in LLMs meets two challenges:
Firstly, although increasing the number of ICDs typically enhances performance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, this practice conflicts with computational efficiency constraints.
As ICDs are prefixed to the query, the increase in input tokens severely impacts the Transformer’s inference speed, causing a marked slowdown in computational performance.
Secondly, the effectiveness of ICL is vulnerable to the selection of demonstrations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, particularly when only a limited number are used. It makes the process of choosing demonstrations critical for optimal performance. However, developing selection strategies and measuring the effectiveness of ICDs remain open questions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. For LMMs, the challenges above are further exacerbated: 1) The computational complexity is significantly increased due to the integration of multiple data types as ICDs (as shown in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(a)). 2) The task of selecting effective multi-modal ICDs becomes more complex and nuanced, as each modality contributes uniquely to understanding the context <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, further complicating the assessment of their combined effect in demonstration selection.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">To alleviate these two challenges, recent research on LLMs has introduced In-Context Vector (ICV) to extract the most useful task information from ICDs, and then use it to directly influence the processing in LLMs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>. For example, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> proposes that by using multiple demonstrations and a dummy query as inputs, the representation of the last token from a middle layer of the model can be extracted as the vector. This vector is then used to replace the representation of the corresponding token in the same layer during inference, which can achieve performance comparable to ICL. Such in-context vector alleviates the requirement of multiple ICDs during inference, as well as effectively bypasses the complexity of the individual selection of demonstrations by representing the most effective components across many demonstrations.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2406.13185/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="132" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>(a) Conventional ICL is more sensitive to the ICD selection and requires more inference time. (b) L-ICV is more robust and reduces inference time by inputting a shift vector.</figcaption>
</figure>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">However, these studies apply non-learnable strategies to extract ICVs, although useful in some simple NLP tasks, lose the efficacy in complex multi-modal tasks like Visual Question Answering (VQA). Our preliminary experiments have demonstrated that directly applying these non-learnable ICVs yields unsatisfactory results.
The principal reason is the intrinsic complexity of VQA compared to the language tasks addressed by these non-learnable ICVs. For example, the previous methods focus on simple NLP task, such as Antonym <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> and Country-Capital <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, whose distribution patterns can be easily identified by LLMs. In contrast, as a unified vision-language task, VQA encompasses a diverse array of question types, where each one corresponds to a different vision-understanding task. For instance, questions like “What is this?” or “How many are there?” require classification and counting abilities, respectively. These varied requirements imply that the task information, which non-learnable methods attempt to abstract, cannot be effectively captured by a single ICV.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">In this study, to make ICVs abstract more useful VQA task information, we try to distill the task information implied in demonstrations into a single <span id="S1.p5.1.1" class="ltx_text ltx_font_bold">Learnable ICV (L-ICV)</span>. Our method is motivated by the observation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> that ICL can be treated as a process of “shifting" the direction of the latent states of query towards the target, <em id="S1.p5.1.2" class="ltx_emph ltx_font_italic">i.e.</em>, adding this latent state with a shift vector. Then we hope to learn suitable ICVs to replace the ICDs during inference to shift the direction. To achieve this, we train this L-ICV by minimizing the output distributions of a LMM got by only using this L-ICV and by inputting a few demonstrations. During training, we use different 32-shot randomly sampled demonstrations for different queries to distill task knowledge. Then L-ICV is encouraged to capture the most essential task information from these different combinations by removing the individual characteristics of demonstrations. Moreover,  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> finds that during ICL, different layers of LLM have diverse roles in addressing demonstrations. Then in our method, each layer is assigned with a unique ICV to capture more fine-grained task information.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">Our L-ICV inherits the efficiency of previous non-learnable ICVs, <em id="S1.p6.1.1" class="ltx_emph ltx_font_italic">i.e.</em>, during inference, under the same performance conditions, L-ICV only needs 1/24.97 FLOPs number of 32-shot ICL. Additionally, in VQAV2/OKVQA, L-ICV improves accuracy by 2.36/1.6 compared to 32-shot ICL. We also compare L-ICV to LoRA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> that when comparable trainable parameters are used, L-ICV requires much fewer training samples than LoRA (500 vs. 8000) to achieve satisfactory performance. Besides, we design lots of analytical experiments to validate whether L-ICV can better shift the hidden states of queries to the target direction and analyze why previous non-learnable methods fail to solve VQA.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">In-Context Vector:</span>
Recently, more and more researchers in NLP have begun to focus on using an In-Context Vector (ICV) to modify the activation values during the forward propagation of LLM to simulate the effect of ICDs in ICL.  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> propose the “Task Vector”, which extracts the representation of the middle layer from the LLM during ICL inference as the ICV, and replaces the representation of the same layer during zero-shot inference. Meanwhile,  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> introduced the “Function Vector”, which uses attention weight analysis to take the mean of the activation values of the attention heads that most significantly affect the final result in ICL inference as the final ICV. This vector is then directly added to the representation of the middle layer during zero-shot inference to form a new representation. On the other hand,  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> propose “PCA In-Context Vector”. They believe that the ICV should be closer to the LLM’s representation of the task output and farther from the task input representation. Thus, they extract the input and output representations of several demonstrations and using PCA to find the overall principal direction as the ICV. These efforts mainly focus on using non-learnable methods to find the specific ICV for NLP tasks, achieving effects similar to ICL in various tasks. However, these methods only are tested on some simple tasks in NLP. When LMMs face with more complex tasks, the performance of these methods remains uncertain.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">ICL in LLM:</span>
Prompt engineering allows LLMs to tackle specific tasks without requiring fine-tuning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>. A specific form of this approach, ICL, further improves these capabilities by creating prompts that include several demonstrations. ICL has already demonstrated superior performance and good generalization on many tasks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>, and can be easily adapted to downstream tasks. However, the use of ICL faces several issues: first, ICL is very sensitive to the selection and arrangement order of demonstrations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>; poor demonstrations can severely impact ICL performance. Second, too many demonstrations can significantly slow down the inference speed of LLMs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>. While ICVs can effectively address these two issues, as it can use only queries as input to the model while preserving ICL performance, without the need for demonstrations as input.</p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">ICL in LMM:</span>
As the performance of LLMs continues to improve, an increasing number of researchers begin to adapt LLMs to the multimodal domain <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>, <a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>. Relying on the powerful inference capabilities of LLMs, some LMMs have started to exhibit ICL capabilities, such as Flamingo <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> and IDEFICS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. Moreover, these models have significantly enhanced their ICL capabilities by concatenating multiple samples as contextual information during the training process. Currently, researchers mainly focus on how to configure demonstrations to address the sensitivity of ICL performance in LMMs. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> have respectively adopted heuristic retrieval methods for selecting demonstrations in Image Captioning and VQA. However, no researchers have yet extracted ICV from LMMs and evalutaed it. Therefore, the effectiveness of ICV in LMMs still needs further exploration.
Considering that the IDEFICS model shares the same model structure as Flamingo and possesses stronger ICL capabilities, we primarily focus on valid our method on the IDEFICS model.</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="/html/2406.13185/assets/x2.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="128" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The L-ICV training pipeline: (a) The distribution <math id="S2.F2.1.m1.4" class="ltx_Math" alttext="\mathcal{P}(\bm{\hat{x}}|\bm{V},\bm{\alpha};\mathcal{M})" display="inline"><semantics id="S2.F2.1.m1.4b"><mrow id="S2.F2.1.m1.4.4" xref="S2.F2.1.m1.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.F2.1.m1.4.4.3" xref="S2.F2.1.m1.4.4.3.cmml">𝒫</mi><mo lspace="0em" rspace="0em" id="S2.F2.1.m1.4.4.2" xref="S2.F2.1.m1.4.4.2.cmml">​</mo><mrow id="S2.F2.1.m1.4.4.1.1" xref="S2.F2.1.m1.4.4.1.1.1.cmml"><mo stretchy="false" id="S2.F2.1.m1.4.4.1.1.2" xref="S2.F2.1.m1.4.4.1.1.1.cmml">(</mo><mrow id="S2.F2.1.m1.4.4.1.1.1" xref="S2.F2.1.m1.4.4.1.1.1.cmml"><mover accent="true" id="S2.F2.1.m1.4.4.1.1.1.2" xref="S2.F2.1.m1.4.4.1.1.1.2.cmml"><mi id="S2.F2.1.m1.4.4.1.1.1.2.2" xref="S2.F2.1.m1.4.4.1.1.1.2.2.cmml">𝒙</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S2.F2.1.m1.4.4.1.1.1.2.1" xref="S2.F2.1.m1.4.4.1.1.1.2.1.cmml">^</mo></mover><mo fence="false" id="S2.F2.1.m1.4.4.1.1.1.1" xref="S2.F2.1.m1.4.4.1.1.1.1.cmml">|</mo><mrow id="S2.F2.1.m1.4.4.1.1.1.3.2" xref="S2.F2.1.m1.4.4.1.1.1.3.1.cmml"><mi id="S2.F2.1.m1.1.1" xref="S2.F2.1.m1.1.1.cmml">𝑽</mi><mo id="S2.F2.1.m1.4.4.1.1.1.3.2.1" xref="S2.F2.1.m1.4.4.1.1.1.3.1.cmml">,</mo><mi id="S2.F2.1.m1.2.2" xref="S2.F2.1.m1.2.2.cmml">𝜶</mi><mo id="S2.F2.1.m1.4.4.1.1.1.3.2.2" xref="S2.F2.1.m1.4.4.1.1.1.3.1.cmml">;</mo><mi class="ltx_font_mathcaligraphic" id="S2.F2.1.m1.3.3" xref="S2.F2.1.m1.3.3.cmml">ℳ</mi></mrow></mrow><mo stretchy="false" id="S2.F2.1.m1.4.4.1.1.3" xref="S2.F2.1.m1.4.4.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.F2.1.m1.4c"><apply id="S2.F2.1.m1.4.4.cmml" xref="S2.F2.1.m1.4.4"><times id="S2.F2.1.m1.4.4.2.cmml" xref="S2.F2.1.m1.4.4.2"></times><ci id="S2.F2.1.m1.4.4.3.cmml" xref="S2.F2.1.m1.4.4.3">𝒫</ci><apply id="S2.F2.1.m1.4.4.1.1.1.cmml" xref="S2.F2.1.m1.4.4.1.1"><csymbol cd="latexml" id="S2.F2.1.m1.4.4.1.1.1.1.cmml" xref="S2.F2.1.m1.4.4.1.1.1.1">conditional</csymbol><apply id="S2.F2.1.m1.4.4.1.1.1.2.cmml" xref="S2.F2.1.m1.4.4.1.1.1.2"><ci id="S2.F2.1.m1.4.4.1.1.1.2.1.cmml" xref="S2.F2.1.m1.4.4.1.1.1.2.1">bold-^</ci><ci id="S2.F2.1.m1.4.4.1.1.1.2.2.cmml" xref="S2.F2.1.m1.4.4.1.1.1.2.2">𝒙</ci></apply><list id="S2.F2.1.m1.4.4.1.1.1.3.1.cmml" xref="S2.F2.1.m1.4.4.1.1.1.3.2"><ci id="S2.F2.1.m1.1.1.cmml" xref="S2.F2.1.m1.1.1">𝑽</ci><ci id="S2.F2.1.m1.2.2.cmml" xref="S2.F2.1.m1.2.2">𝜶</ci><ci id="S2.F2.1.m1.3.3.cmml" xref="S2.F2.1.m1.3.3">ℳ</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.1.m1.4d">\mathcal{P}(\bm{\hat{x}}|\bm{V},\bm{\alpha};\mathcal{M})</annotation></semantics></math> of LMMs output when using L-ICV. (b) Adding L-ICV into the representations of the query to simulate the shift effect brought by demonstrations. (c) The distribution <math id="S2.F2.2.m2.2" class="ltx_Math" alttext="\mathcal{P}(\bm{\hat{x}}|\bm{X}_{D};\mathcal{M})" display="inline"><semantics id="S2.F2.2.m2.2b"><mrow id="S2.F2.2.m2.2.2" xref="S2.F2.2.m2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.F2.2.m2.2.2.3" xref="S2.F2.2.m2.2.2.3.cmml">𝒫</mi><mo lspace="0em" rspace="0em" id="S2.F2.2.m2.2.2.2" xref="S2.F2.2.m2.2.2.2.cmml">​</mo><mrow id="S2.F2.2.m2.2.2.1.1" xref="S2.F2.2.m2.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.F2.2.m2.2.2.1.1.2" xref="S2.F2.2.m2.2.2.1.1.1.cmml">(</mo><mrow id="S2.F2.2.m2.2.2.1.1.1" xref="S2.F2.2.m2.2.2.1.1.1.cmml"><mover accent="true" id="S2.F2.2.m2.2.2.1.1.1.3" xref="S2.F2.2.m2.2.2.1.1.1.3.cmml"><mi id="S2.F2.2.m2.2.2.1.1.1.3.2" xref="S2.F2.2.m2.2.2.1.1.1.3.2.cmml">𝒙</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S2.F2.2.m2.2.2.1.1.1.3.1" xref="S2.F2.2.m2.2.2.1.1.1.3.1.cmml">^</mo></mover><mo fence="false" id="S2.F2.2.m2.2.2.1.1.1.2" xref="S2.F2.2.m2.2.2.1.1.1.2.cmml">|</mo><mrow id="S2.F2.2.m2.2.2.1.1.1.1.1" xref="S2.F2.2.m2.2.2.1.1.1.1.2.cmml"><msub id="S2.F2.2.m2.2.2.1.1.1.1.1.1" xref="S2.F2.2.m2.2.2.1.1.1.1.1.1.cmml"><mi id="S2.F2.2.m2.2.2.1.1.1.1.1.1.2" xref="S2.F2.2.m2.2.2.1.1.1.1.1.1.2.cmml">𝑿</mi><mi id="S2.F2.2.m2.2.2.1.1.1.1.1.1.3" xref="S2.F2.2.m2.2.2.1.1.1.1.1.1.3.cmml">D</mi></msub><mo id="S2.F2.2.m2.2.2.1.1.1.1.1.2" xref="S2.F2.2.m2.2.2.1.1.1.1.2.cmml">;</mo><mi class="ltx_font_mathcaligraphic" id="S2.F2.2.m2.1.1" xref="S2.F2.2.m2.1.1.cmml">ℳ</mi></mrow></mrow><mo stretchy="false" id="S2.F2.2.m2.2.2.1.1.3" xref="S2.F2.2.m2.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.F2.2.m2.2c"><apply id="S2.F2.2.m2.2.2.cmml" xref="S2.F2.2.m2.2.2"><times id="S2.F2.2.m2.2.2.2.cmml" xref="S2.F2.2.m2.2.2.2"></times><ci id="S2.F2.2.m2.2.2.3.cmml" xref="S2.F2.2.m2.2.2.3">𝒫</ci><apply id="S2.F2.2.m2.2.2.1.1.1.cmml" xref="S2.F2.2.m2.2.2.1.1"><csymbol cd="latexml" id="S2.F2.2.m2.2.2.1.1.1.2.cmml" xref="S2.F2.2.m2.2.2.1.1.1.2">conditional</csymbol><apply id="S2.F2.2.m2.2.2.1.1.1.3.cmml" xref="S2.F2.2.m2.2.2.1.1.1.3"><ci id="S2.F2.2.m2.2.2.1.1.1.3.1.cmml" xref="S2.F2.2.m2.2.2.1.1.1.3.1">bold-^</ci><ci id="S2.F2.2.m2.2.2.1.1.1.3.2.cmml" xref="S2.F2.2.m2.2.2.1.1.1.3.2">𝒙</ci></apply><list id="S2.F2.2.m2.2.2.1.1.1.1.2.cmml" xref="S2.F2.2.m2.2.2.1.1.1.1.1"><apply id="S2.F2.2.m2.2.2.1.1.1.1.1.1.cmml" xref="S2.F2.2.m2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.F2.2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.F2.2.m2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.F2.2.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S2.F2.2.m2.2.2.1.1.1.1.1.1.2">𝑿</ci><ci id="S2.F2.2.m2.2.2.1.1.1.1.1.1.3.cmml" xref="S2.F2.2.m2.2.2.1.1.1.1.1.1.3">𝐷</ci></apply><ci id="S2.F2.2.m2.1.1.cmml" xref="S2.F2.2.m2.1.1">ℳ</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.2.m2.2d">\mathcal{P}(\bm{\hat{x}}|\bm{X}_{D};\mathcal{M})</annotation></semantics></math> of LMMs output when using demonstrations.</figcaption>
</figure>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Learnable In-Context Vector</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.8" class="ltx_p">Here we show how to derive the formulation of the shift vector from Self-Attention (SA) mechanism and then introduce how to design L-ICV based on this formulation. Generally, to implement In-Context Learning (ICL) using a language or multimodal model (LLM/LMM) <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="S3.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\mathcal{M}</annotation></semantics></math>, the input has the following form: <math id="S3.p1.2.m2.2" class="ltx_Math" alttext="\bm{X}=\{\bm{X}_{D},\hat{\bm{x}}\}" display="inline"><semantics id="S3.p1.2.m2.2a"><mrow id="S3.p1.2.m2.2.2" xref="S3.p1.2.m2.2.2.cmml"><mi id="S3.p1.2.m2.2.2.3" xref="S3.p1.2.m2.2.2.3.cmml">𝑿</mi><mo id="S3.p1.2.m2.2.2.2" xref="S3.p1.2.m2.2.2.2.cmml">=</mo><mrow id="S3.p1.2.m2.2.2.1.1" xref="S3.p1.2.m2.2.2.1.2.cmml"><mo stretchy="false" id="S3.p1.2.m2.2.2.1.1.2" xref="S3.p1.2.m2.2.2.1.2.cmml">{</mo><msub id="S3.p1.2.m2.2.2.1.1.1" xref="S3.p1.2.m2.2.2.1.1.1.cmml"><mi id="S3.p1.2.m2.2.2.1.1.1.2" xref="S3.p1.2.m2.2.2.1.1.1.2.cmml">𝑿</mi><mi id="S3.p1.2.m2.2.2.1.1.1.3" xref="S3.p1.2.m2.2.2.1.1.1.3.cmml">D</mi></msub><mo id="S3.p1.2.m2.2.2.1.1.3" xref="S3.p1.2.m2.2.2.1.2.cmml">,</mo><mover accent="true" id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml"><mi id="S3.p1.2.m2.1.1.2" xref="S3.p1.2.m2.1.1.2.cmml">𝒙</mi><mo id="S3.p1.2.m2.1.1.1" xref="S3.p1.2.m2.1.1.1.cmml">^</mo></mover><mo stretchy="false" id="S3.p1.2.m2.2.2.1.1.4" xref="S3.p1.2.m2.2.2.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.2b"><apply id="S3.p1.2.m2.2.2.cmml" xref="S3.p1.2.m2.2.2"><eq id="S3.p1.2.m2.2.2.2.cmml" xref="S3.p1.2.m2.2.2.2"></eq><ci id="S3.p1.2.m2.2.2.3.cmml" xref="S3.p1.2.m2.2.2.3">𝑿</ci><set id="S3.p1.2.m2.2.2.1.2.cmml" xref="S3.p1.2.m2.2.2.1.1"><apply id="S3.p1.2.m2.2.2.1.1.1.cmml" xref="S3.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.p1.2.m2.2.2.1.1.1.2">𝑿</ci><ci id="S3.p1.2.m2.2.2.1.1.1.3.cmml" xref="S3.p1.2.m2.2.2.1.1.1.3">𝐷</ci></apply><apply id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1"><ci id="S3.p1.2.m2.1.1.1.cmml" xref="S3.p1.2.m2.1.1.1">^</ci><ci id="S3.p1.2.m2.1.1.2.cmml" xref="S3.p1.2.m2.1.1.2">𝒙</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.2c">\bm{X}=\{\bm{X}_{D},\hat{\bm{x}}\}</annotation></semantics></math>, where <math id="S3.p1.3.m3.3" class="ltx_Math" alttext="\bm{X}_{D}=\{\bm{x}_{1},...,\bm{x}_{k}\}" display="inline"><semantics id="S3.p1.3.m3.3a"><mrow id="S3.p1.3.m3.3.3" xref="S3.p1.3.m3.3.3.cmml"><msub id="S3.p1.3.m3.3.3.4" xref="S3.p1.3.m3.3.3.4.cmml"><mi id="S3.p1.3.m3.3.3.4.2" xref="S3.p1.3.m3.3.3.4.2.cmml">𝑿</mi><mi id="S3.p1.3.m3.3.3.4.3" xref="S3.p1.3.m3.3.3.4.3.cmml">D</mi></msub><mo id="S3.p1.3.m3.3.3.3" xref="S3.p1.3.m3.3.3.3.cmml">=</mo><mrow id="S3.p1.3.m3.3.3.2.2" xref="S3.p1.3.m3.3.3.2.3.cmml"><mo stretchy="false" id="S3.p1.3.m3.3.3.2.2.3" xref="S3.p1.3.m3.3.3.2.3.cmml">{</mo><msub id="S3.p1.3.m3.2.2.1.1.1" xref="S3.p1.3.m3.2.2.1.1.1.cmml"><mi id="S3.p1.3.m3.2.2.1.1.1.2" xref="S3.p1.3.m3.2.2.1.1.1.2.cmml">𝒙</mi><mn id="S3.p1.3.m3.2.2.1.1.1.3" xref="S3.p1.3.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.p1.3.m3.3.3.2.2.4" xref="S3.p1.3.m3.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">…</mi><mo id="S3.p1.3.m3.3.3.2.2.5" xref="S3.p1.3.m3.3.3.2.3.cmml">,</mo><msub id="S3.p1.3.m3.3.3.2.2.2" xref="S3.p1.3.m3.3.3.2.2.2.cmml"><mi id="S3.p1.3.m3.3.3.2.2.2.2" xref="S3.p1.3.m3.3.3.2.2.2.2.cmml">𝒙</mi><mi id="S3.p1.3.m3.3.3.2.2.2.3" xref="S3.p1.3.m3.3.3.2.2.2.3.cmml">k</mi></msub><mo stretchy="false" id="S3.p1.3.m3.3.3.2.2.6" xref="S3.p1.3.m3.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.3b"><apply id="S3.p1.3.m3.3.3.cmml" xref="S3.p1.3.m3.3.3"><eq id="S3.p1.3.m3.3.3.3.cmml" xref="S3.p1.3.m3.3.3.3"></eq><apply id="S3.p1.3.m3.3.3.4.cmml" xref="S3.p1.3.m3.3.3.4"><csymbol cd="ambiguous" id="S3.p1.3.m3.3.3.4.1.cmml" xref="S3.p1.3.m3.3.3.4">subscript</csymbol><ci id="S3.p1.3.m3.3.3.4.2.cmml" xref="S3.p1.3.m3.3.3.4.2">𝑿</ci><ci id="S3.p1.3.m3.3.3.4.3.cmml" xref="S3.p1.3.m3.3.3.4.3">𝐷</ci></apply><set id="S3.p1.3.m3.3.3.2.3.cmml" xref="S3.p1.3.m3.3.3.2.2"><apply id="S3.p1.3.m3.2.2.1.1.1.cmml" xref="S3.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p1.3.m3.2.2.1.1.1.1.cmml" xref="S3.p1.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.p1.3.m3.2.2.1.1.1.2.cmml" xref="S3.p1.3.m3.2.2.1.1.1.2">𝒙</ci><cn type="integer" id="S3.p1.3.m3.2.2.1.1.1.3.cmml" xref="S3.p1.3.m3.2.2.1.1.1.3">1</cn></apply><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">…</ci><apply id="S3.p1.3.m3.3.3.2.2.2.cmml" xref="S3.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p1.3.m3.3.3.2.2.2.1.cmml" xref="S3.p1.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S3.p1.3.m3.3.3.2.2.2.2.cmml" xref="S3.p1.3.m3.3.3.2.2.2.2">𝒙</ci><ci id="S3.p1.3.m3.3.3.2.2.2.3.cmml" xref="S3.p1.3.m3.3.3.2.2.2.3">𝑘</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.3c">\bm{X}_{D}=\{\bm{x}_{1},...,\bm{x}_{k}\}</annotation></semantics></math> represents the concatenation of <math id="S3.p1.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.p1.4.m4.1a"><mi id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><ci id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">k</annotation></semantics></math> In-Context Demonstrations (ICDs), and <math id="S3.p1.5.m5.1" class="ltx_Math" alttext="\hat{\bm{x}}" display="inline"><semantics id="S3.p1.5.m5.1a"><mover accent="true" id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml"><mi id="S3.p1.5.m5.1.1.2" xref="S3.p1.5.m5.1.1.2.cmml">𝒙</mi><mo id="S3.p1.5.m5.1.1.1" xref="S3.p1.5.m5.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><apply id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1"><ci id="S3.p1.5.m5.1.1.1.cmml" xref="S3.p1.5.m5.1.1.1">^</ci><ci id="S3.p1.5.m5.1.1.2.cmml" xref="S3.p1.5.m5.1.1.2">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">\hat{\bm{x}}</annotation></semantics></math> denotes the query input, as shown in Figure <a href="#S2.F2" title="Figure 2 ‣ 2 Related Work ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Given <math id="S3.p1.6.m6.1" class="ltx_Math" alttext="\bm{X}" display="inline"><semantics id="S3.p1.6.m6.1a"><mi id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">𝑿</mi><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><ci id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">𝑿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">\bm{X}</annotation></semantics></math> as <span id="S3.p1.8.1" class="ltx_text ltx_font_italic">Key</span> and <span id="S3.p1.8.2" class="ltx_text ltx_font_italic">Value</span>, for each token <math id="S3.p1.7.m7.1" class="ltx_Math" alttext="\hat{x}_{i}" display="inline"><semantics id="S3.p1.7.m7.1a"><msub id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml"><mover accent="true" id="S3.p1.7.m7.1.1.2" xref="S3.p1.7.m7.1.1.2.cmml"><mi id="S3.p1.7.m7.1.1.2.2" xref="S3.p1.7.m7.1.1.2.2.cmml">x</mi><mo id="S3.p1.7.m7.1.1.2.1" xref="S3.p1.7.m7.1.1.2.1.cmml">^</mo></mover><mi id="S3.p1.7.m7.1.1.3" xref="S3.p1.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><apply id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p1.7.m7.1.1.1.cmml" xref="S3.p1.7.m7.1.1">subscript</csymbol><apply id="S3.p1.7.m7.1.1.2.cmml" xref="S3.p1.7.m7.1.1.2"><ci id="S3.p1.7.m7.1.1.2.1.cmml" xref="S3.p1.7.m7.1.1.2.1">^</ci><ci id="S3.p1.7.m7.1.1.2.2.cmml" xref="S3.p1.7.m7.1.1.2.2">𝑥</ci></apply><ci id="S3.p1.7.m7.1.1.3.cmml" xref="S3.p1.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">\hat{x}_{i}</annotation></semantics></math> of <math id="S3.p1.8.m8.1" class="ltx_Math" alttext="\hat{\bm{x}}" display="inline"><semantics id="S3.p1.8.m8.1a"><mover accent="true" id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml"><mi id="S3.p1.8.m8.1.1.2" xref="S3.p1.8.m8.1.1.2.cmml">𝒙</mi><mo id="S3.p1.8.m8.1.1.1" xref="S3.p1.8.m8.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.1b"><apply id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1"><ci id="S3.p1.8.m8.1.1.1.cmml" xref="S3.p1.8.m8.1.1.1">^</ci><ci id="S3.p1.8.m8.1.1.2.cmml" xref="S3.p1.8.m8.1.1.2">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.1c">\hat{\bm{x}}</annotation></semantics></math>, applying <span id="S3.p1.8.3" class="ltx_text ltx_font_italic">Self-Attention (SA)</span> once yields:</p>
<table id="S3.E1" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E1X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E1X.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle\operatorname{SA}(\hat{x}_{i},\bm{X},\bm{X})" display="inline"><semantics id="S3.E1X.2.1.1.m1.4a"><mrow id="S3.E1X.2.1.1.m1.4.4.1" xref="S3.E1X.2.1.1.m1.4.4.2.cmml"><mi id="S3.E1X.2.1.1.m1.1.1" xref="S3.E1X.2.1.1.m1.1.1.cmml">SA</mi><mo id="S3.E1X.2.1.1.m1.4.4.1a" xref="S3.E1X.2.1.1.m1.4.4.2.cmml">⁡</mo><mrow id="S3.E1X.2.1.1.m1.4.4.1.1" xref="S3.E1X.2.1.1.m1.4.4.2.cmml"><mo stretchy="false" id="S3.E1X.2.1.1.m1.4.4.1.1.2" xref="S3.E1X.2.1.1.m1.4.4.2.cmml">(</mo><msub id="S3.E1X.2.1.1.m1.4.4.1.1.1" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.cmml"><mover accent="true" id="S3.E1X.2.1.1.m1.4.4.1.1.1.2" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.2.cmml"><mi id="S3.E1X.2.1.1.m1.4.4.1.1.1.2.2" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.2.2.cmml">x</mi><mo id="S3.E1X.2.1.1.m1.4.4.1.1.1.2.1" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E1X.2.1.1.m1.4.4.1.1.1.3" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.3.cmml">i</mi></msub><mo id="S3.E1X.2.1.1.m1.4.4.1.1.3" xref="S3.E1X.2.1.1.m1.4.4.2.cmml">,</mo><mi id="S3.E1X.2.1.1.m1.2.2" xref="S3.E1X.2.1.1.m1.2.2.cmml">𝑿</mi><mo id="S3.E1X.2.1.1.m1.4.4.1.1.4" xref="S3.E1X.2.1.1.m1.4.4.2.cmml">,</mo><mi id="S3.E1X.2.1.1.m1.3.3" xref="S3.E1X.2.1.1.m1.3.3.cmml">𝑿</mi><mo stretchy="false" id="S3.E1X.2.1.1.m1.4.4.1.1.5" xref="S3.E1X.2.1.1.m1.4.4.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1X.2.1.1.m1.4b"><apply id="S3.E1X.2.1.1.m1.4.4.2.cmml" xref="S3.E1X.2.1.1.m1.4.4.1"><ci id="S3.E1X.2.1.1.m1.1.1.cmml" xref="S3.E1X.2.1.1.m1.1.1">SA</ci><apply id="S3.E1X.2.1.1.m1.4.4.1.1.1.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.1">subscript</csymbol><apply id="S3.E1X.2.1.1.m1.4.4.1.1.1.2.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.2"><ci id="S3.E1X.2.1.1.m1.4.4.1.1.1.2.1.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.2.1">^</ci><ci id="S3.E1X.2.1.1.m1.4.4.1.1.1.2.2.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.2.2">𝑥</ci></apply><ci id="S3.E1X.2.1.1.m1.4.4.1.1.1.3.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.3">𝑖</ci></apply><ci id="S3.E1X.2.1.1.m1.2.2.cmml" xref="S3.E1X.2.1.1.m1.2.2">𝑿</ci><ci id="S3.E1X.2.1.1.m1.3.3.cmml" xref="S3.E1X.2.1.1.m1.3.3">𝑿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1X.2.1.1.m1.4c">\displaystyle\operatorname{SA}(\hat{x}_{i},\bm{X},\bm{X})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E1X.3.2.2.m1.3" class="ltx_Math" alttext="\displaystyle=\operatorname{SA}(\hat{x}_{i},\begin{bmatrix}\bm{X}_{D}\\
\hat{\bm{x}}\end{bmatrix},\begin{bmatrix}\bm{X}_{D}\\
\hat{\bm{x}}\end{bmatrix})=\operatorname{softmax}(\begin{bmatrix}\hat{x}_{i}\bm{X}_{D}^{\top}&amp;\hat{x}_{i}\hat{\bm{x}}^{\top}\end{bmatrix})\begin{bmatrix}\bm{X}_{D}\\
\hat{\bm{x}}\end{bmatrix}," display="inline"><semantics id="S3.E1X.3.2.2.m1.3a"><mrow id="S3.E1X.3.2.2.m1.3.3.1" xref="S3.E1X.3.2.2.m1.3.3.1.1.cmml"><mrow id="S3.E1X.3.2.2.m1.3.3.1.1" xref="S3.E1X.3.2.2.m1.3.3.1.1.cmml"><mi id="S3.E1X.3.2.2.m1.3.3.1.1.3" xref="S3.E1X.3.2.2.m1.3.3.1.1.3.cmml"></mi><mo id="S3.E1X.3.2.2.m1.3.3.1.1.4" xref="S3.E1X.3.2.2.m1.3.3.1.1.4.cmml">=</mo><mrow id="S3.E1X.3.2.2.m1.3.3.1.1.1.1" xref="S3.E1X.3.2.2.m1.3.3.1.1.1.2.cmml"><mi id="S3.E1X.3.2.2.m1.1.1" xref="S3.E1X.3.2.2.m1.1.1.cmml">SA</mi><mo id="S3.E1X.3.2.2.m1.3.3.1.1.1.1a" xref="S3.E1X.3.2.2.m1.3.3.1.1.1.2.cmml">⁡</mo><mrow id="S3.E1X.3.2.2.m1.3.3.1.1.1.1.1" xref="S3.E1X.3.2.2.m1.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1X.3.2.2.m1.3.3.1.1.1.1.1.2" xref="S3.E1X.3.2.2.m1.3.3.1.1.1.2.cmml">(</mo><msub id="S3.E1X.3.2.2.m1.3.3.1.1.1.1.1.1" xref="S3.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.2" xref="S3.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="S3.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.2.2.cmml">x</mi><mo id="S3.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.2.1" xref="S3.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.3" xref="S3.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E1X.3.2.2.m1.3.3.1.1.1.1.1.3" xref="S3.E1X.3.2.2.m1.3.3.1.1.1.2.cmml">,</mo><mrow id="S3.E1.m1.1.1.1.1.1.1a.3" xref="S3.E1.m1.1.1.1.1.1.1a.2.cmml"><mo id="S3.E1.m1.1.1.1.1.1.1a.3.1" xref="S3.E1.m1.1.1.1.1.1.1a.2.1.cmml">[</mo><mtable rowspacing="0pt" id="S3.E1.m1.1.1.1.1.1.1.1.1.mf" xref="S3.E1.m1.1.1.1.1.1.1.1.1.mf.cmml"><mtr id="S3.E1.m1.1.1.1.1.1.1.1.1.mfa" xref="S3.E1.m1.1.1.1.1.1.1.1.1.mf.cmml"><mtd id="S3.E1.m1.1.1.1.1.1.1.1.1.mfb" xref="S3.E1.m1.1.1.1.1.1.1.1.1.mf.cmml"><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.mf.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.mf.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2.cmml">𝑿</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3.cmml">D</mi></msub></mtd></mtr><mtr id="S3.E1.m1.1.1.1.1.1.1.1.1.mfc" xref="S3.E1.m1.1.1.1.1.1.1.1.1.mf.cmml"><mtd id="S3.E1.m1.1.1.1.1.1.1.1.1.mfd" xref="S3.E1.m1.1.1.1.1.1.1.1.1.mf.cmml"><mover accent="true" id="S3.E1.m1.1.1.1.1.1.1.1.1.mf.2.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.mf.2.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.mf.2.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.mf.2.1.1.2.cmml">𝒙</mi><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.mf.2.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.mf.2.1.1.1.cmml">^</mo></mover></mtd></mtr></mtable><mo id="S3.E1.m1.1.1.1.1.1.1a.3.2" xref="S3.E1.m1.1.1.1.1.1.1a.2.1.cmml">]</mo></mrow><mo id="S3.E1X.3.2.2.m1.3.3.1.1.1.1.1.4" xref="S3.E1X.3.2.2.m1.3.3.1.1.1.2.cmml">,</mo><mrow id="S3.E1.m1.2.2.2.2.2.2a.3" xref="S3.E1.m1.2.2.2.2.2.2a.2.cmml"><mo id="S3.E1.m1.2.2.2.2.2.2a.3.1" xref="S3.E1.m1.2.2.2.2.2.2a.2.1.cmml">[</mo><mtable rowspacing="0pt" id="S3.E1.m1.2.2.2.2.2.2.1.1.mf" xref="S3.E1.m1.2.2.2.2.2.2.1.1.mf.cmml"><mtr id="S3.E1.m1.2.2.2.2.2.2.1.1.mfa" xref="S3.E1.m1.2.2.2.2.2.2.1.1.mf.cmml"><mtd id="S3.E1.m1.2.2.2.2.2.2.1.1.mfb" xref="S3.E1.m1.2.2.2.2.2.2.1.1.mf.cmml"><msub id="S3.E1.m1.2.2.2.2.2.2.1.1.mf.1.1.1" xref="S3.E1.m1.2.2.2.2.2.2.1.1.mf.1.1.1.cmml"><mi id="S3.E1.m1.2.2.2.2.2.2.1.1.mf.1.1.1.2" xref="S3.E1.m1.2.2.2.2.2.2.1.1.mf.1.1.1.2.cmml">𝑿</mi><mi id="S3.E1.m1.2.2.2.2.2.2.1.1.mf.1.1.1.3" xref="S3.E1.m1.2.2.2.2.2.2.1.1.mf.1.1.1.3.cmml">D</mi></msub></mtd></mtr><mtr id="S3.E1.m1.2.2.2.2.2.2.1.1.mfc" xref="S3.E1.m1.2.2.2.2.2.2.1.1.mf.cmml"><mtd id="S3.E1.m1.2.2.2.2.2.2.1.1.mfd" xref="S3.E1.m1.2.2.2.2.2.2.1.1.mf.cmml"><mover accent="true" id="S3.E1.m1.2.2.2.2.2.2.1.1.mf.2.1.1" xref="S3.E1.m1.2.2.2.2.2.2.1.1.mf.2.1.1.cmml"><mi id="S3.E1.m1.2.2.2.2.2.2.1.1.mf.2.1.1.2" xref="S3.E1.m1.2.2.2.2.2.2.1.1.mf.2.1.1.2.cmml">𝒙</mi><mo id="S3.E1.m1.2.2.2.2.2.2.1.1.mf.2.1.1.1" xref="S3.E1.m1.2.2.2.2.2.2.1.1.mf.2.1.1.1.cmml">^</mo></mover></mtd></mtr></mtable><mo id="S3.E1.m1.2.2.2.2.2.2a.3.2" xref="S3.E1.m1.2.2.2.2.2.2a.2.1.cmml">]</mo></mrow><mo stretchy="false" id="S3.E1X.3.2.2.m1.3.3.1.1.1.1.1.5" xref="S3.E1X.3.2.2.m1.3.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E1X.3.2.2.m1.3.3.1.1.5" xref="S3.E1X.3.2.2.m1.3.3.1.1.5.cmml">=</mo><mrow id="S3.E1X.3.2.2.m1.3.3.1.1.6" xref="S3.E1X.3.2.2.m1.3.3.1.1.6.cmml"><mrow id="S3.E1X.3.2.2.m1.3.3.1.1.6.2.2" xref="S3.E1X.3.2.2.m1.3.3.1.1.6.2.1.cmml"><mi id="S3.E1X.3.2.2.m1.2.2" xref="S3.E1X.3.2.2.m1.2.2.cmml">softmax</mi><mo id="S3.E1X.3.2.2.m1.3.3.1.1.6.2.2a" xref="S3.E1X.3.2.2.m1.3.3.1.1.6.2.1.cmml">⁡</mo><mrow id="S3.E1X.3.2.2.m1.3.3.1.1.6.2.2.1" xref="S3.E1X.3.2.2.m1.3.3.1.1.6.2.1.cmml"><mo stretchy="false" id="S3.E1X.3.2.2.m1.3.3.1.1.6.2.2.1.1" xref="S3.E1X.3.2.2.m1.3.3.1.1.6.2.1.cmml">(</mo><mrow id="S3.E1.m1.3.3.3.3.3.3a.3" xref="S3.E1.m1.3.3.3.3.3.3a.2.cmml"><mo id="S3.E1.m1.3.3.3.3.3.3a.3.1" xref="S3.E1.m1.3.3.3.3.3.3a.2.1.cmml">[</mo><mtable columnspacing="5pt" id="S3.E1.m1.3.3.3.3.3.3.1.1.mf" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.cmml"><mtr id="S3.E1.m1.3.3.3.3.3.3.1.1.mfa" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.cmml"><mtd id="S3.E1.m1.3.3.3.3.3.3.1.1.mfb" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.cmml"><mrow id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.cmml"><msub id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.2" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.2.cmml"><mover accent="true" id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.2.2" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.2.2.cmml"><mi id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.2.2.2" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.2.2.2.cmml">x</mi><mo id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.2.2.1" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.2.3" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.1" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.1.cmml">​</mo><msubsup id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.3" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.3.cmml"><mi id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.3.2.2" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.3.2.2.cmml">𝑿</mi><mi id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.3.2.3" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.3.2.3.cmml">D</mi><mo id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.3.3" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.3.3.cmml">⊤</mo></msubsup></mrow></mtd><mtd id="S3.E1.m1.3.3.3.3.3.3.1.1.mfc" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.cmml"><mrow id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.cmml"><msub id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.2" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.2.cmml"><mover accent="true" id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.2.2" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.2.2.cmml"><mi id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.2.2.2" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.2.2.2.cmml">x</mi><mo id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.2.2.1" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.2.2.1.cmml">^</mo></mover><mi id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.2.3" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.1" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.1.cmml">​</mo><msup id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.3" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.3.cmml"><mover accent="true" id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.3.2" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.3.2.cmml"><mi id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.3.2.2" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.3.2.2.cmml">𝒙</mi><mo id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.3.2.1" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.3.2.1.cmml">^</mo></mover><mo id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.3.3" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.3.3.cmml">⊤</mo></msup></mrow></mtd></mtr></mtable><mo id="S3.E1.m1.3.3.3.3.3.3a.3.2" xref="S3.E1.m1.3.3.3.3.3.3a.2.1.cmml">]</mo></mrow><mo stretchy="false" id="S3.E1X.3.2.2.m1.3.3.1.1.6.2.2.1.2" xref="S3.E1X.3.2.2.m1.3.3.1.1.6.2.1.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E1X.3.2.2.m1.3.3.1.1.6.1" xref="S3.E1X.3.2.2.m1.3.3.1.1.6.1.cmml">​</mo><mrow id="S3.E1.m1.4.4.4.4.4.4a.3" xref="S3.E1.m1.4.4.4.4.4.4a.2.cmml"><mo id="S3.E1.m1.4.4.4.4.4.4a.3.1" xref="S3.E1.m1.4.4.4.4.4.4a.2.1.cmml">[</mo><mtable rowspacing="0pt" id="S3.E1.m1.4.4.4.4.4.4.1.1.mf" xref="S3.E1.m1.4.4.4.4.4.4.1.1.mf.cmml"><mtr id="S3.E1.m1.4.4.4.4.4.4.1.1.mfa" xref="S3.E1.m1.4.4.4.4.4.4.1.1.mf.cmml"><mtd id="S3.E1.m1.4.4.4.4.4.4.1.1.mfb" xref="S3.E1.m1.4.4.4.4.4.4.1.1.mf.cmml"><msub id="S3.E1.m1.4.4.4.4.4.4.1.1.mf.1.1.1" xref="S3.E1.m1.4.4.4.4.4.4.1.1.mf.1.1.1.cmml"><mi id="S3.E1.m1.4.4.4.4.4.4.1.1.mf.1.1.1.2" xref="S3.E1.m1.4.4.4.4.4.4.1.1.mf.1.1.1.2.cmml">𝑿</mi><mi id="S3.E1.m1.4.4.4.4.4.4.1.1.mf.1.1.1.3" xref="S3.E1.m1.4.4.4.4.4.4.1.1.mf.1.1.1.3.cmml">D</mi></msub></mtd></mtr><mtr id="S3.E1.m1.4.4.4.4.4.4.1.1.mfc" xref="S3.E1.m1.4.4.4.4.4.4.1.1.mf.cmml"><mtd id="S3.E1.m1.4.4.4.4.4.4.1.1.mfd" xref="S3.E1.m1.4.4.4.4.4.4.1.1.mf.cmml"><mover accent="true" id="S3.E1.m1.4.4.4.4.4.4.1.1.mf.2.1.1" xref="S3.E1.m1.4.4.4.4.4.4.1.1.mf.2.1.1.cmml"><mi id="S3.E1.m1.4.4.4.4.4.4.1.1.mf.2.1.1.2" xref="S3.E1.m1.4.4.4.4.4.4.1.1.mf.2.1.1.2.cmml">𝒙</mi><mo id="S3.E1.m1.4.4.4.4.4.4.1.1.mf.2.1.1.1" xref="S3.E1.m1.4.4.4.4.4.4.1.1.mf.2.1.1.1.cmml">^</mo></mover></mtd></mtr></mtable><mo id="S3.E1.m1.4.4.4.4.4.4a.3.2" xref="S3.E1.m1.4.4.4.4.4.4a.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E1X.3.2.2.m1.3.3.1.2" xref="S3.E1X.3.2.2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1X.3.2.2.m1.3b"><apply id="S3.E1X.3.2.2.m1.3.3.1.1.cmml" xref="S3.E1X.3.2.2.m1.3.3.1"><and id="S3.E1X.3.2.2.m1.3.3.1.1a.cmml" xref="S3.E1X.3.2.2.m1.3.3.1"></and><apply id="S3.E1X.3.2.2.m1.3.3.1.1b.cmml" xref="S3.E1X.3.2.2.m1.3.3.1"><eq id="S3.E1X.3.2.2.m1.3.3.1.1.4.cmml" xref="S3.E1X.3.2.2.m1.3.3.1.1.4"></eq><csymbol cd="latexml" id="S3.E1X.3.2.2.m1.3.3.1.1.3.cmml" xref="S3.E1X.3.2.2.m1.3.3.1.1.3">absent</csymbol><apply id="S3.E1X.3.2.2.m1.3.3.1.1.1.2.cmml" xref="S3.E1X.3.2.2.m1.3.3.1.1.1.1"><ci id="S3.E1X.3.2.2.m1.1.1.cmml" xref="S3.E1X.3.2.2.m1.1.1">SA</ci><apply id="S3.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E1X.3.2.2.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E1X.3.2.2.m1.3.3.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.2"><ci id="S3.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.2.2">𝑥</ci></apply><ci id="S3.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1a.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1a.3"><csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.1.1a.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1a.3.1">matrix</csymbol><matrix id="S3.E1.m1.1.1.1.1.1.1.1.1.mf.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.mf"><matrixrow id="S3.E1.m1.1.1.1.1.1.1.1.1.mfa.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.mf"><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.mf.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.mf.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.mf.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.mf.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2">𝑿</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3">𝐷</ci></apply></matrixrow><matrixrow id="S3.E1.m1.1.1.1.1.1.1.1.1.mfb.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.mf"><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.mf.2.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.mf.2.1.1"><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.mf.2.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.mf.2.1.1.1">^</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.mf.2.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.mf.2.1.1.2">𝒙</ci></apply></matrixrow></matrix></apply><apply id="S3.E1.m1.2.2.2.2.2.2a.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2a.3"><csymbol cd="latexml" id="S3.E1.m1.2.2.2.2.2.2a.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2a.3.1">matrix</csymbol><matrix id="S3.E1.m1.2.2.2.2.2.2.1.1.mf.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.1.mf"><matrixrow id="S3.E1.m1.2.2.2.2.2.2.1.1.mfa.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.1.mf"><apply id="S3.E1.m1.2.2.2.2.2.2.1.1.mf.1.1.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.1.mf.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.2.2.1.1.mf.1.1.1.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.1.mf.1.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.2.2.1.1.mf.1.1.1.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.1.mf.1.1.1.2">𝑿</ci><ci id="S3.E1.m1.2.2.2.2.2.2.1.1.mf.1.1.1.3.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.1.mf.1.1.1.3">𝐷</ci></apply></matrixrow><matrixrow id="S3.E1.m1.2.2.2.2.2.2.1.1.mfb.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.1.mf"><apply id="S3.E1.m1.2.2.2.2.2.2.1.1.mf.2.1.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.1.mf.2.1.1"><ci id="S3.E1.m1.2.2.2.2.2.2.1.1.mf.2.1.1.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.1.mf.2.1.1.1">^</ci><ci id="S3.E1.m1.2.2.2.2.2.2.1.1.mf.2.1.1.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.1.mf.2.1.1.2">𝒙</ci></apply></matrixrow></matrix></apply></apply></apply><apply id="S3.E1X.3.2.2.m1.3.3.1.1c.cmml" xref="S3.E1X.3.2.2.m1.3.3.1"><eq id="S3.E1X.3.2.2.m1.3.3.1.1.5.cmml" xref="S3.E1X.3.2.2.m1.3.3.1.1.5"></eq><share href="#S3.E1X.3.2.2.m1.3.3.1.1.1.cmml" id="S3.E1X.3.2.2.m1.3.3.1.1d.cmml" xref="S3.E1X.3.2.2.m1.3.3.1"></share><apply id="S3.E1X.3.2.2.m1.3.3.1.1.6.cmml" xref="S3.E1X.3.2.2.m1.3.3.1.1.6"><times id="S3.E1X.3.2.2.m1.3.3.1.1.6.1.cmml" xref="S3.E1X.3.2.2.m1.3.3.1.1.6.1"></times><apply id="S3.E1X.3.2.2.m1.3.3.1.1.6.2.1.cmml" xref="S3.E1X.3.2.2.m1.3.3.1.1.6.2.2"><ci id="S3.E1X.3.2.2.m1.2.2.cmml" xref="S3.E1X.3.2.2.m1.2.2">softmax</ci><apply id="S3.E1.m1.3.3.3.3.3.3a.2.cmml" xref="S3.E1.m1.3.3.3.3.3.3a.3"><csymbol cd="latexml" id="S3.E1.m1.3.3.3.3.3.3a.2.1.cmml" xref="S3.E1.m1.3.3.3.3.3.3a.3.1">matrix</csymbol><matrix id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf"><matrixrow id="S3.E1.m1.3.3.3.3.3.3.1.1.mfa.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf"><apply id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1"><times id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.1.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.1"></times><apply id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.2.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.2">subscript</csymbol><apply id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.2.2"><ci id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.2.2.1.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.2.2.1">^</ci><ci id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.2.2.2">𝑥</ci></apply><ci id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.3.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.3">superscript</csymbol><apply id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.3.2.1.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.3.2.2.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.3.2.2">𝑿</ci><ci id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.3.2.3.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.3.2.3">𝐷</ci></apply><csymbol cd="latexml" id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.1.1.3.3">top</csymbol></apply></apply><apply id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1"><times id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.1.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.1"></times><apply id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.2.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.2.1.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.2">subscript</csymbol><apply id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.2.2.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.2.2"><ci id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.2.2.1.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.2.2.1">^</ci><ci id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.2.2.2.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.2.2.2">𝑥</ci></apply><ci id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.2.3.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.2.3">𝑖</ci></apply><apply id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.3.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.3.1.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.3">superscript</csymbol><apply id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.3.2.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.3.2"><ci id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.3.2.1.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.3.2.1">^</ci><ci id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.3.2.2.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.3.2.2">𝒙</ci></apply><csymbol cd="latexml" id="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.3.3.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.mf.1.2.1.3.3">top</csymbol></apply></apply></matrixrow></matrix></apply></apply><apply id="S3.E1.m1.4.4.4.4.4.4a.2.cmml" xref="S3.E1.m1.4.4.4.4.4.4a.3"><csymbol cd="latexml" id="S3.E1.m1.4.4.4.4.4.4a.2.1.cmml" xref="S3.E1.m1.4.4.4.4.4.4a.3.1">matrix</csymbol><matrix id="S3.E1.m1.4.4.4.4.4.4.1.1.mf.cmml" xref="S3.E1.m1.4.4.4.4.4.4.1.1.mf"><matrixrow id="S3.E1.m1.4.4.4.4.4.4.1.1.mfa.cmml" xref="S3.E1.m1.4.4.4.4.4.4.1.1.mf"><apply id="S3.E1.m1.4.4.4.4.4.4.1.1.mf.1.1.1.cmml" xref="S3.E1.m1.4.4.4.4.4.4.1.1.mf.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.4.4.4.4.1.1.mf.1.1.1.1.cmml" xref="S3.E1.m1.4.4.4.4.4.4.1.1.mf.1.1.1">subscript</csymbol><ci id="S3.E1.m1.4.4.4.4.4.4.1.1.mf.1.1.1.2.cmml" xref="S3.E1.m1.4.4.4.4.4.4.1.1.mf.1.1.1.2">𝑿</ci><ci id="S3.E1.m1.4.4.4.4.4.4.1.1.mf.1.1.1.3.cmml" xref="S3.E1.m1.4.4.4.4.4.4.1.1.mf.1.1.1.3">𝐷</ci></apply></matrixrow><matrixrow id="S3.E1.m1.4.4.4.4.4.4.1.1.mfb.cmml" xref="S3.E1.m1.4.4.4.4.4.4.1.1.mf"><apply id="S3.E1.m1.4.4.4.4.4.4.1.1.mf.2.1.1.cmml" xref="S3.E1.m1.4.4.4.4.4.4.1.1.mf.2.1.1"><ci id="S3.E1.m1.4.4.4.4.4.4.1.1.mf.2.1.1.1.cmml" xref="S3.E1.m1.4.4.4.4.4.4.1.1.mf.2.1.1.1">^</ci><ci id="S3.E1.m1.4.4.4.4.4.4.1.1.mf.2.1.1.2.cmml" xref="S3.E1.m1.4.4.4.4.4.4.1.1.mf.2.1.1.2">𝒙</ci></apply></matrixrow></matrix></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1X.3.2.2.m1.3c">\displaystyle=\operatorname{SA}(\hat{x}_{i},\begin{bmatrix}\bm{X}_{D}\\
\hat{\bm{x}}\end{bmatrix},\begin{bmatrix}\bm{X}_{D}\\
\hat{\bm{x}}\end{bmatrix})=\operatorname{softmax}(\begin{bmatrix}\hat{x}_{i}\bm{X}_{D}^{\top}&amp;\hat{x}_{i}\hat{\bm{x}}^{\top}\end{bmatrix})\begin{bmatrix}\bm{X}_{D}\\
\hat{\bm{x}}\end{bmatrix},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(1)</span></td>
</tr>
</tbody>
</table>
<p id="S3.p1.11" class="ltx_p">where vector <math id="S3.p1.9.m1.1" class="ltx_Math" alttext="\begin{bmatrix}\hat{x}_{i}\bm{X}_{D}^{\top}&amp;\hat{x}_{i}\hat{\bm{x}}^{\top}\end{bmatrix}\in\mathbb{R}^{1\times l}" display="inline"><semantics id="S3.p1.9.m1.1a"><mrow id="S3.p1.9.m1.1.2" xref="S3.p1.9.m1.1.2.cmml"><mrow id="S3.p1.9.m1.1.1.3" xref="S3.p1.9.m1.1.1.2.cmml"><mo id="S3.p1.9.m1.1.1.3.1" xref="S3.p1.9.m1.1.1.2.1.cmml">[</mo><mtable columnspacing="5pt" id="S3.p1.9.m1.1.1.1.1" xref="S3.p1.9.m1.1.1.1.1.cmml"><mtr id="S3.p1.9.m1.1.1.1.1a" xref="S3.p1.9.m1.1.1.1.1.cmml"><mtd id="S3.p1.9.m1.1.1.1.1b" xref="S3.p1.9.m1.1.1.1.1.cmml"><mrow id="S3.p1.9.m1.1.1.1.1.1.1.1" xref="S3.p1.9.m1.1.1.1.1.1.1.1.cmml"><msub id="S3.p1.9.m1.1.1.1.1.1.1.1.2" xref="S3.p1.9.m1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.p1.9.m1.1.1.1.1.1.1.1.2.2" xref="S3.p1.9.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.p1.9.m1.1.1.1.1.1.1.1.2.2.2" xref="S3.p1.9.m1.1.1.1.1.1.1.1.2.2.2.cmml">x</mi><mo id="S3.p1.9.m1.1.1.1.1.1.1.1.2.2.1" xref="S3.p1.9.m1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.p1.9.m1.1.1.1.1.1.1.1.2.3" xref="S3.p1.9.m1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.p1.9.m1.1.1.1.1.1.1.1.1" xref="S3.p1.9.m1.1.1.1.1.1.1.1.1.cmml">​</mo><msubsup id="S3.p1.9.m1.1.1.1.1.1.1.1.3" xref="S3.p1.9.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.p1.9.m1.1.1.1.1.1.1.1.3.2.2" xref="S3.p1.9.m1.1.1.1.1.1.1.1.3.2.2.cmml">𝑿</mi><mi id="S3.p1.9.m1.1.1.1.1.1.1.1.3.2.3" xref="S3.p1.9.m1.1.1.1.1.1.1.1.3.2.3.cmml">D</mi><mo id="S3.p1.9.m1.1.1.1.1.1.1.1.3.3" xref="S3.p1.9.m1.1.1.1.1.1.1.1.3.3.cmml">⊤</mo></msubsup></mrow></mtd><mtd id="S3.p1.9.m1.1.1.1.1c" xref="S3.p1.9.m1.1.1.1.1.cmml"><mrow id="S3.p1.9.m1.1.1.1.1.1.2.1" xref="S3.p1.9.m1.1.1.1.1.1.2.1.cmml"><msub id="S3.p1.9.m1.1.1.1.1.1.2.1.2" xref="S3.p1.9.m1.1.1.1.1.1.2.1.2.cmml"><mover accent="true" id="S3.p1.9.m1.1.1.1.1.1.2.1.2.2" xref="S3.p1.9.m1.1.1.1.1.1.2.1.2.2.cmml"><mi id="S3.p1.9.m1.1.1.1.1.1.2.1.2.2.2" xref="S3.p1.9.m1.1.1.1.1.1.2.1.2.2.2.cmml">x</mi><mo id="S3.p1.9.m1.1.1.1.1.1.2.1.2.2.1" xref="S3.p1.9.m1.1.1.1.1.1.2.1.2.2.1.cmml">^</mo></mover><mi id="S3.p1.9.m1.1.1.1.1.1.2.1.2.3" xref="S3.p1.9.m1.1.1.1.1.1.2.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.p1.9.m1.1.1.1.1.1.2.1.1" xref="S3.p1.9.m1.1.1.1.1.1.2.1.1.cmml">​</mo><msup id="S3.p1.9.m1.1.1.1.1.1.2.1.3" xref="S3.p1.9.m1.1.1.1.1.1.2.1.3.cmml"><mover accent="true" id="S3.p1.9.m1.1.1.1.1.1.2.1.3.2" xref="S3.p1.9.m1.1.1.1.1.1.2.1.3.2.cmml"><mi id="S3.p1.9.m1.1.1.1.1.1.2.1.3.2.2" xref="S3.p1.9.m1.1.1.1.1.1.2.1.3.2.2.cmml">𝒙</mi><mo id="S3.p1.9.m1.1.1.1.1.1.2.1.3.2.1" xref="S3.p1.9.m1.1.1.1.1.1.2.1.3.2.1.cmml">^</mo></mover><mo id="S3.p1.9.m1.1.1.1.1.1.2.1.3.3" xref="S3.p1.9.m1.1.1.1.1.1.2.1.3.3.cmml">⊤</mo></msup></mrow></mtd></mtr></mtable><mo id="S3.p1.9.m1.1.1.3.2" xref="S3.p1.9.m1.1.1.2.1.cmml">]</mo></mrow><mo id="S3.p1.9.m1.1.2.1" xref="S3.p1.9.m1.1.2.1.cmml">∈</mo><msup id="S3.p1.9.m1.1.2.2" xref="S3.p1.9.m1.1.2.2.cmml"><mi id="S3.p1.9.m1.1.2.2.2" xref="S3.p1.9.m1.1.2.2.2.cmml">ℝ</mi><mrow id="S3.p1.9.m1.1.2.2.3" xref="S3.p1.9.m1.1.2.2.3.cmml"><mn id="S3.p1.9.m1.1.2.2.3.2" xref="S3.p1.9.m1.1.2.2.3.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S3.p1.9.m1.1.2.2.3.1" xref="S3.p1.9.m1.1.2.2.3.1.cmml">×</mo><mi id="S3.p1.9.m1.1.2.2.3.3" xref="S3.p1.9.m1.1.2.2.3.3.cmml">l</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.9.m1.1b"><apply id="S3.p1.9.m1.1.2.cmml" xref="S3.p1.9.m1.1.2"><in id="S3.p1.9.m1.1.2.1.cmml" xref="S3.p1.9.m1.1.2.1"></in><apply id="S3.p1.9.m1.1.1.2.cmml" xref="S3.p1.9.m1.1.1.3"><csymbol cd="latexml" id="S3.p1.9.m1.1.1.2.1.cmml" xref="S3.p1.9.m1.1.1.3.1">matrix</csymbol><matrix id="S3.p1.9.m1.1.1.1.1.cmml" xref="S3.p1.9.m1.1.1.1.1"><matrixrow id="S3.p1.9.m1.1.1.1.1a.cmml" xref="S3.p1.9.m1.1.1.1.1"><apply id="S3.p1.9.m1.1.1.1.1.1.1.1.cmml" xref="S3.p1.9.m1.1.1.1.1.1.1.1"><times id="S3.p1.9.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.p1.9.m1.1.1.1.1.1.1.1.1"></times><apply id="S3.p1.9.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.p1.9.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.9.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.p1.9.m1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.p1.9.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.p1.9.m1.1.1.1.1.1.1.1.2.2"><ci id="S3.p1.9.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.p1.9.m1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.p1.9.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.p1.9.m1.1.1.1.1.1.1.1.2.2.2">𝑥</ci></apply><ci id="S3.p1.9.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.p1.9.m1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.p1.9.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.p1.9.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.9.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.p1.9.m1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.p1.9.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.p1.9.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.9.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.p1.9.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.p1.9.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.p1.9.m1.1.1.1.1.1.1.1.3.2.2">𝑿</ci><ci id="S3.p1.9.m1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.p1.9.m1.1.1.1.1.1.1.1.3.2.3">𝐷</ci></apply><csymbol cd="latexml" id="S3.p1.9.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.p1.9.m1.1.1.1.1.1.1.1.3.3">top</csymbol></apply></apply><apply id="S3.p1.9.m1.1.1.1.1.1.2.1.cmml" xref="S3.p1.9.m1.1.1.1.1.1.2.1"><times id="S3.p1.9.m1.1.1.1.1.1.2.1.1.cmml" xref="S3.p1.9.m1.1.1.1.1.1.2.1.1"></times><apply id="S3.p1.9.m1.1.1.1.1.1.2.1.2.cmml" xref="S3.p1.9.m1.1.1.1.1.1.2.1.2"><csymbol cd="ambiguous" id="S3.p1.9.m1.1.1.1.1.1.2.1.2.1.cmml" xref="S3.p1.9.m1.1.1.1.1.1.2.1.2">subscript</csymbol><apply id="S3.p1.9.m1.1.1.1.1.1.2.1.2.2.cmml" xref="S3.p1.9.m1.1.1.1.1.1.2.1.2.2"><ci id="S3.p1.9.m1.1.1.1.1.1.2.1.2.2.1.cmml" xref="S3.p1.9.m1.1.1.1.1.1.2.1.2.2.1">^</ci><ci id="S3.p1.9.m1.1.1.1.1.1.2.1.2.2.2.cmml" xref="S3.p1.9.m1.1.1.1.1.1.2.1.2.2.2">𝑥</ci></apply><ci id="S3.p1.9.m1.1.1.1.1.1.2.1.2.3.cmml" xref="S3.p1.9.m1.1.1.1.1.1.2.1.2.3">𝑖</ci></apply><apply id="S3.p1.9.m1.1.1.1.1.1.2.1.3.cmml" xref="S3.p1.9.m1.1.1.1.1.1.2.1.3"><csymbol cd="ambiguous" id="S3.p1.9.m1.1.1.1.1.1.2.1.3.1.cmml" xref="S3.p1.9.m1.1.1.1.1.1.2.1.3">superscript</csymbol><apply id="S3.p1.9.m1.1.1.1.1.1.2.1.3.2.cmml" xref="S3.p1.9.m1.1.1.1.1.1.2.1.3.2"><ci id="S3.p1.9.m1.1.1.1.1.1.2.1.3.2.1.cmml" xref="S3.p1.9.m1.1.1.1.1.1.2.1.3.2.1">^</ci><ci id="S3.p1.9.m1.1.1.1.1.1.2.1.3.2.2.cmml" xref="S3.p1.9.m1.1.1.1.1.1.2.1.3.2.2">𝒙</ci></apply><csymbol cd="latexml" id="S3.p1.9.m1.1.1.1.1.1.2.1.3.3.cmml" xref="S3.p1.9.m1.1.1.1.1.1.2.1.3.3">top</csymbol></apply></apply></matrixrow></matrix></apply><apply id="S3.p1.9.m1.1.2.2.cmml" xref="S3.p1.9.m1.1.2.2"><csymbol cd="ambiguous" id="S3.p1.9.m1.1.2.2.1.cmml" xref="S3.p1.9.m1.1.2.2">superscript</csymbol><ci id="S3.p1.9.m1.1.2.2.2.cmml" xref="S3.p1.9.m1.1.2.2.2">ℝ</ci><apply id="S3.p1.9.m1.1.2.2.3.cmml" xref="S3.p1.9.m1.1.2.2.3"><times id="S3.p1.9.m1.1.2.2.3.1.cmml" xref="S3.p1.9.m1.1.2.2.3.1"></times><cn type="integer" id="S3.p1.9.m1.1.2.2.3.2.cmml" xref="S3.p1.9.m1.1.2.2.3.2">1</cn><ci id="S3.p1.9.m1.1.2.2.3.3.cmml" xref="S3.p1.9.m1.1.2.2.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m1.1c">\begin{bmatrix}\hat{x}_{i}\bm{X}_{D}^{\top}&amp;\hat{x}_{i}\hat{\bm{x}}^{\top}\end{bmatrix}\in\mathbb{R}^{1\times l}</annotation></semantics></math> and <math id="S3.p1.10.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.p1.10.m2.1a"><mi id="S3.p1.10.m2.1.1" xref="S3.p1.10.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.p1.10.m2.1b"><ci id="S3.p1.10.m2.1.1.cmml" xref="S3.p1.10.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.10.m2.1c">l</annotation></semantics></math> denotes the sequence length of the entire input <math id="S3.p1.11.m3.2" class="ltx_Math" alttext="[\bm{X}_{D},\hat{\bm{x}}]" display="inline"><semantics id="S3.p1.11.m3.2a"><mrow id="S3.p1.11.m3.2.2.1" xref="S3.p1.11.m3.2.2.2.cmml"><mo stretchy="false" id="S3.p1.11.m3.2.2.1.2" xref="S3.p1.11.m3.2.2.2.cmml">[</mo><msub id="S3.p1.11.m3.2.2.1.1" xref="S3.p1.11.m3.2.2.1.1.cmml"><mi id="S3.p1.11.m3.2.2.1.1.2" xref="S3.p1.11.m3.2.2.1.1.2.cmml">𝑿</mi><mi id="S3.p1.11.m3.2.2.1.1.3" xref="S3.p1.11.m3.2.2.1.1.3.cmml">D</mi></msub><mo id="S3.p1.11.m3.2.2.1.3" xref="S3.p1.11.m3.2.2.2.cmml">,</mo><mover accent="true" id="S3.p1.11.m3.1.1" xref="S3.p1.11.m3.1.1.cmml"><mi id="S3.p1.11.m3.1.1.2" xref="S3.p1.11.m3.1.1.2.cmml">𝒙</mi><mo id="S3.p1.11.m3.1.1.1" xref="S3.p1.11.m3.1.1.1.cmml">^</mo></mover><mo stretchy="false" id="S3.p1.11.m3.2.2.1.4" xref="S3.p1.11.m3.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.11.m3.2b"><interval closure="closed" id="S3.p1.11.m3.2.2.2.cmml" xref="S3.p1.11.m3.2.2.1"><apply id="S3.p1.11.m3.2.2.1.1.cmml" xref="S3.p1.11.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.p1.11.m3.2.2.1.1.1.cmml" xref="S3.p1.11.m3.2.2.1.1">subscript</csymbol><ci id="S3.p1.11.m3.2.2.1.1.2.cmml" xref="S3.p1.11.m3.2.2.1.1.2">𝑿</ci><ci id="S3.p1.11.m3.2.2.1.1.3.cmml" xref="S3.p1.11.m3.2.2.1.1.3">𝐷</ci></apply><apply id="S3.p1.11.m3.1.1.cmml" xref="S3.p1.11.m3.1.1"><ci id="S3.p1.11.m3.1.1.1.cmml" xref="S3.p1.11.m3.1.1.1">^</ci><ci id="S3.p1.11.m3.1.1.2.cmml" xref="S3.p1.11.m3.1.1.2">𝒙</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.11.m3.2c">[\bm{X}_{D},\hat{\bm{x}}]</annotation></semantics></math>. Expanding the softmax function, we obtain:</p>
<table id="S3.E2" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E2X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\operatorname{softmax}(\begin{bmatrix}\hat{x}_{i}\bm{X}_{D}^{\top}&amp;\hat{x}_{i}\hat{\bm{x}}^{\top}\end{bmatrix})" display="inline"><semantics id="S3.E2X.2.1.1.m1.1a"><mrow id="S3.E2X.2.1.1.m1.1.2.2" xref="S3.E2X.2.1.1.m1.1.2.1.cmml"><mi id="S3.E2X.2.1.1.m1.1.1" xref="S3.E2X.2.1.1.m1.1.1.cmml">softmax</mi><mo id="S3.E2X.2.1.1.m1.1.2.2a" xref="S3.E2X.2.1.1.m1.1.2.1.cmml">⁡</mo><mrow id="S3.E2X.2.1.1.m1.1.2.2.1" xref="S3.E2X.2.1.1.m1.1.2.1.cmml"><mo stretchy="false" id="S3.E2X.2.1.1.m1.1.2.2.1.1" xref="S3.E2X.2.1.1.m1.1.2.1.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.1.1a.3" xref="S3.E2.m1.1.1.1.1.1.1a.2.cmml"><mo id="S3.E2.m1.1.1.1.1.1.1a.3.1" xref="S3.E2.m1.1.1.1.1.1.1a.2.1.cmml">[</mo><mtable columnspacing="5pt" id="S3.E2.m1.1.1.1.1.1.1.1.1.mf" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.cmml"><mtr id="S3.E2.m1.1.1.1.1.1.1.1.1.mfa" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.cmml"><mtd id="S3.E2.m1.1.1.1.1.1.1.1.1.mfb" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.cmml"><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.cmml"><msub id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2.cmml"><mover accent="true" id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2.2.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2.2.2.cmml">x</mi><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2.2.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.1.cmml">​</mo><msubsup id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3.2.2.cmml">𝑿</mi><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3.2.3.cmml">D</mi><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3.3.cmml">⊤</mo></msubsup></mrow></mtd><mtd id="S3.E2.m1.1.1.1.1.1.1.1.1.mfc" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.cmml"><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.cmml"><msub id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.2.cmml"><mover accent="true" id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.2.2.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.2.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.2.2.2.cmml">x</mi><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.2.2.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.2.2.1.cmml">^</mo></mover><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.1.cmml">​</mo><msup id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.3.cmml"><mover accent="true" id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.3.2.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.3.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.3.2.2.cmml">𝒙</mi><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.3.2.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.3.2.1.cmml">^</mo></mover><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.3.3.cmml">⊤</mo></msup></mrow></mtd></mtr></mtable><mo id="S3.E2.m1.1.1.1.1.1.1a.3.2" xref="S3.E2.m1.1.1.1.1.1.1a.2.1.cmml">]</mo></mrow><mo stretchy="false" id="S3.E2X.2.1.1.m1.1.2.2.1.2" xref="S3.E2X.2.1.1.m1.1.2.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2X.2.1.1.m1.1b"><apply id="S3.E2X.2.1.1.m1.1.2.1.cmml" xref="S3.E2X.2.1.1.m1.1.2.2"><ci id="S3.E2X.2.1.1.m1.1.1.cmml" xref="S3.E2X.2.1.1.m1.1.1">softmax</ci><apply id="S3.E2.m1.1.1.1.1.1.1a.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1a.3"><csymbol cd="latexml" id="S3.E2.m1.1.1.1.1.1.1a.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1a.3.1">matrix</csymbol><matrix id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf"><matrixrow id="S3.E2.m1.1.1.1.1.1.1.1.1.mfa.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf"><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1"><times id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.1"></times><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2">subscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2.2"><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2.2.1">^</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2.2.2">𝑥</ci></apply><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3.2.2">𝑿</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3.2.3">𝐷</ci></apply><csymbol cd="latexml" id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.1.1.3.3">top</csymbol></apply></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1"><times id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.1"></times><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.2">subscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.2.2"><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.2.2.1">^</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.2.2.2">𝑥</ci></apply><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.2.3">𝑖</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.3">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.3.2"><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.3.2.1">^</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.3.2.2">𝒙</ci></apply><csymbol cd="latexml" id="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.mf.1.2.1.3.3">top</csymbol></apply></apply></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2X.2.1.1.m1.1c">\displaystyle\operatorname{softmax}(\begin{bmatrix}\hat{x}_{i}\bm{X}_{D}^{\top}&amp;\hat{x}_{i}\hat{\bm{x}}^{\top}\end{bmatrix})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E2X.3.2.2.m1.1" class="ltx_math_unparsed" alttext="\displaystyle=\begin{bmatrix}\underbrace{\frac{\exp(\hat{x}_{i}\bm{X}_{D}^{\top})_{1}}{Z_{1}+Z_{2}},\dots,\frac{\exp(\hat{x}_{i}\bm{X}_{D}^{\top})_{l_{c}}}{Z_{1}+Z_{2}}}_{\text{expansion of }\hat{x}_{i}\bm{X}_{D}^{\top}},\underbrace{\frac{\exp(\hat{x}_{i}\hat{\bm{x}}^{\top})_{1}}{Z_{1}+Z_{2}},\dots,\frac{\exp(\hat{x}_{i}\hat{\bm{x}}^{\top})_{l_{q}}}{Z_{1}+Z_{2}}}_{\text{expansion of }\hat{x}_{i}\hat{\bm{x}}^{\top}}\end{bmatrix}" display="inline"><semantics id="S3.E2X.3.2.2.m1.1a"><mrow id="S3.E2X.3.2.2.m1.1.1"><mi id="S3.E2X.3.2.2.m1.1.1.2"></mi><mo id="S3.E2X.3.2.2.m1.1.1.1">=</mo><mrow id="S3.E2.m1.2.2.2.2.1.1a.3"><mo id="S3.E2.m1.2.2.2.2.1.1a.3.1">[</mo><mtable id="S3.E2.m1.2.2.2.2.1.1.1.1.mf"><mtr id="S3.E2.m1.2.2.2.2.1.1.1.1.mfa"><mtd id="S3.E2.m1.2.2.2.2.1.1.1.1.mfb"><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.8.8.8.8.8"><munder id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.7.7.7.7.7.1"><munder accentunder="true" id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.3.3.3.3.3"><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.3.3.3.3.3.3.5"><mfrac id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.1.1.1.1.1.1.1"><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.1.1.1.1.1.1.1.1"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.1.1.1.1.1.1.1.1.1">exp</mi><msub id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.1.1.1.1.1.1.1.1.2"><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.1.1.1.1.1.1.1.1.2.2"><mo stretchy="false" id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.1.1.1.1.1.1.1.1.2.2.1">(</mo><msub id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.1.1.1.1.1.1.1.1.2.2.2"><mover accent="true" id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.1.1.1.1.1.1.1.1.2.2.2.2"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.1.1.1.1.1.1.1.1.2.2.2.2.2">x</mi><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.1.1.1.1.1.1.1.1.2.2.2.2.1">^</mo></mover><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.1.1.1.1.1.1.1.1.2.2.2.3">i</mi></msub><msubsup id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.1.1.1.1.1.1.1.1.2.2.3"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.1.1.1.1.1.1.1.1.2.2.3.2.2">𝑿</mi><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.1.1.1.1.1.1.1.1.2.2.3.2.3">D</mi><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.1.1.1.1.1.1.1.1.2.2.3.3">⊤</mo></msubsup><mo stretchy="false" id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.1.1.1.1.1.1.1.1.2.2.4">)</mo></mrow><mn id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.1.1.1.1.1.1.1.1.2.3">1</mn></msub></mrow><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.1.1.1.1.1.1.1.3"><msub id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.1.1.1.1.1.1.1.3.2"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.1.1.1.1.1.1.1.3.2.2">Z</mi><mn id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.1.1.1.1.1.1.1.3.2.3">1</mn></msub><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.1.1.1.1.1.1.1.3.1">+</mo><msub id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.1.1.1.1.1.1.1.3.3"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.1.1.1.1.1.1.1.3.3.2">Z</mi><mn id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.1.1.1.1.1.1.1.3.3.3">2</mn></msub></mrow></mfrac><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.3.3.3.3.3.3.5.1">,</mo><mi mathvariant="normal" id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.3.3.3.3.3.3.3">…</mi><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.3.3.3.3.3.3.5.2">,</mo><mfrac id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.2.2.2.2.2.2.2"><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.2.2.2.2.2.2.2.1"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.2.2.2.2.2.2.2.1.1">exp</mi><msub id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.2.2.2.2.2.2.2.1.2"><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.2.2.2.2.2.2.2.1.2.2"><mo stretchy="false" id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.2.2.2.2.2.2.2.1.2.2.1">(</mo><msub id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.2.2.2.2.2.2.2.1.2.2.2"><mover accent="true" id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.2.2.2.2.2.2.2.1.2.2.2.2"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.2.2.2.2.2.2.2.1.2.2.2.2.2">x</mi><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.2.2.2.2.2.2.2.1.2.2.2.2.1">^</mo></mover><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.2.2.2.2.2.2.2.1.2.2.2.3">i</mi></msub><msubsup id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.2.2.2.2.2.2.2.1.2.2.3"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.2.2.2.2.2.2.2.1.2.2.3.2.2">𝑿</mi><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.2.2.2.2.2.2.2.1.2.2.3.2.3">D</mi><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.2.2.2.2.2.2.2.1.2.2.3.3">⊤</mo></msubsup><mo stretchy="false" id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.2.2.2.2.2.2.2.1.2.2.4">)</mo></mrow><msub id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.2.2.2.2.2.2.2.1.2.3"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.2.2.2.2.2.2.2.1.2.3.2">l</mi><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.2.2.2.2.2.2.2.1.2.3.3">c</mi></msub></msub></mrow><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.2.2.2.2.2.2.2.3"><msub id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.2.2.2.2.2.2.2.3.2"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.2.2.2.2.2.2.2.3.2.2">Z</mi><mn id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.2.2.2.2.2.2.2.3.2.3">1</mn></msub><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.2.2.2.2.2.2.2.3.1">+</mo><msub id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.2.2.2.2.2.2.2.3.3"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.2.2.2.2.2.2.2.3.3.2">Z</mi><mn id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.2.2.2.2.2.2.2.3.3.3">2</mn></msub></mrow></mfrac></mrow><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.3.3.3.3.3.4">⏟</mo></munder><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.7.7.7.7.7.1.2"><mtext id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.7.7.7.7.7.1.2.2">expansion of </mtext><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.7.7.7.7.7.1.2.1">​</mo><msub id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.7.7.7.7.7.1.2.3"><mover accent="true" id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.7.7.7.7.7.1.2.3.2"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.7.7.7.7.7.1.2.3.2.2">x</mi><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.7.7.7.7.7.1.2.3.2.1">^</mo></mover><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.7.7.7.7.7.1.2.3.3">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.7.7.7.7.7.1.2.1a">​</mo><msubsup id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.7.7.7.7.7.1.2.4"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.7.7.7.7.7.1.2.4.2.2">𝑿</mi><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.7.7.7.7.7.1.2.4.2.3">D</mi><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.7.7.7.7.7.1.2.4.3">⊤</mo></msubsup></mrow></munder><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.8.8.8.8.8.3">,</mo><munder id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.8.8.8.8.8.2"><munder accentunder="true" id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.6.6.6.6.6"><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.6.6.6.6.6.3.5"><mfrac id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.4.4.4.4.4.1.1"><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.4.4.4.4.4.1.1.1"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.4.4.4.4.4.1.1.1.1">exp</mi><msub id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.4.4.4.4.4.1.1.1.2"><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.4.4.4.4.4.1.1.1.2.2"><mo stretchy="false" id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.4.4.4.4.4.1.1.1.2.2.1">(</mo><msub id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.4.4.4.4.4.1.1.1.2.2.2"><mover accent="true" id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.4.4.4.4.4.1.1.1.2.2.2.2"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.4.4.4.4.4.1.1.1.2.2.2.2.2">x</mi><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.4.4.4.4.4.1.1.1.2.2.2.2.1">^</mo></mover><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.4.4.4.4.4.1.1.1.2.2.2.3">i</mi></msub><msup id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.4.4.4.4.4.1.1.1.2.2.3"><mover accent="true" id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.4.4.4.4.4.1.1.1.2.2.3.2"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.4.4.4.4.4.1.1.1.2.2.3.2.2">𝒙</mi><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.4.4.4.4.4.1.1.1.2.2.3.2.1">^</mo></mover><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.4.4.4.4.4.1.1.1.2.2.3.3">⊤</mo></msup><mo stretchy="false" id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.4.4.4.4.4.1.1.1.2.2.4">)</mo></mrow><mn id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.4.4.4.4.4.1.1.1.2.3">1</mn></msub></mrow><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.4.4.4.4.4.1.1.3"><msub id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.4.4.4.4.4.1.1.3.2"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.4.4.4.4.4.1.1.3.2.2">Z</mi><mn id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.4.4.4.4.4.1.1.3.2.3">1</mn></msub><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.4.4.4.4.4.1.1.3.1">+</mo><msub id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.4.4.4.4.4.1.1.3.3"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.4.4.4.4.4.1.1.3.3.2">Z</mi><mn id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.4.4.4.4.4.1.1.3.3.3">2</mn></msub></mrow></mfrac><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.6.6.6.6.6.3.5.1">,</mo><mi mathvariant="normal" id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.6.6.6.6.6.3.3">…</mi><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.6.6.6.6.6.3.5.2">,</mo><mfrac id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2"><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2.1"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2.1.1">exp</mi><msub id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2.1.2"><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2.1.2.2"><mo stretchy="false" id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2.1.2.2.1">(</mo><msub id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2.1.2.2.2"><mover accent="true" id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2.1.2.2.2.2"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2.1.2.2.2.2.2">x</mi><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2.1.2.2.2.2.1">^</mo></mover><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2.1.2.2.2.3">i</mi></msub><msup id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2.1.2.2.3"><mover accent="true" id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2.1.2.2.3.2"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2.1.2.2.3.2.2">𝒙</mi><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2.1.2.2.3.2.1">^</mo></mover><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2.1.2.2.3.3">⊤</mo></msup><mo stretchy="false" id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2.1.2.2.4">)</mo></mrow><msub id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2.1.2.3"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2.1.2.3.2">l</mi><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2.1.2.3.3">q</mi></msub></msub></mrow><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2.3"><msub id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2.3.2"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2.3.2.2">Z</mi><mn id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2.3.2.3">1</mn></msub><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2.3.1">+</mo><msub id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2.3.3"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2.3.3.2">Z</mi><mn id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.5.5.5.5.5.2.2.3.3.3">2</mn></msub></mrow></mfrac></mrow><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.6.6.6.6.6.4">⏟</mo></munder><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.8.8.8.8.8.2.2"><mtext id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.8.8.8.8.8.2.2.2">expansion of </mtext><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.8.8.8.8.8.2.2.1">​</mo><msub id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.8.8.8.8.8.2.2.3"><mover accent="true" id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.8.8.8.8.8.2.2.3.2"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.8.8.8.8.8.2.2.3.2.2">x</mi><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.8.8.8.8.8.2.2.3.2.1">^</mo></mover><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.8.8.8.8.8.2.2.3.3">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.8.8.8.8.8.2.2.1a">​</mo><msup id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.8.8.8.8.8.2.2.4"><mover accent="true" id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.8.8.8.8.8.2.2.4.2"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.8.8.8.8.8.2.2.4.2.2">𝒙</mi><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.8.8.8.8.8.2.2.4.2.1">^</mo></mover><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.mf.8.8.8.8.8.2.2.4.3">⊤</mo></msup></mrow></munder></mrow></mtd></mtr></mtable><mo id="S3.E2.m1.2.2.2.2.1.1a.3.2">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E2X.3.2.2.m1.1b">\displaystyle=\begin{bmatrix}\underbrace{\frac{\exp(\hat{x}_{i}\bm{X}_{D}^{\top})_{1}}{Z_{1}+Z_{2}},\dots,\frac{\exp(\hat{x}_{i}\bm{X}_{D}^{\top})_{l_{c}}}{Z_{1}+Z_{2}}}_{\text{expansion of }\hat{x}_{i}\bm{X}_{D}^{\top}},\underbrace{\frac{\exp(\hat{x}_{i}\hat{\bm{x}}^{\top})_{1}}{Z_{1}+Z_{2}},\dots,\frac{\exp(\hat{x}_{i}\hat{\bm{x}}^{\top})_{l_{q}}}{Z_{1}+Z_{2}}}_{\text{expansion of }\hat{x}_{i}\hat{\bm{x}}^{\top}}\end{bmatrix}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(2)</span></td>
</tr>
<tr id="S3.E2Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E2Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle=\begin{bmatrix}\cfrac{\exp(\hat{x}_{i}\bm{X}_{D}^{\top})}{Z_{1}+Z_{2}}&amp;\cfrac{\exp(\hat{x}_{i}\hat{\bm{x}}^{\top})}{Z_{1}+Z_{2}}\end{bmatrix}," display="inline"><semantics id="S3.E2Xa.2.1.1.m1.1a"><mrow id="S3.E2Xa.2.1.1.m1.1.1.1" xref="S3.E2Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E2Xa.2.1.1.m1.1.1.1.1" xref="S3.E2Xa.2.1.1.m1.1.1.1.1.cmml"><mi id="S3.E2Xa.2.1.1.m1.1.1.1.1.2" xref="S3.E2Xa.2.1.1.m1.1.1.1.1.2.cmml"></mi><mo id="S3.E2Xa.2.1.1.m1.1.1.1.1.1" xref="S3.E2Xa.2.1.1.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.3.3.3.1.1.1a.3" xref="S3.E2.m1.3.3.3.1.1.1a.2.cmml"><mo id="S3.E2.m1.3.3.3.1.1.1a.3.1" xref="S3.E2.m1.3.3.3.1.1.1a.2.1.cmml">[</mo><mtable columnspacing="5pt" id="S3.E2.m1.3.3.3.1.1.1.1.1.mf" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.cmml"><mtr id="S3.E2.m1.3.3.3.1.1.1.1.1.mfa" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.cmml"><mtd id="S3.E2.m1.3.3.3.1.1.1.1.1.mfb" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.cmml"><mfrac id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.cmml"><mrow id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.3.cmml"><mi id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.1.1.1.1.1.1.1" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.1.1.1.1.1.1.1.cmml">exp</mi><mo id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2a" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.3.cmml">⁡</mo><mrow id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.2" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.3.cmml">(</mo><mrow id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.cmml"><msub id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.2" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.2.cmml"><mover accent="true" id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.2.2" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.2.2.cmml"><mi id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.2.2.2" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.2.2.2.cmml">x</mi><mo id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.2.2.1" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.2.3" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.1" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.1.cmml">​</mo><msubsup id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.3" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.3.cmml"><mi id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.3.2.2" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.3.2.2.cmml">𝑿</mi><mi id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.3.2.3" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.3.2.3.cmml">D</mi><mo id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.3.3" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.3.3.cmml">⊤</mo></msubsup></mrow><mo stretchy="false" id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.3" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.cmml"><msub id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.2" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.2.cmml"><mi id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.2.2" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.2.2.cmml">Z</mi><mn id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.2.3" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.2.3.cmml">1</mn></msub><mo id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.1" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.1.cmml">+</mo><msub id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.3" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.3.cmml"><mi id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.3.2" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.3.2.cmml">Z</mi><mn id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.3.3" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.3.3.cmml">2</mn></msub></mrow></mfrac></mtd><mtd id="S3.E2.m1.3.3.3.1.1.1.1.1.mfc" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.cmml"><mfrac id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.cmml"><mrow id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.3.cmml"><mi id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.3.3.3.1.1.1.1" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.3.3.3.1.1.1.1.cmml">exp</mi><mo id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2a" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.3.cmml">⁡</mo><mrow id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.2" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.3.cmml">(</mo><mrow id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.cmml"><msub id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.2" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.2.cmml"><mover accent="true" id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.2.2" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.2.2.cmml"><mi id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.2.2.2" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.2.2.2.cmml">x</mi><mo id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.2.2.1" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.2.3" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.1" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.1.cmml">​</mo><msup id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.3" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.3.cmml"><mover accent="true" id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.3.2" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.3.2.cmml"><mi id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.3.2.2" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.3.2.2.cmml">𝒙</mi><mo id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.3.2.1" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.3.2.1.cmml">^</mo></mover><mo id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.3.3" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.3.3.cmml">⊤</mo></msup></mrow><mo stretchy="false" id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.3" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.cmml"><msub id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.2" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.2.cmml"><mi id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.2.2" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.2.2.cmml">Z</mi><mn id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.2.3" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.2.3.cmml">1</mn></msub><mo id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.1" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.1.cmml">+</mo><msub id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.3" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.3.cmml"><mi id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.3.2" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.3.2.cmml">Z</mi><mn id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.3.3" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.3.3.cmml">2</mn></msub></mrow></mfrac></mtd></mtr></mtable><mo id="S3.E2.m1.3.3.3.1.1.1a.3.2" xref="S3.E2.m1.3.3.3.1.1.1a.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E2Xa.2.1.1.m1.1.1.1.2" xref="S3.E2Xa.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2Xa.2.1.1.m1.1b"><apply id="S3.E2Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.1.1.1"><eq id="S3.E2Xa.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.1.1.1.1.1"></eq><csymbol cd="latexml" id="S3.E2Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E2Xa.2.1.1.m1.1.1.1.1.2">absent</csymbol><apply id="S3.E2.m1.3.3.3.1.1.1a.2.cmml" xref="S3.E2.m1.3.3.3.1.1.1a.3"><csymbol cd="latexml" id="S3.E2.m1.3.3.3.1.1.1a.2.1.cmml" xref="S3.E2.m1.3.3.3.1.1.1a.3.1">matrix</csymbol><matrix id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf"><matrixrow id="S3.E2.m1.3.3.3.1.1.1.1.1.mfa.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf"><apply id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2"><csymbol cd="latexml" id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.3.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2">continued-fraction</csymbol><apply id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.3.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2"><exp id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.1.1.1.1.1.1.1"></exp><apply id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1"><times id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.1.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.1"></times><apply id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.2.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.2.1.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.2">subscript</csymbol><apply id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.2.2.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.2.2"><ci id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.2.2.1.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.2.2.1">^</ci><ci id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.2.2.2.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.2.2.2">𝑥</ci></apply><ci id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.2.3.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.2.3">𝑖</ci></apply><apply id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.3.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.3.1.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.3">superscript</csymbol><apply id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.3.2.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.3.2.1.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.3.2.2.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.3.2.2">𝑿</ci><ci id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.3.2.3.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.3.2.3">𝐷</ci></apply><csymbol cd="latexml" id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.3.3.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.2.2.2.1.1.3.3">top</csymbol></apply></apply></apply><apply id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4"><plus id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.1.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.1"></plus><apply id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.2.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.2.1.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.2">subscript</csymbol><ci id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.2.2.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.2.2">𝑍</ci><cn type="integer" id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.2.3.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.2.3">1</cn></apply><apply id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.3.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.3.1.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.3">subscript</csymbol><ci id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.3.2.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.3.2">𝑍</ci><cn type="integer" id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.3.3.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.2.2.2.2.4.3.3">2</cn></apply></apply></apply><apply id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2"><csymbol cd="latexml" id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.3.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2">continued-fraction</csymbol><apply id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.3.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2"><exp id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.3.3.3.1.1.1.1.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.3.3.3.1.1.1.1"></exp><apply id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1"><times id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.1.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.1"></times><apply id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.2.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.2.1.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.2">subscript</csymbol><apply id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.2.2.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.2.2"><ci id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.2.2.1.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.2.2.1">^</ci><ci id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.2.2.2.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.2.2.2">𝑥</ci></apply><ci id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.2.3.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.2.3">𝑖</ci></apply><apply id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.3.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.3.1.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.3">superscript</csymbol><apply id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.3.2.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.3.2"><ci id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.3.2.1.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.3.2.1">^</ci><ci id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.3.2.2.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.3.2.2">𝒙</ci></apply><csymbol cd="latexml" id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.3.3.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.2.2.2.1.1.3.3">top</csymbol></apply></apply></apply><apply id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4"><plus id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.1.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.1"></plus><apply id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.2.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.2.1.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.2">subscript</csymbol><ci id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.2.2.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.2.2">𝑍</ci><cn type="integer" id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.2.3.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.2.3">1</cn></apply><apply id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.3.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.3.1.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.3">subscript</csymbol><ci id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.3.2.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.3.2">𝑍</ci><cn type="integer" id="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.3.3.cmml" xref="S3.E2.m1.3.3.3.1.1.1.1.1.mf.4.4.4.2.4.3.3">2</cn></apply></apply></apply></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2Xa.2.1.1.m1.1c">\displaystyle=\begin{bmatrix}\cfrac{\exp(\hat{x}_{i}\bm{X}_{D}^{\top})}{Z_{1}+Z_{2}}&amp;\cfrac{\exp(\hat{x}_{i}\hat{\bm{x}}^{\top})}{Z_{1}+Z_{2}}\end{bmatrix},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.p1.22" class="ltx_p">where <math id="S3.p1.12.m1.1" class="ltx_Math" alttext="l_{c}" display="inline"><semantics id="S3.p1.12.m1.1a"><msub id="S3.p1.12.m1.1.1" xref="S3.p1.12.m1.1.1.cmml"><mi id="S3.p1.12.m1.1.1.2" xref="S3.p1.12.m1.1.1.2.cmml">l</mi><mi id="S3.p1.12.m1.1.1.3" xref="S3.p1.12.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.12.m1.1b"><apply id="S3.p1.12.m1.1.1.cmml" xref="S3.p1.12.m1.1.1"><csymbol cd="ambiguous" id="S3.p1.12.m1.1.1.1.cmml" xref="S3.p1.12.m1.1.1">subscript</csymbol><ci id="S3.p1.12.m1.1.1.2.cmml" xref="S3.p1.12.m1.1.1.2">𝑙</ci><ci id="S3.p1.12.m1.1.1.3.cmml" xref="S3.p1.12.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.12.m1.1c">l_{c}</annotation></semantics></math> and <math id="S3.p1.13.m2.1" class="ltx_Math" alttext="l_{q}" display="inline"><semantics id="S3.p1.13.m2.1a"><msub id="S3.p1.13.m2.1.1" xref="S3.p1.13.m2.1.1.cmml"><mi id="S3.p1.13.m2.1.1.2" xref="S3.p1.13.m2.1.1.2.cmml">l</mi><mi id="S3.p1.13.m2.1.1.3" xref="S3.p1.13.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.13.m2.1b"><apply id="S3.p1.13.m2.1.1.cmml" xref="S3.p1.13.m2.1.1"><csymbol cd="ambiguous" id="S3.p1.13.m2.1.1.1.cmml" xref="S3.p1.13.m2.1.1">subscript</csymbol><ci id="S3.p1.13.m2.1.1.2.cmml" xref="S3.p1.13.m2.1.1.2">𝑙</ci><ci id="S3.p1.13.m2.1.1.3.cmml" xref="S3.p1.13.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.13.m2.1c">l_{q}</annotation></semantics></math> represent the lengths of the <math id="S3.p1.14.m3.1" class="ltx_Math" alttext="\bm{X}_{D}" display="inline"><semantics id="S3.p1.14.m3.1a"><msub id="S3.p1.14.m3.1.1" xref="S3.p1.14.m3.1.1.cmml"><mi id="S3.p1.14.m3.1.1.2" xref="S3.p1.14.m3.1.1.2.cmml">𝑿</mi><mi id="S3.p1.14.m3.1.1.3" xref="S3.p1.14.m3.1.1.3.cmml">D</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.14.m3.1b"><apply id="S3.p1.14.m3.1.1.cmml" xref="S3.p1.14.m3.1.1"><csymbol cd="ambiguous" id="S3.p1.14.m3.1.1.1.cmml" xref="S3.p1.14.m3.1.1">subscript</csymbol><ci id="S3.p1.14.m3.1.1.2.cmml" xref="S3.p1.14.m3.1.1.2">𝑿</ci><ci id="S3.p1.14.m3.1.1.3.cmml" xref="S3.p1.14.m3.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.14.m3.1c">\bm{X}_{D}</annotation></semantics></math> and <math id="S3.p1.15.m4.1" class="ltx_Math" alttext="\hat{\bm{x}}" display="inline"><semantics id="S3.p1.15.m4.1a"><mover accent="true" id="S3.p1.15.m4.1.1" xref="S3.p1.15.m4.1.1.cmml"><mi id="S3.p1.15.m4.1.1.2" xref="S3.p1.15.m4.1.1.2.cmml">𝒙</mi><mo id="S3.p1.15.m4.1.1.1" xref="S3.p1.15.m4.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.p1.15.m4.1b"><apply id="S3.p1.15.m4.1.1.cmml" xref="S3.p1.15.m4.1.1"><ci id="S3.p1.15.m4.1.1.1.cmml" xref="S3.p1.15.m4.1.1.1">^</ci><ci id="S3.p1.15.m4.1.1.2.cmml" xref="S3.p1.15.m4.1.1.2">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.15.m4.1c">\hat{\bm{x}}</annotation></semantics></math>, respectively. <math id="S3.p1.16.m5.1" class="ltx_Math" alttext="Z_{1}" display="inline"><semantics id="S3.p1.16.m5.1a"><msub id="S3.p1.16.m5.1.1" xref="S3.p1.16.m5.1.1.cmml"><mi id="S3.p1.16.m5.1.1.2" xref="S3.p1.16.m5.1.1.2.cmml">Z</mi><mn id="S3.p1.16.m5.1.1.3" xref="S3.p1.16.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p1.16.m5.1b"><apply id="S3.p1.16.m5.1.1.cmml" xref="S3.p1.16.m5.1.1"><csymbol cd="ambiguous" id="S3.p1.16.m5.1.1.1.cmml" xref="S3.p1.16.m5.1.1">subscript</csymbol><ci id="S3.p1.16.m5.1.1.2.cmml" xref="S3.p1.16.m5.1.1.2">𝑍</ci><cn type="integer" id="S3.p1.16.m5.1.1.3.cmml" xref="S3.p1.16.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.16.m5.1c">Z_{1}</annotation></semantics></math> and <math id="S3.p1.17.m6.1" class="ltx_Math" alttext="Z_{2}" display="inline"><semantics id="S3.p1.17.m6.1a"><msub id="S3.p1.17.m6.1.1" xref="S3.p1.17.m6.1.1.cmml"><mi id="S3.p1.17.m6.1.1.2" xref="S3.p1.17.m6.1.1.2.cmml">Z</mi><mn id="S3.p1.17.m6.1.1.3" xref="S3.p1.17.m6.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p1.17.m6.1b"><apply id="S3.p1.17.m6.1.1.cmml" xref="S3.p1.17.m6.1.1"><csymbol cd="ambiguous" id="S3.p1.17.m6.1.1.1.cmml" xref="S3.p1.17.m6.1.1">subscript</csymbol><ci id="S3.p1.17.m6.1.1.2.cmml" xref="S3.p1.17.m6.1.1.2">𝑍</ci><cn type="integer" id="S3.p1.17.m6.1.1.3.cmml" xref="S3.p1.17.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.17.m6.1c">Z_{2}</annotation></semantics></math> are the sum of exponential scores between the query token <math id="S3.p1.18.m7.1" class="ltx_Math" alttext="\hat{x}_{i}" display="inline"><semantics id="S3.p1.18.m7.1a"><msub id="S3.p1.18.m7.1.1" xref="S3.p1.18.m7.1.1.cmml"><mover accent="true" id="S3.p1.18.m7.1.1.2" xref="S3.p1.18.m7.1.1.2.cmml"><mi id="S3.p1.18.m7.1.1.2.2" xref="S3.p1.18.m7.1.1.2.2.cmml">x</mi><mo id="S3.p1.18.m7.1.1.2.1" xref="S3.p1.18.m7.1.1.2.1.cmml">^</mo></mover><mi id="S3.p1.18.m7.1.1.3" xref="S3.p1.18.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.18.m7.1b"><apply id="S3.p1.18.m7.1.1.cmml" xref="S3.p1.18.m7.1.1"><csymbol cd="ambiguous" id="S3.p1.18.m7.1.1.1.cmml" xref="S3.p1.18.m7.1.1">subscript</csymbol><apply id="S3.p1.18.m7.1.1.2.cmml" xref="S3.p1.18.m7.1.1.2"><ci id="S3.p1.18.m7.1.1.2.1.cmml" xref="S3.p1.18.m7.1.1.2.1">^</ci><ci id="S3.p1.18.m7.1.1.2.2.cmml" xref="S3.p1.18.m7.1.1.2.2">𝑥</ci></apply><ci id="S3.p1.18.m7.1.1.3.cmml" xref="S3.p1.18.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.18.m7.1c">\hat{x}_{i}</annotation></semantics></math> with each token in <math id="S3.p1.19.m8.1" class="ltx_Math" alttext="\bm{X}_{D}" display="inline"><semantics id="S3.p1.19.m8.1a"><msub id="S3.p1.19.m8.1.1" xref="S3.p1.19.m8.1.1.cmml"><mi id="S3.p1.19.m8.1.1.2" xref="S3.p1.19.m8.1.1.2.cmml">𝑿</mi><mi id="S3.p1.19.m8.1.1.3" xref="S3.p1.19.m8.1.1.3.cmml">D</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.19.m8.1b"><apply id="S3.p1.19.m8.1.1.cmml" xref="S3.p1.19.m8.1.1"><csymbol cd="ambiguous" id="S3.p1.19.m8.1.1.1.cmml" xref="S3.p1.19.m8.1.1">subscript</csymbol><ci id="S3.p1.19.m8.1.1.2.cmml" xref="S3.p1.19.m8.1.1.2">𝑿</ci><ci id="S3.p1.19.m8.1.1.3.cmml" xref="S3.p1.19.m8.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.19.m8.1c">\bm{X}_{D}</annotation></semantics></math> and <math id="S3.p1.20.m9.1" class="ltx_Math" alttext="\hat{\bm{x}}" display="inline"><semantics id="S3.p1.20.m9.1a"><mover accent="true" id="S3.p1.20.m9.1.1" xref="S3.p1.20.m9.1.1.cmml"><mi id="S3.p1.20.m9.1.1.2" xref="S3.p1.20.m9.1.1.2.cmml">𝒙</mi><mo id="S3.p1.20.m9.1.1.1" xref="S3.p1.20.m9.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.p1.20.m9.1b"><apply id="S3.p1.20.m9.1.1.cmml" xref="S3.p1.20.m9.1.1"><ci id="S3.p1.20.m9.1.1.1.cmml" xref="S3.p1.20.m9.1.1.1">^</ci><ci id="S3.p1.20.m9.1.1.2.cmml" xref="S3.p1.20.m9.1.1.2">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.20.m9.1c">\hat{\bm{x}}</annotation></semantics></math>: <math id="S3.p1.21.m10.2" class="ltx_Math" alttext="Z_{1}=\sum_{l_{c}}\exp(\hat{x}_{i}\bm{X}_{D}^{\top})" display="inline"><semantics id="S3.p1.21.m10.2a"><mrow id="S3.p1.21.m10.2.2" xref="S3.p1.21.m10.2.2.cmml"><msub id="S3.p1.21.m10.2.2.3" xref="S3.p1.21.m10.2.2.3.cmml"><mi id="S3.p1.21.m10.2.2.3.2" xref="S3.p1.21.m10.2.2.3.2.cmml">Z</mi><mn id="S3.p1.21.m10.2.2.3.3" xref="S3.p1.21.m10.2.2.3.3.cmml">1</mn></msub><mo rspace="0.111em" id="S3.p1.21.m10.2.2.2" xref="S3.p1.21.m10.2.2.2.cmml">=</mo><mrow id="S3.p1.21.m10.2.2.1" xref="S3.p1.21.m10.2.2.1.cmml"><msub id="S3.p1.21.m10.2.2.1.2" xref="S3.p1.21.m10.2.2.1.2.cmml"><mo id="S3.p1.21.m10.2.2.1.2.2" xref="S3.p1.21.m10.2.2.1.2.2.cmml">∑</mo><msub id="S3.p1.21.m10.2.2.1.2.3" xref="S3.p1.21.m10.2.2.1.2.3.cmml"><mi id="S3.p1.21.m10.2.2.1.2.3.2" xref="S3.p1.21.m10.2.2.1.2.3.2.cmml">l</mi><mi id="S3.p1.21.m10.2.2.1.2.3.3" xref="S3.p1.21.m10.2.2.1.2.3.3.cmml">c</mi></msub></msub><mrow id="S3.p1.21.m10.2.2.1.1.1" xref="S3.p1.21.m10.2.2.1.1.2.cmml"><mi id="S3.p1.21.m10.1.1" xref="S3.p1.21.m10.1.1.cmml">exp</mi><mo id="S3.p1.21.m10.2.2.1.1.1a" xref="S3.p1.21.m10.2.2.1.1.2.cmml">⁡</mo><mrow id="S3.p1.21.m10.2.2.1.1.1.1" xref="S3.p1.21.m10.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.p1.21.m10.2.2.1.1.1.1.2" xref="S3.p1.21.m10.2.2.1.1.2.cmml">(</mo><mrow id="S3.p1.21.m10.2.2.1.1.1.1.1" xref="S3.p1.21.m10.2.2.1.1.1.1.1.cmml"><msub id="S3.p1.21.m10.2.2.1.1.1.1.1.2" xref="S3.p1.21.m10.2.2.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.p1.21.m10.2.2.1.1.1.1.1.2.2" xref="S3.p1.21.m10.2.2.1.1.1.1.1.2.2.cmml"><mi id="S3.p1.21.m10.2.2.1.1.1.1.1.2.2.2" xref="S3.p1.21.m10.2.2.1.1.1.1.1.2.2.2.cmml">x</mi><mo id="S3.p1.21.m10.2.2.1.1.1.1.1.2.2.1" xref="S3.p1.21.m10.2.2.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.p1.21.m10.2.2.1.1.1.1.1.2.3" xref="S3.p1.21.m10.2.2.1.1.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.p1.21.m10.2.2.1.1.1.1.1.1" xref="S3.p1.21.m10.2.2.1.1.1.1.1.1.cmml">​</mo><msubsup id="S3.p1.21.m10.2.2.1.1.1.1.1.3" xref="S3.p1.21.m10.2.2.1.1.1.1.1.3.cmml"><mi id="S3.p1.21.m10.2.2.1.1.1.1.1.3.2.2" xref="S3.p1.21.m10.2.2.1.1.1.1.1.3.2.2.cmml">𝑿</mi><mi id="S3.p1.21.m10.2.2.1.1.1.1.1.3.2.3" xref="S3.p1.21.m10.2.2.1.1.1.1.1.3.2.3.cmml">D</mi><mo id="S3.p1.21.m10.2.2.1.1.1.1.1.3.3" xref="S3.p1.21.m10.2.2.1.1.1.1.1.3.3.cmml">⊤</mo></msubsup></mrow><mo stretchy="false" id="S3.p1.21.m10.2.2.1.1.1.1.3" xref="S3.p1.21.m10.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.21.m10.2b"><apply id="S3.p1.21.m10.2.2.cmml" xref="S3.p1.21.m10.2.2"><eq id="S3.p1.21.m10.2.2.2.cmml" xref="S3.p1.21.m10.2.2.2"></eq><apply id="S3.p1.21.m10.2.2.3.cmml" xref="S3.p1.21.m10.2.2.3"><csymbol cd="ambiguous" id="S3.p1.21.m10.2.2.3.1.cmml" xref="S3.p1.21.m10.2.2.3">subscript</csymbol><ci id="S3.p1.21.m10.2.2.3.2.cmml" xref="S3.p1.21.m10.2.2.3.2">𝑍</ci><cn type="integer" id="S3.p1.21.m10.2.2.3.3.cmml" xref="S3.p1.21.m10.2.2.3.3">1</cn></apply><apply id="S3.p1.21.m10.2.2.1.cmml" xref="S3.p1.21.m10.2.2.1"><apply id="S3.p1.21.m10.2.2.1.2.cmml" xref="S3.p1.21.m10.2.2.1.2"><csymbol cd="ambiguous" id="S3.p1.21.m10.2.2.1.2.1.cmml" xref="S3.p1.21.m10.2.2.1.2">subscript</csymbol><sum id="S3.p1.21.m10.2.2.1.2.2.cmml" xref="S3.p1.21.m10.2.2.1.2.2"></sum><apply id="S3.p1.21.m10.2.2.1.2.3.cmml" xref="S3.p1.21.m10.2.2.1.2.3"><csymbol cd="ambiguous" id="S3.p1.21.m10.2.2.1.2.3.1.cmml" xref="S3.p1.21.m10.2.2.1.2.3">subscript</csymbol><ci id="S3.p1.21.m10.2.2.1.2.3.2.cmml" xref="S3.p1.21.m10.2.2.1.2.3.2">𝑙</ci><ci id="S3.p1.21.m10.2.2.1.2.3.3.cmml" xref="S3.p1.21.m10.2.2.1.2.3.3">𝑐</ci></apply></apply><apply id="S3.p1.21.m10.2.2.1.1.2.cmml" xref="S3.p1.21.m10.2.2.1.1.1"><exp id="S3.p1.21.m10.1.1.cmml" xref="S3.p1.21.m10.1.1"></exp><apply id="S3.p1.21.m10.2.2.1.1.1.1.1.cmml" xref="S3.p1.21.m10.2.2.1.1.1.1.1"><times id="S3.p1.21.m10.2.2.1.1.1.1.1.1.cmml" xref="S3.p1.21.m10.2.2.1.1.1.1.1.1"></times><apply id="S3.p1.21.m10.2.2.1.1.1.1.1.2.cmml" xref="S3.p1.21.m10.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.21.m10.2.2.1.1.1.1.1.2.1.cmml" xref="S3.p1.21.m10.2.2.1.1.1.1.1.2">subscript</csymbol><apply id="S3.p1.21.m10.2.2.1.1.1.1.1.2.2.cmml" xref="S3.p1.21.m10.2.2.1.1.1.1.1.2.2"><ci id="S3.p1.21.m10.2.2.1.1.1.1.1.2.2.1.cmml" xref="S3.p1.21.m10.2.2.1.1.1.1.1.2.2.1">^</ci><ci id="S3.p1.21.m10.2.2.1.1.1.1.1.2.2.2.cmml" xref="S3.p1.21.m10.2.2.1.1.1.1.1.2.2.2">𝑥</ci></apply><ci id="S3.p1.21.m10.2.2.1.1.1.1.1.2.3.cmml" xref="S3.p1.21.m10.2.2.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.p1.21.m10.2.2.1.1.1.1.1.3.cmml" xref="S3.p1.21.m10.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.21.m10.2.2.1.1.1.1.1.3.1.cmml" xref="S3.p1.21.m10.2.2.1.1.1.1.1.3">superscript</csymbol><apply id="S3.p1.21.m10.2.2.1.1.1.1.1.3.2.cmml" xref="S3.p1.21.m10.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.21.m10.2.2.1.1.1.1.1.3.2.1.cmml" xref="S3.p1.21.m10.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.p1.21.m10.2.2.1.1.1.1.1.3.2.2.cmml" xref="S3.p1.21.m10.2.2.1.1.1.1.1.3.2.2">𝑿</ci><ci id="S3.p1.21.m10.2.2.1.1.1.1.1.3.2.3.cmml" xref="S3.p1.21.m10.2.2.1.1.1.1.1.3.2.3">𝐷</ci></apply><csymbol cd="latexml" id="S3.p1.21.m10.2.2.1.1.1.1.1.3.3.cmml" xref="S3.p1.21.m10.2.2.1.1.1.1.1.3.3">top</csymbol></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.21.m10.2c">Z_{1}=\sum_{l_{c}}\exp(\hat{x}_{i}\bm{X}_{D}^{\top})</annotation></semantics></math> and <math id="S3.p1.22.m11.2" class="ltx_Math" alttext="Z_{2}=\sum_{l_{q}}\exp(\hat{x}_{i}\hat{\bm{x}}^{\top})" display="inline"><semantics id="S3.p1.22.m11.2a"><mrow id="S3.p1.22.m11.2.2" xref="S3.p1.22.m11.2.2.cmml"><msub id="S3.p1.22.m11.2.2.3" xref="S3.p1.22.m11.2.2.3.cmml"><mi id="S3.p1.22.m11.2.2.3.2" xref="S3.p1.22.m11.2.2.3.2.cmml">Z</mi><mn id="S3.p1.22.m11.2.2.3.3" xref="S3.p1.22.m11.2.2.3.3.cmml">2</mn></msub><mo rspace="0.111em" id="S3.p1.22.m11.2.2.2" xref="S3.p1.22.m11.2.2.2.cmml">=</mo><mrow id="S3.p1.22.m11.2.2.1" xref="S3.p1.22.m11.2.2.1.cmml"><msub id="S3.p1.22.m11.2.2.1.2" xref="S3.p1.22.m11.2.2.1.2.cmml"><mo id="S3.p1.22.m11.2.2.1.2.2" xref="S3.p1.22.m11.2.2.1.2.2.cmml">∑</mo><msub id="S3.p1.22.m11.2.2.1.2.3" xref="S3.p1.22.m11.2.2.1.2.3.cmml"><mi id="S3.p1.22.m11.2.2.1.2.3.2" xref="S3.p1.22.m11.2.2.1.2.3.2.cmml">l</mi><mi id="S3.p1.22.m11.2.2.1.2.3.3" xref="S3.p1.22.m11.2.2.1.2.3.3.cmml">q</mi></msub></msub><mrow id="S3.p1.22.m11.2.2.1.1.1" xref="S3.p1.22.m11.2.2.1.1.2.cmml"><mi id="S3.p1.22.m11.1.1" xref="S3.p1.22.m11.1.1.cmml">exp</mi><mo id="S3.p1.22.m11.2.2.1.1.1a" xref="S3.p1.22.m11.2.2.1.1.2.cmml">⁡</mo><mrow id="S3.p1.22.m11.2.2.1.1.1.1" xref="S3.p1.22.m11.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.p1.22.m11.2.2.1.1.1.1.2" xref="S3.p1.22.m11.2.2.1.1.2.cmml">(</mo><mrow id="S3.p1.22.m11.2.2.1.1.1.1.1" xref="S3.p1.22.m11.2.2.1.1.1.1.1.cmml"><msub id="S3.p1.22.m11.2.2.1.1.1.1.1.2" xref="S3.p1.22.m11.2.2.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.p1.22.m11.2.2.1.1.1.1.1.2.2" xref="S3.p1.22.m11.2.2.1.1.1.1.1.2.2.cmml"><mi id="S3.p1.22.m11.2.2.1.1.1.1.1.2.2.2" xref="S3.p1.22.m11.2.2.1.1.1.1.1.2.2.2.cmml">x</mi><mo id="S3.p1.22.m11.2.2.1.1.1.1.1.2.2.1" xref="S3.p1.22.m11.2.2.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.p1.22.m11.2.2.1.1.1.1.1.2.3" xref="S3.p1.22.m11.2.2.1.1.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.p1.22.m11.2.2.1.1.1.1.1.1" xref="S3.p1.22.m11.2.2.1.1.1.1.1.1.cmml">​</mo><msup id="S3.p1.22.m11.2.2.1.1.1.1.1.3" xref="S3.p1.22.m11.2.2.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.p1.22.m11.2.2.1.1.1.1.1.3.2" xref="S3.p1.22.m11.2.2.1.1.1.1.1.3.2.cmml"><mi id="S3.p1.22.m11.2.2.1.1.1.1.1.3.2.2" xref="S3.p1.22.m11.2.2.1.1.1.1.1.3.2.2.cmml">𝒙</mi><mo id="S3.p1.22.m11.2.2.1.1.1.1.1.3.2.1" xref="S3.p1.22.m11.2.2.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mo id="S3.p1.22.m11.2.2.1.1.1.1.1.3.3" xref="S3.p1.22.m11.2.2.1.1.1.1.1.3.3.cmml">⊤</mo></msup></mrow><mo stretchy="false" id="S3.p1.22.m11.2.2.1.1.1.1.3" xref="S3.p1.22.m11.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.22.m11.2b"><apply id="S3.p1.22.m11.2.2.cmml" xref="S3.p1.22.m11.2.2"><eq id="S3.p1.22.m11.2.2.2.cmml" xref="S3.p1.22.m11.2.2.2"></eq><apply id="S3.p1.22.m11.2.2.3.cmml" xref="S3.p1.22.m11.2.2.3"><csymbol cd="ambiguous" id="S3.p1.22.m11.2.2.3.1.cmml" xref="S3.p1.22.m11.2.2.3">subscript</csymbol><ci id="S3.p1.22.m11.2.2.3.2.cmml" xref="S3.p1.22.m11.2.2.3.2">𝑍</ci><cn type="integer" id="S3.p1.22.m11.2.2.3.3.cmml" xref="S3.p1.22.m11.2.2.3.3">2</cn></apply><apply id="S3.p1.22.m11.2.2.1.cmml" xref="S3.p1.22.m11.2.2.1"><apply id="S3.p1.22.m11.2.2.1.2.cmml" xref="S3.p1.22.m11.2.2.1.2"><csymbol cd="ambiguous" id="S3.p1.22.m11.2.2.1.2.1.cmml" xref="S3.p1.22.m11.2.2.1.2">subscript</csymbol><sum id="S3.p1.22.m11.2.2.1.2.2.cmml" xref="S3.p1.22.m11.2.2.1.2.2"></sum><apply id="S3.p1.22.m11.2.2.1.2.3.cmml" xref="S3.p1.22.m11.2.2.1.2.3"><csymbol cd="ambiguous" id="S3.p1.22.m11.2.2.1.2.3.1.cmml" xref="S3.p1.22.m11.2.2.1.2.3">subscript</csymbol><ci id="S3.p1.22.m11.2.2.1.2.3.2.cmml" xref="S3.p1.22.m11.2.2.1.2.3.2">𝑙</ci><ci id="S3.p1.22.m11.2.2.1.2.3.3.cmml" xref="S3.p1.22.m11.2.2.1.2.3.3">𝑞</ci></apply></apply><apply id="S3.p1.22.m11.2.2.1.1.2.cmml" xref="S3.p1.22.m11.2.2.1.1.1"><exp id="S3.p1.22.m11.1.1.cmml" xref="S3.p1.22.m11.1.1"></exp><apply id="S3.p1.22.m11.2.2.1.1.1.1.1.cmml" xref="S3.p1.22.m11.2.2.1.1.1.1.1"><times id="S3.p1.22.m11.2.2.1.1.1.1.1.1.cmml" xref="S3.p1.22.m11.2.2.1.1.1.1.1.1"></times><apply id="S3.p1.22.m11.2.2.1.1.1.1.1.2.cmml" xref="S3.p1.22.m11.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.22.m11.2.2.1.1.1.1.1.2.1.cmml" xref="S3.p1.22.m11.2.2.1.1.1.1.1.2">subscript</csymbol><apply id="S3.p1.22.m11.2.2.1.1.1.1.1.2.2.cmml" xref="S3.p1.22.m11.2.2.1.1.1.1.1.2.2"><ci id="S3.p1.22.m11.2.2.1.1.1.1.1.2.2.1.cmml" xref="S3.p1.22.m11.2.2.1.1.1.1.1.2.2.1">^</ci><ci id="S3.p1.22.m11.2.2.1.1.1.1.1.2.2.2.cmml" xref="S3.p1.22.m11.2.2.1.1.1.1.1.2.2.2">𝑥</ci></apply><ci id="S3.p1.22.m11.2.2.1.1.1.1.1.2.3.cmml" xref="S3.p1.22.m11.2.2.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.p1.22.m11.2.2.1.1.1.1.1.3.cmml" xref="S3.p1.22.m11.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.22.m11.2.2.1.1.1.1.1.3.1.cmml" xref="S3.p1.22.m11.2.2.1.1.1.1.1.3">superscript</csymbol><apply id="S3.p1.22.m11.2.2.1.1.1.1.1.3.2.cmml" xref="S3.p1.22.m11.2.2.1.1.1.1.1.3.2"><ci id="S3.p1.22.m11.2.2.1.1.1.1.1.3.2.1.cmml" xref="S3.p1.22.m11.2.2.1.1.1.1.1.3.2.1">^</ci><ci id="S3.p1.22.m11.2.2.1.1.1.1.1.3.2.2.cmml" xref="S3.p1.22.m11.2.2.1.1.1.1.1.3.2.2">𝒙</ci></apply><csymbol cd="latexml" id="S3.p1.22.m11.2.2.1.1.1.1.1.3.3.cmml" xref="S3.p1.22.m11.2.2.1.1.1.1.1.3.3">top</csymbol></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.22.m11.2c">Z_{2}=\sum_{l_{q}}\exp(\hat{x}_{i}\hat{\bm{x}}^{\top})</annotation></semantics></math>. This leads to the following formulation of SA:</p>
<table id="S3.E3" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E3X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3X.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle\operatorname{SA}(\hat{x}_{i},\bm{X},\bm{X})" display="inline"><semantics id="S3.E3X.2.1.1.m1.4a"><mrow id="S3.E3X.2.1.1.m1.4.4.1" xref="S3.E3X.2.1.1.m1.4.4.2.cmml"><mi id="S3.E3X.2.1.1.m1.1.1" xref="S3.E3X.2.1.1.m1.1.1.cmml">SA</mi><mo id="S3.E3X.2.1.1.m1.4.4.1a" xref="S3.E3X.2.1.1.m1.4.4.2.cmml">⁡</mo><mrow id="S3.E3X.2.1.1.m1.4.4.1.1" xref="S3.E3X.2.1.1.m1.4.4.2.cmml"><mo stretchy="false" id="S3.E3X.2.1.1.m1.4.4.1.1.2" xref="S3.E3X.2.1.1.m1.4.4.2.cmml">(</mo><msub id="S3.E3X.2.1.1.m1.4.4.1.1.1" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.cmml"><mover accent="true" id="S3.E3X.2.1.1.m1.4.4.1.1.1.2" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.2.cmml"><mi id="S3.E3X.2.1.1.m1.4.4.1.1.1.2.2" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.2.2.cmml">x</mi><mo id="S3.E3X.2.1.1.m1.4.4.1.1.1.2.1" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E3X.2.1.1.m1.4.4.1.1.1.3" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.3.cmml">i</mi></msub><mo id="S3.E3X.2.1.1.m1.4.4.1.1.3" xref="S3.E3X.2.1.1.m1.4.4.2.cmml">,</mo><mi id="S3.E3X.2.1.1.m1.2.2" xref="S3.E3X.2.1.1.m1.2.2.cmml">𝑿</mi><mo id="S3.E3X.2.1.1.m1.4.4.1.1.4" xref="S3.E3X.2.1.1.m1.4.4.2.cmml">,</mo><mi id="S3.E3X.2.1.1.m1.3.3" xref="S3.E3X.2.1.1.m1.3.3.cmml">𝑿</mi><mo stretchy="false" id="S3.E3X.2.1.1.m1.4.4.1.1.5" xref="S3.E3X.2.1.1.m1.4.4.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3X.2.1.1.m1.4b"><apply id="S3.E3X.2.1.1.m1.4.4.2.cmml" xref="S3.E3X.2.1.1.m1.4.4.1"><ci id="S3.E3X.2.1.1.m1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1">SA</ci><apply id="S3.E3X.2.1.1.m1.4.4.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1">subscript</csymbol><apply id="S3.E3X.2.1.1.m1.4.4.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.2"><ci id="S3.E3X.2.1.1.m1.4.4.1.1.1.2.1.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.2.1">^</ci><ci id="S3.E3X.2.1.1.m1.4.4.1.1.1.2.2.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.2.2">𝑥</ci></apply><ci id="S3.E3X.2.1.1.m1.4.4.1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.3">𝑖</ci></apply><ci id="S3.E3X.2.1.1.m1.2.2.cmml" xref="S3.E3X.2.1.1.m1.2.2">𝑿</ci><ci id="S3.E3X.2.1.1.m1.3.3.cmml" xref="S3.E3X.2.1.1.m1.3.3">𝑿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3X.2.1.1.m1.4c">\displaystyle\operatorname{SA}(\hat{x}_{i},\bm{X},\bm{X})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3X.3.2.2.m1.4" class="ltx_Math" alttext="\displaystyle=\frac{\exp(\hat{x}_{i}\bm{X}_{D}^{\top})\bm{X}_{D}}{Z_{1}+Z_{2}}+\frac{\exp(\hat{x}_{i}\hat{\bm{x}}^{\top})\hat{\bm{x}}}{Z_{1}+Z_{2}}" display="inline"><semantics id="S3.E3X.3.2.2.m1.4a"><mrow id="S3.E3X.3.2.2.m1.4.5" xref="S3.E3X.3.2.2.m1.4.5.cmml"><mi id="S3.E3X.3.2.2.m1.4.5.2" xref="S3.E3X.3.2.2.m1.4.5.2.cmml"></mi><mo id="S3.E3X.3.2.2.m1.4.5.1" xref="S3.E3X.3.2.2.m1.4.5.1.cmml">=</mo><mrow id="S3.E3X.3.2.2.m1.4.5.3" xref="S3.E3X.3.2.2.m1.4.5.3.cmml"><mstyle displaystyle="true" id="S3.E3X.3.2.2.m1.2.2" xref="S3.E3X.3.2.2.m1.2.2.cmml"><mfrac id="S3.E3X.3.2.2.m1.2.2a" xref="S3.E3X.3.2.2.m1.2.2.cmml"><mrow id="S3.E3X.3.2.2.m1.2.2.2" xref="S3.E3X.3.2.2.m1.2.2.2.cmml"><mrow id="S3.E3X.3.2.2.m1.2.2.2.2.1" xref="S3.E3X.3.2.2.m1.2.2.2.2.2.cmml"><mi id="S3.E3X.3.2.2.m1.1.1.1.1" xref="S3.E3X.3.2.2.m1.1.1.1.1.cmml">exp</mi><mo id="S3.E3X.3.2.2.m1.2.2.2.2.1a" xref="S3.E3X.3.2.2.m1.2.2.2.2.2.cmml">⁡</mo><mrow id="S3.E3X.3.2.2.m1.2.2.2.2.1.1" xref="S3.E3X.3.2.2.m1.2.2.2.2.2.cmml"><mo stretchy="false" id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.2" xref="S3.E3X.3.2.2.m1.2.2.2.2.2.cmml">(</mo><mrow id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1" xref="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.cmml"><msub id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.2" xref="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.2.cmml"><mover accent="true" id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.2.2" xref="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.2.2.cmml"><mi id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.2.2.2" xref="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.2.2.2.cmml">x</mi><mo id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.2.2.1" xref="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.2.3" xref="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.1" xref="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.1.cmml">​</mo><msubsup id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.3" xref="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.3.cmml"><mi id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.3.2.2" xref="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.3.2.2.cmml">𝑿</mi><mi id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.3.2.3" xref="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.3.2.3.cmml">D</mi><mo id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.3.3" xref="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.3.3.cmml">⊤</mo></msubsup></mrow><mo stretchy="false" id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.3" xref="S3.E3X.3.2.2.m1.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E3X.3.2.2.m1.2.2.2.3" xref="S3.E3X.3.2.2.m1.2.2.2.3.cmml">​</mo><msub id="S3.E3X.3.2.2.m1.2.2.2.4" xref="S3.E3X.3.2.2.m1.2.2.2.4.cmml"><mi id="S3.E3X.3.2.2.m1.2.2.2.4.2" xref="S3.E3X.3.2.2.m1.2.2.2.4.2.cmml">𝑿</mi><mi id="S3.E3X.3.2.2.m1.2.2.2.4.3" xref="S3.E3X.3.2.2.m1.2.2.2.4.3.cmml">D</mi></msub></mrow><mrow id="S3.E3X.3.2.2.m1.2.2.4" xref="S3.E3X.3.2.2.m1.2.2.4.cmml"><msub id="S3.E3X.3.2.2.m1.2.2.4.2" xref="S3.E3X.3.2.2.m1.2.2.4.2.cmml"><mi id="S3.E3X.3.2.2.m1.2.2.4.2.2" xref="S3.E3X.3.2.2.m1.2.2.4.2.2.cmml">Z</mi><mn id="S3.E3X.3.2.2.m1.2.2.4.2.3" xref="S3.E3X.3.2.2.m1.2.2.4.2.3.cmml">1</mn></msub><mo id="S3.E3X.3.2.2.m1.2.2.4.1" xref="S3.E3X.3.2.2.m1.2.2.4.1.cmml">+</mo><msub id="S3.E3X.3.2.2.m1.2.2.4.3" xref="S3.E3X.3.2.2.m1.2.2.4.3.cmml"><mi id="S3.E3X.3.2.2.m1.2.2.4.3.2" xref="S3.E3X.3.2.2.m1.2.2.4.3.2.cmml">Z</mi><mn id="S3.E3X.3.2.2.m1.2.2.4.3.3" xref="S3.E3X.3.2.2.m1.2.2.4.3.3.cmml">2</mn></msub></mrow></mfrac></mstyle><mo id="S3.E3X.3.2.2.m1.4.5.3.1" xref="S3.E3X.3.2.2.m1.4.5.3.1.cmml">+</mo><mstyle displaystyle="true" id="S3.E3X.3.2.2.m1.4.4" xref="S3.E3X.3.2.2.m1.4.4.cmml"><mfrac id="S3.E3X.3.2.2.m1.4.4a" xref="S3.E3X.3.2.2.m1.4.4.cmml"><mrow id="S3.E3X.3.2.2.m1.4.4.2" xref="S3.E3X.3.2.2.m1.4.4.2.cmml"><mrow id="S3.E3X.3.2.2.m1.4.4.2.2.1" xref="S3.E3X.3.2.2.m1.4.4.2.2.2.cmml"><mi id="S3.E3X.3.2.2.m1.3.3.1.1" xref="S3.E3X.3.2.2.m1.3.3.1.1.cmml">exp</mi><mo id="S3.E3X.3.2.2.m1.4.4.2.2.1a" xref="S3.E3X.3.2.2.m1.4.4.2.2.2.cmml">⁡</mo><mrow id="S3.E3X.3.2.2.m1.4.4.2.2.1.1" xref="S3.E3X.3.2.2.m1.4.4.2.2.2.cmml"><mo stretchy="false" id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.2" xref="S3.E3X.3.2.2.m1.4.4.2.2.2.cmml">(</mo><mrow id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1" xref="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.cmml"><msub id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.2" xref="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.2.cmml"><mover accent="true" id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.2.2" xref="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.2.2.cmml"><mi id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.2.2.2" xref="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.2.2.2.cmml">x</mi><mo id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.2.2.1" xref="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.2.3" xref="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.1" xref="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.1.cmml">​</mo><msup id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.3" xref="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.3.cmml"><mover accent="true" id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.3.2" xref="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.3.2.cmml"><mi id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.3.2.2" xref="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.3.2.2.cmml">𝒙</mi><mo id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.3.2.1" xref="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.3.2.1.cmml">^</mo></mover><mo id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.3.3" xref="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.3.3.cmml">⊤</mo></msup></mrow><mo stretchy="false" id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.3" xref="S3.E3X.3.2.2.m1.4.4.2.2.2.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E3X.3.2.2.m1.4.4.2.3" xref="S3.E3X.3.2.2.m1.4.4.2.3.cmml">​</mo><mover accent="true" id="S3.E3X.3.2.2.m1.4.4.2.4" xref="S3.E3X.3.2.2.m1.4.4.2.4.cmml"><mi id="S3.E3X.3.2.2.m1.4.4.2.4.2" xref="S3.E3X.3.2.2.m1.4.4.2.4.2.cmml">𝒙</mi><mo id="S3.E3X.3.2.2.m1.4.4.2.4.1" xref="S3.E3X.3.2.2.m1.4.4.2.4.1.cmml">^</mo></mover></mrow><mrow id="S3.E3X.3.2.2.m1.4.4.4" xref="S3.E3X.3.2.2.m1.4.4.4.cmml"><msub id="S3.E3X.3.2.2.m1.4.4.4.2" xref="S3.E3X.3.2.2.m1.4.4.4.2.cmml"><mi id="S3.E3X.3.2.2.m1.4.4.4.2.2" xref="S3.E3X.3.2.2.m1.4.4.4.2.2.cmml">Z</mi><mn id="S3.E3X.3.2.2.m1.4.4.4.2.3" xref="S3.E3X.3.2.2.m1.4.4.4.2.3.cmml">1</mn></msub><mo id="S3.E3X.3.2.2.m1.4.4.4.1" xref="S3.E3X.3.2.2.m1.4.4.4.1.cmml">+</mo><msub id="S3.E3X.3.2.2.m1.4.4.4.3" xref="S3.E3X.3.2.2.m1.4.4.4.3.cmml"><mi id="S3.E3X.3.2.2.m1.4.4.4.3.2" xref="S3.E3X.3.2.2.m1.4.4.4.3.2.cmml">Z</mi><mn id="S3.E3X.3.2.2.m1.4.4.4.3.3" xref="S3.E3X.3.2.2.m1.4.4.4.3.3.cmml">2</mn></msub></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3X.3.2.2.m1.4b"><apply id="S3.E3X.3.2.2.m1.4.5.cmml" xref="S3.E3X.3.2.2.m1.4.5"><eq id="S3.E3X.3.2.2.m1.4.5.1.cmml" xref="S3.E3X.3.2.2.m1.4.5.1"></eq><csymbol cd="latexml" id="S3.E3X.3.2.2.m1.4.5.2.cmml" xref="S3.E3X.3.2.2.m1.4.5.2">absent</csymbol><apply id="S3.E3X.3.2.2.m1.4.5.3.cmml" xref="S3.E3X.3.2.2.m1.4.5.3"><plus id="S3.E3X.3.2.2.m1.4.5.3.1.cmml" xref="S3.E3X.3.2.2.m1.4.5.3.1"></plus><apply id="S3.E3X.3.2.2.m1.2.2.cmml" xref="S3.E3X.3.2.2.m1.2.2"><divide id="S3.E3X.3.2.2.m1.2.2.3.cmml" xref="S3.E3X.3.2.2.m1.2.2"></divide><apply id="S3.E3X.3.2.2.m1.2.2.2.cmml" xref="S3.E3X.3.2.2.m1.2.2.2"><times id="S3.E3X.3.2.2.m1.2.2.2.3.cmml" xref="S3.E3X.3.2.2.m1.2.2.2.3"></times><apply id="S3.E3X.3.2.2.m1.2.2.2.2.2.cmml" xref="S3.E3X.3.2.2.m1.2.2.2.2.1"><exp id="S3.E3X.3.2.2.m1.1.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.1.1.1.1"></exp><apply id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1"><times id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.1"></times><apply id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.2.1.cmml" xref="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.2">subscript</csymbol><apply id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.2.2.cmml" xref="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.2.2"><ci id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.2.2.1.cmml" xref="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.2.2.1">^</ci><ci id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.2.2.2.cmml" xref="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.2.2.2">𝑥</ci></apply><ci id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.2.3.cmml" xref="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.3.cmml" xref="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.3.1.cmml" xref="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.3">superscript</csymbol><apply id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.3.2.cmml" xref="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.3.2.1.cmml" xref="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.3.2.2.cmml" xref="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.3.2.2">𝑿</ci><ci id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.3.2.3.cmml" xref="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.3.2.3">𝐷</ci></apply><csymbol cd="latexml" id="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.3.3.cmml" xref="S3.E3X.3.2.2.m1.2.2.2.2.1.1.1.3.3">top</csymbol></apply></apply></apply><apply id="S3.E3X.3.2.2.m1.2.2.2.4.cmml" xref="S3.E3X.3.2.2.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.2.2.2.4.1.cmml" xref="S3.E3X.3.2.2.m1.2.2.2.4">subscript</csymbol><ci id="S3.E3X.3.2.2.m1.2.2.2.4.2.cmml" xref="S3.E3X.3.2.2.m1.2.2.2.4.2">𝑿</ci><ci id="S3.E3X.3.2.2.m1.2.2.2.4.3.cmml" xref="S3.E3X.3.2.2.m1.2.2.2.4.3">𝐷</ci></apply></apply><apply id="S3.E3X.3.2.2.m1.2.2.4.cmml" xref="S3.E3X.3.2.2.m1.2.2.4"><plus id="S3.E3X.3.2.2.m1.2.2.4.1.cmml" xref="S3.E3X.3.2.2.m1.2.2.4.1"></plus><apply id="S3.E3X.3.2.2.m1.2.2.4.2.cmml" xref="S3.E3X.3.2.2.m1.2.2.4.2"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.2.2.4.2.1.cmml" xref="S3.E3X.3.2.2.m1.2.2.4.2">subscript</csymbol><ci id="S3.E3X.3.2.2.m1.2.2.4.2.2.cmml" xref="S3.E3X.3.2.2.m1.2.2.4.2.2">𝑍</ci><cn type="integer" id="S3.E3X.3.2.2.m1.2.2.4.2.3.cmml" xref="S3.E3X.3.2.2.m1.2.2.4.2.3">1</cn></apply><apply id="S3.E3X.3.2.2.m1.2.2.4.3.cmml" xref="S3.E3X.3.2.2.m1.2.2.4.3"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.2.2.4.3.1.cmml" xref="S3.E3X.3.2.2.m1.2.2.4.3">subscript</csymbol><ci id="S3.E3X.3.2.2.m1.2.2.4.3.2.cmml" xref="S3.E3X.3.2.2.m1.2.2.4.3.2">𝑍</ci><cn type="integer" id="S3.E3X.3.2.2.m1.2.2.4.3.3.cmml" xref="S3.E3X.3.2.2.m1.2.2.4.3.3">2</cn></apply></apply></apply><apply id="S3.E3X.3.2.2.m1.4.4.cmml" xref="S3.E3X.3.2.2.m1.4.4"><divide id="S3.E3X.3.2.2.m1.4.4.3.cmml" xref="S3.E3X.3.2.2.m1.4.4"></divide><apply id="S3.E3X.3.2.2.m1.4.4.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.2"><times id="S3.E3X.3.2.2.m1.4.4.2.3.cmml" xref="S3.E3X.3.2.2.m1.4.4.2.3"></times><apply id="S3.E3X.3.2.2.m1.4.4.2.2.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.2.2.1"><exp id="S3.E3X.3.2.2.m1.3.3.1.1.cmml" xref="S3.E3X.3.2.2.m1.3.3.1.1"></exp><apply id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1"><times id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.1"></times><apply id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.2.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.2">subscript</csymbol><apply id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.2.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.2.2"><ci id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.2.2.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.2.2.1">^</ci><ci id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.2.2.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.2.2.2">𝑥</ci></apply><ci id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.2.3.cmml" xref="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.3.cmml" xref="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.3.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.3">superscript</csymbol><apply id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.3.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.3.2"><ci id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.3.2.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.3.2.1">^</ci><ci id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.3.2.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.3.2.2">𝒙</ci></apply><csymbol cd="latexml" id="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.3.3.cmml" xref="S3.E3X.3.2.2.m1.4.4.2.2.1.1.1.3.3">top</csymbol></apply></apply></apply><apply id="S3.E3X.3.2.2.m1.4.4.2.4.cmml" xref="S3.E3X.3.2.2.m1.4.4.2.4"><ci id="S3.E3X.3.2.2.m1.4.4.2.4.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.2.4.1">^</ci><ci id="S3.E3X.3.2.2.m1.4.4.2.4.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.2.4.2">𝒙</ci></apply></apply><apply id="S3.E3X.3.2.2.m1.4.4.4.cmml" xref="S3.E3X.3.2.2.m1.4.4.4"><plus id="S3.E3X.3.2.2.m1.4.4.4.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.4.1"></plus><apply id="S3.E3X.3.2.2.m1.4.4.4.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.4.2"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.4.4.4.2.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.4.2">subscript</csymbol><ci id="S3.E3X.3.2.2.m1.4.4.4.2.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.4.2.2">𝑍</ci><cn type="integer" id="S3.E3X.3.2.2.m1.4.4.4.2.3.cmml" xref="S3.E3X.3.2.2.m1.4.4.4.2.3">1</cn></apply><apply id="S3.E3X.3.2.2.m1.4.4.4.3.cmml" xref="S3.E3X.3.2.2.m1.4.4.4.3"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.4.4.4.3.1.cmml" xref="S3.E3X.3.2.2.m1.4.4.4.3">subscript</csymbol><ci id="S3.E3X.3.2.2.m1.4.4.4.3.2.cmml" xref="S3.E3X.3.2.2.m1.4.4.4.3.2">𝑍</ci><cn type="integer" id="S3.E3X.3.2.2.m1.4.4.4.3.3.cmml" xref="S3.E3X.3.2.2.m1.4.4.4.3.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3X.3.2.2.m1.4c">\displaystyle=\frac{\exp(\hat{x}_{i}\bm{X}_{D}^{\top})\bm{X}_{D}}{Z_{1}+Z_{2}}+\frac{\exp(\hat{x}_{i}\hat{\bm{x}}^{\top})\hat{\bm{x}}}{Z_{1}+Z_{2}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="4" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(3)</span></td>
</tr>
<tr id="S3.E3Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3Xa.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle=\frac{Z_{1}}{Z_{1}+Z_{2}}\frac{\exp(\hat{x}_{i}\bm{X}_{D}^{\top})\bm{X}_{D}}{Z1}+\frac{Z_{2}}{Z_{1}+Z_{2}}\frac{\exp(\hat{x}_{i}\hat{\bm{x}}^{\top})}{Z_{2}}" display="inline"><semantics id="S3.E3Xa.2.1.1.m1.4a"><mrow id="S3.E3Xa.2.1.1.m1.4.5" xref="S3.E3Xa.2.1.1.m1.4.5.cmml"><mi id="S3.E3Xa.2.1.1.m1.4.5.2" xref="S3.E3Xa.2.1.1.m1.4.5.2.cmml"></mi><mo id="S3.E3Xa.2.1.1.m1.4.5.1" xref="S3.E3Xa.2.1.1.m1.4.5.1.cmml">=</mo><mrow id="S3.E3Xa.2.1.1.m1.4.5.3" xref="S3.E3Xa.2.1.1.m1.4.5.3.cmml"><mrow id="S3.E3Xa.2.1.1.m1.4.5.3.2" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.cmml"><mstyle displaystyle="true" id="S3.E3Xa.2.1.1.m1.4.5.3.2.2" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2.cmml"><mfrac id="S3.E3Xa.2.1.1.m1.4.5.3.2.2a" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2.cmml"><msub id="S3.E3Xa.2.1.1.m1.4.5.3.2.2.2" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2.2.cmml"><mi id="S3.E3Xa.2.1.1.m1.4.5.3.2.2.2.2" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2.2.2.cmml">Z</mi><mn id="S3.E3Xa.2.1.1.m1.4.5.3.2.2.2.3" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2.2.3.cmml">1</mn></msub><mrow id="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.cmml"><msub id="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.2" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.2.cmml"><mi id="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.2.2" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.2.2.cmml">Z</mi><mn id="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.2.3" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.2.3.cmml">1</mn></msub><mo id="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.1" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.1.cmml">+</mo><msub id="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.3" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.3.cmml"><mi id="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.3.2" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.3.2.cmml">Z</mi><mn id="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.3.3" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.3.3.cmml">2</mn></msub></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.4.5.3.2.1" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.1.cmml">​</mo><mstyle displaystyle="true" id="S3.E3Xa.2.1.1.m1.2.2" xref="S3.E3Xa.2.1.1.m1.2.2.cmml"><mfrac id="S3.E3Xa.2.1.1.m1.2.2a" xref="S3.E3Xa.2.1.1.m1.2.2.cmml"><mrow id="S3.E3Xa.2.1.1.m1.2.2.2" xref="S3.E3Xa.2.1.1.m1.2.2.2.cmml"><mrow id="S3.E3Xa.2.1.1.m1.2.2.2.2.1" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.2.cmml"><mi id="S3.E3Xa.2.1.1.m1.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.cmml">exp</mi><mo id="S3.E3Xa.2.1.1.m1.2.2.2.2.1a" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.2.cmml">⁡</mo><mrow id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.2.cmml"><mo stretchy="false" id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.2" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.2.cmml">(</mo><mrow id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.cmml"><msub id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.2" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.2.cmml"><mover accent="true" id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.2.2" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.2.2.cmml"><mi id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.2.2.2" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.2.2.2.cmml">x</mi><mo id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.2.2.1" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.2.3" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.1.cmml">​</mo><msubsup id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.cmml"><mi id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2.2" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2.2.cmml">𝑿</mi><mi id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2.3" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2.3.cmml">D</mi><mo id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.3" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.3.cmml">⊤</mo></msubsup></mrow><mo stretchy="false" id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.3" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.2.2.2.3" xref="S3.E3Xa.2.1.1.m1.2.2.2.3.cmml">​</mo><msub id="S3.E3Xa.2.1.1.m1.2.2.2.4" xref="S3.E3Xa.2.1.1.m1.2.2.2.4.cmml"><mi id="S3.E3Xa.2.1.1.m1.2.2.2.4.2" xref="S3.E3Xa.2.1.1.m1.2.2.2.4.2.cmml">𝑿</mi><mi id="S3.E3Xa.2.1.1.m1.2.2.2.4.3" xref="S3.E3Xa.2.1.1.m1.2.2.2.4.3.cmml">D</mi></msub></mrow><mrow id="S3.E3Xa.2.1.1.m1.2.2.4" xref="S3.E3Xa.2.1.1.m1.2.2.4.cmml"><mi id="S3.E3Xa.2.1.1.m1.2.2.4.2" xref="S3.E3Xa.2.1.1.m1.2.2.4.2.cmml">Z</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.2.2.4.1" xref="S3.E3Xa.2.1.1.m1.2.2.4.1.cmml">​</mo><mn id="S3.E3Xa.2.1.1.m1.2.2.4.3" xref="S3.E3Xa.2.1.1.m1.2.2.4.3.cmml">1</mn></mrow></mfrac></mstyle></mrow><mo id="S3.E3Xa.2.1.1.m1.4.5.3.1" xref="S3.E3Xa.2.1.1.m1.4.5.3.1.cmml">+</mo><mrow id="S3.E3Xa.2.1.1.m1.4.5.3.3" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.cmml"><mstyle displaystyle="true" id="S3.E3Xa.2.1.1.m1.4.5.3.3.2" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2.cmml"><mfrac id="S3.E3Xa.2.1.1.m1.4.5.3.3.2a" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2.cmml"><msub id="S3.E3Xa.2.1.1.m1.4.5.3.3.2.2" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2.2.cmml"><mi id="S3.E3Xa.2.1.1.m1.4.5.3.3.2.2.2" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2.2.2.cmml">Z</mi><mn id="S3.E3Xa.2.1.1.m1.4.5.3.3.2.2.3" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2.2.3.cmml">2</mn></msub><mrow id="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.cmml"><msub id="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.2" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.2.cmml"><mi id="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.2.2" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.2.2.cmml">Z</mi><mn id="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.2.3" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.2.3.cmml">1</mn></msub><mo id="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.1" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.1.cmml">+</mo><msub id="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.3" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.3.cmml"><mi id="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.3.2" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.3.2.cmml">Z</mi><mn id="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.3.3" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.3.3.cmml">2</mn></msub></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.4.5.3.3.1" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.1.cmml">​</mo><mstyle displaystyle="true" id="S3.E3Xa.2.1.1.m1.4.4" xref="S3.E3Xa.2.1.1.m1.4.4.cmml"><mfrac id="S3.E3Xa.2.1.1.m1.4.4a" xref="S3.E3Xa.2.1.1.m1.4.4.cmml"><mrow id="S3.E3Xa.2.1.1.m1.4.4.2.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.3.cmml"><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.cmml">exp</mi><mo id="S3.E3Xa.2.1.1.m1.4.4.2.2a" xref="S3.E3Xa.2.1.1.m1.4.4.2.3.cmml">⁡</mo><mrow id="S3.E3Xa.2.1.1.m1.4.4.2.2.1" xref="S3.E3Xa.2.1.1.m1.4.4.2.3.cmml"><mo stretchy="false" id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.3.cmml">(</mo><mrow id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.cmml"><msub id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.2.cmml"><mover accent="true" id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.2.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.2.2.cmml"><mi id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.2.2.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.2.2.2.cmml">x</mi><mo id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.2.2.1" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.2.3" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.1" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.1.cmml">​</mo><msup id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.3" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.3.cmml"><mover accent="true" id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.3.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.3.2.cmml"><mi id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.3.2.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.3.2.2.cmml">𝒙</mi><mo id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.3.2.1" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.3.2.1.cmml">^</mo></mover><mo id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.3.3" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.3.3.cmml">⊤</mo></msup></mrow><mo stretchy="false" id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.3" xref="S3.E3Xa.2.1.1.m1.4.4.2.3.cmml">)</mo></mrow></mrow><msub id="S3.E3Xa.2.1.1.m1.4.4.4" xref="S3.E3Xa.2.1.1.m1.4.4.4.cmml"><mi id="S3.E3Xa.2.1.1.m1.4.4.4.2" xref="S3.E3Xa.2.1.1.m1.4.4.4.2.cmml">Z</mi><mn id="S3.E3Xa.2.1.1.m1.4.4.4.3" xref="S3.E3Xa.2.1.1.m1.4.4.4.3.cmml">2</mn></msub></mfrac></mstyle></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3Xa.2.1.1.m1.4b"><apply id="S3.E3Xa.2.1.1.m1.4.5.cmml" xref="S3.E3Xa.2.1.1.m1.4.5"><eq id="S3.E3Xa.2.1.1.m1.4.5.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.1"></eq><csymbol cd="latexml" id="S3.E3Xa.2.1.1.m1.4.5.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.2">absent</csymbol><apply id="S3.E3Xa.2.1.1.m1.4.5.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3"><plus id="S3.E3Xa.2.1.1.m1.4.5.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.1"></plus><apply id="S3.E3Xa.2.1.1.m1.4.5.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.2"><times id="S3.E3Xa.2.1.1.m1.4.5.3.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.1"></times><apply id="S3.E3Xa.2.1.1.m1.4.5.3.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2"><divide id="S3.E3Xa.2.1.1.m1.4.5.3.2.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2"></divide><apply id="S3.E3Xa.2.1.1.m1.4.5.3.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2.2"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.4.5.3.2.2.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2.2">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.4.5.3.2.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2.2.2">𝑍</ci><cn type="integer" id="S3.E3Xa.2.1.1.m1.4.5.3.2.2.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2.2.3">1</cn></apply><apply id="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3"><plus id="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.1"></plus><apply id="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.2"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.2">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.2.2">𝑍</ci><cn type="integer" id="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.2.3">1</cn></apply><apply id="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.3"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.3">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.3.2">𝑍</ci><cn type="integer" id="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.2.2.3.3.3">2</cn></apply></apply></apply><apply id="S3.E3Xa.2.1.1.m1.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2"><divide id="S3.E3Xa.2.1.1.m1.2.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.2.2"></divide><apply id="S3.E3Xa.2.1.1.m1.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.2"><times id="S3.E3Xa.2.1.1.m1.2.2.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.2.3"></times><apply id="S3.E3Xa.2.1.1.m1.2.2.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.1"><exp id="S3.E3Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1"></exp><apply id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1"><times id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.1"></times><apply id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.2">subscript</csymbol><apply id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.2.2"><ci id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.2.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.2.2.1">^</ci><ci id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.2.2.2">𝑥</ci></apply><ci id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3">superscript</csymbol><apply id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2.2">𝑿</ci><ci id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2.3">𝐷</ci></apply><csymbol cd="latexml" id="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.3">top</csymbol></apply></apply></apply><apply id="S3.E3Xa.2.1.1.m1.2.2.2.4.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.2.2.2.4.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.2.4">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.2.2.2.4.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.2.4.2">𝑿</ci><ci id="S3.E3Xa.2.1.1.m1.2.2.2.4.3.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.2.4.3">𝐷</ci></apply></apply><apply id="S3.E3Xa.2.1.1.m1.2.2.4.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.4"><times id="S3.E3Xa.2.1.1.m1.2.2.4.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.4.1"></times><ci id="S3.E3Xa.2.1.1.m1.2.2.4.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.4.2">𝑍</ci><cn type="integer" id="S3.E3Xa.2.1.1.m1.2.2.4.3.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.4.3">1</cn></apply></apply></apply><apply id="S3.E3Xa.2.1.1.m1.4.5.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.3"><times id="S3.E3Xa.2.1.1.m1.4.5.3.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.1"></times><apply id="S3.E3Xa.2.1.1.m1.4.5.3.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2"><divide id="S3.E3Xa.2.1.1.m1.4.5.3.3.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2"></divide><apply id="S3.E3Xa.2.1.1.m1.4.5.3.3.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2.2"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.4.5.3.3.2.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2.2">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.4.5.3.3.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2.2.2">𝑍</ci><cn type="integer" id="S3.E3Xa.2.1.1.m1.4.5.3.3.2.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2.2.3">2</cn></apply><apply id="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3"><plus id="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.1"></plus><apply id="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.2"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.2">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.2.2">𝑍</ci><cn type="integer" id="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.2.3">1</cn></apply><apply id="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.3"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.3">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.3.2">𝑍</ci><cn type="integer" id="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.5.3.3.2.3.3.3">2</cn></apply></apply></apply><apply id="S3.E3Xa.2.1.1.m1.4.4.cmml" xref="S3.E3Xa.2.1.1.m1.4.4"><divide id="S3.E3Xa.2.1.1.m1.4.4.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.4"></divide><apply id="S3.E3Xa.2.1.1.m1.4.4.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2"><exp id="S3.E3Xa.2.1.1.m1.3.3.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1"></exp><apply id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1"><times id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.1"></times><apply id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.2">subscript</csymbol><apply id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.2.2"><ci id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.2.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.2.2.1">^</ci><ci id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.2.2.2">𝑥</ci></apply><ci id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.2.3">𝑖</ci></apply><apply id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.3">superscript</csymbol><apply id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.3.2"><ci id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.3.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.3.2.1">^</ci><ci id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.3.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.3.2.2">𝒙</ci></apply><csymbol cd="latexml" id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.1.1.3.3">top</csymbol></apply></apply></apply><apply id="S3.E3Xa.2.1.1.m1.4.4.4.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.4"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.4.4.4.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.4">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.4.4.4.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.4.2">𝑍</ci><cn type="integer" id="S3.E3Xa.2.1.1.m1.4.4.4.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.4.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xa.2.1.1.m1.4c">\displaystyle=\frac{Z_{1}}{Z_{1}+Z_{2}}\frac{\exp(\hat{x}_{i}\bm{X}_{D}^{\top})\bm{X}_{D}}{Z1}+\frac{Z_{2}}{Z_{1}+Z_{2}}\frac{\exp(\hat{x}_{i}\hat{\bm{x}}^{\top})}{Z_{2}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E3Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3Xb.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle=\frac{Z_{1}}{Z_{1}+Z_{2}}\operatorname{softmax}(\hat{x}_{i}\bm{X}_{D}^{\top})\bm{X}_{D}+\frac{Z_{2}}{Z_{1}+Z_{2}}\operatorname{softmax}(\hat{x}_{i}\hat{\bm{x}}^{\top})\hat{\bm{x}}" display="inline"><semantics id="S3.E3Xb.2.1.1.m1.4a"><mrow id="S3.E3Xb.2.1.1.m1.4.4" xref="S3.E3Xb.2.1.1.m1.4.4.cmml"><mi id="S3.E3Xb.2.1.1.m1.4.4.4" xref="S3.E3Xb.2.1.1.m1.4.4.4.cmml"></mi><mo id="S3.E3Xb.2.1.1.m1.4.4.3" xref="S3.E3Xb.2.1.1.m1.4.4.3.cmml">=</mo><mrow id="S3.E3Xb.2.1.1.m1.4.4.2" xref="S3.E3Xb.2.1.1.m1.4.4.2.cmml"><mrow id="S3.E3Xb.2.1.1.m1.3.3.1.1" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.cmml"><mstyle displaystyle="true" id="S3.E3Xb.2.1.1.m1.3.3.1.1.3" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3.cmml"><mfrac id="S3.E3Xb.2.1.1.m1.3.3.1.1.3a" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3.cmml"><msub id="S3.E3Xb.2.1.1.m1.3.3.1.1.3.2" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3.2.cmml"><mi id="S3.E3Xb.2.1.1.m1.3.3.1.1.3.2.2" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3.2.2.cmml">Z</mi><mn id="S3.E3Xb.2.1.1.m1.3.3.1.1.3.2.3" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3.2.3.cmml">1</mn></msub><mrow id="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.cmml"><msub id="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.2" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.2.cmml"><mi id="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.2.2" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.2.2.cmml">Z</mi><mn id="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.2.3" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.2.3.cmml">1</mn></msub><mo id="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.1" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.1.cmml">+</mo><msub id="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.3" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.3.cmml"><mi id="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.3.2" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.3.2.cmml">Z</mi><mn id="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.3.3" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.3.3.cmml">2</mn></msub></mrow></mfrac></mstyle><mo lspace="0.167em" rspace="0em" id="S3.E3Xb.2.1.1.m1.3.3.1.1.2" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.2.cmml">​</mo><mrow id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.2.cmml"><mi id="S3.E3Xb.2.1.1.m1.1.1" xref="S3.E3Xb.2.1.1.m1.1.1.cmml">softmax</mi><mo id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1a" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.2.cmml">⁡</mo><mrow id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.2" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.2.cmml">(</mo><mrow id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.cmml"><msub id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.2" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.2.2.2" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.2.2.2.cmml">x</mi><mo id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.2.2.1" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.2.3" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.1" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml">​</mo><msubsup id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.3" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.3.2.2" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.3.2.2.cmml">𝑿</mi><mi id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.3.2.3" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.3.2.3.cmml">D</mi><mo id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.3.3" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.3.3.cmml">⊤</mo></msubsup></mrow><mo stretchy="false" id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.3" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E3Xb.2.1.1.m1.3.3.1.1.2a" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.2.cmml">​</mo><msub id="S3.E3Xb.2.1.1.m1.3.3.1.1.4" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.4.cmml"><mi id="S3.E3Xb.2.1.1.m1.3.3.1.1.4.2" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.4.2.cmml">𝑿</mi><mi id="S3.E3Xb.2.1.1.m1.3.3.1.1.4.3" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.4.3.cmml">D</mi></msub></mrow><mo id="S3.E3Xb.2.1.1.m1.4.4.2.3" xref="S3.E3Xb.2.1.1.m1.4.4.2.3.cmml">+</mo><mrow id="S3.E3Xb.2.1.1.m1.4.4.2.2" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.cmml"><mstyle displaystyle="true" id="S3.E3Xb.2.1.1.m1.4.4.2.2.3" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3.cmml"><mfrac id="S3.E3Xb.2.1.1.m1.4.4.2.2.3a" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3.cmml"><msub id="S3.E3Xb.2.1.1.m1.4.4.2.2.3.2" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3.2.cmml"><mi id="S3.E3Xb.2.1.1.m1.4.4.2.2.3.2.2" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3.2.2.cmml">Z</mi><mn id="S3.E3Xb.2.1.1.m1.4.4.2.2.3.2.3" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3.2.3.cmml">2</mn></msub><mrow id="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.cmml"><msub id="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.2" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.2.cmml"><mi id="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.2.2" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.2.2.cmml">Z</mi><mn id="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.2.3" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.2.3.cmml">1</mn></msub><mo id="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.1" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.1.cmml">+</mo><msub id="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.3" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.3.cmml"><mi id="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.3.2" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.3.2.cmml">Z</mi><mn id="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.3.3" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.3.3.cmml">2</mn></msub></mrow></mfrac></mstyle><mo lspace="0.167em" rspace="0em" id="S3.E3Xb.2.1.1.m1.4.4.2.2.2" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.2.cmml">​</mo><mrow id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.2.cmml"><mi id="S3.E3Xb.2.1.1.m1.2.2" xref="S3.E3Xb.2.1.1.m1.2.2.cmml">softmax</mi><mo id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1a" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.2.cmml">⁡</mo><mrow id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.2.cmml"><mo stretchy="false" id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.2" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.2.cmml">(</mo><mrow id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.cmml"><msub id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.2" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.2.cmml"><mover accent="true" id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.2.2" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.2.2.cmml"><mi id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.2.2.2" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.2.2.2.cmml">x</mi><mo id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.2.2.1" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.2.3" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.1" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.1.cmml">​</mo><msup id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.3" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.3.cmml"><mover accent="true" id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.3.2" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.3.2.cmml"><mi id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.3.2.2" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.3.2.2.cmml">𝒙</mi><mo id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.3.2.1" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.3.2.1.cmml">^</mo></mover><mo id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.3.3" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.3.3.cmml">⊤</mo></msup></mrow><mo stretchy="false" id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.3" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.2.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E3Xb.2.1.1.m1.4.4.2.2.2a" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.2.cmml">​</mo><mover accent="true" id="S3.E3Xb.2.1.1.m1.4.4.2.2.4" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.4.cmml"><mi id="S3.E3Xb.2.1.1.m1.4.4.2.2.4.2" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.4.2.cmml">𝒙</mi><mo id="S3.E3Xb.2.1.1.m1.4.4.2.2.4.1" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.4.1.cmml">^</mo></mover></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3Xb.2.1.1.m1.4b"><apply id="S3.E3Xb.2.1.1.m1.4.4.cmml" xref="S3.E3Xb.2.1.1.m1.4.4"><eq id="S3.E3Xb.2.1.1.m1.4.4.3.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.3"></eq><csymbol cd="latexml" id="S3.E3Xb.2.1.1.m1.4.4.4.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.4">absent</csymbol><apply id="S3.E3Xb.2.1.1.m1.4.4.2.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2"><plus id="S3.E3Xb.2.1.1.m1.4.4.2.3.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.3"></plus><apply id="S3.E3Xb.2.1.1.m1.3.3.1.1.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1"><times id="S3.E3Xb.2.1.1.m1.3.3.1.1.2.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.2"></times><apply id="S3.E3Xb.2.1.1.m1.3.3.1.1.3.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3"><divide id="S3.E3Xb.2.1.1.m1.3.3.1.1.3.1.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3"></divide><apply id="S3.E3Xb.2.1.1.m1.3.3.1.1.3.2.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3Xb.2.1.1.m1.3.3.1.1.3.2.1.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3.2">subscript</csymbol><ci id="S3.E3Xb.2.1.1.m1.3.3.1.1.3.2.2.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3.2.2">𝑍</ci><cn type="integer" id="S3.E3Xb.2.1.1.m1.3.3.1.1.3.2.3.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3.2.3">1</cn></apply><apply id="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3"><plus id="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.1.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.1"></plus><apply id="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.2.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.2.1.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.2">subscript</csymbol><ci id="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.2.2.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.2.2">𝑍</ci><cn type="integer" id="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.2.3.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.2.3">1</cn></apply><apply id="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.3.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.3.1.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.3">subscript</csymbol><ci id="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.3.2.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.3.2">𝑍</ci><cn type="integer" id="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.3.3.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.3.3.3.3">2</cn></apply></apply></apply><apply id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.2.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1"><ci id="S3.E3Xb.2.1.1.m1.1.1.cmml" xref="S3.E3Xb.2.1.1.m1.1.1">softmax</ci><apply id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1"><times id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.1"></times><apply id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.2.2"><ci id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.2.2.2">𝑥</ci></apply><ci id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.3.2.2">𝑿</ci><ci id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.3.2.3">𝐷</ci></apply><csymbol cd="latexml" id="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.1.1.1.1.3.3">top</csymbol></apply></apply></apply><apply id="S3.E3Xb.2.1.1.m1.3.3.1.1.4.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="S3.E3Xb.2.1.1.m1.3.3.1.1.4.1.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.4">subscript</csymbol><ci id="S3.E3Xb.2.1.1.m1.3.3.1.1.4.2.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.4.2">𝑿</ci><ci id="S3.E3Xb.2.1.1.m1.3.3.1.1.4.3.cmml" xref="S3.E3Xb.2.1.1.m1.3.3.1.1.4.3">𝐷</ci></apply></apply><apply id="S3.E3Xb.2.1.1.m1.4.4.2.2.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2"><times id="S3.E3Xb.2.1.1.m1.4.4.2.2.2.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.2"></times><apply id="S3.E3Xb.2.1.1.m1.4.4.2.2.3.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3"><divide id="S3.E3Xb.2.1.1.m1.4.4.2.2.3.1.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3"></divide><apply id="S3.E3Xb.2.1.1.m1.4.4.2.2.3.2.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3.2"><csymbol cd="ambiguous" id="S3.E3Xb.2.1.1.m1.4.4.2.2.3.2.1.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3.2">subscript</csymbol><ci id="S3.E3Xb.2.1.1.m1.4.4.2.2.3.2.2.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3.2.2">𝑍</ci><cn type="integer" id="S3.E3Xb.2.1.1.m1.4.4.2.2.3.2.3.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3.2.3">2</cn></apply><apply id="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3"><plus id="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.1.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.1"></plus><apply id="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.2.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.2"><csymbol cd="ambiguous" id="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.2.1.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.2">subscript</csymbol><ci id="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.2.2.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.2.2">𝑍</ci><cn type="integer" id="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.2.3.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.2.3">1</cn></apply><apply id="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.3.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.3"><csymbol cd="ambiguous" id="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.3.1.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.3">subscript</csymbol><ci id="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.3.2.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.3.2">𝑍</ci><cn type="integer" id="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.3.3.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.3.3.3.3">2</cn></apply></apply></apply><apply id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.2.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1"><ci id="S3.E3Xb.2.1.1.m1.2.2.cmml" xref="S3.E3Xb.2.1.1.m1.2.2">softmax</ci><apply id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1"><times id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.1.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.1"></times><apply id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.2.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.2.1.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.2">subscript</csymbol><apply id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.2.2.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.2.2"><ci id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.2.2.1.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.2.2.1">^</ci><ci id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.2.2.2.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.2.2.2">𝑥</ci></apply><ci id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.2.3.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.3.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.3.1.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.3">superscript</csymbol><apply id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.3.2.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.3.2"><ci id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.3.2.1.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.3.2.1">^</ci><ci id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.3.2.2.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.3.2.2">𝒙</ci></apply><csymbol cd="latexml" id="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.3.3.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.1.1.1.1.3.3">top</csymbol></apply></apply></apply><apply id="S3.E3Xb.2.1.1.m1.4.4.2.2.4.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.4"><ci id="S3.E3Xb.2.1.1.m1.4.4.2.2.4.1.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.4.1">^</ci><ci id="S3.E3Xb.2.1.1.m1.4.4.2.2.4.2.cmml" xref="S3.E3Xb.2.1.1.m1.4.4.2.2.4.2">𝒙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xb.2.1.1.m1.4c">\displaystyle=\frac{Z_{1}}{Z_{1}+Z_{2}}\operatorname{softmax}(\hat{x}_{i}\bm{X}_{D}^{\top})\bm{X}_{D}+\frac{Z_{2}}{Z_{1}+Z_{2}}\operatorname{softmax}(\hat{x}_{i}\hat{\bm{x}}^{\top})\hat{\bm{x}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E3Xc" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3Xc.2.1.1.m1.5" class="ltx_Math" alttext="\displaystyle=\mu\operatorname{SA}(\hat{x}_{i},\bm{X}_{D},\bm{X}_{D})+(1-\mu)\operatorname{SA}(\hat{x}_{i},\hat{\bm{x}},\hat{\bm{x}})," display="inline"><semantics id="S3.E3Xc.2.1.1.m1.5a"><mrow id="S3.E3Xc.2.1.1.m1.5.5.1" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.cmml"><mrow id="S3.E3Xc.2.1.1.m1.5.5.1.1" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.cmml"><mi id="S3.E3Xc.2.1.1.m1.5.5.1.1.7" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.7.cmml"></mi><mo id="S3.E3Xc.2.1.1.m1.5.5.1.1.6" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.6.cmml">=</mo><mrow id="S3.E3Xc.2.1.1.m1.5.5.1.1.5" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.5.cmml"><mrow id="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.cmml"><mi id="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.5" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.5.cmml">μ</mi><mo lspace="0.167em" rspace="0em" id="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.4" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.4.cmml">​</mo><mrow id="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.3" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.4.cmml"><mi id="S3.E3Xc.2.1.1.m1.1.1" xref="S3.E3Xc.2.1.1.m1.1.1.cmml">SA</mi><mo id="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.3a" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.4.cmml">⁡</mo><mrow id="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.3.3" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.4.cmml"><mo stretchy="false" id="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.3.3.4" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.4.cmml">(</mo><msub id="S3.E3Xc.2.1.1.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E3Xc.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E3Xc.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.2" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mo id="S3.E3Xc.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E3Xc.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.3.3.5" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.4.cmml">,</mo><msub id="S3.E3Xc.2.1.1.m1.5.5.1.1.2.2.2.2.2.2" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.2.2.2.2.2.2.cmml"><mi id="S3.E3Xc.2.1.1.m1.5.5.1.1.2.2.2.2.2.2.2" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.2.2.2.2.2.2.2.cmml">𝑿</mi><mi id="S3.E3Xc.2.1.1.m1.5.5.1.1.2.2.2.2.2.2.3" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.2.2.2.2.2.2.3.cmml">D</mi></msub><mo id="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.3.3.6" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.4.cmml">,</mo><msub id="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.3.3.3" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.3.3.3.cmml"><mi id="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.3.3.3.2" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.3.3.3.2.cmml">𝑿</mi><mi id="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.3.3.3.3" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.3.3.3.3.cmml">D</mi></msub><mo stretchy="false" id="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.3.3.7" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3Xc.2.1.1.m1.5.5.1.1.5.6" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.5.6.cmml">+</mo><mrow id="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.cmml"><mrow id="S3.E3Xc.2.1.1.m1.5.5.1.1.4.4.1.1" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.4.4.1.1.1.cmml"><mo stretchy="false" id="S3.E3Xc.2.1.1.m1.5.5.1.1.4.4.1.1.2" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.4.4.1.1.1.cmml">(</mo><mrow id="S3.E3Xc.2.1.1.m1.5.5.1.1.4.4.1.1.1" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.4.4.1.1.1.cmml"><mn id="S3.E3Xc.2.1.1.m1.5.5.1.1.4.4.1.1.1.2" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.4.4.1.1.1.2.cmml">1</mn><mo id="S3.E3Xc.2.1.1.m1.5.5.1.1.4.4.1.1.1.1" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.4.4.1.1.1.1.cmml">−</mo><mi id="S3.E3Xc.2.1.1.m1.5.5.1.1.4.4.1.1.1.3" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.4.4.1.1.1.3.cmml">μ</mi></mrow><mo stretchy="false" id="S3.E3Xc.2.1.1.m1.5.5.1.1.4.4.1.1.3" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.4.4.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.3" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.3.cmml">​</mo><mrow id="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.2.cmml"><mi id="S3.E3Xc.2.1.1.m1.2.2" xref="S3.E3Xc.2.1.1.m1.2.2.cmml">SA</mi><mo id="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1a" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.2.cmml">⁡</mo><mrow id="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1.1" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.2.cmml"><mo stretchy="false" id="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1.1.2" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.2.cmml">(</mo><msub id="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1.1.1" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1.1.1.cmml"><mover accent="true" id="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1.1.1.2" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1.1.1.2.cmml"><mi id="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1.1.1.2.2" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1.1.1.2.2.cmml">x</mi><mo id="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1.1.1.2.1" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1.1.1.3" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1.1.1.3.cmml">i</mi></msub><mo id="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1.1.3" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.2.cmml">,</mo><mover accent="true" id="S3.E3Xc.2.1.1.m1.3.3" xref="S3.E3Xc.2.1.1.m1.3.3.cmml"><mi id="S3.E3Xc.2.1.1.m1.3.3.2" xref="S3.E3Xc.2.1.1.m1.3.3.2.cmml">𝒙</mi><mo id="S3.E3Xc.2.1.1.m1.3.3.1" xref="S3.E3Xc.2.1.1.m1.3.3.1.cmml">^</mo></mover><mo id="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1.1.4" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.2.cmml">,</mo><mover accent="true" id="S3.E3Xc.2.1.1.m1.4.4" xref="S3.E3Xc.2.1.1.m1.4.4.cmml"><mi id="S3.E3Xc.2.1.1.m1.4.4.2" xref="S3.E3Xc.2.1.1.m1.4.4.2.cmml">𝒙</mi><mo id="S3.E3Xc.2.1.1.m1.4.4.1" xref="S3.E3Xc.2.1.1.m1.4.4.1.cmml">^</mo></mover><mo stretchy="false" id="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1.1.5" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E3Xc.2.1.1.m1.5.5.1.2" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3Xc.2.1.1.m1.5b"><apply id="S3.E3Xc.2.1.1.m1.5.5.1.1.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1"><eq id="S3.E3Xc.2.1.1.m1.5.5.1.1.6.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.6"></eq><csymbol cd="latexml" id="S3.E3Xc.2.1.1.m1.5.5.1.1.7.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.7">absent</csymbol><apply id="S3.E3Xc.2.1.1.m1.5.5.1.1.5.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.5"><plus id="S3.E3Xc.2.1.1.m1.5.5.1.1.5.6.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.5.6"></plus><apply id="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3"><times id="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.4.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.4"></times><ci id="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.5.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.5">𝜇</ci><apply id="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.4.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.3"><ci id="S3.E3Xc.2.1.1.m1.1.1.cmml" xref="S3.E3Xc.2.1.1.m1.1.1">SA</ci><apply id="S3.E3Xc.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3Xc.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E3Xc.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2"><ci id="S3.E3Xc.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E3Xc.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.2">𝑥</ci></apply><ci id="S3.E3Xc.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E3Xc.2.1.1.m1.5.5.1.1.2.2.2.2.2.2.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3Xc.2.1.1.m1.5.5.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E3Xc.2.1.1.m1.5.5.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.2.2.2.2.2.2.2">𝑿</ci><ci id="S3.E3Xc.2.1.1.m1.5.5.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.2.2.2.2.2.2.3">𝐷</ci></apply><apply id="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.3.3.3.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.3.3.3.1.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.3.3.3">subscript</csymbol><ci id="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.3.3.3.2.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.3.3.3.2">𝑿</ci><ci id="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.3.3.3.3.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.3.3.3.3.3.3.3">𝐷</ci></apply></apply></apply><apply id="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5"><times id="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.3.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.3"></times><apply id="S3.E3Xc.2.1.1.m1.5.5.1.1.4.4.1.1.1.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.4.4.1.1"><minus id="S3.E3Xc.2.1.1.m1.5.5.1.1.4.4.1.1.1.1.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.4.4.1.1.1.1"></minus><cn type="integer" id="S3.E3Xc.2.1.1.m1.5.5.1.1.4.4.1.1.1.2.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.4.4.1.1.1.2">1</cn><ci id="S3.E3Xc.2.1.1.m1.5.5.1.1.4.4.1.1.1.3.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.4.4.1.1.1.3">𝜇</ci></apply><apply id="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.2.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1"><ci id="S3.E3Xc.2.1.1.m1.2.2.cmml" xref="S3.E3Xc.2.1.1.m1.2.2">SA</ci><apply id="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1.1.1.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1.1.1"><csymbol cd="ambiguous" id="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1.1.1.1.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1.1.1">subscript</csymbol><apply id="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1.1.1.2.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1.1.1.2"><ci id="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1.1.1.2.1.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1.1.1.2.1">^</ci><ci id="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1.1.1.2.2.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1.1.1.2.2">𝑥</ci></apply><ci id="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1.1.1.3.cmml" xref="S3.E3Xc.2.1.1.m1.5.5.1.1.5.5.2.1.1.1.3">𝑖</ci></apply><apply id="S3.E3Xc.2.1.1.m1.3.3.cmml" xref="S3.E3Xc.2.1.1.m1.3.3"><ci id="S3.E3Xc.2.1.1.m1.3.3.1.cmml" xref="S3.E3Xc.2.1.1.m1.3.3.1">^</ci><ci id="S3.E3Xc.2.1.1.m1.3.3.2.cmml" xref="S3.E3Xc.2.1.1.m1.3.3.2">𝒙</ci></apply><apply id="S3.E3Xc.2.1.1.m1.4.4.cmml" xref="S3.E3Xc.2.1.1.m1.4.4"><ci id="S3.E3Xc.2.1.1.m1.4.4.1.cmml" xref="S3.E3Xc.2.1.1.m1.4.4.1">^</ci><ci id="S3.E3Xc.2.1.1.m1.4.4.2.cmml" xref="S3.E3Xc.2.1.1.m1.4.4.2">𝒙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xc.2.1.1.m1.5c">\displaystyle=\mu\operatorname{SA}(\hat{x}_{i},\bm{X}_{D},\bm{X}_{D})+(1-\mu)\operatorname{SA}(\hat{x}_{i},\hat{\bm{x}},\hat{\bm{x}}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.p1.25" class="ltx_p">where <math id="S3.p1.23.m1.1" class="ltx_Math" alttext="\mu=Z_{1}/(Z_{1}+Z_{2})" display="inline"><semantics id="S3.p1.23.m1.1a"><mrow id="S3.p1.23.m1.1.1" xref="S3.p1.23.m1.1.1.cmml"><mi id="S3.p1.23.m1.1.1.3" xref="S3.p1.23.m1.1.1.3.cmml">μ</mi><mo id="S3.p1.23.m1.1.1.2" xref="S3.p1.23.m1.1.1.2.cmml">=</mo><mrow id="S3.p1.23.m1.1.1.1" xref="S3.p1.23.m1.1.1.1.cmml"><msub id="S3.p1.23.m1.1.1.1.3" xref="S3.p1.23.m1.1.1.1.3.cmml"><mi id="S3.p1.23.m1.1.1.1.3.2" xref="S3.p1.23.m1.1.1.1.3.2.cmml">Z</mi><mn id="S3.p1.23.m1.1.1.1.3.3" xref="S3.p1.23.m1.1.1.1.3.3.cmml">1</mn></msub><mo id="S3.p1.23.m1.1.1.1.2" xref="S3.p1.23.m1.1.1.1.2.cmml">/</mo><mrow id="S3.p1.23.m1.1.1.1.1.1" xref="S3.p1.23.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p1.23.m1.1.1.1.1.1.2" xref="S3.p1.23.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.p1.23.m1.1.1.1.1.1.1" xref="S3.p1.23.m1.1.1.1.1.1.1.cmml"><msub id="S3.p1.23.m1.1.1.1.1.1.1.2" xref="S3.p1.23.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.p1.23.m1.1.1.1.1.1.1.2.2" xref="S3.p1.23.m1.1.1.1.1.1.1.2.2.cmml">Z</mi><mn id="S3.p1.23.m1.1.1.1.1.1.1.2.3" xref="S3.p1.23.m1.1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S3.p1.23.m1.1.1.1.1.1.1.1" xref="S3.p1.23.m1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.p1.23.m1.1.1.1.1.1.1.3" xref="S3.p1.23.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.p1.23.m1.1.1.1.1.1.1.3.2" xref="S3.p1.23.m1.1.1.1.1.1.1.3.2.cmml">Z</mi><mn id="S3.p1.23.m1.1.1.1.1.1.1.3.3" xref="S3.p1.23.m1.1.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo stretchy="false" id="S3.p1.23.m1.1.1.1.1.1.3" xref="S3.p1.23.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.23.m1.1b"><apply id="S3.p1.23.m1.1.1.cmml" xref="S3.p1.23.m1.1.1"><eq id="S3.p1.23.m1.1.1.2.cmml" xref="S3.p1.23.m1.1.1.2"></eq><ci id="S3.p1.23.m1.1.1.3.cmml" xref="S3.p1.23.m1.1.1.3">𝜇</ci><apply id="S3.p1.23.m1.1.1.1.cmml" xref="S3.p1.23.m1.1.1.1"><divide id="S3.p1.23.m1.1.1.1.2.cmml" xref="S3.p1.23.m1.1.1.1.2"></divide><apply id="S3.p1.23.m1.1.1.1.3.cmml" xref="S3.p1.23.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.23.m1.1.1.1.3.1.cmml" xref="S3.p1.23.m1.1.1.1.3">subscript</csymbol><ci id="S3.p1.23.m1.1.1.1.3.2.cmml" xref="S3.p1.23.m1.1.1.1.3.2">𝑍</ci><cn type="integer" id="S3.p1.23.m1.1.1.1.3.3.cmml" xref="S3.p1.23.m1.1.1.1.3.3">1</cn></apply><apply id="S3.p1.23.m1.1.1.1.1.1.1.cmml" xref="S3.p1.23.m1.1.1.1.1.1"><plus id="S3.p1.23.m1.1.1.1.1.1.1.1.cmml" xref="S3.p1.23.m1.1.1.1.1.1.1.1"></plus><apply id="S3.p1.23.m1.1.1.1.1.1.1.2.cmml" xref="S3.p1.23.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.23.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.p1.23.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.p1.23.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.p1.23.m1.1.1.1.1.1.1.2.2">𝑍</ci><cn type="integer" id="S3.p1.23.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.p1.23.m1.1.1.1.1.1.1.2.3">1</cn></apply><apply id="S3.p1.23.m1.1.1.1.1.1.1.3.cmml" xref="S3.p1.23.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.23.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.p1.23.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.p1.23.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.p1.23.m1.1.1.1.1.1.1.3.2">𝑍</ci><cn type="integer" id="S3.p1.23.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.p1.23.m1.1.1.1.1.1.1.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.23.m1.1c">\mu=Z_{1}/(Z_{1}+Z_{2})</annotation></semantics></math>.
Let <math id="S3.p1.24.m2.5" class="ltx_Math" alttext="h(z)=\operatorname{SA}(\hat{x}_{i},z,z)" display="inline"><semantics id="S3.p1.24.m2.5a"><mrow id="S3.p1.24.m2.5.5" xref="S3.p1.24.m2.5.5.cmml"><mrow id="S3.p1.24.m2.5.5.3" xref="S3.p1.24.m2.5.5.3.cmml"><mi id="S3.p1.24.m2.5.5.3.2" xref="S3.p1.24.m2.5.5.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.p1.24.m2.5.5.3.1" xref="S3.p1.24.m2.5.5.3.1.cmml">​</mo><mrow id="S3.p1.24.m2.5.5.3.3.2" xref="S3.p1.24.m2.5.5.3.cmml"><mo stretchy="false" id="S3.p1.24.m2.5.5.3.3.2.1" xref="S3.p1.24.m2.5.5.3.cmml">(</mo><mi id="S3.p1.24.m2.1.1" xref="S3.p1.24.m2.1.1.cmml">z</mi><mo stretchy="false" id="S3.p1.24.m2.5.5.3.3.2.2" xref="S3.p1.24.m2.5.5.3.cmml">)</mo></mrow></mrow><mo id="S3.p1.24.m2.5.5.2" xref="S3.p1.24.m2.5.5.2.cmml">=</mo><mrow id="S3.p1.24.m2.5.5.1.1" xref="S3.p1.24.m2.5.5.1.2.cmml"><mi id="S3.p1.24.m2.2.2" xref="S3.p1.24.m2.2.2.cmml">SA</mi><mo id="S3.p1.24.m2.5.5.1.1a" xref="S3.p1.24.m2.5.5.1.2.cmml">⁡</mo><mrow id="S3.p1.24.m2.5.5.1.1.1" xref="S3.p1.24.m2.5.5.1.2.cmml"><mo stretchy="false" id="S3.p1.24.m2.5.5.1.1.1.2" xref="S3.p1.24.m2.5.5.1.2.cmml">(</mo><msub id="S3.p1.24.m2.5.5.1.1.1.1" xref="S3.p1.24.m2.5.5.1.1.1.1.cmml"><mover accent="true" id="S3.p1.24.m2.5.5.1.1.1.1.2" xref="S3.p1.24.m2.5.5.1.1.1.1.2.cmml"><mi id="S3.p1.24.m2.5.5.1.1.1.1.2.2" xref="S3.p1.24.m2.5.5.1.1.1.1.2.2.cmml">x</mi><mo id="S3.p1.24.m2.5.5.1.1.1.1.2.1" xref="S3.p1.24.m2.5.5.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.p1.24.m2.5.5.1.1.1.1.3" xref="S3.p1.24.m2.5.5.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.p1.24.m2.5.5.1.1.1.3" xref="S3.p1.24.m2.5.5.1.2.cmml">,</mo><mi id="S3.p1.24.m2.3.3" xref="S3.p1.24.m2.3.3.cmml">z</mi><mo id="S3.p1.24.m2.5.5.1.1.1.4" xref="S3.p1.24.m2.5.5.1.2.cmml">,</mo><mi id="S3.p1.24.m2.4.4" xref="S3.p1.24.m2.4.4.cmml">z</mi><mo stretchy="false" id="S3.p1.24.m2.5.5.1.1.1.5" xref="S3.p1.24.m2.5.5.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.24.m2.5b"><apply id="S3.p1.24.m2.5.5.cmml" xref="S3.p1.24.m2.5.5"><eq id="S3.p1.24.m2.5.5.2.cmml" xref="S3.p1.24.m2.5.5.2"></eq><apply id="S3.p1.24.m2.5.5.3.cmml" xref="S3.p1.24.m2.5.5.3"><times id="S3.p1.24.m2.5.5.3.1.cmml" xref="S3.p1.24.m2.5.5.3.1"></times><ci id="S3.p1.24.m2.5.5.3.2.cmml" xref="S3.p1.24.m2.5.5.3.2">ℎ</ci><ci id="S3.p1.24.m2.1.1.cmml" xref="S3.p1.24.m2.1.1">𝑧</ci></apply><apply id="S3.p1.24.m2.5.5.1.2.cmml" xref="S3.p1.24.m2.5.5.1.1"><ci id="S3.p1.24.m2.2.2.cmml" xref="S3.p1.24.m2.2.2">SA</ci><apply id="S3.p1.24.m2.5.5.1.1.1.1.cmml" xref="S3.p1.24.m2.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.24.m2.5.5.1.1.1.1.1.cmml" xref="S3.p1.24.m2.5.5.1.1.1.1">subscript</csymbol><apply id="S3.p1.24.m2.5.5.1.1.1.1.2.cmml" xref="S3.p1.24.m2.5.5.1.1.1.1.2"><ci id="S3.p1.24.m2.5.5.1.1.1.1.2.1.cmml" xref="S3.p1.24.m2.5.5.1.1.1.1.2.1">^</ci><ci id="S3.p1.24.m2.5.5.1.1.1.1.2.2.cmml" xref="S3.p1.24.m2.5.5.1.1.1.1.2.2">𝑥</ci></apply><ci id="S3.p1.24.m2.5.5.1.1.1.1.3.cmml" xref="S3.p1.24.m2.5.5.1.1.1.1.3">𝑖</ci></apply><ci id="S3.p1.24.m2.3.3.cmml" xref="S3.p1.24.m2.3.3">𝑧</ci><ci id="S3.p1.24.m2.4.4.cmml" xref="S3.p1.24.m2.4.4">𝑧</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.24.m2.5c">h(z)=\operatorname{SA}(\hat{x}_{i},z,z)</annotation></semantics></math>. The output of <math id="S3.p1.25.m3.2" class="ltx_Math" alttext="\operatorname{SA}(\hat{x}_{i})" display="inline"><semantics id="S3.p1.25.m3.2a"><mrow id="S3.p1.25.m3.2.2.1" xref="S3.p1.25.m3.2.2.2.cmml"><mi id="S3.p1.25.m3.1.1" xref="S3.p1.25.m3.1.1.cmml">SA</mi><mo id="S3.p1.25.m3.2.2.1a" xref="S3.p1.25.m3.2.2.2.cmml">⁡</mo><mrow id="S3.p1.25.m3.2.2.1.1" xref="S3.p1.25.m3.2.2.2.cmml"><mo stretchy="false" id="S3.p1.25.m3.2.2.1.1.2" xref="S3.p1.25.m3.2.2.2.cmml">(</mo><msub id="S3.p1.25.m3.2.2.1.1.1" xref="S3.p1.25.m3.2.2.1.1.1.cmml"><mover accent="true" id="S3.p1.25.m3.2.2.1.1.1.2" xref="S3.p1.25.m3.2.2.1.1.1.2.cmml"><mi id="S3.p1.25.m3.2.2.1.1.1.2.2" xref="S3.p1.25.m3.2.2.1.1.1.2.2.cmml">x</mi><mo id="S3.p1.25.m3.2.2.1.1.1.2.1" xref="S3.p1.25.m3.2.2.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.p1.25.m3.2.2.1.1.1.3" xref="S3.p1.25.m3.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.p1.25.m3.2.2.1.1.3" xref="S3.p1.25.m3.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.25.m3.2b"><apply id="S3.p1.25.m3.2.2.2.cmml" xref="S3.p1.25.m3.2.2.1"><ci id="S3.p1.25.m3.1.1.cmml" xref="S3.p1.25.m3.1.1">SA</ci><apply id="S3.p1.25.m3.2.2.1.1.1.cmml" xref="S3.p1.25.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p1.25.m3.2.2.1.1.1.1.cmml" xref="S3.p1.25.m3.2.2.1.1.1">subscript</csymbol><apply id="S3.p1.25.m3.2.2.1.1.1.2.cmml" xref="S3.p1.25.m3.2.2.1.1.1.2"><ci id="S3.p1.25.m3.2.2.1.1.1.2.1.cmml" xref="S3.p1.25.m3.2.2.1.1.1.2.1">^</ci><ci id="S3.p1.25.m3.2.2.1.1.1.2.2.cmml" xref="S3.p1.25.m3.2.2.1.1.1.2.2">𝑥</ci></apply><ci id="S3.p1.25.m3.2.2.1.1.1.3.cmml" xref="S3.p1.25.m3.2.2.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.25.m3.2c">\operatorname{SA}(\hat{x}_{i})</annotation></semantics></math> can then be expressed as:</p>
<table id="S3.E4" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E4X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E4X.2.1.1.m1.7" class="ltx_Math" alttext="\displaystyle\operatorname{SA}(\hat{x}_{i},\bm{X},\bm{X})=\mu h(\bm{X}_{D})+(1-\mu)h(\hat{\bm{x}})" display="inline"><semantics id="S3.E4X.2.1.1.m1.7a"><mrow id="S3.E4X.2.1.1.m1.7.7" xref="S3.E4X.2.1.1.m1.7.7.cmml"><mrow id="S3.E4X.2.1.1.m1.5.5.1.1" xref="S3.E4X.2.1.1.m1.5.5.1.2.cmml"><mi id="S3.E4X.2.1.1.m1.1.1" xref="S3.E4X.2.1.1.m1.1.1.cmml">SA</mi><mo id="S3.E4X.2.1.1.m1.5.5.1.1a" xref="S3.E4X.2.1.1.m1.5.5.1.2.cmml">⁡</mo><mrow id="S3.E4X.2.1.1.m1.5.5.1.1.1" xref="S3.E4X.2.1.1.m1.5.5.1.2.cmml"><mo stretchy="false" id="S3.E4X.2.1.1.m1.5.5.1.1.1.2" xref="S3.E4X.2.1.1.m1.5.5.1.2.cmml">(</mo><msub id="S3.E4X.2.1.1.m1.5.5.1.1.1.1" xref="S3.E4X.2.1.1.m1.5.5.1.1.1.1.cmml"><mover accent="true" id="S3.E4X.2.1.1.m1.5.5.1.1.1.1.2" xref="S3.E4X.2.1.1.m1.5.5.1.1.1.1.2.cmml"><mi id="S3.E4X.2.1.1.m1.5.5.1.1.1.1.2.2" xref="S3.E4X.2.1.1.m1.5.5.1.1.1.1.2.2.cmml">x</mi><mo id="S3.E4X.2.1.1.m1.5.5.1.1.1.1.2.1" xref="S3.E4X.2.1.1.m1.5.5.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E4X.2.1.1.m1.5.5.1.1.1.1.3" xref="S3.E4X.2.1.1.m1.5.5.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E4X.2.1.1.m1.5.5.1.1.1.3" xref="S3.E4X.2.1.1.m1.5.5.1.2.cmml">,</mo><mi id="S3.E4X.2.1.1.m1.2.2" xref="S3.E4X.2.1.1.m1.2.2.cmml">𝑿</mi><mo id="S3.E4X.2.1.1.m1.5.5.1.1.1.4" xref="S3.E4X.2.1.1.m1.5.5.1.2.cmml">,</mo><mi id="S3.E4X.2.1.1.m1.3.3" xref="S3.E4X.2.1.1.m1.3.3.cmml">𝑿</mi><mo stretchy="false" id="S3.E4X.2.1.1.m1.5.5.1.1.1.5" xref="S3.E4X.2.1.1.m1.5.5.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E4X.2.1.1.m1.7.7.4" xref="S3.E4X.2.1.1.m1.7.7.4.cmml">=</mo><mrow id="S3.E4X.2.1.1.m1.7.7.3" xref="S3.E4X.2.1.1.m1.7.7.3.cmml"><mrow id="S3.E4X.2.1.1.m1.6.6.2.1" xref="S3.E4X.2.1.1.m1.6.6.2.1.cmml"><mi id="S3.E4X.2.1.1.m1.6.6.2.1.3" xref="S3.E4X.2.1.1.m1.6.6.2.1.3.cmml">μ</mi><mo lspace="0em" rspace="0em" id="S3.E4X.2.1.1.m1.6.6.2.1.2" xref="S3.E4X.2.1.1.m1.6.6.2.1.2.cmml">​</mo><mi id="S3.E4X.2.1.1.m1.6.6.2.1.4" xref="S3.E4X.2.1.1.m1.6.6.2.1.4.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E4X.2.1.1.m1.6.6.2.1.2a" xref="S3.E4X.2.1.1.m1.6.6.2.1.2.cmml">​</mo><mrow id="S3.E4X.2.1.1.m1.6.6.2.1.1.1" xref="S3.E4X.2.1.1.m1.6.6.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4X.2.1.1.m1.6.6.2.1.1.1.2" xref="S3.E4X.2.1.1.m1.6.6.2.1.1.1.1.cmml">(</mo><msub id="S3.E4X.2.1.1.m1.6.6.2.1.1.1.1" xref="S3.E4X.2.1.1.m1.6.6.2.1.1.1.1.cmml"><mi id="S3.E4X.2.1.1.m1.6.6.2.1.1.1.1.2" xref="S3.E4X.2.1.1.m1.6.6.2.1.1.1.1.2.cmml">𝑿</mi><mi id="S3.E4X.2.1.1.m1.6.6.2.1.1.1.1.3" xref="S3.E4X.2.1.1.m1.6.6.2.1.1.1.1.3.cmml">D</mi></msub><mo stretchy="false" id="S3.E4X.2.1.1.m1.6.6.2.1.1.1.3" xref="S3.E4X.2.1.1.m1.6.6.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4X.2.1.1.m1.7.7.3.3" xref="S3.E4X.2.1.1.m1.7.7.3.3.cmml">+</mo><mrow id="S3.E4X.2.1.1.m1.7.7.3.2" xref="S3.E4X.2.1.1.m1.7.7.3.2.cmml"><mrow id="S3.E4X.2.1.1.m1.7.7.3.2.1.1" xref="S3.E4X.2.1.1.m1.7.7.3.2.1.1.1.cmml"><mo stretchy="false" id="S3.E4X.2.1.1.m1.7.7.3.2.1.1.2" xref="S3.E4X.2.1.1.m1.7.7.3.2.1.1.1.cmml">(</mo><mrow id="S3.E4X.2.1.1.m1.7.7.3.2.1.1.1" xref="S3.E4X.2.1.1.m1.7.7.3.2.1.1.1.cmml"><mn id="S3.E4X.2.1.1.m1.7.7.3.2.1.1.1.2" xref="S3.E4X.2.1.1.m1.7.7.3.2.1.1.1.2.cmml">1</mn><mo id="S3.E4X.2.1.1.m1.7.7.3.2.1.1.1.1" xref="S3.E4X.2.1.1.m1.7.7.3.2.1.1.1.1.cmml">−</mo><mi id="S3.E4X.2.1.1.m1.7.7.3.2.1.1.1.3" xref="S3.E4X.2.1.1.m1.7.7.3.2.1.1.1.3.cmml">μ</mi></mrow><mo stretchy="false" id="S3.E4X.2.1.1.m1.7.7.3.2.1.1.3" xref="S3.E4X.2.1.1.m1.7.7.3.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E4X.2.1.1.m1.7.7.3.2.2" xref="S3.E4X.2.1.1.m1.7.7.3.2.2.cmml">​</mo><mi id="S3.E4X.2.1.1.m1.7.7.3.2.3" xref="S3.E4X.2.1.1.m1.7.7.3.2.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E4X.2.1.1.m1.7.7.3.2.2a" xref="S3.E4X.2.1.1.m1.7.7.3.2.2.cmml">​</mo><mrow id="S3.E4X.2.1.1.m1.7.7.3.2.4.2" xref="S3.E4X.2.1.1.m1.4.4.cmml"><mo stretchy="false" id="S3.E4X.2.1.1.m1.7.7.3.2.4.2.1" xref="S3.E4X.2.1.1.m1.4.4.cmml">(</mo><mover accent="true" id="S3.E4X.2.1.1.m1.4.4" xref="S3.E4X.2.1.1.m1.4.4.cmml"><mi id="S3.E4X.2.1.1.m1.4.4.2" xref="S3.E4X.2.1.1.m1.4.4.2.cmml">𝒙</mi><mo id="S3.E4X.2.1.1.m1.4.4.1" xref="S3.E4X.2.1.1.m1.4.4.1.cmml">^</mo></mover><mo stretchy="false" id="S3.E4X.2.1.1.m1.7.7.3.2.4.2.2" xref="S3.E4X.2.1.1.m1.4.4.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4X.2.1.1.m1.7b"><apply id="S3.E4X.2.1.1.m1.7.7.cmml" xref="S3.E4X.2.1.1.m1.7.7"><eq id="S3.E4X.2.1.1.m1.7.7.4.cmml" xref="S3.E4X.2.1.1.m1.7.7.4"></eq><apply id="S3.E4X.2.1.1.m1.5.5.1.2.cmml" xref="S3.E4X.2.1.1.m1.5.5.1.1"><ci id="S3.E4X.2.1.1.m1.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1">SA</ci><apply id="S3.E4X.2.1.1.m1.5.5.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.5.5.1.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.5.5.1.1.1.1">subscript</csymbol><apply id="S3.E4X.2.1.1.m1.5.5.1.1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.5.5.1.1.1.1.2"><ci id="S3.E4X.2.1.1.m1.5.5.1.1.1.1.2.1.cmml" xref="S3.E4X.2.1.1.m1.5.5.1.1.1.1.2.1">^</ci><ci id="S3.E4X.2.1.1.m1.5.5.1.1.1.1.2.2.cmml" xref="S3.E4X.2.1.1.m1.5.5.1.1.1.1.2.2">𝑥</ci></apply><ci id="S3.E4X.2.1.1.m1.5.5.1.1.1.1.3.cmml" xref="S3.E4X.2.1.1.m1.5.5.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E4X.2.1.1.m1.2.2.cmml" xref="S3.E4X.2.1.1.m1.2.2">𝑿</ci><ci id="S3.E4X.2.1.1.m1.3.3.cmml" xref="S3.E4X.2.1.1.m1.3.3">𝑿</ci></apply><apply id="S3.E4X.2.1.1.m1.7.7.3.cmml" xref="S3.E4X.2.1.1.m1.7.7.3"><plus id="S3.E4X.2.1.1.m1.7.7.3.3.cmml" xref="S3.E4X.2.1.1.m1.7.7.3.3"></plus><apply id="S3.E4X.2.1.1.m1.6.6.2.1.cmml" xref="S3.E4X.2.1.1.m1.6.6.2.1"><times id="S3.E4X.2.1.1.m1.6.6.2.1.2.cmml" xref="S3.E4X.2.1.1.m1.6.6.2.1.2"></times><ci id="S3.E4X.2.1.1.m1.6.6.2.1.3.cmml" xref="S3.E4X.2.1.1.m1.6.6.2.1.3">𝜇</ci><ci id="S3.E4X.2.1.1.m1.6.6.2.1.4.cmml" xref="S3.E4X.2.1.1.m1.6.6.2.1.4">ℎ</ci><apply id="S3.E4X.2.1.1.m1.6.6.2.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.6.6.2.1.1.1"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.6.6.2.1.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.6.6.2.1.1.1">subscript</csymbol><ci id="S3.E4X.2.1.1.m1.6.6.2.1.1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.6.6.2.1.1.1.1.2">𝑿</ci><ci id="S3.E4X.2.1.1.m1.6.6.2.1.1.1.1.3.cmml" xref="S3.E4X.2.1.1.m1.6.6.2.1.1.1.1.3">𝐷</ci></apply></apply><apply id="S3.E4X.2.1.1.m1.7.7.3.2.cmml" xref="S3.E4X.2.1.1.m1.7.7.3.2"><times id="S3.E4X.2.1.1.m1.7.7.3.2.2.cmml" xref="S3.E4X.2.1.1.m1.7.7.3.2.2"></times><apply id="S3.E4X.2.1.1.m1.7.7.3.2.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.7.7.3.2.1.1"><minus id="S3.E4X.2.1.1.m1.7.7.3.2.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.7.7.3.2.1.1.1.1"></minus><cn type="integer" id="S3.E4X.2.1.1.m1.7.7.3.2.1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.7.7.3.2.1.1.1.2">1</cn><ci id="S3.E4X.2.1.1.m1.7.7.3.2.1.1.1.3.cmml" xref="S3.E4X.2.1.1.m1.7.7.3.2.1.1.1.3">𝜇</ci></apply><ci id="S3.E4X.2.1.1.m1.7.7.3.2.3.cmml" xref="S3.E4X.2.1.1.m1.7.7.3.2.3">ℎ</ci><apply id="S3.E4X.2.1.1.m1.4.4.cmml" xref="S3.E4X.2.1.1.m1.7.7.3.2.4.2"><ci id="S3.E4X.2.1.1.m1.4.4.1.cmml" xref="S3.E4X.2.1.1.m1.4.4.1">^</ci><ci id="S3.E4X.2.1.1.m1.4.4.2.cmml" xref="S3.E4X.2.1.1.m1.4.4.2">𝒙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4X.2.1.1.m1.7c">\displaystyle\operatorname{SA}(\hat{x}_{i},\bm{X},\bm{X})=\mu h(\bm{X}_{D})+(1-\mu)h(\hat{\bm{x}})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(4)</span></td>
</tr>
</tbody>
</table>
<p id="S3.p1.33" class="ltx_p">As noted in Equation <a href="#S3.E4" title="In 3 Learnable In-Context Vector ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, we observe that <math id="S3.p1.26.m1.1" class="ltx_Math" alttext="h(\hat{\bm{x}})" display="inline"><semantics id="S3.p1.26.m1.1a"><mrow id="S3.p1.26.m1.1.2" xref="S3.p1.26.m1.1.2.cmml"><mi id="S3.p1.26.m1.1.2.2" xref="S3.p1.26.m1.1.2.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.p1.26.m1.1.2.1" xref="S3.p1.26.m1.1.2.1.cmml">​</mo><mrow id="S3.p1.26.m1.1.2.3.2" xref="S3.p1.26.m1.1.1.cmml"><mo stretchy="false" id="S3.p1.26.m1.1.2.3.2.1" xref="S3.p1.26.m1.1.1.cmml">(</mo><mover accent="true" id="S3.p1.26.m1.1.1" xref="S3.p1.26.m1.1.1.cmml"><mi id="S3.p1.26.m1.1.1.2" xref="S3.p1.26.m1.1.1.2.cmml">𝒙</mi><mo id="S3.p1.26.m1.1.1.1" xref="S3.p1.26.m1.1.1.1.cmml">^</mo></mover><mo stretchy="false" id="S3.p1.26.m1.1.2.3.2.2" xref="S3.p1.26.m1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.26.m1.1b"><apply id="S3.p1.26.m1.1.2.cmml" xref="S3.p1.26.m1.1.2"><times id="S3.p1.26.m1.1.2.1.cmml" xref="S3.p1.26.m1.1.2.1"></times><ci id="S3.p1.26.m1.1.2.2.cmml" xref="S3.p1.26.m1.1.2.2">ℎ</ci><apply id="S3.p1.26.m1.1.1.cmml" xref="S3.p1.26.m1.1.2.3.2"><ci id="S3.p1.26.m1.1.1.1.cmml" xref="S3.p1.26.m1.1.1.1">^</ci><ci id="S3.p1.26.m1.1.1.2.cmml" xref="S3.p1.26.m1.1.1.2">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.26.m1.1c">h(\hat{\bm{x}})</annotation></semantics></math> is the representation obtained with self-attention over the query <math id="S3.p1.27.m2.1" class="ltx_Math" alttext="\hat{\bm{x}}" display="inline"><semantics id="S3.p1.27.m2.1a"><mover accent="true" id="S3.p1.27.m2.1.1" xref="S3.p1.27.m2.1.1.cmml"><mi id="S3.p1.27.m2.1.1.2" xref="S3.p1.27.m2.1.1.2.cmml">𝒙</mi><mo id="S3.p1.27.m2.1.1.1" xref="S3.p1.27.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.p1.27.m2.1b"><apply id="S3.p1.27.m2.1.1.cmml" xref="S3.p1.27.m2.1.1"><ci id="S3.p1.27.m2.1.1.1.cmml" xref="S3.p1.27.m2.1.1.1">^</ci><ci id="S3.p1.27.m2.1.1.2.cmml" xref="S3.p1.27.m2.1.1.2">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.27.m2.1c">\hat{\bm{x}}</annotation></semantics></math> without appending any ICD; <math id="S3.p1.28.m3.1" class="ltx_Math" alttext="h(\bm{X}_{D})" display="inline"><semantics id="S3.p1.28.m3.1a"><mrow id="S3.p1.28.m3.1.1" xref="S3.p1.28.m3.1.1.cmml"><mi id="S3.p1.28.m3.1.1.3" xref="S3.p1.28.m3.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.p1.28.m3.1.1.2" xref="S3.p1.28.m3.1.1.2.cmml">​</mo><mrow id="S3.p1.28.m3.1.1.1.1" xref="S3.p1.28.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p1.28.m3.1.1.1.1.2" xref="S3.p1.28.m3.1.1.1.1.1.cmml">(</mo><msub id="S3.p1.28.m3.1.1.1.1.1" xref="S3.p1.28.m3.1.1.1.1.1.cmml"><mi id="S3.p1.28.m3.1.1.1.1.1.2" xref="S3.p1.28.m3.1.1.1.1.1.2.cmml">𝑿</mi><mi id="S3.p1.28.m3.1.1.1.1.1.3" xref="S3.p1.28.m3.1.1.1.1.1.3.cmml">D</mi></msub><mo stretchy="false" id="S3.p1.28.m3.1.1.1.1.3" xref="S3.p1.28.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.28.m3.1b"><apply id="S3.p1.28.m3.1.1.cmml" xref="S3.p1.28.m3.1.1"><times id="S3.p1.28.m3.1.1.2.cmml" xref="S3.p1.28.m3.1.1.2"></times><ci id="S3.p1.28.m3.1.1.3.cmml" xref="S3.p1.28.m3.1.1.3">ℎ</ci><apply id="S3.p1.28.m3.1.1.1.1.1.cmml" xref="S3.p1.28.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.28.m3.1.1.1.1.1.1.cmml" xref="S3.p1.28.m3.1.1.1.1">subscript</csymbol><ci id="S3.p1.28.m3.1.1.1.1.1.2.cmml" xref="S3.p1.28.m3.1.1.1.1.1.2">𝑿</ci><ci id="S3.p1.28.m3.1.1.1.1.1.3.cmml" xref="S3.p1.28.m3.1.1.1.1.1.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.28.m3.1c">h(\bm{X}_{D})</annotation></semantics></math> functions similarly to a “shift" vector, altering the attention representation <math id="S3.p1.29.m4.1" class="ltx_Math" alttext="h(\hat{\bm{x}})" display="inline"><semantics id="S3.p1.29.m4.1a"><mrow id="S3.p1.29.m4.1.2" xref="S3.p1.29.m4.1.2.cmml"><mi id="S3.p1.29.m4.1.2.2" xref="S3.p1.29.m4.1.2.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.p1.29.m4.1.2.1" xref="S3.p1.29.m4.1.2.1.cmml">​</mo><mrow id="S3.p1.29.m4.1.2.3.2" xref="S3.p1.29.m4.1.1.cmml"><mo stretchy="false" id="S3.p1.29.m4.1.2.3.2.1" xref="S3.p1.29.m4.1.1.cmml">(</mo><mover accent="true" id="S3.p1.29.m4.1.1" xref="S3.p1.29.m4.1.1.cmml"><mi id="S3.p1.29.m4.1.1.2" xref="S3.p1.29.m4.1.1.2.cmml">𝒙</mi><mo id="S3.p1.29.m4.1.1.1" xref="S3.p1.29.m4.1.1.1.cmml">^</mo></mover><mo stretchy="false" id="S3.p1.29.m4.1.2.3.2.2" xref="S3.p1.29.m4.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.29.m4.1b"><apply id="S3.p1.29.m4.1.2.cmml" xref="S3.p1.29.m4.1.2"><times id="S3.p1.29.m4.1.2.1.cmml" xref="S3.p1.29.m4.1.2.1"></times><ci id="S3.p1.29.m4.1.2.2.cmml" xref="S3.p1.29.m4.1.2.2">ℎ</ci><apply id="S3.p1.29.m4.1.1.cmml" xref="S3.p1.29.m4.1.2.3.2"><ci id="S3.p1.29.m4.1.1.1.cmml" xref="S3.p1.29.m4.1.1.1">^</ci><ci id="S3.p1.29.m4.1.1.2.cmml" xref="S3.p1.29.m4.1.1.2">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.29.m4.1c">h(\hat{\bm{x}})</annotation></semantics></math> by incorporating contextual information from the ICDs <math id="S3.p1.30.m5.1" class="ltx_Math" alttext="\bm{X}_{D}" display="inline"><semantics id="S3.p1.30.m5.1a"><msub id="S3.p1.30.m5.1.1" xref="S3.p1.30.m5.1.1.cmml"><mi id="S3.p1.30.m5.1.1.2" xref="S3.p1.30.m5.1.1.2.cmml">𝑿</mi><mi id="S3.p1.30.m5.1.1.3" xref="S3.p1.30.m5.1.1.3.cmml">D</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.30.m5.1b"><apply id="S3.p1.30.m5.1.1.cmml" xref="S3.p1.30.m5.1.1"><csymbol cd="ambiguous" id="S3.p1.30.m5.1.1.1.cmml" xref="S3.p1.30.m5.1.1">subscript</csymbol><ci id="S3.p1.30.m5.1.1.2.cmml" xref="S3.p1.30.m5.1.1.2">𝑿</ci><ci id="S3.p1.30.m5.1.1.3.cmml" xref="S3.p1.30.m5.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.30.m5.1c">\bm{X}_{D}</annotation></semantics></math>. The coefficient <math id="S3.p1.31.m6.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S3.p1.31.m6.1a"><mi id="S3.p1.31.m6.1.1" xref="S3.p1.31.m6.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.31.m6.1b"><ci id="S3.p1.31.m6.1.1.cmml" xref="S3.p1.31.m6.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.31.m6.1c">\mu</annotation></semantics></math> quantifies the degree of influence <math id="S3.p1.32.m7.1" class="ltx_Math" alttext="X_{D}" display="inline"><semantics id="S3.p1.32.m7.1a"><msub id="S3.p1.32.m7.1.1" xref="S3.p1.32.m7.1.1.cmml"><mi id="S3.p1.32.m7.1.1.2" xref="S3.p1.32.m7.1.1.2.cmml">X</mi><mi id="S3.p1.32.m7.1.1.3" xref="S3.p1.32.m7.1.1.3.cmml">D</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.32.m7.1b"><apply id="S3.p1.32.m7.1.1.cmml" xref="S3.p1.32.m7.1.1"><csymbol cd="ambiguous" id="S3.p1.32.m7.1.1.1.cmml" xref="S3.p1.32.m7.1.1">subscript</csymbol><ci id="S3.p1.32.m7.1.1.2.cmml" xref="S3.p1.32.m7.1.1.2">𝑋</ci><ci id="S3.p1.32.m7.1.1.3.cmml" xref="S3.p1.32.m7.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.32.m7.1c">X_{D}</annotation></semantics></math> has over the original query representation. For a visual demonstration of how ICDs shift the representation space, see Figure <a href="#S2.F2" title="Figure 2 ‣ 2 Related Work ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> (b). Consequently, once learning a general shift direction to replace the effect of <math id="S3.p1.33.m8.1" class="ltx_Math" alttext="h(\bm{X}_{D})" display="inline"><semantics id="S3.p1.33.m8.1a"><mrow id="S3.p1.33.m8.1.1" xref="S3.p1.33.m8.1.1.cmml"><mi id="S3.p1.33.m8.1.1.3" xref="S3.p1.33.m8.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.p1.33.m8.1.1.2" xref="S3.p1.33.m8.1.1.2.cmml">​</mo><mrow id="S3.p1.33.m8.1.1.1.1" xref="S3.p1.33.m8.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p1.33.m8.1.1.1.1.2" xref="S3.p1.33.m8.1.1.1.1.1.cmml">(</mo><msub id="S3.p1.33.m8.1.1.1.1.1" xref="S3.p1.33.m8.1.1.1.1.1.cmml"><mi id="S3.p1.33.m8.1.1.1.1.1.2" xref="S3.p1.33.m8.1.1.1.1.1.2.cmml">𝑿</mi><mi id="S3.p1.33.m8.1.1.1.1.1.3" xref="S3.p1.33.m8.1.1.1.1.1.3.cmml">D</mi></msub><mo stretchy="false" id="S3.p1.33.m8.1.1.1.1.3" xref="S3.p1.33.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.33.m8.1b"><apply id="S3.p1.33.m8.1.1.cmml" xref="S3.p1.33.m8.1.1"><times id="S3.p1.33.m8.1.1.2.cmml" xref="S3.p1.33.m8.1.1.2"></times><ci id="S3.p1.33.m8.1.1.3.cmml" xref="S3.p1.33.m8.1.1.3">ℎ</ci><apply id="S3.p1.33.m8.1.1.1.1.1.cmml" xref="S3.p1.33.m8.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.33.m8.1.1.1.1.1.1.cmml" xref="S3.p1.33.m8.1.1.1.1">subscript</csymbol><ci id="S3.p1.33.m8.1.1.1.1.1.2.cmml" xref="S3.p1.33.m8.1.1.1.1.1.2">𝑿</ci><ci id="S3.p1.33.m8.1.1.1.1.1.3.cmml" xref="S3.p1.33.m8.1.1.1.1.1.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.33.m8.1c">h(\bm{X}_{D})</annotation></semantics></math>, we can employ this shift direction to simulate the ICL process of LMMs without actual demonstrations.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.11" class="ltx_p">We propose a novel method that involves a <span id="S3.p2.11.1" class="ltx_text ltx_font_bold">Learnable In-Context Vector</span> (L-ICV) to simulate the ICL process without actual demonstrations. This approach aims to abstract general task information from demonstrations, enabling it to shift the model’s representation toward the direction influenced by the ICDs. Figure <a href="#S2.F2" title="Figure 2 ‣ 2 Related Work ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows the training pipeline of L-ICV.
The L-ICV training dataset, denoted as <math id="S3.p2.1.m1.3" class="ltx_Math" alttext="\mathcal{D}=\{\bm{d}_{1},\dots,\bm{d}_{N}\}" display="inline"><semantics id="S3.p2.1.m1.3a"><mrow id="S3.p2.1.m1.3.3" xref="S3.p2.1.m1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.1.m1.3.3.4" xref="S3.p2.1.m1.3.3.4.cmml">𝒟</mi><mo id="S3.p2.1.m1.3.3.3" xref="S3.p2.1.m1.3.3.3.cmml">=</mo><mrow id="S3.p2.1.m1.3.3.2.2" xref="S3.p2.1.m1.3.3.2.3.cmml"><mo stretchy="false" id="S3.p2.1.m1.3.3.2.2.3" xref="S3.p2.1.m1.3.3.2.3.cmml">{</mo><msub id="S3.p2.1.m1.2.2.1.1.1" xref="S3.p2.1.m1.2.2.1.1.1.cmml"><mi id="S3.p2.1.m1.2.2.1.1.1.2" xref="S3.p2.1.m1.2.2.1.1.1.2.cmml">𝒅</mi><mn id="S3.p2.1.m1.2.2.1.1.1.3" xref="S3.p2.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.p2.1.m1.3.3.2.2.4" xref="S3.p2.1.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">…</mi><mo id="S3.p2.1.m1.3.3.2.2.5" xref="S3.p2.1.m1.3.3.2.3.cmml">,</mo><msub id="S3.p2.1.m1.3.3.2.2.2" xref="S3.p2.1.m1.3.3.2.2.2.cmml"><mi id="S3.p2.1.m1.3.3.2.2.2.2" xref="S3.p2.1.m1.3.3.2.2.2.2.cmml">𝒅</mi><mi id="S3.p2.1.m1.3.3.2.2.2.3" xref="S3.p2.1.m1.3.3.2.2.2.3.cmml">N</mi></msub><mo stretchy="false" id="S3.p2.1.m1.3.3.2.2.6" xref="S3.p2.1.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.3b"><apply id="S3.p2.1.m1.3.3.cmml" xref="S3.p2.1.m1.3.3"><eq id="S3.p2.1.m1.3.3.3.cmml" xref="S3.p2.1.m1.3.3.3"></eq><ci id="S3.p2.1.m1.3.3.4.cmml" xref="S3.p2.1.m1.3.3.4">𝒟</ci><set id="S3.p2.1.m1.3.3.2.3.cmml" xref="S3.p2.1.m1.3.3.2.2"><apply id="S3.p2.1.m1.2.2.1.1.1.cmml" xref="S3.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.p2.1.m1.2.2.1.1.1.2">𝒅</ci><cn type="integer" id="S3.p2.1.m1.2.2.1.1.1.3.cmml" xref="S3.p2.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">…</ci><apply id="S3.p2.1.m1.3.3.2.2.2.cmml" xref="S3.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p2.1.m1.3.3.2.2.2.1.cmml" xref="S3.p2.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.p2.1.m1.3.3.2.2.2.2.cmml" xref="S3.p2.1.m1.3.3.2.2.2.2">𝒅</ci><ci id="S3.p2.1.m1.3.3.2.2.2.3.cmml" xref="S3.p2.1.m1.3.3.2.2.2.3">𝑁</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.3c">\mathcal{D}=\{\bm{d}_{1},\dots,\bm{d}_{N}\}</annotation></semantics></math>, is a subset of the VQA dataset training split, created by randomly selecting <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.p2.2.m2.1a"><mi id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">N</annotation></semantics></math> question-answer pairs from it.
We use each training sample <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="\bm{d}_{i}" display="inline"><semantics id="S3.p2.3.m3.1a"><msub id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml"><mi id="S3.p2.3.m3.1.1.2" xref="S3.p2.3.m3.1.1.2.cmml">𝒅</mi><mi id="S3.p2.3.m3.1.1.3" xref="S3.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><apply id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.1.cmml" xref="S3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.p2.3.m3.1.1.2.cmml" xref="S3.p2.3.m3.1.1.2">𝒅</ci><ci id="S3.p2.3.m3.1.1.3.cmml" xref="S3.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">\bm{d}_{i}</annotation></semantics></math> to simulate the query sample <math id="S3.p2.4.m4.1" class="ltx_Math" alttext="\bm{\hat{x}}" display="inline"><semantics id="S3.p2.4.m4.1a"><mover accent="true" id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml"><mi id="S3.p2.4.m4.1.1.2" xref="S3.p2.4.m4.1.1.2.cmml">𝒙</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.p2.4.m4.1.1.1" xref="S3.p2.4.m4.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><apply id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1"><ci id="S3.p2.4.m4.1.1.1.cmml" xref="S3.p2.4.m4.1.1.1">bold-^</ci><ci id="S3.p2.4.m4.1.1.2.cmml" xref="S3.p2.4.m4.1.1.2">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">\bm{\hat{x}}</annotation></semantics></math> in ICL, and randomly select <math id="S3.p2.5.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.p2.5.m5.1a"><mi id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><ci id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">k</annotation></semantics></math> demonstrations from <math id="S3.p2.6.m6.1" class="ltx_Math" alttext="\mathcal{D}\setminus\{\bm{d}_{i}\}" display="inline"><semantics id="S3.p2.6.m6.1a"><mrow id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.6.m6.1.1.3" xref="S3.p2.6.m6.1.1.3.cmml">𝒟</mi><mo id="S3.p2.6.m6.1.1.2" xref="S3.p2.6.m6.1.1.2.cmml">∖</mo><mrow id="S3.p2.6.m6.1.1.1.1" xref="S3.p2.6.m6.1.1.1.2.cmml"><mo stretchy="false" id="S3.p2.6.m6.1.1.1.1.2" xref="S3.p2.6.m6.1.1.1.2.cmml">{</mo><msub id="S3.p2.6.m6.1.1.1.1.1" xref="S3.p2.6.m6.1.1.1.1.1.cmml"><mi id="S3.p2.6.m6.1.1.1.1.1.2" xref="S3.p2.6.m6.1.1.1.1.1.2.cmml">𝒅</mi><mi id="S3.p2.6.m6.1.1.1.1.1.3" xref="S3.p2.6.m6.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.p2.6.m6.1.1.1.1.3" xref="S3.p2.6.m6.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.6.m6.1b"><apply id="S3.p2.6.m6.1.1.cmml" xref="S3.p2.6.m6.1.1"><setdiff id="S3.p2.6.m6.1.1.2.cmml" xref="S3.p2.6.m6.1.1.2"></setdiff><ci id="S3.p2.6.m6.1.1.3.cmml" xref="S3.p2.6.m6.1.1.3">𝒟</ci><set id="S3.p2.6.m6.1.1.1.2.cmml" xref="S3.p2.6.m6.1.1.1.1"><apply id="S3.p2.6.m6.1.1.1.1.1.cmml" xref="S3.p2.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.6.m6.1.1.1.1.1.1.cmml" xref="S3.p2.6.m6.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.6.m6.1.1.1.1.1.2.cmml" xref="S3.p2.6.m6.1.1.1.1.1.2">𝒅</ci><ci id="S3.p2.6.m6.1.1.1.1.1.3.cmml" xref="S3.p2.6.m6.1.1.1.1.1.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m6.1c">\mathcal{D}\setminus\{\bm{d}_{i}\}</annotation></semantics></math> for it. Additionally,  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> shows that during ICL, each layer of an LLM performs a distinct role. Motivated by this, we assume that for LMM, each layer also requires a specific shift direction. We assign a learnable vector <math id="S3.p2.7.m7.1" class="ltx_Math" alttext="\bm{v}_{l}" display="inline"><semantics id="S3.p2.7.m7.1a"><msub id="S3.p2.7.m7.1.1" xref="S3.p2.7.m7.1.1.cmml"><mi id="S3.p2.7.m7.1.1.2" xref="S3.p2.7.m7.1.1.2.cmml">𝒗</mi><mi id="S3.p2.7.m7.1.1.3" xref="S3.p2.7.m7.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.7.m7.1b"><apply id="S3.p2.7.m7.1.1.cmml" xref="S3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p2.7.m7.1.1.1.cmml" xref="S3.p2.7.m7.1.1">subscript</csymbol><ci id="S3.p2.7.m7.1.1.2.cmml" xref="S3.p2.7.m7.1.1.2">𝒗</ci><ci id="S3.p2.7.m7.1.1.3.cmml" xref="S3.p2.7.m7.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.m7.1c">\bm{v}_{l}</annotation></semantics></math> and a weight factor <math id="S3.p2.8.m8.1" class="ltx_Math" alttext="\alpha_{l}" display="inline"><semantics id="S3.p2.8.m8.1a"><msub id="S3.p2.8.m8.1.1" xref="S3.p2.8.m8.1.1.cmml"><mi id="S3.p2.8.m8.1.1.2" xref="S3.p2.8.m8.1.1.2.cmml">α</mi><mi id="S3.p2.8.m8.1.1.3" xref="S3.p2.8.m8.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.8.m8.1b"><apply id="S3.p2.8.m8.1.1.cmml" xref="S3.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.p2.8.m8.1.1.1.cmml" xref="S3.p2.8.m8.1.1">subscript</csymbol><ci id="S3.p2.8.m8.1.1.2.cmml" xref="S3.p2.8.m8.1.1.2">𝛼</ci><ci id="S3.p2.8.m8.1.1.3.cmml" xref="S3.p2.8.m8.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.8.m8.1c">\alpha_{l}</annotation></semantics></math> for each layer <math id="S3.p2.9.m9.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.p2.9.m9.1a"><mi id="S3.p2.9.m9.1.1" xref="S3.p2.9.m9.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.p2.9.m9.1b"><ci id="S3.p2.9.m9.1.1.cmml" xref="S3.p2.9.m9.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.9.m9.1c">l</annotation></semantics></math> to learn the unique shift effect. Our final L-ICV comprises of the vector set <math id="S3.p2.10.m10.1" class="ltx_Math" alttext="\bm{V}" display="inline"><semantics id="S3.p2.10.m10.1a"><mi id="S3.p2.10.m10.1.1" xref="S3.p2.10.m10.1.1.cmml">𝑽</mi><annotation-xml encoding="MathML-Content" id="S3.p2.10.m10.1b"><ci id="S3.p2.10.m10.1.1.cmml" xref="S3.p2.10.m10.1.1">𝑽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.10.m10.1c">\bm{V}</annotation></semantics></math> and the corresponding weight factor set <math id="S3.p2.11.m11.1" class="ltx_Math" alttext="\bm{\alpha}" display="inline"><semantics id="S3.p2.11.m11.1a"><mi id="S3.p2.11.m11.1.1" xref="S3.p2.11.m11.1.1.cmml">𝜶</mi><annotation-xml encoding="MathML-Content" id="S3.p2.11.m11.1b"><ci id="S3.p2.11.m11.1.1.cmml" xref="S3.p2.11.m11.1.1">𝜶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.11.m11.1c">\bm{\alpha}</annotation></semantics></math> as:</p>
<table id="S3.E5" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E5X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\bm{V}" display="inline"><semantics id="S3.E5X.2.1.1.m1.1a"><mi id="S3.E5X.2.1.1.m1.1.1" xref="S3.E5X.2.1.1.m1.1.1.cmml">𝑽</mi><annotation-xml encoding="MathML-Content" id="S3.E5X.2.1.1.m1.1b"><ci id="S3.E5X.2.1.1.m1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1">𝑽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.2.1.1.m1.1c">\displaystyle\bm{V}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5X.3.2.2.m1.3" class="ltx_Math" alttext="\displaystyle=\{\bm{v}_{1},\bm{v}_{2},...,\bm{v}_{L}\},\quad v_{i}\in\mathbb{R}^{1\times d}" display="inline"><semantics id="S3.E5X.3.2.2.m1.3a"><mrow id="S3.E5X.3.2.2.m1.3.3.2" xref="S3.E5X.3.2.2.m1.3.3.3.cmml"><mrow id="S3.E5X.3.2.2.m1.2.2.1.1" xref="S3.E5X.3.2.2.m1.2.2.1.1.cmml"><mi id="S3.E5X.3.2.2.m1.2.2.1.1.5" xref="S3.E5X.3.2.2.m1.2.2.1.1.5.cmml"></mi><mo id="S3.E5X.3.2.2.m1.2.2.1.1.4" xref="S3.E5X.3.2.2.m1.2.2.1.1.4.cmml">=</mo><mrow id="S3.E5X.3.2.2.m1.2.2.1.1.3.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.3.4.cmml"><mo stretchy="false" id="S3.E5X.3.2.2.m1.2.2.1.1.3.3.4" xref="S3.E5X.3.2.2.m1.2.2.1.1.3.4.cmml">{</mo><msub id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.2.cmml">𝒗</mi><mn id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E5X.3.2.2.m1.2.2.1.1.3.3.5" xref="S3.E5X.3.2.2.m1.2.2.1.1.3.4.cmml">,</mo><msub id="S3.E5X.3.2.2.m1.2.2.1.1.2.2.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.2.2.2.cmml"><mi id="S3.E5X.3.2.2.m1.2.2.1.1.2.2.2.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.2.2.2.2.cmml">𝒗</mi><mn id="S3.E5X.3.2.2.m1.2.2.1.1.2.2.2.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.2.2.2.3.cmml">2</mn></msub><mo id="S3.E5X.3.2.2.m1.2.2.1.1.3.3.6" xref="S3.E5X.3.2.2.m1.2.2.1.1.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.E5X.3.2.2.m1.1.1" xref="S3.E5X.3.2.2.m1.1.1.cmml">…</mi><mo id="S3.E5X.3.2.2.m1.2.2.1.1.3.3.7" xref="S3.E5X.3.2.2.m1.2.2.1.1.3.4.cmml">,</mo><msub id="S3.E5X.3.2.2.m1.2.2.1.1.3.3.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.3.3.3.cmml"><mi id="S3.E5X.3.2.2.m1.2.2.1.1.3.3.3.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.3.3.3.2.cmml">𝒗</mi><mi id="S3.E5X.3.2.2.m1.2.2.1.1.3.3.3.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.3.3.3.3.cmml">L</mi></msub><mo stretchy="false" id="S3.E5X.3.2.2.m1.2.2.1.1.3.3.8" xref="S3.E5X.3.2.2.m1.2.2.1.1.3.4.cmml">}</mo></mrow></mrow><mo rspace="1.167em" id="S3.E5X.3.2.2.m1.3.3.2.3" xref="S3.E5X.3.2.2.m1.3.3.3a.cmml">,</mo><mrow id="S3.E5X.3.2.2.m1.3.3.2.2" xref="S3.E5X.3.2.2.m1.3.3.2.2.cmml"><msub id="S3.E5X.3.2.2.m1.3.3.2.2.2" xref="S3.E5X.3.2.2.m1.3.3.2.2.2.cmml"><mi id="S3.E5X.3.2.2.m1.3.3.2.2.2.2" xref="S3.E5X.3.2.2.m1.3.3.2.2.2.2.cmml">v</mi><mi id="S3.E5X.3.2.2.m1.3.3.2.2.2.3" xref="S3.E5X.3.2.2.m1.3.3.2.2.2.3.cmml">i</mi></msub><mo id="S3.E5X.3.2.2.m1.3.3.2.2.1" xref="S3.E5X.3.2.2.m1.3.3.2.2.1.cmml">∈</mo><msup id="S3.E5X.3.2.2.m1.3.3.2.2.3" xref="S3.E5X.3.2.2.m1.3.3.2.2.3.cmml"><mi id="S3.E5X.3.2.2.m1.3.3.2.2.3.2" xref="S3.E5X.3.2.2.m1.3.3.2.2.3.2.cmml">ℝ</mi><mrow id="S3.E5X.3.2.2.m1.3.3.2.2.3.3" xref="S3.E5X.3.2.2.m1.3.3.2.2.3.3.cmml"><mn id="S3.E5X.3.2.2.m1.3.3.2.2.3.3.2" xref="S3.E5X.3.2.2.m1.3.3.2.2.3.3.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S3.E5X.3.2.2.m1.3.3.2.2.3.3.1" xref="S3.E5X.3.2.2.m1.3.3.2.2.3.3.1.cmml">×</mo><mi id="S3.E5X.3.2.2.m1.3.3.2.2.3.3.3" xref="S3.E5X.3.2.2.m1.3.3.2.2.3.3.3.cmml">d</mi></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5X.3.2.2.m1.3b"><apply id="S3.E5X.3.2.2.m1.3.3.3.cmml" xref="S3.E5X.3.2.2.m1.3.3.2"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.3.3.3a.cmml" xref="S3.E5X.3.2.2.m1.3.3.2.3">formulae-sequence</csymbol><apply id="S3.E5X.3.2.2.m1.2.2.1.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1"><eq id="S3.E5X.3.2.2.m1.2.2.1.1.4.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.4"></eq><csymbol cd="latexml" id="S3.E5X.3.2.2.m1.2.2.1.1.5.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.5">absent</csymbol><set id="S3.E5X.3.2.2.m1.2.2.1.1.3.4.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.3.3"><apply id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.2">𝒗</ci><cn type="integer" id="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.1.1.1.3">1</cn></apply><apply id="S3.E5X.3.2.2.m1.2.2.1.1.2.2.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.2.2.1.1.2.2.2.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.2.2.2">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.2.2.2.2">𝒗</ci><cn type="integer" id="S3.E5X.3.2.2.m1.2.2.1.1.2.2.2.3.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.2.2.2.3">2</cn></apply><ci id="S3.E5X.3.2.2.m1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1">…</ci><apply id="S3.E5X.3.2.2.m1.2.2.1.1.3.3.3.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.2.2.1.1.3.3.3.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.3.3.3">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.2.2.1.1.3.3.3.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.3.3.3.2">𝒗</ci><ci id="S3.E5X.3.2.2.m1.2.2.1.1.3.3.3.3.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.3.3.3.3">𝐿</ci></apply></set></apply><apply id="S3.E5X.3.2.2.m1.3.3.2.2.cmml" xref="S3.E5X.3.2.2.m1.3.3.2.2"><in id="S3.E5X.3.2.2.m1.3.3.2.2.1.cmml" xref="S3.E5X.3.2.2.m1.3.3.2.2.1"></in><apply id="S3.E5X.3.2.2.m1.3.3.2.2.2.cmml" xref="S3.E5X.3.2.2.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.3.3.2.2.2.1.cmml" xref="S3.E5X.3.2.2.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.3.3.2.2.2.2.cmml" xref="S3.E5X.3.2.2.m1.3.3.2.2.2.2">𝑣</ci><ci id="S3.E5X.3.2.2.m1.3.3.2.2.2.3.cmml" xref="S3.E5X.3.2.2.m1.3.3.2.2.2.3">𝑖</ci></apply><apply id="S3.E5X.3.2.2.m1.3.3.2.2.3.cmml" xref="S3.E5X.3.2.2.m1.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.3.3.2.2.3.1.cmml" xref="S3.E5X.3.2.2.m1.3.3.2.2.3">superscript</csymbol><ci id="S3.E5X.3.2.2.m1.3.3.2.2.3.2.cmml" xref="S3.E5X.3.2.2.m1.3.3.2.2.3.2">ℝ</ci><apply id="S3.E5X.3.2.2.m1.3.3.2.2.3.3.cmml" xref="S3.E5X.3.2.2.m1.3.3.2.2.3.3"><times id="S3.E5X.3.2.2.m1.3.3.2.2.3.3.1.cmml" xref="S3.E5X.3.2.2.m1.3.3.2.2.3.3.1"></times><cn type="integer" id="S3.E5X.3.2.2.m1.3.3.2.2.3.3.2.cmml" xref="S3.E5X.3.2.2.m1.3.3.2.2.3.3.2">1</cn><ci id="S3.E5X.3.2.2.m1.3.3.2.2.3.3.3.cmml" xref="S3.E5X.3.2.2.m1.3.3.2.2.3.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.3.2.2.m1.3c">\displaystyle=\{\bm{v}_{1},\bm{v}_{2},...,\bm{v}_{L}\},\quad v_{i}\in\mathbb{R}^{1\times d}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(5)</span></td>
</tr>
<tr id="S3.E5Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\bm{\alpha}" display="inline"><semantics id="S3.E5Xa.2.1.1.m1.1a"><mi id="S3.E5Xa.2.1.1.m1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.cmml">𝜶</mi><annotation-xml encoding="MathML-Content" id="S3.E5Xa.2.1.1.m1.1b"><ci id="S3.E5Xa.2.1.1.m1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1">𝜶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.E5Xa.2.1.1.m1.1c">\displaystyle\bm{\alpha}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5Xa.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle=\{\alpha_{1},\alpha_{2}...,\alpha_{L}\},\quad\alpha_{i}\in\mathbb{R}^{1\times 1}," display="inline"><semantics id="S3.E5Xa.3.2.2.m1.1a"><mrow id="S3.E5Xa.3.2.2.m1.1.1.1"><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.cmml"><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.5" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.5.cmml"></mi><mo id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.4" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.4.cmml">=</mo><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.4.cmml"><mo stretchy="false" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3.4" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.4.cmml">{</mo><msub id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml">α</mi><mn id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3.5" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.4.cmml">,</mo><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.cmml"><msub id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.2.cmml">α</mi><mn id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.1.cmml">​</mo><mi mathvariant="normal" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.3.cmml">…</mi></mrow><mo id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3.6" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3.3.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3.3.2.cmml">α</mi><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3.3.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3.3.3.cmml">L</mi></msub><mo stretchy="false" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3.7" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.4.cmml">}</mo></mrow></mrow><mo rspace="1.167em" id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.cmml"><msub id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.2.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.2.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.2.2.cmml">α</mi><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.2.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.2.3.cmml">i</mi></msub><mo id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.1.cmml">∈</mo><msup id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.2.cmml">ℝ</mi><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.3.cmml"><mn id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.3.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.3.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.3.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.3.1.cmml">×</mo><mn id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.3.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.3.3.cmml">1</mn></mrow></msup></mrow></mrow><mo id="S3.E5Xa.3.2.2.m1.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5Xa.3.2.2.m1.1b"><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.1.3a.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1"><eq id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.4.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.4"></eq><csymbol cd="latexml" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.5.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.5">absent</csymbol><set id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.4.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3"><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2">𝛼</ci><cn type="integer" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2"><times id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.1"></times><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.2">𝛼</ci><cn type="integer" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.3">2</cn></apply><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.3">…</ci></apply><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3.3.2">𝛼</ci><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3.3.3">𝐿</ci></apply></set></apply><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2"><in id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.1"></in><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.2.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.2.2">𝛼</ci><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.2.3">𝑖</ci></apply><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3">superscript</csymbol><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.2">ℝ</ci><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.3"><times id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.3.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.3.1"></times><cn type="integer" id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.3.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.3.2">1</cn><cn type="integer" id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.3.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5Xa.3.2.2.m1.1c">\displaystyle=\{\alpha_{1},\alpha_{2}...,\alpha_{L}\},\quad\alpha_{i}\in\mathbb{R}^{1\times 1},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.p2.16" class="ltx_p">where <math id="S3.p2.12.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.p2.12.m1.1a"><mi id="S3.p2.12.m1.1.1" xref="S3.p2.12.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.p2.12.m1.1b"><ci id="S3.p2.12.m1.1.1.cmml" xref="S3.p2.12.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.12.m1.1c">L</annotation></semantics></math> is the number of layers. To train <math id="S3.p2.13.m2.1" class="ltx_Math" alttext="\bm{V}" display="inline"><semantics id="S3.p2.13.m2.1a"><mi id="S3.p2.13.m2.1.1" xref="S3.p2.13.m2.1.1.cmml">𝑽</mi><annotation-xml encoding="MathML-Content" id="S3.p2.13.m2.1b"><ci id="S3.p2.13.m2.1.1.cmml" xref="S3.p2.13.m2.1.1">𝑽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.13.m2.1c">\bm{V}</annotation></semantics></math> and <math id="S3.p2.14.m3.1" class="ltx_Math" alttext="\bm{\alpha}" display="inline"><semantics id="S3.p2.14.m3.1a"><mi id="S3.p2.14.m3.1.1" xref="S3.p2.14.m3.1.1.cmml">𝜶</mi><annotation-xml encoding="MathML-Content" id="S3.p2.14.m3.1b"><ci id="S3.p2.14.m3.1.1.cmml" xref="S3.p2.14.m3.1.1">𝜶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.14.m3.1c">\bm{\alpha}</annotation></semantics></math>, we align the distribution of the model’s outputs for the query when shifted by demonstrations, <math id="S3.p2.15.m4.2" class="ltx_Math" alttext="\mathcal{P}(\bm{\hat{x}}|\bm{X}_{D};\mathcal{M})" display="inline"><semantics id="S3.p2.15.m4.2a"><mrow id="S3.p2.15.m4.2.2" xref="S3.p2.15.m4.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.15.m4.2.2.3" xref="S3.p2.15.m4.2.2.3.cmml">𝒫</mi><mo lspace="0em" rspace="0em" id="S3.p2.15.m4.2.2.2" xref="S3.p2.15.m4.2.2.2.cmml">​</mo><mrow id="S3.p2.15.m4.2.2.1.1" xref="S3.p2.15.m4.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.p2.15.m4.2.2.1.1.2" xref="S3.p2.15.m4.2.2.1.1.1.cmml">(</mo><mrow id="S3.p2.15.m4.2.2.1.1.1" xref="S3.p2.15.m4.2.2.1.1.1.cmml"><mover accent="true" id="S3.p2.15.m4.2.2.1.1.1.3" xref="S3.p2.15.m4.2.2.1.1.1.3.cmml"><mi id="S3.p2.15.m4.2.2.1.1.1.3.2" xref="S3.p2.15.m4.2.2.1.1.1.3.2.cmml">𝒙</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.p2.15.m4.2.2.1.1.1.3.1" xref="S3.p2.15.m4.2.2.1.1.1.3.1.cmml">^</mo></mover><mo fence="false" id="S3.p2.15.m4.2.2.1.1.1.2" xref="S3.p2.15.m4.2.2.1.1.1.2.cmml">|</mo><mrow id="S3.p2.15.m4.2.2.1.1.1.1.1" xref="S3.p2.15.m4.2.2.1.1.1.1.2.cmml"><msub id="S3.p2.15.m4.2.2.1.1.1.1.1.1" xref="S3.p2.15.m4.2.2.1.1.1.1.1.1.cmml"><mi id="S3.p2.15.m4.2.2.1.1.1.1.1.1.2" xref="S3.p2.15.m4.2.2.1.1.1.1.1.1.2.cmml">𝑿</mi><mi id="S3.p2.15.m4.2.2.1.1.1.1.1.1.3" xref="S3.p2.15.m4.2.2.1.1.1.1.1.1.3.cmml">D</mi></msub><mo id="S3.p2.15.m4.2.2.1.1.1.1.1.2" xref="S3.p2.15.m4.2.2.1.1.1.1.2.cmml">;</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.15.m4.1.1" xref="S3.p2.15.m4.1.1.cmml">ℳ</mi></mrow></mrow><mo stretchy="false" id="S3.p2.15.m4.2.2.1.1.3" xref="S3.p2.15.m4.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.15.m4.2b"><apply id="S3.p2.15.m4.2.2.cmml" xref="S3.p2.15.m4.2.2"><times id="S3.p2.15.m4.2.2.2.cmml" xref="S3.p2.15.m4.2.2.2"></times><ci id="S3.p2.15.m4.2.2.3.cmml" xref="S3.p2.15.m4.2.2.3">𝒫</ci><apply id="S3.p2.15.m4.2.2.1.1.1.cmml" xref="S3.p2.15.m4.2.2.1.1"><csymbol cd="latexml" id="S3.p2.15.m4.2.2.1.1.1.2.cmml" xref="S3.p2.15.m4.2.2.1.1.1.2">conditional</csymbol><apply id="S3.p2.15.m4.2.2.1.1.1.3.cmml" xref="S3.p2.15.m4.2.2.1.1.1.3"><ci id="S3.p2.15.m4.2.2.1.1.1.3.1.cmml" xref="S3.p2.15.m4.2.2.1.1.1.3.1">bold-^</ci><ci id="S3.p2.15.m4.2.2.1.1.1.3.2.cmml" xref="S3.p2.15.m4.2.2.1.1.1.3.2">𝒙</ci></apply><list id="S3.p2.15.m4.2.2.1.1.1.1.2.cmml" xref="S3.p2.15.m4.2.2.1.1.1.1.1"><apply id="S3.p2.15.m4.2.2.1.1.1.1.1.1.cmml" xref="S3.p2.15.m4.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.15.m4.2.2.1.1.1.1.1.1.1.cmml" xref="S3.p2.15.m4.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.15.m4.2.2.1.1.1.1.1.1.2.cmml" xref="S3.p2.15.m4.2.2.1.1.1.1.1.1.2">𝑿</ci><ci id="S3.p2.15.m4.2.2.1.1.1.1.1.1.3.cmml" xref="S3.p2.15.m4.2.2.1.1.1.1.1.1.3">𝐷</ci></apply><ci id="S3.p2.15.m4.1.1.cmml" xref="S3.p2.15.m4.1.1">ℳ</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.15.m4.2c">\mathcal{P}(\bm{\hat{x}}|\bm{X}_{D};\mathcal{M})</annotation></semantics></math>, with that shifted by our L-ICV, <math id="S3.p2.16.m5.4" class="ltx_Math" alttext="\mathcal{P}(\bm{\hat{x}}|\bm{V},\bm{\alpha};\mathcal{M})" display="inline"><semantics id="S3.p2.16.m5.4a"><mrow id="S3.p2.16.m5.4.4" xref="S3.p2.16.m5.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.16.m5.4.4.3" xref="S3.p2.16.m5.4.4.3.cmml">𝒫</mi><mo lspace="0em" rspace="0em" id="S3.p2.16.m5.4.4.2" xref="S3.p2.16.m5.4.4.2.cmml">​</mo><mrow id="S3.p2.16.m5.4.4.1.1" xref="S3.p2.16.m5.4.4.1.1.1.cmml"><mo stretchy="false" id="S3.p2.16.m5.4.4.1.1.2" xref="S3.p2.16.m5.4.4.1.1.1.cmml">(</mo><mrow id="S3.p2.16.m5.4.4.1.1.1" xref="S3.p2.16.m5.4.4.1.1.1.cmml"><mover accent="true" id="S3.p2.16.m5.4.4.1.1.1.2" xref="S3.p2.16.m5.4.4.1.1.1.2.cmml"><mi id="S3.p2.16.m5.4.4.1.1.1.2.2" xref="S3.p2.16.m5.4.4.1.1.1.2.2.cmml">𝒙</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.p2.16.m5.4.4.1.1.1.2.1" xref="S3.p2.16.m5.4.4.1.1.1.2.1.cmml">^</mo></mover><mo fence="false" id="S3.p2.16.m5.4.4.1.1.1.1" xref="S3.p2.16.m5.4.4.1.1.1.1.cmml">|</mo><mrow id="S3.p2.16.m5.4.4.1.1.1.3.2" xref="S3.p2.16.m5.4.4.1.1.1.3.1.cmml"><mi id="S3.p2.16.m5.1.1" xref="S3.p2.16.m5.1.1.cmml">𝑽</mi><mo id="S3.p2.16.m5.4.4.1.1.1.3.2.1" xref="S3.p2.16.m5.4.4.1.1.1.3.1.cmml">,</mo><mi id="S3.p2.16.m5.2.2" xref="S3.p2.16.m5.2.2.cmml">𝜶</mi><mo id="S3.p2.16.m5.4.4.1.1.1.3.2.2" xref="S3.p2.16.m5.4.4.1.1.1.3.1.cmml">;</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.16.m5.3.3" xref="S3.p2.16.m5.3.3.cmml">ℳ</mi></mrow></mrow><mo stretchy="false" id="S3.p2.16.m5.4.4.1.1.3" xref="S3.p2.16.m5.4.4.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.16.m5.4b"><apply id="S3.p2.16.m5.4.4.cmml" xref="S3.p2.16.m5.4.4"><times id="S3.p2.16.m5.4.4.2.cmml" xref="S3.p2.16.m5.4.4.2"></times><ci id="S3.p2.16.m5.4.4.3.cmml" xref="S3.p2.16.m5.4.4.3">𝒫</ci><apply id="S3.p2.16.m5.4.4.1.1.1.cmml" xref="S3.p2.16.m5.4.4.1.1"><csymbol cd="latexml" id="S3.p2.16.m5.4.4.1.1.1.1.cmml" xref="S3.p2.16.m5.4.4.1.1.1.1">conditional</csymbol><apply id="S3.p2.16.m5.4.4.1.1.1.2.cmml" xref="S3.p2.16.m5.4.4.1.1.1.2"><ci id="S3.p2.16.m5.4.4.1.1.1.2.1.cmml" xref="S3.p2.16.m5.4.4.1.1.1.2.1">bold-^</ci><ci id="S3.p2.16.m5.4.4.1.1.1.2.2.cmml" xref="S3.p2.16.m5.4.4.1.1.1.2.2">𝒙</ci></apply><list id="S3.p2.16.m5.4.4.1.1.1.3.1.cmml" xref="S3.p2.16.m5.4.4.1.1.1.3.2"><ci id="S3.p2.16.m5.1.1.cmml" xref="S3.p2.16.m5.1.1">𝑽</ci><ci id="S3.p2.16.m5.2.2.cmml" xref="S3.p2.16.m5.2.2">𝜶</ci><ci id="S3.p2.16.m5.3.3.cmml" xref="S3.p2.16.m5.3.3">ℳ</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.16.m5.4c">\mathcal{P}(\bm{\hat{x}}|\bm{V},\bm{\alpha};\mathcal{M})</annotation></semantics></math>. This alignment is achieved by minimizing the Kullback-Leibler (KL) divergence:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.4" class="ltx_math_unparsed" alttext="\mathcal{L}_{d}=\text{KL}(\mathcal{P}(\bm{\hat{x}}|\bm{X}_{D};\mathcal{M})\mid\mid\mathcal{P}(\bm{\hat{x}}|\bm{V},\bm{\alpha};\mathcal{M}))" display="block"><semantics id="S3.E6.m1.4a"><mrow id="S3.E6.m1.4b"><msub id="S3.E6.m1.4.5"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.4.5.2">ℒ</mi><mi id="S3.E6.m1.4.5.3">d</mi></msub><mo id="S3.E6.m1.4.6">=</mo><mtext id="S3.E6.m1.4.7">KL</mtext><mrow id="S3.E6.m1.4.8"><mo stretchy="false" id="S3.E6.m1.4.8.1">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.4.8.2">𝒫</mi><mrow id="S3.E6.m1.4.8.3"><mo stretchy="false" id="S3.E6.m1.4.8.3.1">(</mo><mover accent="true" id="S3.E6.m1.4.8.3.2"><mi id="S3.E6.m1.4.8.3.2.2">𝒙</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.E6.m1.4.8.3.2.1">^</mo></mover><mo fence="false" rspace="0.167em" stretchy="false" id="S3.E6.m1.4.8.3.3">|</mo><msub id="S3.E6.m1.4.8.3.4"><mi id="S3.E6.m1.4.8.3.4.2">𝑿</mi><mi id="S3.E6.m1.4.8.3.4.3">D</mi></msub><mo id="S3.E6.m1.4.8.3.5">;</mo><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1">ℳ</mi><mo stretchy="false" id="S3.E6.m1.4.8.3.6">)</mo></mrow><mo lspace="0em" rspace="0.0835em" id="S3.E6.m1.4.8.4">∣</mo><mo lspace="0.0835em" rspace="0.167em" id="S3.E6.m1.4.8.5">∣</mo><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.4.8.6">𝒫</mi><mrow id="S3.E6.m1.4.8.7"><mo stretchy="false" id="S3.E6.m1.4.8.7.1">(</mo><mover accent="true" id="S3.E6.m1.4.8.7.2"><mi id="S3.E6.m1.4.8.7.2.2">𝒙</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.E6.m1.4.8.7.2.1">^</mo></mover><mo fence="false" rspace="0.167em" stretchy="false" id="S3.E6.m1.4.8.7.3">|</mo><mi id="S3.E6.m1.2.2">𝑽</mi><mo id="S3.E6.m1.4.8.7.4">,</mo><mi id="S3.E6.m1.3.3">𝜶</mi><mo id="S3.E6.m1.4.8.7.5">;</mo><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.4.4">ℳ</mi><mo stretchy="false" id="S3.E6.m1.4.8.7.6">)</mo></mrow><mo stretchy="false" id="S3.E6.m1.4.8.8">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E6.m1.4c">\mathcal{L}_{d}=\text{KL}(\mathcal{P}(\bm{\hat{x}}|\bm{X}_{D};\mathcal{M})\mid\mid\mathcal{P}(\bm{\hat{x}}|\bm{V},\bm{\alpha};\mathcal{M}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.p2.21" class="ltx_p">To obtain the distribution <math id="S3.p2.17.m1.2" class="ltx_Math" alttext="\mathcal{P}(\bm{\hat{x}}|\bm{X}_{D};\mathcal{M})" display="inline"><semantics id="S3.p2.17.m1.2a"><mrow id="S3.p2.17.m1.2.2" xref="S3.p2.17.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.17.m1.2.2.3" xref="S3.p2.17.m1.2.2.3.cmml">𝒫</mi><mo lspace="0em" rspace="0em" id="S3.p2.17.m1.2.2.2" xref="S3.p2.17.m1.2.2.2.cmml">​</mo><mrow id="S3.p2.17.m1.2.2.1.1" xref="S3.p2.17.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.p2.17.m1.2.2.1.1.2" xref="S3.p2.17.m1.2.2.1.1.1.cmml">(</mo><mrow id="S3.p2.17.m1.2.2.1.1.1" xref="S3.p2.17.m1.2.2.1.1.1.cmml"><mover accent="true" id="S3.p2.17.m1.2.2.1.1.1.3" xref="S3.p2.17.m1.2.2.1.1.1.3.cmml"><mi id="S3.p2.17.m1.2.2.1.1.1.3.2" xref="S3.p2.17.m1.2.2.1.1.1.3.2.cmml">𝒙</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.p2.17.m1.2.2.1.1.1.3.1" xref="S3.p2.17.m1.2.2.1.1.1.3.1.cmml">^</mo></mover><mo fence="false" id="S3.p2.17.m1.2.2.1.1.1.2" xref="S3.p2.17.m1.2.2.1.1.1.2.cmml">|</mo><mrow id="S3.p2.17.m1.2.2.1.1.1.1.1" xref="S3.p2.17.m1.2.2.1.1.1.1.2.cmml"><msub id="S3.p2.17.m1.2.2.1.1.1.1.1.1" xref="S3.p2.17.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.p2.17.m1.2.2.1.1.1.1.1.1.2" xref="S3.p2.17.m1.2.2.1.1.1.1.1.1.2.cmml">𝑿</mi><mi id="S3.p2.17.m1.2.2.1.1.1.1.1.1.3" xref="S3.p2.17.m1.2.2.1.1.1.1.1.1.3.cmml">D</mi></msub><mo id="S3.p2.17.m1.2.2.1.1.1.1.1.2" xref="S3.p2.17.m1.2.2.1.1.1.1.2.cmml">;</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.17.m1.1.1" xref="S3.p2.17.m1.1.1.cmml">ℳ</mi></mrow></mrow><mo stretchy="false" id="S3.p2.17.m1.2.2.1.1.3" xref="S3.p2.17.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.17.m1.2b"><apply id="S3.p2.17.m1.2.2.cmml" xref="S3.p2.17.m1.2.2"><times id="S3.p2.17.m1.2.2.2.cmml" xref="S3.p2.17.m1.2.2.2"></times><ci id="S3.p2.17.m1.2.2.3.cmml" xref="S3.p2.17.m1.2.2.3">𝒫</ci><apply id="S3.p2.17.m1.2.2.1.1.1.cmml" xref="S3.p2.17.m1.2.2.1.1"><csymbol cd="latexml" id="S3.p2.17.m1.2.2.1.1.1.2.cmml" xref="S3.p2.17.m1.2.2.1.1.1.2">conditional</csymbol><apply id="S3.p2.17.m1.2.2.1.1.1.3.cmml" xref="S3.p2.17.m1.2.2.1.1.1.3"><ci id="S3.p2.17.m1.2.2.1.1.1.3.1.cmml" xref="S3.p2.17.m1.2.2.1.1.1.3.1">bold-^</ci><ci id="S3.p2.17.m1.2.2.1.1.1.3.2.cmml" xref="S3.p2.17.m1.2.2.1.1.1.3.2">𝒙</ci></apply><list id="S3.p2.17.m1.2.2.1.1.1.1.2.cmml" xref="S3.p2.17.m1.2.2.1.1.1.1.1"><apply id="S3.p2.17.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.p2.17.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.17.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.p2.17.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.17.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.p2.17.m1.2.2.1.1.1.1.1.1.2">𝑿</ci><ci id="S3.p2.17.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.p2.17.m1.2.2.1.1.1.1.1.1.3">𝐷</ci></apply><ci id="S3.p2.17.m1.1.1.cmml" xref="S3.p2.17.m1.1.1">ℳ</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.17.m1.2c">\mathcal{P}(\bm{\hat{x}}|\bm{X}_{D};\mathcal{M})</annotation></semantics></math>, for each query <math id="S3.p2.18.m2.1" class="ltx_Math" alttext="\bm{\hat{x}}" display="inline"><semantics id="S3.p2.18.m2.1a"><mover accent="true" id="S3.p2.18.m2.1.1" xref="S3.p2.18.m2.1.1.cmml"><mi id="S3.p2.18.m2.1.1.2" xref="S3.p2.18.m2.1.1.2.cmml">𝒙</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.p2.18.m2.1.1.1" xref="S3.p2.18.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.p2.18.m2.1b"><apply id="S3.p2.18.m2.1.1.cmml" xref="S3.p2.18.m2.1.1"><ci id="S3.p2.18.m2.1.1.1.cmml" xref="S3.p2.18.m2.1.1.1">bold-^</ci><ci id="S3.p2.18.m2.1.1.2.cmml" xref="S3.p2.18.m2.1.1.2">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.18.m2.1c">\bm{\hat{x}}</annotation></semantics></math>, we randomly select <math id="S3.p2.19.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.p2.19.m3.1a"><mi id="S3.p2.19.m3.1.1" xref="S3.p2.19.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p2.19.m3.1b"><ci id="S3.p2.19.m3.1.1.cmml" xref="S3.p2.19.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.19.m3.1c">k</annotation></semantics></math> demonstrations to form <math id="S3.p2.20.m4.1" class="ltx_Math" alttext="\bm{X}_{D}" display="inline"><semantics id="S3.p2.20.m4.1a"><msub id="S3.p2.20.m4.1.1" xref="S3.p2.20.m4.1.1.cmml"><mi id="S3.p2.20.m4.1.1.2" xref="S3.p2.20.m4.1.1.2.cmml">𝑿</mi><mi id="S3.p2.20.m4.1.1.3" xref="S3.p2.20.m4.1.1.3.cmml">D</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.20.m4.1b"><apply id="S3.p2.20.m4.1.1.cmml" xref="S3.p2.20.m4.1.1"><csymbol cd="ambiguous" id="S3.p2.20.m4.1.1.1.cmml" xref="S3.p2.20.m4.1.1">subscript</csymbol><ci id="S3.p2.20.m4.1.1.2.cmml" xref="S3.p2.20.m4.1.1.2">𝑿</ci><ci id="S3.p2.20.m4.1.1.3.cmml" xref="S3.p2.20.m4.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.20.m4.1c">\bm{X}_{D}</annotation></semantics></math>. These are concatenated with the query to form the inputs for the model. The model’s output for the query is then considered as the shifted distribution <math id="S3.p2.21.m5.2" class="ltx_Math" alttext="\mathcal{P}(\bm{\hat{x}}|\bm{X}_{D};\mathcal{M})" display="inline"><semantics id="S3.p2.21.m5.2a"><mrow id="S3.p2.21.m5.2.2" xref="S3.p2.21.m5.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.21.m5.2.2.3" xref="S3.p2.21.m5.2.2.3.cmml">𝒫</mi><mo lspace="0em" rspace="0em" id="S3.p2.21.m5.2.2.2" xref="S3.p2.21.m5.2.2.2.cmml">​</mo><mrow id="S3.p2.21.m5.2.2.1.1" xref="S3.p2.21.m5.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.p2.21.m5.2.2.1.1.2" xref="S3.p2.21.m5.2.2.1.1.1.cmml">(</mo><mrow id="S3.p2.21.m5.2.2.1.1.1" xref="S3.p2.21.m5.2.2.1.1.1.cmml"><mover accent="true" id="S3.p2.21.m5.2.2.1.1.1.3" xref="S3.p2.21.m5.2.2.1.1.1.3.cmml"><mi id="S3.p2.21.m5.2.2.1.1.1.3.2" xref="S3.p2.21.m5.2.2.1.1.1.3.2.cmml">𝒙</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.p2.21.m5.2.2.1.1.1.3.1" xref="S3.p2.21.m5.2.2.1.1.1.3.1.cmml">^</mo></mover><mo fence="false" id="S3.p2.21.m5.2.2.1.1.1.2" xref="S3.p2.21.m5.2.2.1.1.1.2.cmml">|</mo><mrow id="S3.p2.21.m5.2.2.1.1.1.1.1" xref="S3.p2.21.m5.2.2.1.1.1.1.2.cmml"><msub id="S3.p2.21.m5.2.2.1.1.1.1.1.1" xref="S3.p2.21.m5.2.2.1.1.1.1.1.1.cmml"><mi id="S3.p2.21.m5.2.2.1.1.1.1.1.1.2" xref="S3.p2.21.m5.2.2.1.1.1.1.1.1.2.cmml">𝑿</mi><mi id="S3.p2.21.m5.2.2.1.1.1.1.1.1.3" xref="S3.p2.21.m5.2.2.1.1.1.1.1.1.3.cmml">D</mi></msub><mo id="S3.p2.21.m5.2.2.1.1.1.1.1.2" xref="S3.p2.21.m5.2.2.1.1.1.1.2.cmml">;</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.21.m5.1.1" xref="S3.p2.21.m5.1.1.cmml">ℳ</mi></mrow></mrow><mo stretchy="false" id="S3.p2.21.m5.2.2.1.1.3" xref="S3.p2.21.m5.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.21.m5.2b"><apply id="S3.p2.21.m5.2.2.cmml" xref="S3.p2.21.m5.2.2"><times id="S3.p2.21.m5.2.2.2.cmml" xref="S3.p2.21.m5.2.2.2"></times><ci id="S3.p2.21.m5.2.2.3.cmml" xref="S3.p2.21.m5.2.2.3">𝒫</ci><apply id="S3.p2.21.m5.2.2.1.1.1.cmml" xref="S3.p2.21.m5.2.2.1.1"><csymbol cd="latexml" id="S3.p2.21.m5.2.2.1.1.1.2.cmml" xref="S3.p2.21.m5.2.2.1.1.1.2">conditional</csymbol><apply id="S3.p2.21.m5.2.2.1.1.1.3.cmml" xref="S3.p2.21.m5.2.2.1.1.1.3"><ci id="S3.p2.21.m5.2.2.1.1.1.3.1.cmml" xref="S3.p2.21.m5.2.2.1.1.1.3.1">bold-^</ci><ci id="S3.p2.21.m5.2.2.1.1.1.3.2.cmml" xref="S3.p2.21.m5.2.2.1.1.1.3.2">𝒙</ci></apply><list id="S3.p2.21.m5.2.2.1.1.1.1.2.cmml" xref="S3.p2.21.m5.2.2.1.1.1.1.1"><apply id="S3.p2.21.m5.2.2.1.1.1.1.1.1.cmml" xref="S3.p2.21.m5.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.21.m5.2.2.1.1.1.1.1.1.1.cmml" xref="S3.p2.21.m5.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.21.m5.2.2.1.1.1.1.1.1.2.cmml" xref="S3.p2.21.m5.2.2.1.1.1.1.1.1.2">𝑿</ci><ci id="S3.p2.21.m5.2.2.1.1.1.1.1.1.3.cmml" xref="S3.p2.21.m5.2.2.1.1.1.1.1.1.3">𝐷</ci></apply><ci id="S3.p2.21.m5.1.1.cmml" xref="S3.p2.21.m5.1.1">ℳ</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.21.m5.2c">\mathcal{P}(\bm{\hat{x}}|\bm{X}_{D};\mathcal{M})</annotation></semantics></math>.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.7" class="ltx_p">To obtain the output of <math id="S3.p3.1.m1.1" class="ltx_Math" alttext="\bm{\hat{x}}" display="inline"><semantics id="S3.p3.1.m1.1a"><mover accent="true" id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml"><mi id="S3.p3.1.m1.1.1.2" xref="S3.p3.1.m1.1.1.2.cmml">𝒙</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.p3.1.m1.1.1.1" xref="S3.p3.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><apply id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1"><ci id="S3.p3.1.m1.1.1.1.cmml" xref="S3.p3.1.m1.1.1.1">bold-^</ci><ci id="S3.p3.1.m1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.2">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">\bm{\hat{x}}</annotation></semantics></math> by using L-ICV, at the <math id="S3.p3.2.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.p3.2.m2.1a"><mi id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><ci id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">l</annotation></semantics></math>-th layer, we use the vector <math id="S3.p3.3.m3.1" class="ltx_Math" alttext="\bm{v}_{l}" display="inline"><semantics id="S3.p3.3.m3.1a"><msub id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml"><mi id="S3.p3.3.m3.1.1.2" xref="S3.p3.3.m3.1.1.2.cmml">𝒗</mi><mi id="S3.p3.3.m3.1.1.3" xref="S3.p3.3.m3.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><apply id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.1.cmml" xref="S3.p3.3.m3.1.1">subscript</csymbol><ci id="S3.p3.3.m3.1.1.2.cmml" xref="S3.p3.3.m3.1.1.2">𝒗</ci><ci id="S3.p3.3.m3.1.1.3.cmml" xref="S3.p3.3.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">\bm{v}_{l}</annotation></semantics></math> to shift original representation and get: <math id="S3.p3.4.m4.2" class="ltx_Math" alttext="h(\hat{x}_{i})^{\prime}=h(\hat{x}_{i})+\alpha_{l}\bm{v}_{l}" display="inline"><semantics id="S3.p3.4.m4.2a"><mrow id="S3.p3.4.m4.2.2" xref="S3.p3.4.m4.2.2.cmml"><mrow id="S3.p3.4.m4.1.1.1" xref="S3.p3.4.m4.1.1.1.cmml"><mi id="S3.p3.4.m4.1.1.1.3" xref="S3.p3.4.m4.1.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.p3.4.m4.1.1.1.2" xref="S3.p3.4.m4.1.1.1.2.cmml">​</mo><msup id="S3.p3.4.m4.1.1.1.1" xref="S3.p3.4.m4.1.1.1.1.cmml"><mrow id="S3.p3.4.m4.1.1.1.1.1.1" xref="S3.p3.4.m4.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p3.4.m4.1.1.1.1.1.1.2" xref="S3.p3.4.m4.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.p3.4.m4.1.1.1.1.1.1.1" xref="S3.p3.4.m4.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.p3.4.m4.1.1.1.1.1.1.1.2" xref="S3.p3.4.m4.1.1.1.1.1.1.1.2.cmml"><mi id="S3.p3.4.m4.1.1.1.1.1.1.1.2.2" xref="S3.p3.4.m4.1.1.1.1.1.1.1.2.2.cmml">x</mi><mo id="S3.p3.4.m4.1.1.1.1.1.1.1.2.1" xref="S3.p3.4.m4.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.p3.4.m4.1.1.1.1.1.1.1.3" xref="S3.p3.4.m4.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.p3.4.m4.1.1.1.1.1.1.3" xref="S3.p3.4.m4.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.p3.4.m4.1.1.1.1.3" xref="S3.p3.4.m4.1.1.1.1.3.cmml">′</mo></msup></mrow><mo id="S3.p3.4.m4.2.2.3" xref="S3.p3.4.m4.2.2.3.cmml">=</mo><mrow id="S3.p3.4.m4.2.2.2" xref="S3.p3.4.m4.2.2.2.cmml"><mrow id="S3.p3.4.m4.2.2.2.1" xref="S3.p3.4.m4.2.2.2.1.cmml"><mi id="S3.p3.4.m4.2.2.2.1.3" xref="S3.p3.4.m4.2.2.2.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.p3.4.m4.2.2.2.1.2" xref="S3.p3.4.m4.2.2.2.1.2.cmml">​</mo><mrow id="S3.p3.4.m4.2.2.2.1.1.1" xref="S3.p3.4.m4.2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.p3.4.m4.2.2.2.1.1.1.2" xref="S3.p3.4.m4.2.2.2.1.1.1.1.cmml">(</mo><msub id="S3.p3.4.m4.2.2.2.1.1.1.1" xref="S3.p3.4.m4.2.2.2.1.1.1.1.cmml"><mover accent="true" id="S3.p3.4.m4.2.2.2.1.1.1.1.2" xref="S3.p3.4.m4.2.2.2.1.1.1.1.2.cmml"><mi id="S3.p3.4.m4.2.2.2.1.1.1.1.2.2" xref="S3.p3.4.m4.2.2.2.1.1.1.1.2.2.cmml">x</mi><mo id="S3.p3.4.m4.2.2.2.1.1.1.1.2.1" xref="S3.p3.4.m4.2.2.2.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.p3.4.m4.2.2.2.1.1.1.1.3" xref="S3.p3.4.m4.2.2.2.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.p3.4.m4.2.2.2.1.1.1.3" xref="S3.p3.4.m4.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.p3.4.m4.2.2.2.2" xref="S3.p3.4.m4.2.2.2.2.cmml">+</mo><mrow id="S3.p3.4.m4.2.2.2.3" xref="S3.p3.4.m4.2.2.2.3.cmml"><msub id="S3.p3.4.m4.2.2.2.3.2" xref="S3.p3.4.m4.2.2.2.3.2.cmml"><mi id="S3.p3.4.m4.2.2.2.3.2.2" xref="S3.p3.4.m4.2.2.2.3.2.2.cmml">α</mi><mi id="S3.p3.4.m4.2.2.2.3.2.3" xref="S3.p3.4.m4.2.2.2.3.2.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.p3.4.m4.2.2.2.3.1" xref="S3.p3.4.m4.2.2.2.3.1.cmml">​</mo><msub id="S3.p3.4.m4.2.2.2.3.3" xref="S3.p3.4.m4.2.2.2.3.3.cmml"><mi id="S3.p3.4.m4.2.2.2.3.3.2" xref="S3.p3.4.m4.2.2.2.3.3.2.cmml">𝒗</mi><mi id="S3.p3.4.m4.2.2.2.3.3.3" xref="S3.p3.4.m4.2.2.2.3.3.3.cmml">l</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.2b"><apply id="S3.p3.4.m4.2.2.cmml" xref="S3.p3.4.m4.2.2"><eq id="S3.p3.4.m4.2.2.3.cmml" xref="S3.p3.4.m4.2.2.3"></eq><apply id="S3.p3.4.m4.1.1.1.cmml" xref="S3.p3.4.m4.1.1.1"><times id="S3.p3.4.m4.1.1.1.2.cmml" xref="S3.p3.4.m4.1.1.1.2"></times><ci id="S3.p3.4.m4.1.1.1.3.cmml" xref="S3.p3.4.m4.1.1.1.3">ℎ</ci><apply id="S3.p3.4.m4.1.1.1.1.cmml" xref="S3.p3.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.4.m4.1.1.1.1.2.cmml" xref="S3.p3.4.m4.1.1.1.1">superscript</csymbol><apply id="S3.p3.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.p3.4.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.4.m4.1.1.1.1.1.1.1.1.cmml" xref="S3.p3.4.m4.1.1.1.1.1.1">subscript</csymbol><apply id="S3.p3.4.m4.1.1.1.1.1.1.1.2.cmml" xref="S3.p3.4.m4.1.1.1.1.1.1.1.2"><ci id="S3.p3.4.m4.1.1.1.1.1.1.1.2.1.cmml" xref="S3.p3.4.m4.1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.p3.4.m4.1.1.1.1.1.1.1.2.2.cmml" xref="S3.p3.4.m4.1.1.1.1.1.1.1.2.2">𝑥</ci></apply><ci id="S3.p3.4.m4.1.1.1.1.1.1.1.3.cmml" xref="S3.p3.4.m4.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.p3.4.m4.1.1.1.1.3.cmml" xref="S3.p3.4.m4.1.1.1.1.3">′</ci></apply></apply><apply id="S3.p3.4.m4.2.2.2.cmml" xref="S3.p3.4.m4.2.2.2"><plus id="S3.p3.4.m4.2.2.2.2.cmml" xref="S3.p3.4.m4.2.2.2.2"></plus><apply id="S3.p3.4.m4.2.2.2.1.cmml" xref="S3.p3.4.m4.2.2.2.1"><times id="S3.p3.4.m4.2.2.2.1.2.cmml" xref="S3.p3.4.m4.2.2.2.1.2"></times><ci id="S3.p3.4.m4.2.2.2.1.3.cmml" xref="S3.p3.4.m4.2.2.2.1.3">ℎ</ci><apply id="S3.p3.4.m4.2.2.2.1.1.1.1.cmml" xref="S3.p3.4.m4.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p3.4.m4.2.2.2.1.1.1.1.1.cmml" xref="S3.p3.4.m4.2.2.2.1.1.1">subscript</csymbol><apply id="S3.p3.4.m4.2.2.2.1.1.1.1.2.cmml" xref="S3.p3.4.m4.2.2.2.1.1.1.1.2"><ci id="S3.p3.4.m4.2.2.2.1.1.1.1.2.1.cmml" xref="S3.p3.4.m4.2.2.2.1.1.1.1.2.1">^</ci><ci id="S3.p3.4.m4.2.2.2.1.1.1.1.2.2.cmml" xref="S3.p3.4.m4.2.2.2.1.1.1.1.2.2">𝑥</ci></apply><ci id="S3.p3.4.m4.2.2.2.1.1.1.1.3.cmml" xref="S3.p3.4.m4.2.2.2.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.p3.4.m4.2.2.2.3.cmml" xref="S3.p3.4.m4.2.2.2.3"><times id="S3.p3.4.m4.2.2.2.3.1.cmml" xref="S3.p3.4.m4.2.2.2.3.1"></times><apply id="S3.p3.4.m4.2.2.2.3.2.cmml" xref="S3.p3.4.m4.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.p3.4.m4.2.2.2.3.2.1.cmml" xref="S3.p3.4.m4.2.2.2.3.2">subscript</csymbol><ci id="S3.p3.4.m4.2.2.2.3.2.2.cmml" xref="S3.p3.4.m4.2.2.2.3.2.2">𝛼</ci><ci id="S3.p3.4.m4.2.2.2.3.2.3.cmml" xref="S3.p3.4.m4.2.2.2.3.2.3">𝑙</ci></apply><apply id="S3.p3.4.m4.2.2.2.3.3.cmml" xref="S3.p3.4.m4.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.p3.4.m4.2.2.2.3.3.1.cmml" xref="S3.p3.4.m4.2.2.2.3.3">subscript</csymbol><ci id="S3.p3.4.m4.2.2.2.3.3.2.cmml" xref="S3.p3.4.m4.2.2.2.3.3.2">𝒗</ci><ci id="S3.p3.4.m4.2.2.2.3.3.3.cmml" xref="S3.p3.4.m4.2.2.2.3.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.2c">h(\hat{x}_{i})^{\prime}=h(\hat{x}_{i})+\alpha_{l}\bm{v}_{l}</annotation></semantics></math>, which is shown in Figure <a href="#S2.F2" title="Figure 2 ‣ 2 Related Work ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(a). After applying L-ICV to shift the representations at each layer, we obtain the output distribution <math id="S3.p3.5.m5.4" class="ltx_Math" alttext="\mathcal{P}(\bm{\hat{x}}|\bm{V},\bm{\alpha};\mathcal{M})" display="inline"><semantics id="S3.p3.5.m5.4a"><mrow id="S3.p3.5.m5.4.4" xref="S3.p3.5.m5.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.5.m5.4.4.3" xref="S3.p3.5.m5.4.4.3.cmml">𝒫</mi><mo lspace="0em" rspace="0em" id="S3.p3.5.m5.4.4.2" xref="S3.p3.5.m5.4.4.2.cmml">​</mo><mrow id="S3.p3.5.m5.4.4.1.1" xref="S3.p3.5.m5.4.4.1.1.1.cmml"><mo stretchy="false" id="S3.p3.5.m5.4.4.1.1.2" xref="S3.p3.5.m5.4.4.1.1.1.cmml">(</mo><mrow id="S3.p3.5.m5.4.4.1.1.1" xref="S3.p3.5.m5.4.4.1.1.1.cmml"><mover accent="true" id="S3.p3.5.m5.4.4.1.1.1.2" xref="S3.p3.5.m5.4.4.1.1.1.2.cmml"><mi id="S3.p3.5.m5.4.4.1.1.1.2.2" xref="S3.p3.5.m5.4.4.1.1.1.2.2.cmml">𝒙</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.p3.5.m5.4.4.1.1.1.2.1" xref="S3.p3.5.m5.4.4.1.1.1.2.1.cmml">^</mo></mover><mo fence="false" id="S3.p3.5.m5.4.4.1.1.1.1" xref="S3.p3.5.m5.4.4.1.1.1.1.cmml">|</mo><mrow id="S3.p3.5.m5.4.4.1.1.1.3.2" xref="S3.p3.5.m5.4.4.1.1.1.3.1.cmml"><mi id="S3.p3.5.m5.1.1" xref="S3.p3.5.m5.1.1.cmml">𝑽</mi><mo id="S3.p3.5.m5.4.4.1.1.1.3.2.1" xref="S3.p3.5.m5.4.4.1.1.1.3.1.cmml">,</mo><mi id="S3.p3.5.m5.2.2" xref="S3.p3.5.m5.2.2.cmml">𝜶</mi><mo id="S3.p3.5.m5.4.4.1.1.1.3.2.2" xref="S3.p3.5.m5.4.4.1.1.1.3.1.cmml">;</mo><mi class="ltx_font_mathcaligraphic" id="S3.p3.5.m5.3.3" xref="S3.p3.5.m5.3.3.cmml">ℳ</mi></mrow></mrow><mo stretchy="false" id="S3.p3.5.m5.4.4.1.1.3" xref="S3.p3.5.m5.4.4.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.5.m5.4b"><apply id="S3.p3.5.m5.4.4.cmml" xref="S3.p3.5.m5.4.4"><times id="S3.p3.5.m5.4.4.2.cmml" xref="S3.p3.5.m5.4.4.2"></times><ci id="S3.p3.5.m5.4.4.3.cmml" xref="S3.p3.5.m5.4.4.3">𝒫</ci><apply id="S3.p3.5.m5.4.4.1.1.1.cmml" xref="S3.p3.5.m5.4.4.1.1"><csymbol cd="latexml" id="S3.p3.5.m5.4.4.1.1.1.1.cmml" xref="S3.p3.5.m5.4.4.1.1.1.1">conditional</csymbol><apply id="S3.p3.5.m5.4.4.1.1.1.2.cmml" xref="S3.p3.5.m5.4.4.1.1.1.2"><ci id="S3.p3.5.m5.4.4.1.1.1.2.1.cmml" xref="S3.p3.5.m5.4.4.1.1.1.2.1">bold-^</ci><ci id="S3.p3.5.m5.4.4.1.1.1.2.2.cmml" xref="S3.p3.5.m5.4.4.1.1.1.2.2">𝒙</ci></apply><list id="S3.p3.5.m5.4.4.1.1.1.3.1.cmml" xref="S3.p3.5.m5.4.4.1.1.1.3.2"><ci id="S3.p3.5.m5.1.1.cmml" xref="S3.p3.5.m5.1.1">𝑽</ci><ci id="S3.p3.5.m5.2.2.cmml" xref="S3.p3.5.m5.2.2">𝜶</ci><ci id="S3.p3.5.m5.3.3.cmml" xref="S3.p3.5.m5.3.3">ℳ</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.5.m5.4c">\mathcal{P}(\bm{\hat{x}}|\bm{V},\bm{\alpha};\mathcal{M})</annotation></semantics></math>. Notably, during training, <math id="S3.p3.6.m6.1" class="ltx_Math" alttext="\bm{X}_{D}" display="inline"><semantics id="S3.p3.6.m6.1a"><msub id="S3.p3.6.m6.1.1" xref="S3.p3.6.m6.1.1.cmml"><mi id="S3.p3.6.m6.1.1.2" xref="S3.p3.6.m6.1.1.2.cmml">𝑿</mi><mi id="S3.p3.6.m6.1.1.3" xref="S3.p3.6.m6.1.1.3.cmml">D</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.6.m6.1b"><apply id="S3.p3.6.m6.1.1.cmml" xref="S3.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p3.6.m6.1.1.1.cmml" xref="S3.p3.6.m6.1.1">subscript</csymbol><ci id="S3.p3.6.m6.1.1.2.cmml" xref="S3.p3.6.m6.1.1.2">𝑿</ci><ci id="S3.p3.6.m6.1.1.3.cmml" xref="S3.p3.6.m6.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.6.m6.1c">\bm{X}_{D}</annotation></semantics></math> for each query <math id="S3.p3.7.m7.1" class="ltx_Math" alttext="\hat{\bm{x}}" display="inline"><semantics id="S3.p3.7.m7.1a"><mover accent="true" id="S3.p3.7.m7.1.1" xref="S3.p3.7.m7.1.1.cmml"><mi id="S3.p3.7.m7.1.1.2" xref="S3.p3.7.m7.1.1.2.cmml">𝒙</mi><mo id="S3.p3.7.m7.1.1.1" xref="S3.p3.7.m7.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.p3.7.m7.1b"><apply id="S3.p3.7.m7.1.1.cmml" xref="S3.p3.7.m7.1.1"><ci id="S3.p3.7.m7.1.1.1.cmml" xref="S3.p3.7.m7.1.1.1">^</ci><ci id="S3.p3.7.m7.1.1.2.cmml" xref="S3.p3.7.m7.1.1.2">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.7.m7.1c">\hat{\bm{x}}</annotation></semantics></math> includes randomly sampled 32-shot demonstrations. This strategy encourages our L-ICV to extract the most useful common information from various demonstration combinations and prevents it from being influenced by the individual characteristics of certain demonstrations.</p>
</div>
<div id="S3.p4" class="ltx_para">
<p id="S3.p4.3" class="ltx_p">In addition, to facilitate the L-ICV in acquiring more task-specific information, we also optimize the <math id="S3.p4.1.m1.4" class="ltx_Math" alttext="\mathcal{P}(\bm{\hat{x}}|\bm{V},\bm{\alpha};\mathcal{M})" display="inline"><semantics id="S3.p4.1.m1.4a"><mrow id="S3.p4.1.m1.4.4" xref="S3.p4.1.m1.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p4.1.m1.4.4.3" xref="S3.p4.1.m1.4.4.3.cmml">𝒫</mi><mo lspace="0em" rspace="0em" id="S3.p4.1.m1.4.4.2" xref="S3.p4.1.m1.4.4.2.cmml">​</mo><mrow id="S3.p4.1.m1.4.4.1.1" xref="S3.p4.1.m1.4.4.1.1.1.cmml"><mo stretchy="false" id="S3.p4.1.m1.4.4.1.1.2" xref="S3.p4.1.m1.4.4.1.1.1.cmml">(</mo><mrow id="S3.p4.1.m1.4.4.1.1.1" xref="S3.p4.1.m1.4.4.1.1.1.cmml"><mover accent="true" id="S3.p4.1.m1.4.4.1.1.1.2" xref="S3.p4.1.m1.4.4.1.1.1.2.cmml"><mi id="S3.p4.1.m1.4.4.1.1.1.2.2" xref="S3.p4.1.m1.4.4.1.1.1.2.2.cmml">𝒙</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.p4.1.m1.4.4.1.1.1.2.1" xref="S3.p4.1.m1.4.4.1.1.1.2.1.cmml">^</mo></mover><mo fence="false" id="S3.p4.1.m1.4.4.1.1.1.1" xref="S3.p4.1.m1.4.4.1.1.1.1.cmml">|</mo><mrow id="S3.p4.1.m1.4.4.1.1.1.3.2" xref="S3.p4.1.m1.4.4.1.1.1.3.1.cmml"><mi id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml">𝑽</mi><mo id="S3.p4.1.m1.4.4.1.1.1.3.2.1" xref="S3.p4.1.m1.4.4.1.1.1.3.1.cmml">,</mo><mi id="S3.p4.1.m1.2.2" xref="S3.p4.1.m1.2.2.cmml">𝜶</mi><mo id="S3.p4.1.m1.4.4.1.1.1.3.2.2" xref="S3.p4.1.m1.4.4.1.1.1.3.1.cmml">;</mo><mi class="ltx_font_mathcaligraphic" id="S3.p4.1.m1.3.3" xref="S3.p4.1.m1.3.3.cmml">ℳ</mi></mrow></mrow><mo stretchy="false" id="S3.p4.1.m1.4.4.1.1.3" xref="S3.p4.1.m1.4.4.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.4b"><apply id="S3.p4.1.m1.4.4.cmml" xref="S3.p4.1.m1.4.4"><times id="S3.p4.1.m1.4.4.2.cmml" xref="S3.p4.1.m1.4.4.2"></times><ci id="S3.p4.1.m1.4.4.3.cmml" xref="S3.p4.1.m1.4.4.3">𝒫</ci><apply id="S3.p4.1.m1.4.4.1.1.1.cmml" xref="S3.p4.1.m1.4.4.1.1"><csymbol cd="latexml" id="S3.p4.1.m1.4.4.1.1.1.1.cmml" xref="S3.p4.1.m1.4.4.1.1.1.1">conditional</csymbol><apply id="S3.p4.1.m1.4.4.1.1.1.2.cmml" xref="S3.p4.1.m1.4.4.1.1.1.2"><ci id="S3.p4.1.m1.4.4.1.1.1.2.1.cmml" xref="S3.p4.1.m1.4.4.1.1.1.2.1">bold-^</ci><ci id="S3.p4.1.m1.4.4.1.1.1.2.2.cmml" xref="S3.p4.1.m1.4.4.1.1.1.2.2">𝒙</ci></apply><list id="S3.p4.1.m1.4.4.1.1.1.3.1.cmml" xref="S3.p4.1.m1.4.4.1.1.1.3.2"><ci id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1">𝑽</ci><ci id="S3.p4.1.m1.2.2.cmml" xref="S3.p4.1.m1.2.2">𝜶</ci><ci id="S3.p4.1.m1.3.3.cmml" xref="S3.p4.1.m1.3.3">ℳ</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.4c">\mathcal{P}(\bm{\hat{x}}|\bm{V},\bm{\alpha};\mathcal{M})</annotation></semantics></math> with the ground truth by <math id="S3.p4.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{\text{gt }}" display="inline"><semantics id="S3.p4.2.m2.1a"><msub id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p4.2.m2.1.1.2" xref="S3.p4.2.m2.1.1.2.cmml">ℒ</mi><mtext id="S3.p4.2.m2.1.1.3" xref="S3.p4.2.m2.1.1.3a.cmml">gt </mtext></msub><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.1b"><apply id="S3.p4.2.m2.1.1.cmml" xref="S3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p4.2.m2.1.1.1.cmml" xref="S3.p4.2.m2.1.1">subscript</csymbol><ci id="S3.p4.2.m2.1.1.2.cmml" xref="S3.p4.2.m2.1.1.2">ℒ</ci><ci id="S3.p4.2.m2.1.1.3a.cmml" xref="S3.p4.2.m2.1.1.3"><mtext mathsize="70%" id="S3.p4.2.m2.1.1.3.cmml" xref="S3.p4.2.m2.1.1.3">gt </mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.1c">\mathcal{L}_{\text{gt }}</annotation></semantics></math>. Thus, the overall loss <math id="S3.p4.3.m3.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S3.p4.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p4.3.m3.1.1" xref="S3.p4.3.m3.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.p4.3.m3.1b"><ci id="S3.p4.3.m3.1.1.cmml" xref="S3.p4.3.m3.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.m3.1c">\mathcal{L}</annotation></semantics></math> is defined as:</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.32" class="ltx_Math" alttext="\begin{gathered}\mathcal{L}=\lambda\mathcal{L}_{\text{gt}}+\mathcal{L}_{\text{d }},\\
\text{where}~{}~{}\mathcal{L}_{\text{gt }}=-\sum_{i}\log\mathcal{P}\left(\hat{x}_{i}\mid\bm{V},\bm{\alpha};\mathcal{M}\right).\end{gathered}" display="block"><semantics id="S3.E7.m1.32a"><mtable displaystyle="true" rowspacing="0pt" id="S3.E7.m1.32.32.3"><mtr id="S3.E7.m1.32.32.3a"><mtd id="S3.E7.m1.32.32.3b"><mrow id="S3.E7.m1.31.31.2.30.10.10.10"><mrow id="S3.E7.m1.31.31.2.30.10.10.10.1"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.cmml">ℒ</mi><mo id="S3.E7.m1.2.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.2.2.cmml">=</mo><mrow id="S3.E7.m1.31.31.2.30.10.10.10.1.1"><mrow id="S3.E7.m1.31.31.2.30.10.10.10.1.1.1"><mi id="S3.E7.m1.3.3.3.3.3.3" xref="S3.E7.m1.3.3.3.3.3.3.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.31.31.2.30.10.10.10.1.1.1.1">​</mo><msub id="S3.E7.m1.31.31.2.30.10.10.10.1.1.1.2"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.4.4.4.4.4.4" xref="S3.E7.m1.4.4.4.4.4.4.cmml">ℒ</mi><mtext id="S3.E7.m1.5.5.5.5.5.5.1" xref="S3.E7.m1.5.5.5.5.5.5.1a.cmml">gt</mtext></msub></mrow><mo id="S3.E7.m1.6.6.6.6.6.6" xref="S3.E7.m1.6.6.6.6.6.6.cmml">+</mo><msub id="S3.E7.m1.31.31.2.30.10.10.10.1.1.2"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.7.7.7.7.7.7" xref="S3.E7.m1.7.7.7.7.7.7.cmml">ℒ</mi><mtext id="S3.E7.m1.8.8.8.8.8.8.1" xref="S3.E7.m1.8.8.8.8.8.8.1a.cmml">d </mtext></msub></mrow></mrow><mo id="S3.E7.m1.9.9.9.9.9.9">,</mo></mrow></mtd></mtr><mtr id="S3.E7.m1.32.32.3c"><mtd id="S3.E7.m1.32.32.3d"><mrow id="S3.E7.m1.32.32.3.31.21.21.21"><mrow id="S3.E7.m1.32.32.3.31.21.21.21.1"><mrow id="S3.E7.m1.32.32.3.31.21.21.21.1.2"><mtext id="S3.E7.m1.10.10.10.1.1.1" xref="S3.E7.m1.10.10.10.1.1.1a.cmml">where</mtext><mo lspace="0.660em" rspace="0em" id="S3.E7.m1.32.32.3.31.21.21.21.1.2.1">​</mo><msub id="S3.E7.m1.32.32.3.31.21.21.21.1.2.2"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.11.11.11.2.2.2" xref="S3.E7.m1.11.11.11.2.2.2.cmml">ℒ</mi><mtext id="S3.E7.m1.12.12.12.3.3.3.1" xref="S3.E7.m1.12.12.12.3.3.3.1a.cmml">gt </mtext></msub></mrow><mo id="S3.E7.m1.13.13.13.4.4.4" xref="S3.E7.m1.13.13.13.4.4.4.cmml">=</mo><mrow id="S3.E7.m1.32.32.3.31.21.21.21.1.1"><mo id="S3.E7.m1.32.32.3.31.21.21.21.1.1a">−</mo><mrow id="S3.E7.m1.32.32.3.31.21.21.21.1.1.1"><munder id="S3.E7.m1.32.32.3.31.21.21.21.1.1.1.2"><mo movablelimits="false" id="S3.E7.m1.15.15.15.6.6.6" xref="S3.E7.m1.15.15.15.6.6.6.cmml">∑</mo><mi id="S3.E7.m1.16.16.16.7.7.7.1" xref="S3.E7.m1.16.16.16.7.7.7.1.cmml">i</mi></munder><mrow id="S3.E7.m1.32.32.3.31.21.21.21.1.1.1.1"><mrow id="S3.E7.m1.32.32.3.31.21.21.21.1.1.1.1.3"><mi id="S3.E7.m1.17.17.17.8.8.8" xref="S3.E7.m1.17.17.17.8.8.8.cmml">log</mi><mo lspace="0.167em" id="S3.E7.m1.32.32.3.31.21.21.21.1.1.1.1.3a">⁡</mo><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.18.18.18.9.9.9" xref="S3.E7.m1.18.18.18.9.9.9.cmml">𝒫</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E7.m1.32.32.3.31.21.21.21.1.1.1.1.2">​</mo><mrow id="S3.E7.m1.32.32.3.31.21.21.21.1.1.1.1.1.1"><mo id="S3.E7.m1.19.19.19.10.10.10">(</mo><mrow id="S3.E7.m1.32.32.3.31.21.21.21.1.1.1.1.1.1.1"><msub id="S3.E7.m1.32.32.3.31.21.21.21.1.1.1.1.1.1.1.1"><mover accent="true" id="S3.E7.m1.20.20.20.11.11.11" xref="S3.E7.m1.20.20.20.11.11.11.cmml"><mi id="S3.E7.m1.20.20.20.11.11.11.2" xref="S3.E7.m1.20.20.20.11.11.11.2.cmml">x</mi><mo id="S3.E7.m1.20.20.20.11.11.11.1" xref="S3.E7.m1.20.20.20.11.11.11.1.cmml">^</mo></mover><mi id="S3.E7.m1.21.21.21.12.12.12.1" xref="S3.E7.m1.21.21.21.12.12.12.1.cmml">i</mi></msub><mo id="S3.E7.m1.22.22.22.13.13.13" xref="S3.E7.m1.22.22.22.13.13.13.cmml">∣</mo><mrow id="S3.E7.m1.32.32.3.31.21.21.21.1.1.1.1.1.1.1.2"><mi id="S3.E7.m1.23.23.23.14.14.14" xref="S3.E7.m1.23.23.23.14.14.14.cmml">𝑽</mi><mo id="S3.E7.m1.24.24.24.15.15.15">,</mo><mi id="S3.E7.m1.25.25.25.16.16.16" xref="S3.E7.m1.25.25.25.16.16.16.cmml">𝜶</mi><mo id="S3.E7.m1.26.26.26.17.17.17">;</mo><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.27.27.27.18.18.18" xref="S3.E7.m1.27.27.27.18.18.18.cmml">ℳ</mi></mrow></mrow><mo id="S3.E7.m1.28.28.28.19.19.19">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E7.m1.29.29.29.20.20.20">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E7.m1.32b"><apply id="S3.E7.m1.30.30.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S3.E7.m1.30.30.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S3.E7.m1.30.30.1.1.1.1.1.cmml"><eq id="S3.E7.m1.2.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2"></eq><ci id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1">ℒ</ci><apply id="S3.E7.m1.30.30.1.1.1.1.1.3.cmml"><plus id="S3.E7.m1.6.6.6.6.6.6.cmml" xref="S3.E7.m1.6.6.6.6.6.6"></plus><apply id="S3.E7.m1.30.30.1.1.1.1.1.3.2.cmml"><times id="S3.E7.m1.30.30.1.1.1.1.1.3.2.1.cmml"></times><ci id="S3.E7.m1.3.3.3.3.3.3.cmml" xref="S3.E7.m1.3.3.3.3.3.3">𝜆</ci><apply id="S3.E7.m1.30.30.1.1.1.1.1.3.2.3.cmml"><csymbol cd="ambiguous" id="S3.E7.m1.30.30.1.1.1.1.1.3.2.3.1.cmml">subscript</csymbol><ci id="S3.E7.m1.4.4.4.4.4.4.cmml" xref="S3.E7.m1.4.4.4.4.4.4">ℒ</ci><ci id="S3.E7.m1.5.5.5.5.5.5.1a.cmml" xref="S3.E7.m1.5.5.5.5.5.5.1"><mtext mathsize="70%" id="S3.E7.m1.5.5.5.5.5.5.1.cmml" xref="S3.E7.m1.5.5.5.5.5.5.1">gt</mtext></ci></apply></apply><apply id="S3.E7.m1.30.30.1.1.1.1.1.3.3.cmml"><csymbol cd="ambiguous" id="S3.E7.m1.30.30.1.1.1.1.1.3.3.1.cmml">subscript</csymbol><ci id="S3.E7.m1.7.7.7.7.7.7.cmml" xref="S3.E7.m1.7.7.7.7.7.7">ℒ</ci><ci id="S3.E7.m1.8.8.8.8.8.8.1a.cmml" xref="S3.E7.m1.8.8.8.8.8.8.1"><mtext mathsize="70%" id="S3.E7.m1.8.8.8.8.8.8.1.cmml" xref="S3.E7.m1.8.8.8.8.8.8.1">d </mtext></ci></apply></apply></apply><apply id="S3.E7.m1.30.30.1.1.1.2.2.cmml"><eq id="S3.E7.m1.13.13.13.4.4.4.cmml" xref="S3.E7.m1.13.13.13.4.4.4"></eq><apply id="S3.E7.m1.30.30.1.1.1.2.2.3.cmml"><times id="S3.E7.m1.30.30.1.1.1.2.2.3.1.cmml"></times><ci id="S3.E7.m1.10.10.10.1.1.1a.cmml" xref="S3.E7.m1.10.10.10.1.1.1"><mtext id="S3.E7.m1.10.10.10.1.1.1.cmml" xref="S3.E7.m1.10.10.10.1.1.1">where</mtext></ci><apply id="S3.E7.m1.30.30.1.1.1.2.2.3.3.cmml"><csymbol cd="ambiguous" id="S3.E7.m1.30.30.1.1.1.2.2.3.3.1.cmml">subscript</csymbol><ci id="S3.E7.m1.11.11.11.2.2.2.cmml" xref="S3.E7.m1.11.11.11.2.2.2">ℒ</ci><ci id="S3.E7.m1.12.12.12.3.3.3.1a.cmml" xref="S3.E7.m1.12.12.12.3.3.3.1"><mtext mathsize="70%" id="S3.E7.m1.12.12.12.3.3.3.1.cmml" xref="S3.E7.m1.12.12.12.3.3.3.1">gt </mtext></ci></apply></apply><apply id="S3.E7.m1.30.30.1.1.1.2.2.1.cmml"><minus id="S3.E7.m1.14.14.14.5.5.5.cmml"></minus><apply id="S3.E7.m1.30.30.1.1.1.2.2.1.1.cmml"><apply id="S3.E7.m1.30.30.1.1.1.2.2.1.1.2.cmml"><csymbol cd="ambiguous" id="S3.E7.m1.30.30.1.1.1.2.2.1.1.2.1.cmml">subscript</csymbol><sum id="S3.E7.m1.15.15.15.6.6.6.cmml" xref="S3.E7.m1.15.15.15.6.6.6"></sum><ci id="S3.E7.m1.16.16.16.7.7.7.1.cmml" xref="S3.E7.m1.16.16.16.7.7.7.1">𝑖</ci></apply><apply id="S3.E7.m1.30.30.1.1.1.2.2.1.1.1.cmml"><times id="S3.E7.m1.30.30.1.1.1.2.2.1.1.1.2.cmml"></times><apply id="S3.E7.m1.30.30.1.1.1.2.2.1.1.1.3.cmml"><log id="S3.E7.m1.17.17.17.8.8.8.cmml" xref="S3.E7.m1.17.17.17.8.8.8"></log><ci id="S3.E7.m1.18.18.18.9.9.9.cmml" xref="S3.E7.m1.18.18.18.9.9.9">𝒫</ci></apply><apply id="S3.E7.m1.30.30.1.1.1.2.2.1.1.1.1.1.1.cmml"><csymbol cd="latexml" id="S3.E7.m1.22.22.22.13.13.13.cmml" xref="S3.E7.m1.22.22.22.13.13.13">conditional</csymbol><apply id="S3.E7.m1.30.30.1.1.1.2.2.1.1.1.1.1.1.2.cmml"><csymbol cd="ambiguous" id="S3.E7.m1.30.30.1.1.1.2.2.1.1.1.1.1.1.2.1.cmml">subscript</csymbol><apply id="S3.E7.m1.20.20.20.11.11.11.cmml" xref="S3.E7.m1.20.20.20.11.11.11"><ci id="S3.E7.m1.20.20.20.11.11.11.1.cmml" xref="S3.E7.m1.20.20.20.11.11.11.1">^</ci><ci id="S3.E7.m1.20.20.20.11.11.11.2.cmml" xref="S3.E7.m1.20.20.20.11.11.11.2">𝑥</ci></apply><ci id="S3.E7.m1.21.21.21.12.12.12.1.cmml" xref="S3.E7.m1.21.21.21.12.12.12.1">𝑖</ci></apply><list id="S3.E7.m1.30.30.1.1.1.2.2.1.1.1.1.1.1.3.cmml"><ci id="S3.E7.m1.23.23.23.14.14.14.cmml" xref="S3.E7.m1.23.23.23.14.14.14">𝑽</ci><ci id="S3.E7.m1.25.25.25.16.16.16.cmml" xref="S3.E7.m1.25.25.25.16.16.16">𝜶</ci><ci id="S3.E7.m1.27.27.27.18.18.18.cmml" xref="S3.E7.m1.27.27.27.18.18.18">ℳ</ci></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.32c">\begin{gathered}\mathcal{L}=\lambda\mathcal{L}_{\text{gt}}+\mathcal{L}_{\text{d }},\\
\text{where}~{}~{}\mathcal{L}_{\text{gt }}=-\sum_{i}\log\mathcal{P}\left(\hat{x}_{i}\mid\bm{V},\bm{\alpha};\mathcal{M}\right).\end{gathered}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.p4.4" class="ltx_p">where <math id="S3.p4.4.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.p4.4.m1.1a"><mi id="S3.p4.4.m1.1.1" xref="S3.p4.4.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.p4.4.m1.1b"><ci id="S3.p4.4.m1.1.1.cmml" xref="S3.p4.4.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.4.m1.1c">\lambda</annotation></semantics></math> is the hyper-parameter to control the importance of ground truth loss.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Setting and implementation details</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.7" class="ltx_p"><span id="S4.SS1.p1.7.1" class="ltx_text ltx_font_bold">Model and Dataset: </span>We evaluate our approach using the IDEFICS-9B model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> across two datasets: VQAv2 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> and OKVQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>.
<span id="S4.SS1.p1.7.2" class="ltx_text ltx_font_bold">VQAv2</span> emphasizes open-ended VQA tasks, encompassing <math id="S4.SS1.p1.1.m1.3" class="ltx_Math" alttext="4,437,570" display="inline"><semantics id="S4.SS1.p1.1.m1.3a"><mrow id="S4.SS1.p1.1.m1.3.4.2" xref="S4.SS1.p1.1.m1.3.4.1.cmml"><mn id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">4</mn><mo id="S4.SS1.p1.1.m1.3.4.2.1" xref="S4.SS1.p1.1.m1.3.4.1.cmml">,</mo><mn id="S4.SS1.p1.1.m1.2.2" xref="S4.SS1.p1.1.m1.2.2.cmml">437</mn><mo id="S4.SS1.p1.1.m1.3.4.2.2" xref="S4.SS1.p1.1.m1.3.4.1.cmml">,</mo><mn id="S4.SS1.p1.1.m1.3.3" xref="S4.SS1.p1.1.m1.3.3.cmml">570</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.3b"><list id="S4.SS1.p1.1.m1.3.4.1.cmml" xref="S4.SS1.p1.1.m1.3.4.2"><cn type="integer" id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">4</cn><cn type="integer" id="S4.SS1.p1.1.m1.2.2.cmml" xref="S4.SS1.p1.1.m1.2.2">437</cn><cn type="integer" id="S4.SS1.p1.1.m1.3.3.cmml" xref="S4.SS1.p1.1.m1.3.3">570</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.3c">4,437,570</annotation></semantics></math> question-answer pairs in its training split, supplemented by an additional <math id="S4.SS1.p1.2.m2.3" class="ltx_Math" alttext="2,143,540" display="inline"><semantics id="S4.SS1.p1.2.m2.3a"><mrow id="S4.SS1.p1.2.m2.3.4.2" xref="S4.SS1.p1.2.m2.3.4.1.cmml"><mn id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">2</mn><mo id="S4.SS1.p1.2.m2.3.4.2.1" xref="S4.SS1.p1.2.m2.3.4.1.cmml">,</mo><mn id="S4.SS1.p1.2.m2.2.2" xref="S4.SS1.p1.2.m2.2.2.cmml">143</mn><mo id="S4.SS1.p1.2.m2.3.4.2.2" xref="S4.SS1.p1.2.m2.3.4.1.cmml">,</mo><mn id="S4.SS1.p1.2.m2.3.3" xref="S4.SS1.p1.2.m2.3.3.cmml">540</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.3b"><list id="S4.SS1.p1.2.m2.3.4.1.cmml" xref="S4.SS1.p1.2.m2.3.4.2"><cn type="integer" id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">2</cn><cn type="integer" id="S4.SS1.p1.2.m2.2.2.cmml" xref="S4.SS1.p1.2.m2.2.2">143</cn><cn type="integer" id="S4.SS1.p1.2.m2.3.3.cmml" xref="S4.SS1.p1.2.m2.3.3">540</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.3c">2,143,540</annotation></semantics></math> pairs in the validation split. <span id="S4.SS1.p1.7.3" class="ltx_text ltx_font_bold">OKVQA</span> is a large-scale dataset designed for models that require external knowledge to answer questions. It consists of <math id="S4.SS1.p1.3.m3.2" class="ltx_Math" alttext="14,055" display="inline"><semantics id="S4.SS1.p1.3.m3.2a"><mrow id="S4.SS1.p1.3.m3.2.3.2" xref="S4.SS1.p1.3.m3.2.3.1.cmml"><mn id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">14</mn><mo id="S4.SS1.p1.3.m3.2.3.2.1" xref="S4.SS1.p1.3.m3.2.3.1.cmml">,</mo><mn id="S4.SS1.p1.3.m3.2.2" xref="S4.SS1.p1.3.m3.2.2.cmml">055</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.2b"><list id="S4.SS1.p1.3.m3.2.3.1.cmml" xref="S4.SS1.p1.3.m3.2.3.2"><cn type="integer" id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">14</cn><cn type="integer" id="S4.SS1.p1.3.m3.2.2.cmml" xref="S4.SS1.p1.3.m3.2.2">055</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.2c">14,055</annotation></semantics></math> question-answer pairs, with <math id="S4.SS1.p1.4.m4.2" class="ltx_Math" alttext="9,009" display="inline"><semantics id="S4.SS1.p1.4.m4.2a"><mrow id="S4.SS1.p1.4.m4.2.3.2" xref="S4.SS1.p1.4.m4.2.3.1.cmml"><mn id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">9</mn><mo id="S4.SS1.p1.4.m4.2.3.2.1" xref="S4.SS1.p1.4.m4.2.3.1.cmml">,</mo><mn id="S4.SS1.p1.4.m4.2.2" xref="S4.SS1.p1.4.m4.2.2.cmml">009</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.2b"><list id="S4.SS1.p1.4.m4.2.3.1.cmml" xref="S4.SS1.p1.4.m4.2.3.2"><cn type="integer" id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">9</cn><cn type="integer" id="S4.SS1.p1.4.m4.2.2.cmml" xref="S4.SS1.p1.4.m4.2.2">009</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.2c">9,009</annotation></semantics></math> allocated for training and <math id="S4.SS1.p1.5.m5.2" class="ltx_Math" alttext="5,046" display="inline"><semantics id="S4.SS1.p1.5.m5.2a"><mrow id="S4.SS1.p1.5.m5.2.3.2" xref="S4.SS1.p1.5.m5.2.3.1.cmml"><mn id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">5</mn><mo id="S4.SS1.p1.5.m5.2.3.2.1" xref="S4.SS1.p1.5.m5.2.3.1.cmml">,</mo><mn id="S4.SS1.p1.5.m5.2.2" xref="S4.SS1.p1.5.m5.2.2.cmml">046</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.2b"><list id="S4.SS1.p1.5.m5.2.3.1.cmml" xref="S4.SS1.p1.5.m5.2.3.2"><cn type="integer" id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">5</cn><cn type="integer" id="S4.SS1.p1.5.m5.2.2.cmml" xref="S4.SS1.p1.5.m5.2.2">046</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.2c">5,046</annotation></semantics></math> for validation. For both VQAv2 and OKVQA datasets, We train our L-ICV on <math id="S4.SS1.p1.6.m6.2" class="ltx_Math" alttext="8,000" display="inline"><semantics id="S4.SS1.p1.6.m6.2a"><mrow id="S4.SS1.p1.6.m6.2.3.2" xref="S4.SS1.p1.6.m6.2.3.1.cmml"><mn id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">8</mn><mo id="S4.SS1.p1.6.m6.2.3.2.1" xref="S4.SS1.p1.6.m6.2.3.1.cmml">,</mo><mn id="S4.SS1.p1.6.m6.2.2" xref="S4.SS1.p1.6.m6.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.2b"><list id="S4.SS1.p1.6.m6.2.3.1.cmml" xref="S4.SS1.p1.6.m6.2.3.2"><cn type="integer" id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">8</cn><cn type="integer" id="S4.SS1.p1.6.m6.2.2.cmml" xref="S4.SS1.p1.6.m6.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.2c">8,000</annotation></semantics></math> pairs from each training set. Due to computational resource limitations, we randomly sample <math id="S4.SS1.p1.7.m7.2" class="ltx_Math" alttext="10,000" display="inline"><semantics id="S4.SS1.p1.7.m7.2a"><mrow id="S4.SS1.p1.7.m7.2.3.2" xref="S4.SS1.p1.7.m7.2.3.1.cmml"><mn id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml">10</mn><mo id="S4.SS1.p1.7.m7.2.3.2.1" xref="S4.SS1.p1.7.m7.2.3.1.cmml">,</mo><mn id="S4.SS1.p1.7.m7.2.2" xref="S4.SS1.p1.7.m7.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.2b"><list id="S4.SS1.p1.7.m7.2.3.1.cmml" xref="S4.SS1.p1.7.m7.2.3.2"><cn type="integer" id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1">10</cn><cn type="integer" id="S4.SS1.p1.7.m7.2.2.cmml" xref="S4.SS1.p1.7.m7.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.2c">10,000</annotation></semantics></math> question-answer pairs from the VQAv2 validation split for evaluation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. For OKVQA, we utilize the entire validation split.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.5" class="ltx_p"><span id="S4.SS1.p2.5.1" class="ltx_text ltx_font_bold">L-ICV Setting: </span>During training, we assign 32-shot demonstrations for each query,
enabling L-ICV to acquire better directions of shifting vectors for VQA tasks. The <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="\bm{v}_{i}" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><msub id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mi id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml">𝒗</mi><mi id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2">𝒗</ci><ci id="S4.SS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">\bm{v}_{i}</annotation></semantics></math> is initialized using a normal distribution with a mean of <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mn id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><cn type="integer" id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">0</cn></annotation-xml></semantics></math> and a standard deviation of <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><mn id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><cn type="float" id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">0.01</annotation></semantics></math>, and all <math id="S4.SS1.p2.4.m4.1" class="ltx_Math" alttext="\alpha_{i}" display="inline"><semantics id="S4.SS1.p2.4.m4.1a"><msub id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml"><mi id="S4.SS1.p2.4.m4.1.1.2" xref="S4.SS1.p2.4.m4.1.1.2.cmml">α</mi><mi id="S4.SS1.p2.4.m4.1.1.3" xref="S4.SS1.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><apply id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p2.4.m4.1.1.2.cmml" xref="S4.SS1.p2.4.m4.1.1.2">𝛼</ci><ci id="S4.SS1.p2.4.m4.1.1.3.cmml" xref="S4.SS1.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">\alpha_{i}</annotation></semantics></math> are initialized to <math id="S4.SS1.p2.5.m5.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="S4.SS1.p2.5.m5.1a"><mn id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b"><cn type="float" id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">0.1</annotation></semantics></math>. More detailed training parameters can be found in Appendix.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Results</h3>

<section id="S4.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1 </span>Compared Methods</h4>

<div id="S4.SS2.SSS1.p1" class="ltx_para">
<p id="S4.SS2.SSS1.p1.1" class="ltx_p">We primarily compare the following methods:</p>
</div>
<div id="S4.SS2.SSS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.SSS1.p2.1" class="ltx_p"><span id="S4.SS2.SSS1.p2.1.1" class="ltx_text ltx_font_bold">Zero-Shot</span>: The model uses only the query as input.</p>
</div>
<div id="S4.SS2.SSS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS2.SSS1.p3.1" class="ltx_p"><span id="S4.SS2.SSS1.p3.1.1" class="ltx_text ltx_font_bold">k-Shot ICL</span>:The model uses <math id="S4.SS2.SSS1.p3.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.SSS1.p3.1.m1.1a"><mi id="S4.SS2.SSS1.p3.1.m1.1.1" xref="S4.SS2.SSS1.p3.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.1.m1.1b"><ci id="S4.SS2.SSS1.p3.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p3.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.1.m1.1c">k</annotation></semantics></math> demonstrations, randomly selected from the VQA dataset training split, along with the query as input.</p>
</div>
<div id="S4.SS2.SSS1.p4" class="ltx_para ltx_noindent">
<p id="S4.SS2.SSS1.p4.2" class="ltx_p"><span id="S4.SS2.SSS1.p4.2.1" class="ltx_text ltx_font_bold">Non-Learnable ICV Methods</span>: We extend three established non-learnable ICV methods from language models to our multimodal settings:
(1) <span id="S4.SS2.SSS1.p4.2.2" class="ltx_text ltx_font_bold">Task Vector (TV) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite></span> uses <math id="S4.SS2.SSS1.p4.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.SSS1.p4.1.m1.1a"><mi id="S4.SS2.SSS1.p4.1.m1.1.1" xref="S4.SS2.SSS1.p4.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p4.1.m1.1b"><ci id="S4.SS2.SSS1.p4.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p4.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p4.1.m1.1c">k</annotation></semantics></math> demonstrations and a dummy query to extract the representation of the last token from a middle layer of the model as the ICV. During inference, this vector replaces the representation of the last token in the same layer. We conduct evaluations on <span id="S4.SS2.SSS1.p4.2.3" class="ltx_text ltx_font_bold">TV</span> by implementing it across various layers and select the layer where it achieves the highest performance improvement.
(2) <span id="S4.SS2.SSS1.p4.2.4" class="ltx_text ltx_font_bold">Function Vector (FV) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite></span> employs a small subset of the validation data to derive the mean output from critical attention heads, forming the ICV. During inference, this vector is added to the representations of the last token within a specific layer. We conduct evaluations on <span id="S4.SS2.SSS1.p4.2.5" class="ltx_text ltx_font_bold">FV</span> by implementing it across various layers and select the layer where it achieves the highest performance improvement.
(3) <span id="S4.SS2.SSS1.p4.2.6" class="ltx_text ltx_font_bold">PCA In-Context Vector (PCA-ICV) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite></span> computes the ICV by applying PCA to the difference between the question and question-answer representations from <math id="S4.SS2.SSS1.p4.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.SSS1.p4.2.m2.1a"><mi id="S4.SS2.SSS1.p4.2.m2.1.1" xref="S4.SS2.SSS1.p4.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p4.2.m2.1b"><ci id="S4.SS2.SSS1.p4.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p4.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p4.2.m2.1c">k</annotation></semantics></math> demonstrations. During inference, these vectors are added to the representations of all tokens at each layer,</p>
</div>
<div id="S4.SS2.SSS1.p5" class="ltx_para ltx_noindent">
<p id="S4.SS2.SSS1.p5.1" class="ltx_p"><span id="S4.SS2.SSS1.p5.1.1" class="ltx_text ltx_font_bold">LoRA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite></span>: This method finetunes the LMMs with the same number of samples of training L-ICV. We add the LoRA module in the token classification head of the last layer. In this way, the number of trainable parameters is comparable to that of L-ICV.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Accuracy (%) with Different ICVs Methods and Finetuning Methods, where numbers in parentheses indicate multiples of L-ICV trainable parameters.</figcaption>
<div id="S4.T1.2" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:52.7pt;vertical-align:-1.4pt;"><span class="ltx_transformed_inner" style="transform:translate(-87.2pt,10.3pt) scale(0.713059554207676,0.713059554207676) ;">
<table id="S4.T1.2.2" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.2.2.3.1" class="ltx_tr">
<td id="S4.T1.2.2.3.1.1" class="ltx_td ltx_border_tt"></td>
<th id="S4.T1.2.2.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.2.2.3.1.2.1" class="ltx_text ltx_font_bold">Zero-Shot</span></th>
<th id="S4.T1.2.2.3.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.2.2.3.1.3.1" class="ltx_text ltx_font_bold">32-shot ICL</span></th>
<th id="S4.T1.2.2.3.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.2.2.3.1.4.1" class="ltx_text ltx_font_bold">TV</span></th>
<th id="S4.T1.2.2.3.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.2.2.3.1.5.1" class="ltx_text ltx_font_bold">FV</span></th>
<th id="S4.T1.2.2.3.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.2.2.3.1.6.1" class="ltx_text ltx_font_bold">PCA-ICV</span></th>
<th id="S4.T1.2.2.3.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.2.2.3.1.7.1" class="ltx_text ltx_font_bold">LoRA</span></th>
<th id="S4.T1.2.2.3.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.2.2.3.1.8.1" class="ltx_text ltx_font_bold">L-ICV (Ours)</span></th>
</tr>
<tr id="S4.T1.2.2.4.2" class="ltx_tr">
<td id="S4.T1.2.2.4.2.1" class="ltx_td ltx_align_center ltx_border_t">VQAv2</td>
<td id="S4.T1.2.2.4.2.2" class="ltx_td ltx_align_center ltx_border_t">29.25</td>
<td id="S4.T1.2.2.4.2.3" class="ltx_td ltx_align_center ltx_border_t">56.18</td>
<td id="S4.T1.2.2.4.2.4" class="ltx_td ltx_align_center ltx_border_t">43.68</td>
<td id="S4.T1.2.2.4.2.5" class="ltx_td ltx_align_center ltx_border_t">30.21</td>
<td id="S4.T1.2.2.4.2.6" class="ltx_td ltx_align_center ltx_border_t">34.75</td>
<td id="S4.T1.2.2.4.2.7" class="ltx_td ltx_align_center ltx_border_t">49.02</td>
<td id="S4.T1.2.2.4.2.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.2.2.4.2.8.1" class="ltx_text ltx_font_bold">58.54</span></td>
</tr>
<tr id="S4.T1.2.2.5.3" class="ltx_tr">
<td id="S4.T1.2.2.5.3.1" class="ltx_td ltx_align_center">OKVQA</td>
<td id="S4.T1.2.2.5.3.2" class="ltx_td ltx_align_center">30.54</td>
<td id="S4.T1.2.2.5.3.3" class="ltx_td ltx_align_center">48.48</td>
<td id="S4.T1.2.2.5.3.4" class="ltx_td ltx_align_center">32.68</td>
<td id="S4.T1.2.2.5.3.5" class="ltx_td ltx_align_center">31.02</td>
<td id="S4.T1.2.2.5.3.6" class="ltx_td ltx_align_center">30.59</td>
<td id="S4.T1.2.2.5.3.7" class="ltx_td ltx_align_center">34.21</td>
<td id="S4.T1.2.2.5.3.8" class="ltx_td ltx_align_center"><span id="S4.T1.2.2.5.3.8.1" class="ltx_text ltx_font_bold">50.08</span></td>
</tr>
<tr id="S4.T1.2.2.2" class="ltx_tr">
<td id="S4.T1.2.2.2.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">Total Trainable Parameters</td>
<td id="S4.T1.2.2.2.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">-</td>
<td id="S4.T1.2.2.2.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">-</td>
<td id="S4.T1.2.2.2.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">-</td>
<td id="S4.T1.2.2.2.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">-</td>
<td id="S4.T1.2.2.2.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">-</td>
<td id="S4.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><math id="S4.T1.1.1.1.1.m1.3" class="ltx_math_unparsed" alttext="1,155,136(\times 8.8)" display="inline"><semantics id="S4.T1.1.1.1.1.m1.3a"><mrow id="S4.T1.1.1.1.1.m1.3b"><mn id="S4.T1.1.1.1.1.m1.1.1">1</mn><mo id="S4.T1.1.1.1.1.m1.3.4">,</mo><mn id="S4.T1.1.1.1.1.m1.2.2">155</mn><mo id="S4.T1.1.1.1.1.m1.3.5">,</mo><mn id="S4.T1.1.1.1.1.m1.3.3">136</mn><mrow id="S4.T1.1.1.1.1.m1.3.6"><mo stretchy="false" id="S4.T1.1.1.1.1.m1.3.6.1">(</mo><mo lspace="0em" rspace="0.222em" id="S4.T1.1.1.1.1.m1.3.6.2">×</mo><mn id="S4.T1.1.1.1.1.m1.3.6.3">8.8</mn><mo stretchy="false" id="S4.T1.1.1.1.1.m1.3.6.4">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.m1.3c">1,155,136(\times 8.8)</annotation></semantics></math></td>
<td id="S4.T1.2.2.2.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><math id="S4.T1.2.2.2.2.m1.2" class="ltx_math_unparsed" alttext="131,104(\times 1.0)" display="inline"><semantics id="S4.T1.2.2.2.2.m1.2a"><mrow id="S4.T1.2.2.2.2.m1.2b"><mn id="S4.T1.2.2.2.2.m1.1.1">131</mn><mo id="S4.T1.2.2.2.2.m1.2.3">,</mo><mn id="S4.T1.2.2.2.2.m1.2.2">104</mn><mrow id="S4.T1.2.2.2.2.m1.2.4"><mo stretchy="false" id="S4.T1.2.2.2.2.m1.2.4.1">(</mo><mo lspace="0em" rspace="0.222em" id="S4.T1.2.2.2.2.m1.2.4.2">×</mo><mn id="S4.T1.2.2.2.2.m1.2.4.3">1.0</mn><mo stretchy="false" id="S4.T1.2.2.2.2.m1.2.4.4">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.T1.2.2.2.2.m1.2c">131,104(\times 1.0)</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S4.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.2 </span>Performance and Inference Efficiency on VQA. </h4>

<div id="S4.SS2.SSS2.p1" class="ltx_para">
<p id="S4.SS2.SSS2.p1.1" class="ltx_p">We present performance comparisons with various methods in Table <a href="#S4.T1" title="Table 1 ‣ 4.2.1 Compared Methods ‣ 4.2 Results ‣ 4 Experiments ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
Certain existing methods show only marginal improvements over Zero-Shot baselines, <em id="S4.SS2.SSS2.p1.1.1" class="ltx_emph ltx_font_italic">e.g.</em>, FV improves by 0.96/0.48 on VQAv2/OKVQA and PCA-ICV improves by 0.04 on OKVQA. Besides, we observe that all the previous non-learnable ICV methods do not reach the performance of the standard 32-shot ICL, <em id="S4.SS2.SSS2.p1.1.2" class="ltx_emph ltx_font_italic">e.g.</em>, the best non-learnable method, TV, is still 12.5/15.8 lower than 32-shot ICL on VQAv2/OKVQA. In contrast, our L-ICV achieves an accuracy improvement of 2.36 on VQAv2 and 1.6 on OKVQA over 32-shot ICL.
These results highlight the inefficacy of non-learnable methods in capturing essential task-specific information for VQA, whereas L-ICV, by leveraging diverse 32-shot ICL demonstrations for each query during training, manages to abstract useful task information effectively. We further show that our L-ICV outperforms LoRA with less trainable parameters, suggesting L-ICV can abstract task information more efficiently.</p>
</div>
<div id="S4.SS2.SSS2.p2" class="ltx_para">
<p id="S4.SS2.SSS2.p2.1" class="ltx_p">Figure <a href="#S4.F3" title="Figure 3 ‣ 4.2.2 Performance and Inference Efficiency on VQA. ‣ 4.2 Results ‣ 4 Experiments ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> displays the efficiency of L-ICV during inference compared to other methods. We average the FLOPs and actual inference time consumption per forward pass over 1000 randomly sampled queries.<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>For detailed hardware information, refer to Appendix.</span></span></span> We observe that L-ICV only needs 1/24.97 FLOPs and 1/8.25 inference time of 32-shot ICL per forward pass. Additionally, L-ICV maintains almost the same inference speed as Zero-Shot. These comparisons validate the efficiency of L-ICV during inference.</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2406.13185/assets/x3.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="170" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>The total number of FLOPs and real inference time consumption of ICL, Zero-Shot, L-ICV for 1000 query samples.</figcaption>
</figure>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Ablation Studies</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.2" class="ltx_p">We use ablation studies to explore the effects of diverse settings, including different training losses, the shot number of demonstrations <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mi id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">k</annotation></semantics></math> used during training, and the number of training data <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><mi id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><ci id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">N</annotation></semantics></math>.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para ltx_noindent">
<p id="S4.SS3.p2.4" class="ltx_p"><span id="S4.SS3.p2.4.1" class="ltx_text ltx_font_bold">Training Loss: </span>
Table <a href="#S4.T2" title="Table 2 ‣ 4.3 Ablation Studies ‣ 4 Experiments ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> compares the results of using different losses: only <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{gt}" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><msub id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.1.m1.1.1.2" xref="S4.SS3.p2.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S4.SS3.p2.1.m1.1.1.3" xref="S4.SS3.p2.1.m1.1.1.3.cmml"><mi id="S4.SS3.p2.1.m1.1.1.3.2" xref="S4.SS3.p2.1.m1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.1.m1.1.1.3.1" xref="S4.SS3.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p2.1.m1.1.1.3.3" xref="S4.SS3.p2.1.m1.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p2.1.m1.1.1.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2">ℒ</ci><apply id="S4.SS3.p2.1.m1.1.1.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3"><times id="S4.SS3.p2.1.m1.1.1.3.1.cmml" xref="S4.SS3.p2.1.m1.1.1.3.1"></times><ci id="S4.SS3.p2.1.m1.1.1.3.2.cmml" xref="S4.SS3.p2.1.m1.1.1.3.2">𝑔</ci><ci id="S4.SS3.p2.1.m1.1.1.3.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">\mathcal{L}_{gt}</annotation></semantics></math> in Eq. (<a href="#S3.E7" title="In 3 Learnable In-Context Vector ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>) or <math id="S4.SS3.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{d}" display="inline"><semantics id="S4.SS3.p2.2.m2.1a"><msub id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.2.m2.1.1.2" xref="S4.SS3.p2.2.m2.1.1.2.cmml">ℒ</mi><mi id="S4.SS3.p2.2.m2.1.1.3" xref="S4.SS3.p2.2.m2.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><apply id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p2.2.m2.1.1.2.cmml" xref="S4.SS3.p2.2.m2.1.1.2">ℒ</ci><ci id="S4.SS3.p2.2.m2.1.1.3.cmml" xref="S4.SS3.p2.2.m2.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">\mathcal{L}_{d}</annotation></semantics></math> in Eq. (<a href="#S3.E7" title="In 3 Learnable In-Context Vector ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>). We find that only using <math id="S4.SS3.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{L}_{gt}" display="inline"><semantics id="S4.SS3.p2.3.m3.1a"><msub id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.3.m3.1.1.2" xref="S4.SS3.p2.3.m3.1.1.2.cmml">ℒ</mi><mrow id="S4.SS3.p2.3.m3.1.1.3" xref="S4.SS3.p2.3.m3.1.1.3.cmml"><mi id="S4.SS3.p2.3.m3.1.1.3.2" xref="S4.SS3.p2.3.m3.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.3.m3.1.1.3.1" xref="S4.SS3.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p2.3.m3.1.1.3.3" xref="S4.SS3.p2.3.m3.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.1b"><apply id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.1.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.p2.3.m3.1.1.2.cmml" xref="S4.SS3.p2.3.m3.1.1.2">ℒ</ci><apply id="S4.SS3.p2.3.m3.1.1.3.cmml" xref="S4.SS3.p2.3.m3.1.1.3"><times id="S4.SS3.p2.3.m3.1.1.3.1.cmml" xref="S4.SS3.p2.3.m3.1.1.3.1"></times><ci id="S4.SS3.p2.3.m3.1.1.3.2.cmml" xref="S4.SS3.p2.3.m3.1.1.3.2">𝑔</ci><ci id="S4.SS3.p2.3.m3.1.1.3.3.cmml" xref="S4.SS3.p2.3.m3.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.1c">\mathcal{L}_{gt}</annotation></semantics></math> (same as standard fine-tuning) significantly damages the performance, <em id="S4.SS3.p2.4.2" class="ltx_emph ltx_font_italic">e.g.</em>, <math id="S4.SS3.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{L}_{gt}" display="inline"><semantics id="S4.SS3.p2.4.m4.1a"><msub id="S4.SS3.p2.4.m4.1.1" xref="S4.SS3.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.4.m4.1.1.2" xref="S4.SS3.p2.4.m4.1.1.2.cmml">ℒ</mi><mrow id="S4.SS3.p2.4.m4.1.1.3" xref="S4.SS3.p2.4.m4.1.1.3.cmml"><mi id="S4.SS3.p2.4.m4.1.1.3.2" xref="S4.SS3.p2.4.m4.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.4.m4.1.1.3.1" xref="S4.SS3.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p2.4.m4.1.1.3.3" xref="S4.SS3.p2.4.m4.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.1b"><apply id="S4.SS3.p2.4.m4.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.4.m4.1.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS3.p2.4.m4.1.1.2.cmml" xref="S4.SS3.p2.4.m4.1.1.2">ℒ</ci><apply id="S4.SS3.p2.4.m4.1.1.3.cmml" xref="S4.SS3.p2.4.m4.1.1.3"><times id="S4.SS3.p2.4.m4.1.1.3.1.cmml" xref="S4.SS3.p2.4.m4.1.1.3.1"></times><ci id="S4.SS3.p2.4.m4.1.1.3.2.cmml" xref="S4.SS3.p2.4.m4.1.1.3.2">𝑔</ci><ci id="S4.SS3.p2.4.m4.1.1.3.3.cmml" xref="S4.SS3.p2.4.m4.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.1c">\mathcal{L}_{gt}</annotation></semantics></math> achieves 16.9/6.12 lower accuracy on VQAv2/OKVQA</p>
</div>
<figure id="S4.T2" class="ltx_table ltx_align_floatright">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Accuracy (%) of L-ICV with Different Training Loss on VQA.</figcaption>
<table id="S4.T2.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.3.3" class="ltx_tr">
<td id="S4.T2.3.3.4" class="ltx_td ltx_border_tt"></td>
<th id="S4.T2.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><math id="S4.T2.1.1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{d}" display="inline"><semantics id="S4.T2.1.1.1.m1.1a"><msub id="S4.T2.1.1.1.m1.1.1" xref="S4.T2.1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T2.1.1.1.m1.1.1.2" xref="S4.T2.1.1.1.m1.1.1.2.cmml">ℒ</mi><mi id="S4.T2.1.1.1.m1.1.1.3" xref="S4.T2.1.1.1.m1.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.1b"><apply id="S4.T2.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.1.1.1.m1.1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1">subscript</csymbol><ci id="S4.T2.1.1.1.m1.1.1.2.cmml" xref="S4.T2.1.1.1.m1.1.1.2">ℒ</ci><ci id="S4.T2.1.1.1.m1.1.1.3.cmml" xref="S4.T2.1.1.1.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.1c">\mathcal{L}_{d}</annotation></semantics></math></th>
<th id="S4.T2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><math id="S4.T2.2.2.2.m1.1" class="ltx_Math" alttext="\mathcal{L}_{gt}" display="inline"><semantics id="S4.T2.2.2.2.m1.1a"><msub id="S4.T2.2.2.2.m1.1.1" xref="S4.T2.2.2.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T2.2.2.2.m1.1.1.2" xref="S4.T2.2.2.2.m1.1.1.2.cmml">ℒ</mi><mrow id="S4.T2.2.2.2.m1.1.1.3" xref="S4.T2.2.2.2.m1.1.1.3.cmml"><mi id="S4.T2.2.2.2.m1.1.1.3.2" xref="S4.T2.2.2.2.m1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.T2.2.2.2.m1.1.1.3.1" xref="S4.T2.2.2.2.m1.1.1.3.1.cmml">​</mo><mi id="S4.T2.2.2.2.m1.1.1.3.3" xref="S4.T2.2.2.2.m1.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.m1.1b"><apply id="S4.T2.2.2.2.m1.1.1.cmml" xref="S4.T2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.2.2.2.m1.1.1.1.cmml" xref="S4.T2.2.2.2.m1.1.1">subscript</csymbol><ci id="S4.T2.2.2.2.m1.1.1.2.cmml" xref="S4.T2.2.2.2.m1.1.1.2">ℒ</ci><apply id="S4.T2.2.2.2.m1.1.1.3.cmml" xref="S4.T2.2.2.2.m1.1.1.3"><times id="S4.T2.2.2.2.m1.1.1.3.1.cmml" xref="S4.T2.2.2.2.m1.1.1.3.1"></times><ci id="S4.T2.2.2.2.m1.1.1.3.2.cmml" xref="S4.T2.2.2.2.m1.1.1.3.2">𝑔</ci><ci id="S4.T2.2.2.2.m1.1.1.3.3.cmml" xref="S4.T2.2.2.2.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.m1.1c">\mathcal{L}_{gt}</annotation></semantics></math></th>
<th id="S4.T2.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><math id="S4.T2.3.3.3.m1.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S4.T2.3.3.3.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.T2.3.3.3.m1.1.1" xref="S4.T2.3.3.3.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.m1.1b"><ci id="S4.T2.3.3.3.m1.1.1.cmml" xref="S4.T2.3.3.3.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.m1.1c">\mathcal{L}</annotation></semantics></math></th>
<td id="S4.T2.3.3.5" class="ltx_td ltx_nopad_r ltx_border_tt"></td>
</tr>
<tr id="S4.T2.3.4.1" class="ltx_tr">
<td id="S4.T2.3.4.1.1" class="ltx_td ltx_align_center ltx_border_t">VQAv2</td>
<td id="S4.T2.3.4.1.2" class="ltx_td ltx_align_center ltx_border_t">54.76</td>
<td id="S4.T2.3.4.1.3" class="ltx_td ltx_align_center ltx_border_t">41.64</td>
<td id="S4.T2.3.4.1.4" class="ltx_td ltx_align_center ltx_border_t">58.54</td>
<td id="S4.T2.3.4.1.5" class="ltx_td ltx_border_t"></td>
</tr>
<tr id="S4.T2.3.5.2" class="ltx_tr">
<td id="S4.T2.3.5.2.1" class="ltx_td ltx_align_center ltx_border_bb">OKVQA</td>
<td id="S4.T2.3.5.2.2" class="ltx_td ltx_align_center ltx_border_bb">46.94</td>
<td id="S4.T2.3.5.2.3" class="ltx_td ltx_align_center ltx_border_bb">43.96</td>
<td id="S4.T2.3.5.2.4" class="ltx_td ltx_align_center ltx_border_bb">50.08</td>
<td id="S4.T2.3.5.2.5" class="ltx_td ltx_border_bb"></td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.5" class="ltx_p">compared to using the combined loss <math id="S4.SS3.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S4.SS3.p3.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><ci id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">\mathcal{L}</annotation></semantics></math>;
yet using only <math id="S4.SS3.p3.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{d}" display="inline"><semantics id="S4.SS3.p3.2.m2.1a"><msub id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.2.m2.1.1.2" xref="S4.SS3.p3.2.m2.1.1.2.cmml">ℒ</mi><mi id="S4.SS3.p3.2.m2.1.1.3" xref="S4.SS3.p3.2.m2.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><apply id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.1.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p3.2.m2.1.1.2.cmml" xref="S4.SS3.p3.2.m2.1.1.2">ℒ</ci><ci id="S4.SS3.p3.2.m2.1.1.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">\mathcal{L}_{d}</annotation></semantics></math> results in a smaller performance drop – 3.78/3.14 lower VQAv2/OKVQA than when using <math id="S4.SS3.p3.3.m3.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S4.SS3.p3.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.3.m3.1.1" xref="S4.SS3.p3.3.m3.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m3.1b"><ci id="S4.SS3.p3.3.m3.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m3.1c">\mathcal{L}</annotation></semantics></math>. This suggests that with a limited number of trainable parameters, L-ICV trained with <math id="S4.SS3.p3.4.m4.1" class="ltx_Math" alttext="\mathcal{L}_{d}" display="inline"><semantics id="S4.SS3.p3.4.m4.1a"><msub id="S4.SS3.p3.4.m4.1.1" xref="S4.SS3.p3.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.4.m4.1.1.2" xref="S4.SS3.p3.4.m4.1.1.2.cmml">ℒ</mi><mi id="S4.SS3.p3.4.m4.1.1.3" xref="S4.SS3.p3.4.m4.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.4.m4.1b"><apply id="S4.SS3.p3.4.m4.1.1.cmml" xref="S4.SS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.4.m4.1.1.1.cmml" xref="S4.SS3.p3.4.m4.1.1">subscript</csymbol><ci id="S4.SS3.p3.4.m4.1.1.2.cmml" xref="S4.SS3.p3.4.m4.1.1.2">ℒ</ci><ci id="S4.SS3.p3.4.m4.1.1.3.cmml" xref="S4.SS3.p3.4.m4.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.4.m4.1c">\mathcal{L}_{d}</annotation></semantics></math> is more robust and capable of capturing essential task information than <math id="S4.SS3.p3.5.m5.1" class="ltx_Math" alttext="\mathcal{L}_{gt}" display="inline"><semantics id="S4.SS3.p3.5.m5.1a"><msub id="S4.SS3.p3.5.m5.1.1" xref="S4.SS3.p3.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.5.m5.1.1.2" xref="S4.SS3.p3.5.m5.1.1.2.cmml">ℒ</mi><mrow id="S4.SS3.p3.5.m5.1.1.3" xref="S4.SS3.p3.5.m5.1.1.3.cmml"><mi id="S4.SS3.p3.5.m5.1.1.3.2" xref="S4.SS3.p3.5.m5.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.5.m5.1.1.3.1" xref="S4.SS3.p3.5.m5.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p3.5.m5.1.1.3.3" xref="S4.SS3.p3.5.m5.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.5.m5.1b"><apply id="S4.SS3.p3.5.m5.1.1.cmml" xref="S4.SS3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.5.m5.1.1.1.cmml" xref="S4.SS3.p3.5.m5.1.1">subscript</csymbol><ci id="S4.SS3.p3.5.m5.1.1.2.cmml" xref="S4.SS3.p3.5.m5.1.1.2">ℒ</ci><apply id="S4.SS3.p3.5.m5.1.1.3.cmml" xref="S4.SS3.p3.5.m5.1.1.3"><times id="S4.SS3.p3.5.m5.1.1.3.1.cmml" xref="S4.SS3.p3.5.m5.1.1.3.1"></times><ci id="S4.SS3.p3.5.m5.1.1.3.2.cmml" xref="S4.SS3.p3.5.m5.1.1.3.2">𝑔</ci><ci id="S4.SS3.p3.5.m5.1.1.3.3.cmml" xref="S4.SS3.p3.5.m5.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.5.m5.1c">\mathcal{L}_{gt}</annotation></semantics></math>.
It underscores that the L-ICV cannot solely rely on fine-tuning with LMMs on specific datasets, but should effectively leverage abstracted insights from demonstrations.</p>
</div>
<div id="S4.SS3.p4" class="ltx_para ltx_noindent">
<p id="S4.SS3.p4.3" class="ltx_p"><span id="S4.SS3.p4.1.1" class="ltx_text ltx_font_bold">Number of Demonstrations <math id="S4.SS3.p4.1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS3.p4.1.1.m1.1a"><mi id="S4.SS3.p4.1.1.m1.1.1" xref="S4.SS3.p4.1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.1.1.m1.1b"><ci id="S4.SS3.p4.1.1.m1.1.1.cmml" xref="S4.SS3.p4.1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.1.1.m1.1c">k</annotation></semantics></math>: </span>
We compare the performance of L-ICV trained with <math id="S4.SS3.p4.2.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS3.p4.2.m1.1a"><mi id="S4.SS3.p4.2.m1.1.1" xref="S4.SS3.p4.2.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.2.m1.1b"><ci id="S4.SS3.p4.2.m1.1.1.cmml" xref="S4.SS3.p4.2.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.2.m1.1c">k</annotation></semantics></math> demonstrations per query and the corresponding <math id="S4.SS3.p4.3.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS3.p4.3.m2.1a"><mi id="S4.SS3.p4.3.m2.1.1" xref="S4.SS3.p4.3.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.3.m2.1b"><ci id="S4.SS3.p4.3.m2.1.1.cmml" xref="S4.SS3.p4.3.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.3.m2.1c">k</annotation></semantics></math>-shot ICL in Table <a href="#S4.T3" title="Table 3 ‣ 4.3 Ablation Studies ‣ 4 Experiments ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. The result shows that an increase</p>
</div>
<figure id="S4.T3" class="ltx_table ltx_align_floatright">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Accuracy (%) of Different Number of Demonstrations on VQA.</figcaption>
<div id="S4.T3.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:216.8pt;height:88.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-23.5pt,9.6pt) scale(0.821767136578593,0.821767136578593) ;">
<table id="S4.T3.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.1.1.1.1" class="ltx_tr">
<th id="S4.T3.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" rowspan="2"><span id="S4.T3.1.1.1.1.1.1" class="ltx_text">Task</span></th>
<th id="S4.T3.1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" rowspan="2"><span id="S4.T3.1.1.1.1.2.1" class="ltx_text">Method</span></th>
<th id="S4.T3.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="5">Number of Demonstrations</th>
</tr>
<tr id="S4.T3.1.1.2.2" class="ltx_tr">
<th id="S4.T3.1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">1</th>
<th id="S4.T3.1.1.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">4</th>
<th id="S4.T3.1.1.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">8</th>
<th id="S4.T3.1.1.2.2.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">16</th>
<th id="S4.T3.1.1.2.2.5" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_t">32</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.1.1.3.1" class="ltx_tr">
<th id="S4.T3.1.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="2"><span id="S4.T3.1.1.3.1.1.1" class="ltx_text">VQAv2</span></th>
<th id="S4.T3.1.1.3.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">L-ICV</th>
<td id="S4.T3.1.1.3.1.3" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T3.1.1.3.1.3.1" class="ltx_text ltx_font_bold">56.84</span></td>
<td id="S4.T3.1.1.3.1.4" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T3.1.1.3.1.4.1" class="ltx_text ltx_font_bold">57.60</span></td>
<td id="S4.T3.1.1.3.1.5" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T3.1.1.3.1.5.1" class="ltx_text ltx_font_bold">58.25</span></td>
<td id="S4.T3.1.1.3.1.6" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T3.1.1.3.1.6.1" class="ltx_text ltx_font_bold">58.27</span></td>
<td id="S4.T3.1.1.3.1.7" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t"><span id="S4.T3.1.1.3.1.7.1" class="ltx_text ltx_font_bold">58.54</span></td>
</tr>
<tr id="S4.T3.1.1.4.2" class="ltx_tr">
<th id="S4.T3.1.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">ICL</th>
<td id="S4.T3.1.1.4.2.2" class="ltx_td ltx_align_left">51.39</td>
<td id="S4.T3.1.1.4.2.3" class="ltx_td ltx_align_left">53.72</td>
<td id="S4.T3.1.1.4.2.4" class="ltx_td ltx_align_left">54.24</td>
<td id="S4.T3.1.1.4.2.5" class="ltx_td ltx_align_left">55.70</td>
<td id="S4.T3.1.1.4.2.6" class="ltx_td ltx_nopad_r ltx_align_left">56.18</td>
</tr>
<tr id="S4.T3.1.1.5.3" class="ltx_tr">
<th id="S4.T3.1.1.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" rowspan="2"><span id="S4.T3.1.1.5.3.1.1" class="ltx_text">OKVQA</span></th>
<th id="S4.T3.1.1.5.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">L-ICV</th>
<td id="S4.T3.1.1.5.3.3" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T3.1.1.5.3.3.1" class="ltx_text ltx_font_bold">47.51</span></td>
<td id="S4.T3.1.1.5.3.4" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T3.1.1.5.3.4.1" class="ltx_text ltx_font_bold">47.68</span></td>
<td id="S4.T3.1.1.5.3.5" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T3.1.1.5.3.5.1" class="ltx_text ltx_font_bold">49.40</span></td>
<td id="S4.T3.1.1.5.3.6" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T3.1.1.5.3.6.1" class="ltx_text ltx_font_bold">49.71</span></td>
<td id="S4.T3.1.1.5.3.7" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t"><span id="S4.T3.1.1.5.3.7.1" class="ltx_text ltx_font_bold">50.08</span></td>
</tr>
<tr id="S4.T3.1.1.6.4" class="ltx_tr">
<th id="S4.T3.1.1.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">ICL</th>
<td id="S4.T3.1.1.6.4.2" class="ltx_td ltx_align_left ltx_border_bb">40.75</td>
<td id="S4.T3.1.1.6.4.3" class="ltx_td ltx_align_left ltx_border_bb">46.11</td>
<td id="S4.T3.1.1.6.4.4" class="ltx_td ltx_align_left ltx_border_bb">46.79</td>
<td id="S4.T3.1.1.6.4.5" class="ltx_td ltx_align_left ltx_border_bb">47.70</td>
<td id="S4.T3.1.1.6.4.6" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb">48.48</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.SS3.p5" class="ltx_para">
<p id="S4.SS3.p5.1" class="ltx_p">in the number of demonstrations enhances the performance of ICL and L-ICV, indicating that more demonstrations can provide each query with a richer context to help train L-ICV. Additionally, L-ICV consistently surpasses the performance of <math id="S4.SS3.p5.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS3.p5.1.m1.1a"><mi id="S4.SS3.p5.1.m1.1.1" xref="S4.SS3.p5.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.1.m1.1b"><ci id="S4.SS3.p5.1.m1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.1.m1.1c">k</annotation></semantics></math>-shot ICL across different training sizes, showcasing the robustness of our L-ICV in utilizing demonstrations. Notably, when the number of demonstrations is limited, the performance gap between L-ICV and ICL becomes more pronounced. This is because ICL is highly sensitive to the choice of demonstrations; with insufficient demonstrations, the model may shift the query representations in an incorrect direction. In contrast, L-ICV continuously by learning the main shift direction of the query representations from the demonstrations, reduces the negative impact of poor demonstrations on the query during training and is more robust that can extract essential task information.</p>
</div>
<div id="S4.SS3.p6" class="ltx_para ltx_noindent">
<p id="S4.SS3.p6.1" class="ltx_p"><span id="S4.SS3.p6.1.1" class="ltx_text ltx_font_bold">Size of Training Set: </span>
Figure <a href="#S4.F4" title="Figure 4 ‣ 4.4 Analysis ‣ 4 Experiments ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> illustrates how varying the number of training samples impacts the performance of L-ICV and LoRA. On the VQAv2 dataset, both methods show improved performance with increasing data sizes. Notably, L-ICV performs exceptionally well across both low and high training sizes. It achieves performance close to that of 1-shot ICL with just 700 training samples and surpasses 32-shot ICL with 4,000 training samples. In contrast, LoRA does not exceed the performance of 1-shot ICL, even when expanded to 8,000 samples.
For OKVQA, the performance of LoRA with small data sizes is even worse than Zero-Shot. This is because OKVQA requires external knowledge to answer questions, while learning external knowledge from a small amount of data can disrupt the inherent knowledge of the pre-trained model, leading to a significant drop in performance. Conversely, L-ICV excels by focusing on learning shift direction, thus preserving the model’s inherent reasoning abilities. With just 500 samples, L-ICV outperforms 1-shot ICL, and with 4,000 samples, it nearly matches the performance of 32-shot ICL. These observations underscore L-ICV’s superior efficiency over LoRA in capturing and utilizing complex reasoning capabilities with much fewer training samples.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Analysis</h3>

<figure id="S4.F4" class="ltx_figure"><img src="/html/2406.13185/assets/x4.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="142" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Accuracy (%) of L-ICV and LoRA with different size of training set.</figcaption>
</figure>
<section id="S4.SS4.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.4.1 </span>The Shifting Effect in Latent Space</h4>

<figure id="S4.F5" class="ltx_figure"><img src="/html/2406.13185/assets/x5.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="171" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>T-SNE visualization of first answer token representations over 200 queries.</figcaption>
</figure>
<div id="S4.SS4.SSS1.p1" class="ltx_para">
<p id="S4.SS4.SSS1.p1.8" class="ltx_p">To better demonstrate the shifting effect of L-ICV on query samples, we randomly select 200 query samples and conduct different methods of inference in LMMs. We extract the representation vector of the first answer token for T-SNE dimensionality reduction, shown in Figure <a href="#S4.F5" title="Figure 5 ‣ 4.4.1 The Shifting Effect in Latent Space ‣ 4.4 Analysis ‣ 4 Experiments ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. Additionally, to quantitatively evaluate the effect of shift directions of different ICV methods, we calculate the following metrics. Given a query <math id="S4.SS4.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\hat{\bm{x}}" display="inline"><semantics id="S4.SS4.SSS1.p1.1.m1.1a"><mover accent="true" id="S4.SS4.SSS1.p1.1.m1.1.1" xref="S4.SS4.SSS1.p1.1.m1.1.1.cmml"><mi id="S4.SS4.SSS1.p1.1.m1.1.1.2" xref="S4.SS4.SSS1.p1.1.m1.1.1.2.cmml">𝒙</mi><mo id="S4.SS4.SSS1.p1.1.m1.1.1.1" xref="S4.SS4.SSS1.p1.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS1.p1.1.m1.1b"><apply id="S4.SS4.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS4.SSS1.p1.1.m1.1.1"><ci id="S4.SS4.SSS1.p1.1.m1.1.1.1.cmml" xref="S4.SS4.SSS1.p1.1.m1.1.1.1">^</ci><ci id="S4.SS4.SSS1.p1.1.m1.1.1.2.cmml" xref="S4.SS4.SSS1.p1.1.m1.1.1.2">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS1.p1.1.m1.1c">\hat{\bm{x}}</annotation></semantics></math>, we use <math id="S4.SS4.SSS1.p1.2.m2.1" class="ltx_Math" alttext="\bm{r}_{icl}" display="inline"><semantics id="S4.SS4.SSS1.p1.2.m2.1a"><msub id="S4.SS4.SSS1.p1.2.m2.1.1" xref="S4.SS4.SSS1.p1.2.m2.1.1.cmml"><mi id="S4.SS4.SSS1.p1.2.m2.1.1.2" xref="S4.SS4.SSS1.p1.2.m2.1.1.2.cmml">𝒓</mi><mrow id="S4.SS4.SSS1.p1.2.m2.1.1.3" xref="S4.SS4.SSS1.p1.2.m2.1.1.3.cmml"><mi id="S4.SS4.SSS1.p1.2.m2.1.1.3.2" xref="S4.SS4.SSS1.p1.2.m2.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS4.SSS1.p1.2.m2.1.1.3.1" xref="S4.SS4.SSS1.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS4.SSS1.p1.2.m2.1.1.3.3" xref="S4.SS4.SSS1.p1.2.m2.1.1.3.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.SS4.SSS1.p1.2.m2.1.1.3.1a" xref="S4.SS4.SSS1.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS4.SSS1.p1.2.m2.1.1.3.4" xref="S4.SS4.SSS1.p1.2.m2.1.1.3.4.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS1.p1.2.m2.1b"><apply id="S4.SS4.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS4.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS1.p1.2.m2.1.1.1.cmml" xref="S4.SS4.SSS1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS4.SSS1.p1.2.m2.1.1.2.cmml" xref="S4.SS4.SSS1.p1.2.m2.1.1.2">𝒓</ci><apply id="S4.SS4.SSS1.p1.2.m2.1.1.3.cmml" xref="S4.SS4.SSS1.p1.2.m2.1.1.3"><times id="S4.SS4.SSS1.p1.2.m2.1.1.3.1.cmml" xref="S4.SS4.SSS1.p1.2.m2.1.1.3.1"></times><ci id="S4.SS4.SSS1.p1.2.m2.1.1.3.2.cmml" xref="S4.SS4.SSS1.p1.2.m2.1.1.3.2">𝑖</ci><ci id="S4.SS4.SSS1.p1.2.m2.1.1.3.3.cmml" xref="S4.SS4.SSS1.p1.2.m2.1.1.3.3">𝑐</ci><ci id="S4.SS4.SSS1.p1.2.m2.1.1.3.4.cmml" xref="S4.SS4.SSS1.p1.2.m2.1.1.3.4">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS1.p1.2.m2.1c">\bm{r}_{icl}</annotation></semantics></math>, <math id="S4.SS4.SSS1.p1.3.m3.1" class="ltx_Math" alttext="\bm{r}_{zs}" display="inline"><semantics id="S4.SS4.SSS1.p1.3.m3.1a"><msub id="S4.SS4.SSS1.p1.3.m3.1.1" xref="S4.SS4.SSS1.p1.3.m3.1.1.cmml"><mi id="S4.SS4.SSS1.p1.3.m3.1.1.2" xref="S4.SS4.SSS1.p1.3.m3.1.1.2.cmml">𝒓</mi><mrow id="S4.SS4.SSS1.p1.3.m3.1.1.3" xref="S4.SS4.SSS1.p1.3.m3.1.1.3.cmml"><mi id="S4.SS4.SSS1.p1.3.m3.1.1.3.2" xref="S4.SS4.SSS1.p1.3.m3.1.1.3.2.cmml">z</mi><mo lspace="0em" rspace="0em" id="S4.SS4.SSS1.p1.3.m3.1.1.3.1" xref="S4.SS4.SSS1.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS4.SSS1.p1.3.m3.1.1.3.3" xref="S4.SS4.SSS1.p1.3.m3.1.1.3.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS1.p1.3.m3.1b"><apply id="S4.SS4.SSS1.p1.3.m3.1.1.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS1.p1.3.m3.1.1.1.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS4.SSS1.p1.3.m3.1.1.2.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.2">𝒓</ci><apply id="S4.SS4.SSS1.p1.3.m3.1.1.3.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.3"><times id="S4.SS4.SSS1.p1.3.m3.1.1.3.1.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.3.1"></times><ci id="S4.SS4.SSS1.p1.3.m3.1.1.3.2.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.3.2">𝑧</ci><ci id="S4.SS4.SSS1.p1.3.m3.1.1.3.3.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS1.p1.3.m3.1c">\bm{r}_{zs}</annotation></semantics></math>, <math id="S4.SS4.SSS1.p1.4.m4.1" class="ltx_Math" alttext="\bm{r}^{*}" display="inline"><semantics id="S4.SS4.SSS1.p1.4.m4.1a"><msup id="S4.SS4.SSS1.p1.4.m4.1.1" xref="S4.SS4.SSS1.p1.4.m4.1.1.cmml"><mi id="S4.SS4.SSS1.p1.4.m4.1.1.2" xref="S4.SS4.SSS1.p1.4.m4.1.1.2.cmml">𝒓</mi><mo id="S4.SS4.SSS1.p1.4.m4.1.1.3" xref="S4.SS4.SSS1.p1.4.m4.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS1.p1.4.m4.1b"><apply id="S4.SS4.SSS1.p1.4.m4.1.1.cmml" xref="S4.SS4.SSS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS1.p1.4.m4.1.1.1.cmml" xref="S4.SS4.SSS1.p1.4.m4.1.1">superscript</csymbol><ci id="S4.SS4.SSS1.p1.4.m4.1.1.2.cmml" xref="S4.SS4.SSS1.p1.4.m4.1.1.2">𝒓</ci><times id="S4.SS4.SSS1.p1.4.m4.1.1.3.cmml" xref="S4.SS4.SSS1.p1.4.m4.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS1.p1.4.m4.1c">\bm{r}^{*}</annotation></semantics></math> to denote the representation of the first answer token obtained by 32-shot ICL, Zero-Shot, specific ICV methods, respectively. Then we calculate the standard shift direction as <math id="S4.SS4.SSS1.p1.5.m5.1" class="ltx_Math" alttext="\bm{s}_{gt}=\bm{r}_{icl}-\bm{r}_{zs}" display="inline"><semantics id="S4.SS4.SSS1.p1.5.m5.1a"><mrow id="S4.SS4.SSS1.p1.5.m5.1.1" xref="S4.SS4.SSS1.p1.5.m5.1.1.cmml"><msub id="S4.SS4.SSS1.p1.5.m5.1.1.2" xref="S4.SS4.SSS1.p1.5.m5.1.1.2.cmml"><mi id="S4.SS4.SSS1.p1.5.m5.1.1.2.2" xref="S4.SS4.SSS1.p1.5.m5.1.1.2.2.cmml">𝒔</mi><mrow id="S4.SS4.SSS1.p1.5.m5.1.1.2.3" xref="S4.SS4.SSS1.p1.5.m5.1.1.2.3.cmml"><mi id="S4.SS4.SSS1.p1.5.m5.1.1.2.3.2" xref="S4.SS4.SSS1.p1.5.m5.1.1.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.SS4.SSS1.p1.5.m5.1.1.2.3.1" xref="S4.SS4.SSS1.p1.5.m5.1.1.2.3.1.cmml">​</mo><mi id="S4.SS4.SSS1.p1.5.m5.1.1.2.3.3" xref="S4.SS4.SSS1.p1.5.m5.1.1.2.3.3.cmml">t</mi></mrow></msub><mo id="S4.SS4.SSS1.p1.5.m5.1.1.1" xref="S4.SS4.SSS1.p1.5.m5.1.1.1.cmml">=</mo><mrow id="S4.SS4.SSS1.p1.5.m5.1.1.3" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.cmml"><msub id="S4.SS4.SSS1.p1.5.m5.1.1.3.2" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.2.cmml"><mi id="S4.SS4.SSS1.p1.5.m5.1.1.3.2.2" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.2.2.cmml">𝒓</mi><mrow id="S4.SS4.SSS1.p1.5.m5.1.1.3.2.3" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.2.3.cmml"><mi id="S4.SS4.SSS1.p1.5.m5.1.1.3.2.3.2" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS4.SSS1.p1.5.m5.1.1.3.2.3.1" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.2.3.1.cmml">​</mo><mi id="S4.SS4.SSS1.p1.5.m5.1.1.3.2.3.3" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.2.3.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.SS4.SSS1.p1.5.m5.1.1.3.2.3.1a" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.2.3.1.cmml">​</mo><mi id="S4.SS4.SSS1.p1.5.m5.1.1.3.2.3.4" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.2.3.4.cmml">l</mi></mrow></msub><mo id="S4.SS4.SSS1.p1.5.m5.1.1.3.1" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.1.cmml">−</mo><msub id="S4.SS4.SSS1.p1.5.m5.1.1.3.3" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.3.cmml"><mi id="S4.SS4.SSS1.p1.5.m5.1.1.3.3.2" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.3.2.cmml">𝒓</mi><mrow id="S4.SS4.SSS1.p1.5.m5.1.1.3.3.3" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.3.3.cmml"><mi id="S4.SS4.SSS1.p1.5.m5.1.1.3.3.3.2" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.3.3.2.cmml">z</mi><mo lspace="0em" rspace="0em" id="S4.SS4.SSS1.p1.5.m5.1.1.3.3.3.1" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.3.3.1.cmml">​</mo><mi id="S4.SS4.SSS1.p1.5.m5.1.1.3.3.3.3" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.3.3.3.cmml">s</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS1.p1.5.m5.1b"><apply id="S4.SS4.SSS1.p1.5.m5.1.1.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1"><eq id="S4.SS4.SSS1.p1.5.m5.1.1.1.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.1"></eq><apply id="S4.SS4.SSS1.p1.5.m5.1.1.2.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.SSS1.p1.5.m5.1.1.2.1.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.2">subscript</csymbol><ci id="S4.SS4.SSS1.p1.5.m5.1.1.2.2.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.2.2">𝒔</ci><apply id="S4.SS4.SSS1.p1.5.m5.1.1.2.3.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.2.3"><times id="S4.SS4.SSS1.p1.5.m5.1.1.2.3.1.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.2.3.1"></times><ci id="S4.SS4.SSS1.p1.5.m5.1.1.2.3.2.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.2.3.2">𝑔</ci><ci id="S4.SS4.SSS1.p1.5.m5.1.1.2.3.3.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S4.SS4.SSS1.p1.5.m5.1.1.3.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.3"><minus id="S4.SS4.SSS1.p1.5.m5.1.1.3.1.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.1"></minus><apply id="S4.SS4.SSS1.p1.5.m5.1.1.3.2.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS4.SSS1.p1.5.m5.1.1.3.2.1.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.2">subscript</csymbol><ci id="S4.SS4.SSS1.p1.5.m5.1.1.3.2.2.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.2.2">𝒓</ci><apply id="S4.SS4.SSS1.p1.5.m5.1.1.3.2.3.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.2.3"><times id="S4.SS4.SSS1.p1.5.m5.1.1.3.2.3.1.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.2.3.1"></times><ci id="S4.SS4.SSS1.p1.5.m5.1.1.3.2.3.2.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.2.3.2">𝑖</ci><ci id="S4.SS4.SSS1.p1.5.m5.1.1.3.2.3.3.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.2.3.3">𝑐</ci><ci id="S4.SS4.SSS1.p1.5.m5.1.1.3.2.3.4.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.2.3.4">𝑙</ci></apply></apply><apply id="S4.SS4.SSS1.p1.5.m5.1.1.3.3.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS4.SSS1.p1.5.m5.1.1.3.3.1.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.3">subscript</csymbol><ci id="S4.SS4.SSS1.p1.5.m5.1.1.3.3.2.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.3.2">𝒓</ci><apply id="S4.SS4.SSS1.p1.5.m5.1.1.3.3.3.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.3.3"><times id="S4.SS4.SSS1.p1.5.m5.1.1.3.3.3.1.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.3.3.1"></times><ci id="S4.SS4.SSS1.p1.5.m5.1.1.3.3.3.2.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.3.3.2">𝑧</ci><ci id="S4.SS4.SSS1.p1.5.m5.1.1.3.3.3.3.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.3.3.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS1.p1.5.m5.1c">\bm{s}_{gt}=\bm{r}_{icl}-\bm{r}_{zs}</annotation></semantics></math> and the shift direction of specific ICV as <math id="S4.SS4.SSS1.p1.6.m6.1" class="ltx_Math" alttext="\bm{s}^{*}=\bm{r}^{*}-\bm{r}_{zs}" display="inline"><semantics id="S4.SS4.SSS1.p1.6.m6.1a"><mrow id="S4.SS4.SSS1.p1.6.m6.1.1" xref="S4.SS4.SSS1.p1.6.m6.1.1.cmml"><msup id="S4.SS4.SSS1.p1.6.m6.1.1.2" xref="S4.SS4.SSS1.p1.6.m6.1.1.2.cmml"><mi id="S4.SS4.SSS1.p1.6.m6.1.1.2.2" xref="S4.SS4.SSS1.p1.6.m6.1.1.2.2.cmml">𝒔</mi><mo id="S4.SS4.SSS1.p1.6.m6.1.1.2.3" xref="S4.SS4.SSS1.p1.6.m6.1.1.2.3.cmml">∗</mo></msup><mo id="S4.SS4.SSS1.p1.6.m6.1.1.1" xref="S4.SS4.SSS1.p1.6.m6.1.1.1.cmml">=</mo><mrow id="S4.SS4.SSS1.p1.6.m6.1.1.3" xref="S4.SS4.SSS1.p1.6.m6.1.1.3.cmml"><msup id="S4.SS4.SSS1.p1.6.m6.1.1.3.2" xref="S4.SS4.SSS1.p1.6.m6.1.1.3.2.cmml"><mi id="S4.SS4.SSS1.p1.6.m6.1.1.3.2.2" xref="S4.SS4.SSS1.p1.6.m6.1.1.3.2.2.cmml">𝒓</mi><mo id="S4.SS4.SSS1.p1.6.m6.1.1.3.2.3" xref="S4.SS4.SSS1.p1.6.m6.1.1.3.2.3.cmml">∗</mo></msup><mo id="S4.SS4.SSS1.p1.6.m6.1.1.3.1" xref="S4.SS4.SSS1.p1.6.m6.1.1.3.1.cmml">−</mo><msub id="S4.SS4.SSS1.p1.6.m6.1.1.3.3" xref="S4.SS4.SSS1.p1.6.m6.1.1.3.3.cmml"><mi id="S4.SS4.SSS1.p1.6.m6.1.1.3.3.2" xref="S4.SS4.SSS1.p1.6.m6.1.1.3.3.2.cmml">𝒓</mi><mrow id="S4.SS4.SSS1.p1.6.m6.1.1.3.3.3" xref="S4.SS4.SSS1.p1.6.m6.1.1.3.3.3.cmml"><mi id="S4.SS4.SSS1.p1.6.m6.1.1.3.3.3.2" xref="S4.SS4.SSS1.p1.6.m6.1.1.3.3.3.2.cmml">z</mi><mo lspace="0em" rspace="0em" id="S4.SS4.SSS1.p1.6.m6.1.1.3.3.3.1" xref="S4.SS4.SSS1.p1.6.m6.1.1.3.3.3.1.cmml">​</mo><mi id="S4.SS4.SSS1.p1.6.m6.1.1.3.3.3.3" xref="S4.SS4.SSS1.p1.6.m6.1.1.3.3.3.3.cmml">s</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS1.p1.6.m6.1b"><apply id="S4.SS4.SSS1.p1.6.m6.1.1.cmml" xref="S4.SS4.SSS1.p1.6.m6.1.1"><eq id="S4.SS4.SSS1.p1.6.m6.1.1.1.cmml" xref="S4.SS4.SSS1.p1.6.m6.1.1.1"></eq><apply id="S4.SS4.SSS1.p1.6.m6.1.1.2.cmml" xref="S4.SS4.SSS1.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.SSS1.p1.6.m6.1.1.2.1.cmml" xref="S4.SS4.SSS1.p1.6.m6.1.1.2">superscript</csymbol><ci id="S4.SS4.SSS1.p1.6.m6.1.1.2.2.cmml" xref="S4.SS4.SSS1.p1.6.m6.1.1.2.2">𝒔</ci><times id="S4.SS4.SSS1.p1.6.m6.1.1.2.3.cmml" xref="S4.SS4.SSS1.p1.6.m6.1.1.2.3"></times></apply><apply id="S4.SS4.SSS1.p1.6.m6.1.1.3.cmml" xref="S4.SS4.SSS1.p1.6.m6.1.1.3"><minus id="S4.SS4.SSS1.p1.6.m6.1.1.3.1.cmml" xref="S4.SS4.SSS1.p1.6.m6.1.1.3.1"></minus><apply id="S4.SS4.SSS1.p1.6.m6.1.1.3.2.cmml" xref="S4.SS4.SSS1.p1.6.m6.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS4.SSS1.p1.6.m6.1.1.3.2.1.cmml" xref="S4.SS4.SSS1.p1.6.m6.1.1.3.2">superscript</csymbol><ci id="S4.SS4.SSS1.p1.6.m6.1.1.3.2.2.cmml" xref="S4.SS4.SSS1.p1.6.m6.1.1.3.2.2">𝒓</ci><times id="S4.SS4.SSS1.p1.6.m6.1.1.3.2.3.cmml" xref="S4.SS4.SSS1.p1.6.m6.1.1.3.2.3"></times></apply><apply id="S4.SS4.SSS1.p1.6.m6.1.1.3.3.cmml" xref="S4.SS4.SSS1.p1.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS4.SSS1.p1.6.m6.1.1.3.3.1.cmml" xref="S4.SS4.SSS1.p1.6.m6.1.1.3.3">subscript</csymbol><ci id="S4.SS4.SSS1.p1.6.m6.1.1.3.3.2.cmml" xref="S4.SS4.SSS1.p1.6.m6.1.1.3.3.2">𝒓</ci><apply id="S4.SS4.SSS1.p1.6.m6.1.1.3.3.3.cmml" xref="S4.SS4.SSS1.p1.6.m6.1.1.3.3.3"><times id="S4.SS4.SSS1.p1.6.m6.1.1.3.3.3.1.cmml" xref="S4.SS4.SSS1.p1.6.m6.1.1.3.3.3.1"></times><ci id="S4.SS4.SSS1.p1.6.m6.1.1.3.3.3.2.cmml" xref="S4.SS4.SSS1.p1.6.m6.1.1.3.3.3.2">𝑧</ci><ci id="S4.SS4.SSS1.p1.6.m6.1.1.3.3.3.3.cmml" xref="S4.SS4.SSS1.p1.6.m6.1.1.3.3.3.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS1.p1.6.m6.1c">\bm{s}^{*}=\bm{r}^{*}-\bm{r}_{zs}</annotation></semantics></math>. Finally, we define the shift direction similarity as the cosine similarity between <math id="S4.SS4.SSS1.p1.7.m7.1" class="ltx_Math" alttext="\bm{s}^{*}" display="inline"><semantics id="S4.SS4.SSS1.p1.7.m7.1a"><msup id="S4.SS4.SSS1.p1.7.m7.1.1" xref="S4.SS4.SSS1.p1.7.m7.1.1.cmml"><mi id="S4.SS4.SSS1.p1.7.m7.1.1.2" xref="S4.SS4.SSS1.p1.7.m7.1.1.2.cmml">𝒔</mi><mo id="S4.SS4.SSS1.p1.7.m7.1.1.3" xref="S4.SS4.SSS1.p1.7.m7.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS1.p1.7.m7.1b"><apply id="S4.SS4.SSS1.p1.7.m7.1.1.cmml" xref="S4.SS4.SSS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS1.p1.7.m7.1.1.1.cmml" xref="S4.SS4.SSS1.p1.7.m7.1.1">superscript</csymbol><ci id="S4.SS4.SSS1.p1.7.m7.1.1.2.cmml" xref="S4.SS4.SSS1.p1.7.m7.1.1.2">𝒔</ci><times id="S4.SS4.SSS1.p1.7.m7.1.1.3.cmml" xref="S4.SS4.SSS1.p1.7.m7.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS1.p1.7.m7.1c">\bm{s}^{*}</annotation></semantics></math> and <math id="S4.SS4.SSS1.p1.8.m8.1" class="ltx_Math" alttext="\bm{s}_{gt}" display="inline"><semantics id="S4.SS4.SSS1.p1.8.m8.1a"><msub id="S4.SS4.SSS1.p1.8.m8.1.1" xref="S4.SS4.SSS1.p1.8.m8.1.1.cmml"><mi id="S4.SS4.SSS1.p1.8.m8.1.1.2" xref="S4.SS4.SSS1.p1.8.m8.1.1.2.cmml">𝒔</mi><mrow id="S4.SS4.SSS1.p1.8.m8.1.1.3" xref="S4.SS4.SSS1.p1.8.m8.1.1.3.cmml"><mi id="S4.SS4.SSS1.p1.8.m8.1.1.3.2" xref="S4.SS4.SSS1.p1.8.m8.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.SS4.SSS1.p1.8.m8.1.1.3.1" xref="S4.SS4.SSS1.p1.8.m8.1.1.3.1.cmml">​</mo><mi id="S4.SS4.SSS1.p1.8.m8.1.1.3.3" xref="S4.SS4.SSS1.p1.8.m8.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS1.p1.8.m8.1b"><apply id="S4.SS4.SSS1.p1.8.m8.1.1.cmml" xref="S4.SS4.SSS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS1.p1.8.m8.1.1.1.cmml" xref="S4.SS4.SSS1.p1.8.m8.1.1">subscript</csymbol><ci id="S4.SS4.SSS1.p1.8.m8.1.1.2.cmml" xref="S4.SS4.SSS1.p1.8.m8.1.1.2">𝒔</ci><apply id="S4.SS4.SSS1.p1.8.m8.1.1.3.cmml" xref="S4.SS4.SSS1.p1.8.m8.1.1.3"><times id="S4.SS4.SSS1.p1.8.m8.1.1.3.1.cmml" xref="S4.SS4.SSS1.p1.8.m8.1.1.3.1"></times><ci id="S4.SS4.SSS1.p1.8.m8.1.1.3.2.cmml" xref="S4.SS4.SSS1.p1.8.m8.1.1.3.2">𝑔</ci><ci id="S4.SS4.SSS1.p1.8.m8.1.1.3.3.cmml" xref="S4.SS4.SSS1.p1.8.m8.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS1.p1.8.m8.1c">\bm{s}_{gt}</annotation></semantics></math>, indicating how closely the shift direction of the ICV method aligns with the standard shift direction. The results are presented in Table <a href="#S4.T4" title="Table 4 ‣ 4.4.1 The Shifting Effect in Latent Space ‣ 4.4 Analysis ‣ 4 Experiments ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<figure id="S4.T4" class="ltx_table ltx_align_floatright">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>The shift direction similarities of different ICV methods. </figcaption>
<div id="S4.T4.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:216.8pt;height:52.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-2.3pt,0.6pt) scale(0.979316026927631,0.979316026927631) ;">
<table id="S4.T4.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T4.1.1.1.1" class="ltx_tr">
<td id="S4.T4.1.1.1.1.1" class="ltx_td ltx_border_tt"></td>
<th id="S4.T4.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T4.1.1.1.1.2.1" class="ltx_text ltx_font_bold">TV</span></th>
<th id="S4.T4.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T4.1.1.1.1.3.1" class="ltx_text ltx_font_bold">FV</span></th>
<th id="S4.T4.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T4.1.1.1.1.4.1" class="ltx_text ltx_font_bold">PCA-ICV</span></th>
<th id="S4.T4.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T4.1.1.1.1.5.1" class="ltx_text ltx_font_bold">L-ICV</span></th>
</tr>
<tr id="S4.T4.1.1.2.2" class="ltx_tr">
<td id="S4.T4.1.1.2.2.1" class="ltx_td ltx_align_center ltx_border_t">VQAv2</td>
<td id="S4.T4.1.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t">0.486</td>
<td id="S4.T4.1.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t">-0.106</td>
<td id="S4.T4.1.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t">0.027</td>
<td id="S4.T4.1.1.2.2.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.1.1.2.2.5.1" class="ltx_text ltx_font_bold">0.742</span></td>
</tr>
<tr id="S4.T4.1.1.3.3" class="ltx_tr">
<td id="S4.T4.1.1.3.3.1" class="ltx_td ltx_align_center ltx_border_bb">OKVQA</td>
<td id="S4.T4.1.1.3.3.2" class="ltx_td ltx_align_center ltx_border_bb">0.326</td>
<td id="S4.T4.1.1.3.3.3" class="ltx_td ltx_align_center ltx_border_bb">0.218</td>
<td id="S4.T4.1.1.3.3.4" class="ltx_td ltx_align_center ltx_border_bb">-0.190</td>
<td id="S4.T4.1.1.3.3.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T4.1.1.3.3.5.1" class="ltx_text ltx_font_bold">0.829</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.SS4.SSS1.p2" class="ltx_para">
<p id="S4.SS4.SSS1.p2.1" class="ltx_p">From Figure <a href="#S4.F5" title="Figure 5 ‣ 4.4.1 The Shifting Effect in Latent Space ‣ 4.4 Analysis ‣ 4 Experiments ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, we can find that 32-shot ICL exhibits a significant shift compared to Zero-Shot, visualizing the shift effects given in Eq. <a href="#S3.E4" title="In 3 Learnable In-Context Vector ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. Considering both Table <a href="#S4.T4" title="Table 4 ‣ 4.4.1 The Shifting Effect in Latent Space ‣ 4.4 Analysis ‣ 4 Experiments ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> and <a href="#S4.T1" title="Table 1 ‣ 4.2.1 Compared Methods ‣ 4.2 Results ‣ 4 Experiments ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, we find that the shift direction similarity has positive correlation to the accuracy: if a method has large direction similarity, it also has better performance. For example, among non-learnable methods, TV has higher shift direction similarity than other ones, then it has better accuracy in Table <a href="#S4.T1" title="Table 1 ‣ 4.2.1 Compared Methods ‣ 4.2 Results ‣ 4 Experiments ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Furthermore, for L-ICV which has the best accuracy in Table <a href="#S4.T1" title="Table 1 ‣ 4.2.1 Compared Methods ‣ 4.2 Results ‣ 4 Experiments ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, its shift direction similarity is also the highest, which is 0.742/0.829 on VQAv2/OKVQA, validating that L-ICV can produce shifts in query samples similar to 32-shot ICL, as visualized in Figure <a href="#S4.F5" title="Figure 5 ‣ 4.4.1 The Shifting Effect in Latent Space ‣ 4.4 Analysis ‣ 4 Experiments ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. Such positive correlation validates the effectiveness of our motivation that a single L-ICV can indeed simulate the ICL capability of LMMs by shifting the direction of the query representation.</p>
</div>
</section>
<section id="S4.SS4.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.4.2 </span>Why Non-Learnable Methods are Poor on VQA?</h4>

<div id="S4.SS4.SSS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS4.SSS2.p1.1" class="ltx_p"><span id="S4.SS4.SSS2.p1.1.1" class="ltx_text ltx_font_bold">Decoding ICV To Tokens:</span></p>
</div>
<figure id="S4.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Direct decoding of the different ICV methods.</figcaption>
<div id="S4.T5.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:346.9pt;height:63.7pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-74.2pt,13.5pt) scale(0.700290490602758,0.700290490602758) ;">
<table id="S4.T5.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T5.1.1.1.1" class="ltx_tr">
<th id="S4.T5.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S4.T5.1.1.1.1.1.1" class="ltx_text ltx_font_bold">Methods</span></th>
<th id="S4.T5.1.1.1.1.2" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S4.T5.1.1.1.1.2.1" class="ltx_text ltx_font_bold">Decoding Top-10 Tokens of different methods in order of decreasing probability</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T5.1.1.2.1" class="ltx_tr">
<td id="S4.T5.1.1.2.1.1" class="ltx_td ltx_align_left ltx_border_t">TV</td>
<td id="S4.T5.1.1.2.1.2" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t">‘No’, ’Yes’, ’no’, ’It’, ’I’, ’No’, ’The’, ’A’, ’yes’, ’Not’</td>
</tr>
<tr id="S4.T5.1.1.3.2" class="ltx_tr">
<td id="S4.T5.1.1.3.2.1" class="ltx_td ltx_align_left">FV</td>
<td id="S4.T5.1.1.3.2.2" class="ltx_td ltx_nopad_r ltx_align_left">’.’, ’in’, ’,’, ’(’, ’for’, ’and’, ’…’, ’to’, ’on’, ’I’</td>
</tr>
<tr id="S4.T5.1.1.4.3" class="ltx_tr">
<td id="S4.T5.1.1.4.3.1" class="ltx_td ltx_align_left">PCA-ICV</td>
<td id="S4.T5.1.1.4.3.2" class="ltx_td ltx_nopad_r ltx_align_left">’none’, ’there’, ’no’, ’the’, ’not’, ’None’, ’dep’, ’_yes’, ’unknown’, ’yes’</td>
</tr>
<tr id="S4.T5.1.1.5.4" class="ltx_tr">
<td id="S4.T5.1.1.5.4.1" class="ltx_td ltx_align_left ltx_border_bb">L-ICV</td>
<td id="S4.T5.1.1.5.4.2" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb">’Question’, ’_Short’, ’?’, ’no’, ’QUEST’, ’questions’, ’$?’, ’answer’, ’Short’, ’_questions’</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.SS4.SSS2.p2" class="ltx_para">
<p id="S4.SS4.SSS2.p2.4" class="ltx_p">We follow previous studies <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite> to analyze the parameters of Transformers by directly decoding them into vocabulary tokens.
Specifically, given a vector <math id="S4.SS4.SSS2.p2.1.m1.1" class="ltx_Math" alttext="\bm{v}\in\mathbb{R}^{1\times d}" display="inline"><semantics id="S4.SS4.SSS2.p2.1.m1.1a"><mrow id="S4.SS4.SSS2.p2.1.m1.1.1" xref="S4.SS4.SSS2.p2.1.m1.1.1.cmml"><mi id="S4.SS4.SSS2.p2.1.m1.1.1.2" xref="S4.SS4.SSS2.p2.1.m1.1.1.2.cmml">𝒗</mi><mo id="S4.SS4.SSS2.p2.1.m1.1.1.1" xref="S4.SS4.SSS2.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS4.SSS2.p2.1.m1.1.1.3" xref="S4.SS4.SSS2.p2.1.m1.1.1.3.cmml"><mi id="S4.SS4.SSS2.p2.1.m1.1.1.3.2" xref="S4.SS4.SSS2.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS4.SSS2.p2.1.m1.1.1.3.3" xref="S4.SS4.SSS2.p2.1.m1.1.1.3.3.cmml"><mn id="S4.SS4.SSS2.p2.1.m1.1.1.3.3.2" xref="S4.SS4.SSS2.p2.1.m1.1.1.3.3.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS4.SSS2.p2.1.m1.1.1.3.3.1" xref="S4.SS4.SSS2.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS4.SSS2.p2.1.m1.1.1.3.3.3" xref="S4.SS4.SSS2.p2.1.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p2.1.m1.1b"><apply id="S4.SS4.SSS2.p2.1.m1.1.1.cmml" xref="S4.SS4.SSS2.p2.1.m1.1.1"><in id="S4.SS4.SSS2.p2.1.m1.1.1.1.cmml" xref="S4.SS4.SSS2.p2.1.m1.1.1.1"></in><ci id="S4.SS4.SSS2.p2.1.m1.1.1.2.cmml" xref="S4.SS4.SSS2.p2.1.m1.1.1.2">𝒗</ci><apply id="S4.SS4.SSS2.p2.1.m1.1.1.3.cmml" xref="S4.SS4.SSS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p2.1.m1.1.1.3.1.cmml" xref="S4.SS4.SSS2.p2.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS4.SSS2.p2.1.m1.1.1.3.2.cmml" xref="S4.SS4.SSS2.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S4.SS4.SSS2.p2.1.m1.1.1.3.3.cmml" xref="S4.SS4.SSS2.p2.1.m1.1.1.3.3"><times id="S4.SS4.SSS2.p2.1.m1.1.1.3.3.1.cmml" xref="S4.SS4.SSS2.p2.1.m1.1.1.3.3.1"></times><cn type="integer" id="S4.SS4.SSS2.p2.1.m1.1.1.3.3.2.cmml" xref="S4.SS4.SSS2.p2.1.m1.1.1.3.3.2">1</cn><ci id="S4.SS4.SSS2.p2.1.m1.1.1.3.3.3.cmml" xref="S4.SS4.SSS2.p2.1.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p2.1.m1.1c">\bm{v}\in\mathbb{R}^{1\times d}</annotation></semantics></math>, it can be projected using the unembedding matrix <math id="S4.SS4.SSS2.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{E}\in\mathbb{R}^{d\times\mathcal{N}}" display="inline"><semantics id="S4.SS4.SSS2.p2.2.m2.1a"><mrow id="S4.SS4.SSS2.p2.2.m2.1.1" xref="S4.SS4.SSS2.p2.2.m2.1.1.cmml"><mi id="S4.SS4.SSS2.p2.2.m2.1.1.2" xref="S4.SS4.SSS2.p2.2.m2.1.1.2.cmml">𝐄</mi><mo id="S4.SS4.SSS2.p2.2.m2.1.1.1" xref="S4.SS4.SSS2.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS4.SSS2.p2.2.m2.1.1.3" xref="S4.SS4.SSS2.p2.2.m2.1.1.3.cmml"><mi id="S4.SS4.SSS2.p2.2.m2.1.1.3.2" xref="S4.SS4.SSS2.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS4.SSS2.p2.2.m2.1.1.3.3" xref="S4.SS4.SSS2.p2.2.m2.1.1.3.3.cmml"><mi id="S4.SS4.SSS2.p2.2.m2.1.1.3.3.2" xref="S4.SS4.SSS2.p2.2.m2.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS4.SSS2.p2.2.m2.1.1.3.3.1" xref="S4.SS4.SSS2.p2.2.m2.1.1.3.3.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS4.SSS2.p2.2.m2.1.1.3.3.3" xref="S4.SS4.SSS2.p2.2.m2.1.1.3.3.3.cmml">𝒩</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p2.2.m2.1b"><apply id="S4.SS4.SSS2.p2.2.m2.1.1.cmml" xref="S4.SS4.SSS2.p2.2.m2.1.1"><in id="S4.SS4.SSS2.p2.2.m2.1.1.1.cmml" xref="S4.SS4.SSS2.p2.2.m2.1.1.1"></in><ci id="S4.SS4.SSS2.p2.2.m2.1.1.2.cmml" xref="S4.SS4.SSS2.p2.2.m2.1.1.2">𝐄</ci><apply id="S4.SS4.SSS2.p2.2.m2.1.1.3.cmml" xref="S4.SS4.SSS2.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p2.2.m2.1.1.3.1.cmml" xref="S4.SS4.SSS2.p2.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS4.SSS2.p2.2.m2.1.1.3.2.cmml" xref="S4.SS4.SSS2.p2.2.m2.1.1.3.2">ℝ</ci><apply id="S4.SS4.SSS2.p2.2.m2.1.1.3.3.cmml" xref="S4.SS4.SSS2.p2.2.m2.1.1.3.3"><times id="S4.SS4.SSS2.p2.2.m2.1.1.3.3.1.cmml" xref="S4.SS4.SSS2.p2.2.m2.1.1.3.3.1"></times><ci id="S4.SS4.SSS2.p2.2.m2.1.1.3.3.2.cmml" xref="S4.SS4.SSS2.p2.2.m2.1.1.3.3.2">𝑑</ci><ci id="S4.SS4.SSS2.p2.2.m2.1.1.3.3.3.cmml" xref="S4.SS4.SSS2.p2.2.m2.1.1.3.3.3">𝒩</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p2.2.m2.1c">\mathbf{E}\in\mathbb{R}^{d\times\mathcal{N}}</annotation></semantics></math> of LMMs to obtain the corresponding token probability distribution <math id="S4.SS4.SSS2.p2.3.m3.1" class="ltx_Math" alttext="\bm{p}" display="inline"><semantics id="S4.SS4.SSS2.p2.3.m3.1a"><mi id="S4.SS4.SSS2.p2.3.m3.1.1" xref="S4.SS4.SSS2.p2.3.m3.1.1.cmml">𝒑</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p2.3.m3.1b"><ci id="S4.SS4.SSS2.p2.3.m3.1.1.cmml" xref="S4.SS4.SSS2.p2.3.m3.1.1">𝒑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p2.3.m3.1c">\bm{p}</annotation></semantics></math> , where <math id="S4.SS4.SSS2.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{N}" display="inline"><semantics id="S4.SS4.SSS2.p2.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.SSS2.p2.4.m4.1.1" xref="S4.SS4.SSS2.p2.4.m4.1.1.cmml">𝒩</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p2.4.m4.1b"><ci id="S4.SS4.SSS2.p2.4.m4.1.1.cmml" xref="S4.SS4.SSS2.p2.4.m4.1.1">𝒩</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p2.4.m4.1c">\mathcal{N}</annotation></semantics></math> is the vocabulary size:</p>
<table id="S4.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E8.m1.4" class="ltx_math_unparsed" alttext="\bm{p}=\text{softmax}(\bm{v}\cdot\mathbf{E})=\frac{\exp(\bm{v}\cdot\mathbf{E})}{\sum_{j}\exp(\bm{v}\cdot\mathbf{E})_{j}}." display="block"><semantics id="S4.E8.m1.4a"><mrow id="S4.E8.m1.4.4.1"><mrow id="S4.E8.m1.4.4.1.1"><mi id="S4.E8.m1.4.4.1.1.3">𝒑</mi><mo id="S4.E8.m1.4.4.1.1.4">=</mo><mrow id="S4.E8.m1.4.4.1.1.1"><mtext id="S4.E8.m1.4.4.1.1.1.3">softmax</mtext><mo lspace="0em" rspace="0em" id="S4.E8.m1.4.4.1.1.1.2">​</mo><mrow id="S4.E8.m1.4.4.1.1.1.1.1"><mo stretchy="false" id="S4.E8.m1.4.4.1.1.1.1.1.2">(</mo><mrow id="S4.E8.m1.4.4.1.1.1.1.1.1"><mi id="S4.E8.m1.4.4.1.1.1.1.1.1.2">𝒗</mi><mo lspace="0.222em" rspace="0.222em" id="S4.E8.m1.4.4.1.1.1.1.1.1.1">⋅</mo><mi id="S4.E8.m1.4.4.1.1.1.1.1.1.3">𝐄</mi></mrow><mo stretchy="false" id="S4.E8.m1.4.4.1.1.1.1.1.3">)</mo></mrow></mrow><mo id="S4.E8.m1.4.4.1.1.5">=</mo><mfrac id="S4.E8.m1.3.3"><mrow id="S4.E8.m1.2.2.2.2"><mi id="S4.E8.m1.1.1.1.1">exp</mi><mo id="S4.E8.m1.2.2.2.2a">⁡</mo><mrow id="S4.E8.m1.2.2.2.2.1"><mo stretchy="false" id="S4.E8.m1.2.2.2.2.1.2">(</mo><mrow id="S4.E8.m1.2.2.2.2.1.1"><mi id="S4.E8.m1.2.2.2.2.1.1.2">𝒗</mi><mo lspace="0.222em" rspace="0.222em" id="S4.E8.m1.2.2.2.2.1.1.1">⋅</mo><mi id="S4.E8.m1.2.2.2.2.1.1.3">𝐄</mi></mrow><mo stretchy="false" id="S4.E8.m1.2.2.2.2.1.3">)</mo></mrow></mrow><mrow id="S4.E8.m1.3.3.3"><msub id="S4.E8.m1.3.3.3.2"><mo id="S4.E8.m1.3.3.3.2.2">∑</mo><mi id="S4.E8.m1.3.3.3.2.3">j</mi></msub><mi id="S4.E8.m1.3.3.3.1">exp</mi><msub id="S4.E8.m1.3.3.3.3"><mrow id="S4.E8.m1.3.3.3.3.2"><mo stretchy="false" id="S4.E8.m1.3.3.3.3.2.1">(</mo><mi id="S4.E8.m1.3.3.3.3.2.2">𝒗</mi><mo lspace="0.222em" rspace="0.222em" id="S4.E8.m1.3.3.3.3.2.3">⋅</mo><mi id="S4.E8.m1.3.3.3.3.2.4">𝐄</mi><mo stretchy="false" id="S4.E8.m1.3.3.3.3.2.5">)</mo></mrow><mi id="S4.E8.m1.3.3.3.3.3">j</mi></msub></mrow></mfrac></mrow><mo lspace="0em" id="S4.E8.m1.4.4.1.2">.</mo></mrow><annotation encoding="application/x-tex" id="S4.E8.m1.4b">\bm{p}=\text{softmax}(\bm{v}\cdot\mathbf{E})=\frac{\exp(\bm{v}\cdot\mathbf{E})}{\sum_{j}\exp(\bm{v}\cdot\mathbf{E})_{j}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S4.SS4.SSS2.p2.7" class="ltx_p">We calculate the <math id="S4.SS4.SSS2.p2.5.m1.1" class="ltx_Math" alttext="\bm{p}" display="inline"><semantics id="S4.SS4.SSS2.p2.5.m1.1a"><mi id="S4.SS4.SSS2.p2.5.m1.1.1" xref="S4.SS4.SSS2.p2.5.m1.1.1.cmml">𝒑</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p2.5.m1.1b"><ci id="S4.SS4.SSS2.p2.5.m1.1.1.cmml" xref="S4.SS4.SSS2.p2.5.m1.1.1">𝒑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p2.5.m1.1c">\bm{p}</annotation></semantics></math> of the vectors got from different methods in VQAv2 and select the top-<math id="S4.SS4.SSS2.p2.6.m2.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S4.SS4.SSS2.p2.6.m2.1a"><mn id="S4.SS4.SSS2.p2.6.m2.1.1" xref="S4.SS4.SSS2.p2.6.m2.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p2.6.m2.1b"><cn type="integer" id="S4.SS4.SSS2.p2.6.m2.1.1.cmml" xref="S4.SS4.SSS2.p2.6.m2.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p2.6.m2.1c">10</annotation></semantics></math> tokens with the highest probabilities in <math id="S4.SS4.SSS2.p2.7.m3.1" class="ltx_Math" alttext="\bm{p}" display="inline"><semantics id="S4.SS4.SSS2.p2.7.m3.1a"><mi id="S4.SS4.SSS2.p2.7.m3.1.1" xref="S4.SS4.SSS2.p2.7.m3.1.1.cmml">𝒑</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p2.7.m3.1b"><ci id="S4.SS4.SSS2.p2.7.m3.1.1.cmml" xref="S4.SS4.SSS2.p2.7.m3.1.1">𝒑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p2.7.m3.1c">\bm{p}</annotation></semantics></math> shown in Table <a href="#S4.T5" title="Table 5 ‣ 4.4.2 Why Non-Learnable Methods are Poor on VQA? ‣ 4.4 Analysis ‣ 4 Experiments ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. We can see that the tokens got from FV are not highly relevant to the VQA task, which proves that FV does not capture the task information of VQAv2. On the other hand, the frequency of "yes" and "no" tokens is relatively high in the decoding results of PCA-ICV and TV, suggesting that they prefer to capture the simple patterns from demonstrations, <em id="S4.SS4.SSS2.p2.7.1" class="ltx_emph ltx_font_italic">e.g.</em>yes/no, but struggle to grasp the overall task information of complex VQA. In contrast, the tokens of L-ICV decoding are not biased to specific answers like yes/no, suggesting it abstracts more summary task knowledge of VQA.</p>
</div>
<div id="S4.SS4.SSS2.p3" class="ltx_para ltx_noindent">
<p id="S4.SS4.SSS2.p3.1" class="ltx_p"><span id="S4.SS4.SSS2.p3.1.1" class="ltx_text ltx_font_bold">Hallucinations and Invalid Responses.</span></p>
</div>
<figure id="S4.T6" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>The frequency of yes/no hallucinations and meaningless responses.</figcaption>
<div id="S4.T6.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:346.9pt;height:87pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-6.0pt,1.5pt) scale(0.966510873462125,0.966510873462125) ;">
<table id="S4.T6.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T6.1.1.1.1" class="ltx_tr">
<td id="S4.T6.1.1.1.1.1" class="ltx_td ltx_border_tt"></td>
<th id="S4.T6.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T6.1.1.1.1.2.1" class="ltx_text ltx_font_bold">Zero-Shot</span></th>
<th id="S4.T6.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T6.1.1.1.1.3.1" class="ltx_text ltx_font_bold">TV</span></th>
<th id="S4.T6.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T6.1.1.1.1.4.1" class="ltx_text ltx_font_bold">FV</span></th>
<th id="S4.T6.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T6.1.1.1.1.5.1" class="ltx_text ltx_font_bold">PCA-ICV</span></th>
<th id="S4.T6.1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T6.1.1.1.1.6.1" class="ltx_text ltx_font_bold">L-ICV</span></th>
</tr>
<tr id="S4.T6.1.1.2.2" class="ltx_tr">
<th id="S4.T6.1.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">yes/no Hallucination</th>
<th id="S4.T6.1.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">5</th>
<th id="S4.T6.1.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">111</th>
<th id="S4.T6.1.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">7</th>
<th id="S4.T6.1.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">4</th>
<th id="S4.T6.1.1.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T6.1.1.2.2.6.1" class="ltx_text ltx_font_bold">3</span></th>
</tr>
<tr id="S4.T6.1.1.3.3" class="ltx_tr">
<td id="S4.T6.1.1.3.3.1" class="ltx_td ltx_align_center ltx_border_t">Meaningless Answer in yes/no</td>
<td id="S4.T6.1.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t">0</td>
<td id="S4.T6.1.1.3.3.3" class="ltx_td ltx_align_center ltx_border_t">0</td>
<td id="S4.T6.1.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t">0</td>
<td id="S4.T6.1.1.3.3.5" class="ltx_td ltx_align_center ltx_border_t">2</td>
<td id="S4.T6.1.1.3.3.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T6.1.1.3.3.6.1" class="ltx_text ltx_font_bold">0</span></td>
</tr>
<tr id="S4.T6.1.1.4.4" class="ltx_tr">
<td id="S4.T6.1.1.4.4.1" class="ltx_td ltx_align_center">Meaningless Answer in number</td>
<td id="S4.T6.1.1.4.4.2" class="ltx_td ltx_align_center">2</td>
<td id="S4.T6.1.1.4.4.3" class="ltx_td ltx_align_center">0</td>
<td id="S4.T6.1.1.4.4.4" class="ltx_td ltx_align_center">2</td>
<td id="S4.T6.1.1.4.4.5" class="ltx_td ltx_align_center">522</td>
<td id="S4.T6.1.1.4.4.6" class="ltx_td ltx_align_center"><span id="S4.T6.1.1.4.4.6.1" class="ltx_text ltx_font_bold">0</span></td>
</tr>
<tr id="S4.T6.1.1.5.5" class="ltx_tr">
<td id="S4.T6.1.1.5.5.1" class="ltx_td ltx_align_center ltx_border_bb">Meaningless Answer in other</td>
<td id="S4.T6.1.1.5.5.2" class="ltx_td ltx_align_center ltx_border_bb">257</td>
<td id="S4.T6.1.1.5.5.3" class="ltx_td ltx_align_center ltx_border_bb">0</td>
<td id="S4.T6.1.1.5.5.4" class="ltx_td ltx_align_center ltx_border_bb">247</td>
<td id="S4.T6.1.1.5.5.5" class="ltx_td ltx_align_center ltx_border_bb">2072</td>
<td id="S4.T6.1.1.5.5.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T6.1.1.5.5.6.1" class="ltx_text ltx_font_bold">2</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.SS4.SSS2.p4" class="ltx_para">
<p id="S4.SS4.SSS2.p4.2" class="ltx_p">VQA contains various answer types and for convenience, VQAv2 divides them into three categories: “yes/no”, “number”, and “other”. After delving deeper into the answer details, interestingly, we find that TV frequently answers “yes or no” to number/other questions as shown in Figure <a href="#S4.F6" title="Figure 6 ‣ 4.4.2 Why Non-Learnable Methods are Poor on VQA? ‣ 4.4 Analysis ‣ 4 Experiments ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> (1)(2)(3). We term this phenomenon the <span id="S4.SS4.SSS2.p4.2.1" class="ltx_text ltx_font_bold">yes/no hallucination</span> and count the frequency of the yes/no hallucination over all test data samples for different methods in Table <a href="#S4.T6" title="Table 6 ‣ 4.4.2 Why Non-Learnable Methods are Poor on VQA? ‣ 4.4 Analysis ‣ 4 Experiments ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. We can find that TV appears <math id="S4.SS4.SSS2.p4.1.m1.1" class="ltx_Math" alttext="111" display="inline"><semantics id="S4.SS4.SSS2.p4.1.m1.1a"><mn id="S4.SS4.SSS2.p4.1.m1.1.1" xref="S4.SS4.SSS2.p4.1.m1.1.1.cmml">111</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p4.1.m1.1b"><cn type="integer" id="S4.SS4.SSS2.p4.1.m1.1.1.cmml" xref="S4.SS4.SSS2.p4.1.m1.1.1">111</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p4.1.m1.1c">111</annotation></semantics></math> times of yes/no hallucination, being consistent with the observations in Table <a href="#S4.T5" title="Table 5 ‣ 4.4.2 Why Non-Learnable Methods are Poor on VQA? ‣ 4.4 Analysis ‣ 4 Experiments ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, suggesting TV is biased to yes/no type question. We also observe that non-learnable methods tend to respond meaningless text (<em id="S4.SS4.SSS2.p4.2.2" class="ltx_emph ltx_font_italic">e.g.</em>“<math id="S4.SS4.SSS2.p4.2.m2.1" class="ltx_Math" alttext="\backslash\text{n}" display="inline"><semantics id="S4.SS4.SSS2.p4.2.m2.1a"><mrow id="S4.SS4.SSS2.p4.2.m2.1.1" xref="S4.SS4.SSS2.p4.2.m2.1.1.cmml"><mi id="S4.SS4.SSS2.p4.2.m2.1.1.2" xref="S4.SS4.SSS2.p4.2.m2.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS4.SSS2.p4.2.m2.1.1.1" xref="S4.SS4.SSS2.p4.2.m2.1.1.1.cmml">\</mo><mtext id="S4.SS4.SSS2.p4.2.m2.1.1.3" xref="S4.SS4.SSS2.p4.2.m2.1.1.3a.cmml">n</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p4.2.m2.1b"><apply id="S4.SS4.SSS2.p4.2.m2.1.1.cmml" xref="S4.SS4.SSS2.p4.2.m2.1.1"><ci id="S4.SS4.SSS2.p4.2.m2.1.1.1.cmml" xref="S4.SS4.SSS2.p4.2.m2.1.1.1">\</ci><csymbol cd="latexml" id="S4.SS4.SSS2.p4.2.m2.1.1.2.cmml" xref="S4.SS4.SSS2.p4.2.m2.1.1.2">absent</csymbol><ci id="S4.SS4.SSS2.p4.2.m2.1.1.3a.cmml" xref="S4.SS4.SSS2.p4.2.m2.1.1.3"><mtext id="S4.SS4.SSS2.p4.2.m2.1.1.3.cmml" xref="S4.SS4.SSS2.p4.2.m2.1.1.3">n</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p4.2.m2.1c">\backslash\text{n}</annotation></semantics></math>”) when responding to “number/other” questions as shown in Figure <a href="#S4.F6" title="Figure 6 ‣ 4.4.2 Why Non-Learnable Methods are Poor on VQA? ‣ 4.4 Analysis ‣ 4 Experiments ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> (1)(2)(4). Table <a href="#S4.T6" title="Table 6 ‣ 4.4.2 Why Non-Learnable Methods are Poor on VQA? ‣ 4.4 Analysis ‣ 4 Experiments ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> shows the number of meaningless answers. We find that PCA-ICV and TV have more chance to return meaningless answers for “other” questions, suggesting these methods do not capture the overall task information of VQA and are not able to answer some less frequently appeared questions. However, for L-ICV, it has less yes/no hallucination and meaningless responses, validating that L-ICV captures more robust task information of VQA.</p>
</div>
<figure id="S4.F6" class="ltx_figure"><img src="/html/2406.13185/assets/x6.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="438" height="99" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Visualizations of the cases where non-learnable methods appear yes/no hallucinations and meaningless responses. </figcaption>
</figure>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">To address the two major drawbacks of ICL in LMM—long computation time and sensitivity to demonstration selection—we try to apply non-learnable ICV methods from NLP to solve VQA. However, due to the complexity of VQA and the significant biases often inherent in non-learnable methods, the performance is unsatisfactory. Then we propose the Learnable ICV (L-ICV) to overcome this drawback. By learning the general shift direction from a large amount of ICL data, L-ICV successfully replaces the role of demonstrations in ICL. Experiments validate that L-ICV outperforms traditional ICL methods and other non-learnable ICV methods on two VQA datasets. Experiments also show that L-ICV, compared to LoRA, maintains excellent performance with minimal data, suggesting L-ICV is a new research direction for LMMs to solve multimodal tasks. In the future, we will explore the application of L-ICV on more multimodal tasks by various LMMs.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Josh Achiam, Steven Adler, Sandhini Agarwal, Lama Ahmad, Ilge Akkaya, Florencia Leoni Aleman, Diogo Almeida, Janko Altenschmidt, Sam Altman, Shyamal Anadkat, et al.

</span>
<span class="ltx_bibblock">Gpt-4 technical report.

</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">ArXiv preprint</span>, abs/2303.08774, 2023.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro, Faisal Azhar, et al.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">ArXiv preprint</span>, abs/2302.13971, 2023.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et al.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">ArXiv preprint</span>, abs/2307.09288, 2023.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Jiachang Liu, Dinghan Shen, Yizhe Zhang, Bill Dolan, Lawrence Carin, and Weizhu Chen.

</span>
<span class="ltx_bibblock">What makes good in-context examples for GPT-3?

</span>
<span class="ltx_bibblock">In <span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">Proceedings of Deep Learning Inside Out (DeeLIO 2022): The 3rd Workshop on Knowledge Extraction and Integration for Deep Learning Architectures</span>, pages 100–114, Dublin, Ireland and Online, 2022. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Qingxiu Dong, Lei Li, Damai Dai, Ce Zheng, Zhiyong Wu, Baobao Chang, Xu Sun, Jingjing Xu, and Zhifang Sui.

</span>
<span class="ltx_bibblock">A survey on in-context learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">ArXiv preprint</span>, abs/2301.00234, 2023.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Jean-Baptiste Alayrac, Jeff Donahue, Pauline Luc, Antoine Miech, Iain Barr, Yana Hasson, Karel Lenc, Arthur Mensch, Katherine Millican, Malcolm Reynolds, et al.

</span>
<span class="ltx_bibblock">Flamingo: a visual language model for few-shot learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, 35:23716–23736, 2022.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Hugo Laurençon, Lucile Saulnier, Léo Tronchon, Stas Bekman, Amanpreet Singh, Anton Lozhkov, Thomas Wang, Siddharth Karamcheti, Alexander M. Rush, Douwe Kiela, Matthieu Cord, and Victor Sanh.

</span>
<span class="ltx_bibblock">Obelics: An open web-scale filtered dataset of interleaved image-text documents, 2023.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Maria Tsimpoukelli, Jacob Menick, Serkan Cabi, S. M. Ali Eslami, Oriol Vinyals, and Felix Hill.

</span>
<span class="ltx_bibblock">Multimodal few-shot learning with frozen language models.

</span>
<span class="ltx_bibblock">In Marc’Aurelio Ranzato, Alina Beygelzimer, Yann N. Dauphin, Percy Liang, and Jennifer Wortman Vaughan, editors, <span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems 34: Annual Conference on Neural Information Processing Systems 2021, NeurIPS 2021, December 6-14, 2021, virtual</span>, pages 200–212, 2021.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Feng Nie, Meixi Chen, Zhirui Zhang, and Xu Cheng.

</span>
<span class="ltx_bibblock">Improving few-shot performance of language models via nearest neighbor calibration.

</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">ArXiv preprint</span>, abs/2212.02216, 2022.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Yao Lu, Max Bartolo, Alastair Moore, Sebastian Riedel, and Pontus Stenetorp.

</span>
<span class="ltx_bibblock">Fantastically ordered prompts and where to find them: Overcoming few-shot prompt order sensitivity.

</span>
<span class="ltx_bibblock">In <span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</span>, pages 8086–8098, Dublin, Ireland, 2022. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Tianyu Gao, Adam Fisch, and Danqi Chen.

</span>
<span class="ltx_bibblock">Making pre-trained language models better few-shot learners.

</span>
<span class="ltx_bibblock">In <span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">Proceedings of the 59th Annual Meeting of the Association for Computational Linguistics and the 11th International Joint Conference on Natural Language Processing (Volume 1: Long Papers)</span>, pages 3816–3830, Online, 2021. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Zhiyong Wu, Yaoxiang Wang, Jiacheng Ye, and Lingpeng Kong.

</span>
<span class="ltx_bibblock">Self-adaptive in-context learning: An information compression perspective for in-context example selection and ordering.

</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">ArXiv preprint</span>, abs/2212.10375, 2022.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Tai Nguyen and Eric Wong.

</span>
<span class="ltx_bibblock">In-context example selection with influences.

</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">ArXiv preprint</span>, abs/2302.11042, 2023.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Xiaonan Li and Xipeng Qiu.

</span>
<span class="ltx_bibblock">Finding supporting examples for in-context learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">arXiv e-prints</span>, pages arXiv–2302, 2023.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Yiming Zhang, Shi Feng, and Chenhao Tan.

</span>
<span class="ltx_bibblock">Active example selection for in-context learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing</span>, pages 9134–9148, Abu Dhabi, United Arab Emirates, 2022. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Li Li, Jiawei Peng, Huiyi Chen, Chongyang Gao, and Xu Yang.

</span>
<span class="ltx_bibblock">How to configure good in-context sequence for visual question answering.

</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">ArXiv preprint</span>, abs/2312.01571, 2023.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Xu Yang, Yongliang Wu, Mingzhuo Yang, Haokun Chen, and Xin Geng.

</span>
<span class="ltx_bibblock">Exploring diverse in-context configurations for image captioning.

</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, 36, 2024.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Roee Hendel, Mor Geva, and Amir Globerson.

</span>
<span class="ltx_bibblock">In-context learning creates task vectors.

</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">ArXiv preprint</span>, abs/2310.15916, 2023.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Eric Todd, Millicent L Li, Arnab Sen Sharma, Aaron Mueller, Byron C Wallace, and David Bau.

</span>
<span class="ltx_bibblock">Function vectors in large language models.

</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">ArXiv preprint</span>, abs/2310.15213, 2023.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Sheng Liu, Lei Xing, and James Zou.

</span>
<span class="ltx_bibblock">In-context vectors: Making in context learning more effective and controllable through latent space steering.

</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">ArXiv preprint</span>, abs/2311.06668, 2023.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Kim Anh Nguyen, Sabine Schulte im Walde, and Ngoc Thang Vu.

</span>
<span class="ltx_bibblock">Distinguishing antonyms and synonyms in a pattern-based neural network.

</span>
<span class="ltx_bibblock">In <span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">Proceedings of the 15th Conference of the European Chapter of the Association for Computational Linguistics: Volume 1, Long Papers</span>, pages 76–85, Valencia, Spain, 2017. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Lean Wang, Lei Li, Damai Dai, Deli Chen, Hao Zhou, Fandong Meng, Jie Zhou, and Xu Sun.

</span>
<span class="ltx_bibblock">Label words are anchors: An information flow perspective for understanding in-context learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">ArXiv preprint</span>, abs/2305.14160, 2023.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Edward J. Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, Lu Wang, and Weizhu Chen.

</span>
<span class="ltx_bibblock">Lora: Low-rank adaptation of large language models.

</span>
<span class="ltx_bibblock">In <span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">The Tenth International Conference on Learning Representations, ICLR 2022, Virtual Event, April 25-29, 2022</span>. OpenReview.net, 2022.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Tom B. Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, Sandhini Agarwal, Ariel Herbert-Voss, Gretchen Krueger, Tom Henighan, Rewon Child, Aditya Ramesh, Daniel M. Ziegler, Jeffrey Wu, Clemens Winter, Christopher Hesse, Mark Chen, Eric Sigler, Mateusz Litwin, Scott Gray, Benjamin Chess, Jack Clark, Christopher Berner, Sam McCandlish, Alec Radford, Ilya Sutskever, and Dario Amodei.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock">In Hugo Larochelle, Marc’Aurelio Ranzato, Raia Hadsell, Maria-Florina Balcan, and Hsuan-Tien Lin, editors, <span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems 33: Annual Conference on Neural Information Processing Systems 2020, NeurIPS 2020, December 6-12, 2020, virtual</span>, 2020.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, Ilya Sutskever, et al.

</span>
<span class="ltx_bibblock">Language models are unsupervised multitask learners.

</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text ltx_font_italic">OpenAI blog</span>, 1(8):9, 2019.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Yu Sun, Shuohuan Wang, Shikun Feng, Siyu Ding, Chao Pang, Junyuan Shang, Jiaxiang Liu, Xuyi Chen, Yanbin Zhao, Yuxiang Lu, et al.

</span>
<span class="ltx_bibblock">Ernie 3.0: Large-scale knowledge enhanced pre-training for language understanding and generation.

</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text ltx_font_italic">ArXiv preprint</span>, abs/2107.02137, 2021.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Marius Mosbach, Tiago Pimentel, Shauli Ravfogel, Dietrich Klakow, and Yanai Elazar.

</span>
<span class="ltx_bibblock">Few-shot fine-tuning vs. in-context learning: A fair comparison and evaluation.

</span>
<span class="ltx_bibblock">In Anna Rogers, Jordan Boyd-Graber, and Naoaki Okazaki, editors, <span id="bib.bib27.1.1" class="ltx_text ltx_font_italic">Findings of the Association for Computational Linguistics: ACL 2023</span>, pages 12284–12314, Toronto, Canada, July 2023. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Yaru Hao, Yutao Sun, Li Dong, Zhixiong Han, Yuxian Gu, and Furu Wei.

</span>
<span class="ltx_bibblock">Structured prompting: Scaling in-context learning to 1,000 examples.

</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2212.06713</span>, 2022.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Xinyi Wang, Wanrong Zhu, Michael Saxon, Mark Steyvers, and William Yang Wang.

</span>
<span class="ltx_bibblock">Large language models are latent variable models: Explaining and finding good demonstrations for in-context learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, 36, 2024.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Guangxuan Xiao, Yuandong Tian, Beidi Chen, Song Han, and Mike Lewis.

</span>
<span class="ltx_bibblock">Efficient streaming language models with attention sinks.

</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2309.17453</span>, 2023.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Hanshi Sun, Zhuoming Chen, Xinyu Yang, Yuandong Tian, and Beidi Chen.

</span>
<span class="ltx_bibblock">Triforce: Lossless acceleration of long sequence generation with hierarchical speculative decoding.

</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2404.11912</span>, 2024.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Yichen Zhu, Minjie Zhu, Ning Liu, Zhicai Ou, Xiaofeng Mou, and Jian Tang.

</span>
<span class="ltx_bibblock">Llava-<math id="bib.bib32.1.m1.1" class="ltx_Math" alttext="\backslash\phi" display="inline"><semantics id="bib.bib32.1.m1.1a"><mrow id="bib.bib32.1.m1.1.1" xref="bib.bib32.1.m1.1.1.cmml"><mi id="bib.bib32.1.m1.1.1.2" xref="bib.bib32.1.m1.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="bib.bib32.1.m1.1.1.1" xref="bib.bib32.1.m1.1.1.1.cmml">\</mo><mi id="bib.bib32.1.m1.1.1.3" xref="bib.bib32.1.m1.1.1.3.cmml">ϕ</mi></mrow><annotation-xml encoding="MathML-Content" id="bib.bib32.1.m1.1b"><apply id="bib.bib32.1.m1.1.1.cmml" xref="bib.bib32.1.m1.1.1"><ci id="bib.bib32.1.m1.1.1.1.cmml" xref="bib.bib32.1.m1.1.1.1">\</ci><csymbol cd="latexml" id="bib.bib32.1.m1.1.1.2.cmml" xref="bib.bib32.1.m1.1.1.2">absent</csymbol><ci id="bib.bib32.1.m1.1.1.3.cmml" xref="bib.bib32.1.m1.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib32.1.m1.1c">\backslash\phi</annotation></semantics></math>: Efficient multi-modal assistant with small language model.

</span>
<span class="ltx_bibblock"><span id="bib.bib32.2.1" class="ltx_text ltx_font_italic">ArXiv preprint</span>, abs/2401.02330, 2024.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Haotian Liu, Chunyuan Li, Yuheng Li, and Yong Jae Lee.

</span>
<span class="ltx_bibblock">Improved baselines with visual instruction tuning.

</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text ltx_font_italic">ArXiv preprint</span>, abs/2310.03744, 2023.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Anas Awadalla, Irena Gao, Josh Gardner, Jack Hessel, Yusuf Hanafy, Wanrong Zhu, Kalyani Marathe, Yonatan Bitton, Samir Gadre, Shiori Sagawa, et al.

</span>
<span class="ltx_bibblock">Openflamingo: An open-source framework for training large autoregressive vision-language models.

</span>
<span class="ltx_bibblock"><span id="bib.bib34.1.1" class="ltx_text ltx_font_italic">ArXiv preprint</span>, abs/2308.01390, 2023.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Deyao Zhu, Jun Chen, Xiaoqian Shen, Xiang Li, and Mohamed Elhoseiny.

</span>
<span class="ltx_bibblock">Minigpt-4: Enhancing vision-language understanding with advanced large language models.

</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text ltx_font_italic">ArXiv preprint</span>, abs/2304.10592, 2023.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Bo Li, Yuanhan Zhang, Liangyu Chen, Jinghao Wang, Fanyi Pu, Jingkang Yang, Chunyuan Li, and Ziwei Liu.

</span>
<span class="ltx_bibblock">Mimic-it: Multi-modal in-context instruction tuning.

</span>
<span class="ltx_bibblock"><span id="bib.bib36.1.1" class="ltx_text ltx_font_italic">ArXiv preprint</span>, abs/2306.05425, 2023.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Yash Goyal, Tejas Khot, Douglas Summers-Stay, Dhruv Batra, and Devi Parikh.

</span>
<span class="ltx_bibblock">Making the V in VQA matter: Elevating the role of image understanding in visual question answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bib37.1.1" class="ltx_text ltx_font_italic">2017 IEEE Conference on Computer Vision and Pattern Recognition, CVPR 2017, Honolulu, HI, USA, July 21-26, 2017</span>, pages 6325–6334. IEEE Computer Society, 2017.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Kenneth Marino, Mohammad Rastegari, Ali Farhadi, and Roozbeh Mottaghi.

</span>
<span class="ltx_bibblock">OK-VQA: A visual question answering benchmark requiring external knowledge.

</span>
<span class="ltx_bibblock">In <span id="bib.bib38.1.1" class="ltx_text ltx_font_italic">IEEE Conference on Computer Vision and Pattern Recognition, CVPR 2019, Long Beach, CA, USA, June 16-20, 2019</span>, pages 3195–3204. Computer Vision Foundation / IEEE, 2019.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Mor Geva, Roei Schuster, Jonathan Berant, and Omer Levy.

</span>
<span class="ltx_bibblock">Transformer feed-forward layers are key-value memories.

</span>
<span class="ltx_bibblock"><span id="bib.bib39.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2012.14913</span>, 2020.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Nora Belrose, Zach Furman, Logan Smith, Danny Halawi, Igor Ostrovsky, Lev McKinney, Stella Biderman, and Jacob Steinhardt.

</span>
<span class="ltx_bibblock">Eliciting latent predictions from transformers with the tuned lens.

</span>
<span class="ltx_bibblock"><span id="bib.bib40.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2303.08112</span>, 2023.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Guy Dar, Mor Geva, Ankit Gupta, and Jonathan Berant.

</span>
<span class="ltx_bibblock">Analyzing transformers in embedding space.

</span>
<span class="ltx_bibblock"><span id="bib.bib41.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2209.02535</span>, 2022.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
Diederik P. Kingma and Jimmy Ba.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock">In Yoshua Bengio and Yann LeCun, editors, <span id="bib.bib42.1.1" class="ltx_text ltx_font_italic">3rd International Conference on Learning Representations, ICLR 2015, San Diego, CA, USA, May 7-9, 2015, Conference Track Proceedings</span>, 2015.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Nitish Srivastava, Geoffrey Hinton, Alex Krizhevsky, Ilya Sutskever, and Ruslan Salakhutdinov.

</span>
<span class="ltx_bibblock">Dropout: a simple way to prevent neural networks from overfitting.

</span>
<span class="ltx_bibblock"><span id="bib.bib43.1.1" class="ltx_text ltx_font_italic">The journal of machine learning research</span>, 15(1):1929–1958, 2014.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Implementation Details.</h2>

<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>L-ICV Hyperparameters</h3>

<div id="A1.SS1.p1" class="ltx_para">
<p id="A1.SS1.p1.4" class="ltx_p">Table <a href="#A1.T7" title="Table 7 ‣ A.1 L-ICV Hyperparameters ‣ Appendix A Implementation Details. ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> presents the hyper-parameters utilized for training the L-ICV. The optimizer denotes the optimization algorithm employed during model training. For <math id="A1.SS1.p1.1.m1.1" class="ltx_Math" alttext="\bm{V}" display="inline"><semantics id="A1.SS1.p1.1.m1.1a"><mi id="A1.SS1.p1.1.m1.1.1" xref="A1.SS1.p1.1.m1.1.1.cmml">𝑽</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.1.m1.1b"><ci id="A1.SS1.p1.1.m1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1">𝑽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.1.m1.1c">\bm{V}</annotation></semantics></math> and <math id="A1.SS1.p1.2.m2.1" class="ltx_Math" alttext="\bm{\alpha}" display="inline"><semantics id="A1.SS1.p1.2.m2.1a"><mi id="A1.SS1.p1.2.m2.1.1" xref="A1.SS1.p1.2.m2.1.1.cmml">𝜶</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.2.m2.1b"><ci id="A1.SS1.p1.2.m2.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1">𝜶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.2.m2.1c">\bm{\alpha}</annotation></semantics></math>, we use different learning rate to optimize. The <math id="A1.SS1.p1.3.m3.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="A1.SS1.p1.3.m3.1a"><mi id="A1.SS1.p1.3.m3.1.1" xref="A1.SS1.p1.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.3.m3.1b"><ci id="A1.SS1.p1.3.m3.1.1.cmml" xref="A1.SS1.p1.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.3.m3.1c">\lambda</annotation></semantics></math> represents the weight assigned to <math id="A1.SS1.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{L}_{\text{gt}}" display="inline"><semantics id="A1.SS1.p1.4.m4.1a"><msub id="A1.SS1.p1.4.m4.1.1" xref="A1.SS1.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS1.p1.4.m4.1.1.2" xref="A1.SS1.p1.4.m4.1.1.2.cmml">ℒ</mi><mtext id="A1.SS1.p1.4.m4.1.1.3" xref="A1.SS1.p1.4.m4.1.1.3a.cmml">gt</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.4.m4.1b"><apply id="A1.SS1.p1.4.m4.1.1.cmml" xref="A1.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.4.m4.1.1.1.cmml" xref="A1.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="A1.SS1.p1.4.m4.1.1.2.cmml" xref="A1.SS1.p1.4.m4.1.1.2">ℒ</ci><ci id="A1.SS1.p1.4.m4.1.1.3a.cmml" xref="A1.SS1.p1.4.m4.1.1.3"><mtext mathsize="70%" id="A1.SS1.p1.4.m4.1.1.3.cmml" xref="A1.SS1.p1.4.m4.1.1.3">gt</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.4.m4.1c">\mathcal{L}_{\text{gt}}</annotation></semantics></math> in Eq <a href="#S3.E7" title="In 3 Learnable In-Context Vector ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> during training. Precision refers to the float precision type used for model weights and gradient descent throughout the ICV training process. Weight Decay signifies the rate of weight decay applied during training, the warm up value is set to 0.01. while accumulate batches denotes the batch size for gradient accumulation during the training phase.</p>
</div>
<figure id="A1.T7" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>VQAv2 and OKVQA L-ICV Training Parameters</figcaption>
<table id="A1.T7.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A1.T7.3.4.1" class="ltx_tr">
<th id="A1.T7.3.4.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt"><span id="A1.T7.3.4.1.1.1" class="ltx_text ltx_font_bold">Hyperparameter</span></th>
<td id="A1.T7.3.4.1.2" class="ltx_td ltx_align_left ltx_border_tt"><span id="A1.T7.3.4.1.2.1" class="ltx_text ltx_font_bold">VQAv2</span></td>
<td id="A1.T7.3.4.1.3" class="ltx_td ltx_align_left ltx_border_tt"><span id="A1.T7.3.4.1.3.1" class="ltx_text ltx_font_bold">OKVQA</span></td>
</tr>
<tr id="A1.T7.3.5.2" class="ltx_tr">
<th id="A1.T7.3.5.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">optimizer</th>
<td id="A1.T7.3.5.2.2" class="ltx_td ltx_align_left ltx_border_t">AdamW <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>
</td>
<td id="A1.T7.3.5.2.3" class="ltx_td ltx_align_left ltx_border_t">AdamW</td>
</tr>
<tr id="A1.T7.1.1" class="ltx_tr">
<th id="A1.T7.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">learning rate of <math id="A1.T7.1.1.1.m1.1" class="ltx_Math" alttext="\bm{\alpha}" display="inline"><semantics id="A1.T7.1.1.1.m1.1a"><mi id="A1.T7.1.1.1.m1.1.1" xref="A1.T7.1.1.1.m1.1.1.cmml">𝜶</mi><annotation-xml encoding="MathML-Content" id="A1.T7.1.1.1.m1.1b"><ci id="A1.T7.1.1.1.m1.1.1.cmml" xref="A1.T7.1.1.1.m1.1.1">𝜶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.1.1.1.m1.1c">\bm{\alpha}</annotation></semantics></math>
</th>
<td id="A1.T7.1.1.2" class="ltx_td ltx_align_left">1e-2</td>
<td id="A1.T7.1.1.3" class="ltx_td ltx_align_left">1e-2</td>
</tr>
<tr id="A1.T7.2.2" class="ltx_tr">
<th id="A1.T7.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">learning rate of <math id="A1.T7.2.2.1.m1.1" class="ltx_Math" alttext="\bm{V}" display="inline"><semantics id="A1.T7.2.2.1.m1.1a"><mi id="A1.T7.2.2.1.m1.1.1" xref="A1.T7.2.2.1.m1.1.1.cmml">𝑽</mi><annotation-xml encoding="MathML-Content" id="A1.T7.2.2.1.m1.1b"><ci id="A1.T7.2.2.1.m1.1.1.cmml" xref="A1.T7.2.2.1.m1.1.1">𝑽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.2.2.1.m1.1c">\bm{V}</annotation></semantics></math>
</th>
<td id="A1.T7.2.2.2" class="ltx_td ltx_align_left">1e-3</td>
<td id="A1.T7.2.2.3" class="ltx_td ltx_align_left">5e-3</td>
</tr>
<tr id="A1.T7.3.3" class="ltx_tr">
<th id="A1.T7.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="A1.T7.3.3.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="A1.T7.3.3.1.m1.1a"><mi id="A1.T7.3.3.1.m1.1.1" xref="A1.T7.3.3.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A1.T7.3.3.1.m1.1b"><ci id="A1.T7.3.3.1.m1.1.1.cmml" xref="A1.T7.3.3.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.3.3.1.m1.1c">\lambda</annotation></semantics></math></th>
<td id="A1.T7.3.3.2" class="ltx_td ltx_align_left">0.5</td>
<td id="A1.T7.3.3.3" class="ltx_td ltx_align_left">0.5</td>
</tr>
<tr id="A1.T7.3.6.3" class="ltx_tr">
<th id="A1.T7.3.6.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">weight decay</th>
<td id="A1.T7.3.6.3.2" class="ltx_td ltx_align_left">1e-3</td>
<td id="A1.T7.3.6.3.3" class="ltx_td ltx_align_left">1e-3</td>
</tr>
<tr id="A1.T7.3.7.4" class="ltx_tr">
<th id="A1.T7.3.7.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">precision</th>
<td id="A1.T7.3.7.4.2" class="ltx_td ltx_align_left">BF16</td>
<td id="A1.T7.3.7.4.3" class="ltx_td ltx_align_left">BF16</td>
</tr>
<tr id="A1.T7.3.8.5" class="ltx_tr">
<th id="A1.T7.3.8.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">batch size</th>
<td id="A1.T7.3.8.5.2" class="ltx_td ltx_align_left">2</td>
<td id="A1.T7.3.8.5.3" class="ltx_td ltx_align_left">2</td>
</tr>
<tr id="A1.T7.3.9.6" class="ltx_tr">
<th id="A1.T7.3.9.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">warm up</th>
<td id="A1.T7.3.9.6.2" class="ltx_td ltx_align_left">0.1</td>
<td id="A1.T7.3.9.6.3" class="ltx_td ltx_align_left">0.1</td>
</tr>
<tr id="A1.T7.3.10.7" class="ltx_tr">
<th id="A1.T7.3.10.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">accumulate batches</th>
<td id="A1.T7.3.10.7.2" class="ltx_td ltx_align_left">8</td>
<td id="A1.T7.3.10.7.3" class="ltx_td ltx_align_left">8</td>
</tr>
<tr id="A1.T7.3.11.8" class="ltx_tr">
<th id="A1.T7.3.11.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">number of epochs</th>
<td id="A1.T7.3.11.8.2" class="ltx_td ltx_align_left ltx_border_bb">10</td>
<td id="A1.T7.3.11.8.3" class="ltx_td ltx_align_left ltx_border_bb">10</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>LoRA Hyperparameters</h3>

<div id="A1.SS2.p1" class="ltx_para">
<p id="A1.SS2.p1.1" class="ltx_p">Table  <a href="#A1.T8" title="Table 8 ‣ A.2 LoRA Hyperparameters ‣ Appendix A Implementation Details. ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> details the hyper-parameters for the LoRA model trained during our experiment. Both the OKVQA and VQAv2 datasets use the same hyper-parameters.</p>
</div>
<figure id="A1.T8" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span>LoRA Training Parameters</figcaption>
<table id="A1.T8.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A1.T8.1.1.1" class="ltx_tr">
<th id="A1.T8.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt"><span id="A1.T8.1.1.1.1.1" class="ltx_text ltx_font_bold">Hyperparameter</span></th>
<td id="A1.T8.1.1.1.2" class="ltx_td ltx_align_left ltx_border_tt"><span id="A1.T8.1.1.1.2.1" class="ltx_text ltx_font_bold">Value</span></td>
</tr>
<tr id="A1.T8.1.2.2" class="ltx_tr">
<th id="A1.T8.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">optimizer</th>
<td id="A1.T8.1.2.2.2" class="ltx_td ltx_align_left ltx_border_t">AdamW</td>
</tr>
<tr id="A1.T8.1.3.3" class="ltx_tr">
<th id="A1.T8.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">learning rate</th>
<td id="A1.T8.1.3.3.2" class="ltx_td ltx_align_left">1e-3</td>
</tr>
<tr id="A1.T8.1.4.4" class="ltx_tr">
<th id="A1.T8.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">LoRA matrix rank</th>
<td id="A1.T8.1.4.4.2" class="ltx_td ltx_align_left">32</td>
</tr>
<tr id="A1.T8.1.5.5" class="ltx_tr">
<th id="A1.T8.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">LoRA dropout rate<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>
</th>
<td id="A1.T8.1.5.5.2" class="ltx_td ltx_align_left">0.05</td>
</tr>
<tr id="A1.T8.1.6.6" class="ltx_tr">
<th id="A1.T8.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">batch size</th>
<td id="A1.T8.1.6.6.2" class="ltx_td ltx_align_left">2</td>
</tr>
<tr id="A1.T8.1.7.7" class="ltx_tr">
<th id="A1.T8.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">warm up</th>
<td id="A1.T8.1.7.7.2" class="ltx_td ltx_align_left">0.1</td>
</tr>
<tr id="A1.T8.1.8.8" class="ltx_tr">
<th id="A1.T8.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">number of epochs</th>
<td id="A1.T8.1.8.8.2" class="ltx_td ltx_align_left ltx_border_bb">10</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="A1.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Inference and hardware details</h3>

<div id="A1.SS3.p1" class="ltx_para">
<p id="A1.SS3.p1.1" class="ltx_p">In our ICV inference process, we employ the following hyperparameters: For ICV model inference, the maximum number of new tokens is set to 5, the number of beam searches is set to 3, the length penalty is set to 0, and the minimum number of generated tokens is set to 0. During the inference process, we utilize two Xeon Silver 3414 CPUs, one RTX 3090 GPU, and 384 GB of memory.</p>
</div>
</section>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Detailed Results</h2>

<section id="A2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>The Detailed Inference Speed Experiments</h3>

<div id="A2.SS1.p1" class="ltx_para">
<p id="A2.SS1.p1.1" class="ltx_p">This subsection provides a detailed presentation of some experimental data, primarily including forward propagation FLOPs and runtime cost, as well as a comparison of specific data between L-ICV and LoRA.
Table <a href="#A2.T9" title="Table 9 ‣ B.1 The Detailed Inference Speed Experiments ‣ Appendix B Detailed Results ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> presents the detailed results of the runtime and the FLOPs shown in Figure <a href="#S4.F3" title="Figure 3 ‣ 4.2.2 Performance and Inference Efficiency on VQA. ‣ 4.2 Results ‣ 4 Experiments ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. For a forward operation L-ICV compared to k-shot ICL. The average token length during the forward inference is 38 tokens for Zero-Shot and L-ICV, 107 tokens for 4-shot ICL, 187 tokens for 8-shot ICL, 330 tokens for 16-shot ICL, and 633 tokens for 32-shot ICL.</p>
</div>
<figure id="A2.T9" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 9: </span>Comparison of FLOPs and Runtime for L-ICV and <math id="A2.T9.2.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A2.T9.2.m1.1b"><mi id="A2.T9.2.m1.1.1" xref="A2.T9.2.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A2.T9.2.m1.1c"><ci id="A2.T9.2.m1.1.1.cmml" xref="A2.T9.2.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T9.2.m1.1d">k</annotation></semantics></math>-shot ICL</figcaption>
<div id="A2.T9.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:53.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-0.3pt,0.0pt) scale(0.998611670820503,0.998611670820503) ;">
<table id="A2.T9.3.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A2.T9.3.1.1.1" class="ltx_tr">
<th id="A2.T9.3.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt">Mertic</th>
<th id="A2.T9.3.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Zero-Shot</th>
<th id="A2.T9.3.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">L-ICV</th>
<th id="A2.T9.3.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">4-shot ICL</th>
<th id="A2.T9.3.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">8-shot ICL</th>
<th id="A2.T9.3.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">16-shot ICL</th>
<th id="A2.T9.3.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">32-shot ICL</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A2.T9.3.1.2.1" class="ltx_tr">
<th id="A2.T9.3.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">FLOPs (TFLOPs)</th>
<td id="A2.T9.3.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">0.935</td>
<td id="A2.T9.3.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">0.936</td>
<td id="A2.T9.3.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">3.568</td>
<td id="A2.T9.3.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">6.375</td>
<td id="A2.T9.3.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t">12.341</td>
<td id="A2.T9.3.1.2.1.7" class="ltx_td ltx_align_center ltx_border_t">23.364</td>
</tr>
<tr id="A2.T9.3.1.3.2" class="ltx_tr">
<th id="A2.T9.3.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r">Runtime (ms)</th>
<td id="A2.T9.3.1.3.2.2" class="ltx_td ltx_align_center ltx_border_bb">56.69</td>
<td id="A2.T9.3.1.3.2.3" class="ltx_td ltx_align_center ltx_border_bb">56.81</td>
<td id="A2.T9.3.1.3.2.4" class="ltx_td ltx_align_center ltx_border_bb">92.44</td>
<td id="A2.T9.3.1.3.2.5" class="ltx_td ltx_align_center ltx_border_bb">158.21</td>
<td id="A2.T9.3.1.3.2.6" class="ltx_td ltx_align_center ltx_border_bb">266.13</td>
<td id="A2.T9.3.1.3.2.7" class="ltx_td ltx_align_center ltx_border_bb">468.55</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="A2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>The Detailed Accuracy of Different Training Dataset </h3>

<div id="A2.SS2.p1" class="ltx_para">
<p id="A2.SS2.p1.1" class="ltx_p">Table <a href="#A2.T10" title="Table 10 ‣ B.3 Non-Learnable Methods Results ‣ Appendix B Detailed Results ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a> presents a comparative analysis of the results between LoRA and L-ICV results on different training dataset size in Section <a href="#S4.SS3" title="4.3 Ablation Studies ‣ 4 Experiments ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>.</p>
</div>
</section>
<section id="A2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3 </span>Non-Learnable Methods Results</h3>

<div id="A2.SS3.p1" class="ltx_para ltx_noindent">
<p id="A2.SS3.p1.1" class="ltx_p"><span id="A2.SS3.p1.1.1" class="ltx_text ltx_font_bold">Function Vector:</span>
This section examines the test results of the function vector employed in the experiment across different layers of the IDEFICS-9B model. Table  <a href="#A2.T11" title="Table 11 ‣ B.3 Non-Learnable Methods Results ‣ Appendix B Detailed Results ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a> presents the test results for VQAv2, and Table <a href="#A2.T12" title="Table 12 ‣ B.3 Non-Learnable Methods Results ‣ Appendix B Detailed Results ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a> shows the test results for OKVQA. The Best result of VQAv2 is 10th layer’s result, which reaches 30.21, and the best result of OKVQA is 31.02 from the first layer.</p>
</div>
<figure id="A2.T10" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 10: </span>Accuracy (%) of LoRA and L-ICV on different training set sizes </figcaption>
<div id="A2.T10.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:107pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-2.1pt,0.5pt) scale(0.990626257445936,0.990626257445936) ;">
<table id="A2.T10.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A2.T10.1.1.1.1" class="ltx_tr">
<th id="A2.T10.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" rowspan="2"><span id="A2.T10.1.1.1.1.1.1" class="ltx_text">Dataset</span></th>
<th id="A2.T10.1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" rowspan="2"><span id="A2.T10.1.1.1.1.2.1" class="ltx_text">Method</span></th>
<th id="A2.T10.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="10">Training set size</th>
</tr>
<tr id="A2.T10.1.1.2.2" class="ltx_tr">
<th id="A2.T10.1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">100</th>
<th id="A2.T10.1.1.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">300</th>
<th id="A2.T10.1.1.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">500</th>
<th id="A2.T10.1.1.2.2.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">700</th>
<th id="A2.T10.1.1.2.2.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">900</th>
<th id="A2.T10.1.1.2.2.6" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">1000</th>
<th id="A2.T10.1.1.2.2.7" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">2000</th>
<th id="A2.T10.1.1.2.2.8" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">4000</th>
<th id="A2.T10.1.1.2.2.9" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">6000</th>
<th id="A2.T10.1.1.2.2.10" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_t">8000</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A2.T10.1.1.3.1" class="ltx_tr">
<th id="A2.T10.1.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="2"><span id="A2.T10.1.1.3.1.1.1" class="ltx_text">VQAv2</span></th>
<th id="A2.T10.1.1.3.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">L-ICV</th>
<td id="A2.T10.1.1.3.1.3" class="ltx_td ltx_align_left ltx_border_t">29.43</td>
<td id="A2.T10.1.1.3.1.4" class="ltx_td ltx_align_left ltx_border_t">49.66</td>
<td id="A2.T10.1.1.3.1.5" class="ltx_td ltx_align_left ltx_border_t">49.93</td>
<td id="A2.T10.1.1.3.1.6" class="ltx_td ltx_align_left ltx_border_t">51.03</td>
<td id="A2.T10.1.1.3.1.7" class="ltx_td ltx_align_left ltx_border_t">53.42</td>
<td id="A2.T10.1.1.3.1.8" class="ltx_td ltx_align_left ltx_border_t">53.71</td>
<td id="A2.T10.1.1.3.1.9" class="ltx_td ltx_align_left ltx_border_t">56.64</td>
<td id="A2.T10.1.1.3.1.10" class="ltx_td ltx_align_left ltx_border_t">57.76</td>
<td id="A2.T10.1.1.3.1.11" class="ltx_td ltx_align_left ltx_border_t">58.33</td>
<td id="A2.T10.1.1.3.1.12" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t">58.54</td>
</tr>
<tr id="A2.T10.1.1.4.2" class="ltx_tr">
<th id="A2.T10.1.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">LoRA</th>
<td id="A2.T10.1.1.4.2.2" class="ltx_td ltx_align_left">29.52</td>
<td id="A2.T10.1.1.4.2.3" class="ltx_td ltx_align_left">39.02</td>
<td id="A2.T10.1.1.4.2.4" class="ltx_td ltx_align_left">40.01</td>
<td id="A2.T10.1.1.4.2.5" class="ltx_td ltx_align_left">40.99</td>
<td id="A2.T10.1.1.4.2.6" class="ltx_td ltx_align_left">41.99</td>
<td id="A2.T10.1.1.4.2.7" class="ltx_td ltx_align_left">42.81</td>
<td id="A2.T10.1.1.4.2.8" class="ltx_td ltx_align_left">45.26</td>
<td id="A2.T10.1.1.4.2.9" class="ltx_td ltx_align_left">47.71</td>
<td id="A2.T10.1.1.4.2.10" class="ltx_td ltx_align_left">48.51</td>
<td id="A2.T10.1.1.4.2.11" class="ltx_td ltx_nopad_r ltx_align_left">49.02</td>
</tr>
<tr id="A2.T10.1.1.5.3" class="ltx_tr">
<th id="A2.T10.1.1.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" rowspan="2"><span id="A2.T10.1.1.5.3.1.1" class="ltx_text">OKVQA</span></th>
<th id="A2.T10.1.1.5.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">L-ICV</th>
<td id="A2.T10.1.1.5.3.3" class="ltx_td ltx_align_left ltx_border_t">30.64</td>
<td id="A2.T10.1.1.5.3.4" class="ltx_td ltx_align_left ltx_border_t">38.41</td>
<td id="A2.T10.1.1.5.3.5" class="ltx_td ltx_align_left ltx_border_t">41.87</td>
<td id="A2.T10.1.1.5.3.6" class="ltx_td ltx_align_left ltx_border_t">45.82</td>
<td id="A2.T10.1.1.5.3.7" class="ltx_td ltx_align_left ltx_border_t">46.09</td>
<td id="A2.T10.1.1.5.3.8" class="ltx_td ltx_align_left ltx_border_t">46.05</td>
<td id="A2.T10.1.1.5.3.9" class="ltx_td ltx_align_left ltx_border_t">47.22</td>
<td id="A2.T10.1.1.5.3.10" class="ltx_td ltx_align_left ltx_border_t">48.39</td>
<td id="A2.T10.1.1.5.3.11" class="ltx_td ltx_align_left ltx_border_t">49.68</td>
<td id="A2.T10.1.1.5.3.12" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t">50.08</td>
</tr>
<tr id="A2.T10.1.1.6.4" class="ltx_tr">
<th id="A2.T10.1.1.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r">LORA</th>
<td id="A2.T10.1.1.6.4.2" class="ltx_td ltx_align_left ltx_border_bb">30.37</td>
<td id="A2.T10.1.1.6.4.3" class="ltx_td ltx_align_left ltx_border_bb">13.38</td>
<td id="A2.T10.1.1.6.4.4" class="ltx_td ltx_align_left ltx_border_bb">20.01</td>
<td id="A2.T10.1.1.6.4.5" class="ltx_td ltx_align_left ltx_border_bb">23.42</td>
<td id="A2.T10.1.1.6.4.6" class="ltx_td ltx_align_left ltx_border_bb">25.01</td>
<td id="A2.T10.1.1.6.4.7" class="ltx_td ltx_align_left ltx_border_bb">25.66</td>
<td id="A2.T10.1.1.6.4.8" class="ltx_td ltx_align_left ltx_border_bb">29.52</td>
<td id="A2.T10.1.1.6.4.9" class="ltx_td ltx_align_left ltx_border_bb">33.08</td>
<td id="A2.T10.1.1.6.4.10" class="ltx_td ltx_align_left ltx_border_bb">34.17</td>
<td id="A2.T10.1.1.6.4.11" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb">34.21</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="A2.T11" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 11: </span>The Function Vector Accuracy (%) acorss differnt layers on VQAv2.</figcaption>
<div id="A2.T11.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:169.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(33.0pt,-12.9pt) scale(1.17964896608465,1.17964896608465) ;">
<table id="A2.T11.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A2.T11.1.1.1.1" class="ltx_tr">
<th id="A2.T11.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt">VQAv2</th>
<th id="A2.T11.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:1</th>
<th id="A2.T11.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:2</th>
<th id="A2.T11.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:3</th>
<th id="A2.T11.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:4</th>
<th id="A2.T11.1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:5</th>
<th id="A2.T11.1.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:6</th>
<th id="A2.T11.1.1.1.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:7</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A2.T11.1.1.2.1" class="ltx_tr">
<th id="A2.T11.1.1.2.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="A2.T11.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">29.28</td>
<td id="A2.T11.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">29.0</td>
<td id="A2.T11.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">28.5</td>
<td id="A2.T11.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">27.43</td>
<td id="A2.T11.1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t">27.94</td>
<td id="A2.T11.1.1.2.1.7" class="ltx_td ltx_align_center ltx_border_t">28.7</td>
<td id="A2.T11.1.1.2.1.8" class="ltx_td ltx_align_center ltx_border_t">29.17</td>
</tr>
<tr id="A2.T11.1.1.3.2" class="ltx_tr">
<th id="A2.T11.1.1.3.2.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="A2.T11.1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_t">layer:9</td>
<td id="A2.T11.1.1.3.2.3" class="ltx_td ltx_align_center ltx_border_t">layer:10</td>
<td id="A2.T11.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_t">layer:11</td>
<td id="A2.T11.1.1.3.2.5" class="ltx_td ltx_align_center ltx_border_t">layer:12</td>
<td id="A2.T11.1.1.3.2.6" class="ltx_td ltx_align_center ltx_border_t">layer:13</td>
<td id="A2.T11.1.1.3.2.7" class="ltx_td ltx_align_center ltx_border_t">layer:14</td>
<td id="A2.T11.1.1.3.2.8" class="ltx_td ltx_align_center ltx_border_t">layer:15</td>
</tr>
<tr id="A2.T11.1.1.4.3" class="ltx_tr">
<th id="A2.T11.1.1.4.3.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="A2.T11.1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_t">29.34</td>
<td id="A2.T11.1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_t">30.21</td>
<td id="A2.T11.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_t">29.94</td>
<td id="A2.T11.1.1.4.3.5" class="ltx_td ltx_align_center ltx_border_t">29.48</td>
<td id="A2.T11.1.1.4.3.6" class="ltx_td ltx_align_center ltx_border_t">29.52</td>
<td id="A2.T11.1.1.4.3.7" class="ltx_td ltx_align_center ltx_border_t">29.38</td>
<td id="A2.T11.1.1.4.3.8" class="ltx_td ltx_align_center ltx_border_t">29.62</td>
</tr>
<tr id="A2.T11.1.1.5.4" class="ltx_tr">
<th id="A2.T11.1.1.5.4.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="A2.T11.1.1.5.4.2" class="ltx_td ltx_align_center ltx_border_t">layer:17</td>
<td id="A2.T11.1.1.5.4.3" class="ltx_td ltx_align_center ltx_border_t">layer:18</td>
<td id="A2.T11.1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_t">layer:19</td>
<td id="A2.T11.1.1.5.4.5" class="ltx_td ltx_align_center ltx_border_t">layer:20</td>
<td id="A2.T11.1.1.5.4.6" class="ltx_td ltx_align_center ltx_border_t">layer:21</td>
<td id="A2.T11.1.1.5.4.7" class="ltx_td ltx_align_center ltx_border_t">layer:22</td>
<td id="A2.T11.1.1.5.4.8" class="ltx_td ltx_align_center ltx_border_t">layer:23</td>
</tr>
<tr id="A2.T11.1.1.6.5" class="ltx_tr">
<th id="A2.T11.1.1.6.5.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="A2.T11.1.1.6.5.2" class="ltx_td ltx_align_center ltx_border_t">29.51</td>
<td id="A2.T11.1.1.6.5.3" class="ltx_td ltx_align_center ltx_border_t">29.59</td>
<td id="A2.T11.1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_t">29.5</td>
<td id="A2.T11.1.1.6.5.5" class="ltx_td ltx_align_center ltx_border_t">29.28</td>
<td id="A2.T11.1.1.6.5.6" class="ltx_td ltx_align_center ltx_border_t">29.24</td>
<td id="A2.T11.1.1.6.5.7" class="ltx_td ltx_align_center ltx_border_t">29.29</td>
<td id="A2.T11.1.1.6.5.8" class="ltx_td ltx_align_center ltx_border_t">29.11</td>
</tr>
<tr id="A2.T11.1.1.7.6" class="ltx_tr">
<th id="A2.T11.1.1.7.6.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="A2.T11.1.1.7.6.2" class="ltx_td ltx_align_center ltx_border_t">layer:25</td>
<td id="A2.T11.1.1.7.6.3" class="ltx_td ltx_align_center ltx_border_t">layer:26</td>
<td id="A2.T11.1.1.7.6.4" class="ltx_td ltx_align_center ltx_border_t">layer:27</td>
<td id="A2.T11.1.1.7.6.5" class="ltx_td ltx_align_center ltx_border_t">layer:28</td>
<td id="A2.T11.1.1.7.6.6" class="ltx_td ltx_align_center ltx_border_t">layer:29</td>
<td id="A2.T11.1.1.7.6.7" class="ltx_td ltx_align_center ltx_border_t">layer:30</td>
<td id="A2.T11.1.1.7.6.8" class="ltx_td ltx_align_center ltx_border_t">layer:31</td>
</tr>
<tr id="A2.T11.1.1.8.7" class="ltx_tr">
<th id="A2.T11.1.1.8.7.1" class="ltx_td ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t"></th>
<td id="A2.T11.1.1.8.7.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">29.34</td>
<td id="A2.T11.1.1.8.7.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">29.19</td>
<td id="A2.T11.1.1.8.7.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">29.26</td>
<td id="A2.T11.1.1.8.7.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">29.18</td>
<td id="A2.T11.1.1.8.7.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">29.19</td>
<td id="A2.T11.1.1.8.7.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">29.45</td>
<td id="A2.T11.1.1.8.7.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">29.32</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="A2.T12" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 12: </span>The Function Vector Accuracy (%) acorss differnt layers on OKVQA</figcaption>
<div id="A2.T12.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:149.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(7.6pt,-2.6pt) scale(1.0361273583633,1.0361273583633) ;">
<table id="A2.T12.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A2.T12.1.1.1.1" class="ltx_tr">
<th id="A2.T12.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt">OKVQA</th>
<th id="A2.T12.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:1</th>
<th id="A2.T12.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:2</th>
<th id="A2.T12.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:3</th>
<th id="A2.T12.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:4</th>
<th id="A2.T12.1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:5</th>
<th id="A2.T12.1.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:6</th>
<th id="A2.T12.1.1.1.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:7</th>
<th id="A2.T12.1.1.1.1.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:8</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A2.T12.1.1.2.1" class="ltx_tr">
<th id="A2.T12.1.1.2.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="A2.T12.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">31.02</td>
<td id="A2.T12.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">30.57</td>
<td id="A2.T12.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">30.23</td>
<td id="A2.T12.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">30.27</td>
<td id="A2.T12.1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t">30.04</td>
<td id="A2.T12.1.1.2.1.7" class="ltx_td ltx_align_center ltx_border_t">30.36</td>
<td id="A2.T12.1.1.2.1.8" class="ltx_td ltx_align_center ltx_border_t">30.61</td>
<td id="A2.T12.1.1.2.1.9" class="ltx_td ltx_align_center ltx_border_t">30.23</td>
</tr>
<tr id="A2.T12.1.1.3.2" class="ltx_tr">
<th id="A2.T12.1.1.3.2.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="A2.T12.1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_t">layer:9</td>
<td id="A2.T12.1.1.3.2.3" class="ltx_td ltx_align_center ltx_border_t">layer:10</td>
<td id="A2.T12.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_t">layer:11</td>
<td id="A2.T12.1.1.3.2.5" class="ltx_td ltx_align_center ltx_border_t">layer:12</td>
<td id="A2.T12.1.1.3.2.6" class="ltx_td ltx_align_center ltx_border_t">layer:13</td>
<td id="A2.T12.1.1.3.2.7" class="ltx_td ltx_align_center ltx_border_t">layer:14</td>
<td id="A2.T12.1.1.3.2.8" class="ltx_td ltx_align_center ltx_border_t">layer:15</td>
<td id="A2.T12.1.1.3.2.9" class="ltx_td ltx_align_center ltx_border_t">layer:16</td>
</tr>
<tr id="A2.T12.1.1.4.3" class="ltx_tr">
<th id="A2.T12.1.1.4.3.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="A2.T12.1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_t">30.56</td>
<td id="A2.T12.1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_t">30.62</td>
<td id="A2.T12.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_t">30.6</td>
<td id="A2.T12.1.1.4.3.5" class="ltx_td ltx_align_center ltx_border_t">30.27</td>
<td id="A2.T12.1.1.4.3.6" class="ltx_td ltx_align_center ltx_border_t">30.22</td>
<td id="A2.T12.1.1.4.3.7" class="ltx_td ltx_align_center ltx_border_t">30.19</td>
<td id="A2.T12.1.1.4.3.8" class="ltx_td ltx_align_center ltx_border_t">30.2</td>
<td id="A2.T12.1.1.4.3.9" class="ltx_td ltx_align_center ltx_border_t">30.3</td>
</tr>
<tr id="A2.T12.1.1.5.4" class="ltx_tr">
<th id="A2.T12.1.1.5.4.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="A2.T12.1.1.5.4.2" class="ltx_td ltx_align_center ltx_border_t">layer:17</td>
<td id="A2.T12.1.1.5.4.3" class="ltx_td ltx_align_center ltx_border_t">layer:18</td>
<td id="A2.T12.1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_t">layer:19</td>
<td id="A2.T12.1.1.5.4.5" class="ltx_td ltx_align_center ltx_border_t">layer:20</td>
<td id="A2.T12.1.1.5.4.6" class="ltx_td ltx_align_center ltx_border_t">layer:21</td>
<td id="A2.T12.1.1.5.4.7" class="ltx_td ltx_align_center ltx_border_t">layer:22</td>
<td id="A2.T12.1.1.5.4.8" class="ltx_td ltx_align_center ltx_border_t">layer:23</td>
<td id="A2.T12.1.1.5.4.9" class="ltx_td ltx_align_center ltx_border_t">layer:24</td>
</tr>
<tr id="A2.T12.1.1.6.5" class="ltx_tr">
<th id="A2.T12.1.1.6.5.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="A2.T12.1.1.6.5.2" class="ltx_td ltx_align_center ltx_border_t">30.44</td>
<td id="A2.T12.1.1.6.5.3" class="ltx_td ltx_align_center ltx_border_t">30.25</td>
<td id="A2.T12.1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_t">30.27</td>
<td id="A2.T12.1.1.6.5.5" class="ltx_td ltx_align_center ltx_border_t">30.17</td>
<td id="A2.T12.1.1.6.5.6" class="ltx_td ltx_align_center ltx_border_t">30.22</td>
<td id="A2.T12.1.1.6.5.7" class="ltx_td ltx_align_center ltx_border_t">30.16</td>
<td id="A2.T12.1.1.6.5.8" class="ltx_td ltx_align_center ltx_border_t">30.31</td>
<td id="A2.T12.1.1.6.5.9" class="ltx_td ltx_align_center ltx_border_t">30.23</td>
</tr>
<tr id="A2.T12.1.1.7.6" class="ltx_tr">
<th id="A2.T12.1.1.7.6.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="A2.T12.1.1.7.6.2" class="ltx_td ltx_align_center ltx_border_t">layer:25</td>
<td id="A2.T12.1.1.7.6.3" class="ltx_td ltx_align_center ltx_border_t">layer:26</td>
<td id="A2.T12.1.1.7.6.4" class="ltx_td ltx_align_center ltx_border_t">layer:27</td>
<td id="A2.T12.1.1.7.6.5" class="ltx_td ltx_align_center ltx_border_t">layer:28</td>
<td id="A2.T12.1.1.7.6.6" class="ltx_td ltx_align_center ltx_border_t">layer:29</td>
<td id="A2.T12.1.1.7.6.7" class="ltx_td ltx_align_center ltx_border_t">layer:30</td>
<td id="A2.T12.1.1.7.6.8" class="ltx_td ltx_align_center ltx_border_t">layer:31</td>
<td id="A2.T12.1.1.7.6.9" class="ltx_td ltx_align_center ltx_border_t">layer:32</td>
</tr>
<tr id="A2.T12.1.1.8.7" class="ltx_tr">
<th id="A2.T12.1.1.8.7.1" class="ltx_td ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t"></th>
<td id="A2.T12.1.1.8.7.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">30.42</td>
<td id="A2.T12.1.1.8.7.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">30.32</td>
<td id="A2.T12.1.1.8.7.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">30.34</td>
<td id="A2.T12.1.1.8.7.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">30.25</td>
<td id="A2.T12.1.1.8.7.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">30.3</td>
<td id="A2.T12.1.1.8.7.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">30.34</td>
<td id="A2.T12.1.1.8.7.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">30.4</td>
<td id="A2.T12.1.1.8.7.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">30.28</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="A2.SS3.p2" class="ltx_para ltx_noindent">
<p id="A2.SS3.p2.1" class="ltx_p"><span id="A2.SS3.p2.1.1" class="ltx_text ltx_font_bold">Task Vector:</span>
This section examines the test results of the task vector utilized in the experiment across various layers of the IDEFICS model. Table <a href="#A2.T13" title="Table 13 ‣ B.3 Non-Learnable Methods Results ‣ Appendix B Detailed Results ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a> displays the test results for VQAv2, while Table <a href="#A2.T14" title="Table 14 ‣ B.3 Non-Learnable Methods Results ‣ Appendix B Detailed Results ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a> shows the test results for OKVQA. The task vector is derived using 32 question-answer pairs. The best result of the task vector on VQAv2 is at the 10th layer, reaching 43.68, while the best result on OKVQA is at the 12th layer, reaching 32.68.</p>
</div>
<figure id="A2.T13" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 13: </span>The Task Vector Accuracy (%) acorss differnt layers on VQAv2</figcaption>
<div id="A2.T13.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:169.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(33.0pt,-12.9pt) scale(1.17964896608465,1.17964896608465) ;">
<table id="A2.T13.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A2.T13.1.1.1.1" class="ltx_tr">
<th id="A2.T13.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt">VQAv2</th>
<th id="A2.T13.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:1</th>
<th id="A2.T13.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:2</th>
<th id="A2.T13.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:3</th>
<th id="A2.T13.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:4</th>
<th id="A2.T13.1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:5</th>
<th id="A2.T13.1.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:6</th>
<th id="A2.T13.1.1.1.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:7</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A2.T13.1.1.2.1" class="ltx_tr">
<th id="A2.T13.1.1.2.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="A2.T13.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">28.18</td>
<td id="A2.T13.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">28.82</td>
<td id="A2.T13.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">30.47</td>
<td id="A2.T13.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">30.53</td>
<td id="A2.T13.1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t">36.41</td>
<td id="A2.T13.1.1.2.1.7" class="ltx_td ltx_align_center ltx_border_t">35.35</td>
<td id="A2.T13.1.1.2.1.8" class="ltx_td ltx_align_center ltx_border_t">36.17</td>
</tr>
<tr id="A2.T13.1.1.3.2" class="ltx_tr">
<th id="A2.T13.1.1.3.2.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="A2.T13.1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_t">layer:9</td>
<td id="A2.T13.1.1.3.2.3" class="ltx_td ltx_align_center ltx_border_t">layer:10</td>
<td id="A2.T13.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_t">layer:11</td>
<td id="A2.T13.1.1.3.2.5" class="ltx_td ltx_align_center ltx_border_t">layer:12</td>
<td id="A2.T13.1.1.3.2.6" class="ltx_td ltx_align_center ltx_border_t">layer:13</td>
<td id="A2.T13.1.1.3.2.7" class="ltx_td ltx_align_center ltx_border_t">layer:14</td>
<td id="A2.T13.1.1.3.2.8" class="ltx_td ltx_align_center ltx_border_t">layer:15</td>
</tr>
<tr id="A2.T13.1.1.4.3" class="ltx_tr">
<th id="A2.T13.1.1.4.3.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="A2.T13.1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_t">41.72</td>
<td id="A2.T13.1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_t">43.68</td>
<td id="A2.T13.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_t">40.33</td>
<td id="A2.T13.1.1.4.3.5" class="ltx_td ltx_align_center ltx_border_t">34.32</td>
<td id="A2.T13.1.1.4.3.6" class="ltx_td ltx_align_center ltx_border_t">16.91</td>
<td id="A2.T13.1.1.4.3.7" class="ltx_td ltx_align_center ltx_border_t">15.42</td>
<td id="A2.T13.1.1.4.3.8" class="ltx_td ltx_align_center ltx_border_t">14.53</td>
</tr>
<tr id="A2.T13.1.1.5.4" class="ltx_tr">
<th id="A2.T13.1.1.5.4.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="A2.T13.1.1.5.4.2" class="ltx_td ltx_align_center ltx_border_t">layer:17</td>
<td id="A2.T13.1.1.5.4.3" class="ltx_td ltx_align_center ltx_border_t">layer:18</td>
<td id="A2.T13.1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_t">layer:19</td>
<td id="A2.T13.1.1.5.4.5" class="ltx_td ltx_align_center ltx_border_t">layer:20</td>
<td id="A2.T13.1.1.5.4.6" class="ltx_td ltx_align_center ltx_border_t">layer:21</td>
<td id="A2.T13.1.1.5.4.7" class="ltx_td ltx_align_center ltx_border_t">layer:22</td>
<td id="A2.T13.1.1.5.4.8" class="ltx_td ltx_align_center ltx_border_t">layer:23</td>
</tr>
<tr id="A2.T13.1.1.6.5" class="ltx_tr">
<th id="A2.T13.1.1.6.5.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="A2.T13.1.1.6.5.2" class="ltx_td ltx_align_center ltx_border_t">12.94</td>
<td id="A2.T13.1.1.6.5.3" class="ltx_td ltx_align_center ltx_border_t">12.44</td>
<td id="A2.T13.1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_t">12.28</td>
<td id="A2.T13.1.1.6.5.5" class="ltx_td ltx_align_center ltx_border_t">11.89</td>
<td id="A2.T13.1.1.6.5.6" class="ltx_td ltx_align_center ltx_border_t">11.98</td>
<td id="A2.T13.1.1.6.5.7" class="ltx_td ltx_align_center ltx_border_t">11.78</td>
<td id="A2.T13.1.1.6.5.8" class="ltx_td ltx_align_center ltx_border_t">11.44</td>
</tr>
<tr id="A2.T13.1.1.7.6" class="ltx_tr">
<th id="A2.T13.1.1.7.6.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="A2.T13.1.1.7.6.2" class="ltx_td ltx_align_center ltx_border_t">layer:25</td>
<td id="A2.T13.1.1.7.6.3" class="ltx_td ltx_align_center ltx_border_t">layer:26</td>
<td id="A2.T13.1.1.7.6.4" class="ltx_td ltx_align_center ltx_border_t">layer:27</td>
<td id="A2.T13.1.1.7.6.5" class="ltx_td ltx_align_center ltx_border_t">layer:28</td>
<td id="A2.T13.1.1.7.6.6" class="ltx_td ltx_align_center ltx_border_t">layer:29</td>
<td id="A2.T13.1.1.7.6.7" class="ltx_td ltx_align_center ltx_border_t">layer:30</td>
<td id="A2.T13.1.1.7.6.8" class="ltx_td ltx_align_center ltx_border_t">layer:31</td>
</tr>
<tr id="A2.T13.1.1.8.7" class="ltx_tr">
<th id="A2.T13.1.1.8.7.1" class="ltx_td ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t"></th>
<td id="A2.T13.1.1.8.7.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">12.8</td>
<td id="A2.T13.1.1.8.7.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">12.95</td>
<td id="A2.T13.1.1.8.7.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">12.97</td>
<td id="A2.T13.1.1.8.7.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">12.86</td>
<td id="A2.T13.1.1.8.7.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">12.87</td>
<td id="A2.T13.1.1.8.7.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">13.29</td>
<td id="A2.T13.1.1.8.7.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">14.7</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="A2.T14" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 14: </span>The Task Vector Accuracy (%) acorss differnt layers on OKVQA</figcaption>
<div id="A2.T14.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:149.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(7.6pt,-2.6pt) scale(1.0361273583633,1.0361273583633) ;">
<table id="A2.T14.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A2.T14.1.1.1.1" class="ltx_tr">
<th id="A2.T14.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt">OKVQA</th>
<th id="A2.T14.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:0</th>
<th id="A2.T14.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:1</th>
<th id="A2.T14.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:2</th>
<th id="A2.T14.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:3</th>
<th id="A2.T14.1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:4</th>
<th id="A2.T14.1.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:5</th>
<th id="A2.T14.1.1.1.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:6</th>
<th id="A2.T14.1.1.1.1.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">layer:7</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A2.T14.1.1.2.1" class="ltx_tr">
<th id="A2.T14.1.1.2.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="A2.T14.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">13.58</td>
<td id="A2.T14.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">14.4</td>
<td id="A2.T14.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">15.3</td>
<td id="A2.T14.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">15.0</td>
<td id="A2.T14.1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t">15.79</td>
<td id="A2.T14.1.1.2.1.7" class="ltx_td ltx_align_center ltx_border_t">18.06</td>
<td id="A2.T14.1.1.2.1.8" class="ltx_td ltx_align_center ltx_border_t">19.18</td>
<td id="A2.T14.1.1.2.1.9" class="ltx_td ltx_align_center ltx_border_t">22.37</td>
</tr>
<tr id="A2.T14.1.1.3.2" class="ltx_tr">
<th id="A2.T14.1.1.3.2.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="A2.T14.1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_t">layer:8</td>
<td id="A2.T14.1.1.3.2.3" class="ltx_td ltx_align_center ltx_border_t">layer:9</td>
<td id="A2.T14.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_t">layer:10</td>
<td id="A2.T14.1.1.3.2.5" class="ltx_td ltx_align_center ltx_border_t">layer:11</td>
<td id="A2.T14.1.1.3.2.6" class="ltx_td ltx_align_center ltx_border_t">layer:12</td>
<td id="A2.T14.1.1.3.2.7" class="ltx_td ltx_align_center ltx_border_t">layer:13</td>
<td id="A2.T14.1.1.3.2.8" class="ltx_td ltx_align_center ltx_border_t">layer:14</td>
<td id="A2.T14.1.1.3.2.9" class="ltx_td ltx_align_center ltx_border_t">layer:15</td>
</tr>
<tr id="A2.T14.1.1.4.3" class="ltx_tr">
<th id="A2.T14.1.1.4.3.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="A2.T14.1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_t">21.71</td>
<td id="A2.T14.1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_t">22.93</td>
<td id="A2.T14.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_t">32.5</td>
<td id="A2.T14.1.1.4.3.5" class="ltx_td ltx_align_center ltx_border_t">31.99</td>
<td id="A2.T14.1.1.4.3.6" class="ltx_td ltx_align_center ltx_border_t">32.68</td>
<td id="A2.T14.1.1.4.3.7" class="ltx_td ltx_align_center ltx_border_t">29.38</td>
<td id="A2.T14.1.1.4.3.8" class="ltx_td ltx_align_center ltx_border_t">21.4</td>
<td id="A2.T14.1.1.4.3.9" class="ltx_td ltx_align_center ltx_border_t">17.27</td>
</tr>
<tr id="A2.T14.1.1.5.4" class="ltx_tr">
<th id="A2.T14.1.1.5.4.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="A2.T14.1.1.5.4.2" class="ltx_td ltx_align_center ltx_border_t">layer:16</td>
<td id="A2.T14.1.1.5.4.3" class="ltx_td ltx_align_center ltx_border_t">layer:17</td>
<td id="A2.T14.1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_t">layer:18</td>
<td id="A2.T14.1.1.5.4.5" class="ltx_td ltx_align_center ltx_border_t">layer:19</td>
<td id="A2.T14.1.1.5.4.6" class="ltx_td ltx_align_center ltx_border_t">layer:20</td>
<td id="A2.T14.1.1.5.4.7" class="ltx_td ltx_align_center ltx_border_t">layer:21</td>
<td id="A2.T14.1.1.5.4.8" class="ltx_td ltx_align_center ltx_border_t">layer:22</td>
<td id="A2.T14.1.1.5.4.9" class="ltx_td ltx_align_center ltx_border_t">layer:23</td>
</tr>
<tr id="A2.T14.1.1.6.5" class="ltx_tr">
<th id="A2.T14.1.1.6.5.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="A2.T14.1.1.6.5.2" class="ltx_td ltx_align_center ltx_border_t">6.49</td>
<td id="A2.T14.1.1.6.5.3" class="ltx_td ltx_align_center ltx_border_t">0.94</td>
<td id="A2.T14.1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_t">0.5</td>
<td id="A2.T14.1.1.6.5.5" class="ltx_td ltx_align_center ltx_border_t">0.53</td>
<td id="A2.T14.1.1.6.5.6" class="ltx_td ltx_align_center ltx_border_t">0.46</td>
<td id="A2.T14.1.1.6.5.7" class="ltx_td ltx_align_center ltx_border_t">0.32</td>
<td id="A2.T14.1.1.6.5.8" class="ltx_td ltx_align_center ltx_border_t">0.34</td>
<td id="A2.T14.1.1.6.5.9" class="ltx_td ltx_align_center ltx_border_t">0.29</td>
</tr>
<tr id="A2.T14.1.1.7.6" class="ltx_tr">
<th id="A2.T14.1.1.7.6.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="A2.T14.1.1.7.6.2" class="ltx_td ltx_align_center ltx_border_t">layer:24</td>
<td id="A2.T14.1.1.7.6.3" class="ltx_td ltx_align_center ltx_border_t">layer:25</td>
<td id="A2.T14.1.1.7.6.4" class="ltx_td ltx_align_center ltx_border_t">layer:26</td>
<td id="A2.T14.1.1.7.6.5" class="ltx_td ltx_align_center ltx_border_t">layer:27</td>
<td id="A2.T14.1.1.7.6.6" class="ltx_td ltx_align_center ltx_border_t">layer:28</td>
<td id="A2.T14.1.1.7.6.7" class="ltx_td ltx_align_center ltx_border_t">layer:29</td>
<td id="A2.T14.1.1.7.6.8" class="ltx_td ltx_align_center ltx_border_t">layer:30</td>
<td id="A2.T14.1.1.7.6.9" class="ltx_td ltx_align_center ltx_border_t">layer:31</td>
</tr>
<tr id="A2.T14.1.1.8.7" class="ltx_tr">
<th id="A2.T14.1.1.8.7.1" class="ltx_td ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t"></th>
<td id="A2.T14.1.1.8.7.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">0.28</td>
<td id="A2.T14.1.1.8.7.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">0.3</td>
<td id="A2.T14.1.1.8.7.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">0.3</td>
<td id="A2.T14.1.1.8.7.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">0.29</td>
<td id="A2.T14.1.1.8.7.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">0.33</td>
<td id="A2.T14.1.1.8.7.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">0.33</td>
<td id="A2.T14.1.1.8.7.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">0.33</td>
<td id="A2.T14.1.1.8.7.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">1.11</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="A2.SS3.p3" class="ltx_para ltx_noindent">
<p id="A2.SS3.p3.3" class="ltx_p"><span id="A2.SS3.p3.3.1" class="ltx_text ltx_font_bold">PCA-ICV:</span> PCA-ICV employs a weighting factor <math id="A2.SS3.p3.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A2.SS3.p3.1.m1.1a"><mi id="A2.SS3.p3.1.m1.1.1" xref="A2.SS3.p3.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A2.SS3.p3.1.m1.1b"><ci id="A2.SS3.p3.1.m1.1.1.cmml" xref="A2.SS3.p3.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p3.1.m1.1c">\alpha</annotation></semantics></math> to regulate the degree of interference ICV has on the model. We test various values of <math id="A2.SS3.p3.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A2.SS3.p3.2.m2.1a"><mi id="A2.SS3.p3.2.m2.1.1" xref="A2.SS3.p3.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A2.SS3.p3.2.m2.1b"><ci id="A2.SS3.p3.2.m2.1.1.cmml" xref="A2.SS3.p3.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p3.2.m2.1c">\alpha</annotation></semantics></math> to assess performance. Table  <a href="#A2.T15" title="Table 15 ‣ B.3 Non-Learnable Methods Results ‣ Appendix B Detailed Results ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">15</span></a> shows the results of PCA-ICV on VQAv2 and OKVQA datasets with different <math id="A2.SS3.p3.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A2.SS3.p3.3.m3.1a"><mi id="A2.SS3.p3.3.m3.1.1" xref="A2.SS3.p3.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A2.SS3.p3.3.m3.1b"><ci id="A2.SS3.p3.3.m3.1.1.cmml" xref="A2.SS3.p3.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p3.3.m3.1c">\alpha</annotation></semantics></math> value and extract samples. It is evident that the optimal alpha for the VQAv2 dataset significantly differs from that for OKVQA.
The optimal result of PCA-ICV on VQAv2 is 34.75 when alpha is set to 1e-2, while the best result for PCA-ICV is 30.59 when alpha is set to 1e-5.</p>
</div>
<figure id="A2.T15" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 15: </span>The PCA-ICV Accuracy (%) acorss differnt alpha</figcaption>
<div id="A2.T15.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:238.5pt;height:74.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(3.9pt,-1.2pt) scale(1.03342638017461,1.03342638017461) ;">
<table id="A2.T15.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A2.T15.1.1.1.1" class="ltx_tr">
<th id="A2.T15.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" rowspan="2"><span id="A2.T15.1.1.1.1.1.1" class="ltx_text">Dataset</span></th>
<th id="A2.T15.1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" rowspan="2"><span id="A2.T15.1.1.1.1.2.1" class="ltx_text">Samples</span></th>
<th id="A2.T15.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4">Alpha</th>
</tr>
<tr id="A2.T15.1.1.2.2" class="ltx_tr">
<td id="A2.T15.1.1.2.2.1" class="ltx_td ltx_align_left ltx_border_t">1e-2</td>
<td id="A2.T15.1.1.2.2.2" class="ltx_td ltx_align_left ltx_border_t">1e-3</td>
<td id="A2.T15.1.1.2.2.3" class="ltx_td ltx_align_left ltx_border_t">1e-4</td>
<td id="A2.T15.1.1.2.2.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t">1e-5</td>
</tr>
<tr id="A2.T15.1.1.3.3" class="ltx_tr">
<th id="A2.T15.1.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">VQAv2</th>
<th id="A2.T15.1.1.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">32</th>
<td id="A2.T15.1.1.3.3.3" class="ltx_td ltx_align_left ltx_border_t">34.75</td>
<td id="A2.T15.1.1.3.3.4" class="ltx_td ltx_align_left ltx_border_t">30.95</td>
<td id="A2.T15.1.1.3.3.5" class="ltx_td ltx_align_left ltx_border_t">30.06</td>
<td id="A2.T15.1.1.3.3.6" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t">30.0</td>
</tr>
<tr id="A2.T15.1.1.4.4" class="ltx_tr">
<th id="A2.T15.1.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t">OKVQA</th>
<th id="A2.T15.1.1.4.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t">32</th>
<td id="A2.T15.1.1.4.4.3" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t">22.46</td>
<td id="A2.T15.1.1.4.4.4" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t">30.06</td>
<td id="A2.T15.1.1.4.4.5" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t">30.23</td>
<td id="A2.T15.1.1.4.4.6" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_t">30.59</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>General L-ICV</h2>

<div id="A3.p1" class="ltx_para">
<p id="A3.p1.12" class="ltx_p">L-ICV is essentially a shift vector, allowing us to control the shift directions of query representations, which means we can control the shift direction of LMMs by adding or subtracting different shift vectors. Therefore, we can use several L-ICV trained on different VQA dataset to get the <span id="A3.p1.12.1" class="ltx_text ltx_font_bold">General L-ICV</span>.
Specifically, given the diverse VQA task set <math id="A3.p1.1.m1.3" class="ltx_Math" alttext="\bm{T}=\{\bm{t}_{1},\dots,\bm{t}_{n}\}" display="inline"><semantics id="A3.p1.1.m1.3a"><mrow id="A3.p1.1.m1.3.3" xref="A3.p1.1.m1.3.3.cmml"><mi id="A3.p1.1.m1.3.3.4" xref="A3.p1.1.m1.3.3.4.cmml">𝑻</mi><mo id="A3.p1.1.m1.3.3.3" xref="A3.p1.1.m1.3.3.3.cmml">=</mo><mrow id="A3.p1.1.m1.3.3.2.2" xref="A3.p1.1.m1.3.3.2.3.cmml"><mo stretchy="false" id="A3.p1.1.m1.3.3.2.2.3" xref="A3.p1.1.m1.3.3.2.3.cmml">{</mo><msub id="A3.p1.1.m1.2.2.1.1.1" xref="A3.p1.1.m1.2.2.1.1.1.cmml"><mi id="A3.p1.1.m1.2.2.1.1.1.2" xref="A3.p1.1.m1.2.2.1.1.1.2.cmml">𝒕</mi><mn id="A3.p1.1.m1.2.2.1.1.1.3" xref="A3.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="A3.p1.1.m1.3.3.2.2.4" xref="A3.p1.1.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="A3.p1.1.m1.1.1" xref="A3.p1.1.m1.1.1.cmml">…</mi><mo id="A3.p1.1.m1.3.3.2.2.5" xref="A3.p1.1.m1.3.3.2.3.cmml">,</mo><msub id="A3.p1.1.m1.3.3.2.2.2" xref="A3.p1.1.m1.3.3.2.2.2.cmml"><mi id="A3.p1.1.m1.3.3.2.2.2.2" xref="A3.p1.1.m1.3.3.2.2.2.2.cmml">𝒕</mi><mi id="A3.p1.1.m1.3.3.2.2.2.3" xref="A3.p1.1.m1.3.3.2.2.2.3.cmml">n</mi></msub><mo stretchy="false" id="A3.p1.1.m1.3.3.2.2.6" xref="A3.p1.1.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.1.m1.3b"><apply id="A3.p1.1.m1.3.3.cmml" xref="A3.p1.1.m1.3.3"><eq id="A3.p1.1.m1.3.3.3.cmml" xref="A3.p1.1.m1.3.3.3"></eq><ci id="A3.p1.1.m1.3.3.4.cmml" xref="A3.p1.1.m1.3.3.4">𝑻</ci><set id="A3.p1.1.m1.3.3.2.3.cmml" xref="A3.p1.1.m1.3.3.2.2"><apply id="A3.p1.1.m1.2.2.1.1.1.cmml" xref="A3.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="A3.p1.1.m1.2.2.1.1.1.1.cmml" xref="A3.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="A3.p1.1.m1.2.2.1.1.1.2.cmml" xref="A3.p1.1.m1.2.2.1.1.1.2">𝒕</ci><cn type="integer" id="A3.p1.1.m1.2.2.1.1.1.3.cmml" xref="A3.p1.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="A3.p1.1.m1.1.1.cmml" xref="A3.p1.1.m1.1.1">…</ci><apply id="A3.p1.1.m1.3.3.2.2.2.cmml" xref="A3.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="A3.p1.1.m1.3.3.2.2.2.1.cmml" xref="A3.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="A3.p1.1.m1.3.3.2.2.2.2.cmml" xref="A3.p1.1.m1.3.3.2.2.2.2">𝒕</ci><ci id="A3.p1.1.m1.3.3.2.2.2.3.cmml" xref="A3.p1.1.m1.3.3.2.2.2.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.1.m1.3c">\bm{T}=\{\bm{t}_{1},\dots,\bm{t}_{n}\}</annotation></semantics></math>, where <math id="A3.p1.2.m2.1" class="ltx_Math" alttext="\bm{t}_{i}" display="inline"><semantics id="A3.p1.2.m2.1a"><msub id="A3.p1.2.m2.1.1" xref="A3.p1.2.m2.1.1.cmml"><mi id="A3.p1.2.m2.1.1.2" xref="A3.p1.2.m2.1.1.2.cmml">𝒕</mi><mi id="A3.p1.2.m2.1.1.3" xref="A3.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.2.m2.1b"><apply id="A3.p1.2.m2.1.1.cmml" xref="A3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A3.p1.2.m2.1.1.1.cmml" xref="A3.p1.2.m2.1.1">subscript</csymbol><ci id="A3.p1.2.m2.1.1.2.cmml" xref="A3.p1.2.m2.1.1.2">𝒕</ci><ci id="A3.p1.2.m2.1.1.3.cmml" xref="A3.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.2.m2.1c">\bm{t}_{i}</annotation></semantics></math> is a VQA task and <math id="A3.p1.3.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="A3.p1.3.m3.1a"><mi id="A3.p1.3.m3.1.1" xref="A3.p1.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="A3.p1.3.m3.1b"><ci id="A3.p1.3.m3.1.1.cmml" xref="A3.p1.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.3.m3.1c">n</annotation></semantics></math> is the number of tasks, we train the task-specific L-ICV <math id="A3.p1.4.m4.3" class="ltx_Math" alttext="\bm{V}^{i}=\{\bm{v}_{1}^{i},\dots,\bm{v}_{L}^{i}\}" display="inline"><semantics id="A3.p1.4.m4.3a"><mrow id="A3.p1.4.m4.3.3" xref="A3.p1.4.m4.3.3.cmml"><msup id="A3.p1.4.m4.3.3.4" xref="A3.p1.4.m4.3.3.4.cmml"><mi id="A3.p1.4.m4.3.3.4.2" xref="A3.p1.4.m4.3.3.4.2.cmml">𝑽</mi><mi id="A3.p1.4.m4.3.3.4.3" xref="A3.p1.4.m4.3.3.4.3.cmml">i</mi></msup><mo id="A3.p1.4.m4.3.3.3" xref="A3.p1.4.m4.3.3.3.cmml">=</mo><mrow id="A3.p1.4.m4.3.3.2.2" xref="A3.p1.4.m4.3.3.2.3.cmml"><mo stretchy="false" id="A3.p1.4.m4.3.3.2.2.3" xref="A3.p1.4.m4.3.3.2.3.cmml">{</mo><msubsup id="A3.p1.4.m4.2.2.1.1.1" xref="A3.p1.4.m4.2.2.1.1.1.cmml"><mi id="A3.p1.4.m4.2.2.1.1.1.2.2" xref="A3.p1.4.m4.2.2.1.1.1.2.2.cmml">𝒗</mi><mn id="A3.p1.4.m4.2.2.1.1.1.2.3" xref="A3.p1.4.m4.2.2.1.1.1.2.3.cmml">1</mn><mi id="A3.p1.4.m4.2.2.1.1.1.3" xref="A3.p1.4.m4.2.2.1.1.1.3.cmml">i</mi></msubsup><mo id="A3.p1.4.m4.3.3.2.2.4" xref="A3.p1.4.m4.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="A3.p1.4.m4.1.1" xref="A3.p1.4.m4.1.1.cmml">…</mi><mo id="A3.p1.4.m4.3.3.2.2.5" xref="A3.p1.4.m4.3.3.2.3.cmml">,</mo><msubsup id="A3.p1.4.m4.3.3.2.2.2" xref="A3.p1.4.m4.3.3.2.2.2.cmml"><mi id="A3.p1.4.m4.3.3.2.2.2.2.2" xref="A3.p1.4.m4.3.3.2.2.2.2.2.cmml">𝒗</mi><mi id="A3.p1.4.m4.3.3.2.2.2.2.3" xref="A3.p1.4.m4.3.3.2.2.2.2.3.cmml">L</mi><mi id="A3.p1.4.m4.3.3.2.2.2.3" xref="A3.p1.4.m4.3.3.2.2.2.3.cmml">i</mi></msubsup><mo stretchy="false" id="A3.p1.4.m4.3.3.2.2.6" xref="A3.p1.4.m4.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.4.m4.3b"><apply id="A3.p1.4.m4.3.3.cmml" xref="A3.p1.4.m4.3.3"><eq id="A3.p1.4.m4.3.3.3.cmml" xref="A3.p1.4.m4.3.3.3"></eq><apply id="A3.p1.4.m4.3.3.4.cmml" xref="A3.p1.4.m4.3.3.4"><csymbol cd="ambiguous" id="A3.p1.4.m4.3.3.4.1.cmml" xref="A3.p1.4.m4.3.3.4">superscript</csymbol><ci id="A3.p1.4.m4.3.3.4.2.cmml" xref="A3.p1.4.m4.3.3.4.2">𝑽</ci><ci id="A3.p1.4.m4.3.3.4.3.cmml" xref="A3.p1.4.m4.3.3.4.3">𝑖</ci></apply><set id="A3.p1.4.m4.3.3.2.3.cmml" xref="A3.p1.4.m4.3.3.2.2"><apply id="A3.p1.4.m4.2.2.1.1.1.cmml" xref="A3.p1.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="A3.p1.4.m4.2.2.1.1.1.1.cmml" xref="A3.p1.4.m4.2.2.1.1.1">superscript</csymbol><apply id="A3.p1.4.m4.2.2.1.1.1.2.cmml" xref="A3.p1.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="A3.p1.4.m4.2.2.1.1.1.2.1.cmml" xref="A3.p1.4.m4.2.2.1.1.1">subscript</csymbol><ci id="A3.p1.4.m4.2.2.1.1.1.2.2.cmml" xref="A3.p1.4.m4.2.2.1.1.1.2.2">𝒗</ci><cn type="integer" id="A3.p1.4.m4.2.2.1.1.1.2.3.cmml" xref="A3.p1.4.m4.2.2.1.1.1.2.3">1</cn></apply><ci id="A3.p1.4.m4.2.2.1.1.1.3.cmml" xref="A3.p1.4.m4.2.2.1.1.1.3">𝑖</ci></apply><ci id="A3.p1.4.m4.1.1.cmml" xref="A3.p1.4.m4.1.1">…</ci><apply id="A3.p1.4.m4.3.3.2.2.2.cmml" xref="A3.p1.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="A3.p1.4.m4.3.3.2.2.2.1.cmml" xref="A3.p1.4.m4.3.3.2.2.2">superscript</csymbol><apply id="A3.p1.4.m4.3.3.2.2.2.2.cmml" xref="A3.p1.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="A3.p1.4.m4.3.3.2.2.2.2.1.cmml" xref="A3.p1.4.m4.3.3.2.2.2">subscript</csymbol><ci id="A3.p1.4.m4.3.3.2.2.2.2.2.cmml" xref="A3.p1.4.m4.3.3.2.2.2.2.2">𝒗</ci><ci id="A3.p1.4.m4.3.3.2.2.2.2.3.cmml" xref="A3.p1.4.m4.3.3.2.2.2.2.3">𝐿</ci></apply><ci id="A3.p1.4.m4.3.3.2.2.2.3.cmml" xref="A3.p1.4.m4.3.3.2.2.2.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.4.m4.3c">\bm{V}^{i}=\{\bm{v}_{1}^{i},\dots,\bm{v}_{L}^{i}\}</annotation></semantics></math> and the weight factor <math id="A3.p1.5.m5.3" class="ltx_Math" alttext="\bm{\alpha}^{i}=\{\alpha_{1}^{i},\dots,\alpha_{L}^{i}\}" display="inline"><semantics id="A3.p1.5.m5.3a"><mrow id="A3.p1.5.m5.3.3" xref="A3.p1.5.m5.3.3.cmml"><msup id="A3.p1.5.m5.3.3.4" xref="A3.p1.5.m5.3.3.4.cmml"><mi id="A3.p1.5.m5.3.3.4.2" xref="A3.p1.5.m5.3.3.4.2.cmml">𝜶</mi><mi id="A3.p1.5.m5.3.3.4.3" xref="A3.p1.5.m5.3.3.4.3.cmml">i</mi></msup><mo id="A3.p1.5.m5.3.3.3" xref="A3.p1.5.m5.3.3.3.cmml">=</mo><mrow id="A3.p1.5.m5.3.3.2.2" xref="A3.p1.5.m5.3.3.2.3.cmml"><mo stretchy="false" id="A3.p1.5.m5.3.3.2.2.3" xref="A3.p1.5.m5.3.3.2.3.cmml">{</mo><msubsup id="A3.p1.5.m5.2.2.1.1.1" xref="A3.p1.5.m5.2.2.1.1.1.cmml"><mi id="A3.p1.5.m5.2.2.1.1.1.2.2" xref="A3.p1.5.m5.2.2.1.1.1.2.2.cmml">α</mi><mn id="A3.p1.5.m5.2.2.1.1.1.2.3" xref="A3.p1.5.m5.2.2.1.1.1.2.3.cmml">1</mn><mi id="A3.p1.5.m5.2.2.1.1.1.3" xref="A3.p1.5.m5.2.2.1.1.1.3.cmml">i</mi></msubsup><mo id="A3.p1.5.m5.3.3.2.2.4" xref="A3.p1.5.m5.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="A3.p1.5.m5.1.1" xref="A3.p1.5.m5.1.1.cmml">…</mi><mo id="A3.p1.5.m5.3.3.2.2.5" xref="A3.p1.5.m5.3.3.2.3.cmml">,</mo><msubsup id="A3.p1.5.m5.3.3.2.2.2" xref="A3.p1.5.m5.3.3.2.2.2.cmml"><mi id="A3.p1.5.m5.3.3.2.2.2.2.2" xref="A3.p1.5.m5.3.3.2.2.2.2.2.cmml">α</mi><mi id="A3.p1.5.m5.3.3.2.2.2.2.3" xref="A3.p1.5.m5.3.3.2.2.2.2.3.cmml">L</mi><mi id="A3.p1.5.m5.3.3.2.2.2.3" xref="A3.p1.5.m5.3.3.2.2.2.3.cmml">i</mi></msubsup><mo stretchy="false" id="A3.p1.5.m5.3.3.2.2.6" xref="A3.p1.5.m5.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.5.m5.3b"><apply id="A3.p1.5.m5.3.3.cmml" xref="A3.p1.5.m5.3.3"><eq id="A3.p1.5.m5.3.3.3.cmml" xref="A3.p1.5.m5.3.3.3"></eq><apply id="A3.p1.5.m5.3.3.4.cmml" xref="A3.p1.5.m5.3.3.4"><csymbol cd="ambiguous" id="A3.p1.5.m5.3.3.4.1.cmml" xref="A3.p1.5.m5.3.3.4">superscript</csymbol><ci id="A3.p1.5.m5.3.3.4.2.cmml" xref="A3.p1.5.m5.3.3.4.2">𝜶</ci><ci id="A3.p1.5.m5.3.3.4.3.cmml" xref="A3.p1.5.m5.3.3.4.3">𝑖</ci></apply><set id="A3.p1.5.m5.3.3.2.3.cmml" xref="A3.p1.5.m5.3.3.2.2"><apply id="A3.p1.5.m5.2.2.1.1.1.cmml" xref="A3.p1.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="A3.p1.5.m5.2.2.1.1.1.1.cmml" xref="A3.p1.5.m5.2.2.1.1.1">superscript</csymbol><apply id="A3.p1.5.m5.2.2.1.1.1.2.cmml" xref="A3.p1.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="A3.p1.5.m5.2.2.1.1.1.2.1.cmml" xref="A3.p1.5.m5.2.2.1.1.1">subscript</csymbol><ci id="A3.p1.5.m5.2.2.1.1.1.2.2.cmml" xref="A3.p1.5.m5.2.2.1.1.1.2.2">𝛼</ci><cn type="integer" id="A3.p1.5.m5.2.2.1.1.1.2.3.cmml" xref="A3.p1.5.m5.2.2.1.1.1.2.3">1</cn></apply><ci id="A3.p1.5.m5.2.2.1.1.1.3.cmml" xref="A3.p1.5.m5.2.2.1.1.1.3">𝑖</ci></apply><ci id="A3.p1.5.m5.1.1.cmml" xref="A3.p1.5.m5.1.1">…</ci><apply id="A3.p1.5.m5.3.3.2.2.2.cmml" xref="A3.p1.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="A3.p1.5.m5.3.3.2.2.2.1.cmml" xref="A3.p1.5.m5.3.3.2.2.2">superscript</csymbol><apply id="A3.p1.5.m5.3.3.2.2.2.2.cmml" xref="A3.p1.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="A3.p1.5.m5.3.3.2.2.2.2.1.cmml" xref="A3.p1.5.m5.3.3.2.2.2">subscript</csymbol><ci id="A3.p1.5.m5.3.3.2.2.2.2.2.cmml" xref="A3.p1.5.m5.3.3.2.2.2.2.2">𝛼</ci><ci id="A3.p1.5.m5.3.3.2.2.2.2.3.cmml" xref="A3.p1.5.m5.3.3.2.2.2.2.3">𝐿</ci></apply><ci id="A3.p1.5.m5.3.3.2.2.2.3.cmml" xref="A3.p1.5.m5.3.3.2.2.2.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.5.m5.3c">\bm{\alpha}^{i}=\{\alpha_{1}^{i},\dots,\alpha_{L}^{i}\}</annotation></semantics></math> on each VQA dataset. Then, we have the L-ICV set <math id="A3.p1.6.m6.3" class="ltx_Math" alttext="\mathcal{V}_{set}=\{\bm{V}^{1},\dots,\bm{V}^{n}\}" display="inline"><semantics id="A3.p1.6.m6.3a"><mrow id="A3.p1.6.m6.3.3" xref="A3.p1.6.m6.3.3.cmml"><msub id="A3.p1.6.m6.3.3.4" xref="A3.p1.6.m6.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.p1.6.m6.3.3.4.2" xref="A3.p1.6.m6.3.3.4.2.cmml">𝒱</mi><mrow id="A3.p1.6.m6.3.3.4.3" xref="A3.p1.6.m6.3.3.4.3.cmml"><mi id="A3.p1.6.m6.3.3.4.3.2" xref="A3.p1.6.m6.3.3.4.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A3.p1.6.m6.3.3.4.3.1" xref="A3.p1.6.m6.3.3.4.3.1.cmml">​</mo><mi id="A3.p1.6.m6.3.3.4.3.3" xref="A3.p1.6.m6.3.3.4.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A3.p1.6.m6.3.3.4.3.1a" xref="A3.p1.6.m6.3.3.4.3.1.cmml">​</mo><mi id="A3.p1.6.m6.3.3.4.3.4" xref="A3.p1.6.m6.3.3.4.3.4.cmml">t</mi></mrow></msub><mo id="A3.p1.6.m6.3.3.3" xref="A3.p1.6.m6.3.3.3.cmml">=</mo><mrow id="A3.p1.6.m6.3.3.2.2" xref="A3.p1.6.m6.3.3.2.3.cmml"><mo stretchy="false" id="A3.p1.6.m6.3.3.2.2.3" xref="A3.p1.6.m6.3.3.2.3.cmml">{</mo><msup id="A3.p1.6.m6.2.2.1.1.1" xref="A3.p1.6.m6.2.2.1.1.1.cmml"><mi id="A3.p1.6.m6.2.2.1.1.1.2" xref="A3.p1.6.m6.2.2.1.1.1.2.cmml">𝑽</mi><mn id="A3.p1.6.m6.2.2.1.1.1.3" xref="A3.p1.6.m6.2.2.1.1.1.3.cmml">1</mn></msup><mo id="A3.p1.6.m6.3.3.2.2.4" xref="A3.p1.6.m6.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="A3.p1.6.m6.1.1" xref="A3.p1.6.m6.1.1.cmml">…</mi><mo id="A3.p1.6.m6.3.3.2.2.5" xref="A3.p1.6.m6.3.3.2.3.cmml">,</mo><msup id="A3.p1.6.m6.3.3.2.2.2" xref="A3.p1.6.m6.3.3.2.2.2.cmml"><mi id="A3.p1.6.m6.3.3.2.2.2.2" xref="A3.p1.6.m6.3.3.2.2.2.2.cmml">𝑽</mi><mi id="A3.p1.6.m6.3.3.2.2.2.3" xref="A3.p1.6.m6.3.3.2.2.2.3.cmml">n</mi></msup><mo stretchy="false" id="A3.p1.6.m6.3.3.2.2.6" xref="A3.p1.6.m6.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.6.m6.3b"><apply id="A3.p1.6.m6.3.3.cmml" xref="A3.p1.6.m6.3.3"><eq id="A3.p1.6.m6.3.3.3.cmml" xref="A3.p1.6.m6.3.3.3"></eq><apply id="A3.p1.6.m6.3.3.4.cmml" xref="A3.p1.6.m6.3.3.4"><csymbol cd="ambiguous" id="A3.p1.6.m6.3.3.4.1.cmml" xref="A3.p1.6.m6.3.3.4">subscript</csymbol><ci id="A3.p1.6.m6.3.3.4.2.cmml" xref="A3.p1.6.m6.3.3.4.2">𝒱</ci><apply id="A3.p1.6.m6.3.3.4.3.cmml" xref="A3.p1.6.m6.3.3.4.3"><times id="A3.p1.6.m6.3.3.4.3.1.cmml" xref="A3.p1.6.m6.3.3.4.3.1"></times><ci id="A3.p1.6.m6.3.3.4.3.2.cmml" xref="A3.p1.6.m6.3.3.4.3.2">𝑠</ci><ci id="A3.p1.6.m6.3.3.4.3.3.cmml" xref="A3.p1.6.m6.3.3.4.3.3">𝑒</ci><ci id="A3.p1.6.m6.3.3.4.3.4.cmml" xref="A3.p1.6.m6.3.3.4.3.4">𝑡</ci></apply></apply><set id="A3.p1.6.m6.3.3.2.3.cmml" xref="A3.p1.6.m6.3.3.2.2"><apply id="A3.p1.6.m6.2.2.1.1.1.cmml" xref="A3.p1.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="A3.p1.6.m6.2.2.1.1.1.1.cmml" xref="A3.p1.6.m6.2.2.1.1.1">superscript</csymbol><ci id="A3.p1.6.m6.2.2.1.1.1.2.cmml" xref="A3.p1.6.m6.2.2.1.1.1.2">𝑽</ci><cn type="integer" id="A3.p1.6.m6.2.2.1.1.1.3.cmml" xref="A3.p1.6.m6.2.2.1.1.1.3">1</cn></apply><ci id="A3.p1.6.m6.1.1.cmml" xref="A3.p1.6.m6.1.1">…</ci><apply id="A3.p1.6.m6.3.3.2.2.2.cmml" xref="A3.p1.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="A3.p1.6.m6.3.3.2.2.2.1.cmml" xref="A3.p1.6.m6.3.3.2.2.2">superscript</csymbol><ci id="A3.p1.6.m6.3.3.2.2.2.2.cmml" xref="A3.p1.6.m6.3.3.2.2.2.2">𝑽</ci><ci id="A3.p1.6.m6.3.3.2.2.2.3.cmml" xref="A3.p1.6.m6.3.3.2.2.2.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.6.m6.3c">\mathcal{V}_{set}=\{\bm{V}^{1},\dots,\bm{V}^{n}\}</annotation></semantics></math> and its weight factors set <math id="A3.p1.7.m7.3" class="ltx_Math" alttext="\bm{\alpha}_{set}=\{\bm{\alpha}^{1},\dots,\bm{\alpha}^{n}\}" display="inline"><semantics id="A3.p1.7.m7.3a"><mrow id="A3.p1.7.m7.3.3" xref="A3.p1.7.m7.3.3.cmml"><msub id="A3.p1.7.m7.3.3.4" xref="A3.p1.7.m7.3.3.4.cmml"><mi id="A3.p1.7.m7.3.3.4.2" xref="A3.p1.7.m7.3.3.4.2.cmml">𝜶</mi><mrow id="A3.p1.7.m7.3.3.4.3" xref="A3.p1.7.m7.3.3.4.3.cmml"><mi id="A3.p1.7.m7.3.3.4.3.2" xref="A3.p1.7.m7.3.3.4.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A3.p1.7.m7.3.3.4.3.1" xref="A3.p1.7.m7.3.3.4.3.1.cmml">​</mo><mi id="A3.p1.7.m7.3.3.4.3.3" xref="A3.p1.7.m7.3.3.4.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A3.p1.7.m7.3.3.4.3.1a" xref="A3.p1.7.m7.3.3.4.3.1.cmml">​</mo><mi id="A3.p1.7.m7.3.3.4.3.4" xref="A3.p1.7.m7.3.3.4.3.4.cmml">t</mi></mrow></msub><mo id="A3.p1.7.m7.3.3.3" xref="A3.p1.7.m7.3.3.3.cmml">=</mo><mrow id="A3.p1.7.m7.3.3.2.2" xref="A3.p1.7.m7.3.3.2.3.cmml"><mo stretchy="false" id="A3.p1.7.m7.3.3.2.2.3" xref="A3.p1.7.m7.3.3.2.3.cmml">{</mo><msup id="A3.p1.7.m7.2.2.1.1.1" xref="A3.p1.7.m7.2.2.1.1.1.cmml"><mi id="A3.p1.7.m7.2.2.1.1.1.2" xref="A3.p1.7.m7.2.2.1.1.1.2.cmml">𝜶</mi><mn id="A3.p1.7.m7.2.2.1.1.1.3" xref="A3.p1.7.m7.2.2.1.1.1.3.cmml">1</mn></msup><mo id="A3.p1.7.m7.3.3.2.2.4" xref="A3.p1.7.m7.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="A3.p1.7.m7.1.1" xref="A3.p1.7.m7.1.1.cmml">…</mi><mo id="A3.p1.7.m7.3.3.2.2.5" xref="A3.p1.7.m7.3.3.2.3.cmml">,</mo><msup id="A3.p1.7.m7.3.3.2.2.2" xref="A3.p1.7.m7.3.3.2.2.2.cmml"><mi id="A3.p1.7.m7.3.3.2.2.2.2" xref="A3.p1.7.m7.3.3.2.2.2.2.cmml">𝜶</mi><mi id="A3.p1.7.m7.3.3.2.2.2.3" xref="A3.p1.7.m7.3.3.2.2.2.3.cmml">n</mi></msup><mo stretchy="false" id="A3.p1.7.m7.3.3.2.2.6" xref="A3.p1.7.m7.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.7.m7.3b"><apply id="A3.p1.7.m7.3.3.cmml" xref="A3.p1.7.m7.3.3"><eq id="A3.p1.7.m7.3.3.3.cmml" xref="A3.p1.7.m7.3.3.3"></eq><apply id="A3.p1.7.m7.3.3.4.cmml" xref="A3.p1.7.m7.3.3.4"><csymbol cd="ambiguous" id="A3.p1.7.m7.3.3.4.1.cmml" xref="A3.p1.7.m7.3.3.4">subscript</csymbol><ci id="A3.p1.7.m7.3.3.4.2.cmml" xref="A3.p1.7.m7.3.3.4.2">𝜶</ci><apply id="A3.p1.7.m7.3.3.4.3.cmml" xref="A3.p1.7.m7.3.3.4.3"><times id="A3.p1.7.m7.3.3.4.3.1.cmml" xref="A3.p1.7.m7.3.3.4.3.1"></times><ci id="A3.p1.7.m7.3.3.4.3.2.cmml" xref="A3.p1.7.m7.3.3.4.3.2">𝑠</ci><ci id="A3.p1.7.m7.3.3.4.3.3.cmml" xref="A3.p1.7.m7.3.3.4.3.3">𝑒</ci><ci id="A3.p1.7.m7.3.3.4.3.4.cmml" xref="A3.p1.7.m7.3.3.4.3.4">𝑡</ci></apply></apply><set id="A3.p1.7.m7.3.3.2.3.cmml" xref="A3.p1.7.m7.3.3.2.2"><apply id="A3.p1.7.m7.2.2.1.1.1.cmml" xref="A3.p1.7.m7.2.2.1.1.1"><csymbol cd="ambiguous" id="A3.p1.7.m7.2.2.1.1.1.1.cmml" xref="A3.p1.7.m7.2.2.1.1.1">superscript</csymbol><ci id="A3.p1.7.m7.2.2.1.1.1.2.cmml" xref="A3.p1.7.m7.2.2.1.1.1.2">𝜶</ci><cn type="integer" id="A3.p1.7.m7.2.2.1.1.1.3.cmml" xref="A3.p1.7.m7.2.2.1.1.1.3">1</cn></apply><ci id="A3.p1.7.m7.1.1.cmml" xref="A3.p1.7.m7.1.1">…</ci><apply id="A3.p1.7.m7.3.3.2.2.2.cmml" xref="A3.p1.7.m7.3.3.2.2.2"><csymbol cd="ambiguous" id="A3.p1.7.m7.3.3.2.2.2.1.cmml" xref="A3.p1.7.m7.3.3.2.2.2">superscript</csymbol><ci id="A3.p1.7.m7.3.3.2.2.2.2.cmml" xref="A3.p1.7.m7.3.3.2.2.2.2">𝜶</ci><ci id="A3.p1.7.m7.3.3.2.2.2.3.cmml" xref="A3.p1.7.m7.3.3.2.2.2.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.7.m7.3c">\bm{\alpha}_{set}=\{\bm{\alpha}^{1},\dots,\bm{\alpha}^{n}\}</annotation></semantics></math>. The General L-ICV has the same shape of task-specific L-ICV. For the <math id="A3.p1.8.m8.1" class="ltx_Math" alttext="l" display="inline"><semantics id="A3.p1.8.m8.1a"><mi id="A3.p1.8.m8.1.1" xref="A3.p1.8.m8.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="A3.p1.8.m8.1b"><ci id="A3.p1.8.m8.1.1.cmml" xref="A3.p1.8.m8.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.8.m8.1c">l</annotation></semantics></math>-th layer, it is defined as <math id="A3.p1.9.m9.1" class="ltx_Math" alttext="\bm{v}_{l}=\sum_{i}\bm{\alpha}_{l}^{i}\bm{v}_{l}^{i}" display="inline"><semantics id="A3.p1.9.m9.1a"><mrow id="A3.p1.9.m9.1.1" xref="A3.p1.9.m9.1.1.cmml"><msub id="A3.p1.9.m9.1.1.2" xref="A3.p1.9.m9.1.1.2.cmml"><mi id="A3.p1.9.m9.1.1.2.2" xref="A3.p1.9.m9.1.1.2.2.cmml">𝒗</mi><mi id="A3.p1.9.m9.1.1.2.3" xref="A3.p1.9.m9.1.1.2.3.cmml">l</mi></msub><mo rspace="0.111em" id="A3.p1.9.m9.1.1.1" xref="A3.p1.9.m9.1.1.1.cmml">=</mo><mrow id="A3.p1.9.m9.1.1.3" xref="A3.p1.9.m9.1.1.3.cmml"><msub id="A3.p1.9.m9.1.1.3.1" xref="A3.p1.9.m9.1.1.3.1.cmml"><mo id="A3.p1.9.m9.1.1.3.1.2" xref="A3.p1.9.m9.1.1.3.1.2.cmml">∑</mo><mi id="A3.p1.9.m9.1.1.3.1.3" xref="A3.p1.9.m9.1.1.3.1.3.cmml">i</mi></msub><mrow id="A3.p1.9.m9.1.1.3.2" xref="A3.p1.9.m9.1.1.3.2.cmml"><msubsup id="A3.p1.9.m9.1.1.3.2.2" xref="A3.p1.9.m9.1.1.3.2.2.cmml"><mi id="A3.p1.9.m9.1.1.3.2.2.2.2" xref="A3.p1.9.m9.1.1.3.2.2.2.2.cmml">𝜶</mi><mi id="A3.p1.9.m9.1.1.3.2.2.2.3" xref="A3.p1.9.m9.1.1.3.2.2.2.3.cmml">l</mi><mi id="A3.p1.9.m9.1.1.3.2.2.3" xref="A3.p1.9.m9.1.1.3.2.2.3.cmml">i</mi></msubsup><mo lspace="0em" rspace="0em" id="A3.p1.9.m9.1.1.3.2.1" xref="A3.p1.9.m9.1.1.3.2.1.cmml">​</mo><msubsup id="A3.p1.9.m9.1.1.3.2.3" xref="A3.p1.9.m9.1.1.3.2.3.cmml"><mi id="A3.p1.9.m9.1.1.3.2.3.2.2" xref="A3.p1.9.m9.1.1.3.2.3.2.2.cmml">𝒗</mi><mi id="A3.p1.9.m9.1.1.3.2.3.2.3" xref="A3.p1.9.m9.1.1.3.2.3.2.3.cmml">l</mi><mi id="A3.p1.9.m9.1.1.3.2.3.3" xref="A3.p1.9.m9.1.1.3.2.3.3.cmml">i</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.9.m9.1b"><apply id="A3.p1.9.m9.1.1.cmml" xref="A3.p1.9.m9.1.1"><eq id="A3.p1.9.m9.1.1.1.cmml" xref="A3.p1.9.m9.1.1.1"></eq><apply id="A3.p1.9.m9.1.1.2.cmml" xref="A3.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="A3.p1.9.m9.1.1.2.1.cmml" xref="A3.p1.9.m9.1.1.2">subscript</csymbol><ci id="A3.p1.9.m9.1.1.2.2.cmml" xref="A3.p1.9.m9.1.1.2.2">𝒗</ci><ci id="A3.p1.9.m9.1.1.2.3.cmml" xref="A3.p1.9.m9.1.1.2.3">𝑙</ci></apply><apply id="A3.p1.9.m9.1.1.3.cmml" xref="A3.p1.9.m9.1.1.3"><apply id="A3.p1.9.m9.1.1.3.1.cmml" xref="A3.p1.9.m9.1.1.3.1"><csymbol cd="ambiguous" id="A3.p1.9.m9.1.1.3.1.1.cmml" xref="A3.p1.9.m9.1.1.3.1">subscript</csymbol><sum id="A3.p1.9.m9.1.1.3.1.2.cmml" xref="A3.p1.9.m9.1.1.3.1.2"></sum><ci id="A3.p1.9.m9.1.1.3.1.3.cmml" xref="A3.p1.9.m9.1.1.3.1.3">𝑖</ci></apply><apply id="A3.p1.9.m9.1.1.3.2.cmml" xref="A3.p1.9.m9.1.1.3.2"><times id="A3.p1.9.m9.1.1.3.2.1.cmml" xref="A3.p1.9.m9.1.1.3.2.1"></times><apply id="A3.p1.9.m9.1.1.3.2.2.cmml" xref="A3.p1.9.m9.1.1.3.2.2"><csymbol cd="ambiguous" id="A3.p1.9.m9.1.1.3.2.2.1.cmml" xref="A3.p1.9.m9.1.1.3.2.2">superscript</csymbol><apply id="A3.p1.9.m9.1.1.3.2.2.2.cmml" xref="A3.p1.9.m9.1.1.3.2.2"><csymbol cd="ambiguous" id="A3.p1.9.m9.1.1.3.2.2.2.1.cmml" xref="A3.p1.9.m9.1.1.3.2.2">subscript</csymbol><ci id="A3.p1.9.m9.1.1.3.2.2.2.2.cmml" xref="A3.p1.9.m9.1.1.3.2.2.2.2">𝜶</ci><ci id="A3.p1.9.m9.1.1.3.2.2.2.3.cmml" xref="A3.p1.9.m9.1.1.3.2.2.2.3">𝑙</ci></apply><ci id="A3.p1.9.m9.1.1.3.2.2.3.cmml" xref="A3.p1.9.m9.1.1.3.2.2.3">𝑖</ci></apply><apply id="A3.p1.9.m9.1.1.3.2.3.cmml" xref="A3.p1.9.m9.1.1.3.2.3"><csymbol cd="ambiguous" id="A3.p1.9.m9.1.1.3.2.3.1.cmml" xref="A3.p1.9.m9.1.1.3.2.3">superscript</csymbol><apply id="A3.p1.9.m9.1.1.3.2.3.2.cmml" xref="A3.p1.9.m9.1.1.3.2.3"><csymbol cd="ambiguous" id="A3.p1.9.m9.1.1.3.2.3.2.1.cmml" xref="A3.p1.9.m9.1.1.3.2.3">subscript</csymbol><ci id="A3.p1.9.m9.1.1.3.2.3.2.2.cmml" xref="A3.p1.9.m9.1.1.3.2.3.2.2">𝒗</ci><ci id="A3.p1.9.m9.1.1.3.2.3.2.3.cmml" xref="A3.p1.9.m9.1.1.3.2.3.2.3">𝑙</ci></apply><ci id="A3.p1.9.m9.1.1.3.2.3.3.cmml" xref="A3.p1.9.m9.1.1.3.2.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.9.m9.1c">\bm{v}_{l}=\sum_{i}\bm{\alpha}_{l}^{i}\bm{v}_{l}^{i}</annotation></semantics></math>. During inference, we use the vector <math id="A3.p1.10.m10.1" class="ltx_Math" alttext="\bm{v}_{l}" display="inline"><semantics id="A3.p1.10.m10.1a"><msub id="A3.p1.10.m10.1.1" xref="A3.p1.10.m10.1.1.cmml"><mi id="A3.p1.10.m10.1.1.2" xref="A3.p1.10.m10.1.1.2.cmml">𝒗</mi><mi id="A3.p1.10.m10.1.1.3" xref="A3.p1.10.m10.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.10.m10.1b"><apply id="A3.p1.10.m10.1.1.cmml" xref="A3.p1.10.m10.1.1"><csymbol cd="ambiguous" id="A3.p1.10.m10.1.1.1.cmml" xref="A3.p1.10.m10.1.1">subscript</csymbol><ci id="A3.p1.10.m10.1.1.2.cmml" xref="A3.p1.10.m10.1.1.2">𝒗</ci><ci id="A3.p1.10.m10.1.1.3.cmml" xref="A3.p1.10.m10.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.10.m10.1c">\bm{v}_{l}</annotation></semantics></math> to shift the original representation, resulting in <math id="A3.p1.11.m11.2" class="ltx_Math" alttext="h(\hat{x}_{i})^{\prime}=h(\hat{x}_{i})+\bm{v}_{l}" display="inline"><semantics id="A3.p1.11.m11.2a"><mrow id="A3.p1.11.m11.2.2" xref="A3.p1.11.m11.2.2.cmml"><mrow id="A3.p1.11.m11.1.1.1" xref="A3.p1.11.m11.1.1.1.cmml"><mi id="A3.p1.11.m11.1.1.1.3" xref="A3.p1.11.m11.1.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="A3.p1.11.m11.1.1.1.2" xref="A3.p1.11.m11.1.1.1.2.cmml">​</mo><msup id="A3.p1.11.m11.1.1.1.1" xref="A3.p1.11.m11.1.1.1.1.cmml"><mrow id="A3.p1.11.m11.1.1.1.1.1.1" xref="A3.p1.11.m11.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.p1.11.m11.1.1.1.1.1.1.2" xref="A3.p1.11.m11.1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.p1.11.m11.1.1.1.1.1.1.1" xref="A3.p1.11.m11.1.1.1.1.1.1.1.cmml"><mover accent="true" id="A3.p1.11.m11.1.1.1.1.1.1.1.2" xref="A3.p1.11.m11.1.1.1.1.1.1.1.2.cmml"><mi id="A3.p1.11.m11.1.1.1.1.1.1.1.2.2" xref="A3.p1.11.m11.1.1.1.1.1.1.1.2.2.cmml">x</mi><mo id="A3.p1.11.m11.1.1.1.1.1.1.1.2.1" xref="A3.p1.11.m11.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="A3.p1.11.m11.1.1.1.1.1.1.1.3" xref="A3.p1.11.m11.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A3.p1.11.m11.1.1.1.1.1.1.3" xref="A3.p1.11.m11.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A3.p1.11.m11.1.1.1.1.3" xref="A3.p1.11.m11.1.1.1.1.3.cmml">′</mo></msup></mrow><mo id="A3.p1.11.m11.2.2.3" xref="A3.p1.11.m11.2.2.3.cmml">=</mo><mrow id="A3.p1.11.m11.2.2.2" xref="A3.p1.11.m11.2.2.2.cmml"><mrow id="A3.p1.11.m11.2.2.2.1" xref="A3.p1.11.m11.2.2.2.1.cmml"><mi id="A3.p1.11.m11.2.2.2.1.3" xref="A3.p1.11.m11.2.2.2.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="A3.p1.11.m11.2.2.2.1.2" xref="A3.p1.11.m11.2.2.2.1.2.cmml">​</mo><mrow id="A3.p1.11.m11.2.2.2.1.1.1" xref="A3.p1.11.m11.2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="A3.p1.11.m11.2.2.2.1.1.1.2" xref="A3.p1.11.m11.2.2.2.1.1.1.1.cmml">(</mo><msub id="A3.p1.11.m11.2.2.2.1.1.1.1" xref="A3.p1.11.m11.2.2.2.1.1.1.1.cmml"><mover accent="true" id="A3.p1.11.m11.2.2.2.1.1.1.1.2" xref="A3.p1.11.m11.2.2.2.1.1.1.1.2.cmml"><mi id="A3.p1.11.m11.2.2.2.1.1.1.1.2.2" xref="A3.p1.11.m11.2.2.2.1.1.1.1.2.2.cmml">x</mi><mo id="A3.p1.11.m11.2.2.2.1.1.1.1.2.1" xref="A3.p1.11.m11.2.2.2.1.1.1.1.2.1.cmml">^</mo></mover><mi id="A3.p1.11.m11.2.2.2.1.1.1.1.3" xref="A3.p1.11.m11.2.2.2.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A3.p1.11.m11.2.2.2.1.1.1.3" xref="A3.p1.11.m11.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.p1.11.m11.2.2.2.2" xref="A3.p1.11.m11.2.2.2.2.cmml">+</mo><msub id="A3.p1.11.m11.2.2.2.3" xref="A3.p1.11.m11.2.2.2.3.cmml"><mi id="A3.p1.11.m11.2.2.2.3.2" xref="A3.p1.11.m11.2.2.2.3.2.cmml">𝒗</mi><mi id="A3.p1.11.m11.2.2.2.3.3" xref="A3.p1.11.m11.2.2.2.3.3.cmml">l</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.11.m11.2b"><apply id="A3.p1.11.m11.2.2.cmml" xref="A3.p1.11.m11.2.2"><eq id="A3.p1.11.m11.2.2.3.cmml" xref="A3.p1.11.m11.2.2.3"></eq><apply id="A3.p1.11.m11.1.1.1.cmml" xref="A3.p1.11.m11.1.1.1"><times id="A3.p1.11.m11.1.1.1.2.cmml" xref="A3.p1.11.m11.1.1.1.2"></times><ci id="A3.p1.11.m11.1.1.1.3.cmml" xref="A3.p1.11.m11.1.1.1.3">ℎ</ci><apply id="A3.p1.11.m11.1.1.1.1.cmml" xref="A3.p1.11.m11.1.1.1.1"><csymbol cd="ambiguous" id="A3.p1.11.m11.1.1.1.1.2.cmml" xref="A3.p1.11.m11.1.1.1.1">superscript</csymbol><apply id="A3.p1.11.m11.1.1.1.1.1.1.1.cmml" xref="A3.p1.11.m11.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.p1.11.m11.1.1.1.1.1.1.1.1.cmml" xref="A3.p1.11.m11.1.1.1.1.1.1">subscript</csymbol><apply id="A3.p1.11.m11.1.1.1.1.1.1.1.2.cmml" xref="A3.p1.11.m11.1.1.1.1.1.1.1.2"><ci id="A3.p1.11.m11.1.1.1.1.1.1.1.2.1.cmml" xref="A3.p1.11.m11.1.1.1.1.1.1.1.2.1">^</ci><ci id="A3.p1.11.m11.1.1.1.1.1.1.1.2.2.cmml" xref="A3.p1.11.m11.1.1.1.1.1.1.1.2.2">𝑥</ci></apply><ci id="A3.p1.11.m11.1.1.1.1.1.1.1.3.cmml" xref="A3.p1.11.m11.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="A3.p1.11.m11.1.1.1.1.3.cmml" xref="A3.p1.11.m11.1.1.1.1.3">′</ci></apply></apply><apply id="A3.p1.11.m11.2.2.2.cmml" xref="A3.p1.11.m11.2.2.2"><plus id="A3.p1.11.m11.2.2.2.2.cmml" xref="A3.p1.11.m11.2.2.2.2"></plus><apply id="A3.p1.11.m11.2.2.2.1.cmml" xref="A3.p1.11.m11.2.2.2.1"><times id="A3.p1.11.m11.2.2.2.1.2.cmml" xref="A3.p1.11.m11.2.2.2.1.2"></times><ci id="A3.p1.11.m11.2.2.2.1.3.cmml" xref="A3.p1.11.m11.2.2.2.1.3">ℎ</ci><apply id="A3.p1.11.m11.2.2.2.1.1.1.1.cmml" xref="A3.p1.11.m11.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A3.p1.11.m11.2.2.2.1.1.1.1.1.cmml" xref="A3.p1.11.m11.2.2.2.1.1.1">subscript</csymbol><apply id="A3.p1.11.m11.2.2.2.1.1.1.1.2.cmml" xref="A3.p1.11.m11.2.2.2.1.1.1.1.2"><ci id="A3.p1.11.m11.2.2.2.1.1.1.1.2.1.cmml" xref="A3.p1.11.m11.2.2.2.1.1.1.1.2.1">^</ci><ci id="A3.p1.11.m11.2.2.2.1.1.1.1.2.2.cmml" xref="A3.p1.11.m11.2.2.2.1.1.1.1.2.2">𝑥</ci></apply><ci id="A3.p1.11.m11.2.2.2.1.1.1.1.3.cmml" xref="A3.p1.11.m11.2.2.2.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A3.p1.11.m11.2.2.2.3.cmml" xref="A3.p1.11.m11.2.2.2.3"><csymbol cd="ambiguous" id="A3.p1.11.m11.2.2.2.3.1.cmml" xref="A3.p1.11.m11.2.2.2.3">subscript</csymbol><ci id="A3.p1.11.m11.2.2.2.3.2.cmml" xref="A3.p1.11.m11.2.2.2.3.2">𝒗</ci><ci id="A3.p1.11.m11.2.2.2.3.3.cmml" xref="A3.p1.11.m11.2.2.2.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.11.m11.2c">h(\hat{x}_{i})^{\prime}=h(\hat{x}_{i})+\bm{v}_{l}</annotation></semantics></math>. We average the L-ICV trained in OKVQA and VQAv2 to get the general ICV and evaluate the performance of the general ICV <math id="A3.p1.12.m12.3" class="ltx_Math" alttext="\bm{V}_{g}=\{\bm{v}_{1},\dots,\bm{v}_{L}\}" display="inline"><semantics id="A3.p1.12.m12.3a"><mrow id="A3.p1.12.m12.3.3" xref="A3.p1.12.m12.3.3.cmml"><msub id="A3.p1.12.m12.3.3.4" xref="A3.p1.12.m12.3.3.4.cmml"><mi id="A3.p1.12.m12.3.3.4.2" xref="A3.p1.12.m12.3.3.4.2.cmml">𝑽</mi><mi id="A3.p1.12.m12.3.3.4.3" xref="A3.p1.12.m12.3.3.4.3.cmml">g</mi></msub><mo id="A3.p1.12.m12.3.3.3" xref="A3.p1.12.m12.3.3.3.cmml">=</mo><mrow id="A3.p1.12.m12.3.3.2.2" xref="A3.p1.12.m12.3.3.2.3.cmml"><mo stretchy="false" id="A3.p1.12.m12.3.3.2.2.3" xref="A3.p1.12.m12.3.3.2.3.cmml">{</mo><msub id="A3.p1.12.m12.2.2.1.1.1" xref="A3.p1.12.m12.2.2.1.1.1.cmml"><mi id="A3.p1.12.m12.2.2.1.1.1.2" xref="A3.p1.12.m12.2.2.1.1.1.2.cmml">𝒗</mi><mn id="A3.p1.12.m12.2.2.1.1.1.3" xref="A3.p1.12.m12.2.2.1.1.1.3.cmml">1</mn></msub><mo id="A3.p1.12.m12.3.3.2.2.4" xref="A3.p1.12.m12.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="A3.p1.12.m12.1.1" xref="A3.p1.12.m12.1.1.cmml">…</mi><mo id="A3.p1.12.m12.3.3.2.2.5" xref="A3.p1.12.m12.3.3.2.3.cmml">,</mo><msub id="A3.p1.12.m12.3.3.2.2.2" xref="A3.p1.12.m12.3.3.2.2.2.cmml"><mi id="A3.p1.12.m12.3.3.2.2.2.2" xref="A3.p1.12.m12.3.3.2.2.2.2.cmml">𝒗</mi><mi id="A3.p1.12.m12.3.3.2.2.2.3" xref="A3.p1.12.m12.3.3.2.2.2.3.cmml">L</mi></msub><mo stretchy="false" id="A3.p1.12.m12.3.3.2.2.6" xref="A3.p1.12.m12.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.12.m12.3b"><apply id="A3.p1.12.m12.3.3.cmml" xref="A3.p1.12.m12.3.3"><eq id="A3.p1.12.m12.3.3.3.cmml" xref="A3.p1.12.m12.3.3.3"></eq><apply id="A3.p1.12.m12.3.3.4.cmml" xref="A3.p1.12.m12.3.3.4"><csymbol cd="ambiguous" id="A3.p1.12.m12.3.3.4.1.cmml" xref="A3.p1.12.m12.3.3.4">subscript</csymbol><ci id="A3.p1.12.m12.3.3.4.2.cmml" xref="A3.p1.12.m12.3.3.4.2">𝑽</ci><ci id="A3.p1.12.m12.3.3.4.3.cmml" xref="A3.p1.12.m12.3.3.4.3">𝑔</ci></apply><set id="A3.p1.12.m12.3.3.2.3.cmml" xref="A3.p1.12.m12.3.3.2.2"><apply id="A3.p1.12.m12.2.2.1.1.1.cmml" xref="A3.p1.12.m12.2.2.1.1.1"><csymbol cd="ambiguous" id="A3.p1.12.m12.2.2.1.1.1.1.cmml" xref="A3.p1.12.m12.2.2.1.1.1">subscript</csymbol><ci id="A3.p1.12.m12.2.2.1.1.1.2.cmml" xref="A3.p1.12.m12.2.2.1.1.1.2">𝒗</ci><cn type="integer" id="A3.p1.12.m12.2.2.1.1.1.3.cmml" xref="A3.p1.12.m12.2.2.1.1.1.3">1</cn></apply><ci id="A3.p1.12.m12.1.1.cmml" xref="A3.p1.12.m12.1.1">…</ci><apply id="A3.p1.12.m12.3.3.2.2.2.cmml" xref="A3.p1.12.m12.3.3.2.2.2"><csymbol cd="ambiguous" id="A3.p1.12.m12.3.3.2.2.2.1.cmml" xref="A3.p1.12.m12.3.3.2.2.2">subscript</csymbol><ci id="A3.p1.12.m12.3.3.2.2.2.2.cmml" xref="A3.p1.12.m12.3.3.2.2.2.2">𝒗</ci><ci id="A3.p1.12.m12.3.3.2.2.2.3.cmml" xref="A3.p1.12.m12.3.3.2.2.2.3">𝐿</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.12.m12.3c">\bm{V}_{g}=\{\bm{v}_{1},\dots,\bm{v}_{L}\}</annotation></semantics></math> on OKVQA and VQAv2, with the results presented on Table <a href="#A3.T16" title="Table 16 ‣ Appendix C General L-ICV ‣ Learnable In-Context Vector for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">16</span></a>.</p>
</div>
<figure id="A3.T16" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 16: </span>Accuracy (%) for 32-shot ICL, task-specific L-ICV, General L-ICV.</figcaption>
<div id="A3.T16.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:216.8pt;height:50.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-7.3pt,1.7pt) scale(0.937161541951633,0.937161541951633) ;">
<table id="A3.T16.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A3.T16.1.1.1.1" class="ltx_tr">
<th id="A3.T16.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Methods</th>
<th id="A3.T16.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">32-shot ICL</th>
<th id="A3.T16.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">L-ICV</th>
<th id="A3.T16.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">General L-ICV</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A3.T16.1.1.2.1" class="ltx_tr">
<td id="A3.T16.1.1.2.1.1" class="ltx_td ltx_align_center ltx_border_t">VQAv2</td>
<td id="A3.T16.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">56.18</td>
<td id="A3.T16.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">58.54</td>
<td id="A3.T16.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">56.17</td>
</tr>
<tr id="A3.T16.1.1.3.2" class="ltx_tr">
<td id="A3.T16.1.1.3.2.1" class="ltx_td ltx_align_center ltx_border_bb">OKVQA</td>
<td id="A3.T16.1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_bb">48.48</td>
<td id="A3.T16.1.1.3.2.3" class="ltx_td ltx_align_center ltx_border_bb">50.08</td>
<td id="A3.T16.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_bb">49.52</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="A3.p2" class="ltx_para">
<p id="A3.p2.1" class="ltx_p">The results indicate that while the performance of the general ICV is somewhat reduced compared to task-specific L-ICV; it decreased by 2.37 on VQAv2 and by 0.56 on OKVQA. However, its performance is very close to that of 32-shot ICL. Most importantly, it offers significant advantages in real-world scenarios where the distribution of test data is unknown. This makes the general ICV more suitable for practical applications, providing a robust solution that can be effectively utilized across varying environments. Furthermore, the findings highlight the scalability of L-ICV: whenever a new VQA dataset is used to train L-ICV, we only need to simply recalculate the mean shift vectors of all previously trained task-specific L-ICVs and the new L-ICV to generate a new general ICV, thus creating a more general VQA L-ICV. This approach not only simplifies the adaptation process for diverse tasks but also ensures that the model maintains a high level of performance across different applications. The results, therefore, underscore the potential of general ICVs to enhance the flexibility and applicability of VQA systems in real-world settings.</p>
</div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2406.13184" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2406.13185" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2406.13185">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2406.13185" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2406.13186" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Jul  5 20:05:51 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
