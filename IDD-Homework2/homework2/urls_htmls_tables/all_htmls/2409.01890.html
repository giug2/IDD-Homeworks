<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks</title>
<!--Generated on Tue Sep  3 13:26:05 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Retrieval,  Negative Mining" lang="en" name="keywords"/>
<base href="/html/2409.01890v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S1" title="In A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S2" title="In A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Background</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S3" title="In A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Improving Training with Target Correctors</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S3.SS1" title="In 3 Improving Training with Target Correctors ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Latent Variables in Retrieval Augmented Models</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S4" title="In A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S5" title="In A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S5.SS1" title="In 5 Experiments ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Supervised Dense Retrieval</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S5.SS2" title="In 5 Experiments ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Retrieval Augmented Language Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S5.SS3" title="In 5 Experiments ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Synthetic Experiments</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S6" title="In A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Related work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S7" title="In A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#A1" title="In A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Analysis: Proofs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#A2" title="In A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#A2.SS1" title="In Appendix B Experiments ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>Experimental Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#A2.SS2" title="In Appendix B Experiments ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2 </span>Additional Dense Retrieval Results</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#A2.SS2.SSS0.Px1" title="In B.2 Additional Dense Retrieval Results ‣ Appendix B Experiments ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_title">Comparisons to 2-Round Training</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#A2.SS2.SSS0.Px2" title="In B.2 Additional Dense Retrieval Results ‣ Appendix B Experiments ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_title">Comparisons with and without uniform negatives</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#A2.SS3" title="In Appendix B Experiments ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.3 </span>Retrieve and Read</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#A2.SS4" title="In Appendix B Experiments ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.4 </span>Beyond Stale Representations: Approximating Large Models with Small Models</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_pruned_first">
<h1 class="ltx_title ltx_title_document">A Fresh Take on Stale Embeddings: 
<br class="ltx_break"/>Improving Dense Retriever Training with Corrector Networks</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Nicholas Monath
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Will Grathwohl
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Michael Boratko
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Rob Fergus
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Andrew McCallum
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Manzil Zaheer
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">In dense retrieval, deep encoders provide embeddings for both inputs and targets, and the softmax function is used to parameterize a distribution over a large number of candidate targets (e.g., textual passages for information retrieval). Significant challenges arise in training such encoders in the increasingly prevalent scenario of (1) a large number of targets, (2) a computationally expensive target encoder model, (3) cached target embeddings that are out-of-date due to ongoing training of target encoder parameters. This paper presents a simple and highly scalable response to these challenges by training a small parametric <span class="ltx_text ltx_font_italic" id="id1.id1.1">corrector network</span> that adjusts stale cached target embeddings, enabling an accurate softmax approximation and thereby sampling of up-to-date high scoring “hard negatives.” We theoretically investigate the generalization properties of our proposed target corrector, relating the complexity of the network, staleness of cached representations, and the amount of training data. We present experimental results on large benchmark dense retrieval datasets as well as on QA with retrieval augmented language models. Our approach matches state-of-the-art results even when no target embedding updates are made during training beyond an initial cache from the unsupervised pre-trained model, providing a 4-80x reduction in re-embedding computational cost.</p>
</div>
<div class="ltx_keywords">Retrieval, Negative Mining
</div>
<div class="ltx_para" id="p2">
<br class="ltx_break"/>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">The softmax function, paired with deep neural encoder models,
is often the parameterization of choice for discrete distributions
over many targets such as in classification <cite class="ltx_cite ltx_citemacro_citep">(Logeswaran et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib21" title="">2019</a>; Yu et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib41" title="">2022</a>)</cite>,
retrieval <cite class="ltx_cite ltx_citemacro_citep">(Reddi et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib32" title="">2019</a>; Xiong et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib39" title="">2020</a>)</cite>, or reinforcement learning
<cite class="ltx_cite ltx_citemacro_citep">(Dulac-Arnold et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib6" title="">2015</a>; Gottipati et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib8" title="">2020</a>)</cite>.
This approach, often called a “dual encoder,” employs two separate deep networks, one to map an input to a fixed dimensional vector, another to map targets to the same vector space. We then compute softmax logits as the inner product of an input vector to each target vector <cite class="ltx_cite ltx_citemacro_citep">(Gillick et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib7" title="">2019</a>; Karpukhin et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib17" title="">2020</a>; Xiong et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib39" title="">2020</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">With the typical softmax cross-entropy loss, exact training of the parameters of these two encoder networks would involve using the current parameters to compute the logits for all targets, requiring running the target encoder on all targets at every step of training. Of course, this far-too-burdensome approach is not used in practice. Instead, various approximations have been developed <cite class="ltx_cite ltx_citemacro_citep">(Reddi et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib32" title="">2019</a>; Rawat et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib31" title="">2020</a>; Lindgren et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib20" title="">2021</a>; Xiong et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib39" title="">2020</a>; Monath et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib24" title="">2023</a>)</cite>.
The typical approximation computes a truncated softmax on a sampled subset of targets. These approaches store a <em class="ltx_emph ltx_font_italic" id="S1.p2.1.1">cache</em> of “stale” encoded representations of targets and uses the stale, cached representations to draw samples from the softmax-parameterized distribution during training <cite class="ltx_cite ltx_citemacro_citep">(Lindgren et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib20" title="">2021</a>; Izacard et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib15" title="">2022</a>)</cite>. Previous work has used these stale representations amidst other approximations such as index structures <cite class="ltx_cite ltx_citemacro_citep">(Xiong et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib39" title="">2020</a>; Monath et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib24" title="">2023</a>)</cite>, kernel-methods <cite class="ltx_cite ltx_citemacro_citep">(Rawat et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib30" title="">2019</a>)</cite>, and focusing training on subsets of targets <cite class="ltx_cite ltx_citemacro_citep">(Reddi et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib32" title="">2019</a>)</cite>. However, inevitably, the staleness of the target embeddings causes training regret.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">In this work, we present a simple, general purpose method for addressing staleness in softmax-parameterized categorical distributions that is scalable enough to be updated at every step of training. Our approach improves upon an existing stale approximation using a learned <em class="ltx_emph ltx_font_italic" id="S1.p3.1.1">target corrector network</em>. The target corrector network, inspired by recent work on training continuous energy-based models <cite class="ltx_cite ltx_citemacro_citep">(Han et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib12" title="">2020</a>; Grathwohl et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib9" title="">2020</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib10" title="">2021</a>)</cite>, is a small parametric model that accounts for the discrepancy between the stale approximation and unnormalized logits from the true distribution. By learning to improve upon the stale approximation, the target corrector network can be used to produce a more accurate approximation to the target distribution. We further extend beyond training large output space classifiers to latent variable retrieval augmented language models.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In summary, the contributions of this paper are:</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1"><span class="ltx_text ltx_font_bold" id="S1.p5.1.1">Methodological</span> (§<a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S3" title="3 Improving Training with Target Correctors ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">3</span></a>) - We describe a novel training procedure for large output space models. It is based on approximating softmax-parameterized categorical distributions by using a parametric target corrector network that learns to improve stale approximations of logits.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1"><span class="ltx_text ltx_font_bold" id="S1.p6.1.1">Theoretical</span> (§<a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S4" title="4 Analysis ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">4</span></a>) - We analyze the generalization properties of the corrector networks in terms of the discrepancy between the stale approximation and the true distribution, the complexity of the network, and the amount of training data.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1"><span class="ltx_text ltx_font_bold" id="S1.p7.1.1">Empirical</span> (§<a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S5" title="5 Experiments ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">5</span></a>) -
We evaluate our approach in training both dense retrieval models and latent variable retrieval augmented language models. Our approach matches the performance of much more computationally intensive approaches at a fraction of the computational expense.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Background</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.3"><span class="ltx_text ltx_font_bold" id="S2.p1.3.1">Softmax </span> Given an input point <math alttext="x" class="ltx_Math" display="inline" id="S2.p1.1.m1.1"><semantics id="S2.p1.1.m1.1a"><mi id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.1d">italic_x</annotation></semantics></math>, a distribution over a set of <math alttext="N" class="ltx_Math" display="inline" id="S2.p1.2.m2.1"><semantics id="S2.p1.2.m2.1a"><mi id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.p1.2.m2.1d">italic_N</annotation></semantics></math> <em class="ltx_emph ltx_font_italic" id="S2.p1.3.2">targets</em>, <math alttext="\mathcal{Y}" class="ltx_Math" display="inline" id="S2.p1.3.m3.1"><semantics id="S2.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><ci id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.3.m3.1d">caligraphic_Y</annotation></semantics></math>, parameterized by the softmax function is:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\vspace{-1mm}P(y|x)=\frac{\exp(\beta s_{x,y})}{Z_{x}\triangleq\sum_{y^{\prime}%
\in\mathcal{Y}}\exp(\beta s_{x,y^{\prime}})}," class="ltx_Math" display="block" id="S2.E1.m1.9"><semantics id="S2.E1.m1.9a"><mrow id="S2.E1.m1.9.9.1" xref="S2.E1.m1.9.9.1.1.cmml"><mrow id="S2.E1.m1.9.9.1.1" xref="S2.E1.m1.9.9.1.1.cmml"><mrow id="S2.E1.m1.9.9.1.1.1" xref="S2.E1.m1.9.9.1.1.1.cmml"><mi id="S2.E1.m1.9.9.1.1.1.3" xref="S2.E1.m1.9.9.1.1.1.3.cmml">P</mi><mo id="S2.E1.m1.9.9.1.1.1.2" xref="S2.E1.m1.9.9.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.9.9.1.1.1.1.1" xref="S2.E1.m1.9.9.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.9.9.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.9.9.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.9.9.1.1.1.1.1.1" xref="S2.E1.m1.9.9.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.9.9.1.1.1.1.1.1.2" xref="S2.E1.m1.9.9.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S2.E1.m1.9.9.1.1.1.1.1.1.1" xref="S2.E1.m1.9.9.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.E1.m1.9.9.1.1.1.1.1.1.3" xref="S2.E1.m1.9.9.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E1.m1.9.9.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.9.9.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.9.9.1.1.2" xref="S2.E1.m1.9.9.1.1.2.cmml">=</mo><mfrac id="S2.E1.m1.8.8" xref="S2.E1.m1.8.8.cmml"><mrow id="S2.E1.m1.4.4.4.4" xref="S2.E1.m1.4.4.4.5.cmml"><mi id="S2.E1.m1.3.3.3.3" xref="S2.E1.m1.3.3.3.3.cmml">exp</mi><mo id="S2.E1.m1.4.4.4.4a" xref="S2.E1.m1.4.4.4.5.cmml">⁡</mo><mrow id="S2.E1.m1.4.4.4.4.1" xref="S2.E1.m1.4.4.4.5.cmml"><mo id="S2.E1.m1.4.4.4.4.1.2" stretchy="false" xref="S2.E1.m1.4.4.4.5.cmml">(</mo><mrow id="S2.E1.m1.4.4.4.4.1.1" xref="S2.E1.m1.4.4.4.4.1.1.cmml"><mi id="S2.E1.m1.4.4.4.4.1.1.2" xref="S2.E1.m1.4.4.4.4.1.1.2.cmml">β</mi><mo id="S2.E1.m1.4.4.4.4.1.1.1" xref="S2.E1.m1.4.4.4.4.1.1.1.cmml">⁢</mo><msub id="S2.E1.m1.4.4.4.4.1.1.3" xref="S2.E1.m1.4.4.4.4.1.1.3.cmml"><mi id="S2.E1.m1.4.4.4.4.1.1.3.2" xref="S2.E1.m1.4.4.4.4.1.1.3.2.cmml">s</mi><mrow id="S2.E1.m1.2.2.2.2.2.4" xref="S2.E1.m1.2.2.2.2.2.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml">x</mi><mo id="S2.E1.m1.2.2.2.2.2.4.1" xref="S2.E1.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S2.E1.m1.2.2.2.2.2.2" xref="S2.E1.m1.2.2.2.2.2.2.cmml">y</mi></mrow></msub></mrow><mo id="S2.E1.m1.4.4.4.4.1.3" stretchy="false" xref="S2.E1.m1.4.4.4.5.cmml">)</mo></mrow></mrow><mrow id="S2.E1.m1.8.8.8" xref="S2.E1.m1.8.8.8.cmml"><msub id="S2.E1.m1.8.8.8.6" xref="S2.E1.m1.8.8.8.6.cmml"><mi id="S2.E1.m1.8.8.8.6.2" xref="S2.E1.m1.8.8.8.6.2.cmml">Z</mi><mi id="S2.E1.m1.8.8.8.6.3" xref="S2.E1.m1.8.8.8.6.3.cmml">x</mi></msub><mo id="S2.E1.m1.8.8.8.5" rspace="0.111em" xref="S2.E1.m1.8.8.8.5.cmml">≜</mo><mrow id="S2.E1.m1.8.8.8.4" xref="S2.E1.m1.8.8.8.4.cmml"><msub id="S2.E1.m1.8.8.8.4.2" xref="S2.E1.m1.8.8.8.4.2.cmml"><mo id="S2.E1.m1.8.8.8.4.2.2" xref="S2.E1.m1.8.8.8.4.2.2.cmml">∑</mo><mrow id="S2.E1.m1.8.8.8.4.2.3" xref="S2.E1.m1.8.8.8.4.2.3.cmml"><msup id="S2.E1.m1.8.8.8.4.2.3.2" xref="S2.E1.m1.8.8.8.4.2.3.2.cmml"><mi id="S2.E1.m1.8.8.8.4.2.3.2.2" xref="S2.E1.m1.8.8.8.4.2.3.2.2.cmml">y</mi><mo id="S2.E1.m1.8.8.8.4.2.3.2.3" xref="S2.E1.m1.8.8.8.4.2.3.2.3.cmml">′</mo></msup><mo id="S2.E1.m1.8.8.8.4.2.3.1" xref="S2.E1.m1.8.8.8.4.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.8.8.8.4.2.3.3" xref="S2.E1.m1.8.8.8.4.2.3.3.cmml">𝒴</mi></mrow></msub><mrow id="S2.E1.m1.8.8.8.4.1.1" xref="S2.E1.m1.8.8.8.4.1.2.cmml"><mi id="S2.E1.m1.7.7.7.3" xref="S2.E1.m1.7.7.7.3.cmml">exp</mi><mo id="S2.E1.m1.8.8.8.4.1.1a" xref="S2.E1.m1.8.8.8.4.1.2.cmml">⁡</mo><mrow id="S2.E1.m1.8.8.8.4.1.1.1" xref="S2.E1.m1.8.8.8.4.1.2.cmml"><mo id="S2.E1.m1.8.8.8.4.1.1.1.2" stretchy="false" xref="S2.E1.m1.8.8.8.4.1.2.cmml">(</mo><mrow id="S2.E1.m1.8.8.8.4.1.1.1.1" xref="S2.E1.m1.8.8.8.4.1.1.1.1.cmml"><mi id="S2.E1.m1.8.8.8.4.1.1.1.1.2" xref="S2.E1.m1.8.8.8.4.1.1.1.1.2.cmml">β</mi><mo id="S2.E1.m1.8.8.8.4.1.1.1.1.1" xref="S2.E1.m1.8.8.8.4.1.1.1.1.1.cmml">⁢</mo><msub id="S2.E1.m1.8.8.8.4.1.1.1.1.3" xref="S2.E1.m1.8.8.8.4.1.1.1.1.3.cmml"><mi id="S2.E1.m1.8.8.8.4.1.1.1.1.3.2" xref="S2.E1.m1.8.8.8.4.1.1.1.1.3.2.cmml">s</mi><mrow id="S2.E1.m1.6.6.6.2.2.2" xref="S2.E1.m1.6.6.6.2.2.3.cmml"><mi id="S2.E1.m1.5.5.5.1.1.1" xref="S2.E1.m1.5.5.5.1.1.1.cmml">x</mi><mo id="S2.E1.m1.6.6.6.2.2.2.2" xref="S2.E1.m1.6.6.6.2.2.3.cmml">,</mo><msup id="S2.E1.m1.6.6.6.2.2.2.1" xref="S2.E1.m1.6.6.6.2.2.2.1.cmml"><mi id="S2.E1.m1.6.6.6.2.2.2.1.2" xref="S2.E1.m1.6.6.6.2.2.2.1.2.cmml">y</mi><mo id="S2.E1.m1.6.6.6.2.2.2.1.3" xref="S2.E1.m1.6.6.6.2.2.2.1.3.cmml">′</mo></msup></mrow></msub></mrow><mo id="S2.E1.m1.8.8.8.4.1.1.1.3" stretchy="false" xref="S2.E1.m1.8.8.8.4.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mrow><mo id="S2.E1.m1.9.9.1.2" xref="S2.E1.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.9b"><apply id="S2.E1.m1.9.9.1.1.cmml" xref="S2.E1.m1.9.9.1"><eq id="S2.E1.m1.9.9.1.1.2.cmml" xref="S2.E1.m1.9.9.1.1.2"></eq><apply id="S2.E1.m1.9.9.1.1.1.cmml" xref="S2.E1.m1.9.9.1.1.1"><times id="S2.E1.m1.9.9.1.1.1.2.cmml" xref="S2.E1.m1.9.9.1.1.1.2"></times><ci id="S2.E1.m1.9.9.1.1.1.3.cmml" xref="S2.E1.m1.9.9.1.1.1.3">𝑃</ci><apply id="S2.E1.m1.9.9.1.1.1.1.1.1.cmml" xref="S2.E1.m1.9.9.1.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.9.9.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E1.m1.9.9.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.9.9.1.1.1.1.1.1.2">𝑦</ci><ci id="S2.E1.m1.9.9.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.9.9.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S2.E1.m1.8.8.cmml" xref="S2.E1.m1.8.8"><divide id="S2.E1.m1.8.8.9.cmml" xref="S2.E1.m1.8.8"></divide><apply id="S2.E1.m1.4.4.4.5.cmml" xref="S2.E1.m1.4.4.4.4"><exp id="S2.E1.m1.3.3.3.3.cmml" xref="S2.E1.m1.3.3.3.3"></exp><apply id="S2.E1.m1.4.4.4.4.1.1.cmml" xref="S2.E1.m1.4.4.4.4.1.1"><times id="S2.E1.m1.4.4.4.4.1.1.1.cmml" xref="S2.E1.m1.4.4.4.4.1.1.1"></times><ci id="S2.E1.m1.4.4.4.4.1.1.2.cmml" xref="S2.E1.m1.4.4.4.4.1.1.2">𝛽</ci><apply id="S2.E1.m1.4.4.4.4.1.1.3.cmml" xref="S2.E1.m1.4.4.4.4.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.4.4.1.1.3.1.cmml" xref="S2.E1.m1.4.4.4.4.1.1.3">subscript</csymbol><ci id="S2.E1.m1.4.4.4.4.1.1.3.2.cmml" xref="S2.E1.m1.4.4.4.4.1.1.3.2">𝑠</ci><list id="S2.E1.m1.2.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2.2.4"><ci id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1">𝑥</ci><ci id="S2.E1.m1.2.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2.2.2">𝑦</ci></list></apply></apply></apply><apply id="S2.E1.m1.8.8.8.cmml" xref="S2.E1.m1.8.8.8"><ci id="S2.E1.m1.8.8.8.5.cmml" xref="S2.E1.m1.8.8.8.5">≜</ci><apply id="S2.E1.m1.8.8.8.6.cmml" xref="S2.E1.m1.8.8.8.6"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.8.6.1.cmml" xref="S2.E1.m1.8.8.8.6">subscript</csymbol><ci id="S2.E1.m1.8.8.8.6.2.cmml" xref="S2.E1.m1.8.8.8.6.2">𝑍</ci><ci id="S2.E1.m1.8.8.8.6.3.cmml" xref="S2.E1.m1.8.8.8.6.3">𝑥</ci></apply><apply id="S2.E1.m1.8.8.8.4.cmml" xref="S2.E1.m1.8.8.8.4"><apply id="S2.E1.m1.8.8.8.4.2.cmml" xref="S2.E1.m1.8.8.8.4.2"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.8.4.2.1.cmml" xref="S2.E1.m1.8.8.8.4.2">subscript</csymbol><sum id="S2.E1.m1.8.8.8.4.2.2.cmml" xref="S2.E1.m1.8.8.8.4.2.2"></sum><apply id="S2.E1.m1.8.8.8.4.2.3.cmml" xref="S2.E1.m1.8.8.8.4.2.3"><in id="S2.E1.m1.8.8.8.4.2.3.1.cmml" xref="S2.E1.m1.8.8.8.4.2.3.1"></in><apply id="S2.E1.m1.8.8.8.4.2.3.2.cmml" xref="S2.E1.m1.8.8.8.4.2.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.8.4.2.3.2.1.cmml" xref="S2.E1.m1.8.8.8.4.2.3.2">superscript</csymbol><ci id="S2.E1.m1.8.8.8.4.2.3.2.2.cmml" xref="S2.E1.m1.8.8.8.4.2.3.2.2">𝑦</ci><ci id="S2.E1.m1.8.8.8.4.2.3.2.3.cmml" xref="S2.E1.m1.8.8.8.4.2.3.2.3">′</ci></apply><ci id="S2.E1.m1.8.8.8.4.2.3.3.cmml" xref="S2.E1.m1.8.8.8.4.2.3.3">𝒴</ci></apply></apply><apply id="S2.E1.m1.8.8.8.4.1.2.cmml" xref="S2.E1.m1.8.8.8.4.1.1"><exp id="S2.E1.m1.7.7.7.3.cmml" xref="S2.E1.m1.7.7.7.3"></exp><apply id="S2.E1.m1.8.8.8.4.1.1.1.1.cmml" xref="S2.E1.m1.8.8.8.4.1.1.1.1"><times id="S2.E1.m1.8.8.8.4.1.1.1.1.1.cmml" xref="S2.E1.m1.8.8.8.4.1.1.1.1.1"></times><ci id="S2.E1.m1.8.8.8.4.1.1.1.1.2.cmml" xref="S2.E1.m1.8.8.8.4.1.1.1.1.2">𝛽</ci><apply id="S2.E1.m1.8.8.8.4.1.1.1.1.3.cmml" xref="S2.E1.m1.8.8.8.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.8.4.1.1.1.1.3.1.cmml" xref="S2.E1.m1.8.8.8.4.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.8.8.8.4.1.1.1.1.3.2.cmml" xref="S2.E1.m1.8.8.8.4.1.1.1.1.3.2">𝑠</ci><list id="S2.E1.m1.6.6.6.2.2.3.cmml" xref="S2.E1.m1.6.6.6.2.2.2"><ci id="S2.E1.m1.5.5.5.1.1.1.cmml" xref="S2.E1.m1.5.5.5.1.1.1">𝑥</ci><apply id="S2.E1.m1.6.6.6.2.2.2.1.cmml" xref="S2.E1.m1.6.6.6.2.2.2.1"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.6.2.2.2.1.1.cmml" xref="S2.E1.m1.6.6.6.2.2.2.1">superscript</csymbol><ci id="S2.E1.m1.6.6.6.2.2.2.1.2.cmml" xref="S2.E1.m1.6.6.6.2.2.2.1.2">𝑦</ci><ci id="S2.E1.m1.6.6.6.2.2.2.1.3.cmml" xref="S2.E1.m1.6.6.6.2.2.2.1.3">′</ci></apply></list></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.9c">\vspace{-1mm}P(y|x)=\frac{\exp(\beta s_{x,y})}{Z_{x}\triangleq\sum_{y^{\prime}%
\in\mathcal{Y}}\exp(\beta s_{x,y^{\prime}})},</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.9d">italic_P ( italic_y | italic_x ) = divide start_ARG roman_exp ( italic_β italic_s start_POSTSUBSCRIPT italic_x , italic_y end_POSTSUBSCRIPT ) end_ARG start_ARG italic_Z start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT ≜ ∑ start_POSTSUBSCRIPT italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ caligraphic_Y end_POSTSUBSCRIPT roman_exp ( italic_β italic_s start_POSTSUBSCRIPT italic_x , italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p1.6">where <math alttext="\beta" class="ltx_Math" display="inline" id="S2.p1.4.m1.1"><semantics id="S2.p1.4.m1.1a"><mi id="S2.p1.4.m1.1.1" xref="S2.p1.4.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S2.p1.4.m1.1b"><ci id="S2.p1.4.m1.1.1.cmml" xref="S2.p1.4.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S2.p1.4.m1.1d">italic_β</annotation></semantics></math> is the temperature. In this paper, we focus on applications in retrieval and latent variable models. For example, in Natural Questions <cite class="ltx_cite ltx_citemacro_citep">(Kwiatkowski et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib19" title="">2019</a>)</cite>, <math alttext="x" class="ltx_Math" display="inline" id="S2.p1.5.m2.1"><semantics id="S2.p1.5.m2.1a"><mi id="S2.p1.5.m2.1.1" xref="S2.p1.5.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.p1.5.m2.1b"><ci id="S2.p1.5.m2.1.1.cmml" xref="S2.p1.5.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.p1.5.m2.1d">italic_x</annotation></semantics></math> refers to a question and targets, <math alttext="y" class="ltx_Math" display="inline" id="S2.p1.6.m3.1"><semantics id="S2.p1.6.m3.1a"><mi id="S2.p1.6.m3.1.1" xref="S2.p1.6.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.p1.6.m3.1b"><ci id="S2.p1.6.m3.1.1.cmml" xref="S2.p1.6.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m3.1c">y</annotation><annotation encoding="application/x-llamapun" id="S2.p1.6.m3.1d">italic_y</annotation></semantics></math>, correspond to Wikipedia passages.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.6"><span class="ltx_text ltx_font_bold" id="S2.p2.6.1">Dual-Encoders </span> We compute the unnormalized logits, <math alttext="s_{x,y}" class="ltx_Math" display="inline" id="S2.p2.1.m1.2"><semantics id="S2.p2.1.m1.2a"><msub id="S2.p2.1.m1.2.3" xref="S2.p2.1.m1.2.3.cmml"><mi id="S2.p2.1.m1.2.3.2" xref="S2.p2.1.m1.2.3.2.cmml">s</mi><mrow id="S2.p2.1.m1.2.2.2.4" xref="S2.p2.1.m1.2.2.2.3.cmml"><mi id="S2.p2.1.m1.1.1.1.1" xref="S2.p2.1.m1.1.1.1.1.cmml">x</mi><mo id="S2.p2.1.m1.2.2.2.4.1" xref="S2.p2.1.m1.2.2.2.3.cmml">,</mo><mi id="S2.p2.1.m1.2.2.2.2" xref="S2.p2.1.m1.2.2.2.2.cmml">y</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.2b"><apply id="S2.p2.1.m1.2.3.cmml" xref="S2.p2.1.m1.2.3"><csymbol cd="ambiguous" id="S2.p2.1.m1.2.3.1.cmml" xref="S2.p2.1.m1.2.3">subscript</csymbol><ci id="S2.p2.1.m1.2.3.2.cmml" xref="S2.p2.1.m1.2.3.2">𝑠</ci><list id="S2.p2.1.m1.2.2.2.3.cmml" xref="S2.p2.1.m1.2.2.2.4"><ci id="S2.p2.1.m1.1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1.1">𝑥</ci><ci id="S2.p2.1.m1.2.2.2.2.cmml" xref="S2.p2.1.m1.2.2.2.2">𝑦</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.2c">s_{x,y}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.1.m1.2d">italic_s start_POSTSUBSCRIPT italic_x , italic_y end_POSTSUBSCRIPT</annotation></semantics></math>, using a factorized representation. Deep parametric models, <em class="ltx_emph ltx_font_italic" id="S2.p2.6.2">dual-encoders</em>, map the input, <math alttext="x" class="ltx_Math" display="inline" id="S2.p2.2.m2.1"><semantics id="S2.p2.2.m2.1a"><mi id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><ci id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.p2.2.m2.1d">italic_x</annotation></semantics></math>, and target, <math alttext="y" class="ltx_Math" display="inline" id="S2.p2.3.m3.1"><semantics id="S2.p2.3.m3.1a"><mi id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><ci id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">y</annotation><annotation encoding="application/x-llamapun" id="S2.p2.3.m3.1d">italic_y</annotation></semantics></math>, to <math alttext="D" class="ltx_Math" display="inline" id="S2.p2.4.m4.1"><semantics id="S2.p2.4.m4.1a"><mi id="S2.p2.4.m4.1.1" xref="S2.p2.4.m4.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S2.p2.4.m4.1b"><ci id="S2.p2.4.m4.1.1.cmml" xref="S2.p2.4.m4.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m4.1c">D</annotation><annotation encoding="application/x-llamapun" id="S2.p2.4.m4.1d">italic_D</annotation></semantics></math>-dimensional vectors, denoted <math alttext="f(x;\Theta)" class="ltx_Math" display="inline" id="S2.p2.5.m5.2"><semantics id="S2.p2.5.m5.2a"><mrow id="S2.p2.5.m5.2.3" xref="S2.p2.5.m5.2.3.cmml"><mi id="S2.p2.5.m5.2.3.2" xref="S2.p2.5.m5.2.3.2.cmml">f</mi><mo id="S2.p2.5.m5.2.3.1" xref="S2.p2.5.m5.2.3.1.cmml">⁢</mo><mrow id="S2.p2.5.m5.2.3.3.2" xref="S2.p2.5.m5.2.3.3.1.cmml"><mo id="S2.p2.5.m5.2.3.3.2.1" stretchy="false" xref="S2.p2.5.m5.2.3.3.1.cmml">(</mo><mi id="S2.p2.5.m5.1.1" xref="S2.p2.5.m5.1.1.cmml">x</mi><mo id="S2.p2.5.m5.2.3.3.2.2" xref="S2.p2.5.m5.2.3.3.1.cmml">;</mo><mi id="S2.p2.5.m5.2.2" mathvariant="normal" xref="S2.p2.5.m5.2.2.cmml">Θ</mi><mo id="S2.p2.5.m5.2.3.3.2.3" stretchy="false" xref="S2.p2.5.m5.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.5.m5.2b"><apply id="S2.p2.5.m5.2.3.cmml" xref="S2.p2.5.m5.2.3"><times id="S2.p2.5.m5.2.3.1.cmml" xref="S2.p2.5.m5.2.3.1"></times><ci id="S2.p2.5.m5.2.3.2.cmml" xref="S2.p2.5.m5.2.3.2">𝑓</ci><list id="S2.p2.5.m5.2.3.3.1.cmml" xref="S2.p2.5.m5.2.3.3.2"><ci id="S2.p2.5.m5.1.1.cmml" xref="S2.p2.5.m5.1.1">𝑥</ci><ci id="S2.p2.5.m5.2.2.cmml" xref="S2.p2.5.m5.2.2">Θ</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m5.2c">f(x;\Theta)</annotation><annotation encoding="application/x-llamapun" id="S2.p2.5.m5.2d">italic_f ( italic_x ; roman_Θ )</annotation></semantics></math>, and <math alttext="g(y;\Theta)" class="ltx_Math" display="inline" id="S2.p2.6.m6.2"><semantics id="S2.p2.6.m6.2a"><mrow id="S2.p2.6.m6.2.3" xref="S2.p2.6.m6.2.3.cmml"><mi id="S2.p2.6.m6.2.3.2" xref="S2.p2.6.m6.2.3.2.cmml">g</mi><mo id="S2.p2.6.m6.2.3.1" xref="S2.p2.6.m6.2.3.1.cmml">⁢</mo><mrow id="S2.p2.6.m6.2.3.3.2" xref="S2.p2.6.m6.2.3.3.1.cmml"><mo id="S2.p2.6.m6.2.3.3.2.1" stretchy="false" xref="S2.p2.6.m6.2.3.3.1.cmml">(</mo><mi id="S2.p2.6.m6.1.1" xref="S2.p2.6.m6.1.1.cmml">y</mi><mo id="S2.p2.6.m6.2.3.3.2.2" xref="S2.p2.6.m6.2.3.3.1.cmml">;</mo><mi id="S2.p2.6.m6.2.2" mathvariant="normal" xref="S2.p2.6.m6.2.2.cmml">Θ</mi><mo id="S2.p2.6.m6.2.3.3.2.3" stretchy="false" xref="S2.p2.6.m6.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.6.m6.2b"><apply id="S2.p2.6.m6.2.3.cmml" xref="S2.p2.6.m6.2.3"><times id="S2.p2.6.m6.2.3.1.cmml" xref="S2.p2.6.m6.2.3.1"></times><ci id="S2.p2.6.m6.2.3.2.cmml" xref="S2.p2.6.m6.2.3.2">𝑔</ci><list id="S2.p2.6.m6.2.3.3.1.cmml" xref="S2.p2.6.m6.2.3.3.2"><ci id="S2.p2.6.m6.1.1.cmml" xref="S2.p2.6.m6.1.1">𝑦</ci><ci id="S2.p2.6.m6.2.2.cmml" xref="S2.p2.6.m6.2.2">Θ</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.6.m6.2c">g(y;\Theta)</annotation><annotation encoding="application/x-llamapun" id="S2.p2.6.m6.2d">italic_g ( italic_y ; roman_Θ )</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\vspace{-2mm}s_{x,y}=\langle f(x;\Theta),g(y;\Theta)\rangle.\vspace{-2mm}" class="ltx_Math" display="block" id="S2.E2.m1.7"><semantics id="S2.E2.m1.7a"><mrow id="S2.E2.m1.7.7.1" xref="S2.E2.m1.7.7.1.1.cmml"><mrow id="S2.E2.m1.7.7.1.1" xref="S2.E2.m1.7.7.1.1.cmml"><msub id="S2.E2.m1.7.7.1.1.4" xref="S2.E2.m1.7.7.1.1.4.cmml"><mi id="S2.E2.m1.7.7.1.1.4.2" xref="S2.E2.m1.7.7.1.1.4.2.cmml">s</mi><mrow id="S2.E2.m1.2.2.2.4" xref="S2.E2.m1.2.2.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">x</mi><mo id="S2.E2.m1.2.2.2.4.1" xref="S2.E2.m1.2.2.2.3.cmml">,</mo><mi id="S2.E2.m1.2.2.2.2" xref="S2.E2.m1.2.2.2.2.cmml">y</mi></mrow></msub><mo id="S2.E2.m1.7.7.1.1.3" xref="S2.E2.m1.7.7.1.1.3.cmml">=</mo><mrow id="S2.E2.m1.7.7.1.1.2.2" xref="S2.E2.m1.7.7.1.1.2.3.cmml"><mo id="S2.E2.m1.7.7.1.1.2.2.3" stretchy="false" xref="S2.E2.m1.7.7.1.1.2.3.cmml">⟨</mo><mrow id="S2.E2.m1.7.7.1.1.1.1.1" xref="S2.E2.m1.7.7.1.1.1.1.1.cmml"><mi id="S2.E2.m1.7.7.1.1.1.1.1.2" xref="S2.E2.m1.7.7.1.1.1.1.1.2.cmml">f</mi><mo id="S2.E2.m1.7.7.1.1.1.1.1.1" xref="S2.E2.m1.7.7.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.E2.m1.7.7.1.1.1.1.1.3.2" xref="S2.E2.m1.7.7.1.1.1.1.1.3.1.cmml"><mo id="S2.E2.m1.7.7.1.1.1.1.1.3.2.1" stretchy="false" xref="S2.E2.m1.7.7.1.1.1.1.1.3.1.cmml">(</mo><mi id="S2.E2.m1.3.3" xref="S2.E2.m1.3.3.cmml">x</mi><mo id="S2.E2.m1.7.7.1.1.1.1.1.3.2.2" xref="S2.E2.m1.7.7.1.1.1.1.1.3.1.cmml">;</mo><mi id="S2.E2.m1.4.4" mathvariant="normal" xref="S2.E2.m1.4.4.cmml">Θ</mi><mo id="S2.E2.m1.7.7.1.1.1.1.1.3.2.3" stretchy="false" xref="S2.E2.m1.7.7.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.7.7.1.1.2.2.4" xref="S2.E2.m1.7.7.1.1.2.3.cmml">,</mo><mrow id="S2.E2.m1.7.7.1.1.2.2.2" xref="S2.E2.m1.7.7.1.1.2.2.2.cmml"><mi id="S2.E2.m1.7.7.1.1.2.2.2.2" xref="S2.E2.m1.7.7.1.1.2.2.2.2.cmml">g</mi><mo id="S2.E2.m1.7.7.1.1.2.2.2.1" xref="S2.E2.m1.7.7.1.1.2.2.2.1.cmml">⁢</mo><mrow id="S2.E2.m1.7.7.1.1.2.2.2.3.2" xref="S2.E2.m1.7.7.1.1.2.2.2.3.1.cmml"><mo id="S2.E2.m1.7.7.1.1.2.2.2.3.2.1" stretchy="false" xref="S2.E2.m1.7.7.1.1.2.2.2.3.1.cmml">(</mo><mi id="S2.E2.m1.5.5" xref="S2.E2.m1.5.5.cmml">y</mi><mo id="S2.E2.m1.7.7.1.1.2.2.2.3.2.2" xref="S2.E2.m1.7.7.1.1.2.2.2.3.1.cmml">;</mo><mi id="S2.E2.m1.6.6" mathvariant="normal" xref="S2.E2.m1.6.6.cmml">Θ</mi><mo id="S2.E2.m1.7.7.1.1.2.2.2.3.2.3" stretchy="false" xref="S2.E2.m1.7.7.1.1.2.2.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.7.7.1.1.2.2.5" stretchy="false" xref="S2.E2.m1.7.7.1.1.2.3.cmml">⟩</mo></mrow></mrow><mo id="S2.E2.m1.7.7.1.2" lspace="0em" xref="S2.E2.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.7b"><apply id="S2.E2.m1.7.7.1.1.cmml" xref="S2.E2.m1.7.7.1"><eq id="S2.E2.m1.7.7.1.1.3.cmml" xref="S2.E2.m1.7.7.1.1.3"></eq><apply id="S2.E2.m1.7.7.1.1.4.cmml" xref="S2.E2.m1.7.7.1.1.4"><csymbol cd="ambiguous" id="S2.E2.m1.7.7.1.1.4.1.cmml" xref="S2.E2.m1.7.7.1.1.4">subscript</csymbol><ci id="S2.E2.m1.7.7.1.1.4.2.cmml" xref="S2.E2.m1.7.7.1.1.4.2">𝑠</ci><list id="S2.E2.m1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.4"><ci id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1">𝑥</ci><ci id="S2.E2.m1.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2">𝑦</ci></list></apply><list id="S2.E2.m1.7.7.1.1.2.3.cmml" xref="S2.E2.m1.7.7.1.1.2.2"><apply id="S2.E2.m1.7.7.1.1.1.1.1.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1"><times id="S2.E2.m1.7.7.1.1.1.1.1.1.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.1"></times><ci id="S2.E2.m1.7.7.1.1.1.1.1.2.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.2">𝑓</ci><list id="S2.E2.m1.7.7.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.7.7.1.1.1.1.1.3.2"><ci id="S2.E2.m1.3.3.cmml" xref="S2.E2.m1.3.3">𝑥</ci><ci id="S2.E2.m1.4.4.cmml" xref="S2.E2.m1.4.4">Θ</ci></list></apply><apply id="S2.E2.m1.7.7.1.1.2.2.2.cmml" xref="S2.E2.m1.7.7.1.1.2.2.2"><times id="S2.E2.m1.7.7.1.1.2.2.2.1.cmml" xref="S2.E2.m1.7.7.1.1.2.2.2.1"></times><ci id="S2.E2.m1.7.7.1.1.2.2.2.2.cmml" xref="S2.E2.m1.7.7.1.1.2.2.2.2">𝑔</ci><list id="S2.E2.m1.7.7.1.1.2.2.2.3.1.cmml" xref="S2.E2.m1.7.7.1.1.2.2.2.3.2"><ci id="S2.E2.m1.5.5.cmml" xref="S2.E2.m1.5.5">𝑦</ci><ci id="S2.E2.m1.6.6.cmml" xref="S2.E2.m1.6.6">Θ</ci></list></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.7c">\vspace{-2mm}s_{x,y}=\langle f(x;\Theta),g(y;\Theta)\rangle.\vspace{-2mm}</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.7d">italic_s start_POSTSUBSCRIPT italic_x , italic_y end_POSTSUBSCRIPT = ⟨ italic_f ( italic_x ; roman_Θ ) , italic_g ( italic_y ; roman_Θ ) ⟩ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.7"><span class="ltx_text ltx_font_bold" id="S2.p3.7.1">Training </span> For a task-specific loss, <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S2.p3.1.m1.1"><semantics id="S2.p3.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><ci id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.1.m1.1d">caligraphic_L</annotation></semantics></math>, such as cross-entropy, dual-encoder parameters are optimized by gradient descent <cite class="ltx_cite ltx_citemacro_citep">(Rawat et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib30" title="">2019</a>)</cite>. However, exact computation of the normalizing constant, <math alttext="Z_{x}" class="ltx_Math" display="inline" id="S2.p3.2.m2.1"><semantics id="S2.p3.2.m2.1a"><msub id="S2.p3.2.m2.1.1" xref="S2.p3.2.m2.1.1.cmml"><mi id="S2.p3.2.m2.1.1.2" xref="S2.p3.2.m2.1.1.2.cmml">Z</mi><mi id="S2.p3.2.m2.1.1.3" xref="S2.p3.2.m2.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p3.2.m2.1b"><apply id="S2.p3.2.m2.1.1.cmml" xref="S2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p3.2.m2.1.1.1.cmml" xref="S2.p3.2.m2.1.1">subscript</csymbol><ci id="S2.p3.2.m2.1.1.2.cmml" xref="S2.p3.2.m2.1.1.2">𝑍</ci><ci id="S2.p3.2.m2.1.1.3.cmml" xref="S2.p3.2.m2.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.2.m2.1c">Z_{x}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.2.m2.1d">italic_Z start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math>, is typically intractable during training, since it would require computing <math alttext="g(y)" class="ltx_Math" display="inline" id="S2.p3.3.m3.1"><semantics id="S2.p3.3.m3.1a"><mrow id="S2.p3.3.m3.1.2" xref="S2.p3.3.m3.1.2.cmml"><mi id="S2.p3.3.m3.1.2.2" xref="S2.p3.3.m3.1.2.2.cmml">g</mi><mo id="S2.p3.3.m3.1.2.1" xref="S2.p3.3.m3.1.2.1.cmml">⁢</mo><mrow id="S2.p3.3.m3.1.2.3.2" xref="S2.p3.3.m3.1.2.cmml"><mo id="S2.p3.3.m3.1.2.3.2.1" stretchy="false" xref="S2.p3.3.m3.1.2.cmml">(</mo><mi id="S2.p3.3.m3.1.1" xref="S2.p3.3.m3.1.1.cmml">y</mi><mo id="S2.p3.3.m3.1.2.3.2.2" stretchy="false" xref="S2.p3.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.3.m3.1b"><apply id="S2.p3.3.m3.1.2.cmml" xref="S2.p3.3.m3.1.2"><times id="S2.p3.3.m3.1.2.1.cmml" xref="S2.p3.3.m3.1.2.1"></times><ci id="S2.p3.3.m3.1.2.2.cmml" xref="S2.p3.3.m3.1.2.2">𝑔</ci><ci id="S2.p3.3.m3.1.1.cmml" xref="S2.p3.3.m3.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.3.m3.1c">g(y)</annotation><annotation encoding="application/x-llamapun" id="S2.p3.3.m3.1d">italic_g ( italic_y )</annotation></semantics></math> for millions or billions of targets. Instead of <math alttext="P(y|x)" class="ltx_Math" display="inline" id="S2.p3.4.m4.1"><semantics id="S2.p3.4.m4.1a"><mrow id="S2.p3.4.m4.1.1" xref="S2.p3.4.m4.1.1.cmml"><mi id="S2.p3.4.m4.1.1.3" xref="S2.p3.4.m4.1.1.3.cmml">P</mi><mo id="S2.p3.4.m4.1.1.2" xref="S2.p3.4.m4.1.1.2.cmml">⁢</mo><mrow id="S2.p3.4.m4.1.1.1.1" xref="S2.p3.4.m4.1.1.1.1.1.cmml"><mo id="S2.p3.4.m4.1.1.1.1.2" stretchy="false" xref="S2.p3.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S2.p3.4.m4.1.1.1.1.1" xref="S2.p3.4.m4.1.1.1.1.1.cmml"><mi id="S2.p3.4.m4.1.1.1.1.1.2" xref="S2.p3.4.m4.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S2.p3.4.m4.1.1.1.1.1.1" xref="S2.p3.4.m4.1.1.1.1.1.1.cmml">|</mo><mi id="S2.p3.4.m4.1.1.1.1.1.3" xref="S2.p3.4.m4.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.p3.4.m4.1.1.1.1.3" stretchy="false" xref="S2.p3.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.4.m4.1b"><apply id="S2.p3.4.m4.1.1.cmml" xref="S2.p3.4.m4.1.1"><times id="S2.p3.4.m4.1.1.2.cmml" xref="S2.p3.4.m4.1.1.2"></times><ci id="S2.p3.4.m4.1.1.3.cmml" xref="S2.p3.4.m4.1.1.3">𝑃</ci><apply id="S2.p3.4.m4.1.1.1.1.1.cmml" xref="S2.p3.4.m4.1.1.1.1"><csymbol cd="latexml" id="S2.p3.4.m4.1.1.1.1.1.1.cmml" xref="S2.p3.4.m4.1.1.1.1.1.1">conditional</csymbol><ci id="S2.p3.4.m4.1.1.1.1.1.2.cmml" xref="S2.p3.4.m4.1.1.1.1.1.2">𝑦</ci><ci id="S2.p3.4.m4.1.1.1.1.1.3.cmml" xref="S2.p3.4.m4.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.4.m4.1c">P(y|x)</annotation><annotation encoding="application/x-llamapun" id="S2.p3.4.m4.1d">italic_P ( italic_y | italic_x )</annotation></semantics></math> in <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S2.p3.5.m5.1"><semantics id="S2.p3.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p3.5.m5.1.1" xref="S2.p3.5.m5.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S2.p3.5.m5.1b"><ci id="S2.p3.5.m5.1.1.cmml" xref="S2.p3.5.m5.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.5.m5.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.5.m5.1d">caligraphic_L</annotation></semantics></math>, a tractable (yet biased) approximation is to optimize the <em class="ltx_emph ltx_font_italic" id="S2.p3.7.2">truncated</em> softmax, <math alttext="\tilde{P}(y|x)" class="ltx_Math" display="inline" id="S2.p3.6.m6.1"><semantics id="S2.p3.6.m6.1a"><mrow id="S2.p3.6.m6.1.1" xref="S2.p3.6.m6.1.1.cmml"><mover accent="true" id="S2.p3.6.m6.1.1.3" xref="S2.p3.6.m6.1.1.3.cmml"><mi id="S2.p3.6.m6.1.1.3.2" xref="S2.p3.6.m6.1.1.3.2.cmml">P</mi><mo id="S2.p3.6.m6.1.1.3.1" xref="S2.p3.6.m6.1.1.3.1.cmml">~</mo></mover><mo id="S2.p3.6.m6.1.1.2" xref="S2.p3.6.m6.1.1.2.cmml">⁢</mo><mrow id="S2.p3.6.m6.1.1.1.1" xref="S2.p3.6.m6.1.1.1.1.1.cmml"><mo id="S2.p3.6.m6.1.1.1.1.2" stretchy="false" xref="S2.p3.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S2.p3.6.m6.1.1.1.1.1" xref="S2.p3.6.m6.1.1.1.1.1.cmml"><mi id="S2.p3.6.m6.1.1.1.1.1.2" xref="S2.p3.6.m6.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S2.p3.6.m6.1.1.1.1.1.1" xref="S2.p3.6.m6.1.1.1.1.1.1.cmml">|</mo><mi id="S2.p3.6.m6.1.1.1.1.1.3" xref="S2.p3.6.m6.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.p3.6.m6.1.1.1.1.3" stretchy="false" xref="S2.p3.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.6.m6.1b"><apply id="S2.p3.6.m6.1.1.cmml" xref="S2.p3.6.m6.1.1"><times id="S2.p3.6.m6.1.1.2.cmml" xref="S2.p3.6.m6.1.1.2"></times><apply id="S2.p3.6.m6.1.1.3.cmml" xref="S2.p3.6.m6.1.1.3"><ci id="S2.p3.6.m6.1.1.3.1.cmml" xref="S2.p3.6.m6.1.1.3.1">~</ci><ci id="S2.p3.6.m6.1.1.3.2.cmml" xref="S2.p3.6.m6.1.1.3.2">𝑃</ci></apply><apply id="S2.p3.6.m6.1.1.1.1.1.cmml" xref="S2.p3.6.m6.1.1.1.1"><csymbol cd="latexml" id="S2.p3.6.m6.1.1.1.1.1.1.cmml" xref="S2.p3.6.m6.1.1.1.1.1.1">conditional</csymbol><ci id="S2.p3.6.m6.1.1.1.1.1.2.cmml" xref="S2.p3.6.m6.1.1.1.1.1.2">𝑦</ci><ci id="S2.p3.6.m6.1.1.1.1.1.3.cmml" xref="S2.p3.6.m6.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.6.m6.1c">\tilde{P}(y|x)</annotation><annotation encoding="application/x-llamapun" id="S2.p3.6.m6.1d">over~ start_ARG italic_P end_ARG ( italic_y | italic_x )</annotation></semantics></math>, including only a subset of targets <math alttext="S(\mathcal{Y})\subset\mathcal{Y}" class="ltx_Math" display="inline" id="S2.p3.7.m7.1"><semantics id="S2.p3.7.m7.1a"><mrow id="S2.p3.7.m7.1.2" xref="S2.p3.7.m7.1.2.cmml"><mrow id="S2.p3.7.m7.1.2.2" xref="S2.p3.7.m7.1.2.2.cmml"><mi id="S2.p3.7.m7.1.2.2.2" xref="S2.p3.7.m7.1.2.2.2.cmml">S</mi><mo id="S2.p3.7.m7.1.2.2.1" xref="S2.p3.7.m7.1.2.2.1.cmml">⁢</mo><mrow id="S2.p3.7.m7.1.2.2.3.2" xref="S2.p3.7.m7.1.2.2.cmml"><mo id="S2.p3.7.m7.1.2.2.3.2.1" stretchy="false" xref="S2.p3.7.m7.1.2.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.p3.7.m7.1.1" xref="S2.p3.7.m7.1.1.cmml">𝒴</mi><mo id="S2.p3.7.m7.1.2.2.3.2.2" stretchy="false" xref="S2.p3.7.m7.1.2.2.cmml">)</mo></mrow></mrow><mo id="S2.p3.7.m7.1.2.1" xref="S2.p3.7.m7.1.2.1.cmml">⊂</mo><mi class="ltx_font_mathcaligraphic" id="S2.p3.7.m7.1.2.3" xref="S2.p3.7.m7.1.2.3.cmml">𝒴</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.7.m7.1b"><apply id="S2.p3.7.m7.1.2.cmml" xref="S2.p3.7.m7.1.2"><subset id="S2.p3.7.m7.1.2.1.cmml" xref="S2.p3.7.m7.1.2.1"></subset><apply id="S2.p3.7.m7.1.2.2.cmml" xref="S2.p3.7.m7.1.2.2"><times id="S2.p3.7.m7.1.2.2.1.cmml" xref="S2.p3.7.m7.1.2.2.1"></times><ci id="S2.p3.7.m7.1.2.2.2.cmml" xref="S2.p3.7.m7.1.2.2.2">𝑆</ci><ci id="S2.p3.7.m7.1.1.cmml" xref="S2.p3.7.m7.1.1">𝒴</ci></apply><ci id="S2.p3.7.m7.1.2.3.cmml" xref="S2.p3.7.m7.1.2.3">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.7.m7.1c">S(\mathcal{Y})\subset\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.7.m7.1d">italic_S ( caligraphic_Y ) ⊂ caligraphic_Y</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\tilde{P}(y|x)=\frac{\exp(\beta s_{x,y})}{\sum_{y^{\prime}\in S(\mathcal{Y})}%
\exp(\beta s_{x,y^{\prime}})}," class="ltx_Math" display="block" id="S2.E3.m1.10"><semantics id="S2.E3.m1.10a"><mrow id="S2.E3.m1.10.10.1" xref="S2.E3.m1.10.10.1.1.cmml"><mrow id="S2.E3.m1.10.10.1.1" xref="S2.E3.m1.10.10.1.1.cmml"><mrow id="S2.E3.m1.10.10.1.1.1" xref="S2.E3.m1.10.10.1.1.1.cmml"><mover accent="true" id="S2.E3.m1.10.10.1.1.1.3" xref="S2.E3.m1.10.10.1.1.1.3.cmml"><mi id="S2.E3.m1.10.10.1.1.1.3.2" xref="S2.E3.m1.10.10.1.1.1.3.2.cmml">P</mi><mo id="S2.E3.m1.10.10.1.1.1.3.1" xref="S2.E3.m1.10.10.1.1.1.3.1.cmml">~</mo></mover><mo id="S2.E3.m1.10.10.1.1.1.2" xref="S2.E3.m1.10.10.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.10.10.1.1.1.1.1" xref="S2.E3.m1.10.10.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.10.10.1.1.1.1.1.2" stretchy="false" xref="S2.E3.m1.10.10.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.10.10.1.1.1.1.1.1" xref="S2.E3.m1.10.10.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.10.10.1.1.1.1.1.1.2" xref="S2.E3.m1.10.10.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S2.E3.m1.10.10.1.1.1.1.1.1.1" xref="S2.E3.m1.10.10.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.E3.m1.10.10.1.1.1.1.1.1.3" xref="S2.E3.m1.10.10.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E3.m1.10.10.1.1.1.1.1.3" stretchy="false" xref="S2.E3.m1.10.10.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.10.10.1.1.2" xref="S2.E3.m1.10.10.1.1.2.cmml">=</mo><mfrac id="S2.E3.m1.9.9" xref="S2.E3.m1.9.9.cmml"><mrow id="S2.E3.m1.4.4.4.4" xref="S2.E3.m1.4.4.4.5.cmml"><mi id="S2.E3.m1.3.3.3.3" xref="S2.E3.m1.3.3.3.3.cmml">exp</mi><mo id="S2.E3.m1.4.4.4.4a" xref="S2.E3.m1.4.4.4.5.cmml">⁡</mo><mrow id="S2.E3.m1.4.4.4.4.1" xref="S2.E3.m1.4.4.4.5.cmml"><mo id="S2.E3.m1.4.4.4.4.1.2" stretchy="false" xref="S2.E3.m1.4.4.4.5.cmml">(</mo><mrow id="S2.E3.m1.4.4.4.4.1.1" xref="S2.E3.m1.4.4.4.4.1.1.cmml"><mi id="S2.E3.m1.4.4.4.4.1.1.2" xref="S2.E3.m1.4.4.4.4.1.1.2.cmml">β</mi><mo id="S2.E3.m1.4.4.4.4.1.1.1" xref="S2.E3.m1.4.4.4.4.1.1.1.cmml">⁢</mo><msub id="S2.E3.m1.4.4.4.4.1.1.3" xref="S2.E3.m1.4.4.4.4.1.1.3.cmml"><mi id="S2.E3.m1.4.4.4.4.1.1.3.2" xref="S2.E3.m1.4.4.4.4.1.1.3.2.cmml">s</mi><mrow id="S2.E3.m1.2.2.2.2.2.4" xref="S2.E3.m1.2.2.2.2.2.3.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.cmml">x</mi><mo id="S2.E3.m1.2.2.2.2.2.4.1" xref="S2.E3.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S2.E3.m1.2.2.2.2.2.2" xref="S2.E3.m1.2.2.2.2.2.2.cmml">y</mi></mrow></msub></mrow><mo id="S2.E3.m1.4.4.4.4.1.3" stretchy="false" xref="S2.E3.m1.4.4.4.5.cmml">)</mo></mrow></mrow><mrow id="S2.E3.m1.9.9.9" xref="S2.E3.m1.9.9.9.cmml"><msub id="S2.E3.m1.9.9.9.6" xref="S2.E3.m1.9.9.9.6.cmml"><mo id="S2.E3.m1.9.9.9.6.2" xref="S2.E3.m1.9.9.9.6.2.cmml">∑</mo><mrow id="S2.E3.m1.5.5.5.1.1" xref="S2.E3.m1.5.5.5.1.1.cmml"><msup id="S2.E3.m1.5.5.5.1.1.3" xref="S2.E3.m1.5.5.5.1.1.3.cmml"><mi id="S2.E3.m1.5.5.5.1.1.3.2" xref="S2.E3.m1.5.5.5.1.1.3.2.cmml">y</mi><mo id="S2.E3.m1.5.5.5.1.1.3.3" xref="S2.E3.m1.5.5.5.1.1.3.3.cmml">′</mo></msup><mo id="S2.E3.m1.5.5.5.1.1.2" xref="S2.E3.m1.5.5.5.1.1.2.cmml">∈</mo><mrow id="S2.E3.m1.5.5.5.1.1.4" xref="S2.E3.m1.5.5.5.1.1.4.cmml"><mi id="S2.E3.m1.5.5.5.1.1.4.2" xref="S2.E3.m1.5.5.5.1.1.4.2.cmml">S</mi><mo id="S2.E3.m1.5.5.5.1.1.4.1" xref="S2.E3.m1.5.5.5.1.1.4.1.cmml">⁢</mo><mrow id="S2.E3.m1.5.5.5.1.1.4.3.2" xref="S2.E3.m1.5.5.5.1.1.4.cmml"><mo id="S2.E3.m1.5.5.5.1.1.4.3.2.1" stretchy="false" xref="S2.E3.m1.5.5.5.1.1.4.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.5.5.5.1.1.1" xref="S2.E3.m1.5.5.5.1.1.1.cmml">𝒴</mi><mo id="S2.E3.m1.5.5.5.1.1.4.3.2.2" stretchy="false" xref="S2.E3.m1.5.5.5.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mrow id="S2.E3.m1.9.9.9.5.1" xref="S2.E3.m1.9.9.9.5.2.cmml"><mi id="S2.E3.m1.8.8.8.4" xref="S2.E3.m1.8.8.8.4.cmml">exp</mi><mo id="S2.E3.m1.9.9.9.5.1a" xref="S2.E3.m1.9.9.9.5.2.cmml">⁡</mo><mrow id="S2.E3.m1.9.9.9.5.1.1" xref="S2.E3.m1.9.9.9.5.2.cmml"><mo id="S2.E3.m1.9.9.9.5.1.1.2" stretchy="false" xref="S2.E3.m1.9.9.9.5.2.cmml">(</mo><mrow id="S2.E3.m1.9.9.9.5.1.1.1" xref="S2.E3.m1.9.9.9.5.1.1.1.cmml"><mi id="S2.E3.m1.9.9.9.5.1.1.1.2" xref="S2.E3.m1.9.9.9.5.1.1.1.2.cmml">β</mi><mo id="S2.E3.m1.9.9.9.5.1.1.1.1" xref="S2.E3.m1.9.9.9.5.1.1.1.1.cmml">⁢</mo><msub id="S2.E3.m1.9.9.9.5.1.1.1.3" xref="S2.E3.m1.9.9.9.5.1.1.1.3.cmml"><mi id="S2.E3.m1.9.9.9.5.1.1.1.3.2" xref="S2.E3.m1.9.9.9.5.1.1.1.3.2.cmml">s</mi><mrow id="S2.E3.m1.7.7.7.3.2.2" xref="S2.E3.m1.7.7.7.3.2.3.cmml"><mi id="S2.E3.m1.6.6.6.2.1.1" xref="S2.E3.m1.6.6.6.2.1.1.cmml">x</mi><mo id="S2.E3.m1.7.7.7.3.2.2.2" xref="S2.E3.m1.7.7.7.3.2.3.cmml">,</mo><msup id="S2.E3.m1.7.7.7.3.2.2.1" xref="S2.E3.m1.7.7.7.3.2.2.1.cmml"><mi id="S2.E3.m1.7.7.7.3.2.2.1.2" xref="S2.E3.m1.7.7.7.3.2.2.1.2.cmml">y</mi><mo id="S2.E3.m1.7.7.7.3.2.2.1.3" xref="S2.E3.m1.7.7.7.3.2.2.1.3.cmml">′</mo></msup></mrow></msub></mrow><mo id="S2.E3.m1.9.9.9.5.1.1.3" stretchy="false" xref="S2.E3.m1.9.9.9.5.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S2.E3.m1.10.10.1.2" xref="S2.E3.m1.10.10.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.10b"><apply id="S2.E3.m1.10.10.1.1.cmml" xref="S2.E3.m1.10.10.1"><eq id="S2.E3.m1.10.10.1.1.2.cmml" xref="S2.E3.m1.10.10.1.1.2"></eq><apply id="S2.E3.m1.10.10.1.1.1.cmml" xref="S2.E3.m1.10.10.1.1.1"><times id="S2.E3.m1.10.10.1.1.1.2.cmml" xref="S2.E3.m1.10.10.1.1.1.2"></times><apply id="S2.E3.m1.10.10.1.1.1.3.cmml" xref="S2.E3.m1.10.10.1.1.1.3"><ci id="S2.E3.m1.10.10.1.1.1.3.1.cmml" xref="S2.E3.m1.10.10.1.1.1.3.1">~</ci><ci id="S2.E3.m1.10.10.1.1.1.3.2.cmml" xref="S2.E3.m1.10.10.1.1.1.3.2">𝑃</ci></apply><apply id="S2.E3.m1.10.10.1.1.1.1.1.1.cmml" xref="S2.E3.m1.10.10.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.10.10.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.10.10.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E3.m1.10.10.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.10.10.1.1.1.1.1.1.2">𝑦</ci><ci id="S2.E3.m1.10.10.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.10.10.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S2.E3.m1.9.9.cmml" xref="S2.E3.m1.9.9"><divide id="S2.E3.m1.9.9.10.cmml" xref="S2.E3.m1.9.9"></divide><apply id="S2.E3.m1.4.4.4.5.cmml" xref="S2.E3.m1.4.4.4.4"><exp id="S2.E3.m1.3.3.3.3.cmml" xref="S2.E3.m1.3.3.3.3"></exp><apply id="S2.E3.m1.4.4.4.4.1.1.cmml" xref="S2.E3.m1.4.4.4.4.1.1"><times id="S2.E3.m1.4.4.4.4.1.1.1.cmml" xref="S2.E3.m1.4.4.4.4.1.1.1"></times><ci id="S2.E3.m1.4.4.4.4.1.1.2.cmml" xref="S2.E3.m1.4.4.4.4.1.1.2">𝛽</ci><apply id="S2.E3.m1.4.4.4.4.1.1.3.cmml" xref="S2.E3.m1.4.4.4.4.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.4.4.1.1.3.1.cmml" xref="S2.E3.m1.4.4.4.4.1.1.3">subscript</csymbol><ci id="S2.E3.m1.4.4.4.4.1.1.3.2.cmml" xref="S2.E3.m1.4.4.4.4.1.1.3.2">𝑠</ci><list id="S2.E3.m1.2.2.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.2.2.4"><ci id="S2.E3.m1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1">𝑥</ci><ci id="S2.E3.m1.2.2.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2.2.2">𝑦</ci></list></apply></apply></apply><apply id="S2.E3.m1.9.9.9.cmml" xref="S2.E3.m1.9.9.9"><apply id="S2.E3.m1.9.9.9.6.cmml" xref="S2.E3.m1.9.9.9.6"><csymbol cd="ambiguous" id="S2.E3.m1.9.9.9.6.1.cmml" xref="S2.E3.m1.9.9.9.6">subscript</csymbol><sum id="S2.E3.m1.9.9.9.6.2.cmml" xref="S2.E3.m1.9.9.9.6.2"></sum><apply id="S2.E3.m1.5.5.5.1.1.cmml" xref="S2.E3.m1.5.5.5.1.1"><in id="S2.E3.m1.5.5.5.1.1.2.cmml" xref="S2.E3.m1.5.5.5.1.1.2"></in><apply id="S2.E3.m1.5.5.5.1.1.3.cmml" xref="S2.E3.m1.5.5.5.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.5.1.1.3.1.cmml" xref="S2.E3.m1.5.5.5.1.1.3">superscript</csymbol><ci id="S2.E3.m1.5.5.5.1.1.3.2.cmml" xref="S2.E3.m1.5.5.5.1.1.3.2">𝑦</ci><ci id="S2.E3.m1.5.5.5.1.1.3.3.cmml" xref="S2.E3.m1.5.5.5.1.1.3.3">′</ci></apply><apply id="S2.E3.m1.5.5.5.1.1.4.cmml" xref="S2.E3.m1.5.5.5.1.1.4"><times id="S2.E3.m1.5.5.5.1.1.4.1.cmml" xref="S2.E3.m1.5.5.5.1.1.4.1"></times><ci id="S2.E3.m1.5.5.5.1.1.4.2.cmml" xref="S2.E3.m1.5.5.5.1.1.4.2">𝑆</ci><ci id="S2.E3.m1.5.5.5.1.1.1.cmml" xref="S2.E3.m1.5.5.5.1.1.1">𝒴</ci></apply></apply></apply><apply id="S2.E3.m1.9.9.9.5.2.cmml" xref="S2.E3.m1.9.9.9.5.1"><exp id="S2.E3.m1.8.8.8.4.cmml" xref="S2.E3.m1.8.8.8.4"></exp><apply id="S2.E3.m1.9.9.9.5.1.1.1.cmml" xref="S2.E3.m1.9.9.9.5.1.1.1"><times id="S2.E3.m1.9.9.9.5.1.1.1.1.cmml" xref="S2.E3.m1.9.9.9.5.1.1.1.1"></times><ci id="S2.E3.m1.9.9.9.5.1.1.1.2.cmml" xref="S2.E3.m1.9.9.9.5.1.1.1.2">𝛽</ci><apply id="S2.E3.m1.9.9.9.5.1.1.1.3.cmml" xref="S2.E3.m1.9.9.9.5.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.9.9.9.5.1.1.1.3.1.cmml" xref="S2.E3.m1.9.9.9.5.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.9.9.9.5.1.1.1.3.2.cmml" xref="S2.E3.m1.9.9.9.5.1.1.1.3.2">𝑠</ci><list id="S2.E3.m1.7.7.7.3.2.3.cmml" xref="S2.E3.m1.7.7.7.3.2.2"><ci id="S2.E3.m1.6.6.6.2.1.1.cmml" xref="S2.E3.m1.6.6.6.2.1.1">𝑥</ci><apply id="S2.E3.m1.7.7.7.3.2.2.1.cmml" xref="S2.E3.m1.7.7.7.3.2.2.1"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.7.3.2.2.1.1.cmml" xref="S2.E3.m1.7.7.7.3.2.2.1">superscript</csymbol><ci id="S2.E3.m1.7.7.7.3.2.2.1.2.cmml" xref="S2.E3.m1.7.7.7.3.2.2.1.2">𝑦</ci><ci id="S2.E3.m1.7.7.7.3.2.2.1.3.cmml" xref="S2.E3.m1.7.7.7.3.2.2.1.3">′</ci></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.10c">\tilde{P}(y|x)=\frac{\exp(\beta s_{x,y})}{\sum_{y^{\prime}\in S(\mathcal{Y})}%
\exp(\beta s_{x,y^{\prime}})},</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.10d">over~ start_ARG italic_P end_ARG ( italic_y | italic_x ) = divide start_ARG roman_exp ( italic_β italic_s start_POSTSUBSCRIPT italic_x , italic_y end_POSTSUBSCRIPT ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ italic_S ( caligraphic_Y ) end_POSTSUBSCRIPT roman_exp ( italic_β italic_s start_POSTSUBSCRIPT italic_x , italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p3.9"><span class="ltx_text ltx_font_bold" id="S2.p3.9.1">Uniform Sampling Approximation </span> A simple approach is to define <math alttext="S(\mathcal{Y})" class="ltx_Math" display="inline" id="S2.p3.8.m1.1"><semantics id="S2.p3.8.m1.1a"><mrow id="S2.p3.8.m1.1.2" xref="S2.p3.8.m1.1.2.cmml"><mi id="S2.p3.8.m1.1.2.2" xref="S2.p3.8.m1.1.2.2.cmml">S</mi><mo id="S2.p3.8.m1.1.2.1" xref="S2.p3.8.m1.1.2.1.cmml">⁢</mo><mrow id="S2.p3.8.m1.1.2.3.2" xref="S2.p3.8.m1.1.2.cmml"><mo id="S2.p3.8.m1.1.2.3.2.1" stretchy="false" xref="S2.p3.8.m1.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.p3.8.m1.1.1" xref="S2.p3.8.m1.1.1.cmml">𝒴</mi><mo id="S2.p3.8.m1.1.2.3.2.2" stretchy="false" xref="S2.p3.8.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.8.m1.1b"><apply id="S2.p3.8.m1.1.2.cmml" xref="S2.p3.8.m1.1.2"><times id="S2.p3.8.m1.1.2.1.cmml" xref="S2.p3.8.m1.1.2.1"></times><ci id="S2.p3.8.m1.1.2.2.cmml" xref="S2.p3.8.m1.1.2.2">𝑆</ci><ci id="S2.p3.8.m1.1.1.cmml" xref="S2.p3.8.m1.1.1">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.8.m1.1c">S(\mathcal{Y})</annotation><annotation encoding="application/x-llamapun" id="S2.p3.8.m1.1d">italic_S ( caligraphic_Y )</annotation></semantics></math> to be a uniformly sampled subset of <math alttext="\mathcal{Y}" class="ltx_Math" display="inline" id="S2.p3.9.m2.1"><semantics id="S2.p3.9.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p3.9.m2.1.1" xref="S2.p3.9.m2.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S2.p3.9.m2.1b"><ci id="S2.p3.9.m2.1.1.cmml" xref="S2.p3.9.m2.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.9.m2.1c">\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.9.m2.1d">caligraphic_Y</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Karpukhin et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib17" title="">2020</a>)</cite>.
The method’s bias decreases with more samples. However, since the samples are uniform, a large number of samples may be required.</p>
</div>
<div class="ltx_para" id="S2.p4">
<p class="ltx_p" id="S2.p4.4"><span class="ltx_text ltx_font_bold" id="S2.p4.4.1">Top-K / Similarity-based Sampling Approximations </span> We can instead use an informed strategy using <math alttext="g(y)" class="ltx_Math" display="inline" id="S2.p4.1.m1.1"><semantics id="S2.p4.1.m1.1a"><mrow id="S2.p4.1.m1.1.2" xref="S2.p4.1.m1.1.2.cmml"><mi id="S2.p4.1.m1.1.2.2" xref="S2.p4.1.m1.1.2.2.cmml">g</mi><mo id="S2.p4.1.m1.1.2.1" xref="S2.p4.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.p4.1.m1.1.2.3.2" xref="S2.p4.1.m1.1.2.cmml"><mo id="S2.p4.1.m1.1.2.3.2.1" stretchy="false" xref="S2.p4.1.m1.1.2.cmml">(</mo><mi id="S2.p4.1.m1.1.1" xref="S2.p4.1.m1.1.1.cmml">y</mi><mo id="S2.p4.1.m1.1.2.3.2.2" stretchy="false" xref="S2.p4.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.1.m1.1b"><apply id="S2.p4.1.m1.1.2.cmml" xref="S2.p4.1.m1.1.2"><times id="S2.p4.1.m1.1.2.1.cmml" xref="S2.p4.1.m1.1.2.1"></times><ci id="S2.p4.1.m1.1.2.2.cmml" xref="S2.p4.1.m1.1.2.2">𝑔</ci><ci id="S2.p4.1.m1.1.1.cmml" xref="S2.p4.1.m1.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.1.m1.1c">g(y)</annotation><annotation encoding="application/x-llamapun" id="S2.p4.1.m1.1d">italic_g ( italic_y )</annotation></semantics></math> that would select higher probability targets by sampling using similarity scores via Gumbel-Max <cite class="ltx_cite ltx_citemacro_citep">(Lindgren et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib20" title="">2021</a>)</cite>, or using the top-k targets in terms of inner product <cite class="ltx_cite ltx_citemacro_citep">(Xiong et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib39" title="">2020</a>)</cite>.
Work has considered efficient approximations to find these top <math alttext="k" class="ltx_Math" display="inline" id="S2.p4.2.m2.1"><semantics id="S2.p4.2.m2.1a"><mi id="S2.p4.2.m2.1.1" xref="S2.p4.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.p4.2.m2.1b"><ci id="S2.p4.2.m2.1.1.cmml" xref="S2.p4.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.p4.2.m2.1d">italic_k</annotation></semantics></math> targets without having to compute <math alttext="g(y)" class="ltx_Math" display="inline" id="S2.p4.3.m3.1"><semantics id="S2.p4.3.m3.1a"><mrow id="S2.p4.3.m3.1.2" xref="S2.p4.3.m3.1.2.cmml"><mi id="S2.p4.3.m3.1.2.2" xref="S2.p4.3.m3.1.2.2.cmml">g</mi><mo id="S2.p4.3.m3.1.2.1" xref="S2.p4.3.m3.1.2.1.cmml">⁢</mo><mrow id="S2.p4.3.m3.1.2.3.2" xref="S2.p4.3.m3.1.2.cmml"><mo id="S2.p4.3.m3.1.2.3.2.1" stretchy="false" xref="S2.p4.3.m3.1.2.cmml">(</mo><mi id="S2.p4.3.m3.1.1" xref="S2.p4.3.m3.1.1.cmml">y</mi><mo id="S2.p4.3.m3.1.2.3.2.2" stretchy="false" xref="S2.p4.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.3.m3.1b"><apply id="S2.p4.3.m3.1.2.cmml" xref="S2.p4.3.m3.1.2"><times id="S2.p4.3.m3.1.2.1.cmml" xref="S2.p4.3.m3.1.2.1"></times><ci id="S2.p4.3.m3.1.2.2.cmml" xref="S2.p4.3.m3.1.2.2">𝑔</ci><ci id="S2.p4.3.m3.1.1.cmml" xref="S2.p4.3.m3.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.3.m3.1c">g(y)</annotation><annotation encoding="application/x-llamapun" id="S2.p4.3.m3.1d">italic_g ( italic_y )</annotation></semantics></math> for all <math alttext="y\in\mathcal{Y}" class="ltx_Math" display="inline" id="S2.p4.4.m4.1"><semantics id="S2.p4.4.m4.1a"><mrow id="S2.p4.4.m4.1.1" xref="S2.p4.4.m4.1.1.cmml"><mi id="S2.p4.4.m4.1.1.2" xref="S2.p4.4.m4.1.1.2.cmml">y</mi><mo id="S2.p4.4.m4.1.1.1" xref="S2.p4.4.m4.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.p4.4.m4.1.1.3" xref="S2.p4.4.m4.1.1.3.cmml">𝒴</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.4.m4.1b"><apply id="S2.p4.4.m4.1.1.cmml" xref="S2.p4.4.m4.1.1"><in id="S2.p4.4.m4.1.1.1.cmml" xref="S2.p4.4.m4.1.1.1"></in><ci id="S2.p4.4.m4.1.1.2.cmml" xref="S2.p4.4.m4.1.1.2">𝑦</ci><ci id="S2.p4.4.m4.1.1.3.cmml" xref="S2.p4.4.m4.1.1.3">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.4.m4.1c">y\in\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.4.m4.1d">italic_y ∈ caligraphic_Y</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Xiong et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib39" title="">2020</a>; Monath et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib24" title="">2023</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S2.p5">
<p class="ltx_p" id="S2.p5.1"><span class="ltx_text ltx_font_bold" id="S2.p5.1.1">Initialization </span> We initialize the parameters of the dual encoders, <math alttext="\Theta" class="ltx_Math" display="inline" id="S2.p5.1.m1.1"><semantics id="S2.p5.1.m1.1a"><mi id="S2.p5.1.m1.1.1" mathvariant="normal" xref="S2.p5.1.m1.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="S2.p5.1.m1.1b"><ci id="S2.p5.1.m1.1.1.cmml" xref="S2.p5.1.m1.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.1.m1.1c">\Theta</annotation><annotation encoding="application/x-llamapun" id="S2.p5.1.m1.1d">roman_Θ</annotation></semantics></math>, using pre-trained models, such as pre-trained language models, T5 and GTR <cite class="ltx_cite ltx_citemacro_citep">(Devlin et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib4" title="">2019</a>; Raffel et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib29" title="">2020</a>; Ni et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib27" title="">2022</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S2.p6">
<p class="ltx_p" id="S2.p6.15"><span class="ltx_text ltx_font_bold" id="S2.p6.15.1">Stale Cached Representations </span>
When we are training the parameters, <math alttext="\Theta" class="ltx_Math" display="inline" id="S2.p6.1.m1.1"><semantics id="S2.p6.1.m1.1a"><mi id="S2.p6.1.m1.1.1" mathvariant="normal" xref="S2.p6.1.m1.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="S2.p6.1.m1.1b"><ci id="S2.p6.1.m1.1.1.cmml" xref="S2.p6.1.m1.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.1.m1.1c">\Theta</annotation><annotation encoding="application/x-llamapun" id="S2.p6.1.m1.1d">roman_Θ</annotation></semantics></math>, each target’s vector according to <math alttext="g(y;\Theta)" class="ltx_Math" display="inline" id="S2.p6.2.m2.2"><semantics id="S2.p6.2.m2.2a"><mrow id="S2.p6.2.m2.2.3" xref="S2.p6.2.m2.2.3.cmml"><mi id="S2.p6.2.m2.2.3.2" xref="S2.p6.2.m2.2.3.2.cmml">g</mi><mo id="S2.p6.2.m2.2.3.1" xref="S2.p6.2.m2.2.3.1.cmml">⁢</mo><mrow id="S2.p6.2.m2.2.3.3.2" xref="S2.p6.2.m2.2.3.3.1.cmml"><mo id="S2.p6.2.m2.2.3.3.2.1" stretchy="false" xref="S2.p6.2.m2.2.3.3.1.cmml">(</mo><mi id="S2.p6.2.m2.1.1" xref="S2.p6.2.m2.1.1.cmml">y</mi><mo id="S2.p6.2.m2.2.3.3.2.2" xref="S2.p6.2.m2.2.3.3.1.cmml">;</mo><mi id="S2.p6.2.m2.2.2" mathvariant="normal" xref="S2.p6.2.m2.2.2.cmml">Θ</mi><mo id="S2.p6.2.m2.2.3.3.2.3" stretchy="false" xref="S2.p6.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p6.2.m2.2b"><apply id="S2.p6.2.m2.2.3.cmml" xref="S2.p6.2.m2.2.3"><times id="S2.p6.2.m2.2.3.1.cmml" xref="S2.p6.2.m2.2.3.1"></times><ci id="S2.p6.2.m2.2.3.2.cmml" xref="S2.p6.2.m2.2.3.2">𝑔</ci><list id="S2.p6.2.m2.2.3.3.1.cmml" xref="S2.p6.2.m2.2.3.3.2"><ci id="S2.p6.2.m2.1.1.cmml" xref="S2.p6.2.m2.1.1">𝑦</ci><ci id="S2.p6.2.m2.2.2.cmml" xref="S2.p6.2.m2.2.2">Θ</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.2.m2.2c">g(y;\Theta)</annotation><annotation encoding="application/x-llamapun" id="S2.p6.2.m2.2d">italic_g ( italic_y ; roman_Θ )</annotation></semantics></math> changes at each step of training. Therefore, a commonly used approach is to define an approximation, <math alttext="g^{\prime}(y)" class="ltx_Math" display="inline" id="S2.p6.3.m3.1"><semantics id="S2.p6.3.m3.1a"><mrow id="S2.p6.3.m3.1.2" xref="S2.p6.3.m3.1.2.cmml"><msup id="S2.p6.3.m3.1.2.2" xref="S2.p6.3.m3.1.2.2.cmml"><mi id="S2.p6.3.m3.1.2.2.2" xref="S2.p6.3.m3.1.2.2.2.cmml">g</mi><mo id="S2.p6.3.m3.1.2.2.3" xref="S2.p6.3.m3.1.2.2.3.cmml">′</mo></msup><mo id="S2.p6.3.m3.1.2.1" xref="S2.p6.3.m3.1.2.1.cmml">⁢</mo><mrow id="S2.p6.3.m3.1.2.3.2" xref="S2.p6.3.m3.1.2.cmml"><mo id="S2.p6.3.m3.1.2.3.2.1" stretchy="false" xref="S2.p6.3.m3.1.2.cmml">(</mo><mi id="S2.p6.3.m3.1.1" xref="S2.p6.3.m3.1.1.cmml">y</mi><mo id="S2.p6.3.m3.1.2.3.2.2" stretchy="false" xref="S2.p6.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p6.3.m3.1b"><apply id="S2.p6.3.m3.1.2.cmml" xref="S2.p6.3.m3.1.2"><times id="S2.p6.3.m3.1.2.1.cmml" xref="S2.p6.3.m3.1.2.1"></times><apply id="S2.p6.3.m3.1.2.2.cmml" xref="S2.p6.3.m3.1.2.2"><csymbol cd="ambiguous" id="S2.p6.3.m3.1.2.2.1.cmml" xref="S2.p6.3.m3.1.2.2">superscript</csymbol><ci id="S2.p6.3.m3.1.2.2.2.cmml" xref="S2.p6.3.m3.1.2.2.2">𝑔</ci><ci id="S2.p6.3.m3.1.2.2.3.cmml" xref="S2.p6.3.m3.1.2.2.3">′</ci></apply><ci id="S2.p6.3.m3.1.1.cmml" xref="S2.p6.3.m3.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.3.m3.1c">g^{\prime}(y)</annotation><annotation encoding="application/x-llamapun" id="S2.p6.3.m3.1d">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y )</annotation></semantics></math>, that is a lookup for a “stale” cached embedding for the given target. The stale embedding comes from running the target encoder at a particular time step <math alttext="t" class="ltx_Math" display="inline" id="S2.p6.4.m4.1"><semantics id="S2.p6.4.m4.1a"><mi id="S2.p6.4.m4.1.1" xref="S2.p6.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.p6.4.m4.1b"><ci id="S2.p6.4.m4.1.1.cmml" xref="S2.p6.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.4.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.p6.4.m4.1d">italic_t</annotation></semantics></math>, of training, and caching the result, i.e., <math alttext="g(y,\Theta_{t})" class="ltx_Math" display="inline" id="S2.p6.5.m5.2"><semantics id="S2.p6.5.m5.2a"><mrow id="S2.p6.5.m5.2.2" xref="S2.p6.5.m5.2.2.cmml"><mi id="S2.p6.5.m5.2.2.3" xref="S2.p6.5.m5.2.2.3.cmml">g</mi><mo id="S2.p6.5.m5.2.2.2" xref="S2.p6.5.m5.2.2.2.cmml">⁢</mo><mrow id="S2.p6.5.m5.2.2.1.1" xref="S2.p6.5.m5.2.2.1.2.cmml"><mo id="S2.p6.5.m5.2.2.1.1.2" stretchy="false" xref="S2.p6.5.m5.2.2.1.2.cmml">(</mo><mi id="S2.p6.5.m5.1.1" xref="S2.p6.5.m5.1.1.cmml">y</mi><mo id="S2.p6.5.m5.2.2.1.1.3" xref="S2.p6.5.m5.2.2.1.2.cmml">,</mo><msub id="S2.p6.5.m5.2.2.1.1.1" xref="S2.p6.5.m5.2.2.1.1.1.cmml"><mi id="S2.p6.5.m5.2.2.1.1.1.2" mathvariant="normal" xref="S2.p6.5.m5.2.2.1.1.1.2.cmml">Θ</mi><mi id="S2.p6.5.m5.2.2.1.1.1.3" xref="S2.p6.5.m5.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S2.p6.5.m5.2.2.1.1.4" stretchy="false" xref="S2.p6.5.m5.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p6.5.m5.2b"><apply id="S2.p6.5.m5.2.2.cmml" xref="S2.p6.5.m5.2.2"><times id="S2.p6.5.m5.2.2.2.cmml" xref="S2.p6.5.m5.2.2.2"></times><ci id="S2.p6.5.m5.2.2.3.cmml" xref="S2.p6.5.m5.2.2.3">𝑔</ci><interval closure="open" id="S2.p6.5.m5.2.2.1.2.cmml" xref="S2.p6.5.m5.2.2.1.1"><ci id="S2.p6.5.m5.1.1.cmml" xref="S2.p6.5.m5.1.1">𝑦</ci><apply id="S2.p6.5.m5.2.2.1.1.1.cmml" xref="S2.p6.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.p6.5.m5.2.2.1.1.1.1.cmml" xref="S2.p6.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S2.p6.5.m5.2.2.1.1.1.2.cmml" xref="S2.p6.5.m5.2.2.1.1.1.2">Θ</ci><ci id="S2.p6.5.m5.2.2.1.1.1.3.cmml" xref="S2.p6.5.m5.2.2.1.1.1.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.5.m5.2c">g(y,\Theta_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.p6.5.m5.2d">italic_g ( italic_y , roman_Θ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> in a buffer, <math alttext="B\in\mathcal{R}^{|\mathcal{Y}|\times D}" class="ltx_Math" display="inline" id="S2.p6.6.m6.1"><semantics id="S2.p6.6.m6.1a"><mrow id="S2.p6.6.m6.1.2" xref="S2.p6.6.m6.1.2.cmml"><mi id="S2.p6.6.m6.1.2.2" xref="S2.p6.6.m6.1.2.2.cmml">B</mi><mo id="S2.p6.6.m6.1.2.1" xref="S2.p6.6.m6.1.2.1.cmml">∈</mo><msup id="S2.p6.6.m6.1.2.3" xref="S2.p6.6.m6.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p6.6.m6.1.2.3.2" xref="S2.p6.6.m6.1.2.3.2.cmml">ℛ</mi><mrow id="S2.p6.6.m6.1.1.1" xref="S2.p6.6.m6.1.1.1.cmml"><mrow id="S2.p6.6.m6.1.1.1.3.2" xref="S2.p6.6.m6.1.1.1.3.1.cmml"><mo id="S2.p6.6.m6.1.1.1.3.2.1" stretchy="false" xref="S2.p6.6.m6.1.1.1.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.p6.6.m6.1.1.1.1" xref="S2.p6.6.m6.1.1.1.1.cmml">𝒴</mi><mo id="S2.p6.6.m6.1.1.1.3.2.2" rspace="0.055em" stretchy="false" xref="S2.p6.6.m6.1.1.1.3.1.1.cmml">|</mo></mrow><mo id="S2.p6.6.m6.1.1.1.2" rspace="0.222em" xref="S2.p6.6.m6.1.1.1.2.cmml">×</mo><mi id="S2.p6.6.m6.1.1.1.4" xref="S2.p6.6.m6.1.1.1.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p6.6.m6.1b"><apply id="S2.p6.6.m6.1.2.cmml" xref="S2.p6.6.m6.1.2"><in id="S2.p6.6.m6.1.2.1.cmml" xref="S2.p6.6.m6.1.2.1"></in><ci id="S2.p6.6.m6.1.2.2.cmml" xref="S2.p6.6.m6.1.2.2">𝐵</ci><apply id="S2.p6.6.m6.1.2.3.cmml" xref="S2.p6.6.m6.1.2.3"><csymbol cd="ambiguous" id="S2.p6.6.m6.1.2.3.1.cmml" xref="S2.p6.6.m6.1.2.3">superscript</csymbol><ci id="S2.p6.6.m6.1.2.3.2.cmml" xref="S2.p6.6.m6.1.2.3.2">ℛ</ci><apply id="S2.p6.6.m6.1.1.1.cmml" xref="S2.p6.6.m6.1.1.1"><times id="S2.p6.6.m6.1.1.1.2.cmml" xref="S2.p6.6.m6.1.1.1.2"></times><apply id="S2.p6.6.m6.1.1.1.3.1.cmml" xref="S2.p6.6.m6.1.1.1.3.2"><abs id="S2.p6.6.m6.1.1.1.3.1.1.cmml" xref="S2.p6.6.m6.1.1.1.3.2.1"></abs><ci id="S2.p6.6.m6.1.1.1.1.cmml" xref="S2.p6.6.m6.1.1.1.1">𝒴</ci></apply><ci id="S2.p6.6.m6.1.1.1.4.cmml" xref="S2.p6.6.m6.1.1.1.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.6.m6.1c">B\in\mathcal{R}^{|\mathcal{Y}|\times D}</annotation><annotation encoding="application/x-llamapun" id="S2.p6.6.m6.1d">italic_B ∈ caligraphic_R start_POSTSUPERSCRIPT | caligraphic_Y | × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>, i.e. <math alttext="g^{\prime}(y_{i})\triangleq B_{y_{i}}" class="ltx_Math" display="inline" id="S2.p6.7.m7.1"><semantics id="S2.p6.7.m7.1a"><mrow id="S2.p6.7.m7.1.1" xref="S2.p6.7.m7.1.1.cmml"><mrow id="S2.p6.7.m7.1.1.1" xref="S2.p6.7.m7.1.1.1.cmml"><msup id="S2.p6.7.m7.1.1.1.3" xref="S2.p6.7.m7.1.1.1.3.cmml"><mi id="S2.p6.7.m7.1.1.1.3.2" xref="S2.p6.7.m7.1.1.1.3.2.cmml">g</mi><mo id="S2.p6.7.m7.1.1.1.3.3" xref="S2.p6.7.m7.1.1.1.3.3.cmml">′</mo></msup><mo id="S2.p6.7.m7.1.1.1.2" xref="S2.p6.7.m7.1.1.1.2.cmml">⁢</mo><mrow id="S2.p6.7.m7.1.1.1.1.1" xref="S2.p6.7.m7.1.1.1.1.1.1.cmml"><mo id="S2.p6.7.m7.1.1.1.1.1.2" stretchy="false" xref="S2.p6.7.m7.1.1.1.1.1.1.cmml">(</mo><msub id="S2.p6.7.m7.1.1.1.1.1.1" xref="S2.p6.7.m7.1.1.1.1.1.1.cmml"><mi id="S2.p6.7.m7.1.1.1.1.1.1.2" xref="S2.p6.7.m7.1.1.1.1.1.1.2.cmml">y</mi><mi id="S2.p6.7.m7.1.1.1.1.1.1.3" xref="S2.p6.7.m7.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.p6.7.m7.1.1.1.1.1.3" stretchy="false" xref="S2.p6.7.m7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.p6.7.m7.1.1.2" xref="S2.p6.7.m7.1.1.2.cmml">≜</mo><msub id="S2.p6.7.m7.1.1.3" xref="S2.p6.7.m7.1.1.3.cmml"><mi id="S2.p6.7.m7.1.1.3.2" xref="S2.p6.7.m7.1.1.3.2.cmml">B</mi><msub id="S2.p6.7.m7.1.1.3.3" xref="S2.p6.7.m7.1.1.3.3.cmml"><mi id="S2.p6.7.m7.1.1.3.3.2" xref="S2.p6.7.m7.1.1.3.3.2.cmml">y</mi><mi id="S2.p6.7.m7.1.1.3.3.3" xref="S2.p6.7.m7.1.1.3.3.3.cmml">i</mi></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.p6.7.m7.1b"><apply id="S2.p6.7.m7.1.1.cmml" xref="S2.p6.7.m7.1.1"><ci id="S2.p6.7.m7.1.1.2.cmml" xref="S2.p6.7.m7.1.1.2">≜</ci><apply id="S2.p6.7.m7.1.1.1.cmml" xref="S2.p6.7.m7.1.1.1"><times id="S2.p6.7.m7.1.1.1.2.cmml" xref="S2.p6.7.m7.1.1.1.2"></times><apply id="S2.p6.7.m7.1.1.1.3.cmml" xref="S2.p6.7.m7.1.1.1.3"><csymbol cd="ambiguous" id="S2.p6.7.m7.1.1.1.3.1.cmml" xref="S2.p6.7.m7.1.1.1.3">superscript</csymbol><ci id="S2.p6.7.m7.1.1.1.3.2.cmml" xref="S2.p6.7.m7.1.1.1.3.2">𝑔</ci><ci id="S2.p6.7.m7.1.1.1.3.3.cmml" xref="S2.p6.7.m7.1.1.1.3.3">′</ci></apply><apply id="S2.p6.7.m7.1.1.1.1.1.1.cmml" xref="S2.p6.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p6.7.m7.1.1.1.1.1.1.1.cmml" xref="S2.p6.7.m7.1.1.1.1.1">subscript</csymbol><ci id="S2.p6.7.m7.1.1.1.1.1.1.2.cmml" xref="S2.p6.7.m7.1.1.1.1.1.1.2">𝑦</ci><ci id="S2.p6.7.m7.1.1.1.1.1.1.3.cmml" xref="S2.p6.7.m7.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S2.p6.7.m7.1.1.3.cmml" xref="S2.p6.7.m7.1.1.3"><csymbol cd="ambiguous" id="S2.p6.7.m7.1.1.3.1.cmml" xref="S2.p6.7.m7.1.1.3">subscript</csymbol><ci id="S2.p6.7.m7.1.1.3.2.cmml" xref="S2.p6.7.m7.1.1.3.2">𝐵</ci><apply id="S2.p6.7.m7.1.1.3.3.cmml" xref="S2.p6.7.m7.1.1.3.3"><csymbol cd="ambiguous" id="S2.p6.7.m7.1.1.3.3.1.cmml" xref="S2.p6.7.m7.1.1.3.3">subscript</csymbol><ci id="S2.p6.7.m7.1.1.3.3.2.cmml" xref="S2.p6.7.m7.1.1.3.3.2">𝑦</ci><ci id="S2.p6.7.m7.1.1.3.3.3.cmml" xref="S2.p6.7.m7.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.7.m7.1c">g^{\prime}(y_{i})\triangleq B_{y_{i}}</annotation><annotation encoding="application/x-llamapun" id="S2.p6.7.m7.1d">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ≜ italic_B start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>.
To find the top-<math alttext="k" class="ltx_Math" display="inline" id="S2.p6.8.m8.1"><semantics id="S2.p6.8.m8.1a"><mi id="S2.p6.8.m8.1.1" xref="S2.p6.8.m8.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.p6.8.m8.1b"><ci id="S2.p6.8.m8.1.1.cmml" xref="S2.p6.8.m8.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.8.m8.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.p6.8.m8.1d">italic_k</annotation></semantics></math> targets for input <math alttext="x" class="ltx_Math" display="inline" id="S2.p6.9.m9.1"><semantics id="S2.p6.9.m9.1a"><mi id="S2.p6.9.m9.1.1" xref="S2.p6.9.m9.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.p6.9.m9.1b"><ci id="S2.p6.9.m9.1.1.cmml" xref="S2.p6.9.m9.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.9.m9.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.p6.9.m9.1d">italic_x</annotation></semantics></math> we compute approximate logits <math alttext="B^{T}f(x)\in\mathcal{R}^{|\mathcal{Y}|}" class="ltx_Math" display="inline" id="S2.p6.10.m10.2"><semantics id="S2.p6.10.m10.2a"><mrow id="S2.p6.10.m10.2.3" xref="S2.p6.10.m10.2.3.cmml"><mrow id="S2.p6.10.m10.2.3.2" xref="S2.p6.10.m10.2.3.2.cmml"><msup id="S2.p6.10.m10.2.3.2.2" xref="S2.p6.10.m10.2.3.2.2.cmml"><mi id="S2.p6.10.m10.2.3.2.2.2" xref="S2.p6.10.m10.2.3.2.2.2.cmml">B</mi><mi id="S2.p6.10.m10.2.3.2.2.3" xref="S2.p6.10.m10.2.3.2.2.3.cmml">T</mi></msup><mo id="S2.p6.10.m10.2.3.2.1" xref="S2.p6.10.m10.2.3.2.1.cmml">⁢</mo><mi id="S2.p6.10.m10.2.3.2.3" xref="S2.p6.10.m10.2.3.2.3.cmml">f</mi><mo id="S2.p6.10.m10.2.3.2.1a" xref="S2.p6.10.m10.2.3.2.1.cmml">⁢</mo><mrow id="S2.p6.10.m10.2.3.2.4.2" xref="S2.p6.10.m10.2.3.2.cmml"><mo id="S2.p6.10.m10.2.3.2.4.2.1" stretchy="false" xref="S2.p6.10.m10.2.3.2.cmml">(</mo><mi id="S2.p6.10.m10.2.2" xref="S2.p6.10.m10.2.2.cmml">x</mi><mo id="S2.p6.10.m10.2.3.2.4.2.2" stretchy="false" xref="S2.p6.10.m10.2.3.2.cmml">)</mo></mrow></mrow><mo id="S2.p6.10.m10.2.3.1" xref="S2.p6.10.m10.2.3.1.cmml">∈</mo><msup id="S2.p6.10.m10.2.3.3" xref="S2.p6.10.m10.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p6.10.m10.2.3.3.2" xref="S2.p6.10.m10.2.3.3.2.cmml">ℛ</mi><mrow id="S2.p6.10.m10.1.1.1.3" xref="S2.p6.10.m10.1.1.1.2.cmml"><mo id="S2.p6.10.m10.1.1.1.3.1" stretchy="false" xref="S2.p6.10.m10.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.p6.10.m10.1.1.1.1" xref="S2.p6.10.m10.1.1.1.1.cmml">𝒴</mi><mo id="S2.p6.10.m10.1.1.1.3.2" stretchy="false" xref="S2.p6.10.m10.1.1.1.2.1.cmml">|</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p6.10.m10.2b"><apply id="S2.p6.10.m10.2.3.cmml" xref="S2.p6.10.m10.2.3"><in id="S2.p6.10.m10.2.3.1.cmml" xref="S2.p6.10.m10.2.3.1"></in><apply id="S2.p6.10.m10.2.3.2.cmml" xref="S2.p6.10.m10.2.3.2"><times id="S2.p6.10.m10.2.3.2.1.cmml" xref="S2.p6.10.m10.2.3.2.1"></times><apply id="S2.p6.10.m10.2.3.2.2.cmml" xref="S2.p6.10.m10.2.3.2.2"><csymbol cd="ambiguous" id="S2.p6.10.m10.2.3.2.2.1.cmml" xref="S2.p6.10.m10.2.3.2.2">superscript</csymbol><ci id="S2.p6.10.m10.2.3.2.2.2.cmml" xref="S2.p6.10.m10.2.3.2.2.2">𝐵</ci><ci id="S2.p6.10.m10.2.3.2.2.3.cmml" xref="S2.p6.10.m10.2.3.2.2.3">𝑇</ci></apply><ci id="S2.p6.10.m10.2.3.2.3.cmml" xref="S2.p6.10.m10.2.3.2.3">𝑓</ci><ci id="S2.p6.10.m10.2.2.cmml" xref="S2.p6.10.m10.2.2">𝑥</ci></apply><apply id="S2.p6.10.m10.2.3.3.cmml" xref="S2.p6.10.m10.2.3.3"><csymbol cd="ambiguous" id="S2.p6.10.m10.2.3.3.1.cmml" xref="S2.p6.10.m10.2.3.3">superscript</csymbol><ci id="S2.p6.10.m10.2.3.3.2.cmml" xref="S2.p6.10.m10.2.3.3.2">ℛ</ci><apply id="S2.p6.10.m10.1.1.1.2.cmml" xref="S2.p6.10.m10.1.1.1.3"><abs id="S2.p6.10.m10.1.1.1.2.1.cmml" xref="S2.p6.10.m10.1.1.1.3.1"></abs><ci id="S2.p6.10.m10.1.1.1.1.cmml" xref="S2.p6.10.m10.1.1.1.1">𝒴</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.10.m10.2c">B^{T}f(x)\in\mathcal{R}^{|\mathcal{Y}|}</annotation><annotation encoding="application/x-llamapun" id="S2.p6.10.m10.2d">italic_B start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_f ( italic_x ) ∈ caligraphic_R start_POSTSUPERSCRIPT | caligraphic_Y | end_POSTSUPERSCRIPT</annotation></semantics></math> and select the top-<math alttext="k" class="ltx_Math" display="inline" id="S2.p6.11.m11.1"><semantics id="S2.p6.11.m11.1a"><mi id="S2.p6.11.m11.1.1" xref="S2.p6.11.m11.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.p6.11.m11.1b"><ci id="S2.p6.11.m11.1.1.cmml" xref="S2.p6.11.m11.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.11.m11.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.p6.11.m11.1d">italic_k</annotation></semantics></math> targets to define <math alttext="S(\mathcal{Y})" class="ltx_Math" display="inline" id="S2.p6.12.m12.1"><semantics id="S2.p6.12.m12.1a"><mrow id="S2.p6.12.m12.1.2" xref="S2.p6.12.m12.1.2.cmml"><mi id="S2.p6.12.m12.1.2.2" xref="S2.p6.12.m12.1.2.2.cmml">S</mi><mo id="S2.p6.12.m12.1.2.1" xref="S2.p6.12.m12.1.2.1.cmml">⁢</mo><mrow id="S2.p6.12.m12.1.2.3.2" xref="S2.p6.12.m12.1.2.cmml"><mo id="S2.p6.12.m12.1.2.3.2.1" stretchy="false" xref="S2.p6.12.m12.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.p6.12.m12.1.1" xref="S2.p6.12.m12.1.1.cmml">𝒴</mi><mo id="S2.p6.12.m12.1.2.3.2.2" stretchy="false" xref="S2.p6.12.m12.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p6.12.m12.1b"><apply id="S2.p6.12.m12.1.2.cmml" xref="S2.p6.12.m12.1.2"><times id="S2.p6.12.m12.1.2.1.cmml" xref="S2.p6.12.m12.1.2.1"></times><ci id="S2.p6.12.m12.1.2.2.cmml" xref="S2.p6.12.m12.1.2.2">𝑆</ci><ci id="S2.p6.12.m12.1.1.cmml" xref="S2.p6.12.m12.1.1">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.12.m12.1c">S(\mathcal{Y})</annotation><annotation encoding="application/x-llamapun" id="S2.p6.12.m12.1d">italic_S ( caligraphic_Y )</annotation></semantics></math>. Even before training, we can use the pre-trained model to produce embeddings for all targets <math alttext="B_{y_{i}}=g(y_{i};\Theta_{0})" class="ltx_Math" display="inline" id="S2.p6.13.m13.2"><semantics id="S2.p6.13.m13.2a"><mrow id="S2.p6.13.m13.2.2" xref="S2.p6.13.m13.2.2.cmml"><msub id="S2.p6.13.m13.2.2.4" xref="S2.p6.13.m13.2.2.4.cmml"><mi id="S2.p6.13.m13.2.2.4.2" xref="S2.p6.13.m13.2.2.4.2.cmml">B</mi><msub id="S2.p6.13.m13.2.2.4.3" xref="S2.p6.13.m13.2.2.4.3.cmml"><mi id="S2.p6.13.m13.2.2.4.3.2" xref="S2.p6.13.m13.2.2.4.3.2.cmml">y</mi><mi id="S2.p6.13.m13.2.2.4.3.3" xref="S2.p6.13.m13.2.2.4.3.3.cmml">i</mi></msub></msub><mo id="S2.p6.13.m13.2.2.3" xref="S2.p6.13.m13.2.2.3.cmml">=</mo><mrow id="S2.p6.13.m13.2.2.2" xref="S2.p6.13.m13.2.2.2.cmml"><mi id="S2.p6.13.m13.2.2.2.4" xref="S2.p6.13.m13.2.2.2.4.cmml">g</mi><mo id="S2.p6.13.m13.2.2.2.3" xref="S2.p6.13.m13.2.2.2.3.cmml">⁢</mo><mrow id="S2.p6.13.m13.2.2.2.2.2" xref="S2.p6.13.m13.2.2.2.2.3.cmml"><mo id="S2.p6.13.m13.2.2.2.2.2.3" stretchy="false" xref="S2.p6.13.m13.2.2.2.2.3.cmml">(</mo><msub id="S2.p6.13.m13.1.1.1.1.1.1" xref="S2.p6.13.m13.1.1.1.1.1.1.cmml"><mi id="S2.p6.13.m13.1.1.1.1.1.1.2" xref="S2.p6.13.m13.1.1.1.1.1.1.2.cmml">y</mi><mi id="S2.p6.13.m13.1.1.1.1.1.1.3" xref="S2.p6.13.m13.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.p6.13.m13.2.2.2.2.2.4" xref="S2.p6.13.m13.2.2.2.2.3.cmml">;</mo><msub id="S2.p6.13.m13.2.2.2.2.2.2" xref="S2.p6.13.m13.2.2.2.2.2.2.cmml"><mi id="S2.p6.13.m13.2.2.2.2.2.2.2" mathvariant="normal" xref="S2.p6.13.m13.2.2.2.2.2.2.2.cmml">Θ</mi><mn id="S2.p6.13.m13.2.2.2.2.2.2.3" xref="S2.p6.13.m13.2.2.2.2.2.2.3.cmml">0</mn></msub><mo id="S2.p6.13.m13.2.2.2.2.2.5" stretchy="false" xref="S2.p6.13.m13.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p6.13.m13.2b"><apply id="S2.p6.13.m13.2.2.cmml" xref="S2.p6.13.m13.2.2"><eq id="S2.p6.13.m13.2.2.3.cmml" xref="S2.p6.13.m13.2.2.3"></eq><apply id="S2.p6.13.m13.2.2.4.cmml" xref="S2.p6.13.m13.2.2.4"><csymbol cd="ambiguous" id="S2.p6.13.m13.2.2.4.1.cmml" xref="S2.p6.13.m13.2.2.4">subscript</csymbol><ci id="S2.p6.13.m13.2.2.4.2.cmml" xref="S2.p6.13.m13.2.2.4.2">𝐵</ci><apply id="S2.p6.13.m13.2.2.4.3.cmml" xref="S2.p6.13.m13.2.2.4.3"><csymbol cd="ambiguous" id="S2.p6.13.m13.2.2.4.3.1.cmml" xref="S2.p6.13.m13.2.2.4.3">subscript</csymbol><ci id="S2.p6.13.m13.2.2.4.3.2.cmml" xref="S2.p6.13.m13.2.2.4.3.2">𝑦</ci><ci id="S2.p6.13.m13.2.2.4.3.3.cmml" xref="S2.p6.13.m13.2.2.4.3.3">𝑖</ci></apply></apply><apply id="S2.p6.13.m13.2.2.2.cmml" xref="S2.p6.13.m13.2.2.2"><times id="S2.p6.13.m13.2.2.2.3.cmml" xref="S2.p6.13.m13.2.2.2.3"></times><ci id="S2.p6.13.m13.2.2.2.4.cmml" xref="S2.p6.13.m13.2.2.2.4">𝑔</ci><list id="S2.p6.13.m13.2.2.2.2.3.cmml" xref="S2.p6.13.m13.2.2.2.2.2"><apply id="S2.p6.13.m13.1.1.1.1.1.1.cmml" xref="S2.p6.13.m13.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p6.13.m13.1.1.1.1.1.1.1.cmml" xref="S2.p6.13.m13.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p6.13.m13.1.1.1.1.1.1.2.cmml" xref="S2.p6.13.m13.1.1.1.1.1.1.2">𝑦</ci><ci id="S2.p6.13.m13.1.1.1.1.1.1.3.cmml" xref="S2.p6.13.m13.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.p6.13.m13.2.2.2.2.2.2.cmml" xref="S2.p6.13.m13.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.p6.13.m13.2.2.2.2.2.2.1.cmml" xref="S2.p6.13.m13.2.2.2.2.2.2">subscript</csymbol><ci id="S2.p6.13.m13.2.2.2.2.2.2.2.cmml" xref="S2.p6.13.m13.2.2.2.2.2.2.2">Θ</ci><cn id="S2.p6.13.m13.2.2.2.2.2.2.3.cmml" type="integer" xref="S2.p6.13.m13.2.2.2.2.2.2.3">0</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.13.m13.2c">B_{y_{i}}=g(y_{i};\Theta_{0})</annotation><annotation encoding="application/x-llamapun" id="S2.p6.13.m13.2d">italic_B start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT = italic_g ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ; roman_Θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math>. While <math alttext="B" class="ltx_Math" display="inline" id="S2.p6.14.m14.1"><semantics id="S2.p6.14.m14.1a"><mi id="S2.p6.14.m14.1.1" xref="S2.p6.14.m14.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S2.p6.14.m14.1b"><ci id="S2.p6.14.m14.1.1.cmml" xref="S2.p6.14.m14.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.14.m14.1c">B</annotation><annotation encoding="application/x-llamapun" id="S2.p6.14.m14.1d">italic_B</annotation></semantics></math> may seem large, this is considerably more efficient than exact computation and is possible, on accelerators, for <math alttext="|\mathcal{Y}|" class="ltx_Math" display="inline" id="S2.p6.15.m15.1"><semantics id="S2.p6.15.m15.1a"><mrow id="S2.p6.15.m15.1.2.2" xref="S2.p6.15.m15.1.2.1.cmml"><mo id="S2.p6.15.m15.1.2.2.1" stretchy="false" xref="S2.p6.15.m15.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.p6.15.m15.1.1" xref="S2.p6.15.m15.1.1.cmml">𝒴</mi><mo id="S2.p6.15.m15.1.2.2.2" stretchy="false" xref="S2.p6.15.m15.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p6.15.m15.1b"><apply id="S2.p6.15.m15.1.2.1.cmml" xref="S2.p6.15.m15.1.2.2"><abs id="S2.p6.15.m15.1.2.1.1.cmml" xref="S2.p6.15.m15.1.2.2.1"></abs><ci id="S2.p6.15.m15.1.1.cmml" xref="S2.p6.15.m15.1.1">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.15.m15.1c">|\mathcal{Y}|</annotation><annotation encoding="application/x-llamapun" id="S2.p6.15.m15.1d">| caligraphic_Y |</annotation></semantics></math> in the tens of millions.</p>
</div>
<div class="ltx_para" id="S2.p7">
<p class="ltx_p" id="S2.p7.3">The bias of this approach (and subsequent degradation in performance) depends on the <em class="ltx_emph ltx_font_italic" id="S2.p7.3.1">staleness</em> or drift of the embeddings, i.e., <math alttext="||B_{y_{i}}-g(y_{i})||" class="ltx_Math" display="inline" id="S2.p7.1.m1.1"><semantics id="S2.p7.1.m1.1a"><mrow id="S2.p7.1.m1.1.1.1" xref="S2.p7.1.m1.1.1.2.cmml"><mo id="S2.p7.1.m1.1.1.1.2" stretchy="false" xref="S2.p7.1.m1.1.1.2.1.cmml">‖</mo><mrow id="S2.p7.1.m1.1.1.1.1" xref="S2.p7.1.m1.1.1.1.1.cmml"><msub id="S2.p7.1.m1.1.1.1.1.3" xref="S2.p7.1.m1.1.1.1.1.3.cmml"><mi id="S2.p7.1.m1.1.1.1.1.3.2" xref="S2.p7.1.m1.1.1.1.1.3.2.cmml">B</mi><msub id="S2.p7.1.m1.1.1.1.1.3.3" xref="S2.p7.1.m1.1.1.1.1.3.3.cmml"><mi id="S2.p7.1.m1.1.1.1.1.3.3.2" xref="S2.p7.1.m1.1.1.1.1.3.3.2.cmml">y</mi><mi id="S2.p7.1.m1.1.1.1.1.3.3.3" xref="S2.p7.1.m1.1.1.1.1.3.3.3.cmml">i</mi></msub></msub><mo id="S2.p7.1.m1.1.1.1.1.2" xref="S2.p7.1.m1.1.1.1.1.2.cmml">−</mo><mrow id="S2.p7.1.m1.1.1.1.1.1" xref="S2.p7.1.m1.1.1.1.1.1.cmml"><mi id="S2.p7.1.m1.1.1.1.1.1.3" xref="S2.p7.1.m1.1.1.1.1.1.3.cmml">g</mi><mo id="S2.p7.1.m1.1.1.1.1.1.2" xref="S2.p7.1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.p7.1.m1.1.1.1.1.1.1.1" xref="S2.p7.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.p7.1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.p7.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.p7.1.m1.1.1.1.1.1.1.1.1" xref="S2.p7.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.p7.1.m1.1.1.1.1.1.1.1.1.2" xref="S2.p7.1.m1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="S2.p7.1.m1.1.1.1.1.1.1.1.1.3" xref="S2.p7.1.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.p7.1.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.p7.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.p7.1.m1.1.1.1.3" stretchy="false" xref="S2.p7.1.m1.1.1.2.1.cmml">‖</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p7.1.m1.1b"><apply id="S2.p7.1.m1.1.1.2.cmml" xref="S2.p7.1.m1.1.1.1"><csymbol cd="latexml" id="S2.p7.1.m1.1.1.2.1.cmml" xref="S2.p7.1.m1.1.1.1.2">norm</csymbol><apply id="S2.p7.1.m1.1.1.1.1.cmml" xref="S2.p7.1.m1.1.1.1.1"><minus id="S2.p7.1.m1.1.1.1.1.2.cmml" xref="S2.p7.1.m1.1.1.1.1.2"></minus><apply id="S2.p7.1.m1.1.1.1.1.3.cmml" xref="S2.p7.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p7.1.m1.1.1.1.1.3.1.cmml" xref="S2.p7.1.m1.1.1.1.1.3">subscript</csymbol><ci id="S2.p7.1.m1.1.1.1.1.3.2.cmml" xref="S2.p7.1.m1.1.1.1.1.3.2">𝐵</ci><apply id="S2.p7.1.m1.1.1.1.1.3.3.cmml" xref="S2.p7.1.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.p7.1.m1.1.1.1.1.3.3.1.cmml" xref="S2.p7.1.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.p7.1.m1.1.1.1.1.3.3.2.cmml" xref="S2.p7.1.m1.1.1.1.1.3.3.2">𝑦</ci><ci id="S2.p7.1.m1.1.1.1.1.3.3.3.cmml" xref="S2.p7.1.m1.1.1.1.1.3.3.3">𝑖</ci></apply></apply><apply id="S2.p7.1.m1.1.1.1.1.1.cmml" xref="S2.p7.1.m1.1.1.1.1.1"><times id="S2.p7.1.m1.1.1.1.1.1.2.cmml" xref="S2.p7.1.m1.1.1.1.1.1.2"></times><ci id="S2.p7.1.m1.1.1.1.1.1.3.cmml" xref="S2.p7.1.m1.1.1.1.1.1.3">𝑔</ci><apply id="S2.p7.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.p7.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p7.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p7.1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p7.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.p7.1.m1.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S2.p7.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.p7.1.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p7.1.m1.1c">||B_{y_{i}}-g(y_{i})||</annotation><annotation encoding="application/x-llamapun" id="S2.p7.1.m1.1d">| | italic_B start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT - italic_g ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) | |</annotation></semantics></math> which will increase as we update the parameters of <math alttext="g(y)" class="ltx_Math" display="inline" id="S2.p7.2.m2.1"><semantics id="S2.p7.2.m2.1a"><mrow id="S2.p7.2.m2.1.2" xref="S2.p7.2.m2.1.2.cmml"><mi id="S2.p7.2.m2.1.2.2" xref="S2.p7.2.m2.1.2.2.cmml">g</mi><mo id="S2.p7.2.m2.1.2.1" xref="S2.p7.2.m2.1.2.1.cmml">⁢</mo><mrow id="S2.p7.2.m2.1.2.3.2" xref="S2.p7.2.m2.1.2.cmml"><mo id="S2.p7.2.m2.1.2.3.2.1" stretchy="false" xref="S2.p7.2.m2.1.2.cmml">(</mo><mi id="S2.p7.2.m2.1.1" xref="S2.p7.2.m2.1.1.cmml">y</mi><mo id="S2.p7.2.m2.1.2.3.2.2" stretchy="false" xref="S2.p7.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p7.2.m2.1b"><apply id="S2.p7.2.m2.1.2.cmml" xref="S2.p7.2.m2.1.2"><times id="S2.p7.2.m2.1.2.1.cmml" xref="S2.p7.2.m2.1.2.1"></times><ci id="S2.p7.2.m2.1.2.2.cmml" xref="S2.p7.2.m2.1.2.2">𝑔</ci><ci id="S2.p7.2.m2.1.1.cmml" xref="S2.p7.2.m2.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p7.2.m2.1c">g(y)</annotation><annotation encoding="application/x-llamapun" id="S2.p7.2.m2.1d">italic_g ( italic_y )</annotation></semantics></math>. This can be mitigated by recomputing <math alttext="B" class="ltx_Math" display="inline" id="S2.p7.3.m3.1"><semantics id="S2.p7.3.m3.1a"><mi id="S2.p7.3.m3.1.1" xref="S2.p7.3.m3.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S2.p7.3.m3.1b"><ci id="S2.p7.3.m3.1.1.cmml" xref="S2.p7.3.m3.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p7.3.m3.1c">B</annotation><annotation encoding="application/x-llamapun" id="S2.p7.3.m3.1d">italic_B</annotation></semantics></math> periodically throughout training (at notable cost). This approach of periodically recomputing has been used <cite class="ltx_cite ltx_citemacro_citep">(Guu et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib11" title="">2020</a>; Izacard et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib15" title="">2022</a>; Monath et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib24" title="">2023</a>)</cite>, but there is still much room for improvement.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Improving Training with Target Correctors</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.2">Our proposed approach builds upon these stale buffer approximations by using an additional parametric model. The additional model aims to improve upon the stale <math alttext="g^{\prime}(y)" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><mrow id="S3.p1.1.m1.1.2" xref="S3.p1.1.m1.1.2.cmml"><msup id="S3.p1.1.m1.1.2.2" xref="S3.p1.1.m1.1.2.2.cmml"><mi id="S3.p1.1.m1.1.2.2.2" xref="S3.p1.1.m1.1.2.2.2.cmml">g</mi><mo id="S3.p1.1.m1.1.2.2.3" xref="S3.p1.1.m1.1.2.2.3.cmml">′</mo></msup><mo id="S3.p1.1.m1.1.2.1" xref="S3.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.p1.1.m1.1.2.3.2" xref="S3.p1.1.m1.1.2.cmml"><mo id="S3.p1.1.m1.1.2.3.2.1" stretchy="false" xref="S3.p1.1.m1.1.2.cmml">(</mo><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">y</mi><mo id="S3.p1.1.m1.1.2.3.2.2" stretchy="false" xref="S3.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.2.cmml" xref="S3.p1.1.m1.1.2"><times id="S3.p1.1.m1.1.2.1.cmml" xref="S3.p1.1.m1.1.2.1"></times><apply id="S3.p1.1.m1.1.2.2.cmml" xref="S3.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.2.2.1.cmml" xref="S3.p1.1.m1.1.2.2">superscript</csymbol><ci id="S3.p1.1.m1.1.2.2.2.cmml" xref="S3.p1.1.m1.1.2.2.2">𝑔</ci><ci id="S3.p1.1.m1.1.2.2.3.cmml" xref="S3.p1.1.m1.1.2.2.3">′</ci></apply><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">g^{\prime}(y)</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y )</annotation></semantics></math> to yield a better approximation of <math alttext="g(y)" class="ltx_Math" display="inline" id="S3.p1.2.m2.1"><semantics id="S3.p1.2.m2.1a"><mrow id="S3.p1.2.m2.1.2" xref="S3.p1.2.m2.1.2.cmml"><mi id="S3.p1.2.m2.1.2.2" xref="S3.p1.2.m2.1.2.2.cmml">g</mi><mo id="S3.p1.2.m2.1.2.1" xref="S3.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.p1.2.m2.1.2.3.2" xref="S3.p1.2.m2.1.2.cmml"><mo id="S3.p1.2.m2.1.2.3.2.1" stretchy="false" xref="S3.p1.2.m2.1.2.cmml">(</mo><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">y</mi><mo id="S3.p1.2.m2.1.2.3.2.2" stretchy="false" xref="S3.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><apply id="S3.p1.2.m2.1.2.cmml" xref="S3.p1.2.m2.1.2"><times id="S3.p1.2.m2.1.2.1.cmml" xref="S3.p1.2.m2.1.2.1"></times><ci id="S3.p1.2.m2.1.2.2.cmml" xref="S3.p1.2.m2.1.2.2">𝑔</ci><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">g(y)</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.1d">italic_g ( italic_y )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.4">We refer to this additional parametric model as a <em class="ltx_emph ltx_font_italic" id="S3.p2.4.1">target corrector network</em>, <math alttext="h(\cdot;\Psi)" class="ltx_Math" display="inline" id="S3.p2.1.m1.2"><semantics id="S3.p2.1.m1.2a"><mrow id="S3.p2.1.m1.2.3" xref="S3.p2.1.m1.2.3.cmml"><mi id="S3.p2.1.m1.2.3.2" xref="S3.p2.1.m1.2.3.2.cmml">h</mi><mo id="S3.p2.1.m1.2.3.1" xref="S3.p2.1.m1.2.3.1.cmml">⁢</mo><mrow id="S3.p2.1.m1.2.3.3.2" xref="S3.p2.1.m1.2.3.3.1.cmml"><mo id="S3.p2.1.m1.2.3.3.2.1" stretchy="false" xref="S3.p2.1.m1.2.3.3.1.cmml">(</mo><mo id="S3.p2.1.m1.1.1" lspace="0em" rspace="0em" xref="S3.p2.1.m1.1.1.cmml">⋅</mo><mo id="S3.p2.1.m1.2.3.3.2.2" xref="S3.p2.1.m1.2.3.3.1.cmml">;</mo><mi id="S3.p2.1.m1.2.2" mathvariant="normal" xref="S3.p2.1.m1.2.2.cmml">Ψ</mi><mo id="S3.p2.1.m1.2.3.3.2.3" stretchy="false" xref="S3.p2.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.2b"><apply id="S3.p2.1.m1.2.3.cmml" xref="S3.p2.1.m1.2.3"><times id="S3.p2.1.m1.2.3.1.cmml" xref="S3.p2.1.m1.2.3.1"></times><ci id="S3.p2.1.m1.2.3.2.cmml" xref="S3.p2.1.m1.2.3.2">ℎ</ci><list id="S3.p2.1.m1.2.3.3.1.cmml" xref="S3.p2.1.m1.2.3.3.2"><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">⋅</ci><ci id="S3.p2.1.m1.2.2.cmml" xref="S3.p2.1.m1.2.2">Ψ</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.2c">h(\cdot;\Psi)</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.2d">italic_h ( ⋅ ; roman_Ψ )</annotation></semantics></math> or simply <math alttext="h(\cdot)" class="ltx_Math" display="inline" id="S3.p2.2.m2.1"><semantics id="S3.p2.2.m2.1a"><mrow id="S3.p2.2.m2.1.2" xref="S3.p2.2.m2.1.2.cmml"><mi id="S3.p2.2.m2.1.2.2" xref="S3.p2.2.m2.1.2.2.cmml">h</mi><mo id="S3.p2.2.m2.1.2.1" xref="S3.p2.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.p2.2.m2.1.2.3.2" xref="S3.p2.2.m2.1.2.cmml"><mo id="S3.p2.2.m2.1.2.3.2.1" stretchy="false" xref="S3.p2.2.m2.1.2.cmml">(</mo><mo id="S3.p2.2.m2.1.1" lspace="0em" rspace="0em" xref="S3.p2.2.m2.1.1.cmml">⋅</mo><mo id="S3.p2.2.m2.1.2.3.2.2" stretchy="false" xref="S3.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.2.cmml" xref="S3.p2.2.m2.1.2"><times id="S3.p2.2.m2.1.2.1.cmml" xref="S3.p2.2.m2.1.2.1"></times><ci id="S3.p2.2.m2.1.2.2.cmml" xref="S3.p2.2.m2.1.2.2">ℎ</ci><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">h(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.p2.2.m2.1d">italic_h ( ⋅ )</annotation></semantics></math> when the parameters <math alttext="\Psi" class="ltx_Math" display="inline" id="S3.p2.3.m3.1"><semantics id="S3.p2.3.m3.1a"><mi id="S3.p2.3.m3.1.1" mathvariant="normal" xref="S3.p2.3.m3.1.1.cmml">Ψ</mi><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><ci id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1">Ψ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">\Psi</annotation><annotation encoding="application/x-llamapun" id="S3.p2.3.m3.1d">roman_Ψ</annotation></semantics></math> are not pertinent. This target corrector network takes as input the existing stale vector embedding, <math alttext="g^{\prime}(y)" class="ltx_Math" display="inline" id="S3.p2.4.m4.1"><semantics id="S3.p2.4.m4.1a"><mrow id="S3.p2.4.m4.1.2" xref="S3.p2.4.m4.1.2.cmml"><msup id="S3.p2.4.m4.1.2.2" xref="S3.p2.4.m4.1.2.2.cmml"><mi id="S3.p2.4.m4.1.2.2.2" xref="S3.p2.4.m4.1.2.2.2.cmml">g</mi><mo id="S3.p2.4.m4.1.2.2.3" xref="S3.p2.4.m4.1.2.2.3.cmml">′</mo></msup><mo id="S3.p2.4.m4.1.2.1" xref="S3.p2.4.m4.1.2.1.cmml">⁢</mo><mrow id="S3.p2.4.m4.1.2.3.2" xref="S3.p2.4.m4.1.2.cmml"><mo id="S3.p2.4.m4.1.2.3.2.1" stretchy="false" xref="S3.p2.4.m4.1.2.cmml">(</mo><mi id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml">y</mi><mo id="S3.p2.4.m4.1.2.3.2.2" stretchy="false" xref="S3.p2.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><apply id="S3.p2.4.m4.1.2.cmml" xref="S3.p2.4.m4.1.2"><times id="S3.p2.4.m4.1.2.1.cmml" xref="S3.p2.4.m4.1.2.1"></times><apply id="S3.p2.4.m4.1.2.2.cmml" xref="S3.p2.4.m4.1.2.2"><csymbol cd="ambiguous" id="S3.p2.4.m4.1.2.2.1.cmml" xref="S3.p2.4.m4.1.2.2">superscript</csymbol><ci id="S3.p2.4.m4.1.2.2.2.cmml" xref="S3.p2.4.m4.1.2.2.2">𝑔</ci><ci id="S3.p2.4.m4.1.2.2.3.cmml" xref="S3.p2.4.m4.1.2.2.3">′</ci></apply><ci id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">g^{\prime}(y)</annotation><annotation encoding="application/x-llamapun" id="S3.p2.4.m4.1d">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y )</annotation></semantics></math>, and yields the following approximation of the softmax function:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="P_{h}(y|x)\propto\exp(\beta\langle f(x),h\circ g^{\prime}(y)\rangle).\vspace{-%
3mm}" class="ltx_Math" display="block" id="S3.E4.m1.4"><semantics id="S3.E4.m1.4a"><mrow id="S3.E4.m1.4.4.1" xref="S3.E4.m1.4.4.1.1.cmml"><mrow id="S3.E4.m1.4.4.1.1" xref="S3.E4.m1.4.4.1.1.cmml"><mrow id="S3.E4.m1.4.4.1.1.1" xref="S3.E4.m1.4.4.1.1.1.cmml"><msub id="S3.E4.m1.4.4.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.3.cmml"><mi id="S3.E4.m1.4.4.1.1.1.3.2" xref="S3.E4.m1.4.4.1.1.1.3.2.cmml">P</mi><mi id="S3.E4.m1.4.4.1.1.1.3.3" xref="S3.E4.m1.4.4.1.1.1.3.3.cmml">h</mi></msub><mo id="S3.E4.m1.4.4.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.4.4.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S3.E4.m1.4.4.1.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E4.m1.4.4.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.4.4.1.1.3" xref="S3.E4.m1.4.4.1.1.3.cmml">∝</mo><mrow id="S3.E4.m1.4.4.1.1.2.1" xref="S3.E4.m1.4.4.1.1.2.2.cmml"><mi id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml">exp</mi><mo id="S3.E4.m1.4.4.1.1.2.1a" xref="S3.E4.m1.4.4.1.1.2.2.cmml">⁡</mo><mrow id="S3.E4.m1.4.4.1.1.2.1.1" xref="S3.E4.m1.4.4.1.1.2.2.cmml"><mo id="S3.E4.m1.4.4.1.1.2.1.1.2" stretchy="false" xref="S3.E4.m1.4.4.1.1.2.2.cmml">(</mo><mrow id="S3.E4.m1.4.4.1.1.2.1.1.1" xref="S3.E4.m1.4.4.1.1.2.1.1.1.cmml"><mi id="S3.E4.m1.4.4.1.1.2.1.1.1.4" xref="S3.E4.m1.4.4.1.1.2.1.1.1.4.cmml">β</mi><mo id="S3.E4.m1.4.4.1.1.2.1.1.1.3" xref="S3.E4.m1.4.4.1.1.2.1.1.1.3.cmml">⁢</mo><mrow id="S3.E4.m1.4.4.1.1.2.1.1.1.2.2" xref="S3.E4.m1.4.4.1.1.2.1.1.1.2.3.cmml"><mo id="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.3" stretchy="false" xref="S3.E4.m1.4.4.1.1.2.1.1.1.2.3.cmml">⟨</mo><mrow id="S3.E4.m1.4.4.1.1.2.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.2.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.4.4.1.1.2.1.1.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.2.1.1.1.1.1.1.2.cmml">f</mi><mo id="S3.E4.m1.4.4.1.1.2.1.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.2.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E4.m1.4.4.1.1.2.1.1.1.1.1.1.3.2" xref="S3.E4.m1.4.4.1.1.2.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.4.4.1.1.2.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E4.m1.4.4.1.1.2.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">x</mi><mo id="S3.E4.m1.4.4.1.1.2.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E4.m1.4.4.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.4" xref="S3.E4.m1.4.4.1.1.2.1.1.1.2.3.cmml">,</mo><mrow id="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2" xref="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.cmml"><mrow id="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.2" xref="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.2.cmml"><mi id="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.2.2" xref="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.2.2.cmml">h</mi><mo id="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.2.1.cmml">∘</mo><msup id="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.2.3" xref="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.2.3.cmml"><mi id="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.2.3.2" xref="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.2.3.2.cmml">g</mi><mo id="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.2.3.3" xref="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.2.3.3.cmml">′</mo></msup></mrow><mo id="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.1" xref="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.1.cmml">⁢</mo><mrow id="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.3.2" xref="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.cmml"><mo id="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.3.2.1" stretchy="false" xref="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.cmml">(</mo><mi id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">y</mi><mo id="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.3.2.2" stretchy="false" xref="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.5" stretchy="false" xref="S3.E4.m1.4.4.1.1.2.1.1.1.2.3.cmml">⟩</mo></mrow></mrow><mo id="S3.E4.m1.4.4.1.1.2.1.1.3" stretchy="false" xref="S3.E4.m1.4.4.1.1.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.4.4.1.2" lspace="0em" xref="S3.E4.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.4b"><apply id="S3.E4.m1.4.4.1.1.cmml" xref="S3.E4.m1.4.4.1"><csymbol cd="latexml" id="S3.E4.m1.4.4.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.3">proportional-to</csymbol><apply id="S3.E4.m1.4.4.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1"><times id="S3.E4.m1.4.4.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.2"></times><apply id="S3.E4.m1.4.4.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.3.1.cmml" xref="S3.E4.m1.4.4.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.4.4.1.1.1.3.2.cmml" xref="S3.E4.m1.4.4.1.1.1.3.2">𝑃</ci><ci id="S3.E4.m1.4.4.1.1.1.3.3.cmml" xref="S3.E4.m1.4.4.1.1.1.3.3">ℎ</ci></apply><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2">𝑦</ci><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.E4.m1.4.4.1.1.2.2.cmml" xref="S3.E4.m1.4.4.1.1.2.1"><exp id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3"></exp><apply id="S3.E4.m1.4.4.1.1.2.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.2.1.1.1"><times id="S3.E4.m1.4.4.1.1.2.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.2.1.1.1.3"></times><ci id="S3.E4.m1.4.4.1.1.2.1.1.1.4.cmml" xref="S3.E4.m1.4.4.1.1.2.1.1.1.4">𝛽</ci><list id="S3.E4.m1.4.4.1.1.2.1.1.1.2.3.cmml" xref="S3.E4.m1.4.4.1.1.2.1.1.1.2.2"><apply id="S3.E4.m1.4.4.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.2.1.1.1.1.1.1"><times id="S3.E4.m1.4.4.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.2.1.1.1.1.1.1.1"></times><ci id="S3.E4.m1.4.4.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.2.1.1.1.1.1.1.2">𝑓</ci><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝑥</ci></apply><apply id="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.cmml" xref="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2"><times id="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.1.cmml" xref="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.1"></times><apply id="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.2"><compose id="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.2.1"></compose><ci id="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.2.2">ℎ</ci><apply id="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.2.3.cmml" xref="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.2.3.1.cmml" xref="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.2.3">superscript</csymbol><ci id="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.2.3.2.cmml" xref="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.2.3.2">𝑔</ci><ci id="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.2.3.3.cmml" xref="S3.E4.m1.4.4.1.1.2.1.1.1.2.2.2.2.3.3">′</ci></apply></apply><ci id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2">𝑦</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.4c">P_{h}(y|x)\propto\exp(\beta\langle f(x),h\circ g^{\prime}(y)\rangle).\vspace{-%
3mm}</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.4d">italic_P start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ( italic_y | italic_x ) ∝ roman_exp ( italic_β ⟨ italic_f ( italic_x ) , italic_h ∘ italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y ) ⟩ ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.1">With significantly fewer parameters than a typical dual-encoder, i.e., <math alttext="|\Psi|\ll|\Theta|" class="ltx_Math" display="inline" id="S3.p3.1.m1.2"><semantics id="S3.p3.1.m1.2a"><mrow id="S3.p3.1.m1.2.3" xref="S3.p3.1.m1.2.3.cmml"><mrow id="S3.p3.1.m1.2.3.2.2" xref="S3.p3.1.m1.2.3.2.1.cmml"><mo id="S3.p3.1.m1.2.3.2.2.1" stretchy="false" xref="S3.p3.1.m1.2.3.2.1.1.cmml">|</mo><mi id="S3.p3.1.m1.1.1" mathvariant="normal" xref="S3.p3.1.m1.1.1.cmml">Ψ</mi><mo id="S3.p3.1.m1.2.3.2.2.2" stretchy="false" xref="S3.p3.1.m1.2.3.2.1.1.cmml">|</mo></mrow><mo id="S3.p3.1.m1.2.3.1" xref="S3.p3.1.m1.2.3.1.cmml">≪</mo><mrow id="S3.p3.1.m1.2.3.3.2" xref="S3.p3.1.m1.2.3.3.1.cmml"><mo id="S3.p3.1.m1.2.3.3.2.1" stretchy="false" xref="S3.p3.1.m1.2.3.3.1.1.cmml">|</mo><mi id="S3.p3.1.m1.2.2" mathvariant="normal" xref="S3.p3.1.m1.2.2.cmml">Θ</mi><mo id="S3.p3.1.m1.2.3.3.2.2" stretchy="false" xref="S3.p3.1.m1.2.3.3.1.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.2b"><apply id="S3.p3.1.m1.2.3.cmml" xref="S3.p3.1.m1.2.3"><csymbol cd="latexml" id="S3.p3.1.m1.2.3.1.cmml" xref="S3.p3.1.m1.2.3.1">much-less-than</csymbol><apply id="S3.p3.1.m1.2.3.2.1.cmml" xref="S3.p3.1.m1.2.3.2.2"><abs id="S3.p3.1.m1.2.3.2.1.1.cmml" xref="S3.p3.1.m1.2.3.2.2.1"></abs><ci id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1">Ψ</ci></apply><apply id="S3.p3.1.m1.2.3.3.1.cmml" xref="S3.p3.1.m1.2.3.3.2"><abs id="S3.p3.1.m1.2.3.3.1.1.cmml" xref="S3.p3.1.m1.2.3.3.2.1"></abs><ci id="S3.p3.1.m1.2.2.cmml" xref="S3.p3.1.m1.2.2">Θ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.2c">|\Psi|\ll|\Theta|</annotation><annotation encoding="application/x-llamapun" id="S3.p3.1.m1.2d">| roman_Ψ | ≪ | roman_Θ |</annotation></semantics></math>, this small parameteric model is efficient enough to provide approximately fresh representations of every target at every training step. The target corrector network presents interesting research questions regarding whether the network can obviate the need for re-embedding, what kinds of staleness or drift can be effectively modeled, and how much training data is required.</p>
</div>
<figure class="ltx_figure" id="S3.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="417" id="S3.F1.g1" src="x1.png" width="747"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span class="ltx_text ltx_font_bold" id="S3.F1.12.1">Target Corrector Networks</span>. The corrector network, <math alttext="h(\cdot)" class="ltx_Math" display="inline" id="S3.F1.6.m1.1"><semantics id="S3.F1.6.m1.1b"><mrow id="S3.F1.6.m1.1.2" xref="S3.F1.6.m1.1.2.cmml"><mi id="S3.F1.6.m1.1.2.2" xref="S3.F1.6.m1.1.2.2.cmml">h</mi><mo id="S3.F1.6.m1.1.2.1" xref="S3.F1.6.m1.1.2.1.cmml">⁢</mo><mrow id="S3.F1.6.m1.1.2.3.2" xref="S3.F1.6.m1.1.2.cmml"><mo id="S3.F1.6.m1.1.2.3.2.1" stretchy="false" xref="S3.F1.6.m1.1.2.cmml">(</mo><mo id="S3.F1.6.m1.1.1" lspace="0em" rspace="0em" xref="S3.F1.6.m1.1.1.cmml">⋅</mo><mo id="S3.F1.6.m1.1.2.3.2.2" stretchy="false" xref="S3.F1.6.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F1.6.m1.1c"><apply id="S3.F1.6.m1.1.2.cmml" xref="S3.F1.6.m1.1.2"><times id="S3.F1.6.m1.1.2.1.cmml" xref="S3.F1.6.m1.1.2.1"></times><ci id="S3.F1.6.m1.1.2.2.cmml" xref="S3.F1.6.m1.1.2.2">ℎ</ci><ci id="S3.F1.6.m1.1.1.cmml" xref="S3.F1.6.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.6.m1.1d">h(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.F1.6.m1.1e">italic_h ( ⋅ )</annotation></semantics></math>, moves the approximate representations of targets, <math alttext="g^{\prime}(\cdot)" class="ltx_Math" display="inline" id="S3.F1.7.m2.1"><semantics id="S3.F1.7.m2.1b"><mrow id="S3.F1.7.m2.1.2" xref="S3.F1.7.m2.1.2.cmml"><msup id="S3.F1.7.m2.1.2.2" xref="S3.F1.7.m2.1.2.2.cmml"><mi id="S3.F1.7.m2.1.2.2.2" xref="S3.F1.7.m2.1.2.2.2.cmml">g</mi><mo id="S3.F1.7.m2.1.2.2.3" xref="S3.F1.7.m2.1.2.2.3.cmml">′</mo></msup><mo id="S3.F1.7.m2.1.2.1" xref="S3.F1.7.m2.1.2.1.cmml">⁢</mo><mrow id="S3.F1.7.m2.1.2.3.2" xref="S3.F1.7.m2.1.2.cmml"><mo id="S3.F1.7.m2.1.2.3.2.1" stretchy="false" xref="S3.F1.7.m2.1.2.cmml">(</mo><mo id="S3.F1.7.m2.1.1" lspace="0em" rspace="0em" xref="S3.F1.7.m2.1.1.cmml">⋅</mo><mo id="S3.F1.7.m2.1.2.3.2.2" stretchy="false" xref="S3.F1.7.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F1.7.m2.1c"><apply id="S3.F1.7.m2.1.2.cmml" xref="S3.F1.7.m2.1.2"><times id="S3.F1.7.m2.1.2.1.cmml" xref="S3.F1.7.m2.1.2.1"></times><apply id="S3.F1.7.m2.1.2.2.cmml" xref="S3.F1.7.m2.1.2.2"><csymbol cd="ambiguous" id="S3.F1.7.m2.1.2.2.1.cmml" xref="S3.F1.7.m2.1.2.2">superscript</csymbol><ci id="S3.F1.7.m2.1.2.2.2.cmml" xref="S3.F1.7.m2.1.2.2.2">𝑔</ci><ci id="S3.F1.7.m2.1.2.2.3.cmml" xref="S3.F1.7.m2.1.2.2.3">′</ci></apply><ci id="S3.F1.7.m2.1.1.cmml" xref="S3.F1.7.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.7.m2.1d">g^{\prime}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.F1.7.m2.1e">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( ⋅ )</annotation></semantics></math> to be closer to their true positions, <math alttext="g(\cdot)" class="ltx_Math" display="inline" id="S3.F1.8.m3.1"><semantics id="S3.F1.8.m3.1b"><mrow id="S3.F1.8.m3.1.2" xref="S3.F1.8.m3.1.2.cmml"><mi id="S3.F1.8.m3.1.2.2" xref="S3.F1.8.m3.1.2.2.cmml">g</mi><mo id="S3.F1.8.m3.1.2.1" xref="S3.F1.8.m3.1.2.1.cmml">⁢</mo><mrow id="S3.F1.8.m3.1.2.3.2" xref="S3.F1.8.m3.1.2.cmml"><mo id="S3.F1.8.m3.1.2.3.2.1" stretchy="false" xref="S3.F1.8.m3.1.2.cmml">(</mo><mo id="S3.F1.8.m3.1.1" lspace="0em" rspace="0em" xref="S3.F1.8.m3.1.1.cmml">⋅</mo><mo id="S3.F1.8.m3.1.2.3.2.2" stretchy="false" xref="S3.F1.8.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F1.8.m3.1c"><apply id="S3.F1.8.m3.1.2.cmml" xref="S3.F1.8.m3.1.2"><times id="S3.F1.8.m3.1.2.1.cmml" xref="S3.F1.8.m3.1.2.1"></times><ci id="S3.F1.8.m3.1.2.2.cmml" xref="S3.F1.8.m3.1.2.2">𝑔</ci><ci id="S3.F1.8.m3.1.1.cmml" xref="S3.F1.8.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.8.m3.1d">g(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.F1.8.m3.1e">italic_g ( ⋅ )</annotation></semantics></math>. The corrector network is trained to approximate how the targets are transformed from <math alttext="g^{\prime}(\cdot)" class="ltx_Math" display="inline" id="S3.F1.9.m4.1"><semantics id="S3.F1.9.m4.1b"><mrow id="S3.F1.9.m4.1.2" xref="S3.F1.9.m4.1.2.cmml"><msup id="S3.F1.9.m4.1.2.2" xref="S3.F1.9.m4.1.2.2.cmml"><mi id="S3.F1.9.m4.1.2.2.2" xref="S3.F1.9.m4.1.2.2.2.cmml">g</mi><mo id="S3.F1.9.m4.1.2.2.3" xref="S3.F1.9.m4.1.2.2.3.cmml">′</mo></msup><mo id="S3.F1.9.m4.1.2.1" xref="S3.F1.9.m4.1.2.1.cmml">⁢</mo><mrow id="S3.F1.9.m4.1.2.3.2" xref="S3.F1.9.m4.1.2.cmml"><mo id="S3.F1.9.m4.1.2.3.2.1" stretchy="false" xref="S3.F1.9.m4.1.2.cmml">(</mo><mo id="S3.F1.9.m4.1.1" lspace="0em" rspace="0em" xref="S3.F1.9.m4.1.1.cmml">⋅</mo><mo id="S3.F1.9.m4.1.2.3.2.2" stretchy="false" xref="S3.F1.9.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F1.9.m4.1c"><apply id="S3.F1.9.m4.1.2.cmml" xref="S3.F1.9.m4.1.2"><times id="S3.F1.9.m4.1.2.1.cmml" xref="S3.F1.9.m4.1.2.1"></times><apply id="S3.F1.9.m4.1.2.2.cmml" xref="S3.F1.9.m4.1.2.2"><csymbol cd="ambiguous" id="S3.F1.9.m4.1.2.2.1.cmml" xref="S3.F1.9.m4.1.2.2">superscript</csymbol><ci id="S3.F1.9.m4.1.2.2.2.cmml" xref="S3.F1.9.m4.1.2.2.2">𝑔</ci><ci id="S3.F1.9.m4.1.2.2.3.cmml" xref="S3.F1.9.m4.1.2.2.3">′</ci></apply><ci id="S3.F1.9.m4.1.1.cmml" xref="S3.F1.9.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.9.m4.1d">g^{\prime}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.F1.9.m4.1e">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( ⋅ )</annotation></semantics></math> to <math alttext="g(\cdot)" class="ltx_Math" display="inline" id="S3.F1.10.m5.1"><semantics id="S3.F1.10.m5.1b"><mrow id="S3.F1.10.m5.1.2" xref="S3.F1.10.m5.1.2.cmml"><mi id="S3.F1.10.m5.1.2.2" xref="S3.F1.10.m5.1.2.2.cmml">g</mi><mo id="S3.F1.10.m5.1.2.1" xref="S3.F1.10.m5.1.2.1.cmml">⁢</mo><mrow id="S3.F1.10.m5.1.2.3.2" xref="S3.F1.10.m5.1.2.cmml"><mo id="S3.F1.10.m5.1.2.3.2.1" stretchy="false" xref="S3.F1.10.m5.1.2.cmml">(</mo><mo id="S3.F1.10.m5.1.1" lspace="0em" rspace="0em" xref="S3.F1.10.m5.1.1.cmml">⋅</mo><mo id="S3.F1.10.m5.1.2.3.2.2" stretchy="false" xref="S3.F1.10.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F1.10.m5.1c"><apply id="S3.F1.10.m5.1.2.cmml" xref="S3.F1.10.m5.1.2"><times id="S3.F1.10.m5.1.2.1.cmml" xref="S3.F1.10.m5.1.2.1"></times><ci id="S3.F1.10.m5.1.2.2.cmml" xref="S3.F1.10.m5.1.2.2">𝑔</ci><ci id="S3.F1.10.m5.1.1.cmml" xref="S3.F1.10.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.10.m5.1d">g(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.F1.10.m5.1e">italic_g ( ⋅ )</annotation></semantics></math>.</figcaption>
</figure>
<div class="ltx_para" id="S3.p4">
<p class="ltx_p" id="S3.p4.9"><span class="ltx_text ltx_font_bold" id="S3.p4.9.1">Warmup: Training the corrector network in isolation </span>
We begin by considering how we would train only the parameters of the target corrector network, independently of the dual-encoders <math alttext="f(x)" class="ltx_Math" display="inline" id="S3.p4.1.m1.1"><semantics id="S3.p4.1.m1.1a"><mrow id="S3.p4.1.m1.1.2" xref="S3.p4.1.m1.1.2.cmml"><mi id="S3.p4.1.m1.1.2.2" xref="S3.p4.1.m1.1.2.2.cmml">f</mi><mo id="S3.p4.1.m1.1.2.1" xref="S3.p4.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.p4.1.m1.1.2.3.2" xref="S3.p4.1.m1.1.2.cmml"><mo id="S3.p4.1.m1.1.2.3.2.1" stretchy="false" xref="S3.p4.1.m1.1.2.cmml">(</mo><mi id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml">x</mi><mo id="S3.p4.1.m1.1.2.3.2.2" stretchy="false" xref="S3.p4.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><apply id="S3.p4.1.m1.1.2.cmml" xref="S3.p4.1.m1.1.2"><times id="S3.p4.1.m1.1.2.1.cmml" xref="S3.p4.1.m1.1.2.1"></times><ci id="S3.p4.1.m1.1.2.2.cmml" xref="S3.p4.1.m1.1.2.2">𝑓</ci><ci id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">f(x)</annotation><annotation encoding="application/x-llamapun" id="S3.p4.1.m1.1d">italic_f ( italic_x )</annotation></semantics></math> and <math alttext="g(y)" class="ltx_Math" display="inline" id="S3.p4.2.m2.1"><semantics id="S3.p4.2.m2.1a"><mrow id="S3.p4.2.m2.1.2" xref="S3.p4.2.m2.1.2.cmml"><mi id="S3.p4.2.m2.1.2.2" xref="S3.p4.2.m2.1.2.2.cmml">g</mi><mo id="S3.p4.2.m2.1.2.1" xref="S3.p4.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.p4.2.m2.1.2.3.2" xref="S3.p4.2.m2.1.2.cmml"><mo id="S3.p4.2.m2.1.2.3.2.1" stretchy="false" xref="S3.p4.2.m2.1.2.cmml">(</mo><mi id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml">y</mi><mo id="S3.p4.2.m2.1.2.3.2.2" stretchy="false" xref="S3.p4.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.1b"><apply id="S3.p4.2.m2.1.2.cmml" xref="S3.p4.2.m2.1.2"><times id="S3.p4.2.m2.1.2.1.cmml" xref="S3.p4.2.m2.1.2.1"></times><ci id="S3.p4.2.m2.1.2.2.cmml" xref="S3.p4.2.m2.1.2.2">𝑔</ci><ci id="S3.p4.2.m2.1.1.cmml" xref="S3.p4.2.m2.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.1c">g(y)</annotation><annotation encoding="application/x-llamapun" id="S3.p4.2.m2.1d">italic_g ( italic_y )</annotation></semantics></math>. Afterwards, we present an algorithm for jointly training the target corrector network and the dual-encoders.
To train the parameters <math alttext="\Psi" class="ltx_Math" display="inline" id="S3.p4.3.m3.1"><semantics id="S3.p4.3.m3.1a"><mi id="S3.p4.3.m3.1.1" mathvariant="normal" xref="S3.p4.3.m3.1.1.cmml">Ψ</mi><annotation-xml encoding="MathML-Content" id="S3.p4.3.m3.1b"><ci id="S3.p4.3.m3.1.1.cmml" xref="S3.p4.3.m3.1.1">Ψ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.m3.1c">\Psi</annotation><annotation encoding="application/x-llamapun" id="S3.p4.3.m3.1d">roman_Ψ</annotation></semantics></math> of the corrector network, <math alttext="h(\cdot;\Psi)" class="ltx_Math" display="inline" id="S3.p4.4.m4.2"><semantics id="S3.p4.4.m4.2a"><mrow id="S3.p4.4.m4.2.3" xref="S3.p4.4.m4.2.3.cmml"><mi id="S3.p4.4.m4.2.3.2" xref="S3.p4.4.m4.2.3.2.cmml">h</mi><mo id="S3.p4.4.m4.2.3.1" xref="S3.p4.4.m4.2.3.1.cmml">⁢</mo><mrow id="S3.p4.4.m4.2.3.3.2" xref="S3.p4.4.m4.2.3.3.1.cmml"><mo id="S3.p4.4.m4.2.3.3.2.1" stretchy="false" xref="S3.p4.4.m4.2.3.3.1.cmml">(</mo><mo id="S3.p4.4.m4.1.1" lspace="0em" rspace="0em" xref="S3.p4.4.m4.1.1.cmml">⋅</mo><mo id="S3.p4.4.m4.2.3.3.2.2" xref="S3.p4.4.m4.2.3.3.1.cmml">;</mo><mi id="S3.p4.4.m4.2.2" mathvariant="normal" xref="S3.p4.4.m4.2.2.cmml">Ψ</mi><mo id="S3.p4.4.m4.2.3.3.2.3" stretchy="false" xref="S3.p4.4.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.4.m4.2b"><apply id="S3.p4.4.m4.2.3.cmml" xref="S3.p4.4.m4.2.3"><times id="S3.p4.4.m4.2.3.1.cmml" xref="S3.p4.4.m4.2.3.1"></times><ci id="S3.p4.4.m4.2.3.2.cmml" xref="S3.p4.4.m4.2.3.2">ℎ</ci><list id="S3.p4.4.m4.2.3.3.1.cmml" xref="S3.p4.4.m4.2.3.3.2"><ci id="S3.p4.4.m4.1.1.cmml" xref="S3.p4.4.m4.1.1">⋅</ci><ci id="S3.p4.4.m4.2.2.cmml" xref="S3.p4.4.m4.2.2">Ψ</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.4.m4.2c">h(\cdot;\Psi)</annotation><annotation encoding="application/x-llamapun" id="S3.p4.4.m4.2d">italic_h ( ⋅ ; roman_Ψ )</annotation></semantics></math>, we collect training examples of input data points <math alttext="x_{i}" class="ltx_Math" display="inline" id="S3.p4.5.m5.1"><semantics id="S3.p4.5.m5.1a"><msub id="S3.p4.5.m5.1.1" xref="S3.p4.5.m5.1.1.cmml"><mi id="S3.p4.5.m5.1.1.2" xref="S3.p4.5.m5.1.1.2.cmml">x</mi><mi id="S3.p4.5.m5.1.1.3" xref="S3.p4.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.5.m5.1b"><apply id="S3.p4.5.m5.1.1.cmml" xref="S3.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p4.5.m5.1.1.1.cmml" xref="S3.p4.5.m5.1.1">subscript</csymbol><ci id="S3.p4.5.m5.1.1.2.cmml" xref="S3.p4.5.m5.1.1.2">𝑥</ci><ci id="S3.p4.5.m5.1.1.3.cmml" xref="S3.p4.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.5.m5.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.5.m5.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, the exact target embeddings <math alttext="g(y)" class="ltx_Math" display="inline" id="S3.p4.6.m6.1"><semantics id="S3.p4.6.m6.1a"><mrow id="S3.p4.6.m6.1.2" xref="S3.p4.6.m6.1.2.cmml"><mi id="S3.p4.6.m6.1.2.2" xref="S3.p4.6.m6.1.2.2.cmml">g</mi><mo id="S3.p4.6.m6.1.2.1" xref="S3.p4.6.m6.1.2.1.cmml">⁢</mo><mrow id="S3.p4.6.m6.1.2.3.2" xref="S3.p4.6.m6.1.2.cmml"><mo id="S3.p4.6.m6.1.2.3.2.1" stretchy="false" xref="S3.p4.6.m6.1.2.cmml">(</mo><mi id="S3.p4.6.m6.1.1" xref="S3.p4.6.m6.1.1.cmml">y</mi><mo id="S3.p4.6.m6.1.2.3.2.2" stretchy="false" xref="S3.p4.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.6.m6.1b"><apply id="S3.p4.6.m6.1.2.cmml" xref="S3.p4.6.m6.1.2"><times id="S3.p4.6.m6.1.2.1.cmml" xref="S3.p4.6.m6.1.2.1"></times><ci id="S3.p4.6.m6.1.2.2.cmml" xref="S3.p4.6.m6.1.2.2">𝑔</ci><ci id="S3.p4.6.m6.1.1.cmml" xref="S3.p4.6.m6.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.6.m6.1c">g(y)</annotation><annotation encoding="application/x-llamapun" id="S3.p4.6.m6.1d">italic_g ( italic_y )</annotation></semantics></math>, and stale embeddings <math alttext="g^{\prime}(y)" class="ltx_Math" display="inline" id="S3.p4.7.m7.1"><semantics id="S3.p4.7.m7.1a"><mrow id="S3.p4.7.m7.1.2" xref="S3.p4.7.m7.1.2.cmml"><msup id="S3.p4.7.m7.1.2.2" xref="S3.p4.7.m7.1.2.2.cmml"><mi id="S3.p4.7.m7.1.2.2.2" xref="S3.p4.7.m7.1.2.2.2.cmml">g</mi><mo id="S3.p4.7.m7.1.2.2.3" xref="S3.p4.7.m7.1.2.2.3.cmml">′</mo></msup><mo id="S3.p4.7.m7.1.2.1" xref="S3.p4.7.m7.1.2.1.cmml">⁢</mo><mrow id="S3.p4.7.m7.1.2.3.2" xref="S3.p4.7.m7.1.2.cmml"><mo id="S3.p4.7.m7.1.2.3.2.1" stretchy="false" xref="S3.p4.7.m7.1.2.cmml">(</mo><mi id="S3.p4.7.m7.1.1" xref="S3.p4.7.m7.1.1.cmml">y</mi><mo id="S3.p4.7.m7.1.2.3.2.2" stretchy="false" xref="S3.p4.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.7.m7.1b"><apply id="S3.p4.7.m7.1.2.cmml" xref="S3.p4.7.m7.1.2"><times id="S3.p4.7.m7.1.2.1.cmml" xref="S3.p4.7.m7.1.2.1"></times><apply id="S3.p4.7.m7.1.2.2.cmml" xref="S3.p4.7.m7.1.2.2"><csymbol cd="ambiguous" id="S3.p4.7.m7.1.2.2.1.cmml" xref="S3.p4.7.m7.1.2.2">superscript</csymbol><ci id="S3.p4.7.m7.1.2.2.2.cmml" xref="S3.p4.7.m7.1.2.2.2">𝑔</ci><ci id="S3.p4.7.m7.1.2.2.3.cmml" xref="S3.p4.7.m7.1.2.2.3">′</ci></apply><ci id="S3.p4.7.m7.1.1.cmml" xref="S3.p4.7.m7.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.7.m7.1c">g^{\prime}(y)</annotation><annotation encoding="application/x-llamapun" id="S3.p4.7.m7.1d">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y )</annotation></semantics></math> for a subset of targets <math alttext="S(\mathcal{Y})_{i}\subset\mathcal{Y}" class="ltx_Math" display="inline" id="S3.p4.8.m8.1"><semantics id="S3.p4.8.m8.1a"><mrow id="S3.p4.8.m8.1.2" xref="S3.p4.8.m8.1.2.cmml"><mrow id="S3.p4.8.m8.1.2.2" xref="S3.p4.8.m8.1.2.2.cmml"><mi id="S3.p4.8.m8.1.2.2.2" xref="S3.p4.8.m8.1.2.2.2.cmml">S</mi><mo id="S3.p4.8.m8.1.2.2.1" xref="S3.p4.8.m8.1.2.2.1.cmml">⁢</mo><msub id="S3.p4.8.m8.1.2.2.3" xref="S3.p4.8.m8.1.2.2.3.cmml"><mrow id="S3.p4.8.m8.1.2.2.3.2.2" xref="S3.p4.8.m8.1.2.2.3.cmml"><mo id="S3.p4.8.m8.1.2.2.3.2.2.1" stretchy="false" xref="S3.p4.8.m8.1.2.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.p4.8.m8.1.1" xref="S3.p4.8.m8.1.1.cmml">𝒴</mi><mo id="S3.p4.8.m8.1.2.2.3.2.2.2" stretchy="false" xref="S3.p4.8.m8.1.2.2.3.cmml">)</mo></mrow><mi id="S3.p4.8.m8.1.2.2.3.3" xref="S3.p4.8.m8.1.2.2.3.3.cmml">i</mi></msub></mrow><mo id="S3.p4.8.m8.1.2.1" xref="S3.p4.8.m8.1.2.1.cmml">⊂</mo><mi class="ltx_font_mathcaligraphic" id="S3.p4.8.m8.1.2.3" xref="S3.p4.8.m8.1.2.3.cmml">𝒴</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.8.m8.1b"><apply id="S3.p4.8.m8.1.2.cmml" xref="S3.p4.8.m8.1.2"><subset id="S3.p4.8.m8.1.2.1.cmml" xref="S3.p4.8.m8.1.2.1"></subset><apply id="S3.p4.8.m8.1.2.2.cmml" xref="S3.p4.8.m8.1.2.2"><times id="S3.p4.8.m8.1.2.2.1.cmml" xref="S3.p4.8.m8.1.2.2.1"></times><ci id="S3.p4.8.m8.1.2.2.2.cmml" xref="S3.p4.8.m8.1.2.2.2">𝑆</ci><apply id="S3.p4.8.m8.1.2.2.3.cmml" xref="S3.p4.8.m8.1.2.2.3"><csymbol cd="ambiguous" id="S3.p4.8.m8.1.2.2.3.1.cmml" xref="S3.p4.8.m8.1.2.2.3">subscript</csymbol><ci id="S3.p4.8.m8.1.1.cmml" xref="S3.p4.8.m8.1.1">𝒴</ci><ci id="S3.p4.8.m8.1.2.2.3.3.cmml" xref="S3.p4.8.m8.1.2.2.3.3">𝑖</ci></apply></apply><ci id="S3.p4.8.m8.1.2.3.cmml" xref="S3.p4.8.m8.1.2.3">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.8.m8.1c">S(\mathcal{Y})_{i}\subset\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.8.m8.1d">italic_S ( caligraphic_Y ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⊂ caligraphic_Y</annotation></semantics></math>, i.e., <math alttext="\{(f(x_{i}),g(y_{b}),g^{\prime}(y_{b}))\ |\ y_{b}\in S(\mathcal{Y})_{i}\}" class="ltx_Math" display="inline" id="S3.p4.9.m9.3"><semantics id="S3.p4.9.m9.3a"><mrow id="S3.p4.9.m9.3.3.2" xref="S3.p4.9.m9.3.3.3.cmml"><mo id="S3.p4.9.m9.3.3.2.3" stretchy="false" xref="S3.p4.9.m9.3.3.3.1.cmml">{</mo><mrow id="S3.p4.9.m9.2.2.1.1.3" xref="S3.p4.9.m9.2.2.1.1.4.cmml"><mo id="S3.p4.9.m9.2.2.1.1.3.4" stretchy="false" xref="S3.p4.9.m9.2.2.1.1.4.cmml">(</mo><mrow id="S3.p4.9.m9.2.2.1.1.1.1" xref="S3.p4.9.m9.2.2.1.1.1.1.cmml"><mi id="S3.p4.9.m9.2.2.1.1.1.1.3" xref="S3.p4.9.m9.2.2.1.1.1.1.3.cmml">f</mi><mo id="S3.p4.9.m9.2.2.1.1.1.1.2" xref="S3.p4.9.m9.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.p4.9.m9.2.2.1.1.1.1.1.1" xref="S3.p4.9.m9.2.2.1.1.1.1.1.1.1.cmml"><mo id="S3.p4.9.m9.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.p4.9.m9.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.p4.9.m9.2.2.1.1.1.1.1.1.1" xref="S3.p4.9.m9.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.p4.9.m9.2.2.1.1.1.1.1.1.1.2" xref="S3.p4.9.m9.2.2.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.p4.9.m9.2.2.1.1.1.1.1.1.1.3" xref="S3.p4.9.m9.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.p4.9.m9.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S3.p4.9.m9.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.p4.9.m9.2.2.1.1.3.5" xref="S3.p4.9.m9.2.2.1.1.4.cmml">,</mo><mrow id="S3.p4.9.m9.2.2.1.1.2.2" xref="S3.p4.9.m9.2.2.1.1.2.2.cmml"><mi id="S3.p4.9.m9.2.2.1.1.2.2.3" xref="S3.p4.9.m9.2.2.1.1.2.2.3.cmml">g</mi><mo id="S3.p4.9.m9.2.2.1.1.2.2.2" xref="S3.p4.9.m9.2.2.1.1.2.2.2.cmml">⁢</mo><mrow id="S3.p4.9.m9.2.2.1.1.2.2.1.1" xref="S3.p4.9.m9.2.2.1.1.2.2.1.1.1.cmml"><mo id="S3.p4.9.m9.2.2.1.1.2.2.1.1.2" stretchy="false" xref="S3.p4.9.m9.2.2.1.1.2.2.1.1.1.cmml">(</mo><msub id="S3.p4.9.m9.2.2.1.1.2.2.1.1.1" xref="S3.p4.9.m9.2.2.1.1.2.2.1.1.1.cmml"><mi id="S3.p4.9.m9.2.2.1.1.2.2.1.1.1.2" xref="S3.p4.9.m9.2.2.1.1.2.2.1.1.1.2.cmml">y</mi><mi id="S3.p4.9.m9.2.2.1.1.2.2.1.1.1.3" xref="S3.p4.9.m9.2.2.1.1.2.2.1.1.1.3.cmml">b</mi></msub><mo id="S3.p4.9.m9.2.2.1.1.2.2.1.1.3" stretchy="false" xref="S3.p4.9.m9.2.2.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.p4.9.m9.2.2.1.1.3.6" xref="S3.p4.9.m9.2.2.1.1.4.cmml">,</mo><mrow id="S3.p4.9.m9.2.2.1.1.3.3" xref="S3.p4.9.m9.2.2.1.1.3.3.cmml"><msup id="S3.p4.9.m9.2.2.1.1.3.3.3" xref="S3.p4.9.m9.2.2.1.1.3.3.3.cmml"><mi id="S3.p4.9.m9.2.2.1.1.3.3.3.2" xref="S3.p4.9.m9.2.2.1.1.3.3.3.2.cmml">g</mi><mo id="S3.p4.9.m9.2.2.1.1.3.3.3.3" xref="S3.p4.9.m9.2.2.1.1.3.3.3.3.cmml">′</mo></msup><mo id="S3.p4.9.m9.2.2.1.1.3.3.2" xref="S3.p4.9.m9.2.2.1.1.3.3.2.cmml">⁢</mo><mrow id="S3.p4.9.m9.2.2.1.1.3.3.1.1" xref="S3.p4.9.m9.2.2.1.1.3.3.1.1.1.cmml"><mo id="S3.p4.9.m9.2.2.1.1.3.3.1.1.2" stretchy="false" xref="S3.p4.9.m9.2.2.1.1.3.3.1.1.1.cmml">(</mo><msub id="S3.p4.9.m9.2.2.1.1.3.3.1.1.1" xref="S3.p4.9.m9.2.2.1.1.3.3.1.1.1.cmml"><mi id="S3.p4.9.m9.2.2.1.1.3.3.1.1.1.2" xref="S3.p4.9.m9.2.2.1.1.3.3.1.1.1.2.cmml">y</mi><mi id="S3.p4.9.m9.2.2.1.1.3.3.1.1.1.3" xref="S3.p4.9.m9.2.2.1.1.3.3.1.1.1.3.cmml">b</mi></msub><mo id="S3.p4.9.m9.2.2.1.1.3.3.1.1.3" stretchy="false" xref="S3.p4.9.m9.2.2.1.1.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.p4.9.m9.2.2.1.1.3.7" rspace="0.222em" stretchy="false" xref="S3.p4.9.m9.2.2.1.1.4.cmml">)</mo></mrow><mo id="S3.p4.9.m9.3.3.2.4" rspace="0.500em" xref="S3.p4.9.m9.3.3.3.1.cmml">|</mo><mrow id="S3.p4.9.m9.3.3.2.2" xref="S3.p4.9.m9.3.3.2.2.cmml"><msub id="S3.p4.9.m9.3.3.2.2.2" xref="S3.p4.9.m9.3.3.2.2.2.cmml"><mi id="S3.p4.9.m9.3.3.2.2.2.2" xref="S3.p4.9.m9.3.3.2.2.2.2.cmml">y</mi><mi id="S3.p4.9.m9.3.3.2.2.2.3" xref="S3.p4.9.m9.3.3.2.2.2.3.cmml">b</mi></msub><mo id="S3.p4.9.m9.3.3.2.2.1" xref="S3.p4.9.m9.3.3.2.2.1.cmml">∈</mo><mrow id="S3.p4.9.m9.3.3.2.2.3" xref="S3.p4.9.m9.3.3.2.2.3.cmml"><mi id="S3.p4.9.m9.3.3.2.2.3.2" xref="S3.p4.9.m9.3.3.2.2.3.2.cmml">S</mi><mo id="S3.p4.9.m9.3.3.2.2.3.1" xref="S3.p4.9.m9.3.3.2.2.3.1.cmml">⁢</mo><msub id="S3.p4.9.m9.3.3.2.2.3.3" xref="S3.p4.9.m9.3.3.2.2.3.3.cmml"><mrow id="S3.p4.9.m9.3.3.2.2.3.3.2.2" xref="S3.p4.9.m9.3.3.2.2.3.3.cmml"><mo id="S3.p4.9.m9.3.3.2.2.3.3.2.2.1" stretchy="false" xref="S3.p4.9.m9.3.3.2.2.3.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.p4.9.m9.1.1" xref="S3.p4.9.m9.1.1.cmml">𝒴</mi><mo id="S3.p4.9.m9.3.3.2.2.3.3.2.2.2" stretchy="false" xref="S3.p4.9.m9.3.3.2.2.3.3.cmml">)</mo></mrow><mi id="S3.p4.9.m9.3.3.2.2.3.3.3" xref="S3.p4.9.m9.3.3.2.2.3.3.3.cmml">i</mi></msub></mrow></mrow><mo id="S3.p4.9.m9.3.3.2.5" stretchy="false" xref="S3.p4.9.m9.3.3.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.9.m9.3b"><apply id="S3.p4.9.m9.3.3.3.cmml" xref="S3.p4.9.m9.3.3.2"><csymbol cd="latexml" id="S3.p4.9.m9.3.3.3.1.cmml" xref="S3.p4.9.m9.3.3.2.3">conditional-set</csymbol><vector id="S3.p4.9.m9.2.2.1.1.4.cmml" xref="S3.p4.9.m9.2.2.1.1.3"><apply id="S3.p4.9.m9.2.2.1.1.1.1.cmml" xref="S3.p4.9.m9.2.2.1.1.1.1"><times id="S3.p4.9.m9.2.2.1.1.1.1.2.cmml" xref="S3.p4.9.m9.2.2.1.1.1.1.2"></times><ci id="S3.p4.9.m9.2.2.1.1.1.1.3.cmml" xref="S3.p4.9.m9.2.2.1.1.1.1.3">𝑓</ci><apply id="S3.p4.9.m9.2.2.1.1.1.1.1.1.1.cmml" xref="S3.p4.9.m9.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p4.9.m9.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.p4.9.m9.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p4.9.m9.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.p4.9.m9.2.2.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.p4.9.m9.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.p4.9.m9.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.p4.9.m9.2.2.1.1.2.2.cmml" xref="S3.p4.9.m9.2.2.1.1.2.2"><times id="S3.p4.9.m9.2.2.1.1.2.2.2.cmml" xref="S3.p4.9.m9.2.2.1.1.2.2.2"></times><ci id="S3.p4.9.m9.2.2.1.1.2.2.3.cmml" xref="S3.p4.9.m9.2.2.1.1.2.2.3">𝑔</ci><apply id="S3.p4.9.m9.2.2.1.1.2.2.1.1.1.cmml" xref="S3.p4.9.m9.2.2.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S3.p4.9.m9.2.2.1.1.2.2.1.1.1.1.cmml" xref="S3.p4.9.m9.2.2.1.1.2.2.1.1">subscript</csymbol><ci id="S3.p4.9.m9.2.2.1.1.2.2.1.1.1.2.cmml" xref="S3.p4.9.m9.2.2.1.1.2.2.1.1.1.2">𝑦</ci><ci id="S3.p4.9.m9.2.2.1.1.2.2.1.1.1.3.cmml" xref="S3.p4.9.m9.2.2.1.1.2.2.1.1.1.3">𝑏</ci></apply></apply><apply id="S3.p4.9.m9.2.2.1.1.3.3.cmml" xref="S3.p4.9.m9.2.2.1.1.3.3"><times id="S3.p4.9.m9.2.2.1.1.3.3.2.cmml" xref="S3.p4.9.m9.2.2.1.1.3.3.2"></times><apply id="S3.p4.9.m9.2.2.1.1.3.3.3.cmml" xref="S3.p4.9.m9.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.p4.9.m9.2.2.1.1.3.3.3.1.cmml" xref="S3.p4.9.m9.2.2.1.1.3.3.3">superscript</csymbol><ci id="S3.p4.9.m9.2.2.1.1.3.3.3.2.cmml" xref="S3.p4.9.m9.2.2.1.1.3.3.3.2">𝑔</ci><ci id="S3.p4.9.m9.2.2.1.1.3.3.3.3.cmml" xref="S3.p4.9.m9.2.2.1.1.3.3.3.3">′</ci></apply><apply id="S3.p4.9.m9.2.2.1.1.3.3.1.1.1.cmml" xref="S3.p4.9.m9.2.2.1.1.3.3.1.1"><csymbol cd="ambiguous" id="S3.p4.9.m9.2.2.1.1.3.3.1.1.1.1.cmml" xref="S3.p4.9.m9.2.2.1.1.3.3.1.1">subscript</csymbol><ci id="S3.p4.9.m9.2.2.1.1.3.3.1.1.1.2.cmml" xref="S3.p4.9.m9.2.2.1.1.3.3.1.1.1.2">𝑦</ci><ci id="S3.p4.9.m9.2.2.1.1.3.3.1.1.1.3.cmml" xref="S3.p4.9.m9.2.2.1.1.3.3.1.1.1.3">𝑏</ci></apply></apply></vector><apply id="S3.p4.9.m9.3.3.2.2.cmml" xref="S3.p4.9.m9.3.3.2.2"><in id="S3.p4.9.m9.3.3.2.2.1.cmml" xref="S3.p4.9.m9.3.3.2.2.1"></in><apply id="S3.p4.9.m9.3.3.2.2.2.cmml" xref="S3.p4.9.m9.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p4.9.m9.3.3.2.2.2.1.cmml" xref="S3.p4.9.m9.3.3.2.2.2">subscript</csymbol><ci id="S3.p4.9.m9.3.3.2.2.2.2.cmml" xref="S3.p4.9.m9.3.3.2.2.2.2">𝑦</ci><ci id="S3.p4.9.m9.3.3.2.2.2.3.cmml" xref="S3.p4.9.m9.3.3.2.2.2.3">𝑏</ci></apply><apply id="S3.p4.9.m9.3.3.2.2.3.cmml" xref="S3.p4.9.m9.3.3.2.2.3"><times id="S3.p4.9.m9.3.3.2.2.3.1.cmml" xref="S3.p4.9.m9.3.3.2.2.3.1"></times><ci id="S3.p4.9.m9.3.3.2.2.3.2.cmml" xref="S3.p4.9.m9.3.3.2.2.3.2">𝑆</ci><apply id="S3.p4.9.m9.3.3.2.2.3.3.cmml" xref="S3.p4.9.m9.3.3.2.2.3.3"><csymbol cd="ambiguous" id="S3.p4.9.m9.3.3.2.2.3.3.1.cmml" xref="S3.p4.9.m9.3.3.2.2.3.3">subscript</csymbol><ci id="S3.p4.9.m9.1.1.cmml" xref="S3.p4.9.m9.1.1">𝒴</ci><ci id="S3.p4.9.m9.3.3.2.2.3.3.3.cmml" xref="S3.p4.9.m9.3.3.2.2.3.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.9.m9.3c">\{(f(x_{i}),g(y_{b}),g^{\prime}(y_{b}))\ |\ y_{b}\in S(\mathcal{Y})_{i}\}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.9.m9.3d">{ ( italic_f ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_g ( italic_y start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ) , italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ) ) | italic_y start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ∈ italic_S ( caligraphic_Y ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT }</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.p5">
<p class="ltx_p" id="S3.p5.5">We consider two loss functions for training <math alttext="h" class="ltx_Math" display="inline" id="S3.p5.1.m1.1"><semantics id="S3.p5.1.m1.1a"><mi id="S3.p5.1.m1.1.1" xref="S3.p5.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.p5.1.m1.1b"><ci id="S3.p5.1.m1.1.1.cmml" xref="S3.p5.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.1.m1.1c">h</annotation><annotation encoding="application/x-llamapun" id="S3.p5.1.m1.1d">italic_h</annotation></semantics></math>: the mean-squared error between representations given by <math alttext="g(y)" class="ltx_Math" display="inline" id="S3.p5.2.m2.1"><semantics id="S3.p5.2.m2.1a"><mrow id="S3.p5.2.m2.1.2" xref="S3.p5.2.m2.1.2.cmml"><mi id="S3.p5.2.m2.1.2.2" xref="S3.p5.2.m2.1.2.2.cmml">g</mi><mo id="S3.p5.2.m2.1.2.1" xref="S3.p5.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.p5.2.m2.1.2.3.2" xref="S3.p5.2.m2.1.2.cmml"><mo id="S3.p5.2.m2.1.2.3.2.1" stretchy="false" xref="S3.p5.2.m2.1.2.cmml">(</mo><mi id="S3.p5.2.m2.1.1" xref="S3.p5.2.m2.1.1.cmml">y</mi><mo id="S3.p5.2.m2.1.2.3.2.2" stretchy="false" xref="S3.p5.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.2.m2.1b"><apply id="S3.p5.2.m2.1.2.cmml" xref="S3.p5.2.m2.1.2"><times id="S3.p5.2.m2.1.2.1.cmml" xref="S3.p5.2.m2.1.2.1"></times><ci id="S3.p5.2.m2.1.2.2.cmml" xref="S3.p5.2.m2.1.2.2">𝑔</ci><ci id="S3.p5.2.m2.1.1.cmml" xref="S3.p5.2.m2.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.2.m2.1c">g(y)</annotation><annotation encoding="application/x-llamapun" id="S3.p5.2.m2.1d">italic_g ( italic_y )</annotation></semantics></math> and the corrected representations <math alttext="h\circ g^{\prime}(y)" class="ltx_Math" display="inline" id="S3.p5.3.m3.1"><semantics id="S3.p5.3.m3.1a"><mrow id="S3.p5.3.m3.1.2" xref="S3.p5.3.m3.1.2.cmml"><mrow id="S3.p5.3.m3.1.2.2" xref="S3.p5.3.m3.1.2.2.cmml"><mi id="S3.p5.3.m3.1.2.2.2" xref="S3.p5.3.m3.1.2.2.2.cmml">h</mi><mo id="S3.p5.3.m3.1.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.p5.3.m3.1.2.2.1.cmml">∘</mo><msup id="S3.p5.3.m3.1.2.2.3" xref="S3.p5.3.m3.1.2.2.3.cmml"><mi id="S3.p5.3.m3.1.2.2.3.2" xref="S3.p5.3.m3.1.2.2.3.2.cmml">g</mi><mo id="S3.p5.3.m3.1.2.2.3.3" xref="S3.p5.3.m3.1.2.2.3.3.cmml">′</mo></msup></mrow><mo id="S3.p5.3.m3.1.2.1" xref="S3.p5.3.m3.1.2.1.cmml">⁢</mo><mrow id="S3.p5.3.m3.1.2.3.2" xref="S3.p5.3.m3.1.2.cmml"><mo id="S3.p5.3.m3.1.2.3.2.1" stretchy="false" xref="S3.p5.3.m3.1.2.cmml">(</mo><mi id="S3.p5.3.m3.1.1" xref="S3.p5.3.m3.1.1.cmml">y</mi><mo id="S3.p5.3.m3.1.2.3.2.2" stretchy="false" xref="S3.p5.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.3.m3.1b"><apply id="S3.p5.3.m3.1.2.cmml" xref="S3.p5.3.m3.1.2"><times id="S3.p5.3.m3.1.2.1.cmml" xref="S3.p5.3.m3.1.2.1"></times><apply id="S3.p5.3.m3.1.2.2.cmml" xref="S3.p5.3.m3.1.2.2"><compose id="S3.p5.3.m3.1.2.2.1.cmml" xref="S3.p5.3.m3.1.2.2.1"></compose><ci id="S3.p5.3.m3.1.2.2.2.cmml" xref="S3.p5.3.m3.1.2.2.2">ℎ</ci><apply id="S3.p5.3.m3.1.2.2.3.cmml" xref="S3.p5.3.m3.1.2.2.3"><csymbol cd="ambiguous" id="S3.p5.3.m3.1.2.2.3.1.cmml" xref="S3.p5.3.m3.1.2.2.3">superscript</csymbol><ci id="S3.p5.3.m3.1.2.2.3.2.cmml" xref="S3.p5.3.m3.1.2.2.3.2">𝑔</ci><ci id="S3.p5.3.m3.1.2.2.3.3.cmml" xref="S3.p5.3.m3.1.2.2.3.3">′</ci></apply></apply><ci id="S3.p5.3.m3.1.1.cmml" xref="S3.p5.3.m3.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.3.m3.1c">h\circ g^{\prime}(y)</annotation><annotation encoding="application/x-llamapun" id="S3.p5.3.m3.1d">italic_h ∘ italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y )</annotation></semantics></math> (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S3.E5" title="In 3 Improving Training with Target Correctors ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">5</span></a>) and the cross entropy loss between the truncated softmax using <math alttext="g(y)" class="ltx_Math" display="inline" id="S3.p5.4.m4.1"><semantics id="S3.p5.4.m4.1a"><mrow id="S3.p5.4.m4.1.2" xref="S3.p5.4.m4.1.2.cmml"><mi id="S3.p5.4.m4.1.2.2" xref="S3.p5.4.m4.1.2.2.cmml">g</mi><mo id="S3.p5.4.m4.1.2.1" xref="S3.p5.4.m4.1.2.1.cmml">⁢</mo><mrow id="S3.p5.4.m4.1.2.3.2" xref="S3.p5.4.m4.1.2.cmml"><mo id="S3.p5.4.m4.1.2.3.2.1" stretchy="false" xref="S3.p5.4.m4.1.2.cmml">(</mo><mi id="S3.p5.4.m4.1.1" xref="S3.p5.4.m4.1.1.cmml">y</mi><mo id="S3.p5.4.m4.1.2.3.2.2" stretchy="false" xref="S3.p5.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.4.m4.1b"><apply id="S3.p5.4.m4.1.2.cmml" xref="S3.p5.4.m4.1.2"><times id="S3.p5.4.m4.1.2.1.cmml" xref="S3.p5.4.m4.1.2.1"></times><ci id="S3.p5.4.m4.1.2.2.cmml" xref="S3.p5.4.m4.1.2.2">𝑔</ci><ci id="S3.p5.4.m4.1.1.cmml" xref="S3.p5.4.m4.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.4.m4.1c">g(y)</annotation><annotation encoding="application/x-llamapun" id="S3.p5.4.m4.1d">italic_g ( italic_y )</annotation></semantics></math> and truncated softmax using <math alttext="h\circ g^{\prime}(y)" class="ltx_Math" display="inline" id="S3.p5.5.m5.1"><semantics id="S3.p5.5.m5.1a"><mrow id="S3.p5.5.m5.1.2" xref="S3.p5.5.m5.1.2.cmml"><mrow id="S3.p5.5.m5.1.2.2" xref="S3.p5.5.m5.1.2.2.cmml"><mi id="S3.p5.5.m5.1.2.2.2" xref="S3.p5.5.m5.1.2.2.2.cmml">h</mi><mo id="S3.p5.5.m5.1.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.p5.5.m5.1.2.2.1.cmml">∘</mo><msup id="S3.p5.5.m5.1.2.2.3" xref="S3.p5.5.m5.1.2.2.3.cmml"><mi id="S3.p5.5.m5.1.2.2.3.2" xref="S3.p5.5.m5.1.2.2.3.2.cmml">g</mi><mo id="S3.p5.5.m5.1.2.2.3.3" xref="S3.p5.5.m5.1.2.2.3.3.cmml">′</mo></msup></mrow><mo id="S3.p5.5.m5.1.2.1" xref="S3.p5.5.m5.1.2.1.cmml">⁢</mo><mrow id="S3.p5.5.m5.1.2.3.2" xref="S3.p5.5.m5.1.2.cmml"><mo id="S3.p5.5.m5.1.2.3.2.1" stretchy="false" xref="S3.p5.5.m5.1.2.cmml">(</mo><mi id="S3.p5.5.m5.1.1" xref="S3.p5.5.m5.1.1.cmml">y</mi><mo id="S3.p5.5.m5.1.2.3.2.2" stretchy="false" xref="S3.p5.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.5.m5.1b"><apply id="S3.p5.5.m5.1.2.cmml" xref="S3.p5.5.m5.1.2"><times id="S3.p5.5.m5.1.2.1.cmml" xref="S3.p5.5.m5.1.2.1"></times><apply id="S3.p5.5.m5.1.2.2.cmml" xref="S3.p5.5.m5.1.2.2"><compose id="S3.p5.5.m5.1.2.2.1.cmml" xref="S3.p5.5.m5.1.2.2.1"></compose><ci id="S3.p5.5.m5.1.2.2.2.cmml" xref="S3.p5.5.m5.1.2.2.2">ℎ</ci><apply id="S3.p5.5.m5.1.2.2.3.cmml" xref="S3.p5.5.m5.1.2.2.3"><csymbol cd="ambiguous" id="S3.p5.5.m5.1.2.2.3.1.cmml" xref="S3.p5.5.m5.1.2.2.3">superscript</csymbol><ci id="S3.p5.5.m5.1.2.2.3.2.cmml" xref="S3.p5.5.m5.1.2.2.3.2">𝑔</ci><ci id="S3.p5.5.m5.1.2.2.3.3.cmml" xref="S3.p5.5.m5.1.2.2.3.3">′</ci></apply></apply><ci id="S3.p5.5.m5.1.1.cmml" xref="S3.p5.5.m5.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.5.m5.1c">h\circ g^{\prime}(y)</annotation><annotation encoding="application/x-llamapun" id="S3.p5.5.m5.1d">italic_h ∘ italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y )</annotation></semantics></math> (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S3.E6" title="In 3 Improving Training with Target Correctors ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">6</span></a>):</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A2.EGx1">
<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\ell_{MSE}(y_{i})" class="ltx_Math" display="inline" id="S3.E5.m1.1"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml"><msub id="S3.E5.m1.1.1.3" xref="S3.E5.m1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.3.2" mathvariant="normal" xref="S3.E5.m1.1.1.3.2.cmml">ℓ</mi><mrow id="S3.E5.m1.1.1.3.3" xref="S3.E5.m1.1.1.3.3.cmml"><mi id="S3.E5.m1.1.1.3.3.2" xref="S3.E5.m1.1.1.3.3.2.cmml">M</mi><mo id="S3.E5.m1.1.1.3.3.1" xref="S3.E5.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.3.3.3" xref="S3.E5.m1.1.1.3.3.3.cmml">S</mi><mo id="S3.E5.m1.1.1.3.3.1a" xref="S3.E5.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.3.3.4" xref="S3.E5.m1.1.1.3.3.4.cmml">E</mi></mrow></msub><mo id="S3.E5.m1.1.1.2" xref="S3.E5.m1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.2.cmml">y</mi><mi id="S3.E5.m1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E5.m1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1"><times id="S3.E5.m1.1.1.2.cmml" xref="S3.E5.m1.1.1.2"></times><apply id="S3.E5.m1.1.1.3.cmml" xref="S3.E5.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.3.2">ℓ</ci><apply id="S3.E5.m1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.3.3"><times id="S3.E5.m1.1.1.3.3.1.cmml" xref="S3.E5.m1.1.1.3.3.1"></times><ci id="S3.E5.m1.1.1.3.3.2.cmml" xref="S3.E5.m1.1.1.3.3.2">𝑀</ci><ci id="S3.E5.m1.1.1.3.3.3.cmml" xref="S3.E5.m1.1.1.3.3.3">𝑆</ci><ci id="S3.E5.m1.1.1.3.3.4.cmml" xref="S3.E5.m1.1.1.3.3.4">𝐸</ci></apply></apply><apply id="S3.E5.m1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.2">𝑦</ci><ci id="S3.E5.m1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\displaystyle\ell_{MSE}(y_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.1d">roman_ℓ start_POSTSUBSCRIPT italic_M italic_S italic_E end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=||g(y_{i})-h\circ g^{\prime}(y_{i};\Psi)||_{2}" class="ltx_Math" display="inline" id="S3.E5.m2.2"><semantics id="S3.E5.m2.2a"><mrow id="S3.E5.m2.2.2" xref="S3.E5.m2.2.2.cmml"><mi id="S3.E5.m2.2.2.3" xref="S3.E5.m2.2.2.3.cmml"></mi><mo id="S3.E5.m2.2.2.2" xref="S3.E5.m2.2.2.2.cmml">=</mo><msub id="S3.E5.m2.2.2.1" xref="S3.E5.m2.2.2.1.cmml"><mrow id="S3.E5.m2.2.2.1.1.1" xref="S3.E5.m2.2.2.1.1.2.cmml"><mo id="S3.E5.m2.2.2.1.1.1.2" stretchy="false" xref="S3.E5.m2.2.2.1.1.2.1.cmml">‖</mo><mrow id="S3.E5.m2.2.2.1.1.1.1" xref="S3.E5.m2.2.2.1.1.1.1.cmml"><mrow id="S3.E5.m2.2.2.1.1.1.1.1" xref="S3.E5.m2.2.2.1.1.1.1.1.cmml"><mi id="S3.E5.m2.2.2.1.1.1.1.1.3" xref="S3.E5.m2.2.2.1.1.1.1.1.3.cmml">g</mi><mo id="S3.E5.m2.2.2.1.1.1.1.1.2" xref="S3.E5.m2.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m2.2.2.1.1.1.1.1.1.1" xref="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E5.m2.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E5.m2.2.2.1.1.1.1.1.1.1.1" xref="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E5.m2.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m2.2.2.1.1.1.1.3" xref="S3.E5.m2.2.2.1.1.1.1.3.cmml">−</mo><mrow id="S3.E5.m2.2.2.1.1.1.1.2" xref="S3.E5.m2.2.2.1.1.1.1.2.cmml"><mrow id="S3.E5.m2.2.2.1.1.1.1.2.3" xref="S3.E5.m2.2.2.1.1.1.1.2.3.cmml"><mi id="S3.E5.m2.2.2.1.1.1.1.2.3.2" xref="S3.E5.m2.2.2.1.1.1.1.2.3.2.cmml">h</mi><mo id="S3.E5.m2.2.2.1.1.1.1.2.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E5.m2.2.2.1.1.1.1.2.3.1.cmml">∘</mo><msup id="S3.E5.m2.2.2.1.1.1.1.2.3.3" xref="S3.E5.m2.2.2.1.1.1.1.2.3.3.cmml"><mi id="S3.E5.m2.2.2.1.1.1.1.2.3.3.2" xref="S3.E5.m2.2.2.1.1.1.1.2.3.3.2.cmml">g</mi><mo id="S3.E5.m2.2.2.1.1.1.1.2.3.3.3" xref="S3.E5.m2.2.2.1.1.1.1.2.3.3.3.cmml">′</mo></msup></mrow><mo id="S3.E5.m2.2.2.1.1.1.1.2.2" xref="S3.E5.m2.2.2.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S3.E5.m2.2.2.1.1.1.1.2.1.1" xref="S3.E5.m2.2.2.1.1.1.1.2.1.2.cmml"><mo id="S3.E5.m2.2.2.1.1.1.1.2.1.1.2" stretchy="false" xref="S3.E5.m2.2.2.1.1.1.1.2.1.2.cmml">(</mo><msub id="S3.E5.m2.2.2.1.1.1.1.2.1.1.1" xref="S3.E5.m2.2.2.1.1.1.1.2.1.1.1.cmml"><mi id="S3.E5.m2.2.2.1.1.1.1.2.1.1.1.2" xref="S3.E5.m2.2.2.1.1.1.1.2.1.1.1.2.cmml">y</mi><mi id="S3.E5.m2.2.2.1.1.1.1.2.1.1.1.3" xref="S3.E5.m2.2.2.1.1.1.1.2.1.1.1.3.cmml">i</mi></msub><mo id="S3.E5.m2.2.2.1.1.1.1.2.1.1.3" xref="S3.E5.m2.2.2.1.1.1.1.2.1.2.cmml">;</mo><mi id="S3.E5.m2.1.1" mathvariant="normal" xref="S3.E5.m2.1.1.cmml">Ψ</mi><mo id="S3.E5.m2.2.2.1.1.1.1.2.1.1.4" stretchy="false" xref="S3.E5.m2.2.2.1.1.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m2.2.2.1.1.1.3" stretchy="false" xref="S3.E5.m2.2.2.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E5.m2.2.2.1.3" xref="S3.E5.m2.2.2.1.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m2.2b"><apply id="S3.E5.m2.2.2.cmml" xref="S3.E5.m2.2.2"><eq id="S3.E5.m2.2.2.2.cmml" xref="S3.E5.m2.2.2.2"></eq><csymbol cd="latexml" id="S3.E5.m2.2.2.3.cmml" xref="S3.E5.m2.2.2.3">absent</csymbol><apply id="S3.E5.m2.2.2.1.cmml" xref="S3.E5.m2.2.2.1"><csymbol cd="ambiguous" id="S3.E5.m2.2.2.1.2.cmml" xref="S3.E5.m2.2.2.1">subscript</csymbol><apply id="S3.E5.m2.2.2.1.1.2.cmml" xref="S3.E5.m2.2.2.1.1.1"><csymbol cd="latexml" id="S3.E5.m2.2.2.1.1.2.1.cmml" xref="S3.E5.m2.2.2.1.1.1.2">norm</csymbol><apply id="S3.E5.m2.2.2.1.1.1.1.cmml" xref="S3.E5.m2.2.2.1.1.1.1"><minus id="S3.E5.m2.2.2.1.1.1.1.3.cmml" xref="S3.E5.m2.2.2.1.1.1.1.3"></minus><apply id="S3.E5.m2.2.2.1.1.1.1.1.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1"><times id="S3.E5.m2.2.2.1.1.1.1.1.2.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.2"></times><ci id="S3.E5.m2.2.2.1.1.1.1.1.3.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.3">𝑔</ci><apply id="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E5.m2.2.2.1.1.1.1.2.cmml" xref="S3.E5.m2.2.2.1.1.1.1.2"><times id="S3.E5.m2.2.2.1.1.1.1.2.2.cmml" xref="S3.E5.m2.2.2.1.1.1.1.2.2"></times><apply id="S3.E5.m2.2.2.1.1.1.1.2.3.cmml" xref="S3.E5.m2.2.2.1.1.1.1.2.3"><compose id="S3.E5.m2.2.2.1.1.1.1.2.3.1.cmml" xref="S3.E5.m2.2.2.1.1.1.1.2.3.1"></compose><ci id="S3.E5.m2.2.2.1.1.1.1.2.3.2.cmml" xref="S3.E5.m2.2.2.1.1.1.1.2.3.2">ℎ</ci><apply id="S3.E5.m2.2.2.1.1.1.1.2.3.3.cmml" xref="S3.E5.m2.2.2.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E5.m2.2.2.1.1.1.1.2.3.3.1.cmml" xref="S3.E5.m2.2.2.1.1.1.1.2.3.3">superscript</csymbol><ci id="S3.E5.m2.2.2.1.1.1.1.2.3.3.2.cmml" xref="S3.E5.m2.2.2.1.1.1.1.2.3.3.2">𝑔</ci><ci id="S3.E5.m2.2.2.1.1.1.1.2.3.3.3.cmml" xref="S3.E5.m2.2.2.1.1.1.1.2.3.3.3">′</ci></apply></apply><list id="S3.E5.m2.2.2.1.1.1.1.2.1.2.cmml" xref="S3.E5.m2.2.2.1.1.1.1.2.1.1"><apply id="S3.E5.m2.2.2.1.1.1.1.2.1.1.1.cmml" xref="S3.E5.m2.2.2.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m2.2.2.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E5.m2.2.2.1.1.1.1.2.1.1.1">subscript</csymbol><ci id="S3.E5.m2.2.2.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E5.m2.2.2.1.1.1.1.2.1.1.1.2">𝑦</ci><ci id="S3.E5.m2.2.2.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E5.m2.2.2.1.1.1.1.2.1.1.1.3">𝑖</ci></apply><ci id="S3.E5.m2.1.1.cmml" xref="S3.E5.m2.1.1">Ψ</ci></list></apply></apply></apply><cn id="S3.E5.m2.2.2.1.3.cmml" type="integer" xref="S3.E5.m2.2.2.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m2.2c">\displaystyle=||g(y_{i})-h\circ g^{\prime}(y_{i};\Psi)||_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m2.2d">= | | italic_g ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) - italic_h ∘ italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ; roman_Ψ ) | | start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\ell_{{\mathrm{d}}}(y_{i})" class="ltx_Math" display="inline" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><msub id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.3.2" mathvariant="normal" xref="S3.E6.m1.1.1.3.2.cmml">ℓ</mi><mi id="S3.E6.m1.1.1.3.3" mathvariant="normal" xref="S3.E6.m1.1.1.3.3.cmml">d</mi></msub><mo id="S3.E6.m1.1.1.2" xref="S3.E6.m1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.2.cmml">y</mi><mi id="S3.E6.m1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E6.m1.1.1.1.1.3" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><times id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1.2"></times><apply id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.3.2">ℓ</ci><ci id="S3.E6.m1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.3.3">d</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2">𝑦</ci><ci id="S3.E6.m1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\displaystyle\ell_{{\mathrm{d}}}(y_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">roman_ℓ start_POSTSUBSCRIPT roman_d end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\log\tilde{P}(y|x)-\log\tilde{P}_{h}(y|x)" class="ltx_Math" display="inline" id="S3.E6.m2.2"><semantics id="S3.E6.m2.2a"><mrow id="S3.E6.m2.2.2" xref="S3.E6.m2.2.2.cmml"><mi id="S3.E6.m2.2.2.4" xref="S3.E6.m2.2.2.4.cmml"></mi><mo id="S3.E6.m2.2.2.3" xref="S3.E6.m2.2.2.3.cmml">=</mo><mrow id="S3.E6.m2.2.2.2" xref="S3.E6.m2.2.2.2.cmml"><mrow id="S3.E6.m2.1.1.1.1" xref="S3.E6.m2.1.1.1.1.cmml"><mrow id="S3.E6.m2.1.1.1.1.3" xref="S3.E6.m2.1.1.1.1.3.cmml"><mi id="S3.E6.m2.1.1.1.1.3.1" xref="S3.E6.m2.1.1.1.1.3.1.cmml">log</mi><mo id="S3.E6.m2.1.1.1.1.3a" lspace="0.167em" xref="S3.E6.m2.1.1.1.1.3.cmml">⁡</mo><mover accent="true" id="S3.E6.m2.1.1.1.1.3.2" xref="S3.E6.m2.1.1.1.1.3.2.cmml"><mi id="S3.E6.m2.1.1.1.1.3.2.2" xref="S3.E6.m2.1.1.1.1.3.2.2.cmml">P</mi><mo id="S3.E6.m2.1.1.1.1.3.2.1" xref="S3.E6.m2.1.1.1.1.3.2.1.cmml">~</mo></mover></mrow><mo id="S3.E6.m2.1.1.1.1.2" xref="S3.E6.m2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m2.1.1.1.1.1.1" xref="S3.E6.m2.1.1.1.1.1.1.1.cmml"><mo id="S3.E6.m2.1.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m2.1.1.1.1.1.1.1" xref="S3.E6.m2.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m2.1.1.1.1.1.1.1.2" xref="S3.E6.m2.1.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S3.E6.m2.1.1.1.1.1.1.1.1" xref="S3.E6.m2.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E6.m2.1.1.1.1.1.1.1.3" xref="S3.E6.m2.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E6.m2.1.1.1.1.1.1.3" stretchy="false" xref="S3.E6.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m2.2.2.2.3" xref="S3.E6.m2.2.2.2.3.cmml">−</mo><mrow id="S3.E6.m2.2.2.2.2" xref="S3.E6.m2.2.2.2.2.cmml"><mrow id="S3.E6.m2.2.2.2.2.3" xref="S3.E6.m2.2.2.2.2.3.cmml"><mi id="S3.E6.m2.2.2.2.2.3.1" xref="S3.E6.m2.2.2.2.2.3.1.cmml">log</mi><mo id="S3.E6.m2.2.2.2.2.3a" lspace="0.167em" xref="S3.E6.m2.2.2.2.2.3.cmml">⁡</mo><msub id="S3.E6.m2.2.2.2.2.3.2" xref="S3.E6.m2.2.2.2.2.3.2.cmml"><mover accent="true" id="S3.E6.m2.2.2.2.2.3.2.2" xref="S3.E6.m2.2.2.2.2.3.2.2.cmml"><mi id="S3.E6.m2.2.2.2.2.3.2.2.2" xref="S3.E6.m2.2.2.2.2.3.2.2.2.cmml">P</mi><mo id="S3.E6.m2.2.2.2.2.3.2.2.1" xref="S3.E6.m2.2.2.2.2.3.2.2.1.cmml">~</mo></mover><mi id="S3.E6.m2.2.2.2.2.3.2.3" xref="S3.E6.m2.2.2.2.2.3.2.3.cmml">h</mi></msub></mrow><mo id="S3.E6.m2.2.2.2.2.2" xref="S3.E6.m2.2.2.2.2.2.cmml">⁢</mo><mrow id="S3.E6.m2.2.2.2.2.1.1" xref="S3.E6.m2.2.2.2.2.1.1.1.cmml"><mo id="S3.E6.m2.2.2.2.2.1.1.2" stretchy="false" xref="S3.E6.m2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.E6.m2.2.2.2.2.1.1.1" xref="S3.E6.m2.2.2.2.2.1.1.1.cmml"><mi id="S3.E6.m2.2.2.2.2.1.1.1.2" xref="S3.E6.m2.2.2.2.2.1.1.1.2.cmml">y</mi><mo fence="false" id="S3.E6.m2.2.2.2.2.1.1.1.1" xref="S3.E6.m2.2.2.2.2.1.1.1.1.cmml">|</mo><mi id="S3.E6.m2.2.2.2.2.1.1.1.3" xref="S3.E6.m2.2.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E6.m2.2.2.2.2.1.1.3" stretchy="false" xref="S3.E6.m2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m2.2b"><apply id="S3.E6.m2.2.2.cmml" xref="S3.E6.m2.2.2"><eq id="S3.E6.m2.2.2.3.cmml" xref="S3.E6.m2.2.2.3"></eq><csymbol cd="latexml" id="S3.E6.m2.2.2.4.cmml" xref="S3.E6.m2.2.2.4">absent</csymbol><apply id="S3.E6.m2.2.2.2.cmml" xref="S3.E6.m2.2.2.2"><minus id="S3.E6.m2.2.2.2.3.cmml" xref="S3.E6.m2.2.2.2.3"></minus><apply id="S3.E6.m2.1.1.1.1.cmml" xref="S3.E6.m2.1.1.1.1"><times id="S3.E6.m2.1.1.1.1.2.cmml" xref="S3.E6.m2.1.1.1.1.2"></times><apply id="S3.E6.m2.1.1.1.1.3.cmml" xref="S3.E6.m2.1.1.1.1.3"><log id="S3.E6.m2.1.1.1.1.3.1.cmml" xref="S3.E6.m2.1.1.1.1.3.1"></log><apply id="S3.E6.m2.1.1.1.1.3.2.cmml" xref="S3.E6.m2.1.1.1.1.3.2"><ci id="S3.E6.m2.1.1.1.1.3.2.1.cmml" xref="S3.E6.m2.1.1.1.1.3.2.1">~</ci><ci id="S3.E6.m2.1.1.1.1.3.2.2.cmml" xref="S3.E6.m2.1.1.1.1.3.2.2">𝑃</ci></apply></apply><apply id="S3.E6.m2.1.1.1.1.1.1.1.cmml" xref="S3.E6.m2.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E6.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S3.E6.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.E6.m2.2.2.2.2.cmml" xref="S3.E6.m2.2.2.2.2"><times id="S3.E6.m2.2.2.2.2.2.cmml" xref="S3.E6.m2.2.2.2.2.2"></times><apply id="S3.E6.m2.2.2.2.2.3.cmml" xref="S3.E6.m2.2.2.2.2.3"><log id="S3.E6.m2.2.2.2.2.3.1.cmml" xref="S3.E6.m2.2.2.2.2.3.1"></log><apply id="S3.E6.m2.2.2.2.2.3.2.cmml" xref="S3.E6.m2.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.E6.m2.2.2.2.2.3.2.1.cmml" xref="S3.E6.m2.2.2.2.2.3.2">subscript</csymbol><apply id="S3.E6.m2.2.2.2.2.3.2.2.cmml" xref="S3.E6.m2.2.2.2.2.3.2.2"><ci id="S3.E6.m2.2.2.2.2.3.2.2.1.cmml" xref="S3.E6.m2.2.2.2.2.3.2.2.1">~</ci><ci id="S3.E6.m2.2.2.2.2.3.2.2.2.cmml" xref="S3.E6.m2.2.2.2.2.3.2.2.2">𝑃</ci></apply><ci id="S3.E6.m2.2.2.2.2.3.2.3.cmml" xref="S3.E6.m2.2.2.2.2.3.2.3">ℎ</ci></apply></apply><apply id="S3.E6.m2.2.2.2.2.1.1.1.cmml" xref="S3.E6.m2.2.2.2.2.1.1"><csymbol cd="latexml" id="S3.E6.m2.2.2.2.2.1.1.1.1.cmml" xref="S3.E6.m2.2.2.2.2.1.1.1.1">conditional</csymbol><ci id="S3.E6.m2.2.2.2.2.1.1.1.2.cmml" xref="S3.E6.m2.2.2.2.2.1.1.1.2">𝑦</ci><ci id="S3.E6.m2.2.2.2.2.1.1.1.3.cmml" xref="S3.E6.m2.2.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m2.2c">\displaystyle=\log\tilde{P}(y|x)-\log\tilde{P}_{h}(y|x)</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m2.2d">= roman_log over~ start_ARG italic_P end_ARG ( italic_y | italic_x ) - roman_log over~ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ( italic_y | italic_x )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\tilde{P}_{h}(y|x)" class="ltx_Math" display="inline" id="S3.Ex1.m1.1"><semantics id="S3.Ex1.m1.1a"><mrow id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml"><msub id="S3.Ex1.m1.1.1.3" xref="S3.Ex1.m1.1.1.3.cmml"><mover accent="true" id="S3.Ex1.m1.1.1.3.2" xref="S3.Ex1.m1.1.1.3.2.cmml"><mi id="S3.Ex1.m1.1.1.3.2.2" xref="S3.Ex1.m1.1.1.3.2.2.cmml">P</mi><mo id="S3.Ex1.m1.1.1.3.2.1" xref="S3.Ex1.m1.1.1.3.2.1.cmml">~</mo></mover><mi id="S3.Ex1.m1.1.1.3.3" xref="S3.Ex1.m1.1.1.3.3.cmml">h</mi></msub><mo id="S3.Ex1.m1.1.1.2" xref="S3.Ex1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex1.m1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.cmml"><mo id="S3.Ex1.m1.1.1.1.1.2" stretchy="false" xref="S3.Ex1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S3.Ex1.m1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.Ex1.m1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.Ex1.m1.1.1.1.1.3" stretchy="false" xref="S3.Ex1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1"><times id="S3.Ex1.m1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.2"></times><apply id="S3.Ex1.m1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.3">subscript</csymbol><apply id="S3.Ex1.m1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.3.2"><ci id="S3.Ex1.m1.1.1.3.2.1.cmml" xref="S3.Ex1.m1.1.1.3.2.1">~</ci><ci id="S3.Ex1.m1.1.1.3.2.2.cmml" xref="S3.Ex1.m1.1.1.3.2.2">𝑃</ci></apply><ci id="S3.Ex1.m1.1.1.3.3.cmml" xref="S3.Ex1.m1.1.1.3.3">ℎ</ci></apply><apply id="S3.Ex1.m1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex1.m1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.Ex1.m1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.2">𝑦</ci><ci id="S3.Ex1.m1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">\displaystyle\tilde{P}_{h}(y|x)</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.1d">over~ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ( italic_y | italic_x )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\exp(\beta\langle f(x),h\circ g^{\prime}(y;\Psi)\rangle)}{%
\sum_{{y^{\prime}\in S(\mathcal{Y})_{i}}}\exp(\beta\langle f(x),h\circ g^{%
\prime}(y^{\prime};\Psi)\rangle)}." class="ltx_Math" display="inline" id="S3.Ex1.m2.11"><semantics id="S3.Ex1.m2.11a"><mrow id="S3.Ex1.m2.11.11.1" xref="S3.Ex1.m2.11.11.1.1.cmml"><mrow id="S3.Ex1.m2.11.11.1.1" xref="S3.Ex1.m2.11.11.1.1.cmml"><mi id="S3.Ex1.m2.11.11.1.1.2" xref="S3.Ex1.m2.11.11.1.1.2.cmml"></mi><mo id="S3.Ex1.m2.11.11.1.1.1" xref="S3.Ex1.m2.11.11.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="S3.Ex1.m2.10.10" xref="S3.Ex1.m2.10.10.cmml"><mfrac id="S3.Ex1.m2.10.10a" xref="S3.Ex1.m2.10.10.cmml"><mrow id="S3.Ex1.m2.5.5.5.5" xref="S3.Ex1.m2.5.5.5.6.cmml"><mi id="S3.Ex1.m2.4.4.4.4" xref="S3.Ex1.m2.4.4.4.4.cmml">exp</mi><mo id="S3.Ex1.m2.5.5.5.5a" xref="S3.Ex1.m2.5.5.5.6.cmml">⁡</mo><mrow id="S3.Ex1.m2.5.5.5.5.1" xref="S3.Ex1.m2.5.5.5.6.cmml"><mo id="S3.Ex1.m2.5.5.5.5.1.2" stretchy="false" xref="S3.Ex1.m2.5.5.5.6.cmml">(</mo><mrow id="S3.Ex1.m2.5.5.5.5.1.1" xref="S3.Ex1.m2.5.5.5.5.1.1.cmml"><mi id="S3.Ex1.m2.5.5.5.5.1.1.4" xref="S3.Ex1.m2.5.5.5.5.1.1.4.cmml">β</mi><mo id="S3.Ex1.m2.5.5.5.5.1.1.3" xref="S3.Ex1.m2.5.5.5.5.1.1.3.cmml">⁢</mo><mrow id="S3.Ex1.m2.5.5.5.5.1.1.2.2" xref="S3.Ex1.m2.5.5.5.5.1.1.2.3.cmml"><mo id="S3.Ex1.m2.5.5.5.5.1.1.2.2.3" stretchy="false" xref="S3.Ex1.m2.5.5.5.5.1.1.2.3.cmml">⟨</mo><mrow id="S3.Ex1.m2.5.5.5.5.1.1.1.1.1" xref="S3.Ex1.m2.5.5.5.5.1.1.1.1.1.cmml"><mi id="S3.Ex1.m2.5.5.5.5.1.1.1.1.1.2" xref="S3.Ex1.m2.5.5.5.5.1.1.1.1.1.2.cmml">f</mi><mo id="S3.Ex1.m2.5.5.5.5.1.1.1.1.1.1" xref="S3.Ex1.m2.5.5.5.5.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.Ex1.m2.5.5.5.5.1.1.1.1.1.3.2" xref="S3.Ex1.m2.5.5.5.5.1.1.1.1.1.cmml"><mo id="S3.Ex1.m2.5.5.5.5.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.Ex1.m2.5.5.5.5.1.1.1.1.1.cmml">(</mo><mi id="S3.Ex1.m2.1.1.1.1" xref="S3.Ex1.m2.1.1.1.1.cmml">x</mi><mo id="S3.Ex1.m2.5.5.5.5.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.Ex1.m2.5.5.5.5.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m2.5.5.5.5.1.1.2.2.4" xref="S3.Ex1.m2.5.5.5.5.1.1.2.3.cmml">,</mo><mrow id="S3.Ex1.m2.5.5.5.5.1.1.2.2.2" xref="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.cmml"><mrow id="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.2" xref="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.2.cmml"><mi id="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.2.2" xref="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.2.2.cmml">h</mi><mo id="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.2.1.cmml">∘</mo><msup id="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.2.3" xref="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.2.3.cmml"><mi id="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.2.3.2" xref="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.2.3.2.cmml">g</mi><mo id="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.2.3.3" xref="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.2.3.3.cmml">′</mo></msup></mrow><mo id="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.1" xref="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.1.cmml">⁢</mo><mrow id="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.3.2" xref="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.3.1.cmml"><mo id="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.3.2.1" stretchy="false" xref="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.3.1.cmml">(</mo><mi id="S3.Ex1.m2.2.2.2.2" xref="S3.Ex1.m2.2.2.2.2.cmml">y</mi><mo id="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.3.2.2" xref="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.3.1.cmml">;</mo><mi id="S3.Ex1.m2.3.3.3.3" mathvariant="normal" xref="S3.Ex1.m2.3.3.3.3.cmml">Ψ</mi><mo id="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.3.2.3" stretchy="false" xref="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m2.5.5.5.5.1.1.2.2.5" stretchy="false" xref="S3.Ex1.m2.5.5.5.5.1.1.2.3.cmml">⟩</mo></mrow></mrow><mo id="S3.Ex1.m2.5.5.5.5.1.3" stretchy="false" xref="S3.Ex1.m2.5.5.5.6.cmml">)</mo></mrow></mrow><mrow id="S3.Ex1.m2.10.10.10" xref="S3.Ex1.m2.10.10.10.cmml"><msub id="S3.Ex1.m2.10.10.10.6" xref="S3.Ex1.m2.10.10.10.6.cmml"><mo id="S3.Ex1.m2.10.10.10.6.2" xref="S3.Ex1.m2.10.10.10.6.2.cmml">∑</mo><mrow id="S3.Ex1.m2.6.6.6.1.1" xref="S3.Ex1.m2.6.6.6.1.1.cmml"><msup id="S3.Ex1.m2.6.6.6.1.1.3" xref="S3.Ex1.m2.6.6.6.1.1.3.cmml"><mi id="S3.Ex1.m2.6.6.6.1.1.3.2" xref="S3.Ex1.m2.6.6.6.1.1.3.2.cmml">y</mi><mo id="S3.Ex1.m2.6.6.6.1.1.3.3" xref="S3.Ex1.m2.6.6.6.1.1.3.3.cmml">′</mo></msup><mo id="S3.Ex1.m2.6.6.6.1.1.2" xref="S3.Ex1.m2.6.6.6.1.1.2.cmml">∈</mo><mrow id="S3.Ex1.m2.6.6.6.1.1.4" xref="S3.Ex1.m2.6.6.6.1.1.4.cmml"><mi id="S3.Ex1.m2.6.6.6.1.1.4.2" xref="S3.Ex1.m2.6.6.6.1.1.4.2.cmml">S</mi><mo id="S3.Ex1.m2.6.6.6.1.1.4.1" xref="S3.Ex1.m2.6.6.6.1.1.4.1.cmml">⁢</mo><msub id="S3.Ex1.m2.6.6.6.1.1.4.3" xref="S3.Ex1.m2.6.6.6.1.1.4.3.cmml"><mrow id="S3.Ex1.m2.6.6.6.1.1.4.3.2.2" xref="S3.Ex1.m2.6.6.6.1.1.4.3.cmml"><mo id="S3.Ex1.m2.6.6.6.1.1.4.3.2.2.1" stretchy="false" xref="S3.Ex1.m2.6.6.6.1.1.4.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m2.6.6.6.1.1.1" xref="S3.Ex1.m2.6.6.6.1.1.1.cmml">𝒴</mi><mo id="S3.Ex1.m2.6.6.6.1.1.4.3.2.2.2" stretchy="false" xref="S3.Ex1.m2.6.6.6.1.1.4.3.cmml">)</mo></mrow><mi id="S3.Ex1.m2.6.6.6.1.1.4.3.3" xref="S3.Ex1.m2.6.6.6.1.1.4.3.3.cmml">i</mi></msub></mrow></mrow></msub><mrow id="S3.Ex1.m2.10.10.10.5.1" xref="S3.Ex1.m2.10.10.10.5.2.cmml"><mi id="S3.Ex1.m2.9.9.9.4" xref="S3.Ex1.m2.9.9.9.4.cmml">exp</mi><mo id="S3.Ex1.m2.10.10.10.5.1a" xref="S3.Ex1.m2.10.10.10.5.2.cmml">⁡</mo><mrow id="S3.Ex1.m2.10.10.10.5.1.1" xref="S3.Ex1.m2.10.10.10.5.2.cmml"><mo id="S3.Ex1.m2.10.10.10.5.1.1.2" stretchy="false" xref="S3.Ex1.m2.10.10.10.5.2.cmml">(</mo><mrow id="S3.Ex1.m2.10.10.10.5.1.1.1" xref="S3.Ex1.m2.10.10.10.5.1.1.1.cmml"><mi id="S3.Ex1.m2.10.10.10.5.1.1.1.4" xref="S3.Ex1.m2.10.10.10.5.1.1.1.4.cmml">β</mi><mo id="S3.Ex1.m2.10.10.10.5.1.1.1.3" xref="S3.Ex1.m2.10.10.10.5.1.1.1.3.cmml">⁢</mo><mrow id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.3.cmml"><mo id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.3" stretchy="false" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.3.cmml">⟨</mo><mrow id="S3.Ex1.m2.10.10.10.5.1.1.1.1.1.1" xref="S3.Ex1.m2.10.10.10.5.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m2.10.10.10.5.1.1.1.1.1.1.2" xref="S3.Ex1.m2.10.10.10.5.1.1.1.1.1.1.2.cmml">f</mi><mo id="S3.Ex1.m2.10.10.10.5.1.1.1.1.1.1.1" xref="S3.Ex1.m2.10.10.10.5.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.Ex1.m2.10.10.10.5.1.1.1.1.1.1.3.2" xref="S3.Ex1.m2.10.10.10.5.1.1.1.1.1.1.cmml"><mo id="S3.Ex1.m2.10.10.10.5.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.Ex1.m2.10.10.10.5.1.1.1.1.1.1.cmml">(</mo><mi id="S3.Ex1.m2.7.7.7.2" xref="S3.Ex1.m2.7.7.7.2.cmml">x</mi><mo id="S3.Ex1.m2.10.10.10.5.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.Ex1.m2.10.10.10.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.4" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.3.cmml">,</mo><mrow id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.cmml"><mrow id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.3" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.3.cmml"><mi id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.3.2" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.3.2.cmml">h</mi><mo id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.3.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.3.1.cmml">∘</mo><msup id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.3.3" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.3.3.cmml"><mi id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.3.3.2" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.3.3.2.cmml">g</mi><mo id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.3.3.3" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.3.3.3.cmml">′</mo></msup></mrow><mo id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.2" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.2.cmml">⁢</mo><mrow id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.1.1" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.1.2.cmml"><mo id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.1.1.2" stretchy="false" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.1.2.cmml">(</mo><msup id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.1.1.1" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.1.1.1.cmml"><mi id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.1.1.1.2" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.1.1.1.2.cmml">y</mi><mo id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.1.1.1.3" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.1.1.1.3.cmml">′</mo></msup><mo id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.1.1.3" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.1.2.cmml">;</mo><mi id="S3.Ex1.m2.8.8.8.3" mathvariant="normal" xref="S3.Ex1.m2.8.8.8.3.cmml">Ψ</mi><mo id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.1.1.4" stretchy="false" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.5" stretchy="false" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.3.cmml">⟩</mo></mrow></mrow><mo id="S3.Ex1.m2.10.10.10.5.1.1.3" stretchy="false" xref="S3.Ex1.m2.10.10.10.5.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><mo id="S3.Ex1.m2.11.11.1.2" lspace="0em" xref="S3.Ex1.m2.11.11.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m2.11b"><apply id="S3.Ex1.m2.11.11.1.1.cmml" xref="S3.Ex1.m2.11.11.1"><eq id="S3.Ex1.m2.11.11.1.1.1.cmml" xref="S3.Ex1.m2.11.11.1.1.1"></eq><csymbol cd="latexml" id="S3.Ex1.m2.11.11.1.1.2.cmml" xref="S3.Ex1.m2.11.11.1.1.2">absent</csymbol><apply id="S3.Ex1.m2.10.10.cmml" xref="S3.Ex1.m2.10.10"><divide id="S3.Ex1.m2.10.10.11.cmml" xref="S3.Ex1.m2.10.10"></divide><apply id="S3.Ex1.m2.5.5.5.6.cmml" xref="S3.Ex1.m2.5.5.5.5"><exp id="S3.Ex1.m2.4.4.4.4.cmml" xref="S3.Ex1.m2.4.4.4.4"></exp><apply id="S3.Ex1.m2.5.5.5.5.1.1.cmml" xref="S3.Ex1.m2.5.5.5.5.1.1"><times id="S3.Ex1.m2.5.5.5.5.1.1.3.cmml" xref="S3.Ex1.m2.5.5.5.5.1.1.3"></times><ci id="S3.Ex1.m2.5.5.5.5.1.1.4.cmml" xref="S3.Ex1.m2.5.5.5.5.1.1.4">𝛽</ci><list id="S3.Ex1.m2.5.5.5.5.1.1.2.3.cmml" xref="S3.Ex1.m2.5.5.5.5.1.1.2.2"><apply id="S3.Ex1.m2.5.5.5.5.1.1.1.1.1.cmml" xref="S3.Ex1.m2.5.5.5.5.1.1.1.1.1"><times id="S3.Ex1.m2.5.5.5.5.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.5.5.5.5.1.1.1.1.1.1"></times><ci id="S3.Ex1.m2.5.5.5.5.1.1.1.1.1.2.cmml" xref="S3.Ex1.m2.5.5.5.5.1.1.1.1.1.2">𝑓</ci><ci id="S3.Ex1.m2.1.1.1.1.cmml" xref="S3.Ex1.m2.1.1.1.1">𝑥</ci></apply><apply id="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.cmml" xref="S3.Ex1.m2.5.5.5.5.1.1.2.2.2"><times id="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.1.cmml" xref="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.1"></times><apply id="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.2.cmml" xref="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.2"><compose id="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.2.1.cmml" xref="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.2.1"></compose><ci id="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.2.2.cmml" xref="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.2.2">ℎ</ci><apply id="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.2.3.cmml" xref="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.2.3.1.cmml" xref="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.2.3">superscript</csymbol><ci id="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.2.3.2.cmml" xref="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.2.3.2">𝑔</ci><ci id="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.2.3.3.cmml" xref="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.2.3.3">′</ci></apply></apply><list id="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.3.1.cmml" xref="S3.Ex1.m2.5.5.5.5.1.1.2.2.2.3.2"><ci id="S3.Ex1.m2.2.2.2.2.cmml" xref="S3.Ex1.m2.2.2.2.2">𝑦</ci><ci id="S3.Ex1.m2.3.3.3.3.cmml" xref="S3.Ex1.m2.3.3.3.3">Ψ</ci></list></apply></list></apply></apply><apply id="S3.Ex1.m2.10.10.10.cmml" xref="S3.Ex1.m2.10.10.10"><apply id="S3.Ex1.m2.10.10.10.6.cmml" xref="S3.Ex1.m2.10.10.10.6"><csymbol cd="ambiguous" id="S3.Ex1.m2.10.10.10.6.1.cmml" xref="S3.Ex1.m2.10.10.10.6">subscript</csymbol><sum id="S3.Ex1.m2.10.10.10.6.2.cmml" xref="S3.Ex1.m2.10.10.10.6.2"></sum><apply id="S3.Ex1.m2.6.6.6.1.1.cmml" xref="S3.Ex1.m2.6.6.6.1.1"><in id="S3.Ex1.m2.6.6.6.1.1.2.cmml" xref="S3.Ex1.m2.6.6.6.1.1.2"></in><apply id="S3.Ex1.m2.6.6.6.1.1.3.cmml" xref="S3.Ex1.m2.6.6.6.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.6.6.6.1.1.3.1.cmml" xref="S3.Ex1.m2.6.6.6.1.1.3">superscript</csymbol><ci id="S3.Ex1.m2.6.6.6.1.1.3.2.cmml" xref="S3.Ex1.m2.6.6.6.1.1.3.2">𝑦</ci><ci id="S3.Ex1.m2.6.6.6.1.1.3.3.cmml" xref="S3.Ex1.m2.6.6.6.1.1.3.3">′</ci></apply><apply id="S3.Ex1.m2.6.6.6.1.1.4.cmml" xref="S3.Ex1.m2.6.6.6.1.1.4"><times id="S3.Ex1.m2.6.6.6.1.1.4.1.cmml" xref="S3.Ex1.m2.6.6.6.1.1.4.1"></times><ci id="S3.Ex1.m2.6.6.6.1.1.4.2.cmml" xref="S3.Ex1.m2.6.6.6.1.1.4.2">𝑆</ci><apply id="S3.Ex1.m2.6.6.6.1.1.4.3.cmml" xref="S3.Ex1.m2.6.6.6.1.1.4.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.6.6.6.1.1.4.3.1.cmml" xref="S3.Ex1.m2.6.6.6.1.1.4.3">subscript</csymbol><ci id="S3.Ex1.m2.6.6.6.1.1.1.cmml" xref="S3.Ex1.m2.6.6.6.1.1.1">𝒴</ci><ci id="S3.Ex1.m2.6.6.6.1.1.4.3.3.cmml" xref="S3.Ex1.m2.6.6.6.1.1.4.3.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.Ex1.m2.10.10.10.5.2.cmml" xref="S3.Ex1.m2.10.10.10.5.1"><exp id="S3.Ex1.m2.9.9.9.4.cmml" xref="S3.Ex1.m2.9.9.9.4"></exp><apply id="S3.Ex1.m2.10.10.10.5.1.1.1.cmml" xref="S3.Ex1.m2.10.10.10.5.1.1.1"><times id="S3.Ex1.m2.10.10.10.5.1.1.1.3.cmml" xref="S3.Ex1.m2.10.10.10.5.1.1.1.3"></times><ci id="S3.Ex1.m2.10.10.10.5.1.1.1.4.cmml" xref="S3.Ex1.m2.10.10.10.5.1.1.1.4">𝛽</ci><list id="S3.Ex1.m2.10.10.10.5.1.1.1.2.3.cmml" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2"><apply id="S3.Ex1.m2.10.10.10.5.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.10.10.10.5.1.1.1.1.1.1"><times id="S3.Ex1.m2.10.10.10.5.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.10.10.10.5.1.1.1.1.1.1.1"></times><ci id="S3.Ex1.m2.10.10.10.5.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m2.10.10.10.5.1.1.1.1.1.1.2">𝑓</ci><ci id="S3.Ex1.m2.7.7.7.2.cmml" xref="S3.Ex1.m2.7.7.7.2">𝑥</ci></apply><apply id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.cmml" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2"><times id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.2.cmml" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.2"></times><apply id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.3.cmml" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.3"><compose id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.3.1.cmml" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.3.1"></compose><ci id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.3.2.cmml" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.3.2">ℎ</ci><apply id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.3.3.cmml" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.3.3.1.cmml" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.3.3">superscript</csymbol><ci id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.3.3.2.cmml" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.3.3.2">𝑔</ci><ci id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.3.3.3.cmml" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.3.3.3">′</ci></apply></apply><list id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.1.2.cmml" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.1.1"><apply id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.1.1.1.cmml" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.1.1.1.1.cmml" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.1.1.1">superscript</csymbol><ci id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.1.1.1.2.cmml" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.1.1.1.2">𝑦</ci><ci id="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.1.1.1.3.cmml" xref="S3.Ex1.m2.10.10.10.5.1.1.1.2.2.2.1.1.1.3">′</ci></apply><ci id="S3.Ex1.m2.8.8.8.3.cmml" xref="S3.Ex1.m2.8.8.8.3">Ψ</ci></list></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m2.11c">\displaystyle=\frac{\exp(\beta\langle f(x),h\circ g^{\prime}(y;\Psi)\rangle)}{%
\sum_{{y^{\prime}\in S(\mathcal{Y})_{i}}}\exp(\beta\langle f(x),h\circ g^{%
\prime}(y^{\prime};\Psi)\rangle)}.</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m2.11d">= divide start_ARG roman_exp ( italic_β ⟨ italic_f ( italic_x ) , italic_h ∘ italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y ; roman_Ψ ) ⟩ ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ italic_S ( caligraphic_Y ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_exp ( italic_β ⟨ italic_f ( italic_x ) , italic_h ∘ italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ; roman_Ψ ) ⟩ ) end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p5.9">where <math alttext="\tilde{P}(y|x)" class="ltx_Math" display="inline" id="S3.p5.6.m1.1"><semantics id="S3.p5.6.m1.1a"><mrow id="S3.p5.6.m1.1.1" xref="S3.p5.6.m1.1.1.cmml"><mover accent="true" id="S3.p5.6.m1.1.1.3" xref="S3.p5.6.m1.1.1.3.cmml"><mi id="S3.p5.6.m1.1.1.3.2" xref="S3.p5.6.m1.1.1.3.2.cmml">P</mi><mo id="S3.p5.6.m1.1.1.3.1" xref="S3.p5.6.m1.1.1.3.1.cmml">~</mo></mover><mo id="S3.p5.6.m1.1.1.2" xref="S3.p5.6.m1.1.1.2.cmml">⁢</mo><mrow id="S3.p5.6.m1.1.1.1.1" xref="S3.p5.6.m1.1.1.1.1.1.cmml"><mo id="S3.p5.6.m1.1.1.1.1.2" stretchy="false" xref="S3.p5.6.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.p5.6.m1.1.1.1.1.1" xref="S3.p5.6.m1.1.1.1.1.1.cmml"><mi id="S3.p5.6.m1.1.1.1.1.1.2" xref="S3.p5.6.m1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S3.p5.6.m1.1.1.1.1.1.1" xref="S3.p5.6.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.p5.6.m1.1.1.1.1.1.3" xref="S3.p5.6.m1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.p5.6.m1.1.1.1.1.3" stretchy="false" xref="S3.p5.6.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.6.m1.1b"><apply id="S3.p5.6.m1.1.1.cmml" xref="S3.p5.6.m1.1.1"><times id="S3.p5.6.m1.1.1.2.cmml" xref="S3.p5.6.m1.1.1.2"></times><apply id="S3.p5.6.m1.1.1.3.cmml" xref="S3.p5.6.m1.1.1.3"><ci id="S3.p5.6.m1.1.1.3.1.cmml" xref="S3.p5.6.m1.1.1.3.1">~</ci><ci id="S3.p5.6.m1.1.1.3.2.cmml" xref="S3.p5.6.m1.1.1.3.2">𝑃</ci></apply><apply id="S3.p5.6.m1.1.1.1.1.1.cmml" xref="S3.p5.6.m1.1.1.1.1"><csymbol cd="latexml" id="S3.p5.6.m1.1.1.1.1.1.1.cmml" xref="S3.p5.6.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.p5.6.m1.1.1.1.1.1.2.cmml" xref="S3.p5.6.m1.1.1.1.1.1.2">𝑦</ci><ci id="S3.p5.6.m1.1.1.1.1.1.3.cmml" xref="S3.p5.6.m1.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.6.m1.1c">\tilde{P}(y|x)</annotation><annotation encoding="application/x-llamapun" id="S3.p5.6.m1.1d">over~ start_ARG italic_P end_ARG ( italic_y | italic_x )</annotation></semantics></math> is the truncated softmax <math alttext="g(y)" class="ltx_Math" display="inline" id="S3.p5.7.m2.1"><semantics id="S3.p5.7.m2.1a"><mrow id="S3.p5.7.m2.1.2" xref="S3.p5.7.m2.1.2.cmml"><mi id="S3.p5.7.m2.1.2.2" xref="S3.p5.7.m2.1.2.2.cmml">g</mi><mo id="S3.p5.7.m2.1.2.1" xref="S3.p5.7.m2.1.2.1.cmml">⁢</mo><mrow id="S3.p5.7.m2.1.2.3.2" xref="S3.p5.7.m2.1.2.cmml"><mo id="S3.p5.7.m2.1.2.3.2.1" stretchy="false" xref="S3.p5.7.m2.1.2.cmml">(</mo><mi id="S3.p5.7.m2.1.1" xref="S3.p5.7.m2.1.1.cmml">y</mi><mo id="S3.p5.7.m2.1.2.3.2.2" stretchy="false" xref="S3.p5.7.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.7.m2.1b"><apply id="S3.p5.7.m2.1.2.cmml" xref="S3.p5.7.m2.1.2"><times id="S3.p5.7.m2.1.2.1.cmml" xref="S3.p5.7.m2.1.2.1"></times><ci id="S3.p5.7.m2.1.2.2.cmml" xref="S3.p5.7.m2.1.2.2">𝑔</ci><ci id="S3.p5.7.m2.1.1.cmml" xref="S3.p5.7.m2.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.7.m2.1c">g(y)</annotation><annotation encoding="application/x-llamapun" id="S3.p5.7.m2.1d">italic_g ( italic_y )</annotation></semantics></math> (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S2.E3" title="In 2 Background ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">3</span></a>). The mean-squared error loss directly tries to match the target encoder model’s embeddings.
The cross-entropy loss down-weights the importance of targets <math alttext="y" class="ltx_Math" display="inline" id="S3.p5.8.m3.1"><semantics id="S3.p5.8.m3.1a"><mi id="S3.p5.8.m3.1.1" xref="S3.p5.8.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.p5.8.m3.1b"><ci id="S3.p5.8.m3.1.1.cmml" xref="S3.p5.8.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.8.m3.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.p5.8.m3.1d">italic_y</annotation></semantics></math> which do not contribute substantial probability to <math alttext="P(y|x)" class="ltx_Math" display="inline" id="S3.p5.9.m4.1"><semantics id="S3.p5.9.m4.1a"><mrow id="S3.p5.9.m4.1.1" xref="S3.p5.9.m4.1.1.cmml"><mi id="S3.p5.9.m4.1.1.3" xref="S3.p5.9.m4.1.1.3.cmml">P</mi><mo id="S3.p5.9.m4.1.1.2" xref="S3.p5.9.m4.1.1.2.cmml">⁢</mo><mrow id="S3.p5.9.m4.1.1.1.1" xref="S3.p5.9.m4.1.1.1.1.1.cmml"><mo id="S3.p5.9.m4.1.1.1.1.2" stretchy="false" xref="S3.p5.9.m4.1.1.1.1.1.cmml">(</mo><mrow id="S3.p5.9.m4.1.1.1.1.1" xref="S3.p5.9.m4.1.1.1.1.1.cmml"><mi id="S3.p5.9.m4.1.1.1.1.1.2" xref="S3.p5.9.m4.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S3.p5.9.m4.1.1.1.1.1.1" xref="S3.p5.9.m4.1.1.1.1.1.1.cmml">|</mo><mi id="S3.p5.9.m4.1.1.1.1.1.3" xref="S3.p5.9.m4.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.p5.9.m4.1.1.1.1.3" stretchy="false" xref="S3.p5.9.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.9.m4.1b"><apply id="S3.p5.9.m4.1.1.cmml" xref="S3.p5.9.m4.1.1"><times id="S3.p5.9.m4.1.1.2.cmml" xref="S3.p5.9.m4.1.1.2"></times><ci id="S3.p5.9.m4.1.1.3.cmml" xref="S3.p5.9.m4.1.1.3">𝑃</ci><apply id="S3.p5.9.m4.1.1.1.1.1.cmml" xref="S3.p5.9.m4.1.1.1.1"><csymbol cd="latexml" id="S3.p5.9.m4.1.1.1.1.1.1.cmml" xref="S3.p5.9.m4.1.1.1.1.1.1">conditional</csymbol><ci id="S3.p5.9.m4.1.1.1.1.1.2.cmml" xref="S3.p5.9.m4.1.1.1.1.1.2">𝑦</ci><ci id="S3.p5.9.m4.1.1.1.1.1.3.cmml" xref="S3.p5.9.m4.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.9.m4.1c">P(y|x)</annotation><annotation encoding="application/x-llamapun" id="S3.p5.9.m4.1d">italic_P ( italic_y | italic_x )</annotation></semantics></math> and allows for greater use of model capacity.
The parameters of the target corrector networks are optimized using gradient descent.
Empirically, we find the cross-entropy objective to perform slightly better (Table <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S5.T1" title="Table 1 ‣ 5.1 Supervised Dense Retrieval ‣ 5 Experiments ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">1</span></a>) and focus the presentation on cross-entropy.</p>
</div>
<div class="ltx_para" id="S3.p6">
<p class="ltx_p" id="S3.p6.1"><span class="ltx_text ltx_font_bold" id="S3.p6.1.1">Jointly Training Corrector Networks &amp; Dual-Encoders </span>
We present a method (Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#alg1" title="Algorithm 1 ‣ 3 Improving Training with Target Correctors ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">1</span></a>) for simultaneously training dual-encoders for a given task (e.g., retrieval or equivalently large output-space classification)
and the target corrector network. The training algorithm will optimize both the
parameters of the target corrector network and additionally use the corrector network to approximate the softmax. Each step consists of: (1) using the corrector network to provide an approximately updated representation of every target, (2) picking a subset of targets for the truncated softmax using the output of the corrector network, (3) computing a task loss for the dual-encoder models and loss for the corrector networks, (4) updating, according to their respective losses, the parameters for both the dual-encoders and the corrector networks using gradient descent.</p>
</div>
<div class="ltx_para" id="S3.p7">
<p class="ltx_p" id="S3.p7.13">In more detail, we are given task training data, <math alttext="X=\{(x_{1},y_{1}),\dots,(x_{m},y_{m})\}" class="ltx_Math" display="inline" id="S3.p7.1.m1.3"><semantics id="S3.p7.1.m1.3a"><mrow id="S3.p7.1.m1.3.3" xref="S3.p7.1.m1.3.3.cmml"><mi id="S3.p7.1.m1.3.3.4" xref="S3.p7.1.m1.3.3.4.cmml">X</mi><mo id="S3.p7.1.m1.3.3.3" xref="S3.p7.1.m1.3.3.3.cmml">=</mo><mrow id="S3.p7.1.m1.3.3.2.2" xref="S3.p7.1.m1.3.3.2.3.cmml"><mo id="S3.p7.1.m1.3.3.2.2.3" stretchy="false" xref="S3.p7.1.m1.3.3.2.3.cmml">{</mo><mrow id="S3.p7.1.m1.2.2.1.1.1.2" xref="S3.p7.1.m1.2.2.1.1.1.3.cmml"><mo id="S3.p7.1.m1.2.2.1.1.1.2.3" stretchy="false" xref="S3.p7.1.m1.2.2.1.1.1.3.cmml">(</mo><msub id="S3.p7.1.m1.2.2.1.1.1.1.1" xref="S3.p7.1.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.p7.1.m1.2.2.1.1.1.1.1.2" xref="S3.p7.1.m1.2.2.1.1.1.1.1.2.cmml">x</mi><mn id="S3.p7.1.m1.2.2.1.1.1.1.1.3" xref="S3.p7.1.m1.2.2.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.p7.1.m1.2.2.1.1.1.2.4" xref="S3.p7.1.m1.2.2.1.1.1.3.cmml">,</mo><msub id="S3.p7.1.m1.2.2.1.1.1.2.2" xref="S3.p7.1.m1.2.2.1.1.1.2.2.cmml"><mi id="S3.p7.1.m1.2.2.1.1.1.2.2.2" xref="S3.p7.1.m1.2.2.1.1.1.2.2.2.cmml">y</mi><mn id="S3.p7.1.m1.2.2.1.1.1.2.2.3" xref="S3.p7.1.m1.2.2.1.1.1.2.2.3.cmml">1</mn></msub><mo id="S3.p7.1.m1.2.2.1.1.1.2.5" stretchy="false" xref="S3.p7.1.m1.2.2.1.1.1.3.cmml">)</mo></mrow><mo id="S3.p7.1.m1.3.3.2.2.4" xref="S3.p7.1.m1.3.3.2.3.cmml">,</mo><mi id="S3.p7.1.m1.1.1" mathvariant="normal" xref="S3.p7.1.m1.1.1.cmml">…</mi><mo id="S3.p7.1.m1.3.3.2.2.5" xref="S3.p7.1.m1.3.3.2.3.cmml">,</mo><mrow id="S3.p7.1.m1.3.3.2.2.2.2" xref="S3.p7.1.m1.3.3.2.2.2.3.cmml"><mo id="S3.p7.1.m1.3.3.2.2.2.2.3" stretchy="false" xref="S3.p7.1.m1.3.3.2.2.2.3.cmml">(</mo><msub id="S3.p7.1.m1.3.3.2.2.2.1.1" xref="S3.p7.1.m1.3.3.2.2.2.1.1.cmml"><mi id="S3.p7.1.m1.3.3.2.2.2.1.1.2" xref="S3.p7.1.m1.3.3.2.2.2.1.1.2.cmml">x</mi><mi id="S3.p7.1.m1.3.3.2.2.2.1.1.3" xref="S3.p7.1.m1.3.3.2.2.2.1.1.3.cmml">m</mi></msub><mo id="S3.p7.1.m1.3.3.2.2.2.2.4" xref="S3.p7.1.m1.3.3.2.2.2.3.cmml">,</mo><msub id="S3.p7.1.m1.3.3.2.2.2.2.2" xref="S3.p7.1.m1.3.3.2.2.2.2.2.cmml"><mi id="S3.p7.1.m1.3.3.2.2.2.2.2.2" xref="S3.p7.1.m1.3.3.2.2.2.2.2.2.cmml">y</mi><mi id="S3.p7.1.m1.3.3.2.2.2.2.2.3" xref="S3.p7.1.m1.3.3.2.2.2.2.2.3.cmml">m</mi></msub><mo id="S3.p7.1.m1.3.3.2.2.2.2.5" stretchy="false" xref="S3.p7.1.m1.3.3.2.2.2.3.cmml">)</mo></mrow><mo id="S3.p7.1.m1.3.3.2.2.6" stretchy="false" xref="S3.p7.1.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p7.1.m1.3b"><apply id="S3.p7.1.m1.3.3.cmml" xref="S3.p7.1.m1.3.3"><eq id="S3.p7.1.m1.3.3.3.cmml" xref="S3.p7.1.m1.3.3.3"></eq><ci id="S3.p7.1.m1.3.3.4.cmml" xref="S3.p7.1.m1.3.3.4">𝑋</ci><set id="S3.p7.1.m1.3.3.2.3.cmml" xref="S3.p7.1.m1.3.3.2.2"><interval closure="open" id="S3.p7.1.m1.2.2.1.1.1.3.cmml" xref="S3.p7.1.m1.2.2.1.1.1.2"><apply id="S3.p7.1.m1.2.2.1.1.1.1.1.cmml" xref="S3.p7.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p7.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.p7.1.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.p7.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.p7.1.m1.2.2.1.1.1.1.1.2">𝑥</ci><cn id="S3.p7.1.m1.2.2.1.1.1.1.1.3.cmml" type="integer" xref="S3.p7.1.m1.2.2.1.1.1.1.1.3">1</cn></apply><apply id="S3.p7.1.m1.2.2.1.1.1.2.2.cmml" xref="S3.p7.1.m1.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.p7.1.m1.2.2.1.1.1.2.2.1.cmml" xref="S3.p7.1.m1.2.2.1.1.1.2.2">subscript</csymbol><ci id="S3.p7.1.m1.2.2.1.1.1.2.2.2.cmml" xref="S3.p7.1.m1.2.2.1.1.1.2.2.2">𝑦</ci><cn id="S3.p7.1.m1.2.2.1.1.1.2.2.3.cmml" type="integer" xref="S3.p7.1.m1.2.2.1.1.1.2.2.3">1</cn></apply></interval><ci id="S3.p7.1.m1.1.1.cmml" xref="S3.p7.1.m1.1.1">…</ci><interval closure="open" id="S3.p7.1.m1.3.3.2.2.2.3.cmml" xref="S3.p7.1.m1.3.3.2.2.2.2"><apply id="S3.p7.1.m1.3.3.2.2.2.1.1.cmml" xref="S3.p7.1.m1.3.3.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.p7.1.m1.3.3.2.2.2.1.1.1.cmml" xref="S3.p7.1.m1.3.3.2.2.2.1.1">subscript</csymbol><ci id="S3.p7.1.m1.3.3.2.2.2.1.1.2.cmml" xref="S3.p7.1.m1.3.3.2.2.2.1.1.2">𝑥</ci><ci id="S3.p7.1.m1.3.3.2.2.2.1.1.3.cmml" xref="S3.p7.1.m1.3.3.2.2.2.1.1.3">𝑚</ci></apply><apply id="S3.p7.1.m1.3.3.2.2.2.2.2.cmml" xref="S3.p7.1.m1.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p7.1.m1.3.3.2.2.2.2.2.1.cmml" xref="S3.p7.1.m1.3.3.2.2.2.2.2">subscript</csymbol><ci id="S3.p7.1.m1.3.3.2.2.2.2.2.2.cmml" xref="S3.p7.1.m1.3.3.2.2.2.2.2.2">𝑦</ci><ci id="S3.p7.1.m1.3.3.2.2.2.2.2.3.cmml" xref="S3.p7.1.m1.3.3.2.2.2.2.2.3">𝑚</ci></apply></interval></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.1.m1.3c">X=\{(x_{1},y_{1}),\dots,(x_{m},y_{m})\}</annotation><annotation encoding="application/x-llamapun" id="S3.p7.1.m1.3d">italic_X = { ( italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) , … , ( italic_x start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ) }</annotation></semantics></math>. We are given a task loss function <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.p7.2.m2.1"><semantics id="S3.p7.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p7.2.m2.1.1" xref="S3.p7.2.m2.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.p7.2.m2.1b"><ci id="S3.p7.2.m2.1.1.cmml" xref="S3.p7.2.m2.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.2.m2.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.p7.2.m2.1d">caligraphic_L</annotation></semantics></math> and a corrector network loss <math alttext="\ell" class="ltx_Math" display="inline" id="S3.p7.3.m3.1"><semantics id="S3.p7.3.m3.1a"><mi id="S3.p7.3.m3.1.1" mathvariant="normal" xref="S3.p7.3.m3.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="S3.p7.3.m3.1b"><ci id="S3.p7.3.m3.1.1.cmml" xref="S3.p7.3.m3.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.3.m3.1c">\ell</annotation><annotation encoding="application/x-llamapun" id="S3.p7.3.m3.1d">roman_ℓ</annotation></semantics></math>. The dual-encoder models are <math alttext="f(x),g(y)" class="ltx_Math" display="inline" id="S3.p7.4.m4.4"><semantics id="S3.p7.4.m4.4a"><mrow id="S3.p7.4.m4.4.4.2" xref="S3.p7.4.m4.4.4.3.cmml"><mrow id="S3.p7.4.m4.3.3.1.1" xref="S3.p7.4.m4.3.3.1.1.cmml"><mi id="S3.p7.4.m4.3.3.1.1.2" xref="S3.p7.4.m4.3.3.1.1.2.cmml">f</mi><mo id="S3.p7.4.m4.3.3.1.1.1" xref="S3.p7.4.m4.3.3.1.1.1.cmml">⁢</mo><mrow id="S3.p7.4.m4.3.3.1.1.3.2" xref="S3.p7.4.m4.3.3.1.1.cmml"><mo id="S3.p7.4.m4.3.3.1.1.3.2.1" stretchy="false" xref="S3.p7.4.m4.3.3.1.1.cmml">(</mo><mi id="S3.p7.4.m4.1.1" xref="S3.p7.4.m4.1.1.cmml">x</mi><mo id="S3.p7.4.m4.3.3.1.1.3.2.2" stretchy="false" xref="S3.p7.4.m4.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="S3.p7.4.m4.4.4.2.3" xref="S3.p7.4.m4.4.4.3.cmml">,</mo><mrow id="S3.p7.4.m4.4.4.2.2" xref="S3.p7.4.m4.4.4.2.2.cmml"><mi id="S3.p7.4.m4.4.4.2.2.2" xref="S3.p7.4.m4.4.4.2.2.2.cmml">g</mi><mo id="S3.p7.4.m4.4.4.2.2.1" xref="S3.p7.4.m4.4.4.2.2.1.cmml">⁢</mo><mrow id="S3.p7.4.m4.4.4.2.2.3.2" xref="S3.p7.4.m4.4.4.2.2.cmml"><mo id="S3.p7.4.m4.4.4.2.2.3.2.1" stretchy="false" xref="S3.p7.4.m4.4.4.2.2.cmml">(</mo><mi id="S3.p7.4.m4.2.2" xref="S3.p7.4.m4.2.2.cmml">y</mi><mo id="S3.p7.4.m4.4.4.2.2.3.2.2" stretchy="false" xref="S3.p7.4.m4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p7.4.m4.4b"><list id="S3.p7.4.m4.4.4.3.cmml" xref="S3.p7.4.m4.4.4.2"><apply id="S3.p7.4.m4.3.3.1.1.cmml" xref="S3.p7.4.m4.3.3.1.1"><times id="S3.p7.4.m4.3.3.1.1.1.cmml" xref="S3.p7.4.m4.3.3.1.1.1"></times><ci id="S3.p7.4.m4.3.3.1.1.2.cmml" xref="S3.p7.4.m4.3.3.1.1.2">𝑓</ci><ci id="S3.p7.4.m4.1.1.cmml" xref="S3.p7.4.m4.1.1">𝑥</ci></apply><apply id="S3.p7.4.m4.4.4.2.2.cmml" xref="S3.p7.4.m4.4.4.2.2"><times id="S3.p7.4.m4.4.4.2.2.1.cmml" xref="S3.p7.4.m4.4.4.2.2.1"></times><ci id="S3.p7.4.m4.4.4.2.2.2.cmml" xref="S3.p7.4.m4.4.4.2.2.2">𝑔</ci><ci id="S3.p7.4.m4.2.2.cmml" xref="S3.p7.4.m4.2.2">𝑦</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.4.m4.4c">f(x),g(y)</annotation><annotation encoding="application/x-llamapun" id="S3.p7.4.m4.4d">italic_f ( italic_x ) , italic_g ( italic_y )</annotation></semantics></math> and their initial parameters are <math alttext="\Theta_{0}" class="ltx_Math" display="inline" id="S3.p7.5.m5.1"><semantics id="S3.p7.5.m5.1a"><msub id="S3.p7.5.m5.1.1" xref="S3.p7.5.m5.1.1.cmml"><mi id="S3.p7.5.m5.1.1.2" mathvariant="normal" xref="S3.p7.5.m5.1.1.2.cmml">Θ</mi><mn id="S3.p7.5.m5.1.1.3" xref="S3.p7.5.m5.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p7.5.m5.1b"><apply id="S3.p7.5.m5.1.1.cmml" xref="S3.p7.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p7.5.m5.1.1.1.cmml" xref="S3.p7.5.m5.1.1">subscript</csymbol><ci id="S3.p7.5.m5.1.1.2.cmml" xref="S3.p7.5.m5.1.1.2">Θ</ci><cn id="S3.p7.5.m5.1.1.3.cmml" type="integer" xref="S3.p7.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.5.m5.1c">\Theta_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.p7.5.m5.1d">roman_Θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>.
Prior to the first training step, we instantiate a buffer of the targets’ representations, <math alttext="B_{y}=g^{\prime}(y)=g(y;\Theta_{0})" class="ltx_Math" display="inline" id="S3.p7.6.m6.3"><semantics id="S3.p7.6.m6.3a"><mrow id="S3.p7.6.m6.3.3" xref="S3.p7.6.m6.3.3.cmml"><msub id="S3.p7.6.m6.3.3.3" xref="S3.p7.6.m6.3.3.3.cmml"><mi id="S3.p7.6.m6.3.3.3.2" xref="S3.p7.6.m6.3.3.3.2.cmml">B</mi><mi id="S3.p7.6.m6.3.3.3.3" xref="S3.p7.6.m6.3.3.3.3.cmml">y</mi></msub><mo id="S3.p7.6.m6.3.3.4" xref="S3.p7.6.m6.3.3.4.cmml">=</mo><mrow id="S3.p7.6.m6.3.3.5" xref="S3.p7.6.m6.3.3.5.cmml"><msup id="S3.p7.6.m6.3.3.5.2" xref="S3.p7.6.m6.3.3.5.2.cmml"><mi id="S3.p7.6.m6.3.3.5.2.2" xref="S3.p7.6.m6.3.3.5.2.2.cmml">g</mi><mo id="S3.p7.6.m6.3.3.5.2.3" xref="S3.p7.6.m6.3.3.5.2.3.cmml">′</mo></msup><mo id="S3.p7.6.m6.3.3.5.1" xref="S3.p7.6.m6.3.3.5.1.cmml">⁢</mo><mrow id="S3.p7.6.m6.3.3.5.3.2" xref="S3.p7.6.m6.3.3.5.cmml"><mo id="S3.p7.6.m6.3.3.5.3.2.1" stretchy="false" xref="S3.p7.6.m6.3.3.5.cmml">(</mo><mi id="S3.p7.6.m6.1.1" xref="S3.p7.6.m6.1.1.cmml">y</mi><mo id="S3.p7.6.m6.3.3.5.3.2.2" stretchy="false" xref="S3.p7.6.m6.3.3.5.cmml">)</mo></mrow></mrow><mo id="S3.p7.6.m6.3.3.6" xref="S3.p7.6.m6.3.3.6.cmml">=</mo><mrow id="S3.p7.6.m6.3.3.1" xref="S3.p7.6.m6.3.3.1.cmml"><mi id="S3.p7.6.m6.3.3.1.3" xref="S3.p7.6.m6.3.3.1.3.cmml">g</mi><mo id="S3.p7.6.m6.3.3.1.2" xref="S3.p7.6.m6.3.3.1.2.cmml">⁢</mo><mrow id="S3.p7.6.m6.3.3.1.1.1" xref="S3.p7.6.m6.3.3.1.1.2.cmml"><mo id="S3.p7.6.m6.3.3.1.1.1.2" stretchy="false" xref="S3.p7.6.m6.3.3.1.1.2.cmml">(</mo><mi id="S3.p7.6.m6.2.2" xref="S3.p7.6.m6.2.2.cmml">y</mi><mo id="S3.p7.6.m6.3.3.1.1.1.3" xref="S3.p7.6.m6.3.3.1.1.2.cmml">;</mo><msub id="S3.p7.6.m6.3.3.1.1.1.1" xref="S3.p7.6.m6.3.3.1.1.1.1.cmml"><mi id="S3.p7.6.m6.3.3.1.1.1.1.2" mathvariant="normal" xref="S3.p7.6.m6.3.3.1.1.1.1.2.cmml">Θ</mi><mn id="S3.p7.6.m6.3.3.1.1.1.1.3" xref="S3.p7.6.m6.3.3.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.p7.6.m6.3.3.1.1.1.4" stretchy="false" xref="S3.p7.6.m6.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p7.6.m6.3b"><apply id="S3.p7.6.m6.3.3.cmml" xref="S3.p7.6.m6.3.3"><and id="S3.p7.6.m6.3.3a.cmml" xref="S3.p7.6.m6.3.3"></and><apply id="S3.p7.6.m6.3.3b.cmml" xref="S3.p7.6.m6.3.3"><eq id="S3.p7.6.m6.3.3.4.cmml" xref="S3.p7.6.m6.3.3.4"></eq><apply id="S3.p7.6.m6.3.3.3.cmml" xref="S3.p7.6.m6.3.3.3"><csymbol cd="ambiguous" id="S3.p7.6.m6.3.3.3.1.cmml" xref="S3.p7.6.m6.3.3.3">subscript</csymbol><ci id="S3.p7.6.m6.3.3.3.2.cmml" xref="S3.p7.6.m6.3.3.3.2">𝐵</ci><ci id="S3.p7.6.m6.3.3.3.3.cmml" xref="S3.p7.6.m6.3.3.3.3">𝑦</ci></apply><apply id="S3.p7.6.m6.3.3.5.cmml" xref="S3.p7.6.m6.3.3.5"><times id="S3.p7.6.m6.3.3.5.1.cmml" xref="S3.p7.6.m6.3.3.5.1"></times><apply id="S3.p7.6.m6.3.3.5.2.cmml" xref="S3.p7.6.m6.3.3.5.2"><csymbol cd="ambiguous" id="S3.p7.6.m6.3.3.5.2.1.cmml" xref="S3.p7.6.m6.3.3.5.2">superscript</csymbol><ci id="S3.p7.6.m6.3.3.5.2.2.cmml" xref="S3.p7.6.m6.3.3.5.2.2">𝑔</ci><ci id="S3.p7.6.m6.3.3.5.2.3.cmml" xref="S3.p7.6.m6.3.3.5.2.3">′</ci></apply><ci id="S3.p7.6.m6.1.1.cmml" xref="S3.p7.6.m6.1.1">𝑦</ci></apply></apply><apply id="S3.p7.6.m6.3.3c.cmml" xref="S3.p7.6.m6.3.3"><eq id="S3.p7.6.m6.3.3.6.cmml" xref="S3.p7.6.m6.3.3.6"></eq><share href="https://arxiv.org/html/2409.01890v1#S3.p7.6.m6.3.3.5.cmml" id="S3.p7.6.m6.3.3d.cmml" xref="S3.p7.6.m6.3.3"></share><apply id="S3.p7.6.m6.3.3.1.cmml" xref="S3.p7.6.m6.3.3.1"><times id="S3.p7.6.m6.3.3.1.2.cmml" xref="S3.p7.6.m6.3.3.1.2"></times><ci id="S3.p7.6.m6.3.3.1.3.cmml" xref="S3.p7.6.m6.3.3.1.3">𝑔</ci><list id="S3.p7.6.m6.3.3.1.1.2.cmml" xref="S3.p7.6.m6.3.3.1.1.1"><ci id="S3.p7.6.m6.2.2.cmml" xref="S3.p7.6.m6.2.2">𝑦</ci><apply id="S3.p7.6.m6.3.3.1.1.1.1.cmml" xref="S3.p7.6.m6.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.p7.6.m6.3.3.1.1.1.1.1.cmml" xref="S3.p7.6.m6.3.3.1.1.1.1">subscript</csymbol><ci id="S3.p7.6.m6.3.3.1.1.1.1.2.cmml" xref="S3.p7.6.m6.3.3.1.1.1.1.2">Θ</ci><cn id="S3.p7.6.m6.3.3.1.1.1.1.3.cmml" type="integer" xref="S3.p7.6.m6.3.3.1.1.1.1.3">0</cn></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.6.m6.3c">B_{y}=g^{\prime}(y)=g(y;\Theta_{0})</annotation><annotation encoding="application/x-llamapun" id="S3.p7.6.m6.3d">italic_B start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT = italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y ) = italic_g ( italic_y ; roman_Θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math>. We will avert the need for the expensive updating of the buffer by re-embedding targets with the target encoder.
In each step, we sample a training point and label pair <math alttext="x_{i},y_{i}" class="ltx_Math" display="inline" id="S3.p7.7.m7.2"><semantics id="S3.p7.7.m7.2a"><mrow id="S3.p7.7.m7.2.2.2" xref="S3.p7.7.m7.2.2.3.cmml"><msub id="S3.p7.7.m7.1.1.1.1" xref="S3.p7.7.m7.1.1.1.1.cmml"><mi id="S3.p7.7.m7.1.1.1.1.2" xref="S3.p7.7.m7.1.1.1.1.2.cmml">x</mi><mi id="S3.p7.7.m7.1.1.1.1.3" xref="S3.p7.7.m7.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.p7.7.m7.2.2.2.3" xref="S3.p7.7.m7.2.2.3.cmml">,</mo><msub id="S3.p7.7.m7.2.2.2.2" xref="S3.p7.7.m7.2.2.2.2.cmml"><mi id="S3.p7.7.m7.2.2.2.2.2" xref="S3.p7.7.m7.2.2.2.2.2.cmml">y</mi><mi id="S3.p7.7.m7.2.2.2.2.3" xref="S3.p7.7.m7.2.2.2.2.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.p7.7.m7.2b"><list id="S3.p7.7.m7.2.2.3.cmml" xref="S3.p7.7.m7.2.2.2"><apply id="S3.p7.7.m7.1.1.1.1.cmml" xref="S3.p7.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S3.p7.7.m7.1.1.1.1.1.cmml" xref="S3.p7.7.m7.1.1.1.1">subscript</csymbol><ci id="S3.p7.7.m7.1.1.1.1.2.cmml" xref="S3.p7.7.m7.1.1.1.1.2">𝑥</ci><ci id="S3.p7.7.m7.1.1.1.1.3.cmml" xref="S3.p7.7.m7.1.1.1.1.3">𝑖</ci></apply><apply id="S3.p7.7.m7.2.2.2.2.cmml" xref="S3.p7.7.m7.2.2.2.2"><csymbol cd="ambiguous" id="S3.p7.7.m7.2.2.2.2.1.cmml" xref="S3.p7.7.m7.2.2.2.2">subscript</csymbol><ci id="S3.p7.7.m7.2.2.2.2.2.cmml" xref="S3.p7.7.m7.2.2.2.2.2">𝑦</ci><ci id="S3.p7.7.m7.2.2.2.2.3.cmml" xref="S3.p7.7.m7.2.2.2.2.3">𝑖</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.7.m7.2c">x_{i},y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p7.7.m7.2d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> from <math alttext="X" class="ltx_Math" display="inline" id="S3.p7.8.m8.1"><semantics id="S3.p7.8.m8.1a"><mi id="S3.p7.8.m8.1.1" xref="S3.p7.8.m8.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.p7.8.m8.1b"><ci id="S3.p7.8.m8.1.1.cmml" xref="S3.p7.8.m8.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.8.m8.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.p7.8.m8.1d">italic_X</annotation></semantics></math>. We apply the target corrector network to all of the stale representations in the buffer to obtain <math alttext="h\circ g^{\prime}(y)\ \forall y\in\mathcal{Y}" class="ltx_Math" display="inline" id="S3.p7.9.m9.1"><semantics id="S3.p7.9.m9.1a"><mrow id="S3.p7.9.m9.1.2" xref="S3.p7.9.m9.1.2.cmml"><mrow id="S3.p7.9.m9.1.2.2" xref="S3.p7.9.m9.1.2.2.cmml"><mrow id="S3.p7.9.m9.1.2.2.2" xref="S3.p7.9.m9.1.2.2.2.cmml"><mi id="S3.p7.9.m9.1.2.2.2.2" xref="S3.p7.9.m9.1.2.2.2.2.cmml">h</mi><mo id="S3.p7.9.m9.1.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.p7.9.m9.1.2.2.2.1.cmml">∘</mo><msup id="S3.p7.9.m9.1.2.2.2.3" xref="S3.p7.9.m9.1.2.2.2.3.cmml"><mi id="S3.p7.9.m9.1.2.2.2.3.2" xref="S3.p7.9.m9.1.2.2.2.3.2.cmml">g</mi><mo id="S3.p7.9.m9.1.2.2.2.3.3" xref="S3.p7.9.m9.1.2.2.2.3.3.cmml">′</mo></msup></mrow><mo id="S3.p7.9.m9.1.2.2.1" xref="S3.p7.9.m9.1.2.2.1.cmml">⁢</mo><mrow id="S3.p7.9.m9.1.2.2.3.2" xref="S3.p7.9.m9.1.2.2.cmml"><mo id="S3.p7.9.m9.1.2.2.3.2.1" stretchy="false" xref="S3.p7.9.m9.1.2.2.cmml">(</mo><mi id="S3.p7.9.m9.1.1" xref="S3.p7.9.m9.1.1.cmml">y</mi><mo id="S3.p7.9.m9.1.2.2.3.2.2" stretchy="false" xref="S3.p7.9.m9.1.2.2.cmml">)</mo></mrow><mo id="S3.p7.9.m9.1.2.2.1a" lspace="0.667em" xref="S3.p7.9.m9.1.2.2.1.cmml">⁢</mo><mrow id="S3.p7.9.m9.1.2.2.4" xref="S3.p7.9.m9.1.2.2.4.cmml"><mo id="S3.p7.9.m9.1.2.2.4.1" rspace="0.167em" xref="S3.p7.9.m9.1.2.2.4.1.cmml">∀</mo><mi id="S3.p7.9.m9.1.2.2.4.2" xref="S3.p7.9.m9.1.2.2.4.2.cmml">y</mi></mrow></mrow><mo id="S3.p7.9.m9.1.2.1" xref="S3.p7.9.m9.1.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p7.9.m9.1.2.3" xref="S3.p7.9.m9.1.2.3.cmml">𝒴</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p7.9.m9.1b"><apply id="S3.p7.9.m9.1.2.cmml" xref="S3.p7.9.m9.1.2"><in id="S3.p7.9.m9.1.2.1.cmml" xref="S3.p7.9.m9.1.2.1"></in><apply id="S3.p7.9.m9.1.2.2.cmml" xref="S3.p7.9.m9.1.2.2"><times id="S3.p7.9.m9.1.2.2.1.cmml" xref="S3.p7.9.m9.1.2.2.1"></times><apply id="S3.p7.9.m9.1.2.2.2.cmml" xref="S3.p7.9.m9.1.2.2.2"><compose id="S3.p7.9.m9.1.2.2.2.1.cmml" xref="S3.p7.9.m9.1.2.2.2.1"></compose><ci id="S3.p7.9.m9.1.2.2.2.2.cmml" xref="S3.p7.9.m9.1.2.2.2.2">ℎ</ci><apply id="S3.p7.9.m9.1.2.2.2.3.cmml" xref="S3.p7.9.m9.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.p7.9.m9.1.2.2.2.3.1.cmml" xref="S3.p7.9.m9.1.2.2.2.3">superscript</csymbol><ci id="S3.p7.9.m9.1.2.2.2.3.2.cmml" xref="S3.p7.9.m9.1.2.2.2.3.2">𝑔</ci><ci id="S3.p7.9.m9.1.2.2.2.3.3.cmml" xref="S3.p7.9.m9.1.2.2.2.3.3">′</ci></apply></apply><ci id="S3.p7.9.m9.1.1.cmml" xref="S3.p7.9.m9.1.1">𝑦</ci><apply id="S3.p7.9.m9.1.2.2.4.cmml" xref="S3.p7.9.m9.1.2.2.4"><csymbol cd="latexml" id="S3.p7.9.m9.1.2.2.4.1.cmml" xref="S3.p7.9.m9.1.2.2.4.1">for-all</csymbol><ci id="S3.p7.9.m9.1.2.2.4.2.cmml" xref="S3.p7.9.m9.1.2.2.4.2">𝑦</ci></apply></apply><ci id="S3.p7.9.m9.1.2.3.cmml" xref="S3.p7.9.m9.1.2.3">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.9.m9.1c">h\circ g^{\prime}(y)\ \forall y\in\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="S3.p7.9.m9.1d">italic_h ∘ italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y ) ∀ italic_y ∈ caligraphic_Y</annotation></semantics></math>. This computation does not require running a dual-encoder; we use the cached buffer representation of each target as input to the corrector network. The corrector network is typically a two-layer MLP and hence efficient enough to be used in this way. With these representations from <math alttext="h(\cdot)" class="ltx_Math" display="inline" id="S3.p7.10.m10.1"><semantics id="S3.p7.10.m10.1a"><mrow id="S3.p7.10.m10.1.2" xref="S3.p7.10.m10.1.2.cmml"><mi id="S3.p7.10.m10.1.2.2" xref="S3.p7.10.m10.1.2.2.cmml">h</mi><mo id="S3.p7.10.m10.1.2.1" xref="S3.p7.10.m10.1.2.1.cmml">⁢</mo><mrow id="S3.p7.10.m10.1.2.3.2" xref="S3.p7.10.m10.1.2.cmml"><mo id="S3.p7.10.m10.1.2.3.2.1" stretchy="false" xref="S3.p7.10.m10.1.2.cmml">(</mo><mo id="S3.p7.10.m10.1.1" lspace="0em" rspace="0em" xref="S3.p7.10.m10.1.1.cmml">⋅</mo><mo id="S3.p7.10.m10.1.2.3.2.2" stretchy="false" xref="S3.p7.10.m10.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p7.10.m10.1b"><apply id="S3.p7.10.m10.1.2.cmml" xref="S3.p7.10.m10.1.2"><times id="S3.p7.10.m10.1.2.1.cmml" xref="S3.p7.10.m10.1.2.1"></times><ci id="S3.p7.10.m10.1.2.2.cmml" xref="S3.p7.10.m10.1.2.2">ℎ</ci><ci id="S3.p7.10.m10.1.1.cmml" xref="S3.p7.10.m10.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.10.m10.1c">h(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.p7.10.m10.1d">italic_h ( ⋅ )</annotation></semantics></math>, we sample (or select exact top-<math alttext="k" class="ltx_Math" display="inline" id="S3.p7.11.m11.1"><semantics id="S3.p7.11.m11.1a"><mi id="S3.p7.11.m11.1.1" xref="S3.p7.11.m11.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p7.11.m11.1b"><ci id="S3.p7.11.m11.1.1.cmml" xref="S3.p7.11.m11.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.11.m11.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.p7.11.m11.1d">italic_k</annotation></semantics></math>) targets according to <math alttext="P_{h}(y|x)" class="ltx_Math" display="inline" id="S3.p7.12.m12.1"><semantics id="S3.p7.12.m12.1a"><mrow id="S3.p7.12.m12.1.1" xref="S3.p7.12.m12.1.1.cmml"><msub id="S3.p7.12.m12.1.1.3" xref="S3.p7.12.m12.1.1.3.cmml"><mi id="S3.p7.12.m12.1.1.3.2" xref="S3.p7.12.m12.1.1.3.2.cmml">P</mi><mi id="S3.p7.12.m12.1.1.3.3" xref="S3.p7.12.m12.1.1.3.3.cmml">h</mi></msub><mo id="S3.p7.12.m12.1.1.2" xref="S3.p7.12.m12.1.1.2.cmml">⁢</mo><mrow id="S3.p7.12.m12.1.1.1.1" xref="S3.p7.12.m12.1.1.1.1.1.cmml"><mo id="S3.p7.12.m12.1.1.1.1.2" stretchy="false" xref="S3.p7.12.m12.1.1.1.1.1.cmml">(</mo><mrow id="S3.p7.12.m12.1.1.1.1.1" xref="S3.p7.12.m12.1.1.1.1.1.cmml"><mi id="S3.p7.12.m12.1.1.1.1.1.2" xref="S3.p7.12.m12.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S3.p7.12.m12.1.1.1.1.1.1" xref="S3.p7.12.m12.1.1.1.1.1.1.cmml">|</mo><mi id="S3.p7.12.m12.1.1.1.1.1.3" xref="S3.p7.12.m12.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.p7.12.m12.1.1.1.1.3" stretchy="false" xref="S3.p7.12.m12.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p7.12.m12.1b"><apply id="S3.p7.12.m12.1.1.cmml" xref="S3.p7.12.m12.1.1"><times id="S3.p7.12.m12.1.1.2.cmml" xref="S3.p7.12.m12.1.1.2"></times><apply id="S3.p7.12.m12.1.1.3.cmml" xref="S3.p7.12.m12.1.1.3"><csymbol cd="ambiguous" id="S3.p7.12.m12.1.1.3.1.cmml" xref="S3.p7.12.m12.1.1.3">subscript</csymbol><ci id="S3.p7.12.m12.1.1.3.2.cmml" xref="S3.p7.12.m12.1.1.3.2">𝑃</ci><ci id="S3.p7.12.m12.1.1.3.3.cmml" xref="S3.p7.12.m12.1.1.3.3">ℎ</ci></apply><apply id="S3.p7.12.m12.1.1.1.1.1.cmml" xref="S3.p7.12.m12.1.1.1.1"><csymbol cd="latexml" id="S3.p7.12.m12.1.1.1.1.1.1.cmml" xref="S3.p7.12.m12.1.1.1.1.1.1">conditional</csymbol><ci id="S3.p7.12.m12.1.1.1.1.1.2.cmml" xref="S3.p7.12.m12.1.1.1.1.1.2">𝑦</ci><ci id="S3.p7.12.m12.1.1.1.1.1.3.cmml" xref="S3.p7.12.m12.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.12.m12.1c">P_{h}(y|x)</annotation><annotation encoding="application/x-llamapun" id="S3.p7.12.m12.1d">italic_P start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ( italic_y | italic_x )</annotation></semantics></math> (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S3.E4" title="In 3 Improving Training with Target Correctors ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">4</span></a>) to form a subset of targets <math alttext="S_{x_{i}}(\mathcal{Y})" class="ltx_Math" display="inline" id="S3.p7.13.m13.1"><semantics id="S3.p7.13.m13.1a"><mrow id="S3.p7.13.m13.1.2" xref="S3.p7.13.m13.1.2.cmml"><msub id="S3.p7.13.m13.1.2.2" xref="S3.p7.13.m13.1.2.2.cmml"><mi id="S3.p7.13.m13.1.2.2.2" xref="S3.p7.13.m13.1.2.2.2.cmml">S</mi><msub id="S3.p7.13.m13.1.2.2.3" xref="S3.p7.13.m13.1.2.2.3.cmml"><mi id="S3.p7.13.m13.1.2.2.3.2" xref="S3.p7.13.m13.1.2.2.3.2.cmml">x</mi><mi id="S3.p7.13.m13.1.2.2.3.3" xref="S3.p7.13.m13.1.2.2.3.3.cmml">i</mi></msub></msub><mo id="S3.p7.13.m13.1.2.1" xref="S3.p7.13.m13.1.2.1.cmml">⁢</mo><mrow id="S3.p7.13.m13.1.2.3.2" xref="S3.p7.13.m13.1.2.cmml"><mo id="S3.p7.13.m13.1.2.3.2.1" stretchy="false" xref="S3.p7.13.m13.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.p7.13.m13.1.1" xref="S3.p7.13.m13.1.1.cmml">𝒴</mi><mo id="S3.p7.13.m13.1.2.3.2.2" stretchy="false" xref="S3.p7.13.m13.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p7.13.m13.1b"><apply id="S3.p7.13.m13.1.2.cmml" xref="S3.p7.13.m13.1.2"><times id="S3.p7.13.m13.1.2.1.cmml" xref="S3.p7.13.m13.1.2.1"></times><apply id="S3.p7.13.m13.1.2.2.cmml" xref="S3.p7.13.m13.1.2.2"><csymbol cd="ambiguous" id="S3.p7.13.m13.1.2.2.1.cmml" xref="S3.p7.13.m13.1.2.2">subscript</csymbol><ci id="S3.p7.13.m13.1.2.2.2.cmml" xref="S3.p7.13.m13.1.2.2.2">𝑆</ci><apply id="S3.p7.13.m13.1.2.2.3.cmml" xref="S3.p7.13.m13.1.2.2.3"><csymbol cd="ambiguous" id="S3.p7.13.m13.1.2.2.3.1.cmml" xref="S3.p7.13.m13.1.2.2.3">subscript</csymbol><ci id="S3.p7.13.m13.1.2.2.3.2.cmml" xref="S3.p7.13.m13.1.2.2.3.2">𝑥</ci><ci id="S3.p7.13.m13.1.2.2.3.3.cmml" xref="S3.p7.13.m13.1.2.2.3.3">𝑖</ci></apply></apply><ci id="S3.p7.13.m13.1.1.cmml" xref="S3.p7.13.m13.1.1">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.13.m13.1c">S_{x_{i}}(\mathcal{Y})</annotation><annotation encoding="application/x-llamapun" id="S3.p7.13.m13.1d">italic_S start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( caligraphic_Y )</annotation></semantics></math> for the truncated softmax.</p>
</div>
<div class="ltx_para" id="S3.p8">
<p class="ltx_p" id="S3.p8.8">Given this subset, we compute the task and correction losses and update their respective model parameters. First, we compute the task loss, which is cross-entropy. The task loss will only be used to update the parameters of the dual-encoders, <math alttext="\Theta" class="ltx_Math" display="inline" id="S3.p8.1.m1.1"><semantics id="S3.p8.1.m1.1a"><mi id="S3.p8.1.m1.1.1" mathvariant="normal" xref="S3.p8.1.m1.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="S3.p8.1.m1.1b"><ci id="S3.p8.1.m1.1.1.cmml" xref="S3.p8.1.m1.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.1.m1.1c">\Theta</annotation><annotation encoding="application/x-llamapun" id="S3.p8.1.m1.1d">roman_Θ</annotation></semantics></math>, not the parameters of the target corrector network. We compute the truncated softmax <math alttext="\tilde{P}(y|x)\propto\exp(\beta\langle f(x),g(y)\rangle)" class="ltx_Math" display="inline" id="S3.p8.2.m2.5"><semantics id="S3.p8.2.m2.5a"><mrow id="S3.p8.2.m2.5.5" xref="S3.p8.2.m2.5.5.cmml"><mrow id="S3.p8.2.m2.4.4.1" xref="S3.p8.2.m2.4.4.1.cmml"><mover accent="true" id="S3.p8.2.m2.4.4.1.3" xref="S3.p8.2.m2.4.4.1.3.cmml"><mi id="S3.p8.2.m2.4.4.1.3.2" xref="S3.p8.2.m2.4.4.1.3.2.cmml">P</mi><mo id="S3.p8.2.m2.4.4.1.3.1" xref="S3.p8.2.m2.4.4.1.3.1.cmml">~</mo></mover><mo id="S3.p8.2.m2.4.4.1.2" xref="S3.p8.2.m2.4.4.1.2.cmml">⁢</mo><mrow id="S3.p8.2.m2.4.4.1.1.1" xref="S3.p8.2.m2.4.4.1.1.1.1.cmml"><mo id="S3.p8.2.m2.4.4.1.1.1.2" stretchy="false" xref="S3.p8.2.m2.4.4.1.1.1.1.cmml">(</mo><mrow id="S3.p8.2.m2.4.4.1.1.1.1" xref="S3.p8.2.m2.4.4.1.1.1.1.cmml"><mi id="S3.p8.2.m2.4.4.1.1.1.1.2" xref="S3.p8.2.m2.4.4.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S3.p8.2.m2.4.4.1.1.1.1.1" xref="S3.p8.2.m2.4.4.1.1.1.1.1.cmml">|</mo><mi id="S3.p8.2.m2.4.4.1.1.1.1.3" xref="S3.p8.2.m2.4.4.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.p8.2.m2.4.4.1.1.1.3" stretchy="false" xref="S3.p8.2.m2.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.p8.2.m2.5.5.3" xref="S3.p8.2.m2.5.5.3.cmml">∝</mo><mrow id="S3.p8.2.m2.5.5.2.1" xref="S3.p8.2.m2.5.5.2.2.cmml"><mi id="S3.p8.2.m2.3.3" xref="S3.p8.2.m2.3.3.cmml">exp</mi><mo id="S3.p8.2.m2.5.5.2.1a" xref="S3.p8.2.m2.5.5.2.2.cmml">⁡</mo><mrow id="S3.p8.2.m2.5.5.2.1.1" xref="S3.p8.2.m2.5.5.2.2.cmml"><mo id="S3.p8.2.m2.5.5.2.1.1.2" stretchy="false" xref="S3.p8.2.m2.5.5.2.2.cmml">(</mo><mrow id="S3.p8.2.m2.5.5.2.1.1.1" xref="S3.p8.2.m2.5.5.2.1.1.1.cmml"><mi id="S3.p8.2.m2.5.5.2.1.1.1.4" xref="S3.p8.2.m2.5.5.2.1.1.1.4.cmml">β</mi><mo id="S3.p8.2.m2.5.5.2.1.1.1.3" xref="S3.p8.2.m2.5.5.2.1.1.1.3.cmml">⁢</mo><mrow id="S3.p8.2.m2.5.5.2.1.1.1.2.2" xref="S3.p8.2.m2.5.5.2.1.1.1.2.3.cmml"><mo id="S3.p8.2.m2.5.5.2.1.1.1.2.2.3" stretchy="false" xref="S3.p8.2.m2.5.5.2.1.1.1.2.3.cmml">⟨</mo><mrow id="S3.p8.2.m2.5.5.2.1.1.1.1.1.1" xref="S3.p8.2.m2.5.5.2.1.1.1.1.1.1.cmml"><mi id="S3.p8.2.m2.5.5.2.1.1.1.1.1.1.2" xref="S3.p8.2.m2.5.5.2.1.1.1.1.1.1.2.cmml">f</mi><mo id="S3.p8.2.m2.5.5.2.1.1.1.1.1.1.1" xref="S3.p8.2.m2.5.5.2.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.p8.2.m2.5.5.2.1.1.1.1.1.1.3.2" xref="S3.p8.2.m2.5.5.2.1.1.1.1.1.1.cmml"><mo id="S3.p8.2.m2.5.5.2.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.p8.2.m2.5.5.2.1.1.1.1.1.1.cmml">(</mo><mi id="S3.p8.2.m2.1.1" xref="S3.p8.2.m2.1.1.cmml">x</mi><mo id="S3.p8.2.m2.5.5.2.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.p8.2.m2.5.5.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.p8.2.m2.5.5.2.1.1.1.2.2.4" xref="S3.p8.2.m2.5.5.2.1.1.1.2.3.cmml">,</mo><mrow id="S3.p8.2.m2.5.5.2.1.1.1.2.2.2" xref="S3.p8.2.m2.5.5.2.1.1.1.2.2.2.cmml"><mi id="S3.p8.2.m2.5.5.2.1.1.1.2.2.2.2" xref="S3.p8.2.m2.5.5.2.1.1.1.2.2.2.2.cmml">g</mi><mo id="S3.p8.2.m2.5.5.2.1.1.1.2.2.2.1" xref="S3.p8.2.m2.5.5.2.1.1.1.2.2.2.1.cmml">⁢</mo><mrow id="S3.p8.2.m2.5.5.2.1.1.1.2.2.2.3.2" xref="S3.p8.2.m2.5.5.2.1.1.1.2.2.2.cmml"><mo id="S3.p8.2.m2.5.5.2.1.1.1.2.2.2.3.2.1" stretchy="false" xref="S3.p8.2.m2.5.5.2.1.1.1.2.2.2.cmml">(</mo><mi id="S3.p8.2.m2.2.2" xref="S3.p8.2.m2.2.2.cmml">y</mi><mo id="S3.p8.2.m2.5.5.2.1.1.1.2.2.2.3.2.2" stretchy="false" xref="S3.p8.2.m2.5.5.2.1.1.1.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.p8.2.m2.5.5.2.1.1.1.2.2.5" stretchy="false" xref="S3.p8.2.m2.5.5.2.1.1.1.2.3.cmml">⟩</mo></mrow></mrow><mo id="S3.p8.2.m2.5.5.2.1.1.3" stretchy="false" xref="S3.p8.2.m2.5.5.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p8.2.m2.5b"><apply id="S3.p8.2.m2.5.5.cmml" xref="S3.p8.2.m2.5.5"><csymbol cd="latexml" id="S3.p8.2.m2.5.5.3.cmml" xref="S3.p8.2.m2.5.5.3">proportional-to</csymbol><apply id="S3.p8.2.m2.4.4.1.cmml" xref="S3.p8.2.m2.4.4.1"><times id="S3.p8.2.m2.4.4.1.2.cmml" xref="S3.p8.2.m2.4.4.1.2"></times><apply id="S3.p8.2.m2.4.4.1.3.cmml" xref="S3.p8.2.m2.4.4.1.3"><ci id="S3.p8.2.m2.4.4.1.3.1.cmml" xref="S3.p8.2.m2.4.4.1.3.1">~</ci><ci id="S3.p8.2.m2.4.4.1.3.2.cmml" xref="S3.p8.2.m2.4.4.1.3.2">𝑃</ci></apply><apply id="S3.p8.2.m2.4.4.1.1.1.1.cmml" xref="S3.p8.2.m2.4.4.1.1.1"><csymbol cd="latexml" id="S3.p8.2.m2.4.4.1.1.1.1.1.cmml" xref="S3.p8.2.m2.4.4.1.1.1.1.1">conditional</csymbol><ci id="S3.p8.2.m2.4.4.1.1.1.1.2.cmml" xref="S3.p8.2.m2.4.4.1.1.1.1.2">𝑦</ci><ci id="S3.p8.2.m2.4.4.1.1.1.1.3.cmml" xref="S3.p8.2.m2.4.4.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.p8.2.m2.5.5.2.2.cmml" xref="S3.p8.2.m2.5.5.2.1"><exp id="S3.p8.2.m2.3.3.cmml" xref="S3.p8.2.m2.3.3"></exp><apply id="S3.p8.2.m2.5.5.2.1.1.1.cmml" xref="S3.p8.2.m2.5.5.2.1.1.1"><times id="S3.p8.2.m2.5.5.2.1.1.1.3.cmml" xref="S3.p8.2.m2.5.5.2.1.1.1.3"></times><ci id="S3.p8.2.m2.5.5.2.1.1.1.4.cmml" xref="S3.p8.2.m2.5.5.2.1.1.1.4">𝛽</ci><list id="S3.p8.2.m2.5.5.2.1.1.1.2.3.cmml" xref="S3.p8.2.m2.5.5.2.1.1.1.2.2"><apply id="S3.p8.2.m2.5.5.2.1.1.1.1.1.1.cmml" xref="S3.p8.2.m2.5.5.2.1.1.1.1.1.1"><times id="S3.p8.2.m2.5.5.2.1.1.1.1.1.1.1.cmml" xref="S3.p8.2.m2.5.5.2.1.1.1.1.1.1.1"></times><ci id="S3.p8.2.m2.5.5.2.1.1.1.1.1.1.2.cmml" xref="S3.p8.2.m2.5.5.2.1.1.1.1.1.1.2">𝑓</ci><ci id="S3.p8.2.m2.1.1.cmml" xref="S3.p8.2.m2.1.1">𝑥</ci></apply><apply id="S3.p8.2.m2.5.5.2.1.1.1.2.2.2.cmml" xref="S3.p8.2.m2.5.5.2.1.1.1.2.2.2"><times id="S3.p8.2.m2.5.5.2.1.1.1.2.2.2.1.cmml" xref="S3.p8.2.m2.5.5.2.1.1.1.2.2.2.1"></times><ci id="S3.p8.2.m2.5.5.2.1.1.1.2.2.2.2.cmml" xref="S3.p8.2.m2.5.5.2.1.1.1.2.2.2.2">𝑔</ci><ci id="S3.p8.2.m2.2.2.cmml" xref="S3.p8.2.m2.2.2">𝑦</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.2.m2.5c">\tilde{P}(y|x)\propto\exp(\beta\langle f(x),g(y)\rangle)</annotation><annotation encoding="application/x-llamapun" id="S3.p8.2.m2.5d">over~ start_ARG italic_P end_ARG ( italic_y | italic_x ) ∝ roman_exp ( italic_β ⟨ italic_f ( italic_x ) , italic_g ( italic_y ) ⟩ )</annotation></semantics></math> (Equation <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S2.E3" title="In 2 Background ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">3</span></a>). We define a one-hot <math alttext="P^{\star}" class="ltx_Math" display="inline" id="S3.p8.3.m3.1"><semantics id="S3.p8.3.m3.1a"><msup id="S3.p8.3.m3.1.1" xref="S3.p8.3.m3.1.1.cmml"><mi id="S3.p8.3.m3.1.1.2" xref="S3.p8.3.m3.1.1.2.cmml">P</mi><mo id="S3.p8.3.m3.1.1.3" xref="S3.p8.3.m3.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p8.3.m3.1b"><apply id="S3.p8.3.m3.1.1.cmml" xref="S3.p8.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p8.3.m3.1.1.1.cmml" xref="S3.p8.3.m3.1.1">superscript</csymbol><ci id="S3.p8.3.m3.1.1.2.cmml" xref="S3.p8.3.m3.1.1.2">𝑃</ci><ci id="S3.p8.3.m3.1.1.3.cmml" xref="S3.p8.3.m3.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.3.m3.1c">P^{\star}</annotation><annotation encoding="application/x-llamapun" id="S3.p8.3.m3.1d">italic_P start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math> according to the training data label <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.p8.4.m4.1"><semantics id="S3.p8.4.m4.1a"><msub id="S3.p8.4.m4.1.1" xref="S3.p8.4.m4.1.1.cmml"><mi id="S3.p8.4.m4.1.1.2" xref="S3.p8.4.m4.1.1.2.cmml">y</mi><mi id="S3.p8.4.m4.1.1.3" xref="S3.p8.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p8.4.m4.1b"><apply id="S3.p8.4.m4.1.1.cmml" xref="S3.p8.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p8.4.m4.1.1.1.cmml" xref="S3.p8.4.m4.1.1">subscript</csymbol><ci id="S3.p8.4.m4.1.1.2.cmml" xref="S3.p8.4.m4.1.1.2">𝑦</ci><ci id="S3.p8.4.m4.1.1.3.cmml" xref="S3.p8.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.4.m4.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p8.4.m4.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. We compute the task specific loss <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.p8.5.m5.1"><semantics id="S3.p8.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p8.5.m5.1.1" xref="S3.p8.5.m5.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.p8.5.m5.1b"><ci id="S3.p8.5.m5.1.1.cmml" xref="S3.p8.5.m5.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.5.m5.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.p8.5.m5.1d">caligraphic_L</annotation></semantics></math> as a function of <math alttext="\tilde{P}" class="ltx_Math" display="inline" id="S3.p8.6.m6.1"><semantics id="S3.p8.6.m6.1a"><mover accent="true" id="S3.p8.6.m6.1.1" xref="S3.p8.6.m6.1.1.cmml"><mi id="S3.p8.6.m6.1.1.2" xref="S3.p8.6.m6.1.1.2.cmml">P</mi><mo id="S3.p8.6.m6.1.1.1" xref="S3.p8.6.m6.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.p8.6.m6.1b"><apply id="S3.p8.6.m6.1.1.cmml" xref="S3.p8.6.m6.1.1"><ci id="S3.p8.6.m6.1.1.1.cmml" xref="S3.p8.6.m6.1.1.1">~</ci><ci id="S3.p8.6.m6.1.1.2.cmml" xref="S3.p8.6.m6.1.1.2">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.6.m6.1c">\tilde{P}</annotation><annotation encoding="application/x-llamapun" id="S3.p8.6.m6.1d">over~ start_ARG italic_P end_ARG</annotation></semantics></math> and <math alttext="P^{\star}" class="ltx_Math" display="inline" id="S3.p8.7.m7.1"><semantics id="S3.p8.7.m7.1a"><msup id="S3.p8.7.m7.1.1" xref="S3.p8.7.m7.1.1.cmml"><mi id="S3.p8.7.m7.1.1.2" xref="S3.p8.7.m7.1.1.2.cmml">P</mi><mo id="S3.p8.7.m7.1.1.3" xref="S3.p8.7.m7.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p8.7.m7.1b"><apply id="S3.p8.7.m7.1.1.cmml" xref="S3.p8.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p8.7.m7.1.1.1.cmml" xref="S3.p8.7.m7.1.1">superscript</csymbol><ci id="S3.p8.7.m7.1.1.2.cmml" xref="S3.p8.7.m7.1.1.2">𝑃</ci><ci id="S3.p8.7.m7.1.1.3.cmml" xref="S3.p8.7.m7.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.7.m7.1c">P^{\star}</annotation><annotation encoding="application/x-llamapun" id="S3.p8.7.m7.1d">italic_P start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math>, and update the dual encoder parameters via gradient descent <math alttext="\Theta\leftarrow\Theta-\eta\nabla_{\Theta}\mathcal{L}" class="ltx_Math" display="inline" id="S3.p8.8.m8.1"><semantics id="S3.p8.8.m8.1a"><mrow id="S3.p8.8.m8.1.1" xref="S3.p8.8.m8.1.1.cmml"><mi id="S3.p8.8.m8.1.1.2" mathvariant="normal" xref="S3.p8.8.m8.1.1.2.cmml">Θ</mi><mo id="S3.p8.8.m8.1.1.1" stretchy="false" xref="S3.p8.8.m8.1.1.1.cmml">←</mo><mrow id="S3.p8.8.m8.1.1.3" xref="S3.p8.8.m8.1.1.3.cmml"><mi id="S3.p8.8.m8.1.1.3.2" mathvariant="normal" xref="S3.p8.8.m8.1.1.3.2.cmml">Θ</mi><mo id="S3.p8.8.m8.1.1.3.1" xref="S3.p8.8.m8.1.1.3.1.cmml">−</mo><mrow id="S3.p8.8.m8.1.1.3.3" xref="S3.p8.8.m8.1.1.3.3.cmml"><mi id="S3.p8.8.m8.1.1.3.3.2" xref="S3.p8.8.m8.1.1.3.3.2.cmml">η</mi><mo id="S3.p8.8.m8.1.1.3.3.1" lspace="0.167em" xref="S3.p8.8.m8.1.1.3.3.1.cmml">⁢</mo><mrow id="S3.p8.8.m8.1.1.3.3.3" xref="S3.p8.8.m8.1.1.3.3.3.cmml"><msub id="S3.p8.8.m8.1.1.3.3.3.1" xref="S3.p8.8.m8.1.1.3.3.3.1.cmml"><mo id="S3.p8.8.m8.1.1.3.3.3.1.2" rspace="0.167em" xref="S3.p8.8.m8.1.1.3.3.3.1.2.cmml">∇</mo><mi id="S3.p8.8.m8.1.1.3.3.3.1.3" mathvariant="normal" xref="S3.p8.8.m8.1.1.3.3.3.1.3.cmml">Θ</mi></msub><mi class="ltx_font_mathcaligraphic" id="S3.p8.8.m8.1.1.3.3.3.2" xref="S3.p8.8.m8.1.1.3.3.3.2.cmml">ℒ</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p8.8.m8.1b"><apply id="S3.p8.8.m8.1.1.cmml" xref="S3.p8.8.m8.1.1"><ci id="S3.p8.8.m8.1.1.1.cmml" xref="S3.p8.8.m8.1.1.1">←</ci><ci id="S3.p8.8.m8.1.1.2.cmml" xref="S3.p8.8.m8.1.1.2">Θ</ci><apply id="S3.p8.8.m8.1.1.3.cmml" xref="S3.p8.8.m8.1.1.3"><minus id="S3.p8.8.m8.1.1.3.1.cmml" xref="S3.p8.8.m8.1.1.3.1"></minus><ci id="S3.p8.8.m8.1.1.3.2.cmml" xref="S3.p8.8.m8.1.1.3.2">Θ</ci><apply id="S3.p8.8.m8.1.1.3.3.cmml" xref="S3.p8.8.m8.1.1.3.3"><times id="S3.p8.8.m8.1.1.3.3.1.cmml" xref="S3.p8.8.m8.1.1.3.3.1"></times><ci id="S3.p8.8.m8.1.1.3.3.2.cmml" xref="S3.p8.8.m8.1.1.3.3.2">𝜂</ci><apply id="S3.p8.8.m8.1.1.3.3.3.cmml" xref="S3.p8.8.m8.1.1.3.3.3"><apply id="S3.p8.8.m8.1.1.3.3.3.1.cmml" xref="S3.p8.8.m8.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S3.p8.8.m8.1.1.3.3.3.1.1.cmml" xref="S3.p8.8.m8.1.1.3.3.3.1">subscript</csymbol><ci id="S3.p8.8.m8.1.1.3.3.3.1.2.cmml" xref="S3.p8.8.m8.1.1.3.3.3.1.2">∇</ci><ci id="S3.p8.8.m8.1.1.3.3.3.1.3.cmml" xref="S3.p8.8.m8.1.1.3.3.3.1.3">Θ</ci></apply><ci id="S3.p8.8.m8.1.1.3.3.3.2.cmml" xref="S3.p8.8.m8.1.1.3.3.3.2">ℒ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p8.8.m8.1c">\Theta\leftarrow\Theta-\eta\nabla_{\Theta}\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.p8.8.m8.1d">roman_Θ ← roman_Θ - italic_η ∇ start_POSTSUBSCRIPT roman_Θ end_POSTSUBSCRIPT caligraphic_L</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.p9">
<p class="ltx_p" id="S3.p9.7">Next, we will use the same sample of targets <math alttext="S_{x_{i}}(\mathcal{Y})" class="ltx_Math" display="inline" id="S3.p9.1.m1.1"><semantics id="S3.p9.1.m1.1a"><mrow id="S3.p9.1.m1.1.2" xref="S3.p9.1.m1.1.2.cmml"><msub id="S3.p9.1.m1.1.2.2" xref="S3.p9.1.m1.1.2.2.cmml"><mi id="S3.p9.1.m1.1.2.2.2" xref="S3.p9.1.m1.1.2.2.2.cmml">S</mi><msub id="S3.p9.1.m1.1.2.2.3" xref="S3.p9.1.m1.1.2.2.3.cmml"><mi id="S3.p9.1.m1.1.2.2.3.2" xref="S3.p9.1.m1.1.2.2.3.2.cmml">x</mi><mi id="S3.p9.1.m1.1.2.2.3.3" xref="S3.p9.1.m1.1.2.2.3.3.cmml">i</mi></msub></msub><mo id="S3.p9.1.m1.1.2.1" xref="S3.p9.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.p9.1.m1.1.2.3.2" xref="S3.p9.1.m1.1.2.cmml"><mo id="S3.p9.1.m1.1.2.3.2.1" stretchy="false" xref="S3.p9.1.m1.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.p9.1.m1.1.1" xref="S3.p9.1.m1.1.1.cmml">𝒴</mi><mo id="S3.p9.1.m1.1.2.3.2.2" stretchy="false" xref="S3.p9.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p9.1.m1.1b"><apply id="S3.p9.1.m1.1.2.cmml" xref="S3.p9.1.m1.1.2"><times id="S3.p9.1.m1.1.2.1.cmml" xref="S3.p9.1.m1.1.2.1"></times><apply id="S3.p9.1.m1.1.2.2.cmml" xref="S3.p9.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.p9.1.m1.1.2.2.1.cmml" xref="S3.p9.1.m1.1.2.2">subscript</csymbol><ci id="S3.p9.1.m1.1.2.2.2.cmml" xref="S3.p9.1.m1.1.2.2.2">𝑆</ci><apply id="S3.p9.1.m1.1.2.2.3.cmml" xref="S3.p9.1.m1.1.2.2.3"><csymbol cd="ambiguous" id="S3.p9.1.m1.1.2.2.3.1.cmml" xref="S3.p9.1.m1.1.2.2.3">subscript</csymbol><ci id="S3.p9.1.m1.1.2.2.3.2.cmml" xref="S3.p9.1.m1.1.2.2.3.2">𝑥</ci><ci id="S3.p9.1.m1.1.2.2.3.3.cmml" xref="S3.p9.1.m1.1.2.2.3.3">𝑖</ci></apply></apply><ci id="S3.p9.1.m1.1.1.cmml" xref="S3.p9.1.m1.1.1">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.1.m1.1c">S_{x_{i}}(\mathcal{Y})</annotation><annotation encoding="application/x-llamapun" id="S3.p9.1.m1.1d">italic_S start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( caligraphic_Y )</annotation></semantics></math> to compute the target corrector network’s loss and parameter update. Importantly, this will only update the parameters of the target corrector network, <math alttext="\Psi" class="ltx_Math" display="inline" id="S3.p9.2.m2.1"><semantics id="S3.p9.2.m2.1a"><mi id="S3.p9.2.m2.1.1" mathvariant="normal" xref="S3.p9.2.m2.1.1.cmml">Ψ</mi><annotation-xml encoding="MathML-Content" id="S3.p9.2.m2.1b"><ci id="S3.p9.2.m2.1.1.cmml" xref="S3.p9.2.m2.1.1">Ψ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.2.m2.1c">\Psi</annotation><annotation encoding="application/x-llamapun" id="S3.p9.2.m2.1d">roman_Ψ</annotation></semantics></math>, not the parameters of the dual-encoders. Here we describe the use of the cross-entropy loss. However, an analogous update procedure could be used for other loss functions. We compute the truncated softmax according to the target corrector network’s output: <math alttext="\tilde{P}_{h}(y|x)\propto\exp(\beta\langle f(x),h\circ g^{\prime}(y)\rangle)" class="ltx_Math" display="inline" id="S3.p9.3.m3.5"><semantics id="S3.p9.3.m3.5a"><mrow id="S3.p9.3.m3.5.5" xref="S3.p9.3.m3.5.5.cmml"><mrow id="S3.p9.3.m3.4.4.1" xref="S3.p9.3.m3.4.4.1.cmml"><msub id="S3.p9.3.m3.4.4.1.3" xref="S3.p9.3.m3.4.4.1.3.cmml"><mover accent="true" id="S3.p9.3.m3.4.4.1.3.2" xref="S3.p9.3.m3.4.4.1.3.2.cmml"><mi id="S3.p9.3.m3.4.4.1.3.2.2" xref="S3.p9.3.m3.4.4.1.3.2.2.cmml">P</mi><mo id="S3.p9.3.m3.4.4.1.3.2.1" xref="S3.p9.3.m3.4.4.1.3.2.1.cmml">~</mo></mover><mi id="S3.p9.3.m3.4.4.1.3.3" xref="S3.p9.3.m3.4.4.1.3.3.cmml">h</mi></msub><mo id="S3.p9.3.m3.4.4.1.2" xref="S3.p9.3.m3.4.4.1.2.cmml">⁢</mo><mrow id="S3.p9.3.m3.4.4.1.1.1" xref="S3.p9.3.m3.4.4.1.1.1.1.cmml"><mo id="S3.p9.3.m3.4.4.1.1.1.2" stretchy="false" xref="S3.p9.3.m3.4.4.1.1.1.1.cmml">(</mo><mrow id="S3.p9.3.m3.4.4.1.1.1.1" xref="S3.p9.3.m3.4.4.1.1.1.1.cmml"><mi id="S3.p9.3.m3.4.4.1.1.1.1.2" xref="S3.p9.3.m3.4.4.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S3.p9.3.m3.4.4.1.1.1.1.1" xref="S3.p9.3.m3.4.4.1.1.1.1.1.cmml">|</mo><mi id="S3.p9.3.m3.4.4.1.1.1.1.3" xref="S3.p9.3.m3.4.4.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.p9.3.m3.4.4.1.1.1.3" stretchy="false" xref="S3.p9.3.m3.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.p9.3.m3.5.5.3" xref="S3.p9.3.m3.5.5.3.cmml">∝</mo><mrow id="S3.p9.3.m3.5.5.2.1" xref="S3.p9.3.m3.5.5.2.2.cmml"><mi id="S3.p9.3.m3.3.3" xref="S3.p9.3.m3.3.3.cmml">exp</mi><mo id="S3.p9.3.m3.5.5.2.1a" xref="S3.p9.3.m3.5.5.2.2.cmml">⁡</mo><mrow id="S3.p9.3.m3.5.5.2.1.1" xref="S3.p9.3.m3.5.5.2.2.cmml"><mo id="S3.p9.3.m3.5.5.2.1.1.2" stretchy="false" xref="S3.p9.3.m3.5.5.2.2.cmml">(</mo><mrow id="S3.p9.3.m3.5.5.2.1.1.1" xref="S3.p9.3.m3.5.5.2.1.1.1.cmml"><mi id="S3.p9.3.m3.5.5.2.1.1.1.4" xref="S3.p9.3.m3.5.5.2.1.1.1.4.cmml">β</mi><mo id="S3.p9.3.m3.5.5.2.1.1.1.3" xref="S3.p9.3.m3.5.5.2.1.1.1.3.cmml">⁢</mo><mrow id="S3.p9.3.m3.5.5.2.1.1.1.2.2" xref="S3.p9.3.m3.5.5.2.1.1.1.2.3.cmml"><mo id="S3.p9.3.m3.5.5.2.1.1.1.2.2.3" stretchy="false" xref="S3.p9.3.m3.5.5.2.1.1.1.2.3.cmml">⟨</mo><mrow id="S3.p9.3.m3.5.5.2.1.1.1.1.1.1" xref="S3.p9.3.m3.5.5.2.1.1.1.1.1.1.cmml"><mi id="S3.p9.3.m3.5.5.2.1.1.1.1.1.1.2" xref="S3.p9.3.m3.5.5.2.1.1.1.1.1.1.2.cmml">f</mi><mo id="S3.p9.3.m3.5.5.2.1.1.1.1.1.1.1" xref="S3.p9.3.m3.5.5.2.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.p9.3.m3.5.5.2.1.1.1.1.1.1.3.2" xref="S3.p9.3.m3.5.5.2.1.1.1.1.1.1.cmml"><mo id="S3.p9.3.m3.5.5.2.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.p9.3.m3.5.5.2.1.1.1.1.1.1.cmml">(</mo><mi id="S3.p9.3.m3.1.1" xref="S3.p9.3.m3.1.1.cmml">x</mi><mo id="S3.p9.3.m3.5.5.2.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.p9.3.m3.5.5.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.p9.3.m3.5.5.2.1.1.1.2.2.4" xref="S3.p9.3.m3.5.5.2.1.1.1.2.3.cmml">,</mo><mrow id="S3.p9.3.m3.5.5.2.1.1.1.2.2.2" xref="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.cmml"><mrow id="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.2" xref="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.2.cmml"><mi id="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.2.2" xref="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.2.2.cmml">h</mi><mo id="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.2.1.cmml">∘</mo><msup id="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.2.3" xref="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.2.3.cmml"><mi id="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.2.3.2" xref="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.2.3.2.cmml">g</mi><mo id="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.2.3.3" xref="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.2.3.3.cmml">′</mo></msup></mrow><mo id="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.1" xref="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.1.cmml">⁢</mo><mrow id="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.3.2" xref="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.cmml"><mo id="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.3.2.1" stretchy="false" xref="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.cmml">(</mo><mi id="S3.p9.3.m3.2.2" xref="S3.p9.3.m3.2.2.cmml">y</mi><mo id="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.3.2.2" stretchy="false" xref="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.p9.3.m3.5.5.2.1.1.1.2.2.5" stretchy="false" xref="S3.p9.3.m3.5.5.2.1.1.1.2.3.cmml">⟩</mo></mrow></mrow><mo id="S3.p9.3.m3.5.5.2.1.1.3" stretchy="false" xref="S3.p9.3.m3.5.5.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p9.3.m3.5b"><apply id="S3.p9.3.m3.5.5.cmml" xref="S3.p9.3.m3.5.5"><csymbol cd="latexml" id="S3.p9.3.m3.5.5.3.cmml" xref="S3.p9.3.m3.5.5.3">proportional-to</csymbol><apply id="S3.p9.3.m3.4.4.1.cmml" xref="S3.p9.3.m3.4.4.1"><times id="S3.p9.3.m3.4.4.1.2.cmml" xref="S3.p9.3.m3.4.4.1.2"></times><apply id="S3.p9.3.m3.4.4.1.3.cmml" xref="S3.p9.3.m3.4.4.1.3"><csymbol cd="ambiguous" id="S3.p9.3.m3.4.4.1.3.1.cmml" xref="S3.p9.3.m3.4.4.1.3">subscript</csymbol><apply id="S3.p9.3.m3.4.4.1.3.2.cmml" xref="S3.p9.3.m3.4.4.1.3.2"><ci id="S3.p9.3.m3.4.4.1.3.2.1.cmml" xref="S3.p9.3.m3.4.4.1.3.2.1">~</ci><ci id="S3.p9.3.m3.4.4.1.3.2.2.cmml" xref="S3.p9.3.m3.4.4.1.3.2.2">𝑃</ci></apply><ci id="S3.p9.3.m3.4.4.1.3.3.cmml" xref="S3.p9.3.m3.4.4.1.3.3">ℎ</ci></apply><apply id="S3.p9.3.m3.4.4.1.1.1.1.cmml" xref="S3.p9.3.m3.4.4.1.1.1"><csymbol cd="latexml" id="S3.p9.3.m3.4.4.1.1.1.1.1.cmml" xref="S3.p9.3.m3.4.4.1.1.1.1.1">conditional</csymbol><ci id="S3.p9.3.m3.4.4.1.1.1.1.2.cmml" xref="S3.p9.3.m3.4.4.1.1.1.1.2">𝑦</ci><ci id="S3.p9.3.m3.4.4.1.1.1.1.3.cmml" xref="S3.p9.3.m3.4.4.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.p9.3.m3.5.5.2.2.cmml" xref="S3.p9.3.m3.5.5.2.1"><exp id="S3.p9.3.m3.3.3.cmml" xref="S3.p9.3.m3.3.3"></exp><apply id="S3.p9.3.m3.5.5.2.1.1.1.cmml" xref="S3.p9.3.m3.5.5.2.1.1.1"><times id="S3.p9.3.m3.5.5.2.1.1.1.3.cmml" xref="S3.p9.3.m3.5.5.2.1.1.1.3"></times><ci id="S3.p9.3.m3.5.5.2.1.1.1.4.cmml" xref="S3.p9.3.m3.5.5.2.1.1.1.4">𝛽</ci><list id="S3.p9.3.m3.5.5.2.1.1.1.2.3.cmml" xref="S3.p9.3.m3.5.5.2.1.1.1.2.2"><apply id="S3.p9.3.m3.5.5.2.1.1.1.1.1.1.cmml" xref="S3.p9.3.m3.5.5.2.1.1.1.1.1.1"><times id="S3.p9.3.m3.5.5.2.1.1.1.1.1.1.1.cmml" xref="S3.p9.3.m3.5.5.2.1.1.1.1.1.1.1"></times><ci id="S3.p9.3.m3.5.5.2.1.1.1.1.1.1.2.cmml" xref="S3.p9.3.m3.5.5.2.1.1.1.1.1.1.2">𝑓</ci><ci id="S3.p9.3.m3.1.1.cmml" xref="S3.p9.3.m3.1.1">𝑥</ci></apply><apply id="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.cmml" xref="S3.p9.3.m3.5.5.2.1.1.1.2.2.2"><times id="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.1.cmml" xref="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.1"></times><apply id="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.2.cmml" xref="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.2"><compose id="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.2.1.cmml" xref="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.2.1"></compose><ci id="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.2.2.cmml" xref="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.2.2">ℎ</ci><apply id="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.2.3.cmml" xref="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.2.3.1.cmml" xref="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.2.3">superscript</csymbol><ci id="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.2.3.2.cmml" xref="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.2.3.2">𝑔</ci><ci id="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.2.3.3.cmml" xref="S3.p9.3.m3.5.5.2.1.1.1.2.2.2.2.3.3">′</ci></apply></apply><ci id="S3.p9.3.m3.2.2.cmml" xref="S3.p9.3.m3.2.2">𝑦</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.3.m3.5c">\tilde{P}_{h}(y|x)\propto\exp(\beta\langle f(x),h\circ g^{\prime}(y)\rangle)</annotation><annotation encoding="application/x-llamapun" id="S3.p9.3.m3.5d">over~ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ( italic_y | italic_x ) ∝ roman_exp ( italic_β ⟨ italic_f ( italic_x ) , italic_h ∘ italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y ) ⟩ )</annotation></semantics></math>. We then compute the target corrector network loss, <math alttext="\ell" class="ltx_Math" display="inline" id="S3.p9.4.m4.1"><semantics id="S3.p9.4.m4.1a"><mi id="S3.p9.4.m4.1.1" mathvariant="normal" xref="S3.p9.4.m4.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="S3.p9.4.m4.1b"><ci id="S3.p9.4.m4.1.1.cmml" xref="S3.p9.4.m4.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.4.m4.1c">\ell</annotation><annotation encoding="application/x-llamapun" id="S3.p9.4.m4.1d">roman_ℓ</annotation></semantics></math>, cross-entropy, which tries to align two truncated distributions <math alttext="\tilde{P}_{h}" class="ltx_Math" display="inline" id="S3.p9.5.m5.1"><semantics id="S3.p9.5.m5.1a"><msub id="S3.p9.5.m5.1.1" xref="S3.p9.5.m5.1.1.cmml"><mover accent="true" id="S3.p9.5.m5.1.1.2" xref="S3.p9.5.m5.1.1.2.cmml"><mi id="S3.p9.5.m5.1.1.2.2" xref="S3.p9.5.m5.1.1.2.2.cmml">P</mi><mo id="S3.p9.5.m5.1.1.2.1" xref="S3.p9.5.m5.1.1.2.1.cmml">~</mo></mover><mi id="S3.p9.5.m5.1.1.3" xref="S3.p9.5.m5.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p9.5.m5.1b"><apply id="S3.p9.5.m5.1.1.cmml" xref="S3.p9.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p9.5.m5.1.1.1.cmml" xref="S3.p9.5.m5.1.1">subscript</csymbol><apply id="S3.p9.5.m5.1.1.2.cmml" xref="S3.p9.5.m5.1.1.2"><ci id="S3.p9.5.m5.1.1.2.1.cmml" xref="S3.p9.5.m5.1.1.2.1">~</ci><ci id="S3.p9.5.m5.1.1.2.2.cmml" xref="S3.p9.5.m5.1.1.2.2">𝑃</ci></apply><ci id="S3.p9.5.m5.1.1.3.cmml" xref="S3.p9.5.m5.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.5.m5.1c">\tilde{P}_{h}</annotation><annotation encoding="application/x-llamapun" id="S3.p9.5.m5.1d">over~ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\tilde{P}" class="ltx_Math" display="inline" id="S3.p9.6.m6.1"><semantics id="S3.p9.6.m6.1a"><mover accent="true" id="S3.p9.6.m6.1.1" xref="S3.p9.6.m6.1.1.cmml"><mi id="S3.p9.6.m6.1.1.2" xref="S3.p9.6.m6.1.1.2.cmml">P</mi><mo id="S3.p9.6.m6.1.1.1" xref="S3.p9.6.m6.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.p9.6.m6.1b"><apply id="S3.p9.6.m6.1.1.cmml" xref="S3.p9.6.m6.1.1"><ci id="S3.p9.6.m6.1.1.1.cmml" xref="S3.p9.6.m6.1.1.1">~</ci><ci id="S3.p9.6.m6.1.1.2.cmml" xref="S3.p9.6.m6.1.1.2">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.6.m6.1c">\tilde{P}</annotation><annotation encoding="application/x-llamapun" id="S3.p9.6.m6.1d">over~ start_ARG italic_P end_ARG</annotation></semantics></math>. The target corrector network’s parameters are updated by gradient descent <math alttext="\Psi\leftarrow\Psi-\eta\nabla_{\Psi}\ell" class="ltx_Math" display="inline" id="S3.p9.7.m7.1"><semantics id="S3.p9.7.m7.1a"><mrow id="S3.p9.7.m7.1.1" xref="S3.p9.7.m7.1.1.cmml"><mi id="S3.p9.7.m7.1.1.2" mathvariant="normal" xref="S3.p9.7.m7.1.1.2.cmml">Ψ</mi><mo id="S3.p9.7.m7.1.1.1" stretchy="false" xref="S3.p9.7.m7.1.1.1.cmml">←</mo><mrow id="S3.p9.7.m7.1.1.3" xref="S3.p9.7.m7.1.1.3.cmml"><mi id="S3.p9.7.m7.1.1.3.2" mathvariant="normal" xref="S3.p9.7.m7.1.1.3.2.cmml">Ψ</mi><mo id="S3.p9.7.m7.1.1.3.1" xref="S3.p9.7.m7.1.1.3.1.cmml">−</mo><mrow id="S3.p9.7.m7.1.1.3.3" xref="S3.p9.7.m7.1.1.3.3.cmml"><mi id="S3.p9.7.m7.1.1.3.3.2" xref="S3.p9.7.m7.1.1.3.3.2.cmml">η</mi><mo id="S3.p9.7.m7.1.1.3.3.1" lspace="0.167em" xref="S3.p9.7.m7.1.1.3.3.1.cmml">⁢</mo><mrow id="S3.p9.7.m7.1.1.3.3.3" xref="S3.p9.7.m7.1.1.3.3.3.cmml"><msub id="S3.p9.7.m7.1.1.3.3.3.1" xref="S3.p9.7.m7.1.1.3.3.3.1.cmml"><mo id="S3.p9.7.m7.1.1.3.3.3.1.2" rspace="0.167em" xref="S3.p9.7.m7.1.1.3.3.3.1.2.cmml">∇</mo><mi id="S3.p9.7.m7.1.1.3.3.3.1.3" mathvariant="normal" xref="S3.p9.7.m7.1.1.3.3.3.1.3.cmml">Ψ</mi></msub><mi id="S3.p9.7.m7.1.1.3.3.3.2" mathvariant="normal" xref="S3.p9.7.m7.1.1.3.3.3.2.cmml">ℓ</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p9.7.m7.1b"><apply id="S3.p9.7.m7.1.1.cmml" xref="S3.p9.7.m7.1.1"><ci id="S3.p9.7.m7.1.1.1.cmml" xref="S3.p9.7.m7.1.1.1">←</ci><ci id="S3.p9.7.m7.1.1.2.cmml" xref="S3.p9.7.m7.1.1.2">Ψ</ci><apply id="S3.p9.7.m7.1.1.3.cmml" xref="S3.p9.7.m7.1.1.3"><minus id="S3.p9.7.m7.1.1.3.1.cmml" xref="S3.p9.7.m7.1.1.3.1"></minus><ci id="S3.p9.7.m7.1.1.3.2.cmml" xref="S3.p9.7.m7.1.1.3.2">Ψ</ci><apply id="S3.p9.7.m7.1.1.3.3.cmml" xref="S3.p9.7.m7.1.1.3.3"><times id="S3.p9.7.m7.1.1.3.3.1.cmml" xref="S3.p9.7.m7.1.1.3.3.1"></times><ci id="S3.p9.7.m7.1.1.3.3.2.cmml" xref="S3.p9.7.m7.1.1.3.3.2">𝜂</ci><apply id="S3.p9.7.m7.1.1.3.3.3.cmml" xref="S3.p9.7.m7.1.1.3.3.3"><apply id="S3.p9.7.m7.1.1.3.3.3.1.cmml" xref="S3.p9.7.m7.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S3.p9.7.m7.1.1.3.3.3.1.1.cmml" xref="S3.p9.7.m7.1.1.3.3.3.1">subscript</csymbol><ci id="S3.p9.7.m7.1.1.3.3.3.1.2.cmml" xref="S3.p9.7.m7.1.1.3.3.3.1.2">∇</ci><ci id="S3.p9.7.m7.1.1.3.3.3.1.3.cmml" xref="S3.p9.7.m7.1.1.3.3.3.1.3">Ψ</ci></apply><ci id="S3.p9.7.m7.1.1.3.3.3.2.cmml" xref="S3.p9.7.m7.1.1.3.3.3.2">ℓ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p9.7.m7.1c">\Psi\leftarrow\Psi-\eta\nabla_{\Psi}\ell</annotation><annotation encoding="application/x-llamapun" id="S3.p9.7.m7.1d">roman_Ψ ← roman_Ψ - italic_η ∇ start_POSTSUBSCRIPT roman_Ψ end_POSTSUBSCRIPT roman_ℓ</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.p10">
<p class="ltx_p" id="S3.p10.2">Training the target corrector network, which has only a small number of parameters, is much less computationally intensive to train than the dual-encoder model. Furthermore, we are given “for free” the representations <math alttext="g(y)" class="ltx_Math" display="inline" id="S3.p10.1.m1.1"><semantics id="S3.p10.1.m1.1a"><mrow id="S3.p10.1.m1.1.2" xref="S3.p10.1.m1.1.2.cmml"><mi id="S3.p10.1.m1.1.2.2" xref="S3.p10.1.m1.1.2.2.cmml">g</mi><mo id="S3.p10.1.m1.1.2.1" xref="S3.p10.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.p10.1.m1.1.2.3.2" xref="S3.p10.1.m1.1.2.cmml"><mo id="S3.p10.1.m1.1.2.3.2.1" stretchy="false" xref="S3.p10.1.m1.1.2.cmml">(</mo><mi id="S3.p10.1.m1.1.1" xref="S3.p10.1.m1.1.1.cmml">y</mi><mo id="S3.p10.1.m1.1.2.3.2.2" stretchy="false" xref="S3.p10.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p10.1.m1.1b"><apply id="S3.p10.1.m1.1.2.cmml" xref="S3.p10.1.m1.1.2"><times id="S3.p10.1.m1.1.2.1.cmml" xref="S3.p10.1.m1.1.2.1"></times><ci id="S3.p10.1.m1.1.2.2.cmml" xref="S3.p10.1.m1.1.2.2">𝑔</ci><ci id="S3.p10.1.m1.1.1.cmml" xref="S3.p10.1.m1.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p10.1.m1.1c">g(y)</annotation><annotation encoding="application/x-llamapun" id="S3.p10.1.m1.1d">italic_g ( italic_y )</annotation></semantics></math> since they are used to compute <math alttext="\tilde{P}" class="ltx_Math" display="inline" id="S3.p10.2.m2.1"><semantics id="S3.p10.2.m2.1a"><mover accent="true" id="S3.p10.2.m2.1.1" xref="S3.p10.2.m2.1.1.cmml"><mi id="S3.p10.2.m2.1.1.2" xref="S3.p10.2.m2.1.1.2.cmml">P</mi><mo id="S3.p10.2.m2.1.1.1" xref="S3.p10.2.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.p10.2.m2.1b"><apply id="S3.p10.2.m2.1.1.cmml" xref="S3.p10.2.m2.1.1"><ci id="S3.p10.2.m2.1.1.1.cmml" xref="S3.p10.2.m2.1.1.1">~</ci><ci id="S3.p10.2.m2.1.1.2.cmml" xref="S3.p10.2.m2.1.1.2">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p10.2.m2.1c">\tilde{P}</annotation><annotation encoding="application/x-llamapun" id="S3.p10.2.m2.1d">over~ start_ARG italic_P end_ARG</annotation></semantics></math> for the task loss. These representations can then easily be re-used for training the corrector.</p>
</div>
<div class="ltx_para" id="S3.p11">
<p class="ltx_p" id="S3.p11.1">The training procedure is summarized in Algorithm
 <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#alg1" title="Algorithm 1 ‣ 3 Improving Training with Target Correctors ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">1</span></a>. At prediction time, the corrector network is not used, instead the trained dual-encoder <math alttext="g(y,\Theta)" class="ltx_Math" display="inline" id="S3.p11.1.m1.2"><semantics id="S3.p11.1.m1.2a"><mrow id="S3.p11.1.m1.2.3" xref="S3.p11.1.m1.2.3.cmml"><mi id="S3.p11.1.m1.2.3.2" xref="S3.p11.1.m1.2.3.2.cmml">g</mi><mo id="S3.p11.1.m1.2.3.1" xref="S3.p11.1.m1.2.3.1.cmml">⁢</mo><mrow id="S3.p11.1.m1.2.3.3.2" xref="S3.p11.1.m1.2.3.3.1.cmml"><mo id="S3.p11.1.m1.2.3.3.2.1" stretchy="false" xref="S3.p11.1.m1.2.3.3.1.cmml">(</mo><mi id="S3.p11.1.m1.1.1" xref="S3.p11.1.m1.1.1.cmml">y</mi><mo id="S3.p11.1.m1.2.3.3.2.2" xref="S3.p11.1.m1.2.3.3.1.cmml">,</mo><mi id="S3.p11.1.m1.2.2" mathvariant="normal" xref="S3.p11.1.m1.2.2.cmml">Θ</mi><mo id="S3.p11.1.m1.2.3.3.2.3" stretchy="false" xref="S3.p11.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p11.1.m1.2b"><apply id="S3.p11.1.m1.2.3.cmml" xref="S3.p11.1.m1.2.3"><times id="S3.p11.1.m1.2.3.1.cmml" xref="S3.p11.1.m1.2.3.1"></times><ci id="S3.p11.1.m1.2.3.2.cmml" xref="S3.p11.1.m1.2.3.2">𝑔</ci><interval closure="open" id="S3.p11.1.m1.2.3.3.1.cmml" xref="S3.p11.1.m1.2.3.3.2"><ci id="S3.p11.1.m1.1.1.cmml" xref="S3.p11.1.m1.1.1">𝑦</ci><ci id="S3.p11.1.m1.2.2.cmml" xref="S3.p11.1.m1.2.2">Θ</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p11.1.m1.2c">g(y,\Theta)</annotation><annotation encoding="application/x-llamapun" id="S3.p11.1.m1.2d">italic_g ( italic_y , roman_Θ )</annotation></semantics></math> is used.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.34.1.1">Algorithm 1</span> </span> Training with target corrector networks</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="alg1.12"><span class="ltx_text" id="alg1.12.1"><span class="ltx_text ltx_font_bold" id="alg1.12.1.1">Data:</span> </span>Training data <math alttext="X" class="ltx_Math" display="inline" id="alg1.1.m1.1"><semantics id="alg1.1.m1.1a"><mi id="alg1.1.m1.1.1" xref="alg1.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="alg1.1.m1.1b"><ci id="alg1.1.m1.1.1.cmml" xref="alg1.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.m1.1c">X</annotation><annotation encoding="application/x-llamapun" id="alg1.1.m1.1d">italic_X</annotation></semantics></math>, Targets <math alttext="\mathcal{Y}" class="ltx_Math" display="inline" id="alg1.2.m2.1"><semantics id="alg1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.2.m2.1.1" xref="alg1.2.m2.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="alg1.2.m2.1b"><ci id="alg1.2.m2.1.1.cmml" xref="alg1.2.m2.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m2.1c">\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="alg1.2.m2.1d">caligraphic_Y</annotation></semantics></math>, Input encoder <math alttext="f(\cdot)" class="ltx_Math" display="inline" id="alg1.3.m3.1"><semantics id="alg1.3.m3.1a"><mrow id="alg1.3.m3.1.2" xref="alg1.3.m3.1.2.cmml"><mi id="alg1.3.m3.1.2.2" xref="alg1.3.m3.1.2.2.cmml">f</mi><mo id="alg1.3.m3.1.2.1" xref="alg1.3.m3.1.2.1.cmml">⁢</mo><mrow id="alg1.3.m3.1.2.3.2" xref="alg1.3.m3.1.2.cmml"><mo id="alg1.3.m3.1.2.3.2.1" stretchy="false" xref="alg1.3.m3.1.2.cmml">(</mo><mo id="alg1.3.m3.1.1" lspace="0em" rspace="0em" xref="alg1.3.m3.1.1.cmml">⋅</mo><mo id="alg1.3.m3.1.2.3.2.2" stretchy="false" xref="alg1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.3.m3.1b"><apply id="alg1.3.m3.1.2.cmml" xref="alg1.3.m3.1.2"><times id="alg1.3.m3.1.2.1.cmml" xref="alg1.3.m3.1.2.1"></times><ci id="alg1.3.m3.1.2.2.cmml" xref="alg1.3.m3.1.2.2">𝑓</ci><ci id="alg1.3.m3.1.1.cmml" xref="alg1.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.m3.1c">f(\cdot)</annotation><annotation encoding="application/x-llamapun" id="alg1.3.m3.1d">italic_f ( ⋅ )</annotation></semantics></math>, Target encoder <math alttext="g(\cdot)" class="ltx_Math" display="inline" id="alg1.4.m4.1"><semantics id="alg1.4.m4.1a"><mrow id="alg1.4.m4.1.2" xref="alg1.4.m4.1.2.cmml"><mi id="alg1.4.m4.1.2.2" xref="alg1.4.m4.1.2.2.cmml">g</mi><mo id="alg1.4.m4.1.2.1" xref="alg1.4.m4.1.2.1.cmml">⁢</mo><mrow id="alg1.4.m4.1.2.3.2" xref="alg1.4.m4.1.2.cmml"><mo id="alg1.4.m4.1.2.3.2.1" stretchy="false" xref="alg1.4.m4.1.2.cmml">(</mo><mo id="alg1.4.m4.1.1" lspace="0em" rspace="0em" xref="alg1.4.m4.1.1.cmml">⋅</mo><mo id="alg1.4.m4.1.2.3.2.2" stretchy="false" xref="alg1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.4.m4.1b"><apply id="alg1.4.m4.1.2.cmml" xref="alg1.4.m4.1.2"><times id="alg1.4.m4.1.2.1.cmml" xref="alg1.4.m4.1.2.1"></times><ci id="alg1.4.m4.1.2.2.cmml" xref="alg1.4.m4.1.2.2">𝑔</ci><ci id="alg1.4.m4.1.1.cmml" xref="alg1.4.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.m4.1c">g(\cdot)</annotation><annotation encoding="application/x-llamapun" id="alg1.4.m4.1d">italic_g ( ⋅ )</annotation></semantics></math>, Approximate target encoder <math alttext="g^{\prime}(\cdot)" class="ltx_Math" display="inline" id="alg1.5.m5.1"><semantics id="alg1.5.m5.1a"><mrow id="alg1.5.m5.1.2" xref="alg1.5.m5.1.2.cmml"><msup id="alg1.5.m5.1.2.2" xref="alg1.5.m5.1.2.2.cmml"><mi id="alg1.5.m5.1.2.2.2" xref="alg1.5.m5.1.2.2.2.cmml">g</mi><mo id="alg1.5.m5.1.2.2.3" xref="alg1.5.m5.1.2.2.3.cmml">′</mo></msup><mo id="alg1.5.m5.1.2.1" xref="alg1.5.m5.1.2.1.cmml">⁢</mo><mrow id="alg1.5.m5.1.2.3.2" xref="alg1.5.m5.1.2.cmml"><mo id="alg1.5.m5.1.2.3.2.1" stretchy="false" xref="alg1.5.m5.1.2.cmml">(</mo><mo id="alg1.5.m5.1.1" lspace="0em" rspace="0em" xref="alg1.5.m5.1.1.cmml">⋅</mo><mo id="alg1.5.m5.1.2.3.2.2" stretchy="false" xref="alg1.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.5.m5.1b"><apply id="alg1.5.m5.1.2.cmml" xref="alg1.5.m5.1.2"><times id="alg1.5.m5.1.2.1.cmml" xref="alg1.5.m5.1.2.1"></times><apply id="alg1.5.m5.1.2.2.cmml" xref="alg1.5.m5.1.2.2"><csymbol cd="ambiguous" id="alg1.5.m5.1.2.2.1.cmml" xref="alg1.5.m5.1.2.2">superscript</csymbol><ci id="alg1.5.m5.1.2.2.2.cmml" xref="alg1.5.m5.1.2.2.2">𝑔</ci><ci id="alg1.5.m5.1.2.2.3.cmml" xref="alg1.5.m5.1.2.2.3">′</ci></apply><ci id="alg1.5.m5.1.1.cmml" xref="alg1.5.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.m5.1c">g^{\prime}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="alg1.5.m5.1d">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( ⋅ )</annotation></semantics></math> (buffer <math alttext="B" class="ltx_Math" display="inline" id="alg1.6.m6.1"><semantics id="alg1.6.m6.1a"><mi id="alg1.6.m6.1.1" xref="alg1.6.m6.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg1.6.m6.1b"><ci id="alg1.6.m6.1.1.cmml" xref="alg1.6.m6.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.m6.1c">B</annotation><annotation encoding="application/x-llamapun" id="alg1.6.m6.1d">italic_B</annotation></semantics></math>), target corrector network <math alttext="h(\cdot)" class="ltx_Math" display="inline" id="alg1.7.m7.1"><semantics id="alg1.7.m7.1a"><mrow id="alg1.7.m7.1.2" xref="alg1.7.m7.1.2.cmml"><mi id="alg1.7.m7.1.2.2" xref="alg1.7.m7.1.2.2.cmml">h</mi><mo id="alg1.7.m7.1.2.1" xref="alg1.7.m7.1.2.1.cmml">⁢</mo><mrow id="alg1.7.m7.1.2.3.2" xref="alg1.7.m7.1.2.cmml"><mo id="alg1.7.m7.1.2.3.2.1" stretchy="false" xref="alg1.7.m7.1.2.cmml">(</mo><mo id="alg1.7.m7.1.1" lspace="0em" rspace="0em" xref="alg1.7.m7.1.1.cmml">⋅</mo><mo id="alg1.7.m7.1.2.3.2.2" stretchy="false" xref="alg1.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.7.m7.1b"><apply id="alg1.7.m7.1.2.cmml" xref="alg1.7.m7.1.2"><times id="alg1.7.m7.1.2.1.cmml" xref="alg1.7.m7.1.2.1"></times><ci id="alg1.7.m7.1.2.2.cmml" xref="alg1.7.m7.1.2.2">ℎ</ci><ci id="alg1.7.m7.1.1.cmml" xref="alg1.7.m7.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.m7.1c">h(\cdot)</annotation><annotation encoding="application/x-llamapun" id="alg1.7.m7.1d">italic_h ( ⋅ )</annotation></semantics></math>, temperature <math alttext="\beta" class="ltx_Math" display="inline" id="alg1.8.m8.1"><semantics id="alg1.8.m8.1a"><mi id="alg1.8.m8.1.1" xref="alg1.8.m8.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="alg1.8.m8.1b"><ci id="alg1.8.m8.1.1.cmml" xref="alg1.8.m8.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.m8.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="alg1.8.m8.1d">italic_β</annotation></semantics></math>, task loss <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="alg1.9.m9.1"><semantics id="alg1.9.m9.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.9.m9.1.1" xref="alg1.9.m9.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="alg1.9.m9.1b"><ci id="alg1.9.m9.1.1.cmml" xref="alg1.9.m9.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.m9.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="alg1.9.m9.1d">caligraphic_L</annotation></semantics></math>, target corrector network loss <math alttext="\ell" class="ltx_Math" display="inline" id="alg1.10.m10.1"><semantics id="alg1.10.m10.1a"><mi id="alg1.10.m10.1.1" mathvariant="normal" xref="alg1.10.m10.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="alg1.10.m10.1b"><ci id="alg1.10.m10.1.1.cmml" xref="alg1.10.m10.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.m10.1c">\ell</annotation><annotation encoding="application/x-llamapun" id="alg1.10.m10.1d">roman_ℓ</annotation></semantics></math>, learning rate <math alttext="\eta" class="ltx_Math" display="inline" id="alg1.11.m11.1"><semantics id="alg1.11.m11.1a"><mi id="alg1.11.m11.1.1" xref="alg1.11.m11.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg1.11.m11.1b"><ci id="alg1.11.m11.1.1.cmml" xref="alg1.11.m11.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.11.m11.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="alg1.11.m11.1d">italic_η</annotation></semantics></math>, number of truncated samples <math alttext="k" class="ltx_Math" display="inline" id="alg1.12.m12.1"><semantics id="alg1.12.m12.1a"><mi id="alg1.12.m12.1.1" xref="alg1.12.m12.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.12.m12.1b"><ci id="alg1.12.m12.1.1.cmml" xref="alg1.12.m12.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.12.m12.1c">k</annotation><annotation encoding="application/x-llamapun" id="alg1.12.m12.1d">italic_k</annotation></semantics></math></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="alg1.35"><span class="ltx_text ltx_font_bold" id="alg1.35.1">while</span> <em class="ltx_emph ltx_font_italic" id="alg1.35.2"><em class="ltx_emph ltx_font_upright" id="alg1.35.2.1">Training</em></em> <span class="ltx_text ltx_font_bold" id="alg1.35.3">do</span> </p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel" id="alg1.36">
<div class="ltx_listingline" id="alg1.32">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
  Sample training data <math alttext="(x_{i},y_{i})\sim X" class="ltx_Math" display="inline" id="alg1.13.m1.2"><semantics id="alg1.13.m1.2a"><mrow id="alg1.13.m1.2.2" xref="alg1.13.m1.2.2.cmml"><mrow id="alg1.13.m1.2.2.2.2" xref="alg1.13.m1.2.2.2.3.cmml"><mo id="alg1.13.m1.2.2.2.2.3" stretchy="false" xref="alg1.13.m1.2.2.2.3.cmml">(</mo><msub id="alg1.13.m1.1.1.1.1.1" xref="alg1.13.m1.1.1.1.1.1.cmml"><mi id="alg1.13.m1.1.1.1.1.1.2" xref="alg1.13.m1.1.1.1.1.1.2.cmml">x</mi><mi id="alg1.13.m1.1.1.1.1.1.3" xref="alg1.13.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.13.m1.2.2.2.2.4" xref="alg1.13.m1.2.2.2.3.cmml">,</mo><msub id="alg1.13.m1.2.2.2.2.2" xref="alg1.13.m1.2.2.2.2.2.cmml"><mi id="alg1.13.m1.2.2.2.2.2.2" xref="alg1.13.m1.2.2.2.2.2.2.cmml">y</mi><mi id="alg1.13.m1.2.2.2.2.2.3" xref="alg1.13.m1.2.2.2.2.2.3.cmml">i</mi></msub><mo id="alg1.13.m1.2.2.2.2.5" stretchy="false" xref="alg1.13.m1.2.2.2.3.cmml">)</mo></mrow><mo id="alg1.13.m1.2.2.3" xref="alg1.13.m1.2.2.3.cmml">∼</mo><mi id="alg1.13.m1.2.2.4" xref="alg1.13.m1.2.2.4.cmml">X</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.13.m1.2b"><apply id="alg1.13.m1.2.2.cmml" xref="alg1.13.m1.2.2"><csymbol cd="latexml" id="alg1.13.m1.2.2.3.cmml" xref="alg1.13.m1.2.2.3">similar-to</csymbol><interval closure="open" id="alg1.13.m1.2.2.2.3.cmml" xref="alg1.13.m1.2.2.2.2"><apply id="alg1.13.m1.1.1.1.1.1.cmml" xref="alg1.13.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.13.m1.1.1.1.1.1.1.cmml" xref="alg1.13.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.13.m1.1.1.1.1.1.2.cmml" xref="alg1.13.m1.1.1.1.1.1.2">𝑥</ci><ci id="alg1.13.m1.1.1.1.1.1.3.cmml" xref="alg1.13.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.13.m1.2.2.2.2.2.cmml" xref="alg1.13.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.13.m1.2.2.2.2.2.1.cmml" xref="alg1.13.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.13.m1.2.2.2.2.2.2.cmml" xref="alg1.13.m1.2.2.2.2.2.2">𝑦</ci><ci id="alg1.13.m1.2.2.2.2.2.3.cmml" xref="alg1.13.m1.2.2.2.2.2.3">𝑖</ci></apply></interval><ci id="alg1.13.m1.2.2.4.cmml" xref="alg1.13.m1.2.2.4">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.13.m1.2c">(x_{i},y_{i})\sim X</annotation><annotation encoding="application/x-llamapun" id="alg1.13.m1.2d">( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ∼ italic_X</annotation></semantics></math>
<br class="ltx_break"/>Compute <math alttext="h\circ g^{\prime}(y)" class="ltx_Math" display="inline" id="alg1.14.m2.1"><semantics id="alg1.14.m2.1a"><mrow id="alg1.14.m2.1.2" xref="alg1.14.m2.1.2.cmml"><mrow id="alg1.14.m2.1.2.2" xref="alg1.14.m2.1.2.2.cmml"><mi id="alg1.14.m2.1.2.2.2" xref="alg1.14.m2.1.2.2.2.cmml">h</mi><mo id="alg1.14.m2.1.2.2.1" lspace="0.222em" rspace="0.222em" xref="alg1.14.m2.1.2.2.1.cmml">∘</mo><msup id="alg1.14.m2.1.2.2.3" xref="alg1.14.m2.1.2.2.3.cmml"><mi id="alg1.14.m2.1.2.2.3.2" xref="alg1.14.m2.1.2.2.3.2.cmml">g</mi><mo id="alg1.14.m2.1.2.2.3.3" xref="alg1.14.m2.1.2.2.3.3.cmml">′</mo></msup></mrow><mo id="alg1.14.m2.1.2.1" xref="alg1.14.m2.1.2.1.cmml">⁢</mo><mrow id="alg1.14.m2.1.2.3.2" xref="alg1.14.m2.1.2.cmml"><mo id="alg1.14.m2.1.2.3.2.1" stretchy="false" xref="alg1.14.m2.1.2.cmml">(</mo><mi id="alg1.14.m2.1.1" xref="alg1.14.m2.1.1.cmml">y</mi><mo id="alg1.14.m2.1.2.3.2.2" stretchy="false" xref="alg1.14.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.14.m2.1b"><apply id="alg1.14.m2.1.2.cmml" xref="alg1.14.m2.1.2"><times id="alg1.14.m2.1.2.1.cmml" xref="alg1.14.m2.1.2.1"></times><apply id="alg1.14.m2.1.2.2.cmml" xref="alg1.14.m2.1.2.2"><compose id="alg1.14.m2.1.2.2.1.cmml" xref="alg1.14.m2.1.2.2.1"></compose><ci id="alg1.14.m2.1.2.2.2.cmml" xref="alg1.14.m2.1.2.2.2">ℎ</ci><apply id="alg1.14.m2.1.2.2.3.cmml" xref="alg1.14.m2.1.2.2.3"><csymbol cd="ambiguous" id="alg1.14.m2.1.2.2.3.1.cmml" xref="alg1.14.m2.1.2.2.3">superscript</csymbol><ci id="alg1.14.m2.1.2.2.3.2.cmml" xref="alg1.14.m2.1.2.2.3.2">𝑔</ci><ci id="alg1.14.m2.1.2.2.3.3.cmml" xref="alg1.14.m2.1.2.2.3.3">′</ci></apply></apply><ci id="alg1.14.m2.1.1.cmml" xref="alg1.14.m2.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.14.m2.1c">h\circ g^{\prime}(y)</annotation><annotation encoding="application/x-llamapun" id="alg1.14.m2.1d">italic_h ∘ italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y )</annotation></semantics></math> for all <math alttext="y\in\mathcal{Y}" class="ltx_Math" display="inline" id="alg1.15.m3.1"><semantics id="alg1.15.m3.1a"><mrow id="alg1.15.m3.1.1" xref="alg1.15.m3.1.1.cmml"><mi id="alg1.15.m3.1.1.2" xref="alg1.15.m3.1.1.2.cmml">y</mi><mo id="alg1.15.m3.1.1.1" xref="alg1.15.m3.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.15.m3.1.1.3" xref="alg1.15.m3.1.1.3.cmml">𝒴</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.15.m3.1b"><apply id="alg1.15.m3.1.1.cmml" xref="alg1.15.m3.1.1"><in id="alg1.15.m3.1.1.1.cmml" xref="alg1.15.m3.1.1.1"></in><ci id="alg1.15.m3.1.1.2.cmml" xref="alg1.15.m3.1.1.2">𝑦</ci><ci id="alg1.15.m3.1.1.3.cmml" xref="alg1.15.m3.1.1.3">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.15.m3.1c">y\in\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="alg1.15.m3.1d">italic_y ∈ caligraphic_Y</annotation></semantics></math> using the buffer <math alttext="B" class="ltx_Math" display="inline" id="alg1.16.m4.1"><semantics id="alg1.16.m4.1a"><mi id="alg1.16.m4.1.1" xref="alg1.16.m4.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg1.16.m4.1b"><ci id="alg1.16.m4.1.1.cmml" xref="alg1.16.m4.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.16.m4.1c">B</annotation><annotation encoding="application/x-llamapun" id="alg1.16.m4.1d">italic_B</annotation></semantics></math>
<br class="ltx_break"/>Set <math alttext="S_{x_{i}}(\mathcal{Y})" class="ltx_Math" display="inline" id="alg1.17.m5.1"><semantics id="alg1.17.m5.1a"><mrow id="alg1.17.m5.1.2" xref="alg1.17.m5.1.2.cmml"><msub id="alg1.17.m5.1.2.2" xref="alg1.17.m5.1.2.2.cmml"><mi id="alg1.17.m5.1.2.2.2" xref="alg1.17.m5.1.2.2.2.cmml">S</mi><msub id="alg1.17.m5.1.2.2.3" xref="alg1.17.m5.1.2.2.3.cmml"><mi id="alg1.17.m5.1.2.2.3.2" xref="alg1.17.m5.1.2.2.3.2.cmml">x</mi><mi id="alg1.17.m5.1.2.2.3.3" xref="alg1.17.m5.1.2.2.3.3.cmml">i</mi></msub></msub><mo id="alg1.17.m5.1.2.1" xref="alg1.17.m5.1.2.1.cmml">⁢</mo><mrow id="alg1.17.m5.1.2.3.2" xref="alg1.17.m5.1.2.cmml"><mo id="alg1.17.m5.1.2.3.2.1" stretchy="false" xref="alg1.17.m5.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg1.17.m5.1.1" xref="alg1.17.m5.1.1.cmml">𝒴</mi><mo id="alg1.17.m5.1.2.3.2.2" stretchy="false" xref="alg1.17.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.17.m5.1b"><apply id="alg1.17.m5.1.2.cmml" xref="alg1.17.m5.1.2"><times id="alg1.17.m5.1.2.1.cmml" xref="alg1.17.m5.1.2.1"></times><apply id="alg1.17.m5.1.2.2.cmml" xref="alg1.17.m5.1.2.2"><csymbol cd="ambiguous" id="alg1.17.m5.1.2.2.1.cmml" xref="alg1.17.m5.1.2.2">subscript</csymbol><ci id="alg1.17.m5.1.2.2.2.cmml" xref="alg1.17.m5.1.2.2.2">𝑆</ci><apply id="alg1.17.m5.1.2.2.3.cmml" xref="alg1.17.m5.1.2.2.3"><csymbol cd="ambiguous" id="alg1.17.m5.1.2.2.3.1.cmml" xref="alg1.17.m5.1.2.2.3">subscript</csymbol><ci id="alg1.17.m5.1.2.2.3.2.cmml" xref="alg1.17.m5.1.2.2.3.2">𝑥</ci><ci id="alg1.17.m5.1.2.2.3.3.cmml" xref="alg1.17.m5.1.2.2.3.3">𝑖</ci></apply></apply><ci id="alg1.17.m5.1.1.cmml" xref="alg1.17.m5.1.1">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.17.m5.1c">S_{x_{i}}(\mathcal{Y})</annotation><annotation encoding="application/x-llamapun" id="alg1.17.m5.1d">italic_S start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( caligraphic_Y )</annotation></semantics></math> using <math alttext="\exp(\beta f(x_{i})^{T}h\circ g^{\prime}(y))" class="ltx_Math" display="inline" id="alg1.18.m6.3"><semantics id="alg1.18.m6.3a"><mrow id="alg1.18.m6.3.3.1" xref="alg1.18.m6.3.3.2.cmml"><mi id="alg1.18.m6.2.2" xref="alg1.18.m6.2.2.cmml">exp</mi><mo id="alg1.18.m6.3.3.1a" xref="alg1.18.m6.3.3.2.cmml">⁡</mo><mrow id="alg1.18.m6.3.3.1.1" xref="alg1.18.m6.3.3.2.cmml"><mo id="alg1.18.m6.3.3.1.1.2" stretchy="false" xref="alg1.18.m6.3.3.2.cmml">(</mo><mrow id="alg1.18.m6.3.3.1.1.1" xref="alg1.18.m6.3.3.1.1.1.cmml"><mrow id="alg1.18.m6.3.3.1.1.1.1" xref="alg1.18.m6.3.3.1.1.1.1.cmml"><mrow id="alg1.18.m6.3.3.1.1.1.1.1" xref="alg1.18.m6.3.3.1.1.1.1.1.cmml"><mi id="alg1.18.m6.3.3.1.1.1.1.1.3" xref="alg1.18.m6.3.3.1.1.1.1.1.3.cmml">β</mi><mo id="alg1.18.m6.3.3.1.1.1.1.1.2" xref="alg1.18.m6.3.3.1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.18.m6.3.3.1.1.1.1.1.4" xref="alg1.18.m6.3.3.1.1.1.1.1.4.cmml">f</mi><mo id="alg1.18.m6.3.3.1.1.1.1.1.2a" xref="alg1.18.m6.3.3.1.1.1.1.1.2.cmml">⁢</mo><msup id="alg1.18.m6.3.3.1.1.1.1.1.1" xref="alg1.18.m6.3.3.1.1.1.1.1.1.cmml"><mrow id="alg1.18.m6.3.3.1.1.1.1.1.1.1.1" xref="alg1.18.m6.3.3.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg1.18.m6.3.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.18.m6.3.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.18.m6.3.3.1.1.1.1.1.1.1.1.1" xref="alg1.18.m6.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.18.m6.3.3.1.1.1.1.1.1.1.1.1.2" xref="alg1.18.m6.3.3.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="alg1.18.m6.3.3.1.1.1.1.1.1.1.1.1.3" xref="alg1.18.m6.3.3.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.18.m6.3.3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.18.m6.3.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="alg1.18.m6.3.3.1.1.1.1.1.1.3" xref="alg1.18.m6.3.3.1.1.1.1.1.1.3.cmml">T</mi></msup><mo id="alg1.18.m6.3.3.1.1.1.1.1.2b" xref="alg1.18.m6.3.3.1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.18.m6.3.3.1.1.1.1.1.5" xref="alg1.18.m6.3.3.1.1.1.1.1.5.cmml">h</mi></mrow><mo id="alg1.18.m6.3.3.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="alg1.18.m6.3.3.1.1.1.1.2.cmml">∘</mo><msup id="alg1.18.m6.3.3.1.1.1.1.3" xref="alg1.18.m6.3.3.1.1.1.1.3.cmml"><mi id="alg1.18.m6.3.3.1.1.1.1.3.2" xref="alg1.18.m6.3.3.1.1.1.1.3.2.cmml">g</mi><mo id="alg1.18.m6.3.3.1.1.1.1.3.3" xref="alg1.18.m6.3.3.1.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="alg1.18.m6.3.3.1.1.1.2" xref="alg1.18.m6.3.3.1.1.1.2.cmml">⁢</mo><mrow id="alg1.18.m6.3.3.1.1.1.3.2" xref="alg1.18.m6.3.3.1.1.1.cmml"><mo id="alg1.18.m6.3.3.1.1.1.3.2.1" stretchy="false" xref="alg1.18.m6.3.3.1.1.1.cmml">(</mo><mi id="alg1.18.m6.1.1" xref="alg1.18.m6.1.1.cmml">y</mi><mo id="alg1.18.m6.3.3.1.1.1.3.2.2" stretchy="false" xref="alg1.18.m6.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.18.m6.3.3.1.1.3" stretchy="false" xref="alg1.18.m6.3.3.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.18.m6.3b"><apply id="alg1.18.m6.3.3.2.cmml" xref="alg1.18.m6.3.3.1"><exp id="alg1.18.m6.2.2.cmml" xref="alg1.18.m6.2.2"></exp><apply id="alg1.18.m6.3.3.1.1.1.cmml" xref="alg1.18.m6.3.3.1.1.1"><times id="alg1.18.m6.3.3.1.1.1.2.cmml" xref="alg1.18.m6.3.3.1.1.1.2"></times><apply id="alg1.18.m6.3.3.1.1.1.1.cmml" xref="alg1.18.m6.3.3.1.1.1.1"><compose id="alg1.18.m6.3.3.1.1.1.1.2.cmml" xref="alg1.18.m6.3.3.1.1.1.1.2"></compose><apply id="alg1.18.m6.3.3.1.1.1.1.1.cmml" xref="alg1.18.m6.3.3.1.1.1.1.1"><times id="alg1.18.m6.3.3.1.1.1.1.1.2.cmml" xref="alg1.18.m6.3.3.1.1.1.1.1.2"></times><ci id="alg1.18.m6.3.3.1.1.1.1.1.3.cmml" xref="alg1.18.m6.3.3.1.1.1.1.1.3">𝛽</ci><ci id="alg1.18.m6.3.3.1.1.1.1.1.4.cmml" xref="alg1.18.m6.3.3.1.1.1.1.1.4">𝑓</ci><apply id="alg1.18.m6.3.3.1.1.1.1.1.1.cmml" xref="alg1.18.m6.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.18.m6.3.3.1.1.1.1.1.1.2.cmml" xref="alg1.18.m6.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.18.m6.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.18.m6.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.18.m6.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.18.m6.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.18.m6.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.18.m6.3.3.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="alg1.18.m6.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.18.m6.3.3.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="alg1.18.m6.3.3.1.1.1.1.1.1.3.cmml" xref="alg1.18.m6.3.3.1.1.1.1.1.1.3">𝑇</ci></apply><ci id="alg1.18.m6.3.3.1.1.1.1.1.5.cmml" xref="alg1.18.m6.3.3.1.1.1.1.1.5">ℎ</ci></apply><apply id="alg1.18.m6.3.3.1.1.1.1.3.cmml" xref="alg1.18.m6.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.18.m6.3.3.1.1.1.1.3.1.cmml" xref="alg1.18.m6.3.3.1.1.1.1.3">superscript</csymbol><ci id="alg1.18.m6.3.3.1.1.1.1.3.2.cmml" xref="alg1.18.m6.3.3.1.1.1.1.3.2">𝑔</ci><ci id="alg1.18.m6.3.3.1.1.1.1.3.3.cmml" xref="alg1.18.m6.3.3.1.1.1.1.3.3">′</ci></apply></apply><ci id="alg1.18.m6.1.1.cmml" xref="alg1.18.m6.1.1">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.18.m6.3c">\exp(\beta f(x_{i})^{T}h\circ g^{\prime}(y))</annotation><annotation encoding="application/x-llamapun" id="alg1.18.m6.3d">roman_exp ( italic_β italic_f ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_h ∘ italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y ) )</annotation></semantics></math> via top-<math alttext="k" class="ltx_Math" display="inline" id="alg1.19.m7.1"><semantics id="alg1.19.m7.1a"><mi id="alg1.19.m7.1.1" xref="alg1.19.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.19.m7.1b"><ci id="alg1.19.m7.1.1.cmml" xref="alg1.19.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.19.m7.1c">k</annotation><annotation encoding="application/x-llamapun" id="alg1.19.m7.1d">italic_k</annotation></semantics></math>
<br class="ltx_break"/>Include supervised label <math alttext="S_{x_{i}}(\mathcal{Y})\leftarrow S_{x_{i}}(\mathcal{Y})\cup\{y_{i}\}" class="ltx_Math" display="inline" id="alg1.20.m8.3"><semantics id="alg1.20.m8.3a"><mrow id="alg1.20.m8.3.3" xref="alg1.20.m8.3.3.cmml"><mrow id="alg1.20.m8.3.3.3" xref="alg1.20.m8.3.3.3.cmml"><msub id="alg1.20.m8.3.3.3.2" xref="alg1.20.m8.3.3.3.2.cmml"><mi id="alg1.20.m8.3.3.3.2.2" xref="alg1.20.m8.3.3.3.2.2.cmml">S</mi><msub id="alg1.20.m8.3.3.3.2.3" xref="alg1.20.m8.3.3.3.2.3.cmml"><mi id="alg1.20.m8.3.3.3.2.3.2" xref="alg1.20.m8.3.3.3.2.3.2.cmml">x</mi><mi id="alg1.20.m8.3.3.3.2.3.3" xref="alg1.20.m8.3.3.3.2.3.3.cmml">i</mi></msub></msub><mo id="alg1.20.m8.3.3.3.1" xref="alg1.20.m8.3.3.3.1.cmml">⁢</mo><mrow id="alg1.20.m8.3.3.3.3.2" xref="alg1.20.m8.3.3.3.cmml"><mo id="alg1.20.m8.3.3.3.3.2.1" stretchy="false" xref="alg1.20.m8.3.3.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg1.20.m8.1.1" xref="alg1.20.m8.1.1.cmml">𝒴</mi><mo id="alg1.20.m8.3.3.3.3.2.2" stretchy="false" xref="alg1.20.m8.3.3.3.cmml">)</mo></mrow></mrow><mo id="alg1.20.m8.3.3.2" stretchy="false" xref="alg1.20.m8.3.3.2.cmml">←</mo><mrow id="alg1.20.m8.3.3.1" xref="alg1.20.m8.3.3.1.cmml"><mrow id="alg1.20.m8.3.3.1.3" xref="alg1.20.m8.3.3.1.3.cmml"><msub id="alg1.20.m8.3.3.1.3.2" xref="alg1.20.m8.3.3.1.3.2.cmml"><mi id="alg1.20.m8.3.3.1.3.2.2" xref="alg1.20.m8.3.3.1.3.2.2.cmml">S</mi><msub id="alg1.20.m8.3.3.1.3.2.3" xref="alg1.20.m8.3.3.1.3.2.3.cmml"><mi id="alg1.20.m8.3.3.1.3.2.3.2" xref="alg1.20.m8.3.3.1.3.2.3.2.cmml">x</mi><mi id="alg1.20.m8.3.3.1.3.2.3.3" xref="alg1.20.m8.3.3.1.3.2.3.3.cmml">i</mi></msub></msub><mo id="alg1.20.m8.3.3.1.3.1" xref="alg1.20.m8.3.3.1.3.1.cmml">⁢</mo><mrow id="alg1.20.m8.3.3.1.3.3.2" xref="alg1.20.m8.3.3.1.3.cmml"><mo id="alg1.20.m8.3.3.1.3.3.2.1" stretchy="false" xref="alg1.20.m8.3.3.1.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg1.20.m8.2.2" xref="alg1.20.m8.2.2.cmml">𝒴</mi><mo id="alg1.20.m8.3.3.1.3.3.2.2" stretchy="false" xref="alg1.20.m8.3.3.1.3.cmml">)</mo></mrow></mrow><mo id="alg1.20.m8.3.3.1.2" xref="alg1.20.m8.3.3.1.2.cmml">∪</mo><mrow id="alg1.20.m8.3.3.1.1.1" xref="alg1.20.m8.3.3.1.1.2.cmml"><mo id="alg1.20.m8.3.3.1.1.1.2" stretchy="false" xref="alg1.20.m8.3.3.1.1.2.cmml">{</mo><msub id="alg1.20.m8.3.3.1.1.1.1" xref="alg1.20.m8.3.3.1.1.1.1.cmml"><mi id="alg1.20.m8.3.3.1.1.1.1.2" xref="alg1.20.m8.3.3.1.1.1.1.2.cmml">y</mi><mi id="alg1.20.m8.3.3.1.1.1.1.3" xref="alg1.20.m8.3.3.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.20.m8.3.3.1.1.1.3" stretchy="false" xref="alg1.20.m8.3.3.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.20.m8.3b"><apply id="alg1.20.m8.3.3.cmml" xref="alg1.20.m8.3.3"><ci id="alg1.20.m8.3.3.2.cmml" xref="alg1.20.m8.3.3.2">←</ci><apply id="alg1.20.m8.3.3.3.cmml" xref="alg1.20.m8.3.3.3"><times id="alg1.20.m8.3.3.3.1.cmml" xref="alg1.20.m8.3.3.3.1"></times><apply id="alg1.20.m8.3.3.3.2.cmml" xref="alg1.20.m8.3.3.3.2"><csymbol cd="ambiguous" id="alg1.20.m8.3.3.3.2.1.cmml" xref="alg1.20.m8.3.3.3.2">subscript</csymbol><ci id="alg1.20.m8.3.3.3.2.2.cmml" xref="alg1.20.m8.3.3.3.2.2">𝑆</ci><apply id="alg1.20.m8.3.3.3.2.3.cmml" xref="alg1.20.m8.3.3.3.2.3"><csymbol cd="ambiguous" id="alg1.20.m8.3.3.3.2.3.1.cmml" xref="alg1.20.m8.3.3.3.2.3">subscript</csymbol><ci id="alg1.20.m8.3.3.3.2.3.2.cmml" xref="alg1.20.m8.3.3.3.2.3.2">𝑥</ci><ci id="alg1.20.m8.3.3.3.2.3.3.cmml" xref="alg1.20.m8.3.3.3.2.3.3">𝑖</ci></apply></apply><ci id="alg1.20.m8.1.1.cmml" xref="alg1.20.m8.1.1">𝒴</ci></apply><apply id="alg1.20.m8.3.3.1.cmml" xref="alg1.20.m8.3.3.1"><union id="alg1.20.m8.3.3.1.2.cmml" xref="alg1.20.m8.3.3.1.2"></union><apply id="alg1.20.m8.3.3.1.3.cmml" xref="alg1.20.m8.3.3.1.3"><times id="alg1.20.m8.3.3.1.3.1.cmml" xref="alg1.20.m8.3.3.1.3.1"></times><apply id="alg1.20.m8.3.3.1.3.2.cmml" xref="alg1.20.m8.3.3.1.3.2"><csymbol cd="ambiguous" id="alg1.20.m8.3.3.1.3.2.1.cmml" xref="alg1.20.m8.3.3.1.3.2">subscript</csymbol><ci id="alg1.20.m8.3.3.1.3.2.2.cmml" xref="alg1.20.m8.3.3.1.3.2.2">𝑆</ci><apply id="alg1.20.m8.3.3.1.3.2.3.cmml" xref="alg1.20.m8.3.3.1.3.2.3"><csymbol cd="ambiguous" id="alg1.20.m8.3.3.1.3.2.3.1.cmml" xref="alg1.20.m8.3.3.1.3.2.3">subscript</csymbol><ci id="alg1.20.m8.3.3.1.3.2.3.2.cmml" xref="alg1.20.m8.3.3.1.3.2.3.2">𝑥</ci><ci id="alg1.20.m8.3.3.1.3.2.3.3.cmml" xref="alg1.20.m8.3.3.1.3.2.3.3">𝑖</ci></apply></apply><ci id="alg1.20.m8.2.2.cmml" xref="alg1.20.m8.2.2">𝒴</ci></apply><set id="alg1.20.m8.3.3.1.1.2.cmml" xref="alg1.20.m8.3.3.1.1.1"><apply id="alg1.20.m8.3.3.1.1.1.1.cmml" xref="alg1.20.m8.3.3.1.1.1.1"><csymbol cd="ambiguous" id="alg1.20.m8.3.3.1.1.1.1.1.cmml" xref="alg1.20.m8.3.3.1.1.1.1">subscript</csymbol><ci id="alg1.20.m8.3.3.1.1.1.1.2.cmml" xref="alg1.20.m8.3.3.1.1.1.1.2">𝑦</ci><ci id="alg1.20.m8.3.3.1.1.1.1.3.cmml" xref="alg1.20.m8.3.3.1.1.1.1.3">𝑖</ci></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.20.m8.3c">S_{x_{i}}(\mathcal{Y})\leftarrow S_{x_{i}}(\mathcal{Y})\cup\{y_{i}\}</annotation><annotation encoding="application/x-llamapun" id="alg1.20.m8.3d">italic_S start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( caligraphic_Y ) ← italic_S start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( caligraphic_Y ) ∪ { italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT }</annotation></semantics></math>
<br class="ltx_break"/>Define <math alttext="\tilde{P}(y|x_{i})=\frac{\exp(\beta f(x_{i})^{T}g(y))}{\sum_{y^{\prime}\in S_{%
x_{i}}(\mathcal{Y})}\exp(\beta f(x_{i})^{T}g(y^{\prime}))}" class="ltx_Math" display="inline" id="alg1.21.m9.7"><semantics id="alg1.21.m9.7a"><mrow id="alg1.21.m9.7.7" xref="alg1.21.m9.7.7.cmml"><mrow id="alg1.21.m9.7.7.1" xref="alg1.21.m9.7.7.1.cmml"><mover accent="true" id="alg1.21.m9.7.7.1.3" xref="alg1.21.m9.7.7.1.3.cmml"><mi id="alg1.21.m9.7.7.1.3.2" xref="alg1.21.m9.7.7.1.3.2.cmml">P</mi><mo id="alg1.21.m9.7.7.1.3.1" xref="alg1.21.m9.7.7.1.3.1.cmml">~</mo></mover><mo id="alg1.21.m9.7.7.1.2" xref="alg1.21.m9.7.7.1.2.cmml">⁢</mo><mrow id="alg1.21.m9.7.7.1.1.1" xref="alg1.21.m9.7.7.1.1.1.1.cmml"><mo id="alg1.21.m9.7.7.1.1.1.2" stretchy="false" xref="alg1.21.m9.7.7.1.1.1.1.cmml">(</mo><mrow id="alg1.21.m9.7.7.1.1.1.1" xref="alg1.21.m9.7.7.1.1.1.1.cmml"><mi id="alg1.21.m9.7.7.1.1.1.1.2" xref="alg1.21.m9.7.7.1.1.1.1.2.cmml">y</mi><mo fence="false" id="alg1.21.m9.7.7.1.1.1.1.1" xref="alg1.21.m9.7.7.1.1.1.1.1.cmml">|</mo><msub id="alg1.21.m9.7.7.1.1.1.1.3" xref="alg1.21.m9.7.7.1.1.1.1.3.cmml"><mi id="alg1.21.m9.7.7.1.1.1.1.3.2" xref="alg1.21.m9.7.7.1.1.1.1.3.2.cmml">x</mi><mi id="alg1.21.m9.7.7.1.1.1.1.3.3" xref="alg1.21.m9.7.7.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="alg1.21.m9.7.7.1.1.1.3" stretchy="false" xref="alg1.21.m9.7.7.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.21.m9.7.7.2" xref="alg1.21.m9.7.7.2.cmml">=</mo><mfrac id="alg1.21.m9.6.6" xref="alg1.21.m9.6.6.cmml"><mrow id="alg1.21.m9.3.3.3.3" xref="alg1.21.m9.3.3.3.4.cmml"><mi id="alg1.21.m9.2.2.2.2" xref="alg1.21.m9.2.2.2.2.cmml">exp</mi><mo id="alg1.21.m9.3.3.3.3a" xref="alg1.21.m9.3.3.3.4.cmml">⁡</mo><mrow id="alg1.21.m9.3.3.3.3.1" xref="alg1.21.m9.3.3.3.4.cmml"><mo id="alg1.21.m9.3.3.3.3.1.2" stretchy="false" xref="alg1.21.m9.3.3.3.4.cmml">(</mo><mrow id="alg1.21.m9.3.3.3.3.1.1" xref="alg1.21.m9.3.3.3.3.1.1.cmml"><mi id="alg1.21.m9.3.3.3.3.1.1.3" xref="alg1.21.m9.3.3.3.3.1.1.3.cmml">β</mi><mo id="alg1.21.m9.3.3.3.3.1.1.2" xref="alg1.21.m9.3.3.3.3.1.1.2.cmml">⁢</mo><mi id="alg1.21.m9.3.3.3.3.1.1.4" xref="alg1.21.m9.3.3.3.3.1.1.4.cmml">f</mi><mo id="alg1.21.m9.3.3.3.3.1.1.2a" xref="alg1.21.m9.3.3.3.3.1.1.2.cmml">⁢</mo><msup id="alg1.21.m9.3.3.3.3.1.1.1" xref="alg1.21.m9.3.3.3.3.1.1.1.cmml"><mrow id="alg1.21.m9.3.3.3.3.1.1.1.1.1" xref="alg1.21.m9.3.3.3.3.1.1.1.1.1.1.cmml"><mo id="alg1.21.m9.3.3.3.3.1.1.1.1.1.2" stretchy="false" xref="alg1.21.m9.3.3.3.3.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.21.m9.3.3.3.3.1.1.1.1.1.1" xref="alg1.21.m9.3.3.3.3.1.1.1.1.1.1.cmml"><mi id="alg1.21.m9.3.3.3.3.1.1.1.1.1.1.2" xref="alg1.21.m9.3.3.3.3.1.1.1.1.1.1.2.cmml">x</mi><mi id="alg1.21.m9.3.3.3.3.1.1.1.1.1.1.3" xref="alg1.21.m9.3.3.3.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.21.m9.3.3.3.3.1.1.1.1.1.3" stretchy="false" xref="alg1.21.m9.3.3.3.3.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="alg1.21.m9.3.3.3.3.1.1.1.3" xref="alg1.21.m9.3.3.3.3.1.1.1.3.cmml">T</mi></msup><mo id="alg1.21.m9.3.3.3.3.1.1.2b" xref="alg1.21.m9.3.3.3.3.1.1.2.cmml">⁢</mo><mi id="alg1.21.m9.3.3.3.3.1.1.5" xref="alg1.21.m9.3.3.3.3.1.1.5.cmml">g</mi><mo id="alg1.21.m9.3.3.3.3.1.1.2c" xref="alg1.21.m9.3.3.3.3.1.1.2.cmml">⁢</mo><mrow id="alg1.21.m9.3.3.3.3.1.1.6.2" xref="alg1.21.m9.3.3.3.3.1.1.cmml"><mo id="alg1.21.m9.3.3.3.3.1.1.6.2.1" stretchy="false" xref="alg1.21.m9.3.3.3.3.1.1.cmml">(</mo><mi id="alg1.21.m9.1.1.1.1" xref="alg1.21.m9.1.1.1.1.cmml">y</mi><mo id="alg1.21.m9.3.3.3.3.1.1.6.2.2" stretchy="false" xref="alg1.21.m9.3.3.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.21.m9.3.3.3.3.1.3" stretchy="false" xref="alg1.21.m9.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="alg1.21.m9.6.6.6" xref="alg1.21.m9.6.6.6.cmml"><mstyle displaystyle="false" id="alg1.21.m9.6.6.6.4" xref="alg1.21.m9.6.6.6.4.cmml"><msub id="alg1.21.m9.6.6.6.4a" xref="alg1.21.m9.6.6.6.4.cmml"><mo id="alg1.21.m9.6.6.6.4.2" xref="alg1.21.m9.6.6.6.4.2.cmml">∑</mo><mrow id="alg1.21.m9.4.4.4.1.1" xref="alg1.21.m9.4.4.4.1.1.cmml"><msup id="alg1.21.m9.4.4.4.1.1.3" xref="alg1.21.m9.4.4.4.1.1.3.cmml"><mi id="alg1.21.m9.4.4.4.1.1.3.2" xref="alg1.21.m9.4.4.4.1.1.3.2.cmml">y</mi><mo id="alg1.21.m9.4.4.4.1.1.3.3" xref="alg1.21.m9.4.4.4.1.1.3.3.cmml">′</mo></msup><mo id="alg1.21.m9.4.4.4.1.1.2" xref="alg1.21.m9.4.4.4.1.1.2.cmml">∈</mo><mrow id="alg1.21.m9.4.4.4.1.1.4" xref="alg1.21.m9.4.4.4.1.1.4.cmml"><msub id="alg1.21.m9.4.4.4.1.1.4.2" xref="alg1.21.m9.4.4.4.1.1.4.2.cmml"><mi id="alg1.21.m9.4.4.4.1.1.4.2.2" xref="alg1.21.m9.4.4.4.1.1.4.2.2.cmml">S</mi><msub id="alg1.21.m9.4.4.4.1.1.4.2.3" xref="alg1.21.m9.4.4.4.1.1.4.2.3.cmml"><mi id="alg1.21.m9.4.4.4.1.1.4.2.3.2" xref="alg1.21.m9.4.4.4.1.1.4.2.3.2.cmml">x</mi><mi id="alg1.21.m9.4.4.4.1.1.4.2.3.3" xref="alg1.21.m9.4.4.4.1.1.4.2.3.3.cmml">i</mi></msub></msub><mo id="alg1.21.m9.4.4.4.1.1.4.1" xref="alg1.21.m9.4.4.4.1.1.4.1.cmml">⁢</mo><mrow id="alg1.21.m9.4.4.4.1.1.4.3.2" xref="alg1.21.m9.4.4.4.1.1.4.cmml"><mo id="alg1.21.m9.4.4.4.1.1.4.3.2.1" stretchy="false" xref="alg1.21.m9.4.4.4.1.1.4.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg1.21.m9.4.4.4.1.1.1" xref="alg1.21.m9.4.4.4.1.1.1.cmml">𝒴</mi><mo id="alg1.21.m9.4.4.4.1.1.4.3.2.2" stretchy="false" xref="alg1.21.m9.4.4.4.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub></mstyle><mrow id="alg1.21.m9.6.6.6.3.1" xref="alg1.21.m9.6.6.6.3.2.cmml"><mi id="alg1.21.m9.5.5.5.2" xref="alg1.21.m9.5.5.5.2.cmml">exp</mi><mo id="alg1.21.m9.6.6.6.3.1a" xref="alg1.21.m9.6.6.6.3.2.cmml">⁡</mo><mrow id="alg1.21.m9.6.6.6.3.1.1" xref="alg1.21.m9.6.6.6.3.2.cmml"><mo id="alg1.21.m9.6.6.6.3.1.1.2" stretchy="false" xref="alg1.21.m9.6.6.6.3.2.cmml">(</mo><mrow id="alg1.21.m9.6.6.6.3.1.1.1" xref="alg1.21.m9.6.6.6.3.1.1.1.cmml"><mi id="alg1.21.m9.6.6.6.3.1.1.1.4" xref="alg1.21.m9.6.6.6.3.1.1.1.4.cmml">β</mi><mo id="alg1.21.m9.6.6.6.3.1.1.1.3" xref="alg1.21.m9.6.6.6.3.1.1.1.3.cmml">⁢</mo><mi id="alg1.21.m9.6.6.6.3.1.1.1.5" xref="alg1.21.m9.6.6.6.3.1.1.1.5.cmml">f</mi><mo id="alg1.21.m9.6.6.6.3.1.1.1.3a" xref="alg1.21.m9.6.6.6.3.1.1.1.3.cmml">⁢</mo><msup id="alg1.21.m9.6.6.6.3.1.1.1.1" xref="alg1.21.m9.6.6.6.3.1.1.1.1.cmml"><mrow id="alg1.21.m9.6.6.6.3.1.1.1.1.1.1" xref="alg1.21.m9.6.6.6.3.1.1.1.1.1.1.1.cmml"><mo id="alg1.21.m9.6.6.6.3.1.1.1.1.1.1.2" stretchy="false" xref="alg1.21.m9.6.6.6.3.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.21.m9.6.6.6.3.1.1.1.1.1.1.1" xref="alg1.21.m9.6.6.6.3.1.1.1.1.1.1.1.cmml"><mi id="alg1.21.m9.6.6.6.3.1.1.1.1.1.1.1.2" xref="alg1.21.m9.6.6.6.3.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="alg1.21.m9.6.6.6.3.1.1.1.1.1.1.1.3" xref="alg1.21.m9.6.6.6.3.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.21.m9.6.6.6.3.1.1.1.1.1.1.3" stretchy="false" xref="alg1.21.m9.6.6.6.3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="alg1.21.m9.6.6.6.3.1.1.1.1.3" xref="alg1.21.m9.6.6.6.3.1.1.1.1.3.cmml">T</mi></msup><mo id="alg1.21.m9.6.6.6.3.1.1.1.3b" xref="alg1.21.m9.6.6.6.3.1.1.1.3.cmml">⁢</mo><mi id="alg1.21.m9.6.6.6.3.1.1.1.6" xref="alg1.21.m9.6.6.6.3.1.1.1.6.cmml">g</mi><mo id="alg1.21.m9.6.6.6.3.1.1.1.3c" xref="alg1.21.m9.6.6.6.3.1.1.1.3.cmml">⁢</mo><mrow id="alg1.21.m9.6.6.6.3.1.1.1.2.1" xref="alg1.21.m9.6.6.6.3.1.1.1.2.1.1.cmml"><mo id="alg1.21.m9.6.6.6.3.1.1.1.2.1.2" stretchy="false" xref="alg1.21.m9.6.6.6.3.1.1.1.2.1.1.cmml">(</mo><msup id="alg1.21.m9.6.6.6.3.1.1.1.2.1.1" xref="alg1.21.m9.6.6.6.3.1.1.1.2.1.1.cmml"><mi id="alg1.21.m9.6.6.6.3.1.1.1.2.1.1.2" xref="alg1.21.m9.6.6.6.3.1.1.1.2.1.1.2.cmml">y</mi><mo id="alg1.21.m9.6.6.6.3.1.1.1.2.1.1.3" xref="alg1.21.m9.6.6.6.3.1.1.1.2.1.1.3.cmml">′</mo></msup><mo id="alg1.21.m9.6.6.6.3.1.1.1.2.1.3" stretchy="false" xref="alg1.21.m9.6.6.6.3.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.21.m9.6.6.6.3.1.1.3" stretchy="false" xref="alg1.21.m9.6.6.6.3.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg1.21.m9.7b"><apply id="alg1.21.m9.7.7.cmml" xref="alg1.21.m9.7.7"><eq id="alg1.21.m9.7.7.2.cmml" xref="alg1.21.m9.7.7.2"></eq><apply id="alg1.21.m9.7.7.1.cmml" xref="alg1.21.m9.7.7.1"><times id="alg1.21.m9.7.7.1.2.cmml" xref="alg1.21.m9.7.7.1.2"></times><apply id="alg1.21.m9.7.7.1.3.cmml" xref="alg1.21.m9.7.7.1.3"><ci id="alg1.21.m9.7.7.1.3.1.cmml" xref="alg1.21.m9.7.7.1.3.1">~</ci><ci id="alg1.21.m9.7.7.1.3.2.cmml" xref="alg1.21.m9.7.7.1.3.2">𝑃</ci></apply><apply id="alg1.21.m9.7.7.1.1.1.1.cmml" xref="alg1.21.m9.7.7.1.1.1"><csymbol cd="latexml" id="alg1.21.m9.7.7.1.1.1.1.1.cmml" xref="alg1.21.m9.7.7.1.1.1.1.1">conditional</csymbol><ci id="alg1.21.m9.7.7.1.1.1.1.2.cmml" xref="alg1.21.m9.7.7.1.1.1.1.2">𝑦</ci><apply id="alg1.21.m9.7.7.1.1.1.1.3.cmml" xref="alg1.21.m9.7.7.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.21.m9.7.7.1.1.1.1.3.1.cmml" xref="alg1.21.m9.7.7.1.1.1.1.3">subscript</csymbol><ci id="alg1.21.m9.7.7.1.1.1.1.3.2.cmml" xref="alg1.21.m9.7.7.1.1.1.1.3.2">𝑥</ci><ci id="alg1.21.m9.7.7.1.1.1.1.3.3.cmml" xref="alg1.21.m9.7.7.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><apply id="alg1.21.m9.6.6.cmml" xref="alg1.21.m9.6.6"><divide id="alg1.21.m9.6.6.7.cmml" xref="alg1.21.m9.6.6"></divide><apply id="alg1.21.m9.3.3.3.4.cmml" xref="alg1.21.m9.3.3.3.3"><exp id="alg1.21.m9.2.2.2.2.cmml" xref="alg1.21.m9.2.2.2.2"></exp><apply id="alg1.21.m9.3.3.3.3.1.1.cmml" xref="alg1.21.m9.3.3.3.3.1.1"><times id="alg1.21.m9.3.3.3.3.1.1.2.cmml" xref="alg1.21.m9.3.3.3.3.1.1.2"></times><ci id="alg1.21.m9.3.3.3.3.1.1.3.cmml" xref="alg1.21.m9.3.3.3.3.1.1.3">𝛽</ci><ci id="alg1.21.m9.3.3.3.3.1.1.4.cmml" xref="alg1.21.m9.3.3.3.3.1.1.4">𝑓</ci><apply id="alg1.21.m9.3.3.3.3.1.1.1.cmml" xref="alg1.21.m9.3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.21.m9.3.3.3.3.1.1.1.2.cmml" xref="alg1.21.m9.3.3.3.3.1.1.1">superscript</csymbol><apply id="alg1.21.m9.3.3.3.3.1.1.1.1.1.1.cmml" xref="alg1.21.m9.3.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.21.m9.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="alg1.21.m9.3.3.3.3.1.1.1.1.1">subscript</csymbol><ci id="alg1.21.m9.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="alg1.21.m9.3.3.3.3.1.1.1.1.1.1.2">𝑥</ci><ci id="alg1.21.m9.3.3.3.3.1.1.1.1.1.1.3.cmml" xref="alg1.21.m9.3.3.3.3.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="alg1.21.m9.3.3.3.3.1.1.1.3.cmml" xref="alg1.21.m9.3.3.3.3.1.1.1.3">𝑇</ci></apply><ci id="alg1.21.m9.3.3.3.3.1.1.5.cmml" xref="alg1.21.m9.3.3.3.3.1.1.5">𝑔</ci><ci id="alg1.21.m9.1.1.1.1.cmml" xref="alg1.21.m9.1.1.1.1">𝑦</ci></apply></apply><apply id="alg1.21.m9.6.6.6.cmml" xref="alg1.21.m9.6.6.6"><apply id="alg1.21.m9.6.6.6.4.cmml" xref="alg1.21.m9.6.6.6.4"><csymbol cd="ambiguous" id="alg1.21.m9.6.6.6.4.1.cmml" xref="alg1.21.m9.6.6.6.4">subscript</csymbol><sum id="alg1.21.m9.6.6.6.4.2.cmml" xref="alg1.21.m9.6.6.6.4.2"></sum><apply id="alg1.21.m9.4.4.4.1.1.cmml" xref="alg1.21.m9.4.4.4.1.1"><in id="alg1.21.m9.4.4.4.1.1.2.cmml" xref="alg1.21.m9.4.4.4.1.1.2"></in><apply id="alg1.21.m9.4.4.4.1.1.3.cmml" xref="alg1.21.m9.4.4.4.1.1.3"><csymbol cd="ambiguous" id="alg1.21.m9.4.4.4.1.1.3.1.cmml" xref="alg1.21.m9.4.4.4.1.1.3">superscript</csymbol><ci id="alg1.21.m9.4.4.4.1.1.3.2.cmml" xref="alg1.21.m9.4.4.4.1.1.3.2">𝑦</ci><ci id="alg1.21.m9.4.4.4.1.1.3.3.cmml" xref="alg1.21.m9.4.4.4.1.1.3.3">′</ci></apply><apply id="alg1.21.m9.4.4.4.1.1.4.cmml" xref="alg1.21.m9.4.4.4.1.1.4"><times id="alg1.21.m9.4.4.4.1.1.4.1.cmml" xref="alg1.21.m9.4.4.4.1.1.4.1"></times><apply id="alg1.21.m9.4.4.4.1.1.4.2.cmml" xref="alg1.21.m9.4.4.4.1.1.4.2"><csymbol cd="ambiguous" id="alg1.21.m9.4.4.4.1.1.4.2.1.cmml" xref="alg1.21.m9.4.4.4.1.1.4.2">subscript</csymbol><ci id="alg1.21.m9.4.4.4.1.1.4.2.2.cmml" xref="alg1.21.m9.4.4.4.1.1.4.2.2">𝑆</ci><apply id="alg1.21.m9.4.4.4.1.1.4.2.3.cmml" xref="alg1.21.m9.4.4.4.1.1.4.2.3"><csymbol cd="ambiguous" id="alg1.21.m9.4.4.4.1.1.4.2.3.1.cmml" xref="alg1.21.m9.4.4.4.1.1.4.2.3">subscript</csymbol><ci id="alg1.21.m9.4.4.4.1.1.4.2.3.2.cmml" xref="alg1.21.m9.4.4.4.1.1.4.2.3.2">𝑥</ci><ci id="alg1.21.m9.4.4.4.1.1.4.2.3.3.cmml" xref="alg1.21.m9.4.4.4.1.1.4.2.3.3">𝑖</ci></apply></apply><ci id="alg1.21.m9.4.4.4.1.1.1.cmml" xref="alg1.21.m9.4.4.4.1.1.1">𝒴</ci></apply></apply></apply><apply id="alg1.21.m9.6.6.6.3.2.cmml" xref="alg1.21.m9.6.6.6.3.1"><exp id="alg1.21.m9.5.5.5.2.cmml" xref="alg1.21.m9.5.5.5.2"></exp><apply id="alg1.21.m9.6.6.6.3.1.1.1.cmml" xref="alg1.21.m9.6.6.6.3.1.1.1"><times id="alg1.21.m9.6.6.6.3.1.1.1.3.cmml" xref="alg1.21.m9.6.6.6.3.1.1.1.3"></times><ci id="alg1.21.m9.6.6.6.3.1.1.1.4.cmml" xref="alg1.21.m9.6.6.6.3.1.1.1.4">𝛽</ci><ci id="alg1.21.m9.6.6.6.3.1.1.1.5.cmml" xref="alg1.21.m9.6.6.6.3.1.1.1.5">𝑓</ci><apply id="alg1.21.m9.6.6.6.3.1.1.1.1.cmml" xref="alg1.21.m9.6.6.6.3.1.1.1.1"><csymbol cd="ambiguous" id="alg1.21.m9.6.6.6.3.1.1.1.1.2.cmml" xref="alg1.21.m9.6.6.6.3.1.1.1.1">superscript</csymbol><apply id="alg1.21.m9.6.6.6.3.1.1.1.1.1.1.1.cmml" xref="alg1.21.m9.6.6.6.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.21.m9.6.6.6.3.1.1.1.1.1.1.1.1.cmml" xref="alg1.21.m9.6.6.6.3.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.21.m9.6.6.6.3.1.1.1.1.1.1.1.2.cmml" xref="alg1.21.m9.6.6.6.3.1.1.1.1.1.1.1.2">𝑥</ci><ci id="alg1.21.m9.6.6.6.3.1.1.1.1.1.1.1.3.cmml" xref="alg1.21.m9.6.6.6.3.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="alg1.21.m9.6.6.6.3.1.1.1.1.3.cmml" xref="alg1.21.m9.6.6.6.3.1.1.1.1.3">𝑇</ci></apply><ci id="alg1.21.m9.6.6.6.3.1.1.1.6.cmml" xref="alg1.21.m9.6.6.6.3.1.1.1.6">𝑔</ci><apply id="alg1.21.m9.6.6.6.3.1.1.1.2.1.1.cmml" xref="alg1.21.m9.6.6.6.3.1.1.1.2.1"><csymbol cd="ambiguous" id="alg1.21.m9.6.6.6.3.1.1.1.2.1.1.1.cmml" xref="alg1.21.m9.6.6.6.3.1.1.1.2.1">superscript</csymbol><ci id="alg1.21.m9.6.6.6.3.1.1.1.2.1.1.2.cmml" xref="alg1.21.m9.6.6.6.3.1.1.1.2.1.1.2">𝑦</ci><ci id="alg1.21.m9.6.6.6.3.1.1.1.2.1.1.3.cmml" xref="alg1.21.m9.6.6.6.3.1.1.1.2.1.1.3">′</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.21.m9.7c">\tilde{P}(y|x_{i})=\frac{\exp(\beta f(x_{i})^{T}g(y))}{\sum_{y^{\prime}\in S_{%
x_{i}}(\mathcal{Y})}\exp(\beta f(x_{i})^{T}g(y^{\prime}))}</annotation><annotation encoding="application/x-llamapun" id="alg1.21.m9.7d">over~ start_ARG italic_P end_ARG ( italic_y | italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = divide start_ARG roman_exp ( italic_β italic_f ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_g ( italic_y ) ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ italic_S start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( caligraphic_Y ) end_POSTSUBSCRIPT roman_exp ( italic_β italic_f ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_g ( italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ) end_ARG</annotation></semantics></math>
<br class="ltx_break"/>Define <math alttext="{\tilde{P}_{h}(y|x_{i})=\frac{\exp(\beta f(x_{i})^{T}h\circ g^{\prime}(y))}{%
\sum_{y^{\prime}\in S_{x_{i}}(\mathcal{Y})}\exp(\beta f(x_{i})^{T}h\circ g^{%
\prime}(y^{\prime}))}}" class="ltx_Math" display="inline" id="alg1.22.m10.7"><semantics id="alg1.22.m10.7a"><mrow id="alg1.22.m10.7.7" xref="alg1.22.m10.7.7.cmml"><mrow id="alg1.22.m10.7.7.1" xref="alg1.22.m10.7.7.1.cmml"><msub id="alg1.22.m10.7.7.1.3" xref="alg1.22.m10.7.7.1.3.cmml"><mover accent="true" id="alg1.22.m10.7.7.1.3.2" xref="alg1.22.m10.7.7.1.3.2.cmml"><mi id="alg1.22.m10.7.7.1.3.2.2" xref="alg1.22.m10.7.7.1.3.2.2.cmml">P</mi><mo id="alg1.22.m10.7.7.1.3.2.1" xref="alg1.22.m10.7.7.1.3.2.1.cmml">~</mo></mover><mi id="alg1.22.m10.7.7.1.3.3" xref="alg1.22.m10.7.7.1.3.3.cmml">h</mi></msub><mo id="alg1.22.m10.7.7.1.2" xref="alg1.22.m10.7.7.1.2.cmml">⁢</mo><mrow id="alg1.22.m10.7.7.1.1.1" xref="alg1.22.m10.7.7.1.1.1.1.cmml"><mo id="alg1.22.m10.7.7.1.1.1.2" stretchy="false" xref="alg1.22.m10.7.7.1.1.1.1.cmml">(</mo><mrow id="alg1.22.m10.7.7.1.1.1.1" xref="alg1.22.m10.7.7.1.1.1.1.cmml"><mi id="alg1.22.m10.7.7.1.1.1.1.2" xref="alg1.22.m10.7.7.1.1.1.1.2.cmml">y</mi><mo fence="false" id="alg1.22.m10.7.7.1.1.1.1.1" xref="alg1.22.m10.7.7.1.1.1.1.1.cmml">|</mo><msub id="alg1.22.m10.7.7.1.1.1.1.3" xref="alg1.22.m10.7.7.1.1.1.1.3.cmml"><mi id="alg1.22.m10.7.7.1.1.1.1.3.2" xref="alg1.22.m10.7.7.1.1.1.1.3.2.cmml">x</mi><mi id="alg1.22.m10.7.7.1.1.1.1.3.3" xref="alg1.22.m10.7.7.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="alg1.22.m10.7.7.1.1.1.3" stretchy="false" xref="alg1.22.m10.7.7.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.22.m10.7.7.2" xref="alg1.22.m10.7.7.2.cmml">=</mo><mfrac id="alg1.22.m10.6.6" xref="alg1.22.m10.6.6.cmml"><mrow id="alg1.22.m10.3.3.3.3" xref="alg1.22.m10.3.3.3.4.cmml"><mi id="alg1.22.m10.2.2.2.2" xref="alg1.22.m10.2.2.2.2.cmml">exp</mi><mo id="alg1.22.m10.3.3.3.3a" xref="alg1.22.m10.3.3.3.4.cmml">⁡</mo><mrow id="alg1.22.m10.3.3.3.3.1" xref="alg1.22.m10.3.3.3.4.cmml"><mo id="alg1.22.m10.3.3.3.3.1.2" stretchy="false" xref="alg1.22.m10.3.3.3.4.cmml">(</mo><mrow id="alg1.22.m10.3.3.3.3.1.1" xref="alg1.22.m10.3.3.3.3.1.1.cmml"><mrow id="alg1.22.m10.3.3.3.3.1.1.1" xref="alg1.22.m10.3.3.3.3.1.1.1.cmml"><mrow id="alg1.22.m10.3.3.3.3.1.1.1.1" xref="alg1.22.m10.3.3.3.3.1.1.1.1.cmml"><mi id="alg1.22.m10.3.3.3.3.1.1.1.1.3" xref="alg1.22.m10.3.3.3.3.1.1.1.1.3.cmml">β</mi><mo id="alg1.22.m10.3.3.3.3.1.1.1.1.2" xref="alg1.22.m10.3.3.3.3.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.22.m10.3.3.3.3.1.1.1.1.4" xref="alg1.22.m10.3.3.3.3.1.1.1.1.4.cmml">f</mi><mo id="alg1.22.m10.3.3.3.3.1.1.1.1.2a" xref="alg1.22.m10.3.3.3.3.1.1.1.1.2.cmml">⁢</mo><msup id="alg1.22.m10.3.3.3.3.1.1.1.1.1" xref="alg1.22.m10.3.3.3.3.1.1.1.1.1.cmml"><mrow id="alg1.22.m10.3.3.3.3.1.1.1.1.1.1.1" xref="alg1.22.m10.3.3.3.3.1.1.1.1.1.1.1.1.cmml"><mo id="alg1.22.m10.3.3.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.22.m10.3.3.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.22.m10.3.3.3.3.1.1.1.1.1.1.1.1" xref="alg1.22.m10.3.3.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.22.m10.3.3.3.3.1.1.1.1.1.1.1.1.2" xref="alg1.22.m10.3.3.3.3.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="alg1.22.m10.3.3.3.3.1.1.1.1.1.1.1.1.3" xref="alg1.22.m10.3.3.3.3.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.22.m10.3.3.3.3.1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.22.m10.3.3.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="alg1.22.m10.3.3.3.3.1.1.1.1.1.3" xref="alg1.22.m10.3.3.3.3.1.1.1.1.1.3.cmml">T</mi></msup><mo id="alg1.22.m10.3.3.3.3.1.1.1.1.2b" xref="alg1.22.m10.3.3.3.3.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.22.m10.3.3.3.3.1.1.1.1.5" xref="alg1.22.m10.3.3.3.3.1.1.1.1.5.cmml">h</mi></mrow><mo id="alg1.22.m10.3.3.3.3.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="alg1.22.m10.3.3.3.3.1.1.1.2.cmml">∘</mo><msup id="alg1.22.m10.3.3.3.3.1.1.1.3" xref="alg1.22.m10.3.3.3.3.1.1.1.3.cmml"><mi id="alg1.22.m10.3.3.3.3.1.1.1.3.2" xref="alg1.22.m10.3.3.3.3.1.1.1.3.2.cmml">g</mi><mo id="alg1.22.m10.3.3.3.3.1.1.1.3.3" xref="alg1.22.m10.3.3.3.3.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="alg1.22.m10.3.3.3.3.1.1.2" xref="alg1.22.m10.3.3.3.3.1.1.2.cmml">⁢</mo><mrow id="alg1.22.m10.3.3.3.3.1.1.3.2" xref="alg1.22.m10.3.3.3.3.1.1.cmml"><mo id="alg1.22.m10.3.3.3.3.1.1.3.2.1" stretchy="false" xref="alg1.22.m10.3.3.3.3.1.1.cmml">(</mo><mi id="alg1.22.m10.1.1.1.1" xref="alg1.22.m10.1.1.1.1.cmml">y</mi><mo id="alg1.22.m10.3.3.3.3.1.1.3.2.2" stretchy="false" xref="alg1.22.m10.3.3.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.22.m10.3.3.3.3.1.3" stretchy="false" xref="alg1.22.m10.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="alg1.22.m10.6.6.6" xref="alg1.22.m10.6.6.6.cmml"><mstyle displaystyle="false" id="alg1.22.m10.6.6.6.4" xref="alg1.22.m10.6.6.6.4.cmml"><msub id="alg1.22.m10.6.6.6.4a" xref="alg1.22.m10.6.6.6.4.cmml"><mo id="alg1.22.m10.6.6.6.4.2" xref="alg1.22.m10.6.6.6.4.2.cmml">∑</mo><mrow id="alg1.22.m10.4.4.4.1.1" xref="alg1.22.m10.4.4.4.1.1.cmml"><msup id="alg1.22.m10.4.4.4.1.1.3" xref="alg1.22.m10.4.4.4.1.1.3.cmml"><mi id="alg1.22.m10.4.4.4.1.1.3.2" xref="alg1.22.m10.4.4.4.1.1.3.2.cmml">y</mi><mo id="alg1.22.m10.4.4.4.1.1.3.3" xref="alg1.22.m10.4.4.4.1.1.3.3.cmml">′</mo></msup><mo id="alg1.22.m10.4.4.4.1.1.2" xref="alg1.22.m10.4.4.4.1.1.2.cmml">∈</mo><mrow id="alg1.22.m10.4.4.4.1.1.4" xref="alg1.22.m10.4.4.4.1.1.4.cmml"><msub id="alg1.22.m10.4.4.4.1.1.4.2" xref="alg1.22.m10.4.4.4.1.1.4.2.cmml"><mi id="alg1.22.m10.4.4.4.1.1.4.2.2" xref="alg1.22.m10.4.4.4.1.1.4.2.2.cmml">S</mi><msub id="alg1.22.m10.4.4.4.1.1.4.2.3" xref="alg1.22.m10.4.4.4.1.1.4.2.3.cmml"><mi id="alg1.22.m10.4.4.4.1.1.4.2.3.2" xref="alg1.22.m10.4.4.4.1.1.4.2.3.2.cmml">x</mi><mi id="alg1.22.m10.4.4.4.1.1.4.2.3.3" xref="alg1.22.m10.4.4.4.1.1.4.2.3.3.cmml">i</mi></msub></msub><mo id="alg1.22.m10.4.4.4.1.1.4.1" xref="alg1.22.m10.4.4.4.1.1.4.1.cmml">⁢</mo><mrow id="alg1.22.m10.4.4.4.1.1.4.3.2" xref="alg1.22.m10.4.4.4.1.1.4.cmml"><mo id="alg1.22.m10.4.4.4.1.1.4.3.2.1" stretchy="false" xref="alg1.22.m10.4.4.4.1.1.4.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg1.22.m10.4.4.4.1.1.1" xref="alg1.22.m10.4.4.4.1.1.1.cmml">𝒴</mi><mo id="alg1.22.m10.4.4.4.1.1.4.3.2.2" stretchy="false" xref="alg1.22.m10.4.4.4.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub></mstyle><mrow id="alg1.22.m10.6.6.6.3.1" xref="alg1.22.m10.6.6.6.3.2.cmml"><mi id="alg1.22.m10.5.5.5.2" xref="alg1.22.m10.5.5.5.2.cmml">exp</mi><mo id="alg1.22.m10.6.6.6.3.1a" xref="alg1.22.m10.6.6.6.3.2.cmml">⁡</mo><mrow id="alg1.22.m10.6.6.6.3.1.1" xref="alg1.22.m10.6.6.6.3.2.cmml"><mo id="alg1.22.m10.6.6.6.3.1.1.2" stretchy="false" xref="alg1.22.m10.6.6.6.3.2.cmml">(</mo><mrow id="alg1.22.m10.6.6.6.3.1.1.1" xref="alg1.22.m10.6.6.6.3.1.1.1.cmml"><mrow id="alg1.22.m10.6.6.6.3.1.1.1.1" xref="alg1.22.m10.6.6.6.3.1.1.1.1.cmml"><mrow id="alg1.22.m10.6.6.6.3.1.1.1.1.1" xref="alg1.22.m10.6.6.6.3.1.1.1.1.1.cmml"><mi id="alg1.22.m10.6.6.6.3.1.1.1.1.1.3" xref="alg1.22.m10.6.6.6.3.1.1.1.1.1.3.cmml">β</mi><mo id="alg1.22.m10.6.6.6.3.1.1.1.1.1.2" xref="alg1.22.m10.6.6.6.3.1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.22.m10.6.6.6.3.1.1.1.1.1.4" xref="alg1.22.m10.6.6.6.3.1.1.1.1.1.4.cmml">f</mi><mo id="alg1.22.m10.6.6.6.3.1.1.1.1.1.2a" xref="alg1.22.m10.6.6.6.3.1.1.1.1.1.2.cmml">⁢</mo><msup id="alg1.22.m10.6.6.6.3.1.1.1.1.1.1" xref="alg1.22.m10.6.6.6.3.1.1.1.1.1.1.cmml"><mrow id="alg1.22.m10.6.6.6.3.1.1.1.1.1.1.1.1" xref="alg1.22.m10.6.6.6.3.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg1.22.m10.6.6.6.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.22.m10.6.6.6.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.22.m10.6.6.6.3.1.1.1.1.1.1.1.1.1" xref="alg1.22.m10.6.6.6.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.22.m10.6.6.6.3.1.1.1.1.1.1.1.1.1.2" xref="alg1.22.m10.6.6.6.3.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="alg1.22.m10.6.6.6.3.1.1.1.1.1.1.1.1.1.3" xref="alg1.22.m10.6.6.6.3.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.22.m10.6.6.6.3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.22.m10.6.6.6.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="alg1.22.m10.6.6.6.3.1.1.1.1.1.1.3" xref="alg1.22.m10.6.6.6.3.1.1.1.1.1.1.3.cmml">T</mi></msup><mo id="alg1.22.m10.6.6.6.3.1.1.1.1.1.2b" xref="alg1.22.m10.6.6.6.3.1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.22.m10.6.6.6.3.1.1.1.1.1.5" xref="alg1.22.m10.6.6.6.3.1.1.1.1.1.5.cmml">h</mi></mrow><mo id="alg1.22.m10.6.6.6.3.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="alg1.22.m10.6.6.6.3.1.1.1.1.2.cmml">∘</mo><msup id="alg1.22.m10.6.6.6.3.1.1.1.1.3" xref="alg1.22.m10.6.6.6.3.1.1.1.1.3.cmml"><mi id="alg1.22.m10.6.6.6.3.1.1.1.1.3.2" xref="alg1.22.m10.6.6.6.3.1.1.1.1.3.2.cmml">g</mi><mo id="alg1.22.m10.6.6.6.3.1.1.1.1.3.3" xref="alg1.22.m10.6.6.6.3.1.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="alg1.22.m10.6.6.6.3.1.1.1.3" xref="alg1.22.m10.6.6.6.3.1.1.1.3.cmml">⁢</mo><mrow id="alg1.22.m10.6.6.6.3.1.1.1.2.1" xref="alg1.22.m10.6.6.6.3.1.1.1.2.1.1.cmml"><mo id="alg1.22.m10.6.6.6.3.1.1.1.2.1.2" stretchy="false" xref="alg1.22.m10.6.6.6.3.1.1.1.2.1.1.cmml">(</mo><msup id="alg1.22.m10.6.6.6.3.1.1.1.2.1.1" xref="alg1.22.m10.6.6.6.3.1.1.1.2.1.1.cmml"><mi id="alg1.22.m10.6.6.6.3.1.1.1.2.1.1.2" xref="alg1.22.m10.6.6.6.3.1.1.1.2.1.1.2.cmml">y</mi><mo id="alg1.22.m10.6.6.6.3.1.1.1.2.1.1.3" xref="alg1.22.m10.6.6.6.3.1.1.1.2.1.1.3.cmml">′</mo></msup><mo id="alg1.22.m10.6.6.6.3.1.1.1.2.1.3" stretchy="false" xref="alg1.22.m10.6.6.6.3.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.22.m10.6.6.6.3.1.1.3" stretchy="false" xref="alg1.22.m10.6.6.6.3.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg1.22.m10.7b"><apply id="alg1.22.m10.7.7.cmml" xref="alg1.22.m10.7.7"><eq id="alg1.22.m10.7.7.2.cmml" xref="alg1.22.m10.7.7.2"></eq><apply id="alg1.22.m10.7.7.1.cmml" xref="alg1.22.m10.7.7.1"><times id="alg1.22.m10.7.7.1.2.cmml" xref="alg1.22.m10.7.7.1.2"></times><apply id="alg1.22.m10.7.7.1.3.cmml" xref="alg1.22.m10.7.7.1.3"><csymbol cd="ambiguous" id="alg1.22.m10.7.7.1.3.1.cmml" xref="alg1.22.m10.7.7.1.3">subscript</csymbol><apply id="alg1.22.m10.7.7.1.3.2.cmml" xref="alg1.22.m10.7.7.1.3.2"><ci id="alg1.22.m10.7.7.1.3.2.1.cmml" xref="alg1.22.m10.7.7.1.3.2.1">~</ci><ci id="alg1.22.m10.7.7.1.3.2.2.cmml" xref="alg1.22.m10.7.7.1.3.2.2">𝑃</ci></apply><ci id="alg1.22.m10.7.7.1.3.3.cmml" xref="alg1.22.m10.7.7.1.3.3">ℎ</ci></apply><apply id="alg1.22.m10.7.7.1.1.1.1.cmml" xref="alg1.22.m10.7.7.1.1.1"><csymbol cd="latexml" id="alg1.22.m10.7.7.1.1.1.1.1.cmml" xref="alg1.22.m10.7.7.1.1.1.1.1">conditional</csymbol><ci id="alg1.22.m10.7.7.1.1.1.1.2.cmml" xref="alg1.22.m10.7.7.1.1.1.1.2">𝑦</ci><apply id="alg1.22.m10.7.7.1.1.1.1.3.cmml" xref="alg1.22.m10.7.7.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.22.m10.7.7.1.1.1.1.3.1.cmml" xref="alg1.22.m10.7.7.1.1.1.1.3">subscript</csymbol><ci id="alg1.22.m10.7.7.1.1.1.1.3.2.cmml" xref="alg1.22.m10.7.7.1.1.1.1.3.2">𝑥</ci><ci id="alg1.22.m10.7.7.1.1.1.1.3.3.cmml" xref="alg1.22.m10.7.7.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><apply id="alg1.22.m10.6.6.cmml" xref="alg1.22.m10.6.6"><divide id="alg1.22.m10.6.6.7.cmml" xref="alg1.22.m10.6.6"></divide><apply id="alg1.22.m10.3.3.3.4.cmml" xref="alg1.22.m10.3.3.3.3"><exp id="alg1.22.m10.2.2.2.2.cmml" xref="alg1.22.m10.2.2.2.2"></exp><apply id="alg1.22.m10.3.3.3.3.1.1.cmml" xref="alg1.22.m10.3.3.3.3.1.1"><times id="alg1.22.m10.3.3.3.3.1.1.2.cmml" xref="alg1.22.m10.3.3.3.3.1.1.2"></times><apply id="alg1.22.m10.3.3.3.3.1.1.1.cmml" xref="alg1.22.m10.3.3.3.3.1.1.1"><compose id="alg1.22.m10.3.3.3.3.1.1.1.2.cmml" xref="alg1.22.m10.3.3.3.3.1.1.1.2"></compose><apply id="alg1.22.m10.3.3.3.3.1.1.1.1.cmml" xref="alg1.22.m10.3.3.3.3.1.1.1.1"><times id="alg1.22.m10.3.3.3.3.1.1.1.1.2.cmml" xref="alg1.22.m10.3.3.3.3.1.1.1.1.2"></times><ci id="alg1.22.m10.3.3.3.3.1.1.1.1.3.cmml" xref="alg1.22.m10.3.3.3.3.1.1.1.1.3">𝛽</ci><ci id="alg1.22.m10.3.3.3.3.1.1.1.1.4.cmml" xref="alg1.22.m10.3.3.3.3.1.1.1.1.4">𝑓</ci><apply id="alg1.22.m10.3.3.3.3.1.1.1.1.1.cmml" xref="alg1.22.m10.3.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.22.m10.3.3.3.3.1.1.1.1.1.2.cmml" xref="alg1.22.m10.3.3.3.3.1.1.1.1.1">superscript</csymbol><apply id="alg1.22.m10.3.3.3.3.1.1.1.1.1.1.1.1.cmml" xref="alg1.22.m10.3.3.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.22.m10.3.3.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.22.m10.3.3.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.22.m10.3.3.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.22.m10.3.3.3.3.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="alg1.22.m10.3.3.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.22.m10.3.3.3.3.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="alg1.22.m10.3.3.3.3.1.1.1.1.1.3.cmml" xref="alg1.22.m10.3.3.3.3.1.1.1.1.1.3">𝑇</ci></apply><ci id="alg1.22.m10.3.3.3.3.1.1.1.1.5.cmml" xref="alg1.22.m10.3.3.3.3.1.1.1.1.5">ℎ</ci></apply><apply id="alg1.22.m10.3.3.3.3.1.1.1.3.cmml" xref="alg1.22.m10.3.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="alg1.22.m10.3.3.3.3.1.1.1.3.1.cmml" xref="alg1.22.m10.3.3.3.3.1.1.1.3">superscript</csymbol><ci id="alg1.22.m10.3.3.3.3.1.1.1.3.2.cmml" xref="alg1.22.m10.3.3.3.3.1.1.1.3.2">𝑔</ci><ci id="alg1.22.m10.3.3.3.3.1.1.1.3.3.cmml" xref="alg1.22.m10.3.3.3.3.1.1.1.3.3">′</ci></apply></apply><ci id="alg1.22.m10.1.1.1.1.cmml" xref="alg1.22.m10.1.1.1.1">𝑦</ci></apply></apply><apply id="alg1.22.m10.6.6.6.cmml" xref="alg1.22.m10.6.6.6"><apply id="alg1.22.m10.6.6.6.4.cmml" xref="alg1.22.m10.6.6.6.4"><csymbol cd="ambiguous" id="alg1.22.m10.6.6.6.4.1.cmml" xref="alg1.22.m10.6.6.6.4">subscript</csymbol><sum id="alg1.22.m10.6.6.6.4.2.cmml" xref="alg1.22.m10.6.6.6.4.2"></sum><apply id="alg1.22.m10.4.4.4.1.1.cmml" xref="alg1.22.m10.4.4.4.1.1"><in id="alg1.22.m10.4.4.4.1.1.2.cmml" xref="alg1.22.m10.4.4.4.1.1.2"></in><apply id="alg1.22.m10.4.4.4.1.1.3.cmml" xref="alg1.22.m10.4.4.4.1.1.3"><csymbol cd="ambiguous" id="alg1.22.m10.4.4.4.1.1.3.1.cmml" xref="alg1.22.m10.4.4.4.1.1.3">superscript</csymbol><ci id="alg1.22.m10.4.4.4.1.1.3.2.cmml" xref="alg1.22.m10.4.4.4.1.1.3.2">𝑦</ci><ci id="alg1.22.m10.4.4.4.1.1.3.3.cmml" xref="alg1.22.m10.4.4.4.1.1.3.3">′</ci></apply><apply id="alg1.22.m10.4.4.4.1.1.4.cmml" xref="alg1.22.m10.4.4.4.1.1.4"><times id="alg1.22.m10.4.4.4.1.1.4.1.cmml" xref="alg1.22.m10.4.4.4.1.1.4.1"></times><apply id="alg1.22.m10.4.4.4.1.1.4.2.cmml" xref="alg1.22.m10.4.4.4.1.1.4.2"><csymbol cd="ambiguous" id="alg1.22.m10.4.4.4.1.1.4.2.1.cmml" xref="alg1.22.m10.4.4.4.1.1.4.2">subscript</csymbol><ci id="alg1.22.m10.4.4.4.1.1.4.2.2.cmml" xref="alg1.22.m10.4.4.4.1.1.4.2.2">𝑆</ci><apply id="alg1.22.m10.4.4.4.1.1.4.2.3.cmml" xref="alg1.22.m10.4.4.4.1.1.4.2.3"><csymbol cd="ambiguous" id="alg1.22.m10.4.4.4.1.1.4.2.3.1.cmml" xref="alg1.22.m10.4.4.4.1.1.4.2.3">subscript</csymbol><ci id="alg1.22.m10.4.4.4.1.1.4.2.3.2.cmml" xref="alg1.22.m10.4.4.4.1.1.4.2.3.2">𝑥</ci><ci id="alg1.22.m10.4.4.4.1.1.4.2.3.3.cmml" xref="alg1.22.m10.4.4.4.1.1.4.2.3.3">𝑖</ci></apply></apply><ci id="alg1.22.m10.4.4.4.1.1.1.cmml" xref="alg1.22.m10.4.4.4.1.1.1">𝒴</ci></apply></apply></apply><apply id="alg1.22.m10.6.6.6.3.2.cmml" xref="alg1.22.m10.6.6.6.3.1"><exp id="alg1.22.m10.5.5.5.2.cmml" xref="alg1.22.m10.5.5.5.2"></exp><apply id="alg1.22.m10.6.6.6.3.1.1.1.cmml" xref="alg1.22.m10.6.6.6.3.1.1.1"><times id="alg1.22.m10.6.6.6.3.1.1.1.3.cmml" xref="alg1.22.m10.6.6.6.3.1.1.1.3"></times><apply id="alg1.22.m10.6.6.6.3.1.1.1.1.cmml" xref="alg1.22.m10.6.6.6.3.1.1.1.1"><compose id="alg1.22.m10.6.6.6.3.1.1.1.1.2.cmml" xref="alg1.22.m10.6.6.6.3.1.1.1.1.2"></compose><apply id="alg1.22.m10.6.6.6.3.1.1.1.1.1.cmml" xref="alg1.22.m10.6.6.6.3.1.1.1.1.1"><times id="alg1.22.m10.6.6.6.3.1.1.1.1.1.2.cmml" xref="alg1.22.m10.6.6.6.3.1.1.1.1.1.2"></times><ci id="alg1.22.m10.6.6.6.3.1.1.1.1.1.3.cmml" xref="alg1.22.m10.6.6.6.3.1.1.1.1.1.3">𝛽</ci><ci id="alg1.22.m10.6.6.6.3.1.1.1.1.1.4.cmml" xref="alg1.22.m10.6.6.6.3.1.1.1.1.1.4">𝑓</ci><apply id="alg1.22.m10.6.6.6.3.1.1.1.1.1.1.cmml" xref="alg1.22.m10.6.6.6.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.22.m10.6.6.6.3.1.1.1.1.1.1.2.cmml" xref="alg1.22.m10.6.6.6.3.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.22.m10.6.6.6.3.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.22.m10.6.6.6.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.22.m10.6.6.6.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.22.m10.6.6.6.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.22.m10.6.6.6.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.22.m10.6.6.6.3.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="alg1.22.m10.6.6.6.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.22.m10.6.6.6.3.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="alg1.22.m10.6.6.6.3.1.1.1.1.1.1.3.cmml" xref="alg1.22.m10.6.6.6.3.1.1.1.1.1.1.3">𝑇</ci></apply><ci id="alg1.22.m10.6.6.6.3.1.1.1.1.1.5.cmml" xref="alg1.22.m10.6.6.6.3.1.1.1.1.1.5">ℎ</ci></apply><apply id="alg1.22.m10.6.6.6.3.1.1.1.1.3.cmml" xref="alg1.22.m10.6.6.6.3.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.22.m10.6.6.6.3.1.1.1.1.3.1.cmml" xref="alg1.22.m10.6.6.6.3.1.1.1.1.3">superscript</csymbol><ci id="alg1.22.m10.6.6.6.3.1.1.1.1.3.2.cmml" xref="alg1.22.m10.6.6.6.3.1.1.1.1.3.2">𝑔</ci><ci id="alg1.22.m10.6.6.6.3.1.1.1.1.3.3.cmml" xref="alg1.22.m10.6.6.6.3.1.1.1.1.3.3">′</ci></apply></apply><apply id="alg1.22.m10.6.6.6.3.1.1.1.2.1.1.cmml" xref="alg1.22.m10.6.6.6.3.1.1.1.2.1"><csymbol cd="ambiguous" id="alg1.22.m10.6.6.6.3.1.1.1.2.1.1.1.cmml" xref="alg1.22.m10.6.6.6.3.1.1.1.2.1">superscript</csymbol><ci id="alg1.22.m10.6.6.6.3.1.1.1.2.1.1.2.cmml" xref="alg1.22.m10.6.6.6.3.1.1.1.2.1.1.2">𝑦</ci><ci id="alg1.22.m10.6.6.6.3.1.1.1.2.1.1.3.cmml" xref="alg1.22.m10.6.6.6.3.1.1.1.2.1.1.3">′</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.22.m10.7c">{\tilde{P}_{h}(y|x_{i})=\frac{\exp(\beta f(x_{i})^{T}h\circ g^{\prime}(y))}{%
\sum_{y^{\prime}\in S_{x_{i}}(\mathcal{Y})}\exp(\beta f(x_{i})^{T}h\circ g^{%
\prime}(y^{\prime}))}}</annotation><annotation encoding="application/x-llamapun" id="alg1.22.m10.7d">over~ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ( italic_y | italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = divide start_ARG roman_exp ( italic_β italic_f ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_h ∘ italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y ) ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ italic_S start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( caligraphic_Y ) end_POSTSUBSCRIPT roman_exp ( italic_β italic_f ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_h ∘ italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ) end_ARG</annotation></semantics></math>
<br class="ltx_break"/>Define <math alttext="P^{\star}" class="ltx_Math" display="inline" id="alg1.23.m11.1"><semantics id="alg1.23.m11.1a"><msup id="alg1.23.m11.1.1" xref="alg1.23.m11.1.1.cmml"><mi id="alg1.23.m11.1.1.2" xref="alg1.23.m11.1.1.2.cmml">P</mi><mo id="alg1.23.m11.1.1.3" xref="alg1.23.m11.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="alg1.23.m11.1b"><apply id="alg1.23.m11.1.1.cmml" xref="alg1.23.m11.1.1"><csymbol cd="ambiguous" id="alg1.23.m11.1.1.1.cmml" xref="alg1.23.m11.1.1">superscript</csymbol><ci id="alg1.23.m11.1.1.2.cmml" xref="alg1.23.m11.1.1.2">𝑃</ci><ci id="alg1.23.m11.1.1.3.cmml" xref="alg1.23.m11.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.23.m11.1c">P^{\star}</annotation><annotation encoding="application/x-llamapun" id="alg1.23.m11.1d">italic_P start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math> to be a one-hot vector for <math alttext="y_{i}" class="ltx_Math" display="inline" id="alg1.24.m12.1"><semantics id="alg1.24.m12.1a"><msub id="alg1.24.m12.1.1" xref="alg1.24.m12.1.1.cmml"><mi id="alg1.24.m12.1.1.2" xref="alg1.24.m12.1.1.2.cmml">y</mi><mi id="alg1.24.m12.1.1.3" xref="alg1.24.m12.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.24.m12.1b"><apply id="alg1.24.m12.1.1.cmml" xref="alg1.24.m12.1.1"><csymbol cd="ambiguous" id="alg1.24.m12.1.1.1.cmml" xref="alg1.24.m12.1.1">subscript</csymbol><ci id="alg1.24.m12.1.1.2.cmml" xref="alg1.24.m12.1.1.2">𝑦</ci><ci id="alg1.24.m12.1.1.3.cmml" xref="alg1.24.m12.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.24.m12.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.24.m12.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. 
<br class="ltx_break"/>Compute task loss <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="alg1.25.m13.1"><semantics id="alg1.25.m13.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.25.m13.1.1" xref="alg1.25.m13.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="alg1.25.m13.1b"><ci id="alg1.25.m13.1.1.cmml" xref="alg1.25.m13.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.25.m13.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="alg1.25.m13.1d">caligraphic_L</annotation></semantics></math> using <math alttext="\tilde{P}" class="ltx_Math" display="inline" id="alg1.26.m14.1"><semantics id="alg1.26.m14.1a"><mover accent="true" id="alg1.26.m14.1.1" xref="alg1.26.m14.1.1.cmml"><mi id="alg1.26.m14.1.1.2" xref="alg1.26.m14.1.1.2.cmml">P</mi><mo id="alg1.26.m14.1.1.1" xref="alg1.26.m14.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="alg1.26.m14.1b"><apply id="alg1.26.m14.1.1.cmml" xref="alg1.26.m14.1.1"><ci id="alg1.26.m14.1.1.1.cmml" xref="alg1.26.m14.1.1.1">~</ci><ci id="alg1.26.m14.1.1.2.cmml" xref="alg1.26.m14.1.1.2">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.26.m14.1c">\tilde{P}</annotation><annotation encoding="application/x-llamapun" id="alg1.26.m14.1d">over~ start_ARG italic_P end_ARG</annotation></semantics></math> and <math alttext="P^{\star}" class="ltx_Math" display="inline" id="alg1.27.m15.1"><semantics id="alg1.27.m15.1a"><msup id="alg1.27.m15.1.1" xref="alg1.27.m15.1.1.cmml"><mi id="alg1.27.m15.1.1.2" xref="alg1.27.m15.1.1.2.cmml">P</mi><mo id="alg1.27.m15.1.1.3" xref="alg1.27.m15.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="alg1.27.m15.1b"><apply id="alg1.27.m15.1.1.cmml" xref="alg1.27.m15.1.1"><csymbol cd="ambiguous" id="alg1.27.m15.1.1.1.cmml" xref="alg1.27.m15.1.1">superscript</csymbol><ci id="alg1.27.m15.1.1.2.cmml" xref="alg1.27.m15.1.1.2">𝑃</ci><ci id="alg1.27.m15.1.1.3.cmml" xref="alg1.27.m15.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.27.m15.1c">P^{\star}</annotation><annotation encoding="application/x-llamapun" id="alg1.27.m15.1d">italic_P start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math>
<br class="ltx_break"/>Compute correction loss <math alttext="\mathcal{\ell}" class="ltx_Math" display="inline" id="alg1.28.m16.1"><semantics id="alg1.28.m16.1a"><mi id="alg1.28.m16.1.1" mathvariant="normal" xref="alg1.28.m16.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="alg1.28.m16.1b"><ci id="alg1.28.m16.1.1.cmml" xref="alg1.28.m16.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.28.m16.1c">\mathcal{\ell}</annotation><annotation encoding="application/x-llamapun" id="alg1.28.m16.1d">roman_ℓ</annotation></semantics></math> using <math alttext="\tilde{P}" class="ltx_Math" display="inline" id="alg1.29.m17.1"><semantics id="alg1.29.m17.1a"><mover accent="true" id="alg1.29.m17.1.1" xref="alg1.29.m17.1.1.cmml"><mi id="alg1.29.m17.1.1.2" xref="alg1.29.m17.1.1.2.cmml">P</mi><mo id="alg1.29.m17.1.1.1" xref="alg1.29.m17.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="alg1.29.m17.1b"><apply id="alg1.29.m17.1.1.cmml" xref="alg1.29.m17.1.1"><ci id="alg1.29.m17.1.1.1.cmml" xref="alg1.29.m17.1.1.1">~</ci><ci id="alg1.29.m17.1.1.2.cmml" xref="alg1.29.m17.1.1.2">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.29.m17.1c">\tilde{P}</annotation><annotation encoding="application/x-llamapun" id="alg1.29.m17.1d">over~ start_ARG italic_P end_ARG</annotation></semantics></math> and <math alttext="\tilde{P}_{h}" class="ltx_Math" display="inline" id="alg1.30.m18.1"><semantics id="alg1.30.m18.1a"><msub id="alg1.30.m18.1.1" xref="alg1.30.m18.1.1.cmml"><mover accent="true" id="alg1.30.m18.1.1.2" xref="alg1.30.m18.1.1.2.cmml"><mi id="alg1.30.m18.1.1.2.2" xref="alg1.30.m18.1.1.2.2.cmml">P</mi><mo id="alg1.30.m18.1.1.2.1" xref="alg1.30.m18.1.1.2.1.cmml">~</mo></mover><mi id="alg1.30.m18.1.1.3" xref="alg1.30.m18.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.30.m18.1b"><apply id="alg1.30.m18.1.1.cmml" xref="alg1.30.m18.1.1"><csymbol cd="ambiguous" id="alg1.30.m18.1.1.1.cmml" xref="alg1.30.m18.1.1">subscript</csymbol><apply id="alg1.30.m18.1.1.2.cmml" xref="alg1.30.m18.1.1.2"><ci id="alg1.30.m18.1.1.2.1.cmml" xref="alg1.30.m18.1.1.2.1">~</ci><ci id="alg1.30.m18.1.1.2.2.cmml" xref="alg1.30.m18.1.1.2.2">𝑃</ci></apply><ci id="alg1.30.m18.1.1.3.cmml" xref="alg1.30.m18.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.30.m18.1c">\tilde{P}_{h}</annotation><annotation encoding="application/x-llamapun" id="alg1.30.m18.1d">over~ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math>
<br class="ltx_break"/>Update dual-encoder parameters <math alttext="\Theta\leftarrow\Theta-\eta\nabla_{\Theta}\mathcal{L}" class="ltx_Math" display="inline" id="alg1.31.m19.1"><semantics id="alg1.31.m19.1a"><mrow id="alg1.31.m19.1.1" xref="alg1.31.m19.1.1.cmml"><mi id="alg1.31.m19.1.1.2" mathvariant="normal" xref="alg1.31.m19.1.1.2.cmml">Θ</mi><mo id="alg1.31.m19.1.1.1" stretchy="false" xref="alg1.31.m19.1.1.1.cmml">←</mo><mrow id="alg1.31.m19.1.1.3" xref="alg1.31.m19.1.1.3.cmml"><mi id="alg1.31.m19.1.1.3.2" mathvariant="normal" xref="alg1.31.m19.1.1.3.2.cmml">Θ</mi><mo id="alg1.31.m19.1.1.3.1" xref="alg1.31.m19.1.1.3.1.cmml">−</mo><mrow id="alg1.31.m19.1.1.3.3" xref="alg1.31.m19.1.1.3.3.cmml"><mi id="alg1.31.m19.1.1.3.3.2" xref="alg1.31.m19.1.1.3.3.2.cmml">η</mi><mo id="alg1.31.m19.1.1.3.3.1" lspace="0.167em" xref="alg1.31.m19.1.1.3.3.1.cmml">⁢</mo><mrow id="alg1.31.m19.1.1.3.3.3" xref="alg1.31.m19.1.1.3.3.3.cmml"><msub id="alg1.31.m19.1.1.3.3.3.1" xref="alg1.31.m19.1.1.3.3.3.1.cmml"><mo id="alg1.31.m19.1.1.3.3.3.1.2" rspace="0.167em" xref="alg1.31.m19.1.1.3.3.3.1.2.cmml">∇</mo><mi id="alg1.31.m19.1.1.3.3.3.1.3" mathvariant="normal" xref="alg1.31.m19.1.1.3.3.3.1.3.cmml">Θ</mi></msub><mi class="ltx_font_mathcaligraphic" id="alg1.31.m19.1.1.3.3.3.2" xref="alg1.31.m19.1.1.3.3.3.2.cmml">ℒ</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.31.m19.1b"><apply id="alg1.31.m19.1.1.cmml" xref="alg1.31.m19.1.1"><ci id="alg1.31.m19.1.1.1.cmml" xref="alg1.31.m19.1.1.1">←</ci><ci id="alg1.31.m19.1.1.2.cmml" xref="alg1.31.m19.1.1.2">Θ</ci><apply id="alg1.31.m19.1.1.3.cmml" xref="alg1.31.m19.1.1.3"><minus id="alg1.31.m19.1.1.3.1.cmml" xref="alg1.31.m19.1.1.3.1"></minus><ci id="alg1.31.m19.1.1.3.2.cmml" xref="alg1.31.m19.1.1.3.2">Θ</ci><apply id="alg1.31.m19.1.1.3.3.cmml" xref="alg1.31.m19.1.1.3.3"><times id="alg1.31.m19.1.1.3.3.1.cmml" xref="alg1.31.m19.1.1.3.3.1"></times><ci id="alg1.31.m19.1.1.3.3.2.cmml" xref="alg1.31.m19.1.1.3.3.2">𝜂</ci><apply id="alg1.31.m19.1.1.3.3.3.cmml" xref="alg1.31.m19.1.1.3.3.3"><apply id="alg1.31.m19.1.1.3.3.3.1.cmml" xref="alg1.31.m19.1.1.3.3.3.1"><csymbol cd="ambiguous" id="alg1.31.m19.1.1.3.3.3.1.1.cmml" xref="alg1.31.m19.1.1.3.3.3.1">subscript</csymbol><ci id="alg1.31.m19.1.1.3.3.3.1.2.cmml" xref="alg1.31.m19.1.1.3.3.3.1.2">∇</ci><ci id="alg1.31.m19.1.1.3.3.3.1.3.cmml" xref="alg1.31.m19.1.1.3.3.3.1.3">Θ</ci></apply><ci id="alg1.31.m19.1.1.3.3.3.2.cmml" xref="alg1.31.m19.1.1.3.3.3.2">ℒ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.31.m19.1c">\Theta\leftarrow\Theta-\eta\nabla_{\Theta}\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="alg1.31.m19.1d">roman_Θ ← roman_Θ - italic_η ∇ start_POSTSUBSCRIPT roman_Θ end_POSTSUBSCRIPT caligraphic_L</annotation></semantics></math>
<br class="ltx_break"/>Update corrector network parameters <math alttext="\Psi\leftarrow\Psi-\eta\nabla_{\Psi}\ell" class="ltx_Math" display="inline" id="alg1.32.m20.1"><semantics id="alg1.32.m20.1a"><mrow id="alg1.32.m20.1.1" xref="alg1.32.m20.1.1.cmml"><mi id="alg1.32.m20.1.1.2" mathvariant="normal" xref="alg1.32.m20.1.1.2.cmml">Ψ</mi><mo id="alg1.32.m20.1.1.1" stretchy="false" xref="alg1.32.m20.1.1.1.cmml">←</mo><mrow id="alg1.32.m20.1.1.3" xref="alg1.32.m20.1.1.3.cmml"><mi id="alg1.32.m20.1.1.3.2" mathvariant="normal" xref="alg1.32.m20.1.1.3.2.cmml">Ψ</mi><mo id="alg1.32.m20.1.1.3.1" xref="alg1.32.m20.1.1.3.1.cmml">−</mo><mrow id="alg1.32.m20.1.1.3.3" xref="alg1.32.m20.1.1.3.3.cmml"><mi id="alg1.32.m20.1.1.3.3.2" xref="alg1.32.m20.1.1.3.3.2.cmml">η</mi><mo id="alg1.32.m20.1.1.3.3.1" lspace="0.167em" xref="alg1.32.m20.1.1.3.3.1.cmml">⁢</mo><mrow id="alg1.32.m20.1.1.3.3.3" xref="alg1.32.m20.1.1.3.3.3.cmml"><msub id="alg1.32.m20.1.1.3.3.3.1" xref="alg1.32.m20.1.1.3.3.3.1.cmml"><mo id="alg1.32.m20.1.1.3.3.3.1.2" rspace="0.167em" xref="alg1.32.m20.1.1.3.3.3.1.2.cmml">∇</mo><mi id="alg1.32.m20.1.1.3.3.3.1.3" mathvariant="normal" xref="alg1.32.m20.1.1.3.3.3.1.3.cmml">Ψ</mi></msub><mi id="alg1.32.m20.1.1.3.3.3.2" mathvariant="normal" xref="alg1.32.m20.1.1.3.3.3.2.cmml">ℓ</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.32.m20.1b"><apply id="alg1.32.m20.1.1.cmml" xref="alg1.32.m20.1.1"><ci id="alg1.32.m20.1.1.1.cmml" xref="alg1.32.m20.1.1.1">←</ci><ci id="alg1.32.m20.1.1.2.cmml" xref="alg1.32.m20.1.1.2">Ψ</ci><apply id="alg1.32.m20.1.1.3.cmml" xref="alg1.32.m20.1.1.3"><minus id="alg1.32.m20.1.1.3.1.cmml" xref="alg1.32.m20.1.1.3.1"></minus><ci id="alg1.32.m20.1.1.3.2.cmml" xref="alg1.32.m20.1.1.3.2">Ψ</ci><apply id="alg1.32.m20.1.1.3.3.cmml" xref="alg1.32.m20.1.1.3.3"><times id="alg1.32.m20.1.1.3.3.1.cmml" xref="alg1.32.m20.1.1.3.3.1"></times><ci id="alg1.32.m20.1.1.3.3.2.cmml" xref="alg1.32.m20.1.1.3.3.2">𝜂</ci><apply id="alg1.32.m20.1.1.3.3.3.cmml" xref="alg1.32.m20.1.1.3.3.3"><apply id="alg1.32.m20.1.1.3.3.3.1.cmml" xref="alg1.32.m20.1.1.3.3.3.1"><csymbol cd="ambiguous" id="alg1.32.m20.1.1.3.3.3.1.1.cmml" xref="alg1.32.m20.1.1.3.3.3.1">subscript</csymbol><ci id="alg1.32.m20.1.1.3.3.3.1.2.cmml" xref="alg1.32.m20.1.1.3.3.3.1.2">∇</ci><ci id="alg1.32.m20.1.1.3.3.3.1.3.cmml" xref="alg1.32.m20.1.1.3.3.3.1.3">Ψ</ci></apply><ci id="alg1.32.m20.1.1.3.3.3.2.cmml" xref="alg1.32.m20.1.1.3.3.3.2">ℓ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.32.m20.1c">\Psi\leftarrow\Psi-\eta\nabla_{\Psi}\ell</annotation><annotation encoding="application/x-llamapun" id="alg1.32.m20.1d">roman_Ψ ← roman_Ψ - italic_η ∇ start_POSTSUBSCRIPT roman_Ψ end_POSTSUBSCRIPT roman_ℓ</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.36.1"> end while
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_listingline ltx_figure_panel" id="alg1.37">
</div>
</div>
</div>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Latent Variables in Retrieval Augmented Models</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.8">Retrieval augmented language models (RLMs) typically consist of two major architectural components, a <em class="ltx_emph ltx_font_italic" id="S3.SS1.p1.8.1">retriever</em> model (e.g., a dual-encoder) and a generative language model or <em class="ltx_emph ltx_font_italic" id="S3.SS1.p1.8.2">reader</em> model
<cite class="ltx_cite ltx_citemacro_citep">(Guu et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib11" title="">2020</a>; Izacard &amp; Grave, <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib14" title="">2021</a>; Izacard et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib15" title="">2022</a>)</cite>.
The input to a retrieval augmented language model is a natural language text sequence, <math alttext="x" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_x</annotation></semantics></math>.
This input text will be encoded using a dual-encoder retrieval model, <math alttext="f(x)" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mrow id="S3.SS1.p1.2.m2.1.2" xref="S3.SS1.p1.2.m2.1.2.cmml"><mi id="S3.SS1.p1.2.m2.1.2.2" xref="S3.SS1.p1.2.m2.1.2.2.cmml">f</mi><mo id="S3.SS1.p1.2.m2.1.2.1" xref="S3.SS1.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p1.2.m2.1.2.3.2" xref="S3.SS1.p1.2.m2.1.2.cmml"><mo id="S3.SS1.p1.2.m2.1.2.3.2.1" stretchy="false" xref="S3.SS1.p1.2.m2.1.2.cmml">(</mo><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">x</mi><mo id="S3.SS1.p1.2.m2.1.2.3.2.2" stretchy="false" xref="S3.SS1.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.2.cmml" xref="S3.SS1.p1.2.m2.1.2"><times id="S3.SS1.p1.2.m2.1.2.1.cmml" xref="S3.SS1.p1.2.m2.1.2.1"></times><ci id="S3.SS1.p1.2.m2.1.2.2.cmml" xref="S3.SS1.p1.2.m2.1.2.2">𝑓</ci><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">f(x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_f ( italic_x )</annotation></semantics></math>. Retrieval will be performed over a corpus of targets, <math alttext="\mathcal{Y}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">caligraphic_Y</annotation></semantics></math>, returning <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_k</annotation></semantics></math> targets relevant to <math alttext="x" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_x</annotation></semantics></math>, denoted <math alttext="S_{x}(\mathcal{Y})" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><mrow id="S3.SS1.p1.6.m6.1.2" xref="S3.SS1.p1.6.m6.1.2.cmml"><msub id="S3.SS1.p1.6.m6.1.2.2" xref="S3.SS1.p1.6.m6.1.2.2.cmml"><mi id="S3.SS1.p1.6.m6.1.2.2.2" xref="S3.SS1.p1.6.m6.1.2.2.2.cmml">S</mi><mi id="S3.SS1.p1.6.m6.1.2.2.3" xref="S3.SS1.p1.6.m6.1.2.2.3.cmml">x</mi></msub><mo id="S3.SS1.p1.6.m6.1.2.1" xref="S3.SS1.p1.6.m6.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p1.6.m6.1.2.3.2" xref="S3.SS1.p1.6.m6.1.2.cmml"><mo id="S3.SS1.p1.6.m6.1.2.3.2.1" stretchy="false" xref="S3.SS1.p1.6.m6.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">𝒴</mi><mo id="S3.SS1.p1.6.m6.1.2.3.2.2" stretchy="false" xref="S3.SS1.p1.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.2.cmml" xref="S3.SS1.p1.6.m6.1.2"><times id="S3.SS1.p1.6.m6.1.2.1.cmml" xref="S3.SS1.p1.6.m6.1.2.1"></times><apply id="S3.SS1.p1.6.m6.1.2.2.cmml" xref="S3.SS1.p1.6.m6.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.2.2.1.cmml" xref="S3.SS1.p1.6.m6.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.2.2.2.cmml" xref="S3.SS1.p1.6.m6.1.2.2.2">𝑆</ci><ci id="S3.SS1.p1.6.m6.1.2.2.3.cmml" xref="S3.SS1.p1.6.m6.1.2.2.3">𝑥</ci></apply><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">S_{x}(\mathcal{Y})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_S start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT ( caligraphic_Y )</annotation></semantics></math>. The reader model takes as input the retrieved targets, <math alttext="S_{x}(\mathcal{Y})" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><mrow id="S3.SS1.p1.7.m7.1.2" xref="S3.SS1.p1.7.m7.1.2.cmml"><msub id="S3.SS1.p1.7.m7.1.2.2" xref="S3.SS1.p1.7.m7.1.2.2.cmml"><mi id="S3.SS1.p1.7.m7.1.2.2.2" xref="S3.SS1.p1.7.m7.1.2.2.2.cmml">S</mi><mi id="S3.SS1.p1.7.m7.1.2.2.3" xref="S3.SS1.p1.7.m7.1.2.2.3.cmml">x</mi></msub><mo id="S3.SS1.p1.7.m7.1.2.1" xref="S3.SS1.p1.7.m7.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p1.7.m7.1.2.3.2" xref="S3.SS1.p1.7.m7.1.2.cmml"><mo id="S3.SS1.p1.7.m7.1.2.3.2.1" stretchy="false" xref="S3.SS1.p1.7.m7.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">𝒴</mi><mo id="S3.SS1.p1.7.m7.1.2.3.2.2" stretchy="false" xref="S3.SS1.p1.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.2.cmml" xref="S3.SS1.p1.7.m7.1.2"><times id="S3.SS1.p1.7.m7.1.2.1.cmml" xref="S3.SS1.p1.7.m7.1.2.1"></times><apply id="S3.SS1.p1.7.m7.1.2.2.cmml" xref="S3.SS1.p1.7.m7.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.2.2.1.cmml" xref="S3.SS1.p1.7.m7.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.7.m7.1.2.2.2.cmml" xref="S3.SS1.p1.7.m7.1.2.2.2">𝑆</ci><ci id="S3.SS1.p1.7.m7.1.2.2.3.cmml" xref="S3.SS1.p1.7.m7.1.2.2.3">𝑥</ci></apply><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">S_{x}(\mathcal{Y})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">italic_S start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT ( caligraphic_Y )</annotation></semantics></math>, and the text <math alttext="x" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">italic_x</annotation></semantics></math>, and generates text.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.2">Concretely, in our experiments, the input text <math alttext="x" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_x</annotation></semantics></math> is a question. The retrieval corpus contains targets <math alttext="y" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_y</annotation></semantics></math> corresponding to passages in Wikipedia. The reader model takes as input the question and retrieved passages and generates a short answer to the question. We present the remainder of the section with this question-answering task in mind.</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.1">RLMs can be formalized as latent variable models. The softmax function is used to parameterize the distribution over a discrete latent variable, which corresponds to
the retrieved targets. We use <math alttext="a" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">a</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">italic_a</annotation></semantics></math> to refer to the generated sequence of text, i.e., the generated answer:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\vspace{-1mm}P(a|x)=\sum_{y\in S_{x}(\mathcal{Y})}P(a|y,x)P(y|x).\vspace{-1mm}" class="ltx_Math" display="block" id="S3.E7.m1.4"><semantics id="S3.E7.m1.4a"><mrow id="S3.E7.m1.4.4.1" xref="S3.E7.m1.4.4.1.1.cmml"><mrow id="S3.E7.m1.4.4.1.1" xref="S3.E7.m1.4.4.1.1.cmml"><mrow id="S3.E7.m1.4.4.1.1.1" xref="S3.E7.m1.4.4.1.1.1.cmml"><mi id="S3.E7.m1.4.4.1.1.1.3" xref="S3.E7.m1.4.4.1.1.1.3.cmml">P</mi><mo id="S3.E7.m1.4.4.1.1.1.2" xref="S3.E7.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.4.4.1.1.1.1.1" xref="S3.E7.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S3.E7.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="S3.E7.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.4.4.1.1.1.1.1.1" xref="S3.E7.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.4.4.1.1.1.1.1.1.2" xref="S3.E7.m1.4.4.1.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E7.m1.4.4.1.1.1.1.1.1.1" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E7.m1.4.4.1.1.1.1.1.1.3" xref="S3.E7.m1.4.4.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E7.m1.4.4.1.1.1.1.1.3" stretchy="false" xref="S3.E7.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.4.4.1.1.4" rspace="0.111em" xref="S3.E7.m1.4.4.1.1.4.cmml">=</mo><mrow id="S3.E7.m1.4.4.1.1.3" xref="S3.E7.m1.4.4.1.1.3.cmml"><munder id="S3.E7.m1.4.4.1.1.3.3" xref="S3.E7.m1.4.4.1.1.3.3.cmml"><mo id="S3.E7.m1.4.4.1.1.3.3.2" movablelimits="false" xref="S3.E7.m1.4.4.1.1.3.3.2.cmml">∑</mo><mrow id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.3" xref="S3.E7.m1.1.1.1.3.cmml">y</mi><mo id="S3.E7.m1.1.1.1.2" xref="S3.E7.m1.1.1.1.2.cmml">∈</mo><mrow id="S3.E7.m1.1.1.1.4" xref="S3.E7.m1.1.1.1.4.cmml"><msub id="S3.E7.m1.1.1.1.4.2" xref="S3.E7.m1.1.1.1.4.2.cmml"><mi id="S3.E7.m1.1.1.1.4.2.2" xref="S3.E7.m1.1.1.1.4.2.2.cmml">S</mi><mi id="S3.E7.m1.1.1.1.4.2.3" xref="S3.E7.m1.1.1.1.4.2.3.cmml">x</mi></msub><mo id="S3.E7.m1.1.1.1.4.1" xref="S3.E7.m1.1.1.1.4.1.cmml">⁢</mo><mrow id="S3.E7.m1.1.1.1.4.3.2" xref="S3.E7.m1.1.1.1.4.cmml"><mo id="S3.E7.m1.1.1.1.4.3.2.1" stretchy="false" xref="S3.E7.m1.1.1.1.4.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml">𝒴</mi><mo id="S3.E7.m1.1.1.1.4.3.2.2" stretchy="false" xref="S3.E7.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></munder><mrow id="S3.E7.m1.4.4.1.1.3.2" xref="S3.E7.m1.4.4.1.1.3.2.cmml"><mi id="S3.E7.m1.4.4.1.1.3.2.4" xref="S3.E7.m1.4.4.1.1.3.2.4.cmml">P</mi><mo id="S3.E7.m1.4.4.1.1.3.2.3" xref="S3.E7.m1.4.4.1.1.3.2.3.cmml">⁢</mo><mrow id="S3.E7.m1.4.4.1.1.2.1.1.1" xref="S3.E7.m1.4.4.1.1.2.1.1.1.1.cmml"><mo id="S3.E7.m1.4.4.1.1.2.1.1.1.2" stretchy="false" xref="S3.E7.m1.4.4.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.4.4.1.1.2.1.1.1.1" xref="S3.E7.m1.4.4.1.1.2.1.1.1.1.cmml"><mi id="S3.E7.m1.4.4.1.1.2.1.1.1.1.2" xref="S3.E7.m1.4.4.1.1.2.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.E7.m1.4.4.1.1.2.1.1.1.1.1" xref="S3.E7.m1.4.4.1.1.2.1.1.1.1.1.cmml">|</mo><mrow id="S3.E7.m1.4.4.1.1.2.1.1.1.1.3.2" xref="S3.E7.m1.4.4.1.1.2.1.1.1.1.3.1.cmml"><mi id="S3.E7.m1.2.2" xref="S3.E7.m1.2.2.cmml">y</mi><mo id="S3.E7.m1.4.4.1.1.2.1.1.1.1.3.2.1" xref="S3.E7.m1.4.4.1.1.2.1.1.1.1.3.1.cmml">,</mo><mi id="S3.E7.m1.3.3" xref="S3.E7.m1.3.3.cmml">x</mi></mrow></mrow><mo id="S3.E7.m1.4.4.1.1.2.1.1.1.3" stretchy="false" xref="S3.E7.m1.4.4.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E7.m1.4.4.1.1.3.2.3a" xref="S3.E7.m1.4.4.1.1.3.2.3.cmml">⁢</mo><mi id="S3.E7.m1.4.4.1.1.3.2.5" xref="S3.E7.m1.4.4.1.1.3.2.5.cmml">P</mi><mo id="S3.E7.m1.4.4.1.1.3.2.3b" xref="S3.E7.m1.4.4.1.1.3.2.3.cmml">⁢</mo><mrow id="S3.E7.m1.4.4.1.1.3.2.2.1" xref="S3.E7.m1.4.4.1.1.3.2.2.1.1.cmml"><mo id="S3.E7.m1.4.4.1.1.3.2.2.1.2" stretchy="false" xref="S3.E7.m1.4.4.1.1.3.2.2.1.1.cmml">(</mo><mrow id="S3.E7.m1.4.4.1.1.3.2.2.1.1" xref="S3.E7.m1.4.4.1.1.3.2.2.1.1.cmml"><mi id="S3.E7.m1.4.4.1.1.3.2.2.1.1.2" xref="S3.E7.m1.4.4.1.1.3.2.2.1.1.2.cmml">y</mi><mo fence="false" id="S3.E7.m1.4.4.1.1.3.2.2.1.1.1" xref="S3.E7.m1.4.4.1.1.3.2.2.1.1.1.cmml">|</mo><mi id="S3.E7.m1.4.4.1.1.3.2.2.1.1.3" xref="S3.E7.m1.4.4.1.1.3.2.2.1.1.3.cmml">x</mi></mrow><mo id="S3.E7.m1.4.4.1.1.3.2.2.1.3" stretchy="false" xref="S3.E7.m1.4.4.1.1.3.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E7.m1.4.4.1.2" lspace="0em" xref="S3.E7.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.4b"><apply id="S3.E7.m1.4.4.1.1.cmml" xref="S3.E7.m1.4.4.1"><eq id="S3.E7.m1.4.4.1.1.4.cmml" xref="S3.E7.m1.4.4.1.1.4"></eq><apply id="S3.E7.m1.4.4.1.1.1.cmml" xref="S3.E7.m1.4.4.1.1.1"><times id="S3.E7.m1.4.4.1.1.1.2.cmml" xref="S3.E7.m1.4.4.1.1.1.2"></times><ci id="S3.E7.m1.4.4.1.1.1.3.cmml" xref="S3.E7.m1.4.4.1.1.1.3">𝑃</ci><apply id="S3.E7.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E7.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.1.2">𝑎</ci><ci id="S3.E7.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.E7.m1.4.4.1.1.3.cmml" xref="S3.E7.m1.4.4.1.1.3"><apply id="S3.E7.m1.4.4.1.1.3.3.cmml" xref="S3.E7.m1.4.4.1.1.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.1.1.3.3.1.cmml" xref="S3.E7.m1.4.4.1.1.3.3">subscript</csymbol><sum id="S3.E7.m1.4.4.1.1.3.3.2.cmml" xref="S3.E7.m1.4.4.1.1.3.3.2"></sum><apply id="S3.E7.m1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"><in id="S3.E7.m1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.2"></in><ci id="S3.E7.m1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.3">𝑦</ci><apply id="S3.E7.m1.1.1.1.4.cmml" xref="S3.E7.m1.1.1.1.4"><times id="S3.E7.m1.1.1.1.4.1.cmml" xref="S3.E7.m1.1.1.1.4.1"></times><apply id="S3.E7.m1.1.1.1.4.2.cmml" xref="S3.E7.m1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.4.2.1.cmml" xref="S3.E7.m1.1.1.1.4.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.4.2.2.cmml" xref="S3.E7.m1.1.1.1.4.2.2">𝑆</ci><ci id="S3.E7.m1.1.1.1.4.2.3.cmml" xref="S3.E7.m1.1.1.1.4.2.3">𝑥</ci></apply><ci id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1">𝒴</ci></apply></apply></apply><apply id="S3.E7.m1.4.4.1.1.3.2.cmml" xref="S3.E7.m1.4.4.1.1.3.2"><times id="S3.E7.m1.4.4.1.1.3.2.3.cmml" xref="S3.E7.m1.4.4.1.1.3.2.3"></times><ci id="S3.E7.m1.4.4.1.1.3.2.4.cmml" xref="S3.E7.m1.4.4.1.1.3.2.4">𝑃</ci><apply id="S3.E7.m1.4.4.1.1.2.1.1.1.1.cmml" xref="S3.E7.m1.4.4.1.1.2.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.4.4.1.1.2.1.1.1.1.1.cmml" xref="S3.E7.m1.4.4.1.1.2.1.1.1.1.1">conditional</csymbol><ci id="S3.E7.m1.4.4.1.1.2.1.1.1.1.2.cmml" xref="S3.E7.m1.4.4.1.1.2.1.1.1.1.2">𝑎</ci><list id="S3.E7.m1.4.4.1.1.2.1.1.1.1.3.1.cmml" xref="S3.E7.m1.4.4.1.1.2.1.1.1.1.3.2"><ci id="S3.E7.m1.2.2.cmml" xref="S3.E7.m1.2.2">𝑦</ci><ci id="S3.E7.m1.3.3.cmml" xref="S3.E7.m1.3.3">𝑥</ci></list></apply><ci id="S3.E7.m1.4.4.1.1.3.2.5.cmml" xref="S3.E7.m1.4.4.1.1.3.2.5">𝑃</ci><apply id="S3.E7.m1.4.4.1.1.3.2.2.1.1.cmml" xref="S3.E7.m1.4.4.1.1.3.2.2.1"><csymbol cd="latexml" id="S3.E7.m1.4.4.1.1.3.2.2.1.1.1.cmml" xref="S3.E7.m1.4.4.1.1.3.2.2.1.1.1">conditional</csymbol><ci id="S3.E7.m1.4.4.1.1.3.2.2.1.1.2.cmml" xref="S3.E7.m1.4.4.1.1.3.2.2.1.1.2">𝑦</ci><ci id="S3.E7.m1.4.4.1.1.3.2.2.1.1.3.cmml" xref="S3.E7.m1.4.4.1.1.3.2.2.1.1.3">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.4c">\vspace{-1mm}P(a|x)=\sum_{y\in S_{x}(\mathcal{Y})}P(a|y,x)P(y|x).\vspace{-1mm}</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.4d">italic_P ( italic_a | italic_x ) = ∑ start_POSTSUBSCRIPT italic_y ∈ italic_S start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT ( caligraphic_Y ) end_POSTSUBSCRIPT italic_P ( italic_a | italic_y , italic_x ) italic_P ( italic_y | italic_x ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p3.5"><math alttext="P(a|y,x)" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m1.3"><semantics id="S3.SS1.p3.2.m1.3a"><mrow id="S3.SS1.p3.2.m1.3.3" xref="S3.SS1.p3.2.m1.3.3.cmml"><mi id="S3.SS1.p3.2.m1.3.3.3" xref="S3.SS1.p3.2.m1.3.3.3.cmml">P</mi><mo id="S3.SS1.p3.2.m1.3.3.2" xref="S3.SS1.p3.2.m1.3.3.2.cmml">⁢</mo><mrow id="S3.SS1.p3.2.m1.3.3.1.1" xref="S3.SS1.p3.2.m1.3.3.1.1.1.cmml"><mo id="S3.SS1.p3.2.m1.3.3.1.1.2" stretchy="false" xref="S3.SS1.p3.2.m1.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS1.p3.2.m1.3.3.1.1.1" xref="S3.SS1.p3.2.m1.3.3.1.1.1.cmml"><mi id="S3.SS1.p3.2.m1.3.3.1.1.1.2" xref="S3.SS1.p3.2.m1.3.3.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.SS1.p3.2.m1.3.3.1.1.1.1" xref="S3.SS1.p3.2.m1.3.3.1.1.1.1.cmml">|</mo><mrow id="S3.SS1.p3.2.m1.3.3.1.1.1.3.2" xref="S3.SS1.p3.2.m1.3.3.1.1.1.3.1.cmml"><mi id="S3.SS1.p3.2.m1.1.1" xref="S3.SS1.p3.2.m1.1.1.cmml">y</mi><mo id="S3.SS1.p3.2.m1.3.3.1.1.1.3.2.1" xref="S3.SS1.p3.2.m1.3.3.1.1.1.3.1.cmml">,</mo><mi id="S3.SS1.p3.2.m1.2.2" xref="S3.SS1.p3.2.m1.2.2.cmml">x</mi></mrow></mrow><mo id="S3.SS1.p3.2.m1.3.3.1.1.3" stretchy="false" xref="S3.SS1.p3.2.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m1.3b"><apply id="S3.SS1.p3.2.m1.3.3.cmml" xref="S3.SS1.p3.2.m1.3.3"><times id="S3.SS1.p3.2.m1.3.3.2.cmml" xref="S3.SS1.p3.2.m1.3.3.2"></times><ci id="S3.SS1.p3.2.m1.3.3.3.cmml" xref="S3.SS1.p3.2.m1.3.3.3">𝑃</ci><apply id="S3.SS1.p3.2.m1.3.3.1.1.1.cmml" xref="S3.SS1.p3.2.m1.3.3.1.1"><csymbol cd="latexml" id="S3.SS1.p3.2.m1.3.3.1.1.1.1.cmml" xref="S3.SS1.p3.2.m1.3.3.1.1.1.1">conditional</csymbol><ci id="S3.SS1.p3.2.m1.3.3.1.1.1.2.cmml" xref="S3.SS1.p3.2.m1.3.3.1.1.1.2">𝑎</ci><list id="S3.SS1.p3.2.m1.3.3.1.1.1.3.1.cmml" xref="S3.SS1.p3.2.m1.3.3.1.1.1.3.2"><ci id="S3.SS1.p3.2.m1.1.1.cmml" xref="S3.SS1.p3.2.m1.1.1">𝑦</ci><ci id="S3.SS1.p3.2.m1.2.2.cmml" xref="S3.SS1.p3.2.m1.2.2">𝑥</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m1.3c">P(a|y,x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m1.3d">italic_P ( italic_a | italic_y , italic_x )</annotation></semantics></math> is an autoregressive language model. <math alttext="P(y|x)" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m2.1"><semantics id="S3.SS1.p3.3.m2.1a"><mrow id="S3.SS1.p3.3.m2.1.1" xref="S3.SS1.p3.3.m2.1.1.cmml"><mi id="S3.SS1.p3.3.m2.1.1.3" xref="S3.SS1.p3.3.m2.1.1.3.cmml">P</mi><mo id="S3.SS1.p3.3.m2.1.1.2" xref="S3.SS1.p3.3.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p3.3.m2.1.1.1.1" xref="S3.SS1.p3.3.m2.1.1.1.1.1.cmml"><mo id="S3.SS1.p3.3.m2.1.1.1.1.2" stretchy="false" xref="S3.SS1.p3.3.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p3.3.m2.1.1.1.1.1" xref="S3.SS1.p3.3.m2.1.1.1.1.1.cmml"><mi id="S3.SS1.p3.3.m2.1.1.1.1.1.2" xref="S3.SS1.p3.3.m2.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S3.SS1.p3.3.m2.1.1.1.1.1.1" xref="S3.SS1.p3.3.m2.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS1.p3.3.m2.1.1.1.1.1.3" xref="S3.SS1.p3.3.m2.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.SS1.p3.3.m2.1.1.1.1.3" stretchy="false" xref="S3.SS1.p3.3.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m2.1b"><apply id="S3.SS1.p3.3.m2.1.1.cmml" xref="S3.SS1.p3.3.m2.1.1"><times id="S3.SS1.p3.3.m2.1.1.2.cmml" xref="S3.SS1.p3.3.m2.1.1.2"></times><ci id="S3.SS1.p3.3.m2.1.1.3.cmml" xref="S3.SS1.p3.3.m2.1.1.3">𝑃</ci><apply id="S3.SS1.p3.3.m2.1.1.1.1.1.cmml" xref="S3.SS1.p3.3.m2.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p3.3.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.3.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS1.p3.3.m2.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.3.m2.1.1.1.1.1.2">𝑦</ci><ci id="S3.SS1.p3.3.m2.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.3.m2.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m2.1c">P(y|x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m2.1d">italic_P ( italic_y | italic_x )</annotation></semantics></math> is computed by the softmax with logits from Equation <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S2.E2" title="In 2 Background ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">2</span></a> using the encoder models <math alttext="f(x)" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m3.1"><semantics id="S3.SS1.p3.4.m3.1a"><mrow id="S3.SS1.p3.4.m3.1.2" xref="S3.SS1.p3.4.m3.1.2.cmml"><mi id="S3.SS1.p3.4.m3.1.2.2" xref="S3.SS1.p3.4.m3.1.2.2.cmml">f</mi><mo id="S3.SS1.p3.4.m3.1.2.1" xref="S3.SS1.p3.4.m3.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p3.4.m3.1.2.3.2" xref="S3.SS1.p3.4.m3.1.2.cmml"><mo id="S3.SS1.p3.4.m3.1.2.3.2.1" stretchy="false" xref="S3.SS1.p3.4.m3.1.2.cmml">(</mo><mi id="S3.SS1.p3.4.m3.1.1" xref="S3.SS1.p3.4.m3.1.1.cmml">x</mi><mo id="S3.SS1.p3.4.m3.1.2.3.2.2" stretchy="false" xref="S3.SS1.p3.4.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m3.1b"><apply id="S3.SS1.p3.4.m3.1.2.cmml" xref="S3.SS1.p3.4.m3.1.2"><times id="S3.SS1.p3.4.m3.1.2.1.cmml" xref="S3.SS1.p3.4.m3.1.2.1"></times><ci id="S3.SS1.p3.4.m3.1.2.2.cmml" xref="S3.SS1.p3.4.m3.1.2.2">𝑓</ci><ci id="S3.SS1.p3.4.m3.1.1.cmml" xref="S3.SS1.p3.4.m3.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m3.1c">f(x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.4.m3.1d">italic_f ( italic_x )</annotation></semantics></math> and <math alttext="g(y)" class="ltx_Math" display="inline" id="S3.SS1.p3.5.m4.1"><semantics id="S3.SS1.p3.5.m4.1a"><mrow id="S3.SS1.p3.5.m4.1.2" xref="S3.SS1.p3.5.m4.1.2.cmml"><mi id="S3.SS1.p3.5.m4.1.2.2" xref="S3.SS1.p3.5.m4.1.2.2.cmml">g</mi><mo id="S3.SS1.p3.5.m4.1.2.1" xref="S3.SS1.p3.5.m4.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p3.5.m4.1.2.3.2" xref="S3.SS1.p3.5.m4.1.2.cmml"><mo id="S3.SS1.p3.5.m4.1.2.3.2.1" stretchy="false" xref="S3.SS1.p3.5.m4.1.2.cmml">(</mo><mi id="S3.SS1.p3.5.m4.1.1" xref="S3.SS1.p3.5.m4.1.1.cmml">y</mi><mo id="S3.SS1.p3.5.m4.1.2.3.2.2" stretchy="false" xref="S3.SS1.p3.5.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m4.1b"><apply id="S3.SS1.p3.5.m4.1.2.cmml" xref="S3.SS1.p3.5.m4.1.2"><times id="S3.SS1.p3.5.m4.1.2.1.cmml" xref="S3.SS1.p3.5.m4.1.2.1"></times><ci id="S3.SS1.p3.5.m4.1.2.2.cmml" xref="S3.SS1.p3.5.m4.1.2.2">𝑔</ci><ci id="S3.SS1.p3.5.m4.1.1.cmml" xref="S3.SS1.p3.5.m4.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m4.1c">g(y)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.5.m4.1d">italic_g ( italic_y )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.2">When training RLMs, we receive supervision in the form of question, answer pairs, e.g., <math alttext="x_{i},a_{i}\sim X" class="ltx_Math" display="inline" id="S3.SS1.p4.1.m1.2"><semantics id="S3.SS1.p4.1.m1.2a"><mrow id="S3.SS1.p4.1.m1.2.2" xref="S3.SS1.p4.1.m1.2.2.cmml"><mrow id="S3.SS1.p4.1.m1.2.2.2.2" xref="S3.SS1.p4.1.m1.2.2.2.3.cmml"><msub id="S3.SS1.p4.1.m1.1.1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS1.p4.1.m1.1.1.1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS1.p4.1.m1.1.1.1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p4.1.m1.2.2.2.2.3" xref="S3.SS1.p4.1.m1.2.2.2.3.cmml">,</mo><msub id="S3.SS1.p4.1.m1.2.2.2.2.2" xref="S3.SS1.p4.1.m1.2.2.2.2.2.cmml"><mi id="S3.SS1.p4.1.m1.2.2.2.2.2.2" xref="S3.SS1.p4.1.m1.2.2.2.2.2.2.cmml">a</mi><mi id="S3.SS1.p4.1.m1.2.2.2.2.2.3" xref="S3.SS1.p4.1.m1.2.2.2.2.2.3.cmml">i</mi></msub></mrow><mo id="S3.SS1.p4.1.m1.2.2.3" xref="S3.SS1.p4.1.m1.2.2.3.cmml">∼</mo><mi id="S3.SS1.p4.1.m1.2.2.4" xref="S3.SS1.p4.1.m1.2.2.4.cmml">X</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.2b"><apply id="S3.SS1.p4.1.m1.2.2.cmml" xref="S3.SS1.p4.1.m1.2.2"><csymbol cd="latexml" id="S3.SS1.p4.1.m1.2.2.3.cmml" xref="S3.SS1.p4.1.m1.2.2.3">similar-to</csymbol><list id="S3.SS1.p4.1.m1.2.2.2.3.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2"><apply id="S3.SS1.p4.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p4.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS1.p4.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.p4.1.m1.2.2.2.2.2.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p4.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.2.2">𝑎</ci><ci id="S3.SS1.p4.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.2.3">𝑖</ci></apply></list><ci id="S3.SS1.p4.1.m1.2.2.4.cmml" xref="S3.SS1.p4.1.m1.2.2.4">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.2c">x_{i},a_{i}\sim X</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.1.m1.2d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∼ italic_X</annotation></semantics></math>. We do not receive supervision on which targets <math alttext="S_{x}(\mathcal{Y})" class="ltx_Math" display="inline" id="S3.SS1.p4.2.m2.1"><semantics id="S3.SS1.p4.2.m2.1a"><mrow id="S3.SS1.p4.2.m2.1.2" xref="S3.SS1.p4.2.m2.1.2.cmml"><msub id="S3.SS1.p4.2.m2.1.2.2" xref="S3.SS1.p4.2.m2.1.2.2.cmml"><mi id="S3.SS1.p4.2.m2.1.2.2.2" xref="S3.SS1.p4.2.m2.1.2.2.2.cmml">S</mi><mi id="S3.SS1.p4.2.m2.1.2.2.3" xref="S3.SS1.p4.2.m2.1.2.2.3.cmml">x</mi></msub><mo id="S3.SS1.p4.2.m2.1.2.1" xref="S3.SS1.p4.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p4.2.m2.1.2.3.2" xref="S3.SS1.p4.2.m2.1.2.cmml"><mo id="S3.SS1.p4.2.m2.1.2.3.2.1" stretchy="false" xref="S3.SS1.p4.2.m2.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml">𝒴</mi><mo id="S3.SS1.p4.2.m2.1.2.3.2.2" stretchy="false" xref="S3.SS1.p4.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><apply id="S3.SS1.p4.2.m2.1.2.cmml" xref="S3.SS1.p4.2.m2.1.2"><times id="S3.SS1.p4.2.m2.1.2.1.cmml" xref="S3.SS1.p4.2.m2.1.2.1"></times><apply id="S3.SS1.p4.2.m2.1.2.2.cmml" xref="S3.SS1.p4.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.1.2.2.1.cmml" xref="S3.SS1.p4.2.m2.1.2.2">subscript</csymbol><ci id="S3.SS1.p4.2.m2.1.2.2.2.cmml" xref="S3.SS1.p4.2.m2.1.2.2.2">𝑆</ci><ci id="S3.SS1.p4.2.m2.1.2.2.3.cmml" xref="S3.SS1.p4.2.m2.1.2.2.3">𝑥</ci></apply><ci id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">S_{x}(\mathcal{Y})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.2.m2.1d">italic_S start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT ( caligraphic_Y )</annotation></semantics></math> should be retrieved. We will learn the parameters of both the reader model and retriever model using these supervised question/answer pairs.</p>
</div>
<div class="ltx_para" id="S3.SS1.p5">
<p class="ltx_p" id="S3.SS1.p5.2">To train the reader and retriever model, we use perplexity distillation <cite class="ltx_cite ltx_citemacro_citep">(Izacard et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib15" title="">2022</a>)</cite> for retriever loss and negative log-likelihood for the reader loss. Perplexity distillation is computed as the cross-entropy between two truncated distributions, one being the retriever’s <math alttext="\tilde{P}(y|x)" class="ltx_Math" display="inline" id="S3.SS1.p5.1.m1.1"><semantics id="S3.SS1.p5.1.m1.1a"><mrow id="S3.SS1.p5.1.m1.1.1" xref="S3.SS1.p5.1.m1.1.1.cmml"><mover accent="true" id="S3.SS1.p5.1.m1.1.1.3" xref="S3.SS1.p5.1.m1.1.1.3.cmml"><mi id="S3.SS1.p5.1.m1.1.1.3.2" xref="S3.SS1.p5.1.m1.1.1.3.2.cmml">P</mi><mo id="S3.SS1.p5.1.m1.1.1.3.1" xref="S3.SS1.p5.1.m1.1.1.3.1.cmml">~</mo></mover><mo id="S3.SS1.p5.1.m1.1.1.2" xref="S3.SS1.p5.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p5.1.m1.1.1.1.1" xref="S3.SS1.p5.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS1.p5.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p5.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p5.1.m1.1.1.1.1.1" xref="S3.SS1.p5.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS1.p5.1.m1.1.1.1.1.1.2" xref="S3.SS1.p5.1.m1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S3.SS1.p5.1.m1.1.1.1.1.1.1" xref="S3.SS1.p5.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS1.p5.1.m1.1.1.1.1.1.3" xref="S3.SS1.p5.1.m1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.SS1.p5.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p5.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.1.m1.1b"><apply id="S3.SS1.p5.1.m1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1"><times id="S3.SS1.p5.1.m1.1.1.2.cmml" xref="S3.SS1.p5.1.m1.1.1.2"></times><apply id="S3.SS1.p5.1.m1.1.1.3.cmml" xref="S3.SS1.p5.1.m1.1.1.3"><ci id="S3.SS1.p5.1.m1.1.1.3.1.cmml" xref="S3.SS1.p5.1.m1.1.1.3.1">~</ci><ci id="S3.SS1.p5.1.m1.1.1.3.2.cmml" xref="S3.SS1.p5.1.m1.1.1.3.2">𝑃</ci></apply><apply id="S3.SS1.p5.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p5.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS1.p5.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p5.1.m1.1.1.1.1.1.2">𝑦</ci><ci id="S3.SS1.p5.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.p5.1.m1.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.1.m1.1c">\tilde{P}(y|x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.1.m1.1d">over~ start_ARG italic_P end_ARG ( italic_y | italic_x )</annotation></semantics></math> (Equation <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S2.E3" title="In 2 Background ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">3</span></a>) and the other using the reader model to provide a soft-relevance label for each target in <math alttext="S_{x}(\mathcal{Y})" class="ltx_Math" display="inline" id="S3.SS1.p5.2.m2.1"><semantics id="S3.SS1.p5.2.m2.1a"><mrow id="S3.SS1.p5.2.m2.1.2" xref="S3.SS1.p5.2.m2.1.2.cmml"><msub id="S3.SS1.p5.2.m2.1.2.2" xref="S3.SS1.p5.2.m2.1.2.2.cmml"><mi id="S3.SS1.p5.2.m2.1.2.2.2" xref="S3.SS1.p5.2.m2.1.2.2.2.cmml">S</mi><mi id="S3.SS1.p5.2.m2.1.2.2.3" xref="S3.SS1.p5.2.m2.1.2.2.3.cmml">x</mi></msub><mo id="S3.SS1.p5.2.m2.1.2.1" xref="S3.SS1.p5.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p5.2.m2.1.2.3.2" xref="S3.SS1.p5.2.m2.1.2.cmml"><mo id="S3.SS1.p5.2.m2.1.2.3.2.1" stretchy="false" xref="S3.SS1.p5.2.m2.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p5.2.m2.1.1" xref="S3.SS1.p5.2.m2.1.1.cmml">𝒴</mi><mo id="S3.SS1.p5.2.m2.1.2.3.2.2" stretchy="false" xref="S3.SS1.p5.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.2.m2.1b"><apply id="S3.SS1.p5.2.m2.1.2.cmml" xref="S3.SS1.p5.2.m2.1.2"><times id="S3.SS1.p5.2.m2.1.2.1.cmml" xref="S3.SS1.p5.2.m2.1.2.1"></times><apply id="S3.SS1.p5.2.m2.1.2.2.cmml" xref="S3.SS1.p5.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p5.2.m2.1.2.2.1.cmml" xref="S3.SS1.p5.2.m2.1.2.2">subscript</csymbol><ci id="S3.SS1.p5.2.m2.1.2.2.2.cmml" xref="S3.SS1.p5.2.m2.1.2.2.2">𝑆</ci><ci id="S3.SS1.p5.2.m2.1.2.2.3.cmml" xref="S3.SS1.p5.2.m2.1.2.2.3">𝑥</ci></apply><ci id="S3.SS1.p5.2.m2.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.2.m2.1c">S_{x}(\mathcal{Y})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.2.m2.1d">italic_S start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT ( caligraphic_Y )</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A2.EGx2">
<tbody id="S3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle P_{a}(y|x)=\frac{P(a|y,x)}{\sum_{y^{\prime}\in S_{x}(\mathcal{Y}%
)}P(a|y^{\prime},x)}." class="ltx_Math" display="inline" id="S3.E8.m1.7"><semantics id="S3.E8.m1.7a"><mrow id="S3.E8.m1.7.7.1" xref="S3.E8.m1.7.7.1.1.cmml"><mrow id="S3.E8.m1.7.7.1.1" xref="S3.E8.m1.7.7.1.1.cmml"><mrow id="S3.E8.m1.7.7.1.1.1" xref="S3.E8.m1.7.7.1.1.1.cmml"><msub id="S3.E8.m1.7.7.1.1.1.3" xref="S3.E8.m1.7.7.1.1.1.3.cmml"><mi id="S3.E8.m1.7.7.1.1.1.3.2" xref="S3.E8.m1.7.7.1.1.1.3.2.cmml">P</mi><mi id="S3.E8.m1.7.7.1.1.1.3.3" xref="S3.E8.m1.7.7.1.1.1.3.3.cmml">a</mi></msub><mo id="S3.E8.m1.7.7.1.1.1.2" xref="S3.E8.m1.7.7.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.7.7.1.1.1.1.1" xref="S3.E8.m1.7.7.1.1.1.1.1.1.cmml"><mo id="S3.E8.m1.7.7.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.7.7.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.7.7.1.1.1.1.1.1" xref="S3.E8.m1.7.7.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.7.7.1.1.1.1.1.1.2" xref="S3.E8.m1.7.7.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S3.E8.m1.7.7.1.1.1.1.1.1.1" xref="S3.E8.m1.7.7.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E8.m1.7.7.1.1.1.1.1.1.3" xref="S3.E8.m1.7.7.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E8.m1.7.7.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.7.7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.7.7.1.1.2" xref="S3.E8.m1.7.7.1.1.2.cmml">=</mo><mstyle displaystyle="true" id="S3.E8.m1.6.6" xref="S3.E8.m1.6.6.cmml"><mfrac id="S3.E8.m1.6.6a" xref="S3.E8.m1.6.6.cmml"><mrow id="S3.E8.m1.3.3.3" xref="S3.E8.m1.3.3.3.cmml"><mi id="S3.E8.m1.3.3.3.5" xref="S3.E8.m1.3.3.3.5.cmml">P</mi><mo id="S3.E8.m1.3.3.3.4" xref="S3.E8.m1.3.3.3.4.cmml">⁢</mo><mrow id="S3.E8.m1.3.3.3.3.1" xref="S3.E8.m1.3.3.3.3.1.1.cmml"><mo id="S3.E8.m1.3.3.3.3.1.2" stretchy="false" xref="S3.E8.m1.3.3.3.3.1.1.cmml">(</mo><mrow id="S3.E8.m1.3.3.3.3.1.1" xref="S3.E8.m1.3.3.3.3.1.1.cmml"><mi id="S3.E8.m1.3.3.3.3.1.1.2" xref="S3.E8.m1.3.3.3.3.1.1.2.cmml">a</mi><mo fence="false" id="S3.E8.m1.3.3.3.3.1.1.1" xref="S3.E8.m1.3.3.3.3.1.1.1.cmml">|</mo><mrow id="S3.E8.m1.3.3.3.3.1.1.3.2" xref="S3.E8.m1.3.3.3.3.1.1.3.1.cmml"><mi id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml">y</mi><mo id="S3.E8.m1.3.3.3.3.1.1.3.2.1" xref="S3.E8.m1.3.3.3.3.1.1.3.1.cmml">,</mo><mi id="S3.E8.m1.2.2.2.2" xref="S3.E8.m1.2.2.2.2.cmml">x</mi></mrow></mrow><mo id="S3.E8.m1.3.3.3.3.1.3" stretchy="false" xref="S3.E8.m1.3.3.3.3.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E8.m1.6.6.6" xref="S3.E8.m1.6.6.6.cmml"><msub id="S3.E8.m1.6.6.6.4" xref="S3.E8.m1.6.6.6.4.cmml"><mo id="S3.E8.m1.6.6.6.4.2" xref="S3.E8.m1.6.6.6.4.2.cmml">∑</mo><mrow id="S3.E8.m1.4.4.4.1.1" xref="S3.E8.m1.4.4.4.1.1.cmml"><msup id="S3.E8.m1.4.4.4.1.1.3" xref="S3.E8.m1.4.4.4.1.1.3.cmml"><mi id="S3.E8.m1.4.4.4.1.1.3.2" xref="S3.E8.m1.4.4.4.1.1.3.2.cmml">y</mi><mo id="S3.E8.m1.4.4.4.1.1.3.3" xref="S3.E8.m1.4.4.4.1.1.3.3.cmml">′</mo></msup><mo id="S3.E8.m1.4.4.4.1.1.2" xref="S3.E8.m1.4.4.4.1.1.2.cmml">∈</mo><mrow id="S3.E8.m1.4.4.4.1.1.4" xref="S3.E8.m1.4.4.4.1.1.4.cmml"><msub id="S3.E8.m1.4.4.4.1.1.4.2" xref="S3.E8.m1.4.4.4.1.1.4.2.cmml"><mi id="S3.E8.m1.4.4.4.1.1.4.2.2" xref="S3.E8.m1.4.4.4.1.1.4.2.2.cmml">S</mi><mi id="S3.E8.m1.4.4.4.1.1.4.2.3" xref="S3.E8.m1.4.4.4.1.1.4.2.3.cmml">x</mi></msub><mo id="S3.E8.m1.4.4.4.1.1.4.1" xref="S3.E8.m1.4.4.4.1.1.4.1.cmml">⁢</mo><mrow id="S3.E8.m1.4.4.4.1.1.4.3.2" xref="S3.E8.m1.4.4.4.1.1.4.cmml"><mo id="S3.E8.m1.4.4.4.1.1.4.3.2.1" stretchy="false" xref="S3.E8.m1.4.4.4.1.1.4.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.4.4.4.1.1.1" xref="S3.E8.m1.4.4.4.1.1.1.cmml">𝒴</mi><mo id="S3.E8.m1.4.4.4.1.1.4.3.2.2" stretchy="false" xref="S3.E8.m1.4.4.4.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mrow id="S3.E8.m1.6.6.6.3" xref="S3.E8.m1.6.6.6.3.cmml"><mi id="S3.E8.m1.6.6.6.3.3" xref="S3.E8.m1.6.6.6.3.3.cmml">P</mi><mo id="S3.E8.m1.6.6.6.3.2" xref="S3.E8.m1.6.6.6.3.2.cmml">⁢</mo><mrow id="S3.E8.m1.6.6.6.3.1.1" xref="S3.E8.m1.6.6.6.3.1.1.1.cmml"><mo id="S3.E8.m1.6.6.6.3.1.1.2" stretchy="false" xref="S3.E8.m1.6.6.6.3.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.6.6.6.3.1.1.1" xref="S3.E8.m1.6.6.6.3.1.1.1.cmml"><mi id="S3.E8.m1.6.6.6.3.1.1.1.3" xref="S3.E8.m1.6.6.6.3.1.1.1.3.cmml">a</mi><mo fence="false" id="S3.E8.m1.6.6.6.3.1.1.1.2" xref="S3.E8.m1.6.6.6.3.1.1.1.2.cmml">|</mo><mrow id="S3.E8.m1.6.6.6.3.1.1.1.1.1" xref="S3.E8.m1.6.6.6.3.1.1.1.1.2.cmml"><msup id="S3.E8.m1.6.6.6.3.1.1.1.1.1.1" xref="S3.E8.m1.6.6.6.3.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.6.6.6.3.1.1.1.1.1.1.2" xref="S3.E8.m1.6.6.6.3.1.1.1.1.1.1.2.cmml">y</mi><mo id="S3.E8.m1.6.6.6.3.1.1.1.1.1.1.3" xref="S3.E8.m1.6.6.6.3.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.E8.m1.6.6.6.3.1.1.1.1.1.2" xref="S3.E8.m1.6.6.6.3.1.1.1.1.2.cmml">,</mo><mi id="S3.E8.m1.5.5.5.2" xref="S3.E8.m1.5.5.5.2.cmml">x</mi></mrow></mrow><mo id="S3.E8.m1.6.6.6.3.1.1.3" stretchy="false" xref="S3.E8.m1.6.6.6.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><mo id="S3.E8.m1.7.7.1.2" lspace="0em" xref="S3.E8.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.7b"><apply id="S3.E8.m1.7.7.1.1.cmml" xref="S3.E8.m1.7.7.1"><eq id="S3.E8.m1.7.7.1.1.2.cmml" xref="S3.E8.m1.7.7.1.1.2"></eq><apply id="S3.E8.m1.7.7.1.1.1.cmml" xref="S3.E8.m1.7.7.1.1.1"><times id="S3.E8.m1.7.7.1.1.1.2.cmml" xref="S3.E8.m1.7.7.1.1.1.2"></times><apply id="S3.E8.m1.7.7.1.1.1.3.cmml" xref="S3.E8.m1.7.7.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.7.7.1.1.1.3.1.cmml" xref="S3.E8.m1.7.7.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.7.7.1.1.1.3.2.cmml" xref="S3.E8.m1.7.7.1.1.1.3.2">𝑃</ci><ci id="S3.E8.m1.7.7.1.1.1.3.3.cmml" xref="S3.E8.m1.7.7.1.1.1.3.3">𝑎</ci></apply><apply id="S3.E8.m1.7.7.1.1.1.1.1.1.cmml" xref="S3.E8.m1.7.7.1.1.1.1.1"><csymbol cd="latexml" id="S3.E8.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.7.7.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E8.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.7.7.1.1.1.1.1.1.2">𝑦</ci><ci id="S3.E8.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.7.7.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.E8.m1.6.6.cmml" xref="S3.E8.m1.6.6"><divide id="S3.E8.m1.6.6.7.cmml" xref="S3.E8.m1.6.6"></divide><apply id="S3.E8.m1.3.3.3.cmml" xref="S3.E8.m1.3.3.3"><times id="S3.E8.m1.3.3.3.4.cmml" xref="S3.E8.m1.3.3.3.4"></times><ci id="S3.E8.m1.3.3.3.5.cmml" xref="S3.E8.m1.3.3.3.5">𝑃</ci><apply id="S3.E8.m1.3.3.3.3.1.1.cmml" xref="S3.E8.m1.3.3.3.3.1"><csymbol cd="latexml" id="S3.E8.m1.3.3.3.3.1.1.1.cmml" xref="S3.E8.m1.3.3.3.3.1.1.1">conditional</csymbol><ci id="S3.E8.m1.3.3.3.3.1.1.2.cmml" xref="S3.E8.m1.3.3.3.3.1.1.2">𝑎</ci><list id="S3.E8.m1.3.3.3.3.1.1.3.1.cmml" xref="S3.E8.m1.3.3.3.3.1.1.3.2"><ci id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1">𝑦</ci><ci id="S3.E8.m1.2.2.2.2.cmml" xref="S3.E8.m1.2.2.2.2">𝑥</ci></list></apply></apply><apply id="S3.E8.m1.6.6.6.cmml" xref="S3.E8.m1.6.6.6"><apply id="S3.E8.m1.6.6.6.4.cmml" xref="S3.E8.m1.6.6.6.4"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.6.4.1.cmml" xref="S3.E8.m1.6.6.6.4">subscript</csymbol><sum id="S3.E8.m1.6.6.6.4.2.cmml" xref="S3.E8.m1.6.6.6.4.2"></sum><apply id="S3.E8.m1.4.4.4.1.1.cmml" xref="S3.E8.m1.4.4.4.1.1"><in id="S3.E8.m1.4.4.4.1.1.2.cmml" xref="S3.E8.m1.4.4.4.1.1.2"></in><apply id="S3.E8.m1.4.4.4.1.1.3.cmml" xref="S3.E8.m1.4.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.4.1.1.3.1.cmml" xref="S3.E8.m1.4.4.4.1.1.3">superscript</csymbol><ci id="S3.E8.m1.4.4.4.1.1.3.2.cmml" xref="S3.E8.m1.4.4.4.1.1.3.2">𝑦</ci><ci id="S3.E8.m1.4.4.4.1.1.3.3.cmml" xref="S3.E8.m1.4.4.4.1.1.3.3">′</ci></apply><apply id="S3.E8.m1.4.4.4.1.1.4.cmml" xref="S3.E8.m1.4.4.4.1.1.4"><times id="S3.E8.m1.4.4.4.1.1.4.1.cmml" xref="S3.E8.m1.4.4.4.1.1.4.1"></times><apply id="S3.E8.m1.4.4.4.1.1.4.2.cmml" xref="S3.E8.m1.4.4.4.1.1.4.2"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.4.1.1.4.2.1.cmml" xref="S3.E8.m1.4.4.4.1.1.4.2">subscript</csymbol><ci id="S3.E8.m1.4.4.4.1.1.4.2.2.cmml" xref="S3.E8.m1.4.4.4.1.1.4.2.2">𝑆</ci><ci id="S3.E8.m1.4.4.4.1.1.4.2.3.cmml" xref="S3.E8.m1.4.4.4.1.1.4.2.3">𝑥</ci></apply><ci id="S3.E8.m1.4.4.4.1.1.1.cmml" xref="S3.E8.m1.4.4.4.1.1.1">𝒴</ci></apply></apply></apply><apply id="S3.E8.m1.6.6.6.3.cmml" xref="S3.E8.m1.6.6.6.3"><times id="S3.E8.m1.6.6.6.3.2.cmml" xref="S3.E8.m1.6.6.6.3.2"></times><ci id="S3.E8.m1.6.6.6.3.3.cmml" xref="S3.E8.m1.6.6.6.3.3">𝑃</ci><apply id="S3.E8.m1.6.6.6.3.1.1.1.cmml" xref="S3.E8.m1.6.6.6.3.1.1"><csymbol cd="latexml" id="S3.E8.m1.6.6.6.3.1.1.1.2.cmml" xref="S3.E8.m1.6.6.6.3.1.1.1.2">conditional</csymbol><ci id="S3.E8.m1.6.6.6.3.1.1.1.3.cmml" xref="S3.E8.m1.6.6.6.3.1.1.1.3">𝑎</ci><list id="S3.E8.m1.6.6.6.3.1.1.1.1.2.cmml" xref="S3.E8.m1.6.6.6.3.1.1.1.1.1"><apply id="S3.E8.m1.6.6.6.3.1.1.1.1.1.1.cmml" xref="S3.E8.m1.6.6.6.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.6.3.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.6.6.6.3.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E8.m1.6.6.6.3.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.6.6.6.3.1.1.1.1.1.1.2">𝑦</ci><ci id="S3.E8.m1.6.6.6.3.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.6.6.6.3.1.1.1.1.1.1.3">′</ci></apply><ci id="S3.E8.m1.5.5.5.2.cmml" xref="S3.E8.m1.5.5.5.2">𝑥</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.7c">\displaystyle P_{a}(y|x)=\frac{P(a|y,x)}{\sum_{y^{\prime}\in S_{x}(\mathcal{Y}%
)}P(a|y^{\prime},x)}.</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.7d">italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ( italic_y | italic_x ) = divide start_ARG italic_P ( italic_a | italic_y , italic_x ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ italic_S start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT ( caligraphic_Y ) end_POSTSUBSCRIPT italic_P ( italic_a | italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_x ) end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p5.4">In words, <math alttext="P_{a}(y|x)" class="ltx_Math" display="inline" id="S3.SS1.p5.3.m1.1"><semantics id="S3.SS1.p5.3.m1.1a"><mrow id="S3.SS1.p5.3.m1.1.1" xref="S3.SS1.p5.3.m1.1.1.cmml"><msub id="S3.SS1.p5.3.m1.1.1.3" xref="S3.SS1.p5.3.m1.1.1.3.cmml"><mi id="S3.SS1.p5.3.m1.1.1.3.2" xref="S3.SS1.p5.3.m1.1.1.3.2.cmml">P</mi><mi id="S3.SS1.p5.3.m1.1.1.3.3" xref="S3.SS1.p5.3.m1.1.1.3.3.cmml">a</mi></msub><mo id="S3.SS1.p5.3.m1.1.1.2" xref="S3.SS1.p5.3.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p5.3.m1.1.1.1.1" xref="S3.SS1.p5.3.m1.1.1.1.1.1.cmml"><mo id="S3.SS1.p5.3.m1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p5.3.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p5.3.m1.1.1.1.1.1" xref="S3.SS1.p5.3.m1.1.1.1.1.1.cmml"><mi id="S3.SS1.p5.3.m1.1.1.1.1.1.2" xref="S3.SS1.p5.3.m1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S3.SS1.p5.3.m1.1.1.1.1.1.1" xref="S3.SS1.p5.3.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS1.p5.3.m1.1.1.1.1.1.3" xref="S3.SS1.p5.3.m1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.SS1.p5.3.m1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p5.3.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.3.m1.1b"><apply id="S3.SS1.p5.3.m1.1.1.cmml" xref="S3.SS1.p5.3.m1.1.1"><times id="S3.SS1.p5.3.m1.1.1.2.cmml" xref="S3.SS1.p5.3.m1.1.1.2"></times><apply id="S3.SS1.p5.3.m1.1.1.3.cmml" xref="S3.SS1.p5.3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p5.3.m1.1.1.3.1.cmml" xref="S3.SS1.p5.3.m1.1.1.3">subscript</csymbol><ci id="S3.SS1.p5.3.m1.1.1.3.2.cmml" xref="S3.SS1.p5.3.m1.1.1.3.2">𝑃</ci><ci id="S3.SS1.p5.3.m1.1.1.3.3.cmml" xref="S3.SS1.p5.3.m1.1.1.3.3">𝑎</ci></apply><apply id="S3.SS1.p5.3.m1.1.1.1.1.1.cmml" xref="S3.SS1.p5.3.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p5.3.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p5.3.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS1.p5.3.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p5.3.m1.1.1.1.1.1.2">𝑦</ci><ci id="S3.SS1.p5.3.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.p5.3.m1.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.3.m1.1c">P_{a}(y|x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.3.m1.1d">italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ( italic_y | italic_x )</annotation></semantics></math> normalizes the likelihood scores of the reader model generating the correct answer text when conditioned on the given retrieved target <math alttext="y" class="ltx_Math" display="inline" id="S3.SS1.p5.4.m2.1"><semantics id="S3.SS1.p5.4.m2.1a"><mi id="S3.SS1.p5.4.m2.1.1" xref="S3.SS1.p5.4.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.4.m2.1b"><ci id="S3.SS1.p5.4.m2.1.1.cmml" xref="S3.SS1.p5.4.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.4.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.4.m2.1d">italic_y</annotation></semantics></math>. The reader’s loss function, negative-log likelihood is simply computed using the supervised answer text. The two losses are averaged and parameters optimized with gradient descent.</p>
</div>
<div class="ltx_para" id="S3.SS1.p6">
<p class="ltx_p" id="S3.SS1.p6.6">To facilitate efficient training, we use our proposed target corrector network to select the subset of retrieved targets <math alttext="S_{x}(\mathcal{Y})" class="ltx_Math" display="inline" id="S3.SS1.p6.1.m1.1"><semantics id="S3.SS1.p6.1.m1.1a"><mrow id="S3.SS1.p6.1.m1.1.2" xref="S3.SS1.p6.1.m1.1.2.cmml"><msub id="S3.SS1.p6.1.m1.1.2.2" xref="S3.SS1.p6.1.m1.1.2.2.cmml"><mi id="S3.SS1.p6.1.m1.1.2.2.2" xref="S3.SS1.p6.1.m1.1.2.2.2.cmml">S</mi><mi id="S3.SS1.p6.1.m1.1.2.2.3" xref="S3.SS1.p6.1.m1.1.2.2.3.cmml">x</mi></msub><mo id="S3.SS1.p6.1.m1.1.2.1" xref="S3.SS1.p6.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p6.1.m1.1.2.3.2" xref="S3.SS1.p6.1.m1.1.2.cmml"><mo id="S3.SS1.p6.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS1.p6.1.m1.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p6.1.m1.1.1" xref="S3.SS1.p6.1.m1.1.1.cmml">𝒴</mi><mo id="S3.SS1.p6.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS1.p6.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.1.m1.1b"><apply id="S3.SS1.p6.1.m1.1.2.cmml" xref="S3.SS1.p6.1.m1.1.2"><times id="S3.SS1.p6.1.m1.1.2.1.cmml" xref="S3.SS1.p6.1.m1.1.2.1"></times><apply id="S3.SS1.p6.1.m1.1.2.2.cmml" xref="S3.SS1.p6.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p6.1.m1.1.2.2.1.cmml" xref="S3.SS1.p6.1.m1.1.2.2">subscript</csymbol><ci id="S3.SS1.p6.1.m1.1.2.2.2.cmml" xref="S3.SS1.p6.1.m1.1.2.2.2">𝑆</ci><ci id="S3.SS1.p6.1.m1.1.2.2.3.cmml" xref="S3.SS1.p6.1.m1.1.2.2.3">𝑥</ci></apply><ci id="S3.SS1.p6.1.m1.1.1.cmml" xref="S3.SS1.p6.1.m1.1.1">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.1.m1.1c">S_{x}(\mathcal{Y})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.1.m1.1d">italic_S start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT ( caligraphic_Y )</annotation></semantics></math> used at training time. This is done in the same way as in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#alg1" title="Algorithm 1 ‣ 3 Improving Training with Target Correctors ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">1</span></a>, i.e., we pick a subset of <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p6.2.m2.1"><semantics id="S3.SS1.p6.2.m2.1a"><mi id="S3.SS1.p6.2.m2.1.1" xref="S3.SS1.p6.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.2.m2.1b"><ci id="S3.SS1.p6.2.m2.1.1.cmml" xref="S3.SS1.p6.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.2.m2.1d">italic_k</annotation></semantics></math> targets <math alttext="S_{x}(\mathcal{Y})" class="ltx_Math" display="inline" id="S3.SS1.p6.3.m3.1"><semantics id="S3.SS1.p6.3.m3.1a"><mrow id="S3.SS1.p6.3.m3.1.2" xref="S3.SS1.p6.3.m3.1.2.cmml"><msub id="S3.SS1.p6.3.m3.1.2.2" xref="S3.SS1.p6.3.m3.1.2.2.cmml"><mi id="S3.SS1.p6.3.m3.1.2.2.2" xref="S3.SS1.p6.3.m3.1.2.2.2.cmml">S</mi><mi id="S3.SS1.p6.3.m3.1.2.2.3" xref="S3.SS1.p6.3.m3.1.2.2.3.cmml">x</mi></msub><mo id="S3.SS1.p6.3.m3.1.2.1" xref="S3.SS1.p6.3.m3.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p6.3.m3.1.2.3.2" xref="S3.SS1.p6.3.m3.1.2.cmml"><mo id="S3.SS1.p6.3.m3.1.2.3.2.1" stretchy="false" xref="S3.SS1.p6.3.m3.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p6.3.m3.1.1" xref="S3.SS1.p6.3.m3.1.1.cmml">𝒴</mi><mo id="S3.SS1.p6.3.m3.1.2.3.2.2" stretchy="false" xref="S3.SS1.p6.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.3.m3.1b"><apply id="S3.SS1.p6.3.m3.1.2.cmml" xref="S3.SS1.p6.3.m3.1.2"><times id="S3.SS1.p6.3.m3.1.2.1.cmml" xref="S3.SS1.p6.3.m3.1.2.1"></times><apply id="S3.SS1.p6.3.m3.1.2.2.cmml" xref="S3.SS1.p6.3.m3.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p6.3.m3.1.2.2.1.cmml" xref="S3.SS1.p6.3.m3.1.2.2">subscript</csymbol><ci id="S3.SS1.p6.3.m3.1.2.2.2.cmml" xref="S3.SS1.p6.3.m3.1.2.2.2">𝑆</ci><ci id="S3.SS1.p6.3.m3.1.2.2.3.cmml" xref="S3.SS1.p6.3.m3.1.2.2.3">𝑥</ci></apply><ci id="S3.SS1.p6.3.m3.1.1.cmml" xref="S3.SS1.p6.3.m3.1.1">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.3.m3.1c">S_{x}(\mathcal{Y})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.3.m3.1d">italic_S start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT ( caligraphic_Y )</annotation></semantics></math> for <math alttext="x" class="ltx_Math" display="inline" id="S3.SS1.p6.4.m4.1"><semantics id="S3.SS1.p6.4.m4.1a"><mi id="S3.SS1.p6.4.m4.1.1" xref="S3.SS1.p6.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.4.m4.1b"><ci id="S3.SS1.p6.4.m4.1.1.cmml" xref="S3.SS1.p6.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.4.m4.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.4.m4.1d">italic_x</annotation></semantics></math> according to <math alttext="\exp(\beta f(x)^{T}h\circ g^{\prime}(y))" class="ltx_Math" display="inline" id="S3.SS1.p6.5.m5.4"><semantics id="S3.SS1.p6.5.m5.4a"><mrow id="S3.SS1.p6.5.m5.4.4.1" xref="S3.SS1.p6.5.m5.4.4.2.cmml"><mi id="S3.SS1.p6.5.m5.3.3" xref="S3.SS1.p6.5.m5.3.3.cmml">exp</mi><mo id="S3.SS1.p6.5.m5.4.4.1a" xref="S3.SS1.p6.5.m5.4.4.2.cmml">⁡</mo><mrow id="S3.SS1.p6.5.m5.4.4.1.1" xref="S3.SS1.p6.5.m5.4.4.2.cmml"><mo id="S3.SS1.p6.5.m5.4.4.1.1.2" stretchy="false" xref="S3.SS1.p6.5.m5.4.4.2.cmml">(</mo><mrow id="S3.SS1.p6.5.m5.4.4.1.1.1" xref="S3.SS1.p6.5.m5.4.4.1.1.1.cmml"><mrow id="S3.SS1.p6.5.m5.4.4.1.1.1.2" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.cmml"><mrow id="S3.SS1.p6.5.m5.4.4.1.1.1.2.2" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.cmml"><mi id="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.2" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.2.cmml">β</mi><mo id="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.1" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.1.cmml">⁢</mo><mi id="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.3" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.3.cmml">f</mi><mo id="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.1a" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.1.cmml">⁢</mo><msup id="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.4" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.4.cmml"><mrow id="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.4.2.2" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.4.cmml"><mo id="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.4.2.2.1" stretchy="false" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.4.cmml">(</mo><mi id="S3.SS1.p6.5.m5.1.1" xref="S3.SS1.p6.5.m5.1.1.cmml">x</mi><mo id="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.4.2.2.2" stretchy="false" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.4.cmml">)</mo></mrow><mi id="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.4.3" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.4.3.cmml">T</mi></msup><mo id="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.1b" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.1.cmml">⁢</mo><mi id="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.5" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.5.cmml">h</mi></mrow><mo id="S3.SS1.p6.5.m5.4.4.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.1.cmml">∘</mo><msup id="S3.SS1.p6.5.m5.4.4.1.1.1.2.3" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.3.cmml"><mi id="S3.SS1.p6.5.m5.4.4.1.1.1.2.3.2" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.3.2.cmml">g</mi><mo id="S3.SS1.p6.5.m5.4.4.1.1.1.2.3.3" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.3.3.cmml">′</mo></msup></mrow><mo id="S3.SS1.p6.5.m5.4.4.1.1.1.1" xref="S3.SS1.p6.5.m5.4.4.1.1.1.1.cmml">⁢</mo><mrow id="S3.SS1.p6.5.m5.4.4.1.1.1.3.2" xref="S3.SS1.p6.5.m5.4.4.1.1.1.cmml"><mo id="S3.SS1.p6.5.m5.4.4.1.1.1.3.2.1" stretchy="false" xref="S3.SS1.p6.5.m5.4.4.1.1.1.cmml">(</mo><mi id="S3.SS1.p6.5.m5.2.2" xref="S3.SS1.p6.5.m5.2.2.cmml">y</mi><mo id="S3.SS1.p6.5.m5.4.4.1.1.1.3.2.2" stretchy="false" xref="S3.SS1.p6.5.m5.4.4.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p6.5.m5.4.4.1.1.3" stretchy="false" xref="S3.SS1.p6.5.m5.4.4.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.5.m5.4b"><apply id="S3.SS1.p6.5.m5.4.4.2.cmml" xref="S3.SS1.p6.5.m5.4.4.1"><exp id="S3.SS1.p6.5.m5.3.3.cmml" xref="S3.SS1.p6.5.m5.3.3"></exp><apply id="S3.SS1.p6.5.m5.4.4.1.1.1.cmml" xref="S3.SS1.p6.5.m5.4.4.1.1.1"><times id="S3.SS1.p6.5.m5.4.4.1.1.1.1.cmml" xref="S3.SS1.p6.5.m5.4.4.1.1.1.1"></times><apply id="S3.SS1.p6.5.m5.4.4.1.1.1.2.cmml" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2"><compose id="S3.SS1.p6.5.m5.4.4.1.1.1.2.1.cmml" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.1"></compose><apply id="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.cmml" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.2"><times id="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.1.cmml" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.1"></times><ci id="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.2.cmml" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.2">𝛽</ci><ci id="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.3.cmml" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.3">𝑓</ci><apply id="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.4.cmml" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.4.1.cmml" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.4">superscript</csymbol><ci id="S3.SS1.p6.5.m5.1.1.cmml" xref="S3.SS1.p6.5.m5.1.1">𝑥</ci><ci id="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.4.3.cmml" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.4.3">𝑇</ci></apply><ci id="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.5.cmml" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.2.5">ℎ</ci></apply><apply id="S3.SS1.p6.5.m5.4.4.1.1.1.2.3.cmml" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p6.5.m5.4.4.1.1.1.2.3.1.cmml" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.3">superscript</csymbol><ci id="S3.SS1.p6.5.m5.4.4.1.1.1.2.3.2.cmml" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.3.2">𝑔</ci><ci id="S3.SS1.p6.5.m5.4.4.1.1.1.2.3.3.cmml" xref="S3.SS1.p6.5.m5.4.4.1.1.1.2.3.3">′</ci></apply></apply><ci id="S3.SS1.p6.5.m5.2.2.cmml" xref="S3.SS1.p6.5.m5.2.2">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.5.m5.4c">\exp(\beta f(x)^{T}h\circ g^{\prime}(y))</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.5.m5.4d">roman_exp ( italic_β italic_f ( italic_x ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_h ∘ italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y ) )</annotation></semantics></math> via top-<math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p6.6.m6.1"><semantics id="S3.SS1.p6.6.m6.1a"><mi id="S3.SS1.p6.6.m6.1.1" xref="S3.SS1.p6.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.6.m6.1b"><ci id="S3.SS1.p6.6.m6.1.1.cmml" xref="S3.SS1.p6.6.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.6.m6.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.6.m6.1d">italic_k</annotation></semantics></math> or Gumbel-Max sampling. We can make simple modifications to Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#alg1" title="Algorithm 1 ‣ 3 Improving Training with Target Correctors ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">1</span></a>, which are presented in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#alg2" title="Algorithm 2 ‣ 3.1 Latent Variables in Retrieval Augmented Models ‣ 3 Improving Training with Target Correctors ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">2</span></a> to train the RLM. We compute two task-specific losses (perplexity distillation, negative log-likelihood) and optimize both the reader and retriever parameters. We use cross-entropy to train the corrector, which is again only used at training time. At prediction time, the trained retriever model is used.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.38.1.1">Algorithm 2</span> </span> Training RLMs with corrector models</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="alg2.15"><span class="ltx_text" id="alg2.15.1"><span class="ltx_text ltx_font_bold" id="alg2.15.1.1">Data:</span> </span>Training data <math alttext="X" class="ltx_Math" display="inline" id="alg2.1.m1.1"><semantics id="alg2.1.m1.1a"><mi id="alg2.1.m1.1.1" xref="alg2.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="alg2.1.m1.1b"><ci id="alg2.1.m1.1.1.cmml" xref="alg2.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.1.m1.1c">X</annotation><annotation encoding="application/x-llamapun" id="alg2.1.m1.1d">italic_X</annotation></semantics></math>, Targets <math alttext="\mathcal{Y}" class="ltx_Math" display="inline" id="alg2.2.m2.1"><semantics id="alg2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.2.m2.1.1" xref="alg2.2.m2.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="alg2.2.m2.1b"><ci id="alg2.2.m2.1.1.cmml" xref="alg2.2.m2.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.2.m2.1c">\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="alg2.2.m2.1d">caligraphic_Y</annotation></semantics></math>, Retriever and Reader Parameters <math alttext="\Theta" class="ltx_Math" display="inline" id="alg2.3.m3.1"><semantics id="alg2.3.m3.1a"><mi id="alg2.3.m3.1.1" mathvariant="normal" xref="alg2.3.m3.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="alg2.3.m3.1b"><ci id="alg2.3.m3.1.1.cmml" xref="alg2.3.m3.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.3.m3.1c">\Theta</annotation><annotation encoding="application/x-llamapun" id="alg2.3.m3.1d">roman_Θ</annotation></semantics></math>, Correction Model parameters <math alttext="\Psi" class="ltx_Math" display="inline" id="alg2.4.m4.1"><semantics id="alg2.4.m4.1a"><mi id="alg2.4.m4.1.1" mathvariant="normal" xref="alg2.4.m4.1.1.cmml">Ψ</mi><annotation-xml encoding="MathML-Content" id="alg2.4.m4.1b"><ci id="alg2.4.m4.1.1.cmml" xref="alg2.4.m4.1.1">Ψ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.4.m4.1c">\Psi</annotation><annotation encoding="application/x-llamapun" id="alg2.4.m4.1d">roman_Ψ</annotation></semantics></math>, Input encoder <math alttext="f(\cdot)" class="ltx_Math" display="inline" id="alg2.5.m5.1"><semantics id="alg2.5.m5.1a"><mrow id="alg2.5.m5.1.2" xref="alg2.5.m5.1.2.cmml"><mi id="alg2.5.m5.1.2.2" xref="alg2.5.m5.1.2.2.cmml">f</mi><mo id="alg2.5.m5.1.2.1" xref="alg2.5.m5.1.2.1.cmml">⁢</mo><mrow id="alg2.5.m5.1.2.3.2" xref="alg2.5.m5.1.2.cmml"><mo id="alg2.5.m5.1.2.3.2.1" stretchy="false" xref="alg2.5.m5.1.2.cmml">(</mo><mo id="alg2.5.m5.1.1" lspace="0em" rspace="0em" xref="alg2.5.m5.1.1.cmml">⋅</mo><mo id="alg2.5.m5.1.2.3.2.2" stretchy="false" xref="alg2.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.5.m5.1b"><apply id="alg2.5.m5.1.2.cmml" xref="alg2.5.m5.1.2"><times id="alg2.5.m5.1.2.1.cmml" xref="alg2.5.m5.1.2.1"></times><ci id="alg2.5.m5.1.2.2.cmml" xref="alg2.5.m5.1.2.2">𝑓</ci><ci id="alg2.5.m5.1.1.cmml" xref="alg2.5.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.5.m5.1c">f(\cdot)</annotation><annotation encoding="application/x-llamapun" id="alg2.5.m5.1d">italic_f ( ⋅ )</annotation></semantics></math>, Target encoder <math alttext="g(\cdot)" class="ltx_Math" display="inline" id="alg2.6.m6.1"><semantics id="alg2.6.m6.1a"><mrow id="alg2.6.m6.1.2" xref="alg2.6.m6.1.2.cmml"><mi id="alg2.6.m6.1.2.2" xref="alg2.6.m6.1.2.2.cmml">g</mi><mo id="alg2.6.m6.1.2.1" xref="alg2.6.m6.1.2.1.cmml">⁢</mo><mrow id="alg2.6.m6.1.2.3.2" xref="alg2.6.m6.1.2.cmml"><mo id="alg2.6.m6.1.2.3.2.1" stretchy="false" xref="alg2.6.m6.1.2.cmml">(</mo><mo id="alg2.6.m6.1.1" lspace="0em" rspace="0em" xref="alg2.6.m6.1.1.cmml">⋅</mo><mo id="alg2.6.m6.1.2.3.2.2" stretchy="false" xref="alg2.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.6.m6.1b"><apply id="alg2.6.m6.1.2.cmml" xref="alg2.6.m6.1.2"><times id="alg2.6.m6.1.2.1.cmml" xref="alg2.6.m6.1.2.1"></times><ci id="alg2.6.m6.1.2.2.cmml" xref="alg2.6.m6.1.2.2">𝑔</ci><ci id="alg2.6.m6.1.1.cmml" xref="alg2.6.m6.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.6.m6.1c">g(\cdot)</annotation><annotation encoding="application/x-llamapun" id="alg2.6.m6.1d">italic_g ( ⋅ )</annotation></semantics></math>, Approximate target encoder <math alttext="g^{\prime}(\cdot)" class="ltx_Math" display="inline" id="alg2.7.m7.1"><semantics id="alg2.7.m7.1a"><mrow id="alg2.7.m7.1.2" xref="alg2.7.m7.1.2.cmml"><msup id="alg2.7.m7.1.2.2" xref="alg2.7.m7.1.2.2.cmml"><mi id="alg2.7.m7.1.2.2.2" xref="alg2.7.m7.1.2.2.2.cmml">g</mi><mo id="alg2.7.m7.1.2.2.3" xref="alg2.7.m7.1.2.2.3.cmml">′</mo></msup><mo id="alg2.7.m7.1.2.1" xref="alg2.7.m7.1.2.1.cmml">⁢</mo><mrow id="alg2.7.m7.1.2.3.2" xref="alg2.7.m7.1.2.cmml"><mo id="alg2.7.m7.1.2.3.2.1" stretchy="false" xref="alg2.7.m7.1.2.cmml">(</mo><mo id="alg2.7.m7.1.1" lspace="0em" rspace="0em" xref="alg2.7.m7.1.1.cmml">⋅</mo><mo id="alg2.7.m7.1.2.3.2.2" stretchy="false" xref="alg2.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.7.m7.1b"><apply id="alg2.7.m7.1.2.cmml" xref="alg2.7.m7.1.2"><times id="alg2.7.m7.1.2.1.cmml" xref="alg2.7.m7.1.2.1"></times><apply id="alg2.7.m7.1.2.2.cmml" xref="alg2.7.m7.1.2.2"><csymbol cd="ambiguous" id="alg2.7.m7.1.2.2.1.cmml" xref="alg2.7.m7.1.2.2">superscript</csymbol><ci id="alg2.7.m7.1.2.2.2.cmml" xref="alg2.7.m7.1.2.2.2">𝑔</ci><ci id="alg2.7.m7.1.2.2.3.cmml" xref="alg2.7.m7.1.2.2.3">′</ci></apply><ci id="alg2.7.m7.1.1.cmml" xref="alg2.7.m7.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.7.m7.1c">g^{\prime}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="alg2.7.m7.1d">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( ⋅ )</annotation></semantics></math> (buffer <math alttext="B" class="ltx_Math" display="inline" id="alg2.8.m8.1"><semantics id="alg2.8.m8.1a"><mi id="alg2.8.m8.1.1" xref="alg2.8.m8.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg2.8.m8.1b"><ci id="alg2.8.m8.1.1.cmml" xref="alg2.8.m8.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.8.m8.1c">B</annotation><annotation encoding="application/x-llamapun" id="alg2.8.m8.1d">italic_B</annotation></semantics></math>), corrector model <math alttext="h(\cdot)" class="ltx_Math" display="inline" id="alg2.9.m9.1"><semantics id="alg2.9.m9.1a"><mrow id="alg2.9.m9.1.2" xref="alg2.9.m9.1.2.cmml"><mi id="alg2.9.m9.1.2.2" xref="alg2.9.m9.1.2.2.cmml">h</mi><mo id="alg2.9.m9.1.2.1" xref="alg2.9.m9.1.2.1.cmml">⁢</mo><mrow id="alg2.9.m9.1.2.3.2" xref="alg2.9.m9.1.2.cmml"><mo id="alg2.9.m9.1.2.3.2.1" stretchy="false" xref="alg2.9.m9.1.2.cmml">(</mo><mo id="alg2.9.m9.1.1" lspace="0em" rspace="0em" xref="alg2.9.m9.1.1.cmml">⋅</mo><mo id="alg2.9.m9.1.2.3.2.2" stretchy="false" xref="alg2.9.m9.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.9.m9.1b"><apply id="alg2.9.m9.1.2.cmml" xref="alg2.9.m9.1.2"><times id="alg2.9.m9.1.2.1.cmml" xref="alg2.9.m9.1.2.1"></times><ci id="alg2.9.m9.1.2.2.cmml" xref="alg2.9.m9.1.2.2">ℎ</ci><ci id="alg2.9.m9.1.1.cmml" xref="alg2.9.m9.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.9.m9.1c">h(\cdot)</annotation><annotation encoding="application/x-llamapun" id="alg2.9.m9.1d">italic_h ( ⋅ )</annotation></semantics></math>, temperature <math alttext="\beta" class="ltx_Math" display="inline" id="alg2.10.m10.1"><semantics id="alg2.10.m10.1a"><mi id="alg2.10.m10.1.1" xref="alg2.10.m10.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="alg2.10.m10.1b"><ci id="alg2.10.m10.1.1.cmml" xref="alg2.10.m10.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.10.m10.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="alg2.10.m10.1d">italic_β</annotation></semantics></math>, retriever loss <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="alg2.11.m11.1"><semantics id="alg2.11.m11.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.11.m11.1.1" xref="alg2.11.m11.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="alg2.11.m11.1b"><ci id="alg2.11.m11.1.1.cmml" xref="alg2.11.m11.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.11.m11.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="alg2.11.m11.1d">caligraphic_L</annotation></semantics></math>, reader loss <math alttext="\mathcal{L}^{\prime}" class="ltx_Math" display="inline" id="alg2.12.m12.1"><semantics id="alg2.12.m12.1a"><msup id="alg2.12.m12.1.1" xref="alg2.12.m12.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.12.m12.1.1.2" xref="alg2.12.m12.1.1.2.cmml">ℒ</mi><mo id="alg2.12.m12.1.1.3" xref="alg2.12.m12.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg2.12.m12.1b"><apply id="alg2.12.m12.1.1.cmml" xref="alg2.12.m12.1.1"><csymbol cd="ambiguous" id="alg2.12.m12.1.1.1.cmml" xref="alg2.12.m12.1.1">superscript</csymbol><ci id="alg2.12.m12.1.1.2.cmml" xref="alg2.12.m12.1.1.2">ℒ</ci><ci id="alg2.12.m12.1.1.3.cmml" xref="alg2.12.m12.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.12.m12.1c">\mathcal{L}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg2.12.m12.1d">caligraphic_L start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, corrector model loss <math alttext="\ell" class="ltx_Math" display="inline" id="alg2.13.m13.1"><semantics id="alg2.13.m13.1a"><mi id="alg2.13.m13.1.1" mathvariant="normal" xref="alg2.13.m13.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="alg2.13.m13.1b"><ci id="alg2.13.m13.1.1.cmml" xref="alg2.13.m13.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.13.m13.1c">\ell</annotation><annotation encoding="application/x-llamapun" id="alg2.13.m13.1d">roman_ℓ</annotation></semantics></math>, learning rate <math alttext="\eta" class="ltx_Math" display="inline" id="alg2.14.m14.1"><semantics id="alg2.14.m14.1a"><mi id="alg2.14.m14.1.1" xref="alg2.14.m14.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg2.14.m14.1b"><ci id="alg2.14.m14.1.1.cmml" xref="alg2.14.m14.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.14.m14.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="alg2.14.m14.1d">italic_η</annotation></semantics></math>, number of truncated samples <math alttext="k" class="ltx_Math" display="inline" id="alg2.15.m15.1"><semantics id="alg2.15.m15.1a"><mi id="alg2.15.m15.1.1" xref="alg2.15.m15.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg2.15.m15.1b"><ci id="alg2.15.m15.1.1.cmml" xref="alg2.15.m15.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.15.m15.1c">k</annotation><annotation encoding="application/x-llamapun" id="alg2.15.m15.1d">italic_k</annotation></semantics></math></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="alg2.39"><span class="ltx_text ltx_font_bold" id="alg2.39.1">while</span> <em class="ltx_emph ltx_font_italic" id="alg2.39.2"><em class="ltx_emph ltx_font_upright" id="alg2.39.2.1">Training</em></em> <span class="ltx_text ltx_font_bold" id="alg2.39.3">do</span> </p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel" id="alg2.40">
<div class="ltx_listingline" id="alg2.36">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
  Sample training data <math alttext="(x_{i},a)\sim X" class="ltx_Math" display="inline" id="alg2.16.m1.2"><semantics id="alg2.16.m1.2a"><mrow id="alg2.16.m1.2.2" xref="alg2.16.m1.2.2.cmml"><mrow id="alg2.16.m1.2.2.1.1" xref="alg2.16.m1.2.2.1.2.cmml"><mo id="alg2.16.m1.2.2.1.1.2" stretchy="false" xref="alg2.16.m1.2.2.1.2.cmml">(</mo><msub id="alg2.16.m1.2.2.1.1.1" xref="alg2.16.m1.2.2.1.1.1.cmml"><mi id="alg2.16.m1.2.2.1.1.1.2" xref="alg2.16.m1.2.2.1.1.1.2.cmml">x</mi><mi id="alg2.16.m1.2.2.1.1.1.3" xref="alg2.16.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo id="alg2.16.m1.2.2.1.1.3" xref="alg2.16.m1.2.2.1.2.cmml">,</mo><mi id="alg2.16.m1.1.1" xref="alg2.16.m1.1.1.cmml">a</mi><mo id="alg2.16.m1.2.2.1.1.4" stretchy="false" xref="alg2.16.m1.2.2.1.2.cmml">)</mo></mrow><mo id="alg2.16.m1.2.2.2" xref="alg2.16.m1.2.2.2.cmml">∼</mo><mi id="alg2.16.m1.2.2.3" xref="alg2.16.m1.2.2.3.cmml">X</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.16.m1.2b"><apply id="alg2.16.m1.2.2.cmml" xref="alg2.16.m1.2.2"><csymbol cd="latexml" id="alg2.16.m1.2.2.2.cmml" xref="alg2.16.m1.2.2.2">similar-to</csymbol><interval closure="open" id="alg2.16.m1.2.2.1.2.cmml" xref="alg2.16.m1.2.2.1.1"><apply id="alg2.16.m1.2.2.1.1.1.cmml" xref="alg2.16.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg2.16.m1.2.2.1.1.1.1.cmml" xref="alg2.16.m1.2.2.1.1.1">subscript</csymbol><ci id="alg2.16.m1.2.2.1.1.1.2.cmml" xref="alg2.16.m1.2.2.1.1.1.2">𝑥</ci><ci id="alg2.16.m1.2.2.1.1.1.3.cmml" xref="alg2.16.m1.2.2.1.1.1.3">𝑖</ci></apply><ci id="alg2.16.m1.1.1.cmml" xref="alg2.16.m1.1.1">𝑎</ci></interval><ci id="alg2.16.m1.2.2.3.cmml" xref="alg2.16.m1.2.2.3">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.16.m1.2c">(x_{i},a)\sim X</annotation><annotation encoding="application/x-llamapun" id="alg2.16.m1.2d">( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_a ) ∼ italic_X</annotation></semantics></math>
<br class="ltx_break"/>Compute <math alttext="h\circ g^{\prime}(y)" class="ltx_Math" display="inline" id="alg2.17.m2.1"><semantics id="alg2.17.m2.1a"><mrow id="alg2.17.m2.1.2" xref="alg2.17.m2.1.2.cmml"><mrow id="alg2.17.m2.1.2.2" xref="alg2.17.m2.1.2.2.cmml"><mi id="alg2.17.m2.1.2.2.2" xref="alg2.17.m2.1.2.2.2.cmml">h</mi><mo id="alg2.17.m2.1.2.2.1" lspace="0.222em" rspace="0.222em" xref="alg2.17.m2.1.2.2.1.cmml">∘</mo><msup id="alg2.17.m2.1.2.2.3" xref="alg2.17.m2.1.2.2.3.cmml"><mi id="alg2.17.m2.1.2.2.3.2" xref="alg2.17.m2.1.2.2.3.2.cmml">g</mi><mo id="alg2.17.m2.1.2.2.3.3" xref="alg2.17.m2.1.2.2.3.3.cmml">′</mo></msup></mrow><mo id="alg2.17.m2.1.2.1" xref="alg2.17.m2.1.2.1.cmml">⁢</mo><mrow id="alg2.17.m2.1.2.3.2" xref="alg2.17.m2.1.2.cmml"><mo id="alg2.17.m2.1.2.3.2.1" stretchy="false" xref="alg2.17.m2.1.2.cmml">(</mo><mi id="alg2.17.m2.1.1" xref="alg2.17.m2.1.1.cmml">y</mi><mo id="alg2.17.m2.1.2.3.2.2" stretchy="false" xref="alg2.17.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.17.m2.1b"><apply id="alg2.17.m2.1.2.cmml" xref="alg2.17.m2.1.2"><times id="alg2.17.m2.1.2.1.cmml" xref="alg2.17.m2.1.2.1"></times><apply id="alg2.17.m2.1.2.2.cmml" xref="alg2.17.m2.1.2.2"><compose id="alg2.17.m2.1.2.2.1.cmml" xref="alg2.17.m2.1.2.2.1"></compose><ci id="alg2.17.m2.1.2.2.2.cmml" xref="alg2.17.m2.1.2.2.2">ℎ</ci><apply id="alg2.17.m2.1.2.2.3.cmml" xref="alg2.17.m2.1.2.2.3"><csymbol cd="ambiguous" id="alg2.17.m2.1.2.2.3.1.cmml" xref="alg2.17.m2.1.2.2.3">superscript</csymbol><ci id="alg2.17.m2.1.2.2.3.2.cmml" xref="alg2.17.m2.1.2.2.3.2">𝑔</ci><ci id="alg2.17.m2.1.2.2.3.3.cmml" xref="alg2.17.m2.1.2.2.3.3">′</ci></apply></apply><ci id="alg2.17.m2.1.1.cmml" xref="alg2.17.m2.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.17.m2.1c">h\circ g^{\prime}(y)</annotation><annotation encoding="application/x-llamapun" id="alg2.17.m2.1d">italic_h ∘ italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y )</annotation></semantics></math> for all <math alttext="y\in\mathcal{Y}" class="ltx_Math" display="inline" id="alg2.18.m3.1"><semantics id="alg2.18.m3.1a"><mrow id="alg2.18.m3.1.1" xref="alg2.18.m3.1.1.cmml"><mi id="alg2.18.m3.1.1.2" xref="alg2.18.m3.1.1.2.cmml">y</mi><mo id="alg2.18.m3.1.1.1" xref="alg2.18.m3.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg2.18.m3.1.1.3" xref="alg2.18.m3.1.1.3.cmml">𝒴</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.18.m3.1b"><apply id="alg2.18.m3.1.1.cmml" xref="alg2.18.m3.1.1"><in id="alg2.18.m3.1.1.1.cmml" xref="alg2.18.m3.1.1.1"></in><ci id="alg2.18.m3.1.1.2.cmml" xref="alg2.18.m3.1.1.2">𝑦</ci><ci id="alg2.18.m3.1.1.3.cmml" xref="alg2.18.m3.1.1.3">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.18.m3.1c">y\in\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="alg2.18.m3.1d">italic_y ∈ caligraphic_Y</annotation></semantics></math> using the buffer <math alttext="B" class="ltx_Math" display="inline" id="alg2.19.m4.1"><semantics id="alg2.19.m4.1a"><mi id="alg2.19.m4.1.1" xref="alg2.19.m4.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg2.19.m4.1b"><ci id="alg2.19.m4.1.1.cmml" xref="alg2.19.m4.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.19.m4.1c">B</annotation><annotation encoding="application/x-llamapun" id="alg2.19.m4.1d">italic_B</annotation></semantics></math>
<br class="ltx_break"/>Set <math alttext="S_{x_{i}}(\mathcal{Y})" class="ltx_Math" display="inline" id="alg2.20.m5.1"><semantics id="alg2.20.m5.1a"><mrow id="alg2.20.m5.1.2" xref="alg2.20.m5.1.2.cmml"><msub id="alg2.20.m5.1.2.2" xref="alg2.20.m5.1.2.2.cmml"><mi id="alg2.20.m5.1.2.2.2" xref="alg2.20.m5.1.2.2.2.cmml">S</mi><msub id="alg2.20.m5.1.2.2.3" xref="alg2.20.m5.1.2.2.3.cmml"><mi id="alg2.20.m5.1.2.2.3.2" xref="alg2.20.m5.1.2.2.3.2.cmml">x</mi><mi id="alg2.20.m5.1.2.2.3.3" xref="alg2.20.m5.1.2.2.3.3.cmml">i</mi></msub></msub><mo id="alg2.20.m5.1.2.1" xref="alg2.20.m5.1.2.1.cmml">⁢</mo><mrow id="alg2.20.m5.1.2.3.2" xref="alg2.20.m5.1.2.cmml"><mo id="alg2.20.m5.1.2.3.2.1" stretchy="false" xref="alg2.20.m5.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg2.20.m5.1.1" xref="alg2.20.m5.1.1.cmml">𝒴</mi><mo id="alg2.20.m5.1.2.3.2.2" stretchy="false" xref="alg2.20.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.20.m5.1b"><apply id="alg2.20.m5.1.2.cmml" xref="alg2.20.m5.1.2"><times id="alg2.20.m5.1.2.1.cmml" xref="alg2.20.m5.1.2.1"></times><apply id="alg2.20.m5.1.2.2.cmml" xref="alg2.20.m5.1.2.2"><csymbol cd="ambiguous" id="alg2.20.m5.1.2.2.1.cmml" xref="alg2.20.m5.1.2.2">subscript</csymbol><ci id="alg2.20.m5.1.2.2.2.cmml" xref="alg2.20.m5.1.2.2.2">𝑆</ci><apply id="alg2.20.m5.1.2.2.3.cmml" xref="alg2.20.m5.1.2.2.3"><csymbol cd="ambiguous" id="alg2.20.m5.1.2.2.3.1.cmml" xref="alg2.20.m5.1.2.2.3">subscript</csymbol><ci id="alg2.20.m5.1.2.2.3.2.cmml" xref="alg2.20.m5.1.2.2.3.2">𝑥</ci><ci id="alg2.20.m5.1.2.2.3.3.cmml" xref="alg2.20.m5.1.2.2.3.3">𝑖</ci></apply></apply><ci id="alg2.20.m5.1.1.cmml" xref="alg2.20.m5.1.1">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.20.m5.1c">S_{x_{i}}(\mathcal{Y})</annotation><annotation encoding="application/x-llamapun" id="alg2.20.m5.1d">italic_S start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( caligraphic_Y )</annotation></semantics></math> using <math alttext="\exp(\beta f(x_{i})^{T}h\circ g^{\prime}(y))" class="ltx_Math" display="inline" id="alg2.21.m6.3"><semantics id="alg2.21.m6.3a"><mrow id="alg2.21.m6.3.3.1" xref="alg2.21.m6.3.3.2.cmml"><mi id="alg2.21.m6.2.2" xref="alg2.21.m6.2.2.cmml">exp</mi><mo id="alg2.21.m6.3.3.1a" xref="alg2.21.m6.3.3.2.cmml">⁡</mo><mrow id="alg2.21.m6.3.3.1.1" xref="alg2.21.m6.3.3.2.cmml"><mo id="alg2.21.m6.3.3.1.1.2" stretchy="false" xref="alg2.21.m6.3.3.2.cmml">(</mo><mrow id="alg2.21.m6.3.3.1.1.1" xref="alg2.21.m6.3.3.1.1.1.cmml"><mrow id="alg2.21.m6.3.3.1.1.1.1" xref="alg2.21.m6.3.3.1.1.1.1.cmml"><mrow id="alg2.21.m6.3.3.1.1.1.1.1" xref="alg2.21.m6.3.3.1.1.1.1.1.cmml"><mi id="alg2.21.m6.3.3.1.1.1.1.1.3" xref="alg2.21.m6.3.3.1.1.1.1.1.3.cmml">β</mi><mo id="alg2.21.m6.3.3.1.1.1.1.1.2" xref="alg2.21.m6.3.3.1.1.1.1.1.2.cmml">⁢</mo><mi id="alg2.21.m6.3.3.1.1.1.1.1.4" xref="alg2.21.m6.3.3.1.1.1.1.1.4.cmml">f</mi><mo id="alg2.21.m6.3.3.1.1.1.1.1.2a" xref="alg2.21.m6.3.3.1.1.1.1.1.2.cmml">⁢</mo><msup id="alg2.21.m6.3.3.1.1.1.1.1.1" xref="alg2.21.m6.3.3.1.1.1.1.1.1.cmml"><mrow id="alg2.21.m6.3.3.1.1.1.1.1.1.1.1" xref="alg2.21.m6.3.3.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg2.21.m6.3.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="alg2.21.m6.3.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg2.21.m6.3.3.1.1.1.1.1.1.1.1.1" xref="alg2.21.m6.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg2.21.m6.3.3.1.1.1.1.1.1.1.1.1.2" xref="alg2.21.m6.3.3.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="alg2.21.m6.3.3.1.1.1.1.1.1.1.1.1.3" xref="alg2.21.m6.3.3.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg2.21.m6.3.3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="alg2.21.m6.3.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="alg2.21.m6.3.3.1.1.1.1.1.1.3" xref="alg2.21.m6.3.3.1.1.1.1.1.1.3.cmml">T</mi></msup><mo id="alg2.21.m6.3.3.1.1.1.1.1.2b" xref="alg2.21.m6.3.3.1.1.1.1.1.2.cmml">⁢</mo><mi id="alg2.21.m6.3.3.1.1.1.1.1.5" xref="alg2.21.m6.3.3.1.1.1.1.1.5.cmml">h</mi></mrow><mo id="alg2.21.m6.3.3.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="alg2.21.m6.3.3.1.1.1.1.2.cmml">∘</mo><msup id="alg2.21.m6.3.3.1.1.1.1.3" xref="alg2.21.m6.3.3.1.1.1.1.3.cmml"><mi id="alg2.21.m6.3.3.1.1.1.1.3.2" xref="alg2.21.m6.3.3.1.1.1.1.3.2.cmml">g</mi><mo id="alg2.21.m6.3.3.1.1.1.1.3.3" xref="alg2.21.m6.3.3.1.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="alg2.21.m6.3.3.1.1.1.2" xref="alg2.21.m6.3.3.1.1.1.2.cmml">⁢</mo><mrow id="alg2.21.m6.3.3.1.1.1.3.2" xref="alg2.21.m6.3.3.1.1.1.cmml"><mo id="alg2.21.m6.3.3.1.1.1.3.2.1" stretchy="false" xref="alg2.21.m6.3.3.1.1.1.cmml">(</mo><mi id="alg2.21.m6.1.1" xref="alg2.21.m6.1.1.cmml">y</mi><mo id="alg2.21.m6.3.3.1.1.1.3.2.2" stretchy="false" xref="alg2.21.m6.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.21.m6.3.3.1.1.3" stretchy="false" xref="alg2.21.m6.3.3.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.21.m6.3b"><apply id="alg2.21.m6.3.3.2.cmml" xref="alg2.21.m6.3.3.1"><exp id="alg2.21.m6.2.2.cmml" xref="alg2.21.m6.2.2"></exp><apply id="alg2.21.m6.3.3.1.1.1.cmml" xref="alg2.21.m6.3.3.1.1.1"><times id="alg2.21.m6.3.3.1.1.1.2.cmml" xref="alg2.21.m6.3.3.1.1.1.2"></times><apply id="alg2.21.m6.3.3.1.1.1.1.cmml" xref="alg2.21.m6.3.3.1.1.1.1"><compose id="alg2.21.m6.3.3.1.1.1.1.2.cmml" xref="alg2.21.m6.3.3.1.1.1.1.2"></compose><apply id="alg2.21.m6.3.3.1.1.1.1.1.cmml" xref="alg2.21.m6.3.3.1.1.1.1.1"><times id="alg2.21.m6.3.3.1.1.1.1.1.2.cmml" xref="alg2.21.m6.3.3.1.1.1.1.1.2"></times><ci id="alg2.21.m6.3.3.1.1.1.1.1.3.cmml" xref="alg2.21.m6.3.3.1.1.1.1.1.3">𝛽</ci><ci id="alg2.21.m6.3.3.1.1.1.1.1.4.cmml" xref="alg2.21.m6.3.3.1.1.1.1.1.4">𝑓</ci><apply id="alg2.21.m6.3.3.1.1.1.1.1.1.cmml" xref="alg2.21.m6.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.21.m6.3.3.1.1.1.1.1.1.2.cmml" xref="alg2.21.m6.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="alg2.21.m6.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.21.m6.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.21.m6.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.21.m6.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.21.m6.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.21.m6.3.3.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="alg2.21.m6.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.21.m6.3.3.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="alg2.21.m6.3.3.1.1.1.1.1.1.3.cmml" xref="alg2.21.m6.3.3.1.1.1.1.1.1.3">𝑇</ci></apply><ci id="alg2.21.m6.3.3.1.1.1.1.1.5.cmml" xref="alg2.21.m6.3.3.1.1.1.1.1.5">ℎ</ci></apply><apply id="alg2.21.m6.3.3.1.1.1.1.3.cmml" xref="alg2.21.m6.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.21.m6.3.3.1.1.1.1.3.1.cmml" xref="alg2.21.m6.3.3.1.1.1.1.3">superscript</csymbol><ci id="alg2.21.m6.3.3.1.1.1.1.3.2.cmml" xref="alg2.21.m6.3.3.1.1.1.1.3.2">𝑔</ci><ci id="alg2.21.m6.3.3.1.1.1.1.3.3.cmml" xref="alg2.21.m6.3.3.1.1.1.1.3.3">′</ci></apply></apply><ci id="alg2.21.m6.1.1.cmml" xref="alg2.21.m6.1.1">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.21.m6.3c">\exp(\beta f(x_{i})^{T}h\circ g^{\prime}(y))</annotation><annotation encoding="application/x-llamapun" id="alg2.21.m6.3d">roman_exp ( italic_β italic_f ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_h ∘ italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y ) )</annotation></semantics></math> via top-<math alttext="k" class="ltx_Math" display="inline" id="alg2.22.m7.1"><semantics id="alg2.22.m7.1a"><mi id="alg2.22.m7.1.1" xref="alg2.22.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg2.22.m7.1b"><ci id="alg2.22.m7.1.1.cmml" xref="alg2.22.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.22.m7.1c">k</annotation><annotation encoding="application/x-llamapun" id="alg2.22.m7.1d">italic_k</annotation></semantics></math>
<br class="ltx_break"/>Define <math alttext="\tilde{P}(y|x_{i})=\frac{\exp(\beta f(x_{i})^{T}g(y))}{\sum_{y^{\prime}\in S_{%
x_{i}}(\mathcal{Y})}\exp(\beta f(x_{i})^{T}g(y^{\prime}))}" class="ltx_Math" display="inline" id="alg2.23.m8.7"><semantics id="alg2.23.m8.7a"><mrow id="alg2.23.m8.7.7" xref="alg2.23.m8.7.7.cmml"><mrow id="alg2.23.m8.7.7.1" xref="alg2.23.m8.7.7.1.cmml"><mover accent="true" id="alg2.23.m8.7.7.1.3" xref="alg2.23.m8.7.7.1.3.cmml"><mi id="alg2.23.m8.7.7.1.3.2" xref="alg2.23.m8.7.7.1.3.2.cmml">P</mi><mo id="alg2.23.m8.7.7.1.3.1" xref="alg2.23.m8.7.7.1.3.1.cmml">~</mo></mover><mo id="alg2.23.m8.7.7.1.2" xref="alg2.23.m8.7.7.1.2.cmml">⁢</mo><mrow id="alg2.23.m8.7.7.1.1.1" xref="alg2.23.m8.7.7.1.1.1.1.cmml"><mo id="alg2.23.m8.7.7.1.1.1.2" stretchy="false" xref="alg2.23.m8.7.7.1.1.1.1.cmml">(</mo><mrow id="alg2.23.m8.7.7.1.1.1.1" xref="alg2.23.m8.7.7.1.1.1.1.cmml"><mi id="alg2.23.m8.7.7.1.1.1.1.2" xref="alg2.23.m8.7.7.1.1.1.1.2.cmml">y</mi><mo fence="false" id="alg2.23.m8.7.7.1.1.1.1.1" xref="alg2.23.m8.7.7.1.1.1.1.1.cmml">|</mo><msub id="alg2.23.m8.7.7.1.1.1.1.3" xref="alg2.23.m8.7.7.1.1.1.1.3.cmml"><mi id="alg2.23.m8.7.7.1.1.1.1.3.2" xref="alg2.23.m8.7.7.1.1.1.1.3.2.cmml">x</mi><mi id="alg2.23.m8.7.7.1.1.1.1.3.3" xref="alg2.23.m8.7.7.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="alg2.23.m8.7.7.1.1.1.3" stretchy="false" xref="alg2.23.m8.7.7.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.23.m8.7.7.2" xref="alg2.23.m8.7.7.2.cmml">=</mo><mfrac id="alg2.23.m8.6.6" xref="alg2.23.m8.6.6.cmml"><mrow id="alg2.23.m8.3.3.3.3" xref="alg2.23.m8.3.3.3.4.cmml"><mi id="alg2.23.m8.2.2.2.2" xref="alg2.23.m8.2.2.2.2.cmml">exp</mi><mo id="alg2.23.m8.3.3.3.3a" xref="alg2.23.m8.3.3.3.4.cmml">⁡</mo><mrow id="alg2.23.m8.3.3.3.3.1" xref="alg2.23.m8.3.3.3.4.cmml"><mo id="alg2.23.m8.3.3.3.3.1.2" stretchy="false" xref="alg2.23.m8.3.3.3.4.cmml">(</mo><mrow id="alg2.23.m8.3.3.3.3.1.1" xref="alg2.23.m8.3.3.3.3.1.1.cmml"><mi id="alg2.23.m8.3.3.3.3.1.1.3" xref="alg2.23.m8.3.3.3.3.1.1.3.cmml">β</mi><mo id="alg2.23.m8.3.3.3.3.1.1.2" xref="alg2.23.m8.3.3.3.3.1.1.2.cmml">⁢</mo><mi id="alg2.23.m8.3.3.3.3.1.1.4" xref="alg2.23.m8.3.3.3.3.1.1.4.cmml">f</mi><mo id="alg2.23.m8.3.3.3.3.1.1.2a" xref="alg2.23.m8.3.3.3.3.1.1.2.cmml">⁢</mo><msup id="alg2.23.m8.3.3.3.3.1.1.1" xref="alg2.23.m8.3.3.3.3.1.1.1.cmml"><mrow id="alg2.23.m8.3.3.3.3.1.1.1.1.1" xref="alg2.23.m8.3.3.3.3.1.1.1.1.1.1.cmml"><mo id="alg2.23.m8.3.3.3.3.1.1.1.1.1.2" stretchy="false" xref="alg2.23.m8.3.3.3.3.1.1.1.1.1.1.cmml">(</mo><msub id="alg2.23.m8.3.3.3.3.1.1.1.1.1.1" xref="alg2.23.m8.3.3.3.3.1.1.1.1.1.1.cmml"><mi id="alg2.23.m8.3.3.3.3.1.1.1.1.1.1.2" xref="alg2.23.m8.3.3.3.3.1.1.1.1.1.1.2.cmml">x</mi><mi id="alg2.23.m8.3.3.3.3.1.1.1.1.1.1.3" xref="alg2.23.m8.3.3.3.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg2.23.m8.3.3.3.3.1.1.1.1.1.3" stretchy="false" xref="alg2.23.m8.3.3.3.3.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="alg2.23.m8.3.3.3.3.1.1.1.3" xref="alg2.23.m8.3.3.3.3.1.1.1.3.cmml">T</mi></msup><mo id="alg2.23.m8.3.3.3.3.1.1.2b" xref="alg2.23.m8.3.3.3.3.1.1.2.cmml">⁢</mo><mi id="alg2.23.m8.3.3.3.3.1.1.5" xref="alg2.23.m8.3.3.3.3.1.1.5.cmml">g</mi><mo id="alg2.23.m8.3.3.3.3.1.1.2c" xref="alg2.23.m8.3.3.3.3.1.1.2.cmml">⁢</mo><mrow id="alg2.23.m8.3.3.3.3.1.1.6.2" xref="alg2.23.m8.3.3.3.3.1.1.cmml"><mo id="alg2.23.m8.3.3.3.3.1.1.6.2.1" stretchy="false" xref="alg2.23.m8.3.3.3.3.1.1.cmml">(</mo><mi id="alg2.23.m8.1.1.1.1" xref="alg2.23.m8.1.1.1.1.cmml">y</mi><mo id="alg2.23.m8.3.3.3.3.1.1.6.2.2" stretchy="false" xref="alg2.23.m8.3.3.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.23.m8.3.3.3.3.1.3" stretchy="false" xref="alg2.23.m8.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="alg2.23.m8.6.6.6" xref="alg2.23.m8.6.6.6.cmml"><mstyle displaystyle="false" id="alg2.23.m8.6.6.6.4" xref="alg2.23.m8.6.6.6.4.cmml"><msub id="alg2.23.m8.6.6.6.4a" xref="alg2.23.m8.6.6.6.4.cmml"><mo id="alg2.23.m8.6.6.6.4.2" xref="alg2.23.m8.6.6.6.4.2.cmml">∑</mo><mrow id="alg2.23.m8.4.4.4.1.1" xref="alg2.23.m8.4.4.4.1.1.cmml"><msup id="alg2.23.m8.4.4.4.1.1.3" xref="alg2.23.m8.4.4.4.1.1.3.cmml"><mi id="alg2.23.m8.4.4.4.1.1.3.2" xref="alg2.23.m8.4.4.4.1.1.3.2.cmml">y</mi><mo id="alg2.23.m8.4.4.4.1.1.3.3" xref="alg2.23.m8.4.4.4.1.1.3.3.cmml">′</mo></msup><mo id="alg2.23.m8.4.4.4.1.1.2" xref="alg2.23.m8.4.4.4.1.1.2.cmml">∈</mo><mrow id="alg2.23.m8.4.4.4.1.1.4" xref="alg2.23.m8.4.4.4.1.1.4.cmml"><msub id="alg2.23.m8.4.4.4.1.1.4.2" xref="alg2.23.m8.4.4.4.1.1.4.2.cmml"><mi id="alg2.23.m8.4.4.4.1.1.4.2.2" xref="alg2.23.m8.4.4.4.1.1.4.2.2.cmml">S</mi><msub id="alg2.23.m8.4.4.4.1.1.4.2.3" xref="alg2.23.m8.4.4.4.1.1.4.2.3.cmml"><mi id="alg2.23.m8.4.4.4.1.1.4.2.3.2" xref="alg2.23.m8.4.4.4.1.1.4.2.3.2.cmml">x</mi><mi id="alg2.23.m8.4.4.4.1.1.4.2.3.3" xref="alg2.23.m8.4.4.4.1.1.4.2.3.3.cmml">i</mi></msub></msub><mo id="alg2.23.m8.4.4.4.1.1.4.1" xref="alg2.23.m8.4.4.4.1.1.4.1.cmml">⁢</mo><mrow id="alg2.23.m8.4.4.4.1.1.4.3.2" xref="alg2.23.m8.4.4.4.1.1.4.cmml"><mo id="alg2.23.m8.4.4.4.1.1.4.3.2.1" stretchy="false" xref="alg2.23.m8.4.4.4.1.1.4.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg2.23.m8.4.4.4.1.1.1" xref="alg2.23.m8.4.4.4.1.1.1.cmml">𝒴</mi><mo id="alg2.23.m8.4.4.4.1.1.4.3.2.2" stretchy="false" xref="alg2.23.m8.4.4.4.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub></mstyle><mrow id="alg2.23.m8.6.6.6.3.1" xref="alg2.23.m8.6.6.6.3.2.cmml"><mi id="alg2.23.m8.5.5.5.2" xref="alg2.23.m8.5.5.5.2.cmml">exp</mi><mo id="alg2.23.m8.6.6.6.3.1a" xref="alg2.23.m8.6.6.6.3.2.cmml">⁡</mo><mrow id="alg2.23.m8.6.6.6.3.1.1" xref="alg2.23.m8.6.6.6.3.2.cmml"><mo id="alg2.23.m8.6.6.6.3.1.1.2" stretchy="false" xref="alg2.23.m8.6.6.6.3.2.cmml">(</mo><mrow id="alg2.23.m8.6.6.6.3.1.1.1" xref="alg2.23.m8.6.6.6.3.1.1.1.cmml"><mi id="alg2.23.m8.6.6.6.3.1.1.1.4" xref="alg2.23.m8.6.6.6.3.1.1.1.4.cmml">β</mi><mo id="alg2.23.m8.6.6.6.3.1.1.1.3" xref="alg2.23.m8.6.6.6.3.1.1.1.3.cmml">⁢</mo><mi id="alg2.23.m8.6.6.6.3.1.1.1.5" xref="alg2.23.m8.6.6.6.3.1.1.1.5.cmml">f</mi><mo id="alg2.23.m8.6.6.6.3.1.1.1.3a" xref="alg2.23.m8.6.6.6.3.1.1.1.3.cmml">⁢</mo><msup id="alg2.23.m8.6.6.6.3.1.1.1.1" xref="alg2.23.m8.6.6.6.3.1.1.1.1.cmml"><mrow id="alg2.23.m8.6.6.6.3.1.1.1.1.1.1" xref="alg2.23.m8.6.6.6.3.1.1.1.1.1.1.1.cmml"><mo id="alg2.23.m8.6.6.6.3.1.1.1.1.1.1.2" stretchy="false" xref="alg2.23.m8.6.6.6.3.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg2.23.m8.6.6.6.3.1.1.1.1.1.1.1" xref="alg2.23.m8.6.6.6.3.1.1.1.1.1.1.1.cmml"><mi id="alg2.23.m8.6.6.6.3.1.1.1.1.1.1.1.2" xref="alg2.23.m8.6.6.6.3.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="alg2.23.m8.6.6.6.3.1.1.1.1.1.1.1.3" xref="alg2.23.m8.6.6.6.3.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg2.23.m8.6.6.6.3.1.1.1.1.1.1.3" stretchy="false" xref="alg2.23.m8.6.6.6.3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="alg2.23.m8.6.6.6.3.1.1.1.1.3" xref="alg2.23.m8.6.6.6.3.1.1.1.1.3.cmml">T</mi></msup><mo id="alg2.23.m8.6.6.6.3.1.1.1.3b" xref="alg2.23.m8.6.6.6.3.1.1.1.3.cmml">⁢</mo><mi id="alg2.23.m8.6.6.6.3.1.1.1.6" xref="alg2.23.m8.6.6.6.3.1.1.1.6.cmml">g</mi><mo id="alg2.23.m8.6.6.6.3.1.1.1.3c" xref="alg2.23.m8.6.6.6.3.1.1.1.3.cmml">⁢</mo><mrow id="alg2.23.m8.6.6.6.3.1.1.1.2.1" xref="alg2.23.m8.6.6.6.3.1.1.1.2.1.1.cmml"><mo id="alg2.23.m8.6.6.6.3.1.1.1.2.1.2" stretchy="false" xref="alg2.23.m8.6.6.6.3.1.1.1.2.1.1.cmml">(</mo><msup id="alg2.23.m8.6.6.6.3.1.1.1.2.1.1" xref="alg2.23.m8.6.6.6.3.1.1.1.2.1.1.cmml"><mi id="alg2.23.m8.6.6.6.3.1.1.1.2.1.1.2" xref="alg2.23.m8.6.6.6.3.1.1.1.2.1.1.2.cmml">y</mi><mo id="alg2.23.m8.6.6.6.3.1.1.1.2.1.1.3" xref="alg2.23.m8.6.6.6.3.1.1.1.2.1.1.3.cmml">′</mo></msup><mo id="alg2.23.m8.6.6.6.3.1.1.1.2.1.3" stretchy="false" xref="alg2.23.m8.6.6.6.3.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.23.m8.6.6.6.3.1.1.3" stretchy="false" xref="alg2.23.m8.6.6.6.3.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg2.23.m8.7b"><apply id="alg2.23.m8.7.7.cmml" xref="alg2.23.m8.7.7"><eq id="alg2.23.m8.7.7.2.cmml" xref="alg2.23.m8.7.7.2"></eq><apply id="alg2.23.m8.7.7.1.cmml" xref="alg2.23.m8.7.7.1"><times id="alg2.23.m8.7.7.1.2.cmml" xref="alg2.23.m8.7.7.1.2"></times><apply id="alg2.23.m8.7.7.1.3.cmml" xref="alg2.23.m8.7.7.1.3"><ci id="alg2.23.m8.7.7.1.3.1.cmml" xref="alg2.23.m8.7.7.1.3.1">~</ci><ci id="alg2.23.m8.7.7.1.3.2.cmml" xref="alg2.23.m8.7.7.1.3.2">𝑃</ci></apply><apply id="alg2.23.m8.7.7.1.1.1.1.cmml" xref="alg2.23.m8.7.7.1.1.1"><csymbol cd="latexml" id="alg2.23.m8.7.7.1.1.1.1.1.cmml" xref="alg2.23.m8.7.7.1.1.1.1.1">conditional</csymbol><ci id="alg2.23.m8.7.7.1.1.1.1.2.cmml" xref="alg2.23.m8.7.7.1.1.1.1.2">𝑦</ci><apply id="alg2.23.m8.7.7.1.1.1.1.3.cmml" xref="alg2.23.m8.7.7.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.23.m8.7.7.1.1.1.1.3.1.cmml" xref="alg2.23.m8.7.7.1.1.1.1.3">subscript</csymbol><ci id="alg2.23.m8.7.7.1.1.1.1.3.2.cmml" xref="alg2.23.m8.7.7.1.1.1.1.3.2">𝑥</ci><ci id="alg2.23.m8.7.7.1.1.1.1.3.3.cmml" xref="alg2.23.m8.7.7.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><apply id="alg2.23.m8.6.6.cmml" xref="alg2.23.m8.6.6"><divide id="alg2.23.m8.6.6.7.cmml" xref="alg2.23.m8.6.6"></divide><apply id="alg2.23.m8.3.3.3.4.cmml" xref="alg2.23.m8.3.3.3.3"><exp id="alg2.23.m8.2.2.2.2.cmml" xref="alg2.23.m8.2.2.2.2"></exp><apply id="alg2.23.m8.3.3.3.3.1.1.cmml" xref="alg2.23.m8.3.3.3.3.1.1"><times id="alg2.23.m8.3.3.3.3.1.1.2.cmml" xref="alg2.23.m8.3.3.3.3.1.1.2"></times><ci id="alg2.23.m8.3.3.3.3.1.1.3.cmml" xref="alg2.23.m8.3.3.3.3.1.1.3">𝛽</ci><ci id="alg2.23.m8.3.3.3.3.1.1.4.cmml" xref="alg2.23.m8.3.3.3.3.1.1.4">𝑓</ci><apply id="alg2.23.m8.3.3.3.3.1.1.1.cmml" xref="alg2.23.m8.3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="alg2.23.m8.3.3.3.3.1.1.1.2.cmml" xref="alg2.23.m8.3.3.3.3.1.1.1">superscript</csymbol><apply id="alg2.23.m8.3.3.3.3.1.1.1.1.1.1.cmml" xref="alg2.23.m8.3.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.23.m8.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="alg2.23.m8.3.3.3.3.1.1.1.1.1">subscript</csymbol><ci id="alg2.23.m8.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="alg2.23.m8.3.3.3.3.1.1.1.1.1.1.2">𝑥</ci><ci id="alg2.23.m8.3.3.3.3.1.1.1.1.1.1.3.cmml" xref="alg2.23.m8.3.3.3.3.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="alg2.23.m8.3.3.3.3.1.1.1.3.cmml" xref="alg2.23.m8.3.3.3.3.1.1.1.3">𝑇</ci></apply><ci id="alg2.23.m8.3.3.3.3.1.1.5.cmml" xref="alg2.23.m8.3.3.3.3.1.1.5">𝑔</ci><ci id="alg2.23.m8.1.1.1.1.cmml" xref="alg2.23.m8.1.1.1.1">𝑦</ci></apply></apply><apply id="alg2.23.m8.6.6.6.cmml" xref="alg2.23.m8.6.6.6"><apply id="alg2.23.m8.6.6.6.4.cmml" xref="alg2.23.m8.6.6.6.4"><csymbol cd="ambiguous" id="alg2.23.m8.6.6.6.4.1.cmml" xref="alg2.23.m8.6.6.6.4">subscript</csymbol><sum id="alg2.23.m8.6.6.6.4.2.cmml" xref="alg2.23.m8.6.6.6.4.2"></sum><apply id="alg2.23.m8.4.4.4.1.1.cmml" xref="alg2.23.m8.4.4.4.1.1"><in id="alg2.23.m8.4.4.4.1.1.2.cmml" xref="alg2.23.m8.4.4.4.1.1.2"></in><apply id="alg2.23.m8.4.4.4.1.1.3.cmml" xref="alg2.23.m8.4.4.4.1.1.3"><csymbol cd="ambiguous" id="alg2.23.m8.4.4.4.1.1.3.1.cmml" xref="alg2.23.m8.4.4.4.1.1.3">superscript</csymbol><ci id="alg2.23.m8.4.4.4.1.1.3.2.cmml" xref="alg2.23.m8.4.4.4.1.1.3.2">𝑦</ci><ci id="alg2.23.m8.4.4.4.1.1.3.3.cmml" xref="alg2.23.m8.4.4.4.1.1.3.3">′</ci></apply><apply id="alg2.23.m8.4.4.4.1.1.4.cmml" xref="alg2.23.m8.4.4.4.1.1.4"><times id="alg2.23.m8.4.4.4.1.1.4.1.cmml" xref="alg2.23.m8.4.4.4.1.1.4.1"></times><apply id="alg2.23.m8.4.4.4.1.1.4.2.cmml" xref="alg2.23.m8.4.4.4.1.1.4.2"><csymbol cd="ambiguous" id="alg2.23.m8.4.4.4.1.1.4.2.1.cmml" xref="alg2.23.m8.4.4.4.1.1.4.2">subscript</csymbol><ci id="alg2.23.m8.4.4.4.1.1.4.2.2.cmml" xref="alg2.23.m8.4.4.4.1.1.4.2.2">𝑆</ci><apply id="alg2.23.m8.4.4.4.1.1.4.2.3.cmml" xref="alg2.23.m8.4.4.4.1.1.4.2.3"><csymbol cd="ambiguous" id="alg2.23.m8.4.4.4.1.1.4.2.3.1.cmml" xref="alg2.23.m8.4.4.4.1.1.4.2.3">subscript</csymbol><ci id="alg2.23.m8.4.4.4.1.1.4.2.3.2.cmml" xref="alg2.23.m8.4.4.4.1.1.4.2.3.2">𝑥</ci><ci id="alg2.23.m8.4.4.4.1.1.4.2.3.3.cmml" xref="alg2.23.m8.4.4.4.1.1.4.2.3.3">𝑖</ci></apply></apply><ci id="alg2.23.m8.4.4.4.1.1.1.cmml" xref="alg2.23.m8.4.4.4.1.1.1">𝒴</ci></apply></apply></apply><apply id="alg2.23.m8.6.6.6.3.2.cmml" xref="alg2.23.m8.6.6.6.3.1"><exp id="alg2.23.m8.5.5.5.2.cmml" xref="alg2.23.m8.5.5.5.2"></exp><apply id="alg2.23.m8.6.6.6.3.1.1.1.cmml" xref="alg2.23.m8.6.6.6.3.1.1.1"><times id="alg2.23.m8.6.6.6.3.1.1.1.3.cmml" xref="alg2.23.m8.6.6.6.3.1.1.1.3"></times><ci id="alg2.23.m8.6.6.6.3.1.1.1.4.cmml" xref="alg2.23.m8.6.6.6.3.1.1.1.4">𝛽</ci><ci id="alg2.23.m8.6.6.6.3.1.1.1.5.cmml" xref="alg2.23.m8.6.6.6.3.1.1.1.5">𝑓</ci><apply id="alg2.23.m8.6.6.6.3.1.1.1.1.cmml" xref="alg2.23.m8.6.6.6.3.1.1.1.1"><csymbol cd="ambiguous" id="alg2.23.m8.6.6.6.3.1.1.1.1.2.cmml" xref="alg2.23.m8.6.6.6.3.1.1.1.1">superscript</csymbol><apply id="alg2.23.m8.6.6.6.3.1.1.1.1.1.1.1.cmml" xref="alg2.23.m8.6.6.6.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.23.m8.6.6.6.3.1.1.1.1.1.1.1.1.cmml" xref="alg2.23.m8.6.6.6.3.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.23.m8.6.6.6.3.1.1.1.1.1.1.1.2.cmml" xref="alg2.23.m8.6.6.6.3.1.1.1.1.1.1.1.2">𝑥</ci><ci id="alg2.23.m8.6.6.6.3.1.1.1.1.1.1.1.3.cmml" xref="alg2.23.m8.6.6.6.3.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="alg2.23.m8.6.6.6.3.1.1.1.1.3.cmml" xref="alg2.23.m8.6.6.6.3.1.1.1.1.3">𝑇</ci></apply><ci id="alg2.23.m8.6.6.6.3.1.1.1.6.cmml" xref="alg2.23.m8.6.6.6.3.1.1.1.6">𝑔</ci><apply id="alg2.23.m8.6.6.6.3.1.1.1.2.1.1.cmml" xref="alg2.23.m8.6.6.6.3.1.1.1.2.1"><csymbol cd="ambiguous" id="alg2.23.m8.6.6.6.3.1.1.1.2.1.1.1.cmml" xref="alg2.23.m8.6.6.6.3.1.1.1.2.1">superscript</csymbol><ci id="alg2.23.m8.6.6.6.3.1.1.1.2.1.1.2.cmml" xref="alg2.23.m8.6.6.6.3.1.1.1.2.1.1.2">𝑦</ci><ci id="alg2.23.m8.6.6.6.3.1.1.1.2.1.1.3.cmml" xref="alg2.23.m8.6.6.6.3.1.1.1.2.1.1.3">′</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.23.m8.7c">\tilde{P}(y|x_{i})=\frac{\exp(\beta f(x_{i})^{T}g(y))}{\sum_{y^{\prime}\in S_{%
x_{i}}(\mathcal{Y})}\exp(\beta f(x_{i})^{T}g(y^{\prime}))}</annotation><annotation encoding="application/x-llamapun" id="alg2.23.m8.7d">over~ start_ARG italic_P end_ARG ( italic_y | italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = divide start_ARG roman_exp ( italic_β italic_f ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_g ( italic_y ) ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ italic_S start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( caligraphic_Y ) end_POSTSUBSCRIPT roman_exp ( italic_β italic_f ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_g ( italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ) end_ARG</annotation></semantics></math>
<br class="ltx_break"/>Define <math alttext="{\tilde{P}_{h}(y|x_{i})=\frac{\exp(\beta f(x_{i})^{T}h\circ g^{\prime}(y))}{%
\sum_{y^{\prime}\in S_{x_{i}}(\mathcal{Y})}\exp(\beta f(x_{i})^{T}h\circ g^{%
\prime}(y^{\prime}))}}" class="ltx_Math" display="inline" id="alg2.24.m9.7"><semantics id="alg2.24.m9.7a"><mrow id="alg2.24.m9.7.7" xref="alg2.24.m9.7.7.cmml"><mrow id="alg2.24.m9.7.7.1" xref="alg2.24.m9.7.7.1.cmml"><msub id="alg2.24.m9.7.7.1.3" xref="alg2.24.m9.7.7.1.3.cmml"><mover accent="true" id="alg2.24.m9.7.7.1.3.2" xref="alg2.24.m9.7.7.1.3.2.cmml"><mi id="alg2.24.m9.7.7.1.3.2.2" xref="alg2.24.m9.7.7.1.3.2.2.cmml">P</mi><mo id="alg2.24.m9.7.7.1.3.2.1" xref="alg2.24.m9.7.7.1.3.2.1.cmml">~</mo></mover><mi id="alg2.24.m9.7.7.1.3.3" xref="alg2.24.m9.7.7.1.3.3.cmml">h</mi></msub><mo id="alg2.24.m9.7.7.1.2" xref="alg2.24.m9.7.7.1.2.cmml">⁢</mo><mrow id="alg2.24.m9.7.7.1.1.1" xref="alg2.24.m9.7.7.1.1.1.1.cmml"><mo id="alg2.24.m9.7.7.1.1.1.2" stretchy="false" xref="alg2.24.m9.7.7.1.1.1.1.cmml">(</mo><mrow id="alg2.24.m9.7.7.1.1.1.1" xref="alg2.24.m9.7.7.1.1.1.1.cmml"><mi id="alg2.24.m9.7.7.1.1.1.1.2" xref="alg2.24.m9.7.7.1.1.1.1.2.cmml">y</mi><mo fence="false" id="alg2.24.m9.7.7.1.1.1.1.1" xref="alg2.24.m9.7.7.1.1.1.1.1.cmml">|</mo><msub id="alg2.24.m9.7.7.1.1.1.1.3" xref="alg2.24.m9.7.7.1.1.1.1.3.cmml"><mi id="alg2.24.m9.7.7.1.1.1.1.3.2" xref="alg2.24.m9.7.7.1.1.1.1.3.2.cmml">x</mi><mi id="alg2.24.m9.7.7.1.1.1.1.3.3" xref="alg2.24.m9.7.7.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="alg2.24.m9.7.7.1.1.1.3" stretchy="false" xref="alg2.24.m9.7.7.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.24.m9.7.7.2" xref="alg2.24.m9.7.7.2.cmml">=</mo><mfrac id="alg2.24.m9.6.6" xref="alg2.24.m9.6.6.cmml"><mrow id="alg2.24.m9.3.3.3.3" xref="alg2.24.m9.3.3.3.4.cmml"><mi id="alg2.24.m9.2.2.2.2" xref="alg2.24.m9.2.2.2.2.cmml">exp</mi><mo id="alg2.24.m9.3.3.3.3a" xref="alg2.24.m9.3.3.3.4.cmml">⁡</mo><mrow id="alg2.24.m9.3.3.3.3.1" xref="alg2.24.m9.3.3.3.4.cmml"><mo id="alg2.24.m9.3.3.3.3.1.2" stretchy="false" xref="alg2.24.m9.3.3.3.4.cmml">(</mo><mrow id="alg2.24.m9.3.3.3.3.1.1" xref="alg2.24.m9.3.3.3.3.1.1.cmml"><mrow id="alg2.24.m9.3.3.3.3.1.1.1" xref="alg2.24.m9.3.3.3.3.1.1.1.cmml"><mrow id="alg2.24.m9.3.3.3.3.1.1.1.1" xref="alg2.24.m9.3.3.3.3.1.1.1.1.cmml"><mi id="alg2.24.m9.3.3.3.3.1.1.1.1.3" xref="alg2.24.m9.3.3.3.3.1.1.1.1.3.cmml">β</mi><mo id="alg2.24.m9.3.3.3.3.1.1.1.1.2" xref="alg2.24.m9.3.3.3.3.1.1.1.1.2.cmml">⁢</mo><mi id="alg2.24.m9.3.3.3.3.1.1.1.1.4" xref="alg2.24.m9.3.3.3.3.1.1.1.1.4.cmml">f</mi><mo id="alg2.24.m9.3.3.3.3.1.1.1.1.2a" xref="alg2.24.m9.3.3.3.3.1.1.1.1.2.cmml">⁢</mo><msup id="alg2.24.m9.3.3.3.3.1.1.1.1.1" xref="alg2.24.m9.3.3.3.3.1.1.1.1.1.cmml"><mrow id="alg2.24.m9.3.3.3.3.1.1.1.1.1.1.1" xref="alg2.24.m9.3.3.3.3.1.1.1.1.1.1.1.1.cmml"><mo id="alg2.24.m9.3.3.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="alg2.24.m9.3.3.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg2.24.m9.3.3.3.3.1.1.1.1.1.1.1.1" xref="alg2.24.m9.3.3.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="alg2.24.m9.3.3.3.3.1.1.1.1.1.1.1.1.2" xref="alg2.24.m9.3.3.3.3.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="alg2.24.m9.3.3.3.3.1.1.1.1.1.1.1.1.3" xref="alg2.24.m9.3.3.3.3.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg2.24.m9.3.3.3.3.1.1.1.1.1.1.1.3" stretchy="false" xref="alg2.24.m9.3.3.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="alg2.24.m9.3.3.3.3.1.1.1.1.1.3" xref="alg2.24.m9.3.3.3.3.1.1.1.1.1.3.cmml">T</mi></msup><mo id="alg2.24.m9.3.3.3.3.1.1.1.1.2b" xref="alg2.24.m9.3.3.3.3.1.1.1.1.2.cmml">⁢</mo><mi id="alg2.24.m9.3.3.3.3.1.1.1.1.5" xref="alg2.24.m9.3.3.3.3.1.1.1.1.5.cmml">h</mi></mrow><mo id="alg2.24.m9.3.3.3.3.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="alg2.24.m9.3.3.3.3.1.1.1.2.cmml">∘</mo><msup id="alg2.24.m9.3.3.3.3.1.1.1.3" xref="alg2.24.m9.3.3.3.3.1.1.1.3.cmml"><mi id="alg2.24.m9.3.3.3.3.1.1.1.3.2" xref="alg2.24.m9.3.3.3.3.1.1.1.3.2.cmml">g</mi><mo id="alg2.24.m9.3.3.3.3.1.1.1.3.3" xref="alg2.24.m9.3.3.3.3.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="alg2.24.m9.3.3.3.3.1.1.2" xref="alg2.24.m9.3.3.3.3.1.1.2.cmml">⁢</mo><mrow id="alg2.24.m9.3.3.3.3.1.1.3.2" xref="alg2.24.m9.3.3.3.3.1.1.cmml"><mo id="alg2.24.m9.3.3.3.3.1.1.3.2.1" stretchy="false" xref="alg2.24.m9.3.3.3.3.1.1.cmml">(</mo><mi id="alg2.24.m9.1.1.1.1" xref="alg2.24.m9.1.1.1.1.cmml">y</mi><mo id="alg2.24.m9.3.3.3.3.1.1.3.2.2" stretchy="false" xref="alg2.24.m9.3.3.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.24.m9.3.3.3.3.1.3" stretchy="false" xref="alg2.24.m9.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="alg2.24.m9.6.6.6" xref="alg2.24.m9.6.6.6.cmml"><mstyle displaystyle="false" id="alg2.24.m9.6.6.6.4" xref="alg2.24.m9.6.6.6.4.cmml"><msub id="alg2.24.m9.6.6.6.4a" xref="alg2.24.m9.6.6.6.4.cmml"><mo id="alg2.24.m9.6.6.6.4.2" xref="alg2.24.m9.6.6.6.4.2.cmml">∑</mo><mrow id="alg2.24.m9.4.4.4.1.1" xref="alg2.24.m9.4.4.4.1.1.cmml"><msup id="alg2.24.m9.4.4.4.1.1.3" xref="alg2.24.m9.4.4.4.1.1.3.cmml"><mi id="alg2.24.m9.4.4.4.1.1.3.2" xref="alg2.24.m9.4.4.4.1.1.3.2.cmml">y</mi><mo id="alg2.24.m9.4.4.4.1.1.3.3" xref="alg2.24.m9.4.4.4.1.1.3.3.cmml">′</mo></msup><mo id="alg2.24.m9.4.4.4.1.1.2" xref="alg2.24.m9.4.4.4.1.1.2.cmml">∈</mo><mrow id="alg2.24.m9.4.4.4.1.1.4" xref="alg2.24.m9.4.4.4.1.1.4.cmml"><msub id="alg2.24.m9.4.4.4.1.1.4.2" xref="alg2.24.m9.4.4.4.1.1.4.2.cmml"><mi id="alg2.24.m9.4.4.4.1.1.4.2.2" xref="alg2.24.m9.4.4.4.1.1.4.2.2.cmml">S</mi><msub id="alg2.24.m9.4.4.4.1.1.4.2.3" xref="alg2.24.m9.4.4.4.1.1.4.2.3.cmml"><mi id="alg2.24.m9.4.4.4.1.1.4.2.3.2" xref="alg2.24.m9.4.4.4.1.1.4.2.3.2.cmml">x</mi><mi id="alg2.24.m9.4.4.4.1.1.4.2.3.3" xref="alg2.24.m9.4.4.4.1.1.4.2.3.3.cmml">i</mi></msub></msub><mo id="alg2.24.m9.4.4.4.1.1.4.1" xref="alg2.24.m9.4.4.4.1.1.4.1.cmml">⁢</mo><mrow id="alg2.24.m9.4.4.4.1.1.4.3.2" xref="alg2.24.m9.4.4.4.1.1.4.cmml"><mo id="alg2.24.m9.4.4.4.1.1.4.3.2.1" stretchy="false" xref="alg2.24.m9.4.4.4.1.1.4.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg2.24.m9.4.4.4.1.1.1" xref="alg2.24.m9.4.4.4.1.1.1.cmml">𝒴</mi><mo id="alg2.24.m9.4.4.4.1.1.4.3.2.2" stretchy="false" xref="alg2.24.m9.4.4.4.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub></mstyle><mrow id="alg2.24.m9.6.6.6.3.1" xref="alg2.24.m9.6.6.6.3.2.cmml"><mi id="alg2.24.m9.5.5.5.2" xref="alg2.24.m9.5.5.5.2.cmml">exp</mi><mo id="alg2.24.m9.6.6.6.3.1a" xref="alg2.24.m9.6.6.6.3.2.cmml">⁡</mo><mrow id="alg2.24.m9.6.6.6.3.1.1" xref="alg2.24.m9.6.6.6.3.2.cmml"><mo id="alg2.24.m9.6.6.6.3.1.1.2" stretchy="false" xref="alg2.24.m9.6.6.6.3.2.cmml">(</mo><mrow id="alg2.24.m9.6.6.6.3.1.1.1" xref="alg2.24.m9.6.6.6.3.1.1.1.cmml"><mrow id="alg2.24.m9.6.6.6.3.1.1.1.1" xref="alg2.24.m9.6.6.6.3.1.1.1.1.cmml"><mrow id="alg2.24.m9.6.6.6.3.1.1.1.1.1" xref="alg2.24.m9.6.6.6.3.1.1.1.1.1.cmml"><mi id="alg2.24.m9.6.6.6.3.1.1.1.1.1.3" xref="alg2.24.m9.6.6.6.3.1.1.1.1.1.3.cmml">β</mi><mo id="alg2.24.m9.6.6.6.3.1.1.1.1.1.2" xref="alg2.24.m9.6.6.6.3.1.1.1.1.1.2.cmml">⁢</mo><mi id="alg2.24.m9.6.6.6.3.1.1.1.1.1.4" xref="alg2.24.m9.6.6.6.3.1.1.1.1.1.4.cmml">f</mi><mo id="alg2.24.m9.6.6.6.3.1.1.1.1.1.2a" xref="alg2.24.m9.6.6.6.3.1.1.1.1.1.2.cmml">⁢</mo><msup id="alg2.24.m9.6.6.6.3.1.1.1.1.1.1" xref="alg2.24.m9.6.6.6.3.1.1.1.1.1.1.cmml"><mrow id="alg2.24.m9.6.6.6.3.1.1.1.1.1.1.1.1" xref="alg2.24.m9.6.6.6.3.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg2.24.m9.6.6.6.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="alg2.24.m9.6.6.6.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg2.24.m9.6.6.6.3.1.1.1.1.1.1.1.1.1" xref="alg2.24.m9.6.6.6.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg2.24.m9.6.6.6.3.1.1.1.1.1.1.1.1.1.2" xref="alg2.24.m9.6.6.6.3.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="alg2.24.m9.6.6.6.3.1.1.1.1.1.1.1.1.1.3" xref="alg2.24.m9.6.6.6.3.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg2.24.m9.6.6.6.3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="alg2.24.m9.6.6.6.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="alg2.24.m9.6.6.6.3.1.1.1.1.1.1.3" xref="alg2.24.m9.6.6.6.3.1.1.1.1.1.1.3.cmml">T</mi></msup><mo id="alg2.24.m9.6.6.6.3.1.1.1.1.1.2b" xref="alg2.24.m9.6.6.6.3.1.1.1.1.1.2.cmml">⁢</mo><mi id="alg2.24.m9.6.6.6.3.1.1.1.1.1.5" xref="alg2.24.m9.6.6.6.3.1.1.1.1.1.5.cmml">h</mi></mrow><mo id="alg2.24.m9.6.6.6.3.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="alg2.24.m9.6.6.6.3.1.1.1.1.2.cmml">∘</mo><msup id="alg2.24.m9.6.6.6.3.1.1.1.1.3" xref="alg2.24.m9.6.6.6.3.1.1.1.1.3.cmml"><mi id="alg2.24.m9.6.6.6.3.1.1.1.1.3.2" xref="alg2.24.m9.6.6.6.3.1.1.1.1.3.2.cmml">g</mi><mo id="alg2.24.m9.6.6.6.3.1.1.1.1.3.3" xref="alg2.24.m9.6.6.6.3.1.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="alg2.24.m9.6.6.6.3.1.1.1.3" xref="alg2.24.m9.6.6.6.3.1.1.1.3.cmml">⁢</mo><mrow id="alg2.24.m9.6.6.6.3.1.1.1.2.1" xref="alg2.24.m9.6.6.6.3.1.1.1.2.1.1.cmml"><mo id="alg2.24.m9.6.6.6.3.1.1.1.2.1.2" stretchy="false" xref="alg2.24.m9.6.6.6.3.1.1.1.2.1.1.cmml">(</mo><msup id="alg2.24.m9.6.6.6.3.1.1.1.2.1.1" xref="alg2.24.m9.6.6.6.3.1.1.1.2.1.1.cmml"><mi id="alg2.24.m9.6.6.6.3.1.1.1.2.1.1.2" xref="alg2.24.m9.6.6.6.3.1.1.1.2.1.1.2.cmml">y</mi><mo id="alg2.24.m9.6.6.6.3.1.1.1.2.1.1.3" xref="alg2.24.m9.6.6.6.3.1.1.1.2.1.1.3.cmml">′</mo></msup><mo id="alg2.24.m9.6.6.6.3.1.1.1.2.1.3" stretchy="false" xref="alg2.24.m9.6.6.6.3.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.24.m9.6.6.6.3.1.1.3" stretchy="false" xref="alg2.24.m9.6.6.6.3.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg2.24.m9.7b"><apply id="alg2.24.m9.7.7.cmml" xref="alg2.24.m9.7.7"><eq id="alg2.24.m9.7.7.2.cmml" xref="alg2.24.m9.7.7.2"></eq><apply id="alg2.24.m9.7.7.1.cmml" xref="alg2.24.m9.7.7.1"><times id="alg2.24.m9.7.7.1.2.cmml" xref="alg2.24.m9.7.7.1.2"></times><apply id="alg2.24.m9.7.7.1.3.cmml" xref="alg2.24.m9.7.7.1.3"><csymbol cd="ambiguous" id="alg2.24.m9.7.7.1.3.1.cmml" xref="alg2.24.m9.7.7.1.3">subscript</csymbol><apply id="alg2.24.m9.7.7.1.3.2.cmml" xref="alg2.24.m9.7.7.1.3.2"><ci id="alg2.24.m9.7.7.1.3.2.1.cmml" xref="alg2.24.m9.7.7.1.3.2.1">~</ci><ci id="alg2.24.m9.7.7.1.3.2.2.cmml" xref="alg2.24.m9.7.7.1.3.2.2">𝑃</ci></apply><ci id="alg2.24.m9.7.7.1.3.3.cmml" xref="alg2.24.m9.7.7.1.3.3">ℎ</ci></apply><apply id="alg2.24.m9.7.7.1.1.1.1.cmml" xref="alg2.24.m9.7.7.1.1.1"><csymbol cd="latexml" id="alg2.24.m9.7.7.1.1.1.1.1.cmml" xref="alg2.24.m9.7.7.1.1.1.1.1">conditional</csymbol><ci id="alg2.24.m9.7.7.1.1.1.1.2.cmml" xref="alg2.24.m9.7.7.1.1.1.1.2">𝑦</ci><apply id="alg2.24.m9.7.7.1.1.1.1.3.cmml" xref="alg2.24.m9.7.7.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.24.m9.7.7.1.1.1.1.3.1.cmml" xref="alg2.24.m9.7.7.1.1.1.1.3">subscript</csymbol><ci id="alg2.24.m9.7.7.1.1.1.1.3.2.cmml" xref="alg2.24.m9.7.7.1.1.1.1.3.2">𝑥</ci><ci id="alg2.24.m9.7.7.1.1.1.1.3.3.cmml" xref="alg2.24.m9.7.7.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><apply id="alg2.24.m9.6.6.cmml" xref="alg2.24.m9.6.6"><divide id="alg2.24.m9.6.6.7.cmml" xref="alg2.24.m9.6.6"></divide><apply id="alg2.24.m9.3.3.3.4.cmml" xref="alg2.24.m9.3.3.3.3"><exp id="alg2.24.m9.2.2.2.2.cmml" xref="alg2.24.m9.2.2.2.2"></exp><apply id="alg2.24.m9.3.3.3.3.1.1.cmml" xref="alg2.24.m9.3.3.3.3.1.1"><times id="alg2.24.m9.3.3.3.3.1.1.2.cmml" xref="alg2.24.m9.3.3.3.3.1.1.2"></times><apply id="alg2.24.m9.3.3.3.3.1.1.1.cmml" xref="alg2.24.m9.3.3.3.3.1.1.1"><compose id="alg2.24.m9.3.3.3.3.1.1.1.2.cmml" xref="alg2.24.m9.3.3.3.3.1.1.1.2"></compose><apply id="alg2.24.m9.3.3.3.3.1.1.1.1.cmml" xref="alg2.24.m9.3.3.3.3.1.1.1.1"><times id="alg2.24.m9.3.3.3.3.1.1.1.1.2.cmml" xref="alg2.24.m9.3.3.3.3.1.1.1.1.2"></times><ci id="alg2.24.m9.3.3.3.3.1.1.1.1.3.cmml" xref="alg2.24.m9.3.3.3.3.1.1.1.1.3">𝛽</ci><ci id="alg2.24.m9.3.3.3.3.1.1.1.1.4.cmml" xref="alg2.24.m9.3.3.3.3.1.1.1.1.4">𝑓</ci><apply id="alg2.24.m9.3.3.3.3.1.1.1.1.1.cmml" xref="alg2.24.m9.3.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.24.m9.3.3.3.3.1.1.1.1.1.2.cmml" xref="alg2.24.m9.3.3.3.3.1.1.1.1.1">superscript</csymbol><apply id="alg2.24.m9.3.3.3.3.1.1.1.1.1.1.1.1.cmml" xref="alg2.24.m9.3.3.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.24.m9.3.3.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.24.m9.3.3.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.24.m9.3.3.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.24.m9.3.3.3.3.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="alg2.24.m9.3.3.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.24.m9.3.3.3.3.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="alg2.24.m9.3.3.3.3.1.1.1.1.1.3.cmml" xref="alg2.24.m9.3.3.3.3.1.1.1.1.1.3">𝑇</ci></apply><ci id="alg2.24.m9.3.3.3.3.1.1.1.1.5.cmml" xref="alg2.24.m9.3.3.3.3.1.1.1.1.5">ℎ</ci></apply><apply id="alg2.24.m9.3.3.3.3.1.1.1.3.cmml" xref="alg2.24.m9.3.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="alg2.24.m9.3.3.3.3.1.1.1.3.1.cmml" xref="alg2.24.m9.3.3.3.3.1.1.1.3">superscript</csymbol><ci id="alg2.24.m9.3.3.3.3.1.1.1.3.2.cmml" xref="alg2.24.m9.3.3.3.3.1.1.1.3.2">𝑔</ci><ci id="alg2.24.m9.3.3.3.3.1.1.1.3.3.cmml" xref="alg2.24.m9.3.3.3.3.1.1.1.3.3">′</ci></apply></apply><ci id="alg2.24.m9.1.1.1.1.cmml" xref="alg2.24.m9.1.1.1.1">𝑦</ci></apply></apply><apply id="alg2.24.m9.6.6.6.cmml" xref="alg2.24.m9.6.6.6"><apply id="alg2.24.m9.6.6.6.4.cmml" xref="alg2.24.m9.6.6.6.4"><csymbol cd="ambiguous" id="alg2.24.m9.6.6.6.4.1.cmml" xref="alg2.24.m9.6.6.6.4">subscript</csymbol><sum id="alg2.24.m9.6.6.6.4.2.cmml" xref="alg2.24.m9.6.6.6.4.2"></sum><apply id="alg2.24.m9.4.4.4.1.1.cmml" xref="alg2.24.m9.4.4.4.1.1"><in id="alg2.24.m9.4.4.4.1.1.2.cmml" xref="alg2.24.m9.4.4.4.1.1.2"></in><apply id="alg2.24.m9.4.4.4.1.1.3.cmml" xref="alg2.24.m9.4.4.4.1.1.3"><csymbol cd="ambiguous" id="alg2.24.m9.4.4.4.1.1.3.1.cmml" xref="alg2.24.m9.4.4.4.1.1.3">superscript</csymbol><ci id="alg2.24.m9.4.4.4.1.1.3.2.cmml" xref="alg2.24.m9.4.4.4.1.1.3.2">𝑦</ci><ci id="alg2.24.m9.4.4.4.1.1.3.3.cmml" xref="alg2.24.m9.4.4.4.1.1.3.3">′</ci></apply><apply id="alg2.24.m9.4.4.4.1.1.4.cmml" xref="alg2.24.m9.4.4.4.1.1.4"><times id="alg2.24.m9.4.4.4.1.1.4.1.cmml" xref="alg2.24.m9.4.4.4.1.1.4.1"></times><apply id="alg2.24.m9.4.4.4.1.1.4.2.cmml" xref="alg2.24.m9.4.4.4.1.1.4.2"><csymbol cd="ambiguous" id="alg2.24.m9.4.4.4.1.1.4.2.1.cmml" xref="alg2.24.m9.4.4.4.1.1.4.2">subscript</csymbol><ci id="alg2.24.m9.4.4.4.1.1.4.2.2.cmml" xref="alg2.24.m9.4.4.4.1.1.4.2.2">𝑆</ci><apply id="alg2.24.m9.4.4.4.1.1.4.2.3.cmml" xref="alg2.24.m9.4.4.4.1.1.4.2.3"><csymbol cd="ambiguous" id="alg2.24.m9.4.4.4.1.1.4.2.3.1.cmml" xref="alg2.24.m9.4.4.4.1.1.4.2.3">subscript</csymbol><ci id="alg2.24.m9.4.4.4.1.1.4.2.3.2.cmml" xref="alg2.24.m9.4.4.4.1.1.4.2.3.2">𝑥</ci><ci id="alg2.24.m9.4.4.4.1.1.4.2.3.3.cmml" xref="alg2.24.m9.4.4.4.1.1.4.2.3.3">𝑖</ci></apply></apply><ci id="alg2.24.m9.4.4.4.1.1.1.cmml" xref="alg2.24.m9.4.4.4.1.1.1">𝒴</ci></apply></apply></apply><apply id="alg2.24.m9.6.6.6.3.2.cmml" xref="alg2.24.m9.6.6.6.3.1"><exp id="alg2.24.m9.5.5.5.2.cmml" xref="alg2.24.m9.5.5.5.2"></exp><apply id="alg2.24.m9.6.6.6.3.1.1.1.cmml" xref="alg2.24.m9.6.6.6.3.1.1.1"><times id="alg2.24.m9.6.6.6.3.1.1.1.3.cmml" xref="alg2.24.m9.6.6.6.3.1.1.1.3"></times><apply id="alg2.24.m9.6.6.6.3.1.1.1.1.cmml" xref="alg2.24.m9.6.6.6.3.1.1.1.1"><compose id="alg2.24.m9.6.6.6.3.1.1.1.1.2.cmml" xref="alg2.24.m9.6.6.6.3.1.1.1.1.2"></compose><apply id="alg2.24.m9.6.6.6.3.1.1.1.1.1.cmml" xref="alg2.24.m9.6.6.6.3.1.1.1.1.1"><times id="alg2.24.m9.6.6.6.3.1.1.1.1.1.2.cmml" xref="alg2.24.m9.6.6.6.3.1.1.1.1.1.2"></times><ci id="alg2.24.m9.6.6.6.3.1.1.1.1.1.3.cmml" xref="alg2.24.m9.6.6.6.3.1.1.1.1.1.3">𝛽</ci><ci id="alg2.24.m9.6.6.6.3.1.1.1.1.1.4.cmml" xref="alg2.24.m9.6.6.6.3.1.1.1.1.1.4">𝑓</ci><apply id="alg2.24.m9.6.6.6.3.1.1.1.1.1.1.cmml" xref="alg2.24.m9.6.6.6.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.24.m9.6.6.6.3.1.1.1.1.1.1.2.cmml" xref="alg2.24.m9.6.6.6.3.1.1.1.1.1.1">superscript</csymbol><apply id="alg2.24.m9.6.6.6.3.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.24.m9.6.6.6.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.24.m9.6.6.6.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.24.m9.6.6.6.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.24.m9.6.6.6.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.24.m9.6.6.6.3.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="alg2.24.m9.6.6.6.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.24.m9.6.6.6.3.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="alg2.24.m9.6.6.6.3.1.1.1.1.1.1.3.cmml" xref="alg2.24.m9.6.6.6.3.1.1.1.1.1.1.3">𝑇</ci></apply><ci id="alg2.24.m9.6.6.6.3.1.1.1.1.1.5.cmml" xref="alg2.24.m9.6.6.6.3.1.1.1.1.1.5">ℎ</ci></apply><apply id="alg2.24.m9.6.6.6.3.1.1.1.1.3.cmml" xref="alg2.24.m9.6.6.6.3.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.24.m9.6.6.6.3.1.1.1.1.3.1.cmml" xref="alg2.24.m9.6.6.6.3.1.1.1.1.3">superscript</csymbol><ci id="alg2.24.m9.6.6.6.3.1.1.1.1.3.2.cmml" xref="alg2.24.m9.6.6.6.3.1.1.1.1.3.2">𝑔</ci><ci id="alg2.24.m9.6.6.6.3.1.1.1.1.3.3.cmml" xref="alg2.24.m9.6.6.6.3.1.1.1.1.3.3">′</ci></apply></apply><apply id="alg2.24.m9.6.6.6.3.1.1.1.2.1.1.cmml" xref="alg2.24.m9.6.6.6.3.1.1.1.2.1"><csymbol cd="ambiguous" id="alg2.24.m9.6.6.6.3.1.1.1.2.1.1.1.cmml" xref="alg2.24.m9.6.6.6.3.1.1.1.2.1">superscript</csymbol><ci id="alg2.24.m9.6.6.6.3.1.1.1.2.1.1.2.cmml" xref="alg2.24.m9.6.6.6.3.1.1.1.2.1.1.2">𝑦</ci><ci id="alg2.24.m9.6.6.6.3.1.1.1.2.1.1.3.cmml" xref="alg2.24.m9.6.6.6.3.1.1.1.2.1.1.3">′</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.24.m9.7c">{\tilde{P}_{h}(y|x_{i})=\frac{\exp(\beta f(x_{i})^{T}h\circ g^{\prime}(y))}{%
\sum_{y^{\prime}\in S_{x_{i}}(\mathcal{Y})}\exp(\beta f(x_{i})^{T}h\circ g^{%
\prime}(y^{\prime}))}}</annotation><annotation encoding="application/x-llamapun" id="alg2.24.m9.7d">over~ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ( italic_y | italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = divide start_ARG roman_exp ( italic_β italic_f ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_h ∘ italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y ) ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ italic_S start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( caligraphic_Y ) end_POSTSUBSCRIPT roman_exp ( italic_β italic_f ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_h ∘ italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ) end_ARG</annotation></semantics></math>
<br class="ltx_break"/>Define <math alttext="P_{a}(y|x)=\frac{P(a|y,x)}{\sum_{y^{\prime}\in S_{x}(\mathcal{Y})}P(a|y^{%
\prime},x)}." class="ltx_Math" display="inline" id="alg2.25.m10.7"><semantics id="alg2.25.m10.7a"><mrow id="alg2.25.m10.7.7.1" xref="alg2.25.m10.7.7.1.1.cmml"><mrow id="alg2.25.m10.7.7.1.1" xref="alg2.25.m10.7.7.1.1.cmml"><mrow id="alg2.25.m10.7.7.1.1.1" xref="alg2.25.m10.7.7.1.1.1.cmml"><msub id="alg2.25.m10.7.7.1.1.1.3" xref="alg2.25.m10.7.7.1.1.1.3.cmml"><mi id="alg2.25.m10.7.7.1.1.1.3.2" xref="alg2.25.m10.7.7.1.1.1.3.2.cmml">P</mi><mi id="alg2.25.m10.7.7.1.1.1.3.3" xref="alg2.25.m10.7.7.1.1.1.3.3.cmml">a</mi></msub><mo id="alg2.25.m10.7.7.1.1.1.2" xref="alg2.25.m10.7.7.1.1.1.2.cmml">⁢</mo><mrow id="alg2.25.m10.7.7.1.1.1.1.1" xref="alg2.25.m10.7.7.1.1.1.1.1.1.cmml"><mo id="alg2.25.m10.7.7.1.1.1.1.1.2" stretchy="false" xref="alg2.25.m10.7.7.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.25.m10.7.7.1.1.1.1.1.1" xref="alg2.25.m10.7.7.1.1.1.1.1.1.cmml"><mi id="alg2.25.m10.7.7.1.1.1.1.1.1.2" xref="alg2.25.m10.7.7.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="alg2.25.m10.7.7.1.1.1.1.1.1.1" xref="alg2.25.m10.7.7.1.1.1.1.1.1.1.cmml">|</mo><mi id="alg2.25.m10.7.7.1.1.1.1.1.1.3" xref="alg2.25.m10.7.7.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="alg2.25.m10.7.7.1.1.1.1.1.3" stretchy="false" xref="alg2.25.m10.7.7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.25.m10.7.7.1.1.2" xref="alg2.25.m10.7.7.1.1.2.cmml">=</mo><mfrac id="alg2.25.m10.6.6" xref="alg2.25.m10.6.6.cmml"><mrow id="alg2.25.m10.3.3.3" xref="alg2.25.m10.3.3.3.cmml"><mi id="alg2.25.m10.3.3.3.5" xref="alg2.25.m10.3.3.3.5.cmml">P</mi><mo id="alg2.25.m10.3.3.3.4" xref="alg2.25.m10.3.3.3.4.cmml">⁢</mo><mrow id="alg2.25.m10.3.3.3.3.1" xref="alg2.25.m10.3.3.3.3.1.1.cmml"><mo id="alg2.25.m10.3.3.3.3.1.2" stretchy="false" xref="alg2.25.m10.3.3.3.3.1.1.cmml">(</mo><mrow id="alg2.25.m10.3.3.3.3.1.1" xref="alg2.25.m10.3.3.3.3.1.1.cmml"><mi id="alg2.25.m10.3.3.3.3.1.1.2" xref="alg2.25.m10.3.3.3.3.1.1.2.cmml">a</mi><mo fence="false" id="alg2.25.m10.3.3.3.3.1.1.1" xref="alg2.25.m10.3.3.3.3.1.1.1.cmml">|</mo><mrow id="alg2.25.m10.3.3.3.3.1.1.3.2" xref="alg2.25.m10.3.3.3.3.1.1.3.1.cmml"><mi id="alg2.25.m10.1.1.1.1" xref="alg2.25.m10.1.1.1.1.cmml">y</mi><mo id="alg2.25.m10.3.3.3.3.1.1.3.2.1" xref="alg2.25.m10.3.3.3.3.1.1.3.1.cmml">,</mo><mi id="alg2.25.m10.2.2.2.2" xref="alg2.25.m10.2.2.2.2.cmml">x</mi></mrow></mrow><mo id="alg2.25.m10.3.3.3.3.1.3" stretchy="false" xref="alg2.25.m10.3.3.3.3.1.1.cmml">)</mo></mrow></mrow><mrow id="alg2.25.m10.6.6.6" xref="alg2.25.m10.6.6.6.cmml"><mstyle displaystyle="false" id="alg2.25.m10.6.6.6.4" xref="alg2.25.m10.6.6.6.4.cmml"><msub id="alg2.25.m10.6.6.6.4a" xref="alg2.25.m10.6.6.6.4.cmml"><mo id="alg2.25.m10.6.6.6.4.2" xref="alg2.25.m10.6.6.6.4.2.cmml">∑</mo><mrow id="alg2.25.m10.4.4.4.1.1" xref="alg2.25.m10.4.4.4.1.1.cmml"><msup id="alg2.25.m10.4.4.4.1.1.3" xref="alg2.25.m10.4.4.4.1.1.3.cmml"><mi id="alg2.25.m10.4.4.4.1.1.3.2" xref="alg2.25.m10.4.4.4.1.1.3.2.cmml">y</mi><mo id="alg2.25.m10.4.4.4.1.1.3.3" xref="alg2.25.m10.4.4.4.1.1.3.3.cmml">′</mo></msup><mo id="alg2.25.m10.4.4.4.1.1.2" xref="alg2.25.m10.4.4.4.1.1.2.cmml">∈</mo><mrow id="alg2.25.m10.4.4.4.1.1.4" xref="alg2.25.m10.4.4.4.1.1.4.cmml"><msub id="alg2.25.m10.4.4.4.1.1.4.2" xref="alg2.25.m10.4.4.4.1.1.4.2.cmml"><mi id="alg2.25.m10.4.4.4.1.1.4.2.2" xref="alg2.25.m10.4.4.4.1.1.4.2.2.cmml">S</mi><mi id="alg2.25.m10.4.4.4.1.1.4.2.3" xref="alg2.25.m10.4.4.4.1.1.4.2.3.cmml">x</mi></msub><mo id="alg2.25.m10.4.4.4.1.1.4.1" xref="alg2.25.m10.4.4.4.1.1.4.1.cmml">⁢</mo><mrow id="alg2.25.m10.4.4.4.1.1.4.3.2" xref="alg2.25.m10.4.4.4.1.1.4.cmml"><mo id="alg2.25.m10.4.4.4.1.1.4.3.2.1" stretchy="false" xref="alg2.25.m10.4.4.4.1.1.4.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg2.25.m10.4.4.4.1.1.1" xref="alg2.25.m10.4.4.4.1.1.1.cmml">𝒴</mi><mo id="alg2.25.m10.4.4.4.1.1.4.3.2.2" stretchy="false" xref="alg2.25.m10.4.4.4.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub></mstyle><mrow id="alg2.25.m10.6.6.6.3" xref="alg2.25.m10.6.6.6.3.cmml"><mi id="alg2.25.m10.6.6.6.3.3" xref="alg2.25.m10.6.6.6.3.3.cmml">P</mi><mo id="alg2.25.m10.6.6.6.3.2" xref="alg2.25.m10.6.6.6.3.2.cmml">⁢</mo><mrow id="alg2.25.m10.6.6.6.3.1.1" xref="alg2.25.m10.6.6.6.3.1.1.1.cmml"><mo id="alg2.25.m10.6.6.6.3.1.1.2" stretchy="false" xref="alg2.25.m10.6.6.6.3.1.1.1.cmml">(</mo><mrow id="alg2.25.m10.6.6.6.3.1.1.1" xref="alg2.25.m10.6.6.6.3.1.1.1.cmml"><mi id="alg2.25.m10.6.6.6.3.1.1.1.3" xref="alg2.25.m10.6.6.6.3.1.1.1.3.cmml">a</mi><mo fence="false" id="alg2.25.m10.6.6.6.3.1.1.1.2" xref="alg2.25.m10.6.6.6.3.1.1.1.2.cmml">|</mo><mrow id="alg2.25.m10.6.6.6.3.1.1.1.1.1" xref="alg2.25.m10.6.6.6.3.1.1.1.1.2.cmml"><msup id="alg2.25.m10.6.6.6.3.1.1.1.1.1.1" xref="alg2.25.m10.6.6.6.3.1.1.1.1.1.1.cmml"><mi id="alg2.25.m10.6.6.6.3.1.1.1.1.1.1.2" xref="alg2.25.m10.6.6.6.3.1.1.1.1.1.1.2.cmml">y</mi><mo id="alg2.25.m10.6.6.6.3.1.1.1.1.1.1.3" xref="alg2.25.m10.6.6.6.3.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="alg2.25.m10.6.6.6.3.1.1.1.1.1.2" xref="alg2.25.m10.6.6.6.3.1.1.1.1.2.cmml">,</mo><mi id="alg2.25.m10.5.5.5.2" xref="alg2.25.m10.5.5.5.2.cmml">x</mi></mrow></mrow><mo id="alg2.25.m10.6.6.6.3.1.1.3" stretchy="false" xref="alg2.25.m10.6.6.6.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="alg2.25.m10.7.7.1.2" lspace="0em" xref="alg2.25.m10.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.25.m10.7b"><apply id="alg2.25.m10.7.7.1.1.cmml" xref="alg2.25.m10.7.7.1"><eq id="alg2.25.m10.7.7.1.1.2.cmml" xref="alg2.25.m10.7.7.1.1.2"></eq><apply id="alg2.25.m10.7.7.1.1.1.cmml" xref="alg2.25.m10.7.7.1.1.1"><times id="alg2.25.m10.7.7.1.1.1.2.cmml" xref="alg2.25.m10.7.7.1.1.1.2"></times><apply id="alg2.25.m10.7.7.1.1.1.3.cmml" xref="alg2.25.m10.7.7.1.1.1.3"><csymbol cd="ambiguous" id="alg2.25.m10.7.7.1.1.1.3.1.cmml" xref="alg2.25.m10.7.7.1.1.1.3">subscript</csymbol><ci id="alg2.25.m10.7.7.1.1.1.3.2.cmml" xref="alg2.25.m10.7.7.1.1.1.3.2">𝑃</ci><ci id="alg2.25.m10.7.7.1.1.1.3.3.cmml" xref="alg2.25.m10.7.7.1.1.1.3.3">𝑎</ci></apply><apply id="alg2.25.m10.7.7.1.1.1.1.1.1.cmml" xref="alg2.25.m10.7.7.1.1.1.1.1"><csymbol cd="latexml" id="alg2.25.m10.7.7.1.1.1.1.1.1.1.cmml" xref="alg2.25.m10.7.7.1.1.1.1.1.1.1">conditional</csymbol><ci id="alg2.25.m10.7.7.1.1.1.1.1.1.2.cmml" xref="alg2.25.m10.7.7.1.1.1.1.1.1.2">𝑦</ci><ci id="alg2.25.m10.7.7.1.1.1.1.1.1.3.cmml" xref="alg2.25.m10.7.7.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="alg2.25.m10.6.6.cmml" xref="alg2.25.m10.6.6"><divide id="alg2.25.m10.6.6.7.cmml" xref="alg2.25.m10.6.6"></divide><apply id="alg2.25.m10.3.3.3.cmml" xref="alg2.25.m10.3.3.3"><times id="alg2.25.m10.3.3.3.4.cmml" xref="alg2.25.m10.3.3.3.4"></times><ci id="alg2.25.m10.3.3.3.5.cmml" xref="alg2.25.m10.3.3.3.5">𝑃</ci><apply id="alg2.25.m10.3.3.3.3.1.1.cmml" xref="alg2.25.m10.3.3.3.3.1"><csymbol cd="latexml" id="alg2.25.m10.3.3.3.3.1.1.1.cmml" xref="alg2.25.m10.3.3.3.3.1.1.1">conditional</csymbol><ci id="alg2.25.m10.3.3.3.3.1.1.2.cmml" xref="alg2.25.m10.3.3.3.3.1.1.2">𝑎</ci><list id="alg2.25.m10.3.3.3.3.1.1.3.1.cmml" xref="alg2.25.m10.3.3.3.3.1.1.3.2"><ci id="alg2.25.m10.1.1.1.1.cmml" xref="alg2.25.m10.1.1.1.1">𝑦</ci><ci id="alg2.25.m10.2.2.2.2.cmml" xref="alg2.25.m10.2.2.2.2">𝑥</ci></list></apply></apply><apply id="alg2.25.m10.6.6.6.cmml" xref="alg2.25.m10.6.6.6"><apply id="alg2.25.m10.6.6.6.4.cmml" xref="alg2.25.m10.6.6.6.4"><csymbol cd="ambiguous" id="alg2.25.m10.6.6.6.4.1.cmml" xref="alg2.25.m10.6.6.6.4">subscript</csymbol><sum id="alg2.25.m10.6.6.6.4.2.cmml" xref="alg2.25.m10.6.6.6.4.2"></sum><apply id="alg2.25.m10.4.4.4.1.1.cmml" xref="alg2.25.m10.4.4.4.1.1"><in id="alg2.25.m10.4.4.4.1.1.2.cmml" xref="alg2.25.m10.4.4.4.1.1.2"></in><apply id="alg2.25.m10.4.4.4.1.1.3.cmml" xref="alg2.25.m10.4.4.4.1.1.3"><csymbol cd="ambiguous" id="alg2.25.m10.4.4.4.1.1.3.1.cmml" xref="alg2.25.m10.4.4.4.1.1.3">superscript</csymbol><ci id="alg2.25.m10.4.4.4.1.1.3.2.cmml" xref="alg2.25.m10.4.4.4.1.1.3.2">𝑦</ci><ci id="alg2.25.m10.4.4.4.1.1.3.3.cmml" xref="alg2.25.m10.4.4.4.1.1.3.3">′</ci></apply><apply id="alg2.25.m10.4.4.4.1.1.4.cmml" xref="alg2.25.m10.4.4.4.1.1.4"><times id="alg2.25.m10.4.4.4.1.1.4.1.cmml" xref="alg2.25.m10.4.4.4.1.1.4.1"></times><apply id="alg2.25.m10.4.4.4.1.1.4.2.cmml" xref="alg2.25.m10.4.4.4.1.1.4.2"><csymbol cd="ambiguous" id="alg2.25.m10.4.4.4.1.1.4.2.1.cmml" xref="alg2.25.m10.4.4.4.1.1.4.2">subscript</csymbol><ci id="alg2.25.m10.4.4.4.1.1.4.2.2.cmml" xref="alg2.25.m10.4.4.4.1.1.4.2.2">𝑆</ci><ci id="alg2.25.m10.4.4.4.1.1.4.2.3.cmml" xref="alg2.25.m10.4.4.4.1.1.4.2.3">𝑥</ci></apply><ci id="alg2.25.m10.4.4.4.1.1.1.cmml" xref="alg2.25.m10.4.4.4.1.1.1">𝒴</ci></apply></apply></apply><apply id="alg2.25.m10.6.6.6.3.cmml" xref="alg2.25.m10.6.6.6.3"><times id="alg2.25.m10.6.6.6.3.2.cmml" xref="alg2.25.m10.6.6.6.3.2"></times><ci id="alg2.25.m10.6.6.6.3.3.cmml" xref="alg2.25.m10.6.6.6.3.3">𝑃</ci><apply id="alg2.25.m10.6.6.6.3.1.1.1.cmml" xref="alg2.25.m10.6.6.6.3.1.1"><csymbol cd="latexml" id="alg2.25.m10.6.6.6.3.1.1.1.2.cmml" xref="alg2.25.m10.6.6.6.3.1.1.1.2">conditional</csymbol><ci id="alg2.25.m10.6.6.6.3.1.1.1.3.cmml" xref="alg2.25.m10.6.6.6.3.1.1.1.3">𝑎</ci><list id="alg2.25.m10.6.6.6.3.1.1.1.1.2.cmml" xref="alg2.25.m10.6.6.6.3.1.1.1.1.1"><apply id="alg2.25.m10.6.6.6.3.1.1.1.1.1.1.cmml" xref="alg2.25.m10.6.6.6.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.25.m10.6.6.6.3.1.1.1.1.1.1.1.cmml" xref="alg2.25.m10.6.6.6.3.1.1.1.1.1.1">superscript</csymbol><ci id="alg2.25.m10.6.6.6.3.1.1.1.1.1.1.2.cmml" xref="alg2.25.m10.6.6.6.3.1.1.1.1.1.1.2">𝑦</ci><ci id="alg2.25.m10.6.6.6.3.1.1.1.1.1.1.3.cmml" xref="alg2.25.m10.6.6.6.3.1.1.1.1.1.1.3">′</ci></apply><ci id="alg2.25.m10.5.5.5.2.cmml" xref="alg2.25.m10.5.5.5.2">𝑥</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.25.m10.7c">P_{a}(y|x)=\frac{P(a|y,x)}{\sum_{y^{\prime}\in S_{x}(\mathcal{Y})}P(a|y^{%
\prime},x)}.</annotation><annotation encoding="application/x-llamapun" id="alg2.25.m10.7d">italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ( italic_y | italic_x ) = divide start_ARG italic_P ( italic_a | italic_y , italic_x ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ italic_S start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT ( caligraphic_Y ) end_POSTSUBSCRIPT italic_P ( italic_a | italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_x ) end_ARG .</annotation></semantics></math>
<br class="ltx_break"/>Define <math alttext="P_{\text{LM}}(a|x)=\sum_{y\in S_{x}(\mathcal{Y})}P(a|y,x)P(y|x)." class="ltx_Math" display="inline" id="alg2.26.m11.4"><semantics id="alg2.26.m11.4a"><mrow id="alg2.26.m11.4.4.1" xref="alg2.26.m11.4.4.1.1.cmml"><mrow id="alg2.26.m11.4.4.1.1" xref="alg2.26.m11.4.4.1.1.cmml"><mrow id="alg2.26.m11.4.4.1.1.1" xref="alg2.26.m11.4.4.1.1.1.cmml"><msub id="alg2.26.m11.4.4.1.1.1.3" xref="alg2.26.m11.4.4.1.1.1.3.cmml"><mi id="alg2.26.m11.4.4.1.1.1.3.2" xref="alg2.26.m11.4.4.1.1.1.3.2.cmml">P</mi><mtext id="alg2.26.m11.4.4.1.1.1.3.3" xref="alg2.26.m11.4.4.1.1.1.3.3a.cmml">LM</mtext></msub><mo id="alg2.26.m11.4.4.1.1.1.2" xref="alg2.26.m11.4.4.1.1.1.2.cmml">⁢</mo><mrow id="alg2.26.m11.4.4.1.1.1.1.1" xref="alg2.26.m11.4.4.1.1.1.1.1.1.cmml"><mo id="alg2.26.m11.4.4.1.1.1.1.1.2" stretchy="false" xref="alg2.26.m11.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.26.m11.4.4.1.1.1.1.1.1" xref="alg2.26.m11.4.4.1.1.1.1.1.1.cmml"><mi id="alg2.26.m11.4.4.1.1.1.1.1.1.2" xref="alg2.26.m11.4.4.1.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="alg2.26.m11.4.4.1.1.1.1.1.1.1" xref="alg2.26.m11.4.4.1.1.1.1.1.1.1.cmml">|</mo><mi id="alg2.26.m11.4.4.1.1.1.1.1.1.3" xref="alg2.26.m11.4.4.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="alg2.26.m11.4.4.1.1.1.1.1.3" stretchy="false" xref="alg2.26.m11.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.26.m11.4.4.1.1.4" rspace="0.111em" xref="alg2.26.m11.4.4.1.1.4.cmml">=</mo><mrow id="alg2.26.m11.4.4.1.1.3" xref="alg2.26.m11.4.4.1.1.3.cmml"><msub id="alg2.26.m11.4.4.1.1.3.3" xref="alg2.26.m11.4.4.1.1.3.3.cmml"><mo id="alg2.26.m11.4.4.1.1.3.3.2" xref="alg2.26.m11.4.4.1.1.3.3.2.cmml">∑</mo><mrow id="alg2.26.m11.1.1.1" xref="alg2.26.m11.1.1.1.cmml"><mi id="alg2.26.m11.1.1.1.3" xref="alg2.26.m11.1.1.1.3.cmml">y</mi><mo id="alg2.26.m11.1.1.1.2" xref="alg2.26.m11.1.1.1.2.cmml">∈</mo><mrow id="alg2.26.m11.1.1.1.4" xref="alg2.26.m11.1.1.1.4.cmml"><msub id="alg2.26.m11.1.1.1.4.2" xref="alg2.26.m11.1.1.1.4.2.cmml"><mi id="alg2.26.m11.1.1.1.4.2.2" xref="alg2.26.m11.1.1.1.4.2.2.cmml">S</mi><mi id="alg2.26.m11.1.1.1.4.2.3" xref="alg2.26.m11.1.1.1.4.2.3.cmml">x</mi></msub><mo id="alg2.26.m11.1.1.1.4.1" xref="alg2.26.m11.1.1.1.4.1.cmml">⁢</mo><mrow id="alg2.26.m11.1.1.1.4.3.2" xref="alg2.26.m11.1.1.1.4.cmml"><mo id="alg2.26.m11.1.1.1.4.3.2.1" stretchy="false" xref="alg2.26.m11.1.1.1.4.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg2.26.m11.1.1.1.1" xref="alg2.26.m11.1.1.1.1.cmml">𝒴</mi><mo id="alg2.26.m11.1.1.1.4.3.2.2" stretchy="false" xref="alg2.26.m11.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mrow id="alg2.26.m11.4.4.1.1.3.2" xref="alg2.26.m11.4.4.1.1.3.2.cmml"><mi id="alg2.26.m11.4.4.1.1.3.2.4" xref="alg2.26.m11.4.4.1.1.3.2.4.cmml">P</mi><mo id="alg2.26.m11.4.4.1.1.3.2.3" xref="alg2.26.m11.4.4.1.1.3.2.3.cmml">⁢</mo><mrow id="alg2.26.m11.4.4.1.1.2.1.1.1" xref="alg2.26.m11.4.4.1.1.2.1.1.1.1.cmml"><mo id="alg2.26.m11.4.4.1.1.2.1.1.1.2" stretchy="false" xref="alg2.26.m11.4.4.1.1.2.1.1.1.1.cmml">(</mo><mrow id="alg2.26.m11.4.4.1.1.2.1.1.1.1" xref="alg2.26.m11.4.4.1.1.2.1.1.1.1.cmml"><mi id="alg2.26.m11.4.4.1.1.2.1.1.1.1.2" xref="alg2.26.m11.4.4.1.1.2.1.1.1.1.2.cmml">a</mi><mo fence="false" id="alg2.26.m11.4.4.1.1.2.1.1.1.1.1" xref="alg2.26.m11.4.4.1.1.2.1.1.1.1.1.cmml">|</mo><mrow id="alg2.26.m11.4.4.1.1.2.1.1.1.1.3.2" xref="alg2.26.m11.4.4.1.1.2.1.1.1.1.3.1.cmml"><mi id="alg2.26.m11.2.2" xref="alg2.26.m11.2.2.cmml">y</mi><mo id="alg2.26.m11.4.4.1.1.2.1.1.1.1.3.2.1" xref="alg2.26.m11.4.4.1.1.2.1.1.1.1.3.1.cmml">,</mo><mi id="alg2.26.m11.3.3" xref="alg2.26.m11.3.3.cmml">x</mi></mrow></mrow><mo id="alg2.26.m11.4.4.1.1.2.1.1.1.3" stretchy="false" xref="alg2.26.m11.4.4.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo id="alg2.26.m11.4.4.1.1.3.2.3a" xref="alg2.26.m11.4.4.1.1.3.2.3.cmml">⁢</mo><mi id="alg2.26.m11.4.4.1.1.3.2.5" xref="alg2.26.m11.4.4.1.1.3.2.5.cmml">P</mi><mo id="alg2.26.m11.4.4.1.1.3.2.3b" xref="alg2.26.m11.4.4.1.1.3.2.3.cmml">⁢</mo><mrow id="alg2.26.m11.4.4.1.1.3.2.2.1" xref="alg2.26.m11.4.4.1.1.3.2.2.1.1.cmml"><mo id="alg2.26.m11.4.4.1.1.3.2.2.1.2" stretchy="false" xref="alg2.26.m11.4.4.1.1.3.2.2.1.1.cmml">(</mo><mrow id="alg2.26.m11.4.4.1.1.3.2.2.1.1" xref="alg2.26.m11.4.4.1.1.3.2.2.1.1.cmml"><mi id="alg2.26.m11.4.4.1.1.3.2.2.1.1.2" xref="alg2.26.m11.4.4.1.1.3.2.2.1.1.2.cmml">y</mi><mo fence="false" id="alg2.26.m11.4.4.1.1.3.2.2.1.1.1" xref="alg2.26.m11.4.4.1.1.3.2.2.1.1.1.cmml">|</mo><mi id="alg2.26.m11.4.4.1.1.3.2.2.1.1.3" xref="alg2.26.m11.4.4.1.1.3.2.2.1.1.3.cmml">x</mi></mrow><mo id="alg2.26.m11.4.4.1.1.3.2.2.1.3" stretchy="false" xref="alg2.26.m11.4.4.1.1.3.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="alg2.26.m11.4.4.1.2" lspace="0em" xref="alg2.26.m11.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.26.m11.4b"><apply id="alg2.26.m11.4.4.1.1.cmml" xref="alg2.26.m11.4.4.1"><eq id="alg2.26.m11.4.4.1.1.4.cmml" xref="alg2.26.m11.4.4.1.1.4"></eq><apply id="alg2.26.m11.4.4.1.1.1.cmml" xref="alg2.26.m11.4.4.1.1.1"><times id="alg2.26.m11.4.4.1.1.1.2.cmml" xref="alg2.26.m11.4.4.1.1.1.2"></times><apply id="alg2.26.m11.4.4.1.1.1.3.cmml" xref="alg2.26.m11.4.4.1.1.1.3"><csymbol cd="ambiguous" id="alg2.26.m11.4.4.1.1.1.3.1.cmml" xref="alg2.26.m11.4.4.1.1.1.3">subscript</csymbol><ci id="alg2.26.m11.4.4.1.1.1.3.2.cmml" xref="alg2.26.m11.4.4.1.1.1.3.2">𝑃</ci><ci id="alg2.26.m11.4.4.1.1.1.3.3a.cmml" xref="alg2.26.m11.4.4.1.1.1.3.3"><mtext id="alg2.26.m11.4.4.1.1.1.3.3.cmml" mathsize="70%" xref="alg2.26.m11.4.4.1.1.1.3.3">LM</mtext></ci></apply><apply id="alg2.26.m11.4.4.1.1.1.1.1.1.cmml" xref="alg2.26.m11.4.4.1.1.1.1.1"><csymbol cd="latexml" id="alg2.26.m11.4.4.1.1.1.1.1.1.1.cmml" xref="alg2.26.m11.4.4.1.1.1.1.1.1.1">conditional</csymbol><ci id="alg2.26.m11.4.4.1.1.1.1.1.1.2.cmml" xref="alg2.26.m11.4.4.1.1.1.1.1.1.2">𝑎</ci><ci id="alg2.26.m11.4.4.1.1.1.1.1.1.3.cmml" xref="alg2.26.m11.4.4.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="alg2.26.m11.4.4.1.1.3.cmml" xref="alg2.26.m11.4.4.1.1.3"><apply id="alg2.26.m11.4.4.1.1.3.3.cmml" xref="alg2.26.m11.4.4.1.1.3.3"><csymbol cd="ambiguous" id="alg2.26.m11.4.4.1.1.3.3.1.cmml" xref="alg2.26.m11.4.4.1.1.3.3">subscript</csymbol><sum id="alg2.26.m11.4.4.1.1.3.3.2.cmml" xref="alg2.26.m11.4.4.1.1.3.3.2"></sum><apply id="alg2.26.m11.1.1.1.cmml" xref="alg2.26.m11.1.1.1"><in id="alg2.26.m11.1.1.1.2.cmml" xref="alg2.26.m11.1.1.1.2"></in><ci id="alg2.26.m11.1.1.1.3.cmml" xref="alg2.26.m11.1.1.1.3">𝑦</ci><apply id="alg2.26.m11.1.1.1.4.cmml" xref="alg2.26.m11.1.1.1.4"><times id="alg2.26.m11.1.1.1.4.1.cmml" xref="alg2.26.m11.1.1.1.4.1"></times><apply id="alg2.26.m11.1.1.1.4.2.cmml" xref="alg2.26.m11.1.1.1.4.2"><csymbol cd="ambiguous" id="alg2.26.m11.1.1.1.4.2.1.cmml" xref="alg2.26.m11.1.1.1.4.2">subscript</csymbol><ci id="alg2.26.m11.1.1.1.4.2.2.cmml" xref="alg2.26.m11.1.1.1.4.2.2">𝑆</ci><ci id="alg2.26.m11.1.1.1.4.2.3.cmml" xref="alg2.26.m11.1.1.1.4.2.3">𝑥</ci></apply><ci id="alg2.26.m11.1.1.1.1.cmml" xref="alg2.26.m11.1.1.1.1">𝒴</ci></apply></apply></apply><apply id="alg2.26.m11.4.4.1.1.3.2.cmml" xref="alg2.26.m11.4.4.1.1.3.2"><times id="alg2.26.m11.4.4.1.1.3.2.3.cmml" xref="alg2.26.m11.4.4.1.1.3.2.3"></times><ci id="alg2.26.m11.4.4.1.1.3.2.4.cmml" xref="alg2.26.m11.4.4.1.1.3.2.4">𝑃</ci><apply id="alg2.26.m11.4.4.1.1.2.1.1.1.1.cmml" xref="alg2.26.m11.4.4.1.1.2.1.1.1"><csymbol cd="latexml" id="alg2.26.m11.4.4.1.1.2.1.1.1.1.1.cmml" xref="alg2.26.m11.4.4.1.1.2.1.1.1.1.1">conditional</csymbol><ci id="alg2.26.m11.4.4.1.1.2.1.1.1.1.2.cmml" xref="alg2.26.m11.4.4.1.1.2.1.1.1.1.2">𝑎</ci><list id="alg2.26.m11.4.4.1.1.2.1.1.1.1.3.1.cmml" xref="alg2.26.m11.4.4.1.1.2.1.1.1.1.3.2"><ci id="alg2.26.m11.2.2.cmml" xref="alg2.26.m11.2.2">𝑦</ci><ci id="alg2.26.m11.3.3.cmml" xref="alg2.26.m11.3.3">𝑥</ci></list></apply><ci id="alg2.26.m11.4.4.1.1.3.2.5.cmml" xref="alg2.26.m11.4.4.1.1.3.2.5">𝑃</ci><apply id="alg2.26.m11.4.4.1.1.3.2.2.1.1.cmml" xref="alg2.26.m11.4.4.1.1.3.2.2.1"><csymbol cd="latexml" id="alg2.26.m11.4.4.1.1.3.2.2.1.1.1.cmml" xref="alg2.26.m11.4.4.1.1.3.2.2.1.1.1">conditional</csymbol><ci id="alg2.26.m11.4.4.1.1.3.2.2.1.1.2.cmml" xref="alg2.26.m11.4.4.1.1.3.2.2.1.1.2">𝑦</ci><ci id="alg2.26.m11.4.4.1.1.3.2.2.1.1.3.cmml" xref="alg2.26.m11.4.4.1.1.3.2.2.1.1.3">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.26.m11.4c">P_{\text{LM}}(a|x)=\sum_{y\in S_{x}(\mathcal{Y})}P(a|y,x)P(y|x).</annotation><annotation encoding="application/x-llamapun" id="alg2.26.m11.4d">italic_P start_POSTSUBSCRIPT LM end_POSTSUBSCRIPT ( italic_a | italic_x ) = ∑ start_POSTSUBSCRIPT italic_y ∈ italic_S start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT ( caligraphic_Y ) end_POSTSUBSCRIPT italic_P ( italic_a | italic_y , italic_x ) italic_P ( italic_y | italic_x ) .</annotation></semantics></math>
<br class="ltx_break"/>Compute reader loss <math alttext="\mathcal{L}^{\prime}" class="ltx_Math" display="inline" id="alg2.27.m12.1"><semantics id="alg2.27.m12.1a"><msup id="alg2.27.m12.1.1" xref="alg2.27.m12.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.27.m12.1.1.2" xref="alg2.27.m12.1.1.2.cmml">ℒ</mi><mo id="alg2.27.m12.1.1.3" xref="alg2.27.m12.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg2.27.m12.1b"><apply id="alg2.27.m12.1.1.cmml" xref="alg2.27.m12.1.1"><csymbol cd="ambiguous" id="alg2.27.m12.1.1.1.cmml" xref="alg2.27.m12.1.1">superscript</csymbol><ci id="alg2.27.m12.1.1.2.cmml" xref="alg2.27.m12.1.1.2">ℒ</ci><ci id="alg2.27.m12.1.1.3.cmml" xref="alg2.27.m12.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.27.m12.1c">\mathcal{L}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg2.27.m12.1d">caligraphic_L start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> using <math alttext="P_{\text{LM}}(a|x)" class="ltx_Math" display="inline" id="alg2.28.m13.1"><semantics id="alg2.28.m13.1a"><mrow id="alg2.28.m13.1.1" xref="alg2.28.m13.1.1.cmml"><msub id="alg2.28.m13.1.1.3" xref="alg2.28.m13.1.1.3.cmml"><mi id="alg2.28.m13.1.1.3.2" xref="alg2.28.m13.1.1.3.2.cmml">P</mi><mtext id="alg2.28.m13.1.1.3.3" xref="alg2.28.m13.1.1.3.3a.cmml">LM</mtext></msub><mo id="alg2.28.m13.1.1.2" xref="alg2.28.m13.1.1.2.cmml">⁢</mo><mrow id="alg2.28.m13.1.1.1.1" xref="alg2.28.m13.1.1.1.1.1.cmml"><mo id="alg2.28.m13.1.1.1.1.2" stretchy="false" xref="alg2.28.m13.1.1.1.1.1.cmml">(</mo><mrow id="alg2.28.m13.1.1.1.1.1" xref="alg2.28.m13.1.1.1.1.1.cmml"><mi id="alg2.28.m13.1.1.1.1.1.2" xref="alg2.28.m13.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="alg2.28.m13.1.1.1.1.1.1" xref="alg2.28.m13.1.1.1.1.1.1.cmml">|</mo><mi id="alg2.28.m13.1.1.1.1.1.3" xref="alg2.28.m13.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="alg2.28.m13.1.1.1.1.3" stretchy="false" xref="alg2.28.m13.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.28.m13.1b"><apply id="alg2.28.m13.1.1.cmml" xref="alg2.28.m13.1.1"><times id="alg2.28.m13.1.1.2.cmml" xref="alg2.28.m13.1.1.2"></times><apply id="alg2.28.m13.1.1.3.cmml" xref="alg2.28.m13.1.1.3"><csymbol cd="ambiguous" id="alg2.28.m13.1.1.3.1.cmml" xref="alg2.28.m13.1.1.3">subscript</csymbol><ci id="alg2.28.m13.1.1.3.2.cmml" xref="alg2.28.m13.1.1.3.2">𝑃</ci><ci id="alg2.28.m13.1.1.3.3a.cmml" xref="alg2.28.m13.1.1.3.3"><mtext id="alg2.28.m13.1.1.3.3.cmml" mathsize="70%" xref="alg2.28.m13.1.1.3.3">LM</mtext></ci></apply><apply id="alg2.28.m13.1.1.1.1.1.cmml" xref="alg2.28.m13.1.1.1.1"><csymbol cd="latexml" id="alg2.28.m13.1.1.1.1.1.1.cmml" xref="alg2.28.m13.1.1.1.1.1.1">conditional</csymbol><ci id="alg2.28.m13.1.1.1.1.1.2.cmml" xref="alg2.28.m13.1.1.1.1.1.2">𝑎</ci><ci id="alg2.28.m13.1.1.1.1.1.3.cmml" xref="alg2.28.m13.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.28.m13.1c">P_{\text{LM}}(a|x)</annotation><annotation encoding="application/x-llamapun" id="alg2.28.m13.1d">italic_P start_POSTSUBSCRIPT LM end_POSTSUBSCRIPT ( italic_a | italic_x )</annotation></semantics></math>
<br class="ltx_break"/>Compute retriever loss <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="alg2.29.m14.1"><semantics id="alg2.29.m14.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.29.m14.1.1" xref="alg2.29.m14.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="alg2.29.m14.1b"><ci id="alg2.29.m14.1.1.cmml" xref="alg2.29.m14.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.29.m14.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="alg2.29.m14.1d">caligraphic_L</annotation></semantics></math> using <math alttext="\tilde{P}(y|x_{i})" class="ltx_Math" display="inline" id="alg2.30.m15.1"><semantics id="alg2.30.m15.1a"><mrow id="alg2.30.m15.1.1" xref="alg2.30.m15.1.1.cmml"><mover accent="true" id="alg2.30.m15.1.1.3" xref="alg2.30.m15.1.1.3.cmml"><mi id="alg2.30.m15.1.1.3.2" xref="alg2.30.m15.1.1.3.2.cmml">P</mi><mo id="alg2.30.m15.1.1.3.1" xref="alg2.30.m15.1.1.3.1.cmml">~</mo></mover><mo id="alg2.30.m15.1.1.2" xref="alg2.30.m15.1.1.2.cmml">⁢</mo><mrow id="alg2.30.m15.1.1.1.1" xref="alg2.30.m15.1.1.1.1.1.cmml"><mo id="alg2.30.m15.1.1.1.1.2" stretchy="false" xref="alg2.30.m15.1.1.1.1.1.cmml">(</mo><mrow id="alg2.30.m15.1.1.1.1.1" xref="alg2.30.m15.1.1.1.1.1.cmml"><mi id="alg2.30.m15.1.1.1.1.1.2" xref="alg2.30.m15.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="alg2.30.m15.1.1.1.1.1.1" xref="alg2.30.m15.1.1.1.1.1.1.cmml">|</mo><msub id="alg2.30.m15.1.1.1.1.1.3" xref="alg2.30.m15.1.1.1.1.1.3.cmml"><mi id="alg2.30.m15.1.1.1.1.1.3.2" xref="alg2.30.m15.1.1.1.1.1.3.2.cmml">x</mi><mi id="alg2.30.m15.1.1.1.1.1.3.3" xref="alg2.30.m15.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="alg2.30.m15.1.1.1.1.3" stretchy="false" xref="alg2.30.m15.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.30.m15.1b"><apply id="alg2.30.m15.1.1.cmml" xref="alg2.30.m15.1.1"><times id="alg2.30.m15.1.1.2.cmml" xref="alg2.30.m15.1.1.2"></times><apply id="alg2.30.m15.1.1.3.cmml" xref="alg2.30.m15.1.1.3"><ci id="alg2.30.m15.1.1.3.1.cmml" xref="alg2.30.m15.1.1.3.1">~</ci><ci id="alg2.30.m15.1.1.3.2.cmml" xref="alg2.30.m15.1.1.3.2">𝑃</ci></apply><apply id="alg2.30.m15.1.1.1.1.1.cmml" xref="alg2.30.m15.1.1.1.1"><csymbol cd="latexml" id="alg2.30.m15.1.1.1.1.1.1.cmml" xref="alg2.30.m15.1.1.1.1.1.1">conditional</csymbol><ci id="alg2.30.m15.1.1.1.1.1.2.cmml" xref="alg2.30.m15.1.1.1.1.1.2">𝑦</ci><apply id="alg2.30.m15.1.1.1.1.1.3.cmml" xref="alg2.30.m15.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.30.m15.1.1.1.1.1.3.1.cmml" xref="alg2.30.m15.1.1.1.1.1.3">subscript</csymbol><ci id="alg2.30.m15.1.1.1.1.1.3.2.cmml" xref="alg2.30.m15.1.1.1.1.1.3.2">𝑥</ci><ci id="alg2.30.m15.1.1.1.1.1.3.3.cmml" xref="alg2.30.m15.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.30.m15.1c">\tilde{P}(y|x_{i})</annotation><annotation encoding="application/x-llamapun" id="alg2.30.m15.1d">over~ start_ARG italic_P end_ARG ( italic_y | italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> and <math alttext="P_{a}(y|x)" class="ltx_Math" display="inline" id="alg2.31.m16.1"><semantics id="alg2.31.m16.1a"><mrow id="alg2.31.m16.1.1" xref="alg2.31.m16.1.1.cmml"><msub id="alg2.31.m16.1.1.3" xref="alg2.31.m16.1.1.3.cmml"><mi id="alg2.31.m16.1.1.3.2" xref="alg2.31.m16.1.1.3.2.cmml">P</mi><mi id="alg2.31.m16.1.1.3.3" xref="alg2.31.m16.1.1.3.3.cmml">a</mi></msub><mo id="alg2.31.m16.1.1.2" xref="alg2.31.m16.1.1.2.cmml">⁢</mo><mrow id="alg2.31.m16.1.1.1.1" xref="alg2.31.m16.1.1.1.1.1.cmml"><mo id="alg2.31.m16.1.1.1.1.2" stretchy="false" xref="alg2.31.m16.1.1.1.1.1.cmml">(</mo><mrow id="alg2.31.m16.1.1.1.1.1" xref="alg2.31.m16.1.1.1.1.1.cmml"><mi id="alg2.31.m16.1.1.1.1.1.2" xref="alg2.31.m16.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="alg2.31.m16.1.1.1.1.1.1" xref="alg2.31.m16.1.1.1.1.1.1.cmml">|</mo><mi id="alg2.31.m16.1.1.1.1.1.3" xref="alg2.31.m16.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="alg2.31.m16.1.1.1.1.3" stretchy="false" xref="alg2.31.m16.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.31.m16.1b"><apply id="alg2.31.m16.1.1.cmml" xref="alg2.31.m16.1.1"><times id="alg2.31.m16.1.1.2.cmml" xref="alg2.31.m16.1.1.2"></times><apply id="alg2.31.m16.1.1.3.cmml" xref="alg2.31.m16.1.1.3"><csymbol cd="ambiguous" id="alg2.31.m16.1.1.3.1.cmml" xref="alg2.31.m16.1.1.3">subscript</csymbol><ci id="alg2.31.m16.1.1.3.2.cmml" xref="alg2.31.m16.1.1.3.2">𝑃</ci><ci id="alg2.31.m16.1.1.3.3.cmml" xref="alg2.31.m16.1.1.3.3">𝑎</ci></apply><apply id="alg2.31.m16.1.1.1.1.1.cmml" xref="alg2.31.m16.1.1.1.1"><csymbol cd="latexml" id="alg2.31.m16.1.1.1.1.1.1.cmml" xref="alg2.31.m16.1.1.1.1.1.1">conditional</csymbol><ci id="alg2.31.m16.1.1.1.1.1.2.cmml" xref="alg2.31.m16.1.1.1.1.1.2">𝑦</ci><ci id="alg2.31.m16.1.1.1.1.1.3.cmml" xref="alg2.31.m16.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.31.m16.1c">P_{a}(y|x)</annotation><annotation encoding="application/x-llamapun" id="alg2.31.m16.1d">italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ( italic_y | italic_x )</annotation></semantics></math>
<br class="ltx_break"/>Compute correction loss <math alttext="\mathcal{\ell}" class="ltx_Math" display="inline" id="alg2.32.m17.1"><semantics id="alg2.32.m17.1a"><mi id="alg2.32.m17.1.1" mathvariant="normal" xref="alg2.32.m17.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="alg2.32.m17.1b"><ci id="alg2.32.m17.1.1.cmml" xref="alg2.32.m17.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.32.m17.1c">\mathcal{\ell}</annotation><annotation encoding="application/x-llamapun" id="alg2.32.m17.1d">roman_ℓ</annotation></semantics></math> using <math alttext="\tilde{P}" class="ltx_Math" display="inline" id="alg2.33.m18.1"><semantics id="alg2.33.m18.1a"><mover accent="true" id="alg2.33.m18.1.1" xref="alg2.33.m18.1.1.cmml"><mi id="alg2.33.m18.1.1.2" xref="alg2.33.m18.1.1.2.cmml">P</mi><mo id="alg2.33.m18.1.1.1" xref="alg2.33.m18.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="alg2.33.m18.1b"><apply id="alg2.33.m18.1.1.cmml" xref="alg2.33.m18.1.1"><ci id="alg2.33.m18.1.1.1.cmml" xref="alg2.33.m18.1.1.1">~</ci><ci id="alg2.33.m18.1.1.2.cmml" xref="alg2.33.m18.1.1.2">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.33.m18.1c">\tilde{P}</annotation><annotation encoding="application/x-llamapun" id="alg2.33.m18.1d">over~ start_ARG italic_P end_ARG</annotation></semantics></math> and <math alttext="\tilde{P}_{h}" class="ltx_Math" display="inline" id="alg2.34.m19.1"><semantics id="alg2.34.m19.1a"><msub id="alg2.34.m19.1.1" xref="alg2.34.m19.1.1.cmml"><mover accent="true" id="alg2.34.m19.1.1.2" xref="alg2.34.m19.1.1.2.cmml"><mi id="alg2.34.m19.1.1.2.2" xref="alg2.34.m19.1.1.2.2.cmml">P</mi><mo id="alg2.34.m19.1.1.2.1" xref="alg2.34.m19.1.1.2.1.cmml">~</mo></mover><mi id="alg2.34.m19.1.1.3" xref="alg2.34.m19.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.34.m19.1b"><apply id="alg2.34.m19.1.1.cmml" xref="alg2.34.m19.1.1"><csymbol cd="ambiguous" id="alg2.34.m19.1.1.1.cmml" xref="alg2.34.m19.1.1">subscript</csymbol><apply id="alg2.34.m19.1.1.2.cmml" xref="alg2.34.m19.1.1.2"><ci id="alg2.34.m19.1.1.2.1.cmml" xref="alg2.34.m19.1.1.2.1">~</ci><ci id="alg2.34.m19.1.1.2.2.cmml" xref="alg2.34.m19.1.1.2.2">𝑃</ci></apply><ci id="alg2.34.m19.1.1.3.cmml" xref="alg2.34.m19.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.34.m19.1c">\tilde{P}_{h}</annotation><annotation encoding="application/x-llamapun" id="alg2.34.m19.1d">over~ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math>
<br class="ltx_break"/>Update retriever &amp; reader params <math alttext="\Theta\leftarrow\Theta-\eta\nabla_{\Theta}\frac{\mathcal{L}+\mathcal{L}^{%
\prime}}{2}" class="ltx_Math" display="inline" id="alg2.35.m20.1"><semantics id="alg2.35.m20.1a"><mrow id="alg2.35.m20.1.1" xref="alg2.35.m20.1.1.cmml"><mi id="alg2.35.m20.1.1.2" mathvariant="normal" xref="alg2.35.m20.1.1.2.cmml">Θ</mi><mo id="alg2.35.m20.1.1.1" stretchy="false" xref="alg2.35.m20.1.1.1.cmml">←</mo><mrow id="alg2.35.m20.1.1.3" xref="alg2.35.m20.1.1.3.cmml"><mi id="alg2.35.m20.1.1.3.2" mathvariant="normal" xref="alg2.35.m20.1.1.3.2.cmml">Θ</mi><mo id="alg2.35.m20.1.1.3.1" xref="alg2.35.m20.1.1.3.1.cmml">−</mo><mrow id="alg2.35.m20.1.1.3.3" xref="alg2.35.m20.1.1.3.3.cmml"><mi id="alg2.35.m20.1.1.3.3.2" xref="alg2.35.m20.1.1.3.3.2.cmml">η</mi><mo id="alg2.35.m20.1.1.3.3.1" lspace="0.167em" xref="alg2.35.m20.1.1.3.3.1.cmml">⁢</mo><mrow id="alg2.35.m20.1.1.3.3.3" xref="alg2.35.m20.1.1.3.3.3.cmml"><msub id="alg2.35.m20.1.1.3.3.3.1" xref="alg2.35.m20.1.1.3.3.3.1.cmml"><mo id="alg2.35.m20.1.1.3.3.3.1.2" rspace="0.167em" xref="alg2.35.m20.1.1.3.3.3.1.2.cmml">∇</mo><mi id="alg2.35.m20.1.1.3.3.3.1.3" mathvariant="normal" xref="alg2.35.m20.1.1.3.3.3.1.3.cmml">Θ</mi></msub><mfrac id="alg2.35.m20.1.1.3.3.3.2" xref="alg2.35.m20.1.1.3.3.3.2.cmml"><mrow id="alg2.35.m20.1.1.3.3.3.2.2" xref="alg2.35.m20.1.1.3.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.35.m20.1.1.3.3.3.2.2.2" xref="alg2.35.m20.1.1.3.3.3.2.2.2.cmml">ℒ</mi><mo id="alg2.35.m20.1.1.3.3.3.2.2.1" xref="alg2.35.m20.1.1.3.3.3.2.2.1.cmml">+</mo><msup id="alg2.35.m20.1.1.3.3.3.2.2.3" xref="alg2.35.m20.1.1.3.3.3.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.35.m20.1.1.3.3.3.2.2.3.2" xref="alg2.35.m20.1.1.3.3.3.2.2.3.2.cmml">ℒ</mi><mo id="alg2.35.m20.1.1.3.3.3.2.2.3.3" xref="alg2.35.m20.1.1.3.3.3.2.2.3.3.cmml">′</mo></msup></mrow><mn id="alg2.35.m20.1.1.3.3.3.2.3" xref="alg2.35.m20.1.1.3.3.3.2.3.cmml">2</mn></mfrac></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.35.m20.1b"><apply id="alg2.35.m20.1.1.cmml" xref="alg2.35.m20.1.1"><ci id="alg2.35.m20.1.1.1.cmml" xref="alg2.35.m20.1.1.1">←</ci><ci id="alg2.35.m20.1.1.2.cmml" xref="alg2.35.m20.1.1.2">Θ</ci><apply id="alg2.35.m20.1.1.3.cmml" xref="alg2.35.m20.1.1.3"><minus id="alg2.35.m20.1.1.3.1.cmml" xref="alg2.35.m20.1.1.3.1"></minus><ci id="alg2.35.m20.1.1.3.2.cmml" xref="alg2.35.m20.1.1.3.2">Θ</ci><apply id="alg2.35.m20.1.1.3.3.cmml" xref="alg2.35.m20.1.1.3.3"><times id="alg2.35.m20.1.1.3.3.1.cmml" xref="alg2.35.m20.1.1.3.3.1"></times><ci id="alg2.35.m20.1.1.3.3.2.cmml" xref="alg2.35.m20.1.1.3.3.2">𝜂</ci><apply id="alg2.35.m20.1.1.3.3.3.cmml" xref="alg2.35.m20.1.1.3.3.3"><apply id="alg2.35.m20.1.1.3.3.3.1.cmml" xref="alg2.35.m20.1.1.3.3.3.1"><csymbol cd="ambiguous" id="alg2.35.m20.1.1.3.3.3.1.1.cmml" xref="alg2.35.m20.1.1.3.3.3.1">subscript</csymbol><ci id="alg2.35.m20.1.1.3.3.3.1.2.cmml" xref="alg2.35.m20.1.1.3.3.3.1.2">∇</ci><ci id="alg2.35.m20.1.1.3.3.3.1.3.cmml" xref="alg2.35.m20.1.1.3.3.3.1.3">Θ</ci></apply><apply id="alg2.35.m20.1.1.3.3.3.2.cmml" xref="alg2.35.m20.1.1.3.3.3.2"><divide id="alg2.35.m20.1.1.3.3.3.2.1.cmml" xref="alg2.35.m20.1.1.3.3.3.2"></divide><apply id="alg2.35.m20.1.1.3.3.3.2.2.cmml" xref="alg2.35.m20.1.1.3.3.3.2.2"><plus id="alg2.35.m20.1.1.3.3.3.2.2.1.cmml" xref="alg2.35.m20.1.1.3.3.3.2.2.1"></plus><ci id="alg2.35.m20.1.1.3.3.3.2.2.2.cmml" xref="alg2.35.m20.1.1.3.3.3.2.2.2">ℒ</ci><apply id="alg2.35.m20.1.1.3.3.3.2.2.3.cmml" xref="alg2.35.m20.1.1.3.3.3.2.2.3"><csymbol cd="ambiguous" id="alg2.35.m20.1.1.3.3.3.2.2.3.1.cmml" xref="alg2.35.m20.1.1.3.3.3.2.2.3">superscript</csymbol><ci id="alg2.35.m20.1.1.3.3.3.2.2.3.2.cmml" xref="alg2.35.m20.1.1.3.3.3.2.2.3.2">ℒ</ci><ci id="alg2.35.m20.1.1.3.3.3.2.2.3.3.cmml" xref="alg2.35.m20.1.1.3.3.3.2.2.3.3">′</ci></apply></apply><cn id="alg2.35.m20.1.1.3.3.3.2.3.cmml" type="integer" xref="alg2.35.m20.1.1.3.3.3.2.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.35.m20.1c">\Theta\leftarrow\Theta-\eta\nabla_{\Theta}\frac{\mathcal{L}+\mathcal{L}^{%
\prime}}{2}</annotation><annotation encoding="application/x-llamapun" id="alg2.35.m20.1d">roman_Θ ← roman_Θ - italic_η ∇ start_POSTSUBSCRIPT roman_Θ end_POSTSUBSCRIPT divide start_ARG caligraphic_L + caligraphic_L start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_ARG start_ARG 2 end_ARG</annotation></semantics></math>
<br class="ltx_break"/>Update corrector network params <math alttext="\Psi\leftarrow\Psi-\eta\nabla_{\Psi}\ell" class="ltx_Math" display="inline" id="alg2.36.m21.1"><semantics id="alg2.36.m21.1a"><mrow id="alg2.36.m21.1.1" xref="alg2.36.m21.1.1.cmml"><mi id="alg2.36.m21.1.1.2" mathvariant="normal" xref="alg2.36.m21.1.1.2.cmml">Ψ</mi><mo id="alg2.36.m21.1.1.1" stretchy="false" xref="alg2.36.m21.1.1.1.cmml">←</mo><mrow id="alg2.36.m21.1.1.3" xref="alg2.36.m21.1.1.3.cmml"><mi id="alg2.36.m21.1.1.3.2" mathvariant="normal" xref="alg2.36.m21.1.1.3.2.cmml">Ψ</mi><mo id="alg2.36.m21.1.1.3.1" xref="alg2.36.m21.1.1.3.1.cmml">−</mo><mrow id="alg2.36.m21.1.1.3.3" xref="alg2.36.m21.1.1.3.3.cmml"><mi id="alg2.36.m21.1.1.3.3.2" xref="alg2.36.m21.1.1.3.3.2.cmml">η</mi><mo id="alg2.36.m21.1.1.3.3.1" lspace="0.167em" xref="alg2.36.m21.1.1.3.3.1.cmml">⁢</mo><mrow id="alg2.36.m21.1.1.3.3.3" xref="alg2.36.m21.1.1.3.3.3.cmml"><msub id="alg2.36.m21.1.1.3.3.3.1" xref="alg2.36.m21.1.1.3.3.3.1.cmml"><mo id="alg2.36.m21.1.1.3.3.3.1.2" rspace="0.167em" xref="alg2.36.m21.1.1.3.3.3.1.2.cmml">∇</mo><mi id="alg2.36.m21.1.1.3.3.3.1.3" mathvariant="normal" xref="alg2.36.m21.1.1.3.3.3.1.3.cmml">Ψ</mi></msub><mi id="alg2.36.m21.1.1.3.3.3.2" mathvariant="normal" xref="alg2.36.m21.1.1.3.3.3.2.cmml">ℓ</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.36.m21.1b"><apply id="alg2.36.m21.1.1.cmml" xref="alg2.36.m21.1.1"><ci id="alg2.36.m21.1.1.1.cmml" xref="alg2.36.m21.1.1.1">←</ci><ci id="alg2.36.m21.1.1.2.cmml" xref="alg2.36.m21.1.1.2">Ψ</ci><apply id="alg2.36.m21.1.1.3.cmml" xref="alg2.36.m21.1.1.3"><minus id="alg2.36.m21.1.1.3.1.cmml" xref="alg2.36.m21.1.1.3.1"></minus><ci id="alg2.36.m21.1.1.3.2.cmml" xref="alg2.36.m21.1.1.3.2">Ψ</ci><apply id="alg2.36.m21.1.1.3.3.cmml" xref="alg2.36.m21.1.1.3.3"><times id="alg2.36.m21.1.1.3.3.1.cmml" xref="alg2.36.m21.1.1.3.3.1"></times><ci id="alg2.36.m21.1.1.3.3.2.cmml" xref="alg2.36.m21.1.1.3.3.2">𝜂</ci><apply id="alg2.36.m21.1.1.3.3.3.cmml" xref="alg2.36.m21.1.1.3.3.3"><apply id="alg2.36.m21.1.1.3.3.3.1.cmml" xref="alg2.36.m21.1.1.3.3.3.1"><csymbol cd="ambiguous" id="alg2.36.m21.1.1.3.3.3.1.1.cmml" xref="alg2.36.m21.1.1.3.3.3.1">subscript</csymbol><ci id="alg2.36.m21.1.1.3.3.3.1.2.cmml" xref="alg2.36.m21.1.1.3.3.3.1.2">∇</ci><ci id="alg2.36.m21.1.1.3.3.3.1.3.cmml" xref="alg2.36.m21.1.1.3.3.3.1.3">Ψ</ci></apply><ci id="alg2.36.m21.1.1.3.3.3.2.cmml" xref="alg2.36.m21.1.1.3.3.3.2">ℓ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.36.m21.1c">\Psi\leftarrow\Psi-\eta\nabla_{\Psi}\ell</annotation><annotation encoding="application/x-llamapun" id="alg2.36.m21.1d">roman_Ψ ← roman_Ψ - italic_η ∇ start_POSTSUBSCRIPT roman_Ψ end_POSTSUBSCRIPT roman_ℓ</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.40.1"> end while
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_listingline ltx_figure_panel" id="alg2.41">
</div>
</div>
</div>
</figure>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Analysis</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.3">We will explore the generalization of the proposed target corrector network in terms of unseen targets for a particular input data point, and will show the relationship between generalization error, the complexity of the target corrector network <math alttext="h" class="ltx_Math" display="inline" id="S4.p1.1.m1.1"><semantics id="S4.p1.1.m1.1a"><mi id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><ci id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">h</annotation><annotation encoding="application/x-llamapun" id="S4.p1.1.m1.1d">italic_h</annotation></semantics></math>, and the discrepancy of the stale representations, <math alttext="g^{\prime}" class="ltx_Math" display="inline" id="S4.p1.2.m2.1"><semantics id="S4.p1.2.m2.1a"><msup id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml"><mi id="S4.p1.2.m2.1.1.2" xref="S4.p1.2.m2.1.1.2.cmml">g</mi><mo id="S4.p1.2.m2.1.1.3" xref="S4.p1.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><apply id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p1.2.m2.1.1.1.cmml" xref="S4.p1.2.m2.1.1">superscript</csymbol><ci id="S4.p1.2.m2.1.1.2.cmml" xref="S4.p1.2.m2.1.1.2">𝑔</ci><ci id="S4.p1.2.m2.1.1.3.cmml" xref="S4.p1.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">g^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.2.m2.1d">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, and true representations <math alttext="g" class="ltx_Math" display="inline" id="S4.p1.3.m3.1"><semantics id="S4.p1.3.m3.1a"><mi id="S4.p1.3.m3.1.1" xref="S4.p1.3.m3.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S4.p1.3.m3.1b"><ci id="S4.p1.3.m3.1.1.cmml" xref="S4.p1.3.m3.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.3.m3.1c">g</annotation><annotation encoding="application/x-llamapun" id="S4.p1.3.m3.1d">italic_g</annotation></semantics></math>. All proofs are in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#A1" title="Appendix A Analysis: Proofs ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.1">Let <math alttext="\ell:\mathbb{R}\times\mathbb{R}\to\mathbb{R}" class="ltx_Math" display="inline" id="S4.p2.1.m1.1"><semantics id="S4.p2.1.m1.1a"><mrow id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml"><mi id="S4.p2.1.m1.1.1.2" mathvariant="normal" xref="S4.p2.1.m1.1.1.2.cmml">ℓ</mi><mo id="S4.p2.1.m1.1.1.1" lspace="0.278em" rspace="0.278em" xref="S4.p2.1.m1.1.1.1.cmml">:</mo><mrow id="S4.p2.1.m1.1.1.3" xref="S4.p2.1.m1.1.1.3.cmml"><mrow id="S4.p2.1.m1.1.1.3.2" xref="S4.p2.1.m1.1.1.3.2.cmml"><mi id="S4.p2.1.m1.1.1.3.2.2" xref="S4.p2.1.m1.1.1.3.2.2.cmml">ℝ</mi><mo id="S4.p2.1.m1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.p2.1.m1.1.1.3.2.1.cmml">×</mo><mi id="S4.p2.1.m1.1.1.3.2.3" xref="S4.p2.1.m1.1.1.3.2.3.cmml">ℝ</mi></mrow><mo id="S4.p2.1.m1.1.1.3.1" stretchy="false" xref="S4.p2.1.m1.1.1.3.1.cmml">→</mo><mi id="S4.p2.1.m1.1.1.3.3" xref="S4.p2.1.m1.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><apply id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1"><ci id="S4.p2.1.m1.1.1.1.cmml" xref="S4.p2.1.m1.1.1.1">:</ci><ci id="S4.p2.1.m1.1.1.2.cmml" xref="S4.p2.1.m1.1.1.2">ℓ</ci><apply id="S4.p2.1.m1.1.1.3.cmml" xref="S4.p2.1.m1.1.1.3"><ci id="S4.p2.1.m1.1.1.3.1.cmml" xref="S4.p2.1.m1.1.1.3.1">→</ci><apply id="S4.p2.1.m1.1.1.3.2.cmml" xref="S4.p2.1.m1.1.1.3.2"><times id="S4.p2.1.m1.1.1.3.2.1.cmml" xref="S4.p2.1.m1.1.1.3.2.1"></times><ci id="S4.p2.1.m1.1.1.3.2.2.cmml" xref="S4.p2.1.m1.1.1.3.2.2">ℝ</ci><ci id="S4.p2.1.m1.1.1.3.2.3.cmml" xref="S4.p2.1.m1.1.1.3.2.3">ℝ</ci></apply><ci id="S4.p2.1.m1.1.1.3.3.cmml" xref="S4.p2.1.m1.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">\ell:\mathbb{R}\times\mathbb{R}\to\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.1.m1.1d">roman_ℓ : blackboard_R × blackboard_R → blackboard_R</annotation></semantics></math> is a loss function for the target corrector network (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S3.E5" title="In 3 Improving Training with Target Correctors ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">5</span></a> &amp; <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S3.E6" title="In 3 Improving Training with Target Correctors ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">6</span></a>).</p>
</div>
<div class="ltx_para" id="S4.p3">
<p class="ltx_p" id="S4.p3.2">For any point <math alttext="x" class="ltx_Math" display="inline" id="S4.p3.1.m1.1"><semantics id="S4.p3.1.m1.1a"><mi id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><ci id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S4.p3.1.m1.1d">italic_x</annotation></semantics></math>, consider the distribution given by the softmax using stale approximation <math alttext="g^{\prime}" class="ltx_Math" display="inline" id="S4.p3.2.m2.1"><semantics id="S4.p3.2.m2.1a"><msup id="S4.p3.2.m2.1.1" xref="S4.p3.2.m2.1.1.cmml"><mi id="S4.p3.2.m2.1.1.2" xref="S4.p3.2.m2.1.1.2.cmml">g</mi><mo id="S4.p3.2.m2.1.1.3" xref="S4.p3.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.p3.2.m2.1b"><apply id="S4.p3.2.m2.1.1.cmml" xref="S4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p3.2.m2.1.1.1.cmml" xref="S4.p3.2.m2.1.1">superscript</csymbol><ci id="S4.p3.2.m2.1.1.2.cmml" xref="S4.p3.2.m2.1.1.2">𝑔</ci><ci id="S4.p3.2.m2.1.1.3.cmml" xref="S4.p3.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.2.m2.1c">g^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.p3.2.m2.1d">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\tilde{\mathscr{D}}_{Y}\triangleq{P}_{g^{\prime}}(y|x)=\frac{\exp(\beta\langle
f%
(x),g^{\prime}(y)\rangle)}{\sum_{y^{\prime}\in\mathcal{Y}}\exp(\beta\langle f(%
x),g^{\prime}(y^{\prime})\rangle)}," class="ltx_Math" display="block" id="S4.E9.m1.8"><semantics id="S4.E9.m1.8a"><mrow id="S4.E9.m1.8.8.1" xref="S4.E9.m1.8.8.1.1.cmml"><mrow id="S4.E9.m1.8.8.1.1" xref="S4.E9.m1.8.8.1.1.cmml"><msub id="S4.E9.m1.8.8.1.1.3" xref="S4.E9.m1.8.8.1.1.3.cmml"><mover accent="true" id="S4.E9.m1.8.8.1.1.3.2" xref="S4.E9.m1.8.8.1.1.3.2.cmml"><mi class="ltx_font_mathscript" id="S4.E9.m1.8.8.1.1.3.2.2" xref="S4.E9.m1.8.8.1.1.3.2.2.cmml">𝒟</mi><mo id="S4.E9.m1.8.8.1.1.3.2.1" xref="S4.E9.m1.8.8.1.1.3.2.1.cmml">~</mo></mover><mi id="S4.E9.m1.8.8.1.1.3.3" xref="S4.E9.m1.8.8.1.1.3.3.cmml">Y</mi></msub><mo id="S4.E9.m1.8.8.1.1.4" xref="S4.E9.m1.8.8.1.1.4.cmml">≜</mo><mrow id="S4.E9.m1.8.8.1.1.1" xref="S4.E9.m1.8.8.1.1.1.cmml"><msub id="S4.E9.m1.8.8.1.1.1.3" xref="S4.E9.m1.8.8.1.1.1.3.cmml"><mi id="S4.E9.m1.8.8.1.1.1.3.2" xref="S4.E9.m1.8.8.1.1.1.3.2.cmml">P</mi><msup id="S4.E9.m1.8.8.1.1.1.3.3" xref="S4.E9.m1.8.8.1.1.1.3.3.cmml"><mi id="S4.E9.m1.8.8.1.1.1.3.3.2" xref="S4.E9.m1.8.8.1.1.1.3.3.2.cmml">g</mi><mo id="S4.E9.m1.8.8.1.1.1.3.3.3" xref="S4.E9.m1.8.8.1.1.1.3.3.3.cmml">′</mo></msup></msub><mo id="S4.E9.m1.8.8.1.1.1.2" xref="S4.E9.m1.8.8.1.1.1.2.cmml">⁢</mo><mrow id="S4.E9.m1.8.8.1.1.1.1.1" xref="S4.E9.m1.8.8.1.1.1.1.1.1.cmml"><mo id="S4.E9.m1.8.8.1.1.1.1.1.2" stretchy="false" xref="S4.E9.m1.8.8.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.8.8.1.1.1.1.1.1" xref="S4.E9.m1.8.8.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.8.8.1.1.1.1.1.1.2" xref="S4.E9.m1.8.8.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S4.E9.m1.8.8.1.1.1.1.1.1.1" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1.cmml">|</mo><mi id="S4.E9.m1.8.8.1.1.1.1.1.1.3" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S4.E9.m1.8.8.1.1.1.1.1.3" stretchy="false" xref="S4.E9.m1.8.8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.8.8.1.1.5" xref="S4.E9.m1.8.8.1.1.5.cmml">=</mo><mfrac id="S4.E9.m1.7.7" xref="S4.E9.m1.7.7.cmml"><mrow id="S4.E9.m1.4.4.4.4" xref="S4.E9.m1.4.4.4.5.cmml"><mi id="S4.E9.m1.3.3.3.3" xref="S4.E9.m1.3.3.3.3.cmml">exp</mi><mo id="S4.E9.m1.4.4.4.4a" xref="S4.E9.m1.4.4.4.5.cmml">⁡</mo><mrow id="S4.E9.m1.4.4.4.4.1" xref="S4.E9.m1.4.4.4.5.cmml"><mo id="S4.E9.m1.4.4.4.4.1.2" stretchy="false" xref="S4.E9.m1.4.4.4.5.cmml">(</mo><mrow id="S4.E9.m1.4.4.4.4.1.1" xref="S4.E9.m1.4.4.4.4.1.1.cmml"><mi id="S4.E9.m1.4.4.4.4.1.1.4" xref="S4.E9.m1.4.4.4.4.1.1.4.cmml">β</mi><mo id="S4.E9.m1.4.4.4.4.1.1.3" xref="S4.E9.m1.4.4.4.4.1.1.3.cmml">⁢</mo><mrow id="S4.E9.m1.4.4.4.4.1.1.2.2" xref="S4.E9.m1.4.4.4.4.1.1.2.3.cmml"><mo id="S4.E9.m1.4.4.4.4.1.1.2.2.3" stretchy="false" xref="S4.E9.m1.4.4.4.4.1.1.2.3.cmml">⟨</mo><mrow id="S4.E9.m1.4.4.4.4.1.1.1.1.1" xref="S4.E9.m1.4.4.4.4.1.1.1.1.1.cmml"><mi id="S4.E9.m1.4.4.4.4.1.1.1.1.1.2" xref="S4.E9.m1.4.4.4.4.1.1.1.1.1.2.cmml">f</mi><mo id="S4.E9.m1.4.4.4.4.1.1.1.1.1.1" xref="S4.E9.m1.4.4.4.4.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E9.m1.4.4.4.4.1.1.1.1.1.3.2" xref="S4.E9.m1.4.4.4.4.1.1.1.1.1.cmml"><mo id="S4.E9.m1.4.4.4.4.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.E9.m1.4.4.4.4.1.1.1.1.1.cmml">(</mo><mi id="S4.E9.m1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml">x</mi><mo id="S4.E9.m1.4.4.4.4.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.E9.m1.4.4.4.4.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.4.4.4.4.1.1.2.2.4" xref="S4.E9.m1.4.4.4.4.1.1.2.3.cmml">,</mo><mrow id="S4.E9.m1.4.4.4.4.1.1.2.2.2" xref="S4.E9.m1.4.4.4.4.1.1.2.2.2.cmml"><msup id="S4.E9.m1.4.4.4.4.1.1.2.2.2.2" xref="S4.E9.m1.4.4.4.4.1.1.2.2.2.2.cmml"><mi id="S4.E9.m1.4.4.4.4.1.1.2.2.2.2.2" xref="S4.E9.m1.4.4.4.4.1.1.2.2.2.2.2.cmml">g</mi><mo id="S4.E9.m1.4.4.4.4.1.1.2.2.2.2.3" xref="S4.E9.m1.4.4.4.4.1.1.2.2.2.2.3.cmml">′</mo></msup><mo id="S4.E9.m1.4.4.4.4.1.1.2.2.2.1" xref="S4.E9.m1.4.4.4.4.1.1.2.2.2.1.cmml">⁢</mo><mrow id="S4.E9.m1.4.4.4.4.1.1.2.2.2.3.2" xref="S4.E9.m1.4.4.4.4.1.1.2.2.2.cmml"><mo id="S4.E9.m1.4.4.4.4.1.1.2.2.2.3.2.1" stretchy="false" xref="S4.E9.m1.4.4.4.4.1.1.2.2.2.cmml">(</mo><mi id="S4.E9.m1.2.2.2.2" xref="S4.E9.m1.2.2.2.2.cmml">y</mi><mo id="S4.E9.m1.4.4.4.4.1.1.2.2.2.3.2.2" stretchy="false" xref="S4.E9.m1.4.4.4.4.1.1.2.2.2.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.4.4.4.4.1.1.2.2.5" stretchy="false" xref="S4.E9.m1.4.4.4.4.1.1.2.3.cmml">⟩</mo></mrow></mrow><mo id="S4.E9.m1.4.4.4.4.1.3" stretchy="false" xref="S4.E9.m1.4.4.4.5.cmml">)</mo></mrow></mrow><mrow id="S4.E9.m1.7.7.7" xref="S4.E9.m1.7.7.7.cmml"><msub id="S4.E9.m1.7.7.7.4" xref="S4.E9.m1.7.7.7.4.cmml"><mo id="S4.E9.m1.7.7.7.4.2" xref="S4.E9.m1.7.7.7.4.2.cmml">∑</mo><mrow id="S4.E9.m1.7.7.7.4.3" xref="S4.E9.m1.7.7.7.4.3.cmml"><msup id="S4.E9.m1.7.7.7.4.3.2" xref="S4.E9.m1.7.7.7.4.3.2.cmml"><mi id="S4.E9.m1.7.7.7.4.3.2.2" xref="S4.E9.m1.7.7.7.4.3.2.2.cmml">y</mi><mo id="S4.E9.m1.7.7.7.4.3.2.3" xref="S4.E9.m1.7.7.7.4.3.2.3.cmml">′</mo></msup><mo id="S4.E9.m1.7.7.7.4.3.1" xref="S4.E9.m1.7.7.7.4.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.7.7.7.4.3.3" xref="S4.E9.m1.7.7.7.4.3.3.cmml">𝒴</mi></mrow></msub><mrow id="S4.E9.m1.7.7.7.3.1" xref="S4.E9.m1.7.7.7.3.2.cmml"><mi id="S4.E9.m1.6.6.6.2" xref="S4.E9.m1.6.6.6.2.cmml">exp</mi><mo id="S4.E9.m1.7.7.7.3.1a" xref="S4.E9.m1.7.7.7.3.2.cmml">⁡</mo><mrow id="S4.E9.m1.7.7.7.3.1.1" xref="S4.E9.m1.7.7.7.3.2.cmml"><mo id="S4.E9.m1.7.7.7.3.1.1.2" stretchy="false" xref="S4.E9.m1.7.7.7.3.2.cmml">(</mo><mrow id="S4.E9.m1.7.7.7.3.1.1.1" xref="S4.E9.m1.7.7.7.3.1.1.1.cmml"><mi id="S4.E9.m1.7.7.7.3.1.1.1.4" xref="S4.E9.m1.7.7.7.3.1.1.1.4.cmml">β</mi><mo id="S4.E9.m1.7.7.7.3.1.1.1.3" xref="S4.E9.m1.7.7.7.3.1.1.1.3.cmml">⁢</mo><mrow id="S4.E9.m1.7.7.7.3.1.1.1.2.2" xref="S4.E9.m1.7.7.7.3.1.1.1.2.3.cmml"><mo id="S4.E9.m1.7.7.7.3.1.1.1.2.2.3" stretchy="false" xref="S4.E9.m1.7.7.7.3.1.1.1.2.3.cmml">⟨</mo><mrow id="S4.E9.m1.7.7.7.3.1.1.1.1.1.1" xref="S4.E9.m1.7.7.7.3.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.7.7.7.3.1.1.1.1.1.1.2" xref="S4.E9.m1.7.7.7.3.1.1.1.1.1.1.2.cmml">f</mi><mo id="S4.E9.m1.7.7.7.3.1.1.1.1.1.1.1" xref="S4.E9.m1.7.7.7.3.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E9.m1.7.7.7.3.1.1.1.1.1.1.3.2" xref="S4.E9.m1.7.7.7.3.1.1.1.1.1.1.cmml"><mo id="S4.E9.m1.7.7.7.3.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.E9.m1.7.7.7.3.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E9.m1.5.5.5.1" xref="S4.E9.m1.5.5.5.1.cmml">x</mi><mo id="S4.E9.m1.7.7.7.3.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.E9.m1.7.7.7.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.7.7.7.3.1.1.1.2.2.4" xref="S4.E9.m1.7.7.7.3.1.1.1.2.3.cmml">,</mo><mrow id="S4.E9.m1.7.7.7.3.1.1.1.2.2.2" xref="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.cmml"><msup id="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.3" xref="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.3.cmml"><mi id="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.3.2" xref="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.3.2.cmml">g</mi><mo id="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.3.3" xref="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.3.3.cmml">′</mo></msup><mo id="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.2" xref="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.2.cmml">⁢</mo><mrow id="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.1.1" xref="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.1.1.1.cmml"><mo id="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.1.1.2" stretchy="false" xref="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.1.1.1.cmml">(</mo><msup id="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.1.1.1" xref="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.1.1.1.cmml"><mi id="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.1.1.1.2" xref="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.1.1.1.2.cmml">y</mi><mo id="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.1.1.1.3" xref="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.1.1.1.3.cmml">′</mo></msup><mo id="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.1.1.3" stretchy="false" xref="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.7.7.7.3.1.1.1.2.2.5" stretchy="false" xref="S4.E9.m1.7.7.7.3.1.1.1.2.3.cmml">⟩</mo></mrow></mrow><mo id="S4.E9.m1.7.7.7.3.1.1.3" stretchy="false" xref="S4.E9.m1.7.7.7.3.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S4.E9.m1.8.8.1.2" xref="S4.E9.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.8b"><apply id="S4.E9.m1.8.8.1.1.cmml" xref="S4.E9.m1.8.8.1"><and id="S4.E9.m1.8.8.1.1a.cmml" xref="S4.E9.m1.8.8.1"></and><apply id="S4.E9.m1.8.8.1.1b.cmml" xref="S4.E9.m1.8.8.1"><ci id="S4.E9.m1.8.8.1.1.4.cmml" xref="S4.E9.m1.8.8.1.1.4">≜</ci><apply id="S4.E9.m1.8.8.1.1.3.cmml" xref="S4.E9.m1.8.8.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.8.8.1.1.3.1.cmml" xref="S4.E9.m1.8.8.1.1.3">subscript</csymbol><apply id="S4.E9.m1.8.8.1.1.3.2.cmml" xref="S4.E9.m1.8.8.1.1.3.2"><ci id="S4.E9.m1.8.8.1.1.3.2.1.cmml" xref="S4.E9.m1.8.8.1.1.3.2.1">~</ci><ci id="S4.E9.m1.8.8.1.1.3.2.2.cmml" xref="S4.E9.m1.8.8.1.1.3.2.2">𝒟</ci></apply><ci id="S4.E9.m1.8.8.1.1.3.3.cmml" xref="S4.E9.m1.8.8.1.1.3.3">𝑌</ci></apply><apply id="S4.E9.m1.8.8.1.1.1.cmml" xref="S4.E9.m1.8.8.1.1.1"><times id="S4.E9.m1.8.8.1.1.1.2.cmml" xref="S4.E9.m1.8.8.1.1.1.2"></times><apply id="S4.E9.m1.8.8.1.1.1.3.cmml" xref="S4.E9.m1.8.8.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.8.8.1.1.1.3.1.cmml" xref="S4.E9.m1.8.8.1.1.1.3">subscript</csymbol><ci id="S4.E9.m1.8.8.1.1.1.3.2.cmml" xref="S4.E9.m1.8.8.1.1.1.3.2">𝑃</ci><apply id="S4.E9.m1.8.8.1.1.1.3.3.cmml" xref="S4.E9.m1.8.8.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.8.8.1.1.1.3.3.1.cmml" xref="S4.E9.m1.8.8.1.1.1.3.3">superscript</csymbol><ci id="S4.E9.m1.8.8.1.1.1.3.3.2.cmml" xref="S4.E9.m1.8.8.1.1.1.3.3.2">𝑔</ci><ci id="S4.E9.m1.8.8.1.1.1.3.3.3.cmml" xref="S4.E9.m1.8.8.1.1.1.3.3.3">′</ci></apply></apply><apply id="S4.E9.m1.8.8.1.1.1.1.1.1.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1"><csymbol cd="latexml" id="S4.E9.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E9.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.2">𝑦</ci><ci id="S4.E9.m1.8.8.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.8.8.1.1.1.1.1.1.3">𝑥</ci></apply></apply></apply><apply id="S4.E9.m1.8.8.1.1c.cmml" xref="S4.E9.m1.8.8.1"><eq id="S4.E9.m1.8.8.1.1.5.cmml" xref="S4.E9.m1.8.8.1.1.5"></eq><share href="https://arxiv.org/html/2409.01890v1#S4.E9.m1.8.8.1.1.1.cmml" id="S4.E9.m1.8.8.1.1d.cmml" xref="S4.E9.m1.8.8.1"></share><apply id="S4.E9.m1.7.7.cmml" xref="S4.E9.m1.7.7"><divide id="S4.E9.m1.7.7.8.cmml" xref="S4.E9.m1.7.7"></divide><apply id="S4.E9.m1.4.4.4.5.cmml" xref="S4.E9.m1.4.4.4.4"><exp id="S4.E9.m1.3.3.3.3.cmml" xref="S4.E9.m1.3.3.3.3"></exp><apply id="S4.E9.m1.4.4.4.4.1.1.cmml" xref="S4.E9.m1.4.4.4.4.1.1"><times id="S4.E9.m1.4.4.4.4.1.1.3.cmml" xref="S4.E9.m1.4.4.4.4.1.1.3"></times><ci id="S4.E9.m1.4.4.4.4.1.1.4.cmml" xref="S4.E9.m1.4.4.4.4.1.1.4">𝛽</ci><list id="S4.E9.m1.4.4.4.4.1.1.2.3.cmml" xref="S4.E9.m1.4.4.4.4.1.1.2.2"><apply id="S4.E9.m1.4.4.4.4.1.1.1.1.1.cmml" xref="S4.E9.m1.4.4.4.4.1.1.1.1.1"><times id="S4.E9.m1.4.4.4.4.1.1.1.1.1.1.cmml" xref="S4.E9.m1.4.4.4.4.1.1.1.1.1.1"></times><ci id="S4.E9.m1.4.4.4.4.1.1.1.1.1.2.cmml" xref="S4.E9.m1.4.4.4.4.1.1.1.1.1.2">𝑓</ci><ci id="S4.E9.m1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1">𝑥</ci></apply><apply id="S4.E9.m1.4.4.4.4.1.1.2.2.2.cmml" xref="S4.E9.m1.4.4.4.4.1.1.2.2.2"><times id="S4.E9.m1.4.4.4.4.1.1.2.2.2.1.cmml" xref="S4.E9.m1.4.4.4.4.1.1.2.2.2.1"></times><apply id="S4.E9.m1.4.4.4.4.1.1.2.2.2.2.cmml" xref="S4.E9.m1.4.4.4.4.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.4.4.1.1.2.2.2.2.1.cmml" xref="S4.E9.m1.4.4.4.4.1.1.2.2.2.2">superscript</csymbol><ci id="S4.E9.m1.4.4.4.4.1.1.2.2.2.2.2.cmml" xref="S4.E9.m1.4.4.4.4.1.1.2.2.2.2.2">𝑔</ci><ci id="S4.E9.m1.4.4.4.4.1.1.2.2.2.2.3.cmml" xref="S4.E9.m1.4.4.4.4.1.1.2.2.2.2.3">′</ci></apply><ci id="S4.E9.m1.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2">𝑦</ci></apply></list></apply></apply><apply id="S4.E9.m1.7.7.7.cmml" xref="S4.E9.m1.7.7.7"><apply id="S4.E9.m1.7.7.7.4.cmml" xref="S4.E9.m1.7.7.7.4"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.7.4.1.cmml" xref="S4.E9.m1.7.7.7.4">subscript</csymbol><sum id="S4.E9.m1.7.7.7.4.2.cmml" xref="S4.E9.m1.7.7.7.4.2"></sum><apply id="S4.E9.m1.7.7.7.4.3.cmml" xref="S4.E9.m1.7.7.7.4.3"><in id="S4.E9.m1.7.7.7.4.3.1.cmml" xref="S4.E9.m1.7.7.7.4.3.1"></in><apply id="S4.E9.m1.7.7.7.4.3.2.cmml" xref="S4.E9.m1.7.7.7.4.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.7.4.3.2.1.cmml" xref="S4.E9.m1.7.7.7.4.3.2">superscript</csymbol><ci id="S4.E9.m1.7.7.7.4.3.2.2.cmml" xref="S4.E9.m1.7.7.7.4.3.2.2">𝑦</ci><ci id="S4.E9.m1.7.7.7.4.3.2.3.cmml" xref="S4.E9.m1.7.7.7.4.3.2.3">′</ci></apply><ci id="S4.E9.m1.7.7.7.4.3.3.cmml" xref="S4.E9.m1.7.7.7.4.3.3">𝒴</ci></apply></apply><apply id="S4.E9.m1.7.7.7.3.2.cmml" xref="S4.E9.m1.7.7.7.3.1"><exp id="S4.E9.m1.6.6.6.2.cmml" xref="S4.E9.m1.6.6.6.2"></exp><apply id="S4.E9.m1.7.7.7.3.1.1.1.cmml" xref="S4.E9.m1.7.7.7.3.1.1.1"><times id="S4.E9.m1.7.7.7.3.1.1.1.3.cmml" xref="S4.E9.m1.7.7.7.3.1.1.1.3"></times><ci id="S4.E9.m1.7.7.7.3.1.1.1.4.cmml" xref="S4.E9.m1.7.7.7.3.1.1.1.4">𝛽</ci><list id="S4.E9.m1.7.7.7.3.1.1.1.2.3.cmml" xref="S4.E9.m1.7.7.7.3.1.1.1.2.2"><apply id="S4.E9.m1.7.7.7.3.1.1.1.1.1.1.cmml" xref="S4.E9.m1.7.7.7.3.1.1.1.1.1.1"><times id="S4.E9.m1.7.7.7.3.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.7.7.7.3.1.1.1.1.1.1.1"></times><ci id="S4.E9.m1.7.7.7.3.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.7.7.7.3.1.1.1.1.1.1.2">𝑓</ci><ci id="S4.E9.m1.5.5.5.1.cmml" xref="S4.E9.m1.5.5.5.1">𝑥</ci></apply><apply id="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.cmml" xref="S4.E9.m1.7.7.7.3.1.1.1.2.2.2"><times id="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.2.cmml" xref="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.2"></times><apply id="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.3.cmml" xref="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.3.1.cmml" xref="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.3">superscript</csymbol><ci id="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.3.2.cmml" xref="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.3.2">𝑔</ci><ci id="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.3.3.cmml" xref="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.3.3">′</ci></apply><apply id="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.1.1.1.cmml" xref="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.1.1.1.1.cmml" xref="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.1.1">superscript</csymbol><ci id="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.1.1.1.2.cmml" xref="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.1.1.1.2">𝑦</ci><ci id="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.1.1.1.3.cmml" xref="S4.E9.m1.7.7.7.3.1.1.1.2.2.2.1.1.1.3">′</ci></apply></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.8c">\tilde{\mathscr{D}}_{Y}\triangleq{P}_{g^{\prime}}(y|x)=\frac{\exp(\beta\langle
f%
(x),g^{\prime}(y)\rangle)}{\sum_{y^{\prime}\in\mathcal{Y}}\exp(\beta\langle f(%
x),g^{\prime}(y^{\prime})\rangle)},</annotation><annotation encoding="application/x-llamapun" id="S4.E9.m1.8d">over~ start_ARG script_D end_ARG start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT ≜ italic_P start_POSTSUBSCRIPT italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_y | italic_x ) = divide start_ARG roman_exp ( italic_β ⟨ italic_f ( italic_x ) , italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y ) ⟩ ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ caligraphic_Y end_POSTSUBSCRIPT roman_exp ( italic_β ⟨ italic_f ( italic_x ) , italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ⟩ ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.p3.4">and similarly define <math alttext="{\mathscr{D}}_{Y}\triangleq{P}_{g}(y|x)" class="ltx_Math" display="inline" id="S4.p3.3.m1.1"><semantics id="S4.p3.3.m1.1a"><mrow id="S4.p3.3.m1.1.1" xref="S4.p3.3.m1.1.1.cmml"><msub id="S4.p3.3.m1.1.1.3" xref="S4.p3.3.m1.1.1.3.cmml"><mi class="ltx_font_mathscript" id="S4.p3.3.m1.1.1.3.2" xref="S4.p3.3.m1.1.1.3.2.cmml">𝒟</mi><mi id="S4.p3.3.m1.1.1.3.3" xref="S4.p3.3.m1.1.1.3.3.cmml">Y</mi></msub><mo id="S4.p3.3.m1.1.1.2" xref="S4.p3.3.m1.1.1.2.cmml">≜</mo><mrow id="S4.p3.3.m1.1.1.1" xref="S4.p3.3.m1.1.1.1.cmml"><msub id="S4.p3.3.m1.1.1.1.3" xref="S4.p3.3.m1.1.1.1.3.cmml"><mi id="S4.p3.3.m1.1.1.1.3.2" xref="S4.p3.3.m1.1.1.1.3.2.cmml">P</mi><mi id="S4.p3.3.m1.1.1.1.3.3" xref="S4.p3.3.m1.1.1.1.3.3.cmml">g</mi></msub><mo id="S4.p3.3.m1.1.1.1.2" xref="S4.p3.3.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.p3.3.m1.1.1.1.1.1" xref="S4.p3.3.m1.1.1.1.1.1.1.cmml"><mo id="S4.p3.3.m1.1.1.1.1.1.2" stretchy="false" xref="S4.p3.3.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.p3.3.m1.1.1.1.1.1.1" xref="S4.p3.3.m1.1.1.1.1.1.1.cmml"><mi id="S4.p3.3.m1.1.1.1.1.1.1.2" xref="S4.p3.3.m1.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S4.p3.3.m1.1.1.1.1.1.1.1" xref="S4.p3.3.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S4.p3.3.m1.1.1.1.1.1.1.3" xref="S4.p3.3.m1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S4.p3.3.m1.1.1.1.1.1.3" stretchy="false" xref="S4.p3.3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.3.m1.1b"><apply id="S4.p3.3.m1.1.1.cmml" xref="S4.p3.3.m1.1.1"><ci id="S4.p3.3.m1.1.1.2.cmml" xref="S4.p3.3.m1.1.1.2">≜</ci><apply id="S4.p3.3.m1.1.1.3.cmml" xref="S4.p3.3.m1.1.1.3"><csymbol cd="ambiguous" id="S4.p3.3.m1.1.1.3.1.cmml" xref="S4.p3.3.m1.1.1.3">subscript</csymbol><ci id="S4.p3.3.m1.1.1.3.2.cmml" xref="S4.p3.3.m1.1.1.3.2">𝒟</ci><ci id="S4.p3.3.m1.1.1.3.3.cmml" xref="S4.p3.3.m1.1.1.3.3">𝑌</ci></apply><apply id="S4.p3.3.m1.1.1.1.cmml" xref="S4.p3.3.m1.1.1.1"><times id="S4.p3.3.m1.1.1.1.2.cmml" xref="S4.p3.3.m1.1.1.1.2"></times><apply id="S4.p3.3.m1.1.1.1.3.cmml" xref="S4.p3.3.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.p3.3.m1.1.1.1.3.1.cmml" xref="S4.p3.3.m1.1.1.1.3">subscript</csymbol><ci id="S4.p3.3.m1.1.1.1.3.2.cmml" xref="S4.p3.3.m1.1.1.1.3.2">𝑃</ci><ci id="S4.p3.3.m1.1.1.1.3.3.cmml" xref="S4.p3.3.m1.1.1.1.3.3">𝑔</ci></apply><apply id="S4.p3.3.m1.1.1.1.1.1.1.cmml" xref="S4.p3.3.m1.1.1.1.1.1"><csymbol cd="latexml" id="S4.p3.3.m1.1.1.1.1.1.1.1.cmml" xref="S4.p3.3.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.p3.3.m1.1.1.1.1.1.1.2.cmml" xref="S4.p3.3.m1.1.1.1.1.1.1.2">𝑦</ci><ci id="S4.p3.3.m1.1.1.1.1.1.1.3.cmml" xref="S4.p3.3.m1.1.1.1.1.1.1.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.3.m1.1c">{\mathscr{D}}_{Y}\triangleq{P}_{g}(y|x)</annotation><annotation encoding="application/x-llamapun" id="S4.p3.3.m1.1d">script_D start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT ≜ italic_P start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT ( italic_y | italic_x )</annotation></semantics></math> as the true distribution, using <math alttext="g" class="ltx_Math" display="inline" id="S4.p3.4.m2.1"><semantics id="S4.p3.4.m2.1a"><mi id="S4.p3.4.m2.1.1" xref="S4.p3.4.m2.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S4.p3.4.m2.1b"><ci id="S4.p3.4.m2.1.1.cmml" xref="S4.p3.4.m2.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.4.m2.1c">g</annotation><annotation encoding="application/x-llamapun" id="S4.p3.4.m2.1d">italic_g</annotation></semantics></math> (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S2.E1" title="In 2 Background ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
<div class="ltx_para" id="S4.p4">
<p class="ltx_p" id="S4.p4.1">We begin by defining three kinds of risk.</p>
</div>
<div class="ltx_para" id="S4.p5">
<p class="ltx_p" id="S4.p5.3"><span class="ltx_text ltx_font_bold" id="S4.p5.3.1">Empirical Risk </span> On a set of <math alttext="n" class="ltx_Math" display="inline" id="S4.p5.1.m1.1"><semantics id="S4.p5.1.m1.1a"><mi id="S4.p5.1.m1.1.1" xref="S4.p5.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.p5.1.m1.1b"><ci id="S4.p5.1.m1.1.1.cmml" xref="S4.p5.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.p5.1.m1.1d">italic_n</annotation></semantics></math>-targets <math alttext="\tilde{\mathscr{S}}_{n}=\{y_{1},...,y_{n}\}" class="ltx_Math" display="inline" id="S4.p5.2.m2.3"><semantics id="S4.p5.2.m2.3a"><mrow id="S4.p5.2.m2.3.3" xref="S4.p5.2.m2.3.3.cmml"><msub id="S4.p5.2.m2.3.3.4" xref="S4.p5.2.m2.3.3.4.cmml"><mover accent="true" id="S4.p5.2.m2.3.3.4.2" xref="S4.p5.2.m2.3.3.4.2.cmml"><mi class="ltx_font_mathscript" id="S4.p5.2.m2.3.3.4.2.2" xref="S4.p5.2.m2.3.3.4.2.2.cmml">𝒮</mi><mo id="S4.p5.2.m2.3.3.4.2.1" xref="S4.p5.2.m2.3.3.4.2.1.cmml">~</mo></mover><mi id="S4.p5.2.m2.3.3.4.3" xref="S4.p5.2.m2.3.3.4.3.cmml">n</mi></msub><mo id="S4.p5.2.m2.3.3.3" xref="S4.p5.2.m2.3.3.3.cmml">=</mo><mrow id="S4.p5.2.m2.3.3.2.2" xref="S4.p5.2.m2.3.3.2.3.cmml"><mo id="S4.p5.2.m2.3.3.2.2.3" stretchy="false" xref="S4.p5.2.m2.3.3.2.3.cmml">{</mo><msub id="S4.p5.2.m2.2.2.1.1.1" xref="S4.p5.2.m2.2.2.1.1.1.cmml"><mi id="S4.p5.2.m2.2.2.1.1.1.2" xref="S4.p5.2.m2.2.2.1.1.1.2.cmml">y</mi><mn id="S4.p5.2.m2.2.2.1.1.1.3" xref="S4.p5.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.p5.2.m2.3.3.2.2.4" xref="S4.p5.2.m2.3.3.2.3.cmml">,</mo><mi id="S4.p5.2.m2.1.1" mathvariant="normal" xref="S4.p5.2.m2.1.1.cmml">…</mi><mo id="S4.p5.2.m2.3.3.2.2.5" xref="S4.p5.2.m2.3.3.2.3.cmml">,</mo><msub id="S4.p5.2.m2.3.3.2.2.2" xref="S4.p5.2.m2.3.3.2.2.2.cmml"><mi id="S4.p5.2.m2.3.3.2.2.2.2" xref="S4.p5.2.m2.3.3.2.2.2.2.cmml">y</mi><mi id="S4.p5.2.m2.3.3.2.2.2.3" xref="S4.p5.2.m2.3.3.2.2.2.3.cmml">n</mi></msub><mo id="S4.p5.2.m2.3.3.2.2.6" stretchy="false" xref="S4.p5.2.m2.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p5.2.m2.3b"><apply id="S4.p5.2.m2.3.3.cmml" xref="S4.p5.2.m2.3.3"><eq id="S4.p5.2.m2.3.3.3.cmml" xref="S4.p5.2.m2.3.3.3"></eq><apply id="S4.p5.2.m2.3.3.4.cmml" xref="S4.p5.2.m2.3.3.4"><csymbol cd="ambiguous" id="S4.p5.2.m2.3.3.4.1.cmml" xref="S4.p5.2.m2.3.3.4">subscript</csymbol><apply id="S4.p5.2.m2.3.3.4.2.cmml" xref="S4.p5.2.m2.3.3.4.2"><ci id="S4.p5.2.m2.3.3.4.2.1.cmml" xref="S4.p5.2.m2.3.3.4.2.1">~</ci><ci id="S4.p5.2.m2.3.3.4.2.2.cmml" xref="S4.p5.2.m2.3.3.4.2.2">𝒮</ci></apply><ci id="S4.p5.2.m2.3.3.4.3.cmml" xref="S4.p5.2.m2.3.3.4.3">𝑛</ci></apply><set id="S4.p5.2.m2.3.3.2.3.cmml" xref="S4.p5.2.m2.3.3.2.2"><apply id="S4.p5.2.m2.2.2.1.1.1.cmml" xref="S4.p5.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.p5.2.m2.2.2.1.1.1.1.cmml" xref="S4.p5.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S4.p5.2.m2.2.2.1.1.1.2.cmml" xref="S4.p5.2.m2.2.2.1.1.1.2">𝑦</ci><cn id="S4.p5.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S4.p5.2.m2.2.2.1.1.1.3">1</cn></apply><ci id="S4.p5.2.m2.1.1.cmml" xref="S4.p5.2.m2.1.1">…</ci><apply id="S4.p5.2.m2.3.3.2.2.2.cmml" xref="S4.p5.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.p5.2.m2.3.3.2.2.2.1.cmml" xref="S4.p5.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S4.p5.2.m2.3.3.2.2.2.2.cmml" xref="S4.p5.2.m2.3.3.2.2.2.2">𝑦</ci><ci id="S4.p5.2.m2.3.3.2.2.2.3.cmml" xref="S4.p5.2.m2.3.3.2.2.2.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.2.m2.3c">\tilde{\mathscr{S}}_{n}=\{y_{1},...,y_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S4.p5.2.m2.3d">over~ start_ARG script_S end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT = { italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_y start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math> sampled from <math alttext="\tilde{\mathscr{D}}_{Y}" class="ltx_Math" display="inline" id="S4.p5.3.m3.1"><semantics id="S4.p5.3.m3.1a"><msub id="S4.p5.3.m3.1.1" xref="S4.p5.3.m3.1.1.cmml"><mover accent="true" id="S4.p5.3.m3.1.1.2" xref="S4.p5.3.m3.1.1.2.cmml"><mi class="ltx_font_mathscript" id="S4.p5.3.m3.1.1.2.2" xref="S4.p5.3.m3.1.1.2.2.cmml">𝒟</mi><mo id="S4.p5.3.m3.1.1.2.1" xref="S4.p5.3.m3.1.1.2.1.cmml">~</mo></mover><mi id="S4.p5.3.m3.1.1.3" xref="S4.p5.3.m3.1.1.3.cmml">Y</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p5.3.m3.1b"><apply id="S4.p5.3.m3.1.1.cmml" xref="S4.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p5.3.m3.1.1.1.cmml" xref="S4.p5.3.m3.1.1">subscript</csymbol><apply id="S4.p5.3.m3.1.1.2.cmml" xref="S4.p5.3.m3.1.1.2"><ci id="S4.p5.3.m3.1.1.2.1.cmml" xref="S4.p5.3.m3.1.1.2.1">~</ci><ci id="S4.p5.3.m3.1.1.2.2.cmml" xref="S4.p5.3.m3.1.1.2.2">𝒟</ci></apply><ci id="S4.p5.3.m3.1.1.3.cmml" xref="S4.p5.3.m3.1.1.3">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.3.m3.1c">\tilde{\mathscr{D}}_{Y}</annotation><annotation encoding="application/x-llamapun" id="S4.p5.3.m3.1d">over~ start_ARG script_D end_ARG start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT</annotation></semantics></math>, we minimize the empirical risk:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="R_{\ell,{\phi}}(\tilde{\mathscr{S}}_{n})=\frac{1}{n}\sum_{i=1}^{n}\ell(\phi(y_%
{i}),g(y_{i}))," class="ltx_Math" display="block" id="S4.E10.m1.3"><semantics id="S4.E10.m1.3a"><mrow id="S4.E10.m1.3.3.1" xref="S4.E10.m1.3.3.1.1.cmml"><mrow id="S4.E10.m1.3.3.1.1" xref="S4.E10.m1.3.3.1.1.cmml"><mrow id="S4.E10.m1.3.3.1.1.1" xref="S4.E10.m1.3.3.1.1.1.cmml"><msub id="S4.E10.m1.3.3.1.1.1.3" xref="S4.E10.m1.3.3.1.1.1.3.cmml"><mi id="S4.E10.m1.3.3.1.1.1.3.2" xref="S4.E10.m1.3.3.1.1.1.3.2.cmml">R</mi><mrow id="S4.E10.m1.2.2.2.4" xref="S4.E10.m1.2.2.2.3.cmml"><mi id="S4.E10.m1.1.1.1.1" mathvariant="normal" xref="S4.E10.m1.1.1.1.1.cmml">ℓ</mi><mo id="S4.E10.m1.2.2.2.4.1" xref="S4.E10.m1.2.2.2.3.cmml">,</mo><mi id="S4.E10.m1.2.2.2.2" xref="S4.E10.m1.2.2.2.2.cmml">ϕ</mi></mrow></msub><mo id="S4.E10.m1.3.3.1.1.1.2" xref="S4.E10.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.E10.m1.3.3.1.1.1.1.1" xref="S4.E10.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S4.E10.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S4.E10.m1.3.3.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E10.m1.3.3.1.1.1.1.1.1" xref="S4.E10.m1.3.3.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.E10.m1.3.3.1.1.1.1.1.1.2" xref="S4.E10.m1.3.3.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathscript" id="S4.E10.m1.3.3.1.1.1.1.1.1.2.2" xref="S4.E10.m1.3.3.1.1.1.1.1.1.2.2.cmml">𝒮</mi><mo id="S4.E10.m1.3.3.1.1.1.1.1.1.2.1" xref="S4.E10.m1.3.3.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S4.E10.m1.3.3.1.1.1.1.1.1.3" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.cmml">n</mi></msub><mo id="S4.E10.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S4.E10.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E10.m1.3.3.1.1.4" xref="S4.E10.m1.3.3.1.1.4.cmml">=</mo><mrow id="S4.E10.m1.3.3.1.1.3" xref="S4.E10.m1.3.3.1.1.3.cmml"><mfrac id="S4.E10.m1.3.3.1.1.3.4" xref="S4.E10.m1.3.3.1.1.3.4.cmml"><mn id="S4.E10.m1.3.3.1.1.3.4.2" xref="S4.E10.m1.3.3.1.1.3.4.2.cmml">1</mn><mi id="S4.E10.m1.3.3.1.1.3.4.3" xref="S4.E10.m1.3.3.1.1.3.4.3.cmml">n</mi></mfrac><mo id="S4.E10.m1.3.3.1.1.3.3" xref="S4.E10.m1.3.3.1.1.3.3.cmml">⁢</mo><mrow id="S4.E10.m1.3.3.1.1.3.2" xref="S4.E10.m1.3.3.1.1.3.2.cmml"><munderover id="S4.E10.m1.3.3.1.1.3.2.3" xref="S4.E10.m1.3.3.1.1.3.2.3.cmml"><mo id="S4.E10.m1.3.3.1.1.3.2.3.2.2" movablelimits="false" xref="S4.E10.m1.3.3.1.1.3.2.3.2.2.cmml">∑</mo><mrow id="S4.E10.m1.3.3.1.1.3.2.3.2.3" xref="S4.E10.m1.3.3.1.1.3.2.3.2.3.cmml"><mi id="S4.E10.m1.3.3.1.1.3.2.3.2.3.2" xref="S4.E10.m1.3.3.1.1.3.2.3.2.3.2.cmml">i</mi><mo id="S4.E10.m1.3.3.1.1.3.2.3.2.3.1" xref="S4.E10.m1.3.3.1.1.3.2.3.2.3.1.cmml">=</mo><mn id="S4.E10.m1.3.3.1.1.3.2.3.2.3.3" xref="S4.E10.m1.3.3.1.1.3.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E10.m1.3.3.1.1.3.2.3.3" xref="S4.E10.m1.3.3.1.1.3.2.3.3.cmml">n</mi></munderover><mrow id="S4.E10.m1.3.3.1.1.3.2.2" xref="S4.E10.m1.3.3.1.1.3.2.2.cmml"><mi id="S4.E10.m1.3.3.1.1.3.2.2.4" mathvariant="normal" xref="S4.E10.m1.3.3.1.1.3.2.2.4.cmml">ℓ</mi><mo id="S4.E10.m1.3.3.1.1.3.2.2.3" xref="S4.E10.m1.3.3.1.1.3.2.2.3.cmml">⁢</mo><mrow id="S4.E10.m1.3.3.1.1.3.2.2.2.2" xref="S4.E10.m1.3.3.1.1.3.2.2.2.3.cmml"><mo id="S4.E10.m1.3.3.1.1.3.2.2.2.2.3" stretchy="false" xref="S4.E10.m1.3.3.1.1.3.2.2.2.3.cmml">(</mo><mrow id="S4.E10.m1.3.3.1.1.2.1.1.1.1.1" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.cmml"><mi id="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.3" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.3.cmml">ϕ</mi><mo id="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.2" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.1.1" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.1.1.1" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.3" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E10.m1.3.3.1.1.3.2.2.2.2.4" xref="S4.E10.m1.3.3.1.1.3.2.2.2.3.cmml">,</mo><mrow id="S4.E10.m1.3.3.1.1.3.2.2.2.2.2" xref="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.cmml"><mi id="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.3" xref="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.3.cmml">g</mi><mo id="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.2" xref="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.2.cmml">⁢</mo><mrow id="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.1.1" xref="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.1.1.1.cmml"><mo id="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.1.1.2" stretchy="false" xref="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.1.1.1.cmml">(</mo><msub id="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.1.1.1" xref="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.1.1.1.cmml"><mi id="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.1.1.1.2" xref="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.1.1.1.2.cmml">y</mi><mi id="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.1.1.1.3" xref="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.1.1.3" stretchy="false" xref="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E10.m1.3.3.1.1.3.2.2.2.2.5" stretchy="false" xref="S4.E10.m1.3.3.1.1.3.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E10.m1.3.3.1.2" xref="S4.E10.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.3b"><apply id="S4.E10.m1.3.3.1.1.cmml" xref="S4.E10.m1.3.3.1"><eq id="S4.E10.m1.3.3.1.1.4.cmml" xref="S4.E10.m1.3.3.1.1.4"></eq><apply id="S4.E10.m1.3.3.1.1.1.cmml" xref="S4.E10.m1.3.3.1.1.1"><times id="S4.E10.m1.3.3.1.1.1.2.cmml" xref="S4.E10.m1.3.3.1.1.1.2"></times><apply id="S4.E10.m1.3.3.1.1.1.3.cmml" xref="S4.E10.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.1.1.1.3.1.cmml" xref="S4.E10.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S4.E10.m1.3.3.1.1.1.3.2.cmml" xref="S4.E10.m1.3.3.1.1.1.3.2">𝑅</ci><list id="S4.E10.m1.2.2.2.3.cmml" xref="S4.E10.m1.2.2.2.4"><ci id="S4.E10.m1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1">ℓ</ci><ci id="S4.E10.m1.2.2.2.2.cmml" xref="S4.E10.m1.2.2.2.2">italic-ϕ</ci></list></apply><apply id="S4.E10.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1">subscript</csymbol><apply id="S4.E10.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.2"><ci id="S4.E10.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.2.1">~</ci><ci id="S4.E10.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.2.2">𝒮</ci></apply><ci id="S4.E10.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3">𝑛</ci></apply></apply><apply id="S4.E10.m1.3.3.1.1.3.cmml" xref="S4.E10.m1.3.3.1.1.3"><times id="S4.E10.m1.3.3.1.1.3.3.cmml" xref="S4.E10.m1.3.3.1.1.3.3"></times><apply id="S4.E10.m1.3.3.1.1.3.4.cmml" xref="S4.E10.m1.3.3.1.1.3.4"><divide id="S4.E10.m1.3.3.1.1.3.4.1.cmml" xref="S4.E10.m1.3.3.1.1.3.4"></divide><cn id="S4.E10.m1.3.3.1.1.3.4.2.cmml" type="integer" xref="S4.E10.m1.3.3.1.1.3.4.2">1</cn><ci id="S4.E10.m1.3.3.1.1.3.4.3.cmml" xref="S4.E10.m1.3.3.1.1.3.4.3">𝑛</ci></apply><apply id="S4.E10.m1.3.3.1.1.3.2.cmml" xref="S4.E10.m1.3.3.1.1.3.2"><apply id="S4.E10.m1.3.3.1.1.3.2.3.cmml" xref="S4.E10.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.1.1.3.2.3.1.cmml" xref="S4.E10.m1.3.3.1.1.3.2.3">superscript</csymbol><apply id="S4.E10.m1.3.3.1.1.3.2.3.2.cmml" xref="S4.E10.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.1.1.3.2.3.2.1.cmml" xref="S4.E10.m1.3.3.1.1.3.2.3">subscript</csymbol><sum id="S4.E10.m1.3.3.1.1.3.2.3.2.2.cmml" xref="S4.E10.m1.3.3.1.1.3.2.3.2.2"></sum><apply id="S4.E10.m1.3.3.1.1.3.2.3.2.3.cmml" xref="S4.E10.m1.3.3.1.1.3.2.3.2.3"><eq id="S4.E10.m1.3.3.1.1.3.2.3.2.3.1.cmml" xref="S4.E10.m1.3.3.1.1.3.2.3.2.3.1"></eq><ci id="S4.E10.m1.3.3.1.1.3.2.3.2.3.2.cmml" xref="S4.E10.m1.3.3.1.1.3.2.3.2.3.2">𝑖</ci><cn id="S4.E10.m1.3.3.1.1.3.2.3.2.3.3.cmml" type="integer" xref="S4.E10.m1.3.3.1.1.3.2.3.2.3.3">1</cn></apply></apply><ci id="S4.E10.m1.3.3.1.1.3.2.3.3.cmml" xref="S4.E10.m1.3.3.1.1.3.2.3.3">𝑛</ci></apply><apply id="S4.E10.m1.3.3.1.1.3.2.2.cmml" xref="S4.E10.m1.3.3.1.1.3.2.2"><times id="S4.E10.m1.3.3.1.1.3.2.2.3.cmml" xref="S4.E10.m1.3.3.1.1.3.2.2.3"></times><ci id="S4.E10.m1.3.3.1.1.3.2.2.4.cmml" xref="S4.E10.m1.3.3.1.1.3.2.2.4">ℓ</ci><interval closure="open" id="S4.E10.m1.3.3.1.1.3.2.2.2.3.cmml" xref="S4.E10.m1.3.3.1.1.3.2.2.2.2"><apply id="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.cmml" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.1"><times id="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.2.cmml" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.2"></times><ci id="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.3.cmml" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.3">italic-ϕ</ci><apply id="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.cmml" xref="S4.E10.m1.3.3.1.1.3.2.2.2.2.2"><times id="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.2.cmml" xref="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.2"></times><ci id="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.3.cmml" xref="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.3">𝑔</ci><apply id="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.1.1.1.cmml" xref="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.1.1.1.1.cmml" xref="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.1.1">subscript</csymbol><ci id="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.1.1.1.2.cmml" xref="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.1.1.1.2">𝑦</ci><ci id="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.1.1.1.3.cmml" xref="S4.E10.m1.3.3.1.1.3.2.2.2.2.2.1.1.1.3">𝑖</ci></apply></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.3c">R_{\ell,{\phi}}(\tilde{\mathscr{S}}_{n})=\frac{1}{n}\sum_{i=1}^{n}\ell(\phi(y_%
{i}),g(y_{i})),</annotation><annotation encoding="application/x-llamapun" id="S4.E10.m1.3d">italic_R start_POSTSUBSCRIPT roman_ℓ , italic_ϕ end_POSTSUBSCRIPT ( over~ start_ARG script_S end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) = divide start_ARG 1 end_ARG start_ARG italic_n end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT roman_ℓ ( italic_ϕ ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_g ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.p5.4">over a function class <math alttext="\phi\in\mathcal{F}" class="ltx_Math" display="inline" id="S4.p5.4.m1.1"><semantics id="S4.p5.4.m1.1a"><mrow id="S4.p5.4.m1.1.1" xref="S4.p5.4.m1.1.1.cmml"><mi id="S4.p5.4.m1.1.1.2" xref="S4.p5.4.m1.1.1.2.cmml">ϕ</mi><mo id="S4.p5.4.m1.1.1.1" xref="S4.p5.4.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.p5.4.m1.1.1.3" xref="S4.p5.4.m1.1.1.3.cmml">ℱ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p5.4.m1.1b"><apply id="S4.p5.4.m1.1.1.cmml" xref="S4.p5.4.m1.1.1"><in id="S4.p5.4.m1.1.1.1.cmml" xref="S4.p5.4.m1.1.1.1"></in><ci id="S4.p5.4.m1.1.1.2.cmml" xref="S4.p5.4.m1.1.1.2">italic-ϕ</ci><ci id="S4.p5.4.m1.1.1.3.cmml" xref="S4.p5.4.m1.1.1.3">ℱ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.4.m1.1c">\phi\in\mathcal{F}</annotation><annotation encoding="application/x-llamapun" id="S4.p5.4.m1.1d">italic_ϕ ∈ caligraphic_F</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.p6">
<p class="ltx_p" id="S4.p6.1"><span class="ltx_text ltx_font_bold" id="S4.p6.1.1">True Population Risk </span> For generalization error, we are interested in how large the true population risk can become over a function class <math alttext="\phi\in\mathcal{F}" class="ltx_Math" display="inline" id="S4.p6.1.m1.1"><semantics id="S4.p6.1.m1.1a"><mrow id="S4.p6.1.m1.1.1" xref="S4.p6.1.m1.1.1.cmml"><mi id="S4.p6.1.m1.1.1.2" xref="S4.p6.1.m1.1.1.2.cmml">ϕ</mi><mo id="S4.p6.1.m1.1.1.1" xref="S4.p6.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.p6.1.m1.1.1.3" xref="S4.p6.1.m1.1.1.3.cmml">ℱ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p6.1.m1.1b"><apply id="S4.p6.1.m1.1.1.cmml" xref="S4.p6.1.m1.1.1"><in id="S4.p6.1.m1.1.1.1.cmml" xref="S4.p6.1.m1.1.1.1"></in><ci id="S4.p6.1.m1.1.1.2.cmml" xref="S4.p6.1.m1.1.1.2">italic-ϕ</ci><ci id="S4.p6.1.m1.1.1.3.cmml" xref="S4.p6.1.m1.1.1.3">ℱ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.1.m1.1c">\phi\in\mathcal{F}</annotation><annotation encoding="application/x-llamapun" id="S4.p6.1.m1.1d">italic_ϕ ∈ caligraphic_F</annotation></semantics></math>.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="R_{\ell,\phi}(\mathscr{D}_{Y})=\mathbb{E}_{Y\sim\mathscr{D}_{Y}}[\ell(\phi(Y),%
g(Y))]," class="ltx_Math" display="block" id="S4.E11.m1.5"><semantics id="S4.E11.m1.5a"><mrow id="S4.E11.m1.5.5.1" xref="S4.E11.m1.5.5.1.1.cmml"><mrow id="S4.E11.m1.5.5.1.1" xref="S4.E11.m1.5.5.1.1.cmml"><mrow id="S4.E11.m1.5.5.1.1.1" xref="S4.E11.m1.5.5.1.1.1.cmml"><msub id="S4.E11.m1.5.5.1.1.1.3" xref="S4.E11.m1.5.5.1.1.1.3.cmml"><mi id="S4.E11.m1.5.5.1.1.1.3.2" xref="S4.E11.m1.5.5.1.1.1.3.2.cmml">R</mi><mrow id="S4.E11.m1.2.2.2.4" xref="S4.E11.m1.2.2.2.3.cmml"><mi id="S4.E11.m1.1.1.1.1" mathvariant="normal" xref="S4.E11.m1.1.1.1.1.cmml">ℓ</mi><mo id="S4.E11.m1.2.2.2.4.1" xref="S4.E11.m1.2.2.2.3.cmml">,</mo><mi id="S4.E11.m1.2.2.2.2" xref="S4.E11.m1.2.2.2.2.cmml">ϕ</mi></mrow></msub><mo id="S4.E11.m1.5.5.1.1.1.2" xref="S4.E11.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S4.E11.m1.5.5.1.1.1.1.1" xref="S4.E11.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S4.E11.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S4.E11.m1.5.5.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E11.m1.5.5.1.1.1.1.1.1" xref="S4.E11.m1.5.5.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathscript" id="S4.E11.m1.5.5.1.1.1.1.1.1.2" xref="S4.E11.m1.5.5.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S4.E11.m1.5.5.1.1.1.1.1.1.3" xref="S4.E11.m1.5.5.1.1.1.1.1.1.3.cmml">Y</mi></msub><mo id="S4.E11.m1.5.5.1.1.1.1.1.3" stretchy="false" xref="S4.E11.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E11.m1.5.5.1.1.3" xref="S4.E11.m1.5.5.1.1.3.cmml">=</mo><mrow id="S4.E11.m1.5.5.1.1.2" xref="S4.E11.m1.5.5.1.1.2.cmml"><msub id="S4.E11.m1.5.5.1.1.2.3" xref="S4.E11.m1.5.5.1.1.2.3.cmml"><mi id="S4.E11.m1.5.5.1.1.2.3.2" xref="S4.E11.m1.5.5.1.1.2.3.2.cmml">𝔼</mi><mrow id="S4.E11.m1.5.5.1.1.2.3.3" xref="S4.E11.m1.5.5.1.1.2.3.3.cmml"><mi id="S4.E11.m1.5.5.1.1.2.3.3.2" xref="S4.E11.m1.5.5.1.1.2.3.3.2.cmml">Y</mi><mo id="S4.E11.m1.5.5.1.1.2.3.3.1" xref="S4.E11.m1.5.5.1.1.2.3.3.1.cmml">∼</mo><msub id="S4.E11.m1.5.5.1.1.2.3.3.3" xref="S4.E11.m1.5.5.1.1.2.3.3.3.cmml"><mi class="ltx_font_mathscript" id="S4.E11.m1.5.5.1.1.2.3.3.3.2" xref="S4.E11.m1.5.5.1.1.2.3.3.3.2.cmml">𝒟</mi><mi id="S4.E11.m1.5.5.1.1.2.3.3.3.3" xref="S4.E11.m1.5.5.1.1.2.3.3.3.3.cmml">Y</mi></msub></mrow></msub><mo id="S4.E11.m1.5.5.1.1.2.2" xref="S4.E11.m1.5.5.1.1.2.2.cmml">⁢</mo><mrow id="S4.E11.m1.5.5.1.1.2.1.1" xref="S4.E11.m1.5.5.1.1.2.1.2.cmml"><mo id="S4.E11.m1.5.5.1.1.2.1.1.2" stretchy="false" xref="S4.E11.m1.5.5.1.1.2.1.2.1.cmml">[</mo><mrow id="S4.E11.m1.5.5.1.1.2.1.1.1" xref="S4.E11.m1.5.5.1.1.2.1.1.1.cmml"><mi id="S4.E11.m1.5.5.1.1.2.1.1.1.4" mathvariant="normal" xref="S4.E11.m1.5.5.1.1.2.1.1.1.4.cmml">ℓ</mi><mo id="S4.E11.m1.5.5.1.1.2.1.1.1.3" xref="S4.E11.m1.5.5.1.1.2.1.1.1.3.cmml">⁢</mo><mrow id="S4.E11.m1.5.5.1.1.2.1.1.1.2.2" xref="S4.E11.m1.5.5.1.1.2.1.1.1.2.3.cmml"><mo id="S4.E11.m1.5.5.1.1.2.1.1.1.2.2.3" stretchy="false" xref="S4.E11.m1.5.5.1.1.2.1.1.1.2.3.cmml">(</mo><mrow id="S4.E11.m1.5.5.1.1.2.1.1.1.1.1.1" xref="S4.E11.m1.5.5.1.1.2.1.1.1.1.1.1.cmml"><mi id="S4.E11.m1.5.5.1.1.2.1.1.1.1.1.1.2" xref="S4.E11.m1.5.5.1.1.2.1.1.1.1.1.1.2.cmml">ϕ</mi><mo id="S4.E11.m1.5.5.1.1.2.1.1.1.1.1.1.1" xref="S4.E11.m1.5.5.1.1.2.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E11.m1.5.5.1.1.2.1.1.1.1.1.1.3.2" xref="S4.E11.m1.5.5.1.1.2.1.1.1.1.1.1.cmml"><mo id="S4.E11.m1.5.5.1.1.2.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.E11.m1.5.5.1.1.2.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E11.m1.3.3" xref="S4.E11.m1.3.3.cmml">Y</mi><mo id="S4.E11.m1.5.5.1.1.2.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.E11.m1.5.5.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E11.m1.5.5.1.1.2.1.1.1.2.2.4" xref="S4.E11.m1.5.5.1.1.2.1.1.1.2.3.cmml">,</mo><mrow id="S4.E11.m1.5.5.1.1.2.1.1.1.2.2.2" xref="S4.E11.m1.5.5.1.1.2.1.1.1.2.2.2.cmml"><mi id="S4.E11.m1.5.5.1.1.2.1.1.1.2.2.2.2" xref="S4.E11.m1.5.5.1.1.2.1.1.1.2.2.2.2.cmml">g</mi><mo id="S4.E11.m1.5.5.1.1.2.1.1.1.2.2.2.1" xref="S4.E11.m1.5.5.1.1.2.1.1.1.2.2.2.1.cmml">⁢</mo><mrow id="S4.E11.m1.5.5.1.1.2.1.1.1.2.2.2.3.2" xref="S4.E11.m1.5.5.1.1.2.1.1.1.2.2.2.cmml"><mo id="S4.E11.m1.5.5.1.1.2.1.1.1.2.2.2.3.2.1" stretchy="false" xref="S4.E11.m1.5.5.1.1.2.1.1.1.2.2.2.cmml">(</mo><mi id="S4.E11.m1.4.4" xref="S4.E11.m1.4.4.cmml">Y</mi><mo id="S4.E11.m1.5.5.1.1.2.1.1.1.2.2.2.3.2.2" stretchy="false" xref="S4.E11.m1.5.5.1.1.2.1.1.1.2.2.2.cmml">)</mo></mrow></mrow><mo id="S4.E11.m1.5.5.1.1.2.1.1.1.2.2.5" stretchy="false" xref="S4.E11.m1.5.5.1.1.2.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E11.m1.5.5.1.1.2.1.1.3" stretchy="false" xref="S4.E11.m1.5.5.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S4.E11.m1.5.5.1.2" xref="S4.E11.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.5b"><apply id="S4.E11.m1.5.5.1.1.cmml" xref="S4.E11.m1.5.5.1"><eq id="S4.E11.m1.5.5.1.1.3.cmml" xref="S4.E11.m1.5.5.1.1.3"></eq><apply id="S4.E11.m1.5.5.1.1.1.cmml" xref="S4.E11.m1.5.5.1.1.1"><times id="S4.E11.m1.5.5.1.1.1.2.cmml" xref="S4.E11.m1.5.5.1.1.1.2"></times><apply id="S4.E11.m1.5.5.1.1.1.3.cmml" xref="S4.E11.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.1.3.1.cmml" xref="S4.E11.m1.5.5.1.1.1.3">subscript</csymbol><ci id="S4.E11.m1.5.5.1.1.1.3.2.cmml" xref="S4.E11.m1.5.5.1.1.1.3.2">𝑅</ci><list id="S4.E11.m1.2.2.2.3.cmml" xref="S4.E11.m1.2.2.2.4"><ci id="S4.E11.m1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1">ℓ</ci><ci id="S4.E11.m1.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2.2">italic-ϕ</ci></list></apply><apply id="S4.E11.m1.5.5.1.1.1.1.1.1.cmml" xref="S4.E11.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.5.5.1.1.1.1.1">subscript</csymbol><ci id="S4.E11.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.5.5.1.1.1.1.1.1.2">𝒟</ci><ci id="S4.E11.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.5.5.1.1.1.1.1.1.3">𝑌</ci></apply></apply><apply id="S4.E11.m1.5.5.1.1.2.cmml" xref="S4.E11.m1.5.5.1.1.2"><times id="S4.E11.m1.5.5.1.1.2.2.cmml" xref="S4.E11.m1.5.5.1.1.2.2"></times><apply id="S4.E11.m1.5.5.1.1.2.3.cmml" xref="S4.E11.m1.5.5.1.1.2.3"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.2.3.1.cmml" xref="S4.E11.m1.5.5.1.1.2.3">subscript</csymbol><ci id="S4.E11.m1.5.5.1.1.2.3.2.cmml" xref="S4.E11.m1.5.5.1.1.2.3.2">𝔼</ci><apply id="S4.E11.m1.5.5.1.1.2.3.3.cmml" xref="S4.E11.m1.5.5.1.1.2.3.3"><csymbol cd="latexml" id="S4.E11.m1.5.5.1.1.2.3.3.1.cmml" xref="S4.E11.m1.5.5.1.1.2.3.3.1">similar-to</csymbol><ci id="S4.E11.m1.5.5.1.1.2.3.3.2.cmml" xref="S4.E11.m1.5.5.1.1.2.3.3.2">𝑌</ci><apply id="S4.E11.m1.5.5.1.1.2.3.3.3.cmml" xref="S4.E11.m1.5.5.1.1.2.3.3.3"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.2.3.3.3.1.cmml" xref="S4.E11.m1.5.5.1.1.2.3.3.3">subscript</csymbol><ci id="S4.E11.m1.5.5.1.1.2.3.3.3.2.cmml" xref="S4.E11.m1.5.5.1.1.2.3.3.3.2">𝒟</ci><ci id="S4.E11.m1.5.5.1.1.2.3.3.3.3.cmml" xref="S4.E11.m1.5.5.1.1.2.3.3.3.3">𝑌</ci></apply></apply></apply><apply id="S4.E11.m1.5.5.1.1.2.1.2.cmml" xref="S4.E11.m1.5.5.1.1.2.1.1"><csymbol cd="latexml" id="S4.E11.m1.5.5.1.1.2.1.2.1.cmml" xref="S4.E11.m1.5.5.1.1.2.1.1.2">delimited-[]</csymbol><apply id="S4.E11.m1.5.5.1.1.2.1.1.1.cmml" xref="S4.E11.m1.5.5.1.1.2.1.1.1"><times id="S4.E11.m1.5.5.1.1.2.1.1.1.3.cmml" xref="S4.E11.m1.5.5.1.1.2.1.1.1.3"></times><ci id="S4.E11.m1.5.5.1.1.2.1.1.1.4.cmml" xref="S4.E11.m1.5.5.1.1.2.1.1.1.4">ℓ</ci><interval closure="open" id="S4.E11.m1.5.5.1.1.2.1.1.1.2.3.cmml" xref="S4.E11.m1.5.5.1.1.2.1.1.1.2.2"><apply id="S4.E11.m1.5.5.1.1.2.1.1.1.1.1.1.cmml" xref="S4.E11.m1.5.5.1.1.2.1.1.1.1.1.1"><times id="S4.E11.m1.5.5.1.1.2.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.5.5.1.1.2.1.1.1.1.1.1.1"></times><ci id="S4.E11.m1.5.5.1.1.2.1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.5.5.1.1.2.1.1.1.1.1.1.2">italic-ϕ</ci><ci id="S4.E11.m1.3.3.cmml" xref="S4.E11.m1.3.3">𝑌</ci></apply><apply id="S4.E11.m1.5.5.1.1.2.1.1.1.2.2.2.cmml" xref="S4.E11.m1.5.5.1.1.2.1.1.1.2.2.2"><times id="S4.E11.m1.5.5.1.1.2.1.1.1.2.2.2.1.cmml" xref="S4.E11.m1.5.5.1.1.2.1.1.1.2.2.2.1"></times><ci id="S4.E11.m1.5.5.1.1.2.1.1.1.2.2.2.2.cmml" xref="S4.E11.m1.5.5.1.1.2.1.1.1.2.2.2.2">𝑔</ci><ci id="S4.E11.m1.4.4.cmml" xref="S4.E11.m1.4.4">𝑌</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.5c">R_{\ell,\phi}(\mathscr{D}_{Y})=\mathbb{E}_{Y\sim\mathscr{D}_{Y}}[\ell(\phi(Y),%
g(Y))],</annotation><annotation encoding="application/x-llamapun" id="S4.E11.m1.5d">italic_R start_POSTSUBSCRIPT roman_ℓ , italic_ϕ end_POSTSUBSCRIPT ( script_D start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT ) = blackboard_E start_POSTSUBSCRIPT italic_Y ∼ script_D start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ roman_ℓ ( italic_ϕ ( italic_Y ) , italic_g ( italic_Y ) ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.p6.3">We consider the above quantity because we want to ensure good alignment between <math alttext="g(y)" class="ltx_Math" display="inline" id="S4.p6.2.m1.1"><semantics id="S4.p6.2.m1.1a"><mrow id="S4.p6.2.m1.1.2" xref="S4.p6.2.m1.1.2.cmml"><mi id="S4.p6.2.m1.1.2.2" xref="S4.p6.2.m1.1.2.2.cmml">g</mi><mo id="S4.p6.2.m1.1.2.1" xref="S4.p6.2.m1.1.2.1.cmml">⁢</mo><mrow id="S4.p6.2.m1.1.2.3.2" xref="S4.p6.2.m1.1.2.cmml"><mo id="S4.p6.2.m1.1.2.3.2.1" stretchy="false" xref="S4.p6.2.m1.1.2.cmml">(</mo><mi id="S4.p6.2.m1.1.1" xref="S4.p6.2.m1.1.1.cmml">y</mi><mo id="S4.p6.2.m1.1.2.3.2.2" stretchy="false" xref="S4.p6.2.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p6.2.m1.1b"><apply id="S4.p6.2.m1.1.2.cmml" xref="S4.p6.2.m1.1.2"><times id="S4.p6.2.m1.1.2.1.cmml" xref="S4.p6.2.m1.1.2.1"></times><ci id="S4.p6.2.m1.1.2.2.cmml" xref="S4.p6.2.m1.1.2.2">𝑔</ci><ci id="S4.p6.2.m1.1.1.cmml" xref="S4.p6.2.m1.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.2.m1.1c">g(y)</annotation><annotation encoding="application/x-llamapun" id="S4.p6.2.m1.1d">italic_g ( italic_y )</annotation></semantics></math> and <math alttext="\phi(y)" class="ltx_Math" display="inline" id="S4.p6.3.m2.1"><semantics id="S4.p6.3.m2.1a"><mrow id="S4.p6.3.m2.1.2" xref="S4.p6.3.m2.1.2.cmml"><mi id="S4.p6.3.m2.1.2.2" xref="S4.p6.3.m2.1.2.2.cmml">ϕ</mi><mo id="S4.p6.3.m2.1.2.1" xref="S4.p6.3.m2.1.2.1.cmml">⁢</mo><mrow id="S4.p6.3.m2.1.2.3.2" xref="S4.p6.3.m2.1.2.cmml"><mo id="S4.p6.3.m2.1.2.3.2.1" stretchy="false" xref="S4.p6.3.m2.1.2.cmml">(</mo><mi id="S4.p6.3.m2.1.1" xref="S4.p6.3.m2.1.1.cmml">y</mi><mo id="S4.p6.3.m2.1.2.3.2.2" stretchy="false" xref="S4.p6.3.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p6.3.m2.1b"><apply id="S4.p6.3.m2.1.2.cmml" xref="S4.p6.3.m2.1.2"><times id="S4.p6.3.m2.1.2.1.cmml" xref="S4.p6.3.m2.1.2.1"></times><ci id="S4.p6.3.m2.1.2.2.cmml" xref="S4.p6.3.m2.1.2.2">italic-ϕ</ci><ci id="S4.p6.3.m2.1.1.cmml" xref="S4.p6.3.m2.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.3.m2.1c">\phi(y)</annotation><annotation encoding="application/x-llamapun" id="S4.p6.3.m2.1d">italic_ϕ ( italic_y )</annotation></semantics></math> where there is non-trivial probability mass under the true distribution.</p>
</div>
<div class="ltx_para" id="S4.p7">
<p class="ltx_p" id="S4.p7.2"><span class="ltx_text ltx_font_bold" id="S4.p7.2.1">Stale Population Risk </span> The stale population risk is defined analogously to true population risk with <math alttext="\tilde{\mathscr{D}_{Y}}" class="ltx_Math" display="inline" id="S4.p7.1.m1.1"><semantics id="S4.p7.1.m1.1a"><mover accent="true" id="S4.p7.1.m1.1.1" xref="S4.p7.1.m1.1.1.cmml"><msub id="S4.p7.1.m1.1.1.2" xref="S4.p7.1.m1.1.1.2.cmml"><mi class="ltx_font_mathscript" id="S4.p7.1.m1.1.1.2.2" xref="S4.p7.1.m1.1.1.2.2.cmml">𝒟</mi><mi id="S4.p7.1.m1.1.1.2.3" xref="S4.p7.1.m1.1.1.2.3.cmml">Y</mi></msub><mo id="S4.p7.1.m1.1.1.1" xref="S4.p7.1.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.p7.1.m1.1b"><apply id="S4.p7.1.m1.1.1.cmml" xref="S4.p7.1.m1.1.1"><ci id="S4.p7.1.m1.1.1.1.cmml" xref="S4.p7.1.m1.1.1.1">~</ci><apply id="S4.p7.1.m1.1.1.2.cmml" xref="S4.p7.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.p7.1.m1.1.1.2.1.cmml" xref="S4.p7.1.m1.1.1.2">subscript</csymbol><ci id="S4.p7.1.m1.1.1.2.2.cmml" xref="S4.p7.1.m1.1.1.2.2">𝒟</ci><ci id="S4.p7.1.m1.1.1.2.3.cmml" xref="S4.p7.1.m1.1.1.2.3">𝑌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.1.m1.1c">\tilde{\mathscr{D}_{Y}}</annotation><annotation encoding="application/x-llamapun" id="S4.p7.1.m1.1d">over~ start_ARG script_D start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> as the distribution, over a function class <math alttext="\phi\in\mathcal{F}" class="ltx_Math" display="inline" id="S4.p7.2.m2.1"><semantics id="S4.p7.2.m2.1a"><mrow id="S4.p7.2.m2.1.1" xref="S4.p7.2.m2.1.1.cmml"><mi id="S4.p7.2.m2.1.1.2" xref="S4.p7.2.m2.1.1.2.cmml">ϕ</mi><mo id="S4.p7.2.m2.1.1.1" xref="S4.p7.2.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.p7.2.m2.1.1.3" xref="S4.p7.2.m2.1.1.3.cmml">ℱ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p7.2.m2.1b"><apply id="S4.p7.2.m2.1.1.cmml" xref="S4.p7.2.m2.1.1"><in id="S4.p7.2.m2.1.1.1.cmml" xref="S4.p7.2.m2.1.1.1"></in><ci id="S4.p7.2.m2.1.1.2.cmml" xref="S4.p7.2.m2.1.1.2">italic-ϕ</ci><ci id="S4.p7.2.m2.1.1.3.cmml" xref="S4.p7.2.m2.1.1.3">ℱ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.2.m2.1c">\phi\in\mathcal{F}</annotation><annotation encoding="application/x-llamapun" id="S4.p7.2.m2.1d">italic_ϕ ∈ caligraphic_F</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="R_{\ell,\phi}(\tilde{\mathscr{D}}_{Y})=\mathbb{E}_{Y\sim\tilde{\mathscr{D}}_{Y%
}}[\ell(\phi(Y),g(Y))].\vspace{-3mm}" class="ltx_Math" display="block" id="S4.E12.m1.5"><semantics id="S4.E12.m1.5a"><mrow id="S4.E12.m1.5.5.1" xref="S4.E12.m1.5.5.1.1.cmml"><mrow id="S4.E12.m1.5.5.1.1" xref="S4.E12.m1.5.5.1.1.cmml"><mrow id="S4.E12.m1.5.5.1.1.1" xref="S4.E12.m1.5.5.1.1.1.cmml"><msub id="S4.E12.m1.5.5.1.1.1.3" xref="S4.E12.m1.5.5.1.1.1.3.cmml"><mi id="S4.E12.m1.5.5.1.1.1.3.2" xref="S4.E12.m1.5.5.1.1.1.3.2.cmml">R</mi><mrow id="S4.E12.m1.2.2.2.4" xref="S4.E12.m1.2.2.2.3.cmml"><mi id="S4.E12.m1.1.1.1.1" mathvariant="normal" xref="S4.E12.m1.1.1.1.1.cmml">ℓ</mi><mo id="S4.E12.m1.2.2.2.4.1" xref="S4.E12.m1.2.2.2.3.cmml">,</mo><mi id="S4.E12.m1.2.2.2.2" xref="S4.E12.m1.2.2.2.2.cmml">ϕ</mi></mrow></msub><mo id="S4.E12.m1.5.5.1.1.1.2" xref="S4.E12.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S4.E12.m1.5.5.1.1.1.1.1" xref="S4.E12.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S4.E12.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S4.E12.m1.5.5.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E12.m1.5.5.1.1.1.1.1.1" xref="S4.E12.m1.5.5.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.E12.m1.5.5.1.1.1.1.1.1.2" xref="S4.E12.m1.5.5.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathscript" id="S4.E12.m1.5.5.1.1.1.1.1.1.2.2" xref="S4.E12.m1.5.5.1.1.1.1.1.1.2.2.cmml">𝒟</mi><mo id="S4.E12.m1.5.5.1.1.1.1.1.1.2.1" xref="S4.E12.m1.5.5.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S4.E12.m1.5.5.1.1.1.1.1.1.3" xref="S4.E12.m1.5.5.1.1.1.1.1.1.3.cmml">Y</mi></msub><mo id="S4.E12.m1.5.5.1.1.1.1.1.3" stretchy="false" xref="S4.E12.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E12.m1.5.5.1.1.3" xref="S4.E12.m1.5.5.1.1.3.cmml">=</mo><mrow id="S4.E12.m1.5.5.1.1.2" xref="S4.E12.m1.5.5.1.1.2.cmml"><msub id="S4.E12.m1.5.5.1.1.2.3" xref="S4.E12.m1.5.5.1.1.2.3.cmml"><mi id="S4.E12.m1.5.5.1.1.2.3.2" xref="S4.E12.m1.5.5.1.1.2.3.2.cmml">𝔼</mi><mrow id="S4.E12.m1.5.5.1.1.2.3.3" xref="S4.E12.m1.5.5.1.1.2.3.3.cmml"><mi id="S4.E12.m1.5.5.1.1.2.3.3.2" xref="S4.E12.m1.5.5.1.1.2.3.3.2.cmml">Y</mi><mo id="S4.E12.m1.5.5.1.1.2.3.3.1" xref="S4.E12.m1.5.5.1.1.2.3.3.1.cmml">∼</mo><msub id="S4.E12.m1.5.5.1.1.2.3.3.3" xref="S4.E12.m1.5.5.1.1.2.3.3.3.cmml"><mover accent="true" id="S4.E12.m1.5.5.1.1.2.3.3.3.2" xref="S4.E12.m1.5.5.1.1.2.3.3.3.2.cmml"><mi class="ltx_font_mathscript" id="S4.E12.m1.5.5.1.1.2.3.3.3.2.2" xref="S4.E12.m1.5.5.1.1.2.3.3.3.2.2.cmml">𝒟</mi><mo id="S4.E12.m1.5.5.1.1.2.3.3.3.2.1" xref="S4.E12.m1.5.5.1.1.2.3.3.3.2.1.cmml">~</mo></mover><mi id="S4.E12.m1.5.5.1.1.2.3.3.3.3" xref="S4.E12.m1.5.5.1.1.2.3.3.3.3.cmml">Y</mi></msub></mrow></msub><mo id="S4.E12.m1.5.5.1.1.2.2" xref="S4.E12.m1.5.5.1.1.2.2.cmml">⁢</mo><mrow id="S4.E12.m1.5.5.1.1.2.1.1" xref="S4.E12.m1.5.5.1.1.2.1.2.cmml"><mo id="S4.E12.m1.5.5.1.1.2.1.1.2" stretchy="false" xref="S4.E12.m1.5.5.1.1.2.1.2.1.cmml">[</mo><mrow id="S4.E12.m1.5.5.1.1.2.1.1.1" xref="S4.E12.m1.5.5.1.1.2.1.1.1.cmml"><mi id="S4.E12.m1.5.5.1.1.2.1.1.1.4" mathvariant="normal" xref="S4.E12.m1.5.5.1.1.2.1.1.1.4.cmml">ℓ</mi><mo id="S4.E12.m1.5.5.1.1.2.1.1.1.3" xref="S4.E12.m1.5.5.1.1.2.1.1.1.3.cmml">⁢</mo><mrow id="S4.E12.m1.5.5.1.1.2.1.1.1.2.2" xref="S4.E12.m1.5.5.1.1.2.1.1.1.2.3.cmml"><mo id="S4.E12.m1.5.5.1.1.2.1.1.1.2.2.3" stretchy="false" xref="S4.E12.m1.5.5.1.1.2.1.1.1.2.3.cmml">(</mo><mrow id="S4.E12.m1.5.5.1.1.2.1.1.1.1.1.1" xref="S4.E12.m1.5.5.1.1.2.1.1.1.1.1.1.cmml"><mi id="S4.E12.m1.5.5.1.1.2.1.1.1.1.1.1.2" xref="S4.E12.m1.5.5.1.1.2.1.1.1.1.1.1.2.cmml">ϕ</mi><mo id="S4.E12.m1.5.5.1.1.2.1.1.1.1.1.1.1" xref="S4.E12.m1.5.5.1.1.2.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E12.m1.5.5.1.1.2.1.1.1.1.1.1.3.2" xref="S4.E12.m1.5.5.1.1.2.1.1.1.1.1.1.cmml"><mo id="S4.E12.m1.5.5.1.1.2.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.E12.m1.5.5.1.1.2.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E12.m1.3.3" xref="S4.E12.m1.3.3.cmml">Y</mi><mo id="S4.E12.m1.5.5.1.1.2.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.E12.m1.5.5.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E12.m1.5.5.1.1.2.1.1.1.2.2.4" xref="S4.E12.m1.5.5.1.1.2.1.1.1.2.3.cmml">,</mo><mrow id="S4.E12.m1.5.5.1.1.2.1.1.1.2.2.2" xref="S4.E12.m1.5.5.1.1.2.1.1.1.2.2.2.cmml"><mi id="S4.E12.m1.5.5.1.1.2.1.1.1.2.2.2.2" xref="S4.E12.m1.5.5.1.1.2.1.1.1.2.2.2.2.cmml">g</mi><mo id="S4.E12.m1.5.5.1.1.2.1.1.1.2.2.2.1" xref="S4.E12.m1.5.5.1.1.2.1.1.1.2.2.2.1.cmml">⁢</mo><mrow id="S4.E12.m1.5.5.1.1.2.1.1.1.2.2.2.3.2" xref="S4.E12.m1.5.5.1.1.2.1.1.1.2.2.2.cmml"><mo id="S4.E12.m1.5.5.1.1.2.1.1.1.2.2.2.3.2.1" stretchy="false" xref="S4.E12.m1.5.5.1.1.2.1.1.1.2.2.2.cmml">(</mo><mi id="S4.E12.m1.4.4" xref="S4.E12.m1.4.4.cmml">Y</mi><mo id="S4.E12.m1.5.5.1.1.2.1.1.1.2.2.2.3.2.2" stretchy="false" xref="S4.E12.m1.5.5.1.1.2.1.1.1.2.2.2.cmml">)</mo></mrow></mrow><mo id="S4.E12.m1.5.5.1.1.2.1.1.1.2.2.5" stretchy="false" xref="S4.E12.m1.5.5.1.1.2.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E12.m1.5.5.1.1.2.1.1.3" stretchy="false" xref="S4.E12.m1.5.5.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S4.E12.m1.5.5.1.2" lspace="0em" xref="S4.E12.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.5b"><apply id="S4.E12.m1.5.5.1.1.cmml" xref="S4.E12.m1.5.5.1"><eq id="S4.E12.m1.5.5.1.1.3.cmml" xref="S4.E12.m1.5.5.1.1.3"></eq><apply id="S4.E12.m1.5.5.1.1.1.cmml" xref="S4.E12.m1.5.5.1.1.1"><times id="S4.E12.m1.5.5.1.1.1.2.cmml" xref="S4.E12.m1.5.5.1.1.1.2"></times><apply id="S4.E12.m1.5.5.1.1.1.3.cmml" xref="S4.E12.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.5.5.1.1.1.3.1.cmml" xref="S4.E12.m1.5.5.1.1.1.3">subscript</csymbol><ci id="S4.E12.m1.5.5.1.1.1.3.2.cmml" xref="S4.E12.m1.5.5.1.1.1.3.2">𝑅</ci><list id="S4.E12.m1.2.2.2.3.cmml" xref="S4.E12.m1.2.2.2.4"><ci id="S4.E12.m1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1">ℓ</ci><ci id="S4.E12.m1.2.2.2.2.cmml" xref="S4.E12.m1.2.2.2.2">italic-ϕ</ci></list></apply><apply id="S4.E12.m1.5.5.1.1.1.1.1.1.cmml" xref="S4.E12.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.5.5.1.1.1.1.1">subscript</csymbol><apply id="S4.E12.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.5.5.1.1.1.1.1.1.2"><ci id="S4.E12.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S4.E12.m1.5.5.1.1.1.1.1.1.2.1">~</ci><ci id="S4.E12.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S4.E12.m1.5.5.1.1.1.1.1.1.2.2">𝒟</ci></apply><ci id="S4.E12.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S4.E12.m1.5.5.1.1.1.1.1.1.3">𝑌</ci></apply></apply><apply id="S4.E12.m1.5.5.1.1.2.cmml" xref="S4.E12.m1.5.5.1.1.2"><times id="S4.E12.m1.5.5.1.1.2.2.cmml" xref="S4.E12.m1.5.5.1.1.2.2"></times><apply id="S4.E12.m1.5.5.1.1.2.3.cmml" xref="S4.E12.m1.5.5.1.1.2.3"><csymbol cd="ambiguous" id="S4.E12.m1.5.5.1.1.2.3.1.cmml" xref="S4.E12.m1.5.5.1.1.2.3">subscript</csymbol><ci id="S4.E12.m1.5.5.1.1.2.3.2.cmml" xref="S4.E12.m1.5.5.1.1.2.3.2">𝔼</ci><apply id="S4.E12.m1.5.5.1.1.2.3.3.cmml" xref="S4.E12.m1.5.5.1.1.2.3.3"><csymbol cd="latexml" id="S4.E12.m1.5.5.1.1.2.3.3.1.cmml" xref="S4.E12.m1.5.5.1.1.2.3.3.1">similar-to</csymbol><ci id="S4.E12.m1.5.5.1.1.2.3.3.2.cmml" xref="S4.E12.m1.5.5.1.1.2.3.3.2">𝑌</ci><apply id="S4.E12.m1.5.5.1.1.2.3.3.3.cmml" xref="S4.E12.m1.5.5.1.1.2.3.3.3"><csymbol cd="ambiguous" id="S4.E12.m1.5.5.1.1.2.3.3.3.1.cmml" xref="S4.E12.m1.5.5.1.1.2.3.3.3">subscript</csymbol><apply id="S4.E12.m1.5.5.1.1.2.3.3.3.2.cmml" xref="S4.E12.m1.5.5.1.1.2.3.3.3.2"><ci id="S4.E12.m1.5.5.1.1.2.3.3.3.2.1.cmml" xref="S4.E12.m1.5.5.1.1.2.3.3.3.2.1">~</ci><ci id="S4.E12.m1.5.5.1.1.2.3.3.3.2.2.cmml" xref="S4.E12.m1.5.5.1.1.2.3.3.3.2.2">𝒟</ci></apply><ci id="S4.E12.m1.5.5.1.1.2.3.3.3.3.cmml" xref="S4.E12.m1.5.5.1.1.2.3.3.3.3">𝑌</ci></apply></apply></apply><apply id="S4.E12.m1.5.5.1.1.2.1.2.cmml" xref="S4.E12.m1.5.5.1.1.2.1.1"><csymbol cd="latexml" id="S4.E12.m1.5.5.1.1.2.1.2.1.cmml" xref="S4.E12.m1.5.5.1.1.2.1.1.2">delimited-[]</csymbol><apply id="S4.E12.m1.5.5.1.1.2.1.1.1.cmml" xref="S4.E12.m1.5.5.1.1.2.1.1.1"><times id="S4.E12.m1.5.5.1.1.2.1.1.1.3.cmml" xref="S4.E12.m1.5.5.1.1.2.1.1.1.3"></times><ci id="S4.E12.m1.5.5.1.1.2.1.1.1.4.cmml" xref="S4.E12.m1.5.5.1.1.2.1.1.1.4">ℓ</ci><interval closure="open" id="S4.E12.m1.5.5.1.1.2.1.1.1.2.3.cmml" xref="S4.E12.m1.5.5.1.1.2.1.1.1.2.2"><apply id="S4.E12.m1.5.5.1.1.2.1.1.1.1.1.1.cmml" xref="S4.E12.m1.5.5.1.1.2.1.1.1.1.1.1"><times id="S4.E12.m1.5.5.1.1.2.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.5.5.1.1.2.1.1.1.1.1.1.1"></times><ci id="S4.E12.m1.5.5.1.1.2.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.5.5.1.1.2.1.1.1.1.1.1.2">italic-ϕ</ci><ci id="S4.E12.m1.3.3.cmml" xref="S4.E12.m1.3.3">𝑌</ci></apply><apply id="S4.E12.m1.5.5.1.1.2.1.1.1.2.2.2.cmml" xref="S4.E12.m1.5.5.1.1.2.1.1.1.2.2.2"><times id="S4.E12.m1.5.5.1.1.2.1.1.1.2.2.2.1.cmml" xref="S4.E12.m1.5.5.1.1.2.1.1.1.2.2.2.1"></times><ci id="S4.E12.m1.5.5.1.1.2.1.1.1.2.2.2.2.cmml" xref="S4.E12.m1.5.5.1.1.2.1.1.1.2.2.2.2">𝑔</ci><ci id="S4.E12.m1.4.4.cmml" xref="S4.E12.m1.4.4">𝑌</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.5c">R_{\ell,\phi}(\tilde{\mathscr{D}}_{Y})=\mathbb{E}_{Y\sim\tilde{\mathscr{D}}_{Y%
}}[\ell(\phi(Y),g(Y))].\vspace{-3mm}</annotation><annotation encoding="application/x-llamapun" id="S4.E12.m1.5d">italic_R start_POSTSUBSCRIPT roman_ℓ , italic_ϕ end_POSTSUBSCRIPT ( over~ start_ARG script_D end_ARG start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT ) = blackboard_E start_POSTSUBSCRIPT italic_Y ∼ over~ start_ARG script_D end_ARG start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ roman_ℓ ( italic_ϕ ( italic_Y ) , italic_g ( italic_Y ) ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.p8">
<p class="ltx_p" id="S4.p8.9"><span class="ltx_text ltx_font_bold" id="S4.p8.9.1">Function Classes </span> The function class <math alttext="\phi\in\mathcal{F}" class="ltx_Math" display="inline" id="S4.p8.1.m1.1"><semantics id="S4.p8.1.m1.1a"><mrow id="S4.p8.1.m1.1.1" xref="S4.p8.1.m1.1.1.cmml"><mi id="S4.p8.1.m1.1.1.2" xref="S4.p8.1.m1.1.1.2.cmml">ϕ</mi><mo id="S4.p8.1.m1.1.1.1" xref="S4.p8.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.p8.1.m1.1.1.3" xref="S4.p8.1.m1.1.1.3.cmml">ℱ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p8.1.m1.1b"><apply id="S4.p8.1.m1.1.1.cmml" xref="S4.p8.1.m1.1.1"><in id="S4.p8.1.m1.1.1.1.cmml" xref="S4.p8.1.m1.1.1.1"></in><ci id="S4.p8.1.m1.1.1.2.cmml" xref="S4.p8.1.m1.1.1.2">italic-ϕ</ci><ci id="S4.p8.1.m1.1.1.3.cmml" xref="S4.p8.1.m1.1.1.3">ℱ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.1.m1.1c">\phi\in\mathcal{F}</annotation><annotation encoding="application/x-llamapun" id="S4.p8.1.m1.1d">italic_ϕ ∈ caligraphic_F</annotation></semantics></math> is large. We will relate this large function class to a restricted class of functions of the form <math alttext="h\circ g^{\prime}" class="ltx_Math" display="inline" id="S4.p8.2.m2.1"><semantics id="S4.p8.2.m2.1a"><mrow id="S4.p8.2.m2.1.1" xref="S4.p8.2.m2.1.1.cmml"><mi id="S4.p8.2.m2.1.1.2" xref="S4.p8.2.m2.1.1.2.cmml">h</mi><mo id="S4.p8.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.p8.2.m2.1.1.1.cmml">∘</mo><msup id="S4.p8.2.m2.1.1.3" xref="S4.p8.2.m2.1.1.3.cmml"><mi id="S4.p8.2.m2.1.1.3.2" xref="S4.p8.2.m2.1.1.3.2.cmml">g</mi><mo id="S4.p8.2.m2.1.1.3.3" xref="S4.p8.2.m2.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p8.2.m2.1b"><apply id="S4.p8.2.m2.1.1.cmml" xref="S4.p8.2.m2.1.1"><compose id="S4.p8.2.m2.1.1.1.cmml" xref="S4.p8.2.m2.1.1.1"></compose><ci id="S4.p8.2.m2.1.1.2.cmml" xref="S4.p8.2.m2.1.1.2">ℎ</ci><apply id="S4.p8.2.m2.1.1.3.cmml" xref="S4.p8.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.p8.2.m2.1.1.3.1.cmml" xref="S4.p8.2.m2.1.1.3">superscript</csymbol><ci id="S4.p8.2.m2.1.1.3.2.cmml" xref="S4.p8.2.m2.1.1.3.2">𝑔</ci><ci id="S4.p8.2.m2.1.1.3.3.cmml" xref="S4.p8.2.m2.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.2.m2.1c">h\circ g^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.p8.2.m2.1d">italic_h ∘ italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> by leveraging the approximate stale representations, <math alttext="g^{\prime}" class="ltx_Math" display="inline" id="S4.p8.3.m3.1"><semantics id="S4.p8.3.m3.1a"><msup id="S4.p8.3.m3.1.1" xref="S4.p8.3.m3.1.1.cmml"><mi id="S4.p8.3.m3.1.1.2" xref="S4.p8.3.m3.1.1.2.cmml">g</mi><mo id="S4.p8.3.m3.1.1.3" xref="S4.p8.3.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.p8.3.m3.1b"><apply id="S4.p8.3.m3.1.1.cmml" xref="S4.p8.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p8.3.m3.1.1.1.cmml" xref="S4.p8.3.m3.1.1">superscript</csymbol><ci id="S4.p8.3.m3.1.1.2.cmml" xref="S4.p8.3.m3.1.1.2">𝑔</ci><ci id="S4.p8.3.m3.1.1.3.cmml" xref="S4.p8.3.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.3.m3.1c">g^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.p8.3.m3.1d">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>.
In other words, we restrict <math alttext="\mathcal{F}" class="ltx_Math" display="inline" id="S4.p8.4.m4.1"><semantics id="S4.p8.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S4.p8.4.m4.1.1" xref="S4.p8.4.m4.1.1.cmml">ℱ</mi><annotation-xml encoding="MathML-Content" id="S4.p8.4.m4.1b"><ci id="S4.p8.4.m4.1.1.cmml" xref="S4.p8.4.m4.1.1">ℱ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.4.m4.1c">\mathcal{F}</annotation><annotation encoding="application/x-llamapun" id="S4.p8.4.m4.1d">caligraphic_F</annotation></semantics></math> to <math alttext="\mathcal{F}^{g^{\prime}}=\{h\circ g^{\prime}:h\in\mathcal{H}\}" class="ltx_Math" display="inline" id="S4.p8.5.m5.2"><semantics id="S4.p8.5.m5.2a"><mrow id="S4.p8.5.m5.2.2" xref="S4.p8.5.m5.2.2.cmml"><msup id="S4.p8.5.m5.2.2.4" xref="S4.p8.5.m5.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p8.5.m5.2.2.4.2" xref="S4.p8.5.m5.2.2.4.2.cmml">ℱ</mi><msup id="S4.p8.5.m5.2.2.4.3" xref="S4.p8.5.m5.2.2.4.3.cmml"><mi id="S4.p8.5.m5.2.2.4.3.2" xref="S4.p8.5.m5.2.2.4.3.2.cmml">g</mi><mo id="S4.p8.5.m5.2.2.4.3.3" xref="S4.p8.5.m5.2.2.4.3.3.cmml">′</mo></msup></msup><mo id="S4.p8.5.m5.2.2.3" xref="S4.p8.5.m5.2.2.3.cmml">=</mo><mrow id="S4.p8.5.m5.2.2.2.2" xref="S4.p8.5.m5.2.2.2.3.cmml"><mo id="S4.p8.5.m5.2.2.2.2.3" stretchy="false" xref="S4.p8.5.m5.2.2.2.3.1.cmml">{</mo><mrow id="S4.p8.5.m5.1.1.1.1.1" xref="S4.p8.5.m5.1.1.1.1.1.cmml"><mi id="S4.p8.5.m5.1.1.1.1.1.2" xref="S4.p8.5.m5.1.1.1.1.1.2.cmml">h</mi><mo id="S4.p8.5.m5.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.p8.5.m5.1.1.1.1.1.1.cmml">∘</mo><msup id="S4.p8.5.m5.1.1.1.1.1.3" xref="S4.p8.5.m5.1.1.1.1.1.3.cmml"><mi id="S4.p8.5.m5.1.1.1.1.1.3.2" xref="S4.p8.5.m5.1.1.1.1.1.3.2.cmml">g</mi><mo id="S4.p8.5.m5.1.1.1.1.1.3.3" xref="S4.p8.5.m5.1.1.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="S4.p8.5.m5.2.2.2.2.4" lspace="0.278em" rspace="0.278em" xref="S4.p8.5.m5.2.2.2.3.1.cmml">:</mo><mrow id="S4.p8.5.m5.2.2.2.2.2" xref="S4.p8.5.m5.2.2.2.2.2.cmml"><mi id="S4.p8.5.m5.2.2.2.2.2.2" xref="S4.p8.5.m5.2.2.2.2.2.2.cmml">h</mi><mo id="S4.p8.5.m5.2.2.2.2.2.1" xref="S4.p8.5.m5.2.2.2.2.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.p8.5.m5.2.2.2.2.2.3" xref="S4.p8.5.m5.2.2.2.2.2.3.cmml">ℋ</mi></mrow><mo id="S4.p8.5.m5.2.2.2.2.5" stretchy="false" xref="S4.p8.5.m5.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p8.5.m5.2b"><apply id="S4.p8.5.m5.2.2.cmml" xref="S4.p8.5.m5.2.2"><eq id="S4.p8.5.m5.2.2.3.cmml" xref="S4.p8.5.m5.2.2.3"></eq><apply id="S4.p8.5.m5.2.2.4.cmml" xref="S4.p8.5.m5.2.2.4"><csymbol cd="ambiguous" id="S4.p8.5.m5.2.2.4.1.cmml" xref="S4.p8.5.m5.2.2.4">superscript</csymbol><ci id="S4.p8.5.m5.2.2.4.2.cmml" xref="S4.p8.5.m5.2.2.4.2">ℱ</ci><apply id="S4.p8.5.m5.2.2.4.3.cmml" xref="S4.p8.5.m5.2.2.4.3"><csymbol cd="ambiguous" id="S4.p8.5.m5.2.2.4.3.1.cmml" xref="S4.p8.5.m5.2.2.4.3">superscript</csymbol><ci id="S4.p8.5.m5.2.2.4.3.2.cmml" xref="S4.p8.5.m5.2.2.4.3.2">𝑔</ci><ci id="S4.p8.5.m5.2.2.4.3.3.cmml" xref="S4.p8.5.m5.2.2.4.3.3">′</ci></apply></apply><apply id="S4.p8.5.m5.2.2.2.3.cmml" xref="S4.p8.5.m5.2.2.2.2"><csymbol cd="latexml" id="S4.p8.5.m5.2.2.2.3.1.cmml" xref="S4.p8.5.m5.2.2.2.2.3">conditional-set</csymbol><apply id="S4.p8.5.m5.1.1.1.1.1.cmml" xref="S4.p8.5.m5.1.1.1.1.1"><compose id="S4.p8.5.m5.1.1.1.1.1.1.cmml" xref="S4.p8.5.m5.1.1.1.1.1.1"></compose><ci id="S4.p8.5.m5.1.1.1.1.1.2.cmml" xref="S4.p8.5.m5.1.1.1.1.1.2">ℎ</ci><apply id="S4.p8.5.m5.1.1.1.1.1.3.cmml" xref="S4.p8.5.m5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.p8.5.m5.1.1.1.1.1.3.1.cmml" xref="S4.p8.5.m5.1.1.1.1.1.3">superscript</csymbol><ci id="S4.p8.5.m5.1.1.1.1.1.3.2.cmml" xref="S4.p8.5.m5.1.1.1.1.1.3.2">𝑔</ci><ci id="S4.p8.5.m5.1.1.1.1.1.3.3.cmml" xref="S4.p8.5.m5.1.1.1.1.1.3.3">′</ci></apply></apply><apply id="S4.p8.5.m5.2.2.2.2.2.cmml" xref="S4.p8.5.m5.2.2.2.2.2"><in id="S4.p8.5.m5.2.2.2.2.2.1.cmml" xref="S4.p8.5.m5.2.2.2.2.2.1"></in><ci id="S4.p8.5.m5.2.2.2.2.2.2.cmml" xref="S4.p8.5.m5.2.2.2.2.2.2">ℎ</ci><ci id="S4.p8.5.m5.2.2.2.2.2.3.cmml" xref="S4.p8.5.m5.2.2.2.2.2.3">ℋ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.5.m5.2c">\mathcal{F}^{g^{\prime}}=\{h\circ g^{\prime}:h\in\mathcal{H}\}</annotation><annotation encoding="application/x-llamapun" id="S4.p8.5.m5.2d">caligraphic_F start_POSTSUPERSCRIPT italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT = { italic_h ∘ italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT : italic_h ∈ caligraphic_H }</annotation></semantics></math> where <math alttext="\mathcal{H}" class="ltx_Math" display="inline" id="S4.p8.6.m6.1"><semantics id="S4.p8.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S4.p8.6.m6.1.1" xref="S4.p8.6.m6.1.1.cmml">ℋ</mi><annotation-xml encoding="MathML-Content" id="S4.p8.6.m6.1b"><ci id="S4.p8.6.m6.1.1.cmml" xref="S4.p8.6.m6.1.1">ℋ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.6.m6.1c">\mathcal{H}</annotation><annotation encoding="application/x-llamapun" id="S4.p8.6.m6.1d">caligraphic_H</annotation></semantics></math> represents the simpler function class mapping <math alttext="\mathbb{R}^{d}\to\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S4.p8.7.m7.1"><semantics id="S4.p8.7.m7.1a"><mrow id="S4.p8.7.m7.1.1" xref="S4.p8.7.m7.1.1.cmml"><msup id="S4.p8.7.m7.1.1.2" xref="S4.p8.7.m7.1.1.2.cmml"><mi id="S4.p8.7.m7.1.1.2.2" xref="S4.p8.7.m7.1.1.2.2.cmml">ℝ</mi><mi id="S4.p8.7.m7.1.1.2.3" xref="S4.p8.7.m7.1.1.2.3.cmml">d</mi></msup><mo id="S4.p8.7.m7.1.1.1" stretchy="false" xref="S4.p8.7.m7.1.1.1.cmml">→</mo><msup id="S4.p8.7.m7.1.1.3" xref="S4.p8.7.m7.1.1.3.cmml"><mi id="S4.p8.7.m7.1.1.3.2" xref="S4.p8.7.m7.1.1.3.2.cmml">ℝ</mi><mi id="S4.p8.7.m7.1.1.3.3" xref="S4.p8.7.m7.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p8.7.m7.1b"><apply id="S4.p8.7.m7.1.1.cmml" xref="S4.p8.7.m7.1.1"><ci id="S4.p8.7.m7.1.1.1.cmml" xref="S4.p8.7.m7.1.1.1">→</ci><apply id="S4.p8.7.m7.1.1.2.cmml" xref="S4.p8.7.m7.1.1.2"><csymbol cd="ambiguous" id="S4.p8.7.m7.1.1.2.1.cmml" xref="S4.p8.7.m7.1.1.2">superscript</csymbol><ci id="S4.p8.7.m7.1.1.2.2.cmml" xref="S4.p8.7.m7.1.1.2.2">ℝ</ci><ci id="S4.p8.7.m7.1.1.2.3.cmml" xref="S4.p8.7.m7.1.1.2.3">𝑑</ci></apply><apply id="S4.p8.7.m7.1.1.3.cmml" xref="S4.p8.7.m7.1.1.3"><csymbol cd="ambiguous" id="S4.p8.7.m7.1.1.3.1.cmml" xref="S4.p8.7.m7.1.1.3">superscript</csymbol><ci id="S4.p8.7.m7.1.1.3.2.cmml" xref="S4.p8.7.m7.1.1.3.2">ℝ</ci><ci id="S4.p8.7.m7.1.1.3.3.cmml" xref="S4.p8.7.m7.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.7.m7.1c">\mathbb{R}^{d}\to\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S4.p8.7.m7.1d">blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT → blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> which can express the discrepancy between the stale <math alttext="g^{\prime}" class="ltx_Math" display="inline" id="S4.p8.8.m8.1"><semantics id="S4.p8.8.m8.1a"><msup id="S4.p8.8.m8.1.1" xref="S4.p8.8.m8.1.1.cmml"><mi id="S4.p8.8.m8.1.1.2" xref="S4.p8.8.m8.1.1.2.cmml">g</mi><mo id="S4.p8.8.m8.1.1.3" xref="S4.p8.8.m8.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.p8.8.m8.1b"><apply id="S4.p8.8.m8.1.1.cmml" xref="S4.p8.8.m8.1.1"><csymbol cd="ambiguous" id="S4.p8.8.m8.1.1.1.cmml" xref="S4.p8.8.m8.1.1">superscript</csymbol><ci id="S4.p8.8.m8.1.1.2.cmml" xref="S4.p8.8.m8.1.1.2">𝑔</ci><ci id="S4.p8.8.m8.1.1.3.cmml" xref="S4.p8.8.m8.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.8.m8.1c">g^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.p8.8.m8.1d">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> and current <math alttext="g" class="ltx_Math" display="inline" id="S4.p8.9.m9.1"><semantics id="S4.p8.9.m9.1a"><mi id="S4.p8.9.m9.1.1" xref="S4.p8.9.m9.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S4.p8.9.m9.1b"><ci id="S4.p8.9.m9.1.1.cmml" xref="S4.p8.9.m9.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.9.m9.1c">g</annotation><annotation encoding="application/x-llamapun" id="S4.p8.9.m9.1d">italic_g</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.p9">
<p class="ltx_p" id="S4.p9.2">First, we provide a bound on the gap between the population risk and stale population risk. We formalize this in the following lemma. For ease of notation in this exposition, we define <math alttext="\mathcal{G}_{\ell,\mathcal{F}}" class="ltx_Math" display="inline" id="S4.p9.1.m1.2"><semantics id="S4.p9.1.m1.2a"><msub id="S4.p9.1.m1.2.3" xref="S4.p9.1.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p9.1.m1.2.3.2" xref="S4.p9.1.m1.2.3.2.cmml">𝒢</mi><mrow id="S4.p9.1.m1.2.2.2.4" xref="S4.p9.1.m1.2.2.2.3.cmml"><mi id="S4.p9.1.m1.1.1.1.1" mathvariant="normal" xref="S4.p9.1.m1.1.1.1.1.cmml">ℓ</mi><mo id="S4.p9.1.m1.2.2.2.4.1" xref="S4.p9.1.m1.2.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.p9.1.m1.2.2.2.2" xref="S4.p9.1.m1.2.2.2.2.cmml">ℱ</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.p9.1.m1.2b"><apply id="S4.p9.1.m1.2.3.cmml" xref="S4.p9.1.m1.2.3"><csymbol cd="ambiguous" id="S4.p9.1.m1.2.3.1.cmml" xref="S4.p9.1.m1.2.3">subscript</csymbol><ci id="S4.p9.1.m1.2.3.2.cmml" xref="S4.p9.1.m1.2.3.2">𝒢</ci><list id="S4.p9.1.m1.2.2.2.3.cmml" xref="S4.p9.1.m1.2.2.2.4"><ci id="S4.p9.1.m1.1.1.1.1.cmml" xref="S4.p9.1.m1.1.1.1.1">ℓ</ci><ci id="S4.p9.1.m1.2.2.2.2.cmml" xref="S4.p9.1.m1.2.2.2.2">ℱ</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.1.m1.2c">\mathcal{G}_{\ell,\mathcal{F}}</annotation><annotation encoding="application/x-llamapun" id="S4.p9.1.m1.2d">caligraphic_G start_POSTSUBSCRIPT roman_ℓ , caligraphic_F end_POSTSUBSCRIPT</annotation></semantics></math> as the induced function class:
<math alttext="\mathcal{G}_{\ell,\mathcal{F}}=\{y\mapsto\ell(\phi(y),g(y)):\phi\in\mathcal{F}\}." class="ltx_Math" display="inline" id="S4.p9.2.m2.5"><semantics id="S4.p9.2.m2.5a"><mrow id="S4.p9.2.m2.5.5.1" xref="S4.p9.2.m2.5.5.1.1.cmml"><mrow id="S4.p9.2.m2.5.5.1.1" xref="S4.p9.2.m2.5.5.1.1.cmml"><msub id="S4.p9.2.m2.5.5.1.1.4" xref="S4.p9.2.m2.5.5.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p9.2.m2.5.5.1.1.4.2" xref="S4.p9.2.m2.5.5.1.1.4.2.cmml">𝒢</mi><mrow id="S4.p9.2.m2.2.2.2.4" xref="S4.p9.2.m2.2.2.2.3.cmml"><mi id="S4.p9.2.m2.1.1.1.1" mathvariant="normal" xref="S4.p9.2.m2.1.1.1.1.cmml">ℓ</mi><mo id="S4.p9.2.m2.2.2.2.4.1" xref="S4.p9.2.m2.2.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.p9.2.m2.2.2.2.2" xref="S4.p9.2.m2.2.2.2.2.cmml">ℱ</mi></mrow></msub><mo id="S4.p9.2.m2.5.5.1.1.3" xref="S4.p9.2.m2.5.5.1.1.3.cmml">=</mo><mrow id="S4.p9.2.m2.5.5.1.1.2.2" xref="S4.p9.2.m2.5.5.1.1.2.3.cmml"><mo id="S4.p9.2.m2.5.5.1.1.2.2.3" stretchy="false" xref="S4.p9.2.m2.5.5.1.1.2.3.1.cmml">{</mo><mrow id="S4.p9.2.m2.5.5.1.1.1.1.1" xref="S4.p9.2.m2.5.5.1.1.1.1.1.cmml"><mi id="S4.p9.2.m2.5.5.1.1.1.1.1.4" xref="S4.p9.2.m2.5.5.1.1.1.1.1.4.cmml">y</mi><mo id="S4.p9.2.m2.5.5.1.1.1.1.1.3" stretchy="false" xref="S4.p9.2.m2.5.5.1.1.1.1.1.3.cmml">↦</mo><mrow id="S4.p9.2.m2.5.5.1.1.1.1.1.2" xref="S4.p9.2.m2.5.5.1.1.1.1.1.2.cmml"><mi id="S4.p9.2.m2.5.5.1.1.1.1.1.2.4" mathvariant="normal" xref="S4.p9.2.m2.5.5.1.1.1.1.1.2.4.cmml">ℓ</mi><mo id="S4.p9.2.m2.5.5.1.1.1.1.1.2.3" xref="S4.p9.2.m2.5.5.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.2" xref="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.3.cmml"><mo id="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.2.3" stretchy="false" xref="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.3.cmml">(</mo><mrow id="S4.p9.2.m2.5.5.1.1.1.1.1.1.1.1.1" xref="S4.p9.2.m2.5.5.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.p9.2.m2.5.5.1.1.1.1.1.1.1.1.1.2" xref="S4.p9.2.m2.5.5.1.1.1.1.1.1.1.1.1.2.cmml">ϕ</mi><mo id="S4.p9.2.m2.5.5.1.1.1.1.1.1.1.1.1.1" xref="S4.p9.2.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.p9.2.m2.5.5.1.1.1.1.1.1.1.1.1.3.2" xref="S4.p9.2.m2.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.p9.2.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.p9.2.m2.5.5.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.p9.2.m2.3.3" xref="S4.p9.2.m2.3.3.cmml">y</mi><mo id="S4.p9.2.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.p9.2.m2.5.5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.2.4" xref="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.3.cmml">,</mo><mrow id="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.2.2" xref="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.2.2.2" xref="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.2.2.2.cmml">g</mi><mo id="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.2.2.1" xref="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.2.2.1.cmml">⁢</mo><mrow id="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.2.2.3.2" xref="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.2.2.cmml"><mo id="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.2.2.3.2.1" stretchy="false" xref="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.2.2.cmml">(</mo><mi id="S4.p9.2.m2.4.4" xref="S4.p9.2.m2.4.4.cmml">y</mi><mo id="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.2.2.3.2.2" stretchy="false" xref="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.2.5" rspace="0.278em" stretchy="false" xref="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.p9.2.m2.5.5.1.1.2.2.4" rspace="0.278em" xref="S4.p9.2.m2.5.5.1.1.2.3.1.cmml">:</mo><mrow id="S4.p9.2.m2.5.5.1.1.2.2.2" xref="S4.p9.2.m2.5.5.1.1.2.2.2.cmml"><mi id="S4.p9.2.m2.5.5.1.1.2.2.2.2" xref="S4.p9.2.m2.5.5.1.1.2.2.2.2.cmml">ϕ</mi><mo id="S4.p9.2.m2.5.5.1.1.2.2.2.1" xref="S4.p9.2.m2.5.5.1.1.2.2.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.p9.2.m2.5.5.1.1.2.2.2.3" xref="S4.p9.2.m2.5.5.1.1.2.2.2.3.cmml">ℱ</mi></mrow><mo id="S4.p9.2.m2.5.5.1.1.2.2.5" stretchy="false" xref="S4.p9.2.m2.5.5.1.1.2.3.1.cmml">}</mo></mrow></mrow><mo id="S4.p9.2.m2.5.5.1.2" lspace="0em" xref="S4.p9.2.m2.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p9.2.m2.5b"><apply id="S4.p9.2.m2.5.5.1.1.cmml" xref="S4.p9.2.m2.5.5.1"><eq id="S4.p9.2.m2.5.5.1.1.3.cmml" xref="S4.p9.2.m2.5.5.1.1.3"></eq><apply id="S4.p9.2.m2.5.5.1.1.4.cmml" xref="S4.p9.2.m2.5.5.1.1.4"><csymbol cd="ambiguous" id="S4.p9.2.m2.5.5.1.1.4.1.cmml" xref="S4.p9.2.m2.5.5.1.1.4">subscript</csymbol><ci id="S4.p9.2.m2.5.5.1.1.4.2.cmml" xref="S4.p9.2.m2.5.5.1.1.4.2">𝒢</ci><list id="S4.p9.2.m2.2.2.2.3.cmml" xref="S4.p9.2.m2.2.2.2.4"><ci id="S4.p9.2.m2.1.1.1.1.cmml" xref="S4.p9.2.m2.1.1.1.1">ℓ</ci><ci id="S4.p9.2.m2.2.2.2.2.cmml" xref="S4.p9.2.m2.2.2.2.2">ℱ</ci></list></apply><apply id="S4.p9.2.m2.5.5.1.1.2.3.cmml" xref="S4.p9.2.m2.5.5.1.1.2.2"><csymbol cd="latexml" id="S4.p9.2.m2.5.5.1.1.2.3.1.cmml" xref="S4.p9.2.m2.5.5.1.1.2.2.3">conditional-set</csymbol><apply id="S4.p9.2.m2.5.5.1.1.1.1.1.cmml" xref="S4.p9.2.m2.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S4.p9.2.m2.5.5.1.1.1.1.1.3.cmml" xref="S4.p9.2.m2.5.5.1.1.1.1.1.3">maps-to</csymbol><ci id="S4.p9.2.m2.5.5.1.1.1.1.1.4.cmml" xref="S4.p9.2.m2.5.5.1.1.1.1.1.4">𝑦</ci><apply id="S4.p9.2.m2.5.5.1.1.1.1.1.2.cmml" xref="S4.p9.2.m2.5.5.1.1.1.1.1.2"><times id="S4.p9.2.m2.5.5.1.1.1.1.1.2.3.cmml" xref="S4.p9.2.m2.5.5.1.1.1.1.1.2.3"></times><ci id="S4.p9.2.m2.5.5.1.1.1.1.1.2.4.cmml" xref="S4.p9.2.m2.5.5.1.1.1.1.1.2.4">ℓ</ci><interval closure="open" id="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.3.cmml" xref="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.2"><apply id="S4.p9.2.m2.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S4.p9.2.m2.5.5.1.1.1.1.1.1.1.1.1"><times id="S4.p9.2.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.p9.2.m2.5.5.1.1.1.1.1.1.1.1.1.1"></times><ci id="S4.p9.2.m2.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.p9.2.m2.5.5.1.1.1.1.1.1.1.1.1.2">italic-ϕ</ci><ci id="S4.p9.2.m2.3.3.cmml" xref="S4.p9.2.m2.3.3">𝑦</ci></apply><apply id="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.2.2.cmml" xref="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.2.2"><times id="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.2.2.1"></times><ci id="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.p9.2.m2.5.5.1.1.1.1.1.2.2.2.2.2">𝑔</ci><ci id="S4.p9.2.m2.4.4.cmml" xref="S4.p9.2.m2.4.4">𝑦</ci></apply></interval></apply></apply><apply id="S4.p9.2.m2.5.5.1.1.2.2.2.cmml" xref="S4.p9.2.m2.5.5.1.1.2.2.2"><in id="S4.p9.2.m2.5.5.1.1.2.2.2.1.cmml" xref="S4.p9.2.m2.5.5.1.1.2.2.2.1"></in><ci id="S4.p9.2.m2.5.5.1.1.2.2.2.2.cmml" xref="S4.p9.2.m2.5.5.1.1.2.2.2.2">italic-ϕ</ci><ci id="S4.p9.2.m2.5.5.1.1.2.2.2.3.cmml" xref="S4.p9.2.m2.5.5.1.1.2.2.2.3">ℱ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.2.m2.5c">\mathcal{G}_{\ell,\mathcal{F}}=\{y\mapsto\ell(\phi(y),g(y)):\phi\in\mathcal{F}\}.</annotation><annotation encoding="application/x-llamapun" id="S4.p9.2.m2.5d">caligraphic_G start_POSTSUBSCRIPT roman_ℓ , caligraphic_F end_POSTSUBSCRIPT = { italic_y ↦ roman_ℓ ( italic_ϕ ( italic_y ) , italic_g ( italic_y ) ) : italic_ϕ ∈ caligraphic_F } .</annotation></semantics></math></p>
</div>
<div class="ltx_theorem ltx_theorem_lemma" id="S4.Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="S4.Thmtheorem1.1.1.1">Lemma 4.1</span></span><span class="ltx_text ltx_font_bold" id="S4.Thmtheorem1.2.2">.</span>
</h6>
<div class="ltx_para" id="S4.Thmtheorem1.p1">
<p class="ltx_p" id="S4.Thmtheorem1.p1.2"><span class="ltx_text ltx_font_italic" id="S4.Thmtheorem1.p1.2.2">Given a target encoder <math alttext="g" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.1.1.m1.1"><semantics id="S4.Thmtheorem1.p1.1.1.m1.1a"><mi id="S4.Thmtheorem1.p1.1.1.m1.1.1" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.1.1.m1.1b"><ci id="S4.Thmtheorem1.p1.1.1.m1.1.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.1.1.m1.1c">g</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.1.1.m1.1d">italic_g</annotation></semantics></math> and its stale approximation <math alttext="g^{\prime}" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.2.2.m2.1"><semantics id="S4.Thmtheorem1.p1.2.2.m2.1a"><msup id="S4.Thmtheorem1.p1.2.2.m2.1.1" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.cmml"><mi id="S4.Thmtheorem1.p1.2.2.m2.1.1.2" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.2.cmml">g</mi><mo id="S4.Thmtheorem1.p1.2.2.m2.1.1.3" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.2.2.m2.1b"><apply id="S4.Thmtheorem1.p1.2.2.m2.1.1.cmml" xref="S4.Thmtheorem1.p1.2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.2.2.m2.1.1.1.cmml" xref="S4.Thmtheorem1.p1.2.2.m2.1.1">superscript</csymbol><ci id="S4.Thmtheorem1.p1.2.2.m2.1.1.2.cmml" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.2">𝑔</ci><ci id="S4.Thmtheorem1.p1.2.2.m2.1.1.3.cmml" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.2.2.m2.1c">g^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.2.2.m2.1d">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, the gap between the true population risk and stale population risk is bounded in the following way:</span></p>
<table class="ltx_equation ltx_eqn_table" id="S4.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="R_{\ell,\phi}(\mathscr{D}_{Y})-R_{\ell,\phi}(\tilde{\mathscr{D}}_{Y})\leq%
\mathcal{W}(\mathscr{D}_{Y},\tilde{\mathscr{D}}_{Y})\leq\|g-g^{\prime}\|_{1}" class="ltx_Math" display="block" id="S4.E13.m1.9"><semantics id="S4.E13.m1.9a"><mrow id="S4.E13.m1.9.9" xref="S4.E13.m1.9.9.cmml"><mrow id="S4.E13.m1.6.6.2" xref="S4.E13.m1.6.6.2.cmml"><mrow id="S4.E13.m1.5.5.1.1" xref="S4.E13.m1.5.5.1.1.cmml"><msub id="S4.E13.m1.5.5.1.1.3" xref="S4.E13.m1.5.5.1.1.3.cmml"><mi id="S4.E13.m1.5.5.1.1.3.2" xref="S4.E13.m1.5.5.1.1.3.2.cmml">R</mi><mrow id="S4.E13.m1.2.2.2.4" xref="S4.E13.m1.2.2.2.3.cmml"><mi id="S4.E13.m1.1.1.1.1" mathvariant="normal" xref="S4.E13.m1.1.1.1.1.cmml">ℓ</mi><mo id="S4.E13.m1.2.2.2.4.1" xref="S4.E13.m1.2.2.2.3.cmml">,</mo><mi id="S4.E13.m1.2.2.2.2" xref="S4.E13.m1.2.2.2.2.cmml">ϕ</mi></mrow></msub><mo id="S4.E13.m1.5.5.1.1.2" xref="S4.E13.m1.5.5.1.1.2.cmml">⁢</mo><mrow id="S4.E13.m1.5.5.1.1.1.1" xref="S4.E13.m1.5.5.1.1.1.1.1.cmml"><mo id="S4.E13.m1.5.5.1.1.1.1.2" stretchy="false" xref="S4.E13.m1.5.5.1.1.1.1.1.cmml">(</mo><msub id="S4.E13.m1.5.5.1.1.1.1.1" xref="S4.E13.m1.5.5.1.1.1.1.1.cmml"><mi class="ltx_font_mathscript" id="S4.E13.m1.5.5.1.1.1.1.1.2" xref="S4.E13.m1.5.5.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S4.E13.m1.5.5.1.1.1.1.1.3" xref="S4.E13.m1.5.5.1.1.1.1.1.3.cmml">Y</mi></msub><mo id="S4.E13.m1.5.5.1.1.1.1.3" stretchy="false" xref="S4.E13.m1.5.5.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E13.m1.6.6.2.3" xref="S4.E13.m1.6.6.2.3.cmml">−</mo><mrow id="S4.E13.m1.6.6.2.2" xref="S4.E13.m1.6.6.2.2.cmml"><msub id="S4.E13.m1.6.6.2.2.3" xref="S4.E13.m1.6.6.2.2.3.cmml"><mi id="S4.E13.m1.6.6.2.2.3.2" xref="S4.E13.m1.6.6.2.2.3.2.cmml">R</mi><mrow id="S4.E13.m1.4.4.2.4" xref="S4.E13.m1.4.4.2.3.cmml"><mi id="S4.E13.m1.3.3.1.1" mathvariant="normal" xref="S4.E13.m1.3.3.1.1.cmml">ℓ</mi><mo id="S4.E13.m1.4.4.2.4.1" xref="S4.E13.m1.4.4.2.3.cmml">,</mo><mi id="S4.E13.m1.4.4.2.2" xref="S4.E13.m1.4.4.2.2.cmml">ϕ</mi></mrow></msub><mo id="S4.E13.m1.6.6.2.2.2" xref="S4.E13.m1.6.6.2.2.2.cmml">⁢</mo><mrow id="S4.E13.m1.6.6.2.2.1.1" xref="S4.E13.m1.6.6.2.2.1.1.1.cmml"><mo id="S4.E13.m1.6.6.2.2.1.1.2" stretchy="false" xref="S4.E13.m1.6.6.2.2.1.1.1.cmml">(</mo><msub id="S4.E13.m1.6.6.2.2.1.1.1" xref="S4.E13.m1.6.6.2.2.1.1.1.cmml"><mover accent="true" id="S4.E13.m1.6.6.2.2.1.1.1.2" xref="S4.E13.m1.6.6.2.2.1.1.1.2.cmml"><mi class="ltx_font_mathscript" id="S4.E13.m1.6.6.2.2.1.1.1.2.2" xref="S4.E13.m1.6.6.2.2.1.1.1.2.2.cmml">𝒟</mi><mo id="S4.E13.m1.6.6.2.2.1.1.1.2.1" xref="S4.E13.m1.6.6.2.2.1.1.1.2.1.cmml">~</mo></mover><mi id="S4.E13.m1.6.6.2.2.1.1.1.3" xref="S4.E13.m1.6.6.2.2.1.1.1.3.cmml">Y</mi></msub><mo id="S4.E13.m1.6.6.2.2.1.1.3" stretchy="false" xref="S4.E13.m1.6.6.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E13.m1.9.9.7" xref="S4.E13.m1.9.9.7.cmml">≤</mo><mrow id="S4.E13.m1.8.8.4" xref="S4.E13.m1.8.8.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E13.m1.8.8.4.4" xref="S4.E13.m1.8.8.4.4.cmml">𝒲</mi><mo id="S4.E13.m1.8.8.4.3" xref="S4.E13.m1.8.8.4.3.cmml">⁢</mo><mrow id="S4.E13.m1.8.8.4.2.2" xref="S4.E13.m1.8.8.4.2.3.cmml"><mo id="S4.E13.m1.8.8.4.2.2.3" stretchy="false" xref="S4.E13.m1.8.8.4.2.3.cmml">(</mo><msub id="S4.E13.m1.7.7.3.1.1.1" xref="S4.E13.m1.7.7.3.1.1.1.cmml"><mi class="ltx_font_mathscript" id="S4.E13.m1.7.7.3.1.1.1.2" xref="S4.E13.m1.7.7.3.1.1.1.2.cmml">𝒟</mi><mi id="S4.E13.m1.7.7.3.1.1.1.3" xref="S4.E13.m1.7.7.3.1.1.1.3.cmml">Y</mi></msub><mo id="S4.E13.m1.8.8.4.2.2.4" xref="S4.E13.m1.8.8.4.2.3.cmml">,</mo><msub id="S4.E13.m1.8.8.4.2.2.2" xref="S4.E13.m1.8.8.4.2.2.2.cmml"><mover accent="true" id="S4.E13.m1.8.8.4.2.2.2.2" xref="S4.E13.m1.8.8.4.2.2.2.2.cmml"><mi class="ltx_font_mathscript" id="S4.E13.m1.8.8.4.2.2.2.2.2" xref="S4.E13.m1.8.8.4.2.2.2.2.2.cmml">𝒟</mi><mo id="S4.E13.m1.8.8.4.2.2.2.2.1" xref="S4.E13.m1.8.8.4.2.2.2.2.1.cmml">~</mo></mover><mi id="S4.E13.m1.8.8.4.2.2.2.3" xref="S4.E13.m1.8.8.4.2.2.2.3.cmml">Y</mi></msub><mo id="S4.E13.m1.8.8.4.2.2.5" stretchy="false" xref="S4.E13.m1.8.8.4.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E13.m1.9.9.8" xref="S4.E13.m1.9.9.8.cmml">≤</mo><msub id="S4.E13.m1.9.9.5" xref="S4.E13.m1.9.9.5.cmml"><mrow id="S4.E13.m1.9.9.5.1.1" xref="S4.E13.m1.9.9.5.1.2.cmml"><mo id="S4.E13.m1.9.9.5.1.1.2" stretchy="false" xref="S4.E13.m1.9.9.5.1.2.1.cmml">‖</mo><mrow id="S4.E13.m1.9.9.5.1.1.1" xref="S4.E13.m1.9.9.5.1.1.1.cmml"><mi id="S4.E13.m1.9.9.5.1.1.1.2" xref="S4.E13.m1.9.9.5.1.1.1.2.cmml">g</mi><mo id="S4.E13.m1.9.9.5.1.1.1.1" xref="S4.E13.m1.9.9.5.1.1.1.1.cmml">−</mo><msup id="S4.E13.m1.9.9.5.1.1.1.3" xref="S4.E13.m1.9.9.5.1.1.1.3.cmml"><mi id="S4.E13.m1.9.9.5.1.1.1.3.2" xref="S4.E13.m1.9.9.5.1.1.1.3.2.cmml">g</mi><mo id="S4.E13.m1.9.9.5.1.1.1.3.3" xref="S4.E13.m1.9.9.5.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="S4.E13.m1.9.9.5.1.1.3" stretchy="false" xref="S4.E13.m1.9.9.5.1.2.1.cmml">‖</mo></mrow><mn id="S4.E13.m1.9.9.5.3" xref="S4.E13.m1.9.9.5.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m1.9b"><apply id="S4.E13.m1.9.9.cmml" xref="S4.E13.m1.9.9"><and id="S4.E13.m1.9.9a.cmml" xref="S4.E13.m1.9.9"></and><apply id="S4.E13.m1.9.9b.cmml" xref="S4.E13.m1.9.9"><leq id="S4.E13.m1.9.9.7.cmml" xref="S4.E13.m1.9.9.7"></leq><apply id="S4.E13.m1.6.6.2.cmml" xref="S4.E13.m1.6.6.2"><minus id="S4.E13.m1.6.6.2.3.cmml" xref="S4.E13.m1.6.6.2.3"></minus><apply id="S4.E13.m1.5.5.1.1.cmml" xref="S4.E13.m1.5.5.1.1"><times id="S4.E13.m1.5.5.1.1.2.cmml" xref="S4.E13.m1.5.5.1.1.2"></times><apply id="S4.E13.m1.5.5.1.1.3.cmml" xref="S4.E13.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.5.5.1.1.3.1.cmml" xref="S4.E13.m1.5.5.1.1.3">subscript</csymbol><ci id="S4.E13.m1.5.5.1.1.3.2.cmml" xref="S4.E13.m1.5.5.1.1.3.2">𝑅</ci><list id="S4.E13.m1.2.2.2.3.cmml" xref="S4.E13.m1.2.2.2.4"><ci id="S4.E13.m1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1">ℓ</ci><ci id="S4.E13.m1.2.2.2.2.cmml" xref="S4.E13.m1.2.2.2.2">italic-ϕ</ci></list></apply><apply id="S4.E13.m1.5.5.1.1.1.1.1.cmml" xref="S4.E13.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.5.5.1.1.1.1.1.1.cmml" xref="S4.E13.m1.5.5.1.1.1.1">subscript</csymbol><ci id="S4.E13.m1.5.5.1.1.1.1.1.2.cmml" xref="S4.E13.m1.5.5.1.1.1.1.1.2">𝒟</ci><ci id="S4.E13.m1.5.5.1.1.1.1.1.3.cmml" xref="S4.E13.m1.5.5.1.1.1.1.1.3">𝑌</ci></apply></apply><apply id="S4.E13.m1.6.6.2.2.cmml" xref="S4.E13.m1.6.6.2.2"><times id="S4.E13.m1.6.6.2.2.2.cmml" xref="S4.E13.m1.6.6.2.2.2"></times><apply id="S4.E13.m1.6.6.2.2.3.cmml" xref="S4.E13.m1.6.6.2.2.3"><csymbol cd="ambiguous" id="S4.E13.m1.6.6.2.2.3.1.cmml" xref="S4.E13.m1.6.6.2.2.3">subscript</csymbol><ci id="S4.E13.m1.6.6.2.2.3.2.cmml" xref="S4.E13.m1.6.6.2.2.3.2">𝑅</ci><list id="S4.E13.m1.4.4.2.3.cmml" xref="S4.E13.m1.4.4.2.4"><ci id="S4.E13.m1.3.3.1.1.cmml" xref="S4.E13.m1.3.3.1.1">ℓ</ci><ci id="S4.E13.m1.4.4.2.2.cmml" xref="S4.E13.m1.4.4.2.2">italic-ϕ</ci></list></apply><apply id="S4.E13.m1.6.6.2.2.1.1.1.cmml" xref="S4.E13.m1.6.6.2.2.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.6.6.2.2.1.1.1.1.cmml" xref="S4.E13.m1.6.6.2.2.1.1">subscript</csymbol><apply id="S4.E13.m1.6.6.2.2.1.1.1.2.cmml" xref="S4.E13.m1.6.6.2.2.1.1.1.2"><ci id="S4.E13.m1.6.6.2.2.1.1.1.2.1.cmml" xref="S4.E13.m1.6.6.2.2.1.1.1.2.1">~</ci><ci id="S4.E13.m1.6.6.2.2.1.1.1.2.2.cmml" xref="S4.E13.m1.6.6.2.2.1.1.1.2.2">𝒟</ci></apply><ci id="S4.E13.m1.6.6.2.2.1.1.1.3.cmml" xref="S4.E13.m1.6.6.2.2.1.1.1.3">𝑌</ci></apply></apply></apply><apply id="S4.E13.m1.8.8.4.cmml" xref="S4.E13.m1.8.8.4"><times id="S4.E13.m1.8.8.4.3.cmml" xref="S4.E13.m1.8.8.4.3"></times><ci id="S4.E13.m1.8.8.4.4.cmml" xref="S4.E13.m1.8.8.4.4">𝒲</ci><interval closure="open" id="S4.E13.m1.8.8.4.2.3.cmml" xref="S4.E13.m1.8.8.4.2.2"><apply id="S4.E13.m1.7.7.3.1.1.1.cmml" xref="S4.E13.m1.7.7.3.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.7.7.3.1.1.1.1.cmml" xref="S4.E13.m1.7.7.3.1.1.1">subscript</csymbol><ci id="S4.E13.m1.7.7.3.1.1.1.2.cmml" xref="S4.E13.m1.7.7.3.1.1.1.2">𝒟</ci><ci id="S4.E13.m1.7.7.3.1.1.1.3.cmml" xref="S4.E13.m1.7.7.3.1.1.1.3">𝑌</ci></apply><apply id="S4.E13.m1.8.8.4.2.2.2.cmml" xref="S4.E13.m1.8.8.4.2.2.2"><csymbol cd="ambiguous" id="S4.E13.m1.8.8.4.2.2.2.1.cmml" xref="S4.E13.m1.8.8.4.2.2.2">subscript</csymbol><apply id="S4.E13.m1.8.8.4.2.2.2.2.cmml" xref="S4.E13.m1.8.8.4.2.2.2.2"><ci id="S4.E13.m1.8.8.4.2.2.2.2.1.cmml" xref="S4.E13.m1.8.8.4.2.2.2.2.1">~</ci><ci id="S4.E13.m1.8.8.4.2.2.2.2.2.cmml" xref="S4.E13.m1.8.8.4.2.2.2.2.2">𝒟</ci></apply><ci id="S4.E13.m1.8.8.4.2.2.2.3.cmml" xref="S4.E13.m1.8.8.4.2.2.2.3">𝑌</ci></apply></interval></apply></apply><apply id="S4.E13.m1.9.9c.cmml" xref="S4.E13.m1.9.9"><leq id="S4.E13.m1.9.9.8.cmml" xref="S4.E13.m1.9.9.8"></leq><share href="https://arxiv.org/html/2409.01890v1#S4.E13.m1.8.8.4.cmml" id="S4.E13.m1.9.9d.cmml" xref="S4.E13.m1.9.9"></share><apply id="S4.E13.m1.9.9.5.cmml" xref="S4.E13.m1.9.9.5"><csymbol cd="ambiguous" id="S4.E13.m1.9.9.5.2.cmml" xref="S4.E13.m1.9.9.5">subscript</csymbol><apply id="S4.E13.m1.9.9.5.1.2.cmml" xref="S4.E13.m1.9.9.5.1.1"><csymbol cd="latexml" id="S4.E13.m1.9.9.5.1.2.1.cmml" xref="S4.E13.m1.9.9.5.1.1.2">norm</csymbol><apply id="S4.E13.m1.9.9.5.1.1.1.cmml" xref="S4.E13.m1.9.9.5.1.1.1"><minus id="S4.E13.m1.9.9.5.1.1.1.1.cmml" xref="S4.E13.m1.9.9.5.1.1.1.1"></minus><ci id="S4.E13.m1.9.9.5.1.1.1.2.cmml" xref="S4.E13.m1.9.9.5.1.1.1.2">𝑔</ci><apply id="S4.E13.m1.9.9.5.1.1.1.3.cmml" xref="S4.E13.m1.9.9.5.1.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.9.9.5.1.1.1.3.1.cmml" xref="S4.E13.m1.9.9.5.1.1.1.3">superscript</csymbol><ci id="S4.E13.m1.9.9.5.1.1.1.3.2.cmml" xref="S4.E13.m1.9.9.5.1.1.1.3.2">𝑔</ci><ci id="S4.E13.m1.9.9.5.1.1.1.3.3.cmml" xref="S4.E13.m1.9.9.5.1.1.1.3.3">′</ci></apply></apply></apply><cn id="S4.E13.m1.9.9.5.3.cmml" type="integer" xref="S4.E13.m1.9.9.5.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.9c">R_{\ell,\phi}(\mathscr{D}_{Y})-R_{\ell,\phi}(\tilde{\mathscr{D}}_{Y})\leq%
\mathcal{W}(\mathscr{D}_{Y},\tilde{\mathscr{D}}_{Y})\leq\|g-g^{\prime}\|_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.E13.m1.9d">italic_R start_POSTSUBSCRIPT roman_ℓ , italic_ϕ end_POSTSUBSCRIPT ( script_D start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT ) - italic_R start_POSTSUBSCRIPT roman_ℓ , italic_ϕ end_POSTSUBSCRIPT ( over~ start_ARG script_D end_ARG start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT ) ≤ caligraphic_W ( script_D start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT , over~ start_ARG script_D end_ARG start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT ) ≤ ∥ italic_g - italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.Thmtheorem1.p1.8"><span class="ltx_text ltx_font_italic" id="S4.Thmtheorem1.p1.8.6">where <math alttext="\mathcal{W}" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.3.1.m1.1"><semantics id="S4.Thmtheorem1.p1.3.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.Thmtheorem1.p1.3.1.m1.1.1" xref="S4.Thmtheorem1.p1.3.1.m1.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.3.1.m1.1b"><ci id="S4.Thmtheorem1.p1.3.1.m1.1.1.cmml" xref="S4.Thmtheorem1.p1.3.1.m1.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.3.1.m1.1c">\mathcal{W}</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.3.1.m1.1d">caligraphic_W</annotation></semantics></math> is the Wasserstein distance. Furthermore, if the approximation <math alttext="g^{\prime}" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.4.2.m2.1"><semantics id="S4.Thmtheorem1.p1.4.2.m2.1a"><msup id="S4.Thmtheorem1.p1.4.2.m2.1.1" xref="S4.Thmtheorem1.p1.4.2.m2.1.1.cmml"><mi id="S4.Thmtheorem1.p1.4.2.m2.1.1.2" xref="S4.Thmtheorem1.p1.4.2.m2.1.1.2.cmml">g</mi><mo id="S4.Thmtheorem1.p1.4.2.m2.1.1.3" xref="S4.Thmtheorem1.p1.4.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.4.2.m2.1b"><apply id="S4.Thmtheorem1.p1.4.2.m2.1.1.cmml" xref="S4.Thmtheorem1.p1.4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.4.2.m2.1.1.1.cmml" xref="S4.Thmtheorem1.p1.4.2.m2.1.1">superscript</csymbol><ci id="S4.Thmtheorem1.p1.4.2.m2.1.1.2.cmml" xref="S4.Thmtheorem1.p1.4.2.m2.1.1.2">𝑔</ci><ci id="S4.Thmtheorem1.p1.4.2.m2.1.1.3.cmml" xref="S4.Thmtheorem1.p1.4.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.4.2.m2.1c">g^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.4.2.m2.1d">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> comes from the same neural model as <math alttext="g" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.5.3.m3.1"><semantics id="S4.Thmtheorem1.p1.5.3.m3.1a"><mi id="S4.Thmtheorem1.p1.5.3.m3.1.1" xref="S4.Thmtheorem1.p1.5.3.m3.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.5.3.m3.1b"><ci id="S4.Thmtheorem1.p1.5.3.m3.1.1.cmml" xref="S4.Thmtheorem1.p1.5.3.m3.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.5.3.m3.1c">g</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.5.3.m3.1d">italic_g</annotation></semantics></math> with parameters perturbed by <math alttext="u" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.6.4.m4.1"><semantics id="S4.Thmtheorem1.p1.6.4.m4.1a"><mi id="S4.Thmtheorem1.p1.6.4.m4.1.1" xref="S4.Thmtheorem1.p1.6.4.m4.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.6.4.m4.1b"><ci id="S4.Thmtheorem1.p1.6.4.m4.1.1.cmml" xref="S4.Thmtheorem1.p1.6.4.m4.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.6.4.m4.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.6.4.m4.1d">italic_u</annotation></semantics></math> as in aforementioned stale approximation, we have: <math alttext="\|g-g^{\prime}\|_{1}\leq L\|u\|" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.7.5.m5.2"><semantics id="S4.Thmtheorem1.p1.7.5.m5.2a"><mrow id="S4.Thmtheorem1.p1.7.5.m5.2.2" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.cmml"><msub id="S4.Thmtheorem1.p1.7.5.m5.2.2.1" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.1.cmml"><mrow id="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.2.cmml"><mo id="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.2" stretchy="false" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.2.1.cmml">‖</mo><mrow id="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.1" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.1.cmml"><mi id="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.1.2" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.1.2.cmml">g</mi><mo id="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.1.1" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.1.1.cmml">−</mo><msup id="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.1.3" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.1.3.cmml"><mi id="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.1.3.2" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.1.3.2.cmml">g</mi><mo id="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.1.3.3" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.3" stretchy="false" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.Thmtheorem1.p1.7.5.m5.2.2.1.3" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.1.3.cmml">1</mn></msub><mo id="S4.Thmtheorem1.p1.7.5.m5.2.2.2" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.2.cmml">≤</mo><mrow id="S4.Thmtheorem1.p1.7.5.m5.2.2.3" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.3.cmml"><mi id="S4.Thmtheorem1.p1.7.5.m5.2.2.3.2" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.3.2.cmml">L</mi><mo id="S4.Thmtheorem1.p1.7.5.m5.2.2.3.1" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.3.1.cmml">⁢</mo><mrow id="S4.Thmtheorem1.p1.7.5.m5.2.2.3.3.2" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.3.3.1.cmml"><mo id="S4.Thmtheorem1.p1.7.5.m5.2.2.3.3.2.1" stretchy="false" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.3.3.1.1.cmml">‖</mo><mi id="S4.Thmtheorem1.p1.7.5.m5.1.1" xref="S4.Thmtheorem1.p1.7.5.m5.1.1.cmml">u</mi><mo id="S4.Thmtheorem1.p1.7.5.m5.2.2.3.3.2.2" stretchy="false" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.3.3.1.1.cmml">‖</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.7.5.m5.2b"><apply id="S4.Thmtheorem1.p1.7.5.m5.2.2.cmml" xref="S4.Thmtheorem1.p1.7.5.m5.2.2"><leq id="S4.Thmtheorem1.p1.7.5.m5.2.2.2.cmml" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.2"></leq><apply id="S4.Thmtheorem1.p1.7.5.m5.2.2.1.cmml" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.1"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.7.5.m5.2.2.1.2.cmml" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.1">subscript</csymbol><apply id="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.2.cmml" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1"><csymbol cd="latexml" id="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.2.1.cmml" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.2">norm</csymbol><apply id="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.1.cmml" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.1"><minus id="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.1.1.cmml" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.1.1"></minus><ci id="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.1.2.cmml" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.1.2">𝑔</ci><apply id="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.1.3.cmml" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.1.3.1.cmml" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.1.3">superscript</csymbol><ci id="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.1.3.2.cmml" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.1.3.2">𝑔</ci><ci id="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.1.3.3.cmml" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.1.1.1.1.3.3">′</ci></apply></apply></apply><cn id="S4.Thmtheorem1.p1.7.5.m5.2.2.1.3.cmml" type="integer" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.1.3">1</cn></apply><apply id="S4.Thmtheorem1.p1.7.5.m5.2.2.3.cmml" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.3"><times id="S4.Thmtheorem1.p1.7.5.m5.2.2.3.1.cmml" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.3.1"></times><ci id="S4.Thmtheorem1.p1.7.5.m5.2.2.3.2.cmml" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.3.2">𝐿</ci><apply id="S4.Thmtheorem1.p1.7.5.m5.2.2.3.3.1.cmml" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.3.3.2"><csymbol cd="latexml" id="S4.Thmtheorem1.p1.7.5.m5.2.2.3.3.1.1.cmml" xref="S4.Thmtheorem1.p1.7.5.m5.2.2.3.3.2.1">norm</csymbol><ci id="S4.Thmtheorem1.p1.7.5.m5.1.1.cmml" xref="S4.Thmtheorem1.p1.7.5.m5.1.1">𝑢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.7.5.m5.2c">\|g-g^{\prime}\|_{1}\leq L\|u\|</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.7.5.m5.2d">∥ italic_g - italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≤ italic_L ∥ italic_u ∥</annotation></semantics></math> with <math alttext="L" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.8.6.m6.1"><semantics id="S4.Thmtheorem1.p1.8.6.m6.1a"><mi id="S4.Thmtheorem1.p1.8.6.m6.1.1" xref="S4.Thmtheorem1.p1.8.6.m6.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.8.6.m6.1b"><ci id="S4.Thmtheorem1.p1.8.6.m6.1.1.cmml" xref="S4.Thmtheorem1.p1.8.6.m6.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.8.6.m6.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.8.6.m6.1d">italic_L</annotation></semantics></math> as the Lipschitz constant.</span></p>
</div>
</div>
<div class="ltx_para" id="S4.p10">
<p class="ltx_p" id="S4.p10.1">Next, we connect stale population risk to the empirical risk.</p>
</div>
<div class="ltx_theorem ltx_theorem_lemma" id="S4.Thmtheorem2">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="S4.Thmtheorem2.1.1.1">Lemma 4.2</span></span><span class="ltx_text ltx_font_bold" id="S4.Thmtheorem2.2.2">.</span>
</h6>
<div class="ltx_para" id="S4.Thmtheorem2.p1">
<p class="ltx_p" id="S4.Thmtheorem2.p1.5"><span class="ltx_text ltx_font_italic" id="S4.Thmtheorem2.p1.5.5">Given a target encoder <math alttext="g" class="ltx_Math" display="inline" id="S4.Thmtheorem2.p1.1.1.m1.1"><semantics id="S4.Thmtheorem2.p1.1.1.m1.1a"><mi id="S4.Thmtheorem2.p1.1.1.m1.1.1" xref="S4.Thmtheorem2.p1.1.1.m1.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem2.p1.1.1.m1.1b"><ci id="S4.Thmtheorem2.p1.1.1.m1.1.1.cmml" xref="S4.Thmtheorem2.p1.1.1.m1.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem2.p1.1.1.m1.1c">g</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem2.p1.1.1.m1.1d">italic_g</annotation></semantics></math>, its stale approximation <math alttext="g^{\prime}" class="ltx_Math" display="inline" id="S4.Thmtheorem2.p1.2.2.m2.1"><semantics id="S4.Thmtheorem2.p1.2.2.m2.1a"><msup id="S4.Thmtheorem2.p1.2.2.m2.1.1" xref="S4.Thmtheorem2.p1.2.2.m2.1.1.cmml"><mi id="S4.Thmtheorem2.p1.2.2.m2.1.1.2" xref="S4.Thmtheorem2.p1.2.2.m2.1.1.2.cmml">g</mi><mo id="S4.Thmtheorem2.p1.2.2.m2.1.1.3" xref="S4.Thmtheorem2.p1.2.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem2.p1.2.2.m2.1b"><apply id="S4.Thmtheorem2.p1.2.2.m2.1.1.cmml" xref="S4.Thmtheorem2.p1.2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.Thmtheorem2.p1.2.2.m2.1.1.1.cmml" xref="S4.Thmtheorem2.p1.2.2.m2.1.1">superscript</csymbol><ci id="S4.Thmtheorem2.p1.2.2.m2.1.1.2.cmml" xref="S4.Thmtheorem2.p1.2.2.m2.1.1.2">𝑔</ci><ci id="S4.Thmtheorem2.p1.2.2.m2.1.1.3.cmml" xref="S4.Thmtheorem2.p1.2.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem2.p1.2.2.m2.1c">g^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem2.p1.2.2.m2.1d">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, and a set of <math alttext="n" class="ltx_Math" display="inline" id="S4.Thmtheorem2.p1.3.3.m3.1"><semantics id="S4.Thmtheorem2.p1.3.3.m3.1a"><mi id="S4.Thmtheorem2.p1.3.3.m3.1.1" xref="S4.Thmtheorem2.p1.3.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem2.p1.3.3.m3.1b"><ci id="S4.Thmtheorem2.p1.3.3.m3.1.1.cmml" xref="S4.Thmtheorem2.p1.3.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem2.p1.3.3.m3.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem2.p1.3.3.m3.1d">italic_n</annotation></semantics></math>-targets <math alttext="\tilde{\mathscr{S}}_{n}=\{y_{1},...,y_{n}\}" class="ltx_Math" display="inline" id="S4.Thmtheorem2.p1.4.4.m4.3"><semantics id="S4.Thmtheorem2.p1.4.4.m4.3a"><mrow id="S4.Thmtheorem2.p1.4.4.m4.3.3" xref="S4.Thmtheorem2.p1.4.4.m4.3.3.cmml"><msub id="S4.Thmtheorem2.p1.4.4.m4.3.3.4" xref="S4.Thmtheorem2.p1.4.4.m4.3.3.4.cmml"><mover accent="true" id="S4.Thmtheorem2.p1.4.4.m4.3.3.4.2" xref="S4.Thmtheorem2.p1.4.4.m4.3.3.4.2.cmml"><mi class="ltx_font_mathscript" id="S4.Thmtheorem2.p1.4.4.m4.3.3.4.2.2" xref="S4.Thmtheorem2.p1.4.4.m4.3.3.4.2.2.cmml">𝒮</mi><mo id="S4.Thmtheorem2.p1.4.4.m4.3.3.4.2.1" xref="S4.Thmtheorem2.p1.4.4.m4.3.3.4.2.1.cmml">~</mo></mover><mi id="S4.Thmtheorem2.p1.4.4.m4.3.3.4.3" xref="S4.Thmtheorem2.p1.4.4.m4.3.3.4.3.cmml">n</mi></msub><mo id="S4.Thmtheorem2.p1.4.4.m4.3.3.3" xref="S4.Thmtheorem2.p1.4.4.m4.3.3.3.cmml">=</mo><mrow id="S4.Thmtheorem2.p1.4.4.m4.3.3.2.2" xref="S4.Thmtheorem2.p1.4.4.m4.3.3.2.3.cmml"><mo id="S4.Thmtheorem2.p1.4.4.m4.3.3.2.2.3" stretchy="false" xref="S4.Thmtheorem2.p1.4.4.m4.3.3.2.3.cmml">{</mo><msub id="S4.Thmtheorem2.p1.4.4.m4.2.2.1.1.1" xref="S4.Thmtheorem2.p1.4.4.m4.2.2.1.1.1.cmml"><mi id="S4.Thmtheorem2.p1.4.4.m4.2.2.1.1.1.2" xref="S4.Thmtheorem2.p1.4.4.m4.2.2.1.1.1.2.cmml">y</mi><mn id="S4.Thmtheorem2.p1.4.4.m4.2.2.1.1.1.3" xref="S4.Thmtheorem2.p1.4.4.m4.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.Thmtheorem2.p1.4.4.m4.3.3.2.2.4" xref="S4.Thmtheorem2.p1.4.4.m4.3.3.2.3.cmml">,</mo><mi id="S4.Thmtheorem2.p1.4.4.m4.1.1" mathvariant="normal" xref="S4.Thmtheorem2.p1.4.4.m4.1.1.cmml">…</mi><mo id="S4.Thmtheorem2.p1.4.4.m4.3.3.2.2.5" xref="S4.Thmtheorem2.p1.4.4.m4.3.3.2.3.cmml">,</mo><msub id="S4.Thmtheorem2.p1.4.4.m4.3.3.2.2.2" xref="S4.Thmtheorem2.p1.4.4.m4.3.3.2.2.2.cmml"><mi id="S4.Thmtheorem2.p1.4.4.m4.3.3.2.2.2.2" xref="S4.Thmtheorem2.p1.4.4.m4.3.3.2.2.2.2.cmml">y</mi><mi id="S4.Thmtheorem2.p1.4.4.m4.3.3.2.2.2.3" xref="S4.Thmtheorem2.p1.4.4.m4.3.3.2.2.2.3.cmml">n</mi></msub><mo id="S4.Thmtheorem2.p1.4.4.m4.3.3.2.2.6" stretchy="false" xref="S4.Thmtheorem2.p1.4.4.m4.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem2.p1.4.4.m4.3b"><apply id="S4.Thmtheorem2.p1.4.4.m4.3.3.cmml" xref="S4.Thmtheorem2.p1.4.4.m4.3.3"><eq id="S4.Thmtheorem2.p1.4.4.m4.3.3.3.cmml" xref="S4.Thmtheorem2.p1.4.4.m4.3.3.3"></eq><apply id="S4.Thmtheorem2.p1.4.4.m4.3.3.4.cmml" xref="S4.Thmtheorem2.p1.4.4.m4.3.3.4"><csymbol cd="ambiguous" id="S4.Thmtheorem2.p1.4.4.m4.3.3.4.1.cmml" xref="S4.Thmtheorem2.p1.4.4.m4.3.3.4">subscript</csymbol><apply id="S4.Thmtheorem2.p1.4.4.m4.3.3.4.2.cmml" xref="S4.Thmtheorem2.p1.4.4.m4.3.3.4.2"><ci id="S4.Thmtheorem2.p1.4.4.m4.3.3.4.2.1.cmml" xref="S4.Thmtheorem2.p1.4.4.m4.3.3.4.2.1">~</ci><ci id="S4.Thmtheorem2.p1.4.4.m4.3.3.4.2.2.cmml" xref="S4.Thmtheorem2.p1.4.4.m4.3.3.4.2.2">𝒮</ci></apply><ci id="S4.Thmtheorem2.p1.4.4.m4.3.3.4.3.cmml" xref="S4.Thmtheorem2.p1.4.4.m4.3.3.4.3">𝑛</ci></apply><set id="S4.Thmtheorem2.p1.4.4.m4.3.3.2.3.cmml" xref="S4.Thmtheorem2.p1.4.4.m4.3.3.2.2"><apply id="S4.Thmtheorem2.p1.4.4.m4.2.2.1.1.1.cmml" xref="S4.Thmtheorem2.p1.4.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.Thmtheorem2.p1.4.4.m4.2.2.1.1.1.1.cmml" xref="S4.Thmtheorem2.p1.4.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S4.Thmtheorem2.p1.4.4.m4.2.2.1.1.1.2.cmml" xref="S4.Thmtheorem2.p1.4.4.m4.2.2.1.1.1.2">𝑦</ci><cn id="S4.Thmtheorem2.p1.4.4.m4.2.2.1.1.1.3.cmml" type="integer" xref="S4.Thmtheorem2.p1.4.4.m4.2.2.1.1.1.3">1</cn></apply><ci id="S4.Thmtheorem2.p1.4.4.m4.1.1.cmml" xref="S4.Thmtheorem2.p1.4.4.m4.1.1">…</ci><apply id="S4.Thmtheorem2.p1.4.4.m4.3.3.2.2.2.cmml" xref="S4.Thmtheorem2.p1.4.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.Thmtheorem2.p1.4.4.m4.3.3.2.2.2.1.cmml" xref="S4.Thmtheorem2.p1.4.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S4.Thmtheorem2.p1.4.4.m4.3.3.2.2.2.2.cmml" xref="S4.Thmtheorem2.p1.4.4.m4.3.3.2.2.2.2">𝑦</ci><ci id="S4.Thmtheorem2.p1.4.4.m4.3.3.2.2.2.3.cmml" xref="S4.Thmtheorem2.p1.4.4.m4.3.3.2.2.2.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem2.p1.4.4.m4.3c">\tilde{\mathscr{S}}_{n}=\{y_{1},...,y_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem2.p1.4.4.m4.3d">over~ start_ARG script_S end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT = { italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_y start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math> sampled from <math alttext="\tilde{\mathscr{D}}_{Y}" class="ltx_Math" display="inline" id="S4.Thmtheorem2.p1.5.5.m5.1"><semantics id="S4.Thmtheorem2.p1.5.5.m5.1a"><msub id="S4.Thmtheorem2.p1.5.5.m5.1.1" xref="S4.Thmtheorem2.p1.5.5.m5.1.1.cmml"><mover accent="true" id="S4.Thmtheorem2.p1.5.5.m5.1.1.2" xref="S4.Thmtheorem2.p1.5.5.m5.1.1.2.cmml"><mi class="ltx_font_mathscript" id="S4.Thmtheorem2.p1.5.5.m5.1.1.2.2" xref="S4.Thmtheorem2.p1.5.5.m5.1.1.2.2.cmml">𝒟</mi><mo id="S4.Thmtheorem2.p1.5.5.m5.1.1.2.1" xref="S4.Thmtheorem2.p1.5.5.m5.1.1.2.1.cmml">~</mo></mover><mi id="S4.Thmtheorem2.p1.5.5.m5.1.1.3" xref="S4.Thmtheorem2.p1.5.5.m5.1.1.3.cmml">Y</mi></msub><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem2.p1.5.5.m5.1b"><apply id="S4.Thmtheorem2.p1.5.5.m5.1.1.cmml" xref="S4.Thmtheorem2.p1.5.5.m5.1.1"><csymbol cd="ambiguous" id="S4.Thmtheorem2.p1.5.5.m5.1.1.1.cmml" xref="S4.Thmtheorem2.p1.5.5.m5.1.1">subscript</csymbol><apply id="S4.Thmtheorem2.p1.5.5.m5.1.1.2.cmml" xref="S4.Thmtheorem2.p1.5.5.m5.1.1.2"><ci id="S4.Thmtheorem2.p1.5.5.m5.1.1.2.1.cmml" xref="S4.Thmtheorem2.p1.5.5.m5.1.1.2.1">~</ci><ci id="S4.Thmtheorem2.p1.5.5.m5.1.1.2.2.cmml" xref="S4.Thmtheorem2.p1.5.5.m5.1.1.2.2">𝒟</ci></apply><ci id="S4.Thmtheorem2.p1.5.5.m5.1.1.3.cmml" xref="S4.Thmtheorem2.p1.5.5.m5.1.1.3">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem2.p1.5.5.m5.1c">\tilde{\mathscr{D}}_{Y}</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem2.p1.5.5.m5.1d">over~ start_ARG script_D end_ARG start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT</annotation></semantics></math>,</span></p>
<table class="ltx_equation ltx_eqn_table" id="S4.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="R_{\ell,\tilde{\phi}_{n}}(\tilde{\mathscr{D}}_{Y})\leq R_{\ell,\tilde{\phi}_{n%
}}(\tilde{\mathscr{S}}_{n})+{\mathfrak{R}}_{\tilde{\mathscr{S}}_{n}}(\mathcal{%
G}_{\ell,\mathcal{F}})," class="ltx_Math" display="block" id="S4.E14.m1.7"><semantics id="S4.E14.m1.7a"><mrow id="S4.E14.m1.7.7.1" xref="S4.E14.m1.7.7.1.1.cmml"><mrow id="S4.E14.m1.7.7.1.1" xref="S4.E14.m1.7.7.1.1.cmml"><mrow id="S4.E14.m1.7.7.1.1.1" xref="S4.E14.m1.7.7.1.1.1.cmml"><msub id="S4.E14.m1.7.7.1.1.1.3" xref="S4.E14.m1.7.7.1.1.1.3.cmml"><mi id="S4.E14.m1.7.7.1.1.1.3.2" xref="S4.E14.m1.7.7.1.1.1.3.2.cmml">R</mi><mrow id="S4.E14.m1.2.2.2.2" xref="S4.E14.m1.2.2.2.3.cmml"><mi id="S4.E14.m1.1.1.1.1" mathvariant="normal" xref="S4.E14.m1.1.1.1.1.cmml">ℓ</mi><mo id="S4.E14.m1.2.2.2.2.2" xref="S4.E14.m1.2.2.2.3.cmml">,</mo><msub id="S4.E14.m1.2.2.2.2.1" xref="S4.E14.m1.2.2.2.2.1.cmml"><mover accent="true" id="S4.E14.m1.2.2.2.2.1.2" xref="S4.E14.m1.2.2.2.2.1.2.cmml"><mi id="S4.E14.m1.2.2.2.2.1.2.2" xref="S4.E14.m1.2.2.2.2.1.2.2.cmml">ϕ</mi><mo id="S4.E14.m1.2.2.2.2.1.2.1" xref="S4.E14.m1.2.2.2.2.1.2.1.cmml">~</mo></mover><mi id="S4.E14.m1.2.2.2.2.1.3" xref="S4.E14.m1.2.2.2.2.1.3.cmml">n</mi></msub></mrow></msub><mo id="S4.E14.m1.7.7.1.1.1.2" xref="S4.E14.m1.7.7.1.1.1.2.cmml">⁢</mo><mrow id="S4.E14.m1.7.7.1.1.1.1.1" xref="S4.E14.m1.7.7.1.1.1.1.1.1.cmml"><mo id="S4.E14.m1.7.7.1.1.1.1.1.2" stretchy="false" xref="S4.E14.m1.7.7.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E14.m1.7.7.1.1.1.1.1.1" xref="S4.E14.m1.7.7.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.E14.m1.7.7.1.1.1.1.1.1.2" xref="S4.E14.m1.7.7.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathscript" id="S4.E14.m1.7.7.1.1.1.1.1.1.2.2" xref="S4.E14.m1.7.7.1.1.1.1.1.1.2.2.cmml">𝒟</mi><mo id="S4.E14.m1.7.7.1.1.1.1.1.1.2.1" xref="S4.E14.m1.7.7.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S4.E14.m1.7.7.1.1.1.1.1.1.3" xref="S4.E14.m1.7.7.1.1.1.1.1.1.3.cmml">Y</mi></msub><mo id="S4.E14.m1.7.7.1.1.1.1.1.3" stretchy="false" xref="S4.E14.m1.7.7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E14.m1.7.7.1.1.4" xref="S4.E14.m1.7.7.1.1.4.cmml">≤</mo><mrow id="S4.E14.m1.7.7.1.1.3" xref="S4.E14.m1.7.7.1.1.3.cmml"><mrow id="S4.E14.m1.7.7.1.1.2.1" xref="S4.E14.m1.7.7.1.1.2.1.cmml"><msub id="S4.E14.m1.7.7.1.1.2.1.3" xref="S4.E14.m1.7.7.1.1.2.1.3.cmml"><mi id="S4.E14.m1.7.7.1.1.2.1.3.2" xref="S4.E14.m1.7.7.1.1.2.1.3.2.cmml">R</mi><mrow id="S4.E14.m1.4.4.2.2" xref="S4.E14.m1.4.4.2.3.cmml"><mi id="S4.E14.m1.3.3.1.1" mathvariant="normal" xref="S4.E14.m1.3.3.1.1.cmml">ℓ</mi><mo id="S4.E14.m1.4.4.2.2.2" xref="S4.E14.m1.4.4.2.3.cmml">,</mo><msub id="S4.E14.m1.4.4.2.2.1" xref="S4.E14.m1.4.4.2.2.1.cmml"><mover accent="true" id="S4.E14.m1.4.4.2.2.1.2" xref="S4.E14.m1.4.4.2.2.1.2.cmml"><mi id="S4.E14.m1.4.4.2.2.1.2.2" xref="S4.E14.m1.4.4.2.2.1.2.2.cmml">ϕ</mi><mo id="S4.E14.m1.4.4.2.2.1.2.1" xref="S4.E14.m1.4.4.2.2.1.2.1.cmml">~</mo></mover><mi id="S4.E14.m1.4.4.2.2.1.3" xref="S4.E14.m1.4.4.2.2.1.3.cmml">n</mi></msub></mrow></msub><mo id="S4.E14.m1.7.7.1.1.2.1.2" xref="S4.E14.m1.7.7.1.1.2.1.2.cmml">⁢</mo><mrow id="S4.E14.m1.7.7.1.1.2.1.1.1" xref="S4.E14.m1.7.7.1.1.2.1.1.1.1.cmml"><mo id="S4.E14.m1.7.7.1.1.2.1.1.1.2" stretchy="false" xref="S4.E14.m1.7.7.1.1.2.1.1.1.1.cmml">(</mo><msub id="S4.E14.m1.7.7.1.1.2.1.1.1.1" xref="S4.E14.m1.7.7.1.1.2.1.1.1.1.cmml"><mover accent="true" id="S4.E14.m1.7.7.1.1.2.1.1.1.1.2" xref="S4.E14.m1.7.7.1.1.2.1.1.1.1.2.cmml"><mi class="ltx_font_mathscript" id="S4.E14.m1.7.7.1.1.2.1.1.1.1.2.2" xref="S4.E14.m1.7.7.1.1.2.1.1.1.1.2.2.cmml">𝒮</mi><mo id="S4.E14.m1.7.7.1.1.2.1.1.1.1.2.1" xref="S4.E14.m1.7.7.1.1.2.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S4.E14.m1.7.7.1.1.2.1.1.1.1.3" xref="S4.E14.m1.7.7.1.1.2.1.1.1.1.3.cmml">n</mi></msub><mo id="S4.E14.m1.7.7.1.1.2.1.1.1.3" stretchy="false" xref="S4.E14.m1.7.7.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E14.m1.7.7.1.1.3.3" xref="S4.E14.m1.7.7.1.1.3.3.cmml">+</mo><mrow id="S4.E14.m1.7.7.1.1.3.2" xref="S4.E14.m1.7.7.1.1.3.2.cmml"><msub id="S4.E14.m1.7.7.1.1.3.2.3" xref="S4.E14.m1.7.7.1.1.3.2.3.cmml"><mi id="S4.E14.m1.7.7.1.1.3.2.3.2" xref="S4.E14.m1.7.7.1.1.3.2.3.2.cmml">ℜ</mi><msub id="S4.E14.m1.7.7.1.1.3.2.3.3" xref="S4.E14.m1.7.7.1.1.3.2.3.3.cmml"><mover accent="true" id="S4.E14.m1.7.7.1.1.3.2.3.3.2" xref="S4.E14.m1.7.7.1.1.3.2.3.3.2.cmml"><mi class="ltx_font_mathscript" id="S4.E14.m1.7.7.1.1.3.2.3.3.2.2" xref="S4.E14.m1.7.7.1.1.3.2.3.3.2.2.cmml">𝒮</mi><mo id="S4.E14.m1.7.7.1.1.3.2.3.3.2.1" xref="S4.E14.m1.7.7.1.1.3.2.3.3.2.1.cmml">~</mo></mover><mi id="S4.E14.m1.7.7.1.1.3.2.3.3.3" xref="S4.E14.m1.7.7.1.1.3.2.3.3.3.cmml">n</mi></msub></msub><mo id="S4.E14.m1.7.7.1.1.3.2.2" xref="S4.E14.m1.7.7.1.1.3.2.2.cmml">⁢</mo><mrow id="S4.E14.m1.7.7.1.1.3.2.1.1" xref="S4.E14.m1.7.7.1.1.3.2.1.1.1.cmml"><mo id="S4.E14.m1.7.7.1.1.3.2.1.1.2" stretchy="false" xref="S4.E14.m1.7.7.1.1.3.2.1.1.1.cmml">(</mo><msub id="S4.E14.m1.7.7.1.1.3.2.1.1.1" xref="S4.E14.m1.7.7.1.1.3.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E14.m1.7.7.1.1.3.2.1.1.1.2" xref="S4.E14.m1.7.7.1.1.3.2.1.1.1.2.cmml">𝒢</mi><mrow id="S4.E14.m1.6.6.2.4" xref="S4.E14.m1.6.6.2.3.cmml"><mi id="S4.E14.m1.5.5.1.1" mathvariant="normal" xref="S4.E14.m1.5.5.1.1.cmml">ℓ</mi><mo id="S4.E14.m1.6.6.2.4.1" xref="S4.E14.m1.6.6.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.E14.m1.6.6.2.2" xref="S4.E14.m1.6.6.2.2.cmml">ℱ</mi></mrow></msub><mo id="S4.E14.m1.7.7.1.1.3.2.1.1.3" stretchy="false" xref="S4.E14.m1.7.7.1.1.3.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E14.m1.7.7.1.2" xref="S4.E14.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E14.m1.7b"><apply id="S4.E14.m1.7.7.1.1.cmml" xref="S4.E14.m1.7.7.1"><leq id="S4.E14.m1.7.7.1.1.4.cmml" xref="S4.E14.m1.7.7.1.1.4"></leq><apply id="S4.E14.m1.7.7.1.1.1.cmml" xref="S4.E14.m1.7.7.1.1.1"><times id="S4.E14.m1.7.7.1.1.1.2.cmml" xref="S4.E14.m1.7.7.1.1.1.2"></times><apply id="S4.E14.m1.7.7.1.1.1.3.cmml" xref="S4.E14.m1.7.7.1.1.1.3"><csymbol cd="ambiguous" id="S4.E14.m1.7.7.1.1.1.3.1.cmml" xref="S4.E14.m1.7.7.1.1.1.3">subscript</csymbol><ci id="S4.E14.m1.7.7.1.1.1.3.2.cmml" xref="S4.E14.m1.7.7.1.1.1.3.2">𝑅</ci><list id="S4.E14.m1.2.2.2.3.cmml" xref="S4.E14.m1.2.2.2.2"><ci id="S4.E14.m1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1">ℓ</ci><apply id="S4.E14.m1.2.2.2.2.1.cmml" xref="S4.E14.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.E14.m1.2.2.2.2.1.1.cmml" xref="S4.E14.m1.2.2.2.2.1">subscript</csymbol><apply id="S4.E14.m1.2.2.2.2.1.2.cmml" xref="S4.E14.m1.2.2.2.2.1.2"><ci id="S4.E14.m1.2.2.2.2.1.2.1.cmml" xref="S4.E14.m1.2.2.2.2.1.2.1">~</ci><ci id="S4.E14.m1.2.2.2.2.1.2.2.cmml" xref="S4.E14.m1.2.2.2.2.1.2.2">italic-ϕ</ci></apply><ci id="S4.E14.m1.2.2.2.2.1.3.cmml" xref="S4.E14.m1.2.2.2.2.1.3">𝑛</ci></apply></list></apply><apply id="S4.E14.m1.7.7.1.1.1.1.1.1.cmml" xref="S4.E14.m1.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.7.7.1.1.1.1.1">subscript</csymbol><apply id="S4.E14.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.7.7.1.1.1.1.1.1.2"><ci id="S4.E14.m1.7.7.1.1.1.1.1.1.2.1.cmml" xref="S4.E14.m1.7.7.1.1.1.1.1.1.2.1">~</ci><ci id="S4.E14.m1.7.7.1.1.1.1.1.1.2.2.cmml" xref="S4.E14.m1.7.7.1.1.1.1.1.1.2.2">𝒟</ci></apply><ci id="S4.E14.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S4.E14.m1.7.7.1.1.1.1.1.1.3">𝑌</ci></apply></apply><apply id="S4.E14.m1.7.7.1.1.3.cmml" xref="S4.E14.m1.7.7.1.1.3"><plus id="S4.E14.m1.7.7.1.1.3.3.cmml" xref="S4.E14.m1.7.7.1.1.3.3"></plus><apply id="S4.E14.m1.7.7.1.1.2.1.cmml" xref="S4.E14.m1.7.7.1.1.2.1"><times id="S4.E14.m1.7.7.1.1.2.1.2.cmml" xref="S4.E14.m1.7.7.1.1.2.1.2"></times><apply id="S4.E14.m1.7.7.1.1.2.1.3.cmml" xref="S4.E14.m1.7.7.1.1.2.1.3"><csymbol cd="ambiguous" id="S4.E14.m1.7.7.1.1.2.1.3.1.cmml" xref="S4.E14.m1.7.7.1.1.2.1.3">subscript</csymbol><ci id="S4.E14.m1.7.7.1.1.2.1.3.2.cmml" xref="S4.E14.m1.7.7.1.1.2.1.3.2">𝑅</ci><list id="S4.E14.m1.4.4.2.3.cmml" xref="S4.E14.m1.4.4.2.2"><ci id="S4.E14.m1.3.3.1.1.cmml" xref="S4.E14.m1.3.3.1.1">ℓ</ci><apply id="S4.E14.m1.4.4.2.2.1.cmml" xref="S4.E14.m1.4.4.2.2.1"><csymbol cd="ambiguous" id="S4.E14.m1.4.4.2.2.1.1.cmml" xref="S4.E14.m1.4.4.2.2.1">subscript</csymbol><apply id="S4.E14.m1.4.4.2.2.1.2.cmml" xref="S4.E14.m1.4.4.2.2.1.2"><ci id="S4.E14.m1.4.4.2.2.1.2.1.cmml" xref="S4.E14.m1.4.4.2.2.1.2.1">~</ci><ci id="S4.E14.m1.4.4.2.2.1.2.2.cmml" xref="S4.E14.m1.4.4.2.2.1.2.2">italic-ϕ</ci></apply><ci id="S4.E14.m1.4.4.2.2.1.3.cmml" xref="S4.E14.m1.4.4.2.2.1.3">𝑛</ci></apply></list></apply><apply id="S4.E14.m1.7.7.1.1.2.1.1.1.1.cmml" xref="S4.E14.m1.7.7.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.7.7.1.1.2.1.1.1.1.1.cmml" xref="S4.E14.m1.7.7.1.1.2.1.1.1">subscript</csymbol><apply id="S4.E14.m1.7.7.1.1.2.1.1.1.1.2.cmml" xref="S4.E14.m1.7.7.1.1.2.1.1.1.1.2"><ci id="S4.E14.m1.7.7.1.1.2.1.1.1.1.2.1.cmml" xref="S4.E14.m1.7.7.1.1.2.1.1.1.1.2.1">~</ci><ci id="S4.E14.m1.7.7.1.1.2.1.1.1.1.2.2.cmml" xref="S4.E14.m1.7.7.1.1.2.1.1.1.1.2.2">𝒮</ci></apply><ci id="S4.E14.m1.7.7.1.1.2.1.1.1.1.3.cmml" xref="S4.E14.m1.7.7.1.1.2.1.1.1.1.3">𝑛</ci></apply></apply><apply id="S4.E14.m1.7.7.1.1.3.2.cmml" xref="S4.E14.m1.7.7.1.1.3.2"><times id="S4.E14.m1.7.7.1.1.3.2.2.cmml" xref="S4.E14.m1.7.7.1.1.3.2.2"></times><apply id="S4.E14.m1.7.7.1.1.3.2.3.cmml" xref="S4.E14.m1.7.7.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E14.m1.7.7.1.1.3.2.3.1.cmml" xref="S4.E14.m1.7.7.1.1.3.2.3">subscript</csymbol><ci id="S4.E14.m1.7.7.1.1.3.2.3.2.cmml" xref="S4.E14.m1.7.7.1.1.3.2.3.2">ℜ</ci><apply id="S4.E14.m1.7.7.1.1.3.2.3.3.cmml" xref="S4.E14.m1.7.7.1.1.3.2.3.3"><csymbol cd="ambiguous" id="S4.E14.m1.7.7.1.1.3.2.3.3.1.cmml" xref="S4.E14.m1.7.7.1.1.3.2.3.3">subscript</csymbol><apply id="S4.E14.m1.7.7.1.1.3.2.3.3.2.cmml" xref="S4.E14.m1.7.7.1.1.3.2.3.3.2"><ci id="S4.E14.m1.7.7.1.1.3.2.3.3.2.1.cmml" xref="S4.E14.m1.7.7.1.1.3.2.3.3.2.1">~</ci><ci id="S4.E14.m1.7.7.1.1.3.2.3.3.2.2.cmml" xref="S4.E14.m1.7.7.1.1.3.2.3.3.2.2">𝒮</ci></apply><ci id="S4.E14.m1.7.7.1.1.3.2.3.3.3.cmml" xref="S4.E14.m1.7.7.1.1.3.2.3.3.3">𝑛</ci></apply></apply><apply id="S4.E14.m1.7.7.1.1.3.2.1.1.1.cmml" xref="S4.E14.m1.7.7.1.1.3.2.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.7.7.1.1.3.2.1.1.1.1.cmml" xref="S4.E14.m1.7.7.1.1.3.2.1.1">subscript</csymbol><ci id="S4.E14.m1.7.7.1.1.3.2.1.1.1.2.cmml" xref="S4.E14.m1.7.7.1.1.3.2.1.1.1.2">𝒢</ci><list id="S4.E14.m1.6.6.2.3.cmml" xref="S4.E14.m1.6.6.2.4"><ci id="S4.E14.m1.5.5.1.1.cmml" xref="S4.E14.m1.5.5.1.1">ℓ</ci><ci id="S4.E14.m1.6.6.2.2.cmml" xref="S4.E14.m1.6.6.2.2">ℱ</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14.m1.7c">R_{\ell,\tilde{\phi}_{n}}(\tilde{\mathscr{D}}_{Y})\leq R_{\ell,\tilde{\phi}_{n%
}}(\tilde{\mathscr{S}}_{n})+{\mathfrak{R}}_{\tilde{\mathscr{S}}_{n}}(\mathcal{%
G}_{\ell,\mathcal{F}}),</annotation><annotation encoding="application/x-llamapun" id="S4.E14.m1.7d">italic_R start_POSTSUBSCRIPT roman_ℓ , over~ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( over~ start_ARG script_D end_ARG start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT ) ≤ italic_R start_POSTSUBSCRIPT roman_ℓ , over~ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( over~ start_ARG script_S end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) + fraktur_R start_POSTSUBSCRIPT over~ start_ARG script_S end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( caligraphic_G start_POSTSUBSCRIPT roman_ℓ , caligraphic_F end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.Thmtheorem2.p1.7"><span class="ltx_text ltx_font_italic" id="S4.Thmtheorem2.p1.7.2">where <math alttext="{\mathfrak{R}}_{\tilde{\mathscr{S}}_{n}}(\mathcal{G}_{\ell,\mathcal{F}})" class="ltx_Math" display="inline" id="S4.Thmtheorem2.p1.6.1.m1.3"><semantics id="S4.Thmtheorem2.p1.6.1.m1.3a"><mrow id="S4.Thmtheorem2.p1.6.1.m1.3.3" xref="S4.Thmtheorem2.p1.6.1.m1.3.3.cmml"><msub id="S4.Thmtheorem2.p1.6.1.m1.3.3.3" xref="S4.Thmtheorem2.p1.6.1.m1.3.3.3.cmml"><mi id="S4.Thmtheorem2.p1.6.1.m1.3.3.3.2" xref="S4.Thmtheorem2.p1.6.1.m1.3.3.3.2.cmml">ℜ</mi><msub id="S4.Thmtheorem2.p1.6.1.m1.3.3.3.3" xref="S4.Thmtheorem2.p1.6.1.m1.3.3.3.3.cmml"><mover accent="true" id="S4.Thmtheorem2.p1.6.1.m1.3.3.3.3.2" xref="S4.Thmtheorem2.p1.6.1.m1.3.3.3.3.2.cmml"><mi class="ltx_font_mathscript" id="S4.Thmtheorem2.p1.6.1.m1.3.3.3.3.2.2" xref="S4.Thmtheorem2.p1.6.1.m1.3.3.3.3.2.2.cmml">𝒮</mi><mo id="S4.Thmtheorem2.p1.6.1.m1.3.3.3.3.2.1" xref="S4.Thmtheorem2.p1.6.1.m1.3.3.3.3.2.1.cmml">~</mo></mover><mi id="S4.Thmtheorem2.p1.6.1.m1.3.3.3.3.3" xref="S4.Thmtheorem2.p1.6.1.m1.3.3.3.3.3.cmml">n</mi></msub></msub><mo id="S4.Thmtheorem2.p1.6.1.m1.3.3.2" xref="S4.Thmtheorem2.p1.6.1.m1.3.3.2.cmml">⁢</mo><mrow id="S4.Thmtheorem2.p1.6.1.m1.3.3.1.1" xref="S4.Thmtheorem2.p1.6.1.m1.3.3.1.1.1.cmml"><mo id="S4.Thmtheorem2.p1.6.1.m1.3.3.1.1.2" stretchy="false" xref="S4.Thmtheorem2.p1.6.1.m1.3.3.1.1.1.cmml">(</mo><msub id="S4.Thmtheorem2.p1.6.1.m1.3.3.1.1.1" xref="S4.Thmtheorem2.p1.6.1.m1.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Thmtheorem2.p1.6.1.m1.3.3.1.1.1.2" xref="S4.Thmtheorem2.p1.6.1.m1.3.3.1.1.1.2.cmml">𝒢</mi><mrow id="S4.Thmtheorem2.p1.6.1.m1.2.2.2.4" xref="S4.Thmtheorem2.p1.6.1.m1.2.2.2.3.cmml"><mi id="S4.Thmtheorem2.p1.6.1.m1.1.1.1.1" mathvariant="normal" xref="S4.Thmtheorem2.p1.6.1.m1.1.1.1.1.cmml">ℓ</mi><mo id="S4.Thmtheorem2.p1.6.1.m1.2.2.2.4.1" xref="S4.Thmtheorem2.p1.6.1.m1.2.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.Thmtheorem2.p1.6.1.m1.2.2.2.2" xref="S4.Thmtheorem2.p1.6.1.m1.2.2.2.2.cmml">ℱ</mi></mrow></msub><mo id="S4.Thmtheorem2.p1.6.1.m1.3.3.1.1.3" stretchy="false" xref="S4.Thmtheorem2.p1.6.1.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem2.p1.6.1.m1.3b"><apply id="S4.Thmtheorem2.p1.6.1.m1.3.3.cmml" xref="S4.Thmtheorem2.p1.6.1.m1.3.3"><times id="S4.Thmtheorem2.p1.6.1.m1.3.3.2.cmml" xref="S4.Thmtheorem2.p1.6.1.m1.3.3.2"></times><apply id="S4.Thmtheorem2.p1.6.1.m1.3.3.3.cmml" xref="S4.Thmtheorem2.p1.6.1.m1.3.3.3"><csymbol cd="ambiguous" id="S4.Thmtheorem2.p1.6.1.m1.3.3.3.1.cmml" xref="S4.Thmtheorem2.p1.6.1.m1.3.3.3">subscript</csymbol><ci id="S4.Thmtheorem2.p1.6.1.m1.3.3.3.2.cmml" xref="S4.Thmtheorem2.p1.6.1.m1.3.3.3.2">ℜ</ci><apply id="S4.Thmtheorem2.p1.6.1.m1.3.3.3.3.cmml" xref="S4.Thmtheorem2.p1.6.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S4.Thmtheorem2.p1.6.1.m1.3.3.3.3.1.cmml" xref="S4.Thmtheorem2.p1.6.1.m1.3.3.3.3">subscript</csymbol><apply id="S4.Thmtheorem2.p1.6.1.m1.3.3.3.3.2.cmml" xref="S4.Thmtheorem2.p1.6.1.m1.3.3.3.3.2"><ci id="S4.Thmtheorem2.p1.6.1.m1.3.3.3.3.2.1.cmml" xref="S4.Thmtheorem2.p1.6.1.m1.3.3.3.3.2.1">~</ci><ci id="S4.Thmtheorem2.p1.6.1.m1.3.3.3.3.2.2.cmml" xref="S4.Thmtheorem2.p1.6.1.m1.3.3.3.3.2.2">𝒮</ci></apply><ci id="S4.Thmtheorem2.p1.6.1.m1.3.3.3.3.3.cmml" xref="S4.Thmtheorem2.p1.6.1.m1.3.3.3.3.3">𝑛</ci></apply></apply><apply id="S4.Thmtheorem2.p1.6.1.m1.3.3.1.1.1.cmml" xref="S4.Thmtheorem2.p1.6.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="S4.Thmtheorem2.p1.6.1.m1.3.3.1.1.1.1.cmml" xref="S4.Thmtheorem2.p1.6.1.m1.3.3.1.1">subscript</csymbol><ci id="S4.Thmtheorem2.p1.6.1.m1.3.3.1.1.1.2.cmml" xref="S4.Thmtheorem2.p1.6.1.m1.3.3.1.1.1.2">𝒢</ci><list id="S4.Thmtheorem2.p1.6.1.m1.2.2.2.3.cmml" xref="S4.Thmtheorem2.p1.6.1.m1.2.2.2.4"><ci id="S4.Thmtheorem2.p1.6.1.m1.1.1.1.1.cmml" xref="S4.Thmtheorem2.p1.6.1.m1.1.1.1.1">ℓ</ci><ci id="S4.Thmtheorem2.p1.6.1.m1.2.2.2.2.cmml" xref="S4.Thmtheorem2.p1.6.1.m1.2.2.2.2">ℱ</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem2.p1.6.1.m1.3c">{\mathfrak{R}}_{\tilde{\mathscr{S}}_{n}}(\mathcal{G}_{\ell,\mathcal{F}})</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem2.p1.6.1.m1.3d">fraktur_R start_POSTSUBSCRIPT over~ start_ARG script_S end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( caligraphic_G start_POSTSUBSCRIPT roman_ℓ , caligraphic_F end_POSTSUBSCRIPT )</annotation></semantics></math> is the Rademacher complexity of <math alttext="\mathcal{G}_{\ell,\mathcal{F}}" class="ltx_Math" display="inline" id="S4.Thmtheorem2.p1.7.2.m2.2"><semantics id="S4.Thmtheorem2.p1.7.2.m2.2a"><msub id="S4.Thmtheorem2.p1.7.2.m2.2.3" xref="S4.Thmtheorem2.p1.7.2.m2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Thmtheorem2.p1.7.2.m2.2.3.2" xref="S4.Thmtheorem2.p1.7.2.m2.2.3.2.cmml">𝒢</mi><mrow id="S4.Thmtheorem2.p1.7.2.m2.2.2.2.4" xref="S4.Thmtheorem2.p1.7.2.m2.2.2.2.3.cmml"><mi id="S4.Thmtheorem2.p1.7.2.m2.1.1.1.1" mathvariant="normal" xref="S4.Thmtheorem2.p1.7.2.m2.1.1.1.1.cmml">ℓ</mi><mo id="S4.Thmtheorem2.p1.7.2.m2.2.2.2.4.1" xref="S4.Thmtheorem2.p1.7.2.m2.2.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.Thmtheorem2.p1.7.2.m2.2.2.2.2" xref="S4.Thmtheorem2.p1.7.2.m2.2.2.2.2.cmml">ℱ</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem2.p1.7.2.m2.2b"><apply id="S4.Thmtheorem2.p1.7.2.m2.2.3.cmml" xref="S4.Thmtheorem2.p1.7.2.m2.2.3"><csymbol cd="ambiguous" id="S4.Thmtheorem2.p1.7.2.m2.2.3.1.cmml" xref="S4.Thmtheorem2.p1.7.2.m2.2.3">subscript</csymbol><ci id="S4.Thmtheorem2.p1.7.2.m2.2.3.2.cmml" xref="S4.Thmtheorem2.p1.7.2.m2.2.3.2">𝒢</ci><list id="S4.Thmtheorem2.p1.7.2.m2.2.2.2.3.cmml" xref="S4.Thmtheorem2.p1.7.2.m2.2.2.2.4"><ci id="S4.Thmtheorem2.p1.7.2.m2.1.1.1.1.cmml" xref="S4.Thmtheorem2.p1.7.2.m2.1.1.1.1">ℓ</ci><ci id="S4.Thmtheorem2.p1.7.2.m2.2.2.2.2.cmml" xref="S4.Thmtheorem2.p1.7.2.m2.2.2.2.2">ℱ</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem2.p1.7.2.m2.2c">\mathcal{G}_{\ell,\mathcal{F}}</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem2.p1.7.2.m2.2d">caligraphic_G start_POSTSUBSCRIPT roman_ℓ , caligraphic_F end_POSTSUBSCRIPT</annotation></semantics></math>.</span></p>
</div>
</div>
<div class="ltx_para" id="S4.p11">
<p class="ltx_p" id="S4.p11.4">Now, we can relate the complexity of function class <math alttext="\mathcal{F}^{g^{\prime}}" class="ltx_Math" display="inline" id="S4.p11.1.m1.1"><semantics id="S4.p11.1.m1.1a"><msup id="S4.p11.1.m1.1.1" xref="S4.p11.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p11.1.m1.1.1.2" xref="S4.p11.1.m1.1.1.2.cmml">ℱ</mi><msup id="S4.p11.1.m1.1.1.3" xref="S4.p11.1.m1.1.1.3.cmml"><mi id="S4.p11.1.m1.1.1.3.2" xref="S4.p11.1.m1.1.1.3.2.cmml">g</mi><mo id="S4.p11.1.m1.1.1.3.3" xref="S4.p11.1.m1.1.1.3.3.cmml">′</mo></msup></msup><annotation-xml encoding="MathML-Content" id="S4.p11.1.m1.1b"><apply id="S4.p11.1.m1.1.1.cmml" xref="S4.p11.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p11.1.m1.1.1.1.cmml" xref="S4.p11.1.m1.1.1">superscript</csymbol><ci id="S4.p11.1.m1.1.1.2.cmml" xref="S4.p11.1.m1.1.1.2">ℱ</ci><apply id="S4.p11.1.m1.1.1.3.cmml" xref="S4.p11.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.p11.1.m1.1.1.3.1.cmml" xref="S4.p11.1.m1.1.1.3">superscript</csymbol><ci id="S4.p11.1.m1.1.1.3.2.cmml" xref="S4.p11.1.m1.1.1.3.2">𝑔</ci><ci id="S4.p11.1.m1.1.1.3.3.cmml" xref="S4.p11.1.m1.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p11.1.m1.1c">\mathcal{F}^{g^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="S4.p11.1.m1.1d">caligraphic_F start_POSTSUPERSCRIPT italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, number of samples <math alttext="n" class="ltx_Math" display="inline" id="S4.p11.2.m2.1"><semantics id="S4.p11.2.m2.1a"><mi id="S4.p11.2.m2.1.1" xref="S4.p11.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.p11.2.m2.1b"><ci id="S4.p11.2.m2.1.1.cmml" xref="S4.p11.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p11.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.p11.2.m2.1d">italic_n</annotation></semantics></math>, and the discrepancy of the true <math alttext="g" class="ltx_Math" display="inline" id="S4.p11.3.m3.1"><semantics id="S4.p11.3.m3.1a"><mi id="S4.p11.3.m3.1.1" xref="S4.p11.3.m3.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S4.p11.3.m3.1b"><ci id="S4.p11.3.m3.1.1.cmml" xref="S4.p11.3.m3.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p11.3.m3.1c">g</annotation><annotation encoding="application/x-llamapun" id="S4.p11.3.m3.1d">italic_g</annotation></semantics></math> and stale approximate encoders <math alttext="g^{\prime}" class="ltx_Math" display="inline" id="S4.p11.4.m4.1"><semantics id="S4.p11.4.m4.1a"><msup id="S4.p11.4.m4.1.1" xref="S4.p11.4.m4.1.1.cmml"><mi id="S4.p11.4.m4.1.1.2" xref="S4.p11.4.m4.1.1.2.cmml">g</mi><mo id="S4.p11.4.m4.1.1.3" xref="S4.p11.4.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.p11.4.m4.1b"><apply id="S4.p11.4.m4.1.1.cmml" xref="S4.p11.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p11.4.m4.1.1.1.cmml" xref="S4.p11.4.m4.1.1">superscript</csymbol><ci id="S4.p11.4.m4.1.1.2.cmml" xref="S4.p11.4.m4.1.1.2">𝑔</ci><ci id="S4.p11.4.m4.1.1.3.cmml" xref="S4.p11.4.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p11.4.m4.1c">g^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.p11.4.m4.1d">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>:</p>
</div>
<div class="ltx_theorem ltx_theorem_theorem" id="S4.Thmtheorem3">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="S4.Thmtheorem3.1.1.1">Theorem 4.3</span></span><span class="ltx_text ltx_font_bold" id="S4.Thmtheorem3.2.2">.</span>
</h6>
<div class="ltx_para" id="S4.Thmtheorem3.p1">
<p class="ltx_p" id="S4.Thmtheorem3.p1.5"><span class="ltx_text ltx_font_italic" id="S4.Thmtheorem3.p1.5.5">For a target encoder, <math alttext="g" class="ltx_Math" display="inline" id="S4.Thmtheorem3.p1.1.1.m1.1"><semantics id="S4.Thmtheorem3.p1.1.1.m1.1a"><mi id="S4.Thmtheorem3.p1.1.1.m1.1.1" xref="S4.Thmtheorem3.p1.1.1.m1.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem3.p1.1.1.m1.1b"><ci id="S4.Thmtheorem3.p1.1.1.m1.1.1.cmml" xref="S4.Thmtheorem3.p1.1.1.m1.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem3.p1.1.1.m1.1c">g</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem3.p1.1.1.m1.1d">italic_g</annotation></semantics></math>, its stale approximation, <math alttext="g^{\prime}" class="ltx_Math" display="inline" id="S4.Thmtheorem3.p1.2.2.m2.1"><semantics id="S4.Thmtheorem3.p1.2.2.m2.1a"><msup id="S4.Thmtheorem3.p1.2.2.m2.1.1" xref="S4.Thmtheorem3.p1.2.2.m2.1.1.cmml"><mi id="S4.Thmtheorem3.p1.2.2.m2.1.1.2" xref="S4.Thmtheorem3.p1.2.2.m2.1.1.2.cmml">g</mi><mo id="S4.Thmtheorem3.p1.2.2.m2.1.1.3" xref="S4.Thmtheorem3.p1.2.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem3.p1.2.2.m2.1b"><apply id="S4.Thmtheorem3.p1.2.2.m2.1.1.cmml" xref="S4.Thmtheorem3.p1.2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.Thmtheorem3.p1.2.2.m2.1.1.1.cmml" xref="S4.Thmtheorem3.p1.2.2.m2.1.1">superscript</csymbol><ci id="S4.Thmtheorem3.p1.2.2.m2.1.1.2.cmml" xref="S4.Thmtheorem3.p1.2.2.m2.1.1.2">𝑔</ci><ci id="S4.Thmtheorem3.p1.2.2.m2.1.1.3.cmml" xref="S4.Thmtheorem3.p1.2.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem3.p1.2.2.m2.1c">g^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem3.p1.2.2.m2.1d">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, and the Rademacher complexity <math alttext="\tilde{\mathfrak{R}}_{n}(\mathcal{G}_{\ell,\mathcal{F}^{g^{\prime}}})" class="ltx_Math" display="inline" id="S4.Thmtheorem3.p1.3.3.m3.3"><semantics id="S4.Thmtheorem3.p1.3.3.m3.3a"><mrow id="S4.Thmtheorem3.p1.3.3.m3.3.3" xref="S4.Thmtheorem3.p1.3.3.m3.3.3.cmml"><msub id="S4.Thmtheorem3.p1.3.3.m3.3.3.3" xref="S4.Thmtheorem3.p1.3.3.m3.3.3.3.cmml"><mover accent="true" id="S4.Thmtheorem3.p1.3.3.m3.3.3.3.2" xref="S4.Thmtheorem3.p1.3.3.m3.3.3.3.2.cmml"><mi id="S4.Thmtheorem3.p1.3.3.m3.3.3.3.2.2" xref="S4.Thmtheorem3.p1.3.3.m3.3.3.3.2.2.cmml">ℜ</mi><mo id="S4.Thmtheorem3.p1.3.3.m3.3.3.3.2.1" xref="S4.Thmtheorem3.p1.3.3.m3.3.3.3.2.1.cmml">~</mo></mover><mi id="S4.Thmtheorem3.p1.3.3.m3.3.3.3.3" xref="S4.Thmtheorem3.p1.3.3.m3.3.3.3.3.cmml">n</mi></msub><mo id="S4.Thmtheorem3.p1.3.3.m3.3.3.2" xref="S4.Thmtheorem3.p1.3.3.m3.3.3.2.cmml">⁢</mo><mrow id="S4.Thmtheorem3.p1.3.3.m3.3.3.1.1" xref="S4.Thmtheorem3.p1.3.3.m3.3.3.1.1.1.cmml"><mo id="S4.Thmtheorem3.p1.3.3.m3.3.3.1.1.2" stretchy="false" xref="S4.Thmtheorem3.p1.3.3.m3.3.3.1.1.1.cmml">(</mo><msub id="S4.Thmtheorem3.p1.3.3.m3.3.3.1.1.1" xref="S4.Thmtheorem3.p1.3.3.m3.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Thmtheorem3.p1.3.3.m3.3.3.1.1.1.2" xref="S4.Thmtheorem3.p1.3.3.m3.3.3.1.1.1.2.cmml">𝒢</mi><mrow id="S4.Thmtheorem3.p1.3.3.m3.2.2.2.2" xref="S4.Thmtheorem3.p1.3.3.m3.2.2.2.3.cmml"><mi id="S4.Thmtheorem3.p1.3.3.m3.1.1.1.1" mathvariant="normal" xref="S4.Thmtheorem3.p1.3.3.m3.1.1.1.1.cmml">ℓ</mi><mo id="S4.Thmtheorem3.p1.3.3.m3.2.2.2.2.2" xref="S4.Thmtheorem3.p1.3.3.m3.2.2.2.3.cmml">,</mo><msup id="S4.Thmtheorem3.p1.3.3.m3.2.2.2.2.1" xref="S4.Thmtheorem3.p1.3.3.m3.2.2.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Thmtheorem3.p1.3.3.m3.2.2.2.2.1.2" xref="S4.Thmtheorem3.p1.3.3.m3.2.2.2.2.1.2.cmml">ℱ</mi><msup id="S4.Thmtheorem3.p1.3.3.m3.2.2.2.2.1.3" xref="S4.Thmtheorem3.p1.3.3.m3.2.2.2.2.1.3.cmml"><mi id="S4.Thmtheorem3.p1.3.3.m3.2.2.2.2.1.3.2" xref="S4.Thmtheorem3.p1.3.3.m3.2.2.2.2.1.3.2.cmml">g</mi><mo id="S4.Thmtheorem3.p1.3.3.m3.2.2.2.2.1.3.3" xref="S4.Thmtheorem3.p1.3.3.m3.2.2.2.2.1.3.3.cmml">′</mo></msup></msup></mrow></msub><mo id="S4.Thmtheorem3.p1.3.3.m3.3.3.1.1.3" stretchy="false" xref="S4.Thmtheorem3.p1.3.3.m3.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem3.p1.3.3.m3.3b"><apply id="S4.Thmtheorem3.p1.3.3.m3.3.3.cmml" xref="S4.Thmtheorem3.p1.3.3.m3.3.3"><times id="S4.Thmtheorem3.p1.3.3.m3.3.3.2.cmml" xref="S4.Thmtheorem3.p1.3.3.m3.3.3.2"></times><apply id="S4.Thmtheorem3.p1.3.3.m3.3.3.3.cmml" xref="S4.Thmtheorem3.p1.3.3.m3.3.3.3"><csymbol cd="ambiguous" id="S4.Thmtheorem3.p1.3.3.m3.3.3.3.1.cmml" xref="S4.Thmtheorem3.p1.3.3.m3.3.3.3">subscript</csymbol><apply id="S4.Thmtheorem3.p1.3.3.m3.3.3.3.2.cmml" xref="S4.Thmtheorem3.p1.3.3.m3.3.3.3.2"><ci id="S4.Thmtheorem3.p1.3.3.m3.3.3.3.2.1.cmml" xref="S4.Thmtheorem3.p1.3.3.m3.3.3.3.2.1">~</ci><ci id="S4.Thmtheorem3.p1.3.3.m3.3.3.3.2.2.cmml" xref="S4.Thmtheorem3.p1.3.3.m3.3.3.3.2.2">ℜ</ci></apply><ci id="S4.Thmtheorem3.p1.3.3.m3.3.3.3.3.cmml" xref="S4.Thmtheorem3.p1.3.3.m3.3.3.3.3">𝑛</ci></apply><apply id="S4.Thmtheorem3.p1.3.3.m3.3.3.1.1.1.cmml" xref="S4.Thmtheorem3.p1.3.3.m3.3.3.1.1"><csymbol cd="ambiguous" id="S4.Thmtheorem3.p1.3.3.m3.3.3.1.1.1.1.cmml" xref="S4.Thmtheorem3.p1.3.3.m3.3.3.1.1">subscript</csymbol><ci id="S4.Thmtheorem3.p1.3.3.m3.3.3.1.1.1.2.cmml" xref="S4.Thmtheorem3.p1.3.3.m3.3.3.1.1.1.2">𝒢</ci><list id="S4.Thmtheorem3.p1.3.3.m3.2.2.2.3.cmml" xref="S4.Thmtheorem3.p1.3.3.m3.2.2.2.2"><ci id="S4.Thmtheorem3.p1.3.3.m3.1.1.1.1.cmml" xref="S4.Thmtheorem3.p1.3.3.m3.1.1.1.1">ℓ</ci><apply id="S4.Thmtheorem3.p1.3.3.m3.2.2.2.2.1.cmml" xref="S4.Thmtheorem3.p1.3.3.m3.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.Thmtheorem3.p1.3.3.m3.2.2.2.2.1.1.cmml" xref="S4.Thmtheorem3.p1.3.3.m3.2.2.2.2.1">superscript</csymbol><ci id="S4.Thmtheorem3.p1.3.3.m3.2.2.2.2.1.2.cmml" xref="S4.Thmtheorem3.p1.3.3.m3.2.2.2.2.1.2">ℱ</ci><apply id="S4.Thmtheorem3.p1.3.3.m3.2.2.2.2.1.3.cmml" xref="S4.Thmtheorem3.p1.3.3.m3.2.2.2.2.1.3"><csymbol cd="ambiguous" id="S4.Thmtheorem3.p1.3.3.m3.2.2.2.2.1.3.1.cmml" xref="S4.Thmtheorem3.p1.3.3.m3.2.2.2.2.1.3">superscript</csymbol><ci id="S4.Thmtheorem3.p1.3.3.m3.2.2.2.2.1.3.2.cmml" xref="S4.Thmtheorem3.p1.3.3.m3.2.2.2.2.1.3.2">𝑔</ci><ci id="S4.Thmtheorem3.p1.3.3.m3.2.2.2.2.1.3.3.cmml" xref="S4.Thmtheorem3.p1.3.3.m3.2.2.2.2.1.3.3">′</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem3.p1.3.3.m3.3c">\tilde{\mathfrak{R}}_{n}(\mathcal{G}_{\ell,\mathcal{F}^{g^{\prime}}})</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem3.p1.3.3.m3.3d">over~ start_ARG fraktur_R end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ( caligraphic_G start_POSTSUBSCRIPT roman_ℓ , caligraphic_F start_POSTSUPERSCRIPT italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math>, the true population risk <math alttext="R_{\ell,\phi}(\mathscr{D}_{Y})" class="ltx_Math" display="inline" id="S4.Thmtheorem3.p1.4.4.m4.3"><semantics id="S4.Thmtheorem3.p1.4.4.m4.3a"><mrow id="S4.Thmtheorem3.p1.4.4.m4.3.3" xref="S4.Thmtheorem3.p1.4.4.m4.3.3.cmml"><msub id="S4.Thmtheorem3.p1.4.4.m4.3.3.3" xref="S4.Thmtheorem3.p1.4.4.m4.3.3.3.cmml"><mi id="S4.Thmtheorem3.p1.4.4.m4.3.3.3.2" xref="S4.Thmtheorem3.p1.4.4.m4.3.3.3.2.cmml">R</mi><mrow id="S4.Thmtheorem3.p1.4.4.m4.2.2.2.4" xref="S4.Thmtheorem3.p1.4.4.m4.2.2.2.3.cmml"><mi id="S4.Thmtheorem3.p1.4.4.m4.1.1.1.1" mathvariant="normal" xref="S4.Thmtheorem3.p1.4.4.m4.1.1.1.1.cmml">ℓ</mi><mo id="S4.Thmtheorem3.p1.4.4.m4.2.2.2.4.1" xref="S4.Thmtheorem3.p1.4.4.m4.2.2.2.3.cmml">,</mo><mi id="S4.Thmtheorem3.p1.4.4.m4.2.2.2.2" xref="S4.Thmtheorem3.p1.4.4.m4.2.2.2.2.cmml">ϕ</mi></mrow></msub><mo id="S4.Thmtheorem3.p1.4.4.m4.3.3.2" xref="S4.Thmtheorem3.p1.4.4.m4.3.3.2.cmml">⁢</mo><mrow id="S4.Thmtheorem3.p1.4.4.m4.3.3.1.1" xref="S4.Thmtheorem3.p1.4.4.m4.3.3.1.1.1.cmml"><mo id="S4.Thmtheorem3.p1.4.4.m4.3.3.1.1.2" stretchy="false" xref="S4.Thmtheorem3.p1.4.4.m4.3.3.1.1.1.cmml">(</mo><msub id="S4.Thmtheorem3.p1.4.4.m4.3.3.1.1.1" xref="S4.Thmtheorem3.p1.4.4.m4.3.3.1.1.1.cmml"><mi class="ltx_font_mathscript" id="S4.Thmtheorem3.p1.4.4.m4.3.3.1.1.1.2" xref="S4.Thmtheorem3.p1.4.4.m4.3.3.1.1.1.2.cmml">𝒟</mi><mi id="S4.Thmtheorem3.p1.4.4.m4.3.3.1.1.1.3" xref="S4.Thmtheorem3.p1.4.4.m4.3.3.1.1.1.3.cmml">Y</mi></msub><mo id="S4.Thmtheorem3.p1.4.4.m4.3.3.1.1.3" stretchy="false" xref="S4.Thmtheorem3.p1.4.4.m4.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem3.p1.4.4.m4.3b"><apply id="S4.Thmtheorem3.p1.4.4.m4.3.3.cmml" xref="S4.Thmtheorem3.p1.4.4.m4.3.3"><times id="S4.Thmtheorem3.p1.4.4.m4.3.3.2.cmml" xref="S4.Thmtheorem3.p1.4.4.m4.3.3.2"></times><apply id="S4.Thmtheorem3.p1.4.4.m4.3.3.3.cmml" xref="S4.Thmtheorem3.p1.4.4.m4.3.3.3"><csymbol cd="ambiguous" id="S4.Thmtheorem3.p1.4.4.m4.3.3.3.1.cmml" xref="S4.Thmtheorem3.p1.4.4.m4.3.3.3">subscript</csymbol><ci id="S4.Thmtheorem3.p1.4.4.m4.3.3.3.2.cmml" xref="S4.Thmtheorem3.p1.4.4.m4.3.3.3.2">𝑅</ci><list id="S4.Thmtheorem3.p1.4.4.m4.2.2.2.3.cmml" xref="S4.Thmtheorem3.p1.4.4.m4.2.2.2.4"><ci id="S4.Thmtheorem3.p1.4.4.m4.1.1.1.1.cmml" xref="S4.Thmtheorem3.p1.4.4.m4.1.1.1.1">ℓ</ci><ci id="S4.Thmtheorem3.p1.4.4.m4.2.2.2.2.cmml" xref="S4.Thmtheorem3.p1.4.4.m4.2.2.2.2">italic-ϕ</ci></list></apply><apply id="S4.Thmtheorem3.p1.4.4.m4.3.3.1.1.1.cmml" xref="S4.Thmtheorem3.p1.4.4.m4.3.3.1.1"><csymbol cd="ambiguous" id="S4.Thmtheorem3.p1.4.4.m4.3.3.1.1.1.1.cmml" xref="S4.Thmtheorem3.p1.4.4.m4.3.3.1.1">subscript</csymbol><ci id="S4.Thmtheorem3.p1.4.4.m4.3.3.1.1.1.2.cmml" xref="S4.Thmtheorem3.p1.4.4.m4.3.3.1.1.1.2">𝒟</ci><ci id="S4.Thmtheorem3.p1.4.4.m4.3.3.1.1.1.3.cmml" xref="S4.Thmtheorem3.p1.4.4.m4.3.3.1.1.1.3">𝑌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem3.p1.4.4.m4.3c">R_{\ell,\phi}(\mathscr{D}_{Y})</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem3.p1.4.4.m4.3d">italic_R start_POSTSUBSCRIPT roman_ℓ , italic_ϕ end_POSTSUBSCRIPT ( script_D start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT )</annotation></semantics></math> is bounded by the following with probability at least <math alttext="1-\delta" class="ltx_Math" display="inline" id="S4.Thmtheorem3.p1.5.5.m5.1"><semantics id="S4.Thmtheorem3.p1.5.5.m5.1a"><mrow id="S4.Thmtheorem3.p1.5.5.m5.1.1" xref="S4.Thmtheorem3.p1.5.5.m5.1.1.cmml"><mn id="S4.Thmtheorem3.p1.5.5.m5.1.1.2" xref="S4.Thmtheorem3.p1.5.5.m5.1.1.2.cmml">1</mn><mo id="S4.Thmtheorem3.p1.5.5.m5.1.1.1" xref="S4.Thmtheorem3.p1.5.5.m5.1.1.1.cmml">−</mo><mi id="S4.Thmtheorem3.p1.5.5.m5.1.1.3" xref="S4.Thmtheorem3.p1.5.5.m5.1.1.3.cmml">δ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem3.p1.5.5.m5.1b"><apply id="S4.Thmtheorem3.p1.5.5.m5.1.1.cmml" xref="S4.Thmtheorem3.p1.5.5.m5.1.1"><minus id="S4.Thmtheorem3.p1.5.5.m5.1.1.1.cmml" xref="S4.Thmtheorem3.p1.5.5.m5.1.1.1"></minus><cn id="S4.Thmtheorem3.p1.5.5.m5.1.1.2.cmml" type="integer" xref="S4.Thmtheorem3.p1.5.5.m5.1.1.2">1</cn><ci id="S4.Thmtheorem3.p1.5.5.m5.1.1.3.cmml" xref="S4.Thmtheorem3.p1.5.5.m5.1.1.3">𝛿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem3.p1.5.5.m5.1c">1-\delta</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem3.p1.5.5.m5.1d">1 - italic_δ</annotation></semantics></math>:</span></p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A2.EGx3">
<tbody id="S4.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle R_{\ell,\phi}(\mathscr{D}_{Y})" class="ltx_Math" display="inline" id="S4.E15.m1.3"><semantics id="S4.E15.m1.3a"><mrow id="S4.E15.m1.3.3" xref="S4.E15.m1.3.3.cmml"><msub id="S4.E15.m1.3.3.3" xref="S4.E15.m1.3.3.3.cmml"><mi id="S4.E15.m1.3.3.3.2" xref="S4.E15.m1.3.3.3.2.cmml">R</mi><mrow id="S4.E15.m1.2.2.2.4" xref="S4.E15.m1.2.2.2.3.cmml"><mi id="S4.E15.m1.1.1.1.1" mathvariant="normal" xref="S4.E15.m1.1.1.1.1.cmml">ℓ</mi><mo id="S4.E15.m1.2.2.2.4.1" xref="S4.E15.m1.2.2.2.3.cmml">,</mo><mi id="S4.E15.m1.2.2.2.2" xref="S4.E15.m1.2.2.2.2.cmml">ϕ</mi></mrow></msub><mo id="S4.E15.m1.3.3.2" xref="S4.E15.m1.3.3.2.cmml">⁢</mo><mrow id="S4.E15.m1.3.3.1.1" xref="S4.E15.m1.3.3.1.1.1.cmml"><mo id="S4.E15.m1.3.3.1.1.2" stretchy="false" xref="S4.E15.m1.3.3.1.1.1.cmml">(</mo><msub id="S4.E15.m1.3.3.1.1.1" xref="S4.E15.m1.3.3.1.1.1.cmml"><mi class="ltx_font_mathscript" id="S4.E15.m1.3.3.1.1.1.2" xref="S4.E15.m1.3.3.1.1.1.2.cmml">𝒟</mi><mi id="S4.E15.m1.3.3.1.1.1.3" xref="S4.E15.m1.3.3.1.1.1.3.cmml">Y</mi></msub><mo id="S4.E15.m1.3.3.1.1.3" stretchy="false" xref="S4.E15.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E15.m1.3b"><apply id="S4.E15.m1.3.3.cmml" xref="S4.E15.m1.3.3"><times id="S4.E15.m1.3.3.2.cmml" xref="S4.E15.m1.3.3.2"></times><apply id="S4.E15.m1.3.3.3.cmml" xref="S4.E15.m1.3.3.3"><csymbol cd="ambiguous" id="S4.E15.m1.3.3.3.1.cmml" xref="S4.E15.m1.3.3.3">subscript</csymbol><ci id="S4.E15.m1.3.3.3.2.cmml" xref="S4.E15.m1.3.3.3.2">𝑅</ci><list id="S4.E15.m1.2.2.2.3.cmml" xref="S4.E15.m1.2.2.2.4"><ci id="S4.E15.m1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1">ℓ</ci><ci id="S4.E15.m1.2.2.2.2.cmml" xref="S4.E15.m1.2.2.2.2">italic-ϕ</ci></list></apply><apply id="S4.E15.m1.3.3.1.1.1.cmml" xref="S4.E15.m1.3.3.1.1"><csymbol cd="ambiguous" id="S4.E15.m1.3.3.1.1.1.1.cmml" xref="S4.E15.m1.3.3.1.1">subscript</csymbol><ci id="S4.E15.m1.3.3.1.1.1.2.cmml" xref="S4.E15.m1.3.3.1.1.1.2">𝒟</ci><ci id="S4.E15.m1.3.3.1.1.1.3.cmml" xref="S4.E15.m1.3.3.1.1.1.3">𝑌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E15.m1.3c">\displaystyle R_{\ell,\phi}(\mathscr{D}_{Y})</annotation><annotation encoding="application/x-llamapun" id="S4.E15.m1.3d">italic_R start_POSTSUBSCRIPT roman_ℓ , italic_ϕ end_POSTSUBSCRIPT ( script_D start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\leq T_{1}+T_{2}+T_{3}" class="ltx_Math" display="inline" id="S4.E15.m2.1"><semantics id="S4.E15.m2.1a"><mrow id="S4.E15.m2.1.1" xref="S4.E15.m2.1.1.cmml"><mi id="S4.E15.m2.1.1.2" xref="S4.E15.m2.1.1.2.cmml"></mi><mo id="S4.E15.m2.1.1.1" xref="S4.E15.m2.1.1.1.cmml">≤</mo><mrow id="S4.E15.m2.1.1.3" xref="S4.E15.m2.1.1.3.cmml"><msub id="S4.E15.m2.1.1.3.2" xref="S4.E15.m2.1.1.3.2.cmml"><mi id="S4.E15.m2.1.1.3.2.2" xref="S4.E15.m2.1.1.3.2.2.cmml">T</mi><mn id="S4.E15.m2.1.1.3.2.3" xref="S4.E15.m2.1.1.3.2.3.cmml">1</mn></msub><mo id="S4.E15.m2.1.1.3.1" xref="S4.E15.m2.1.1.3.1.cmml">+</mo><msub id="S4.E15.m2.1.1.3.3" xref="S4.E15.m2.1.1.3.3.cmml"><mi id="S4.E15.m2.1.1.3.3.2" xref="S4.E15.m2.1.1.3.3.2.cmml">T</mi><mn id="S4.E15.m2.1.1.3.3.3" xref="S4.E15.m2.1.1.3.3.3.cmml">2</mn></msub><mo id="S4.E15.m2.1.1.3.1a" xref="S4.E15.m2.1.1.3.1.cmml">+</mo><msub id="S4.E15.m2.1.1.3.4" xref="S4.E15.m2.1.1.3.4.cmml"><mi id="S4.E15.m2.1.1.3.4.2" xref="S4.E15.m2.1.1.3.4.2.cmml">T</mi><mn id="S4.E15.m2.1.1.3.4.3" xref="S4.E15.m2.1.1.3.4.3.cmml">3</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E15.m2.1b"><apply id="S4.E15.m2.1.1.cmml" xref="S4.E15.m2.1.1"><leq id="S4.E15.m2.1.1.1.cmml" xref="S4.E15.m2.1.1.1"></leq><csymbol cd="latexml" id="S4.E15.m2.1.1.2.cmml" xref="S4.E15.m2.1.1.2">absent</csymbol><apply id="S4.E15.m2.1.1.3.cmml" xref="S4.E15.m2.1.1.3"><plus id="S4.E15.m2.1.1.3.1.cmml" xref="S4.E15.m2.1.1.3.1"></plus><apply id="S4.E15.m2.1.1.3.2.cmml" xref="S4.E15.m2.1.1.3.2"><csymbol cd="ambiguous" id="S4.E15.m2.1.1.3.2.1.cmml" xref="S4.E15.m2.1.1.3.2">subscript</csymbol><ci id="S4.E15.m2.1.1.3.2.2.cmml" xref="S4.E15.m2.1.1.3.2.2">𝑇</ci><cn id="S4.E15.m2.1.1.3.2.3.cmml" type="integer" xref="S4.E15.m2.1.1.3.2.3">1</cn></apply><apply id="S4.E15.m2.1.1.3.3.cmml" xref="S4.E15.m2.1.1.3.3"><csymbol cd="ambiguous" id="S4.E15.m2.1.1.3.3.1.cmml" xref="S4.E15.m2.1.1.3.3">subscript</csymbol><ci id="S4.E15.m2.1.1.3.3.2.cmml" xref="S4.E15.m2.1.1.3.3.2">𝑇</ci><cn id="S4.E15.m2.1.1.3.3.3.cmml" type="integer" xref="S4.E15.m2.1.1.3.3.3">2</cn></apply><apply id="S4.E15.m2.1.1.3.4.cmml" xref="S4.E15.m2.1.1.3.4"><csymbol cd="ambiguous" id="S4.E15.m2.1.1.3.4.1.cmml" xref="S4.E15.m2.1.1.3.4">subscript</csymbol><ci id="S4.E15.m2.1.1.3.4.2.cmml" xref="S4.E15.m2.1.1.3.4.2">𝑇</ci><cn id="S4.E15.m2.1.1.3.4.3.cmml" type="integer" xref="S4.E15.m2.1.1.3.4.3">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E15.m2.1c">\displaystyle\leq T_{1}+T_{2}+T_{3}</annotation><annotation encoding="application/x-llamapun" id="S4.E15.m2.1d">≤ italic_T start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_T start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + italic_T start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
<tbody id="S4.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle T_{1}" class="ltx_Math" display="inline" id="S4.Ex2.m1.1"><semantics id="S4.Ex2.m1.1a"><msub id="S4.Ex2.m1.1.1" xref="S4.Ex2.m1.1.1.cmml"><mi id="S4.Ex2.m1.1.1.2" xref="S4.Ex2.m1.1.1.2.cmml">T</mi><mn id="S4.Ex2.m1.1.1.3" xref="S4.Ex2.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.Ex2.m1.1b"><apply id="S4.Ex2.m1.1.1.cmml" xref="S4.Ex2.m1.1.1"><csymbol cd="ambiguous" id="S4.Ex2.m1.1.1.1.cmml" xref="S4.Ex2.m1.1.1">subscript</csymbol><ci id="S4.Ex2.m1.1.1.2.cmml" xref="S4.Ex2.m1.1.1.2">𝑇</ci><cn id="S4.Ex2.m1.1.1.3.cmml" type="integer" xref="S4.Ex2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex2.m1.1c">\displaystyle T_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.Ex2.m1.1d">italic_T start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=R_{\ell,\tilde{\phi}_{n}}(\tilde{\mathscr{S}}_{n})" class="ltx_Math" display="inline" id="S4.Ex2.m2.3"><semantics id="S4.Ex2.m2.3a"><mrow id="S4.Ex2.m2.3.3" xref="S4.Ex2.m2.3.3.cmml"><mi id="S4.Ex2.m2.3.3.3" xref="S4.Ex2.m2.3.3.3.cmml"></mi><mo id="S4.Ex2.m2.3.3.2" xref="S4.Ex2.m2.3.3.2.cmml">=</mo><mrow id="S4.Ex2.m2.3.3.1" xref="S4.Ex2.m2.3.3.1.cmml"><msub id="S4.Ex2.m2.3.3.1.3" xref="S4.Ex2.m2.3.3.1.3.cmml"><mi id="S4.Ex2.m2.3.3.1.3.2" xref="S4.Ex2.m2.3.3.1.3.2.cmml">R</mi><mrow id="S4.Ex2.m2.2.2.2.2" xref="S4.Ex2.m2.2.2.2.3.cmml"><mi id="S4.Ex2.m2.1.1.1.1" mathvariant="normal" xref="S4.Ex2.m2.1.1.1.1.cmml">ℓ</mi><mo id="S4.Ex2.m2.2.2.2.2.2" xref="S4.Ex2.m2.2.2.2.3.cmml">,</mo><msub id="S4.Ex2.m2.2.2.2.2.1" xref="S4.Ex2.m2.2.2.2.2.1.cmml"><mover accent="true" id="S4.Ex2.m2.2.2.2.2.1.2" xref="S4.Ex2.m2.2.2.2.2.1.2.cmml"><mi id="S4.Ex2.m2.2.2.2.2.1.2.2" xref="S4.Ex2.m2.2.2.2.2.1.2.2.cmml">ϕ</mi><mo id="S4.Ex2.m2.2.2.2.2.1.2.1" xref="S4.Ex2.m2.2.2.2.2.1.2.1.cmml">~</mo></mover><mi id="S4.Ex2.m2.2.2.2.2.1.3" xref="S4.Ex2.m2.2.2.2.2.1.3.cmml">n</mi></msub></mrow></msub><mo id="S4.Ex2.m2.3.3.1.2" xref="S4.Ex2.m2.3.3.1.2.cmml">⁢</mo><mrow id="S4.Ex2.m2.3.3.1.1.1" xref="S4.Ex2.m2.3.3.1.1.1.1.cmml"><mo id="S4.Ex2.m2.3.3.1.1.1.2" stretchy="false" xref="S4.Ex2.m2.3.3.1.1.1.1.cmml">(</mo><msub id="S4.Ex2.m2.3.3.1.1.1.1" xref="S4.Ex2.m2.3.3.1.1.1.1.cmml"><mover accent="true" id="S4.Ex2.m2.3.3.1.1.1.1.2" xref="S4.Ex2.m2.3.3.1.1.1.1.2.cmml"><mi class="ltx_font_mathscript" id="S4.Ex2.m2.3.3.1.1.1.1.2.2" xref="S4.Ex2.m2.3.3.1.1.1.1.2.2.cmml">𝒮</mi><mo id="S4.Ex2.m2.3.3.1.1.1.1.2.1" xref="S4.Ex2.m2.3.3.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S4.Ex2.m2.3.3.1.1.1.1.3" xref="S4.Ex2.m2.3.3.1.1.1.1.3.cmml">n</mi></msub><mo id="S4.Ex2.m2.3.3.1.1.1.3" stretchy="false" xref="S4.Ex2.m2.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex2.m2.3b"><apply id="S4.Ex2.m2.3.3.cmml" xref="S4.Ex2.m2.3.3"><eq id="S4.Ex2.m2.3.3.2.cmml" xref="S4.Ex2.m2.3.3.2"></eq><csymbol cd="latexml" id="S4.Ex2.m2.3.3.3.cmml" xref="S4.Ex2.m2.3.3.3">absent</csymbol><apply id="S4.Ex2.m2.3.3.1.cmml" xref="S4.Ex2.m2.3.3.1"><times id="S4.Ex2.m2.3.3.1.2.cmml" xref="S4.Ex2.m2.3.3.1.2"></times><apply id="S4.Ex2.m2.3.3.1.3.cmml" xref="S4.Ex2.m2.3.3.1.3"><csymbol cd="ambiguous" id="S4.Ex2.m2.3.3.1.3.1.cmml" xref="S4.Ex2.m2.3.3.1.3">subscript</csymbol><ci id="S4.Ex2.m2.3.3.1.3.2.cmml" xref="S4.Ex2.m2.3.3.1.3.2">𝑅</ci><list id="S4.Ex2.m2.2.2.2.3.cmml" xref="S4.Ex2.m2.2.2.2.2"><ci id="S4.Ex2.m2.1.1.1.1.cmml" xref="S4.Ex2.m2.1.1.1.1">ℓ</ci><apply id="S4.Ex2.m2.2.2.2.2.1.cmml" xref="S4.Ex2.m2.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.Ex2.m2.2.2.2.2.1.1.cmml" xref="S4.Ex2.m2.2.2.2.2.1">subscript</csymbol><apply id="S4.Ex2.m2.2.2.2.2.1.2.cmml" xref="S4.Ex2.m2.2.2.2.2.1.2"><ci id="S4.Ex2.m2.2.2.2.2.1.2.1.cmml" xref="S4.Ex2.m2.2.2.2.2.1.2.1">~</ci><ci id="S4.Ex2.m2.2.2.2.2.1.2.2.cmml" xref="S4.Ex2.m2.2.2.2.2.1.2.2">italic-ϕ</ci></apply><ci id="S4.Ex2.m2.2.2.2.2.1.3.cmml" xref="S4.Ex2.m2.2.2.2.2.1.3">𝑛</ci></apply></list></apply><apply id="S4.Ex2.m2.3.3.1.1.1.1.cmml" xref="S4.Ex2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.Ex2.m2.3.3.1.1.1.1.1.cmml" xref="S4.Ex2.m2.3.3.1.1.1">subscript</csymbol><apply id="S4.Ex2.m2.3.3.1.1.1.1.2.cmml" xref="S4.Ex2.m2.3.3.1.1.1.1.2"><ci id="S4.Ex2.m2.3.3.1.1.1.1.2.1.cmml" xref="S4.Ex2.m2.3.3.1.1.1.1.2.1">~</ci><ci id="S4.Ex2.m2.3.3.1.1.1.1.2.2.cmml" xref="S4.Ex2.m2.3.3.1.1.1.1.2.2">𝒮</ci></apply><ci id="S4.Ex2.m2.3.3.1.1.1.1.3.cmml" xref="S4.Ex2.m2.3.3.1.1.1.1.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex2.m2.3c">\displaystyle=R_{\ell,\tilde{\phi}_{n}}(\tilde{\mathscr{S}}_{n})</annotation><annotation encoding="application/x-llamapun" id="S4.Ex2.m2.3d">= italic_R start_POSTSUBSCRIPT roman_ℓ , over~ start_ARG italic_ϕ end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( over~ start_ARG script_S end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle T_{2}" class="ltx_Math" display="inline" id="S4.Ex3.m1.1"><semantics id="S4.Ex3.m1.1a"><msub id="S4.Ex3.m1.1.1" xref="S4.Ex3.m1.1.1.cmml"><mi id="S4.Ex3.m1.1.1.2" xref="S4.Ex3.m1.1.1.2.cmml">T</mi><mn id="S4.Ex3.m1.1.1.3" xref="S4.Ex3.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.Ex3.m1.1b"><apply id="S4.Ex3.m1.1.1.cmml" xref="S4.Ex3.m1.1.1"><csymbol cd="ambiguous" id="S4.Ex3.m1.1.1.1.cmml" xref="S4.Ex3.m1.1.1">subscript</csymbol><ci id="S4.Ex3.m1.1.1.2.cmml" xref="S4.Ex3.m1.1.1.2">𝑇</ci><cn id="S4.Ex3.m1.1.1.3.cmml" type="integer" xref="S4.Ex3.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex3.m1.1c">\displaystyle T_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.Ex3.m1.1d">italic_T start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle={\mathcal{W}(\mathscr{D}_{Y},\tilde{\mathscr{D}}_{Y})}\ {\leq L%
\|u\|}" class="ltx_Math" display="inline" id="S4.Ex3.m2.3"><semantics id="S4.Ex3.m2.3a"><mrow id="S4.Ex3.m2.3.3" xref="S4.Ex3.m2.3.3.cmml"><mi id="S4.Ex3.m2.3.3.4" xref="S4.Ex3.m2.3.3.4.cmml"></mi><mo id="S4.Ex3.m2.3.3.5" xref="S4.Ex3.m2.3.3.5.cmml">=</mo><mrow id="S4.Ex3.m2.3.3.2" xref="S4.Ex3.m2.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex3.m2.3.3.2.4" xref="S4.Ex3.m2.3.3.2.4.cmml">𝒲</mi><mo id="S4.Ex3.m2.3.3.2.3" xref="S4.Ex3.m2.3.3.2.3.cmml">⁢</mo><mrow id="S4.Ex3.m2.3.3.2.2.2" xref="S4.Ex3.m2.3.3.2.2.3.cmml"><mo id="S4.Ex3.m2.3.3.2.2.2.3" stretchy="false" xref="S4.Ex3.m2.3.3.2.2.3.cmml">(</mo><msub id="S4.Ex3.m2.2.2.1.1.1.1" xref="S4.Ex3.m2.2.2.1.1.1.1.cmml"><mi class="ltx_font_mathscript" id="S4.Ex3.m2.2.2.1.1.1.1.2" xref="S4.Ex3.m2.2.2.1.1.1.1.2.cmml">𝒟</mi><mi id="S4.Ex3.m2.2.2.1.1.1.1.3" xref="S4.Ex3.m2.2.2.1.1.1.1.3.cmml">Y</mi></msub><mo id="S4.Ex3.m2.3.3.2.2.2.4" xref="S4.Ex3.m2.3.3.2.2.3.cmml">,</mo><msub id="S4.Ex3.m2.3.3.2.2.2.2" xref="S4.Ex3.m2.3.3.2.2.2.2.cmml"><mover accent="true" id="S4.Ex3.m2.3.3.2.2.2.2.2" xref="S4.Ex3.m2.3.3.2.2.2.2.2.cmml"><mi class="ltx_font_mathscript" id="S4.Ex3.m2.3.3.2.2.2.2.2.2" xref="S4.Ex3.m2.3.3.2.2.2.2.2.2.cmml">𝒟</mi><mo id="S4.Ex3.m2.3.3.2.2.2.2.2.1" xref="S4.Ex3.m2.3.3.2.2.2.2.2.1.cmml">~</mo></mover><mi id="S4.Ex3.m2.3.3.2.2.2.2.3" xref="S4.Ex3.m2.3.3.2.2.2.2.3.cmml">Y</mi></msub><mo id="S4.Ex3.m2.3.3.2.2.2.5" rspace="0.500em" stretchy="false" xref="S4.Ex3.m2.3.3.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.Ex3.m2.3.3.6" xref="S4.Ex3.m2.3.3.6.cmml">≤</mo><mrow id="S4.Ex3.m2.3.3.7" xref="S4.Ex3.m2.3.3.7.cmml"><mi id="S4.Ex3.m2.3.3.7.2" xref="S4.Ex3.m2.3.3.7.2.cmml">L</mi><mo id="S4.Ex3.m2.3.3.7.1" xref="S4.Ex3.m2.3.3.7.1.cmml">⁢</mo><mrow id="S4.Ex3.m2.3.3.7.3.2" xref="S4.Ex3.m2.3.3.7.3.1.cmml"><mo id="S4.Ex3.m2.3.3.7.3.2.1" stretchy="false" xref="S4.Ex3.m2.3.3.7.3.1.1.cmml">‖</mo><mi id="S4.Ex3.m2.1.1" xref="S4.Ex3.m2.1.1.cmml">u</mi><mo id="S4.Ex3.m2.3.3.7.3.2.2" stretchy="false" xref="S4.Ex3.m2.3.3.7.3.1.1.cmml">‖</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex3.m2.3b"><apply id="S4.Ex3.m2.3.3.cmml" xref="S4.Ex3.m2.3.3"><and id="S4.Ex3.m2.3.3a.cmml" xref="S4.Ex3.m2.3.3"></and><apply id="S4.Ex3.m2.3.3b.cmml" xref="S4.Ex3.m2.3.3"><eq id="S4.Ex3.m2.3.3.5.cmml" xref="S4.Ex3.m2.3.3.5"></eq><csymbol cd="latexml" id="S4.Ex3.m2.3.3.4.cmml" xref="S4.Ex3.m2.3.3.4">absent</csymbol><apply id="S4.Ex3.m2.3.3.2.cmml" xref="S4.Ex3.m2.3.3.2"><times id="S4.Ex3.m2.3.3.2.3.cmml" xref="S4.Ex3.m2.3.3.2.3"></times><ci id="S4.Ex3.m2.3.3.2.4.cmml" xref="S4.Ex3.m2.3.3.2.4">𝒲</ci><interval closure="open" id="S4.Ex3.m2.3.3.2.2.3.cmml" xref="S4.Ex3.m2.3.3.2.2.2"><apply id="S4.Ex3.m2.2.2.1.1.1.1.cmml" xref="S4.Ex3.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex3.m2.2.2.1.1.1.1.1.cmml" xref="S4.Ex3.m2.2.2.1.1.1.1">subscript</csymbol><ci id="S4.Ex3.m2.2.2.1.1.1.1.2.cmml" xref="S4.Ex3.m2.2.2.1.1.1.1.2">𝒟</ci><ci id="S4.Ex3.m2.2.2.1.1.1.1.3.cmml" xref="S4.Ex3.m2.2.2.1.1.1.1.3">𝑌</ci></apply><apply id="S4.Ex3.m2.3.3.2.2.2.2.cmml" xref="S4.Ex3.m2.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex3.m2.3.3.2.2.2.2.1.cmml" xref="S4.Ex3.m2.3.3.2.2.2.2">subscript</csymbol><apply id="S4.Ex3.m2.3.3.2.2.2.2.2.cmml" xref="S4.Ex3.m2.3.3.2.2.2.2.2"><ci id="S4.Ex3.m2.3.3.2.2.2.2.2.1.cmml" xref="S4.Ex3.m2.3.3.2.2.2.2.2.1">~</ci><ci id="S4.Ex3.m2.3.3.2.2.2.2.2.2.cmml" xref="S4.Ex3.m2.3.3.2.2.2.2.2.2">𝒟</ci></apply><ci id="S4.Ex3.m2.3.3.2.2.2.2.3.cmml" xref="S4.Ex3.m2.3.3.2.2.2.2.3">𝑌</ci></apply></interval></apply></apply><apply id="S4.Ex3.m2.3.3c.cmml" xref="S4.Ex3.m2.3.3"><leq id="S4.Ex3.m2.3.3.6.cmml" xref="S4.Ex3.m2.3.3.6"></leq><share href="https://arxiv.org/html/2409.01890v1#S4.Ex3.m2.3.3.2.cmml" id="S4.Ex3.m2.3.3d.cmml" xref="S4.Ex3.m2.3.3"></share><apply id="S4.Ex3.m2.3.3.7.cmml" xref="S4.Ex3.m2.3.3.7"><times id="S4.Ex3.m2.3.3.7.1.cmml" xref="S4.Ex3.m2.3.3.7.1"></times><ci id="S4.Ex3.m2.3.3.7.2.cmml" xref="S4.Ex3.m2.3.3.7.2">𝐿</ci><apply id="S4.Ex3.m2.3.3.7.3.1.cmml" xref="S4.Ex3.m2.3.3.7.3.2"><csymbol cd="latexml" id="S4.Ex3.m2.3.3.7.3.1.1.cmml" xref="S4.Ex3.m2.3.3.7.3.2.1">norm</csymbol><ci id="S4.Ex3.m2.1.1.cmml" xref="S4.Ex3.m2.1.1">𝑢</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex3.m2.3c">\displaystyle={\mathcal{W}(\mathscr{D}_{Y},\tilde{\mathscr{D}}_{Y})}\ {\leq L%
\|u\|}</annotation><annotation encoding="application/x-llamapun" id="S4.Ex3.m2.3d">= caligraphic_W ( script_D start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT , over~ start_ARG script_D end_ARG start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT ) ≤ italic_L ∥ italic_u ∥</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle T_{3}" class="ltx_Math" display="inline" id="S4.Ex4.m1.1"><semantics id="S4.Ex4.m1.1a"><msub id="S4.Ex4.m1.1.1" xref="S4.Ex4.m1.1.1.cmml"><mi id="S4.Ex4.m1.1.1.2" xref="S4.Ex4.m1.1.1.2.cmml">T</mi><mn id="S4.Ex4.m1.1.1.3" xref="S4.Ex4.m1.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S4.Ex4.m1.1b"><apply id="S4.Ex4.m1.1.1.cmml" xref="S4.Ex4.m1.1.1"><csymbol cd="ambiguous" id="S4.Ex4.m1.1.1.1.cmml" xref="S4.Ex4.m1.1.1">subscript</csymbol><ci id="S4.Ex4.m1.1.1.2.cmml" xref="S4.Ex4.m1.1.1.2">𝑇</ci><cn id="S4.Ex4.m1.1.1.3.cmml" type="integer" xref="S4.Ex4.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex4.m1.1c">\displaystyle T_{3}</annotation><annotation encoding="application/x-llamapun" id="S4.Ex4.m1.1d">italic_T start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\tilde{\mathfrak{R}}_{n}(\mathcal{G}_{\ell,\mathcal{F}^{g^{%
\prime}}})+\mathcal{O}\Big{(}\sqrt{{\frac{\log(1/\delta)}{n}}}\Big{)}" class="ltx_Math" display="inline" id="S4.Ex4.m2.5"><semantics id="S4.Ex4.m2.5a"><mrow id="S4.Ex4.m2.5.5" xref="S4.Ex4.m2.5.5.cmml"><mi id="S4.Ex4.m2.5.5.3" xref="S4.Ex4.m2.5.5.3.cmml"></mi><mo id="S4.Ex4.m2.5.5.2" xref="S4.Ex4.m2.5.5.2.cmml">=</mo><mrow id="S4.Ex4.m2.5.5.1" xref="S4.Ex4.m2.5.5.1.cmml"><mrow id="S4.Ex4.m2.5.5.1.1" xref="S4.Ex4.m2.5.5.1.1.cmml"><msub id="S4.Ex4.m2.5.5.1.1.3" xref="S4.Ex4.m2.5.5.1.1.3.cmml"><mover accent="true" id="S4.Ex4.m2.5.5.1.1.3.2" xref="S4.Ex4.m2.5.5.1.1.3.2.cmml"><mi id="S4.Ex4.m2.5.5.1.1.3.2.2" xref="S4.Ex4.m2.5.5.1.1.3.2.2.cmml">ℜ</mi><mo id="S4.Ex4.m2.5.5.1.1.3.2.1" xref="S4.Ex4.m2.5.5.1.1.3.2.1.cmml">~</mo></mover><mi id="S4.Ex4.m2.5.5.1.1.3.3" xref="S4.Ex4.m2.5.5.1.1.3.3.cmml">n</mi></msub><mo id="S4.Ex4.m2.5.5.1.1.2" xref="S4.Ex4.m2.5.5.1.1.2.cmml">⁢</mo><mrow id="S4.Ex4.m2.5.5.1.1.1.1" xref="S4.Ex4.m2.5.5.1.1.1.1.1.cmml"><mo id="S4.Ex4.m2.5.5.1.1.1.1.2" stretchy="false" xref="S4.Ex4.m2.5.5.1.1.1.1.1.cmml">(</mo><msub id="S4.Ex4.m2.5.5.1.1.1.1.1" xref="S4.Ex4.m2.5.5.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex4.m2.5.5.1.1.1.1.1.2" xref="S4.Ex4.m2.5.5.1.1.1.1.1.2.cmml">𝒢</mi><mrow id="S4.Ex4.m2.2.2.2.2" xref="S4.Ex4.m2.2.2.2.3.cmml"><mi id="S4.Ex4.m2.1.1.1.1" mathvariant="normal" xref="S4.Ex4.m2.1.1.1.1.cmml">ℓ</mi><mo id="S4.Ex4.m2.2.2.2.2.2" xref="S4.Ex4.m2.2.2.2.3.cmml">,</mo><msup id="S4.Ex4.m2.2.2.2.2.1" xref="S4.Ex4.m2.2.2.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex4.m2.2.2.2.2.1.2" xref="S4.Ex4.m2.2.2.2.2.1.2.cmml">ℱ</mi><msup id="S4.Ex4.m2.2.2.2.2.1.3" xref="S4.Ex4.m2.2.2.2.2.1.3.cmml"><mi id="S4.Ex4.m2.2.2.2.2.1.3.2" xref="S4.Ex4.m2.2.2.2.2.1.3.2.cmml">g</mi><mo id="S4.Ex4.m2.2.2.2.2.1.3.3" xref="S4.Ex4.m2.2.2.2.2.1.3.3.cmml">′</mo></msup></msup></mrow></msub><mo id="S4.Ex4.m2.5.5.1.1.1.1.3" stretchy="false" xref="S4.Ex4.m2.5.5.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex4.m2.5.5.1.2" xref="S4.Ex4.m2.5.5.1.2.cmml">+</mo><mrow id="S4.Ex4.m2.5.5.1.3" xref="S4.Ex4.m2.5.5.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex4.m2.5.5.1.3.2" xref="S4.Ex4.m2.5.5.1.3.2.cmml">𝒪</mi><mo id="S4.Ex4.m2.5.5.1.3.1" xref="S4.Ex4.m2.5.5.1.3.1.cmml">⁢</mo><mrow id="S4.Ex4.m2.5.5.1.3.3.2" xref="S4.Ex4.m2.4.4.cmml"><mo id="S4.Ex4.m2.5.5.1.3.3.2.1" maxsize="160%" minsize="160%" xref="S4.Ex4.m2.4.4.cmml">(</mo><msqrt id="S4.Ex4.m2.4.4" xref="S4.Ex4.m2.4.4.cmml"><mstyle displaystyle="true" id="S4.Ex4.m2.4.4.2" xref="S4.Ex4.m2.4.4.2.cmml"><mfrac id="S4.Ex4.m2.4.4.2a" xref="S4.Ex4.m2.4.4.2.cmml"><mrow id="S4.Ex4.m2.4.4.2.2.2.2" xref="S4.Ex4.m2.4.4.2.2.2.3.cmml"><mi id="S4.Ex4.m2.3.3.1.1.1.1" xref="S4.Ex4.m2.3.3.1.1.1.1.cmml">log</mi><mo id="S4.Ex4.m2.4.4.2.2.2.2a" xref="S4.Ex4.m2.4.4.2.2.2.3.cmml">⁡</mo><mrow id="S4.Ex4.m2.4.4.2.2.2.2.1" xref="S4.Ex4.m2.4.4.2.2.2.3.cmml"><mo id="S4.Ex4.m2.4.4.2.2.2.2.1.2" stretchy="false" xref="S4.Ex4.m2.4.4.2.2.2.3.cmml">(</mo><mrow id="S4.Ex4.m2.4.4.2.2.2.2.1.1" xref="S4.Ex4.m2.4.4.2.2.2.2.1.1.cmml"><mn id="S4.Ex4.m2.4.4.2.2.2.2.1.1.2" xref="S4.Ex4.m2.4.4.2.2.2.2.1.1.2.cmml">1</mn><mo id="S4.Ex4.m2.4.4.2.2.2.2.1.1.1" xref="S4.Ex4.m2.4.4.2.2.2.2.1.1.1.cmml">/</mo><mi id="S4.Ex4.m2.4.4.2.2.2.2.1.1.3" xref="S4.Ex4.m2.4.4.2.2.2.2.1.1.3.cmml">δ</mi></mrow><mo id="S4.Ex4.m2.4.4.2.2.2.2.1.3" stretchy="false" xref="S4.Ex4.m2.4.4.2.2.2.3.cmml">)</mo></mrow></mrow><mi id="S4.Ex4.m2.4.4.2.4" xref="S4.Ex4.m2.4.4.2.4.cmml">n</mi></mfrac></mstyle></msqrt><mo id="S4.Ex4.m2.5.5.1.3.3.2.2" maxsize="160%" minsize="160%" xref="S4.Ex4.m2.4.4.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex4.m2.5b"><apply id="S4.Ex4.m2.5.5.cmml" xref="S4.Ex4.m2.5.5"><eq id="S4.Ex4.m2.5.5.2.cmml" xref="S4.Ex4.m2.5.5.2"></eq><csymbol cd="latexml" id="S4.Ex4.m2.5.5.3.cmml" xref="S4.Ex4.m2.5.5.3">absent</csymbol><apply id="S4.Ex4.m2.5.5.1.cmml" xref="S4.Ex4.m2.5.5.1"><plus id="S4.Ex4.m2.5.5.1.2.cmml" xref="S4.Ex4.m2.5.5.1.2"></plus><apply id="S4.Ex4.m2.5.5.1.1.cmml" xref="S4.Ex4.m2.5.5.1.1"><times id="S4.Ex4.m2.5.5.1.1.2.cmml" xref="S4.Ex4.m2.5.5.1.1.2"></times><apply id="S4.Ex4.m2.5.5.1.1.3.cmml" xref="S4.Ex4.m2.5.5.1.1.3"><csymbol cd="ambiguous" id="S4.Ex4.m2.5.5.1.1.3.1.cmml" xref="S4.Ex4.m2.5.5.1.1.3">subscript</csymbol><apply id="S4.Ex4.m2.5.5.1.1.3.2.cmml" xref="S4.Ex4.m2.5.5.1.1.3.2"><ci id="S4.Ex4.m2.5.5.1.1.3.2.1.cmml" xref="S4.Ex4.m2.5.5.1.1.3.2.1">~</ci><ci id="S4.Ex4.m2.5.5.1.1.3.2.2.cmml" xref="S4.Ex4.m2.5.5.1.1.3.2.2">ℜ</ci></apply><ci id="S4.Ex4.m2.5.5.1.1.3.3.cmml" xref="S4.Ex4.m2.5.5.1.1.3.3">𝑛</ci></apply><apply id="S4.Ex4.m2.5.5.1.1.1.1.1.cmml" xref="S4.Ex4.m2.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex4.m2.5.5.1.1.1.1.1.1.cmml" xref="S4.Ex4.m2.5.5.1.1.1.1">subscript</csymbol><ci id="S4.Ex4.m2.5.5.1.1.1.1.1.2.cmml" xref="S4.Ex4.m2.5.5.1.1.1.1.1.2">𝒢</ci><list id="S4.Ex4.m2.2.2.2.3.cmml" xref="S4.Ex4.m2.2.2.2.2"><ci id="S4.Ex4.m2.1.1.1.1.cmml" xref="S4.Ex4.m2.1.1.1.1">ℓ</ci><apply id="S4.Ex4.m2.2.2.2.2.1.cmml" xref="S4.Ex4.m2.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.Ex4.m2.2.2.2.2.1.1.cmml" xref="S4.Ex4.m2.2.2.2.2.1">superscript</csymbol><ci id="S4.Ex4.m2.2.2.2.2.1.2.cmml" xref="S4.Ex4.m2.2.2.2.2.1.2">ℱ</ci><apply id="S4.Ex4.m2.2.2.2.2.1.3.cmml" xref="S4.Ex4.m2.2.2.2.2.1.3"><csymbol cd="ambiguous" id="S4.Ex4.m2.2.2.2.2.1.3.1.cmml" xref="S4.Ex4.m2.2.2.2.2.1.3">superscript</csymbol><ci id="S4.Ex4.m2.2.2.2.2.1.3.2.cmml" xref="S4.Ex4.m2.2.2.2.2.1.3.2">𝑔</ci><ci id="S4.Ex4.m2.2.2.2.2.1.3.3.cmml" xref="S4.Ex4.m2.2.2.2.2.1.3.3">′</ci></apply></apply></list></apply></apply><apply id="S4.Ex4.m2.5.5.1.3.cmml" xref="S4.Ex4.m2.5.5.1.3"><times id="S4.Ex4.m2.5.5.1.3.1.cmml" xref="S4.Ex4.m2.5.5.1.3.1"></times><ci id="S4.Ex4.m2.5.5.1.3.2.cmml" xref="S4.Ex4.m2.5.5.1.3.2">𝒪</ci><apply id="S4.Ex4.m2.4.4.cmml" xref="S4.Ex4.m2.5.5.1.3.3.2"><root id="S4.Ex4.m2.4.4a.cmml" xref="S4.Ex4.m2.5.5.1.3.3.2"></root><apply id="S4.Ex4.m2.4.4.2.cmml" xref="S4.Ex4.m2.4.4.2"><divide id="S4.Ex4.m2.4.4.2.3.cmml" xref="S4.Ex4.m2.4.4.2"></divide><apply id="S4.Ex4.m2.4.4.2.2.2.3.cmml" xref="S4.Ex4.m2.4.4.2.2.2.2"><log id="S4.Ex4.m2.3.3.1.1.1.1.cmml" xref="S4.Ex4.m2.3.3.1.1.1.1"></log><apply id="S4.Ex4.m2.4.4.2.2.2.2.1.1.cmml" xref="S4.Ex4.m2.4.4.2.2.2.2.1.1"><divide id="S4.Ex4.m2.4.4.2.2.2.2.1.1.1.cmml" xref="S4.Ex4.m2.4.4.2.2.2.2.1.1.1"></divide><cn id="S4.Ex4.m2.4.4.2.2.2.2.1.1.2.cmml" type="integer" xref="S4.Ex4.m2.4.4.2.2.2.2.1.1.2">1</cn><ci id="S4.Ex4.m2.4.4.2.2.2.2.1.1.3.cmml" xref="S4.Ex4.m2.4.4.2.2.2.2.1.1.3">𝛿</ci></apply></apply><ci id="S4.Ex4.m2.4.4.2.4.cmml" xref="S4.Ex4.m2.4.4.2.4">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex4.m2.5c">\displaystyle=\tilde{\mathfrak{R}}_{n}(\mathcal{G}_{\ell,\mathcal{F}^{g^{%
\prime}}})+\mathcal{O}\Big{(}\sqrt{{\frac{\log(1/\delta)}{n}}}\Big{)}</annotation><annotation encoding="application/x-llamapun" id="S4.Ex4.m2.5d">= over~ start_ARG fraktur_R end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ( caligraphic_G start_POSTSUBSCRIPT roman_ℓ , caligraphic_F start_POSTSUPERSCRIPT italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ) + caligraphic_O ( square-root start_ARG divide start_ARG roman_log ( 1 / italic_δ ) end_ARG start_ARG italic_n end_ARG end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_para" id="S4.p12">
<p class="ltx_p" id="S4.p12.1">Note the following implications of these theoretical results:</p>
</div>
<div class="ltx_para" id="S4.p13">
<p class="ltx_p" id="S4.p13.4">1. If the corrector network <math alttext="h" class="ltx_Math" display="inline" id="S4.p13.1.m1.1"><semantics id="S4.p13.1.m1.1a"><mi id="S4.p13.1.m1.1.1" xref="S4.p13.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S4.p13.1.m1.1b"><ci id="S4.p13.1.m1.1.1.cmml" xref="S4.p13.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p13.1.m1.1c">h</annotation><annotation encoding="application/x-llamapun" id="S4.p13.1.m1.1d">italic_h</annotation></semantics></math> is too complicated or there are not enough samples <math alttext="n" class="ltx_Math" display="inline" id="S4.p13.2.m2.1"><semantics id="S4.p13.2.m2.1a"><mi id="S4.p13.2.m2.1.1" xref="S4.p13.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.p13.2.m2.1b"><ci id="S4.p13.2.m2.1.1.cmml" xref="S4.p13.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p13.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.p13.2.m2.1d">italic_n</annotation></semantics></math>, then <math alttext="h" class="ltx_Math" display="inline" id="S4.p13.3.m3.1"><semantics id="S4.p13.3.m3.1a"><mi id="S4.p13.3.m3.1.1" xref="S4.p13.3.m3.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S4.p13.3.m3.1b"><ci id="S4.p13.3.m3.1.1.cmml" xref="S4.p13.3.m3.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p13.3.m3.1c">h</annotation><annotation encoding="application/x-llamapun" id="S4.p13.3.m3.1d">italic_h</annotation></semantics></math> overfits and <math alttext="T_{3}" class="ltx_Math" display="inline" id="S4.p13.4.m4.1"><semantics id="S4.p13.4.m4.1a"><msub id="S4.p13.4.m4.1.1" xref="S4.p13.4.m4.1.1.cmml"><mi id="S4.p13.4.m4.1.1.2" xref="S4.p13.4.m4.1.1.2.cmml">T</mi><mn id="S4.p13.4.m4.1.1.3" xref="S4.p13.4.m4.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S4.p13.4.m4.1b"><apply id="S4.p13.4.m4.1.1.cmml" xref="S4.p13.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p13.4.m4.1.1.1.cmml" xref="S4.p13.4.m4.1.1">subscript</csymbol><ci id="S4.p13.4.m4.1.1.2.cmml" xref="S4.p13.4.m4.1.1.2">𝑇</ci><cn id="S4.p13.4.m4.1.1.3.cmml" type="integer" xref="S4.p13.4.m4.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p13.4.m4.1c">T_{3}</annotation><annotation encoding="application/x-llamapun" id="S4.p13.4.m4.1d">italic_T start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math>, will dominate.</p>
</div>
<div class="ltx_para" id="S4.p14">
<p class="ltx_p" id="S4.p14.3">2. If <math alttext="g" class="ltx_Math" display="inline" id="S4.p14.1.m1.1"><semantics id="S4.p14.1.m1.1a"><mi id="S4.p14.1.m1.1.1" xref="S4.p14.1.m1.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S4.p14.1.m1.1b"><ci id="S4.p14.1.m1.1.1.cmml" xref="S4.p14.1.m1.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p14.1.m1.1c">g</annotation><annotation encoding="application/x-llamapun" id="S4.p14.1.m1.1d">italic_g</annotation></semantics></math> and <math alttext="g^{\prime}" class="ltx_Math" display="inline" id="S4.p14.2.m2.1"><semantics id="S4.p14.2.m2.1a"><msup id="S4.p14.2.m2.1.1" xref="S4.p14.2.m2.1.1.cmml"><mi id="S4.p14.2.m2.1.1.2" xref="S4.p14.2.m2.1.1.2.cmml">g</mi><mo id="S4.p14.2.m2.1.1.3" xref="S4.p14.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.p14.2.m2.1b"><apply id="S4.p14.2.m2.1.1.cmml" xref="S4.p14.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p14.2.m2.1.1.1.cmml" xref="S4.p14.2.m2.1.1">superscript</csymbol><ci id="S4.p14.2.m2.1.1.2.cmml" xref="S4.p14.2.m2.1.1.2">𝑔</ci><ci id="S4.p14.2.m2.1.1.3.cmml" xref="S4.p14.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p14.2.m2.1c">g^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.p14.2.m2.1d">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> are very different, then term <math alttext="T_{2}" class="ltx_Math" display="inline" id="S4.p14.3.m3.1"><semantics id="S4.p14.3.m3.1a"><msub id="S4.p14.3.m3.1.1" xref="S4.p14.3.m3.1.1.cmml"><mi id="S4.p14.3.m3.1.1.2" xref="S4.p14.3.m3.1.1.2.cmml">T</mi><mn id="S4.p14.3.m3.1.1.3" xref="S4.p14.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.p14.3.m3.1b"><apply id="S4.p14.3.m3.1.1.cmml" xref="S4.p14.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p14.3.m3.1.1.1.cmml" xref="S4.p14.3.m3.1.1">subscript</csymbol><ci id="S4.p14.3.m3.1.1.2.cmml" xref="S4.p14.3.m3.1.1.2">𝑇</ci><cn id="S4.p14.3.m3.1.1.3.cmml" type="integer" xref="S4.p14.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p14.3.m3.1c">T_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.p14.3.m3.1d">italic_T start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> will dominate.</p>
</div>
<div class="ltx_para" id="S4.p15">
<p class="ltx_p" id="S4.p15.2">3. If <math alttext="h(\cdot)" class="ltx_Math" display="inline" id="S4.p15.1.m1.1"><semantics id="S4.p15.1.m1.1a"><mrow id="S4.p15.1.m1.1.2" xref="S4.p15.1.m1.1.2.cmml"><mi id="S4.p15.1.m1.1.2.2" xref="S4.p15.1.m1.1.2.2.cmml">h</mi><mo id="S4.p15.1.m1.1.2.1" xref="S4.p15.1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.p15.1.m1.1.2.3.2" xref="S4.p15.1.m1.1.2.cmml"><mo id="S4.p15.1.m1.1.2.3.2.1" stretchy="false" xref="S4.p15.1.m1.1.2.cmml">(</mo><mo id="S4.p15.1.m1.1.1" lspace="0em" rspace="0em" xref="S4.p15.1.m1.1.1.cmml">⋅</mo><mo id="S4.p15.1.m1.1.2.3.2.2" stretchy="false" xref="S4.p15.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p15.1.m1.1b"><apply id="S4.p15.1.m1.1.2.cmml" xref="S4.p15.1.m1.1.2"><times id="S4.p15.1.m1.1.2.1.cmml" xref="S4.p15.1.m1.1.2.1"></times><ci id="S4.p15.1.m1.1.2.2.cmml" xref="S4.p15.1.m1.1.2.2">ℎ</ci><ci id="S4.p15.1.m1.1.1.cmml" xref="S4.p15.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p15.1.m1.1c">h(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.p15.1.m1.1d">italic_h ( ⋅ )</annotation></semantics></math> is too simple and we cannot fit the sampled data well, then <math alttext="T_{1}" class="ltx_Math" display="inline" id="S4.p15.2.m2.1"><semantics id="S4.p15.2.m2.1a"><msub id="S4.p15.2.m2.1.1" xref="S4.p15.2.m2.1.1.cmml"><mi id="S4.p15.2.m2.1.1.2" xref="S4.p15.2.m2.1.1.2.cmml">T</mi><mn id="S4.p15.2.m2.1.1.3" xref="S4.p15.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.p15.2.m2.1b"><apply id="S4.p15.2.m2.1.1.cmml" xref="S4.p15.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p15.2.m2.1.1.1.cmml" xref="S4.p15.2.m2.1.1">subscript</csymbol><ci id="S4.p15.2.m2.1.1.2.cmml" xref="S4.p15.2.m2.1.1.2">𝑇</ci><cn id="S4.p15.2.m2.1.1.3.cmml" type="integer" xref="S4.p15.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p15.2.m2.1c">T_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.p15.2.m2.1d">italic_T start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> will dominate.</p>
</div>
<div class="ltx_para" id="S4.p16">
<p class="ltx_p" id="S4.p16.1">We empirically explore some of these trade-offs in §<a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S5.SS3" title="5.3 Synthetic Experiments ‣ 5 Experiments ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">5.3</span></a>.</p>
</div>
<figure class="ltx_figure" id="S4.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="371" id="S4.F2.g1" src="extracted/5830607/nq_test_r1.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span class="ltx_text ltx_font_bold" id="S4.F2.2.1">NQ Test Recall@1</span>. We show the computational trade-offs between the amount of re-embedding during training and the task performance (GTR initialization). Our proposed target corrector approach achieves matching task performance at a fraction of the computational expense.</figcaption>
</figure>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We evaluate training using target corrector networks in two settings: supervised dense retrieval and retrieval augmented language models.
We further investigate the properties of the target corrector networks in synthetic experiments.
In summary, the experiments investigate whether training strategies can effectively obviate the need to keep cached buffers of targets up-to-date by re-embedding during training. We answer this question affirmatively with the following highlights:</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.1"><span class="ltx_text ltx_font_bold" id="S5.p2.1.1">No Re-embedding Needed</span> Training using target corrector networks matches the task performance of exhaustively re-embed all targets every 500 steps throughout training in both dense retrieval (Table <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S5.T1" title="Table 1 ‣ 5.1 Supervised Dense Retrieval ‣ 5 Experiments ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">1</span></a>) and retrieval augmented language models (Table <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S5.T3" title="Table 3 ‣ 5.1 Supervised Dense Retrieval ‣ 5 Experiments ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">3</span></a>). Target correctors achieve this without ever needing to re-embed targets during training, yielding significant computational savings (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S4.F2" title="Figure 2 ‣ 4 Analysis ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">2</span></a>).</p>
</div>
<div class="ltx_para" id="S5.p3">
<p class="ltx_p" id="S5.p3.1"><span class="ltx_text ltx_font_bold" id="S5.p3.1.1">Best no re-embedding method</span> Compared to frozen approaches, stale approaches, and Dynnibal without re-embedding, target corrector networks achieve over 10 point improvements in RLM tasks and 4 point improvements across multiple recall measures in retrieval.</p>
</div>
<div class="ltx_para" id="S5.p4">
<p class="ltx_p" id="S5.p4.1"><span class="ltx_text ltx_font_bold" id="S5.p4.1.1">Simpler and Less Computation</span> Target correctors perform as well or better than Stochastic Negative Mining (SNM) <cite class="ltx_cite ltx_citemacro_citep">(Reddi et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib32" title="">2019</a>)</cite> despite SNM doing more re-embedding. Similarly, target corrector networks nearly match Dynnibal <cite class="ltx_cite ltx_citemacro_citep">(Monath et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib24" title="">2023</a>)</cite> when Dynnibal uses much more computation (Table <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S5.T1" title="Table 1 ‣ 5.1 Supervised Dense Retrieval ‣ 5 Experiments ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">1</span></a>). Dynnibal is a much more complicated and difficult to implement method.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Supervised Dense Retrieval</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p1.1.1">Setting &amp; Metrics </span> We evaluate training methods for supervised dense retrieval models. Each method is provided the same supervised data. All methods use a stale buffer of target representations and use this buffer to form the subset of targets, <math alttext="S(\mathcal{Y})" class="ltx_Math" display="inline" id="S5.SS1.p1.1.m1.1"><semantics id="S5.SS1.p1.1.m1.1a"><mrow id="S5.SS1.p1.1.m1.1.2" xref="S5.SS1.p1.1.m1.1.2.cmml"><mi id="S5.SS1.p1.1.m1.1.2.2" xref="S5.SS1.p1.1.m1.1.2.2.cmml">S</mi><mo id="S5.SS1.p1.1.m1.1.2.1" xref="S5.SS1.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S5.SS1.p1.1.m1.1.2.3.2" xref="S5.SS1.p1.1.m1.1.2.cmml"><mo id="S5.SS1.p1.1.m1.1.2.3.2.1" stretchy="false" xref="S5.SS1.p1.1.m1.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml">𝒴</mi><mo id="S5.SS1.p1.1.m1.1.2.3.2.2" stretchy="false" xref="S5.SS1.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.2.cmml" xref="S5.SS1.p1.1.m1.1.2"><times id="S5.SS1.p1.1.m1.1.2.1.cmml" xref="S5.SS1.p1.1.m1.1.2.1"></times><ci id="S5.SS1.p1.1.m1.1.2.2.cmml" xref="S5.SS1.p1.1.m1.1.2.2">𝑆</ci><ci id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">S(\mathcal{Y})</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.1.m1.1d">italic_S ( caligraphic_Y )</annotation></semantics></math>, used in computing the truncated softmax. All methods use the same loss (cross-entropy) and optimize parameters of the dual-encoders using gradient descent. The methods differ in their maintenance of the buffer, and, as such, differ in their computational requirements of maintaining this buffer. We measure the computational requirements in terms of how many targets are re-embedding during training<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Our JAX <cite class="ltx_cite ltx_citemacro_citep">(Bradbury et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib3" title="">2018</a>)</cite> implementation run on Cloud TPUv3 re-embeds ~2184 targets per second on each core.</span></span></span>. We measure re-embedding in terms of the number of targets encoded to indicate the computational expense (even if wall clock time is mitigated using a complicated asynchronous computation). Re-embedding every target even one additional time during training can be problematic if number of targets is large. Furthermore, the initial buffer, created using the initial parameters of the dual-encoder (e.g., a pre-trained language model) can be computed once and used for subsequent training jobs.</p>
</div>
<div class="ltx_para" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p2.1.1">Data </span> We evaluate on Natural Questions <cite class="ltx_cite ltx_citemacro_citep">(Kwiatkowski et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib19" title="">2019</a>)</cite> with over 21M targets (Wikipedia passages), about 60K training examples (question, passage pairs), and about 3K in dev/test, and MSMARCO <cite class="ltx_cite ltx_citemacro_citep">(Bajaj et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib1" title="">2016</a>)</cite> 8.8M targets (web passages), and 500K training examples.</p>
</div>
<div class="ltx_para" id="S5.SS1.p3">
<p class="ltx_p" id="S5.SS1.p3.3"><span class="ltx_text ltx_font_bold" id="S5.SS1.p3.3.1">Models </span> We initialize the dual encoder models with two publicly available pre-trained language models, GTR <cite class="ltx_cite ltx_citemacro_citep">(Ni et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib27" title="">2022</a>)</cite>, and T5 <cite class="ltx_cite ltx_citemacro_citep">(Raffel et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib29" title="">2020</a>)</cite>. GTR is an encoder model initialized from T5 and further pre-trained for dense retrieval on a large collection of corpora of question/answer pairs. For MSMARCO, we only use T5 since it is included in GTR’s training data. We use the base size models, <math alttext="D=768" class="ltx_Math" display="inline" id="S5.SS1.p3.1.m1.1"><semantics id="S5.SS1.p3.1.m1.1a"><mrow id="S5.SS1.p3.1.m1.1.1" xref="S5.SS1.p3.1.m1.1.1.cmml"><mi id="S5.SS1.p3.1.m1.1.1.2" xref="S5.SS1.p3.1.m1.1.1.2.cmml">D</mi><mo id="S5.SS1.p3.1.m1.1.1.1" xref="S5.SS1.p3.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS1.p3.1.m1.1.1.3" xref="S5.SS1.p3.1.m1.1.1.3.cmml">768</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.1.m1.1b"><apply id="S5.SS1.p3.1.m1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1"><eq id="S5.SS1.p3.1.m1.1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1.1"></eq><ci id="S5.SS1.p3.1.m1.1.1.2.cmml" xref="S5.SS1.p3.1.m1.1.1.2">𝐷</ci><cn id="S5.SS1.p3.1.m1.1.1.3.cmml" type="integer" xref="S5.SS1.p3.1.m1.1.1.3">768</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.1.m1.1c">D=768</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.1.m1.1d">italic_D = 768</annotation></semantics></math>, and train separate parameters for <math alttext="f(x)" class="ltx_Math" display="inline" id="S5.SS1.p3.2.m2.1"><semantics id="S5.SS1.p3.2.m2.1a"><mrow id="S5.SS1.p3.2.m2.1.2" xref="S5.SS1.p3.2.m2.1.2.cmml"><mi id="S5.SS1.p3.2.m2.1.2.2" xref="S5.SS1.p3.2.m2.1.2.2.cmml">f</mi><mo id="S5.SS1.p3.2.m2.1.2.1" xref="S5.SS1.p3.2.m2.1.2.1.cmml">⁢</mo><mrow id="S5.SS1.p3.2.m2.1.2.3.2" xref="S5.SS1.p3.2.m2.1.2.cmml"><mo id="S5.SS1.p3.2.m2.1.2.3.2.1" stretchy="false" xref="S5.SS1.p3.2.m2.1.2.cmml">(</mo><mi id="S5.SS1.p3.2.m2.1.1" xref="S5.SS1.p3.2.m2.1.1.cmml">x</mi><mo id="S5.SS1.p3.2.m2.1.2.3.2.2" stretchy="false" xref="S5.SS1.p3.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.2.m2.1b"><apply id="S5.SS1.p3.2.m2.1.2.cmml" xref="S5.SS1.p3.2.m2.1.2"><times id="S5.SS1.p3.2.m2.1.2.1.cmml" xref="S5.SS1.p3.2.m2.1.2.1"></times><ci id="S5.SS1.p3.2.m2.1.2.2.cmml" xref="S5.SS1.p3.2.m2.1.2.2">𝑓</ci><ci id="S5.SS1.p3.2.m2.1.1.cmml" xref="S5.SS1.p3.2.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.2.m2.1c">f(x)</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.2.m2.1d">italic_f ( italic_x )</annotation></semantics></math> and <math alttext="g(y)" class="ltx_Math" display="inline" id="S5.SS1.p3.3.m3.1"><semantics id="S5.SS1.p3.3.m3.1a"><mrow id="S5.SS1.p3.3.m3.1.2" xref="S5.SS1.p3.3.m3.1.2.cmml"><mi id="S5.SS1.p3.3.m3.1.2.2" xref="S5.SS1.p3.3.m3.1.2.2.cmml">g</mi><mo id="S5.SS1.p3.3.m3.1.2.1" xref="S5.SS1.p3.3.m3.1.2.1.cmml">⁢</mo><mrow id="S5.SS1.p3.3.m3.1.2.3.2" xref="S5.SS1.p3.3.m3.1.2.cmml"><mo id="S5.SS1.p3.3.m3.1.2.3.2.1" stretchy="false" xref="S5.SS1.p3.3.m3.1.2.cmml">(</mo><mi id="S5.SS1.p3.3.m3.1.1" xref="S5.SS1.p3.3.m3.1.1.cmml">y</mi><mo id="S5.SS1.p3.3.m3.1.2.3.2.2" stretchy="false" xref="S5.SS1.p3.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.3.m3.1b"><apply id="S5.SS1.p3.3.m3.1.2.cmml" xref="S5.SS1.p3.3.m3.1.2"><times id="S5.SS1.p3.3.m3.1.2.1.cmml" xref="S5.SS1.p3.3.m3.1.2.1"></times><ci id="S5.SS1.p3.3.m3.1.2.2.cmml" xref="S5.SS1.p3.3.m3.1.2.2">𝑔</ci><ci id="S5.SS1.p3.3.m3.1.1.cmml" xref="S5.SS1.p3.3.m3.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.3.m3.1c">g(y)</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.3.m3.1d">italic_g ( italic_y )</annotation></semantics></math>. For the target corrector, we use a two layer MLP. We use 8192 hidden units, a ReLU non-linearity, and a residual connection.</p>
</div>
<figure class="ltx_table" id="S5.T1">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T1.14">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.2.2">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S5.T1.2.2.3"></th>
<th class="ltx_td ltx_nopad_r ltx_th ltx_th_row ltx_border_tt" id="S5.T1.2.2.4"></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_tt" id="S5.T1.2.2.5">Re-embed</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="5" id="S5.T1.1.1.1">NQ Dev - Recall (<math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T1.1.1.1.m1.1"><semantics id="S5.T1.1.1.1.m1.1a"><mo id="S5.T1.1.1.1.m1.1.1" stretchy="false" xref="S5.T1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.1.1.1.m1.1b"><ci id="S5.T1.1.1.1.m1.1.1.cmml" xref="S5.T1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T1.1.1.1.m1.1d">↑</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="5" id="S5.T1.2.2.2">NQ Test - Recall (<math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T1.2.2.2.m1.1"><semantics id="S5.T1.2.2.2.m1.1a"><mo id="S5.T1.2.2.2.m1.1.1" stretchy="false" xref="S5.T1.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.2.2.2.m1.1b"><ci id="S5.T1.2.2.2.m1.1.1.cmml" xref="S5.T1.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T1.2.2.2.m1.1d">↑</annotation></semantics></math>)</td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.3">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T1.3.3.2"></th>
<th class="ltx_td ltx_nopad_r ltx_th ltx_th_row" id="S5.T1.3.3.3"></th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_row" id="S5.T1.3.3.1">Num. (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T1.3.3.1.m1.1"><semantics id="S5.T1.3.3.1.m1.1a"><mo id="S5.T1.3.3.1.m1.1.1" stretchy="false" xref="S5.T1.3.3.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T1.3.3.1.m1.1b"><ci id="S5.T1.3.3.1.m1.1.1.cmml" xref="S5.T1.3.3.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.3.3.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T1.3.3.1.m1.1d">↓</annotation></semantics></math>)</th>
<td class="ltx_td ltx_align_right" id="S5.T1.3.3.4">@1</td>
<td class="ltx_td ltx_align_right" id="S5.T1.3.3.5">@5</td>
<td class="ltx_td ltx_align_right" id="S5.T1.3.3.6">@10</td>
<td class="ltx_td ltx_align_right" id="S5.T1.3.3.7">@20</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S5.T1.3.3.8">@100</td>
<td class="ltx_td ltx_align_right" id="S5.T1.3.3.9">@1</td>
<td class="ltx_td ltx_align_right" id="S5.T1.3.3.10">@5</td>
<td class="ltx_td ltx_align_right" id="S5.T1.3.3.11">@10</td>
<td class="ltx_td ltx_align_right" id="S5.T1.3.3.12">@20</td>
<td class="ltx_td ltx_nopad_r ltx_align_right" id="S5.T1.3.3.13">@100</td>
</tr>
<tr class="ltx_tr" id="S5.T1.14.15.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T1.14.15.1.1" rowspan="7">
<span class="ltx_inline-block ltx_parbox ltx_align_top" id="S5.T1.14.15.1.1.1" style="width:5.7pt;">
<span class="ltx_p" id="S5.T1.14.15.1.1.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T1.14.15.1.1.1.1.1" style="width:6.9pt;height:44.7pt;vertical-align:-18.9pt;"><span class="ltx_transformed_inner" style="width:44.7pt;transform:translate(-18.88pt,0pt) rotate(-90deg) ;">
<span class="ltx_p" id="S5.T1.14.15.1.1.1.1.1.1">GTR-base</span>
</span></span></span>
</span>
</th>
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T1.14.15.1.2">In-batch</th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_row ltx_border_t" id="S5.T1.14.15.1.3">0</th>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.14.15.1.4">17.14</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.14.15.1.5">46.77</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.14.15.1.6">58.71</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.14.15.1.7">69.45</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S5.T1.14.15.1.8">85.54</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.14.15.1.9">37.92</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.14.15.1.10">64.76</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.14.15.1.11">72.54</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.14.15.1.12">78.28</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S5.T1.14.15.1.13">87.00</td>
</tr>
<tr class="ltx_tr" id="S5.T1.14.16.2">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S5.T1.14.16.2.1">Stale</th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_row" id="S5.T1.14.16.2.2">0</th>
<td class="ltx_td ltx_align_right" id="S5.T1.14.16.2.3">33.11</td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.16.2.4">62.04</td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.16.2.5">70.31</td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.16.2.6">78.13</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S5.T1.14.16.2.7">89.32</td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.16.2.8">46.76</td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.16.2.9">68.64</td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.16.2.10">75.21</td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.16.2.11">80.66</td>
<td class="ltx_td ltx_nopad_r ltx_align_right" id="S5.T1.14.16.2.12">87.48</td>
</tr>
<tr class="ltx_tr" id="S5.T1.4.4">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S5.T1.4.4.1">Dynnibal<sup class="ltx_sup" id="S5.T1.4.4.1.1">+</sup>
</th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_row" id="S5.T1.4.4.2">0</th>
<td class="ltx_td ltx_align_right" id="S5.T1.4.4.3">28.73</td>
<td class="ltx_td ltx_align_right" id="S5.T1.4.4.4">59.66</td>
<td class="ltx_td ltx_align_right" id="S5.T1.4.4.5">70.08</td>
<td class="ltx_td ltx_align_right" id="S5.T1.4.4.6">78.14</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S5.T1.4.4.7">90.18</td>
<td class="ltx_td ltx_align_right" id="S5.T1.4.4.8">44.40</td>
<td class="ltx_td ltx_align_right" id="S5.T1.4.4.9">67.53</td>
<td class="ltx_td ltx_align_right" id="S5.T1.4.4.10">74.93</td>
<td class="ltx_td ltx_align_right" id="S5.T1.4.4.11">80.22</td>
<td class="ltx_td ltx_nopad_r ltx_align_right" id="S5.T1.4.4.12">87.23</td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.6">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S5.T1.6.6.2">Corrector <math alttext="{}^{\text{\faNewspaper[regular]}}" class="ltx_Math" display="inline" id="S5.T1.5.5.1.m1.1"><semantics id="S5.T1.5.5.1.m1.1a"><msup id="S5.T1.5.5.1.m1.1.1" xref="S5.T1.5.5.1.m1.1.1.cmml"><mi id="S5.T1.5.5.1.m1.1.1a" xref="S5.T1.5.5.1.m1.1.1.cmml"></mi><mrow id="S5.T1.5.5.1.m1.1.1.1" xref="S5.T1.5.5.1.m1.1.1.1d.cmml"><mtext class="undefined" id="S5.T1.5.5.1.m1.1.1.1a" mathsize="142%" xref="S5.T1.5.5.1.m1.1.1.1d.cmml"><span class="ltx_ERROR undefined" id="S5.T1.5.5.1.m1.1.1.1.1nest">\faNewspaper</span></mtext><mtext id="S5.T1.5.5.1.m1.1.1.1c" xref="S5.T1.5.5.1.m1.1.1.1d.cmml">[regular]</mtext></mrow></msup><annotation-xml encoding="MathML-Content" id="S5.T1.5.5.1.m1.1b"><apply id="S5.T1.5.5.1.m1.1.1.cmml" xref="S5.T1.5.5.1.m1.1.1"><ci id="S5.T1.5.5.1.m1.1.1.1d.cmml" xref="S5.T1.5.5.1.m1.1.1.1"><mrow id="S5.T1.5.5.1.m1.1.1.1.cmml" xref="S5.T1.5.5.1.m1.1.1.1"><mtext class="undefined" id="S5.T1.5.5.1.m1.1.1.1a.cmml" xref="S5.T1.5.5.1.m1.1.1.1"><span class="ltx_ERROR undefined" id="S5.T1.5.5.1.m1.1.1.1.1anest">\faNewspaper</span></mtext><mtext id="S5.T1.5.5.1.m1.1.1.1c.cmml" mathsize="70%" xref="S5.T1.5.5.1.m1.1.1.1">[regular]</mtext></mrow></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.5.5.1.m1.1c">{}^{\text{\faNewspaper[regular]}}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.5.5.1.m1.1d">start_FLOATSUPERSCRIPT [regular] end_FLOATSUPERSCRIPT</annotation></semantics></math> <span class="ltx_text" id="S5.T1.6.6.2.1" style="font-size:70%;">(<math alttext="\ell_{\text{mse}}" class="ltx_Math" display="inline" id="S5.T1.6.6.2.1.m1.1"><semantics id="S5.T1.6.6.2.1.m1.1a"><msub id="S5.T1.6.6.2.1.m1.1.1" xref="S5.T1.6.6.2.1.m1.1.1.cmml"><mi id="S5.T1.6.6.2.1.m1.1.1.2" mathvariant="normal" xref="S5.T1.6.6.2.1.m1.1.1.2.cmml">ℓ</mi><mtext id="S5.T1.6.6.2.1.m1.1.1.3" xref="S5.T1.6.6.2.1.m1.1.1.3a.cmml">mse</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T1.6.6.2.1.m1.1b"><apply id="S5.T1.6.6.2.1.m1.1.1.cmml" xref="S5.T1.6.6.2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T1.6.6.2.1.m1.1.1.1.cmml" xref="S5.T1.6.6.2.1.m1.1.1">subscript</csymbol><ci id="S5.T1.6.6.2.1.m1.1.1.2.cmml" xref="S5.T1.6.6.2.1.m1.1.1.2">ℓ</ci><ci id="S5.T1.6.6.2.1.m1.1.1.3a.cmml" xref="S5.T1.6.6.2.1.m1.1.1.3"><mtext id="S5.T1.6.6.2.1.m1.1.1.3.cmml" xref="S5.T1.6.6.2.1.m1.1.1.3">mse</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.6.6.2.1.m1.1c">\ell_{\text{mse}}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.6.6.2.1.m1.1d">roman_ℓ start_POSTSUBSCRIPT mse end_POSTSUBSCRIPT</annotation></semantics></math>)</span>
</th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_row" id="S5.T1.6.6.3">0</th>
<td class="ltx_td ltx_align_right" id="S5.T1.6.6.4">34.98</td>
<td class="ltx_td ltx_align_right" id="S5.T1.6.6.5">65.03</td>
<td class="ltx_td ltx_align_right" id="S5.T1.6.6.6">74.01</td>
<td class="ltx_td ltx_align_right" id="S5.T1.6.6.7">80.77</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S5.T1.6.6.8">90.82</td>
<td class="ltx_td ltx_align_right" id="S5.T1.6.6.9">49.61</td>
<td class="ltx_td ltx_align_right" id="S5.T1.6.6.10">70.72</td>
<td class="ltx_td ltx_align_right" id="S5.T1.6.6.11">77.04</td>
<td class="ltx_td ltx_align_right" id="S5.T1.6.6.12">82.33</td>
<td class="ltx_td ltx_nopad_r ltx_align_right" id="S5.T1.6.6.13">88.28</td>
</tr>
<tr class="ltx_tr" id="S5.T1.7.7">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S5.T1.7.7.1">Corrector <math alttext="{}^{\text{\faNewspaper[regular]}}" class="ltx_Math" display="inline" id="S5.T1.7.7.1.m1.1"><semantics id="S5.T1.7.7.1.m1.1a"><msup id="S5.T1.7.7.1.m1.1.1" xref="S5.T1.7.7.1.m1.1.1.cmml"><mi id="S5.T1.7.7.1.m1.1.1a" xref="S5.T1.7.7.1.m1.1.1.cmml"></mi><mrow id="S5.T1.7.7.1.m1.1.1.1" xref="S5.T1.7.7.1.m1.1.1.1d.cmml"><mtext class="undefined" id="S5.T1.7.7.1.m1.1.1.1a" mathsize="142%" xref="S5.T1.7.7.1.m1.1.1.1d.cmml"><span class="ltx_ERROR undefined" id="S5.T1.7.7.1.m1.1.1.1.1nest">\faNewspaper</span></mtext><mtext id="S5.T1.7.7.1.m1.1.1.1c" xref="S5.T1.7.7.1.m1.1.1.1d.cmml">[regular]</mtext></mrow></msup><annotation-xml encoding="MathML-Content" id="S5.T1.7.7.1.m1.1b"><apply id="S5.T1.7.7.1.m1.1.1.cmml" xref="S5.T1.7.7.1.m1.1.1"><ci id="S5.T1.7.7.1.m1.1.1.1d.cmml" xref="S5.T1.7.7.1.m1.1.1.1"><mrow id="S5.T1.7.7.1.m1.1.1.1.cmml" xref="S5.T1.7.7.1.m1.1.1.1"><mtext class="undefined" id="S5.T1.7.7.1.m1.1.1.1a.cmml" xref="S5.T1.7.7.1.m1.1.1.1"><span class="ltx_ERROR undefined" id="S5.T1.7.7.1.m1.1.1.1.1anest">\faNewspaper</span></mtext><mtext id="S5.T1.7.7.1.m1.1.1.1c.cmml" mathsize="70%" xref="S5.T1.7.7.1.m1.1.1.1">[regular]</mtext></mrow></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.7.7.1.m1.1c">{}^{\text{\faNewspaper[regular]}}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.7.7.1.m1.1d">start_FLOATSUPERSCRIPT [regular] end_FLOATSUPERSCRIPT</annotation></semantics></math>
</th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_row" id="S5.T1.7.7.2">0</th>
<td class="ltx_td ltx_align_right" id="S5.T1.7.7.3"><span class="ltx_text ltx_font_bold" id="S5.T1.7.7.3.1">35.78</span></td>
<td class="ltx_td ltx_align_right" id="S5.T1.7.7.4"><span class="ltx_text ltx_font_bold" id="S5.T1.7.7.4.1">66.74</span></td>
<td class="ltx_td ltx_align_right" id="S5.T1.7.7.5"><span class="ltx_text ltx_font_bold" id="S5.T1.7.7.5.1">75.06</span></td>
<td class="ltx_td ltx_align_right" id="S5.T1.7.7.6"><span class="ltx_text ltx_font_bold" id="S5.T1.7.7.6.1">81.52</span></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S5.T1.7.7.7"><span class="ltx_text ltx_font_bold" id="S5.T1.7.7.7.1">91.37</span></td>
<td class="ltx_td ltx_align_right" id="S5.T1.7.7.8"><span class="ltx_text ltx_font_bold" id="S5.T1.7.7.8.1">50.61</span></td>
<td class="ltx_td ltx_align_right" id="S5.T1.7.7.9"><span class="ltx_text ltx_font_bold" id="S5.T1.7.7.9.1">71.00</span></td>
<td class="ltx_td ltx_align_right" id="S5.T1.7.7.10"><span class="ltx_text ltx_font_bold" id="S5.T1.7.7.10.1">77.73</span></td>
<td class="ltx_td ltx_align_right" id="S5.T1.7.7.11"><span class="ltx_text ltx_font_bold" id="S5.T1.7.7.11.1">82.66</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_right" id="S5.T1.7.7.12"><span class="ltx_text ltx_font_bold" id="S5.T1.7.7.12.1">88.39</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.8.8">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T1.8.8.1">Dynnibal<sup class="ltx_sup" id="S5.T1.8.8.1.1">+</sup>
</th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_row ltx_border_t" id="S5.T1.8.8.2">42M</th>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.8.8.3">35.86</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.8.8.4">66.54</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.8.8.5">75.04</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.8.8.6">81.40</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S5.T1.8.8.7">91.27</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.8.8.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T1.8.8.8.1">50.55</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.8.8.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T1.8.8.9.1">71.69</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.8.8.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T1.8.8.10.1">78.25</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.8.8.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T1.8.8.11.1">83.35</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S5.T1.8.8.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T1.8.8.12.1">88.73</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.9.9">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S5.T1.9.9.1">SNM<sup class="ltx_sup" id="S5.T1.9.9.1.1">†</sup>
</th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_row" id="S5.T1.9.9.2">80M</th>
<td class="ltx_td ltx_align_right" id="S5.T1.9.9.3">32.03</td>
<td class="ltx_td ltx_align_right" id="S5.T1.9.9.4">64.01</td>
<td class="ltx_td ltx_align_right" id="S5.T1.9.9.5">73.72</td>
<td class="ltx_td ltx_align_right" id="S5.T1.9.9.6">81.37</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S5.T1.9.9.7">91.47</td>
<td class="ltx_td ltx_align_right" id="S5.T1.9.9.8">49.14</td>
<td class="ltx_td ltx_align_right" id="S5.T1.9.9.9">69.89</td>
<td class="ltx_td ltx_align_right" id="S5.T1.9.9.10">77.12</td>
<td class="ltx_td ltx_align_right" id="S5.T1.9.9.11">82.19</td>
<td class="ltx_td ltx_nopad_r ltx_align_right" id="S5.T1.9.9.12">87.95</td>
</tr>
<tr class="ltx_tr" id="S5.T1.14.17.3">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T1.14.17.3.1"></th>
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S5.T1.14.17.3.2">Exhaustive</th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_row" id="S5.T1.14.17.3.3">1.68B</th>
<td class="ltx_td ltx_align_right" id="S5.T1.14.17.3.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T1.14.17.3.4.1">36.29</span></td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.17.3.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T1.14.17.3.5.1">67.08</span></td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.17.3.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T1.14.17.3.6.1">75.55</span></td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.17.3.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T1.14.17.3.7.1">82.07</span></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S5.T1.14.17.3.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T1.14.17.3.8.1">91.73</span></td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.17.3.9">50.30</td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.17.3.10">71.55</td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.17.3.11">78.12</td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.17.3.12">82.83</td>
<td class="ltx_td ltx_nopad_r ltx_align_right" id="S5.T1.14.17.3.13">88.59</td>
</tr>
<tr class="ltx_tr" id="S5.T1.14.18.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T1.14.18.4.1" rowspan="7">
<span class="ltx_inline-block ltx_parbox ltx_align_top" id="S5.T1.14.18.4.1.1" style="width:5.7pt;">
<span class="ltx_p" id="S5.T1.14.18.4.1.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T1.14.18.4.1.1.1.1" style="width:6.9pt;height:34.5pt;vertical-align:-13.8pt;"><span class="ltx_transformed_inner" style="width:34.5pt;transform:translate(-13.78pt,0pt) rotate(-90deg) ;">
<span class="ltx_p" id="S5.T1.14.18.4.1.1.1.1.1">T5-base</span>
</span></span></span>
</span>
</th>
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T1.14.18.4.2">In-batch</th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_row ltx_border_t" id="S5.T1.14.18.4.3">0</th>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.14.18.4.4">9.93</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.14.18.4.5">28.07</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.14.18.4.6">37.17</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.14.18.4.7">45.54</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S5.T1.14.18.4.8">64.06</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.14.18.4.9">23.40</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.14.18.4.10">47.50</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.14.18.4.11">56.39</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.14.18.4.12">65.34</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S5.T1.14.18.4.13">77.97</td>
</tr>
<tr class="ltx_tr" id="S5.T1.14.19.5">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S5.T1.14.19.5.1">Stale</th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_row" id="S5.T1.14.19.5.2">0</th>
<td class="ltx_td ltx_align_right" id="S5.T1.14.19.5.3">16.79</td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.19.5.4">36.85</td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.19.5.5">44.82</td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.19.5.6">51.79</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S5.T1.14.19.5.7">67.35</td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.19.5.8">27.65</td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.19.5.9">50.19</td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.19.5.10">59.28</td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.19.5.11">66.98</td>
<td class="ltx_td ltx_nopad_r ltx_align_right" id="S5.T1.14.19.5.12">78.95</td>
</tr>
<tr class="ltx_tr" id="S5.T1.10.10">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S5.T1.10.10.1">Dynnibal <sup class="ltx_sup" id="S5.T1.10.10.1.1">+</sup>
</th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_row" id="S5.T1.10.10.2">0</th>
<td class="ltx_td ltx_align_right" id="S5.T1.10.10.3">17.42</td>
<td class="ltx_td ltx_align_right" id="S5.T1.10.10.4">39.65</td>
<td class="ltx_td ltx_align_right" id="S5.T1.10.10.5">48.75</td>
<td class="ltx_td ltx_align_right" id="S5.T1.10.10.6">57.36</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S5.T1.10.10.7">73.03</td>
<td class="ltx_td ltx_align_right" id="S5.T1.10.10.8">29.72</td>
<td class="ltx_td ltx_align_right" id="S5.T1.10.10.9">53.99</td>
<td class="ltx_td ltx_align_right" id="S5.T1.10.10.10">63.38</td>
<td class="ltx_td ltx_align_right" id="S5.T1.10.10.11">70.61</td>
<td class="ltx_td ltx_nopad_r ltx_align_right" id="S5.T1.10.10.12">80.94</td>
</tr>
<tr class="ltx_tr" id="S5.T1.11.11">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S5.T1.11.11.1">Corrector <math alttext="{}^{\text{\faNewspaper[regular]}}" class="ltx_Math" display="inline" id="S5.T1.11.11.1.m1.1"><semantics id="S5.T1.11.11.1.m1.1a"><msup id="S5.T1.11.11.1.m1.1.1" xref="S5.T1.11.11.1.m1.1.1.cmml"><mi id="S5.T1.11.11.1.m1.1.1a" xref="S5.T1.11.11.1.m1.1.1.cmml"></mi><mrow id="S5.T1.11.11.1.m1.1.1.1" xref="S5.T1.11.11.1.m1.1.1.1d.cmml"><mtext class="undefined" id="S5.T1.11.11.1.m1.1.1.1a" mathsize="142%" xref="S5.T1.11.11.1.m1.1.1.1d.cmml"><span class="ltx_ERROR undefined" id="S5.T1.11.11.1.m1.1.1.1.1nest">\faNewspaper</span></mtext><mtext id="S5.T1.11.11.1.m1.1.1.1c" xref="S5.T1.11.11.1.m1.1.1.1d.cmml">[regular]</mtext></mrow></msup><annotation-xml encoding="MathML-Content" id="S5.T1.11.11.1.m1.1b"><apply id="S5.T1.11.11.1.m1.1.1.cmml" xref="S5.T1.11.11.1.m1.1.1"><ci id="S5.T1.11.11.1.m1.1.1.1d.cmml" xref="S5.T1.11.11.1.m1.1.1.1"><mrow id="S5.T1.11.11.1.m1.1.1.1.cmml" xref="S5.T1.11.11.1.m1.1.1.1"><mtext class="undefined" id="S5.T1.11.11.1.m1.1.1.1a.cmml" xref="S5.T1.11.11.1.m1.1.1.1"><span class="ltx_ERROR undefined" id="S5.T1.11.11.1.m1.1.1.1.1anest">\faNewspaper</span></mtext><mtext id="S5.T1.11.11.1.m1.1.1.1c.cmml" mathsize="70%" xref="S5.T1.11.11.1.m1.1.1.1">[regular]</mtext></mrow></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.11.11.1.m1.1c">{}^{\text{\faNewspaper[regular]}}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.11.11.1.m1.1d">start_FLOATSUPERSCRIPT [regular] end_FLOATSUPERSCRIPT</annotation></semantics></math>
</th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_row" id="S5.T1.11.11.2">0</th>
<td class="ltx_td ltx_align_right" id="S5.T1.11.11.3"><span class="ltx_text ltx_font_bold" id="S5.T1.11.11.3.1">23.64</span></td>
<td class="ltx_td ltx_align_right" id="S5.T1.11.11.4"><span class="ltx_text ltx_font_bold" id="S5.T1.11.11.4.1">47.69</span></td>
<td class="ltx_td ltx_align_right" id="S5.T1.11.11.5"><span class="ltx_text ltx_font_bold" id="S5.T1.11.11.5.1">56.68</span></td>
<td class="ltx_td ltx_align_right" id="S5.T1.11.11.6"><span class="ltx_text ltx_font_bold" id="S5.T1.11.11.6.1">64.65</span></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S5.T1.11.11.7"><span class="ltx_text ltx_font_bold" id="S5.T1.11.11.7.1">79.03</span></td>
<td class="ltx_td ltx_align_right" id="S5.T1.11.11.8"><span class="ltx_text ltx_font_bold" id="S5.T1.11.11.8.1">36.65</span></td>
<td class="ltx_td ltx_align_right" id="S5.T1.11.11.9"><span class="ltx_text ltx_font_bold" id="S5.T1.11.11.9.1">59.25</span></td>
<td class="ltx_td ltx_align_right" id="S5.T1.11.11.10"><span class="ltx_text ltx_font_bold" id="S5.T1.11.11.10.1">68.06</span></td>
<td class="ltx_td ltx_align_right" id="S5.T1.11.11.11"><span class="ltx_text ltx_font_bold" id="S5.T1.11.11.11.1">73.71</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_right" id="S5.T1.11.11.12"><span class="ltx_text ltx_font_bold" id="S5.T1.11.11.12.1">83.13</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.12.12">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T1.12.12.1">Dynnibal <sup class="ltx_sup" id="S5.T1.12.12.1.1">+</sup>
</th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_row ltx_border_t" id="S5.T1.12.12.2">42M</th>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.12.12.3">23.71</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.12.12.4">46.63</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.12.12.5">55.75</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.12.12.6">63.88</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S5.T1.12.12.7">79.46</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.12.12.8">36.65</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.12.12.9">59.31</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.12.12.10">67.65</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.12.12.11">74.46</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S5.T1.12.12.12">83.13</td>
</tr>
<tr class="ltx_tr" id="S5.T1.13.13">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S5.T1.13.13.1">Dynnibal <sup class="ltx_sup" id="S5.T1.13.13.1.1">+</sup>
</th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_row" id="S5.T1.13.13.2">80M</th>
<td class="ltx_td ltx_align_right" id="S5.T1.13.13.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T1.13.13.3.1">24.76</span></td>
<td class="ltx_td ltx_align_right" id="S5.T1.13.13.4">47.69</td>
<td class="ltx_td ltx_align_right" id="S5.T1.13.13.5">56.82</td>
<td class="ltx_td ltx_align_right" id="S5.T1.13.13.6">64.90</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S5.T1.13.13.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T1.13.13.7.1">80.15</span></td>
<td class="ltx_td ltx_align_right" id="S5.T1.13.13.8">36.90</td>
<td class="ltx_td ltx_align_right" id="S5.T1.13.13.9">59.97</td>
<td class="ltx_td ltx_align_right" id="S5.T1.13.13.10">68.23</td>
<td class="ltx_td ltx_align_right" id="S5.T1.13.13.11">74.54</td>
<td class="ltx_td ltx_nopad_r ltx_align_right" id="S5.T1.13.13.12">83.35</td>
</tr>
<tr class="ltx_tr" id="S5.T1.14.14">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S5.T1.14.14.1">SNM <sup class="ltx_sup" id="S5.T1.14.14.1.1">†</sup>
</th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_row" id="S5.T1.14.14.2">80M</th>
<td class="ltx_td ltx_align_right" id="S5.T1.14.14.3">22.55</td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.14.4">46.86</td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.14.5">55.72</td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.14.6">64.19</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S5.T1.14.14.7">80.40</td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.14.8">35.93</td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.14.9">59.06</td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.14.10">67.48</td>
<td class="ltx_td ltx_align_right" id="S5.T1.14.14.11">73.66</td>
<td class="ltx_td ltx_nopad_r ltx_align_right" id="S5.T1.14.14.12">82.85</td>
</tr>
<tr class="ltx_tr" id="S5.T1.14.20.6">
<th class="ltx_td ltx_th ltx_th_row ltx_border_bb" id="S5.T1.14.20.6.1"></th>
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T1.14.20.6.2">Exhaustive</th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_row ltx_border_bb" id="S5.T1.14.20.6.3">1.68B</th>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T1.14.20.6.4">24.70</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T1.14.20.6.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T1.14.20.6.5.1">48.21</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T1.14.20.6.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T1.14.20.6.6.1">57.18</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T1.14.20.6.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T1.14.20.6.7.1">65.39</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb ltx_border_r" id="S5.T1.14.20.6.8">79.94</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T1.14.20.6.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T1.14.20.6.9.1">37.34</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T1.14.20.6.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T1.14.20.6.10.1">60.42</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T1.14.20.6.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T1.14.20.6.11.1">68.70</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T1.14.20.6.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T1.14.20.6.12.1">74.76</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb" id="S5.T1.14.20.6.13"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T1.14.20.6.13.1">83.41</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span><span class="ltx_text ltx_font_bold" id="S5.T1.25.1">Natural Questions</span> <cite class="ltx_cite ltx_citemacro_citep">(Kwiatkowski et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib19" title="">2019</a>)</cite>. <span class="ltx_text ltx_markedasmath" id="S5.T1.26.2"><span class="ltx_ERROR undefined" id="S5.T1.26.2.1">\faNewspaper</span>[regular]</span> This paper; <math alttext="\dagger" class="ltx_Math" display="inline" id="S5.T1.19.m2.1"><semantics id="S5.T1.19.m2.1b"><mo id="S5.T1.19.m2.1.1" xref="S5.T1.19.m2.1.1.cmml">†</mo><annotation-xml encoding="MathML-Content" id="S5.T1.19.m2.1c"><ci id="S5.T1.19.m2.1.1.cmml" xref="S5.T1.19.m2.1.1">†</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.19.m2.1d">\dagger</annotation><annotation encoding="application/x-llamapun" id="S5.T1.19.m2.1e">†</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Reddi et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib32" title="">2019</a>)</cite>’ <math alttext="+" class="ltx_Math" display="inline" id="S5.T1.20.m3.1"><semantics id="S5.T1.20.m3.1b"><mo id="S5.T1.20.m3.1.1" xref="S5.T1.20.m3.1.1.cmml">+</mo><annotation-xml encoding="MathML-Content" id="S5.T1.20.m3.1c"><plus id="S5.T1.20.m3.1.1.cmml" xref="S5.T1.20.m3.1.1"></plus></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.20.m3.1d">+</annotation><annotation encoding="application/x-llamapun" id="S5.T1.20.m3.1e">+</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Monath et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib24" title="">2023</a>)</cite>. We measure the performance of dense retrieval models trained with different softmax approximations via hard negatives. We find that our proposed approach nearly matches the performance of exhaustively re-embedding all targets. Similarly, our approach requires significantly less re-embedding of targets than Dynnibal, which requires at least one exhaustive re-embedding to get competitive results. <span class="ltx_text ltx_font_bold" id="S5.T1.27.3">Bold-face numbers</span> indicate best performance with zero re-embeddings performed at training time; <span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T1.28.4">underlined numbers</span> indicate best performance using re-embedding at training time.</figcaption>
</figure>
<div class="ltx_para" id="S5.SS1.p4">
<p class="ltx_p" id="S5.SS1.p4.1">We compare the following approaches: <span class="ltx_text ltx_font_bold" id="S5.SS1.p4.1.1">Target Corrector Networks</span> (this paper): At the first training step, we initialize the buffer with vector representations of every target. At every subsequent step, we use the target corrector network to produce a new representation of the targets, without running the target-encoder, simply by running our small MLP corrector on the stale representations. The stale buffer representations are never updated during training. <span class="ltx_text ltx_font_bold" id="S5.SS1.p4.1.2">Stale</span>: We initialize the buffer of targets at the first step of training and do not update it throughout training. We experimented with both freezing the target encoder parameters <math alttext="g(y)" class="ltx_Math" display="inline" id="S5.SS1.p4.1.m1.1"><semantics id="S5.SS1.p4.1.m1.1a"><mrow id="S5.SS1.p4.1.m1.1.2" xref="S5.SS1.p4.1.m1.1.2.cmml"><mi id="S5.SS1.p4.1.m1.1.2.2" xref="S5.SS1.p4.1.m1.1.2.2.cmml">g</mi><mo id="S5.SS1.p4.1.m1.1.2.1" xref="S5.SS1.p4.1.m1.1.2.1.cmml">⁢</mo><mrow id="S5.SS1.p4.1.m1.1.2.3.2" xref="S5.SS1.p4.1.m1.1.2.cmml"><mo id="S5.SS1.p4.1.m1.1.2.3.2.1" stretchy="false" xref="S5.SS1.p4.1.m1.1.2.cmml">(</mo><mi id="S5.SS1.p4.1.m1.1.1" xref="S5.SS1.p4.1.m1.1.1.cmml">y</mi><mo id="S5.SS1.p4.1.m1.1.2.3.2.2" stretchy="false" xref="S5.SS1.p4.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.1.m1.1b"><apply id="S5.SS1.p4.1.m1.1.2.cmml" xref="S5.SS1.p4.1.m1.1.2"><times id="S5.SS1.p4.1.m1.1.2.1.cmml" xref="S5.SS1.p4.1.m1.1.2.1"></times><ci id="S5.SS1.p4.1.m1.1.2.2.cmml" xref="S5.SS1.p4.1.m1.1.2.2">𝑔</ci><ci id="S5.SS1.p4.1.m1.1.1.cmml" xref="S5.SS1.p4.1.m1.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.1.m1.1c">g(y)</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p4.1.m1.1d">italic_g ( italic_y )</annotation></semantics></math> and allowing them to be updated despite the stale buffer. We found updating the parameters to be slightly better and report those results. <span class="ltx_text ltx_font_bold" id="S5.SS1.p4.1.3">Exhaustive</span>: We exhaustively re-embed all of the targets in the buffer every 500 steps of training. <span class="ltx_text ltx_font_bold" id="S5.SS1.p4.1.4">Stochastic Negative Mining</span> (SNM; <cite class="ltx_cite ltx_citemacro_citet">Reddi et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib32" title="">2019</a></cite>): Instead of storing every target in the buffer, we store a subset of targets sampled uniformly at random. We re-sample and re-embed this buffer every 500 steps. We use a buffer size of 1M targets. <span class="ltx_text ltx_font_bold" id="S5.SS1.p4.1.5">Dynnibal</span> <cite class="ltx_cite ltx_citemacro_citep">(Monath et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib24" title="">2023</a>)</cite>: This complicated approach maintains a buffer using a low-rank regression model as a part of tree index structure. The regression model is updated every 500 steps on a sub-sample of targets, unlike our approach which is trained jointly. Furthermore, to get good performance, Dynnibal performs costly full buffer re-embedding periodically throughout training. We needed to perform two such re-embeddings. Dynnibal with fewer refreshes does not perform as well.</p>
</div>
<figure class="ltx_table" id="S5.T2">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T2.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T2.1.1.1">
<th class="ltx_td ltx_nopad_r ltx_th ltx_th_row ltx_border_tt" id="S5.T2.1.1.1.1"></th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T2.1.1.1.2">Hidden</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="S5.T2.1.1.1.3">Steps/sec</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="S5.T2.1.1.1.4">R@1</th>
<th class="ltx_td ltx_nopad_r ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="S5.T2.1.1.1.5">R@20</th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="S5.T2.1.1.1.6">R@100</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.1.2.1">
<th class="ltx_td ltx_nopad_r ltx_th ltx_th_row" id="S5.T2.1.2.1.1"></th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_column ltx_th_row" id="S5.T2.1.2.1.2">Units</th>
<th class="ltx_td ltx_th ltx_th_column" id="S5.T2.1.2.1.3"></th>
<th class="ltx_td ltx_th ltx_th_column" id="S5.T2.1.2.1.4"></th>
<th class="ltx_td ltx_th ltx_th_column" id="S5.T2.1.2.1.5"></th>
<td class="ltx_td" id="S5.T2.1.2.1.6"></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.3.2">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T2.1.3.2.1">Exhaustive</th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_row ltx_border_t" id="S5.T2.1.3.2.2">-</th>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T2.1.3.2.3">0.43</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T2.1.3.2.4">36.29</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S5.T2.1.3.2.5">82.07</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_border_t" id="S5.T2.1.3.2.6">91.70</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.4.3">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S5.T2.1.4.3.1">Corrector</th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_row" id="S5.T2.1.4.3.2">8192</th>
<td class="ltx_td ltx_align_right" id="S5.T2.1.4.3.3">0.83</td>
<td class="ltx_td ltx_align_right" id="S5.T2.1.4.3.4">35.78</td>
<td class="ltx_td ltx_nopad_r ltx_align_right" id="S5.T2.1.4.3.5">81.52</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right" id="S5.T2.1.4.3.6">91.37</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.5.4">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S5.T2.1.5.4.1">Corrector</th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_row" id="S5.T2.1.5.4.2">4096</th>
<td class="ltx_td ltx_align_right" id="S5.T2.1.5.4.3">1.10</td>
<td class="ltx_td ltx_align_right" id="S5.T2.1.5.4.4">35.53</td>
<td class="ltx_td ltx_nopad_r ltx_align_right" id="S5.T2.1.5.4.5">81.63</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right" id="S5.T2.1.5.4.6">91.07</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.6.5">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T2.1.6.5.1">Corrector</th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_row ltx_border_bb" id="S5.T2.1.6.5.2">2048</th>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T2.1.6.5.3">1.83</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T2.1.6.5.4">35.55</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb" id="S5.T2.1.6.5.5">81.07</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_border_bb" id="S5.T2.1.6.5.6">91.08</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span><span class="ltx_text ltx_font_bold" id="S5.T2.3.1">Steps-Per-Second Comparison.</span> We compare on NQ-dev the performance and speed of corrector networks and exhaustive re-encoding. Models are finetuned GTR-base.</figcaption>
</figure>
<div class="ltx_para" id="S5.SS1.p5">
<p class="ltx_p" id="S5.SS1.p5.1">In Table <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S5.T1" title="Table 1 ‣ 5.1 Supervised Dense Retrieval ‣ 5 Experiments ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">1</span></a>, our
target corrector network approach greatly improves upon the stale approach, especially in Recall@1, 5, 10. We observe a nearly 5 point improvement at R@10 in the dev set and a 4 point improvement in R@1 on the test over the stale approach. Our approach nearly matches the performance of the computationally intensive exhaustive approach. Furthermore, we perform comparably to the more expensive SNM and Dynnibal methods. We perform better than Dynnibal for the same amount of re-embedding. While doubling the number of index refreshes may appear negligible, having to re-embed the buffer during training can be computationally burdensome, especially as the number of targets grows. Using a buffer created from the initial parameters of the dual-encoder as with our approach, allows the buffer to be constructed once ahead of time and re-used across both training and tasks. Dynnibal requires hand tuning to get the re-embedding schedule correct.</p>
</div>
<div class="ltx_para" id="S5.SS1.p6">
<p class="ltx_p" id="S5.SS1.p6.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S5.T1" title="Table 1 ‣ 5.1 Supervised Dense Retrieval ‣ 5 Experiments ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">1</span></a> also compares dual-encoder initialization. GTR is pre-trained for retrieval and hence achieves better results. T5 is not pre-trained for retrieval and requires more adaptation for the retrieval task. We observe that SNM struggles more to match the performance of Exhaustive with T5. Furthermore, Dynnibal requires more full index refreshes to get competitive results. Our method is able to achieve nearly as good results as the Exhaustive approach and Dynnibal (with re-embedding) despite never needing to re-embed.</p>
</div>
<div class="ltx_para" id="S5.SS1.p7">
<p class="ltx_p" id="S5.SS1.p7.1">We also report timing comparisons in terms of steps-per-second between corrector networks (of two sizes) and exhaustive re-encoding of the targets. These can be found in table <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S5.T2" title="Table 2 ‣ 5.1 Supervised Dense Retrieval ‣ 5 Experiments ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">2</span></a>. We can see that both small and large corrector networks lead large speed gains over exhaustive re-encoding with minimal performance gains. This indicates that corrector networks can have practical training time efficiency gains over exhaustive methods.</p>
</div>
<div class="ltx_para" id="S5.SS1.p8">
<p class="ltx_p" id="S5.SS1.p8.1">See Appendix <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#A2.SS2" title="B.2 Additional Dense Retrieval Results ‣ Appendix B Experiments ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">B.2</span></a> for additional results (MSMARCO, other ablations) and further discussion.</p>
</div>
<figure class="ltx_table" id="S5.T3">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T3.1.2.1">
<th class="ltx_td ltx_nopad_r ltx_th ltx_th_row ltx_border_tt" id="S5.T3.1.2.1.1"></th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T3.1.2.1.2">Re-embed</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="S5.T3.1.2.1.3">Retr.</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="S5.T3.1.2.1.4">NQ</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="S5.T3.1.2.1.5">TQA</th>
<th class="ltx_td ltx_nopad_r ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="S5.T3.1.2.1.6">HPQA</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.1.1">
<th class="ltx_td ltx_nopad_r ltx_th ltx_th_row" id="S5.T3.1.1.2"></th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_column ltx_th_row" id="S5.T3.1.1.1">Num. (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T3.1.1.1.m1.1"><semantics id="S5.T3.1.1.1.m1.1a"><mo id="S5.T3.1.1.1.m1.1.1" stretchy="false" xref="S5.T3.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T3.1.1.1.m1.1b"><ci id="S5.T3.1.1.1.m1.1.1.cmml" xref="S5.T3.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.1.1.1.m1.1d">↓</annotation></semantics></math>)</th>
<th class="ltx_td ltx_th ltx_th_column" id="S5.T3.1.1.3"></th>
<th class="ltx_td ltx_th ltx_th_column" id="S5.T3.1.1.4"></th>
<th class="ltx_td ltx_th ltx_th_column" id="S5.T3.1.1.5"></th>
<td class="ltx_td" id="S5.T3.1.1.6"></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.3.1">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S5.T3.1.3.1.1">No Retr.</th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S5.T3.1.3.1.2">0</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S5.T3.1.3.1.3">-</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S5.T3.1.3.1.4">25.4</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S5.T3.1.3.1.5">26.1</th>
<th class="ltx_td ltx_nopad_r ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S5.T3.1.3.1.6">14.5</th>
</tr>
<tr class="ltx_tr" id="S5.T3.1.4.2">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T3.1.4.2.1">Frozen Retr.</th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_row ltx_border_t" id="S5.T3.1.4.2.2">0</th>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T3.1.4.2.3">GTR</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T3.1.4.2.4">48.4</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T3.1.4.2.5">55.1</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S5.T3.1.4.2.6">28.0</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.5.3">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S5.T3.1.5.3.1">Corrector</th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_row" id="S5.T3.1.5.3.2">0</th>
<td class="ltx_td ltx_align_right" id="S5.T3.1.5.3.3">GTR</td>
<td class="ltx_td ltx_align_right" id="S5.T3.1.5.3.4">52.3</td>
<td class="ltx_td ltx_align_right" id="S5.T3.1.5.3.5">66.4</td>
<td class="ltx_td ltx_nopad_r ltx_align_right" id="S5.T3.1.5.3.6">36.7</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.6.4">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S5.T3.1.6.4.1">Exhaustive</th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_row" id="S5.T3.1.6.4.2">1.1B</th>
<td class="ltx_td ltx_align_right" id="S5.T3.1.6.4.3">GTR</td>
<td class="ltx_td ltx_align_right" id="S5.T3.1.6.4.4">52.4</td>
<td class="ltx_td ltx_align_right" id="S5.T3.1.6.4.5">66.5</td>
<td class="ltx_td ltx_nopad_r ltx_align_right" id="S5.T3.1.6.4.6">33.8</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.7.5">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T3.1.7.5.1">Frozen Retr.</th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_row ltx_border_t" id="S5.T3.1.7.5.2">0</th>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T3.1.7.5.3">T5</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T3.1.7.5.4">13.34</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T3.1.7.5.5">12.15</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S5.T3.1.7.5.6">13.37</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.8.6">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="S5.T3.1.8.6.1">Corrector</th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_row" id="S5.T3.1.8.6.2">0</th>
<td class="ltx_td ltx_align_right" id="S5.T3.1.8.6.3">T5</td>
<td class="ltx_td ltx_align_right" id="S5.T3.1.8.6.4">48.1</td>
<td class="ltx_td ltx_align_right" id="S5.T3.1.8.6.5">63.73</td>
<td class="ltx_td ltx_nopad_r ltx_align_right" id="S5.T3.1.8.6.6">21.97</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.9.7">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T3.1.9.7.1">Exhaustive</th>
<th class="ltx_td ltx_nopad_l ltx_align_right ltx_th ltx_th_row ltx_border_bb" id="S5.T3.1.9.7.2">1.1B</th>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T3.1.9.7.3">T5</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T3.1.9.7.4">48.3</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T3.1.9.7.5">66.03</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb" id="S5.T3.1.9.7.6">25.45</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span><span class="ltx_text ltx_font_bold" id="S5.T3.3.1">Exact Match Accuracy, RLM Training</span>. We find that our target corrector approach can match the performance of the fully refreshed index while never re-embedding the targets across NQ, TriviaQA (TQA), and HotPotQA (HPQA).</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Retrieval Augmented Language Models</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p1.1.1">Setting &amp; Metrics </span> We evaluate the latent variable use case of training the retriever in a retrieval-augmented language model (RLM), as described in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S3.SS1" title="3.1 Latent Variables in Retrieval Augmented Models ‣ 3 Improving Training with Target Correctors ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">3.1</span></a>. We will compare approaches for training in terms of their re-embedding costs.</p>
</div>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p2.1.1">Datasets </span> We evaluate on the three question answering datasets: TriviaQA <cite class="ltx_cite ltx_citemacro_citep">(Joshi et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib16" title="">2017</a>)</cite>, NQOpen <cite class="ltx_cite ltx_citemacro_citep">(Kwiatkowski et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib19" title="">2019</a>)</cite>, and HotPotQA <cite class="ltx_cite ltx_citemacro_citep">(Yang et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib40" title="">2018</a>)</cite>. We use 256 token passages from a 2018 Wikipedia snapshot as the collection of targets, <math alttext="\mathcal{Y}" class="ltx_Math" display="inline" id="S5.SS2.p2.1.m1.1"><semantics id="S5.SS2.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.1b"><ci id="S5.SS2.p2.1.m1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.1c">\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.1.m1.1d">caligraphic_Y</annotation></semantics></math>, with 28M targets.</p>
</div>
<div class="ltx_para" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p3.1.1">Models </span> We initialize the retriever with GTR-base or T5-base and use T5-base as the reader in Fusion-In-Decoder <cite class="ltx_cite ltx_citemacro_citep">(Izacard &amp; Grave, <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib14" title="">2021</a>)</cite>. We use 32 retrieved documents in all experiments. The target corrector is a two-layer MLP.</p>
</div>
<div class="ltx_para" id="S5.SS2.p4">
<p class="ltx_p" id="S5.SS2.p4.1">We compare the following approaches: <span class="ltx_text ltx_font_bold" id="S5.SS2.p4.1.1">Target Corrector Network</span>: Target corrector is used to retrieve <math alttext="S(\mathcal{Y})" class="ltx_Math" display="inline" id="S5.SS2.p4.1.m1.1"><semantics id="S5.SS2.p4.1.m1.1a"><mrow id="S5.SS2.p4.1.m1.1.2" xref="S5.SS2.p4.1.m1.1.2.cmml"><mi id="S5.SS2.p4.1.m1.1.2.2" xref="S5.SS2.p4.1.m1.1.2.2.cmml">S</mi><mo id="S5.SS2.p4.1.m1.1.2.1" xref="S5.SS2.p4.1.m1.1.2.1.cmml">⁢</mo><mrow id="S5.SS2.p4.1.m1.1.2.3.2" xref="S5.SS2.p4.1.m1.1.2.cmml"><mo id="S5.SS2.p4.1.m1.1.2.3.2.1" stretchy="false" xref="S5.SS2.p4.1.m1.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S5.SS2.p4.1.m1.1.1" xref="S5.SS2.p4.1.m1.1.1.cmml">𝒴</mi><mo id="S5.SS2.p4.1.m1.1.2.3.2.2" stretchy="false" xref="S5.SS2.p4.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.1.m1.1b"><apply id="S5.SS2.p4.1.m1.1.2.cmml" xref="S5.SS2.p4.1.m1.1.2"><times id="S5.SS2.p4.1.m1.1.2.1.cmml" xref="S5.SS2.p4.1.m1.1.2.1"></times><ci id="S5.SS2.p4.1.m1.1.2.2.cmml" xref="S5.SS2.p4.1.m1.1.2.2">𝑆</ci><ci id="S5.SS2.p4.1.m1.1.1.cmml" xref="S5.SS2.p4.1.m1.1.1">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.1.m1.1c">S(\mathcal{Y})</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p4.1.m1.1d">italic_S ( caligraphic_Y )</annotation></semantics></math> at training time. We embed the targets at the beginning of training and never update the buffer. <span class="ltx_text ltx_font_bold" id="S5.SS2.p4.1.2">No Retrieval</span> <cite class="ltx_cite ltx_citemacro_citep">(Roberts et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib33" title="">2020</a>)</cite>: The retriever is not used. The reader model is trained on the dataset and uses only its parameters to answer the questions. <span class="ltx_text ltx_font_bold" id="S5.SS2.p4.1.3">Frozen Retrieval</span> <cite class="ltx_cite ltx_citemacro_citep">(Izacard &amp; Grave, <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib14" title="">2021</a>)</cite>: Every target is embedded once at the beginning of training. Only the parameters of the reader model are trained (updating the retriever parameters did not improve performance). <span class="ltx_text ltx_font_bold" id="S5.SS2.p4.1.4">Exhaustive</span>: Jointly training the retriever and reader, we exhaustively re-embed all 28M targets every 500 steps.</p>
</div>
<div class="ltx_para" id="S5.SS2.p5">
<p class="ltx_p" id="S5.SS2.p5.1">In Table <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S5.T3" title="Table 3 ‣ 5.1 Supervised Dense Retrieval ‣ 5 Experiments ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">3</span></a>, we report exact match accuracy on the held-out validation sets. Our proposed target corrector matches or nearly matches the performance of the exhaustive re-embedding approach without ever having to re-embed the buffer. This is a dramatic reduction in computational cost, as the exhaustive approach ends up embedding all 28M passages 40 times (1.1B re-embeddings). Target correctors greatly outperform the approaches that do not use retrieval (by more than 20 points) and the frozen retriever approach (by at least 4 points and by up to 10 points).</p>
</div>
<figure class="ltx_figure" id="S5.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="313" id="S5.F3.g1" src="extracted/5830607/fraction_of_targets.png" width="568"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span class="ltx_text ltx_font_bold" id="S5.F3.6.1">Training Sample Size</span> The figure shows the trade-offs between the complexity of <math alttext="h" class="ltx_Math" display="inline" id="S5.F3.3.m1.1"><semantics id="S5.F3.3.m1.1b"><mi id="S5.F3.3.m1.1.1" xref="S5.F3.3.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S5.F3.3.m1.1c"><ci id="S5.F3.3.m1.1.1.cmml" xref="S5.F3.3.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.3.m1.1d">h</annotation><annotation encoding="application/x-llamapun" id="S5.F3.3.m1.1e">italic_h</annotation></semantics></math> (parameter count), the approximation error, <math alttext="KL(P||P_{h})" class="ltx_math_unparsed" display="inline" id="S5.F3.4.m2.1"><semantics id="S5.F3.4.m2.1b"><mrow id="S5.F3.4.m2.1c"><mi id="S5.F3.4.m2.1.1">K</mi><mi id="S5.F3.4.m2.1.2">L</mi><mrow id="S5.F3.4.m2.1.3"><mo id="S5.F3.4.m2.1.3.1" stretchy="false">(</mo><mi id="S5.F3.4.m2.1.3.2">P</mi><mo fence="false" id="S5.F3.4.m2.1.3.3" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="S5.F3.4.m2.1.3.4" rspace="0.167em" stretchy="false">|</mo><msub id="S5.F3.4.m2.1.3.5"><mi id="S5.F3.4.m2.1.3.5.2">P</mi><mi id="S5.F3.4.m2.1.3.5.3">h</mi></msub><mo id="S5.F3.4.m2.1.3.6" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S5.F3.4.m2.1d">KL(P||P_{h})</annotation><annotation encoding="application/x-llamapun" id="S5.F3.4.m2.1e">italic_K italic_L ( italic_P | | italic_P start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT )</annotation></semantics></math>, and the fraction of samples used for training. The left hand side shows only somewhat stale representations. The right hand side shows significantly stale representations. Using a higher fraction of training samples is needed with more staleness.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Synthetic Experiments</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">In these experiments, we measure the ability of proposed
corrector network to approximate categorical distributions parameterized by the softmax by training the corrector network, <math alttext="h" class="ltx_Math" display="inline" id="S5.SS3.p1.1.m1.1"><semantics id="S5.SS3.p1.1.m1.1a"><mi id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><ci id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">h</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.1.m1.1d">italic_h</annotation></semantics></math>, without training parameters of the dual-encoder.</p>
</div>
<div class="ltx_para" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.7"><span class="ltx_text ltx_font_bold" id="S5.SS3.p2.7.1">Setting &amp; Metrics</span> We will measure the ability of proposed
corrector network to approximate categorical distributions parameterized by the softmax. We do so by training the corrector network, <math alttext="h" class="ltx_Math" display="inline" id="S5.SS3.p2.1.m1.1"><semantics id="S5.SS3.p2.1.m1.1a"><mi id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><ci id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">h</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.1.m1.1d">italic_h</annotation></semantics></math>, in isolation, e.g., only training the parameters of the corrector network, <math alttext="\Psi" class="ltx_Math" display="inline" id="S5.SS3.p2.2.m2.1"><semantics id="S5.SS3.p2.2.m2.1a"><mi id="S5.SS3.p2.2.m2.1.1" mathvariant="normal" xref="S5.SS3.p2.2.m2.1.1.cmml">Ψ</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.2.m2.1b"><ci id="S5.SS3.p2.2.m2.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1">Ψ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.2.m2.1c">\Psi</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.2.m2.1d">roman_Ψ</annotation></semantics></math>, without training parameters of the dual-encoder for a particular task. We measure the quality of approximation using the KL-divergence between the true categorical distribution <math alttext="P(y|x)" class="ltx_Math" display="inline" id="S5.SS3.p2.3.m3.1"><semantics id="S5.SS3.p2.3.m3.1a"><mrow id="S5.SS3.p2.3.m3.1.1" xref="S5.SS3.p2.3.m3.1.1.cmml"><mi id="S5.SS3.p2.3.m3.1.1.3" xref="S5.SS3.p2.3.m3.1.1.3.cmml">P</mi><mo id="S5.SS3.p2.3.m3.1.1.2" xref="S5.SS3.p2.3.m3.1.1.2.cmml">⁢</mo><mrow id="S5.SS3.p2.3.m3.1.1.1.1" xref="S5.SS3.p2.3.m3.1.1.1.1.1.cmml"><mo id="S5.SS3.p2.3.m3.1.1.1.1.2" stretchy="false" xref="S5.SS3.p2.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS3.p2.3.m3.1.1.1.1.1" xref="S5.SS3.p2.3.m3.1.1.1.1.1.cmml"><mi id="S5.SS3.p2.3.m3.1.1.1.1.1.2" xref="S5.SS3.p2.3.m3.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S5.SS3.p2.3.m3.1.1.1.1.1.1" xref="S5.SS3.p2.3.m3.1.1.1.1.1.1.cmml">|</mo><mi id="S5.SS3.p2.3.m3.1.1.1.1.1.3" xref="S5.SS3.p2.3.m3.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S5.SS3.p2.3.m3.1.1.1.1.3" stretchy="false" xref="S5.SS3.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.3.m3.1b"><apply id="S5.SS3.p2.3.m3.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1"><times id="S5.SS3.p2.3.m3.1.1.2.cmml" xref="S5.SS3.p2.3.m3.1.1.2"></times><ci id="S5.SS3.p2.3.m3.1.1.3.cmml" xref="S5.SS3.p2.3.m3.1.1.3">𝑃</ci><apply id="S5.SS3.p2.3.m3.1.1.1.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1.1.1"><csymbol cd="latexml" id="S5.SS3.p2.3.m3.1.1.1.1.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S5.SS3.p2.3.m3.1.1.1.1.1.2.cmml" xref="S5.SS3.p2.3.m3.1.1.1.1.1.2">𝑦</ci><ci id="S5.SS3.p2.3.m3.1.1.1.1.1.3.cmml" xref="S5.SS3.p2.3.m3.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.3.m3.1c">P(y|x)</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.3.m3.1d">italic_P ( italic_y | italic_x )</annotation></semantics></math> (Equation <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S2.E1" title="In 2 Background ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">1</span></a>) and the approximate distribution given by the corrector network <math alttext="P_{h}(y|x)" class="ltx_Math" display="inline" id="S5.SS3.p2.4.m4.1"><semantics id="S5.SS3.p2.4.m4.1a"><mrow id="S5.SS3.p2.4.m4.1.1" xref="S5.SS3.p2.4.m4.1.1.cmml"><msub id="S5.SS3.p2.4.m4.1.1.3" xref="S5.SS3.p2.4.m4.1.1.3.cmml"><mi id="S5.SS3.p2.4.m4.1.1.3.2" xref="S5.SS3.p2.4.m4.1.1.3.2.cmml">P</mi><mi id="S5.SS3.p2.4.m4.1.1.3.3" xref="S5.SS3.p2.4.m4.1.1.3.3.cmml">h</mi></msub><mo id="S5.SS3.p2.4.m4.1.1.2" xref="S5.SS3.p2.4.m4.1.1.2.cmml">⁢</mo><mrow id="S5.SS3.p2.4.m4.1.1.1.1" xref="S5.SS3.p2.4.m4.1.1.1.1.1.cmml"><mo id="S5.SS3.p2.4.m4.1.1.1.1.2" stretchy="false" xref="S5.SS3.p2.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS3.p2.4.m4.1.1.1.1.1" xref="S5.SS3.p2.4.m4.1.1.1.1.1.cmml"><mi id="S5.SS3.p2.4.m4.1.1.1.1.1.2" xref="S5.SS3.p2.4.m4.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S5.SS3.p2.4.m4.1.1.1.1.1.1" xref="S5.SS3.p2.4.m4.1.1.1.1.1.1.cmml">|</mo><mi id="S5.SS3.p2.4.m4.1.1.1.1.1.3" xref="S5.SS3.p2.4.m4.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S5.SS3.p2.4.m4.1.1.1.1.3" stretchy="false" xref="S5.SS3.p2.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.4.m4.1b"><apply id="S5.SS3.p2.4.m4.1.1.cmml" xref="S5.SS3.p2.4.m4.1.1"><times id="S5.SS3.p2.4.m4.1.1.2.cmml" xref="S5.SS3.p2.4.m4.1.1.2"></times><apply id="S5.SS3.p2.4.m4.1.1.3.cmml" xref="S5.SS3.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.p2.4.m4.1.1.3.1.cmml" xref="S5.SS3.p2.4.m4.1.1.3">subscript</csymbol><ci id="S5.SS3.p2.4.m4.1.1.3.2.cmml" xref="S5.SS3.p2.4.m4.1.1.3.2">𝑃</ci><ci id="S5.SS3.p2.4.m4.1.1.3.3.cmml" xref="S5.SS3.p2.4.m4.1.1.3.3">ℎ</ci></apply><apply id="S5.SS3.p2.4.m4.1.1.1.1.1.cmml" xref="S5.SS3.p2.4.m4.1.1.1.1"><csymbol cd="latexml" id="S5.SS3.p2.4.m4.1.1.1.1.1.1.cmml" xref="S5.SS3.p2.4.m4.1.1.1.1.1.1">conditional</csymbol><ci id="S5.SS3.p2.4.m4.1.1.1.1.1.2.cmml" xref="S5.SS3.p2.4.m4.1.1.1.1.1.2">𝑦</ci><ci id="S5.SS3.p2.4.m4.1.1.1.1.1.3.cmml" xref="S5.SS3.p2.4.m4.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.4.m4.1c">P_{h}(y|x)</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.4.m4.1d">italic_P start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ( italic_y | italic_x )</annotation></semantics></math> (Equation <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S3.E4" title="In 3 Improving Training with Target Correctors ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">4</span></a>). We measure the complexity of the corrector network by its parameter count, <math alttext="|\Psi|" class="ltx_Math" display="inline" id="S5.SS3.p2.5.m5.1"><semantics id="S5.SS3.p2.5.m5.1a"><mrow id="S5.SS3.p2.5.m5.1.2.2" xref="S5.SS3.p2.5.m5.1.2.1.cmml"><mo id="S5.SS3.p2.5.m5.1.2.2.1" stretchy="false" xref="S5.SS3.p2.5.m5.1.2.1.1.cmml">|</mo><mi id="S5.SS3.p2.5.m5.1.1" mathvariant="normal" xref="S5.SS3.p2.5.m5.1.1.cmml">Ψ</mi><mo id="S5.SS3.p2.5.m5.1.2.2.2" stretchy="false" xref="S5.SS3.p2.5.m5.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.5.m5.1b"><apply id="S5.SS3.p2.5.m5.1.2.1.cmml" xref="S5.SS3.p2.5.m5.1.2.2"><abs id="S5.SS3.p2.5.m5.1.2.1.1.cmml" xref="S5.SS3.p2.5.m5.1.2.2.1"></abs><ci id="S5.SS3.p2.5.m5.1.1.cmml" xref="S5.SS3.p2.5.m5.1.1">Ψ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.5.m5.1c">|\Psi|</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.5.m5.1d">| roman_Ψ |</annotation></semantics></math>. We measure staleness, i.e., the difficulty of correcting a set of stale representations, by the KL-divergence between the true categorical distribution <math alttext="P(y|x)" class="ltx_Math" display="inline" id="S5.SS3.p2.6.m6.1"><semantics id="S5.SS3.p2.6.m6.1a"><mrow id="S5.SS3.p2.6.m6.1.1" xref="S5.SS3.p2.6.m6.1.1.cmml"><mi id="S5.SS3.p2.6.m6.1.1.3" xref="S5.SS3.p2.6.m6.1.1.3.cmml">P</mi><mo id="S5.SS3.p2.6.m6.1.1.2" xref="S5.SS3.p2.6.m6.1.1.2.cmml">⁢</mo><mrow id="S5.SS3.p2.6.m6.1.1.1.1" xref="S5.SS3.p2.6.m6.1.1.1.1.1.cmml"><mo id="S5.SS3.p2.6.m6.1.1.1.1.2" stretchy="false" xref="S5.SS3.p2.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS3.p2.6.m6.1.1.1.1.1" xref="S5.SS3.p2.6.m6.1.1.1.1.1.cmml"><mi id="S5.SS3.p2.6.m6.1.1.1.1.1.2" xref="S5.SS3.p2.6.m6.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S5.SS3.p2.6.m6.1.1.1.1.1.1" xref="S5.SS3.p2.6.m6.1.1.1.1.1.1.cmml">|</mo><mi id="S5.SS3.p2.6.m6.1.1.1.1.1.3" xref="S5.SS3.p2.6.m6.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S5.SS3.p2.6.m6.1.1.1.1.3" stretchy="false" xref="S5.SS3.p2.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.6.m6.1b"><apply id="S5.SS3.p2.6.m6.1.1.cmml" xref="S5.SS3.p2.6.m6.1.1"><times id="S5.SS3.p2.6.m6.1.1.2.cmml" xref="S5.SS3.p2.6.m6.1.1.2"></times><ci id="S5.SS3.p2.6.m6.1.1.3.cmml" xref="S5.SS3.p2.6.m6.1.1.3">𝑃</ci><apply id="S5.SS3.p2.6.m6.1.1.1.1.1.cmml" xref="S5.SS3.p2.6.m6.1.1.1.1"><csymbol cd="latexml" id="S5.SS3.p2.6.m6.1.1.1.1.1.1.cmml" xref="S5.SS3.p2.6.m6.1.1.1.1.1.1">conditional</csymbol><ci id="S5.SS3.p2.6.m6.1.1.1.1.1.2.cmml" xref="S5.SS3.p2.6.m6.1.1.1.1.1.2">𝑦</ci><ci id="S5.SS3.p2.6.m6.1.1.1.1.1.3.cmml" xref="S5.SS3.p2.6.m6.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.6.m6.1c">P(y|x)</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.6.m6.1d">italic_P ( italic_y | italic_x )</annotation></semantics></math> and the distribution <math alttext="P_{g^{\prime}}(y|x)\propto\exp(\beta\langle f(x),g^{\prime}(y)\rangle)" class="ltx_Math" display="inline" id="S5.SS3.p2.7.m7.5"><semantics id="S5.SS3.p2.7.m7.5a"><mrow id="S5.SS3.p2.7.m7.5.5" xref="S5.SS3.p2.7.m7.5.5.cmml"><mrow id="S5.SS3.p2.7.m7.4.4.1" xref="S5.SS3.p2.7.m7.4.4.1.cmml"><msub id="S5.SS3.p2.7.m7.4.4.1.3" xref="S5.SS3.p2.7.m7.4.4.1.3.cmml"><mi id="S5.SS3.p2.7.m7.4.4.1.3.2" xref="S5.SS3.p2.7.m7.4.4.1.3.2.cmml">P</mi><msup id="S5.SS3.p2.7.m7.4.4.1.3.3" xref="S5.SS3.p2.7.m7.4.4.1.3.3.cmml"><mi id="S5.SS3.p2.7.m7.4.4.1.3.3.2" xref="S5.SS3.p2.7.m7.4.4.1.3.3.2.cmml">g</mi><mo id="S5.SS3.p2.7.m7.4.4.1.3.3.3" xref="S5.SS3.p2.7.m7.4.4.1.3.3.3.cmml">′</mo></msup></msub><mo id="S5.SS3.p2.7.m7.4.4.1.2" xref="S5.SS3.p2.7.m7.4.4.1.2.cmml">⁢</mo><mrow id="S5.SS3.p2.7.m7.4.4.1.1.1" xref="S5.SS3.p2.7.m7.4.4.1.1.1.1.cmml"><mo id="S5.SS3.p2.7.m7.4.4.1.1.1.2" stretchy="false" xref="S5.SS3.p2.7.m7.4.4.1.1.1.1.cmml">(</mo><mrow id="S5.SS3.p2.7.m7.4.4.1.1.1.1" xref="S5.SS3.p2.7.m7.4.4.1.1.1.1.cmml"><mi id="S5.SS3.p2.7.m7.4.4.1.1.1.1.2" xref="S5.SS3.p2.7.m7.4.4.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S5.SS3.p2.7.m7.4.4.1.1.1.1.1" xref="S5.SS3.p2.7.m7.4.4.1.1.1.1.1.cmml">|</mo><mi id="S5.SS3.p2.7.m7.4.4.1.1.1.1.3" xref="S5.SS3.p2.7.m7.4.4.1.1.1.1.3.cmml">x</mi></mrow><mo id="S5.SS3.p2.7.m7.4.4.1.1.1.3" stretchy="false" xref="S5.SS3.p2.7.m7.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.SS3.p2.7.m7.5.5.3" xref="S5.SS3.p2.7.m7.5.5.3.cmml">∝</mo><mrow id="S5.SS3.p2.7.m7.5.5.2.1" xref="S5.SS3.p2.7.m7.5.5.2.2.cmml"><mi id="S5.SS3.p2.7.m7.3.3" xref="S5.SS3.p2.7.m7.3.3.cmml">exp</mi><mo id="S5.SS3.p2.7.m7.5.5.2.1a" xref="S5.SS3.p2.7.m7.5.5.2.2.cmml">⁡</mo><mrow id="S5.SS3.p2.7.m7.5.5.2.1.1" xref="S5.SS3.p2.7.m7.5.5.2.2.cmml"><mo id="S5.SS3.p2.7.m7.5.5.2.1.1.2" stretchy="false" xref="S5.SS3.p2.7.m7.5.5.2.2.cmml">(</mo><mrow id="S5.SS3.p2.7.m7.5.5.2.1.1.1" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.cmml"><mi id="S5.SS3.p2.7.m7.5.5.2.1.1.1.4" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.4.cmml">β</mi><mo id="S5.SS3.p2.7.m7.5.5.2.1.1.1.3" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.3.cmml">⁢</mo><mrow id="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.3.cmml"><mo id="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.3" stretchy="false" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.3.cmml">⟨</mo><mrow id="S5.SS3.p2.7.m7.5.5.2.1.1.1.1.1.1" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.1.1.1.cmml"><mi id="S5.SS3.p2.7.m7.5.5.2.1.1.1.1.1.1.2" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.1.1.1.2.cmml">f</mi><mo id="S5.SS3.p2.7.m7.5.5.2.1.1.1.1.1.1.1" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S5.SS3.p2.7.m7.5.5.2.1.1.1.1.1.1.3.2" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.1.1.1.cmml"><mo id="S5.SS3.p2.7.m7.5.5.2.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.1.1.1.cmml">(</mo><mi id="S5.SS3.p2.7.m7.1.1" xref="S5.SS3.p2.7.m7.1.1.cmml">x</mi><mo id="S5.SS3.p2.7.m7.5.5.2.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.4" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.3.cmml">,</mo><mrow id="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2.cmml"><msup id="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2.2" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2.2.cmml"><mi id="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2.2.2" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2.2.2.cmml">g</mi><mo id="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2.2.3" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2.2.3.cmml">′</mo></msup><mo id="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2.1" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2.1.cmml">⁢</mo><mrow id="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2.3.2" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2.cmml"><mo id="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2.3.2.1" stretchy="false" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2.cmml">(</mo><mi id="S5.SS3.p2.7.m7.2.2" xref="S5.SS3.p2.7.m7.2.2.cmml">y</mi><mo id="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2.3.2.2" stretchy="false" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2.cmml">)</mo></mrow></mrow><mo id="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.5" stretchy="false" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.3.cmml">⟩</mo></mrow></mrow><mo id="S5.SS3.p2.7.m7.5.5.2.1.1.3" stretchy="false" xref="S5.SS3.p2.7.m7.5.5.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.7.m7.5b"><apply id="S5.SS3.p2.7.m7.5.5.cmml" xref="S5.SS3.p2.7.m7.5.5"><csymbol cd="latexml" id="S5.SS3.p2.7.m7.5.5.3.cmml" xref="S5.SS3.p2.7.m7.5.5.3">proportional-to</csymbol><apply id="S5.SS3.p2.7.m7.4.4.1.cmml" xref="S5.SS3.p2.7.m7.4.4.1"><times id="S5.SS3.p2.7.m7.4.4.1.2.cmml" xref="S5.SS3.p2.7.m7.4.4.1.2"></times><apply id="S5.SS3.p2.7.m7.4.4.1.3.cmml" xref="S5.SS3.p2.7.m7.4.4.1.3"><csymbol cd="ambiguous" id="S5.SS3.p2.7.m7.4.4.1.3.1.cmml" xref="S5.SS3.p2.7.m7.4.4.1.3">subscript</csymbol><ci id="S5.SS3.p2.7.m7.4.4.1.3.2.cmml" xref="S5.SS3.p2.7.m7.4.4.1.3.2">𝑃</ci><apply id="S5.SS3.p2.7.m7.4.4.1.3.3.cmml" xref="S5.SS3.p2.7.m7.4.4.1.3.3"><csymbol cd="ambiguous" id="S5.SS3.p2.7.m7.4.4.1.3.3.1.cmml" xref="S5.SS3.p2.7.m7.4.4.1.3.3">superscript</csymbol><ci id="S5.SS3.p2.7.m7.4.4.1.3.3.2.cmml" xref="S5.SS3.p2.7.m7.4.4.1.3.3.2">𝑔</ci><ci id="S5.SS3.p2.7.m7.4.4.1.3.3.3.cmml" xref="S5.SS3.p2.7.m7.4.4.1.3.3.3">′</ci></apply></apply><apply id="S5.SS3.p2.7.m7.4.4.1.1.1.1.cmml" xref="S5.SS3.p2.7.m7.4.4.1.1.1"><csymbol cd="latexml" id="S5.SS3.p2.7.m7.4.4.1.1.1.1.1.cmml" xref="S5.SS3.p2.7.m7.4.4.1.1.1.1.1">conditional</csymbol><ci id="S5.SS3.p2.7.m7.4.4.1.1.1.1.2.cmml" xref="S5.SS3.p2.7.m7.4.4.1.1.1.1.2">𝑦</ci><ci id="S5.SS3.p2.7.m7.4.4.1.1.1.1.3.cmml" xref="S5.SS3.p2.7.m7.4.4.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S5.SS3.p2.7.m7.5.5.2.2.cmml" xref="S5.SS3.p2.7.m7.5.5.2.1"><exp id="S5.SS3.p2.7.m7.3.3.cmml" xref="S5.SS3.p2.7.m7.3.3"></exp><apply id="S5.SS3.p2.7.m7.5.5.2.1.1.1.cmml" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1"><times id="S5.SS3.p2.7.m7.5.5.2.1.1.1.3.cmml" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.3"></times><ci id="S5.SS3.p2.7.m7.5.5.2.1.1.1.4.cmml" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.4">𝛽</ci><list id="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.3.cmml" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2"><apply id="S5.SS3.p2.7.m7.5.5.2.1.1.1.1.1.1.cmml" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.1.1.1"><times id="S5.SS3.p2.7.m7.5.5.2.1.1.1.1.1.1.1.cmml" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.1.1.1.1"></times><ci id="S5.SS3.p2.7.m7.5.5.2.1.1.1.1.1.1.2.cmml" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.1.1.1.2">𝑓</ci><ci id="S5.SS3.p2.7.m7.1.1.cmml" xref="S5.SS3.p2.7.m7.1.1">𝑥</ci></apply><apply id="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2.cmml" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2"><times id="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2.1.cmml" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2.1"></times><apply id="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2.2.cmml" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2.2.1.cmml" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2.2">superscript</csymbol><ci id="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2.2.2.cmml" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2.2.2">𝑔</ci><ci id="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2.2.3.cmml" xref="S5.SS3.p2.7.m7.5.5.2.1.1.1.2.2.2.2.3">′</ci></apply><ci id="S5.SS3.p2.7.m7.2.2.cmml" xref="S5.SS3.p2.7.m7.2.2">𝑦</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.7.m7.5c">P_{g^{\prime}}(y|x)\propto\exp(\beta\langle f(x),g^{\prime}(y)\rangle)</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.7.m7.5d">italic_P start_POSTSUBSCRIPT italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_y | italic_x ) ∝ roman_exp ( italic_β ⟨ italic_f ( italic_x ) , italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y ) ⟩ )</annotation></semantics></math>.</p>
</div>
<figure class="ltx_figure" id="S5.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="323" id="S5.F4.g1" src="extracted/5830607/quality_of_approximation.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span class="ltx_text ltx_font_bold" id="S5.F4.8.1">Parameter Count</span> We plot the
KL divergence using the stale embeddings (<math alttext="\operatorname{KL}(P\|P_{g^{\prime}})" class="ltx_Math" display="inline" id="S5.F4.4.m1.2"><semantics id="S5.F4.4.m1.2b"><mrow id="S5.F4.4.m1.2.2.1" xref="S5.F4.4.m1.2.2.2.cmml"><mi id="S5.F4.4.m1.1.1" xref="S5.F4.4.m1.1.1.cmml">KL</mi><mo id="S5.F4.4.m1.2.2.1b" xref="S5.F4.4.m1.2.2.2.cmml">⁡</mo><mrow id="S5.F4.4.m1.2.2.1.1" xref="S5.F4.4.m1.2.2.2.cmml"><mo id="S5.F4.4.m1.2.2.1.1.2" stretchy="false" xref="S5.F4.4.m1.2.2.2.cmml">(</mo><mrow id="S5.F4.4.m1.2.2.1.1.1" xref="S5.F4.4.m1.2.2.1.1.1.cmml"><mi id="S5.F4.4.m1.2.2.1.1.1.2" xref="S5.F4.4.m1.2.2.1.1.1.2.cmml">P</mi><mo id="S5.F4.4.m1.2.2.1.1.1.1" xref="S5.F4.4.m1.2.2.1.1.1.1.cmml">∥</mo><msub id="S5.F4.4.m1.2.2.1.1.1.3" xref="S5.F4.4.m1.2.2.1.1.1.3.cmml"><mi id="S5.F4.4.m1.2.2.1.1.1.3.2" xref="S5.F4.4.m1.2.2.1.1.1.3.2.cmml">P</mi><msup id="S5.F4.4.m1.2.2.1.1.1.3.3" xref="S5.F4.4.m1.2.2.1.1.1.3.3.cmml"><mi id="S5.F4.4.m1.2.2.1.1.1.3.3.2" xref="S5.F4.4.m1.2.2.1.1.1.3.3.2.cmml">g</mi><mo id="S5.F4.4.m1.2.2.1.1.1.3.3.3" xref="S5.F4.4.m1.2.2.1.1.1.3.3.3.cmml">′</mo></msup></msub></mrow><mo id="S5.F4.4.m1.2.2.1.1.3" stretchy="false" xref="S5.F4.4.m1.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.F4.4.m1.2c"><apply id="S5.F4.4.m1.2.2.2.cmml" xref="S5.F4.4.m1.2.2.1"><ci id="S5.F4.4.m1.1.1.cmml" xref="S5.F4.4.m1.1.1">KL</ci><apply id="S5.F4.4.m1.2.2.1.1.1.cmml" xref="S5.F4.4.m1.2.2.1.1.1"><csymbol cd="latexml" id="S5.F4.4.m1.2.2.1.1.1.1.cmml" xref="S5.F4.4.m1.2.2.1.1.1.1">conditional</csymbol><ci id="S5.F4.4.m1.2.2.1.1.1.2.cmml" xref="S5.F4.4.m1.2.2.1.1.1.2">𝑃</ci><apply id="S5.F4.4.m1.2.2.1.1.1.3.cmml" xref="S5.F4.4.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S5.F4.4.m1.2.2.1.1.1.3.1.cmml" xref="S5.F4.4.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S5.F4.4.m1.2.2.1.1.1.3.2.cmml" xref="S5.F4.4.m1.2.2.1.1.1.3.2">𝑃</ci><apply id="S5.F4.4.m1.2.2.1.1.1.3.3.cmml" xref="S5.F4.4.m1.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S5.F4.4.m1.2.2.1.1.1.3.3.1.cmml" xref="S5.F4.4.m1.2.2.1.1.1.3.3">superscript</csymbol><ci id="S5.F4.4.m1.2.2.1.1.1.3.3.2.cmml" xref="S5.F4.4.m1.2.2.1.1.1.3.3.2">𝑔</ci><ci id="S5.F4.4.m1.2.2.1.1.1.3.3.3.cmml" xref="S5.F4.4.m1.2.2.1.1.1.3.3.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.4.m1.2d">\operatorname{KL}(P\|P_{g^{\prime}})</annotation><annotation encoding="application/x-llamapun" id="S5.F4.4.m1.2e">roman_KL ( italic_P ∥ italic_P start_POSTSUBSCRIPT italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math>, on the x-axis) against that of the trained correction models (<math alttext="\operatorname{KL}(P\|P_{h})" class="ltx_Math" display="inline" id="S5.F4.5.m2.2"><semantics id="S5.F4.5.m2.2b"><mrow id="S5.F4.5.m2.2.2.1" xref="S5.F4.5.m2.2.2.2.cmml"><mi id="S5.F4.5.m2.1.1" xref="S5.F4.5.m2.1.1.cmml">KL</mi><mo id="S5.F4.5.m2.2.2.1b" xref="S5.F4.5.m2.2.2.2.cmml">⁡</mo><mrow id="S5.F4.5.m2.2.2.1.1" xref="S5.F4.5.m2.2.2.2.cmml"><mo id="S5.F4.5.m2.2.2.1.1.2" stretchy="false" xref="S5.F4.5.m2.2.2.2.cmml">(</mo><mrow id="S5.F4.5.m2.2.2.1.1.1" xref="S5.F4.5.m2.2.2.1.1.1.cmml"><mi id="S5.F4.5.m2.2.2.1.1.1.2" xref="S5.F4.5.m2.2.2.1.1.1.2.cmml">P</mi><mo id="S5.F4.5.m2.2.2.1.1.1.1" xref="S5.F4.5.m2.2.2.1.1.1.1.cmml">∥</mo><msub id="S5.F4.5.m2.2.2.1.1.1.3" xref="S5.F4.5.m2.2.2.1.1.1.3.cmml"><mi id="S5.F4.5.m2.2.2.1.1.1.3.2" xref="S5.F4.5.m2.2.2.1.1.1.3.2.cmml">P</mi><mi id="S5.F4.5.m2.2.2.1.1.1.3.3" xref="S5.F4.5.m2.2.2.1.1.1.3.3.cmml">h</mi></msub></mrow><mo id="S5.F4.5.m2.2.2.1.1.3" stretchy="false" xref="S5.F4.5.m2.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.F4.5.m2.2c"><apply id="S5.F4.5.m2.2.2.2.cmml" xref="S5.F4.5.m2.2.2.1"><ci id="S5.F4.5.m2.1.1.cmml" xref="S5.F4.5.m2.1.1">KL</ci><apply id="S5.F4.5.m2.2.2.1.1.1.cmml" xref="S5.F4.5.m2.2.2.1.1.1"><csymbol cd="latexml" id="S5.F4.5.m2.2.2.1.1.1.1.cmml" xref="S5.F4.5.m2.2.2.1.1.1.1">conditional</csymbol><ci id="S5.F4.5.m2.2.2.1.1.1.2.cmml" xref="S5.F4.5.m2.2.2.1.1.1.2">𝑃</ci><apply id="S5.F4.5.m2.2.2.1.1.1.3.cmml" xref="S5.F4.5.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S5.F4.5.m2.2.2.1.1.1.3.1.cmml" xref="S5.F4.5.m2.2.2.1.1.1.3">subscript</csymbol><ci id="S5.F4.5.m2.2.2.1.1.1.3.2.cmml" xref="S5.F4.5.m2.2.2.1.1.1.3.2">𝑃</ci><ci id="S5.F4.5.m2.2.2.1.1.1.3.3.cmml" xref="S5.F4.5.m2.2.2.1.1.1.3.3">ℎ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.5.m2.2d">\operatorname{KL}(P\|P_{h})</annotation><annotation encoding="application/x-llamapun" id="S5.F4.5.m2.2e">roman_KL ( italic_P ∥ italic_P start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT )</annotation></semantics></math>, on the y-axis). Parity is indicated by the dashed red line, demonstrating that the trained correction model is significantly better than using the stale embeddings. Increasing the parameter count of <math alttext="h" class="ltx_Math" display="inline" id="S5.F4.6.m3.1"><semantics id="S5.F4.6.m3.1b"><mi id="S5.F4.6.m3.1.1" xref="S5.F4.6.m3.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S5.F4.6.m3.1c"><ci id="S5.F4.6.m3.1.1.cmml" xref="S5.F4.6.m3.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.6.m3.1d">h</annotation><annotation encoding="application/x-llamapun" id="S5.F4.6.m3.1e">italic_h</annotation></semantics></math> is more important when the discrepancy between stale and current embeddings is higher, indicated by a larger improvement toward the right of this plot.</figcaption>
</figure>
<div class="ltx_para" id="S5.SS3.p3">
<p class="ltx_p" id="S5.SS3.p3.12"><span class="ltx_text ltx_font_bold" id="S5.SS3.p3.12.1">Data Generation</span> We directly generate vector representations corresponding to data points and targets. That is, rather than having a dual-encoder model provide the vector representation of a data point or target, we directly generate synthetic data corresponding to <math alttext="f(x)" class="ltx_Math" display="inline" id="S5.SS3.p3.1.m1.1"><semantics id="S5.SS3.p3.1.m1.1a"><mrow id="S5.SS3.p3.1.m1.1.2" xref="S5.SS3.p3.1.m1.1.2.cmml"><mi id="S5.SS3.p3.1.m1.1.2.2" xref="S5.SS3.p3.1.m1.1.2.2.cmml">f</mi><mo id="S5.SS3.p3.1.m1.1.2.1" xref="S5.SS3.p3.1.m1.1.2.1.cmml">⁢</mo><mrow id="S5.SS3.p3.1.m1.1.2.3.2" xref="S5.SS3.p3.1.m1.1.2.cmml"><mo id="S5.SS3.p3.1.m1.1.2.3.2.1" stretchy="false" xref="S5.SS3.p3.1.m1.1.2.cmml">(</mo><mi id="S5.SS3.p3.1.m1.1.1" xref="S5.SS3.p3.1.m1.1.1.cmml">x</mi><mo id="S5.SS3.p3.1.m1.1.2.3.2.2" stretchy="false" xref="S5.SS3.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.1.m1.1b"><apply id="S5.SS3.p3.1.m1.1.2.cmml" xref="S5.SS3.p3.1.m1.1.2"><times id="S5.SS3.p3.1.m1.1.2.1.cmml" xref="S5.SS3.p3.1.m1.1.2.1"></times><ci id="S5.SS3.p3.1.m1.1.2.2.cmml" xref="S5.SS3.p3.1.m1.1.2.2">𝑓</ci><ci id="S5.SS3.p3.1.m1.1.1.cmml" xref="S5.SS3.p3.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.1.m1.1c">f(x)</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.1.m1.1d">italic_f ( italic_x )</annotation></semantics></math>, <math alttext="g(y)" class="ltx_Math" display="inline" id="S5.SS3.p3.2.m2.1"><semantics id="S5.SS3.p3.2.m2.1a"><mrow id="S5.SS3.p3.2.m2.1.2" xref="S5.SS3.p3.2.m2.1.2.cmml"><mi id="S5.SS3.p3.2.m2.1.2.2" xref="S5.SS3.p3.2.m2.1.2.2.cmml">g</mi><mo id="S5.SS3.p3.2.m2.1.2.1" xref="S5.SS3.p3.2.m2.1.2.1.cmml">⁢</mo><mrow id="S5.SS3.p3.2.m2.1.2.3.2" xref="S5.SS3.p3.2.m2.1.2.cmml"><mo id="S5.SS3.p3.2.m2.1.2.3.2.1" stretchy="false" xref="S5.SS3.p3.2.m2.1.2.cmml">(</mo><mi id="S5.SS3.p3.2.m2.1.1" xref="S5.SS3.p3.2.m2.1.1.cmml">y</mi><mo id="S5.SS3.p3.2.m2.1.2.3.2.2" stretchy="false" xref="S5.SS3.p3.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.2.m2.1b"><apply id="S5.SS3.p3.2.m2.1.2.cmml" xref="S5.SS3.p3.2.m2.1.2"><times id="S5.SS3.p3.2.m2.1.2.1.cmml" xref="S5.SS3.p3.2.m2.1.2.1"></times><ci id="S5.SS3.p3.2.m2.1.2.2.cmml" xref="S5.SS3.p3.2.m2.1.2.2">𝑔</ci><ci id="S5.SS3.p3.2.m2.1.1.cmml" xref="S5.SS3.p3.2.m2.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.2.m2.1c">g(y)</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.2.m2.1d">italic_g ( italic_y )</annotation></semantics></math>, and <math alttext="g^{\prime}(y)" class="ltx_Math" display="inline" id="S5.SS3.p3.3.m3.1"><semantics id="S5.SS3.p3.3.m3.1a"><mrow id="S5.SS3.p3.3.m3.1.2" xref="S5.SS3.p3.3.m3.1.2.cmml"><msup id="S5.SS3.p3.3.m3.1.2.2" xref="S5.SS3.p3.3.m3.1.2.2.cmml"><mi id="S5.SS3.p3.3.m3.1.2.2.2" xref="S5.SS3.p3.3.m3.1.2.2.2.cmml">g</mi><mo id="S5.SS3.p3.3.m3.1.2.2.3" xref="S5.SS3.p3.3.m3.1.2.2.3.cmml">′</mo></msup><mo id="S5.SS3.p3.3.m3.1.2.1" xref="S5.SS3.p3.3.m3.1.2.1.cmml">⁢</mo><mrow id="S5.SS3.p3.3.m3.1.2.3.2" xref="S5.SS3.p3.3.m3.1.2.cmml"><mo id="S5.SS3.p3.3.m3.1.2.3.2.1" stretchy="false" xref="S5.SS3.p3.3.m3.1.2.cmml">(</mo><mi id="S5.SS3.p3.3.m3.1.1" xref="S5.SS3.p3.3.m3.1.1.cmml">y</mi><mo id="S5.SS3.p3.3.m3.1.2.3.2.2" stretchy="false" xref="S5.SS3.p3.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.3.m3.1b"><apply id="S5.SS3.p3.3.m3.1.2.cmml" xref="S5.SS3.p3.3.m3.1.2"><times id="S5.SS3.p3.3.m3.1.2.1.cmml" xref="S5.SS3.p3.3.m3.1.2.1"></times><apply id="S5.SS3.p3.3.m3.1.2.2.cmml" xref="S5.SS3.p3.3.m3.1.2.2"><csymbol cd="ambiguous" id="S5.SS3.p3.3.m3.1.2.2.1.cmml" xref="S5.SS3.p3.3.m3.1.2.2">superscript</csymbol><ci id="S5.SS3.p3.3.m3.1.2.2.2.cmml" xref="S5.SS3.p3.3.m3.1.2.2.2">𝑔</ci><ci id="S5.SS3.p3.3.m3.1.2.2.3.cmml" xref="S5.SS3.p3.3.m3.1.2.2.3">′</ci></apply><ci id="S5.SS3.p3.3.m3.1.1.cmml" xref="S5.SS3.p3.3.m3.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.3.m3.1c">g^{\prime}(y)</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.3.m3.1d">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y )</annotation></semantics></math>. We generate 4096 targets in <math alttext="D=8" class="ltx_Math" display="inline" id="S5.SS3.p3.4.m4.1"><semantics id="S5.SS3.p3.4.m4.1a"><mrow id="S5.SS3.p3.4.m4.1.1" xref="S5.SS3.p3.4.m4.1.1.cmml"><mi id="S5.SS3.p3.4.m4.1.1.2" xref="S5.SS3.p3.4.m4.1.1.2.cmml">D</mi><mo id="S5.SS3.p3.4.m4.1.1.1" xref="S5.SS3.p3.4.m4.1.1.1.cmml">=</mo><mn id="S5.SS3.p3.4.m4.1.1.3" xref="S5.SS3.p3.4.m4.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.4.m4.1b"><apply id="S5.SS3.p3.4.m4.1.1.cmml" xref="S5.SS3.p3.4.m4.1.1"><eq id="S5.SS3.p3.4.m4.1.1.1.cmml" xref="S5.SS3.p3.4.m4.1.1.1"></eq><ci id="S5.SS3.p3.4.m4.1.1.2.cmml" xref="S5.SS3.p3.4.m4.1.1.2">𝐷</ci><cn id="S5.SS3.p3.4.m4.1.1.3.cmml" type="integer" xref="S5.SS3.p3.4.m4.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.4.m4.1c">D=8</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.4.m4.1d">italic_D = 8</annotation></semantics></math> dimensions from a mixture of 20 Gaussians to represent <math alttext="g^{\prime}(y)" class="ltx_Math" display="inline" id="S5.SS3.p3.5.m5.1"><semantics id="S5.SS3.p3.5.m5.1a"><mrow id="S5.SS3.p3.5.m5.1.2" xref="S5.SS3.p3.5.m5.1.2.cmml"><msup id="S5.SS3.p3.5.m5.1.2.2" xref="S5.SS3.p3.5.m5.1.2.2.cmml"><mi id="S5.SS3.p3.5.m5.1.2.2.2" xref="S5.SS3.p3.5.m5.1.2.2.2.cmml">g</mi><mo id="S5.SS3.p3.5.m5.1.2.2.3" xref="S5.SS3.p3.5.m5.1.2.2.3.cmml">′</mo></msup><mo id="S5.SS3.p3.5.m5.1.2.1" xref="S5.SS3.p3.5.m5.1.2.1.cmml">⁢</mo><mrow id="S5.SS3.p3.5.m5.1.2.3.2" xref="S5.SS3.p3.5.m5.1.2.cmml"><mo id="S5.SS3.p3.5.m5.1.2.3.2.1" stretchy="false" xref="S5.SS3.p3.5.m5.1.2.cmml">(</mo><mi id="S5.SS3.p3.5.m5.1.1" xref="S5.SS3.p3.5.m5.1.1.cmml">y</mi><mo id="S5.SS3.p3.5.m5.1.2.3.2.2" stretchy="false" xref="S5.SS3.p3.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.5.m5.1b"><apply id="S5.SS3.p3.5.m5.1.2.cmml" xref="S5.SS3.p3.5.m5.1.2"><times id="S5.SS3.p3.5.m5.1.2.1.cmml" xref="S5.SS3.p3.5.m5.1.2.1"></times><apply id="S5.SS3.p3.5.m5.1.2.2.cmml" xref="S5.SS3.p3.5.m5.1.2.2"><csymbol cd="ambiguous" id="S5.SS3.p3.5.m5.1.2.2.1.cmml" xref="S5.SS3.p3.5.m5.1.2.2">superscript</csymbol><ci id="S5.SS3.p3.5.m5.1.2.2.2.cmml" xref="S5.SS3.p3.5.m5.1.2.2.2">𝑔</ci><ci id="S5.SS3.p3.5.m5.1.2.2.3.cmml" xref="S5.SS3.p3.5.m5.1.2.2.3">′</ci></apply><ci id="S5.SS3.p3.5.m5.1.1.cmml" xref="S5.SS3.p3.5.m5.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.5.m5.1c">g^{\prime}(y)</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.5.m5.1d">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y )</annotation></semantics></math>. To generate <math alttext="g(y)" class="ltx_Math" display="inline" id="S5.SS3.p3.6.m6.1"><semantics id="S5.SS3.p3.6.m6.1a"><mrow id="S5.SS3.p3.6.m6.1.2" xref="S5.SS3.p3.6.m6.1.2.cmml"><mi id="S5.SS3.p3.6.m6.1.2.2" xref="S5.SS3.p3.6.m6.1.2.2.cmml">g</mi><mo id="S5.SS3.p3.6.m6.1.2.1" xref="S5.SS3.p3.6.m6.1.2.1.cmml">⁢</mo><mrow id="S5.SS3.p3.6.m6.1.2.3.2" xref="S5.SS3.p3.6.m6.1.2.cmml"><mo id="S5.SS3.p3.6.m6.1.2.3.2.1" stretchy="false" xref="S5.SS3.p3.6.m6.1.2.cmml">(</mo><mi id="S5.SS3.p3.6.m6.1.1" xref="S5.SS3.p3.6.m6.1.1.cmml">y</mi><mo id="S5.SS3.p3.6.m6.1.2.3.2.2" stretchy="false" xref="S5.SS3.p3.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.6.m6.1b"><apply id="S5.SS3.p3.6.m6.1.2.cmml" xref="S5.SS3.p3.6.m6.1.2"><times id="S5.SS3.p3.6.m6.1.2.1.cmml" xref="S5.SS3.p3.6.m6.1.2.1"></times><ci id="S5.SS3.p3.6.m6.1.2.2.cmml" xref="S5.SS3.p3.6.m6.1.2.2">𝑔</ci><ci id="S5.SS3.p3.6.m6.1.1.cmml" xref="S5.SS3.p3.6.m6.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.6.m6.1c">g(y)</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.6.m6.1d">italic_g ( italic_y )</annotation></semantics></math>, we transform <math alttext="g^{\prime}(y)" class="ltx_Math" display="inline" id="S5.SS3.p3.7.m7.1"><semantics id="S5.SS3.p3.7.m7.1a"><mrow id="S5.SS3.p3.7.m7.1.2" xref="S5.SS3.p3.7.m7.1.2.cmml"><msup id="S5.SS3.p3.7.m7.1.2.2" xref="S5.SS3.p3.7.m7.1.2.2.cmml"><mi id="S5.SS3.p3.7.m7.1.2.2.2" xref="S5.SS3.p3.7.m7.1.2.2.2.cmml">g</mi><mo id="S5.SS3.p3.7.m7.1.2.2.3" xref="S5.SS3.p3.7.m7.1.2.2.3.cmml">′</mo></msup><mo id="S5.SS3.p3.7.m7.1.2.1" xref="S5.SS3.p3.7.m7.1.2.1.cmml">⁢</mo><mrow id="S5.SS3.p3.7.m7.1.2.3.2" xref="S5.SS3.p3.7.m7.1.2.cmml"><mo id="S5.SS3.p3.7.m7.1.2.3.2.1" stretchy="false" xref="S5.SS3.p3.7.m7.1.2.cmml">(</mo><mi id="S5.SS3.p3.7.m7.1.1" xref="S5.SS3.p3.7.m7.1.1.cmml">y</mi><mo id="S5.SS3.p3.7.m7.1.2.3.2.2" stretchy="false" xref="S5.SS3.p3.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.7.m7.1b"><apply id="S5.SS3.p3.7.m7.1.2.cmml" xref="S5.SS3.p3.7.m7.1.2"><times id="S5.SS3.p3.7.m7.1.2.1.cmml" xref="S5.SS3.p3.7.m7.1.2.1"></times><apply id="S5.SS3.p3.7.m7.1.2.2.cmml" xref="S5.SS3.p3.7.m7.1.2.2"><csymbol cd="ambiguous" id="S5.SS3.p3.7.m7.1.2.2.1.cmml" xref="S5.SS3.p3.7.m7.1.2.2">superscript</csymbol><ci id="S5.SS3.p3.7.m7.1.2.2.2.cmml" xref="S5.SS3.p3.7.m7.1.2.2.2">𝑔</ci><ci id="S5.SS3.p3.7.m7.1.2.2.3.cmml" xref="S5.SS3.p3.7.m7.1.2.2.3">′</ci></apply><ci id="S5.SS3.p3.7.m7.1.1.cmml" xref="S5.SS3.p3.7.m7.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.7.m7.1c">g^{\prime}(y)</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.7.m7.1d">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y )</annotation></semantics></math> by feeding the points into randomly initialized MLPs with up to <math alttext="2" class="ltx_Math" display="inline" id="S5.SS3.p3.8.m8.1"><semantics id="S5.SS3.p3.8.m8.1a"><mn id="S5.SS3.p3.8.m8.1.1" xref="S5.SS3.p3.8.m8.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.8.m8.1b"><cn id="S5.SS3.p3.8.m8.1.1.cmml" type="integer" xref="S5.SS3.p3.8.m8.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.8.m8.1c">2</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.8.m8.1d">2</annotation></semantics></math> hidden layers of size <math alttext="D,2D,4D" class="ltx_Math" display="inline" id="S5.SS3.p3.9.m9.3"><semantics id="S5.SS3.p3.9.m9.3a"><mrow id="S5.SS3.p3.9.m9.3.3.2" xref="S5.SS3.p3.9.m9.3.3.3.cmml"><mi id="S5.SS3.p3.9.m9.1.1" xref="S5.SS3.p3.9.m9.1.1.cmml">D</mi><mo id="S5.SS3.p3.9.m9.3.3.2.3" xref="S5.SS3.p3.9.m9.3.3.3.cmml">,</mo><mrow id="S5.SS3.p3.9.m9.2.2.1.1" xref="S5.SS3.p3.9.m9.2.2.1.1.cmml"><mn id="S5.SS3.p3.9.m9.2.2.1.1.2" xref="S5.SS3.p3.9.m9.2.2.1.1.2.cmml">2</mn><mo id="S5.SS3.p3.9.m9.2.2.1.1.1" xref="S5.SS3.p3.9.m9.2.2.1.1.1.cmml">⁢</mo><mi id="S5.SS3.p3.9.m9.2.2.1.1.3" xref="S5.SS3.p3.9.m9.2.2.1.1.3.cmml">D</mi></mrow><mo id="S5.SS3.p3.9.m9.3.3.2.4" xref="S5.SS3.p3.9.m9.3.3.3.cmml">,</mo><mrow id="S5.SS3.p3.9.m9.3.3.2.2" xref="S5.SS3.p3.9.m9.3.3.2.2.cmml"><mn id="S5.SS3.p3.9.m9.3.3.2.2.2" xref="S5.SS3.p3.9.m9.3.3.2.2.2.cmml">4</mn><mo id="S5.SS3.p3.9.m9.3.3.2.2.1" xref="S5.SS3.p3.9.m9.3.3.2.2.1.cmml">⁢</mo><mi id="S5.SS3.p3.9.m9.3.3.2.2.3" xref="S5.SS3.p3.9.m9.3.3.2.2.3.cmml">D</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.9.m9.3b"><list id="S5.SS3.p3.9.m9.3.3.3.cmml" xref="S5.SS3.p3.9.m9.3.3.2"><ci id="S5.SS3.p3.9.m9.1.1.cmml" xref="S5.SS3.p3.9.m9.1.1">𝐷</ci><apply id="S5.SS3.p3.9.m9.2.2.1.1.cmml" xref="S5.SS3.p3.9.m9.2.2.1.1"><times id="S5.SS3.p3.9.m9.2.2.1.1.1.cmml" xref="S5.SS3.p3.9.m9.2.2.1.1.1"></times><cn id="S5.SS3.p3.9.m9.2.2.1.1.2.cmml" type="integer" xref="S5.SS3.p3.9.m9.2.2.1.1.2">2</cn><ci id="S5.SS3.p3.9.m9.2.2.1.1.3.cmml" xref="S5.SS3.p3.9.m9.2.2.1.1.3">𝐷</ci></apply><apply id="S5.SS3.p3.9.m9.3.3.2.2.cmml" xref="S5.SS3.p3.9.m9.3.3.2.2"><times id="S5.SS3.p3.9.m9.3.3.2.2.1.cmml" xref="S5.SS3.p3.9.m9.3.3.2.2.1"></times><cn id="S5.SS3.p3.9.m9.3.3.2.2.2.cmml" type="integer" xref="S5.SS3.p3.9.m9.3.3.2.2.2">4</cn><ci id="S5.SS3.p3.9.m9.3.3.2.2.3.cmml" xref="S5.SS3.p3.9.m9.3.3.2.2.3">𝐷</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.9.m9.3c">D,2D,4D</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.9.m9.3d">italic_D , 2 italic_D , 4 italic_D</annotation></semantics></math> or <math alttext="8D" class="ltx_Math" display="inline" id="S5.SS3.p3.10.m10.1"><semantics id="S5.SS3.p3.10.m10.1a"><mrow id="S5.SS3.p3.10.m10.1.1" xref="S5.SS3.p3.10.m10.1.1.cmml"><mn id="S5.SS3.p3.10.m10.1.1.2" xref="S5.SS3.p3.10.m10.1.1.2.cmml">8</mn><mo id="S5.SS3.p3.10.m10.1.1.1" xref="S5.SS3.p3.10.m10.1.1.1.cmml">⁢</mo><mi id="S5.SS3.p3.10.m10.1.1.3" xref="S5.SS3.p3.10.m10.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.10.m10.1b"><apply id="S5.SS3.p3.10.m10.1.1.cmml" xref="S5.SS3.p3.10.m10.1.1"><times id="S5.SS3.p3.10.m10.1.1.1.cmml" xref="S5.SS3.p3.10.m10.1.1.1"></times><cn id="S5.SS3.p3.10.m10.1.1.2.cmml" type="integer" xref="S5.SS3.p3.10.m10.1.1.2">8</cn><ci id="S5.SS3.p3.10.m10.1.1.3.cmml" xref="S5.SS3.p3.10.m10.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.10.m10.1c">8D</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.10.m10.1d">8 italic_D</annotation></semantics></math>, with RELU activation and residual connections. We vary the complexity of the MLP and variance of the initialization to create embeddings <math alttext="g(y)" class="ltx_Math" display="inline" id="S5.SS3.p3.11.m11.1"><semantics id="S5.SS3.p3.11.m11.1a"><mrow id="S5.SS3.p3.11.m11.1.2" xref="S5.SS3.p3.11.m11.1.2.cmml"><mi id="S5.SS3.p3.11.m11.1.2.2" xref="S5.SS3.p3.11.m11.1.2.2.cmml">g</mi><mo id="S5.SS3.p3.11.m11.1.2.1" xref="S5.SS3.p3.11.m11.1.2.1.cmml">⁢</mo><mrow id="S5.SS3.p3.11.m11.1.2.3.2" xref="S5.SS3.p3.11.m11.1.2.cmml"><mo id="S5.SS3.p3.11.m11.1.2.3.2.1" stretchy="false" xref="S5.SS3.p3.11.m11.1.2.cmml">(</mo><mi id="S5.SS3.p3.11.m11.1.1" xref="S5.SS3.p3.11.m11.1.1.cmml">y</mi><mo id="S5.SS3.p3.11.m11.1.2.3.2.2" stretchy="false" xref="S5.SS3.p3.11.m11.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.11.m11.1b"><apply id="S5.SS3.p3.11.m11.1.2.cmml" xref="S5.SS3.p3.11.m11.1.2"><times id="S5.SS3.p3.11.m11.1.2.1.cmml" xref="S5.SS3.p3.11.m11.1.2.1"></times><ci id="S5.SS3.p3.11.m11.1.2.2.cmml" xref="S5.SS3.p3.11.m11.1.2.2">𝑔</ci><ci id="S5.SS3.p3.11.m11.1.1.cmml" xref="S5.SS3.p3.11.m11.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.11.m11.1c">g(y)</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.11.m11.1d">italic_g ( italic_y )</annotation></semantics></math> to model a variety of settings of the extent of the staleness (<math alttext="{\mathcal{W}(\mathscr{D}_{Y},\tilde{\mathscr{D}}_{Y})}" class="ltx_Math" display="inline" id="S5.SS3.p3.12.m12.2"><semantics id="S5.SS3.p3.12.m12.2a"><mrow id="S5.SS3.p3.12.m12.2.2" xref="S5.SS3.p3.12.m12.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p3.12.m12.2.2.4" xref="S5.SS3.p3.12.m12.2.2.4.cmml">𝒲</mi><mo id="S5.SS3.p3.12.m12.2.2.3" xref="S5.SS3.p3.12.m12.2.2.3.cmml">⁢</mo><mrow id="S5.SS3.p3.12.m12.2.2.2.2" xref="S5.SS3.p3.12.m12.2.2.2.3.cmml"><mo id="S5.SS3.p3.12.m12.2.2.2.2.3" stretchy="false" xref="S5.SS3.p3.12.m12.2.2.2.3.cmml">(</mo><msub id="S5.SS3.p3.12.m12.1.1.1.1.1" xref="S5.SS3.p3.12.m12.1.1.1.1.1.cmml"><mi class="ltx_font_mathscript" id="S5.SS3.p3.12.m12.1.1.1.1.1.2" xref="S5.SS3.p3.12.m12.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S5.SS3.p3.12.m12.1.1.1.1.1.3" xref="S5.SS3.p3.12.m12.1.1.1.1.1.3.cmml">Y</mi></msub><mo id="S5.SS3.p3.12.m12.2.2.2.2.4" xref="S5.SS3.p3.12.m12.2.2.2.3.cmml">,</mo><msub id="S5.SS3.p3.12.m12.2.2.2.2.2" xref="S5.SS3.p3.12.m12.2.2.2.2.2.cmml"><mover accent="true" id="S5.SS3.p3.12.m12.2.2.2.2.2.2" xref="S5.SS3.p3.12.m12.2.2.2.2.2.2.cmml"><mi class="ltx_font_mathscript" id="S5.SS3.p3.12.m12.2.2.2.2.2.2.2" xref="S5.SS3.p3.12.m12.2.2.2.2.2.2.2.cmml">𝒟</mi><mo id="S5.SS3.p3.12.m12.2.2.2.2.2.2.1" xref="S5.SS3.p3.12.m12.2.2.2.2.2.2.1.cmml">~</mo></mover><mi id="S5.SS3.p3.12.m12.2.2.2.2.2.3" xref="S5.SS3.p3.12.m12.2.2.2.2.2.3.cmml">Y</mi></msub><mo id="S5.SS3.p3.12.m12.2.2.2.2.5" stretchy="false" xref="S5.SS3.p3.12.m12.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.12.m12.2b"><apply id="S5.SS3.p3.12.m12.2.2.cmml" xref="S5.SS3.p3.12.m12.2.2"><times id="S5.SS3.p3.12.m12.2.2.3.cmml" xref="S5.SS3.p3.12.m12.2.2.3"></times><ci id="S5.SS3.p3.12.m12.2.2.4.cmml" xref="S5.SS3.p3.12.m12.2.2.4">𝒲</ci><interval closure="open" id="S5.SS3.p3.12.m12.2.2.2.3.cmml" xref="S5.SS3.p3.12.m12.2.2.2.2"><apply id="S5.SS3.p3.12.m12.1.1.1.1.1.cmml" xref="S5.SS3.p3.12.m12.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p3.12.m12.1.1.1.1.1.1.cmml" xref="S5.SS3.p3.12.m12.1.1.1.1.1">subscript</csymbol><ci id="S5.SS3.p3.12.m12.1.1.1.1.1.2.cmml" xref="S5.SS3.p3.12.m12.1.1.1.1.1.2">𝒟</ci><ci id="S5.SS3.p3.12.m12.1.1.1.1.1.3.cmml" xref="S5.SS3.p3.12.m12.1.1.1.1.1.3">𝑌</ci></apply><apply id="S5.SS3.p3.12.m12.2.2.2.2.2.cmml" xref="S5.SS3.p3.12.m12.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS3.p3.12.m12.2.2.2.2.2.1.cmml" xref="S5.SS3.p3.12.m12.2.2.2.2.2">subscript</csymbol><apply id="S5.SS3.p3.12.m12.2.2.2.2.2.2.cmml" xref="S5.SS3.p3.12.m12.2.2.2.2.2.2"><ci id="S5.SS3.p3.12.m12.2.2.2.2.2.2.1.cmml" xref="S5.SS3.p3.12.m12.2.2.2.2.2.2.1">~</ci><ci id="S5.SS3.p3.12.m12.2.2.2.2.2.2.2.cmml" xref="S5.SS3.p3.12.m12.2.2.2.2.2.2.2">𝒟</ci></apply><ci id="S5.SS3.p3.12.m12.2.2.2.2.2.3.cmml" xref="S5.SS3.p3.12.m12.2.2.2.2.2.3">𝑌</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.12.m12.2c">{\mathcal{W}(\mathscr{D}_{Y},\tilde{\mathscr{D}}_{Y})}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.12.m12.2d">caligraphic_W ( script_D start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT , over~ start_ARG script_D end_ARG start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT )</annotation></semantics></math>).</p>
</div>
<div class="ltx_para" id="S5.SS3.p4">
<p class="ltx_p" id="S5.SS3.p4.8"><span class="ltx_text ltx_font_bold" id="S5.SS3.p4.8.1">Corrector Network</span> In these experiments, we vary the parameter count of the corrector network <math alttext="h" class="ltx_Math" display="inline" id="S5.SS3.p4.1.m1.1"><semantics id="S5.SS3.p4.1.m1.1a"><mi id="S5.SS3.p4.1.m1.1.1" xref="S5.SS3.p4.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.1.m1.1b"><ci id="S5.SS3.p4.1.m1.1.1.cmml" xref="S5.SS3.p4.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.1.m1.1c">h</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.1.m1.1d">italic_h</annotation></semantics></math> and number of hidden layers, using between <math alttext="0" class="ltx_Math" display="inline" id="S5.SS3.p4.2.m2.1"><semantics id="S5.SS3.p4.2.m2.1a"><mn id="S5.SS3.p4.2.m2.1.1" xref="S5.SS3.p4.2.m2.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.2.m2.1b"><cn id="S5.SS3.p4.2.m2.1.1.cmml" type="integer" xref="S5.SS3.p4.2.m2.1.1">0</cn></annotation-xml></semantics></math> and <math alttext="2" class="ltx_Math" display="inline" id="S5.SS3.p4.3.m3.1"><semantics id="S5.SS3.p4.3.m3.1a"><mn id="S5.SS3.p4.3.m3.1.1" xref="S5.SS3.p4.3.m3.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.3.m3.1b"><cn id="S5.SS3.p4.3.m3.1.1.cmml" type="integer" xref="S5.SS3.p4.3.m3.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.3.m3.1c">2</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.3.m3.1d">2</annotation></semantics></math> hidden layers with hidden dimension of <math alttext="D,2D,4D," class="ltx_Math" display="inline" id="S5.SS3.p4.4.m4.2"><semantics id="S5.SS3.p4.4.m4.2a"><mrow id="S5.SS3.p4.4.m4.2.2.1"><mrow id="S5.SS3.p4.4.m4.2.2.1.1.2" xref="S5.SS3.p4.4.m4.2.2.1.1.3.cmml"><mi id="S5.SS3.p4.4.m4.1.1" xref="S5.SS3.p4.4.m4.1.1.cmml">D</mi><mo id="S5.SS3.p4.4.m4.2.2.1.1.2.3" xref="S5.SS3.p4.4.m4.2.2.1.1.3.cmml">,</mo><mrow id="S5.SS3.p4.4.m4.2.2.1.1.1.1" xref="S5.SS3.p4.4.m4.2.2.1.1.1.1.cmml"><mn id="S5.SS3.p4.4.m4.2.2.1.1.1.1.2" xref="S5.SS3.p4.4.m4.2.2.1.1.1.1.2.cmml">2</mn><mo id="S5.SS3.p4.4.m4.2.2.1.1.1.1.1" xref="S5.SS3.p4.4.m4.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="S5.SS3.p4.4.m4.2.2.1.1.1.1.3" xref="S5.SS3.p4.4.m4.2.2.1.1.1.1.3.cmml">D</mi></mrow><mo id="S5.SS3.p4.4.m4.2.2.1.1.2.4" xref="S5.SS3.p4.4.m4.2.2.1.1.3.cmml">,</mo><mrow id="S5.SS3.p4.4.m4.2.2.1.1.2.2" xref="S5.SS3.p4.4.m4.2.2.1.1.2.2.cmml"><mn id="S5.SS3.p4.4.m4.2.2.1.1.2.2.2" xref="S5.SS3.p4.4.m4.2.2.1.1.2.2.2.cmml">4</mn><mo id="S5.SS3.p4.4.m4.2.2.1.1.2.2.1" xref="S5.SS3.p4.4.m4.2.2.1.1.2.2.1.cmml">⁢</mo><mi id="S5.SS3.p4.4.m4.2.2.1.1.2.2.3" xref="S5.SS3.p4.4.m4.2.2.1.1.2.2.3.cmml">D</mi></mrow></mrow><mo id="S5.SS3.p4.4.m4.2.2.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.4.m4.2b"><list id="S5.SS3.p4.4.m4.2.2.1.1.3.cmml" xref="S5.SS3.p4.4.m4.2.2.1.1.2"><ci id="S5.SS3.p4.4.m4.1.1.cmml" xref="S5.SS3.p4.4.m4.1.1">𝐷</ci><apply id="S5.SS3.p4.4.m4.2.2.1.1.1.1.cmml" xref="S5.SS3.p4.4.m4.2.2.1.1.1.1"><times id="S5.SS3.p4.4.m4.2.2.1.1.1.1.1.cmml" xref="S5.SS3.p4.4.m4.2.2.1.1.1.1.1"></times><cn id="S5.SS3.p4.4.m4.2.2.1.1.1.1.2.cmml" type="integer" xref="S5.SS3.p4.4.m4.2.2.1.1.1.1.2">2</cn><ci id="S5.SS3.p4.4.m4.2.2.1.1.1.1.3.cmml" xref="S5.SS3.p4.4.m4.2.2.1.1.1.1.3">𝐷</ci></apply><apply id="S5.SS3.p4.4.m4.2.2.1.1.2.2.cmml" xref="S5.SS3.p4.4.m4.2.2.1.1.2.2"><times id="S5.SS3.p4.4.m4.2.2.1.1.2.2.1.cmml" xref="S5.SS3.p4.4.m4.2.2.1.1.2.2.1"></times><cn id="S5.SS3.p4.4.m4.2.2.1.1.2.2.2.cmml" type="integer" xref="S5.SS3.p4.4.m4.2.2.1.1.2.2.2">4</cn><ci id="S5.SS3.p4.4.m4.2.2.1.1.2.2.3.cmml" xref="S5.SS3.p4.4.m4.2.2.1.1.2.2.3">𝐷</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.4.m4.2c">D,2D,4D,</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.4.m4.2d">italic_D , 2 italic_D , 4 italic_D ,</annotation></semantics></math> or <math alttext="8D" class="ltx_Math" display="inline" id="S5.SS3.p4.5.m5.1"><semantics id="S5.SS3.p4.5.m5.1a"><mrow id="S5.SS3.p4.5.m5.1.1" xref="S5.SS3.p4.5.m5.1.1.cmml"><mn id="S5.SS3.p4.5.m5.1.1.2" xref="S5.SS3.p4.5.m5.1.1.2.cmml">8</mn><mo id="S5.SS3.p4.5.m5.1.1.1" xref="S5.SS3.p4.5.m5.1.1.1.cmml">⁢</mo><mi id="S5.SS3.p4.5.m5.1.1.3" xref="S5.SS3.p4.5.m5.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.5.m5.1b"><apply id="S5.SS3.p4.5.m5.1.1.cmml" xref="S5.SS3.p4.5.m5.1.1"><times id="S5.SS3.p4.5.m5.1.1.1.cmml" xref="S5.SS3.p4.5.m5.1.1.1"></times><cn id="S5.SS3.p4.5.m5.1.1.2.cmml" type="integer" xref="S5.SS3.p4.5.m5.1.1.2">8</cn><ci id="S5.SS3.p4.5.m5.1.1.3.cmml" xref="S5.SS3.p4.5.m5.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.5.m5.1c">8D</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.5.m5.1d">8 italic_D</annotation></semantics></math>. We use ReLU nonlinearity with residual connections. We optimize the parameters of the corrector network using Adam with learning rate <math alttext="0.03" class="ltx_Math" display="inline" id="S5.SS3.p4.6.m6.1"><semantics id="S5.SS3.p4.6.m6.1a"><mn id="S5.SS3.p4.6.m6.1.1" xref="S5.SS3.p4.6.m6.1.1.cmml">0.03</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.6.m6.1b"><cn id="S5.SS3.p4.6.m6.1.1.cmml" type="float" xref="S5.SS3.p4.6.m6.1.1">0.03</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.6.m6.1c">0.03</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.6.m6.1d">0.03</annotation></semantics></math>, and stop when the loss has not improved for at least <math alttext="100" class="ltx_Math" display="inline" id="S5.SS3.p4.7.m7.1"><semantics id="S5.SS3.p4.7.m7.1a"><mn id="S5.SS3.p4.7.m7.1.1" xref="S5.SS3.p4.7.m7.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.7.m7.1b"><cn id="S5.SS3.p4.7.m7.1.1.cmml" type="integer" xref="S5.SS3.p4.7.m7.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.7.m7.1c">100</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.7.m7.1d">100</annotation></semantics></math> epochs or we reach <math alttext="1000" class="ltx_Math" display="inline" id="S5.SS3.p4.8.m8.1"><semantics id="S5.SS3.p4.8.m8.1a"><mn id="S5.SS3.p4.8.m8.1.1" xref="S5.SS3.p4.8.m8.1.1.cmml">1000</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.8.m8.1b"><cn id="S5.SS3.p4.8.m8.1.1.cmml" type="integer" xref="S5.SS3.p4.8.m8.1.1">1000</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.8.m8.1c">1000</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.8.m8.1d">1000</annotation></semantics></math> epochs of training.</p>
</div>
<div class="ltx_para" id="S5.SS3.p5">
<p class="ltx_p" id="S5.SS3.p5.9"><span class="ltx_text ltx_font_bold" id="S5.SS3.p5.1.1">Varying <math alttext="|S(\mathcal{Y})|" class="ltx_Math" display="inline" id="S5.SS3.p5.1.1.m1.2"><semantics id="S5.SS3.p5.1.1.m1.2a"><mrow id="S5.SS3.p5.1.1.m1.2.2.1" xref="S5.SS3.p5.1.1.m1.2.2.2.cmml"><mo id="S5.SS3.p5.1.1.m1.2.2.1.2" stretchy="false" xref="S5.SS3.p5.1.1.m1.2.2.2.1.cmml">|</mo><mrow id="S5.SS3.p5.1.1.m1.2.2.1.1" xref="S5.SS3.p5.1.1.m1.2.2.1.1.cmml"><mi id="S5.SS3.p5.1.1.m1.2.2.1.1.2" xref="S5.SS3.p5.1.1.m1.2.2.1.1.2.cmml">S</mi><mo id="S5.SS3.p5.1.1.m1.2.2.1.1.1" xref="S5.SS3.p5.1.1.m1.2.2.1.1.1.cmml">⁢</mo><mrow id="S5.SS3.p5.1.1.m1.2.2.1.1.3.2" xref="S5.SS3.p5.1.1.m1.2.2.1.1.cmml"><mo id="S5.SS3.p5.1.1.m1.2.2.1.1.3.2.1" stretchy="false" xref="S5.SS3.p5.1.1.m1.2.2.1.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p5.1.1.m1.1.1" xref="S5.SS3.p5.1.1.m1.1.1.cmml">𝒴</mi><mo id="S5.SS3.p5.1.1.m1.2.2.1.1.3.2.2" stretchy="false" xref="S5.SS3.p5.1.1.m1.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="S5.SS3.p5.1.1.m1.2.2.1.3" stretchy="false" xref="S5.SS3.p5.1.1.m1.2.2.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.1.1.m1.2b"><apply id="S5.SS3.p5.1.1.m1.2.2.2.cmml" xref="S5.SS3.p5.1.1.m1.2.2.1"><abs id="S5.SS3.p5.1.1.m1.2.2.2.1.cmml" xref="S5.SS3.p5.1.1.m1.2.2.1.2"></abs><apply id="S5.SS3.p5.1.1.m1.2.2.1.1.cmml" xref="S5.SS3.p5.1.1.m1.2.2.1.1"><times id="S5.SS3.p5.1.1.m1.2.2.1.1.1.cmml" xref="S5.SS3.p5.1.1.m1.2.2.1.1.1"></times><ci id="S5.SS3.p5.1.1.m1.2.2.1.1.2.cmml" xref="S5.SS3.p5.1.1.m1.2.2.1.1.2">𝑆</ci><ci id="S5.SS3.p5.1.1.m1.1.1.cmml" xref="S5.SS3.p5.1.1.m1.1.1">𝒴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.1.1.m1.2c">|S(\mathcal{Y})|</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p5.1.1.m1.2d">| italic_S ( caligraphic_Y ) |</annotation></semantics></math>, number of targets used for training</span> In Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S5.F3" title="Figure 3 ‣ 5.2 Retrieval Augmented Language Models ‣ 5 Experiments ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">3</span></a>, we explore trade-offs between the complexity in terms of the parameter count <math alttext="|\Psi|" class="ltx_Math" display="inline" id="S5.SS3.p5.2.m1.1"><semantics id="S5.SS3.p5.2.m1.1a"><mrow id="S5.SS3.p5.2.m1.1.2.2" xref="S5.SS3.p5.2.m1.1.2.1.cmml"><mo id="S5.SS3.p5.2.m1.1.2.2.1" stretchy="false" xref="S5.SS3.p5.2.m1.1.2.1.1.cmml">|</mo><mi id="S5.SS3.p5.2.m1.1.1" mathvariant="normal" xref="S5.SS3.p5.2.m1.1.1.cmml">Ψ</mi><mo id="S5.SS3.p5.2.m1.1.2.2.2" stretchy="false" xref="S5.SS3.p5.2.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.2.m1.1b"><apply id="S5.SS3.p5.2.m1.1.2.1.cmml" xref="S5.SS3.p5.2.m1.1.2.2"><abs id="S5.SS3.p5.2.m1.1.2.1.1.cmml" xref="S5.SS3.p5.2.m1.1.2.2.1"></abs><ci id="S5.SS3.p5.2.m1.1.1.cmml" xref="S5.SS3.p5.2.m1.1.1">Ψ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.2.m1.1c">|\Psi|</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p5.2.m1.1d">| roman_Ψ |</annotation></semantics></math> of <math alttext="h" class="ltx_Math" display="inline" id="S5.SS3.p5.3.m2.1"><semantics id="S5.SS3.p5.3.m2.1a"><mi id="S5.SS3.p5.3.m2.1.1" xref="S5.SS3.p5.3.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.3.m2.1b"><ci id="S5.SS3.p5.3.m2.1.1.cmml" xref="S5.SS3.p5.3.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.3.m2.1c">h</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p5.3.m2.1d">italic_h</annotation></semantics></math> (x-axis); the approximation error <math alttext="\operatorname{KL}(P\|P_{h})" class="ltx_Math" display="inline" id="S5.SS3.p5.4.m3.2"><semantics id="S5.SS3.p5.4.m3.2a"><mrow id="S5.SS3.p5.4.m3.2.2.1" xref="S5.SS3.p5.4.m3.2.2.2.cmml"><mi id="S5.SS3.p5.4.m3.1.1" xref="S5.SS3.p5.4.m3.1.1.cmml">KL</mi><mo id="S5.SS3.p5.4.m3.2.2.1a" xref="S5.SS3.p5.4.m3.2.2.2.cmml">⁡</mo><mrow id="S5.SS3.p5.4.m3.2.2.1.1" xref="S5.SS3.p5.4.m3.2.2.2.cmml"><mo id="S5.SS3.p5.4.m3.2.2.1.1.2" stretchy="false" xref="S5.SS3.p5.4.m3.2.2.2.cmml">(</mo><mrow id="S5.SS3.p5.4.m3.2.2.1.1.1" xref="S5.SS3.p5.4.m3.2.2.1.1.1.cmml"><mi id="S5.SS3.p5.4.m3.2.2.1.1.1.2" xref="S5.SS3.p5.4.m3.2.2.1.1.1.2.cmml">P</mi><mo id="S5.SS3.p5.4.m3.2.2.1.1.1.1" xref="S5.SS3.p5.4.m3.2.2.1.1.1.1.cmml">∥</mo><msub id="S5.SS3.p5.4.m3.2.2.1.1.1.3" xref="S5.SS3.p5.4.m3.2.2.1.1.1.3.cmml"><mi id="S5.SS3.p5.4.m3.2.2.1.1.1.3.2" xref="S5.SS3.p5.4.m3.2.2.1.1.1.3.2.cmml">P</mi><mi id="S5.SS3.p5.4.m3.2.2.1.1.1.3.3" xref="S5.SS3.p5.4.m3.2.2.1.1.1.3.3.cmml">h</mi></msub></mrow><mo id="S5.SS3.p5.4.m3.2.2.1.1.3" stretchy="false" xref="S5.SS3.p5.4.m3.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.4.m3.2b"><apply id="S5.SS3.p5.4.m3.2.2.2.cmml" xref="S5.SS3.p5.4.m3.2.2.1"><ci id="S5.SS3.p5.4.m3.1.1.cmml" xref="S5.SS3.p5.4.m3.1.1">KL</ci><apply id="S5.SS3.p5.4.m3.2.2.1.1.1.cmml" xref="S5.SS3.p5.4.m3.2.2.1.1.1"><csymbol cd="latexml" id="S5.SS3.p5.4.m3.2.2.1.1.1.1.cmml" xref="S5.SS3.p5.4.m3.2.2.1.1.1.1">conditional</csymbol><ci id="S5.SS3.p5.4.m3.2.2.1.1.1.2.cmml" xref="S5.SS3.p5.4.m3.2.2.1.1.1.2">𝑃</ci><apply id="S5.SS3.p5.4.m3.2.2.1.1.1.3.cmml" xref="S5.SS3.p5.4.m3.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.p5.4.m3.2.2.1.1.1.3.1.cmml" xref="S5.SS3.p5.4.m3.2.2.1.1.1.3">subscript</csymbol><ci id="S5.SS3.p5.4.m3.2.2.1.1.1.3.2.cmml" xref="S5.SS3.p5.4.m3.2.2.1.1.1.3.2">𝑃</ci><ci id="S5.SS3.p5.4.m3.2.2.1.1.1.3.3.cmml" xref="S5.SS3.p5.4.m3.2.2.1.1.1.3.3">ℎ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.4.m3.2c">\operatorname{KL}(P\|P_{h})</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p5.4.m3.2d">roman_KL ( italic_P ∥ italic_P start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT )</annotation></semantics></math> after applying the trained correction model (y-axis); and the fraction of samples used for training <math alttext="h" class="ltx_Math" display="inline" id="S5.SS3.p5.5.m4.1"><semantics id="S5.SS3.p5.5.m4.1a"><mi id="S5.SS3.p5.5.m4.1.1" xref="S5.SS3.p5.5.m4.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.5.m4.1b"><ci id="S5.SS3.p5.5.m4.1.1.cmml" xref="S5.SS3.p5.5.m4.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.5.m4.1c">h</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p5.5.m4.1d">italic_h</annotation></semantics></math>. We report the complexity of the transformation from <math alttext="g^{\prime}" class="ltx_Math" display="inline" id="S5.SS3.p5.6.m5.1"><semantics id="S5.SS3.p5.6.m5.1a"><msup id="S5.SS3.p5.6.m5.1.1" xref="S5.SS3.p5.6.m5.1.1.cmml"><mi id="S5.SS3.p5.6.m5.1.1.2" xref="S5.SS3.p5.6.m5.1.1.2.cmml">g</mi><mo id="S5.SS3.p5.6.m5.1.1.3" xref="S5.SS3.p5.6.m5.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.6.m5.1b"><apply id="S5.SS3.p5.6.m5.1.1.cmml" xref="S5.SS3.p5.6.m5.1.1"><csymbol cd="ambiguous" id="S5.SS3.p5.6.m5.1.1.1.cmml" xref="S5.SS3.p5.6.m5.1.1">superscript</csymbol><ci id="S5.SS3.p5.6.m5.1.1.2.cmml" xref="S5.SS3.p5.6.m5.1.1.2">𝑔</ci><ci id="S5.SS3.p5.6.m5.1.1.3.cmml" xref="S5.SS3.p5.6.m5.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.6.m5.1c">g^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p5.6.m5.1d">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> to <math alttext="g" class="ltx_Math" display="inline" id="S5.SS3.p5.7.m6.1"><semantics id="S5.SS3.p5.7.m6.1a"><mi id="S5.SS3.p5.7.m6.1.1" xref="S5.SS3.p5.7.m6.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.7.m6.1b"><ci id="S5.SS3.p5.7.m6.1.1.cmml" xref="S5.SS3.p5.7.m6.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.7.m6.1c">g</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p5.7.m6.1d">italic_g</annotation></semantics></math> in terms of <math alttext="\operatorname{KL}(P\|P_{g^{\prime}})" class="ltx_Math" display="inline" id="S5.SS3.p5.8.m7.2"><semantics id="S5.SS3.p5.8.m7.2a"><mrow id="S5.SS3.p5.8.m7.2.2.1" xref="S5.SS3.p5.8.m7.2.2.2.cmml"><mi id="S5.SS3.p5.8.m7.1.1" xref="S5.SS3.p5.8.m7.1.1.cmml">KL</mi><mo id="S5.SS3.p5.8.m7.2.2.1a" xref="S5.SS3.p5.8.m7.2.2.2.cmml">⁡</mo><mrow id="S5.SS3.p5.8.m7.2.2.1.1" xref="S5.SS3.p5.8.m7.2.2.2.cmml"><mo id="S5.SS3.p5.8.m7.2.2.1.1.2" stretchy="false" xref="S5.SS3.p5.8.m7.2.2.2.cmml">(</mo><mrow id="S5.SS3.p5.8.m7.2.2.1.1.1" xref="S5.SS3.p5.8.m7.2.2.1.1.1.cmml"><mi id="S5.SS3.p5.8.m7.2.2.1.1.1.2" xref="S5.SS3.p5.8.m7.2.2.1.1.1.2.cmml">P</mi><mo id="S5.SS3.p5.8.m7.2.2.1.1.1.1" xref="S5.SS3.p5.8.m7.2.2.1.1.1.1.cmml">∥</mo><msub id="S5.SS3.p5.8.m7.2.2.1.1.1.3" xref="S5.SS3.p5.8.m7.2.2.1.1.1.3.cmml"><mi id="S5.SS3.p5.8.m7.2.2.1.1.1.3.2" xref="S5.SS3.p5.8.m7.2.2.1.1.1.3.2.cmml">P</mi><msup id="S5.SS3.p5.8.m7.2.2.1.1.1.3.3" xref="S5.SS3.p5.8.m7.2.2.1.1.1.3.3.cmml"><mi id="S5.SS3.p5.8.m7.2.2.1.1.1.3.3.2" xref="S5.SS3.p5.8.m7.2.2.1.1.1.3.3.2.cmml">g</mi><mo id="S5.SS3.p5.8.m7.2.2.1.1.1.3.3.3" xref="S5.SS3.p5.8.m7.2.2.1.1.1.3.3.3.cmml">′</mo></msup></msub></mrow><mo id="S5.SS3.p5.8.m7.2.2.1.1.3" stretchy="false" xref="S5.SS3.p5.8.m7.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.8.m7.2b"><apply id="S5.SS3.p5.8.m7.2.2.2.cmml" xref="S5.SS3.p5.8.m7.2.2.1"><ci id="S5.SS3.p5.8.m7.1.1.cmml" xref="S5.SS3.p5.8.m7.1.1">KL</ci><apply id="S5.SS3.p5.8.m7.2.2.1.1.1.cmml" xref="S5.SS3.p5.8.m7.2.2.1.1.1"><csymbol cd="latexml" id="S5.SS3.p5.8.m7.2.2.1.1.1.1.cmml" xref="S5.SS3.p5.8.m7.2.2.1.1.1.1">conditional</csymbol><ci id="S5.SS3.p5.8.m7.2.2.1.1.1.2.cmml" xref="S5.SS3.p5.8.m7.2.2.1.1.1.2">𝑃</ci><apply id="S5.SS3.p5.8.m7.2.2.1.1.1.3.cmml" xref="S5.SS3.p5.8.m7.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.p5.8.m7.2.2.1.1.1.3.1.cmml" xref="S5.SS3.p5.8.m7.2.2.1.1.1.3">subscript</csymbol><ci id="S5.SS3.p5.8.m7.2.2.1.1.1.3.2.cmml" xref="S5.SS3.p5.8.m7.2.2.1.1.1.3.2">𝑃</ci><apply id="S5.SS3.p5.8.m7.2.2.1.1.1.3.3.cmml" xref="S5.SS3.p5.8.m7.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S5.SS3.p5.8.m7.2.2.1.1.1.3.3.1.cmml" xref="S5.SS3.p5.8.m7.2.2.1.1.1.3.3">superscript</csymbol><ci id="S5.SS3.p5.8.m7.2.2.1.1.1.3.3.2.cmml" xref="S5.SS3.p5.8.m7.2.2.1.1.1.3.3.2">𝑔</ci><ci id="S5.SS3.p5.8.m7.2.2.1.1.1.3.3.3.cmml" xref="S5.SS3.p5.8.m7.2.2.1.1.1.3.3.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.8.m7.2c">\operatorname{KL}(P\|P_{g^{\prime}})</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p5.8.m7.2d">roman_KL ( italic_P ∥ italic_P start_POSTSUBSCRIPT italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math> above each pane.
Using a higher fraction of training samples is needed when there is more staleness. When the drift is more significant (right-hand pane), we observe that using increased parameters with a smaller fraction of samples does lead to overfitting. In this setting, it seems that sampling <math alttext="10\%" class="ltx_Math" display="inline" id="S5.SS3.p5.9.m8.1"><semantics id="S5.SS3.p5.9.m8.1a"><mrow id="S5.SS3.p5.9.m8.1.1" xref="S5.SS3.p5.9.m8.1.1.cmml"><mn id="S5.SS3.p5.9.m8.1.1.2" xref="S5.SS3.p5.9.m8.1.1.2.cmml">10</mn><mo id="S5.SS3.p5.9.m8.1.1.1" xref="S5.SS3.p5.9.m8.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.9.m8.1b"><apply id="S5.SS3.p5.9.m8.1.1.cmml" xref="S5.SS3.p5.9.m8.1.1"><csymbol cd="latexml" id="S5.SS3.p5.9.m8.1.1.1.cmml" xref="S5.SS3.p5.9.m8.1.1.1">percent</csymbol><cn id="S5.SS3.p5.9.m8.1.1.2.cmml" type="integer" xref="S5.SS3.p5.9.m8.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.9.m8.1c">10\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p5.9.m8.1d">10 %</annotation></semantics></math> of the targets is generally sufficient.</p>
</div>
<div class="ltx_para" id="S5.SS3.p6">
<p class="ltx_p" id="S5.SS3.p6.4"><span class="ltx_text ltx_font_bold" id="S5.SS3.p6.4.1">Varying Complexity of the Target Corrector Network</span>
In order to explore how the KL divergence of our approximation may change with respect to the staleness of the embeddings <math alttext="g^{\prime}" class="ltx_Math" display="inline" id="S5.SS3.p6.1.m1.1"><semantics id="S5.SS3.p6.1.m1.1a"><msup id="S5.SS3.p6.1.m1.1.1" xref="S5.SS3.p6.1.m1.1.1.cmml"><mi id="S5.SS3.p6.1.m1.1.1.2" xref="S5.SS3.p6.1.m1.1.1.2.cmml">g</mi><mo id="S5.SS3.p6.1.m1.1.1.3" xref="S5.SS3.p6.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S5.SS3.p6.1.m1.1b"><apply id="S5.SS3.p6.1.m1.1.1.cmml" xref="S5.SS3.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p6.1.m1.1.1.1.cmml" xref="S5.SS3.p6.1.m1.1.1">superscript</csymbol><ci id="S5.SS3.p6.1.m1.1.1.2.cmml" xref="S5.SS3.p6.1.m1.1.1.2">𝑔</ci><ci id="S5.SS3.p6.1.m1.1.1.3.cmml" xref="S5.SS3.p6.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p6.1.m1.1c">g^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p6.1.m1.1d">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, we train our embedding model to approximate the distributions <math alttext="P" class="ltx_Math" display="inline" id="S5.SS3.p6.2.m2.1"><semantics id="S5.SS3.p6.2.m2.1a"><mi id="S5.SS3.p6.2.m2.1.1" xref="S5.SS3.p6.2.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p6.2.m2.1b"><ci id="S5.SS3.p6.2.m2.1.1.cmml" xref="S5.SS3.p6.2.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p6.2.m2.1c">P</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p6.2.m2.1d">italic_P</annotation></semantics></math>.
In Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S5.F4" title="Figure 4 ‣ 5.3 Synthetic Experiments ‣ 5 Experiments ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">4</span></a>, we explore how the KL divergence of our approximation may change with respect to the staleness of the embeddings <math alttext="g^{\prime}" class="ltx_Math" display="inline" id="S5.SS3.p6.3.m3.1"><semantics id="S5.SS3.p6.3.m3.1a"><msup id="S5.SS3.p6.3.m3.1.1" xref="S5.SS3.p6.3.m3.1.1.cmml"><mi id="S5.SS3.p6.3.m3.1.1.2" xref="S5.SS3.p6.3.m3.1.1.2.cmml">g</mi><mo id="S5.SS3.p6.3.m3.1.1.3" xref="S5.SS3.p6.3.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S5.SS3.p6.3.m3.1b"><apply id="S5.SS3.p6.3.m3.1.1.cmml" xref="S5.SS3.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS3.p6.3.m3.1.1.1.cmml" xref="S5.SS3.p6.3.m3.1.1">superscript</csymbol><ci id="S5.SS3.p6.3.m3.1.1.2.cmml" xref="S5.SS3.p6.3.m3.1.1.2">𝑔</ci><ci id="S5.SS3.p6.3.m3.1.1.3.cmml" xref="S5.SS3.p6.3.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p6.3.m3.1c">g^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p6.3.m3.1d">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>,
We can obtain a significant reduction in KL divergence via the correction model (on the y-axis) across a wide variety of drifts (as measured by <math alttext="\operatorname{KL}(P\|P_{g^{\prime}})" class="ltx_Math" display="inline" id="S5.SS3.p6.4.m4.2"><semantics id="S5.SS3.p6.4.m4.2a"><mrow id="S5.SS3.p6.4.m4.2.2.1" xref="S5.SS3.p6.4.m4.2.2.2.cmml"><mi id="S5.SS3.p6.4.m4.1.1" xref="S5.SS3.p6.4.m4.1.1.cmml">KL</mi><mo id="S5.SS3.p6.4.m4.2.2.1a" xref="S5.SS3.p6.4.m4.2.2.2.cmml">⁡</mo><mrow id="S5.SS3.p6.4.m4.2.2.1.1" xref="S5.SS3.p6.4.m4.2.2.2.cmml"><mo id="S5.SS3.p6.4.m4.2.2.1.1.2" stretchy="false" xref="S5.SS3.p6.4.m4.2.2.2.cmml">(</mo><mrow id="S5.SS3.p6.4.m4.2.2.1.1.1" xref="S5.SS3.p6.4.m4.2.2.1.1.1.cmml"><mi id="S5.SS3.p6.4.m4.2.2.1.1.1.2" xref="S5.SS3.p6.4.m4.2.2.1.1.1.2.cmml">P</mi><mo id="S5.SS3.p6.4.m4.2.2.1.1.1.1" xref="S5.SS3.p6.4.m4.2.2.1.1.1.1.cmml">∥</mo><msub id="S5.SS3.p6.4.m4.2.2.1.1.1.3" xref="S5.SS3.p6.4.m4.2.2.1.1.1.3.cmml"><mi id="S5.SS3.p6.4.m4.2.2.1.1.1.3.2" xref="S5.SS3.p6.4.m4.2.2.1.1.1.3.2.cmml">P</mi><msup id="S5.SS3.p6.4.m4.2.2.1.1.1.3.3" xref="S5.SS3.p6.4.m4.2.2.1.1.1.3.3.cmml"><mi id="S5.SS3.p6.4.m4.2.2.1.1.1.3.3.2" xref="S5.SS3.p6.4.m4.2.2.1.1.1.3.3.2.cmml">g</mi><mo id="S5.SS3.p6.4.m4.2.2.1.1.1.3.3.3" xref="S5.SS3.p6.4.m4.2.2.1.1.1.3.3.3.cmml">′</mo></msup></msub></mrow><mo id="S5.SS3.p6.4.m4.2.2.1.1.3" stretchy="false" xref="S5.SS3.p6.4.m4.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p6.4.m4.2b"><apply id="S5.SS3.p6.4.m4.2.2.2.cmml" xref="S5.SS3.p6.4.m4.2.2.1"><ci id="S5.SS3.p6.4.m4.1.1.cmml" xref="S5.SS3.p6.4.m4.1.1">KL</ci><apply id="S5.SS3.p6.4.m4.2.2.1.1.1.cmml" xref="S5.SS3.p6.4.m4.2.2.1.1.1"><csymbol cd="latexml" id="S5.SS3.p6.4.m4.2.2.1.1.1.1.cmml" xref="S5.SS3.p6.4.m4.2.2.1.1.1.1">conditional</csymbol><ci id="S5.SS3.p6.4.m4.2.2.1.1.1.2.cmml" xref="S5.SS3.p6.4.m4.2.2.1.1.1.2">𝑃</ci><apply id="S5.SS3.p6.4.m4.2.2.1.1.1.3.cmml" xref="S5.SS3.p6.4.m4.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.p6.4.m4.2.2.1.1.1.3.1.cmml" xref="S5.SS3.p6.4.m4.2.2.1.1.1.3">subscript</csymbol><ci id="S5.SS3.p6.4.m4.2.2.1.1.1.3.2.cmml" xref="S5.SS3.p6.4.m4.2.2.1.1.1.3.2">𝑃</ci><apply id="S5.SS3.p6.4.m4.2.2.1.1.1.3.3.cmml" xref="S5.SS3.p6.4.m4.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S5.SS3.p6.4.m4.2.2.1.1.1.3.3.1.cmml" xref="S5.SS3.p6.4.m4.2.2.1.1.1.3.3">superscript</csymbol><ci id="S5.SS3.p6.4.m4.2.2.1.1.1.3.3.2.cmml" xref="S5.SS3.p6.4.m4.2.2.1.1.1.3.3.2">𝑔</ci><ci id="S5.SS3.p6.4.m4.2.2.1.1.1.3.3.3.cmml" xref="S5.SS3.p6.4.m4.2.2.1.1.1.3.3.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p6.4.m4.2c">\operatorname{KL}(P\|P_{g^{\prime}})</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p6.4.m4.2d">roman_KL ( italic_P ∥ italic_P start_POSTSUBSCRIPT italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math>). Increasing parameter count is always effective, but it yields greater benefit when approximating a distribution with greater divergence.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Related work</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1"><span class="ltx_text ltx_font_bold" id="S6.p1.1.1">Energy-based Models </span> Many similar ideas of training small parametric models to aid the training of other models has been widely studied in energy-based models, such as CoopNets <cite class="ltx_cite ltx_citemacro_citep">(Xie et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib38" title="">2018</a>)</cite>, VERA <cite class="ltx_cite ltx_citemacro_citep">(Grathwohl et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib10" title="">2021</a>)</cite>, and others <cite class="ltx_cite ltx_citemacro_citep">(Grathwohl et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib9" title="">2020</a>)</cite>. In this setting models can be trained to skirt around intractable computations required in main-model training.</p>
</div>
<div class="ltx_para" id="S6.p2">
<p class="ltx_p" id="S6.p2.1"><span class="ltx_text ltx_font_bold" id="S6.p2.1.1">Amortized Inference </span> There are many approaches that speed up sampling by fitting parametric models such as feed-forward neural networks <cite class="ltx_cite ltx_citemacro_citep">(Marino et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib22" title="">2018</a>; Naderiparizi et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib25" title="">2022</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S6.p3">
<p class="ltx_p" id="S6.p3.1"><span class="ltx_text ltx_font_bold" id="S6.p3.1.1">Softmax Approximations </span> Previous work has considered approximations to softmax via kernel methods <cite class="ltx_cite ltx_citemacro_citep">(Blanc &amp; Rendle, <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib2" title="">2018</a>; Rawat et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib30" title="">2019</a>)</cite> when there are trainable parameters for every target (rather than an encoder). Sampling-based approaches are widely used as well <cite class="ltx_cite ltx_citemacro_citep">(Vembu et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib35" title="">2009</a>; Zaheer et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib42" title="">2017</a>; Monath et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib24" title="">2023</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S6.p4">
<p class="ltx_p" id="S6.p4.1"><span class="ltx_text ltx_font_bold" id="S6.p4.1.1">Adapters </span> Adapter methods, which train small parametric components of larger networks <cite class="ltx_cite ltx_citemacro_citep">(Houlsby et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib13" title="">2019</a>)</cite> bear resemblance to our approach.
However, our approach is distinct in that it operates only on the output layer of the neural models, not intermediate layers.</p>
</div>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">We present target corrector networks for approximating the softmax function during the training of dual encoder models and retrieval augmented language models. The target corrector networks learn to update a stale buffer of target representations. We investigate the generalization properties of the corrector models theoretically. We furthermore show empirically how our correct model approach can be used to train models (both supervised retrievers and retrieval augmented language models) matching the accuracy of models that use 4x-80x the computational budget during training.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Impact Statement</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">Our work proposes new more efficient ways of training of retrieval models.
Retrieval models both in their own right and in combination with language models
have wide and applicable uses. The techniques of this paper are about improving
training efficiency. As such, better models could be produced faster, bringing to bear
all the responsibilities of model creators in terms of understanding the successes,
limitations, and biases of the model. Future work could consider the question of
how different training strategies affect the way in which retrieval models
have broad impact. Of particular interest to this paper could be the way in
which staleness when computing the truncated softmax plays a role in such a study.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bajaj et al. (2016)</span>
<span class="ltx_bibblock">
Bajaj, P., Campos, D., Craswell, N., Deng, L., Gao, J., Liu, X., Majumder, R.,
McNamara, A., Mitra, B., Nguyen, T., et al.

</span>
<span class="ltx_bibblock">Ms marco: A human generated machine reading comprehension dataset.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">arXiv preprint arXiv:1611.09268</em>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Blanc &amp; Rendle (2018)</span>
<span class="ltx_bibblock">
Blanc, G. and Rendle, S.

</span>
<span class="ltx_bibblock">Adaptive sampled softmax with kernel based sampling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">International Conference on Machine Learning (ICML)</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bradbury et al. (2018)</span>
<span class="ltx_bibblock">
Bradbury, J., Frostig, R., Hawkins, P., Johnson, M. J., Leary, C., Maclaurin,
D., Necula, G., Paszke, A., VanderPlas, J., Wanderman-Milne, S., and
Zhang, Q.

</span>
<span class="ltx_bibblock">JAX: composable transformations of Python+NumPy programs.

</span>
<span class="ltx_bibblock">2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al. (2019)</span>
<span class="ltx_bibblock">
Devlin, J., Chang, M.-W., Lee, K., and Toutanova, K.

</span>
<span class="ltx_bibblock">BERT: Pre-training of deep bidirectional transformers for language
understanding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Proceedings of Conference of the North American Chapter of
the Association for Computational Linguistics: Human Language Technologies
(NAACL-HLT)</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devroye et al. (2013)</span>
<span class="ltx_bibblock">
Devroye, L., Györfi, L., and Lugosi, G.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">A probabilistic theory of pattern recognition</em>, volume 31.

</span>
<span class="ltx_bibblock">Springer Science &amp; Business Media, 2013.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dulac-Arnold et al. (2015)</span>
<span class="ltx_bibblock">
Dulac-Arnold, G., Evans, R., van Hasselt, H., Sunehag, P., Lillicrap, T., Hunt,
J., Mann, T., Weber, T., Degris, T., and Coppin, B.

</span>
<span class="ltx_bibblock">Deep reinforcement learning in large discrete action spaces.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">arXiv preprint arXiv:1512.07679</em>, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gillick et al. (2019)</span>
<span class="ltx_bibblock">
Gillick, D., Kulkarni, S., Lansing, L., Presta, A., Baldridge, J., Ie, E., and
Garcia-Olano, D.

</span>
<span class="ltx_bibblock">Learning dense representations for entity retrieval.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Conference on Computational Natural Language Learning (CoNLL)</em>,
2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gottipati et al. (2020)</span>
<span class="ltx_bibblock">
Gottipati, S. K., Sattarov, B., Niu, S., Pathak, Y., Wei, H., Liu, S.,
Blackburn, S., Thomas, K., Coley, C., Tang, J., et al.

</span>
<span class="ltx_bibblock">Learning to navigate the synthetically accessible chemical space
using reinforcement learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">International conference on machine learning</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Grathwohl et al. (2020)</span>
<span class="ltx_bibblock">
Grathwohl, W., Wang, K.-C., Jacobsen, J.-H., Duvenaud, D., and Zemel, R.

</span>
<span class="ltx_bibblock">Learning the stein discrepancy for training and evaluating
energy-based models without sampling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">International Conference on Machine Learning</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Grathwohl et al. (2021)</span>
<span class="ltx_bibblock">
Grathwohl, W., Kelly, J., Hashemi, M., Norouzi, M., Swersky, K., and Duvenaud,
D.

</span>
<span class="ltx_bibblock">No mcmc for me: Amortized sampling for fast and stable training of
energy-based models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">ICLR</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guu et al. (2020)</span>
<span class="ltx_bibblock">
Guu, K., Lee, K., Tung, Z., Pasupat, P., and Chang, M.

</span>
<span class="ltx_bibblock">Retrieval augmented language model pre-training.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">International Conference on Machine Learning (ICML)</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han et al. (2020)</span>
<span class="ltx_bibblock">
Han, T., Nijkamp, E., Zhou, L., Pang, B., Zhu, S.-C., and Wu, Y. N.

</span>
<span class="ltx_bibblock">Joint training of variational auto-encoder and latent energy-based
model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Houlsby et al. (2019)</span>
<span class="ltx_bibblock">
Houlsby, N., Giurgiu, A., Jastrzebski, S., Morrone, B., De Laroussilhe, Q.,
Gesmundo, A., Attariyan, M., and Gelly, S.

</span>
<span class="ltx_bibblock">Parameter-efficient transfer learning for NLP.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Proceedings of the 36th International Conference on Machine
Learning</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Izacard &amp; Grave (2021)</span>
<span class="ltx_bibblock">
Izacard, G. and Grave, E.

</span>
<span class="ltx_bibblock">Leveraging passage retrieval with generative models for open domain
question answering, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Izacard et al. (2022)</span>
<span class="ltx_bibblock">
Izacard, G., Lewis, P., Lomeli, M., Hosseini, L., Petroni, F., Schick, T.,
Dwivedi-Yu, J., Joulin, A., Riedel, S., and Grave, E.

</span>
<span class="ltx_bibblock">Few-shot learning with retrieval augmented language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">arXiv preprint arXiv:2208.03299</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Joshi et al. (2017)</span>
<span class="ltx_bibblock">
Joshi, M., Choi, E., Weld, D. S., and Zettlemoyer, L.

</span>
<span class="ltx_bibblock">Triviaqa: A large scale distantly supervised challenge dataset for
reading comprehension.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Proceedings of the 55th Annual Meeting of the Association for
Computational Linguistics (Volume 1: Long Papers)</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karpukhin et al. (2020)</span>
<span class="ltx_bibblock">
Karpukhin, V., Oğuz, B., Min, S., Lewis, P., Wu, L., Edunov, S., Chen,
D., and Yih, W.-t.

</span>
<span class="ltx_bibblock">Dense passage retrieval for open-domain question answering.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">arXiv preprint arXiv:2004.04906</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma &amp; Ba (2014)</span>
<span class="ltx_bibblock">
Kingma, D. P. and Ba, J.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">arXiv preprint arXiv:1412.6980</em>, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kwiatkowski et al. (2019)</span>
<span class="ltx_bibblock">
Kwiatkowski, T., Palomaki, J., Redfield, O., Collins, M., Parikh, A., Alberti,
C., Epstein, D., Polosukhin, I., Devlin, J., Lee, K., Toutanova, K., Jones,
L., Kelcey, M., Chang, M.-W., Dai, A. M., Uszkoreit, J., Le, Q., and Petrov,
S.

</span>
<span class="ltx_bibblock">Natural Questions: A Benchmark for Question Answering Research.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Transactions of the Association for Computational Linguistics
(TACL)</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lindgren et al. (2021)</span>
<span class="ltx_bibblock">
Lindgren, E., Reddi, S. J., Guo, R., and Kumar, S.

</span>
<span class="ltx_bibblock">Efficient training of retrieval models using negative cache.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Advances in Neural Information Processing Systems (NeurIPS)</em>,
2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Logeswaran et al. (2019)</span>
<span class="ltx_bibblock">
Logeswaran, L., Chang, M.-W., Lee, K., Toutanova, K., Devlin, J., and Lee, H.

</span>
<span class="ltx_bibblock">Zero-shot entity linking by reading entity descriptions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Association for Computational Linguistics (ACL)</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Marino et al. (2018)</span>
<span class="ltx_bibblock">
Marino, J., Yue, Y., and Mandt, S.

</span>
<span class="ltx_bibblock">Iterative amortized inference.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Proceedings of the 35th International Conference on Machine
Learning</em>, pp.  3403–3412, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mohri et al. (2018)</span>
<span class="ltx_bibblock">
Mohri, M., Rostamizadeh, A., and Talwalkar, A.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Foundations of machine learning</em>.

</span>
<span class="ltx_bibblock">MIT press, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Monath et al. (2023)</span>
<span class="ltx_bibblock">
Monath, N., Zaheer, M., Allen, K., and McCallum, A.

</span>
<span class="ltx_bibblock">Improving dual-encoder training through dynamic indexes for negative
mining.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">AISTATS</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Naderiparizi et al. (2022)</span>
<span class="ltx_bibblock">
Naderiparizi, S., Scibior, A., Munk, A., Ghadiri, M., Baydin, A. G.,
Gram-Hansen, B. J., De Witt, C. A. S., Zinkov, R., Torr, P., Rainforth, T.,
et al.

</span>
<span class="ltx_bibblock">Amortized rejection sampling in universal probabilistic programming.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">International Conference on Artificial Intelligence and
Statistics</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ni et al. (2021)</span>
<span class="ltx_bibblock">
Ni, J., Qu, C., Lu, J., Dai, Z., Ábrego, G. H., Ma, J., Zhao, V. Y., Luan,
Y., Hall, K. B., Chang, M.-W., et al.

</span>
<span class="ltx_bibblock">Large dual encoders are generalizable retrievers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">arXiv preprint arXiv:2112.07899</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ni et al. (2022)</span>
<span class="ltx_bibblock">
Ni, J., Qu, C., Lu, J., Dai, Z., Abrego, G. H., Ma, J., Zhao, V., Luan, Y.,
Hall, K., Chang, M.-W., et al.

</span>
<span class="ltx_bibblock">Large dual encoders are generalizable retrievers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Proceedings of the 2022 Conference on Empirical Methods in
Natural Language Processing</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qu et al. (2021)</span>
<span class="ltx_bibblock">
Qu, Y., Ding, Y., Liu, J., Liu, K., Ren, R., Zhao, W. X., Dong, D., Wu, H., and
Wang, H.

</span>
<span class="ltx_bibblock">Rocketqa: An optimized training approach to dense passage retrieval
for open-domain question answering.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Conference of the North American Chapter of the Association for
Computational Linguistics: Human Language Technologies (NAACL-HLT)</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raffel et al. (2020)</span>
<span class="ltx_bibblock">
Raffel, C., Shazeer, N., Roberts, A., Lee, K., Narang, S., Matena, M., Zhou,
Y., Li, W., and Liu, P. J.

</span>
<span class="ltx_bibblock">Exploring the limits of transfer learning with a unified text-to-text
transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">The Journal of Machine Learning Research</em>, 21(1),
2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rawat et al. (2019)</span>
<span class="ltx_bibblock">
Rawat, A. S., Chen, J., Yu, F., Suresh, A. T., and Kumar, S.

</span>
<span class="ltx_bibblock">Sampled softmax with random fourier features.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Advances in Neural Information Processing Systems (NeurIPS)</em>,
2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rawat et al. (2020)</span>
<span class="ltx_bibblock">
Rawat, A. S., Menon, A. K., Veit, A., Yu, F., Reddi, S. J., and Kumar, S.

</span>
<span class="ltx_bibblock">Doubly-stochastic mining for heterogeneous retrieval.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">arXiv preprint arXiv:2004.10915</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reddi et al. (2019)</span>
<span class="ltx_bibblock">
Reddi, S. J., Kale, S., Yu, F., Holtmann-Rice, D., Chen, J., and Kumar, S.

</span>
<span class="ltx_bibblock">Stochastic negative mining for learning with large output spaces.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Proceedings of the Twenty-Second International Conference on
Artificial Intelligence and Statistics</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Roberts et al. (2020)</span>
<span class="ltx_bibblock">
Roberts, A., Raffel, C., and Shazeer, N.

</span>
<span class="ltx_bibblock">How much knowledge can you pack into the parameters of a language
model?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">arXiv preprint arXiv:2002.08910</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Thakur et al. (2021)</span>
<span class="ltx_bibblock">
Thakur, N., Reimers, N., Rücklé, A., Srivastava, A., and Gurevych, I.

</span>
<span class="ltx_bibblock">Beir: A heterogenous benchmark for zero-shot evaluation of
information retrieval models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">arXiv preprint arXiv:2104.08663</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vembu et al. (2009)</span>
<span class="ltx_bibblock">
Vembu, S., Gärtner, T., and Boley, M.

</span>
<span class="ltx_bibblock">Probabilistic structured predictors.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Uncertainty in Artificial Intelligence (UAI)</em>, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Villani et al. (2008)</span>
<span class="ltx_bibblock">
Villani, C. et al.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Optimal transport: old and new</em>.

</span>
<span class="ltx_bibblock">Springer, 2008.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wachsmuth et al. (2018)</span>
<span class="ltx_bibblock">
Wachsmuth, H., Syed, S., and Stein, B.

</span>
<span class="ltx_bibblock">Retrieval of the best counterargument without prior topic knowledge.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Proceedings of the 56th Annual Meeting of the Association for
Computational Linguistics (Volume 1: Long Papers)</em>, July 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al. (2018)</span>
<span class="ltx_bibblock">
Xie, J., Lu, Y., Gao, R., and Wu, Y. N.

</span>
<span class="ltx_bibblock">Cooperative learning of energy-based model and latent variable model
via mcmc teaching.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>,
32, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiong et al. (2020)</span>
<span class="ltx_bibblock">
Xiong, L., Xiong, C., Li, Y., Tang, K.-F., Liu, J., Bennett, P. N., Ahmed, J.,
and Overwijk, A.

</span>
<span class="ltx_bibblock">Approximate nearest neighbor negative contrastive learning for dense
text retrieval.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">International Conference on Learning Representations (ICLR)</em>,
2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2018)</span>
<span class="ltx_bibblock">
Yang, Z., Qi, P., Zhang, S., Bengio, Y., Cohen, W., Salakhutdinov, R., and
Manning, C. D.

</span>
<span class="ltx_bibblock">Hotpotqa: A dataset for diverse, explainable multi-hop question
answering.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">Proceedings of the 2018 Conference on Empirical Methods in
Natural Language Processing</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2022)</span>
<span class="ltx_bibblock">
Yu, H.-F., Zhong, K., Zhang, J., Chang, W.-C., and Dhillon, I. S.

</span>
<span class="ltx_bibblock">Pecos: Prediction for enormous and correlated output spaces.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">Journal of Machine Learning Research</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zaheer et al. (2017)</span>
<span class="ltx_bibblock">
Zaheer, M., Kottur, S., Ahmed, A., Moura, J., and Smola, A.

</span>
<span class="ltx_bibblock">Canopy fast sampling with cover trees.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">International Conference on Machine Learning (ICML)</em>, 2017.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Analysis: Proofs</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.2">See <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S4.Thmtheorem1" title="Lemma 4.1. ‣ 4 Analysis ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">4.1</span></a>
<em class="ltx_emph ltx_font_italic" id="A1.p1.2.1">Proof</em>. We bound the gap between true population risk and stale population risk.
Recall that <math alttext="\mathcal{G}_{\ell,\mathcal{F}}" class="ltx_Math" display="inline" id="A1.p1.1.m1.2"><semantics id="A1.p1.1.m1.2a"><msub id="A1.p1.1.m1.2.3" xref="A1.p1.1.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.1.m1.2.3.2" xref="A1.p1.1.m1.2.3.2.cmml">𝒢</mi><mrow id="A1.p1.1.m1.2.2.2.4" xref="A1.p1.1.m1.2.2.2.3.cmml"><mi id="A1.p1.1.m1.1.1.1.1" mathvariant="normal" xref="A1.p1.1.m1.1.1.1.1.cmml">ℓ</mi><mo id="A1.p1.1.m1.2.2.2.4.1" xref="A1.p1.1.m1.2.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A1.p1.1.m1.2.2.2.2" xref="A1.p1.1.m1.2.2.2.2.cmml">ℱ</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.2b"><apply id="A1.p1.1.m1.2.3.cmml" xref="A1.p1.1.m1.2.3"><csymbol cd="ambiguous" id="A1.p1.1.m1.2.3.1.cmml" xref="A1.p1.1.m1.2.3">subscript</csymbol><ci id="A1.p1.1.m1.2.3.2.cmml" xref="A1.p1.1.m1.2.3.2">𝒢</ci><list id="A1.p1.1.m1.2.2.2.3.cmml" xref="A1.p1.1.m1.2.2.2.4"><ci id="A1.p1.1.m1.1.1.1.1.cmml" xref="A1.p1.1.m1.1.1.1.1">ℓ</ci><ci id="A1.p1.1.m1.2.2.2.2.cmml" xref="A1.p1.1.m1.2.2.2.2">ℱ</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.2c">\mathcal{G}_{\ell,\mathcal{F}}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.1.m1.2d">caligraphic_G start_POSTSUBSCRIPT roman_ℓ , caligraphic_F end_POSTSUBSCRIPT</annotation></semantics></math> is the induced function class: <math alttext="\mathcal{G}_{\ell,\mathcal{F}}=\{y\mapsto\ell(f(y),g(y)):f\in\mathcal{F}\}." class="ltx_Math" display="inline" id="A1.p1.2.m2.5"><semantics id="A1.p1.2.m2.5a"><mrow id="A1.p1.2.m2.5.5.1" xref="A1.p1.2.m2.5.5.1.1.cmml"><mrow id="A1.p1.2.m2.5.5.1.1" xref="A1.p1.2.m2.5.5.1.1.cmml"><msub id="A1.p1.2.m2.5.5.1.1.4" xref="A1.p1.2.m2.5.5.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.2.m2.5.5.1.1.4.2" xref="A1.p1.2.m2.5.5.1.1.4.2.cmml">𝒢</mi><mrow id="A1.p1.2.m2.2.2.2.4" xref="A1.p1.2.m2.2.2.2.3.cmml"><mi id="A1.p1.2.m2.1.1.1.1" mathvariant="normal" xref="A1.p1.2.m2.1.1.1.1.cmml">ℓ</mi><mo id="A1.p1.2.m2.2.2.2.4.1" xref="A1.p1.2.m2.2.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A1.p1.2.m2.2.2.2.2" xref="A1.p1.2.m2.2.2.2.2.cmml">ℱ</mi></mrow></msub><mo id="A1.p1.2.m2.5.5.1.1.3" xref="A1.p1.2.m2.5.5.1.1.3.cmml">=</mo><mrow id="A1.p1.2.m2.5.5.1.1.2.2" xref="A1.p1.2.m2.5.5.1.1.2.3.cmml"><mo id="A1.p1.2.m2.5.5.1.1.2.2.3" stretchy="false" xref="A1.p1.2.m2.5.5.1.1.2.3.1.cmml">{</mo><mrow id="A1.p1.2.m2.5.5.1.1.1.1.1" xref="A1.p1.2.m2.5.5.1.1.1.1.1.cmml"><mi id="A1.p1.2.m2.5.5.1.1.1.1.1.4" xref="A1.p1.2.m2.5.5.1.1.1.1.1.4.cmml">y</mi><mo id="A1.p1.2.m2.5.5.1.1.1.1.1.3" stretchy="false" xref="A1.p1.2.m2.5.5.1.1.1.1.1.3.cmml">↦</mo><mrow id="A1.p1.2.m2.5.5.1.1.1.1.1.2" xref="A1.p1.2.m2.5.5.1.1.1.1.1.2.cmml"><mi id="A1.p1.2.m2.5.5.1.1.1.1.1.2.4" mathvariant="normal" xref="A1.p1.2.m2.5.5.1.1.1.1.1.2.4.cmml">ℓ</mi><mo id="A1.p1.2.m2.5.5.1.1.1.1.1.2.3" xref="A1.p1.2.m2.5.5.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.2" xref="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.3.cmml"><mo id="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.2.3" stretchy="false" xref="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.3.cmml">(</mo><mrow id="A1.p1.2.m2.5.5.1.1.1.1.1.1.1.1.1" xref="A1.p1.2.m2.5.5.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.p1.2.m2.5.5.1.1.1.1.1.1.1.1.1.2" xref="A1.p1.2.m2.5.5.1.1.1.1.1.1.1.1.1.2.cmml">f</mi><mo id="A1.p1.2.m2.5.5.1.1.1.1.1.1.1.1.1.1" xref="A1.p1.2.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.p1.2.m2.5.5.1.1.1.1.1.1.1.1.1.3.2" xref="A1.p1.2.m2.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.p1.2.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.p1.2.m2.5.5.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.p1.2.m2.3.3" xref="A1.p1.2.m2.3.3.cmml">y</mi><mo id="A1.p1.2.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A1.p1.2.m2.5.5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.2.4" xref="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.3.cmml">,</mo><mrow id="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.2.2" xref="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.2.2.cmml"><mi id="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.2.2.2" xref="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.2.2.2.cmml">g</mi><mo id="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.2.2.1" xref="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.2.2.1.cmml">⁢</mo><mrow id="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.2.2.3.2" xref="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.2.2.cmml"><mo id="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.2.2.3.2.1" stretchy="false" xref="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.2.2.cmml">(</mo><mi id="A1.p1.2.m2.4.4" xref="A1.p1.2.m2.4.4.cmml">y</mi><mo id="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.2.2.3.2.2" stretchy="false" xref="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.2.5" rspace="0.278em" stretchy="false" xref="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.p1.2.m2.5.5.1.1.2.2.4" rspace="0.278em" xref="A1.p1.2.m2.5.5.1.1.2.3.1.cmml">:</mo><mrow id="A1.p1.2.m2.5.5.1.1.2.2.2" xref="A1.p1.2.m2.5.5.1.1.2.2.2.cmml"><mi id="A1.p1.2.m2.5.5.1.1.2.2.2.2" xref="A1.p1.2.m2.5.5.1.1.2.2.2.2.cmml">f</mi><mo id="A1.p1.2.m2.5.5.1.1.2.2.2.1" xref="A1.p1.2.m2.5.5.1.1.2.2.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A1.p1.2.m2.5.5.1.1.2.2.2.3" xref="A1.p1.2.m2.5.5.1.1.2.2.2.3.cmml">ℱ</mi></mrow><mo id="A1.p1.2.m2.5.5.1.1.2.2.5" stretchy="false" xref="A1.p1.2.m2.5.5.1.1.2.3.1.cmml">}</mo></mrow></mrow><mo id="A1.p1.2.m2.5.5.1.2" lspace="0em" xref="A1.p1.2.m2.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.2.m2.5b"><apply id="A1.p1.2.m2.5.5.1.1.cmml" xref="A1.p1.2.m2.5.5.1"><eq id="A1.p1.2.m2.5.5.1.1.3.cmml" xref="A1.p1.2.m2.5.5.1.1.3"></eq><apply id="A1.p1.2.m2.5.5.1.1.4.cmml" xref="A1.p1.2.m2.5.5.1.1.4"><csymbol cd="ambiguous" id="A1.p1.2.m2.5.5.1.1.4.1.cmml" xref="A1.p1.2.m2.5.5.1.1.4">subscript</csymbol><ci id="A1.p1.2.m2.5.5.1.1.4.2.cmml" xref="A1.p1.2.m2.5.5.1.1.4.2">𝒢</ci><list id="A1.p1.2.m2.2.2.2.3.cmml" xref="A1.p1.2.m2.2.2.2.4"><ci id="A1.p1.2.m2.1.1.1.1.cmml" xref="A1.p1.2.m2.1.1.1.1">ℓ</ci><ci id="A1.p1.2.m2.2.2.2.2.cmml" xref="A1.p1.2.m2.2.2.2.2">ℱ</ci></list></apply><apply id="A1.p1.2.m2.5.5.1.1.2.3.cmml" xref="A1.p1.2.m2.5.5.1.1.2.2"><csymbol cd="latexml" id="A1.p1.2.m2.5.5.1.1.2.3.1.cmml" xref="A1.p1.2.m2.5.5.1.1.2.2.3">conditional-set</csymbol><apply id="A1.p1.2.m2.5.5.1.1.1.1.1.cmml" xref="A1.p1.2.m2.5.5.1.1.1.1.1"><csymbol cd="latexml" id="A1.p1.2.m2.5.5.1.1.1.1.1.3.cmml" xref="A1.p1.2.m2.5.5.1.1.1.1.1.3">maps-to</csymbol><ci id="A1.p1.2.m2.5.5.1.1.1.1.1.4.cmml" xref="A1.p1.2.m2.5.5.1.1.1.1.1.4">𝑦</ci><apply id="A1.p1.2.m2.5.5.1.1.1.1.1.2.cmml" xref="A1.p1.2.m2.5.5.1.1.1.1.1.2"><times id="A1.p1.2.m2.5.5.1.1.1.1.1.2.3.cmml" xref="A1.p1.2.m2.5.5.1.1.1.1.1.2.3"></times><ci id="A1.p1.2.m2.5.5.1.1.1.1.1.2.4.cmml" xref="A1.p1.2.m2.5.5.1.1.1.1.1.2.4">ℓ</ci><interval closure="open" id="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.3.cmml" xref="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.2"><apply id="A1.p1.2.m2.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="A1.p1.2.m2.5.5.1.1.1.1.1.1.1.1.1"><times id="A1.p1.2.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.p1.2.m2.5.5.1.1.1.1.1.1.1.1.1.1"></times><ci id="A1.p1.2.m2.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.p1.2.m2.5.5.1.1.1.1.1.1.1.1.1.2">𝑓</ci><ci id="A1.p1.2.m2.3.3.cmml" xref="A1.p1.2.m2.3.3">𝑦</ci></apply><apply id="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.2.2.cmml" xref="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.2.2"><times id="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.2.2.1.cmml" xref="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.2.2.1"></times><ci id="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.2.2.2.cmml" xref="A1.p1.2.m2.5.5.1.1.1.1.1.2.2.2.2.2">𝑔</ci><ci id="A1.p1.2.m2.4.4.cmml" xref="A1.p1.2.m2.4.4">𝑦</ci></apply></interval></apply></apply><apply id="A1.p1.2.m2.5.5.1.1.2.2.2.cmml" xref="A1.p1.2.m2.5.5.1.1.2.2.2"><in id="A1.p1.2.m2.5.5.1.1.2.2.2.1.cmml" xref="A1.p1.2.m2.5.5.1.1.2.2.2.1"></in><ci id="A1.p1.2.m2.5.5.1.1.2.2.2.2.cmml" xref="A1.p1.2.m2.5.5.1.1.2.2.2.2">𝑓</ci><ci id="A1.p1.2.m2.5.5.1.1.2.2.2.3.cmml" xref="A1.p1.2.m2.5.5.1.1.2.2.2.3">ℱ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.2.m2.5c">\mathcal{G}_{\ell,\mathcal{F}}=\{y\mapsto\ell(f(y),g(y)):f\in\mathcal{F}\}.</annotation><annotation encoding="application/x-llamapun" id="A1.p1.2.m2.5d">caligraphic_G start_POSTSUBSCRIPT roman_ℓ , caligraphic_F end_POSTSUBSCRIPT = { italic_y ↦ roman_ℓ ( italic_f ( italic_y ) , italic_g ( italic_y ) ) : italic_f ∈ caligraphic_F } .</annotation></semantics></math>
Now note that</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A2.EGx4">
<tbody id="A1.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle R_{\ell,f}(\mathscr{D}_{Y})-R_{\ell,f}(\tilde{\mathscr{D}}_{Y})" class="ltx_Math" display="inline" id="A1.E16.m2.6"><semantics id="A1.E16.m2.6a"><mrow id="A1.E16.m2.6.6" xref="A1.E16.m2.6.6.cmml"><mrow id="A1.E16.m2.5.5.1" xref="A1.E16.m2.5.5.1.cmml"><msub id="A1.E16.m2.5.5.1.3" xref="A1.E16.m2.5.5.1.3.cmml"><mi id="A1.E16.m2.5.5.1.3.2" xref="A1.E16.m2.5.5.1.3.2.cmml">R</mi><mrow id="A1.E16.m2.2.2.2.4" xref="A1.E16.m2.2.2.2.3.cmml"><mi id="A1.E16.m2.1.1.1.1" mathvariant="normal" xref="A1.E16.m2.1.1.1.1.cmml">ℓ</mi><mo id="A1.E16.m2.2.2.2.4.1" xref="A1.E16.m2.2.2.2.3.cmml">,</mo><mi id="A1.E16.m2.2.2.2.2" xref="A1.E16.m2.2.2.2.2.cmml">f</mi></mrow></msub><mo id="A1.E16.m2.5.5.1.2" xref="A1.E16.m2.5.5.1.2.cmml">⁢</mo><mrow id="A1.E16.m2.5.5.1.1.1" xref="A1.E16.m2.5.5.1.1.1.1.cmml"><mo id="A1.E16.m2.5.5.1.1.1.2" stretchy="false" xref="A1.E16.m2.5.5.1.1.1.1.cmml">(</mo><msub id="A1.E16.m2.5.5.1.1.1.1" xref="A1.E16.m2.5.5.1.1.1.1.cmml"><mi class="ltx_font_mathscript" id="A1.E16.m2.5.5.1.1.1.1.2" xref="A1.E16.m2.5.5.1.1.1.1.2.cmml">𝒟</mi><mi id="A1.E16.m2.5.5.1.1.1.1.3" xref="A1.E16.m2.5.5.1.1.1.1.3.cmml">Y</mi></msub><mo id="A1.E16.m2.5.5.1.1.1.3" stretchy="false" xref="A1.E16.m2.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E16.m2.6.6.3" xref="A1.E16.m2.6.6.3.cmml">−</mo><mrow id="A1.E16.m2.6.6.2" xref="A1.E16.m2.6.6.2.cmml"><msub id="A1.E16.m2.6.6.2.3" xref="A1.E16.m2.6.6.2.3.cmml"><mi id="A1.E16.m2.6.6.2.3.2" xref="A1.E16.m2.6.6.2.3.2.cmml">R</mi><mrow id="A1.E16.m2.4.4.2.4" xref="A1.E16.m2.4.4.2.3.cmml"><mi id="A1.E16.m2.3.3.1.1" mathvariant="normal" xref="A1.E16.m2.3.3.1.1.cmml">ℓ</mi><mo id="A1.E16.m2.4.4.2.4.1" xref="A1.E16.m2.4.4.2.3.cmml">,</mo><mi id="A1.E16.m2.4.4.2.2" xref="A1.E16.m2.4.4.2.2.cmml">f</mi></mrow></msub><mo id="A1.E16.m2.6.6.2.2" xref="A1.E16.m2.6.6.2.2.cmml">⁢</mo><mrow id="A1.E16.m2.6.6.2.1.1" xref="A1.E16.m2.6.6.2.1.1.1.cmml"><mo id="A1.E16.m2.6.6.2.1.1.2" stretchy="false" xref="A1.E16.m2.6.6.2.1.1.1.cmml">(</mo><msub id="A1.E16.m2.6.6.2.1.1.1" xref="A1.E16.m2.6.6.2.1.1.1.cmml"><mover accent="true" id="A1.E16.m2.6.6.2.1.1.1.2" xref="A1.E16.m2.6.6.2.1.1.1.2.cmml"><mi class="ltx_font_mathscript" id="A1.E16.m2.6.6.2.1.1.1.2.2" xref="A1.E16.m2.6.6.2.1.1.1.2.2.cmml">𝒟</mi><mo id="A1.E16.m2.6.6.2.1.1.1.2.1" xref="A1.E16.m2.6.6.2.1.1.1.2.1.cmml">~</mo></mover><mi id="A1.E16.m2.6.6.2.1.1.1.3" xref="A1.E16.m2.6.6.2.1.1.1.3.cmml">Y</mi></msub><mo id="A1.E16.m2.6.6.2.1.1.3" stretchy="false" xref="A1.E16.m2.6.6.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E16.m2.6b"><apply id="A1.E16.m2.6.6.cmml" xref="A1.E16.m2.6.6"><minus id="A1.E16.m2.6.6.3.cmml" xref="A1.E16.m2.6.6.3"></minus><apply id="A1.E16.m2.5.5.1.cmml" xref="A1.E16.m2.5.5.1"><times id="A1.E16.m2.5.5.1.2.cmml" xref="A1.E16.m2.5.5.1.2"></times><apply id="A1.E16.m2.5.5.1.3.cmml" xref="A1.E16.m2.5.5.1.3"><csymbol cd="ambiguous" id="A1.E16.m2.5.5.1.3.1.cmml" xref="A1.E16.m2.5.5.1.3">subscript</csymbol><ci id="A1.E16.m2.5.5.1.3.2.cmml" xref="A1.E16.m2.5.5.1.3.2">𝑅</ci><list id="A1.E16.m2.2.2.2.3.cmml" xref="A1.E16.m2.2.2.2.4"><ci id="A1.E16.m2.1.1.1.1.cmml" xref="A1.E16.m2.1.1.1.1">ℓ</ci><ci id="A1.E16.m2.2.2.2.2.cmml" xref="A1.E16.m2.2.2.2.2">𝑓</ci></list></apply><apply id="A1.E16.m2.5.5.1.1.1.1.cmml" xref="A1.E16.m2.5.5.1.1.1"><csymbol cd="ambiguous" id="A1.E16.m2.5.5.1.1.1.1.1.cmml" xref="A1.E16.m2.5.5.1.1.1">subscript</csymbol><ci id="A1.E16.m2.5.5.1.1.1.1.2.cmml" xref="A1.E16.m2.5.5.1.1.1.1.2">𝒟</ci><ci id="A1.E16.m2.5.5.1.1.1.1.3.cmml" xref="A1.E16.m2.5.5.1.1.1.1.3">𝑌</ci></apply></apply><apply id="A1.E16.m2.6.6.2.cmml" xref="A1.E16.m2.6.6.2"><times id="A1.E16.m2.6.6.2.2.cmml" xref="A1.E16.m2.6.6.2.2"></times><apply id="A1.E16.m2.6.6.2.3.cmml" xref="A1.E16.m2.6.6.2.3"><csymbol cd="ambiguous" id="A1.E16.m2.6.6.2.3.1.cmml" xref="A1.E16.m2.6.6.2.3">subscript</csymbol><ci id="A1.E16.m2.6.6.2.3.2.cmml" xref="A1.E16.m2.6.6.2.3.2">𝑅</ci><list id="A1.E16.m2.4.4.2.3.cmml" xref="A1.E16.m2.4.4.2.4"><ci id="A1.E16.m2.3.3.1.1.cmml" xref="A1.E16.m2.3.3.1.1">ℓ</ci><ci id="A1.E16.m2.4.4.2.2.cmml" xref="A1.E16.m2.4.4.2.2">𝑓</ci></list></apply><apply id="A1.E16.m2.6.6.2.1.1.1.cmml" xref="A1.E16.m2.6.6.2.1.1"><csymbol cd="ambiguous" id="A1.E16.m2.6.6.2.1.1.1.1.cmml" xref="A1.E16.m2.6.6.2.1.1">subscript</csymbol><apply id="A1.E16.m2.6.6.2.1.1.1.2.cmml" xref="A1.E16.m2.6.6.2.1.1.1.2"><ci id="A1.E16.m2.6.6.2.1.1.1.2.1.cmml" xref="A1.E16.m2.6.6.2.1.1.1.2.1">~</ci><ci id="A1.E16.m2.6.6.2.1.1.1.2.2.cmml" xref="A1.E16.m2.6.6.2.1.1.1.2.2">𝒟</ci></apply><ci id="A1.E16.m2.6.6.2.1.1.1.3.cmml" xref="A1.E16.m2.6.6.2.1.1.1.3">𝑌</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E16.m2.6c">\displaystyle R_{\ell,f}(\mathscr{D}_{Y})-R_{\ell,f}(\tilde{\mathscr{D}}_{Y})</annotation><annotation encoding="application/x-llamapun" id="A1.E16.m2.6d">italic_R start_POSTSUBSCRIPT roman_ℓ , italic_f end_POSTSUBSCRIPT ( script_D start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT ) - italic_R start_POSTSUBSCRIPT roman_ℓ , italic_f end_POSTSUBSCRIPT ( over~ start_ARG script_D end_ARG start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
<tbody id="A1.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbb{E}_{Y\sim\mathscr{D}_{Y}}\left[\ell(f(Y),g(Y)\right]-%
\mathbb{E}_{Y^{\prime}\sim\tilde{\mathscr{D}}_{Y}}\left[\ell(f(Y^{\prime}),g(Y%
^{\prime})\right]" class="ltx_math_unparsed" display="inline" id="A1.Ex5.m1.2"><semantics id="A1.Ex5.m1.2a"><mrow id="A1.Ex5.m1.2b"><mo id="A1.Ex5.m1.2.3">=</mo><msub id="A1.Ex5.m1.2.4"><mi id="A1.Ex5.m1.2.4.2">𝔼</mi><mrow id="A1.Ex5.m1.2.4.3"><mi id="A1.Ex5.m1.2.4.3.2">Y</mi><mo id="A1.Ex5.m1.2.4.3.1">∼</mo><msub id="A1.Ex5.m1.2.4.3.3"><mi class="ltx_font_mathscript" id="A1.Ex5.m1.2.4.3.3.2">𝒟</mi><mi id="A1.Ex5.m1.2.4.3.3.3">Y</mi></msub></mrow></msub><mrow id="A1.Ex5.m1.2.5"><mo id="A1.Ex5.m1.2.5.1">[</mo><mi id="A1.Ex5.m1.2.5.2" mathvariant="normal">ℓ</mi><mrow id="A1.Ex5.m1.2.5.3"><mo id="A1.Ex5.m1.2.5.3.1" stretchy="false">(</mo><mi id="A1.Ex5.m1.2.5.3.2">f</mi><mrow id="A1.Ex5.m1.2.5.3.3"><mo id="A1.Ex5.m1.2.5.3.3.1" stretchy="false">(</mo><mi id="A1.Ex5.m1.1.1">Y</mi><mo id="A1.Ex5.m1.2.5.3.3.2" stretchy="false">)</mo></mrow><mo id="A1.Ex5.m1.2.5.3.4">,</mo><mi id="A1.Ex5.m1.2.5.3.5">g</mi><mrow id="A1.Ex5.m1.2.5.3.6"><mo id="A1.Ex5.m1.2.5.3.6.1" stretchy="false">(</mo><mi id="A1.Ex5.m1.2.2">Y</mi><mo id="A1.Ex5.m1.2.5.3.6.2" stretchy="false">)</mo></mrow><mo id="A1.Ex5.m1.2.5.3.7">]</mo></mrow><mo id="A1.Ex5.m1.2.5.4">−</mo><msub id="A1.Ex5.m1.2.5.5"><mi id="A1.Ex5.m1.2.5.5.2">𝔼</mi><mrow id="A1.Ex5.m1.2.5.5.3"><msup id="A1.Ex5.m1.2.5.5.3.2"><mi id="A1.Ex5.m1.2.5.5.3.2.2">Y</mi><mo id="A1.Ex5.m1.2.5.5.3.2.3">′</mo></msup><mo id="A1.Ex5.m1.2.5.5.3.1">∼</mo><msub id="A1.Ex5.m1.2.5.5.3.3"><mover accent="true" id="A1.Ex5.m1.2.5.5.3.3.2"><mi class="ltx_font_mathscript" id="A1.Ex5.m1.2.5.5.3.3.2.2">𝒟</mi><mo id="A1.Ex5.m1.2.5.5.3.3.2.1">~</mo></mover><mi id="A1.Ex5.m1.2.5.5.3.3.3">Y</mi></msub></mrow></msub><mrow id="A1.Ex5.m1.2.5.6"><mo id="A1.Ex5.m1.2.5.6.1">[</mo><mi id="A1.Ex5.m1.2.5.6.2" mathvariant="normal">ℓ</mi><mrow id="A1.Ex5.m1.2.5.6.3"><mo id="A1.Ex5.m1.2.5.6.3.1" stretchy="false">(</mo><mi id="A1.Ex5.m1.2.5.6.3.2">f</mi><mrow id="A1.Ex5.m1.2.5.6.3.3"><mo id="A1.Ex5.m1.2.5.6.3.3.1" stretchy="false">(</mo><msup id="A1.Ex5.m1.2.5.6.3.3.2"><mi id="A1.Ex5.m1.2.5.6.3.3.2.2">Y</mi><mo id="A1.Ex5.m1.2.5.6.3.3.2.3">′</mo></msup><mo id="A1.Ex5.m1.2.5.6.3.3.3" stretchy="false">)</mo></mrow><mo id="A1.Ex5.m1.2.5.6.3.4">,</mo><mi id="A1.Ex5.m1.2.5.6.3.5">g</mi><mrow id="A1.Ex5.m1.2.5.6.3.6"><mo id="A1.Ex5.m1.2.5.6.3.6.1" stretchy="false">(</mo><msup id="A1.Ex5.m1.2.5.6.3.6.2"><mi id="A1.Ex5.m1.2.5.6.3.6.2.2">Y</mi><mo id="A1.Ex5.m1.2.5.6.3.6.2.3">′</mo></msup><mo id="A1.Ex5.m1.2.5.6.3.6.3" stretchy="false">)</mo></mrow><mo id="A1.Ex5.m1.2.5.6.3.7">]</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex" id="A1.Ex5.m1.2c">\displaystyle=\mathbb{E}_{Y\sim\mathscr{D}_{Y}}\left[\ell(f(Y),g(Y)\right]-%
\mathbb{E}_{Y^{\prime}\sim\tilde{\mathscr{D}}_{Y}}\left[\ell(f(Y^{\prime}),g(Y%
^{\prime})\right]</annotation><annotation encoding="application/x-llamapun" id="A1.Ex5.m1.2d">= blackboard_E start_POSTSUBSCRIPT italic_Y ∼ script_D start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ roman_ℓ ( italic_f ( italic_Y ) , italic_g ( italic_Y ) ] - blackboard_E start_POSTSUBSCRIPT italic_Y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∼ over~ start_ARG script_D end_ARG start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ roman_ℓ ( italic_f ( italic_Y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) , italic_g ( italic_Y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\leq\sup_{\lambda\in\mathcal{G}_{\ell,\mathcal{F}}}\left(\mathbb{%
E}_{Y\sim\mathscr{D}_{Y}}\left[\lambda(X)\right]-\mathbb{E}_{Y^{\prime}\sim%
\tilde{\mathscr{D}}_{Y}}\left[\lambda(Y^{\prime})\right]\right)" class="ltx_Math" display="inline" id="A1.Ex6.m1.4"><semantics id="A1.Ex6.m1.4a"><mrow id="A1.Ex6.m1.4.4" xref="A1.Ex6.m1.4.4.cmml"><mi id="A1.Ex6.m1.4.4.3" xref="A1.Ex6.m1.4.4.3.cmml"></mi><mo id="A1.Ex6.m1.4.4.2" rspace="0.1389em" xref="A1.Ex6.m1.4.4.2.cmml">≤</mo><mrow id="A1.Ex6.m1.4.4.1" xref="A1.Ex6.m1.4.4.1.cmml"><munder id="A1.Ex6.m1.4.4.1.2" xref="A1.Ex6.m1.4.4.1.2.cmml"><mo id="A1.Ex6.m1.4.4.1.2.2" lspace="0.1389em" movablelimits="false" rspace="0em" xref="A1.Ex6.m1.4.4.1.2.2.cmml">sup</mo><mrow id="A1.Ex6.m1.2.2.2" xref="A1.Ex6.m1.2.2.2.cmml"><mi id="A1.Ex6.m1.2.2.2.4" xref="A1.Ex6.m1.2.2.2.4.cmml">λ</mi><mo id="A1.Ex6.m1.2.2.2.3" xref="A1.Ex6.m1.2.2.2.3.cmml">∈</mo><msub id="A1.Ex6.m1.2.2.2.5" xref="A1.Ex6.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.Ex6.m1.2.2.2.5.2" xref="A1.Ex6.m1.2.2.2.5.2.cmml">𝒢</mi><mrow id="A1.Ex6.m1.2.2.2.2.2.4" xref="A1.Ex6.m1.2.2.2.2.2.3.cmml"><mi id="A1.Ex6.m1.1.1.1.1.1.1" mathvariant="normal" xref="A1.Ex6.m1.1.1.1.1.1.1.cmml">ℓ</mi><mo id="A1.Ex6.m1.2.2.2.2.2.4.1" xref="A1.Ex6.m1.2.2.2.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A1.Ex6.m1.2.2.2.2.2.2" xref="A1.Ex6.m1.2.2.2.2.2.2.cmml">ℱ</mi></mrow></msub></mrow></munder><mrow id="A1.Ex6.m1.4.4.1.1.1" xref="A1.Ex6.m1.4.4.1.1.1.1.cmml"><mo id="A1.Ex6.m1.4.4.1.1.1.2" xref="A1.Ex6.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="A1.Ex6.m1.4.4.1.1.1.1" xref="A1.Ex6.m1.4.4.1.1.1.1.cmml"><mrow id="A1.Ex6.m1.4.4.1.1.1.1.1" xref="A1.Ex6.m1.4.4.1.1.1.1.1.cmml"><msub id="A1.Ex6.m1.4.4.1.1.1.1.1.3" xref="A1.Ex6.m1.4.4.1.1.1.1.1.3.cmml"><mi id="A1.Ex6.m1.4.4.1.1.1.1.1.3.2" xref="A1.Ex6.m1.4.4.1.1.1.1.1.3.2.cmml">𝔼</mi><mrow id="A1.Ex6.m1.4.4.1.1.1.1.1.3.3" xref="A1.Ex6.m1.4.4.1.1.1.1.1.3.3.cmml"><mi id="A1.Ex6.m1.4.4.1.1.1.1.1.3.3.2" xref="A1.Ex6.m1.4.4.1.1.1.1.1.3.3.2.cmml">Y</mi><mo id="A1.Ex6.m1.4.4.1.1.1.1.1.3.3.1" xref="A1.Ex6.m1.4.4.1.1.1.1.1.3.3.1.cmml">∼</mo><msub id="A1.Ex6.m1.4.4.1.1.1.1.1.3.3.3" xref="A1.Ex6.m1.4.4.1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathscript" id="A1.Ex6.m1.4.4.1.1.1.1.1.3.3.3.2" xref="A1.Ex6.m1.4.4.1.1.1.1.1.3.3.3.2.cmml">𝒟</mi><mi id="A1.Ex6.m1.4.4.1.1.1.1.1.3.3.3.3" xref="A1.Ex6.m1.4.4.1.1.1.1.1.3.3.3.3.cmml">Y</mi></msub></mrow></msub><mo id="A1.Ex6.m1.4.4.1.1.1.1.1.2" xref="A1.Ex6.m1.4.4.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.2.cmml"><mo id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.2" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.2" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">λ</mi><mo id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex6.m1.3.3" xref="A1.Ex6.m1.3.3.cmml">X</mi><mo id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.3" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.Ex6.m1.4.4.1.1.1.1.3" xref="A1.Ex6.m1.4.4.1.1.1.1.3.cmml">−</mo><mrow id="A1.Ex6.m1.4.4.1.1.1.1.2" xref="A1.Ex6.m1.4.4.1.1.1.1.2.cmml"><msub id="A1.Ex6.m1.4.4.1.1.1.1.2.3" xref="A1.Ex6.m1.4.4.1.1.1.1.2.3.cmml"><mi id="A1.Ex6.m1.4.4.1.1.1.1.2.3.2" xref="A1.Ex6.m1.4.4.1.1.1.1.2.3.2.cmml">𝔼</mi><mrow id="A1.Ex6.m1.4.4.1.1.1.1.2.3.3" xref="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.cmml"><msup id="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.2" xref="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.2.cmml"><mi id="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.2.2" xref="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.2.2.cmml">Y</mi><mo id="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.2.3" xref="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.2.3.cmml">′</mo></msup><mo id="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.1" xref="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.1.cmml">∼</mo><msub id="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.3" xref="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.3.cmml"><mover accent="true" id="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.3.2" xref="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.3.2.cmml"><mi class="ltx_font_mathscript" id="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.3.2.2" xref="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.3.2.2.cmml">𝒟</mi><mo id="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.3.2.1" xref="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.3.2.1.cmml">~</mo></mover><mi id="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.3.3" xref="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.3.3.cmml">Y</mi></msub></mrow></msub><mo id="A1.Ex6.m1.4.4.1.1.1.1.2.2" xref="A1.Ex6.m1.4.4.1.1.1.1.2.2.cmml">⁢</mo><mrow id="A1.Ex6.m1.4.4.1.1.1.1.2.1.1" xref="A1.Ex6.m1.4.4.1.1.1.1.2.1.2.cmml"><mo id="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.2" xref="A1.Ex6.m1.4.4.1.1.1.1.2.1.2.1.cmml">[</mo><mrow id="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1" xref="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.cmml"><mi id="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.3" xref="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.3.cmml">λ</mi><mo id="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.2" xref="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.1.1" xref="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.1.1.2" stretchy="false" xref="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><msup id="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.1.1.1" xref="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.cmml"><mi id="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.2" xref="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.2.cmml">Y</mi><mo id="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.3" xref="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.1.1.3" stretchy="false" xref="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.3" xref="A1.Ex6.m1.4.4.1.1.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A1.Ex6.m1.4.4.1.1.1.3" xref="A1.Ex6.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex6.m1.4b"><apply id="A1.Ex6.m1.4.4.cmml" xref="A1.Ex6.m1.4.4"><leq id="A1.Ex6.m1.4.4.2.cmml" xref="A1.Ex6.m1.4.4.2"></leq><csymbol cd="latexml" id="A1.Ex6.m1.4.4.3.cmml" xref="A1.Ex6.m1.4.4.3">absent</csymbol><apply id="A1.Ex6.m1.4.4.1.cmml" xref="A1.Ex6.m1.4.4.1"><apply id="A1.Ex6.m1.4.4.1.2.cmml" xref="A1.Ex6.m1.4.4.1.2"><csymbol cd="ambiguous" id="A1.Ex6.m1.4.4.1.2.1.cmml" xref="A1.Ex6.m1.4.4.1.2">subscript</csymbol><csymbol cd="latexml" id="A1.Ex6.m1.4.4.1.2.2.cmml" xref="A1.Ex6.m1.4.4.1.2.2">supremum</csymbol><apply id="A1.Ex6.m1.2.2.2.cmml" xref="A1.Ex6.m1.2.2.2"><in id="A1.Ex6.m1.2.2.2.3.cmml" xref="A1.Ex6.m1.2.2.2.3"></in><ci id="A1.Ex6.m1.2.2.2.4.cmml" xref="A1.Ex6.m1.2.2.2.4">𝜆</ci><apply id="A1.Ex6.m1.2.2.2.5.cmml" xref="A1.Ex6.m1.2.2.2.5"><csymbol cd="ambiguous" id="A1.Ex6.m1.2.2.2.5.1.cmml" xref="A1.Ex6.m1.2.2.2.5">subscript</csymbol><ci id="A1.Ex6.m1.2.2.2.5.2.cmml" xref="A1.Ex6.m1.2.2.2.5.2">𝒢</ci><list id="A1.Ex6.m1.2.2.2.2.2.3.cmml" xref="A1.Ex6.m1.2.2.2.2.2.4"><ci id="A1.Ex6.m1.1.1.1.1.1.1.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1">ℓ</ci><ci id="A1.Ex6.m1.2.2.2.2.2.2.cmml" xref="A1.Ex6.m1.2.2.2.2.2.2">ℱ</ci></list></apply></apply></apply><apply id="A1.Ex6.m1.4.4.1.1.1.1.cmml" xref="A1.Ex6.m1.4.4.1.1.1"><minus id="A1.Ex6.m1.4.4.1.1.1.1.3.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.3"></minus><apply id="A1.Ex6.m1.4.4.1.1.1.1.1.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1"><times id="A1.Ex6.m1.4.4.1.1.1.1.1.2.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.2"></times><apply id="A1.Ex6.m1.4.4.1.1.1.1.1.3.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex6.m1.4.4.1.1.1.1.1.3.1.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex6.m1.4.4.1.1.1.1.1.3.2.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.3.2">𝔼</ci><apply id="A1.Ex6.m1.4.4.1.1.1.1.1.3.3.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.3.3"><csymbol cd="latexml" id="A1.Ex6.m1.4.4.1.1.1.1.1.3.3.1.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.3.3.1">similar-to</csymbol><ci id="A1.Ex6.m1.4.4.1.1.1.1.1.3.3.2.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.3.3.2">𝑌</ci><apply id="A1.Ex6.m1.4.4.1.1.1.1.1.3.3.3.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.Ex6.m1.4.4.1.1.1.1.1.3.3.3.1.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="A1.Ex6.m1.4.4.1.1.1.1.1.3.3.3.2.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.3.3.3.2">𝒟</ci><ci id="A1.Ex6.m1.4.4.1.1.1.1.1.3.3.3.3.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.3.3.3.3">𝑌</ci></apply></apply></apply><apply id="A1.Ex6.m1.4.4.1.1.1.1.1.1.2.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex6.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1"><times id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1"></times><ci id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.2">𝜆</ci><ci id="A1.Ex6.m1.3.3.cmml" xref="A1.Ex6.m1.3.3">𝑋</ci></apply></apply></apply><apply id="A1.Ex6.m1.4.4.1.1.1.1.2.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.2"><times id="A1.Ex6.m1.4.4.1.1.1.1.2.2.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.2.2"></times><apply id="A1.Ex6.m1.4.4.1.1.1.1.2.3.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.Ex6.m1.4.4.1.1.1.1.2.3.1.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.2.3">subscript</csymbol><ci id="A1.Ex6.m1.4.4.1.1.1.1.2.3.2.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.2.3.2">𝔼</ci><apply id="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.2.3.3"><csymbol cd="latexml" id="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.1.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.1">similar-to</csymbol><apply id="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.2.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.2"><csymbol cd="ambiguous" id="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.2.1.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.2">superscript</csymbol><ci id="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.2.2.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.2.2">𝑌</ci><ci id="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.2.3.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.2.3">′</ci></apply><apply id="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.3.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.3"><csymbol cd="ambiguous" id="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.3.1.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.3">subscript</csymbol><apply id="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.3.2.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.3.2"><ci id="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.3.2.1.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.3.2.1">~</ci><ci id="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.3.2.2.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.3.2.2">𝒟</ci></apply><ci id="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.3.3.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.2.3.3.3.3">𝑌</ci></apply></apply></apply><apply id="A1.Ex6.m1.4.4.1.1.1.1.2.1.2.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.2.1.1"><csymbol cd="latexml" id="A1.Ex6.m1.4.4.1.1.1.1.2.1.2.1.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.2">delimited-[]</csymbol><apply id="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1"><times id="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.2.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.2"></times><ci id="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.3.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.3">𝜆</ci><apply id="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.1.1">superscript</csymbol><ci id="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.2">𝑌</ci><ci id="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.2.1.1.1.1.1.1.3">′</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex6.m1.4c">\displaystyle\leq\sup_{\lambda\in\mathcal{G}_{\ell,\mathcal{F}}}\left(\mathbb{%
E}_{Y\sim\mathscr{D}_{Y}}\left[\lambda(X)\right]-\mathbb{E}_{Y^{\prime}\sim%
\tilde{\mathscr{D}}_{Y}}\left[\lambda(Y^{\prime})\right]\right)</annotation><annotation encoding="application/x-llamapun" id="A1.Ex6.m1.4d">≤ roman_sup start_POSTSUBSCRIPT italic_λ ∈ caligraphic_G start_POSTSUBSCRIPT roman_ℓ , caligraphic_F end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( blackboard_E start_POSTSUBSCRIPT italic_Y ∼ script_D start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ italic_λ ( italic_X ) ] - blackboard_E start_POSTSUBSCRIPT italic_Y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∼ over~ start_ARG script_D end_ARG start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ italic_λ ( italic_Y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ] )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\overset{(i)}{=}L\cdot\sup_{\lambda\in\mathcal{G}_{\ell,\mathcal{%
F}}}\left(\mathbb{E}_{Y\sim\mathscr{D}_{Y}}\left[\frac{\lambda(Y)}{L}\right]-%
\mathbb{E}_{Y^{\prime}\sim\tilde{\mathscr{D}}_{Y}}\left[\frac{\lambda(Y^{%
\prime})}{L}\right]\right)" class="ltx_Math" display="inline" id="A1.Ex7.m1.6"><semantics id="A1.Ex7.m1.6a"><mrow id="A1.Ex7.m1.6.6" xref="A1.Ex7.m1.6.6.cmml"><mrow id="A1.Ex7.m1.6.6.3" xref="A1.Ex7.m1.6.6.3.cmml"><mover accent="true" id="A1.Ex7.m1.1.1" xref="A1.Ex7.m1.1.1.cmml"><mo id="A1.Ex7.m1.1.1.2" xref="A1.Ex7.m1.1.1.2.cmml">=</mo><mrow id="A1.Ex7.m1.1.1.1.3" xref="A1.Ex7.m1.1.1.cmml"><mo id="A1.Ex7.m1.1.1.1.3.1" stretchy="false" xref="A1.Ex7.m1.1.1.cmml">(</mo><mi id="A1.Ex7.m1.1.1.1.1" xref="A1.Ex7.m1.1.1.1.1.cmml">i</mi><mo id="A1.Ex7.m1.1.1.1.3.2" stretchy="false" xref="A1.Ex7.m1.1.1.cmml">)</mo></mrow></mover><mo id="A1.Ex7.m1.6.6.3.1" xref="A1.Ex7.m1.6.6.3.1.cmml">⁢</mo><mi id="A1.Ex7.m1.6.6.3.2" xref="A1.Ex7.m1.6.6.3.2.cmml">L</mi></mrow><mo id="A1.Ex7.m1.6.6.2" lspace="0.222em" xref="A1.Ex7.m1.6.6.2.cmml">⋅</mo><mrow id="A1.Ex7.m1.6.6.1" xref="A1.Ex7.m1.6.6.1.cmml"><munder id="A1.Ex7.m1.6.6.1.2" xref="A1.Ex7.m1.6.6.1.2.cmml"><mo id="A1.Ex7.m1.6.6.1.2.2" lspace="0.055em" movablelimits="false" rspace="0em" xref="A1.Ex7.m1.6.6.1.2.2.cmml">sup</mo><mrow id="A1.Ex7.m1.3.3.2" xref="A1.Ex7.m1.3.3.2.cmml"><mi id="A1.Ex7.m1.3.3.2.4" xref="A1.Ex7.m1.3.3.2.4.cmml">λ</mi><mo id="A1.Ex7.m1.3.3.2.3" xref="A1.Ex7.m1.3.3.2.3.cmml">∈</mo><msub id="A1.Ex7.m1.3.3.2.5" xref="A1.Ex7.m1.3.3.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.Ex7.m1.3.3.2.5.2" xref="A1.Ex7.m1.3.3.2.5.2.cmml">𝒢</mi><mrow id="A1.Ex7.m1.3.3.2.2.2.4" xref="A1.Ex7.m1.3.3.2.2.2.3.cmml"><mi id="A1.Ex7.m1.2.2.1.1.1.1" mathvariant="normal" xref="A1.Ex7.m1.2.2.1.1.1.1.cmml">ℓ</mi><mo id="A1.Ex7.m1.3.3.2.2.2.4.1" xref="A1.Ex7.m1.3.3.2.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A1.Ex7.m1.3.3.2.2.2.2" xref="A1.Ex7.m1.3.3.2.2.2.2.cmml">ℱ</mi></mrow></msub></mrow></munder><mrow id="A1.Ex7.m1.6.6.1.1.1" xref="A1.Ex7.m1.6.6.1.1.1.1.cmml"><mo id="A1.Ex7.m1.6.6.1.1.1.2" xref="A1.Ex7.m1.6.6.1.1.1.1.cmml">(</mo><mrow id="A1.Ex7.m1.6.6.1.1.1.1" xref="A1.Ex7.m1.6.6.1.1.1.1.cmml"><mrow id="A1.Ex7.m1.6.6.1.1.1.1.2" xref="A1.Ex7.m1.6.6.1.1.1.1.2.cmml"><msub id="A1.Ex7.m1.6.6.1.1.1.1.2.2" xref="A1.Ex7.m1.6.6.1.1.1.1.2.2.cmml"><mi id="A1.Ex7.m1.6.6.1.1.1.1.2.2.2" xref="A1.Ex7.m1.6.6.1.1.1.1.2.2.2.cmml">𝔼</mi><mrow id="A1.Ex7.m1.6.6.1.1.1.1.2.2.3" xref="A1.Ex7.m1.6.6.1.1.1.1.2.2.3.cmml"><mi id="A1.Ex7.m1.6.6.1.1.1.1.2.2.3.2" xref="A1.Ex7.m1.6.6.1.1.1.1.2.2.3.2.cmml">Y</mi><mo id="A1.Ex7.m1.6.6.1.1.1.1.2.2.3.1" xref="A1.Ex7.m1.6.6.1.1.1.1.2.2.3.1.cmml">∼</mo><msub id="A1.Ex7.m1.6.6.1.1.1.1.2.2.3.3" xref="A1.Ex7.m1.6.6.1.1.1.1.2.2.3.3.cmml"><mi class="ltx_font_mathscript" id="A1.Ex7.m1.6.6.1.1.1.1.2.2.3.3.2" xref="A1.Ex7.m1.6.6.1.1.1.1.2.2.3.3.2.cmml">𝒟</mi><mi id="A1.Ex7.m1.6.6.1.1.1.1.2.2.3.3.3" xref="A1.Ex7.m1.6.6.1.1.1.1.2.2.3.3.3.cmml">Y</mi></msub></mrow></msub><mo id="A1.Ex7.m1.6.6.1.1.1.1.2.1" xref="A1.Ex7.m1.6.6.1.1.1.1.2.1.cmml">⁢</mo><mrow id="A1.Ex7.m1.6.6.1.1.1.1.2.3.2" xref="A1.Ex7.m1.6.6.1.1.1.1.2.3.1.cmml"><mo id="A1.Ex7.m1.6.6.1.1.1.1.2.3.2.1" xref="A1.Ex7.m1.6.6.1.1.1.1.2.3.1.1.cmml">[</mo><mstyle displaystyle="true" id="A1.Ex7.m1.4.4" xref="A1.Ex7.m1.4.4.cmml"><mfrac id="A1.Ex7.m1.4.4a" xref="A1.Ex7.m1.4.4.cmml"><mrow id="A1.Ex7.m1.4.4.1" xref="A1.Ex7.m1.4.4.1.cmml"><mi id="A1.Ex7.m1.4.4.1.3" xref="A1.Ex7.m1.4.4.1.3.cmml">λ</mi><mo id="A1.Ex7.m1.4.4.1.2" xref="A1.Ex7.m1.4.4.1.2.cmml">⁢</mo><mrow id="A1.Ex7.m1.4.4.1.4.2" xref="A1.Ex7.m1.4.4.1.cmml"><mo id="A1.Ex7.m1.4.4.1.4.2.1" stretchy="false" xref="A1.Ex7.m1.4.4.1.cmml">(</mo><mi id="A1.Ex7.m1.4.4.1.1" xref="A1.Ex7.m1.4.4.1.1.cmml">Y</mi><mo id="A1.Ex7.m1.4.4.1.4.2.2" stretchy="false" xref="A1.Ex7.m1.4.4.1.cmml">)</mo></mrow></mrow><mi id="A1.Ex7.m1.4.4.3" xref="A1.Ex7.m1.4.4.3.cmml">L</mi></mfrac></mstyle><mo id="A1.Ex7.m1.6.6.1.1.1.1.2.3.2.2" xref="A1.Ex7.m1.6.6.1.1.1.1.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="A1.Ex7.m1.6.6.1.1.1.1.1" xref="A1.Ex7.m1.6.6.1.1.1.1.1.cmml">−</mo><mrow id="A1.Ex7.m1.6.6.1.1.1.1.3" xref="A1.Ex7.m1.6.6.1.1.1.1.3.cmml"><msub id="A1.Ex7.m1.6.6.1.1.1.1.3.2" xref="A1.Ex7.m1.6.6.1.1.1.1.3.2.cmml"><mi id="A1.Ex7.m1.6.6.1.1.1.1.3.2.2" xref="A1.Ex7.m1.6.6.1.1.1.1.3.2.2.cmml">𝔼</mi><mrow id="A1.Ex7.m1.6.6.1.1.1.1.3.2.3" xref="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.cmml"><msup id="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.2" xref="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.2.cmml"><mi id="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.2.2" xref="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.2.2.cmml">Y</mi><mo id="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.2.3" xref="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.2.3.cmml">′</mo></msup><mo id="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.1" xref="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.1.cmml">∼</mo><msub id="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.3" xref="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.3.cmml"><mover accent="true" id="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.3.2" xref="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.3.2.cmml"><mi class="ltx_font_mathscript" id="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.3.2.2" xref="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.3.2.2.cmml">𝒟</mi><mo id="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.3.2.1" xref="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.3.2.1.cmml">~</mo></mover><mi id="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.3.3" xref="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.3.3.cmml">Y</mi></msub></mrow></msub><mo id="A1.Ex7.m1.6.6.1.1.1.1.3.1" xref="A1.Ex7.m1.6.6.1.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.Ex7.m1.6.6.1.1.1.1.3.3.2" xref="A1.Ex7.m1.6.6.1.1.1.1.3.3.1.cmml"><mo id="A1.Ex7.m1.6.6.1.1.1.1.3.3.2.1" xref="A1.Ex7.m1.6.6.1.1.1.1.3.3.1.1.cmml">[</mo><mstyle displaystyle="true" id="A1.Ex7.m1.5.5" xref="A1.Ex7.m1.5.5.cmml"><mfrac id="A1.Ex7.m1.5.5a" xref="A1.Ex7.m1.5.5.cmml"><mrow id="A1.Ex7.m1.5.5.1" xref="A1.Ex7.m1.5.5.1.cmml"><mi id="A1.Ex7.m1.5.5.1.3" xref="A1.Ex7.m1.5.5.1.3.cmml">λ</mi><mo id="A1.Ex7.m1.5.5.1.2" xref="A1.Ex7.m1.5.5.1.2.cmml">⁢</mo><mrow id="A1.Ex7.m1.5.5.1.1.1" xref="A1.Ex7.m1.5.5.1.1.1.1.cmml"><mo id="A1.Ex7.m1.5.5.1.1.1.2" stretchy="false" xref="A1.Ex7.m1.5.5.1.1.1.1.cmml">(</mo><msup id="A1.Ex7.m1.5.5.1.1.1.1" xref="A1.Ex7.m1.5.5.1.1.1.1.cmml"><mi id="A1.Ex7.m1.5.5.1.1.1.1.2" xref="A1.Ex7.m1.5.5.1.1.1.1.2.cmml">Y</mi><mo id="A1.Ex7.m1.5.5.1.1.1.1.3" xref="A1.Ex7.m1.5.5.1.1.1.1.3.cmml">′</mo></msup><mo id="A1.Ex7.m1.5.5.1.1.1.3" stretchy="false" xref="A1.Ex7.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mi id="A1.Ex7.m1.5.5.3" xref="A1.Ex7.m1.5.5.3.cmml">L</mi></mfrac></mstyle><mo id="A1.Ex7.m1.6.6.1.1.1.1.3.3.2.2" xref="A1.Ex7.m1.6.6.1.1.1.1.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><mo id="A1.Ex7.m1.6.6.1.1.1.3" xref="A1.Ex7.m1.6.6.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex7.m1.6b"><apply id="A1.Ex7.m1.6.6.cmml" xref="A1.Ex7.m1.6.6"><ci id="A1.Ex7.m1.6.6.2.cmml" xref="A1.Ex7.m1.6.6.2">⋅</ci><apply id="A1.Ex7.m1.6.6.3.cmml" xref="A1.Ex7.m1.6.6.3"><times id="A1.Ex7.m1.6.6.3.1.cmml" xref="A1.Ex7.m1.6.6.3.1"></times><apply id="A1.Ex7.m1.1.1.cmml" xref="A1.Ex7.m1.1.1"><ci id="A1.Ex7.m1.1.1.1.1.cmml" xref="A1.Ex7.m1.1.1.1.1">𝑖</ci><eq id="A1.Ex7.m1.1.1.2.cmml" xref="A1.Ex7.m1.1.1.2"></eq></apply><ci id="A1.Ex7.m1.6.6.3.2.cmml" xref="A1.Ex7.m1.6.6.3.2">𝐿</ci></apply><apply id="A1.Ex7.m1.6.6.1.cmml" xref="A1.Ex7.m1.6.6.1"><apply id="A1.Ex7.m1.6.6.1.2.cmml" xref="A1.Ex7.m1.6.6.1.2"><csymbol cd="ambiguous" id="A1.Ex7.m1.6.6.1.2.1.cmml" xref="A1.Ex7.m1.6.6.1.2">subscript</csymbol><csymbol cd="latexml" id="A1.Ex7.m1.6.6.1.2.2.cmml" xref="A1.Ex7.m1.6.6.1.2.2">supremum</csymbol><apply id="A1.Ex7.m1.3.3.2.cmml" xref="A1.Ex7.m1.3.3.2"><in id="A1.Ex7.m1.3.3.2.3.cmml" xref="A1.Ex7.m1.3.3.2.3"></in><ci id="A1.Ex7.m1.3.3.2.4.cmml" xref="A1.Ex7.m1.3.3.2.4">𝜆</ci><apply id="A1.Ex7.m1.3.3.2.5.cmml" xref="A1.Ex7.m1.3.3.2.5"><csymbol cd="ambiguous" id="A1.Ex7.m1.3.3.2.5.1.cmml" xref="A1.Ex7.m1.3.3.2.5">subscript</csymbol><ci id="A1.Ex7.m1.3.3.2.5.2.cmml" xref="A1.Ex7.m1.3.3.2.5.2">𝒢</ci><list id="A1.Ex7.m1.3.3.2.2.2.3.cmml" xref="A1.Ex7.m1.3.3.2.2.2.4"><ci id="A1.Ex7.m1.2.2.1.1.1.1.cmml" xref="A1.Ex7.m1.2.2.1.1.1.1">ℓ</ci><ci id="A1.Ex7.m1.3.3.2.2.2.2.cmml" xref="A1.Ex7.m1.3.3.2.2.2.2">ℱ</ci></list></apply></apply></apply><apply id="A1.Ex7.m1.6.6.1.1.1.1.cmml" xref="A1.Ex7.m1.6.6.1.1.1"><minus id="A1.Ex7.m1.6.6.1.1.1.1.1.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.1"></minus><apply id="A1.Ex7.m1.6.6.1.1.1.1.2.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.2"><times id="A1.Ex7.m1.6.6.1.1.1.1.2.1.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.2.1"></times><apply id="A1.Ex7.m1.6.6.1.1.1.1.2.2.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.Ex7.m1.6.6.1.1.1.1.2.2.1.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.2.2">subscript</csymbol><ci id="A1.Ex7.m1.6.6.1.1.1.1.2.2.2.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.2.2.2">𝔼</ci><apply id="A1.Ex7.m1.6.6.1.1.1.1.2.2.3.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.2.2.3"><csymbol cd="latexml" id="A1.Ex7.m1.6.6.1.1.1.1.2.2.3.1.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.2.2.3.1">similar-to</csymbol><ci id="A1.Ex7.m1.6.6.1.1.1.1.2.2.3.2.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.2.2.3.2">𝑌</ci><apply id="A1.Ex7.m1.6.6.1.1.1.1.2.2.3.3.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.2.2.3.3"><csymbol cd="ambiguous" id="A1.Ex7.m1.6.6.1.1.1.1.2.2.3.3.1.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.2.2.3.3">subscript</csymbol><ci id="A1.Ex7.m1.6.6.1.1.1.1.2.2.3.3.2.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.2.2.3.3.2">𝒟</ci><ci id="A1.Ex7.m1.6.6.1.1.1.1.2.2.3.3.3.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.2.2.3.3.3">𝑌</ci></apply></apply></apply><apply id="A1.Ex7.m1.6.6.1.1.1.1.2.3.1.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.2.3.2"><csymbol cd="latexml" id="A1.Ex7.m1.6.6.1.1.1.1.2.3.1.1.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.2.3.2.1">delimited-[]</csymbol><apply id="A1.Ex7.m1.4.4.cmml" xref="A1.Ex7.m1.4.4"><divide id="A1.Ex7.m1.4.4.2.cmml" xref="A1.Ex7.m1.4.4"></divide><apply id="A1.Ex7.m1.4.4.1.cmml" xref="A1.Ex7.m1.4.4.1"><times id="A1.Ex7.m1.4.4.1.2.cmml" xref="A1.Ex7.m1.4.4.1.2"></times><ci id="A1.Ex7.m1.4.4.1.3.cmml" xref="A1.Ex7.m1.4.4.1.3">𝜆</ci><ci id="A1.Ex7.m1.4.4.1.1.cmml" xref="A1.Ex7.m1.4.4.1.1">𝑌</ci></apply><ci id="A1.Ex7.m1.4.4.3.cmml" xref="A1.Ex7.m1.4.4.3">𝐿</ci></apply></apply></apply><apply id="A1.Ex7.m1.6.6.1.1.1.1.3.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.3"><times id="A1.Ex7.m1.6.6.1.1.1.1.3.1.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.3.1"></times><apply id="A1.Ex7.m1.6.6.1.1.1.1.3.2.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.Ex7.m1.6.6.1.1.1.1.3.2.1.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.3.2">subscript</csymbol><ci id="A1.Ex7.m1.6.6.1.1.1.1.3.2.2.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.3.2.2">𝔼</ci><apply id="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.3.2.3"><csymbol cd="latexml" id="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.1.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.1">similar-to</csymbol><apply id="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.2.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.2"><csymbol cd="ambiguous" id="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.2.1.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.2">superscript</csymbol><ci id="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.2.2.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.2.2">𝑌</ci><ci id="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.2.3.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.2.3">′</ci></apply><apply id="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.3.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.3"><csymbol cd="ambiguous" id="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.3.1.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.3">subscript</csymbol><apply id="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.3.2.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.3.2"><ci id="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.3.2.1.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.3.2.1">~</ci><ci id="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.3.2.2.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.3.2.2">𝒟</ci></apply><ci id="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.3.3.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.3.2.3.3.3">𝑌</ci></apply></apply></apply><apply id="A1.Ex7.m1.6.6.1.1.1.1.3.3.1.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.3.3.2"><csymbol cd="latexml" id="A1.Ex7.m1.6.6.1.1.1.1.3.3.1.1.cmml" xref="A1.Ex7.m1.6.6.1.1.1.1.3.3.2.1">delimited-[]</csymbol><apply id="A1.Ex7.m1.5.5.cmml" xref="A1.Ex7.m1.5.5"><divide id="A1.Ex7.m1.5.5.2.cmml" xref="A1.Ex7.m1.5.5"></divide><apply id="A1.Ex7.m1.5.5.1.cmml" xref="A1.Ex7.m1.5.5.1"><times id="A1.Ex7.m1.5.5.1.2.cmml" xref="A1.Ex7.m1.5.5.1.2"></times><ci id="A1.Ex7.m1.5.5.1.3.cmml" xref="A1.Ex7.m1.5.5.1.3">𝜆</ci><apply id="A1.Ex7.m1.5.5.1.1.1.1.cmml" xref="A1.Ex7.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="A1.Ex7.m1.5.5.1.1.1.1.1.cmml" xref="A1.Ex7.m1.5.5.1.1.1">superscript</csymbol><ci id="A1.Ex7.m1.5.5.1.1.1.1.2.cmml" xref="A1.Ex7.m1.5.5.1.1.1.1.2">𝑌</ci><ci id="A1.Ex7.m1.5.5.1.1.1.1.3.cmml" xref="A1.Ex7.m1.5.5.1.1.1.1.3">′</ci></apply></apply><ci id="A1.Ex7.m1.5.5.3.cmml" xref="A1.Ex7.m1.5.5.3">𝐿</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex7.m1.6c">\displaystyle\overset{(i)}{=}L\cdot\sup_{\lambda\in\mathcal{G}_{\ell,\mathcal{%
F}}}\left(\mathbb{E}_{Y\sim\mathscr{D}_{Y}}\left[\frac{\lambda(Y)}{L}\right]-%
\mathbb{E}_{Y^{\prime}\sim\tilde{\mathscr{D}}_{Y}}\left[\frac{\lambda(Y^{%
\prime})}{L}\right]\right)</annotation><annotation encoding="application/x-llamapun" id="A1.Ex7.m1.6d">start_OVERACCENT ( italic_i ) end_OVERACCENT start_ARG = end_ARG italic_L ⋅ roman_sup start_POSTSUBSCRIPT italic_λ ∈ caligraphic_G start_POSTSUBSCRIPT roman_ℓ , caligraphic_F end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( blackboard_E start_POSTSUBSCRIPT italic_Y ∼ script_D start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ divide start_ARG italic_λ ( italic_Y ) end_ARG start_ARG italic_L end_ARG ] - blackboard_E start_POSTSUBSCRIPT italic_Y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∼ over~ start_ARG script_D end_ARG start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ divide start_ARG italic_λ ( italic_Y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) end_ARG start_ARG italic_L end_ARG ] )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\overset{(ii)}{\leq}L\cdot\sup_{\lambda\in{\rm Lip}_{1}(\rho)}%
\left(\mathbb{E}_{X\sim\mathscr{D}_{Y}}\left[\lambda(X)\right]-\mathbb{E}_{Y^{%
\prime}\sim\tilde{\mathscr{D}}_{Y}}\left[\lambda(Y^{\prime})\right]\right)," class="ltx_Math" display="inline" id="A1.Ex8.m1.4"><semantics id="A1.Ex8.m1.4a"><mrow id="A1.Ex8.m1.4.4.1" xref="A1.Ex8.m1.4.4.1.1.cmml"><mrow id="A1.Ex8.m1.4.4.1.1" xref="A1.Ex8.m1.4.4.1.1.cmml"><mrow id="A1.Ex8.m1.4.4.1.1.3" xref="A1.Ex8.m1.4.4.1.1.3.cmml"><mover accent="true" id="A1.Ex8.m1.1.1" xref="A1.Ex8.m1.1.1.cmml"><mo id="A1.Ex8.m1.1.1.2" xref="A1.Ex8.m1.1.1.2.cmml">≤</mo><mrow id="A1.Ex8.m1.1.1.1.1" xref="A1.Ex8.m1.1.1.1.1.1.cmml"><mo id="A1.Ex8.m1.1.1.1.1.2" stretchy="false" xref="A1.Ex8.m1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex8.m1.1.1.1.1.1" xref="A1.Ex8.m1.1.1.1.1.1.cmml"><mi id="A1.Ex8.m1.1.1.1.1.1.2" xref="A1.Ex8.m1.1.1.1.1.1.2.cmml">i</mi><mo id="A1.Ex8.m1.1.1.1.1.1.1" xref="A1.Ex8.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.Ex8.m1.1.1.1.1.1.3" xref="A1.Ex8.m1.1.1.1.1.1.3.cmml">i</mi></mrow><mo id="A1.Ex8.m1.1.1.1.1.3" stretchy="false" xref="A1.Ex8.m1.1.1.1.1.1.cmml">)</mo></mrow></mover><mo id="A1.Ex8.m1.4.4.1.1.3.1" xref="A1.Ex8.m1.4.4.1.1.3.1.cmml">⁢</mo><mi id="A1.Ex8.m1.4.4.1.1.3.2" xref="A1.Ex8.m1.4.4.1.1.3.2.cmml">L</mi></mrow><mo id="A1.Ex8.m1.4.4.1.1.2" lspace="0.222em" xref="A1.Ex8.m1.4.4.1.1.2.cmml">⋅</mo><mrow id="A1.Ex8.m1.4.4.1.1.1" xref="A1.Ex8.m1.4.4.1.1.1.cmml"><munder id="A1.Ex8.m1.4.4.1.1.1.2" xref="A1.Ex8.m1.4.4.1.1.1.2.cmml"><mo id="A1.Ex8.m1.4.4.1.1.1.2.2" lspace="0.055em" movablelimits="false" rspace="0em" xref="A1.Ex8.m1.4.4.1.1.1.2.2.cmml">sup</mo><mrow id="A1.Ex8.m1.2.2.1" xref="A1.Ex8.m1.2.2.1.cmml"><mi id="A1.Ex8.m1.2.2.1.3" xref="A1.Ex8.m1.2.2.1.3.cmml">λ</mi><mo id="A1.Ex8.m1.2.2.1.2" xref="A1.Ex8.m1.2.2.1.2.cmml">∈</mo><mrow id="A1.Ex8.m1.2.2.1.4" xref="A1.Ex8.m1.2.2.1.4.cmml"><msub id="A1.Ex8.m1.2.2.1.4.2" xref="A1.Ex8.m1.2.2.1.4.2.cmml"><mi id="A1.Ex8.m1.2.2.1.4.2.2" xref="A1.Ex8.m1.2.2.1.4.2.2.cmml">Lip</mi><mn id="A1.Ex8.m1.2.2.1.4.2.3" xref="A1.Ex8.m1.2.2.1.4.2.3.cmml">1</mn></msub><mo id="A1.Ex8.m1.2.2.1.4.1" xref="A1.Ex8.m1.2.2.1.4.1.cmml">⁢</mo><mrow id="A1.Ex8.m1.2.2.1.4.3.2" xref="A1.Ex8.m1.2.2.1.4.cmml"><mo id="A1.Ex8.m1.2.2.1.4.3.2.1" stretchy="false" xref="A1.Ex8.m1.2.2.1.4.cmml">(</mo><mi id="A1.Ex8.m1.2.2.1.1" xref="A1.Ex8.m1.2.2.1.1.cmml">ρ</mi><mo id="A1.Ex8.m1.2.2.1.4.3.2.2" stretchy="false" xref="A1.Ex8.m1.2.2.1.4.cmml">)</mo></mrow></mrow></mrow></munder><mrow id="A1.Ex8.m1.4.4.1.1.1.1.1" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.cmml"><mo id="A1.Ex8.m1.4.4.1.1.1.1.1.2" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex8.m1.4.4.1.1.1.1.1.1" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.cmml"><mrow id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.cmml"><msub id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.2" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.2.cmml">𝔼</mi><mrow id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.3" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.3.cmml"><mi id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.3.2" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.3.2.cmml">X</mi><mo id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.3.1" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.3.1.cmml">∼</mo><msub id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.3.3" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathscript" id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.3.3.2" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.3.3.2.cmml">𝒟</mi><mi id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.3.3.3" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.3.3.3.cmml">Y</mi></msub></mrow></msub><mo id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.2" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.2.cmml"><mo id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml">λ</mi><mo id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex8.m1.3.3" xref="A1.Ex8.m1.3.3.cmml">X</mi><mo id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.Ex8.m1.4.4.1.1.1.1.1.1.3" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.3.cmml">−</mo><mrow id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.cmml"><msub id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.cmml"><mi id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.2" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.2.cmml">𝔼</mi><mrow id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.cmml"><msup id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.2" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.2.cmml"><mi id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.2.2" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.2.2.cmml">Y</mi><mo id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.2.3" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.2.3.cmml">′</mo></msup><mo id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.1" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.1.cmml">∼</mo><msub id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.3" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.3.cmml"><mover accent="true" id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.3.2" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.3.2.cmml"><mi class="ltx_font_mathscript" id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.3.2.2" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.3.2.2.cmml">𝒟</mi><mo id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.3.2.1" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.3.2.1.cmml">~</mo></mover><mi id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.3.3" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.3.3.cmml">Y</mi></msub></mrow></msub><mo id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.2" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.2.cmml"><mo id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.2" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.2.1.cmml">[</mo><mrow id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.3" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.3.cmml">λ</mi><mo id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.2" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.1" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.1.2" stretchy="false" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><msup id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.1.1" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mi id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.1.1.2" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">Y</mi><mo id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.1.1.3" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.1.3" stretchy="false" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.3" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A1.Ex8.m1.4.4.1.1.1.1.1.3" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.Ex8.m1.4.4.1.2" xref="A1.Ex8.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex8.m1.4b"><apply id="A1.Ex8.m1.4.4.1.1.cmml" xref="A1.Ex8.m1.4.4.1"><ci id="A1.Ex8.m1.4.4.1.1.2.cmml" xref="A1.Ex8.m1.4.4.1.1.2">⋅</ci><apply id="A1.Ex8.m1.4.4.1.1.3.cmml" xref="A1.Ex8.m1.4.4.1.1.3"><times id="A1.Ex8.m1.4.4.1.1.3.1.cmml" xref="A1.Ex8.m1.4.4.1.1.3.1"></times><apply id="A1.Ex8.m1.1.1.cmml" xref="A1.Ex8.m1.1.1"><apply id="A1.Ex8.m1.1.1.1.1.1.cmml" xref="A1.Ex8.m1.1.1.1.1"><times id="A1.Ex8.m1.1.1.1.1.1.1.cmml" xref="A1.Ex8.m1.1.1.1.1.1.1"></times><ci id="A1.Ex8.m1.1.1.1.1.1.2.cmml" xref="A1.Ex8.m1.1.1.1.1.1.2">𝑖</ci><ci id="A1.Ex8.m1.1.1.1.1.1.3.cmml" xref="A1.Ex8.m1.1.1.1.1.1.3">𝑖</ci></apply><leq id="A1.Ex8.m1.1.1.2.cmml" xref="A1.Ex8.m1.1.1.2"></leq></apply><ci id="A1.Ex8.m1.4.4.1.1.3.2.cmml" xref="A1.Ex8.m1.4.4.1.1.3.2">𝐿</ci></apply><apply id="A1.Ex8.m1.4.4.1.1.1.cmml" xref="A1.Ex8.m1.4.4.1.1.1"><apply id="A1.Ex8.m1.4.4.1.1.1.2.cmml" xref="A1.Ex8.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex8.m1.4.4.1.1.1.2.1.cmml" xref="A1.Ex8.m1.4.4.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="A1.Ex8.m1.4.4.1.1.1.2.2.cmml" xref="A1.Ex8.m1.4.4.1.1.1.2.2">supremum</csymbol><apply id="A1.Ex8.m1.2.2.1.cmml" xref="A1.Ex8.m1.2.2.1"><in id="A1.Ex8.m1.2.2.1.2.cmml" xref="A1.Ex8.m1.2.2.1.2"></in><ci id="A1.Ex8.m1.2.2.1.3.cmml" xref="A1.Ex8.m1.2.2.1.3">𝜆</ci><apply id="A1.Ex8.m1.2.2.1.4.cmml" xref="A1.Ex8.m1.2.2.1.4"><times id="A1.Ex8.m1.2.2.1.4.1.cmml" xref="A1.Ex8.m1.2.2.1.4.1"></times><apply id="A1.Ex8.m1.2.2.1.4.2.cmml" xref="A1.Ex8.m1.2.2.1.4.2"><csymbol cd="ambiguous" id="A1.Ex8.m1.2.2.1.4.2.1.cmml" xref="A1.Ex8.m1.2.2.1.4.2">subscript</csymbol><ci id="A1.Ex8.m1.2.2.1.4.2.2.cmml" xref="A1.Ex8.m1.2.2.1.4.2.2">Lip</ci><cn id="A1.Ex8.m1.2.2.1.4.2.3.cmml" type="integer" xref="A1.Ex8.m1.2.2.1.4.2.3">1</cn></apply><ci id="A1.Ex8.m1.2.2.1.1.cmml" xref="A1.Ex8.m1.2.2.1.1">𝜌</ci></apply></apply></apply><apply id="A1.Ex8.m1.4.4.1.1.1.1.1.1.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1"><minus id="A1.Ex8.m1.4.4.1.1.1.1.1.1.3.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.3"></minus><apply id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1"><times id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.2"></times><apply id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.2">𝔼</ci><apply id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.3"><csymbol cd="latexml" id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.3.1">similar-to</csymbol><ci id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.3.2.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.3.2">𝑋</ci><apply id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.3.3.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.3.3.2">𝒟</ci><ci id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.3.3.3.3">𝑌</ci></apply></apply></apply><apply id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.1"><times id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.1.1.1.1.2">𝜆</ci><ci id="A1.Ex8.m1.3.3.cmml" xref="A1.Ex8.m1.3.3">𝑋</ci></apply></apply></apply><apply id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2"><times id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.2"></times><apply id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.1.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.2.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.2">𝔼</ci><apply id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3"><csymbol cd="latexml" id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.1.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.1">similar-to</csymbol><apply id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.2.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.2"><csymbol cd="ambiguous" id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.2.1.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.2">superscript</csymbol><ci id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.2.2.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.2.2">𝑌</ci><ci id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.2.3.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.2.3">′</ci></apply><apply id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.3.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.3"><csymbol cd="ambiguous" id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.3.1.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.3">subscript</csymbol><apply id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.3.2.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.3.2"><ci id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.3.2.1.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.3.2.1">~</ci><ci id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.3.2.2.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.3.2.2">𝒟</ci></apply><ci id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.3.3.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.3.3.3.3">𝑌</ci></apply></apply></apply><apply id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.2.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.2.1.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.2">delimited-[]</csymbol><apply id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1"><times id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.2"></times><ci id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.3">𝜆</ci><apply id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.1">superscript</csymbol><ci id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.1.1.2">𝑌</ci><ci id="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="A1.Ex8.m1.4.4.1.1.1.1.1.1.2.1.1.1.1.1.1.3">′</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex8.m1.4c">\displaystyle\overset{(ii)}{\leq}L\cdot\sup_{\lambda\in{\rm Lip}_{1}(\rho)}%
\left(\mathbb{E}_{X\sim\mathscr{D}_{Y}}\left[\lambda(X)\right]-\mathbb{E}_{Y^{%
\prime}\sim\tilde{\mathscr{D}}_{Y}}\left[\lambda(Y^{\prime})\right]\right),</annotation><annotation encoding="application/x-llamapun" id="A1.Ex8.m1.4d">start_OVERACCENT ( italic_i italic_i ) end_OVERACCENT start_ARG ≤ end_ARG italic_L ⋅ roman_sup start_POSTSUBSCRIPT italic_λ ∈ roman_Lip start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_ρ ) end_POSTSUBSCRIPT ( blackboard_E start_POSTSUBSCRIPT italic_X ∼ script_D start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ italic_λ ( italic_X ) ] - blackboard_E start_POSTSUBSCRIPT italic_Y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∼ over~ start_ARG script_D end_ARG start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ italic_λ ( italic_Y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ] ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.E17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\overset{(iii)}{=}\mathcal{W}(\mathscr{D}_{Y},\tilde{\mathscr{D}}%
_{Y})" class="ltx_Math" display="inline" id="A1.E17.m1.3"><semantics id="A1.E17.m1.3a"><mrow id="A1.E17.m1.3.3" xref="A1.E17.m1.3.3.cmml"><mover accent="true" id="A1.E17.m1.1.1" xref="A1.E17.m1.1.1.cmml"><mo id="A1.E17.m1.1.1.2" xref="A1.E17.m1.1.1.2.cmml">=</mo><mrow id="A1.E17.m1.1.1.1.1" xref="A1.E17.m1.1.1.1.1.1.cmml"><mo id="A1.E17.m1.1.1.1.1.2" stretchy="false" xref="A1.E17.m1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E17.m1.1.1.1.1.1" xref="A1.E17.m1.1.1.1.1.1.cmml"><mi id="A1.E17.m1.1.1.1.1.1.2" xref="A1.E17.m1.1.1.1.1.1.2.cmml">i</mi><mo id="A1.E17.m1.1.1.1.1.1.1" xref="A1.E17.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.E17.m1.1.1.1.1.1.3" xref="A1.E17.m1.1.1.1.1.1.3.cmml">i</mi><mo id="A1.E17.m1.1.1.1.1.1.1a" xref="A1.E17.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.E17.m1.1.1.1.1.1.4" xref="A1.E17.m1.1.1.1.1.1.4.cmml">i</mi></mrow><mo id="A1.E17.m1.1.1.1.1.3" stretchy="false" xref="A1.E17.m1.1.1.1.1.1.cmml">)</mo></mrow></mover><mo id="A1.E17.m1.3.3.3" xref="A1.E17.m1.3.3.3.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A1.E17.m1.3.3.4" xref="A1.E17.m1.3.3.4.cmml">𝒲</mi><mo id="A1.E17.m1.3.3.3a" xref="A1.E17.m1.3.3.3.cmml">⁢</mo><mrow id="A1.E17.m1.3.3.2.2" xref="A1.E17.m1.3.3.2.3.cmml"><mo id="A1.E17.m1.3.3.2.2.3" stretchy="false" xref="A1.E17.m1.3.3.2.3.cmml">(</mo><msub id="A1.E17.m1.2.2.1.1.1" xref="A1.E17.m1.2.2.1.1.1.cmml"><mi class="ltx_font_mathscript" id="A1.E17.m1.2.2.1.1.1.2" xref="A1.E17.m1.2.2.1.1.1.2.cmml">𝒟</mi><mi id="A1.E17.m1.2.2.1.1.1.3" xref="A1.E17.m1.2.2.1.1.1.3.cmml">Y</mi></msub><mo id="A1.E17.m1.3.3.2.2.4" xref="A1.E17.m1.3.3.2.3.cmml">,</mo><msub id="A1.E17.m1.3.3.2.2.2" xref="A1.E17.m1.3.3.2.2.2.cmml"><mover accent="true" id="A1.E17.m1.3.3.2.2.2.2" xref="A1.E17.m1.3.3.2.2.2.2.cmml"><mi class="ltx_font_mathscript" id="A1.E17.m1.3.3.2.2.2.2.2" xref="A1.E17.m1.3.3.2.2.2.2.2.cmml">𝒟</mi><mo id="A1.E17.m1.3.3.2.2.2.2.1" xref="A1.E17.m1.3.3.2.2.2.2.1.cmml">~</mo></mover><mi id="A1.E17.m1.3.3.2.2.2.3" xref="A1.E17.m1.3.3.2.2.2.3.cmml">Y</mi></msub><mo id="A1.E17.m1.3.3.2.2.5" stretchy="false" xref="A1.E17.m1.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E17.m1.3b"><apply id="A1.E17.m1.3.3.cmml" xref="A1.E17.m1.3.3"><times id="A1.E17.m1.3.3.3.cmml" xref="A1.E17.m1.3.3.3"></times><apply id="A1.E17.m1.1.1.cmml" xref="A1.E17.m1.1.1"><apply id="A1.E17.m1.1.1.1.1.1.cmml" xref="A1.E17.m1.1.1.1.1"><times id="A1.E17.m1.1.1.1.1.1.1.cmml" xref="A1.E17.m1.1.1.1.1.1.1"></times><ci id="A1.E17.m1.1.1.1.1.1.2.cmml" xref="A1.E17.m1.1.1.1.1.1.2">𝑖</ci><ci id="A1.E17.m1.1.1.1.1.1.3.cmml" xref="A1.E17.m1.1.1.1.1.1.3">𝑖</ci><ci id="A1.E17.m1.1.1.1.1.1.4.cmml" xref="A1.E17.m1.1.1.1.1.1.4">𝑖</ci></apply><eq id="A1.E17.m1.1.1.2.cmml" xref="A1.E17.m1.1.1.2"></eq></apply><ci id="A1.E17.m1.3.3.4.cmml" xref="A1.E17.m1.3.3.4">𝒲</ci><interval closure="open" id="A1.E17.m1.3.3.2.3.cmml" xref="A1.E17.m1.3.3.2.2"><apply id="A1.E17.m1.2.2.1.1.1.cmml" xref="A1.E17.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.1.1.cmml" xref="A1.E17.m1.2.2.1.1.1">subscript</csymbol><ci id="A1.E17.m1.2.2.1.1.1.2.cmml" xref="A1.E17.m1.2.2.1.1.1.2">𝒟</ci><ci id="A1.E17.m1.2.2.1.1.1.3.cmml" xref="A1.E17.m1.2.2.1.1.1.3">𝑌</ci></apply><apply id="A1.E17.m1.3.3.2.2.2.cmml" xref="A1.E17.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="A1.E17.m1.3.3.2.2.2.1.cmml" xref="A1.E17.m1.3.3.2.2.2">subscript</csymbol><apply id="A1.E17.m1.3.3.2.2.2.2.cmml" xref="A1.E17.m1.3.3.2.2.2.2"><ci id="A1.E17.m1.3.3.2.2.2.2.1.cmml" xref="A1.E17.m1.3.3.2.2.2.2.1">~</ci><ci id="A1.E17.m1.3.3.2.2.2.2.2.cmml" xref="A1.E17.m1.3.3.2.2.2.2.2">𝒟</ci></apply><ci id="A1.E17.m1.3.3.2.2.2.3.cmml" xref="A1.E17.m1.3.3.2.2.2.3">𝑌</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E17.m1.3c">\displaystyle\overset{(iii)}{=}\mathcal{W}(\mathscr{D}_{Y},\tilde{\mathscr{D}}%
_{Y})</annotation><annotation encoding="application/x-llamapun" id="A1.E17.m1.3d">start_OVERACCENT ( italic_i italic_i italic_i ) end_OVERACCENT start_ARG = end_ARG caligraphic_W ( script_D start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT , over~ start_ARG script_D end_ARG start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
<tbody id="A1.E18"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\overset{(iv)}{\leq}\|\mathscr{D}_{Y}-\tilde{\mathscr{D}}_{Y}\|_{TV}" class="ltx_Math" display="inline" id="A1.E18.m1.2"><semantics id="A1.E18.m1.2a"><mrow id="A1.E18.m1.2.2" xref="A1.E18.m1.2.2.cmml"><mover accent="true" id="A1.E18.m1.1.1" xref="A1.E18.m1.1.1.cmml"><mo id="A1.E18.m1.1.1.2" xref="A1.E18.m1.1.1.2.cmml">≤</mo><mrow id="A1.E18.m1.1.1.1.1" xref="A1.E18.m1.1.1.1.1.1.cmml"><mo id="A1.E18.m1.1.1.1.1.2" stretchy="false" xref="A1.E18.m1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E18.m1.1.1.1.1.1" xref="A1.E18.m1.1.1.1.1.1.cmml"><mi id="A1.E18.m1.1.1.1.1.1.2" xref="A1.E18.m1.1.1.1.1.1.2.cmml">i</mi><mo id="A1.E18.m1.1.1.1.1.1.1" xref="A1.E18.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.E18.m1.1.1.1.1.1.3" xref="A1.E18.m1.1.1.1.1.1.3.cmml">v</mi></mrow><mo id="A1.E18.m1.1.1.1.1.3" stretchy="false" xref="A1.E18.m1.1.1.1.1.1.cmml">)</mo></mrow></mover><mo id="A1.E18.m1.2.2.2" xref="A1.E18.m1.2.2.2.cmml">⁢</mo><msub id="A1.E18.m1.2.2.1" xref="A1.E18.m1.2.2.1.cmml"><mrow id="A1.E18.m1.2.2.1.1.1" xref="A1.E18.m1.2.2.1.1.2.cmml"><mo id="A1.E18.m1.2.2.1.1.1.2" stretchy="false" xref="A1.E18.m1.2.2.1.1.2.1.cmml">‖</mo><mrow id="A1.E18.m1.2.2.1.1.1.1" xref="A1.E18.m1.2.2.1.1.1.1.cmml"><msub id="A1.E18.m1.2.2.1.1.1.1.2" xref="A1.E18.m1.2.2.1.1.1.1.2.cmml"><mi class="ltx_font_mathscript" id="A1.E18.m1.2.2.1.1.1.1.2.2" xref="A1.E18.m1.2.2.1.1.1.1.2.2.cmml">𝒟</mi><mi id="A1.E18.m1.2.2.1.1.1.1.2.3" xref="A1.E18.m1.2.2.1.1.1.1.2.3.cmml">Y</mi></msub><mo id="A1.E18.m1.2.2.1.1.1.1.1" xref="A1.E18.m1.2.2.1.1.1.1.1.cmml">−</mo><msub id="A1.E18.m1.2.2.1.1.1.1.3" xref="A1.E18.m1.2.2.1.1.1.1.3.cmml"><mover accent="true" id="A1.E18.m1.2.2.1.1.1.1.3.2" xref="A1.E18.m1.2.2.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathscript" id="A1.E18.m1.2.2.1.1.1.1.3.2.2" xref="A1.E18.m1.2.2.1.1.1.1.3.2.2.cmml">𝒟</mi><mo id="A1.E18.m1.2.2.1.1.1.1.3.2.1" xref="A1.E18.m1.2.2.1.1.1.1.3.2.1.cmml">~</mo></mover><mi id="A1.E18.m1.2.2.1.1.1.1.3.3" xref="A1.E18.m1.2.2.1.1.1.1.3.3.cmml">Y</mi></msub></mrow><mo id="A1.E18.m1.2.2.1.1.1.3" stretchy="false" xref="A1.E18.m1.2.2.1.1.2.1.cmml">‖</mo></mrow><mrow id="A1.E18.m1.2.2.1.3" xref="A1.E18.m1.2.2.1.3.cmml"><mi id="A1.E18.m1.2.2.1.3.2" xref="A1.E18.m1.2.2.1.3.2.cmml">T</mi><mo id="A1.E18.m1.2.2.1.3.1" xref="A1.E18.m1.2.2.1.3.1.cmml">⁢</mo><mi id="A1.E18.m1.2.2.1.3.3" xref="A1.E18.m1.2.2.1.3.3.cmml">V</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.E18.m1.2b"><apply id="A1.E18.m1.2.2.cmml" xref="A1.E18.m1.2.2"><times id="A1.E18.m1.2.2.2.cmml" xref="A1.E18.m1.2.2.2"></times><apply id="A1.E18.m1.1.1.cmml" xref="A1.E18.m1.1.1"><apply id="A1.E18.m1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1"><times id="A1.E18.m1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1"></times><ci id="A1.E18.m1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.2">𝑖</ci><ci id="A1.E18.m1.1.1.1.1.1.3.cmml" xref="A1.E18.m1.1.1.1.1.1.3">𝑣</ci></apply><leq id="A1.E18.m1.1.1.2.cmml" xref="A1.E18.m1.1.1.2"></leq></apply><apply id="A1.E18.m1.2.2.1.cmml" xref="A1.E18.m1.2.2.1"><csymbol cd="ambiguous" id="A1.E18.m1.2.2.1.2.cmml" xref="A1.E18.m1.2.2.1">subscript</csymbol><apply id="A1.E18.m1.2.2.1.1.2.cmml" xref="A1.E18.m1.2.2.1.1.1"><csymbol cd="latexml" id="A1.E18.m1.2.2.1.1.2.1.cmml" xref="A1.E18.m1.2.2.1.1.1.2">norm</csymbol><apply id="A1.E18.m1.2.2.1.1.1.1.cmml" xref="A1.E18.m1.2.2.1.1.1.1"><minus id="A1.E18.m1.2.2.1.1.1.1.1.cmml" xref="A1.E18.m1.2.2.1.1.1.1.1"></minus><apply id="A1.E18.m1.2.2.1.1.1.1.2.cmml" xref="A1.E18.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E18.m1.2.2.1.1.1.1.2.1.cmml" xref="A1.E18.m1.2.2.1.1.1.1.2">subscript</csymbol><ci id="A1.E18.m1.2.2.1.1.1.1.2.2.cmml" xref="A1.E18.m1.2.2.1.1.1.1.2.2">𝒟</ci><ci id="A1.E18.m1.2.2.1.1.1.1.2.3.cmml" xref="A1.E18.m1.2.2.1.1.1.1.2.3">𝑌</ci></apply><apply id="A1.E18.m1.2.2.1.1.1.1.3.cmml" xref="A1.E18.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E18.m1.2.2.1.1.1.1.3.1.cmml" xref="A1.E18.m1.2.2.1.1.1.1.3">subscript</csymbol><apply id="A1.E18.m1.2.2.1.1.1.1.3.2.cmml" xref="A1.E18.m1.2.2.1.1.1.1.3.2"><ci id="A1.E18.m1.2.2.1.1.1.1.3.2.1.cmml" xref="A1.E18.m1.2.2.1.1.1.1.3.2.1">~</ci><ci id="A1.E18.m1.2.2.1.1.1.1.3.2.2.cmml" xref="A1.E18.m1.2.2.1.1.1.1.3.2.2">𝒟</ci></apply><ci id="A1.E18.m1.2.2.1.1.1.1.3.3.cmml" xref="A1.E18.m1.2.2.1.1.1.1.3.3">𝑌</ci></apply></apply></apply><apply id="A1.E18.m1.2.2.1.3.cmml" xref="A1.E18.m1.2.2.1.3"><times id="A1.E18.m1.2.2.1.3.1.cmml" xref="A1.E18.m1.2.2.1.3.1"></times><ci id="A1.E18.m1.2.2.1.3.2.cmml" xref="A1.E18.m1.2.2.1.3.2">𝑇</ci><ci id="A1.E18.m1.2.2.1.3.3.cmml" xref="A1.E18.m1.2.2.1.3.3">𝑉</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E18.m1.2c">\displaystyle\overset{(iv)}{\leq}\|\mathscr{D}_{Y}-\tilde{\mathscr{D}}_{Y}\|_{TV}</annotation><annotation encoding="application/x-llamapun" id="A1.E18.m1.2d">start_OVERACCENT ( italic_i italic_v ) end_OVERACCENT start_ARG ≤ end_ARG ∥ script_D start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT - over~ start_ARG script_D end_ARG start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT italic_T italic_V end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
<tbody id="A1.E19"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\overset{(v)}{=}\frac{1}{2}\sum_{y\in\mathcal{Y}}|\mathsf{softmax%
}(g(y))-\mathsf{softmax}(g^{\prime}(y))|" class="ltx_Math" display="inline" id="A1.E19.m1.4"><semantics id="A1.E19.m1.4a"><mrow id="A1.E19.m1.4.4" xref="A1.E19.m1.4.4.cmml"><mover accent="true" id="A1.E19.m1.1.1" xref="A1.E19.m1.1.1.cmml"><mo id="A1.E19.m1.1.1.2" xref="A1.E19.m1.1.1.2.cmml">=</mo><mrow id="A1.E19.m1.1.1.1.3" xref="A1.E19.m1.1.1.cmml"><mo id="A1.E19.m1.1.1.1.3.1" stretchy="false" xref="A1.E19.m1.1.1.cmml">(</mo><mi id="A1.E19.m1.1.1.1.1" xref="A1.E19.m1.1.1.1.1.cmml">v</mi><mo id="A1.E19.m1.1.1.1.3.2" stretchy="false" xref="A1.E19.m1.1.1.cmml">)</mo></mrow></mover><mo id="A1.E19.m1.4.4.2" xref="A1.E19.m1.4.4.2.cmml">⁢</mo><mstyle displaystyle="true" id="A1.E19.m1.4.4.3" xref="A1.E19.m1.4.4.3.cmml"><mfrac id="A1.E19.m1.4.4.3a" xref="A1.E19.m1.4.4.3.cmml"><mn id="A1.E19.m1.4.4.3.2" xref="A1.E19.m1.4.4.3.2.cmml">1</mn><mn id="A1.E19.m1.4.4.3.3" xref="A1.E19.m1.4.4.3.3.cmml">2</mn></mfrac></mstyle><mo id="A1.E19.m1.4.4.2a" xref="A1.E19.m1.4.4.2.cmml">⁢</mo><mrow id="A1.E19.m1.4.4.1" xref="A1.E19.m1.4.4.1.cmml"><mstyle displaystyle="true" id="A1.E19.m1.4.4.1.2" xref="A1.E19.m1.4.4.1.2.cmml"><munder id="A1.E19.m1.4.4.1.2a" xref="A1.E19.m1.4.4.1.2.cmml"><mo id="A1.E19.m1.4.4.1.2.2" movablelimits="false" xref="A1.E19.m1.4.4.1.2.2.cmml">∑</mo><mrow id="A1.E19.m1.4.4.1.2.3" xref="A1.E19.m1.4.4.1.2.3.cmml"><mi id="A1.E19.m1.4.4.1.2.3.2" xref="A1.E19.m1.4.4.1.2.3.2.cmml">y</mi><mo id="A1.E19.m1.4.4.1.2.3.1" xref="A1.E19.m1.4.4.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A1.E19.m1.4.4.1.2.3.3" xref="A1.E19.m1.4.4.1.2.3.3.cmml">𝒴</mi></mrow></munder></mstyle><mrow id="A1.E19.m1.4.4.1.1.1" xref="A1.E19.m1.4.4.1.1.2.cmml"><mo id="A1.E19.m1.4.4.1.1.1.2" stretchy="false" xref="A1.E19.m1.4.4.1.1.2.1.cmml">|</mo><mrow id="A1.E19.m1.4.4.1.1.1.1" xref="A1.E19.m1.4.4.1.1.1.1.cmml"><mrow id="A1.E19.m1.4.4.1.1.1.1.1" xref="A1.E19.m1.4.4.1.1.1.1.1.cmml"><mi id="A1.E19.m1.4.4.1.1.1.1.1.3" xref="A1.E19.m1.4.4.1.1.1.1.1.3.cmml">𝗌𝗈𝖿𝗍𝗆𝖺𝗑</mi><mo id="A1.E19.m1.4.4.1.1.1.1.1.2" xref="A1.E19.m1.4.4.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E19.m1.4.4.1.1.1.1.1.1.1" xref="A1.E19.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E19.m1.4.4.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E19.m1.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E19.m1.4.4.1.1.1.1.1.1.1.1" xref="A1.E19.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E19.m1.4.4.1.1.1.1.1.1.1.1.2" xref="A1.E19.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">g</mi><mo id="A1.E19.m1.4.4.1.1.1.1.1.1.1.1.1" xref="A1.E19.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.E19.m1.4.4.1.1.1.1.1.1.1.1.3.2" xref="A1.E19.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E19.m1.4.4.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.E19.m1.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E19.m1.2.2" xref="A1.E19.m1.2.2.cmml">y</mi><mo id="A1.E19.m1.4.4.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A1.E19.m1.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E19.m1.4.4.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E19.m1.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E19.m1.4.4.1.1.1.1.3" xref="A1.E19.m1.4.4.1.1.1.1.3.cmml">−</mo><mrow id="A1.E19.m1.4.4.1.1.1.1.2" xref="A1.E19.m1.4.4.1.1.1.1.2.cmml"><mi id="A1.E19.m1.4.4.1.1.1.1.2.3" xref="A1.E19.m1.4.4.1.1.1.1.2.3.cmml">𝗌𝗈𝖿𝗍𝗆𝖺𝗑</mi><mo id="A1.E19.m1.4.4.1.1.1.1.2.2" xref="A1.E19.m1.4.4.1.1.1.1.2.2.cmml">⁢</mo><mrow id="A1.E19.m1.4.4.1.1.1.1.2.1.1" xref="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.cmml"><mo id="A1.E19.m1.4.4.1.1.1.1.2.1.1.2" stretchy="false" xref="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="A1.E19.m1.4.4.1.1.1.1.2.1.1.1" xref="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.cmml"><msup id="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.2" xref="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.2.cmml"><mi id="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.2.2" xref="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.2.2.cmml">g</mi><mo id="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.2.3" xref="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.2.3.cmml">′</mo></msup><mo id="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.1" xref="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.1.cmml">⁢</mo><mrow id="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.3.2" xref="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.cmml"><mo id="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.3.2.1" stretchy="false" xref="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.cmml">(</mo><mi id="A1.E19.m1.3.3" xref="A1.E19.m1.3.3.cmml">y</mi><mo id="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.3.2.2" stretchy="false" xref="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E19.m1.4.4.1.1.1.1.2.1.1.3" stretchy="false" xref="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E19.m1.4.4.1.1.1.3" stretchy="false" xref="A1.E19.m1.4.4.1.1.2.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E19.m1.4b"><apply id="A1.E19.m1.4.4.cmml" xref="A1.E19.m1.4.4"><times id="A1.E19.m1.4.4.2.cmml" xref="A1.E19.m1.4.4.2"></times><apply id="A1.E19.m1.1.1.cmml" xref="A1.E19.m1.1.1"><ci id="A1.E19.m1.1.1.1.1.cmml" xref="A1.E19.m1.1.1.1.1">𝑣</ci><eq id="A1.E19.m1.1.1.2.cmml" xref="A1.E19.m1.1.1.2"></eq></apply><apply id="A1.E19.m1.4.4.3.cmml" xref="A1.E19.m1.4.4.3"><divide id="A1.E19.m1.4.4.3.1.cmml" xref="A1.E19.m1.4.4.3"></divide><cn id="A1.E19.m1.4.4.3.2.cmml" type="integer" xref="A1.E19.m1.4.4.3.2">1</cn><cn id="A1.E19.m1.4.4.3.3.cmml" type="integer" xref="A1.E19.m1.4.4.3.3">2</cn></apply><apply id="A1.E19.m1.4.4.1.cmml" xref="A1.E19.m1.4.4.1"><apply id="A1.E19.m1.4.4.1.2.cmml" xref="A1.E19.m1.4.4.1.2"><csymbol cd="ambiguous" id="A1.E19.m1.4.4.1.2.1.cmml" xref="A1.E19.m1.4.4.1.2">subscript</csymbol><sum id="A1.E19.m1.4.4.1.2.2.cmml" xref="A1.E19.m1.4.4.1.2.2"></sum><apply id="A1.E19.m1.4.4.1.2.3.cmml" xref="A1.E19.m1.4.4.1.2.3"><in id="A1.E19.m1.4.4.1.2.3.1.cmml" xref="A1.E19.m1.4.4.1.2.3.1"></in><ci id="A1.E19.m1.4.4.1.2.3.2.cmml" xref="A1.E19.m1.4.4.1.2.3.2">𝑦</ci><ci id="A1.E19.m1.4.4.1.2.3.3.cmml" xref="A1.E19.m1.4.4.1.2.3.3">𝒴</ci></apply></apply><apply id="A1.E19.m1.4.4.1.1.2.cmml" xref="A1.E19.m1.4.4.1.1.1"><abs id="A1.E19.m1.4.4.1.1.2.1.cmml" xref="A1.E19.m1.4.4.1.1.1.2"></abs><apply id="A1.E19.m1.4.4.1.1.1.1.cmml" xref="A1.E19.m1.4.4.1.1.1.1"><minus id="A1.E19.m1.4.4.1.1.1.1.3.cmml" xref="A1.E19.m1.4.4.1.1.1.1.3"></minus><apply id="A1.E19.m1.4.4.1.1.1.1.1.cmml" xref="A1.E19.m1.4.4.1.1.1.1.1"><times id="A1.E19.m1.4.4.1.1.1.1.1.2.cmml" xref="A1.E19.m1.4.4.1.1.1.1.1.2"></times><ci id="A1.E19.m1.4.4.1.1.1.1.1.3.cmml" xref="A1.E19.m1.4.4.1.1.1.1.1.3">𝗌𝗈𝖿𝗍𝗆𝖺𝗑</ci><apply id="A1.E19.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="A1.E19.m1.4.4.1.1.1.1.1.1.1"><times id="A1.E19.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E19.m1.4.4.1.1.1.1.1.1.1.1.1"></times><ci id="A1.E19.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E19.m1.4.4.1.1.1.1.1.1.1.1.2">𝑔</ci><ci id="A1.E19.m1.2.2.cmml" xref="A1.E19.m1.2.2">𝑦</ci></apply></apply><apply id="A1.E19.m1.4.4.1.1.1.1.2.cmml" xref="A1.E19.m1.4.4.1.1.1.1.2"><times id="A1.E19.m1.4.4.1.1.1.1.2.2.cmml" xref="A1.E19.m1.4.4.1.1.1.1.2.2"></times><ci id="A1.E19.m1.4.4.1.1.1.1.2.3.cmml" xref="A1.E19.m1.4.4.1.1.1.1.2.3">𝗌𝗈𝖿𝗍𝗆𝖺𝗑</ci><apply id="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.cmml" xref="A1.E19.m1.4.4.1.1.1.1.2.1.1"><times id="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.1.cmml" xref="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.1"></times><apply id="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.2.cmml" xref="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.2.1.cmml" xref="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.2">superscript</csymbol><ci id="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.2.2.cmml" xref="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.2.2">𝑔</ci><ci id="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.2.3.cmml" xref="A1.E19.m1.4.4.1.1.1.1.2.1.1.1.2.3">′</ci></apply><ci id="A1.E19.m1.3.3.cmml" xref="A1.E19.m1.3.3">𝑦</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E19.m1.4c">\displaystyle\overset{(v)}{=}\frac{1}{2}\sum_{y\in\mathcal{Y}}|\mathsf{softmax%
}(g(y))-\mathsf{softmax}(g^{\prime}(y))|</annotation><annotation encoding="application/x-llamapun" id="A1.E19.m1.4d">start_OVERACCENT ( italic_v ) end_OVERACCENT start_ARG = end_ARG divide start_ARG 1 end_ARG start_ARG 2 end_ARG ∑ start_POSTSUBSCRIPT italic_y ∈ caligraphic_Y end_POSTSUBSCRIPT | sansserif_softmax ( italic_g ( italic_y ) ) - sansserif_softmax ( italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y ) ) |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
<tbody id="A1.E20"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\overset{(vi)}{\leq}\frac{1}{2}\|g-g^{\prime}\|_{1}" class="ltx_Math" display="inline" id="A1.E20.m1.2"><semantics id="A1.E20.m1.2a"><mrow id="A1.E20.m1.2.2" xref="A1.E20.m1.2.2.cmml"><mover accent="true" id="A1.E20.m1.1.1" xref="A1.E20.m1.1.1.cmml"><mo id="A1.E20.m1.1.1.2" xref="A1.E20.m1.1.1.2.cmml">≤</mo><mrow id="A1.E20.m1.1.1.1.1" xref="A1.E20.m1.1.1.1.1.1.cmml"><mo id="A1.E20.m1.1.1.1.1.2" stretchy="false" xref="A1.E20.m1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E20.m1.1.1.1.1.1" xref="A1.E20.m1.1.1.1.1.1.cmml"><mi id="A1.E20.m1.1.1.1.1.1.2" xref="A1.E20.m1.1.1.1.1.1.2.cmml">v</mi><mo id="A1.E20.m1.1.1.1.1.1.1" xref="A1.E20.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.E20.m1.1.1.1.1.1.3" xref="A1.E20.m1.1.1.1.1.1.3.cmml">i</mi></mrow><mo id="A1.E20.m1.1.1.1.1.3" stretchy="false" xref="A1.E20.m1.1.1.1.1.1.cmml">)</mo></mrow></mover><mo id="A1.E20.m1.2.2.2" xref="A1.E20.m1.2.2.2.cmml">⁢</mo><mstyle displaystyle="true" id="A1.E20.m1.2.2.3" xref="A1.E20.m1.2.2.3.cmml"><mfrac id="A1.E20.m1.2.2.3a" xref="A1.E20.m1.2.2.3.cmml"><mn id="A1.E20.m1.2.2.3.2" xref="A1.E20.m1.2.2.3.2.cmml">1</mn><mn id="A1.E20.m1.2.2.3.3" xref="A1.E20.m1.2.2.3.3.cmml">2</mn></mfrac></mstyle><mo id="A1.E20.m1.2.2.2a" xref="A1.E20.m1.2.2.2.cmml">⁢</mo><msub id="A1.E20.m1.2.2.1" xref="A1.E20.m1.2.2.1.cmml"><mrow id="A1.E20.m1.2.2.1.1.1" xref="A1.E20.m1.2.2.1.1.2.cmml"><mo id="A1.E20.m1.2.2.1.1.1.2" stretchy="false" xref="A1.E20.m1.2.2.1.1.2.1.cmml">‖</mo><mrow id="A1.E20.m1.2.2.1.1.1.1" xref="A1.E20.m1.2.2.1.1.1.1.cmml"><mi id="A1.E20.m1.2.2.1.1.1.1.2" xref="A1.E20.m1.2.2.1.1.1.1.2.cmml">g</mi><mo id="A1.E20.m1.2.2.1.1.1.1.1" xref="A1.E20.m1.2.2.1.1.1.1.1.cmml">−</mo><msup id="A1.E20.m1.2.2.1.1.1.1.3" xref="A1.E20.m1.2.2.1.1.1.1.3.cmml"><mi id="A1.E20.m1.2.2.1.1.1.1.3.2" xref="A1.E20.m1.2.2.1.1.1.1.3.2.cmml">g</mi><mo id="A1.E20.m1.2.2.1.1.1.1.3.3" xref="A1.E20.m1.2.2.1.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="A1.E20.m1.2.2.1.1.1.3" stretchy="false" xref="A1.E20.m1.2.2.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.E20.m1.2.2.1.3" xref="A1.E20.m1.2.2.1.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.E20.m1.2b"><apply id="A1.E20.m1.2.2.cmml" xref="A1.E20.m1.2.2"><times id="A1.E20.m1.2.2.2.cmml" xref="A1.E20.m1.2.2.2"></times><apply id="A1.E20.m1.1.1.cmml" xref="A1.E20.m1.1.1"><apply id="A1.E20.m1.1.1.1.1.1.cmml" xref="A1.E20.m1.1.1.1.1"><times id="A1.E20.m1.1.1.1.1.1.1.cmml" xref="A1.E20.m1.1.1.1.1.1.1"></times><ci id="A1.E20.m1.1.1.1.1.1.2.cmml" xref="A1.E20.m1.1.1.1.1.1.2">𝑣</ci><ci id="A1.E20.m1.1.1.1.1.1.3.cmml" xref="A1.E20.m1.1.1.1.1.1.3">𝑖</ci></apply><leq id="A1.E20.m1.1.1.2.cmml" xref="A1.E20.m1.1.1.2"></leq></apply><apply id="A1.E20.m1.2.2.3.cmml" xref="A1.E20.m1.2.2.3"><divide id="A1.E20.m1.2.2.3.1.cmml" xref="A1.E20.m1.2.2.3"></divide><cn id="A1.E20.m1.2.2.3.2.cmml" type="integer" xref="A1.E20.m1.2.2.3.2">1</cn><cn id="A1.E20.m1.2.2.3.3.cmml" type="integer" xref="A1.E20.m1.2.2.3.3">2</cn></apply><apply id="A1.E20.m1.2.2.1.cmml" xref="A1.E20.m1.2.2.1"><csymbol cd="ambiguous" id="A1.E20.m1.2.2.1.2.cmml" xref="A1.E20.m1.2.2.1">subscript</csymbol><apply id="A1.E20.m1.2.2.1.1.2.cmml" xref="A1.E20.m1.2.2.1.1.1"><csymbol cd="latexml" id="A1.E20.m1.2.2.1.1.2.1.cmml" xref="A1.E20.m1.2.2.1.1.1.2">norm</csymbol><apply id="A1.E20.m1.2.2.1.1.1.1.cmml" xref="A1.E20.m1.2.2.1.1.1.1"><minus id="A1.E20.m1.2.2.1.1.1.1.1.cmml" xref="A1.E20.m1.2.2.1.1.1.1.1"></minus><ci id="A1.E20.m1.2.2.1.1.1.1.2.cmml" xref="A1.E20.m1.2.2.1.1.1.1.2">𝑔</ci><apply id="A1.E20.m1.2.2.1.1.1.1.3.cmml" xref="A1.E20.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E20.m1.2.2.1.1.1.1.3.1.cmml" xref="A1.E20.m1.2.2.1.1.1.1.3">superscript</csymbol><ci id="A1.E20.m1.2.2.1.1.1.1.3.2.cmml" xref="A1.E20.m1.2.2.1.1.1.1.3.2">𝑔</ci><ci id="A1.E20.m1.2.2.1.1.1.1.3.3.cmml" xref="A1.E20.m1.2.2.1.1.1.1.3.3">′</ci></apply></apply></apply><cn id="A1.E20.m1.2.2.1.3.cmml" type="integer" xref="A1.E20.m1.2.2.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E20.m1.2c">\displaystyle\overset{(vi)}{\leq}\frac{1}{2}\|g-g^{\prime}\|_{1}</annotation><annotation encoding="application/x-llamapun" id="A1.E20.m1.2d">start_OVERACCENT ( italic_v italic_i ) end_OVERACCENT start_ARG ≤ end_ARG divide start_ARG 1 end_ARG start_ARG 2 end_ARG ∥ italic_g - italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.p1.17">where <math alttext="(i)" class="ltx_Math" display="inline" id="A1.p1.3.m1.1"><semantics id="A1.p1.3.m1.1a"><mrow id="A1.p1.3.m1.1.2.2"><mo id="A1.p1.3.m1.1.2.2.1" stretchy="false">(</mo><mi id="A1.p1.3.m1.1.1" xref="A1.p1.3.m1.1.1.cmml">i</mi><mo id="A1.p1.3.m1.1.2.2.2" stretchy="false">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.3.m1.1b"><ci id="A1.p1.3.m1.1.1.cmml" xref="A1.p1.3.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.3.m1.1c">(i)</annotation><annotation encoding="application/x-llamapun" id="A1.p1.3.m1.1d">( italic_i )</annotation></semantics></math> follows by dividing and multiply by <math alttext="L" class="ltx_Math" display="inline" id="A1.p1.4.m2.1"><semantics id="A1.p1.4.m2.1a"><mi id="A1.p1.4.m2.1.1" xref="A1.p1.4.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="A1.p1.4.m2.1b"><ci id="A1.p1.4.m2.1.1.cmml" xref="A1.p1.4.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.4.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="A1.p1.4.m2.1d">italic_L</annotation></semantics></math>; <math alttext="(ii)" class="ltx_Math" display="inline" id="A1.p1.5.m3.1"><semantics id="A1.p1.5.m3.1a"><mrow id="A1.p1.5.m3.1.1.1" xref="A1.p1.5.m3.1.1.1.1.cmml"><mo id="A1.p1.5.m3.1.1.1.2" stretchy="false" xref="A1.p1.5.m3.1.1.1.1.cmml">(</mo><mrow id="A1.p1.5.m3.1.1.1.1" xref="A1.p1.5.m3.1.1.1.1.cmml"><mi id="A1.p1.5.m3.1.1.1.1.2" xref="A1.p1.5.m3.1.1.1.1.2.cmml">i</mi><mo id="A1.p1.5.m3.1.1.1.1.1" xref="A1.p1.5.m3.1.1.1.1.1.cmml">⁢</mo><mi id="A1.p1.5.m3.1.1.1.1.3" xref="A1.p1.5.m3.1.1.1.1.3.cmml">i</mi></mrow><mo id="A1.p1.5.m3.1.1.1.3" stretchy="false" xref="A1.p1.5.m3.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.5.m3.1b"><apply id="A1.p1.5.m3.1.1.1.1.cmml" xref="A1.p1.5.m3.1.1.1"><times id="A1.p1.5.m3.1.1.1.1.1.cmml" xref="A1.p1.5.m3.1.1.1.1.1"></times><ci id="A1.p1.5.m3.1.1.1.1.2.cmml" xref="A1.p1.5.m3.1.1.1.1.2">𝑖</ci><ci id="A1.p1.5.m3.1.1.1.1.3.cmml" xref="A1.p1.5.m3.1.1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.5.m3.1c">(ii)</annotation><annotation encoding="application/x-llamapun" id="A1.p1.5.m3.1d">( italic_i italic_i )</annotation></semantics></math> follows as, for any <math alttext="\lambda\in\mathcal{G}^{h}_{\ell,\mathcal{F}}" class="ltx_Math" display="inline" id="A1.p1.6.m4.2"><semantics id="A1.p1.6.m4.2a"><mrow id="A1.p1.6.m4.2.3" xref="A1.p1.6.m4.2.3.cmml"><mi id="A1.p1.6.m4.2.3.2" xref="A1.p1.6.m4.2.3.2.cmml">λ</mi><mo id="A1.p1.6.m4.2.3.1" xref="A1.p1.6.m4.2.3.1.cmml">∈</mo><msubsup id="A1.p1.6.m4.2.3.3" xref="A1.p1.6.m4.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.6.m4.2.3.3.2.2" xref="A1.p1.6.m4.2.3.3.2.2.cmml">𝒢</mi><mrow id="A1.p1.6.m4.2.2.2.4" xref="A1.p1.6.m4.2.2.2.3.cmml"><mi id="A1.p1.6.m4.1.1.1.1" mathvariant="normal" xref="A1.p1.6.m4.1.1.1.1.cmml">ℓ</mi><mo id="A1.p1.6.m4.2.2.2.4.1" xref="A1.p1.6.m4.2.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A1.p1.6.m4.2.2.2.2" xref="A1.p1.6.m4.2.2.2.2.cmml">ℱ</mi></mrow><mi id="A1.p1.6.m4.2.3.3.2.3" xref="A1.p1.6.m4.2.3.3.2.3.cmml">h</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.6.m4.2b"><apply id="A1.p1.6.m4.2.3.cmml" xref="A1.p1.6.m4.2.3"><in id="A1.p1.6.m4.2.3.1.cmml" xref="A1.p1.6.m4.2.3.1"></in><ci id="A1.p1.6.m4.2.3.2.cmml" xref="A1.p1.6.m4.2.3.2">𝜆</ci><apply id="A1.p1.6.m4.2.3.3.cmml" xref="A1.p1.6.m4.2.3.3"><csymbol cd="ambiguous" id="A1.p1.6.m4.2.3.3.1.cmml" xref="A1.p1.6.m4.2.3.3">subscript</csymbol><apply id="A1.p1.6.m4.2.3.3.2.cmml" xref="A1.p1.6.m4.2.3.3"><csymbol cd="ambiguous" id="A1.p1.6.m4.2.3.3.2.1.cmml" xref="A1.p1.6.m4.2.3.3">superscript</csymbol><ci id="A1.p1.6.m4.2.3.3.2.2.cmml" xref="A1.p1.6.m4.2.3.3.2.2">𝒢</ci><ci id="A1.p1.6.m4.2.3.3.2.3.cmml" xref="A1.p1.6.m4.2.3.3.2.3">ℎ</ci></apply><list id="A1.p1.6.m4.2.2.2.3.cmml" xref="A1.p1.6.m4.2.2.2.4"><ci id="A1.p1.6.m4.1.1.1.1.cmml" xref="A1.p1.6.m4.1.1.1.1">ℓ</ci><ci id="A1.p1.6.m4.2.2.2.2.cmml" xref="A1.p1.6.m4.2.2.2.2">ℱ</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.6.m4.2c">\lambda\in\mathcal{G}^{h}_{\ell,\mathcal{F}}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.6.m4.2d">italic_λ ∈ caligraphic_G start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_ℓ , caligraphic_F end_POSTSUBSCRIPT</annotation></semantics></math>, we have <math alttext="\frac{\lambda}{L}" class="ltx_Math" display="inline" id="A1.p1.7.m5.1"><semantics id="A1.p1.7.m5.1a"><mfrac id="A1.p1.7.m5.1.1" xref="A1.p1.7.m5.1.1.cmml"><mi id="A1.p1.7.m5.1.1.2" xref="A1.p1.7.m5.1.1.2.cmml">λ</mi><mi id="A1.p1.7.m5.1.1.3" xref="A1.p1.7.m5.1.1.3.cmml">L</mi></mfrac><annotation-xml encoding="MathML-Content" id="A1.p1.7.m5.1b"><apply id="A1.p1.7.m5.1.1.cmml" xref="A1.p1.7.m5.1.1"><divide id="A1.p1.7.m5.1.1.1.cmml" xref="A1.p1.7.m5.1.1"></divide><ci id="A1.p1.7.m5.1.1.2.cmml" xref="A1.p1.7.m5.1.1.2">𝜆</ci><ci id="A1.p1.7.m5.1.1.3.cmml" xref="A1.p1.7.m5.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.7.m5.1c">\frac{\lambda}{L}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.7.m5.1d">divide start_ARG italic_λ end_ARG start_ARG italic_L end_ARG</annotation></semantics></math> to be <math alttext="1" class="ltx_Math" display="inline" id="A1.p1.8.m6.1"><semantics id="A1.p1.8.m6.1a"><mn id="A1.p1.8.m6.1.1" xref="A1.p1.8.m6.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A1.p1.8.m6.1b"><cn id="A1.p1.8.m6.1.1.cmml" type="integer" xref="A1.p1.8.m6.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.8.m6.1c">1</annotation><annotation encoding="application/x-llamapun" id="A1.p1.8.m6.1d">1</annotation></semantics></math>-Lipschitz; <math alttext="(iii)" class="ltx_Math" display="inline" id="A1.p1.9.m7.1"><semantics id="A1.p1.9.m7.1a"><mrow id="A1.p1.9.m7.1.1.1" xref="A1.p1.9.m7.1.1.1.1.cmml"><mo id="A1.p1.9.m7.1.1.1.2" stretchy="false" xref="A1.p1.9.m7.1.1.1.1.cmml">(</mo><mrow id="A1.p1.9.m7.1.1.1.1" xref="A1.p1.9.m7.1.1.1.1.cmml"><mi id="A1.p1.9.m7.1.1.1.1.2" xref="A1.p1.9.m7.1.1.1.1.2.cmml">i</mi><mo id="A1.p1.9.m7.1.1.1.1.1" xref="A1.p1.9.m7.1.1.1.1.1.cmml">⁢</mo><mi id="A1.p1.9.m7.1.1.1.1.3" xref="A1.p1.9.m7.1.1.1.1.3.cmml">i</mi><mo id="A1.p1.9.m7.1.1.1.1.1a" xref="A1.p1.9.m7.1.1.1.1.1.cmml">⁢</mo><mi id="A1.p1.9.m7.1.1.1.1.4" xref="A1.p1.9.m7.1.1.1.1.4.cmml">i</mi></mrow><mo id="A1.p1.9.m7.1.1.1.3" stretchy="false" xref="A1.p1.9.m7.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.9.m7.1b"><apply id="A1.p1.9.m7.1.1.1.1.cmml" xref="A1.p1.9.m7.1.1.1"><times id="A1.p1.9.m7.1.1.1.1.1.cmml" xref="A1.p1.9.m7.1.1.1.1.1"></times><ci id="A1.p1.9.m7.1.1.1.1.2.cmml" xref="A1.p1.9.m7.1.1.1.1.2">𝑖</ci><ci id="A1.p1.9.m7.1.1.1.1.3.cmml" xref="A1.p1.9.m7.1.1.1.1.3">𝑖</ci><ci id="A1.p1.9.m7.1.1.1.1.4.cmml" xref="A1.p1.9.m7.1.1.1.1.4">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.9.m7.1c">(iii)</annotation><annotation encoding="application/x-llamapun" id="A1.p1.9.m7.1d">( italic_i italic_i italic_i )</annotation></semantics></math> follows from Kantorovich-Rubinstein duality <cite class="ltx_cite ltx_citemacro_citep">(Villani et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib36" title="">2008</a>)</cite>; <math alttext="(iv)" class="ltx_Math" display="inline" id="A1.p1.10.m8.1"><semantics id="A1.p1.10.m8.1a"><mrow id="A1.p1.10.m8.1.1.1" xref="A1.p1.10.m8.1.1.1.1.cmml"><mo id="A1.p1.10.m8.1.1.1.2" stretchy="false" xref="A1.p1.10.m8.1.1.1.1.cmml">(</mo><mrow id="A1.p1.10.m8.1.1.1.1" xref="A1.p1.10.m8.1.1.1.1.cmml"><mi id="A1.p1.10.m8.1.1.1.1.2" xref="A1.p1.10.m8.1.1.1.1.2.cmml">i</mi><mo id="A1.p1.10.m8.1.1.1.1.1" xref="A1.p1.10.m8.1.1.1.1.1.cmml">⁢</mo><mi id="A1.p1.10.m8.1.1.1.1.3" xref="A1.p1.10.m8.1.1.1.1.3.cmml">v</mi></mrow><mo id="A1.p1.10.m8.1.1.1.3" stretchy="false" xref="A1.p1.10.m8.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.10.m8.1b"><apply id="A1.p1.10.m8.1.1.1.1.cmml" xref="A1.p1.10.m8.1.1.1"><times id="A1.p1.10.m8.1.1.1.1.1.cmml" xref="A1.p1.10.m8.1.1.1.1.1"></times><ci id="A1.p1.10.m8.1.1.1.1.2.cmml" xref="A1.p1.10.m8.1.1.1.1.2">𝑖</ci><ci id="A1.p1.10.m8.1.1.1.1.3.cmml" xref="A1.p1.10.m8.1.1.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.10.m8.1c">(iv)</annotation><annotation encoding="application/x-llamapun" id="A1.p1.10.m8.1d">( italic_i italic_v )</annotation></semantics></math> follows from Corollory 6.14 in <cite class="ltx_cite ltx_citemacro_citet">Villani et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib36" title="">2008</a>)</cite>; <math alttext="(v)" class="ltx_Math" display="inline" id="A1.p1.11.m9.1"><semantics id="A1.p1.11.m9.1a"><mrow id="A1.p1.11.m9.1.2.2"><mo id="A1.p1.11.m9.1.2.2.1" stretchy="false">(</mo><mi id="A1.p1.11.m9.1.1" xref="A1.p1.11.m9.1.1.cmml">v</mi><mo id="A1.p1.11.m9.1.2.2.2" stretchy="false">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.11.m9.1b"><ci id="A1.p1.11.m9.1.1.cmml" xref="A1.p1.11.m9.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.11.m9.1c">(v)</annotation><annotation encoding="application/x-llamapun" id="A1.p1.11.m9.1d">( italic_v )</annotation></semantics></math> follows from definition; and <math alttext="(vi)" class="ltx_Math" display="inline" id="A1.p1.12.m10.1"><semantics id="A1.p1.12.m10.1a"><mrow id="A1.p1.12.m10.1.1.1" xref="A1.p1.12.m10.1.1.1.1.cmml"><mo id="A1.p1.12.m10.1.1.1.2" stretchy="false" xref="A1.p1.12.m10.1.1.1.1.cmml">(</mo><mrow id="A1.p1.12.m10.1.1.1.1" xref="A1.p1.12.m10.1.1.1.1.cmml"><mi id="A1.p1.12.m10.1.1.1.1.2" xref="A1.p1.12.m10.1.1.1.1.2.cmml">v</mi><mo id="A1.p1.12.m10.1.1.1.1.1" xref="A1.p1.12.m10.1.1.1.1.1.cmml">⁢</mo><mi id="A1.p1.12.m10.1.1.1.1.3" xref="A1.p1.12.m10.1.1.1.1.3.cmml">i</mi></mrow><mo id="A1.p1.12.m10.1.1.1.3" stretchy="false" xref="A1.p1.12.m10.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.12.m10.1b"><apply id="A1.p1.12.m10.1.1.1.1.cmml" xref="A1.p1.12.m10.1.1.1"><times id="A1.p1.12.m10.1.1.1.1.1.cmml" xref="A1.p1.12.m10.1.1.1.1.1"></times><ci id="A1.p1.12.m10.1.1.1.1.2.cmml" xref="A1.p1.12.m10.1.1.1.1.2">𝑣</ci><ci id="A1.p1.12.m10.1.1.1.1.3.cmml" xref="A1.p1.12.m10.1.1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.12.m10.1c">(vi)</annotation><annotation encoding="application/x-llamapun" id="A1.p1.12.m10.1d">( italic_v italic_i )</annotation></semantics></math> follows from softmax Lipschtiz constant being 1.
As <math alttext="g" class="ltx_Math" display="inline" id="A1.p1.13.m11.1"><semantics id="A1.p1.13.m11.1a"><mi id="A1.p1.13.m11.1.1" xref="A1.p1.13.m11.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="A1.p1.13.m11.1b"><ci id="A1.p1.13.m11.1.1.cmml" xref="A1.p1.13.m11.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.13.m11.1c">g</annotation><annotation encoding="application/x-llamapun" id="A1.p1.13.m11.1d">italic_g</annotation></semantics></math> and <math alttext="g^{\prime}" class="ltx_Math" display="inline" id="A1.p1.14.m12.1"><semantics id="A1.p1.14.m12.1a"><msup id="A1.p1.14.m12.1.1" xref="A1.p1.14.m12.1.1.cmml"><mi id="A1.p1.14.m12.1.1.2" xref="A1.p1.14.m12.1.1.2.cmml">g</mi><mo id="A1.p1.14.m12.1.1.3" xref="A1.p1.14.m12.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="A1.p1.14.m12.1b"><apply id="A1.p1.14.m12.1.1.cmml" xref="A1.p1.14.m12.1.1"><csymbol cd="ambiguous" id="A1.p1.14.m12.1.1.1.cmml" xref="A1.p1.14.m12.1.1">superscript</csymbol><ci id="A1.p1.14.m12.1.1.2.cmml" xref="A1.p1.14.m12.1.1.2">𝑔</ci><ci id="A1.p1.14.m12.1.1.3.cmml" xref="A1.p1.14.m12.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.14.m12.1c">g^{\prime}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.14.m12.1d">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> are output from the same neural network but with parameters perturbed by <math alttext="u" class="ltx_Math" display="inline" id="A1.p1.15.m13.1"><semantics id="A1.p1.15.m13.1a"><mi id="A1.p1.15.m13.1.1" xref="A1.p1.15.m13.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="A1.p1.15.m13.1b"><ci id="A1.p1.15.m13.1.1.cmml" xref="A1.p1.15.m13.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.15.m13.1c">u</annotation><annotation encoding="application/x-llamapun" id="A1.p1.15.m13.1d">italic_u</annotation></semantics></math>, then it follows that <math alttext="\|g-g^{\prime}\|_{1}\leq L\|u\|" class="ltx_Math" display="inline" id="A1.p1.16.m14.2"><semantics id="A1.p1.16.m14.2a"><mrow id="A1.p1.16.m14.2.2" xref="A1.p1.16.m14.2.2.cmml"><msub id="A1.p1.16.m14.2.2.1" xref="A1.p1.16.m14.2.2.1.cmml"><mrow id="A1.p1.16.m14.2.2.1.1.1" xref="A1.p1.16.m14.2.2.1.1.2.cmml"><mo id="A1.p1.16.m14.2.2.1.1.1.2" stretchy="false" xref="A1.p1.16.m14.2.2.1.1.2.1.cmml">‖</mo><mrow id="A1.p1.16.m14.2.2.1.1.1.1" xref="A1.p1.16.m14.2.2.1.1.1.1.cmml"><mi id="A1.p1.16.m14.2.2.1.1.1.1.2" xref="A1.p1.16.m14.2.2.1.1.1.1.2.cmml">g</mi><mo id="A1.p1.16.m14.2.2.1.1.1.1.1" xref="A1.p1.16.m14.2.2.1.1.1.1.1.cmml">−</mo><msup id="A1.p1.16.m14.2.2.1.1.1.1.3" xref="A1.p1.16.m14.2.2.1.1.1.1.3.cmml"><mi id="A1.p1.16.m14.2.2.1.1.1.1.3.2" xref="A1.p1.16.m14.2.2.1.1.1.1.3.2.cmml">g</mi><mo id="A1.p1.16.m14.2.2.1.1.1.1.3.3" xref="A1.p1.16.m14.2.2.1.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="A1.p1.16.m14.2.2.1.1.1.3" stretchy="false" xref="A1.p1.16.m14.2.2.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.p1.16.m14.2.2.1.3" xref="A1.p1.16.m14.2.2.1.3.cmml">1</mn></msub><mo id="A1.p1.16.m14.2.2.2" xref="A1.p1.16.m14.2.2.2.cmml">≤</mo><mrow id="A1.p1.16.m14.2.2.3" xref="A1.p1.16.m14.2.2.3.cmml"><mi id="A1.p1.16.m14.2.2.3.2" xref="A1.p1.16.m14.2.2.3.2.cmml">L</mi><mo id="A1.p1.16.m14.2.2.3.1" xref="A1.p1.16.m14.2.2.3.1.cmml">⁢</mo><mrow id="A1.p1.16.m14.2.2.3.3.2" xref="A1.p1.16.m14.2.2.3.3.1.cmml"><mo id="A1.p1.16.m14.2.2.3.3.2.1" stretchy="false" xref="A1.p1.16.m14.2.2.3.3.1.1.cmml">‖</mo><mi id="A1.p1.16.m14.1.1" xref="A1.p1.16.m14.1.1.cmml">u</mi><mo id="A1.p1.16.m14.2.2.3.3.2.2" stretchy="false" xref="A1.p1.16.m14.2.2.3.3.1.1.cmml">‖</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.16.m14.2b"><apply id="A1.p1.16.m14.2.2.cmml" xref="A1.p1.16.m14.2.2"><leq id="A1.p1.16.m14.2.2.2.cmml" xref="A1.p1.16.m14.2.2.2"></leq><apply id="A1.p1.16.m14.2.2.1.cmml" xref="A1.p1.16.m14.2.2.1"><csymbol cd="ambiguous" id="A1.p1.16.m14.2.2.1.2.cmml" xref="A1.p1.16.m14.2.2.1">subscript</csymbol><apply id="A1.p1.16.m14.2.2.1.1.2.cmml" xref="A1.p1.16.m14.2.2.1.1.1"><csymbol cd="latexml" id="A1.p1.16.m14.2.2.1.1.2.1.cmml" xref="A1.p1.16.m14.2.2.1.1.1.2">norm</csymbol><apply id="A1.p1.16.m14.2.2.1.1.1.1.cmml" xref="A1.p1.16.m14.2.2.1.1.1.1"><minus id="A1.p1.16.m14.2.2.1.1.1.1.1.cmml" xref="A1.p1.16.m14.2.2.1.1.1.1.1"></minus><ci id="A1.p1.16.m14.2.2.1.1.1.1.2.cmml" xref="A1.p1.16.m14.2.2.1.1.1.1.2">𝑔</ci><apply id="A1.p1.16.m14.2.2.1.1.1.1.3.cmml" xref="A1.p1.16.m14.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.p1.16.m14.2.2.1.1.1.1.3.1.cmml" xref="A1.p1.16.m14.2.2.1.1.1.1.3">superscript</csymbol><ci id="A1.p1.16.m14.2.2.1.1.1.1.3.2.cmml" xref="A1.p1.16.m14.2.2.1.1.1.1.3.2">𝑔</ci><ci id="A1.p1.16.m14.2.2.1.1.1.1.3.3.cmml" xref="A1.p1.16.m14.2.2.1.1.1.1.3.3">′</ci></apply></apply></apply><cn id="A1.p1.16.m14.2.2.1.3.cmml" type="integer" xref="A1.p1.16.m14.2.2.1.3">1</cn></apply><apply id="A1.p1.16.m14.2.2.3.cmml" xref="A1.p1.16.m14.2.2.3"><times id="A1.p1.16.m14.2.2.3.1.cmml" xref="A1.p1.16.m14.2.2.3.1"></times><ci id="A1.p1.16.m14.2.2.3.2.cmml" xref="A1.p1.16.m14.2.2.3.2">𝐿</ci><apply id="A1.p1.16.m14.2.2.3.3.1.cmml" xref="A1.p1.16.m14.2.2.3.3.2"><csymbol cd="latexml" id="A1.p1.16.m14.2.2.3.3.1.1.cmml" xref="A1.p1.16.m14.2.2.3.3.2.1">norm</csymbol><ci id="A1.p1.16.m14.1.1.cmml" xref="A1.p1.16.m14.1.1">𝑢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.16.m14.2c">\|g-g^{\prime}\|_{1}\leq L\|u\|</annotation><annotation encoding="application/x-llamapun" id="A1.p1.16.m14.2d">∥ italic_g - italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≤ italic_L ∥ italic_u ∥</annotation></semantics></math>. <span class="ltx_text ltx_markedasmath" id="A1.p1.17.1">∎</span></p>
</div>
<div class="ltx_para" id="A1.p2">
<p class="ltx_p" id="A1.p2.1">See <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S4.Thmtheorem2" title="Lemma 4.2. ‣ 4 Analysis ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">4.2</span></a></p>
</div>
<div class="ltx_para" id="A1.p3">
<p class="ltx_p" id="A1.p3.5"><em class="ltx_emph ltx_font_italic" id="A1.p3.5.1">Proof</em> We need to connect the stale population risk to the empirical risk we are actually minimizing:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A2.EGx5">
<tbody id="A1.Ex9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle R_{\ell,\tilde{f}_{n}}(\tilde{\mathscr{D}}_{Y})" class="ltx_Math" display="inline" id="A1.Ex9.m1.3"><semantics id="A1.Ex9.m1.3a"><mrow id="A1.Ex9.m1.3.3" xref="A1.Ex9.m1.3.3.cmml"><msub id="A1.Ex9.m1.3.3.3" xref="A1.Ex9.m1.3.3.3.cmml"><mi id="A1.Ex9.m1.3.3.3.2" xref="A1.Ex9.m1.3.3.3.2.cmml">R</mi><mrow id="A1.Ex9.m1.2.2.2.2" xref="A1.Ex9.m1.2.2.2.3.cmml"><mi id="A1.Ex9.m1.1.1.1.1" mathvariant="normal" xref="A1.Ex9.m1.1.1.1.1.cmml">ℓ</mi><mo id="A1.Ex9.m1.2.2.2.2.2" xref="A1.Ex9.m1.2.2.2.3.cmml">,</mo><msub id="A1.Ex9.m1.2.2.2.2.1" xref="A1.Ex9.m1.2.2.2.2.1.cmml"><mover accent="true" id="A1.Ex9.m1.2.2.2.2.1.2" xref="A1.Ex9.m1.2.2.2.2.1.2.cmml"><mi id="A1.Ex9.m1.2.2.2.2.1.2.2" xref="A1.Ex9.m1.2.2.2.2.1.2.2.cmml">f</mi><mo id="A1.Ex9.m1.2.2.2.2.1.2.1" xref="A1.Ex9.m1.2.2.2.2.1.2.1.cmml">~</mo></mover><mi id="A1.Ex9.m1.2.2.2.2.1.3" xref="A1.Ex9.m1.2.2.2.2.1.3.cmml">n</mi></msub></mrow></msub><mo id="A1.Ex9.m1.3.3.2" xref="A1.Ex9.m1.3.3.2.cmml">⁢</mo><mrow id="A1.Ex9.m1.3.3.1.1" xref="A1.Ex9.m1.3.3.1.1.1.cmml"><mo id="A1.Ex9.m1.3.3.1.1.2" stretchy="false" xref="A1.Ex9.m1.3.3.1.1.1.cmml">(</mo><msub id="A1.Ex9.m1.3.3.1.1.1" xref="A1.Ex9.m1.3.3.1.1.1.cmml"><mover accent="true" id="A1.Ex9.m1.3.3.1.1.1.2" xref="A1.Ex9.m1.3.3.1.1.1.2.cmml"><mi class="ltx_font_mathscript" id="A1.Ex9.m1.3.3.1.1.1.2.2" xref="A1.Ex9.m1.3.3.1.1.1.2.2.cmml">𝒟</mi><mo id="A1.Ex9.m1.3.3.1.1.1.2.1" xref="A1.Ex9.m1.3.3.1.1.1.2.1.cmml">~</mo></mover><mi id="A1.Ex9.m1.3.3.1.1.1.3" xref="A1.Ex9.m1.3.3.1.1.1.3.cmml">Y</mi></msub><mo id="A1.Ex9.m1.3.3.1.1.3" stretchy="false" xref="A1.Ex9.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex9.m1.3b"><apply id="A1.Ex9.m1.3.3.cmml" xref="A1.Ex9.m1.3.3"><times id="A1.Ex9.m1.3.3.2.cmml" xref="A1.Ex9.m1.3.3.2"></times><apply id="A1.Ex9.m1.3.3.3.cmml" xref="A1.Ex9.m1.3.3.3"><csymbol cd="ambiguous" id="A1.Ex9.m1.3.3.3.1.cmml" xref="A1.Ex9.m1.3.3.3">subscript</csymbol><ci id="A1.Ex9.m1.3.3.3.2.cmml" xref="A1.Ex9.m1.3.3.3.2">𝑅</ci><list id="A1.Ex9.m1.2.2.2.3.cmml" xref="A1.Ex9.m1.2.2.2.2"><ci id="A1.Ex9.m1.1.1.1.1.cmml" xref="A1.Ex9.m1.1.1.1.1">ℓ</ci><apply id="A1.Ex9.m1.2.2.2.2.1.cmml" xref="A1.Ex9.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="A1.Ex9.m1.2.2.2.2.1.1.cmml" xref="A1.Ex9.m1.2.2.2.2.1">subscript</csymbol><apply id="A1.Ex9.m1.2.2.2.2.1.2.cmml" xref="A1.Ex9.m1.2.2.2.2.1.2"><ci id="A1.Ex9.m1.2.2.2.2.1.2.1.cmml" xref="A1.Ex9.m1.2.2.2.2.1.2.1">~</ci><ci id="A1.Ex9.m1.2.2.2.2.1.2.2.cmml" xref="A1.Ex9.m1.2.2.2.2.1.2.2">𝑓</ci></apply><ci id="A1.Ex9.m1.2.2.2.2.1.3.cmml" xref="A1.Ex9.m1.2.2.2.2.1.3">𝑛</ci></apply></list></apply><apply id="A1.Ex9.m1.3.3.1.1.1.cmml" xref="A1.Ex9.m1.3.3.1.1"><csymbol cd="ambiguous" id="A1.Ex9.m1.3.3.1.1.1.1.cmml" xref="A1.Ex9.m1.3.3.1.1">subscript</csymbol><apply id="A1.Ex9.m1.3.3.1.1.1.2.cmml" xref="A1.Ex9.m1.3.3.1.1.1.2"><ci id="A1.Ex9.m1.3.3.1.1.1.2.1.cmml" xref="A1.Ex9.m1.3.3.1.1.1.2.1">~</ci><ci id="A1.Ex9.m1.3.3.1.1.1.2.2.cmml" xref="A1.Ex9.m1.3.3.1.1.1.2.2">𝒟</ci></apply><ci id="A1.Ex9.m1.3.3.1.1.1.3.cmml" xref="A1.Ex9.m1.3.3.1.1.1.3">𝑌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex9.m1.3c">\displaystyle R_{\ell,\tilde{f}_{n}}(\tilde{\mathscr{D}}_{Y})</annotation><annotation encoding="application/x-llamapun" id="A1.Ex9.m1.3d">italic_R start_POSTSUBSCRIPT roman_ℓ , over~ start_ARG italic_f end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( over~ start_ARG script_D end_ARG start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbb{E}_{\tilde{\mathscr{D}}_{Y}}[\ell(\tilde{f}_{n}(Y),g(Y))]" class="ltx_Math" display="inline" id="A1.Ex9.m2.3"><semantics id="A1.Ex9.m2.3a"><mrow id="A1.Ex9.m2.3.3" xref="A1.Ex9.m2.3.3.cmml"><mi id="A1.Ex9.m2.3.3.3" xref="A1.Ex9.m2.3.3.3.cmml"></mi><mo id="A1.Ex9.m2.3.3.2" xref="A1.Ex9.m2.3.3.2.cmml">=</mo><mrow id="A1.Ex9.m2.3.3.1" xref="A1.Ex9.m2.3.3.1.cmml"><msub id="A1.Ex9.m2.3.3.1.3" xref="A1.Ex9.m2.3.3.1.3.cmml"><mi id="A1.Ex9.m2.3.3.1.3.2" xref="A1.Ex9.m2.3.3.1.3.2.cmml">𝔼</mi><msub id="A1.Ex9.m2.3.3.1.3.3" xref="A1.Ex9.m2.3.3.1.3.3.cmml"><mover accent="true" id="A1.Ex9.m2.3.3.1.3.3.2" xref="A1.Ex9.m2.3.3.1.3.3.2.cmml"><mi class="ltx_font_mathscript" id="A1.Ex9.m2.3.3.1.3.3.2.2" xref="A1.Ex9.m2.3.3.1.3.3.2.2.cmml">𝒟</mi><mo id="A1.Ex9.m2.3.3.1.3.3.2.1" xref="A1.Ex9.m2.3.3.1.3.3.2.1.cmml">~</mo></mover><mi id="A1.Ex9.m2.3.3.1.3.3.3" xref="A1.Ex9.m2.3.3.1.3.3.3.cmml">Y</mi></msub></msub><mo id="A1.Ex9.m2.3.3.1.2" xref="A1.Ex9.m2.3.3.1.2.cmml">⁢</mo><mrow id="A1.Ex9.m2.3.3.1.1.1" xref="A1.Ex9.m2.3.3.1.1.2.cmml"><mo id="A1.Ex9.m2.3.3.1.1.1.2" stretchy="false" xref="A1.Ex9.m2.3.3.1.1.2.1.cmml">[</mo><mrow id="A1.Ex9.m2.3.3.1.1.1.1" xref="A1.Ex9.m2.3.3.1.1.1.1.cmml"><mi id="A1.Ex9.m2.3.3.1.1.1.1.4" mathvariant="normal" xref="A1.Ex9.m2.3.3.1.1.1.1.4.cmml">ℓ</mi><mo id="A1.Ex9.m2.3.3.1.1.1.1.3" xref="A1.Ex9.m2.3.3.1.1.1.1.3.cmml">⁢</mo><mrow id="A1.Ex9.m2.3.3.1.1.1.1.2.2" xref="A1.Ex9.m2.3.3.1.1.1.1.2.3.cmml"><mo id="A1.Ex9.m2.3.3.1.1.1.1.2.2.3" stretchy="false" xref="A1.Ex9.m2.3.3.1.1.1.1.2.3.cmml">(</mo><mrow id="A1.Ex9.m2.3.3.1.1.1.1.1.1.1" xref="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.cmml"><msub id="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.2" xref="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.2.2" xref="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.2.2.cmml"><mi id="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.2.2.2" xref="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.2.2.2.cmml">f</mi><mo id="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.2.2.1" xref="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.2.2.1.cmml">~</mo></mover><mi id="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.2.3" xref="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.2.3.cmml">n</mi></msub><mo id="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.1" xref="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.3.2" xref="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex9.m2.1.1" xref="A1.Ex9.m2.1.1.cmml">Y</mi><mo id="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex9.m2.3.3.1.1.1.1.2.2.4" xref="A1.Ex9.m2.3.3.1.1.1.1.2.3.cmml">,</mo><mrow id="A1.Ex9.m2.3.3.1.1.1.1.2.2.2" xref="A1.Ex9.m2.3.3.1.1.1.1.2.2.2.cmml"><mi id="A1.Ex9.m2.3.3.1.1.1.1.2.2.2.2" xref="A1.Ex9.m2.3.3.1.1.1.1.2.2.2.2.cmml">g</mi><mo id="A1.Ex9.m2.3.3.1.1.1.1.2.2.2.1" xref="A1.Ex9.m2.3.3.1.1.1.1.2.2.2.1.cmml">⁢</mo><mrow id="A1.Ex9.m2.3.3.1.1.1.1.2.2.2.3.2" xref="A1.Ex9.m2.3.3.1.1.1.1.2.2.2.cmml"><mo id="A1.Ex9.m2.3.3.1.1.1.1.2.2.2.3.2.1" stretchy="false" xref="A1.Ex9.m2.3.3.1.1.1.1.2.2.2.cmml">(</mo><mi id="A1.Ex9.m2.2.2" xref="A1.Ex9.m2.2.2.cmml">Y</mi><mo id="A1.Ex9.m2.3.3.1.1.1.1.2.2.2.3.2.2" stretchy="false" xref="A1.Ex9.m2.3.3.1.1.1.1.2.2.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex9.m2.3.3.1.1.1.1.2.2.5" stretchy="false" xref="A1.Ex9.m2.3.3.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="A1.Ex9.m2.3.3.1.1.1.3" stretchy="false" xref="A1.Ex9.m2.3.3.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex9.m2.3b"><apply id="A1.Ex9.m2.3.3.cmml" xref="A1.Ex9.m2.3.3"><eq id="A1.Ex9.m2.3.3.2.cmml" xref="A1.Ex9.m2.3.3.2"></eq><csymbol cd="latexml" id="A1.Ex9.m2.3.3.3.cmml" xref="A1.Ex9.m2.3.3.3">absent</csymbol><apply id="A1.Ex9.m2.3.3.1.cmml" xref="A1.Ex9.m2.3.3.1"><times id="A1.Ex9.m2.3.3.1.2.cmml" xref="A1.Ex9.m2.3.3.1.2"></times><apply id="A1.Ex9.m2.3.3.1.3.cmml" xref="A1.Ex9.m2.3.3.1.3"><csymbol cd="ambiguous" id="A1.Ex9.m2.3.3.1.3.1.cmml" xref="A1.Ex9.m2.3.3.1.3">subscript</csymbol><ci id="A1.Ex9.m2.3.3.1.3.2.cmml" xref="A1.Ex9.m2.3.3.1.3.2">𝔼</ci><apply id="A1.Ex9.m2.3.3.1.3.3.cmml" xref="A1.Ex9.m2.3.3.1.3.3"><csymbol cd="ambiguous" id="A1.Ex9.m2.3.3.1.3.3.1.cmml" xref="A1.Ex9.m2.3.3.1.3.3">subscript</csymbol><apply id="A1.Ex9.m2.3.3.1.3.3.2.cmml" xref="A1.Ex9.m2.3.3.1.3.3.2"><ci id="A1.Ex9.m2.3.3.1.3.3.2.1.cmml" xref="A1.Ex9.m2.3.3.1.3.3.2.1">~</ci><ci id="A1.Ex9.m2.3.3.1.3.3.2.2.cmml" xref="A1.Ex9.m2.3.3.1.3.3.2.2">𝒟</ci></apply><ci id="A1.Ex9.m2.3.3.1.3.3.3.cmml" xref="A1.Ex9.m2.3.3.1.3.3.3">𝑌</ci></apply></apply><apply id="A1.Ex9.m2.3.3.1.1.2.cmml" xref="A1.Ex9.m2.3.3.1.1.1"><csymbol cd="latexml" id="A1.Ex9.m2.3.3.1.1.2.1.cmml" xref="A1.Ex9.m2.3.3.1.1.1.2">delimited-[]</csymbol><apply id="A1.Ex9.m2.3.3.1.1.1.1.cmml" xref="A1.Ex9.m2.3.3.1.1.1.1"><times id="A1.Ex9.m2.3.3.1.1.1.1.3.cmml" xref="A1.Ex9.m2.3.3.1.1.1.1.3"></times><ci id="A1.Ex9.m2.3.3.1.1.1.1.4.cmml" xref="A1.Ex9.m2.3.3.1.1.1.1.4">ℓ</ci><interval closure="open" id="A1.Ex9.m2.3.3.1.1.1.1.2.3.cmml" xref="A1.Ex9.m2.3.3.1.1.1.1.2.2"><apply id="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.cmml" xref="A1.Ex9.m2.3.3.1.1.1.1.1.1.1"><times id="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.1"></times><apply id="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.2.2"><ci id="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.2.2.1">~</ci><ci id="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.2.2.2">𝑓</ci></apply><ci id="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex9.m2.3.3.1.1.1.1.1.1.1.2.3">𝑛</ci></apply><ci id="A1.Ex9.m2.1.1.cmml" xref="A1.Ex9.m2.1.1">𝑌</ci></apply><apply id="A1.Ex9.m2.3.3.1.1.1.1.2.2.2.cmml" xref="A1.Ex9.m2.3.3.1.1.1.1.2.2.2"><times id="A1.Ex9.m2.3.3.1.1.1.1.2.2.2.1.cmml" xref="A1.Ex9.m2.3.3.1.1.1.1.2.2.2.1"></times><ci id="A1.Ex9.m2.3.3.1.1.1.1.2.2.2.2.cmml" xref="A1.Ex9.m2.3.3.1.1.1.1.2.2.2.2">𝑔</ci><ci id="A1.Ex9.m2.2.2.cmml" xref="A1.Ex9.m2.2.2">𝑌</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex9.m2.3c">\displaystyle=\mathbb{E}_{\tilde{\mathscr{D}}_{Y}}[\ell(\tilde{f}_{n}(Y),g(Y))]</annotation><annotation encoding="application/x-llamapun" id="A1.Ex9.m2.3d">= blackboard_E start_POSTSUBSCRIPT over~ start_ARG script_D end_ARG start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ roman_ℓ ( over~ start_ARG italic_f end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ( italic_Y ) , italic_g ( italic_Y ) ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\leq\mathbb{E}_{\tilde{\mathscr{S}}_{n}}[\ell(\tilde{f}_{n}(Y),g(%
Y))]+\sup_{f\in\mathcal{F}}\big{|}\mathbb{E}_{\tilde{\mathscr{D}}_{Y}}[\ell(f(%
Y),g(Y))]-\mathbb{E}_{\tilde{\mathscr{S}}_{n}}[\ell(f(Y),g(Y))]\big{|}" class="ltx_Math" display="inline" id="A1.Ex10.m1.8"><semantics id="A1.Ex10.m1.8a"><mrow id="A1.Ex10.m1.8.8" xref="A1.Ex10.m1.8.8.cmml"><mi id="A1.Ex10.m1.8.8.4" xref="A1.Ex10.m1.8.8.4.cmml"></mi><mo id="A1.Ex10.m1.8.8.3" xref="A1.Ex10.m1.8.8.3.cmml">≤</mo><mrow id="A1.Ex10.m1.8.8.2" xref="A1.Ex10.m1.8.8.2.cmml"><mrow id="A1.Ex10.m1.7.7.1.1" xref="A1.Ex10.m1.7.7.1.1.cmml"><msub id="A1.Ex10.m1.7.7.1.1.3" xref="A1.Ex10.m1.7.7.1.1.3.cmml"><mi id="A1.Ex10.m1.7.7.1.1.3.2" xref="A1.Ex10.m1.7.7.1.1.3.2.cmml">𝔼</mi><msub id="A1.Ex10.m1.7.7.1.1.3.3" xref="A1.Ex10.m1.7.7.1.1.3.3.cmml"><mover accent="true" id="A1.Ex10.m1.7.7.1.1.3.3.2" xref="A1.Ex10.m1.7.7.1.1.3.3.2.cmml"><mi class="ltx_font_mathscript" id="A1.Ex10.m1.7.7.1.1.3.3.2.2" xref="A1.Ex10.m1.7.7.1.1.3.3.2.2.cmml">𝒮</mi><mo id="A1.Ex10.m1.7.7.1.1.3.3.2.1" xref="A1.Ex10.m1.7.7.1.1.3.3.2.1.cmml">~</mo></mover><mi id="A1.Ex10.m1.7.7.1.1.3.3.3" xref="A1.Ex10.m1.7.7.1.1.3.3.3.cmml">n</mi></msub></msub><mo id="A1.Ex10.m1.7.7.1.1.2" xref="A1.Ex10.m1.7.7.1.1.2.cmml">⁢</mo><mrow id="A1.Ex10.m1.7.7.1.1.1.1" xref="A1.Ex10.m1.7.7.1.1.1.2.cmml"><mo id="A1.Ex10.m1.7.7.1.1.1.1.2" stretchy="false" xref="A1.Ex10.m1.7.7.1.1.1.2.1.cmml">[</mo><mrow id="A1.Ex10.m1.7.7.1.1.1.1.1" xref="A1.Ex10.m1.7.7.1.1.1.1.1.cmml"><mi id="A1.Ex10.m1.7.7.1.1.1.1.1.4" mathvariant="normal" xref="A1.Ex10.m1.7.7.1.1.1.1.1.4.cmml">ℓ</mi><mo id="A1.Ex10.m1.7.7.1.1.1.1.1.3" xref="A1.Ex10.m1.7.7.1.1.1.1.1.3.cmml">⁢</mo><mrow id="A1.Ex10.m1.7.7.1.1.1.1.1.2.2" xref="A1.Ex10.m1.7.7.1.1.1.1.1.2.3.cmml"><mo id="A1.Ex10.m1.7.7.1.1.1.1.1.2.2.3" stretchy="false" xref="A1.Ex10.m1.7.7.1.1.1.1.1.2.3.cmml">(</mo><mrow id="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1" xref="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.cmml"><msub id="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.2" xref="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.2.2" xref="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.2.2.2" xref="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.cmml">f</mi><mo id="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.2.2.1" xref="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.2.2.1.cmml">~</mo></mover><mi id="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.2.3" xref="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.2.3.cmml">n</mi></msub><mo id="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.1" xref="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex10.m1.1.1" xref="A1.Ex10.m1.1.1.cmml">Y</mi><mo id="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex10.m1.7.7.1.1.1.1.1.2.2.4" xref="A1.Ex10.m1.7.7.1.1.1.1.1.2.3.cmml">,</mo><mrow id="A1.Ex10.m1.7.7.1.1.1.1.1.2.2.2" xref="A1.Ex10.m1.7.7.1.1.1.1.1.2.2.2.cmml"><mi id="A1.Ex10.m1.7.7.1.1.1.1.1.2.2.2.2" xref="A1.Ex10.m1.7.7.1.1.1.1.1.2.2.2.2.cmml">g</mi><mo id="A1.Ex10.m1.7.7.1.1.1.1.1.2.2.2.1" xref="A1.Ex10.m1.7.7.1.1.1.1.1.2.2.2.1.cmml">⁢</mo><mrow id="A1.Ex10.m1.7.7.1.1.1.1.1.2.2.2.3.2" xref="A1.Ex10.m1.7.7.1.1.1.1.1.2.2.2.cmml"><mo id="A1.Ex10.m1.7.7.1.1.1.1.1.2.2.2.3.2.1" stretchy="false" xref="A1.Ex10.m1.7.7.1.1.1.1.1.2.2.2.cmml">(</mo><mi id="A1.Ex10.m1.2.2" xref="A1.Ex10.m1.2.2.cmml">Y</mi><mo id="A1.Ex10.m1.7.7.1.1.1.1.1.2.2.2.3.2.2" stretchy="false" xref="A1.Ex10.m1.7.7.1.1.1.1.1.2.2.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex10.m1.7.7.1.1.1.1.1.2.2.5" stretchy="false" xref="A1.Ex10.m1.7.7.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="A1.Ex10.m1.7.7.1.1.1.1.3" stretchy="false" xref="A1.Ex10.m1.7.7.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.Ex10.m1.8.8.2.3" xref="A1.Ex10.m1.8.8.2.3.cmml">+</mo><mrow id="A1.Ex10.m1.8.8.2.2" xref="A1.Ex10.m1.8.8.2.2.cmml"><munder id="A1.Ex10.m1.8.8.2.2.2" xref="A1.Ex10.m1.8.8.2.2.2.cmml"><mo id="A1.Ex10.m1.8.8.2.2.2.2" lspace="0em" movablelimits="false" rspace="0em" xref="A1.Ex10.m1.8.8.2.2.2.2.cmml">sup</mo><mrow id="A1.Ex10.m1.8.8.2.2.2.3" xref="A1.Ex10.m1.8.8.2.2.2.3.cmml"><mi id="A1.Ex10.m1.8.8.2.2.2.3.2" xref="A1.Ex10.m1.8.8.2.2.2.3.2.cmml">f</mi><mo id="A1.Ex10.m1.8.8.2.2.2.3.1" xref="A1.Ex10.m1.8.8.2.2.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A1.Ex10.m1.8.8.2.2.2.3.3" xref="A1.Ex10.m1.8.8.2.2.2.3.3.cmml">ℱ</mi></mrow></munder><mrow id="A1.Ex10.m1.8.8.2.2.1.1" xref="A1.Ex10.m1.8.8.2.2.1.2.cmml"><mo id="A1.Ex10.m1.8.8.2.2.1.1.2" maxsize="120%" minsize="120%" xref="A1.Ex10.m1.8.8.2.2.1.2.1.cmml">|</mo><mrow id="A1.Ex10.m1.8.8.2.2.1.1.1" xref="A1.Ex10.m1.8.8.2.2.1.1.1.cmml"><mrow id="A1.Ex10.m1.8.8.2.2.1.1.1.1" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.cmml"><msub id="A1.Ex10.m1.8.8.2.2.1.1.1.1.3" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.cmml"><mi id="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.2" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.2.cmml">𝔼</mi><msub id="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.3" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.3.cmml"><mover accent="true" id="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.3.2" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.3.2.cmml"><mi class="ltx_font_mathscript" id="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.3.2.2" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.3.2.2.cmml">𝒟</mi><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.3.2.1" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.3.2.1.cmml">~</mo></mover><mi id="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.3.3" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.3.3.cmml">Y</mi></msub></msub><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.1.2" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.2.cmml"><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.4" mathvariant="normal" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.4.cmml">ℓ</mi><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.3" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.2" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.3.cmml"><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.2.3" stretchy="false" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.3.cmml">(</mo><mrow id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">f</mi><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex10.m1.3.3" xref="A1.Ex10.m1.3.3.cmml">Y</mi><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.2.4" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.3.cmml">,</mo><mrow id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.2.2" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.2.2.2" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.2.2.2.cmml">g</mi><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.2.2.1" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.2.2.1.cmml">⁢</mo><mrow id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.2.2.3.2" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.2.2.cmml"><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.2.2.3.2.1" stretchy="false" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.2.2.cmml">(</mo><mi id="A1.Ex10.m1.4.4" xref="A1.Ex10.m1.4.4.cmml">Y</mi><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.2.2.3.2.2" stretchy="false" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.2.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.2.5" stretchy="false" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.3" xref="A1.Ex10.m1.8.8.2.2.1.1.1.3.cmml">−</mo><mrow id="A1.Ex10.m1.8.8.2.2.1.1.1.2" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.cmml"><msub id="A1.Ex10.m1.8.8.2.2.1.1.1.2.3" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.cmml"><mi id="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.2" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.2.cmml">𝔼</mi><msub id="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.3" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.3.cmml"><mover accent="true" id="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.3.2" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.3.2.cmml"><mi class="ltx_font_mathscript" id="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.3.2.2" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.3.2.2.cmml">𝒮</mi><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.3.2.1" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.3.2.1.cmml">~</mo></mover><mi id="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.3.3" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.3.3.cmml">n</mi></msub></msub><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.2.2" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.2.cmml">⁢</mo><mrow id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.2.cmml"><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.2" stretchy="false" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.2.1.cmml">[</mo><mrow id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.cmml"><mi id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.4" mathvariant="normal" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.4.cmml">ℓ</mi><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.3" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.3.cmml">⁢</mo><mrow id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.2" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.3.cmml"><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.2.3" stretchy="false" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.3.cmml">(</mo><mrow id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.1.1.1" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.1.1.1.cmml"><mi id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.1.1.1.2" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.1.1.1.2.cmml">f</mi><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.1.1.1.1" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.1.1.1.3.2" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex10.m1.5.5" xref="A1.Ex10.m1.5.5.cmml">Y</mi><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.2.4" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.3.cmml">,</mo><mrow id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.2.2" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.2.2.cmml"><mi id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.2.2.2" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.2.2.2.cmml">g</mi><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.2.2.1" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.2.2.1.cmml">⁢</mo><mrow id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.2.2.3.2" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.2.2.cmml"><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.2.2.3.2.1" stretchy="false" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.2.2.cmml">(</mo><mi id="A1.Ex10.m1.6.6" xref="A1.Ex10.m1.6.6.cmml">Y</mi><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.2.2.3.2.2" stretchy="false" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.2.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.2.5" stretchy="false" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.3" stretchy="false" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A1.Ex10.m1.8.8.2.2.1.1.3" maxsize="120%" minsize="120%" xref="A1.Ex10.m1.8.8.2.2.1.2.1.cmml">|</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex10.m1.8b"><apply id="A1.Ex10.m1.8.8.cmml" xref="A1.Ex10.m1.8.8"><leq id="A1.Ex10.m1.8.8.3.cmml" xref="A1.Ex10.m1.8.8.3"></leq><csymbol cd="latexml" id="A1.Ex10.m1.8.8.4.cmml" xref="A1.Ex10.m1.8.8.4">absent</csymbol><apply id="A1.Ex10.m1.8.8.2.cmml" xref="A1.Ex10.m1.8.8.2"><plus id="A1.Ex10.m1.8.8.2.3.cmml" xref="A1.Ex10.m1.8.8.2.3"></plus><apply id="A1.Ex10.m1.7.7.1.1.cmml" xref="A1.Ex10.m1.7.7.1.1"><times id="A1.Ex10.m1.7.7.1.1.2.cmml" xref="A1.Ex10.m1.7.7.1.1.2"></times><apply id="A1.Ex10.m1.7.7.1.1.3.cmml" xref="A1.Ex10.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="A1.Ex10.m1.7.7.1.1.3.1.cmml" xref="A1.Ex10.m1.7.7.1.1.3">subscript</csymbol><ci id="A1.Ex10.m1.7.7.1.1.3.2.cmml" xref="A1.Ex10.m1.7.7.1.1.3.2">𝔼</ci><apply id="A1.Ex10.m1.7.7.1.1.3.3.cmml" xref="A1.Ex10.m1.7.7.1.1.3.3"><csymbol cd="ambiguous" id="A1.Ex10.m1.7.7.1.1.3.3.1.cmml" xref="A1.Ex10.m1.7.7.1.1.3.3">subscript</csymbol><apply id="A1.Ex10.m1.7.7.1.1.3.3.2.cmml" xref="A1.Ex10.m1.7.7.1.1.3.3.2"><ci id="A1.Ex10.m1.7.7.1.1.3.3.2.1.cmml" xref="A1.Ex10.m1.7.7.1.1.3.3.2.1">~</ci><ci id="A1.Ex10.m1.7.7.1.1.3.3.2.2.cmml" xref="A1.Ex10.m1.7.7.1.1.3.3.2.2">𝒮</ci></apply><ci id="A1.Ex10.m1.7.7.1.1.3.3.3.cmml" xref="A1.Ex10.m1.7.7.1.1.3.3.3">𝑛</ci></apply></apply><apply id="A1.Ex10.m1.7.7.1.1.1.2.cmml" xref="A1.Ex10.m1.7.7.1.1.1.1"><csymbol cd="latexml" id="A1.Ex10.m1.7.7.1.1.1.2.1.cmml" xref="A1.Ex10.m1.7.7.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.Ex10.m1.7.7.1.1.1.1.1.cmml" xref="A1.Ex10.m1.7.7.1.1.1.1.1"><times id="A1.Ex10.m1.7.7.1.1.1.1.1.3.cmml" xref="A1.Ex10.m1.7.7.1.1.1.1.1.3"></times><ci id="A1.Ex10.m1.7.7.1.1.1.1.1.4.cmml" xref="A1.Ex10.m1.7.7.1.1.1.1.1.4">ℓ</ci><interval closure="open" id="A1.Ex10.m1.7.7.1.1.1.1.1.2.3.cmml" xref="A1.Ex10.m1.7.7.1.1.1.1.1.2.2"><apply id="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1"><times id="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.1"></times><apply id="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.2.2"><ci id="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.2.2.1">~</ci><ci id="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.2.2.2">𝑓</ci></apply><ci id="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex10.m1.7.7.1.1.1.1.1.1.1.1.2.3">𝑛</ci></apply><ci id="A1.Ex10.m1.1.1.cmml" xref="A1.Ex10.m1.1.1">𝑌</ci></apply><apply id="A1.Ex10.m1.7.7.1.1.1.1.1.2.2.2.cmml" xref="A1.Ex10.m1.7.7.1.1.1.1.1.2.2.2"><times id="A1.Ex10.m1.7.7.1.1.1.1.1.2.2.2.1.cmml" xref="A1.Ex10.m1.7.7.1.1.1.1.1.2.2.2.1"></times><ci id="A1.Ex10.m1.7.7.1.1.1.1.1.2.2.2.2.cmml" xref="A1.Ex10.m1.7.7.1.1.1.1.1.2.2.2.2">𝑔</ci><ci id="A1.Ex10.m1.2.2.cmml" xref="A1.Ex10.m1.2.2">𝑌</ci></apply></interval></apply></apply></apply><apply id="A1.Ex10.m1.8.8.2.2.cmml" xref="A1.Ex10.m1.8.8.2.2"><apply id="A1.Ex10.m1.8.8.2.2.2.cmml" xref="A1.Ex10.m1.8.8.2.2.2"><csymbol cd="ambiguous" id="A1.Ex10.m1.8.8.2.2.2.1.cmml" xref="A1.Ex10.m1.8.8.2.2.2">subscript</csymbol><csymbol cd="latexml" id="A1.Ex10.m1.8.8.2.2.2.2.cmml" xref="A1.Ex10.m1.8.8.2.2.2.2">supremum</csymbol><apply id="A1.Ex10.m1.8.8.2.2.2.3.cmml" xref="A1.Ex10.m1.8.8.2.2.2.3"><in id="A1.Ex10.m1.8.8.2.2.2.3.1.cmml" xref="A1.Ex10.m1.8.8.2.2.2.3.1"></in><ci id="A1.Ex10.m1.8.8.2.2.2.3.2.cmml" xref="A1.Ex10.m1.8.8.2.2.2.3.2">𝑓</ci><ci id="A1.Ex10.m1.8.8.2.2.2.3.3.cmml" xref="A1.Ex10.m1.8.8.2.2.2.3.3">ℱ</ci></apply></apply><apply id="A1.Ex10.m1.8.8.2.2.1.2.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1"><abs id="A1.Ex10.m1.8.8.2.2.1.2.1.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.2"></abs><apply id="A1.Ex10.m1.8.8.2.2.1.1.1.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1"><minus id="A1.Ex10.m1.8.8.2.2.1.1.1.3.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.3"></minus><apply id="A1.Ex10.m1.8.8.2.2.1.1.1.1.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1"><times id="A1.Ex10.m1.8.8.2.2.1.1.1.1.2.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.2"></times><apply id="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.1.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.2.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.2">𝔼</ci><apply id="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.3.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.3.1.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.3">subscript</csymbol><apply id="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.3.2.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.3.2"><ci id="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.3.2.1.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.3.2.1">~</ci><ci id="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.3.2.2.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.3.2.2">𝒟</ci></apply><ci id="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.3.3.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.3.3.3">𝑌</ci></apply></apply><apply id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.2.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.2.1.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1"><times id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.3"></times><ci id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.4.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.4">ℓ</ci><interval closure="open" id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.2"><apply id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.1.1.1"><times id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.1.1.1.2">𝑓</ci><ci id="A1.Ex10.m1.3.3.cmml" xref="A1.Ex10.m1.3.3">𝑌</ci></apply><apply id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.2.2"><times id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.2.2.1"></times><ci id="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.1.1.1.1.2.2.2.2">𝑔</ci><ci id="A1.Ex10.m1.4.4.cmml" xref="A1.Ex10.m1.4.4">𝑌</ci></apply></interval></apply></apply></apply><apply id="A1.Ex10.m1.8.8.2.2.1.1.1.2.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2"><times id="A1.Ex10.m1.8.8.2.2.1.1.1.2.2.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.2"></times><apply id="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.1.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.3">subscript</csymbol><ci id="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.2.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.2">𝔼</ci><apply id="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.3.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.3"><csymbol cd="ambiguous" id="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.3.1.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.3">subscript</csymbol><apply id="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.3.2.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.3.2"><ci id="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.3.2.1.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.3.2.1">~</ci><ci id="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.3.2.2.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.3.2.2">𝒮</ci></apply><ci id="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.3.3.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.3.3.3">𝑛</ci></apply></apply><apply id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.2.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1"><csymbol cd="latexml" id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.2.1.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.2">delimited-[]</csymbol><apply id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1"><times id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.3.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.3"></times><ci id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.4.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.4">ℓ</ci><interval closure="open" id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.3.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.2"><apply id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.1.1.1.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.1.1.1"><times id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.1.1.1.1"></times><ci id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.1.1.1.2">𝑓</ci><ci id="A1.Ex10.m1.5.5.cmml" xref="A1.Ex10.m1.5.5">𝑌</ci></apply><apply id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.2.2.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.2.2"><times id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.2.2.1.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.2.2.1"></times><ci id="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.2.2.2.cmml" xref="A1.Ex10.m1.8.8.2.2.1.1.1.2.1.1.1.2.2.2.2">𝑔</ci><ci id="A1.Ex10.m1.6.6.cmml" xref="A1.Ex10.m1.6.6">𝑌</ci></apply></interval></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex10.m1.8c">\displaystyle\leq\mathbb{E}_{\tilde{\mathscr{S}}_{n}}[\ell(\tilde{f}_{n}(Y),g(%
Y))]+\sup_{f\in\mathcal{F}}\big{|}\mathbb{E}_{\tilde{\mathscr{D}}_{Y}}[\ell(f(%
Y),g(Y))]-\mathbb{E}_{\tilde{\mathscr{S}}_{n}}[\ell(f(Y),g(Y))]\big{|}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex10.m1.8d">≤ blackboard_E start_POSTSUBSCRIPT over~ start_ARG script_S end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ roman_ℓ ( over~ start_ARG italic_f end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ( italic_Y ) , italic_g ( italic_Y ) ) ] + roman_sup start_POSTSUBSCRIPT italic_f ∈ caligraphic_F end_POSTSUBSCRIPT | blackboard_E start_POSTSUBSCRIPT over~ start_ARG script_D end_ARG start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ roman_ℓ ( italic_f ( italic_Y ) , italic_g ( italic_Y ) ) ] - blackboard_E start_POSTSUBSCRIPT over~ start_ARG script_S end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ roman_ℓ ( italic_f ( italic_Y ) , italic_g ( italic_Y ) ) ] |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\overset{(i)}{=}\mathbb{E}_{\tilde{\mathscr{S}}_{n}}[\ell(\tilde{%
f}_{n}(Y),h(X))]+\sup_{g\in\mathcal{G}_{\ell,\mathcal{F}}}\Big{|}\mathbb{E}_{%
\tilde{\mathscr{D}}_{Y}}[g(Y)]-\mathbb{E}_{\tilde{\mathscr{S}}_{n}}[g(Y)]\Big{|}" class="ltx_Math" display="inline" id="A1.Ex11.m1.9"><semantics id="A1.Ex11.m1.9a"><mrow id="A1.Ex11.m1.9.9" xref="A1.Ex11.m1.9.9.cmml"><mrow id="A1.Ex11.m1.8.8.1" xref="A1.Ex11.m1.8.8.1.cmml"><mover accent="true" id="A1.Ex11.m1.1.1" xref="A1.Ex11.m1.1.1.cmml"><mo id="A1.Ex11.m1.1.1.2" xref="A1.Ex11.m1.1.1.2.cmml">=</mo><mrow id="A1.Ex11.m1.1.1.1.3" xref="A1.Ex11.m1.1.1.cmml"><mo id="A1.Ex11.m1.1.1.1.3.1" stretchy="false" xref="A1.Ex11.m1.1.1.cmml">(</mo><mi id="A1.Ex11.m1.1.1.1.1" xref="A1.Ex11.m1.1.1.1.1.cmml">i</mi><mo id="A1.Ex11.m1.1.1.1.3.2" stretchy="false" xref="A1.Ex11.m1.1.1.cmml">)</mo></mrow></mover><mo id="A1.Ex11.m1.8.8.1.2" xref="A1.Ex11.m1.8.8.1.2.cmml">⁢</mo><msub id="A1.Ex11.m1.8.8.1.3" xref="A1.Ex11.m1.8.8.1.3.cmml"><mi id="A1.Ex11.m1.8.8.1.3.2" xref="A1.Ex11.m1.8.8.1.3.2.cmml">𝔼</mi><msub id="A1.Ex11.m1.8.8.1.3.3" xref="A1.Ex11.m1.8.8.1.3.3.cmml"><mover accent="true" id="A1.Ex11.m1.8.8.1.3.3.2" xref="A1.Ex11.m1.8.8.1.3.3.2.cmml"><mi class="ltx_font_mathscript" id="A1.Ex11.m1.8.8.1.3.3.2.2" xref="A1.Ex11.m1.8.8.1.3.3.2.2.cmml">𝒮</mi><mo id="A1.Ex11.m1.8.8.1.3.3.2.1" xref="A1.Ex11.m1.8.8.1.3.3.2.1.cmml">~</mo></mover><mi id="A1.Ex11.m1.8.8.1.3.3.3" xref="A1.Ex11.m1.8.8.1.3.3.3.cmml">n</mi></msub></msub><mo id="A1.Ex11.m1.8.8.1.2a" xref="A1.Ex11.m1.8.8.1.2.cmml">⁢</mo><mrow id="A1.Ex11.m1.8.8.1.1.1" xref="A1.Ex11.m1.8.8.1.1.2.cmml"><mo id="A1.Ex11.m1.8.8.1.1.1.2" stretchy="false" xref="A1.Ex11.m1.8.8.1.1.2.1.cmml">[</mo><mrow id="A1.Ex11.m1.8.8.1.1.1.1" xref="A1.Ex11.m1.8.8.1.1.1.1.cmml"><mi id="A1.Ex11.m1.8.8.1.1.1.1.4" mathvariant="normal" xref="A1.Ex11.m1.8.8.1.1.1.1.4.cmml">ℓ</mi><mo id="A1.Ex11.m1.8.8.1.1.1.1.3" xref="A1.Ex11.m1.8.8.1.1.1.1.3.cmml">⁢</mo><mrow id="A1.Ex11.m1.8.8.1.1.1.1.2.2" xref="A1.Ex11.m1.8.8.1.1.1.1.2.3.cmml"><mo id="A1.Ex11.m1.8.8.1.1.1.1.2.2.3" stretchy="false" xref="A1.Ex11.m1.8.8.1.1.1.1.2.3.cmml">(</mo><mrow id="A1.Ex11.m1.8.8.1.1.1.1.1.1.1" xref="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.cmml"><msub id="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.2" xref="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.2.2" xref="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.2.2.cmml"><mi id="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.2.2.2" xref="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.2.2.2.cmml">f</mi><mo id="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.2.2.1" xref="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.2.2.1.cmml">~</mo></mover><mi id="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.2.3" xref="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.2.3.cmml">n</mi></msub><mo id="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.1" xref="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.3.2" xref="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex11.m1.4.4" xref="A1.Ex11.m1.4.4.cmml">Y</mi><mo id="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex11.m1.8.8.1.1.1.1.2.2.4" xref="A1.Ex11.m1.8.8.1.1.1.1.2.3.cmml">,</mo><mrow id="A1.Ex11.m1.8.8.1.1.1.1.2.2.2" xref="A1.Ex11.m1.8.8.1.1.1.1.2.2.2.cmml"><mi id="A1.Ex11.m1.8.8.1.1.1.1.2.2.2.2" xref="A1.Ex11.m1.8.8.1.1.1.1.2.2.2.2.cmml">h</mi><mo id="A1.Ex11.m1.8.8.1.1.1.1.2.2.2.1" xref="A1.Ex11.m1.8.8.1.1.1.1.2.2.2.1.cmml">⁢</mo><mrow id="A1.Ex11.m1.8.8.1.1.1.1.2.2.2.3.2" xref="A1.Ex11.m1.8.8.1.1.1.1.2.2.2.cmml"><mo id="A1.Ex11.m1.8.8.1.1.1.1.2.2.2.3.2.1" stretchy="false" xref="A1.Ex11.m1.8.8.1.1.1.1.2.2.2.cmml">(</mo><mi id="A1.Ex11.m1.5.5" xref="A1.Ex11.m1.5.5.cmml">X</mi><mo id="A1.Ex11.m1.8.8.1.1.1.1.2.2.2.3.2.2" stretchy="false" xref="A1.Ex11.m1.8.8.1.1.1.1.2.2.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex11.m1.8.8.1.1.1.1.2.2.5" stretchy="false" xref="A1.Ex11.m1.8.8.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="A1.Ex11.m1.8.8.1.1.1.3" stretchy="false" xref="A1.Ex11.m1.8.8.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.Ex11.m1.9.9.3" xref="A1.Ex11.m1.9.9.3.cmml">+</mo><mrow id="A1.Ex11.m1.9.9.2" xref="A1.Ex11.m1.9.9.2.cmml"><munder id="A1.Ex11.m1.9.9.2.2" xref="A1.Ex11.m1.9.9.2.2.cmml"><mo id="A1.Ex11.m1.9.9.2.2.2" lspace="0em" movablelimits="false" rspace="0em" xref="A1.Ex11.m1.9.9.2.2.2.cmml">sup</mo><mrow id="A1.Ex11.m1.3.3.2" xref="A1.Ex11.m1.3.3.2.cmml"><mi id="A1.Ex11.m1.3.3.2.4" xref="A1.Ex11.m1.3.3.2.4.cmml">g</mi><mo id="A1.Ex11.m1.3.3.2.3" xref="A1.Ex11.m1.3.3.2.3.cmml">∈</mo><msub id="A1.Ex11.m1.3.3.2.5" xref="A1.Ex11.m1.3.3.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.Ex11.m1.3.3.2.5.2" xref="A1.Ex11.m1.3.3.2.5.2.cmml">𝒢</mi><mrow id="A1.Ex11.m1.3.3.2.2.2.4" xref="A1.Ex11.m1.3.3.2.2.2.3.cmml"><mi id="A1.Ex11.m1.2.2.1.1.1.1" mathvariant="normal" xref="A1.Ex11.m1.2.2.1.1.1.1.cmml">ℓ</mi><mo id="A1.Ex11.m1.3.3.2.2.2.4.1" xref="A1.Ex11.m1.3.3.2.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A1.Ex11.m1.3.3.2.2.2.2" xref="A1.Ex11.m1.3.3.2.2.2.2.cmml">ℱ</mi></mrow></msub></mrow></munder><mrow id="A1.Ex11.m1.9.9.2.1.1" xref="A1.Ex11.m1.9.9.2.1.2.cmml"><mo id="A1.Ex11.m1.9.9.2.1.1.2" maxsize="160%" minsize="160%" xref="A1.Ex11.m1.9.9.2.1.2.1.cmml">|</mo><mrow id="A1.Ex11.m1.9.9.2.1.1.1" xref="A1.Ex11.m1.9.9.2.1.1.1.cmml"><mrow id="A1.Ex11.m1.9.9.2.1.1.1.1" xref="A1.Ex11.m1.9.9.2.1.1.1.1.cmml"><msub id="A1.Ex11.m1.9.9.2.1.1.1.1.3" xref="A1.Ex11.m1.9.9.2.1.1.1.1.3.cmml"><mi id="A1.Ex11.m1.9.9.2.1.1.1.1.3.2" xref="A1.Ex11.m1.9.9.2.1.1.1.1.3.2.cmml">𝔼</mi><msub id="A1.Ex11.m1.9.9.2.1.1.1.1.3.3" xref="A1.Ex11.m1.9.9.2.1.1.1.1.3.3.cmml"><mover accent="true" id="A1.Ex11.m1.9.9.2.1.1.1.1.3.3.2" xref="A1.Ex11.m1.9.9.2.1.1.1.1.3.3.2.cmml"><mi class="ltx_font_mathscript" id="A1.Ex11.m1.9.9.2.1.1.1.1.3.3.2.2" xref="A1.Ex11.m1.9.9.2.1.1.1.1.3.3.2.2.cmml">𝒟</mi><mo id="A1.Ex11.m1.9.9.2.1.1.1.1.3.3.2.1" xref="A1.Ex11.m1.9.9.2.1.1.1.1.3.3.2.1.cmml">~</mo></mover><mi id="A1.Ex11.m1.9.9.2.1.1.1.1.3.3.3" xref="A1.Ex11.m1.9.9.2.1.1.1.1.3.3.3.cmml">Y</mi></msub></msub><mo id="A1.Ex11.m1.9.9.2.1.1.1.1.2" xref="A1.Ex11.m1.9.9.2.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex11.m1.9.9.2.1.1.1.1.1.1" xref="A1.Ex11.m1.9.9.2.1.1.1.1.1.2.cmml"><mo id="A1.Ex11.m1.9.9.2.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex11.m1.9.9.2.1.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.Ex11.m1.9.9.2.1.1.1.1.1.1.1" xref="A1.Ex11.m1.9.9.2.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex11.m1.9.9.2.1.1.1.1.1.1.1.2" xref="A1.Ex11.m1.9.9.2.1.1.1.1.1.1.1.2.cmml">g</mi><mo id="A1.Ex11.m1.9.9.2.1.1.1.1.1.1.1.1" xref="A1.Ex11.m1.9.9.2.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.Ex11.m1.9.9.2.1.1.1.1.1.1.1.3.2" xref="A1.Ex11.m1.9.9.2.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex11.m1.9.9.2.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.Ex11.m1.9.9.2.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex11.m1.6.6" xref="A1.Ex11.m1.6.6.cmml">Y</mi><mo id="A1.Ex11.m1.9.9.2.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A1.Ex11.m1.9.9.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex11.m1.9.9.2.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex11.m1.9.9.2.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.Ex11.m1.9.9.2.1.1.1.3" xref="A1.Ex11.m1.9.9.2.1.1.1.3.cmml">−</mo><mrow id="A1.Ex11.m1.9.9.2.1.1.1.2" xref="A1.Ex11.m1.9.9.2.1.1.1.2.cmml"><msub id="A1.Ex11.m1.9.9.2.1.1.1.2.3" xref="A1.Ex11.m1.9.9.2.1.1.1.2.3.cmml"><mi id="A1.Ex11.m1.9.9.2.1.1.1.2.3.2" xref="A1.Ex11.m1.9.9.2.1.1.1.2.3.2.cmml">𝔼</mi><msub id="A1.Ex11.m1.9.9.2.1.1.1.2.3.3" xref="A1.Ex11.m1.9.9.2.1.1.1.2.3.3.cmml"><mover accent="true" id="A1.Ex11.m1.9.9.2.1.1.1.2.3.3.2" xref="A1.Ex11.m1.9.9.2.1.1.1.2.3.3.2.cmml"><mi class="ltx_font_mathscript" id="A1.Ex11.m1.9.9.2.1.1.1.2.3.3.2.2" xref="A1.Ex11.m1.9.9.2.1.1.1.2.3.3.2.2.cmml">𝒮</mi><mo id="A1.Ex11.m1.9.9.2.1.1.1.2.3.3.2.1" xref="A1.Ex11.m1.9.9.2.1.1.1.2.3.3.2.1.cmml">~</mo></mover><mi id="A1.Ex11.m1.9.9.2.1.1.1.2.3.3.3" xref="A1.Ex11.m1.9.9.2.1.1.1.2.3.3.3.cmml">n</mi></msub></msub><mo id="A1.Ex11.m1.9.9.2.1.1.1.2.2" xref="A1.Ex11.m1.9.9.2.1.1.1.2.2.cmml">⁢</mo><mrow id="A1.Ex11.m1.9.9.2.1.1.1.2.1.1" xref="A1.Ex11.m1.9.9.2.1.1.1.2.1.2.cmml"><mo id="A1.Ex11.m1.9.9.2.1.1.1.2.1.1.2" stretchy="false" xref="A1.Ex11.m1.9.9.2.1.1.1.2.1.2.1.cmml">[</mo><mrow id="A1.Ex11.m1.9.9.2.1.1.1.2.1.1.1" xref="A1.Ex11.m1.9.9.2.1.1.1.2.1.1.1.cmml"><mi id="A1.Ex11.m1.9.9.2.1.1.1.2.1.1.1.2" xref="A1.Ex11.m1.9.9.2.1.1.1.2.1.1.1.2.cmml">g</mi><mo id="A1.Ex11.m1.9.9.2.1.1.1.2.1.1.1.1" xref="A1.Ex11.m1.9.9.2.1.1.1.2.1.1.1.1.cmml">⁢</mo><mrow id="A1.Ex11.m1.9.9.2.1.1.1.2.1.1.1.3.2" xref="A1.Ex11.m1.9.9.2.1.1.1.2.1.1.1.cmml"><mo id="A1.Ex11.m1.9.9.2.1.1.1.2.1.1.1.3.2.1" stretchy="false" xref="A1.Ex11.m1.9.9.2.1.1.1.2.1.1.1.cmml">(</mo><mi id="A1.Ex11.m1.7.7" xref="A1.Ex11.m1.7.7.cmml">Y</mi><mo id="A1.Ex11.m1.9.9.2.1.1.1.2.1.1.1.3.2.2" stretchy="false" xref="A1.Ex11.m1.9.9.2.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex11.m1.9.9.2.1.1.1.2.1.1.3" stretchy="false" xref="A1.Ex11.m1.9.9.2.1.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A1.Ex11.m1.9.9.2.1.1.3" maxsize="160%" minsize="160%" xref="A1.Ex11.m1.9.9.2.1.2.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex11.m1.9b"><apply id="A1.Ex11.m1.9.9.cmml" xref="A1.Ex11.m1.9.9"><plus id="A1.Ex11.m1.9.9.3.cmml" xref="A1.Ex11.m1.9.9.3"></plus><apply id="A1.Ex11.m1.8.8.1.cmml" xref="A1.Ex11.m1.8.8.1"><times id="A1.Ex11.m1.8.8.1.2.cmml" xref="A1.Ex11.m1.8.8.1.2"></times><apply id="A1.Ex11.m1.1.1.cmml" xref="A1.Ex11.m1.1.1"><ci id="A1.Ex11.m1.1.1.1.1.cmml" xref="A1.Ex11.m1.1.1.1.1">𝑖</ci><eq id="A1.Ex11.m1.1.1.2.cmml" xref="A1.Ex11.m1.1.1.2"></eq></apply><apply id="A1.Ex11.m1.8.8.1.3.cmml" xref="A1.Ex11.m1.8.8.1.3"><csymbol cd="ambiguous" id="A1.Ex11.m1.8.8.1.3.1.cmml" xref="A1.Ex11.m1.8.8.1.3">subscript</csymbol><ci id="A1.Ex11.m1.8.8.1.3.2.cmml" xref="A1.Ex11.m1.8.8.1.3.2">𝔼</ci><apply id="A1.Ex11.m1.8.8.1.3.3.cmml" xref="A1.Ex11.m1.8.8.1.3.3"><csymbol cd="ambiguous" id="A1.Ex11.m1.8.8.1.3.3.1.cmml" xref="A1.Ex11.m1.8.8.1.3.3">subscript</csymbol><apply id="A1.Ex11.m1.8.8.1.3.3.2.cmml" xref="A1.Ex11.m1.8.8.1.3.3.2"><ci id="A1.Ex11.m1.8.8.1.3.3.2.1.cmml" xref="A1.Ex11.m1.8.8.1.3.3.2.1">~</ci><ci id="A1.Ex11.m1.8.8.1.3.3.2.2.cmml" xref="A1.Ex11.m1.8.8.1.3.3.2.2">𝒮</ci></apply><ci id="A1.Ex11.m1.8.8.1.3.3.3.cmml" xref="A1.Ex11.m1.8.8.1.3.3.3">𝑛</ci></apply></apply><apply id="A1.Ex11.m1.8.8.1.1.2.cmml" xref="A1.Ex11.m1.8.8.1.1.1"><csymbol cd="latexml" id="A1.Ex11.m1.8.8.1.1.2.1.cmml" xref="A1.Ex11.m1.8.8.1.1.1.2">delimited-[]</csymbol><apply id="A1.Ex11.m1.8.8.1.1.1.1.cmml" xref="A1.Ex11.m1.8.8.1.1.1.1"><times id="A1.Ex11.m1.8.8.1.1.1.1.3.cmml" xref="A1.Ex11.m1.8.8.1.1.1.1.3"></times><ci id="A1.Ex11.m1.8.8.1.1.1.1.4.cmml" xref="A1.Ex11.m1.8.8.1.1.1.1.4">ℓ</ci><interval closure="open" id="A1.Ex11.m1.8.8.1.1.1.1.2.3.cmml" xref="A1.Ex11.m1.8.8.1.1.1.1.2.2"><apply id="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.cmml" xref="A1.Ex11.m1.8.8.1.1.1.1.1.1.1"><times id="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.1"></times><apply id="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.2.2"><ci id="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.2.2.1">~</ci><ci id="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.2.2.2">𝑓</ci></apply><ci id="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex11.m1.8.8.1.1.1.1.1.1.1.2.3">𝑛</ci></apply><ci id="A1.Ex11.m1.4.4.cmml" xref="A1.Ex11.m1.4.4">𝑌</ci></apply><apply id="A1.Ex11.m1.8.8.1.1.1.1.2.2.2.cmml" xref="A1.Ex11.m1.8.8.1.1.1.1.2.2.2"><times id="A1.Ex11.m1.8.8.1.1.1.1.2.2.2.1.cmml" xref="A1.Ex11.m1.8.8.1.1.1.1.2.2.2.1"></times><ci id="A1.Ex11.m1.8.8.1.1.1.1.2.2.2.2.cmml" xref="A1.Ex11.m1.8.8.1.1.1.1.2.2.2.2">ℎ</ci><ci id="A1.Ex11.m1.5.5.cmml" xref="A1.Ex11.m1.5.5">𝑋</ci></apply></interval></apply></apply></apply><apply id="A1.Ex11.m1.9.9.2.cmml" xref="A1.Ex11.m1.9.9.2"><apply id="A1.Ex11.m1.9.9.2.2.cmml" xref="A1.Ex11.m1.9.9.2.2"><csymbol cd="ambiguous" id="A1.Ex11.m1.9.9.2.2.1.cmml" xref="A1.Ex11.m1.9.9.2.2">subscript</csymbol><csymbol cd="latexml" id="A1.Ex11.m1.9.9.2.2.2.cmml" xref="A1.Ex11.m1.9.9.2.2.2">supremum</csymbol><apply id="A1.Ex11.m1.3.3.2.cmml" xref="A1.Ex11.m1.3.3.2"><in id="A1.Ex11.m1.3.3.2.3.cmml" xref="A1.Ex11.m1.3.3.2.3"></in><ci id="A1.Ex11.m1.3.3.2.4.cmml" xref="A1.Ex11.m1.3.3.2.4">𝑔</ci><apply id="A1.Ex11.m1.3.3.2.5.cmml" xref="A1.Ex11.m1.3.3.2.5"><csymbol cd="ambiguous" id="A1.Ex11.m1.3.3.2.5.1.cmml" xref="A1.Ex11.m1.3.3.2.5">subscript</csymbol><ci id="A1.Ex11.m1.3.3.2.5.2.cmml" xref="A1.Ex11.m1.3.3.2.5.2">𝒢</ci><list id="A1.Ex11.m1.3.3.2.2.2.3.cmml" xref="A1.Ex11.m1.3.3.2.2.2.4"><ci id="A1.Ex11.m1.2.2.1.1.1.1.cmml" xref="A1.Ex11.m1.2.2.1.1.1.1">ℓ</ci><ci id="A1.Ex11.m1.3.3.2.2.2.2.cmml" xref="A1.Ex11.m1.3.3.2.2.2.2">ℱ</ci></list></apply></apply></apply><apply id="A1.Ex11.m1.9.9.2.1.2.cmml" xref="A1.Ex11.m1.9.9.2.1.1"><abs id="A1.Ex11.m1.9.9.2.1.2.1.cmml" xref="A1.Ex11.m1.9.9.2.1.1.2"></abs><apply id="A1.Ex11.m1.9.9.2.1.1.1.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1"><minus id="A1.Ex11.m1.9.9.2.1.1.1.3.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.3"></minus><apply id="A1.Ex11.m1.9.9.2.1.1.1.1.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.1"><times id="A1.Ex11.m1.9.9.2.1.1.1.1.2.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.1.2"></times><apply id="A1.Ex11.m1.9.9.2.1.1.1.1.3.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex11.m1.9.9.2.1.1.1.1.3.1.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex11.m1.9.9.2.1.1.1.1.3.2.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.1.3.2">𝔼</ci><apply id="A1.Ex11.m1.9.9.2.1.1.1.1.3.3.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.Ex11.m1.9.9.2.1.1.1.1.3.3.1.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.1.3.3">subscript</csymbol><apply id="A1.Ex11.m1.9.9.2.1.1.1.1.3.3.2.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.1.3.3.2"><ci id="A1.Ex11.m1.9.9.2.1.1.1.1.3.3.2.1.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.1.3.3.2.1">~</ci><ci id="A1.Ex11.m1.9.9.2.1.1.1.1.3.3.2.2.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.1.3.3.2.2">𝒟</ci></apply><ci id="A1.Ex11.m1.9.9.2.1.1.1.1.3.3.3.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.1.3.3.3">𝑌</ci></apply></apply><apply id="A1.Ex11.m1.9.9.2.1.1.1.1.1.2.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex11.m1.9.9.2.1.1.1.1.1.2.1.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.Ex11.m1.9.9.2.1.1.1.1.1.1.1.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.1.1.1.1"><times id="A1.Ex11.m1.9.9.2.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.1.1.1.1.1"></times><ci id="A1.Ex11.m1.9.9.2.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.1.1.1.1.2">𝑔</ci><ci id="A1.Ex11.m1.6.6.cmml" xref="A1.Ex11.m1.6.6">𝑌</ci></apply></apply></apply><apply id="A1.Ex11.m1.9.9.2.1.1.1.2.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.2"><times id="A1.Ex11.m1.9.9.2.1.1.1.2.2.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.2.2"></times><apply id="A1.Ex11.m1.9.9.2.1.1.1.2.3.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.Ex11.m1.9.9.2.1.1.1.2.3.1.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.2.3">subscript</csymbol><ci id="A1.Ex11.m1.9.9.2.1.1.1.2.3.2.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.2.3.2">𝔼</ci><apply id="A1.Ex11.m1.9.9.2.1.1.1.2.3.3.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.2.3.3"><csymbol cd="ambiguous" id="A1.Ex11.m1.9.9.2.1.1.1.2.3.3.1.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.2.3.3">subscript</csymbol><apply id="A1.Ex11.m1.9.9.2.1.1.1.2.3.3.2.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.2.3.3.2"><ci id="A1.Ex11.m1.9.9.2.1.1.1.2.3.3.2.1.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.2.3.3.2.1">~</ci><ci id="A1.Ex11.m1.9.9.2.1.1.1.2.3.3.2.2.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.2.3.3.2.2">𝒮</ci></apply><ci id="A1.Ex11.m1.9.9.2.1.1.1.2.3.3.3.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.2.3.3.3">𝑛</ci></apply></apply><apply id="A1.Ex11.m1.9.9.2.1.1.1.2.1.2.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.2.1.1"><csymbol cd="latexml" id="A1.Ex11.m1.9.9.2.1.1.1.2.1.2.1.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.2.1.1.2">delimited-[]</csymbol><apply id="A1.Ex11.m1.9.9.2.1.1.1.2.1.1.1.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.2.1.1.1"><times id="A1.Ex11.m1.9.9.2.1.1.1.2.1.1.1.1.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.2.1.1.1.1"></times><ci id="A1.Ex11.m1.9.9.2.1.1.1.2.1.1.1.2.cmml" xref="A1.Ex11.m1.9.9.2.1.1.1.2.1.1.1.2">𝑔</ci><ci id="A1.Ex11.m1.7.7.cmml" xref="A1.Ex11.m1.7.7">𝑌</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex11.m1.9c">\displaystyle\overset{(i)}{=}\mathbb{E}_{\tilde{\mathscr{S}}_{n}}[\ell(\tilde{%
f}_{n}(Y),h(X))]+\sup_{g\in\mathcal{G}_{\ell,\mathcal{F}}}\Big{|}\mathbb{E}_{%
\tilde{\mathscr{D}}_{Y}}[g(Y)]-\mathbb{E}_{\tilde{\mathscr{S}}_{n}}[g(Y)]\Big{|}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex11.m1.9d">start_OVERACCENT ( italic_i ) end_OVERACCENT start_ARG = end_ARG blackboard_E start_POSTSUBSCRIPT over~ start_ARG script_S end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ roman_ℓ ( over~ start_ARG italic_f end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ( italic_Y ) , italic_h ( italic_X ) ) ] + roman_sup start_POSTSUBSCRIPT italic_g ∈ caligraphic_G start_POSTSUBSCRIPT roman_ℓ , caligraphic_F end_POSTSUBSCRIPT end_POSTSUBSCRIPT | blackboard_E start_POSTSUBSCRIPT over~ start_ARG script_D end_ARG start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ italic_g ( italic_Y ) ] - blackboard_E start_POSTSUBSCRIPT over~ start_ARG script_S end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ italic_g ( italic_Y ) ] |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\overset{(ii)}{\leq}\mathbb{E}_{\tilde{\mathscr{S}}_{n}}[\ell(%
\tilde{f}_{n}(Y),h(X))]+{\mathfrak{R}}_{\tilde{\mathscr{S}}_{n}}(\mathcal{G}_{%
\ell,\mathcal{F}})" class="ltx_Math" display="inline" id="A1.Ex12.m1.7"><semantics id="A1.Ex12.m1.7a"><mrow id="A1.Ex12.m1.7.7" xref="A1.Ex12.m1.7.7.cmml"><mrow id="A1.Ex12.m1.6.6.1" xref="A1.Ex12.m1.6.6.1.cmml"><mover accent="true" id="A1.Ex12.m1.1.1" xref="A1.Ex12.m1.1.1.cmml"><mo id="A1.Ex12.m1.1.1.2" xref="A1.Ex12.m1.1.1.2.cmml">≤</mo><mrow id="A1.Ex12.m1.1.1.1.1" xref="A1.Ex12.m1.1.1.1.1.1.cmml"><mo id="A1.Ex12.m1.1.1.1.1.2" stretchy="false" xref="A1.Ex12.m1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex12.m1.1.1.1.1.1" xref="A1.Ex12.m1.1.1.1.1.1.cmml"><mi id="A1.Ex12.m1.1.1.1.1.1.2" xref="A1.Ex12.m1.1.1.1.1.1.2.cmml">i</mi><mo id="A1.Ex12.m1.1.1.1.1.1.1" xref="A1.Ex12.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.Ex12.m1.1.1.1.1.1.3" xref="A1.Ex12.m1.1.1.1.1.1.3.cmml">i</mi></mrow><mo id="A1.Ex12.m1.1.1.1.1.3" stretchy="false" xref="A1.Ex12.m1.1.1.1.1.1.cmml">)</mo></mrow></mover><mo id="A1.Ex12.m1.6.6.1.2" xref="A1.Ex12.m1.6.6.1.2.cmml">⁢</mo><msub id="A1.Ex12.m1.6.6.1.3" xref="A1.Ex12.m1.6.6.1.3.cmml"><mi id="A1.Ex12.m1.6.6.1.3.2" xref="A1.Ex12.m1.6.6.1.3.2.cmml">𝔼</mi><msub id="A1.Ex12.m1.6.6.1.3.3" xref="A1.Ex12.m1.6.6.1.3.3.cmml"><mover accent="true" id="A1.Ex12.m1.6.6.1.3.3.2" xref="A1.Ex12.m1.6.6.1.3.3.2.cmml"><mi class="ltx_font_mathscript" id="A1.Ex12.m1.6.6.1.3.3.2.2" xref="A1.Ex12.m1.6.6.1.3.3.2.2.cmml">𝒮</mi><mo id="A1.Ex12.m1.6.6.1.3.3.2.1" xref="A1.Ex12.m1.6.6.1.3.3.2.1.cmml">~</mo></mover><mi id="A1.Ex12.m1.6.6.1.3.3.3" xref="A1.Ex12.m1.6.6.1.3.3.3.cmml">n</mi></msub></msub><mo id="A1.Ex12.m1.6.6.1.2a" xref="A1.Ex12.m1.6.6.1.2.cmml">⁢</mo><mrow id="A1.Ex12.m1.6.6.1.1.1" xref="A1.Ex12.m1.6.6.1.1.2.cmml"><mo id="A1.Ex12.m1.6.6.1.1.1.2" stretchy="false" xref="A1.Ex12.m1.6.6.1.1.2.1.cmml">[</mo><mrow id="A1.Ex12.m1.6.6.1.1.1.1" xref="A1.Ex12.m1.6.6.1.1.1.1.cmml"><mi id="A1.Ex12.m1.6.6.1.1.1.1.4" mathvariant="normal" xref="A1.Ex12.m1.6.6.1.1.1.1.4.cmml">ℓ</mi><mo id="A1.Ex12.m1.6.6.1.1.1.1.3" xref="A1.Ex12.m1.6.6.1.1.1.1.3.cmml">⁢</mo><mrow id="A1.Ex12.m1.6.6.1.1.1.1.2.2" xref="A1.Ex12.m1.6.6.1.1.1.1.2.3.cmml"><mo id="A1.Ex12.m1.6.6.1.1.1.1.2.2.3" stretchy="false" xref="A1.Ex12.m1.6.6.1.1.1.1.2.3.cmml">(</mo><mrow id="A1.Ex12.m1.6.6.1.1.1.1.1.1.1" xref="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.cmml"><msub id="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.2" xref="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.2.2" xref="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.2.2.cmml"><mi id="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.2.2.2" xref="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.2.2.2.cmml">f</mi><mo id="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.2.2.1" xref="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.2.2.1.cmml">~</mo></mover><mi id="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.2.3" xref="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.2.3.cmml">n</mi></msub><mo id="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.1" xref="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.3.2" xref="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex12.m1.4.4" xref="A1.Ex12.m1.4.4.cmml">Y</mi><mo id="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex12.m1.6.6.1.1.1.1.2.2.4" xref="A1.Ex12.m1.6.6.1.1.1.1.2.3.cmml">,</mo><mrow id="A1.Ex12.m1.6.6.1.1.1.1.2.2.2" xref="A1.Ex12.m1.6.6.1.1.1.1.2.2.2.cmml"><mi id="A1.Ex12.m1.6.6.1.1.1.1.2.2.2.2" xref="A1.Ex12.m1.6.6.1.1.1.1.2.2.2.2.cmml">h</mi><mo id="A1.Ex12.m1.6.6.1.1.1.1.2.2.2.1" xref="A1.Ex12.m1.6.6.1.1.1.1.2.2.2.1.cmml">⁢</mo><mrow id="A1.Ex12.m1.6.6.1.1.1.1.2.2.2.3.2" xref="A1.Ex12.m1.6.6.1.1.1.1.2.2.2.cmml"><mo id="A1.Ex12.m1.6.6.1.1.1.1.2.2.2.3.2.1" stretchy="false" xref="A1.Ex12.m1.6.6.1.1.1.1.2.2.2.cmml">(</mo><mi id="A1.Ex12.m1.5.5" xref="A1.Ex12.m1.5.5.cmml">X</mi><mo id="A1.Ex12.m1.6.6.1.1.1.1.2.2.2.3.2.2" stretchy="false" xref="A1.Ex12.m1.6.6.1.1.1.1.2.2.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex12.m1.6.6.1.1.1.1.2.2.5" stretchy="false" xref="A1.Ex12.m1.6.6.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="A1.Ex12.m1.6.6.1.1.1.3" stretchy="false" xref="A1.Ex12.m1.6.6.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.Ex12.m1.7.7.3" xref="A1.Ex12.m1.7.7.3.cmml">+</mo><mrow id="A1.Ex12.m1.7.7.2" xref="A1.Ex12.m1.7.7.2.cmml"><msub id="A1.Ex12.m1.7.7.2.3" xref="A1.Ex12.m1.7.7.2.3.cmml"><mi id="A1.Ex12.m1.7.7.2.3.2" xref="A1.Ex12.m1.7.7.2.3.2.cmml">ℜ</mi><msub id="A1.Ex12.m1.7.7.2.3.3" xref="A1.Ex12.m1.7.7.2.3.3.cmml"><mover accent="true" id="A1.Ex12.m1.7.7.2.3.3.2" xref="A1.Ex12.m1.7.7.2.3.3.2.cmml"><mi class="ltx_font_mathscript" id="A1.Ex12.m1.7.7.2.3.3.2.2" xref="A1.Ex12.m1.7.7.2.3.3.2.2.cmml">𝒮</mi><mo id="A1.Ex12.m1.7.7.2.3.3.2.1" xref="A1.Ex12.m1.7.7.2.3.3.2.1.cmml">~</mo></mover><mi id="A1.Ex12.m1.7.7.2.3.3.3" xref="A1.Ex12.m1.7.7.2.3.3.3.cmml">n</mi></msub></msub><mo id="A1.Ex12.m1.7.7.2.2" xref="A1.Ex12.m1.7.7.2.2.cmml">⁢</mo><mrow id="A1.Ex12.m1.7.7.2.1.1" xref="A1.Ex12.m1.7.7.2.1.1.1.cmml"><mo id="A1.Ex12.m1.7.7.2.1.1.2" stretchy="false" xref="A1.Ex12.m1.7.7.2.1.1.1.cmml">(</mo><msub id="A1.Ex12.m1.7.7.2.1.1.1" xref="A1.Ex12.m1.7.7.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.Ex12.m1.7.7.2.1.1.1.2" xref="A1.Ex12.m1.7.7.2.1.1.1.2.cmml">𝒢</mi><mrow id="A1.Ex12.m1.3.3.2.4" xref="A1.Ex12.m1.3.3.2.3.cmml"><mi id="A1.Ex12.m1.2.2.1.1" mathvariant="normal" xref="A1.Ex12.m1.2.2.1.1.cmml">ℓ</mi><mo id="A1.Ex12.m1.3.3.2.4.1" xref="A1.Ex12.m1.3.3.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A1.Ex12.m1.3.3.2.2" xref="A1.Ex12.m1.3.3.2.2.cmml">ℱ</mi></mrow></msub><mo id="A1.Ex12.m1.7.7.2.1.1.3" stretchy="false" xref="A1.Ex12.m1.7.7.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex12.m1.7b"><apply id="A1.Ex12.m1.7.7.cmml" xref="A1.Ex12.m1.7.7"><plus id="A1.Ex12.m1.7.7.3.cmml" xref="A1.Ex12.m1.7.7.3"></plus><apply id="A1.Ex12.m1.6.6.1.cmml" xref="A1.Ex12.m1.6.6.1"><times id="A1.Ex12.m1.6.6.1.2.cmml" xref="A1.Ex12.m1.6.6.1.2"></times><apply id="A1.Ex12.m1.1.1.cmml" xref="A1.Ex12.m1.1.1"><apply id="A1.Ex12.m1.1.1.1.1.1.cmml" xref="A1.Ex12.m1.1.1.1.1"><times id="A1.Ex12.m1.1.1.1.1.1.1.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1"></times><ci id="A1.Ex12.m1.1.1.1.1.1.2.cmml" xref="A1.Ex12.m1.1.1.1.1.1.2">𝑖</ci><ci id="A1.Ex12.m1.1.1.1.1.1.3.cmml" xref="A1.Ex12.m1.1.1.1.1.1.3">𝑖</ci></apply><leq id="A1.Ex12.m1.1.1.2.cmml" xref="A1.Ex12.m1.1.1.2"></leq></apply><apply id="A1.Ex12.m1.6.6.1.3.cmml" xref="A1.Ex12.m1.6.6.1.3"><csymbol cd="ambiguous" id="A1.Ex12.m1.6.6.1.3.1.cmml" xref="A1.Ex12.m1.6.6.1.3">subscript</csymbol><ci id="A1.Ex12.m1.6.6.1.3.2.cmml" xref="A1.Ex12.m1.6.6.1.3.2">𝔼</ci><apply id="A1.Ex12.m1.6.6.1.3.3.cmml" xref="A1.Ex12.m1.6.6.1.3.3"><csymbol cd="ambiguous" id="A1.Ex12.m1.6.6.1.3.3.1.cmml" xref="A1.Ex12.m1.6.6.1.3.3">subscript</csymbol><apply id="A1.Ex12.m1.6.6.1.3.3.2.cmml" xref="A1.Ex12.m1.6.6.1.3.3.2"><ci id="A1.Ex12.m1.6.6.1.3.3.2.1.cmml" xref="A1.Ex12.m1.6.6.1.3.3.2.1">~</ci><ci id="A1.Ex12.m1.6.6.1.3.3.2.2.cmml" xref="A1.Ex12.m1.6.6.1.3.3.2.2">𝒮</ci></apply><ci id="A1.Ex12.m1.6.6.1.3.3.3.cmml" xref="A1.Ex12.m1.6.6.1.3.3.3">𝑛</ci></apply></apply><apply id="A1.Ex12.m1.6.6.1.1.2.cmml" xref="A1.Ex12.m1.6.6.1.1.1"><csymbol cd="latexml" id="A1.Ex12.m1.6.6.1.1.2.1.cmml" xref="A1.Ex12.m1.6.6.1.1.1.2">delimited-[]</csymbol><apply id="A1.Ex12.m1.6.6.1.1.1.1.cmml" xref="A1.Ex12.m1.6.6.1.1.1.1"><times id="A1.Ex12.m1.6.6.1.1.1.1.3.cmml" xref="A1.Ex12.m1.6.6.1.1.1.1.3"></times><ci id="A1.Ex12.m1.6.6.1.1.1.1.4.cmml" xref="A1.Ex12.m1.6.6.1.1.1.1.4">ℓ</ci><interval closure="open" id="A1.Ex12.m1.6.6.1.1.1.1.2.3.cmml" xref="A1.Ex12.m1.6.6.1.1.1.1.2.2"><apply id="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.cmml" xref="A1.Ex12.m1.6.6.1.1.1.1.1.1.1"><times id="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.1"></times><apply id="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.2.2"><ci id="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.2.2.1">~</ci><ci id="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.2.2.2">𝑓</ci></apply><ci id="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex12.m1.6.6.1.1.1.1.1.1.1.2.3">𝑛</ci></apply><ci id="A1.Ex12.m1.4.4.cmml" xref="A1.Ex12.m1.4.4">𝑌</ci></apply><apply id="A1.Ex12.m1.6.6.1.1.1.1.2.2.2.cmml" xref="A1.Ex12.m1.6.6.1.1.1.1.2.2.2"><times id="A1.Ex12.m1.6.6.1.1.1.1.2.2.2.1.cmml" xref="A1.Ex12.m1.6.6.1.1.1.1.2.2.2.1"></times><ci id="A1.Ex12.m1.6.6.1.1.1.1.2.2.2.2.cmml" xref="A1.Ex12.m1.6.6.1.1.1.1.2.2.2.2">ℎ</ci><ci id="A1.Ex12.m1.5.5.cmml" xref="A1.Ex12.m1.5.5">𝑋</ci></apply></interval></apply></apply></apply><apply id="A1.Ex12.m1.7.7.2.cmml" xref="A1.Ex12.m1.7.7.2"><times id="A1.Ex12.m1.7.7.2.2.cmml" xref="A1.Ex12.m1.7.7.2.2"></times><apply id="A1.Ex12.m1.7.7.2.3.cmml" xref="A1.Ex12.m1.7.7.2.3"><csymbol cd="ambiguous" id="A1.Ex12.m1.7.7.2.3.1.cmml" xref="A1.Ex12.m1.7.7.2.3">subscript</csymbol><ci id="A1.Ex12.m1.7.7.2.3.2.cmml" xref="A1.Ex12.m1.7.7.2.3.2">ℜ</ci><apply id="A1.Ex12.m1.7.7.2.3.3.cmml" xref="A1.Ex12.m1.7.7.2.3.3"><csymbol cd="ambiguous" id="A1.Ex12.m1.7.7.2.3.3.1.cmml" xref="A1.Ex12.m1.7.7.2.3.3">subscript</csymbol><apply id="A1.Ex12.m1.7.7.2.3.3.2.cmml" xref="A1.Ex12.m1.7.7.2.3.3.2"><ci id="A1.Ex12.m1.7.7.2.3.3.2.1.cmml" xref="A1.Ex12.m1.7.7.2.3.3.2.1">~</ci><ci id="A1.Ex12.m1.7.7.2.3.3.2.2.cmml" xref="A1.Ex12.m1.7.7.2.3.3.2.2">𝒮</ci></apply><ci id="A1.Ex12.m1.7.7.2.3.3.3.cmml" xref="A1.Ex12.m1.7.7.2.3.3.3">𝑛</ci></apply></apply><apply id="A1.Ex12.m1.7.7.2.1.1.1.cmml" xref="A1.Ex12.m1.7.7.2.1.1"><csymbol cd="ambiguous" id="A1.Ex12.m1.7.7.2.1.1.1.1.cmml" xref="A1.Ex12.m1.7.7.2.1.1">subscript</csymbol><ci id="A1.Ex12.m1.7.7.2.1.1.1.2.cmml" xref="A1.Ex12.m1.7.7.2.1.1.1.2">𝒢</ci><list id="A1.Ex12.m1.3.3.2.3.cmml" xref="A1.Ex12.m1.3.3.2.4"><ci id="A1.Ex12.m1.2.2.1.1.cmml" xref="A1.Ex12.m1.2.2.1.1">ℓ</ci><ci id="A1.Ex12.m1.3.3.2.2.cmml" xref="A1.Ex12.m1.3.3.2.2">ℱ</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex12.m1.7c">\displaystyle\overset{(ii)}{\leq}\mathbb{E}_{\tilde{\mathscr{S}}_{n}}[\ell(%
\tilde{f}_{n}(Y),h(X))]+{\mathfrak{R}}_{\tilde{\mathscr{S}}_{n}}(\mathcal{G}_{%
\ell,\mathcal{F}})</annotation><annotation encoding="application/x-llamapun" id="A1.Ex12.m1.7d">start_OVERACCENT ( italic_i italic_i ) end_OVERACCENT start_ARG ≤ end_ARG blackboard_E start_POSTSUBSCRIPT over~ start_ARG script_S end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ roman_ℓ ( over~ start_ARG italic_f end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ( italic_Y ) , italic_h ( italic_X ) ) ] + fraktur_R start_POSTSUBSCRIPT over~ start_ARG script_S end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( caligraphic_G start_POSTSUBSCRIPT roman_ℓ , caligraphic_F end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.E21"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=R_{\ell,\tilde{f}_{n}}(\tilde{\mathscr{S}}_{n})+{\mathfrak{R}}_{%
\tilde{\mathscr{S}}_{n}}(\mathcal{G}_{\ell,\mathcal{F}})," class="ltx_Math" display="inline" id="A1.E21.m1.5"><semantics id="A1.E21.m1.5a"><mrow id="A1.E21.m1.5.5.1" xref="A1.E21.m1.5.5.1.1.cmml"><mrow id="A1.E21.m1.5.5.1.1" xref="A1.E21.m1.5.5.1.1.cmml"><mi id="A1.E21.m1.5.5.1.1.4" xref="A1.E21.m1.5.5.1.1.4.cmml"></mi><mo id="A1.E21.m1.5.5.1.1.3" xref="A1.E21.m1.5.5.1.1.3.cmml">=</mo><mrow id="A1.E21.m1.5.5.1.1.2" xref="A1.E21.m1.5.5.1.1.2.cmml"><mrow id="A1.E21.m1.5.5.1.1.1.1" xref="A1.E21.m1.5.5.1.1.1.1.cmml"><msub id="A1.E21.m1.5.5.1.1.1.1.3" xref="A1.E21.m1.5.5.1.1.1.1.3.cmml"><mi id="A1.E21.m1.5.5.1.1.1.1.3.2" xref="A1.E21.m1.5.5.1.1.1.1.3.2.cmml">R</mi><mrow id="A1.E21.m1.2.2.2.2" xref="A1.E21.m1.2.2.2.3.cmml"><mi id="A1.E21.m1.1.1.1.1" mathvariant="normal" xref="A1.E21.m1.1.1.1.1.cmml">ℓ</mi><mo id="A1.E21.m1.2.2.2.2.2" xref="A1.E21.m1.2.2.2.3.cmml">,</mo><msub id="A1.E21.m1.2.2.2.2.1" xref="A1.E21.m1.2.2.2.2.1.cmml"><mover accent="true" id="A1.E21.m1.2.2.2.2.1.2" xref="A1.E21.m1.2.2.2.2.1.2.cmml"><mi id="A1.E21.m1.2.2.2.2.1.2.2" xref="A1.E21.m1.2.2.2.2.1.2.2.cmml">f</mi><mo id="A1.E21.m1.2.2.2.2.1.2.1" xref="A1.E21.m1.2.2.2.2.1.2.1.cmml">~</mo></mover><mi id="A1.E21.m1.2.2.2.2.1.3" xref="A1.E21.m1.2.2.2.2.1.3.cmml">n</mi></msub></mrow></msub><mo id="A1.E21.m1.5.5.1.1.1.1.2" xref="A1.E21.m1.5.5.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E21.m1.5.5.1.1.1.1.1.1" xref="A1.E21.m1.5.5.1.1.1.1.1.1.1.cmml"><mo id="A1.E21.m1.5.5.1.1.1.1.1.1.2" stretchy="false" xref="A1.E21.m1.5.5.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E21.m1.5.5.1.1.1.1.1.1.1" xref="A1.E21.m1.5.5.1.1.1.1.1.1.1.cmml"><mover accent="true" id="A1.E21.m1.5.5.1.1.1.1.1.1.1.2" xref="A1.E21.m1.5.5.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathscript" id="A1.E21.m1.5.5.1.1.1.1.1.1.1.2.2" xref="A1.E21.m1.5.5.1.1.1.1.1.1.1.2.2.cmml">𝒮</mi><mo id="A1.E21.m1.5.5.1.1.1.1.1.1.1.2.1" xref="A1.E21.m1.5.5.1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="A1.E21.m1.5.5.1.1.1.1.1.1.1.3" xref="A1.E21.m1.5.5.1.1.1.1.1.1.1.3.cmml">n</mi></msub><mo id="A1.E21.m1.5.5.1.1.1.1.1.1.3" stretchy="false" xref="A1.E21.m1.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E21.m1.5.5.1.1.2.3" xref="A1.E21.m1.5.5.1.1.2.3.cmml">+</mo><mrow id="A1.E21.m1.5.5.1.1.2.2" xref="A1.E21.m1.5.5.1.1.2.2.cmml"><msub id="A1.E21.m1.5.5.1.1.2.2.3" xref="A1.E21.m1.5.5.1.1.2.2.3.cmml"><mi id="A1.E21.m1.5.5.1.1.2.2.3.2" xref="A1.E21.m1.5.5.1.1.2.2.3.2.cmml">ℜ</mi><msub id="A1.E21.m1.5.5.1.1.2.2.3.3" xref="A1.E21.m1.5.5.1.1.2.2.3.3.cmml"><mover accent="true" id="A1.E21.m1.5.5.1.1.2.2.3.3.2" xref="A1.E21.m1.5.5.1.1.2.2.3.3.2.cmml"><mi class="ltx_font_mathscript" id="A1.E21.m1.5.5.1.1.2.2.3.3.2.2" xref="A1.E21.m1.5.5.1.1.2.2.3.3.2.2.cmml">𝒮</mi><mo id="A1.E21.m1.5.5.1.1.2.2.3.3.2.1" xref="A1.E21.m1.5.5.1.1.2.2.3.3.2.1.cmml">~</mo></mover><mi id="A1.E21.m1.5.5.1.1.2.2.3.3.3" xref="A1.E21.m1.5.5.1.1.2.2.3.3.3.cmml">n</mi></msub></msub><mo id="A1.E21.m1.5.5.1.1.2.2.2" xref="A1.E21.m1.5.5.1.1.2.2.2.cmml">⁢</mo><mrow id="A1.E21.m1.5.5.1.1.2.2.1.1" xref="A1.E21.m1.5.5.1.1.2.2.1.1.1.cmml"><mo id="A1.E21.m1.5.5.1.1.2.2.1.1.2" stretchy="false" xref="A1.E21.m1.5.5.1.1.2.2.1.1.1.cmml">(</mo><msub id="A1.E21.m1.5.5.1.1.2.2.1.1.1" xref="A1.E21.m1.5.5.1.1.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E21.m1.5.5.1.1.2.2.1.1.1.2" xref="A1.E21.m1.5.5.1.1.2.2.1.1.1.2.cmml">𝒢</mi><mrow id="A1.E21.m1.4.4.2.4" xref="A1.E21.m1.4.4.2.3.cmml"><mi id="A1.E21.m1.3.3.1.1" mathvariant="normal" xref="A1.E21.m1.3.3.1.1.cmml">ℓ</mi><mo id="A1.E21.m1.4.4.2.4.1" xref="A1.E21.m1.4.4.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A1.E21.m1.4.4.2.2" xref="A1.E21.m1.4.4.2.2.cmml">ℱ</mi></mrow></msub><mo id="A1.E21.m1.5.5.1.1.2.2.1.1.3" stretchy="false" xref="A1.E21.m1.5.5.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E21.m1.5.5.1.2" xref="A1.E21.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E21.m1.5b"><apply id="A1.E21.m1.5.5.1.1.cmml" xref="A1.E21.m1.5.5.1"><eq id="A1.E21.m1.5.5.1.1.3.cmml" xref="A1.E21.m1.5.5.1.1.3"></eq><csymbol cd="latexml" id="A1.E21.m1.5.5.1.1.4.cmml" xref="A1.E21.m1.5.5.1.1.4">absent</csymbol><apply id="A1.E21.m1.5.5.1.1.2.cmml" xref="A1.E21.m1.5.5.1.1.2"><plus id="A1.E21.m1.5.5.1.1.2.3.cmml" xref="A1.E21.m1.5.5.1.1.2.3"></plus><apply id="A1.E21.m1.5.5.1.1.1.1.cmml" xref="A1.E21.m1.5.5.1.1.1.1"><times id="A1.E21.m1.5.5.1.1.1.1.2.cmml" xref="A1.E21.m1.5.5.1.1.1.1.2"></times><apply id="A1.E21.m1.5.5.1.1.1.1.3.cmml" xref="A1.E21.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E21.m1.5.5.1.1.1.1.3.1.cmml" xref="A1.E21.m1.5.5.1.1.1.1.3">subscript</csymbol><ci id="A1.E21.m1.5.5.1.1.1.1.3.2.cmml" xref="A1.E21.m1.5.5.1.1.1.1.3.2">𝑅</ci><list id="A1.E21.m1.2.2.2.3.cmml" xref="A1.E21.m1.2.2.2.2"><ci id="A1.E21.m1.1.1.1.1.cmml" xref="A1.E21.m1.1.1.1.1">ℓ</ci><apply id="A1.E21.m1.2.2.2.2.1.cmml" xref="A1.E21.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="A1.E21.m1.2.2.2.2.1.1.cmml" xref="A1.E21.m1.2.2.2.2.1">subscript</csymbol><apply id="A1.E21.m1.2.2.2.2.1.2.cmml" xref="A1.E21.m1.2.2.2.2.1.2"><ci id="A1.E21.m1.2.2.2.2.1.2.1.cmml" xref="A1.E21.m1.2.2.2.2.1.2.1">~</ci><ci id="A1.E21.m1.2.2.2.2.1.2.2.cmml" xref="A1.E21.m1.2.2.2.2.1.2.2">𝑓</ci></apply><ci id="A1.E21.m1.2.2.2.2.1.3.cmml" xref="A1.E21.m1.2.2.2.2.1.3">𝑛</ci></apply></list></apply><apply id="A1.E21.m1.5.5.1.1.1.1.1.1.1.cmml" xref="A1.E21.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E21.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="A1.E21.m1.5.5.1.1.1.1.1.1">subscript</csymbol><apply id="A1.E21.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="A1.E21.m1.5.5.1.1.1.1.1.1.1.2"><ci id="A1.E21.m1.5.5.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E21.m1.5.5.1.1.1.1.1.1.1.2.1">~</ci><ci id="A1.E21.m1.5.5.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E21.m1.5.5.1.1.1.1.1.1.1.2.2">𝒮</ci></apply><ci id="A1.E21.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="A1.E21.m1.5.5.1.1.1.1.1.1.1.3">𝑛</ci></apply></apply><apply id="A1.E21.m1.5.5.1.1.2.2.cmml" xref="A1.E21.m1.5.5.1.1.2.2"><times id="A1.E21.m1.5.5.1.1.2.2.2.cmml" xref="A1.E21.m1.5.5.1.1.2.2.2"></times><apply id="A1.E21.m1.5.5.1.1.2.2.3.cmml" xref="A1.E21.m1.5.5.1.1.2.2.3"><csymbol cd="ambiguous" id="A1.E21.m1.5.5.1.1.2.2.3.1.cmml" xref="A1.E21.m1.5.5.1.1.2.2.3">subscript</csymbol><ci id="A1.E21.m1.5.5.1.1.2.2.3.2.cmml" xref="A1.E21.m1.5.5.1.1.2.2.3.2">ℜ</ci><apply id="A1.E21.m1.5.5.1.1.2.2.3.3.cmml" xref="A1.E21.m1.5.5.1.1.2.2.3.3"><csymbol cd="ambiguous" id="A1.E21.m1.5.5.1.1.2.2.3.3.1.cmml" xref="A1.E21.m1.5.5.1.1.2.2.3.3">subscript</csymbol><apply id="A1.E21.m1.5.5.1.1.2.2.3.3.2.cmml" xref="A1.E21.m1.5.5.1.1.2.2.3.3.2"><ci id="A1.E21.m1.5.5.1.1.2.2.3.3.2.1.cmml" xref="A1.E21.m1.5.5.1.1.2.2.3.3.2.1">~</ci><ci id="A1.E21.m1.5.5.1.1.2.2.3.3.2.2.cmml" xref="A1.E21.m1.5.5.1.1.2.2.3.3.2.2">𝒮</ci></apply><ci id="A1.E21.m1.5.5.1.1.2.2.3.3.3.cmml" xref="A1.E21.m1.5.5.1.1.2.2.3.3.3">𝑛</ci></apply></apply><apply id="A1.E21.m1.5.5.1.1.2.2.1.1.1.cmml" xref="A1.E21.m1.5.5.1.1.2.2.1.1"><csymbol cd="ambiguous" id="A1.E21.m1.5.5.1.1.2.2.1.1.1.1.cmml" xref="A1.E21.m1.5.5.1.1.2.2.1.1">subscript</csymbol><ci id="A1.E21.m1.5.5.1.1.2.2.1.1.1.2.cmml" xref="A1.E21.m1.5.5.1.1.2.2.1.1.1.2">𝒢</ci><list id="A1.E21.m1.4.4.2.3.cmml" xref="A1.E21.m1.4.4.2.4"><ci id="A1.E21.m1.3.3.1.1.cmml" xref="A1.E21.m1.3.3.1.1">ℓ</ci><ci id="A1.E21.m1.4.4.2.2.cmml" xref="A1.E21.m1.4.4.2.2">ℱ</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E21.m1.5c">\displaystyle=R_{\ell,\tilde{f}_{n}}(\tilde{\mathscr{S}}_{n})+{\mathfrak{R}}_{%
\tilde{\mathscr{S}}_{n}}(\mathcal{G}_{\ell,\mathcal{F}}),</annotation><annotation encoding="application/x-llamapun" id="A1.E21.m1.5d">= italic_R start_POSTSUBSCRIPT roman_ℓ , over~ start_ARG italic_f end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( over~ start_ARG script_S end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) + fraktur_R start_POSTSUBSCRIPT over~ start_ARG script_S end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( caligraphic_G start_POSTSUBSCRIPT roman_ℓ , caligraphic_F end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(21)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.p3.4">where inequality <math alttext="(i)" class="ltx_Math" display="inline" id="A1.p3.1.m1.1"><semantics id="A1.p3.1.m1.1a"><mrow id="A1.p3.1.m1.1.2.2"><mo id="A1.p3.1.m1.1.2.2.1" stretchy="false">(</mo><mi id="A1.p3.1.m1.1.1" xref="A1.p3.1.m1.1.1.cmml">i</mi><mo id="A1.p3.1.m1.1.2.2.2" stretchy="false">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.1.m1.1b"><ci id="A1.p3.1.m1.1.1.cmml" xref="A1.p3.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.1.m1.1c">(i)</annotation><annotation encoding="application/x-llamapun" id="A1.p3.1.m1.1d">( italic_i )</annotation></semantics></math> follows from the definition of <math alttext="\mathcal{G}_{\ell,\mathcal{F}}" class="ltx_Math" display="inline" id="A1.p3.2.m2.2"><semantics id="A1.p3.2.m2.2a"><msub id="A1.p3.2.m2.2.3" xref="A1.p3.2.m2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p3.2.m2.2.3.2" xref="A1.p3.2.m2.2.3.2.cmml">𝒢</mi><mrow id="A1.p3.2.m2.2.2.2.4" xref="A1.p3.2.m2.2.2.2.3.cmml"><mi id="A1.p3.2.m2.1.1.1.1" mathvariant="normal" xref="A1.p3.2.m2.1.1.1.1.cmml">ℓ</mi><mo id="A1.p3.2.m2.2.2.2.4.1" xref="A1.p3.2.m2.2.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A1.p3.2.m2.2.2.2.2" xref="A1.p3.2.m2.2.2.2.2.cmml">ℱ</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.p3.2.m2.2b"><apply id="A1.p3.2.m2.2.3.cmml" xref="A1.p3.2.m2.2.3"><csymbol cd="ambiguous" id="A1.p3.2.m2.2.3.1.cmml" xref="A1.p3.2.m2.2.3">subscript</csymbol><ci id="A1.p3.2.m2.2.3.2.cmml" xref="A1.p3.2.m2.2.3.2">𝒢</ci><list id="A1.p3.2.m2.2.2.2.3.cmml" xref="A1.p3.2.m2.2.2.2.4"><ci id="A1.p3.2.m2.1.1.1.1.cmml" xref="A1.p3.2.m2.1.1.1.1">ℓ</ci><ci id="A1.p3.2.m2.2.2.2.2.cmml" xref="A1.p3.2.m2.2.2.2.2">ℱ</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.2.m2.2c">\mathcal{G}_{\ell,\mathcal{F}}</annotation><annotation encoding="application/x-llamapun" id="A1.p3.2.m2.2d">caligraphic_G start_POSTSUBSCRIPT roman_ℓ , caligraphic_F end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="(ii)" class="ltx_Math" display="inline" id="A1.p3.3.m3.1"><semantics id="A1.p3.3.m3.1a"><mrow id="A1.p3.3.m3.1.1.1" xref="A1.p3.3.m3.1.1.1.1.cmml"><mo id="A1.p3.3.m3.1.1.1.2" stretchy="false" xref="A1.p3.3.m3.1.1.1.1.cmml">(</mo><mrow id="A1.p3.3.m3.1.1.1.1" xref="A1.p3.3.m3.1.1.1.1.cmml"><mi id="A1.p3.3.m3.1.1.1.1.2" xref="A1.p3.3.m3.1.1.1.1.2.cmml">i</mi><mo id="A1.p3.3.m3.1.1.1.1.1" xref="A1.p3.3.m3.1.1.1.1.1.cmml">⁢</mo><mi id="A1.p3.3.m3.1.1.1.1.3" xref="A1.p3.3.m3.1.1.1.1.3.cmml">i</mi></mrow><mo id="A1.p3.3.m3.1.1.1.3" stretchy="false" xref="A1.p3.3.m3.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.3.m3.1b"><apply id="A1.p3.3.m3.1.1.1.1.cmml" xref="A1.p3.3.m3.1.1.1"><times id="A1.p3.3.m3.1.1.1.1.1.cmml" xref="A1.p3.3.m3.1.1.1.1.1"></times><ci id="A1.p3.3.m3.1.1.1.1.2.cmml" xref="A1.p3.3.m3.1.1.1.1.2">𝑖</ci><ci id="A1.p3.3.m3.1.1.1.1.3.cmml" xref="A1.p3.3.m3.1.1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.3.m3.1c">(ii)</annotation><annotation encoding="application/x-llamapun" id="A1.p3.3.m3.1d">( italic_i italic_i )</annotation></semantics></math> from the standard symmetrization argument  <cite class="ltx_cite ltx_citemacro_citep">(Devroye et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib5" title="">2013</a>; Mohri et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib23" title="">2018</a>)</cite> for Radamacher complexity. <span class="ltx_text ltx_markedasmath" id="A1.p3.4.1">∎</span></p>
</div>
<div class="ltx_para" id="A1.p4">
<p class="ltx_p" id="A1.p4.1">See <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#S4.Thmtheorem3" title="Theorem 4.3. ‣ 4 Analysis ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">4.3</span></a></p>
</div>
<div class="ltx_proof" id="A1.3">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="A1.1.p1">
<p class="ltx_p" id="A1.1.p1.3">As mentioned in the text <math alttext="\mathcal{F}" class="ltx_Math" display="inline" id="A1.1.p1.1.m1.1"><semantics id="A1.1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="A1.1.p1.1.m1.1.1" xref="A1.1.p1.1.m1.1.1.cmml">ℱ</mi><annotation-xml encoding="MathML-Content" id="A1.1.p1.1.m1.1b"><ci id="A1.1.p1.1.m1.1.1.cmml" xref="A1.1.p1.1.m1.1.1">ℱ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.1.m1.1c">\mathcal{F}</annotation><annotation encoding="application/x-llamapun" id="A1.1.p1.1.m1.1d">caligraphic_F</annotation></semantics></math> might be too large function class and we would like to utilize the restricted function class <math alttext="\mathcal{F}^{g^{\prime}}" class="ltx_Math" display="inline" id="A1.1.p1.2.m2.1"><semantics id="A1.1.p1.2.m2.1a"><msup id="A1.1.p1.2.m2.1.1" xref="A1.1.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.1.p1.2.m2.1.1.2" xref="A1.1.p1.2.m2.1.1.2.cmml">ℱ</mi><msup id="A1.1.p1.2.m2.1.1.3" xref="A1.1.p1.2.m2.1.1.3.cmml"><mi id="A1.1.p1.2.m2.1.1.3.2" xref="A1.1.p1.2.m2.1.1.3.2.cmml">g</mi><mo id="A1.1.p1.2.m2.1.1.3.3" xref="A1.1.p1.2.m2.1.1.3.3.cmml">′</mo></msup></msup><annotation-xml encoding="MathML-Content" id="A1.1.p1.2.m2.1b"><apply id="A1.1.p1.2.m2.1.1.cmml" xref="A1.1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.1.p1.2.m2.1.1.1.cmml" xref="A1.1.p1.2.m2.1.1">superscript</csymbol><ci id="A1.1.p1.2.m2.1.1.2.cmml" xref="A1.1.p1.2.m2.1.1.2">ℱ</ci><apply id="A1.1.p1.2.m2.1.1.3.cmml" xref="A1.1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="A1.1.p1.2.m2.1.1.3.1.cmml" xref="A1.1.p1.2.m2.1.1.3">superscript</csymbol><ci id="A1.1.p1.2.m2.1.1.3.2.cmml" xref="A1.1.p1.2.m2.1.1.3.2">𝑔</ci><ci id="A1.1.p1.2.m2.1.1.3.3.cmml" xref="A1.1.p1.2.m2.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.2.m2.1c">\mathcal{F}^{g^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="A1.1.p1.2.m2.1d">caligraphic_F start_POSTSUPERSCRIPT italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. The previous derivation would go through using this restricted class and we will obtain the Rademacher complexity of <math alttext="{\mathfrak{R}}_{\tilde{\mathscr{S}}_{n}}(\mathcal{G}_{\ell,\mathcal{F}^{g^{%
\prime}}})" class="ltx_Math" display="inline" id="A1.1.p1.3.m3.3"><semantics id="A1.1.p1.3.m3.3a"><mrow id="A1.1.p1.3.m3.3.3" xref="A1.1.p1.3.m3.3.3.cmml"><msub id="A1.1.p1.3.m3.3.3.3" xref="A1.1.p1.3.m3.3.3.3.cmml"><mi id="A1.1.p1.3.m3.3.3.3.2" xref="A1.1.p1.3.m3.3.3.3.2.cmml">ℜ</mi><msub id="A1.1.p1.3.m3.3.3.3.3" xref="A1.1.p1.3.m3.3.3.3.3.cmml"><mover accent="true" id="A1.1.p1.3.m3.3.3.3.3.2" xref="A1.1.p1.3.m3.3.3.3.3.2.cmml"><mi class="ltx_font_mathscript" id="A1.1.p1.3.m3.3.3.3.3.2.2" xref="A1.1.p1.3.m3.3.3.3.3.2.2.cmml">𝒮</mi><mo id="A1.1.p1.3.m3.3.3.3.3.2.1" xref="A1.1.p1.3.m3.3.3.3.3.2.1.cmml">~</mo></mover><mi id="A1.1.p1.3.m3.3.3.3.3.3" xref="A1.1.p1.3.m3.3.3.3.3.3.cmml">n</mi></msub></msub><mo id="A1.1.p1.3.m3.3.3.2" xref="A1.1.p1.3.m3.3.3.2.cmml">⁢</mo><mrow id="A1.1.p1.3.m3.3.3.1.1" xref="A1.1.p1.3.m3.3.3.1.1.1.cmml"><mo id="A1.1.p1.3.m3.3.3.1.1.2" stretchy="false" xref="A1.1.p1.3.m3.3.3.1.1.1.cmml">(</mo><msub id="A1.1.p1.3.m3.3.3.1.1.1" xref="A1.1.p1.3.m3.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.1.p1.3.m3.3.3.1.1.1.2" xref="A1.1.p1.3.m3.3.3.1.1.1.2.cmml">𝒢</mi><mrow id="A1.1.p1.3.m3.2.2.2.2" xref="A1.1.p1.3.m3.2.2.2.3.cmml"><mi id="A1.1.p1.3.m3.1.1.1.1" mathvariant="normal" xref="A1.1.p1.3.m3.1.1.1.1.cmml">ℓ</mi><mo id="A1.1.p1.3.m3.2.2.2.2.2" xref="A1.1.p1.3.m3.2.2.2.3.cmml">,</mo><msup id="A1.1.p1.3.m3.2.2.2.2.1" xref="A1.1.p1.3.m3.2.2.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.1.p1.3.m3.2.2.2.2.1.2" xref="A1.1.p1.3.m3.2.2.2.2.1.2.cmml">ℱ</mi><msup id="A1.1.p1.3.m3.2.2.2.2.1.3" xref="A1.1.p1.3.m3.2.2.2.2.1.3.cmml"><mi id="A1.1.p1.3.m3.2.2.2.2.1.3.2" xref="A1.1.p1.3.m3.2.2.2.2.1.3.2.cmml">g</mi><mo id="A1.1.p1.3.m3.2.2.2.2.1.3.3" xref="A1.1.p1.3.m3.2.2.2.2.1.3.3.cmml">′</mo></msup></msup></mrow></msub><mo id="A1.1.p1.3.m3.3.3.1.1.3" stretchy="false" xref="A1.1.p1.3.m3.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.1.p1.3.m3.3b"><apply id="A1.1.p1.3.m3.3.3.cmml" xref="A1.1.p1.3.m3.3.3"><times id="A1.1.p1.3.m3.3.3.2.cmml" xref="A1.1.p1.3.m3.3.3.2"></times><apply id="A1.1.p1.3.m3.3.3.3.cmml" xref="A1.1.p1.3.m3.3.3.3"><csymbol cd="ambiguous" id="A1.1.p1.3.m3.3.3.3.1.cmml" xref="A1.1.p1.3.m3.3.3.3">subscript</csymbol><ci id="A1.1.p1.3.m3.3.3.3.2.cmml" xref="A1.1.p1.3.m3.3.3.3.2">ℜ</ci><apply id="A1.1.p1.3.m3.3.3.3.3.cmml" xref="A1.1.p1.3.m3.3.3.3.3"><csymbol cd="ambiguous" id="A1.1.p1.3.m3.3.3.3.3.1.cmml" xref="A1.1.p1.3.m3.3.3.3.3">subscript</csymbol><apply id="A1.1.p1.3.m3.3.3.3.3.2.cmml" xref="A1.1.p1.3.m3.3.3.3.3.2"><ci id="A1.1.p1.3.m3.3.3.3.3.2.1.cmml" xref="A1.1.p1.3.m3.3.3.3.3.2.1">~</ci><ci id="A1.1.p1.3.m3.3.3.3.3.2.2.cmml" xref="A1.1.p1.3.m3.3.3.3.3.2.2">𝒮</ci></apply><ci id="A1.1.p1.3.m3.3.3.3.3.3.cmml" xref="A1.1.p1.3.m3.3.3.3.3.3">𝑛</ci></apply></apply><apply id="A1.1.p1.3.m3.3.3.1.1.1.cmml" xref="A1.1.p1.3.m3.3.3.1.1"><csymbol cd="ambiguous" id="A1.1.p1.3.m3.3.3.1.1.1.1.cmml" xref="A1.1.p1.3.m3.3.3.1.1">subscript</csymbol><ci id="A1.1.p1.3.m3.3.3.1.1.1.2.cmml" xref="A1.1.p1.3.m3.3.3.1.1.1.2">𝒢</ci><list id="A1.1.p1.3.m3.2.2.2.3.cmml" xref="A1.1.p1.3.m3.2.2.2.2"><ci id="A1.1.p1.3.m3.1.1.1.1.cmml" xref="A1.1.p1.3.m3.1.1.1.1">ℓ</ci><apply id="A1.1.p1.3.m3.2.2.2.2.1.cmml" xref="A1.1.p1.3.m3.2.2.2.2.1"><csymbol cd="ambiguous" id="A1.1.p1.3.m3.2.2.2.2.1.1.cmml" xref="A1.1.p1.3.m3.2.2.2.2.1">superscript</csymbol><ci id="A1.1.p1.3.m3.2.2.2.2.1.2.cmml" xref="A1.1.p1.3.m3.2.2.2.2.1.2">ℱ</ci><apply id="A1.1.p1.3.m3.2.2.2.2.1.3.cmml" xref="A1.1.p1.3.m3.2.2.2.2.1.3"><csymbol cd="ambiguous" id="A1.1.p1.3.m3.2.2.2.2.1.3.1.cmml" xref="A1.1.p1.3.m3.2.2.2.2.1.3">superscript</csymbol><ci id="A1.1.p1.3.m3.2.2.2.2.1.3.2.cmml" xref="A1.1.p1.3.m3.2.2.2.2.1.3.2">𝑔</ci><ci id="A1.1.p1.3.m3.2.2.2.2.1.3.3.cmml" xref="A1.1.p1.3.m3.2.2.2.2.1.3.3">′</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.3.m3.3c">{\mathfrak{R}}_{\tilde{\mathscr{S}}_{n}}(\mathcal{G}_{\ell,\mathcal{F}^{g^{%
\prime}}})</annotation><annotation encoding="application/x-llamapun" id="A1.1.p1.3.m3.3d">fraktur_R start_POSTSUBSCRIPT over~ start_ARG script_S end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( caligraphic_G start_POSTSUBSCRIPT roman_ℓ , caligraphic_F start_POSTSUPERSCRIPT italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math> instead.
To compare the two Rademacher complexity, observe that</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A2.EGx6">
<tbody id="A1.Ex13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle{\mathfrak{R}}_{\tilde{\mathscr{S}}_{n}}(\mathcal{G}_{\ell,%
\mathcal{F}^{g^{\prime}}})" class="ltx_Math" display="inline" id="A1.Ex13.m1.3"><semantics id="A1.Ex13.m1.3a"><mrow id="A1.Ex13.m1.3.3" xref="A1.Ex13.m1.3.3.cmml"><msub id="A1.Ex13.m1.3.3.3" xref="A1.Ex13.m1.3.3.3.cmml"><mi id="A1.Ex13.m1.3.3.3.2" xref="A1.Ex13.m1.3.3.3.2.cmml">ℜ</mi><msub id="A1.Ex13.m1.3.3.3.3" xref="A1.Ex13.m1.3.3.3.3.cmml"><mover accent="true" id="A1.Ex13.m1.3.3.3.3.2" xref="A1.Ex13.m1.3.3.3.3.2.cmml"><mi class="ltx_font_mathscript" id="A1.Ex13.m1.3.3.3.3.2.2" xref="A1.Ex13.m1.3.3.3.3.2.2.cmml">𝒮</mi><mo id="A1.Ex13.m1.3.3.3.3.2.1" xref="A1.Ex13.m1.3.3.3.3.2.1.cmml">~</mo></mover><mi id="A1.Ex13.m1.3.3.3.3.3" xref="A1.Ex13.m1.3.3.3.3.3.cmml">n</mi></msub></msub><mo id="A1.Ex13.m1.3.3.2" xref="A1.Ex13.m1.3.3.2.cmml">⁢</mo><mrow id="A1.Ex13.m1.3.3.1.1" xref="A1.Ex13.m1.3.3.1.1.1.cmml"><mo id="A1.Ex13.m1.3.3.1.1.2" stretchy="false" xref="A1.Ex13.m1.3.3.1.1.1.cmml">(</mo><msub id="A1.Ex13.m1.3.3.1.1.1" xref="A1.Ex13.m1.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.Ex13.m1.3.3.1.1.1.2" xref="A1.Ex13.m1.3.3.1.1.1.2.cmml">𝒢</mi><mrow id="A1.Ex13.m1.2.2.2.2" xref="A1.Ex13.m1.2.2.2.3.cmml"><mi id="A1.Ex13.m1.1.1.1.1" mathvariant="normal" xref="A1.Ex13.m1.1.1.1.1.cmml">ℓ</mi><mo id="A1.Ex13.m1.2.2.2.2.2" xref="A1.Ex13.m1.2.2.2.3.cmml">,</mo><msup id="A1.Ex13.m1.2.2.2.2.1" xref="A1.Ex13.m1.2.2.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.Ex13.m1.2.2.2.2.1.2" xref="A1.Ex13.m1.2.2.2.2.1.2.cmml">ℱ</mi><msup id="A1.Ex13.m1.2.2.2.2.1.3" xref="A1.Ex13.m1.2.2.2.2.1.3.cmml"><mi id="A1.Ex13.m1.2.2.2.2.1.3.2" xref="A1.Ex13.m1.2.2.2.2.1.3.2.cmml">g</mi><mo id="A1.Ex13.m1.2.2.2.2.1.3.3" xref="A1.Ex13.m1.2.2.2.2.1.3.3.cmml">′</mo></msup></msup></mrow></msub><mo id="A1.Ex13.m1.3.3.1.1.3" stretchy="false" xref="A1.Ex13.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex13.m1.3b"><apply id="A1.Ex13.m1.3.3.cmml" xref="A1.Ex13.m1.3.3"><times id="A1.Ex13.m1.3.3.2.cmml" xref="A1.Ex13.m1.3.3.2"></times><apply id="A1.Ex13.m1.3.3.3.cmml" xref="A1.Ex13.m1.3.3.3"><csymbol cd="ambiguous" id="A1.Ex13.m1.3.3.3.1.cmml" xref="A1.Ex13.m1.3.3.3">subscript</csymbol><ci id="A1.Ex13.m1.3.3.3.2.cmml" xref="A1.Ex13.m1.3.3.3.2">ℜ</ci><apply id="A1.Ex13.m1.3.3.3.3.cmml" xref="A1.Ex13.m1.3.3.3.3"><csymbol cd="ambiguous" id="A1.Ex13.m1.3.3.3.3.1.cmml" xref="A1.Ex13.m1.3.3.3.3">subscript</csymbol><apply id="A1.Ex13.m1.3.3.3.3.2.cmml" xref="A1.Ex13.m1.3.3.3.3.2"><ci id="A1.Ex13.m1.3.3.3.3.2.1.cmml" xref="A1.Ex13.m1.3.3.3.3.2.1">~</ci><ci id="A1.Ex13.m1.3.3.3.3.2.2.cmml" xref="A1.Ex13.m1.3.3.3.3.2.2">𝒮</ci></apply><ci id="A1.Ex13.m1.3.3.3.3.3.cmml" xref="A1.Ex13.m1.3.3.3.3.3">𝑛</ci></apply></apply><apply id="A1.Ex13.m1.3.3.1.1.1.cmml" xref="A1.Ex13.m1.3.3.1.1"><csymbol cd="ambiguous" id="A1.Ex13.m1.3.3.1.1.1.1.cmml" xref="A1.Ex13.m1.3.3.1.1">subscript</csymbol><ci id="A1.Ex13.m1.3.3.1.1.1.2.cmml" xref="A1.Ex13.m1.3.3.1.1.1.2">𝒢</ci><list id="A1.Ex13.m1.2.2.2.3.cmml" xref="A1.Ex13.m1.2.2.2.2"><ci id="A1.Ex13.m1.1.1.1.1.cmml" xref="A1.Ex13.m1.1.1.1.1">ℓ</ci><apply id="A1.Ex13.m1.2.2.2.2.1.cmml" xref="A1.Ex13.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="A1.Ex13.m1.2.2.2.2.1.1.cmml" xref="A1.Ex13.m1.2.2.2.2.1">superscript</csymbol><ci id="A1.Ex13.m1.2.2.2.2.1.2.cmml" xref="A1.Ex13.m1.2.2.2.2.1.2">ℱ</ci><apply id="A1.Ex13.m1.2.2.2.2.1.3.cmml" xref="A1.Ex13.m1.2.2.2.2.1.3"><csymbol cd="ambiguous" id="A1.Ex13.m1.2.2.2.2.1.3.1.cmml" xref="A1.Ex13.m1.2.2.2.2.1.3">superscript</csymbol><ci id="A1.Ex13.m1.2.2.2.2.1.3.2.cmml" xref="A1.Ex13.m1.2.2.2.2.1.3.2">𝑔</ci><ci id="A1.Ex13.m1.2.2.2.2.1.3.3.cmml" xref="A1.Ex13.m1.2.2.2.2.1.3.3">′</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex13.m1.3c">\displaystyle{\mathfrak{R}}_{\tilde{\mathscr{S}}_{n}}(\mathcal{G}_{\ell,%
\mathcal{F}^{g^{\prime}}})</annotation><annotation encoding="application/x-llamapun" id="A1.Ex13.m1.3d">fraktur_R start_POSTSUBSCRIPT over~ start_ARG script_S end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( caligraphic_G start_POSTSUBSCRIPT roman_ℓ , caligraphic_F start_POSTSUPERSCRIPT italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{n}\mathbb{E}_{\bm{\sigma}}\left|\sup_{\lambda\in%
\mathcal{G}_{\ell,\mathcal{F}^{g^{\prime}}}}\sum_{i}\sigma_{i}\lambda(y_{i})\right|" class="ltx_Math" display="inline" id="A1.Ex13.m2.3"><semantics id="A1.Ex13.m2.3a"><mrow id="A1.Ex13.m2.3.3" xref="A1.Ex13.m2.3.3.cmml"><mi id="A1.Ex13.m2.3.3.3" xref="A1.Ex13.m2.3.3.3.cmml"></mi><mo id="A1.Ex13.m2.3.3.2" xref="A1.Ex13.m2.3.3.2.cmml">=</mo><mrow id="A1.Ex13.m2.3.3.1" xref="A1.Ex13.m2.3.3.1.cmml"><mstyle displaystyle="true" id="A1.Ex13.m2.3.3.1.3" xref="A1.Ex13.m2.3.3.1.3.cmml"><mfrac id="A1.Ex13.m2.3.3.1.3a" xref="A1.Ex13.m2.3.3.1.3.cmml"><mn id="A1.Ex13.m2.3.3.1.3.2" xref="A1.Ex13.m2.3.3.1.3.2.cmml">1</mn><mi id="A1.Ex13.m2.3.3.1.3.3" xref="A1.Ex13.m2.3.3.1.3.3.cmml">n</mi></mfrac></mstyle><mo id="A1.Ex13.m2.3.3.1.2" xref="A1.Ex13.m2.3.3.1.2.cmml">⁢</mo><msub id="A1.Ex13.m2.3.3.1.4" xref="A1.Ex13.m2.3.3.1.4.cmml"><mi id="A1.Ex13.m2.3.3.1.4.2" xref="A1.Ex13.m2.3.3.1.4.2.cmml">𝔼</mi><mi id="A1.Ex13.m2.3.3.1.4.3" xref="A1.Ex13.m2.3.3.1.4.3.cmml">𝝈</mi></msub><mo id="A1.Ex13.m2.3.3.1.2a" xref="A1.Ex13.m2.3.3.1.2.cmml">⁢</mo><mrow id="A1.Ex13.m2.3.3.1.1.1" xref="A1.Ex13.m2.3.3.1.1.2.cmml"><mo id="A1.Ex13.m2.3.3.1.1.1.2" xref="A1.Ex13.m2.3.3.1.1.2.1.cmml">|</mo><mrow id="A1.Ex13.m2.3.3.1.1.1.1" xref="A1.Ex13.m2.3.3.1.1.1.1.cmml"><munder id="A1.Ex13.m2.3.3.1.1.1.1.2" xref="A1.Ex13.m2.3.3.1.1.1.1.2.cmml"><mo id="A1.Ex13.m2.3.3.1.1.1.1.2.2" lspace="0em" movablelimits="false" rspace="0.167em" xref="A1.Ex13.m2.3.3.1.1.1.1.2.2.cmml">sup</mo><mrow id="A1.Ex13.m2.2.2.2" xref="A1.Ex13.m2.2.2.2.cmml"><mi id="A1.Ex13.m2.2.2.2.4" xref="A1.Ex13.m2.2.2.2.4.cmml">λ</mi><mo id="A1.Ex13.m2.2.2.2.3" xref="A1.Ex13.m2.2.2.2.3.cmml">∈</mo><msub id="A1.Ex13.m2.2.2.2.5" xref="A1.Ex13.m2.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.Ex13.m2.2.2.2.5.2" xref="A1.Ex13.m2.2.2.2.5.2.cmml">𝒢</mi><mrow id="A1.Ex13.m2.2.2.2.2.2.2" xref="A1.Ex13.m2.2.2.2.2.2.3.cmml"><mi id="A1.Ex13.m2.1.1.1.1.1.1" mathvariant="normal" xref="A1.Ex13.m2.1.1.1.1.1.1.cmml">ℓ</mi><mo id="A1.Ex13.m2.2.2.2.2.2.2.2" xref="A1.Ex13.m2.2.2.2.2.2.3.cmml">,</mo><msup id="A1.Ex13.m2.2.2.2.2.2.2.1" xref="A1.Ex13.m2.2.2.2.2.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.Ex13.m2.2.2.2.2.2.2.1.2" xref="A1.Ex13.m2.2.2.2.2.2.2.1.2.cmml">ℱ</mi><msup id="A1.Ex13.m2.2.2.2.2.2.2.1.3" xref="A1.Ex13.m2.2.2.2.2.2.2.1.3.cmml"><mi id="A1.Ex13.m2.2.2.2.2.2.2.1.3.2" xref="A1.Ex13.m2.2.2.2.2.2.2.1.3.2.cmml">g</mi><mo id="A1.Ex13.m2.2.2.2.2.2.2.1.3.3" xref="A1.Ex13.m2.2.2.2.2.2.2.1.3.3.cmml">′</mo></msup></msup></mrow></msub></mrow></munder><mrow id="A1.Ex13.m2.3.3.1.1.1.1.1" xref="A1.Ex13.m2.3.3.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A1.Ex13.m2.3.3.1.1.1.1.1.2" xref="A1.Ex13.m2.3.3.1.1.1.1.1.2.cmml"><munder id="A1.Ex13.m2.3.3.1.1.1.1.1.2a" xref="A1.Ex13.m2.3.3.1.1.1.1.1.2.cmml"><mo id="A1.Ex13.m2.3.3.1.1.1.1.1.2.2" movablelimits="false" xref="A1.Ex13.m2.3.3.1.1.1.1.1.2.2.cmml">∑</mo><mi id="A1.Ex13.m2.3.3.1.1.1.1.1.2.3" xref="A1.Ex13.m2.3.3.1.1.1.1.1.2.3.cmml">i</mi></munder></mstyle><mrow id="A1.Ex13.m2.3.3.1.1.1.1.1.1" xref="A1.Ex13.m2.3.3.1.1.1.1.1.1.cmml"><msub id="A1.Ex13.m2.3.3.1.1.1.1.1.1.3" xref="A1.Ex13.m2.3.3.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex13.m2.3.3.1.1.1.1.1.1.3.2" xref="A1.Ex13.m2.3.3.1.1.1.1.1.1.3.2.cmml">σ</mi><mi id="A1.Ex13.m2.3.3.1.1.1.1.1.1.3.3" xref="A1.Ex13.m2.3.3.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="A1.Ex13.m2.3.3.1.1.1.1.1.1.2" xref="A1.Ex13.m2.3.3.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.Ex13.m2.3.3.1.1.1.1.1.1.4" xref="A1.Ex13.m2.3.3.1.1.1.1.1.1.4.cmml">λ</mi><mo id="A1.Ex13.m2.3.3.1.1.1.1.1.1.2a" xref="A1.Ex13.m2.3.3.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex13.m2.3.3.1.1.1.1.1.1.1.1" xref="A1.Ex13.m2.3.3.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex13.m2.3.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex13.m2.3.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.Ex13.m2.3.3.1.1.1.1.1.1.1.1.1" xref="A1.Ex13.m2.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex13.m2.3.3.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex13.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="A1.Ex13.m2.3.3.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex13.m2.3.3.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.Ex13.m2.3.3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex13.m2.3.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.Ex13.m2.3.3.1.1.1.3" xref="A1.Ex13.m2.3.3.1.1.2.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex13.m2.3b"><apply id="A1.Ex13.m2.3.3.cmml" xref="A1.Ex13.m2.3.3"><eq id="A1.Ex13.m2.3.3.2.cmml" xref="A1.Ex13.m2.3.3.2"></eq><csymbol cd="latexml" id="A1.Ex13.m2.3.3.3.cmml" xref="A1.Ex13.m2.3.3.3">absent</csymbol><apply id="A1.Ex13.m2.3.3.1.cmml" xref="A1.Ex13.m2.3.3.1"><times id="A1.Ex13.m2.3.3.1.2.cmml" xref="A1.Ex13.m2.3.3.1.2"></times><apply id="A1.Ex13.m2.3.3.1.3.cmml" xref="A1.Ex13.m2.3.3.1.3"><divide id="A1.Ex13.m2.3.3.1.3.1.cmml" xref="A1.Ex13.m2.3.3.1.3"></divide><cn id="A1.Ex13.m2.3.3.1.3.2.cmml" type="integer" xref="A1.Ex13.m2.3.3.1.3.2">1</cn><ci id="A1.Ex13.m2.3.3.1.3.3.cmml" xref="A1.Ex13.m2.3.3.1.3.3">𝑛</ci></apply><apply id="A1.Ex13.m2.3.3.1.4.cmml" xref="A1.Ex13.m2.3.3.1.4"><csymbol cd="ambiguous" id="A1.Ex13.m2.3.3.1.4.1.cmml" xref="A1.Ex13.m2.3.3.1.4">subscript</csymbol><ci id="A1.Ex13.m2.3.3.1.4.2.cmml" xref="A1.Ex13.m2.3.3.1.4.2">𝔼</ci><ci id="A1.Ex13.m2.3.3.1.4.3.cmml" xref="A1.Ex13.m2.3.3.1.4.3">𝝈</ci></apply><apply id="A1.Ex13.m2.3.3.1.1.2.cmml" xref="A1.Ex13.m2.3.3.1.1.1"><abs id="A1.Ex13.m2.3.3.1.1.2.1.cmml" xref="A1.Ex13.m2.3.3.1.1.1.2"></abs><apply id="A1.Ex13.m2.3.3.1.1.1.1.cmml" xref="A1.Ex13.m2.3.3.1.1.1.1"><apply id="A1.Ex13.m2.3.3.1.1.1.1.2.cmml" xref="A1.Ex13.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex13.m2.3.3.1.1.1.1.2.1.cmml" xref="A1.Ex13.m2.3.3.1.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="A1.Ex13.m2.3.3.1.1.1.1.2.2.cmml" xref="A1.Ex13.m2.3.3.1.1.1.1.2.2">supremum</csymbol><apply id="A1.Ex13.m2.2.2.2.cmml" xref="A1.Ex13.m2.2.2.2"><in id="A1.Ex13.m2.2.2.2.3.cmml" xref="A1.Ex13.m2.2.2.2.3"></in><ci id="A1.Ex13.m2.2.2.2.4.cmml" xref="A1.Ex13.m2.2.2.2.4">𝜆</ci><apply id="A1.Ex13.m2.2.2.2.5.cmml" xref="A1.Ex13.m2.2.2.2.5"><csymbol cd="ambiguous" id="A1.Ex13.m2.2.2.2.5.1.cmml" xref="A1.Ex13.m2.2.2.2.5">subscript</csymbol><ci id="A1.Ex13.m2.2.2.2.5.2.cmml" xref="A1.Ex13.m2.2.2.2.5.2">𝒢</ci><list id="A1.Ex13.m2.2.2.2.2.2.3.cmml" xref="A1.Ex13.m2.2.2.2.2.2.2"><ci id="A1.Ex13.m2.1.1.1.1.1.1.cmml" xref="A1.Ex13.m2.1.1.1.1.1.1">ℓ</ci><apply id="A1.Ex13.m2.2.2.2.2.2.2.1.cmml" xref="A1.Ex13.m2.2.2.2.2.2.2.1"><csymbol cd="ambiguous" id="A1.Ex13.m2.2.2.2.2.2.2.1.1.cmml" xref="A1.Ex13.m2.2.2.2.2.2.2.1">superscript</csymbol><ci id="A1.Ex13.m2.2.2.2.2.2.2.1.2.cmml" xref="A1.Ex13.m2.2.2.2.2.2.2.1.2">ℱ</ci><apply id="A1.Ex13.m2.2.2.2.2.2.2.1.3.cmml" xref="A1.Ex13.m2.2.2.2.2.2.2.1.3"><csymbol cd="ambiguous" id="A1.Ex13.m2.2.2.2.2.2.2.1.3.1.cmml" xref="A1.Ex13.m2.2.2.2.2.2.2.1.3">superscript</csymbol><ci id="A1.Ex13.m2.2.2.2.2.2.2.1.3.2.cmml" xref="A1.Ex13.m2.2.2.2.2.2.2.1.3.2">𝑔</ci><ci id="A1.Ex13.m2.2.2.2.2.2.2.1.3.3.cmml" xref="A1.Ex13.m2.2.2.2.2.2.2.1.3.3">′</ci></apply></apply></list></apply></apply></apply><apply id="A1.Ex13.m2.3.3.1.1.1.1.1.cmml" xref="A1.Ex13.m2.3.3.1.1.1.1.1"><apply id="A1.Ex13.m2.3.3.1.1.1.1.1.2.cmml" xref="A1.Ex13.m2.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex13.m2.3.3.1.1.1.1.1.2.1.cmml" xref="A1.Ex13.m2.3.3.1.1.1.1.1.2">subscript</csymbol><sum id="A1.Ex13.m2.3.3.1.1.1.1.1.2.2.cmml" xref="A1.Ex13.m2.3.3.1.1.1.1.1.2.2"></sum><ci id="A1.Ex13.m2.3.3.1.1.1.1.1.2.3.cmml" xref="A1.Ex13.m2.3.3.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="A1.Ex13.m2.3.3.1.1.1.1.1.1.cmml" xref="A1.Ex13.m2.3.3.1.1.1.1.1.1"><times id="A1.Ex13.m2.3.3.1.1.1.1.1.1.2.cmml" xref="A1.Ex13.m2.3.3.1.1.1.1.1.1.2"></times><apply id="A1.Ex13.m2.3.3.1.1.1.1.1.1.3.cmml" xref="A1.Ex13.m2.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex13.m2.3.3.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex13.m2.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex13.m2.3.3.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex13.m2.3.3.1.1.1.1.1.1.3.2">𝜎</ci><ci id="A1.Ex13.m2.3.3.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex13.m2.3.3.1.1.1.1.1.1.3.3">𝑖</ci></apply><ci id="A1.Ex13.m2.3.3.1.1.1.1.1.1.4.cmml" xref="A1.Ex13.m2.3.3.1.1.1.1.1.1.4">𝜆</ci><apply id="A1.Ex13.m2.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex13.m2.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex13.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex13.m2.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex13.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex13.m2.3.3.1.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="A1.Ex13.m2.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex13.m2.3.3.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex13.m2.3c">\displaystyle=\frac{1}{n}\mathbb{E}_{\bm{\sigma}}\left|\sup_{\lambda\in%
\mathcal{G}_{\ell,\mathcal{F}^{g^{\prime}}}}\sum_{i}\sigma_{i}\lambda(y_{i})\right|</annotation><annotation encoding="application/x-llamapun" id="A1.Ex13.m2.3d">= divide start_ARG 1 end_ARG start_ARG italic_n end_ARG blackboard_E start_POSTSUBSCRIPT bold_italic_σ end_POSTSUBSCRIPT | roman_sup start_POSTSUBSCRIPT italic_λ ∈ caligraphic_G start_POSTSUBSCRIPT roman_ℓ , caligraphic_F start_POSTSUPERSCRIPT italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_λ ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\overset{(i)}{=}\frac{1}{n}\mathbb{E}_{\bm{\sigma}}\left|\sup_{h%
\in\mathcal{H}}\sum_{i}\sigma_{i}\ell(h\circ g^{\prime}(y),g(y))\right|" class="ltx_Math" display="inline" id="A1.Ex14.m1.4"><semantics id="A1.Ex14.m1.4a"><mrow id="A1.Ex14.m1.4.4" xref="A1.Ex14.m1.4.4.cmml"><mover accent="true" id="A1.Ex14.m1.1.1" xref="A1.Ex14.m1.1.1.cmml"><mo id="A1.Ex14.m1.1.1.2" xref="A1.Ex14.m1.1.1.2.cmml">=</mo><mrow id="A1.Ex14.m1.1.1.1.3" xref="A1.Ex14.m1.1.1.cmml"><mo id="A1.Ex14.m1.1.1.1.3.1" stretchy="false" xref="A1.Ex14.m1.1.1.cmml">(</mo><mi id="A1.Ex14.m1.1.1.1.1" xref="A1.Ex14.m1.1.1.1.1.cmml">i</mi><mo id="A1.Ex14.m1.1.1.1.3.2" stretchy="false" xref="A1.Ex14.m1.1.1.cmml">)</mo></mrow></mover><mo id="A1.Ex14.m1.4.4.2" xref="A1.Ex14.m1.4.4.2.cmml">⁢</mo><mstyle displaystyle="true" id="A1.Ex14.m1.4.4.3" xref="A1.Ex14.m1.4.4.3.cmml"><mfrac id="A1.Ex14.m1.4.4.3a" xref="A1.Ex14.m1.4.4.3.cmml"><mn id="A1.Ex14.m1.4.4.3.2" xref="A1.Ex14.m1.4.4.3.2.cmml">1</mn><mi id="A1.Ex14.m1.4.4.3.3" xref="A1.Ex14.m1.4.4.3.3.cmml">n</mi></mfrac></mstyle><mo id="A1.Ex14.m1.4.4.2a" xref="A1.Ex14.m1.4.4.2.cmml">⁢</mo><msub id="A1.Ex14.m1.4.4.4" xref="A1.Ex14.m1.4.4.4.cmml"><mi id="A1.Ex14.m1.4.4.4.2" xref="A1.Ex14.m1.4.4.4.2.cmml">𝔼</mi><mi id="A1.Ex14.m1.4.4.4.3" xref="A1.Ex14.m1.4.4.4.3.cmml">𝝈</mi></msub><mo id="A1.Ex14.m1.4.4.2b" xref="A1.Ex14.m1.4.4.2.cmml">⁢</mo><mrow id="A1.Ex14.m1.4.4.1.1" xref="A1.Ex14.m1.4.4.1.2.cmml"><mo id="A1.Ex14.m1.4.4.1.1.2" xref="A1.Ex14.m1.4.4.1.2.1.cmml">|</mo><mrow id="A1.Ex14.m1.4.4.1.1.1" xref="A1.Ex14.m1.4.4.1.1.1.cmml"><munder id="A1.Ex14.m1.4.4.1.1.1.3" xref="A1.Ex14.m1.4.4.1.1.1.3.cmml"><mo id="A1.Ex14.m1.4.4.1.1.1.3.2" lspace="0em" movablelimits="false" rspace="0.167em" xref="A1.Ex14.m1.4.4.1.1.1.3.2.cmml">sup</mo><mrow id="A1.Ex14.m1.4.4.1.1.1.3.3" xref="A1.Ex14.m1.4.4.1.1.1.3.3.cmml"><mi id="A1.Ex14.m1.4.4.1.1.1.3.3.2" xref="A1.Ex14.m1.4.4.1.1.1.3.3.2.cmml">h</mi><mo id="A1.Ex14.m1.4.4.1.1.1.3.3.1" xref="A1.Ex14.m1.4.4.1.1.1.3.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A1.Ex14.m1.4.4.1.1.1.3.3.3" xref="A1.Ex14.m1.4.4.1.1.1.3.3.3.cmml">ℋ</mi></mrow></munder><mrow id="A1.Ex14.m1.4.4.1.1.1.2" xref="A1.Ex14.m1.4.4.1.1.1.2.cmml"><mstyle displaystyle="true" id="A1.Ex14.m1.4.4.1.1.1.2.3" xref="A1.Ex14.m1.4.4.1.1.1.2.3.cmml"><munder id="A1.Ex14.m1.4.4.1.1.1.2.3a" xref="A1.Ex14.m1.4.4.1.1.1.2.3.cmml"><mo id="A1.Ex14.m1.4.4.1.1.1.2.3.2" movablelimits="false" xref="A1.Ex14.m1.4.4.1.1.1.2.3.2.cmml">∑</mo><mi id="A1.Ex14.m1.4.4.1.1.1.2.3.3" xref="A1.Ex14.m1.4.4.1.1.1.2.3.3.cmml">i</mi></munder></mstyle><mrow id="A1.Ex14.m1.4.4.1.1.1.2.2" xref="A1.Ex14.m1.4.4.1.1.1.2.2.cmml"><msub id="A1.Ex14.m1.4.4.1.1.1.2.2.4" xref="A1.Ex14.m1.4.4.1.1.1.2.2.4.cmml"><mi id="A1.Ex14.m1.4.4.1.1.1.2.2.4.2" xref="A1.Ex14.m1.4.4.1.1.1.2.2.4.2.cmml">σ</mi><mi id="A1.Ex14.m1.4.4.1.1.1.2.2.4.3" xref="A1.Ex14.m1.4.4.1.1.1.2.2.4.3.cmml">i</mi></msub><mo id="A1.Ex14.m1.4.4.1.1.1.2.2.3" xref="A1.Ex14.m1.4.4.1.1.1.2.2.3.cmml">⁢</mo><mi id="A1.Ex14.m1.4.4.1.1.1.2.2.5" mathvariant="normal" xref="A1.Ex14.m1.4.4.1.1.1.2.2.5.cmml">ℓ</mi><mo id="A1.Ex14.m1.4.4.1.1.1.2.2.3a" xref="A1.Ex14.m1.4.4.1.1.1.2.2.3.cmml">⁢</mo><mrow id="A1.Ex14.m1.4.4.1.1.1.2.2.2.2" xref="A1.Ex14.m1.4.4.1.1.1.2.2.2.3.cmml"><mo id="A1.Ex14.m1.4.4.1.1.1.2.2.2.2.3" stretchy="false" xref="A1.Ex14.m1.4.4.1.1.1.2.2.2.3.cmml">(</mo><mrow id="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1" xref="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2" xref="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2.2" xref="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml">h</mi><mo id="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml">∘</mo><msup id="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2.3" xref="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2.3.2" xref="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2.3.2.cmml">g</mi><mo id="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2.3.3" xref="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2.3.3.cmml">′</mo></msup></mrow><mo id="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.1" xref="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex14.m1.2.2" xref="A1.Ex14.m1.2.2.cmml">y</mi><mo id="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex14.m1.4.4.1.1.1.2.2.2.2.4" xref="A1.Ex14.m1.4.4.1.1.1.2.2.2.3.cmml">,</mo><mrow id="A1.Ex14.m1.4.4.1.1.1.2.2.2.2.2" xref="A1.Ex14.m1.4.4.1.1.1.2.2.2.2.2.cmml"><mi id="A1.Ex14.m1.4.4.1.1.1.2.2.2.2.2.2" xref="A1.Ex14.m1.4.4.1.1.1.2.2.2.2.2.2.cmml">g</mi><mo id="A1.Ex14.m1.4.4.1.1.1.2.2.2.2.2.1" xref="A1.Ex14.m1.4.4.1.1.1.2.2.2.2.2.1.cmml">⁢</mo><mrow id="A1.Ex14.m1.4.4.1.1.1.2.2.2.2.2.3.2" xref="A1.Ex14.m1.4.4.1.1.1.2.2.2.2.2.cmml"><mo id="A1.Ex14.m1.4.4.1.1.1.2.2.2.2.2.3.2.1" stretchy="false" xref="A1.Ex14.m1.4.4.1.1.1.2.2.2.2.2.cmml">(</mo><mi id="A1.Ex14.m1.3.3" xref="A1.Ex14.m1.3.3.cmml">y</mi><mo id="A1.Ex14.m1.4.4.1.1.1.2.2.2.2.2.3.2.2" stretchy="false" xref="A1.Ex14.m1.4.4.1.1.1.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex14.m1.4.4.1.1.1.2.2.2.2.5" stretchy="false" xref="A1.Ex14.m1.4.4.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.Ex14.m1.4.4.1.1.3" xref="A1.Ex14.m1.4.4.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex14.m1.4b"><apply id="A1.Ex14.m1.4.4.cmml" xref="A1.Ex14.m1.4.4"><times id="A1.Ex14.m1.4.4.2.cmml" xref="A1.Ex14.m1.4.4.2"></times><apply id="A1.Ex14.m1.1.1.cmml" xref="A1.Ex14.m1.1.1"><ci id="A1.Ex14.m1.1.1.1.1.cmml" xref="A1.Ex14.m1.1.1.1.1">𝑖</ci><eq id="A1.Ex14.m1.1.1.2.cmml" xref="A1.Ex14.m1.1.1.2"></eq></apply><apply id="A1.Ex14.m1.4.4.3.cmml" xref="A1.Ex14.m1.4.4.3"><divide id="A1.Ex14.m1.4.4.3.1.cmml" xref="A1.Ex14.m1.4.4.3"></divide><cn id="A1.Ex14.m1.4.4.3.2.cmml" type="integer" xref="A1.Ex14.m1.4.4.3.2">1</cn><ci id="A1.Ex14.m1.4.4.3.3.cmml" xref="A1.Ex14.m1.4.4.3.3">𝑛</ci></apply><apply id="A1.Ex14.m1.4.4.4.cmml" xref="A1.Ex14.m1.4.4.4"><csymbol cd="ambiguous" id="A1.Ex14.m1.4.4.4.1.cmml" xref="A1.Ex14.m1.4.4.4">subscript</csymbol><ci id="A1.Ex14.m1.4.4.4.2.cmml" xref="A1.Ex14.m1.4.4.4.2">𝔼</ci><ci id="A1.Ex14.m1.4.4.4.3.cmml" xref="A1.Ex14.m1.4.4.4.3">𝝈</ci></apply><apply id="A1.Ex14.m1.4.4.1.2.cmml" xref="A1.Ex14.m1.4.4.1.1"><abs id="A1.Ex14.m1.4.4.1.2.1.cmml" xref="A1.Ex14.m1.4.4.1.1.2"></abs><apply id="A1.Ex14.m1.4.4.1.1.1.cmml" xref="A1.Ex14.m1.4.4.1.1.1"><apply id="A1.Ex14.m1.4.4.1.1.1.3.cmml" xref="A1.Ex14.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex14.m1.4.4.1.1.1.3.1.cmml" xref="A1.Ex14.m1.4.4.1.1.1.3">subscript</csymbol><csymbol cd="latexml" id="A1.Ex14.m1.4.4.1.1.1.3.2.cmml" xref="A1.Ex14.m1.4.4.1.1.1.3.2">supremum</csymbol><apply id="A1.Ex14.m1.4.4.1.1.1.3.3.cmml" xref="A1.Ex14.m1.4.4.1.1.1.3.3"><in id="A1.Ex14.m1.4.4.1.1.1.3.3.1.cmml" xref="A1.Ex14.m1.4.4.1.1.1.3.3.1"></in><ci id="A1.Ex14.m1.4.4.1.1.1.3.3.2.cmml" xref="A1.Ex14.m1.4.4.1.1.1.3.3.2">ℎ</ci><ci id="A1.Ex14.m1.4.4.1.1.1.3.3.3.cmml" xref="A1.Ex14.m1.4.4.1.1.1.3.3.3">ℋ</ci></apply></apply><apply id="A1.Ex14.m1.4.4.1.1.1.2.cmml" xref="A1.Ex14.m1.4.4.1.1.1.2"><apply id="A1.Ex14.m1.4.4.1.1.1.2.3.cmml" xref="A1.Ex14.m1.4.4.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.Ex14.m1.4.4.1.1.1.2.3.1.cmml" xref="A1.Ex14.m1.4.4.1.1.1.2.3">subscript</csymbol><sum id="A1.Ex14.m1.4.4.1.1.1.2.3.2.cmml" xref="A1.Ex14.m1.4.4.1.1.1.2.3.2"></sum><ci id="A1.Ex14.m1.4.4.1.1.1.2.3.3.cmml" xref="A1.Ex14.m1.4.4.1.1.1.2.3.3">𝑖</ci></apply><apply id="A1.Ex14.m1.4.4.1.1.1.2.2.cmml" xref="A1.Ex14.m1.4.4.1.1.1.2.2"><times id="A1.Ex14.m1.4.4.1.1.1.2.2.3.cmml" xref="A1.Ex14.m1.4.4.1.1.1.2.2.3"></times><apply id="A1.Ex14.m1.4.4.1.1.1.2.2.4.cmml" xref="A1.Ex14.m1.4.4.1.1.1.2.2.4"><csymbol cd="ambiguous" id="A1.Ex14.m1.4.4.1.1.1.2.2.4.1.cmml" xref="A1.Ex14.m1.4.4.1.1.1.2.2.4">subscript</csymbol><ci id="A1.Ex14.m1.4.4.1.1.1.2.2.4.2.cmml" xref="A1.Ex14.m1.4.4.1.1.1.2.2.4.2">𝜎</ci><ci id="A1.Ex14.m1.4.4.1.1.1.2.2.4.3.cmml" xref="A1.Ex14.m1.4.4.1.1.1.2.2.4.3">𝑖</ci></apply><ci id="A1.Ex14.m1.4.4.1.1.1.2.2.5.cmml" xref="A1.Ex14.m1.4.4.1.1.1.2.2.5">ℓ</ci><interval closure="open" id="A1.Ex14.m1.4.4.1.1.1.2.2.2.3.cmml" xref="A1.Ex14.m1.4.4.1.1.1.2.2.2.2"><apply id="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1"><times id="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.1"></times><apply id="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2"><compose id="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2.1"></compose><ci id="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2.2">ℎ</ci><apply id="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2.3.2">𝑔</ci><ci id="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A1.Ex14.m1.4.4.1.1.1.1.1.1.1.1.2.3.3">′</ci></apply></apply><ci id="A1.Ex14.m1.2.2.cmml" xref="A1.Ex14.m1.2.2">𝑦</ci></apply><apply id="A1.Ex14.m1.4.4.1.1.1.2.2.2.2.2.cmml" xref="A1.Ex14.m1.4.4.1.1.1.2.2.2.2.2"><times id="A1.Ex14.m1.4.4.1.1.1.2.2.2.2.2.1.cmml" xref="A1.Ex14.m1.4.4.1.1.1.2.2.2.2.2.1"></times><ci id="A1.Ex14.m1.4.4.1.1.1.2.2.2.2.2.2.cmml" xref="A1.Ex14.m1.4.4.1.1.1.2.2.2.2.2.2">𝑔</ci><ci id="A1.Ex14.m1.3.3.cmml" xref="A1.Ex14.m1.3.3">𝑦</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex14.m1.4c">\displaystyle\overset{(i)}{=}\frac{1}{n}\mathbb{E}_{\bm{\sigma}}\left|\sup_{h%
\in\mathcal{H}}\sum_{i}\sigma_{i}\ell(h\circ g^{\prime}(y),g(y))\right|</annotation><annotation encoding="application/x-llamapun" id="A1.Ex14.m1.4d">start_OVERACCENT ( italic_i ) end_OVERACCENT start_ARG = end_ARG divide start_ARG 1 end_ARG start_ARG italic_n end_ARG blackboard_E start_POSTSUBSCRIPT bold_italic_σ end_POSTSUBSCRIPT | roman_sup start_POSTSUBSCRIPT italic_h ∈ caligraphic_H end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_ℓ ( italic_h ∘ italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y ) , italic_g ( italic_y ) ) |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{n}\mathbb{E}_{\bm{\sigma}}\left|\sup_{f\in\mathcal{F}^{%
g^{\prime}}}\sum_{i}\sigma_{i}\ell(f(y),g(y))\right|" class="ltx_Math" display="inline" id="A1.Ex15.m1.3"><semantics id="A1.Ex15.m1.3a"><mrow id="A1.Ex15.m1.3.3" xref="A1.Ex15.m1.3.3.cmml"><mi id="A1.Ex15.m1.3.3.3" xref="A1.Ex15.m1.3.3.3.cmml"></mi><mo id="A1.Ex15.m1.3.3.2" xref="A1.Ex15.m1.3.3.2.cmml">=</mo><mrow id="A1.Ex15.m1.3.3.1" xref="A1.Ex15.m1.3.3.1.cmml"><mstyle displaystyle="true" id="A1.Ex15.m1.3.3.1.3" xref="A1.Ex15.m1.3.3.1.3.cmml"><mfrac id="A1.Ex15.m1.3.3.1.3a" xref="A1.Ex15.m1.3.3.1.3.cmml"><mn id="A1.Ex15.m1.3.3.1.3.2" xref="A1.Ex15.m1.3.3.1.3.2.cmml">1</mn><mi id="A1.Ex15.m1.3.3.1.3.3" xref="A1.Ex15.m1.3.3.1.3.3.cmml">n</mi></mfrac></mstyle><mo id="A1.Ex15.m1.3.3.1.2" xref="A1.Ex15.m1.3.3.1.2.cmml">⁢</mo><msub id="A1.Ex15.m1.3.3.1.4" xref="A1.Ex15.m1.3.3.1.4.cmml"><mi id="A1.Ex15.m1.3.3.1.4.2" xref="A1.Ex15.m1.3.3.1.4.2.cmml">𝔼</mi><mi id="A1.Ex15.m1.3.3.1.4.3" xref="A1.Ex15.m1.3.3.1.4.3.cmml">𝝈</mi></msub><mo id="A1.Ex15.m1.3.3.1.2a" xref="A1.Ex15.m1.3.3.1.2.cmml">⁢</mo><mrow id="A1.Ex15.m1.3.3.1.1.1" xref="A1.Ex15.m1.3.3.1.1.2.cmml"><mo id="A1.Ex15.m1.3.3.1.1.1.2" xref="A1.Ex15.m1.3.3.1.1.2.1.cmml">|</mo><mrow id="A1.Ex15.m1.3.3.1.1.1.1" xref="A1.Ex15.m1.3.3.1.1.1.1.cmml"><munder id="A1.Ex15.m1.3.3.1.1.1.1.3" xref="A1.Ex15.m1.3.3.1.1.1.1.3.cmml"><mo id="A1.Ex15.m1.3.3.1.1.1.1.3.2" lspace="0em" movablelimits="false" rspace="0.167em" xref="A1.Ex15.m1.3.3.1.1.1.1.3.2.cmml">sup</mo><mrow id="A1.Ex15.m1.3.3.1.1.1.1.3.3" xref="A1.Ex15.m1.3.3.1.1.1.1.3.3.cmml"><mi id="A1.Ex15.m1.3.3.1.1.1.1.3.3.2" xref="A1.Ex15.m1.3.3.1.1.1.1.3.3.2.cmml">f</mi><mo id="A1.Ex15.m1.3.3.1.1.1.1.3.3.1" xref="A1.Ex15.m1.3.3.1.1.1.1.3.3.1.cmml">∈</mo><msup id="A1.Ex15.m1.3.3.1.1.1.1.3.3.3" xref="A1.Ex15.m1.3.3.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.Ex15.m1.3.3.1.1.1.1.3.3.3.2" xref="A1.Ex15.m1.3.3.1.1.1.1.3.3.3.2.cmml">ℱ</mi><msup id="A1.Ex15.m1.3.3.1.1.1.1.3.3.3.3" xref="A1.Ex15.m1.3.3.1.1.1.1.3.3.3.3.cmml"><mi id="A1.Ex15.m1.3.3.1.1.1.1.3.3.3.3.2" xref="A1.Ex15.m1.3.3.1.1.1.1.3.3.3.3.2.cmml">g</mi><mo id="A1.Ex15.m1.3.3.1.1.1.1.3.3.3.3.3" xref="A1.Ex15.m1.3.3.1.1.1.1.3.3.3.3.3.cmml">′</mo></msup></msup></mrow></munder><mrow id="A1.Ex15.m1.3.3.1.1.1.1.2" xref="A1.Ex15.m1.3.3.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="A1.Ex15.m1.3.3.1.1.1.1.2.3" xref="A1.Ex15.m1.3.3.1.1.1.1.2.3.cmml"><munder id="A1.Ex15.m1.3.3.1.1.1.1.2.3a" xref="A1.Ex15.m1.3.3.1.1.1.1.2.3.cmml"><mo id="A1.Ex15.m1.3.3.1.1.1.1.2.3.2" movablelimits="false" xref="A1.Ex15.m1.3.3.1.1.1.1.2.3.2.cmml">∑</mo><mi id="A1.Ex15.m1.3.3.1.1.1.1.2.3.3" xref="A1.Ex15.m1.3.3.1.1.1.1.2.3.3.cmml">i</mi></munder></mstyle><mrow id="A1.Ex15.m1.3.3.1.1.1.1.2.2" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2.cmml"><msub id="A1.Ex15.m1.3.3.1.1.1.1.2.2.4" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2.4.cmml"><mi id="A1.Ex15.m1.3.3.1.1.1.1.2.2.4.2" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2.4.2.cmml">σ</mi><mi id="A1.Ex15.m1.3.3.1.1.1.1.2.2.4.3" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2.4.3.cmml">i</mi></msub><mo id="A1.Ex15.m1.3.3.1.1.1.1.2.2.3" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2.3.cmml">⁢</mo><mi id="A1.Ex15.m1.3.3.1.1.1.1.2.2.5" mathvariant="normal" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2.5.cmml">ℓ</mi><mo id="A1.Ex15.m1.3.3.1.1.1.1.2.2.3a" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2.3.cmml">⁢</mo><mrow id="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.2" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.3.cmml"><mo id="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.2.3" stretchy="false" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.3.cmml">(</mo><mrow id="A1.Ex15.m1.3.3.1.1.1.1.1.1.1.1.1" xref="A1.Ex15.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex15.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex15.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">f</mi><mo id="A1.Ex15.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex15.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.Ex15.m1.3.3.1.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex15.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex15.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.Ex15.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex15.m1.1.1" xref="A1.Ex15.m1.1.1.cmml">y</mi><mo id="A1.Ex15.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A1.Ex15.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.2.4" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.3.cmml">,</mo><mrow id="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.2.2" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.2.2.cmml"><mi id="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.2.2.2" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.2.2.2.cmml">g</mi><mo id="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.2.2.1" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.2.2.1.cmml">⁢</mo><mrow id="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.2.2.3.2" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.2.2.cmml"><mo id="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.2.2.3.2.1" stretchy="false" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.2.2.cmml">(</mo><mi id="A1.Ex15.m1.2.2" xref="A1.Ex15.m1.2.2.cmml">y</mi><mo id="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.2.2.3.2.2" stretchy="false" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.2.5" stretchy="false" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.Ex15.m1.3.3.1.1.1.3" xref="A1.Ex15.m1.3.3.1.1.2.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex15.m1.3b"><apply id="A1.Ex15.m1.3.3.cmml" xref="A1.Ex15.m1.3.3"><eq id="A1.Ex15.m1.3.3.2.cmml" xref="A1.Ex15.m1.3.3.2"></eq><csymbol cd="latexml" id="A1.Ex15.m1.3.3.3.cmml" xref="A1.Ex15.m1.3.3.3">absent</csymbol><apply id="A1.Ex15.m1.3.3.1.cmml" xref="A1.Ex15.m1.3.3.1"><times id="A1.Ex15.m1.3.3.1.2.cmml" xref="A1.Ex15.m1.3.3.1.2"></times><apply id="A1.Ex15.m1.3.3.1.3.cmml" xref="A1.Ex15.m1.3.3.1.3"><divide id="A1.Ex15.m1.3.3.1.3.1.cmml" xref="A1.Ex15.m1.3.3.1.3"></divide><cn id="A1.Ex15.m1.3.3.1.3.2.cmml" type="integer" xref="A1.Ex15.m1.3.3.1.3.2">1</cn><ci id="A1.Ex15.m1.3.3.1.3.3.cmml" xref="A1.Ex15.m1.3.3.1.3.3">𝑛</ci></apply><apply id="A1.Ex15.m1.3.3.1.4.cmml" xref="A1.Ex15.m1.3.3.1.4"><csymbol cd="ambiguous" id="A1.Ex15.m1.3.3.1.4.1.cmml" xref="A1.Ex15.m1.3.3.1.4">subscript</csymbol><ci id="A1.Ex15.m1.3.3.1.4.2.cmml" xref="A1.Ex15.m1.3.3.1.4.2">𝔼</ci><ci id="A1.Ex15.m1.3.3.1.4.3.cmml" xref="A1.Ex15.m1.3.3.1.4.3">𝝈</ci></apply><apply id="A1.Ex15.m1.3.3.1.1.2.cmml" xref="A1.Ex15.m1.3.3.1.1.1"><abs id="A1.Ex15.m1.3.3.1.1.2.1.cmml" xref="A1.Ex15.m1.3.3.1.1.1.2"></abs><apply id="A1.Ex15.m1.3.3.1.1.1.1.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1"><apply id="A1.Ex15.m1.3.3.1.1.1.1.3.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex15.m1.3.3.1.1.1.1.3.1.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.3">subscript</csymbol><csymbol cd="latexml" id="A1.Ex15.m1.3.3.1.1.1.1.3.2.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.3.2">supremum</csymbol><apply id="A1.Ex15.m1.3.3.1.1.1.1.3.3.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.3.3"><in id="A1.Ex15.m1.3.3.1.1.1.1.3.3.1.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.3.3.1"></in><ci id="A1.Ex15.m1.3.3.1.1.1.1.3.3.2.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.3.3.2">𝑓</ci><apply id="A1.Ex15.m1.3.3.1.1.1.1.3.3.3.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.Ex15.m1.3.3.1.1.1.1.3.3.3.1.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.3.3.3">superscript</csymbol><ci id="A1.Ex15.m1.3.3.1.1.1.1.3.3.3.2.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.3.3.3.2">ℱ</ci><apply id="A1.Ex15.m1.3.3.1.1.1.1.3.3.3.3.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="A1.Ex15.m1.3.3.1.1.1.1.3.3.3.3.1.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.3.3.3.3">superscript</csymbol><ci id="A1.Ex15.m1.3.3.1.1.1.1.3.3.3.3.2.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.3.3.3.3.2">𝑔</ci><ci id="A1.Ex15.m1.3.3.1.1.1.1.3.3.3.3.3.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.3.3.3.3.3">′</ci></apply></apply></apply></apply><apply id="A1.Ex15.m1.3.3.1.1.1.1.2.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.2"><apply id="A1.Ex15.m1.3.3.1.1.1.1.2.3.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.Ex15.m1.3.3.1.1.1.1.2.3.1.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.2.3">subscript</csymbol><sum id="A1.Ex15.m1.3.3.1.1.1.1.2.3.2.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.2.3.2"></sum><ci id="A1.Ex15.m1.3.3.1.1.1.1.2.3.3.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.2.3.3">𝑖</ci></apply><apply id="A1.Ex15.m1.3.3.1.1.1.1.2.2.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2"><times id="A1.Ex15.m1.3.3.1.1.1.1.2.2.3.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2.3"></times><apply id="A1.Ex15.m1.3.3.1.1.1.1.2.2.4.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2.4"><csymbol cd="ambiguous" id="A1.Ex15.m1.3.3.1.1.1.1.2.2.4.1.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2.4">subscript</csymbol><ci id="A1.Ex15.m1.3.3.1.1.1.1.2.2.4.2.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2.4.2">𝜎</ci><ci id="A1.Ex15.m1.3.3.1.1.1.1.2.2.4.3.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2.4.3">𝑖</ci></apply><ci id="A1.Ex15.m1.3.3.1.1.1.1.2.2.5.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2.5">ℓ</ci><interval closure="open" id="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.3.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.2"><apply id="A1.Ex15.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.1.1.1.1.1"><times id="A1.Ex15.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.1.1.1.1.1.1"></times><ci id="A1.Ex15.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.1.1.1.1.1.2">𝑓</ci><ci id="A1.Ex15.m1.1.1.cmml" xref="A1.Ex15.m1.1.1">𝑦</ci></apply><apply id="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.2.2.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.2.2"><times id="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.2.2.1.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.2.2.1"></times><ci id="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.2.2.2.cmml" xref="A1.Ex15.m1.3.3.1.1.1.1.2.2.2.2.2.2">𝑔</ci><ci id="A1.Ex15.m1.2.2.cmml" xref="A1.Ex15.m1.2.2">𝑦</ci></apply></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex15.m1.3c">\displaystyle=\frac{1}{n}\mathbb{E}_{\bm{\sigma}}\left|\sup_{f\in\mathcal{F}^{%
g^{\prime}}}\sum_{i}\sigma_{i}\ell(f(y),g(y))\right|</annotation><annotation encoding="application/x-llamapun" id="A1.Ex15.m1.3d">= divide start_ARG 1 end_ARG start_ARG italic_n end_ARG blackboard_E start_POSTSUBSCRIPT bold_italic_σ end_POSTSUBSCRIPT | roman_sup start_POSTSUBSCRIPT italic_f ∈ caligraphic_F start_POSTSUPERSCRIPT italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_ℓ ( italic_f ( italic_y ) , italic_g ( italic_y ) ) |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\overset{(ii)}{\leq}\frac{1}{n}\mathbb{E}_{\bm{\sigma}}\left|\sup%
_{f\in\mathcal{F}}\sum_{i}\sigma_{i}\ell(f(y),g(y))\right|" class="ltx_Math" display="inline" id="A1.Ex16.m1.4"><semantics id="A1.Ex16.m1.4a"><mrow id="A1.Ex16.m1.4.4" xref="A1.Ex16.m1.4.4.cmml"><mover accent="true" id="A1.Ex16.m1.1.1" xref="A1.Ex16.m1.1.1.cmml"><mo id="A1.Ex16.m1.1.1.2" xref="A1.Ex16.m1.1.1.2.cmml">≤</mo><mrow id="A1.Ex16.m1.1.1.1.1" xref="A1.Ex16.m1.1.1.1.1.1.cmml"><mo id="A1.Ex16.m1.1.1.1.1.2" stretchy="false" xref="A1.Ex16.m1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex16.m1.1.1.1.1.1" xref="A1.Ex16.m1.1.1.1.1.1.cmml"><mi id="A1.Ex16.m1.1.1.1.1.1.2" xref="A1.Ex16.m1.1.1.1.1.1.2.cmml">i</mi><mo id="A1.Ex16.m1.1.1.1.1.1.1" xref="A1.Ex16.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.Ex16.m1.1.1.1.1.1.3" xref="A1.Ex16.m1.1.1.1.1.1.3.cmml">i</mi></mrow><mo id="A1.Ex16.m1.1.1.1.1.3" stretchy="false" xref="A1.Ex16.m1.1.1.1.1.1.cmml">)</mo></mrow></mover><mo id="A1.Ex16.m1.4.4.2" xref="A1.Ex16.m1.4.4.2.cmml">⁢</mo><mstyle displaystyle="true" id="A1.Ex16.m1.4.4.3" xref="A1.Ex16.m1.4.4.3.cmml"><mfrac id="A1.Ex16.m1.4.4.3a" xref="A1.Ex16.m1.4.4.3.cmml"><mn id="A1.Ex16.m1.4.4.3.2" xref="A1.Ex16.m1.4.4.3.2.cmml">1</mn><mi id="A1.Ex16.m1.4.4.3.3" xref="A1.Ex16.m1.4.4.3.3.cmml">n</mi></mfrac></mstyle><mo id="A1.Ex16.m1.4.4.2a" xref="A1.Ex16.m1.4.4.2.cmml">⁢</mo><msub id="A1.Ex16.m1.4.4.4" xref="A1.Ex16.m1.4.4.4.cmml"><mi id="A1.Ex16.m1.4.4.4.2" xref="A1.Ex16.m1.4.4.4.2.cmml">𝔼</mi><mi id="A1.Ex16.m1.4.4.4.3" xref="A1.Ex16.m1.4.4.4.3.cmml">𝝈</mi></msub><mo id="A1.Ex16.m1.4.4.2b" xref="A1.Ex16.m1.4.4.2.cmml">⁢</mo><mrow id="A1.Ex16.m1.4.4.1.1" xref="A1.Ex16.m1.4.4.1.2.cmml"><mo id="A1.Ex16.m1.4.4.1.1.2" xref="A1.Ex16.m1.4.4.1.2.1.cmml">|</mo><mrow id="A1.Ex16.m1.4.4.1.1.1" xref="A1.Ex16.m1.4.4.1.1.1.cmml"><munder id="A1.Ex16.m1.4.4.1.1.1.3" xref="A1.Ex16.m1.4.4.1.1.1.3.cmml"><mo id="A1.Ex16.m1.4.4.1.1.1.3.2" lspace="0em" movablelimits="false" rspace="0.167em" xref="A1.Ex16.m1.4.4.1.1.1.3.2.cmml">sup</mo><mrow id="A1.Ex16.m1.4.4.1.1.1.3.3" xref="A1.Ex16.m1.4.4.1.1.1.3.3.cmml"><mi id="A1.Ex16.m1.4.4.1.1.1.3.3.2" xref="A1.Ex16.m1.4.4.1.1.1.3.3.2.cmml">f</mi><mo id="A1.Ex16.m1.4.4.1.1.1.3.3.1" xref="A1.Ex16.m1.4.4.1.1.1.3.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A1.Ex16.m1.4.4.1.1.1.3.3.3" xref="A1.Ex16.m1.4.4.1.1.1.3.3.3.cmml">ℱ</mi></mrow></munder><mrow id="A1.Ex16.m1.4.4.1.1.1.2" xref="A1.Ex16.m1.4.4.1.1.1.2.cmml"><mstyle displaystyle="true" id="A1.Ex16.m1.4.4.1.1.1.2.3" xref="A1.Ex16.m1.4.4.1.1.1.2.3.cmml"><munder id="A1.Ex16.m1.4.4.1.1.1.2.3a" xref="A1.Ex16.m1.4.4.1.1.1.2.3.cmml"><mo id="A1.Ex16.m1.4.4.1.1.1.2.3.2" movablelimits="false" xref="A1.Ex16.m1.4.4.1.1.1.2.3.2.cmml">∑</mo><mi id="A1.Ex16.m1.4.4.1.1.1.2.3.3" xref="A1.Ex16.m1.4.4.1.1.1.2.3.3.cmml">i</mi></munder></mstyle><mrow id="A1.Ex16.m1.4.4.1.1.1.2.2" xref="A1.Ex16.m1.4.4.1.1.1.2.2.cmml"><msub id="A1.Ex16.m1.4.4.1.1.1.2.2.4" xref="A1.Ex16.m1.4.4.1.1.1.2.2.4.cmml"><mi id="A1.Ex16.m1.4.4.1.1.1.2.2.4.2" xref="A1.Ex16.m1.4.4.1.1.1.2.2.4.2.cmml">σ</mi><mi id="A1.Ex16.m1.4.4.1.1.1.2.2.4.3" xref="A1.Ex16.m1.4.4.1.1.1.2.2.4.3.cmml">i</mi></msub><mo id="A1.Ex16.m1.4.4.1.1.1.2.2.3" xref="A1.Ex16.m1.4.4.1.1.1.2.2.3.cmml">⁢</mo><mi id="A1.Ex16.m1.4.4.1.1.1.2.2.5" mathvariant="normal" xref="A1.Ex16.m1.4.4.1.1.1.2.2.5.cmml">ℓ</mi><mo id="A1.Ex16.m1.4.4.1.1.1.2.2.3a" xref="A1.Ex16.m1.4.4.1.1.1.2.2.3.cmml">⁢</mo><mrow id="A1.Ex16.m1.4.4.1.1.1.2.2.2.2" xref="A1.Ex16.m1.4.4.1.1.1.2.2.2.3.cmml"><mo id="A1.Ex16.m1.4.4.1.1.1.2.2.2.2.3" stretchy="false" xref="A1.Ex16.m1.4.4.1.1.1.2.2.2.3.cmml">(</mo><mrow id="A1.Ex16.m1.4.4.1.1.1.1.1.1.1.1" xref="A1.Ex16.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex16.m1.4.4.1.1.1.1.1.1.1.1.2" xref="A1.Ex16.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">f</mi><mo id="A1.Ex16.m1.4.4.1.1.1.1.1.1.1.1.1" xref="A1.Ex16.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.Ex16.m1.4.4.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex16.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex16.m1.4.4.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.Ex16.m1.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex16.m1.2.2" xref="A1.Ex16.m1.2.2.cmml">y</mi><mo id="A1.Ex16.m1.4.4.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="A1.Ex16.m1.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex16.m1.4.4.1.1.1.2.2.2.2.4" xref="A1.Ex16.m1.4.4.1.1.1.2.2.2.3.cmml">,</mo><mrow id="A1.Ex16.m1.4.4.1.1.1.2.2.2.2.2" xref="A1.Ex16.m1.4.4.1.1.1.2.2.2.2.2.cmml"><mi id="A1.Ex16.m1.4.4.1.1.1.2.2.2.2.2.2" xref="A1.Ex16.m1.4.4.1.1.1.2.2.2.2.2.2.cmml">g</mi><mo id="A1.Ex16.m1.4.4.1.1.1.2.2.2.2.2.1" xref="A1.Ex16.m1.4.4.1.1.1.2.2.2.2.2.1.cmml">⁢</mo><mrow id="A1.Ex16.m1.4.4.1.1.1.2.2.2.2.2.3.2" xref="A1.Ex16.m1.4.4.1.1.1.2.2.2.2.2.cmml"><mo id="A1.Ex16.m1.4.4.1.1.1.2.2.2.2.2.3.2.1" stretchy="false" xref="A1.Ex16.m1.4.4.1.1.1.2.2.2.2.2.cmml">(</mo><mi id="A1.Ex16.m1.3.3" xref="A1.Ex16.m1.3.3.cmml">y</mi><mo id="A1.Ex16.m1.4.4.1.1.1.2.2.2.2.2.3.2.2" stretchy="false" xref="A1.Ex16.m1.4.4.1.1.1.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex16.m1.4.4.1.1.1.2.2.2.2.5" stretchy="false" xref="A1.Ex16.m1.4.4.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.Ex16.m1.4.4.1.1.3" xref="A1.Ex16.m1.4.4.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex16.m1.4b"><apply id="A1.Ex16.m1.4.4.cmml" xref="A1.Ex16.m1.4.4"><times id="A1.Ex16.m1.4.4.2.cmml" xref="A1.Ex16.m1.4.4.2"></times><apply id="A1.Ex16.m1.1.1.cmml" xref="A1.Ex16.m1.1.1"><apply id="A1.Ex16.m1.1.1.1.1.1.cmml" xref="A1.Ex16.m1.1.1.1.1"><times id="A1.Ex16.m1.1.1.1.1.1.1.cmml" xref="A1.Ex16.m1.1.1.1.1.1.1"></times><ci id="A1.Ex16.m1.1.1.1.1.1.2.cmml" xref="A1.Ex16.m1.1.1.1.1.1.2">𝑖</ci><ci id="A1.Ex16.m1.1.1.1.1.1.3.cmml" xref="A1.Ex16.m1.1.1.1.1.1.3">𝑖</ci></apply><leq id="A1.Ex16.m1.1.1.2.cmml" xref="A1.Ex16.m1.1.1.2"></leq></apply><apply id="A1.Ex16.m1.4.4.3.cmml" xref="A1.Ex16.m1.4.4.3"><divide id="A1.Ex16.m1.4.4.3.1.cmml" xref="A1.Ex16.m1.4.4.3"></divide><cn id="A1.Ex16.m1.4.4.3.2.cmml" type="integer" xref="A1.Ex16.m1.4.4.3.2">1</cn><ci id="A1.Ex16.m1.4.4.3.3.cmml" xref="A1.Ex16.m1.4.4.3.3">𝑛</ci></apply><apply id="A1.Ex16.m1.4.4.4.cmml" xref="A1.Ex16.m1.4.4.4"><csymbol cd="ambiguous" id="A1.Ex16.m1.4.4.4.1.cmml" xref="A1.Ex16.m1.4.4.4">subscript</csymbol><ci id="A1.Ex16.m1.4.4.4.2.cmml" xref="A1.Ex16.m1.4.4.4.2">𝔼</ci><ci id="A1.Ex16.m1.4.4.4.3.cmml" xref="A1.Ex16.m1.4.4.4.3">𝝈</ci></apply><apply id="A1.Ex16.m1.4.4.1.2.cmml" xref="A1.Ex16.m1.4.4.1.1"><abs id="A1.Ex16.m1.4.4.1.2.1.cmml" xref="A1.Ex16.m1.4.4.1.1.2"></abs><apply id="A1.Ex16.m1.4.4.1.1.1.cmml" xref="A1.Ex16.m1.4.4.1.1.1"><apply id="A1.Ex16.m1.4.4.1.1.1.3.cmml" xref="A1.Ex16.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex16.m1.4.4.1.1.1.3.1.cmml" xref="A1.Ex16.m1.4.4.1.1.1.3">subscript</csymbol><csymbol cd="latexml" id="A1.Ex16.m1.4.4.1.1.1.3.2.cmml" xref="A1.Ex16.m1.4.4.1.1.1.3.2">supremum</csymbol><apply id="A1.Ex16.m1.4.4.1.1.1.3.3.cmml" xref="A1.Ex16.m1.4.4.1.1.1.3.3"><in id="A1.Ex16.m1.4.4.1.1.1.3.3.1.cmml" xref="A1.Ex16.m1.4.4.1.1.1.3.3.1"></in><ci id="A1.Ex16.m1.4.4.1.1.1.3.3.2.cmml" xref="A1.Ex16.m1.4.4.1.1.1.3.3.2">𝑓</ci><ci id="A1.Ex16.m1.4.4.1.1.1.3.3.3.cmml" xref="A1.Ex16.m1.4.4.1.1.1.3.3.3">ℱ</ci></apply></apply><apply id="A1.Ex16.m1.4.4.1.1.1.2.cmml" xref="A1.Ex16.m1.4.4.1.1.1.2"><apply id="A1.Ex16.m1.4.4.1.1.1.2.3.cmml" xref="A1.Ex16.m1.4.4.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.Ex16.m1.4.4.1.1.1.2.3.1.cmml" xref="A1.Ex16.m1.4.4.1.1.1.2.3">subscript</csymbol><sum id="A1.Ex16.m1.4.4.1.1.1.2.3.2.cmml" xref="A1.Ex16.m1.4.4.1.1.1.2.3.2"></sum><ci id="A1.Ex16.m1.4.4.1.1.1.2.3.3.cmml" xref="A1.Ex16.m1.4.4.1.1.1.2.3.3">𝑖</ci></apply><apply id="A1.Ex16.m1.4.4.1.1.1.2.2.cmml" xref="A1.Ex16.m1.4.4.1.1.1.2.2"><times id="A1.Ex16.m1.4.4.1.1.1.2.2.3.cmml" xref="A1.Ex16.m1.4.4.1.1.1.2.2.3"></times><apply id="A1.Ex16.m1.4.4.1.1.1.2.2.4.cmml" xref="A1.Ex16.m1.4.4.1.1.1.2.2.4"><csymbol cd="ambiguous" id="A1.Ex16.m1.4.4.1.1.1.2.2.4.1.cmml" xref="A1.Ex16.m1.4.4.1.1.1.2.2.4">subscript</csymbol><ci id="A1.Ex16.m1.4.4.1.1.1.2.2.4.2.cmml" xref="A1.Ex16.m1.4.4.1.1.1.2.2.4.2">𝜎</ci><ci id="A1.Ex16.m1.4.4.1.1.1.2.2.4.3.cmml" xref="A1.Ex16.m1.4.4.1.1.1.2.2.4.3">𝑖</ci></apply><ci id="A1.Ex16.m1.4.4.1.1.1.2.2.5.cmml" xref="A1.Ex16.m1.4.4.1.1.1.2.2.5">ℓ</ci><interval closure="open" id="A1.Ex16.m1.4.4.1.1.1.2.2.2.3.cmml" xref="A1.Ex16.m1.4.4.1.1.1.2.2.2.2"><apply id="A1.Ex16.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex16.m1.4.4.1.1.1.1.1.1.1.1"><times id="A1.Ex16.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex16.m1.4.4.1.1.1.1.1.1.1.1.1"></times><ci id="A1.Ex16.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex16.m1.4.4.1.1.1.1.1.1.1.1.2">𝑓</ci><ci id="A1.Ex16.m1.2.2.cmml" xref="A1.Ex16.m1.2.2">𝑦</ci></apply><apply id="A1.Ex16.m1.4.4.1.1.1.2.2.2.2.2.cmml" xref="A1.Ex16.m1.4.4.1.1.1.2.2.2.2.2"><times id="A1.Ex16.m1.4.4.1.1.1.2.2.2.2.2.1.cmml" xref="A1.Ex16.m1.4.4.1.1.1.2.2.2.2.2.1"></times><ci id="A1.Ex16.m1.4.4.1.1.1.2.2.2.2.2.2.cmml" xref="A1.Ex16.m1.4.4.1.1.1.2.2.2.2.2.2">𝑔</ci><ci id="A1.Ex16.m1.3.3.cmml" xref="A1.Ex16.m1.3.3">𝑦</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex16.m1.4c">\displaystyle\overset{(ii)}{\leq}\frac{1}{n}\mathbb{E}_{\bm{\sigma}}\left|\sup%
_{f\in\mathcal{F}}\sum_{i}\sigma_{i}\ell(f(y),g(y))\right|</annotation><annotation encoding="application/x-llamapun" id="A1.Ex16.m1.4d">start_OVERACCENT ( italic_i italic_i ) end_OVERACCENT start_ARG ≤ end_ARG divide start_ARG 1 end_ARG start_ARG italic_n end_ARG blackboard_E start_POSTSUBSCRIPT bold_italic_σ end_POSTSUBSCRIPT | roman_sup start_POSTSUBSCRIPT italic_f ∈ caligraphic_F end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_ℓ ( italic_f ( italic_y ) , italic_g ( italic_y ) ) |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{n}\mathbb{E}_{\bm{\sigma}}\left|\sup_{\lambda\in%
\mathcal{G}_{\ell,\mathcal{F}}}\sum_{i}\sigma_{i}\lambda(y_{i})\right|" class="ltx_Math" display="inline" id="A1.Ex17.m1.3"><semantics id="A1.Ex17.m1.3a"><mrow id="A1.Ex17.m1.3.3" xref="A1.Ex17.m1.3.3.cmml"><mi id="A1.Ex17.m1.3.3.3" xref="A1.Ex17.m1.3.3.3.cmml"></mi><mo id="A1.Ex17.m1.3.3.2" xref="A1.Ex17.m1.3.3.2.cmml">=</mo><mrow id="A1.Ex17.m1.3.3.1" xref="A1.Ex17.m1.3.3.1.cmml"><mstyle displaystyle="true" id="A1.Ex17.m1.3.3.1.3" xref="A1.Ex17.m1.3.3.1.3.cmml"><mfrac id="A1.Ex17.m1.3.3.1.3a" xref="A1.Ex17.m1.3.3.1.3.cmml"><mn id="A1.Ex17.m1.3.3.1.3.2" xref="A1.Ex17.m1.3.3.1.3.2.cmml">1</mn><mi id="A1.Ex17.m1.3.3.1.3.3" xref="A1.Ex17.m1.3.3.1.3.3.cmml">n</mi></mfrac></mstyle><mo id="A1.Ex17.m1.3.3.1.2" xref="A1.Ex17.m1.3.3.1.2.cmml">⁢</mo><msub id="A1.Ex17.m1.3.3.1.4" xref="A1.Ex17.m1.3.3.1.4.cmml"><mi id="A1.Ex17.m1.3.3.1.4.2" xref="A1.Ex17.m1.3.3.1.4.2.cmml">𝔼</mi><mi id="A1.Ex17.m1.3.3.1.4.3" xref="A1.Ex17.m1.3.3.1.4.3.cmml">𝝈</mi></msub><mo id="A1.Ex17.m1.3.3.1.2a" xref="A1.Ex17.m1.3.3.1.2.cmml">⁢</mo><mrow id="A1.Ex17.m1.3.3.1.1.1" xref="A1.Ex17.m1.3.3.1.1.2.cmml"><mo id="A1.Ex17.m1.3.3.1.1.1.2" xref="A1.Ex17.m1.3.3.1.1.2.1.cmml">|</mo><mrow id="A1.Ex17.m1.3.3.1.1.1.1" xref="A1.Ex17.m1.3.3.1.1.1.1.cmml"><munder id="A1.Ex17.m1.3.3.1.1.1.1.2" xref="A1.Ex17.m1.3.3.1.1.1.1.2.cmml"><mo id="A1.Ex17.m1.3.3.1.1.1.1.2.2" lspace="0em" movablelimits="false" rspace="0.167em" xref="A1.Ex17.m1.3.3.1.1.1.1.2.2.cmml">sup</mo><mrow id="A1.Ex17.m1.2.2.2" xref="A1.Ex17.m1.2.2.2.cmml"><mi id="A1.Ex17.m1.2.2.2.4" xref="A1.Ex17.m1.2.2.2.4.cmml">λ</mi><mo id="A1.Ex17.m1.2.2.2.3" xref="A1.Ex17.m1.2.2.2.3.cmml">∈</mo><msub id="A1.Ex17.m1.2.2.2.5" xref="A1.Ex17.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.Ex17.m1.2.2.2.5.2" xref="A1.Ex17.m1.2.2.2.5.2.cmml">𝒢</mi><mrow id="A1.Ex17.m1.2.2.2.2.2.4" xref="A1.Ex17.m1.2.2.2.2.2.3.cmml"><mi id="A1.Ex17.m1.1.1.1.1.1.1" mathvariant="normal" xref="A1.Ex17.m1.1.1.1.1.1.1.cmml">ℓ</mi><mo id="A1.Ex17.m1.2.2.2.2.2.4.1" xref="A1.Ex17.m1.2.2.2.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A1.Ex17.m1.2.2.2.2.2.2" xref="A1.Ex17.m1.2.2.2.2.2.2.cmml">ℱ</mi></mrow></msub></mrow></munder><mrow id="A1.Ex17.m1.3.3.1.1.1.1.1" xref="A1.Ex17.m1.3.3.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A1.Ex17.m1.3.3.1.1.1.1.1.2" xref="A1.Ex17.m1.3.3.1.1.1.1.1.2.cmml"><munder id="A1.Ex17.m1.3.3.1.1.1.1.1.2a" xref="A1.Ex17.m1.3.3.1.1.1.1.1.2.cmml"><mo id="A1.Ex17.m1.3.3.1.1.1.1.1.2.2" movablelimits="false" xref="A1.Ex17.m1.3.3.1.1.1.1.1.2.2.cmml">∑</mo><mi id="A1.Ex17.m1.3.3.1.1.1.1.1.2.3" xref="A1.Ex17.m1.3.3.1.1.1.1.1.2.3.cmml">i</mi></munder></mstyle><mrow id="A1.Ex17.m1.3.3.1.1.1.1.1.1" xref="A1.Ex17.m1.3.3.1.1.1.1.1.1.cmml"><msub id="A1.Ex17.m1.3.3.1.1.1.1.1.1.3" xref="A1.Ex17.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex17.m1.3.3.1.1.1.1.1.1.3.2" xref="A1.Ex17.m1.3.3.1.1.1.1.1.1.3.2.cmml">σ</mi><mi id="A1.Ex17.m1.3.3.1.1.1.1.1.1.3.3" xref="A1.Ex17.m1.3.3.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="A1.Ex17.m1.3.3.1.1.1.1.1.1.2" xref="A1.Ex17.m1.3.3.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.Ex17.m1.3.3.1.1.1.1.1.1.4" xref="A1.Ex17.m1.3.3.1.1.1.1.1.1.4.cmml">λ</mi><mo id="A1.Ex17.m1.3.3.1.1.1.1.1.1.2a" xref="A1.Ex17.m1.3.3.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex17.m1.3.3.1.1.1.1.1.1.1.1" xref="A1.Ex17.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex17.m1.3.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex17.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.Ex17.m1.3.3.1.1.1.1.1.1.1.1.1" xref="A1.Ex17.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex17.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex17.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="A1.Ex17.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex17.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.Ex17.m1.3.3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex17.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.Ex17.m1.3.3.1.1.1.3" xref="A1.Ex17.m1.3.3.1.1.2.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex17.m1.3b"><apply id="A1.Ex17.m1.3.3.cmml" xref="A1.Ex17.m1.3.3"><eq id="A1.Ex17.m1.3.3.2.cmml" xref="A1.Ex17.m1.3.3.2"></eq><csymbol cd="latexml" id="A1.Ex17.m1.3.3.3.cmml" xref="A1.Ex17.m1.3.3.3">absent</csymbol><apply id="A1.Ex17.m1.3.3.1.cmml" xref="A1.Ex17.m1.3.3.1"><times id="A1.Ex17.m1.3.3.1.2.cmml" xref="A1.Ex17.m1.3.3.1.2"></times><apply id="A1.Ex17.m1.3.3.1.3.cmml" xref="A1.Ex17.m1.3.3.1.3"><divide id="A1.Ex17.m1.3.3.1.3.1.cmml" xref="A1.Ex17.m1.3.3.1.3"></divide><cn id="A1.Ex17.m1.3.3.1.3.2.cmml" type="integer" xref="A1.Ex17.m1.3.3.1.3.2">1</cn><ci id="A1.Ex17.m1.3.3.1.3.3.cmml" xref="A1.Ex17.m1.3.3.1.3.3">𝑛</ci></apply><apply id="A1.Ex17.m1.3.3.1.4.cmml" xref="A1.Ex17.m1.3.3.1.4"><csymbol cd="ambiguous" id="A1.Ex17.m1.3.3.1.4.1.cmml" xref="A1.Ex17.m1.3.3.1.4">subscript</csymbol><ci id="A1.Ex17.m1.3.3.1.4.2.cmml" xref="A1.Ex17.m1.3.3.1.4.2">𝔼</ci><ci id="A1.Ex17.m1.3.3.1.4.3.cmml" xref="A1.Ex17.m1.3.3.1.4.3">𝝈</ci></apply><apply id="A1.Ex17.m1.3.3.1.1.2.cmml" xref="A1.Ex17.m1.3.3.1.1.1"><abs id="A1.Ex17.m1.3.3.1.1.2.1.cmml" xref="A1.Ex17.m1.3.3.1.1.1.2"></abs><apply id="A1.Ex17.m1.3.3.1.1.1.1.cmml" xref="A1.Ex17.m1.3.3.1.1.1.1"><apply id="A1.Ex17.m1.3.3.1.1.1.1.2.cmml" xref="A1.Ex17.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex17.m1.3.3.1.1.1.1.2.1.cmml" xref="A1.Ex17.m1.3.3.1.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="A1.Ex17.m1.3.3.1.1.1.1.2.2.cmml" xref="A1.Ex17.m1.3.3.1.1.1.1.2.2">supremum</csymbol><apply id="A1.Ex17.m1.2.2.2.cmml" xref="A1.Ex17.m1.2.2.2"><in id="A1.Ex17.m1.2.2.2.3.cmml" xref="A1.Ex17.m1.2.2.2.3"></in><ci id="A1.Ex17.m1.2.2.2.4.cmml" xref="A1.Ex17.m1.2.2.2.4">𝜆</ci><apply id="A1.Ex17.m1.2.2.2.5.cmml" xref="A1.Ex17.m1.2.2.2.5"><csymbol cd="ambiguous" id="A1.Ex17.m1.2.2.2.5.1.cmml" xref="A1.Ex17.m1.2.2.2.5">subscript</csymbol><ci id="A1.Ex17.m1.2.2.2.5.2.cmml" xref="A1.Ex17.m1.2.2.2.5.2">𝒢</ci><list id="A1.Ex17.m1.2.2.2.2.2.3.cmml" xref="A1.Ex17.m1.2.2.2.2.2.4"><ci id="A1.Ex17.m1.1.1.1.1.1.1.cmml" xref="A1.Ex17.m1.1.1.1.1.1.1">ℓ</ci><ci id="A1.Ex17.m1.2.2.2.2.2.2.cmml" xref="A1.Ex17.m1.2.2.2.2.2.2">ℱ</ci></list></apply></apply></apply><apply id="A1.Ex17.m1.3.3.1.1.1.1.1.cmml" xref="A1.Ex17.m1.3.3.1.1.1.1.1"><apply id="A1.Ex17.m1.3.3.1.1.1.1.1.2.cmml" xref="A1.Ex17.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex17.m1.3.3.1.1.1.1.1.2.1.cmml" xref="A1.Ex17.m1.3.3.1.1.1.1.1.2">subscript</csymbol><sum id="A1.Ex17.m1.3.3.1.1.1.1.1.2.2.cmml" xref="A1.Ex17.m1.3.3.1.1.1.1.1.2.2"></sum><ci id="A1.Ex17.m1.3.3.1.1.1.1.1.2.3.cmml" xref="A1.Ex17.m1.3.3.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="A1.Ex17.m1.3.3.1.1.1.1.1.1.cmml" xref="A1.Ex17.m1.3.3.1.1.1.1.1.1"><times id="A1.Ex17.m1.3.3.1.1.1.1.1.1.2.cmml" xref="A1.Ex17.m1.3.3.1.1.1.1.1.1.2"></times><apply id="A1.Ex17.m1.3.3.1.1.1.1.1.1.3.cmml" xref="A1.Ex17.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex17.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex17.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex17.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex17.m1.3.3.1.1.1.1.1.1.3.2">𝜎</ci><ci id="A1.Ex17.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex17.m1.3.3.1.1.1.1.1.1.3.3">𝑖</ci></apply><ci id="A1.Ex17.m1.3.3.1.1.1.1.1.1.4.cmml" xref="A1.Ex17.m1.3.3.1.1.1.1.1.1.4">𝜆</ci><apply id="A1.Ex17.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex17.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex17.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex17.m1.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex17.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex17.m1.3.3.1.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="A1.Ex17.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex17.m1.3.3.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex17.m1.3c">\displaystyle=\frac{1}{n}\mathbb{E}_{\bm{\sigma}}\left|\sup_{\lambda\in%
\mathcal{G}_{\ell,\mathcal{F}}}\sum_{i}\sigma_{i}\lambda(y_{i})\right|</annotation><annotation encoding="application/x-llamapun" id="A1.Ex17.m1.3d">= divide start_ARG 1 end_ARG start_ARG italic_n end_ARG blackboard_E start_POSTSUBSCRIPT bold_italic_σ end_POSTSUBSCRIPT | roman_sup start_POSTSUBSCRIPT italic_λ ∈ caligraphic_G start_POSTSUBSCRIPT roman_ℓ , caligraphic_F end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_λ ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.E22"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle={\mathfrak{R}}_{\tilde{\mathscr{S}}_{n}}(\mathcal{G}_{\ell,%
\mathcal{F}})," class="ltx_Math" display="inline" id="A1.E22.m1.3"><semantics id="A1.E22.m1.3a"><mrow id="A1.E22.m1.3.3.1" xref="A1.E22.m1.3.3.1.1.cmml"><mrow id="A1.E22.m1.3.3.1.1" xref="A1.E22.m1.3.3.1.1.cmml"><mi id="A1.E22.m1.3.3.1.1.3" xref="A1.E22.m1.3.3.1.1.3.cmml"></mi><mo id="A1.E22.m1.3.3.1.1.2" xref="A1.E22.m1.3.3.1.1.2.cmml">=</mo><mrow id="A1.E22.m1.3.3.1.1.1" xref="A1.E22.m1.3.3.1.1.1.cmml"><msub id="A1.E22.m1.3.3.1.1.1.3" xref="A1.E22.m1.3.3.1.1.1.3.cmml"><mi id="A1.E22.m1.3.3.1.1.1.3.2" xref="A1.E22.m1.3.3.1.1.1.3.2.cmml">ℜ</mi><msub id="A1.E22.m1.3.3.1.1.1.3.3" xref="A1.E22.m1.3.3.1.1.1.3.3.cmml"><mover accent="true" id="A1.E22.m1.3.3.1.1.1.3.3.2" xref="A1.E22.m1.3.3.1.1.1.3.3.2.cmml"><mi class="ltx_font_mathscript" id="A1.E22.m1.3.3.1.1.1.3.3.2.2" xref="A1.E22.m1.3.3.1.1.1.3.3.2.2.cmml">𝒮</mi><mo id="A1.E22.m1.3.3.1.1.1.3.3.2.1" xref="A1.E22.m1.3.3.1.1.1.3.3.2.1.cmml">~</mo></mover><mi id="A1.E22.m1.3.3.1.1.1.3.3.3" xref="A1.E22.m1.3.3.1.1.1.3.3.3.cmml">n</mi></msub></msub><mo id="A1.E22.m1.3.3.1.1.1.2" xref="A1.E22.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="A1.E22.m1.3.3.1.1.1.1.1" xref="A1.E22.m1.3.3.1.1.1.1.1.1.cmml"><mo id="A1.E22.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="A1.E22.m1.3.3.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E22.m1.3.3.1.1.1.1.1.1" xref="A1.E22.m1.3.3.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E22.m1.3.3.1.1.1.1.1.1.2" xref="A1.E22.m1.3.3.1.1.1.1.1.1.2.cmml">𝒢</mi><mrow id="A1.E22.m1.2.2.2.4" xref="A1.E22.m1.2.2.2.3.cmml"><mi id="A1.E22.m1.1.1.1.1" mathvariant="normal" xref="A1.E22.m1.1.1.1.1.cmml">ℓ</mi><mo id="A1.E22.m1.2.2.2.4.1" xref="A1.E22.m1.2.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A1.E22.m1.2.2.2.2" xref="A1.E22.m1.2.2.2.2.cmml">ℱ</mi></mrow></msub><mo id="A1.E22.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="A1.E22.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E22.m1.3.3.1.2" xref="A1.E22.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E22.m1.3b"><apply id="A1.E22.m1.3.3.1.1.cmml" xref="A1.E22.m1.3.3.1"><eq id="A1.E22.m1.3.3.1.1.2.cmml" xref="A1.E22.m1.3.3.1.1.2"></eq><csymbol cd="latexml" id="A1.E22.m1.3.3.1.1.3.cmml" xref="A1.E22.m1.3.3.1.1.3">absent</csymbol><apply id="A1.E22.m1.3.3.1.1.1.cmml" xref="A1.E22.m1.3.3.1.1.1"><times id="A1.E22.m1.3.3.1.1.1.2.cmml" xref="A1.E22.m1.3.3.1.1.1.2"></times><apply id="A1.E22.m1.3.3.1.1.1.3.cmml" xref="A1.E22.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A1.E22.m1.3.3.1.1.1.3.1.cmml" xref="A1.E22.m1.3.3.1.1.1.3">subscript</csymbol><ci id="A1.E22.m1.3.3.1.1.1.3.2.cmml" xref="A1.E22.m1.3.3.1.1.1.3.2">ℜ</ci><apply id="A1.E22.m1.3.3.1.1.1.3.3.cmml" xref="A1.E22.m1.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E22.m1.3.3.1.1.1.3.3.1.cmml" xref="A1.E22.m1.3.3.1.1.1.3.3">subscript</csymbol><apply id="A1.E22.m1.3.3.1.1.1.3.3.2.cmml" xref="A1.E22.m1.3.3.1.1.1.3.3.2"><ci id="A1.E22.m1.3.3.1.1.1.3.3.2.1.cmml" xref="A1.E22.m1.3.3.1.1.1.3.3.2.1">~</ci><ci id="A1.E22.m1.3.3.1.1.1.3.3.2.2.cmml" xref="A1.E22.m1.3.3.1.1.1.3.3.2.2">𝒮</ci></apply><ci id="A1.E22.m1.3.3.1.1.1.3.3.3.cmml" xref="A1.E22.m1.3.3.1.1.1.3.3.3">𝑛</ci></apply></apply><apply id="A1.E22.m1.3.3.1.1.1.1.1.1.cmml" xref="A1.E22.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E22.m1.3.3.1.1.1.1.1.1.1.cmml" xref="A1.E22.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="A1.E22.m1.3.3.1.1.1.1.1.1.2.cmml" xref="A1.E22.m1.3.3.1.1.1.1.1.1.2">𝒢</ci><list id="A1.E22.m1.2.2.2.3.cmml" xref="A1.E22.m1.2.2.2.4"><ci id="A1.E22.m1.1.1.1.1.cmml" xref="A1.E22.m1.1.1.1.1">ℓ</ci><ci id="A1.E22.m1.2.2.2.2.cmml" xref="A1.E22.m1.2.2.2.2">ℱ</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E22.m1.3c">\displaystyle={\mathfrak{R}}_{\tilde{\mathscr{S}}_{n}}(\mathcal{G}_{\ell,%
\mathcal{F}}),</annotation><annotation encoding="application/x-llamapun" id="A1.E22.m1.3d">= fraktur_R start_POSTSUBSCRIPT over~ start_ARG script_S end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( caligraphic_G start_POSTSUBSCRIPT roman_ℓ , caligraphic_F end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(22)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.1.p1.8">where <math alttext="(i)" class="ltx_Math" display="inline" id="A1.1.p1.4.m1.1"><semantics id="A1.1.p1.4.m1.1a"><mrow id="A1.1.p1.4.m1.1.2.2"><mo id="A1.1.p1.4.m1.1.2.2.1" stretchy="false">(</mo><mi id="A1.1.p1.4.m1.1.1" xref="A1.1.p1.4.m1.1.1.cmml">i</mi><mo id="A1.1.p1.4.m1.1.2.2.2" stretchy="false">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.1.p1.4.m1.1b"><ci id="A1.1.p1.4.m1.1.1.cmml" xref="A1.1.p1.4.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.4.m1.1c">(i)</annotation><annotation encoding="application/x-llamapun" id="A1.1.p1.4.m1.1d">( italic_i )</annotation></semantics></math> follows from definition of <math alttext="\mathcal{G}_{\ell,\mathcal{F}^{g^{\prime}}}" class="ltx_Math" display="inline" id="A1.1.p1.5.m2.2"><semantics id="A1.1.p1.5.m2.2a"><msub id="A1.1.p1.5.m2.2.3" xref="A1.1.p1.5.m2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.1.p1.5.m2.2.3.2" xref="A1.1.p1.5.m2.2.3.2.cmml">𝒢</mi><mrow id="A1.1.p1.5.m2.2.2.2.2" xref="A1.1.p1.5.m2.2.2.2.3.cmml"><mi id="A1.1.p1.5.m2.1.1.1.1" mathvariant="normal" xref="A1.1.p1.5.m2.1.1.1.1.cmml">ℓ</mi><mo id="A1.1.p1.5.m2.2.2.2.2.2" xref="A1.1.p1.5.m2.2.2.2.3.cmml">,</mo><msup id="A1.1.p1.5.m2.2.2.2.2.1" xref="A1.1.p1.5.m2.2.2.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.1.p1.5.m2.2.2.2.2.1.2" xref="A1.1.p1.5.m2.2.2.2.2.1.2.cmml">ℱ</mi><msup id="A1.1.p1.5.m2.2.2.2.2.1.3" xref="A1.1.p1.5.m2.2.2.2.2.1.3.cmml"><mi id="A1.1.p1.5.m2.2.2.2.2.1.3.2" xref="A1.1.p1.5.m2.2.2.2.2.1.3.2.cmml">g</mi><mo id="A1.1.p1.5.m2.2.2.2.2.1.3.3" xref="A1.1.p1.5.m2.2.2.2.2.1.3.3.cmml">′</mo></msup></msup></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.1.p1.5.m2.2b"><apply id="A1.1.p1.5.m2.2.3.cmml" xref="A1.1.p1.5.m2.2.3"><csymbol cd="ambiguous" id="A1.1.p1.5.m2.2.3.1.cmml" xref="A1.1.p1.5.m2.2.3">subscript</csymbol><ci id="A1.1.p1.5.m2.2.3.2.cmml" xref="A1.1.p1.5.m2.2.3.2">𝒢</ci><list id="A1.1.p1.5.m2.2.2.2.3.cmml" xref="A1.1.p1.5.m2.2.2.2.2"><ci id="A1.1.p1.5.m2.1.1.1.1.cmml" xref="A1.1.p1.5.m2.1.1.1.1">ℓ</ci><apply id="A1.1.p1.5.m2.2.2.2.2.1.cmml" xref="A1.1.p1.5.m2.2.2.2.2.1"><csymbol cd="ambiguous" id="A1.1.p1.5.m2.2.2.2.2.1.1.cmml" xref="A1.1.p1.5.m2.2.2.2.2.1">superscript</csymbol><ci id="A1.1.p1.5.m2.2.2.2.2.1.2.cmml" xref="A1.1.p1.5.m2.2.2.2.2.1.2">ℱ</ci><apply id="A1.1.p1.5.m2.2.2.2.2.1.3.cmml" xref="A1.1.p1.5.m2.2.2.2.2.1.3"><csymbol cd="ambiguous" id="A1.1.p1.5.m2.2.2.2.2.1.3.1.cmml" xref="A1.1.p1.5.m2.2.2.2.2.1.3">superscript</csymbol><ci id="A1.1.p1.5.m2.2.2.2.2.1.3.2.cmml" xref="A1.1.p1.5.m2.2.2.2.2.1.3.2">𝑔</ci><ci id="A1.1.p1.5.m2.2.2.2.2.1.3.3.cmml" xref="A1.1.p1.5.m2.2.2.2.2.1.3.3">′</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.5.m2.2c">\mathcal{G}_{\ell,\mathcal{F}^{g^{\prime}}}</annotation><annotation encoding="application/x-llamapun" id="A1.1.p1.5.m2.2d">caligraphic_G start_POSTSUBSCRIPT roman_ℓ , caligraphic_F start_POSTSUPERSCRIPT italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{F}^{g^{\prime}}" class="ltx_Math" display="inline" id="A1.1.p1.6.m3.1"><semantics id="A1.1.p1.6.m3.1a"><msup id="A1.1.p1.6.m3.1.1" xref="A1.1.p1.6.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.1.p1.6.m3.1.1.2" xref="A1.1.p1.6.m3.1.1.2.cmml">ℱ</mi><msup id="A1.1.p1.6.m3.1.1.3" xref="A1.1.p1.6.m3.1.1.3.cmml"><mi id="A1.1.p1.6.m3.1.1.3.2" xref="A1.1.p1.6.m3.1.1.3.2.cmml">g</mi><mo id="A1.1.p1.6.m3.1.1.3.3" xref="A1.1.p1.6.m3.1.1.3.3.cmml">′</mo></msup></msup><annotation-xml encoding="MathML-Content" id="A1.1.p1.6.m3.1b"><apply id="A1.1.p1.6.m3.1.1.cmml" xref="A1.1.p1.6.m3.1.1"><csymbol cd="ambiguous" id="A1.1.p1.6.m3.1.1.1.cmml" xref="A1.1.p1.6.m3.1.1">superscript</csymbol><ci id="A1.1.p1.6.m3.1.1.2.cmml" xref="A1.1.p1.6.m3.1.1.2">ℱ</ci><apply id="A1.1.p1.6.m3.1.1.3.cmml" xref="A1.1.p1.6.m3.1.1.3"><csymbol cd="ambiguous" id="A1.1.p1.6.m3.1.1.3.1.cmml" xref="A1.1.p1.6.m3.1.1.3">superscript</csymbol><ci id="A1.1.p1.6.m3.1.1.3.2.cmml" xref="A1.1.p1.6.m3.1.1.3.2">𝑔</ci><ci id="A1.1.p1.6.m3.1.1.3.3.cmml" xref="A1.1.p1.6.m3.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.6.m3.1c">\mathcal{F}^{g^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="A1.1.p1.6.m3.1d">caligraphic_F start_POSTSUPERSCRIPT italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>; and <math alttext="(ii)" class="ltx_Math" display="inline" id="A1.1.p1.7.m4.1"><semantics id="A1.1.p1.7.m4.1a"><mrow id="A1.1.p1.7.m4.1.1.1" xref="A1.1.p1.7.m4.1.1.1.1.cmml"><mo id="A1.1.p1.7.m4.1.1.1.2" stretchy="false" xref="A1.1.p1.7.m4.1.1.1.1.cmml">(</mo><mrow id="A1.1.p1.7.m4.1.1.1.1" xref="A1.1.p1.7.m4.1.1.1.1.cmml"><mi id="A1.1.p1.7.m4.1.1.1.1.2" xref="A1.1.p1.7.m4.1.1.1.1.2.cmml">i</mi><mo id="A1.1.p1.7.m4.1.1.1.1.1" xref="A1.1.p1.7.m4.1.1.1.1.1.cmml">⁢</mo><mi id="A1.1.p1.7.m4.1.1.1.1.3" xref="A1.1.p1.7.m4.1.1.1.1.3.cmml">i</mi></mrow><mo id="A1.1.p1.7.m4.1.1.1.3" stretchy="false" xref="A1.1.p1.7.m4.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.1.p1.7.m4.1b"><apply id="A1.1.p1.7.m4.1.1.1.1.cmml" xref="A1.1.p1.7.m4.1.1.1"><times id="A1.1.p1.7.m4.1.1.1.1.1.cmml" xref="A1.1.p1.7.m4.1.1.1.1.1"></times><ci id="A1.1.p1.7.m4.1.1.1.1.2.cmml" xref="A1.1.p1.7.m4.1.1.1.1.2">𝑖</ci><ci id="A1.1.p1.7.m4.1.1.1.1.3.cmml" xref="A1.1.p1.7.m4.1.1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.7.m4.1c">(ii)</annotation><annotation encoding="application/x-llamapun" id="A1.1.p1.7.m4.1d">( italic_i italic_i )</annotation></semantics></math> holds because <math alttext="\mathcal{F}^{g^{\prime}}\subset\mathcal{F}" class="ltx_Math" display="inline" id="A1.1.p1.8.m5.1"><semantics id="A1.1.p1.8.m5.1a"><mrow id="A1.1.p1.8.m5.1.1" xref="A1.1.p1.8.m5.1.1.cmml"><msup id="A1.1.p1.8.m5.1.1.2" xref="A1.1.p1.8.m5.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.1.p1.8.m5.1.1.2.2" xref="A1.1.p1.8.m5.1.1.2.2.cmml">ℱ</mi><msup id="A1.1.p1.8.m5.1.1.2.3" xref="A1.1.p1.8.m5.1.1.2.3.cmml"><mi id="A1.1.p1.8.m5.1.1.2.3.2" xref="A1.1.p1.8.m5.1.1.2.3.2.cmml">g</mi><mo id="A1.1.p1.8.m5.1.1.2.3.3" xref="A1.1.p1.8.m5.1.1.2.3.3.cmml">′</mo></msup></msup><mo id="A1.1.p1.8.m5.1.1.1" xref="A1.1.p1.8.m5.1.1.1.cmml">⊂</mo><mi class="ltx_font_mathcaligraphic" id="A1.1.p1.8.m5.1.1.3" xref="A1.1.p1.8.m5.1.1.3.cmml">ℱ</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.1.p1.8.m5.1b"><apply id="A1.1.p1.8.m5.1.1.cmml" xref="A1.1.p1.8.m5.1.1"><subset id="A1.1.p1.8.m5.1.1.1.cmml" xref="A1.1.p1.8.m5.1.1.1"></subset><apply id="A1.1.p1.8.m5.1.1.2.cmml" xref="A1.1.p1.8.m5.1.1.2"><csymbol cd="ambiguous" id="A1.1.p1.8.m5.1.1.2.1.cmml" xref="A1.1.p1.8.m5.1.1.2">superscript</csymbol><ci id="A1.1.p1.8.m5.1.1.2.2.cmml" xref="A1.1.p1.8.m5.1.1.2.2">ℱ</ci><apply id="A1.1.p1.8.m5.1.1.2.3.cmml" xref="A1.1.p1.8.m5.1.1.2.3"><csymbol cd="ambiguous" id="A1.1.p1.8.m5.1.1.2.3.1.cmml" xref="A1.1.p1.8.m5.1.1.2.3">superscript</csymbol><ci id="A1.1.p1.8.m5.1.1.2.3.2.cmml" xref="A1.1.p1.8.m5.1.1.2.3.2">𝑔</ci><ci id="A1.1.p1.8.m5.1.1.2.3.3.cmml" xref="A1.1.p1.8.m5.1.1.2.3.3">′</ci></apply></apply><ci id="A1.1.p1.8.m5.1.1.3.cmml" xref="A1.1.p1.8.m5.1.1.3">ℱ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.8.m5.1c">\mathcal{F}^{g^{\prime}}\subset\mathcal{F}</annotation><annotation encoding="application/x-llamapun" id="A1.1.p1.8.m5.1d">caligraphic_F start_POSTSUPERSCRIPT italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT ⊂ caligraphic_F</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="A1.2.p2">
<p class="ltx_p" id="A1.2.p2.1">Now, the standard concentration results for empirical Rademacher complexity implies that, with probability at least <math alttext="1-\delta" class="ltx_Math" display="inline" id="A1.2.p2.1.m1.1"><semantics id="A1.2.p2.1.m1.1a"><mrow id="A1.2.p2.1.m1.1.1" xref="A1.2.p2.1.m1.1.1.cmml"><mn id="A1.2.p2.1.m1.1.1.2" xref="A1.2.p2.1.m1.1.1.2.cmml">1</mn><mo id="A1.2.p2.1.m1.1.1.1" xref="A1.2.p2.1.m1.1.1.1.cmml">−</mo><mi id="A1.2.p2.1.m1.1.1.3" xref="A1.2.p2.1.m1.1.1.3.cmml">δ</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.2.p2.1.m1.1b"><apply id="A1.2.p2.1.m1.1.1.cmml" xref="A1.2.p2.1.m1.1.1"><minus id="A1.2.p2.1.m1.1.1.1.cmml" xref="A1.2.p2.1.m1.1.1.1"></minus><cn id="A1.2.p2.1.m1.1.1.2.cmml" type="integer" xref="A1.2.p2.1.m1.1.1.2">1</cn><ci id="A1.2.p2.1.m1.1.1.3.cmml" xref="A1.2.p2.1.m1.1.1.3">𝛿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.2.p2.1.m1.1c">1-\delta</annotation><annotation encoding="application/x-llamapun" id="A1.2.p2.1.m1.1d">1 - italic_δ</annotation></semantics></math>, we have the following.</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A2.EGx7">
<tbody id="A1.E23"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle{\mathfrak{R}}_{\tilde{\mathscr{S}}_{n}}(\mathcal{G}_{\ell,%
\mathcal{F}^{g^{\prime}}})" class="ltx_Math" display="inline" id="A1.E23.m1.3"><semantics id="A1.E23.m1.3a"><mrow id="A1.E23.m1.3.3" xref="A1.E23.m1.3.3.cmml"><msub id="A1.E23.m1.3.3.3" xref="A1.E23.m1.3.3.3.cmml"><mi id="A1.E23.m1.3.3.3.2" xref="A1.E23.m1.3.3.3.2.cmml">ℜ</mi><msub id="A1.E23.m1.3.3.3.3" xref="A1.E23.m1.3.3.3.3.cmml"><mover accent="true" id="A1.E23.m1.3.3.3.3.2" xref="A1.E23.m1.3.3.3.3.2.cmml"><mi class="ltx_font_mathscript" id="A1.E23.m1.3.3.3.3.2.2" xref="A1.E23.m1.3.3.3.3.2.2.cmml">𝒮</mi><mo id="A1.E23.m1.3.3.3.3.2.1" xref="A1.E23.m1.3.3.3.3.2.1.cmml">~</mo></mover><mi id="A1.E23.m1.3.3.3.3.3" xref="A1.E23.m1.3.3.3.3.3.cmml">n</mi></msub></msub><mo id="A1.E23.m1.3.3.2" xref="A1.E23.m1.3.3.2.cmml">⁢</mo><mrow id="A1.E23.m1.3.3.1.1" xref="A1.E23.m1.3.3.1.1.1.cmml"><mo id="A1.E23.m1.3.3.1.1.2" stretchy="false" xref="A1.E23.m1.3.3.1.1.1.cmml">(</mo><msub id="A1.E23.m1.3.3.1.1.1" xref="A1.E23.m1.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E23.m1.3.3.1.1.1.2" xref="A1.E23.m1.3.3.1.1.1.2.cmml">𝒢</mi><mrow id="A1.E23.m1.2.2.2.2" xref="A1.E23.m1.2.2.2.3.cmml"><mi id="A1.E23.m1.1.1.1.1" mathvariant="normal" xref="A1.E23.m1.1.1.1.1.cmml">ℓ</mi><mo id="A1.E23.m1.2.2.2.2.2" xref="A1.E23.m1.2.2.2.3.cmml">,</mo><msup id="A1.E23.m1.2.2.2.2.1" xref="A1.E23.m1.2.2.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E23.m1.2.2.2.2.1.2" xref="A1.E23.m1.2.2.2.2.1.2.cmml">ℱ</mi><msup id="A1.E23.m1.2.2.2.2.1.3" xref="A1.E23.m1.2.2.2.2.1.3.cmml"><mi id="A1.E23.m1.2.2.2.2.1.3.2" xref="A1.E23.m1.2.2.2.2.1.3.2.cmml">g</mi><mo id="A1.E23.m1.2.2.2.2.1.3.3" xref="A1.E23.m1.2.2.2.2.1.3.3.cmml">′</mo></msup></msup></mrow></msub><mo id="A1.E23.m1.3.3.1.1.3" stretchy="false" xref="A1.E23.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E23.m1.3b"><apply id="A1.E23.m1.3.3.cmml" xref="A1.E23.m1.3.3"><times id="A1.E23.m1.3.3.2.cmml" xref="A1.E23.m1.3.3.2"></times><apply id="A1.E23.m1.3.3.3.cmml" xref="A1.E23.m1.3.3.3"><csymbol cd="ambiguous" id="A1.E23.m1.3.3.3.1.cmml" xref="A1.E23.m1.3.3.3">subscript</csymbol><ci id="A1.E23.m1.3.3.3.2.cmml" xref="A1.E23.m1.3.3.3.2">ℜ</ci><apply id="A1.E23.m1.3.3.3.3.cmml" xref="A1.E23.m1.3.3.3.3"><csymbol cd="ambiguous" id="A1.E23.m1.3.3.3.3.1.cmml" xref="A1.E23.m1.3.3.3.3">subscript</csymbol><apply id="A1.E23.m1.3.3.3.3.2.cmml" xref="A1.E23.m1.3.3.3.3.2"><ci id="A1.E23.m1.3.3.3.3.2.1.cmml" xref="A1.E23.m1.3.3.3.3.2.1">~</ci><ci id="A1.E23.m1.3.3.3.3.2.2.cmml" xref="A1.E23.m1.3.3.3.3.2.2">𝒮</ci></apply><ci id="A1.E23.m1.3.3.3.3.3.cmml" xref="A1.E23.m1.3.3.3.3.3">𝑛</ci></apply></apply><apply id="A1.E23.m1.3.3.1.1.1.cmml" xref="A1.E23.m1.3.3.1.1"><csymbol cd="ambiguous" id="A1.E23.m1.3.3.1.1.1.1.cmml" xref="A1.E23.m1.3.3.1.1">subscript</csymbol><ci id="A1.E23.m1.3.3.1.1.1.2.cmml" xref="A1.E23.m1.3.3.1.1.1.2">𝒢</ci><list id="A1.E23.m1.2.2.2.3.cmml" xref="A1.E23.m1.2.2.2.2"><ci id="A1.E23.m1.1.1.1.1.cmml" xref="A1.E23.m1.1.1.1.1">ℓ</ci><apply id="A1.E23.m1.2.2.2.2.1.cmml" xref="A1.E23.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="A1.E23.m1.2.2.2.2.1.1.cmml" xref="A1.E23.m1.2.2.2.2.1">superscript</csymbol><ci id="A1.E23.m1.2.2.2.2.1.2.cmml" xref="A1.E23.m1.2.2.2.2.1.2">ℱ</ci><apply id="A1.E23.m1.2.2.2.2.1.3.cmml" xref="A1.E23.m1.2.2.2.2.1.3"><csymbol cd="ambiguous" id="A1.E23.m1.2.2.2.2.1.3.1.cmml" xref="A1.E23.m1.2.2.2.2.1.3">superscript</csymbol><ci id="A1.E23.m1.2.2.2.2.1.3.2.cmml" xref="A1.E23.m1.2.2.2.2.1.3.2">𝑔</ci><ci id="A1.E23.m1.2.2.2.2.1.3.3.cmml" xref="A1.E23.m1.2.2.2.2.1.3.3">′</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E23.m1.3c">\displaystyle{\mathfrak{R}}_{\tilde{\mathscr{S}}_{n}}(\mathcal{G}_{\ell,%
\mathcal{F}^{g^{\prime}}})</annotation><annotation encoding="application/x-llamapun" id="A1.E23.m1.3d">fraktur_R start_POSTSUBSCRIPT over~ start_ARG script_S end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( caligraphic_G start_POSTSUBSCRIPT roman_ℓ , caligraphic_F start_POSTSUPERSCRIPT italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\leq\mathbb{E}_{\tilde{\mathscr{S}}_{n}\sim\tilde{\mathscr{D}}^{%
\otimes n}_{Y}}\left[\mathfrak{R}_{\tilde{\mathscr{S}}_{n}}(\mathcal{G}_{\ell,%
\mathcal{F}^{g^{\prime}}})\right]+\mathcal{O}\Big{(}\sqrt{{\frac{\log(1/\delta%
)}{n}}}\Big{)}" class="ltx_Math" display="inline" id="A1.E23.m2.5"><semantics id="A1.E23.m2.5a"><mrow id="A1.E23.m2.5.5" xref="A1.E23.m2.5.5.cmml"><mi id="A1.E23.m2.5.5.3" xref="A1.E23.m2.5.5.3.cmml"></mi><mo id="A1.E23.m2.5.5.2" xref="A1.E23.m2.5.5.2.cmml">≤</mo><mrow id="A1.E23.m2.5.5.1" xref="A1.E23.m2.5.5.1.cmml"><mrow id="A1.E23.m2.5.5.1.1" xref="A1.E23.m2.5.5.1.1.cmml"><msub id="A1.E23.m2.5.5.1.1.3" xref="A1.E23.m2.5.5.1.1.3.cmml"><mi id="A1.E23.m2.5.5.1.1.3.2" xref="A1.E23.m2.5.5.1.1.3.2.cmml">𝔼</mi><mrow id="A1.E23.m2.5.5.1.1.3.3" xref="A1.E23.m2.5.5.1.1.3.3.cmml"><msub id="A1.E23.m2.5.5.1.1.3.3.2" xref="A1.E23.m2.5.5.1.1.3.3.2.cmml"><mover accent="true" id="A1.E23.m2.5.5.1.1.3.3.2.2" xref="A1.E23.m2.5.5.1.1.3.3.2.2.cmml"><mi class="ltx_font_mathscript" id="A1.E23.m2.5.5.1.1.3.3.2.2.2" xref="A1.E23.m2.5.5.1.1.3.3.2.2.2.cmml">𝒮</mi><mo id="A1.E23.m2.5.5.1.1.3.3.2.2.1" xref="A1.E23.m2.5.5.1.1.3.3.2.2.1.cmml">~</mo></mover><mi id="A1.E23.m2.5.5.1.1.3.3.2.3" xref="A1.E23.m2.5.5.1.1.3.3.2.3.cmml">n</mi></msub><mo id="A1.E23.m2.5.5.1.1.3.3.1" xref="A1.E23.m2.5.5.1.1.3.3.1.cmml">∼</mo><msubsup id="A1.E23.m2.5.5.1.1.3.3.3" xref="A1.E23.m2.5.5.1.1.3.3.3.cmml"><mover accent="true" id="A1.E23.m2.5.5.1.1.3.3.3.2.2" xref="A1.E23.m2.5.5.1.1.3.3.3.2.2.cmml"><mi class="ltx_font_mathscript" id="A1.E23.m2.5.5.1.1.3.3.3.2.2.2" xref="A1.E23.m2.5.5.1.1.3.3.3.2.2.2.cmml">𝒟</mi><mo id="A1.E23.m2.5.5.1.1.3.3.3.2.2.1" xref="A1.E23.m2.5.5.1.1.3.3.3.2.2.1.cmml">~</mo></mover><mi id="A1.E23.m2.5.5.1.1.3.3.3.3" xref="A1.E23.m2.5.5.1.1.3.3.3.3.cmml">Y</mi><mrow id="A1.E23.m2.5.5.1.1.3.3.3.2.3" xref="A1.E23.m2.5.5.1.1.3.3.3.2.3.cmml"><mi id="A1.E23.m2.5.5.1.1.3.3.3.2.3.2" xref="A1.E23.m2.5.5.1.1.3.3.3.2.3.2.cmml"></mi><mo id="A1.E23.m2.5.5.1.1.3.3.3.2.3.1" lspace="0.222em" rspace="0.222em" xref="A1.E23.m2.5.5.1.1.3.3.3.2.3.1.cmml">⊗</mo><mi id="A1.E23.m2.5.5.1.1.3.3.3.2.3.3" xref="A1.E23.m2.5.5.1.1.3.3.3.2.3.3.cmml">n</mi></mrow></msubsup></mrow></msub><mo id="A1.E23.m2.5.5.1.1.2" xref="A1.E23.m2.5.5.1.1.2.cmml">⁢</mo><mrow id="A1.E23.m2.5.5.1.1.1.1" xref="A1.E23.m2.5.5.1.1.1.2.cmml"><mo id="A1.E23.m2.5.5.1.1.1.1.2" xref="A1.E23.m2.5.5.1.1.1.2.1.cmml">[</mo><mrow id="A1.E23.m2.5.5.1.1.1.1.1" xref="A1.E23.m2.5.5.1.1.1.1.1.cmml"><msub id="A1.E23.m2.5.5.1.1.1.1.1.3" xref="A1.E23.m2.5.5.1.1.1.1.1.3.cmml"><mi id="A1.E23.m2.5.5.1.1.1.1.1.3.2" xref="A1.E23.m2.5.5.1.1.1.1.1.3.2.cmml">ℜ</mi><msub id="A1.E23.m2.5.5.1.1.1.1.1.3.3" xref="A1.E23.m2.5.5.1.1.1.1.1.3.3.cmml"><mover accent="true" id="A1.E23.m2.5.5.1.1.1.1.1.3.3.2" xref="A1.E23.m2.5.5.1.1.1.1.1.3.3.2.cmml"><mi class="ltx_font_mathscript" id="A1.E23.m2.5.5.1.1.1.1.1.3.3.2.2" xref="A1.E23.m2.5.5.1.1.1.1.1.3.3.2.2.cmml">𝒮</mi><mo id="A1.E23.m2.5.5.1.1.1.1.1.3.3.2.1" xref="A1.E23.m2.5.5.1.1.1.1.1.3.3.2.1.cmml">~</mo></mover><mi id="A1.E23.m2.5.5.1.1.1.1.1.3.3.3" xref="A1.E23.m2.5.5.1.1.1.1.1.3.3.3.cmml">n</mi></msub></msub><mo id="A1.E23.m2.5.5.1.1.1.1.1.2" xref="A1.E23.m2.5.5.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E23.m2.5.5.1.1.1.1.1.1.1" xref="A1.E23.m2.5.5.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E23.m2.5.5.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E23.m2.5.5.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E23.m2.5.5.1.1.1.1.1.1.1.1" xref="A1.E23.m2.5.5.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E23.m2.5.5.1.1.1.1.1.1.1.1.2" xref="A1.E23.m2.5.5.1.1.1.1.1.1.1.1.2.cmml">𝒢</mi><mrow id="A1.E23.m2.2.2.2.2" xref="A1.E23.m2.2.2.2.3.cmml"><mi id="A1.E23.m2.1.1.1.1" mathvariant="normal" xref="A1.E23.m2.1.1.1.1.cmml">ℓ</mi><mo id="A1.E23.m2.2.2.2.2.2" xref="A1.E23.m2.2.2.2.3.cmml">,</mo><msup id="A1.E23.m2.2.2.2.2.1" xref="A1.E23.m2.2.2.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E23.m2.2.2.2.2.1.2" xref="A1.E23.m2.2.2.2.2.1.2.cmml">ℱ</mi><msup id="A1.E23.m2.2.2.2.2.1.3" xref="A1.E23.m2.2.2.2.2.1.3.cmml"><mi id="A1.E23.m2.2.2.2.2.1.3.2" xref="A1.E23.m2.2.2.2.2.1.3.2.cmml">g</mi><mo id="A1.E23.m2.2.2.2.2.1.3.3" xref="A1.E23.m2.2.2.2.2.1.3.3.cmml">′</mo></msup></msup></mrow></msub><mo id="A1.E23.m2.5.5.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E23.m2.5.5.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E23.m2.5.5.1.1.1.1.3" xref="A1.E23.m2.5.5.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E23.m2.5.5.1.2" xref="A1.E23.m2.5.5.1.2.cmml">+</mo><mrow id="A1.E23.m2.5.5.1.3" xref="A1.E23.m2.5.5.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E23.m2.5.5.1.3.2" xref="A1.E23.m2.5.5.1.3.2.cmml">𝒪</mi><mo id="A1.E23.m2.5.5.1.3.1" xref="A1.E23.m2.5.5.1.3.1.cmml">⁢</mo><mrow id="A1.E23.m2.5.5.1.3.3.2" xref="A1.E23.m2.4.4.cmml"><mo id="A1.E23.m2.5.5.1.3.3.2.1" maxsize="160%" minsize="160%" xref="A1.E23.m2.4.4.cmml">(</mo><msqrt id="A1.E23.m2.4.4" xref="A1.E23.m2.4.4.cmml"><mstyle displaystyle="true" id="A1.E23.m2.4.4.2" xref="A1.E23.m2.4.4.2.cmml"><mfrac id="A1.E23.m2.4.4.2a" xref="A1.E23.m2.4.4.2.cmml"><mrow id="A1.E23.m2.4.4.2.2.2.2" xref="A1.E23.m2.4.4.2.2.2.3.cmml"><mi id="A1.E23.m2.3.3.1.1.1.1" xref="A1.E23.m2.3.3.1.1.1.1.cmml">log</mi><mo id="A1.E23.m2.4.4.2.2.2.2a" xref="A1.E23.m2.4.4.2.2.2.3.cmml">⁡</mo><mrow id="A1.E23.m2.4.4.2.2.2.2.1" xref="A1.E23.m2.4.4.2.2.2.3.cmml"><mo id="A1.E23.m2.4.4.2.2.2.2.1.2" stretchy="false" xref="A1.E23.m2.4.4.2.2.2.3.cmml">(</mo><mrow id="A1.E23.m2.4.4.2.2.2.2.1.1" xref="A1.E23.m2.4.4.2.2.2.2.1.1.cmml"><mn id="A1.E23.m2.4.4.2.2.2.2.1.1.2" xref="A1.E23.m2.4.4.2.2.2.2.1.1.2.cmml">1</mn><mo id="A1.E23.m2.4.4.2.2.2.2.1.1.1" xref="A1.E23.m2.4.4.2.2.2.2.1.1.1.cmml">/</mo><mi id="A1.E23.m2.4.4.2.2.2.2.1.1.3" xref="A1.E23.m2.4.4.2.2.2.2.1.1.3.cmml">δ</mi></mrow><mo id="A1.E23.m2.4.4.2.2.2.2.1.3" stretchy="false" xref="A1.E23.m2.4.4.2.2.2.3.cmml">)</mo></mrow></mrow><mi id="A1.E23.m2.4.4.2.4" xref="A1.E23.m2.4.4.2.4.cmml">n</mi></mfrac></mstyle></msqrt><mo id="A1.E23.m2.5.5.1.3.3.2.2" maxsize="160%" minsize="160%" xref="A1.E23.m2.4.4.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E23.m2.5b"><apply id="A1.E23.m2.5.5.cmml" xref="A1.E23.m2.5.5"><leq id="A1.E23.m2.5.5.2.cmml" xref="A1.E23.m2.5.5.2"></leq><csymbol cd="latexml" id="A1.E23.m2.5.5.3.cmml" xref="A1.E23.m2.5.5.3">absent</csymbol><apply id="A1.E23.m2.5.5.1.cmml" xref="A1.E23.m2.5.5.1"><plus id="A1.E23.m2.5.5.1.2.cmml" xref="A1.E23.m2.5.5.1.2"></plus><apply id="A1.E23.m2.5.5.1.1.cmml" xref="A1.E23.m2.5.5.1.1"><times id="A1.E23.m2.5.5.1.1.2.cmml" xref="A1.E23.m2.5.5.1.1.2"></times><apply id="A1.E23.m2.5.5.1.1.3.cmml" xref="A1.E23.m2.5.5.1.1.3"><csymbol cd="ambiguous" id="A1.E23.m2.5.5.1.1.3.1.cmml" xref="A1.E23.m2.5.5.1.1.3">subscript</csymbol><ci id="A1.E23.m2.5.5.1.1.3.2.cmml" xref="A1.E23.m2.5.5.1.1.3.2">𝔼</ci><apply id="A1.E23.m2.5.5.1.1.3.3.cmml" xref="A1.E23.m2.5.5.1.1.3.3"><csymbol cd="latexml" id="A1.E23.m2.5.5.1.1.3.3.1.cmml" xref="A1.E23.m2.5.5.1.1.3.3.1">similar-to</csymbol><apply id="A1.E23.m2.5.5.1.1.3.3.2.cmml" xref="A1.E23.m2.5.5.1.1.3.3.2"><csymbol cd="ambiguous" id="A1.E23.m2.5.5.1.1.3.3.2.1.cmml" xref="A1.E23.m2.5.5.1.1.3.3.2">subscript</csymbol><apply id="A1.E23.m2.5.5.1.1.3.3.2.2.cmml" xref="A1.E23.m2.5.5.1.1.3.3.2.2"><ci id="A1.E23.m2.5.5.1.1.3.3.2.2.1.cmml" xref="A1.E23.m2.5.5.1.1.3.3.2.2.1">~</ci><ci id="A1.E23.m2.5.5.1.1.3.3.2.2.2.cmml" xref="A1.E23.m2.5.5.1.1.3.3.2.2.2">𝒮</ci></apply><ci id="A1.E23.m2.5.5.1.1.3.3.2.3.cmml" xref="A1.E23.m2.5.5.1.1.3.3.2.3">𝑛</ci></apply><apply id="A1.E23.m2.5.5.1.1.3.3.3.cmml" xref="A1.E23.m2.5.5.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.E23.m2.5.5.1.1.3.3.3.1.cmml" xref="A1.E23.m2.5.5.1.1.3.3.3">subscript</csymbol><apply id="A1.E23.m2.5.5.1.1.3.3.3.2.cmml" xref="A1.E23.m2.5.5.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.E23.m2.5.5.1.1.3.3.3.2.1.cmml" xref="A1.E23.m2.5.5.1.1.3.3.3">superscript</csymbol><apply id="A1.E23.m2.5.5.1.1.3.3.3.2.2.cmml" xref="A1.E23.m2.5.5.1.1.3.3.3.2.2"><ci id="A1.E23.m2.5.5.1.1.3.3.3.2.2.1.cmml" xref="A1.E23.m2.5.5.1.1.3.3.3.2.2.1">~</ci><ci id="A1.E23.m2.5.5.1.1.3.3.3.2.2.2.cmml" xref="A1.E23.m2.5.5.1.1.3.3.3.2.2.2">𝒟</ci></apply><apply id="A1.E23.m2.5.5.1.1.3.3.3.2.3.cmml" xref="A1.E23.m2.5.5.1.1.3.3.3.2.3"><csymbol cd="latexml" id="A1.E23.m2.5.5.1.1.3.3.3.2.3.1.cmml" xref="A1.E23.m2.5.5.1.1.3.3.3.2.3.1">tensor-product</csymbol><csymbol cd="latexml" id="A1.E23.m2.5.5.1.1.3.3.3.2.3.2.cmml" xref="A1.E23.m2.5.5.1.1.3.3.3.2.3.2">absent</csymbol><ci id="A1.E23.m2.5.5.1.1.3.3.3.2.3.3.cmml" xref="A1.E23.m2.5.5.1.1.3.3.3.2.3.3">𝑛</ci></apply></apply><ci id="A1.E23.m2.5.5.1.1.3.3.3.3.cmml" xref="A1.E23.m2.5.5.1.1.3.3.3.3">𝑌</ci></apply></apply></apply><apply id="A1.E23.m2.5.5.1.1.1.2.cmml" xref="A1.E23.m2.5.5.1.1.1.1"><csymbol cd="latexml" id="A1.E23.m2.5.5.1.1.1.2.1.cmml" xref="A1.E23.m2.5.5.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E23.m2.5.5.1.1.1.1.1.cmml" xref="A1.E23.m2.5.5.1.1.1.1.1"><times id="A1.E23.m2.5.5.1.1.1.1.1.2.cmml" xref="A1.E23.m2.5.5.1.1.1.1.1.2"></times><apply id="A1.E23.m2.5.5.1.1.1.1.1.3.cmml" xref="A1.E23.m2.5.5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E23.m2.5.5.1.1.1.1.1.3.1.cmml" xref="A1.E23.m2.5.5.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E23.m2.5.5.1.1.1.1.1.3.2.cmml" xref="A1.E23.m2.5.5.1.1.1.1.1.3.2">ℜ</ci><apply id="A1.E23.m2.5.5.1.1.1.1.1.3.3.cmml" xref="A1.E23.m2.5.5.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E23.m2.5.5.1.1.1.1.1.3.3.1.cmml" xref="A1.E23.m2.5.5.1.1.1.1.1.3.3">subscript</csymbol><apply id="A1.E23.m2.5.5.1.1.1.1.1.3.3.2.cmml" xref="A1.E23.m2.5.5.1.1.1.1.1.3.3.2"><ci id="A1.E23.m2.5.5.1.1.1.1.1.3.3.2.1.cmml" xref="A1.E23.m2.5.5.1.1.1.1.1.3.3.2.1">~</ci><ci id="A1.E23.m2.5.5.1.1.1.1.1.3.3.2.2.cmml" xref="A1.E23.m2.5.5.1.1.1.1.1.3.3.2.2">𝒮</ci></apply><ci id="A1.E23.m2.5.5.1.1.1.1.1.3.3.3.cmml" xref="A1.E23.m2.5.5.1.1.1.1.1.3.3.3">𝑛</ci></apply></apply><apply id="A1.E23.m2.5.5.1.1.1.1.1.1.1.1.cmml" xref="A1.E23.m2.5.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E23.m2.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E23.m2.5.5.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E23.m2.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E23.m2.5.5.1.1.1.1.1.1.1.1.2">𝒢</ci><list id="A1.E23.m2.2.2.2.3.cmml" xref="A1.E23.m2.2.2.2.2"><ci id="A1.E23.m2.1.1.1.1.cmml" xref="A1.E23.m2.1.1.1.1">ℓ</ci><apply id="A1.E23.m2.2.2.2.2.1.cmml" xref="A1.E23.m2.2.2.2.2.1"><csymbol cd="ambiguous" id="A1.E23.m2.2.2.2.2.1.1.cmml" xref="A1.E23.m2.2.2.2.2.1">superscript</csymbol><ci id="A1.E23.m2.2.2.2.2.1.2.cmml" xref="A1.E23.m2.2.2.2.2.1.2">ℱ</ci><apply id="A1.E23.m2.2.2.2.2.1.3.cmml" xref="A1.E23.m2.2.2.2.2.1.3"><csymbol cd="ambiguous" id="A1.E23.m2.2.2.2.2.1.3.1.cmml" xref="A1.E23.m2.2.2.2.2.1.3">superscript</csymbol><ci id="A1.E23.m2.2.2.2.2.1.3.2.cmml" xref="A1.E23.m2.2.2.2.2.1.3.2">𝑔</ci><ci id="A1.E23.m2.2.2.2.2.1.3.3.cmml" xref="A1.E23.m2.2.2.2.2.1.3.3">′</ci></apply></apply></list></apply></apply></apply></apply><apply id="A1.E23.m2.5.5.1.3.cmml" xref="A1.E23.m2.5.5.1.3"><times id="A1.E23.m2.5.5.1.3.1.cmml" xref="A1.E23.m2.5.5.1.3.1"></times><ci id="A1.E23.m2.5.5.1.3.2.cmml" xref="A1.E23.m2.5.5.1.3.2">𝒪</ci><apply id="A1.E23.m2.4.4.cmml" xref="A1.E23.m2.5.5.1.3.3.2"><root id="A1.E23.m2.4.4a.cmml" xref="A1.E23.m2.5.5.1.3.3.2"></root><apply id="A1.E23.m2.4.4.2.cmml" xref="A1.E23.m2.4.4.2"><divide id="A1.E23.m2.4.4.2.3.cmml" xref="A1.E23.m2.4.4.2"></divide><apply id="A1.E23.m2.4.4.2.2.2.3.cmml" xref="A1.E23.m2.4.4.2.2.2.2"><log id="A1.E23.m2.3.3.1.1.1.1.cmml" xref="A1.E23.m2.3.3.1.1.1.1"></log><apply id="A1.E23.m2.4.4.2.2.2.2.1.1.cmml" xref="A1.E23.m2.4.4.2.2.2.2.1.1"><divide id="A1.E23.m2.4.4.2.2.2.2.1.1.1.cmml" xref="A1.E23.m2.4.4.2.2.2.2.1.1.1"></divide><cn id="A1.E23.m2.4.4.2.2.2.2.1.1.2.cmml" type="integer" xref="A1.E23.m2.4.4.2.2.2.2.1.1.2">1</cn><ci id="A1.E23.m2.4.4.2.2.2.2.1.1.3.cmml" xref="A1.E23.m2.4.4.2.2.2.2.1.1.3">𝛿</ci></apply></apply><ci id="A1.E23.m2.4.4.2.4.cmml" xref="A1.E23.m2.4.4.2.4">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E23.m2.5c">\displaystyle\leq\mathbb{E}_{\tilde{\mathscr{S}}_{n}\sim\tilde{\mathscr{D}}^{%
\otimes n}_{Y}}\left[\mathfrak{R}_{\tilde{\mathscr{S}}_{n}}(\mathcal{G}_{\ell,%
\mathcal{F}^{g^{\prime}}})\right]+\mathcal{O}\Big{(}\sqrt{{\frac{\log(1/\delta%
)}{n}}}\Big{)}</annotation><annotation encoding="application/x-llamapun" id="A1.E23.m2.5d">≤ blackboard_E start_POSTSUBSCRIPT over~ start_ARG script_S end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ∼ over~ start_ARG script_D end_ARG start_POSTSUPERSCRIPT ⊗ italic_n end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ fraktur_R start_POSTSUBSCRIPT over~ start_ARG script_S end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( caligraphic_G start_POSTSUBSCRIPT roman_ℓ , caligraphic_F start_POSTSUPERSCRIPT italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ) ] + caligraphic_O ( square-root start_ARG divide start_ARG roman_log ( 1 / italic_δ ) end_ARG start_ARG italic_n end_ARG end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(23)</span></td>
</tr></tbody>
<tbody id="A1.E24"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\tilde{\mathfrak{R}}_{n}(\mathcal{G}_{\ell,\mathcal{F}^{g^{%
\prime}}})+\mathcal{O}\Big{(}\sqrt{{\frac{\log(1/\delta)}{n}}}\Big{)}." class="ltx_Math" display="inline" id="A1.E24.m1.5"><semantics id="A1.E24.m1.5a"><mrow id="A1.E24.m1.5.5.1" xref="A1.E24.m1.5.5.1.1.cmml"><mrow id="A1.E24.m1.5.5.1.1" xref="A1.E24.m1.5.5.1.1.cmml"><mi id="A1.E24.m1.5.5.1.1.3" xref="A1.E24.m1.5.5.1.1.3.cmml"></mi><mo id="A1.E24.m1.5.5.1.1.2" xref="A1.E24.m1.5.5.1.1.2.cmml">=</mo><mrow id="A1.E24.m1.5.5.1.1.1" xref="A1.E24.m1.5.5.1.1.1.cmml"><mrow id="A1.E24.m1.5.5.1.1.1.1" xref="A1.E24.m1.5.5.1.1.1.1.cmml"><msub id="A1.E24.m1.5.5.1.1.1.1.3" xref="A1.E24.m1.5.5.1.1.1.1.3.cmml"><mover accent="true" id="A1.E24.m1.5.5.1.1.1.1.3.2" xref="A1.E24.m1.5.5.1.1.1.1.3.2.cmml"><mi id="A1.E24.m1.5.5.1.1.1.1.3.2.2" xref="A1.E24.m1.5.5.1.1.1.1.3.2.2.cmml">ℜ</mi><mo id="A1.E24.m1.5.5.1.1.1.1.3.2.1" xref="A1.E24.m1.5.5.1.1.1.1.3.2.1.cmml">~</mo></mover><mi id="A1.E24.m1.5.5.1.1.1.1.3.3" xref="A1.E24.m1.5.5.1.1.1.1.3.3.cmml">n</mi></msub><mo id="A1.E24.m1.5.5.1.1.1.1.2" xref="A1.E24.m1.5.5.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E24.m1.5.5.1.1.1.1.1.1" xref="A1.E24.m1.5.5.1.1.1.1.1.1.1.cmml"><mo id="A1.E24.m1.5.5.1.1.1.1.1.1.2" stretchy="false" xref="A1.E24.m1.5.5.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E24.m1.5.5.1.1.1.1.1.1.1" xref="A1.E24.m1.5.5.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E24.m1.5.5.1.1.1.1.1.1.1.2" xref="A1.E24.m1.5.5.1.1.1.1.1.1.1.2.cmml">𝒢</mi><mrow id="A1.E24.m1.2.2.2.2" xref="A1.E24.m1.2.2.2.3.cmml"><mi id="A1.E24.m1.1.1.1.1" mathvariant="normal" xref="A1.E24.m1.1.1.1.1.cmml">ℓ</mi><mo id="A1.E24.m1.2.2.2.2.2" xref="A1.E24.m1.2.2.2.3.cmml">,</mo><msup id="A1.E24.m1.2.2.2.2.1" xref="A1.E24.m1.2.2.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E24.m1.2.2.2.2.1.2" xref="A1.E24.m1.2.2.2.2.1.2.cmml">ℱ</mi><msup id="A1.E24.m1.2.2.2.2.1.3" xref="A1.E24.m1.2.2.2.2.1.3.cmml"><mi id="A1.E24.m1.2.2.2.2.1.3.2" xref="A1.E24.m1.2.2.2.2.1.3.2.cmml">g</mi><mo id="A1.E24.m1.2.2.2.2.1.3.3" xref="A1.E24.m1.2.2.2.2.1.3.3.cmml">′</mo></msup></msup></mrow></msub><mo id="A1.E24.m1.5.5.1.1.1.1.1.1.3" stretchy="false" xref="A1.E24.m1.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E24.m1.5.5.1.1.1.2" xref="A1.E24.m1.5.5.1.1.1.2.cmml">+</mo><mrow id="A1.E24.m1.5.5.1.1.1.3" xref="A1.E24.m1.5.5.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E24.m1.5.5.1.1.1.3.2" xref="A1.E24.m1.5.5.1.1.1.3.2.cmml">𝒪</mi><mo id="A1.E24.m1.5.5.1.1.1.3.1" xref="A1.E24.m1.5.5.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.E24.m1.5.5.1.1.1.3.3.2" xref="A1.E24.m1.4.4.cmml"><mo id="A1.E24.m1.5.5.1.1.1.3.3.2.1" maxsize="160%" minsize="160%" xref="A1.E24.m1.4.4.cmml">(</mo><msqrt id="A1.E24.m1.4.4" xref="A1.E24.m1.4.4.cmml"><mstyle displaystyle="true" id="A1.E24.m1.4.4.2" xref="A1.E24.m1.4.4.2.cmml"><mfrac id="A1.E24.m1.4.4.2a" xref="A1.E24.m1.4.4.2.cmml"><mrow id="A1.E24.m1.4.4.2.2.2.2" xref="A1.E24.m1.4.4.2.2.2.3.cmml"><mi id="A1.E24.m1.3.3.1.1.1.1" xref="A1.E24.m1.3.3.1.1.1.1.cmml">log</mi><mo id="A1.E24.m1.4.4.2.2.2.2a" xref="A1.E24.m1.4.4.2.2.2.3.cmml">⁡</mo><mrow id="A1.E24.m1.4.4.2.2.2.2.1" xref="A1.E24.m1.4.4.2.2.2.3.cmml"><mo id="A1.E24.m1.4.4.2.2.2.2.1.2" stretchy="false" xref="A1.E24.m1.4.4.2.2.2.3.cmml">(</mo><mrow id="A1.E24.m1.4.4.2.2.2.2.1.1" xref="A1.E24.m1.4.4.2.2.2.2.1.1.cmml"><mn id="A1.E24.m1.4.4.2.2.2.2.1.1.2" xref="A1.E24.m1.4.4.2.2.2.2.1.1.2.cmml">1</mn><mo id="A1.E24.m1.4.4.2.2.2.2.1.1.1" xref="A1.E24.m1.4.4.2.2.2.2.1.1.1.cmml">/</mo><mi id="A1.E24.m1.4.4.2.2.2.2.1.1.3" xref="A1.E24.m1.4.4.2.2.2.2.1.1.3.cmml">δ</mi></mrow><mo id="A1.E24.m1.4.4.2.2.2.2.1.3" stretchy="false" xref="A1.E24.m1.4.4.2.2.2.3.cmml">)</mo></mrow></mrow><mi id="A1.E24.m1.4.4.2.4" xref="A1.E24.m1.4.4.2.4.cmml">n</mi></mfrac></mstyle></msqrt><mo id="A1.E24.m1.5.5.1.1.1.3.3.2.2" maxsize="160%" minsize="160%" xref="A1.E24.m1.4.4.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E24.m1.5.5.1.2" lspace="0em" xref="A1.E24.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E24.m1.5b"><apply id="A1.E24.m1.5.5.1.1.cmml" xref="A1.E24.m1.5.5.1"><eq id="A1.E24.m1.5.5.1.1.2.cmml" xref="A1.E24.m1.5.5.1.1.2"></eq><csymbol cd="latexml" id="A1.E24.m1.5.5.1.1.3.cmml" xref="A1.E24.m1.5.5.1.1.3">absent</csymbol><apply id="A1.E24.m1.5.5.1.1.1.cmml" xref="A1.E24.m1.5.5.1.1.1"><plus id="A1.E24.m1.5.5.1.1.1.2.cmml" xref="A1.E24.m1.5.5.1.1.1.2"></plus><apply id="A1.E24.m1.5.5.1.1.1.1.cmml" xref="A1.E24.m1.5.5.1.1.1.1"><times id="A1.E24.m1.5.5.1.1.1.1.2.cmml" xref="A1.E24.m1.5.5.1.1.1.1.2"></times><apply id="A1.E24.m1.5.5.1.1.1.1.3.cmml" xref="A1.E24.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E24.m1.5.5.1.1.1.1.3.1.cmml" xref="A1.E24.m1.5.5.1.1.1.1.3">subscript</csymbol><apply id="A1.E24.m1.5.5.1.1.1.1.3.2.cmml" xref="A1.E24.m1.5.5.1.1.1.1.3.2"><ci id="A1.E24.m1.5.5.1.1.1.1.3.2.1.cmml" xref="A1.E24.m1.5.5.1.1.1.1.3.2.1">~</ci><ci id="A1.E24.m1.5.5.1.1.1.1.3.2.2.cmml" xref="A1.E24.m1.5.5.1.1.1.1.3.2.2">ℜ</ci></apply><ci id="A1.E24.m1.5.5.1.1.1.1.3.3.cmml" xref="A1.E24.m1.5.5.1.1.1.1.3.3">𝑛</ci></apply><apply id="A1.E24.m1.5.5.1.1.1.1.1.1.1.cmml" xref="A1.E24.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E24.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="A1.E24.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E24.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="A1.E24.m1.5.5.1.1.1.1.1.1.1.2">𝒢</ci><list id="A1.E24.m1.2.2.2.3.cmml" xref="A1.E24.m1.2.2.2.2"><ci id="A1.E24.m1.1.1.1.1.cmml" xref="A1.E24.m1.1.1.1.1">ℓ</ci><apply id="A1.E24.m1.2.2.2.2.1.cmml" xref="A1.E24.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="A1.E24.m1.2.2.2.2.1.1.cmml" xref="A1.E24.m1.2.2.2.2.1">superscript</csymbol><ci id="A1.E24.m1.2.2.2.2.1.2.cmml" xref="A1.E24.m1.2.2.2.2.1.2">ℱ</ci><apply id="A1.E24.m1.2.2.2.2.1.3.cmml" xref="A1.E24.m1.2.2.2.2.1.3"><csymbol cd="ambiguous" id="A1.E24.m1.2.2.2.2.1.3.1.cmml" xref="A1.E24.m1.2.2.2.2.1.3">superscript</csymbol><ci id="A1.E24.m1.2.2.2.2.1.3.2.cmml" xref="A1.E24.m1.2.2.2.2.1.3.2">𝑔</ci><ci id="A1.E24.m1.2.2.2.2.1.3.3.cmml" xref="A1.E24.m1.2.2.2.2.1.3.3">′</ci></apply></apply></list></apply></apply><apply id="A1.E24.m1.5.5.1.1.1.3.cmml" xref="A1.E24.m1.5.5.1.1.1.3"><times id="A1.E24.m1.5.5.1.1.1.3.1.cmml" xref="A1.E24.m1.5.5.1.1.1.3.1"></times><ci id="A1.E24.m1.5.5.1.1.1.3.2.cmml" xref="A1.E24.m1.5.5.1.1.1.3.2">𝒪</ci><apply id="A1.E24.m1.4.4.cmml" xref="A1.E24.m1.5.5.1.1.1.3.3.2"><root id="A1.E24.m1.4.4a.cmml" xref="A1.E24.m1.5.5.1.1.1.3.3.2"></root><apply id="A1.E24.m1.4.4.2.cmml" xref="A1.E24.m1.4.4.2"><divide id="A1.E24.m1.4.4.2.3.cmml" xref="A1.E24.m1.4.4.2"></divide><apply id="A1.E24.m1.4.4.2.2.2.3.cmml" xref="A1.E24.m1.4.4.2.2.2.2"><log id="A1.E24.m1.3.3.1.1.1.1.cmml" xref="A1.E24.m1.3.3.1.1.1.1"></log><apply id="A1.E24.m1.4.4.2.2.2.2.1.1.cmml" xref="A1.E24.m1.4.4.2.2.2.2.1.1"><divide id="A1.E24.m1.4.4.2.2.2.2.1.1.1.cmml" xref="A1.E24.m1.4.4.2.2.2.2.1.1.1"></divide><cn id="A1.E24.m1.4.4.2.2.2.2.1.1.2.cmml" type="integer" xref="A1.E24.m1.4.4.2.2.2.2.1.1.2">1</cn><ci id="A1.E24.m1.4.4.2.2.2.2.1.1.3.cmml" xref="A1.E24.m1.4.4.2.2.2.2.1.1.3">𝛿</ci></apply></apply><ci id="A1.E24.m1.4.4.2.4.cmml" xref="A1.E24.m1.4.4.2.4">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E24.m1.5c">\displaystyle=\tilde{\mathfrak{R}}_{n}(\mathcal{G}_{\ell,\mathcal{F}^{g^{%
\prime}}})+\mathcal{O}\Big{(}\sqrt{{\frac{\log(1/\delta)}{n}}}\Big{)}.</annotation><annotation encoding="application/x-llamapun" id="A1.E24.m1.5d">= over~ start_ARG fraktur_R end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ( caligraphic_G start_POSTSUBSCRIPT roman_ℓ , caligraphic_F start_POSTSUPERSCRIPT italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ) + caligraphic_O ( square-root start_ARG divide start_ARG roman_log ( 1 / italic_δ ) end_ARG start_ARG italic_n end_ARG end_ARG ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(24)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.3.p3">
<p class="ltx_p" id="A1.3.p3.1">Combining results from Eq. <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#A1.E16" title="In Appendix A Analysis: Proofs ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">16</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#A1.Ex9" title="Appendix A Analysis: Proofs ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">A</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#A1.E23" title="In Proof. ‣ Appendix A Analysis: Proofs ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">23</span></a>, we obtain that with probability at least <math alttext="1-\delta" class="ltx_Math" display="inline" id="A1.3.p3.1.m1.1"><semantics id="A1.3.p3.1.m1.1a"><mrow id="A1.3.p3.1.m1.1.1" xref="A1.3.p3.1.m1.1.1.cmml"><mn id="A1.3.p3.1.m1.1.1.2" xref="A1.3.p3.1.m1.1.1.2.cmml">1</mn><mo id="A1.3.p3.1.m1.1.1.1" xref="A1.3.p3.1.m1.1.1.1.cmml">−</mo><mi id="A1.3.p3.1.m1.1.1.3" xref="A1.3.p3.1.m1.1.1.3.cmml">δ</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.3.p3.1.m1.1b"><apply id="A1.3.p3.1.m1.1.1.cmml" xref="A1.3.p3.1.m1.1.1"><minus id="A1.3.p3.1.m1.1.1.1.cmml" xref="A1.3.p3.1.m1.1.1.1"></minus><cn id="A1.3.p3.1.m1.1.1.2.cmml" type="integer" xref="A1.3.p3.1.m1.1.1.2">1</cn><ci id="A1.3.p3.1.m1.1.1.3.cmml" xref="A1.3.p3.1.m1.1.1.3">𝛿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.3.p3.1.m1.1c">1-\delta</annotation><annotation encoding="application/x-llamapun" id="A1.3.p3.1.m1.1d">1 - italic_δ</annotation></semantics></math>,</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E25">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="R_{\ell,f}(\mathscr{D}_{Y})\leq R_{\ell,\tilde{f}_{n}}(\tilde{\mathscr{S}}_{n}%
)+\underbrace{\mathcal{W}(\mathscr{D}_{Y},\tilde{\mathscr{D}}_{Y})}_{\leq L\|u%
\|}+\tilde{\mathfrak{R}}_{n}(\mathcal{G}_{\ell,\mathcal{F}^{g^{\prime}}})+%
\mathcal{O}\Big{(}\sqrt{{\frac{\log(1/\delta)}{n}}}\Big{)}" class="ltx_Math" display="block" id="A1.E25.m1.14"><semantics id="A1.E25.m1.14a"><mrow id="A1.E25.m1.14.14" xref="A1.E25.m1.14.14.cmml"><mrow id="A1.E25.m1.12.12.1" xref="A1.E25.m1.12.12.1.cmml"><msub id="A1.E25.m1.12.12.1.3" xref="A1.E25.m1.12.12.1.3.cmml"><mi id="A1.E25.m1.12.12.1.3.2" xref="A1.E25.m1.12.12.1.3.2.cmml">R</mi><mrow id="A1.E25.m1.2.2.2.4" xref="A1.E25.m1.2.2.2.3.cmml"><mi id="A1.E25.m1.1.1.1.1" mathvariant="normal" xref="A1.E25.m1.1.1.1.1.cmml">ℓ</mi><mo id="A1.E25.m1.2.2.2.4.1" xref="A1.E25.m1.2.2.2.3.cmml">,</mo><mi id="A1.E25.m1.2.2.2.2" xref="A1.E25.m1.2.2.2.2.cmml">f</mi></mrow></msub><mo id="A1.E25.m1.12.12.1.2" xref="A1.E25.m1.12.12.1.2.cmml">⁢</mo><mrow id="A1.E25.m1.12.12.1.1.1" xref="A1.E25.m1.12.12.1.1.1.1.cmml"><mo id="A1.E25.m1.12.12.1.1.1.2" stretchy="false" xref="A1.E25.m1.12.12.1.1.1.1.cmml">(</mo><msub id="A1.E25.m1.12.12.1.1.1.1" xref="A1.E25.m1.12.12.1.1.1.1.cmml"><mi class="ltx_font_mathscript" id="A1.E25.m1.12.12.1.1.1.1.2" xref="A1.E25.m1.12.12.1.1.1.1.2.cmml">𝒟</mi><mi id="A1.E25.m1.12.12.1.1.1.1.3" xref="A1.E25.m1.12.12.1.1.1.1.3.cmml">Y</mi></msub><mo id="A1.E25.m1.12.12.1.1.1.3" stretchy="false" xref="A1.E25.m1.12.12.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E25.m1.14.14.4" xref="A1.E25.m1.14.14.4.cmml">≤</mo><mrow id="A1.E25.m1.14.14.3" xref="A1.E25.m1.14.14.3.cmml"><mrow id="A1.E25.m1.13.13.2.1" xref="A1.E25.m1.13.13.2.1.cmml"><msub id="A1.E25.m1.13.13.2.1.3" xref="A1.E25.m1.13.13.2.1.3.cmml"><mi id="A1.E25.m1.13.13.2.1.3.2" xref="A1.E25.m1.13.13.2.1.3.2.cmml">R</mi><mrow id="A1.E25.m1.4.4.2.2" xref="A1.E25.m1.4.4.2.3.cmml"><mi id="A1.E25.m1.3.3.1.1" mathvariant="normal" xref="A1.E25.m1.3.3.1.1.cmml">ℓ</mi><mo id="A1.E25.m1.4.4.2.2.2" xref="A1.E25.m1.4.4.2.3.cmml">,</mo><msub id="A1.E25.m1.4.4.2.2.1" xref="A1.E25.m1.4.4.2.2.1.cmml"><mover accent="true" id="A1.E25.m1.4.4.2.2.1.2" xref="A1.E25.m1.4.4.2.2.1.2.cmml"><mi id="A1.E25.m1.4.4.2.2.1.2.2" xref="A1.E25.m1.4.4.2.2.1.2.2.cmml">f</mi><mo id="A1.E25.m1.4.4.2.2.1.2.1" xref="A1.E25.m1.4.4.2.2.1.2.1.cmml">~</mo></mover><mi id="A1.E25.m1.4.4.2.2.1.3" xref="A1.E25.m1.4.4.2.2.1.3.cmml">n</mi></msub></mrow></msub><mo id="A1.E25.m1.13.13.2.1.2" xref="A1.E25.m1.13.13.2.1.2.cmml">⁢</mo><mrow id="A1.E25.m1.13.13.2.1.1.1" xref="A1.E25.m1.13.13.2.1.1.1.1.cmml"><mo id="A1.E25.m1.13.13.2.1.1.1.2" stretchy="false" xref="A1.E25.m1.13.13.2.1.1.1.1.cmml">(</mo><msub id="A1.E25.m1.13.13.2.1.1.1.1" xref="A1.E25.m1.13.13.2.1.1.1.1.cmml"><mover accent="true" id="A1.E25.m1.13.13.2.1.1.1.1.2" xref="A1.E25.m1.13.13.2.1.1.1.1.2.cmml"><mi class="ltx_font_mathscript" id="A1.E25.m1.13.13.2.1.1.1.1.2.2" xref="A1.E25.m1.13.13.2.1.1.1.1.2.2.cmml">𝒮</mi><mo id="A1.E25.m1.13.13.2.1.1.1.1.2.1" xref="A1.E25.m1.13.13.2.1.1.1.1.2.1.cmml">~</mo></mover><mi id="A1.E25.m1.13.13.2.1.1.1.1.3" xref="A1.E25.m1.13.13.2.1.1.1.1.3.cmml">n</mi></msub><mo id="A1.E25.m1.13.13.2.1.1.1.3" stretchy="false" xref="A1.E25.m1.13.13.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E25.m1.14.14.3.3" xref="A1.E25.m1.14.14.3.3.cmml">+</mo><munder id="A1.E25.m1.14.14.3.4" xref="A1.E25.m1.14.14.3.4.cmml"><munder accentunder="true" id="A1.E25.m1.6.6" xref="A1.E25.m1.6.6.cmml"><mrow id="A1.E25.m1.6.6.2" xref="A1.E25.m1.6.6.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E25.m1.6.6.2.4" xref="A1.E25.m1.6.6.2.4.cmml">𝒲</mi><mo id="A1.E25.m1.6.6.2.3" xref="A1.E25.m1.6.6.2.3.cmml">⁢</mo><mrow id="A1.E25.m1.6.6.2.2.2" xref="A1.E25.m1.6.6.2.2.3.cmml"><mo id="A1.E25.m1.6.6.2.2.2.3" stretchy="false" xref="A1.E25.m1.6.6.2.2.3.cmml">(</mo><msub id="A1.E25.m1.5.5.1.1.1.1" xref="A1.E25.m1.5.5.1.1.1.1.cmml"><mi class="ltx_font_mathscript" id="A1.E25.m1.5.5.1.1.1.1.2" xref="A1.E25.m1.5.5.1.1.1.1.2.cmml">𝒟</mi><mi id="A1.E25.m1.5.5.1.1.1.1.3" xref="A1.E25.m1.5.5.1.1.1.1.3.cmml">Y</mi></msub><mo id="A1.E25.m1.6.6.2.2.2.4" xref="A1.E25.m1.6.6.2.2.3.cmml">,</mo><msub id="A1.E25.m1.6.6.2.2.2.2" xref="A1.E25.m1.6.6.2.2.2.2.cmml"><mover accent="true" id="A1.E25.m1.6.6.2.2.2.2.2" xref="A1.E25.m1.6.6.2.2.2.2.2.cmml"><mi class="ltx_font_mathscript" id="A1.E25.m1.6.6.2.2.2.2.2.2" xref="A1.E25.m1.6.6.2.2.2.2.2.2.cmml">𝒟</mi><mo id="A1.E25.m1.6.6.2.2.2.2.2.1" xref="A1.E25.m1.6.6.2.2.2.2.2.1.cmml">~</mo></mover><mi id="A1.E25.m1.6.6.2.2.2.2.3" xref="A1.E25.m1.6.6.2.2.2.2.3.cmml">Y</mi></msub><mo id="A1.E25.m1.6.6.2.2.2.5" stretchy="false" xref="A1.E25.m1.6.6.2.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E25.m1.6.6.3" xref="A1.E25.m1.6.6.3.cmml">⏟</mo></munder><mrow id="A1.E25.m1.7.7.1" xref="A1.E25.m1.7.7.1.cmml"><mi id="A1.E25.m1.7.7.1.3" xref="A1.E25.m1.7.7.1.3.cmml"></mi><mo id="A1.E25.m1.7.7.1.2" xref="A1.E25.m1.7.7.1.2.cmml">≤</mo><mrow id="A1.E25.m1.7.7.1.4" xref="A1.E25.m1.7.7.1.4.cmml"><mi id="A1.E25.m1.7.7.1.4.2" xref="A1.E25.m1.7.7.1.4.2.cmml">L</mi><mo id="A1.E25.m1.7.7.1.4.1" xref="A1.E25.m1.7.7.1.4.1.cmml">⁢</mo><mrow id="A1.E25.m1.7.7.1.4.3.2" xref="A1.E25.m1.7.7.1.4.3.1.cmml"><mo id="A1.E25.m1.7.7.1.4.3.2.1" stretchy="false" xref="A1.E25.m1.7.7.1.4.3.1.1.cmml">‖</mo><mi id="A1.E25.m1.7.7.1.1" xref="A1.E25.m1.7.7.1.1.cmml">u</mi><mo id="A1.E25.m1.7.7.1.4.3.2.2" stretchy="false" xref="A1.E25.m1.7.7.1.4.3.1.1.cmml">‖</mo></mrow></mrow></mrow></munder><mo id="A1.E25.m1.14.14.3.3a" xref="A1.E25.m1.14.14.3.3.cmml">+</mo><mrow id="A1.E25.m1.14.14.3.2" xref="A1.E25.m1.14.14.3.2.cmml"><msub id="A1.E25.m1.14.14.3.2.3" xref="A1.E25.m1.14.14.3.2.3.cmml"><mover accent="true" id="A1.E25.m1.14.14.3.2.3.2" xref="A1.E25.m1.14.14.3.2.3.2.cmml"><mi id="A1.E25.m1.14.14.3.2.3.2.2" xref="A1.E25.m1.14.14.3.2.3.2.2.cmml">ℜ</mi><mo id="A1.E25.m1.14.14.3.2.3.2.1" xref="A1.E25.m1.14.14.3.2.3.2.1.cmml">~</mo></mover><mi id="A1.E25.m1.14.14.3.2.3.3" xref="A1.E25.m1.14.14.3.2.3.3.cmml">n</mi></msub><mo id="A1.E25.m1.14.14.3.2.2" xref="A1.E25.m1.14.14.3.2.2.cmml">⁢</mo><mrow id="A1.E25.m1.14.14.3.2.1.1" xref="A1.E25.m1.14.14.3.2.1.1.1.cmml"><mo id="A1.E25.m1.14.14.3.2.1.1.2" stretchy="false" xref="A1.E25.m1.14.14.3.2.1.1.1.cmml">(</mo><msub id="A1.E25.m1.14.14.3.2.1.1.1" xref="A1.E25.m1.14.14.3.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E25.m1.14.14.3.2.1.1.1.2" xref="A1.E25.m1.14.14.3.2.1.1.1.2.cmml">𝒢</mi><mrow id="A1.E25.m1.9.9.2.2" xref="A1.E25.m1.9.9.2.3.cmml"><mi id="A1.E25.m1.8.8.1.1" mathvariant="normal" xref="A1.E25.m1.8.8.1.1.cmml">ℓ</mi><mo id="A1.E25.m1.9.9.2.2.2" xref="A1.E25.m1.9.9.2.3.cmml">,</mo><msup id="A1.E25.m1.9.9.2.2.1" xref="A1.E25.m1.9.9.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E25.m1.9.9.2.2.1.2" xref="A1.E25.m1.9.9.2.2.1.2.cmml">ℱ</mi><msup id="A1.E25.m1.9.9.2.2.1.3" xref="A1.E25.m1.9.9.2.2.1.3.cmml"><mi id="A1.E25.m1.9.9.2.2.1.3.2" xref="A1.E25.m1.9.9.2.2.1.3.2.cmml">g</mi><mo id="A1.E25.m1.9.9.2.2.1.3.3" xref="A1.E25.m1.9.9.2.2.1.3.3.cmml">′</mo></msup></msup></mrow></msub><mo id="A1.E25.m1.14.14.3.2.1.1.3" stretchy="false" xref="A1.E25.m1.14.14.3.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E25.m1.14.14.3.3b" xref="A1.E25.m1.14.14.3.3.cmml">+</mo><mrow id="A1.E25.m1.14.14.3.5" xref="A1.E25.m1.14.14.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E25.m1.14.14.3.5.2" xref="A1.E25.m1.14.14.3.5.2.cmml">𝒪</mi><mo id="A1.E25.m1.14.14.3.5.1" xref="A1.E25.m1.14.14.3.5.1.cmml">⁢</mo><mrow id="A1.E25.m1.14.14.3.5.3.2" xref="A1.E25.m1.11.11.cmml"><mo id="A1.E25.m1.14.14.3.5.3.2.1" maxsize="160%" minsize="160%" xref="A1.E25.m1.11.11.cmml">(</mo><msqrt id="A1.E25.m1.11.11" xref="A1.E25.m1.11.11.cmml"><mfrac id="A1.E25.m1.11.11.2" xref="A1.E25.m1.11.11.2.cmml"><mrow id="A1.E25.m1.11.11.2.2.2.2" xref="A1.E25.m1.11.11.2.2.2.3.cmml"><mi id="A1.E25.m1.10.10.1.1.1.1" xref="A1.E25.m1.10.10.1.1.1.1.cmml">log</mi><mo id="A1.E25.m1.11.11.2.2.2.2a" xref="A1.E25.m1.11.11.2.2.2.3.cmml">⁡</mo><mrow id="A1.E25.m1.11.11.2.2.2.2.1" xref="A1.E25.m1.11.11.2.2.2.3.cmml"><mo id="A1.E25.m1.11.11.2.2.2.2.1.2" stretchy="false" xref="A1.E25.m1.11.11.2.2.2.3.cmml">(</mo><mrow id="A1.E25.m1.11.11.2.2.2.2.1.1" xref="A1.E25.m1.11.11.2.2.2.2.1.1.cmml"><mn id="A1.E25.m1.11.11.2.2.2.2.1.1.2" xref="A1.E25.m1.11.11.2.2.2.2.1.1.2.cmml">1</mn><mo id="A1.E25.m1.11.11.2.2.2.2.1.1.1" xref="A1.E25.m1.11.11.2.2.2.2.1.1.1.cmml">/</mo><mi id="A1.E25.m1.11.11.2.2.2.2.1.1.3" xref="A1.E25.m1.11.11.2.2.2.2.1.1.3.cmml">δ</mi></mrow><mo id="A1.E25.m1.11.11.2.2.2.2.1.3" stretchy="false" xref="A1.E25.m1.11.11.2.2.2.3.cmml">)</mo></mrow></mrow><mi id="A1.E25.m1.11.11.2.4" xref="A1.E25.m1.11.11.2.4.cmml">n</mi></mfrac></msqrt><mo id="A1.E25.m1.14.14.3.5.3.2.2" maxsize="160%" minsize="160%" xref="A1.E25.m1.11.11.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E25.m1.14b"><apply id="A1.E25.m1.14.14.cmml" xref="A1.E25.m1.14.14"><leq id="A1.E25.m1.14.14.4.cmml" xref="A1.E25.m1.14.14.4"></leq><apply id="A1.E25.m1.12.12.1.cmml" xref="A1.E25.m1.12.12.1"><times id="A1.E25.m1.12.12.1.2.cmml" xref="A1.E25.m1.12.12.1.2"></times><apply id="A1.E25.m1.12.12.1.3.cmml" xref="A1.E25.m1.12.12.1.3"><csymbol cd="ambiguous" id="A1.E25.m1.12.12.1.3.1.cmml" xref="A1.E25.m1.12.12.1.3">subscript</csymbol><ci id="A1.E25.m1.12.12.1.3.2.cmml" xref="A1.E25.m1.12.12.1.3.2">𝑅</ci><list id="A1.E25.m1.2.2.2.3.cmml" xref="A1.E25.m1.2.2.2.4"><ci id="A1.E25.m1.1.1.1.1.cmml" xref="A1.E25.m1.1.1.1.1">ℓ</ci><ci id="A1.E25.m1.2.2.2.2.cmml" xref="A1.E25.m1.2.2.2.2">𝑓</ci></list></apply><apply id="A1.E25.m1.12.12.1.1.1.1.cmml" xref="A1.E25.m1.12.12.1.1.1"><csymbol cd="ambiguous" id="A1.E25.m1.12.12.1.1.1.1.1.cmml" xref="A1.E25.m1.12.12.1.1.1">subscript</csymbol><ci id="A1.E25.m1.12.12.1.1.1.1.2.cmml" xref="A1.E25.m1.12.12.1.1.1.1.2">𝒟</ci><ci id="A1.E25.m1.12.12.1.1.1.1.3.cmml" xref="A1.E25.m1.12.12.1.1.1.1.3">𝑌</ci></apply></apply><apply id="A1.E25.m1.14.14.3.cmml" xref="A1.E25.m1.14.14.3"><plus id="A1.E25.m1.14.14.3.3.cmml" xref="A1.E25.m1.14.14.3.3"></plus><apply id="A1.E25.m1.13.13.2.1.cmml" xref="A1.E25.m1.13.13.2.1"><times id="A1.E25.m1.13.13.2.1.2.cmml" xref="A1.E25.m1.13.13.2.1.2"></times><apply id="A1.E25.m1.13.13.2.1.3.cmml" xref="A1.E25.m1.13.13.2.1.3"><csymbol cd="ambiguous" id="A1.E25.m1.13.13.2.1.3.1.cmml" xref="A1.E25.m1.13.13.2.1.3">subscript</csymbol><ci id="A1.E25.m1.13.13.2.1.3.2.cmml" xref="A1.E25.m1.13.13.2.1.3.2">𝑅</ci><list id="A1.E25.m1.4.4.2.3.cmml" xref="A1.E25.m1.4.4.2.2"><ci id="A1.E25.m1.3.3.1.1.cmml" xref="A1.E25.m1.3.3.1.1">ℓ</ci><apply id="A1.E25.m1.4.4.2.2.1.cmml" xref="A1.E25.m1.4.4.2.2.1"><csymbol cd="ambiguous" id="A1.E25.m1.4.4.2.2.1.1.cmml" xref="A1.E25.m1.4.4.2.2.1">subscript</csymbol><apply id="A1.E25.m1.4.4.2.2.1.2.cmml" xref="A1.E25.m1.4.4.2.2.1.2"><ci id="A1.E25.m1.4.4.2.2.1.2.1.cmml" xref="A1.E25.m1.4.4.2.2.1.2.1">~</ci><ci id="A1.E25.m1.4.4.2.2.1.2.2.cmml" xref="A1.E25.m1.4.4.2.2.1.2.2">𝑓</ci></apply><ci id="A1.E25.m1.4.4.2.2.1.3.cmml" xref="A1.E25.m1.4.4.2.2.1.3">𝑛</ci></apply></list></apply><apply id="A1.E25.m1.13.13.2.1.1.1.1.cmml" xref="A1.E25.m1.13.13.2.1.1.1"><csymbol cd="ambiguous" id="A1.E25.m1.13.13.2.1.1.1.1.1.cmml" xref="A1.E25.m1.13.13.2.1.1.1">subscript</csymbol><apply id="A1.E25.m1.13.13.2.1.1.1.1.2.cmml" xref="A1.E25.m1.13.13.2.1.1.1.1.2"><ci id="A1.E25.m1.13.13.2.1.1.1.1.2.1.cmml" xref="A1.E25.m1.13.13.2.1.1.1.1.2.1">~</ci><ci id="A1.E25.m1.13.13.2.1.1.1.1.2.2.cmml" xref="A1.E25.m1.13.13.2.1.1.1.1.2.2">𝒮</ci></apply><ci id="A1.E25.m1.13.13.2.1.1.1.1.3.cmml" xref="A1.E25.m1.13.13.2.1.1.1.1.3">𝑛</ci></apply></apply><apply id="A1.E25.m1.14.14.3.4.cmml" xref="A1.E25.m1.14.14.3.4"><csymbol cd="ambiguous" id="A1.E25.m1.14.14.3.4.1.cmml" xref="A1.E25.m1.14.14.3.4">subscript</csymbol><apply id="A1.E25.m1.6.6.cmml" xref="A1.E25.m1.6.6"><ci id="A1.E25.m1.6.6.3.cmml" xref="A1.E25.m1.6.6.3">⏟</ci><apply id="A1.E25.m1.6.6.2.cmml" xref="A1.E25.m1.6.6.2"><times id="A1.E25.m1.6.6.2.3.cmml" xref="A1.E25.m1.6.6.2.3"></times><ci id="A1.E25.m1.6.6.2.4.cmml" xref="A1.E25.m1.6.6.2.4">𝒲</ci><interval closure="open" id="A1.E25.m1.6.6.2.2.3.cmml" xref="A1.E25.m1.6.6.2.2.2"><apply id="A1.E25.m1.5.5.1.1.1.1.cmml" xref="A1.E25.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="A1.E25.m1.5.5.1.1.1.1.1.cmml" xref="A1.E25.m1.5.5.1.1.1.1">subscript</csymbol><ci id="A1.E25.m1.5.5.1.1.1.1.2.cmml" xref="A1.E25.m1.5.5.1.1.1.1.2">𝒟</ci><ci id="A1.E25.m1.5.5.1.1.1.1.3.cmml" xref="A1.E25.m1.5.5.1.1.1.1.3">𝑌</ci></apply><apply id="A1.E25.m1.6.6.2.2.2.2.cmml" xref="A1.E25.m1.6.6.2.2.2.2"><csymbol cd="ambiguous" id="A1.E25.m1.6.6.2.2.2.2.1.cmml" xref="A1.E25.m1.6.6.2.2.2.2">subscript</csymbol><apply id="A1.E25.m1.6.6.2.2.2.2.2.cmml" xref="A1.E25.m1.6.6.2.2.2.2.2"><ci id="A1.E25.m1.6.6.2.2.2.2.2.1.cmml" xref="A1.E25.m1.6.6.2.2.2.2.2.1">~</ci><ci id="A1.E25.m1.6.6.2.2.2.2.2.2.cmml" xref="A1.E25.m1.6.6.2.2.2.2.2.2">𝒟</ci></apply><ci id="A1.E25.m1.6.6.2.2.2.2.3.cmml" xref="A1.E25.m1.6.6.2.2.2.2.3">𝑌</ci></apply></interval></apply></apply><apply id="A1.E25.m1.7.7.1.cmml" xref="A1.E25.m1.7.7.1"><leq id="A1.E25.m1.7.7.1.2.cmml" xref="A1.E25.m1.7.7.1.2"></leq><csymbol cd="latexml" id="A1.E25.m1.7.7.1.3.cmml" xref="A1.E25.m1.7.7.1.3">absent</csymbol><apply id="A1.E25.m1.7.7.1.4.cmml" xref="A1.E25.m1.7.7.1.4"><times id="A1.E25.m1.7.7.1.4.1.cmml" xref="A1.E25.m1.7.7.1.4.1"></times><ci id="A1.E25.m1.7.7.1.4.2.cmml" xref="A1.E25.m1.7.7.1.4.2">𝐿</ci><apply id="A1.E25.m1.7.7.1.4.3.1.cmml" xref="A1.E25.m1.7.7.1.4.3.2"><csymbol cd="latexml" id="A1.E25.m1.7.7.1.4.3.1.1.cmml" xref="A1.E25.m1.7.7.1.4.3.2.1">norm</csymbol><ci id="A1.E25.m1.7.7.1.1.cmml" xref="A1.E25.m1.7.7.1.1">𝑢</ci></apply></apply></apply></apply><apply id="A1.E25.m1.14.14.3.2.cmml" xref="A1.E25.m1.14.14.3.2"><times id="A1.E25.m1.14.14.3.2.2.cmml" xref="A1.E25.m1.14.14.3.2.2"></times><apply id="A1.E25.m1.14.14.3.2.3.cmml" xref="A1.E25.m1.14.14.3.2.3"><csymbol cd="ambiguous" id="A1.E25.m1.14.14.3.2.3.1.cmml" xref="A1.E25.m1.14.14.3.2.3">subscript</csymbol><apply id="A1.E25.m1.14.14.3.2.3.2.cmml" xref="A1.E25.m1.14.14.3.2.3.2"><ci id="A1.E25.m1.14.14.3.2.3.2.1.cmml" xref="A1.E25.m1.14.14.3.2.3.2.1">~</ci><ci id="A1.E25.m1.14.14.3.2.3.2.2.cmml" xref="A1.E25.m1.14.14.3.2.3.2.2">ℜ</ci></apply><ci id="A1.E25.m1.14.14.3.2.3.3.cmml" xref="A1.E25.m1.14.14.3.2.3.3">𝑛</ci></apply><apply id="A1.E25.m1.14.14.3.2.1.1.1.cmml" xref="A1.E25.m1.14.14.3.2.1.1"><csymbol cd="ambiguous" id="A1.E25.m1.14.14.3.2.1.1.1.1.cmml" xref="A1.E25.m1.14.14.3.2.1.1">subscript</csymbol><ci id="A1.E25.m1.14.14.3.2.1.1.1.2.cmml" xref="A1.E25.m1.14.14.3.2.1.1.1.2">𝒢</ci><list id="A1.E25.m1.9.9.2.3.cmml" xref="A1.E25.m1.9.9.2.2"><ci id="A1.E25.m1.8.8.1.1.cmml" xref="A1.E25.m1.8.8.1.1">ℓ</ci><apply id="A1.E25.m1.9.9.2.2.1.cmml" xref="A1.E25.m1.9.9.2.2.1"><csymbol cd="ambiguous" id="A1.E25.m1.9.9.2.2.1.1.cmml" xref="A1.E25.m1.9.9.2.2.1">superscript</csymbol><ci id="A1.E25.m1.9.9.2.2.1.2.cmml" xref="A1.E25.m1.9.9.2.2.1.2">ℱ</ci><apply id="A1.E25.m1.9.9.2.2.1.3.cmml" xref="A1.E25.m1.9.9.2.2.1.3"><csymbol cd="ambiguous" id="A1.E25.m1.9.9.2.2.1.3.1.cmml" xref="A1.E25.m1.9.9.2.2.1.3">superscript</csymbol><ci id="A1.E25.m1.9.9.2.2.1.3.2.cmml" xref="A1.E25.m1.9.9.2.2.1.3.2">𝑔</ci><ci id="A1.E25.m1.9.9.2.2.1.3.3.cmml" xref="A1.E25.m1.9.9.2.2.1.3.3">′</ci></apply></apply></list></apply></apply><apply id="A1.E25.m1.14.14.3.5.cmml" xref="A1.E25.m1.14.14.3.5"><times id="A1.E25.m1.14.14.3.5.1.cmml" xref="A1.E25.m1.14.14.3.5.1"></times><ci id="A1.E25.m1.14.14.3.5.2.cmml" xref="A1.E25.m1.14.14.3.5.2">𝒪</ci><apply id="A1.E25.m1.11.11.cmml" xref="A1.E25.m1.14.14.3.5.3.2"><root id="A1.E25.m1.11.11a.cmml" xref="A1.E25.m1.14.14.3.5.3.2"></root><apply id="A1.E25.m1.11.11.2.cmml" xref="A1.E25.m1.11.11.2"><divide id="A1.E25.m1.11.11.2.3.cmml" xref="A1.E25.m1.11.11.2"></divide><apply id="A1.E25.m1.11.11.2.2.2.3.cmml" xref="A1.E25.m1.11.11.2.2.2.2"><log id="A1.E25.m1.10.10.1.1.1.1.cmml" xref="A1.E25.m1.10.10.1.1.1.1"></log><apply id="A1.E25.m1.11.11.2.2.2.2.1.1.cmml" xref="A1.E25.m1.11.11.2.2.2.2.1.1"><divide id="A1.E25.m1.11.11.2.2.2.2.1.1.1.cmml" xref="A1.E25.m1.11.11.2.2.2.2.1.1.1"></divide><cn id="A1.E25.m1.11.11.2.2.2.2.1.1.2.cmml" type="integer" xref="A1.E25.m1.11.11.2.2.2.2.1.1.2">1</cn><ci id="A1.E25.m1.11.11.2.2.2.2.1.1.3.cmml" xref="A1.E25.m1.11.11.2.2.2.2.1.1.3">𝛿</ci></apply></apply><ci id="A1.E25.m1.11.11.2.4.cmml" xref="A1.E25.m1.11.11.2.4">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E25.m1.14c">R_{\ell,f}(\mathscr{D}_{Y})\leq R_{\ell,\tilde{f}_{n}}(\tilde{\mathscr{S}}_{n}%
)+\underbrace{\mathcal{W}(\mathscr{D}_{Y},\tilde{\mathscr{D}}_{Y})}_{\leq L\|u%
\|}+\tilde{\mathfrak{R}}_{n}(\mathcal{G}_{\ell,\mathcal{F}^{g^{\prime}}})+%
\mathcal{O}\Big{(}\sqrt{{\frac{\log(1/\delta)}{n}}}\Big{)}</annotation><annotation encoding="application/x-llamapun" id="A1.E25.m1.14d">italic_R start_POSTSUBSCRIPT roman_ℓ , italic_f end_POSTSUBSCRIPT ( script_D start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT ) ≤ italic_R start_POSTSUBSCRIPT roman_ℓ , over~ start_ARG italic_f end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( over~ start_ARG script_S end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) + under⏟ start_ARG caligraphic_W ( script_D start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT , over~ start_ARG script_D end_ARG start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT ) end_ARG start_POSTSUBSCRIPT ≤ italic_L ∥ italic_u ∥ end_POSTSUBSCRIPT + over~ start_ARG fraktur_R end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ( caligraphic_G start_POSTSUBSCRIPT roman_ℓ , caligraphic_F start_POSTSUPERSCRIPT italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ) + caligraphic_O ( square-root start_ARG divide start_ARG roman_log ( 1 / italic_δ ) end_ARG start_ARG italic_n end_ARG end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(25)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.3.p3.2">∎</p>
</div>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure class="ltx_figure" id="A1.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="138" id="A1.F5.g1" src="extracted/5830607/2d_figure.png" width="568"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>A toy experiment where stale and true targets are distributed around the unit circle, and the corrected targets based on the learned approximation are also depicted. The associated distribution over targets (<math alttext="\beta=20" class="ltx_Math" display="inline" id="A1.F5.2.m1.1"><semantics id="A1.F5.2.m1.1b"><mrow id="A1.F5.2.m1.1.1" xref="A1.F5.2.m1.1.1.cmml"><mi id="A1.F5.2.m1.1.1.2" xref="A1.F5.2.m1.1.1.2.cmml">β</mi><mo id="A1.F5.2.m1.1.1.1" xref="A1.F5.2.m1.1.1.1.cmml">=</mo><mn id="A1.F5.2.m1.1.1.3" xref="A1.F5.2.m1.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F5.2.m1.1c"><apply id="A1.F5.2.m1.1.1.cmml" xref="A1.F5.2.m1.1.1"><eq id="A1.F5.2.m1.1.1.1.cmml" xref="A1.F5.2.m1.1.1.1"></eq><ci id="A1.F5.2.m1.1.1.2.cmml" xref="A1.F5.2.m1.1.1.2">𝛽</ci><cn id="A1.F5.2.m1.1.1.3.cmml" type="integer" xref="A1.F5.2.m1.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F5.2.m1.1d">\beta=20</annotation><annotation encoding="application/x-llamapun" id="A1.F5.2.m1.1e">italic_β = 20</annotation></semantics></math>) based on the point identified.</figcaption>
</figure>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Experiments</h2>
<section class="ltx_subsection" id="A2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Experimental Details</h3>
<div class="ltx_para" id="A2.SS1.p1">
<p class="ltx_p" id="A2.SS1.p1.3"><span class="ltx_text ltx_font_bold" id="A2.SS1.p1.3.1">Training Details</span> We train all models, the dual-encoders and the corrector model, jointly using Adam <cite class="ltx_cite ltx_citemacro_citep">(Kingma &amp; Ba, <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib18" title="">2014</a>)</cite>. We implement the training procedure using stop-gradients so that the corrector model loss only changes the corrector model parameters and dual-encoder loss the dual-encoder ones. We form the subset of targets for the truncated softmax, <math alttext="S(\mathcal{Y})_{x}" class="ltx_Math" display="inline" id="A2.SS1.p1.1.m1.1"><semantics id="A2.SS1.p1.1.m1.1a"><mrow id="A2.SS1.p1.1.m1.1.2" xref="A2.SS1.p1.1.m1.1.2.cmml"><mi id="A2.SS1.p1.1.m1.1.2.2" xref="A2.SS1.p1.1.m1.1.2.2.cmml">S</mi><mo id="A2.SS1.p1.1.m1.1.2.1" xref="A2.SS1.p1.1.m1.1.2.1.cmml">⁢</mo><msub id="A2.SS1.p1.1.m1.1.2.3" xref="A2.SS1.p1.1.m1.1.2.3.cmml"><mrow id="A2.SS1.p1.1.m1.1.2.3.2.2" xref="A2.SS1.p1.1.m1.1.2.3.cmml"><mo id="A2.SS1.p1.1.m1.1.2.3.2.2.1" stretchy="false" xref="A2.SS1.p1.1.m1.1.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="A2.SS1.p1.1.m1.1.1" xref="A2.SS1.p1.1.m1.1.1.cmml">𝒴</mi><mo id="A2.SS1.p1.1.m1.1.2.3.2.2.2" stretchy="false" xref="A2.SS1.p1.1.m1.1.2.3.cmml">)</mo></mrow><mi id="A2.SS1.p1.1.m1.1.2.3.3" xref="A2.SS1.p1.1.m1.1.2.3.3.cmml">x</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.1.m1.1b"><apply id="A2.SS1.p1.1.m1.1.2.cmml" xref="A2.SS1.p1.1.m1.1.2"><times id="A2.SS1.p1.1.m1.1.2.1.cmml" xref="A2.SS1.p1.1.m1.1.2.1"></times><ci id="A2.SS1.p1.1.m1.1.2.2.cmml" xref="A2.SS1.p1.1.m1.1.2.2">𝑆</ci><apply id="A2.SS1.p1.1.m1.1.2.3.cmml" xref="A2.SS1.p1.1.m1.1.2.3"><csymbol cd="ambiguous" id="A2.SS1.p1.1.m1.1.2.3.1.cmml" xref="A2.SS1.p1.1.m1.1.2.3">subscript</csymbol><ci id="A2.SS1.p1.1.m1.1.1.cmml" xref="A2.SS1.p1.1.m1.1.1">𝒴</ci><ci id="A2.SS1.p1.1.m1.1.2.3.3.cmml" xref="A2.SS1.p1.1.m1.1.2.3.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.1.m1.1c">S(\mathcal{Y})_{x}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.1.m1.1d">italic_S ( caligraphic_Y ) start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math>, using the top-64 closest targets to the given query according to a particular training procedure’s buffer and 64 targets chosen uniformly at random. We use a minibatch size of 128 examples and share the truncated softmax targets across all examples in the minibatch <math alttext="mb" class="ltx_Math" display="inline" id="A2.SS1.p1.2.m2.1"><semantics id="A2.SS1.p1.2.m2.1a"><mrow id="A2.SS1.p1.2.m2.1.1" xref="A2.SS1.p1.2.m2.1.1.cmml"><mi id="A2.SS1.p1.2.m2.1.1.2" xref="A2.SS1.p1.2.m2.1.1.2.cmml">m</mi><mo id="A2.SS1.p1.2.m2.1.1.1" xref="A2.SS1.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="A2.SS1.p1.2.m2.1.1.3" xref="A2.SS1.p1.2.m2.1.1.3.cmml">b</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.2.m2.1b"><apply id="A2.SS1.p1.2.m2.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1"><times id="A2.SS1.p1.2.m2.1.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1.1"></times><ci id="A2.SS1.p1.2.m2.1.1.2.cmml" xref="A2.SS1.p1.2.m2.1.1.2">𝑚</ci><ci id="A2.SS1.p1.2.m2.1.1.3.cmml" xref="A2.SS1.p1.2.m2.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.2.m2.1c">mb</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.2.m2.1d">italic_m italic_b</annotation></semantics></math> , e.g., <math alttext="\bigcup_{x\in mb}S(\mathcal{Y})_{x}" class="ltx_Math" display="inline" id="A2.SS1.p1.3.m3.1"><semantics id="A2.SS1.p1.3.m3.1a"><mrow id="A2.SS1.p1.3.m3.1.2" xref="A2.SS1.p1.3.m3.1.2.cmml"><msub id="A2.SS1.p1.3.m3.1.2.1" xref="A2.SS1.p1.3.m3.1.2.1.cmml"><mo id="A2.SS1.p1.3.m3.1.2.1.2" xref="A2.SS1.p1.3.m3.1.2.1.2.cmml">⋃</mo><mrow id="A2.SS1.p1.3.m3.1.2.1.3" xref="A2.SS1.p1.3.m3.1.2.1.3.cmml"><mi id="A2.SS1.p1.3.m3.1.2.1.3.2" xref="A2.SS1.p1.3.m3.1.2.1.3.2.cmml">x</mi><mo id="A2.SS1.p1.3.m3.1.2.1.3.1" xref="A2.SS1.p1.3.m3.1.2.1.3.1.cmml">∈</mo><mrow id="A2.SS1.p1.3.m3.1.2.1.3.3" xref="A2.SS1.p1.3.m3.1.2.1.3.3.cmml"><mi id="A2.SS1.p1.3.m3.1.2.1.3.3.2" xref="A2.SS1.p1.3.m3.1.2.1.3.3.2.cmml">m</mi><mo id="A2.SS1.p1.3.m3.1.2.1.3.3.1" xref="A2.SS1.p1.3.m3.1.2.1.3.3.1.cmml">⁢</mo><mi id="A2.SS1.p1.3.m3.1.2.1.3.3.3" xref="A2.SS1.p1.3.m3.1.2.1.3.3.3.cmml">b</mi></mrow></mrow></msub><mrow id="A2.SS1.p1.3.m3.1.2.2" xref="A2.SS1.p1.3.m3.1.2.2.cmml"><mi id="A2.SS1.p1.3.m3.1.2.2.2" xref="A2.SS1.p1.3.m3.1.2.2.2.cmml">S</mi><mo id="A2.SS1.p1.3.m3.1.2.2.1" xref="A2.SS1.p1.3.m3.1.2.2.1.cmml">⁢</mo><msub id="A2.SS1.p1.3.m3.1.2.2.3" xref="A2.SS1.p1.3.m3.1.2.2.3.cmml"><mrow id="A2.SS1.p1.3.m3.1.2.2.3.2.2" xref="A2.SS1.p1.3.m3.1.2.2.3.cmml"><mo id="A2.SS1.p1.3.m3.1.2.2.3.2.2.1" stretchy="false" xref="A2.SS1.p1.3.m3.1.2.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="A2.SS1.p1.3.m3.1.1" xref="A2.SS1.p1.3.m3.1.1.cmml">𝒴</mi><mo id="A2.SS1.p1.3.m3.1.2.2.3.2.2.2" stretchy="false" xref="A2.SS1.p1.3.m3.1.2.2.3.cmml">)</mo></mrow><mi id="A2.SS1.p1.3.m3.1.2.2.3.3" xref="A2.SS1.p1.3.m3.1.2.2.3.3.cmml">x</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.3.m3.1b"><apply id="A2.SS1.p1.3.m3.1.2.cmml" xref="A2.SS1.p1.3.m3.1.2"><apply id="A2.SS1.p1.3.m3.1.2.1.cmml" xref="A2.SS1.p1.3.m3.1.2.1"><csymbol cd="ambiguous" id="A2.SS1.p1.3.m3.1.2.1.1.cmml" xref="A2.SS1.p1.3.m3.1.2.1">subscript</csymbol><union id="A2.SS1.p1.3.m3.1.2.1.2.cmml" xref="A2.SS1.p1.3.m3.1.2.1.2"></union><apply id="A2.SS1.p1.3.m3.1.2.1.3.cmml" xref="A2.SS1.p1.3.m3.1.2.1.3"><in id="A2.SS1.p1.3.m3.1.2.1.3.1.cmml" xref="A2.SS1.p1.3.m3.1.2.1.3.1"></in><ci id="A2.SS1.p1.3.m3.1.2.1.3.2.cmml" xref="A2.SS1.p1.3.m3.1.2.1.3.2">𝑥</ci><apply id="A2.SS1.p1.3.m3.1.2.1.3.3.cmml" xref="A2.SS1.p1.3.m3.1.2.1.3.3"><times id="A2.SS1.p1.3.m3.1.2.1.3.3.1.cmml" xref="A2.SS1.p1.3.m3.1.2.1.3.3.1"></times><ci id="A2.SS1.p1.3.m3.1.2.1.3.3.2.cmml" xref="A2.SS1.p1.3.m3.1.2.1.3.3.2">𝑚</ci><ci id="A2.SS1.p1.3.m3.1.2.1.3.3.3.cmml" xref="A2.SS1.p1.3.m3.1.2.1.3.3.3">𝑏</ci></apply></apply></apply><apply id="A2.SS1.p1.3.m3.1.2.2.cmml" xref="A2.SS1.p1.3.m3.1.2.2"><times id="A2.SS1.p1.3.m3.1.2.2.1.cmml" xref="A2.SS1.p1.3.m3.1.2.2.1"></times><ci id="A2.SS1.p1.3.m3.1.2.2.2.cmml" xref="A2.SS1.p1.3.m3.1.2.2.2">𝑆</ci><apply id="A2.SS1.p1.3.m3.1.2.2.3.cmml" xref="A2.SS1.p1.3.m3.1.2.2.3"><csymbol cd="ambiguous" id="A2.SS1.p1.3.m3.1.2.2.3.1.cmml" xref="A2.SS1.p1.3.m3.1.2.2.3">subscript</csymbol><ci id="A2.SS1.p1.3.m3.1.1.cmml" xref="A2.SS1.p1.3.m3.1.1">𝒴</ci><ci id="A2.SS1.p1.3.m3.1.2.2.3.3.cmml" xref="A2.SS1.p1.3.m3.1.2.2.3.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.3.m3.1c">\bigcup_{x\in mb}S(\mathcal{Y})_{x}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.3.m3.1d">⋃ start_POSTSUBSCRIPT italic_x ∈ italic_m italic_b end_POSTSUBSCRIPT italic_S ( caligraphic_Y ) start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math>. We use 40K steps for retrieval training and 20K steps for RLM training. We combine the task losses and corrector network loss together. We experimented with a weight parameter applied to the corrector network. We use a weight value of 10.0.</p>
</div>
</section>
<section class="ltx_subsection" id="A2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Additional Dense Retrieval Results</h3>
<div class="ltx_para" id="A2.SS2.p1">
<p class="ltx_p" id="A2.SS2.p1.1">In Table <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#A2.T4" title="Table 4 ‣ B.2 Additional Dense Retrieval Results ‣ Appendix B Experiments ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">4</span></a>, we report performance on MSMarco using T5-base as the encoder. Here, with fewer targets, Stochastic Negative Mining provides a better approximation as a larger fraction of targets is re-encoded. Our method is still able to nearly match the performance of the exhaustive approach. We are able to achieve such results without having to re-embed the buffer.</p>
</div>
<div class="ltx_para" id="A2.SS2.p2">
<p class="ltx_p" id="A2.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="A2.SS2.p2.1.1">Using Accelerator Memory to Store the Buffer</span> In these experiments, we store the buffer of targets on the accelerator, making implementation of our approach training extremely easy. However, it could be the case that not all targets can fit into a buffer on accelerator memory. In such settings, our approach could still be used in the following ways: (1) subsample targets randomly (perhaps changing the subset periodically) to fit on device memory akin to a combination of our corrector approach stochastic negative mining, which would require no re-encoding of targets, or (2) use our approach to re-rank stale representations initially retrieved from CPU memory.</p>
</div>
<figure class="ltx_table" id="A2.T4">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A2.T4.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A2.T4.1.1.1.1">Performance</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="A2.T4.1.1.1.2">Num. Re-Embed</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="A2.T4.1.1.1.3">R@1</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="A2.T4.1.1.1.4">R@5</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="A2.T4.1.1.1.5">R@10</th>
<th class="ltx_td ltx_nopad_r ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="A2.T4.1.1.1.6">R@100</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T4.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T4.1.2.1.1">Stale</th>
<td class="ltx_td ltx_align_right ltx_border_t" id="A2.T4.1.2.1.2">0</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="A2.T4.1.2.1.3">10.11</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="A2.T4.1.2.1.4">27.70</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="A2.T4.1.2.1.5">36.33</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="A2.T4.1.2.1.6">63.69</td>
</tr>
<tr class="ltx_tr" id="A2.T4.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T4.1.3.2.1">SNM</th>
<td class="ltx_td ltx_align_right" id="A2.T4.1.3.2.2">20M</td>
<td class="ltx_td ltx_align_right" id="A2.T4.1.3.2.3">18.18</td>
<td class="ltx_td ltx_align_right" id="A2.T4.1.3.2.4">43.48</td>
<td class="ltx_td ltx_align_right" id="A2.T4.1.3.2.5">54.68</td>
<td class="ltx_td ltx_nopad_r ltx_align_right" id="A2.T4.1.3.2.6">82.18</td>
</tr>
<tr class="ltx_tr" id="A2.T4.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T4.1.4.3.1">Dynnibal</th>
<td class="ltx_td ltx_align_right" id="A2.T4.1.4.3.2">8M</td>
<td class="ltx_td ltx_align_right" id="A2.T4.1.4.3.3">18.23</td>
<td class="ltx_td ltx_align_right" id="A2.T4.1.4.3.4">43.15</td>
<td class="ltx_td ltx_align_right" id="A2.T4.1.4.3.5">54.56</td>
<td class="ltx_td ltx_nopad_r ltx_align_right" id="A2.T4.1.4.3.6">82.24</td>
</tr>
<tr class="ltx_tr" id="A2.T4.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T4.1.5.4.1">Target Corrector</th>
<td class="ltx_td ltx_align_right" id="A2.T4.1.5.4.2">0</td>
<td class="ltx_td ltx_align_right" id="A2.T4.1.5.4.3">17.07</td>
<td class="ltx_td ltx_align_right" id="A2.T4.1.5.4.4">40.78</td>
<td class="ltx_td ltx_align_right" id="A2.T4.1.5.4.5">51.56</td>
<td class="ltx_td ltx_nopad_r ltx_align_right" id="A2.T4.1.5.4.6">79.29</td>
</tr>
<tr class="ltx_tr" id="A2.T4.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A2.T4.1.6.5.1">Exhaustive</th>
<td class="ltx_td ltx_align_right ltx_border_bb" id="A2.T4.1.6.5.2">352M</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="A2.T4.1.6.5.3">18.18</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="A2.T4.1.6.5.4">44.97</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="A2.T4.1.6.5.5">55.58</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb" id="A2.T4.1.6.5.6">83.69</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span><span class="ltx_text ltx_font_bold" id="A2.T4.3.1">MSMARCO, T5 Initialization.</span> In this experiment, we measure performance of methods on MSMARCO. With fewer targets than Natural Questions, the gap between stochastic negative mining and the refreshed index is reduced.</figcaption>
</figure>
<section class="ltx_paragraph" id="A2.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Comparisons to 2-Round Training</h4>
<div class="ltx_para" id="A2.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="A2.SS2.SSS0.Px1.p1.1">Several recent works such as <cite class="ltx_cite ltx_citemacro_citep">(Qu et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib28" title="">2021</a>)</cite> which addresses difficulties of training dense retrieval models proposes to train in 2 stages. First all targets are encoded (using random or pre-trained model). Then the model is trained for one half of the desired iterations. Then the new model’s parameters are used to re-encode the targets a single time. Then the model is trained for the remaining steps using these re-encoded targets. We compare this approch with corrector networks in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#A2.T5" title="Table 5 ‣ Comparisons to 2-Round Training ‣ B.2 Additional Dense Retrieval Results ‣ Appendix B Experiments ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">5</span></a>. We see that when using GTR-base, the performance for all methods is quite similar (with corrector networks and exhaustive re-encoding slightly outperforming). When T5-base is used though, we find the performance of corrector networks and exhaustive re-encoding to notably out-perform the 2-step procedure. We attribute this to GTR being a better initialization for the model. In this case we would expect its parameters (and therefore its target embeddings) to change less from pre-training to fine-tuning, meaning that there is less embedding drift and therefore less bias when using the 2-step procedure.</p>
</div>
<figure class="ltx_table" id="A2.T5">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T5.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A2.T5.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A2.T5.1.1.1.1">Method</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="A2.T5.1.1.1.2">Base</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="A2.T5.1.1.1.3">R@1</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="A2.T5.1.1.1.4">R@5</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="A2.T5.1.1.1.5">R@10</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="A2.T5.1.1.1.6">R@20</th>
<th class="ltx_td ltx_nopad_r ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="A2.T5.1.1.1.7">R@100</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T5.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T5.1.2.1.1">Two Round</th>
<td class="ltx_td ltx_align_right ltx_border_t" id="A2.T5.1.2.1.2">T5</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="A2.T5.1.2.1.3">29.50</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="A2.T5.1.2.1.4">53.40</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="A2.T5.1.2.1.5">62.49</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="A2.T5.1.2.1.6">70.64</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="A2.T5.1.2.1.7">80.94</td>
</tr>
<tr class="ltx_tr" id="A2.T5.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T5.1.3.2.1">Corrector</th>
<td class="ltx_td ltx_align_right" id="A2.T5.1.3.2.2">T5</td>
<td class="ltx_td ltx_align_right" id="A2.T5.1.3.2.3">36.65</td>
<td class="ltx_td ltx_align_right" id="A2.T5.1.3.2.4">59.25</td>
<td class="ltx_td ltx_align_right" id="A2.T5.1.3.2.5">68.06</td>
<td class="ltx_td ltx_align_right" id="A2.T5.1.3.2.6">73.71</td>
<td class="ltx_td ltx_nopad_r ltx_align_right" id="A2.T5.1.3.2.7">83.13</td>
</tr>
<tr class="ltx_tr" id="A2.T5.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T5.1.4.3.1">Exhaustive</th>
<td class="ltx_td ltx_align_right" id="A2.T5.1.4.3.2">T5</td>
<td class="ltx_td ltx_align_right" id="A2.T5.1.4.3.3">37.34</td>
<td class="ltx_td ltx_align_right" id="A2.T5.1.4.3.4">60.42</td>
<td class="ltx_td ltx_align_right" id="A2.T5.1.4.3.5">68.70</td>
<td class="ltx_td ltx_align_right" id="A2.T5.1.4.3.6">74.76</td>
<td class="ltx_td ltx_nopad_r ltx_align_right" id="A2.T5.1.4.3.7">83.41</td>
</tr>
<tr class="ltx_tr" id="A2.T5.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T5.1.5.4.1">Two Round</th>
<td class="ltx_td ltx_align_right ltx_border_t" id="A2.T5.1.5.4.2">GTR</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="A2.T5.1.5.4.3">49.06</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="A2.T5.1.5.4.4">70.06</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="A2.T5.1.5.4.5">76.76</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="A2.T5.1.5.4.6">81.17</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="A2.T5.1.5.4.7">87.95</td>
</tr>
<tr class="ltx_tr" id="A2.T5.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T5.1.6.5.1">Corrector</th>
<td class="ltx_td ltx_align_right" id="A2.T5.1.6.5.2">GTR</td>
<td class="ltx_td ltx_align_right" id="A2.T5.1.6.5.3">49.61</td>
<td class="ltx_td ltx_align_right" id="A2.T5.1.6.5.4">70.72</td>
<td class="ltx_td ltx_align_right" id="A2.T5.1.6.5.5">77.04</td>
<td class="ltx_td ltx_align_right" id="A2.T5.1.6.5.6">82.33</td>
<td class="ltx_td ltx_nopad_r ltx_align_right" id="A2.T5.1.6.5.7">88.28</td>
</tr>
<tr class="ltx_tr" id="A2.T5.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A2.T5.1.7.6.1">Exhaustive</th>
<td class="ltx_td ltx_align_right ltx_border_bb" id="A2.T5.1.7.6.2">GTR</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="A2.T5.1.7.6.3">50.30</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="A2.T5.1.7.6.4">71.55</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="A2.T5.1.7.6.5">78.12</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="A2.T5.1.7.6.6">82.83</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb" id="A2.T5.1.7.6.7">88.59</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span><span class="ltx_text ltx_font_bold" id="A2.T5.3.1">Comparison with 2-round training.</span> We compare the performance of corrector networks, exhaustive re-encoding, and 2-round training. Results are presented on the NQ Test set.</figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="A2.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Comparisons with and without uniform negatives</h4>
<div class="ltx_para" id="A2.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="A2.SS2.SSS0.Px2.p1.1">In our main experiments (as stated in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#A2.SS1" title="B.1 Experimental Details ‣ Appendix B Experiments ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">B.1</span></a>) we train with hard negatives <em class="ltx_emph ltx_font_italic" id="A2.SS2.SSS0.Px2.p1.1.1">and</em> uniform negatives. Initial experiments showed that adding uniform negatives lead to improved performance in some settings. We provide some additional results ablating this choice using exhaustive re-encoding. These can be found in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#A2.T6" title="Table 6 ‣ Comparisons with and without uniform negatives ‣ B.2 Additional Dense Retrieval Results ‣ Appendix B Experiments ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">6</span></a>. We can see that this choice provides negligible improvement on the reported benchmarks (although we believe its worth trying in other settings).</p>
</div>
<figure class="ltx_table" id="A2.T6">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T6.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A2.T6.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A2.T6.1.1.1.1">Method</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="A2.T6.1.1.1.2">Base</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="A2.T6.1.1.1.3">R@1</th>
<th class="ltx_td ltx_nopad_r ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="A2.T6.1.1.1.4">R@100</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T6.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T6.1.2.1.1">With Uniform</th>
<td class="ltx_td ltx_align_right ltx_border_t" id="A2.T6.1.2.1.2">T5</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="A2.T6.1.2.1.3">24.70</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="A2.T6.1.2.1.4">79.94</td>
</tr>
<tr class="ltx_tr" id="A2.T6.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T6.1.3.2.1">Without Uniform</th>
<td class="ltx_td ltx_align_right" id="A2.T6.1.3.2.2">T5</td>
<td class="ltx_td ltx_align_right" id="A2.T6.1.3.2.3">24.87</td>
<td class="ltx_td ltx_nopad_r ltx_align_right" id="A2.T6.1.3.2.4">79.82</td>
</tr>
<tr class="ltx_tr" id="A2.T6.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T6.1.4.3.1">With Uniform</th>
<td class="ltx_td ltx_align_right ltx_border_t" id="A2.T6.1.4.3.2">GTR</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="A2.T6.1.4.3.3">36.29</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="A2.T6.1.4.3.4">91.73</td>
</tr>
<tr class="ltx_tr" id="A2.T6.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A2.T6.1.5.4.1">Without Uniform</th>
<td class="ltx_td ltx_align_right ltx_border_bb" id="A2.T6.1.5.4.2">GTR</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="A2.T6.1.5.4.3">36.53</td>
<td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb" id="A2.T6.1.5.4.4">91.70</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span><span class="ltx_text ltx_font_bold" id="A2.T6.3.1">Uniform Negatives Comparison.</span> We compare the performance of exhaustive re-encoding with and without the addition of uniform (in-batch) negatives. Results are presented on the NQ Dev set.</figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="A2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3 </span>Retrieve and Read</h3>
<div class="ltx_para" id="A2.SS3.p1">
<p class="ltx_p" id="A2.SS3.p1.1">Note that in this setting we do not share the subset of targets <math alttext="S(\mathcal{Y})" class="ltx_Math" display="inline" id="A2.SS3.p1.1.m1.1"><semantics id="A2.SS3.p1.1.m1.1a"><mrow id="A2.SS3.p1.1.m1.1.2" xref="A2.SS3.p1.1.m1.1.2.cmml"><mi id="A2.SS3.p1.1.m1.1.2.2" xref="A2.SS3.p1.1.m1.1.2.2.cmml">S</mi><mo id="A2.SS3.p1.1.m1.1.2.1" xref="A2.SS3.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="A2.SS3.p1.1.m1.1.2.3.2" xref="A2.SS3.p1.1.m1.1.2.cmml"><mo id="A2.SS3.p1.1.m1.1.2.3.2.1" stretchy="false" xref="A2.SS3.p1.1.m1.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="A2.SS3.p1.1.m1.1.1" xref="A2.SS3.p1.1.m1.1.1.cmml">𝒴</mi><mo id="A2.SS3.p1.1.m1.1.2.3.2.2" stretchy="false" xref="A2.SS3.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.1.m1.1b"><apply id="A2.SS3.p1.1.m1.1.2.cmml" xref="A2.SS3.p1.1.m1.1.2"><times id="A2.SS3.p1.1.m1.1.2.1.cmml" xref="A2.SS3.p1.1.m1.1.2.1"></times><ci id="A2.SS3.p1.1.m1.1.2.2.cmml" xref="A2.SS3.p1.1.m1.1.2.2">𝑆</ci><ci id="A2.SS3.p1.1.m1.1.1.cmml" xref="A2.SS3.p1.1.m1.1.1">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.1.m1.1c">S(\mathcal{Y})</annotation><annotation encoding="application/x-llamapun" id="A2.SS3.p1.1.m1.1d">italic_S ( caligraphic_Y )</annotation></semantics></math> across the examples in the batch, nor do we use targets sampled uniformly at random.</p>
</div>
<div class="ltx_para" id="A2.SS3.p2">
<p class="ltx_p" id="A2.SS3.p2.1">The versions of the retrieve-and read datasets are:</p>
<ul class="ltx_itemize" id="A2.I1">
<li class="ltx_item" id="A2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i1.p1">
<p class="ltx_p" id="A2.I1.i1.p1.1">TriviaQA: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.tensorflow.org/datasets/catalog/trivia_qa#trivia_qaunfilterednocontext" title="">https://www.tensorflow.org/datasets/catalog/trivia_qa#trivia_qaunfilterednocontext</a></p>
</div>
</li>
<li class="ltx_item" id="A2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i2.p1">
<p class="ltx_p" id="A2.I1.i2.p1.1">NQOpen <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.tensorflow.org/datasets/catalog/natural_questions_open" title="">https://www.tensorflow.org/datasets/catalog/natural_questions_open</a></p>
</div>
</li>
<li class="ltx_item" id="A2.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i3.p1">
<p class="ltx_p" id="A2.I1.i3.p1.1">HotPotQA <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.tensorflow.org/datasets/community_catalog/huggingface/hotpot_qa" title="">https://www.tensorflow.org/datasets/community_catalog/huggingface/hotpot_qa</a></p>
</div>
</li>
</ul>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_subsection" id="A2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.4 </span>Beyond Stale Representations: Approximating Large Models with Small Models</h3>
<div class="ltx_para" id="A2.SS4.p1">
<p class="ltx_p" id="A2.SS4.p1.2">In this experiment, we focus on sampling in isolation. We sample a batch of input points and we measure the ability of our method to approximate one dual encoder model with another. In particular, we study a case where we approximate a large dual encoder with a small model. We approximate the GTR large model <cite class="ltx_cite ltx_citemacro_citep">(Ni et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib26" title="">2021</a>)</cite> (e.g., <math alttext="g(\cdot)" class="ltx_Math" display="inline" id="A2.SS4.p1.1.m1.1"><semantics id="A2.SS4.p1.1.m1.1a"><mrow id="A2.SS4.p1.1.m1.1.2" xref="A2.SS4.p1.1.m1.1.2.cmml"><mi id="A2.SS4.p1.1.m1.1.2.2" xref="A2.SS4.p1.1.m1.1.2.2.cmml">g</mi><mo id="A2.SS4.p1.1.m1.1.2.1" xref="A2.SS4.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="A2.SS4.p1.1.m1.1.2.3.2" xref="A2.SS4.p1.1.m1.1.2.cmml"><mo id="A2.SS4.p1.1.m1.1.2.3.2.1" stretchy="false" xref="A2.SS4.p1.1.m1.1.2.cmml">(</mo><mo id="A2.SS4.p1.1.m1.1.1" lspace="0em" rspace="0em" xref="A2.SS4.p1.1.m1.1.1.cmml">⋅</mo><mo id="A2.SS4.p1.1.m1.1.2.3.2.2" stretchy="false" xref="A2.SS4.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS4.p1.1.m1.1b"><apply id="A2.SS4.p1.1.m1.1.2.cmml" xref="A2.SS4.p1.1.m1.1.2"><times id="A2.SS4.p1.1.m1.1.2.1.cmml" xref="A2.SS4.p1.1.m1.1.2.1"></times><ci id="A2.SS4.p1.1.m1.1.2.2.cmml" xref="A2.SS4.p1.1.m1.1.2.2">𝑔</ci><ci id="A2.SS4.p1.1.m1.1.1.cmml" xref="A2.SS4.p1.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS4.p1.1.m1.1c">g(\cdot)</annotation><annotation encoding="application/x-llamapun" id="A2.SS4.p1.1.m1.1d">italic_g ( ⋅ )</annotation></semantics></math>) with the GTR small model(e.g., <math alttext="g^{\prime}(\cdot)" class="ltx_Math" display="inline" id="A2.SS4.p1.2.m2.1"><semantics id="A2.SS4.p1.2.m2.1a"><mrow id="A2.SS4.p1.2.m2.1.2" xref="A2.SS4.p1.2.m2.1.2.cmml"><msup id="A2.SS4.p1.2.m2.1.2.2" xref="A2.SS4.p1.2.m2.1.2.2.cmml"><mi id="A2.SS4.p1.2.m2.1.2.2.2" xref="A2.SS4.p1.2.m2.1.2.2.2.cmml">g</mi><mo id="A2.SS4.p1.2.m2.1.2.2.3" xref="A2.SS4.p1.2.m2.1.2.2.3.cmml">′</mo></msup><mo id="A2.SS4.p1.2.m2.1.2.1" xref="A2.SS4.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="A2.SS4.p1.2.m2.1.2.3.2" xref="A2.SS4.p1.2.m2.1.2.cmml"><mo id="A2.SS4.p1.2.m2.1.2.3.2.1" stretchy="false" xref="A2.SS4.p1.2.m2.1.2.cmml">(</mo><mo id="A2.SS4.p1.2.m2.1.1" lspace="0em" rspace="0em" xref="A2.SS4.p1.2.m2.1.1.cmml">⋅</mo><mo id="A2.SS4.p1.2.m2.1.2.3.2.2" stretchy="false" xref="A2.SS4.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS4.p1.2.m2.1b"><apply id="A2.SS4.p1.2.m2.1.2.cmml" xref="A2.SS4.p1.2.m2.1.2"><times id="A2.SS4.p1.2.m2.1.2.1.cmml" xref="A2.SS4.p1.2.m2.1.2.1"></times><apply id="A2.SS4.p1.2.m2.1.2.2.cmml" xref="A2.SS4.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="A2.SS4.p1.2.m2.1.2.2.1.cmml" xref="A2.SS4.p1.2.m2.1.2.2">superscript</csymbol><ci id="A2.SS4.p1.2.m2.1.2.2.2.cmml" xref="A2.SS4.p1.2.m2.1.2.2.2">𝑔</ci><ci id="A2.SS4.p1.2.m2.1.2.2.3.cmml" xref="A2.SS4.p1.2.m2.1.2.2.3">′</ci></apply><ci id="A2.SS4.p1.2.m2.1.1.cmml" xref="A2.SS4.p1.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS4.p1.2.m2.1c">g^{\prime}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="A2.SS4.p1.2.m2.1d">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( ⋅ )</annotation></semantics></math>). In Table <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#A2.T7" title="Table 7 ‣ B.4 Beyond Stale Representations: Approximating Large Models with Small Models ‣ Appendix B Experiments ‣ A Fresh Take on Stale Embeddings: Improving Dense Retriever Training with Corrector Networks"><span class="ltx_text ltx_ref_tag">7</span></a>, we report nearest neighbor precision, i.e., measuring the overlap in the top-K neighbors from the large model’s neighbors at 10, 20, and 100 on the dataset Arguana <cite class="ltx_cite ltx_citemacro_citep">(Wachsmuth et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib37" title="">2018</a>)</cite> from the BEIR benchmark <cite class="ltx_cite ltx_citemacro_citep">(Thakur et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib34" title="">2021</a>)</cite>. We use 32 samples for each query to train the correction model. We find that overlap amongst smaller K seems to be better aligned using our method.</p>
</div>
<figure class="ltx_table" id="A2.T7">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T7.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A2.T7.2.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A2.T7.2.3.1.1">Performance</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="A2.T7.2.3.1.2">P@10</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="A2.T7.2.3.1.3">P@20</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="A2.T7.2.3.1.4">P@100</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T7.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T7.1.1.1"><math alttext="g^{\prime}(\cdot)" class="ltx_Math" display="inline" id="A2.T7.1.1.1.m1.1"><semantics id="A2.T7.1.1.1.m1.1a"><mrow id="A2.T7.1.1.1.m1.1.2" xref="A2.T7.1.1.1.m1.1.2.cmml"><msup id="A2.T7.1.1.1.m1.1.2.2" xref="A2.T7.1.1.1.m1.1.2.2.cmml"><mi id="A2.T7.1.1.1.m1.1.2.2.2" xref="A2.T7.1.1.1.m1.1.2.2.2.cmml">g</mi><mo id="A2.T7.1.1.1.m1.1.2.2.3" xref="A2.T7.1.1.1.m1.1.2.2.3.cmml">′</mo></msup><mo id="A2.T7.1.1.1.m1.1.2.1" xref="A2.T7.1.1.1.m1.1.2.1.cmml">⁢</mo><mrow id="A2.T7.1.1.1.m1.1.2.3.2" xref="A2.T7.1.1.1.m1.1.2.cmml"><mo id="A2.T7.1.1.1.m1.1.2.3.2.1" stretchy="false" xref="A2.T7.1.1.1.m1.1.2.cmml">(</mo><mo id="A2.T7.1.1.1.m1.1.1" lspace="0em" rspace="0em" xref="A2.T7.1.1.1.m1.1.1.cmml">⋅</mo><mo id="A2.T7.1.1.1.m1.1.2.3.2.2" stretchy="false" xref="A2.T7.1.1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.T7.1.1.1.m1.1b"><apply id="A2.T7.1.1.1.m1.1.2.cmml" xref="A2.T7.1.1.1.m1.1.2"><times id="A2.T7.1.1.1.m1.1.2.1.cmml" xref="A2.T7.1.1.1.m1.1.2.1"></times><apply id="A2.T7.1.1.1.m1.1.2.2.cmml" xref="A2.T7.1.1.1.m1.1.2.2"><csymbol cd="ambiguous" id="A2.T7.1.1.1.m1.1.2.2.1.cmml" xref="A2.T7.1.1.1.m1.1.2.2">superscript</csymbol><ci id="A2.T7.1.1.1.m1.1.2.2.2.cmml" xref="A2.T7.1.1.1.m1.1.2.2.2">𝑔</ci><ci id="A2.T7.1.1.1.m1.1.2.2.3.cmml" xref="A2.T7.1.1.1.m1.1.2.2.3">′</ci></apply><ci id="A2.T7.1.1.1.m1.1.1.cmml" xref="A2.T7.1.1.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T7.1.1.1.m1.1c">g^{\prime}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="A2.T7.1.1.1.m1.1d">italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( ⋅ )</annotation></semantics></math></th>
<td class="ltx_td ltx_align_right ltx_border_t" id="A2.T7.1.1.2">67.57</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="A2.T7.1.1.3">67.73</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="A2.T7.1.1.4">57.57</td>
</tr>
<tr class="ltx_tr" id="A2.T7.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A2.T7.2.2.1"><math alttext="h\circ g^{\prime}(\cdot)" class="ltx_Math" display="inline" id="A2.T7.2.2.1.m1.1"><semantics id="A2.T7.2.2.1.m1.1a"><mrow id="A2.T7.2.2.1.m1.1.2" xref="A2.T7.2.2.1.m1.1.2.cmml"><mrow id="A2.T7.2.2.1.m1.1.2.2" xref="A2.T7.2.2.1.m1.1.2.2.cmml"><mi id="A2.T7.2.2.1.m1.1.2.2.2" xref="A2.T7.2.2.1.m1.1.2.2.2.cmml">h</mi><mo id="A2.T7.2.2.1.m1.1.2.2.1" lspace="0.222em" rspace="0.222em" xref="A2.T7.2.2.1.m1.1.2.2.1.cmml">∘</mo><msup id="A2.T7.2.2.1.m1.1.2.2.3" xref="A2.T7.2.2.1.m1.1.2.2.3.cmml"><mi id="A2.T7.2.2.1.m1.1.2.2.3.2" xref="A2.T7.2.2.1.m1.1.2.2.3.2.cmml">g</mi><mo id="A2.T7.2.2.1.m1.1.2.2.3.3" xref="A2.T7.2.2.1.m1.1.2.2.3.3.cmml">′</mo></msup></mrow><mo id="A2.T7.2.2.1.m1.1.2.1" xref="A2.T7.2.2.1.m1.1.2.1.cmml">⁢</mo><mrow id="A2.T7.2.2.1.m1.1.2.3.2" xref="A2.T7.2.2.1.m1.1.2.cmml"><mo id="A2.T7.2.2.1.m1.1.2.3.2.1" stretchy="false" xref="A2.T7.2.2.1.m1.1.2.cmml">(</mo><mo id="A2.T7.2.2.1.m1.1.1" lspace="0em" rspace="0em" xref="A2.T7.2.2.1.m1.1.1.cmml">⋅</mo><mo id="A2.T7.2.2.1.m1.1.2.3.2.2" stretchy="false" xref="A2.T7.2.2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.T7.2.2.1.m1.1b"><apply id="A2.T7.2.2.1.m1.1.2.cmml" xref="A2.T7.2.2.1.m1.1.2"><times id="A2.T7.2.2.1.m1.1.2.1.cmml" xref="A2.T7.2.2.1.m1.1.2.1"></times><apply id="A2.T7.2.2.1.m1.1.2.2.cmml" xref="A2.T7.2.2.1.m1.1.2.2"><compose id="A2.T7.2.2.1.m1.1.2.2.1.cmml" xref="A2.T7.2.2.1.m1.1.2.2.1"></compose><ci id="A2.T7.2.2.1.m1.1.2.2.2.cmml" xref="A2.T7.2.2.1.m1.1.2.2.2">ℎ</ci><apply id="A2.T7.2.2.1.m1.1.2.2.3.cmml" xref="A2.T7.2.2.1.m1.1.2.2.3"><csymbol cd="ambiguous" id="A2.T7.2.2.1.m1.1.2.2.3.1.cmml" xref="A2.T7.2.2.1.m1.1.2.2.3">superscript</csymbol><ci id="A2.T7.2.2.1.m1.1.2.2.3.2.cmml" xref="A2.T7.2.2.1.m1.1.2.2.3.2">𝑔</ci><ci id="A2.T7.2.2.1.m1.1.2.2.3.3.cmml" xref="A2.T7.2.2.1.m1.1.2.2.3.3">′</ci></apply></apply><ci id="A2.T7.2.2.1.m1.1.1.cmml" xref="A2.T7.2.2.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T7.2.2.1.m1.1c">h\circ g^{\prime}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="A2.T7.2.2.1.m1.1d">italic_h ∘ italic_g start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( ⋅ )</annotation></semantics></math></th>
<td class="ltx_td ltx_align_right ltx_border_bb" id="A2.T7.2.2.2">76.87</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="A2.T7.2.2.3">73.32</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="A2.T7.2.2.4">53.55</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span><span class="ltx_text ltx_font_bold" id="A2.T7.4.1">Approximating Large Models with Small Models</span> On the dataset Arguana <cite class="ltx_cite ltx_citemacro_citep">(Wachsmuth et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.01890v1#bib.bib37" title="">2018</a>)</cite>, we use our method to warp the embedding space of GTR Small so that it is better aligned with GTR Large. Note that here we present nearest neighbor precision, i.e., the overlap in the top-K neighbors from the large model at 10, 20, and 100. We use 32 samples for each query to train the correction model.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Tue Sep  3 13:26:05 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
