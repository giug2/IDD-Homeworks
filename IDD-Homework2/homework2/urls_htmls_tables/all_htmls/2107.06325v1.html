<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2107.06325] Graphhopper: Multi-Hop Scene Graph Reasoning for Visual Question Answering</title><meta property="og:description" content="Visual Question Answering (VQA) is concerned with answering free-form questions about an image. Since it requires a deep semantic and linguistic understanding of the question and the ability to associate it with variou…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Graphhopper: Multi-Hop Scene Graph Reasoning for Visual Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Graphhopper: Multi-Hop Scene Graph Reasoning for Visual Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2107.06325">

<!--Generated on Sat Mar  2 04:54:43 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Visual Question Answering (VQA) Knowledge Graph Reasoning Scene Graph Reasoning Multi-Modal Reasoning Reinforcement Learning">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line"><span id="id1" class="ltx_note ltx_role_institutetext"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">institutetext: </span>Ludwig Maximilian University of Munich, Germany </span></span></span><span id="id2" class="ltx_note ltx_role_institutetext"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">institutetext: </span>Siemens AG, Germany </span></span></span><span id="id1a" class="ltx_note ltx_role_institutetext"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_note_type">institutetext: </span>Technical University of Munich, Germany 
<br class="ltx_break"><math id="id1.m1.1" class="ltx_Math" alttext="\,{}^{*}" display="inline"><semantics id="id1.m1.1b"><msup id="id1.m1.1.1" xref="id1.m1.1.1.cmml"><mi id="id1.m1.1.1b" xref="id1.m1.1.1.cmml"></mi><mo id="id1.m1.1.1.1" xref="id1.m1.1.1.1.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="id1.m1.1c"><apply id="id1.m1.1.1.cmml" xref="id1.m1.1.1"><times id="id1.m1.1.1.1.cmml" xref="id1.m1.1.1.1"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="id1.m1.1d">\,{}^{*}</annotation></semantics></math> equal contribution
</span></span></span>
<h1 class="ltx_title ltx_title_document">Graphhopper: Multi-Hop Scene Graph Reasoning for Visual Question Answering</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Rajat Koner 
</span><span class="ltx_author_notes">*1*1</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hang Li
</span><span class="ltx_author_notes">*1*122</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Marcel Hildebrandt
</span><span class="ltx_author_notes">*1*122</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Deepan Das
</span><span class="ltx_author_notes">33</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Volker Tresp
</span><span class="ltx_author_notes">1122</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Stephan Günnemann
</span><span class="ltx_author_notes">33</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.id1" class="ltx_p">Visual Question Answering (VQA) is concerned with answering free-form questions about an image. Since it requires a deep semantic and linguistic understanding of the question and the ability to associate it with various objects that are present in the image, it is an ambitious task and requires multi-modal reasoning from both computer vision and natural language processing. We propose Graphhopper, a novel method that approaches the task by integrating knowledge graph reasoning, computer vision, and natural language processing techniques. Concretely, our method is based on performing context-driven, sequential reasoning based on the scene entities and their semantic and spatial relationships. As a first step, we derive a scene graph that describes the objects in the image, as well as their attributes and their mutual relationships. Subsequently, a reinforcement learning agent is trained to autonomously navigate in a multi-hop manner over the extracted scene graph to generate reasoning paths, which are the basis for deriving answers. We conduct an experimental study on the challenging dataset GQA, based on both manually curated and automatically generated scene graphs. Our results show that we keep up with human performance on manually curated scene graphs. Moreover, we find that Graphhopper outperforms another state-of-the-art scene graph reasoning model on both manually curated and automatically generated scene graphs by a significant margin.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Keywords: </h6>Visual Question Answering (VQA) Knowledge Graph Reasoning Scene Graph Reasoning Multi-Modal Reasoning Reinforcement Learning
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<figure id="S1.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S1.F1.1" class="ltx_figure ltx_figure_panel"><img src="/html/2107.06325/assets/motorbike_img.jpeg" id="S1.F1.1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="255" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S1.F1.2" class="ltx_figure ltx_figure_panel"><img src="/html/2107.06325/assets/motorbike_sg.png" id="S1.F1.2.g1" class="ltx_graphics ltx_img_square" width="598" height="673" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.4.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.5.2" class="ltx_text" style="font-size:90%;">Example of an image and the corresponding scene graph. Since the scene graph is a directed graph with typed edges, it resembles a knowledge graph and permits the application of knowledge-base completion techniques.
</span></figcaption>
</figure>
<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Visual Question Answering (VQA) is a challenging task that involves understanding and reasoning over two data modalities, i.e., images and natural language. Given an image and a free-form question which formulates a query about the presented scene — the issue is for the algorithm to find the correct answer.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">VQA has been studied from the perspective of scene and knowledge graphs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, as well as vision-language reasoning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. To study VQA, various real-world data sets, such as the <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">VQA</span> data set <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, have been generated.
It has been argued that, in the <span id="S1.p2.1.2" class="ltx_text ltx_font_italic">VQA</span> data set, many of the apparently challenging reasoning tasks can be solved by an algorithm through exploiting trivial prior knowledge, and thus by shortcuts to proper reasoning
(e.g., clouds are white or doors are made of wood).
To address these shortcomings, the <span id="S1.p2.1.3" class="ltx_text ltx_font_italic">GQA</span> dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> has been developed.
Compared to other real-world datasets, <span id="S1.p2.1.4" class="ltx_text ltx_font_italic">GQA</span> is more suitable for evaluating reasoning abilities since the images and questions are carefully filtered to make the data less prone to biases.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Plenty of VQA approaches are agnostic towards the explicit relational structure of the objects in the presented scene and rely on monolithic neural network architectures that process regional features of the image separately <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>. While these methods led to promising results on previous datasets, they lack explicit compositional reasoning abilities, which results in weaker performance on more challenging datasets such as <span id="S1.p3.1.1" class="ltx_text ltx_font_italic">GQA</span>.
Other works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> perform reasoning on explicitly detected objects and interactive semantic and spatial relationships among them. These approaches are closely related to the scene graph representations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> of an image, where detected objects are labeled as nodes and relationships between the objects are labeled as edges.
In this work, we aim to combine VQA techniques with recent research advances in the area of statistical relation learning on knowledge graphs (KGs).
KGs provide human-understandable, structured representations of knowledge about the real world via collections of factual statements. Inspired by multi-hop reasoning methods on KGs such as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, we propose Graphhopper, a novel method that models the VQA task as a path-finding problem on scene graphs. The underlying idea can be summarized with the phrase: Learn to walk to the correct answer. More specifically, given an image, we consider a scene graph and train a reinforcement learning agent to conduct a policy-guided random walk on the scene graph until a conclusive inference path is obtained. In contrast to purely embedding-based approaches, our method provides explicit reasoning chains that lead to the derived answers. To sum up, our major contributions are as follows.</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">Graphhopper is the first VQA method that employs reinforcement learning for multi-hop reasoning on scene graphs.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We conduct a thorough experimental study on the challenging VQA dataset named QGA to show the compositional and <span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_italic">interpretable</span> nature of our model.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">To analyze the reasoning capabilities of our method, we consider manually curated (ground truth) scene graphs. This setting isolates the noise associated with the visual perception task and focuses solely on the language understanding and reasoning task. Thereby, we can show that our method achieves human-like performance.</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p id="S1.I1.i4.p1.1" class="ltx_p">Based on both the manually curated scene graphs and our own automatically generated scene graphs, we show that Graphhopper outperforms the Neural State Machine (NMS), a state-of-the-art scene graph reasoning model that operates in a setting, similar to Graphhopper.</p>
</div>
</li>
</ul>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Moreover, we are the first group to conduct experiments and publish the code on generated scene graphs for the GQA dataset<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Code is available at :<a target="_blank" href="https://github.com/rajatkoner08/Graphhopper" title="" class="ltx_ref">https://github.com/rajatkoner08/Graphhopper</a></span></span></span>.The remainder of this work is organized as follows. We review related literature in the next section. Section <a href="#S3" title="3 Method ‣ Graphhopper: Multi-Hop Scene Graph Reasoning for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> introduces the notation and describes the methodology of Graphhopper. Section <a href="#S4" title="4 Dataset and Experimental Setup ‣ Graphhopper: Multi-Hop Scene Graph Reasoning for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> and Section <a href="#S5" title="5 Results and Discussion ‣ Graphhopper: Multi-Hop Scene Graph Reasoning for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> detail an experimental study on the benchmark dataset GQA. Furthermore, through a rigorous study using both manually-curated ground-truth and generated scene graphs, we examine the reasoning capabilities of Graphhopper. We conclude in Section <a href="#S6" title="6 Conclusion ‣ Graphhopper: Multi-Hop Scene Graph Reasoning for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<section id="S2.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Visual Question Answering:</h4>

<div id="S2.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px1.p1.1" class="ltx_p">Various models have been proposed that perform VQA on both real-world <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> and artificial datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. Currently, leading VQA approaches can be categorized into two different branches: First, monolithic neural networks, which perform implicit reasoning on latent representations obtained from fusing the two data modalities. Second, multi-hop methods that form explicit symbolic reasoning chains on a structured representation of the data. Monolithic network architectures obtain visual features from the image either in the form of individual detected objects or by processing the whole image directly via convolutional neural networks (CNNs). The derived embeddings are usually scored against a fixed answer set along with the embedding of the question obtained from a sequence model. Moreover, co-attention mechanisms are frequently employed to couple the vision and the language models allowing for interactions between objects from both modalities <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>. Monolithic networks are among the dominant methods on previous real-world VQA datasets such as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>.
However, they suffer from the black-box problem and possess limited reasoning capabilities with respect to complex questions that require long reasoning chains (see <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> for a detailed discussion).</p>
</div>
<div id="S2.SS0.SSS0.Px1.p2" class="ltx_para">
<p id="S2.SS0.SSS0.Px1.p2.1" class="ltx_p">Explicit reasoning methods combine the sub-symbolic representation learning paradigm with symbolic reasoning approaches over structured representations of the image. Most of the popular explicit reasoning approaches follow the idea of neural module networks (NMNs) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> which perform a sequence of reasoning steps realized by forward passes through specialized neural networks that each correspond to predefined reasoning subtasks. Thereby, NMNs construct functional programs by dynamically assembling the modules resulting in a question-specific neural network architecture. In contrast to the monolithic neural network architectures described above, these methods contain a natural transparency mechanism via functional programs. However, while NMN-related methods (e.g., <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>) exhibit good performance on synthetic datasets such as CLEVR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, they require functional module layouts as additional supervision signals to obtain good results. Closely related to our method is the Neural State Machine (NSM) proposed by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. NSM’s underlying idea consists of first constructing a scene graph from an image and treating it as a state machine. Concretely, the nodes correspond to states and edges to transitions. Then, conditioned on the question, a sequence of instructions is derived that indicates how to traverse the scene graph and arrive at the answer. In contrast to NSM, we treat path-finding as a decision problem in a reinforcement learning setting. Concretely, we outline in the next section how extracting predictive paths from scene graphs can be naturally formulated in terms of a goal-oriented random walk induced by a stochastic policy that allows the approach to balance between exploration and exploitation. Moreover, our framework integrates state-of-the-art techniques from graph representation learning and NLP. This paper only considers basic policy gradient methods, but more sophisticated reinforcement learning techniques will be employed in future works.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Statistical Relational Learning:</h4>

<div id="S2.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px2.p1.1" class="ltx_p">Machine learning methods for KG reasoning aim at exploiting statistical regularities in observed connectivity patterns. These methods are studied under the umbrella of statistical relational learning (SRL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>. In recent years, KG embeddings have become the dominant approach in SRL. The underlying idea is that graph features that explain the connectivity pattern of KGs can be encoded in low-dimensional vector spaces. In the embedding spaces, the interactions among the embeddings for entities and relations can be efficiently modeled to produce scores that predict the validity of a triple. Despite achieving good results in KG reasoning tasks, most embedding-based methods have problems capturing the compositionality expressed by long reasoning chains. This often limits their applicability in complex reasoning tasks. Recently, multi-hop reasoning methods such as MINERVA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> and DeepPath <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> were proposed. Both methods are based on the idea that a reinforcement learning agent is trained to perform a policy-guided random walk until the answer entity to a query is reached. Thereby, the path finding problem of the agent can be modeled in terms of a sequential decision making task framed as a Markov decision process (MDP). The method that we propose in this work follows a similar philosophy, in the sense that we train an RL agent to navigate on a scene graph to the correct answer node. However, a conceptual difference is that the agents in MINERVA and DeepPath perform walks on large-scale knowledge graphs exploiting repeating statistical patterns. Thereby, the policies implicitly incorporate approximate rules. In addition, instead of free-form processing questions, the query in the KG reasoning setting is structured as a pair of symbolic entities. That is why we propose a wide range of modifications to adjust our method to the challenging VQA setting.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">The task of VQA is framed as a scene graph traversal problem. Starting from a hub node that is connected to all other nodes, an agent sequentially samples transitions to neighboring nodes on the scene graph until the node corresponding to the answer is reached. In this way, by adding transitions to the current path, the reasoning chain is successively extended. Before describing the decision problem of the agent, we introduce the notation that we use throughout this work.</p>
</div>
<section id="S3.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Notation:</h4>

<div id="S3.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S3.SS0.SSS0.Px1.p1.8" class="ltx_p">A scene graph is a directed multigraph where each node corresponds to a scene entity which is either an object associated with a bounding box or an attribute of an object. Each scene entity comes with a type that corresponds to the predicted object or attribute label. Typed edges specify how scene entities are related to each other. More formally, let <math id="S3.SS0.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.1.m1.1b"><ci id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.1.m1.1c">\mathcal{E}</annotation></semantics></math> denote the set of scene entities and consider the set of binary relations <math id="S3.SS0.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{R}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.2.m2.1b"><ci id="S3.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.2.m2.1c">\mathcal{R}</annotation></semantics></math>. Then a scene graph <math id="S3.SS0.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{SG}\subset\mathcal{E}\times\mathcal{R}\times\mathcal{E}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.3.m3.1a"><mrow id="S3.SS0.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.cmml"><mrow id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.2" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.2" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.2.cmml">𝒮</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.1" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.3" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.3.cmml">𝒢</mi></mrow><mo id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.1" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.1.cmml">⊂</mo><mrow id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.2" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.2.cmml">ℰ</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.1" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.3" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.3.cmml">ℛ</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.1a" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.4" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.4.cmml">ℰ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.3.m3.1b"><apply id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1"><subset id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.1"></subset><apply id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.2"><times id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.1"></times><ci id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.2">𝒮</ci><ci id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.3">𝒢</ci></apply><apply id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3"><times id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.1"></times><ci id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.2">ℰ</ci><ci id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.3">ℛ</ci><ci id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.4.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.4">ℰ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.3.m3.1c">\mathcal{SG}\subset\mathcal{E}\times\mathcal{R}\times\mathcal{E}</annotation></semantics></math> is a collection of ordered triples <math id="S3.SS0.SSS0.Px1.p1.4.m4.3" class="ltx_Math" alttext="(s,p,o)" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.4.m4.3a"><mrow id="S3.SS0.SSS0.Px1.p1.4.m4.3.4.2" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.4.1.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px1.p1.4.m4.3.4.2.1" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.4.1.cmml">(</mo><mi id="S3.SS0.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS0.SSS0.Px1.p1.4.m4.1.1.cmml">s</mi><mo id="S3.SS0.SSS0.Px1.p1.4.m4.3.4.2.2" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.4.1.cmml">,</mo><mi id="S3.SS0.SSS0.Px1.p1.4.m4.2.2" xref="S3.SS0.SSS0.Px1.p1.4.m4.2.2.cmml">p</mi><mo id="S3.SS0.SSS0.Px1.p1.4.m4.3.4.2.3" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.4.1.cmml">,</mo><mi id="S3.SS0.SSS0.Px1.p1.4.m4.3.3" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3.cmml">o</mi><mo stretchy="false" id="S3.SS0.SSS0.Px1.p1.4.m4.3.4.2.4" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.4.m4.3b"><vector id="S3.SS0.SSS0.Px1.p1.4.m4.3.4.1.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.4.2"><ci id="S3.SS0.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.1.1">𝑠</ci><ci id="S3.SS0.SSS0.Px1.p1.4.m4.2.2.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.2.2">𝑝</ci><ci id="S3.SS0.SSS0.Px1.p1.4.m4.3.3.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.3.3">𝑜</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.4.m4.3c">(s,p,o)</annotation></semantics></math> – subject, predicate, and object. For example, as shown in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Graphhopper: Multi-Hop Scene Graph Reasoning for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the triple <span id="S3.SS0.SSS0.Px1.p1.8.1" class="ltx_text ltx_font_italic">(motorcycle-1, has_part, tire-1)</span> indicates that both a motorcycle (subject) and a tire (object) are detected in the image. The predicate <span id="S3.SS0.SSS0.Px1.p1.8.2" class="ltx_text ltx_font_italic">has_part</span> indicates the relation between the entities. Moreover, we denote with <math id="S3.SS0.SSS0.Px1.p1.5.m5.1" class="ltx_Math" alttext="p^{-1}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.5.m5.1a"><msup id="S3.SS0.SSS0.Px1.p1.5.m5.1.1" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.5.m5.1.1.2" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1.2.cmml">p</mi><mrow id="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3.cmml"><mo id="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3a" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3.cmml">−</mo><mn id="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3.2" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3.2.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.5.m5.1b"><apply id="S3.SS0.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.5.m5.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1">superscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.5.m5.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1.2">𝑝</ci><apply id="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3"><minus id="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3"></minus><cn type="integer" id="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.5.m5.1c">p^{-1}</annotation></semantics></math> the inverse relation corresponding to the predicate <math id="S3.SS0.SSS0.Px1.p1.6.m6.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.6.m6.1a"><mi id="S3.SS0.SSS0.Px1.p1.6.m6.1.1" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.6.m6.1b"><ci id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.6.m6.1c">p</annotation></semantics></math>. For the remainder of this work, we impose completeness with respect to inverse relations in the sense that for every <math id="S3.SS0.SSS0.Px1.p1.7.m7.3" class="ltx_Math" alttext="(s,p,o)\in\mathcal{SG}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.7.m7.3a"><mrow id="S3.SS0.SSS0.Px1.p1.7.m7.3.4" xref="S3.SS0.SSS0.Px1.p1.7.m7.3.4.cmml"><mrow id="S3.SS0.SSS0.Px1.p1.7.m7.3.4.2.2" xref="S3.SS0.SSS0.Px1.p1.7.m7.3.4.2.1.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px1.p1.7.m7.3.4.2.2.1" xref="S3.SS0.SSS0.Px1.p1.7.m7.3.4.2.1.cmml">(</mo><mi id="S3.SS0.SSS0.Px1.p1.7.m7.1.1" xref="S3.SS0.SSS0.Px1.p1.7.m7.1.1.cmml">s</mi><mo id="S3.SS0.SSS0.Px1.p1.7.m7.3.4.2.2.2" xref="S3.SS0.SSS0.Px1.p1.7.m7.3.4.2.1.cmml">,</mo><mi id="S3.SS0.SSS0.Px1.p1.7.m7.2.2" xref="S3.SS0.SSS0.Px1.p1.7.m7.2.2.cmml">p</mi><mo id="S3.SS0.SSS0.Px1.p1.7.m7.3.4.2.2.3" xref="S3.SS0.SSS0.Px1.p1.7.m7.3.4.2.1.cmml">,</mo><mi id="S3.SS0.SSS0.Px1.p1.7.m7.3.3" xref="S3.SS0.SSS0.Px1.p1.7.m7.3.3.cmml">o</mi><mo stretchy="false" id="S3.SS0.SSS0.Px1.p1.7.m7.3.4.2.2.4" xref="S3.SS0.SSS0.Px1.p1.7.m7.3.4.2.1.cmml">)</mo></mrow><mo id="S3.SS0.SSS0.Px1.p1.7.m7.3.4.1" xref="S3.SS0.SSS0.Px1.p1.7.m7.3.4.1.cmml">∈</mo><mrow id="S3.SS0.SSS0.Px1.p1.7.m7.3.4.3" xref="S3.SS0.SSS0.Px1.p1.7.m7.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p1.7.m7.3.4.3.2" xref="S3.SS0.SSS0.Px1.p1.7.m7.3.4.3.2.cmml">𝒮</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px1.p1.7.m7.3.4.3.1" xref="S3.SS0.SSS0.Px1.p1.7.m7.3.4.3.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p1.7.m7.3.4.3.3" xref="S3.SS0.SSS0.Px1.p1.7.m7.3.4.3.3.cmml">𝒢</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.7.m7.3b"><apply id="S3.SS0.SSS0.Px1.p1.7.m7.3.4.cmml" xref="S3.SS0.SSS0.Px1.p1.7.m7.3.4"><in id="S3.SS0.SSS0.Px1.p1.7.m7.3.4.1.cmml" xref="S3.SS0.SSS0.Px1.p1.7.m7.3.4.1"></in><vector id="S3.SS0.SSS0.Px1.p1.7.m7.3.4.2.1.cmml" xref="S3.SS0.SSS0.Px1.p1.7.m7.3.4.2.2"><ci id="S3.SS0.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.7.m7.1.1">𝑠</ci><ci id="S3.SS0.SSS0.Px1.p1.7.m7.2.2.cmml" xref="S3.SS0.SSS0.Px1.p1.7.m7.2.2">𝑝</ci><ci id="S3.SS0.SSS0.Px1.p1.7.m7.3.3.cmml" xref="S3.SS0.SSS0.Px1.p1.7.m7.3.3">𝑜</ci></vector><apply id="S3.SS0.SSS0.Px1.p1.7.m7.3.4.3.cmml" xref="S3.SS0.SSS0.Px1.p1.7.m7.3.4.3"><times id="S3.SS0.SSS0.Px1.p1.7.m7.3.4.3.1.cmml" xref="S3.SS0.SSS0.Px1.p1.7.m7.3.4.3.1"></times><ci id="S3.SS0.SSS0.Px1.p1.7.m7.3.4.3.2.cmml" xref="S3.SS0.SSS0.Px1.p1.7.m7.3.4.3.2">𝒮</ci><ci id="S3.SS0.SSS0.Px1.p1.7.m7.3.4.3.3.cmml" xref="S3.SS0.SSS0.Px1.p1.7.m7.3.4.3.3">𝒢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.7.m7.3c">(s,p,o)\in\mathcal{SG}</annotation></semantics></math> it is implied that <math id="S3.SS0.SSS0.Px1.p1.8.m8.3" class="ltx_Math" alttext="(o,p^{-1},s)\in\mathcal{SG}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.8.m8.3a"><mrow id="S3.SS0.SSS0.Px1.p1.8.m8.3.3" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.cmml"><mrow id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1.2" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.2.cmml">(</mo><mi id="S3.SS0.SSS0.Px1.p1.8.m8.1.1" xref="S3.SS0.SSS0.Px1.p1.8.m8.1.1.cmml">o</mi><mo id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1.3" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.2.cmml">,</mo><msup id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1.1" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1.1.2" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1.1.2.cmml">p</mi><mrow id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1.1.3" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1.1.3.cmml"><mo id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1.1.3a" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1.1.3.cmml">−</mo><mn id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1.1.3.2" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1.1.3.2.cmml">1</mn></mrow></msup><mo id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1.4" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.2.cmml">,</mo><mi id="S3.SS0.SSS0.Px1.p1.8.m8.2.2" xref="S3.SS0.SSS0.Px1.p1.8.m8.2.2.cmml">s</mi><mo stretchy="false" id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1.5" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.2.cmml">)</mo></mrow><mo id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.2" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.2.cmml">∈</mo><mrow id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.3" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.3.2" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.3.2.cmml">𝒮</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.3.1" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.3.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.3.3" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.3.3.cmml">𝒢</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.8.m8.3b"><apply id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.cmml" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3"><in id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.2.cmml" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.2"></in><vector id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1"><ci id="S3.SS0.SSS0.Px1.p1.8.m8.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.8.m8.1.1">𝑜</ci><apply id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1.1">superscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1.1.2">𝑝</ci><apply id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1.1.3"><minus id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1.1.3"></minus><cn type="integer" id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.1.1.1.3.2">1</cn></apply></apply><ci id="S3.SS0.SSS0.Px1.p1.8.m8.2.2.cmml" xref="S3.SS0.SSS0.Px1.p1.8.m8.2.2">𝑠</ci></vector><apply id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.3.cmml" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.3"><times id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.3.1.cmml" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.3.1"></times><ci id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.3.2.cmml" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.3.2">𝒮</ci><ci id="S3.SS0.SSS0.Px1.p1.8.m8.3.3.3.3.cmml" xref="S3.SS0.SSS0.Px1.p1.8.m8.3.3.3.3">𝒢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.8.m8.3c">(o,p^{-1},s)\in\mathcal{SG}</annotation></semantics></math>.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2107.06325/assets/Architecture_Compact.png" id="S3.F2.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="317" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.3.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S3.F2.4.2" class="ltx_text" style="font-size:90%;">The architecture of our scene graph reasoning module.
</span></figcaption>
</figure>
</section>
<section id="S3.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Environment</h4>

<div id="S3.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S3.SS0.SSS0.Px2.p1.18" class="ltx_p">The state space of the agent <math id="S3.SS0.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.1.m1.1b"><ci id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.1.m1.1c">\mathcal{S}</annotation></semantics></math> is given by <math id="S3.SS0.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{E}\times\mathcal{Q}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.2.m2.1a"><mrow id="S3.SS0.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.2" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml">ℰ</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.3" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml">𝒬</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.2.m2.1b"><apply id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1"><times id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1"></times><ci id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.2">ℰ</ci><ci id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.3">𝒬</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.2.m2.1c">\mathcal{E}\times\mathcal{Q}</annotation></semantics></math> where <math id="S3.SS0.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.3.m3.1b"><ci id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.3.m3.1c">\mathcal{E}</annotation></semantics></math> are the nodes of a scene graph <math id="S3.SS0.SSS0.Px2.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{SG}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.4.m4.1a"><mrow id="S3.SS0.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.2" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.2.cmml">𝒮</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.1" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.cmml">𝒢</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.4.m4.1b"><apply id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1"><times id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.1"></times><ci id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.2">𝒮</ci><ci id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3">𝒢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.4.m4.1c">\mathcal{SG}</annotation></semantics></math> and <math id="S3.SS0.SSS0.Px2.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{Q}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px2.p1.5.m5.1.1" xref="S3.SS0.SSS0.Px2.p1.5.m5.1.1.cmml">𝒬</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.5.m5.1b"><ci id="S3.SS0.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.5.m5.1.1">𝒬</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.5.m5.1c">\mathcal{Q}</annotation></semantics></math> denotes the set of all questions. The state at time <math id="S3.SS0.SSS0.Px2.p1.6.m6.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.6.m6.1a"><mi id="S3.SS0.SSS0.Px2.p1.6.m6.1.1" xref="S3.SS0.SSS0.Px2.p1.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.6.m6.1b"><ci id="S3.SS0.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.6.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.6.m6.1c">t</annotation></semantics></math> is the entity <math id="S3.SS0.SSS0.Px2.p1.7.m7.1" class="ltx_Math" alttext="e_{t}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.7.m7.1a"><msub id="S3.SS0.SSS0.Px2.p1.7.m7.1.1" xref="S3.SS0.SSS0.Px2.p1.7.m7.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p1.7.m7.1.1.2" xref="S3.SS0.SSS0.Px2.p1.7.m7.1.1.2.cmml">e</mi><mi id="S3.SS0.SSS0.Px2.p1.7.m7.1.1.3" xref="S3.SS0.SSS0.Px2.p1.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.7.m7.1b"><apply id="S3.SS0.SSS0.Px2.p1.7.m7.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.7.m7.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.7.m7.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.7.m7.1.1.2">𝑒</ci><ci id="S3.SS0.SSS0.Px2.p1.7.m7.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.7.m7.1c">e_{t}</annotation></semantics></math> at which the agent is currently located and the question <math id="S3.SS0.SSS0.Px2.p1.8.m8.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.8.m8.1a"><mi id="S3.SS0.SSS0.Px2.p1.8.m8.1.1" xref="S3.SS0.SSS0.Px2.p1.8.m8.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.8.m8.1b"><ci id="S3.SS0.SSS0.Px2.p1.8.m8.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.8.m8.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.8.m8.1c">Q</annotation></semantics></math>. Thus, a state <math id="S3.SS0.SSS0.Px2.p1.9.m9.1" class="ltx_Math" alttext="S_{t}\in\mathcal{S}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.9.m9.1a"><mrow id="S3.SS0.SSS0.Px2.p1.9.m9.1.1" xref="S3.SS0.SSS0.Px2.p1.9.m9.1.1.cmml"><msub id="S3.SS0.SSS0.Px2.p1.9.m9.1.1.2" xref="S3.SS0.SSS0.Px2.p1.9.m9.1.1.2.cmml"><mi id="S3.SS0.SSS0.Px2.p1.9.m9.1.1.2.2" xref="S3.SS0.SSS0.Px2.p1.9.m9.1.1.2.2.cmml">S</mi><mi id="S3.SS0.SSS0.Px2.p1.9.m9.1.1.2.3" xref="S3.SS0.SSS0.Px2.p1.9.m9.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS0.SSS0.Px2.p1.9.m9.1.1.1" xref="S3.SS0.SSS0.Px2.p1.9.m9.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px2.p1.9.m9.1.1.3" xref="S3.SS0.SSS0.Px2.p1.9.m9.1.1.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.9.m9.1b"><apply id="S3.SS0.SSS0.Px2.p1.9.m9.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.9.m9.1.1"><in id="S3.SS0.SSS0.Px2.p1.9.m9.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.9.m9.1.1.1"></in><apply id="S3.SS0.SSS0.Px2.p1.9.m9.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.9.m9.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px2.p1.9.m9.1.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.9.m9.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.9.m9.1.1.2.2">𝑆</ci><ci id="S3.SS0.SSS0.Px2.p1.9.m9.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px2.p1.9.m9.1.1.2.3">𝑡</ci></apply><ci id="S3.SS0.SSS0.Px2.p1.9.m9.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.9.m9.1.1.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.9.m9.1c">S_{t}\in\mathcal{S}</annotation></semantics></math> for time <math id="S3.SS0.SSS0.Px2.p1.10.m10.1" class="ltx_Math" alttext="t\in\mathbb{N}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.10.m10.1a"><mrow id="S3.SS0.SSS0.Px2.p1.10.m10.1.1" xref="S3.SS0.SSS0.Px2.p1.10.m10.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p1.10.m10.1.1.2" xref="S3.SS0.SSS0.Px2.p1.10.m10.1.1.2.cmml">t</mi><mo id="S3.SS0.SSS0.Px2.p1.10.m10.1.1.1" xref="S3.SS0.SSS0.Px2.p1.10.m10.1.1.1.cmml">∈</mo><mi id="S3.SS0.SSS0.Px2.p1.10.m10.1.1.3" xref="S3.SS0.SSS0.Px2.p1.10.m10.1.1.3.cmml">ℕ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.10.m10.1b"><apply id="S3.SS0.SSS0.Px2.p1.10.m10.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.10.m10.1.1"><in id="S3.SS0.SSS0.Px2.p1.10.m10.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.10.m10.1.1.1"></in><ci id="S3.SS0.SSS0.Px2.p1.10.m10.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.10.m10.1.1.2">𝑡</ci><ci id="S3.SS0.SSS0.Px2.p1.10.m10.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.10.m10.1.1.3">ℕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.10.m10.1c">t\in\mathbb{N}</annotation></semantics></math> is represented by <math id="S3.SS0.SSS0.Px2.p1.11.m11.2" class="ltx_Math" alttext="S_{t}=\left(e_{t},Q\right)" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.11.m11.2a"><mrow id="S3.SS0.SSS0.Px2.p1.11.m11.2.2" xref="S3.SS0.SSS0.Px2.p1.11.m11.2.2.cmml"><msub id="S3.SS0.SSS0.Px2.p1.11.m11.2.2.3" xref="S3.SS0.SSS0.Px2.p1.11.m11.2.2.3.cmml"><mi id="S3.SS0.SSS0.Px2.p1.11.m11.2.2.3.2" xref="S3.SS0.SSS0.Px2.p1.11.m11.2.2.3.2.cmml">S</mi><mi id="S3.SS0.SSS0.Px2.p1.11.m11.2.2.3.3" xref="S3.SS0.SSS0.Px2.p1.11.m11.2.2.3.3.cmml">t</mi></msub><mo id="S3.SS0.SSS0.Px2.p1.11.m11.2.2.2" xref="S3.SS0.SSS0.Px2.p1.11.m11.2.2.2.cmml">=</mo><mrow id="S3.SS0.SSS0.Px2.p1.11.m11.2.2.1.1" xref="S3.SS0.SSS0.Px2.p1.11.m11.2.2.1.2.cmml"><mo id="S3.SS0.SSS0.Px2.p1.11.m11.2.2.1.1.2" xref="S3.SS0.SSS0.Px2.p1.11.m11.2.2.1.2.cmml">(</mo><msub id="S3.SS0.SSS0.Px2.p1.11.m11.2.2.1.1.1" xref="S3.SS0.SSS0.Px2.p1.11.m11.2.2.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p1.11.m11.2.2.1.1.1.2" xref="S3.SS0.SSS0.Px2.p1.11.m11.2.2.1.1.1.2.cmml">e</mi><mi id="S3.SS0.SSS0.Px2.p1.11.m11.2.2.1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.11.m11.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS0.SSS0.Px2.p1.11.m11.2.2.1.1.3" xref="S3.SS0.SSS0.Px2.p1.11.m11.2.2.1.2.cmml">,</mo><mi id="S3.SS0.SSS0.Px2.p1.11.m11.1.1" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1.cmml">Q</mi><mo id="S3.SS0.SSS0.Px2.p1.11.m11.2.2.1.1.4" xref="S3.SS0.SSS0.Px2.p1.11.m11.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.11.m11.2b"><apply id="S3.SS0.SSS0.Px2.p1.11.m11.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.2.2"><eq id="S3.SS0.SSS0.Px2.p1.11.m11.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.2.2.2"></eq><apply id="S3.SS0.SSS0.Px2.p1.11.m11.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.2.2.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.11.m11.2.2.3.1.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.2.2.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.11.m11.2.2.3.2.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.2.2.3.2">𝑆</ci><ci id="S3.SS0.SSS0.Px2.p1.11.m11.2.2.3.3.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.2.2.3.3">𝑡</ci></apply><interval closure="open" id="S3.SS0.SSS0.Px2.p1.11.m11.2.2.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.2.2.1.1"><apply id="S3.SS0.SSS0.Px2.p1.11.m11.2.2.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.11.m11.2.2.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.2.2.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.11.m11.2.2.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.2.2.1.1.1.2">𝑒</ci><ci id="S3.SS0.SSS0.Px2.p1.11.m11.2.2.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.2.2.1.1.1.3">𝑡</ci></apply><ci id="S3.SS0.SSS0.Px2.p1.11.m11.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.11.m11.1.1">𝑄</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.11.m11.2c">S_{t}=\left(e_{t},Q\right)</annotation></semantics></math>. The set of available actions from a state <math id="S3.SS0.SSS0.Px2.p1.12.m12.1" class="ltx_Math" alttext="S_{t}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.12.m12.1a"><msub id="S3.SS0.SSS0.Px2.p1.12.m12.1.1" xref="S3.SS0.SSS0.Px2.p1.12.m12.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p1.12.m12.1.1.2" xref="S3.SS0.SSS0.Px2.p1.12.m12.1.1.2.cmml">S</mi><mi id="S3.SS0.SSS0.Px2.p1.12.m12.1.1.3" xref="S3.SS0.SSS0.Px2.p1.12.m12.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.12.m12.1b"><apply id="S3.SS0.SSS0.Px2.p1.12.m12.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.12.m12.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.12.m12.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.12.m12.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.12.m12.1.1.2">𝑆</ci><ci id="S3.SS0.SSS0.Px2.p1.12.m12.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.12.m12.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.12.m12.1c">S_{t}</annotation></semantics></math> is denoted by <math id="S3.SS0.SSS0.Px2.p1.13.m13.1" class="ltx_Math" alttext="\mathcal{A}_{S_{t}}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.13.m13.1a"><msub id="S3.SS0.SSS0.Px2.p1.13.m13.1.1" xref="S3.SS0.SSS0.Px2.p1.13.m13.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px2.p1.13.m13.1.1.2" xref="S3.SS0.SSS0.Px2.p1.13.m13.1.1.2.cmml">𝒜</mi><msub id="S3.SS0.SSS0.Px2.p1.13.m13.1.1.3" xref="S3.SS0.SSS0.Px2.p1.13.m13.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px2.p1.13.m13.1.1.3.2" xref="S3.SS0.SSS0.Px2.p1.13.m13.1.1.3.2.cmml">S</mi><mi id="S3.SS0.SSS0.Px2.p1.13.m13.1.1.3.3" xref="S3.SS0.SSS0.Px2.p1.13.m13.1.1.3.3.cmml">t</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.13.m13.1b"><apply id="S3.SS0.SSS0.Px2.p1.13.m13.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.13.m13.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.13.m13.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.13.m13.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.13.m13.1.1.2">𝒜</ci><apply id="S3.SS0.SSS0.Px2.p1.13.m13.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.13.m13.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.13.m13.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px2.p1.13.m13.1.1.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.13.m13.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px2.p1.13.m13.1.1.3.2">𝑆</ci><ci id="S3.SS0.SSS0.Px2.p1.13.m13.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px2.p1.13.m13.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.13.m13.1c">\mathcal{A}_{S_{t}}</annotation></semantics></math>.
It contains all outgoing edges from the node <math id="S3.SS0.SSS0.Px2.p1.14.m14.1" class="ltx_Math" alttext="e_{t}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.14.m14.1a"><msub id="S3.SS0.SSS0.Px2.p1.14.m14.1.1" xref="S3.SS0.SSS0.Px2.p1.14.m14.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p1.14.m14.1.1.2" xref="S3.SS0.SSS0.Px2.p1.14.m14.1.1.2.cmml">e</mi><mi id="S3.SS0.SSS0.Px2.p1.14.m14.1.1.3" xref="S3.SS0.SSS0.Px2.p1.14.m14.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.14.m14.1b"><apply id="S3.SS0.SSS0.Px2.p1.14.m14.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.14.m14.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.14.m14.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.14.m14.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.14.m14.1.1.2">𝑒</ci><ci id="S3.SS0.SSS0.Px2.p1.14.m14.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.14.m14.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.14.m14.1c">e_{t}</annotation></semantics></math> together with their corresponding object nodes.
More formally, <math id="S3.SS0.SSS0.Px2.p1.15.m15.6" class="ltx_Math" alttext="\mathcal{A}_{S_{t}}=\left\{(r,e)\in\mathcal{R}\times\mathcal{E}:S_{t}=\left(e_{t},Q\right)\land\left(e_{t},r,e\right)\in\mathcal{SG}\right\}\,." display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.15.m15.6a"><mrow id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.cmml"><mrow id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.cmml"><msub id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.4" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.4.2" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.4.2.cmml">𝒜</mi><msub id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.4.3" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.4.3.cmml"><mi id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.4.3.2" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.4.3.2.cmml">S</mi><mi id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.4.3.3" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.4.3.3.cmml">t</mi></msub></msub><mo id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.3" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.3.cmml">=</mo><mrow id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.3.cmml"><mo id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.3" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.3.1.cmml">{</mo><mrow id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.cmml"><mrow id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.2.2" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.2.1.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.2.2.1" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.2.1.cmml">(</mo><mi id="S3.SS0.SSS0.Px2.p1.15.m15.1.1" xref="S3.SS0.SSS0.Px2.p1.15.m15.1.1.cmml">r</mi><mo id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.2.2.2" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.2.1.cmml">,</mo><mi id="S3.SS0.SSS0.Px2.p1.15.m15.2.2" xref="S3.SS0.SSS0.Px2.p1.15.m15.2.2.cmml">e</mi><mo stretchy="false" id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.2.2.3" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.2.1.cmml">)</mo></mrow><mo id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.1.cmml">∈</mo><mrow id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.3.2" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.3.2.cmml">ℛ</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.3.1" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.3.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.3.3" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.3.3.cmml">ℰ</mi></mrow></mrow><mo lspace="0.278em" rspace="0.278em" id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.4" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.3.1.cmml">:</mo><mrow id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.cmml"><msub id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.4" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.4.cmml"><mi id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.4.2" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.4.2.cmml">S</mi><mi id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.4.3" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.4.3.cmml">t</mi></msub><mo id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.5" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.5.cmml">=</mo><mrow id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.cmml"><mrow id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.1.1.1" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.1.1.2.cmml"><mo id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.1.1.1.2" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.1.1.2.cmml">(</mo><msub id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.1.1.1.1" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.1.1.1.1.2.cmml">e</mi><mi id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.1.1.2.cmml">,</mo><mi id="S3.SS0.SSS0.Px2.p1.15.m15.3.3" xref="S3.SS0.SSS0.Px2.p1.15.m15.3.3.cmml">Q</mi><mo id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.1.1.1.4" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.1.1.2.cmml">)</mo></mrow><mo id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.3" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.3.cmml">∧</mo><mrow id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.2.1" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.2.2.cmml"><mo id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.2.1.2" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.2.2.cmml">(</mo><msub id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.2.1.1" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.2.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.2.1.1.2" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.2.1.1.2.cmml">e</mi><mi id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.2.1.1.3" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.2.1.1.3.cmml">t</mi></msub><mo id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.2.1.3" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.2.2.cmml">,</mo><mi id="S3.SS0.SSS0.Px2.p1.15.m15.4.4" xref="S3.SS0.SSS0.Px2.p1.15.m15.4.4.cmml">r</mi><mo id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.2.1.4" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.2.2.cmml">,</mo><mi id="S3.SS0.SSS0.Px2.p1.15.m15.5.5" xref="S3.SS0.SSS0.Px2.p1.15.m15.5.5.cmml">e</mi><mo id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.2.1.5" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.6" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.6.cmml">∈</mo><mrow id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.7" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.7.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.7.2" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.7.2.cmml">𝒮</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.7.1" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.7.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.7.3" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.7.3.cmml">𝒢</mi></mrow></mrow><mo id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.5" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.3.1.cmml">}</mo></mrow></mrow><mo lspace="0.170em" id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.2" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.15.m15.6b"><apply id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1"><eq id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.3"></eq><apply id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.4.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.4"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.4.1.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.4">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.4.2.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.4.2">𝒜</ci><apply id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.4.3.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.4.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.4.3.1.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.4.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.4.3.2.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.4.3.2">𝑆</ci><ci id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.4.3.3.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.4.3.3">𝑡</ci></apply></apply><apply id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2"><csymbol cd="latexml" id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.3.1.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.3">conditional-set</csymbol><apply id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1"><in id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.1"></in><interval closure="open" id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.2.2"><ci id="S3.SS0.SSS0.Px2.p1.15.m15.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.1.1">𝑟</ci><ci id="S3.SS0.SSS0.Px2.p1.15.m15.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.2.2">𝑒</ci></interval><apply id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.3"><times id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.3.1"></times><ci id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.3.2">ℛ</ci><ci id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.1.1.1.3.3">ℰ</ci></apply></apply><apply id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2"><and id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2a.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2"></and><apply id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2b.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2"><eq id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.5.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.5"></eq><apply id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.4.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.4"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.4.1.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.4">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.4.2.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.4.2">𝑆</ci><ci id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.4.3.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.4.3">𝑡</ci></apply><apply id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2"><and id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.3"></and><interval closure="open" id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.1.1.1"><apply id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.1.1.1.1.2">𝑒</ci><ci id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.1.1.1.1.3">𝑡</ci></apply><ci id="S3.SS0.SSS0.Px2.p1.15.m15.3.3.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.3.3">𝑄</ci></interval><vector id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.2.1"><apply id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.2.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.2.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.2.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.2.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.2.1.1.2">𝑒</ci><ci id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.2.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.2.1.1.3">𝑡</ci></apply><ci id="S3.SS0.SSS0.Px2.p1.15.m15.4.4.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.4.4">𝑟</ci><ci id="S3.SS0.SSS0.Px2.p1.15.m15.5.5.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.5.5">𝑒</ci></vector></apply></apply><apply id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2c.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2"><in id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.6.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.6"></in><share href="#S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.2.cmml" id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2d.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2"></share><apply id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.7.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.7"><times id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.7.1.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.7.1"></times><ci id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.7.2.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.7.2">𝒮</ci><ci id="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.7.3.cmml" xref="S3.SS0.SSS0.Px2.p1.15.m15.6.6.1.1.2.2.2.7.3">𝒢</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.15.m15.6c">\mathcal{A}_{S_{t}}=\left\{(r,e)\in\mathcal{R}\times\mathcal{E}:S_{t}=\left(e_{t},Q\right)\land\left(e_{t},r,e\right)\in\mathcal{SG}\right\}\,.</annotation></semantics></math> Moreover, we denote with <math id="S3.SS0.SSS0.Px2.p1.16.m16.1" class="ltx_Math" alttext="A_{t}\in\mathcal{A}_{S_{t}}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.16.m16.1a"><mrow id="S3.SS0.SSS0.Px2.p1.16.m16.1.1" xref="S3.SS0.SSS0.Px2.p1.16.m16.1.1.cmml"><msub id="S3.SS0.SSS0.Px2.p1.16.m16.1.1.2" xref="S3.SS0.SSS0.Px2.p1.16.m16.1.1.2.cmml"><mi id="S3.SS0.SSS0.Px2.p1.16.m16.1.1.2.2" xref="S3.SS0.SSS0.Px2.p1.16.m16.1.1.2.2.cmml">A</mi><mi id="S3.SS0.SSS0.Px2.p1.16.m16.1.1.2.3" xref="S3.SS0.SSS0.Px2.p1.16.m16.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS0.SSS0.Px2.p1.16.m16.1.1.1" xref="S3.SS0.SSS0.Px2.p1.16.m16.1.1.1.cmml">∈</mo><msub id="S3.SS0.SSS0.Px2.p1.16.m16.1.1.3" xref="S3.SS0.SSS0.Px2.p1.16.m16.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px2.p1.16.m16.1.1.3.2" xref="S3.SS0.SSS0.Px2.p1.16.m16.1.1.3.2.cmml">𝒜</mi><msub id="S3.SS0.SSS0.Px2.p1.16.m16.1.1.3.3" xref="S3.SS0.SSS0.Px2.p1.16.m16.1.1.3.3.cmml"><mi id="S3.SS0.SSS0.Px2.p1.16.m16.1.1.3.3.2" xref="S3.SS0.SSS0.Px2.p1.16.m16.1.1.3.3.2.cmml">S</mi><mi id="S3.SS0.SSS0.Px2.p1.16.m16.1.1.3.3.3" xref="S3.SS0.SSS0.Px2.p1.16.m16.1.1.3.3.3.cmml">t</mi></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.16.m16.1b"><apply id="S3.SS0.SSS0.Px2.p1.16.m16.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.16.m16.1.1"><in id="S3.SS0.SSS0.Px2.p1.16.m16.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.16.m16.1.1.1"></in><apply id="S3.SS0.SSS0.Px2.p1.16.m16.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.16.m16.1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.16.m16.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px2.p1.16.m16.1.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.16.m16.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.16.m16.1.1.2.2">𝐴</ci><ci id="S3.SS0.SSS0.Px2.p1.16.m16.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px2.p1.16.m16.1.1.2.3">𝑡</ci></apply><apply id="S3.SS0.SSS0.Px2.p1.16.m16.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.16.m16.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.16.m16.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px2.p1.16.m16.1.1.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.16.m16.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px2.p1.16.m16.1.1.3.2">𝒜</ci><apply id="S3.SS0.SSS0.Px2.p1.16.m16.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px2.p1.16.m16.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.16.m16.1.1.3.3.1.cmml" xref="S3.SS0.SSS0.Px2.p1.16.m16.1.1.3.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.16.m16.1.1.3.3.2.cmml" xref="S3.SS0.SSS0.Px2.p1.16.m16.1.1.3.3.2">𝑆</ci><ci id="S3.SS0.SSS0.Px2.p1.16.m16.1.1.3.3.3.cmml" xref="S3.SS0.SSS0.Px2.p1.16.m16.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.16.m16.1c">A_{t}\in\mathcal{A}_{S_{t}}</annotation></semantics></math> the action that the agent performed at time <math id="S3.SS0.SSS0.Px2.p1.17.m17.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.17.m17.1a"><mi id="S3.SS0.SSS0.Px2.p1.17.m17.1.1" xref="S3.SS0.SSS0.Px2.p1.17.m17.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.17.m17.1b"><ci id="S3.SS0.SSS0.Px2.p1.17.m17.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.17.m17.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.17.m17.1c">t</annotation></semantics></math>. We include self-loops for each node in <math id="S3.SS0.SSS0.Px2.p1.18.m18.1" class="ltx_Math" alttext="\mathcal{SG}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.18.m18.1a"><mrow id="S3.SS0.SSS0.Px2.p1.18.m18.1.1" xref="S3.SS0.SSS0.Px2.p1.18.m18.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px2.p1.18.m18.1.1.2" xref="S3.SS0.SSS0.Px2.p1.18.m18.1.1.2.cmml">𝒮</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px2.p1.18.m18.1.1.1" xref="S3.SS0.SSS0.Px2.p1.18.m18.1.1.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px2.p1.18.m18.1.1.3" xref="S3.SS0.SSS0.Px2.p1.18.m18.1.1.3.cmml">𝒢</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.18.m18.1b"><apply id="S3.SS0.SSS0.Px2.p1.18.m18.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.18.m18.1.1"><times id="S3.SS0.SSS0.Px2.p1.18.m18.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.18.m18.1.1.1"></times><ci id="S3.SS0.SSS0.Px2.p1.18.m18.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.18.m18.1.1.2">𝒮</ci><ci id="S3.SS0.SSS0.Px2.p1.18.m18.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.18.m18.1.1.3">𝒢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.18.m18.1c">\mathcal{SG}</annotation></semantics></math> that produce a <span id="S3.SS0.SSS0.Px2.p1.18.1" class="ltx_text ltx_font_italic">NO_OP</span>-label. These self-loops allow the agent to remain at the current location if it reaches the answer node. Furthermore, the introduction of inverse relations allows agent to transit freely in any direction between two nodes.</p>
</div>
<div id="S3.SS0.SSS0.Px2.p2" class="ltx_para">
<p id="S3.SS0.SSS0.Px2.p2.4" class="ltx_p">The environments evolve deterministically by updating the state according to previous action. Formally, the transition function at time <math id="S3.SS0.SSS0.Px2.p2.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS0.SSS0.Px2.p2.1.m1.1a"><mi id="S3.SS0.SSS0.Px2.p2.1.m1.1.1" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p2.1.m1.1b"><ci id="S3.SS0.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p2.1.m1.1c">t</annotation></semantics></math> is given by <math id="S3.SS0.SSS0.Px2.p2.2.m2.4" class="ltx_Math" alttext="\delta_{t}({S_{t}},A_{t}):=\left(e_{t+1},Q\right)" display="inline"><semantics id="S3.SS0.SSS0.Px2.p2.2.m2.4a"><mrow id="S3.SS0.SSS0.Px2.p2.2.m2.4.4" xref="S3.SS0.SSS0.Px2.p2.2.m2.4.4.cmml"><mrow id="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2" xref="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.cmml"><msub id="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.4" xref="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.4.cmml"><mi id="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.4.2" xref="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.4.2.cmml">δ</mi><mi id="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.4.3" xref="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.4.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.3" xref="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.3.cmml">​</mo><mrow id="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.2.2" xref="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.2.3.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.2.2.3" xref="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.2.3.cmml">(</mo><msub id="S3.SS0.SSS0.Px2.p2.2.m2.2.2.1.1.1.1" xref="S3.SS0.SSS0.Px2.p2.2.m2.2.2.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p2.2.m2.2.2.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p2.2.m2.2.2.1.1.1.1.2.cmml">S</mi><mi id="S3.SS0.SSS0.Px2.p2.2.m2.2.2.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p2.2.m2.2.2.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.2.2.4" xref="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.2.3.cmml">,</mo><msub id="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.2.2.2" xref="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.2.2.2.cmml"><mi id="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.2.2.2.2" xref="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.2.2.2.2.cmml">A</mi><mi id="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.2.2.2.3" xref="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.2.2.2.3.cmml">t</mi></msub><mo rspace="0.278em" stretchy="false" id="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.2.2.5" xref="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.2.3.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S3.SS0.SSS0.Px2.p2.2.m2.4.4.4" xref="S3.SS0.SSS0.Px2.p2.2.m2.4.4.4.cmml">:=</mo><mrow id="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1" xref="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.2.cmml"><mo id="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.2" xref="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.2.cmml">(</mo><msub id="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.1" xref="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.1.2" xref="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.1.2.cmml">e</mi><mrow id="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.1.3" xref="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.1.3.2" xref="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.1.3.2.cmml">t</mi><mo id="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.1.3.1" xref="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.1.3.1.cmml">+</mo><mn id="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.1.3.3" xref="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.3" xref="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.2.cmml">,</mo><mi id="S3.SS0.SSS0.Px2.p2.2.m2.1.1" xref="S3.SS0.SSS0.Px2.p2.2.m2.1.1.cmml">Q</mi><mo id="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.4" xref="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p2.2.m2.4b"><apply id="S3.SS0.SSS0.Px2.p2.2.m2.4.4.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.4.4"><csymbol cd="latexml" id="S3.SS0.SSS0.Px2.p2.2.m2.4.4.4.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.4.4.4">assign</csymbol><apply id="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2"><times id="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.3.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.3"></times><apply id="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.4.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.4"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.4.1.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.4">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.4.2.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.4.2">𝛿</ci><ci id="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.4.3.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.4.3">𝑡</ci></apply><interval closure="open" id="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.2.2"><apply id="S3.SS0.SSS0.Px2.p2.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p2.2.m2.2.2.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p2.2.m2.2.2.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.2.2.1.1.1.1.2">𝑆</ci><ci id="S3.SS0.SSS0.Px2.p2.2.m2.2.2.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.2.2.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.2.2.2.1.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.2.2.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.2.2.2.2">𝐴</ci><ci id="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.2.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.3.3.2.2.2.2.3">𝑡</ci></apply></interval></apply><interval closure="open" id="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.2.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1"><apply id="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.1.2">𝑒</ci><apply id="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.1.3"><plus id="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.1.3.1"></plus><ci id="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.4.4.3.1.1.3.3">1</cn></apply></apply><ci id="S3.SS0.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.1.1">𝑄</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p2.2.m2.4c">\delta_{t}({S_{t}},A_{t}):=\left(e_{t+1},Q\right)</annotation></semantics></math> with <math id="S3.SS0.SSS0.Px2.p2.3.m3.2" class="ltx_Math" alttext="S_{t}=\left(e_{t},Q\right)" display="inline"><semantics id="S3.SS0.SSS0.Px2.p2.3.m3.2a"><mrow id="S3.SS0.SSS0.Px2.p2.3.m3.2.2" xref="S3.SS0.SSS0.Px2.p2.3.m3.2.2.cmml"><msub id="S3.SS0.SSS0.Px2.p2.3.m3.2.2.3" xref="S3.SS0.SSS0.Px2.p2.3.m3.2.2.3.cmml"><mi id="S3.SS0.SSS0.Px2.p2.3.m3.2.2.3.2" xref="S3.SS0.SSS0.Px2.p2.3.m3.2.2.3.2.cmml">S</mi><mi id="S3.SS0.SSS0.Px2.p2.3.m3.2.2.3.3" xref="S3.SS0.SSS0.Px2.p2.3.m3.2.2.3.3.cmml">t</mi></msub><mo id="S3.SS0.SSS0.Px2.p2.3.m3.2.2.2" xref="S3.SS0.SSS0.Px2.p2.3.m3.2.2.2.cmml">=</mo><mrow id="S3.SS0.SSS0.Px2.p2.3.m3.2.2.1.1" xref="S3.SS0.SSS0.Px2.p2.3.m3.2.2.1.2.cmml"><mo id="S3.SS0.SSS0.Px2.p2.3.m3.2.2.1.1.2" xref="S3.SS0.SSS0.Px2.p2.3.m3.2.2.1.2.cmml">(</mo><msub id="S3.SS0.SSS0.Px2.p2.3.m3.2.2.1.1.1" xref="S3.SS0.SSS0.Px2.p2.3.m3.2.2.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p2.3.m3.2.2.1.1.1.2" xref="S3.SS0.SSS0.Px2.p2.3.m3.2.2.1.1.1.2.cmml">e</mi><mi id="S3.SS0.SSS0.Px2.p2.3.m3.2.2.1.1.1.3" xref="S3.SS0.SSS0.Px2.p2.3.m3.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS0.SSS0.Px2.p2.3.m3.2.2.1.1.3" xref="S3.SS0.SSS0.Px2.p2.3.m3.2.2.1.2.cmml">,</mo><mi id="S3.SS0.SSS0.Px2.p2.3.m3.1.1" xref="S3.SS0.SSS0.Px2.p2.3.m3.1.1.cmml">Q</mi><mo id="S3.SS0.SSS0.Px2.p2.3.m3.2.2.1.1.4" xref="S3.SS0.SSS0.Px2.p2.3.m3.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p2.3.m3.2b"><apply id="S3.SS0.SSS0.Px2.p2.3.m3.2.2.cmml" xref="S3.SS0.SSS0.Px2.p2.3.m3.2.2"><eq id="S3.SS0.SSS0.Px2.p2.3.m3.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p2.3.m3.2.2.2"></eq><apply id="S3.SS0.SSS0.Px2.p2.3.m3.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p2.3.m3.2.2.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p2.3.m3.2.2.3.1.cmml" xref="S3.SS0.SSS0.Px2.p2.3.m3.2.2.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p2.3.m3.2.2.3.2.cmml" xref="S3.SS0.SSS0.Px2.p2.3.m3.2.2.3.2">𝑆</ci><ci id="S3.SS0.SSS0.Px2.p2.3.m3.2.2.3.3.cmml" xref="S3.SS0.SSS0.Px2.p2.3.m3.2.2.3.3">𝑡</ci></apply><interval closure="open" id="S3.SS0.SSS0.Px2.p2.3.m3.2.2.1.2.cmml" xref="S3.SS0.SSS0.Px2.p2.3.m3.2.2.1.1"><apply id="S3.SS0.SSS0.Px2.p2.3.m3.2.2.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p2.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p2.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p2.3.m3.2.2.1.1.1.2">𝑒</ci><ci id="S3.SS0.SSS0.Px2.p2.3.m3.2.2.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p2.3.m3.2.2.1.1.1.3">𝑡</ci></apply><ci id="S3.SS0.SSS0.Px2.p2.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.3.m3.1.1">𝑄</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p2.3.m3.2c">S_{t}=\left(e_{t},Q\right)</annotation></semantics></math> and <math id="S3.SS0.SSS0.Px2.p2.4.m4.2" class="ltx_Math" alttext="A_{t}=\left(r,e_{t+1}\right)" display="inline"><semantics id="S3.SS0.SSS0.Px2.p2.4.m4.2a"><mrow id="S3.SS0.SSS0.Px2.p2.4.m4.2.2" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.cmml"><msub id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.3" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.3.cmml"><mi id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.3.2" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.3.2.cmml">A</mi><mi id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.3.3" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.3.3.cmml">t</mi></msub><mo id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.2" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.2.cmml">=</mo><mrow id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.2.cmml"><mo id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.2" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.2.cmml">(</mo><mi id="S3.SS0.SSS0.Px2.p2.4.m4.1.1" xref="S3.SS0.SSS0.Px2.p2.4.m4.1.1.cmml">r</mi><mo id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.3" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.2.cmml">,</mo><msub id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.1" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.1.2" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.1.2.cmml">e</mi><mrow id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.1.3" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.1.3.2" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.1.3.2.cmml">t</mi><mo id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.1.3.1" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.1.3.1.cmml">+</mo><mn id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.1.3.3" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.4" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p2.4.m4.2b"><apply id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.cmml" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2"><eq id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.2"></eq><apply id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.3.1.cmml" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.3.2.cmml" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.3.2">𝐴</ci><ci id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.3.3.cmml" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.3.3">𝑡</ci></apply><interval closure="open" id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.2.cmml" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1"><ci id="S3.SS0.SSS0.Px2.p2.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.4.m4.1.1">𝑟</ci><apply id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.1.2">𝑒</ci><apply id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.1.3"><plus id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.1.3.1"></plus><ci id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px2.p2.4.m4.2.2.1.1.1.3.3">1</cn></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p2.4.m4.2c">A_{t}=\left(r,e_{t+1}\right)</annotation></semantics></math>.</p>
</div>
<div id="S3.SS0.SSS0.Px2.p3" class="ltx_para">
<p id="S3.SS0.SSS0.Px2.p3.1" class="ltx_p"><span id="S3.SS0.SSS0.Px2.p3.1.1" class="ltx_text ltx_font_bold">Auxiliary Nodes : </span> In addition to standard entity relation nodes present in a scene graph, we introduce a few auxiliary nodes (e.g. hub node). The underlying rationale for the inclusion of auxiliary nodes is that they facilitate the walk for the agent or help to frame the QA-task as a goal-oriented walk on the scene graph. These additional nodes are included during run-time graph traversal, but they are ignored during the compile time such as when computing node embedding.
For example, we add a hub node (<span id="S3.SS0.SSS0.Px2.p3.1.2" class="ltx_text ltx_font_italic">hub</span>) to every scene graph which is connected to all other nodes. The agent then starts the scene graph traversal from a <span id="S3.SS0.SSS0.Px2.p3.1.3" class="ltx_text ltx_font_italic">hub</span> with global connectivity.
Furthermore for a binary question, we add YES and NO nodes to the scene entities that correspond to the final location of the agent. The agent can then transition to either the YES or the NO node.</p>
</div>
</section>
<section id="S3.SS0.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Question and Scene Graph Processing</h4>

<div id="S3.SS0.SSS0.Px3.p1" class="ltx_para">
<p id="S3.SS0.SSS0.Px3.p1.4" class="ltx_p">We initialize words in <math id="S3.SS0.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS0.SSS0.Px3.p1.1.m1.1a"><mi id="S3.SS0.SSS0.Px3.p1.1.m1.1.1" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p1.1.m1.1b"><ci id="S3.SS0.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p1.1.m1.1c">Q</annotation></semantics></math> with GloVe embeddings <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> with dimension <math id="S3.SS0.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="d=300" display="inline"><semantics id="S3.SS0.SSS0.Px3.p1.2.m2.1a"><mrow id="S3.SS0.SSS0.Px3.p1.2.m2.1.1" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.2" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.2.cmml">d</mi><mo id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.1" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.3" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.3.cmml">300</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p1.2.m2.1b"><apply id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1"><eq id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.1"></eq><ci id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.2">𝑑</ci><cn type="integer" id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.3">300</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p1.2.m2.1c">d=300</annotation></semantics></math>. Similarly we initialize entities and relations in <math id="S3.SS0.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{SG}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p1.3.m3.1a"><mrow id="S3.SS0.SSS0.Px3.p1.3.m3.1.1" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px3.p1.3.m3.1.1.2" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.1.2.cmml">𝒮</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px3.p1.3.m3.1.1.1" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.1.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px3.p1.3.m3.1.1.3" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.1.3.cmml">𝒢</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p1.3.m3.1b"><apply id="S3.SS0.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.1"><times id="S3.SS0.SSS0.Px3.p1.3.m3.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.1.1"></times><ci id="S3.SS0.SSS0.Px3.p1.3.m3.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.1.2">𝒮</ci><ci id="S3.SS0.SSS0.Px3.p1.3.m3.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.1.3">𝒢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p1.3.m3.1c">\mathcal{SG}</annotation></semantics></math> with the embeddings of their type labels.
In the scene graph, the node embeddings are passed through a multi-layered graph attention network (GAT) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>. Extending the idea from graph convolutional networks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> with a self-attention mechanism, GATs mimic the convolution operator on regular grids where an entity embedding is formed by aggregating node features from its neighbors. Relations and inverse relations between nodes allows context to flow in both ways through GAT. Thus, the resulting embeddings are context-aware, which makes nodes with the same type, but different graph neighborhoods, distinguishable. To produce an embedding for the question <math id="S3.SS0.SSS0.Px3.p1.4.m4.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS0.SSS0.Px3.p1.4.m4.1a"><mi id="S3.SS0.SSS0.Px3.p1.4.m4.1.1" xref="S3.SS0.SSS0.Px3.p1.4.m4.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p1.4.m4.1b"><ci id="S3.SS0.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.4.m4.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p1.4.m4.1c">Q</annotation></semantics></math>, we first apply a Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>, followed by a mean pooling operation.</p>
</div>
<div id="S3.SS0.SSS0.Px3.p2" class="ltx_para">
<p id="S3.SS0.SSS0.Px3.p2.1" class="ltx_p">Finally, since we added auxiliary <span id="S3.SS0.SSS0.Px3.p2.1.1" class="ltx_text ltx_font_italic">YES</span> and <span id="S3.SS0.SSS0.Px3.p2.1.2" class="ltx_text ltx_font_italic">NO</span> nodes to the scene graph for binary questions, we train a feedforward neural network to classify query-type (i.e., questions that query for an object in the depicted scene) and binary questions. This network consists of two fully connected layers with ReLU activation on the intermediate output. We find that it is easy to distingquish between query and binary questions (e.g., query questions usually begin with <span id="S3.SS0.SSS0.Px3.p2.1.3" class="ltx_text ltx_font_italic">What, Which, How</span>, etc., whereas binary questions usually begin with <span id="S3.SS0.SSS0.Px3.p2.1.4" class="ltx_text ltx_font_italic">Do, Is</span>, etc.). Since our classifier achieves 99.99% accuracy we will ignore the error in question classification in the following discussions.</p>
</div>
</section>
<section id="S3.SS0.SSS0.Px4" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Policy</h4>

<div id="S3.SS0.SSS0.Px4.p1" class="ltx_para">
<p id="S3.SS0.SSS0.Px4.p1.6" class="ltx_p">We denote the agent’s history until time <math id="S3.SS0.SSS0.Px4.p1.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS0.SSS0.Px4.p1.1.m1.1a"><mi id="S3.SS0.SSS0.Px4.p1.1.m1.1.1" xref="S3.SS0.SSS0.Px4.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px4.p1.1.m1.1b"><ci id="S3.SS0.SSS0.Px4.p1.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px4.p1.1.m1.1c">t</annotation></semantics></math> with the tuple <math id="S3.SS0.SSS0.Px4.p1.2.m2.2" class="ltx_Math" alttext="H_{t}=\left(H_{t-1},A_{t-1}\right)" display="inline"><semantics id="S3.SS0.SSS0.Px4.p1.2.m2.2a"><mrow id="S3.SS0.SSS0.Px4.p1.2.m2.2.2" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.cmml"><msub id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.4" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.4.cmml"><mi id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.4.2" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.4.2.cmml">H</mi><mi id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.4.3" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.4.3.cmml">t</mi></msub><mo id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.3" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.3.cmml">=</mo><mrow id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.3.cmml"><mo id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.3" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.3.cmml">(</mo><msub id="S3.SS0.SSS0.Px4.p1.2.m2.1.1.1.1.1" xref="S3.SS0.SSS0.Px4.p1.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px4.p1.2.m2.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px4.p1.2.m2.1.1.1.1.1.2.cmml">H</mi><mrow id="S3.SS0.SSS0.Px4.p1.2.m2.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px4.p1.2.m2.1.1.1.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px4.p1.2.m2.1.1.1.1.1.3.2" xref="S3.SS0.SSS0.Px4.p1.2.m2.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.SS0.SSS0.Px4.p1.2.m2.1.1.1.1.1.3.1" xref="S3.SS0.SSS0.Px4.p1.2.m2.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.SS0.SSS0.Px4.p1.2.m2.1.1.1.1.1.3.3" xref="S3.SS0.SSS0.Px4.p1.2.m2.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.4" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.3.cmml">,</mo><msub id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.2" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.2.cmml"><mi id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.2.2" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.2.2.cmml">A</mi><mrow id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.2.3" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.2.3.cmml"><mi id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.2.3.2" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.2.3.2.cmml">t</mi><mo id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.2.3.1" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.2.3.1.cmml">−</mo><mn id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.2.3.3" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.5" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px4.p1.2.m2.2b"><apply id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.cmml" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2"><eq id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.3.cmml" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.3"></eq><apply id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.4.cmml" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.4"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.4.1.cmml" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.4">subscript</csymbol><ci id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.4.2.cmml" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.4.2">𝐻</ci><ci id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.4.3.cmml" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.4.3">𝑡</ci></apply><interval closure="open" id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.3.cmml" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2"><apply id="S3.SS0.SSS0.Px4.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px4.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px4.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px4.p1.2.m2.1.1.1.1.1.2">𝐻</ci><apply id="S3.SS0.SSS0.Px4.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px4.p1.2.m2.1.1.1.1.1.3"><minus id="S3.SS0.SSS0.Px4.p1.2.m2.1.1.1.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px4.p1.2.m2.1.1.1.1.1.3.1"></minus><ci id="S3.SS0.SSS0.Px4.p1.2.m2.1.1.1.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px4.p1.2.m2.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS0.SSS0.Px4.p1.2.m2.1.1.1.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px4.p1.2.m2.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.2.2">𝐴</ci><apply id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.2.3.cmml" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.2.3"><minus id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.2.3.1.cmml" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.2.3.1"></minus><ci id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.2.3.2.cmml" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.2.3.3.cmml" xref="S3.SS0.SSS0.Px4.p1.2.m2.2.2.2.2.2.3.3">1</cn></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px4.p1.2.m2.2c">H_{t}=\left(H_{t-1},A_{t-1}\right)</annotation></semantics></math> for <math id="S3.SS0.SSS0.Px4.p1.3.m3.1" class="ltx_Math" alttext="t\geq 1" display="inline"><semantics id="S3.SS0.SSS0.Px4.p1.3.m3.1a"><mrow id="S3.SS0.SSS0.Px4.p1.3.m3.1.1" xref="S3.SS0.SSS0.Px4.p1.3.m3.1.1.cmml"><mi id="S3.SS0.SSS0.Px4.p1.3.m3.1.1.2" xref="S3.SS0.SSS0.Px4.p1.3.m3.1.1.2.cmml">t</mi><mo id="S3.SS0.SSS0.Px4.p1.3.m3.1.1.1" xref="S3.SS0.SSS0.Px4.p1.3.m3.1.1.1.cmml">≥</mo><mn id="S3.SS0.SSS0.Px4.p1.3.m3.1.1.3" xref="S3.SS0.SSS0.Px4.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px4.p1.3.m3.1b"><apply id="S3.SS0.SSS0.Px4.p1.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.3.m3.1.1"><geq id="S3.SS0.SSS0.Px4.p1.3.m3.1.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.3.m3.1.1.1"></geq><ci id="S3.SS0.SSS0.Px4.p1.3.m3.1.1.2.cmml" xref="S3.SS0.SSS0.Px4.p1.3.m3.1.1.2">𝑡</ci><cn type="integer" id="S3.SS0.SSS0.Px4.p1.3.m3.1.1.3.cmml" xref="S3.SS0.SSS0.Px4.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px4.p1.3.m3.1c">t\geq 1</annotation></semantics></math> and <math id="S3.SS0.SSS0.Px4.p1.4.m4.1" class="ltx_Math" alttext="H_{0}=hub" display="inline"><semantics id="S3.SS0.SSS0.Px4.p1.4.m4.1a"><mrow id="S3.SS0.SSS0.Px4.p1.4.m4.1.1" xref="S3.SS0.SSS0.Px4.p1.4.m4.1.1.cmml"><msub id="S3.SS0.SSS0.Px4.p1.4.m4.1.1.2" xref="S3.SS0.SSS0.Px4.p1.4.m4.1.1.2.cmml"><mi id="S3.SS0.SSS0.Px4.p1.4.m4.1.1.2.2" xref="S3.SS0.SSS0.Px4.p1.4.m4.1.1.2.2.cmml">H</mi><mn id="S3.SS0.SSS0.Px4.p1.4.m4.1.1.2.3" xref="S3.SS0.SSS0.Px4.p1.4.m4.1.1.2.3.cmml">0</mn></msub><mo id="S3.SS0.SSS0.Px4.p1.4.m4.1.1.1" xref="S3.SS0.SSS0.Px4.p1.4.m4.1.1.1.cmml">=</mo><mrow id="S3.SS0.SSS0.Px4.p1.4.m4.1.1.3" xref="S3.SS0.SSS0.Px4.p1.4.m4.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px4.p1.4.m4.1.1.3.2" xref="S3.SS0.SSS0.Px4.p1.4.m4.1.1.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px4.p1.4.m4.1.1.3.1" xref="S3.SS0.SSS0.Px4.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS0.SSS0.Px4.p1.4.m4.1.1.3.3" xref="S3.SS0.SSS0.Px4.p1.4.m4.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px4.p1.4.m4.1.1.3.1a" xref="S3.SS0.SSS0.Px4.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS0.SSS0.Px4.p1.4.m4.1.1.3.4" xref="S3.SS0.SSS0.Px4.p1.4.m4.1.1.3.4.cmml">b</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px4.p1.4.m4.1b"><apply id="S3.SS0.SSS0.Px4.p1.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.4.m4.1.1"><eq id="S3.SS0.SSS0.Px4.p1.4.m4.1.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.4.m4.1.1.1"></eq><apply id="S3.SS0.SSS0.Px4.p1.4.m4.1.1.2.cmml" xref="S3.SS0.SSS0.Px4.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px4.p1.4.m4.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px4.p1.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px4.p1.4.m4.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px4.p1.4.m4.1.1.2.2">𝐻</ci><cn type="integer" id="S3.SS0.SSS0.Px4.p1.4.m4.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px4.p1.4.m4.1.1.2.3">0</cn></apply><apply id="S3.SS0.SSS0.Px4.p1.4.m4.1.1.3.cmml" xref="S3.SS0.SSS0.Px4.p1.4.m4.1.1.3"><times id="S3.SS0.SSS0.Px4.p1.4.m4.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px4.p1.4.m4.1.1.3.1"></times><ci id="S3.SS0.SSS0.Px4.p1.4.m4.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px4.p1.4.m4.1.1.3.2">ℎ</ci><ci id="S3.SS0.SSS0.Px4.p1.4.m4.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px4.p1.4.m4.1.1.3.3">𝑢</ci><ci id="S3.SS0.SSS0.Px4.p1.4.m4.1.1.3.4.cmml" xref="S3.SS0.SSS0.Px4.p1.4.m4.1.1.3.4">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px4.p1.4.m4.1c">H_{0}=hub</annotation></semantics></math> along with <math id="S3.SS0.SSS0.Px4.p1.5.m5.1" class="ltx_Math" alttext="A_{0}=\emptyset" display="inline"><semantics id="S3.SS0.SSS0.Px4.p1.5.m5.1a"><mrow id="S3.SS0.SSS0.Px4.p1.5.m5.1.1" xref="S3.SS0.SSS0.Px4.p1.5.m5.1.1.cmml"><msub id="S3.SS0.SSS0.Px4.p1.5.m5.1.1.2" xref="S3.SS0.SSS0.Px4.p1.5.m5.1.1.2.cmml"><mi id="S3.SS0.SSS0.Px4.p1.5.m5.1.1.2.2" xref="S3.SS0.SSS0.Px4.p1.5.m5.1.1.2.2.cmml">A</mi><mn id="S3.SS0.SSS0.Px4.p1.5.m5.1.1.2.3" xref="S3.SS0.SSS0.Px4.p1.5.m5.1.1.2.3.cmml">0</mn></msub><mo id="S3.SS0.SSS0.Px4.p1.5.m5.1.1.1" xref="S3.SS0.SSS0.Px4.p1.5.m5.1.1.1.cmml">=</mo><mi mathvariant="normal" id="S3.SS0.SSS0.Px4.p1.5.m5.1.1.3" xref="S3.SS0.SSS0.Px4.p1.5.m5.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px4.p1.5.m5.1b"><apply id="S3.SS0.SSS0.Px4.p1.5.m5.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.5.m5.1.1"><eq id="S3.SS0.SSS0.Px4.p1.5.m5.1.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.5.m5.1.1.1"></eq><apply id="S3.SS0.SSS0.Px4.p1.5.m5.1.1.2.cmml" xref="S3.SS0.SSS0.Px4.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px4.p1.5.m5.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px4.p1.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px4.p1.5.m5.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px4.p1.5.m5.1.1.2.2">𝐴</ci><cn type="integer" id="S3.SS0.SSS0.Px4.p1.5.m5.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px4.p1.5.m5.1.1.2.3">0</cn></apply><emptyset id="S3.SS0.SSS0.Px4.p1.5.m5.1.1.3.cmml" xref="S3.SS0.SSS0.Px4.p1.5.m5.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px4.p1.5.m5.1c">A_{0}=\emptyset</annotation></semantics></math> for <math id="S3.SS0.SSS0.Px4.p1.6.m6.1" class="ltx_Math" alttext="t=0" display="inline"><semantics id="S3.SS0.SSS0.Px4.p1.6.m6.1a"><mrow id="S3.SS0.SSS0.Px4.p1.6.m6.1.1" xref="S3.SS0.SSS0.Px4.p1.6.m6.1.1.cmml"><mi id="S3.SS0.SSS0.Px4.p1.6.m6.1.1.2" xref="S3.SS0.SSS0.Px4.p1.6.m6.1.1.2.cmml">t</mi><mo id="S3.SS0.SSS0.Px4.p1.6.m6.1.1.1" xref="S3.SS0.SSS0.Px4.p1.6.m6.1.1.1.cmml">=</mo><mn id="S3.SS0.SSS0.Px4.p1.6.m6.1.1.3" xref="S3.SS0.SSS0.Px4.p1.6.m6.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px4.p1.6.m6.1b"><apply id="S3.SS0.SSS0.Px4.p1.6.m6.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.6.m6.1.1"><eq id="S3.SS0.SSS0.Px4.p1.6.m6.1.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.6.m6.1.1.1"></eq><ci id="S3.SS0.SSS0.Px4.p1.6.m6.1.1.2.cmml" xref="S3.SS0.SSS0.Px4.p1.6.m6.1.1.2">𝑡</ci><cn type="integer" id="S3.SS0.SSS0.Px4.p1.6.m6.1.1.3.cmml" xref="S3.SS0.SSS0.Px4.p1.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px4.p1.6.m6.1c">t=0</annotation></semantics></math>. The history is encoded via a multilayered LSTM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite></p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.1" class="ltx_Math" alttext="\mathbf{h}_{t}=\textrm{LSTM}\left(\mathbf{a}_{t-1}\right)\,," display="block"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.3.2.cmml">𝐡</mi><mi id="S3.E1.m1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><mtext id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3a.cmml">LSTM</mtext><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.cmml">𝐚</mi><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.3.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo rspace="0.170em" id="S3.E1.m1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><eq id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2"></eq><apply id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.3.2">𝐡</ci><ci id="S3.E1.m1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.3.3">𝑡</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2"></times><ci id="S3.E1.m1.1.1.1.1.1.3a.cmml" xref="S3.E1.m1.1.1.1.1.1.3"><mtext id="S3.E1.m1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3">LSTM</mtext></ci><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2">𝐚</ci><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3"><minus id="S3.E1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\mathbf{h}_{t}=\textrm{LSTM}\left(\mathbf{a}_{t-1}\right)\,,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS0.SSS0.Px4.p1.10" class="ltx_p">where <math id="S3.SS0.SSS0.Px4.p1.7.m1.2" class="ltx_Math" alttext="\mathbf{a}_{t-1}=\left[\mathbf{r}_{t-1},\mathbf{e}_{t}\right]\in\mathbb{R}^{2d}" display="inline"><semantics id="S3.SS0.SSS0.Px4.p1.7.m1.2a"><mrow id="S3.SS0.SSS0.Px4.p1.7.m1.2.2" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.cmml"><msub id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.4" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.4.cmml"><mi id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.4.2" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.4.2.cmml">𝐚</mi><mrow id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.4.3" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.4.3.cmml"><mi id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.4.3.2" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.4.3.2.cmml">t</mi><mo id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.4.3.1" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.4.3.1.cmml">−</mo><mn id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.4.3.3" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.4.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.5" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.5.cmml">=</mo><mrow id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.2.2" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.2.3.cmml"><mo id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.2.2.3" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.2.3.cmml">[</mo><msub id="S3.SS0.SSS0.Px4.p1.7.m1.1.1.1.1.1" xref="S3.SS0.SSS0.Px4.p1.7.m1.1.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px4.p1.7.m1.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px4.p1.7.m1.1.1.1.1.1.2.cmml">𝐫</mi><mrow id="S3.SS0.SSS0.Px4.p1.7.m1.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px4.p1.7.m1.1.1.1.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px4.p1.7.m1.1.1.1.1.1.3.2" xref="S3.SS0.SSS0.Px4.p1.7.m1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.SS0.SSS0.Px4.p1.7.m1.1.1.1.1.1.3.1" xref="S3.SS0.SSS0.Px4.p1.7.m1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.SS0.SSS0.Px4.p1.7.m1.1.1.1.1.1.3.3" xref="S3.SS0.SSS0.Px4.p1.7.m1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.2.2.4" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.2.3.cmml">,</mo><msub id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.2.2.2" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.2.2.2.cmml"><mi id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.2.2.2.2" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.2.2.2.2.cmml">𝐞</mi><mi id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.2.2.2.3" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.2.2.5" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.2.3.cmml">]</mo></mrow><mo id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.6" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.6.cmml">∈</mo><msup id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.7" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.7.cmml"><mi id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.7.2" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.7.2.cmml">ℝ</mi><mrow id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.7.3" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.7.3.cmml"><mn id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.7.3.2" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.7.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.7.3.1" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.7.3.1.cmml">​</mo><mi id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.7.3.3" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.7.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px4.p1.7.m1.2b"><apply id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2"><and id="S3.SS0.SSS0.Px4.p1.7.m1.2.2a.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2"></and><apply id="S3.SS0.SSS0.Px4.p1.7.m1.2.2b.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2"><eq id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.5.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.5"></eq><apply id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.4.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.4"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.4.1.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.4">subscript</csymbol><ci id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.4.2.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.4.2">𝐚</ci><apply id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.4.3.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.4.3"><minus id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.4.3.1.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.4.3.1"></minus><ci id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.4.3.2.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.4.3.2">𝑡</ci><cn type="integer" id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.4.3.3.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.4.3.3">1</cn></apply></apply><interval closure="closed" id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.2.3.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.2.2"><apply id="S3.SS0.SSS0.Px4.p1.7.m1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px4.p1.7.m1.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px4.p1.7.m1.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.1.1.1.1.1.2">𝐫</ci><apply id="S3.SS0.SSS0.Px4.p1.7.m1.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.1.1.1.1.1.3"><minus id="S3.SS0.SSS0.Px4.p1.7.m1.1.1.1.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.1.1.1.1.1.3.1"></minus><ci id="S3.SS0.SSS0.Px4.p1.7.m1.1.1.1.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS0.SSS0.Px4.p1.7.m1.1.1.1.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.2.2.2.1.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.2.2.2.2">𝐞</ci><ci id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.2.2.2.3.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.2.2.2.3">𝑡</ci></apply></interval></apply><apply id="S3.SS0.SSS0.Px4.p1.7.m1.2.2c.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2"><in id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.6.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.6"></in><share href="#S3.SS0.SSS0.Px4.p1.7.m1.2.2.2.cmml" id="S3.SS0.SSS0.Px4.p1.7.m1.2.2d.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2"></share><apply id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.7.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.7"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.7.1.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.7">superscript</csymbol><ci id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.7.2.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.7.2">ℝ</ci><apply id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.7.3.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.7.3"><times id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.7.3.1.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.7.3.1"></times><cn type="integer" id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.7.3.2.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.7.3.2">2</cn><ci id="S3.SS0.SSS0.Px4.p1.7.m1.2.2.7.3.3.cmml" xref="S3.SS0.SSS0.Px4.p1.7.m1.2.2.7.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px4.p1.7.m1.2c">\mathbf{a}_{t-1}=\left[\mathbf{r}_{t-1},\mathbf{e}_{t}\right]\in\mathbb{R}^{2d}</annotation></semantics></math> corresponds to the embedding of the previous action with <math id="S3.SS0.SSS0.Px4.p1.8.m2.1" class="ltx_Math" alttext="\mathbf{r}_{t-1}" display="inline"><semantics id="S3.SS0.SSS0.Px4.p1.8.m2.1a"><msub id="S3.SS0.SSS0.Px4.p1.8.m2.1.1" xref="S3.SS0.SSS0.Px4.p1.8.m2.1.1.cmml"><mi id="S3.SS0.SSS0.Px4.p1.8.m2.1.1.2" xref="S3.SS0.SSS0.Px4.p1.8.m2.1.1.2.cmml">𝐫</mi><mrow id="S3.SS0.SSS0.Px4.p1.8.m2.1.1.3" xref="S3.SS0.SSS0.Px4.p1.8.m2.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px4.p1.8.m2.1.1.3.2" xref="S3.SS0.SSS0.Px4.p1.8.m2.1.1.3.2.cmml">t</mi><mo id="S3.SS0.SSS0.Px4.p1.8.m2.1.1.3.1" xref="S3.SS0.SSS0.Px4.p1.8.m2.1.1.3.1.cmml">−</mo><mn id="S3.SS0.SSS0.Px4.p1.8.m2.1.1.3.3" xref="S3.SS0.SSS0.Px4.p1.8.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px4.p1.8.m2.1b"><apply id="S3.SS0.SSS0.Px4.p1.8.m2.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px4.p1.8.m2.1.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.8.m2.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px4.p1.8.m2.1.1.2.cmml" xref="S3.SS0.SSS0.Px4.p1.8.m2.1.1.2">𝐫</ci><apply id="S3.SS0.SSS0.Px4.p1.8.m2.1.1.3.cmml" xref="S3.SS0.SSS0.Px4.p1.8.m2.1.1.3"><minus id="S3.SS0.SSS0.Px4.p1.8.m2.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px4.p1.8.m2.1.1.3.1"></minus><ci id="S3.SS0.SSS0.Px4.p1.8.m2.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px4.p1.8.m2.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS0.SSS0.Px4.p1.8.m2.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px4.p1.8.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px4.p1.8.m2.1c">\mathbf{r}_{t-1}</annotation></semantics></math> and <math id="S3.SS0.SSS0.Px4.p1.9.m3.1" class="ltx_Math" alttext="\mathbf{e}_{t}" display="inline"><semantics id="S3.SS0.SSS0.Px4.p1.9.m3.1a"><msub id="S3.SS0.SSS0.Px4.p1.9.m3.1.1" xref="S3.SS0.SSS0.Px4.p1.9.m3.1.1.cmml"><mi id="S3.SS0.SSS0.Px4.p1.9.m3.1.1.2" xref="S3.SS0.SSS0.Px4.p1.9.m3.1.1.2.cmml">𝐞</mi><mi id="S3.SS0.SSS0.Px4.p1.9.m3.1.1.3" xref="S3.SS0.SSS0.Px4.p1.9.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px4.p1.9.m3.1b"><apply id="S3.SS0.SSS0.Px4.p1.9.m3.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.9.m3.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px4.p1.9.m3.1.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.9.m3.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px4.p1.9.m3.1.1.2.cmml" xref="S3.SS0.SSS0.Px4.p1.9.m3.1.1.2">𝐞</ci><ci id="S3.SS0.SSS0.Px4.p1.9.m3.1.1.3.cmml" xref="S3.SS0.SSS0.Px4.p1.9.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px4.p1.9.m3.1c">\mathbf{e}_{t}</annotation></semantics></math> denoting the embeddings of the edge and the target node into <math id="S3.SS0.SSS0.Px4.p1.10.m4.1" class="ltx_Math" alttext="\mathbb{R}^{d}" display="inline"><semantics id="S3.SS0.SSS0.Px4.p1.10.m4.1a"><msup id="S3.SS0.SSS0.Px4.p1.10.m4.1.1" xref="S3.SS0.SSS0.Px4.p1.10.m4.1.1.cmml"><mi id="S3.SS0.SSS0.Px4.p1.10.m4.1.1.2" xref="S3.SS0.SSS0.Px4.p1.10.m4.1.1.2.cmml">ℝ</mi><mi id="S3.SS0.SSS0.Px4.p1.10.m4.1.1.3" xref="S3.SS0.SSS0.Px4.p1.10.m4.1.1.3.cmml">d</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px4.p1.10.m4.1b"><apply id="S3.SS0.SSS0.Px4.p1.10.m4.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.10.m4.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px4.p1.10.m4.1.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.10.m4.1.1">superscript</csymbol><ci id="S3.SS0.SSS0.Px4.p1.10.m4.1.1.2.cmml" xref="S3.SS0.SSS0.Px4.p1.10.m4.1.1.2">ℝ</ci><ci id="S3.SS0.SSS0.Px4.p1.10.m4.1.1.3.cmml" xref="S3.SS0.SSS0.Px4.p1.10.m4.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px4.p1.10.m4.1c">\mathbb{R}^{d}</annotation></semantics></math>, respectively.
The history-dependent action distribution is given by</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.2" class="ltx_Math" alttext="\mathbf{d}_{t}=\textrm{softmax}\left(\mathbf{A}_{t}\left(\mathbf{W}_{2}\textrm{ReLU}\left(\mathbf{W}_{1}\left[\mathbf{h}_{t},\mathbf{Q}\right]\right)\right)\right)\,," display="block"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2.1" xref="S3.E2.m1.2.2.1.1.cmml"><mrow id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.1.cmml"><msub id="S3.E2.m1.2.2.1.1.3" xref="S3.E2.m1.2.2.1.1.3.cmml"><mi id="S3.E2.m1.2.2.1.1.3.2" xref="S3.E2.m1.2.2.1.1.3.2.cmml">𝐝</mi><mi id="S3.E2.m1.2.2.1.1.3.3" xref="S3.E2.m1.2.2.1.1.3.3.cmml">t</mi></msub><mo id="S3.E2.m1.2.2.1.1.2" xref="S3.E2.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.2.2.1.1.1" xref="S3.E2.m1.2.2.1.1.1.cmml"><mtext id="S3.E2.m1.2.2.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.3a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.2.2.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.2.2.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.2.cmml">𝐀</mi><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐖</mi><mn id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mtext id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.4" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.4a.cmml">ReLU</mtext><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2a" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐖</mi><mn id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">[</mo><msub id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐡</mi><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">𝐐</mi><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.4" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">]</mo></mrow></mrow><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.170em" id="S3.E2.m1.2.2.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.2.2.1.2" xref="S3.E2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.1.1.cmml" xref="S3.E2.m1.2.2.1"><eq id="S3.E2.m1.2.2.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.2"></eq><apply id="S3.E2.m1.2.2.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.3.2">𝐝</ci><ci id="S3.E2.m1.2.2.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.3.3">𝑡</ci></apply><apply id="S3.E2.m1.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1"><times id="S3.E2.m1.2.2.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.2"></times><ci id="S3.E2.m1.2.2.1.1.1.3a.cmml" xref="S3.E2.m1.2.2.1.1.1.3"><mtext id="S3.E2.m1.2.2.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.3">softmax</mtext></ci><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1"><times id="S3.E2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2"></times><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.2">𝐀</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1"><times id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2">𝐖</ci><cn type="integer" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3.3">2</cn></apply><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.4a.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.4"><mtext id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.4">ReLU</mtext></ci><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝐖</ci><cn type="integer" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply><interval closure="closed" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐡</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝐐</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">\mathbf{d}_{t}=\textrm{softmax}\left(\mathbf{A}_{t}\left(\mathbf{W}_{2}\textrm{ReLU}\left(\mathbf{W}_{1}\left[\mathbf{h}_{t},\mathbf{Q}\right]\right)\right)\right)\,,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS0.SSS0.Px4.p1.17" class="ltx_p">where the rows of <math id="S3.SS0.SSS0.Px4.p1.11.m1.1" class="ltx_Math" alttext="\mathbf{A}_{t}\in\mathbb{R}^{|\mathcal{A}_{S_{t}}|\times d}" display="inline"><semantics id="S3.SS0.SSS0.Px4.p1.11.m1.1a"><mrow id="S3.SS0.SSS0.Px4.p1.11.m1.1.2" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.2.cmml"><msub id="S3.SS0.SSS0.Px4.p1.11.m1.1.2.2" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.2.2.cmml"><mi id="S3.SS0.SSS0.Px4.p1.11.m1.1.2.2.2" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.2.2.2.cmml">𝐀</mi><mi id="S3.SS0.SSS0.Px4.p1.11.m1.1.2.2.3" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.2.2.3.cmml">t</mi></msub><mo id="S3.SS0.SSS0.Px4.p1.11.m1.1.2.1" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.2.1.cmml">∈</mo><msup id="S3.SS0.SSS0.Px4.p1.11.m1.1.2.3" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.2.3.cmml"><mi id="S3.SS0.SSS0.Px4.p1.11.m1.1.2.3.2" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.cmml"><mrow id="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.2.1.cmml">|</mo><msub id="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1.1.2.cmml">𝒜</mi><msub id="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1.1.3.2" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1.1.3.2.cmml">S</mi><mi id="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1.1.3.3" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></msub><mo rspace="0.055em" stretchy="false" id="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.2.1.cmml">|</mo></mrow><mo rspace="0.222em" id="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.2" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.2.cmml">×</mo><mi id="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.3" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px4.p1.11.m1.1b"><apply id="S3.SS0.SSS0.Px4.p1.11.m1.1.2.cmml" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.2"><in id="S3.SS0.SSS0.Px4.p1.11.m1.1.2.1.cmml" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.2.1"></in><apply id="S3.SS0.SSS0.Px4.p1.11.m1.1.2.2.cmml" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px4.p1.11.m1.1.2.2.1.cmml" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.2.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px4.p1.11.m1.1.2.2.2.cmml" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.2.2.2">𝐀</ci><ci id="S3.SS0.SSS0.Px4.p1.11.m1.1.2.2.3.cmml" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.2.2.3">𝑡</ci></apply><apply id="S3.SS0.SSS0.Px4.p1.11.m1.1.2.3.cmml" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.2.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px4.p1.11.m1.1.2.3.1.cmml" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.2.3">superscript</csymbol><ci id="S3.SS0.SSS0.Px4.p1.11.m1.1.2.3.2.cmml" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.2.3.2">ℝ</ci><apply id="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1"><times id="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.2"></times><apply id="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1"><abs id="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1.2"></abs><apply id="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1.1.2">𝒜</ci><apply id="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1.1.3.2">𝑆</ci><ci id="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><ci id="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px4.p1.11.m1.1.1.1.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px4.p1.11.m1.1c">\mathbf{A}_{t}\in\mathbb{R}^{|\mathcal{A}_{S_{t}}|\times d}</annotation></semantics></math> contain latent representations of all admissible actions. Moreover, <math id="S3.SS0.SSS0.Px4.p1.12.m2.1" class="ltx_Math" alttext="\mathbf{Q}\in\mathbb{R}^{d}" display="inline"><semantics id="S3.SS0.SSS0.Px4.p1.12.m2.1a"><mrow id="S3.SS0.SSS0.Px4.p1.12.m2.1.1" xref="S3.SS0.SSS0.Px4.p1.12.m2.1.1.cmml"><mi id="S3.SS0.SSS0.Px4.p1.12.m2.1.1.2" xref="S3.SS0.SSS0.Px4.p1.12.m2.1.1.2.cmml">𝐐</mi><mo id="S3.SS0.SSS0.Px4.p1.12.m2.1.1.1" xref="S3.SS0.SSS0.Px4.p1.12.m2.1.1.1.cmml">∈</mo><msup id="S3.SS0.SSS0.Px4.p1.12.m2.1.1.3" xref="S3.SS0.SSS0.Px4.p1.12.m2.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px4.p1.12.m2.1.1.3.2" xref="S3.SS0.SSS0.Px4.p1.12.m2.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS0.SSS0.Px4.p1.12.m2.1.1.3.3" xref="S3.SS0.SSS0.Px4.p1.12.m2.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px4.p1.12.m2.1b"><apply id="S3.SS0.SSS0.Px4.p1.12.m2.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.12.m2.1.1"><in id="S3.SS0.SSS0.Px4.p1.12.m2.1.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.12.m2.1.1.1"></in><ci id="S3.SS0.SSS0.Px4.p1.12.m2.1.1.2.cmml" xref="S3.SS0.SSS0.Px4.p1.12.m2.1.1.2">𝐐</ci><apply id="S3.SS0.SSS0.Px4.p1.12.m2.1.1.3.cmml" xref="S3.SS0.SSS0.Px4.p1.12.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px4.p1.12.m2.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px4.p1.12.m2.1.1.3">superscript</csymbol><ci id="S3.SS0.SSS0.Px4.p1.12.m2.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px4.p1.12.m2.1.1.3.2">ℝ</ci><ci id="S3.SS0.SSS0.Px4.p1.12.m2.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px4.p1.12.m2.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px4.p1.12.m2.1c">\mathbf{Q}\in\mathbb{R}^{d}</annotation></semantics></math> encodes the question <math id="S3.SS0.SSS0.Px4.p1.13.m3.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS0.SSS0.Px4.p1.13.m3.1a"><mi id="S3.SS0.SSS0.Px4.p1.13.m3.1.1" xref="S3.SS0.SSS0.Px4.p1.13.m3.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px4.p1.13.m3.1b"><ci id="S3.SS0.SSS0.Px4.p1.13.m3.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.13.m3.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px4.p1.13.m3.1c">Q</annotation></semantics></math>. The action <math id="S3.SS0.SSS0.Px4.p1.14.m4.2" class="ltx_Math" alttext="A_{t}=(r,e)\in\mathcal{A}_{S_{t}}" display="inline"><semantics id="S3.SS0.SSS0.Px4.p1.14.m4.2a"><mrow id="S3.SS0.SSS0.Px4.p1.14.m4.2.3" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.cmml"><msub id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.2" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.2.cmml"><mi id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.2.2" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.2.2.cmml">A</mi><mi id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.2.3" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.2.3.cmml">t</mi></msub><mo id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.3" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.3.cmml">=</mo><mrow id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.4.2" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.4.1.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.4.2.1" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.4.1.cmml">(</mo><mi id="S3.SS0.SSS0.Px4.p1.14.m4.1.1" xref="S3.SS0.SSS0.Px4.p1.14.m4.1.1.cmml">r</mi><mo id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.4.2.2" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.4.1.cmml">,</mo><mi id="S3.SS0.SSS0.Px4.p1.14.m4.2.2" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.2.cmml">e</mi><mo stretchy="false" id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.4.2.3" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.4.1.cmml">)</mo></mrow><mo id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.5" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.5.cmml">∈</mo><msub id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.6" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.6.2" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.6.2.cmml">𝒜</mi><msub id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.6.3" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.6.3.cmml"><mi id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.6.3.2" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.6.3.2.cmml">S</mi><mi id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.6.3.3" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.6.3.3.cmml">t</mi></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px4.p1.14.m4.2b"><apply id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.cmml" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3"><and id="S3.SS0.SSS0.Px4.p1.14.m4.2.3a.cmml" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3"></and><apply id="S3.SS0.SSS0.Px4.p1.14.m4.2.3b.cmml" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3"><eq id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.3.cmml" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.3"></eq><apply id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.2.cmml" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.2.1.cmml" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.2.2.cmml" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.2.2">𝐴</ci><ci id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.2.3.cmml" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.2.3">𝑡</ci></apply><interval closure="open" id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.4.1.cmml" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.4.2"><ci id="S3.SS0.SSS0.Px4.p1.14.m4.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.14.m4.1.1">𝑟</ci><ci id="S3.SS0.SSS0.Px4.p1.14.m4.2.2.cmml" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.2">𝑒</ci></interval></apply><apply id="S3.SS0.SSS0.Px4.p1.14.m4.2.3c.cmml" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3"><in id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.5.cmml" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.5"></in><share href="#S3.SS0.SSS0.Px4.p1.14.m4.2.3.4.cmml" id="S3.SS0.SSS0.Px4.p1.14.m4.2.3d.cmml" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3"></share><apply id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.6.cmml" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.6"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.6.1.cmml" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.6">subscript</csymbol><ci id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.6.2.cmml" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.6.2">𝒜</ci><apply id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.6.3.cmml" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.6.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.6.3.1.cmml" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.6.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.6.3.2.cmml" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.6.3.2">𝑆</ci><ci id="S3.SS0.SSS0.Px4.p1.14.m4.2.3.6.3.3.cmml" xref="S3.SS0.SSS0.Px4.p1.14.m4.2.3.6.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px4.p1.14.m4.2c">A_{t}=(r,e)\in\mathcal{A}_{S_{t}}</annotation></semantics></math> is drawn according to <math id="S3.SS0.SSS0.Px4.p1.15.m5.1" class="ltx_Math" alttext="\textrm{categorical}\left(\mathbf{d}_{t}\right)" display="inline"><semantics id="S3.SS0.SSS0.Px4.p1.15.m5.1a"><mrow id="S3.SS0.SSS0.Px4.p1.15.m5.1.1" xref="S3.SS0.SSS0.Px4.p1.15.m5.1.1.cmml"><mtext id="S3.SS0.SSS0.Px4.p1.15.m5.1.1.3" xref="S3.SS0.SSS0.Px4.p1.15.m5.1.1.3a.cmml">categorical</mtext><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px4.p1.15.m5.1.1.2" xref="S3.SS0.SSS0.Px4.p1.15.m5.1.1.2.cmml">​</mo><mrow id="S3.SS0.SSS0.Px4.p1.15.m5.1.1.1.1" xref="S3.SS0.SSS0.Px4.p1.15.m5.1.1.1.1.1.cmml"><mo id="S3.SS0.SSS0.Px4.p1.15.m5.1.1.1.1.2" xref="S3.SS0.SSS0.Px4.p1.15.m5.1.1.1.1.1.cmml">(</mo><msub id="S3.SS0.SSS0.Px4.p1.15.m5.1.1.1.1.1" xref="S3.SS0.SSS0.Px4.p1.15.m5.1.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px4.p1.15.m5.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px4.p1.15.m5.1.1.1.1.1.2.cmml">𝐝</mi><mi id="S3.SS0.SSS0.Px4.p1.15.m5.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px4.p1.15.m5.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS0.SSS0.Px4.p1.15.m5.1.1.1.1.3" xref="S3.SS0.SSS0.Px4.p1.15.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px4.p1.15.m5.1b"><apply id="S3.SS0.SSS0.Px4.p1.15.m5.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.15.m5.1.1"><times id="S3.SS0.SSS0.Px4.p1.15.m5.1.1.2.cmml" xref="S3.SS0.SSS0.Px4.p1.15.m5.1.1.2"></times><ci id="S3.SS0.SSS0.Px4.p1.15.m5.1.1.3a.cmml" xref="S3.SS0.SSS0.Px4.p1.15.m5.1.1.3"><mtext id="S3.SS0.SSS0.Px4.p1.15.m5.1.1.3.cmml" xref="S3.SS0.SSS0.Px4.p1.15.m5.1.1.3">categorical</mtext></ci><apply id="S3.SS0.SSS0.Px4.p1.15.m5.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.15.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px4.p1.15.m5.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.15.m5.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px4.p1.15.m5.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px4.p1.15.m5.1.1.1.1.1.2">𝐝</ci><ci id="S3.SS0.SSS0.Px4.p1.15.m5.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px4.p1.15.m5.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px4.p1.15.m5.1c">\textrm{categorical}\left(\mathbf{d}_{t}\right)</annotation></semantics></math>. Equations (<a href="#S3.E1" title="Equation 1 ‣ Policy ‣ 3 Method ‣ Graphhopper: Multi-Hop Scene Graph Reasoning for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) and (<a href="#S3.E2" title="Equation 2 ‣ Policy ‣ 3 Method ‣ Graphhopper: Multi-Hop Scene Graph Reasoning for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) induce a stochastic policy <math id="S3.SS0.SSS0.Px4.p1.16.m6.1" class="ltx_Math" alttext="\pi_{\theta}" display="inline"><semantics id="S3.SS0.SSS0.Px4.p1.16.m6.1a"><msub id="S3.SS0.SSS0.Px4.p1.16.m6.1.1" xref="S3.SS0.SSS0.Px4.p1.16.m6.1.1.cmml"><mi id="S3.SS0.SSS0.Px4.p1.16.m6.1.1.2" xref="S3.SS0.SSS0.Px4.p1.16.m6.1.1.2.cmml">π</mi><mi id="S3.SS0.SSS0.Px4.p1.16.m6.1.1.3" xref="S3.SS0.SSS0.Px4.p1.16.m6.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px4.p1.16.m6.1b"><apply id="S3.SS0.SSS0.Px4.p1.16.m6.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.16.m6.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px4.p1.16.m6.1.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.16.m6.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px4.p1.16.m6.1.1.2.cmml" xref="S3.SS0.SSS0.Px4.p1.16.m6.1.1.2">𝜋</ci><ci id="S3.SS0.SSS0.Px4.p1.16.m6.1.1.3.cmml" xref="S3.SS0.SSS0.Px4.p1.16.m6.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px4.p1.16.m6.1c">\pi_{\theta}</annotation></semantics></math>, where <math id="S3.SS0.SSS0.Px4.p1.17.m7.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS0.SSS0.Px4.p1.17.m7.1a"><mi id="S3.SS0.SSS0.Px4.p1.17.m7.1.1" xref="S3.SS0.SSS0.Px4.p1.17.m7.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px4.p1.17.m7.1b"><ci id="S3.SS0.SSS0.Px4.p1.17.m7.1.1.cmml" xref="S3.SS0.SSS0.Px4.p1.17.m7.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px4.p1.17.m7.1c">\theta</annotation></semantics></math> denotes the set of trainable parameters.</p>
</div>
</section>
<section id="S3.SS0.SSS0.Px5" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Rewards and Optimization</h4>

<div id="S3.SS0.SSS0.Px5.p1" class="ltx_para">
<p id="S3.SS0.SSS0.Px5.p1.1" class="ltx_p">After sampling <math id="S3.SS0.SSS0.Px5.p1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS0.SSS0.Px5.p1.1.m1.1a"><mi id="S3.SS0.SSS0.Px5.p1.1.m1.1.1" xref="S3.SS0.SSS0.Px5.p1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px5.p1.1.m1.1b"><ci id="S3.SS0.SSS0.Px5.p1.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px5.p1.1.m1.1c">T</annotation></semantics></math> transitions, a terminal reward is assigned according to</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.5" class="ltx_Math" alttext="R=\begin{cases}1&amp;\text{if $e_{T}$ is the answer to $Q$,}\\
0&amp;\text{otherwise.}\end{cases}" display="block"><semantics id="S3.E3.m1.5a"><mrow id="S3.E3.m1.5.6" xref="S3.E3.m1.5.6.cmml"><mi id="S3.E3.m1.5.6.2" xref="S3.E3.m1.5.6.2.cmml">R</mi><mo id="S3.E3.m1.5.6.1" xref="S3.E3.m1.5.6.1.cmml">=</mo><mrow id="S3.E3.m1.5.5" xref="S3.E3.m1.5.6.3.1.cmml"><mo id="S3.E3.m1.5.5.6" xref="S3.E3.m1.5.6.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S3.E3.m1.5.5.5" xref="S3.E3.m1.5.6.3.1.cmml"><mtr id="S3.E3.m1.5.5.5a" xref="S3.E3.m1.5.6.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.5.5.5b" xref="S3.E3.m1.5.6.3.1.cmml"><mn id="S3.E3.m1.3.3.3.3.3.1" xref="S3.E3.m1.3.3.3.3.3.1.cmml">1</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.5.5.5c" xref="S3.E3.m1.5.6.3.1.cmml"><mrow id="S3.E3.m1.2.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.2.2d.cmml"><mtext id="S3.E3.m1.2.2.2.2.2.2a" xref="S3.E3.m1.2.2.2.2.2.2d.cmml">if </mtext><msub id="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">e</mi><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">T</mi></msub><mtext id="S3.E3.m1.2.2.2.2.2.2b" xref="S3.E3.m1.2.2.2.2.2.2d.cmml"> is the answer to </mtext><mi id="S3.E3.m1.2.2.2.2.2.2.2.2.m2.1.1" xref="S3.E3.m1.2.2.2.2.2.2.2.2.m2.1.1.cmml">Q</mi><mtext id="S3.E3.m1.2.2.2.2.2.2c" xref="S3.E3.m1.2.2.2.2.2.2d.cmml">,</mtext></mrow></mtd></mtr><mtr id="S3.E3.m1.5.5.5d" xref="S3.E3.m1.5.6.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.5.5.5e" xref="S3.E3.m1.5.6.3.1.cmml"><mn id="S3.E3.m1.4.4.4.4.1.1" xref="S3.E3.m1.4.4.4.4.1.1.cmml">0</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.5.5.5f" xref="S3.E3.m1.5.6.3.1.cmml"><mtext id="S3.E3.m1.5.5.5.5.2.1" xref="S3.E3.m1.5.5.5.5.2.1a.cmml">otherwise.</mtext></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.5b"><apply id="S3.E3.m1.5.6.cmml" xref="S3.E3.m1.5.6"><eq id="S3.E3.m1.5.6.1.cmml" xref="S3.E3.m1.5.6.1"></eq><ci id="S3.E3.m1.5.6.2.cmml" xref="S3.E3.m1.5.6.2">𝑅</ci><apply id="S3.E3.m1.5.6.3.1.cmml" xref="S3.E3.m1.5.5"><csymbol cd="latexml" id="S3.E3.m1.5.6.3.1.1.cmml" xref="S3.E3.m1.5.5.6">cases</csymbol><cn type="integer" id="S3.E3.m1.3.3.3.3.3.1.cmml" xref="S3.E3.m1.3.3.3.3.3.1">1</cn><ci id="S3.E3.m1.2.2.2.2.2.2d.cmml" xref="S3.E3.m1.2.2.2.2.2.2"><mrow id="S3.E3.m1.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2"><mtext id="S3.E3.m1.2.2.2.2.2.2a.cmml" xref="S3.E3.m1.2.2.2.2.2.2">if </mtext><msub id="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1.2">e</mi><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1.3">T</mi></msub><mtext id="S3.E3.m1.2.2.2.2.2.2b.cmml" xref="S3.E3.m1.2.2.2.2.2.2"> is the answer to </mtext><mi id="S3.E3.m1.2.2.2.2.2.2.2.2.m2.1.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.2.2.m2.1.1">Q</mi><mtext id="S3.E3.m1.2.2.2.2.2.2c.cmml" xref="S3.E3.m1.2.2.2.2.2.2">,</mtext></mrow></ci><cn type="integer" id="S3.E3.m1.4.4.4.4.1.1.cmml" xref="S3.E3.m1.4.4.4.4.1.1">0</cn><ci id="S3.E3.m1.5.5.5.5.2.1a.cmml" xref="S3.E3.m1.5.5.5.5.2.1"><mtext id="S3.E3.m1.5.5.5.5.2.1.cmml" xref="S3.E3.m1.5.5.5.5.2.1">otherwise.</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.5c">R=\begin{cases}1&amp;\text{if $e_{T}$ is the answer to $Q$,}\\
0&amp;\text{otherwise.}\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS0.SSS0.Px5.p1.4" class="ltx_p">We employ REINFORCE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> to maximize the expected rewards. Thus, the agent’s maximization problem is given by</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.5" class="ltx_Math" alttext="\operatorname*{arg\,max}_{\theta}\mathbb{E}_{Q\sim\mathcal{T}}\mathbb{E}_{A_{1},A_{2},\dots,A_{N}\sim\pi_{\theta}}\left[R\left|\vphantom{\frac{1}{1}}\right.e_{c}\right]\,," display="block"><semantics id="S3.E4.m1.5a"><mrow id="S3.E4.m1.5.5.1" xref="S3.E4.m1.5.5.1.1.cmml"><mrow id="S3.E4.m1.5.5.1.1" xref="S3.E4.m1.5.5.1.1.cmml"><mrow id="S3.E4.m1.5.5.1.1.3" xref="S3.E4.m1.5.5.1.1.3.cmml"><munder id="S3.E4.m1.5.5.1.1.3.1" xref="S3.E4.m1.5.5.1.1.3.1.cmml"><mrow id="S3.E4.m1.5.5.1.1.3.1.2" xref="S3.E4.m1.5.5.1.1.3.1.2.cmml"><mi id="S3.E4.m1.5.5.1.1.3.1.2.2" xref="S3.E4.m1.5.5.1.1.3.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S3.E4.m1.5.5.1.1.3.1.2.1" xref="S3.E4.m1.5.5.1.1.3.1.2.1.cmml">​</mo><mi id="S3.E4.m1.5.5.1.1.3.1.2.3" xref="S3.E4.m1.5.5.1.1.3.1.2.3.cmml">max</mi></mrow><mi id="S3.E4.m1.5.5.1.1.3.1.3" xref="S3.E4.m1.5.5.1.1.3.1.3.cmml">θ</mi></munder><mo lspace="0.167em" id="S3.E4.m1.5.5.1.1.3a" xref="S3.E4.m1.5.5.1.1.3.cmml">⁡</mo><mrow id="S3.E4.m1.5.5.1.1.3.2" xref="S3.E4.m1.5.5.1.1.3.2.cmml"><msub id="S3.E4.m1.5.5.1.1.3.2.2" xref="S3.E4.m1.5.5.1.1.3.2.2.cmml"><mi id="S3.E4.m1.5.5.1.1.3.2.2.2" xref="S3.E4.m1.5.5.1.1.3.2.2.2.cmml">𝔼</mi><mrow id="S3.E4.m1.5.5.1.1.3.2.2.3" xref="S3.E4.m1.5.5.1.1.3.2.2.3.cmml"><mi id="S3.E4.m1.5.5.1.1.3.2.2.3.2" xref="S3.E4.m1.5.5.1.1.3.2.2.3.2.cmml">Q</mi><mo id="S3.E4.m1.5.5.1.1.3.2.2.3.1" xref="S3.E4.m1.5.5.1.1.3.2.2.3.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.5.5.1.1.3.2.2.3.3" xref="S3.E4.m1.5.5.1.1.3.2.2.3.3.cmml">𝒯</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.5.5.1.1.3.2.1" xref="S3.E4.m1.5.5.1.1.3.2.1.cmml">​</mo><msub id="S3.E4.m1.5.5.1.1.3.2.3" xref="S3.E4.m1.5.5.1.1.3.2.3.cmml"><mi id="S3.E4.m1.5.5.1.1.3.2.3.2" xref="S3.E4.m1.5.5.1.1.3.2.3.2.cmml">𝔼</mi><mrow id="S3.E4.m1.4.4.4" xref="S3.E4.m1.4.4.4.cmml"><mrow id="S3.E4.m1.4.4.4.4.3" xref="S3.E4.m1.4.4.4.4.4.cmml"><msub id="S3.E4.m1.2.2.2.2.1.1" xref="S3.E4.m1.2.2.2.2.1.1.cmml"><mi id="S3.E4.m1.2.2.2.2.1.1.2" xref="S3.E4.m1.2.2.2.2.1.1.2.cmml">A</mi><mn id="S3.E4.m1.2.2.2.2.1.1.3" xref="S3.E4.m1.2.2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.E4.m1.4.4.4.4.3.4" xref="S3.E4.m1.4.4.4.4.4.cmml">,</mo><msub id="S3.E4.m1.3.3.3.3.2.2" xref="S3.E4.m1.3.3.3.3.2.2.cmml"><mi id="S3.E4.m1.3.3.3.3.2.2.2" xref="S3.E4.m1.3.3.3.3.2.2.2.cmml">A</mi><mn id="S3.E4.m1.3.3.3.3.2.2.3" xref="S3.E4.m1.3.3.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.E4.m1.4.4.4.4.3.5" xref="S3.E4.m1.4.4.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">…</mi><mo id="S3.E4.m1.4.4.4.4.3.6" xref="S3.E4.m1.4.4.4.4.4.cmml">,</mo><msub id="S3.E4.m1.4.4.4.4.3.3" xref="S3.E4.m1.4.4.4.4.3.3.cmml"><mi id="S3.E4.m1.4.4.4.4.3.3.2" xref="S3.E4.m1.4.4.4.4.3.3.2.cmml">A</mi><mi id="S3.E4.m1.4.4.4.4.3.3.3" xref="S3.E4.m1.4.4.4.4.3.3.3.cmml">N</mi></msub></mrow><mo id="S3.E4.m1.4.4.4.5" xref="S3.E4.m1.4.4.4.5.cmml">∼</mo><msub id="S3.E4.m1.4.4.4.6" xref="S3.E4.m1.4.4.4.6.cmml"><mi id="S3.E4.m1.4.4.4.6.2" xref="S3.E4.m1.4.4.4.6.2.cmml">π</mi><mi id="S3.E4.m1.4.4.4.6.3" xref="S3.E4.m1.4.4.4.6.3.cmml">θ</mi></msub></mrow></msub></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m1.5.5.1.1.2" xref="S3.E4.m1.5.5.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.5.5.1.1.1.1" xref="S3.E4.m1.5.5.1.1.1.2.cmml"><mo id="S3.E4.m1.5.5.1.1.1.1.2" xref="S3.E4.m1.5.5.1.1.1.2.1.cmml">[</mo><mrow id="S3.E4.m1.5.5.1.1.1.1.1" xref="S3.E4.m1.5.5.1.1.1.1.1.cmml"><mi id="S3.E4.m1.5.5.1.1.1.1.1.2" xref="S3.E4.m1.5.5.1.1.1.1.1.2.cmml">R</mi><mo fence="false" stretchy="true" id="S3.E4.m1.5.5.1.1.1.1.1.1" xref="S3.E4.m1.5.5.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E4.m1.5.5.1.1.1.1.1.3" xref="S3.E4.m1.5.5.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.5.5.1.1.1.1.1.3.2" xref="S3.E4.m1.5.5.1.1.1.1.1.3.2.cmml">e</mi><mi id="S3.E4.m1.5.5.1.1.1.1.1.3.3" xref="S3.E4.m1.5.5.1.1.1.1.1.3.3.cmml">c</mi></msub></mrow><mo rspace="0.170em" id="S3.E4.m1.5.5.1.1.1.1.3" xref="S3.E4.m1.5.5.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E4.m1.5.5.1.2" xref="S3.E4.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.5b"><apply id="S3.E4.m1.5.5.1.1.cmml" xref="S3.E4.m1.5.5.1"><times id="S3.E4.m1.5.5.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.2"></times><apply id="S3.E4.m1.5.5.1.1.3.cmml" xref="S3.E4.m1.5.5.1.1.3"><apply id="S3.E4.m1.5.5.1.1.3.1.cmml" xref="S3.E4.m1.5.5.1.1.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.3.1.1.cmml" xref="S3.E4.m1.5.5.1.1.3.1">subscript</csymbol><apply id="S3.E4.m1.5.5.1.1.3.1.2.cmml" xref="S3.E4.m1.5.5.1.1.3.1.2"><times id="S3.E4.m1.5.5.1.1.3.1.2.1.cmml" xref="S3.E4.m1.5.5.1.1.3.1.2.1"></times><ci id="S3.E4.m1.5.5.1.1.3.1.2.2.cmml" xref="S3.E4.m1.5.5.1.1.3.1.2.2">arg</ci><ci id="S3.E4.m1.5.5.1.1.3.1.2.3.cmml" xref="S3.E4.m1.5.5.1.1.3.1.2.3">max</ci></apply><ci id="S3.E4.m1.5.5.1.1.3.1.3.cmml" xref="S3.E4.m1.5.5.1.1.3.1.3">𝜃</ci></apply><apply id="S3.E4.m1.5.5.1.1.3.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2"><times id="S3.E4.m1.5.5.1.1.3.2.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2.1"></times><apply id="S3.E4.m1.5.5.1.1.3.2.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.3.2.2.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.3.2.2.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.2">𝔼</ci><apply id="S3.E4.m1.5.5.1.1.3.2.2.3.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.3"><csymbol cd="latexml" id="S3.E4.m1.5.5.1.1.3.2.2.3.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.3.1">similar-to</csymbol><ci id="S3.E4.m1.5.5.1.1.3.2.2.3.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.3.2">𝑄</ci><ci id="S3.E4.m1.5.5.1.1.3.2.2.3.3.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.3.3">𝒯</ci></apply></apply><apply id="S3.E4.m1.5.5.1.1.3.2.3.cmml" xref="S3.E4.m1.5.5.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.3.2.3.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2.3">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.3.2.3.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2.3.2">𝔼</ci><apply id="S3.E4.m1.4.4.4.cmml" xref="S3.E4.m1.4.4.4"><csymbol cd="latexml" id="S3.E4.m1.4.4.4.5.cmml" xref="S3.E4.m1.4.4.4.5">similar-to</csymbol><list id="S3.E4.m1.4.4.4.4.4.cmml" xref="S3.E4.m1.4.4.4.4.3"><apply id="S3.E4.m1.2.2.2.2.1.1.cmml" xref="S3.E4.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.1.1.1.cmml" xref="S3.E4.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E4.m1.2.2.2.2.1.1.2.cmml" xref="S3.E4.m1.2.2.2.2.1.1.2">𝐴</ci><cn type="integer" id="S3.E4.m1.2.2.2.2.1.1.3.cmml" xref="S3.E4.m1.2.2.2.2.1.1.3">1</cn></apply><apply id="S3.E4.m1.3.3.3.3.2.2.cmml" xref="S3.E4.m1.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.3.3.2.2.1.cmml" xref="S3.E4.m1.3.3.3.3.2.2">subscript</csymbol><ci id="S3.E4.m1.3.3.3.3.2.2.2.cmml" xref="S3.E4.m1.3.3.3.3.2.2.2">𝐴</ci><cn type="integer" id="S3.E4.m1.3.3.3.3.2.2.3.cmml" xref="S3.E4.m1.3.3.3.3.2.2.3">2</cn></apply><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">…</ci><apply id="S3.E4.m1.4.4.4.4.3.3.cmml" xref="S3.E4.m1.4.4.4.4.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.4.3.3.1.cmml" xref="S3.E4.m1.4.4.4.4.3.3">subscript</csymbol><ci id="S3.E4.m1.4.4.4.4.3.3.2.cmml" xref="S3.E4.m1.4.4.4.4.3.3.2">𝐴</ci><ci id="S3.E4.m1.4.4.4.4.3.3.3.cmml" xref="S3.E4.m1.4.4.4.4.3.3.3">𝑁</ci></apply></list><apply id="S3.E4.m1.4.4.4.6.cmml" xref="S3.E4.m1.4.4.4.6"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.6.1.cmml" xref="S3.E4.m1.4.4.4.6">subscript</csymbol><ci id="S3.E4.m1.4.4.4.6.2.cmml" xref="S3.E4.m1.4.4.4.6.2">𝜋</ci><ci id="S3.E4.m1.4.4.4.6.3.cmml" xref="S3.E4.m1.4.4.4.6.3">𝜃</ci></apply></apply></apply></apply></apply><apply id="S3.E4.m1.5.5.1.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.5.5.1.1.1.2.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E4.m1.5.5.1.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E4.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.2">𝑅</ci><apply id="S3.E4.m1.5.5.1.1.1.1.1.3.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.3.2">𝑒</ci><ci id="S3.E4.m1.5.5.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.3.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.5c">\operatorname*{arg\,max}_{\theta}\mathbb{E}_{Q\sim\mathcal{T}}\mathbb{E}_{A_{1},A_{2},\dots,A_{N}\sim\pi_{\theta}}\left[R\left|\vphantom{\frac{1}{1}}\right.e_{c}\right]\,,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS0.SSS0.Px5.p1.3" class="ltx_p">where <math id="S3.SS0.SSS0.Px5.p1.2.m1.1" class="ltx_Math" alttext="\mathcal{T}" display="inline"><semantics id="S3.SS0.SSS0.Px5.p1.2.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px5.p1.2.m1.1.1" xref="S3.SS0.SSS0.Px5.p1.2.m1.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px5.p1.2.m1.1b"><ci id="S3.SS0.SSS0.Px5.p1.2.m1.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.2.m1.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px5.p1.2.m1.1c">\mathcal{T}</annotation></semantics></math> denote the set of training questions. During training the first expectation in Equation (<a href="#S3.E4" title="Equation 4 ‣ Rewards and Optimization ‣ 3 Method ‣ Graphhopper: Multi-Hop Scene Graph Reasoning for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) is substituted with the empirical average over the training set. The second expectation is approximated by the empirical average over multiple rollouts.
We also employ a moving average baseline to reduce the variance. Further, we use entropy regularization with parameter <math id="S3.SS0.SSS0.Px5.p1.3.m2.1" class="ltx_Math" alttext="\lambda\in\mathbb{R}_{\geq 0}" display="inline"><semantics id="S3.SS0.SSS0.Px5.p1.3.m2.1a"><mrow id="S3.SS0.SSS0.Px5.p1.3.m2.1.1" xref="S3.SS0.SSS0.Px5.p1.3.m2.1.1.cmml"><mi id="S3.SS0.SSS0.Px5.p1.3.m2.1.1.2" xref="S3.SS0.SSS0.Px5.p1.3.m2.1.1.2.cmml">λ</mi><mo id="S3.SS0.SSS0.Px5.p1.3.m2.1.1.1" xref="S3.SS0.SSS0.Px5.p1.3.m2.1.1.1.cmml">∈</mo><msub id="S3.SS0.SSS0.Px5.p1.3.m2.1.1.3" xref="S3.SS0.SSS0.Px5.p1.3.m2.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px5.p1.3.m2.1.1.3.2" xref="S3.SS0.SSS0.Px5.p1.3.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS0.SSS0.Px5.p1.3.m2.1.1.3.3" xref="S3.SS0.SSS0.Px5.p1.3.m2.1.1.3.3.cmml"><mi id="S3.SS0.SSS0.Px5.p1.3.m2.1.1.3.3.2" xref="S3.SS0.SSS0.Px5.p1.3.m2.1.1.3.3.2.cmml"></mi><mo id="S3.SS0.SSS0.Px5.p1.3.m2.1.1.3.3.1" xref="S3.SS0.SSS0.Px5.p1.3.m2.1.1.3.3.1.cmml">≥</mo><mn id="S3.SS0.SSS0.Px5.p1.3.m2.1.1.3.3.3" xref="S3.SS0.SSS0.Px5.p1.3.m2.1.1.3.3.3.cmml">0</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px5.p1.3.m2.1b"><apply id="S3.SS0.SSS0.Px5.p1.3.m2.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.3.m2.1.1"><in id="S3.SS0.SSS0.Px5.p1.3.m2.1.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.3.m2.1.1.1"></in><ci id="S3.SS0.SSS0.Px5.p1.3.m2.1.1.2.cmml" xref="S3.SS0.SSS0.Px5.p1.3.m2.1.1.2">𝜆</ci><apply id="S3.SS0.SSS0.Px5.p1.3.m2.1.1.3.cmml" xref="S3.SS0.SSS0.Px5.p1.3.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px5.p1.3.m2.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px5.p1.3.m2.1.1.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px5.p1.3.m2.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px5.p1.3.m2.1.1.3.2">ℝ</ci><apply id="S3.SS0.SSS0.Px5.p1.3.m2.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px5.p1.3.m2.1.1.3.3"><geq id="S3.SS0.SSS0.Px5.p1.3.m2.1.1.3.3.1.cmml" xref="S3.SS0.SSS0.Px5.p1.3.m2.1.1.3.3.1"></geq><csymbol cd="latexml" id="S3.SS0.SSS0.Px5.p1.3.m2.1.1.3.3.2.cmml" xref="S3.SS0.SSS0.Px5.p1.3.m2.1.1.3.3.2">absent</csymbol><cn type="integer" id="S3.SS0.SSS0.Px5.p1.3.m2.1.1.3.3.3.cmml" xref="S3.SS0.SSS0.Px5.p1.3.m2.1.1.3.3.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px5.p1.3.m2.1c">\lambda\in\mathbb{R}_{\geq 0}</annotation></semantics></math> to enforce exploration. During inference, we do not sample paths but perform a beam search with width 20 based on the transition probabilities given by Equation (<a href="#S3.E2" title="Equation 2 ‣ Policy ‣ 3 Method ‣ Graphhopper: Multi-Hop Scene Graph Reasoning for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>).</p>
</div>
<div id="S3.SS0.SSS0.Px5.p2" class="ltx_para">
<p id="S3.SS0.SSS0.Px5.p2.1" class="ltx_p">Additional details on the model, the training and the inference procedure along with sketches of the algorithms, and a complexity analysis can be found in the supplementary material.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Dataset and Experimental Setup</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section we introduce the dataset and detail the experimental protocol.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Dataset</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">The <span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_italic">GQA</span> dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> has been introduced with the goal of addressing key shortcomings of previous VQA datasets, such as <span id="S4.SS1.p1.1.2" class="ltx_text ltx_font_italic">CLEVR</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> or the <span id="S4.SS1.p1.1.3" class="ltx_text ltx_font_italic">VQA</span> dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. <span id="S4.SS1.p1.1.4" class="ltx_text ltx_font_italic">GQA</span> is more suitable for evaluating the reasoning and compositional abilities of a model in a realistic setting. It contains 113K images, and around 1.2M questions split into roughly <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="80\%/10\%/10\%" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mrow id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml"><mn id="S4.SS1.p1.1.m1.1.1.2.2" xref="S4.SS1.p1.1.m1.1.1.2.2.cmml">80</mn><mo id="S4.SS1.p1.1.m1.1.1.2.1" xref="S4.SS1.p1.1.m1.1.1.2.1.cmml">%</mo></mrow><mo id="S4.SS1.p1.1.m1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.cmml">/</mo><mrow id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml"><mn id="S4.SS1.p1.1.m1.1.1.3.2" xref="S4.SS1.p1.1.m1.1.1.3.2.cmml">10</mn><mo id="S4.SS1.p1.1.m1.1.1.3.1" xref="S4.SS1.p1.1.m1.1.1.3.1.cmml">%</mo></mrow><mo id="S4.SS1.p1.1.m1.1.1.1a" xref="S4.SS1.p1.1.m1.1.1.1.cmml">/</mo><mrow id="S4.SS1.p1.1.m1.1.1.4" xref="S4.SS1.p1.1.m1.1.1.4.cmml"><mn id="S4.SS1.p1.1.m1.1.1.4.2" xref="S4.SS1.p1.1.m1.1.1.4.2.cmml">10</mn><mo id="S4.SS1.p1.1.m1.1.1.4.1" xref="S4.SS1.p1.1.m1.1.1.4.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><divide id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1"></divide><apply id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2"><csymbol cd="latexml" id="S4.SS1.p1.1.m1.1.1.2.1.cmml" xref="S4.SS1.p1.1.m1.1.1.2.1">percent</csymbol><cn type="integer" id="S4.SS1.p1.1.m1.1.1.2.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2.2">80</cn></apply><apply id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3"><csymbol cd="latexml" id="S4.SS1.p1.1.m1.1.1.3.1.cmml" xref="S4.SS1.p1.1.m1.1.1.3.1">percent</csymbol><cn type="integer" id="S4.SS1.p1.1.m1.1.1.3.2.cmml" xref="S4.SS1.p1.1.m1.1.1.3.2">10</cn></apply><apply id="S4.SS1.p1.1.m1.1.1.4.cmml" xref="S4.SS1.p1.1.m1.1.1.4"><csymbol cd="latexml" id="S4.SS1.p1.1.m1.1.1.4.1.cmml" xref="S4.SS1.p1.1.m1.1.1.4.1">percent</csymbol><cn type="integer" id="S4.SS1.p1.1.m1.1.1.4.2.cmml" xref="S4.SS1.p1.1.m1.1.1.4.2">10</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">80\%/10\%/10\%</annotation></semantics></math> for the training, validation, and testing. The overall vocabulary size consists of 3097 words, including 1702 object classes, 310 relationships, and 610 object attributes. 
<br class="ltx_break">Due to the large number of objects and relationships present in GQA, we used a pruned version of the dataset (see Section <a href="#S5" title="5 Results and Discussion ‣ Graphhopper: Multi-Hop Scene Graph Reasoning for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>) for our generated scene graph. In this work, we have conducted two primary experiments. First, we report the results on manually curated scene graphs provided in the <span id="S4.SS1.p1.1.5" class="ltx_text ltx_font_italic">GQA</span> dataset. In this setting, the true reasoning and language understanding capabilities of our model can be analyzed. Afterward, we evaluate the performance of our model with the generated scene graphs on pruned GQA dataset. It shows the performance of our model on noisy generated data. We have used state of the art Relation Transformer Network (RTN) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> for the scene graph generation and DetectoRS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> for object detection.
We have conducted all the experiments on “test-dev” split of the GQA.</p>
</div>
<section id="S4.SS1.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Question Types: </h4>

<div id="S4.SS1.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px1.p1.1" class="ltx_p">The questions are designed to evaluate the reasoning abilities such as visual verification, relational reasoning, spatial reasoning, comparison, and logical reasoning. These questions can be categorized either according to structural or semantic criteria. An overview of the different question types is given in supplementary (see Table <a href="#Pt0.A2.T4" title="Table 4 ‣ Appendix 0.B Additional Details on the Dataset GQA ‣ Graphhopper: Multi-Hop Scene Graph Reasoning for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>).</p>
</div>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Experimental Setup</h3>

<section id="S4.SS2.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Scene Graph Reasoning: </h4>

<div id="S4.SS2.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS2.SSS0.Px1.p1.2" class="ltx_p">Regarding the model parameters, we apply 300 dimensional GloVe embeddings to both the questions and the graphs (i.e., edges and nodes). Moreover, we employ a two-layer GAT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> model. The dropout <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> probability of each layer is set to 0.1. The first layer has eight attention heads. Each head has eight latent features which are concatenated to form the output features of that layer. The output layer has eight attention heads with mean aggregation, so that the output also has 300-dimensional features. We apply dropout with <math id="S4.SS2.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="p=0.1" display="inline"><semantics id="S4.SS2.SSS0.Px1.p1.1.m1.1a"><mrow id="S4.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml">p</mi><mo id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.1.m1.1b"><apply id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1"><eq id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.1"></eq><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.2">𝑝</ci><cn type="float" id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.1.m1.1c">p=0.1</annotation></semantics></math> to the attention coefficients at each layer. This essentially means that each node is exposed to a stochastically sampled neighborhood during training.
Moreover, we employ a two-layer Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> decoder model. The model dimension is set to 300, and the key and query dimensions are both set to 64 with dropout <math id="S4.SS2.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="p=0.1" display="inline"><semantics id="S4.SS2.SSS0.Px1.p1.2.m2.1a"><mrow id="S4.SS2.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml">p</mi><mo id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.2.m2.1b"><apply id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1"><eq id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1"></eq><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.2">𝑝</ci><cn type="float" id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.2.m2.1c">p=0.1</annotation></semantics></math> . The LSTM of the policy networks consists of a uni-directional layer with hidden size 300. Finally, the agent performs a fixed number of transitions. In question answering, most questions concern one subject to be explored within one reasoning path originated from the start node. Hence, we set the maximum number of steps to 4, without resetting. By contrast, the binary questions have 8 steps and a reset frequency of 4. In other words, the agent is prompted to the hub node after the fourth step.</p>
</div>
</section>
<section id="S4.SS2.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Training the Graphhopper: </h4>

<div id="S4.SS2.SSS0.Px2.p1" class="ltx_para">
<p id="S4.SS2.SSS0.Px2.p1.1" class="ltx_p">In terms of the training procedure, the GAT, the Transformer, and the policy networks are initialized with Glorot <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> initialization. We train our model with data from the <span id="S4.SS2.SSS0.Px2.p1.1.1" class="ltx_text ltx_font_italic">val_balanced_questions</span> tier. We use a batch size of 64 and sample a batch of questions along with their associated graphs. We collect 20 stochastic rollouts for each question performed in a vectorized form to
utilize parallel computation. For each batch, we collect the rewards when a
complete forward pass is done. Then the gradients are approximated from the
rewards and applied to update the weights. We employ the Adam optimizer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> with a
learning rate of <math id="S4.SS2.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="10^{-4}" display="inline"><semantics id="S4.SS2.SSS0.Px2.p1.1.m1.1a"><msup id="S4.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.cmml"><mn id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.2" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml">10</mn><mrow id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml"><mo id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3a" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml">−</mo><mn id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.2" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.2.cmml">4</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.1.m1.1b"><apply id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1">superscript</csymbol><cn type="integer" id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.2">10</cn><apply id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3"><minus id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3"></minus><cn type="integer" id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.2">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.1.m1.1c">10^{-4}</annotation></semantics></math> for all trainable weights. The coefficient for the action entropy, which balances exploration and exploitation, starts from
0.2 and decreases exponentially at each step with a factor 0.99.</p>
</div>
<div id="S4.SS2.SSS0.Px2.p2" class="ltx_para">
<p id="S4.SS2.SSS0.Px2.p2.1" class="ltx_p">Next to other standard Python libraries, we mainly employed PyTorch <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>. All experiments were conducted on a machine with one NVIDIA RTX 2080 Ti GPU and 64 GB RAM. Training the scene graph reasoner of Graphhopper for 40 epochs on <span id="S4.SS2.SSS0.Px2.p2.1.1" class="ltx_text ltx_font_italic">GQA</span> takes around 10 hours, testing about 1 hour.</p>
</div>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Performance Metrics</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">Along with the accuracy (i.e., Hits@1) on open questions (“Open”), binary questions (yes/no) (“Binary”), and the overall accuracy (“Accuracy”), we also report the additional metric “Consistency” (answers should not contradict themselves), “Validity” (answers are in the range of a question; e.g., <span id="S4.SS3.p1.1.1" class="ltx_text ltx_font_italic">red</span> is a valid answer when asked for the color of an object), “Plausibility” (answers should be reasonable; e.g., red is a reasonable color of an apple reasonable, blue is not), as proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Results and Discussion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">As outlined before, VQA is a challenging task, and there is still a significant performance gap between state-of-the-art VQA methods and human performance on challenging, real-world datasets such as GQA (see <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>). Similar to other existing methods, our architecture involves multiple components, and it important to be able to analyse the performance of the different modules and processing steps in isolation. Therefore we first present the results of our experiments on manually curated, ground-truth scene graphs provided in the GQA dataset and compare the performance of Graphhopper against NSM and humans. This setting allows us to isolate the noise from the visual perception component and quantify our methods’ reasoning capabilities. Subsequently, we present the results with our own generated scene graphs.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">In addition, we also observed that the inclusion of auxiliary nodes helps the agent to achieve efficient performance. <span id="S5.p2.1.1" class="ltx_text ltx_font_italic">Hub</span> node performs better compare to starting from any random nodes, as its facilitate easier forward and backtracking from a node. For binary question instead of YES or NO node, we experimented where the path of the agent was processed by another classifier (e.g., a logistic regression) and the classification logits were assigned as rewards. However, this led to inferior results; most likely due to the absence of a weight-sharing mechanism and due to the noisy reward signal produced by the classifier. These observations supports our assumption on the role of auxiliary nodes we have used in scene graph.</p>
</div>
<section id="S5.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Reproducing NSM:</h4>

<div id="S5.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px1.p1.1" class="ltx_p"><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> proposed the state of the art method named NSM for VQA. NSM is the conceptually most similar method, as it also exploits the scene graph reasoning for VQA. We consider NSM to be our baseline method for comparison. However, their approach to reasoning is different from ours. To compare the reasoning ability of our method with the same generated scene graph, we tried to reproduce NSM, as the code for NSM is not open-sourced. We have used the the available parameters from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> and the implementation from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>.
<br class="ltx_break"></p>
</div>
<figure id="S5.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S5.T1.2.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S5.T1.3.2" class="ltx_text" style="font-size:90%;">A comparison of Graphhopper with human performance and NSM based on manually curated scene graphs.
</span></figcaption>
<table id="S5.T1.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T1.4.1.1" class="ltx_tr">
<th id="S5.T1.4.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Method</th>
<th id="S5.T1.4.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Binary</th>
<th id="S5.T1.4.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Open</th>
<th id="S5.T1.4.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Consistency</th>
<th id="S5.T1.4.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Validity</th>
<th id="S5.T1.4.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Plausibility</th>
<th id="S5.T1.4.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Accuracy</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T1.4.2.1" class="ltx_tr">
<td id="S5.T1.4.2.1.1" class="ltx_td ltx_align_center ltx_border_t">Human <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>
</td>
<td id="S5.T1.4.2.1.2" class="ltx_td ltx_align_center ltx_border_t">91.2</td>
<td id="S5.T1.4.2.1.3" class="ltx_td ltx_align_center ltx_border_t">87.4</td>
<td id="S5.T1.4.2.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.4.2.1.4.1" class="ltx_text ltx_font_bold">98.4</span></td>
<td id="S5.T1.4.2.1.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.4.2.1.5.1" class="ltx_text ltx_font_bold">98.9</span></td>
<td id="S5.T1.4.2.1.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.4.2.1.6.1" class="ltx_text ltx_font_bold">97.2</span></td>
<td id="S5.T1.4.2.1.7" class="ltx_td ltx_align_center ltx_border_t">89.3</td>
</tr>
<tr id="S5.T1.4.3.2" class="ltx_tr">
<td id="S5.T1.4.3.2.1" class="ltx_td ltx_align_center">NSM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>
</td>
<td id="S5.T1.4.3.2.2" class="ltx_td ltx_align_center">51.03</td>
<td id="S5.T1.4.3.2.3" class="ltx_td ltx_align_center">18.79</td>
<td id="S5.T1.4.3.2.4" class="ltx_td ltx_align_center">81.36</td>
<td id="S5.T1.4.3.2.5" class="ltx_td ltx_align_center">83.69</td>
<td id="S5.T1.4.3.2.6" class="ltx_td ltx_align_center">79.12</td>
<td id="S5.T1.4.3.2.7" class="ltx_td ltx_align_center">34.5</td>
</tr>
<tr id="S5.T1.4.4.3" class="ltx_tr">
<td id="S5.T1.4.4.3.1" class="ltx_td ltx_align_center ltx_border_b">Graphhopper</td>
<td id="S5.T1.4.4.3.2" class="ltx_td ltx_align_center ltx_border_b"><span id="S5.T1.4.4.3.2.1" class="ltx_text ltx_font_bold">92.18</span></td>
<td id="S5.T1.4.4.3.3" class="ltx_td ltx_align_center ltx_border_b"><span id="S5.T1.4.4.3.3.1" class="ltx_text ltx_font_bold">92.40</span></td>
<td id="S5.T1.4.4.3.4" class="ltx_td ltx_align_center ltx_border_b">91.92</td>
<td id="S5.T1.4.4.3.5" class="ltx_td ltx_align_center ltx_border_b">93.68</td>
<td id="S5.T1.4.4.3.6" class="ltx_td ltx_align_center ltx_border_b">93.13</td>
<td id="S5.T1.4.4.3.7" class="ltx_td ltx_align_center ltx_border_b"><span id="S5.T1.4.4.3.7.1" class="ltx_text ltx_font_bold">92.30</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Results on Manually Curated Scene Graphs</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">In this section, we report on an experimental study with Graphhopper on the manually curated scene graphs provided along with the <span id="S5.SS1.p1.1.1" class="ltx_text ltx_font_italic">GQA</span> dataset. Table <a href="#S5.T1" title="Table 1 ‣ Reproducing NSM: ‣ 5 Results and Discussion ‣ Graphhopper: Multi-Hop Scene Graph Reasoning for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the performance of Graphhopper and compares it with the human performance reported in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> and with the performance of NSM on the same underlying manually curated scene graphs. We find that Graphhopper strictly outperforms NSM with respect to all performance measures. In particular, on the open questions, the performance gap is significant. Moreover, Graphhopper also slightly outperforms humans with respect to the accuracy on both types of questions.
On the other hand, concerning the supplementary performance measures consistency, validity, and plausibility, Graphhopper is outperformed by humans but nevertheless consistently reaches high values. Overall, these results can be seen as a testament of the reasoning capabilities and establish an upper bound to the performance of Graphhopper.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Results on automatically generated graph</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">The process of generating a graph representation for visual data is a costly and complex procedure.
Although the scene graph generation is not the main focus of this work, it constituted one of the major challenges to create good scene graph for GQA due to the following facts:
</p>
<ul id="S5.I1" class="ltx_itemize">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i1.p1" class="ltx_para">
<p id="S5.I1.i1.p1.1" class="ltx_p">There is no open source code for GQA scene graph generation or object detection.</p>
</div>
</li>
<li id="S5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i2.p1" class="ltx_para">
<p id="S5.I1.i2.p1.1" class="ltx_p">A large number of instances and an uneven class distribution in GQA leads to a significant drop in the accuracy compared to existing scene graph datasets (see <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>).</p>
</div>
</li>
<li id="S5.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i3.p1" class="ltx_para">
<p id="S5.I1.i3.p1.1" class="ltx_p">There is a lack of attribute prediction models in modern object detection frameworks.</p>
</div>
</li>
</ul>
<p id="S5.SS2.p1.2" class="ltx_p">In this work, we adress all of these challenges as our model’s performance is directly dependent on the quality of the scene graph. We will also open-source our code base for transparency and accelerate the development scene graph-based reasoning for VQA.</p>
</div>
<section id="S5.SS2.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Generation of Scene Graph: </h4>

<div id="S5.SS2.SSS0.Px1.p1" class="ltx_para">
<p id="S5.SS2.SSS0.Px1.p1.1" class="ltx_p">To address these problems, first, we choose two state-of-the-art network, RTN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> for scene graph generation, and DetectoRS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> for object detection. The transformer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> based architecture of RTN and its contextual scene graph embedding is most closely related to our architecture and for our future expansion. To make Graphhopper generic to any scene graph generator, we haven’t use contextualized embedding from RTN, instead we rely on GAT for contextualization.</p>
</div>
</section>
<section id="S5.SS2.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Pruning of GQA: </h4>

<div id="S5.SS2.SSS0.Px2.p1" class="ltx_para">
<p id="S5.SS2.SSS0.Px2.p1.2" class="ltx_p">GQA has more than 6 times the number of relationships compared to Visual Genome <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, which is the most used scene graph generation dataset, and contains
more than 18 times the number of objects compared to the most common object detection dataset COCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>. Also, the class distribution is highly skewed which causes a significant drop in the accuracy for both the object detection and the scene graph generation task. To efficiently prune the number of instances, we take the first 800 classes, 170 relationships, and 200 attributes based on their frequency of occurrence in the training questions and answers. This pruning allows us to reduce more than <math id="S5.SS2.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="60\%" display="inline"><semantics id="S5.SS2.SSS0.Px2.p1.1.m1.1a"><mrow id="S5.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.cmml"><mn id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.2" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml">60</mn><mo id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.1" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p1.1.m1.1b"><apply id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="latexml" id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.2">60</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p1.1.m1.1c">60\%</annotation></semantics></math> of the words while covering more than <math id="S5.SS2.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="96\%" display="inline"><semantics id="S5.SS2.SSS0.Px2.p1.2.m2.1a"><mrow id="S5.SS2.SSS0.Px2.p1.2.m2.1.1" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1.cmml"><mn id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.2" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1.2.cmml">96</mn><mo id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.1" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p1.2.m2.1b"><apply id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="latexml" id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1.2">96</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p1.2.m2.1c">96\%</annotation></semantics></math> of the combined answers in the training set.</p>
</div>
</section>
<section id="S5.SS2.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Attribute prediction: </h4>

<div id="S5.SS2.SSS0.Px3.p1" class="ltx_para">
<p id="S5.SS2.SSS0.Px3.p1.9" class="ltx_p">One of the shortcomings of existing scene graph generation and object detection networks is that they do not predict the attributes (e.g., the color or size of an object) of a detected object. Therefore, we have incorporated the attribute prediction for answering the question on GQA. Contextualized object embedding from RTN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> is used for attribute prediction as</p>
<table id="S5.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S5.E5.m1.1" class="ltx_Math" alttext="P_{attribute}=\sigma(W(Obj_{context},P_{obj}))\,," display="block"><semantics id="S5.E5.m1.1a"><mrow id="S5.E5.m1.1.1.1" xref="S5.E5.m1.1.1.1.1.cmml"><mrow id="S5.E5.m1.1.1.1.1" xref="S5.E5.m1.1.1.1.1.cmml"><msub id="S5.E5.m1.1.1.1.1.3" xref="S5.E5.m1.1.1.1.1.3.cmml"><mi id="S5.E5.m1.1.1.1.1.3.2" xref="S5.E5.m1.1.1.1.1.3.2.cmml">P</mi><mrow id="S5.E5.m1.1.1.1.1.3.3" xref="S5.E5.m1.1.1.1.1.3.3.cmml"><mi id="S5.E5.m1.1.1.1.1.3.3.2" xref="S5.E5.m1.1.1.1.1.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.E5.m1.1.1.1.1.3.3.1" xref="S5.E5.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S5.E5.m1.1.1.1.1.3.3.3" xref="S5.E5.m1.1.1.1.1.3.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S5.E5.m1.1.1.1.1.3.3.1a" xref="S5.E5.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S5.E5.m1.1.1.1.1.3.3.4" xref="S5.E5.m1.1.1.1.1.3.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S5.E5.m1.1.1.1.1.3.3.1b" xref="S5.E5.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S5.E5.m1.1.1.1.1.3.3.5" xref="S5.E5.m1.1.1.1.1.3.3.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S5.E5.m1.1.1.1.1.3.3.1c" xref="S5.E5.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S5.E5.m1.1.1.1.1.3.3.6" xref="S5.E5.m1.1.1.1.1.3.3.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="S5.E5.m1.1.1.1.1.3.3.1d" xref="S5.E5.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S5.E5.m1.1.1.1.1.3.3.7" xref="S5.E5.m1.1.1.1.1.3.3.7.cmml">b</mi><mo lspace="0em" rspace="0em" id="S5.E5.m1.1.1.1.1.3.3.1e" xref="S5.E5.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S5.E5.m1.1.1.1.1.3.3.8" xref="S5.E5.m1.1.1.1.1.3.3.8.cmml">u</mi><mo lspace="0em" rspace="0em" id="S5.E5.m1.1.1.1.1.3.3.1f" xref="S5.E5.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S5.E5.m1.1.1.1.1.3.3.9" xref="S5.E5.m1.1.1.1.1.3.3.9.cmml">t</mi><mo lspace="0em" rspace="0em" id="S5.E5.m1.1.1.1.1.3.3.1g" xref="S5.E5.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S5.E5.m1.1.1.1.1.3.3.10" xref="S5.E5.m1.1.1.1.1.3.3.10.cmml">e</mi></mrow></msub><mo id="S5.E5.m1.1.1.1.1.2" xref="S5.E5.m1.1.1.1.1.2.cmml">=</mo><mrow id="S5.E5.m1.1.1.1.1.1" xref="S5.E5.m1.1.1.1.1.1.cmml"><mi id="S5.E5.m1.1.1.1.1.1.3" xref="S5.E5.m1.1.1.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S5.E5.m1.1.1.1.1.1.2" xref="S5.E5.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S5.E5.m1.1.1.1.1.1.1.1" xref="S5.E5.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.E5.m1.1.1.1.1.1.1.1.2" xref="S5.E5.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.E5.m1.1.1.1.1.1.1.1.1" xref="S5.E5.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S5.E5.m1.1.1.1.1.1.1.1.1.4" xref="S5.E5.m1.1.1.1.1.1.1.1.1.4.cmml">W</mi><mo lspace="0em" rspace="0em" id="S5.E5.m1.1.1.1.1.1.1.1.1.3" xref="S5.E5.m1.1.1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S5.E5.m1.1.1.1.1.1.1.1.1.2.2" xref="S5.E5.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S5.E5.m1.1.1.1.1.1.1.1.1.2.3.cmml">(</mo><mrow id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">O</mi><mo lspace="0em" rspace="0em" id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">b</mi><mo lspace="0em" rspace="0em" id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1a" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><msub id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.2" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.cmml">j</mi><mrow id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.cmml"><mi id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.2" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.1" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.3" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.1a" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.4" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.1b" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.5" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.1c" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.6" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.1d" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.7" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.7.cmml">x</mi><mo lspace="0em" rspace="0em" id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.1e" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.8" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.8.cmml">t</mi></mrow></msub></mrow><mo id="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.4" xref="S5.E5.m1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">P</mi><mrow id="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.2" xref="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.1" xref="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml">​</mo><mi id="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.3" xref="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml">b</mi><mo lspace="0em" rspace="0em" id="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.1a" xref="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml">​</mo><mi id="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.4" xref="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.4.cmml">j</mi></mrow></msub><mo stretchy="false" id="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.5" xref="S5.E5.m1.1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo rspace="0.170em" stretchy="false" id="S5.E5.m1.1.1.1.1.1.1.1.3" xref="S5.E5.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S5.E5.m1.1.1.1.2" xref="S5.E5.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E5.m1.1b"><apply id="S5.E5.m1.1.1.1.1.cmml" xref="S5.E5.m1.1.1.1"><eq id="S5.E5.m1.1.1.1.1.2.cmml" xref="S5.E5.m1.1.1.1.1.2"></eq><apply id="S5.E5.m1.1.1.1.1.3.cmml" xref="S5.E5.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E5.m1.1.1.1.1.3.1.cmml" xref="S5.E5.m1.1.1.1.1.3">subscript</csymbol><ci id="S5.E5.m1.1.1.1.1.3.2.cmml" xref="S5.E5.m1.1.1.1.1.3.2">𝑃</ci><apply id="S5.E5.m1.1.1.1.1.3.3.cmml" xref="S5.E5.m1.1.1.1.1.3.3"><times id="S5.E5.m1.1.1.1.1.3.3.1.cmml" xref="S5.E5.m1.1.1.1.1.3.3.1"></times><ci id="S5.E5.m1.1.1.1.1.3.3.2.cmml" xref="S5.E5.m1.1.1.1.1.3.3.2">𝑎</ci><ci id="S5.E5.m1.1.1.1.1.3.3.3.cmml" xref="S5.E5.m1.1.1.1.1.3.3.3">𝑡</ci><ci id="S5.E5.m1.1.1.1.1.3.3.4.cmml" xref="S5.E5.m1.1.1.1.1.3.3.4">𝑡</ci><ci id="S5.E5.m1.1.1.1.1.3.3.5.cmml" xref="S5.E5.m1.1.1.1.1.3.3.5">𝑟</ci><ci id="S5.E5.m1.1.1.1.1.3.3.6.cmml" xref="S5.E5.m1.1.1.1.1.3.3.6">𝑖</ci><ci id="S5.E5.m1.1.1.1.1.3.3.7.cmml" xref="S5.E5.m1.1.1.1.1.3.3.7">𝑏</ci><ci id="S5.E5.m1.1.1.1.1.3.3.8.cmml" xref="S5.E5.m1.1.1.1.1.3.3.8">𝑢</ci><ci id="S5.E5.m1.1.1.1.1.3.3.9.cmml" xref="S5.E5.m1.1.1.1.1.3.3.9">𝑡</ci><ci id="S5.E5.m1.1.1.1.1.3.3.10.cmml" xref="S5.E5.m1.1.1.1.1.3.3.10">𝑒</ci></apply></apply><apply id="S5.E5.m1.1.1.1.1.1.cmml" xref="S5.E5.m1.1.1.1.1.1"><times id="S5.E5.m1.1.1.1.1.1.2.cmml" xref="S5.E5.m1.1.1.1.1.1.2"></times><ci id="S5.E5.m1.1.1.1.1.1.3.cmml" xref="S5.E5.m1.1.1.1.1.1.3">𝜎</ci><apply id="S5.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1"><times id="S5.E5.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1.1.3"></times><ci id="S5.E5.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1.1.4">𝑊</ci><interval closure="open" id="S5.E5.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1.1.2.2"><apply id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1"><times id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.2">𝑂</ci><ci id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝑏</ci><apply id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.2">𝑗</ci><apply id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3"><times id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.1.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.1"></times><ci id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.2.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.2">𝑐</ci><ci id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.3.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.3">𝑜</ci><ci id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.4.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.4">𝑛</ci><ci id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.5.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.5">𝑡</ci><ci id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.6.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.6">𝑒</ci><ci id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.7.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.7">𝑥</ci><ci id="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.8.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.8">𝑡</ci></apply></apply></apply><apply id="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.2">𝑃</ci><apply id="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3"><times id="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.1"></times><ci id="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.2">𝑜</ci><ci id="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.3">𝑏</ci><ci id="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.4.cmml" xref="S5.E5.m1.1.1.1.1.1.1.1.1.2.2.2.3.4">𝑗</ci></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E5.m1.1c">P_{attribute}=\sigma(W(Obj_{context},P_{obj}))\,,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S5.SS2.SSS0.Px3.p1.8" class="ltx_p">where <math id="S5.SS2.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S5.SS2.SSS0.Px3.p1.1.m1.1a"><mi id="S5.SS2.SSS0.Px3.p1.1.m1.1.1" xref="S5.SS2.SSS0.Px3.p1.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p1.1.m1.1b"><ci id="S5.SS2.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p1.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p1.1.m1.1c">W</annotation></semantics></math> ,<math id="S5.SS2.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="Obj_{context}" display="inline"><semantics id="S5.SS2.SSS0.Px3.p1.2.m2.1a"><mrow id="S5.SS2.SSS0.Px3.p1.2.m2.1.1" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.cmml"><mi id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.2" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.2.cmml">O</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.1" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.3" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.3.cmml">b</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.1a" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.1.cmml">​</mo><msub id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.cmml"><mi id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.2" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.2.cmml">j</mi><mrow id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.cmml"><mi id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.2" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.1" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.3" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.1a" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.4" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.1b" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.5" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.1c" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.6" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.1d" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.7" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.7.cmml">x</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.1e" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.8" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.8.cmml">t</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p1.2.m2.1b"><apply id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1"><times id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.1"></times><ci id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.2.cmml" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.2">𝑂</ci><ci id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.3.cmml" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.3">𝑏</ci><apply id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.cmml" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.1.cmml" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4">subscript</csymbol><ci id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.2.cmml" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.2">𝑗</ci><apply id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.cmml" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3"><times id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.1.cmml" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.1"></times><ci id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.2.cmml" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.2">𝑐</ci><ci id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.3.cmml" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.3">𝑜</ci><ci id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.4.cmml" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.4">𝑛</ci><ci id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.5.cmml" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.5">𝑡</ci><ci id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.6.cmml" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.6">𝑒</ci><ci id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.7.cmml" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.7">𝑥</ci><ci id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.8.cmml" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.4.3.8">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p1.2.m2.1c">Obj_{context}</annotation></semantics></math>, <math id="S5.SS2.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="P_{obj}" display="inline"><semantics id="S5.SS2.SSS0.Px3.p1.3.m3.1a"><msub id="S5.SS2.SSS0.Px3.p1.3.m3.1.1" xref="S5.SS2.SSS0.Px3.p1.3.m3.1.1.cmml"><mi id="S5.SS2.SSS0.Px3.p1.3.m3.1.1.2" xref="S5.SS2.SSS0.Px3.p1.3.m3.1.1.2.cmml">P</mi><mrow id="S5.SS2.SSS0.Px3.p1.3.m3.1.1.3" xref="S5.SS2.SSS0.Px3.p1.3.m3.1.1.3.cmml"><mi id="S5.SS2.SSS0.Px3.p1.3.m3.1.1.3.2" xref="S5.SS2.SSS0.Px3.p1.3.m3.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px3.p1.3.m3.1.1.3.1" xref="S5.SS2.SSS0.Px3.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px3.p1.3.m3.1.1.3.3" xref="S5.SS2.SSS0.Px3.p1.3.m3.1.1.3.3.cmml">b</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px3.p1.3.m3.1.1.3.1a" xref="S5.SS2.SSS0.Px3.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px3.p1.3.m3.1.1.3.4" xref="S5.SS2.SSS0.Px3.p1.3.m3.1.1.3.4.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p1.3.m3.1b"><apply id="S5.SS2.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S5.SS2.SSS0.Px3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px3.p1.3.m3.1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p1.3.m3.1.1">subscript</csymbol><ci id="S5.SS2.SSS0.Px3.p1.3.m3.1.1.2.cmml" xref="S5.SS2.SSS0.Px3.p1.3.m3.1.1.2">𝑃</ci><apply id="S5.SS2.SSS0.Px3.p1.3.m3.1.1.3.cmml" xref="S5.SS2.SSS0.Px3.p1.3.m3.1.1.3"><times id="S5.SS2.SSS0.Px3.p1.3.m3.1.1.3.1.cmml" xref="S5.SS2.SSS0.Px3.p1.3.m3.1.1.3.1"></times><ci id="S5.SS2.SSS0.Px3.p1.3.m3.1.1.3.2.cmml" xref="S5.SS2.SSS0.Px3.p1.3.m3.1.1.3.2">𝑜</ci><ci id="S5.SS2.SSS0.Px3.p1.3.m3.1.1.3.3.cmml" xref="S5.SS2.SSS0.Px3.p1.3.m3.1.1.3.3">𝑏</ci><ci id="S5.SS2.SSS0.Px3.p1.3.m3.1.1.3.4.cmml" xref="S5.SS2.SSS0.Px3.p1.3.m3.1.1.3.4">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p1.3.m3.1c">P_{obj}</annotation></semantics></math> , <math id="S5.SS2.SSS0.Px3.p1.4.m4.1" class="ltx_Math" alttext="P_{attribute}" display="inline"><semantics id="S5.SS2.SSS0.Px3.p1.4.m4.1a"><msub id="S5.SS2.SSS0.Px3.p1.4.m4.1.1" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.cmml"><mi id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.2" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.2.cmml">P</mi><mrow id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.cmml"><mi id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.2" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.1" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.3" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.1a" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.4" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.1b" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.5" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.1c" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.6" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.1d" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.7" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.7.cmml">b</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.1e" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.8" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.8.cmml">u</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.1f" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.9" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.9.cmml">t</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.1g" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.10" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.10.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p1.4.m4.1b"><apply id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1">subscript</csymbol><ci id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.2.cmml" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.2">𝑃</ci><apply id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.cmml" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3"><times id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.1.cmml" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.1"></times><ci id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.2.cmml" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.2">𝑎</ci><ci id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.3.cmml" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.3">𝑡</ci><ci id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.4.cmml" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.4">𝑡</ci><ci id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.5.cmml" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.5">𝑟</ci><ci id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.6.cmml" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.6">𝑖</ci><ci id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.7.cmml" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.7">𝑏</ci><ci id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.8.cmml" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.8">𝑢</ci><ci id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.9.cmml" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.9">𝑡</ci><ci id="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.10.cmml" xref="S5.SS2.SSS0.Px3.p1.4.m4.1.1.3.10">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p1.4.m4.1c">P_{attribute}</annotation></semantics></math> are the weight matrices of a linear layer, the contextual embedding of an object, the probability distribution over all objects and the probability distribution over the attributes. <math id="S5.SS2.SSS0.Px3.p1.5.m5.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S5.SS2.SSS0.Px3.p1.5.m5.1a"><mi id="S5.SS2.SSS0.Px3.p1.5.m5.1.1" xref="S5.SS2.SSS0.Px3.p1.5.m5.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p1.5.m5.1b"><ci id="S5.SS2.SSS0.Px3.p1.5.m5.1.1.cmml" xref="S5.SS2.SSS0.Px3.p1.5.m5.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p1.5.m5.1c">\sigma</annotation></semantics></math> denotes the sigmoid function.
<br class="ltx_break">We have trained both the object detector and the scene graph generator on a pruned version of GQA with their respective default parameters after the prepossessing. This helps to increase the coverage of all the instances (e.g., objects, attributes, relationships ) on training questions from <math id="S5.SS2.SSS0.Px3.p1.6.m6.1" class="ltx_Math" alttext="52\%" display="inline"><semantics id="S5.SS2.SSS0.Px3.p1.6.m6.1a"><mrow id="S5.SS2.SSS0.Px3.p1.6.m6.1.1" xref="S5.SS2.SSS0.Px3.p1.6.m6.1.1.cmml"><mn id="S5.SS2.SSS0.Px3.p1.6.m6.1.1.2" xref="S5.SS2.SSS0.Px3.p1.6.m6.1.1.2.cmml">52</mn><mo id="S5.SS2.SSS0.Px3.p1.6.m6.1.1.1" xref="S5.SS2.SSS0.Px3.p1.6.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p1.6.m6.1b"><apply id="S5.SS2.SSS0.Px3.p1.6.m6.1.1.cmml" xref="S5.SS2.SSS0.Px3.p1.6.m6.1.1"><csymbol cd="latexml" id="S5.SS2.SSS0.Px3.p1.6.m6.1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p1.6.m6.1.1.1">percent</csymbol><cn type="integer" id="S5.SS2.SSS0.Px3.p1.6.m6.1.1.2.cmml" xref="S5.SS2.SSS0.Px3.p1.6.m6.1.1.2">52</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p1.6.m6.1c">52\%</annotation></semantics></math> to <math id="S5.SS2.SSS0.Px3.p1.7.m7.1" class="ltx_Math" alttext="77\%" display="inline"><semantics id="S5.SS2.SSS0.Px3.p1.7.m7.1a"><mrow id="S5.SS2.SSS0.Px3.p1.7.m7.1.1" xref="S5.SS2.SSS0.Px3.p1.7.m7.1.1.cmml"><mn id="S5.SS2.SSS0.Px3.p1.7.m7.1.1.2" xref="S5.SS2.SSS0.Px3.p1.7.m7.1.1.2.cmml">77</mn><mo id="S5.SS2.SSS0.Px3.p1.7.m7.1.1.1" xref="S5.SS2.SSS0.Px3.p1.7.m7.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p1.7.m7.1b"><apply id="S5.SS2.SSS0.Px3.p1.7.m7.1.1.cmml" xref="S5.SS2.SSS0.Px3.p1.7.m7.1.1"><csymbol cd="latexml" id="S5.SS2.SSS0.Px3.p1.7.m7.1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p1.7.m7.1.1.1">percent</csymbol><cn type="integer" id="S5.SS2.SSS0.Px3.p1.7.m7.1.1.2.cmml" xref="S5.SS2.SSS0.Px3.p1.7.m7.1.1.2">77</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p1.7.m7.1c">77\%</annotation></semantics></math> implying that our generated scene graph now covers <math id="S5.SS2.SSS0.Px3.p1.8.m8.1" class="ltx_Math" alttext="77\%" display="inline"><semantics id="S5.SS2.SSS0.Px3.p1.8.m8.1a"><mrow id="S5.SS2.SSS0.Px3.p1.8.m8.1.1" xref="S5.SS2.SSS0.Px3.p1.8.m8.1.1.cmml"><mn id="S5.SS2.SSS0.Px3.p1.8.m8.1.1.2" xref="S5.SS2.SSS0.Px3.p1.8.m8.1.1.2.cmml">77</mn><mo id="S5.SS2.SSS0.Px3.p1.8.m8.1.1.1" xref="S5.SS2.SSS0.Px3.p1.8.m8.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p1.8.m8.1b"><apply id="S5.SS2.SSS0.Px3.p1.8.m8.1.1.cmml" xref="S5.SS2.SSS0.Px3.p1.8.m8.1.1"><csymbol cd="latexml" id="S5.SS2.SSS0.Px3.p1.8.m8.1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p1.8.m8.1.1.1">percent</csymbol><cn type="integer" id="S5.SS2.SSS0.Px3.p1.8.m8.1.1.2.cmml" xref="S5.SS2.SSS0.Px3.p1.8.m8.1.1.2">77</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p1.8.m8.1c">77\%</annotation></semantics></math> of all instances that represent answers to the training questions.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T2.2.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S5.T2.3.2" class="ltx_text" style="font-size:90%;">A comparison of our method with NSM, based on generated scene graphs. Graphhopper (pr) indicates that we employed predicted relations from RTN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>.</span></figcaption>
<table id="S5.T2.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.4.1.1" class="ltx_tr">
<th id="S5.T2.4.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t">Method</th>
<th id="S5.T2.4.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Binary</th>
<th id="S5.T2.4.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Open</th>
<th id="S5.T2.4.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Consistency</th>
<th id="S5.T2.4.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Validity</th>
<th id="S5.T2.4.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Plausibility</th>
<th id="S5.T2.4.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Accuracy</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.4.2.1" class="ltx_tr">
<th id="S5.T2.4.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">NSM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>
</th>
<td id="S5.T2.4.2.1.2" class="ltx_td ltx_align_center ltx_border_t">51.88</td>
<td id="S5.T2.4.2.1.3" class="ltx_td ltx_align_center ltx_border_t">19.83</td>
<td id="S5.T2.4.2.1.4" class="ltx_td ltx_align_center ltx_border_t">82.01</td>
<td id="S5.T2.4.2.1.5" class="ltx_td ltx_align_center ltx_border_t">86.28</td>
<td id="S5.T2.4.2.1.6" class="ltx_td ltx_align_center ltx_border_t">81.75</td>
<td id="S5.T2.4.2.1.7" class="ltx_td ltx_align_center ltx_border_t">35.34</td>
</tr>
<tr id="S5.T2.4.3.2" class="ltx_tr">
<th id="S5.T2.4.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Graphhopper</th>
<td id="S5.T2.4.3.2.2" class="ltx_td ltx_align_center"><span id="S5.T2.4.3.2.2.1" class="ltx_text ltx_font_bold">69.48</span></td>
<td id="S5.T2.4.3.2.3" class="ltx_td ltx_align_center"><span id="S5.T2.4.3.2.3.1" class="ltx_text ltx_font_bold">44.69</span></td>
<td id="S5.T2.4.3.2.4" class="ltx_td ltx_align_center"><span id="S5.T2.4.3.2.4.1" class="ltx_text ltx_font_bold">83.64</span></td>
<td id="S5.T2.4.3.2.5" class="ltx_td ltx_align_center"><span id="S5.T2.4.3.2.5.1" class="ltx_text ltx_font_bold">89.42</span></td>
<td id="S5.T2.4.3.2.6" class="ltx_td ltx_align_center"><span id="S5.T2.4.3.2.6.1" class="ltx_text ltx_font_bold">85.13</span></td>
<td id="S5.T2.4.3.2.7" class="ltx_td ltx_align_center"><span id="S5.T2.4.3.2.7.1" class="ltx_text ltx_font_bold">56.69</span></td>
</tr>
<tr id="S5.T2.4.4.3" class="ltx_tr">
<th id="S5.T2.4.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_t">Graphhopper (pr)</th>
<td id="S5.T2.4.4.3.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">85.84</td>
<td id="S5.T2.4.4.3.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">77.27</td>
<td id="S5.T2.4.4.3.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">92.98</td>
<td id="S5.T2.4.4.3.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">92.26</td>
<td id="S5.T2.4.4.3.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">89.50</td>
<td id="S5.T2.4.4.3.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">81.41</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S5.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F3.sf1" class="ltx_figure ltx_figure_panel"><img src="/html/2107.06325/assets/bat-min.png" id="S5.F3.sf1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="481" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S5.F3.sf1.3.2" class="ltx_text" style="font-size:90%;">Question: Is the color of the number the same as that of the wristband? 
<br class="ltx_break">Answer: No.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F3.sf2" class="ltx_figure ltx_figure_panel"><img src="/html/2107.06325/assets/kitchen-min.png" id="S5.F3.sf2.g1" class="ltx_graphics ltx_img_square" width="598" height="491" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S5.F3.sf2.3.2" class="ltx_text" style="font-size:90%;">Question: What is the name of the appliance that is not small? 
<br class="ltx_break">Answer: Refrigerator.
</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F3.sf3" class="ltx_figure ltx_figure_panel"><img src="/html/2107.06325/assets/food-min.png" id="S5.F3.sf3.g1" class="ltx_graphics ltx_img_square" width="598" height="494" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="S5.F3.sf3.3.2" class="ltx_text" style="font-size:90%;">Do both the pepper and the vegetable to the right of the ice cube have green color? 
<br class="ltx_break">Answer: Yes.
</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S5.F3.3.2" class="ltx_text" style="font-size:90%;">Three examples question and the corresponding images and paths.</span></figcaption>
</figure>
<figure id="S5.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F4.sf1" class="ltx_figure ltx_figure_panel">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S5.F4.sf1.1" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:130.1pt;">
<img src="/html/2107.06325/assets/images/gt/acc_semantic.png" id="S5.F4.sf1.1.g1" class="ltx_graphics ltx_img_square" width="598" height="606" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S5.F4.sf1.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:130.1pt;">
<img src="/html/2107.06325/assets/images/gt/acc_structural.png" id="S5.F4.sf1.2.g1" class="ltx_graphics ltx_img_square" width="598" height="615" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S5.F4.sf1.3" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:130.1pt;">
<img src="/html/2107.06325/assets/images/gt/acc_step.png" id="S5.F4.sf1.3.g1" class="ltx_graphics ltx_img_square" width="658" height="674" alt="Refer to caption">
</div>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.sf1.5.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F4.sf2" class="ltx_figure ltx_figure_panel">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S5.F4.sf2.1" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_bottom" style="width:130.1pt;">
<img src="/html/2107.06325/assets/images/predR/acc_semantic.png" id="S5.F4.sf2.1.g1" class="ltx_graphics ltx_img_square" width="598" height="606" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S5.F4.sf2.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_bottom" style="width:130.1pt;">
<img src="/html/2107.06325/assets/images/predR/acc_structure.png" id="S5.F4.sf2.2.g1" class="ltx_graphics ltx_img_square" width="598" height="617" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S5.F4.sf2.3" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_bottom" style="width:130.1pt;">
<img src="/html/2107.06325/assets/images/predR/acc_step.png" id="S5.F4.sf2.3.g1" class="ltx_graphics ltx_img_square" width="658" height="669" alt="Refer to caption">
</div>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.sf2.5.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F4.sf3" class="ltx_figure ltx_figure_panel">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S5.F4.sf3.1" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_bottom" style="width:130.1pt;">
<img src="/html/2107.06325/assets/images/predSG/acc_semantic.png" id="S5.F4.sf3.1.g1" class="ltx_graphics ltx_img_square" width="598" height="606" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S5.F4.sf3.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_bottom" style="width:130.1pt;">
<img src="/html/2107.06325/assets/images/predSG/acc_structure.png" id="S5.F4.sf3.2.g1" class="ltx_graphics ltx_img_square" width="598" height="615" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S5.F4.sf3.3" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_bottom" style="width:130.1pt;">
<img src="/html/2107.06325/assets/images/predSG/acc_step.png" id="S5.F4.sf3.3.g1" class="ltx_graphics ltx_img_square" width="658" height="666" alt="Refer to caption">
</div>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.sf3.5.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.2.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S5.F4.3.2" class="ltx_text" style="font-size:90%;">Comparison of the performance of our model on various Scene Graph generation settings, (left) accuracy across various semantic instances (“Attribute”,“Global”,“Relation” etc) required to answer a question (middle) accuracy on multiple types of question category (“Choose”,“Logical”,“Verify” etc) and (right) accuracy on minimum number of steps needed to reach the answer node.</span></figcaption>
</figure>
<div id="S5.SS2.SSS0.Px3.p2" class="ltx_para">
<p id="S5.SS2.SSS0.Px3.p2.1" class="ltx_p">Table <a href="#S5.T2" title="Table 2 ‣ Attribute prediction: ‣ 5.2 Results on automatically generated graph ‣ 5 Results and Discussion ‣ Graphhopper: Multi-Hop Scene Graph Reasoning for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, shows the performance of Graphhopper in two settings: First, with a generated graph where we predict the classes, the attributes, and relationships using our own pipeline. Second, where we only use the predicted relationships from RTN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> (with ground truth objects and attributes). We find that Graphhopper consistently outperforms NSM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> based on the generated graph. Moreover, in the “pr” or predicted relations setting, it achieves an even higher score as the graphs do not contain any misprediction from the object detector. These encouraging results show superior reasoning abilities both on the generated graph and generated relationships between objects.</p>
</div>
</section>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Discussion on the Reasoning Ability</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.1" class="ltx_p">To further analyze the reasoning abilities of Graphhopper, Figure <a href="#S5.F4" title="Figure 4 ‣ Attribute prediction: ‣ 5.2 Results on automatically generated graph ‣ 5 Results and Discussion ‣ Graphhopper: Multi-Hop Scene Graph Reasoning for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> disentangles the results according to different types of questions: 5 semantic types (left) and 5 structural types (middle). Moreover, we report the performance of Graphhopper according to the length of the reasoning path (right) (see the supplementary material for additional information).
Moreover, we show the performance of Graphhopper separately for each of the three scene graph settings that we considered in this work. Figure <a href="#S5.F4.sf1" title="Figure 4(a) ‣ Figure 4 ‣ Attribute prediction: ‣ 5.2 Results on automatically generated graph ‣ 5 Results and Discussion ‣ Graphhopper: Multi-Hop Scene Graph Reasoning for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4(a)</span></a> shows performance on a manually curated scene graph that depicts the actual performance in an ideal environment. Figure <a href="#S5.F4.sf2" title="Figure 4(b) ‣ Figure 4 ‣ Attribute prediction: ‣ 5.2 Results on automatically generated graph ‣ 5 Results and Discussion ‣ Graphhopper: Multi-Hop Scene Graph Reasoning for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4(b)</span></a> illustrates the performance based on only the predicted relationships between objects. This setting shows the performance of Graphhopper along with a scene graph generator. Finally, Figure <a href="#S5.F4.sf3" title="Figure 4(c) ‣ Figure 4 ‣ Attribute prediction: ‣ 5.2 Results on automatically generated graph ‣ 5 Results and Discussion ‣ Graphhopper: Multi-Hop Scene Graph Reasoning for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4(c)</span></a> depicts the performance based on the object detector, the scene graph generator, and Graphhopper. First and foremost, we find that Graphhopper consistently achieves high accuracy on all types of questions in every setting. Moreover, we find that the performance of Graphhopper does not suffer if answering the questions requires many reasoning steps. We conjecture that this is because high-complexity questions are harder to answer, but due to proper contextualization of the embeddings (e.g., via the GAT and the Transformer), the agent can extract the specific information that identifies the correct target node. The good performance on these high-complexity questions can be seen as evidence that Graphhopper can efficiently translate the question into a transition on the scene graph hopping until the correct answer is reached.</p>
</div>
<section id="S5.SS3.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Examples of Reasoning Path: </h4>

<div id="S5.SS3.SSS0.Px1.p1" class="ltx_para">
<p id="S5.SS3.SSS0.Px1.p1.1" class="ltx_p">Figure <a href="#S5.F3" title="Figure 3 ‣ Attribute prediction: ‣ 5.2 Results on automatically generated graph ‣ 5 Results and Discussion ‣ Graphhopper: Multi-Hop Scene Graph Reasoning for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows three examples of scene graph traversals of Graphhopper that lead to the correct answer. One can see in these examples that the sequential reasoning process over explicit scene graph entities makes the reasoning process more comprehensible. In the case of wrong predictions, the extracted path may offer insights into the mechanics of Graphhopper and facilitate debugging.</p>
</div>
</section>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">We have proposed Graphhopper, a novel method for visual question answering that integrates existing KG reasoning, computer vision, and natural language processing techniques. Concretely, an agent is trained to extract conclusive reasoning paths from scene graphs. To analyze the reasoning abilities of our method, we conducted a rigorous experimental study on both manually curated and generated scene graphs. Based on the manually curated scene graphs we showed that Graphhopper reaches human performance. Moreover, we find that, on our own automatically generated scene graph, Graphhopper outperform another state-of-the-art scene graph reasoning model with respect to all considered performance metrics. In future works, we plan to combine scene graphs with common sense knowledge graphs to further enhance the reasoning abilities of Graphhopper.
</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Abbasnejad, E., Teney, D., Parvaneh, A., Shi, J., Hengel, A.v.d.:
Counterfactual vision and language learning. In: Proceedings of the IEEE/CVF
Conference on Computer Vision and Pattern Recognition. pp. 10044–10054
(2020)

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Anderson, P., He, X., Buehler, C., Teney, D., Johnson, M., Gould, S., Zhang,
L.: Bottom-up and top-down attention for image captioning and visual question
answering. In: Proceedings of the IEEE conference on computer vision and
pattern recognition. pp. 6077–6086 (2018)

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Andreas, J., Rohrbach, M., Darrell, T., Klein, D.: Neural module networks. In:
Proceedings of the IEEE Conference on Computer Vision and Pattern
Recognition. pp. 39–48 (2016)

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Antol, S., Agrawal, A., Lu, J., Mitchell, M., Batra, D., Lawrence Zitnick, C.,
Parikh, D.: Vqa: Visual question answering. In: Proceedings of the IEEE
international conference on computer vision. pp. 2425–2433 (2015)

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Cadene, R., Ben-Younes, H., Cord, M., Thome, N.: Murel: Multimodal relational
reasoning for visual question answering. In: Proceedings of the IEEE
Conference on Computer Vision and Pattern Recognition. pp. 1989–1998 (2019)

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Chen, L., Zhang, H., Xiao, J., He, X., Pu, S., Chang, S.F.: Counterfactual
critic multi-agent training for scene graph generation. In: Proceedings of
the IEEE/CVF International Conference on Computer Vision. pp. 4613–4623
(2019)

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Chen, W., Gan, Z., Li, L., Cheng, Y., Wang, W., Liu, J.: Meta module network
for compositional visual reasoning. arXiv preprint arXiv:1910.03230 (2019)

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Das, R., Dhuliawala, S., Zaheer, M., Vilnis, L., Durugkar, I., Krishnamurthy,
A., Smola, A., McCallum, A.: Go for a walk and arrive at the answer:
Reasoning over paths in knowledge bases using reinforcement learning. In:
ICLR (2018)

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Eyzaguirre, C.: Nsm. <a target="_blank" href="https://github.com/charlespwd/project-title" title="" class="ltx_ref">https://github.com/charlespwd/project-title</a> (2019)

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Gan, Z., Chen, Y.C., Li, L., Zhu, C., Cheng, Y., Liu, J.: Large-scale
adversarial training for vision-and-language representation learning. arXiv
preprint arXiv:2006.06195 (2020)

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Glorot, X., Bengio, Y.: Understanding the difficulty of training deep
feedforward neural networks. In: Proceedings of the thirteenth international
conference on artificial intelligence and statistics. pp. 249–256 (2010)

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Hildebrandt, M., Serna, J.A.Q., Ma, Y., Ringsquandl, M., Joblin, M., Tresp, V.:
Reasoning on knowledge graphs with debate dynamics. arXiv preprint
arXiv:2001.00461 (2020)

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Hochreiter, S., Schmidhuber, J.: Long short-term memory. Neural computation
<span id="bib.bib13.1.1" class="ltx_text ltx_font_bold">9</span>(8), 1735–1780 (1997)

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Hu, R., Andreas, J., Rohrbach, M., Darrell, T., Saenko, K.: Learning to reason:
End-to-end module networks for visual question answering. In: Proceedings of
the IEEE International Conference on Computer Vision. pp. 804–813 (2017)

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Hudson, D., Manning, C.D.: Learning by abstraction: The neural state machine.
In: Advances in Neural Information Processing Systems. pp. 5901–5914 (2019)

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Hudson, D.A., Manning, C.D.: Compositional attention networks for machine
reasoning. arXiv preprint arXiv:1803.03067 (2018)

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Hudson, D.A., Manning, C.D.: Gqa: A new dataset for real-world visual reasoning
and compositional question answering. arXiv preprint arXiv:1902.09506 (2019)

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Johnson, J., Hariharan, B., van der Maaten, L., Fei-Fei, L., Lawrence Zitnick,
C., Girshick, R.: Clevr: A diagnostic dataset for compositional language and
elementary visual reasoning. In: Proceedings of the IEEE Conference on
Computer Vision and Pattern Recognition. pp. 2901–2910 (2017)

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Johnson, J., Krishna, R., Stark, M., Li, L.J., Shamma, D., Bernstein, M.,
Fei-Fei, L.: Image retrieval using scene graphs. In: Proceedings of the IEEE
conference on computer vision and pattern recognition. pp. 3668–3678 (2015)

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Kim, J.H., Jun, J., Zhang, B.T.: Bilinear attention networks. In: Advances in
Neural Information Processing Systems. pp. 1564–1574 (2018)

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Kingma, D.P., Ba, J.: Adam: A method for stochastic optimization. arXiv
preprint arXiv:1412.6980 (2014)

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Kipf, T.N., Welling, M.: Semi-supervised classification with graph
convolutional networks. arXiv preprint arXiv:1609.02907 (2016)

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Koner, R., Sinhamahapatra, P., Tresp, V.: Relation transformer network. arXiv
preprint arXiv:2004.06193 (2020)

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Krishna, R., Zhu, Y., Groth, O., Johnson, J., Hata, K., Kravitz, J., Chen, S.,
Kalantidis, Y., Li, L.J., Shamma, D.A., et al.: Visual genome: Connecting
language and vision using crowdsourced dense image annotations. International
Journal of Computer Vision <span id="bib.bib24.1.1" class="ltx_text ltx_font_bold">123</span>(1), 32–73 (2017)

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Lin, T.Y., Maire, M., Belongie, S., Hays, J., Perona, P., Ramanan, D.,
Dollár, P., Zitnick, C.L.: Microsoft coco: Common objects in context. In:
European conference on computer vision. pp. 740–755. Springer (2014)

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Mao, J., Gan, C., Kohli, P., Tenenbaum, J.B., Wu, J.: The neuro-symbolic
concept learner: Interpreting scenes, words, and sentences from natural
supervision. arXiv preprint arXiv:1904.12584 (2019)

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Nickel, M., Murphy, K., Tresp, V., Gabrilovich, E.: A review of relational
machine learning for knowledge graphs. Proceedings of the IEEE
<span id="bib.bib27.1.1" class="ltx_text ltx_font_bold">104</span>(1), 11–33 (2015)

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Paszke, A., Gross, S., Chintala, S., Chanan, G., Yang, E., DeVito, Z., Lin, Z.,
Desmaison, A., Antiga, L., Lerer, A.: Automatic differentiation in pytorch
(2017)

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Pennington, J., Socher, R., Manning, C.D.: Glove: Global vectors for word
representation. In: Empirical Methods in Natural Language Processing (EMNLP).
pp. 1532–1543 (2014), <a target="_blank" href="http://www.aclweb.org/anthology/D14-1162" title="" class="ltx_ref">http://www.aclweb.org/anthology/D14-1162</a>

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Qiao, S., Chen, L.C., Yuille, A.: Detectors: Detecting objects with recursive
feature pyramid and switchable atrous convolution. arXiv preprint
arXiv:2006.02334 (2020)

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Shi, J., Zhang, H., Li, J.: Explainable and explicit visual reasoning over
scene graphs. In: Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition. pp. 8376–8384 (2019)

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Srivastava, N., Hinton, G., Krizhevsky, A., Sutskever, I., Salakhutdinov, R.:
Dropout: a simple way to prevent neural networks from overfitting. The
journal of machine learning research <span id="bib.bib32.1.1" class="ltx_text ltx_font_bold">15</span>(1), 1929–1958 (2014)

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Tang, K., Niu, Y., Huang, J., Shi, J., Zhang, H.: Unbiased scene graph
generation from biased training. In: Proceedings of the IEEE/CVF Conference
on Computer Vision and Pattern Recognition. pp. 3716–3725 (2020)

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Teney, D., Liu, L., van Den Hengel, A.: Graph-structured representations for
visual question answering. In: Proceedings of the IEEE Conference on Computer
Vision and Pattern Recognition. pp. 1–9 (2017)

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, L., Gomez, A.N.,
Kaiser, Ł., Polosukhin, I.: Attention is all you need. In: Advances in
neural information processing systems. pp. 5998–6008 (2017)

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Veličković, P., Cucurull, G., Casanova, A., Romero, A., Lio, P.,
Bengio, Y.: Graph attention networks. arXiv preprint arXiv:1710.10903 (2017)

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Williams, R.J.: Simple statistical gradient-following algorithms for
connectionist reinforcement learning. Machine learning <span id="bib.bib37.1.1" class="ltx_text ltx_font_bold">8</span>(3-4),
229–256 (1992)

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Xiong, W., Hoang, T., Wang, W.Y.: Deeppath: A reinforcement learning method for
knowledge graph reasoning. In: Proceedings of the 2017 Conference on
Empirical Methods in Natural Language Processing (EMNLP 2017). ACL,
Copenhagen, Denmark (9 2017)

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Yang, Z., He, X., Gao, J., Deng, L., Smola, A.: Stacked attention networks for
image question answering. In: Proceedings of the IEEE conference on computer
vision and pattern recognition. pp. 21–29 (2016)

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Yu, Z., Yu, J., Fan, J., Tao, D.: Multi-modal factorized bilinear pooling with
co-attention learning for visual question answering. In: Proceedings of the
IEEE international conference on computer vision. pp. 1821–1830 (2017)

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Zhu, C., Zhao, Y., Huang, S., Tu, K., Ma, Y.: Structured attentions for visual
question answering. In: Proceedings of the IEEE International Conference on
Computer Vision. pp. 1291–1300 (2017)

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="Pt0.A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix 0.A </span>Details on Model Training and Inference</h2>

<section id="Pt0.A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">0.A.1 </span>Training Details</h3>

<div id="Pt0.A1.SS1.p1" class="ltx_para">
<p id="Pt0.A1.SS1.p1.7" class="ltx_p">In order to optimize the training objective given by Equation (<a href="#S3.E4" title="Equation 4 ‣ Rewards and Optimization ‣ 3 Method ‣ Graphhopper: Multi-Hop Scene Graph Reasoning for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>), we use REINFORCE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> to obtain the gradient approximation</p>
<table id="Pt0.A1.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Pt0.A1.E6.m1.1" class="ltx_Math" alttext="\hat{g}=\sum_{t=0}^{T-1}{\nabla_{\theta}\log\pi_{\theta}(A_{t}|S_{t})(\sum_{t^{{}^{\prime}}=t}^{T-1}{R_{t^{{}^{\prime}}}\gamma^{t^{{}^{\prime}}-t}-B(S_{t})})}\,," display="block"><semantics id="Pt0.A1.E6.m1.1a"><mrow id="Pt0.A1.E6.m1.1.1.1" xref="Pt0.A1.E6.m1.1.1.1.1.cmml"><mrow id="Pt0.A1.E6.m1.1.1.1.1" xref="Pt0.A1.E6.m1.1.1.1.1.cmml"><mover accent="true" id="Pt0.A1.E6.m1.1.1.1.1.4" xref="Pt0.A1.E6.m1.1.1.1.1.4.cmml"><mi id="Pt0.A1.E6.m1.1.1.1.1.4.2" xref="Pt0.A1.E6.m1.1.1.1.1.4.2.cmml">g</mi><mo id="Pt0.A1.E6.m1.1.1.1.1.4.1" xref="Pt0.A1.E6.m1.1.1.1.1.4.1.cmml">^</mo></mover><mo rspace="0.111em" id="Pt0.A1.E6.m1.1.1.1.1.3" xref="Pt0.A1.E6.m1.1.1.1.1.3.cmml">=</mo><mrow id="Pt0.A1.E6.m1.1.1.1.1.2" xref="Pt0.A1.E6.m1.1.1.1.1.2.cmml"><munderover id="Pt0.A1.E6.m1.1.1.1.1.2.3" xref="Pt0.A1.E6.m1.1.1.1.1.2.3.cmml"><mo movablelimits="false" id="Pt0.A1.E6.m1.1.1.1.1.2.3.2.2" xref="Pt0.A1.E6.m1.1.1.1.1.2.3.2.2.cmml">∑</mo><mrow id="Pt0.A1.E6.m1.1.1.1.1.2.3.2.3" xref="Pt0.A1.E6.m1.1.1.1.1.2.3.2.3.cmml"><mi id="Pt0.A1.E6.m1.1.1.1.1.2.3.2.3.2" xref="Pt0.A1.E6.m1.1.1.1.1.2.3.2.3.2.cmml">t</mi><mo id="Pt0.A1.E6.m1.1.1.1.1.2.3.2.3.1" xref="Pt0.A1.E6.m1.1.1.1.1.2.3.2.3.1.cmml">=</mo><mn id="Pt0.A1.E6.m1.1.1.1.1.2.3.2.3.3" xref="Pt0.A1.E6.m1.1.1.1.1.2.3.2.3.3.cmml">0</mn></mrow><mrow id="Pt0.A1.E6.m1.1.1.1.1.2.3.3" xref="Pt0.A1.E6.m1.1.1.1.1.2.3.3.cmml"><mi id="Pt0.A1.E6.m1.1.1.1.1.2.3.3.2" xref="Pt0.A1.E6.m1.1.1.1.1.2.3.3.2.cmml">T</mi><mo id="Pt0.A1.E6.m1.1.1.1.1.2.3.3.1" xref="Pt0.A1.E6.m1.1.1.1.1.2.3.3.1.cmml">−</mo><mn id="Pt0.A1.E6.m1.1.1.1.1.2.3.3.3" xref="Pt0.A1.E6.m1.1.1.1.1.2.3.3.3.cmml">1</mn></mrow></munderover><mrow id="Pt0.A1.E6.m1.1.1.1.1.2.2" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.cmml"><mrow id="Pt0.A1.E6.m1.1.1.1.1.2.2.4" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.4.cmml"><mrow id="Pt0.A1.E6.m1.1.1.1.1.2.2.4.1" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.4.1.cmml"><msub id="Pt0.A1.E6.m1.1.1.1.1.2.2.4.1.1" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.4.1.1.cmml"><mo rspace="0.167em" id="Pt0.A1.E6.m1.1.1.1.1.2.2.4.1.1.2" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.4.1.1.2.cmml">∇</mo><mi id="Pt0.A1.E6.m1.1.1.1.1.2.2.4.1.1.3" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.4.1.1.3.cmml">θ</mi></msub><mi id="Pt0.A1.E6.m1.1.1.1.1.2.2.4.1.2" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.4.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="Pt0.A1.E6.m1.1.1.1.1.2.2.4a" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.4.cmml">⁡</mo><msub id="Pt0.A1.E6.m1.1.1.1.1.2.2.4.2" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.4.2.cmml"><mi id="Pt0.A1.E6.m1.1.1.1.1.2.2.4.2.2" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.4.2.2.cmml">π</mi><mi id="Pt0.A1.E6.m1.1.1.1.1.2.2.4.2.3" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.4.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="Pt0.A1.E6.m1.1.1.1.1.2.2.3" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.3.cmml">​</mo><mrow id="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1" xref="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.2" xref="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1" xref="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.2" xref="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.2.2" xref="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">A</mi><mi id="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.2.3" xref="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.1" xref="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.3" xref="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.3.2" xref="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">S</mi><mi id="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.3.3" xref="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.3" xref="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="Pt0.A1.E6.m1.1.1.1.1.2.2.3a" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.3.cmml">​</mo><mrow id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.cmml"><mo stretchy="false" id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.2" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.cmml">(</mo><mrow id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.cmml"><mrow id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.cmml"><munderover id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.cmml"><mo lspace="0em" movablelimits="false" id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.2" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.2.cmml">∑</mo><mrow id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.cmml"><msup id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.2" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.2.cmml"><mi id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.2.2" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.2.2.cmml">t</mi><msup id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.2.3" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.2.3.cmml"><mi id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.2.3a" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.2.3.cmml"></mi><mo id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.2.3.1" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.2.3.1.cmml">′</mo></msup></msup><mo id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.1" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.1.cmml">=</mo><mi id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.3" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.3.cmml">t</mi></mrow><mrow id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.3" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.3.cmml"><mi id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.3.2" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.3.2.cmml">T</mi><mo id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.3.1" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.3.1.cmml">−</mo><mn id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.3.3" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.3.3.cmml">1</mn></mrow></munderover><mrow id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.cmml"><msub id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2.cmml"><mi id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2.2" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2.2.cmml">R</mi><msup id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2.3" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2.3.cmml"><mi id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2.3.2" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2.3.2.cmml">t</mi><msup id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2.3.3" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2.3.3.cmml"><mi id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2.3.3a" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2.3.3.cmml"></mi><mo id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2.3.3.1" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2.3.3.1.cmml">′</mo></msup></msup></msub><mo lspace="0em" rspace="0em" id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.1" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.1.cmml">​</mo><msup id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.cmml"><mi id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.2" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.2.cmml">γ</mi><mrow id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.cmml"><msup id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.2" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.2.cmml"><mi id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.2.2" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.2.2.cmml">t</mi><msup id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.2.3" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.2.3.cmml"><mi id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.2.3a" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.2.3.cmml"></mi><mo id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.2.3.1" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.2.3.1.cmml">′</mo></msup></msup><mo id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.1" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.1.cmml">−</mo><mi id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.3" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.3.cmml">t</mi></mrow></msup></mrow></mrow><mo id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.2" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.2.cmml">−</mo><mrow id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.cmml"><mi id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.3" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.3.cmml">B</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.2" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.2.cmml">​</mo><mrow id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.1.1" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.1.1.2" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.1.1.1" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.1.1.1.cmml"><mi id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.1.1.1.2" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.1.1.1.2.cmml">S</mi><mi id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.1.1.1.3" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.1.1.3" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.170em" stretchy="false" id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.3" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="Pt0.A1.E6.m1.1.1.1.2" xref="Pt0.A1.E6.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.E6.m1.1b"><apply id="Pt0.A1.E6.m1.1.1.1.1.cmml" xref="Pt0.A1.E6.m1.1.1.1"><eq id="Pt0.A1.E6.m1.1.1.1.1.3.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.3"></eq><apply id="Pt0.A1.E6.m1.1.1.1.1.4.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.4"><ci id="Pt0.A1.E6.m1.1.1.1.1.4.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.4.1">^</ci><ci id="Pt0.A1.E6.m1.1.1.1.1.4.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.4.2">𝑔</ci></apply><apply id="Pt0.A1.E6.m1.1.1.1.1.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2"><apply id="Pt0.A1.E6.m1.1.1.1.1.2.3.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="Pt0.A1.E6.m1.1.1.1.1.2.3.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.3">superscript</csymbol><apply id="Pt0.A1.E6.m1.1.1.1.1.2.3.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="Pt0.A1.E6.m1.1.1.1.1.2.3.2.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.3">subscript</csymbol><sum id="Pt0.A1.E6.m1.1.1.1.1.2.3.2.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.3.2.2"></sum><apply id="Pt0.A1.E6.m1.1.1.1.1.2.3.2.3.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.3.2.3"><eq id="Pt0.A1.E6.m1.1.1.1.1.2.3.2.3.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.3.2.3.1"></eq><ci id="Pt0.A1.E6.m1.1.1.1.1.2.3.2.3.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.3.2.3.2">𝑡</ci><cn type="integer" id="Pt0.A1.E6.m1.1.1.1.1.2.3.2.3.3.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.3.2.3.3">0</cn></apply></apply><apply id="Pt0.A1.E6.m1.1.1.1.1.2.3.3.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.3.3"><minus id="Pt0.A1.E6.m1.1.1.1.1.2.3.3.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.3.3.1"></minus><ci id="Pt0.A1.E6.m1.1.1.1.1.2.3.3.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.3.3.2">𝑇</ci><cn type="integer" id="Pt0.A1.E6.m1.1.1.1.1.2.3.3.3.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.3.3.3">1</cn></apply></apply><apply id="Pt0.A1.E6.m1.1.1.1.1.2.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2"><times id="Pt0.A1.E6.m1.1.1.1.1.2.2.3.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.3"></times><apply id="Pt0.A1.E6.m1.1.1.1.1.2.2.4.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.4"><apply id="Pt0.A1.E6.m1.1.1.1.1.2.2.4.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.4.1"><apply id="Pt0.A1.E6.m1.1.1.1.1.2.2.4.1.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.4.1.1"><csymbol cd="ambiguous" id="Pt0.A1.E6.m1.1.1.1.1.2.2.4.1.1.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.4.1.1">subscript</csymbol><ci id="Pt0.A1.E6.m1.1.1.1.1.2.2.4.1.1.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.4.1.1.2">∇</ci><ci id="Pt0.A1.E6.m1.1.1.1.1.2.2.4.1.1.3.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.4.1.1.3">𝜃</ci></apply><log id="Pt0.A1.E6.m1.1.1.1.1.2.2.4.1.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.4.1.2"></log></apply><apply id="Pt0.A1.E6.m1.1.1.1.1.2.2.4.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.4.2"><csymbol cd="ambiguous" id="Pt0.A1.E6.m1.1.1.1.1.2.2.4.2.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.4.2">subscript</csymbol><ci id="Pt0.A1.E6.m1.1.1.1.1.2.2.4.2.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.4.2.2">𝜋</ci><ci id="Pt0.A1.E6.m1.1.1.1.1.2.2.4.2.3.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.4.2.3">𝜃</ci></apply></apply><apply id="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.2.2">𝐴</ci><ci id="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.3.2">𝑆</ci><ci id="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1"><minus id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.2"></minus><apply id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3"><apply id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1"><csymbol cd="ambiguous" id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1">superscript</csymbol><apply id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1"><csymbol cd="ambiguous" id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1">subscript</csymbol><sum id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.2"></sum><apply id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3"><eq id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.1"></eq><apply id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.2"><csymbol cd="ambiguous" id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.2.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.2">superscript</csymbol><ci id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.2.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.2.2">𝑡</ci><apply id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.2.3.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.2.3"><ci id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.2.3.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.2.3.1">′</ci></apply></apply><ci id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.3.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.2.3.3">𝑡</ci></apply></apply><apply id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.3.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.3"><minus id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.3.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.3.1"></minus><ci id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.3.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.3.2">𝑇</ci><cn type="integer" id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.3.3.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.1.3.3">1</cn></apply></apply><apply id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2"><times id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.1"></times><apply id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2"><csymbol cd="ambiguous" id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2">subscript</csymbol><ci id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2.2">𝑅</ci><apply id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2.3.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2.3"><csymbol cd="ambiguous" id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2.3.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2.3">superscript</csymbol><ci id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2.3.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2.3.2">𝑡</ci><apply id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2.3.3.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2.3.3"><ci id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2.3.3.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.2.3.3.1">′</ci></apply></apply></apply><apply id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3"><csymbol cd="ambiguous" id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3">superscript</csymbol><ci id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.2">𝛾</ci><apply id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3"><minus id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.1"></minus><apply id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.2"><csymbol cd="ambiguous" id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.2.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.2">superscript</csymbol><ci id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.2.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.2.2">𝑡</ci><apply id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.2.3.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.2.3"><ci id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.2.3.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.2.3.1">′</ci></apply></apply><ci id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.3.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.3.2.3.3.3">𝑡</ci></apply></apply></apply></apply><apply id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1"><times id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.2"></times><ci id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.3.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.3">𝐵</ci><apply id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.1.1.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.1.1.1.1.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.1.1.1.2.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.1.1.1.2">𝑆</ci><ci id="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.1.1.1.3.cmml" xref="Pt0.A1.E6.m1.1.1.1.1.2.2.2.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.E6.m1.1c">\hat{g}=\sum_{t=0}^{T-1}{\nabla_{\theta}\log\pi_{\theta}(A_{t}|S_{t})(\sum_{t^{{}^{\prime}}=t}^{T-1}{R_{t^{{}^{\prime}}}\gamma^{t^{{}^{\prime}}-t}-B(S_{t})})}\,,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="Pt0.A1.SS1.p1.6" class="ltx_p">where <math id="Pt0.A1.SS1.p1.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="Pt0.A1.SS1.p1.1.m1.1a"><mi id="Pt0.A1.SS1.p1.1.m1.1.1" xref="Pt0.A1.SS1.p1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS1.p1.1.m1.1b"><ci id="Pt0.A1.SS1.p1.1.m1.1.1.cmml" xref="Pt0.A1.SS1.p1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS1.p1.1.m1.1c">\gamma</annotation></semantics></math> is the discount factor for the reward. The gradient of the
weights are aggregated over multiple rollouts. To reduce the variance, we adopt a moving average baseline function
<math id="Pt0.A1.SS1.p1.2.m2.1" class="ltx_Math" alttext="B(S_{t})" display="inline"><semantics id="Pt0.A1.SS1.p1.2.m2.1a"><mrow id="Pt0.A1.SS1.p1.2.m2.1.1" xref="Pt0.A1.SS1.p1.2.m2.1.1.cmml"><mi id="Pt0.A1.SS1.p1.2.m2.1.1.3" xref="Pt0.A1.SS1.p1.2.m2.1.1.3.cmml">B</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.SS1.p1.2.m2.1.1.2" xref="Pt0.A1.SS1.p1.2.m2.1.1.2.cmml">​</mo><mrow id="Pt0.A1.SS1.p1.2.m2.1.1.1.1" xref="Pt0.A1.SS1.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="Pt0.A1.SS1.p1.2.m2.1.1.1.1.2" xref="Pt0.A1.SS1.p1.2.m2.1.1.1.1.1.cmml">(</mo><msub id="Pt0.A1.SS1.p1.2.m2.1.1.1.1.1" xref="Pt0.A1.SS1.p1.2.m2.1.1.1.1.1.cmml"><mi id="Pt0.A1.SS1.p1.2.m2.1.1.1.1.1.2" xref="Pt0.A1.SS1.p1.2.m2.1.1.1.1.1.2.cmml">S</mi><mi id="Pt0.A1.SS1.p1.2.m2.1.1.1.1.1.3" xref="Pt0.A1.SS1.p1.2.m2.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="Pt0.A1.SS1.p1.2.m2.1.1.1.1.3" xref="Pt0.A1.SS1.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS1.p1.2.m2.1b"><apply id="Pt0.A1.SS1.p1.2.m2.1.1.cmml" xref="Pt0.A1.SS1.p1.2.m2.1.1"><times id="Pt0.A1.SS1.p1.2.m2.1.1.2.cmml" xref="Pt0.A1.SS1.p1.2.m2.1.1.2"></times><ci id="Pt0.A1.SS1.p1.2.m2.1.1.3.cmml" xref="Pt0.A1.SS1.p1.2.m2.1.1.3">𝐵</ci><apply id="Pt0.A1.SS1.p1.2.m2.1.1.1.1.1.cmml" xref="Pt0.A1.SS1.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="Pt0.A1.SS1.p1.2.m2.1.1.1.1.1.1.cmml" xref="Pt0.A1.SS1.p1.2.m2.1.1.1.1">subscript</csymbol><ci id="Pt0.A1.SS1.p1.2.m2.1.1.1.1.1.2.cmml" xref="Pt0.A1.SS1.p1.2.m2.1.1.1.1.1.2">𝑆</ci><ci id="Pt0.A1.SS1.p1.2.m2.1.1.1.1.1.3.cmml" xref="Pt0.A1.SS1.p1.2.m2.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS1.p1.2.m2.1c">B(S_{t})</annotation></semantics></math>. The baseline function is an approximation of the value of a state <math id="Pt0.A1.SS1.p1.3.m3.1" class="ltx_Math" alttext="S_{t}" display="inline"><semantics id="Pt0.A1.SS1.p1.3.m3.1a"><msub id="Pt0.A1.SS1.p1.3.m3.1.1" xref="Pt0.A1.SS1.p1.3.m3.1.1.cmml"><mi id="Pt0.A1.SS1.p1.3.m3.1.1.2" xref="Pt0.A1.SS1.p1.3.m3.1.1.2.cmml">S</mi><mi id="Pt0.A1.SS1.p1.3.m3.1.1.3" xref="Pt0.A1.SS1.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS1.p1.3.m3.1b"><apply id="Pt0.A1.SS1.p1.3.m3.1.1.cmml" xref="Pt0.A1.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="Pt0.A1.SS1.p1.3.m3.1.1.1.cmml" xref="Pt0.A1.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="Pt0.A1.SS1.p1.3.m3.1.1.2.cmml" xref="Pt0.A1.SS1.p1.3.m3.1.1.2">𝑆</ci><ci id="Pt0.A1.SS1.p1.3.m3.1.1.3.cmml" xref="Pt0.A1.SS1.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS1.p1.3.m3.1c">S_{t}</annotation></semantics></math>. We could have employed more sophisticated methods such as advantage network or actor-critic algorithm. However, we find the current baseline works sufficiently well. Formally, the baseline function consists of a non-trainable
variable <math id="Pt0.A1.SS1.p1.4.m4.1" class="ltx_Math" alttext="b" display="inline"><semantics id="Pt0.A1.SS1.p1.4.m4.1a"><mi id="Pt0.A1.SS1.p1.4.m4.1.1" xref="Pt0.A1.SS1.p1.4.m4.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS1.p1.4.m4.1b"><ci id="Pt0.A1.SS1.p1.4.m4.1.1.cmml" xref="Pt0.A1.SS1.p1.4.m4.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS1.p1.4.m4.1c">b</annotation></semantics></math> and a hyperparameter <math id="Pt0.A1.SS1.p1.5.m5.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="Pt0.A1.SS1.p1.5.m5.1a"><mi id="Pt0.A1.SS1.p1.5.m5.1.1" xref="Pt0.A1.SS1.p1.5.m5.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS1.p1.5.m5.1b"><ci id="Pt0.A1.SS1.p1.5.m5.1.1.cmml" xref="Pt0.A1.SS1.p1.5.m5.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS1.p1.5.m5.1c">\lambda</annotation></semantics></math>. The baseline is updated by <math id="Pt0.A1.SS1.p1.6.m6.1" class="ltx_Math" alttext="b_{t+1}=\lambda b_{t}+(1-\lambda)r_{t}" display="inline"><semantics id="Pt0.A1.SS1.p1.6.m6.1a"><mrow id="Pt0.A1.SS1.p1.6.m6.1.1" xref="Pt0.A1.SS1.p1.6.m6.1.1.cmml"><msub id="Pt0.A1.SS1.p1.6.m6.1.1.3" xref="Pt0.A1.SS1.p1.6.m6.1.1.3.cmml"><mi id="Pt0.A1.SS1.p1.6.m6.1.1.3.2" xref="Pt0.A1.SS1.p1.6.m6.1.1.3.2.cmml">b</mi><mrow id="Pt0.A1.SS1.p1.6.m6.1.1.3.3" xref="Pt0.A1.SS1.p1.6.m6.1.1.3.3.cmml"><mi id="Pt0.A1.SS1.p1.6.m6.1.1.3.3.2" xref="Pt0.A1.SS1.p1.6.m6.1.1.3.3.2.cmml">t</mi><mo id="Pt0.A1.SS1.p1.6.m6.1.1.3.3.1" xref="Pt0.A1.SS1.p1.6.m6.1.1.3.3.1.cmml">+</mo><mn id="Pt0.A1.SS1.p1.6.m6.1.1.3.3.3" xref="Pt0.A1.SS1.p1.6.m6.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="Pt0.A1.SS1.p1.6.m6.1.1.2" xref="Pt0.A1.SS1.p1.6.m6.1.1.2.cmml">=</mo><mrow id="Pt0.A1.SS1.p1.6.m6.1.1.1" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.cmml"><mrow id="Pt0.A1.SS1.p1.6.m6.1.1.1.3" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.3.cmml"><mi id="Pt0.A1.SS1.p1.6.m6.1.1.1.3.2" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.SS1.p1.6.m6.1.1.1.3.1" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.3.1.cmml">​</mo><msub id="Pt0.A1.SS1.p1.6.m6.1.1.1.3.3" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.3.3.cmml"><mi id="Pt0.A1.SS1.p1.6.m6.1.1.1.3.3.2" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.3.3.2.cmml">b</mi><mi id="Pt0.A1.SS1.p1.6.m6.1.1.1.3.3.3" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.3.3.3.cmml">t</mi></msub></mrow><mo id="Pt0.A1.SS1.p1.6.m6.1.1.1.2" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.2.cmml">+</mo><mrow id="Pt0.A1.SS1.p1.6.m6.1.1.1.1" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.1.cmml"><mrow id="Pt0.A1.SS1.p1.6.m6.1.1.1.1.1.1" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Pt0.A1.SS1.p1.6.m6.1.1.1.1.1.1.2" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Pt0.A1.SS1.p1.6.m6.1.1.1.1.1.1.1" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.1.1.1.1.cmml"><mn id="Pt0.A1.SS1.p1.6.m6.1.1.1.1.1.1.1.2" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="Pt0.A1.SS1.p1.6.m6.1.1.1.1.1.1.1.1" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="Pt0.A1.SS1.p1.6.m6.1.1.1.1.1.1.1.3" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.1.1.1.1.3.cmml">λ</mi></mrow><mo stretchy="false" id="Pt0.A1.SS1.p1.6.m6.1.1.1.1.1.1.3" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="Pt0.A1.SS1.p1.6.m6.1.1.1.1.2" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.1.2.cmml">​</mo><msub id="Pt0.A1.SS1.p1.6.m6.1.1.1.1.3" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.1.3.cmml"><mi id="Pt0.A1.SS1.p1.6.m6.1.1.1.1.3.2" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.1.3.2.cmml">r</mi><mi id="Pt0.A1.SS1.p1.6.m6.1.1.1.1.3.3" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.1.3.3.cmml">t</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS1.p1.6.m6.1b"><apply id="Pt0.A1.SS1.p1.6.m6.1.1.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1"><eq id="Pt0.A1.SS1.p1.6.m6.1.1.2.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1.2"></eq><apply id="Pt0.A1.SS1.p1.6.m6.1.1.3.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="Pt0.A1.SS1.p1.6.m6.1.1.3.1.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1.3">subscript</csymbol><ci id="Pt0.A1.SS1.p1.6.m6.1.1.3.2.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1.3.2">𝑏</ci><apply id="Pt0.A1.SS1.p1.6.m6.1.1.3.3.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1.3.3"><plus id="Pt0.A1.SS1.p1.6.m6.1.1.3.3.1.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1.3.3.1"></plus><ci id="Pt0.A1.SS1.p1.6.m6.1.1.3.3.2.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1.3.3.2">𝑡</ci><cn type="integer" id="Pt0.A1.SS1.p1.6.m6.1.1.3.3.3.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1.3.3.3">1</cn></apply></apply><apply id="Pt0.A1.SS1.p1.6.m6.1.1.1.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1.1"><plus id="Pt0.A1.SS1.p1.6.m6.1.1.1.2.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.2"></plus><apply id="Pt0.A1.SS1.p1.6.m6.1.1.1.3.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.3"><times id="Pt0.A1.SS1.p1.6.m6.1.1.1.3.1.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.3.1"></times><ci id="Pt0.A1.SS1.p1.6.m6.1.1.1.3.2.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.3.2">𝜆</ci><apply id="Pt0.A1.SS1.p1.6.m6.1.1.1.3.3.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.3.3"><csymbol cd="ambiguous" id="Pt0.A1.SS1.p1.6.m6.1.1.1.3.3.1.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.3.3">subscript</csymbol><ci id="Pt0.A1.SS1.p1.6.m6.1.1.1.3.3.2.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.3.3.2">𝑏</ci><ci id="Pt0.A1.SS1.p1.6.m6.1.1.1.3.3.3.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.3.3.3">𝑡</ci></apply></apply><apply id="Pt0.A1.SS1.p1.6.m6.1.1.1.1.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.1"><times id="Pt0.A1.SS1.p1.6.m6.1.1.1.1.2.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.1.2"></times><apply id="Pt0.A1.SS1.p1.6.m6.1.1.1.1.1.1.1.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.1.1.1"><minus id="Pt0.A1.SS1.p1.6.m6.1.1.1.1.1.1.1.1.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="Pt0.A1.SS1.p1.6.m6.1.1.1.1.1.1.1.2.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.1.1.1.1.2">1</cn><ci id="Pt0.A1.SS1.p1.6.m6.1.1.1.1.1.1.1.3.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.1.1.1.1.3">𝜆</ci></apply><apply id="Pt0.A1.SS1.p1.6.m6.1.1.1.1.3.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.1.3"><csymbol cd="ambiguous" id="Pt0.A1.SS1.p1.6.m6.1.1.1.1.3.1.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.1.3">subscript</csymbol><ci id="Pt0.A1.SS1.p1.6.m6.1.1.1.1.3.2.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.1.3.2">𝑟</ci><ci id="Pt0.A1.SS1.p1.6.m6.1.1.1.1.3.3.cmml" xref="Pt0.A1.SS1.p1.6.m6.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS1.p1.6.m6.1c">b_{t+1}=\lambda b_{t}+(1-\lambda)r_{t}</annotation></semantics></math> at each optimization step. Another technique
that affects the training speed is the reward normalization. Concretely, the
accumulated rewards at each time step for each rollout are collected and
normalized after subtraction of the baseline value.</p>
</div>
<div id="Pt0.A1.SS1.p2" class="ltx_para">
<p id="Pt0.A1.SS1.p2.4" class="ltx_p">We introduce a regularization term on the entropy of the resulting probability
distribution from the policy network <math id="Pt0.A1.SS1.p2.1.m1.1" class="ltx_Math" alttext="\pi_{\theta}(A_{t}|S_{t})" display="inline"><semantics id="Pt0.A1.SS1.p2.1.m1.1a"><mrow id="Pt0.A1.SS1.p2.1.m1.1.1" xref="Pt0.A1.SS1.p2.1.m1.1.1.cmml"><msub id="Pt0.A1.SS1.p2.1.m1.1.1.3" xref="Pt0.A1.SS1.p2.1.m1.1.1.3.cmml"><mi id="Pt0.A1.SS1.p2.1.m1.1.1.3.2" xref="Pt0.A1.SS1.p2.1.m1.1.1.3.2.cmml">π</mi><mi id="Pt0.A1.SS1.p2.1.m1.1.1.3.3" xref="Pt0.A1.SS1.p2.1.m1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="Pt0.A1.SS1.p2.1.m1.1.1.2" xref="Pt0.A1.SS1.p2.1.m1.1.1.2.cmml">​</mo><mrow id="Pt0.A1.SS1.p2.1.m1.1.1.1.1" xref="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="Pt0.A1.SS1.p2.1.m1.1.1.1.1.2" xref="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1" xref="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.cmml"><msub id="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.2" xref="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.2.cmml"><mi id="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.2.2" xref="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.2.2.cmml">A</mi><mi id="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.2.3" xref="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.1" xref="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.1.cmml">|</mo><msub id="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.3" xref="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.3.cmml"><mi id="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.3.2" xref="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.3.2.cmml">S</mi><mi id="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.3.3" xref="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="Pt0.A1.SS1.p2.1.m1.1.1.1.1.3" xref="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS1.p2.1.m1.1b"><apply id="Pt0.A1.SS1.p2.1.m1.1.1.cmml" xref="Pt0.A1.SS1.p2.1.m1.1.1"><times id="Pt0.A1.SS1.p2.1.m1.1.1.2.cmml" xref="Pt0.A1.SS1.p2.1.m1.1.1.2"></times><apply id="Pt0.A1.SS1.p2.1.m1.1.1.3.cmml" xref="Pt0.A1.SS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="Pt0.A1.SS1.p2.1.m1.1.1.3.1.cmml" xref="Pt0.A1.SS1.p2.1.m1.1.1.3">subscript</csymbol><ci id="Pt0.A1.SS1.p2.1.m1.1.1.3.2.cmml" xref="Pt0.A1.SS1.p2.1.m1.1.1.3.2">𝜋</ci><ci id="Pt0.A1.SS1.p2.1.m1.1.1.3.3.cmml" xref="Pt0.A1.SS1.p2.1.m1.1.1.3.3">𝜃</ci></apply><apply id="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.cmml" xref="Pt0.A1.SS1.p2.1.m1.1.1.1.1"><csymbol cd="latexml" id="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.1.cmml" xref="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.1">conditional</csymbol><apply id="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.2.cmml" xref="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.2.1.cmml" xref="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.2.2.cmml" xref="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.2.2">𝐴</ci><ci id="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.2.3.cmml" xref="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.3.cmml" xref="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.3.1.cmml" xref="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.3.2.cmml" xref="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.3.2">𝑆</ci><ci id="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.3.3.cmml" xref="Pt0.A1.SS1.p2.1.m1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS1.p2.1.m1.1c">\pi_{\theta}(A_{t}|S_{t})</annotation></semantics></math>, which
enforces that the agent explores the SG. The regularization is controlled by a
hyperparameter <math id="Pt0.A1.SS1.p2.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="Pt0.A1.SS1.p2.2.m2.1a"><mi id="Pt0.A1.SS1.p2.2.m2.1.1" xref="Pt0.A1.SS1.p2.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS1.p2.2.m2.1b"><ci id="Pt0.A1.SS1.p2.2.m2.1.1.cmml" xref="Pt0.A1.SS1.p2.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS1.p2.2.m2.1c">\beta</annotation></semantics></math>. In addition, we apply exponential decay to <math id="Pt0.A1.SS1.p2.3.m3.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="Pt0.A1.SS1.p2.3.m3.1a"><mi id="Pt0.A1.SS1.p2.3.m3.1.1" xref="Pt0.A1.SS1.p2.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS1.p2.3.m3.1b"><ci id="Pt0.A1.SS1.p2.3.m3.1.1.cmml" xref="Pt0.A1.SS1.p2.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS1.p2.3.m3.1c">\beta</annotation></semantics></math> during
training so that <math id="Pt0.A1.SS1.p2.4.m4.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="Pt0.A1.SS1.p2.4.m4.1a"><mi id="Pt0.A1.SS1.p2.4.m4.1.1" xref="Pt0.A1.SS1.p2.4.m4.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS1.p2.4.m4.1b"><ci id="Pt0.A1.SS1.p2.4.m4.1.1.cmml" xref="Pt0.A1.SS1.p2.4.m4.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS1.p2.4.m4.1c">\beta</annotation></semantics></math> converges to zero.</p>
</div>
<div id="Pt0.A1.SS1.p3" class="ltx_para">
<p id="Pt0.A1.SS1.p3.3" class="ltx_p">Moreover, we use the chain rule to calculate the gradients of the parameters of the graph encoder
(GAT) <math id="Pt0.A1.SS1.p3.1.m1.1" class="ltx_Math" alttext="\theta_{GAT}" display="inline"><semantics id="Pt0.A1.SS1.p3.1.m1.1a"><msub id="Pt0.A1.SS1.p3.1.m1.1.1" xref="Pt0.A1.SS1.p3.1.m1.1.1.cmml"><mi id="Pt0.A1.SS1.p3.1.m1.1.1.2" xref="Pt0.A1.SS1.p3.1.m1.1.1.2.cmml">θ</mi><mrow id="Pt0.A1.SS1.p3.1.m1.1.1.3" xref="Pt0.A1.SS1.p3.1.m1.1.1.3.cmml"><mi id="Pt0.A1.SS1.p3.1.m1.1.1.3.2" xref="Pt0.A1.SS1.p3.1.m1.1.1.3.2.cmml">G</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.SS1.p3.1.m1.1.1.3.1" xref="Pt0.A1.SS1.p3.1.m1.1.1.3.1.cmml">​</mo><mi id="Pt0.A1.SS1.p3.1.m1.1.1.3.3" xref="Pt0.A1.SS1.p3.1.m1.1.1.3.3.cmml">A</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.SS1.p3.1.m1.1.1.3.1a" xref="Pt0.A1.SS1.p3.1.m1.1.1.3.1.cmml">​</mo><mi id="Pt0.A1.SS1.p3.1.m1.1.1.3.4" xref="Pt0.A1.SS1.p3.1.m1.1.1.3.4.cmml">T</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS1.p3.1.m1.1b"><apply id="Pt0.A1.SS1.p3.1.m1.1.1.cmml" xref="Pt0.A1.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="Pt0.A1.SS1.p3.1.m1.1.1.1.cmml" xref="Pt0.A1.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="Pt0.A1.SS1.p3.1.m1.1.1.2.cmml" xref="Pt0.A1.SS1.p3.1.m1.1.1.2">𝜃</ci><apply id="Pt0.A1.SS1.p3.1.m1.1.1.3.cmml" xref="Pt0.A1.SS1.p3.1.m1.1.1.3"><times id="Pt0.A1.SS1.p3.1.m1.1.1.3.1.cmml" xref="Pt0.A1.SS1.p3.1.m1.1.1.3.1"></times><ci id="Pt0.A1.SS1.p3.1.m1.1.1.3.2.cmml" xref="Pt0.A1.SS1.p3.1.m1.1.1.3.2">𝐺</ci><ci id="Pt0.A1.SS1.p3.1.m1.1.1.3.3.cmml" xref="Pt0.A1.SS1.p3.1.m1.1.1.3.3">𝐴</ci><ci id="Pt0.A1.SS1.p3.1.m1.1.1.3.4.cmml" xref="Pt0.A1.SS1.p3.1.m1.1.1.3.4">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS1.p3.1.m1.1c">\theta_{GAT}</annotation></semantics></math> and the question encoder (Transformer)
<math id="Pt0.A1.SS1.p3.2.m2.1" class="ltx_Math" alttext="\theta_{Transformer}" display="inline"><semantics id="Pt0.A1.SS1.p3.2.m2.1a"><msub id="Pt0.A1.SS1.p3.2.m2.1.1" xref="Pt0.A1.SS1.p3.2.m2.1.1.cmml"><mi id="Pt0.A1.SS1.p3.2.m2.1.1.2" xref="Pt0.A1.SS1.p3.2.m2.1.1.2.cmml">θ</mi><mrow id="Pt0.A1.SS1.p3.2.m2.1.1.3" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.cmml"><mi id="Pt0.A1.SS1.p3.2.m2.1.1.3.2" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.SS1.p3.2.m2.1.1.3.1" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="Pt0.A1.SS1.p3.2.m2.1.1.3.3" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.SS1.p3.2.m2.1.1.3.1a" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="Pt0.A1.SS1.p3.2.m2.1.1.3.4" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.SS1.p3.2.m2.1.1.3.1b" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="Pt0.A1.SS1.p3.2.m2.1.1.3.5" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.SS1.p3.2.m2.1.1.3.1c" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="Pt0.A1.SS1.p3.2.m2.1.1.3.6" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.SS1.p3.2.m2.1.1.3.1d" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="Pt0.A1.SS1.p3.2.m2.1.1.3.7" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.7.cmml">f</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.SS1.p3.2.m2.1.1.3.1e" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="Pt0.A1.SS1.p3.2.m2.1.1.3.8" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.8.cmml">o</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.SS1.p3.2.m2.1.1.3.1f" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="Pt0.A1.SS1.p3.2.m2.1.1.3.9" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.9.cmml">r</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.SS1.p3.2.m2.1.1.3.1g" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="Pt0.A1.SS1.p3.2.m2.1.1.3.10" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.10.cmml">m</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.SS1.p3.2.m2.1.1.3.1h" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="Pt0.A1.SS1.p3.2.m2.1.1.3.11" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.11.cmml">e</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.SS1.p3.2.m2.1.1.3.1i" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="Pt0.A1.SS1.p3.2.m2.1.1.3.12" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.12.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS1.p3.2.m2.1b"><apply id="Pt0.A1.SS1.p3.2.m2.1.1.cmml" xref="Pt0.A1.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="Pt0.A1.SS1.p3.2.m2.1.1.1.cmml" xref="Pt0.A1.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="Pt0.A1.SS1.p3.2.m2.1.1.2.cmml" xref="Pt0.A1.SS1.p3.2.m2.1.1.2">𝜃</ci><apply id="Pt0.A1.SS1.p3.2.m2.1.1.3.cmml" xref="Pt0.A1.SS1.p3.2.m2.1.1.3"><times id="Pt0.A1.SS1.p3.2.m2.1.1.3.1.cmml" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.1"></times><ci id="Pt0.A1.SS1.p3.2.m2.1.1.3.2.cmml" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.2">𝑇</ci><ci id="Pt0.A1.SS1.p3.2.m2.1.1.3.3.cmml" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.3">𝑟</ci><ci id="Pt0.A1.SS1.p3.2.m2.1.1.3.4.cmml" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.4">𝑎</ci><ci id="Pt0.A1.SS1.p3.2.m2.1.1.3.5.cmml" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.5">𝑛</ci><ci id="Pt0.A1.SS1.p3.2.m2.1.1.3.6.cmml" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.6">𝑠</ci><ci id="Pt0.A1.SS1.p3.2.m2.1.1.3.7.cmml" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.7">𝑓</ci><ci id="Pt0.A1.SS1.p3.2.m2.1.1.3.8.cmml" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.8">𝑜</ci><ci id="Pt0.A1.SS1.p3.2.m2.1.1.3.9.cmml" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.9">𝑟</ci><ci id="Pt0.A1.SS1.p3.2.m2.1.1.3.10.cmml" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.10">𝑚</ci><ci id="Pt0.A1.SS1.p3.2.m2.1.1.3.11.cmml" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.11">𝑒</ci><ci id="Pt0.A1.SS1.p3.2.m2.1.1.3.12.cmml" xref="Pt0.A1.SS1.p3.2.m2.1.1.3.12">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS1.p3.2.m2.1c">\theta_{Transformer}</annotation></semantics></math>. The weight updates can be performed via gradient ascent,
<math id="Pt0.A1.SS1.p3.3.m3.1" class="ltx_Math" alttext="\theta\leftarrow\theta+\eta\hat{g}" display="inline"><semantics id="Pt0.A1.SS1.p3.3.m3.1a"><mrow id="Pt0.A1.SS1.p3.3.m3.1.1" xref="Pt0.A1.SS1.p3.3.m3.1.1.cmml"><mi id="Pt0.A1.SS1.p3.3.m3.1.1.2" xref="Pt0.A1.SS1.p3.3.m3.1.1.2.cmml">θ</mi><mo stretchy="false" id="Pt0.A1.SS1.p3.3.m3.1.1.1" xref="Pt0.A1.SS1.p3.3.m3.1.1.1.cmml">←</mo><mrow id="Pt0.A1.SS1.p3.3.m3.1.1.3" xref="Pt0.A1.SS1.p3.3.m3.1.1.3.cmml"><mi id="Pt0.A1.SS1.p3.3.m3.1.1.3.2" xref="Pt0.A1.SS1.p3.3.m3.1.1.3.2.cmml">θ</mi><mo id="Pt0.A1.SS1.p3.3.m3.1.1.3.1" xref="Pt0.A1.SS1.p3.3.m3.1.1.3.1.cmml">+</mo><mrow id="Pt0.A1.SS1.p3.3.m3.1.1.3.3" xref="Pt0.A1.SS1.p3.3.m3.1.1.3.3.cmml"><mi id="Pt0.A1.SS1.p3.3.m3.1.1.3.3.2" xref="Pt0.A1.SS1.p3.3.m3.1.1.3.3.2.cmml">η</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.SS1.p3.3.m3.1.1.3.3.1" xref="Pt0.A1.SS1.p3.3.m3.1.1.3.3.1.cmml">​</mo><mover accent="true" id="Pt0.A1.SS1.p3.3.m3.1.1.3.3.3" xref="Pt0.A1.SS1.p3.3.m3.1.1.3.3.3.cmml"><mi id="Pt0.A1.SS1.p3.3.m3.1.1.3.3.3.2" xref="Pt0.A1.SS1.p3.3.m3.1.1.3.3.3.2.cmml">g</mi><mo id="Pt0.A1.SS1.p3.3.m3.1.1.3.3.3.1" xref="Pt0.A1.SS1.p3.3.m3.1.1.3.3.3.1.cmml">^</mo></mover></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS1.p3.3.m3.1b"><apply id="Pt0.A1.SS1.p3.3.m3.1.1.cmml" xref="Pt0.A1.SS1.p3.3.m3.1.1"><ci id="Pt0.A1.SS1.p3.3.m3.1.1.1.cmml" xref="Pt0.A1.SS1.p3.3.m3.1.1.1">←</ci><ci id="Pt0.A1.SS1.p3.3.m3.1.1.2.cmml" xref="Pt0.A1.SS1.p3.3.m3.1.1.2">𝜃</ci><apply id="Pt0.A1.SS1.p3.3.m3.1.1.3.cmml" xref="Pt0.A1.SS1.p3.3.m3.1.1.3"><plus id="Pt0.A1.SS1.p3.3.m3.1.1.3.1.cmml" xref="Pt0.A1.SS1.p3.3.m3.1.1.3.1"></plus><ci id="Pt0.A1.SS1.p3.3.m3.1.1.3.2.cmml" xref="Pt0.A1.SS1.p3.3.m3.1.1.3.2">𝜃</ci><apply id="Pt0.A1.SS1.p3.3.m3.1.1.3.3.cmml" xref="Pt0.A1.SS1.p3.3.m3.1.1.3.3"><times id="Pt0.A1.SS1.p3.3.m3.1.1.3.3.1.cmml" xref="Pt0.A1.SS1.p3.3.m3.1.1.3.3.1"></times><ci id="Pt0.A1.SS1.p3.3.m3.1.1.3.3.2.cmml" xref="Pt0.A1.SS1.p3.3.m3.1.1.3.3.2">𝜂</ci><apply id="Pt0.A1.SS1.p3.3.m3.1.1.3.3.3.cmml" xref="Pt0.A1.SS1.p3.3.m3.1.1.3.3.3"><ci id="Pt0.A1.SS1.p3.3.m3.1.1.3.3.3.1.cmml" xref="Pt0.A1.SS1.p3.3.m3.1.1.3.3.3.1">^</ci><ci id="Pt0.A1.SS1.p3.3.m3.1.1.3.3.3.2.cmml" xref="Pt0.A1.SS1.p3.3.m3.1.1.3.3.3.2">𝑔</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS1.p3.3.m3.1c">\theta\leftarrow\theta+\eta\hat{g}</annotation></semantics></math> or more advanced optimization methods
such as Adam <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>.</p>
</div>
<figure id="algorithm1" class="ltx_float ltx_algorithm">
<div id="algorithm1.34" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="algorithm1.2.2" class="ltx_listingline">
<span id="algorithm1.2.2.1" class="ltx_text"><span id="algorithm1.2.2.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>Question <math id="algorithm1.1.1.m1.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="algorithm1.1.1.m1.1a"><mi id="algorithm1.1.1.m1.1.1" xref="algorithm1.1.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.m1.1b"><ci id="algorithm1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.m1.1c">Q</annotation></semantics></math>, Scene Graph <math id="algorithm1.2.2.m2.1" class="ltx_Math" alttext="\mathcal{SG}\subset\mathcal{E}\times\mathcal{R}\times\mathcal{E}" display="inline"><semantics id="algorithm1.2.2.m2.1a"><mrow id="algorithm1.2.2.m2.1.1" xref="algorithm1.2.2.m2.1.1.cmml"><mrow id="algorithm1.2.2.m2.1.1.2" xref="algorithm1.2.2.m2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.2.2.m2.1.1.2.2" xref="algorithm1.2.2.m2.1.1.2.2.cmml">𝒮</mi><mo lspace="0em" rspace="0em" id="algorithm1.2.2.m2.1.1.2.1" xref="algorithm1.2.2.m2.1.1.2.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="algorithm1.2.2.m2.1.1.2.3" xref="algorithm1.2.2.m2.1.1.2.3.cmml">𝒢</mi></mrow><mo id="algorithm1.2.2.m2.1.1.1" xref="algorithm1.2.2.m2.1.1.1.cmml">⊂</mo><mrow id="algorithm1.2.2.m2.1.1.3" xref="algorithm1.2.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.2.2.m2.1.1.3.2" xref="algorithm1.2.2.m2.1.1.3.2.cmml">ℰ</mi><mo lspace="0.222em" rspace="0.222em" id="algorithm1.2.2.m2.1.1.3.1" xref="algorithm1.2.2.m2.1.1.3.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="algorithm1.2.2.m2.1.1.3.3" xref="algorithm1.2.2.m2.1.1.3.3.cmml">ℛ</mi><mo lspace="0.222em" rspace="0.222em" id="algorithm1.2.2.m2.1.1.3.1a" xref="algorithm1.2.2.m2.1.1.3.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="algorithm1.2.2.m2.1.1.3.4" xref="algorithm1.2.2.m2.1.1.3.4.cmml">ℰ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.m2.1b"><apply id="algorithm1.2.2.m2.1.1.cmml" xref="algorithm1.2.2.m2.1.1"><subset id="algorithm1.2.2.m2.1.1.1.cmml" xref="algorithm1.2.2.m2.1.1.1"></subset><apply id="algorithm1.2.2.m2.1.1.2.cmml" xref="algorithm1.2.2.m2.1.1.2"><times id="algorithm1.2.2.m2.1.1.2.1.cmml" xref="algorithm1.2.2.m2.1.1.2.1"></times><ci id="algorithm1.2.2.m2.1.1.2.2.cmml" xref="algorithm1.2.2.m2.1.1.2.2">𝒮</ci><ci id="algorithm1.2.2.m2.1.1.2.3.cmml" xref="algorithm1.2.2.m2.1.1.2.3">𝒢</ci></apply><apply id="algorithm1.2.2.m2.1.1.3.cmml" xref="algorithm1.2.2.m2.1.1.3"><times id="algorithm1.2.2.m2.1.1.3.1.cmml" xref="algorithm1.2.2.m2.1.1.3.1"></times><ci id="algorithm1.2.2.m2.1.1.3.2.cmml" xref="algorithm1.2.2.m2.1.1.3.2">ℰ</ci><ci id="algorithm1.2.2.m2.1.1.3.3.cmml" xref="algorithm1.2.2.m2.1.1.3.3">ℛ</ci><ci id="algorithm1.2.2.m2.1.1.3.4.cmml" xref="algorithm1.2.2.m2.1.1.3.4">ℰ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.m2.1c">\mathcal{SG}\subset\mathcal{E}\times\mathcal{R}\times\mathcal{E}</annotation></semantics></math>
</div>
<div id="algorithm1.4.4" class="ltx_listingline">
<span id="algorithm1.4.4.1" class="ltx_text ltx_font_bold">Model :</span>  Policy Network with <math id="algorithm1.3.3.m1.3" class="ltx_Math" alttext="\theta:=\{\theta_{GAT},\theta_{Transformer},\theta_{Agent}\}" display="inline"><semantics id="algorithm1.3.3.m1.3a"><mrow id="algorithm1.3.3.m1.3.3" xref="algorithm1.3.3.m1.3.3.cmml"><mi id="algorithm1.3.3.m1.3.3.5" xref="algorithm1.3.3.m1.3.3.5.cmml">θ</mi><mo lspace="0.278em" rspace="0.278em" id="algorithm1.3.3.m1.3.3.4" xref="algorithm1.3.3.m1.3.3.4.cmml">:=</mo><mrow id="algorithm1.3.3.m1.3.3.3.3" xref="algorithm1.3.3.m1.3.3.3.4.cmml"><mo stretchy="false" id="algorithm1.3.3.m1.3.3.3.3.4" xref="algorithm1.3.3.m1.3.3.3.4.cmml">{</mo><msub id="algorithm1.3.3.m1.1.1.1.1.1" xref="algorithm1.3.3.m1.1.1.1.1.1.cmml"><mi id="algorithm1.3.3.m1.1.1.1.1.1.2" xref="algorithm1.3.3.m1.1.1.1.1.1.2.cmml">θ</mi><mrow id="algorithm1.3.3.m1.1.1.1.1.1.3" xref="algorithm1.3.3.m1.1.1.1.1.1.3.cmml"><mi id="algorithm1.3.3.m1.1.1.1.1.1.3.2" xref="algorithm1.3.3.m1.1.1.1.1.1.3.2.cmml">G</mi><mo lspace="0em" rspace="0em" id="algorithm1.3.3.m1.1.1.1.1.1.3.1" xref="algorithm1.3.3.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.3.3.m1.1.1.1.1.1.3.3" xref="algorithm1.3.3.m1.1.1.1.1.1.3.3.cmml">A</mi><mo lspace="0em" rspace="0em" id="algorithm1.3.3.m1.1.1.1.1.1.3.1a" xref="algorithm1.3.3.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.3.3.m1.1.1.1.1.1.3.4" xref="algorithm1.3.3.m1.1.1.1.1.1.3.4.cmml">T</mi></mrow></msub><mo id="algorithm1.3.3.m1.3.3.3.3.5" xref="algorithm1.3.3.m1.3.3.3.4.cmml">,</mo><msub id="algorithm1.3.3.m1.2.2.2.2.2" xref="algorithm1.3.3.m1.2.2.2.2.2.cmml"><mi id="algorithm1.3.3.m1.2.2.2.2.2.2" xref="algorithm1.3.3.m1.2.2.2.2.2.2.cmml">θ</mi><mrow id="algorithm1.3.3.m1.2.2.2.2.2.3" xref="algorithm1.3.3.m1.2.2.2.2.2.3.cmml"><mi id="algorithm1.3.3.m1.2.2.2.2.2.3.2" xref="algorithm1.3.3.m1.2.2.2.2.2.3.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="algorithm1.3.3.m1.2.2.2.2.2.3.1" xref="algorithm1.3.3.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="algorithm1.3.3.m1.2.2.2.2.2.3.3" xref="algorithm1.3.3.m1.2.2.2.2.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="algorithm1.3.3.m1.2.2.2.2.2.3.1a" xref="algorithm1.3.3.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="algorithm1.3.3.m1.2.2.2.2.2.3.4" xref="algorithm1.3.3.m1.2.2.2.2.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.3.3.m1.2.2.2.2.2.3.1b" xref="algorithm1.3.3.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="algorithm1.3.3.m1.2.2.2.2.2.3.5" xref="algorithm1.3.3.m1.2.2.2.2.2.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="algorithm1.3.3.m1.2.2.2.2.2.3.1c" xref="algorithm1.3.3.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="algorithm1.3.3.m1.2.2.2.2.2.3.6" xref="algorithm1.3.3.m1.2.2.2.2.2.3.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="algorithm1.3.3.m1.2.2.2.2.2.3.1d" xref="algorithm1.3.3.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="algorithm1.3.3.m1.2.2.2.2.2.3.7" xref="algorithm1.3.3.m1.2.2.2.2.2.3.7.cmml">f</mi><mo lspace="0em" rspace="0em" id="algorithm1.3.3.m1.2.2.2.2.2.3.1e" xref="algorithm1.3.3.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="algorithm1.3.3.m1.2.2.2.2.2.3.8" xref="algorithm1.3.3.m1.2.2.2.2.2.3.8.cmml">o</mi><mo lspace="0em" rspace="0em" id="algorithm1.3.3.m1.2.2.2.2.2.3.1f" xref="algorithm1.3.3.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="algorithm1.3.3.m1.2.2.2.2.2.3.9" xref="algorithm1.3.3.m1.2.2.2.2.2.3.9.cmml">r</mi><mo lspace="0em" rspace="0em" id="algorithm1.3.3.m1.2.2.2.2.2.3.1g" xref="algorithm1.3.3.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="algorithm1.3.3.m1.2.2.2.2.2.3.10" xref="algorithm1.3.3.m1.2.2.2.2.2.3.10.cmml">m</mi><mo lspace="0em" rspace="0em" id="algorithm1.3.3.m1.2.2.2.2.2.3.1h" xref="algorithm1.3.3.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="algorithm1.3.3.m1.2.2.2.2.2.3.11" xref="algorithm1.3.3.m1.2.2.2.2.2.3.11.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm1.3.3.m1.2.2.2.2.2.3.1i" xref="algorithm1.3.3.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="algorithm1.3.3.m1.2.2.2.2.2.3.12" xref="algorithm1.3.3.m1.2.2.2.2.2.3.12.cmml">r</mi></mrow></msub><mo id="algorithm1.3.3.m1.3.3.3.3.6" xref="algorithm1.3.3.m1.3.3.3.4.cmml">,</mo><msub id="algorithm1.3.3.m1.3.3.3.3.3" xref="algorithm1.3.3.m1.3.3.3.3.3.cmml"><mi id="algorithm1.3.3.m1.3.3.3.3.3.2" xref="algorithm1.3.3.m1.3.3.3.3.3.2.cmml">θ</mi><mrow id="algorithm1.3.3.m1.3.3.3.3.3.3" xref="algorithm1.3.3.m1.3.3.3.3.3.3.cmml"><mi id="algorithm1.3.3.m1.3.3.3.3.3.3.2" xref="algorithm1.3.3.m1.3.3.3.3.3.3.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="algorithm1.3.3.m1.3.3.3.3.3.3.1" xref="algorithm1.3.3.m1.3.3.3.3.3.3.1.cmml">​</mo><mi id="algorithm1.3.3.m1.3.3.3.3.3.3.3" xref="algorithm1.3.3.m1.3.3.3.3.3.3.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="algorithm1.3.3.m1.3.3.3.3.3.3.1a" xref="algorithm1.3.3.m1.3.3.3.3.3.3.1.cmml">​</mo><mi id="algorithm1.3.3.m1.3.3.3.3.3.3.4" xref="algorithm1.3.3.m1.3.3.3.3.3.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm1.3.3.m1.3.3.3.3.3.3.1b" xref="algorithm1.3.3.m1.3.3.3.3.3.3.1.cmml">​</mo><mi id="algorithm1.3.3.m1.3.3.3.3.3.3.5" xref="algorithm1.3.3.m1.3.3.3.3.3.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="algorithm1.3.3.m1.3.3.3.3.3.3.1c" xref="algorithm1.3.3.m1.3.3.3.3.3.3.1.cmml">​</mo><mi id="algorithm1.3.3.m1.3.3.3.3.3.3.6" xref="algorithm1.3.3.m1.3.3.3.3.3.3.6.cmml">t</mi></mrow></msub><mo stretchy="false" id="algorithm1.3.3.m1.3.3.3.3.7" xref="algorithm1.3.3.m1.3.3.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.m1.3b"><apply id="algorithm1.3.3.m1.3.3.cmml" xref="algorithm1.3.3.m1.3.3"><csymbol cd="latexml" id="algorithm1.3.3.m1.3.3.4.cmml" xref="algorithm1.3.3.m1.3.3.4">assign</csymbol><ci id="algorithm1.3.3.m1.3.3.5.cmml" xref="algorithm1.3.3.m1.3.3.5">𝜃</ci><set id="algorithm1.3.3.m1.3.3.3.4.cmml" xref="algorithm1.3.3.m1.3.3.3.3"><apply id="algorithm1.3.3.m1.1.1.1.1.1.cmml" xref="algorithm1.3.3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.3.3.m1.1.1.1.1.1.1.cmml" xref="algorithm1.3.3.m1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.3.3.m1.1.1.1.1.1.2.cmml" xref="algorithm1.3.3.m1.1.1.1.1.1.2">𝜃</ci><apply id="algorithm1.3.3.m1.1.1.1.1.1.3.cmml" xref="algorithm1.3.3.m1.1.1.1.1.1.3"><times id="algorithm1.3.3.m1.1.1.1.1.1.3.1.cmml" xref="algorithm1.3.3.m1.1.1.1.1.1.3.1"></times><ci id="algorithm1.3.3.m1.1.1.1.1.1.3.2.cmml" xref="algorithm1.3.3.m1.1.1.1.1.1.3.2">𝐺</ci><ci id="algorithm1.3.3.m1.1.1.1.1.1.3.3.cmml" xref="algorithm1.3.3.m1.1.1.1.1.1.3.3">𝐴</ci><ci id="algorithm1.3.3.m1.1.1.1.1.1.3.4.cmml" xref="algorithm1.3.3.m1.1.1.1.1.1.3.4">𝑇</ci></apply></apply><apply id="algorithm1.3.3.m1.2.2.2.2.2.cmml" xref="algorithm1.3.3.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.3.3.m1.2.2.2.2.2.1.cmml" xref="algorithm1.3.3.m1.2.2.2.2.2">subscript</csymbol><ci id="algorithm1.3.3.m1.2.2.2.2.2.2.cmml" xref="algorithm1.3.3.m1.2.2.2.2.2.2">𝜃</ci><apply id="algorithm1.3.3.m1.2.2.2.2.2.3.cmml" xref="algorithm1.3.3.m1.2.2.2.2.2.3"><times id="algorithm1.3.3.m1.2.2.2.2.2.3.1.cmml" xref="algorithm1.3.3.m1.2.2.2.2.2.3.1"></times><ci id="algorithm1.3.3.m1.2.2.2.2.2.3.2.cmml" xref="algorithm1.3.3.m1.2.2.2.2.2.3.2">𝑇</ci><ci id="algorithm1.3.3.m1.2.2.2.2.2.3.3.cmml" xref="algorithm1.3.3.m1.2.2.2.2.2.3.3">𝑟</ci><ci id="algorithm1.3.3.m1.2.2.2.2.2.3.4.cmml" xref="algorithm1.3.3.m1.2.2.2.2.2.3.4">𝑎</ci><ci id="algorithm1.3.3.m1.2.2.2.2.2.3.5.cmml" xref="algorithm1.3.3.m1.2.2.2.2.2.3.5">𝑛</ci><ci id="algorithm1.3.3.m1.2.2.2.2.2.3.6.cmml" xref="algorithm1.3.3.m1.2.2.2.2.2.3.6">𝑠</ci><ci id="algorithm1.3.3.m1.2.2.2.2.2.3.7.cmml" xref="algorithm1.3.3.m1.2.2.2.2.2.3.7">𝑓</ci><ci id="algorithm1.3.3.m1.2.2.2.2.2.3.8.cmml" xref="algorithm1.3.3.m1.2.2.2.2.2.3.8">𝑜</ci><ci id="algorithm1.3.3.m1.2.2.2.2.2.3.9.cmml" xref="algorithm1.3.3.m1.2.2.2.2.2.3.9">𝑟</ci><ci id="algorithm1.3.3.m1.2.2.2.2.2.3.10.cmml" xref="algorithm1.3.3.m1.2.2.2.2.2.3.10">𝑚</ci><ci id="algorithm1.3.3.m1.2.2.2.2.2.3.11.cmml" xref="algorithm1.3.3.m1.2.2.2.2.2.3.11">𝑒</ci><ci id="algorithm1.3.3.m1.2.2.2.2.2.3.12.cmml" xref="algorithm1.3.3.m1.2.2.2.2.2.3.12">𝑟</ci></apply></apply><apply id="algorithm1.3.3.m1.3.3.3.3.3.cmml" xref="algorithm1.3.3.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="algorithm1.3.3.m1.3.3.3.3.3.1.cmml" xref="algorithm1.3.3.m1.3.3.3.3.3">subscript</csymbol><ci id="algorithm1.3.3.m1.3.3.3.3.3.2.cmml" xref="algorithm1.3.3.m1.3.3.3.3.3.2">𝜃</ci><apply id="algorithm1.3.3.m1.3.3.3.3.3.3.cmml" xref="algorithm1.3.3.m1.3.3.3.3.3.3"><times id="algorithm1.3.3.m1.3.3.3.3.3.3.1.cmml" xref="algorithm1.3.3.m1.3.3.3.3.3.3.1"></times><ci id="algorithm1.3.3.m1.3.3.3.3.3.3.2.cmml" xref="algorithm1.3.3.m1.3.3.3.3.3.3.2">𝐴</ci><ci id="algorithm1.3.3.m1.3.3.3.3.3.3.3.cmml" xref="algorithm1.3.3.m1.3.3.3.3.3.3.3">𝑔</ci><ci id="algorithm1.3.3.m1.3.3.3.3.3.3.4.cmml" xref="algorithm1.3.3.m1.3.3.3.3.3.3.4">𝑒</ci><ci id="algorithm1.3.3.m1.3.3.3.3.3.3.5.cmml" xref="algorithm1.3.3.m1.3.3.3.3.3.3.5">𝑛</ci><ci id="algorithm1.3.3.m1.3.3.3.3.3.3.6.cmml" xref="algorithm1.3.3.m1.3.3.3.3.3.3.6">𝑡</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.m1.3c">\theta:=\{\theta_{GAT},\theta_{Transformer},\theta_{Agent}\}</annotation></semantics></math>,
Baseline with <math id="algorithm1.4.4.m2.1" class="ltx_Math" alttext="b" display="inline"><semantics id="algorithm1.4.4.m2.1a"><mi id="algorithm1.4.4.m2.1.1" xref="algorithm1.4.4.m2.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.m2.1b"><ci id="algorithm1.4.4.m2.1.1.cmml" xref="algorithm1.4.4.m2.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.m2.1c">b</annotation></semantics></math>
</div>
<div id="algorithm1.6.6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span>
<span id="algorithm1.6.6.3" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.6.6.2" class="ltx_emph ltx_font_italic"><math id="algorithm1.5.5.1.m1.1" class="ltx_Math" alttext="i\leftarrow 0" display="inline"><semantics id="algorithm1.5.5.1.m1.1a"><mrow id="algorithm1.5.5.1.m1.1.1" xref="algorithm1.5.5.1.m1.1.1.cmml"><mi id="algorithm1.5.5.1.m1.1.1.2" xref="algorithm1.5.5.1.m1.1.1.2.cmml">i</mi><mo stretchy="false" id="algorithm1.5.5.1.m1.1.1.1" xref="algorithm1.5.5.1.m1.1.1.1.cmml">←</mo><mn id="algorithm1.5.5.1.m1.1.1.3" xref="algorithm1.5.5.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.1.m1.1b"><apply id="algorithm1.5.5.1.m1.1.1.cmml" xref="algorithm1.5.5.1.m1.1.1"><ci id="algorithm1.5.5.1.m1.1.1.1.cmml" xref="algorithm1.5.5.1.m1.1.1.1">←</ci><ci id="algorithm1.5.5.1.m1.1.1.2.cmml" xref="algorithm1.5.5.1.m1.1.1.2">𝑖</ci><cn type="integer" id="algorithm1.5.5.1.m1.1.1.3.cmml" xref="algorithm1.5.5.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.1.m1.1c">i\leftarrow 0</annotation></semantics></math> <span id="algorithm1.6.6.2.1" class="ltx_text ltx_font_bold ltx_font_upright">to</span> <math id="algorithm1.6.6.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="algorithm1.6.6.2.m2.1a"><mi id="algorithm1.6.6.2.m2.1.1" xref="algorithm1.6.6.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.2.m2.1b"><ci id="algorithm1.6.6.2.m2.1.1.cmml" xref="algorithm1.6.6.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.2.m2.1c">N</annotation></semantics></math></em> <span id="algorithm1.6.6.4" class="ltx_text ltx_font_bold">do</span> <span id="algorithm1.6.6.5" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm1.6.6.6" class="ltx_text ltx_font_typewriter">Loop over epochs </span> 
</div>
<div id="algorithm1.8.8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Initialize <math id="algorithm1.7.7.m1.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="algorithm1.7.7.m1.1a"><mi id="algorithm1.7.7.m1.1.1" xref="algorithm1.7.7.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.m1.1b"><ci id="algorithm1.7.7.m1.1.1.cmml" xref="algorithm1.7.7.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.m1.1c">Q</annotation></semantics></math> and <math id="algorithm1.8.8.m2.1" class="ltx_Math" alttext="\mathcal{SG}" display="inline"><semantics id="algorithm1.8.8.m2.1a"><mrow id="algorithm1.8.8.m2.1.1" xref="algorithm1.8.8.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.8.8.m2.1.1.2" xref="algorithm1.8.8.m2.1.1.2.cmml">𝒮</mi><mo lspace="0em" rspace="0em" id="algorithm1.8.8.m2.1.1.1" xref="algorithm1.8.8.m2.1.1.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="algorithm1.8.8.m2.1.1.3" xref="algorithm1.8.8.m2.1.1.3.cmml">𝒢</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.8.8.m2.1b"><apply id="algorithm1.8.8.m2.1.1.cmml" xref="algorithm1.8.8.m2.1.1"><times id="algorithm1.8.8.m2.1.1.1.cmml" xref="algorithm1.8.8.m2.1.1.1"></times><ci id="algorithm1.8.8.m2.1.1.2.cmml" xref="algorithm1.8.8.m2.1.1.2">𝒮</ci><ci id="algorithm1.8.8.m2.1.1.3.cmml" xref="algorithm1.8.8.m2.1.1.3">𝒢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.8.m2.1c">\mathcal{SG}</annotation></semantics></math> with GloVe embeddings;
</div>
<div id="algorithm1.9.9" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.9.9.m1.1" class="ltx_Math" alttext="Q\leftarrow\mbox{GAT}(Q)" display="inline"><semantics id="algorithm1.9.9.m1.1a"><mrow id="algorithm1.9.9.m1.1.2" xref="algorithm1.9.9.m1.1.2.cmml"><mi id="algorithm1.9.9.m1.1.2.2" xref="algorithm1.9.9.m1.1.2.2.cmml">Q</mi><mo stretchy="false" id="algorithm1.9.9.m1.1.2.1" xref="algorithm1.9.9.m1.1.2.1.cmml">←</mo><mrow id="algorithm1.9.9.m1.1.2.3" xref="algorithm1.9.9.m1.1.2.3.cmml"><mtext id="algorithm1.9.9.m1.1.2.3.2" xref="algorithm1.9.9.m1.1.2.3.2a.cmml">GAT</mtext><mo lspace="0em" rspace="0em" id="algorithm1.9.9.m1.1.2.3.1" xref="algorithm1.9.9.m1.1.2.3.1.cmml">​</mo><mrow id="algorithm1.9.9.m1.1.2.3.3.2" xref="algorithm1.9.9.m1.1.2.3.cmml"><mo stretchy="false" id="algorithm1.9.9.m1.1.2.3.3.2.1" xref="algorithm1.9.9.m1.1.2.3.cmml">(</mo><mi id="algorithm1.9.9.m1.1.1" xref="algorithm1.9.9.m1.1.1.cmml">Q</mi><mo stretchy="false" id="algorithm1.9.9.m1.1.2.3.3.2.2" xref="algorithm1.9.9.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.9.9.m1.1b"><apply id="algorithm1.9.9.m1.1.2.cmml" xref="algorithm1.9.9.m1.1.2"><ci id="algorithm1.9.9.m1.1.2.1.cmml" xref="algorithm1.9.9.m1.1.2.1">←</ci><ci id="algorithm1.9.9.m1.1.2.2.cmml" xref="algorithm1.9.9.m1.1.2.2">𝑄</ci><apply id="algorithm1.9.9.m1.1.2.3.cmml" xref="algorithm1.9.9.m1.1.2.3"><times id="algorithm1.9.9.m1.1.2.3.1.cmml" xref="algorithm1.9.9.m1.1.2.3.1"></times><ci id="algorithm1.9.9.m1.1.2.3.2a.cmml" xref="algorithm1.9.9.m1.1.2.3.2"><mtext id="algorithm1.9.9.m1.1.2.3.2.cmml" xref="algorithm1.9.9.m1.1.2.3.2">GAT</mtext></ci><ci id="algorithm1.9.9.m1.1.1.cmml" xref="algorithm1.9.9.m1.1.1">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.9.m1.1c">Q\leftarrow\mbox{GAT}(Q)</annotation></semantics></math> <span id="algorithm1.9.9.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm1.9.9.2" class="ltx_text ltx_font_typewriter">Update the question with the question encoder </span>
</div>
<div id="algorithm1.10.10" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.10.10.m1.1" class="ltx_Math" alttext="\mathcal{SG}\leftarrow\mbox{Transformer}(\mathcal{SG})" display="inline"><semantics id="algorithm1.10.10.m1.1a"><mrow id="algorithm1.10.10.m1.1.1" xref="algorithm1.10.10.m1.1.1.cmml"><mrow id="algorithm1.10.10.m1.1.1.3" xref="algorithm1.10.10.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.10.10.m1.1.1.3.2" xref="algorithm1.10.10.m1.1.1.3.2.cmml">𝒮</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.10.m1.1.1.3.1" xref="algorithm1.10.10.m1.1.1.3.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="algorithm1.10.10.m1.1.1.3.3" xref="algorithm1.10.10.m1.1.1.3.3.cmml">𝒢</mi></mrow><mo stretchy="false" id="algorithm1.10.10.m1.1.1.2" xref="algorithm1.10.10.m1.1.1.2.cmml">←</mo><mrow id="algorithm1.10.10.m1.1.1.1" xref="algorithm1.10.10.m1.1.1.1.cmml"><mtext id="algorithm1.10.10.m1.1.1.1.3" xref="algorithm1.10.10.m1.1.1.1.3a.cmml">Transformer</mtext><mo lspace="0em" rspace="0em" id="algorithm1.10.10.m1.1.1.1.2" xref="algorithm1.10.10.m1.1.1.1.2.cmml">​</mo><mrow id="algorithm1.10.10.m1.1.1.1.1.1" xref="algorithm1.10.10.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.10.10.m1.1.1.1.1.1.2" xref="algorithm1.10.10.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="algorithm1.10.10.m1.1.1.1.1.1.1" xref="algorithm1.10.10.m1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.10.10.m1.1.1.1.1.1.1.2" xref="algorithm1.10.10.m1.1.1.1.1.1.1.2.cmml">𝒮</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.10.m1.1.1.1.1.1.1.1" xref="algorithm1.10.10.m1.1.1.1.1.1.1.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="algorithm1.10.10.m1.1.1.1.1.1.1.3" xref="algorithm1.10.10.m1.1.1.1.1.1.1.3.cmml">𝒢</mi></mrow><mo stretchy="false" id="algorithm1.10.10.m1.1.1.1.1.1.3" xref="algorithm1.10.10.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.m1.1b"><apply id="algorithm1.10.10.m1.1.1.cmml" xref="algorithm1.10.10.m1.1.1"><ci id="algorithm1.10.10.m1.1.1.2.cmml" xref="algorithm1.10.10.m1.1.1.2">←</ci><apply id="algorithm1.10.10.m1.1.1.3.cmml" xref="algorithm1.10.10.m1.1.1.3"><times id="algorithm1.10.10.m1.1.1.3.1.cmml" xref="algorithm1.10.10.m1.1.1.3.1"></times><ci id="algorithm1.10.10.m1.1.1.3.2.cmml" xref="algorithm1.10.10.m1.1.1.3.2">𝒮</ci><ci id="algorithm1.10.10.m1.1.1.3.3.cmml" xref="algorithm1.10.10.m1.1.1.3.3">𝒢</ci></apply><apply id="algorithm1.10.10.m1.1.1.1.cmml" xref="algorithm1.10.10.m1.1.1.1"><times id="algorithm1.10.10.m1.1.1.1.2.cmml" xref="algorithm1.10.10.m1.1.1.1.2"></times><ci id="algorithm1.10.10.m1.1.1.1.3a.cmml" xref="algorithm1.10.10.m1.1.1.1.3"><mtext id="algorithm1.10.10.m1.1.1.1.3.cmml" xref="algorithm1.10.10.m1.1.1.1.3">Transformer</mtext></ci><apply id="algorithm1.10.10.m1.1.1.1.1.1.1.cmml" xref="algorithm1.10.10.m1.1.1.1.1.1"><times id="algorithm1.10.10.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.10.10.m1.1.1.1.1.1.1.1"></times><ci id="algorithm1.10.10.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.10.10.m1.1.1.1.1.1.1.2">𝒮</ci><ci id="algorithm1.10.10.m1.1.1.1.1.1.1.3.cmml" xref="algorithm1.10.10.m1.1.1.1.1.1.1.3">𝒢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.m1.1c">\mathcal{SG}\leftarrow\mbox{Transformer}(\mathcal{SG})</annotation></semantics></math> <span id="algorithm1.10.10.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm1.10.10.2" class="ltx_text ltx_font_typewriter">Update the SG with the graph encoder </span>
</div>
<div id="algorithm1.11.11" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.11.11.m1.1" class="ltx_Math" alttext="C\leftarrow[]" display="inline"><semantics id="algorithm1.11.11.m1.1a"><mrow id="algorithm1.11.11.m1.1.1" xref="algorithm1.11.11.m1.1.1.cmml"><mi id="algorithm1.11.11.m1.1.1.2" xref="algorithm1.11.11.m1.1.1.2.cmml">C</mi><mo stretchy="false" id="algorithm1.11.11.m1.1.1.1" xref="algorithm1.11.11.m1.1.1.1.cmml">←</mo><mrow id="algorithm1.11.11.m1.1.1.3.2" xref="algorithm1.11.11.m1.1.1.cmml"><mo stretchy="false" id="algorithm1.11.11.m1.1.1.3.2.1" xref="algorithm1.11.11.m1.1.1.3.1.cmml">[</mo><mo stretchy="false" id="algorithm1.11.11.m1.1.1.3.2.2" xref="algorithm1.11.11.m1.1.1.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.11.11.m1.1b"><apply id="algorithm1.11.11.m1.1.1.cmml" xref="algorithm1.11.11.m1.1.1"><ci id="algorithm1.11.11.m1.1.1.1.cmml" xref="algorithm1.11.11.m1.1.1.1">←</ci><ci id="algorithm1.11.11.m1.1.1.2.cmml" xref="algorithm1.11.11.m1.1.1.2">𝐶</ci><list id="algorithm1.11.11.m1.1.1.3.1.cmml" xref="algorithm1.11.11.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.11.m1.1c">C\leftarrow[]</annotation></semantics></math> <span id="algorithm1.11.11.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm1.11.11.2" class="ltx_text ltx_font_typewriter">Initialize the trajectory buffer </span>
</div>
<div id="algorithm1.13.13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.13.13.3" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.13.13.2" class="ltx_emph ltx_font_italic"><math id="algorithm1.12.12.1.m1.1" class="ltx_Math" alttext="r\leftarrow 0" display="inline"><semantics id="algorithm1.12.12.1.m1.1a"><mrow id="algorithm1.12.12.1.m1.1.1" xref="algorithm1.12.12.1.m1.1.1.cmml"><mi id="algorithm1.12.12.1.m1.1.1.2" xref="algorithm1.12.12.1.m1.1.1.2.cmml">r</mi><mo stretchy="false" id="algorithm1.12.12.1.m1.1.1.1" xref="algorithm1.12.12.1.m1.1.1.1.cmml">←</mo><mn id="algorithm1.12.12.1.m1.1.1.3" xref="algorithm1.12.12.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.12.12.1.m1.1b"><apply id="algorithm1.12.12.1.m1.1.1.cmml" xref="algorithm1.12.12.1.m1.1.1"><ci id="algorithm1.12.12.1.m1.1.1.1.cmml" xref="algorithm1.12.12.1.m1.1.1.1">←</ci><ci id="algorithm1.12.12.1.m1.1.1.2.cmml" xref="algorithm1.12.12.1.m1.1.1.2">𝑟</ci><cn type="integer" id="algorithm1.12.12.1.m1.1.1.3.cmml" xref="algorithm1.12.12.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.12.1.m1.1c">r\leftarrow 0</annotation></semantics></math> <span id="algorithm1.13.13.2.1" class="ltx_text ltx_font_bold ltx_font_upright">to</span> <math id="algorithm1.13.13.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="algorithm1.13.13.2.m2.1a"><mi id="algorithm1.13.13.2.m2.1.1" xref="algorithm1.13.13.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="algorithm1.13.13.2.m2.1b"><ci id="algorithm1.13.13.2.m2.1.1.cmml" xref="algorithm1.13.13.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.13.2.m2.1c">N</annotation></semantics></math></em> <span id="algorithm1.13.13.4" class="ltx_text ltx_font_bold">do</span> <span id="algorithm1.13.13.5" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm1.13.13.6" class="ltx_text ltx_font_typewriter">Loop over samples </span> 
</div>
<div id="algorithm1.14.14" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.14.14.m1.1" class="ltx_Math" alttext="\tau\leftarrow[]" display="inline"><semantics id="algorithm1.14.14.m1.1a"><mrow id="algorithm1.14.14.m1.1.1" xref="algorithm1.14.14.m1.1.1.cmml"><mi id="algorithm1.14.14.m1.1.1.2" xref="algorithm1.14.14.m1.1.1.2.cmml">τ</mi><mo stretchy="false" id="algorithm1.14.14.m1.1.1.1" xref="algorithm1.14.14.m1.1.1.1.cmml">←</mo><mrow id="algorithm1.14.14.m1.1.1.3.2" xref="algorithm1.14.14.m1.1.1.cmml"><mo stretchy="false" id="algorithm1.14.14.m1.1.1.3.2.1" xref="algorithm1.14.14.m1.1.1.3.1.cmml">[</mo><mo stretchy="false" id="algorithm1.14.14.m1.1.1.3.2.2" xref="algorithm1.14.14.m1.1.1.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.14.14.m1.1b"><apply id="algorithm1.14.14.m1.1.1.cmml" xref="algorithm1.14.14.m1.1.1"><ci id="algorithm1.14.14.m1.1.1.1.cmml" xref="algorithm1.14.14.m1.1.1.1">←</ci><ci id="algorithm1.14.14.m1.1.1.2.cmml" xref="algorithm1.14.14.m1.1.1.2">𝜏</ci><list id="algorithm1.14.14.m1.1.1.3.1.cmml" xref="algorithm1.14.14.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.14.14.m1.1c">\tau\leftarrow[]</annotation></semantics></math> <span id="algorithm1.14.14.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm1.14.14.2" class="ltx_text ltx_font_typewriter">Initialize the trajectory </span>
</div>
<div id="algorithm1.15.15" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.15.15.m1.1" class="ltx_Math" alttext="E_{0}\leftarrow" display="inline"><semantics id="algorithm1.15.15.m1.1a"><mrow id="algorithm1.15.15.m1.1.1" xref="algorithm1.15.15.m1.1.1.cmml"><msub id="algorithm1.15.15.m1.1.1.2" xref="algorithm1.15.15.m1.1.1.2.cmml"><mi id="algorithm1.15.15.m1.1.1.2.2" xref="algorithm1.15.15.m1.1.1.2.2.cmml">E</mi><mn id="algorithm1.15.15.m1.1.1.2.3" xref="algorithm1.15.15.m1.1.1.2.3.cmml">0</mn></msub><mo stretchy="false" id="algorithm1.15.15.m1.1.1.1" xref="algorithm1.15.15.m1.1.1.1.cmml">←</mo><mi id="algorithm1.15.15.m1.1.1.3" xref="algorithm1.15.15.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.15.15.m1.1b"><apply id="algorithm1.15.15.m1.1.1.cmml" xref="algorithm1.15.15.m1.1.1"><ci id="algorithm1.15.15.m1.1.1.1.cmml" xref="algorithm1.15.15.m1.1.1.1">←</ci><apply id="algorithm1.15.15.m1.1.1.2.cmml" xref="algorithm1.15.15.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.15.15.m1.1.1.2.1.cmml" xref="algorithm1.15.15.m1.1.1.2">subscript</csymbol><ci id="algorithm1.15.15.m1.1.1.2.2.cmml" xref="algorithm1.15.15.m1.1.1.2.2">𝐸</ci><cn type="integer" id="algorithm1.15.15.m1.1.1.2.3.cmml" xref="algorithm1.15.15.m1.1.1.2.3">0</cn></apply><csymbol cd="latexml" id="algorithm1.15.15.m1.1.1.3.cmml" xref="algorithm1.15.15.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.15.15.m1.1c">E_{0}\leftarrow</annotation></semantics></math> hub <span id="algorithm1.15.15.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm1.15.15.2" class="ltx_text ltx_font_typewriter">Initialize the start position </span>
</div>
<div id="algorithm1.16.16" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.16.16.m1.1" class="ltx_Math" alttext="A_{0}\leftarrow" display="inline"><semantics id="algorithm1.16.16.m1.1a"><mrow id="algorithm1.16.16.m1.1.1" xref="algorithm1.16.16.m1.1.1.cmml"><msub id="algorithm1.16.16.m1.1.1.2" xref="algorithm1.16.16.m1.1.1.2.cmml"><mi id="algorithm1.16.16.m1.1.1.2.2" xref="algorithm1.16.16.m1.1.1.2.2.cmml">A</mi><mn id="algorithm1.16.16.m1.1.1.2.3" xref="algorithm1.16.16.m1.1.1.2.3.cmml">0</mn></msub><mo stretchy="false" id="algorithm1.16.16.m1.1.1.1" xref="algorithm1.16.16.m1.1.1.1.cmml">←</mo><mi id="algorithm1.16.16.m1.1.1.3" xref="algorithm1.16.16.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.16.16.m1.1b"><apply id="algorithm1.16.16.m1.1.1.cmml" xref="algorithm1.16.16.m1.1.1"><ci id="algorithm1.16.16.m1.1.1.1.cmml" xref="algorithm1.16.16.m1.1.1.1">←</ci><apply id="algorithm1.16.16.m1.1.1.2.cmml" xref="algorithm1.16.16.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.1.1.2.1.cmml" xref="algorithm1.16.16.m1.1.1.2">subscript</csymbol><ci id="algorithm1.16.16.m1.1.1.2.2.cmml" xref="algorithm1.16.16.m1.1.1.2.2">𝐴</ci><cn type="integer" id="algorithm1.16.16.m1.1.1.2.3.cmml" xref="algorithm1.16.16.m1.1.1.2.3">0</cn></apply><csymbol cd="latexml" id="algorithm1.16.16.m1.1.1.3.cmml" xref="algorithm1.16.16.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.16.16.m1.1c">A_{0}\leftarrow</annotation></semantics></math> dummy <span id="algorithm1.16.16.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm1.16.16.2" class="ltx_text ltx_font_typewriter">Initialize the dummy start action </span>
</div>
<div id="algorithm1.18.18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.18.18.3" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.18.18.2" class="ltx_emph ltx_font_italic"><math id="algorithm1.17.17.1.m1.1" class="ltx_Math" alttext="t\leftarrow 0" display="inline"><semantics id="algorithm1.17.17.1.m1.1a"><mrow id="algorithm1.17.17.1.m1.1.1" xref="algorithm1.17.17.1.m1.1.1.cmml"><mi id="algorithm1.17.17.1.m1.1.1.2" xref="algorithm1.17.17.1.m1.1.1.2.cmml">t</mi><mo stretchy="false" id="algorithm1.17.17.1.m1.1.1.1" xref="algorithm1.17.17.1.m1.1.1.1.cmml">←</mo><mn id="algorithm1.17.17.1.m1.1.1.3" xref="algorithm1.17.17.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.17.17.1.m1.1b"><apply id="algorithm1.17.17.1.m1.1.1.cmml" xref="algorithm1.17.17.1.m1.1.1"><ci id="algorithm1.17.17.1.m1.1.1.1.cmml" xref="algorithm1.17.17.1.m1.1.1.1">←</ci><ci id="algorithm1.17.17.1.m1.1.1.2.cmml" xref="algorithm1.17.17.1.m1.1.1.2">𝑡</ci><cn type="integer" id="algorithm1.17.17.1.m1.1.1.3.cmml" xref="algorithm1.17.17.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.17.17.1.m1.1c">t\leftarrow 0</annotation></semantics></math> <span id="algorithm1.18.18.2.1" class="ltx_text ltx_font_bold ltx_font_upright">to</span> <math id="algorithm1.18.18.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="algorithm1.18.18.2.m2.1a"><mi id="algorithm1.18.18.2.m2.1.1" xref="algorithm1.18.18.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="algorithm1.18.18.2.m2.1b"><ci id="algorithm1.18.18.2.m2.1.1.cmml" xref="algorithm1.18.18.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.18.18.2.m2.1c">T</annotation></semantics></math></em> <span id="algorithm1.18.18.4" class="ltx_text ltx_font_bold">do</span> <span id="algorithm1.18.18.5" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm1.18.18.6" class="ltx_text ltx_font_typewriter">Loop over time steps </span> 
</div>
<div id="algorithm1.19.19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.19.19.2" class="ltx_text ltx_font_bold">if</span> <em id="algorithm1.19.19.1" class="ltx_emph ltx_font_italic"><math id="algorithm1.19.19.1.m1.1" class="ltx_math_unparsed" alttext="t\%\Delta==0" display="inline"><semantics id="algorithm1.19.19.1.m1.1a"><mrow id="algorithm1.19.19.1.m1.1b"><mi id="algorithm1.19.19.1.m1.1.1">t</mi><mo id="algorithm1.19.19.1.m1.1.2">%</mo><mi mathvariant="normal" id="algorithm1.19.19.1.m1.1.3">Δ</mi><mo rspace="0em" id="algorithm1.19.19.1.m1.1.4">=</mo><mo lspace="0em" id="algorithm1.19.19.1.m1.1.5">=</mo><mn id="algorithm1.19.19.1.m1.1.6">0</mn></mrow><annotation encoding="application/x-tex" id="algorithm1.19.19.1.m1.1c">t\%\Delta==0</annotation></semantics></math></em> <span id="algorithm1.19.19.3" class="ltx_text ltx_font_bold">then</span> <span id="algorithm1.19.19.4" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm1.19.19.5" class="ltx_text ltx_font_typewriter">Restart and prompt the agent to the hub node </span> 
</div>
<div id="algorithm1.34.35" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.34.35.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm1.34.35.2" class="ltx_text ltx_font_typewriter">so that the agent is aware of its own action </span>
</div>
<div id="algorithm1.20.20" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.20.20.m1.1" class="ltx_Math" alttext="E_{t+1}\leftarrow" display="inline"><semantics id="algorithm1.20.20.m1.1a"><mrow id="algorithm1.20.20.m1.1.1" xref="algorithm1.20.20.m1.1.1.cmml"><msub id="algorithm1.20.20.m1.1.1.2" xref="algorithm1.20.20.m1.1.1.2.cmml"><mi id="algorithm1.20.20.m1.1.1.2.2" xref="algorithm1.20.20.m1.1.1.2.2.cmml">E</mi><mrow id="algorithm1.20.20.m1.1.1.2.3" xref="algorithm1.20.20.m1.1.1.2.3.cmml"><mi id="algorithm1.20.20.m1.1.1.2.3.2" xref="algorithm1.20.20.m1.1.1.2.3.2.cmml">t</mi><mo id="algorithm1.20.20.m1.1.1.2.3.1" xref="algorithm1.20.20.m1.1.1.2.3.1.cmml">+</mo><mn id="algorithm1.20.20.m1.1.1.2.3.3" xref="algorithm1.20.20.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="algorithm1.20.20.m1.1.1.1" xref="algorithm1.20.20.m1.1.1.1.cmml">←</mo><mi id="algorithm1.20.20.m1.1.1.3" xref="algorithm1.20.20.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.20.20.m1.1b"><apply id="algorithm1.20.20.m1.1.1.cmml" xref="algorithm1.20.20.m1.1.1"><ci id="algorithm1.20.20.m1.1.1.1.cmml" xref="algorithm1.20.20.m1.1.1.1">←</ci><apply id="algorithm1.20.20.m1.1.1.2.cmml" xref="algorithm1.20.20.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.20.20.m1.1.1.2.1.cmml" xref="algorithm1.20.20.m1.1.1.2">subscript</csymbol><ci id="algorithm1.20.20.m1.1.1.2.2.cmml" xref="algorithm1.20.20.m1.1.1.2.2">𝐸</ci><apply id="algorithm1.20.20.m1.1.1.2.3.cmml" xref="algorithm1.20.20.m1.1.1.2.3"><plus id="algorithm1.20.20.m1.1.1.2.3.1.cmml" xref="algorithm1.20.20.m1.1.1.2.3.1"></plus><ci id="algorithm1.20.20.m1.1.1.2.3.2.cmml" xref="algorithm1.20.20.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.20.20.m1.1.1.2.3.3.cmml" xref="algorithm1.20.20.m1.1.1.2.3.3">1</cn></apply></apply><csymbol cd="latexml" id="algorithm1.20.20.m1.1.1.3.cmml" xref="algorithm1.20.20.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.20.20.m1.1c">E_{t+1}\leftarrow</annotation></semantics></math> hub <span id="algorithm1.20.20.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm1.20.20.2" class="ltx_text ltx_font_typewriter">Set next nodes to the hub node </span>
</div>
<div id="algorithm1.21.21" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.21.21.m1.1" class="ltx_Math" alttext="A_{t+1}\leftarrow" display="inline"><semantics id="algorithm1.21.21.m1.1a"><mrow id="algorithm1.21.21.m1.1.1" xref="algorithm1.21.21.m1.1.1.cmml"><msub id="algorithm1.21.21.m1.1.1.2" xref="algorithm1.21.21.m1.1.1.2.cmml"><mi id="algorithm1.21.21.m1.1.1.2.2" xref="algorithm1.21.21.m1.1.1.2.2.cmml">A</mi><mrow id="algorithm1.21.21.m1.1.1.2.3" xref="algorithm1.21.21.m1.1.1.2.3.cmml"><mi id="algorithm1.21.21.m1.1.1.2.3.2" xref="algorithm1.21.21.m1.1.1.2.3.2.cmml">t</mi><mo id="algorithm1.21.21.m1.1.1.2.3.1" xref="algorithm1.21.21.m1.1.1.2.3.1.cmml">+</mo><mn id="algorithm1.21.21.m1.1.1.2.3.3" xref="algorithm1.21.21.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="algorithm1.21.21.m1.1.1.1" xref="algorithm1.21.21.m1.1.1.1.cmml">←</mo><mi id="algorithm1.21.21.m1.1.1.3" xref="algorithm1.21.21.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.21.21.m1.1b"><apply id="algorithm1.21.21.m1.1.1.cmml" xref="algorithm1.21.21.m1.1.1"><ci id="algorithm1.21.21.m1.1.1.1.cmml" xref="algorithm1.21.21.m1.1.1.1">←</ci><apply id="algorithm1.21.21.m1.1.1.2.cmml" xref="algorithm1.21.21.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.1.1.2.1.cmml" xref="algorithm1.21.21.m1.1.1.2">subscript</csymbol><ci id="algorithm1.21.21.m1.1.1.2.2.cmml" xref="algorithm1.21.21.m1.1.1.2.2">𝐴</ci><apply id="algorithm1.21.21.m1.1.1.2.3.cmml" xref="algorithm1.21.21.m1.1.1.2.3"><plus id="algorithm1.21.21.m1.1.1.2.3.1.cmml" xref="algorithm1.21.21.m1.1.1.2.3.1"></plus><ci id="algorithm1.21.21.m1.1.1.2.3.2.cmml" xref="algorithm1.21.21.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.21.21.m1.1.1.2.3.3.cmml" xref="algorithm1.21.21.m1.1.1.2.3.3">1</cn></apply></apply><csymbol cd="latexml" id="algorithm1.21.21.m1.1.1.3.cmml" xref="algorithm1.21.21.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.21.21.m1.1c">A_{t+1}\leftarrow</annotation></semantics></math> dummy <span id="algorithm1.21.21.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm1.21.21.2" class="ltx_text ltx_font_typewriter">Set next actions to the dummy return action </span>
</div>
<div id="algorithm1.34.36" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm1.34.37" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end if
</div>
<div id="algorithm1.27.27" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   Sample an action (<math id="algorithm1.22.22.m1.1" class="ltx_Math" alttext="A_{t}" display="inline"><semantics id="algorithm1.22.22.m1.1a"><msub id="algorithm1.22.22.m1.1.1" xref="algorithm1.22.22.m1.1.1.cmml"><mi id="algorithm1.22.22.m1.1.1.2" xref="algorithm1.22.22.m1.1.1.2.cmml">A</mi><mi id="algorithm1.22.22.m1.1.1.3" xref="algorithm1.22.22.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.22.22.m1.1b"><apply id="algorithm1.22.22.m1.1.1.cmml" xref="algorithm1.22.22.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.22.22.m1.1.1.1.cmml" xref="algorithm1.22.22.m1.1.1">subscript</csymbol><ci id="algorithm1.22.22.m1.1.1.2.cmml" xref="algorithm1.22.22.m1.1.1.2">𝐴</ci><ci id="algorithm1.22.22.m1.1.1.3.cmml" xref="algorithm1.22.22.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.22.22.m1.1c">A_{t}</annotation></semantics></math>, <math id="algorithm1.23.23.m2.1" class="ltx_Math" alttext="E_{t+1}" display="inline"><semantics id="algorithm1.23.23.m2.1a"><msub id="algorithm1.23.23.m2.1.1" xref="algorithm1.23.23.m2.1.1.cmml"><mi id="algorithm1.23.23.m2.1.1.2" xref="algorithm1.23.23.m2.1.1.2.cmml">E</mi><mrow id="algorithm1.23.23.m2.1.1.3" xref="algorithm1.23.23.m2.1.1.3.cmml"><mi id="algorithm1.23.23.m2.1.1.3.2" xref="algorithm1.23.23.m2.1.1.3.2.cmml">t</mi><mo id="algorithm1.23.23.m2.1.1.3.1" xref="algorithm1.23.23.m2.1.1.3.1.cmml">+</mo><mn id="algorithm1.23.23.m2.1.1.3.3" xref="algorithm1.23.23.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm1.23.23.m2.1b"><apply id="algorithm1.23.23.m2.1.1.cmml" xref="algorithm1.23.23.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.23.23.m2.1.1.1.cmml" xref="algorithm1.23.23.m2.1.1">subscript</csymbol><ci id="algorithm1.23.23.m2.1.1.2.cmml" xref="algorithm1.23.23.m2.1.1.2">𝐸</ci><apply id="algorithm1.23.23.m2.1.1.3.cmml" xref="algorithm1.23.23.m2.1.1.3"><plus id="algorithm1.23.23.m2.1.1.3.1.cmml" xref="algorithm1.23.23.m2.1.1.3.1"></plus><ci id="algorithm1.23.23.m2.1.1.3.2.cmml" xref="algorithm1.23.23.m2.1.1.3.2">𝑡</ci><cn type="integer" id="algorithm1.23.23.m2.1.1.3.3.cmml" xref="algorithm1.23.23.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.23.23.m2.1c">E_{t+1}</annotation></semantics></math>) from <math id="algorithm1.24.24.m3.1" class="ltx_Math" alttext="d_{t}" display="inline"><semantics id="algorithm1.24.24.m3.1a"><msub id="algorithm1.24.24.m3.1.1" xref="algorithm1.24.24.m3.1.1.cmml"><mi id="algorithm1.24.24.m3.1.1.2" xref="algorithm1.24.24.m3.1.1.2.cmml">d</mi><mi id="algorithm1.24.24.m3.1.1.3" xref="algorithm1.24.24.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.24.24.m3.1b"><apply id="algorithm1.24.24.m3.1.1.cmml" xref="algorithm1.24.24.m3.1.1"><csymbol cd="ambiguous" id="algorithm1.24.24.m3.1.1.1.cmml" xref="algorithm1.24.24.m3.1.1">subscript</csymbol><ci id="algorithm1.24.24.m3.1.1.2.cmml" xref="algorithm1.24.24.m3.1.1.2">𝑑</ci><ci id="algorithm1.24.24.m3.1.1.3.cmml" xref="algorithm1.24.24.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.24.24.m3.1c">d_{t}</annotation></semantics></math>
<math id="algorithm1.25.25.m4.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="algorithm1.25.25.m4.1a"><mi id="algorithm1.25.25.m4.1.1" xref="algorithm1.25.25.m4.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="algorithm1.25.25.m4.1b"><ci id="algorithm1.25.25.m4.1.1.cmml" xref="algorithm1.25.25.m4.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.25.25.m4.1c">\tau</annotation></semantics></math>.append(<math id="algorithm1.26.26.m5.1" class="ltx_Math" alttext="A_{t}" display="inline"><semantics id="algorithm1.26.26.m5.1a"><msub id="algorithm1.26.26.m5.1.1" xref="algorithm1.26.26.m5.1.1.cmml"><mi id="algorithm1.26.26.m5.1.1.2" xref="algorithm1.26.26.m5.1.1.2.cmml">A</mi><mi id="algorithm1.26.26.m5.1.1.3" xref="algorithm1.26.26.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.26.26.m5.1b"><apply id="algorithm1.26.26.m5.1.1.cmml" xref="algorithm1.26.26.m5.1.1"><csymbol cd="ambiguous" id="algorithm1.26.26.m5.1.1.1.cmml" xref="algorithm1.26.26.m5.1.1">subscript</csymbol><ci id="algorithm1.26.26.m5.1.1.2.cmml" xref="algorithm1.26.26.m5.1.1.2">𝐴</ci><ci id="algorithm1.26.26.m5.1.1.3.cmml" xref="algorithm1.26.26.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.26.26.m5.1c">A_{t}</annotation></semantics></math>, <math id="algorithm1.27.27.m6.1" class="ltx_Math" alttext="E_{t}" display="inline"><semantics id="algorithm1.27.27.m6.1a"><msub id="algorithm1.27.27.m6.1.1" xref="algorithm1.27.27.m6.1.1.cmml"><mi id="algorithm1.27.27.m6.1.1.2" xref="algorithm1.27.27.m6.1.1.2.cmml">E</mi><mi id="algorithm1.27.27.m6.1.1.3" xref="algorithm1.27.27.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.27.27.m6.1b"><apply id="algorithm1.27.27.m6.1.1.cmml" xref="algorithm1.27.27.m6.1.1"><csymbol cd="ambiguous" id="algorithm1.27.27.m6.1.1.1.cmml" xref="algorithm1.27.27.m6.1.1">subscript</csymbol><ci id="algorithm1.27.27.m6.1.1.2.cmml" xref="algorithm1.27.27.m6.1.1.2">𝐸</ci><ci id="algorithm1.27.27.m6.1.1.3.cmml" xref="algorithm1.27.27.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.27.27.m6.1c">E_{t}</annotation></semantics></math>) <span id="algorithm1.27.27.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm1.27.27.2" class="ltx_text ltx_font_typewriter">Extend the trajectory </span>
</div>
<div id="algorithm1.28.28" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.28.28.m1.1" class="ltx_Math" alttext="E_{t}\leftarrow E_{t+1}" display="inline"><semantics id="algorithm1.28.28.m1.1a"><mrow id="algorithm1.28.28.m1.1.1" xref="algorithm1.28.28.m1.1.1.cmml"><msub id="algorithm1.28.28.m1.1.1.2" xref="algorithm1.28.28.m1.1.1.2.cmml"><mi id="algorithm1.28.28.m1.1.1.2.2" xref="algorithm1.28.28.m1.1.1.2.2.cmml">E</mi><mi id="algorithm1.28.28.m1.1.1.2.3" xref="algorithm1.28.28.m1.1.1.2.3.cmml">t</mi></msub><mo stretchy="false" id="algorithm1.28.28.m1.1.1.1" xref="algorithm1.28.28.m1.1.1.1.cmml">←</mo><msub id="algorithm1.28.28.m1.1.1.3" xref="algorithm1.28.28.m1.1.1.3.cmml"><mi id="algorithm1.28.28.m1.1.1.3.2" xref="algorithm1.28.28.m1.1.1.3.2.cmml">E</mi><mrow id="algorithm1.28.28.m1.1.1.3.3" xref="algorithm1.28.28.m1.1.1.3.3.cmml"><mi id="algorithm1.28.28.m1.1.1.3.3.2" xref="algorithm1.28.28.m1.1.1.3.3.2.cmml">t</mi><mo id="algorithm1.28.28.m1.1.1.3.3.1" xref="algorithm1.28.28.m1.1.1.3.3.1.cmml">+</mo><mn id="algorithm1.28.28.m1.1.1.3.3.3" xref="algorithm1.28.28.m1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.28.28.m1.1b"><apply id="algorithm1.28.28.m1.1.1.cmml" xref="algorithm1.28.28.m1.1.1"><ci id="algorithm1.28.28.m1.1.1.1.cmml" xref="algorithm1.28.28.m1.1.1.1">←</ci><apply id="algorithm1.28.28.m1.1.1.2.cmml" xref="algorithm1.28.28.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.28.28.m1.1.1.2.1.cmml" xref="algorithm1.28.28.m1.1.1.2">subscript</csymbol><ci id="algorithm1.28.28.m1.1.1.2.2.cmml" xref="algorithm1.28.28.m1.1.1.2.2">𝐸</ci><ci id="algorithm1.28.28.m1.1.1.2.3.cmml" xref="algorithm1.28.28.m1.1.1.2.3">𝑡</ci></apply><apply id="algorithm1.28.28.m1.1.1.3.cmml" xref="algorithm1.28.28.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.28.28.m1.1.1.3.1.cmml" xref="algorithm1.28.28.m1.1.1.3">subscript</csymbol><ci id="algorithm1.28.28.m1.1.1.3.2.cmml" xref="algorithm1.28.28.m1.1.1.3.2">𝐸</ci><apply id="algorithm1.28.28.m1.1.1.3.3.cmml" xref="algorithm1.28.28.m1.1.1.3.3"><plus id="algorithm1.28.28.m1.1.1.3.3.1.cmml" xref="algorithm1.28.28.m1.1.1.3.3.1"></plus><ci id="algorithm1.28.28.m1.1.1.3.3.2.cmml" xref="algorithm1.28.28.m1.1.1.3.3.2">𝑡</ci><cn type="integer" id="algorithm1.28.28.m1.1.1.3.3.3.cmml" xref="algorithm1.28.28.m1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.28.28.m1.1c">E_{t}\leftarrow E_{t+1}</annotation></semantics></math> <span id="algorithm1.28.28.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm1.28.28.2" class="ltx_text ltx_font_typewriter">Move the agent to the next entity </span>
</div>
<div id="algorithm1.34.38" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm1.34.39" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm1.30.30" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="algorithm1.29.29.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="algorithm1.29.29.m1.1a"><mi id="algorithm1.29.29.m1.1.1" xref="algorithm1.29.29.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="algorithm1.29.29.m1.1b"><ci id="algorithm1.29.29.m1.1.1.cmml" xref="algorithm1.29.29.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.29.29.m1.1c">C</annotation></semantics></math>.append(<math id="algorithm1.30.30.m2.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="algorithm1.30.30.m2.1a"><mi id="algorithm1.30.30.m2.1.1" xref="algorithm1.30.30.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="algorithm1.30.30.m2.1b"><ci id="algorithm1.30.30.m2.1.1.cmml" xref="algorithm1.30.30.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.30.30.m2.1c">\tau</annotation></semantics></math>) <span id="algorithm1.30.30.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm1.30.30.2" class="ltx_text ltx_font_typewriter">Collect the trajectory </span>
</div>
<div id="algorithm1.34.40" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm1.34.41" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm1.31.31" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="algorithm1.31.31.m1.1" class="ltx_Math" alttext="r\leftarrow R(C)" display="inline"><semantics id="algorithm1.31.31.m1.1a"><mrow id="algorithm1.31.31.m1.1.2" xref="algorithm1.31.31.m1.1.2.cmml"><mi id="algorithm1.31.31.m1.1.2.2" xref="algorithm1.31.31.m1.1.2.2.cmml">r</mi><mo stretchy="false" id="algorithm1.31.31.m1.1.2.1" xref="algorithm1.31.31.m1.1.2.1.cmml">←</mo><mrow id="algorithm1.31.31.m1.1.2.3" xref="algorithm1.31.31.m1.1.2.3.cmml"><mi id="algorithm1.31.31.m1.1.2.3.2" xref="algorithm1.31.31.m1.1.2.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="algorithm1.31.31.m1.1.2.3.1" xref="algorithm1.31.31.m1.1.2.3.1.cmml">​</mo><mrow id="algorithm1.31.31.m1.1.2.3.3.2" xref="algorithm1.31.31.m1.1.2.3.cmml"><mo stretchy="false" id="algorithm1.31.31.m1.1.2.3.3.2.1" xref="algorithm1.31.31.m1.1.2.3.cmml">(</mo><mi id="algorithm1.31.31.m1.1.1" xref="algorithm1.31.31.m1.1.1.cmml">C</mi><mo stretchy="false" id="algorithm1.31.31.m1.1.2.3.3.2.2" xref="algorithm1.31.31.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.31.31.m1.1b"><apply id="algorithm1.31.31.m1.1.2.cmml" xref="algorithm1.31.31.m1.1.2"><ci id="algorithm1.31.31.m1.1.2.1.cmml" xref="algorithm1.31.31.m1.1.2.1">←</ci><ci id="algorithm1.31.31.m1.1.2.2.cmml" xref="algorithm1.31.31.m1.1.2.2">𝑟</ci><apply id="algorithm1.31.31.m1.1.2.3.cmml" xref="algorithm1.31.31.m1.1.2.3"><times id="algorithm1.31.31.m1.1.2.3.1.cmml" xref="algorithm1.31.31.m1.1.2.3.1"></times><ci id="algorithm1.31.31.m1.1.2.3.2.cmml" xref="algorithm1.31.31.m1.1.2.3.2">𝑅</ci><ci id="algorithm1.31.31.m1.1.1.cmml" xref="algorithm1.31.31.m1.1.1">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.31.31.m1.1c">r\leftarrow R(C)</annotation></semantics></math> <span id="algorithm1.31.31.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm1.31.31.2" class="ltx_text ltx_font_typewriter">Gather rewards </span>
</div>
<div id="algorithm1.32.32" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.32.32.m1.2" class="ltx_Math" alttext="g\leftarrow\sum_{t=0}^{T-1}{\nabla_{\theta}\log\pi_{\theta}(a_{t}|s_{t})(\sum_{t^{{}^{\prime}}=t}^{T-1}{r_{t^{{}^{\prime}}}\gamma^{t^{{}^{\prime}}-t}-b(s_{t})})}" display="inline"><semantics id="algorithm1.32.32.m1.2a"><mrow id="algorithm1.32.32.m1.2.2" xref="algorithm1.32.32.m1.2.2.cmml"><mi id="algorithm1.32.32.m1.2.2.4" xref="algorithm1.32.32.m1.2.2.4.cmml">g</mi><mo rspace="0.111em" stretchy="false" id="algorithm1.32.32.m1.2.2.3" xref="algorithm1.32.32.m1.2.2.3.cmml">←</mo><mrow id="algorithm1.32.32.m1.2.2.2" xref="algorithm1.32.32.m1.2.2.2.cmml"><msubsup id="algorithm1.32.32.m1.2.2.2.3" xref="algorithm1.32.32.m1.2.2.2.3.cmml"><mo id="algorithm1.32.32.m1.2.2.2.3.2.2" xref="algorithm1.32.32.m1.2.2.2.3.2.2.cmml">∑</mo><mrow id="algorithm1.32.32.m1.2.2.2.3.2.3" xref="algorithm1.32.32.m1.2.2.2.3.2.3.cmml"><mi id="algorithm1.32.32.m1.2.2.2.3.2.3.2" xref="algorithm1.32.32.m1.2.2.2.3.2.3.2.cmml">t</mi><mo id="algorithm1.32.32.m1.2.2.2.3.2.3.1" xref="algorithm1.32.32.m1.2.2.2.3.2.3.1.cmml">=</mo><mn id="algorithm1.32.32.m1.2.2.2.3.2.3.3" xref="algorithm1.32.32.m1.2.2.2.3.2.3.3.cmml">0</mn></mrow><mrow id="algorithm1.32.32.m1.2.2.2.3.3" xref="algorithm1.32.32.m1.2.2.2.3.3.cmml"><mi id="algorithm1.32.32.m1.2.2.2.3.3.2" xref="algorithm1.32.32.m1.2.2.2.3.3.2.cmml">T</mi><mo id="algorithm1.32.32.m1.2.2.2.3.3.1" xref="algorithm1.32.32.m1.2.2.2.3.3.1.cmml">−</mo><mn id="algorithm1.32.32.m1.2.2.2.3.3.3" xref="algorithm1.32.32.m1.2.2.2.3.3.3.cmml">1</mn></mrow></msubsup><mrow id="algorithm1.32.32.m1.2.2.2.2" xref="algorithm1.32.32.m1.2.2.2.2.cmml"><mrow id="algorithm1.32.32.m1.2.2.2.2.4" xref="algorithm1.32.32.m1.2.2.2.2.4.cmml"><mrow id="algorithm1.32.32.m1.2.2.2.2.4.1" xref="algorithm1.32.32.m1.2.2.2.2.4.1.cmml"><msub id="algorithm1.32.32.m1.2.2.2.2.4.1.1" xref="algorithm1.32.32.m1.2.2.2.2.4.1.1.cmml"><mo rspace="0.167em" id="algorithm1.32.32.m1.2.2.2.2.4.1.1.2" xref="algorithm1.32.32.m1.2.2.2.2.4.1.1.2.cmml">∇</mo><mi id="algorithm1.32.32.m1.2.2.2.2.4.1.1.3" xref="algorithm1.32.32.m1.2.2.2.2.4.1.1.3.cmml">θ</mi></msub><mi id="algorithm1.32.32.m1.2.2.2.2.4.1.2" xref="algorithm1.32.32.m1.2.2.2.2.4.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="algorithm1.32.32.m1.2.2.2.2.4a" xref="algorithm1.32.32.m1.2.2.2.2.4.cmml">⁡</mo><msub id="algorithm1.32.32.m1.2.2.2.2.4.2" xref="algorithm1.32.32.m1.2.2.2.2.4.2.cmml"><mi id="algorithm1.32.32.m1.2.2.2.2.4.2.2" xref="algorithm1.32.32.m1.2.2.2.2.4.2.2.cmml">π</mi><mi id="algorithm1.32.32.m1.2.2.2.2.4.2.3" xref="algorithm1.32.32.m1.2.2.2.2.4.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="algorithm1.32.32.m1.2.2.2.2.3" xref="algorithm1.32.32.m1.2.2.2.2.3.cmml">​</mo><mrow id="algorithm1.32.32.m1.1.1.1.1.1.1" xref="algorithm1.32.32.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.32.32.m1.1.1.1.1.1.1.2" xref="algorithm1.32.32.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="algorithm1.32.32.m1.1.1.1.1.1.1.1" xref="algorithm1.32.32.m1.1.1.1.1.1.1.1.cmml"><msub id="algorithm1.32.32.m1.1.1.1.1.1.1.1.2" xref="algorithm1.32.32.m1.1.1.1.1.1.1.1.2.cmml"><mi id="algorithm1.32.32.m1.1.1.1.1.1.1.1.2.2" xref="algorithm1.32.32.m1.1.1.1.1.1.1.1.2.2.cmml">a</mi><mi id="algorithm1.32.32.m1.1.1.1.1.1.1.1.2.3" xref="algorithm1.32.32.m1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="algorithm1.32.32.m1.1.1.1.1.1.1.1.1" xref="algorithm1.32.32.m1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="algorithm1.32.32.m1.1.1.1.1.1.1.1.3" xref="algorithm1.32.32.m1.1.1.1.1.1.1.1.3.cmml"><mi id="algorithm1.32.32.m1.1.1.1.1.1.1.1.3.2" xref="algorithm1.32.32.m1.1.1.1.1.1.1.1.3.2.cmml">s</mi><mi id="algorithm1.32.32.m1.1.1.1.1.1.1.1.3.3" xref="algorithm1.32.32.m1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="algorithm1.32.32.m1.1.1.1.1.1.1.3" xref="algorithm1.32.32.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="algorithm1.32.32.m1.2.2.2.2.3a" xref="algorithm1.32.32.m1.2.2.2.2.3.cmml">​</mo><mrow id="algorithm1.32.32.m1.2.2.2.2.2.1" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.cmml"><mo stretchy="false" id="algorithm1.32.32.m1.2.2.2.2.2.1.2" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.cmml">(</mo><mrow id="algorithm1.32.32.m1.2.2.2.2.2.1.1" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.cmml"><mrow id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.cmml"><msubsup id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.cmml"><mo lspace="0em" id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.2" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.2.cmml">∑</mo><mrow id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.cmml"><msup id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.2" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.2.cmml"><mi id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.2.2" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.2.2.cmml">t</mi><msup id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.2.3" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.2.3.cmml"><mi id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.2.3a" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.2.3.cmml"></mi><mo id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.2.3.1" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.2.3.1.cmml">′</mo></msup></msup><mo id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.1" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.1.cmml">=</mo><mi id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.3" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.3.cmml">t</mi></mrow><mrow id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.3" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.3.cmml"><mi id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.3.2" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.3.2.cmml">T</mi><mo id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.3.1" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.3.1.cmml">−</mo><mn id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.3.3" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.3.3.cmml">1</mn></mrow></msubsup><mrow id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.cmml"><msub id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2.cmml"><mi id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2.2" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2.2.cmml">r</mi><msup id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2.3" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2.3.cmml"><mi id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2.3.2" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2.3.2.cmml">t</mi><msup id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2.3.3" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2.3.3.cmml"><mi id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2.3.3a" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2.3.3.cmml"></mi><mo id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2.3.3.1" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2.3.3.1.cmml">′</mo></msup></msup></msub><mo lspace="0em" rspace="0em" id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.1" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.1.cmml">​</mo><msup id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.cmml"><mi id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.2" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.2.cmml">γ</mi><mrow id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.cmml"><msup id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.2" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.2.cmml"><mi id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.2.2" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.2.2.cmml">t</mi><msup id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.2.3" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.2.3.cmml"><mi id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.2.3a" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.2.3.cmml"></mi><mo id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.2.3.1" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.2.3.1.cmml">′</mo></msup></msup><mo id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.1" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.1.cmml">−</mo><mi id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.3" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.3.cmml">t</mi></mrow></msup></mrow></mrow><mo id="algorithm1.32.32.m1.2.2.2.2.2.1.1.2" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.2.cmml">−</mo><mrow id="algorithm1.32.32.m1.2.2.2.2.2.1.1.1" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.cmml"><mi id="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.3" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.3.cmml">b</mi><mo lspace="0em" rspace="0em" id="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.2" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.2.cmml">​</mo><mrow id="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.1.1" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.1.1.2" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.1.1.1" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.1.1.1.2" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.1.1.1.2.cmml">s</mi><mi id="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.1.1.1.3" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.1.1.3" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="algorithm1.32.32.m1.2.2.2.2.2.1.3" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.32.32.m1.2b"><apply id="algorithm1.32.32.m1.2.2.cmml" xref="algorithm1.32.32.m1.2.2"><ci id="algorithm1.32.32.m1.2.2.3.cmml" xref="algorithm1.32.32.m1.2.2.3">←</ci><ci id="algorithm1.32.32.m1.2.2.4.cmml" xref="algorithm1.32.32.m1.2.2.4">𝑔</ci><apply id="algorithm1.32.32.m1.2.2.2.cmml" xref="algorithm1.32.32.m1.2.2.2"><apply id="algorithm1.32.32.m1.2.2.2.3.cmml" xref="algorithm1.32.32.m1.2.2.2.3"><csymbol cd="ambiguous" id="algorithm1.32.32.m1.2.2.2.3.1.cmml" xref="algorithm1.32.32.m1.2.2.2.3">superscript</csymbol><apply id="algorithm1.32.32.m1.2.2.2.3.2.cmml" xref="algorithm1.32.32.m1.2.2.2.3"><csymbol cd="ambiguous" id="algorithm1.32.32.m1.2.2.2.3.2.1.cmml" xref="algorithm1.32.32.m1.2.2.2.3">subscript</csymbol><sum id="algorithm1.32.32.m1.2.2.2.3.2.2.cmml" xref="algorithm1.32.32.m1.2.2.2.3.2.2"></sum><apply id="algorithm1.32.32.m1.2.2.2.3.2.3.cmml" xref="algorithm1.32.32.m1.2.2.2.3.2.3"><eq id="algorithm1.32.32.m1.2.2.2.3.2.3.1.cmml" xref="algorithm1.32.32.m1.2.2.2.3.2.3.1"></eq><ci id="algorithm1.32.32.m1.2.2.2.3.2.3.2.cmml" xref="algorithm1.32.32.m1.2.2.2.3.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.32.32.m1.2.2.2.3.2.3.3.cmml" xref="algorithm1.32.32.m1.2.2.2.3.2.3.3">0</cn></apply></apply><apply id="algorithm1.32.32.m1.2.2.2.3.3.cmml" xref="algorithm1.32.32.m1.2.2.2.3.3"><minus id="algorithm1.32.32.m1.2.2.2.3.3.1.cmml" xref="algorithm1.32.32.m1.2.2.2.3.3.1"></minus><ci id="algorithm1.32.32.m1.2.2.2.3.3.2.cmml" xref="algorithm1.32.32.m1.2.2.2.3.3.2">𝑇</ci><cn type="integer" id="algorithm1.32.32.m1.2.2.2.3.3.3.cmml" xref="algorithm1.32.32.m1.2.2.2.3.3.3">1</cn></apply></apply><apply id="algorithm1.32.32.m1.2.2.2.2.cmml" xref="algorithm1.32.32.m1.2.2.2.2"><times id="algorithm1.32.32.m1.2.2.2.2.3.cmml" xref="algorithm1.32.32.m1.2.2.2.2.3"></times><apply id="algorithm1.32.32.m1.2.2.2.2.4.cmml" xref="algorithm1.32.32.m1.2.2.2.2.4"><apply id="algorithm1.32.32.m1.2.2.2.2.4.1.cmml" xref="algorithm1.32.32.m1.2.2.2.2.4.1"><apply id="algorithm1.32.32.m1.2.2.2.2.4.1.1.cmml" xref="algorithm1.32.32.m1.2.2.2.2.4.1.1"><csymbol cd="ambiguous" id="algorithm1.32.32.m1.2.2.2.2.4.1.1.1.cmml" xref="algorithm1.32.32.m1.2.2.2.2.4.1.1">subscript</csymbol><ci id="algorithm1.32.32.m1.2.2.2.2.4.1.1.2.cmml" xref="algorithm1.32.32.m1.2.2.2.2.4.1.1.2">∇</ci><ci id="algorithm1.32.32.m1.2.2.2.2.4.1.1.3.cmml" xref="algorithm1.32.32.m1.2.2.2.2.4.1.1.3">𝜃</ci></apply><log id="algorithm1.32.32.m1.2.2.2.2.4.1.2.cmml" xref="algorithm1.32.32.m1.2.2.2.2.4.1.2"></log></apply><apply id="algorithm1.32.32.m1.2.2.2.2.4.2.cmml" xref="algorithm1.32.32.m1.2.2.2.2.4.2"><csymbol cd="ambiguous" id="algorithm1.32.32.m1.2.2.2.2.4.2.1.cmml" xref="algorithm1.32.32.m1.2.2.2.2.4.2">subscript</csymbol><ci id="algorithm1.32.32.m1.2.2.2.2.4.2.2.cmml" xref="algorithm1.32.32.m1.2.2.2.2.4.2.2">𝜋</ci><ci id="algorithm1.32.32.m1.2.2.2.2.4.2.3.cmml" xref="algorithm1.32.32.m1.2.2.2.2.4.2.3">𝜃</ci></apply></apply><apply id="algorithm1.32.32.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.32.32.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="algorithm1.32.32.m1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.32.32.m1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="algorithm1.32.32.m1.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.32.32.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.32.32.m1.1.1.1.1.1.1.1.2.1.cmml" xref="algorithm1.32.32.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="algorithm1.32.32.m1.1.1.1.1.1.1.1.2.2.cmml" xref="algorithm1.32.32.m1.1.1.1.1.1.1.1.2.2">𝑎</ci><ci id="algorithm1.32.32.m1.1.1.1.1.1.1.1.2.3.cmml" xref="algorithm1.32.32.m1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="algorithm1.32.32.m1.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.32.32.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.32.32.m1.1.1.1.1.1.1.1.3.1.cmml" xref="algorithm1.32.32.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="algorithm1.32.32.m1.1.1.1.1.1.1.1.3.2.cmml" xref="algorithm1.32.32.m1.1.1.1.1.1.1.1.3.2">𝑠</ci><ci id="algorithm1.32.32.m1.1.1.1.1.1.1.1.3.3.cmml" xref="algorithm1.32.32.m1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="algorithm1.32.32.m1.2.2.2.2.2.1.1.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1"><minus id="algorithm1.32.32.m1.2.2.2.2.2.1.1.2.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.2"></minus><apply id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3"><apply id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1"><csymbol cd="ambiguous" id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.1.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1">superscript</csymbol><apply id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1"><csymbol cd="ambiguous" id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.1.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1">subscript</csymbol><sum id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.2.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.2"></sum><apply id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3"><eq id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.1.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.1"></eq><apply id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.2.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.2"><csymbol cd="ambiguous" id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.2.1.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.2">superscript</csymbol><ci id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.2.2.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.2.2">𝑡</ci><apply id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.2.3.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.2.3"><ci id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.2.3.1.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.2.3.1">′</ci></apply></apply><ci id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.3.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.2.3.3">𝑡</ci></apply></apply><apply id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.3.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.3"><minus id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.3.1.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.3.1"></minus><ci id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.3.2.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.3.2">𝑇</ci><cn type="integer" id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.3.3.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.1.3.3">1</cn></apply></apply><apply id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2"><times id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.1.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.1"></times><apply id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2"><csymbol cd="ambiguous" id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2.1.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2">subscript</csymbol><ci id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2.2.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2.2">𝑟</ci><apply id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2.3.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2.3"><csymbol cd="ambiguous" id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2.3.1.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2.3">superscript</csymbol><ci id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2.3.2.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2.3.2">𝑡</ci><apply id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2.3.3.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2.3.3"><ci id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2.3.3.1.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.2.3.3.1">′</ci></apply></apply></apply><apply id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3"><csymbol cd="ambiguous" id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.1.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3">superscript</csymbol><ci id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.2.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.2">𝛾</ci><apply id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3"><minus id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.1.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.1"></minus><apply id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.2.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.2"><csymbol cd="ambiguous" id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.2.1.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.2">superscript</csymbol><ci id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.2.2.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.2.2">𝑡</ci><apply id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.2.3.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.2.3"><ci id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.2.3.1.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.2.3.1">′</ci></apply></apply><ci id="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.3.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.3.2.3.3.3">𝑡</ci></apply></apply></apply></apply><apply id="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.1"><times id="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.2.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.2"></times><ci id="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.3.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.3">𝑏</ci><apply id="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.1.1.1.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.1.1.1.2">𝑠</ci><ci id="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="algorithm1.32.32.m1.2.2.2.2.2.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.32.32.m1.2c">g\leftarrow\sum_{t=0}^{T-1}{\nabla_{\theta}\log\pi_{\theta}(a_{t}|s_{t})(\sum_{t^{{}^{\prime}}=t}^{T-1}{r_{t^{{}^{\prime}}}\gamma^{t^{{}^{\prime}}-t}-b(s_{t})})}</annotation></semantics></math> <span id="algorithm1.32.32.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm1.32.32.2" class="ltx_text ltx_font_typewriter">Approximate gradients </span>
</div>
<div id="algorithm1.33.33" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.33.33.m1.1" class="ltx_Math" alttext="\theta\leftarrow\theta+\eta g" display="inline"><semantics id="algorithm1.33.33.m1.1a"><mrow id="algorithm1.33.33.m1.1.1" xref="algorithm1.33.33.m1.1.1.cmml"><mi id="algorithm1.33.33.m1.1.1.2" xref="algorithm1.33.33.m1.1.1.2.cmml">θ</mi><mo stretchy="false" id="algorithm1.33.33.m1.1.1.1" xref="algorithm1.33.33.m1.1.1.1.cmml">←</mo><mrow id="algorithm1.33.33.m1.1.1.3" xref="algorithm1.33.33.m1.1.1.3.cmml"><mi id="algorithm1.33.33.m1.1.1.3.2" xref="algorithm1.33.33.m1.1.1.3.2.cmml">θ</mi><mo id="algorithm1.33.33.m1.1.1.3.1" xref="algorithm1.33.33.m1.1.1.3.1.cmml">+</mo><mrow id="algorithm1.33.33.m1.1.1.3.3" xref="algorithm1.33.33.m1.1.1.3.3.cmml"><mi id="algorithm1.33.33.m1.1.1.3.3.2" xref="algorithm1.33.33.m1.1.1.3.3.2.cmml">η</mi><mo lspace="0em" rspace="0em" id="algorithm1.33.33.m1.1.1.3.3.1" xref="algorithm1.33.33.m1.1.1.3.3.1.cmml">​</mo><mi id="algorithm1.33.33.m1.1.1.3.3.3" xref="algorithm1.33.33.m1.1.1.3.3.3.cmml">g</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.33.33.m1.1b"><apply id="algorithm1.33.33.m1.1.1.cmml" xref="algorithm1.33.33.m1.1.1"><ci id="algorithm1.33.33.m1.1.1.1.cmml" xref="algorithm1.33.33.m1.1.1.1">←</ci><ci id="algorithm1.33.33.m1.1.1.2.cmml" xref="algorithm1.33.33.m1.1.1.2">𝜃</ci><apply id="algorithm1.33.33.m1.1.1.3.cmml" xref="algorithm1.33.33.m1.1.1.3"><plus id="algorithm1.33.33.m1.1.1.3.1.cmml" xref="algorithm1.33.33.m1.1.1.3.1"></plus><ci id="algorithm1.33.33.m1.1.1.3.2.cmml" xref="algorithm1.33.33.m1.1.1.3.2">𝜃</ci><apply id="algorithm1.33.33.m1.1.1.3.3.cmml" xref="algorithm1.33.33.m1.1.1.3.3"><times id="algorithm1.33.33.m1.1.1.3.3.1.cmml" xref="algorithm1.33.33.m1.1.1.3.3.1"></times><ci id="algorithm1.33.33.m1.1.1.3.3.2.cmml" xref="algorithm1.33.33.m1.1.1.3.3.2">𝜂</ci><ci id="algorithm1.33.33.m1.1.1.3.3.3.cmml" xref="algorithm1.33.33.m1.1.1.3.3.3">𝑔</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.33.33.m1.1c">\theta\leftarrow\theta+\eta g</annotation></semantics></math> <span id="algorithm1.33.33.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm1.33.33.2" class="ltx_text ltx_font_typewriter">Update the policy network </span>
</div>
<div id="algorithm1.34.34" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.34.34.m1.1" class="ltx_Math" alttext="b\leftarrow b+(1-\lambda)r" display="inline"><semantics id="algorithm1.34.34.m1.1a"><mrow id="algorithm1.34.34.m1.1.1" xref="algorithm1.34.34.m1.1.1.cmml"><mi id="algorithm1.34.34.m1.1.1.3" xref="algorithm1.34.34.m1.1.1.3.cmml">b</mi><mo stretchy="false" id="algorithm1.34.34.m1.1.1.2" xref="algorithm1.34.34.m1.1.1.2.cmml">←</mo><mrow id="algorithm1.34.34.m1.1.1.1" xref="algorithm1.34.34.m1.1.1.1.cmml"><mi id="algorithm1.34.34.m1.1.1.1.3" xref="algorithm1.34.34.m1.1.1.1.3.cmml">b</mi><mo id="algorithm1.34.34.m1.1.1.1.2" xref="algorithm1.34.34.m1.1.1.1.2.cmml">+</mo><mrow id="algorithm1.34.34.m1.1.1.1.1" xref="algorithm1.34.34.m1.1.1.1.1.cmml"><mrow id="algorithm1.34.34.m1.1.1.1.1.1.1" xref="algorithm1.34.34.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.34.34.m1.1.1.1.1.1.1.2" xref="algorithm1.34.34.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="algorithm1.34.34.m1.1.1.1.1.1.1.1" xref="algorithm1.34.34.m1.1.1.1.1.1.1.1.cmml"><mn id="algorithm1.34.34.m1.1.1.1.1.1.1.1.2" xref="algorithm1.34.34.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="algorithm1.34.34.m1.1.1.1.1.1.1.1.1" xref="algorithm1.34.34.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="algorithm1.34.34.m1.1.1.1.1.1.1.1.3" xref="algorithm1.34.34.m1.1.1.1.1.1.1.1.3.cmml">λ</mi></mrow><mo stretchy="false" id="algorithm1.34.34.m1.1.1.1.1.1.1.3" xref="algorithm1.34.34.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="algorithm1.34.34.m1.1.1.1.1.2" xref="algorithm1.34.34.m1.1.1.1.1.2.cmml">​</mo><mi id="algorithm1.34.34.m1.1.1.1.1.3" xref="algorithm1.34.34.m1.1.1.1.1.3.cmml">r</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.34.34.m1.1b"><apply id="algorithm1.34.34.m1.1.1.cmml" xref="algorithm1.34.34.m1.1.1"><ci id="algorithm1.34.34.m1.1.1.2.cmml" xref="algorithm1.34.34.m1.1.1.2">←</ci><ci id="algorithm1.34.34.m1.1.1.3.cmml" xref="algorithm1.34.34.m1.1.1.3">𝑏</ci><apply id="algorithm1.34.34.m1.1.1.1.cmml" xref="algorithm1.34.34.m1.1.1.1"><plus id="algorithm1.34.34.m1.1.1.1.2.cmml" xref="algorithm1.34.34.m1.1.1.1.2"></plus><ci id="algorithm1.34.34.m1.1.1.1.3.cmml" xref="algorithm1.34.34.m1.1.1.1.3">𝑏</ci><apply id="algorithm1.34.34.m1.1.1.1.1.cmml" xref="algorithm1.34.34.m1.1.1.1.1"><times id="algorithm1.34.34.m1.1.1.1.1.2.cmml" xref="algorithm1.34.34.m1.1.1.1.1.2"></times><apply id="algorithm1.34.34.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.34.34.m1.1.1.1.1.1.1"><minus id="algorithm1.34.34.m1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.34.34.m1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="algorithm1.34.34.m1.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.34.34.m1.1.1.1.1.1.1.1.2">1</cn><ci id="algorithm1.34.34.m1.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.34.34.m1.1.1.1.1.1.1.1.3">𝜆</ci></apply><ci id="algorithm1.34.34.m1.1.1.1.1.3.cmml" xref="algorithm1.34.34.m1.1.1.1.1.3">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.34.34.m1.1c">b\leftarrow b+(1-\lambda)r</annotation></semantics></math> <span id="algorithm1.34.34.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm1.34.34.2" class="ltx_text ltx_font_typewriter">Update the baseline function </span>
</div>
<div id="algorithm1.34.42" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm1.34.43" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13</span> end for
</div>
<div id="algorithm1.34.44" class="ltx_listingline">

</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="algorithm1.36.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span>Training regime</figcaption>
</figure>
</section>
<section id="Pt0.A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">0.A.2 </span>Inference</h3>

<div id="Pt0.A1.SS2.p1" class="ltx_para">
<p id="Pt0.A1.SS2.p1.1" class="ltx_p">Beam search is used to infer the answer to a given question. Our inference approach is based on evaluating how likely specific
paths are appearing among all possible paths with a fixed length.
More specifically, given an input question, the agent’s initial location is given by the hub
node. At each time step, the agent scores the next permissible actions based on the
learned policy. The value of action represents the transition probability
from the current node to a target node. Next, we keep the top <math id="Pt0.A1.SS2.p1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="Pt0.A1.SS2.p1.1.m1.1a"><mi id="Pt0.A1.SS2.p1.1.m1.1.1" xref="Pt0.A1.SS2.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS2.p1.1.m1.1b"><ci id="Pt0.A1.SS2.p1.1.m1.1.1.cmml" xref="Pt0.A1.SS2.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS2.p1.1.m1.1c">k</annotation></semantics></math> (also known as
beam width) paths among all possible transitions and move the agent to the
corresponding targets. This computation is iteratively performed until the
maximum number of transitions is reached. In the end, we obtain multiple
rollouts ranked by the path probabilities. The target node (i.e. the last node)
of the path is regarded as an answer candidate. Unlike Monte Carlo sampling
which does not consider path probabilities, beam search yields better answer
candidates, as it always chooses the best choice within the search region.
The algorithm for inference is summarized in table <a href="#algorithm2" title="Algorithm 2 ‣ Inference Complexity ‣ 0.A.2 Inference ‣ Appendix 0.A Details on Model Training and Inference ‣ Graphhopper: Multi-Hop Scene Graph Reasoning for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<section id="Pt0.A1.SS2.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Inference Complexity</h4>

<div id="Pt0.A1.SS2.SSS0.Px1.p1" class="ltx_para">
<p id="Pt0.A1.SS2.SSS0.Px1.p1.7" class="ltx_p">The inference of our method is computationally efficient. Unlike other methods
that need to iterate through each candidate answer for a final prediction, we
only need to run the inference once so that the score of each answer is
obtained. Let <math id="Pt0.A1.SS2.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="Pt0.A1.SS2.SSS0.Px1.p1.1.m1.1a"><mi id="Pt0.A1.SS2.SSS0.Px1.p1.1.m1.1.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS2.SSS0.Px1.p1.1.m1.1b"><ci id="Pt0.A1.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS2.SSS0.Px1.p1.1.m1.1c">d</annotation></semantics></math> denote the embedding dimension of the words and entities.
Analytically, the embedding stage has asymptotic complexity <math id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4" class="ltx_Math" alttext="\mathcal{O}(|\mathcal{E}|+|\mathcal{R}|+|Q|)" display="inline"><semantics id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4a"><mrow id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.3" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.2.cmml">​</mo><mrow id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.cmml"><mo stretchy="false" id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.cmml">(</mo><mrow id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.cmml"><mrow id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.2.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.2.1.cmml"><mo stretchy="false" id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.2.2.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.1.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.1.1.cmml">ℰ</mi><mo stretchy="false" id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.2.2.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.2.1.1.cmml">|</mo></mrow><mo id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.1.cmml">+</mo><mrow id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.3.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.3.1.cmml"><mo stretchy="false" id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.3.2.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.2.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.2.2.cmml">ℛ</mi><mo stretchy="false" id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.3.2.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.3.1.1.cmml">|</mo></mrow><mo id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.1a" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.1.cmml">+</mo><mrow id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.4.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.4.1.cmml"><mo stretchy="false" id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.4.2.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.4.1.1.cmml">|</mo><mi id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.3.3" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.3.3.cmml">Q</mi><mo stretchy="false" id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.4.2.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.4.1.1.cmml">|</mo></mrow></mrow><mo stretchy="false" id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.3" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4b"><apply id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4"><times id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.2.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.2"></times><ci id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.3.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.3">𝒪</ci><apply id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1"><plus id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.1"></plus><apply id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.2.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.2.2"><abs id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.2.1.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.2.2.1"></abs><ci id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.1.1">ℰ</ci></apply><apply id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.3.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.3.2"><abs id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.3.1.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.3.2.1"></abs><ci id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.2.2.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.2.2">ℛ</ci></apply><apply id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.4.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.4.2"><abs id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.4.1.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4.4.1.1.1.4.2.1"></abs><ci id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.3.3.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.3.3">𝑄</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS2.SSS0.Px1.p1.2.m2.4c">\mathcal{O}(|\mathcal{E}|+|\mathcal{R}|+|Q|)</annotation></semantics></math>. For the GAT, the implementation of a single attention head
and multi-head attention is similar. In particular, they have the same time
complexity <math id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3" class="ltx_Math" alttext="\mathcal{O}(|\mathcal{E}|dd^{{}^{\prime}}+|\mathcal{R}|d^{{}^{\prime}})" display="inline"><semantics id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3a"><mrow id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.3" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.2.cmml">​</mo><mrow id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.cmml"><mo stretchy="false" id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.cmml">(</mo><mrow id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.cmml"><mrow id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.cmml"><mrow id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.2.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.2.1.cmml"><mo stretchy="false" id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.2.2.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.1.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.1.1.cmml">ℰ</mi><mo stretchy="false" id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.2.2.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.2.1.1.cmml">|</mo></mrow><mo lspace="0em" rspace="0em" id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.1.cmml">​</mo><mi id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.3" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.1a" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.1.cmml">​</mo><msup id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.4" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.4.cmml"><mi id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.4.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.4.2.cmml">d</mi><msup id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.4.3" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.4.3.cmml"><mi id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.4.3a" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.4.3.cmml"></mi><mo id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.4.3.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.4.3.1.cmml">′</mo></msup></msup></mrow><mo id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.cmml">+</mo><mrow id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.cmml"><mrow id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.2.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.2.1.cmml"><mo stretchy="false" id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.2.2.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.2.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.2.2.cmml">ℛ</mi><mo stretchy="false" id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.2.2.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.2.1.1.cmml">|</mo></mrow><mo lspace="0em" rspace="0em" id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.1.cmml">​</mo><msup id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.3" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.3.cmml"><mi id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.3.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.3.2.cmml">d</mi><msup id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.3.3" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.3.3.cmml"><mi id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.3.3a" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.3.3.cmml"></mi><mo id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.3.3.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.3.3.1.cmml">′</mo></msup></msup></mrow></mrow><mo stretchy="false" id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.3" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3b"><apply id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3"><times id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.2.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.2"></times><ci id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.3.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.3">𝒪</ci><apply id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1"><plus id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.1"></plus><apply id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2"><times id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.1"></times><apply id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.2.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.2.2"><abs id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.2.1.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.2.2.1"></abs><ci id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.1.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.1.1">ℰ</ci></apply><ci id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.3.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.3">𝑑</ci><apply id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.4.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.4"><csymbol cd="ambiguous" id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.4.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.4">superscript</csymbol><ci id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.4.2.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.4.2">𝑑</ci><apply id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.4.3.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.4.3"><ci id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.4.3.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.2.4.3.1">′</ci></apply></apply></apply><apply id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3"><times id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.1"></times><apply id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.2.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.2.2"><abs id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.2.1.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.2.2.1"></abs><ci id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.2.2.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.2.2">ℛ</ci></apply><apply id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.3.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.3.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.3">superscript</csymbol><ci id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.3.2.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.3.2">𝑑</ci><apply id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.3.3.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.3.3"><ci id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.3.3.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.3.3.3.1">′</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS2.SSS0.Px1.p1.3.m3.3c">\mathcal{O}(|\mathcal{E}|dd^{{}^{\prime}}+|\mathcal{R}|d^{{}^{\prime}})</annotation></semantics></math>. The
computation of the question encoding is given by <math id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2" class="ltx_Math" alttext="\mathcal{O}(|\mathcal{Q}|^{2}d)" display="inline"><semantics id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2a"><mrow id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.3" xref="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.2.cmml">​</mo><mrow id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.cmml"><mo stretchy="false" id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.cmml">(</mo><mrow id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.cmml"><msup id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.2.cmml"><mrow id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.2.2.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.2.2.1.cmml"><mo stretchy="false" id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.2.2.2.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.1.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.1.1.cmml">𝒬</mi><mo stretchy="false" id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.2.2.2.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.2.2.1.1.cmml">|</mo></mrow><mn id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.2.3" xref="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.2.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.1.cmml">​</mo><mi id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.3" xref="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.3.cmml">d</mi></mrow><mo stretchy="false" id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.3" xref="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2b"><apply id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2"><times id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.2.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.2"></times><ci id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.3.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.3">𝒪</ci><apply id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1"><times id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.1"></times><apply id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.2.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.2"><csymbol cd="ambiguous" id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.2.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.2">superscript</csymbol><apply id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.2.2.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.2.2.2"><abs id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.2.2.1.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.2.2.2.1"></abs><ci id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.1.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.1.1">𝒬</ci></apply><cn type="integer" id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.2.3.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.2.3">2</cn></apply><ci id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.3.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2.2.1.1.1.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS2.SSS0.Px1.p1.4.m4.2c">\mathcal{O}(|\mathcal{Q}|^{2}d)</annotation></semantics></math>. It
is efficient as it only runs once for each question and is used for arbitrary times
during random walks. Also, the length of the questions <math id="Pt0.A1.SS2.SSS0.Px1.p1.5.m5.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="Pt0.A1.SS2.SSS0.Px1.p1.5.m5.1a"><mi id="Pt0.A1.SS2.SSS0.Px1.p1.5.m5.1.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.5.m5.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS2.SSS0.Px1.p1.5.m5.1b"><ci id="Pt0.A1.SS2.SSS0.Px1.p1.5.m5.1.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.5.m5.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS2.SSS0.Px1.p1.5.m5.1c">Q</annotation></semantics></math> is usually short (less than 30 words).
Finally, during the random walk sampling, the agents complxity is given by <math id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2" class="ltx_Math" alttext="\mathcal{O}(T(D^{2}+|\mathcal{E}|d))" display="inline"><semantics id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2a"><mrow id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.3" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.2.cmml">​</mo><mrow id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.cmml"><mo stretchy="false" id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.cmml">(</mo><mrow id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.cmml"><mi id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.3" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.3.cmml">T</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.cmml">​</mo><mrow id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.cmml"><msup id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.2.cmml"><mi id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.2.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.2.2.cmml">D</mi><mn id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.2.3" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.2.3.cmml">2</mn></msup><mo id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.1.cmml">+</mo><mrow id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.cmml"><mrow id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.2.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.2.1.cmml"><mo stretchy="false" id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.2.2.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.1.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.1.1.cmml">ℰ</mi><mo stretchy="false" id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.2.2.2" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.2.1.1.cmml">|</mo></mrow><mo lspace="0em" rspace="0em" id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.3" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.3.cmml">d</mi></mrow></mrow><mo stretchy="false" id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.3" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.3" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2b"><apply id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2"><times id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.2.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.2"></times><ci id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.3.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.3">𝒪</ci><apply id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1"><times id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.2"></times><ci id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.3.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.3">𝑇</ci><apply id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1"><plus id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.1"></plus><apply id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.2.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.2.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.2">superscript</csymbol><ci id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.2.2.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.2.2">𝐷</ci><cn type="integer" id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.2.3.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.2.3">2</cn></apply><apply id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3"><times id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.1"></times><apply id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.2.2"><abs id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.2.1.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.2.2.1"></abs><ci id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.1.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.1.1">ℰ</ci></apply><ci id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.3.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2.2.1.1.1.1.1.1.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS2.SSS0.Px1.p1.6.m6.2c">\mathcal{O}(T(D^{2}+|\mathcal{E}|d))</annotation></semantics></math>, where <math id="Pt0.A1.SS2.SSS0.Px1.p1.7.m7.1" class="ltx_Math" alttext="d" display="inline"><semantics id="Pt0.A1.SS2.SSS0.Px1.p1.7.m7.1a"><mi id="Pt0.A1.SS2.SSS0.Px1.p1.7.m7.1.1" xref="Pt0.A1.SS2.SSS0.Px1.p1.7.m7.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS2.SSS0.Px1.p1.7.m7.1b"><ci id="Pt0.A1.SS2.SSS0.Px1.p1.7.m7.1.1.cmml" xref="Pt0.A1.SS2.SSS0.Px1.p1.7.m7.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS2.SSS0.Px1.p1.7.m7.1c">d</annotation></semantics></math> is dominant. The inference time depends largely on the path length.</p>
</div>
<figure id="algorithm2" class="ltx_float ltx_algorithm">
<div id="algorithm2.27" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="algorithm2.2.2" class="ltx_listingline">
<span id="algorithm2.2.2.1" class="ltx_text"><span id="algorithm2.2.2.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>Question <math id="algorithm2.1.1.m1.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="algorithm2.1.1.m1.1a"><mi id="algorithm2.1.1.m1.1.1" xref="algorithm2.1.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="algorithm2.1.1.m1.1b"><ci id="algorithm2.1.1.m1.1.1.cmml" xref="algorithm2.1.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.1.1.m1.1c">Q</annotation></semantics></math>, Scene graph <math id="algorithm2.2.2.m2.1" class="ltx_Math" alttext="\mathcal{SG}\subset\mathcal{E}\times\mathcal{R}\times\mathcal{E}" display="inline"><semantics id="algorithm2.2.2.m2.1a"><mrow id="algorithm2.2.2.m2.1.1" xref="algorithm2.2.2.m2.1.1.cmml"><mrow id="algorithm2.2.2.m2.1.1.2" xref="algorithm2.2.2.m2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.2.2.m2.1.1.2.2" xref="algorithm2.2.2.m2.1.1.2.2.cmml">𝒮</mi><mo lspace="0em" rspace="0em" id="algorithm2.2.2.m2.1.1.2.1" xref="algorithm2.2.2.m2.1.1.2.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="algorithm2.2.2.m2.1.1.2.3" xref="algorithm2.2.2.m2.1.1.2.3.cmml">𝒢</mi></mrow><mo id="algorithm2.2.2.m2.1.1.1" xref="algorithm2.2.2.m2.1.1.1.cmml">⊂</mo><mrow id="algorithm2.2.2.m2.1.1.3" xref="algorithm2.2.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.2.2.m2.1.1.3.2" xref="algorithm2.2.2.m2.1.1.3.2.cmml">ℰ</mi><mo lspace="0.222em" rspace="0.222em" id="algorithm2.2.2.m2.1.1.3.1" xref="algorithm2.2.2.m2.1.1.3.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="algorithm2.2.2.m2.1.1.3.3" xref="algorithm2.2.2.m2.1.1.3.3.cmml">ℛ</mi><mo lspace="0.222em" rspace="0.222em" id="algorithm2.2.2.m2.1.1.3.1a" xref="algorithm2.2.2.m2.1.1.3.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="algorithm2.2.2.m2.1.1.3.4" xref="algorithm2.2.2.m2.1.1.3.4.cmml">ℰ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.2.2.m2.1b"><apply id="algorithm2.2.2.m2.1.1.cmml" xref="algorithm2.2.2.m2.1.1"><subset id="algorithm2.2.2.m2.1.1.1.cmml" xref="algorithm2.2.2.m2.1.1.1"></subset><apply id="algorithm2.2.2.m2.1.1.2.cmml" xref="algorithm2.2.2.m2.1.1.2"><times id="algorithm2.2.2.m2.1.1.2.1.cmml" xref="algorithm2.2.2.m2.1.1.2.1"></times><ci id="algorithm2.2.2.m2.1.1.2.2.cmml" xref="algorithm2.2.2.m2.1.1.2.2">𝒮</ci><ci id="algorithm2.2.2.m2.1.1.2.3.cmml" xref="algorithm2.2.2.m2.1.1.2.3">𝒢</ci></apply><apply id="algorithm2.2.2.m2.1.1.3.cmml" xref="algorithm2.2.2.m2.1.1.3"><times id="algorithm2.2.2.m2.1.1.3.1.cmml" xref="algorithm2.2.2.m2.1.1.3.1"></times><ci id="algorithm2.2.2.m2.1.1.3.2.cmml" xref="algorithm2.2.2.m2.1.1.3.2">ℰ</ci><ci id="algorithm2.2.2.m2.1.1.3.3.cmml" xref="algorithm2.2.2.m2.1.1.3.3">ℛ</ci><ci id="algorithm2.2.2.m2.1.1.3.4.cmml" xref="algorithm2.2.2.m2.1.1.3.4">ℰ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.2.2.m2.1c">\mathcal{SG}\subset\mathcal{E}\times\mathcal{R}\times\mathcal{E}</annotation></semantics></math>
</div>
<div id="algorithm2.27.28" class="ltx_listingline">
<span id="algorithm2.27.28.1" class="ltx_text"><span id="algorithm2.27.28.1.1" class="ltx_text ltx_font_bold">Output:</span> </span>Answer
</div>
<div id="algorithm2.4.4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span>
Initialize <math id="algorithm2.3.3.m1.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="algorithm2.3.3.m1.1a"><mi id="algorithm2.3.3.m1.1.1" xref="algorithm2.3.3.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="algorithm2.3.3.m1.1b"><ci id="algorithm2.3.3.m1.1.1.cmml" xref="algorithm2.3.3.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.3.3.m1.1c">Q</annotation></semantics></math> and <math id="algorithm2.4.4.m2.1" class="ltx_Math" alttext="\mathcal{SG}" display="inline"><semantics id="algorithm2.4.4.m2.1a"><mrow id="algorithm2.4.4.m2.1.1" xref="algorithm2.4.4.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.4.4.m2.1.1.2" xref="algorithm2.4.4.m2.1.1.2.cmml">𝒮</mi><mo lspace="0em" rspace="0em" id="algorithm2.4.4.m2.1.1.1" xref="algorithm2.4.4.m2.1.1.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="algorithm2.4.4.m2.1.1.3" xref="algorithm2.4.4.m2.1.1.3.cmml">𝒢</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.4.4.m2.1b"><apply id="algorithm2.4.4.m2.1.1.cmml" xref="algorithm2.4.4.m2.1.1"><times id="algorithm2.4.4.m2.1.1.1.cmml" xref="algorithm2.4.4.m2.1.1.1"></times><ci id="algorithm2.4.4.m2.1.1.2.cmml" xref="algorithm2.4.4.m2.1.1.2">𝒮</ci><ci id="algorithm2.4.4.m2.1.1.3.cmml" xref="algorithm2.4.4.m2.1.1.3">𝒢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.4.4.m2.1c">\mathcal{SG}</annotation></semantics></math> with GloVe embeddings;
</div>
<div id="algorithm2.5.5" class="ltx_listingline">
<math id="algorithm2.5.5.m1.1" class="ltx_Math" alttext="Q\leftarrow\mbox{GAT}(Q)" display="inline"><semantics id="algorithm2.5.5.m1.1a"><mrow id="algorithm2.5.5.m1.1.2" xref="algorithm2.5.5.m1.1.2.cmml"><mi id="algorithm2.5.5.m1.1.2.2" xref="algorithm2.5.5.m1.1.2.2.cmml">Q</mi><mo stretchy="false" id="algorithm2.5.5.m1.1.2.1" xref="algorithm2.5.5.m1.1.2.1.cmml">←</mo><mrow id="algorithm2.5.5.m1.1.2.3" xref="algorithm2.5.5.m1.1.2.3.cmml"><mtext id="algorithm2.5.5.m1.1.2.3.2" xref="algorithm2.5.5.m1.1.2.3.2a.cmml">GAT</mtext><mo lspace="0em" rspace="0em" id="algorithm2.5.5.m1.1.2.3.1" xref="algorithm2.5.5.m1.1.2.3.1.cmml">​</mo><mrow id="algorithm2.5.5.m1.1.2.3.3.2" xref="algorithm2.5.5.m1.1.2.3.cmml"><mo stretchy="false" id="algorithm2.5.5.m1.1.2.3.3.2.1" xref="algorithm2.5.5.m1.1.2.3.cmml">(</mo><mi id="algorithm2.5.5.m1.1.1" xref="algorithm2.5.5.m1.1.1.cmml">Q</mi><mo stretchy="false" id="algorithm2.5.5.m1.1.2.3.3.2.2" xref="algorithm2.5.5.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.5.5.m1.1b"><apply id="algorithm2.5.5.m1.1.2.cmml" xref="algorithm2.5.5.m1.1.2"><ci id="algorithm2.5.5.m1.1.2.1.cmml" xref="algorithm2.5.5.m1.1.2.1">←</ci><ci id="algorithm2.5.5.m1.1.2.2.cmml" xref="algorithm2.5.5.m1.1.2.2">𝑄</ci><apply id="algorithm2.5.5.m1.1.2.3.cmml" xref="algorithm2.5.5.m1.1.2.3"><times id="algorithm2.5.5.m1.1.2.3.1.cmml" xref="algorithm2.5.5.m1.1.2.3.1"></times><ci id="algorithm2.5.5.m1.1.2.3.2a.cmml" xref="algorithm2.5.5.m1.1.2.3.2"><mtext id="algorithm2.5.5.m1.1.2.3.2.cmml" xref="algorithm2.5.5.m1.1.2.3.2">GAT</mtext></ci><ci id="algorithm2.5.5.m1.1.1.cmml" xref="algorithm2.5.5.m1.1.1">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.5.5.m1.1c">Q\leftarrow\mbox{GAT}(Q)</annotation></semantics></math> <span id="algorithm2.5.5.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm2.5.5.2" class="ltx_text ltx_font_typewriter">Update the question with the question encoder </span>
</div>
<div id="algorithm2.6.6" class="ltx_listingline">
<math id="algorithm2.6.6.m1.1" class="ltx_Math" alttext="\mathcal{SG}\leftarrow\mbox{Transformer}(\mathcal{SG})" display="inline"><semantics id="algorithm2.6.6.m1.1a"><mrow id="algorithm2.6.6.m1.1.1" xref="algorithm2.6.6.m1.1.1.cmml"><mrow id="algorithm2.6.6.m1.1.1.3" xref="algorithm2.6.6.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.6.6.m1.1.1.3.2" xref="algorithm2.6.6.m1.1.1.3.2.cmml">𝒮</mi><mo lspace="0em" rspace="0em" id="algorithm2.6.6.m1.1.1.3.1" xref="algorithm2.6.6.m1.1.1.3.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="algorithm2.6.6.m1.1.1.3.3" xref="algorithm2.6.6.m1.1.1.3.3.cmml">𝒢</mi></mrow><mo stretchy="false" id="algorithm2.6.6.m1.1.1.2" xref="algorithm2.6.6.m1.1.1.2.cmml">←</mo><mrow id="algorithm2.6.6.m1.1.1.1" xref="algorithm2.6.6.m1.1.1.1.cmml"><mtext id="algorithm2.6.6.m1.1.1.1.3" xref="algorithm2.6.6.m1.1.1.1.3a.cmml">Transformer</mtext><mo lspace="0em" rspace="0em" id="algorithm2.6.6.m1.1.1.1.2" xref="algorithm2.6.6.m1.1.1.1.2.cmml">​</mo><mrow id="algorithm2.6.6.m1.1.1.1.1.1" xref="algorithm2.6.6.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm2.6.6.m1.1.1.1.1.1.2" xref="algorithm2.6.6.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="algorithm2.6.6.m1.1.1.1.1.1.1" xref="algorithm2.6.6.m1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.6.6.m1.1.1.1.1.1.1.2" xref="algorithm2.6.6.m1.1.1.1.1.1.1.2.cmml">𝒮</mi><mo lspace="0em" rspace="0em" id="algorithm2.6.6.m1.1.1.1.1.1.1.1" xref="algorithm2.6.6.m1.1.1.1.1.1.1.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="algorithm2.6.6.m1.1.1.1.1.1.1.3" xref="algorithm2.6.6.m1.1.1.1.1.1.1.3.cmml">𝒢</mi></mrow><mo stretchy="false" id="algorithm2.6.6.m1.1.1.1.1.1.3" xref="algorithm2.6.6.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.6.6.m1.1b"><apply id="algorithm2.6.6.m1.1.1.cmml" xref="algorithm2.6.6.m1.1.1"><ci id="algorithm2.6.6.m1.1.1.2.cmml" xref="algorithm2.6.6.m1.1.1.2">←</ci><apply id="algorithm2.6.6.m1.1.1.3.cmml" xref="algorithm2.6.6.m1.1.1.3"><times id="algorithm2.6.6.m1.1.1.3.1.cmml" xref="algorithm2.6.6.m1.1.1.3.1"></times><ci id="algorithm2.6.6.m1.1.1.3.2.cmml" xref="algorithm2.6.6.m1.1.1.3.2">𝒮</ci><ci id="algorithm2.6.6.m1.1.1.3.3.cmml" xref="algorithm2.6.6.m1.1.1.3.3">𝒢</ci></apply><apply id="algorithm2.6.6.m1.1.1.1.cmml" xref="algorithm2.6.6.m1.1.1.1"><times id="algorithm2.6.6.m1.1.1.1.2.cmml" xref="algorithm2.6.6.m1.1.1.1.2"></times><ci id="algorithm2.6.6.m1.1.1.1.3a.cmml" xref="algorithm2.6.6.m1.1.1.1.3"><mtext id="algorithm2.6.6.m1.1.1.1.3.cmml" xref="algorithm2.6.6.m1.1.1.1.3">Transformer</mtext></ci><apply id="algorithm2.6.6.m1.1.1.1.1.1.1.cmml" xref="algorithm2.6.6.m1.1.1.1.1.1"><times id="algorithm2.6.6.m1.1.1.1.1.1.1.1.cmml" xref="algorithm2.6.6.m1.1.1.1.1.1.1.1"></times><ci id="algorithm2.6.6.m1.1.1.1.1.1.1.2.cmml" xref="algorithm2.6.6.m1.1.1.1.1.1.1.2">𝒮</ci><ci id="algorithm2.6.6.m1.1.1.1.1.1.1.3.cmml" xref="algorithm2.6.6.m1.1.1.1.1.1.1.3">𝒢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.6.6.m1.1c">\mathcal{SG}\leftarrow\mbox{Transformer}(\mathcal{SG})</annotation></semantics></math> <span id="algorithm2.6.6.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm2.6.6.2" class="ltx_text ltx_font_typewriter">Update the SG with the graph encoder. </span>
</div>
<div id="algorithm2.7.7" class="ltx_listingline">
<math id="algorithm2.7.7.m1.1" class="ltx_Math" alttext="P\leftarrow[]" display="inline"><semantics id="algorithm2.7.7.m1.1a"><mrow id="algorithm2.7.7.m1.1.1" xref="algorithm2.7.7.m1.1.1.cmml"><mi id="algorithm2.7.7.m1.1.1.2" xref="algorithm2.7.7.m1.1.1.2.cmml">P</mi><mo stretchy="false" id="algorithm2.7.7.m1.1.1.1" xref="algorithm2.7.7.m1.1.1.1.cmml">←</mo><mrow id="algorithm2.7.7.m1.1.1.3.2" xref="algorithm2.7.7.m1.1.1.cmml"><mo stretchy="false" id="algorithm2.7.7.m1.1.1.3.2.1" xref="algorithm2.7.7.m1.1.1.3.1.cmml">[</mo><mo stretchy="false" id="algorithm2.7.7.m1.1.1.3.2.2" xref="algorithm2.7.7.m1.1.1.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.7.7.m1.1b"><apply id="algorithm2.7.7.m1.1.1.cmml" xref="algorithm2.7.7.m1.1.1"><ci id="algorithm2.7.7.m1.1.1.1.cmml" xref="algorithm2.7.7.m1.1.1.1">←</ci><ci id="algorithm2.7.7.m1.1.1.2.cmml" xref="algorithm2.7.7.m1.1.1.2">𝑃</ci><list id="algorithm2.7.7.m1.1.1.3.1.cmml" xref="algorithm2.7.7.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.7.7.m1.1c">P\leftarrow[]</annotation></semantics></math> <span id="algorithm2.7.7.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm2.7.7.2" class="ltx_text ltx_font_typewriter">Initialize the probability register </span>
</div>
<div id="algorithm2.8.8" class="ltx_listingline">
<math id="algorithm2.8.8.m1.1" class="ltx_Math" alttext="\tau\leftarrow[]" display="inline"><semantics id="algorithm2.8.8.m1.1a"><mrow id="algorithm2.8.8.m1.1.1" xref="algorithm2.8.8.m1.1.1.cmml"><mi id="algorithm2.8.8.m1.1.1.2" xref="algorithm2.8.8.m1.1.1.2.cmml">τ</mi><mo stretchy="false" id="algorithm2.8.8.m1.1.1.1" xref="algorithm2.8.8.m1.1.1.1.cmml">←</mo><mrow id="algorithm2.8.8.m1.1.1.3.2" xref="algorithm2.8.8.m1.1.1.cmml"><mo stretchy="false" id="algorithm2.8.8.m1.1.1.3.2.1" xref="algorithm2.8.8.m1.1.1.3.1.cmml">[</mo><mo stretchy="false" id="algorithm2.8.8.m1.1.1.3.2.2" xref="algorithm2.8.8.m1.1.1.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.8.8.m1.1b"><apply id="algorithm2.8.8.m1.1.1.cmml" xref="algorithm2.8.8.m1.1.1"><ci id="algorithm2.8.8.m1.1.1.1.cmml" xref="algorithm2.8.8.m1.1.1.1">←</ci><ci id="algorithm2.8.8.m1.1.1.2.cmml" xref="algorithm2.8.8.m1.1.1.2">𝜏</ci><list id="algorithm2.8.8.m1.1.1.3.1.cmml" xref="algorithm2.8.8.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.8.8.m1.1c">\tau\leftarrow[]</annotation></semantics></math> <span id="algorithm2.8.8.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm2.8.8.2" class="ltx_text ltx_font_typewriter">Initialize the trajectory </span>
</div>
<div id="algorithm2.9.9" class="ltx_listingline">
<math id="algorithm2.9.9.m1.1" class="ltx_Math" alttext="E_{0}\leftarrow" display="inline"><semantics id="algorithm2.9.9.m1.1a"><mrow id="algorithm2.9.9.m1.1.1" xref="algorithm2.9.9.m1.1.1.cmml"><msub id="algorithm2.9.9.m1.1.1.2" xref="algorithm2.9.9.m1.1.1.2.cmml"><mi id="algorithm2.9.9.m1.1.1.2.2" xref="algorithm2.9.9.m1.1.1.2.2.cmml">E</mi><mn id="algorithm2.9.9.m1.1.1.2.3" xref="algorithm2.9.9.m1.1.1.2.3.cmml">0</mn></msub><mo stretchy="false" id="algorithm2.9.9.m1.1.1.1" xref="algorithm2.9.9.m1.1.1.1.cmml">←</mo><mi id="algorithm2.9.9.m1.1.1.3" xref="algorithm2.9.9.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.9.9.m1.1b"><apply id="algorithm2.9.9.m1.1.1.cmml" xref="algorithm2.9.9.m1.1.1"><ci id="algorithm2.9.9.m1.1.1.1.cmml" xref="algorithm2.9.9.m1.1.1.1">←</ci><apply id="algorithm2.9.9.m1.1.1.2.cmml" xref="algorithm2.9.9.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm2.9.9.m1.1.1.2.1.cmml" xref="algorithm2.9.9.m1.1.1.2">subscript</csymbol><ci id="algorithm2.9.9.m1.1.1.2.2.cmml" xref="algorithm2.9.9.m1.1.1.2.2">𝐸</ci><cn type="integer" id="algorithm2.9.9.m1.1.1.2.3.cmml" xref="algorithm2.9.9.m1.1.1.2.3">0</cn></apply><csymbol cd="latexml" id="algorithm2.9.9.m1.1.1.3.cmml" xref="algorithm2.9.9.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.9.9.m1.1c">E_{0}\leftarrow</annotation></semantics></math> hub <span id="algorithm2.9.9.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm2.9.9.2" class="ltx_text ltx_font_typewriter">Initialize the start position </span>
</div>
<div id="algorithm2.10.10" class="ltx_listingline">
<math id="algorithm2.10.10.m1.1" class="ltx_Math" alttext="A_{0}\leftarrow" display="inline"><semantics id="algorithm2.10.10.m1.1a"><mrow id="algorithm2.10.10.m1.1.1" xref="algorithm2.10.10.m1.1.1.cmml"><msub id="algorithm2.10.10.m1.1.1.2" xref="algorithm2.10.10.m1.1.1.2.cmml"><mi id="algorithm2.10.10.m1.1.1.2.2" xref="algorithm2.10.10.m1.1.1.2.2.cmml">A</mi><mn id="algorithm2.10.10.m1.1.1.2.3" xref="algorithm2.10.10.m1.1.1.2.3.cmml">0</mn></msub><mo stretchy="false" id="algorithm2.10.10.m1.1.1.1" xref="algorithm2.10.10.m1.1.1.1.cmml">←</mo><mi id="algorithm2.10.10.m1.1.1.3" xref="algorithm2.10.10.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.10.10.m1.1b"><apply id="algorithm2.10.10.m1.1.1.cmml" xref="algorithm2.10.10.m1.1.1"><ci id="algorithm2.10.10.m1.1.1.1.cmml" xref="algorithm2.10.10.m1.1.1.1">←</ci><apply id="algorithm2.10.10.m1.1.1.2.cmml" xref="algorithm2.10.10.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm2.10.10.m1.1.1.2.1.cmml" xref="algorithm2.10.10.m1.1.1.2">subscript</csymbol><ci id="algorithm2.10.10.m1.1.1.2.2.cmml" xref="algorithm2.10.10.m1.1.1.2.2">𝐴</ci><cn type="integer" id="algorithm2.10.10.m1.1.1.2.3.cmml" xref="algorithm2.10.10.m1.1.1.2.3">0</cn></apply><csymbol cd="latexml" id="algorithm2.10.10.m1.1.1.3.cmml" xref="algorithm2.10.10.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.10.10.m1.1c">A_{0}\leftarrow</annotation></semantics></math> dummy <span id="algorithm2.10.10.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm2.10.10.2" class="ltx_text ltx_font_typewriter">Initialize the dummy start action </span>
</div>
<div id="algorithm2.12.12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span>
<span id="algorithm2.12.12.3" class="ltx_text ltx_font_bold">for</span> <em id="algorithm2.12.12.2" class="ltx_emph ltx_font_italic"><math id="algorithm2.11.11.1.m1.1" class="ltx_Math" alttext="t\leftarrow 0" display="inline"><semantics id="algorithm2.11.11.1.m1.1a"><mrow id="algorithm2.11.11.1.m1.1.1" xref="algorithm2.11.11.1.m1.1.1.cmml"><mi id="algorithm2.11.11.1.m1.1.1.2" xref="algorithm2.11.11.1.m1.1.1.2.cmml">t</mi><mo stretchy="false" id="algorithm2.11.11.1.m1.1.1.1" xref="algorithm2.11.11.1.m1.1.1.1.cmml">←</mo><mn id="algorithm2.11.11.1.m1.1.1.3" xref="algorithm2.11.11.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.11.11.1.m1.1b"><apply id="algorithm2.11.11.1.m1.1.1.cmml" xref="algorithm2.11.11.1.m1.1.1"><ci id="algorithm2.11.11.1.m1.1.1.1.cmml" xref="algorithm2.11.11.1.m1.1.1.1">←</ci><ci id="algorithm2.11.11.1.m1.1.1.2.cmml" xref="algorithm2.11.11.1.m1.1.1.2">𝑡</ci><cn type="integer" id="algorithm2.11.11.1.m1.1.1.3.cmml" xref="algorithm2.11.11.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.11.11.1.m1.1c">t\leftarrow 0</annotation></semantics></math> <span id="algorithm2.12.12.2.1" class="ltx_text ltx_font_bold ltx_font_upright">to</span> <math id="algorithm2.12.12.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="algorithm2.12.12.2.m2.1a"><mi id="algorithm2.12.12.2.m2.1.1" xref="algorithm2.12.12.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="algorithm2.12.12.2.m2.1b"><ci id="algorithm2.12.12.2.m2.1.1.cmml" xref="algorithm2.12.12.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.12.12.2.m2.1c">T</annotation></semantics></math></em> <span id="algorithm2.12.12.4" class="ltx_text ltx_font_bold">do</span> <span id="algorithm2.12.12.5" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm2.12.12.6" class="ltx_text ltx_font_typewriter">Loop over time steps </span> 
</div>
<div id="algorithm2.14.14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm2.14.14.3" class="ltx_text ltx_font_bold">for</span> <em id="algorithm2.14.14.2" class="ltx_emph ltx_font_italic"><math id="algorithm2.13.13.1.m1.1" class="ltx_Math" alttext="r\leftarrow 0" display="inline"><semantics id="algorithm2.13.13.1.m1.1a"><mrow id="algorithm2.13.13.1.m1.1.1" xref="algorithm2.13.13.1.m1.1.1.cmml"><mi id="algorithm2.13.13.1.m1.1.1.2" xref="algorithm2.13.13.1.m1.1.1.2.cmml">r</mi><mo stretchy="false" id="algorithm2.13.13.1.m1.1.1.1" xref="algorithm2.13.13.1.m1.1.1.1.cmml">←</mo><mn id="algorithm2.13.13.1.m1.1.1.3" xref="algorithm2.13.13.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.13.13.1.m1.1b"><apply id="algorithm2.13.13.1.m1.1.1.cmml" xref="algorithm2.13.13.1.m1.1.1"><ci id="algorithm2.13.13.1.m1.1.1.1.cmml" xref="algorithm2.13.13.1.m1.1.1.1">←</ci><ci id="algorithm2.13.13.1.m1.1.1.2.cmml" xref="algorithm2.13.13.1.m1.1.1.2">𝑟</ci><cn type="integer" id="algorithm2.13.13.1.m1.1.1.3.cmml" xref="algorithm2.13.13.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.13.13.1.m1.1c">r\leftarrow 0</annotation></semantics></math> <span id="algorithm2.14.14.2.1" class="ltx_text ltx_font_bold ltx_font_upright">to</span> <math id="algorithm2.14.14.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="algorithm2.14.14.2.m2.1a"><mi id="algorithm2.14.14.2.m2.1.1" xref="algorithm2.14.14.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="algorithm2.14.14.2.m2.1b"><ci id="algorithm2.14.14.2.m2.1.1.cmml" xref="algorithm2.14.14.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.14.14.2.m2.1c">N</annotation></semantics></math></em> <span id="algorithm2.14.14.4" class="ltx_text ltx_font_bold">do</span> <span id="algorithm2.14.14.5" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm2.14.14.6" class="ltx_text ltx_font_typewriter">Loop over rollouts </span> 
</div>
<div id="algorithm2.15.15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm2.15.15.2" class="ltx_text ltx_font_bold">if</span> <em id="algorithm2.15.15.1" class="ltx_emph ltx_font_italic"><math id="algorithm2.15.15.1.m1.1" class="ltx_math_unparsed" alttext="t\%\Delta==0" display="inline"><semantics id="algorithm2.15.15.1.m1.1a"><mrow id="algorithm2.15.15.1.m1.1b"><mi id="algorithm2.15.15.1.m1.1.1">t</mi><mo id="algorithm2.15.15.1.m1.1.2">%</mo><mi mathvariant="normal" id="algorithm2.15.15.1.m1.1.3">Δ</mi><mo rspace="0em" id="algorithm2.15.15.1.m1.1.4">=</mo><mo lspace="0em" id="algorithm2.15.15.1.m1.1.5">=</mo><mn id="algorithm2.15.15.1.m1.1.6">0</mn></mrow><annotation encoding="application/x-tex" id="algorithm2.15.15.1.m1.1c">t\%\Delta==0</annotation></semantics></math></em> <span id="algorithm2.15.15.3" class="ltx_text ltx_font_bold">then</span> <span id="algorithm2.15.15.4" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm2.15.15.5" class="ltx_text ltx_font_typewriter">Restart and prompt the agent to the hub node </span> 
</div>
<div id="algorithm2.27.29" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm2.27.29.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm2.27.29.2" class="ltx_text ltx_font_typewriter">so that the agent is aware of its own action </span>
</div>
<div id="algorithm2.16.16" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm2.16.16.m1.1" class="ltx_Math" alttext="E_{t+1}\leftarrow" display="inline"><semantics id="algorithm2.16.16.m1.1a"><mrow id="algorithm2.16.16.m1.1.1" xref="algorithm2.16.16.m1.1.1.cmml"><msub id="algorithm2.16.16.m1.1.1.2" xref="algorithm2.16.16.m1.1.1.2.cmml"><mi id="algorithm2.16.16.m1.1.1.2.2" xref="algorithm2.16.16.m1.1.1.2.2.cmml">E</mi><mrow id="algorithm2.16.16.m1.1.1.2.3" xref="algorithm2.16.16.m1.1.1.2.3.cmml"><mi id="algorithm2.16.16.m1.1.1.2.3.2" xref="algorithm2.16.16.m1.1.1.2.3.2.cmml">t</mi><mo id="algorithm2.16.16.m1.1.1.2.3.1" xref="algorithm2.16.16.m1.1.1.2.3.1.cmml">+</mo><mn id="algorithm2.16.16.m1.1.1.2.3.3" xref="algorithm2.16.16.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="algorithm2.16.16.m1.1.1.1" xref="algorithm2.16.16.m1.1.1.1.cmml">←</mo><mi id="algorithm2.16.16.m1.1.1.3" xref="algorithm2.16.16.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.16.16.m1.1b"><apply id="algorithm2.16.16.m1.1.1.cmml" xref="algorithm2.16.16.m1.1.1"><ci id="algorithm2.16.16.m1.1.1.1.cmml" xref="algorithm2.16.16.m1.1.1.1">←</ci><apply id="algorithm2.16.16.m1.1.1.2.cmml" xref="algorithm2.16.16.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm2.16.16.m1.1.1.2.1.cmml" xref="algorithm2.16.16.m1.1.1.2">subscript</csymbol><ci id="algorithm2.16.16.m1.1.1.2.2.cmml" xref="algorithm2.16.16.m1.1.1.2.2">𝐸</ci><apply id="algorithm2.16.16.m1.1.1.2.3.cmml" xref="algorithm2.16.16.m1.1.1.2.3"><plus id="algorithm2.16.16.m1.1.1.2.3.1.cmml" xref="algorithm2.16.16.m1.1.1.2.3.1"></plus><ci id="algorithm2.16.16.m1.1.1.2.3.2.cmml" xref="algorithm2.16.16.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="algorithm2.16.16.m1.1.1.2.3.3.cmml" xref="algorithm2.16.16.m1.1.1.2.3.3">1</cn></apply></apply><csymbol cd="latexml" id="algorithm2.16.16.m1.1.1.3.cmml" xref="algorithm2.16.16.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.16.16.m1.1c">E_{t+1}\leftarrow</annotation></semantics></math> hub <span id="algorithm2.16.16.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm2.16.16.2" class="ltx_text ltx_font_typewriter">Set next nodes to the hub node </span>
</div>
<div id="algorithm2.17.17" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm2.17.17.m1.1" class="ltx_Math" alttext="A_{t+1}\leftarrow" display="inline"><semantics id="algorithm2.17.17.m1.1a"><mrow id="algorithm2.17.17.m1.1.1" xref="algorithm2.17.17.m1.1.1.cmml"><msub id="algorithm2.17.17.m1.1.1.2" xref="algorithm2.17.17.m1.1.1.2.cmml"><mi id="algorithm2.17.17.m1.1.1.2.2" xref="algorithm2.17.17.m1.1.1.2.2.cmml">A</mi><mrow id="algorithm2.17.17.m1.1.1.2.3" xref="algorithm2.17.17.m1.1.1.2.3.cmml"><mi id="algorithm2.17.17.m1.1.1.2.3.2" xref="algorithm2.17.17.m1.1.1.2.3.2.cmml">t</mi><mo id="algorithm2.17.17.m1.1.1.2.3.1" xref="algorithm2.17.17.m1.1.1.2.3.1.cmml">+</mo><mn id="algorithm2.17.17.m1.1.1.2.3.3" xref="algorithm2.17.17.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="algorithm2.17.17.m1.1.1.1" xref="algorithm2.17.17.m1.1.1.1.cmml">←</mo><mi id="algorithm2.17.17.m1.1.1.3" xref="algorithm2.17.17.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.17.17.m1.1b"><apply id="algorithm2.17.17.m1.1.1.cmml" xref="algorithm2.17.17.m1.1.1"><ci id="algorithm2.17.17.m1.1.1.1.cmml" xref="algorithm2.17.17.m1.1.1.1">←</ci><apply id="algorithm2.17.17.m1.1.1.2.cmml" xref="algorithm2.17.17.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm2.17.17.m1.1.1.2.1.cmml" xref="algorithm2.17.17.m1.1.1.2">subscript</csymbol><ci id="algorithm2.17.17.m1.1.1.2.2.cmml" xref="algorithm2.17.17.m1.1.1.2.2">𝐴</ci><apply id="algorithm2.17.17.m1.1.1.2.3.cmml" xref="algorithm2.17.17.m1.1.1.2.3"><plus id="algorithm2.17.17.m1.1.1.2.3.1.cmml" xref="algorithm2.17.17.m1.1.1.2.3.1"></plus><ci id="algorithm2.17.17.m1.1.1.2.3.2.cmml" xref="algorithm2.17.17.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="algorithm2.17.17.m1.1.1.2.3.3.cmml" xref="algorithm2.17.17.m1.1.1.2.3.3">1</cn></apply></apply><csymbol cd="latexml" id="algorithm2.17.17.m1.1.1.3.cmml" xref="algorithm2.17.17.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.17.17.m1.1c">A_{t+1}\leftarrow</annotation></semantics></math> dummy <span id="algorithm2.17.17.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm2.17.17.2" class="ltx_text ltx_font_typewriter">Set next actions to the dummy return action </span>
</div>
<div id="algorithm2.27.30" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm2.27.31" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end if
</div>
<div id="algorithm2.21.21" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   Forward pass through the policy network to generate candidate actions <math id="algorithm2.18.18.m1.1" class="ltx_Math" alttext="\{(A_{t},E_{t})\}" display="inline"><semantics id="algorithm2.18.18.m1.1a"><mrow id="algorithm2.18.18.m1.1.1.1" xref="algorithm2.18.18.m1.1.1.2.cmml"><mo stretchy="false" id="algorithm2.18.18.m1.1.1.1.2" xref="algorithm2.18.18.m1.1.1.2.cmml">{</mo><mrow id="algorithm2.18.18.m1.1.1.1.1.2" xref="algorithm2.18.18.m1.1.1.1.1.3.cmml"><mo stretchy="false" id="algorithm2.18.18.m1.1.1.1.1.2.3" xref="algorithm2.18.18.m1.1.1.1.1.3.cmml">(</mo><msub id="algorithm2.18.18.m1.1.1.1.1.1.1" xref="algorithm2.18.18.m1.1.1.1.1.1.1.cmml"><mi id="algorithm2.18.18.m1.1.1.1.1.1.1.2" xref="algorithm2.18.18.m1.1.1.1.1.1.1.2.cmml">A</mi><mi id="algorithm2.18.18.m1.1.1.1.1.1.1.3" xref="algorithm2.18.18.m1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="algorithm2.18.18.m1.1.1.1.1.2.4" xref="algorithm2.18.18.m1.1.1.1.1.3.cmml">,</mo><msub id="algorithm2.18.18.m1.1.1.1.1.2.2" xref="algorithm2.18.18.m1.1.1.1.1.2.2.cmml"><mi id="algorithm2.18.18.m1.1.1.1.1.2.2.2" xref="algorithm2.18.18.m1.1.1.1.1.2.2.2.cmml">E</mi><mi id="algorithm2.18.18.m1.1.1.1.1.2.2.3" xref="algorithm2.18.18.m1.1.1.1.1.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="algorithm2.18.18.m1.1.1.1.1.2.5" xref="algorithm2.18.18.m1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="algorithm2.18.18.m1.1.1.1.3" xref="algorithm2.18.18.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.18.18.m1.1b"><set id="algorithm2.18.18.m1.1.1.2.cmml" xref="algorithm2.18.18.m1.1.1.1"><interval closure="open" id="algorithm2.18.18.m1.1.1.1.1.3.cmml" xref="algorithm2.18.18.m1.1.1.1.1.2"><apply id="algorithm2.18.18.m1.1.1.1.1.1.1.cmml" xref="algorithm2.18.18.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.18.18.m1.1.1.1.1.1.1.1.cmml" xref="algorithm2.18.18.m1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm2.18.18.m1.1.1.1.1.1.1.2.cmml" xref="algorithm2.18.18.m1.1.1.1.1.1.1.2">𝐴</ci><ci id="algorithm2.18.18.m1.1.1.1.1.1.1.3.cmml" xref="algorithm2.18.18.m1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="algorithm2.18.18.m1.1.1.1.1.2.2.cmml" xref="algorithm2.18.18.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="algorithm2.18.18.m1.1.1.1.1.2.2.1.cmml" xref="algorithm2.18.18.m1.1.1.1.1.2.2">subscript</csymbol><ci id="algorithm2.18.18.m1.1.1.1.1.2.2.2.cmml" xref="algorithm2.18.18.m1.1.1.1.1.2.2.2">𝐸</ci><ci id="algorithm2.18.18.m1.1.1.1.1.2.2.3.cmml" xref="algorithm2.18.18.m1.1.1.1.1.2.2.3">𝑡</ci></apply></interval></set></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.18.18.m1.1c">\{(A_{t},E_{t})\}</annotation></semantics></math>
along with their probabilities <math id="algorithm2.19.19.m2.1" class="ltx_Math" alttext="\{p_{i}\}" display="inline"><semantics id="algorithm2.19.19.m2.1a"><mrow id="algorithm2.19.19.m2.1.1.1" xref="algorithm2.19.19.m2.1.1.2.cmml"><mo stretchy="false" id="algorithm2.19.19.m2.1.1.1.2" xref="algorithm2.19.19.m2.1.1.2.cmml">{</mo><msub id="algorithm2.19.19.m2.1.1.1.1" xref="algorithm2.19.19.m2.1.1.1.1.cmml"><mi id="algorithm2.19.19.m2.1.1.1.1.2" xref="algorithm2.19.19.m2.1.1.1.1.2.cmml">p</mi><mi id="algorithm2.19.19.m2.1.1.1.1.3" xref="algorithm2.19.19.m2.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="algorithm2.19.19.m2.1.1.1.3" xref="algorithm2.19.19.m2.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.19.19.m2.1b"><set id="algorithm2.19.19.m2.1.1.2.cmml" xref="algorithm2.19.19.m2.1.1.1"><apply id="algorithm2.19.19.m2.1.1.1.1.cmml" xref="algorithm2.19.19.m2.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.19.19.m2.1.1.1.1.1.cmml" xref="algorithm2.19.19.m2.1.1.1.1">subscript</csymbol><ci id="algorithm2.19.19.m2.1.1.1.1.2.cmml" xref="algorithm2.19.19.m2.1.1.1.1.2">𝑝</ci><ci id="algorithm2.19.19.m2.1.1.1.1.3.cmml" xref="algorithm2.19.19.m2.1.1.1.1.3">𝑖</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.19.19.m2.1c">\{p_{i}\}</annotation></semantics></math>
<math id="algorithm2.20.20.m3.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="algorithm2.20.20.m3.1a"><mi id="algorithm2.20.20.m3.1.1" xref="algorithm2.20.20.m3.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="algorithm2.20.20.m3.1b"><ci id="algorithm2.20.20.m3.1.1.cmml" xref="algorithm2.20.20.m3.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.20.20.m3.1c">\tau</annotation></semantics></math>.append(<math id="algorithm2.21.21.m4.1" class="ltx_Math" alttext="\{(A_{t},E_{t})\}" display="inline"><semantics id="algorithm2.21.21.m4.1a"><mrow id="algorithm2.21.21.m4.1.1.1" xref="algorithm2.21.21.m4.1.1.2.cmml"><mo stretchy="false" id="algorithm2.21.21.m4.1.1.1.2" xref="algorithm2.21.21.m4.1.1.2.cmml">{</mo><mrow id="algorithm2.21.21.m4.1.1.1.1.2" xref="algorithm2.21.21.m4.1.1.1.1.3.cmml"><mo stretchy="false" id="algorithm2.21.21.m4.1.1.1.1.2.3" xref="algorithm2.21.21.m4.1.1.1.1.3.cmml">(</mo><msub id="algorithm2.21.21.m4.1.1.1.1.1.1" xref="algorithm2.21.21.m4.1.1.1.1.1.1.cmml"><mi id="algorithm2.21.21.m4.1.1.1.1.1.1.2" xref="algorithm2.21.21.m4.1.1.1.1.1.1.2.cmml">A</mi><mi id="algorithm2.21.21.m4.1.1.1.1.1.1.3" xref="algorithm2.21.21.m4.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="algorithm2.21.21.m4.1.1.1.1.2.4" xref="algorithm2.21.21.m4.1.1.1.1.3.cmml">,</mo><msub id="algorithm2.21.21.m4.1.1.1.1.2.2" xref="algorithm2.21.21.m4.1.1.1.1.2.2.cmml"><mi id="algorithm2.21.21.m4.1.1.1.1.2.2.2" xref="algorithm2.21.21.m4.1.1.1.1.2.2.2.cmml">E</mi><mi id="algorithm2.21.21.m4.1.1.1.1.2.2.3" xref="algorithm2.21.21.m4.1.1.1.1.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="algorithm2.21.21.m4.1.1.1.1.2.5" xref="algorithm2.21.21.m4.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="algorithm2.21.21.m4.1.1.1.3" xref="algorithm2.21.21.m4.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.21.21.m4.1b"><set id="algorithm2.21.21.m4.1.1.2.cmml" xref="algorithm2.21.21.m4.1.1.1"><interval closure="open" id="algorithm2.21.21.m4.1.1.1.1.3.cmml" xref="algorithm2.21.21.m4.1.1.1.1.2"><apply id="algorithm2.21.21.m4.1.1.1.1.1.1.cmml" xref="algorithm2.21.21.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.21.21.m4.1.1.1.1.1.1.1.cmml" xref="algorithm2.21.21.m4.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm2.21.21.m4.1.1.1.1.1.1.2.cmml" xref="algorithm2.21.21.m4.1.1.1.1.1.1.2">𝐴</ci><ci id="algorithm2.21.21.m4.1.1.1.1.1.1.3.cmml" xref="algorithm2.21.21.m4.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="algorithm2.21.21.m4.1.1.1.1.2.2.cmml" xref="algorithm2.21.21.m4.1.1.1.1.2.2"><csymbol cd="ambiguous" id="algorithm2.21.21.m4.1.1.1.1.2.2.1.cmml" xref="algorithm2.21.21.m4.1.1.1.1.2.2">subscript</csymbol><ci id="algorithm2.21.21.m4.1.1.1.1.2.2.2.cmml" xref="algorithm2.21.21.m4.1.1.1.1.2.2.2">𝐸</ci><ci id="algorithm2.21.21.m4.1.1.1.1.2.2.3.cmml" xref="algorithm2.21.21.m4.1.1.1.1.2.2.3">𝑡</ci></apply></interval></set></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.21.21.m4.1c">\{(A_{t},E_{t})\}</annotation></semantics></math>) <span id="algorithm2.21.21.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm2.21.21.2" class="ltx_text ltx_font_typewriter">Extend the trajectory </span>
</div>
<div id="algorithm2.23.23" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm2.22.22.m1.1" class="ltx_Math" alttext="P" display="inline"><semantics id="algorithm2.22.22.m1.1a"><mi id="algorithm2.22.22.m1.1.1" xref="algorithm2.22.22.m1.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="algorithm2.22.22.m1.1b"><ci id="algorithm2.22.22.m1.1.1.cmml" xref="algorithm2.22.22.m1.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.22.22.m1.1c">P</annotation></semantics></math>.append(<math id="algorithm2.23.23.m2.1" class="ltx_Math" alttext="\{p_{i}\}" display="inline"><semantics id="algorithm2.23.23.m2.1a"><mrow id="algorithm2.23.23.m2.1.1.1" xref="algorithm2.23.23.m2.1.1.2.cmml"><mo stretchy="false" id="algorithm2.23.23.m2.1.1.1.2" xref="algorithm2.23.23.m2.1.1.2.cmml">{</mo><msub id="algorithm2.23.23.m2.1.1.1.1" xref="algorithm2.23.23.m2.1.1.1.1.cmml"><mi id="algorithm2.23.23.m2.1.1.1.1.2" xref="algorithm2.23.23.m2.1.1.1.1.2.cmml">p</mi><mi id="algorithm2.23.23.m2.1.1.1.1.3" xref="algorithm2.23.23.m2.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="algorithm2.23.23.m2.1.1.1.3" xref="algorithm2.23.23.m2.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.23.23.m2.1b"><set id="algorithm2.23.23.m2.1.1.2.cmml" xref="algorithm2.23.23.m2.1.1.1"><apply id="algorithm2.23.23.m2.1.1.1.1.cmml" xref="algorithm2.23.23.m2.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.23.23.m2.1.1.1.1.1.cmml" xref="algorithm2.23.23.m2.1.1.1.1">subscript</csymbol><ci id="algorithm2.23.23.m2.1.1.1.1.2.cmml" xref="algorithm2.23.23.m2.1.1.1.1.2">𝑝</ci><ci id="algorithm2.23.23.m2.1.1.1.1.3.cmml" xref="algorithm2.23.23.m2.1.1.1.1.3">𝑖</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.23.23.m2.1c">\{p_{i}\}</annotation></semantics></math>) <span id="algorithm2.23.23.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm2.23.23.2" class="ltx_text ltx_font_typewriter">Store corresponding probabilities </span>
</div>
<div id="algorithm2.27.32" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm2.27.33" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm2.24.24" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="algorithm2.24.24.m1.2" class="ltx_Math" alttext="indicies\leftarrow argmax(P,k)" display="inline"><semantics id="algorithm2.24.24.m1.2a"><mrow id="algorithm2.24.24.m1.2.3" xref="algorithm2.24.24.m1.2.3.cmml"><mrow id="algorithm2.24.24.m1.2.3.2" xref="algorithm2.24.24.m1.2.3.2.cmml"><mi id="algorithm2.24.24.m1.2.3.2.2" xref="algorithm2.24.24.m1.2.3.2.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="algorithm2.24.24.m1.2.3.2.1" xref="algorithm2.24.24.m1.2.3.2.1.cmml">​</mo><mi id="algorithm2.24.24.m1.2.3.2.3" xref="algorithm2.24.24.m1.2.3.2.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="algorithm2.24.24.m1.2.3.2.1a" xref="algorithm2.24.24.m1.2.3.2.1.cmml">​</mo><mi id="algorithm2.24.24.m1.2.3.2.4" xref="algorithm2.24.24.m1.2.3.2.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="algorithm2.24.24.m1.2.3.2.1b" xref="algorithm2.24.24.m1.2.3.2.1.cmml">​</mo><mi id="algorithm2.24.24.m1.2.3.2.5" xref="algorithm2.24.24.m1.2.3.2.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="algorithm2.24.24.m1.2.3.2.1c" xref="algorithm2.24.24.m1.2.3.2.1.cmml">​</mo><mi id="algorithm2.24.24.m1.2.3.2.6" xref="algorithm2.24.24.m1.2.3.2.6.cmml">c</mi><mo lspace="0em" rspace="0em" id="algorithm2.24.24.m1.2.3.2.1d" xref="algorithm2.24.24.m1.2.3.2.1.cmml">​</mo><mi id="algorithm2.24.24.m1.2.3.2.7" xref="algorithm2.24.24.m1.2.3.2.7.cmml">i</mi><mo lspace="0em" rspace="0em" id="algorithm2.24.24.m1.2.3.2.1e" xref="algorithm2.24.24.m1.2.3.2.1.cmml">​</mo><mi id="algorithm2.24.24.m1.2.3.2.8" xref="algorithm2.24.24.m1.2.3.2.8.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm2.24.24.m1.2.3.2.1f" xref="algorithm2.24.24.m1.2.3.2.1.cmml">​</mo><mi id="algorithm2.24.24.m1.2.3.2.9" xref="algorithm2.24.24.m1.2.3.2.9.cmml">s</mi></mrow><mo stretchy="false" id="algorithm2.24.24.m1.2.3.1" xref="algorithm2.24.24.m1.2.3.1.cmml">←</mo><mrow id="algorithm2.24.24.m1.2.3.3" xref="algorithm2.24.24.m1.2.3.3.cmml"><mi id="algorithm2.24.24.m1.2.3.3.2" xref="algorithm2.24.24.m1.2.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm2.24.24.m1.2.3.3.1" xref="algorithm2.24.24.m1.2.3.3.1.cmml">​</mo><mi id="algorithm2.24.24.m1.2.3.3.3" xref="algorithm2.24.24.m1.2.3.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="algorithm2.24.24.m1.2.3.3.1a" xref="algorithm2.24.24.m1.2.3.3.1.cmml">​</mo><mi id="algorithm2.24.24.m1.2.3.3.4" xref="algorithm2.24.24.m1.2.3.3.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="algorithm2.24.24.m1.2.3.3.1b" xref="algorithm2.24.24.m1.2.3.3.1.cmml">​</mo><mi id="algorithm2.24.24.m1.2.3.3.5" xref="algorithm2.24.24.m1.2.3.3.5.cmml">m</mi><mo lspace="0em" rspace="0em" id="algorithm2.24.24.m1.2.3.3.1c" xref="algorithm2.24.24.m1.2.3.3.1.cmml">​</mo><mi id="algorithm2.24.24.m1.2.3.3.6" xref="algorithm2.24.24.m1.2.3.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm2.24.24.m1.2.3.3.1d" xref="algorithm2.24.24.m1.2.3.3.1.cmml">​</mo><mi id="algorithm2.24.24.m1.2.3.3.7" xref="algorithm2.24.24.m1.2.3.3.7.cmml">x</mi><mo lspace="0em" rspace="0em" id="algorithm2.24.24.m1.2.3.3.1e" xref="algorithm2.24.24.m1.2.3.3.1.cmml">​</mo><mrow id="algorithm2.24.24.m1.2.3.3.8.2" xref="algorithm2.24.24.m1.2.3.3.8.1.cmml"><mo stretchy="false" id="algorithm2.24.24.m1.2.3.3.8.2.1" xref="algorithm2.24.24.m1.2.3.3.8.1.cmml">(</mo><mi id="algorithm2.24.24.m1.1.1" xref="algorithm2.24.24.m1.1.1.cmml">P</mi><mo id="algorithm2.24.24.m1.2.3.3.8.2.2" xref="algorithm2.24.24.m1.2.3.3.8.1.cmml">,</mo><mi id="algorithm2.24.24.m1.2.2" xref="algorithm2.24.24.m1.2.2.cmml">k</mi><mo stretchy="false" id="algorithm2.24.24.m1.2.3.3.8.2.3" xref="algorithm2.24.24.m1.2.3.3.8.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.24.24.m1.2b"><apply id="algorithm2.24.24.m1.2.3.cmml" xref="algorithm2.24.24.m1.2.3"><ci id="algorithm2.24.24.m1.2.3.1.cmml" xref="algorithm2.24.24.m1.2.3.1">←</ci><apply id="algorithm2.24.24.m1.2.3.2.cmml" xref="algorithm2.24.24.m1.2.3.2"><times id="algorithm2.24.24.m1.2.3.2.1.cmml" xref="algorithm2.24.24.m1.2.3.2.1"></times><ci id="algorithm2.24.24.m1.2.3.2.2.cmml" xref="algorithm2.24.24.m1.2.3.2.2">𝑖</ci><ci id="algorithm2.24.24.m1.2.3.2.3.cmml" xref="algorithm2.24.24.m1.2.3.2.3">𝑛</ci><ci id="algorithm2.24.24.m1.2.3.2.4.cmml" xref="algorithm2.24.24.m1.2.3.2.4">𝑑</ci><ci id="algorithm2.24.24.m1.2.3.2.5.cmml" xref="algorithm2.24.24.m1.2.3.2.5">𝑖</ci><ci id="algorithm2.24.24.m1.2.3.2.6.cmml" xref="algorithm2.24.24.m1.2.3.2.6">𝑐</ci><ci id="algorithm2.24.24.m1.2.3.2.7.cmml" xref="algorithm2.24.24.m1.2.3.2.7">𝑖</ci><ci id="algorithm2.24.24.m1.2.3.2.8.cmml" xref="algorithm2.24.24.m1.2.3.2.8">𝑒</ci><ci id="algorithm2.24.24.m1.2.3.2.9.cmml" xref="algorithm2.24.24.m1.2.3.2.9">𝑠</ci></apply><apply id="algorithm2.24.24.m1.2.3.3.cmml" xref="algorithm2.24.24.m1.2.3.3"><times id="algorithm2.24.24.m1.2.3.3.1.cmml" xref="algorithm2.24.24.m1.2.3.3.1"></times><ci id="algorithm2.24.24.m1.2.3.3.2.cmml" xref="algorithm2.24.24.m1.2.3.3.2">𝑎</ci><ci id="algorithm2.24.24.m1.2.3.3.3.cmml" xref="algorithm2.24.24.m1.2.3.3.3">𝑟</ci><ci id="algorithm2.24.24.m1.2.3.3.4.cmml" xref="algorithm2.24.24.m1.2.3.3.4">𝑔</ci><ci id="algorithm2.24.24.m1.2.3.3.5.cmml" xref="algorithm2.24.24.m1.2.3.3.5">𝑚</ci><ci id="algorithm2.24.24.m1.2.3.3.6.cmml" xref="algorithm2.24.24.m1.2.3.3.6">𝑎</ci><ci id="algorithm2.24.24.m1.2.3.3.7.cmml" xref="algorithm2.24.24.m1.2.3.3.7">𝑥</ci><interval closure="open" id="algorithm2.24.24.m1.2.3.3.8.1.cmml" xref="algorithm2.24.24.m1.2.3.3.8.2"><ci id="algorithm2.24.24.m1.1.1.cmml" xref="algorithm2.24.24.m1.1.1">𝑃</ci><ci id="algorithm2.24.24.m1.2.2.cmml" xref="algorithm2.24.24.m1.2.2">𝑘</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.24.24.m1.2c">indicies\leftarrow argmax(P,k)</annotation></semantics></math> <span id="algorithm2.24.24.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm2.24.24.2" class="ltx_text ltx_font_typewriter">Filter indices of top k probabilities from P </span>
</div>
<div id="algorithm2.25.25" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm2.25.25.m1.1" class="ltx_Math" alttext="\tau\leftarrow\tau[indices]" display="inline"><semantics id="algorithm2.25.25.m1.1a"><mrow id="algorithm2.25.25.m1.1.1" xref="algorithm2.25.25.m1.1.1.cmml"><mi id="algorithm2.25.25.m1.1.1.3" xref="algorithm2.25.25.m1.1.1.3.cmml">τ</mi><mo stretchy="false" id="algorithm2.25.25.m1.1.1.2" xref="algorithm2.25.25.m1.1.1.2.cmml">←</mo><mrow id="algorithm2.25.25.m1.1.1.1" xref="algorithm2.25.25.m1.1.1.1.cmml"><mi id="algorithm2.25.25.m1.1.1.1.3" xref="algorithm2.25.25.m1.1.1.1.3.cmml">τ</mi><mo lspace="0em" rspace="0em" id="algorithm2.25.25.m1.1.1.1.2" xref="algorithm2.25.25.m1.1.1.1.2.cmml">​</mo><mrow id="algorithm2.25.25.m1.1.1.1.1.1" xref="algorithm2.25.25.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="algorithm2.25.25.m1.1.1.1.1.1.2" xref="algorithm2.25.25.m1.1.1.1.1.2.1.cmml">[</mo><mrow id="algorithm2.25.25.m1.1.1.1.1.1.1" xref="algorithm2.25.25.m1.1.1.1.1.1.1.cmml"><mi id="algorithm2.25.25.m1.1.1.1.1.1.1.2" xref="algorithm2.25.25.m1.1.1.1.1.1.1.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="algorithm2.25.25.m1.1.1.1.1.1.1.1" xref="algorithm2.25.25.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="algorithm2.25.25.m1.1.1.1.1.1.1.3" xref="algorithm2.25.25.m1.1.1.1.1.1.1.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="algorithm2.25.25.m1.1.1.1.1.1.1.1a" xref="algorithm2.25.25.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="algorithm2.25.25.m1.1.1.1.1.1.1.4" xref="algorithm2.25.25.m1.1.1.1.1.1.1.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="algorithm2.25.25.m1.1.1.1.1.1.1.1b" xref="algorithm2.25.25.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="algorithm2.25.25.m1.1.1.1.1.1.1.5" xref="algorithm2.25.25.m1.1.1.1.1.1.1.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="algorithm2.25.25.m1.1.1.1.1.1.1.1c" xref="algorithm2.25.25.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="algorithm2.25.25.m1.1.1.1.1.1.1.6" xref="algorithm2.25.25.m1.1.1.1.1.1.1.6.cmml">c</mi><mo lspace="0em" rspace="0em" id="algorithm2.25.25.m1.1.1.1.1.1.1.1d" xref="algorithm2.25.25.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="algorithm2.25.25.m1.1.1.1.1.1.1.7" xref="algorithm2.25.25.m1.1.1.1.1.1.1.7.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm2.25.25.m1.1.1.1.1.1.1.1e" xref="algorithm2.25.25.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="algorithm2.25.25.m1.1.1.1.1.1.1.8" xref="algorithm2.25.25.m1.1.1.1.1.1.1.8.cmml">s</mi></mrow><mo stretchy="false" id="algorithm2.25.25.m1.1.1.1.1.1.3" xref="algorithm2.25.25.m1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.25.25.m1.1b"><apply id="algorithm2.25.25.m1.1.1.cmml" xref="algorithm2.25.25.m1.1.1"><ci id="algorithm2.25.25.m1.1.1.2.cmml" xref="algorithm2.25.25.m1.1.1.2">←</ci><ci id="algorithm2.25.25.m1.1.1.3.cmml" xref="algorithm2.25.25.m1.1.1.3">𝜏</ci><apply id="algorithm2.25.25.m1.1.1.1.cmml" xref="algorithm2.25.25.m1.1.1.1"><times id="algorithm2.25.25.m1.1.1.1.2.cmml" xref="algorithm2.25.25.m1.1.1.1.2"></times><ci id="algorithm2.25.25.m1.1.1.1.3.cmml" xref="algorithm2.25.25.m1.1.1.1.3">𝜏</ci><apply id="algorithm2.25.25.m1.1.1.1.1.2.cmml" xref="algorithm2.25.25.m1.1.1.1.1.1"><csymbol cd="latexml" id="algorithm2.25.25.m1.1.1.1.1.2.1.cmml" xref="algorithm2.25.25.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="algorithm2.25.25.m1.1.1.1.1.1.1.cmml" xref="algorithm2.25.25.m1.1.1.1.1.1.1"><times id="algorithm2.25.25.m1.1.1.1.1.1.1.1.cmml" xref="algorithm2.25.25.m1.1.1.1.1.1.1.1"></times><ci id="algorithm2.25.25.m1.1.1.1.1.1.1.2.cmml" xref="algorithm2.25.25.m1.1.1.1.1.1.1.2">𝑖</ci><ci id="algorithm2.25.25.m1.1.1.1.1.1.1.3.cmml" xref="algorithm2.25.25.m1.1.1.1.1.1.1.3">𝑛</ci><ci id="algorithm2.25.25.m1.1.1.1.1.1.1.4.cmml" xref="algorithm2.25.25.m1.1.1.1.1.1.1.4">𝑑</ci><ci id="algorithm2.25.25.m1.1.1.1.1.1.1.5.cmml" xref="algorithm2.25.25.m1.1.1.1.1.1.1.5">𝑖</ci><ci id="algorithm2.25.25.m1.1.1.1.1.1.1.6.cmml" xref="algorithm2.25.25.m1.1.1.1.1.1.1.6">𝑐</ci><ci id="algorithm2.25.25.m1.1.1.1.1.1.1.7.cmml" xref="algorithm2.25.25.m1.1.1.1.1.1.1.7">𝑒</ci><ci id="algorithm2.25.25.m1.1.1.1.1.1.1.8.cmml" xref="algorithm2.25.25.m1.1.1.1.1.1.1.8">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.25.25.m1.1c">\tau\leftarrow\tau[indices]</annotation></semantics></math> <span id="algorithm2.25.25.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm2.25.25.2" class="ltx_text ltx_font_typewriter">Choose top k paths ranked by their probabilities </span>
</div>
<div id="algorithm2.26.26" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm2.26.26.m1.1" class="ltx_Math" alttext="E_{t+1}\leftarrow e\in\tau" display="inline"><semantics id="algorithm2.26.26.m1.1a"><mrow id="algorithm2.26.26.m1.1.1" xref="algorithm2.26.26.m1.1.1.cmml"><msub id="algorithm2.26.26.m1.1.1.2" xref="algorithm2.26.26.m1.1.1.2.cmml"><mi id="algorithm2.26.26.m1.1.1.2.2" xref="algorithm2.26.26.m1.1.1.2.2.cmml">E</mi><mrow id="algorithm2.26.26.m1.1.1.2.3" xref="algorithm2.26.26.m1.1.1.2.3.cmml"><mi id="algorithm2.26.26.m1.1.1.2.3.2" xref="algorithm2.26.26.m1.1.1.2.3.2.cmml">t</mi><mo id="algorithm2.26.26.m1.1.1.2.3.1" xref="algorithm2.26.26.m1.1.1.2.3.1.cmml">+</mo><mn id="algorithm2.26.26.m1.1.1.2.3.3" xref="algorithm2.26.26.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="algorithm2.26.26.m1.1.1.3" xref="algorithm2.26.26.m1.1.1.3.cmml">←</mo><mi id="algorithm2.26.26.m1.1.1.4" xref="algorithm2.26.26.m1.1.1.4.cmml">e</mi><mo id="algorithm2.26.26.m1.1.1.5" xref="algorithm2.26.26.m1.1.1.5.cmml">∈</mo><mi id="algorithm2.26.26.m1.1.1.6" xref="algorithm2.26.26.m1.1.1.6.cmml">τ</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.26.26.m1.1b"><apply id="algorithm2.26.26.m1.1.1.cmml" xref="algorithm2.26.26.m1.1.1"><and id="algorithm2.26.26.m1.1.1a.cmml" xref="algorithm2.26.26.m1.1.1"></and><apply id="algorithm2.26.26.m1.1.1b.cmml" xref="algorithm2.26.26.m1.1.1"><ci id="algorithm2.26.26.m1.1.1.3.cmml" xref="algorithm2.26.26.m1.1.1.3">←</ci><apply id="algorithm2.26.26.m1.1.1.2.cmml" xref="algorithm2.26.26.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm2.26.26.m1.1.1.2.1.cmml" xref="algorithm2.26.26.m1.1.1.2">subscript</csymbol><ci id="algorithm2.26.26.m1.1.1.2.2.cmml" xref="algorithm2.26.26.m1.1.1.2.2">𝐸</ci><apply id="algorithm2.26.26.m1.1.1.2.3.cmml" xref="algorithm2.26.26.m1.1.1.2.3"><plus id="algorithm2.26.26.m1.1.1.2.3.1.cmml" xref="algorithm2.26.26.m1.1.1.2.3.1"></plus><ci id="algorithm2.26.26.m1.1.1.2.3.2.cmml" xref="algorithm2.26.26.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="algorithm2.26.26.m1.1.1.2.3.3.cmml" xref="algorithm2.26.26.m1.1.1.2.3.3">1</cn></apply></apply><ci id="algorithm2.26.26.m1.1.1.4.cmml" xref="algorithm2.26.26.m1.1.1.4">𝑒</ci></apply><apply id="algorithm2.26.26.m1.1.1c.cmml" xref="algorithm2.26.26.m1.1.1"><in id="algorithm2.26.26.m1.1.1.5.cmml" xref="algorithm2.26.26.m1.1.1.5"></in><share href="#algorithm2.26.26.m1.1.1.4.cmml" id="algorithm2.26.26.m1.1.1d.cmml" xref="algorithm2.26.26.m1.1.1"></share><ci id="algorithm2.26.26.m1.1.1.6.cmml" xref="algorithm2.26.26.m1.1.1.6">𝜏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.26.26.m1.1c">E_{t+1}\leftarrow e\in\tau</annotation></semantics></math> <span id="algorithm2.26.26.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm2.26.26.2" class="ltx_text ltx_font_typewriter">Conduct corresponding transitions </span>
</div>
<div id="algorithm2.27.34" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm2.27.35" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10</span> end for
</div>
<div id="algorithm2.27.27" class="ltx_listingline">Prediction <math id="algorithm2.27.27.m1.1" class="ltx_Math" alttext="\leftarrow\tau[0]" display="inline"><semantics id="algorithm2.27.27.m1.1a"><mrow id="algorithm2.27.27.m1.1.2" xref="algorithm2.27.27.m1.1.2.cmml"><mi id="algorithm2.27.27.m1.1.2.2" xref="algorithm2.27.27.m1.1.2.2.cmml"></mi><mo stretchy="false" id="algorithm2.27.27.m1.1.2.1" xref="algorithm2.27.27.m1.1.2.1.cmml">←</mo><mrow id="algorithm2.27.27.m1.1.2.3" xref="algorithm2.27.27.m1.1.2.3.cmml"><mi id="algorithm2.27.27.m1.1.2.3.2" xref="algorithm2.27.27.m1.1.2.3.2.cmml">τ</mi><mo lspace="0em" rspace="0em" id="algorithm2.27.27.m1.1.2.3.1" xref="algorithm2.27.27.m1.1.2.3.1.cmml">​</mo><mrow id="algorithm2.27.27.m1.1.2.3.3.2" xref="algorithm2.27.27.m1.1.2.3.3.1.cmml"><mo stretchy="false" id="algorithm2.27.27.m1.1.2.3.3.2.1" xref="algorithm2.27.27.m1.1.2.3.3.1.1.cmml">[</mo><mn id="algorithm2.27.27.m1.1.1" xref="algorithm2.27.27.m1.1.1.cmml">0</mn><mo stretchy="false" id="algorithm2.27.27.m1.1.2.3.3.2.2" xref="algorithm2.27.27.m1.1.2.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.27.27.m1.1b"><apply id="algorithm2.27.27.m1.1.2.cmml" xref="algorithm2.27.27.m1.1.2"><ci id="algorithm2.27.27.m1.1.2.1.cmml" xref="algorithm2.27.27.m1.1.2.1">←</ci><csymbol cd="latexml" id="algorithm2.27.27.m1.1.2.2.cmml" xref="algorithm2.27.27.m1.1.2.2">absent</csymbol><apply id="algorithm2.27.27.m1.1.2.3.cmml" xref="algorithm2.27.27.m1.1.2.3"><times id="algorithm2.27.27.m1.1.2.3.1.cmml" xref="algorithm2.27.27.m1.1.2.3.1"></times><ci id="algorithm2.27.27.m1.1.2.3.2.cmml" xref="algorithm2.27.27.m1.1.2.3.2">𝜏</ci><apply id="algorithm2.27.27.m1.1.2.3.3.1.cmml" xref="algorithm2.27.27.m1.1.2.3.3.2"><csymbol cd="latexml" id="algorithm2.27.27.m1.1.2.3.3.1.1.cmml" xref="algorithm2.27.27.m1.1.2.3.3.2.1">delimited-[]</csymbol><cn type="integer" id="algorithm2.27.27.m1.1.1.cmml" xref="algorithm2.27.27.m1.1.1">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.27.27.m1.1c">\leftarrow\tau[0]</annotation></semantics></math> <span id="algorithm2.27.27.1" class="ltx_text ltx_font_typewriter">// </span><span id="algorithm2.27.27.2" class="ltx_text ltx_font_typewriter">Predict the end entity of the top path as the answer </span>
</div>
<div id="algorithm2.27.36" class="ltx_listingline">


</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="algorithm2.29.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span>Inference with beam search</figcaption>
</figure>
</section>
</section>
<section id="Pt0.A1.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">0.A.3 </span>Complexity Analysis</h3>

<div id="Pt0.A1.SS3.p1" class="ltx_para">
<p id="Pt0.A1.SS3.p1.2" class="ltx_p">For analyzing the complexity of our method, we provide all the parameters contained in
the building blocks. Moreover, we present the number of operations of a forward
pass - the complete run that derives the answer from a given <math id="Pt0.A1.SS3.p1.1.m1.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="Pt0.A1.SS3.p1.1.m1.1a"><mi id="Pt0.A1.SS3.p1.1.m1.1.1" xref="Pt0.A1.SS3.p1.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS3.p1.1.m1.1b"><ci id="Pt0.A1.SS3.p1.1.m1.1.1.cmml" xref="Pt0.A1.SS3.p1.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS3.p1.1.m1.1c">Q</annotation></semantics></math> and
<math id="Pt0.A1.SS3.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{SG}" display="inline"><semantics id="Pt0.A1.SS3.p1.2.m2.1a"><mrow id="Pt0.A1.SS3.p1.2.m2.1.1" xref="Pt0.A1.SS3.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Pt0.A1.SS3.p1.2.m2.1.1.2" xref="Pt0.A1.SS3.p1.2.m2.1.1.2.cmml">𝒮</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.SS3.p1.2.m2.1.1.1" xref="Pt0.A1.SS3.p1.2.m2.1.1.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="Pt0.A1.SS3.p1.2.m2.1.1.3" xref="Pt0.A1.SS3.p1.2.m2.1.1.3.cmml">𝒢</mi></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS3.p1.2.m2.1b"><apply id="Pt0.A1.SS3.p1.2.m2.1.1.cmml" xref="Pt0.A1.SS3.p1.2.m2.1.1"><times id="Pt0.A1.SS3.p1.2.m2.1.1.1.cmml" xref="Pt0.A1.SS3.p1.2.m2.1.1.1"></times><ci id="Pt0.A1.SS3.p1.2.m2.1.1.2.cmml" xref="Pt0.A1.SS3.p1.2.m2.1.1.2">𝒮</ci><ci id="Pt0.A1.SS3.p1.2.m2.1.1.3.cmml" xref="Pt0.A1.SS3.p1.2.m2.1.1.3">𝒢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS3.p1.2.m2.1c">\mathcal{SG}</annotation></semantics></math>. They are listed in the table <a href="#Pt0.A1.T3" title="Table 3 ‣ 0.A.3 Complexity Analysis ‣ Appendix 0.A Details on Model Training and Inference ‣ Graphhopper: Multi-Hop Scene Graph Reasoning for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure id="Pt0.A1.T3" class="ltx_table">
<table id="Pt0.A1.T3.51" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="Pt0.A1.T3.51.52.1" class="ltx_tr">
<th id="Pt0.A1.T3.51.52.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Group</th>
<th id="Pt0.A1.T3.51.52.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Name</th>
<td id="Pt0.A1.T3.51.52.1.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">No. Parameters</td>
<td id="Pt0.A1.T3.51.52.1.4" class="ltx_td ltx_align_left ltx_border_t">No. Operations</td>
</tr>
<tr id="Pt0.A1.T3.2.2" class="ltx_tr">
<th id="Pt0.A1.T3.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Word Embeddings*</th>
<th id="Pt0.A1.T3.2.2.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Entity</th>
<td id="Pt0.A1.T3.1.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><math id="Pt0.A1.T3.1.1.1.m1.1" class="ltx_Math" alttext="N_{e}\times d" display="inline"><semantics id="Pt0.A1.T3.1.1.1.m1.1a"><mrow id="Pt0.A1.T3.1.1.1.m1.1.1" xref="Pt0.A1.T3.1.1.1.m1.1.1.cmml"><msub id="Pt0.A1.T3.1.1.1.m1.1.1.2" xref="Pt0.A1.T3.1.1.1.m1.1.1.2.cmml"><mi id="Pt0.A1.T3.1.1.1.m1.1.1.2.2" xref="Pt0.A1.T3.1.1.1.m1.1.1.2.2.cmml">N</mi><mi id="Pt0.A1.T3.1.1.1.m1.1.1.2.3" xref="Pt0.A1.T3.1.1.1.m1.1.1.2.3.cmml">e</mi></msub><mo lspace="0.222em" rspace="0.222em" id="Pt0.A1.T3.1.1.1.m1.1.1.1" xref="Pt0.A1.T3.1.1.1.m1.1.1.1.cmml">×</mo><mi id="Pt0.A1.T3.1.1.1.m1.1.1.3" xref="Pt0.A1.T3.1.1.1.m1.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.1.1.1.m1.1b"><apply id="Pt0.A1.T3.1.1.1.m1.1.1.cmml" xref="Pt0.A1.T3.1.1.1.m1.1.1"><times id="Pt0.A1.T3.1.1.1.m1.1.1.1.cmml" xref="Pt0.A1.T3.1.1.1.m1.1.1.1"></times><apply id="Pt0.A1.T3.1.1.1.m1.1.1.2.cmml" xref="Pt0.A1.T3.1.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="Pt0.A1.T3.1.1.1.m1.1.1.2.1.cmml" xref="Pt0.A1.T3.1.1.1.m1.1.1.2">subscript</csymbol><ci id="Pt0.A1.T3.1.1.1.m1.1.1.2.2.cmml" xref="Pt0.A1.T3.1.1.1.m1.1.1.2.2">𝑁</ci><ci id="Pt0.A1.T3.1.1.1.m1.1.1.2.3.cmml" xref="Pt0.A1.T3.1.1.1.m1.1.1.2.3">𝑒</ci></apply><ci id="Pt0.A1.T3.1.1.1.m1.1.1.3.cmml" xref="Pt0.A1.T3.1.1.1.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.1.1.1.m1.1c">N_{e}\times d</annotation></semantics></math></td>
<td id="Pt0.A1.T3.2.2.2" class="ltx_td ltx_align_left ltx_border_t"><math id="Pt0.A1.T3.2.2.2.m1.1" class="ltx_Math" alttext="\mathcal{O}(N)" display="inline"><semantics id="Pt0.A1.T3.2.2.2.m1.1a"><mrow id="Pt0.A1.T3.2.2.2.m1.1.2" xref="Pt0.A1.T3.2.2.2.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Pt0.A1.T3.2.2.2.m1.1.2.2" xref="Pt0.A1.T3.2.2.2.m1.1.2.2.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.2.2.2.m1.1.2.1" xref="Pt0.A1.T3.2.2.2.m1.1.2.1.cmml">​</mo><mrow id="Pt0.A1.T3.2.2.2.m1.1.2.3.2" xref="Pt0.A1.T3.2.2.2.m1.1.2.cmml"><mo stretchy="false" id="Pt0.A1.T3.2.2.2.m1.1.2.3.2.1" xref="Pt0.A1.T3.2.2.2.m1.1.2.cmml">(</mo><mi id="Pt0.A1.T3.2.2.2.m1.1.1" xref="Pt0.A1.T3.2.2.2.m1.1.1.cmml">N</mi><mo stretchy="false" id="Pt0.A1.T3.2.2.2.m1.1.2.3.2.2" xref="Pt0.A1.T3.2.2.2.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.2.2.2.m1.1b"><apply id="Pt0.A1.T3.2.2.2.m1.1.2.cmml" xref="Pt0.A1.T3.2.2.2.m1.1.2"><times id="Pt0.A1.T3.2.2.2.m1.1.2.1.cmml" xref="Pt0.A1.T3.2.2.2.m1.1.2.1"></times><ci id="Pt0.A1.T3.2.2.2.m1.1.2.2.cmml" xref="Pt0.A1.T3.2.2.2.m1.1.2.2">𝒪</ci><ci id="Pt0.A1.T3.2.2.2.m1.1.1.cmml" xref="Pt0.A1.T3.2.2.2.m1.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.2.2.2.m1.1c">\mathcal{O}(N)</annotation></semantics></math></td>
</tr>
<tr id="Pt0.A1.T3.4.4" class="ltx_tr">
<th id="Pt0.A1.T3.4.4.3" class="ltx_td ltx_th ltx_th_row ltx_border_r"></th>
<th id="Pt0.A1.T3.4.4.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Relation</th>
<td id="Pt0.A1.T3.3.3.1" class="ltx_td ltx_align_left ltx_border_r"><math id="Pt0.A1.T3.3.3.1.m1.1" class="ltx_Math" alttext="N_{r}\times D" display="inline"><semantics id="Pt0.A1.T3.3.3.1.m1.1a"><mrow id="Pt0.A1.T3.3.3.1.m1.1.1" xref="Pt0.A1.T3.3.3.1.m1.1.1.cmml"><msub id="Pt0.A1.T3.3.3.1.m1.1.1.2" xref="Pt0.A1.T3.3.3.1.m1.1.1.2.cmml"><mi id="Pt0.A1.T3.3.3.1.m1.1.1.2.2" xref="Pt0.A1.T3.3.3.1.m1.1.1.2.2.cmml">N</mi><mi id="Pt0.A1.T3.3.3.1.m1.1.1.2.3" xref="Pt0.A1.T3.3.3.1.m1.1.1.2.3.cmml">r</mi></msub><mo lspace="0.222em" rspace="0.222em" id="Pt0.A1.T3.3.3.1.m1.1.1.1" xref="Pt0.A1.T3.3.3.1.m1.1.1.1.cmml">×</mo><mi id="Pt0.A1.T3.3.3.1.m1.1.1.3" xref="Pt0.A1.T3.3.3.1.m1.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.3.3.1.m1.1b"><apply id="Pt0.A1.T3.3.3.1.m1.1.1.cmml" xref="Pt0.A1.T3.3.3.1.m1.1.1"><times id="Pt0.A1.T3.3.3.1.m1.1.1.1.cmml" xref="Pt0.A1.T3.3.3.1.m1.1.1.1"></times><apply id="Pt0.A1.T3.3.3.1.m1.1.1.2.cmml" xref="Pt0.A1.T3.3.3.1.m1.1.1.2"><csymbol cd="ambiguous" id="Pt0.A1.T3.3.3.1.m1.1.1.2.1.cmml" xref="Pt0.A1.T3.3.3.1.m1.1.1.2">subscript</csymbol><ci id="Pt0.A1.T3.3.3.1.m1.1.1.2.2.cmml" xref="Pt0.A1.T3.3.3.1.m1.1.1.2.2">𝑁</ci><ci id="Pt0.A1.T3.3.3.1.m1.1.1.2.3.cmml" xref="Pt0.A1.T3.3.3.1.m1.1.1.2.3">𝑟</ci></apply><ci id="Pt0.A1.T3.3.3.1.m1.1.1.3.cmml" xref="Pt0.A1.T3.3.3.1.m1.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.3.3.1.m1.1c">N_{r}\times D</annotation></semantics></math></td>
<td id="Pt0.A1.T3.4.4.2" class="ltx_td ltx_align_left"><math id="Pt0.A1.T3.4.4.2.m1.1" class="ltx_Math" alttext="\mathcal{O}(N)" display="inline"><semantics id="Pt0.A1.T3.4.4.2.m1.1a"><mrow id="Pt0.A1.T3.4.4.2.m1.1.2" xref="Pt0.A1.T3.4.4.2.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Pt0.A1.T3.4.4.2.m1.1.2.2" xref="Pt0.A1.T3.4.4.2.m1.1.2.2.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.4.4.2.m1.1.2.1" xref="Pt0.A1.T3.4.4.2.m1.1.2.1.cmml">​</mo><mrow id="Pt0.A1.T3.4.4.2.m1.1.2.3.2" xref="Pt0.A1.T3.4.4.2.m1.1.2.cmml"><mo stretchy="false" id="Pt0.A1.T3.4.4.2.m1.1.2.3.2.1" xref="Pt0.A1.T3.4.4.2.m1.1.2.cmml">(</mo><mi id="Pt0.A1.T3.4.4.2.m1.1.1" xref="Pt0.A1.T3.4.4.2.m1.1.1.cmml">N</mi><mo stretchy="false" id="Pt0.A1.T3.4.4.2.m1.1.2.3.2.2" xref="Pt0.A1.T3.4.4.2.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.4.4.2.m1.1b"><apply id="Pt0.A1.T3.4.4.2.m1.1.2.cmml" xref="Pt0.A1.T3.4.4.2.m1.1.2"><times id="Pt0.A1.T3.4.4.2.m1.1.2.1.cmml" xref="Pt0.A1.T3.4.4.2.m1.1.2.1"></times><ci id="Pt0.A1.T3.4.4.2.m1.1.2.2.cmml" xref="Pt0.A1.T3.4.4.2.m1.1.2.2">𝒪</ci><ci id="Pt0.A1.T3.4.4.2.m1.1.1.cmml" xref="Pt0.A1.T3.4.4.2.m1.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.4.4.2.m1.1c">\mathcal{O}(N)</annotation></semantics></math></td>
</tr>
<tr id="Pt0.A1.T3.6.6" class="ltx_tr">
<th id="Pt0.A1.T3.6.6.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">GAT</th>
<th id="Pt0.A1.T3.6.6.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Conv layer weight</th>
<td id="Pt0.A1.T3.5.5.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><math id="Pt0.A1.T3.5.5.1.m1.1" class="ltx_Math" alttext="d\times H_{1}" display="inline"><semantics id="Pt0.A1.T3.5.5.1.m1.1a"><mrow id="Pt0.A1.T3.5.5.1.m1.1.1" xref="Pt0.A1.T3.5.5.1.m1.1.1.cmml"><mi id="Pt0.A1.T3.5.5.1.m1.1.1.2" xref="Pt0.A1.T3.5.5.1.m1.1.1.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="Pt0.A1.T3.5.5.1.m1.1.1.1" xref="Pt0.A1.T3.5.5.1.m1.1.1.1.cmml">×</mo><msub id="Pt0.A1.T3.5.5.1.m1.1.1.3" xref="Pt0.A1.T3.5.5.1.m1.1.1.3.cmml"><mi id="Pt0.A1.T3.5.5.1.m1.1.1.3.2" xref="Pt0.A1.T3.5.5.1.m1.1.1.3.2.cmml">H</mi><mn id="Pt0.A1.T3.5.5.1.m1.1.1.3.3" xref="Pt0.A1.T3.5.5.1.m1.1.1.3.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.5.5.1.m1.1b"><apply id="Pt0.A1.T3.5.5.1.m1.1.1.cmml" xref="Pt0.A1.T3.5.5.1.m1.1.1"><times id="Pt0.A1.T3.5.5.1.m1.1.1.1.cmml" xref="Pt0.A1.T3.5.5.1.m1.1.1.1"></times><ci id="Pt0.A1.T3.5.5.1.m1.1.1.2.cmml" xref="Pt0.A1.T3.5.5.1.m1.1.1.2">𝑑</ci><apply id="Pt0.A1.T3.5.5.1.m1.1.1.3.cmml" xref="Pt0.A1.T3.5.5.1.m1.1.1.3"><csymbol cd="ambiguous" id="Pt0.A1.T3.5.5.1.m1.1.1.3.1.cmml" xref="Pt0.A1.T3.5.5.1.m1.1.1.3">subscript</csymbol><ci id="Pt0.A1.T3.5.5.1.m1.1.1.3.2.cmml" xref="Pt0.A1.T3.5.5.1.m1.1.1.3.2">𝐻</ci><cn type="integer" id="Pt0.A1.T3.5.5.1.m1.1.1.3.3.cmml" xref="Pt0.A1.T3.5.5.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.5.5.1.m1.1c">d\times H_{1}</annotation></semantics></math></td>
<td id="Pt0.A1.T3.6.6.2" class="ltx_td ltx_align_left ltx_border_t"><math id="Pt0.A1.T3.6.6.2.m1.1" class="ltx_Math" alttext="\mathcal{O}(BHN_{e})" display="inline"><semantics id="Pt0.A1.T3.6.6.2.m1.1a"><mrow id="Pt0.A1.T3.6.6.2.m1.1.1" xref="Pt0.A1.T3.6.6.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Pt0.A1.T3.6.6.2.m1.1.1.3" xref="Pt0.A1.T3.6.6.2.m1.1.1.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.6.6.2.m1.1.1.2" xref="Pt0.A1.T3.6.6.2.m1.1.1.2.cmml">​</mo><mrow id="Pt0.A1.T3.6.6.2.m1.1.1.1.1" xref="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="Pt0.A1.T3.6.6.2.m1.1.1.1.1.2" xref="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.cmml">(</mo><mrow id="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1" xref="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.cmml"><mi id="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.2" xref="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.1" xref="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.1.cmml">​</mo><mi id="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.3" xref="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.3.cmml">H</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.1a" xref="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.1.cmml">​</mo><msub id="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.4" xref="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.4.cmml"><mi id="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.4.2" xref="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.4.2.cmml">N</mi><mi id="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.4.3" xref="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.4.3.cmml">e</mi></msub></mrow><mo stretchy="false" id="Pt0.A1.T3.6.6.2.m1.1.1.1.1.3" xref="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.6.6.2.m1.1b"><apply id="Pt0.A1.T3.6.6.2.m1.1.1.cmml" xref="Pt0.A1.T3.6.6.2.m1.1.1"><times id="Pt0.A1.T3.6.6.2.m1.1.1.2.cmml" xref="Pt0.A1.T3.6.6.2.m1.1.1.2"></times><ci id="Pt0.A1.T3.6.6.2.m1.1.1.3.cmml" xref="Pt0.A1.T3.6.6.2.m1.1.1.3">𝒪</ci><apply id="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.cmml" xref="Pt0.A1.T3.6.6.2.m1.1.1.1.1"><times id="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.1.cmml" xref="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.1"></times><ci id="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.2.cmml" xref="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.2">𝐵</ci><ci id="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.3.cmml" xref="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.3">𝐻</ci><apply id="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.4.cmml" xref="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.4.1.cmml" xref="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.4">subscript</csymbol><ci id="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.4.2.cmml" xref="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.4.2">𝑁</ci><ci id="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.4.3.cmml" xref="Pt0.A1.T3.6.6.2.m1.1.1.1.1.1.4.3">𝑒</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.6.6.2.m1.1c">\mathcal{O}(BHN_{e})</annotation></semantics></math></td>
</tr>
<tr id="Pt0.A1.T3.8.8" class="ltx_tr">
<th id="Pt0.A1.T3.8.8.3" class="ltx_td ltx_th ltx_th_row ltx_border_r"></th>
<th id="Pt0.A1.T3.8.8.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Conv layer attention</th>
<td id="Pt0.A1.T3.7.7.1" class="ltx_td ltx_align_left ltx_border_r"><math id="Pt0.A1.T3.7.7.1.m1.1" class="ltx_Math" alttext="d\times H_{1}" display="inline"><semantics id="Pt0.A1.T3.7.7.1.m1.1a"><mrow id="Pt0.A1.T3.7.7.1.m1.1.1" xref="Pt0.A1.T3.7.7.1.m1.1.1.cmml"><mi id="Pt0.A1.T3.7.7.1.m1.1.1.2" xref="Pt0.A1.T3.7.7.1.m1.1.1.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="Pt0.A1.T3.7.7.1.m1.1.1.1" xref="Pt0.A1.T3.7.7.1.m1.1.1.1.cmml">×</mo><msub id="Pt0.A1.T3.7.7.1.m1.1.1.3" xref="Pt0.A1.T3.7.7.1.m1.1.1.3.cmml"><mi id="Pt0.A1.T3.7.7.1.m1.1.1.3.2" xref="Pt0.A1.T3.7.7.1.m1.1.1.3.2.cmml">H</mi><mn id="Pt0.A1.T3.7.7.1.m1.1.1.3.3" xref="Pt0.A1.T3.7.7.1.m1.1.1.3.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.7.7.1.m1.1b"><apply id="Pt0.A1.T3.7.7.1.m1.1.1.cmml" xref="Pt0.A1.T3.7.7.1.m1.1.1"><times id="Pt0.A1.T3.7.7.1.m1.1.1.1.cmml" xref="Pt0.A1.T3.7.7.1.m1.1.1.1"></times><ci id="Pt0.A1.T3.7.7.1.m1.1.1.2.cmml" xref="Pt0.A1.T3.7.7.1.m1.1.1.2">𝑑</ci><apply id="Pt0.A1.T3.7.7.1.m1.1.1.3.cmml" xref="Pt0.A1.T3.7.7.1.m1.1.1.3"><csymbol cd="ambiguous" id="Pt0.A1.T3.7.7.1.m1.1.1.3.1.cmml" xref="Pt0.A1.T3.7.7.1.m1.1.1.3">subscript</csymbol><ci id="Pt0.A1.T3.7.7.1.m1.1.1.3.2.cmml" xref="Pt0.A1.T3.7.7.1.m1.1.1.3.2">𝐻</ci><cn type="integer" id="Pt0.A1.T3.7.7.1.m1.1.1.3.3.cmml" xref="Pt0.A1.T3.7.7.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.7.7.1.m1.1c">d\times H_{1}</annotation></semantics></math></td>
<td id="Pt0.A1.T3.8.8.2" class="ltx_td ltx_align_left"><math id="Pt0.A1.T3.8.8.2.m1.1" class="ltx_Math" alttext="\mathcal{O}(BHN_{e})" display="inline"><semantics id="Pt0.A1.T3.8.8.2.m1.1a"><mrow id="Pt0.A1.T3.8.8.2.m1.1.1" xref="Pt0.A1.T3.8.8.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Pt0.A1.T3.8.8.2.m1.1.1.3" xref="Pt0.A1.T3.8.8.2.m1.1.1.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.8.8.2.m1.1.1.2" xref="Pt0.A1.T3.8.8.2.m1.1.1.2.cmml">​</mo><mrow id="Pt0.A1.T3.8.8.2.m1.1.1.1.1" xref="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="Pt0.A1.T3.8.8.2.m1.1.1.1.1.2" xref="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.cmml">(</mo><mrow id="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1" xref="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.cmml"><mi id="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.2" xref="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.1" xref="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.1.cmml">​</mo><mi id="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.3" xref="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.3.cmml">H</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.1a" xref="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.1.cmml">​</mo><msub id="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.4" xref="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.4.cmml"><mi id="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.4.2" xref="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.4.2.cmml">N</mi><mi id="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.4.3" xref="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.4.3.cmml">e</mi></msub></mrow><mo stretchy="false" id="Pt0.A1.T3.8.8.2.m1.1.1.1.1.3" xref="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.8.8.2.m1.1b"><apply id="Pt0.A1.T3.8.8.2.m1.1.1.cmml" xref="Pt0.A1.T3.8.8.2.m1.1.1"><times id="Pt0.A1.T3.8.8.2.m1.1.1.2.cmml" xref="Pt0.A1.T3.8.8.2.m1.1.1.2"></times><ci id="Pt0.A1.T3.8.8.2.m1.1.1.3.cmml" xref="Pt0.A1.T3.8.8.2.m1.1.1.3">𝒪</ci><apply id="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.cmml" xref="Pt0.A1.T3.8.8.2.m1.1.1.1.1"><times id="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.1.cmml" xref="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.1"></times><ci id="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.2.cmml" xref="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.2">𝐵</ci><ci id="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.3.cmml" xref="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.3">𝐻</ci><apply id="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.4.cmml" xref="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.4.1.cmml" xref="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.4">subscript</csymbol><ci id="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.4.2.cmml" xref="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.4.2">𝑁</ci><ci id="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.4.3.cmml" xref="Pt0.A1.T3.8.8.2.m1.1.1.1.1.1.4.3">𝑒</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.8.8.2.m1.1c">\mathcal{O}(BHN_{e})</annotation></semantics></math></td>
</tr>
<tr id="Pt0.A1.T3.10.10" class="ltx_tr">
<th id="Pt0.A1.T3.10.10.3" class="ltx_td ltx_th ltx_th_row ltx_border_r"></th>
<th id="Pt0.A1.T3.10.10.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Conv layer bias</th>
<td id="Pt0.A1.T3.9.9.1" class="ltx_td ltx_align_left ltx_border_r"><math id="Pt0.A1.T3.9.9.1.m1.1" class="ltx_Math" alttext="H_{1}" display="inline"><semantics id="Pt0.A1.T3.9.9.1.m1.1a"><msub id="Pt0.A1.T3.9.9.1.m1.1.1" xref="Pt0.A1.T3.9.9.1.m1.1.1.cmml"><mi id="Pt0.A1.T3.9.9.1.m1.1.1.2" xref="Pt0.A1.T3.9.9.1.m1.1.1.2.cmml">H</mi><mn id="Pt0.A1.T3.9.9.1.m1.1.1.3" xref="Pt0.A1.T3.9.9.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.9.9.1.m1.1b"><apply id="Pt0.A1.T3.9.9.1.m1.1.1.cmml" xref="Pt0.A1.T3.9.9.1.m1.1.1"><csymbol cd="ambiguous" id="Pt0.A1.T3.9.9.1.m1.1.1.1.cmml" xref="Pt0.A1.T3.9.9.1.m1.1.1">subscript</csymbol><ci id="Pt0.A1.T3.9.9.1.m1.1.1.2.cmml" xref="Pt0.A1.T3.9.9.1.m1.1.1.2">𝐻</ci><cn type="integer" id="Pt0.A1.T3.9.9.1.m1.1.1.3.cmml" xref="Pt0.A1.T3.9.9.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.9.9.1.m1.1c">H_{1}</annotation></semantics></math></td>
<td id="Pt0.A1.T3.10.10.2" class="ltx_td ltx_align_left"><math id="Pt0.A1.T3.10.10.2.m1.1" class="ltx_Math" alttext="\mathcal{O}(BHN_{e})" display="inline"><semantics id="Pt0.A1.T3.10.10.2.m1.1a"><mrow id="Pt0.A1.T3.10.10.2.m1.1.1" xref="Pt0.A1.T3.10.10.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Pt0.A1.T3.10.10.2.m1.1.1.3" xref="Pt0.A1.T3.10.10.2.m1.1.1.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.10.10.2.m1.1.1.2" xref="Pt0.A1.T3.10.10.2.m1.1.1.2.cmml">​</mo><mrow id="Pt0.A1.T3.10.10.2.m1.1.1.1.1" xref="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="Pt0.A1.T3.10.10.2.m1.1.1.1.1.2" xref="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.cmml">(</mo><mrow id="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1" xref="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.cmml"><mi id="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.2" xref="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.1" xref="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.1.cmml">​</mo><mi id="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.3" xref="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.3.cmml">H</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.1a" xref="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.1.cmml">​</mo><msub id="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.4" xref="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.4.cmml"><mi id="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.4.2" xref="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.4.2.cmml">N</mi><mi id="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.4.3" xref="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.4.3.cmml">e</mi></msub></mrow><mo stretchy="false" id="Pt0.A1.T3.10.10.2.m1.1.1.1.1.3" xref="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.10.10.2.m1.1b"><apply id="Pt0.A1.T3.10.10.2.m1.1.1.cmml" xref="Pt0.A1.T3.10.10.2.m1.1.1"><times id="Pt0.A1.T3.10.10.2.m1.1.1.2.cmml" xref="Pt0.A1.T3.10.10.2.m1.1.1.2"></times><ci id="Pt0.A1.T3.10.10.2.m1.1.1.3.cmml" xref="Pt0.A1.T3.10.10.2.m1.1.1.3">𝒪</ci><apply id="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.cmml" xref="Pt0.A1.T3.10.10.2.m1.1.1.1.1"><times id="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.1.cmml" xref="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.1"></times><ci id="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.2.cmml" xref="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.2">𝐵</ci><ci id="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.3.cmml" xref="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.3">𝐻</ci><apply id="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.4.cmml" xref="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.4.1.cmml" xref="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.4">subscript</csymbol><ci id="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.4.2.cmml" xref="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.4.2">𝑁</ci><ci id="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.4.3.cmml" xref="Pt0.A1.T3.10.10.2.m1.1.1.1.1.1.4.3">𝑒</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.10.10.2.m1.1c">\mathcal{O}(BHN_{e})</annotation></semantics></math></td>
</tr>
<tr id="Pt0.A1.T3.12.12" class="ltx_tr">
<th id="Pt0.A1.T3.12.12.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Transformer</th>
<th id="Pt0.A1.T3.12.12.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Positional encoder</th>
<td id="Pt0.A1.T3.11.11.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><math id="Pt0.A1.T3.11.11.1.m1.1" class="ltx_Math" alttext="d\times d" display="inline"><semantics id="Pt0.A1.T3.11.11.1.m1.1a"><mrow id="Pt0.A1.T3.11.11.1.m1.1.1" xref="Pt0.A1.T3.11.11.1.m1.1.1.cmml"><mi id="Pt0.A1.T3.11.11.1.m1.1.1.2" xref="Pt0.A1.T3.11.11.1.m1.1.1.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="Pt0.A1.T3.11.11.1.m1.1.1.1" xref="Pt0.A1.T3.11.11.1.m1.1.1.1.cmml">×</mo><mi id="Pt0.A1.T3.11.11.1.m1.1.1.3" xref="Pt0.A1.T3.11.11.1.m1.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.11.11.1.m1.1b"><apply id="Pt0.A1.T3.11.11.1.m1.1.1.cmml" xref="Pt0.A1.T3.11.11.1.m1.1.1"><times id="Pt0.A1.T3.11.11.1.m1.1.1.1.cmml" xref="Pt0.A1.T3.11.11.1.m1.1.1.1"></times><ci id="Pt0.A1.T3.11.11.1.m1.1.1.2.cmml" xref="Pt0.A1.T3.11.11.1.m1.1.1.2">𝑑</ci><ci id="Pt0.A1.T3.11.11.1.m1.1.1.3.cmml" xref="Pt0.A1.T3.11.11.1.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.11.11.1.m1.1c">d\times d</annotation></semantics></math></td>
<td id="Pt0.A1.T3.12.12.2" class="ltx_td ltx_align_left ltx_border_t"><math id="Pt0.A1.T3.12.12.2.m1.1" class="ltx_Math" alttext="\mathcal{O}(N_{e})" display="inline"><semantics id="Pt0.A1.T3.12.12.2.m1.1a"><mrow id="Pt0.A1.T3.12.12.2.m1.1.1" xref="Pt0.A1.T3.12.12.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Pt0.A1.T3.12.12.2.m1.1.1.3" xref="Pt0.A1.T3.12.12.2.m1.1.1.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.12.12.2.m1.1.1.2" xref="Pt0.A1.T3.12.12.2.m1.1.1.2.cmml">​</mo><mrow id="Pt0.A1.T3.12.12.2.m1.1.1.1.1" xref="Pt0.A1.T3.12.12.2.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="Pt0.A1.T3.12.12.2.m1.1.1.1.1.2" xref="Pt0.A1.T3.12.12.2.m1.1.1.1.1.1.cmml">(</mo><msub id="Pt0.A1.T3.12.12.2.m1.1.1.1.1.1" xref="Pt0.A1.T3.12.12.2.m1.1.1.1.1.1.cmml"><mi id="Pt0.A1.T3.12.12.2.m1.1.1.1.1.1.2" xref="Pt0.A1.T3.12.12.2.m1.1.1.1.1.1.2.cmml">N</mi><mi id="Pt0.A1.T3.12.12.2.m1.1.1.1.1.1.3" xref="Pt0.A1.T3.12.12.2.m1.1.1.1.1.1.3.cmml">e</mi></msub><mo stretchy="false" id="Pt0.A1.T3.12.12.2.m1.1.1.1.1.3" xref="Pt0.A1.T3.12.12.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.12.12.2.m1.1b"><apply id="Pt0.A1.T3.12.12.2.m1.1.1.cmml" xref="Pt0.A1.T3.12.12.2.m1.1.1"><times id="Pt0.A1.T3.12.12.2.m1.1.1.2.cmml" xref="Pt0.A1.T3.12.12.2.m1.1.1.2"></times><ci id="Pt0.A1.T3.12.12.2.m1.1.1.3.cmml" xref="Pt0.A1.T3.12.12.2.m1.1.1.3">𝒪</ci><apply id="Pt0.A1.T3.12.12.2.m1.1.1.1.1.1.cmml" xref="Pt0.A1.T3.12.12.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="Pt0.A1.T3.12.12.2.m1.1.1.1.1.1.1.cmml" xref="Pt0.A1.T3.12.12.2.m1.1.1.1.1">subscript</csymbol><ci id="Pt0.A1.T3.12.12.2.m1.1.1.1.1.1.2.cmml" xref="Pt0.A1.T3.12.12.2.m1.1.1.1.1.1.2">𝑁</ci><ci id="Pt0.A1.T3.12.12.2.m1.1.1.1.1.1.3.cmml" xref="Pt0.A1.T3.12.12.2.m1.1.1.1.1.1.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.12.12.2.m1.1c">\mathcal{O}(N_{e})</annotation></semantics></math></td>
</tr>
<tr id="Pt0.A1.T3.15.15" class="ltx_tr">
<th id="Pt0.A1.T3.15.15.4" class="ltx_td ltx_th ltx_th_row ltx_border_r"></th>
<th id="Pt0.A1.T3.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Layer self attention <math id="Pt0.A1.T3.13.13.1.m1.1" class="ltx_Math" alttext="(qkv)" display="inline"><semantics id="Pt0.A1.T3.13.13.1.m1.1a"><mrow id="Pt0.A1.T3.13.13.1.m1.1.1.1" xref="Pt0.A1.T3.13.13.1.m1.1.1.1.1.cmml"><mo stretchy="false" id="Pt0.A1.T3.13.13.1.m1.1.1.1.2" xref="Pt0.A1.T3.13.13.1.m1.1.1.1.1.cmml">(</mo><mrow id="Pt0.A1.T3.13.13.1.m1.1.1.1.1" xref="Pt0.A1.T3.13.13.1.m1.1.1.1.1.cmml"><mi id="Pt0.A1.T3.13.13.1.m1.1.1.1.1.2" xref="Pt0.A1.T3.13.13.1.m1.1.1.1.1.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.13.13.1.m1.1.1.1.1.1" xref="Pt0.A1.T3.13.13.1.m1.1.1.1.1.1.cmml">​</mo><mi id="Pt0.A1.T3.13.13.1.m1.1.1.1.1.3" xref="Pt0.A1.T3.13.13.1.m1.1.1.1.1.3.cmml">k</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.13.13.1.m1.1.1.1.1.1a" xref="Pt0.A1.T3.13.13.1.m1.1.1.1.1.1.cmml">​</mo><mi id="Pt0.A1.T3.13.13.1.m1.1.1.1.1.4" xref="Pt0.A1.T3.13.13.1.m1.1.1.1.1.4.cmml">v</mi></mrow><mo stretchy="false" id="Pt0.A1.T3.13.13.1.m1.1.1.1.3" xref="Pt0.A1.T3.13.13.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.13.13.1.m1.1b"><apply id="Pt0.A1.T3.13.13.1.m1.1.1.1.1.cmml" xref="Pt0.A1.T3.13.13.1.m1.1.1.1"><times id="Pt0.A1.T3.13.13.1.m1.1.1.1.1.1.cmml" xref="Pt0.A1.T3.13.13.1.m1.1.1.1.1.1"></times><ci id="Pt0.A1.T3.13.13.1.m1.1.1.1.1.2.cmml" xref="Pt0.A1.T3.13.13.1.m1.1.1.1.1.2">𝑞</ci><ci id="Pt0.A1.T3.13.13.1.m1.1.1.1.1.3.cmml" xref="Pt0.A1.T3.13.13.1.m1.1.1.1.1.3">𝑘</ci><ci id="Pt0.A1.T3.13.13.1.m1.1.1.1.1.4.cmml" xref="Pt0.A1.T3.13.13.1.m1.1.1.1.1.4">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.13.13.1.m1.1c">(qkv)</annotation></semantics></math>
</th>
<td id="Pt0.A1.T3.14.14.2" class="ltx_td ltx_align_left ltx_border_r"><math id="Pt0.A1.T3.14.14.2.m1.1" class="ltx_Math" alttext="H_{t}(512)\times d" display="inline"><semantics id="Pt0.A1.T3.14.14.2.m1.1a"><mrow id="Pt0.A1.T3.14.14.2.m1.1.2" xref="Pt0.A1.T3.14.14.2.m1.1.2.cmml"><mrow id="Pt0.A1.T3.14.14.2.m1.1.2.2" xref="Pt0.A1.T3.14.14.2.m1.1.2.2.cmml"><msub id="Pt0.A1.T3.14.14.2.m1.1.2.2.2" xref="Pt0.A1.T3.14.14.2.m1.1.2.2.2.cmml"><mi id="Pt0.A1.T3.14.14.2.m1.1.2.2.2.2" xref="Pt0.A1.T3.14.14.2.m1.1.2.2.2.2.cmml">H</mi><mi id="Pt0.A1.T3.14.14.2.m1.1.2.2.2.3" xref="Pt0.A1.T3.14.14.2.m1.1.2.2.2.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.14.14.2.m1.1.2.2.1" xref="Pt0.A1.T3.14.14.2.m1.1.2.2.1.cmml">​</mo><mrow id="Pt0.A1.T3.14.14.2.m1.1.2.2.3.2" xref="Pt0.A1.T3.14.14.2.m1.1.2.2.cmml"><mo stretchy="false" id="Pt0.A1.T3.14.14.2.m1.1.2.2.3.2.1" xref="Pt0.A1.T3.14.14.2.m1.1.2.2.cmml">(</mo><mn id="Pt0.A1.T3.14.14.2.m1.1.1" xref="Pt0.A1.T3.14.14.2.m1.1.1.cmml">512</mn><mo rspace="0.055em" stretchy="false" id="Pt0.A1.T3.14.14.2.m1.1.2.2.3.2.2" xref="Pt0.A1.T3.14.14.2.m1.1.2.2.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="Pt0.A1.T3.14.14.2.m1.1.2.1" xref="Pt0.A1.T3.14.14.2.m1.1.2.1.cmml">×</mo><mi id="Pt0.A1.T3.14.14.2.m1.1.2.3" xref="Pt0.A1.T3.14.14.2.m1.1.2.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.14.14.2.m1.1b"><apply id="Pt0.A1.T3.14.14.2.m1.1.2.cmml" xref="Pt0.A1.T3.14.14.2.m1.1.2"><times id="Pt0.A1.T3.14.14.2.m1.1.2.1.cmml" xref="Pt0.A1.T3.14.14.2.m1.1.2.1"></times><apply id="Pt0.A1.T3.14.14.2.m1.1.2.2.cmml" xref="Pt0.A1.T3.14.14.2.m1.1.2.2"><times id="Pt0.A1.T3.14.14.2.m1.1.2.2.1.cmml" xref="Pt0.A1.T3.14.14.2.m1.1.2.2.1"></times><apply id="Pt0.A1.T3.14.14.2.m1.1.2.2.2.cmml" xref="Pt0.A1.T3.14.14.2.m1.1.2.2.2"><csymbol cd="ambiguous" id="Pt0.A1.T3.14.14.2.m1.1.2.2.2.1.cmml" xref="Pt0.A1.T3.14.14.2.m1.1.2.2.2">subscript</csymbol><ci id="Pt0.A1.T3.14.14.2.m1.1.2.2.2.2.cmml" xref="Pt0.A1.T3.14.14.2.m1.1.2.2.2.2">𝐻</ci><ci id="Pt0.A1.T3.14.14.2.m1.1.2.2.2.3.cmml" xref="Pt0.A1.T3.14.14.2.m1.1.2.2.2.3">𝑡</ci></apply><cn type="integer" id="Pt0.A1.T3.14.14.2.m1.1.1.cmml" xref="Pt0.A1.T3.14.14.2.m1.1.1">512</cn></apply><ci id="Pt0.A1.T3.14.14.2.m1.1.2.3.cmml" xref="Pt0.A1.T3.14.14.2.m1.1.2.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.14.14.2.m1.1c">H_{t}(512)\times d</annotation></semantics></math></td>
<td id="Pt0.A1.T3.15.15.3" class="ltx_td ltx_align_left"><math id="Pt0.A1.T3.15.15.3.m1.1" class="ltx_Math" alttext="3\times H_{t}\times d" display="inline"><semantics id="Pt0.A1.T3.15.15.3.m1.1a"><mrow id="Pt0.A1.T3.15.15.3.m1.1.1" xref="Pt0.A1.T3.15.15.3.m1.1.1.cmml"><mn id="Pt0.A1.T3.15.15.3.m1.1.1.2" xref="Pt0.A1.T3.15.15.3.m1.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="Pt0.A1.T3.15.15.3.m1.1.1.1" xref="Pt0.A1.T3.15.15.3.m1.1.1.1.cmml">×</mo><msub id="Pt0.A1.T3.15.15.3.m1.1.1.3" xref="Pt0.A1.T3.15.15.3.m1.1.1.3.cmml"><mi id="Pt0.A1.T3.15.15.3.m1.1.1.3.2" xref="Pt0.A1.T3.15.15.3.m1.1.1.3.2.cmml">H</mi><mi id="Pt0.A1.T3.15.15.3.m1.1.1.3.3" xref="Pt0.A1.T3.15.15.3.m1.1.1.3.3.cmml">t</mi></msub><mo lspace="0.222em" rspace="0.222em" id="Pt0.A1.T3.15.15.3.m1.1.1.1a" xref="Pt0.A1.T3.15.15.3.m1.1.1.1.cmml">×</mo><mi id="Pt0.A1.T3.15.15.3.m1.1.1.4" xref="Pt0.A1.T3.15.15.3.m1.1.1.4.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.15.15.3.m1.1b"><apply id="Pt0.A1.T3.15.15.3.m1.1.1.cmml" xref="Pt0.A1.T3.15.15.3.m1.1.1"><times id="Pt0.A1.T3.15.15.3.m1.1.1.1.cmml" xref="Pt0.A1.T3.15.15.3.m1.1.1.1"></times><cn type="integer" id="Pt0.A1.T3.15.15.3.m1.1.1.2.cmml" xref="Pt0.A1.T3.15.15.3.m1.1.1.2">3</cn><apply id="Pt0.A1.T3.15.15.3.m1.1.1.3.cmml" xref="Pt0.A1.T3.15.15.3.m1.1.1.3"><csymbol cd="ambiguous" id="Pt0.A1.T3.15.15.3.m1.1.1.3.1.cmml" xref="Pt0.A1.T3.15.15.3.m1.1.1.3">subscript</csymbol><ci id="Pt0.A1.T3.15.15.3.m1.1.1.3.2.cmml" xref="Pt0.A1.T3.15.15.3.m1.1.1.3.2">𝐻</ci><ci id="Pt0.A1.T3.15.15.3.m1.1.1.3.3.cmml" xref="Pt0.A1.T3.15.15.3.m1.1.1.3.3">𝑡</ci></apply><ci id="Pt0.A1.T3.15.15.3.m1.1.1.4.cmml" xref="Pt0.A1.T3.15.15.3.m1.1.1.4">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.15.15.3.m1.1c">3\times H_{t}\times d</annotation></semantics></math></td>
</tr>
<tr id="Pt0.A1.T3.18.18" class="ltx_tr">
<th id="Pt0.A1.T3.18.18.4" class="ltx_td ltx_th ltx_th_row ltx_border_r"></th>
<th id="Pt0.A1.T3.16.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Self attn norm <math id="Pt0.A1.T3.16.16.1.m1.2" class="ltx_Math" alttext="(W,b)" display="inline"><semantics id="Pt0.A1.T3.16.16.1.m1.2a"><mrow id="Pt0.A1.T3.16.16.1.m1.2.3.2" xref="Pt0.A1.T3.16.16.1.m1.2.3.1.cmml"><mo stretchy="false" id="Pt0.A1.T3.16.16.1.m1.2.3.2.1" xref="Pt0.A1.T3.16.16.1.m1.2.3.1.cmml">(</mo><mi id="Pt0.A1.T3.16.16.1.m1.1.1" xref="Pt0.A1.T3.16.16.1.m1.1.1.cmml">W</mi><mo id="Pt0.A1.T3.16.16.1.m1.2.3.2.2" xref="Pt0.A1.T3.16.16.1.m1.2.3.1.cmml">,</mo><mi id="Pt0.A1.T3.16.16.1.m1.2.2" xref="Pt0.A1.T3.16.16.1.m1.2.2.cmml">b</mi><mo stretchy="false" id="Pt0.A1.T3.16.16.1.m1.2.3.2.3" xref="Pt0.A1.T3.16.16.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.16.16.1.m1.2b"><interval closure="open" id="Pt0.A1.T3.16.16.1.m1.2.3.1.cmml" xref="Pt0.A1.T3.16.16.1.m1.2.3.2"><ci id="Pt0.A1.T3.16.16.1.m1.1.1.cmml" xref="Pt0.A1.T3.16.16.1.m1.1.1">𝑊</ci><ci id="Pt0.A1.T3.16.16.1.m1.2.2.cmml" xref="Pt0.A1.T3.16.16.1.m1.2.2">𝑏</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.16.16.1.m1.2c">(W,b)</annotation></semantics></math>
</th>
<td id="Pt0.A1.T3.17.17.2" class="ltx_td ltx_align_left ltx_border_r"><math id="Pt0.A1.T3.17.17.2.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="Pt0.A1.T3.17.17.2.m1.1a"><mi id="Pt0.A1.T3.17.17.2.m1.1.1" xref="Pt0.A1.T3.17.17.2.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.17.17.2.m1.1b"><ci id="Pt0.A1.T3.17.17.2.m1.1.1.cmml" xref="Pt0.A1.T3.17.17.2.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.17.17.2.m1.1c">d</annotation></semantics></math></td>
<td id="Pt0.A1.T3.18.18.3" class="ltx_td ltx_align_left"><math id="Pt0.A1.T3.18.18.3.m1.1" class="ltx_Math" alttext="2\times d" display="inline"><semantics id="Pt0.A1.T3.18.18.3.m1.1a"><mrow id="Pt0.A1.T3.18.18.3.m1.1.1" xref="Pt0.A1.T3.18.18.3.m1.1.1.cmml"><mn id="Pt0.A1.T3.18.18.3.m1.1.1.2" xref="Pt0.A1.T3.18.18.3.m1.1.1.2.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="Pt0.A1.T3.18.18.3.m1.1.1.1" xref="Pt0.A1.T3.18.18.3.m1.1.1.1.cmml">×</mo><mi id="Pt0.A1.T3.18.18.3.m1.1.1.3" xref="Pt0.A1.T3.18.18.3.m1.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.18.18.3.m1.1b"><apply id="Pt0.A1.T3.18.18.3.m1.1.1.cmml" xref="Pt0.A1.T3.18.18.3.m1.1.1"><times id="Pt0.A1.T3.18.18.3.m1.1.1.1.cmml" xref="Pt0.A1.T3.18.18.3.m1.1.1.1"></times><cn type="integer" id="Pt0.A1.T3.18.18.3.m1.1.1.2.cmml" xref="Pt0.A1.T3.18.18.3.m1.1.1.2">2</cn><ci id="Pt0.A1.T3.18.18.3.m1.1.1.3.cmml" xref="Pt0.A1.T3.18.18.3.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.18.18.3.m1.1c">2\times d</annotation></semantics></math></td>
</tr>
<tr id="Pt0.A1.T3.20.20" class="ltx_tr">
<th id="Pt0.A1.T3.20.20.3" class="ltx_td ltx_th ltx_th_row ltx_border_r"></th>
<th id="Pt0.A1.T3.20.20.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Layer enc attn</th>
<td id="Pt0.A1.T3.19.19.1" class="ltx_td ltx_align_left ltx_border_r"><math id="Pt0.A1.T3.19.19.1.m1.1" class="ltx_Math" alttext="H_{t}(512)\times d" display="inline"><semantics id="Pt0.A1.T3.19.19.1.m1.1a"><mrow id="Pt0.A1.T3.19.19.1.m1.1.2" xref="Pt0.A1.T3.19.19.1.m1.1.2.cmml"><mrow id="Pt0.A1.T3.19.19.1.m1.1.2.2" xref="Pt0.A1.T3.19.19.1.m1.1.2.2.cmml"><msub id="Pt0.A1.T3.19.19.1.m1.1.2.2.2" xref="Pt0.A1.T3.19.19.1.m1.1.2.2.2.cmml"><mi id="Pt0.A1.T3.19.19.1.m1.1.2.2.2.2" xref="Pt0.A1.T3.19.19.1.m1.1.2.2.2.2.cmml">H</mi><mi id="Pt0.A1.T3.19.19.1.m1.1.2.2.2.3" xref="Pt0.A1.T3.19.19.1.m1.1.2.2.2.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.19.19.1.m1.1.2.2.1" xref="Pt0.A1.T3.19.19.1.m1.1.2.2.1.cmml">​</mo><mrow id="Pt0.A1.T3.19.19.1.m1.1.2.2.3.2" xref="Pt0.A1.T3.19.19.1.m1.1.2.2.cmml"><mo stretchy="false" id="Pt0.A1.T3.19.19.1.m1.1.2.2.3.2.1" xref="Pt0.A1.T3.19.19.1.m1.1.2.2.cmml">(</mo><mn id="Pt0.A1.T3.19.19.1.m1.1.1" xref="Pt0.A1.T3.19.19.1.m1.1.1.cmml">512</mn><mo rspace="0.055em" stretchy="false" id="Pt0.A1.T3.19.19.1.m1.1.2.2.3.2.2" xref="Pt0.A1.T3.19.19.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="Pt0.A1.T3.19.19.1.m1.1.2.1" xref="Pt0.A1.T3.19.19.1.m1.1.2.1.cmml">×</mo><mi id="Pt0.A1.T3.19.19.1.m1.1.2.3" xref="Pt0.A1.T3.19.19.1.m1.1.2.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.19.19.1.m1.1b"><apply id="Pt0.A1.T3.19.19.1.m1.1.2.cmml" xref="Pt0.A1.T3.19.19.1.m1.1.2"><times id="Pt0.A1.T3.19.19.1.m1.1.2.1.cmml" xref="Pt0.A1.T3.19.19.1.m1.1.2.1"></times><apply id="Pt0.A1.T3.19.19.1.m1.1.2.2.cmml" xref="Pt0.A1.T3.19.19.1.m1.1.2.2"><times id="Pt0.A1.T3.19.19.1.m1.1.2.2.1.cmml" xref="Pt0.A1.T3.19.19.1.m1.1.2.2.1"></times><apply id="Pt0.A1.T3.19.19.1.m1.1.2.2.2.cmml" xref="Pt0.A1.T3.19.19.1.m1.1.2.2.2"><csymbol cd="ambiguous" id="Pt0.A1.T3.19.19.1.m1.1.2.2.2.1.cmml" xref="Pt0.A1.T3.19.19.1.m1.1.2.2.2">subscript</csymbol><ci id="Pt0.A1.T3.19.19.1.m1.1.2.2.2.2.cmml" xref="Pt0.A1.T3.19.19.1.m1.1.2.2.2.2">𝐻</ci><ci id="Pt0.A1.T3.19.19.1.m1.1.2.2.2.3.cmml" xref="Pt0.A1.T3.19.19.1.m1.1.2.2.2.3">𝑡</ci></apply><cn type="integer" id="Pt0.A1.T3.19.19.1.m1.1.1.cmml" xref="Pt0.A1.T3.19.19.1.m1.1.1">512</cn></apply><ci id="Pt0.A1.T3.19.19.1.m1.1.2.3.cmml" xref="Pt0.A1.T3.19.19.1.m1.1.2.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.19.19.1.m1.1c">H_{t}(512)\times d</annotation></semantics></math></td>
<td id="Pt0.A1.T3.20.20.2" class="ltx_td ltx_align_left"><math id="Pt0.A1.T3.20.20.2.m1.1" class="ltx_Math" alttext="3\times H_{t}\times d" display="inline"><semantics id="Pt0.A1.T3.20.20.2.m1.1a"><mrow id="Pt0.A1.T3.20.20.2.m1.1.1" xref="Pt0.A1.T3.20.20.2.m1.1.1.cmml"><mn id="Pt0.A1.T3.20.20.2.m1.1.1.2" xref="Pt0.A1.T3.20.20.2.m1.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="Pt0.A1.T3.20.20.2.m1.1.1.1" xref="Pt0.A1.T3.20.20.2.m1.1.1.1.cmml">×</mo><msub id="Pt0.A1.T3.20.20.2.m1.1.1.3" xref="Pt0.A1.T3.20.20.2.m1.1.1.3.cmml"><mi id="Pt0.A1.T3.20.20.2.m1.1.1.3.2" xref="Pt0.A1.T3.20.20.2.m1.1.1.3.2.cmml">H</mi><mi id="Pt0.A1.T3.20.20.2.m1.1.1.3.3" xref="Pt0.A1.T3.20.20.2.m1.1.1.3.3.cmml">t</mi></msub><mo lspace="0.222em" rspace="0.222em" id="Pt0.A1.T3.20.20.2.m1.1.1.1a" xref="Pt0.A1.T3.20.20.2.m1.1.1.1.cmml">×</mo><mi id="Pt0.A1.T3.20.20.2.m1.1.1.4" xref="Pt0.A1.T3.20.20.2.m1.1.1.4.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.20.20.2.m1.1b"><apply id="Pt0.A1.T3.20.20.2.m1.1.1.cmml" xref="Pt0.A1.T3.20.20.2.m1.1.1"><times id="Pt0.A1.T3.20.20.2.m1.1.1.1.cmml" xref="Pt0.A1.T3.20.20.2.m1.1.1.1"></times><cn type="integer" id="Pt0.A1.T3.20.20.2.m1.1.1.2.cmml" xref="Pt0.A1.T3.20.20.2.m1.1.1.2">3</cn><apply id="Pt0.A1.T3.20.20.2.m1.1.1.3.cmml" xref="Pt0.A1.T3.20.20.2.m1.1.1.3"><csymbol cd="ambiguous" id="Pt0.A1.T3.20.20.2.m1.1.1.3.1.cmml" xref="Pt0.A1.T3.20.20.2.m1.1.1.3">subscript</csymbol><ci id="Pt0.A1.T3.20.20.2.m1.1.1.3.2.cmml" xref="Pt0.A1.T3.20.20.2.m1.1.1.3.2">𝐻</ci><ci id="Pt0.A1.T3.20.20.2.m1.1.1.3.3.cmml" xref="Pt0.A1.T3.20.20.2.m1.1.1.3.3">𝑡</ci></apply><ci id="Pt0.A1.T3.20.20.2.m1.1.1.4.cmml" xref="Pt0.A1.T3.20.20.2.m1.1.1.4">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.20.20.2.m1.1c">3\times H_{t}\times d</annotation></semantics></math></td>
</tr>
<tr id="Pt0.A1.T3.23.23" class="ltx_tr">
<th id="Pt0.A1.T3.23.23.4" class="ltx_td ltx_th ltx_th_row ltx_border_r"></th>
<th id="Pt0.A1.T3.21.21.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Enc attn norm <math id="Pt0.A1.T3.21.21.1.m1.2" class="ltx_Math" alttext="(W,b)" display="inline"><semantics id="Pt0.A1.T3.21.21.1.m1.2a"><mrow id="Pt0.A1.T3.21.21.1.m1.2.3.2" xref="Pt0.A1.T3.21.21.1.m1.2.3.1.cmml"><mo stretchy="false" id="Pt0.A1.T3.21.21.1.m1.2.3.2.1" xref="Pt0.A1.T3.21.21.1.m1.2.3.1.cmml">(</mo><mi id="Pt0.A1.T3.21.21.1.m1.1.1" xref="Pt0.A1.T3.21.21.1.m1.1.1.cmml">W</mi><mo id="Pt0.A1.T3.21.21.1.m1.2.3.2.2" xref="Pt0.A1.T3.21.21.1.m1.2.3.1.cmml">,</mo><mi id="Pt0.A1.T3.21.21.1.m1.2.2" xref="Pt0.A1.T3.21.21.1.m1.2.2.cmml">b</mi><mo stretchy="false" id="Pt0.A1.T3.21.21.1.m1.2.3.2.3" xref="Pt0.A1.T3.21.21.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.21.21.1.m1.2b"><interval closure="open" id="Pt0.A1.T3.21.21.1.m1.2.3.1.cmml" xref="Pt0.A1.T3.21.21.1.m1.2.3.2"><ci id="Pt0.A1.T3.21.21.1.m1.1.1.cmml" xref="Pt0.A1.T3.21.21.1.m1.1.1">𝑊</ci><ci id="Pt0.A1.T3.21.21.1.m1.2.2.cmml" xref="Pt0.A1.T3.21.21.1.m1.2.2">𝑏</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.21.21.1.m1.2c">(W,b)</annotation></semantics></math>
</th>
<td id="Pt0.A1.T3.22.22.2" class="ltx_td ltx_align_left ltx_border_r"><math id="Pt0.A1.T3.22.22.2.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="Pt0.A1.T3.22.22.2.m1.1a"><mi id="Pt0.A1.T3.22.22.2.m1.1.1" xref="Pt0.A1.T3.22.22.2.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.22.22.2.m1.1b"><ci id="Pt0.A1.T3.22.22.2.m1.1.1.cmml" xref="Pt0.A1.T3.22.22.2.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.22.22.2.m1.1c">d</annotation></semantics></math></td>
<td id="Pt0.A1.T3.23.23.3" class="ltx_td ltx_align_left"><math id="Pt0.A1.T3.23.23.3.m1.1" class="ltx_Math" alttext="2\times d" display="inline"><semantics id="Pt0.A1.T3.23.23.3.m1.1a"><mrow id="Pt0.A1.T3.23.23.3.m1.1.1" xref="Pt0.A1.T3.23.23.3.m1.1.1.cmml"><mn id="Pt0.A1.T3.23.23.3.m1.1.1.2" xref="Pt0.A1.T3.23.23.3.m1.1.1.2.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="Pt0.A1.T3.23.23.3.m1.1.1.1" xref="Pt0.A1.T3.23.23.3.m1.1.1.1.cmml">×</mo><mi id="Pt0.A1.T3.23.23.3.m1.1.1.3" xref="Pt0.A1.T3.23.23.3.m1.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.23.23.3.m1.1b"><apply id="Pt0.A1.T3.23.23.3.m1.1.1.cmml" xref="Pt0.A1.T3.23.23.3.m1.1.1"><times id="Pt0.A1.T3.23.23.3.m1.1.1.1.cmml" xref="Pt0.A1.T3.23.23.3.m1.1.1.1"></times><cn type="integer" id="Pt0.A1.T3.23.23.3.m1.1.1.2.cmml" xref="Pt0.A1.T3.23.23.3.m1.1.1.2">2</cn><ci id="Pt0.A1.T3.23.23.3.m1.1.1.3.cmml" xref="Pt0.A1.T3.23.23.3.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.23.23.3.m1.1c">2\times d</annotation></semantics></math></td>
</tr>
<tr id="Pt0.A1.T3.26.26" class="ltx_tr">
<th id="Pt0.A1.T3.26.26.4" class="ltx_td ltx_th ltx_th_row ltx_border_r"></th>
<th id="Pt0.A1.T3.24.24.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Pos ffn 1 <math id="Pt0.A1.T3.24.24.1.m1.2" class="ltx_Math" alttext="(W,b)" display="inline"><semantics id="Pt0.A1.T3.24.24.1.m1.2a"><mrow id="Pt0.A1.T3.24.24.1.m1.2.3.2" xref="Pt0.A1.T3.24.24.1.m1.2.3.1.cmml"><mo stretchy="false" id="Pt0.A1.T3.24.24.1.m1.2.3.2.1" xref="Pt0.A1.T3.24.24.1.m1.2.3.1.cmml">(</mo><mi id="Pt0.A1.T3.24.24.1.m1.1.1" xref="Pt0.A1.T3.24.24.1.m1.1.1.cmml">W</mi><mo id="Pt0.A1.T3.24.24.1.m1.2.3.2.2" xref="Pt0.A1.T3.24.24.1.m1.2.3.1.cmml">,</mo><mi id="Pt0.A1.T3.24.24.1.m1.2.2" xref="Pt0.A1.T3.24.24.1.m1.2.2.cmml">b</mi><mo stretchy="false" id="Pt0.A1.T3.24.24.1.m1.2.3.2.3" xref="Pt0.A1.T3.24.24.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.24.24.1.m1.2b"><interval closure="open" id="Pt0.A1.T3.24.24.1.m1.2.3.1.cmml" xref="Pt0.A1.T3.24.24.1.m1.2.3.2"><ci id="Pt0.A1.T3.24.24.1.m1.1.1.cmml" xref="Pt0.A1.T3.24.24.1.m1.1.1">𝑊</ci><ci id="Pt0.A1.T3.24.24.1.m1.2.2.cmml" xref="Pt0.A1.T3.24.24.1.m1.2.2">𝑏</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.24.24.1.m1.2c">(W,b)</annotation></semantics></math>
</th>
<td id="Pt0.A1.T3.25.25.2" class="ltx_td ltx_align_left ltx_border_r"><math id="Pt0.A1.T3.25.25.2.m1.1" class="ltx_Math" alttext="d\times d+d" display="inline"><semantics id="Pt0.A1.T3.25.25.2.m1.1a"><mrow id="Pt0.A1.T3.25.25.2.m1.1.1" xref="Pt0.A1.T3.25.25.2.m1.1.1.cmml"><mrow id="Pt0.A1.T3.25.25.2.m1.1.1.2" xref="Pt0.A1.T3.25.25.2.m1.1.1.2.cmml"><mi id="Pt0.A1.T3.25.25.2.m1.1.1.2.2" xref="Pt0.A1.T3.25.25.2.m1.1.1.2.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="Pt0.A1.T3.25.25.2.m1.1.1.2.1" xref="Pt0.A1.T3.25.25.2.m1.1.1.2.1.cmml">×</mo><mi id="Pt0.A1.T3.25.25.2.m1.1.1.2.3" xref="Pt0.A1.T3.25.25.2.m1.1.1.2.3.cmml">d</mi></mrow><mo id="Pt0.A1.T3.25.25.2.m1.1.1.1" xref="Pt0.A1.T3.25.25.2.m1.1.1.1.cmml">+</mo><mi id="Pt0.A1.T3.25.25.2.m1.1.1.3" xref="Pt0.A1.T3.25.25.2.m1.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.25.25.2.m1.1b"><apply id="Pt0.A1.T3.25.25.2.m1.1.1.cmml" xref="Pt0.A1.T3.25.25.2.m1.1.1"><plus id="Pt0.A1.T3.25.25.2.m1.1.1.1.cmml" xref="Pt0.A1.T3.25.25.2.m1.1.1.1"></plus><apply id="Pt0.A1.T3.25.25.2.m1.1.1.2.cmml" xref="Pt0.A1.T3.25.25.2.m1.1.1.2"><times id="Pt0.A1.T3.25.25.2.m1.1.1.2.1.cmml" xref="Pt0.A1.T3.25.25.2.m1.1.1.2.1"></times><ci id="Pt0.A1.T3.25.25.2.m1.1.1.2.2.cmml" xref="Pt0.A1.T3.25.25.2.m1.1.1.2.2">𝑑</ci><ci id="Pt0.A1.T3.25.25.2.m1.1.1.2.3.cmml" xref="Pt0.A1.T3.25.25.2.m1.1.1.2.3">𝑑</ci></apply><ci id="Pt0.A1.T3.25.25.2.m1.1.1.3.cmml" xref="Pt0.A1.T3.25.25.2.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.25.25.2.m1.1c">d\times d+d</annotation></semantics></math></td>
<td id="Pt0.A1.T3.26.26.3" class="ltx_td ltx_align_left"><math id="Pt0.A1.T3.26.26.3.m1.1" class="ltx_Math" alttext="d\times d+d" display="inline"><semantics id="Pt0.A1.T3.26.26.3.m1.1a"><mrow id="Pt0.A1.T3.26.26.3.m1.1.1" xref="Pt0.A1.T3.26.26.3.m1.1.1.cmml"><mrow id="Pt0.A1.T3.26.26.3.m1.1.1.2" xref="Pt0.A1.T3.26.26.3.m1.1.1.2.cmml"><mi id="Pt0.A1.T3.26.26.3.m1.1.1.2.2" xref="Pt0.A1.T3.26.26.3.m1.1.1.2.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="Pt0.A1.T3.26.26.3.m1.1.1.2.1" xref="Pt0.A1.T3.26.26.3.m1.1.1.2.1.cmml">×</mo><mi id="Pt0.A1.T3.26.26.3.m1.1.1.2.3" xref="Pt0.A1.T3.26.26.3.m1.1.1.2.3.cmml">d</mi></mrow><mo id="Pt0.A1.T3.26.26.3.m1.1.1.1" xref="Pt0.A1.T3.26.26.3.m1.1.1.1.cmml">+</mo><mi id="Pt0.A1.T3.26.26.3.m1.1.1.3" xref="Pt0.A1.T3.26.26.3.m1.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.26.26.3.m1.1b"><apply id="Pt0.A1.T3.26.26.3.m1.1.1.cmml" xref="Pt0.A1.T3.26.26.3.m1.1.1"><plus id="Pt0.A1.T3.26.26.3.m1.1.1.1.cmml" xref="Pt0.A1.T3.26.26.3.m1.1.1.1"></plus><apply id="Pt0.A1.T3.26.26.3.m1.1.1.2.cmml" xref="Pt0.A1.T3.26.26.3.m1.1.1.2"><times id="Pt0.A1.T3.26.26.3.m1.1.1.2.1.cmml" xref="Pt0.A1.T3.26.26.3.m1.1.1.2.1"></times><ci id="Pt0.A1.T3.26.26.3.m1.1.1.2.2.cmml" xref="Pt0.A1.T3.26.26.3.m1.1.1.2.2">𝑑</ci><ci id="Pt0.A1.T3.26.26.3.m1.1.1.2.3.cmml" xref="Pt0.A1.T3.26.26.3.m1.1.1.2.3">𝑑</ci></apply><ci id="Pt0.A1.T3.26.26.3.m1.1.1.3.cmml" xref="Pt0.A1.T3.26.26.3.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.26.26.3.m1.1c">d\times d+d</annotation></semantics></math></td>
</tr>
<tr id="Pt0.A1.T3.29.29" class="ltx_tr">
<th id="Pt0.A1.T3.29.29.4" class="ltx_td ltx_th ltx_th_row ltx_border_r"></th>
<th id="Pt0.A1.T3.27.27.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Pos ffn 2 <math id="Pt0.A1.T3.27.27.1.m1.2" class="ltx_Math" alttext="(W,b)" display="inline"><semantics id="Pt0.A1.T3.27.27.1.m1.2a"><mrow id="Pt0.A1.T3.27.27.1.m1.2.3.2" xref="Pt0.A1.T3.27.27.1.m1.2.3.1.cmml"><mo stretchy="false" id="Pt0.A1.T3.27.27.1.m1.2.3.2.1" xref="Pt0.A1.T3.27.27.1.m1.2.3.1.cmml">(</mo><mi id="Pt0.A1.T3.27.27.1.m1.1.1" xref="Pt0.A1.T3.27.27.1.m1.1.1.cmml">W</mi><mo id="Pt0.A1.T3.27.27.1.m1.2.3.2.2" xref="Pt0.A1.T3.27.27.1.m1.2.3.1.cmml">,</mo><mi id="Pt0.A1.T3.27.27.1.m1.2.2" xref="Pt0.A1.T3.27.27.1.m1.2.2.cmml">b</mi><mo stretchy="false" id="Pt0.A1.T3.27.27.1.m1.2.3.2.3" xref="Pt0.A1.T3.27.27.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.27.27.1.m1.2b"><interval closure="open" id="Pt0.A1.T3.27.27.1.m1.2.3.1.cmml" xref="Pt0.A1.T3.27.27.1.m1.2.3.2"><ci id="Pt0.A1.T3.27.27.1.m1.1.1.cmml" xref="Pt0.A1.T3.27.27.1.m1.1.1">𝑊</ci><ci id="Pt0.A1.T3.27.27.1.m1.2.2.cmml" xref="Pt0.A1.T3.27.27.1.m1.2.2">𝑏</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.27.27.1.m1.2c">(W,b)</annotation></semantics></math>
</th>
<td id="Pt0.A1.T3.28.28.2" class="ltx_td ltx_align_left ltx_border_r"><math id="Pt0.A1.T3.28.28.2.m1.1" class="ltx_Math" alttext="d\times d+d" display="inline"><semantics id="Pt0.A1.T3.28.28.2.m1.1a"><mrow id="Pt0.A1.T3.28.28.2.m1.1.1" xref="Pt0.A1.T3.28.28.2.m1.1.1.cmml"><mrow id="Pt0.A1.T3.28.28.2.m1.1.1.2" xref="Pt0.A1.T3.28.28.2.m1.1.1.2.cmml"><mi id="Pt0.A1.T3.28.28.2.m1.1.1.2.2" xref="Pt0.A1.T3.28.28.2.m1.1.1.2.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="Pt0.A1.T3.28.28.2.m1.1.1.2.1" xref="Pt0.A1.T3.28.28.2.m1.1.1.2.1.cmml">×</mo><mi id="Pt0.A1.T3.28.28.2.m1.1.1.2.3" xref="Pt0.A1.T3.28.28.2.m1.1.1.2.3.cmml">d</mi></mrow><mo id="Pt0.A1.T3.28.28.2.m1.1.1.1" xref="Pt0.A1.T3.28.28.2.m1.1.1.1.cmml">+</mo><mi id="Pt0.A1.T3.28.28.2.m1.1.1.3" xref="Pt0.A1.T3.28.28.2.m1.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.28.28.2.m1.1b"><apply id="Pt0.A1.T3.28.28.2.m1.1.1.cmml" xref="Pt0.A1.T3.28.28.2.m1.1.1"><plus id="Pt0.A1.T3.28.28.2.m1.1.1.1.cmml" xref="Pt0.A1.T3.28.28.2.m1.1.1.1"></plus><apply id="Pt0.A1.T3.28.28.2.m1.1.1.2.cmml" xref="Pt0.A1.T3.28.28.2.m1.1.1.2"><times id="Pt0.A1.T3.28.28.2.m1.1.1.2.1.cmml" xref="Pt0.A1.T3.28.28.2.m1.1.1.2.1"></times><ci id="Pt0.A1.T3.28.28.2.m1.1.1.2.2.cmml" xref="Pt0.A1.T3.28.28.2.m1.1.1.2.2">𝑑</ci><ci id="Pt0.A1.T3.28.28.2.m1.1.1.2.3.cmml" xref="Pt0.A1.T3.28.28.2.m1.1.1.2.3">𝑑</ci></apply><ci id="Pt0.A1.T3.28.28.2.m1.1.1.3.cmml" xref="Pt0.A1.T3.28.28.2.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.28.28.2.m1.1c">d\times d+d</annotation></semantics></math></td>
<td id="Pt0.A1.T3.29.29.3" class="ltx_td ltx_align_left"><math id="Pt0.A1.T3.29.29.3.m1.1" class="ltx_Math" alttext="d\times d+d" display="inline"><semantics id="Pt0.A1.T3.29.29.3.m1.1a"><mrow id="Pt0.A1.T3.29.29.3.m1.1.1" xref="Pt0.A1.T3.29.29.3.m1.1.1.cmml"><mrow id="Pt0.A1.T3.29.29.3.m1.1.1.2" xref="Pt0.A1.T3.29.29.3.m1.1.1.2.cmml"><mi id="Pt0.A1.T3.29.29.3.m1.1.1.2.2" xref="Pt0.A1.T3.29.29.3.m1.1.1.2.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="Pt0.A1.T3.29.29.3.m1.1.1.2.1" xref="Pt0.A1.T3.29.29.3.m1.1.1.2.1.cmml">×</mo><mi id="Pt0.A1.T3.29.29.3.m1.1.1.2.3" xref="Pt0.A1.T3.29.29.3.m1.1.1.2.3.cmml">d</mi></mrow><mo id="Pt0.A1.T3.29.29.3.m1.1.1.1" xref="Pt0.A1.T3.29.29.3.m1.1.1.1.cmml">+</mo><mi id="Pt0.A1.T3.29.29.3.m1.1.1.3" xref="Pt0.A1.T3.29.29.3.m1.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.29.29.3.m1.1b"><apply id="Pt0.A1.T3.29.29.3.m1.1.1.cmml" xref="Pt0.A1.T3.29.29.3.m1.1.1"><plus id="Pt0.A1.T3.29.29.3.m1.1.1.1.cmml" xref="Pt0.A1.T3.29.29.3.m1.1.1.1"></plus><apply id="Pt0.A1.T3.29.29.3.m1.1.1.2.cmml" xref="Pt0.A1.T3.29.29.3.m1.1.1.2"><times id="Pt0.A1.T3.29.29.3.m1.1.1.2.1.cmml" xref="Pt0.A1.T3.29.29.3.m1.1.1.2.1"></times><ci id="Pt0.A1.T3.29.29.3.m1.1.1.2.2.cmml" xref="Pt0.A1.T3.29.29.3.m1.1.1.2.2">𝑑</ci><ci id="Pt0.A1.T3.29.29.3.m1.1.1.2.3.cmml" xref="Pt0.A1.T3.29.29.3.m1.1.1.2.3">𝑑</ci></apply><ci id="Pt0.A1.T3.29.29.3.m1.1.1.3.cmml" xref="Pt0.A1.T3.29.29.3.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.29.29.3.m1.1c">d\times d+d</annotation></semantics></math></td>
</tr>
<tr id="Pt0.A1.T3.32.32" class="ltx_tr">
<th id="Pt0.A1.T3.32.32.4" class="ltx_td ltx_th ltx_th_row ltx_border_r"></th>
<th id="Pt0.A1.T3.30.30.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Pos ffn norm<math id="Pt0.A1.T3.30.30.1.m1.2" class="ltx_Math" alttext="(W,b)" display="inline"><semantics id="Pt0.A1.T3.30.30.1.m1.2a"><mrow id="Pt0.A1.T3.30.30.1.m1.2.3.2" xref="Pt0.A1.T3.30.30.1.m1.2.3.1.cmml"><mo stretchy="false" id="Pt0.A1.T3.30.30.1.m1.2.3.2.1" xref="Pt0.A1.T3.30.30.1.m1.2.3.1.cmml">(</mo><mi id="Pt0.A1.T3.30.30.1.m1.1.1" xref="Pt0.A1.T3.30.30.1.m1.1.1.cmml">W</mi><mo id="Pt0.A1.T3.30.30.1.m1.2.3.2.2" xref="Pt0.A1.T3.30.30.1.m1.2.3.1.cmml">,</mo><mi id="Pt0.A1.T3.30.30.1.m1.2.2" xref="Pt0.A1.T3.30.30.1.m1.2.2.cmml">b</mi><mo stretchy="false" id="Pt0.A1.T3.30.30.1.m1.2.3.2.3" xref="Pt0.A1.T3.30.30.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.30.30.1.m1.2b"><interval closure="open" id="Pt0.A1.T3.30.30.1.m1.2.3.1.cmml" xref="Pt0.A1.T3.30.30.1.m1.2.3.2"><ci id="Pt0.A1.T3.30.30.1.m1.1.1.cmml" xref="Pt0.A1.T3.30.30.1.m1.1.1">𝑊</ci><ci id="Pt0.A1.T3.30.30.1.m1.2.2.cmml" xref="Pt0.A1.T3.30.30.1.m1.2.2">𝑏</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.30.30.1.m1.2c">(W,b)</annotation></semantics></math>
</th>
<td id="Pt0.A1.T3.31.31.2" class="ltx_td ltx_align_left ltx_border_r"><math id="Pt0.A1.T3.31.31.2.m1.1" class="ltx_Math" alttext="2d" display="inline"><semantics id="Pt0.A1.T3.31.31.2.m1.1a"><mrow id="Pt0.A1.T3.31.31.2.m1.1.1" xref="Pt0.A1.T3.31.31.2.m1.1.1.cmml"><mn id="Pt0.A1.T3.31.31.2.m1.1.1.2" xref="Pt0.A1.T3.31.31.2.m1.1.1.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.31.31.2.m1.1.1.1" xref="Pt0.A1.T3.31.31.2.m1.1.1.1.cmml">​</mo><mi id="Pt0.A1.T3.31.31.2.m1.1.1.3" xref="Pt0.A1.T3.31.31.2.m1.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.31.31.2.m1.1b"><apply id="Pt0.A1.T3.31.31.2.m1.1.1.cmml" xref="Pt0.A1.T3.31.31.2.m1.1.1"><times id="Pt0.A1.T3.31.31.2.m1.1.1.1.cmml" xref="Pt0.A1.T3.31.31.2.m1.1.1.1"></times><cn type="integer" id="Pt0.A1.T3.31.31.2.m1.1.1.2.cmml" xref="Pt0.A1.T3.31.31.2.m1.1.1.2">2</cn><ci id="Pt0.A1.T3.31.31.2.m1.1.1.3.cmml" xref="Pt0.A1.T3.31.31.2.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.31.31.2.m1.1c">2d</annotation></semantics></math></td>
<td id="Pt0.A1.T3.32.32.3" class="ltx_td ltx_align_left"><math id="Pt0.A1.T3.32.32.3.m1.1" class="ltx_Math" alttext="2\times d" display="inline"><semantics id="Pt0.A1.T3.32.32.3.m1.1a"><mrow id="Pt0.A1.T3.32.32.3.m1.1.1" xref="Pt0.A1.T3.32.32.3.m1.1.1.cmml"><mn id="Pt0.A1.T3.32.32.3.m1.1.1.2" xref="Pt0.A1.T3.32.32.3.m1.1.1.2.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="Pt0.A1.T3.32.32.3.m1.1.1.1" xref="Pt0.A1.T3.32.32.3.m1.1.1.1.cmml">×</mo><mi id="Pt0.A1.T3.32.32.3.m1.1.1.3" xref="Pt0.A1.T3.32.32.3.m1.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.32.32.3.m1.1b"><apply id="Pt0.A1.T3.32.32.3.m1.1.1.cmml" xref="Pt0.A1.T3.32.32.3.m1.1.1"><times id="Pt0.A1.T3.32.32.3.m1.1.1.1.cmml" xref="Pt0.A1.T3.32.32.3.m1.1.1.1"></times><cn type="integer" id="Pt0.A1.T3.32.32.3.m1.1.1.2.cmml" xref="Pt0.A1.T3.32.32.3.m1.1.1.2">2</cn><ci id="Pt0.A1.T3.32.32.3.m1.1.1.3.cmml" xref="Pt0.A1.T3.32.32.3.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.32.32.3.m1.1c">2\times d</annotation></semantics></math></td>
</tr>
<tr id="Pt0.A1.T3.35.35" class="ltx_tr">
<th id="Pt0.A1.T3.35.35.4" class="ltx_td ltx_th ltx_th_row ltx_border_r"></th>
<th id="Pt0.A1.T3.33.33.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Enc attn norm <math id="Pt0.A1.T3.33.33.1.m1.2" class="ltx_Math" alttext="(W,b)" display="inline"><semantics id="Pt0.A1.T3.33.33.1.m1.2a"><mrow id="Pt0.A1.T3.33.33.1.m1.2.3.2" xref="Pt0.A1.T3.33.33.1.m1.2.3.1.cmml"><mo stretchy="false" id="Pt0.A1.T3.33.33.1.m1.2.3.2.1" xref="Pt0.A1.T3.33.33.1.m1.2.3.1.cmml">(</mo><mi id="Pt0.A1.T3.33.33.1.m1.1.1" xref="Pt0.A1.T3.33.33.1.m1.1.1.cmml">W</mi><mo id="Pt0.A1.T3.33.33.1.m1.2.3.2.2" xref="Pt0.A1.T3.33.33.1.m1.2.3.1.cmml">,</mo><mi id="Pt0.A1.T3.33.33.1.m1.2.2" xref="Pt0.A1.T3.33.33.1.m1.2.2.cmml">b</mi><mo stretchy="false" id="Pt0.A1.T3.33.33.1.m1.2.3.2.3" xref="Pt0.A1.T3.33.33.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.33.33.1.m1.2b"><interval closure="open" id="Pt0.A1.T3.33.33.1.m1.2.3.1.cmml" xref="Pt0.A1.T3.33.33.1.m1.2.3.2"><ci id="Pt0.A1.T3.33.33.1.m1.1.1.cmml" xref="Pt0.A1.T3.33.33.1.m1.1.1">𝑊</ci><ci id="Pt0.A1.T3.33.33.1.m1.2.2.cmml" xref="Pt0.A1.T3.33.33.1.m1.2.2">𝑏</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.33.33.1.m1.2c">(W,b)</annotation></semantics></math>
</th>
<td id="Pt0.A1.T3.34.34.2" class="ltx_td ltx_align_left ltx_border_r"><math id="Pt0.A1.T3.34.34.2.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="Pt0.A1.T3.34.34.2.m1.1a"><mi id="Pt0.A1.T3.34.34.2.m1.1.1" xref="Pt0.A1.T3.34.34.2.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.34.34.2.m1.1b"><ci id="Pt0.A1.T3.34.34.2.m1.1.1.cmml" xref="Pt0.A1.T3.34.34.2.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.34.34.2.m1.1c">d</annotation></semantics></math></td>
<td id="Pt0.A1.T3.35.35.3" class="ltx_td ltx_align_left"><math id="Pt0.A1.T3.35.35.3.m1.1" class="ltx_Math" alttext="2\times d" display="inline"><semantics id="Pt0.A1.T3.35.35.3.m1.1a"><mrow id="Pt0.A1.T3.35.35.3.m1.1.1" xref="Pt0.A1.T3.35.35.3.m1.1.1.cmml"><mn id="Pt0.A1.T3.35.35.3.m1.1.1.2" xref="Pt0.A1.T3.35.35.3.m1.1.1.2.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="Pt0.A1.T3.35.35.3.m1.1.1.1" xref="Pt0.A1.T3.35.35.3.m1.1.1.1.cmml">×</mo><mi id="Pt0.A1.T3.35.35.3.m1.1.1.3" xref="Pt0.A1.T3.35.35.3.m1.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.35.35.3.m1.1b"><apply id="Pt0.A1.T3.35.35.3.m1.1.1.cmml" xref="Pt0.A1.T3.35.35.3.m1.1.1"><times id="Pt0.A1.T3.35.35.3.m1.1.1.1.cmml" xref="Pt0.A1.T3.35.35.3.m1.1.1.1"></times><cn type="integer" id="Pt0.A1.T3.35.35.3.m1.1.1.2.cmml" xref="Pt0.A1.T3.35.35.3.m1.1.1.2">2</cn><ci id="Pt0.A1.T3.35.35.3.m1.1.1.3.cmml" xref="Pt0.A1.T3.35.35.3.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.35.35.3.m1.1c">2\times d</annotation></semantics></math></td>
</tr>
<tr id="Pt0.A1.T3.37.37" class="ltx_tr">
<th id="Pt0.A1.T3.37.37.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Agent-MLP</th>
<th id="Pt0.A1.T3.37.37.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Dense 0</th>
<td id="Pt0.A1.T3.36.36.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><math id="Pt0.A1.T3.36.36.1.m1.1" class="ltx_Math" alttext="4d\times 4d+4d" display="inline"><semantics id="Pt0.A1.T3.36.36.1.m1.1a"><mrow id="Pt0.A1.T3.36.36.1.m1.1.1" xref="Pt0.A1.T3.36.36.1.m1.1.1.cmml"><mrow id="Pt0.A1.T3.36.36.1.m1.1.1.2" xref="Pt0.A1.T3.36.36.1.m1.1.1.2.cmml"><mrow id="Pt0.A1.T3.36.36.1.m1.1.1.2.2" xref="Pt0.A1.T3.36.36.1.m1.1.1.2.2.cmml"><mrow id="Pt0.A1.T3.36.36.1.m1.1.1.2.2.2" xref="Pt0.A1.T3.36.36.1.m1.1.1.2.2.2.cmml"><mn id="Pt0.A1.T3.36.36.1.m1.1.1.2.2.2.2" xref="Pt0.A1.T3.36.36.1.m1.1.1.2.2.2.2.cmml">4</mn><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.36.36.1.m1.1.1.2.2.2.1" xref="Pt0.A1.T3.36.36.1.m1.1.1.2.2.2.1.cmml">​</mo><mi id="Pt0.A1.T3.36.36.1.m1.1.1.2.2.2.3" xref="Pt0.A1.T3.36.36.1.m1.1.1.2.2.2.3.cmml">d</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="Pt0.A1.T3.36.36.1.m1.1.1.2.2.1" xref="Pt0.A1.T3.36.36.1.m1.1.1.2.2.1.cmml">×</mo><mn id="Pt0.A1.T3.36.36.1.m1.1.1.2.2.3" xref="Pt0.A1.T3.36.36.1.m1.1.1.2.2.3.cmml">4</mn></mrow><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.36.36.1.m1.1.1.2.1" xref="Pt0.A1.T3.36.36.1.m1.1.1.2.1.cmml">​</mo><mi id="Pt0.A1.T3.36.36.1.m1.1.1.2.3" xref="Pt0.A1.T3.36.36.1.m1.1.1.2.3.cmml">d</mi></mrow><mo id="Pt0.A1.T3.36.36.1.m1.1.1.1" xref="Pt0.A1.T3.36.36.1.m1.1.1.1.cmml">+</mo><mrow id="Pt0.A1.T3.36.36.1.m1.1.1.3" xref="Pt0.A1.T3.36.36.1.m1.1.1.3.cmml"><mn id="Pt0.A1.T3.36.36.1.m1.1.1.3.2" xref="Pt0.A1.T3.36.36.1.m1.1.1.3.2.cmml">4</mn><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.36.36.1.m1.1.1.3.1" xref="Pt0.A1.T3.36.36.1.m1.1.1.3.1.cmml">​</mo><mi id="Pt0.A1.T3.36.36.1.m1.1.1.3.3" xref="Pt0.A1.T3.36.36.1.m1.1.1.3.3.cmml">d</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.36.36.1.m1.1b"><apply id="Pt0.A1.T3.36.36.1.m1.1.1.cmml" xref="Pt0.A1.T3.36.36.1.m1.1.1"><plus id="Pt0.A1.T3.36.36.1.m1.1.1.1.cmml" xref="Pt0.A1.T3.36.36.1.m1.1.1.1"></plus><apply id="Pt0.A1.T3.36.36.1.m1.1.1.2.cmml" xref="Pt0.A1.T3.36.36.1.m1.1.1.2"><times id="Pt0.A1.T3.36.36.1.m1.1.1.2.1.cmml" xref="Pt0.A1.T3.36.36.1.m1.1.1.2.1"></times><apply id="Pt0.A1.T3.36.36.1.m1.1.1.2.2.cmml" xref="Pt0.A1.T3.36.36.1.m1.1.1.2.2"><times id="Pt0.A1.T3.36.36.1.m1.1.1.2.2.1.cmml" xref="Pt0.A1.T3.36.36.1.m1.1.1.2.2.1"></times><apply id="Pt0.A1.T3.36.36.1.m1.1.1.2.2.2.cmml" xref="Pt0.A1.T3.36.36.1.m1.1.1.2.2.2"><times id="Pt0.A1.T3.36.36.1.m1.1.1.2.2.2.1.cmml" xref="Pt0.A1.T3.36.36.1.m1.1.1.2.2.2.1"></times><cn type="integer" id="Pt0.A1.T3.36.36.1.m1.1.1.2.2.2.2.cmml" xref="Pt0.A1.T3.36.36.1.m1.1.1.2.2.2.2">4</cn><ci id="Pt0.A1.T3.36.36.1.m1.1.1.2.2.2.3.cmml" xref="Pt0.A1.T3.36.36.1.m1.1.1.2.2.2.3">𝑑</ci></apply><cn type="integer" id="Pt0.A1.T3.36.36.1.m1.1.1.2.2.3.cmml" xref="Pt0.A1.T3.36.36.1.m1.1.1.2.2.3">4</cn></apply><ci id="Pt0.A1.T3.36.36.1.m1.1.1.2.3.cmml" xref="Pt0.A1.T3.36.36.1.m1.1.1.2.3">𝑑</ci></apply><apply id="Pt0.A1.T3.36.36.1.m1.1.1.3.cmml" xref="Pt0.A1.T3.36.36.1.m1.1.1.3"><times id="Pt0.A1.T3.36.36.1.m1.1.1.3.1.cmml" xref="Pt0.A1.T3.36.36.1.m1.1.1.3.1"></times><cn type="integer" id="Pt0.A1.T3.36.36.1.m1.1.1.3.2.cmml" xref="Pt0.A1.T3.36.36.1.m1.1.1.3.2">4</cn><ci id="Pt0.A1.T3.36.36.1.m1.1.1.3.3.cmml" xref="Pt0.A1.T3.36.36.1.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.36.36.1.m1.1c">4d\times 4d+4d</annotation></semantics></math></td>
<td id="Pt0.A1.T3.37.37.2" class="ltx_td ltx_align_left ltx_border_t"><math id="Pt0.A1.T3.37.37.2.m1.1" class="ltx_Math" alttext="(H\times 4d+4d)\times T" display="inline"><semantics id="Pt0.A1.T3.37.37.2.m1.1a"><mrow id="Pt0.A1.T3.37.37.2.m1.1.1" xref="Pt0.A1.T3.37.37.2.m1.1.1.cmml"><mrow id="Pt0.A1.T3.37.37.2.m1.1.1.1.1" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.2" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.cmml">(</mo><mrow id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.cmml"><mrow id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2.cmml"><mrow id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2.2" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2.2.cmml"><mi id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2.2.2" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2.2.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2.2.1" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2.2.1.cmml">×</mo><mn id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2.2.3" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2.2.3.cmml">4</mn></mrow><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2.1" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2.1.cmml">​</mo><mi id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2.3" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2.3.cmml">d</mi></mrow><mo id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.1" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.1.cmml">+</mo><mrow id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.3" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.3.cmml"><mn id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.3.2" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.3.2.cmml">4</mn><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.3.1" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.3.3" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.3.3.cmml">d</mi></mrow></mrow><mo rspace="0.055em" stretchy="false" id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.3" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="Pt0.A1.T3.37.37.2.m1.1.1.2" xref="Pt0.A1.T3.37.37.2.m1.1.1.2.cmml">×</mo><mi id="Pt0.A1.T3.37.37.2.m1.1.1.3" xref="Pt0.A1.T3.37.37.2.m1.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.37.37.2.m1.1b"><apply id="Pt0.A1.T3.37.37.2.m1.1.1.cmml" xref="Pt0.A1.T3.37.37.2.m1.1.1"><times id="Pt0.A1.T3.37.37.2.m1.1.1.2.cmml" xref="Pt0.A1.T3.37.37.2.m1.1.1.2"></times><apply id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.cmml" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1"><plus id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.1.cmml" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.1"></plus><apply id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2.cmml" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2"><times id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2.1.cmml" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2.1"></times><apply id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2.2.cmml" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2.2"><times id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2.2.1.cmml" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2.2.1"></times><ci id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2.2.2.cmml" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2.2.2">𝐻</ci><cn type="integer" id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2.2.3.cmml" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2.2.3">4</cn></apply><ci id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2.3.cmml" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.2.3">𝑑</ci></apply><apply id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.3.cmml" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.3"><times id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.3.1.cmml" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.3.1"></times><cn type="integer" id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.3.2.cmml" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.3.2">4</cn><ci id="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.3.3.cmml" xref="Pt0.A1.T3.37.37.2.m1.1.1.1.1.1.3.3">𝑑</ci></apply></apply><ci id="Pt0.A1.T3.37.37.2.m1.1.1.3.cmml" xref="Pt0.A1.T3.37.37.2.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.37.37.2.m1.1c">(H\times 4d+4d)\times T</annotation></semantics></math></td>
</tr>
<tr id="Pt0.A1.T3.39.39" class="ltx_tr">
<th id="Pt0.A1.T3.39.39.3" class="ltx_td ltx_th ltx_th_row ltx_border_r"></th>
<th id="Pt0.A1.T3.39.39.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Dense 1</th>
<td id="Pt0.A1.T3.38.38.1" class="ltx_td ltx_align_left ltx_border_r"><math id="Pt0.A1.T3.38.38.1.m1.1" class="ltx_Math" alttext="2d\times 4d+2d" display="inline"><semantics id="Pt0.A1.T3.38.38.1.m1.1a"><mrow id="Pt0.A1.T3.38.38.1.m1.1.1" xref="Pt0.A1.T3.38.38.1.m1.1.1.cmml"><mrow id="Pt0.A1.T3.38.38.1.m1.1.1.2" xref="Pt0.A1.T3.38.38.1.m1.1.1.2.cmml"><mrow id="Pt0.A1.T3.38.38.1.m1.1.1.2.2" xref="Pt0.A1.T3.38.38.1.m1.1.1.2.2.cmml"><mrow id="Pt0.A1.T3.38.38.1.m1.1.1.2.2.2" xref="Pt0.A1.T3.38.38.1.m1.1.1.2.2.2.cmml"><mn id="Pt0.A1.T3.38.38.1.m1.1.1.2.2.2.2" xref="Pt0.A1.T3.38.38.1.m1.1.1.2.2.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.38.38.1.m1.1.1.2.2.2.1" xref="Pt0.A1.T3.38.38.1.m1.1.1.2.2.2.1.cmml">​</mo><mi id="Pt0.A1.T3.38.38.1.m1.1.1.2.2.2.3" xref="Pt0.A1.T3.38.38.1.m1.1.1.2.2.2.3.cmml">d</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="Pt0.A1.T3.38.38.1.m1.1.1.2.2.1" xref="Pt0.A1.T3.38.38.1.m1.1.1.2.2.1.cmml">×</mo><mn id="Pt0.A1.T3.38.38.1.m1.1.1.2.2.3" xref="Pt0.A1.T3.38.38.1.m1.1.1.2.2.3.cmml">4</mn></mrow><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.38.38.1.m1.1.1.2.1" xref="Pt0.A1.T3.38.38.1.m1.1.1.2.1.cmml">​</mo><mi id="Pt0.A1.T3.38.38.1.m1.1.1.2.3" xref="Pt0.A1.T3.38.38.1.m1.1.1.2.3.cmml">d</mi></mrow><mo id="Pt0.A1.T3.38.38.1.m1.1.1.1" xref="Pt0.A1.T3.38.38.1.m1.1.1.1.cmml">+</mo><mrow id="Pt0.A1.T3.38.38.1.m1.1.1.3" xref="Pt0.A1.T3.38.38.1.m1.1.1.3.cmml"><mn id="Pt0.A1.T3.38.38.1.m1.1.1.3.2" xref="Pt0.A1.T3.38.38.1.m1.1.1.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.38.38.1.m1.1.1.3.1" xref="Pt0.A1.T3.38.38.1.m1.1.1.3.1.cmml">​</mo><mi id="Pt0.A1.T3.38.38.1.m1.1.1.3.3" xref="Pt0.A1.T3.38.38.1.m1.1.1.3.3.cmml">d</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.38.38.1.m1.1b"><apply id="Pt0.A1.T3.38.38.1.m1.1.1.cmml" xref="Pt0.A1.T3.38.38.1.m1.1.1"><plus id="Pt0.A1.T3.38.38.1.m1.1.1.1.cmml" xref="Pt0.A1.T3.38.38.1.m1.1.1.1"></plus><apply id="Pt0.A1.T3.38.38.1.m1.1.1.2.cmml" xref="Pt0.A1.T3.38.38.1.m1.1.1.2"><times id="Pt0.A1.T3.38.38.1.m1.1.1.2.1.cmml" xref="Pt0.A1.T3.38.38.1.m1.1.1.2.1"></times><apply id="Pt0.A1.T3.38.38.1.m1.1.1.2.2.cmml" xref="Pt0.A1.T3.38.38.1.m1.1.1.2.2"><times id="Pt0.A1.T3.38.38.1.m1.1.1.2.2.1.cmml" xref="Pt0.A1.T3.38.38.1.m1.1.1.2.2.1"></times><apply id="Pt0.A1.T3.38.38.1.m1.1.1.2.2.2.cmml" xref="Pt0.A1.T3.38.38.1.m1.1.1.2.2.2"><times id="Pt0.A1.T3.38.38.1.m1.1.1.2.2.2.1.cmml" xref="Pt0.A1.T3.38.38.1.m1.1.1.2.2.2.1"></times><cn type="integer" id="Pt0.A1.T3.38.38.1.m1.1.1.2.2.2.2.cmml" xref="Pt0.A1.T3.38.38.1.m1.1.1.2.2.2.2">2</cn><ci id="Pt0.A1.T3.38.38.1.m1.1.1.2.2.2.3.cmml" xref="Pt0.A1.T3.38.38.1.m1.1.1.2.2.2.3">𝑑</ci></apply><cn type="integer" id="Pt0.A1.T3.38.38.1.m1.1.1.2.2.3.cmml" xref="Pt0.A1.T3.38.38.1.m1.1.1.2.2.3">4</cn></apply><ci id="Pt0.A1.T3.38.38.1.m1.1.1.2.3.cmml" xref="Pt0.A1.T3.38.38.1.m1.1.1.2.3">𝑑</ci></apply><apply id="Pt0.A1.T3.38.38.1.m1.1.1.3.cmml" xref="Pt0.A1.T3.38.38.1.m1.1.1.3"><times id="Pt0.A1.T3.38.38.1.m1.1.1.3.1.cmml" xref="Pt0.A1.T3.38.38.1.m1.1.1.3.1"></times><cn type="integer" id="Pt0.A1.T3.38.38.1.m1.1.1.3.2.cmml" xref="Pt0.A1.T3.38.38.1.m1.1.1.3.2">2</cn><ci id="Pt0.A1.T3.38.38.1.m1.1.1.3.3.cmml" xref="Pt0.A1.T3.38.38.1.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.38.38.1.m1.1c">2d\times 4d+2d</annotation></semantics></math></td>
<td id="Pt0.A1.T3.39.39.2" class="ltx_td ltx_align_left"><math id="Pt0.A1.T3.39.39.2.m1.1" class="ltx_Math" alttext="(H\times 2d+2d)\times T" display="inline"><semantics id="Pt0.A1.T3.39.39.2.m1.1a"><mrow id="Pt0.A1.T3.39.39.2.m1.1.1" xref="Pt0.A1.T3.39.39.2.m1.1.1.cmml"><mrow id="Pt0.A1.T3.39.39.2.m1.1.1.1.1" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.2" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.cmml">(</mo><mrow id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.cmml"><mrow id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2.cmml"><mrow id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2.2" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2.2.cmml"><mi id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2.2.2" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2.2.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2.2.1" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2.2.1.cmml">×</mo><mn id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2.2.3" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2.2.3.cmml">2</mn></mrow><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2.1" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2.1.cmml">​</mo><mi id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2.3" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2.3.cmml">d</mi></mrow><mo id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.1" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.1.cmml">+</mo><mrow id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.3" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.3.cmml"><mn id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.3.2" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.3.1" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.3.3" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.3.3.cmml">d</mi></mrow></mrow><mo rspace="0.055em" stretchy="false" id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.3" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="Pt0.A1.T3.39.39.2.m1.1.1.2" xref="Pt0.A1.T3.39.39.2.m1.1.1.2.cmml">×</mo><mi id="Pt0.A1.T3.39.39.2.m1.1.1.3" xref="Pt0.A1.T3.39.39.2.m1.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.39.39.2.m1.1b"><apply id="Pt0.A1.T3.39.39.2.m1.1.1.cmml" xref="Pt0.A1.T3.39.39.2.m1.1.1"><times id="Pt0.A1.T3.39.39.2.m1.1.1.2.cmml" xref="Pt0.A1.T3.39.39.2.m1.1.1.2"></times><apply id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.cmml" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1"><plus id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.1.cmml" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.1"></plus><apply id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2.cmml" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2"><times id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2.1.cmml" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2.1"></times><apply id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2.2.cmml" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2.2"><times id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2.2.1.cmml" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2.2.1"></times><ci id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2.2.2.cmml" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2.2.2">𝐻</ci><cn type="integer" id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2.2.3.cmml" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2.2.3">2</cn></apply><ci id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2.3.cmml" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.2.3">𝑑</ci></apply><apply id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.3.cmml" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.3"><times id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.3.1.cmml" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.3.1"></times><cn type="integer" id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.3.2.cmml" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.3.2">2</cn><ci id="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.3.3.cmml" xref="Pt0.A1.T3.39.39.2.m1.1.1.1.1.1.3.3">𝑑</ci></apply></apply><ci id="Pt0.A1.T3.39.39.2.m1.1.1.3.cmml" xref="Pt0.A1.T3.39.39.2.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.39.39.2.m1.1c">(H\times 2d+2d)\times T</annotation></semantics></math></td>
</tr>
<tr id="Pt0.A1.T3.42.42" class="ltx_tr">
<th id="Pt0.A1.T3.42.42.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Agent-LSTM</th>
<th id="Pt0.A1.T3.40.40.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Lstm_cell <math id="Pt0.A1.T3.40.40.1.m1.1" class="ltx_Math" alttext="W_{ih}" display="inline"><semantics id="Pt0.A1.T3.40.40.1.m1.1a"><msub id="Pt0.A1.T3.40.40.1.m1.1.1" xref="Pt0.A1.T3.40.40.1.m1.1.1.cmml"><mi id="Pt0.A1.T3.40.40.1.m1.1.1.2" xref="Pt0.A1.T3.40.40.1.m1.1.1.2.cmml">W</mi><mrow id="Pt0.A1.T3.40.40.1.m1.1.1.3" xref="Pt0.A1.T3.40.40.1.m1.1.1.3.cmml"><mi id="Pt0.A1.T3.40.40.1.m1.1.1.3.2" xref="Pt0.A1.T3.40.40.1.m1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.40.40.1.m1.1.1.3.1" xref="Pt0.A1.T3.40.40.1.m1.1.1.3.1.cmml">​</mo><mi id="Pt0.A1.T3.40.40.1.m1.1.1.3.3" xref="Pt0.A1.T3.40.40.1.m1.1.1.3.3.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.40.40.1.m1.1b"><apply id="Pt0.A1.T3.40.40.1.m1.1.1.cmml" xref="Pt0.A1.T3.40.40.1.m1.1.1"><csymbol cd="ambiguous" id="Pt0.A1.T3.40.40.1.m1.1.1.1.cmml" xref="Pt0.A1.T3.40.40.1.m1.1.1">subscript</csymbol><ci id="Pt0.A1.T3.40.40.1.m1.1.1.2.cmml" xref="Pt0.A1.T3.40.40.1.m1.1.1.2">𝑊</ci><apply id="Pt0.A1.T3.40.40.1.m1.1.1.3.cmml" xref="Pt0.A1.T3.40.40.1.m1.1.1.3"><times id="Pt0.A1.T3.40.40.1.m1.1.1.3.1.cmml" xref="Pt0.A1.T3.40.40.1.m1.1.1.3.1"></times><ci id="Pt0.A1.T3.40.40.1.m1.1.1.3.2.cmml" xref="Pt0.A1.T3.40.40.1.m1.1.1.3.2">𝑖</ci><ci id="Pt0.A1.T3.40.40.1.m1.1.1.3.3.cmml" xref="Pt0.A1.T3.40.40.1.m1.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.40.40.1.m1.1c">W_{ih}</annotation></semantics></math>
</th>
<td id="Pt0.A1.T3.41.41.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><math id="Pt0.A1.T3.41.41.2.m1.1" class="ltx_Math" alttext="4d\times 16d" display="inline"><semantics id="Pt0.A1.T3.41.41.2.m1.1a"><mrow id="Pt0.A1.T3.41.41.2.m1.1.1" xref="Pt0.A1.T3.41.41.2.m1.1.1.cmml"><mrow id="Pt0.A1.T3.41.41.2.m1.1.1.2" xref="Pt0.A1.T3.41.41.2.m1.1.1.2.cmml"><mrow id="Pt0.A1.T3.41.41.2.m1.1.1.2.2" xref="Pt0.A1.T3.41.41.2.m1.1.1.2.2.cmml"><mn id="Pt0.A1.T3.41.41.2.m1.1.1.2.2.2" xref="Pt0.A1.T3.41.41.2.m1.1.1.2.2.2.cmml">4</mn><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.41.41.2.m1.1.1.2.2.1" xref="Pt0.A1.T3.41.41.2.m1.1.1.2.2.1.cmml">​</mo><mi id="Pt0.A1.T3.41.41.2.m1.1.1.2.2.3" xref="Pt0.A1.T3.41.41.2.m1.1.1.2.2.3.cmml">d</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="Pt0.A1.T3.41.41.2.m1.1.1.2.1" xref="Pt0.A1.T3.41.41.2.m1.1.1.2.1.cmml">×</mo><mn id="Pt0.A1.T3.41.41.2.m1.1.1.2.3" xref="Pt0.A1.T3.41.41.2.m1.1.1.2.3.cmml">16</mn></mrow><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.41.41.2.m1.1.1.1" xref="Pt0.A1.T3.41.41.2.m1.1.1.1.cmml">​</mo><mi id="Pt0.A1.T3.41.41.2.m1.1.1.3" xref="Pt0.A1.T3.41.41.2.m1.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.41.41.2.m1.1b"><apply id="Pt0.A1.T3.41.41.2.m1.1.1.cmml" xref="Pt0.A1.T3.41.41.2.m1.1.1"><times id="Pt0.A1.T3.41.41.2.m1.1.1.1.cmml" xref="Pt0.A1.T3.41.41.2.m1.1.1.1"></times><apply id="Pt0.A1.T3.41.41.2.m1.1.1.2.cmml" xref="Pt0.A1.T3.41.41.2.m1.1.1.2"><times id="Pt0.A1.T3.41.41.2.m1.1.1.2.1.cmml" xref="Pt0.A1.T3.41.41.2.m1.1.1.2.1"></times><apply id="Pt0.A1.T3.41.41.2.m1.1.1.2.2.cmml" xref="Pt0.A1.T3.41.41.2.m1.1.1.2.2"><times id="Pt0.A1.T3.41.41.2.m1.1.1.2.2.1.cmml" xref="Pt0.A1.T3.41.41.2.m1.1.1.2.2.1"></times><cn type="integer" id="Pt0.A1.T3.41.41.2.m1.1.1.2.2.2.cmml" xref="Pt0.A1.T3.41.41.2.m1.1.1.2.2.2">4</cn><ci id="Pt0.A1.T3.41.41.2.m1.1.1.2.2.3.cmml" xref="Pt0.A1.T3.41.41.2.m1.1.1.2.2.3">𝑑</ci></apply><cn type="integer" id="Pt0.A1.T3.41.41.2.m1.1.1.2.3.cmml" xref="Pt0.A1.T3.41.41.2.m1.1.1.2.3">16</cn></apply><ci id="Pt0.A1.T3.41.41.2.m1.1.1.3.cmml" xref="Pt0.A1.T3.41.41.2.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.41.41.2.m1.1c">4d\times 16d</annotation></semantics></math></td>
<td id="Pt0.A1.T3.42.42.3" class="ltx_td ltx_align_left ltx_border_t"><math id="Pt0.A1.T3.42.42.3.m1.1" class="ltx_Math" alttext="(4d\times 16d)\times T" display="inline"><semantics id="Pt0.A1.T3.42.42.3.m1.1a"><mrow id="Pt0.A1.T3.42.42.3.m1.1.1" xref="Pt0.A1.T3.42.42.3.m1.1.1.cmml"><mrow id="Pt0.A1.T3.42.42.3.m1.1.1.1.1" xref="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="Pt0.A1.T3.42.42.3.m1.1.1.1.1.2" xref="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.cmml">(</mo><mrow id="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1" xref="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.cmml"><mrow id="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2" xref="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2.cmml"><mrow id="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2.2" xref="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2.2.cmml"><mn id="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2.2.2" xref="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2.2.2.cmml">4</mn><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2.2.1" xref="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2.2.1.cmml">​</mo><mi id="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2.2.3" xref="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2.2.3.cmml">d</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2.1" xref="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2.1.cmml">×</mo><mn id="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2.3" xref="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2.3.cmml">16</mn></mrow><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.1" xref="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.1.cmml">​</mo><mi id="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.3" xref="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.3.cmml">d</mi></mrow><mo rspace="0.055em" stretchy="false" id="Pt0.A1.T3.42.42.3.m1.1.1.1.1.3" xref="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="Pt0.A1.T3.42.42.3.m1.1.1.2" xref="Pt0.A1.T3.42.42.3.m1.1.1.2.cmml">×</mo><mi id="Pt0.A1.T3.42.42.3.m1.1.1.3" xref="Pt0.A1.T3.42.42.3.m1.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.42.42.3.m1.1b"><apply id="Pt0.A1.T3.42.42.3.m1.1.1.cmml" xref="Pt0.A1.T3.42.42.3.m1.1.1"><times id="Pt0.A1.T3.42.42.3.m1.1.1.2.cmml" xref="Pt0.A1.T3.42.42.3.m1.1.1.2"></times><apply id="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.cmml" xref="Pt0.A1.T3.42.42.3.m1.1.1.1.1"><times id="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.1.cmml" xref="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.1"></times><apply id="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2.cmml" xref="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2"><times id="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2.1.cmml" xref="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2.1"></times><apply id="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2.2.cmml" xref="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2.2"><times id="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2.2.1.cmml" xref="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2.2.1"></times><cn type="integer" id="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2.2.2.cmml" xref="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2.2.2">4</cn><ci id="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2.2.3.cmml" xref="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2.2.3">𝑑</ci></apply><cn type="integer" id="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2.3.cmml" xref="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.2.3">16</cn></apply><ci id="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.3.cmml" xref="Pt0.A1.T3.42.42.3.m1.1.1.1.1.1.3">𝑑</ci></apply><ci id="Pt0.A1.T3.42.42.3.m1.1.1.3.cmml" xref="Pt0.A1.T3.42.42.3.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.42.42.3.m1.1c">(4d\times 16d)\times T</annotation></semantics></math></td>
</tr>
<tr id="Pt0.A1.T3.45.45" class="ltx_tr">
<th id="Pt0.A1.T3.45.45.4" class="ltx_td ltx_th ltx_th_row ltx_border_r"></th>
<th id="Pt0.A1.T3.43.43.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Lstm_cell <sub id="Pt0.A1.T3.43.43.1.1" class="ltx_sub"><span id="Pt0.A1.T3.43.43.1.1.1" class="ltx_text ltx_font_italic">ih</span></sub>
</th>
<td id="Pt0.A1.T3.44.44.2" class="ltx_td ltx_align_left ltx_border_r"><math id="Pt0.A1.T3.44.44.2.m1.1" class="ltx_Math" alttext="16d" display="inline"><semantics id="Pt0.A1.T3.44.44.2.m1.1a"><mrow id="Pt0.A1.T3.44.44.2.m1.1.1" xref="Pt0.A1.T3.44.44.2.m1.1.1.cmml"><mn id="Pt0.A1.T3.44.44.2.m1.1.1.2" xref="Pt0.A1.T3.44.44.2.m1.1.1.2.cmml">16</mn><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.44.44.2.m1.1.1.1" xref="Pt0.A1.T3.44.44.2.m1.1.1.1.cmml">​</mo><mi id="Pt0.A1.T3.44.44.2.m1.1.1.3" xref="Pt0.A1.T3.44.44.2.m1.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.44.44.2.m1.1b"><apply id="Pt0.A1.T3.44.44.2.m1.1.1.cmml" xref="Pt0.A1.T3.44.44.2.m1.1.1"><times id="Pt0.A1.T3.44.44.2.m1.1.1.1.cmml" xref="Pt0.A1.T3.44.44.2.m1.1.1.1"></times><cn type="integer" id="Pt0.A1.T3.44.44.2.m1.1.1.2.cmml" xref="Pt0.A1.T3.44.44.2.m1.1.1.2">16</cn><ci id="Pt0.A1.T3.44.44.2.m1.1.1.3.cmml" xref="Pt0.A1.T3.44.44.2.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.44.44.2.m1.1c">16d</annotation></semantics></math></td>
<td id="Pt0.A1.T3.45.45.3" class="ltx_td ltx_align_left"><math id="Pt0.A1.T3.45.45.3.m1.1" class="ltx_Math" alttext="(16d)\times T" display="inline"><semantics id="Pt0.A1.T3.45.45.3.m1.1a"><mrow id="Pt0.A1.T3.45.45.3.m1.1.1" xref="Pt0.A1.T3.45.45.3.m1.1.1.cmml"><mrow id="Pt0.A1.T3.45.45.3.m1.1.1.1.1" xref="Pt0.A1.T3.45.45.3.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="Pt0.A1.T3.45.45.3.m1.1.1.1.1.2" xref="Pt0.A1.T3.45.45.3.m1.1.1.1.1.1.cmml">(</mo><mrow id="Pt0.A1.T3.45.45.3.m1.1.1.1.1.1" xref="Pt0.A1.T3.45.45.3.m1.1.1.1.1.1.cmml"><mn id="Pt0.A1.T3.45.45.3.m1.1.1.1.1.1.2" xref="Pt0.A1.T3.45.45.3.m1.1.1.1.1.1.2.cmml">16</mn><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.45.45.3.m1.1.1.1.1.1.1" xref="Pt0.A1.T3.45.45.3.m1.1.1.1.1.1.1.cmml">​</mo><mi id="Pt0.A1.T3.45.45.3.m1.1.1.1.1.1.3" xref="Pt0.A1.T3.45.45.3.m1.1.1.1.1.1.3.cmml">d</mi></mrow><mo rspace="0.055em" stretchy="false" id="Pt0.A1.T3.45.45.3.m1.1.1.1.1.3" xref="Pt0.A1.T3.45.45.3.m1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="Pt0.A1.T3.45.45.3.m1.1.1.2" xref="Pt0.A1.T3.45.45.3.m1.1.1.2.cmml">×</mo><mi id="Pt0.A1.T3.45.45.3.m1.1.1.3" xref="Pt0.A1.T3.45.45.3.m1.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.45.45.3.m1.1b"><apply id="Pt0.A1.T3.45.45.3.m1.1.1.cmml" xref="Pt0.A1.T3.45.45.3.m1.1.1"><times id="Pt0.A1.T3.45.45.3.m1.1.1.2.cmml" xref="Pt0.A1.T3.45.45.3.m1.1.1.2"></times><apply id="Pt0.A1.T3.45.45.3.m1.1.1.1.1.1.cmml" xref="Pt0.A1.T3.45.45.3.m1.1.1.1.1"><times id="Pt0.A1.T3.45.45.3.m1.1.1.1.1.1.1.cmml" xref="Pt0.A1.T3.45.45.3.m1.1.1.1.1.1.1"></times><cn type="integer" id="Pt0.A1.T3.45.45.3.m1.1.1.1.1.1.2.cmml" xref="Pt0.A1.T3.45.45.3.m1.1.1.1.1.1.2">16</cn><ci id="Pt0.A1.T3.45.45.3.m1.1.1.1.1.1.3.cmml" xref="Pt0.A1.T3.45.45.3.m1.1.1.1.1.1.3">𝑑</ci></apply><ci id="Pt0.A1.T3.45.45.3.m1.1.1.3.cmml" xref="Pt0.A1.T3.45.45.3.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.45.45.3.m1.1c">(16d)\times T</annotation></semantics></math></td>
</tr>
<tr id="Pt0.A1.T3.48.48" class="ltx_tr">
<th id="Pt0.A1.T3.48.48.4" class="ltx_td ltx_th ltx_th_row ltx_border_r"></th>
<th id="Pt0.A1.T3.46.46.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Lstm_cell <math id="Pt0.A1.T3.46.46.1.m1.1" class="ltx_Math" alttext="W_{hh}" display="inline"><semantics id="Pt0.A1.T3.46.46.1.m1.1a"><msub id="Pt0.A1.T3.46.46.1.m1.1.1" xref="Pt0.A1.T3.46.46.1.m1.1.1.cmml"><mi id="Pt0.A1.T3.46.46.1.m1.1.1.2" xref="Pt0.A1.T3.46.46.1.m1.1.1.2.cmml">W</mi><mrow id="Pt0.A1.T3.46.46.1.m1.1.1.3" xref="Pt0.A1.T3.46.46.1.m1.1.1.3.cmml"><mi id="Pt0.A1.T3.46.46.1.m1.1.1.3.2" xref="Pt0.A1.T3.46.46.1.m1.1.1.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.46.46.1.m1.1.1.3.1" xref="Pt0.A1.T3.46.46.1.m1.1.1.3.1.cmml">​</mo><mi id="Pt0.A1.T3.46.46.1.m1.1.1.3.3" xref="Pt0.A1.T3.46.46.1.m1.1.1.3.3.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.46.46.1.m1.1b"><apply id="Pt0.A1.T3.46.46.1.m1.1.1.cmml" xref="Pt0.A1.T3.46.46.1.m1.1.1"><csymbol cd="ambiguous" id="Pt0.A1.T3.46.46.1.m1.1.1.1.cmml" xref="Pt0.A1.T3.46.46.1.m1.1.1">subscript</csymbol><ci id="Pt0.A1.T3.46.46.1.m1.1.1.2.cmml" xref="Pt0.A1.T3.46.46.1.m1.1.1.2">𝑊</ci><apply id="Pt0.A1.T3.46.46.1.m1.1.1.3.cmml" xref="Pt0.A1.T3.46.46.1.m1.1.1.3"><times id="Pt0.A1.T3.46.46.1.m1.1.1.3.1.cmml" xref="Pt0.A1.T3.46.46.1.m1.1.1.3.1"></times><ci id="Pt0.A1.T3.46.46.1.m1.1.1.3.2.cmml" xref="Pt0.A1.T3.46.46.1.m1.1.1.3.2">ℎ</ci><ci id="Pt0.A1.T3.46.46.1.m1.1.1.3.3.cmml" xref="Pt0.A1.T3.46.46.1.m1.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.46.46.1.m1.1c">W_{hh}</annotation></semantics></math>
</th>
<td id="Pt0.A1.T3.47.47.2" class="ltx_td ltx_align_left ltx_border_r"><math id="Pt0.A1.T3.47.47.2.m1.1" class="ltx_Math" alttext="4d\times 16d" display="inline"><semantics id="Pt0.A1.T3.47.47.2.m1.1a"><mrow id="Pt0.A1.T3.47.47.2.m1.1.1" xref="Pt0.A1.T3.47.47.2.m1.1.1.cmml"><mrow id="Pt0.A1.T3.47.47.2.m1.1.1.2" xref="Pt0.A1.T3.47.47.2.m1.1.1.2.cmml"><mrow id="Pt0.A1.T3.47.47.2.m1.1.1.2.2" xref="Pt0.A1.T3.47.47.2.m1.1.1.2.2.cmml"><mn id="Pt0.A1.T3.47.47.2.m1.1.1.2.2.2" xref="Pt0.A1.T3.47.47.2.m1.1.1.2.2.2.cmml">4</mn><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.47.47.2.m1.1.1.2.2.1" xref="Pt0.A1.T3.47.47.2.m1.1.1.2.2.1.cmml">​</mo><mi id="Pt0.A1.T3.47.47.2.m1.1.1.2.2.3" xref="Pt0.A1.T3.47.47.2.m1.1.1.2.2.3.cmml">d</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="Pt0.A1.T3.47.47.2.m1.1.1.2.1" xref="Pt0.A1.T3.47.47.2.m1.1.1.2.1.cmml">×</mo><mn id="Pt0.A1.T3.47.47.2.m1.1.1.2.3" xref="Pt0.A1.T3.47.47.2.m1.1.1.2.3.cmml">16</mn></mrow><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.47.47.2.m1.1.1.1" xref="Pt0.A1.T3.47.47.2.m1.1.1.1.cmml">​</mo><mi id="Pt0.A1.T3.47.47.2.m1.1.1.3" xref="Pt0.A1.T3.47.47.2.m1.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.47.47.2.m1.1b"><apply id="Pt0.A1.T3.47.47.2.m1.1.1.cmml" xref="Pt0.A1.T3.47.47.2.m1.1.1"><times id="Pt0.A1.T3.47.47.2.m1.1.1.1.cmml" xref="Pt0.A1.T3.47.47.2.m1.1.1.1"></times><apply id="Pt0.A1.T3.47.47.2.m1.1.1.2.cmml" xref="Pt0.A1.T3.47.47.2.m1.1.1.2"><times id="Pt0.A1.T3.47.47.2.m1.1.1.2.1.cmml" xref="Pt0.A1.T3.47.47.2.m1.1.1.2.1"></times><apply id="Pt0.A1.T3.47.47.2.m1.1.1.2.2.cmml" xref="Pt0.A1.T3.47.47.2.m1.1.1.2.2"><times id="Pt0.A1.T3.47.47.2.m1.1.1.2.2.1.cmml" xref="Pt0.A1.T3.47.47.2.m1.1.1.2.2.1"></times><cn type="integer" id="Pt0.A1.T3.47.47.2.m1.1.1.2.2.2.cmml" xref="Pt0.A1.T3.47.47.2.m1.1.1.2.2.2">4</cn><ci id="Pt0.A1.T3.47.47.2.m1.1.1.2.2.3.cmml" xref="Pt0.A1.T3.47.47.2.m1.1.1.2.2.3">𝑑</ci></apply><cn type="integer" id="Pt0.A1.T3.47.47.2.m1.1.1.2.3.cmml" xref="Pt0.A1.T3.47.47.2.m1.1.1.2.3">16</cn></apply><ci id="Pt0.A1.T3.47.47.2.m1.1.1.3.cmml" xref="Pt0.A1.T3.47.47.2.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.47.47.2.m1.1c">4d\times 16d</annotation></semantics></math></td>
<td id="Pt0.A1.T3.48.48.3" class="ltx_td ltx_align_left"><math id="Pt0.A1.T3.48.48.3.m1.1" class="ltx_Math" alttext="(4d\times 16d)\times T" display="inline"><semantics id="Pt0.A1.T3.48.48.3.m1.1a"><mrow id="Pt0.A1.T3.48.48.3.m1.1.1" xref="Pt0.A1.T3.48.48.3.m1.1.1.cmml"><mrow id="Pt0.A1.T3.48.48.3.m1.1.1.1.1" xref="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="Pt0.A1.T3.48.48.3.m1.1.1.1.1.2" xref="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.cmml">(</mo><mrow id="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1" xref="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.cmml"><mrow id="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2" xref="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2.cmml"><mrow id="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2.2" xref="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2.2.cmml"><mn id="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2.2.2" xref="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2.2.2.cmml">4</mn><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2.2.1" xref="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2.2.1.cmml">​</mo><mi id="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2.2.3" xref="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2.2.3.cmml">d</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2.1" xref="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2.1.cmml">×</mo><mn id="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2.3" xref="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2.3.cmml">16</mn></mrow><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.1" xref="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.1.cmml">​</mo><mi id="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.3" xref="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.3.cmml">d</mi></mrow><mo rspace="0.055em" stretchy="false" id="Pt0.A1.T3.48.48.3.m1.1.1.1.1.3" xref="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="Pt0.A1.T3.48.48.3.m1.1.1.2" xref="Pt0.A1.T3.48.48.3.m1.1.1.2.cmml">×</mo><mi id="Pt0.A1.T3.48.48.3.m1.1.1.3" xref="Pt0.A1.T3.48.48.3.m1.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.48.48.3.m1.1b"><apply id="Pt0.A1.T3.48.48.3.m1.1.1.cmml" xref="Pt0.A1.T3.48.48.3.m1.1.1"><times id="Pt0.A1.T3.48.48.3.m1.1.1.2.cmml" xref="Pt0.A1.T3.48.48.3.m1.1.1.2"></times><apply id="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.cmml" xref="Pt0.A1.T3.48.48.3.m1.1.1.1.1"><times id="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.1.cmml" xref="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.1"></times><apply id="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2.cmml" xref="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2"><times id="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2.1.cmml" xref="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2.1"></times><apply id="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2.2.cmml" xref="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2.2"><times id="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2.2.1.cmml" xref="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2.2.1"></times><cn type="integer" id="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2.2.2.cmml" xref="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2.2.2">4</cn><ci id="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2.2.3.cmml" xref="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2.2.3">𝑑</ci></apply><cn type="integer" id="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2.3.cmml" xref="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.2.3">16</cn></apply><ci id="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.3.cmml" xref="Pt0.A1.T3.48.48.3.m1.1.1.1.1.1.3">𝑑</ci></apply><ci id="Pt0.A1.T3.48.48.3.m1.1.1.3.cmml" xref="Pt0.A1.T3.48.48.3.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.48.48.3.m1.1c">(4d\times 16d)\times T</annotation></semantics></math></td>
</tr>
<tr id="Pt0.A1.T3.51.51" class="ltx_tr">
<th id="Pt0.A1.T3.51.51.4" class="ltx_td ltx_th ltx_th_row ltx_border_b ltx_border_r"></th>
<th id="Pt0.A1.T3.49.49.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r">Lstm_cell <math id="Pt0.A1.T3.49.49.1.m1.1" class="ltx_Math" alttext="b_{hh}" display="inline"><semantics id="Pt0.A1.T3.49.49.1.m1.1a"><msub id="Pt0.A1.T3.49.49.1.m1.1.1" xref="Pt0.A1.T3.49.49.1.m1.1.1.cmml"><mi id="Pt0.A1.T3.49.49.1.m1.1.1.2" xref="Pt0.A1.T3.49.49.1.m1.1.1.2.cmml">b</mi><mrow id="Pt0.A1.T3.49.49.1.m1.1.1.3" xref="Pt0.A1.T3.49.49.1.m1.1.1.3.cmml"><mi id="Pt0.A1.T3.49.49.1.m1.1.1.3.2" xref="Pt0.A1.T3.49.49.1.m1.1.1.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.49.49.1.m1.1.1.3.1" xref="Pt0.A1.T3.49.49.1.m1.1.1.3.1.cmml">​</mo><mi id="Pt0.A1.T3.49.49.1.m1.1.1.3.3" xref="Pt0.A1.T3.49.49.1.m1.1.1.3.3.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.49.49.1.m1.1b"><apply id="Pt0.A1.T3.49.49.1.m1.1.1.cmml" xref="Pt0.A1.T3.49.49.1.m1.1.1"><csymbol cd="ambiguous" id="Pt0.A1.T3.49.49.1.m1.1.1.1.cmml" xref="Pt0.A1.T3.49.49.1.m1.1.1">subscript</csymbol><ci id="Pt0.A1.T3.49.49.1.m1.1.1.2.cmml" xref="Pt0.A1.T3.49.49.1.m1.1.1.2">𝑏</ci><apply id="Pt0.A1.T3.49.49.1.m1.1.1.3.cmml" xref="Pt0.A1.T3.49.49.1.m1.1.1.3"><times id="Pt0.A1.T3.49.49.1.m1.1.1.3.1.cmml" xref="Pt0.A1.T3.49.49.1.m1.1.1.3.1"></times><ci id="Pt0.A1.T3.49.49.1.m1.1.1.3.2.cmml" xref="Pt0.A1.T3.49.49.1.m1.1.1.3.2">ℎ</ci><ci id="Pt0.A1.T3.49.49.1.m1.1.1.3.3.cmml" xref="Pt0.A1.T3.49.49.1.m1.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.49.49.1.m1.1c">b_{hh}</annotation></semantics></math>
</th>
<td id="Pt0.A1.T3.50.50.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_r"><math id="Pt0.A1.T3.50.50.2.m1.1" class="ltx_Math" alttext="16d" display="inline"><semantics id="Pt0.A1.T3.50.50.2.m1.1a"><mrow id="Pt0.A1.T3.50.50.2.m1.1.1" xref="Pt0.A1.T3.50.50.2.m1.1.1.cmml"><mn id="Pt0.A1.T3.50.50.2.m1.1.1.2" xref="Pt0.A1.T3.50.50.2.m1.1.1.2.cmml">16</mn><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.50.50.2.m1.1.1.1" xref="Pt0.A1.T3.50.50.2.m1.1.1.1.cmml">​</mo><mi id="Pt0.A1.T3.50.50.2.m1.1.1.3" xref="Pt0.A1.T3.50.50.2.m1.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.50.50.2.m1.1b"><apply id="Pt0.A1.T3.50.50.2.m1.1.1.cmml" xref="Pt0.A1.T3.50.50.2.m1.1.1"><times id="Pt0.A1.T3.50.50.2.m1.1.1.1.cmml" xref="Pt0.A1.T3.50.50.2.m1.1.1.1"></times><cn type="integer" id="Pt0.A1.T3.50.50.2.m1.1.1.2.cmml" xref="Pt0.A1.T3.50.50.2.m1.1.1.2">16</cn><ci id="Pt0.A1.T3.50.50.2.m1.1.1.3.cmml" xref="Pt0.A1.T3.50.50.2.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.50.50.2.m1.1c">16d</annotation></semantics></math></td>
<td id="Pt0.A1.T3.51.51.3" class="ltx_td ltx_align_left ltx_border_b"><math id="Pt0.A1.T3.51.51.3.m1.1" class="ltx_Math" alttext="(16d)\times T" display="inline"><semantics id="Pt0.A1.T3.51.51.3.m1.1a"><mrow id="Pt0.A1.T3.51.51.3.m1.1.1" xref="Pt0.A1.T3.51.51.3.m1.1.1.cmml"><mrow id="Pt0.A1.T3.51.51.3.m1.1.1.1.1" xref="Pt0.A1.T3.51.51.3.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="Pt0.A1.T3.51.51.3.m1.1.1.1.1.2" xref="Pt0.A1.T3.51.51.3.m1.1.1.1.1.1.cmml">(</mo><mrow id="Pt0.A1.T3.51.51.3.m1.1.1.1.1.1" xref="Pt0.A1.T3.51.51.3.m1.1.1.1.1.1.cmml"><mn id="Pt0.A1.T3.51.51.3.m1.1.1.1.1.1.2" xref="Pt0.A1.T3.51.51.3.m1.1.1.1.1.1.2.cmml">16</mn><mo lspace="0em" rspace="0em" id="Pt0.A1.T3.51.51.3.m1.1.1.1.1.1.1" xref="Pt0.A1.T3.51.51.3.m1.1.1.1.1.1.1.cmml">​</mo><mi id="Pt0.A1.T3.51.51.3.m1.1.1.1.1.1.3" xref="Pt0.A1.T3.51.51.3.m1.1.1.1.1.1.3.cmml">d</mi></mrow><mo rspace="0.055em" stretchy="false" id="Pt0.A1.T3.51.51.3.m1.1.1.1.1.3" xref="Pt0.A1.T3.51.51.3.m1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="Pt0.A1.T3.51.51.3.m1.1.1.2" xref="Pt0.A1.T3.51.51.3.m1.1.1.2.cmml">×</mo><mi id="Pt0.A1.T3.51.51.3.m1.1.1.3" xref="Pt0.A1.T3.51.51.3.m1.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.51.51.3.m1.1b"><apply id="Pt0.A1.T3.51.51.3.m1.1.1.cmml" xref="Pt0.A1.T3.51.51.3.m1.1.1"><times id="Pt0.A1.T3.51.51.3.m1.1.1.2.cmml" xref="Pt0.A1.T3.51.51.3.m1.1.1.2"></times><apply id="Pt0.A1.T3.51.51.3.m1.1.1.1.1.1.cmml" xref="Pt0.A1.T3.51.51.3.m1.1.1.1.1"><times id="Pt0.A1.T3.51.51.3.m1.1.1.1.1.1.1.cmml" xref="Pt0.A1.T3.51.51.3.m1.1.1.1.1.1.1"></times><cn type="integer" id="Pt0.A1.T3.51.51.3.m1.1.1.1.1.1.2.cmml" xref="Pt0.A1.T3.51.51.3.m1.1.1.1.1.1.2">16</cn><ci id="Pt0.A1.T3.51.51.3.m1.1.1.1.1.1.3.cmml" xref="Pt0.A1.T3.51.51.3.m1.1.1.1.1.1.3">𝑑</ci></apply><ci id="Pt0.A1.T3.51.51.3.m1.1.1.3.cmml" xref="Pt0.A1.T3.51.51.3.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.51.51.3.m1.1c">(16d)\times T</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="Pt0.A1.T3.57.5.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="Pt0.A1.T3.55.4" class="ltx_text" style="font-size:90%;">An overview of the number parameters and the asymptotic number of operations for the individual modules. The batch size is indicated by <math id="Pt0.A1.T3.52.1.m1.1" class="ltx_Math" alttext="B" display="inline"><semantics id="Pt0.A1.T3.52.1.m1.1b"><mi id="Pt0.A1.T3.52.1.m1.1.1" xref="Pt0.A1.T3.52.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.52.1.m1.1c"><ci id="Pt0.A1.T3.52.1.m1.1.1.cmml" xref="Pt0.A1.T3.52.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.52.1.m1.1d">B</annotation></semantics></math>. <math id="Pt0.A1.T3.53.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="Pt0.A1.T3.53.2.m2.1b"><mi id="Pt0.A1.T3.53.2.m2.1.1" xref="Pt0.A1.T3.53.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.53.2.m2.1c"><ci id="Pt0.A1.T3.53.2.m2.1.1.cmml" xref="Pt0.A1.T3.53.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.53.2.m2.1d">T</annotation></semantics></math> corresponds to the number of time steps. <math id="Pt0.A1.T3.54.3.m3.1" class="ltx_Math" alttext="D" display="inline"><semantics id="Pt0.A1.T3.54.3.m3.1b"><mi id="Pt0.A1.T3.54.3.m3.1.1" xref="Pt0.A1.T3.54.3.m3.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.54.3.m3.1c"><ci id="Pt0.A1.T3.54.3.m3.1.1.cmml" xref="Pt0.A1.T3.54.3.m3.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.54.3.m3.1d">D</annotation></semantics></math> and <math id="Pt0.A1.T3.55.4.m4.1" class="ltx_Math" alttext="H" display="inline"><semantics id="Pt0.A1.T3.55.4.m4.1b"><mi id="Pt0.A1.T3.55.4.m4.1.1" xref="Pt0.A1.T3.55.4.m4.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="Pt0.A1.T3.55.4.m4.1c"><ci id="Pt0.A1.T3.55.4.m4.1.1.cmml" xref="Pt0.A1.T3.55.4.m4.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.T3.55.4.m4.1d">H</annotation></semantics></math> denote the embedding size and
hidden size, respectively. Blocks are marked with a ”*” if their weights are not trainable.</span></figcaption>
</figure>
</section>
</section>
<section id="Pt0.A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix 0.B </span>Additional Details on the Dataset GQA</h2>

<div id="Pt0.A2.p1" class="ltx_para">
<p id="Pt0.A2.p1.1" class="ltx_p">In this section we describe various question category and their type. We list the question based on semantic and structural categories. We further grouped them based on their entity type like object, attribute, category etc. Table <a href="#Pt0.A2.T4" title="Table 4 ‣ Appendix 0.B Additional Details on the Dataset GQA ‣ Graphhopper: Multi-Hop Scene Graph Reasoning for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, describes the detailed list of question category.</p>
</div>
<figure id="Pt0.A2.T4" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="Pt0.A2.T4.2.1.1" class="ltx_text" style="font-size:90%;">Table 4</span>: </span><span id="Pt0.A2.T4.3.2" class="ltx_text" style="font-size:90%;">List of question examples in the GQA dataset.</span></figcaption>
<table id="Pt0.A2.T4.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="Pt0.A2.T4.4.1.1" class="ltx_tr">
<th id="Pt0.A2.T4.4.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t">Category</th>
<th id="Pt0.A2.T4.4.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t">Type</th>
<th id="Pt0.A2.T4.4.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t">Description</th>
<th id="Pt0.A2.T4.4.1.1.4" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_t">
<span id="Pt0.A2.T4.4.1.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="Pt0.A2.T4.4.1.1.4.1.1" class="ltx_p" style="width:180.7pt;">Example</span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="Pt0.A2.T4.4.2.1" class="ltx_tr">
<td id="Pt0.A2.T4.4.2.1.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" rowspan="5"><span id="Pt0.A2.T4.4.2.1.1.1" class="ltx_text">Semantics</span></td>
<td id="Pt0.A2.T4.4.2.1.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Object</td>
<td id="Pt0.A2.T4.4.2.1.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Existence of object</td>
<td id="Pt0.A2.T4.4.2.1.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="Pt0.A2.T4.4.2.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="Pt0.A2.T4.4.2.1.4.1.1" class="ltx_p" style="width:180.7pt;">Are there any doors that are not made of metal?</span>
</span>
</td>
</tr>
<tr id="Pt0.A2.T4.4.3.2" class="ltx_tr">
<td id="Pt0.A2.T4.4.3.2.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Attribute</td>
<td id="Pt0.A2.T4.4.3.2.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Property about an object</td>
<td id="Pt0.A2.T4.4.3.2.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="Pt0.A2.T4.4.3.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="Pt0.A2.T4.4.3.2.3.1.1" class="ltx_p" style="width:180.7pt;">Does the soap dispenser that is to the right of the other soap dispenser have small size and white color?</span>
</span>
</td>
</tr>
<tr id="Pt0.A2.T4.4.4.3" class="ltx_tr">
<td id="Pt0.A2.T4.4.4.3.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Category</td>
<td id="Pt0.A2.T4.4.4.3.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Identify an object class</td>
<td id="Pt0.A2.T4.4.4.3.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="Pt0.A2.T4.4.4.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="Pt0.A2.T4.4.4.3.3.1.1" class="ltx_p" style="width:180.7pt;">What kind of animal is standing?</span>
</span>
</td>
</tr>
<tr id="Pt0.A2.T4.4.5.4" class="ltx_tr">
<td id="Pt0.A2.T4.4.5.4.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Relation</td>
<td id="Pt0.A2.T4.4.5.4.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Relationship of object</td>
<td id="Pt0.A2.T4.4.5.4.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="Pt0.A2.T4.4.5.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="Pt0.A2.T4.4.5.4.3.1.1" class="ltx_p" style="width:180.7pt;">What is the food that is to the left of the white object that is to the left of the chocolate called?</span>
</span>
</td>
</tr>
<tr id="Pt0.A2.T4.4.6.5" class="ltx_tr">
<td id="Pt0.A2.T4.4.6.5.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Global</td>
<td id="Pt0.A2.T4.4.6.5.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Overall scene property</td>
<td id="Pt0.A2.T4.4.6.5.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="Pt0.A2.T4.4.6.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="Pt0.A2.T4.4.6.5.3.1.1" class="ltx_p" style="width:180.7pt;">Which place is it?</span>
</span>
</td>
</tr>
<tr id="Pt0.A2.T4.4.7.6" class="ltx_tr">
<td id="Pt0.A2.T4.4.7.6.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t" rowspan="5"><span id="Pt0.A2.T4.4.7.6.1.1" class="ltx_text">Structural</span></td>
<td id="Pt0.A2.T4.4.7.6.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Query</td>
<td id="Pt0.A2.T4.4.7.6.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Open-form question</td>
<td id="Pt0.A2.T4.4.7.6.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="Pt0.A2.T4.4.7.6.4.1" class="ltx_inline-block ltx_align_top">
<span id="Pt0.A2.T4.4.7.6.4.1.1" class="ltx_p" style="width:180.7pt;">What type of furniture is to the left of the silver device which is to the left of the helmet?</span>
</span>
</td>
</tr>
<tr id="Pt0.A2.T4.4.8.7" class="ltx_tr">
<td id="Pt0.A2.T4.4.8.7.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Choose</td>
<td id="Pt0.A2.T4.4.8.7.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Choose from alternatives</td>
<td id="Pt0.A2.T4.4.8.7.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="Pt0.A2.T4.4.8.7.3.1" class="ltx_inline-block ltx_align_top">
<span id="Pt0.A2.T4.4.8.7.3.1.1" class="ltx_p" style="width:180.7pt;">What are the floating people in the ocean doing, riding or swimming?</span>
</span>
</td>
</tr>
<tr id="Pt0.A2.T4.4.9.8" class="ltx_tr">
<td id="Pt0.A2.T4.4.9.8.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Verify</td>
<td id="Pt0.A2.T4.4.9.8.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Simple yes/no question</td>
<td id="Pt0.A2.T4.4.9.8.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="Pt0.A2.T4.4.9.8.3.1" class="ltx_inline-block ltx_align_top">
<span id="Pt0.A2.T4.4.9.8.3.1.1" class="ltx_p" style="width:180.7pt;">Are there statues above the brass clock that is on the building?</span>
</span>
</td>
</tr>
<tr id="Pt0.A2.T4.4.10.9" class="ltx_tr">
<td id="Pt0.A2.T4.4.10.9.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Compare</td>
<td id="Pt0.A2.T4.4.10.9.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Comparison of objects</td>
<td id="Pt0.A2.T4.4.10.9.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="Pt0.A2.T4.4.10.9.3.1" class="ltx_inline-block ltx_align_top">
<span id="Pt0.A2.T4.4.10.9.3.1.1" class="ltx_p" style="width:180.7pt;">Are the drawers made of the same material as the cages?</span>
</span>
</td>
</tr>
<tr id="Pt0.A2.T4.4.11.10" class="ltx_tr">
<td id="Pt0.A2.T4.4.11.10.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t">Logical</td>
<td id="Pt0.A2.T4.4.11.10.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t">And/or operators</td>
<td id="Pt0.A2.T4.4.11.10.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t">
<span id="Pt0.A2.T4.4.11.10.3.1" class="ltx_inline-block ltx_align_top">
<span id="Pt0.A2.T4.4.11.10.3.1.1" class="ltx_p" style="width:180.7pt;">Are both the giraffe near the building and the giraffe that is to the left of the tray standing?</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2107.06324" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2107.06325" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2107.06325">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2107.06325" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2107.06326" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sat Mar  2 04:54:43 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
