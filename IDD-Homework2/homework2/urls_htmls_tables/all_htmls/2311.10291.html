<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2311.10291] Leveraging Function Space Aggregation for Federated Learning at Scale</title><meta property="og:description" content="The federated learning paradigm has motivated the development of methods for aggregating multiple client updates into a global server model, without sharing client data.
Many federated learning algorithms, including th…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Leveraging Function Space Aggregation for Federated Learning at Scale">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Leveraging Function Space Aggregation for Federated Learning at Scale">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2311.10291">

<!--Generated on Tue Feb 27 18:44:43 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Leveraging Function Space Aggregation 
<br class="ltx_break">for Federated Learning at Scale</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span id="id1.1.id1" class="ltx_text ltx_font_bold">Nikita Dhawan   </span><span id="id2.2.id2" class="ltx_text ltx_font_italic" style="font-size:90%;">nikita@cs.toronto.edu 
<br class="ltx_break">University of Toronto and Vector Institute
</span><span id="id3.3.id3" class="ltx_text ltx_font_bold">Nicole Mitchell<span id="footnotex1" class="ltx_note ltx_role_footnotemark"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note"><span id="footnotex1.1.1.1" class="ltx_text ltx_font_medium">1</span></span></span></span></span>  </span><span id="id4.4.id4" class="ltx_text ltx_font_italic" style="font-size:90%;">nicolemitchell@google.com 
<br class="ltx_break">Google Research
</span><span id="id5.5.id5" class="ltx_text ltx_font_bold">Zachary Charles  </span><span id="id6.6.id6" class="ltx_text ltx_font_italic" style="font-size:90%;">zachcharles@google.com
<br class="ltx_break">Google Research
</span><span id="id7.7.id7" class="ltx_text ltx_font_bold">Zachary Garrett  </span><span id="id8.8.id8" class="ltx_text ltx_font_italic" style="font-size:90%;">zachgarrett@google.com
<br class="ltx_break">Google Research
</span><span id="id9.9.id9" class="ltx_text ltx_font_bold">Gintare Karolina Dziugaite  </span><span id="id10.10.id10" class="ltx_text ltx_font_italic" style="font-size:90%;">gkdz@google.com
<br class="ltx_break">Google DeepMind and Mila - Quebec AI Institute
</span>
</span><span class="ltx_author_notes"><span id="id11.11.id1" class="ltx_text ltx_font_bold">Equal contribution.</span><span id="id12.12.id1" class="ltx_text ltx_font_bold">Work done as Student Researcher at Google Research.</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id13.id1" class="ltx_p">The federated learning paradigm has motivated the development of methods for aggregating multiple client updates into a global server model, without sharing client data.
Many federated learning algorithms, including the canonical Federated Averaging (<span id="id13.id1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span>), take a direct (possibly weighted) average of the client parameter updates, motivated by results in distributed optimization.
In this work, we adopt a function space perspective and propose a new
algorithm, <span id="id13.id1.2" class="ltx_text ltx_font_smallcaps">FedFish</span>, that aggregates local approximations to the functions learned by clients, using an estimate based on their Fisher information. We evaluate <span id="id13.id1.3" class="ltx_text ltx_font_smallcaps">FedFish</span> on realistic, large-scale cross-device benchmarks.
While the performance of <span id="id13.id1.4" class="ltx_text ltx_font_smallcaps">FedAvg</span> can suffer as client models drift further apart, we demonstrate that <span id="id13.id1.5" class="ltx_text ltx_font_smallcaps">FedFish</span> is more robust to longer local training. Our evaluation across several settings in image and language benchmarks shows that <span id="id13.id1.6" class="ltx_text ltx_font_smallcaps">FedFish</span> outperforms <span id="id13.id1.7" class="ltx_text ltx_font_smallcaps">FedAvg</span> as local training epochs increase.
Further, <span id="id13.id1.8" class="ltx_text ltx_font_smallcaps">FedFish</span> results in global networks that are more amenable to efficient personalization via local fine-tuning on the same or shifted data distributions. For instance, federated pretraining on the C4 dataset, followed by few-shot personalization on Stack Overflow, results in a 7% improvement in next-token prediction by <span id="id13.id1.9" class="ltx_text ltx_font_smallcaps">FedFish</span> over <span id="id13.id1.10" class="ltx_text ltx_font_smallcaps">FedAvg</span>.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">Methods for aggregating separately trained neural networks have received renewed attention as machine learning models and data reach ever larger scales <cite class="ltx_cite ltx_citemacro_citep">(Wortsman et al., <a href="#bib.bib41" title="" class="ltx_ref">2022</a>; Li et al., <a href="#bib.bib28" title="" class="ltx_ref">2022</a>; Rame et al., <a href="#bib.bib37" title="" class="ltx_ref">2023</a>)</cite>. Parallel training can yield gains in computational efficiency <cite class="ltx_cite ltx_citemacro_citep">(Assran et al., <a href="#bib.bib2" title="" class="ltx_ref">2020</a>; Li et al., <a href="#bib.bib28" title="" class="ltx_ref">2022</a>)</cite> and meet constraints on access to private data, as in Federated Learning <cite class="ltx_cite ltx_citemacro_citep">(FL; McMahan et al., <a href="#bib.bib33" title="" class="ltx_ref">2017</a>)</cite>. Model aggregation plays a central role in how clients collaboratively train a model in a distributed manner via FL without sharing data among each other or with any orchestrating server. Given that the <em id="S1.p1.1.1" class="ltx_emph ltx_font_italic">cross-device</em> FL setting is characterized by client data heterogeneity, unreliable client availability and network constraints <cite class="ltx_cite ltx_citemacro_citep">(Kairouz et al., <a href="#bib.bib22" title="" class="ltx_ref">2021</a>)</cite>, FL is typically carried out over multiple communication rounds in which updates from local training are aggregated to iteratively improve the global model. The canonical approach to aggregation, implemented by the <span id="S1.p1.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> method and its adaptive variants <cite class="ltx_cite ltx_citemacro_citep">(Reddi et al., <a href="#bib.bib38" title="" class="ltx_ref">2020</a>)</cite>, is to combine client model parameter updates by averaging them, weighted in proportion to their respective dataset sizes.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">In this work, we take a function space perspective <cite class="ltx_cite ltx_citemacro_citep">(Benjamin et al., <a href="#bib.bib4" title="" class="ltx_ref">2018</a>)</cite> of model aggregation in FL,
where we aim to obtain a global model that simultaneously matches each client model’s logit outputs on that client’s data.
One motivation for this is to allow for, and reap the benefits of, more local training between global updates.
The performance of algorithms like <span id="S1.p2.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> depends heavily on the number of local training iterations.
When the data are heterogeneous across clients,
training too long between communication rounds leads to updates that hurt the global model’s performance, a phenomenon known as
client drift <cite class="ltx_cite ltx_citemacro_citep">(Karimireddy et al., <a href="#bib.bib23" title="" class="ltx_ref">2020</a>)</cite>.
Indeed, prior work has shown that the number of local training steps dictates a trade-off between the speed of convergence and the quality of the resulting model <cite class="ltx_cite ltx_citemacro_citep">(Charles &amp; Konečnỳ, <a href="#bib.bib6" title="" class="ltx_ref">2021</a>; Malinovskiy et al., <a href="#bib.bib30" title="" class="ltx_ref">2020</a>; Pathak &amp; Wainwright, <a href="#bib.bib35" title="" class="ltx_ref">2020</a>)</cite>.
These results imply that selecting the number of local steps is critical. It is also challenging, in part, due to the difficulties of hyperparameter tuning in federated settings <cite class="ltx_cite ltx_citemacro_citep">(Kuo et al., <a href="#bib.bib26" title="" class="ltx_ref">2023</a>)</cite>, and in part because the number of local steps has wide ranging effects.
These include not only the speed of convergence <cite class="ltx_cite ltx_citemacro_citep">(Pathak &amp; Wainwright, <a href="#bib.bib35" title="" class="ltx_ref">2020</a>; Mitra et al., <a href="#bib.bib34" title="" class="ltx_ref">2021</a>)</cite>, but also the optimization dynamics <cite class="ltx_cite ltx_citemacro_citep">(Charles &amp; Rush, <a href="#bib.bib7" title="" class="ltx_ref">2022</a>)</cite> and even whether the method acts as a meta-learner <cite class="ltx_cite ltx_citemacro_citep">(Collins et al., <a href="#bib.bib10" title="" class="ltx_ref">2022</a>; Charles et al., <a href="#bib.bib8" title="" class="ltx_ref">2023</a>)</cite>. While there are a variety of FL methods aimed at mitigating client drift (see <cite class="ltx_cite ltx_citemacro_citet">Wang et al. (<a href="#bib.bib40" title="" class="ltx_ref">2021</a>)</cite> for an overview), many of these introduce extra hyperparameters to tune and remain sensitive to the number of local steps <cite class="ltx_cite ltx_citemacro_citep">(Mitra et al., <a href="#bib.bib34" title="" class="ltx_ref">2021</a>; Charles &amp; Konečnỳ, <a href="#bib.bib6" title="" class="ltx_ref">2021</a>)</cite>.
Instead, we argue that the choice of model aggregation technique plays a role in the client drift problem and taking a function space view of it sidesteps this pitfall by aiming for a global model that more faithfully represents the client models.</p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">A key obstacle to our function space approach, matching the client models’ outputs on client data,
is its dependence on client data.
FL constrains access to client data,
preventing a direct approach where the global server uses client data to match the corresponding model outputs.
As a step towards parametric function space model aggregation which does not require direct access to client data, we propose and implement a Fisher-weighted federated averaging algorithm, called <span id="S1.p3.1.1" class="ltx_text ltx_font_smallcaps">FedFish</span>. This method is derived from an objective that minimizes an approximate function space distance between local client models and the global model. The closed-form solution of this objective depends on the networks’ Fisher Information <cite class="ltx_cite ltx_citemacro_citep">(Cover, <a href="#bib.bib11" title="" class="ltx_ref">1999</a>)</cite>, which are typically too expensive to compute and store for large models.
The approximations required to implement our method in practice lead to a parametric aggregation scheme which accounts for the client data distributions via the functions represented by their local models. We investigate the advantage this confers upon <span id="S1.p3.1.2" class="ltx_text ltx_font_smallcaps">FedFish</span> over simple averaging (<span id="S1.p3.1.3" class="ltx_text ltx_font_smallcaps">FedAvg</span>) in regression, image classification and language modeling benchmarks.</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p">Our extensive evaluation includes domain-specific criteria as well as metrics specific to FL.
We demonstrate settings in which <span id="S1.p4.1.1" class="ltx_text ltx_font_smallcaps">FedFish</span> outperforms <span id="S1.p4.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span>, especially as the amount of local training is varied.
Image and language experiments with varying levels of client data heterogeneity show improved post-personalization performance of <span id="S1.p4.1.3" class="ltx_text ltx_font_smallcaps">FedFish</span> throughout training, when the global model is locally fine-tuned for a few steps by clients that were held out during training. This observation also holds when measuring transfer performance by drawing the evaluation clients from a shifted data distribution.
For instance, in an experiment with federated pretraining on the large and hetergenous C4 dataset, followed by few-shot personalization on Stack Overflow clients, <span id="S1.p4.1.4" class="ltx_text ltx_font_smallcaps">FedFish</span> is able to improve upon <span id="S1.p4.1.5" class="ltx_text ltx_font_smallcaps">FedAvg</span>’s next-token prediction performance by 5-7%, depending on the amount of personalization data available.
We provide insight into these gains by assessing a measure of deviation between global and local models, coined the Client-Server Barrier. Finally, we discuss the impact of these methods and settings on the cost of communication between clients and the server.</p>
</div>
<section id="S1.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Contributions.</h5>

<div id="S1.SS0.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We formalize a function space perspective of federated learning to motivate a scalable algorithm, <span id="S1.I1.i1.p1.1.1" class="ltx_text ltx_font_smallcaps">FedFish</span>, which aims to match client input–output functions during aggregation.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">Via a synthetic example, we demonstrate that <span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_smallcaps">FedFish</span> outperforms <span id="S1.I1.i2.p1.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> as client data heterogeneity increases. We then investigate this performance at larger scales than have been explored by previous works.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Our thorough empirical results show that <span id="S1.I1.i3.p1.1.1" class="ltx_text ltx_font_smallcaps">FedFish</span> allows for longer local client training compared to <span id="S1.I1.i3.p1.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span>. We find that the global models learned via <span id="S1.I1.i3.p1.1.3" class="ltx_text ltx_font_smallcaps">FedFish</span> have greater ability to be personalized via fine-tuning on the same or shifted data distributions, indicating they provide a better initialization for local training in each round.</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i4.p1" class="ltx_para ltx_noindent">
<p id="S1.I1.i4.p1.1" class="ltx_p">We propose to evaluate effects of aggregation via a Client-Server Barrier, leveraging the function space perspective to gain further insight into the observed results.</p>
</div>
</li>
</ul>
</div>
<figure id="S1.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S1.F1.fig1" class="ltx_figure ltx_figure_panel ltx_align_center">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/2311.10291/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="155" height="87" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S1.F1.fig2" class="ltx_figure ltx_figure_panel ltx_align_center">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/2311.10291/assets/x2.png" id="S1.F1.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="155" height="87" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S1.F1.fig3" class="ltx_figure ltx_figure_panel ltx_align_center">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2311.10291/assets/x3.png" id="S1.F1.g3" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="155" height="87" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Given two functions modeled over disjoint supports (<span id="S1.F1.4.1" class="ltx_text ltx_font_bold">left</span>), a direct parameter average fails to represent either function well (<span id="S1.F1.5.2" class="ltx_text ltx_font_bold">center</span>), while function space aggregation aims to preserve both functional relationships (<span id="S1.F1.6.3" class="ltx_text ltx_font_bold">right</span>).</figcaption>
</figure>
</section>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Federated Learning in the Function Space</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p">We now define the federated learning problem from a function space perspective and describe the approximations that lead to a practical and parametric objective.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Problem Setting</h3>

<div id="S2.SS1.p1" class="ltx_para ltx_noindent">
<p id="S2.SS1.p1.11" class="ltx_p">Let a network parameterized by <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="{\mathbf{\theta}}" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">{\mathbf{\theta}}</annotation></semantics></math> be trained on a dataset of input–target pairs, <math id="S2.SS1.p1.2.m2.2" class="ltx_Math" alttext="D=(\mathbf{X},\mathbf{y})" display="inline"><semantics id="S2.SS1.p1.2.m2.2a"><mrow id="S2.SS1.p1.2.m2.2.3" xref="S2.SS1.p1.2.m2.2.3.cmml"><mi id="S2.SS1.p1.2.m2.2.3.2" xref="S2.SS1.p1.2.m2.2.3.2.cmml">D</mi><mo id="S2.SS1.p1.2.m2.2.3.1" xref="S2.SS1.p1.2.m2.2.3.1.cmml">=</mo><mrow id="S2.SS1.p1.2.m2.2.3.3.2" xref="S2.SS1.p1.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="S2.SS1.p1.2.m2.2.3.3.2.1" xref="S2.SS1.p1.2.m2.2.3.3.1.cmml">(</mo><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">𝐗</mi><mo id="S2.SS1.p1.2.m2.2.3.3.2.2" xref="S2.SS1.p1.2.m2.2.3.3.1.cmml">,</mo><mi id="S2.SS1.p1.2.m2.2.2" xref="S2.SS1.p1.2.m2.2.2.cmml">𝐲</mi><mo stretchy="false" id="S2.SS1.p1.2.m2.2.3.3.2.3" xref="S2.SS1.p1.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.2b"><apply id="S2.SS1.p1.2.m2.2.3.cmml" xref="S2.SS1.p1.2.m2.2.3"><eq id="S2.SS1.p1.2.m2.2.3.1.cmml" xref="S2.SS1.p1.2.m2.2.3.1"></eq><ci id="S2.SS1.p1.2.m2.2.3.2.cmml" xref="S2.SS1.p1.2.m2.2.3.2">𝐷</ci><interval closure="open" id="S2.SS1.p1.2.m2.2.3.3.1.cmml" xref="S2.SS1.p1.2.m2.2.3.3.2"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝐗</ci><ci id="S2.SS1.p1.2.m2.2.2.cmml" xref="S2.SS1.p1.2.m2.2.2">𝐲</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.2c">D=(\mathbf{X},\mathbf{y})</annotation></semantics></math>, to optimize a loss function <math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">\mathcal{L}</annotation></semantics></math>, such that it represents a function <math id="S2.SS1.p1.4.m4.2" class="ltx_Math" alttext="f(\mathbf{X};{\mathbf{\theta}})=\mathbf{Z}" display="inline"><semantics id="S2.SS1.p1.4.m4.2a"><mrow id="S2.SS1.p1.4.m4.2.3" xref="S2.SS1.p1.4.m4.2.3.cmml"><mrow id="S2.SS1.p1.4.m4.2.3.2" xref="S2.SS1.p1.4.m4.2.3.2.cmml"><mi id="S2.SS1.p1.4.m4.2.3.2.2" xref="S2.SS1.p1.4.m4.2.3.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.4.m4.2.3.2.1" xref="S2.SS1.p1.4.m4.2.3.2.1.cmml">​</mo><mrow id="S2.SS1.p1.4.m4.2.3.2.3.2" xref="S2.SS1.p1.4.m4.2.3.2.3.1.cmml"><mo stretchy="false" id="S2.SS1.p1.4.m4.2.3.2.3.2.1" xref="S2.SS1.p1.4.m4.2.3.2.3.1.cmml">(</mo><mi id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml">𝐗</mi><mo id="S2.SS1.p1.4.m4.2.3.2.3.2.2" xref="S2.SS1.p1.4.m4.2.3.2.3.1.cmml">;</mo><mi id="S2.SS1.p1.4.m4.2.2" xref="S2.SS1.p1.4.m4.2.2.cmml">θ</mi><mo stretchy="false" id="S2.SS1.p1.4.m4.2.3.2.3.2.3" xref="S2.SS1.p1.4.m4.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS1.p1.4.m4.2.3.1" xref="S2.SS1.p1.4.m4.2.3.1.cmml">=</mo><mi id="S2.SS1.p1.4.m4.2.3.3" xref="S2.SS1.p1.4.m4.2.3.3.cmml">𝐙</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.2b"><apply id="S2.SS1.p1.4.m4.2.3.cmml" xref="S2.SS1.p1.4.m4.2.3"><eq id="S2.SS1.p1.4.m4.2.3.1.cmml" xref="S2.SS1.p1.4.m4.2.3.1"></eq><apply id="S2.SS1.p1.4.m4.2.3.2.cmml" xref="S2.SS1.p1.4.m4.2.3.2"><times id="S2.SS1.p1.4.m4.2.3.2.1.cmml" xref="S2.SS1.p1.4.m4.2.3.2.1"></times><ci id="S2.SS1.p1.4.m4.2.3.2.2.cmml" xref="S2.SS1.p1.4.m4.2.3.2.2">𝑓</ci><list id="S2.SS1.p1.4.m4.2.3.2.3.1.cmml" xref="S2.SS1.p1.4.m4.2.3.2.3.2"><ci id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">𝐗</ci><ci id="S2.SS1.p1.4.m4.2.2.cmml" xref="S2.SS1.p1.4.m4.2.2">𝜃</ci></list></apply><ci id="S2.SS1.p1.4.m4.2.3.3.cmml" xref="S2.SS1.p1.4.m4.2.3.3">𝐙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.2c">f(\mathbf{X};{\mathbf{\theta}})=\mathbf{Z}</annotation></semantics></math>, where <math id="S2.SS1.p1.5.m5.1" class="ltx_Math" alttext="\mathbf{Z}" display="inline"><semantics id="S2.SS1.p1.5.m5.1a"><mi id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">𝐙</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝐙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">\mathbf{Z}</annotation></semantics></math> denotes the network’s outputs across all inputs.
Consider the canonical federated learning setting, where a global model’s parameters <math id="S2.SS1.p1.6.m6.1" class="ltx_Math" alttext="{\mathbf{\theta}}_{G}" display="inline"><semantics id="S2.SS1.p1.6.m6.1a"><msub id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml"><mi id="S2.SS1.p1.6.m6.1.1.2" xref="S2.SS1.p1.6.m6.1.1.2.cmml">θ</mi><mi id="S2.SS1.p1.6.m6.1.1.3" xref="S2.SS1.p1.6.m6.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><apply id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1.2">𝜃</ci><ci id="S2.SS1.p1.6.m6.1.1.3.cmml" xref="S2.SS1.p1.6.m6.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">{\mathbf{\theta}}_{G}</annotation></semantics></math> are broadcast to <math id="S2.SS1.p1.7.m7.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.SS1.p1.7.m7.1a"><mi id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><ci id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">N</annotation></semantics></math> clients for local training. Each client <math id="S2.SS1.p1.8.m8.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS1.p1.8.m8.1a"><mi id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.1b"><ci id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.1c">i</annotation></semantics></math> trains their model on local data <math id="S2.SS1.p1.9.m9.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="S2.SS1.p1.9.m9.1a"><msub id="S2.SS1.p1.9.m9.1.1" xref="S2.SS1.p1.9.m9.1.1.cmml"><mi id="S2.SS1.p1.9.m9.1.1.2" xref="S2.SS1.p1.9.m9.1.1.2.cmml">D</mi><mi id="S2.SS1.p1.9.m9.1.1.3" xref="S2.SS1.p1.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m9.1b"><apply id="S2.SS1.p1.9.m9.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.1.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1">subscript</csymbol><ci id="S2.SS1.p1.9.m9.1.1.2.cmml" xref="S2.SS1.p1.9.m9.1.1.2">𝐷</ci><ci id="S2.SS1.p1.9.m9.1.1.3.cmml" xref="S2.SS1.p1.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m9.1c">D_{i}</annotation></semantics></math> (with a corresponding set of input data <math id="S2.SS1.p1.10.m10.1" class="ltx_Math" alttext="\mathbf{X}_{i}" display="inline"><semantics id="S2.SS1.p1.10.m10.1a"><msub id="S2.SS1.p1.10.m10.1.1" xref="S2.SS1.p1.10.m10.1.1.cmml"><mi id="S2.SS1.p1.10.m10.1.1.2" xref="S2.SS1.p1.10.m10.1.1.2.cmml">𝐗</mi><mi id="S2.SS1.p1.10.m10.1.1.3" xref="S2.SS1.p1.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m10.1b"><apply id="S2.SS1.p1.10.m10.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.1.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1">subscript</csymbol><ci id="S2.SS1.p1.10.m10.1.1.2.cmml" xref="S2.SS1.p1.10.m10.1.1.2">𝐗</ci><ci id="S2.SS1.p1.10.m10.1.1.3.cmml" xref="S2.SS1.p1.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m10.1c">\mathbf{X}_{i}</annotation></semantics></math>) for a fixed number of iterations to produce trained parameters <math id="S2.SS1.p1.11.m11.1" class="ltx_Math" alttext="{\mathbf{\theta}}_{i}" display="inline"><semantics id="S2.SS1.p1.11.m11.1a"><msub id="S2.SS1.p1.11.m11.1.1" xref="S2.SS1.p1.11.m11.1.1.cmml"><mi id="S2.SS1.p1.11.m11.1.1.2" xref="S2.SS1.p1.11.m11.1.1.2.cmml">θ</mi><mi id="S2.SS1.p1.11.m11.1.1.3" xref="S2.SS1.p1.11.m11.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m11.1b"><apply id="S2.SS1.p1.11.m11.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m11.1.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1">subscript</csymbol><ci id="S2.SS1.p1.11.m11.1.1.2.cmml" xref="S2.SS1.p1.11.m11.1.1.2">𝜃</ci><ci id="S2.SS1.p1.11.m11.1.1.3.cmml" xref="S2.SS1.p1.11.m11.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m11.1c">{\mathbf{\theta}}_{i}</annotation></semantics></math>.
These parameters are then communicated back to a global server where they are aggregated using a specific aggregation technique.
This procedure is repeated over multiple rounds, where the aggregated model from each round serves as the initialization for local training in the subsequent round.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para ltx_noindent">
<p id="S2.SS1.p2.1" class="ltx_p">Viewing FL from a function space perspective, the aggregated model should ideally match the input–output relationships learned by each client so far.
More formally, for each federated round, we define the <em id="S2.SS1.p2.1.1" class="ltx_emph ltx_font_italic">optimal global model</em> as the one that produces outputs closest to each client’s outputs when evaluated on the corresponding input data. Let us denote this function space distance as <math id="S2.SS1.p2.1.m1.2" class="ltx_Math" alttext="\mathcal{D}\left(\cdot,\cdot\right)" display="inline"><semantics id="S2.SS1.p2.1.m1.2a"><mrow id="S2.SS1.p2.1.m1.2.3" xref="S2.SS1.p2.1.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.1.m1.2.3.2" xref="S2.SS1.p2.1.m1.2.3.2.cmml">𝒟</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.1.m1.2.3.1" xref="S2.SS1.p2.1.m1.2.3.1.cmml">​</mo><mrow id="S2.SS1.p2.1.m1.2.3.3.2" xref="S2.SS1.p2.1.m1.2.3.3.1.cmml"><mo id="S2.SS1.p2.1.m1.2.3.3.2.1" xref="S2.SS1.p2.1.m1.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml">⋅</mo><mo rspace="0em" id="S2.SS1.p2.1.m1.2.3.3.2.2" xref="S2.SS1.p2.1.m1.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S2.SS1.p2.1.m1.2.2" xref="S2.SS1.p2.1.m1.2.2.cmml">⋅</mo><mo id="S2.SS1.p2.1.m1.2.3.3.2.3" xref="S2.SS1.p2.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.2b"><apply id="S2.SS1.p2.1.m1.2.3.cmml" xref="S2.SS1.p2.1.m1.2.3"><times id="S2.SS1.p2.1.m1.2.3.1.cmml" xref="S2.SS1.p2.1.m1.2.3.1"></times><ci id="S2.SS1.p2.1.m1.2.3.2.cmml" xref="S2.SS1.p2.1.m1.2.3.2">𝒟</ci><interval closure="open" id="S2.SS1.p2.1.m1.2.3.3.1.cmml" xref="S2.SS1.p2.1.m1.2.3.3.2"><ci id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">⋅</ci><ci id="S2.SS1.p2.1.m1.2.2.cmml" xref="S2.SS1.p2.1.m1.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.2c">\mathcal{D}\left(\cdot,\cdot\right)</annotation></semantics></math>. Averaging this quantity over all clients, we obtain the following objective:</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.2" class="ltx_Math" alttext="{\mathbf{\theta}}_{G}^{*}=\arg\min_{{\mathbf{\theta}}}\frac{1}{N}\sum_{i=1}^{N}\mathcal{D}\left(f(\mathbf{X}_{i};{\mathbf{\theta}}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i})\right)." display="block"><semantics id="S2.E1.m1.2a"><mrow id="S2.E1.m1.2.2.1" xref="S2.E1.m1.2.2.1.1.cmml"><mrow id="S2.E1.m1.2.2.1.1" xref="S2.E1.m1.2.2.1.1.cmml"><msubsup id="S2.E1.m1.2.2.1.1.4" xref="S2.E1.m1.2.2.1.1.4.cmml"><mi id="S2.E1.m1.2.2.1.1.4.2.2" xref="S2.E1.m1.2.2.1.1.4.2.2.cmml">θ</mi><mi id="S2.E1.m1.2.2.1.1.4.2.3" xref="S2.E1.m1.2.2.1.1.4.2.3.cmml">G</mi><mo id="S2.E1.m1.2.2.1.1.4.3" xref="S2.E1.m1.2.2.1.1.4.3.cmml">∗</mo></msubsup><mo id="S2.E1.m1.2.2.1.1.3" xref="S2.E1.m1.2.2.1.1.3.cmml">=</mo><mrow id="S2.E1.m1.2.2.1.1.2" xref="S2.E1.m1.2.2.1.1.2.cmml"><mrow id="S2.E1.m1.2.2.1.1.2.4" xref="S2.E1.m1.2.2.1.1.2.4.cmml"><mi id="S2.E1.m1.2.2.1.1.2.4.1" xref="S2.E1.m1.2.2.1.1.2.4.1.cmml">arg</mi><mo lspace="0.167em" id="S2.E1.m1.2.2.1.1.2.4a" xref="S2.E1.m1.2.2.1.1.2.4.cmml">⁡</mo><mrow id="S2.E1.m1.2.2.1.1.2.4.2" xref="S2.E1.m1.2.2.1.1.2.4.2.cmml"><munder id="S2.E1.m1.2.2.1.1.2.4.2.1" xref="S2.E1.m1.2.2.1.1.2.4.2.1.cmml"><mi id="S2.E1.m1.2.2.1.1.2.4.2.1.2" xref="S2.E1.m1.2.2.1.1.2.4.2.1.2.cmml">min</mi><mi id="S2.E1.m1.2.2.1.1.2.4.2.1.3" xref="S2.E1.m1.2.2.1.1.2.4.2.1.3.cmml">θ</mi></munder><mo lspace="0.167em" id="S2.E1.m1.2.2.1.1.2.4.2a" xref="S2.E1.m1.2.2.1.1.2.4.2.cmml">⁡</mo><mfrac id="S2.E1.m1.2.2.1.1.2.4.2.2" xref="S2.E1.m1.2.2.1.1.2.4.2.2.cmml"><mn id="S2.E1.m1.2.2.1.1.2.4.2.2.2" xref="S2.E1.m1.2.2.1.1.2.4.2.2.2.cmml">1</mn><mi id="S2.E1.m1.2.2.1.1.2.4.2.2.3" xref="S2.E1.m1.2.2.1.1.2.4.2.2.3.cmml">N</mi></mfrac></mrow></mrow><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.1.1.2.3" xref="S2.E1.m1.2.2.1.1.2.3.cmml">​</mo><mrow id="S2.E1.m1.2.2.1.1.2.2" xref="S2.E1.m1.2.2.1.1.2.2.cmml"><munderover id="S2.E1.m1.2.2.1.1.2.2.3" xref="S2.E1.m1.2.2.1.1.2.2.3.cmml"><mo movablelimits="false" id="S2.E1.m1.2.2.1.1.2.2.3.2.2" xref="S2.E1.m1.2.2.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S2.E1.m1.2.2.1.1.2.2.3.2.3" xref="S2.E1.m1.2.2.1.1.2.2.3.2.3.cmml"><mi id="S2.E1.m1.2.2.1.1.2.2.3.2.3.2" xref="S2.E1.m1.2.2.1.1.2.2.3.2.3.2.cmml">i</mi><mo id="S2.E1.m1.2.2.1.1.2.2.3.2.3.1" xref="S2.E1.m1.2.2.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S2.E1.m1.2.2.1.1.2.2.3.2.3.3" xref="S2.E1.m1.2.2.1.1.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S2.E1.m1.2.2.1.1.2.2.3.3" xref="S2.E1.m1.2.2.1.1.2.2.3.3.cmml">N</mi></munderover><mrow id="S2.E1.m1.2.2.1.1.2.2.2" xref="S2.E1.m1.2.2.1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.2.2.1.1.2.2.2.4" xref="S2.E1.m1.2.2.1.1.2.2.2.4.cmml">𝒟</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.1.1.2.2.2.3" xref="S2.E1.m1.2.2.1.1.2.2.2.3.cmml">​</mo><mrow id="S2.E1.m1.2.2.1.1.2.2.2.2.2" xref="S2.E1.m1.2.2.1.1.2.2.2.2.3.cmml"><mo id="S2.E1.m1.2.2.1.1.2.2.2.2.2.3" xref="S2.E1.m1.2.2.1.1.2.2.2.2.3.cmml">(</mo><mrow id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐗</mi><mi id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">;</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.4" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.2.2.1.1.2.2.2.2.2.4" xref="S2.E1.m1.2.2.1.1.2.2.2.2.3.cmml">,</mo><mrow id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.cmml"><mi id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.4" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.3" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.3.cmml">​</mo><mrow id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.3" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2.3.cmml">(</mo><msub id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.1.1.1" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.1.1.1.cmml"><mi id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.1.1.1.2" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.1.1.1.2.cmml">𝐗</mi><mi id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.1.1.1.3" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.4" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2.3.cmml">;</mo><msub id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.2" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.cmml"><mi id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.cmml">θ</mi><mi id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.3" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.5" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.2.2.1.1.2.2.2.2.2.5" xref="S2.E1.m1.2.2.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S2.E1.m1.2.2.1.2" xref="S2.E1.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.2b"><apply id="S2.E1.m1.2.2.1.1.cmml" xref="S2.E1.m1.2.2.1"><eq id="S2.E1.m1.2.2.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.3"></eq><apply id="S2.E1.m1.2.2.1.1.4.cmml" xref="S2.E1.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.4.1.cmml" xref="S2.E1.m1.2.2.1.1.4">superscript</csymbol><apply id="S2.E1.m1.2.2.1.1.4.2.cmml" xref="S2.E1.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.4.2.1.cmml" xref="S2.E1.m1.2.2.1.1.4">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.4.2.2.cmml" xref="S2.E1.m1.2.2.1.1.4.2.2">𝜃</ci><ci id="S2.E1.m1.2.2.1.1.4.2.3.cmml" xref="S2.E1.m1.2.2.1.1.4.2.3">𝐺</ci></apply><times id="S2.E1.m1.2.2.1.1.4.3.cmml" xref="S2.E1.m1.2.2.1.1.4.3"></times></apply><apply id="S2.E1.m1.2.2.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.2"><times id="S2.E1.m1.2.2.1.1.2.3.cmml" xref="S2.E1.m1.2.2.1.1.2.3"></times><apply id="S2.E1.m1.2.2.1.1.2.4.cmml" xref="S2.E1.m1.2.2.1.1.2.4"><arg id="S2.E1.m1.2.2.1.1.2.4.1.cmml" xref="S2.E1.m1.2.2.1.1.2.4.1"></arg><apply id="S2.E1.m1.2.2.1.1.2.4.2.cmml" xref="S2.E1.m1.2.2.1.1.2.4.2"><apply id="S2.E1.m1.2.2.1.1.2.4.2.1.cmml" xref="S2.E1.m1.2.2.1.1.2.4.2.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.2.4.2.1.1.cmml" xref="S2.E1.m1.2.2.1.1.2.4.2.1">subscript</csymbol><min id="S2.E1.m1.2.2.1.1.2.4.2.1.2.cmml" xref="S2.E1.m1.2.2.1.1.2.4.2.1.2"></min><ci id="S2.E1.m1.2.2.1.1.2.4.2.1.3.cmml" xref="S2.E1.m1.2.2.1.1.2.4.2.1.3">𝜃</ci></apply><apply id="S2.E1.m1.2.2.1.1.2.4.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.4.2.2"><divide id="S2.E1.m1.2.2.1.1.2.4.2.2.1.cmml" xref="S2.E1.m1.2.2.1.1.2.4.2.2"></divide><cn type="integer" id="S2.E1.m1.2.2.1.1.2.4.2.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.4.2.2.2">1</cn><ci id="S2.E1.m1.2.2.1.1.2.4.2.2.3.cmml" xref="S2.E1.m1.2.2.1.1.2.4.2.2.3">𝑁</ci></apply></apply></apply><apply id="S2.E1.m1.2.2.1.1.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.2"><apply id="S2.E1.m1.2.2.1.1.2.2.3.cmml" xref="S2.E1.m1.2.2.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.2.2.3.1.cmml" xref="S2.E1.m1.2.2.1.1.2.2.3">superscript</csymbol><apply id="S2.E1.m1.2.2.1.1.2.2.3.2.cmml" xref="S2.E1.m1.2.2.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.2.2.3.2.1.cmml" xref="S2.E1.m1.2.2.1.1.2.2.3">subscript</csymbol><sum id="S2.E1.m1.2.2.1.1.2.2.3.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.2.3.2.2"></sum><apply id="S2.E1.m1.2.2.1.1.2.2.3.2.3.cmml" xref="S2.E1.m1.2.2.1.1.2.2.3.2.3"><eq id="S2.E1.m1.2.2.1.1.2.2.3.2.3.1.cmml" xref="S2.E1.m1.2.2.1.1.2.2.3.2.3.1"></eq><ci id="S2.E1.m1.2.2.1.1.2.2.3.2.3.2.cmml" xref="S2.E1.m1.2.2.1.1.2.2.3.2.3.2">𝑖</ci><cn type="integer" id="S2.E1.m1.2.2.1.1.2.2.3.2.3.3.cmml" xref="S2.E1.m1.2.2.1.1.2.2.3.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.2.2.1.1.2.2.3.3.cmml" xref="S2.E1.m1.2.2.1.1.2.2.3.3">𝑁</ci></apply><apply id="S2.E1.m1.2.2.1.1.2.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2"><times id="S2.E1.m1.2.2.1.1.2.2.2.3.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.3"></times><ci id="S2.E1.m1.2.2.1.1.2.2.2.4.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.4">𝒟</ci><interval closure="open" id="S2.E1.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2"><apply id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1"><times id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.2"></times><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.3">𝑓</ci><list id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1"><apply id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">𝐗</ci><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝜃</ci></list></apply><apply id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2"><times id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.3"></times><ci id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.4.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.4">𝑓</ci><list id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2"><apply id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.1.1.1.2">𝐗</ci><ci id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.1.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.1.1.1.3">𝑖</ci></apply><apply id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2">𝜃</ci><ci id="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.3">𝑖</ci></apply></list></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.2c">{\mathbf{\theta}}_{G}^{*}=\arg\min_{{\mathbf{\theta}}}\frac{1}{N}\sum_{i=1}^{N}\mathcal{D}\left(f(\mathbf{X}_{i};{\mathbf{\theta}}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i})\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS1.p3" class="ltx_para ltx_noindent">
<p id="S2.SS1.p3.1" class="ltx_p">We depict this idealized objective in <a href="#S1.F1" title="In Contributions. ‣ 1 Introduction ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">1</span></a>, where two client functions are learned on different supports (left) and we wish to aggregate them into a model that preserves both functional relationships (right), which direct parameter averaging cannot achieve (center).</p>
</div>
<div id="S2.SS1.p4" class="ltx_para ltx_noindent">
<p id="S2.SS1.p4.1" class="ltx_p">The objective in <a href="#S2.E1" title="In 2.1 Problem Setting ‣ 2 Federated Learning in the Function Space ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">1</span></a> depends on function outputs, which in turn rely on client-specific inputs <math id="S2.SS1.p4.1.m1.1" class="ltx_Math" alttext="\mathbf{X}_{i}" display="inline"><semantics id="S2.SS1.p4.1.m1.1a"><msub id="S2.SS1.p4.1.m1.1.1" xref="S2.SS1.p4.1.m1.1.1.cmml"><mi id="S2.SS1.p4.1.m1.1.1.2" xref="S2.SS1.p4.1.m1.1.1.2.cmml">𝐗</mi><mi id="S2.SS1.p4.1.m1.1.1.3" xref="S2.SS1.p4.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.1.m1.1b"><apply id="S2.SS1.p4.1.m1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p4.1.m1.1.1.2.cmml" xref="S2.SS1.p4.1.m1.1.1.2">𝐗</ci><ci id="S2.SS1.p4.1.m1.1.1.3.cmml" xref="S2.SS1.p4.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.1.m1.1c">\mathbf{X}_{i}</annotation></semantics></math>. Exactly implementing this would require global access to the local client data, which violates a fundamental constraint in federated learning. This necessitates a parametric approximation to the function space distance such that it may be estimated without actual data points.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Approximating Function Space Distance</h3>

<div id="S2.SS2.p1" class="ltx_para ltx_noindent">
<p id="S2.SS2.p1.2" class="ltx_p">The function space distance can be estimated with a second-order Taylor approximation with respect to model parameters <math id="S2.SS2.p1.1.m1.1" class="ltx_Math" alttext="{\mathbf{\theta}}" display="inline"><semantics id="S2.SS2.p1.1.m1.1a"><mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">{\mathbf{\theta}}</annotation></semantics></math>, centered at <math id="S2.SS2.p1.2.m2.1" class="ltx_Math" alttext="{\mathbf{\theta}}_{i}" display="inline"><semantics id="S2.SS2.p1.2.m2.1a"><msub id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml"><mi id="S2.SS2.p1.2.m2.1.1.2" xref="S2.SS2.p1.2.m2.1.1.2.cmml">θ</mi><mi id="S2.SS2.p1.2.m2.1.1.3" xref="S2.SS2.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><apply id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p1.2.m2.1.1.2.cmml" xref="S2.SS2.p1.2.m2.1.1.2">𝜃</ci><ci id="S2.SS2.p1.2.m2.1.1.3.cmml" xref="S2.SS2.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">{\mathbf{\theta}}_{i}</annotation></semantics></math>, the client network whose outputs are to be matched.
This is useful in a federated context because appropriate approximations to this estimate lead to a parametric method which does not directly depend on client data.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para ltx_noindent">
<p id="S2.SS2.p2.1" class="ltx_p">Setting <math id="S2.SS2.p2.1.m1.2" class="ltx_Math" alttext="\mathcal{D}\left(\cdot,\cdot\right)" display="inline"><semantics id="S2.SS2.p2.1.m1.2a"><mrow id="S2.SS2.p2.1.m1.2.3" xref="S2.SS2.p2.1.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p2.1.m1.2.3.2" xref="S2.SS2.p2.1.m1.2.3.2.cmml">𝒟</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.1.m1.2.3.1" xref="S2.SS2.p2.1.m1.2.3.1.cmml">​</mo><mrow id="S2.SS2.p2.1.m1.2.3.3.2" xref="S2.SS2.p2.1.m1.2.3.3.1.cmml"><mo id="S2.SS2.p2.1.m1.2.3.3.2.1" xref="S2.SS2.p2.1.m1.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">⋅</mo><mo rspace="0em" id="S2.SS2.p2.1.m1.2.3.3.2.2" xref="S2.SS2.p2.1.m1.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p2.1.m1.2.2" xref="S2.SS2.p2.1.m1.2.2.cmml">⋅</mo><mo id="S2.SS2.p2.1.m1.2.3.3.2.3" xref="S2.SS2.p2.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.2b"><apply id="S2.SS2.p2.1.m1.2.3.cmml" xref="S2.SS2.p2.1.m1.2.3"><times id="S2.SS2.p2.1.m1.2.3.1.cmml" xref="S2.SS2.p2.1.m1.2.3.1"></times><ci id="S2.SS2.p2.1.m1.2.3.2.cmml" xref="S2.SS2.p2.1.m1.2.3.2">𝒟</ci><interval closure="open" id="S2.SS2.p2.1.m1.2.3.3.1.cmml" xref="S2.SS2.p2.1.m1.2.3.3.2"><ci id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">⋅</ci><ci id="S2.SS2.p2.1.m1.2.2.cmml" xref="S2.SS2.p2.1.m1.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.2c">\mathcal{D}\left(\cdot,\cdot\right)</annotation></semantics></math> to be the Kullback-Leibler (KL) divergence between softmax outputs of the networks,</p>
<table id="A1.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E2.m1.3" class="ltx_Math" alttext="\displaystyle\mathcal{D}(f(\mathbf{X}_{i};{\mathbf{\theta}}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i}))" display="inline"><semantics id="S2.E2.m1.3a"><mrow id="S2.E2.m1.3.3" xref="S2.E2.m1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.3.3.4" xref="S2.E2.m1.3.3.4.cmml">𝒟</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.3" xref="S2.E2.m1.3.3.3.cmml">​</mo><mrow id="S2.E2.m1.3.3.2.2" xref="S2.E2.m1.3.3.2.3.cmml"><mo stretchy="false" id="S2.E2.m1.3.3.2.2.3" xref="S2.E2.m1.3.3.2.3.cmml">(</mo><mrow id="S2.E2.m1.2.2.1.1.1" xref="S2.E2.m1.2.2.1.1.1.cmml"><mi id="S2.E2.m1.2.2.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.2.2.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.2.2.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E2.m1.2.2.1.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.2.cmml">(</mo><msub id="S2.E2.m1.2.2.1.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.cmml">𝐗</mi><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E2.m1.2.2.1.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.1.2.cmml">;</mo><mi id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S2.E2.m1.2.2.1.1.1.1.1.4" xref="S2.E2.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.3.3.2.2.4" xref="S2.E2.m1.3.3.2.3.cmml">,</mo><mrow id="S2.E2.m1.3.3.2.2.2" xref="S2.E2.m1.3.3.2.2.2.cmml"><mi id="S2.E2.m1.3.3.2.2.2.4" xref="S2.E2.m1.3.3.2.2.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.2.2.2.3" xref="S2.E2.m1.3.3.2.2.2.3.cmml">​</mo><mrow id="S2.E2.m1.3.3.2.2.2.2.2" xref="S2.E2.m1.3.3.2.2.2.2.3.cmml"><mo stretchy="false" id="S2.E2.m1.3.3.2.2.2.2.2.3" xref="S2.E2.m1.3.3.2.2.2.2.3.cmml">(</mo><msub id="S2.E2.m1.3.3.2.2.2.1.1.1" xref="S2.E2.m1.3.3.2.2.2.1.1.1.cmml"><mi id="S2.E2.m1.3.3.2.2.2.1.1.1.2" xref="S2.E2.m1.3.3.2.2.2.1.1.1.2.cmml">𝐗</mi><mi id="S2.E2.m1.3.3.2.2.2.1.1.1.3" xref="S2.E2.m1.3.3.2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S2.E2.m1.3.3.2.2.2.2.2.4" xref="S2.E2.m1.3.3.2.2.2.2.3.cmml">;</mo><msub id="S2.E2.m1.3.3.2.2.2.2.2.2" xref="S2.E2.m1.3.3.2.2.2.2.2.2.cmml"><mi id="S2.E2.m1.3.3.2.2.2.2.2.2.2" xref="S2.E2.m1.3.3.2.2.2.2.2.2.2.cmml">θ</mi><mi id="S2.E2.m1.3.3.2.2.2.2.2.2.3" xref="S2.E2.m1.3.3.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S2.E2.m1.3.3.2.2.2.2.2.5" xref="S2.E2.m1.3.3.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E2.m1.3.3.2.2.5" xref="S2.E2.m1.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.3b"><apply id="S2.E2.m1.3.3.cmml" xref="S2.E2.m1.3.3"><times id="S2.E2.m1.3.3.3.cmml" xref="S2.E2.m1.3.3.3"></times><ci id="S2.E2.m1.3.3.4.cmml" xref="S2.E2.m1.3.3.4">𝒟</ci><interval closure="open" id="S2.E2.m1.3.3.2.3.cmml" xref="S2.E2.m1.3.3.2.2"><apply id="S2.E2.m1.2.2.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1"><times id="S2.E2.m1.2.2.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.2"></times><ci id="S2.E2.m1.2.2.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.3">𝑓</ci><list id="S2.E2.m1.2.2.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1"><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2">𝐗</ci><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1">𝜃</ci></list></apply><apply id="S2.E2.m1.3.3.2.2.2.cmml" xref="S2.E2.m1.3.3.2.2.2"><times id="S2.E2.m1.3.3.2.2.2.3.cmml" xref="S2.E2.m1.3.3.2.2.2.3"></times><ci id="S2.E2.m1.3.3.2.2.2.4.cmml" xref="S2.E2.m1.3.3.2.2.2.4">𝑓</ci><list id="S2.E2.m1.3.3.2.2.2.2.3.cmml" xref="S2.E2.m1.3.3.2.2.2.2.2"><apply id="S2.E2.m1.3.3.2.2.2.1.1.1.cmml" xref="S2.E2.m1.3.3.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.2.2.2.1.1.1.1.cmml" xref="S2.E2.m1.3.3.2.2.2.1.1.1">subscript</csymbol><ci id="S2.E2.m1.3.3.2.2.2.1.1.1.2.cmml" xref="S2.E2.m1.3.3.2.2.2.1.1.1.2">𝐗</ci><ci id="S2.E2.m1.3.3.2.2.2.1.1.1.3.cmml" xref="S2.E2.m1.3.3.2.2.2.1.1.1.3">𝑖</ci></apply><apply id="S2.E2.m1.3.3.2.2.2.2.2.2.cmml" xref="S2.E2.m1.3.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.2.2.2.2.2.2.1.cmml" xref="S2.E2.m1.3.3.2.2.2.2.2.2">subscript</csymbol><ci id="S2.E2.m1.3.3.2.2.2.2.2.2.2.cmml" xref="S2.E2.m1.3.3.2.2.2.2.2.2.2">𝜃</ci><ci id="S2.E2.m1.3.3.2.2.2.2.2.2.3.cmml" xref="S2.E2.m1.3.3.2.2.2.2.2.2.3">𝑖</ci></apply></list></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.3c">\displaystyle\mathcal{D}(f(\mathbf{X}_{i};{\mathbf{\theta}}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i}))</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E2.m2.2" class="ltx_Math" alttext="\displaystyle\approx\frac{1}{2}({\mathbf{\theta}}-{\mathbf{\theta}}_{i})^{T}F_{i}({\mathbf{\theta}}-{\mathbf{\theta}}_{i})" display="inline"><semantics id="S2.E2.m2.2a"><mrow id="S2.E2.m2.2.2" xref="S2.E2.m2.2.2.cmml"><mi id="S2.E2.m2.2.2.4" xref="S2.E2.m2.2.2.4.cmml"></mi><mo id="S2.E2.m2.2.2.3" xref="S2.E2.m2.2.2.3.cmml">≈</mo><mrow id="S2.E2.m2.2.2.2" xref="S2.E2.m2.2.2.2.cmml"><mstyle displaystyle="true" id="S2.E2.m2.2.2.2.4" xref="S2.E2.m2.2.2.2.4.cmml"><mfrac id="S2.E2.m2.2.2.2.4a" xref="S2.E2.m2.2.2.2.4.cmml"><mn id="S2.E2.m2.2.2.2.4.2" xref="S2.E2.m2.2.2.2.4.2.cmml">1</mn><mn id="S2.E2.m2.2.2.2.4.3" xref="S2.E2.m2.2.2.2.4.3.cmml">2</mn></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S2.E2.m2.2.2.2.3" xref="S2.E2.m2.2.2.2.3.cmml">​</mo><msup id="S2.E2.m2.1.1.1.1" xref="S2.E2.m2.1.1.1.1.cmml"><mrow id="S2.E2.m2.1.1.1.1.1.1" xref="S2.E2.m2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m2.1.1.1.1.1.1.2" xref="S2.E2.m2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m2.1.1.1.1.1.1.1" xref="S2.E2.m2.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m2.1.1.1.1.1.1.1.2" xref="S2.E2.m2.1.1.1.1.1.1.1.2.cmml">θ</mi><mo id="S2.E2.m2.1.1.1.1.1.1.1.1" xref="S2.E2.m2.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S2.E2.m2.1.1.1.1.1.1.1.3" xref="S2.E2.m2.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m2.1.1.1.1.1.1.1.3.2" xref="S2.E2.m2.1.1.1.1.1.1.1.3.2.cmml">θ</mi><mi id="S2.E2.m2.1.1.1.1.1.1.1.3.3" xref="S2.E2.m2.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S2.E2.m2.1.1.1.1.1.1.3" xref="S2.E2.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S2.E2.m2.1.1.1.1.3" xref="S2.E2.m2.1.1.1.1.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S2.E2.m2.2.2.2.3a" xref="S2.E2.m2.2.2.2.3.cmml">​</mo><msub id="S2.E2.m2.2.2.2.5" xref="S2.E2.m2.2.2.2.5.cmml"><mi id="S2.E2.m2.2.2.2.5.2" xref="S2.E2.m2.2.2.2.5.2.cmml">F</mi><mi id="S2.E2.m2.2.2.2.5.3" xref="S2.E2.m2.2.2.2.5.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2.m2.2.2.2.3b" xref="S2.E2.m2.2.2.2.3.cmml">​</mo><mrow id="S2.E2.m2.2.2.2.2.1" xref="S2.E2.m2.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S2.E2.m2.2.2.2.2.1.2" xref="S2.E2.m2.2.2.2.2.1.1.cmml">(</mo><mrow id="S2.E2.m2.2.2.2.2.1.1" xref="S2.E2.m2.2.2.2.2.1.1.cmml"><mi id="S2.E2.m2.2.2.2.2.1.1.2" xref="S2.E2.m2.2.2.2.2.1.1.2.cmml">θ</mi><mo id="S2.E2.m2.2.2.2.2.1.1.1" xref="S2.E2.m2.2.2.2.2.1.1.1.cmml">−</mo><msub id="S2.E2.m2.2.2.2.2.1.1.3" xref="S2.E2.m2.2.2.2.2.1.1.3.cmml"><mi id="S2.E2.m2.2.2.2.2.1.1.3.2" xref="S2.E2.m2.2.2.2.2.1.1.3.2.cmml">θ</mi><mi id="S2.E2.m2.2.2.2.2.1.1.3.3" xref="S2.E2.m2.2.2.2.2.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S2.E2.m2.2.2.2.2.1.3" xref="S2.E2.m2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m2.2b"><apply id="S2.E2.m2.2.2.cmml" xref="S2.E2.m2.2.2"><approx id="S2.E2.m2.2.2.3.cmml" xref="S2.E2.m2.2.2.3"></approx><csymbol cd="latexml" id="S2.E2.m2.2.2.4.cmml" xref="S2.E2.m2.2.2.4">absent</csymbol><apply id="S2.E2.m2.2.2.2.cmml" xref="S2.E2.m2.2.2.2"><times id="S2.E2.m2.2.2.2.3.cmml" xref="S2.E2.m2.2.2.2.3"></times><apply id="S2.E2.m2.2.2.2.4.cmml" xref="S2.E2.m2.2.2.2.4"><divide id="S2.E2.m2.2.2.2.4.1.cmml" xref="S2.E2.m2.2.2.2.4"></divide><cn type="integer" id="S2.E2.m2.2.2.2.4.2.cmml" xref="S2.E2.m2.2.2.2.4.2">1</cn><cn type="integer" id="S2.E2.m2.2.2.2.4.3.cmml" xref="S2.E2.m2.2.2.2.4.3">2</cn></apply><apply id="S2.E2.m2.1.1.1.1.cmml" xref="S2.E2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m2.1.1.1.1.2.cmml" xref="S2.E2.m2.1.1.1.1">superscript</csymbol><apply id="S2.E2.m2.1.1.1.1.1.1.1.cmml" xref="S2.E2.m2.1.1.1.1.1.1"><minus id="S2.E2.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m2.1.1.1.1.1.1.1.1"></minus><ci id="S2.E2.m2.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m2.1.1.1.1.1.1.1.2">𝜃</ci><apply id="S2.E2.m2.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m2.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m2.1.1.1.1.1.1.1.3.2">𝜃</ci><ci id="S2.E2.m2.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m2.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><ci id="S2.E2.m2.1.1.1.1.3.cmml" xref="S2.E2.m2.1.1.1.1.3">𝑇</ci></apply><apply id="S2.E2.m2.2.2.2.5.cmml" xref="S2.E2.m2.2.2.2.5"><csymbol cd="ambiguous" id="S2.E2.m2.2.2.2.5.1.cmml" xref="S2.E2.m2.2.2.2.5">subscript</csymbol><ci id="S2.E2.m2.2.2.2.5.2.cmml" xref="S2.E2.m2.2.2.2.5.2">𝐹</ci><ci id="S2.E2.m2.2.2.2.5.3.cmml" xref="S2.E2.m2.2.2.2.5.3">𝑖</ci></apply><apply id="S2.E2.m2.2.2.2.2.1.1.cmml" xref="S2.E2.m2.2.2.2.2.1"><minus id="S2.E2.m2.2.2.2.2.1.1.1.cmml" xref="S2.E2.m2.2.2.2.2.1.1.1"></minus><ci id="S2.E2.m2.2.2.2.2.1.1.2.cmml" xref="S2.E2.m2.2.2.2.2.1.1.2">𝜃</ci><apply id="S2.E2.m2.2.2.2.2.1.1.3.cmml" xref="S2.E2.m2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m2.2.2.2.2.1.1.3.1.cmml" xref="S2.E2.m2.2.2.2.2.1.1.3">subscript</csymbol><ci id="S2.E2.m2.2.2.2.2.1.1.3.2.cmml" xref="S2.E2.m2.2.2.2.2.1.1.3.2">𝜃</ci><ci id="S2.E2.m2.2.2.2.2.1.1.3.3.cmml" xref="S2.E2.m2.2.2.2.2.1.1.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m2.2c">\displaystyle\approx\frac{1}{2}({\mathbf{\theta}}-{\mathbf{\theta}}_{i})^{T}F_{i}({\mathbf{\theta}}-{\mathbf{\theta}}_{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E3.m2.5" class="ltx_Math" alttext="\displaystyle\approx\frac{1}{2}\sum_{j=1}^{|{\mathbf{\theta}}_{i}|}F_{i}^{(j)}({\mathbf{\theta}}^{(j)}-{\mathbf{\theta}}_{i}^{(j)})^{2}," display="inline"><semantics id="S2.E3.m2.5a"><mrow id="S2.E3.m2.5.5.1" xref="S2.E3.m2.5.5.1.1.cmml"><mrow id="S2.E3.m2.5.5.1.1" xref="S2.E3.m2.5.5.1.1.cmml"><mi id="S2.E3.m2.5.5.1.1.3" xref="S2.E3.m2.5.5.1.1.3.cmml"></mi><mo id="S2.E3.m2.5.5.1.1.2" xref="S2.E3.m2.5.5.1.1.2.cmml">≈</mo><mrow id="S2.E3.m2.5.5.1.1.1" xref="S2.E3.m2.5.5.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E3.m2.5.5.1.1.1.3" xref="S2.E3.m2.5.5.1.1.1.3.cmml"><mfrac id="S2.E3.m2.5.5.1.1.1.3a" xref="S2.E3.m2.5.5.1.1.1.3.cmml"><mn id="S2.E3.m2.5.5.1.1.1.3.2" xref="S2.E3.m2.5.5.1.1.1.3.2.cmml">1</mn><mn id="S2.E3.m2.5.5.1.1.1.3.3" xref="S2.E3.m2.5.5.1.1.1.3.3.cmml">2</mn></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S2.E3.m2.5.5.1.1.1.2" xref="S2.E3.m2.5.5.1.1.1.2.cmml">​</mo><mrow id="S2.E3.m2.5.5.1.1.1.1" xref="S2.E3.m2.5.5.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E3.m2.5.5.1.1.1.1.2" xref="S2.E3.m2.5.5.1.1.1.1.2.cmml"><munderover id="S2.E3.m2.5.5.1.1.1.1.2a" xref="S2.E3.m2.5.5.1.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E3.m2.5.5.1.1.1.1.2.2.2" xref="S2.E3.m2.5.5.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E3.m2.5.5.1.1.1.1.2.2.3" xref="S2.E3.m2.5.5.1.1.1.1.2.2.3.cmml"><mi id="S2.E3.m2.5.5.1.1.1.1.2.2.3.2" xref="S2.E3.m2.5.5.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="S2.E3.m2.5.5.1.1.1.1.2.2.3.1" xref="S2.E3.m2.5.5.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E3.m2.5.5.1.1.1.1.2.2.3.3" xref="S2.E3.m2.5.5.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S2.E3.m2.1.1.1.1" xref="S2.E3.m2.1.1.1.2.cmml"><mo stretchy="false" id="S2.E3.m2.1.1.1.1.2" xref="S2.E3.m2.1.1.1.2.1.cmml">|</mo><msub id="S2.E3.m2.1.1.1.1.1" xref="S2.E3.m2.1.1.1.1.1.cmml"><mi id="S2.E3.m2.1.1.1.1.1.2" xref="S2.E3.m2.1.1.1.1.1.2.cmml">θ</mi><mi id="S2.E3.m2.1.1.1.1.1.3" xref="S2.E3.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.E3.m2.1.1.1.1.3" xref="S2.E3.m2.1.1.1.2.1.cmml">|</mo></mrow></munderover></mstyle><mrow id="S2.E3.m2.5.5.1.1.1.1.1" xref="S2.E3.m2.5.5.1.1.1.1.1.cmml"><msubsup id="S2.E3.m2.5.5.1.1.1.1.1.3" xref="S2.E3.m2.5.5.1.1.1.1.1.3.cmml"><mi id="S2.E3.m2.5.5.1.1.1.1.1.3.2.2" xref="S2.E3.m2.5.5.1.1.1.1.1.3.2.2.cmml">F</mi><mi id="S2.E3.m2.5.5.1.1.1.1.1.3.2.3" xref="S2.E3.m2.5.5.1.1.1.1.1.3.2.3.cmml">i</mi><mrow id="S2.E3.m2.2.2.1.3" xref="S2.E3.m2.5.5.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S2.E3.m2.2.2.1.3.1" xref="S2.E3.m2.5.5.1.1.1.1.1.3.cmml">(</mo><mi id="S2.E3.m2.2.2.1.1" xref="S2.E3.m2.2.2.1.1.cmml">j</mi><mo stretchy="false" id="S2.E3.m2.2.2.1.3.2" xref="S2.E3.m2.5.5.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S2.E3.m2.5.5.1.1.1.1.1.2" xref="S2.E3.m2.5.5.1.1.1.1.1.2.cmml">​</mo><msup id="S2.E3.m2.5.5.1.1.1.1.1.1" xref="S2.E3.m2.5.5.1.1.1.1.1.1.cmml"><mrow id="S2.E3.m2.5.5.1.1.1.1.1.1.1.1" xref="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.2" xref="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1" xref="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.cmml"><msup id="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml">θ</mi><mrow id="S2.E3.m2.3.3.1.3" xref="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E3.m2.3.3.1.3.1" xref="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E3.m2.3.3.1.1" xref="S2.E3.m2.3.3.1.1.cmml">j</mi><mo stretchy="false" id="S2.E3.m2.3.3.1.3.2" xref="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></msup><mo id="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.2.cmml">θ</mi><mi id="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mrow id="S2.E3.m2.4.4.1.3" xref="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S2.E3.m2.4.4.1.3.1" xref="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S2.E3.m2.4.4.1.1" xref="S2.E3.m2.4.4.1.1.cmml">j</mi><mo stretchy="false" id="S2.E3.m2.4.4.1.3.2" xref="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo stretchy="false" id="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.3" xref="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S2.E3.m2.5.5.1.1.1.1.1.1.3" xref="S2.E3.m2.5.5.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow></mrow><mo id="S2.E3.m2.5.5.1.2" xref="S2.E3.m2.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m2.5b"><apply id="S2.E3.m2.5.5.1.1.cmml" xref="S2.E3.m2.5.5.1"><approx id="S2.E3.m2.5.5.1.1.2.cmml" xref="S2.E3.m2.5.5.1.1.2"></approx><csymbol cd="latexml" id="S2.E3.m2.5.5.1.1.3.cmml" xref="S2.E3.m2.5.5.1.1.3">absent</csymbol><apply id="S2.E3.m2.5.5.1.1.1.cmml" xref="S2.E3.m2.5.5.1.1.1"><times id="S2.E3.m2.5.5.1.1.1.2.cmml" xref="S2.E3.m2.5.5.1.1.1.2"></times><apply id="S2.E3.m2.5.5.1.1.1.3.cmml" xref="S2.E3.m2.5.5.1.1.1.3"><divide id="S2.E3.m2.5.5.1.1.1.3.1.cmml" xref="S2.E3.m2.5.5.1.1.1.3"></divide><cn type="integer" id="S2.E3.m2.5.5.1.1.1.3.2.cmml" xref="S2.E3.m2.5.5.1.1.1.3.2">1</cn><cn type="integer" id="S2.E3.m2.5.5.1.1.1.3.3.cmml" xref="S2.E3.m2.5.5.1.1.1.3.3">2</cn></apply><apply id="S2.E3.m2.5.5.1.1.1.1.cmml" xref="S2.E3.m2.5.5.1.1.1.1"><apply id="S2.E3.m2.5.5.1.1.1.1.2.cmml" xref="S2.E3.m2.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m2.5.5.1.1.1.1.2.1.cmml" xref="S2.E3.m2.5.5.1.1.1.1.2">superscript</csymbol><apply id="S2.E3.m2.5.5.1.1.1.1.2.2.cmml" xref="S2.E3.m2.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m2.5.5.1.1.1.1.2.2.1.cmml" xref="S2.E3.m2.5.5.1.1.1.1.2">subscript</csymbol><sum id="S2.E3.m2.5.5.1.1.1.1.2.2.2.cmml" xref="S2.E3.m2.5.5.1.1.1.1.2.2.2"></sum><apply id="S2.E3.m2.5.5.1.1.1.1.2.2.3.cmml" xref="S2.E3.m2.5.5.1.1.1.1.2.2.3"><eq id="S2.E3.m2.5.5.1.1.1.1.2.2.3.1.cmml" xref="S2.E3.m2.5.5.1.1.1.1.2.2.3.1"></eq><ci id="S2.E3.m2.5.5.1.1.1.1.2.2.3.2.cmml" xref="S2.E3.m2.5.5.1.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S2.E3.m2.5.5.1.1.1.1.2.2.3.3.cmml" xref="S2.E3.m2.5.5.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S2.E3.m2.1.1.1.2.cmml" xref="S2.E3.m2.1.1.1.1"><abs id="S2.E3.m2.1.1.1.2.1.cmml" xref="S2.E3.m2.1.1.1.1.2"></abs><apply id="S2.E3.m2.1.1.1.1.1.cmml" xref="S2.E3.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m2.1.1.1.1.1.1.cmml" xref="S2.E3.m2.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m2.1.1.1.1.1.2.cmml" xref="S2.E3.m2.1.1.1.1.1.2">𝜃</ci><ci id="S2.E3.m2.1.1.1.1.1.3.cmml" xref="S2.E3.m2.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S2.E3.m2.5.5.1.1.1.1.1.cmml" xref="S2.E3.m2.5.5.1.1.1.1.1"><times id="S2.E3.m2.5.5.1.1.1.1.1.2.cmml" xref="S2.E3.m2.5.5.1.1.1.1.1.2"></times><apply id="S2.E3.m2.5.5.1.1.1.1.1.3.cmml" xref="S2.E3.m2.5.5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m2.5.5.1.1.1.1.1.3.1.cmml" xref="S2.E3.m2.5.5.1.1.1.1.1.3">superscript</csymbol><apply id="S2.E3.m2.5.5.1.1.1.1.1.3.2.cmml" xref="S2.E3.m2.5.5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m2.5.5.1.1.1.1.1.3.2.1.cmml" xref="S2.E3.m2.5.5.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m2.5.5.1.1.1.1.1.3.2.2.cmml" xref="S2.E3.m2.5.5.1.1.1.1.1.3.2.2">𝐹</ci><ci id="S2.E3.m2.5.5.1.1.1.1.1.3.2.3.cmml" xref="S2.E3.m2.5.5.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S2.E3.m2.2.2.1.1.cmml" xref="S2.E3.m2.2.2.1.1">𝑗</ci></apply><apply id="S2.E3.m2.5.5.1.1.1.1.1.1.cmml" xref="S2.E3.m2.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m2.5.5.1.1.1.1.1.1.2.cmml" xref="S2.E3.m2.5.5.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m2.5.5.1.1.1.1.1.1.1.1"><minus id="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.2.2">𝜃</ci><ci id="S2.E3.m2.3.3.1.1.cmml" xref="S2.E3.m2.3.3.1.1">𝑗</ci></apply><apply id="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.2">𝜃</ci><ci id="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E3.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S2.E3.m2.4.4.1.1.cmml" xref="S2.E3.m2.4.4.1.1">𝑗</ci></apply></apply><cn type="integer" id="S2.E3.m2.5.5.1.1.1.1.1.1.3.cmml" xref="S2.E3.m2.5.5.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m2.5c">\displaystyle\approx\frac{1}{2}\sum_{j=1}^{|{\mathbf{\theta}}_{i}|}F_{i}^{(j)}({\mathbf{\theta}}^{(j)}-{\mathbf{\theta}}_{i}^{(j)})^{2},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p2.6" class="ltx_p">where <math id="S2.SS2.p2.2.m1.1" class="ltx_Math" alttext="F_{i}" display="inline"><semantics id="S2.SS2.p2.2.m1.1a"><msub id="S2.SS2.p2.2.m1.1.1" xref="S2.SS2.p2.2.m1.1.1.cmml"><mi id="S2.SS2.p2.2.m1.1.1.2" xref="S2.SS2.p2.2.m1.1.1.2.cmml">F</mi><mi id="S2.SS2.p2.2.m1.1.1.3" xref="S2.SS2.p2.2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m1.1b"><apply id="S2.SS2.p2.2.m1.1.1.cmml" xref="S2.SS2.p2.2.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m1.1.1.1.cmml" xref="S2.SS2.p2.2.m1.1.1">subscript</csymbol><ci id="S2.SS2.p2.2.m1.1.1.2.cmml" xref="S2.SS2.p2.2.m1.1.1.2">𝐹</ci><ci id="S2.SS2.p2.2.m1.1.1.3.cmml" xref="S2.SS2.p2.2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m1.1c">F_{i}</annotation></semantics></math> is the Fisher Information matrix corresponding to <math id="S2.SS2.p2.3.m2.1" class="ltx_Math" alttext="{\mathbf{\theta}}_{i}" display="inline"><semantics id="S2.SS2.p2.3.m2.1a"><msub id="S2.SS2.p2.3.m2.1.1" xref="S2.SS2.p2.3.m2.1.1.cmml"><mi id="S2.SS2.p2.3.m2.1.1.2" xref="S2.SS2.p2.3.m2.1.1.2.cmml">θ</mi><mi id="S2.SS2.p2.3.m2.1.1.3" xref="S2.SS2.p2.3.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m2.1b"><apply id="S2.SS2.p2.3.m2.1.1.cmml" xref="S2.SS2.p2.3.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m2.1.1.1.cmml" xref="S2.SS2.p2.3.m2.1.1">subscript</csymbol><ci id="S2.SS2.p2.3.m2.1.1.2.cmml" xref="S2.SS2.p2.3.m2.1.1.2">𝜃</ci><ci id="S2.SS2.p2.3.m2.1.1.3.cmml" xref="S2.SS2.p2.3.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m2.1c">{\mathbf{\theta}}_{i}</annotation></semantics></math>. In <a href="#S2.E2" title="In 2.2 Approximating Function Space Distance ‣ 2 Federated Learning in the Function Space ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">2</span></a>, the zero-th and first order terms vanish because <math id="S2.SS2.p2.4.m3.2" class="ltx_Math" alttext="\mathcal{D}\left(\cdot,\cdot\right)" display="inline"><semantics id="S2.SS2.p2.4.m3.2a"><mrow id="S2.SS2.p2.4.m3.2.3" xref="S2.SS2.p2.4.m3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p2.4.m3.2.3.2" xref="S2.SS2.p2.4.m3.2.3.2.cmml">𝒟</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.4.m3.2.3.1" xref="S2.SS2.p2.4.m3.2.3.1.cmml">​</mo><mrow id="S2.SS2.p2.4.m3.2.3.3.2" xref="S2.SS2.p2.4.m3.2.3.3.1.cmml"><mo id="S2.SS2.p2.4.m3.2.3.3.2.1" xref="S2.SS2.p2.4.m3.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p2.4.m3.1.1" xref="S2.SS2.p2.4.m3.1.1.cmml">⋅</mo><mo rspace="0em" id="S2.SS2.p2.4.m3.2.3.3.2.2" xref="S2.SS2.p2.4.m3.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p2.4.m3.2.2" xref="S2.SS2.p2.4.m3.2.2.cmml">⋅</mo><mo id="S2.SS2.p2.4.m3.2.3.3.2.3" xref="S2.SS2.p2.4.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m3.2b"><apply id="S2.SS2.p2.4.m3.2.3.cmml" xref="S2.SS2.p2.4.m3.2.3"><times id="S2.SS2.p2.4.m3.2.3.1.cmml" xref="S2.SS2.p2.4.m3.2.3.1"></times><ci id="S2.SS2.p2.4.m3.2.3.2.cmml" xref="S2.SS2.p2.4.m3.2.3.2">𝒟</ci><interval closure="open" id="S2.SS2.p2.4.m3.2.3.3.1.cmml" xref="S2.SS2.p2.4.m3.2.3.3.2"><ci id="S2.SS2.p2.4.m3.1.1.cmml" xref="S2.SS2.p2.4.m3.1.1">⋅</ci><ci id="S2.SS2.p2.4.m3.2.2.cmml" xref="S2.SS2.p2.4.m3.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m3.2c">\mathcal{D}\left(\cdot,\cdot\right)</annotation></semantics></math> is a non-negative function that evaluates to zero when its arguments are equal. Hence, its value and gradient both vanish at <math id="S2.SS2.p2.5.m4.1" class="ltx_Math" alttext="{\mathbf{\theta}}={\mathbf{\theta}}_{i}" display="inline"><semantics id="S2.SS2.p2.5.m4.1a"><mrow id="S2.SS2.p2.5.m4.1.1" xref="S2.SS2.p2.5.m4.1.1.cmml"><mi id="S2.SS2.p2.5.m4.1.1.2" xref="S2.SS2.p2.5.m4.1.1.2.cmml">θ</mi><mo id="S2.SS2.p2.5.m4.1.1.1" xref="S2.SS2.p2.5.m4.1.1.1.cmml">=</mo><msub id="S2.SS2.p2.5.m4.1.1.3" xref="S2.SS2.p2.5.m4.1.1.3.cmml"><mi id="S2.SS2.p2.5.m4.1.1.3.2" xref="S2.SS2.p2.5.m4.1.1.3.2.cmml">θ</mi><mi id="S2.SS2.p2.5.m4.1.1.3.3" xref="S2.SS2.p2.5.m4.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m4.1b"><apply id="S2.SS2.p2.5.m4.1.1.cmml" xref="S2.SS2.p2.5.m4.1.1"><eq id="S2.SS2.p2.5.m4.1.1.1.cmml" xref="S2.SS2.p2.5.m4.1.1.1"></eq><ci id="S2.SS2.p2.5.m4.1.1.2.cmml" xref="S2.SS2.p2.5.m4.1.1.2">𝜃</ci><apply id="S2.SS2.p2.5.m4.1.1.3.cmml" xref="S2.SS2.p2.5.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.5.m4.1.1.3.1.cmml" xref="S2.SS2.p2.5.m4.1.1.3">subscript</csymbol><ci id="S2.SS2.p2.5.m4.1.1.3.2.cmml" xref="S2.SS2.p2.5.m4.1.1.3.2">𝜃</ci><ci id="S2.SS2.p2.5.m4.1.1.3.3.cmml" xref="S2.SS2.p2.5.m4.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m4.1c">{\mathbf{\theta}}={\mathbf{\theta}}_{i}</annotation></semantics></math>, leaving only the second order term. Note that this approximation does not require <math id="S2.SS2.p2.6.m5.1" class="ltx_Math" alttext="{\mathbf{\theta}}_{i}" display="inline"><semantics id="S2.SS2.p2.6.m5.1a"><msub id="S2.SS2.p2.6.m5.1.1" xref="S2.SS2.p2.6.m5.1.1.cmml"><mi id="S2.SS2.p2.6.m5.1.1.2" xref="S2.SS2.p2.6.m5.1.1.2.cmml">θ</mi><mi id="S2.SS2.p2.6.m5.1.1.3" xref="S2.SS2.p2.6.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m5.1b"><apply id="S2.SS2.p2.6.m5.1.1.cmml" xref="S2.SS2.p2.6.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.6.m5.1.1.1.cmml" xref="S2.SS2.p2.6.m5.1.1">subscript</csymbol><ci id="S2.SS2.p2.6.m5.1.1.2.cmml" xref="S2.SS2.p2.6.m5.1.1.2">𝜃</ci><ci id="S2.SS2.p2.6.m5.1.1.3.cmml" xref="S2.SS2.p2.6.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m5.1c">{\mathbf{\theta}}_{i}</annotation></semantics></math> to be optimal and can be used at intermediate stages of training in multi-round FL.
We defer complete details of this derivation to <a href="#A1.SS2" title="A.2 FedFish Derivation ‣ Appendix A Appendix ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">A.2</span></a>.</p>
</div>
<div id="S2.SS2.p3" class="ltx_para ltx_noindent">
<p id="S2.SS2.p3.3" class="ltx_p">The full Fisher Information matrix is expensive to compute and store for large scale networks. Common approximations <cite class="ltx_cite ltx_citemacro_citep">(Kirkpatrick et al., <a href="#bib.bib24" title="" class="ltx_ref">2017</a>)</cite> involve using the diagonal empirical Fisher Information matrix, as shown in <a href="#S2.E3" title="In 2.2 Approximating Function Space Distance ‣ 2 Federated Learning in the Function Space ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">3</span></a>, where <math id="S2.SS2.p3.1.m1.1" class="ltx_Math" alttext="F_{i}^{(j)}" display="inline"><semantics id="S2.SS2.p3.1.m1.1a"><msubsup id="S2.SS2.p3.1.m1.1.2" xref="S2.SS2.p3.1.m1.1.2.cmml"><mi id="S2.SS2.p3.1.m1.1.2.2.2" xref="S2.SS2.p3.1.m1.1.2.2.2.cmml">F</mi><mi id="S2.SS2.p3.1.m1.1.2.2.3" xref="S2.SS2.p3.1.m1.1.2.2.3.cmml">i</mi><mrow id="S2.SS2.p3.1.m1.1.1.1.3" xref="S2.SS2.p3.1.m1.1.2.cmml"><mo stretchy="false" id="S2.SS2.p3.1.m1.1.1.1.3.1" xref="S2.SS2.p3.1.m1.1.2.cmml">(</mo><mi id="S2.SS2.p3.1.m1.1.1.1.1" xref="S2.SS2.p3.1.m1.1.1.1.1.cmml">j</mi><mo stretchy="false" id="S2.SS2.p3.1.m1.1.1.1.3.2" xref="S2.SS2.p3.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.1b"><apply id="S2.SS2.p3.1.m1.1.2.cmml" xref="S2.SS2.p3.1.m1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p3.1.m1.1.2.1.cmml" xref="S2.SS2.p3.1.m1.1.2">superscript</csymbol><apply id="S2.SS2.p3.1.m1.1.2.2.cmml" xref="S2.SS2.p3.1.m1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p3.1.m1.1.2.2.1.cmml" xref="S2.SS2.p3.1.m1.1.2">subscript</csymbol><ci id="S2.SS2.p3.1.m1.1.2.2.2.cmml" xref="S2.SS2.p3.1.m1.1.2.2.2">𝐹</ci><ci id="S2.SS2.p3.1.m1.1.2.2.3.cmml" xref="S2.SS2.p3.1.m1.1.2.2.3">𝑖</ci></apply><ci id="S2.SS2.p3.1.m1.1.1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.1c">F_{i}^{(j)}</annotation></semantics></math> is the <math id="S2.SS2.p3.2.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S2.SS2.p3.2.m2.1a"><mi id="S2.SS2.p3.2.m2.1.1" xref="S2.SS2.p3.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.2.m2.1b"><ci id="S2.SS2.p3.2.m2.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.2.m2.1c">j</annotation></semantics></math>-th diagonal entry of <math id="S2.SS2.p3.3.m3.1" class="ltx_Math" alttext="F_{i}" display="inline"><semantics id="S2.SS2.p3.3.m3.1a"><msub id="S2.SS2.p3.3.m3.1.1" xref="S2.SS2.p3.3.m3.1.1.cmml"><mi id="S2.SS2.p3.3.m3.1.1.2" xref="S2.SS2.p3.3.m3.1.1.2.cmml">F</mi><mi id="S2.SS2.p3.3.m3.1.1.3" xref="S2.SS2.p3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.3.m3.1b"><apply id="S2.SS2.p3.3.m3.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.3.m3.1.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p3.3.m3.1.1.2.cmml" xref="S2.SS2.p3.3.m3.1.1.2">𝐹</ci><ci id="S2.SS2.p3.3.m3.1.1.3.cmml" xref="S2.SS2.p3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.3.m3.1c">F_{i}</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">FedFish</span> Algorithm</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.1" class="ltx_p">Given function space distance approximations in <a href="#S2.SS2" title="2.2 Approximating Function Space Distance ‣ 2 Federated Learning in the Function Space ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">2.2</span></a>, we now obtain a parametric aggregation scheme that can be practically implemented in federated settings. Plugging <a href="#S2.E3" title="In 2.2 Approximating Function Space Distance ‣ 2 Federated Learning in the Function Space ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">3</span></a> into <a href="#S2.E1" title="In 2.1 Problem Setting ‣ 2 Federated Learning in the Function Space ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">1</span></a> and solving the convex optimization problem gives:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.7" class="ltx_Math" alttext="{\mathbf{\theta}}_{G}^{*}=\arg\min_{{\mathbf{\theta}}}\frac{1}{2N}\sum_{i=1}^{N}\sum_{j=1}^{|{\mathbf{\theta}}_{i}|}F_{i}^{(j)}({\mathbf{\theta}}^{(j)}-{\mathbf{\theta}}_{i}^{(j)})^{2}=\frac{\sum_{i=1}^{N}\text{diag}(F_{i})^{T}{\mathbf{\theta}}_{i}}{\sum_{i=1}^{N}\text{diag}(F_{i})}," display="block"><semantics id="S3.E4.m1.7a"><mrow id="S3.E4.m1.7.7.1" xref="S3.E4.m1.7.7.1.1.cmml"><mrow id="S3.E4.m1.7.7.1.1" xref="S3.E4.m1.7.7.1.1.cmml"><msubsup id="S3.E4.m1.7.7.1.1.3" xref="S3.E4.m1.7.7.1.1.3.cmml"><mi id="S3.E4.m1.7.7.1.1.3.2.2" xref="S3.E4.m1.7.7.1.1.3.2.2.cmml">θ</mi><mi id="S3.E4.m1.7.7.1.1.3.2.3" xref="S3.E4.m1.7.7.1.1.3.2.3.cmml">G</mi><mo id="S3.E4.m1.7.7.1.1.3.3" xref="S3.E4.m1.7.7.1.1.3.3.cmml">∗</mo></msubsup><mo id="S3.E4.m1.7.7.1.1.4" xref="S3.E4.m1.7.7.1.1.4.cmml">=</mo><mrow id="S3.E4.m1.7.7.1.1.1" xref="S3.E4.m1.7.7.1.1.1.cmml"><mrow id="S3.E4.m1.7.7.1.1.1.3" xref="S3.E4.m1.7.7.1.1.1.3.cmml"><mi id="S3.E4.m1.7.7.1.1.1.3.1" xref="S3.E4.m1.7.7.1.1.1.3.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E4.m1.7.7.1.1.1.3a" xref="S3.E4.m1.7.7.1.1.1.3.cmml">⁡</mo><mrow id="S3.E4.m1.7.7.1.1.1.3.2" xref="S3.E4.m1.7.7.1.1.1.3.2.cmml"><munder id="S3.E4.m1.7.7.1.1.1.3.2.1" xref="S3.E4.m1.7.7.1.1.1.3.2.1.cmml"><mi id="S3.E4.m1.7.7.1.1.1.3.2.1.2" xref="S3.E4.m1.7.7.1.1.1.3.2.1.2.cmml">min</mi><mi id="S3.E4.m1.7.7.1.1.1.3.2.1.3" xref="S3.E4.m1.7.7.1.1.1.3.2.1.3.cmml">θ</mi></munder><mo lspace="0.167em" id="S3.E4.m1.7.7.1.1.1.3.2a" xref="S3.E4.m1.7.7.1.1.1.3.2.cmml">⁡</mo><mfrac id="S3.E4.m1.7.7.1.1.1.3.2.2" xref="S3.E4.m1.7.7.1.1.1.3.2.2.cmml"><mn id="S3.E4.m1.7.7.1.1.1.3.2.2.2" xref="S3.E4.m1.7.7.1.1.1.3.2.2.2.cmml">1</mn><mrow id="S3.E4.m1.7.7.1.1.1.3.2.2.3" xref="S3.E4.m1.7.7.1.1.1.3.2.2.3.cmml"><mn id="S3.E4.m1.7.7.1.1.1.3.2.2.3.2" xref="S3.E4.m1.7.7.1.1.1.3.2.2.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E4.m1.7.7.1.1.1.3.2.2.3.1" xref="S3.E4.m1.7.7.1.1.1.3.2.2.3.1.cmml">​</mo><mi id="S3.E4.m1.7.7.1.1.1.3.2.2.3.3" xref="S3.E4.m1.7.7.1.1.1.3.2.2.3.3.cmml">N</mi></mrow></mfrac></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m1.7.7.1.1.1.2" xref="S3.E4.m1.7.7.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.7.7.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.cmml"><munderover id="S3.E4.m1.7.7.1.1.1.1.2" xref="S3.E4.m1.7.7.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E4.m1.7.7.1.1.1.1.2.2.2" xref="S3.E4.m1.7.7.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E4.m1.7.7.1.1.1.1.2.2.3" xref="S3.E4.m1.7.7.1.1.1.1.2.2.3.cmml"><mi id="S3.E4.m1.7.7.1.1.1.1.2.2.3.2" xref="S3.E4.m1.7.7.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E4.m1.7.7.1.1.1.1.2.2.3.1" xref="S3.E4.m1.7.7.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E4.m1.7.7.1.1.1.1.2.2.3.3" xref="S3.E4.m1.7.7.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.7.7.1.1.1.1.2.3" xref="S3.E4.m1.7.7.1.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S3.E4.m1.7.7.1.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.1.cmml"><munderover id="S3.E4.m1.7.7.1.1.1.1.1.2" xref="S3.E4.m1.7.7.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E4.m1.7.7.1.1.1.1.1.2.2.2" xref="S3.E4.m1.7.7.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E4.m1.7.7.1.1.1.1.1.2.2.3" xref="S3.E4.m1.7.7.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E4.m1.7.7.1.1.1.1.1.2.2.3.2" xref="S3.E4.m1.7.7.1.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="S3.E4.m1.7.7.1.1.1.1.1.2.2.3.1" xref="S3.E4.m1.7.7.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E4.m1.7.7.1.1.1.1.1.2.2.3.3" xref="S3.E4.m1.7.7.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.2.1.cmml">|</mo><msub id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.2.cmml">θ</mi><mi id="S3.E4.m1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E4.m1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S3.E4.m1.7.7.1.1.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.1.1.cmml"><msubsup id="S3.E4.m1.7.7.1.1.1.1.1.1.3" xref="S3.E4.m1.7.7.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.7.7.1.1.1.1.1.1.3.2.2" xref="S3.E4.m1.7.7.1.1.1.1.1.1.3.2.2.cmml">F</mi><mi id="S3.E4.m1.7.7.1.1.1.1.1.1.3.2.3" xref="S3.E4.m1.7.7.1.1.1.1.1.1.3.2.3.cmml">i</mi><mrow id="S3.E4.m1.2.2.1.3" xref="S3.E4.m1.7.7.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.1.3.1" xref="S3.E4.m1.7.7.1.1.1.1.1.1.3.cmml">(</mo><mi id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml">j</mi><mo stretchy="false" id="S3.E4.m1.2.2.1.3.2" xref="S3.E4.m1.7.7.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.E4.m1.7.7.1.1.1.1.1.1.2" xref="S3.E4.m1.7.7.1.1.1.1.1.1.2.cmml">​</mo><msup id="S3.E4.m1.7.7.1.1.1.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml"><msup id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.cmml">θ</mi><mrow id="S3.E4.m1.3.3.1.3" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.3.3.1.3.1" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.1.cmml">j</mi><mo stretchy="false" id="S3.E4.m1.3.3.1.3.2" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></msup><mo id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">θ</mi><mi id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mrow id="S3.E4.m1.4.4.1.3" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.1.3.1" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S3.E4.m1.4.4.1.1" xref="S3.E4.m1.4.4.1.1.cmml">j</mi><mo stretchy="false" id="S3.E4.m1.4.4.1.3.2" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo stretchy="false" id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E4.m1.7.7.1.1.1.1.1.1.1.3" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow></mrow><mo id="S3.E4.m1.7.7.1.1.5" xref="S3.E4.m1.7.7.1.1.5.cmml">=</mo><mfrac id="S3.E4.m1.6.6" xref="S3.E4.m1.6.6.cmml"><mrow id="S3.E4.m1.5.5.1" xref="S3.E4.m1.5.5.1.cmml"><msubsup id="S3.E4.m1.5.5.1.2" xref="S3.E4.m1.5.5.1.2.cmml"><mo id="S3.E4.m1.5.5.1.2.2.2" xref="S3.E4.m1.5.5.1.2.2.2.cmml">∑</mo><mrow id="S3.E4.m1.5.5.1.2.2.3" xref="S3.E4.m1.5.5.1.2.2.3.cmml"><mi id="S3.E4.m1.5.5.1.2.2.3.2" xref="S3.E4.m1.5.5.1.2.2.3.2.cmml">i</mi><mo id="S3.E4.m1.5.5.1.2.2.3.1" xref="S3.E4.m1.5.5.1.2.2.3.1.cmml">=</mo><mn id="S3.E4.m1.5.5.1.2.2.3.3" xref="S3.E4.m1.5.5.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.5.5.1.2.3" xref="S3.E4.m1.5.5.1.2.3.cmml">N</mi></msubsup><mrow id="S3.E4.m1.5.5.1.1" xref="S3.E4.m1.5.5.1.1.cmml"><mtext id="S3.E4.m1.5.5.1.1.3" xref="S3.E4.m1.5.5.1.1.3a.cmml">diag</mtext><mo lspace="0em" rspace="0em" id="S3.E4.m1.5.5.1.1.2" xref="S3.E4.m1.5.5.1.1.2.cmml">​</mo><msup id="S3.E4.m1.5.5.1.1.1" xref="S3.E4.m1.5.5.1.1.1.cmml"><mrow id="S3.E4.m1.5.5.1.1.1.1.1" xref="S3.E4.m1.5.5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.5.5.1.1.1.1.1.2" xref="S3.E4.m1.5.5.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E4.m1.5.5.1.1.1.1.1.1" xref="S3.E4.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.5.5.1.1.1.1.1.1.2" xref="S3.E4.m1.5.5.1.1.1.1.1.1.2.cmml">F</mi><mi id="S3.E4.m1.5.5.1.1.1.1.1.1.3" xref="S3.E4.m1.5.5.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E4.m1.5.5.1.1.1.1.1.3" xref="S3.E4.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E4.m1.5.5.1.1.1.3" xref="S3.E4.m1.5.5.1.1.1.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.E4.m1.5.5.1.1.2a" xref="S3.E4.m1.5.5.1.1.2.cmml">​</mo><msub id="S3.E4.m1.5.5.1.1.4" xref="S3.E4.m1.5.5.1.1.4.cmml"><mi id="S3.E4.m1.5.5.1.1.4.2" xref="S3.E4.m1.5.5.1.1.4.2.cmml">θ</mi><mi id="S3.E4.m1.5.5.1.1.4.3" xref="S3.E4.m1.5.5.1.1.4.3.cmml">i</mi></msub></mrow></mrow><mrow id="S3.E4.m1.6.6.2" xref="S3.E4.m1.6.6.2.cmml"><msubsup id="S3.E4.m1.6.6.2.2" xref="S3.E4.m1.6.6.2.2.cmml"><mo id="S3.E4.m1.6.6.2.2.2.2" xref="S3.E4.m1.6.6.2.2.2.2.cmml">∑</mo><mrow id="S3.E4.m1.6.6.2.2.2.3" xref="S3.E4.m1.6.6.2.2.2.3.cmml"><mi id="S3.E4.m1.6.6.2.2.2.3.2" xref="S3.E4.m1.6.6.2.2.2.3.2.cmml">i</mi><mo id="S3.E4.m1.6.6.2.2.2.3.1" xref="S3.E4.m1.6.6.2.2.2.3.1.cmml">=</mo><mn id="S3.E4.m1.6.6.2.2.2.3.3" xref="S3.E4.m1.6.6.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.6.6.2.2.3" xref="S3.E4.m1.6.6.2.2.3.cmml">N</mi></msubsup><mrow id="S3.E4.m1.6.6.2.1" xref="S3.E4.m1.6.6.2.1.cmml"><mtext id="S3.E4.m1.6.6.2.1.3" xref="S3.E4.m1.6.6.2.1.3a.cmml">diag</mtext><mo lspace="0em" rspace="0em" id="S3.E4.m1.6.6.2.1.2" xref="S3.E4.m1.6.6.2.1.2.cmml">​</mo><mrow id="S3.E4.m1.6.6.2.1.1.1" xref="S3.E4.m1.6.6.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.6.6.2.1.1.1.2" xref="S3.E4.m1.6.6.2.1.1.1.1.cmml">(</mo><msub id="S3.E4.m1.6.6.2.1.1.1.1" xref="S3.E4.m1.6.6.2.1.1.1.1.cmml"><mi id="S3.E4.m1.6.6.2.1.1.1.1.2" xref="S3.E4.m1.6.6.2.1.1.1.1.2.cmml">F</mi><mi id="S3.E4.m1.6.6.2.1.1.1.1.3" xref="S3.E4.m1.6.6.2.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E4.m1.6.6.2.1.1.1.3" xref="S3.E4.m1.6.6.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S3.E4.m1.7.7.1.2" xref="S3.E4.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.7b"><apply id="S3.E4.m1.7.7.1.1.cmml" xref="S3.E4.m1.7.7.1"><and id="S3.E4.m1.7.7.1.1a.cmml" xref="S3.E4.m1.7.7.1"></and><apply id="S3.E4.m1.7.7.1.1b.cmml" xref="S3.E4.m1.7.7.1"><eq id="S3.E4.m1.7.7.1.1.4.cmml" xref="S3.E4.m1.7.7.1.1.4"></eq><apply id="S3.E4.m1.7.7.1.1.3.cmml" xref="S3.E4.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.3.1.cmml" xref="S3.E4.m1.7.7.1.1.3">superscript</csymbol><apply id="S3.E4.m1.7.7.1.1.3.2.cmml" xref="S3.E4.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.3.2.1.cmml" xref="S3.E4.m1.7.7.1.1.3">subscript</csymbol><ci id="S3.E4.m1.7.7.1.1.3.2.2.cmml" xref="S3.E4.m1.7.7.1.1.3.2.2">𝜃</ci><ci id="S3.E4.m1.7.7.1.1.3.2.3.cmml" xref="S3.E4.m1.7.7.1.1.3.2.3">𝐺</ci></apply><times id="S3.E4.m1.7.7.1.1.3.3.cmml" xref="S3.E4.m1.7.7.1.1.3.3"></times></apply><apply id="S3.E4.m1.7.7.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1"><times id="S3.E4.m1.7.7.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.1.2"></times><apply id="S3.E4.m1.7.7.1.1.1.3.cmml" xref="S3.E4.m1.7.7.1.1.1.3"><arg id="S3.E4.m1.7.7.1.1.1.3.1.cmml" xref="S3.E4.m1.7.7.1.1.1.3.1"></arg><apply id="S3.E4.m1.7.7.1.1.1.3.2.cmml" xref="S3.E4.m1.7.7.1.1.1.3.2"><apply id="S3.E4.m1.7.7.1.1.1.3.2.1.cmml" xref="S3.E4.m1.7.7.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.3.2.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1.3.2.1">subscript</csymbol><min id="S3.E4.m1.7.7.1.1.1.3.2.1.2.cmml" xref="S3.E4.m1.7.7.1.1.1.3.2.1.2"></min><ci id="S3.E4.m1.7.7.1.1.1.3.2.1.3.cmml" xref="S3.E4.m1.7.7.1.1.1.3.2.1.3">𝜃</ci></apply><apply id="S3.E4.m1.7.7.1.1.1.3.2.2.cmml" xref="S3.E4.m1.7.7.1.1.1.3.2.2"><divide id="S3.E4.m1.7.7.1.1.1.3.2.2.1.cmml" xref="S3.E4.m1.7.7.1.1.1.3.2.2"></divide><cn type="integer" id="S3.E4.m1.7.7.1.1.1.3.2.2.2.cmml" xref="S3.E4.m1.7.7.1.1.1.3.2.2.2">1</cn><apply id="S3.E4.m1.7.7.1.1.1.3.2.2.3.cmml" xref="S3.E4.m1.7.7.1.1.1.3.2.2.3"><times id="S3.E4.m1.7.7.1.1.1.3.2.2.3.1.cmml" xref="S3.E4.m1.7.7.1.1.1.3.2.2.3.1"></times><cn type="integer" id="S3.E4.m1.7.7.1.1.1.3.2.2.3.2.cmml" xref="S3.E4.m1.7.7.1.1.1.3.2.2.3.2">2</cn><ci id="S3.E4.m1.7.7.1.1.1.3.2.2.3.3.cmml" xref="S3.E4.m1.7.7.1.1.1.3.2.2.3.3">𝑁</ci></apply></apply></apply></apply><apply id="S3.E4.m1.7.7.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1"><apply id="S3.E4.m1.7.7.1.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.1.2.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2">superscript</csymbol><apply id="S3.E4.m1.7.7.1.1.1.1.2.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.1.2.2.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2">subscript</csymbol><sum id="S3.E4.m1.7.7.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2.2.2"></sum><apply id="S3.E4.m1.7.7.1.1.1.1.2.2.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2.2.3"><eq id="S3.E4.m1.7.7.1.1.1.1.2.2.3.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2.2.3.1"></eq><ci id="S3.E4.m1.7.7.1.1.1.1.2.2.3.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E4.m1.7.7.1.1.1.1.2.2.3.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.7.7.1.1.1.1.2.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2.3">𝑁</ci></apply><apply id="S3.E4.m1.7.7.1.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1"><apply id="S3.E4.m1.7.7.1.1.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E4.m1.7.7.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.1.1.2.2.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E4.m1.7.7.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.2.2.2"></sum><apply id="S3.E4.m1.7.7.1.1.1.1.1.2.2.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.2.2.3"><eq id="S3.E4.m1.7.7.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E4.m1.7.7.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S3.E4.m1.7.7.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E4.m1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1"><abs id="S3.E4.m1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2"></abs><apply id="S3.E4.m1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.2">𝜃</ci><ci id="S3.E4.m1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S3.E4.m1.7.7.1.1.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1"><times id="S3.E4.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.2"></times><apply id="S3.E4.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E4.m1.7.7.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.7.7.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.3.2.2">𝐹</ci><ci id="S3.E4.m1.7.7.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E4.m1.2.2.1.1.cmml" xref="S3.E4.m1.2.2.1.1">𝑗</ci></apply><apply id="S3.E4.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1"><minus id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2">𝜃</ci><ci id="S3.E4.m1.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1.1">𝑗</ci></apply><apply id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.2">𝜃</ci><ci id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E4.m1.4.4.1.1.cmml" xref="S3.E4.m1.4.4.1.1">𝑗</ci></apply></apply><cn type="integer" id="S3.E4.m1.7.7.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></apply><apply id="S3.E4.m1.7.7.1.1c.cmml" xref="S3.E4.m1.7.7.1"><eq id="S3.E4.m1.7.7.1.1.5.cmml" xref="S3.E4.m1.7.7.1.1.5"></eq><share href="#S3.E4.m1.7.7.1.1.1.cmml" id="S3.E4.m1.7.7.1.1d.cmml" xref="S3.E4.m1.7.7.1"></share><apply id="S3.E4.m1.6.6.cmml" xref="S3.E4.m1.6.6"><divide id="S3.E4.m1.6.6.3.cmml" xref="S3.E4.m1.6.6"></divide><apply id="S3.E4.m1.5.5.1.cmml" xref="S3.E4.m1.5.5.1"><apply id="S3.E4.m1.5.5.1.2.cmml" xref="S3.E4.m1.5.5.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.2.1.cmml" xref="S3.E4.m1.5.5.1.2">superscript</csymbol><apply id="S3.E4.m1.5.5.1.2.2.cmml" xref="S3.E4.m1.5.5.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.2.2.1.cmml" xref="S3.E4.m1.5.5.1.2">subscript</csymbol><sum id="S3.E4.m1.5.5.1.2.2.2.cmml" xref="S3.E4.m1.5.5.1.2.2.2"></sum><apply id="S3.E4.m1.5.5.1.2.2.3.cmml" xref="S3.E4.m1.5.5.1.2.2.3"><eq id="S3.E4.m1.5.5.1.2.2.3.1.cmml" xref="S3.E4.m1.5.5.1.2.2.3.1"></eq><ci id="S3.E4.m1.5.5.1.2.2.3.2.cmml" xref="S3.E4.m1.5.5.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E4.m1.5.5.1.2.2.3.3.cmml" xref="S3.E4.m1.5.5.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.5.5.1.2.3.cmml" xref="S3.E4.m1.5.5.1.2.3">𝑁</ci></apply><apply id="S3.E4.m1.5.5.1.1.cmml" xref="S3.E4.m1.5.5.1.1"><times id="S3.E4.m1.5.5.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.2"></times><ci id="S3.E4.m1.5.5.1.1.3a.cmml" xref="S3.E4.m1.5.5.1.1.3"><mtext id="S3.E4.m1.5.5.1.1.3.cmml" xref="S3.E4.m1.5.5.1.1.3">diag</mtext></ci><apply id="S3.E4.m1.5.5.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.1">superscript</csymbol><apply id="S3.E4.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.1.2">𝐹</ci><ci id="S3.E4.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E4.m1.5.5.1.1.1.3.cmml" xref="S3.E4.m1.5.5.1.1.1.3">𝑇</ci></apply><apply id="S3.E4.m1.5.5.1.1.4.cmml" xref="S3.E4.m1.5.5.1.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.4.1.cmml" xref="S3.E4.m1.5.5.1.1.4">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.4.2.cmml" xref="S3.E4.m1.5.5.1.1.4.2">𝜃</ci><ci id="S3.E4.m1.5.5.1.1.4.3.cmml" xref="S3.E4.m1.5.5.1.1.4.3">𝑖</ci></apply></apply></apply><apply id="S3.E4.m1.6.6.2.cmml" xref="S3.E4.m1.6.6.2"><apply id="S3.E4.m1.6.6.2.2.cmml" xref="S3.E4.m1.6.6.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.2.2.1.cmml" xref="S3.E4.m1.6.6.2.2">superscript</csymbol><apply id="S3.E4.m1.6.6.2.2.2.cmml" xref="S3.E4.m1.6.6.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.2.2.2.1.cmml" xref="S3.E4.m1.6.6.2.2">subscript</csymbol><sum id="S3.E4.m1.6.6.2.2.2.2.cmml" xref="S3.E4.m1.6.6.2.2.2.2"></sum><apply id="S3.E4.m1.6.6.2.2.2.3.cmml" xref="S3.E4.m1.6.6.2.2.2.3"><eq id="S3.E4.m1.6.6.2.2.2.3.1.cmml" xref="S3.E4.m1.6.6.2.2.2.3.1"></eq><ci id="S3.E4.m1.6.6.2.2.2.3.2.cmml" xref="S3.E4.m1.6.6.2.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E4.m1.6.6.2.2.2.3.3.cmml" xref="S3.E4.m1.6.6.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.6.6.2.2.3.cmml" xref="S3.E4.m1.6.6.2.2.3">𝑁</ci></apply><apply id="S3.E4.m1.6.6.2.1.cmml" xref="S3.E4.m1.6.6.2.1"><times id="S3.E4.m1.6.6.2.1.2.cmml" xref="S3.E4.m1.6.6.2.1.2"></times><ci id="S3.E4.m1.6.6.2.1.3a.cmml" xref="S3.E4.m1.6.6.2.1.3"><mtext id="S3.E4.m1.6.6.2.1.3.cmml" xref="S3.E4.m1.6.6.2.1.3">diag</mtext></ci><apply id="S3.E4.m1.6.6.2.1.1.1.1.cmml" xref="S3.E4.m1.6.6.2.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.2.1.1.1.1.1.cmml" xref="S3.E4.m1.6.6.2.1.1.1">subscript</csymbol><ci id="S3.E4.m1.6.6.2.1.1.1.1.2.cmml" xref="S3.E4.m1.6.6.2.1.1.1.1.2">𝐹</ci><ci id="S3.E4.m1.6.6.2.1.1.1.1.3.cmml" xref="S3.E4.m1.6.6.2.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.7c">{\mathbf{\theta}}_{G}^{*}=\arg\min_{{\mathbf{\theta}}}\frac{1}{2N}\sum_{i=1}^{N}\sum_{j=1}^{|{\mathbf{\theta}}_{i}|}F_{i}^{(j)}({\mathbf{\theta}}^{(j)}-{\mathbf{\theta}}_{i}^{(j)})^{2}=\frac{\sum_{i=1}^{N}\text{diag}(F_{i})^{T}{\mathbf{\theta}}_{i}}{\sum_{i=1}^{N}\text{diag}(F_{i})},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.p2" class="ltx_para ltx_noindent">
<p id="S3.p2.4" class="ltx_p">where <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="\text{diag}(F_{i})" display="inline"><semantics id="S3.p2.1.m1.1a"><mrow id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml"><mtext id="S3.p2.1.m1.1.1.3" xref="S3.p2.1.m1.1.1.3a.cmml">diag</mtext><mo lspace="0em" rspace="0em" id="S3.p2.1.m1.1.1.2" xref="S3.p2.1.m1.1.1.2.cmml">​</mo><mrow id="S3.p2.1.m1.1.1.1.1" xref="S3.p2.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p2.1.m1.1.1.1.1.2" xref="S3.p2.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.p2.1.m1.1.1.1.1.1" xref="S3.p2.1.m1.1.1.1.1.1.cmml"><mi id="S3.p2.1.m1.1.1.1.1.1.2" xref="S3.p2.1.m1.1.1.1.1.1.2.cmml">F</mi><mi id="S3.p2.1.m1.1.1.1.1.1.3" xref="S3.p2.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.p2.1.m1.1.1.1.1.3" xref="S3.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1"><times id="S3.p2.1.m1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.2"></times><ci id="S3.p2.1.m1.1.1.3a.cmml" xref="S3.p2.1.m1.1.1.3"><mtext id="S3.p2.1.m1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.3">diag</mtext></ci><apply id="S3.p2.1.m1.1.1.1.1.1.cmml" xref="S3.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.p2.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.1.1.1.2">𝐹</ci><ci id="S3.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">\text{diag}(F_{i})</annotation></semantics></math> represents the diagonal of <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="F_{i}" display="inline"><semantics id="S3.p2.2.m2.1a"><msub id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml"><mi id="S3.p2.2.m2.1.1.2" xref="S3.p2.2.m2.1.1.2.cmml">F</mi><mi id="S3.p2.2.m2.1.1.3" xref="S3.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.1.cmml" xref="S3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.p2.2.m2.1.1.2.cmml" xref="S3.p2.2.m2.1.1.2">𝐹</ci><ci id="S3.p2.2.m2.1.1.3.cmml" xref="S3.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">F_{i}</annotation></semantics></math>. Hence, the global model at each round is the Fisher-weighted average of client models, normalized by the sum of all Fisher diagonals. In this form, <span id="S3.p2.4.1" class="ltx_text ltx_font_smallcaps">FedFish</span> is simple to implement and efficient to deploy in cross-device federated settings. The empirical Fisher diagonal can be computed during local training, via an average of squared gradients of the training objective with respect to mini-batches of data, as shown in <a href="#alg2" title="In 3 FedFish Algorithm ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">algorithm</span> <span class="ltx_text ltx_ref_tag">2</span></a>. Similar to common <span id="S3.p2.4.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> implementations, the clients communicate model deltas to the global server, which are then aggregated and used as pseudo-gradients in one step of global model optimization. <span id="S3.p2.4.3" class="ltx_text ltx_font_smallcaps">FedFish</span> can be combined with adaptive optimization techniques for different choices of global optimizers. We show this procedure for SGD with global learning rate <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="\eta_{g}" display="inline"><semantics id="S3.p2.3.m3.1a"><msub id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml"><mi id="S3.p2.3.m3.1.1.2" xref="S3.p2.3.m3.1.1.2.cmml">η</mi><mi id="S3.p2.3.m3.1.1.3" xref="S3.p2.3.m3.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><apply id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.1.cmml" xref="S3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.p2.3.m3.1.1.2.cmml" xref="S3.p2.3.m3.1.1.2">𝜂</ci><ci id="S3.p2.3.m3.1.1.3.cmml" xref="S3.p2.3.m3.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">\eta_{g}</annotation></semantics></math> and local learning rate <math id="S3.p2.4.m4.1" class="ltx_Math" alttext="\eta_{c}" display="inline"><semantics id="S3.p2.4.m4.1a"><msub id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml"><mi id="S3.p2.4.m4.1.1.2" xref="S3.p2.4.m4.1.1.2.cmml">η</mi><mi id="S3.p2.4.m4.1.1.3" xref="S3.p2.4.m4.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><apply id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p2.4.m4.1.1.1.cmml" xref="S3.p2.4.m4.1.1">subscript</csymbol><ci id="S3.p2.4.m4.1.1.2.cmml" xref="S3.p2.4.m4.1.1.2">𝜂</ci><ci id="S3.p2.4.m4.1.1.3.cmml" xref="S3.p2.4.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">\eta_{c}</annotation></semantics></math> in <a href="#alg1" title="In 3 FedFish Algorithm ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">algorithm</span> <span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S3.p3" class="ltx_para ltx_noindent">
<p id="S3.p3.1" class="ltx_p">Note that we recover the <span id="S3.p3.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> algorithm if the Fisher coefficients for each parameter are the same across client networks. Such a condition is unlikely to hold even approximately, especially in settings with increasing data heterogeneity. Fisher coefficients account for the influence of each parameter on its network’s predictions with respect to corresponding inputs. Intuitively, <span id="S3.p3.1.2" class="ltx_text ltx_font_smallcaps">FedFish</span> has the following advantages: (1) Each local parameter’s contribution to the global aggregate is proportionate to a measure of its importance for making predictions on its training data, which improves upon the <span id="S3.p3.1.3" class="ltx_text ltx_font_smallcaps">FedAvg</span> global model. (2) Derived from a function space perspective, <span id="S3.p3.1.4" class="ltx_text ltx_font_smallcaps">FedFish</span> simply aims to match the functions learned by clients so far, without relying on optimality assumptions. This makes it compatible with heterogeneous datasets, longer local training as well as multiple rounds of FL. We empirically test for these gains across several settings ranging from toy to large scales.</p>
</div>
<figure id="alg1" class="ltx_float ltx_minipage ltx_align_middle ltx_framed ltx_framed_top" style="width:230.2pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_float"><span id="alg1.3.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> <span id="alg1.4.2" class="ltx_text ltx_font_smallcaps">FedFish</span> (SGD)</figcaption>
<div id="alg1.5" class="ltx_listing ltx_align_center ltx_listing">
<div id="alg1.l0" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l0.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>  rounds <math id="alg1.l0.m1.1" class="ltx_Math" alttext="R" display="inline"><semantics id="alg1.l0.m1.1a"><mi id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.1b"><ci id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.1c">R</annotation></semantics></math>, local epochs <math id="alg1.l0.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.l0.m2.1a"><mi id="alg1.l0.m2.1.1" xref="alg1.l0.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.1b"><ci id="alg1.l0.m2.1.1.cmml" xref="alg1.l0.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.1c">E</annotation></semantics></math>, <math id="alg1.l0.m3.1" class="ltx_Math" alttext="\theta_{G}" display="inline"><semantics id="alg1.l0.m3.1a"><msub id="alg1.l0.m3.1.1" xref="alg1.l0.m3.1.1.cmml"><mi id="alg1.l0.m3.1.1.2" xref="alg1.l0.m3.1.1.2.cmml">θ</mi><mi id="alg1.l0.m3.1.1.3" xref="alg1.l0.m3.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.m3.1b"><apply id="alg1.l0.m3.1.1.cmml" xref="alg1.l0.m3.1.1"><csymbol cd="ambiguous" id="alg1.l0.m3.1.1.1.cmml" xref="alg1.l0.m3.1.1">subscript</csymbol><ci id="alg1.l0.m3.1.1.2.cmml" xref="alg1.l0.m3.1.1.2">𝜃</ci><ci id="alg1.l0.m3.1.1.3.cmml" xref="alg1.l0.m3.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m3.1c">\theta_{G}</annotation></semantics></math>, client datasets <math id="alg1.l0.m4.1" class="ltx_Math" alttext="D" display="inline"><semantics id="alg1.l0.m4.1a"><mi id="alg1.l0.m4.1.1" xref="alg1.l0.m4.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m4.1b"><ci id="alg1.l0.m4.1.1.cmml" xref="alg1.l0.m4.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m4.1c">D</annotation></semantics></math>, global lr <math id="alg1.l0.m5.1" class="ltx_Math" alttext="\eta_{g}" display="inline"><semantics id="alg1.l0.m5.1a"><msub id="alg1.l0.m5.1.1" xref="alg1.l0.m5.1.1.cmml"><mi id="alg1.l0.m5.1.1.2" xref="alg1.l0.m5.1.1.2.cmml">η</mi><mi id="alg1.l0.m5.1.1.3" xref="alg1.l0.m5.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.m5.1b"><apply id="alg1.l0.m5.1.1.cmml" xref="alg1.l0.m5.1.1"><csymbol cd="ambiguous" id="alg1.l0.m5.1.1.1.cmml" xref="alg1.l0.m5.1.1">subscript</csymbol><ci id="alg1.l0.m5.1.1.2.cmml" xref="alg1.l0.m5.1.1.2">𝜂</ci><ci id="alg1.l0.m5.1.1.3.cmml" xref="alg1.l0.m5.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m5.1c">\eta_{g}</annotation></semantics></math>, local lr <math id="alg1.l0.m6.1" class="ltx_Math" alttext="\eta_{c}" display="inline"><semantics id="alg1.l0.m6.1a"><msub id="alg1.l0.m6.1.1" xref="alg1.l0.m6.1.1.cmml"><mi id="alg1.l0.m6.1.1.2" xref="alg1.l0.m6.1.1.2.cmml">η</mi><mi id="alg1.l0.m6.1.1.3" xref="alg1.l0.m6.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.m6.1b"><apply id="alg1.l0.m6.1.1.cmml" xref="alg1.l0.m6.1.1"><csymbol cd="ambiguous" id="alg1.l0.m6.1.1.1.cmml" xref="alg1.l0.m6.1.1">subscript</csymbol><ci id="alg1.l0.m6.1.1.2.cmml" xref="alg1.l0.m6.1.1.2">𝜂</ci><ci id="alg1.l0.m6.1.1.3.cmml" xref="alg1.l0.m6.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m6.1c">\eta_{c}</annotation></semantics></math>

</div>
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  <span id="alg1.l1.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l1.m1.1" class="ltx_Math" alttext="r\leftarrow 1" display="inline"><semantics id="alg1.l1.m1.1a"><mrow id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">r</mi><mo stretchy="false" id="alg1.l1.m1.1.1.1" xref="alg1.l1.m1.1.1.1.cmml">←</mo><mn id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><ci id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1">←</ci><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝑟</ci><cn type="integer" id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">r\leftarrow 1</annotation></semantics></math> to <math id="alg1.l1.m2.1" class="ltx_Math" alttext="R" display="inline"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">R</annotation></semantics></math> <span id="alg1.l1.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>     <math id="alg1.l2.m1.1" class="ltx_Math" alttext="\texttt{Sample a cohort of clients, }C" display="inline"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2a.cmml">Sample a cohort of clients, </mtext><mo lspace="0em" rspace="0em" id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">​</mo><mi id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><times id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1"></times><ci id="alg1.l2.m1.1.1.2a.cmml" xref="alg1.l2.m1.1.1.2"><mtext class="ltx_mathvariant_monospace" id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">Sample a cohort of clients, </mtext></ci><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\texttt{Sample a cohort of clients, }C</annotation></semantics></math>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>     <span id="alg1.l3.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l3.m1.1" class="ltx_Math" alttext="i\in C" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">i</mi><mo id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">∈</mo><mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><in id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1"></in><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝑖</ci><ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">i\in C</annotation></semantics></math> <span id="alg1.l3.3" class="ltx_text ltx_font_bold">in parallel</span> <span id="alg1.l3.4" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>        <math id="alg1.l4.m1.1" class="ltx_Math" alttext="\texttt{Compute client weights, }w_{i}=|D_{i}|" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mrow id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"><mtext class="ltx_mathvariant_monospace" id="alg1.l4.m1.1.1.3.2" xref="alg1.l4.m1.1.1.3.2a.cmml">Compute client weights, </mtext><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.3.1" xref="alg1.l4.m1.1.1.3.1.cmml">​</mo><msub id="alg1.l4.m1.1.1.3.3" xref="alg1.l4.m1.1.1.3.3.cmml"><mi id="alg1.l4.m1.1.1.3.3.2" xref="alg1.l4.m1.1.1.3.3.2.cmml">w</mi><mi id="alg1.l4.m1.1.1.3.3.3" xref="alg1.l4.m1.1.1.3.3.3.cmml">i</mi></msub></mrow><mo id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">=</mo><mrow id="alg1.l4.m1.1.1.1.1" xref="alg1.l4.m1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l4.m1.1.1.1.1.2" xref="alg1.l4.m1.1.1.1.2.1.cmml">|</mo><msub id="alg1.l4.m1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.cmml"><mi id="alg1.l4.m1.1.1.1.1.1.2" xref="alg1.l4.m1.1.1.1.1.1.2.cmml">D</mi><mi id="alg1.l4.m1.1.1.1.1.1.3" xref="alg1.l4.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l4.m1.1.1.1.1.3" xref="alg1.l4.m1.1.1.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><eq id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2"></eq><apply id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3"><times id="alg1.l4.m1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.3.1"></times><ci id="alg1.l4.m1.1.1.3.2a.cmml" xref="alg1.l4.m1.1.1.3.2"><mtext class="ltx_mathvariant_monospace" id="alg1.l4.m1.1.1.3.2.cmml" xref="alg1.l4.m1.1.1.3.2">Compute client weights, </mtext></ci><apply id="alg1.l4.m1.1.1.3.3.cmml" xref="alg1.l4.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.3.3.1.cmml" xref="alg1.l4.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l4.m1.1.1.3.3.2.cmml" xref="alg1.l4.m1.1.1.3.3.2">𝑤</ci><ci id="alg1.l4.m1.1.1.3.3.3.cmml" xref="alg1.l4.m1.1.1.3.3.3">𝑖</ci></apply></apply><apply id="alg1.l4.m1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.1"><abs id="alg1.l4.m1.1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.1.1.2"></abs><apply id="alg1.l4.m1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l4.m1.1.1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.2">𝐷</ci><ci id="alg1.l4.m1.1.1.1.1.1.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\texttt{Compute client weights, }w_{i}=|D_{i}|</annotation></semantics></math>

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>        <math id="alg1.l5.m1.1" class="ltx_Math" alttext="{\mathbf{\theta}}_{i}\leftarrow{\mathbf{\theta}}_{G}" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><msub id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml"><mi id="alg1.l5.m1.1.1.2.2" xref="alg1.l5.m1.1.1.2.2.cmml">θ</mi><mi id="alg1.l5.m1.1.1.2.3" xref="alg1.l5.m1.1.1.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">←</mo><msub id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml"><mi id="alg1.l5.m1.1.1.3.2" xref="alg1.l5.m1.1.1.3.2.cmml">θ</mi><mi id="alg1.l5.m1.1.1.3.3" xref="alg1.l5.m1.1.1.3.3.cmml">G</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><ci id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1">←</ci><apply id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.2">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.2.2">𝜃</ci><ci id="alg1.l5.m1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.3">subscript</csymbol><ci id="alg1.l5.m1.1.1.3.2.cmml" xref="alg1.l5.m1.1.1.3.2">𝜃</ci><ci id="alg1.l5.m1.1.1.3.3.cmml" xref="alg1.l5.m1.1.1.3.3">𝐺</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">{\mathbf{\theta}}_{i}\leftarrow{\mathbf{\theta}}_{G}</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>        <math id="alg1.l6.m1.6" class="ltx_Math" alttext="\Delta{\mathbf{\theta}}_{i},F_{i}\leftarrow\texttt{FedLocalTrain}(E,{\mathbf{\theta}}_{i},D_{i},\eta_{c})" display="inline"><semantics id="alg1.l6.m1.6a"><mrow id="alg1.l6.m1.6.6" xref="alg1.l6.m1.6.6.cmml"><mrow id="alg1.l6.m1.3.3.2.2" xref="alg1.l6.m1.3.3.2.3.cmml"><mrow id="alg1.l6.m1.2.2.1.1.1" xref="alg1.l6.m1.2.2.1.1.1.cmml"><mi mathvariant="normal" id="alg1.l6.m1.2.2.1.1.1.2" xref="alg1.l6.m1.2.2.1.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.1.1.1.1" xref="alg1.l6.m1.2.2.1.1.1.1.cmml">​</mo><msub id="alg1.l6.m1.2.2.1.1.1.3" xref="alg1.l6.m1.2.2.1.1.1.3.cmml"><mi id="alg1.l6.m1.2.2.1.1.1.3.2" xref="alg1.l6.m1.2.2.1.1.1.3.2.cmml">θ</mi><mi id="alg1.l6.m1.2.2.1.1.1.3.3" xref="alg1.l6.m1.2.2.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="alg1.l6.m1.3.3.2.2.3" xref="alg1.l6.m1.3.3.2.3.cmml">,</mo><msub id="alg1.l6.m1.3.3.2.2.2" xref="alg1.l6.m1.3.3.2.2.2.cmml"><mi id="alg1.l6.m1.3.3.2.2.2.2" xref="alg1.l6.m1.3.3.2.2.2.2.cmml">F</mi><mi id="alg1.l6.m1.3.3.2.2.2.3" xref="alg1.l6.m1.3.3.2.2.2.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="alg1.l6.m1.6.6.6" xref="alg1.l6.m1.6.6.6.cmml">←</mo><mrow id="alg1.l6.m1.6.6.5" xref="alg1.l6.m1.6.6.5.cmml"><mtext class="ltx_mathvariant_monospace" id="alg1.l6.m1.6.6.5.5" xref="alg1.l6.m1.6.6.5.5a.cmml">FedLocalTrain</mtext><mo lspace="0em" rspace="0em" id="alg1.l6.m1.6.6.5.4" xref="alg1.l6.m1.6.6.5.4.cmml">​</mo><mrow id="alg1.l6.m1.6.6.5.3.3" xref="alg1.l6.m1.6.6.5.3.4.cmml"><mo stretchy="false" id="alg1.l6.m1.6.6.5.3.3.4" xref="alg1.l6.m1.6.6.5.3.4.cmml">(</mo><mi id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">E</mi><mo id="alg1.l6.m1.6.6.5.3.3.5" xref="alg1.l6.m1.6.6.5.3.4.cmml">,</mo><msub id="alg1.l6.m1.4.4.3.1.1.1" xref="alg1.l6.m1.4.4.3.1.1.1.cmml"><mi id="alg1.l6.m1.4.4.3.1.1.1.2" xref="alg1.l6.m1.4.4.3.1.1.1.2.cmml">θ</mi><mi id="alg1.l6.m1.4.4.3.1.1.1.3" xref="alg1.l6.m1.4.4.3.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l6.m1.6.6.5.3.3.6" xref="alg1.l6.m1.6.6.5.3.4.cmml">,</mo><msub id="alg1.l6.m1.5.5.4.2.2.2" xref="alg1.l6.m1.5.5.4.2.2.2.cmml"><mi id="alg1.l6.m1.5.5.4.2.2.2.2" xref="alg1.l6.m1.5.5.4.2.2.2.2.cmml">D</mi><mi id="alg1.l6.m1.5.5.4.2.2.2.3" xref="alg1.l6.m1.5.5.4.2.2.2.3.cmml">i</mi></msub><mo id="alg1.l6.m1.6.6.5.3.3.7" xref="alg1.l6.m1.6.6.5.3.4.cmml">,</mo><msub id="alg1.l6.m1.6.6.5.3.3.3" xref="alg1.l6.m1.6.6.5.3.3.3.cmml"><mi id="alg1.l6.m1.6.6.5.3.3.3.2" xref="alg1.l6.m1.6.6.5.3.3.3.2.cmml">η</mi><mi id="alg1.l6.m1.6.6.5.3.3.3.3" xref="alg1.l6.m1.6.6.5.3.3.3.3.cmml">c</mi></msub><mo stretchy="false" id="alg1.l6.m1.6.6.5.3.3.8" xref="alg1.l6.m1.6.6.5.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.6b"><apply id="alg1.l6.m1.6.6.cmml" xref="alg1.l6.m1.6.6"><ci id="alg1.l6.m1.6.6.6.cmml" xref="alg1.l6.m1.6.6.6">←</ci><list id="alg1.l6.m1.3.3.2.3.cmml" xref="alg1.l6.m1.3.3.2.2"><apply id="alg1.l6.m1.2.2.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1"><times id="alg1.l6.m1.2.2.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1.1"></times><ci id="alg1.l6.m1.2.2.1.1.1.2.cmml" xref="alg1.l6.m1.2.2.1.1.1.2">Δ</ci><apply id="alg1.l6.m1.2.2.1.1.1.3.cmml" xref="alg1.l6.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.1.1.1.3.1.cmml" xref="alg1.l6.m1.2.2.1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.2.2.1.1.1.3.2.cmml" xref="alg1.l6.m1.2.2.1.1.1.3.2">𝜃</ci><ci id="alg1.l6.m1.2.2.1.1.1.3.3.cmml" xref="alg1.l6.m1.2.2.1.1.1.3.3">𝑖</ci></apply></apply><apply id="alg1.l6.m1.3.3.2.2.2.cmml" xref="alg1.l6.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.3.3.2.2.2.1.cmml" xref="alg1.l6.m1.3.3.2.2.2">subscript</csymbol><ci id="alg1.l6.m1.3.3.2.2.2.2.cmml" xref="alg1.l6.m1.3.3.2.2.2.2">𝐹</ci><ci id="alg1.l6.m1.3.3.2.2.2.3.cmml" xref="alg1.l6.m1.3.3.2.2.2.3">𝑖</ci></apply></list><apply id="alg1.l6.m1.6.6.5.cmml" xref="alg1.l6.m1.6.6.5"><times id="alg1.l6.m1.6.6.5.4.cmml" xref="alg1.l6.m1.6.6.5.4"></times><ci id="alg1.l6.m1.6.6.5.5a.cmml" xref="alg1.l6.m1.6.6.5.5"><mtext class="ltx_mathvariant_monospace" id="alg1.l6.m1.6.6.5.5.cmml" xref="alg1.l6.m1.6.6.5.5">FedLocalTrain</mtext></ci><vector id="alg1.l6.m1.6.6.5.3.4.cmml" xref="alg1.l6.m1.6.6.5.3.3"><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">𝐸</ci><apply id="alg1.l6.m1.4.4.3.1.1.1.cmml" xref="alg1.l6.m1.4.4.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.4.4.3.1.1.1.1.cmml" xref="alg1.l6.m1.4.4.3.1.1.1">subscript</csymbol><ci id="alg1.l6.m1.4.4.3.1.1.1.2.cmml" xref="alg1.l6.m1.4.4.3.1.1.1.2">𝜃</ci><ci id="alg1.l6.m1.4.4.3.1.1.1.3.cmml" xref="alg1.l6.m1.4.4.3.1.1.1.3">𝑖</ci></apply><apply id="alg1.l6.m1.5.5.4.2.2.2.cmml" xref="alg1.l6.m1.5.5.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.5.5.4.2.2.2.1.cmml" xref="alg1.l6.m1.5.5.4.2.2.2">subscript</csymbol><ci id="alg1.l6.m1.5.5.4.2.2.2.2.cmml" xref="alg1.l6.m1.5.5.4.2.2.2.2">𝐷</ci><ci id="alg1.l6.m1.5.5.4.2.2.2.3.cmml" xref="alg1.l6.m1.5.5.4.2.2.2.3">𝑖</ci></apply><apply id="alg1.l6.m1.6.6.5.3.3.3.cmml" xref="alg1.l6.m1.6.6.5.3.3.3"><csymbol cd="ambiguous" id="alg1.l6.m1.6.6.5.3.3.3.1.cmml" xref="alg1.l6.m1.6.6.5.3.3.3">subscript</csymbol><ci id="alg1.l6.m1.6.6.5.3.3.3.2.cmml" xref="alg1.l6.m1.6.6.5.3.3.3.2">𝜂</ci><ci id="alg1.l6.m1.6.6.5.3.3.3.3.cmml" xref="alg1.l6.m1.6.6.5.3.3.3.3">𝑐</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.6c">\Delta{\mathbf{\theta}}_{i},F_{i}\leftarrow\texttt{FedLocalTrain}(E,{\mathbf{\theta}}_{i},D_{i},\eta_{c})</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>     <span id="alg1.l7.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l7.3" class="ltx_text ltx_font_bold">for</span>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>     <math id="alg1.l8.m1.1" class="ltx_Math" alttext="{\mathbf{\theta}}_{G}\leftarrow\theta_{G}-\eta_{g}\dfrac{\sum_{i=1}^{N}w_{i}F_{i}^{T}\Delta{\mathbf{\theta}}_{i}}{\sum_{i=1}^{N}w_{i}F_{i}}" display="inline"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><msub id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml"><mi id="alg1.l8.m1.1.1.2.2" xref="alg1.l8.m1.1.1.2.2.cmml">θ</mi><mi id="alg1.l8.m1.1.1.2.3" xref="alg1.l8.m1.1.1.2.3.cmml">G</mi></msub><mo stretchy="false" id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">←</mo><mrow id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml"><msub id="alg1.l8.m1.1.1.3.2" xref="alg1.l8.m1.1.1.3.2.cmml"><mi id="alg1.l8.m1.1.1.3.2.2" xref="alg1.l8.m1.1.1.3.2.2.cmml">θ</mi><mi id="alg1.l8.m1.1.1.3.2.3" xref="alg1.l8.m1.1.1.3.2.3.cmml">G</mi></msub><mo id="alg1.l8.m1.1.1.3.1" xref="alg1.l8.m1.1.1.3.1.cmml">−</mo><mrow id="alg1.l8.m1.1.1.3.3" xref="alg1.l8.m1.1.1.3.3.cmml"><msub id="alg1.l8.m1.1.1.3.3.2" xref="alg1.l8.m1.1.1.3.3.2.cmml"><mi id="alg1.l8.m1.1.1.3.3.2.2" xref="alg1.l8.m1.1.1.3.3.2.2.cmml">η</mi><mi id="alg1.l8.m1.1.1.3.3.2.3" xref="alg1.l8.m1.1.1.3.3.2.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.3.3.1" xref="alg1.l8.m1.1.1.3.3.1.cmml">​</mo><mstyle displaystyle="true" id="alg1.l8.m1.1.1.3.3.3" xref="alg1.l8.m1.1.1.3.3.3.cmml"><mfrac id="alg1.l8.m1.1.1.3.3.3a" xref="alg1.l8.m1.1.1.3.3.3.cmml"><mrow id="alg1.l8.m1.1.1.3.3.3.2" xref="alg1.l8.m1.1.1.3.3.3.2.cmml"><msubsup id="alg1.l8.m1.1.1.3.3.3.2.1" xref="alg1.l8.m1.1.1.3.3.3.2.1.cmml"><mo id="alg1.l8.m1.1.1.3.3.3.2.1.2.2" xref="alg1.l8.m1.1.1.3.3.3.2.1.2.2.cmml">∑</mo><mrow id="alg1.l8.m1.1.1.3.3.3.2.1.2.3" xref="alg1.l8.m1.1.1.3.3.3.2.1.2.3.cmml"><mi id="alg1.l8.m1.1.1.3.3.3.2.1.2.3.2" xref="alg1.l8.m1.1.1.3.3.3.2.1.2.3.2.cmml">i</mi><mo id="alg1.l8.m1.1.1.3.3.3.2.1.2.3.1" xref="alg1.l8.m1.1.1.3.3.3.2.1.2.3.1.cmml">=</mo><mn id="alg1.l8.m1.1.1.3.3.3.2.1.2.3.3" xref="alg1.l8.m1.1.1.3.3.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.l8.m1.1.1.3.3.3.2.1.3" xref="alg1.l8.m1.1.1.3.3.3.2.1.3.cmml">N</mi></msubsup><mrow id="alg1.l8.m1.1.1.3.3.3.2.2" xref="alg1.l8.m1.1.1.3.3.3.2.2.cmml"><msub id="alg1.l8.m1.1.1.3.3.3.2.2.2" xref="alg1.l8.m1.1.1.3.3.3.2.2.2.cmml"><mi id="alg1.l8.m1.1.1.3.3.3.2.2.2.2" xref="alg1.l8.m1.1.1.3.3.3.2.2.2.2.cmml">w</mi><mi id="alg1.l8.m1.1.1.3.3.3.2.2.2.3" xref="alg1.l8.m1.1.1.3.3.3.2.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.3.3.3.2.2.1" xref="alg1.l8.m1.1.1.3.3.3.2.2.1.cmml">​</mo><msubsup id="alg1.l8.m1.1.1.3.3.3.2.2.3" xref="alg1.l8.m1.1.1.3.3.3.2.2.3.cmml"><mi id="alg1.l8.m1.1.1.3.3.3.2.2.3.2.2" xref="alg1.l8.m1.1.1.3.3.3.2.2.3.2.2.cmml">F</mi><mi id="alg1.l8.m1.1.1.3.3.3.2.2.3.2.3" xref="alg1.l8.m1.1.1.3.3.3.2.2.3.2.3.cmml">i</mi><mi id="alg1.l8.m1.1.1.3.3.3.2.2.3.3" xref="alg1.l8.m1.1.1.3.3.3.2.2.3.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.3.3.3.2.2.1a" xref="alg1.l8.m1.1.1.3.3.3.2.2.1.cmml">​</mo><mi mathvariant="normal" id="alg1.l8.m1.1.1.3.3.3.2.2.4" xref="alg1.l8.m1.1.1.3.3.3.2.2.4.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.3.3.3.2.2.1b" xref="alg1.l8.m1.1.1.3.3.3.2.2.1.cmml">​</mo><msub id="alg1.l8.m1.1.1.3.3.3.2.2.5" xref="alg1.l8.m1.1.1.3.3.3.2.2.5.cmml"><mi id="alg1.l8.m1.1.1.3.3.3.2.2.5.2" xref="alg1.l8.m1.1.1.3.3.3.2.2.5.2.cmml">θ</mi><mi id="alg1.l8.m1.1.1.3.3.3.2.2.5.3" xref="alg1.l8.m1.1.1.3.3.3.2.2.5.3.cmml">i</mi></msub></mrow></mrow><mrow id="alg1.l8.m1.1.1.3.3.3.3" xref="alg1.l8.m1.1.1.3.3.3.3.cmml"><msubsup id="alg1.l8.m1.1.1.3.3.3.3.1" xref="alg1.l8.m1.1.1.3.3.3.3.1.cmml"><mo id="alg1.l8.m1.1.1.3.3.3.3.1.2.2" xref="alg1.l8.m1.1.1.3.3.3.3.1.2.2.cmml">∑</mo><mrow id="alg1.l8.m1.1.1.3.3.3.3.1.2.3" xref="alg1.l8.m1.1.1.3.3.3.3.1.2.3.cmml"><mi id="alg1.l8.m1.1.1.3.3.3.3.1.2.3.2" xref="alg1.l8.m1.1.1.3.3.3.3.1.2.3.2.cmml">i</mi><mo id="alg1.l8.m1.1.1.3.3.3.3.1.2.3.1" xref="alg1.l8.m1.1.1.3.3.3.3.1.2.3.1.cmml">=</mo><mn id="alg1.l8.m1.1.1.3.3.3.3.1.2.3.3" xref="alg1.l8.m1.1.1.3.3.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.l8.m1.1.1.3.3.3.3.1.3" xref="alg1.l8.m1.1.1.3.3.3.3.1.3.cmml">N</mi></msubsup><mrow id="alg1.l8.m1.1.1.3.3.3.3.2" xref="alg1.l8.m1.1.1.3.3.3.3.2.cmml"><msub id="alg1.l8.m1.1.1.3.3.3.3.2.2" xref="alg1.l8.m1.1.1.3.3.3.3.2.2.cmml"><mi id="alg1.l8.m1.1.1.3.3.3.3.2.2.2" xref="alg1.l8.m1.1.1.3.3.3.3.2.2.2.cmml">w</mi><mi id="alg1.l8.m1.1.1.3.3.3.3.2.2.3" xref="alg1.l8.m1.1.1.3.3.3.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.3.3.3.3.2.1" xref="alg1.l8.m1.1.1.3.3.3.3.2.1.cmml">​</mo><msub id="alg1.l8.m1.1.1.3.3.3.3.2.3" xref="alg1.l8.m1.1.1.3.3.3.3.2.3.cmml"><mi id="alg1.l8.m1.1.1.3.3.3.3.2.3.2" xref="alg1.l8.m1.1.1.3.3.3.3.2.3.2.cmml">F</mi><mi id="alg1.l8.m1.1.1.3.3.3.3.2.3.3" xref="alg1.l8.m1.1.1.3.3.3.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mfrac></mstyle></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><ci id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1">←</ci><apply id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.2.1.cmml" xref="alg1.l8.m1.1.1.2">subscript</csymbol><ci id="alg1.l8.m1.1.1.2.2.cmml" xref="alg1.l8.m1.1.1.2.2">𝜃</ci><ci id="alg1.l8.m1.1.1.2.3.cmml" xref="alg1.l8.m1.1.1.2.3">𝐺</ci></apply><apply id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3"><minus id="alg1.l8.m1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.3.1"></minus><apply id="alg1.l8.m1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.2.1.cmml" xref="alg1.l8.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l8.m1.1.1.3.2.2.cmml" xref="alg1.l8.m1.1.1.3.2.2">𝜃</ci><ci id="alg1.l8.m1.1.1.3.2.3.cmml" xref="alg1.l8.m1.1.1.3.2.3">𝐺</ci></apply><apply id="alg1.l8.m1.1.1.3.3.cmml" xref="alg1.l8.m1.1.1.3.3"><times id="alg1.l8.m1.1.1.3.3.1.cmml" xref="alg1.l8.m1.1.1.3.3.1"></times><apply id="alg1.l8.m1.1.1.3.3.2.cmml" xref="alg1.l8.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.3.2.1.cmml" xref="alg1.l8.m1.1.1.3.3.2">subscript</csymbol><ci id="alg1.l8.m1.1.1.3.3.2.2.cmml" xref="alg1.l8.m1.1.1.3.3.2.2">𝜂</ci><ci id="alg1.l8.m1.1.1.3.3.2.3.cmml" xref="alg1.l8.m1.1.1.3.3.2.3">𝑔</ci></apply><apply id="alg1.l8.m1.1.1.3.3.3.cmml" xref="alg1.l8.m1.1.1.3.3.3"><divide id="alg1.l8.m1.1.1.3.3.3.1.cmml" xref="alg1.l8.m1.1.1.3.3.3"></divide><apply id="alg1.l8.m1.1.1.3.3.3.2.cmml" xref="alg1.l8.m1.1.1.3.3.3.2"><apply id="alg1.l8.m1.1.1.3.3.3.2.1.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.3.3.2.1.1.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.1">superscript</csymbol><apply id="alg1.l8.m1.1.1.3.3.3.2.1.2.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.3.3.2.1.2.1.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.1">subscript</csymbol><sum id="alg1.l8.m1.1.1.3.3.3.2.1.2.2.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.1.2.2"></sum><apply id="alg1.l8.m1.1.1.3.3.3.2.1.2.3.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.1.2.3"><eq id="alg1.l8.m1.1.1.3.3.3.2.1.2.3.1.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.1.2.3.1"></eq><ci id="alg1.l8.m1.1.1.3.3.3.2.1.2.3.2.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.1.2.3.2">𝑖</ci><cn type="integer" id="alg1.l8.m1.1.1.3.3.3.2.1.2.3.3.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.1.2.3.3">1</cn></apply></apply><ci id="alg1.l8.m1.1.1.3.3.3.2.1.3.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.1.3">𝑁</ci></apply><apply id="alg1.l8.m1.1.1.3.3.3.2.2.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.2"><times id="alg1.l8.m1.1.1.3.3.3.2.2.1.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.2.1"></times><apply id="alg1.l8.m1.1.1.3.3.3.2.2.2.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.3.3.2.2.2.1.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.2.2">subscript</csymbol><ci id="alg1.l8.m1.1.1.3.3.3.2.2.2.2.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.2.2.2">𝑤</ci><ci id="alg1.l8.m1.1.1.3.3.3.2.2.2.3.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.2.2.3">𝑖</ci></apply><apply id="alg1.l8.m1.1.1.3.3.3.2.2.3.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.3.3.2.2.3.1.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.2.3">superscript</csymbol><apply id="alg1.l8.m1.1.1.3.3.3.2.2.3.2.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.3.3.2.2.3.2.1.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.2.3">subscript</csymbol><ci id="alg1.l8.m1.1.1.3.3.3.2.2.3.2.2.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.2.3.2.2">𝐹</ci><ci id="alg1.l8.m1.1.1.3.3.3.2.2.3.2.3.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.2.3.2.3">𝑖</ci></apply><ci id="alg1.l8.m1.1.1.3.3.3.2.2.3.3.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.2.3.3">𝑇</ci></apply><ci id="alg1.l8.m1.1.1.3.3.3.2.2.4.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.2.4">Δ</ci><apply id="alg1.l8.m1.1.1.3.3.3.2.2.5.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.2.5"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.3.3.2.2.5.1.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.2.5">subscript</csymbol><ci id="alg1.l8.m1.1.1.3.3.3.2.2.5.2.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.2.5.2">𝜃</ci><ci id="alg1.l8.m1.1.1.3.3.3.2.2.5.3.cmml" xref="alg1.l8.m1.1.1.3.3.3.2.2.5.3">𝑖</ci></apply></apply></apply><apply id="alg1.l8.m1.1.1.3.3.3.3.cmml" xref="alg1.l8.m1.1.1.3.3.3.3"><apply id="alg1.l8.m1.1.1.3.3.3.3.1.cmml" xref="alg1.l8.m1.1.1.3.3.3.3.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.3.3.3.1.1.cmml" xref="alg1.l8.m1.1.1.3.3.3.3.1">superscript</csymbol><apply id="alg1.l8.m1.1.1.3.3.3.3.1.2.cmml" xref="alg1.l8.m1.1.1.3.3.3.3.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.3.3.3.1.2.1.cmml" xref="alg1.l8.m1.1.1.3.3.3.3.1">subscript</csymbol><sum id="alg1.l8.m1.1.1.3.3.3.3.1.2.2.cmml" xref="alg1.l8.m1.1.1.3.3.3.3.1.2.2"></sum><apply id="alg1.l8.m1.1.1.3.3.3.3.1.2.3.cmml" xref="alg1.l8.m1.1.1.3.3.3.3.1.2.3"><eq id="alg1.l8.m1.1.1.3.3.3.3.1.2.3.1.cmml" xref="alg1.l8.m1.1.1.3.3.3.3.1.2.3.1"></eq><ci id="alg1.l8.m1.1.1.3.3.3.3.1.2.3.2.cmml" xref="alg1.l8.m1.1.1.3.3.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="alg1.l8.m1.1.1.3.3.3.3.1.2.3.3.cmml" xref="alg1.l8.m1.1.1.3.3.3.3.1.2.3.3">1</cn></apply></apply><ci id="alg1.l8.m1.1.1.3.3.3.3.1.3.cmml" xref="alg1.l8.m1.1.1.3.3.3.3.1.3">𝑁</ci></apply><apply id="alg1.l8.m1.1.1.3.3.3.3.2.cmml" xref="alg1.l8.m1.1.1.3.3.3.3.2"><times id="alg1.l8.m1.1.1.3.3.3.3.2.1.cmml" xref="alg1.l8.m1.1.1.3.3.3.3.2.1"></times><apply id="alg1.l8.m1.1.1.3.3.3.3.2.2.cmml" xref="alg1.l8.m1.1.1.3.3.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.3.3.3.2.2.1.cmml" xref="alg1.l8.m1.1.1.3.3.3.3.2.2">subscript</csymbol><ci id="alg1.l8.m1.1.1.3.3.3.3.2.2.2.cmml" xref="alg1.l8.m1.1.1.3.3.3.3.2.2.2">𝑤</ci><ci id="alg1.l8.m1.1.1.3.3.3.3.2.2.3.cmml" xref="alg1.l8.m1.1.1.3.3.3.3.2.2.3">𝑖</ci></apply><apply id="alg1.l8.m1.1.1.3.3.3.3.2.3.cmml" xref="alg1.l8.m1.1.1.3.3.3.3.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.3.3.3.2.3.1.cmml" xref="alg1.l8.m1.1.1.3.3.3.3.2.3">subscript</csymbol><ci id="alg1.l8.m1.1.1.3.3.3.3.2.3.2.cmml" xref="alg1.l8.m1.1.1.3.3.3.3.2.3.2">𝐹</ci><ci id="alg1.l8.m1.1.1.3.3.3.3.2.3.3.cmml" xref="alg1.l8.m1.1.1.3.3.3.3.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">{\mathbf{\theta}}_{G}\leftarrow\theta_{G}-\eta_{g}\dfrac{\sum_{i=1}^{N}w_{i}F_{i}^{T}\Delta{\mathbf{\theta}}_{i}}{\sum_{i=1}^{N}w_{i}F_{i}}</annotation></semantics></math>


</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>  <span id="alg1.l9.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l9.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>  <span id="alg1.l10.2" class="ltx_text ltx_font_bold">return</span>  <math id="alg1.l10.m1.1" class="ltx_Math" alttext="{\mathbf{\theta}}_{G}" display="inline"><semantics id="alg1.l10.m1.1a"><msub id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">θ</mi><mi id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1">subscript</csymbol><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝜃</ci><ci id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">{\mathbf{\theta}}_{G}</annotation></semantics></math>

</div>
</div>
</figure>
<figure id="alg2" class="ltx_float ltx_minipage ltx_align_middle ltx_framed ltx_framed_top" style="width:230.2pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_float"><span id="alg2.2.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> FedLocalTrain (SGD)</figcaption>
<div id="alg2.3" class="ltx_listing ltx_align_center ltx_listing">
<div id="alg2.l0" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l0.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>  <math id="alg2.l0.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg2.l0.m1.1a"><mi id="alg2.l0.m1.1.1" xref="alg2.l0.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m1.1b"><ci id="alg2.l0.m1.1.1.cmml" xref="alg2.l0.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m1.1c">E</annotation></semantics></math>, <math id="alg2.l0.m2.1" class="ltx_Math" alttext="{\mathbf{\theta}}_{i}" display="inline"><semantics id="alg2.l0.m2.1a"><msub id="alg2.l0.m2.1.1" xref="alg2.l0.m2.1.1.cmml"><mi id="alg2.l0.m2.1.1.2" xref="alg2.l0.m2.1.1.2.cmml">θ</mi><mi id="alg2.l0.m2.1.1.3" xref="alg2.l0.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l0.m2.1b"><apply id="alg2.l0.m2.1.1.cmml" xref="alg2.l0.m2.1.1"><csymbol cd="ambiguous" id="alg2.l0.m2.1.1.1.cmml" xref="alg2.l0.m2.1.1">subscript</csymbol><ci id="alg2.l0.m2.1.1.2.cmml" xref="alg2.l0.m2.1.1.2">𝜃</ci><ci id="alg2.l0.m2.1.1.3.cmml" xref="alg2.l0.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m2.1c">{\mathbf{\theta}}_{i}</annotation></semantics></math>, <math id="alg2.l0.m3.2" class="ltx_Math" alttext="D_{i},\eta_{c}" display="inline"><semantics id="alg2.l0.m3.2a"><mrow id="alg2.l0.m3.2.2.2" xref="alg2.l0.m3.2.2.3.cmml"><msub id="alg2.l0.m3.1.1.1.1" xref="alg2.l0.m3.1.1.1.1.cmml"><mi id="alg2.l0.m3.1.1.1.1.2" xref="alg2.l0.m3.1.1.1.1.2.cmml">D</mi><mi id="alg2.l0.m3.1.1.1.1.3" xref="alg2.l0.m3.1.1.1.1.3.cmml">i</mi></msub><mo id="alg2.l0.m3.2.2.2.3" xref="alg2.l0.m3.2.2.3.cmml">,</mo><msub id="alg2.l0.m3.2.2.2.2" xref="alg2.l0.m3.2.2.2.2.cmml"><mi id="alg2.l0.m3.2.2.2.2.2" xref="alg2.l0.m3.2.2.2.2.2.cmml">η</mi><mi id="alg2.l0.m3.2.2.2.2.3" xref="alg2.l0.m3.2.2.2.2.3.cmml">c</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l0.m3.2b"><list id="alg2.l0.m3.2.2.3.cmml" xref="alg2.l0.m3.2.2.2"><apply id="alg2.l0.m3.1.1.1.1.cmml" xref="alg2.l0.m3.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l0.m3.1.1.1.1.1.cmml" xref="alg2.l0.m3.1.1.1.1">subscript</csymbol><ci id="alg2.l0.m3.1.1.1.1.2.cmml" xref="alg2.l0.m3.1.1.1.1.2">𝐷</ci><ci id="alg2.l0.m3.1.1.1.1.3.cmml" xref="alg2.l0.m3.1.1.1.1.3">𝑖</ci></apply><apply id="alg2.l0.m3.2.2.2.2.cmml" xref="alg2.l0.m3.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l0.m3.2.2.2.2.1.cmml" xref="alg2.l0.m3.2.2.2.2">subscript</csymbol><ci id="alg2.l0.m3.2.2.2.2.2.cmml" xref="alg2.l0.m3.2.2.2.2.2">𝜂</ci><ci id="alg2.l0.m3.2.2.2.2.3.cmml" xref="alg2.l0.m3.2.2.2.2.3">𝑐</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m3.2c">D_{i},\eta_{c}</annotation></semantics></math>

</div>
<div id="alg2.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  <math id="alg2.l1.m1.4" class="ltx_Math" alttext="\texttt{ModelDelta},\texttt{SumFisher}\leftarrow 0,0" display="inline"><semantics id="alg2.l1.m1.4a"><mrow id="alg2.l1.m1.4.4.1" xref="alg2.l1.m1.4.4.2.cmml"><mrow id="alg2.l1.m1.4.4.1.1" xref="alg2.l1.m1.4.4.1.1.cmml"><mrow id="alg2.l1.m1.4.4.1.1.2.2" xref="alg2.l1.m1.4.4.1.1.2.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1a.cmml">ModelDelta</mtext><mo id="alg2.l1.m1.4.4.1.1.2.2.1" xref="alg2.l1.m1.4.4.1.1.2.1.cmml">,</mo><mtext class="ltx_mathvariant_monospace" id="alg2.l1.m1.2.2" xref="alg2.l1.m1.2.2a.cmml">SumFisher</mtext></mrow><mo stretchy="false" id="alg2.l1.m1.4.4.1.1.1" xref="alg2.l1.m1.4.4.1.1.1.cmml">←</mo><mn id="alg2.l1.m1.4.4.1.1.3" xref="alg2.l1.m1.4.4.1.1.3.cmml">0</mn></mrow><mo id="alg2.l1.m1.4.4.1.2" xref="alg2.l1.m1.4.4.2a.cmml">,</mo><mn id="alg2.l1.m1.3.3" xref="alg2.l1.m1.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.4b"><apply id="alg2.l1.m1.4.4.2.cmml" xref="alg2.l1.m1.4.4.1"><csymbol cd="ambiguous" id="alg2.l1.m1.4.4.2a.cmml" xref="alg2.l1.m1.4.4.1.2">formulae-sequence</csymbol><apply id="alg2.l1.m1.4.4.1.1.cmml" xref="alg2.l1.m1.4.4.1.1"><ci id="alg2.l1.m1.4.4.1.1.1.cmml" xref="alg2.l1.m1.4.4.1.1.1">←</ci><list id="alg2.l1.m1.4.4.1.1.2.1.cmml" xref="alg2.l1.m1.4.4.1.1.2.2"><ci id="alg2.l1.m1.1.1a.cmml" xref="alg2.l1.m1.1.1"><mtext class="ltx_mathvariant_monospace" id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1">ModelDelta</mtext></ci><ci id="alg2.l1.m1.2.2a.cmml" xref="alg2.l1.m1.2.2"><mtext class="ltx_mathvariant_monospace" id="alg2.l1.m1.2.2.cmml" xref="alg2.l1.m1.2.2">SumFisher</mtext></ci></list><cn type="integer" id="alg2.l1.m1.4.4.1.1.3.cmml" xref="alg2.l1.m1.4.4.1.1.3">0</cn></apply><cn type="integer" id="alg2.l1.m1.3.3.cmml" xref="alg2.l1.m1.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.4c">\texttt{ModelDelta},\texttt{SumFisher}\leftarrow 0,0</annotation></semantics></math>

</div>
<div id="alg2.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  <span id="alg2.l2.2" class="ltx_text ltx_font_bold">for</span> <math id="alg2.l2.m1.1" class="ltx_Math" alttext="e\leftarrow 1" display="inline"><semantics id="alg2.l2.m1.1a"><mrow id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml"><mi id="alg2.l2.m1.1.1.2" xref="alg2.l2.m1.1.1.2.cmml">e</mi><mo stretchy="false" id="alg2.l2.m1.1.1.1" xref="alg2.l2.m1.1.1.1.cmml">←</mo><mn id="alg2.l2.m1.1.1.3" xref="alg2.l2.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><apply id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1"><ci id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1">←</ci><ci id="alg2.l2.m1.1.1.2.cmml" xref="alg2.l2.m1.1.1.2">𝑒</ci><cn type="integer" id="alg2.l2.m1.1.1.3.cmml" xref="alg2.l2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">e\leftarrow 1</annotation></semantics></math> to <math id="alg2.l2.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg2.l2.m2.1a"><mi id="alg2.l2.m2.1.1" xref="alg2.l2.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg2.l2.m2.1b"><ci id="alg2.l2.m2.1.1.cmml" xref="alg2.l2.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m2.1c">E</annotation></semantics></math> <span id="alg2.l2.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>     <span id="alg2.l3.2" class="ltx_text ltx_font_bold">for</span> <math id="alg2.l3.m1.1" class="ltx_Math" alttext="b\in D_{i}" display="inline"><semantics id="alg2.l3.m1.1a"><mrow id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml"><mi id="alg2.l3.m1.1.1.2" xref="alg2.l3.m1.1.1.2.cmml">b</mi><mo id="alg2.l3.m1.1.1.1" xref="alg2.l3.m1.1.1.1.cmml">∈</mo><msub id="alg2.l3.m1.1.1.3" xref="alg2.l3.m1.1.1.3.cmml"><mi id="alg2.l3.m1.1.1.3.2" xref="alg2.l3.m1.1.1.3.2.cmml">D</mi><mi id="alg2.l3.m1.1.1.3.3" xref="alg2.l3.m1.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"><in id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1"></in><ci id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1.2">𝑏</ci><apply id="alg2.l3.m1.1.1.3.cmml" xref="alg2.l3.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.3.1.cmml" xref="alg2.l3.m1.1.1.3">subscript</csymbol><ci id="alg2.l3.m1.1.1.3.2.cmml" xref="alg2.l3.m1.1.1.3.2">𝐷</ci><ci id="alg2.l3.m1.1.1.3.3.cmml" xref="alg2.l3.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">b\in D_{i}</annotation></semantics></math> <span id="alg2.l3.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>        <math id="alg2.l4.m1.2" class="ltx_Math" alttext="g\leftarrow\nabla_{{\mathbf{\theta}}}\mathcal{L}({\mathbf{\theta}}_{i},b)" display="inline"><semantics id="alg2.l4.m1.2a"><mrow id="alg2.l4.m1.2.2" xref="alg2.l4.m1.2.2.cmml"><mi id="alg2.l4.m1.2.2.3" xref="alg2.l4.m1.2.2.3.cmml">g</mi><mo stretchy="false" id="alg2.l4.m1.2.2.2" xref="alg2.l4.m1.2.2.2.cmml">←</mo><mrow id="alg2.l4.m1.2.2.1" xref="alg2.l4.m1.2.2.1.cmml"><mrow id="alg2.l4.m1.2.2.1.3" xref="alg2.l4.m1.2.2.1.3.cmml"><msub id="alg2.l4.m1.2.2.1.3.1" xref="alg2.l4.m1.2.2.1.3.1.cmml"><mo rspace="0.167em" id="alg2.l4.m1.2.2.1.3.1.2" xref="alg2.l4.m1.2.2.1.3.1.2.cmml">∇</mo><mi id="alg2.l4.m1.2.2.1.3.1.3" xref="alg2.l4.m1.2.2.1.3.1.3.cmml">θ</mi></msub><mi class="ltx_font_mathcaligraphic" id="alg2.l4.m1.2.2.1.3.2" xref="alg2.l4.m1.2.2.1.3.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="alg2.l4.m1.2.2.1.2" xref="alg2.l4.m1.2.2.1.2.cmml">​</mo><mrow id="alg2.l4.m1.2.2.1.1.1" xref="alg2.l4.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg2.l4.m1.2.2.1.1.1.2" xref="alg2.l4.m1.2.2.1.1.2.cmml">(</mo><msub id="alg2.l4.m1.2.2.1.1.1.1" xref="alg2.l4.m1.2.2.1.1.1.1.cmml"><mi id="alg2.l4.m1.2.2.1.1.1.1.2" xref="alg2.l4.m1.2.2.1.1.1.1.2.cmml">θ</mi><mi id="alg2.l4.m1.2.2.1.1.1.1.3" xref="alg2.l4.m1.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="alg2.l4.m1.2.2.1.1.1.3" xref="alg2.l4.m1.2.2.1.1.2.cmml">,</mo><mi id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml">b</mi><mo stretchy="false" id="alg2.l4.m1.2.2.1.1.1.4" xref="alg2.l4.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.2b"><apply id="alg2.l4.m1.2.2.cmml" xref="alg2.l4.m1.2.2"><ci id="alg2.l4.m1.2.2.2.cmml" xref="alg2.l4.m1.2.2.2">←</ci><ci id="alg2.l4.m1.2.2.3.cmml" xref="alg2.l4.m1.2.2.3">𝑔</ci><apply id="alg2.l4.m1.2.2.1.cmml" xref="alg2.l4.m1.2.2.1"><times id="alg2.l4.m1.2.2.1.2.cmml" xref="alg2.l4.m1.2.2.1.2"></times><apply id="alg2.l4.m1.2.2.1.3.cmml" xref="alg2.l4.m1.2.2.1.3"><apply id="alg2.l4.m1.2.2.1.3.1.cmml" xref="alg2.l4.m1.2.2.1.3.1"><csymbol cd="ambiguous" id="alg2.l4.m1.2.2.1.3.1.1.cmml" xref="alg2.l4.m1.2.2.1.3.1">subscript</csymbol><ci id="alg2.l4.m1.2.2.1.3.1.2.cmml" xref="alg2.l4.m1.2.2.1.3.1.2">∇</ci><ci id="alg2.l4.m1.2.2.1.3.1.3.cmml" xref="alg2.l4.m1.2.2.1.3.1.3">𝜃</ci></apply><ci id="alg2.l4.m1.2.2.1.3.2.cmml" xref="alg2.l4.m1.2.2.1.3.2">ℒ</ci></apply><interval closure="open" id="alg2.l4.m1.2.2.1.1.2.cmml" xref="alg2.l4.m1.2.2.1.1.1"><apply id="alg2.l4.m1.2.2.1.1.1.1.cmml" xref="alg2.l4.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l4.m1.2.2.1.1.1.1.1.cmml" xref="alg2.l4.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg2.l4.m1.2.2.1.1.1.1.2.cmml" xref="alg2.l4.m1.2.2.1.1.1.1.2">𝜃</ci><ci id="alg2.l4.m1.2.2.1.1.1.1.3.cmml" xref="alg2.l4.m1.2.2.1.1.1.1.3">𝑖</ci></apply><ci id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1">𝑏</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.2c">g\leftarrow\nabla_{{\mathbf{\theta}}}\mathcal{L}({\mathbf{\theta}}_{i},b)</annotation></semantics></math>

</div>
<div id="alg2.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>        <math id="alg2.l5.m1.1" class="ltx_Math" alttext="{\mathbf{\theta}}_{i}\leftarrow{\mathbf{\theta}}_{i}-\eta_{c}~{}g" display="inline"><semantics id="alg2.l5.m1.1a"><mrow id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml"><msub id="alg2.l5.m1.1.1.2" xref="alg2.l5.m1.1.1.2.cmml"><mi id="alg2.l5.m1.1.1.2.2" xref="alg2.l5.m1.1.1.2.2.cmml">θ</mi><mi id="alg2.l5.m1.1.1.2.3" xref="alg2.l5.m1.1.1.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg2.l5.m1.1.1.1" xref="alg2.l5.m1.1.1.1.cmml">←</mo><mrow id="alg2.l5.m1.1.1.3" xref="alg2.l5.m1.1.1.3.cmml"><msub id="alg2.l5.m1.1.1.3.2" xref="alg2.l5.m1.1.1.3.2.cmml"><mi id="alg2.l5.m1.1.1.3.2.2" xref="alg2.l5.m1.1.1.3.2.2.cmml">θ</mi><mi id="alg2.l5.m1.1.1.3.2.3" xref="alg2.l5.m1.1.1.3.2.3.cmml">i</mi></msub><mo id="alg2.l5.m1.1.1.3.1" xref="alg2.l5.m1.1.1.3.1.cmml">−</mo><mrow id="alg2.l5.m1.1.1.3.3" xref="alg2.l5.m1.1.1.3.3.cmml"><msub id="alg2.l5.m1.1.1.3.3.2" xref="alg2.l5.m1.1.1.3.3.2.cmml"><mi id="alg2.l5.m1.1.1.3.3.2.2" xref="alg2.l5.m1.1.1.3.3.2.2.cmml">η</mi><mi id="alg2.l5.m1.1.1.3.3.2.3" xref="alg2.l5.m1.1.1.3.3.2.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="alg2.l5.m1.1.1.3.3.1" xref="alg2.l5.m1.1.1.3.3.1.cmml">​</mo><mi id="alg2.l5.m1.1.1.3.3.3" xref="alg2.l5.m1.1.1.3.3.3.cmml">g</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><apply id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1"><ci id="alg2.l5.m1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1">←</ci><apply id="alg2.l5.m1.1.1.2.cmml" xref="alg2.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.2.1.cmml" xref="alg2.l5.m1.1.1.2">subscript</csymbol><ci id="alg2.l5.m1.1.1.2.2.cmml" xref="alg2.l5.m1.1.1.2.2">𝜃</ci><ci id="alg2.l5.m1.1.1.2.3.cmml" xref="alg2.l5.m1.1.1.2.3">𝑖</ci></apply><apply id="alg2.l5.m1.1.1.3.cmml" xref="alg2.l5.m1.1.1.3"><minus id="alg2.l5.m1.1.1.3.1.cmml" xref="alg2.l5.m1.1.1.3.1"></minus><apply id="alg2.l5.m1.1.1.3.2.cmml" xref="alg2.l5.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.3.2.1.cmml" xref="alg2.l5.m1.1.1.3.2">subscript</csymbol><ci id="alg2.l5.m1.1.1.3.2.2.cmml" xref="alg2.l5.m1.1.1.3.2.2">𝜃</ci><ci id="alg2.l5.m1.1.1.3.2.3.cmml" xref="alg2.l5.m1.1.1.3.2.3">𝑖</ci></apply><apply id="alg2.l5.m1.1.1.3.3.cmml" xref="alg2.l5.m1.1.1.3.3"><times id="alg2.l5.m1.1.1.3.3.1.cmml" xref="alg2.l5.m1.1.1.3.3.1"></times><apply id="alg2.l5.m1.1.1.3.3.2.cmml" xref="alg2.l5.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.3.3.2.1.cmml" xref="alg2.l5.m1.1.1.3.3.2">subscript</csymbol><ci id="alg2.l5.m1.1.1.3.3.2.2.cmml" xref="alg2.l5.m1.1.1.3.3.2.2">𝜂</ci><ci id="alg2.l5.m1.1.1.3.3.2.3.cmml" xref="alg2.l5.m1.1.1.3.3.2.3">𝑐</ci></apply><ci id="alg2.l5.m1.1.1.3.3.3.cmml" xref="alg2.l5.m1.1.1.3.3.3">𝑔</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">{\mathbf{\theta}}_{i}\leftarrow{\mathbf{\theta}}_{i}-\eta_{c}~{}g</annotation></semantics></math>

</div>
<div id="alg2.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>        <math id="alg2.l6.m1.1" class="ltx_Math" alttext="\texttt{ModelDelta}\leftarrow\texttt{ModelDelta}+\eta_{c}~{}g" display="inline"><semantics id="alg2.l6.m1.1a"><mrow id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg2.l6.m1.1.1.2" xref="alg2.l6.m1.1.1.2a.cmml">ModelDelta</mtext><mo stretchy="false" id="alg2.l6.m1.1.1.1" xref="alg2.l6.m1.1.1.1.cmml">←</mo><mrow id="alg2.l6.m1.1.1.3" xref="alg2.l6.m1.1.1.3.cmml"><mtext class="ltx_mathvariant_monospace" id="alg2.l6.m1.1.1.3.2" xref="alg2.l6.m1.1.1.3.2a.cmml">ModelDelta</mtext><mo id="alg2.l6.m1.1.1.3.1" xref="alg2.l6.m1.1.1.3.1.cmml">+</mo><mrow id="alg2.l6.m1.1.1.3.3" xref="alg2.l6.m1.1.1.3.3.cmml"><msub id="alg2.l6.m1.1.1.3.3.2" xref="alg2.l6.m1.1.1.3.3.2.cmml"><mi id="alg2.l6.m1.1.1.3.3.2.2" xref="alg2.l6.m1.1.1.3.3.2.2.cmml">η</mi><mi id="alg2.l6.m1.1.1.3.3.2.3" xref="alg2.l6.m1.1.1.3.3.2.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="alg2.l6.m1.1.1.3.3.1" xref="alg2.l6.m1.1.1.3.3.1.cmml">​</mo><mi id="alg2.l6.m1.1.1.3.3.3" xref="alg2.l6.m1.1.1.3.3.3.cmml">g</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><apply id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1"><ci id="alg2.l6.m1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1">←</ci><ci id="alg2.l6.m1.1.1.2a.cmml" xref="alg2.l6.m1.1.1.2"><mtext class="ltx_mathvariant_monospace" id="alg2.l6.m1.1.1.2.cmml" xref="alg2.l6.m1.1.1.2">ModelDelta</mtext></ci><apply id="alg2.l6.m1.1.1.3.cmml" xref="alg2.l6.m1.1.1.3"><plus id="alg2.l6.m1.1.1.3.1.cmml" xref="alg2.l6.m1.1.1.3.1"></plus><ci id="alg2.l6.m1.1.1.3.2a.cmml" xref="alg2.l6.m1.1.1.3.2"><mtext class="ltx_mathvariant_monospace" id="alg2.l6.m1.1.1.3.2.cmml" xref="alg2.l6.m1.1.1.3.2">ModelDelta</mtext></ci><apply id="alg2.l6.m1.1.1.3.3.cmml" xref="alg2.l6.m1.1.1.3.3"><times id="alg2.l6.m1.1.1.3.3.1.cmml" xref="alg2.l6.m1.1.1.3.3.1"></times><apply id="alg2.l6.m1.1.1.3.3.2.cmml" xref="alg2.l6.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.3.3.2.1.cmml" xref="alg2.l6.m1.1.1.3.3.2">subscript</csymbol><ci id="alg2.l6.m1.1.1.3.3.2.2.cmml" xref="alg2.l6.m1.1.1.3.3.2.2">𝜂</ci><ci id="alg2.l6.m1.1.1.3.3.2.3.cmml" xref="alg2.l6.m1.1.1.3.3.2.3">𝑐</ci></apply><ci id="alg2.l6.m1.1.1.3.3.3.cmml" xref="alg2.l6.m1.1.1.3.3.3">𝑔</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">\texttt{ModelDelta}\leftarrow\texttt{ModelDelta}+\eta_{c}~{}g</annotation></semantics></math>

</div>
<div id="alg2.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>     <span id="alg2.l7.2" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l7.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>  <span id="alg2.l8.2" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l8.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>  <span id="alg2.l9.2" class="ltx_text ltx_font_bold">for</span> <math id="alg2.l9.m1.1" class="ltx_Math" alttext="b\in D_{i}" display="inline"><semantics id="alg2.l9.m1.1a"><mrow id="alg2.l9.m1.1.1" xref="alg2.l9.m1.1.1.cmml"><mi id="alg2.l9.m1.1.1.2" xref="alg2.l9.m1.1.1.2.cmml">b</mi><mo id="alg2.l9.m1.1.1.1" xref="alg2.l9.m1.1.1.1.cmml">∈</mo><msub id="alg2.l9.m1.1.1.3" xref="alg2.l9.m1.1.1.3.cmml"><mi id="alg2.l9.m1.1.1.3.2" xref="alg2.l9.m1.1.1.3.2.cmml">D</mi><mi id="alg2.l9.m1.1.1.3.3" xref="alg2.l9.m1.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.1b"><apply id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1"><in id="alg2.l9.m1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1"></in><ci id="alg2.l9.m1.1.1.2.cmml" xref="alg2.l9.m1.1.1.2">𝑏</ci><apply id="alg2.l9.m1.1.1.3.cmml" xref="alg2.l9.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.3.1.cmml" xref="alg2.l9.m1.1.1.3">subscript</csymbol><ci id="alg2.l9.m1.1.1.3.2.cmml" xref="alg2.l9.m1.1.1.3.2">𝐷</ci><ci id="alg2.l9.m1.1.1.3.3.cmml" xref="alg2.l9.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.1c">b\in D_{i}</annotation></semantics></math> <span id="alg2.l9.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>     <math id="alg2.l10.m1.2" class="ltx_Math" alttext="g\leftarrow\nabla_{{\mathbf{\theta}}}\mathcal{L}({\mathbf{\theta}}_{i},b)" display="inline"><semantics id="alg2.l10.m1.2a"><mrow id="alg2.l10.m1.2.2" xref="alg2.l10.m1.2.2.cmml"><mi id="alg2.l10.m1.2.2.3" xref="alg2.l10.m1.2.2.3.cmml">g</mi><mo stretchy="false" id="alg2.l10.m1.2.2.2" xref="alg2.l10.m1.2.2.2.cmml">←</mo><mrow id="alg2.l10.m1.2.2.1" xref="alg2.l10.m1.2.2.1.cmml"><mrow id="alg2.l10.m1.2.2.1.3" xref="alg2.l10.m1.2.2.1.3.cmml"><msub id="alg2.l10.m1.2.2.1.3.1" xref="alg2.l10.m1.2.2.1.3.1.cmml"><mo rspace="0.167em" id="alg2.l10.m1.2.2.1.3.1.2" xref="alg2.l10.m1.2.2.1.3.1.2.cmml">∇</mo><mi id="alg2.l10.m1.2.2.1.3.1.3" xref="alg2.l10.m1.2.2.1.3.1.3.cmml">θ</mi></msub><mi class="ltx_font_mathcaligraphic" id="alg2.l10.m1.2.2.1.3.2" xref="alg2.l10.m1.2.2.1.3.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="alg2.l10.m1.2.2.1.2" xref="alg2.l10.m1.2.2.1.2.cmml">​</mo><mrow id="alg2.l10.m1.2.2.1.1.1" xref="alg2.l10.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg2.l10.m1.2.2.1.1.1.2" xref="alg2.l10.m1.2.2.1.1.2.cmml">(</mo><msub id="alg2.l10.m1.2.2.1.1.1.1" xref="alg2.l10.m1.2.2.1.1.1.1.cmml"><mi id="alg2.l10.m1.2.2.1.1.1.1.2" xref="alg2.l10.m1.2.2.1.1.1.1.2.cmml">θ</mi><mi id="alg2.l10.m1.2.2.1.1.1.1.3" xref="alg2.l10.m1.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="alg2.l10.m1.2.2.1.1.1.3" xref="alg2.l10.m1.2.2.1.1.2.cmml">,</mo><mi id="alg2.l10.m1.1.1" xref="alg2.l10.m1.1.1.cmml">b</mi><mo stretchy="false" id="alg2.l10.m1.2.2.1.1.1.4" xref="alg2.l10.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.2b"><apply id="alg2.l10.m1.2.2.cmml" xref="alg2.l10.m1.2.2"><ci id="alg2.l10.m1.2.2.2.cmml" xref="alg2.l10.m1.2.2.2">←</ci><ci id="alg2.l10.m1.2.2.3.cmml" xref="alg2.l10.m1.2.2.3">𝑔</ci><apply id="alg2.l10.m1.2.2.1.cmml" xref="alg2.l10.m1.2.2.1"><times id="alg2.l10.m1.2.2.1.2.cmml" xref="alg2.l10.m1.2.2.1.2"></times><apply id="alg2.l10.m1.2.2.1.3.cmml" xref="alg2.l10.m1.2.2.1.3"><apply id="alg2.l10.m1.2.2.1.3.1.cmml" xref="alg2.l10.m1.2.2.1.3.1"><csymbol cd="ambiguous" id="alg2.l10.m1.2.2.1.3.1.1.cmml" xref="alg2.l10.m1.2.2.1.3.1">subscript</csymbol><ci id="alg2.l10.m1.2.2.1.3.1.2.cmml" xref="alg2.l10.m1.2.2.1.3.1.2">∇</ci><ci id="alg2.l10.m1.2.2.1.3.1.3.cmml" xref="alg2.l10.m1.2.2.1.3.1.3">𝜃</ci></apply><ci id="alg2.l10.m1.2.2.1.3.2.cmml" xref="alg2.l10.m1.2.2.1.3.2">ℒ</ci></apply><interval closure="open" id="alg2.l10.m1.2.2.1.1.2.cmml" xref="alg2.l10.m1.2.2.1.1.1"><apply id="alg2.l10.m1.2.2.1.1.1.1.cmml" xref="alg2.l10.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l10.m1.2.2.1.1.1.1.1.cmml" xref="alg2.l10.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg2.l10.m1.2.2.1.1.1.1.2.cmml" xref="alg2.l10.m1.2.2.1.1.1.1.2">𝜃</ci><ci id="alg2.l10.m1.2.2.1.1.1.1.3.cmml" xref="alg2.l10.m1.2.2.1.1.1.1.3">𝑖</ci></apply><ci id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1">𝑏</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.2c">g\leftarrow\nabla_{{\mathbf{\theta}}}\mathcal{L}({\mathbf{\theta}}_{i},b)</annotation></semantics></math>

</div>
<div id="alg2.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>     <math id="alg2.l11.m1.1" class="ltx_Math" alttext="\texttt{SumFisher}\leftarrow\texttt{SumFisher}+g^{2}" display="inline"><semantics id="alg2.l11.m1.1a"><mrow id="alg2.l11.m1.1.1" xref="alg2.l11.m1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg2.l11.m1.1.1.2" xref="alg2.l11.m1.1.1.2a.cmml">SumFisher</mtext><mo stretchy="false" id="alg2.l11.m1.1.1.1" xref="alg2.l11.m1.1.1.1.cmml">←</mo><mrow id="alg2.l11.m1.1.1.3" xref="alg2.l11.m1.1.1.3.cmml"><mtext class="ltx_mathvariant_monospace" id="alg2.l11.m1.1.1.3.2" xref="alg2.l11.m1.1.1.3.2a.cmml">SumFisher</mtext><mo id="alg2.l11.m1.1.1.3.1" xref="alg2.l11.m1.1.1.3.1.cmml">+</mo><msup id="alg2.l11.m1.1.1.3.3" xref="alg2.l11.m1.1.1.3.3.cmml"><mi id="alg2.l11.m1.1.1.3.3.2" xref="alg2.l11.m1.1.1.3.3.2.cmml">g</mi><mn id="alg2.l11.m1.1.1.3.3.3" xref="alg2.l11.m1.1.1.3.3.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l11.m1.1b"><apply id="alg2.l11.m1.1.1.cmml" xref="alg2.l11.m1.1.1"><ci id="alg2.l11.m1.1.1.1.cmml" xref="alg2.l11.m1.1.1.1">←</ci><ci id="alg2.l11.m1.1.1.2a.cmml" xref="alg2.l11.m1.1.1.2"><mtext class="ltx_mathvariant_monospace" id="alg2.l11.m1.1.1.2.cmml" xref="alg2.l11.m1.1.1.2">SumFisher</mtext></ci><apply id="alg2.l11.m1.1.1.3.cmml" xref="alg2.l11.m1.1.1.3"><plus id="alg2.l11.m1.1.1.3.1.cmml" xref="alg2.l11.m1.1.1.3.1"></plus><ci id="alg2.l11.m1.1.1.3.2a.cmml" xref="alg2.l11.m1.1.1.3.2"><mtext class="ltx_mathvariant_monospace" id="alg2.l11.m1.1.1.3.2.cmml" xref="alg2.l11.m1.1.1.3.2">SumFisher</mtext></ci><apply id="alg2.l11.m1.1.1.3.3.cmml" xref="alg2.l11.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l11.m1.1.1.3.3.1.cmml" xref="alg2.l11.m1.1.1.3.3">superscript</csymbol><ci id="alg2.l11.m1.1.1.3.3.2.cmml" xref="alg2.l11.m1.1.1.3.3.2">𝑔</ci><cn type="integer" id="alg2.l11.m1.1.1.3.3.3.cmml" xref="alg2.l11.m1.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m1.1c">\texttt{SumFisher}\leftarrow\texttt{SumFisher}+g^{2}</annotation></semantics></math>

</div>
<div id="alg2.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>  <span id="alg2.l12.2" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l12.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>  <span id="alg2.l13.2" class="ltx_text ltx_font_bold">return</span>  <math id="alg2.l13.m1.2" class="ltx_Math" alttext="\texttt{ModelDelta},~{}\texttt{SumFisher}" display="inline"><semantics id="alg2.l13.m1.2a"><mrow id="alg2.l13.m1.2.3.2" xref="alg2.l13.m1.2.3.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg2.l13.m1.1.1" xref="alg2.l13.m1.1.1a.cmml">ModelDelta</mtext><mo rspace="0.497em" id="alg2.l13.m1.2.3.2.1" xref="alg2.l13.m1.2.3.1.cmml">,</mo><mtext class="ltx_mathvariant_monospace" id="alg2.l13.m1.2.2" xref="alg2.l13.m1.2.2a.cmml">SumFisher</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.2b"><list id="alg2.l13.m1.2.3.1.cmml" xref="alg2.l13.m1.2.3.2"><ci id="alg2.l13.m1.1.1a.cmml" xref="alg2.l13.m1.1.1"><mtext class="ltx_mathvariant_monospace" id="alg2.l13.m1.1.1.cmml" xref="alg2.l13.m1.1.1">ModelDelta</mtext></ci><ci id="alg2.l13.m1.2.2a.cmml" xref="alg2.l13.m1.2.2"><mtext class="ltx_mathvariant_monospace" id="alg2.l13.m1.2.2.cmml" xref="alg2.l13.m1.2.2">SumFisher</mtext></ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.2c">\texttt{ModelDelta},~{}\texttt{SumFisher}</annotation></semantics></math>

</div>
</div>
<br class="ltx_break ltx_break">
</figure>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Evaluation and Client-Server Barrier</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.2" class="ltx_p">While there are natural domain-relevant evaluation metrics for our benchmarks, here, we describe specific criterion relevant to FL. The commonly used global and personalization performance are useful indicators of successful FL algorithms. However, they may be confounded by local optimization choices. Hence, we formalize the Client-Server Barrier below and additionally evaluate it in <a href="#S5" title="5 Experiments ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">5</span></a>, as a more direct measure of the quality of a given aggregation method. The criteria below are defined in terms of a performance metric <math id="S4.p1.1.m1.1" class="ltx_Math" alttext="L_{i}(\cdot)" display="inline"><semantics id="S4.p1.1.m1.1a"><mrow id="S4.p1.1.m1.1.2" xref="S4.p1.1.m1.1.2.cmml"><msub id="S4.p1.1.m1.1.2.2" xref="S4.p1.1.m1.1.2.2.cmml"><mi id="S4.p1.1.m1.1.2.2.2" xref="S4.p1.1.m1.1.2.2.2.cmml">L</mi><mi id="S4.p1.1.m1.1.2.2.3" xref="S4.p1.1.m1.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.p1.1.m1.1.2.1" xref="S4.p1.1.m1.1.2.1.cmml">​</mo><mrow id="S4.p1.1.m1.1.2.3.2" xref="S4.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S4.p1.1.m1.1.2.3.2.1" xref="S4.p1.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.p1.1.m1.1.2.3.2.2" xref="S4.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><apply id="S4.p1.1.m1.1.2.cmml" xref="S4.p1.1.m1.1.2"><times id="S4.p1.1.m1.1.2.1.cmml" xref="S4.p1.1.m1.1.2.1"></times><apply id="S4.p1.1.m1.1.2.2.cmml" xref="S4.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.p1.1.m1.1.2.2.1.cmml" xref="S4.p1.1.m1.1.2.2">subscript</csymbol><ci id="S4.p1.1.m1.1.2.2.2.cmml" xref="S4.p1.1.m1.1.2.2.2">𝐿</ci><ci id="S4.p1.1.m1.1.2.2.3.cmml" xref="S4.p1.1.m1.1.2.2.3">𝑖</ci></apply><ci id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">L_{i}(\cdot)</annotation></semantics></math> that measures a quantity of interest, such as loss or prediction error, on client data <math id="S4.p1.2.m2.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="S4.p1.2.m2.1a"><msub id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml"><mi id="S4.p1.2.m2.1.1.2" xref="S4.p1.2.m2.1.1.2.cmml">D</mi><mi id="S4.p1.2.m2.1.1.3" xref="S4.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><apply id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p1.2.m2.1.1.1.cmml" xref="S4.p1.2.m2.1.1">subscript</csymbol><ci id="S4.p1.2.m2.1.1.2.cmml" xref="S4.p1.2.m2.1.1.2">𝐷</ci><ci id="S4.p1.2.m2.1.1.3.cmml" xref="S4.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">D_{i}</annotation></semantics></math>.</p>
</div>
<div id="S4.p2" class="ltx_para ltx_noindent">
<p id="S4.p2.1" class="ltx_p"><span id="S4.p2.1.1" class="ltx_text ltx_font_bold">Global Performance.</span>
The most natural measure of success in FL is the performance of the global model on held-out client data, averaged over clients. Using our notation from before, this is given by <math id="S4.p2.1.m1.1" class="ltx_Math" alttext="\frac{1}{N}\sum_{i=1}^{N}L_{i}({\mathbf{\theta}}_{G})" display="inline"><semantics id="S4.p2.1.m1.1a"><mrow id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml"><mfrac id="S4.p2.1.m1.1.1.3" xref="S4.p2.1.m1.1.1.3.cmml"><mn id="S4.p2.1.m1.1.1.3.2" xref="S4.p2.1.m1.1.1.3.2.cmml">1</mn><mi id="S4.p2.1.m1.1.1.3.3" xref="S4.p2.1.m1.1.1.3.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S4.p2.1.m1.1.1.2" xref="S4.p2.1.m1.1.1.2.cmml">​</mo><mrow id="S4.p2.1.m1.1.1.1" xref="S4.p2.1.m1.1.1.1.cmml"><msubsup id="S4.p2.1.m1.1.1.1.2" xref="S4.p2.1.m1.1.1.1.2.cmml"><mo id="S4.p2.1.m1.1.1.1.2.2.2" xref="S4.p2.1.m1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.p2.1.m1.1.1.1.2.2.3" xref="S4.p2.1.m1.1.1.1.2.2.3.cmml"><mi id="S4.p2.1.m1.1.1.1.2.2.3.2" xref="S4.p2.1.m1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.p2.1.m1.1.1.1.2.2.3.1" xref="S4.p2.1.m1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.p2.1.m1.1.1.1.2.2.3.3" xref="S4.p2.1.m1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.p2.1.m1.1.1.1.2.3" xref="S4.p2.1.m1.1.1.1.2.3.cmml">N</mi></msubsup><mrow id="S4.p2.1.m1.1.1.1.1" xref="S4.p2.1.m1.1.1.1.1.cmml"><msub id="S4.p2.1.m1.1.1.1.1.3" xref="S4.p2.1.m1.1.1.1.1.3.cmml"><mi id="S4.p2.1.m1.1.1.1.1.3.2" xref="S4.p2.1.m1.1.1.1.1.3.2.cmml">L</mi><mi id="S4.p2.1.m1.1.1.1.1.3.3" xref="S4.p2.1.m1.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.p2.1.m1.1.1.1.1.2" xref="S4.p2.1.m1.1.1.1.1.2.cmml">​</mo><mrow id="S4.p2.1.m1.1.1.1.1.1.1" xref="S4.p2.1.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.p2.1.m1.1.1.1.1.1.1.2" xref="S4.p2.1.m1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.p2.1.m1.1.1.1.1.1.1.1" xref="S4.p2.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.p2.1.m1.1.1.1.1.1.1.1.2" xref="S4.p2.1.m1.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S4.p2.1.m1.1.1.1.1.1.1.1.3" xref="S4.p2.1.m1.1.1.1.1.1.1.1.3.cmml">G</mi></msub><mo stretchy="false" id="S4.p2.1.m1.1.1.1.1.1.1.3" xref="S4.p2.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><apply id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1"><times id="S4.p2.1.m1.1.1.2.cmml" xref="S4.p2.1.m1.1.1.2"></times><apply id="S4.p2.1.m1.1.1.3.cmml" xref="S4.p2.1.m1.1.1.3"><divide id="S4.p2.1.m1.1.1.3.1.cmml" xref="S4.p2.1.m1.1.1.3"></divide><cn type="integer" id="S4.p2.1.m1.1.1.3.2.cmml" xref="S4.p2.1.m1.1.1.3.2">1</cn><ci id="S4.p2.1.m1.1.1.3.3.cmml" xref="S4.p2.1.m1.1.1.3.3">𝑁</ci></apply><apply id="S4.p2.1.m1.1.1.1.cmml" xref="S4.p2.1.m1.1.1.1"><apply id="S4.p2.1.m1.1.1.1.2.cmml" xref="S4.p2.1.m1.1.1.1.2"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.1.2.1.cmml" xref="S4.p2.1.m1.1.1.1.2">superscript</csymbol><apply id="S4.p2.1.m1.1.1.1.2.2.cmml" xref="S4.p2.1.m1.1.1.1.2"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.1.2.2.1.cmml" xref="S4.p2.1.m1.1.1.1.2">subscript</csymbol><sum id="S4.p2.1.m1.1.1.1.2.2.2.cmml" xref="S4.p2.1.m1.1.1.1.2.2.2"></sum><apply id="S4.p2.1.m1.1.1.1.2.2.3.cmml" xref="S4.p2.1.m1.1.1.1.2.2.3"><eq id="S4.p2.1.m1.1.1.1.2.2.3.1.cmml" xref="S4.p2.1.m1.1.1.1.2.2.3.1"></eq><ci id="S4.p2.1.m1.1.1.1.2.2.3.2.cmml" xref="S4.p2.1.m1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S4.p2.1.m1.1.1.1.2.2.3.3.cmml" xref="S4.p2.1.m1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.p2.1.m1.1.1.1.2.3.cmml" xref="S4.p2.1.m1.1.1.1.2.3">𝑁</ci></apply><apply id="S4.p2.1.m1.1.1.1.1.cmml" xref="S4.p2.1.m1.1.1.1.1"><times id="S4.p2.1.m1.1.1.1.1.2.cmml" xref="S4.p2.1.m1.1.1.1.1.2"></times><apply id="S4.p2.1.m1.1.1.1.1.3.cmml" xref="S4.p2.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.1.1.3.1.cmml" xref="S4.p2.1.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.p2.1.m1.1.1.1.1.3.2.cmml" xref="S4.p2.1.m1.1.1.1.1.3.2">𝐿</ci><ci id="S4.p2.1.m1.1.1.1.1.3.3.cmml" xref="S4.p2.1.m1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S4.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.p2.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.p2.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.p2.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.p2.1.m1.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S4.p2.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.p2.1.m1.1.1.1.1.1.1.1.3">𝐺</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">\frac{1}{N}\sum_{i=1}^{N}L_{i}({\mathbf{\theta}}_{G})</annotation></semantics></math>.</p>
</div>
<div id="S4.p3" class="ltx_para ltx_noindent">
<p id="S4.p3.1" class="ltx_p"><span id="S4.p3.1.1" class="ltx_text ltx_font_bold">Client Personalization Performance.</span>
While global performance is akin to a network’s zero-shot abilities, we are often interested in its personalization ability to unseen clients after a few steps of fine-tuning. Quick adaptation of the network to particular clients or downstream use cases is critical in the compute-constrained settings that FL targets. We measure client personalization by fine-tuning <math id="S4.p3.1.m1.1" class="ltx_Math" alttext="{\mathbf{\theta}}_{G}" display="inline"><semantics id="S4.p3.1.m1.1a"><msub id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml"><mi id="S4.p3.1.m1.1.1.2" xref="S4.p3.1.m1.1.1.2.cmml">θ</mi><mi id="S4.p3.1.m1.1.1.3" xref="S4.p3.1.m1.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><apply id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p3.1.m1.1.1.1.cmml" xref="S4.p3.1.m1.1.1">subscript</csymbol><ci id="S4.p3.1.m1.1.1.2.cmml" xref="S4.p3.1.m1.1.1.2">𝜃</ci><ci id="S4.p3.1.m1.1.1.3.cmml" xref="S4.p3.1.m1.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">{\mathbf{\theta}}_{G}</annotation></semantics></math> on a portion of each held-out client dataset and then evaluating each fine-tuned model on the remaining unseen client data (the same portion used for measuring global performance), averaging over clients as before.</p>
</div>
<div id="S4.p4" class="ltx_para ltx_noindent">
<p id="S4.p4.4" class="ltx_p"><span id="S4.p4.4.1" class="ltx_text ltx_font_bold">Client-Server Barrier.</span>
For a given performance metric <math id="S4.p4.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.p4.1.m1.1a"><mi id="S4.p4.1.m1.1.1" xref="S4.p4.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.p4.1.m1.1b"><ci id="S4.p4.1.m1.1.1.cmml" xref="S4.p4.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.1.m1.1c">L</annotation></semantics></math> and aggregation technique, we define the Client-Server Barrier as the difference in this performance metric between each client model <math id="S4.p4.2.m2.1" class="ltx_Math" alttext="{\mathbf{\theta}}_{i}" display="inline"><semantics id="S4.p4.2.m2.1a"><msub id="S4.p4.2.m2.1.1" xref="S4.p4.2.m2.1.1.cmml"><mi id="S4.p4.2.m2.1.1.2" xref="S4.p4.2.m2.1.1.2.cmml">θ</mi><mi id="S4.p4.2.m2.1.1.3" xref="S4.p4.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p4.2.m2.1b"><apply id="S4.p4.2.m2.1.1.cmml" xref="S4.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p4.2.m2.1.1.1.cmml" xref="S4.p4.2.m2.1.1">subscript</csymbol><ci id="S4.p4.2.m2.1.1.2.cmml" xref="S4.p4.2.m2.1.1.2">𝜃</ci><ci id="S4.p4.2.m2.1.1.3.cmml" xref="S4.p4.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.2.m2.1c">{\mathbf{\theta}}_{i}</annotation></semantics></math> and the aggregated global model <math id="S4.p4.3.m3.1" class="ltx_Math" alttext="{\mathbf{\theta}}_{G}" display="inline"><semantics id="S4.p4.3.m3.1a"><msub id="S4.p4.3.m3.1.1" xref="S4.p4.3.m3.1.1.cmml"><mi id="S4.p4.3.m3.1.1.2" xref="S4.p4.3.m3.1.1.2.cmml">θ</mi><mi id="S4.p4.3.m3.1.1.3" xref="S4.p4.3.m3.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p4.3.m3.1b"><apply id="S4.p4.3.m3.1.1.cmml" xref="S4.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p4.3.m3.1.1.1.cmml" xref="S4.p4.3.m3.1.1">subscript</csymbol><ci id="S4.p4.3.m3.1.1.2.cmml" xref="S4.p4.3.m3.1.1.2">𝜃</ci><ci id="S4.p4.3.m3.1.1.3.cmml" xref="S4.p4.3.m3.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.3.m3.1c">{\mathbf{\theta}}_{G}</annotation></semantics></math> with respect to the client data <math id="S4.p4.4.m4.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="S4.p4.4.m4.1a"><msub id="S4.p4.4.m4.1.1" xref="S4.p4.4.m4.1.1.cmml"><mi id="S4.p4.4.m4.1.1.2" xref="S4.p4.4.m4.1.1.2.cmml">D</mi><mi id="S4.p4.4.m4.1.1.3" xref="S4.p4.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p4.4.m4.1b"><apply id="S4.p4.4.m4.1.1.cmml" xref="S4.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p4.4.m4.1.1.1.cmml" xref="S4.p4.4.m4.1.1">subscript</csymbol><ci id="S4.p4.4.m4.1.1.2.cmml" xref="S4.p4.4.m4.1.1.2">𝐷</ci><ci id="S4.p4.4.m4.1.1.3.cmml" xref="S4.p4.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.4.m4.1c">D_{i}</annotation></semantics></math>, averaged over all the clients involved in the aggregation. Mathematically, this is given by</p>
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.1" class="ltx_Math" alttext="\frac{1}{N}\sum_{i=1}^{N}\left(L_{i}({\mathbf{\theta}}_{G})-L_{i}({\mathbf{\theta}}_{i})\right)=\frac{1}{N}\sum_{i=1}^{N}L_{i}({\mathbf{\theta}}_{G})-\frac{1}{N}\sum_{i=1}^{N}L_{i}({\mathbf{\theta}}_{i})." display="block"><semantics id="S4.E5.m1.1a"><mrow id="S4.E5.m1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml"><mrow id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml"><mrow id="S4.E5.m1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.cmml"><mfrac id="S4.E5.m1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.3.cmml"><mn id="S4.E5.m1.1.1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.1.1.3.2.cmml">1</mn><mi id="S4.E5.m1.1.1.1.1.1.3.3" xref="S4.E5.m1.1.1.1.1.1.3.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E5.m1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.cmml"><munderover id="S4.E5.m1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S4.E5.m1.1.1.1.1.1.1.2.2.2" xref="S4.E5.m1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.2.2.3" xref="S4.E5.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.2.2.3.2" xref="S4.E5.m1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.E5.m1.1.1.1.1.1.1.2.2.3.1" xref="S4.E5.m1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E5.m1.1.1.1.1.1.1.2.2.3.3" xref="S4.E5.m1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E5.m1.1.1.1.1.1.1.2.3" xref="S4.E5.m1.1.1.1.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E5.m1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">L</mi><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">G</mi></msub><mo stretchy="false" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">L</mi><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">​</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><msub id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml">θ</mi><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E5.m1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E5.m1.1.1.1.1.4" xref="S4.E5.m1.1.1.1.1.4.cmml">=</mo><mrow id="S4.E5.m1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.3.cmml"><mrow id="S4.E5.m1.1.1.1.1.2.1" xref="S4.E5.m1.1.1.1.1.2.1.cmml"><mfrac id="S4.E5.m1.1.1.1.1.2.1.3" xref="S4.E5.m1.1.1.1.1.2.1.3.cmml"><mn id="S4.E5.m1.1.1.1.1.2.1.3.2" xref="S4.E5.m1.1.1.1.1.2.1.3.2.cmml">1</mn><mi id="S4.E5.m1.1.1.1.1.2.1.3.3" xref="S4.E5.m1.1.1.1.1.2.1.3.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.2.1.2" xref="S4.E5.m1.1.1.1.1.2.1.2.cmml">​</mo><mrow id="S4.E5.m1.1.1.1.1.2.1.1" xref="S4.E5.m1.1.1.1.1.2.1.1.cmml"><munderover id="S4.E5.m1.1.1.1.1.2.1.1.2" xref="S4.E5.m1.1.1.1.1.2.1.1.2.cmml"><mo movablelimits="false" id="S4.E5.m1.1.1.1.1.2.1.1.2.2.2" xref="S4.E5.m1.1.1.1.1.2.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E5.m1.1.1.1.1.2.1.1.2.2.3" xref="S4.E5.m1.1.1.1.1.2.1.1.2.2.3.cmml"><mi id="S4.E5.m1.1.1.1.1.2.1.1.2.2.3.2" xref="S4.E5.m1.1.1.1.1.2.1.1.2.2.3.2.cmml">i</mi><mo id="S4.E5.m1.1.1.1.1.2.1.1.2.2.3.1" xref="S4.E5.m1.1.1.1.1.2.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E5.m1.1.1.1.1.2.1.1.2.2.3.3" xref="S4.E5.m1.1.1.1.1.2.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E5.m1.1.1.1.1.2.1.1.2.3" xref="S4.E5.m1.1.1.1.1.2.1.1.2.3.cmml">N</mi></munderover><mrow id="S4.E5.m1.1.1.1.1.2.1.1.1" xref="S4.E5.m1.1.1.1.1.2.1.1.1.cmml"><msub id="S4.E5.m1.1.1.1.1.2.1.1.1.3" xref="S4.E5.m1.1.1.1.1.2.1.1.1.3.cmml"><mi id="S4.E5.m1.1.1.1.1.2.1.1.1.3.2" xref="S4.E5.m1.1.1.1.1.2.1.1.1.3.2.cmml">L</mi><mi id="S4.E5.m1.1.1.1.1.2.1.1.1.3.3" xref="S4.E5.m1.1.1.1.1.2.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.2.1.1.1.2" xref="S4.E5.m1.1.1.1.1.2.1.1.1.2.cmml">​</mo><mrow id="S4.E5.m1.1.1.1.1.2.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5.m1.1.1.1.1.2.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E5.m1.1.1.1.1.2.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.1.1.1.1.2.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S4.E5.m1.1.1.1.1.2.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.2.1.1.1.1.1.1.3.cmml">G</mi></msub><mo stretchy="false" id="S4.E5.m1.1.1.1.1.2.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E5.m1.1.1.1.1.3.3" xref="S4.E5.m1.1.1.1.1.3.3.cmml">−</mo><mrow id="S4.E5.m1.1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.1.3.2.cmml"><mfrac id="S4.E5.m1.1.1.1.1.3.2.3" xref="S4.E5.m1.1.1.1.1.3.2.3.cmml"><mn id="S4.E5.m1.1.1.1.1.3.2.3.2" xref="S4.E5.m1.1.1.1.1.3.2.3.2.cmml">1</mn><mi id="S4.E5.m1.1.1.1.1.3.2.3.3" xref="S4.E5.m1.1.1.1.1.3.2.3.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.3.2.2" xref="S4.E5.m1.1.1.1.1.3.2.2.cmml">​</mo><mrow id="S4.E5.m1.1.1.1.1.3.2.1" xref="S4.E5.m1.1.1.1.1.3.2.1.cmml"><munderover id="S4.E5.m1.1.1.1.1.3.2.1.2" xref="S4.E5.m1.1.1.1.1.3.2.1.2.cmml"><mo movablelimits="false" id="S4.E5.m1.1.1.1.1.3.2.1.2.2.2" xref="S4.E5.m1.1.1.1.1.3.2.1.2.2.2.cmml">∑</mo><mrow id="S4.E5.m1.1.1.1.1.3.2.1.2.2.3" xref="S4.E5.m1.1.1.1.1.3.2.1.2.2.3.cmml"><mi id="S4.E5.m1.1.1.1.1.3.2.1.2.2.3.2" xref="S4.E5.m1.1.1.1.1.3.2.1.2.2.3.2.cmml">i</mi><mo id="S4.E5.m1.1.1.1.1.3.2.1.2.2.3.1" xref="S4.E5.m1.1.1.1.1.3.2.1.2.2.3.1.cmml">=</mo><mn id="S4.E5.m1.1.1.1.1.3.2.1.2.2.3.3" xref="S4.E5.m1.1.1.1.1.3.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E5.m1.1.1.1.1.3.2.1.2.3" xref="S4.E5.m1.1.1.1.1.3.2.1.2.3.cmml">N</mi></munderover><mrow id="S4.E5.m1.1.1.1.1.3.2.1.1" xref="S4.E5.m1.1.1.1.1.3.2.1.1.cmml"><msub id="S4.E5.m1.1.1.1.1.3.2.1.1.3" xref="S4.E5.m1.1.1.1.1.3.2.1.1.3.cmml"><mi id="S4.E5.m1.1.1.1.1.3.2.1.1.3.2" xref="S4.E5.m1.1.1.1.1.3.2.1.1.3.2.cmml">L</mi><mi id="S4.E5.m1.1.1.1.1.3.2.1.1.3.3" xref="S4.E5.m1.1.1.1.1.3.2.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.3.2.1.1.2" xref="S4.E5.m1.1.1.1.1.3.2.1.1.2.cmml">​</mo><mrow id="S4.E5.m1.1.1.1.1.3.2.1.1.1.1" xref="S4.E5.m1.1.1.1.1.3.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5.m1.1.1.1.1.3.2.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.3.2.1.1.1.1.1.cmml">(</mo><msub id="S4.E5.m1.1.1.1.1.3.2.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.3.2.1.1.1.1.1.cmml"><mi id="S4.E5.m1.1.1.1.1.3.2.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.3.2.1.1.1.1.1.2.cmml">θ</mi><mi id="S4.E5.m1.1.1.1.1.3.2.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.3.2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E5.m1.1.1.1.1.3.2.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.3.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S4.E5.m1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.1b"><apply id="S4.E5.m1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1"><eq id="S4.E5.m1.1.1.1.1.4.cmml" xref="S4.E5.m1.1.1.1.1.4"></eq><apply id="S4.E5.m1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1"><times id="S4.E5.m1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.2"></times><apply id="S4.E5.m1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.3"><divide id="S4.E5.m1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.3"></divide><cn type="integer" id="S4.E5.m1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.3.2">1</cn><ci id="S4.E5.m1.1.1.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.3.3">𝑁</ci></apply><apply id="S4.E5.m1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1"><apply id="S4.E5.m1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E5.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E5.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.2.2.2"></sum><apply id="S4.E5.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.2.2.3"><eq id="S4.E5.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E5.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S4.E5.m1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E5.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1"><minus id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3"></minus><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1"><times id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝐿</ci><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝐺</ci></apply></apply><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2"><times id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.2"></times><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3.2">𝐿</ci><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.1.1">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.2">𝜃</ci><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply><apply id="S4.E5.m1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.3"><minus id="S4.E5.m1.1.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.3.3"></minus><apply id="S4.E5.m1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.1.1.1.1.2.1"><times id="S4.E5.m1.1.1.1.1.2.1.2.cmml" xref="S4.E5.m1.1.1.1.1.2.1.2"></times><apply id="S4.E5.m1.1.1.1.1.2.1.3.cmml" xref="S4.E5.m1.1.1.1.1.2.1.3"><divide id="S4.E5.m1.1.1.1.1.2.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.2.1.3"></divide><cn type="integer" id="S4.E5.m1.1.1.1.1.2.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.2.1.3.2">1</cn><ci id="S4.E5.m1.1.1.1.1.2.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.2.1.3.3">𝑁</ci></apply><apply id="S4.E5.m1.1.1.1.1.2.1.1.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1"><apply id="S4.E5.m1.1.1.1.1.2.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.2.1.1.2.1.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1.2">superscript</csymbol><apply id="S4.E5.m1.1.1.1.1.2.1.1.2.2.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.2.1.1.2.2.1.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1.2">subscript</csymbol><sum id="S4.E5.m1.1.1.1.1.2.1.1.2.2.2.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1.2.2.2"></sum><apply id="S4.E5.m1.1.1.1.1.2.1.1.2.2.3.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1.2.2.3"><eq id="S4.E5.m1.1.1.1.1.2.1.1.2.2.3.1.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1.2.2.3.1"></eq><ci id="S4.E5.m1.1.1.1.1.2.1.1.2.2.3.2.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S4.E5.m1.1.1.1.1.2.1.1.2.2.3.3.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E5.m1.1.1.1.1.2.1.1.2.3.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1.2.3">𝑁</ci></apply><apply id="S4.E5.m1.1.1.1.1.2.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1.1"><times id="S4.E5.m1.1.1.1.1.2.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1.1.2"></times><apply id="S4.E5.m1.1.1.1.1.2.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.2.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.2.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1.1.3.2">𝐿</ci><ci id="S4.E5.m1.1.1.1.1.2.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1.1.3.3">𝑖</ci></apply><apply id="S4.E5.m1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1.1.1.1">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1.1.1.1.1.2">𝜃</ci><ci id="S4.E5.m1.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.2.1.1.1.1.1.1.3">𝐺</ci></apply></apply></apply></apply><apply id="S4.E5.m1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.3.2"><times id="S4.E5.m1.1.1.1.1.3.2.2.cmml" xref="S4.E5.m1.1.1.1.1.3.2.2"></times><apply id="S4.E5.m1.1.1.1.1.3.2.3.cmml" xref="S4.E5.m1.1.1.1.1.3.2.3"><divide id="S4.E5.m1.1.1.1.1.3.2.3.1.cmml" xref="S4.E5.m1.1.1.1.1.3.2.3"></divide><cn type="integer" id="S4.E5.m1.1.1.1.1.3.2.3.2.cmml" xref="S4.E5.m1.1.1.1.1.3.2.3.2">1</cn><ci id="S4.E5.m1.1.1.1.1.3.2.3.3.cmml" xref="S4.E5.m1.1.1.1.1.3.2.3.3">𝑁</ci></apply><apply id="S4.E5.m1.1.1.1.1.3.2.1.cmml" xref="S4.E5.m1.1.1.1.1.3.2.1"><apply id="S4.E5.m1.1.1.1.1.3.2.1.2.cmml" xref="S4.E5.m1.1.1.1.1.3.2.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.3.2.1.2.1.cmml" xref="S4.E5.m1.1.1.1.1.3.2.1.2">superscript</csymbol><apply id="S4.E5.m1.1.1.1.1.3.2.1.2.2.cmml" xref="S4.E5.m1.1.1.1.1.3.2.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.3.2.1.2.2.1.cmml" xref="S4.E5.m1.1.1.1.1.3.2.1.2">subscript</csymbol><sum id="S4.E5.m1.1.1.1.1.3.2.1.2.2.2.cmml" xref="S4.E5.m1.1.1.1.1.3.2.1.2.2.2"></sum><apply id="S4.E5.m1.1.1.1.1.3.2.1.2.2.3.cmml" xref="S4.E5.m1.1.1.1.1.3.2.1.2.2.3"><eq id="S4.E5.m1.1.1.1.1.3.2.1.2.2.3.1.cmml" xref="S4.E5.m1.1.1.1.1.3.2.1.2.2.3.1"></eq><ci id="S4.E5.m1.1.1.1.1.3.2.1.2.2.3.2.cmml" xref="S4.E5.m1.1.1.1.1.3.2.1.2.2.3.2">𝑖</ci><cn type="integer" id="S4.E5.m1.1.1.1.1.3.2.1.2.2.3.3.cmml" xref="S4.E5.m1.1.1.1.1.3.2.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E5.m1.1.1.1.1.3.2.1.2.3.cmml" xref="S4.E5.m1.1.1.1.1.3.2.1.2.3">𝑁</ci></apply><apply id="S4.E5.m1.1.1.1.1.3.2.1.1.cmml" xref="S4.E5.m1.1.1.1.1.3.2.1.1"><times id="S4.E5.m1.1.1.1.1.3.2.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.3.2.1.1.2"></times><apply id="S4.E5.m1.1.1.1.1.3.2.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.3.2.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.3.2.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.3.2.1.1.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.3.2.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.3.2.1.1.3.2">𝐿</ci><ci id="S4.E5.m1.1.1.1.1.3.2.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.3.2.1.1.3.3">𝑖</ci></apply><apply id="S4.E5.m1.1.1.1.1.3.2.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.3.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.3.2.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.3.2.1.1.1.1">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.3.2.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.3.2.1.1.1.1.1.2">𝜃</ci><ci id="S4.E5.m1.1.1.1.1.3.2.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.3.2.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.1c">\frac{1}{N}\sum_{i=1}^{N}\left(L_{i}({\mathbf{\theta}}_{G})-L_{i}({\mathbf{\theta}}_{i})\right)=\frac{1}{N}\sum_{i=1}^{N}L_{i}({\mathbf{\theta}}_{G})-\frac{1}{N}\sum_{i=1}^{N}L_{i}({\mathbf{\theta}}_{i}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S4.p4.5" class="ltx_p">This is a simple and direct measure of the impact of aggregation on model performance and can be computed in a federated manner: averaging the broadcast global model’s performance across all client data in the sampled cohort (first term), and averaging trained local models’ performance on their respective client data across the sampled cohort (second term).</p>
</div>
<figure id="S4.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F2.fig1" class="ltx_figure ltx_figure_panel ltx_align_center">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2311.10291/assets/x4.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="240" height="147" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F2.fig2" class="ltx_figure ltx_figure_panel ltx_align_center">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2311.10291/assets/x5.png" id="S4.F2.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="240" height="147" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F2.fig3" class="ltx_figure ltx_figure_panel ltx_align_center">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2311.10291/assets/x6.png" id="S4.F2.g3" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="240" height="147" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F2.fig4" class="ltx_figure ltx_figure_panel ltx_align_center">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2311.10291/assets/x7.png" id="S4.F2.g4" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="240" height="147" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>As heterogeneity across clients increases (<span id="S4.F2.12.1" class="ltx_text ltx_font_bold">top left</span> <math id="S4.F2.3.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S4.F2.3.m1.1b"><mo stretchy="false" id="S4.F2.3.m1.1.1" xref="S4.F2.3.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.F2.3.m1.1c"><ci id="S4.F2.3.m1.1.1.cmml" xref="S4.F2.3.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.3.m1.1d">\rightarrow</annotation></semantics></math> <span id="S4.F2.13.2" class="ltx_text ltx_font_bold">top right</span> <math id="S4.F2.4.m2.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S4.F2.4.m2.1b"><mo stretchy="false" id="S4.F2.4.m2.1.1" xref="S4.F2.4.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.F2.4.m2.1c"><ci id="S4.F2.4.m2.1.1.cmml" xref="S4.F2.4.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.4.m2.1d">\rightarrow</annotation></semantics></math> <span id="S4.F2.14.3" class="ltx_text ltx_font_bold">bottom left</span>), <span id="S4.F2.15.4" class="ltx_text ltx_font_smallcaps">FedAvg</span> deteriorates, while <span id="S4.F2.16.5" class="ltx_text ltx_font_smallcaps">FedFish</span> matches predictions of both client models. For each setting shown and each client within it, the <span id="S4.F2.17.6" class="ltx_text ltx_font_smallcaps">FedFish</span> global model has lower barrier to the clients (<span id="S4.F2.18.7" class="ltx_text ltx_font_bold">bottom right</span>).</figcaption>
</figure>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p">Using the criteria described in <a href="#S4" title="4 Evaluation and Client-Server Barrier ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">4</span></a>, we now conduct a systematic empirical evaluation of <span id="S5.p1.1.1" class="ltx_text ltx_font_smallcaps">FedFish</span> in varied settings, compared to the best performing variant of <span id="S5.p1.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span>. We first demonstrate the advantage of <span id="S5.p1.1.3" class="ltx_text ltx_font_smallcaps">FedFish</span> as client data heterogeneity increases in a toy regression problem. We then assess its performance across settings in larger scale image and language benchmarks.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>A Toy Regression Demonstration</h3>

<div id="S5.SS1.p1" class="ltx_para ltx_noindent">
<p id="S5.SS1.p1.4" class="ltx_p"><a href="#S4.F2" title="In 4 Evaluation and Client-Server Barrier ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">2</span></a> shows a non-linear regression problem with two clients across which data is distributed with varying heterogeneity, including full (<math id="S5.SS1.p1.1.m1.1" class="ltx_Math" alttext="+" display="inline"><semantics id="S5.SS1.p1.1.m1.1a"><mo id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml">+</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><plus id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"></plus></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">+</annotation></semantics></math>), partial (<math id="S5.SS1.p1.2.m2.1" class="ltx_Math" alttext="\circ" display="inline"><semantics id="S5.SS1.p1.2.m2.1a"><mo id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml">∘</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><compose id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1"></compose></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">\circ</annotation></semantics></math>) and no overlap (<math id="S5.SS1.p1.3.m3.1" class="ltx_Math" alttext="\star" display="inline"><semantics id="S5.SS1.p1.3.m3.1a"><mo id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml">⋆</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><ci id="S5.SS1.p1.3.m3.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1">⋆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">\star</annotation></semantics></math>). We plot the local functions learned by each client, as well as the global functions produced by aggregation via <span id="S5.SS1.p1.4.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> and <span id="S5.SS1.p1.4.2" class="ltx_text ltx_font_smallcaps">FedFish</span> after one round.
For completely homogeneous client data, <span id="S5.SS1.p1.4.3" class="ltx_text ltx_font_smallcaps">FedAvg</span> and <span id="S5.SS1.p1.4.4" class="ltx_text ltx_font_smallcaps">FedFish</span> fit similar functions. When there is partial overlap, <span id="S5.SS1.p1.4.5" class="ltx_text ltx_font_smallcaps">FedAvg</span> seems to reasonably retain predictions on one client’s data while poorly fitting the other, while <span id="S5.SS1.p1.4.6" class="ltx_text ltx_font_smallcaps">FedFish</span> fits both datasets well. In the extreme case of completely disjoint supports, <span id="S5.SS1.p1.4.7" class="ltx_text ltx_font_smallcaps">FedAvg</span> fails to fit either client dataset, but <span id="S5.SS1.p1.4.8" class="ltx_text ltx_font_smallcaps">FedFish</span> matches the locally learned functions of both clients on their respective input data.
The Client-Server Barrier (CSB) defined in <a href="#S4.E5" title="In 4 Evaluation and Client-Server Barrier ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">5</span></a> is computed in terms of mean squared error for each client on their corresponding data. As shown by all the points above the <math id="S5.SS1.p1.4.m4.1" class="ltx_Math" alttext="x=y" display="inline"><semantics id="S5.SS1.p1.4.m4.1a"><mrow id="S5.SS1.p1.4.m4.1.1" xref="S5.SS1.p1.4.m4.1.1.cmml"><mi id="S5.SS1.p1.4.m4.1.1.2" xref="S5.SS1.p1.4.m4.1.1.2.cmml">x</mi><mo id="S5.SS1.p1.4.m4.1.1.1" xref="S5.SS1.p1.4.m4.1.1.1.cmml">=</mo><mi id="S5.SS1.p1.4.m4.1.1.3" xref="S5.SS1.p1.4.m4.1.1.3.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.4.m4.1b"><apply id="S5.SS1.p1.4.m4.1.1.cmml" xref="S5.SS1.p1.4.m4.1.1"><eq id="S5.SS1.p1.4.m4.1.1.1.cmml" xref="S5.SS1.p1.4.m4.1.1.1"></eq><ci id="S5.SS1.p1.4.m4.1.1.2.cmml" xref="S5.SS1.p1.4.m4.1.1.2">𝑥</ci><ci id="S5.SS1.p1.4.m4.1.1.3.cmml" xref="S5.SS1.p1.4.m4.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.4.m4.1c">x=y</annotation></semantics></math> line in <a href="#S4.F2" title="In 4 Evaluation and Client-Server Barrier ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a> (bottom right), the CSB is lower for <span id="S5.SS1.p1.4.9" class="ltx_text ltx_font_smallcaps">FedFish</span> than <span id="S5.SS1.p1.4.10" class="ltx_text ltx_font_smallcaps">FedAvg</span> in each of these settings, with more significant difference as data heterogeneity increases. We hypothesize that accounting for the functions learned by local models confers this advantage upon <span id="S5.SS1.p1.4.11" class="ltx_text ltx_font_smallcaps">FedFish</span>.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Image Classification and Text Benchmarks</h3>

<section id="S5.SS2.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Datasets and architectures.</h5>

<div id="S5.SS2.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS0.Px1.p1.1" class="ltx_p">We consider a variety of federated benchmarks for image classification (EMNIST <cite class="ltx_cite ltx_citemacro_citep">(Cohen et al., <a href="#bib.bib9" title="" class="ltx_ref">2017</a>)</cite>, CIFAR100 <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib25" title="" class="ltx_ref">Krizhevsky et al., </a>)</cite>) and language modeling (Stack Overflow <cite class="ltx_cite ltx_citemacro_citep">(Authors, <a href="#bib.bib3" title="" class="ltx_ref">2019</a>)</cite>,
CC-News <cite class="ltx_cite ltx_citemacro_citep">(Hamborg et al., <a href="#bib.bib19" title="" class="ltx_ref">2017</a>)</cite> and C4 <cite class="ltx_cite ltx_citemacro_citep">(Raffel et al., <a href="#bib.bib36" title="" class="ltx_ref">2020</a>)</cite>). In particular, C4 is a large-scale and significantly heterogenous dataset. For these domains, we use standard classifier and transformer architectures, respectively.</p>
</div>
<div id="S5.SS2.SSS0.Px1.p2" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS0.Px1.p2.1" class="ltx_p">For EMNIST, we partition the handwritten characters according to their author, as proposed by <cite class="ltx_cite ltx_citemacro_citet">Caldas et al. (<a href="#bib.bib5" title="" class="ltx_ref">2018</a>)</cite>. For Stack Overflow, posts on the eponymous web forum are partitioned by their author as well. For CIFAR100, we partition the examples over 100 clients in a heterogeneous fashion using the two-level latent Dirichlet allocation scheme proposed by <cite class="ltx_cite ltx_citemacro_citet">Reddi et al. (<a href="#bib.bib38" title="" class="ltx_ref">2020</a>)</cite>. For CC-News and C4, we use Dataset Grouper <cite class="ltx_cite ltx_citemacro_citep">(Charles et al., <a href="#bib.bib8" title="" class="ltx_ref">2023</a>)</cite> to partition web-crawled examples according to their base URL (e.g. <span class="ltx_ref ltx_font_typewriter ltx_ref_self">nytimes.com</span>). More details about data splits, architectures and hyperparameters are included in <a href="#A1.SS3" title="A.3 Experimental Details ‣ Appendix A Appendix ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">A.3</span></a>.</p>
</div>
</section>
<section id="S5.SS2.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Performance metrics.</h5>

<div id="S5.SS2.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS0.Px2.p1.1" class="ltx_p">We evaluate global performance, client personalization performance and Client-Server Barrier (see <a href="#S4" title="4 Evaluation and Client-Server Barrier ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">4</span></a>), using standard domain-relevant performance metrics. These include classification accuracy for images and next-token prediction accuracy and perplexity for language modeling. Since C4 is a very large scale dataset that may generally be used as a pretraining corpus, we evaluate its global model on held-out clients from C4 itself as well as on the shifted Stack Overflow and CC-News datasets. This tests the methods’ transfer performance in addition to adaptability to new clients that were not seen during training. For the C4 experiments, we also vary the amount of fine-tuning data used for personalization – 25% or 50% of each held-out client’s data – to assess few-shot performance. Additional details are reported in <a href="#A1.SS3" title="A.3 Experimental Details ‣ Appendix A Appendix ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.3</span></a>.</p>
</div>
<figure id="S5.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F3.fig1" class="ltx_figure ltx_figure_panel ltx_align_center">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2311.10291/assets/x8.png" id="S5.F3.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="240" height="147" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F3.fig2" class="ltx_figure ltx_figure_panel ltx_align_center">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2311.10291/assets/x9.png" id="S5.F3.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="240" height="147" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Training on EMNIST with <span id="S5.F3.5.1" class="ltx_text ltx_font_smallcaps">FedFish</span> converges faster and to a higher global accuracy (<span id="S5.F3.6.2" class="ltx_text ltx_font_bold">left</span>) and post-personalization accuracy (<span id="S5.F3.7.3" class="ltx_text ltx_font_bold">right</span>) than training with <span id="S5.F3.8.4" class="ltx_text ltx_font_smallcaps">FedAvg</span>, across varying numbers of local epochs. Results are shown with fixed compute across configurations: each training iteration corresponds to a local epoch, and each marker indicates 100 federated communication rounds.</figcaption>
</figure>
</section>
<section id="S5.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.1 </span>Effect of Local Training on Global Model Performance</h4>

<div id="S5.SS2.SSS1.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS1.p1.1" class="ltx_p">We study the effect of local training on the global model’s performance by varying the number of epochs of training clients perform in between rounds. Since increasing the number of local epochs for a fixed number of rounds increases computational costs, we present our results by separately fixing compute (or total number of training iterations) and number of aggregation rounds. We provide a complete table of results covering all settings in <a href="#A1.T3" title="In A.3.3 Hardware Configuration ‣ A.3 Experimental Details ‣ Appendix A Appendix ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">table</span> <span class="ltx_text ltx_ref_tag">3</span></a> of <a href="#A1.SS4" title="A.4 Additional Results ‣ Appendix A Appendix ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">A.4</span></a> and discuss representative experiments here. With fixed compute, <a href="#S5.F3" title="In Performance metrics. ‣ 5.2 Image Classification and Text Benchmarks ‣ 5 Experiments ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a> (left) shows a decline in global accuracy as number of local epochs is increased for both <span id="S5.SS2.SSS1.p1.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> and <span id="S5.SS2.SSS1.p1.1.2" class="ltx_text ltx_font_smallcaps">FedFish</span>, as expected by the client-drift phenomenon. However, within each setting, and across datasets, <span id="S5.SS2.SSS1.p1.1.3" class="ltx_text ltx_font_smallcaps">FedFish</span> outperforms <span id="S5.SS2.SSS1.p1.1.4" class="ltx_text ltx_font_smallcaps">FedAvg</span>, suffering a more graceful decline in performance with more local training and converging to higher performance faster. <a href="#S5.F4" title="In 5.2.2 Post-Personalization Performance ‣ 5.2 Image Classification and Text Benchmarks ‣ 5 Experiments ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">4</span></a> similarly shows <span id="S5.SS2.SSS1.p1.1.5" class="ltx_text ltx_font_smallcaps">FedFish</span> outperforming <span id="S5.SS2.SSS1.p1.1.6" class="ltx_text ltx_font_smallcaps">FedAvg</span> in terms of classification accuracy and next-token prediction accuracy for CIFAR100 (left) and Stack Overflow (right) datasets, respectively. In both of these settings, <span id="S5.SS2.SSS1.p1.1.7" class="ltx_text ltx_font_smallcaps">FedFish</span> is much more robust to longer periods of local training that <span id="S5.SS2.SSS1.p1.1.8" class="ltx_text ltx_font_smallcaps">FedAvg</span>, whose performance suffers as local training increases. In <a href="#S5.F5" title="In 5.2.2 Post-Personalization Performance ‣ 5.2 Image Classification and Text Benchmarks ‣ 5 Experiments ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">5</span></a> (left), we use the heterogeneous C4 dataset for federated training and evaluate its zero-shot performance on unseen clients from C4 itself. The bottom row of the plot shows that the global model, without any personalization data, benefits considerably from increased local epochs during federated pretraining for both algorithms, with <span id="S5.SS2.SSS1.p1.1.9" class="ltx_text ltx_font_smallcaps">FedFish</span> outperforming <span id="S5.SS2.SSS1.p1.1.10" class="ltx_text ltx_font_smallcaps">FedAvg</span>.</p>
</div>
</section>
<section id="S5.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.2 </span>Post-Personalization Performance</h4>

<div id="S5.SS2.SSS2.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS2.p1.1" class="ltx_p">At scale, pretrained models are often personalized or fine-tuned for a small number of steps using local client data before deployment. Accordingly, we fine-tune the global models for a few steps on limited datapoints from held-out clients and evaluate the metrics discussed earlier. Consistent with global performance reported above, we observe across tasks that <span id="S5.SS2.SSS2.p1.1.1" class="ltx_text ltx_font_smallcaps">FedFish</span> yields models with higher post-personalization performance than those trained with <span id="S5.SS2.SSS2.p1.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span>. This is shown on EMNIST in <a href="#S5.F3" title="In Performance metrics. ‣ 5.2 Image Classification and Text Benchmarks ‣ 5 Experiments ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a> (right), on CIFAR100 in <a href="#S5.F4" title="In 5.2.2 Post-Personalization Performance ‣ 5.2 Image Classification and Text Benchmarks ‣ 5 Experiments ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">4</span></a> (left), on Stack Overflow in <a href="#S5.F4" title="In 5.2.2 Post-Personalization Performance ‣ 5.2 Image Classification and Text Benchmarks ‣ 5 Experiments ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">4</span></a> (right), and on C4 in <a href="#S5.F5" title="In 5.2.2 Post-Personalization Performance ‣ 5.2 Image Classification and Text Benchmarks ‣ 5 Experiments ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">5</span></a> (left). Notably we see that personalization worsens performance on CIFAR100 trained with <span id="S5.SS2.SSS2.p1.1.3" class="ltx_text ltx_font_smallcaps">FedAvg</span> using 16 local epochs, while substantially improving CIFAR100 trained with <span id="S5.SS2.SSS2.p1.1.4" class="ltx_text ltx_font_smallcaps">FedFish</span> using the same configuration. By contrast, <span id="S5.SS2.SSS2.p1.1.5" class="ltx_text ltx_font_smallcaps">FedAvg</span> with 16 local epochs on Stack Overflow improves dramatically with personalization, despite still underperforming all other models. Interestingly, we see in the case of C4 that more than aggregation algorithm the amount of local training seems to impact personalization performance. While both <span id="S5.SS2.SSS2.p1.1.6" class="ltx_text ltx_font_smallcaps">FedFish</span> models trained with 1 or 16 local epochs have higher zero-shot performance than either <span id="S5.SS2.SSS2.p1.1.7" class="ltx_text ltx_font_smallcaps">FedAvg</span> model, the 16 local epoch <span id="S5.SS2.SSS2.p1.1.8" class="ltx_text ltx_font_smallcaps">FedAvg</span> model’s post-personalization performance surpasses that of <span id="S5.SS2.SSS2.p1.1.9" class="ltx_text ltx_font_smallcaps">FedFish</span> with 1 local epoch as the amount of fine-tuning data increases. Overall, we find that models trained with <span id="S5.SS2.SSS2.p1.1.10" class="ltx_text ltx_font_smallcaps">FedFish</span> using longer periods of local training tend to be more amenable to personalization than models trained with <span id="S5.SS2.SSS2.p1.1.11" class="ltx_text ltx_font_smallcaps">FedAvg</span>.</p>
</div>
<figure id="S5.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S5.F4.fig1" class="ltx_figure ltx_figure_panel ltx_align_center">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/2311.10291/assets/x10.png" id="S5.F4.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="165" height="101" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S5.F4.fig2" class="ltx_figure ltx_figure_panel ltx_align_center">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/2311.10291/assets/x11.png" id="S5.F4.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="165" height="101" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Global and post-personalization performance in terms of classification accuracy on CIFAR100 (<span id="S5.F4.5.1" class="ltx_text ltx_font_bold">left</span>) and next-token prediction accuracy on Stack Overflow (<span id="S5.F4.6.2" class="ltx_text ltx_font_bold">right</span>). Varying number of local training epochs can significantly impact <span id="S5.F4.7.3" class="ltx_text ltx_font_smallcaps">FedAvg</span> performance while <span id="S5.F4.8.4" class="ltx_text ltx_font_smallcaps">FedFish</span> remains relatively robust to this.</figcaption>
</figure>
<figure id="S5.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S5.F5.fig1" class="ltx_figure ltx_figure_panel">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/2311.10291/assets/x12.png" id="S5.F5.g1" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="160" height="98" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S5.F5.fig2" class="ltx_figure ltx_figure_panel">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/2311.10291/assets/x13.png" id="S5.F5.g2" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="160" height="98" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S5.F5.fig3" class="ltx_figure ltx_figure_panel">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2311.10291/assets/x14.png" id="S5.F5.g3" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="160" height="98" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Transfer (global and post-personalization) performance in terms of next-token prediction after federated pretraining on C4 and evaluating on C4 (<span id="S5.F5.6.1" class="ltx_text ltx_font_bold">left</span>), Stack Overflow (<span id="S5.F5.7.2" class="ltx_text ltx_font_bold">center</span>) and CC-News (<span id="S5.F5.8.3" class="ltx_text ltx_font_bold">right</span>). Personalizing with 0%, 25% or 50% of held-out client data results in <span id="S5.F5.9.4" class="ltx_text ltx_font_smallcaps">FedFish</span> outperforming <span id="S5.F5.10.5" class="ltx_text ltx_font_smallcaps">FedAvg</span>, especially with longer local training.</figcaption>
</figure>
</section>
<section id="S5.SS2.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.3 </span>Transfer Performance</h4>

<div id="S5.SS2.SSS3.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS3.p1.2" class="ltx_p">Considering <span id="S5.SS2.SSS3.p1.2.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> and <span id="S5.SS2.SSS3.p1.2.2" class="ltx_text ltx_font_smallcaps">FedFish</span> as methods of federated pretraining, we further evaluate the networks trained on C4 in terms of their transfer performance (<a href="#S5.F5" title="In 5.2.2 Post-Personalization Performance ‣ 5.2 Image Classification and Text Benchmarks ‣ 5 Experiments ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">5</span></a>) on Stack Overflow (center) and CC-News (right). Here, performance is in terms of next-token prediction accuracy. We similarly report the perplexity for each of these settings in <a href="#A1.F7" title="In A.3.3 Hardware Configuration ‣ A.3 Experimental Details ‣ Appendix A Appendix ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">7</span></a>. We vary the amount of data available for personalization, between 0%, 25% and 50% of each held-out client dataset. The reported performance is always evaluated on the unseen 50% of the data. In each of these settings, we find that transfer performance benefits from longer local training for both methods and <span id="S5.SS2.SSS3.p1.2.3" class="ltx_text ltx_font_smallcaps">FedFish</span> yields better zero-shot, few-shot and post-personalization performance than <span id="S5.SS2.SSS3.p1.2.4" class="ltx_text ltx_font_smallcaps">FedAvg</span>. We observe largest gains in the case of federated pretraining on C4, followed by few-shot personalization on Stack Overflow clients, where <span id="S5.SS2.SSS3.p1.2.5" class="ltx_text ltx_font_smallcaps">FedFish</span> improves upon <span id="S5.SS2.SSS3.p1.2.6" class="ltx_text ltx_font_smallcaps">FedAvg</span>’s next-token prediction performance by 5-7%, depending on the amount of personalization data available. These results are promising since they encourage longer local training, which connotes parallelism and efficiency gains. Note, the results in <a href="#S5.F5" title="In 5.2.2 Post-Personalization Performance ‣ 5.2 Image Classification and Text Benchmarks ‣ 5 Experiments ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">5</span></a> correspond to a fixed number of federated rounds, <math id="S5.SS2.SSS3.p1.1.m1.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S5.SS2.SSS3.p1.1.m1.1a"><mi id="S5.SS2.SSS3.p1.1.m1.1.1" xref="S5.SS2.SSS3.p1.1.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p1.1.m1.1b"><ci id="S5.SS2.SSS3.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS3.p1.1.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p1.1.m1.1c">R</annotation></semantics></math>; we similarly report performance at round <math id="S5.SS2.SSS3.p1.2.m2.1" class="ltx_Math" alttext="R/2" display="inline"><semantics id="S5.SS2.SSS3.p1.2.m2.1a"><mrow id="S5.SS2.SSS3.p1.2.m2.1.1" xref="S5.SS2.SSS3.p1.2.m2.1.1.cmml"><mi id="S5.SS2.SSS3.p1.2.m2.1.1.2" xref="S5.SS2.SSS3.p1.2.m2.1.1.2.cmml">R</mi><mo id="S5.SS2.SSS3.p1.2.m2.1.1.1" xref="S5.SS2.SSS3.p1.2.m2.1.1.1.cmml">/</mo><mn id="S5.SS2.SSS3.p1.2.m2.1.1.3" xref="S5.SS2.SSS3.p1.2.m2.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p1.2.m2.1b"><apply id="S5.SS2.SSS3.p1.2.m2.1.1.cmml" xref="S5.SS2.SSS3.p1.2.m2.1.1"><divide id="S5.SS2.SSS3.p1.2.m2.1.1.1.cmml" xref="S5.SS2.SSS3.p1.2.m2.1.1.1"></divide><ci id="S5.SS2.SSS3.p1.2.m2.1.1.2.cmml" xref="S5.SS2.SSS3.p1.2.m2.1.1.2">𝑅</ci><cn type="integer" id="S5.SS2.SSS3.p1.2.m2.1.1.3.cmml" xref="S5.SS2.SSS3.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p1.2.m2.1c">R/2</annotation></semantics></math> in <a href="#A1.T5" title="In A.4 Additional Results ‣ Appendix A Appendix ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">table</span> <span class="ltx_text ltx_ref_tag">5</span></a> of <a href="#A1.SS4" title="A.4 Additional Results ‣ Appendix A Appendix ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">A.4</span></a>.</p>
</div>
<figure id="S5.F6" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F6.fig1" class="ltx_figure ltx_figure_panel">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2311.10291/assets/x15.png" id="S5.F6.g1" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="245" height="169" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F6.fig2" class="ltx_figure ltx_figure_panel">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2311.10291/assets/x16.png" id="S5.F6.g2" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="245" height="169" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F6.fig3" class="ltx_figure ltx_figure_panel">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2311.10291/assets/x17.png" id="S5.F6.g3" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="245" height="172" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F6.fig4" class="ltx_figure ltx_figure_panel">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2311.10291/assets/x18.png" id="S5.F6.g4" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="244" height="166" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Measuring the Client-Server Barriers throughout training illustrates differences in how aggregating via <span id="S5.F6.7.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> or <span id="S5.F6.8.2" class="ltx_text ltx_font_smallcaps">FedFish</span> influences the training trajectory. Colors indicate the federated round. Stack Overflow with 8 local epochs (<span id="S5.F6.9.3" class="ltx_text ltx_font_bold">top left</span>), Stack Overflow with 16 local epochs (<span id="S5.F6.10.4" class="ltx_text ltx_font_bold">top right</span>), CIFAR100 with 16 local epochs (<span id="S5.F6.11.5" class="ltx_text ltx_font_bold">bottom left</span>), and C4 with 16 local epochs (<span id="S5.F6.12.6" class="ltx_text ltx_font_bold">bottom right</span>).</figcaption>
</figure>
</section>
<section id="S5.SS2.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.4 </span>Client-Server Barrier</h4>

<div id="S5.SS2.SSS4.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS4.p1.4" class="ltx_p">To gain more insight into the performance of <span id="S5.SS2.SSS4.p1.4.1" class="ltx_text ltx_font_smallcaps">FedFish</span>, which only differs from <span id="S5.SS2.SSS4.p1.4.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> in the aggregation step, we measure the Client-Server Barrier (CSB) defined in <a href="#S4.E5" title="In 4 Evaluation and Client-Server Barrier ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">5</span></a>, using accuracy as the metric <math id="S5.SS2.SSS4.p1.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S5.SS2.SSS4.p1.1.m1.1a"><mi id="S5.SS2.SSS4.p1.1.m1.1.1" xref="S5.SS2.SSS4.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS4.p1.1.m1.1b"><ci id="S5.SS2.SSS4.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS4.p1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS4.p1.1.m1.1c">L</annotation></semantics></math>, for different model checkpoints across rounds of federated training. Note that we fix seeds to control cohort sampling in each federated round, such that the dataset iteration for <span id="S5.SS2.SSS4.p1.4.3" class="ltx_text ltx_font_smallcaps">FedAvg</span> and <span id="S5.SS2.SSS4.p1.4.4" class="ltx_text ltx_font_smallcaps">FedFish</span> training runs match. In <a href="#S5.F6" title="In 5.2.3 Transfer Performance ‣ 5.2 Image Classification and Text Benchmarks ‣ 5 Experiments ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">6</span></a>, we plot this quantity for <span id="S5.SS2.SSS4.p1.4.5" class="ltx_text ltx_font_smallcaps">FedFish</span> on the <math id="S5.SS2.SSS4.p1.2.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S5.SS2.SSS4.p1.2.m2.1a"><mi id="S5.SS2.SSS4.p1.2.m2.1.1" xref="S5.SS2.SSS4.p1.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS4.p1.2.m2.1b"><ci id="S5.SS2.SSS4.p1.2.m2.1.1.cmml" xref="S5.SS2.SSS4.p1.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS4.p1.2.m2.1c">x</annotation></semantics></math>-axis and for <span id="S5.SS2.SSS4.p1.4.6" class="ltx_text ltx_font_smallcaps">FedAvg</span> on the <math id="S5.SS2.SSS4.p1.3.m3.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S5.SS2.SSS4.p1.3.m3.1a"><mi id="S5.SS2.SSS4.p1.3.m3.1.1" xref="S5.SS2.SSS4.p1.3.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS4.p1.3.m3.1b"><ci id="S5.SS2.SSS4.p1.3.m3.1.1.cmml" xref="S5.SS2.SSS4.p1.3.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS4.p1.3.m3.1c">y</annotation></semantics></math>-axis, using networks trained on Stack Overflow with 8 local epochs (top left), Stack Overflow with 16 local epochs (top right), CIFAR100 with 16 local epochs (bottom left) and C4 with 16 local epochs (bottom right). Points lying above or below the <math id="S5.SS2.SSS4.p1.4.m4.1" class="ltx_Math" alttext="x=y" display="inline"><semantics id="S5.SS2.SSS4.p1.4.m4.1a"><mrow id="S5.SS2.SSS4.p1.4.m4.1.1" xref="S5.SS2.SSS4.p1.4.m4.1.1.cmml"><mi id="S5.SS2.SSS4.p1.4.m4.1.1.2" xref="S5.SS2.SSS4.p1.4.m4.1.1.2.cmml">x</mi><mo id="S5.SS2.SSS4.p1.4.m4.1.1.1" xref="S5.SS2.SSS4.p1.4.m4.1.1.1.cmml">=</mo><mi id="S5.SS2.SSS4.p1.4.m4.1.1.3" xref="S5.SS2.SSS4.p1.4.m4.1.1.3.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS4.p1.4.m4.1b"><apply id="S5.SS2.SSS4.p1.4.m4.1.1.cmml" xref="S5.SS2.SSS4.p1.4.m4.1.1"><eq id="S5.SS2.SSS4.p1.4.m4.1.1.1.cmml" xref="S5.SS2.SSS4.p1.4.m4.1.1.1"></eq><ci id="S5.SS2.SSS4.p1.4.m4.1.1.2.cmml" xref="S5.SS2.SSS4.p1.4.m4.1.1.2">𝑥</ci><ci id="S5.SS2.SSS4.p1.4.m4.1.1.3.cmml" xref="S5.SS2.SSS4.p1.4.m4.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS4.p1.4.m4.1c">x=y</annotation></semantics></math> line on these plots indicate whether <span id="S5.SS2.SSS4.p1.4.7" class="ltx_text ltx_font_smallcaps">FedFish</span> or <span id="S5.SS2.SSS4.p1.4.8" class="ltx_text ltx_font_smallcaps">FedAvg</span>, respectively, achieves lower CSB in those rounds. We observe the relative round-over-round aggregation performance of <span id="S5.SS2.SSS4.p1.4.9" class="ltx_text ltx_font_smallcaps">FedAvg</span> and <span id="S5.SS2.SSS4.p1.4.10" class="ltx_text ltx_font_smallcaps">FedFish</span> vary significantly for different datasets and settings throughout training. For Stack Overflow, the CSB steadily increases with rounds of training, with <span id="S5.SS2.SSS4.p1.4.11" class="ltx_text ltx_font_smallcaps">FedFish</span> achieving lower barrier than <span id="S5.SS2.SSS4.p1.4.12" class="ltx_text ltx_font_smallcaps">FedAvg</span> during later stages of federated training. This difference is more stark when training with 16 local epochs as compared to 8 local epochs. In the case of C4, while the barrier generally increases with rounds of training, we see that <span id="S5.SS2.SSS4.p1.4.13" class="ltx_text ltx_font_smallcaps">FedFish</span> tends to have lower values in the beginning stages of training while <span id="S5.SS2.SSS4.p1.4.14" class="ltx_text ltx_font_smallcaps">FedAvg</span> obtains lower CSB towards the final 20% of training rounds. This indicates connections to linear mode connectivity in later stages of training. We discuss this connection in <a href="#A1.SS5" title="A.5 Additional Related Works ‣ Appendix A Appendix ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">A.5</span></a> and leave deeper explorations to future work. Interestingly, CIFAR100 CSB values decrease with rounds of federated training with <span id="S5.SS2.SSS4.p1.4.15" class="ltx_text ltx_font_smallcaps">FedFish</span> achieving lower barrier than <span id="S5.SS2.SSS4.p1.4.16" class="ltx_text ltx_font_smallcaps">FedAvg</span> throughout. On investigating further, we find that the client and data splits on CIFAR100 are such that each local model achieves very high performance right from the beginning of training, and maintains that performance throughout. Hence, the reduction in CSB as rounds increase is indicative of the improvement of the global model as it bridges its gap to local models. This is in contrast to the other datasets we present, wherein the local models often improve their performance more gradually.</p>
</div>
</section>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Communication Cost</h3>

<div id="S5.SS3.p1" class="ltx_para ltx_noindent">
<p id="S5.SS3.p1.1" class="ltx_p">In general, cost of communication between clients and the server is directly related to the number of rounds of federated training as well as the number of units of (parametric) information to be exchanged. So far, we have demonstrated that <span id="S5.SS3.p1.1.1" class="ltx_text ltx_font_smallcaps">FedFish</span> can reduce the number of communication rounds by allowing longer local training.
However, the procedure described in <a href="#alg1" title="In 3 FedFish Algorithm ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">algorithm</span> <span class="ltx_text ltx_ref_tag">1</span></a> requires clients to communicate their parameters as well as Fisher diagonals to the global server. Relative to <span id="S5.SS3.p1.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span>, this increases communication cost of per round by a factor of two for <span id="S5.SS3.p1.1.3" class="ltx_text ltx_font_smallcaps">FedFish</span>.
However, as demonstrated in <a href="#S5.F3" title="In Performance metrics. ‣ 5.2 Image Classification and Text Benchmarks ‣ 5 Experiments ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a>, the advantage of training with <span id="S5.SS3.p1.1.4" class="ltx_text ltx_font_smallcaps">FedFish</span> for more local epochs can eliminate the communication overhead from our <span id="S5.SS3.p1.1.5" class="ltx_text ltx_font_smallcaps">FedFish</span> implementation when achieving comparable accuracy to <span id="S5.SS3.p1.1.6" class="ltx_text ltx_font_smallcaps">FedAvg</span> in half the number of communication rounds (compare EMNIST <span id="S5.SS3.p1.1.7" class="ltx_text ltx_font_smallcaps">FedAvg</span> with 8 local epochs after 800 communication rounds to EMNIST <span id="S5.SS3.p1.1.8" class="ltx_text ltx_font_smallcaps">FedFish</span> with 16 local epochs after 400 communication rounds). Alternatively, our method can be combined with adaptive federated optimization techniques <cite class="ltx_cite ltx_citemacro_citep">(Reddi et al., <a href="#bib.bib38" title="" class="ltx_ref">2020</a>)</cite> so that clients only have to communicate their weighted parameters, <math id="S5.SS3.p1.1.m1.1" class="ltx_Math" alttext="\text{diag}(F_{i})^{T}{\mathbf{\theta}}_{i}" display="inline"><semantics id="S5.SS3.p1.1.m1.1a"><mrow id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml"><mtext id="S5.SS3.p1.1.m1.1.1.3" xref="S5.SS3.p1.1.m1.1.1.3a.cmml">diag</mtext><mo lspace="0em" rspace="0em" id="S5.SS3.p1.1.m1.1.1.2" xref="S5.SS3.p1.1.m1.1.1.2.cmml">​</mo><msup id="S5.SS3.p1.1.m1.1.1.1" xref="S5.SS3.p1.1.m1.1.1.1.cmml"><mrow id="S5.SS3.p1.1.m1.1.1.1.1.1" xref="S5.SS3.p1.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.SS3.p1.1.m1.1.1.1.1.1.2" xref="S5.SS3.p1.1.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S5.SS3.p1.1.m1.1.1.1.1.1.1" xref="S5.SS3.p1.1.m1.1.1.1.1.1.1.cmml"><mi id="S5.SS3.p1.1.m1.1.1.1.1.1.1.2" xref="S5.SS3.p1.1.m1.1.1.1.1.1.1.2.cmml">F</mi><mi id="S5.SS3.p1.1.m1.1.1.1.1.1.1.3" xref="S5.SS3.p1.1.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S5.SS3.p1.1.m1.1.1.1.1.1.3" xref="S5.SS3.p1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S5.SS3.p1.1.m1.1.1.1.3" xref="S5.SS3.p1.1.m1.1.1.1.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S5.SS3.p1.1.m1.1.1.2a" xref="S5.SS3.p1.1.m1.1.1.2.cmml">​</mo><msub id="S5.SS3.p1.1.m1.1.1.4" xref="S5.SS3.p1.1.m1.1.1.4.cmml"><mi id="S5.SS3.p1.1.m1.1.1.4.2" xref="S5.SS3.p1.1.m1.1.1.4.2.cmml">θ</mi><mi id="S5.SS3.p1.1.m1.1.1.4.3" xref="S5.SS3.p1.1.m1.1.1.4.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><apply id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1"><times id="S5.SS3.p1.1.m1.1.1.2.cmml" xref="S5.SS3.p1.1.m1.1.1.2"></times><ci id="S5.SS3.p1.1.m1.1.1.3a.cmml" xref="S5.SS3.p1.1.m1.1.1.3"><mtext id="S5.SS3.p1.1.m1.1.1.3.cmml" xref="S5.SS3.p1.1.m1.1.1.3">diag</mtext></ci><apply id="S5.SS3.p1.1.m1.1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.1.m1.1.1.1.2.cmml" xref="S5.SS3.p1.1.m1.1.1.1">superscript</csymbol><apply id="S5.SS3.p1.1.m1.1.1.1.1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S5.SS3.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S5.SS3.p1.1.m1.1.1.1.1.1.1.2">𝐹</ci><ci id="S5.SS3.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S5.SS3.p1.1.m1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S5.SS3.p1.1.m1.1.1.1.3.cmml" xref="S5.SS3.p1.1.m1.1.1.1.3">𝑇</ci></apply><apply id="S5.SS3.p1.1.m1.1.1.4.cmml" xref="S5.SS3.p1.1.m1.1.1.4"><csymbol cd="ambiguous" id="S5.SS3.p1.1.m1.1.1.4.1.cmml" xref="S5.SS3.p1.1.m1.1.1.4">subscript</csymbol><ci id="S5.SS3.p1.1.m1.1.1.4.2.cmml" xref="S5.SS3.p1.1.m1.1.1.4.2">𝜃</ci><ci id="S5.SS3.p1.1.m1.1.1.4.3.cmml" xref="S5.SS3.p1.1.m1.1.1.4.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">\text{diag}(F_{i})^{T}{\mathbf{\theta}}_{i}</annotation></semantics></math> and the normalization step is folded into the server optimization. In this case, the communication cost of <span id="S5.SS3.p1.1.9" class="ltx_text ltx_font_smallcaps">FedFish</span> would be the same, per round, as that of <span id="S5.SS3.p1.1.10" class="ltx_text ltx_font_smallcaps">FedAvg</span>. We leave this adaptive extension of our method to future work.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Related Work</h2>

<section id="S6.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Federated Learning.</h5>

<div id="S6.SS0.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S6.SS0.SSS0.Px1.p1.1" class="ltx_p">Federated Learning (FL) is a well-established paradigm, introduced in <cite class="ltx_cite ltx_citemacro_citet">McMahan et al. (<a href="#bib.bib33" title="" class="ltx_ref">2017</a>)</cite> and advanced through variants that account for adaptive optimization <cite class="ltx_cite ltx_citemacro_citep">(Reddi et al., <a href="#bib.bib38" title="" class="ltx_ref">2020</a>)</cite>, client drift <cite class="ltx_cite ltx_citemacro_citep">(Karimireddy et al., <a href="#bib.bib23" title="" class="ltx_ref">2020</a>)</cite> or heterogeneity <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib29" title="" class="ltx_ref">2020</a>)</cite>. Recent works have also explored its connections to representation learning <cite class="ltx_cite ltx_citemacro_citep">(Collins et al., <a href="#bib.bib10" title="" class="ltx_ref">2022</a>)</cite> and meta-learning <cite class="ltx_cite ltx_citemacro_citep">(Charles et al., <a href="#bib.bib8" title="" class="ltx_ref">2023</a>)</cite>.
Relevant to our function space perspective of FL are frameworks that view FL as a distributed inference problem. <cite class="ltx_cite ltx_citemacro_citet">Al-Shedivat et al. (<a href="#bib.bib1" title="" class="ltx_ref">2021</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Guo et al. (<a href="#bib.bib18" title="" class="ltx_ref">2023</a>)</cite> aim to approximate local posterior distributions over client parameters, deriving MCMC-based and variational inference objectives, respectively. Performance of both these methods rely on a “burn-in" period of <span id="S6.SS0.SSS0.Px1.p1.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> training, after which the proposed algorithms are applied. The amount of burn-in training is a crucial hyperparameter and given this setting, <cite class="ltx_cite ltx_citemacro_citet">Hou et al. (<a href="#bib.bib20" title="" class="ltx_ref">2022</a>)</cite> find that simply chaining <span id="S6.SS0.SSS0.Px1.p1.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> and <span id="S6.SS0.SSS0.Px1.p1.1.3" class="ltx_text ltx_font_smallcaps">FedSGD</span> is actually a theoretically sound, efficient alternative.</p>
</div>
<div id="S6.SS0.SSS0.Px1.p2" class="ltx_para ltx_noindent">
<p id="S6.SS0.SSS0.Px1.p2.1" class="ltx_p">This work evaluates performance in settings with varied amounts of local training. At the extreme of the local training spectrum are methods that operate in the <em id="S6.SS0.SSS0.Px1.p2.1.1" class="ltx_emph ltx_font_italic">one-shot</em> setting <cite class="ltx_cite ltx_citemacro_citep">(Guha et al., <a href="#bib.bib17" title="" class="ltx_ref">2019</a>)</cite>, to take advantage of local models that are independently trained to convergence and aggregated only once. This single-round training is a special case of FL and leads to aggregation objectives derived for optimal local models. In practice, not all clients are available simultaneously and coordinating a single round of FL is unrealistic when there are millions of clients. In contrast, the more general multi-round setting has the advantage of allowing for new clients and for clients to benefit from each other indirectly.
This is the setting our work has focused on, where at each round, client models are initialized from the global model obtained in the previous round, intuitively allowing future clients to leverage information aggregated previously.</p>
</div>
<div id="S6.SS0.SSS0.Px1.p3" class="ltx_para ltx_noindent">
<p id="S6.SS0.SSS0.Px1.p3.1" class="ltx_p">Concurrent to our work, <cite class="ltx_cite ltx_citemacro_citet">Jhunjhunwala et al. (<a href="#bib.bib21" title="" class="ltx_ref">2023</a>)</cite> also experiment with the one-shot setting and propose to optimize a Fisher-weighted objective to train the global model for several epochs after all clients converge independently. In contrast, our work proposes a method for general multi-round federated training from scratch, with iterative global aggregation that is computationally equivalent to one iteration per round.
The function space aggregation perspective makes no assumptions about the optimality of client models and motivates application of resulting algorithms to FL settings with multiple rounds.
The resulting method is constrained to neither few local steps nor full local convergence. It is robust to local hyperparameter choices, which can otherwise be expensive and tedious to tune.</p>
</div>
</section>
<section id="S6.SS0.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Model aggregation.</h5>

<div id="S6.SS0.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S6.SS0.SSS0.Px2.p1.1" class="ltx_p">Model aggregation has recently received attention in a number of works, most of which differ in their data and training choices during pretraining and fine-tuning, as opposed to the aggregation technique itself.
For example, <cite class="ltx_cite ltx_citemacro_citet">Wortsman et al. (<a href="#bib.bib41" title="" class="ltx_ref">2022</a>)</cite> average parameters of models trained using different hyperparameters, random seeds, etc.
<cite class="ltx_cite ltx_citemacro_citet">Rame et al. (<a href="#bib.bib37" title="" class="ltx_ref">2023</a>)</cite> build on this to reuse foundation models fine-tuned on an auxiliary task.
In these works, fine-tuning started from the same model is likely to yield networks in the same loss basin for a new task, thus enabling parameter-space averaging and exploiting model diversity to improve performance.
Model averaging has also shown up in the empirical study of <cite class="ltx_cite ltx_citemacro_citet">Li et al. (<a href="#bib.bib28" title="" class="ltx_ref">2022</a>)</cite> showing benefits of parallel fine-tuning of large language models on diverse data over monolithic single-model training. Similar motivations appear in <cite class="ltx_cite ltx_citemacro_citet">Gu et al. (<a href="#bib.bib16" title="" class="ltx_ref">2023</a>)</cite>. <cite class="ltx_cite ltx_citemacro_citet">Matena &amp; Raffel (<a href="#bib.bib32" title="" class="ltx_ref">2022</a>)</cite> also implement a specific Fisher-weighting, but only evaluate it in the one-shot setting to merge converged or optimal models.
In fact, model averaging has been in practical use for large models at least since <cite class="ltx_cite ltx_citemacro_citet">Vaswani et al. (<a href="#bib.bib39" title="" class="ltx_ref">2017</a>)</cite>, where final models are the result of averaging previous checkpoints.
We believe our motivations for model aggregation are general and their application to these varied settings is exciting future work.</p>
</div>
<div id="S6.SS0.SSS0.Px2.p2" class="ltx_para ltx_noindent">
<p id="S6.SS0.SSS0.Px2.p2.1" class="ltx_p">Additional literature relevant to the Client-Server Barrier evaluation criterion (<a href="#S4" title="4 Evaluation and Client-Server Barrier ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">4</span></a>) is discussed in <a href="#A1.SS5" title="A.5 Additional Related Works ‣ Appendix A Appendix ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">A.5</span></a>.</p>
</div>
</section>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Discussion and Outlook</h2>

<div id="S7.p1" class="ltx_para ltx_noindent">
<p id="S7.p1.1" class="ltx_p">In this work, we provided a function-space perspective of federated learning and proposed an aggregation technique for locally trained client models based on the input-output functions they parameterize.
<span id="S7.p1.1.1" class="ltx_text ltx_font_smallcaps">FedFish</span> is a parametric, iterative algorithm that is robust to longer local training and client data heterogeneity.</p>
</div>
<div id="S7.p2" class="ltx_para ltx_noindent">
<p id="S7.p2.1" class="ltx_p">While we have highlighted the settings where <span id="S7.p2.1.1" class="ltx_text ltx_font_smallcaps">FedFish</span> has advantages over <span id="S7.p2.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span>, we now discuss its limitations and possible extensions. First, <span id="S7.p2.1.3" class="ltx_text ltx_font_smallcaps">FedFish</span> is derived from a second-order Taylor expansion of a function space distance. There is scope to go beyond this quadratic form for better approximations (for an example, see <cite class="ltx_cite ltx_citemacro_citet">Dhawan et al. (<a href="#bib.bib12" title="" class="ltx_ref">2023</a>)</cite>) to derive parametric model aggregation objectives.
Second, we make a diagonal approximation to the Fisher Information matrix that effectively treats each parameter as independent.
It is well-understood that deep neural network parameters are highly correlated. Better approximations to the Fisher Information matrix, such as K-FAC <cite class="ltx_cite ltx_citemacro_citep">(Martens &amp; Grosse, <a href="#bib.bib31" title="" class="ltx_ref">2015</a>)</cite> or FishLeg <cite class="ltx_cite ltx_citemacro_citep">(Garcia et al., <a href="#bib.bib15" title="" class="ltx_ref">2023</a>)</cite>, could further boost Fisher-weighted model aggregation.
However, higher dimensional approximations to the Fisher Information matrix present new challenges if applied naively, since they often increase computational burden and/or communication costs between clients and the server. Critical to compatibility with FL systems in practice, <span id="S7.p2.1.4" class="ltx_text ltx_font_smallcaps">FedFish</span> can also be easily combined with adaptive optimization techniques as well as differentially private training.</p>
</div>
<div id="S7.p3" class="ltx_para ltx_noindent">
<p id="S7.p3.1" class="ltx_p">The demonstrated advantage of <span id="S7.p3.1.1" class="ltx_text ltx_font_smallcaps">FedFish</span> over <span id="S7.p3.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> across various large-scale settings, in terms of global performance, personalization, transfer to shifted distributions and a Client-Server Barrier metric, presents a compelling case for applying this aggregation technique more broadly. While our primary focus is FL at scale, a function-based model aggregation method and the barrier-based evaluation can be applied in any other setting where multiple models of the same architecture are trained with potentially different optimization algorithms, randomness, hyperparameters, data splits, etc.
These use cases may allow more flexibility in the use of data, presenting new opportunities for improved function space aggregation.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Al-Shedivat et al. (2021)</span>
<span class="ltx_bibblock">
Maruan Al-Shedivat, Jennifer Gillenwater, Eric Xing, and Afshin Rostamizadeh.

</span>
<span class="ltx_bibblock">Federated learning via posterior averaging: A new perspective and
practical algorithms.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=GFsU8a0sGB" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=GFsU8a0sGB</a>.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Assran et al. (2020)</span>
<span class="ltx_bibblock">
Mahmoud Assran, Arda Aytekin, Hamid Reza Feyzmahdavian, Mikael Johansson, and
Michael G Rabbat.

</span>
<span class="ltx_bibblock">Advances in asynchronous parallel and distributed optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE</em>, 108(11):2013–2031, 2020.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Authors (2019)</span>
<span class="ltx_bibblock">
The TensorFlow Federated Authors.

</span>
<span class="ltx_bibblock">TensorFlow Federated Stack Overflow dataset, 2019.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="https://www.tensorflow.org/federated/api_docs/python/tff/simulation/datasets/stackoverflow/load_data" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.tensorflow.org/federated/api_docs/python/tff/simulation/datasets/stackoverflow/load_data</a>.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Benjamin et al. (2018)</span>
<span class="ltx_bibblock">
Ari S Benjamin, David Rolnick, and Konrad Kording.

</span>
<span class="ltx_bibblock">Measuring and regularizing networks in function space.

</span>
<span class="ltx_bibblock">In <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2018.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Caldas et al. (2018)</span>
<span class="ltx_bibblock">
Sebastian Caldas, Sai Meher Karthik Duddu, Peter Wu, Tian Li, Jakub
Konečnỳ, H Brendan McMahan, Virginia Smith, and Ameet Talwalkar.

</span>
<span class="ltx_bibblock">Leaf: A benchmark for federated settings.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1812.01097</em>, 2018.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Charles &amp; Konečnỳ (2021)</span>
<span class="ltx_bibblock">
Zachary Charles and Jakub Konečnỳ.

</span>
<span class="ltx_bibblock">Convergence and accuracy trade-offs in federated learning and
meta-learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">International Conference on Artificial Intelligence and
Statistics</em>, pp.  2575–2583. PMLR, 2021.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Charles &amp; Rush (2022)</span>
<span class="ltx_bibblock">
Zachary Charles and Keith Rush.

</span>
<span class="ltx_bibblock">Iterated vector fields and conservatism, with applications to
federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">International Conference on Algorithmic Learning Theory</em>,
pp.  130–147. PMLR, 2022.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Charles et al. (2023)</span>
<span class="ltx_bibblock">
Zachary Charles, Nicole Mitchell, Krishna Pillutla, Michael Reneer, and Zachary
Garrett.

</span>
<span class="ltx_bibblock">Towards federated foundation models: Scalable dataset pipelines for
group-structured learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2307.09619</em>, 2023.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cohen et al. (2017)</span>
<span class="ltx_bibblock">
Gregory Cohen, Saeed Afshar, Jonathan Tapson, and Andre Van Schaik.

</span>
<span class="ltx_bibblock">Emnist: Extending mnist to handwritten letters.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">2017 International Joint Conference on Neural Networks
(IJCNN)</em>, 2017.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/ijcnn.2017.7966217</span>.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Collins et al. (2022)</span>
<span class="ltx_bibblock">
Liam Collins, Hamed Hassani, Aryan Mokhtari, and Sanjay Shakkottai.

</span>
<span class="ltx_bibblock">Fedavg with fine tuning: Local updates lead to representation
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
35:10572–10586, 2022.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cover (1999)</span>
<span class="ltx_bibblock">
Thomas M Cover.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Elements of information theory</em>.

</span>
<span class="ltx_bibblock">John Wiley &amp; Sons, 1999.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dhawan et al. (2023)</span>
<span class="ltx_bibblock">
Nikita Dhawan, Sicong Huang, Juhan Bae, and Roger Baker Grosse.

</span>
<span class="ltx_bibblock">Efficient parametric approximations of neural network function space
distance.

</span>
<span class="ltx_bibblock">In <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 7795–7812. PMLR, 2023.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fort et al. (2020)</span>
<span class="ltx_bibblock">
Stanislav Fort, Gintare Karolina Dziugaite, Mansheej Paul, Sepideh Kharaghani,
Daniel M Roy, and Surya Ganguli.

</span>
<span class="ltx_bibblock">Deep learning versus kernel learning: an empirical study of loss
landscape geometry and the time evolution of the neural tangent kernel.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
33:5850–5861, 2020.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Frankle et al. (2020)</span>
<span class="ltx_bibblock">
Jonathan Frankle, Gintare Karolina Dziugaite, Daniel M Roy, and Michael Carbin.

</span>
<span class="ltx_bibblock">Linear mode connectivity and the lottery ticket hypothesis.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 3259–3269. PMLR, 2020.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Garcia et al. (2023)</span>
<span class="ltx_bibblock">
Jezabel R Garcia, Federica Freddi, Stathi Fotiadis, Maolin Li, Sattar Vakili,
Alberto Bernacchia, and Guillaume Hennequin.

</span>
<span class="ltx_bibblock">Fisher-legendre (fishleg) optimization of deep neural networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">The Eleventh International Conference on Learning
Representations</em>, 2023.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=c9lAOPvQHS" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=c9lAOPvQHS</a>.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et al. (2023)</span>
<span class="ltx_bibblock">
Xinran Gu, Kaifeng Lyu, Longbo Huang, and Sanjeev Arora.

</span>
<span class="ltx_bibblock">Why (and when) does local sgd generalize better than sgd?

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2303.01215</em>, 2023.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guha et al. (2019)</span>
<span class="ltx_bibblock">
Neel Guha, Ameet Talwalkar, and Virginia Smith.

</span>
<span class="ltx_bibblock">One-shot federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1902.11175</em>, 2019.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2023)</span>
<span class="ltx_bibblock">
Han Guo, Philip Greengard, Hongyi Wang, Andrew Gelman, Yoon Kim, and Eric Xing.

</span>
<span class="ltx_bibblock">Federated learning as variational inference: A scalable expectation
propagation approach.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">The Eleventh International Conference on Learning
Representations</em>, 2023.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=dZrQR7OR11" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=dZrQR7OR11</a>.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hamborg et al. (2017)</span>
<span class="ltx_bibblock">
Felix Hamborg, Norman Meuschke, Corinna Breitinger, and Bela Gipp.

</span>
<span class="ltx_bibblock">news-please: A generic news crawler and extractor.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 15th International Symposium of
Information Science</em>, pp.  218–223, March 2017.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.5281/zenodo.4120316</span>.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hou et al. (2022)</span>
<span class="ltx_bibblock">
Charlie Hou, Kiran Koshy Thekumparampil, Giulia Fanti, and Sewoong Oh.

</span>
<span class="ltx_bibblock">Fedchain: Chained algorithms for near-optimal communication cost in
federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2022.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=ZaVVVlcdaN" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=ZaVVVlcdaN</a>.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jhunjhunwala et al. (2023)</span>
<span class="ltx_bibblock">
Divyansh Jhunjhunwala, Shiqiang Wang, and Gauri Joshi.

</span>
<span class="ltx_bibblock">Towards a theoretical and practical understanding of one-shot
federated learning with Fisher information.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Federated Learning and Analytics in Practice: Algorithms,
Systems, Applications, and Opportunities</em>, 2023.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz et al. (2021)</span>
<span class="ltx_bibblock">
Peter Kairouz, H Brendan McMahan, Brendan Avent, Aurélien Bellet, Mehdi
Bennis, Arjun Nitin Bhagoji, Kallista Bonawitz, Zachary Charles, Graham
Cormode, Rachel Cummings, et al.

</span>
<span class="ltx_bibblock">Advances and open problems in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Foundations and Trends® in Machine Learning</em>,
14(1–2):1–210, 2021.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy et al. (2020)</span>
<span class="ltx_bibblock">
Sai Praneeth Karimireddy, Satyen Kale, Mehryar Mohri, Sashank Reddi, Sebastian
Stich, and Ananda Theertha Suresh.

</span>
<span class="ltx_bibblock">Scaffold: Stochastic controlled averaging for federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>, pp. 5132–5143. PMLR, 2020.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kirkpatrick et al. (2017)</span>
<span class="ltx_bibblock">
James Kirkpatrick, Razvan Pascanu, Neil Rabinowitz, Joel Veness, Guillaume
Desjardins, Andrei A Rusu, Kieran Milan, John Quan, Tiago Ramalho, Agnieszka
Grabska-Barwinska, et al.

</span>
<span class="ltx_bibblock">Overcoming catastrophic forgetting in neural networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Proceedings of the national academy of sciences</em>, 114(13):3521–3526, 2017.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(25)</span>
<span class="ltx_bibblock">
Alex Krizhevsky, Vinod Nair, and Geoffrey Hinton.

</span>
<span class="ltx_bibblock">Cifar-100 (canadian institute for advanced research).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://www.cs.toronto.edu/~kriz/cifar.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://www.cs.toronto.edu/~kriz/cifar.html</a>.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kuo et al. (2023)</span>
<span class="ltx_bibblock">
Kevin Kuo, Pratiksha Thaker, Mikhail Khodak, John Nguyen, Daniel Jiang, Ameet
Talwalkar, and Virginia Smith.

</span>
<span class="ltx_bibblock">On noisy evaluation in federated hyperparameter tuning.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning and Systems</em>, 5, 2023.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lecun et al. (1998)</span>
<span class="ltx_bibblock">
Y. Lecun, L. Bottou, Y. Bengio, and P. Haffner.

</span>
<span class="ltx_bibblock">Gradient-based learning applied to document recognition.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE</em>, 86(11):2278–2324, 1998.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/5.726791</span>.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2022)</span>
<span class="ltx_bibblock">
Margaret Li, Suchin Gururangan, Tim Dettmers, Mike Lewis, Tim Althoff, Noah A
Smith, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">Branch-train-merge: Embarrassingly parallel training of expert
language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2208.03306</em>, 2022.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020)</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and
Virginia Smith.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine learning and systems</em>, 2:429–450, 2020.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Malinovskiy et al. (2020)</span>
<span class="ltx_bibblock">
Grigory Malinovskiy, Dmitry Kovalev, Elnur Gasanov, Laurent Condat, and Peter
Richtarik.

</span>
<span class="ltx_bibblock">From local SGD to local fixed-point methods for federated learning.

</span>
<span class="ltx_bibblock">In Hal Daumé III and Aarti Singh (eds.), <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Proceedings of the
37th International Conference on Machine Learning</em>, volume 119 of
<em id="bib.bib30.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>, pp.  6692–6701. PMLR,
13–18 Jul 2020.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.mlr.press/v119/malinovskiy20a.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v119/malinovskiy20a.html</a>.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Martens &amp; Grosse (2015)</span>
<span class="ltx_bibblock">
James Martens and Roger Grosse.

</span>
<span class="ltx_bibblock">Optimizing neural networks with kronecker-factored approximate
curvature.

</span>
<span class="ltx_bibblock">In <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>, pp. 2408–2417. PMLR, 2015.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Matena &amp; Raffel (2022)</span>
<span class="ltx_bibblock">
Michael S Matena and Colin A Raffel.

</span>
<span class="ltx_bibblock">Merging models with Fisher-weighted averaging.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
35:17703–17716, 2022.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera
y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence and statistics</em>, pp.  1273–1282.
PMLR, 2017.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mitra et al. (2021)</span>
<span class="ltx_bibblock">
Aritra Mitra, Rayana Jaafar, George J Pappas, and Hamed Hassani.

</span>
<span class="ltx_bibblock">Linear convergence in federated learning: Tackling client
heterogeneity and sparse gradients.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
34:14606–14619, 2021.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pathak &amp; Wainwright (2020)</span>
<span class="ltx_bibblock">
Reese Pathak and Martin J Wainwright.

</span>
<span class="ltx_bibblock">FedSplit: An algorithmic framework for fast federated optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>,
33:7057–7066, 2020.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raffel et al. (2020)</span>
<span class="ltx_bibblock">
Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael
Matena, Yanqi Zhou, Wei Li, and Peter J Liu.

</span>
<span class="ltx_bibblock">Exploring the limits of transfer learning with a unified text-to-text
transformer.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">The Journal of Machine Learning Research</em>, 21(1):5485–5551, 2020.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rame et al. (2023)</span>
<span class="ltx_bibblock">
Alexandre Rame, Kartik Ahuja, Jianyu Zhang, Matthieu Cord, Léon Bottou, and
David Lopez-Paz.

</span>
<span class="ltx_bibblock">Model ratatouille: Recycling diverse models for out-of-distribution
generalization.

</span>
<span class="ltx_bibblock">2023.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reddi et al. (2020)</span>
<span class="ltx_bibblock">
Sashank Reddi, Zachary Charles, Manzil Zaheer, Zachary Garrett, Keith Rush,
Jakub Konečnỳ, Sanjiv Kumar, and H Brendan McMahan.

</span>
<span class="ltx_bibblock">Adaptive federated optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2003.00295</em>, 2020.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 30, 2017.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2021)</span>
<span class="ltx_bibblock">
Jianyu Wang, Zachary Charles, Zheng Xu, Gauri Joshi, H Brendan McMahan, Maruan
Al-Shedivat, Galen Andrew, Salman Avestimehr, Katharine Daly, Deepesh Data,
et al.

</span>
<span class="ltx_bibblock">A field guide to federated optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2107.06917</em>, 2021.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wortsman et al. (2022)</span>
<span class="ltx_bibblock">
Mitchell Wortsman, Gabriel Ilharco, Samir Ya Gadre, Rebecca Roelofs, Raphael
Gontijo-Lopes, Ari S Morcos, Hongseok Namkoong, Ali Farhadi, Yair Carmon,
Simon Kornblith, et al.

</span>
<span class="ltx_bibblock">Model soups: averaging weights of multiple fine-tuned models improves
accuracy without increasing inference time.

</span>
<span class="ltx_bibblock">In <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 23965–23998. PMLR, 2022.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>

<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Notation</h3>

<div id="A1.SS1.p1" class="ltx_para ltx_noindent">
<table id="A1.SS1.p1.19" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A1.SS1.p1.1.1" class="ltx_tr">
<td id="A1.SS1.p1.1.1.1" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.1.1.1.1.1" class="ltx_p" style="width:54.2pt;"><math id="A1.SS1.p1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\displaystyle f" display="inline"><semantics id="A1.SS1.p1.1.1.1.1.1.m1.1a"><mi id="A1.SS1.p1.1.1.1.1.1.m1.1.1" xref="A1.SS1.p1.1.1.1.1.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.1.1.1.1.1.m1.1b"><ci id="A1.SS1.p1.1.1.1.1.1.m1.1.1.cmml" xref="A1.SS1.p1.1.1.1.1.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.1.1.1.1.1.m1.1c">\displaystyle f</annotation></semantics></math></span>
</span>
</td>
<td id="A1.SS1.p1.1.1.2" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.1.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.1.1.2.1.1" class="ltx_p" style="width:289.1pt;">Function represented by a neural network</span>
</span>
</td>
</tr>
<tr id="A1.SS1.p1.2.2" class="ltx_tr">
<td id="A1.SS1.p1.2.2.1" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.2.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.2.2.1.1.1" class="ltx_p" style="width:54.2pt;"><math id="A1.SS1.p1.2.2.1.1.1.m1.1" class="ltx_Math" alttext="\displaystyle{\mathbf{\theta}}" display="inline"><semantics id="A1.SS1.p1.2.2.1.1.1.m1.1a"><mi id="A1.SS1.p1.2.2.1.1.1.m1.1.1" xref="A1.SS1.p1.2.2.1.1.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.2.2.1.1.1.m1.1b"><ci id="A1.SS1.p1.2.2.1.1.1.m1.1.1.cmml" xref="A1.SS1.p1.2.2.1.1.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.2.2.1.1.1.m1.1c">\displaystyle{\mathbf{\theta}}</annotation></semantics></math></span>
</span>
</td>
<td id="A1.SS1.p1.2.2.2" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.2.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.2.2.2.1.1" class="ltx_p" style="width:289.1pt;">Network parameters</span>
</span>
</td>
</tr>
<tr id="A1.SS1.p1.3.3" class="ltx_tr">
<td id="A1.SS1.p1.3.3.1" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.3.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.3.3.1.1.1" class="ltx_p" style="width:54.2pt;"><math id="A1.SS1.p1.3.3.1.1.1.m1.2" class="ltx_Math" alttext="\displaystyle\mathcal{D}\left(\cdot,\cdot\right)" display="inline"><semantics id="A1.SS1.p1.3.3.1.1.1.m1.2a"><mrow id="A1.SS1.p1.3.3.1.1.1.m1.2.3" xref="A1.SS1.p1.3.3.1.1.1.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS1.p1.3.3.1.1.1.m1.2.3.2" xref="A1.SS1.p1.3.3.1.1.1.m1.2.3.2.cmml">𝒟</mi><mo lspace="0em" rspace="0em" id="A1.SS1.p1.3.3.1.1.1.m1.2.3.1" xref="A1.SS1.p1.3.3.1.1.1.m1.2.3.1.cmml">​</mo><mrow id="A1.SS1.p1.3.3.1.1.1.m1.2.3.3.2" xref="A1.SS1.p1.3.3.1.1.1.m1.2.3.3.1.cmml"><mo id="A1.SS1.p1.3.3.1.1.1.m1.2.3.3.2.1" xref="A1.SS1.p1.3.3.1.1.1.m1.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="A1.SS1.p1.3.3.1.1.1.m1.1.1" xref="A1.SS1.p1.3.3.1.1.1.m1.1.1.cmml">⋅</mo><mo rspace="0em" id="A1.SS1.p1.3.3.1.1.1.m1.2.3.3.2.2" xref="A1.SS1.p1.3.3.1.1.1.m1.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="A1.SS1.p1.3.3.1.1.1.m1.2.2" xref="A1.SS1.p1.3.3.1.1.1.m1.2.2.cmml">⋅</mo><mo id="A1.SS1.p1.3.3.1.1.1.m1.2.3.3.2.3" xref="A1.SS1.p1.3.3.1.1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.3.3.1.1.1.m1.2b"><apply id="A1.SS1.p1.3.3.1.1.1.m1.2.3.cmml" xref="A1.SS1.p1.3.3.1.1.1.m1.2.3"><times id="A1.SS1.p1.3.3.1.1.1.m1.2.3.1.cmml" xref="A1.SS1.p1.3.3.1.1.1.m1.2.3.1"></times><ci id="A1.SS1.p1.3.3.1.1.1.m1.2.3.2.cmml" xref="A1.SS1.p1.3.3.1.1.1.m1.2.3.2">𝒟</ci><interval closure="open" id="A1.SS1.p1.3.3.1.1.1.m1.2.3.3.1.cmml" xref="A1.SS1.p1.3.3.1.1.1.m1.2.3.3.2"><ci id="A1.SS1.p1.3.3.1.1.1.m1.1.1.cmml" xref="A1.SS1.p1.3.3.1.1.1.m1.1.1">⋅</ci><ci id="A1.SS1.p1.3.3.1.1.1.m1.2.2.cmml" xref="A1.SS1.p1.3.3.1.1.1.m1.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.3.3.1.1.1.m1.2c">\displaystyle\mathcal{D}\left(\cdot,\cdot\right)</annotation></semantics></math></span>
</span>
</td>
<td id="A1.SS1.p1.3.3.2" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.3.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.3.3.2.1.1" class="ltx_p" style="width:289.1pt;">Function space distance</span>
</span>
</td>
</tr>
<tr id="A1.SS1.p1.4.4" class="ltx_tr">
<td id="A1.SS1.p1.4.4.1" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.4.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.4.4.1.1.1" class="ltx_p" style="width:54.2pt;"><math id="A1.SS1.p1.4.4.1.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{X}" display="inline"><semantics id="A1.SS1.p1.4.4.1.1.1.m1.1a"><mi id="A1.SS1.p1.4.4.1.1.1.m1.1.1" xref="A1.SS1.p1.4.4.1.1.1.m1.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.4.4.1.1.1.m1.1b"><ci id="A1.SS1.p1.4.4.1.1.1.m1.1.1.cmml" xref="A1.SS1.p1.4.4.1.1.1.m1.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.4.4.1.1.1.m1.1c">\displaystyle\mathbf{X}</annotation></semantics></math></span>
</span>
</td>
<td id="A1.SS1.p1.4.4.2" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.4.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.4.4.2.1.1" class="ltx_p" style="width:289.1pt;">Input data</span>
</span>
</td>
</tr>
<tr id="A1.SS1.p1.5.5" class="ltx_tr">
<td id="A1.SS1.p1.5.5.1" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.5.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.5.5.1.1.1" class="ltx_p" style="width:54.2pt;"><math id="A1.SS1.p1.5.5.1.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{y}" display="inline"><semantics id="A1.SS1.p1.5.5.1.1.1.m1.1a"><mi id="A1.SS1.p1.5.5.1.1.1.m1.1.1" xref="A1.SS1.p1.5.5.1.1.1.m1.1.1.cmml">𝐲</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.5.5.1.1.1.m1.1b"><ci id="A1.SS1.p1.5.5.1.1.1.m1.1.1.cmml" xref="A1.SS1.p1.5.5.1.1.1.m1.1.1">𝐲</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.5.5.1.1.1.m1.1c">\displaystyle\mathbf{y}</annotation></semantics></math></span>
</span>
</td>
<td id="A1.SS1.p1.5.5.2" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.5.5.2.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.5.5.2.1.1" class="ltx_p" style="width:289.1pt;">Target data</span>
</span>
</td>
</tr>
<tr id="A1.SS1.p1.6.6" class="ltx_tr">
<td id="A1.SS1.p1.6.6.1" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.6.6.1.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.6.6.1.1.1" class="ltx_p" style="width:54.2pt;"><math id="A1.SS1.p1.6.6.1.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{Z}" display="inline"><semantics id="A1.SS1.p1.6.6.1.1.1.m1.1a"><mi id="A1.SS1.p1.6.6.1.1.1.m1.1.1" xref="A1.SS1.p1.6.6.1.1.1.m1.1.1.cmml">𝐙</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.6.6.1.1.1.m1.1b"><ci id="A1.SS1.p1.6.6.1.1.1.m1.1.1.cmml" xref="A1.SS1.p1.6.6.1.1.1.m1.1.1">𝐙</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.6.6.1.1.1.m1.1c">\displaystyle\mathbf{Z}</annotation></semantics></math></span>
</span>
</td>
<td id="A1.SS1.p1.6.6.2" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.6.6.2.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.6.6.2.1.1" class="ltx_p" style="width:289.1pt;">Network outputs</span>
</span>
</td>
</tr>
<tr id="A1.SS1.p1.7.7" class="ltx_tr">
<td id="A1.SS1.p1.7.7.1" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.7.7.1.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.7.7.1.1.1" class="ltx_p" style="width:54.2pt;"><math id="A1.SS1.p1.7.7.1.1.1.m1.1" class="ltx_Math" alttext="\displaystyle{\mathbf{\theta}}_{G}" display="inline"><semantics id="A1.SS1.p1.7.7.1.1.1.m1.1a"><msub id="A1.SS1.p1.7.7.1.1.1.m1.1.1" xref="A1.SS1.p1.7.7.1.1.1.m1.1.1.cmml"><mi id="A1.SS1.p1.7.7.1.1.1.m1.1.1.2" xref="A1.SS1.p1.7.7.1.1.1.m1.1.1.2.cmml">θ</mi><mi id="A1.SS1.p1.7.7.1.1.1.m1.1.1.3" xref="A1.SS1.p1.7.7.1.1.1.m1.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.7.7.1.1.1.m1.1b"><apply id="A1.SS1.p1.7.7.1.1.1.m1.1.1.cmml" xref="A1.SS1.p1.7.7.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.7.7.1.1.1.m1.1.1.1.cmml" xref="A1.SS1.p1.7.7.1.1.1.m1.1.1">subscript</csymbol><ci id="A1.SS1.p1.7.7.1.1.1.m1.1.1.2.cmml" xref="A1.SS1.p1.7.7.1.1.1.m1.1.1.2">𝜃</ci><ci id="A1.SS1.p1.7.7.1.1.1.m1.1.1.3.cmml" xref="A1.SS1.p1.7.7.1.1.1.m1.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.7.7.1.1.1.m1.1c">\displaystyle{\mathbf{\theta}}_{G}</annotation></semantics></math></span>
</span>
</td>
<td id="A1.SS1.p1.7.7.2" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.7.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.7.7.2.1.1" class="ltx_p" style="width:289.1pt;">Global aggregated model</span>
</span>
</td>
</tr>
<tr id="A1.SS1.p1.8.8" class="ltx_tr">
<td id="A1.SS1.p1.8.8.1" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.8.8.1.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.8.8.1.1.1" class="ltx_p" style="width:54.2pt;"><math id="A1.SS1.p1.8.8.1.1.1.m1.1" class="ltx_Math" alttext="\displaystyle N" display="inline"><semantics id="A1.SS1.p1.8.8.1.1.1.m1.1a"><mi id="A1.SS1.p1.8.8.1.1.1.m1.1.1" xref="A1.SS1.p1.8.8.1.1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.8.8.1.1.1.m1.1b"><ci id="A1.SS1.p1.8.8.1.1.1.m1.1.1.cmml" xref="A1.SS1.p1.8.8.1.1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.8.8.1.1.1.m1.1c">\displaystyle N</annotation></semantics></math></span>
</span>
</td>
<td id="A1.SS1.p1.8.8.2" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.8.8.2.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.8.8.2.1.1" class="ltx_p" style="width:289.1pt;">Number of clients</span>
</span>
</td>
</tr>
<tr id="A1.SS1.p1.11.11" class="ltx_tr">
<td id="A1.SS1.p1.9.9.1" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.9.9.1.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.9.9.1.1.1" class="ltx_p" style="width:54.2pt;"><math id="A1.SS1.p1.9.9.1.1.1.m1.1" class="ltx_Math" alttext="\displaystyle D_{i}" display="inline"><semantics id="A1.SS1.p1.9.9.1.1.1.m1.1a"><msub id="A1.SS1.p1.9.9.1.1.1.m1.1.1" xref="A1.SS1.p1.9.9.1.1.1.m1.1.1.cmml"><mi id="A1.SS1.p1.9.9.1.1.1.m1.1.1.2" xref="A1.SS1.p1.9.9.1.1.1.m1.1.1.2.cmml">D</mi><mi id="A1.SS1.p1.9.9.1.1.1.m1.1.1.3" xref="A1.SS1.p1.9.9.1.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.9.9.1.1.1.m1.1b"><apply id="A1.SS1.p1.9.9.1.1.1.m1.1.1.cmml" xref="A1.SS1.p1.9.9.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.9.9.1.1.1.m1.1.1.1.cmml" xref="A1.SS1.p1.9.9.1.1.1.m1.1.1">subscript</csymbol><ci id="A1.SS1.p1.9.9.1.1.1.m1.1.1.2.cmml" xref="A1.SS1.p1.9.9.1.1.1.m1.1.1.2">𝐷</ci><ci id="A1.SS1.p1.9.9.1.1.1.m1.1.1.3.cmml" xref="A1.SS1.p1.9.9.1.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.9.9.1.1.1.m1.1c">\displaystyle D_{i}</annotation></semantics></math></span>
</span>
</td>
<td id="A1.SS1.p1.11.11.3" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.11.11.3.2" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.11.11.3.2.2" class="ltx_p" style="width:289.1pt;">Dataset <math id="A1.SS1.p1.10.10.2.1.1.m1.2" class="ltx_Math" alttext="(\mathbf{X}_{i},\mathbf{y}_{i})" display="inline"><semantics id="A1.SS1.p1.10.10.2.1.1.m1.2a"><mrow id="A1.SS1.p1.10.10.2.1.1.m1.2.2.2" xref="A1.SS1.p1.10.10.2.1.1.m1.2.2.3.cmml"><mo stretchy="false" id="A1.SS1.p1.10.10.2.1.1.m1.2.2.2.3" xref="A1.SS1.p1.10.10.2.1.1.m1.2.2.3.cmml">(</mo><msub id="A1.SS1.p1.10.10.2.1.1.m1.1.1.1.1" xref="A1.SS1.p1.10.10.2.1.1.m1.1.1.1.1.cmml"><mi id="A1.SS1.p1.10.10.2.1.1.m1.1.1.1.1.2" xref="A1.SS1.p1.10.10.2.1.1.m1.1.1.1.1.2.cmml">𝐗</mi><mi id="A1.SS1.p1.10.10.2.1.1.m1.1.1.1.1.3" xref="A1.SS1.p1.10.10.2.1.1.m1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS1.p1.10.10.2.1.1.m1.2.2.2.4" xref="A1.SS1.p1.10.10.2.1.1.m1.2.2.3.cmml">,</mo><msub id="A1.SS1.p1.10.10.2.1.1.m1.2.2.2.2" xref="A1.SS1.p1.10.10.2.1.1.m1.2.2.2.2.cmml"><mi id="A1.SS1.p1.10.10.2.1.1.m1.2.2.2.2.2" xref="A1.SS1.p1.10.10.2.1.1.m1.2.2.2.2.2.cmml">𝐲</mi><mi id="A1.SS1.p1.10.10.2.1.1.m1.2.2.2.2.3" xref="A1.SS1.p1.10.10.2.1.1.m1.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="A1.SS1.p1.10.10.2.1.1.m1.2.2.2.5" xref="A1.SS1.p1.10.10.2.1.1.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.10.10.2.1.1.m1.2b"><interval closure="open" id="A1.SS1.p1.10.10.2.1.1.m1.2.2.3.cmml" xref="A1.SS1.p1.10.10.2.1.1.m1.2.2.2"><apply id="A1.SS1.p1.10.10.2.1.1.m1.1.1.1.1.cmml" xref="A1.SS1.p1.10.10.2.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.10.10.2.1.1.m1.1.1.1.1.1.cmml" xref="A1.SS1.p1.10.10.2.1.1.m1.1.1.1.1">subscript</csymbol><ci id="A1.SS1.p1.10.10.2.1.1.m1.1.1.1.1.2.cmml" xref="A1.SS1.p1.10.10.2.1.1.m1.1.1.1.1.2">𝐗</ci><ci id="A1.SS1.p1.10.10.2.1.1.m1.1.1.1.1.3.cmml" xref="A1.SS1.p1.10.10.2.1.1.m1.1.1.1.1.3">𝑖</ci></apply><apply id="A1.SS1.p1.10.10.2.1.1.m1.2.2.2.2.cmml" xref="A1.SS1.p1.10.10.2.1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.p1.10.10.2.1.1.m1.2.2.2.2.1.cmml" xref="A1.SS1.p1.10.10.2.1.1.m1.2.2.2.2">subscript</csymbol><ci id="A1.SS1.p1.10.10.2.1.1.m1.2.2.2.2.2.cmml" xref="A1.SS1.p1.10.10.2.1.1.m1.2.2.2.2.2">𝐲</ci><ci id="A1.SS1.p1.10.10.2.1.1.m1.2.2.2.2.3.cmml" xref="A1.SS1.p1.10.10.2.1.1.m1.2.2.2.2.3">𝑖</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.10.10.2.1.1.m1.2c">(\mathbf{X}_{i},\mathbf{y}_{i})</annotation></semantics></math> corresponding to client <math id="A1.SS1.p1.11.11.3.2.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="A1.SS1.p1.11.11.3.2.2.m2.1a"><mi id="A1.SS1.p1.11.11.3.2.2.m2.1.1" xref="A1.SS1.p1.11.11.3.2.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.11.11.3.2.2.m2.1b"><ci id="A1.SS1.p1.11.11.3.2.2.m2.1.1.cmml" xref="A1.SS1.p1.11.11.3.2.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.11.11.3.2.2.m2.1c">i</annotation></semantics></math></span>
</span>
</td>
</tr>
<tr id="A1.SS1.p1.13.13" class="ltx_tr">
<td id="A1.SS1.p1.12.12.1" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.12.12.1.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.12.12.1.1.1" class="ltx_p" style="width:54.2pt;"><math id="A1.SS1.p1.12.12.1.1.1.m1.1" class="ltx_Math" alttext="\displaystyle{\mathbf{\theta}}_{i}" display="inline"><semantics id="A1.SS1.p1.12.12.1.1.1.m1.1a"><msub id="A1.SS1.p1.12.12.1.1.1.m1.1.1" xref="A1.SS1.p1.12.12.1.1.1.m1.1.1.cmml"><mi id="A1.SS1.p1.12.12.1.1.1.m1.1.1.2" xref="A1.SS1.p1.12.12.1.1.1.m1.1.1.2.cmml">θ</mi><mi id="A1.SS1.p1.12.12.1.1.1.m1.1.1.3" xref="A1.SS1.p1.12.12.1.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.12.12.1.1.1.m1.1b"><apply id="A1.SS1.p1.12.12.1.1.1.m1.1.1.cmml" xref="A1.SS1.p1.12.12.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.12.12.1.1.1.m1.1.1.1.cmml" xref="A1.SS1.p1.12.12.1.1.1.m1.1.1">subscript</csymbol><ci id="A1.SS1.p1.12.12.1.1.1.m1.1.1.2.cmml" xref="A1.SS1.p1.12.12.1.1.1.m1.1.1.2">𝜃</ci><ci id="A1.SS1.p1.12.12.1.1.1.m1.1.1.3.cmml" xref="A1.SS1.p1.12.12.1.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.12.12.1.1.1.m1.1c">\displaystyle{\mathbf{\theta}}_{i}</annotation></semantics></math></span>
</span>
</td>
<td id="A1.SS1.p1.13.13.2" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.13.13.2.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.13.13.2.1.1" class="ltx_p" style="width:289.1pt;">Locally trained model for client <math id="A1.SS1.p1.13.13.2.1.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="A1.SS1.p1.13.13.2.1.1.m1.1a"><mi id="A1.SS1.p1.13.13.2.1.1.m1.1.1" xref="A1.SS1.p1.13.13.2.1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.13.13.2.1.1.m1.1b"><ci id="A1.SS1.p1.13.13.2.1.1.m1.1.1.cmml" xref="A1.SS1.p1.13.13.2.1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.13.13.2.1.1.m1.1c">i</annotation></semantics></math></span>
</span>
</td>
</tr>
<tr id="A1.SS1.p1.14.14" class="ltx_tr">
<td id="A1.SS1.p1.14.14.1" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.14.14.1.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.14.14.1.1.1" class="ltx_p" style="width:54.2pt;"><math id="A1.SS1.p1.14.14.1.1.1.m1.1" class="ltx_Math" alttext="\displaystyle J^{({\mathbf{z}})}_{\theta}" display="inline"><semantics id="A1.SS1.p1.14.14.1.1.1.m1.1a"><msubsup id="A1.SS1.p1.14.14.1.1.1.m1.1.2" xref="A1.SS1.p1.14.14.1.1.1.m1.1.2.cmml"><mi id="A1.SS1.p1.14.14.1.1.1.m1.1.2.2.2" xref="A1.SS1.p1.14.14.1.1.1.m1.1.2.2.2.cmml">J</mi><mi id="A1.SS1.p1.14.14.1.1.1.m1.1.2.3" xref="A1.SS1.p1.14.14.1.1.1.m1.1.2.3.cmml">θ</mi><mrow id="A1.SS1.p1.14.14.1.1.1.m1.1.1.1.3" xref="A1.SS1.p1.14.14.1.1.1.m1.1.2.cmml"><mo stretchy="false" id="A1.SS1.p1.14.14.1.1.1.m1.1.1.1.3.1" xref="A1.SS1.p1.14.14.1.1.1.m1.1.2.cmml">(</mo><mi id="A1.SS1.p1.14.14.1.1.1.m1.1.1.1.1" xref="A1.SS1.p1.14.14.1.1.1.m1.1.1.1.1.cmml">𝐳</mi><mo stretchy="false" id="A1.SS1.p1.14.14.1.1.1.m1.1.1.1.3.2" xref="A1.SS1.p1.14.14.1.1.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.14.14.1.1.1.m1.1b"><apply id="A1.SS1.p1.14.14.1.1.1.m1.1.2.cmml" xref="A1.SS1.p1.14.14.1.1.1.m1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p1.14.14.1.1.1.m1.1.2.1.cmml" xref="A1.SS1.p1.14.14.1.1.1.m1.1.2">subscript</csymbol><apply id="A1.SS1.p1.14.14.1.1.1.m1.1.2.2.cmml" xref="A1.SS1.p1.14.14.1.1.1.m1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p1.14.14.1.1.1.m1.1.2.2.1.cmml" xref="A1.SS1.p1.14.14.1.1.1.m1.1.2">superscript</csymbol><ci id="A1.SS1.p1.14.14.1.1.1.m1.1.2.2.2.cmml" xref="A1.SS1.p1.14.14.1.1.1.m1.1.2.2.2">𝐽</ci><ci id="A1.SS1.p1.14.14.1.1.1.m1.1.1.1.1.cmml" xref="A1.SS1.p1.14.14.1.1.1.m1.1.1.1.1">𝐳</ci></apply><ci id="A1.SS1.p1.14.14.1.1.1.m1.1.2.3.cmml" xref="A1.SS1.p1.14.14.1.1.1.m1.1.2.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.14.14.1.1.1.m1.1c">\displaystyle J^{({\mathbf{z}})}_{\theta}</annotation></semantics></math></span>
</span>
</td>
<td id="A1.SS1.p1.14.14.2" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.14.14.2.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.14.14.2.1.1" class="ltx_p" style="width:289.1pt;">Output Jacobian matrix</span>
</span>
</td>
</tr>
<tr id="A1.SS1.p1.15.15" class="ltx_tr">
<td id="A1.SS1.p1.15.15.1" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.15.15.1.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.15.15.1.1.1" class="ltx_p" style="width:54.2pt;"><math id="A1.SS1.p1.15.15.1.1.1.m1.1" class="ltx_Math" alttext="\displaystyle F" display="inline"><semantics id="A1.SS1.p1.15.15.1.1.1.m1.1a"><mi id="A1.SS1.p1.15.15.1.1.1.m1.1.1" xref="A1.SS1.p1.15.15.1.1.1.m1.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.15.15.1.1.1.m1.1b"><ci id="A1.SS1.p1.15.15.1.1.1.m1.1.1.cmml" xref="A1.SS1.p1.15.15.1.1.1.m1.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.15.15.1.1.1.m1.1c">\displaystyle F</annotation></semantics></math></span>
</span>
</td>
<td id="A1.SS1.p1.15.15.2" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.15.15.2.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.15.15.2.1.1" class="ltx_p" style="width:289.1pt;">Fisher Information matrix</span>
</span>
</td>
</tr>
<tr id="A1.SS1.p1.16.16" class="ltx_tr">
<td id="A1.SS1.p1.16.16.1" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.16.16.1.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.16.16.1.1.1" class="ltx_p" style="width:54.2pt;"><math id="A1.SS1.p1.16.16.1.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\text{diag}(F)" display="inline"><semantics id="A1.SS1.p1.16.16.1.1.1.m1.1a"><mrow id="A1.SS1.p1.16.16.1.1.1.m1.1.2" xref="A1.SS1.p1.16.16.1.1.1.m1.1.2.cmml"><mtext id="A1.SS1.p1.16.16.1.1.1.m1.1.2.2" xref="A1.SS1.p1.16.16.1.1.1.m1.1.2.2a.cmml">diag</mtext><mo lspace="0em" rspace="0em" id="A1.SS1.p1.16.16.1.1.1.m1.1.2.1" xref="A1.SS1.p1.16.16.1.1.1.m1.1.2.1.cmml">​</mo><mrow id="A1.SS1.p1.16.16.1.1.1.m1.1.2.3.2" xref="A1.SS1.p1.16.16.1.1.1.m1.1.2.cmml"><mo stretchy="false" id="A1.SS1.p1.16.16.1.1.1.m1.1.2.3.2.1" xref="A1.SS1.p1.16.16.1.1.1.m1.1.2.cmml">(</mo><mi id="A1.SS1.p1.16.16.1.1.1.m1.1.1" xref="A1.SS1.p1.16.16.1.1.1.m1.1.1.cmml">F</mi><mo stretchy="false" id="A1.SS1.p1.16.16.1.1.1.m1.1.2.3.2.2" xref="A1.SS1.p1.16.16.1.1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.16.16.1.1.1.m1.1b"><apply id="A1.SS1.p1.16.16.1.1.1.m1.1.2.cmml" xref="A1.SS1.p1.16.16.1.1.1.m1.1.2"><times id="A1.SS1.p1.16.16.1.1.1.m1.1.2.1.cmml" xref="A1.SS1.p1.16.16.1.1.1.m1.1.2.1"></times><ci id="A1.SS1.p1.16.16.1.1.1.m1.1.2.2a.cmml" xref="A1.SS1.p1.16.16.1.1.1.m1.1.2.2"><mtext id="A1.SS1.p1.16.16.1.1.1.m1.1.2.2.cmml" xref="A1.SS1.p1.16.16.1.1.1.m1.1.2.2">diag</mtext></ci><ci id="A1.SS1.p1.16.16.1.1.1.m1.1.1.cmml" xref="A1.SS1.p1.16.16.1.1.1.m1.1.1">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.16.16.1.1.1.m1.1c">\displaystyle\text{diag}(F)</annotation></semantics></math></span>
</span>
</td>
<td id="A1.SS1.p1.16.16.2" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.16.16.2.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.16.16.2.1.1" class="ltx_p" style="width:289.1pt;">Diagonal of Fisher Information matrix</span>
</span>
</td>
</tr>
<tr id="A1.SS1.p1.19.19" class="ltx_tr">
<td id="A1.SS1.p1.17.17.1" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.17.17.1.1" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.17.17.1.1.1" class="ltx_p" style="width:54.2pt;"><math id="A1.SS1.p1.17.17.1.1.1.m1.1" class="ltx_Math" alttext="\displaystyle L_{i}" display="inline"><semantics id="A1.SS1.p1.17.17.1.1.1.m1.1a"><msub id="A1.SS1.p1.17.17.1.1.1.m1.1.1" xref="A1.SS1.p1.17.17.1.1.1.m1.1.1.cmml"><mi id="A1.SS1.p1.17.17.1.1.1.m1.1.1.2" xref="A1.SS1.p1.17.17.1.1.1.m1.1.1.2.cmml">L</mi><mi id="A1.SS1.p1.17.17.1.1.1.m1.1.1.3" xref="A1.SS1.p1.17.17.1.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.17.17.1.1.1.m1.1b"><apply id="A1.SS1.p1.17.17.1.1.1.m1.1.1.cmml" xref="A1.SS1.p1.17.17.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.17.17.1.1.1.m1.1.1.1.cmml" xref="A1.SS1.p1.17.17.1.1.1.m1.1.1">subscript</csymbol><ci id="A1.SS1.p1.17.17.1.1.1.m1.1.1.2.cmml" xref="A1.SS1.p1.17.17.1.1.1.m1.1.1.2">𝐿</ci><ci id="A1.SS1.p1.17.17.1.1.1.m1.1.1.3.cmml" xref="A1.SS1.p1.17.17.1.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.17.17.1.1.1.m1.1c">\displaystyle L_{i}</annotation></semantics></math></span>
</span>
</td>
<td id="A1.SS1.p1.19.19.3" class="ltx_td ltx_align_justify ltx_align_top" style="padding-top:2.5pt;padding-bottom:2.5pt;">
<span id="A1.SS1.p1.19.19.3.2" class="ltx_inline-block ltx_align_top">
<span id="A1.SS1.p1.19.19.3.2.2" class="ltx_p" style="width:289.1pt;">Performance metric of interest, evaluated on data <math id="A1.SS1.p1.18.18.2.1.1.m1.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="A1.SS1.p1.18.18.2.1.1.m1.1a"><msub id="A1.SS1.p1.18.18.2.1.1.m1.1.1" xref="A1.SS1.p1.18.18.2.1.1.m1.1.1.cmml"><mi id="A1.SS1.p1.18.18.2.1.1.m1.1.1.2" xref="A1.SS1.p1.18.18.2.1.1.m1.1.1.2.cmml">D</mi><mi id="A1.SS1.p1.18.18.2.1.1.m1.1.1.3" xref="A1.SS1.p1.18.18.2.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.18.18.2.1.1.m1.1b"><apply id="A1.SS1.p1.18.18.2.1.1.m1.1.1.cmml" xref="A1.SS1.p1.18.18.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.18.18.2.1.1.m1.1.1.1.cmml" xref="A1.SS1.p1.18.18.2.1.1.m1.1.1">subscript</csymbol><ci id="A1.SS1.p1.18.18.2.1.1.m1.1.1.2.cmml" xref="A1.SS1.p1.18.18.2.1.1.m1.1.1.2">𝐷</ci><ci id="A1.SS1.p1.18.18.2.1.1.m1.1.1.3.cmml" xref="A1.SS1.p1.18.18.2.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.18.18.2.1.1.m1.1c">D_{i}</annotation></semantics></math> for client <math id="A1.SS1.p1.19.19.3.2.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="A1.SS1.p1.19.19.3.2.2.m2.1a"><mi id="A1.SS1.p1.19.19.3.2.2.m2.1.1" xref="A1.SS1.p1.19.19.3.2.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.19.19.3.2.2.m2.1b"><ci id="A1.SS1.p1.19.19.3.2.2.m2.1.1.cmml" xref="A1.SS1.p1.19.19.3.2.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.19.19.3.2.2.m2.1c">i</annotation></semantics></math></span>
</span>
</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span><span id="A1.SS2.1.1" class="ltx_text ltx_font_smallcaps">FedFish</span> Derivation</h3>

<div id="A1.SS2.p1" class="ltx_para ltx_noindent">
<p id="A1.SS2.p1.1" class="ltx_p">We present the complete details of our derivation for <span id="A1.SS2.p1.1.1" class="ltx_text ltx_font_smallcaps">FedFish</span> here.</p>
</div>
<div id="A1.SS2.p2" class="ltx_para ltx_noindent">
<p id="A1.SS2.p2.3" class="ltx_p">Given <math id="A1.SS2.p2.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="A1.SS2.p2.1.m1.1a"><mi id="A1.SS2.p2.1.m1.1.1" xref="A1.SS2.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.1.m1.1b"><ci id="A1.SS2.p2.1.m1.1.1.cmml" xref="A1.SS2.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.1.m1.1c">N</annotation></semantics></math> client models with locally trained parameters <math id="A1.SS2.p2.2.m2.1" class="ltx_Math" alttext="({\mathbf{\theta}}_{i})_{i=1}^{N}" display="inline"><semantics id="A1.SS2.p2.2.m2.1a"><msubsup id="A1.SS2.p2.2.m2.1.1" xref="A1.SS2.p2.2.m2.1.1.cmml"><mrow id="A1.SS2.p2.2.m2.1.1.1.1.1" xref="A1.SS2.p2.2.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.SS2.p2.2.m2.1.1.1.1.1.2" xref="A1.SS2.p2.2.m2.1.1.1.1.1.1.cmml">(</mo><msub id="A1.SS2.p2.2.m2.1.1.1.1.1.1" xref="A1.SS2.p2.2.m2.1.1.1.1.1.1.cmml"><mi id="A1.SS2.p2.2.m2.1.1.1.1.1.1.2" xref="A1.SS2.p2.2.m2.1.1.1.1.1.1.2.cmml">θ</mi><mi id="A1.SS2.p2.2.m2.1.1.1.1.1.1.3" xref="A1.SS2.p2.2.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A1.SS2.p2.2.m2.1.1.1.1.1.3" xref="A1.SS2.p2.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="A1.SS2.p2.2.m2.1.1.1.3" xref="A1.SS2.p2.2.m2.1.1.1.3.cmml"><mi id="A1.SS2.p2.2.m2.1.1.1.3.2" xref="A1.SS2.p2.2.m2.1.1.1.3.2.cmml">i</mi><mo id="A1.SS2.p2.2.m2.1.1.1.3.1" xref="A1.SS2.p2.2.m2.1.1.1.3.1.cmml">=</mo><mn id="A1.SS2.p2.2.m2.1.1.1.3.3" xref="A1.SS2.p2.2.m2.1.1.1.3.3.cmml">1</mn></mrow><mi id="A1.SS2.p2.2.m2.1.1.3" xref="A1.SS2.p2.2.m2.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.2.m2.1b"><apply id="A1.SS2.p2.2.m2.1.1.cmml" xref="A1.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.2.m2.1.1.2.cmml" xref="A1.SS2.p2.2.m2.1.1">superscript</csymbol><apply id="A1.SS2.p2.2.m2.1.1.1.cmml" xref="A1.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.2.m2.1.1.1.2.cmml" xref="A1.SS2.p2.2.m2.1.1">subscript</csymbol><apply id="A1.SS2.p2.2.m2.1.1.1.1.1.1.cmml" xref="A1.SS2.p2.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.2.m2.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p2.2.m2.1.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p2.2.m2.1.1.1.1.1.1.2.cmml" xref="A1.SS2.p2.2.m2.1.1.1.1.1.1.2">𝜃</ci><ci id="A1.SS2.p2.2.m2.1.1.1.1.1.1.3.cmml" xref="A1.SS2.p2.2.m2.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="A1.SS2.p2.2.m2.1.1.1.3.cmml" xref="A1.SS2.p2.2.m2.1.1.1.3"><eq id="A1.SS2.p2.2.m2.1.1.1.3.1.cmml" xref="A1.SS2.p2.2.m2.1.1.1.3.1"></eq><ci id="A1.SS2.p2.2.m2.1.1.1.3.2.cmml" xref="A1.SS2.p2.2.m2.1.1.1.3.2">𝑖</ci><cn type="integer" id="A1.SS2.p2.2.m2.1.1.1.3.3.cmml" xref="A1.SS2.p2.2.m2.1.1.1.3.3">1</cn></apply></apply><ci id="A1.SS2.p2.2.m2.1.1.3.cmml" xref="A1.SS2.p2.2.m2.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.2.m2.1c">({\mathbf{\theta}}_{i})_{i=1}^{N}</annotation></semantics></math> and a function space distance as <math id="A1.SS2.p2.3.m3.2" class="ltx_Math" alttext="\mathcal{D}\left(\cdot,\cdot\right)" display="inline"><semantics id="A1.SS2.p2.3.m3.2a"><mrow id="A1.SS2.p2.3.m3.2.3" xref="A1.SS2.p2.3.m3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p2.3.m3.2.3.2" xref="A1.SS2.p2.3.m3.2.3.2.cmml">𝒟</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p2.3.m3.2.3.1" xref="A1.SS2.p2.3.m3.2.3.1.cmml">​</mo><mrow id="A1.SS2.p2.3.m3.2.3.3.2" xref="A1.SS2.p2.3.m3.2.3.3.1.cmml"><mo id="A1.SS2.p2.3.m3.2.3.3.2.1" xref="A1.SS2.p2.3.m3.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="A1.SS2.p2.3.m3.1.1" xref="A1.SS2.p2.3.m3.1.1.cmml">⋅</mo><mo rspace="0em" id="A1.SS2.p2.3.m3.2.3.3.2.2" xref="A1.SS2.p2.3.m3.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="A1.SS2.p2.3.m3.2.2" xref="A1.SS2.p2.3.m3.2.2.cmml">⋅</mo><mo id="A1.SS2.p2.3.m3.2.3.3.2.3" xref="A1.SS2.p2.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.3.m3.2b"><apply id="A1.SS2.p2.3.m3.2.3.cmml" xref="A1.SS2.p2.3.m3.2.3"><times id="A1.SS2.p2.3.m3.2.3.1.cmml" xref="A1.SS2.p2.3.m3.2.3.1"></times><ci id="A1.SS2.p2.3.m3.2.3.2.cmml" xref="A1.SS2.p2.3.m3.2.3.2">𝒟</ci><interval closure="open" id="A1.SS2.p2.3.m3.2.3.3.1.cmml" xref="A1.SS2.p2.3.m3.2.3.3.2"><ci id="A1.SS2.p2.3.m3.1.1.cmml" xref="A1.SS2.p2.3.m3.1.1">⋅</ci><ci id="A1.SS2.p2.3.m3.2.2.cmml" xref="A1.SS2.p2.3.m3.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.3.m3.2c">\mathcal{D}\left(\cdot,\cdot\right)</annotation></semantics></math> we defined the optimal global model to be:</p>
<table id="A1.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E6.m1.2" class="ltx_Math" alttext="{\mathbf{\theta}}_{G}^{*}=\arg\min_{{\mathbf{\theta}}}\frac{1}{N}\sum_{i=1}^{N}\mathcal{D}\left(f(\mathbf{X}_{i};{\mathbf{\theta}}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i})\right)." display="block"><semantics id="A1.E6.m1.2a"><mrow id="A1.E6.m1.2.2.1" xref="A1.E6.m1.2.2.1.1.cmml"><mrow id="A1.E6.m1.2.2.1.1" xref="A1.E6.m1.2.2.1.1.cmml"><msubsup id="A1.E6.m1.2.2.1.1.4" xref="A1.E6.m1.2.2.1.1.4.cmml"><mi id="A1.E6.m1.2.2.1.1.4.2.2" xref="A1.E6.m1.2.2.1.1.4.2.2.cmml">θ</mi><mi id="A1.E6.m1.2.2.1.1.4.2.3" xref="A1.E6.m1.2.2.1.1.4.2.3.cmml">G</mi><mo id="A1.E6.m1.2.2.1.1.4.3" xref="A1.E6.m1.2.2.1.1.4.3.cmml">∗</mo></msubsup><mo id="A1.E6.m1.2.2.1.1.3" xref="A1.E6.m1.2.2.1.1.3.cmml">=</mo><mrow id="A1.E6.m1.2.2.1.1.2" xref="A1.E6.m1.2.2.1.1.2.cmml"><mrow id="A1.E6.m1.2.2.1.1.2.4" xref="A1.E6.m1.2.2.1.1.2.4.cmml"><mi id="A1.E6.m1.2.2.1.1.2.4.1" xref="A1.E6.m1.2.2.1.1.2.4.1.cmml">arg</mi><mo lspace="0.167em" id="A1.E6.m1.2.2.1.1.2.4a" xref="A1.E6.m1.2.2.1.1.2.4.cmml">⁡</mo><mrow id="A1.E6.m1.2.2.1.1.2.4.2" xref="A1.E6.m1.2.2.1.1.2.4.2.cmml"><munder id="A1.E6.m1.2.2.1.1.2.4.2.1" xref="A1.E6.m1.2.2.1.1.2.4.2.1.cmml"><mi id="A1.E6.m1.2.2.1.1.2.4.2.1.2" xref="A1.E6.m1.2.2.1.1.2.4.2.1.2.cmml">min</mi><mi id="A1.E6.m1.2.2.1.1.2.4.2.1.3" xref="A1.E6.m1.2.2.1.1.2.4.2.1.3.cmml">θ</mi></munder><mo lspace="0.167em" id="A1.E6.m1.2.2.1.1.2.4.2a" xref="A1.E6.m1.2.2.1.1.2.4.2.cmml">⁡</mo><mfrac id="A1.E6.m1.2.2.1.1.2.4.2.2" xref="A1.E6.m1.2.2.1.1.2.4.2.2.cmml"><mn id="A1.E6.m1.2.2.1.1.2.4.2.2.2" xref="A1.E6.m1.2.2.1.1.2.4.2.2.2.cmml">1</mn><mi id="A1.E6.m1.2.2.1.1.2.4.2.2.3" xref="A1.E6.m1.2.2.1.1.2.4.2.2.3.cmml">N</mi></mfrac></mrow></mrow><mo lspace="0em" rspace="0em" id="A1.E6.m1.2.2.1.1.2.3" xref="A1.E6.m1.2.2.1.1.2.3.cmml">​</mo><mrow id="A1.E6.m1.2.2.1.1.2.2" xref="A1.E6.m1.2.2.1.1.2.2.cmml"><munderover id="A1.E6.m1.2.2.1.1.2.2.3" xref="A1.E6.m1.2.2.1.1.2.2.3.cmml"><mo movablelimits="false" id="A1.E6.m1.2.2.1.1.2.2.3.2.2" xref="A1.E6.m1.2.2.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="A1.E6.m1.2.2.1.1.2.2.3.2.3" xref="A1.E6.m1.2.2.1.1.2.2.3.2.3.cmml"><mi id="A1.E6.m1.2.2.1.1.2.2.3.2.3.2" xref="A1.E6.m1.2.2.1.1.2.2.3.2.3.2.cmml">i</mi><mo id="A1.E6.m1.2.2.1.1.2.2.3.2.3.1" xref="A1.E6.m1.2.2.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="A1.E6.m1.2.2.1.1.2.2.3.2.3.3" xref="A1.E6.m1.2.2.1.1.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="A1.E6.m1.2.2.1.1.2.2.3.3" xref="A1.E6.m1.2.2.1.1.2.2.3.3.cmml">N</mi></munderover><mrow id="A1.E6.m1.2.2.1.1.2.2.2" xref="A1.E6.m1.2.2.1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E6.m1.2.2.1.1.2.2.2.4" xref="A1.E6.m1.2.2.1.1.2.2.2.4.cmml">𝒟</mi><mo lspace="0em" rspace="0em" id="A1.E6.m1.2.2.1.1.2.2.2.3" xref="A1.E6.m1.2.2.1.1.2.2.2.3.cmml">​</mo><mrow id="A1.E6.m1.2.2.1.1.2.2.2.2.2" xref="A1.E6.m1.2.2.1.1.2.2.2.2.3.cmml"><mo id="A1.E6.m1.2.2.1.1.2.2.2.2.2.3" xref="A1.E6.m1.2.2.1.1.2.2.2.2.3.cmml">(</mo><mrow id="A1.E6.m1.2.2.1.1.1.1.1.1.1.1" xref="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.3" xref="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.2" xref="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐗</mi><mi id="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">;</mo><mi id="A1.E6.m1.1.1" xref="A1.E6.m1.1.1.cmml">θ</mi><mo stretchy="false" id="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.4" xref="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E6.m1.2.2.1.1.2.2.2.2.2.4" xref="A1.E6.m1.2.2.1.1.2.2.2.2.3.cmml">,</mo><mrow id="A1.E6.m1.2.2.1.1.2.2.2.2.2.2" xref="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.cmml"><mi id="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.4" xref="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.3" xref="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.3.cmml">​</mo><mrow id="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.2.2" xref="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.2.3.cmml"><mo stretchy="false" id="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.2.2.3" xref="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.2.3.cmml">(</mo><msub id="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.1.1.1" xref="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.1.1.1.cmml"><mi id="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.1.1.1.2" xref="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.1.1.1.2.cmml">𝐗</mi><mi id="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.1.1.1.3" xref="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.2.2.4" xref="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.2.3.cmml">;</mo><msub id="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.2.2.2" xref="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.cmml"><mi id="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2" xref="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.cmml">θ</mi><mi id="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.3" xref="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.2.2.5" xref="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E6.m1.2.2.1.1.2.2.2.2.2.5" xref="A1.E6.m1.2.2.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="A1.E6.m1.2.2.1.2" xref="A1.E6.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E6.m1.2b"><apply id="A1.E6.m1.2.2.1.1.cmml" xref="A1.E6.m1.2.2.1"><eq id="A1.E6.m1.2.2.1.1.3.cmml" xref="A1.E6.m1.2.2.1.1.3"></eq><apply id="A1.E6.m1.2.2.1.1.4.cmml" xref="A1.E6.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="A1.E6.m1.2.2.1.1.4.1.cmml" xref="A1.E6.m1.2.2.1.1.4">superscript</csymbol><apply id="A1.E6.m1.2.2.1.1.4.2.cmml" xref="A1.E6.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="A1.E6.m1.2.2.1.1.4.2.1.cmml" xref="A1.E6.m1.2.2.1.1.4">subscript</csymbol><ci id="A1.E6.m1.2.2.1.1.4.2.2.cmml" xref="A1.E6.m1.2.2.1.1.4.2.2">𝜃</ci><ci id="A1.E6.m1.2.2.1.1.4.2.3.cmml" xref="A1.E6.m1.2.2.1.1.4.2.3">𝐺</ci></apply><times id="A1.E6.m1.2.2.1.1.4.3.cmml" xref="A1.E6.m1.2.2.1.1.4.3"></times></apply><apply id="A1.E6.m1.2.2.1.1.2.cmml" xref="A1.E6.m1.2.2.1.1.2"><times id="A1.E6.m1.2.2.1.1.2.3.cmml" xref="A1.E6.m1.2.2.1.1.2.3"></times><apply id="A1.E6.m1.2.2.1.1.2.4.cmml" xref="A1.E6.m1.2.2.1.1.2.4"><arg id="A1.E6.m1.2.2.1.1.2.4.1.cmml" xref="A1.E6.m1.2.2.1.1.2.4.1"></arg><apply id="A1.E6.m1.2.2.1.1.2.4.2.cmml" xref="A1.E6.m1.2.2.1.1.2.4.2"><apply id="A1.E6.m1.2.2.1.1.2.4.2.1.cmml" xref="A1.E6.m1.2.2.1.1.2.4.2.1"><csymbol cd="ambiguous" id="A1.E6.m1.2.2.1.1.2.4.2.1.1.cmml" xref="A1.E6.m1.2.2.1.1.2.4.2.1">subscript</csymbol><min id="A1.E6.m1.2.2.1.1.2.4.2.1.2.cmml" xref="A1.E6.m1.2.2.1.1.2.4.2.1.2"></min><ci id="A1.E6.m1.2.2.1.1.2.4.2.1.3.cmml" xref="A1.E6.m1.2.2.1.1.2.4.2.1.3">𝜃</ci></apply><apply id="A1.E6.m1.2.2.1.1.2.4.2.2.cmml" xref="A1.E6.m1.2.2.1.1.2.4.2.2"><divide id="A1.E6.m1.2.2.1.1.2.4.2.2.1.cmml" xref="A1.E6.m1.2.2.1.1.2.4.2.2"></divide><cn type="integer" id="A1.E6.m1.2.2.1.1.2.4.2.2.2.cmml" xref="A1.E6.m1.2.2.1.1.2.4.2.2.2">1</cn><ci id="A1.E6.m1.2.2.1.1.2.4.2.2.3.cmml" xref="A1.E6.m1.2.2.1.1.2.4.2.2.3">𝑁</ci></apply></apply></apply><apply id="A1.E6.m1.2.2.1.1.2.2.cmml" xref="A1.E6.m1.2.2.1.1.2.2"><apply id="A1.E6.m1.2.2.1.1.2.2.3.cmml" xref="A1.E6.m1.2.2.1.1.2.2.3"><csymbol cd="ambiguous" id="A1.E6.m1.2.2.1.1.2.2.3.1.cmml" xref="A1.E6.m1.2.2.1.1.2.2.3">superscript</csymbol><apply id="A1.E6.m1.2.2.1.1.2.2.3.2.cmml" xref="A1.E6.m1.2.2.1.1.2.2.3"><csymbol cd="ambiguous" id="A1.E6.m1.2.2.1.1.2.2.3.2.1.cmml" xref="A1.E6.m1.2.2.1.1.2.2.3">subscript</csymbol><sum id="A1.E6.m1.2.2.1.1.2.2.3.2.2.cmml" xref="A1.E6.m1.2.2.1.1.2.2.3.2.2"></sum><apply id="A1.E6.m1.2.2.1.1.2.2.3.2.3.cmml" xref="A1.E6.m1.2.2.1.1.2.2.3.2.3"><eq id="A1.E6.m1.2.2.1.1.2.2.3.2.3.1.cmml" xref="A1.E6.m1.2.2.1.1.2.2.3.2.3.1"></eq><ci id="A1.E6.m1.2.2.1.1.2.2.3.2.3.2.cmml" xref="A1.E6.m1.2.2.1.1.2.2.3.2.3.2">𝑖</ci><cn type="integer" id="A1.E6.m1.2.2.1.1.2.2.3.2.3.3.cmml" xref="A1.E6.m1.2.2.1.1.2.2.3.2.3.3">1</cn></apply></apply><ci id="A1.E6.m1.2.2.1.1.2.2.3.3.cmml" xref="A1.E6.m1.2.2.1.1.2.2.3.3">𝑁</ci></apply><apply id="A1.E6.m1.2.2.1.1.2.2.2.cmml" xref="A1.E6.m1.2.2.1.1.2.2.2"><times id="A1.E6.m1.2.2.1.1.2.2.2.3.cmml" xref="A1.E6.m1.2.2.1.1.2.2.2.3"></times><ci id="A1.E6.m1.2.2.1.1.2.2.2.4.cmml" xref="A1.E6.m1.2.2.1.1.2.2.2.4">𝒟</ci><interval closure="open" id="A1.E6.m1.2.2.1.1.2.2.2.2.3.cmml" xref="A1.E6.m1.2.2.1.1.2.2.2.2.2"><apply id="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A1.E6.m1.2.2.1.1.1.1.1.1.1.1"><times id="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.2"></times><ci id="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.3">𝑓</ci><list id="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1"><apply id="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">𝐗</ci><ci id="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="A1.E6.m1.1.1.cmml" xref="A1.E6.m1.1.1">𝜃</ci></list></apply><apply id="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.cmml" xref="A1.E6.m1.2.2.1.1.2.2.2.2.2.2"><times id="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.3.cmml" xref="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.3"></times><ci id="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.4.cmml" xref="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.4">𝑓</ci><list id="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.2.3.cmml" xref="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.2.2"><apply id="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.1.1.1.cmml" xref="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.1.1.1.1.cmml" xref="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.1.1.1.2.cmml" xref="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.1.1.1.2">𝐗</ci><ci id="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.1.1.1.3.cmml" xref="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.1.1.1.3">𝑖</ci></apply><apply id="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.cmml" xref="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.1.cmml" xref="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.cmml" xref="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2">𝜃</ci><ci id="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.3.cmml" xref="A1.E6.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.3">𝑖</ci></apply></list></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E6.m1.2c">{\mathbf{\theta}}_{G}^{*}=\arg\min_{{\mathbf{\theta}}}\frac{1}{N}\sum_{i=1}^{N}\mathcal{D}\left(f(\mathbf{X}_{i};{\mathbf{\theta}}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i})\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div id="A1.SS2.p3" class="ltx_para ltx_noindent">
<p id="A1.SS2.p3.4" class="ltx_p">We make a second-order Taylor approximation to the function space distance above with respect to model parameters <math id="A1.SS2.p3.1.m1.1" class="ltx_Math" alttext="{\mathbf{\theta}}" display="inline"><semantics id="A1.SS2.p3.1.m1.1a"><mi id="A1.SS2.p3.1.m1.1.1" xref="A1.SS2.p3.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.1.m1.1b"><ci id="A1.SS2.p3.1.m1.1.1.cmml" xref="A1.SS2.p3.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.1.m1.1c">{\mathbf{\theta}}</annotation></semantics></math>, centered at each client’s <math id="A1.SS2.p3.2.m2.1" class="ltx_Math" alttext="{\mathbf{\theta}}_{i}" display="inline"><semantics id="A1.SS2.p3.2.m2.1a"><msub id="A1.SS2.p3.2.m2.1.1" xref="A1.SS2.p3.2.m2.1.1.cmml"><mi id="A1.SS2.p3.2.m2.1.1.2" xref="A1.SS2.p3.2.m2.1.1.2.cmml">θ</mi><mi id="A1.SS2.p3.2.m2.1.1.3" xref="A1.SS2.p3.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.2.m2.1b"><apply id="A1.SS2.p3.2.m2.1.1.cmml" xref="A1.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.2.m2.1.1.1.cmml" xref="A1.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="A1.SS2.p3.2.m2.1.1.2.cmml" xref="A1.SS2.p3.2.m2.1.1.2">𝜃</ci><ci id="A1.SS2.p3.2.m2.1.1.3.cmml" xref="A1.SS2.p3.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.2.m2.1c">{\mathbf{\theta}}_{i}</annotation></semantics></math>, the network whose outputs are to be matched.
Setting <math id="A1.SS2.p3.3.m3.2" class="ltx_Math" alttext="\mathcal{D}\left(\cdot,\cdot\right)" display="inline"><semantics id="A1.SS2.p3.3.m3.2a"><mrow id="A1.SS2.p3.3.m3.2.3" xref="A1.SS2.p3.3.m3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p3.3.m3.2.3.2" xref="A1.SS2.p3.3.m3.2.3.2.cmml">𝒟</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p3.3.m3.2.3.1" xref="A1.SS2.p3.3.m3.2.3.1.cmml">​</mo><mrow id="A1.SS2.p3.3.m3.2.3.3.2" xref="A1.SS2.p3.3.m3.2.3.3.1.cmml"><mo id="A1.SS2.p3.3.m3.2.3.3.2.1" xref="A1.SS2.p3.3.m3.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="A1.SS2.p3.3.m3.1.1" xref="A1.SS2.p3.3.m3.1.1.cmml">⋅</mo><mo rspace="0em" id="A1.SS2.p3.3.m3.2.3.3.2.2" xref="A1.SS2.p3.3.m3.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="A1.SS2.p3.3.m3.2.2" xref="A1.SS2.p3.3.m3.2.2.cmml">⋅</mo><mo id="A1.SS2.p3.3.m3.2.3.3.2.3" xref="A1.SS2.p3.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.3.m3.2b"><apply id="A1.SS2.p3.3.m3.2.3.cmml" xref="A1.SS2.p3.3.m3.2.3"><times id="A1.SS2.p3.3.m3.2.3.1.cmml" xref="A1.SS2.p3.3.m3.2.3.1"></times><ci id="A1.SS2.p3.3.m3.2.3.2.cmml" xref="A1.SS2.p3.3.m3.2.3.2">𝒟</ci><interval closure="open" id="A1.SS2.p3.3.m3.2.3.3.1.cmml" xref="A1.SS2.p3.3.m3.2.3.3.2"><ci id="A1.SS2.p3.3.m3.1.1.cmml" xref="A1.SS2.p3.3.m3.1.1">⋅</ci><ci id="A1.SS2.p3.3.m3.2.2.cmml" xref="A1.SS2.p3.3.m3.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.3.m3.2c">\mathcal{D}\left(\cdot,\cdot\right)</annotation></semantics></math> to be the Kullback-Leibler (KL) divergence between softmax outputs of the networks, we have for each client <math id="A1.SS2.p3.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="A1.SS2.p3.4.m4.1a"><mi id="A1.SS2.p3.4.m4.1.1" xref="A1.SS2.p3.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.4.m4.1b"><ci id="A1.SS2.p3.4.m4.1.1.cmml" xref="A1.SS2.p3.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.4.m4.1c">i</annotation></semantics></math>,</p>
</div>
<div id="A1.SS2.p4" class="ltx_para ltx_noindent">
<table id="A1.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A1.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.E7.m1.3" class="ltx_Math" alttext="\displaystyle\mathcal{D}\left(f(\mathbf{X}_{i};{\mathbf{\theta}}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i})\right)" display="inline"><semantics id="A1.E7.m1.3a"><mrow id="A1.E7.m1.3.3" xref="A1.E7.m1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E7.m1.3.3.4" xref="A1.E7.m1.3.3.4.cmml">𝒟</mi><mo lspace="0em" rspace="0em" id="A1.E7.m1.3.3.3" xref="A1.E7.m1.3.3.3.cmml">​</mo><mrow id="A1.E7.m1.3.3.2.2" xref="A1.E7.m1.3.3.2.3.cmml"><mo id="A1.E7.m1.3.3.2.2.3" xref="A1.E7.m1.3.3.2.3.cmml">(</mo><mrow id="A1.E7.m1.2.2.1.1.1" xref="A1.E7.m1.2.2.1.1.1.cmml"><mi id="A1.E7.m1.2.2.1.1.1.3" xref="A1.E7.m1.2.2.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.E7.m1.2.2.1.1.1.2" xref="A1.E7.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="A1.E7.m1.2.2.1.1.1.1.1" xref="A1.E7.m1.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.E7.m1.2.2.1.1.1.1.1.2" xref="A1.E7.m1.2.2.1.1.1.1.2.cmml">(</mo><msub id="A1.E7.m1.2.2.1.1.1.1.1.1" xref="A1.E7.m1.2.2.1.1.1.1.1.1.cmml"><mi id="A1.E7.m1.2.2.1.1.1.1.1.1.2" xref="A1.E7.m1.2.2.1.1.1.1.1.1.2.cmml">𝐗</mi><mi id="A1.E7.m1.2.2.1.1.1.1.1.1.3" xref="A1.E7.m1.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E7.m1.2.2.1.1.1.1.1.3" xref="A1.E7.m1.2.2.1.1.1.1.2.cmml">;</mo><mi id="A1.E7.m1.1.1" xref="A1.E7.m1.1.1.cmml">θ</mi><mo stretchy="false" id="A1.E7.m1.2.2.1.1.1.1.1.4" xref="A1.E7.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E7.m1.3.3.2.2.4" xref="A1.E7.m1.3.3.2.3.cmml">,</mo><mrow id="A1.E7.m1.3.3.2.2.2" xref="A1.E7.m1.3.3.2.2.2.cmml"><mi id="A1.E7.m1.3.3.2.2.2.4" xref="A1.E7.m1.3.3.2.2.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.E7.m1.3.3.2.2.2.3" xref="A1.E7.m1.3.3.2.2.2.3.cmml">​</mo><mrow id="A1.E7.m1.3.3.2.2.2.2.2" xref="A1.E7.m1.3.3.2.2.2.2.3.cmml"><mo stretchy="false" id="A1.E7.m1.3.3.2.2.2.2.2.3" xref="A1.E7.m1.3.3.2.2.2.2.3.cmml">(</mo><msub id="A1.E7.m1.3.3.2.2.2.1.1.1" xref="A1.E7.m1.3.3.2.2.2.1.1.1.cmml"><mi id="A1.E7.m1.3.3.2.2.2.1.1.1.2" xref="A1.E7.m1.3.3.2.2.2.1.1.1.2.cmml">𝐗</mi><mi id="A1.E7.m1.3.3.2.2.2.1.1.1.3" xref="A1.E7.m1.3.3.2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="A1.E7.m1.3.3.2.2.2.2.2.4" xref="A1.E7.m1.3.3.2.2.2.2.3.cmml">;</mo><msub id="A1.E7.m1.3.3.2.2.2.2.2.2" xref="A1.E7.m1.3.3.2.2.2.2.2.2.cmml"><mi id="A1.E7.m1.3.3.2.2.2.2.2.2.2" xref="A1.E7.m1.3.3.2.2.2.2.2.2.2.cmml">θ</mi><mi id="A1.E7.m1.3.3.2.2.2.2.2.2.3" xref="A1.E7.m1.3.3.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="A1.E7.m1.3.3.2.2.2.2.2.5" xref="A1.E7.m1.3.3.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E7.m1.3.3.2.2.5" xref="A1.E7.m1.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E7.m1.3b"><apply id="A1.E7.m1.3.3.cmml" xref="A1.E7.m1.3.3"><times id="A1.E7.m1.3.3.3.cmml" xref="A1.E7.m1.3.3.3"></times><ci id="A1.E7.m1.3.3.4.cmml" xref="A1.E7.m1.3.3.4">𝒟</ci><interval closure="open" id="A1.E7.m1.3.3.2.3.cmml" xref="A1.E7.m1.3.3.2.2"><apply id="A1.E7.m1.2.2.1.1.1.cmml" xref="A1.E7.m1.2.2.1.1.1"><times id="A1.E7.m1.2.2.1.1.1.2.cmml" xref="A1.E7.m1.2.2.1.1.1.2"></times><ci id="A1.E7.m1.2.2.1.1.1.3.cmml" xref="A1.E7.m1.2.2.1.1.1.3">𝑓</ci><list id="A1.E7.m1.2.2.1.1.1.1.2.cmml" xref="A1.E7.m1.2.2.1.1.1.1.1"><apply id="A1.E7.m1.2.2.1.1.1.1.1.1.cmml" xref="A1.E7.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E7.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A1.E7.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E7.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A1.E7.m1.2.2.1.1.1.1.1.1.2">𝐗</ci><ci id="A1.E7.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A1.E7.m1.2.2.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="A1.E7.m1.1.1.cmml" xref="A1.E7.m1.1.1">𝜃</ci></list></apply><apply id="A1.E7.m1.3.3.2.2.2.cmml" xref="A1.E7.m1.3.3.2.2.2"><times id="A1.E7.m1.3.3.2.2.2.3.cmml" xref="A1.E7.m1.3.3.2.2.2.3"></times><ci id="A1.E7.m1.3.3.2.2.2.4.cmml" xref="A1.E7.m1.3.3.2.2.2.4">𝑓</ci><list id="A1.E7.m1.3.3.2.2.2.2.3.cmml" xref="A1.E7.m1.3.3.2.2.2.2.2"><apply id="A1.E7.m1.3.3.2.2.2.1.1.1.cmml" xref="A1.E7.m1.3.3.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E7.m1.3.3.2.2.2.1.1.1.1.cmml" xref="A1.E7.m1.3.3.2.2.2.1.1.1">subscript</csymbol><ci id="A1.E7.m1.3.3.2.2.2.1.1.1.2.cmml" xref="A1.E7.m1.3.3.2.2.2.1.1.1.2">𝐗</ci><ci id="A1.E7.m1.3.3.2.2.2.1.1.1.3.cmml" xref="A1.E7.m1.3.3.2.2.2.1.1.1.3">𝑖</ci></apply><apply id="A1.E7.m1.3.3.2.2.2.2.2.2.cmml" xref="A1.E7.m1.3.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.E7.m1.3.3.2.2.2.2.2.2.1.cmml" xref="A1.E7.m1.3.3.2.2.2.2.2.2">subscript</csymbol><ci id="A1.E7.m1.3.3.2.2.2.2.2.2.2.cmml" xref="A1.E7.m1.3.3.2.2.2.2.2.2.2">𝜃</ci><ci id="A1.E7.m1.3.3.2.2.2.2.2.2.3.cmml" xref="A1.E7.m1.3.3.2.2.2.2.2.2.3">𝑖</ci></apply></list></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E7.m1.3c">\displaystyle\mathcal{D}\left(f(\mathbf{X}_{i};{\mathbf{\theta}}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i})\right)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.E7.m2.2" class="ltx_Math" alttext="\displaystyle\approx\mathcal{D}\left(f(\mathbf{X}_{i};{\mathbf{\theta}}_{i}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i})\right)" display="inline"><semantics id="A1.E7.m2.2a"><mrow id="A1.E7.m2.2.2" xref="A1.E7.m2.2.2.cmml"><mi id="A1.E7.m2.2.2.4" xref="A1.E7.m2.2.2.4.cmml"></mi><mo id="A1.E7.m2.2.2.3" xref="A1.E7.m2.2.2.3.cmml">≈</mo><mrow id="A1.E7.m2.2.2.2" xref="A1.E7.m2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E7.m2.2.2.2.4" xref="A1.E7.m2.2.2.2.4.cmml">𝒟</mi><mo lspace="0em" rspace="0em" id="A1.E7.m2.2.2.2.3" xref="A1.E7.m2.2.2.2.3.cmml">​</mo><mrow id="A1.E7.m2.2.2.2.2.2" xref="A1.E7.m2.2.2.2.2.3.cmml"><mo id="A1.E7.m2.2.2.2.2.2.3" xref="A1.E7.m2.2.2.2.2.3.cmml">(</mo><mrow id="A1.E7.m2.1.1.1.1.1.1" xref="A1.E7.m2.1.1.1.1.1.1.cmml"><mi id="A1.E7.m2.1.1.1.1.1.1.4" xref="A1.E7.m2.1.1.1.1.1.1.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.E7.m2.1.1.1.1.1.1.3" xref="A1.E7.m2.1.1.1.1.1.1.3.cmml">​</mo><mrow id="A1.E7.m2.1.1.1.1.1.1.2.2" xref="A1.E7.m2.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="A1.E7.m2.1.1.1.1.1.1.2.2.3" xref="A1.E7.m2.1.1.1.1.1.1.2.3.cmml">(</mo><msub id="A1.E7.m2.1.1.1.1.1.1.1.1.1" xref="A1.E7.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E7.m2.1.1.1.1.1.1.1.1.1.2" xref="A1.E7.m2.1.1.1.1.1.1.1.1.1.2.cmml">𝐗</mi><mi id="A1.E7.m2.1.1.1.1.1.1.1.1.1.3" xref="A1.E7.m2.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E7.m2.1.1.1.1.1.1.2.2.4" xref="A1.E7.m2.1.1.1.1.1.1.2.3.cmml">;</mo><msub id="A1.E7.m2.1.1.1.1.1.1.2.2.2" xref="A1.E7.m2.1.1.1.1.1.1.2.2.2.cmml"><mi id="A1.E7.m2.1.1.1.1.1.1.2.2.2.2" xref="A1.E7.m2.1.1.1.1.1.1.2.2.2.2.cmml">θ</mi><mi id="A1.E7.m2.1.1.1.1.1.1.2.2.2.3" xref="A1.E7.m2.1.1.1.1.1.1.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="A1.E7.m2.1.1.1.1.1.1.2.2.5" xref="A1.E7.m2.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E7.m2.2.2.2.2.2.4" xref="A1.E7.m2.2.2.2.2.3.cmml">,</mo><mrow id="A1.E7.m2.2.2.2.2.2.2" xref="A1.E7.m2.2.2.2.2.2.2.cmml"><mi id="A1.E7.m2.2.2.2.2.2.2.4" xref="A1.E7.m2.2.2.2.2.2.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.E7.m2.2.2.2.2.2.2.3" xref="A1.E7.m2.2.2.2.2.2.2.3.cmml">​</mo><mrow id="A1.E7.m2.2.2.2.2.2.2.2.2" xref="A1.E7.m2.2.2.2.2.2.2.2.3.cmml"><mo stretchy="false" id="A1.E7.m2.2.2.2.2.2.2.2.2.3" xref="A1.E7.m2.2.2.2.2.2.2.2.3.cmml">(</mo><msub id="A1.E7.m2.2.2.2.2.2.2.1.1.1" xref="A1.E7.m2.2.2.2.2.2.2.1.1.1.cmml"><mi id="A1.E7.m2.2.2.2.2.2.2.1.1.1.2" xref="A1.E7.m2.2.2.2.2.2.2.1.1.1.2.cmml">𝐗</mi><mi id="A1.E7.m2.2.2.2.2.2.2.1.1.1.3" xref="A1.E7.m2.2.2.2.2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="A1.E7.m2.2.2.2.2.2.2.2.2.4" xref="A1.E7.m2.2.2.2.2.2.2.2.3.cmml">;</mo><msub id="A1.E7.m2.2.2.2.2.2.2.2.2.2" xref="A1.E7.m2.2.2.2.2.2.2.2.2.2.cmml"><mi id="A1.E7.m2.2.2.2.2.2.2.2.2.2.2" xref="A1.E7.m2.2.2.2.2.2.2.2.2.2.2.cmml">θ</mi><mi id="A1.E7.m2.2.2.2.2.2.2.2.2.2.3" xref="A1.E7.m2.2.2.2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="A1.E7.m2.2.2.2.2.2.2.2.2.5" xref="A1.E7.m2.2.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E7.m2.2.2.2.2.2.5" xref="A1.E7.m2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E7.m2.2b"><apply id="A1.E7.m2.2.2.cmml" xref="A1.E7.m2.2.2"><approx id="A1.E7.m2.2.2.3.cmml" xref="A1.E7.m2.2.2.3"></approx><csymbol cd="latexml" id="A1.E7.m2.2.2.4.cmml" xref="A1.E7.m2.2.2.4">absent</csymbol><apply id="A1.E7.m2.2.2.2.cmml" xref="A1.E7.m2.2.2.2"><times id="A1.E7.m2.2.2.2.3.cmml" xref="A1.E7.m2.2.2.2.3"></times><ci id="A1.E7.m2.2.2.2.4.cmml" xref="A1.E7.m2.2.2.2.4">𝒟</ci><interval closure="open" id="A1.E7.m2.2.2.2.2.3.cmml" xref="A1.E7.m2.2.2.2.2.2"><apply id="A1.E7.m2.1.1.1.1.1.1.cmml" xref="A1.E7.m2.1.1.1.1.1.1"><times id="A1.E7.m2.1.1.1.1.1.1.3.cmml" xref="A1.E7.m2.1.1.1.1.1.1.3"></times><ci id="A1.E7.m2.1.1.1.1.1.1.4.cmml" xref="A1.E7.m2.1.1.1.1.1.1.4">𝑓</ci><list id="A1.E7.m2.1.1.1.1.1.1.2.3.cmml" xref="A1.E7.m2.1.1.1.1.1.1.2.2"><apply id="A1.E7.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E7.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E7.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E7.m2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E7.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E7.m2.1.1.1.1.1.1.1.1.1.2">𝐗</ci><ci id="A1.E7.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E7.m2.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="A1.E7.m2.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E7.m2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E7.m2.1.1.1.1.1.1.2.2.2.1.cmml" xref="A1.E7.m2.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A1.E7.m2.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.E7.m2.1.1.1.1.1.1.2.2.2.2">𝜃</ci><ci id="A1.E7.m2.1.1.1.1.1.1.2.2.2.3.cmml" xref="A1.E7.m2.1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply></list></apply><apply id="A1.E7.m2.2.2.2.2.2.2.cmml" xref="A1.E7.m2.2.2.2.2.2.2"><times id="A1.E7.m2.2.2.2.2.2.2.3.cmml" xref="A1.E7.m2.2.2.2.2.2.2.3"></times><ci id="A1.E7.m2.2.2.2.2.2.2.4.cmml" xref="A1.E7.m2.2.2.2.2.2.2.4">𝑓</ci><list id="A1.E7.m2.2.2.2.2.2.2.2.3.cmml" xref="A1.E7.m2.2.2.2.2.2.2.2.2"><apply id="A1.E7.m2.2.2.2.2.2.2.1.1.1.cmml" xref="A1.E7.m2.2.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E7.m2.2.2.2.2.2.2.1.1.1.1.cmml" xref="A1.E7.m2.2.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="A1.E7.m2.2.2.2.2.2.2.1.1.1.2.cmml" xref="A1.E7.m2.2.2.2.2.2.2.1.1.1.2">𝐗</ci><ci id="A1.E7.m2.2.2.2.2.2.2.1.1.1.3.cmml" xref="A1.E7.m2.2.2.2.2.2.2.1.1.1.3">𝑖</ci></apply><apply id="A1.E7.m2.2.2.2.2.2.2.2.2.2.cmml" xref="A1.E7.m2.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.E7.m2.2.2.2.2.2.2.2.2.2.1.cmml" xref="A1.E7.m2.2.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="A1.E7.m2.2.2.2.2.2.2.2.2.2.2.cmml" xref="A1.E7.m2.2.2.2.2.2.2.2.2.2.2">𝜃</ci><ci id="A1.E7.m2.2.2.2.2.2.2.2.2.2.3.cmml" xref="A1.E7.m2.2.2.2.2.2.2.2.2.2.3">𝑖</ci></apply></list></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E7.m2.2c">\displaystyle\approx\mathcal{D}\left(f(\mathbf{X}_{i};{\mathbf{\theta}}_{i}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i})\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
<tbody id="A1.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.E8.m2.2" class="ltx_math_unparsed" alttext="\displaystyle\qquad+({\mathbf{\theta}}-{\mathbf{\theta}}_{i})^{T}\bigg{[}\big{(}J^{({\mathbf{z}})}_{\theta}\big{)}^{T}\nabla_{\mathbf{Z}}\mathcal{D}\left(f(\mathbf{X}_{i};{\mathbf{\theta}}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i})\right)\bigg{\rvert}_{{\mathbf{\theta}}={\mathbf{\theta}}_{i}}\bigg{]}" display="inline"><semantics id="A1.E8.m2.2a"><mrow id="A1.E8.m2.2b"><mo id="A1.E8.m2.2.3">+</mo><msup id="A1.E8.m2.2.4"><mrow id="A1.E8.m2.2.4.2"><mo stretchy="false" id="A1.E8.m2.2.4.2.1">(</mo><mi id="A1.E8.m2.2.4.2.2">θ</mi><mo id="A1.E8.m2.2.4.2.3">−</mo><msub id="A1.E8.m2.2.4.2.4"><mi id="A1.E8.m2.2.4.2.4.2">θ</mi><mi id="A1.E8.m2.2.4.2.4.3">i</mi></msub><mo stretchy="false" id="A1.E8.m2.2.4.2.5">)</mo></mrow><mi id="A1.E8.m2.2.4.3">T</mi></msup><msub id="A1.E8.m2.2.5"><mrow id="A1.E8.m2.2.5.2"><mo maxsize="210%" minsize="210%" id="A1.E8.m2.2.5.2.1">[</mo><msup id="A1.E8.m2.2.5.2.2"><mrow id="A1.E8.m2.2.5.2.2.2"><mo maxsize="120%" minsize="120%" id="A1.E8.m2.2.5.2.2.2.1">(</mo><msubsup id="A1.E8.m2.2.5.2.2.2.2"><mi id="A1.E8.m2.2.5.2.2.2.2.2.2">J</mi><mi id="A1.E8.m2.2.5.2.2.2.2.3">θ</mi><mrow id="A1.E8.m2.1.1.1.3"><mo stretchy="false" id="A1.E8.m2.1.1.1.3.1">(</mo><mi id="A1.E8.m2.1.1.1.1">𝐳</mi><mo stretchy="false" id="A1.E8.m2.1.1.1.3.2">)</mo></mrow></msubsup><mo maxsize="120%" minsize="120%" rspace="0.167em" id="A1.E8.m2.2.5.2.2.2.3">)</mo></mrow><mi id="A1.E8.m2.2.5.2.2.3">T</mi></msup><msub id="A1.E8.m2.2.5.2.3"><mo rspace="0.167em" id="A1.E8.m2.2.5.2.3.2">∇</mo><mi id="A1.E8.m2.2.5.2.3.3">𝐙</mi></msub><mi class="ltx_font_mathcaligraphic" id="A1.E8.m2.2.5.2.4">𝒟</mi><mrow id="A1.E8.m2.2.5.2.5"><mo id="A1.E8.m2.2.5.2.5.1">(</mo><mi id="A1.E8.m2.2.5.2.5.2">f</mi><mrow id="A1.E8.m2.2.5.2.5.3"><mo stretchy="false" id="A1.E8.m2.2.5.2.5.3.1">(</mo><msub id="A1.E8.m2.2.5.2.5.3.2"><mi id="A1.E8.m2.2.5.2.5.3.2.2">𝐗</mi><mi id="A1.E8.m2.2.5.2.5.3.2.3">i</mi></msub><mo id="A1.E8.m2.2.5.2.5.3.3">;</mo><mi id="A1.E8.m2.2.2">θ</mi><mo stretchy="false" id="A1.E8.m2.2.5.2.5.3.4">)</mo></mrow><mo id="A1.E8.m2.2.5.2.5.4">,</mo><mi id="A1.E8.m2.2.5.2.5.5">f</mi><mrow id="A1.E8.m2.2.5.2.5.6"><mo stretchy="false" id="A1.E8.m2.2.5.2.5.6.1">(</mo><msub id="A1.E8.m2.2.5.2.5.6.2"><mi id="A1.E8.m2.2.5.2.5.6.2.2">𝐗</mi><mi id="A1.E8.m2.2.5.2.5.6.2.3">i</mi></msub><mo id="A1.E8.m2.2.5.2.5.6.3">;</mo><msub id="A1.E8.m2.2.5.2.5.6.4"><mi id="A1.E8.m2.2.5.2.5.6.4.2">θ</mi><mi id="A1.E8.m2.2.5.2.5.6.4.3">i</mi></msub><mo stretchy="false" id="A1.E8.m2.2.5.2.5.6.5">)</mo></mrow><mo id="A1.E8.m2.2.5.2.5.7">)</mo></mrow><mo maxsize="210%" minsize="210%" id="A1.E8.m2.2.5.2.6">|</mo></mrow><mrow id="A1.E8.m2.2.5.3"><mi id="A1.E8.m2.2.5.3.2">θ</mi><mo id="A1.E8.m2.2.5.3.1">=</mo><msub id="A1.E8.m2.2.5.3.3"><mi id="A1.E8.m2.2.5.3.3.2">θ</mi><mi id="A1.E8.m2.2.5.3.3.3">i</mi></msub></mrow></msub><mo maxsize="210%" minsize="210%" id="A1.E8.m2.2.6">]</mo></mrow><annotation encoding="application/x-tex" id="A1.E8.m2.2c">\displaystyle\qquad+({\mathbf{\theta}}-{\mathbf{\theta}}_{i})^{T}\bigg{[}\big{(}J^{({\mathbf{z}})}_{\theta}\big{)}^{T}\nabla_{\mathbf{Z}}\mathcal{D}\left(f(\mathbf{X}_{i};{\mathbf{\theta}}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i})\right)\bigg{\rvert}_{{\mathbf{\theta}}={\mathbf{\theta}}_{i}}\bigg{]}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
<tbody id="A1.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.E9.m2.1" class="ltx_math_unparsed" alttext="\displaystyle\qquad+\frac{1}{2}({\mathbf{\theta}}-{\mathbf{\theta}}_{i})^{T}\bigg{[}\nabla^{2}_{{\mathbf{\theta}}}\mathcal{D}\left(f(\mathbf{X}_{i};{\mathbf{\theta}}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i})\right)\bigg{\rvert}_{{\mathbf{\theta}}={\mathbf{\theta}}_{i}}\bigg{]}({\mathbf{\theta}}-{\mathbf{\theta}}_{i})," display="inline"><semantics id="A1.E9.m2.1a"><mrow id="A1.E9.m2.1b"><mo id="A1.E9.m2.1.2">+</mo><mstyle displaystyle="true" id="A1.E9.m2.1.3"><mfrac id="A1.E9.m2.1.3a"><mn id="A1.E9.m2.1.3.2">1</mn><mn id="A1.E9.m2.1.3.3">2</mn></mfrac></mstyle><msup id="A1.E9.m2.1.4"><mrow id="A1.E9.m2.1.4.2"><mo stretchy="false" id="A1.E9.m2.1.4.2.1">(</mo><mi id="A1.E9.m2.1.4.2.2">θ</mi><mo id="A1.E9.m2.1.4.2.3">−</mo><msub id="A1.E9.m2.1.4.2.4"><mi id="A1.E9.m2.1.4.2.4.2">θ</mi><mi id="A1.E9.m2.1.4.2.4.3">i</mi></msub><mo stretchy="false" id="A1.E9.m2.1.4.2.5">)</mo></mrow><mi id="A1.E9.m2.1.4.3">T</mi></msup><msub id="A1.E9.m2.1.5"><mrow id="A1.E9.m2.1.5.2"><mo maxsize="210%" minsize="210%" id="A1.E9.m2.1.5.2.1">[</mo><msubsup id="A1.E9.m2.1.5.2.2"><mo rspace="0.167em" id="A1.E9.m2.1.5.2.2.2.2">∇</mo><mi id="A1.E9.m2.1.5.2.2.3">θ</mi><mn id="A1.E9.m2.1.5.2.2.2.3">2</mn></msubsup><mi class="ltx_font_mathcaligraphic" id="A1.E9.m2.1.5.2.3">𝒟</mi><mrow id="A1.E9.m2.1.5.2.4"><mo id="A1.E9.m2.1.5.2.4.1">(</mo><mi id="A1.E9.m2.1.5.2.4.2">f</mi><mrow id="A1.E9.m2.1.5.2.4.3"><mo stretchy="false" id="A1.E9.m2.1.5.2.4.3.1">(</mo><msub id="A1.E9.m2.1.5.2.4.3.2"><mi id="A1.E9.m2.1.5.2.4.3.2.2">𝐗</mi><mi id="A1.E9.m2.1.5.2.4.3.2.3">i</mi></msub><mo id="A1.E9.m2.1.5.2.4.3.3">;</mo><mi id="A1.E9.m2.1.1">θ</mi><mo stretchy="false" id="A1.E9.m2.1.5.2.4.3.4">)</mo></mrow><mo id="A1.E9.m2.1.5.2.4.4">,</mo><mi id="A1.E9.m2.1.5.2.4.5">f</mi><mrow id="A1.E9.m2.1.5.2.4.6"><mo stretchy="false" id="A1.E9.m2.1.5.2.4.6.1">(</mo><msub id="A1.E9.m2.1.5.2.4.6.2"><mi id="A1.E9.m2.1.5.2.4.6.2.2">𝐗</mi><mi id="A1.E9.m2.1.5.2.4.6.2.3">i</mi></msub><mo id="A1.E9.m2.1.5.2.4.6.3">;</mo><msub id="A1.E9.m2.1.5.2.4.6.4"><mi id="A1.E9.m2.1.5.2.4.6.4.2">θ</mi><mi id="A1.E9.m2.1.5.2.4.6.4.3">i</mi></msub><mo stretchy="false" id="A1.E9.m2.1.5.2.4.6.5">)</mo></mrow><mo id="A1.E9.m2.1.5.2.4.7">)</mo></mrow><mo maxsize="210%" minsize="210%" id="A1.E9.m2.1.5.2.5">|</mo></mrow><mrow id="A1.E9.m2.1.5.3"><mi id="A1.E9.m2.1.5.3.2">θ</mi><mo id="A1.E9.m2.1.5.3.1">=</mo><msub id="A1.E9.m2.1.5.3.3"><mi id="A1.E9.m2.1.5.3.3.2">θ</mi><mi id="A1.E9.m2.1.5.3.3.3">i</mi></msub></mrow></msub><mo maxsize="210%" minsize="210%" id="A1.E9.m2.1.6">]</mo><mo stretchy="false" id="A1.E9.m2.1.7">(</mo><mi id="A1.E9.m2.1.8">θ</mi><mo id="A1.E9.m2.1.9">−</mo><msub id="A1.E9.m2.1.10"><mi id="A1.E9.m2.1.10.2">θ</mi><mi id="A1.E9.m2.1.10.3">i</mi></msub><mo stretchy="false" id="A1.E9.m2.1.11">)</mo><mo id="A1.E9.m2.1.12">,</mo></mrow><annotation encoding="application/x-tex" id="A1.E9.m2.1c">\displaystyle\qquad+\frac{1}{2}({\mathbf{\theta}}-{\mathbf{\theta}}_{i})^{T}\bigg{[}\nabla^{2}_{{\mathbf{\theta}}}\mathcal{D}\left(f(\mathbf{X}_{i};{\mathbf{\theta}}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i})\right)\bigg{\rvert}_{{\mathbf{\theta}}={\mathbf{\theta}}_{i}}\bigg{]}({\mathbf{\theta}}-{\mathbf{\theta}}_{i}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="A1.SS2.p4.1" class="ltx_p">where <math id="A1.SS2.p4.1.m1.1" class="ltx_Math" alttext="J^{({\mathbf{z}})}_{\theta}" display="inline"><semantics id="A1.SS2.p4.1.m1.1a"><msubsup id="A1.SS2.p4.1.m1.1.2" xref="A1.SS2.p4.1.m1.1.2.cmml"><mi id="A1.SS2.p4.1.m1.1.2.2.2" xref="A1.SS2.p4.1.m1.1.2.2.2.cmml">J</mi><mi id="A1.SS2.p4.1.m1.1.2.3" xref="A1.SS2.p4.1.m1.1.2.3.cmml">θ</mi><mrow id="A1.SS2.p4.1.m1.1.1.1.3" xref="A1.SS2.p4.1.m1.1.2.cmml"><mo stretchy="false" id="A1.SS2.p4.1.m1.1.1.1.3.1" xref="A1.SS2.p4.1.m1.1.2.cmml">(</mo><mi id="A1.SS2.p4.1.m1.1.1.1.1" xref="A1.SS2.p4.1.m1.1.1.1.1.cmml">𝐳</mi><mo stretchy="false" id="A1.SS2.p4.1.m1.1.1.1.3.2" xref="A1.SS2.p4.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.1.m1.1b"><apply id="A1.SS2.p4.1.m1.1.2.cmml" xref="A1.SS2.p4.1.m1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p4.1.m1.1.2.1.cmml" xref="A1.SS2.p4.1.m1.1.2">subscript</csymbol><apply id="A1.SS2.p4.1.m1.1.2.2.cmml" xref="A1.SS2.p4.1.m1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p4.1.m1.1.2.2.1.cmml" xref="A1.SS2.p4.1.m1.1.2">superscript</csymbol><ci id="A1.SS2.p4.1.m1.1.2.2.2.cmml" xref="A1.SS2.p4.1.m1.1.2.2.2">𝐽</ci><ci id="A1.SS2.p4.1.m1.1.1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1.1.1">𝐳</ci></apply><ci id="A1.SS2.p4.1.m1.1.2.3.cmml" xref="A1.SS2.p4.1.m1.1.2.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.1.m1.1c">J^{({\mathbf{z}})}_{\theta}</annotation></semantics></math> is the output Jacobian, arising in <a href="#A1.E8" title="In A.2 FedFish Derivation ‣ Appendix A Appendix ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">8</span></a> from the chain rule.</p>
</div>
<div id="A1.SS2.p5" class="ltx_para ltx_noindent">
<p id="A1.SS2.p5.6" class="ltx_p">For any distance measured between the softmax outputs of the networks, <math id="A1.SS2.p5.1.m1.2" class="ltx_Math" alttext="\mathcal{D}\left(\cdot,\cdot\right)" display="inline"><semantics id="A1.SS2.p5.1.m1.2a"><mrow id="A1.SS2.p5.1.m1.2.3" xref="A1.SS2.p5.1.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p5.1.m1.2.3.2" xref="A1.SS2.p5.1.m1.2.3.2.cmml">𝒟</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p5.1.m1.2.3.1" xref="A1.SS2.p5.1.m1.2.3.1.cmml">​</mo><mrow id="A1.SS2.p5.1.m1.2.3.3.2" xref="A1.SS2.p5.1.m1.2.3.3.1.cmml"><mo id="A1.SS2.p5.1.m1.2.3.3.2.1" xref="A1.SS2.p5.1.m1.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="A1.SS2.p5.1.m1.1.1" xref="A1.SS2.p5.1.m1.1.1.cmml">⋅</mo><mo rspace="0em" id="A1.SS2.p5.1.m1.2.3.3.2.2" xref="A1.SS2.p5.1.m1.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="A1.SS2.p5.1.m1.2.2" xref="A1.SS2.p5.1.m1.2.2.cmml">⋅</mo><mo id="A1.SS2.p5.1.m1.2.3.3.2.3" xref="A1.SS2.p5.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.1.m1.2b"><apply id="A1.SS2.p5.1.m1.2.3.cmml" xref="A1.SS2.p5.1.m1.2.3"><times id="A1.SS2.p5.1.m1.2.3.1.cmml" xref="A1.SS2.p5.1.m1.2.3.1"></times><ci id="A1.SS2.p5.1.m1.2.3.2.cmml" xref="A1.SS2.p5.1.m1.2.3.2">𝒟</ci><interval closure="open" id="A1.SS2.p5.1.m1.2.3.3.1.cmml" xref="A1.SS2.p5.1.m1.2.3.3.2"><ci id="A1.SS2.p5.1.m1.1.1.cmml" xref="A1.SS2.p5.1.m1.1.1">⋅</ci><ci id="A1.SS2.p5.1.m1.2.2.cmml" xref="A1.SS2.p5.1.m1.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.1.m1.2c">\mathcal{D}\left(\cdot,\cdot\right)</annotation></semantics></math>, the first term in <a href="#A1.E7" title="In A.2 FedFish Derivation ‣ Appendix A Appendix ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">7</span></a> is <math id="A1.SS2.p5.2.m2.1" class="ltx_Math" alttext="0" display="inline"><semantics id="A1.SS2.p5.2.m2.1a"><mn id="A1.SS2.p5.2.m2.1.1" xref="A1.SS2.p5.2.m2.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.2.m2.1b"><cn type="integer" id="A1.SS2.p5.2.m2.1.1.cmml" xref="A1.SS2.p5.2.m2.1.1">0</cn></annotation-xml></semantics></math>.
Since the distance is minimized at <math id="A1.SS2.p5.3.m3.1" class="ltx_Math" alttext="{\mathbf{\theta}}={\mathbf{\theta}}_{i}" display="inline"><semantics id="A1.SS2.p5.3.m3.1a"><mrow id="A1.SS2.p5.3.m3.1.1" xref="A1.SS2.p5.3.m3.1.1.cmml"><mi id="A1.SS2.p5.3.m3.1.1.2" xref="A1.SS2.p5.3.m3.1.1.2.cmml">θ</mi><mo id="A1.SS2.p5.3.m3.1.1.1" xref="A1.SS2.p5.3.m3.1.1.1.cmml">=</mo><msub id="A1.SS2.p5.3.m3.1.1.3" xref="A1.SS2.p5.3.m3.1.1.3.cmml"><mi id="A1.SS2.p5.3.m3.1.1.3.2" xref="A1.SS2.p5.3.m3.1.1.3.2.cmml">θ</mi><mi id="A1.SS2.p5.3.m3.1.1.3.3" xref="A1.SS2.p5.3.m3.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.3.m3.1b"><apply id="A1.SS2.p5.3.m3.1.1.cmml" xref="A1.SS2.p5.3.m3.1.1"><eq id="A1.SS2.p5.3.m3.1.1.1.cmml" xref="A1.SS2.p5.3.m3.1.1.1"></eq><ci id="A1.SS2.p5.3.m3.1.1.2.cmml" xref="A1.SS2.p5.3.m3.1.1.2">𝜃</ci><apply id="A1.SS2.p5.3.m3.1.1.3.cmml" xref="A1.SS2.p5.3.m3.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p5.3.m3.1.1.3.1.cmml" xref="A1.SS2.p5.3.m3.1.1.3">subscript</csymbol><ci id="A1.SS2.p5.3.m3.1.1.3.2.cmml" xref="A1.SS2.p5.3.m3.1.1.3.2">𝜃</ci><ci id="A1.SS2.p5.3.m3.1.1.3.3.cmml" xref="A1.SS2.p5.3.m3.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.3.m3.1c">{\mathbf{\theta}}={\mathbf{\theta}}_{i}</annotation></semantics></math>, the gradient, <math id="A1.SS2.p5.4.m4.3" class="ltx_Math" alttext="\nabla_{\mathbf{Z}}\mathcal{D}\left(f(\mathbf{X}_{i};{\mathbf{\theta}}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i})\right)" display="inline"><semantics id="A1.SS2.p5.4.m4.3a"><mrow id="A1.SS2.p5.4.m4.3.3" xref="A1.SS2.p5.4.m4.3.3.cmml"><mrow id="A1.SS2.p5.4.m4.3.3.4" xref="A1.SS2.p5.4.m4.3.3.4.cmml"><msub id="A1.SS2.p5.4.m4.3.3.4.1" xref="A1.SS2.p5.4.m4.3.3.4.1.cmml"><mo id="A1.SS2.p5.4.m4.3.3.4.1.2" xref="A1.SS2.p5.4.m4.3.3.4.1.2.cmml">∇</mo><mi id="A1.SS2.p5.4.m4.3.3.4.1.3" xref="A1.SS2.p5.4.m4.3.3.4.1.3.cmml">𝐙</mi></msub><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p5.4.m4.3.3.4.2" xref="A1.SS2.p5.4.m4.3.3.4.2.cmml">𝒟</mi></mrow><mo lspace="0em" rspace="0em" id="A1.SS2.p5.4.m4.3.3.3" xref="A1.SS2.p5.4.m4.3.3.3.cmml">​</mo><mrow id="A1.SS2.p5.4.m4.3.3.2.2" xref="A1.SS2.p5.4.m4.3.3.2.3.cmml"><mo id="A1.SS2.p5.4.m4.3.3.2.2.3" xref="A1.SS2.p5.4.m4.3.3.2.3.cmml">(</mo><mrow id="A1.SS2.p5.4.m4.2.2.1.1.1" xref="A1.SS2.p5.4.m4.2.2.1.1.1.cmml"><mi id="A1.SS2.p5.4.m4.2.2.1.1.1.3" xref="A1.SS2.p5.4.m4.2.2.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p5.4.m4.2.2.1.1.1.2" xref="A1.SS2.p5.4.m4.2.2.1.1.1.2.cmml">​</mo><mrow id="A1.SS2.p5.4.m4.2.2.1.1.1.1.1" xref="A1.SS2.p5.4.m4.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.SS2.p5.4.m4.2.2.1.1.1.1.1.2" xref="A1.SS2.p5.4.m4.2.2.1.1.1.1.2.cmml">(</mo><msub id="A1.SS2.p5.4.m4.2.2.1.1.1.1.1.1" xref="A1.SS2.p5.4.m4.2.2.1.1.1.1.1.1.cmml"><mi id="A1.SS2.p5.4.m4.2.2.1.1.1.1.1.1.2" xref="A1.SS2.p5.4.m4.2.2.1.1.1.1.1.1.2.cmml">𝐗</mi><mi id="A1.SS2.p5.4.m4.2.2.1.1.1.1.1.1.3" xref="A1.SS2.p5.4.m4.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS2.p5.4.m4.2.2.1.1.1.1.1.3" xref="A1.SS2.p5.4.m4.2.2.1.1.1.1.2.cmml">;</mo><mi id="A1.SS2.p5.4.m4.1.1" xref="A1.SS2.p5.4.m4.1.1.cmml">θ</mi><mo stretchy="false" id="A1.SS2.p5.4.m4.2.2.1.1.1.1.1.4" xref="A1.SS2.p5.4.m4.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.SS2.p5.4.m4.3.3.2.2.4" xref="A1.SS2.p5.4.m4.3.3.2.3.cmml">,</mo><mrow id="A1.SS2.p5.4.m4.3.3.2.2.2" xref="A1.SS2.p5.4.m4.3.3.2.2.2.cmml"><mi id="A1.SS2.p5.4.m4.3.3.2.2.2.4" xref="A1.SS2.p5.4.m4.3.3.2.2.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p5.4.m4.3.3.2.2.2.3" xref="A1.SS2.p5.4.m4.3.3.2.2.2.3.cmml">​</mo><mrow id="A1.SS2.p5.4.m4.3.3.2.2.2.2.2" xref="A1.SS2.p5.4.m4.3.3.2.2.2.2.3.cmml"><mo stretchy="false" id="A1.SS2.p5.4.m4.3.3.2.2.2.2.2.3" xref="A1.SS2.p5.4.m4.3.3.2.2.2.2.3.cmml">(</mo><msub id="A1.SS2.p5.4.m4.3.3.2.2.2.1.1.1" xref="A1.SS2.p5.4.m4.3.3.2.2.2.1.1.1.cmml"><mi id="A1.SS2.p5.4.m4.3.3.2.2.2.1.1.1.2" xref="A1.SS2.p5.4.m4.3.3.2.2.2.1.1.1.2.cmml">𝐗</mi><mi id="A1.SS2.p5.4.m4.3.3.2.2.2.1.1.1.3" xref="A1.SS2.p5.4.m4.3.3.2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS2.p5.4.m4.3.3.2.2.2.2.2.4" xref="A1.SS2.p5.4.m4.3.3.2.2.2.2.3.cmml">;</mo><msub id="A1.SS2.p5.4.m4.3.3.2.2.2.2.2.2" xref="A1.SS2.p5.4.m4.3.3.2.2.2.2.2.2.cmml"><mi id="A1.SS2.p5.4.m4.3.3.2.2.2.2.2.2.2" xref="A1.SS2.p5.4.m4.3.3.2.2.2.2.2.2.2.cmml">θ</mi><mi id="A1.SS2.p5.4.m4.3.3.2.2.2.2.2.2.3" xref="A1.SS2.p5.4.m4.3.3.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="A1.SS2.p5.4.m4.3.3.2.2.2.2.2.5" xref="A1.SS2.p5.4.m4.3.3.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="A1.SS2.p5.4.m4.3.3.2.2.5" xref="A1.SS2.p5.4.m4.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.4.m4.3b"><apply id="A1.SS2.p5.4.m4.3.3.cmml" xref="A1.SS2.p5.4.m4.3.3"><times id="A1.SS2.p5.4.m4.3.3.3.cmml" xref="A1.SS2.p5.4.m4.3.3.3"></times><apply id="A1.SS2.p5.4.m4.3.3.4.cmml" xref="A1.SS2.p5.4.m4.3.3.4"><apply id="A1.SS2.p5.4.m4.3.3.4.1.cmml" xref="A1.SS2.p5.4.m4.3.3.4.1"><csymbol cd="ambiguous" id="A1.SS2.p5.4.m4.3.3.4.1.1.cmml" xref="A1.SS2.p5.4.m4.3.3.4.1">subscript</csymbol><ci id="A1.SS2.p5.4.m4.3.3.4.1.2.cmml" xref="A1.SS2.p5.4.m4.3.3.4.1.2">∇</ci><ci id="A1.SS2.p5.4.m4.3.3.4.1.3.cmml" xref="A1.SS2.p5.4.m4.3.3.4.1.3">𝐙</ci></apply><ci id="A1.SS2.p5.4.m4.3.3.4.2.cmml" xref="A1.SS2.p5.4.m4.3.3.4.2">𝒟</ci></apply><interval closure="open" id="A1.SS2.p5.4.m4.3.3.2.3.cmml" xref="A1.SS2.p5.4.m4.3.3.2.2"><apply id="A1.SS2.p5.4.m4.2.2.1.1.1.cmml" xref="A1.SS2.p5.4.m4.2.2.1.1.1"><times id="A1.SS2.p5.4.m4.2.2.1.1.1.2.cmml" xref="A1.SS2.p5.4.m4.2.2.1.1.1.2"></times><ci id="A1.SS2.p5.4.m4.2.2.1.1.1.3.cmml" xref="A1.SS2.p5.4.m4.2.2.1.1.1.3">𝑓</ci><list id="A1.SS2.p5.4.m4.2.2.1.1.1.1.2.cmml" xref="A1.SS2.p5.4.m4.2.2.1.1.1.1.1"><apply id="A1.SS2.p5.4.m4.2.2.1.1.1.1.1.1.cmml" xref="A1.SS2.p5.4.m4.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p5.4.m4.2.2.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p5.4.m4.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p5.4.m4.2.2.1.1.1.1.1.1.2.cmml" xref="A1.SS2.p5.4.m4.2.2.1.1.1.1.1.1.2">𝐗</ci><ci id="A1.SS2.p5.4.m4.2.2.1.1.1.1.1.1.3.cmml" xref="A1.SS2.p5.4.m4.2.2.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="A1.SS2.p5.4.m4.1.1.cmml" xref="A1.SS2.p5.4.m4.1.1">𝜃</ci></list></apply><apply id="A1.SS2.p5.4.m4.3.3.2.2.2.cmml" xref="A1.SS2.p5.4.m4.3.3.2.2.2"><times id="A1.SS2.p5.4.m4.3.3.2.2.2.3.cmml" xref="A1.SS2.p5.4.m4.3.3.2.2.2.3"></times><ci id="A1.SS2.p5.4.m4.3.3.2.2.2.4.cmml" xref="A1.SS2.p5.4.m4.3.3.2.2.2.4">𝑓</ci><list id="A1.SS2.p5.4.m4.3.3.2.2.2.2.3.cmml" xref="A1.SS2.p5.4.m4.3.3.2.2.2.2.2"><apply id="A1.SS2.p5.4.m4.3.3.2.2.2.1.1.1.cmml" xref="A1.SS2.p5.4.m4.3.3.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p5.4.m4.3.3.2.2.2.1.1.1.1.cmml" xref="A1.SS2.p5.4.m4.3.3.2.2.2.1.1.1">subscript</csymbol><ci id="A1.SS2.p5.4.m4.3.3.2.2.2.1.1.1.2.cmml" xref="A1.SS2.p5.4.m4.3.3.2.2.2.1.1.1.2">𝐗</ci><ci id="A1.SS2.p5.4.m4.3.3.2.2.2.1.1.1.3.cmml" xref="A1.SS2.p5.4.m4.3.3.2.2.2.1.1.1.3">𝑖</ci></apply><apply id="A1.SS2.p5.4.m4.3.3.2.2.2.2.2.2.cmml" xref="A1.SS2.p5.4.m4.3.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS2.p5.4.m4.3.3.2.2.2.2.2.2.1.cmml" xref="A1.SS2.p5.4.m4.3.3.2.2.2.2.2.2">subscript</csymbol><ci id="A1.SS2.p5.4.m4.3.3.2.2.2.2.2.2.2.cmml" xref="A1.SS2.p5.4.m4.3.3.2.2.2.2.2.2.2">𝜃</ci><ci id="A1.SS2.p5.4.m4.3.3.2.2.2.2.2.2.3.cmml" xref="A1.SS2.p5.4.m4.3.3.2.2.2.2.2.2.3">𝑖</ci></apply></list></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.4.m4.3c">\nabla_{\mathbf{Z}}\mathcal{D}\left(f(\mathbf{X}_{i};{\mathbf{\theta}}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i})\right)</annotation></semantics></math> in <a href="#A1.E8" title="In A.2 FedFish Derivation ‣ Appendix A Appendix ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">8</span></a> is also <math id="A1.SS2.p5.5.m5.1" class="ltx_Math" alttext="0" display="inline"><semantics id="A1.SS2.p5.5.m5.1a"><mn id="A1.SS2.p5.5.m5.1.1" xref="A1.SS2.p5.5.m5.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.5.m5.1b"><cn type="integer" id="A1.SS2.p5.5.m5.1.1.cmml" xref="A1.SS2.p5.5.m5.1.1">0</cn></annotation-xml></semantics></math> when evaluated at <math id="A1.SS2.p5.6.m6.1" class="ltx_Math" alttext="{\mathbf{\theta}}={\mathbf{\theta}}_{i}" display="inline"><semantics id="A1.SS2.p5.6.m6.1a"><mrow id="A1.SS2.p5.6.m6.1.1" xref="A1.SS2.p5.6.m6.1.1.cmml"><mi id="A1.SS2.p5.6.m6.1.1.2" xref="A1.SS2.p5.6.m6.1.1.2.cmml">θ</mi><mo id="A1.SS2.p5.6.m6.1.1.1" xref="A1.SS2.p5.6.m6.1.1.1.cmml">=</mo><msub id="A1.SS2.p5.6.m6.1.1.3" xref="A1.SS2.p5.6.m6.1.1.3.cmml"><mi id="A1.SS2.p5.6.m6.1.1.3.2" xref="A1.SS2.p5.6.m6.1.1.3.2.cmml">θ</mi><mi id="A1.SS2.p5.6.m6.1.1.3.3" xref="A1.SS2.p5.6.m6.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.6.m6.1b"><apply id="A1.SS2.p5.6.m6.1.1.cmml" xref="A1.SS2.p5.6.m6.1.1"><eq id="A1.SS2.p5.6.m6.1.1.1.cmml" xref="A1.SS2.p5.6.m6.1.1.1"></eq><ci id="A1.SS2.p5.6.m6.1.1.2.cmml" xref="A1.SS2.p5.6.m6.1.1.2">𝜃</ci><apply id="A1.SS2.p5.6.m6.1.1.3.cmml" xref="A1.SS2.p5.6.m6.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p5.6.m6.1.1.3.1.cmml" xref="A1.SS2.p5.6.m6.1.1.3">subscript</csymbol><ci id="A1.SS2.p5.6.m6.1.1.3.2.cmml" xref="A1.SS2.p5.6.m6.1.1.3.2">𝜃</ci><ci id="A1.SS2.p5.6.m6.1.1.3.3.cmml" xref="A1.SS2.p5.6.m6.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.6.m6.1c">{\mathbf{\theta}}={\mathbf{\theta}}_{i}</annotation></semantics></math>, causing this term to vanish.</p>
</div>
<div id="A1.SS2.p6" class="ltx_para ltx_noindent">
<p id="A1.SS2.p6.3" class="ltx_p">Finally, applying the chain rule to the Hessian in <a href="#A1.E9" title="In A.2 FedFish Derivation ‣ Appendix A Appendix ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">9</span></a> yields</p>
<table id="A1.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A1.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.E10.m1.1" class="ltx_math_unparsed" alttext="\displaystyle\nabla^{2}_{{\mathbf{\theta}}}\mathcal{D}(f(\mathbf{X}_{i};{\mathbf{\theta}}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i}))\bigg{\rvert}_{{\mathbf{\theta}}={\mathbf{\theta}}_{i}}" display="inline"><semantics id="A1.E10.m1.1a"><mrow id="A1.E10.m1.1b"><msubsup id="A1.E10.m1.1.2"><mo id="A1.E10.m1.1.2.2.2">∇</mo><mi id="A1.E10.m1.1.2.3">θ</mi><mn id="A1.E10.m1.1.2.2.3">2</mn></msubsup><mi class="ltx_font_mathcaligraphic" id="A1.E10.m1.1.3">𝒟</mi><mrow id="A1.E10.m1.1.4"><mo stretchy="false" id="A1.E10.m1.1.4.1">(</mo><mi id="A1.E10.m1.1.4.2">f</mi><mrow id="A1.E10.m1.1.4.3"><mo stretchy="false" id="A1.E10.m1.1.4.3.1">(</mo><msub id="A1.E10.m1.1.4.3.2"><mi id="A1.E10.m1.1.4.3.2.2">𝐗</mi><mi id="A1.E10.m1.1.4.3.2.3">i</mi></msub><mo id="A1.E10.m1.1.4.3.3">;</mo><mi id="A1.E10.m1.1.1">θ</mi><mo stretchy="false" id="A1.E10.m1.1.4.3.4">)</mo></mrow><mo id="A1.E10.m1.1.4.4">,</mo><mi id="A1.E10.m1.1.4.5">f</mi><mrow id="A1.E10.m1.1.4.6"><mo stretchy="false" id="A1.E10.m1.1.4.6.1">(</mo><msub id="A1.E10.m1.1.4.6.2"><mi id="A1.E10.m1.1.4.6.2.2">𝐗</mi><mi id="A1.E10.m1.1.4.6.2.3">i</mi></msub><mo id="A1.E10.m1.1.4.6.3">;</mo><msub id="A1.E10.m1.1.4.6.4"><mi id="A1.E10.m1.1.4.6.4.2">θ</mi><mi id="A1.E10.m1.1.4.6.4.3">i</mi></msub><mo stretchy="false" id="A1.E10.m1.1.4.6.5">)</mo></mrow><mo stretchy="false" id="A1.E10.m1.1.4.7">)</mo></mrow><mo maxsize="210%" minsize="210%" id="A1.E10.m1.1.5">|</mo><msub id="A1.E10.m1.1.6"><mi id="A1.E10.m1.1.6a"></mi><mrow id="A1.E10.m1.1.6.1"><mi id="A1.E10.m1.1.6.1.2">θ</mi><mo id="A1.E10.m1.1.6.1.1">=</mo><msub id="A1.E10.m1.1.6.1.3"><mi id="A1.E10.m1.1.6.1.3.2">θ</mi><mi id="A1.E10.m1.1.6.1.3.3">i</mi></msub></mrow></msub></mrow><annotation encoding="application/x-tex" id="A1.E10.m1.1c">\displaystyle\nabla^{2}_{{\mathbf{\theta}}}\mathcal{D}(f(\mathbf{X}_{i};{\mathbf{\theta}}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i}))\bigg{\rvert}_{{\mathbf{\theta}}={\mathbf{\theta}}_{i}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.E10.m2.6" class="ltx_Math" alttext="\displaystyle=\big{(}J^{({\mathbf{z}})}_{\theta}\big{)}^{T}\nabla^{2}_{\mathbf{Z}}\mathcal{D}(f(\mathbf{X}_{i};{\mathbf{\theta}}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i}))J^{({\mathbf{z}})}_{\theta}" display="inline"><semantics id="A1.E10.m2.6a"><mrow id="A1.E10.m2.6.6" xref="A1.E10.m2.6.6.cmml"><mi id="A1.E10.m2.6.6.5" xref="A1.E10.m2.6.6.5.cmml"></mi><mo id="A1.E10.m2.6.6.4" xref="A1.E10.m2.6.6.4.cmml">=</mo><mrow id="A1.E10.m2.6.6.3" xref="A1.E10.m2.6.6.3.cmml"><msup id="A1.E10.m2.4.4.1.1" xref="A1.E10.m2.4.4.1.1.cmml"><mrow id="A1.E10.m2.4.4.1.1.1.1" xref="A1.E10.m2.4.4.1.1.1.1.1.cmml"><mo maxsize="120%" minsize="120%" id="A1.E10.m2.4.4.1.1.1.1.2" xref="A1.E10.m2.4.4.1.1.1.1.1.cmml">(</mo><msubsup id="A1.E10.m2.4.4.1.1.1.1.1" xref="A1.E10.m2.4.4.1.1.1.1.1.cmml"><mi id="A1.E10.m2.4.4.1.1.1.1.1.2.2" xref="A1.E10.m2.4.4.1.1.1.1.1.2.2.cmml">J</mi><mi id="A1.E10.m2.4.4.1.1.1.1.1.3" xref="A1.E10.m2.4.4.1.1.1.1.1.3.cmml">θ</mi><mrow id="A1.E10.m2.1.1.1.3" xref="A1.E10.m2.4.4.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.E10.m2.1.1.1.3.1" xref="A1.E10.m2.4.4.1.1.1.1.1.cmml">(</mo><mi id="A1.E10.m2.1.1.1.1" xref="A1.E10.m2.1.1.1.1.cmml">𝐳</mi><mo stretchy="false" id="A1.E10.m2.1.1.1.3.2" xref="A1.E10.m2.4.4.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo maxsize="120%" minsize="120%" id="A1.E10.m2.4.4.1.1.1.1.3" xref="A1.E10.m2.4.4.1.1.1.1.1.cmml">)</mo></mrow><mi id="A1.E10.m2.4.4.1.1.3" xref="A1.E10.m2.4.4.1.1.3.cmml">T</mi></msup><mo lspace="0.167em" rspace="0em" id="A1.E10.m2.6.6.3.4" xref="A1.E10.m2.6.6.3.4.cmml">​</mo><mrow id="A1.E10.m2.6.6.3.5" xref="A1.E10.m2.6.6.3.5.cmml"><msubsup id="A1.E10.m2.6.6.3.5.1" xref="A1.E10.m2.6.6.3.5.1.cmml"><mo rspace="0.167em" id="A1.E10.m2.6.6.3.5.1.2.2" xref="A1.E10.m2.6.6.3.5.1.2.2.cmml">∇</mo><mi id="A1.E10.m2.6.6.3.5.1.3" xref="A1.E10.m2.6.6.3.5.1.3.cmml">𝐙</mi><mn id="A1.E10.m2.6.6.3.5.1.2.3" xref="A1.E10.m2.6.6.3.5.1.2.3.cmml">2</mn></msubsup><mi class="ltx_font_mathcaligraphic" id="A1.E10.m2.6.6.3.5.2" xref="A1.E10.m2.6.6.3.5.2.cmml">𝒟</mi></mrow><mo lspace="0em" rspace="0em" id="A1.E10.m2.6.6.3.4a" xref="A1.E10.m2.6.6.3.4.cmml">​</mo><mrow id="A1.E10.m2.6.6.3.3.2" xref="A1.E10.m2.6.6.3.3.3.cmml"><mo stretchy="false" id="A1.E10.m2.6.6.3.3.2.3" xref="A1.E10.m2.6.6.3.3.3.cmml">(</mo><mrow id="A1.E10.m2.5.5.2.2.1.1" xref="A1.E10.m2.5.5.2.2.1.1.cmml"><mi id="A1.E10.m2.5.5.2.2.1.1.3" xref="A1.E10.m2.5.5.2.2.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.E10.m2.5.5.2.2.1.1.2" xref="A1.E10.m2.5.5.2.2.1.1.2.cmml">​</mo><mrow id="A1.E10.m2.5.5.2.2.1.1.1.1" xref="A1.E10.m2.5.5.2.2.1.1.1.2.cmml"><mo stretchy="false" id="A1.E10.m2.5.5.2.2.1.1.1.1.2" xref="A1.E10.m2.5.5.2.2.1.1.1.2.cmml">(</mo><msub id="A1.E10.m2.5.5.2.2.1.1.1.1.1" xref="A1.E10.m2.5.5.2.2.1.1.1.1.1.cmml"><mi id="A1.E10.m2.5.5.2.2.1.1.1.1.1.2" xref="A1.E10.m2.5.5.2.2.1.1.1.1.1.2.cmml">𝐗</mi><mi id="A1.E10.m2.5.5.2.2.1.1.1.1.1.3" xref="A1.E10.m2.5.5.2.2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E10.m2.5.5.2.2.1.1.1.1.3" xref="A1.E10.m2.5.5.2.2.1.1.1.2.cmml">;</mo><mi id="A1.E10.m2.3.3" xref="A1.E10.m2.3.3.cmml">θ</mi><mo stretchy="false" id="A1.E10.m2.5.5.2.2.1.1.1.1.4" xref="A1.E10.m2.5.5.2.2.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E10.m2.6.6.3.3.2.4" xref="A1.E10.m2.6.6.3.3.3.cmml">,</mo><mrow id="A1.E10.m2.6.6.3.3.2.2" xref="A1.E10.m2.6.6.3.3.2.2.cmml"><mi id="A1.E10.m2.6.6.3.3.2.2.4" xref="A1.E10.m2.6.6.3.3.2.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.E10.m2.6.6.3.3.2.2.3" xref="A1.E10.m2.6.6.3.3.2.2.3.cmml">​</mo><mrow id="A1.E10.m2.6.6.3.3.2.2.2.2" xref="A1.E10.m2.6.6.3.3.2.2.2.3.cmml"><mo stretchy="false" id="A1.E10.m2.6.6.3.3.2.2.2.2.3" xref="A1.E10.m2.6.6.3.3.2.2.2.3.cmml">(</mo><msub id="A1.E10.m2.6.6.3.3.2.2.1.1.1" xref="A1.E10.m2.6.6.3.3.2.2.1.1.1.cmml"><mi id="A1.E10.m2.6.6.3.3.2.2.1.1.1.2" xref="A1.E10.m2.6.6.3.3.2.2.1.1.1.2.cmml">𝐗</mi><mi id="A1.E10.m2.6.6.3.3.2.2.1.1.1.3" xref="A1.E10.m2.6.6.3.3.2.2.1.1.1.3.cmml">i</mi></msub><mo id="A1.E10.m2.6.6.3.3.2.2.2.2.4" xref="A1.E10.m2.6.6.3.3.2.2.2.3.cmml">;</mo><msub id="A1.E10.m2.6.6.3.3.2.2.2.2.2" xref="A1.E10.m2.6.6.3.3.2.2.2.2.2.cmml"><mi id="A1.E10.m2.6.6.3.3.2.2.2.2.2.2" xref="A1.E10.m2.6.6.3.3.2.2.2.2.2.2.cmml">θ</mi><mi id="A1.E10.m2.6.6.3.3.2.2.2.2.2.3" xref="A1.E10.m2.6.6.3.3.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="A1.E10.m2.6.6.3.3.2.2.2.2.5" xref="A1.E10.m2.6.6.3.3.2.2.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.E10.m2.6.6.3.3.2.5" xref="A1.E10.m2.6.6.3.3.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A1.E10.m2.6.6.3.4b" xref="A1.E10.m2.6.6.3.4.cmml">​</mo><msubsup id="A1.E10.m2.6.6.3.6" xref="A1.E10.m2.6.6.3.6.cmml"><mi id="A1.E10.m2.6.6.3.6.2.2" xref="A1.E10.m2.6.6.3.6.2.2.cmml">J</mi><mi id="A1.E10.m2.6.6.3.6.3" xref="A1.E10.m2.6.6.3.6.3.cmml">θ</mi><mrow id="A1.E10.m2.2.2.1.3" xref="A1.E10.m2.6.6.3.6.cmml"><mo stretchy="false" id="A1.E10.m2.2.2.1.3.1" xref="A1.E10.m2.6.6.3.6.cmml">(</mo><mi id="A1.E10.m2.2.2.1.1" xref="A1.E10.m2.2.2.1.1.cmml">𝐳</mi><mo stretchy="false" id="A1.E10.m2.2.2.1.3.2" xref="A1.E10.m2.6.6.3.6.cmml">)</mo></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E10.m2.6b"><apply id="A1.E10.m2.6.6.cmml" xref="A1.E10.m2.6.6"><eq id="A1.E10.m2.6.6.4.cmml" xref="A1.E10.m2.6.6.4"></eq><csymbol cd="latexml" id="A1.E10.m2.6.6.5.cmml" xref="A1.E10.m2.6.6.5">absent</csymbol><apply id="A1.E10.m2.6.6.3.cmml" xref="A1.E10.m2.6.6.3"><times id="A1.E10.m2.6.6.3.4.cmml" xref="A1.E10.m2.6.6.3.4"></times><apply id="A1.E10.m2.4.4.1.1.cmml" xref="A1.E10.m2.4.4.1.1"><csymbol cd="ambiguous" id="A1.E10.m2.4.4.1.1.2.cmml" xref="A1.E10.m2.4.4.1.1">superscript</csymbol><apply id="A1.E10.m2.4.4.1.1.1.1.1.cmml" xref="A1.E10.m2.4.4.1.1.1.1"><csymbol cd="ambiguous" id="A1.E10.m2.4.4.1.1.1.1.1.1.cmml" xref="A1.E10.m2.4.4.1.1.1.1">subscript</csymbol><apply id="A1.E10.m2.4.4.1.1.1.1.1.2.cmml" xref="A1.E10.m2.4.4.1.1.1.1"><csymbol cd="ambiguous" id="A1.E10.m2.4.4.1.1.1.1.1.2.1.cmml" xref="A1.E10.m2.4.4.1.1.1.1">superscript</csymbol><ci id="A1.E10.m2.4.4.1.1.1.1.1.2.2.cmml" xref="A1.E10.m2.4.4.1.1.1.1.1.2.2">𝐽</ci><ci id="A1.E10.m2.1.1.1.1.cmml" xref="A1.E10.m2.1.1.1.1">𝐳</ci></apply><ci id="A1.E10.m2.4.4.1.1.1.1.1.3.cmml" xref="A1.E10.m2.4.4.1.1.1.1.1.3">𝜃</ci></apply><ci id="A1.E10.m2.4.4.1.1.3.cmml" xref="A1.E10.m2.4.4.1.1.3">𝑇</ci></apply><apply id="A1.E10.m2.6.6.3.5.cmml" xref="A1.E10.m2.6.6.3.5"><apply id="A1.E10.m2.6.6.3.5.1.cmml" xref="A1.E10.m2.6.6.3.5.1"><csymbol cd="ambiguous" id="A1.E10.m2.6.6.3.5.1.1.cmml" xref="A1.E10.m2.6.6.3.5.1">subscript</csymbol><apply id="A1.E10.m2.6.6.3.5.1.2.cmml" xref="A1.E10.m2.6.6.3.5.1"><csymbol cd="ambiguous" id="A1.E10.m2.6.6.3.5.1.2.1.cmml" xref="A1.E10.m2.6.6.3.5.1">superscript</csymbol><ci id="A1.E10.m2.6.6.3.5.1.2.2.cmml" xref="A1.E10.m2.6.6.3.5.1.2.2">∇</ci><cn type="integer" id="A1.E10.m2.6.6.3.5.1.2.3.cmml" xref="A1.E10.m2.6.6.3.5.1.2.3">2</cn></apply><ci id="A1.E10.m2.6.6.3.5.1.3.cmml" xref="A1.E10.m2.6.6.3.5.1.3">𝐙</ci></apply><ci id="A1.E10.m2.6.6.3.5.2.cmml" xref="A1.E10.m2.6.6.3.5.2">𝒟</ci></apply><interval closure="open" id="A1.E10.m2.6.6.3.3.3.cmml" xref="A1.E10.m2.6.6.3.3.2"><apply id="A1.E10.m2.5.5.2.2.1.1.cmml" xref="A1.E10.m2.5.5.2.2.1.1"><times id="A1.E10.m2.5.5.2.2.1.1.2.cmml" xref="A1.E10.m2.5.5.2.2.1.1.2"></times><ci id="A1.E10.m2.5.5.2.2.1.1.3.cmml" xref="A1.E10.m2.5.5.2.2.1.1.3">𝑓</ci><list id="A1.E10.m2.5.5.2.2.1.1.1.2.cmml" xref="A1.E10.m2.5.5.2.2.1.1.1.1"><apply id="A1.E10.m2.5.5.2.2.1.1.1.1.1.cmml" xref="A1.E10.m2.5.5.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E10.m2.5.5.2.2.1.1.1.1.1.1.cmml" xref="A1.E10.m2.5.5.2.2.1.1.1.1.1">subscript</csymbol><ci id="A1.E10.m2.5.5.2.2.1.1.1.1.1.2.cmml" xref="A1.E10.m2.5.5.2.2.1.1.1.1.1.2">𝐗</ci><ci id="A1.E10.m2.5.5.2.2.1.1.1.1.1.3.cmml" xref="A1.E10.m2.5.5.2.2.1.1.1.1.1.3">𝑖</ci></apply><ci id="A1.E10.m2.3.3.cmml" xref="A1.E10.m2.3.3">𝜃</ci></list></apply><apply id="A1.E10.m2.6.6.3.3.2.2.cmml" xref="A1.E10.m2.6.6.3.3.2.2"><times id="A1.E10.m2.6.6.3.3.2.2.3.cmml" xref="A1.E10.m2.6.6.3.3.2.2.3"></times><ci id="A1.E10.m2.6.6.3.3.2.2.4.cmml" xref="A1.E10.m2.6.6.3.3.2.2.4">𝑓</ci><list id="A1.E10.m2.6.6.3.3.2.2.2.3.cmml" xref="A1.E10.m2.6.6.3.3.2.2.2.2"><apply id="A1.E10.m2.6.6.3.3.2.2.1.1.1.cmml" xref="A1.E10.m2.6.6.3.3.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E10.m2.6.6.3.3.2.2.1.1.1.1.cmml" xref="A1.E10.m2.6.6.3.3.2.2.1.1.1">subscript</csymbol><ci id="A1.E10.m2.6.6.3.3.2.2.1.1.1.2.cmml" xref="A1.E10.m2.6.6.3.3.2.2.1.1.1.2">𝐗</ci><ci id="A1.E10.m2.6.6.3.3.2.2.1.1.1.3.cmml" xref="A1.E10.m2.6.6.3.3.2.2.1.1.1.3">𝑖</ci></apply><apply id="A1.E10.m2.6.6.3.3.2.2.2.2.2.cmml" xref="A1.E10.m2.6.6.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.E10.m2.6.6.3.3.2.2.2.2.2.1.cmml" xref="A1.E10.m2.6.6.3.3.2.2.2.2.2">subscript</csymbol><ci id="A1.E10.m2.6.6.3.3.2.2.2.2.2.2.cmml" xref="A1.E10.m2.6.6.3.3.2.2.2.2.2.2">𝜃</ci><ci id="A1.E10.m2.6.6.3.3.2.2.2.2.2.3.cmml" xref="A1.E10.m2.6.6.3.3.2.2.2.2.2.3">𝑖</ci></apply></list></apply></interval><apply id="A1.E10.m2.6.6.3.6.cmml" xref="A1.E10.m2.6.6.3.6"><csymbol cd="ambiguous" id="A1.E10.m2.6.6.3.6.1.cmml" xref="A1.E10.m2.6.6.3.6">subscript</csymbol><apply id="A1.E10.m2.6.6.3.6.2.cmml" xref="A1.E10.m2.6.6.3.6"><csymbol cd="ambiguous" id="A1.E10.m2.6.6.3.6.2.1.cmml" xref="A1.E10.m2.6.6.3.6">superscript</csymbol><ci id="A1.E10.m2.6.6.3.6.2.2.cmml" xref="A1.E10.m2.6.6.3.6.2.2">𝐽</ci><ci id="A1.E10.m2.2.2.1.1.cmml" xref="A1.E10.m2.2.2.1.1">𝐳</ci></apply><ci id="A1.E10.m2.6.6.3.6.3.cmml" xref="A1.E10.m2.6.6.3.6.3">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E10.m2.6c">\displaystyle=\big{(}J^{({\mathbf{z}})}_{\theta}\big{)}^{T}\nabla^{2}_{\mathbf{Z}}\mathcal{D}(f(\mathbf{X}_{i};{\mathbf{\theta}}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i}))J^{({\mathbf{z}})}_{\theta}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
<tbody id="A1.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.E11.m2.3" class="ltx_math_unparsed" alttext="\displaystyle\qquad+\nabla_{\mathbf{Z}}\mathcal{D}(f(\mathbf{X}_{i};{\mathbf{\theta}}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i}))^{T}\nabla_{{\mathbf{\theta}}}^{2}f(\mathbf{X},{\mathbf{\theta}})\bigg{\rvert}_{{\mathbf{\theta}}={\mathbf{\theta}}_{i}}." display="inline"><semantics id="A1.E11.m2.3a"><mrow id="A1.E11.m2.3b"><mo id="A1.E11.m2.3.4">+</mo><msub id="A1.E11.m2.3.5"><mo rspace="0.167em" id="A1.E11.m2.3.5.2">∇</mo><mi id="A1.E11.m2.3.5.3">𝐙</mi></msub><mi class="ltx_font_mathcaligraphic" id="A1.E11.m2.3.6">𝒟</mi><msup id="A1.E11.m2.3.7"><mrow id="A1.E11.m2.3.7.2"><mo stretchy="false" id="A1.E11.m2.3.7.2.1">(</mo><mi id="A1.E11.m2.3.7.2.2">f</mi><mrow id="A1.E11.m2.3.7.2.3"><mo stretchy="false" id="A1.E11.m2.3.7.2.3.1">(</mo><msub id="A1.E11.m2.3.7.2.3.2"><mi id="A1.E11.m2.3.7.2.3.2.2">𝐗</mi><mi id="A1.E11.m2.3.7.2.3.2.3">i</mi></msub><mo id="A1.E11.m2.3.7.2.3.3">;</mo><mi id="A1.E11.m2.1.1">θ</mi><mo stretchy="false" id="A1.E11.m2.3.7.2.3.4">)</mo></mrow><mo id="A1.E11.m2.3.7.2.4">,</mo><mi id="A1.E11.m2.3.7.2.5">f</mi><mrow id="A1.E11.m2.3.7.2.6"><mo stretchy="false" id="A1.E11.m2.3.7.2.6.1">(</mo><msub id="A1.E11.m2.3.7.2.6.2"><mi id="A1.E11.m2.3.7.2.6.2.2">𝐗</mi><mi id="A1.E11.m2.3.7.2.6.2.3">i</mi></msub><mo id="A1.E11.m2.3.7.2.6.3">;</mo><msub id="A1.E11.m2.3.7.2.6.4"><mi id="A1.E11.m2.3.7.2.6.4.2">θ</mi><mi id="A1.E11.m2.3.7.2.6.4.3">i</mi></msub><mo stretchy="false" id="A1.E11.m2.3.7.2.6.5">)</mo></mrow><mo rspace="0.167em" stretchy="false" id="A1.E11.m2.3.7.2.7">)</mo></mrow><mi id="A1.E11.m2.3.7.3">T</mi></msup><msubsup id="A1.E11.m2.3.8"><mo rspace="0.167em" id="A1.E11.m2.3.8.2.2">∇</mo><mi id="A1.E11.m2.3.8.2.3">θ</mi><mn id="A1.E11.m2.3.8.3">2</mn></msubsup><mi id="A1.E11.m2.3.9">f</mi><mrow id="A1.E11.m2.3.10"><mo stretchy="false" id="A1.E11.m2.3.10.1">(</mo><mi id="A1.E11.m2.2.2">𝐗</mi><mo id="A1.E11.m2.3.10.2">,</mo><mi id="A1.E11.m2.3.3">θ</mi><mo stretchy="false" id="A1.E11.m2.3.10.3">)</mo></mrow><mo maxsize="210%" minsize="210%" id="A1.E11.m2.3.11">|</mo><msub id="A1.E11.m2.3.12"><mi id="A1.E11.m2.3.12a"></mi><mrow id="A1.E11.m2.3.12.1"><mi id="A1.E11.m2.3.12.1.2">θ</mi><mo id="A1.E11.m2.3.12.1.1">=</mo><msub id="A1.E11.m2.3.12.1.3"><mi id="A1.E11.m2.3.12.1.3.2">θ</mi><mi id="A1.E11.m2.3.12.1.3.3">i</mi></msub></mrow></msub><mo lspace="0em" id="A1.E11.m2.3.13">.</mo></mrow><annotation encoding="application/x-tex" id="A1.E11.m2.3c">\displaystyle\qquad+\nabla_{\mathbf{Z}}\mathcal{D}(f(\mathbf{X}_{i};{\mathbf{\theta}}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i}))^{T}\nabla_{{\mathbf{\theta}}}^{2}f(\mathbf{X},{\mathbf{\theta}})\bigg{\rvert}_{{\mathbf{\theta}}={\mathbf{\theta}}_{i}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="A1.SS2.p6.2" class="ltx_p">Again, the second term in <a href="#A1.E11" title="In A.2 FedFish Derivation ‣ Appendix A Appendix ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">11</span></a> vanishes as <math id="A1.SS2.p6.1.m1.3" class="ltx_Math" alttext="\nabla_{\mathbf{Z}}\mathcal{D}(f(\mathbf{X}_{i};{\mathbf{\theta}}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i}))=0" display="inline"><semantics id="A1.SS2.p6.1.m1.3a"><mrow id="A1.SS2.p6.1.m1.3.3" xref="A1.SS2.p6.1.m1.3.3.cmml"><mrow id="A1.SS2.p6.1.m1.3.3.2" xref="A1.SS2.p6.1.m1.3.3.2.cmml"><mrow id="A1.SS2.p6.1.m1.3.3.2.4" xref="A1.SS2.p6.1.m1.3.3.2.4.cmml"><msub id="A1.SS2.p6.1.m1.3.3.2.4.1" xref="A1.SS2.p6.1.m1.3.3.2.4.1.cmml"><mo id="A1.SS2.p6.1.m1.3.3.2.4.1.2" xref="A1.SS2.p6.1.m1.3.3.2.4.1.2.cmml">∇</mo><mi id="A1.SS2.p6.1.m1.3.3.2.4.1.3" xref="A1.SS2.p6.1.m1.3.3.2.4.1.3.cmml">𝐙</mi></msub><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p6.1.m1.3.3.2.4.2" xref="A1.SS2.p6.1.m1.3.3.2.4.2.cmml">𝒟</mi></mrow><mo lspace="0em" rspace="0em" id="A1.SS2.p6.1.m1.3.3.2.3" xref="A1.SS2.p6.1.m1.3.3.2.3.cmml">​</mo><mrow id="A1.SS2.p6.1.m1.3.3.2.2.2" xref="A1.SS2.p6.1.m1.3.3.2.2.3.cmml"><mo stretchy="false" id="A1.SS2.p6.1.m1.3.3.2.2.2.3" xref="A1.SS2.p6.1.m1.3.3.2.2.3.cmml">(</mo><mrow id="A1.SS2.p6.1.m1.2.2.1.1.1.1" xref="A1.SS2.p6.1.m1.2.2.1.1.1.1.cmml"><mi id="A1.SS2.p6.1.m1.2.2.1.1.1.1.3" xref="A1.SS2.p6.1.m1.2.2.1.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p6.1.m1.2.2.1.1.1.1.2" xref="A1.SS2.p6.1.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="A1.SS2.p6.1.m1.2.2.1.1.1.1.1.1" xref="A1.SS2.p6.1.m1.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.SS2.p6.1.m1.2.2.1.1.1.1.1.1.2" xref="A1.SS2.p6.1.m1.2.2.1.1.1.1.1.2.cmml">(</mo><msub id="A1.SS2.p6.1.m1.2.2.1.1.1.1.1.1.1" xref="A1.SS2.p6.1.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="A1.SS2.p6.1.m1.2.2.1.1.1.1.1.1.1.2" xref="A1.SS2.p6.1.m1.2.2.1.1.1.1.1.1.1.2.cmml">𝐗</mi><mi id="A1.SS2.p6.1.m1.2.2.1.1.1.1.1.1.1.3" xref="A1.SS2.p6.1.m1.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS2.p6.1.m1.2.2.1.1.1.1.1.1.3" xref="A1.SS2.p6.1.m1.2.2.1.1.1.1.1.2.cmml">;</mo><mi id="A1.SS2.p6.1.m1.1.1" xref="A1.SS2.p6.1.m1.1.1.cmml">θ</mi><mo stretchy="false" id="A1.SS2.p6.1.m1.2.2.1.1.1.1.1.1.4" xref="A1.SS2.p6.1.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.SS2.p6.1.m1.3.3.2.2.2.4" xref="A1.SS2.p6.1.m1.3.3.2.2.3.cmml">,</mo><mrow id="A1.SS2.p6.1.m1.3.3.2.2.2.2" xref="A1.SS2.p6.1.m1.3.3.2.2.2.2.cmml"><mi id="A1.SS2.p6.1.m1.3.3.2.2.2.2.4" xref="A1.SS2.p6.1.m1.3.3.2.2.2.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p6.1.m1.3.3.2.2.2.2.3" xref="A1.SS2.p6.1.m1.3.3.2.2.2.2.3.cmml">​</mo><mrow id="A1.SS2.p6.1.m1.3.3.2.2.2.2.2.2" xref="A1.SS2.p6.1.m1.3.3.2.2.2.2.2.3.cmml"><mo stretchy="false" id="A1.SS2.p6.1.m1.3.3.2.2.2.2.2.2.3" xref="A1.SS2.p6.1.m1.3.3.2.2.2.2.2.3.cmml">(</mo><msub id="A1.SS2.p6.1.m1.3.3.2.2.2.2.1.1.1" xref="A1.SS2.p6.1.m1.3.3.2.2.2.2.1.1.1.cmml"><mi id="A1.SS2.p6.1.m1.3.3.2.2.2.2.1.1.1.2" xref="A1.SS2.p6.1.m1.3.3.2.2.2.2.1.1.1.2.cmml">𝐗</mi><mi id="A1.SS2.p6.1.m1.3.3.2.2.2.2.1.1.1.3" xref="A1.SS2.p6.1.m1.3.3.2.2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS2.p6.1.m1.3.3.2.2.2.2.2.2.4" xref="A1.SS2.p6.1.m1.3.3.2.2.2.2.2.3.cmml">;</mo><msub id="A1.SS2.p6.1.m1.3.3.2.2.2.2.2.2.2" xref="A1.SS2.p6.1.m1.3.3.2.2.2.2.2.2.2.cmml"><mi id="A1.SS2.p6.1.m1.3.3.2.2.2.2.2.2.2.2" xref="A1.SS2.p6.1.m1.3.3.2.2.2.2.2.2.2.2.cmml">θ</mi><mi id="A1.SS2.p6.1.m1.3.3.2.2.2.2.2.2.2.3" xref="A1.SS2.p6.1.m1.3.3.2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="A1.SS2.p6.1.m1.3.3.2.2.2.2.2.2.5" xref="A1.SS2.p6.1.m1.3.3.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.SS2.p6.1.m1.3.3.2.2.2.5" xref="A1.SS2.p6.1.m1.3.3.2.2.3.cmml">)</mo></mrow></mrow><mo id="A1.SS2.p6.1.m1.3.3.3" xref="A1.SS2.p6.1.m1.3.3.3.cmml">=</mo><mn id="A1.SS2.p6.1.m1.3.3.4" xref="A1.SS2.p6.1.m1.3.3.4.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p6.1.m1.3b"><apply id="A1.SS2.p6.1.m1.3.3.cmml" xref="A1.SS2.p6.1.m1.3.3"><eq id="A1.SS2.p6.1.m1.3.3.3.cmml" xref="A1.SS2.p6.1.m1.3.3.3"></eq><apply id="A1.SS2.p6.1.m1.3.3.2.cmml" xref="A1.SS2.p6.1.m1.3.3.2"><times id="A1.SS2.p6.1.m1.3.3.2.3.cmml" xref="A1.SS2.p6.1.m1.3.3.2.3"></times><apply id="A1.SS2.p6.1.m1.3.3.2.4.cmml" xref="A1.SS2.p6.1.m1.3.3.2.4"><apply id="A1.SS2.p6.1.m1.3.3.2.4.1.cmml" xref="A1.SS2.p6.1.m1.3.3.2.4.1"><csymbol cd="ambiguous" id="A1.SS2.p6.1.m1.3.3.2.4.1.1.cmml" xref="A1.SS2.p6.1.m1.3.3.2.4.1">subscript</csymbol><ci id="A1.SS2.p6.1.m1.3.3.2.4.1.2.cmml" xref="A1.SS2.p6.1.m1.3.3.2.4.1.2">∇</ci><ci id="A1.SS2.p6.1.m1.3.3.2.4.1.3.cmml" xref="A1.SS2.p6.1.m1.3.3.2.4.1.3">𝐙</ci></apply><ci id="A1.SS2.p6.1.m1.3.3.2.4.2.cmml" xref="A1.SS2.p6.1.m1.3.3.2.4.2">𝒟</ci></apply><interval closure="open" id="A1.SS2.p6.1.m1.3.3.2.2.3.cmml" xref="A1.SS2.p6.1.m1.3.3.2.2.2"><apply id="A1.SS2.p6.1.m1.2.2.1.1.1.1.cmml" xref="A1.SS2.p6.1.m1.2.2.1.1.1.1"><times id="A1.SS2.p6.1.m1.2.2.1.1.1.1.2.cmml" xref="A1.SS2.p6.1.m1.2.2.1.1.1.1.2"></times><ci id="A1.SS2.p6.1.m1.2.2.1.1.1.1.3.cmml" xref="A1.SS2.p6.1.m1.2.2.1.1.1.1.3">𝑓</ci><list id="A1.SS2.p6.1.m1.2.2.1.1.1.1.1.2.cmml" xref="A1.SS2.p6.1.m1.2.2.1.1.1.1.1.1"><apply id="A1.SS2.p6.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p6.1.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p6.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p6.1.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p6.1.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="A1.SS2.p6.1.m1.2.2.1.1.1.1.1.1.1.2">𝐗</ci><ci id="A1.SS2.p6.1.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="A1.SS2.p6.1.m1.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="A1.SS2.p6.1.m1.1.1.cmml" xref="A1.SS2.p6.1.m1.1.1">𝜃</ci></list></apply><apply id="A1.SS2.p6.1.m1.3.3.2.2.2.2.cmml" xref="A1.SS2.p6.1.m1.3.3.2.2.2.2"><times id="A1.SS2.p6.1.m1.3.3.2.2.2.2.3.cmml" xref="A1.SS2.p6.1.m1.3.3.2.2.2.2.3"></times><ci id="A1.SS2.p6.1.m1.3.3.2.2.2.2.4.cmml" xref="A1.SS2.p6.1.m1.3.3.2.2.2.2.4">𝑓</ci><list id="A1.SS2.p6.1.m1.3.3.2.2.2.2.2.3.cmml" xref="A1.SS2.p6.1.m1.3.3.2.2.2.2.2.2"><apply id="A1.SS2.p6.1.m1.3.3.2.2.2.2.1.1.1.cmml" xref="A1.SS2.p6.1.m1.3.3.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p6.1.m1.3.3.2.2.2.2.1.1.1.1.cmml" xref="A1.SS2.p6.1.m1.3.3.2.2.2.2.1.1.1">subscript</csymbol><ci id="A1.SS2.p6.1.m1.3.3.2.2.2.2.1.1.1.2.cmml" xref="A1.SS2.p6.1.m1.3.3.2.2.2.2.1.1.1.2">𝐗</ci><ci id="A1.SS2.p6.1.m1.3.3.2.2.2.2.1.1.1.3.cmml" xref="A1.SS2.p6.1.m1.3.3.2.2.2.2.1.1.1.3">𝑖</ci></apply><apply id="A1.SS2.p6.1.m1.3.3.2.2.2.2.2.2.2.cmml" xref="A1.SS2.p6.1.m1.3.3.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS2.p6.1.m1.3.3.2.2.2.2.2.2.2.1.cmml" xref="A1.SS2.p6.1.m1.3.3.2.2.2.2.2.2.2">subscript</csymbol><ci id="A1.SS2.p6.1.m1.3.3.2.2.2.2.2.2.2.2.cmml" xref="A1.SS2.p6.1.m1.3.3.2.2.2.2.2.2.2.2">𝜃</ci><ci id="A1.SS2.p6.1.m1.3.3.2.2.2.2.2.2.2.3.cmml" xref="A1.SS2.p6.1.m1.3.3.2.2.2.2.2.2.2.3">𝑖</ci></apply></list></apply></interval></apply><cn type="integer" id="A1.SS2.p6.1.m1.3.3.4.cmml" xref="A1.SS2.p6.1.m1.3.3.4">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p6.1.m1.3c">\nabla_{\mathbf{Z}}\mathcal{D}(f(\mathbf{X}_{i};{\mathbf{\theta}}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i}))=0</annotation></semantics></math> when evaluated at <math id="A1.SS2.p6.2.m2.1" class="ltx_Math" alttext="{\mathbf{\theta}}={\mathbf{\theta}}_{i}" display="inline"><semantics id="A1.SS2.p6.2.m2.1a"><mrow id="A1.SS2.p6.2.m2.1.1" xref="A1.SS2.p6.2.m2.1.1.cmml"><mi id="A1.SS2.p6.2.m2.1.1.2" xref="A1.SS2.p6.2.m2.1.1.2.cmml">θ</mi><mo id="A1.SS2.p6.2.m2.1.1.1" xref="A1.SS2.p6.2.m2.1.1.1.cmml">=</mo><msub id="A1.SS2.p6.2.m2.1.1.3" xref="A1.SS2.p6.2.m2.1.1.3.cmml"><mi id="A1.SS2.p6.2.m2.1.1.3.2" xref="A1.SS2.p6.2.m2.1.1.3.2.cmml">θ</mi><mi id="A1.SS2.p6.2.m2.1.1.3.3" xref="A1.SS2.p6.2.m2.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p6.2.m2.1b"><apply id="A1.SS2.p6.2.m2.1.1.cmml" xref="A1.SS2.p6.2.m2.1.1"><eq id="A1.SS2.p6.2.m2.1.1.1.cmml" xref="A1.SS2.p6.2.m2.1.1.1"></eq><ci id="A1.SS2.p6.2.m2.1.1.2.cmml" xref="A1.SS2.p6.2.m2.1.1.2">𝜃</ci><apply id="A1.SS2.p6.2.m2.1.1.3.cmml" xref="A1.SS2.p6.2.m2.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p6.2.m2.1.1.3.1.cmml" xref="A1.SS2.p6.2.m2.1.1.3">subscript</csymbol><ci id="A1.SS2.p6.2.m2.1.1.3.2.cmml" xref="A1.SS2.p6.2.m2.1.1.3.2">𝜃</ci><ci id="A1.SS2.p6.2.m2.1.1.3.3.cmml" xref="A1.SS2.p6.2.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p6.2.m2.1c">{\mathbf{\theta}}={\mathbf{\theta}}_{i}</annotation></semantics></math>.</p>
</div>
<div id="A1.SS2.p7" class="ltx_para ltx_noindent">
<p id="A1.SS2.p7.7" class="ltx_p">Since we consider models that are trained with cross-entropy loss, a natural measure of difference between outputs of two models is the KL divergence.
In this case, <math id="A1.SS2.p7.1.m1.3" class="ltx_Math" alttext="\nabla^{2}_{\mathbf{Z}}\mathcal{D}_{\text{KL}}(f(\mathbf{X}_{i};{\mathbf{\theta}}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i}))" display="inline"><semantics id="A1.SS2.p7.1.m1.3a"><mrow id="A1.SS2.p7.1.m1.3.3" xref="A1.SS2.p7.1.m1.3.3.cmml"><mrow id="A1.SS2.p7.1.m1.3.3.4" xref="A1.SS2.p7.1.m1.3.3.4.cmml"><msubsup id="A1.SS2.p7.1.m1.3.3.4.1" xref="A1.SS2.p7.1.m1.3.3.4.1.cmml"><mo id="A1.SS2.p7.1.m1.3.3.4.1.2.2" xref="A1.SS2.p7.1.m1.3.3.4.1.2.2.cmml">∇</mo><mi id="A1.SS2.p7.1.m1.3.3.4.1.3" xref="A1.SS2.p7.1.m1.3.3.4.1.3.cmml">𝐙</mi><mn id="A1.SS2.p7.1.m1.3.3.4.1.2.3" xref="A1.SS2.p7.1.m1.3.3.4.1.2.3.cmml">2</mn></msubsup><msub id="A1.SS2.p7.1.m1.3.3.4.2" xref="A1.SS2.p7.1.m1.3.3.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p7.1.m1.3.3.4.2.2" xref="A1.SS2.p7.1.m1.3.3.4.2.2.cmml">𝒟</mi><mtext id="A1.SS2.p7.1.m1.3.3.4.2.3" xref="A1.SS2.p7.1.m1.3.3.4.2.3a.cmml">KL</mtext></msub></mrow><mo lspace="0em" rspace="0em" id="A1.SS2.p7.1.m1.3.3.3" xref="A1.SS2.p7.1.m1.3.3.3.cmml">​</mo><mrow id="A1.SS2.p7.1.m1.3.3.2.2" xref="A1.SS2.p7.1.m1.3.3.2.3.cmml"><mo stretchy="false" id="A1.SS2.p7.1.m1.3.3.2.2.3" xref="A1.SS2.p7.1.m1.3.3.2.3.cmml">(</mo><mrow id="A1.SS2.p7.1.m1.2.2.1.1.1" xref="A1.SS2.p7.1.m1.2.2.1.1.1.cmml"><mi id="A1.SS2.p7.1.m1.2.2.1.1.1.3" xref="A1.SS2.p7.1.m1.2.2.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p7.1.m1.2.2.1.1.1.2" xref="A1.SS2.p7.1.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="A1.SS2.p7.1.m1.2.2.1.1.1.1.1" xref="A1.SS2.p7.1.m1.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.SS2.p7.1.m1.2.2.1.1.1.1.1.2" xref="A1.SS2.p7.1.m1.2.2.1.1.1.1.2.cmml">(</mo><msub id="A1.SS2.p7.1.m1.2.2.1.1.1.1.1.1" xref="A1.SS2.p7.1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="A1.SS2.p7.1.m1.2.2.1.1.1.1.1.1.2" xref="A1.SS2.p7.1.m1.2.2.1.1.1.1.1.1.2.cmml">𝐗</mi><mi id="A1.SS2.p7.1.m1.2.2.1.1.1.1.1.1.3" xref="A1.SS2.p7.1.m1.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS2.p7.1.m1.2.2.1.1.1.1.1.3" xref="A1.SS2.p7.1.m1.2.2.1.1.1.1.2.cmml">;</mo><mi id="A1.SS2.p7.1.m1.1.1" xref="A1.SS2.p7.1.m1.1.1.cmml">θ</mi><mo stretchy="false" id="A1.SS2.p7.1.m1.2.2.1.1.1.1.1.4" xref="A1.SS2.p7.1.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.SS2.p7.1.m1.3.3.2.2.4" xref="A1.SS2.p7.1.m1.3.3.2.3.cmml">,</mo><mrow id="A1.SS2.p7.1.m1.3.3.2.2.2" xref="A1.SS2.p7.1.m1.3.3.2.2.2.cmml"><mi id="A1.SS2.p7.1.m1.3.3.2.2.2.4" xref="A1.SS2.p7.1.m1.3.3.2.2.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p7.1.m1.3.3.2.2.2.3" xref="A1.SS2.p7.1.m1.3.3.2.2.2.3.cmml">​</mo><mrow id="A1.SS2.p7.1.m1.3.3.2.2.2.2.2" xref="A1.SS2.p7.1.m1.3.3.2.2.2.2.3.cmml"><mo stretchy="false" id="A1.SS2.p7.1.m1.3.3.2.2.2.2.2.3" xref="A1.SS2.p7.1.m1.3.3.2.2.2.2.3.cmml">(</mo><msub id="A1.SS2.p7.1.m1.3.3.2.2.2.1.1.1" xref="A1.SS2.p7.1.m1.3.3.2.2.2.1.1.1.cmml"><mi id="A1.SS2.p7.1.m1.3.3.2.2.2.1.1.1.2" xref="A1.SS2.p7.1.m1.3.3.2.2.2.1.1.1.2.cmml">𝐗</mi><mi id="A1.SS2.p7.1.m1.3.3.2.2.2.1.1.1.3" xref="A1.SS2.p7.1.m1.3.3.2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS2.p7.1.m1.3.3.2.2.2.2.2.4" xref="A1.SS2.p7.1.m1.3.3.2.2.2.2.3.cmml">;</mo><msub id="A1.SS2.p7.1.m1.3.3.2.2.2.2.2.2" xref="A1.SS2.p7.1.m1.3.3.2.2.2.2.2.2.cmml"><mi id="A1.SS2.p7.1.m1.3.3.2.2.2.2.2.2.2" xref="A1.SS2.p7.1.m1.3.3.2.2.2.2.2.2.2.cmml">θ</mi><mi id="A1.SS2.p7.1.m1.3.3.2.2.2.2.2.2.3" xref="A1.SS2.p7.1.m1.3.3.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="A1.SS2.p7.1.m1.3.3.2.2.2.2.2.5" xref="A1.SS2.p7.1.m1.3.3.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.SS2.p7.1.m1.3.3.2.2.5" xref="A1.SS2.p7.1.m1.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p7.1.m1.3b"><apply id="A1.SS2.p7.1.m1.3.3.cmml" xref="A1.SS2.p7.1.m1.3.3"><times id="A1.SS2.p7.1.m1.3.3.3.cmml" xref="A1.SS2.p7.1.m1.3.3.3"></times><apply id="A1.SS2.p7.1.m1.3.3.4.cmml" xref="A1.SS2.p7.1.m1.3.3.4"><apply id="A1.SS2.p7.1.m1.3.3.4.1.cmml" xref="A1.SS2.p7.1.m1.3.3.4.1"><csymbol cd="ambiguous" id="A1.SS2.p7.1.m1.3.3.4.1.1.cmml" xref="A1.SS2.p7.1.m1.3.3.4.1">subscript</csymbol><apply id="A1.SS2.p7.1.m1.3.3.4.1.2.cmml" xref="A1.SS2.p7.1.m1.3.3.4.1"><csymbol cd="ambiguous" id="A1.SS2.p7.1.m1.3.3.4.1.2.1.cmml" xref="A1.SS2.p7.1.m1.3.3.4.1">superscript</csymbol><ci id="A1.SS2.p7.1.m1.3.3.4.1.2.2.cmml" xref="A1.SS2.p7.1.m1.3.3.4.1.2.2">∇</ci><cn type="integer" id="A1.SS2.p7.1.m1.3.3.4.1.2.3.cmml" xref="A1.SS2.p7.1.m1.3.3.4.1.2.3">2</cn></apply><ci id="A1.SS2.p7.1.m1.3.3.4.1.3.cmml" xref="A1.SS2.p7.1.m1.3.3.4.1.3">𝐙</ci></apply><apply id="A1.SS2.p7.1.m1.3.3.4.2.cmml" xref="A1.SS2.p7.1.m1.3.3.4.2"><csymbol cd="ambiguous" id="A1.SS2.p7.1.m1.3.3.4.2.1.cmml" xref="A1.SS2.p7.1.m1.3.3.4.2">subscript</csymbol><ci id="A1.SS2.p7.1.m1.3.3.4.2.2.cmml" xref="A1.SS2.p7.1.m1.3.3.4.2.2">𝒟</ci><ci id="A1.SS2.p7.1.m1.3.3.4.2.3a.cmml" xref="A1.SS2.p7.1.m1.3.3.4.2.3"><mtext mathsize="70%" id="A1.SS2.p7.1.m1.3.3.4.2.3.cmml" xref="A1.SS2.p7.1.m1.3.3.4.2.3">KL</mtext></ci></apply></apply><interval closure="open" id="A1.SS2.p7.1.m1.3.3.2.3.cmml" xref="A1.SS2.p7.1.m1.3.3.2.2"><apply id="A1.SS2.p7.1.m1.2.2.1.1.1.cmml" xref="A1.SS2.p7.1.m1.2.2.1.1.1"><times id="A1.SS2.p7.1.m1.2.2.1.1.1.2.cmml" xref="A1.SS2.p7.1.m1.2.2.1.1.1.2"></times><ci id="A1.SS2.p7.1.m1.2.2.1.1.1.3.cmml" xref="A1.SS2.p7.1.m1.2.2.1.1.1.3">𝑓</ci><list id="A1.SS2.p7.1.m1.2.2.1.1.1.1.2.cmml" xref="A1.SS2.p7.1.m1.2.2.1.1.1.1.1"><apply id="A1.SS2.p7.1.m1.2.2.1.1.1.1.1.1.cmml" xref="A1.SS2.p7.1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p7.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p7.1.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p7.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A1.SS2.p7.1.m1.2.2.1.1.1.1.1.1.2">𝐗</ci><ci id="A1.SS2.p7.1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A1.SS2.p7.1.m1.2.2.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="A1.SS2.p7.1.m1.1.1.cmml" xref="A1.SS2.p7.1.m1.1.1">𝜃</ci></list></apply><apply id="A1.SS2.p7.1.m1.3.3.2.2.2.cmml" xref="A1.SS2.p7.1.m1.3.3.2.2.2"><times id="A1.SS2.p7.1.m1.3.3.2.2.2.3.cmml" xref="A1.SS2.p7.1.m1.3.3.2.2.2.3"></times><ci id="A1.SS2.p7.1.m1.3.3.2.2.2.4.cmml" xref="A1.SS2.p7.1.m1.3.3.2.2.2.4">𝑓</ci><list id="A1.SS2.p7.1.m1.3.3.2.2.2.2.3.cmml" xref="A1.SS2.p7.1.m1.3.3.2.2.2.2.2"><apply id="A1.SS2.p7.1.m1.3.3.2.2.2.1.1.1.cmml" xref="A1.SS2.p7.1.m1.3.3.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p7.1.m1.3.3.2.2.2.1.1.1.1.cmml" xref="A1.SS2.p7.1.m1.3.3.2.2.2.1.1.1">subscript</csymbol><ci id="A1.SS2.p7.1.m1.3.3.2.2.2.1.1.1.2.cmml" xref="A1.SS2.p7.1.m1.3.3.2.2.2.1.1.1.2">𝐗</ci><ci id="A1.SS2.p7.1.m1.3.3.2.2.2.1.1.1.3.cmml" xref="A1.SS2.p7.1.m1.3.3.2.2.2.1.1.1.3">𝑖</ci></apply><apply id="A1.SS2.p7.1.m1.3.3.2.2.2.2.2.2.cmml" xref="A1.SS2.p7.1.m1.3.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS2.p7.1.m1.3.3.2.2.2.2.2.2.1.cmml" xref="A1.SS2.p7.1.m1.3.3.2.2.2.2.2.2">subscript</csymbol><ci id="A1.SS2.p7.1.m1.3.3.2.2.2.2.2.2.2.cmml" xref="A1.SS2.p7.1.m1.3.3.2.2.2.2.2.2.2">𝜃</ci><ci id="A1.SS2.p7.1.m1.3.3.2.2.2.2.2.2.3.cmml" xref="A1.SS2.p7.1.m1.3.3.2.2.2.2.2.2.3">𝑖</ci></apply></list></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p7.1.m1.3c">\nabla^{2}_{\mathbf{Z}}\mathcal{D}_{\text{KL}}(f(\mathbf{X}_{i};{\mathbf{\theta}}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i}))</annotation></semantics></math> is the Fisher Information matrix for outputs, <math id="A1.SS2.p7.2.m2.1" class="ltx_Math" alttext="F_{\mathbf{Z}}" display="inline"><semantics id="A1.SS2.p7.2.m2.1a"><msub id="A1.SS2.p7.2.m2.1.1" xref="A1.SS2.p7.2.m2.1.1.cmml"><mi id="A1.SS2.p7.2.m2.1.1.2" xref="A1.SS2.p7.2.m2.1.1.2.cmml">F</mi><mi id="A1.SS2.p7.2.m2.1.1.3" xref="A1.SS2.p7.2.m2.1.1.3.cmml">𝐙</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p7.2.m2.1b"><apply id="A1.SS2.p7.2.m2.1.1.cmml" xref="A1.SS2.p7.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p7.2.m2.1.1.1.cmml" xref="A1.SS2.p7.2.m2.1.1">subscript</csymbol><ci id="A1.SS2.p7.2.m2.1.1.2.cmml" xref="A1.SS2.p7.2.m2.1.1.2">𝐹</ci><ci id="A1.SS2.p7.2.m2.1.1.3.cmml" xref="A1.SS2.p7.2.m2.1.1.3">𝐙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p7.2.m2.1c">F_{\mathbf{Z}}</annotation></semantics></math>.
Via chain rule, the first term above <math id="A1.SS2.p7.3.m3.3" class="ltx_Math" alttext="\left(J^{({\mathbf{z}})}_{\theta}\right)^{T}F_{\mathbf{Z}}J^{({\mathbf{z}})}_{\theta}=F_{{\mathbf{\theta}}}" display="inline"><semantics id="A1.SS2.p7.3.m3.3a"><mrow id="A1.SS2.p7.3.m3.3.3" xref="A1.SS2.p7.3.m3.3.3.cmml"><mrow id="A1.SS2.p7.3.m3.3.3.1" xref="A1.SS2.p7.3.m3.3.3.1.cmml"><msup id="A1.SS2.p7.3.m3.3.3.1.1" xref="A1.SS2.p7.3.m3.3.3.1.1.cmml"><mrow id="A1.SS2.p7.3.m3.3.3.1.1.1.1" xref="A1.SS2.p7.3.m3.3.3.1.1.1.1.1.cmml"><mo id="A1.SS2.p7.3.m3.3.3.1.1.1.1.2" xref="A1.SS2.p7.3.m3.3.3.1.1.1.1.1.cmml">(</mo><msubsup id="A1.SS2.p7.3.m3.3.3.1.1.1.1.1" xref="A1.SS2.p7.3.m3.3.3.1.1.1.1.1.cmml"><mi id="A1.SS2.p7.3.m3.3.3.1.1.1.1.1.2.2" xref="A1.SS2.p7.3.m3.3.3.1.1.1.1.1.2.2.cmml">J</mi><mi id="A1.SS2.p7.3.m3.3.3.1.1.1.1.1.3" xref="A1.SS2.p7.3.m3.3.3.1.1.1.1.1.3.cmml">θ</mi><mrow id="A1.SS2.p7.3.m3.1.1.1.3" xref="A1.SS2.p7.3.m3.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.SS2.p7.3.m3.1.1.1.3.1" xref="A1.SS2.p7.3.m3.3.3.1.1.1.1.1.cmml">(</mo><mi id="A1.SS2.p7.3.m3.1.1.1.1" xref="A1.SS2.p7.3.m3.1.1.1.1.cmml">𝐳</mi><mo stretchy="false" id="A1.SS2.p7.3.m3.1.1.1.3.2" xref="A1.SS2.p7.3.m3.3.3.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.SS2.p7.3.m3.3.3.1.1.1.1.3" xref="A1.SS2.p7.3.m3.3.3.1.1.1.1.1.cmml">)</mo></mrow><mi id="A1.SS2.p7.3.m3.3.3.1.1.3" xref="A1.SS2.p7.3.m3.3.3.1.1.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="A1.SS2.p7.3.m3.3.3.1.2" xref="A1.SS2.p7.3.m3.3.3.1.2.cmml">​</mo><msub id="A1.SS2.p7.3.m3.3.3.1.3" xref="A1.SS2.p7.3.m3.3.3.1.3.cmml"><mi id="A1.SS2.p7.3.m3.3.3.1.3.2" xref="A1.SS2.p7.3.m3.3.3.1.3.2.cmml">F</mi><mi id="A1.SS2.p7.3.m3.3.3.1.3.3" xref="A1.SS2.p7.3.m3.3.3.1.3.3.cmml">𝐙</mi></msub><mo lspace="0em" rspace="0em" id="A1.SS2.p7.3.m3.3.3.1.2a" xref="A1.SS2.p7.3.m3.3.3.1.2.cmml">​</mo><msubsup id="A1.SS2.p7.3.m3.3.3.1.4" xref="A1.SS2.p7.3.m3.3.3.1.4.cmml"><mi id="A1.SS2.p7.3.m3.3.3.1.4.2.2" xref="A1.SS2.p7.3.m3.3.3.1.4.2.2.cmml">J</mi><mi id="A1.SS2.p7.3.m3.3.3.1.4.3" xref="A1.SS2.p7.3.m3.3.3.1.4.3.cmml">θ</mi><mrow id="A1.SS2.p7.3.m3.2.2.1.3" xref="A1.SS2.p7.3.m3.3.3.1.4.cmml"><mo stretchy="false" id="A1.SS2.p7.3.m3.2.2.1.3.1" xref="A1.SS2.p7.3.m3.3.3.1.4.cmml">(</mo><mi id="A1.SS2.p7.3.m3.2.2.1.1" xref="A1.SS2.p7.3.m3.2.2.1.1.cmml">𝐳</mi><mo stretchy="false" id="A1.SS2.p7.3.m3.2.2.1.3.2" xref="A1.SS2.p7.3.m3.3.3.1.4.cmml">)</mo></mrow></msubsup></mrow><mo id="A1.SS2.p7.3.m3.3.3.2" xref="A1.SS2.p7.3.m3.3.3.2.cmml">=</mo><msub id="A1.SS2.p7.3.m3.3.3.3" xref="A1.SS2.p7.3.m3.3.3.3.cmml"><mi id="A1.SS2.p7.3.m3.3.3.3.2" xref="A1.SS2.p7.3.m3.3.3.3.2.cmml">F</mi><mi id="A1.SS2.p7.3.m3.3.3.3.3" xref="A1.SS2.p7.3.m3.3.3.3.3.cmml">θ</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p7.3.m3.3b"><apply id="A1.SS2.p7.3.m3.3.3.cmml" xref="A1.SS2.p7.3.m3.3.3"><eq id="A1.SS2.p7.3.m3.3.3.2.cmml" xref="A1.SS2.p7.3.m3.3.3.2"></eq><apply id="A1.SS2.p7.3.m3.3.3.1.cmml" xref="A1.SS2.p7.3.m3.3.3.1"><times id="A1.SS2.p7.3.m3.3.3.1.2.cmml" xref="A1.SS2.p7.3.m3.3.3.1.2"></times><apply id="A1.SS2.p7.3.m3.3.3.1.1.cmml" xref="A1.SS2.p7.3.m3.3.3.1.1"><csymbol cd="ambiguous" id="A1.SS2.p7.3.m3.3.3.1.1.2.cmml" xref="A1.SS2.p7.3.m3.3.3.1.1">superscript</csymbol><apply id="A1.SS2.p7.3.m3.3.3.1.1.1.1.1.cmml" xref="A1.SS2.p7.3.m3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p7.3.m3.3.3.1.1.1.1.1.1.cmml" xref="A1.SS2.p7.3.m3.3.3.1.1.1.1">subscript</csymbol><apply id="A1.SS2.p7.3.m3.3.3.1.1.1.1.1.2.cmml" xref="A1.SS2.p7.3.m3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p7.3.m3.3.3.1.1.1.1.1.2.1.cmml" xref="A1.SS2.p7.3.m3.3.3.1.1.1.1">superscript</csymbol><ci id="A1.SS2.p7.3.m3.3.3.1.1.1.1.1.2.2.cmml" xref="A1.SS2.p7.3.m3.3.3.1.1.1.1.1.2.2">𝐽</ci><ci id="A1.SS2.p7.3.m3.1.1.1.1.cmml" xref="A1.SS2.p7.3.m3.1.1.1.1">𝐳</ci></apply><ci id="A1.SS2.p7.3.m3.3.3.1.1.1.1.1.3.cmml" xref="A1.SS2.p7.3.m3.3.3.1.1.1.1.1.3">𝜃</ci></apply><ci id="A1.SS2.p7.3.m3.3.3.1.1.3.cmml" xref="A1.SS2.p7.3.m3.3.3.1.1.3">𝑇</ci></apply><apply id="A1.SS2.p7.3.m3.3.3.1.3.cmml" xref="A1.SS2.p7.3.m3.3.3.1.3"><csymbol cd="ambiguous" id="A1.SS2.p7.3.m3.3.3.1.3.1.cmml" xref="A1.SS2.p7.3.m3.3.3.1.3">subscript</csymbol><ci id="A1.SS2.p7.3.m3.3.3.1.3.2.cmml" xref="A1.SS2.p7.3.m3.3.3.1.3.2">𝐹</ci><ci id="A1.SS2.p7.3.m3.3.3.1.3.3.cmml" xref="A1.SS2.p7.3.m3.3.3.1.3.3">𝐙</ci></apply><apply id="A1.SS2.p7.3.m3.3.3.1.4.cmml" xref="A1.SS2.p7.3.m3.3.3.1.4"><csymbol cd="ambiguous" id="A1.SS2.p7.3.m3.3.3.1.4.1.cmml" xref="A1.SS2.p7.3.m3.3.3.1.4">subscript</csymbol><apply id="A1.SS2.p7.3.m3.3.3.1.4.2.cmml" xref="A1.SS2.p7.3.m3.3.3.1.4"><csymbol cd="ambiguous" id="A1.SS2.p7.3.m3.3.3.1.4.2.1.cmml" xref="A1.SS2.p7.3.m3.3.3.1.4">superscript</csymbol><ci id="A1.SS2.p7.3.m3.3.3.1.4.2.2.cmml" xref="A1.SS2.p7.3.m3.3.3.1.4.2.2">𝐽</ci><ci id="A1.SS2.p7.3.m3.2.2.1.1.cmml" xref="A1.SS2.p7.3.m3.2.2.1.1">𝐳</ci></apply><ci id="A1.SS2.p7.3.m3.3.3.1.4.3.cmml" xref="A1.SS2.p7.3.m3.3.3.1.4.3">𝜃</ci></apply></apply><apply id="A1.SS2.p7.3.m3.3.3.3.cmml" xref="A1.SS2.p7.3.m3.3.3.3"><csymbol cd="ambiguous" id="A1.SS2.p7.3.m3.3.3.3.1.cmml" xref="A1.SS2.p7.3.m3.3.3.3">subscript</csymbol><ci id="A1.SS2.p7.3.m3.3.3.3.2.cmml" xref="A1.SS2.p7.3.m3.3.3.3.2">𝐹</ci><ci id="A1.SS2.p7.3.m3.3.3.3.3.cmml" xref="A1.SS2.p7.3.m3.3.3.3.3">𝜃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p7.3.m3.3c">\left(J^{({\mathbf{z}})}_{\theta}\right)^{T}F_{\mathbf{Z}}J^{({\mathbf{z}})}_{\theta}=F_{{\mathbf{\theta}}}</annotation></semantics></math> is simply the Fisher Information matrix for the network parameters. Henceforth, we simply denote this as <math id="A1.SS2.p7.4.m4.1" class="ltx_Math" alttext="F" display="inline"><semantics id="A1.SS2.p7.4.m4.1a"><mi id="A1.SS2.p7.4.m4.1.1" xref="A1.SS2.p7.4.m4.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p7.4.m4.1b"><ci id="A1.SS2.p7.4.m4.1.1.cmml" xref="A1.SS2.p7.4.m4.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p7.4.m4.1c">F</annotation></semantics></math> or <math id="A1.SS2.p7.5.m5.1" class="ltx_Math" alttext="F_{i}" display="inline"><semantics id="A1.SS2.p7.5.m5.1a"><msub id="A1.SS2.p7.5.m5.1.1" xref="A1.SS2.p7.5.m5.1.1.cmml"><mi id="A1.SS2.p7.5.m5.1.1.2" xref="A1.SS2.p7.5.m5.1.1.2.cmml">F</mi><mi id="A1.SS2.p7.5.m5.1.1.3" xref="A1.SS2.p7.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p7.5.m5.1b"><apply id="A1.SS2.p7.5.m5.1.1.cmml" xref="A1.SS2.p7.5.m5.1.1"><csymbol cd="ambiguous" id="A1.SS2.p7.5.m5.1.1.1.cmml" xref="A1.SS2.p7.5.m5.1.1">subscript</csymbol><ci id="A1.SS2.p7.5.m5.1.1.2.cmml" xref="A1.SS2.p7.5.m5.1.1.2">𝐹</ci><ci id="A1.SS2.p7.5.m5.1.1.3.cmml" xref="A1.SS2.p7.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p7.5.m5.1c">F_{i}</annotation></semantics></math> to indicate the Fisher Information matrix corresponding to parameters <math id="A1.SS2.p7.6.m6.1" class="ltx_Math" alttext="{\mathbf{\theta}}_{i}" display="inline"><semantics id="A1.SS2.p7.6.m6.1a"><msub id="A1.SS2.p7.6.m6.1.1" xref="A1.SS2.p7.6.m6.1.1.cmml"><mi id="A1.SS2.p7.6.m6.1.1.2" xref="A1.SS2.p7.6.m6.1.1.2.cmml">θ</mi><mi id="A1.SS2.p7.6.m6.1.1.3" xref="A1.SS2.p7.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p7.6.m6.1b"><apply id="A1.SS2.p7.6.m6.1.1.cmml" xref="A1.SS2.p7.6.m6.1.1"><csymbol cd="ambiguous" id="A1.SS2.p7.6.m6.1.1.1.cmml" xref="A1.SS2.p7.6.m6.1.1">subscript</csymbol><ci id="A1.SS2.p7.6.m6.1.1.2.cmml" xref="A1.SS2.p7.6.m6.1.1.2">𝜃</ci><ci id="A1.SS2.p7.6.m6.1.1.3.cmml" xref="A1.SS2.p7.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p7.6.m6.1c">{\mathbf{\theta}}_{i}</annotation></semantics></math> of client <math id="A1.SS2.p7.7.m7.1" class="ltx_Math" alttext="i" display="inline"><semantics id="A1.SS2.p7.7.m7.1a"><mi id="A1.SS2.p7.7.m7.1.1" xref="A1.SS2.p7.7.m7.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p7.7.m7.1b"><ci id="A1.SS2.p7.7.m7.1.1.cmml" xref="A1.SS2.p7.7.m7.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p7.7.m7.1c">i</annotation></semantics></math>.</p>
</div>
<div id="A1.SS2.p8" class="ltx_para ltx_noindent">
<p id="A1.SS2.p8.1" class="ltx_p">Our final approximation to function space distance reduces to</p>
<table id="A1.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A1.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.E12.m1.3" class="ltx_Math" alttext="\displaystyle\mathcal{D}(f(\mathbf{X}_{i};{\mathbf{\theta}}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i}))" display="inline"><semantics id="A1.E12.m1.3a"><mrow id="A1.E12.m1.3.3" xref="A1.E12.m1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E12.m1.3.3.4" xref="A1.E12.m1.3.3.4.cmml">𝒟</mi><mo lspace="0em" rspace="0em" id="A1.E12.m1.3.3.3" xref="A1.E12.m1.3.3.3.cmml">​</mo><mrow id="A1.E12.m1.3.3.2.2" xref="A1.E12.m1.3.3.2.3.cmml"><mo stretchy="false" id="A1.E12.m1.3.3.2.2.3" xref="A1.E12.m1.3.3.2.3.cmml">(</mo><mrow id="A1.E12.m1.2.2.1.1.1" xref="A1.E12.m1.2.2.1.1.1.cmml"><mi id="A1.E12.m1.2.2.1.1.1.3" xref="A1.E12.m1.2.2.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.E12.m1.2.2.1.1.1.2" xref="A1.E12.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="A1.E12.m1.2.2.1.1.1.1.1" xref="A1.E12.m1.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.E12.m1.2.2.1.1.1.1.1.2" xref="A1.E12.m1.2.2.1.1.1.1.2.cmml">(</mo><msub id="A1.E12.m1.2.2.1.1.1.1.1.1" xref="A1.E12.m1.2.2.1.1.1.1.1.1.cmml"><mi id="A1.E12.m1.2.2.1.1.1.1.1.1.2" xref="A1.E12.m1.2.2.1.1.1.1.1.1.2.cmml">𝐗</mi><mi id="A1.E12.m1.2.2.1.1.1.1.1.1.3" xref="A1.E12.m1.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E12.m1.2.2.1.1.1.1.1.3" xref="A1.E12.m1.2.2.1.1.1.1.2.cmml">;</mo><mi id="A1.E12.m1.1.1" xref="A1.E12.m1.1.1.cmml">θ</mi><mo stretchy="false" id="A1.E12.m1.2.2.1.1.1.1.1.4" xref="A1.E12.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E12.m1.3.3.2.2.4" xref="A1.E12.m1.3.3.2.3.cmml">,</mo><mrow id="A1.E12.m1.3.3.2.2.2" xref="A1.E12.m1.3.3.2.2.2.cmml"><mi id="A1.E12.m1.3.3.2.2.2.4" xref="A1.E12.m1.3.3.2.2.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.E12.m1.3.3.2.2.2.3" xref="A1.E12.m1.3.3.2.2.2.3.cmml">​</mo><mrow id="A1.E12.m1.3.3.2.2.2.2.2" xref="A1.E12.m1.3.3.2.2.2.2.3.cmml"><mo stretchy="false" id="A1.E12.m1.3.3.2.2.2.2.2.3" xref="A1.E12.m1.3.3.2.2.2.2.3.cmml">(</mo><msub id="A1.E12.m1.3.3.2.2.2.1.1.1" xref="A1.E12.m1.3.3.2.2.2.1.1.1.cmml"><mi id="A1.E12.m1.3.3.2.2.2.1.1.1.2" xref="A1.E12.m1.3.3.2.2.2.1.1.1.2.cmml">𝐗</mi><mi id="A1.E12.m1.3.3.2.2.2.1.1.1.3" xref="A1.E12.m1.3.3.2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="A1.E12.m1.3.3.2.2.2.2.2.4" xref="A1.E12.m1.3.3.2.2.2.2.3.cmml">;</mo><msub id="A1.E12.m1.3.3.2.2.2.2.2.2" xref="A1.E12.m1.3.3.2.2.2.2.2.2.cmml"><mi id="A1.E12.m1.3.3.2.2.2.2.2.2.2" xref="A1.E12.m1.3.3.2.2.2.2.2.2.2.cmml">θ</mi><mi id="A1.E12.m1.3.3.2.2.2.2.2.2.3" xref="A1.E12.m1.3.3.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="A1.E12.m1.3.3.2.2.2.2.2.5" xref="A1.E12.m1.3.3.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.E12.m1.3.3.2.2.5" xref="A1.E12.m1.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E12.m1.3b"><apply id="A1.E12.m1.3.3.cmml" xref="A1.E12.m1.3.3"><times id="A1.E12.m1.3.3.3.cmml" xref="A1.E12.m1.3.3.3"></times><ci id="A1.E12.m1.3.3.4.cmml" xref="A1.E12.m1.3.3.4">𝒟</ci><interval closure="open" id="A1.E12.m1.3.3.2.3.cmml" xref="A1.E12.m1.3.3.2.2"><apply id="A1.E12.m1.2.2.1.1.1.cmml" xref="A1.E12.m1.2.2.1.1.1"><times id="A1.E12.m1.2.2.1.1.1.2.cmml" xref="A1.E12.m1.2.2.1.1.1.2"></times><ci id="A1.E12.m1.2.2.1.1.1.3.cmml" xref="A1.E12.m1.2.2.1.1.1.3">𝑓</ci><list id="A1.E12.m1.2.2.1.1.1.1.2.cmml" xref="A1.E12.m1.2.2.1.1.1.1.1"><apply id="A1.E12.m1.2.2.1.1.1.1.1.1.cmml" xref="A1.E12.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E12.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.2.2.1.1.1.1.1.1.2">𝐗</ci><ci id="A1.E12.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A1.E12.m1.2.2.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="A1.E12.m1.1.1.cmml" xref="A1.E12.m1.1.1">𝜃</ci></list></apply><apply id="A1.E12.m1.3.3.2.2.2.cmml" xref="A1.E12.m1.3.3.2.2.2"><times id="A1.E12.m1.3.3.2.2.2.3.cmml" xref="A1.E12.m1.3.3.2.2.2.3"></times><ci id="A1.E12.m1.3.3.2.2.2.4.cmml" xref="A1.E12.m1.3.3.2.2.2.4">𝑓</ci><list id="A1.E12.m1.3.3.2.2.2.2.3.cmml" xref="A1.E12.m1.3.3.2.2.2.2.2"><apply id="A1.E12.m1.3.3.2.2.2.1.1.1.cmml" xref="A1.E12.m1.3.3.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.3.3.2.2.2.1.1.1.1.cmml" xref="A1.E12.m1.3.3.2.2.2.1.1.1">subscript</csymbol><ci id="A1.E12.m1.3.3.2.2.2.1.1.1.2.cmml" xref="A1.E12.m1.3.3.2.2.2.1.1.1.2">𝐗</ci><ci id="A1.E12.m1.3.3.2.2.2.1.1.1.3.cmml" xref="A1.E12.m1.3.3.2.2.2.1.1.1.3">𝑖</ci></apply><apply id="A1.E12.m1.3.3.2.2.2.2.2.2.cmml" xref="A1.E12.m1.3.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.E12.m1.3.3.2.2.2.2.2.2.1.cmml" xref="A1.E12.m1.3.3.2.2.2.2.2.2">subscript</csymbol><ci id="A1.E12.m1.3.3.2.2.2.2.2.2.2.cmml" xref="A1.E12.m1.3.3.2.2.2.2.2.2.2">𝜃</ci><ci id="A1.E12.m1.3.3.2.2.2.2.2.2.3.cmml" xref="A1.E12.m1.3.3.2.2.2.2.2.2.3">𝑖</ci></apply></list></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E12.m1.3c">\displaystyle\mathcal{D}(f(\mathbf{X}_{i};{\mathbf{\theta}}),f(\mathbf{X}_{i};{\mathbf{\theta}}_{i}))</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.E12.m2.2" class="ltx_Math" alttext="\displaystyle\approx\frac{1}{2}({\mathbf{\theta}}-{\mathbf{\theta}}_{i})^{T}F_{i}({\mathbf{\theta}}-{\mathbf{\theta}}_{i})" display="inline"><semantics id="A1.E12.m2.2a"><mrow id="A1.E12.m2.2.2" xref="A1.E12.m2.2.2.cmml"><mi id="A1.E12.m2.2.2.4" xref="A1.E12.m2.2.2.4.cmml"></mi><mo id="A1.E12.m2.2.2.3" xref="A1.E12.m2.2.2.3.cmml">≈</mo><mrow id="A1.E12.m2.2.2.2" xref="A1.E12.m2.2.2.2.cmml"><mstyle displaystyle="true" id="A1.E12.m2.2.2.2.4" xref="A1.E12.m2.2.2.2.4.cmml"><mfrac id="A1.E12.m2.2.2.2.4a" xref="A1.E12.m2.2.2.2.4.cmml"><mn id="A1.E12.m2.2.2.2.4.2" xref="A1.E12.m2.2.2.2.4.2.cmml">1</mn><mn id="A1.E12.m2.2.2.2.4.3" xref="A1.E12.m2.2.2.2.4.3.cmml">2</mn></mfrac></mstyle><mo lspace="0em" rspace="0em" id="A1.E12.m2.2.2.2.3" xref="A1.E12.m2.2.2.2.3.cmml">​</mo><msup id="A1.E12.m2.1.1.1.1" xref="A1.E12.m2.1.1.1.1.cmml"><mrow id="A1.E12.m2.1.1.1.1.1.1" xref="A1.E12.m2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.E12.m2.1.1.1.1.1.1.2" xref="A1.E12.m2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E12.m2.1.1.1.1.1.1.1" xref="A1.E12.m2.1.1.1.1.1.1.1.cmml"><mi id="A1.E12.m2.1.1.1.1.1.1.1.2" xref="A1.E12.m2.1.1.1.1.1.1.1.2.cmml">θ</mi><mo id="A1.E12.m2.1.1.1.1.1.1.1.1" xref="A1.E12.m2.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A1.E12.m2.1.1.1.1.1.1.1.3" xref="A1.E12.m2.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E12.m2.1.1.1.1.1.1.1.3.2" xref="A1.E12.m2.1.1.1.1.1.1.1.3.2.cmml">θ</mi><mi id="A1.E12.m2.1.1.1.1.1.1.1.3.3" xref="A1.E12.m2.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="A1.E12.m2.1.1.1.1.1.1.3" xref="A1.E12.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="A1.E12.m2.1.1.1.1.3" xref="A1.E12.m2.1.1.1.1.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="A1.E12.m2.2.2.2.3a" xref="A1.E12.m2.2.2.2.3.cmml">​</mo><msub id="A1.E12.m2.2.2.2.5" xref="A1.E12.m2.2.2.2.5.cmml"><mi id="A1.E12.m2.2.2.2.5.2" xref="A1.E12.m2.2.2.2.5.2.cmml">F</mi><mi id="A1.E12.m2.2.2.2.5.3" xref="A1.E12.m2.2.2.2.5.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A1.E12.m2.2.2.2.3b" xref="A1.E12.m2.2.2.2.3.cmml">​</mo><mrow id="A1.E12.m2.2.2.2.2.1" xref="A1.E12.m2.2.2.2.2.1.1.cmml"><mo stretchy="false" id="A1.E12.m2.2.2.2.2.1.2" xref="A1.E12.m2.2.2.2.2.1.1.cmml">(</mo><mrow id="A1.E12.m2.2.2.2.2.1.1" xref="A1.E12.m2.2.2.2.2.1.1.cmml"><mi id="A1.E12.m2.2.2.2.2.1.1.2" xref="A1.E12.m2.2.2.2.2.1.1.2.cmml">θ</mi><mo id="A1.E12.m2.2.2.2.2.1.1.1" xref="A1.E12.m2.2.2.2.2.1.1.1.cmml">−</mo><msub id="A1.E12.m2.2.2.2.2.1.1.3" xref="A1.E12.m2.2.2.2.2.1.1.3.cmml"><mi id="A1.E12.m2.2.2.2.2.1.1.3.2" xref="A1.E12.m2.2.2.2.2.1.1.3.2.cmml">θ</mi><mi id="A1.E12.m2.2.2.2.2.1.1.3.3" xref="A1.E12.m2.2.2.2.2.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="A1.E12.m2.2.2.2.2.1.3" xref="A1.E12.m2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E12.m2.2b"><apply id="A1.E12.m2.2.2.cmml" xref="A1.E12.m2.2.2"><approx id="A1.E12.m2.2.2.3.cmml" xref="A1.E12.m2.2.2.3"></approx><csymbol cd="latexml" id="A1.E12.m2.2.2.4.cmml" xref="A1.E12.m2.2.2.4">absent</csymbol><apply id="A1.E12.m2.2.2.2.cmml" xref="A1.E12.m2.2.2.2"><times id="A1.E12.m2.2.2.2.3.cmml" xref="A1.E12.m2.2.2.2.3"></times><apply id="A1.E12.m2.2.2.2.4.cmml" xref="A1.E12.m2.2.2.2.4"><divide id="A1.E12.m2.2.2.2.4.1.cmml" xref="A1.E12.m2.2.2.2.4"></divide><cn type="integer" id="A1.E12.m2.2.2.2.4.2.cmml" xref="A1.E12.m2.2.2.2.4.2">1</cn><cn type="integer" id="A1.E12.m2.2.2.2.4.3.cmml" xref="A1.E12.m2.2.2.2.4.3">2</cn></apply><apply id="A1.E12.m2.1.1.1.1.cmml" xref="A1.E12.m2.1.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m2.1.1.1.1.2.cmml" xref="A1.E12.m2.1.1.1.1">superscript</csymbol><apply id="A1.E12.m2.1.1.1.1.1.1.1.cmml" xref="A1.E12.m2.1.1.1.1.1.1"><minus id="A1.E12.m2.1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m2.1.1.1.1.1.1.1.1"></minus><ci id="A1.E12.m2.1.1.1.1.1.1.1.2.cmml" xref="A1.E12.m2.1.1.1.1.1.1.1.2">𝜃</ci><apply id="A1.E12.m2.1.1.1.1.1.1.1.3.cmml" xref="A1.E12.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E12.m2.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E12.m2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E12.m2.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E12.m2.1.1.1.1.1.1.1.3.2">𝜃</ci><ci id="A1.E12.m2.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E12.m2.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><ci id="A1.E12.m2.1.1.1.1.3.cmml" xref="A1.E12.m2.1.1.1.1.3">𝑇</ci></apply><apply id="A1.E12.m2.2.2.2.5.cmml" xref="A1.E12.m2.2.2.2.5"><csymbol cd="ambiguous" id="A1.E12.m2.2.2.2.5.1.cmml" xref="A1.E12.m2.2.2.2.5">subscript</csymbol><ci id="A1.E12.m2.2.2.2.5.2.cmml" xref="A1.E12.m2.2.2.2.5.2">𝐹</ci><ci id="A1.E12.m2.2.2.2.5.3.cmml" xref="A1.E12.m2.2.2.2.5.3">𝑖</ci></apply><apply id="A1.E12.m2.2.2.2.2.1.1.cmml" xref="A1.E12.m2.2.2.2.2.1"><minus id="A1.E12.m2.2.2.2.2.1.1.1.cmml" xref="A1.E12.m2.2.2.2.2.1.1.1"></minus><ci id="A1.E12.m2.2.2.2.2.1.1.2.cmml" xref="A1.E12.m2.2.2.2.2.1.1.2">𝜃</ci><apply id="A1.E12.m2.2.2.2.2.1.1.3.cmml" xref="A1.E12.m2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A1.E12.m2.2.2.2.2.1.1.3.1.cmml" xref="A1.E12.m2.2.2.2.2.1.1.3">subscript</csymbol><ci id="A1.E12.m2.2.2.2.2.1.1.3.2.cmml" xref="A1.E12.m2.2.2.2.2.1.1.3.2">𝜃</ci><ci id="A1.E12.m2.2.2.2.2.1.1.3.3.cmml" xref="A1.E12.m2.2.2.2.2.1.1.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E12.m2.2c">\displaystyle\approx\frac{1}{2}({\mathbf{\theta}}-{\mathbf{\theta}}_{i})^{T}F_{i}({\mathbf{\theta}}-{\mathbf{\theta}}_{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
<tbody id="A1.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.E13.m2.5" class="ltx_Math" alttext="\displaystyle\approx\frac{1}{2}\sum_{j=1}^{|{\mathbf{\theta}}_{i}|}F_{i}^{(j)}({\mathbf{\theta}}^{(j)}-{\mathbf{\theta}}_{i}^{(j)})^{2}." display="inline"><semantics id="A1.E13.m2.5a"><mrow id="A1.E13.m2.5.5.1" xref="A1.E13.m2.5.5.1.1.cmml"><mrow id="A1.E13.m2.5.5.1.1" xref="A1.E13.m2.5.5.1.1.cmml"><mi id="A1.E13.m2.5.5.1.1.3" xref="A1.E13.m2.5.5.1.1.3.cmml"></mi><mo id="A1.E13.m2.5.5.1.1.2" xref="A1.E13.m2.5.5.1.1.2.cmml">≈</mo><mrow id="A1.E13.m2.5.5.1.1.1" xref="A1.E13.m2.5.5.1.1.1.cmml"><mstyle displaystyle="true" id="A1.E13.m2.5.5.1.1.1.3" xref="A1.E13.m2.5.5.1.1.1.3.cmml"><mfrac id="A1.E13.m2.5.5.1.1.1.3a" xref="A1.E13.m2.5.5.1.1.1.3.cmml"><mn id="A1.E13.m2.5.5.1.1.1.3.2" xref="A1.E13.m2.5.5.1.1.1.3.2.cmml">1</mn><mn id="A1.E13.m2.5.5.1.1.1.3.3" xref="A1.E13.m2.5.5.1.1.1.3.3.cmml">2</mn></mfrac></mstyle><mo lspace="0em" rspace="0em" id="A1.E13.m2.5.5.1.1.1.2" xref="A1.E13.m2.5.5.1.1.1.2.cmml">​</mo><mrow id="A1.E13.m2.5.5.1.1.1.1" xref="A1.E13.m2.5.5.1.1.1.1.cmml"><mstyle displaystyle="true" id="A1.E13.m2.5.5.1.1.1.1.2" xref="A1.E13.m2.5.5.1.1.1.1.2.cmml"><munderover id="A1.E13.m2.5.5.1.1.1.1.2a" xref="A1.E13.m2.5.5.1.1.1.1.2.cmml"><mo movablelimits="false" id="A1.E13.m2.5.5.1.1.1.1.2.2.2" xref="A1.E13.m2.5.5.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="A1.E13.m2.5.5.1.1.1.1.2.2.3" xref="A1.E13.m2.5.5.1.1.1.1.2.2.3.cmml"><mi id="A1.E13.m2.5.5.1.1.1.1.2.2.3.2" xref="A1.E13.m2.5.5.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="A1.E13.m2.5.5.1.1.1.1.2.2.3.1" xref="A1.E13.m2.5.5.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="A1.E13.m2.5.5.1.1.1.1.2.2.3.3" xref="A1.E13.m2.5.5.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="A1.E13.m2.1.1.1.1" xref="A1.E13.m2.1.1.1.2.cmml"><mo stretchy="false" id="A1.E13.m2.1.1.1.1.2" xref="A1.E13.m2.1.1.1.2.1.cmml">|</mo><msub id="A1.E13.m2.1.1.1.1.1" xref="A1.E13.m2.1.1.1.1.1.cmml"><mi id="A1.E13.m2.1.1.1.1.1.2" xref="A1.E13.m2.1.1.1.1.1.2.cmml">θ</mi><mi id="A1.E13.m2.1.1.1.1.1.3" xref="A1.E13.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A1.E13.m2.1.1.1.1.3" xref="A1.E13.m2.1.1.1.2.1.cmml">|</mo></mrow></munderover></mstyle><mrow id="A1.E13.m2.5.5.1.1.1.1.1" xref="A1.E13.m2.5.5.1.1.1.1.1.cmml"><msubsup id="A1.E13.m2.5.5.1.1.1.1.1.3" xref="A1.E13.m2.5.5.1.1.1.1.1.3.cmml"><mi id="A1.E13.m2.5.5.1.1.1.1.1.3.2.2" xref="A1.E13.m2.5.5.1.1.1.1.1.3.2.2.cmml">F</mi><mi id="A1.E13.m2.5.5.1.1.1.1.1.3.2.3" xref="A1.E13.m2.5.5.1.1.1.1.1.3.2.3.cmml">i</mi><mrow id="A1.E13.m2.2.2.1.3" xref="A1.E13.m2.5.5.1.1.1.1.1.3.cmml"><mo stretchy="false" id="A1.E13.m2.2.2.1.3.1" xref="A1.E13.m2.5.5.1.1.1.1.1.3.cmml">(</mo><mi id="A1.E13.m2.2.2.1.1" xref="A1.E13.m2.2.2.1.1.cmml">j</mi><mo stretchy="false" id="A1.E13.m2.2.2.1.3.2" xref="A1.E13.m2.5.5.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="A1.E13.m2.5.5.1.1.1.1.1.2" xref="A1.E13.m2.5.5.1.1.1.1.1.2.cmml">​</mo><msup id="A1.E13.m2.5.5.1.1.1.1.1.1" xref="A1.E13.m2.5.5.1.1.1.1.1.1.cmml"><mrow id="A1.E13.m2.5.5.1.1.1.1.1.1.1.1" xref="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.2" xref="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1" xref="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.cmml"><msup id="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2" xref="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.2" xref="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml">θ</mi><mrow id="A1.E13.m2.3.3.1.3" xref="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.E13.m2.3.3.1.3.1" xref="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="A1.E13.m2.3.3.1.1" xref="A1.E13.m2.3.3.1.1.cmml">j</mi><mo stretchy="false" id="A1.E13.m2.3.3.1.3.2" xref="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></msup><mo id="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.1" xref="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3" xref="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.2" xref="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.2.cmml">θ</mi><mi id="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.3" xref="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mrow id="A1.E13.m2.4.4.1.3" xref="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="A1.E13.m2.4.4.1.3.1" xref="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="A1.E13.m2.4.4.1.1" xref="A1.E13.m2.4.4.1.1.cmml">j</mi><mo stretchy="false" id="A1.E13.m2.4.4.1.3.2" xref="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo stretchy="false" id="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.3" xref="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="A1.E13.m2.5.5.1.1.1.1.1.1.3" xref="A1.E13.m2.5.5.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow></mrow><mo lspace="0em" id="A1.E13.m2.5.5.1.2" xref="A1.E13.m2.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E13.m2.5b"><apply id="A1.E13.m2.5.5.1.1.cmml" xref="A1.E13.m2.5.5.1"><approx id="A1.E13.m2.5.5.1.1.2.cmml" xref="A1.E13.m2.5.5.1.1.2"></approx><csymbol cd="latexml" id="A1.E13.m2.5.5.1.1.3.cmml" xref="A1.E13.m2.5.5.1.1.3">absent</csymbol><apply id="A1.E13.m2.5.5.1.1.1.cmml" xref="A1.E13.m2.5.5.1.1.1"><times id="A1.E13.m2.5.5.1.1.1.2.cmml" xref="A1.E13.m2.5.5.1.1.1.2"></times><apply id="A1.E13.m2.5.5.1.1.1.3.cmml" xref="A1.E13.m2.5.5.1.1.1.3"><divide id="A1.E13.m2.5.5.1.1.1.3.1.cmml" xref="A1.E13.m2.5.5.1.1.1.3"></divide><cn type="integer" id="A1.E13.m2.5.5.1.1.1.3.2.cmml" xref="A1.E13.m2.5.5.1.1.1.3.2">1</cn><cn type="integer" id="A1.E13.m2.5.5.1.1.1.3.3.cmml" xref="A1.E13.m2.5.5.1.1.1.3.3">2</cn></apply><apply id="A1.E13.m2.5.5.1.1.1.1.cmml" xref="A1.E13.m2.5.5.1.1.1.1"><apply id="A1.E13.m2.5.5.1.1.1.1.2.cmml" xref="A1.E13.m2.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E13.m2.5.5.1.1.1.1.2.1.cmml" xref="A1.E13.m2.5.5.1.1.1.1.2">superscript</csymbol><apply id="A1.E13.m2.5.5.1.1.1.1.2.2.cmml" xref="A1.E13.m2.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E13.m2.5.5.1.1.1.1.2.2.1.cmml" xref="A1.E13.m2.5.5.1.1.1.1.2">subscript</csymbol><sum id="A1.E13.m2.5.5.1.1.1.1.2.2.2.cmml" xref="A1.E13.m2.5.5.1.1.1.1.2.2.2"></sum><apply id="A1.E13.m2.5.5.1.1.1.1.2.2.3.cmml" xref="A1.E13.m2.5.5.1.1.1.1.2.2.3"><eq id="A1.E13.m2.5.5.1.1.1.1.2.2.3.1.cmml" xref="A1.E13.m2.5.5.1.1.1.1.2.2.3.1"></eq><ci id="A1.E13.m2.5.5.1.1.1.1.2.2.3.2.cmml" xref="A1.E13.m2.5.5.1.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="A1.E13.m2.5.5.1.1.1.1.2.2.3.3.cmml" xref="A1.E13.m2.5.5.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="A1.E13.m2.1.1.1.2.cmml" xref="A1.E13.m2.1.1.1.1"><abs id="A1.E13.m2.1.1.1.2.1.cmml" xref="A1.E13.m2.1.1.1.1.2"></abs><apply id="A1.E13.m2.1.1.1.1.1.cmml" xref="A1.E13.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E13.m2.1.1.1.1.1.1.cmml" xref="A1.E13.m2.1.1.1.1.1">subscript</csymbol><ci id="A1.E13.m2.1.1.1.1.1.2.cmml" xref="A1.E13.m2.1.1.1.1.1.2">𝜃</ci><ci id="A1.E13.m2.1.1.1.1.1.3.cmml" xref="A1.E13.m2.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="A1.E13.m2.5.5.1.1.1.1.1.cmml" xref="A1.E13.m2.5.5.1.1.1.1.1"><times id="A1.E13.m2.5.5.1.1.1.1.1.2.cmml" xref="A1.E13.m2.5.5.1.1.1.1.1.2"></times><apply id="A1.E13.m2.5.5.1.1.1.1.1.3.cmml" xref="A1.E13.m2.5.5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E13.m2.5.5.1.1.1.1.1.3.1.cmml" xref="A1.E13.m2.5.5.1.1.1.1.1.3">superscript</csymbol><apply id="A1.E13.m2.5.5.1.1.1.1.1.3.2.cmml" xref="A1.E13.m2.5.5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E13.m2.5.5.1.1.1.1.1.3.2.1.cmml" xref="A1.E13.m2.5.5.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E13.m2.5.5.1.1.1.1.1.3.2.2.cmml" xref="A1.E13.m2.5.5.1.1.1.1.1.3.2.2">𝐹</ci><ci id="A1.E13.m2.5.5.1.1.1.1.1.3.2.3.cmml" xref="A1.E13.m2.5.5.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="A1.E13.m2.2.2.1.1.cmml" xref="A1.E13.m2.2.2.1.1">𝑗</ci></apply><apply id="A1.E13.m2.5.5.1.1.1.1.1.1.cmml" xref="A1.E13.m2.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E13.m2.5.5.1.1.1.1.1.1.2.cmml" xref="A1.E13.m2.5.5.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E13.m2.5.5.1.1.1.1.1.1.1.1"><minus id="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.1"></minus><apply id="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.2">𝜃</ci><ci id="A1.E13.m2.3.3.1.1.cmml" xref="A1.E13.m2.3.3.1.1">𝑗</ci></apply><apply id="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.2">𝜃</ci><ci id="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="A1.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="A1.E13.m2.4.4.1.1.cmml" xref="A1.E13.m2.4.4.1.1">𝑗</ci></apply></apply><cn type="integer" id="A1.E13.m2.5.5.1.1.1.1.1.1.3.cmml" xref="A1.E13.m2.5.5.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E13.m2.5c">\displaystyle\approx\frac{1}{2}\sum_{j=1}^{|{\mathbf{\theta}}_{i}|}F_{i}^{(j)}({\mathbf{\theta}}^{(j)}-{\mathbf{\theta}}_{i}^{(j)})^{2}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
</div>
<div id="A1.SS2.p9" class="ltx_para ltx_noindent">
<p id="A1.SS2.p9.3" class="ltx_p">Here, <a href="#A1.E13" title="In A.2 FedFish Derivation ‣ Appendix A Appendix ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">13</span></a> makes a diagonal approximation to the Fisher Information matrix, with <math id="A1.SS2.p9.1.m1.1" class="ltx_Math" alttext="F_{i}^{(j)}" display="inline"><semantics id="A1.SS2.p9.1.m1.1a"><msubsup id="A1.SS2.p9.1.m1.1.2" xref="A1.SS2.p9.1.m1.1.2.cmml"><mi id="A1.SS2.p9.1.m1.1.2.2.2" xref="A1.SS2.p9.1.m1.1.2.2.2.cmml">F</mi><mi id="A1.SS2.p9.1.m1.1.2.2.3" xref="A1.SS2.p9.1.m1.1.2.2.3.cmml">i</mi><mrow id="A1.SS2.p9.1.m1.1.1.1.3" xref="A1.SS2.p9.1.m1.1.2.cmml"><mo stretchy="false" id="A1.SS2.p9.1.m1.1.1.1.3.1" xref="A1.SS2.p9.1.m1.1.2.cmml">(</mo><mi id="A1.SS2.p9.1.m1.1.1.1.1" xref="A1.SS2.p9.1.m1.1.1.1.1.cmml">j</mi><mo stretchy="false" id="A1.SS2.p9.1.m1.1.1.1.3.2" xref="A1.SS2.p9.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS2.p9.1.m1.1b"><apply id="A1.SS2.p9.1.m1.1.2.cmml" xref="A1.SS2.p9.1.m1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p9.1.m1.1.2.1.cmml" xref="A1.SS2.p9.1.m1.1.2">superscript</csymbol><apply id="A1.SS2.p9.1.m1.1.2.2.cmml" xref="A1.SS2.p9.1.m1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p9.1.m1.1.2.2.1.cmml" xref="A1.SS2.p9.1.m1.1.2">subscript</csymbol><ci id="A1.SS2.p9.1.m1.1.2.2.2.cmml" xref="A1.SS2.p9.1.m1.1.2.2.2">𝐹</ci><ci id="A1.SS2.p9.1.m1.1.2.2.3.cmml" xref="A1.SS2.p9.1.m1.1.2.2.3">𝑖</ci></apply><ci id="A1.SS2.p9.1.m1.1.1.1.1.cmml" xref="A1.SS2.p9.1.m1.1.1.1.1">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p9.1.m1.1c">F_{i}^{(j)}</annotation></semantics></math> denoting the <math id="A1.SS2.p9.2.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="A1.SS2.p9.2.m2.1a"><mi id="A1.SS2.p9.2.m2.1.1" xref="A1.SS2.p9.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p9.2.m2.1b"><ci id="A1.SS2.p9.2.m2.1.1.cmml" xref="A1.SS2.p9.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p9.2.m2.1c">j</annotation></semantics></math>-th diagonal entry of <math id="A1.SS2.p9.3.m3.1" class="ltx_Math" alttext="F_{i}" display="inline"><semantics id="A1.SS2.p9.3.m3.1a"><msub id="A1.SS2.p9.3.m3.1.1" xref="A1.SS2.p9.3.m3.1.1.cmml"><mi id="A1.SS2.p9.3.m3.1.1.2" xref="A1.SS2.p9.3.m3.1.1.2.cmml">F</mi><mi id="A1.SS2.p9.3.m3.1.1.3" xref="A1.SS2.p9.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p9.3.m3.1b"><apply id="A1.SS2.p9.3.m3.1.1.cmml" xref="A1.SS2.p9.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS2.p9.3.m3.1.1.1.cmml" xref="A1.SS2.p9.3.m3.1.1">subscript</csymbol><ci id="A1.SS2.p9.3.m3.1.1.2.cmml" xref="A1.SS2.p9.3.m3.1.1.2">𝐹</ci><ci id="A1.SS2.p9.3.m3.1.1.3.cmml" xref="A1.SS2.p9.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p9.3.m3.1c">F_{i}</annotation></semantics></math>.</p>
</div>
<div id="A1.SS2.p10" class="ltx_para ltx_noindent">
<p id="A1.SS2.p10.3" class="ltx_p">Plugging <a href="#A1.E13" title="In A.2 FedFish Derivation ‣ Appendix A Appendix ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">13</span></a> into the optimization problem of <a href="#A1.E6" title="In A.2 FedFish Derivation ‣ Appendix A Appendix ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">eq.</span> <span class="ltx_text ltx_ref_tag">6</span></a> gives</p>
<table id="A1.E14" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E14.m1.5" class="ltx_Math" alttext="{\mathbf{\theta}}_{G}^{*}=\arg\min_{{\mathbf{\theta}}}\frac{1}{2N}\sum_{i=1}^{N}\sum_{j=1}^{|{\mathbf{\theta}}_{i}|}F_{i}^{(j)}({\mathbf{\theta}}^{(j)}-{\mathbf{\theta}}_{i}^{(j)})^{2}." display="block"><semantics id="A1.E14.m1.5a"><mrow id="A1.E14.m1.5.5.1" xref="A1.E14.m1.5.5.1.1.cmml"><mrow id="A1.E14.m1.5.5.1.1" xref="A1.E14.m1.5.5.1.1.cmml"><msubsup id="A1.E14.m1.5.5.1.1.3" xref="A1.E14.m1.5.5.1.1.3.cmml"><mi id="A1.E14.m1.5.5.1.1.3.2.2" xref="A1.E14.m1.5.5.1.1.3.2.2.cmml">θ</mi><mi id="A1.E14.m1.5.5.1.1.3.2.3" xref="A1.E14.m1.5.5.1.1.3.2.3.cmml">G</mi><mo id="A1.E14.m1.5.5.1.1.3.3" xref="A1.E14.m1.5.5.1.1.3.3.cmml">∗</mo></msubsup><mo id="A1.E14.m1.5.5.1.1.2" xref="A1.E14.m1.5.5.1.1.2.cmml">=</mo><mrow id="A1.E14.m1.5.5.1.1.1" xref="A1.E14.m1.5.5.1.1.1.cmml"><mrow id="A1.E14.m1.5.5.1.1.1.3" xref="A1.E14.m1.5.5.1.1.1.3.cmml"><mi id="A1.E14.m1.5.5.1.1.1.3.1" xref="A1.E14.m1.5.5.1.1.1.3.1.cmml">arg</mi><mo lspace="0.167em" id="A1.E14.m1.5.5.1.1.1.3a" xref="A1.E14.m1.5.5.1.1.1.3.cmml">⁡</mo><mrow id="A1.E14.m1.5.5.1.1.1.3.2" xref="A1.E14.m1.5.5.1.1.1.3.2.cmml"><munder id="A1.E14.m1.5.5.1.1.1.3.2.1" xref="A1.E14.m1.5.5.1.1.1.3.2.1.cmml"><mi id="A1.E14.m1.5.5.1.1.1.3.2.1.2" xref="A1.E14.m1.5.5.1.1.1.3.2.1.2.cmml">min</mi><mi id="A1.E14.m1.5.5.1.1.1.3.2.1.3" xref="A1.E14.m1.5.5.1.1.1.3.2.1.3.cmml">θ</mi></munder><mo lspace="0.167em" id="A1.E14.m1.5.5.1.1.1.3.2a" xref="A1.E14.m1.5.5.1.1.1.3.2.cmml">⁡</mo><mfrac id="A1.E14.m1.5.5.1.1.1.3.2.2" xref="A1.E14.m1.5.5.1.1.1.3.2.2.cmml"><mn id="A1.E14.m1.5.5.1.1.1.3.2.2.2" xref="A1.E14.m1.5.5.1.1.1.3.2.2.2.cmml">1</mn><mrow id="A1.E14.m1.5.5.1.1.1.3.2.2.3" xref="A1.E14.m1.5.5.1.1.1.3.2.2.3.cmml"><mn id="A1.E14.m1.5.5.1.1.1.3.2.2.3.2" xref="A1.E14.m1.5.5.1.1.1.3.2.2.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="A1.E14.m1.5.5.1.1.1.3.2.2.3.1" xref="A1.E14.m1.5.5.1.1.1.3.2.2.3.1.cmml">​</mo><mi id="A1.E14.m1.5.5.1.1.1.3.2.2.3.3" xref="A1.E14.m1.5.5.1.1.1.3.2.2.3.3.cmml">N</mi></mrow></mfrac></mrow></mrow><mo lspace="0em" rspace="0em" id="A1.E14.m1.5.5.1.1.1.2" xref="A1.E14.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="A1.E14.m1.5.5.1.1.1.1" xref="A1.E14.m1.5.5.1.1.1.1.cmml"><munderover id="A1.E14.m1.5.5.1.1.1.1.2" xref="A1.E14.m1.5.5.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="A1.E14.m1.5.5.1.1.1.1.2.2.2" xref="A1.E14.m1.5.5.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="A1.E14.m1.5.5.1.1.1.1.2.2.3" xref="A1.E14.m1.5.5.1.1.1.1.2.2.3.cmml"><mi id="A1.E14.m1.5.5.1.1.1.1.2.2.3.2" xref="A1.E14.m1.5.5.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="A1.E14.m1.5.5.1.1.1.1.2.2.3.1" xref="A1.E14.m1.5.5.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="A1.E14.m1.5.5.1.1.1.1.2.2.3.3" xref="A1.E14.m1.5.5.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="A1.E14.m1.5.5.1.1.1.1.2.3" xref="A1.E14.m1.5.5.1.1.1.1.2.3.cmml">N</mi></munderover><mrow id="A1.E14.m1.5.5.1.1.1.1.1" xref="A1.E14.m1.5.5.1.1.1.1.1.cmml"><munderover id="A1.E14.m1.5.5.1.1.1.1.1.2" xref="A1.E14.m1.5.5.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="A1.E14.m1.5.5.1.1.1.1.1.2.2.2" xref="A1.E14.m1.5.5.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="A1.E14.m1.5.5.1.1.1.1.1.2.2.3" xref="A1.E14.m1.5.5.1.1.1.1.1.2.2.3.cmml"><mi id="A1.E14.m1.5.5.1.1.1.1.1.2.2.3.2" xref="A1.E14.m1.5.5.1.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="A1.E14.m1.5.5.1.1.1.1.1.2.2.3.1" xref="A1.E14.m1.5.5.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="A1.E14.m1.5.5.1.1.1.1.1.2.2.3.3" xref="A1.E14.m1.5.5.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="A1.E14.m1.1.1.1.1" xref="A1.E14.m1.1.1.1.2.cmml"><mo stretchy="false" id="A1.E14.m1.1.1.1.1.2" xref="A1.E14.m1.1.1.1.2.1.cmml">|</mo><msub id="A1.E14.m1.1.1.1.1.1" xref="A1.E14.m1.1.1.1.1.1.cmml"><mi id="A1.E14.m1.1.1.1.1.1.2" xref="A1.E14.m1.1.1.1.1.1.2.cmml">θ</mi><mi id="A1.E14.m1.1.1.1.1.1.3" xref="A1.E14.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A1.E14.m1.1.1.1.1.3" xref="A1.E14.m1.1.1.1.2.1.cmml">|</mo></mrow></munderover><mrow id="A1.E14.m1.5.5.1.1.1.1.1.1" xref="A1.E14.m1.5.5.1.1.1.1.1.1.cmml"><msubsup id="A1.E14.m1.5.5.1.1.1.1.1.1.3" xref="A1.E14.m1.5.5.1.1.1.1.1.1.3.cmml"><mi id="A1.E14.m1.5.5.1.1.1.1.1.1.3.2.2" xref="A1.E14.m1.5.5.1.1.1.1.1.1.3.2.2.cmml">F</mi><mi id="A1.E14.m1.5.5.1.1.1.1.1.1.3.2.3" xref="A1.E14.m1.5.5.1.1.1.1.1.1.3.2.3.cmml">i</mi><mrow id="A1.E14.m1.2.2.1.3" xref="A1.E14.m1.5.5.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="A1.E14.m1.2.2.1.3.1" xref="A1.E14.m1.5.5.1.1.1.1.1.1.3.cmml">(</mo><mi id="A1.E14.m1.2.2.1.1" xref="A1.E14.m1.2.2.1.1.cmml">j</mi><mo stretchy="false" id="A1.E14.m1.2.2.1.3.2" xref="A1.E14.m1.5.5.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="A1.E14.m1.5.5.1.1.1.1.1.1.2" xref="A1.E14.m1.5.5.1.1.1.1.1.1.2.cmml">​</mo><msup id="A1.E14.m1.5.5.1.1.1.1.1.1.1" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.cmml"><mrow id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><msup id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.cmml">θ</mi><mrow id="A1.E14.m1.3.3.1.3" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.E14.m1.3.3.1.3.1" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="A1.E14.m1.3.3.1.1" xref="A1.E14.m1.3.3.1.1.cmml">j</mi><mo stretchy="false" id="A1.E14.m1.3.3.1.3.2" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></msup><mo id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">θ</mi><mi id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mrow id="A1.E14.m1.4.4.1.3" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="A1.E14.m1.4.4.1.3.1" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="A1.E14.m1.4.4.1.1" xref="A1.E14.m1.4.4.1.1.cmml">j</mi><mo stretchy="false" id="A1.E14.m1.4.4.1.3.2" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo stretchy="false" id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="A1.E14.m1.5.5.1.1.1.1.1.1.1.3" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="A1.E14.m1.5.5.1.2" xref="A1.E14.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E14.m1.5b"><apply id="A1.E14.m1.5.5.1.1.cmml" xref="A1.E14.m1.5.5.1"><eq id="A1.E14.m1.5.5.1.1.2.cmml" xref="A1.E14.m1.5.5.1.1.2"></eq><apply id="A1.E14.m1.5.5.1.1.3.cmml" xref="A1.E14.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="A1.E14.m1.5.5.1.1.3.1.cmml" xref="A1.E14.m1.5.5.1.1.3">superscript</csymbol><apply id="A1.E14.m1.5.5.1.1.3.2.cmml" xref="A1.E14.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="A1.E14.m1.5.5.1.1.3.2.1.cmml" xref="A1.E14.m1.5.5.1.1.3">subscript</csymbol><ci id="A1.E14.m1.5.5.1.1.3.2.2.cmml" xref="A1.E14.m1.5.5.1.1.3.2.2">𝜃</ci><ci id="A1.E14.m1.5.5.1.1.3.2.3.cmml" xref="A1.E14.m1.5.5.1.1.3.2.3">𝐺</ci></apply><times id="A1.E14.m1.5.5.1.1.3.3.cmml" xref="A1.E14.m1.5.5.1.1.3.3"></times></apply><apply id="A1.E14.m1.5.5.1.1.1.cmml" xref="A1.E14.m1.5.5.1.1.1"><times id="A1.E14.m1.5.5.1.1.1.2.cmml" xref="A1.E14.m1.5.5.1.1.1.2"></times><apply id="A1.E14.m1.5.5.1.1.1.3.cmml" xref="A1.E14.m1.5.5.1.1.1.3"><arg id="A1.E14.m1.5.5.1.1.1.3.1.cmml" xref="A1.E14.m1.5.5.1.1.1.3.1"></arg><apply id="A1.E14.m1.5.5.1.1.1.3.2.cmml" xref="A1.E14.m1.5.5.1.1.1.3.2"><apply id="A1.E14.m1.5.5.1.1.1.3.2.1.cmml" xref="A1.E14.m1.5.5.1.1.1.3.2.1"><csymbol cd="ambiguous" id="A1.E14.m1.5.5.1.1.1.3.2.1.1.cmml" xref="A1.E14.m1.5.5.1.1.1.3.2.1">subscript</csymbol><min id="A1.E14.m1.5.5.1.1.1.3.2.1.2.cmml" xref="A1.E14.m1.5.5.1.1.1.3.2.1.2"></min><ci id="A1.E14.m1.5.5.1.1.1.3.2.1.3.cmml" xref="A1.E14.m1.5.5.1.1.1.3.2.1.3">𝜃</ci></apply><apply id="A1.E14.m1.5.5.1.1.1.3.2.2.cmml" xref="A1.E14.m1.5.5.1.1.1.3.2.2"><divide id="A1.E14.m1.5.5.1.1.1.3.2.2.1.cmml" xref="A1.E14.m1.5.5.1.1.1.3.2.2"></divide><cn type="integer" id="A1.E14.m1.5.5.1.1.1.3.2.2.2.cmml" xref="A1.E14.m1.5.5.1.1.1.3.2.2.2">1</cn><apply id="A1.E14.m1.5.5.1.1.1.3.2.2.3.cmml" xref="A1.E14.m1.5.5.1.1.1.3.2.2.3"><times id="A1.E14.m1.5.5.1.1.1.3.2.2.3.1.cmml" xref="A1.E14.m1.5.5.1.1.1.3.2.2.3.1"></times><cn type="integer" id="A1.E14.m1.5.5.1.1.1.3.2.2.3.2.cmml" xref="A1.E14.m1.5.5.1.1.1.3.2.2.3.2">2</cn><ci id="A1.E14.m1.5.5.1.1.1.3.2.2.3.3.cmml" xref="A1.E14.m1.5.5.1.1.1.3.2.2.3.3">𝑁</ci></apply></apply></apply></apply><apply id="A1.E14.m1.5.5.1.1.1.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1"><apply id="A1.E14.m1.5.5.1.1.1.1.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E14.m1.5.5.1.1.1.1.2.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2">superscript</csymbol><apply id="A1.E14.m1.5.5.1.1.1.1.2.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E14.m1.5.5.1.1.1.1.2.2.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2">subscript</csymbol><sum id="A1.E14.m1.5.5.1.1.1.1.2.2.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.2.2"></sum><apply id="A1.E14.m1.5.5.1.1.1.1.2.2.3.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.2.3"><eq id="A1.E14.m1.5.5.1.1.1.1.2.2.3.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.2.3.1"></eq><ci id="A1.E14.m1.5.5.1.1.1.1.2.2.3.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="A1.E14.m1.5.5.1.1.1.1.2.2.3.3.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="A1.E14.m1.5.5.1.1.1.1.2.3.cmml" xref="A1.E14.m1.5.5.1.1.1.1.2.3">𝑁</ci></apply><apply id="A1.E14.m1.5.5.1.1.1.1.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1"><apply id="A1.E14.m1.5.5.1.1.1.1.1.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E14.m1.5.5.1.1.1.1.1.2.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.2">superscript</csymbol><apply id="A1.E14.m1.5.5.1.1.1.1.1.2.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E14.m1.5.5.1.1.1.1.1.2.2.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.2">subscript</csymbol><sum id="A1.E14.m1.5.5.1.1.1.1.1.2.2.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.2.2.2"></sum><apply id="A1.E14.m1.5.5.1.1.1.1.1.2.2.3.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.2.2.3"><eq id="A1.E14.m1.5.5.1.1.1.1.1.2.2.3.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.2.2.3.1"></eq><ci id="A1.E14.m1.5.5.1.1.1.1.1.2.2.3.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="A1.E14.m1.5.5.1.1.1.1.1.2.2.3.3.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="A1.E14.m1.1.1.1.2.cmml" xref="A1.E14.m1.1.1.1.1"><abs id="A1.E14.m1.1.1.1.2.1.cmml" xref="A1.E14.m1.1.1.1.1.2"></abs><apply id="A1.E14.m1.1.1.1.1.1.cmml" xref="A1.E14.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E14.m1.1.1.1.1.1.1.cmml" xref="A1.E14.m1.1.1.1.1.1">subscript</csymbol><ci id="A1.E14.m1.1.1.1.1.1.2.cmml" xref="A1.E14.m1.1.1.1.1.1.2">𝜃</ci><ci id="A1.E14.m1.1.1.1.1.1.3.cmml" xref="A1.E14.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="A1.E14.m1.5.5.1.1.1.1.1.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1"><times id="A1.E14.m1.5.5.1.1.1.1.1.1.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1.2"></times><apply id="A1.E14.m1.5.5.1.1.1.1.1.1.3.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E14.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1.3">superscript</csymbol><apply id="A1.E14.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E14.m1.5.5.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E14.m1.5.5.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1.3.2.2">𝐹</ci><ci id="A1.E14.m1.5.5.1.1.1.1.1.1.3.2.3.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="A1.E14.m1.2.2.1.1.cmml" xref="A1.E14.m1.2.2.1.1">𝑗</ci></apply><apply id="A1.E14.m1.5.5.1.1.1.1.1.1.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E14.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1"><minus id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2">𝜃</ci><ci id="A1.E14.m1.3.3.1.1.cmml" xref="A1.E14.m1.3.3.1.1">𝑗</ci></apply><apply id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.2">𝜃</ci><ci id="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="A1.E14.m1.4.4.1.1.cmml" xref="A1.E14.m1.4.4.1.1">𝑗</ci></apply></apply><cn type="integer" id="A1.E14.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="A1.E14.m1.5.5.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E14.m1.5c">{\mathbf{\theta}}_{G}^{*}=\arg\min_{{\mathbf{\theta}}}\frac{1}{2N}\sum_{i=1}^{N}\sum_{j=1}^{|{\mathbf{\theta}}_{i}|}F_{i}^{(j)}({\mathbf{\theta}}^{(j)}-{\mathbf{\theta}}_{i}^{(j)})^{2}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p id="A1.SS2.p10.2" class="ltx_p"><a href="#S3.E4" title="In 3 FedFish Algorithm ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">4</span></a> is now a convex optimization problem, which we can solve by taking its gradient with respect to <math id="A1.SS2.p10.1.m1.1" class="ltx_Math" alttext="{\mathbf{\theta}}" display="inline"><semantics id="A1.SS2.p10.1.m1.1a"><mi id="A1.SS2.p10.1.m1.1.1" xref="A1.SS2.p10.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p10.1.m1.1b"><ci id="A1.SS2.p10.1.m1.1.1.cmml" xref="A1.SS2.p10.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p10.1.m1.1c">{\mathbf{\theta}}</annotation></semantics></math> and setting it to <math id="A1.SS2.p10.2.m2.1" class="ltx_Math" alttext="0" display="inline"><semantics id="A1.SS2.p10.2.m2.1a"><mn id="A1.SS2.p10.2.m2.1.1" xref="A1.SS2.p10.2.m2.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="A1.SS2.p10.2.m2.1b"><cn type="integer" id="A1.SS2.p10.2.m2.1.1.cmml" xref="A1.SS2.p10.2.m2.1.1">0</cn></annotation-xml></semantics></math>. It has the following closed-form solution:</p>
</div>
<div id="A1.SS2.p11" class="ltx_para ltx_noindent">
<table id="A1.E15" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E15.m1.3" class="ltx_Math" alttext="{\mathbf{\theta}}_{G}^{*}=\frac{\sum_{i=1}^{N}\text{diag}(F_{i})^{T}{\mathbf{\theta}}_{i}}{\sum_{i=1}^{N}\text{diag}(F_{i})}," display="block"><semantics id="A1.E15.m1.3a"><mrow id="A1.E15.m1.3.3.1" xref="A1.E15.m1.3.3.1.1.cmml"><mrow id="A1.E15.m1.3.3.1.1" xref="A1.E15.m1.3.3.1.1.cmml"><msubsup id="A1.E15.m1.3.3.1.1.2" xref="A1.E15.m1.3.3.1.1.2.cmml"><mi id="A1.E15.m1.3.3.1.1.2.2.2" xref="A1.E15.m1.3.3.1.1.2.2.2.cmml">θ</mi><mi id="A1.E15.m1.3.3.1.1.2.2.3" xref="A1.E15.m1.3.3.1.1.2.2.3.cmml">G</mi><mo id="A1.E15.m1.3.3.1.1.2.3" xref="A1.E15.m1.3.3.1.1.2.3.cmml">∗</mo></msubsup><mo id="A1.E15.m1.3.3.1.1.1" xref="A1.E15.m1.3.3.1.1.1.cmml">=</mo><mfrac id="A1.E15.m1.2.2" xref="A1.E15.m1.2.2.cmml"><mrow id="A1.E15.m1.1.1.1" xref="A1.E15.m1.1.1.1.cmml"><msubsup id="A1.E15.m1.1.1.1.2" xref="A1.E15.m1.1.1.1.2.cmml"><mo id="A1.E15.m1.1.1.1.2.2.2" xref="A1.E15.m1.1.1.1.2.2.2.cmml">∑</mo><mrow id="A1.E15.m1.1.1.1.2.2.3" xref="A1.E15.m1.1.1.1.2.2.3.cmml"><mi id="A1.E15.m1.1.1.1.2.2.3.2" xref="A1.E15.m1.1.1.1.2.2.3.2.cmml">i</mi><mo id="A1.E15.m1.1.1.1.2.2.3.1" xref="A1.E15.m1.1.1.1.2.2.3.1.cmml">=</mo><mn id="A1.E15.m1.1.1.1.2.2.3.3" xref="A1.E15.m1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="A1.E15.m1.1.1.1.2.3" xref="A1.E15.m1.1.1.1.2.3.cmml">N</mi></msubsup><mrow id="A1.E15.m1.1.1.1.1" xref="A1.E15.m1.1.1.1.1.cmml"><mtext id="A1.E15.m1.1.1.1.1.3" xref="A1.E15.m1.1.1.1.1.3a.cmml">diag</mtext><mo lspace="0em" rspace="0em" id="A1.E15.m1.1.1.1.1.2" xref="A1.E15.m1.1.1.1.1.2.cmml">​</mo><msup id="A1.E15.m1.1.1.1.1.1" xref="A1.E15.m1.1.1.1.1.1.cmml"><mrow id="A1.E15.m1.1.1.1.1.1.1.1" xref="A1.E15.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.E15.m1.1.1.1.1.1.1.1.2" xref="A1.E15.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E15.m1.1.1.1.1.1.1.1.1" xref="A1.E15.m1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E15.m1.1.1.1.1.1.1.1.1.2" xref="A1.E15.m1.1.1.1.1.1.1.1.1.2.cmml">F</mi><mi id="A1.E15.m1.1.1.1.1.1.1.1.1.3" xref="A1.E15.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A1.E15.m1.1.1.1.1.1.1.1.3" xref="A1.E15.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="A1.E15.m1.1.1.1.1.1.3" xref="A1.E15.m1.1.1.1.1.1.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="A1.E15.m1.1.1.1.1.2a" xref="A1.E15.m1.1.1.1.1.2.cmml">​</mo><msub id="A1.E15.m1.1.1.1.1.4" xref="A1.E15.m1.1.1.1.1.4.cmml"><mi id="A1.E15.m1.1.1.1.1.4.2" xref="A1.E15.m1.1.1.1.1.4.2.cmml">θ</mi><mi id="A1.E15.m1.1.1.1.1.4.3" xref="A1.E15.m1.1.1.1.1.4.3.cmml">i</mi></msub></mrow></mrow><mrow id="A1.E15.m1.2.2.2" xref="A1.E15.m1.2.2.2.cmml"><msubsup id="A1.E15.m1.2.2.2.2" xref="A1.E15.m1.2.2.2.2.cmml"><mo id="A1.E15.m1.2.2.2.2.2.2" xref="A1.E15.m1.2.2.2.2.2.2.cmml">∑</mo><mrow id="A1.E15.m1.2.2.2.2.2.3" xref="A1.E15.m1.2.2.2.2.2.3.cmml"><mi id="A1.E15.m1.2.2.2.2.2.3.2" xref="A1.E15.m1.2.2.2.2.2.3.2.cmml">i</mi><mo id="A1.E15.m1.2.2.2.2.2.3.1" xref="A1.E15.m1.2.2.2.2.2.3.1.cmml">=</mo><mn id="A1.E15.m1.2.2.2.2.2.3.3" xref="A1.E15.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="A1.E15.m1.2.2.2.2.3" xref="A1.E15.m1.2.2.2.2.3.cmml">N</mi></msubsup><mrow id="A1.E15.m1.2.2.2.1" xref="A1.E15.m1.2.2.2.1.cmml"><mtext id="A1.E15.m1.2.2.2.1.3" xref="A1.E15.m1.2.2.2.1.3a.cmml">diag</mtext><mo lspace="0em" rspace="0em" id="A1.E15.m1.2.2.2.1.2" xref="A1.E15.m1.2.2.2.1.2.cmml">​</mo><mrow id="A1.E15.m1.2.2.2.1.1.1" xref="A1.E15.m1.2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="A1.E15.m1.2.2.2.1.1.1.2" xref="A1.E15.m1.2.2.2.1.1.1.1.cmml">(</mo><msub id="A1.E15.m1.2.2.2.1.1.1.1" xref="A1.E15.m1.2.2.2.1.1.1.1.cmml"><mi id="A1.E15.m1.2.2.2.1.1.1.1.2" xref="A1.E15.m1.2.2.2.1.1.1.1.2.cmml">F</mi><mi id="A1.E15.m1.2.2.2.1.1.1.1.3" xref="A1.E15.m1.2.2.2.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A1.E15.m1.2.2.2.1.1.1.3" xref="A1.E15.m1.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="A1.E15.m1.3.3.1.2" xref="A1.E15.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E15.m1.3b"><apply id="A1.E15.m1.3.3.1.1.cmml" xref="A1.E15.m1.3.3.1"><eq id="A1.E15.m1.3.3.1.1.1.cmml" xref="A1.E15.m1.3.3.1.1.1"></eq><apply id="A1.E15.m1.3.3.1.1.2.cmml" xref="A1.E15.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="A1.E15.m1.3.3.1.1.2.1.cmml" xref="A1.E15.m1.3.3.1.1.2">superscript</csymbol><apply id="A1.E15.m1.3.3.1.1.2.2.cmml" xref="A1.E15.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="A1.E15.m1.3.3.1.1.2.2.1.cmml" xref="A1.E15.m1.3.3.1.1.2">subscript</csymbol><ci id="A1.E15.m1.3.3.1.1.2.2.2.cmml" xref="A1.E15.m1.3.3.1.1.2.2.2">𝜃</ci><ci id="A1.E15.m1.3.3.1.1.2.2.3.cmml" xref="A1.E15.m1.3.3.1.1.2.2.3">𝐺</ci></apply><times id="A1.E15.m1.3.3.1.1.2.3.cmml" xref="A1.E15.m1.3.3.1.1.2.3"></times></apply><apply id="A1.E15.m1.2.2.cmml" xref="A1.E15.m1.2.2"><divide id="A1.E15.m1.2.2.3.cmml" xref="A1.E15.m1.2.2"></divide><apply id="A1.E15.m1.1.1.1.cmml" xref="A1.E15.m1.1.1.1"><apply id="A1.E15.m1.1.1.1.2.cmml" xref="A1.E15.m1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E15.m1.1.1.1.2.1.cmml" xref="A1.E15.m1.1.1.1.2">superscript</csymbol><apply id="A1.E15.m1.1.1.1.2.2.cmml" xref="A1.E15.m1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E15.m1.1.1.1.2.2.1.cmml" xref="A1.E15.m1.1.1.1.2">subscript</csymbol><sum id="A1.E15.m1.1.1.1.2.2.2.cmml" xref="A1.E15.m1.1.1.1.2.2.2"></sum><apply id="A1.E15.m1.1.1.1.2.2.3.cmml" xref="A1.E15.m1.1.1.1.2.2.3"><eq id="A1.E15.m1.1.1.1.2.2.3.1.cmml" xref="A1.E15.m1.1.1.1.2.2.3.1"></eq><ci id="A1.E15.m1.1.1.1.2.2.3.2.cmml" xref="A1.E15.m1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="A1.E15.m1.1.1.1.2.2.3.3.cmml" xref="A1.E15.m1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="A1.E15.m1.1.1.1.2.3.cmml" xref="A1.E15.m1.1.1.1.2.3">𝑁</ci></apply><apply id="A1.E15.m1.1.1.1.1.cmml" xref="A1.E15.m1.1.1.1.1"><times id="A1.E15.m1.1.1.1.1.2.cmml" xref="A1.E15.m1.1.1.1.1.2"></times><ci id="A1.E15.m1.1.1.1.1.3a.cmml" xref="A1.E15.m1.1.1.1.1.3"><mtext id="A1.E15.m1.1.1.1.1.3.cmml" xref="A1.E15.m1.1.1.1.1.3">diag</mtext></ci><apply id="A1.E15.m1.1.1.1.1.1.cmml" xref="A1.E15.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E15.m1.1.1.1.1.1.2.cmml" xref="A1.E15.m1.1.1.1.1.1">superscript</csymbol><apply id="A1.E15.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E15.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E15.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E15.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E15.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E15.m1.1.1.1.1.1.1.1.1.2">𝐹</ci><ci id="A1.E15.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E15.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="A1.E15.m1.1.1.1.1.1.3.cmml" xref="A1.E15.m1.1.1.1.1.1.3">𝑇</ci></apply><apply id="A1.E15.m1.1.1.1.1.4.cmml" xref="A1.E15.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.E15.m1.1.1.1.1.4.1.cmml" xref="A1.E15.m1.1.1.1.1.4">subscript</csymbol><ci id="A1.E15.m1.1.1.1.1.4.2.cmml" xref="A1.E15.m1.1.1.1.1.4.2">𝜃</ci><ci id="A1.E15.m1.1.1.1.1.4.3.cmml" xref="A1.E15.m1.1.1.1.1.4.3">𝑖</ci></apply></apply></apply><apply id="A1.E15.m1.2.2.2.cmml" xref="A1.E15.m1.2.2.2"><apply id="A1.E15.m1.2.2.2.2.cmml" xref="A1.E15.m1.2.2.2.2"><csymbol cd="ambiguous" id="A1.E15.m1.2.2.2.2.1.cmml" xref="A1.E15.m1.2.2.2.2">superscript</csymbol><apply id="A1.E15.m1.2.2.2.2.2.cmml" xref="A1.E15.m1.2.2.2.2"><csymbol cd="ambiguous" id="A1.E15.m1.2.2.2.2.2.1.cmml" xref="A1.E15.m1.2.2.2.2">subscript</csymbol><sum id="A1.E15.m1.2.2.2.2.2.2.cmml" xref="A1.E15.m1.2.2.2.2.2.2"></sum><apply id="A1.E15.m1.2.2.2.2.2.3.cmml" xref="A1.E15.m1.2.2.2.2.2.3"><eq id="A1.E15.m1.2.2.2.2.2.3.1.cmml" xref="A1.E15.m1.2.2.2.2.2.3.1"></eq><ci id="A1.E15.m1.2.2.2.2.2.3.2.cmml" xref="A1.E15.m1.2.2.2.2.2.3.2">𝑖</ci><cn type="integer" id="A1.E15.m1.2.2.2.2.2.3.3.cmml" xref="A1.E15.m1.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="A1.E15.m1.2.2.2.2.3.cmml" xref="A1.E15.m1.2.2.2.2.3">𝑁</ci></apply><apply id="A1.E15.m1.2.2.2.1.cmml" xref="A1.E15.m1.2.2.2.1"><times id="A1.E15.m1.2.2.2.1.2.cmml" xref="A1.E15.m1.2.2.2.1.2"></times><ci id="A1.E15.m1.2.2.2.1.3a.cmml" xref="A1.E15.m1.2.2.2.1.3"><mtext id="A1.E15.m1.2.2.2.1.3.cmml" xref="A1.E15.m1.2.2.2.1.3">diag</mtext></ci><apply id="A1.E15.m1.2.2.2.1.1.1.1.cmml" xref="A1.E15.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E15.m1.2.2.2.1.1.1.1.1.cmml" xref="A1.E15.m1.2.2.2.1.1.1">subscript</csymbol><ci id="A1.E15.m1.2.2.2.1.1.1.1.2.cmml" xref="A1.E15.m1.2.2.2.1.1.1.1.2">𝐹</ci><ci id="A1.E15.m1.2.2.2.1.1.1.1.3.cmml" xref="A1.E15.m1.2.2.2.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E15.m1.3c">{\mathbf{\theta}}_{G}^{*}=\frac{\sum_{i=1}^{N}\text{diag}(F_{i})^{T}{\mathbf{\theta}}_{i}}{\sum_{i=1}^{N}\text{diag}(F_{i})},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="A1.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Experimental Details</h3>

<section id="A1.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.3.1 </span>Datasets, Tasks &amp; Models</h4>

<div id="A1.SS3.SSS1.p1" class="ltx_para ltx_noindent">
<p id="A1.SS3.SSS1.p1.1" class="ltx_p">We use four datasets for training models using <span id="A1.SS3.SSS1.p1.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> and <span id="A1.SS3.SSS1.p1.1.2" class="ltx_text ltx_font_smallcaps">FedFish</span>: the federated extended MNIST dataset (EMNIST) <cite class="ltx_cite ltx_citemacro_citep">(Cohen et al., <a href="#bib.bib9" title="" class="ltx_ref">2017</a>)</cite>, the CIFAR100 dataset <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib25" title="" class="ltx_ref">Krizhevsky et al., </a>)</cite>, the Stack Overflow dataset <cite class="ltx_cite ltx_citemacro_citep">(Authors, <a href="#bib.bib3" title="" class="ltx_ref">2019</a>)</cite> and the C4 dataset <cite class="ltx_cite ltx_citemacro_citep">(Raffel et al., <a href="#bib.bib36" title="" class="ltx_ref">2020</a>)</cite>. We additionally use the CC-News <cite class="ltx_cite ltx_citemacro_citep">(Hamborg et al., <a href="#bib.bib19" title="" class="ltx_ref">2017</a>)</cite> and Stack Overflow datasets for evaluating transfer and post-personalization performance of models trained on C4 using each algorithm of study.</p>
</div>
<div id="A1.SS3.SSS1.p2" class="ltx_para ltx_noindent">
<p id="A1.SS3.SSS1.p2.1" class="ltx_p">Each of these datasets is publicly available. EMNIST is licensed under Standard Reference Data by NIST. CIFAR100 is published by the authors. Stack Overflow is licensed under the Creative Commons Attribution-ShareAlike 3.0 Unported License. C4 and CC-News are hosted by <span class="ltx_ref ltx_font_typewriter ltx_ref_self">commoncrawl.org</span> and we access both through HuggingFace datasets.</p>
</div>
<div id="A1.SS3.SSS1.p3" class="ltx_para ltx_noindent">
<p id="A1.SS3.SSS1.p3.1" class="ltx_p"><a href="#A1.T1" title="In A.3.1 Datasets, Tasks &amp; Models ‣ A.3 Experimental Details ‣ Appendix A Appendix ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">1</span></a> lists the scale of each dataset, the associated task and the model used for training. We include additional details on dataset preprocessing and model configuration for each experiment setting below.</p>
</div>
<figure id="A1.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Datasets, Tasks &amp; Models</figcaption>
<br class="ltx_break">
<table id="A1.T1.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A1.T1.1.1.1" class="ltx_tr">
<td id="A1.T1.1.1.1.1" class="ltx_td ltx_align_left ltx_border_tt" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Dataset</span></td>
<td id="A1.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:2.25pt;padding-bottom:2.25pt;" colspan="2"><span id="A1.T1.1.1.1.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Num Clients</span></td>
<td id="A1.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:2.25pt;padding-bottom:2.25pt;" colspan="2"><span id="A1.T1.1.1.1.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Num Examples</span></td>
<td id="A1.T1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.1.1.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Task</span></td>
<td id="A1.T1.1.1.1.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.1.1.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Model</span></td>
</tr>
<tr id="A1.T1.1.2.2" class="ltx_tr">
<td id="A1.T1.1.2.2.1" class="ltx_td" style="padding-top:2.25pt;padding-bottom:2.25pt;"></td>
<td id="A1.T1.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.2.2.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Train</span></td>
<td id="A1.T1.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.2.2.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Test</span></td>
<td id="A1.T1.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.2.2.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Train</span></td>
<td id="A1.T1.1.2.2.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.2.2.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Test</span></td>
<td id="A1.T1.1.2.2.6" class="ltx_td" style="padding-top:2.25pt;padding-bottom:2.25pt;"></td>
<td id="A1.T1.1.2.2.7" class="ltx_td" style="padding-top:2.25pt;padding-bottom:2.25pt;"></td>
</tr>
<tr id="A1.T1.1.3.3" class="ltx_tr">
<td id="A1.T1.1.3.3.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.3.3.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">EMNIST</span></td>
<td id="A1.T1.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.3.3.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">3.4K</span></td>
<td id="A1.T1.1.3.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.3.3.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">3.4K</span></td>
<td id="A1.T1.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.3.3.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">672K</span></td>
<td id="A1.T1.1.3.3.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.3.3.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">77K</span></td>
<td id="A1.T1.1.3.3.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;">
<table id="A1.T1.1.3.3.6.1" class="ltx_tabular ltx_align_middle">
<tr id="A1.T1.1.3.3.6.1.1" class="ltx_tr">
<td id="A1.T1.1.3.3.6.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.3.3.6.1.1.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Character</span></td>
</tr>
<tr id="A1.T1.1.3.3.6.1.2" class="ltx_tr">
<td id="A1.T1.1.3.3.6.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.3.3.6.1.2.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Recognition</span></td>
</tr>
</table>
</td>
<td id="A1.T1.1.3.3.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.3.3.7.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">CNN</span></td>
</tr>
<tr id="A1.T1.1.4.4" class="ltx_tr">
<td id="A1.T1.1.4.4.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.4.4.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">CIFAR100</span></td>
<td id="A1.T1.1.4.4.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.4.4.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">500</span></td>
<td id="A1.T1.1.4.4.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.4.4.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">100</span></td>
<td id="A1.T1.1.4.4.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.4.4.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">50K</span></td>
<td id="A1.T1.1.4.4.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.4.4.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">10K</span></td>
<td id="A1.T1.1.4.4.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;">
<table id="A1.T1.1.4.4.6.1" class="ltx_tabular ltx_align_middle">
<tr id="A1.T1.1.4.4.6.1.1" class="ltx_tr">
<td id="A1.T1.1.4.4.6.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.4.4.6.1.1.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Image</span></td>
</tr>
<tr id="A1.T1.1.4.4.6.1.2" class="ltx_tr">
<td id="A1.T1.1.4.4.6.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.4.4.6.1.2.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Recognition</span></td>
</tr>
</table>
</td>
<td id="A1.T1.1.4.4.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;">
<table id="A1.T1.1.4.4.7.1" class="ltx_tabular ltx_align_middle">
<tr id="A1.T1.1.4.4.7.1.1" class="ltx_tr">
<td id="A1.T1.1.4.4.7.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.4.4.7.1.1.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">ResNet-18</span></td>
</tr>
<tr id="A1.T1.1.4.4.7.1.2" class="ltx_tr">
<td id="A1.T1.1.4.4.7.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.4.4.7.1.2.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">with GroupNorm</span></td>
</tr>
</table>
</td>
</tr>
<tr id="A1.T1.1.5.5" class="ltx_tr">
<td id="A1.T1.1.5.5.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;">
<table id="A1.T1.1.5.5.1.1" class="ltx_tabular ltx_align_middle">
<tr id="A1.T1.1.5.5.1.1.1" class="ltx_tr">
<td id="A1.T1.1.5.5.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.5.5.1.1.1.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Stack</span></td>
</tr>
<tr id="A1.T1.1.5.5.1.1.2" class="ltx_tr">
<td id="A1.T1.1.5.5.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.5.5.1.1.2.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Overflow</span></td>
</tr>
</table>
</td>
<td id="A1.T1.1.5.5.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.5.5.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">342K</span></td>
<td id="A1.T1.1.5.5.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.5.5.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">204K</span></td>
<td id="A1.T1.1.5.5.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.5.5.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">135.8M</span></td>
<td id="A1.T1.1.5.5.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.5.5.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">16.6M</span></td>
<td id="A1.T1.1.5.5.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;">
<table id="A1.T1.1.5.5.6.1" class="ltx_tabular ltx_align_middle">
<tr id="A1.T1.1.5.5.6.1.1" class="ltx_tr">
<td id="A1.T1.1.5.5.6.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.5.5.6.1.1.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Next-Token</span></td>
</tr>
<tr id="A1.T1.1.5.5.6.1.2" class="ltx_tr">
<td id="A1.T1.1.5.5.6.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.5.5.6.1.2.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Prediction</span></td>
</tr>
</table>
</td>
<td id="A1.T1.1.5.5.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;">
<table id="A1.T1.1.5.5.7.1" class="ltx_tabular ltx_align_middle">
<tr id="A1.T1.1.5.5.7.1.1" class="ltx_tr">
<td id="A1.T1.1.5.5.7.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.5.5.7.1.1.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">350M Parameter</span></td>
</tr>
<tr id="A1.T1.1.5.5.7.1.2" class="ltx_tr">
<td id="A1.T1.1.5.5.7.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.5.5.7.1.2.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Decoder-only Transformer</span></td>
</tr>
</table>
</td>
</tr>
<tr id="A1.T1.1.6.6" class="ltx_tr">
<td id="A1.T1.1.6.6.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;">
<table id="A1.T1.1.6.6.1.1" class="ltx_tabular ltx_align_middle">
<tr id="A1.T1.1.6.6.1.1.1" class="ltx_tr">
<td id="A1.T1.1.6.6.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.6.6.1.1.1.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">C4</span></td>
</tr>
</table>
</td>
<td id="A1.T1.1.6.6.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.6.6.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">15.6M</span></td>
<td id="A1.T1.1.6.6.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.6.6.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">8.5K</span></td>
<td id="A1.T1.1.6.6.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.6.6.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">364.9M</span></td>
<td id="A1.T1.1.6.6.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.6.6.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">365K</span></td>
<td id="A1.T1.1.6.6.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;">
<table id="A1.T1.1.6.6.6.1" class="ltx_tabular ltx_align_middle">
<tr id="A1.T1.1.6.6.6.1.1" class="ltx_tr">
<td id="A1.T1.1.6.6.6.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.6.6.6.1.1.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Next-Token</span></td>
</tr>
<tr id="A1.T1.1.6.6.6.1.2" class="ltx_tr">
<td id="A1.T1.1.6.6.6.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.6.6.6.1.2.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Prediction</span></td>
</tr>
</table>
</td>
<td id="A1.T1.1.6.6.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;">
<table id="A1.T1.1.6.6.7.1" class="ltx_tabular ltx_align_middle">
<tr id="A1.T1.1.6.6.7.1.1" class="ltx_tr">
<td id="A1.T1.1.6.6.7.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.6.6.7.1.1.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">1.5B Parameter</span></td>
</tr>
<tr id="A1.T1.1.6.6.7.1.2" class="ltx_tr">
<td id="A1.T1.1.6.6.7.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.6.6.7.1.2.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Decoder-only Transformer</span></td>
</tr>
</table>
</td>
</tr>
<tr id="A1.T1.1.7.7" class="ltx_tr">
<td id="A1.T1.1.7.7.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;">
<table id="A1.T1.1.7.7.1.1" class="ltx_tabular ltx_align_middle">
<tr id="A1.T1.1.7.7.1.1.1" class="ltx_tr">
<td id="A1.T1.1.7.7.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.7.7.1.1.1.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">CC-News</span></td>
</tr>
</table>
</td>
<td id="A1.T1.1.7.7.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.7.7.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">–</span></td>
<td id="A1.T1.1.7.7.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.7.7.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">8.8K</span></td>
<td id="A1.T1.1.7.7.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.7.7.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">–</span></td>
<td id="A1.T1.1.7.7.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.7.7.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">708K</span></td>
<td id="A1.T1.1.7.7.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;">
<table id="A1.T1.1.7.7.6.1" class="ltx_tabular ltx_align_middle">
<tr id="A1.T1.1.7.7.6.1.1" class="ltx_tr">
<td id="A1.T1.1.7.7.6.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.7.7.6.1.1.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Next-Token</span></td>
</tr>
<tr id="A1.T1.1.7.7.6.1.2" class="ltx_tr">
<td id="A1.T1.1.7.7.6.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.7.7.6.1.2.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Prediction</span></td>
</tr>
</table>
</td>
<td id="A1.T1.1.7.7.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:2.25pt;padding-bottom:2.25pt;">
<table id="A1.T1.1.7.7.7.1" class="ltx_tabular ltx_align_middle">
<tr id="A1.T1.1.7.7.7.1.1" class="ltx_tr">
<td id="A1.T1.1.7.7.7.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.7.7.7.1.1.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">1.5B Parameter</span></td>
</tr>
<tr id="A1.T1.1.7.7.7.1.2" class="ltx_tr">
<td id="A1.T1.1.7.7.7.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.25pt;padding-bottom:2.25pt;"><span id="A1.T1.1.7.7.7.1.2.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Decoder-only Transformer</span></td>
</tr>
</table>
</td>
</tr>
</tbody>
</table>
</figure>
<section id="A1.SS3.SSS1.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">EMNIST</h5>

<div id="A1.SS3.SSS1.Px1.p1" class="ltx_para ltx_noindent">
<p id="A1.SS3.SSS1.Px1.p1.2" class="ltx_p">The EMNIST dataset is comprised of 28x28 grey-scale pixel images of alphanumeric handwritten characters. There are 62 characters represented. The dataset has natural heterogeneity stemming from characters being written by different authors. We partition the handwritten characters in EMNIST according to their author, as proposed by <cite class="ltx_cite ltx_citemacro_citet">Caldas et al. (<a href="#bib.bib5" title="" class="ltx_ref">2018</a>)</cite>. We train a two-layer LeNet CNN model <cite class="ltx_cite ltx_citemacro_citep">(Lecun et al., <a href="#bib.bib27" title="" class="ltx_ref">1998</a>)</cite> for character recognition: two convolutional layers with 3x3 kernels and strides of length 1, a max pooling layer using dropout with <math id="A1.SS3.SSS1.Px1.p1.1.m1.1" class="ltx_Math" alttext="p=0.25" display="inline"><semantics id="A1.SS3.SSS1.Px1.p1.1.m1.1a"><mrow id="A1.SS3.SSS1.Px1.p1.1.m1.1.1" xref="A1.SS3.SSS1.Px1.p1.1.m1.1.1.cmml"><mi id="A1.SS3.SSS1.Px1.p1.1.m1.1.1.2" xref="A1.SS3.SSS1.Px1.p1.1.m1.1.1.2.cmml">p</mi><mo id="A1.SS3.SSS1.Px1.p1.1.m1.1.1.1" xref="A1.SS3.SSS1.Px1.p1.1.m1.1.1.1.cmml">=</mo><mn id="A1.SS3.SSS1.Px1.p1.1.m1.1.1.3" xref="A1.SS3.SSS1.Px1.p1.1.m1.1.1.3.cmml">0.25</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS1.Px1.p1.1.m1.1b"><apply id="A1.SS3.SSS1.Px1.p1.1.m1.1.1.cmml" xref="A1.SS3.SSS1.Px1.p1.1.m1.1.1"><eq id="A1.SS3.SSS1.Px1.p1.1.m1.1.1.1.cmml" xref="A1.SS3.SSS1.Px1.p1.1.m1.1.1.1"></eq><ci id="A1.SS3.SSS1.Px1.p1.1.m1.1.1.2.cmml" xref="A1.SS3.SSS1.Px1.p1.1.m1.1.1.2">𝑝</ci><cn type="float" id="A1.SS3.SSS1.Px1.p1.1.m1.1.1.3.cmml" xref="A1.SS3.SSS1.Px1.p1.1.m1.1.1.3">0.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS1.Px1.p1.1.m1.1c">p=0.25</annotation></semantics></math>, a dense layer with 128 units and dropout with <math id="A1.SS3.SSS1.Px1.p1.2.m2.1" class="ltx_Math" alttext="p=0.5" display="inline"><semantics id="A1.SS3.SSS1.Px1.p1.2.m2.1a"><mrow id="A1.SS3.SSS1.Px1.p1.2.m2.1.1" xref="A1.SS3.SSS1.Px1.p1.2.m2.1.1.cmml"><mi id="A1.SS3.SSS1.Px1.p1.2.m2.1.1.2" xref="A1.SS3.SSS1.Px1.p1.2.m2.1.1.2.cmml">p</mi><mo id="A1.SS3.SSS1.Px1.p1.2.m2.1.1.1" xref="A1.SS3.SSS1.Px1.p1.2.m2.1.1.1.cmml">=</mo><mn id="A1.SS3.SSS1.Px1.p1.2.m2.1.1.3" xref="A1.SS3.SSS1.Px1.p1.2.m2.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS1.Px1.p1.2.m2.1b"><apply id="A1.SS3.SSS1.Px1.p1.2.m2.1.1.cmml" xref="A1.SS3.SSS1.Px1.p1.2.m2.1.1"><eq id="A1.SS3.SSS1.Px1.p1.2.m2.1.1.1.cmml" xref="A1.SS3.SSS1.Px1.p1.2.m2.1.1.1"></eq><ci id="A1.SS3.SSS1.Px1.p1.2.m2.1.1.2.cmml" xref="A1.SS3.SSS1.Px1.p1.2.m2.1.1.2">𝑝</ci><cn type="float" id="A1.SS3.SSS1.Px1.p1.2.m2.1.1.3.cmml" xref="A1.SS3.SSS1.Px1.p1.2.m2.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS1.Px1.p1.2.m2.1c">p=0.5</annotation></semantics></math>, and a final dense output layer.</p>
</div>
</section>
<section id="A1.SS3.SSS1.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">CIFAR100</h5>

<div id="A1.SS3.SSS1.Px2.p1" class="ltx_para ltx_noindent">
<p id="A1.SS3.SSS1.Px2.p1.1" class="ltx_p">The CIFAR100 dataset consists of 32x32x3 pixel images with one of 100 labels. We preprocess the images using standard data augmentations, including padding to 36x36 dimensions, randomly cropping to 32x32, randomly flipping along the vertical axis and applying normalization. We partition CIFAR100 according to the two-level Dirichlet allocation scheme proposed by <cite class="ltx_cite ltx_citemacro_citet">Reddi et al. (<a href="#bib.bib38" title="" class="ltx_ref">2020</a>)</cite>. We train a standard ResNet-18 model with the batch normalization layers replaced with group normalization layers, following <cite class="ltx_cite ltx_citemacro_citet">Reddi et al. (<a href="#bib.bib38" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
</section>
<section id="A1.SS3.SSS1.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Stack Overflow</h5>

<div id="A1.SS3.SSS1.Px3.p1" class="ltx_para ltx_noindent">
<p id="A1.SS3.SSS1.Px3.p1.1" class="ltx_p">The Stack Overflow dataset is a language-modeling dataset consisting of question–answer pairs from <span class="ltx_ref ltx_font_typewriter ltx_ref_self">stackoverflow.com</span>. Each client corresponds to a user on the platform. The data is split into train, test and validation: train client examples are from before 2018-01-01 UTC, test client examples are from after 2018-01-01 UTC, and validation clients are held out from both train and test splits. We train a 350M parameter decoder-only transformer model on the train split of Stack Overflow. We use the validation client split in our evaluations of both the Stack Overflow base model and the C4 base model (for assessing transfer performance, see below).</p>
</div>
</section>
<section id="A1.SS3.SSS1.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">C4</h5>

<div id="A1.SS3.SSS1.Px4.p1" class="ltx_para ltx_noindent">
<p id="A1.SS3.SSS1.Px4.p1.1" class="ltx_p">The Colossal Clean Crawled Corpus (C4) dataset is a cleaned version of Common Crawl’s web crawl corpus <cite class="ltx_cite ltx_citemacro_citep">(Raffel et al., <a href="#bib.bib36" title="" class="ltx_ref">2020</a>)</cite>. We use the federated version of this dataset presented in <cite class="ltx_cite ltx_citemacro_citet">Charles et al. (<a href="#bib.bib8" title="" class="ltx_ref">2023</a>)</cite>, where each client corresponds to a different domain name (i.e., <span class="ltx_ref ltx_font_typewriter ltx_ref_self">nytimes.com</span>. We train a 1.5B parameter decoder-only transformer model on the train split of federated C4.</p>
</div>
<div id="A1.SS3.SSS1.Px4.p2" class="ltx_para ltx_noindent">
<p id="A1.SS3.SSS1.Px4.p2.1" class="ltx_p">We evaluate the C4 base model on a federated version of the C4 test split, as well as federated CC-News and Stack Overflow to assess transfer performance. CC-News is similarly split by domain name, using Dataset Grouper <cite class="ltx_cite ltx_citemacro_citep">(Charles et al., <a href="#bib.bib8" title="" class="ltx_ref">2023</a>)</cite>. We further measure few-shot performance of the C4 base model by conducting a personalization evaluation on 25% of held-out client data for each dataset of interest (C4, CC-News, Stack Overflow). Because of this specific personalization evaluation, we filter C4 evaluation datasets to have at least 4 examples per client.</p>
</div>
</section>
</section>
<section id="A1.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.3.2 </span>Federated Algorithm Configuration and Hyperparameters</h4>

<div id="A1.SS3.SSS2.p1" class="ltx_para ltx_noindent">
<p id="A1.SS3.SSS2.p1.1" class="ltx_p">We implement the federated algorithms, <span id="A1.SS3.SSS2.p1.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> and <span id="A1.SS3.SSS2.p1.1.2" class="ltx_text ltx_font_smallcaps">FedFish</span>, such that a global model is broadcast to a number or clients at each round, client train their models locally, model deltas are returned as pseudo-gradients to the global server for aggregation, and a global optimizer is used to make a single update on the global model using the aggregated pseudo-gradients as its own gradient.</p>
</div>
<section id="A1.SS3.SSS2.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Optimizers. </h5>

<div id="A1.SS3.SSS2.Px1.p1" class="ltx_para ltx_noindent">
<p id="A1.SS3.SSS2.Px1.p1.1" class="ltx_p">We follow standard configurations used in <cite class="ltx_cite ltx_citemacro_citet">Charles et al. (<a href="#bib.bib8" title="" class="ltx_ref">2023</a>)</cite>, with stochastic gradient descent as the local optimizer and Adam as the global server optimizer, across experiments.</p>
</div>
</section>
<section id="A1.SS3.SSS2.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Hyperparameter Tuning</h5>

<div id="A1.SS3.SSS2.Px2.p1" class="ltx_para ltx_noindent">
<p id="A1.SS3.SSS2.Px2.p1.1" class="ltx_p">We fix hyperparameters like number of clients per round, number of training rounds, local batch size, maximum dataset size for any client and sequence length for language models to reasonable values based on previous literature. For local and global learning rates, we conducted a grid search over [1e-4, 5e-4, 1e-3, 5e-3, 1e-2, 5e-2, 1e-1], and chose the best performing hyperparameters. Final hyperparameter configurations used to obtain the results in the paper are listed in <a href="#A1.T2" title="In Hyperparameter Tuning ‣ A.3.2 Federated Algorithm Configuration and Hyperparameters ‣ A.3 Experimental Details ‣ Appendix A Appendix ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">table</span> <span class="ltx_text ltx_ref_tag">2</span></a>. These are held consistent for <span id="A1.SS3.SSS2.Px2.p1.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> and <span id="A1.SS3.SSS2.Px2.p1.1.2" class="ltx_text ltx_font_smallcaps">FedFish</span> experiments.</p>
</div>
<figure id="A1.T2" class="ltx_table">
<table id="A1.T2.1" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A1.T2.1.1.1" class="ltx_tr">
<td id="A1.T2.1.1.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T2.1.1.1.1.1" class="ltx_text ltx_font_bold">Dataset</span></td>
<td id="A1.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T2.1.1.1.2.1" class="ltx_text ltx_font_bold">EMNIST</span></td>
<td id="A1.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T2.1.1.1.3.1" class="ltx_text ltx_font_bold">CIFAR100</span></td>
<td id="A1.T2.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T2.1.1.1.4.1" class="ltx_text ltx_font_bold">Stack Overflow</span></td>
<td id="A1.T2.1.1.1.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T2.1.1.1.5.1" class="ltx_text ltx_font_bold">C4</span></td>
</tr>
<tr id="A1.T2.1.2.2" class="ltx_tr">
<td id="A1.T2.1.2.2.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T2.1.2.2.1.1" class="ltx_text ltx_font_bold">Number of clients per round</span></td>
<td id="A1.T2.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">64</td>
<td id="A1.T2.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">64</td>
<td id="A1.T2.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">16</td>
<td id="A1.T2.1.2.2.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">8</td>
</tr>
<tr id="A1.T2.1.3.3" class="ltx_tr">
<td id="A1.T2.1.3.3.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T2.1.3.3.1.1" class="ltx_text ltx_font_bold">Number of training rounds</span></td>
<td id="A1.T2.1.3.3.2" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">1500</td>
<td id="A1.T2.1.3.3.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">1500</td>
<td id="A1.T2.1.3.3.4" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">1500</td>
<td id="A1.T2.1.3.3.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">10000</td>
</tr>
<tr id="A1.T2.1.4.4" class="ltx_tr">
<td id="A1.T2.1.4.4.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T2.1.4.4.1.1" class="ltx_text ltx_font_bold">Batch size for local training</span></td>
<td id="A1.T2.1.4.4.2" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">10</td>
<td id="A1.T2.1.4.4.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">25</td>
<td id="A1.T2.1.4.4.4" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">4</td>
<td id="A1.T2.1.4.4.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">4</td>
</tr>
<tr id="A1.T2.1.5.5" class="ltx_tr">
<td id="A1.T2.1.5.5.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T2.1.5.5.1.1" class="ltx_text ltx_font_bold">Max client dataset size per round</span></td>
<td id="A1.T2.1.5.5.2" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">100</td>
<td id="A1.T2.1.5.5.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">100</td>
<td id="A1.T2.1.5.5.4" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">16</td>
<td id="A1.T2.1.5.5.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">16</td>
</tr>
<tr id="A1.T2.1.6.6" class="ltx_tr">
<td id="A1.T2.1.6.6.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T2.1.6.6.1.1" class="ltx_text ltx_font_bold">Sequence length (training)</span></td>
<td id="A1.T2.1.6.6.2" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">-</td>
<td id="A1.T2.1.6.6.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">-</td>
<td id="A1.T2.1.6.6.4" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">128</td>
<td id="A1.T2.1.6.6.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">1024</td>
</tr>
<tr id="A1.T2.1.7.7" class="ltx_tr">
<td id="A1.T2.1.7.7.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T2.1.7.7.1.1" class="ltx_text ltx_font_bold">Sequence length (personalization and evaluation)</span></td>
<td id="A1.T2.1.7.7.2" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">-</td>
<td id="A1.T2.1.7.7.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">-</td>
<td id="A1.T2.1.7.7.4" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">128</td>
<td id="A1.T2.1.7.7.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">128</td>
</tr>
<tr id="A1.T2.1.8.8" class="ltx_tr">
<td id="A1.T2.1.8.8.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T2.1.8.8.1.1" class="ltx_text ltx_font_bold">Number of personalization epochs</span></td>
<td id="A1.T2.1.8.8.2" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">1</td>
<td id="A1.T2.1.8.8.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">4</td>
<td id="A1.T2.1.8.8.4" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">4</td>
<td id="A1.T2.1.8.8.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">4</td>
</tr>
<tr id="A1.T2.1.9.9" class="ltx_tr">
<td id="A1.T2.1.9.9.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T2.1.9.9.1.1" class="ltx_text ltx_font_bold">Global learning rate</span></td>
<td id="A1.T2.1.9.9.2" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">1e-3</td>
<td id="A1.T2.1.9.9.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">1e-3</td>
<td id="A1.T2.1.9.9.4" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">1e-2</td>
<td id="A1.T2.1.9.9.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">1e-2</td>
</tr>
<tr id="A1.T2.1.10.10" class="ltx_tr">
<td id="A1.T2.1.10.10.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T2.1.10.10.1.1" class="ltx_text ltx_font_bold">Local learning rate</span></td>
<td id="A1.T2.1.10.10.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:2.5pt;padding-bottom:2.5pt;">1e-3</td>
<td id="A1.T2.1.10.10.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:2.5pt;padding-bottom:2.5pt;">1e-3</td>
<td id="A1.T2.1.10.10.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:2.5pt;padding-bottom:2.5pt;">1e-3</td>
<td id="A1.T2.1.10.10.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-top:2.5pt;padding-bottom:2.5pt;">1e-3</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Final hyperparameter configurations for all datasets.</figcaption>
</figure>
</section>
</section>
<section id="A1.SS3.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.3.3 </span>Hardware Configuration</h4>

<div id="A1.SS3.SSS3.p1" class="ltx_para ltx_noindent">
<p id="A1.SS3.SSS3.p1.1" class="ltx_p">We run image-classification experiments on a TPU Pod slice consisting of 4 TPU v2 chips in a 2x2 topology, interconnected on a single machine. Each TPU v2 chip contains two TensorCores, 16 GiB of high-bandwidth memory, and 90.75 GiB RAM. We run language-modeling experiments on a TPU Pod slice consisting of 16 TPU v3 chips in a 4x4 topology, configured to use a multi-machine inter-chip interconnect mesh. Each TPU v3 chip contains two TensorCores, 32 GiB of high-bandwidth memory, 87.25 GiB RAM, 900 GBps bandwidth, and 123 teraflops peak compute.</p>
</div>
<figure id="A1.T3" class="ltx_table">
<div id="A1.T3.2" class="ltx_logical-block ltx_pruned_first ltx_align_center">
<div id="A1.T3.2.p2" class="ltx_para ltx_noindent ltx_align_center">
<p id="A1.T3.2.p2.40" class="ltx_p"><span id="A1.T3.2.p2.40.40" class="ltx_text">
<span id="A1.T3.2.p2.40.40.40" class="ltx_inline-block ltx_transformed_outer" style="width:463.4pt;height:216pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="A1.T3.2.p2.40.40.40.40" class="ltx_p"><span id="A1.T3.2.p2.40.40.40.40.40" class="ltx_text">
<span id="A1.T3.2.p2.40.40.40.40.40.40" class="ltx_tabular ltx_align_middle">
<span class="ltx_tbody">
<span id="A1.T3.2.p2.40.40.40.40.40.40.41.1" class="ltx_tr">
<span id="A1.T3.2.p2.40.40.40.40.40.40.41.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T3.2.p2.40.40.40.40.40.40.41.1.1.1" class="ltx_text ltx_font_bold">Dataset</span></span>
<span id="A1.T3.2.p2.40.40.40.40.40.40.41.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T3.2.p2.40.40.40.40.40.40.41.1.2.1" class="ltx_text ltx_font_bold">Local epochs</span></span>
<span id="A1.T3.2.p2.40.40.40.40.40.40.41.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T3.2.p2.40.40.40.40.40.40.41.1.3.1" class="ltx_text ltx_font_bold">Method</span></span>
<span id="A1.T3.2.p2.40.40.40.40.40.40.41.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_colspan ltx_colspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T3.2.p2.40.40.40.40.40.40.41.1.4.1" class="ltx_text ltx_font_bold">Global Accuracy</span></span>
<span id="A1.T3.2.p2.40.40.40.40.40.40.41.1.5" class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T3.2.p2.40.40.40.40.40.40.41.1.5.1" class="ltx_text ltx_font_bold">Personalized Accuracy</span></span></span>
<span id="A1.T3.2.p2.40.40.40.40.40.40.42.2" class="ltx_tr">
<span id="A1.T3.2.p2.40.40.40.40.40.40.42.2.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T3.2.p2.40.40.40.40.40.40.42.2.1.1" class="ltx_text ltx_font_bold">Fixed compute</span></span>
<span id="A1.T3.2.p2.40.40.40.40.40.40.42.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T3.2.p2.40.40.40.40.40.40.42.2.2.1" class="ltx_text ltx_font_bold">Fixed rounds</span></span>
<span id="A1.T3.2.p2.40.40.40.40.40.40.42.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T3.2.p2.40.40.40.40.40.40.42.2.3.1" class="ltx_text ltx_font_bold">Fixed compute</span></span>
<span id="A1.T3.2.p2.40.40.40.40.40.40.42.2.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T3.2.p2.40.40.40.40.40.40.42.2.4.1" class="ltx_text ltx_font_bold">Fixed rounds</span></span></span>
<span id="A1.T3.2.p2.4.4.4.4.4.4.4" class="ltx_tr">
<span id="A1.T3.2.p2.4.4.4.4.4.4.4.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_6" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T3.2.p2.4.4.4.4.4.4.4.5.1" class="ltx_text ltx_font_bold">EMNIST</span></span>
<span id="A1.T3.2.p2.4.4.4.4.4.4.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T3.2.p2.4.4.4.4.4.4.4.6.1" class="ltx_text ltx_font_bold">4</span></span>
<span id="A1.T3.2.p2.4.4.4.4.4.4.4.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T3.2.p2.4.4.4.4.4.4.4.7.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedAvg</span></span>
<span id="A1.T3.2.p2.1.1.1.1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="81.38" display="inline"><semantics id="A1.T3.2.p2.1.1.1.1.1.1.1.1.m1.1a"><mn id="A1.T3.2.p2.1.1.1.1.1.1.1.1.m1.1.1" xref="A1.T3.2.p2.1.1.1.1.1.1.1.1.m1.1.1.cmml">81.38</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.1.1.1.1.1.1.1.1.m1.1b"><cn type="float" id="A1.T3.2.p2.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="A1.T3.2.p2.1.1.1.1.1.1.1.1.m1.1.1">81.38</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.1.1.1.1.1.1.1.1.m1.1c">81.38</annotation></semantics></math></span>
<span id="A1.T3.2.p2.2.2.2.2.2.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.2.2.2.2.2.2.2.2.m1.1" class="ltx_Math" alttext="81.38" display="inline"><semantics id="A1.T3.2.p2.2.2.2.2.2.2.2.2.m1.1a"><mn id="A1.T3.2.p2.2.2.2.2.2.2.2.2.m1.1.1" xref="A1.T3.2.p2.2.2.2.2.2.2.2.2.m1.1.1.cmml">81.38</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.2.2.2.2.2.2.2.2.m1.1b"><cn type="float" id="A1.T3.2.p2.2.2.2.2.2.2.2.2.m1.1.1.cmml" xref="A1.T3.2.p2.2.2.2.2.2.2.2.2.m1.1.1">81.38</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.2.2.2.2.2.2.2.2.m1.1c">81.38</annotation></semantics></math></span>
<span id="A1.T3.2.p2.3.3.3.3.3.3.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.3.3.3.3.3.3.3.3.m1.1" class="ltx_Math" alttext="83.09" display="inline"><semantics id="A1.T3.2.p2.3.3.3.3.3.3.3.3.m1.1a"><mn id="A1.T3.2.p2.3.3.3.3.3.3.3.3.m1.1.1" xref="A1.T3.2.p2.3.3.3.3.3.3.3.3.m1.1.1.cmml">83.09</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.3.3.3.3.3.3.3.3.m1.1b"><cn type="float" id="A1.T3.2.p2.3.3.3.3.3.3.3.3.m1.1.1.cmml" xref="A1.T3.2.p2.3.3.3.3.3.3.3.3.m1.1.1">83.09</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.3.3.3.3.3.3.3.3.m1.1c">83.09</annotation></semantics></math></span>
<span id="A1.T3.2.p2.4.4.4.4.4.4.4.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.4.4.4.4.4.4.4.4.m1.1" class="ltx_Math" alttext="83.09" display="inline"><semantics id="A1.T3.2.p2.4.4.4.4.4.4.4.4.m1.1a"><mn id="A1.T3.2.p2.4.4.4.4.4.4.4.4.m1.1.1" xref="A1.T3.2.p2.4.4.4.4.4.4.4.4.m1.1.1.cmml">83.09</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.4.4.4.4.4.4.4.4.m1.1b"><cn type="float" id="A1.T3.2.p2.4.4.4.4.4.4.4.4.m1.1.1.cmml" xref="A1.T3.2.p2.4.4.4.4.4.4.4.4.m1.1.1">83.09</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.4.4.4.4.4.4.4.4.m1.1c">83.09</annotation></semantics></math></span></span>
<span id="A1.T3.2.p2.8.8.8.8.8.8.8" class="ltx_tr">
<span id="A1.T3.2.p2.8.8.8.8.8.8.8.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T3.2.p2.8.8.8.8.8.8.8.5.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedFish</span></span>
<span id="A1.T3.2.p2.5.5.5.5.5.5.5.1" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.5.5.5.5.5.5.5.1.m1.1" class="ltx_Math" alttext="82.64" display="inline"><semantics id="A1.T3.2.p2.5.5.5.5.5.5.5.1.m1.1a"><mn id="A1.T3.2.p2.5.5.5.5.5.5.5.1.m1.1.1" xref="A1.T3.2.p2.5.5.5.5.5.5.5.1.m1.1.1.cmml">82.64</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.5.5.5.5.5.5.5.1.m1.1b"><cn type="float" id="A1.T3.2.p2.5.5.5.5.5.5.5.1.m1.1.1.cmml" xref="A1.T3.2.p2.5.5.5.5.5.5.5.1.m1.1.1">82.64</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.5.5.5.5.5.5.5.1.m1.1c">82.64</annotation></semantics></math></span>
<span id="A1.T3.2.p2.6.6.6.6.6.6.6.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.6.6.6.6.6.6.6.2.m1.1" class="ltx_Math" alttext="82.64" display="inline"><semantics id="A1.T3.2.p2.6.6.6.6.6.6.6.2.m1.1a"><mn id="A1.T3.2.p2.6.6.6.6.6.6.6.2.m1.1.1" xref="A1.T3.2.p2.6.6.6.6.6.6.6.2.m1.1.1.cmml">82.64</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.6.6.6.6.6.6.6.2.m1.1b"><cn type="float" id="A1.T3.2.p2.6.6.6.6.6.6.6.2.m1.1.1.cmml" xref="A1.T3.2.p2.6.6.6.6.6.6.6.2.m1.1.1">82.64</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.6.6.6.6.6.6.6.2.m1.1c">82.64</annotation></semantics></math></span>
<span id="A1.T3.2.p2.7.7.7.7.7.7.7.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.7.7.7.7.7.7.7.3.m1.1" class="ltx_Math" alttext="83.44" display="inline"><semantics id="A1.T3.2.p2.7.7.7.7.7.7.7.3.m1.1a"><mn id="A1.T3.2.p2.7.7.7.7.7.7.7.3.m1.1.1" xref="A1.T3.2.p2.7.7.7.7.7.7.7.3.m1.1.1.cmml">83.44</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.7.7.7.7.7.7.7.3.m1.1b"><cn type="float" id="A1.T3.2.p2.7.7.7.7.7.7.7.3.m1.1.1.cmml" xref="A1.T3.2.p2.7.7.7.7.7.7.7.3.m1.1.1">83.44</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.7.7.7.7.7.7.7.3.m1.1c">83.44</annotation></semantics></math></span>
<span id="A1.T3.2.p2.8.8.8.8.8.8.8.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.8.8.8.8.8.8.8.4.m1.1" class="ltx_Math" alttext="83.44" display="inline"><semantics id="A1.T3.2.p2.8.8.8.8.8.8.8.4.m1.1a"><mn id="A1.T3.2.p2.8.8.8.8.8.8.8.4.m1.1.1" xref="A1.T3.2.p2.8.8.8.8.8.8.8.4.m1.1.1.cmml">83.44</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.8.8.8.8.8.8.8.4.m1.1b"><cn type="float" id="A1.T3.2.p2.8.8.8.8.8.8.8.4.m1.1.1.cmml" xref="A1.T3.2.p2.8.8.8.8.8.8.8.4.m1.1.1">83.44</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.8.8.8.8.8.8.8.4.m1.1c">83.44</annotation></semantics></math></span></span>
<span id="A1.T3.2.p2.12.12.12.12.12.12.12" class="ltx_tr">
<span id="A1.T3.2.p2.12.12.12.12.12.12.12.5" class="ltx_td ltx_align_center ltx_border_r ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T3.2.p2.12.12.12.12.12.12.12.5.1" class="ltx_text ltx_font_bold">8</span></span>
<span id="A1.T3.2.p2.12.12.12.12.12.12.12.6" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T3.2.p2.12.12.12.12.12.12.12.6.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedAvg</span></span>
<span id="A1.T3.2.p2.9.9.9.9.9.9.9.1" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.9.9.9.9.9.9.9.1.m1.1" class="ltx_Math" alttext="82.05" display="inline"><semantics id="A1.T3.2.p2.9.9.9.9.9.9.9.1.m1.1a"><mn id="A1.T3.2.p2.9.9.9.9.9.9.9.1.m1.1.1" xref="A1.T3.2.p2.9.9.9.9.9.9.9.1.m1.1.1.cmml">82.05</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.9.9.9.9.9.9.9.1.m1.1b"><cn type="float" id="A1.T3.2.p2.9.9.9.9.9.9.9.1.m1.1.1.cmml" xref="A1.T3.2.p2.9.9.9.9.9.9.9.1.m1.1.1">82.05</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.9.9.9.9.9.9.9.1.m1.1c">82.05</annotation></semantics></math></span>
<span id="A1.T3.2.p2.10.10.10.10.10.10.10.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.10.10.10.10.10.10.10.2.m1.1" class="ltx_Math" alttext="82.24" display="inline"><semantics id="A1.T3.2.p2.10.10.10.10.10.10.10.2.m1.1a"><mn id="A1.T3.2.p2.10.10.10.10.10.10.10.2.m1.1.1" xref="A1.T3.2.p2.10.10.10.10.10.10.10.2.m1.1.1.cmml">82.24</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.10.10.10.10.10.10.10.2.m1.1b"><cn type="float" id="A1.T3.2.p2.10.10.10.10.10.10.10.2.m1.1.1.cmml" xref="A1.T3.2.p2.10.10.10.10.10.10.10.2.m1.1.1">82.24</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.10.10.10.10.10.10.10.2.m1.1c">82.24</annotation></semantics></math></span>
<span id="A1.T3.2.p2.11.11.11.11.11.11.11.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.11.11.11.11.11.11.11.3.m1.1" class="ltx_Math" alttext="83.46" display="inline"><semantics id="A1.T3.2.p2.11.11.11.11.11.11.11.3.m1.1a"><mn id="A1.T3.2.p2.11.11.11.11.11.11.11.3.m1.1.1" xref="A1.T3.2.p2.11.11.11.11.11.11.11.3.m1.1.1.cmml">83.46</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.11.11.11.11.11.11.11.3.m1.1b"><cn type="float" id="A1.T3.2.p2.11.11.11.11.11.11.11.3.m1.1.1.cmml" xref="A1.T3.2.p2.11.11.11.11.11.11.11.3.m1.1.1">83.46</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.11.11.11.11.11.11.11.3.m1.1c">83.46</annotation></semantics></math></span>
<span id="A1.T3.2.p2.12.12.12.12.12.12.12.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.12.12.12.12.12.12.12.4.m1.1" class="ltx_Math" alttext="83.82" display="inline"><semantics id="A1.T3.2.p2.12.12.12.12.12.12.12.4.m1.1a"><mn id="A1.T3.2.p2.12.12.12.12.12.12.12.4.m1.1.1" xref="A1.T3.2.p2.12.12.12.12.12.12.12.4.m1.1.1.cmml">83.82</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.12.12.12.12.12.12.12.4.m1.1b"><cn type="float" id="A1.T3.2.p2.12.12.12.12.12.12.12.4.m1.1.1.cmml" xref="A1.T3.2.p2.12.12.12.12.12.12.12.4.m1.1.1">83.82</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.12.12.12.12.12.12.12.4.m1.1c">83.82</annotation></semantics></math></span></span>
<span id="A1.T3.2.p2.16.16.16.16.16.16.16" class="ltx_tr">
<span id="A1.T3.2.p2.16.16.16.16.16.16.16.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T3.2.p2.16.16.16.16.16.16.16.5.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedFish</span></span>
<span id="A1.T3.2.p2.13.13.13.13.13.13.13.1" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.13.13.13.13.13.13.13.1.m1.1" class="ltx_Math" alttext="83.19" display="inline"><semantics id="A1.T3.2.p2.13.13.13.13.13.13.13.1.m1.1a"><mn id="A1.T3.2.p2.13.13.13.13.13.13.13.1.m1.1.1" xref="A1.T3.2.p2.13.13.13.13.13.13.13.1.m1.1.1.cmml">83.19</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.13.13.13.13.13.13.13.1.m1.1b"><cn type="float" id="A1.T3.2.p2.13.13.13.13.13.13.13.1.m1.1.1.cmml" xref="A1.T3.2.p2.13.13.13.13.13.13.13.1.m1.1.1">83.19</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.13.13.13.13.13.13.13.1.m1.1c">83.19</annotation></semantics></math></span>
<span id="A1.T3.2.p2.14.14.14.14.14.14.14.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.14.14.14.14.14.14.14.2.m1.1" class="ltx_Math" alttext="84.42" display="inline"><semantics id="A1.T3.2.p2.14.14.14.14.14.14.14.2.m1.1a"><mn id="A1.T3.2.p2.14.14.14.14.14.14.14.2.m1.1.1" xref="A1.T3.2.p2.14.14.14.14.14.14.14.2.m1.1.1.cmml">84.42</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.14.14.14.14.14.14.14.2.m1.1b"><cn type="float" id="A1.T3.2.p2.14.14.14.14.14.14.14.2.m1.1.1.cmml" xref="A1.T3.2.p2.14.14.14.14.14.14.14.2.m1.1.1">84.42</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.14.14.14.14.14.14.14.2.m1.1c">84.42</annotation></semantics></math></span>
<span id="A1.T3.2.p2.15.15.15.15.15.15.15.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.15.15.15.15.15.15.15.3.m1.1" class="ltx_Math" alttext="84.37" display="inline"><semantics id="A1.T3.2.p2.15.15.15.15.15.15.15.3.m1.1a"><mn id="A1.T3.2.p2.15.15.15.15.15.15.15.3.m1.1.1" xref="A1.T3.2.p2.15.15.15.15.15.15.15.3.m1.1.1.cmml">84.37</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.15.15.15.15.15.15.15.3.m1.1b"><cn type="float" id="A1.T3.2.p2.15.15.15.15.15.15.15.3.m1.1.1.cmml" xref="A1.T3.2.p2.15.15.15.15.15.15.15.3.m1.1.1">84.37</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.15.15.15.15.15.15.15.3.m1.1c">84.37</annotation></semantics></math></span>
<span id="A1.T3.2.p2.16.16.16.16.16.16.16.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.16.16.16.16.16.16.16.4.m1.1" class="ltx_Math" alttext="85.6" display="inline"><semantics id="A1.T3.2.p2.16.16.16.16.16.16.16.4.m1.1a"><mn id="A1.T3.2.p2.16.16.16.16.16.16.16.4.m1.1.1" xref="A1.T3.2.p2.16.16.16.16.16.16.16.4.m1.1.1.cmml">85.6</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.16.16.16.16.16.16.16.4.m1.1b"><cn type="float" id="A1.T3.2.p2.16.16.16.16.16.16.16.4.m1.1.1.cmml" xref="A1.T3.2.p2.16.16.16.16.16.16.16.4.m1.1.1">85.6</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.16.16.16.16.16.16.16.4.m1.1c">85.6</annotation></semantics></math></span></span>
<span id="A1.T3.2.p2.20.20.20.20.20.20.20" class="ltx_tr">
<span id="A1.T3.2.p2.20.20.20.20.20.20.20.5" class="ltx_td ltx_align_center ltx_border_r ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T3.2.p2.20.20.20.20.20.20.20.5.1" class="ltx_text ltx_font_bold">16</span></span>
<span id="A1.T3.2.p2.20.20.20.20.20.20.20.6" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T3.2.p2.20.20.20.20.20.20.20.6.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedAvg</span></span>
<span id="A1.T3.2.p2.17.17.17.17.17.17.17.1" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.17.17.17.17.17.17.17.1.m1.1" class="ltx_Math" alttext="76.45" display="inline"><semantics id="A1.T3.2.p2.17.17.17.17.17.17.17.1.m1.1a"><mn id="A1.T3.2.p2.17.17.17.17.17.17.17.1.m1.1.1" xref="A1.T3.2.p2.17.17.17.17.17.17.17.1.m1.1.1.cmml">76.45</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.17.17.17.17.17.17.17.1.m1.1b"><cn type="float" id="A1.T3.2.p2.17.17.17.17.17.17.17.1.m1.1.1.cmml" xref="A1.T3.2.p2.17.17.17.17.17.17.17.1.m1.1.1">76.45</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.17.17.17.17.17.17.17.1.m1.1c">76.45</annotation></semantics></math></span>
<span id="A1.T3.2.p2.18.18.18.18.18.18.18.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.18.18.18.18.18.18.18.2.m1.1" class="ltx_Math" alttext="77.52" display="inline"><semantics id="A1.T3.2.p2.18.18.18.18.18.18.18.2.m1.1a"><mn id="A1.T3.2.p2.18.18.18.18.18.18.18.2.m1.1.1" xref="A1.T3.2.p2.18.18.18.18.18.18.18.2.m1.1.1.cmml">77.52</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.18.18.18.18.18.18.18.2.m1.1b"><cn type="float" id="A1.T3.2.p2.18.18.18.18.18.18.18.2.m1.1.1.cmml" xref="A1.T3.2.p2.18.18.18.18.18.18.18.2.m1.1.1">77.52</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.18.18.18.18.18.18.18.2.m1.1c">77.52</annotation></semantics></math></span>
<span id="A1.T3.2.p2.19.19.19.19.19.19.19.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.19.19.19.19.19.19.19.3.m1.1" class="ltx_Math" alttext="77.96" display="inline"><semantics id="A1.T3.2.p2.19.19.19.19.19.19.19.3.m1.1a"><mn id="A1.T3.2.p2.19.19.19.19.19.19.19.3.m1.1.1" xref="A1.T3.2.p2.19.19.19.19.19.19.19.3.m1.1.1.cmml">77.96</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.19.19.19.19.19.19.19.3.m1.1b"><cn type="float" id="A1.T3.2.p2.19.19.19.19.19.19.19.3.m1.1.1.cmml" xref="A1.T3.2.p2.19.19.19.19.19.19.19.3.m1.1.1">77.96</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.19.19.19.19.19.19.19.3.m1.1c">77.96</annotation></semantics></math></span>
<span id="A1.T3.2.p2.20.20.20.20.20.20.20.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.20.20.20.20.20.20.20.4.m1.1" class="ltx_Math" alttext="79.63" display="inline"><semantics id="A1.T3.2.p2.20.20.20.20.20.20.20.4.m1.1a"><mn id="A1.T3.2.p2.20.20.20.20.20.20.20.4.m1.1.1" xref="A1.T3.2.p2.20.20.20.20.20.20.20.4.m1.1.1.cmml">79.63</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.20.20.20.20.20.20.20.4.m1.1b"><cn type="float" id="A1.T3.2.p2.20.20.20.20.20.20.20.4.m1.1.1.cmml" xref="A1.T3.2.p2.20.20.20.20.20.20.20.4.m1.1.1">79.63</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.20.20.20.20.20.20.20.4.m1.1c">79.63</annotation></semantics></math></span></span>
<span id="A1.T3.2.p2.24.24.24.24.24.24.24" class="ltx_tr">
<span id="A1.T3.2.p2.24.24.24.24.24.24.24.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T3.2.p2.24.24.24.24.24.24.24.5.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedFish</span></span>
<span id="A1.T3.2.p2.21.21.21.21.21.21.21.1" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.21.21.21.21.21.21.21.1.m1.1" class="ltx_Math" alttext="79.01" display="inline"><semantics id="A1.T3.2.p2.21.21.21.21.21.21.21.1.m1.1a"><mn id="A1.T3.2.p2.21.21.21.21.21.21.21.1.m1.1.1" xref="A1.T3.2.p2.21.21.21.21.21.21.21.1.m1.1.1.cmml">79.01</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.21.21.21.21.21.21.21.1.m1.1b"><cn type="float" id="A1.T3.2.p2.21.21.21.21.21.21.21.1.m1.1.1.cmml" xref="A1.T3.2.p2.21.21.21.21.21.21.21.1.m1.1.1">79.01</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.21.21.21.21.21.21.21.1.m1.1c">79.01</annotation></semantics></math></span>
<span id="A1.T3.2.p2.22.22.22.22.22.22.22.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.22.22.22.22.22.22.22.2.m1.1" class="ltx_Math" alttext="82.86" display="inline"><semantics id="A1.T3.2.p2.22.22.22.22.22.22.22.2.m1.1a"><mn id="A1.T3.2.p2.22.22.22.22.22.22.22.2.m1.1.1" xref="A1.T3.2.p2.22.22.22.22.22.22.22.2.m1.1.1.cmml">82.86</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.22.22.22.22.22.22.22.2.m1.1b"><cn type="float" id="A1.T3.2.p2.22.22.22.22.22.22.22.2.m1.1.1.cmml" xref="A1.T3.2.p2.22.22.22.22.22.22.22.2.m1.1.1">82.86</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.22.22.22.22.22.22.22.2.m1.1c">82.86</annotation></semantics></math></span>
<span id="A1.T3.2.p2.23.23.23.23.23.23.23.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.23.23.23.23.23.23.23.3.m1.1" class="ltx_Math" alttext="81.05" display="inline"><semantics id="A1.T3.2.p2.23.23.23.23.23.23.23.3.m1.1a"><mn id="A1.T3.2.p2.23.23.23.23.23.23.23.3.m1.1.1" xref="A1.T3.2.p2.23.23.23.23.23.23.23.3.m1.1.1.cmml">81.05</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.23.23.23.23.23.23.23.3.m1.1b"><cn type="float" id="A1.T3.2.p2.23.23.23.23.23.23.23.3.m1.1.1.cmml" xref="A1.T3.2.p2.23.23.23.23.23.23.23.3.m1.1.1">81.05</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.23.23.23.23.23.23.23.3.m1.1c">81.05</annotation></semantics></math></span>
<span id="A1.T3.2.p2.24.24.24.24.24.24.24.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.24.24.24.24.24.24.24.4.m1.1" class="ltx_Math" alttext="84.96" display="inline"><semantics id="A1.T3.2.p2.24.24.24.24.24.24.24.4.m1.1a"><mn id="A1.T3.2.p2.24.24.24.24.24.24.24.4.m1.1.1" xref="A1.T3.2.p2.24.24.24.24.24.24.24.4.m1.1.1.cmml">84.96</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.24.24.24.24.24.24.24.4.m1.1b"><cn type="float" id="A1.T3.2.p2.24.24.24.24.24.24.24.4.m1.1.1.cmml" xref="A1.T3.2.p2.24.24.24.24.24.24.24.4.m1.1.1">84.96</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.24.24.24.24.24.24.24.4.m1.1c">84.96</annotation></semantics></math></span></span>
<span id="A1.T3.2.p2.28.28.28.28.28.28.28" class="ltx_tr">
<span id="A1.T3.2.p2.28.28.28.28.28.28.28.5" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T3.2.p2.28.28.28.28.28.28.28.5.1" class="ltx_text ltx_font_bold">CIFAR100</span></span>
<span id="A1.T3.2.p2.28.28.28.28.28.28.28.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T3.2.p2.28.28.28.28.28.28.28.6.1" class="ltx_text ltx_font_bold">4</span></span>
<span id="A1.T3.2.p2.28.28.28.28.28.28.28.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T3.2.p2.28.28.28.28.28.28.28.7.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedAvg</span></span>
<span id="A1.T3.2.p2.25.25.25.25.25.25.25.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.25.25.25.25.25.25.25.1.m1.1" class="ltx_Math" alttext="35.75" display="inline"><semantics id="A1.T3.2.p2.25.25.25.25.25.25.25.1.m1.1a"><mn id="A1.T3.2.p2.25.25.25.25.25.25.25.1.m1.1.1" xref="A1.T3.2.p2.25.25.25.25.25.25.25.1.m1.1.1.cmml">35.75</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.25.25.25.25.25.25.25.1.m1.1b"><cn type="float" id="A1.T3.2.p2.25.25.25.25.25.25.25.1.m1.1.1.cmml" xref="A1.T3.2.p2.25.25.25.25.25.25.25.1.m1.1.1">35.75</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.25.25.25.25.25.25.25.1.m1.1c">35.75</annotation></semantics></math></span>
<span id="A1.T3.2.p2.26.26.26.26.26.26.26.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.26.26.26.26.26.26.26.2.m1.1" class="ltx_Math" alttext="35.75" display="inline"><semantics id="A1.T3.2.p2.26.26.26.26.26.26.26.2.m1.1a"><mn id="A1.T3.2.p2.26.26.26.26.26.26.26.2.m1.1.1" xref="A1.T3.2.p2.26.26.26.26.26.26.26.2.m1.1.1.cmml">35.75</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.26.26.26.26.26.26.26.2.m1.1b"><cn type="float" id="A1.T3.2.p2.26.26.26.26.26.26.26.2.m1.1.1.cmml" xref="A1.T3.2.p2.26.26.26.26.26.26.26.2.m1.1.1">35.75</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.26.26.26.26.26.26.26.2.m1.1c">35.75</annotation></semantics></math></span>
<span id="A1.T3.2.p2.27.27.27.27.27.27.27.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.27.27.27.27.27.27.27.3.m1.1" class="ltx_Math" alttext="37.06" display="inline"><semantics id="A1.T3.2.p2.27.27.27.27.27.27.27.3.m1.1a"><mn id="A1.T3.2.p2.27.27.27.27.27.27.27.3.m1.1.1" xref="A1.T3.2.p2.27.27.27.27.27.27.27.3.m1.1.1.cmml">37.06</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.27.27.27.27.27.27.27.3.m1.1b"><cn type="float" id="A1.T3.2.p2.27.27.27.27.27.27.27.3.m1.1.1.cmml" xref="A1.T3.2.p2.27.27.27.27.27.27.27.3.m1.1.1">37.06</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.27.27.27.27.27.27.27.3.m1.1c">37.06</annotation></semantics></math></span>
<span id="A1.T3.2.p2.28.28.28.28.28.28.28.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.28.28.28.28.28.28.28.4.m1.1" class="ltx_Math" alttext="37.06" display="inline"><semantics id="A1.T3.2.p2.28.28.28.28.28.28.28.4.m1.1a"><mn id="A1.T3.2.p2.28.28.28.28.28.28.28.4.m1.1.1" xref="A1.T3.2.p2.28.28.28.28.28.28.28.4.m1.1.1.cmml">37.06</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.28.28.28.28.28.28.28.4.m1.1b"><cn type="float" id="A1.T3.2.p2.28.28.28.28.28.28.28.4.m1.1.1.cmml" xref="A1.T3.2.p2.28.28.28.28.28.28.28.4.m1.1.1">37.06</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.28.28.28.28.28.28.28.4.m1.1c">37.06</annotation></semantics></math></span></span>
<span id="A1.T3.2.p2.32.32.32.32.32.32.32" class="ltx_tr">
<span id="A1.T3.2.p2.32.32.32.32.32.32.32.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T3.2.p2.32.32.32.32.32.32.32.5.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedFish</span></span>
<span id="A1.T3.2.p2.29.29.29.29.29.29.29.1" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.29.29.29.29.29.29.29.1.m1.1" class="ltx_Math" alttext="36.88" display="inline"><semantics id="A1.T3.2.p2.29.29.29.29.29.29.29.1.m1.1a"><mn id="A1.T3.2.p2.29.29.29.29.29.29.29.1.m1.1.1" xref="A1.T3.2.p2.29.29.29.29.29.29.29.1.m1.1.1.cmml">36.88</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.29.29.29.29.29.29.29.1.m1.1b"><cn type="float" id="A1.T3.2.p2.29.29.29.29.29.29.29.1.m1.1.1.cmml" xref="A1.T3.2.p2.29.29.29.29.29.29.29.1.m1.1.1">36.88</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.29.29.29.29.29.29.29.1.m1.1c">36.88</annotation></semantics></math></span>
<span id="A1.T3.2.p2.30.30.30.30.30.30.30.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.30.30.30.30.30.30.30.2.m1.1" class="ltx_Math" alttext="36.88" display="inline"><semantics id="A1.T3.2.p2.30.30.30.30.30.30.30.2.m1.1a"><mn id="A1.T3.2.p2.30.30.30.30.30.30.30.2.m1.1.1" xref="A1.T3.2.p2.30.30.30.30.30.30.30.2.m1.1.1.cmml">36.88</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.30.30.30.30.30.30.30.2.m1.1b"><cn type="float" id="A1.T3.2.p2.30.30.30.30.30.30.30.2.m1.1.1.cmml" xref="A1.T3.2.p2.30.30.30.30.30.30.30.2.m1.1.1">36.88</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.30.30.30.30.30.30.30.2.m1.1c">36.88</annotation></semantics></math></span>
<span id="A1.T3.2.p2.31.31.31.31.31.31.31.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.31.31.31.31.31.31.31.3.m1.1" class="ltx_Math" alttext="41.31" display="inline"><semantics id="A1.T3.2.p2.31.31.31.31.31.31.31.3.m1.1a"><mn id="A1.T3.2.p2.31.31.31.31.31.31.31.3.m1.1.1" xref="A1.T3.2.p2.31.31.31.31.31.31.31.3.m1.1.1.cmml">41.31</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.31.31.31.31.31.31.31.3.m1.1b"><cn type="float" id="A1.T3.2.p2.31.31.31.31.31.31.31.3.m1.1.1.cmml" xref="A1.T3.2.p2.31.31.31.31.31.31.31.3.m1.1.1">41.31</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.31.31.31.31.31.31.31.3.m1.1c">41.31</annotation></semantics></math></span>
<span id="A1.T3.2.p2.32.32.32.32.32.32.32.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.32.32.32.32.32.32.32.4.m1.1" class="ltx_Math" alttext="41.31" display="inline"><semantics id="A1.T3.2.p2.32.32.32.32.32.32.32.4.m1.1a"><mn id="A1.T3.2.p2.32.32.32.32.32.32.32.4.m1.1.1" xref="A1.T3.2.p2.32.32.32.32.32.32.32.4.m1.1.1.cmml">41.31</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.32.32.32.32.32.32.32.4.m1.1b"><cn type="float" id="A1.T3.2.p2.32.32.32.32.32.32.32.4.m1.1.1.cmml" xref="A1.T3.2.p2.32.32.32.32.32.32.32.4.m1.1.1">41.31</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.32.32.32.32.32.32.32.4.m1.1c">41.31</annotation></semantics></math></span></span>
<span id="A1.T3.2.p2.36.36.36.36.36.36.36" class="ltx_tr">
<span id="A1.T3.2.p2.36.36.36.36.36.36.36.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T3.2.p2.36.36.36.36.36.36.36.5.1" class="ltx_text ltx_font_bold">16</span></span>
<span id="A1.T3.2.p2.36.36.36.36.36.36.36.6" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T3.2.p2.36.36.36.36.36.36.36.6.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedAvg</span></span>
<span id="A1.T3.2.p2.33.33.33.33.33.33.33.1" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.33.33.33.33.33.33.33.1.m1.1" class="ltx_Math" alttext="28.56" display="inline"><semantics id="A1.T3.2.p2.33.33.33.33.33.33.33.1.m1.1a"><mn id="A1.T3.2.p2.33.33.33.33.33.33.33.1.m1.1.1" xref="A1.T3.2.p2.33.33.33.33.33.33.33.1.m1.1.1.cmml">28.56</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.33.33.33.33.33.33.33.1.m1.1b"><cn type="float" id="A1.T3.2.p2.33.33.33.33.33.33.33.1.m1.1.1.cmml" xref="A1.T3.2.p2.33.33.33.33.33.33.33.1.m1.1.1">28.56</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.33.33.33.33.33.33.33.1.m1.1c">28.56</annotation></semantics></math></span>
<span id="A1.T3.2.p2.34.34.34.34.34.34.34.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.34.34.34.34.34.34.34.2.m1.1" class="ltx_Math" alttext="33.28" display="inline"><semantics id="A1.T3.2.p2.34.34.34.34.34.34.34.2.m1.1a"><mn id="A1.T3.2.p2.34.34.34.34.34.34.34.2.m1.1.1" xref="A1.T3.2.p2.34.34.34.34.34.34.34.2.m1.1.1.cmml">33.28</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.34.34.34.34.34.34.34.2.m1.1b"><cn type="float" id="A1.T3.2.p2.34.34.34.34.34.34.34.2.m1.1.1.cmml" xref="A1.T3.2.p2.34.34.34.34.34.34.34.2.m1.1.1">33.28</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.34.34.34.34.34.34.34.2.m1.1c">33.28</annotation></semantics></math></span>
<span id="A1.T3.2.p2.35.35.35.35.35.35.35.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.35.35.35.35.35.35.35.3.m1.1" class="ltx_Math" alttext="36.00" display="inline"><semantics id="A1.T3.2.p2.35.35.35.35.35.35.35.3.m1.1a"><mn id="A1.T3.2.p2.35.35.35.35.35.35.35.3.m1.1.1" xref="A1.T3.2.p2.35.35.35.35.35.35.35.3.m1.1.1.cmml">36.00</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.35.35.35.35.35.35.35.3.m1.1b"><cn type="float" id="A1.T3.2.p2.35.35.35.35.35.35.35.3.m1.1.1.cmml" xref="A1.T3.2.p2.35.35.35.35.35.35.35.3.m1.1.1">36.00</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.35.35.35.35.35.35.35.3.m1.1c">36.00</annotation></semantics></math></span>
<span id="A1.T3.2.p2.36.36.36.36.36.36.36.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.36.36.36.36.36.36.36.4.m1.1" class="ltx_Math" alttext="32.13" display="inline"><semantics id="A1.T3.2.p2.36.36.36.36.36.36.36.4.m1.1a"><mn id="A1.T3.2.p2.36.36.36.36.36.36.36.4.m1.1.1" xref="A1.T3.2.p2.36.36.36.36.36.36.36.4.m1.1.1.cmml">32.13</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.36.36.36.36.36.36.36.4.m1.1b"><cn type="float" id="A1.T3.2.p2.36.36.36.36.36.36.36.4.m1.1.1.cmml" xref="A1.T3.2.p2.36.36.36.36.36.36.36.4.m1.1.1">32.13</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.36.36.36.36.36.36.36.4.m1.1c">32.13</annotation></semantics></math></span></span>
<span id="A1.T3.2.p2.40.40.40.40.40.40.40" class="ltx_tr">
<span id="A1.T3.2.p2.40.40.40.40.40.40.40.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T3.2.p2.40.40.40.40.40.40.40.5.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedFish</span></span>
<span id="A1.T3.2.p2.37.37.37.37.37.37.37.1" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.37.37.37.37.37.37.37.1.m1.1" class="ltx_Math" alttext="31.63" display="inline"><semantics id="A1.T3.2.p2.37.37.37.37.37.37.37.1.m1.1a"><mn id="A1.T3.2.p2.37.37.37.37.37.37.37.1.m1.1.1" xref="A1.T3.2.p2.37.37.37.37.37.37.37.1.m1.1.1.cmml">31.63</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.37.37.37.37.37.37.37.1.m1.1b"><cn type="float" id="A1.T3.2.p2.37.37.37.37.37.37.37.1.m1.1.1.cmml" xref="A1.T3.2.p2.37.37.37.37.37.37.37.1.m1.1.1">31.63</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.37.37.37.37.37.37.37.1.m1.1c">31.63</annotation></semantics></math></span>
<span id="A1.T3.2.p2.38.38.38.38.38.38.38.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.38.38.38.38.38.38.38.2.m1.1" class="ltx_Math" alttext="37.72" display="inline"><semantics id="A1.T3.2.p2.38.38.38.38.38.38.38.2.m1.1a"><mn id="A1.T3.2.p2.38.38.38.38.38.38.38.2.m1.1.1" xref="A1.T3.2.p2.38.38.38.38.38.38.38.2.m1.1.1.cmml">37.72</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.38.38.38.38.38.38.38.2.m1.1b"><cn type="float" id="A1.T3.2.p2.38.38.38.38.38.38.38.2.m1.1.1.cmml" xref="A1.T3.2.p2.38.38.38.38.38.38.38.2.m1.1.1">37.72</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.38.38.38.38.38.38.38.2.m1.1c">37.72</annotation></semantics></math></span>
<span id="A1.T3.2.p2.39.39.39.39.39.39.39.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.39.39.39.39.39.39.39.3.m1.1" class="ltx_Math" alttext="40.53" display="inline"><semantics id="A1.T3.2.p2.39.39.39.39.39.39.39.3.m1.1a"><mn id="A1.T3.2.p2.39.39.39.39.39.39.39.3.m1.1.1" xref="A1.T3.2.p2.39.39.39.39.39.39.39.3.m1.1.1.cmml">40.53</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.39.39.39.39.39.39.39.3.m1.1b"><cn type="float" id="A1.T3.2.p2.39.39.39.39.39.39.39.3.m1.1.1.cmml" xref="A1.T3.2.p2.39.39.39.39.39.39.39.3.m1.1.1">40.53</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.39.39.39.39.39.39.39.3.m1.1c">40.53</annotation></semantics></math></span>
<span id="A1.T3.2.p2.40.40.40.40.40.40.40.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-top:2.5pt;padding-bottom:2.5pt;"><math id="A1.T3.2.p2.40.40.40.40.40.40.40.4.m1.1" class="ltx_Math" alttext="44.69" display="inline"><semantics id="A1.T3.2.p2.40.40.40.40.40.40.40.4.m1.1a"><mn id="A1.T3.2.p2.40.40.40.40.40.40.40.4.m1.1.1" xref="A1.T3.2.p2.40.40.40.40.40.40.40.4.m1.1.1.cmml">44.69</mn><annotation-xml encoding="MathML-Content" id="A1.T3.2.p2.40.40.40.40.40.40.40.4.m1.1b"><cn type="float" id="A1.T3.2.p2.40.40.40.40.40.40.40.4.m1.1.1.cmml" xref="A1.T3.2.p2.40.40.40.40.40.40.40.4.m1.1.1">44.69</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.p2.40.40.40.40.40.40.40.4.m1.1c">44.69</annotation></semantics></math></span></span>
</span>
</span></span></span>
</span></span></span></p>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Longer local training improves overall performance in terms of both global model accuracy as well as personalization. When amount of compute, i.e. total number of training epochs, is fixed, <span id="A1.T3.5.1" class="ltx_text ltx_font_smallcaps">FedFish</span> can achieve better performance than <span id="A1.T3.6.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> with fewer rounds of communication between the server and clients.</figcaption>
</figure>
<figure id="A1.F7" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="A1.F7.fig1" class="ltx_figure ltx_figure_panel">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/2311.10291/assets/x19.png" id="A1.F7.g1" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="160" height="98" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="A1.F7.fig2" class="ltx_figure ltx_figure_panel">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/2311.10291/assets/x20.png" id="A1.F7.g2" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="160" height="98" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="A1.F7.fig3" class="ltx_figure ltx_figure_panel">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2311.10291/assets/x21.png" id="A1.F7.g3" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="160" height="98" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Transfer performance on perplexity (lower is better) after federated pretraining on C4 and evaluating on C4 (<span id="A1.F7.4.1" class="ltx_text ltx_font_bold">left</span>), Stack Overflow (<span id="A1.F7.5.2" class="ltx_text ltx_font_bold">center</span>) and CC-News (<span id="A1.F7.6.3" class="ltx_text ltx_font_bold">right</span>).</figcaption>
</figure>
</section>
</section>
<section id="A1.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.4 </span>Additional Results</h3>

<div id="A1.SS4.p1" class="ltx_para ltx_noindent">
<p id="A1.SS4.p1.1" class="ltx_p">Here, we include additional results and report the performance visualized in <a href="#S5" title="5 Experiments ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">5</span></a>. <a href="#A1.T3" title="In A.3.3 Hardware Configuration ‣ A.3 Experimental Details ‣ Appendix A Appendix ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">3</span></a> shows results on image benchmarks where performance is computed by keeping either the computational requirement or the total number of rounds fixed. For the former, we limit the number of training rounds according to the number of local epochs so that total amount of client-side training remains constant. Unsurprisingly, allowing for more rounds of training helps performance. However, at fixed compute, we see that <span id="A1.SS4.p1.1.1" class="ltx_text ltx_font_smallcaps">FedFish</span> is able to achieve better performance than <span id="A1.SS4.p1.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> with fewer rounds of communication. <a href="#A1.T4" title="In A.4 Additional Results ‣ Appendix A Appendix ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">4</span></a> and <a href="#A1.T5" title="In A.4 Additional Results ‣ Appendix A Appendix ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">table</span> <span class="ltx_text ltx_ref_tag">5</span></a> include full results on our language modeling experiments, including different numbers of local training epochs, different datasets used for federated pretraining or personalization, different performance metrics and different amounts of data used for personalization. Finally, similar to <a href="#S5.F5" title="In 5.2.2 Post-Personalization Performance ‣ 5.2 Image Classification and Text Benchmarks ‣ 5 Experiments ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">5</span></a> with shows next-token prediction performance, we present perplexity performance for the C4 transfer experiments in <a href="#A1.F7" title="In A.3.3 Hardware Configuration ‣ A.3 Experimental Details ‣ Appendix A Appendix ‣ Leveraging Function Space Aggregation for Federated Learning at Scale" class="ltx_ref"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">7</span></a>.</p>
</div>
<figure id="A1.T4" class="ltx_table">
<div id="A1.T4.2" class="ltx_logical-block ltx_pruned_first ltx_align_center">
<div id="A1.T4.2.p2" class="ltx_para ltx_noindent ltx_align_center">
<div id="A1.T4.2.p2.1" class="ltx_inline-block ltx_transformed_outer" style="width:469.8pt;height:237.6pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-86.4pt,43.6pt) scale(0.73117,0.73117) ;">
<p id="A1.T4.2.p2.1.1" class="ltx_p"><span id="A1.T4.2.p2.1.1.1" class="ltx_text">
<span id="A1.T4.2.p2.1.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:642.5pt;height:325pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="A1.T4.2.p2.1.1.1.1.1" class="ltx_p"><span id="A1.T4.2.p2.1.1.1.1.1.1" class="ltx_text">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_thead">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1" class="ltx_tr">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.1.1" class="ltx_text">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.1.1.1.1" class="ltx_tr">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" class="ltx_text ltx_font_bold">Training</span></span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.1.1.1.2" class="ltx_tr">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1" class="ltx_text ltx_font_bold">Dataset</span></span></span>
</span></span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.2.1" class="ltx_text">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.2.1.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.2.1.1.1" class="ltx_tr">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.2.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1" class="ltx_text ltx_font_bold">Training Local</span></span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.2.1.1.2" class="ltx_tr">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.2.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.2.1.1.2.1.1" class="ltx_text ltx_font_bold">Epochs</span></span></span>
</span></span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.3.1" class="ltx_text">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.3.1.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.3.1.1.1" class="ltx_tr">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.3.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.3.1.1.1.1.1" class="ltx_text ltx_font_bold">Personalization</span></span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.3.1.1.2" class="ltx_tr">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.3.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.3.1.1.2.1.1" class="ltx_text ltx_font_bold">Dataset</span></span></span>
</span></span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.4.1" class="ltx_text ltx_font_bold">Method</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt ltx_colspan ltx_colspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.5.1" class="ltx_text ltx_font_bold">Global</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt ltx_colspan ltx_colspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.6.1" class="ltx_text ltx_font_bold">Personalized (25%)</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.1.1.7.1" class="ltx_text ltx_font_bold">Personalized (50%)</span></span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.2.2" class="ltx_tr">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.2.2.1.1" class="ltx_text ltx_font_bold">Token Pred</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.2.2.2.1" class="ltx_text ltx_font_bold">Perplexity</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.2.2.3.1" class="ltx_text ltx_font_bold">Token Pred</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.2.2.4.1" class="ltx_text ltx_font_bold">Perplexity</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.2.2.5.1" class="ltx_text ltx_font_bold">Token Pred</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.2.2.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.2.2.6.1" class="ltx_text ltx_font_bold">Perplexity</span></span></span>
</span>
<span class="ltx_tbody">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.3.1" class="ltx_tr">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.3.1.1.1" class="ltx_text ltx_font_bold">Stack Overflow</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.3.1.2.1" class="ltx_text ltx_font_bold">8</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.3.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.3.1.3.1" class="ltx_text ltx_font_bold">Stack Overflow</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.3.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.3.1.4.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedAvg</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.3.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">32.00</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.3.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">3.79</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.3.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">-</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.3.1.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">-</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.3.1.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">32.34</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.3.1.10" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">3.90</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.4.2" class="ltx_tr">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.4.2.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.4.2.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedFish</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.4.2.2" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">32.98</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.4.2.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">3.77</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.4.2.4" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">-</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.4.2.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">-</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.4.2.6" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">34.28</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.4.2.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">3.68</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.5.3" class="ltx_tr">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.5.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.5.3.1.1" class="ltx_text ltx_font_bold">16</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.5.3.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.5.3.2.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedAvg</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.5.3.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">21.77</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.5.3.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">5.56</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.5.3.5" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">-</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.5.3.6" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">-</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.5.3.7" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">25.46</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.5.3.8" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.61</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.6.4" class="ltx_tr">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.6.4.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.6.4.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedFish</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.6.4.2" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">31.27</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.6.4.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">3.96</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.6.4.4" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">-</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.6.4.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">-</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.6.4.6" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">32.60</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.6.4.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">3.81</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.7.5" class="ltx_tr">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.7.5.1.1" class="ltx_text ltx_font_bold">C4</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.7.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.7.5.2.1" class="ltx_text ltx_font_bold">1</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.7.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.7.5.3.1" class="ltx_text ltx_font_bold">C4</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.7.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.7.5.4.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedAvg</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.7.5.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">30.16</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.7.5.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.26</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.7.5.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">30.81</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.7.5.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.21</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.7.5.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">30.95</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.7.5.10" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.20</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.8.6" class="ltx_tr">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.8.6.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.8.6.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedFish</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.8.6.2" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">31.15</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.8.6.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.19</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.8.6.4" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">32.10</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.8.6.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.12</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.8.6.6" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">32.34</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.8.6.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.11</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.9.7" class="ltx_tr">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.9.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.9.7.1.1" class="ltx_text ltx_font_bold">16</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.9.7.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.9.7.2.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedAvg</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.9.7.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">31.04</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.9.7.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.13</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.9.7.5" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">32.26</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.9.7.6" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.12</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.9.7.7" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">32.73</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.9.7.8" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.08</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.10.8" class="ltx_tr">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.10.8.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.10.8.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedFish</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.10.8.2" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">32.37</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.10.8.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">3.99</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.10.8.4" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">33.54</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.10.8.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">3.92</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.10.8.6" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">33.98</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.10.8.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">3.87</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.11.9" class="ltx_tr">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.11.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.11.9.1.1" class="ltx_text ltx_font_bold">C4</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.11.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.11.9.2.1" class="ltx_text ltx_font_bold">1</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.11.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.11.9.3.1" class="ltx_text ltx_font_bold">Stack Overflow</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.11.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.11.9.4.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedAvg</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.11.9.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">17.91</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.11.9.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">5.29</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.11.9.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">19.85</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.11.9.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">5.13</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.11.9.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">21.58</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.11.9.10" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">5.03</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.12.10" class="ltx_tr">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.12.10.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.12.10.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedFish</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.12.10.2" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">19.55</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.12.10.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">5.101</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.12.10.4" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">22.07</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.12.10.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.91</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.12.10.6" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">23.38</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.12.10.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.815</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.13.11" class="ltx_tr">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.13.11.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.13.11.1.1" class="ltx_text ltx_font_bold">16</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.13.11.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.13.11.2.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedAvg</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.13.11.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">18.83</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.13.11.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">5.13</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.13.11.5" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">19.63</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.13.11.6" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">5.201</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.13.11.7" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">22.98</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.13.11.8" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.69</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.14.12" class="ltx_tr">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.14.12.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.14.12.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedFish</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.14.12.2" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">19.54</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.14.12.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">5.16</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.14.12.4" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">26.89</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.14.12.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.32</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.14.12.6" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">27.77</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.14.12.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.22</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.15.13" class="ltx_tr">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.15.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.15.13.1.1" class="ltx_text ltx_font_bold">C4</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.15.13.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.15.13.2.1" class="ltx_text ltx_font_bold">1</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.15.13.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.15.13.3.1" class="ltx_text ltx_font_bold">CC-News</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.15.13.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.15.13.4.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedAvg</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.15.13.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">29.03</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.15.13.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.38</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.15.13.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">29.45</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.15.13.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.34</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.15.13.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">29.73</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.15.13.10" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.31</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.16.14" class="ltx_tr">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.16.14.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.16.14.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedFish</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.16.14.2" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">29.53</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.16.14.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.41</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.16.14.4" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">30.14</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.16.14.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.35</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.16.14.6" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">30.61</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.16.14.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.32</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.17.15" class="ltx_tr">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.17.15.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.17.15.1.1" class="ltx_text ltx_font_bold">16</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.17.15.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.17.15.2.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedAvg</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.17.15.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">29.96</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.17.15.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.25</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.17.15.5" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">29.69</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.17.15.6" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.35</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.17.15.7" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">31.00</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.17.15.8" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.21</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.18.16" class="ltx_tr">
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.18.16.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T4.2.p2.1.1.1.1.1.1.1.18.16.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedFish</span></span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.18.16.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:2.5pt;padding-bottom:2.5pt;">31.00</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.18.16.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.15</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.18.16.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:2.5pt;padding-bottom:2.5pt;">31.75</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.18.16.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.08</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.18.16.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:2.5pt;padding-bottom:2.5pt;">32.58</span>
<span id="A1.T4.2.p2.1.1.1.1.1.1.1.18.16.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-top:2.5pt;padding-bottom:2.5pt;">3.98</span></span>
</span>
</span></span></span>
</span></span></span></p>
</span></div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Full results on global and post-personalization performance of language models that are pretrained in a federated manner with varying number of local epochs and then evaluated on different datasets. These results correspond to the entire <math id="A1.T4.4.m1.1" class="ltx_Math" alttext="R" display="inline"><semantics id="A1.T4.4.m1.1b"><mi id="A1.T4.4.m1.1.1" xref="A1.T4.4.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="A1.T4.4.m1.1c"><ci id="A1.T4.4.m1.1.1.cmml" xref="A1.T4.4.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.4.m1.1d">R</annotation></semantics></math> rounds of federated training.</figcaption>
</figure>
<figure id="A1.T5" class="ltx_table">
<div id="A1.T5.2" class="ltx_logical-block ltx_pruned_first ltx_align_center">
<div id="A1.T5.2.p2" class="ltx_para ltx_noindent ltx_align_center">
<div id="A1.T5.2.p2.1" class="ltx_inline-block ltx_transformed_outer" style="width:469.8pt;height:191.9pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-74.8pt,30.4pt) scale(0.75852,0.75852) ;">
<p id="A1.T5.2.p2.1.1" class="ltx_p"><span id="A1.T5.2.p2.1.1.1" class="ltx_text">
<span id="A1.T5.2.p2.1.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:619.3pt;height:253pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="A1.T5.2.p2.1.1.1.1.1" class="ltx_p"><span id="A1.T5.2.p2.1.1.1.1.1.1" class="ltx_text">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_thead">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1" class="ltx_tr">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.1.1" class="ltx_text">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.1.1.1.1" class="ltx_tr">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" class="ltx_text ltx_font_bold">Training</span></span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.1.1.1.2" class="ltx_tr">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1" class="ltx_text ltx_font_bold">Dataset</span></span></span>
</span></span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.2.1" class="ltx_text">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.2.1.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.2.1.1.1" class="ltx_tr">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.2.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1" class="ltx_text ltx_font_bold">Training Local</span></span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.2.1.1.2" class="ltx_tr">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.2.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.2.1.1.2.1.1" class="ltx_text ltx_font_bold">Epochs</span></span></span>
</span></span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.3.1" class="ltx_text">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.3.1.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.3.1.1.1" class="ltx_tr">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.3.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.3.1.1.1.1.1" class="ltx_text ltx_font_bold">Personalization</span></span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.3.1.1.2" class="ltx_tr">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.3.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.3.1.1.2.1.1" class="ltx_text ltx_font_bold">Dataset</span></span></span>
</span></span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.4.1" class="ltx_text ltx_font_bold">Method</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt ltx_colspan ltx_colspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.5.1" class="ltx_text ltx_font_bold">Global</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt ltx_colspan ltx_colspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.6.1" class="ltx_text ltx_font_bold">Personalized (25%)</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.1.1.7.1" class="ltx_text ltx_font_bold">Personalized (50%)</span></span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.2.2" class="ltx_tr">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.2.2.1.1" class="ltx_text ltx_font_bold">Token Pred</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.2.2.2.1" class="ltx_text ltx_font_bold">Perplexity</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.2.2.3.1" class="ltx_text ltx_font_bold">Token Pred</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.2.2.4.1" class="ltx_text ltx_font_bold">Perplexity</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.2.2.5.1" class="ltx_text ltx_font_bold">Token Pred</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.2.2.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.2.2.6.1" class="ltx_text ltx_font_bold">Perplexity</span></span></span>
</span>
<span class="ltx_tbody">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.3.1" class="ltx_tr">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_12" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.3.1.1.1" class="ltx_text ltx_font_bold">C4</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.3.1.2.1" class="ltx_text ltx_font_bold">1</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.3.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.3.1.3.1" class="ltx_text ltx_font_bold">C4</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.3.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.3.1.4.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedAvg</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.3.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">26.82</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.3.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.67</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.3.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">27.56</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.3.1.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.61</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.3.1.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">27.73</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.3.1.10" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.60</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.4.2" class="ltx_tr">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.4.2.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.4.2.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedFish</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.4.2.2" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">27.69</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.4.2.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.63</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.4.2.4" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">28.70</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.4.2.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.55</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.4.2.6" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">28.91</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.4.2.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.54</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.5.3" class="ltx_tr">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.5.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.5.3.1.1" class="ltx_text ltx_font_bold">16</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.5.3.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.5.3.2.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedAvg</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.5.3.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">28.63</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.5.3.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.42</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.5.3.5" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">29.84</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.5.3.6" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.37</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.5.3.7" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">30.11</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.5.3.8" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.39</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.6.4" class="ltx_tr">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.6.4.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.6.4.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedFish</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.6.4.2" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">30.33</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.6.4.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.28</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.6.4.4" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">31.54</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.6.4.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.11</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.6.4.6" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">31.61</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.6.4.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.10</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.7.5" class="ltx_tr">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.7.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.7.5.1.1" class="ltx_text ltx_font_bold">1</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.7.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.7.5.2.1" class="ltx_text ltx_font_bold">Stack Overflow</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.7.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.7.5.3.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedAvg</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.7.5.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">17.10</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.7.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">5.38</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.7.5.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">19.92</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.7.5.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">5.20</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.7.5.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">21.78</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.7.5.9" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">5.10</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.8.6" class="ltx_tr">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.8.6.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.8.6.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedFish</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.8.6.2" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">17.25</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.8.6.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">5.41</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.8.6.4" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">19.62</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.8.6.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">5.2</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.8.6.6" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">21.10</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.8.6.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">5.08</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.9.7" class="ltx_tr">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.9.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.9.7.1.1" class="ltx_text ltx_font_bold">16</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.9.7.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.9.7.2.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedAvg</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.9.7.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">18.57</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.9.7.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">5.29</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.9.7.5" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">16.23</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.9.7.6" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">7.03</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.9.7.7" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">18.91</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.9.7.8" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">6.09</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.10.8" class="ltx_tr">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.10.8.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.10.8.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedFish</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.10.8.2" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">17.80</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.10.8.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">5.42</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.10.8.4" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">20.81</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.10.8.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.77</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.10.8.6" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">22.78</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.10.8.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.58</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.11.9" class="ltx_tr">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.11.9.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.11.9.1.1" class="ltx_text ltx_font_bold">1</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.11.9.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.11.9.2.1" class="ltx_text ltx_font_bold">CC-News</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.11.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.11.9.3.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedAvg</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.11.9.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">26.03</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.11.9.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.79</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.11.9.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">26.44</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.11.9.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.75</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.11.9.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">26.72</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.11.9.9" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.72</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.12.10" class="ltx_tr">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.12.10.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.12.10.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedFish</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.12.10.2" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">26.23</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.12.10.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.86</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.12.10.4" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">26.88</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.12.10.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.80</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.12.10.6" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">27.34</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.12.10.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.76</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.13.11" class="ltx_tr">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.13.11.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_rowspan ltx_rowspan_2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.13.11.1.1" class="ltx_text ltx_font_bold">16</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.13.11.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.13.11.2.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedAvg</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.13.11.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">27.55</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.13.11.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.58</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.13.11.5" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">27.23</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.13.11.6" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.59</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.13.11.7" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">28.02</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.13.11.8" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.55</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.14.12" class="ltx_tr">
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.14.12.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="A1.T5.2.p2.1.1.1.1.1.1.1.14.12.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedFish</span></span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.14.12.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:2.5pt;padding-bottom:2.5pt;">28.91</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.14.12.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.44</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.14.12.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:2.5pt;padding-bottom:2.5pt;">29.86</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.14.12.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.29</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.14.12.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:2.5pt;padding-bottom:2.5pt;">30.06</span>
<span id="A1.T5.2.p2.1.1.1.1.1.1.1.14.12.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.27</span></span>
</span>
</span></span></span>
</span></span></span></p>
</span></div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Results on global and post-personalization performance of language models in different settings, evaluated at <math id="A1.T5.4.m1.1" class="ltx_Math" alttext="R/2" display="inline"><semantics id="A1.T5.4.m1.1b"><mrow id="A1.T5.4.m1.1.1" xref="A1.T5.4.m1.1.1.cmml"><mi id="A1.T5.4.m1.1.1.2" xref="A1.T5.4.m1.1.1.2.cmml">R</mi><mo id="A1.T5.4.m1.1.1.1" xref="A1.T5.4.m1.1.1.1.cmml">/</mo><mn id="A1.T5.4.m1.1.1.3" xref="A1.T5.4.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.4.m1.1c"><apply id="A1.T5.4.m1.1.1.cmml" xref="A1.T5.4.m1.1.1"><divide id="A1.T5.4.m1.1.1.1.cmml" xref="A1.T5.4.m1.1.1.1"></divide><ci id="A1.T5.4.m1.1.1.2.cmml" xref="A1.T5.4.m1.1.1.2">𝑅</ci><cn type="integer" id="A1.T5.4.m1.1.1.3.cmml" xref="A1.T5.4.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.4.m1.1d">R/2</annotation></semantics></math> rounds of federated training.</figcaption>
</figure>
</section>
<section id="A1.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.5 </span>Additional Related Works</h3>

<section id="A1.SS5.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Linear Mode Connectivity.</h5>

<div id="A1.SS5.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="A1.SS5.SSS0.Px1.p1.8" class="ltx_p"><cite class="ltx_cite ltx_citemacro_cite">Frankle et al. (<a href="#bib.bib14" title="" class="ltx_ref">2020</a>)</cite>
The Client-Server Barrier is largely inspired by the error barrier definition in <cite class="ltx_cite ltx_citemacro_citet">Fort et al. (<a href="#bib.bib13" title="" class="ltx_ref">2020</a>)</cite>.
There the authors define an error barrier as the maximum increase in error on a linear path in the parameter space between two models.
There are a few key differences between the error barrier and client-server barrier: they consider models trained on the same training data; using our notation, the losses <math id="A1.SS5.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="L_{i}" display="inline"><semantics id="A1.SS5.SSS0.Px1.p1.1.m1.1a"><msub id="A1.SS5.SSS0.Px1.p1.1.m1.1.1" xref="A1.SS5.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="A1.SS5.SSS0.Px1.p1.1.m1.1.1.2" xref="A1.SS5.SSS0.Px1.p1.1.m1.1.1.2.cmml">L</mi><mi id="A1.SS5.SSS0.Px1.p1.1.m1.1.1.3" xref="A1.SS5.SSS0.Px1.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS0.Px1.p1.1.m1.1b"><apply id="A1.SS5.SSS0.Px1.p1.1.m1.1.1.cmml" xref="A1.SS5.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS5.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="A1.SS5.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="A1.SS5.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="A1.SS5.SSS0.Px1.p1.1.m1.1.1.2">𝐿</ci><ci id="A1.SS5.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="A1.SS5.SSS0.Px1.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS0.Px1.p1.1.m1.1c">L_{i}</annotation></semantics></math> are identical for all <math id="A1.SS5.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="A1.SS5.SSS0.Px1.p1.2.m2.1a"><mi id="A1.SS5.SSS0.Px1.p1.2.m2.1.1" xref="A1.SS5.SSS0.Px1.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS0.Px1.p1.2.m2.1b"><ci id="A1.SS5.SSS0.Px1.p1.2.m2.1.1.cmml" xref="A1.SS5.SSS0.Px1.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS0.Px1.p1.2.m2.1c">i</annotation></semantics></math>; <math id="A1.SS5.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="A1.SS5.SSS0.Px1.p1.3.m3.1a"><mi id="A1.SS5.SSS0.Px1.p1.3.m3.1.1" xref="A1.SS5.SSS0.Px1.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS0.Px1.p1.3.m3.1b"><ci id="A1.SS5.SSS0.Px1.p1.3.m3.1.1.cmml" xref="A1.SS5.SSS0.Px1.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS0.Px1.p1.3.m3.1c">i</annotation></semantics></math> indexes over different models <math id="A1.SS5.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="{\mathbf{\theta}}_{i}" display="inline"><semantics id="A1.SS5.SSS0.Px1.p1.4.m4.1a"><msub id="A1.SS5.SSS0.Px1.p1.4.m4.1.1" xref="A1.SS5.SSS0.Px1.p1.4.m4.1.1.cmml"><mi id="A1.SS5.SSS0.Px1.p1.4.m4.1.1.2" xref="A1.SS5.SSS0.Px1.p1.4.m4.1.1.2.cmml">θ</mi><mi id="A1.SS5.SSS0.Px1.p1.4.m4.1.1.3" xref="A1.SS5.SSS0.Px1.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS0.Px1.p1.4.m4.1b"><apply id="A1.SS5.SSS0.Px1.p1.4.m4.1.1.cmml" xref="A1.SS5.SSS0.Px1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS5.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="A1.SS5.SSS0.Px1.p1.4.m4.1.1">subscript</csymbol><ci id="A1.SS5.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="A1.SS5.SSS0.Px1.p1.4.m4.1.1.2">𝜃</ci><ci id="A1.SS5.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="A1.SS5.SSS0.Px1.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS0.Px1.p1.4.m4.1c">{\mathbf{\theta}}_{i}</annotation></semantics></math> (e.g., models trained in the same centralized way but independently). The error barrier corresponds then to the maximum over <math id="A1.SS5.SSS0.Px1.p1.5.m5.4" class="ltx_Math" alttext="\{w_{i}\}_{i=1,\dots,N}" display="inline"><semantics id="A1.SS5.SSS0.Px1.p1.5.m5.4a"><msub id="A1.SS5.SSS0.Px1.p1.5.m5.4.4" xref="A1.SS5.SSS0.Px1.p1.5.m5.4.4.cmml"><mrow id="A1.SS5.SSS0.Px1.p1.5.m5.4.4.1.1" xref="A1.SS5.SSS0.Px1.p1.5.m5.4.4.1.2.cmml"><mo stretchy="false" id="A1.SS5.SSS0.Px1.p1.5.m5.4.4.1.1.2" xref="A1.SS5.SSS0.Px1.p1.5.m5.4.4.1.2.cmml">{</mo><msub id="A1.SS5.SSS0.Px1.p1.5.m5.4.4.1.1.1" xref="A1.SS5.SSS0.Px1.p1.5.m5.4.4.1.1.1.cmml"><mi id="A1.SS5.SSS0.Px1.p1.5.m5.4.4.1.1.1.2" xref="A1.SS5.SSS0.Px1.p1.5.m5.4.4.1.1.1.2.cmml">w</mi><mi id="A1.SS5.SSS0.Px1.p1.5.m5.4.4.1.1.1.3" xref="A1.SS5.SSS0.Px1.p1.5.m5.4.4.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A1.SS5.SSS0.Px1.p1.5.m5.4.4.1.1.3" xref="A1.SS5.SSS0.Px1.p1.5.m5.4.4.1.2.cmml">}</mo></mrow><mrow id="A1.SS5.SSS0.Px1.p1.5.m5.3.3.3" xref="A1.SS5.SSS0.Px1.p1.5.m5.3.3.3.cmml"><mi id="A1.SS5.SSS0.Px1.p1.5.m5.3.3.3.5" xref="A1.SS5.SSS0.Px1.p1.5.m5.3.3.3.5.cmml">i</mi><mo id="A1.SS5.SSS0.Px1.p1.5.m5.3.3.3.4" xref="A1.SS5.SSS0.Px1.p1.5.m5.3.3.3.4.cmml">=</mo><mrow id="A1.SS5.SSS0.Px1.p1.5.m5.3.3.3.6.2" xref="A1.SS5.SSS0.Px1.p1.5.m5.3.3.3.6.1.cmml"><mn id="A1.SS5.SSS0.Px1.p1.5.m5.1.1.1.1" xref="A1.SS5.SSS0.Px1.p1.5.m5.1.1.1.1.cmml">1</mn><mo id="A1.SS5.SSS0.Px1.p1.5.m5.3.3.3.6.2.1" xref="A1.SS5.SSS0.Px1.p1.5.m5.3.3.3.6.1.cmml">,</mo><mi mathvariant="normal" id="A1.SS5.SSS0.Px1.p1.5.m5.2.2.2.2" xref="A1.SS5.SSS0.Px1.p1.5.m5.2.2.2.2.cmml">…</mi><mo id="A1.SS5.SSS0.Px1.p1.5.m5.3.3.3.6.2.2" xref="A1.SS5.SSS0.Px1.p1.5.m5.3.3.3.6.1.cmml">,</mo><mi id="A1.SS5.SSS0.Px1.p1.5.m5.3.3.3.3" xref="A1.SS5.SSS0.Px1.p1.5.m5.3.3.3.3.cmml">N</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS0.Px1.p1.5.m5.4b"><apply id="A1.SS5.SSS0.Px1.p1.5.m5.4.4.cmml" xref="A1.SS5.SSS0.Px1.p1.5.m5.4.4"><csymbol cd="ambiguous" id="A1.SS5.SSS0.Px1.p1.5.m5.4.4.2.cmml" xref="A1.SS5.SSS0.Px1.p1.5.m5.4.4">subscript</csymbol><set id="A1.SS5.SSS0.Px1.p1.5.m5.4.4.1.2.cmml" xref="A1.SS5.SSS0.Px1.p1.5.m5.4.4.1.1"><apply id="A1.SS5.SSS0.Px1.p1.5.m5.4.4.1.1.1.cmml" xref="A1.SS5.SSS0.Px1.p1.5.m5.4.4.1.1.1"><csymbol cd="ambiguous" id="A1.SS5.SSS0.Px1.p1.5.m5.4.4.1.1.1.1.cmml" xref="A1.SS5.SSS0.Px1.p1.5.m5.4.4.1.1.1">subscript</csymbol><ci id="A1.SS5.SSS0.Px1.p1.5.m5.4.4.1.1.1.2.cmml" xref="A1.SS5.SSS0.Px1.p1.5.m5.4.4.1.1.1.2">𝑤</ci><ci id="A1.SS5.SSS0.Px1.p1.5.m5.4.4.1.1.1.3.cmml" xref="A1.SS5.SSS0.Px1.p1.5.m5.4.4.1.1.1.3">𝑖</ci></apply></set><apply id="A1.SS5.SSS0.Px1.p1.5.m5.3.3.3.cmml" xref="A1.SS5.SSS0.Px1.p1.5.m5.3.3.3"><eq id="A1.SS5.SSS0.Px1.p1.5.m5.3.3.3.4.cmml" xref="A1.SS5.SSS0.Px1.p1.5.m5.3.3.3.4"></eq><ci id="A1.SS5.SSS0.Px1.p1.5.m5.3.3.3.5.cmml" xref="A1.SS5.SSS0.Px1.p1.5.m5.3.3.3.5">𝑖</ci><list id="A1.SS5.SSS0.Px1.p1.5.m5.3.3.3.6.1.cmml" xref="A1.SS5.SSS0.Px1.p1.5.m5.3.3.3.6.2"><cn type="integer" id="A1.SS5.SSS0.Px1.p1.5.m5.1.1.1.1.cmml" xref="A1.SS5.SSS0.Px1.p1.5.m5.1.1.1.1">1</cn><ci id="A1.SS5.SSS0.Px1.p1.5.m5.2.2.2.2.cmml" xref="A1.SS5.SSS0.Px1.p1.5.m5.2.2.2.2">…</ci><ci id="A1.SS5.SSS0.Px1.p1.5.m5.3.3.3.3.cmml" xref="A1.SS5.SSS0.Px1.p1.5.m5.3.3.3.3">𝑁</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS0.Px1.p1.5.m5.4c">\{w_{i}\}_{i=1,\dots,N}</annotation></semantics></math>, where <math id="A1.SS5.SSS0.Px1.p1.6.m6.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="A1.SS5.SSS0.Px1.p1.6.m6.1a"><msub id="A1.SS5.SSS0.Px1.p1.6.m6.1.1" xref="A1.SS5.SSS0.Px1.p1.6.m6.1.1.cmml"><mi id="A1.SS5.SSS0.Px1.p1.6.m6.1.1.2" xref="A1.SS5.SSS0.Px1.p1.6.m6.1.1.2.cmml">w</mi><mi id="A1.SS5.SSS0.Px1.p1.6.m6.1.1.3" xref="A1.SS5.SSS0.Px1.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS0.Px1.p1.6.m6.1b"><apply id="A1.SS5.SSS0.Px1.p1.6.m6.1.1.cmml" xref="A1.SS5.SSS0.Px1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="A1.SS5.SSS0.Px1.p1.6.m6.1.1.1.cmml" xref="A1.SS5.SSS0.Px1.p1.6.m6.1.1">subscript</csymbol><ci id="A1.SS5.SSS0.Px1.p1.6.m6.1.1.2.cmml" xref="A1.SS5.SSS0.Px1.p1.6.m6.1.1.2">𝑤</ci><ci id="A1.SS5.SSS0.Px1.p1.6.m6.1.1.3.cmml" xref="A1.SS5.SSS0.Px1.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS0.Px1.p1.6.m6.1c">w_{i}</annotation></semantics></math> is the weight corresponding to <math id="A1.SS5.SSS0.Px1.p1.7.m7.1" class="ltx_Math" alttext="{\mathbf{\theta}}_{i}" display="inline"><semantics id="A1.SS5.SSS0.Px1.p1.7.m7.1a"><msub id="A1.SS5.SSS0.Px1.p1.7.m7.1.1" xref="A1.SS5.SSS0.Px1.p1.7.m7.1.1.cmml"><mi id="A1.SS5.SSS0.Px1.p1.7.m7.1.1.2" xref="A1.SS5.SSS0.Px1.p1.7.m7.1.1.2.cmml">θ</mi><mi id="A1.SS5.SSS0.Px1.p1.7.m7.1.1.3" xref="A1.SS5.SSS0.Px1.p1.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS0.Px1.p1.7.m7.1b"><apply id="A1.SS5.SSS0.Px1.p1.7.m7.1.1.cmml" xref="A1.SS5.SSS0.Px1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="A1.SS5.SSS0.Px1.p1.7.m7.1.1.1.cmml" xref="A1.SS5.SSS0.Px1.p1.7.m7.1.1">subscript</csymbol><ci id="A1.SS5.SSS0.Px1.p1.7.m7.1.1.2.cmml" xref="A1.SS5.SSS0.Px1.p1.7.m7.1.1.2">𝜃</ci><ci id="A1.SS5.SSS0.Px1.p1.7.m7.1.1.3.cmml" xref="A1.SS5.SSS0.Px1.p1.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS0.Px1.p1.7.m7.1c">{\mathbf{\theta}}_{i}</annotation></semantics></math> when linearly interpolating between <math id="A1.SS5.SSS0.Px1.p1.8.m8.4" class="ltx_Math" alttext="\{{\mathbf{\theta}}_{i}\}_{i=1,\dots,N}" display="inline"><semantics id="A1.SS5.SSS0.Px1.p1.8.m8.4a"><msub id="A1.SS5.SSS0.Px1.p1.8.m8.4.4" xref="A1.SS5.SSS0.Px1.p1.8.m8.4.4.cmml"><mrow id="A1.SS5.SSS0.Px1.p1.8.m8.4.4.1.1" xref="A1.SS5.SSS0.Px1.p1.8.m8.4.4.1.2.cmml"><mo stretchy="false" id="A1.SS5.SSS0.Px1.p1.8.m8.4.4.1.1.2" xref="A1.SS5.SSS0.Px1.p1.8.m8.4.4.1.2.cmml">{</mo><msub id="A1.SS5.SSS0.Px1.p1.8.m8.4.4.1.1.1" xref="A1.SS5.SSS0.Px1.p1.8.m8.4.4.1.1.1.cmml"><mi id="A1.SS5.SSS0.Px1.p1.8.m8.4.4.1.1.1.2" xref="A1.SS5.SSS0.Px1.p1.8.m8.4.4.1.1.1.2.cmml">θ</mi><mi id="A1.SS5.SSS0.Px1.p1.8.m8.4.4.1.1.1.3" xref="A1.SS5.SSS0.Px1.p1.8.m8.4.4.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A1.SS5.SSS0.Px1.p1.8.m8.4.4.1.1.3" xref="A1.SS5.SSS0.Px1.p1.8.m8.4.4.1.2.cmml">}</mo></mrow><mrow id="A1.SS5.SSS0.Px1.p1.8.m8.3.3.3" xref="A1.SS5.SSS0.Px1.p1.8.m8.3.3.3.cmml"><mi id="A1.SS5.SSS0.Px1.p1.8.m8.3.3.3.5" xref="A1.SS5.SSS0.Px1.p1.8.m8.3.3.3.5.cmml">i</mi><mo id="A1.SS5.SSS0.Px1.p1.8.m8.3.3.3.4" xref="A1.SS5.SSS0.Px1.p1.8.m8.3.3.3.4.cmml">=</mo><mrow id="A1.SS5.SSS0.Px1.p1.8.m8.3.3.3.6.2" xref="A1.SS5.SSS0.Px1.p1.8.m8.3.3.3.6.1.cmml"><mn id="A1.SS5.SSS0.Px1.p1.8.m8.1.1.1.1" xref="A1.SS5.SSS0.Px1.p1.8.m8.1.1.1.1.cmml">1</mn><mo id="A1.SS5.SSS0.Px1.p1.8.m8.3.3.3.6.2.1" xref="A1.SS5.SSS0.Px1.p1.8.m8.3.3.3.6.1.cmml">,</mo><mi mathvariant="normal" id="A1.SS5.SSS0.Px1.p1.8.m8.2.2.2.2" xref="A1.SS5.SSS0.Px1.p1.8.m8.2.2.2.2.cmml">…</mi><mo id="A1.SS5.SSS0.Px1.p1.8.m8.3.3.3.6.2.2" xref="A1.SS5.SSS0.Px1.p1.8.m8.3.3.3.6.1.cmml">,</mo><mi id="A1.SS5.SSS0.Px1.p1.8.m8.3.3.3.3" xref="A1.SS5.SSS0.Px1.p1.8.m8.3.3.3.3.cmml">N</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS5.SSS0.Px1.p1.8.m8.4b"><apply id="A1.SS5.SSS0.Px1.p1.8.m8.4.4.cmml" xref="A1.SS5.SSS0.Px1.p1.8.m8.4.4"><csymbol cd="ambiguous" id="A1.SS5.SSS0.Px1.p1.8.m8.4.4.2.cmml" xref="A1.SS5.SSS0.Px1.p1.8.m8.4.4">subscript</csymbol><set id="A1.SS5.SSS0.Px1.p1.8.m8.4.4.1.2.cmml" xref="A1.SS5.SSS0.Px1.p1.8.m8.4.4.1.1"><apply id="A1.SS5.SSS0.Px1.p1.8.m8.4.4.1.1.1.cmml" xref="A1.SS5.SSS0.Px1.p1.8.m8.4.4.1.1.1"><csymbol cd="ambiguous" id="A1.SS5.SSS0.Px1.p1.8.m8.4.4.1.1.1.1.cmml" xref="A1.SS5.SSS0.Px1.p1.8.m8.4.4.1.1.1">subscript</csymbol><ci id="A1.SS5.SSS0.Px1.p1.8.m8.4.4.1.1.1.2.cmml" xref="A1.SS5.SSS0.Px1.p1.8.m8.4.4.1.1.1.2">𝜃</ci><ci id="A1.SS5.SSS0.Px1.p1.8.m8.4.4.1.1.1.3.cmml" xref="A1.SS5.SSS0.Px1.p1.8.m8.4.4.1.1.1.3">𝑖</ci></apply></set><apply id="A1.SS5.SSS0.Px1.p1.8.m8.3.3.3.cmml" xref="A1.SS5.SSS0.Px1.p1.8.m8.3.3.3"><eq id="A1.SS5.SSS0.Px1.p1.8.m8.3.3.3.4.cmml" xref="A1.SS5.SSS0.Px1.p1.8.m8.3.3.3.4"></eq><ci id="A1.SS5.SSS0.Px1.p1.8.m8.3.3.3.5.cmml" xref="A1.SS5.SSS0.Px1.p1.8.m8.3.3.3.5">𝑖</ci><list id="A1.SS5.SSS0.Px1.p1.8.m8.3.3.3.6.1.cmml" xref="A1.SS5.SSS0.Px1.p1.8.m8.3.3.3.6.2"><cn type="integer" id="A1.SS5.SSS0.Px1.p1.8.m8.1.1.1.1.cmml" xref="A1.SS5.SSS0.Px1.p1.8.m8.1.1.1.1">1</cn><ci id="A1.SS5.SSS0.Px1.p1.8.m8.2.2.2.2.cmml" xref="A1.SS5.SSS0.Px1.p1.8.m8.2.2.2.2">…</ci><ci id="A1.SS5.SSS0.Px1.p1.8.m8.3.3.3.3.cmml" xref="A1.SS5.SSS0.Px1.p1.8.m8.3.3.3.3">𝑁</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.SSS0.Px1.p1.8.m8.4c">\{{\mathbf{\theta}}_{i}\}_{i=1,\dots,N}</annotation></semantics></math>.
Prior to <cite class="ltx_cite ltx_citemacro_citet">Fort et al. (<a href="#bib.bib13" title="" class="ltx_ref">2020</a>)</cite>, error barriers appeared under “instability” definition in <cite class="ltx_cite ltx_citemacro_citet">Frankle et al. (<a href="#bib.bib14" title="" class="ltx_ref">2020</a>)</cite> for evaluating how different trajectories of a pair of networks connect in the loss landscape.
Later, similar metrics were used in other model averaging work, such as <cite class="ltx_cite ltx_citemacro_citet">Wortsman et al. (<a href="#bib.bib41" title="" class="ltx_ref">2022</a>)</cite>, where the authors consider multiple networks trained with different hyperparameters.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2311.10290" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2311.10291" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2311.10291">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2311.10291" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2311.10292" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Feb 27 18:44:43 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
