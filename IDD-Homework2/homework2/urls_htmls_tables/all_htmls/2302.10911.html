<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2302.10911] Revisiting Weighted Aggregation in Federated Learning with Neural Networks</title><meta property="og:description" content="In federated learning (FL), weighted aggregation of local models is conducted to generate a global model, and the aggregation weights are normalized (the sum of weights is 1) and proportional to the local data sizes. I…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Revisiting Weighted Aggregation in Federated Learning with Neural Networks">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Revisiting Weighted Aggregation in Federated Learning with Neural Networks">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2302.10911">

<!--Generated on Fri Mar  1 01:25:36 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Federated learning,  Deep learning,  Weighted aggregation,  Neural networks,  Training dynamics">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_pruned_first">
<h1 class="ltx_title ltx_title_document">Revisiting Weighted Aggregation in Federated Learning with Neural Networks</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zexi Li
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Tao Lin
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xinyi Shang
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Chao Wu
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">In federated learning (FL), weighted aggregation of local models is conducted to generate a global model, and the aggregation weights are normalized (the sum of weights is 1) and proportional to the local data sizes. In this paper, we revisit the weighted aggregation process and gain new insights into the training dynamics of FL. First, we find that the sum of weights can be smaller than 1, causing <em id="id1.id1.1" class="ltx_emph ltx_font_italic">global weight shrinking</em> effect (analogous to weight decay) and improving generalization. We explore how the optimal shrinking factor is affected by clients’ data heterogeneity and local epochs. Second, we dive into the relative aggregation weights among clients to depict the clients’ importance. We develop <em id="id1.id1.2" class="ltx_emph ltx_font_italic">client coherence</em> to study the learning dynamics and find a critical point that exists. Before entering the critical point, more coherent clients play more essential roles in generalization.
Based on the above insights, we propose an effective method for <span id="id1.id1.3" class="ltx_text ltx_font_bold">Fed</span>erated Learning with <span id="id1.id1.4" class="ltx_text ltx_font_bold">L</span>earnable <span id="id1.id1.5" class="ltx_text ltx_font_bold">A</span>ggregation <span id="id1.id1.6" class="ltx_text ltx_font_bold">W</span>eights, named as <span id="id1.id1.7" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedLAW</span> (<a target="_blank" href="https://github.com/ZexiLee/ICML-2023-FedLAW" title="" class="ltx_ref ltx_href"><span id="id1.id1.8.1" class="ltx_ERROR undefined">\faGithub</span> source code</a>). Extensive experiments verify that our method can improve the generalization of the global model by a large margin on different datasets and models.</p>
</div>
<div class="ltx_keywords">Federated learning, Deep learning, Weighted aggregation, Neural networks, Training dynamics
</div>
<div id="p2" class="ltx_para">
<br class="ltx_break">
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.4" class="ltx_p">Federated learning (FL) <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib42" title="" class="ltx_ref">2017</a>; Li et al., <a href="#bib.bib33" title="" class="ltx_ref">2020a</a>; Wang et al., <a href="#bib.bib49" title="" class="ltx_ref">2021</a>; Lin et al., <a href="#bib.bib38" title="" class="ltx_ref">2020</a>; Li et al., <a href="#bib.bib37" title="" class="ltx_ref">2022c</a>)</cite> is a promising distributed optimization paradigm where clients’ data are kept local, and a central server aggregates clients’ local gradients for collaborative training.
In FL, weighted aggregation of local models is conducted to generate a global model. In FL, when aggregating local models, it is a common practice that the aggregation weights should be normalized (the sum of weights, i.e. the <math id="S1.p1.1.m1.1" class="ltx_Math" alttext="l_{1}" display="inline"><semantics id="S1.p1.1.m1.1a"><msub id="S1.p1.1.m1.1.1" xref="S1.p1.1.m1.1.1.cmml"><mi id="S1.p1.1.m1.1.1.2" xref="S1.p1.1.m1.1.1.2.cmml">l</mi><mn id="S1.p1.1.m1.1.1.3" xref="S1.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p1.1.m1.1b"><apply id="S1.p1.1.m1.1.1.cmml" xref="S1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p1.1.m1.1.1.1.cmml" xref="S1.p1.1.m1.1.1">subscript</csymbol><ci id="S1.p1.1.m1.1.1.2.cmml" xref="S1.p1.1.m1.1.1.2">𝑙</ci><cn type="integer" id="S1.p1.1.m1.1.1.3.cmml" xref="S1.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.1.m1.1c">l_{1}</annotation></semantics></math> norm, notated as <math id="S1.p1.2.m2.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S1.p1.2.m2.1a"><mi id="S1.p1.2.m2.1.1" xref="S1.p1.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S1.p1.2.m2.1b"><ci id="S1.p1.2.m2.1.1.cmml" xref="S1.p1.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.2.m2.1c">\gamma</annotation></semantics></math>, is equal to 1) and proportional to the local data sizes. However, due to the non-convexity <cite class="ltx_cite ltx_citemacro_citep">(Allen-Zhu et al., <a href="#bib.bib2" title="" class="ltx_ref">2019</a>; Li et al., <a href="#bib.bib31" title="" class="ltx_ref">2018</a>)</cite>, over-parameterization <cite class="ltx_cite ltx_citemacro_citep">(Allen-Zhu et al., <a href="#bib.bib2" title="" class="ltx_ref">2019</a>; Zou &amp; Gu, <a href="#bib.bib58" title="" class="ltx_ref">2019</a>)</cite>, scale invariance <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib31" title="" class="ltx_ref">2018</a>; Dinh et al., <a href="#bib.bib9" title="" class="ltx_ref">2017</a>; Kwon et al., <a href="#bib.bib29" title="" class="ltx_ref">2021</a>)</cite>, and other unique properties of deep neural networks (DNNs), there is a gap between theory and empirical practice when the models are DNNs. An intuitive example is shown in <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 1</span></a>, we find that smaller <math id="S1.p1.3.m3.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S1.p1.3.m3.1a"><mi id="S1.p1.3.m3.1.1" xref="S1.p1.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S1.p1.3.m3.1b"><ci id="S1.p1.3.m3.1.1.cmml" xref="S1.p1.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.3.m3.1c">\gamma</annotation></semantics></math> may be beneficial to generalization, which challenges the previous convention in theory that aggregation weights should be normalized as 1. But what is the mechanism behind and what is the optimal <math id="S1.p1.4.m4.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S1.p1.4.m4.1a"><mi id="S1.p1.4.m4.1.1" xref="S1.p1.4.m4.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S1.p1.4.m4.1b"><ci id="S1.p1.4.m4.1.1.cmml" xref="S1.p1.4.m4.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.4.m4.1c">\gamma</annotation></semantics></math> under different FL environments? It requires further investigation.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Thus, in this paper, we revisit and rethink the weighted aggregation process to understand the training dynamics of FL and gain some intriguing insights.</p>
<p id="S1.p2.2" class="ltx_p ltx_align_center"><em id="S1.p2.2.1" class="ltx_emph ltx_font_italic">How can the aggregation weights be assigned to generate a global DNN model with better generalization?</em></p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2302.10911/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="322" height="213" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span id="S1.F1.4.2" class="ltx_text" style="font-size:90%;">Test accuracy curves with different <math id="S1.F1.3.1.m1.1" class="ltx_Math" alttext="l_{1}" display="inline"><semantics id="S1.F1.3.1.m1.1b"><msub id="S1.F1.3.1.m1.1.1" xref="S1.F1.3.1.m1.1.1.cmml"><mi id="S1.F1.3.1.m1.1.1.2" xref="S1.F1.3.1.m1.1.1.2.cmml">l</mi><mn id="S1.F1.3.1.m1.1.1.3" xref="S1.F1.3.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.F1.3.1.m1.1c"><apply id="S1.F1.3.1.m1.1.1.cmml" xref="S1.F1.3.1.m1.1.1"><csymbol cd="ambiguous" id="S1.F1.3.1.m1.1.1.1.cmml" xref="S1.F1.3.1.m1.1.1">subscript</csymbol><ci id="S1.F1.3.1.m1.1.1.2.cmml" xref="S1.F1.3.1.m1.1.1.2">𝑙</ci><cn type="integer" id="S1.F1.3.1.m1.1.1.3.cmml" xref="S1.F1.3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.3.1.m1.1d">l_{1}</annotation></semantics></math> norms of aggregation weights (<math id="S1.F1.4.2.m2.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S1.F1.4.2.m2.1b"><mi id="S1.F1.4.2.m2.1.1" xref="S1.F1.4.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S1.F1.4.2.m2.1c"><ci id="S1.F1.4.2.m2.1.1.cmml" xref="S1.F1.4.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.4.2.m2.1d">\gamma</annotation></semantics></math>). CIFAR-10 with 20 clients, AlexNet.</span></figcaption>
</figure>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.2" class="ltx_p">Towards this question, we find two aspects that matter most: <span id="S1.p3.2.2" class="ltx_text ltx_font_bold">(1) the <math id="S1.p3.1.1.m1.1" class="ltx_Math" alttext="l_{1}" display="inline"><semantics id="S1.p3.1.1.m1.1a"><msub id="S1.p3.1.1.m1.1.1" xref="S1.p3.1.1.m1.1.1.cmml"><mi id="S1.p3.1.1.m1.1.1.2" xref="S1.p3.1.1.m1.1.1.2.cmml">l</mi><mn id="S1.p3.1.1.m1.1.1.3" xref="S1.p3.1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p3.1.1.m1.1b"><apply id="S1.p3.1.1.m1.1.1.cmml" xref="S1.p3.1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p3.1.1.m1.1.1.1.cmml" xref="S1.p3.1.1.m1.1.1">subscript</csymbol><ci id="S1.p3.1.1.m1.1.1.2.cmml" xref="S1.p3.1.1.m1.1.1.2">𝑙</ci><cn type="integer" id="S1.p3.1.1.m1.1.1.3.cmml" xref="S1.p3.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.1.m1.1c">l_{1}</annotation></semantics></math> norm of aggregation weights (<math id="S1.p3.2.2.m2.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S1.p3.2.2.m2.1a"><mi id="S1.p3.2.2.m2.1.1" xref="S1.p3.2.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S1.p3.2.2.m2.1b"><ci id="S1.p3.2.2.m2.1.1.cmml" xref="S1.p3.2.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.2.2.m2.1c">\gamma</annotation></semantics></math>); </span></p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p"><span id="S1.p4.1.1" class="ltx_text ltx_font_bold">(2) the relative weights within the sampled clients (<math id="S1.p4.1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{\lambda}" display="inline"><semantics id="S1.p4.1.1.m1.1a"><mi id="S1.p4.1.1.m1.1.1" xref="S1.p4.1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S1.p4.1.1.m1.1b"><ci id="S1.p4.1.1.m1.1.1.cmml" xref="S1.p4.1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.1.m1.1c">\boldsymbol{\lambda}</annotation></semantics></math>).</span></p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">To gain insights, we leverage the advantage of the server in FL that we learn the aggregation weights on a global-objective-consistent proxy dataset by gradient descent. The learned weights are the optimal weight candidates at each round and can reflect the training dynamics.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.7" class="ltx_p">For (1), we identify the <em id="S1.p6.7.1" class="ltx_emph ltx_font_italic">global weight shrinking</em> effect in FL when <math id="S1.p6.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S1.p6.1.m1.1a"><mi id="S1.p6.1.m1.1.1" xref="S1.p6.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S1.p6.1.m1.1b"><ci id="S1.p6.1.m1.1.1.cmml" xref="S1.p6.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.1.m1.1c">\gamma</annotation></semantics></math> is smaller than 1, which is analogous to weight decay regularization <cite class="ltx_cite ltx_citemacro_citep">(Loshchilov &amp; Hutter, <a href="#bib.bib39" title="" class="ltx_ref">2018</a>; Lewkowycz &amp; Gur-Ari, <a href="#bib.bib30" title="" class="ltx_ref">2020</a>; Xie et al., <a href="#bib.bib52" title="" class="ltx_ref">2020</a>)</cite> in centralized training. However, a small value of <math id="S1.p6.2.m2.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S1.p6.2.m2.1a"><mi id="S1.p6.2.m2.1.1" xref="S1.p6.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S1.p6.2.m2.1b"><ci id="S1.p6.2.m2.1.1.cmml" xref="S1.p6.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.2.m2.1c">\gamma</annotation></semantics></math>—as stated in <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 1</span></a>—will cause negative effects; therefore, there exists an optimal <math id="S1.p6.3.m3.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S1.p6.3.m3.1a"><mi id="S1.p6.3.m3.1.1" xref="S1.p6.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S1.p6.3.m3.1b"><ci id="S1.p6.3.m3.1.1.cmml" xref="S1.p6.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.3.m3.1c">\gamma</annotation></semantics></math> that balances the regularization and optimization.
We fix <math id="S1.p6.4.m4.1" class="ltx_Math" alttext="\boldsymbol{\lambda}" display="inline"><semantics id="S1.p6.4.m4.1a"><mi id="S1.p6.4.m4.1.1" xref="S1.p6.4.m4.1.1.cmml">𝝀</mi><annotation-xml encoding="MathML-Content" id="S1.p6.4.m4.1b"><ci id="S1.p6.4.m4.1.1.cmml" xref="S1.p6.4.m4.1.1">𝝀</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.4.m4.1c">\boldsymbol{\lambda}</annotation></semantics></math> and learn <math id="S1.p6.5.m5.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S1.p6.5.m5.1a"><mi id="S1.p6.5.m5.1.1" xref="S1.p6.5.m5.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S1.p6.5.m5.1b"><ci id="S1.p6.5.m5.1.1.cmml" xref="S1.p6.5.m5.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.5.m5.1c">\gamma</annotation></semantics></math> (cf. <a href="#S4" title="4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 4</span></a>) on the proxy dataset to explore how the optimal shrinking factor (i.e. the <math id="S1.p6.6.m6.1" class="ltx_Math" alttext="l_{1}" display="inline"><semantics id="S1.p6.6.m6.1a"><msub id="S1.p6.6.m6.1.1" xref="S1.p6.6.m6.1.1.cmml"><mi id="S1.p6.6.m6.1.1.2" xref="S1.p6.6.m6.1.1.2.cmml">l</mi><mn id="S1.p6.6.m6.1.1.3" xref="S1.p6.6.m6.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p6.6.m6.1b"><apply id="S1.p6.6.m6.1.1.cmml" xref="S1.p6.6.m6.1.1"><csymbol cd="ambiguous" id="S1.p6.6.m6.1.1.1.cmml" xref="S1.p6.6.m6.1.1">subscript</csymbol><ci id="S1.p6.6.m6.1.1.2.cmml" xref="S1.p6.6.m6.1.1.2">𝑙</ci><cn type="integer" id="S1.p6.6.m6.1.1.3.cmml" xref="S1.p6.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.6.m6.1c">l_{1}</annotation></semantics></math> norm of <math id="S1.p6.7.m7.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S1.p6.7.m7.1a"><mi id="S1.p6.7.m7.1.1" xref="S1.p6.7.m7.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S1.p6.7.m7.1b"><ci id="S1.p6.7.m7.1.1.cmml" xref="S1.p6.7.m7.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.7.m7.1c">\gamma</annotation></semantics></math>) is affected by clients’ heterogeneity and local epochs.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.4" class="ltx_p">For (2), we study how <math id="S1.p7.1.m1.1" class="ltx_Math" alttext="\boldsymbol{\lambda}" display="inline"><semantics id="S1.p7.1.m1.1a"><mi id="S1.p7.1.m1.1.1" xref="S1.p7.1.m1.1.1.cmml">𝝀</mi><annotation-xml encoding="MathML-Content" id="S1.p7.1.m1.1b"><ci id="S1.p7.1.m1.1.1.cmml" xref="S1.p7.1.m1.1.1">𝝀</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p7.1.m1.1c">\boldsymbol{\lambda}</annotation></semantics></math> should be assigned to the local models to obtain a more generalized global model and how <math id="S1.p7.2.m2.1" class="ltx_Math" alttext="\boldsymbol{\lambda}" display="inline"><semantics id="S1.p7.2.m2.1a"><mi id="S1.p7.2.m2.1.1" xref="S1.p7.2.m2.1.1.cmml">𝝀</mi><annotation-xml encoding="MathML-Content" id="S1.p7.2.m2.1b"><ci id="S1.p7.2.m2.1.1.cmml" xref="S1.p7.2.m2.1.1">𝝀</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p7.2.m2.1c">\boldsymbol{\lambda}</annotation></semantics></math> can reflect clients’ importance in training dynamics. We fix <math id="S1.p7.3.m3.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S1.p7.3.m3.1a"><mi id="S1.p7.3.m3.1.1" xref="S1.p7.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S1.p7.3.m3.1b"><ci id="S1.p7.3.m3.1.1.cmml" xref="S1.p7.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p7.3.m3.1c">\gamma</annotation></semantics></math> and learn <math id="S1.p7.4.m4.1" class="ltx_Math" alttext="\boldsymbol{\lambda}" display="inline"><semantics id="S1.p7.4.m4.1a"><mi id="S1.p7.4.m4.1.1" xref="S1.p7.4.m4.1.1.cmml">𝝀</mi><annotation-xml encoding="MathML-Content" id="S1.p7.4.m4.1b"><ci id="S1.p7.4.m4.1.1.cmml" xref="S1.p7.4.m4.1.1">𝝀</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p7.4.m4.1c">\boldsymbol{\lambda}</annotation></semantics></math> (cf. <a href="#S5" title="5 Client coherence ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 5</span></a>) on the proxy dataset to study <em id="S1.p7.4.1" class="ltx_emph ltx_font_italic">client coherence</em> that includes: (i) <em id="S1.p7.4.2" class="ltx_emph ltx_font_italic">local gradient coherence</em>, the importance of clients in different learning periods; (ii) <em id="S1.p7.4.3" class="ltx_emph ltx_font_italic">heterogeneity coherence</em>, the consistency between the sum objective of sampled clients and the global objective.</p>
</div>
<div id="S1.p8" class="ltx_para">
<p id="S1.p8.1" class="ltx_p">Based on the insights, we propose an effective method for <span id="S1.p8.1.1" class="ltx_text ltx_font_bold">Fed</span>erated Learning with <span id="S1.p8.1.2" class="ltx_text ltx_font_bold">L</span>earnable <span id="S1.p8.1.3" class="ltx_text ltx_font_bold">A</span>ggregation <span id="S1.p8.1.4" class="ltx_text ltx_font_bold">W</span>eights, named as <span id="S1.p8.1.5" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedLAW</span> (cf. <a href="#S6" title="6 FedLAW ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 6</span></a>). Extensive experiments verify that our method can improve the generalization of the global model by a large margin on different datasets and models. Moreover, it is validated that <span id="S1.p8.1.6" class="ltx_text ltx_font_smallcaps">FedLAW</span> is still robust when the proxy dataset is small or shifted from the global distribution and corrupted clients exist.</p>
</div>
<div id="S1.p9" class="ltx_para">
<p id="S1.p9.1" class="ltx_p"><span id="S1.p9.1.1" class="ltx_text ltx_font_bold">Specifically, our contributions are two-folded.</span></p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">As our main contribution, we revisit and rethink the weighted aggregation in FL with DNNs and identify some interesting findings (see below take-aways). Especially, we find that smaller <math id="S1.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="l_{1}" display="inline"><semantics id="S1.I1.i1.p1.1.m1.1a"><msub id="S1.I1.i1.p1.1.m1.1.1" xref="S1.I1.i1.p1.1.m1.1.1.cmml"><mi id="S1.I1.i1.p1.1.m1.1.1.2" xref="S1.I1.i1.p1.1.m1.1.1.2.cmml">l</mi><mn id="S1.I1.i1.p1.1.m1.1.1.3" xref="S1.I1.i1.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.I1.i1.p1.1.m1.1b"><apply id="S1.I1.i1.p1.1.m1.1.1.cmml" xref="S1.I1.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.I1.i1.p1.1.m1.1.1.1.cmml" xref="S1.I1.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S1.I1.i1.p1.1.m1.1.1.2.cmml" xref="S1.I1.i1.p1.1.m1.1.1.2">𝑙</ci><cn type="integer" id="S1.I1.i1.p1.1.m1.1.1.3.cmml" xref="S1.I1.i1.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i1.p1.1.m1.1c">l_{1}</annotation></semantics></math> norms of aggregation weights may be beneficial to generalization, which challenges the previous normalized convention. This is also the first paper that introduces global regularization in FL, and we explore how to adaptively control such regularization.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We showcase the applicability of these insights, and devise a simple yet effective method <span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_smallcaps">FedLAW</span>, which largely boosts the generalization of global models. The effectiveness and robustness of <span id="S1.I1.i2.p1.1.2" class="ltx_text ltx_font_smallcaps">FedLAW</span> are validated by extensive experiments.</p>
</div>
</li>
</ul>
</div>
<div id="S1.p10" class="ltx_para">
<p id="S1.p10.1" class="ltx_p"><span id="S1.p10.1.1" class="ltx_text ltx_font_bold">We summarize our key take-away messages of the understandings as follows.</span></p>
<ul id="S1.I2" class="ltx_itemize">
<li id="S1.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I2.i1.p1" class="ltx_para">
<p id="S1.I2.i1.p1.1" class="ltx_p"><span id="S1.I2.i1.p1.1.1" class="ltx_text ltx_font_italic">Global weight shrinking</span> regularization effectively improves the generalization performance.</p>
<ul id="S1.I2.i1.I1" class="ltx_itemize">
<li id="S1.I2.i1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span id="S1.I2.i1.I1.i1.1.1.1" class="ltx_text ltx_font_bold">–</span></span> 
<div id="S1.I2.i1.I1.i1.p1" class="ltx_para">
<p id="S1.I2.i1.I1.i1.p1.1" class="ltx_p">The magnitude of the global gradient (i.e. uniform average of local updates) determines the optimal weight shrinking factor.
A larger norm of the global gradient requires stronger regularization, in the cases when (i) the number of local epochs is larger; (ii) the clients’ data are more IID; (iii) during training before the global model is near convergence.</p>
</div>
</li>
<li id="S1.I2.i1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span id="S1.I2.i1.I1.i2.1.1.1" class="ltx_text ltx_font_bold">–</span></span> 
<div id="S1.I2.i1.I1.i2.p1" class="ltx_para">
<p id="S1.I2.i1.I1.i2.p1.1" class="ltx_p">The effectiveness of global weight shrinking is stemmed from flatter loss landscapes of the global model as well as the improved local gradient coherence after the critical point.<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>
Different from the latter observations (w/o affecting the training dynamics), applying global weight shrinking results in a positive local gradient coherence after the critical point and the learning can benefit from it.
</span></span></span></p>
</div>
</li>
</ul>
</div>
</li>
<li id="S1.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I2.i2.p1" class="ltx_para">
<p id="S1.I2.i2.p1.1" class="ltx_p">Our novel concept of <span id="S1.I2.i2.p1.1.1" class="ltx_text ltx_font_italic">client coherence</span> depicts the training dynamics of FL, from the aspects of <em id="S1.I2.i2.p1.1.2" class="ltx_emph ltx_font_italic">local gradient coherence</em> and <em id="S1.I2.i2.p1.1.3" class="ltx_emph ltx_font_italic">heterogeneity coherence</em>.</p>
<ul id="S1.I2.i2.I1" class="ltx_itemize">
<li id="S1.I2.i2.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span id="S1.I2.i2.I1.i1.1.1.1" class="ltx_text ltx_font_bold">–</span></span> 
<div id="S1.I2.i2.I1.i1.p1" class="ltx_para">
<p id="S1.I2.i2.I1.i1.p1.1" class="ltx_p">Local gradient coherence refers to the averaged cosine similarities of clients’ local gradients.
A critical point (from positive to negative) exists in the curves of local gradient coherence during the training. Generalization can benefit when the local gradient coherence is positive and more dominant.</p>
</div>
</li>
<li id="S1.I2.i2.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span id="S1.I2.i2.I1.i2.1.1.1" class="ltx_text ltx_font_bold">–</span></span> 
<div id="S1.I2.i2.I1.i2.p1" class="ltx_para">
<p id="S1.I2.i2.I1.i2.p1.1" class="ltx_p">Heterogeneity coherence refers to the distribution consistency between the global data and the sampled one (i.e. data distribution of a cohort of sampled clients) in each round.
Increasing the heterogeneity coherence by reweighting the sampled clients could also improve the training performance.</p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Works</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Model aggregation in FL. </span>
There are previous works that try to learn the aggregation weights on given datasets by gradient descent. <span id="S2.p1.1.2" class="ltx_text ltx_font_smallcaps">Auto-FedAvg</span> <cite class="ltx_cite ltx_citemacro_citep">(Xia et al., <a href="#bib.bib51" title="" class="ltx_ref">2021</a>)</cite> learns aggregation weights on different institutional medical data to realize personalized medicine, while <span id="S2.p1.1.3" class="ltx_text ltx_font_smallcaps">L2C</span> matches similar peers in decentralized FL <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib32" title="" class="ltx_ref">2022a</a>)</cite> by learning aggregation weights on local datasets. These works all adopt the normalized aggregation weights (<math id="S2.p1.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S2.p1.1.m1.1a"><mi id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">\gamma</annotation></semantics></math>=1) without discovering the global weight shrinking effect, and they focus on <span id="S2.p1.1.4" class="ltx_text ltx_font_italic">personalization</span> while we focus on <span id="S2.p1.1.5" class="ltx_text ltx_font_italic">generalization</span>. Besides, they fail to understand the FL’s dynamics from the learned weights for further insights, e.g., identifying the significance of client coherence.
Ensemble distillation methods are used to improve the generalization of global models after weighted aggregation. <span id="S2.p1.1.6" class="ltx_text ltx_font_smallcaps">FedDF</span> <cite class="ltx_cite ltx_citemacro_citep">(Lin et al., <a href="#bib.bib38" title="" class="ltx_ref">2020</a>)</cite> uses the local models as teachers and finetune the global model via ensemble distillation; while in <span id="S2.p1.1.7" class="ltx_text ltx_font_smallcaps">FedBE</span> <cite class="ltx_cite ltx_citemacro_citep">(Chen &amp; Chao, <a href="#bib.bib7" title="" class="ltx_ref">2021</a>)</cite>, Bayesian ensemble distillation is further introduced. Since they also require a proxy dataset on the server, we will compare them with our proposed <span id="S2.p1.1.8" class="ltx_text ltx_font_smallcaps">FedLAW</span> in <a href="#S6" title="6 FedLAW ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 6</span></a>. Additionally, server-side stochastic weight averaging and client-side sharpness-aware minimization are incorporated to make the global model converge to a flatter minimum <cite class="ltx_cite ltx_citemacro_citep">(Caldarola et al., <a href="#bib.bib3" title="" class="ltx_ref">2022</a>)</cite>; distributionally robust optimization is also introduced to realize more robust federated averaging <cite class="ltx_cite ltx_citemacro_citep">(Deng et al., <a href="#bib.bib8" title="" class="ltx_ref">2020</a>; Wu et al., <a href="#bib.bib50" title="" class="ltx_ref">2022</a>)</cite>; but these works are orthogonal to our paper.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">Training dynamics of DNNs in centralized learning. </span>
Our insights into global weight shrinking and client coherence in FL are analogous to weight decay and gradient coherence in centralized learning. <span id="S2.p2.1.2" class="ltx_text ltx_font_italic">Weight decay: </span>The optimal weight decay factor is approximately inverse to the number of epochs, and the importance of applying weight decay diminishes when the training epochs are relatively long <cite class="ltx_cite ltx_citemacro_citep">(Loshchilov &amp; Hutter, <a href="#bib.bib39" title="" class="ltx_ref">2018</a>; Lewkowycz &amp; Gur-Ari, <a href="#bib.bib30" title="" class="ltx_ref">2020</a>; Xie et al., <a href="#bib.bib52" title="" class="ltx_ref">2020</a>)</cite>. The effectiveness of weight decay may be explained by the caused (i) larger effective learning rate <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib56" title="" class="ltx_ref">2018</a>; Wan et al., <a href="#bib.bib46" title="" class="ltx_ref">2021</a>)</cite>, and (ii) flatter loss landscape <cite class="ltx_cite ltx_citemacro_citep">(Lyu et al., <a href="#bib.bib40" title="" class="ltx_ref">2022</a>)</cite>. <span id="S2.p2.1.3" class="ltx_text ltx_font_italic">Gradient coherence:</span> Gradient coherence, or sample coherence, is a crucial technique for understanding the training dynamics of mini-batch SGD in centralized learning <cite class="ltx_cite ltx_citemacro_citep">(Chatterjee, <a href="#bib.bib5" title="" class="ltx_ref">2019</a>; Zielinski et al., <a href="#bib.bib57" title="" class="ltx_ref">2020</a>; Chatterjee &amp; Zielinski, <a href="#bib.bib6" title="" class="ltx_ref">2020</a>; Fort et al., <a href="#bib.bib15" title="" class="ltx_ref">2019</a>)</cite>.
The gradient coherence measures the pair-wise gradient similarity among samples. If they are highly similar, the overall gradient within a mini-batch will be stronger in certain directions, resulting in a dominantly faster loss reduction and better generalization <cite class="ltx_cite ltx_citemacro_citep">(Chatterjee, <a href="#bib.bib5" title="" class="ltx_ref">2019</a>; Zielinski et al., <a href="#bib.bib57" title="" class="ltx_ref">2020</a>; Chatterjee &amp; Zielinski, <a href="#bib.bib6" title="" class="ltx_ref">2020</a>)</cite>. The critical period exists in mini-batch SGD, captured by the gradient coherence: the low coherence in the early training phase damages the final generalization performance, no matter the value of coherence controlled later <cite class="ltx_cite ltx_citemacro_citep">(Chatterjee &amp; Zielinski, <a href="#bib.bib6" title="" class="ltx_ref">2020</a>)</cite>.
In <a href="#S4" title="4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 4</span></a> and <a href="#S5" title="5 Client coherence ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 5</span></a>, we will show similar findings can be drawn in FL’s dynamics, and some new insights are discovered.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">Due to space limits, the detailed discussions about related works can be found in <a href="#A1" title="Appendix A More Related Works ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Appendix A</span></a>.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Preliminary and Problem Setup</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.14" class="ltx_p">FL usually involves a server and <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">n</annotation></semantics></math> clients to jointly learn a global model without data sharing, which is originally proposed in <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib42" title="" class="ltx_ref">2017</a>)</cite>.
Denote the set of clients by <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S3.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">\mathcal{S}</annotation></semantics></math>, the local dataset of client <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p1.3.m3.1a"><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">i</annotation></semantics></math> by <math id="S3.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{D}_{i}=\{(x_{j},y_{j})\}_{j=1}^{N_{i}}" display="inline"><semantics id="S3.p1.4.m4.1a"><mrow id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml"><msub id="S3.p1.4.m4.1.1.3" xref="S3.p1.4.m4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.4.m4.1.1.3.2" xref="S3.p1.4.m4.1.1.3.2.cmml">𝒟</mi><mi id="S3.p1.4.m4.1.1.3.3" xref="S3.p1.4.m4.1.1.3.3.cmml">i</mi></msub><mo id="S3.p1.4.m4.1.1.2" xref="S3.p1.4.m4.1.1.2.cmml">=</mo><msubsup id="S3.p1.4.m4.1.1.1" xref="S3.p1.4.m4.1.1.1.cmml"><mrow id="S3.p1.4.m4.1.1.1.1.1.1" xref="S3.p1.4.m4.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.p1.4.m4.1.1.1.1.1.1.2" xref="S3.p1.4.m4.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.p1.4.m4.1.1.1.1.1.1.1.2" xref="S3.p1.4.m4.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.p1.4.m4.1.1.1.1.1.1.1.2.3" xref="S3.p1.4.m4.1.1.1.1.1.1.1.3.cmml">(</mo><msub id="S3.p1.4.m4.1.1.1.1.1.1.1.1.1" xref="S3.p1.4.m4.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.p1.4.m4.1.1.1.1.1.1.1.1.1.2" xref="S3.p1.4.m4.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.p1.4.m4.1.1.1.1.1.1.1.1.1.3" xref="S3.p1.4.m4.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.p1.4.m4.1.1.1.1.1.1.1.2.4" xref="S3.p1.4.m4.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S3.p1.4.m4.1.1.1.1.1.1.1.2.2" xref="S3.p1.4.m4.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.p1.4.m4.1.1.1.1.1.1.1.2.2.2" xref="S3.p1.4.m4.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S3.p1.4.m4.1.1.1.1.1.1.1.2.2.3" xref="S3.p1.4.m4.1.1.1.1.1.1.1.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.p1.4.m4.1.1.1.1.1.1.1.2.5" xref="S3.p1.4.m4.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S3.p1.4.m4.1.1.1.1.1.1.3" xref="S3.p1.4.m4.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.p1.4.m4.1.1.1.1.3" xref="S3.p1.4.m4.1.1.1.1.3.cmml"><mi id="S3.p1.4.m4.1.1.1.1.3.2" xref="S3.p1.4.m4.1.1.1.1.3.2.cmml">j</mi><mo id="S3.p1.4.m4.1.1.1.1.3.1" xref="S3.p1.4.m4.1.1.1.1.3.1.cmml">=</mo><mn id="S3.p1.4.m4.1.1.1.1.3.3" xref="S3.p1.4.m4.1.1.1.1.3.3.cmml">1</mn></mrow><msub id="S3.p1.4.m4.1.1.1.3" xref="S3.p1.4.m4.1.1.1.3.cmml"><mi id="S3.p1.4.m4.1.1.1.3.2" xref="S3.p1.4.m4.1.1.1.3.2.cmml">N</mi><mi id="S3.p1.4.m4.1.1.1.3.3" xref="S3.p1.4.m4.1.1.1.3.3.cmml">i</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><apply id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1"><eq id="S3.p1.4.m4.1.1.2.cmml" xref="S3.p1.4.m4.1.1.2"></eq><apply id="S3.p1.4.m4.1.1.3.cmml" xref="S3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.1.3.1.cmml" xref="S3.p1.4.m4.1.1.3">subscript</csymbol><ci id="S3.p1.4.m4.1.1.3.2.cmml" xref="S3.p1.4.m4.1.1.3.2">𝒟</ci><ci id="S3.p1.4.m4.1.1.3.3.cmml" xref="S3.p1.4.m4.1.1.3.3">𝑖</ci></apply><apply id="S3.p1.4.m4.1.1.1.cmml" xref="S3.p1.4.m4.1.1.1"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.1.1.2.cmml" xref="S3.p1.4.m4.1.1.1">superscript</csymbol><apply id="S3.p1.4.m4.1.1.1.1.cmml" xref="S3.p1.4.m4.1.1.1"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.1.1.1.2.cmml" xref="S3.p1.4.m4.1.1.1">subscript</csymbol><set id="S3.p1.4.m4.1.1.1.1.1.2.cmml" xref="S3.p1.4.m4.1.1.1.1.1.1"><interval closure="open" id="S3.p1.4.m4.1.1.1.1.1.1.1.3.cmml" xref="S3.p1.4.m4.1.1.1.1.1.1.1.2"><apply id="S3.p1.4.m4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.p1.4.m4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.p1.4.m4.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p1.4.m4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.p1.4.m4.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.p1.4.m4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.p1.4.m4.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.p1.4.m4.1.1.1.1.1.1.1.2.2.cmml" xref="S3.p1.4.m4.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.p1.4.m4.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.p1.4.m4.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.p1.4.m4.1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S3.p1.4.m4.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.p1.4.m4.1.1.1.1.1.1.1.2.2.3">𝑗</ci></apply></interval></set><apply id="S3.p1.4.m4.1.1.1.1.3.cmml" xref="S3.p1.4.m4.1.1.1.1.3"><eq id="S3.p1.4.m4.1.1.1.1.3.1.cmml" xref="S3.p1.4.m4.1.1.1.1.3.1"></eq><ci id="S3.p1.4.m4.1.1.1.1.3.2.cmml" xref="S3.p1.4.m4.1.1.1.1.3.2">𝑗</ci><cn type="integer" id="S3.p1.4.m4.1.1.1.1.3.3.cmml" xref="S3.p1.4.m4.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.p1.4.m4.1.1.1.3.cmml" xref="S3.p1.4.m4.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.1.1.3.1.cmml" xref="S3.p1.4.m4.1.1.1.3">subscript</csymbol><ci id="S3.p1.4.m4.1.1.1.3.2.cmml" xref="S3.p1.4.m4.1.1.1.3.2">𝑁</ci><ci id="S3.p1.4.m4.1.1.1.3.3.cmml" xref="S3.p1.4.m4.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">\mathcal{D}_{i}=\{(x_{j},y_{j})\}_{j=1}^{N_{i}}</annotation></semantics></math>, the sum of clients’ data by <math id="S3.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{D}=\bigcup_{i\in\mathcal{S}}\mathcal{D}_{i}" display="inline"><semantics id="S3.p1.5.m5.1a"><mrow id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.5.m5.1.1.2" xref="S3.p1.5.m5.1.1.2.cmml">𝒟</mi><mo rspace="0.111em" id="S3.p1.5.m5.1.1.1" xref="S3.p1.5.m5.1.1.1.cmml">=</mo><mrow id="S3.p1.5.m5.1.1.3" xref="S3.p1.5.m5.1.1.3.cmml"><msub id="S3.p1.5.m5.1.1.3.1" xref="S3.p1.5.m5.1.1.3.1.cmml"><mo id="S3.p1.5.m5.1.1.3.1.2" xref="S3.p1.5.m5.1.1.3.1.2.cmml">⋃</mo><mrow id="S3.p1.5.m5.1.1.3.1.3" xref="S3.p1.5.m5.1.1.3.1.3.cmml"><mi id="S3.p1.5.m5.1.1.3.1.3.2" xref="S3.p1.5.m5.1.1.3.1.3.2.cmml">i</mi><mo id="S3.p1.5.m5.1.1.3.1.3.1" xref="S3.p1.5.m5.1.1.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.5.m5.1.1.3.1.3.3" xref="S3.p1.5.m5.1.1.3.1.3.3.cmml">𝒮</mi></mrow></msub><msub id="S3.p1.5.m5.1.1.3.2" xref="S3.p1.5.m5.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.5.m5.1.1.3.2.2" xref="S3.p1.5.m5.1.1.3.2.2.cmml">𝒟</mi><mi id="S3.p1.5.m5.1.1.3.2.3" xref="S3.p1.5.m5.1.1.3.2.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><apply id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1"><eq id="S3.p1.5.m5.1.1.1.cmml" xref="S3.p1.5.m5.1.1.1"></eq><ci id="S3.p1.5.m5.1.1.2.cmml" xref="S3.p1.5.m5.1.1.2">𝒟</ci><apply id="S3.p1.5.m5.1.1.3.cmml" xref="S3.p1.5.m5.1.1.3"><apply id="S3.p1.5.m5.1.1.3.1.cmml" xref="S3.p1.5.m5.1.1.3.1"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.1.3.1.1.cmml" xref="S3.p1.5.m5.1.1.3.1">subscript</csymbol><union id="S3.p1.5.m5.1.1.3.1.2.cmml" xref="S3.p1.5.m5.1.1.3.1.2"></union><apply id="S3.p1.5.m5.1.1.3.1.3.cmml" xref="S3.p1.5.m5.1.1.3.1.3"><in id="S3.p1.5.m5.1.1.3.1.3.1.cmml" xref="S3.p1.5.m5.1.1.3.1.3.1"></in><ci id="S3.p1.5.m5.1.1.3.1.3.2.cmml" xref="S3.p1.5.m5.1.1.3.1.3.2">𝑖</ci><ci id="S3.p1.5.m5.1.1.3.1.3.3.cmml" xref="S3.p1.5.m5.1.1.3.1.3.3">𝒮</ci></apply></apply><apply id="S3.p1.5.m5.1.1.3.2.cmml" xref="S3.p1.5.m5.1.1.3.2"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.1.3.2.1.cmml" xref="S3.p1.5.m5.1.1.3.2">subscript</csymbol><ci id="S3.p1.5.m5.1.1.3.2.2.cmml" xref="S3.p1.5.m5.1.1.3.2.2">𝒟</ci><ci id="S3.p1.5.m5.1.1.3.2.3.cmml" xref="S3.p1.5.m5.1.1.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">\mathcal{D}=\bigcup_{i\in\mathcal{S}}\mathcal{D}_{i}</annotation></semantics></math>. The IID data distributions of clients refer to each client’s distribution <math id="S3.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S3.p1.6.m6.1a"><msub id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.6.m6.1.1.2" xref="S3.p1.6.m6.1.1.2.cmml">𝒟</mi><mi id="S3.p1.6.m6.1.1.3" xref="S3.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><apply id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p1.6.m6.1.1.1.cmml" xref="S3.p1.6.m6.1.1">subscript</csymbol><ci id="S3.p1.6.m6.1.1.2.cmml" xref="S3.p1.6.m6.1.1.2">𝒟</ci><ci id="S3.p1.6.m6.1.1.3.cmml" xref="S3.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">\mathcal{D}_{i}</annotation></semantics></math> is IID sampled from <math id="S3.p1.7.m7.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S3.p1.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><ci id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">\mathcal{D}</annotation></semantics></math>. However, in practical FL scenarios, <span id="S3.p1.14.3" class="ltx_text ltx_font_italic">heterogeneity</span> exists among clients that their data are <span id="S3.p1.14.4" class="ltx_text ltx_font_italic">NonIID</span> with each other. In this paper, we use Dirichlet sampling, which is widely used in FL literature <cite class="ltx_cite ltx_citemacro_citep">(Lin et al., <a href="#bib.bib38" title="" class="ltx_ref">2020</a>; Li et al., <a href="#bib.bib34" title="" class="ltx_ref">2020b</a>; Acar et al., <a href="#bib.bib1" title="" class="ltx_ref">2020</a>)</cite>, to synthesize <span id="S3.p1.8.1" class="ltx_text ltx_font_bold ltx_font_italic">client heterogeneity<span id="S3.p1.8.1.1" class="ltx_text ltx_font_medium"> (controlled by <math id="S3.p1.8.1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.p1.8.1.1.m1.1a"><mi mathvariant="normal" id="S3.p1.8.1.1.m1.1.1" xref="S3.p1.8.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.p1.8.1.1.m1.1b"><ci id="S3.p1.8.1.1.m1.1.1.cmml" xref="S3.p1.8.1.1.m1.1.1">α</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.1.1.m1.1c">\alpha</annotation></semantics></math>, the smaller, the more NonIID)</span></span>. During FL training, clients iteratively conduct local training and communicate with the server for model updating. In the local training, <span id="S3.p1.9.2" class="ltx_text ltx_font_bold ltx_font_italic">the number of local epochs<span id="S3.p1.9.2.1" class="ltx_text ltx_font_medium"> is <math id="S3.p1.9.2.1.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.p1.9.2.1.m1.1a"><mi mathvariant="normal" id="S3.p1.9.2.1.m1.1.1" xref="S3.p1.9.2.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.p1.9.2.1.m1.1b"><ci id="S3.p1.9.2.1.m1.1.1.cmml" xref="S3.p1.9.2.1.m1.1.1">E</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.2.1.m1.1c">E</annotation></semantics></math></span></span>; when <math id="S3.p1.10.m8.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.p1.10.m8.1a"><mi id="S3.p1.10.m8.1.1" xref="S3.p1.10.m8.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.p1.10.m8.1b"><ci id="S3.p1.10.m8.1.1.cmml" xref="S3.p1.10.m8.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.10.m8.1c">E</annotation></semantics></math> is larger, the communication is more efficient but the updates are more asynchronous. Since <math id="S3.p1.11.m9.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.p1.11.m9.1a"><mi id="S3.p1.11.m9.1.1" xref="S3.p1.11.m9.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.p1.11.m9.1b"><ci id="S3.p1.11.m9.1.1.cmml" xref="S3.p1.11.m9.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.11.m9.1c">\alpha</annotation></semantics></math> and <math id="S3.p1.12.m10.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.p1.12.m10.1a"><mi id="S3.p1.12.m10.1.1" xref="S3.p1.12.m10.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.p1.12.m10.1b"><ci id="S3.p1.12.m10.1.1.cmml" xref="S3.p1.12.m10.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.12.m10.1c">E</annotation></semantics></math> are the key factors affecting FL’s training, in this paper, we study how <math id="S3.p1.13.m11.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.p1.13.m11.1a"><mi id="S3.p1.13.m11.1.1" xref="S3.p1.13.m11.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.p1.13.m11.1b"><ci id="S3.p1.13.m11.1.1.cmml" xref="S3.p1.13.m11.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.13.m11.1c">\alpha</annotation></semantics></math> and <math id="S3.p1.14.m12.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.p1.14.m12.1a"><mi id="S3.p1.14.m12.1.1" xref="S3.p1.14.m12.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.p1.14.m12.1b"><ci id="S3.p1.14.m12.1.1.cmml" xref="S3.p1.14.m12.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.14.m12.1c">E</annotation></semantics></math> affect the training dynamics of FL from the perspective of weighted aggregation.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.6" class="ltx_p">Denote the global model and the client <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p2.1.m1.1a"><mi id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">i</annotation></semantics></math>’s local model in communication round <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.p2.2.m2.1a"><mi id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">t</annotation></semantics></math> by <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="\mathbf{w}_{g}^{t}" display="inline"><semantics id="S3.p2.3.m3.1a"><msubsup id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml"><mi id="S3.p2.3.m3.1.1.2.2" xref="S3.p2.3.m3.1.1.2.2.cmml">𝐰</mi><mi id="S3.p2.3.m3.1.1.2.3" xref="S3.p2.3.m3.1.1.2.3.cmml">g</mi><mi id="S3.p2.3.m3.1.1.3" xref="S3.p2.3.m3.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><apply id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.1.cmml" xref="S3.p2.3.m3.1.1">superscript</csymbol><apply id="S3.p2.3.m3.1.1.2.cmml" xref="S3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.2.1.cmml" xref="S3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.p2.3.m3.1.1.2.2.cmml" xref="S3.p2.3.m3.1.1.2.2">𝐰</ci><ci id="S3.p2.3.m3.1.1.2.3.cmml" xref="S3.p2.3.m3.1.1.2.3">𝑔</ci></apply><ci id="S3.p2.3.m3.1.1.3.cmml" xref="S3.p2.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">\mathbf{w}_{g}^{t}</annotation></semantics></math> and <math id="S3.p2.4.m4.1" class="ltx_Math" alttext="\mathbf{w}_{i}^{t}" display="inline"><semantics id="S3.p2.4.m4.1a"><msubsup id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml"><mi id="S3.p2.4.m4.1.1.2.2" xref="S3.p2.4.m4.1.1.2.2.cmml">𝐰</mi><mi id="S3.p2.4.m4.1.1.2.3" xref="S3.p2.4.m4.1.1.2.3.cmml">i</mi><mi id="S3.p2.4.m4.1.1.3" xref="S3.p2.4.m4.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><apply id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p2.4.m4.1.1.1.cmml" xref="S3.p2.4.m4.1.1">superscript</csymbol><apply id="S3.p2.4.m4.1.1.2.cmml" xref="S3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p2.4.m4.1.1.2.1.cmml" xref="S3.p2.4.m4.1.1">subscript</csymbol><ci id="S3.p2.4.m4.1.1.2.2.cmml" xref="S3.p2.4.m4.1.1.2.2">𝐰</ci><ci id="S3.p2.4.m4.1.1.2.3.cmml" xref="S3.p2.4.m4.1.1.2.3">𝑖</ci></apply><ci id="S3.p2.4.m4.1.1.3.cmml" xref="S3.p2.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">\mathbf{w}_{i}^{t}</annotation></semantics></math>.
In each round, clients’ local models are initialized as the global model that <math id="S3.p2.5.m5.1" class="ltx_Math" alttext="\mathbf{w}_{i}^{t}\leftarrow\mathbf{w}_{g}^{t}" display="inline"><semantics id="S3.p2.5.m5.1a"><mrow id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml"><msubsup id="S3.p2.5.m5.1.1.2" xref="S3.p2.5.m5.1.1.2.cmml"><mi id="S3.p2.5.m5.1.1.2.2.2" xref="S3.p2.5.m5.1.1.2.2.2.cmml">𝐰</mi><mi id="S3.p2.5.m5.1.1.2.2.3" xref="S3.p2.5.m5.1.1.2.2.3.cmml">i</mi><mi id="S3.p2.5.m5.1.1.2.3" xref="S3.p2.5.m5.1.1.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="S3.p2.5.m5.1.1.1" xref="S3.p2.5.m5.1.1.1.cmml">←</mo><msubsup id="S3.p2.5.m5.1.1.3" xref="S3.p2.5.m5.1.1.3.cmml"><mi id="S3.p2.5.m5.1.1.3.2.2" xref="S3.p2.5.m5.1.1.3.2.2.cmml">𝐰</mi><mi id="S3.p2.5.m5.1.1.3.2.3" xref="S3.p2.5.m5.1.1.3.2.3.cmml">g</mi><mi id="S3.p2.5.m5.1.1.3.3" xref="S3.p2.5.m5.1.1.3.3.cmml">t</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><apply id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1"><ci id="S3.p2.5.m5.1.1.1.cmml" xref="S3.p2.5.m5.1.1.1">←</ci><apply id="S3.p2.5.m5.1.1.2.cmml" xref="S3.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.p2.5.m5.1.1.2.1.cmml" xref="S3.p2.5.m5.1.1.2">superscript</csymbol><apply id="S3.p2.5.m5.1.1.2.2.cmml" xref="S3.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.p2.5.m5.1.1.2.2.1.cmml" xref="S3.p2.5.m5.1.1.2">subscript</csymbol><ci id="S3.p2.5.m5.1.1.2.2.2.cmml" xref="S3.p2.5.m5.1.1.2.2.2">𝐰</ci><ci id="S3.p2.5.m5.1.1.2.2.3.cmml" xref="S3.p2.5.m5.1.1.2.2.3">𝑖</ci></apply><ci id="S3.p2.5.m5.1.1.2.3.cmml" xref="S3.p2.5.m5.1.1.2.3">𝑡</ci></apply><apply id="S3.p2.5.m5.1.1.3.cmml" xref="S3.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.p2.5.m5.1.1.3.1.cmml" xref="S3.p2.5.m5.1.1.3">superscript</csymbol><apply id="S3.p2.5.m5.1.1.3.2.cmml" xref="S3.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.p2.5.m5.1.1.3.2.1.cmml" xref="S3.p2.5.m5.1.1.3">subscript</csymbol><ci id="S3.p2.5.m5.1.1.3.2.2.cmml" xref="S3.p2.5.m5.1.1.3.2.2">𝐰</ci><ci id="S3.p2.5.m5.1.1.3.2.3.cmml" xref="S3.p2.5.m5.1.1.3.2.3">𝑔</ci></apply><ci id="S3.p2.5.m5.1.1.3.3.cmml" xref="S3.p2.5.m5.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">\mathbf{w}_{i}^{t}\leftarrow\mathbf{w}_{g}^{t}</annotation></semantics></math>, and clients conduct local training in parallel. In each local training epoch, clients conduct SGD update with a local learning rate <math id="S3.p2.6.m6.1" class="ltx_Math" alttext="\eta_{l}" display="inline"><semantics id="S3.p2.6.m6.1a"><msub id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml"><mi id="S3.p2.6.m6.1.1.2" xref="S3.p2.6.m6.1.1.2.cmml">η</mi><mi id="S3.p2.6.m6.1.1.3" xref="S3.p2.6.m6.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.6.m6.1b"><apply id="S3.p2.6.m6.1.1.cmml" xref="S3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p2.6.m6.1.1.1.cmml" xref="S3.p2.6.m6.1.1">subscript</csymbol><ci id="S3.p2.6.m6.1.1.2.cmml" xref="S3.p2.6.m6.1.1.2">𝜂</ci><ci id="S3.p2.6.m6.1.1.3.cmml" xref="S3.p2.6.m6.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m6.1c">\eta_{l}</annotation></semantics></math>, and each SGD iteration shows as</p>
<table id="A4.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E1.m1.5" class="ltx_Math" alttext="\displaystyle\mathbf{w}_{i}^{t}\leftarrow\mathbf{w}_{i}^{t}-\eta_{l}\nabla\ell(B_{k},\mathbf{w}_{i}^{t}),\text{ for }k=1,2,\cdots,K," display="inline"><semantics id="S3.E1.m1.5a"><mrow id="S3.E1.m1.5.5.1"><mrow id="S3.E1.m1.5.5.1.1.2" xref="S3.E1.m1.5.5.1.1.3.cmml"><mrow id="S3.E1.m1.5.5.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.cmml"><msubsup id="S3.E1.m1.5.5.1.1.1.1.4" xref="S3.E1.m1.5.5.1.1.1.1.4.cmml"><mi id="S3.E1.m1.5.5.1.1.1.1.4.2.2" xref="S3.E1.m1.5.5.1.1.1.1.4.2.2.cmml">𝐰</mi><mi id="S3.E1.m1.5.5.1.1.1.1.4.2.3" xref="S3.E1.m1.5.5.1.1.1.1.4.2.3.cmml">i</mi><mi id="S3.E1.m1.5.5.1.1.1.1.4.3" xref="S3.E1.m1.5.5.1.1.1.1.4.3.cmml">t</mi></msubsup><mo stretchy="false" id="S3.E1.m1.5.5.1.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.1.3.cmml">←</mo><mrow id="S3.E1.m1.5.5.1.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.1.2.cmml"><msubsup id="S3.E1.m1.5.5.1.1.1.1.2.4" xref="S3.E1.m1.5.5.1.1.1.1.2.4.cmml"><mi id="S3.E1.m1.5.5.1.1.1.1.2.4.2.2" xref="S3.E1.m1.5.5.1.1.1.1.2.4.2.2.cmml">𝐰</mi><mi id="S3.E1.m1.5.5.1.1.1.1.2.4.2.3" xref="S3.E1.m1.5.5.1.1.1.1.2.4.2.3.cmml">i</mi><mi id="S3.E1.m1.5.5.1.1.1.1.2.4.3" xref="S3.E1.m1.5.5.1.1.1.1.2.4.3.cmml">t</mi></msubsup><mo id="S3.E1.m1.5.5.1.1.1.1.2.3" xref="S3.E1.m1.5.5.1.1.1.1.2.3.cmml">−</mo><mrow id="S3.E1.m1.5.5.1.1.1.1.2.2" xref="S3.E1.m1.5.5.1.1.1.1.2.2.cmml"><msub id="S3.E1.m1.5.5.1.1.1.1.2.2.4" xref="S3.E1.m1.5.5.1.1.1.1.2.2.4.cmml"><mi id="S3.E1.m1.5.5.1.1.1.1.2.2.4.2" xref="S3.E1.m1.5.5.1.1.1.1.2.2.4.2.cmml">η</mi><mi id="S3.E1.m1.5.5.1.1.1.1.2.2.4.3" xref="S3.E1.m1.5.5.1.1.1.1.2.2.4.3.cmml">l</mi></msub><mo lspace="0.167em" rspace="0em" id="S3.E1.m1.5.5.1.1.1.1.2.2.3" xref="S3.E1.m1.5.5.1.1.1.1.2.2.3.cmml">​</mo><mrow id="S3.E1.m1.5.5.1.1.1.1.2.2.5" xref="S3.E1.m1.5.5.1.1.1.1.2.2.5.cmml"><mo rspace="0.167em" id="S3.E1.m1.5.5.1.1.1.1.2.2.5.1" xref="S3.E1.m1.5.5.1.1.1.1.2.2.5.1.cmml">∇</mo><mi mathvariant="normal" id="S3.E1.m1.5.5.1.1.1.1.2.2.5.2" xref="S3.E1.m1.5.5.1.1.1.1.2.2.5.2.cmml">ℓ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.5.5.1.1.1.1.2.2.3a" xref="S3.E1.m1.5.5.1.1.1.1.2.2.3.cmml">​</mo><mrow id="S3.E1.m1.5.5.1.1.1.1.2.2.2.2" xref="S3.E1.m1.5.5.1.1.1.1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.5.5.1.1.1.1.2.2.2.2.3" xref="S3.E1.m1.5.5.1.1.1.1.2.2.2.3.cmml">(</mo><msub id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">B</mi><mi id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.E1.m1.5.5.1.1.1.1.2.2.2.2.4" xref="S3.E1.m1.5.5.1.1.1.1.2.2.2.3.cmml">,</mo><msubsup id="S3.E1.m1.5.5.1.1.1.1.2.2.2.2.2" xref="S3.E1.m1.5.5.1.1.1.1.2.2.2.2.2.cmml"><mi id="S3.E1.m1.5.5.1.1.1.1.2.2.2.2.2.2.2" xref="S3.E1.m1.5.5.1.1.1.1.2.2.2.2.2.2.2.cmml">𝐰</mi><mi id="S3.E1.m1.5.5.1.1.1.1.2.2.2.2.2.2.3" xref="S3.E1.m1.5.5.1.1.1.1.2.2.2.2.2.2.3.cmml">i</mi><mi id="S3.E1.m1.5.5.1.1.1.1.2.2.2.2.2.3" xref="S3.E1.m1.5.5.1.1.1.1.2.2.2.2.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="S3.E1.m1.5.5.1.1.1.1.2.2.2.2.5" xref="S3.E1.m1.5.5.1.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.5.5.1.1.2.3" xref="S3.E1.m1.5.5.1.1.3a.cmml">,</mo><mrow id="S3.E1.m1.5.5.1.1.2.2" xref="S3.E1.m1.5.5.1.1.2.2.cmml"><mrow id="S3.E1.m1.5.5.1.1.2.2.2" xref="S3.E1.m1.5.5.1.1.2.2.2.cmml"><mtext id="S3.E1.m1.5.5.1.1.2.2.2.2" xref="S3.E1.m1.5.5.1.1.2.2.2.2a.cmml"> for </mtext><mo lspace="0em" rspace="0em" id="S3.E1.m1.5.5.1.1.2.2.2.1" xref="S3.E1.m1.5.5.1.1.2.2.2.1.cmml">​</mo><mi id="S3.E1.m1.5.5.1.1.2.2.2.3" xref="S3.E1.m1.5.5.1.1.2.2.2.3.cmml">k</mi></mrow><mo id="S3.E1.m1.5.5.1.1.2.2.1" xref="S3.E1.m1.5.5.1.1.2.2.1.cmml">=</mo><mrow id="S3.E1.m1.5.5.1.1.2.2.3.2" xref="S3.E1.m1.5.5.1.1.2.2.3.1.cmml"><mn id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">1</mn><mo id="S3.E1.m1.5.5.1.1.2.2.3.2.1" xref="S3.E1.m1.5.5.1.1.2.2.3.1.cmml">,</mo><mn id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">2</mn><mo id="S3.E1.m1.5.5.1.1.2.2.3.2.2" xref="S3.E1.m1.5.5.1.1.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">⋯</mi><mo id="S3.E1.m1.5.5.1.1.2.2.3.2.3" xref="S3.E1.m1.5.5.1.1.2.2.3.1.cmml">,</mo><mi id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml">K</mi></mrow></mrow></mrow><mo id="S3.E1.m1.5.5.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.5b"><apply id="S3.E1.m1.5.5.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.3a.cmml" xref="S3.E1.m1.5.5.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.5.5.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1"><ci id="S3.E1.m1.5.5.1.1.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.3">←</ci><apply id="S3.E1.m1.5.5.1.1.1.1.4.cmml" xref="S3.E1.m1.5.5.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.4.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.4">superscript</csymbol><apply id="S3.E1.m1.5.5.1.1.1.1.4.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.4.2.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.4">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.1.1.4.2.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.4.2.2">𝐰</ci><ci id="S3.E1.m1.5.5.1.1.1.1.4.2.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.4.2.3">𝑖</ci></apply><ci id="S3.E1.m1.5.5.1.1.1.1.4.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.4.3">𝑡</ci></apply><apply id="S3.E1.m1.5.5.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2"><minus id="S3.E1.m1.5.5.1.1.1.1.2.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.3"></minus><apply id="S3.E1.m1.5.5.1.1.1.1.2.4.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.2.4.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.4">superscript</csymbol><apply id="S3.E1.m1.5.5.1.1.1.1.2.4.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.2.4.2.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.4">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.1.1.2.4.2.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.4.2.2">𝐰</ci><ci id="S3.E1.m1.5.5.1.1.1.1.2.4.2.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.4.2.3">𝑖</ci></apply><ci id="S3.E1.m1.5.5.1.1.1.1.2.4.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.4.3">𝑡</ci></apply><apply id="S3.E1.m1.5.5.1.1.1.1.2.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.2"><times id="S3.E1.m1.5.5.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.2.3"></times><apply id="S3.E1.m1.5.5.1.1.1.1.2.2.4.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.2.2.4.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.2.4">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.1.1.2.2.4.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.2.4.2">𝜂</ci><ci id="S3.E1.m1.5.5.1.1.1.1.2.2.4.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.2.4.3">𝑙</ci></apply><apply id="S3.E1.m1.5.5.1.1.1.1.2.2.5.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.2.5"><ci id="S3.E1.m1.5.5.1.1.1.1.2.2.5.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.2.5.1">∇</ci><ci id="S3.E1.m1.5.5.1.1.1.1.2.2.5.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.2.5.2">ℓ</ci></apply><interval closure="open" id="S3.E1.m1.5.5.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.2.2.2"><apply id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.2">𝐵</ci><ci id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E1.m1.5.5.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.2.2.2.2">superscript</csymbol><apply id="S3.E1.m1.5.5.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.2.2.2.2.2.2">𝐰</ci><ci id="S3.E1.m1.5.5.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S3.E1.m1.5.5.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply></apply><apply id="S3.E1.m1.5.5.1.1.2.2.cmml" xref="S3.E1.m1.5.5.1.1.2.2"><eq id="S3.E1.m1.5.5.1.1.2.2.1.cmml" xref="S3.E1.m1.5.5.1.1.2.2.1"></eq><apply id="S3.E1.m1.5.5.1.1.2.2.2.cmml" xref="S3.E1.m1.5.5.1.1.2.2.2"><times id="S3.E1.m1.5.5.1.1.2.2.2.1.cmml" xref="S3.E1.m1.5.5.1.1.2.2.2.1"></times><ci id="S3.E1.m1.5.5.1.1.2.2.2.2a.cmml" xref="S3.E1.m1.5.5.1.1.2.2.2.2"><mtext id="S3.E1.m1.5.5.1.1.2.2.2.2.cmml" xref="S3.E1.m1.5.5.1.1.2.2.2.2"> for </mtext></ci><ci id="S3.E1.m1.5.5.1.1.2.2.2.3.cmml" xref="S3.E1.m1.5.5.1.1.2.2.2.3">𝑘</ci></apply><list id="S3.E1.m1.5.5.1.1.2.2.3.1.cmml" xref="S3.E1.m1.5.5.1.1.2.2.3.2"><cn type="integer" id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">1</cn><cn type="integer" id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">2</cn><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">⋯</ci><ci id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4">𝐾</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.5c">\displaystyle\mathbf{w}_{i}^{t}\leftarrow\mathbf{w}_{i}^{t}-\eta_{l}\nabla\ell(B_{k},\mathbf{w}_{i}^{t}),\text{ for }k=1,2,\cdots,K,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.p2.13" class="ltx_p">where <math id="S3.p2.7.m1.1" class="ltx_Math" alttext="\ell" display="inline"><semantics id="S3.p2.7.m1.1a"><mi mathvariant="normal" id="S3.p2.7.m1.1.1" xref="S3.p2.7.m1.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="S3.p2.7.m1.1b"><ci id="S3.p2.7.m1.1.1.cmml" xref="S3.p2.7.m1.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.m1.1c">\ell</annotation></semantics></math> is the loss function and <math id="S3.p2.8.m2.1" class="ltx_Math" alttext="B_{k}" display="inline"><semantics id="S3.p2.8.m2.1a"><msub id="S3.p2.8.m2.1.1" xref="S3.p2.8.m2.1.1.cmml"><mi id="S3.p2.8.m2.1.1.2" xref="S3.p2.8.m2.1.1.2.cmml">B</mi><mi id="S3.p2.8.m2.1.1.3" xref="S3.p2.8.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.8.m2.1b"><apply id="S3.p2.8.m2.1.1.cmml" xref="S3.p2.8.m2.1.1"><csymbol cd="ambiguous" id="S3.p2.8.m2.1.1.1.cmml" xref="S3.p2.8.m2.1.1">subscript</csymbol><ci id="S3.p2.8.m2.1.1.2.cmml" xref="S3.p2.8.m2.1.1.2">𝐵</ci><ci id="S3.p2.8.m2.1.1.3.cmml" xref="S3.p2.8.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.8.m2.1c">B_{k}</annotation></semantics></math> is the mini-batch sampled from <math id="S3.p2.9.m3.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S3.p2.9.m3.1a"><msub id="S3.p2.9.m3.1.1" xref="S3.p2.9.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.9.m3.1.1.2" xref="S3.p2.9.m3.1.1.2.cmml">𝒟</mi><mi id="S3.p2.9.m3.1.1.3" xref="S3.p2.9.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.9.m3.1b"><apply id="S3.p2.9.m3.1.1.cmml" xref="S3.p2.9.m3.1.1"><csymbol cd="ambiguous" id="S3.p2.9.m3.1.1.1.cmml" xref="S3.p2.9.m3.1.1">subscript</csymbol><ci id="S3.p2.9.m3.1.1.2.cmml" xref="S3.p2.9.m3.1.1.2">𝒟</ci><ci id="S3.p2.9.m3.1.1.3.cmml" xref="S3.p2.9.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.9.m3.1c">\mathcal{D}_{i}</annotation></semantics></math> at the <math id="S3.p2.10.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.p2.10.m4.1a"><mi id="S3.p2.10.m4.1.1" xref="S3.p2.10.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p2.10.m4.1b"><ci id="S3.p2.10.m4.1.1.cmml" xref="S3.p2.10.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.10.m4.1c">k</annotation></semantics></math>-th iteration.
After the client local updates, the server samples <math id="S3.p2.11.m5.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.p2.11.m5.1a"><mi id="S3.p2.11.m5.1.1" xref="S3.p2.11.m5.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.p2.11.m5.1b"><ci id="S3.p2.11.m5.1.1.cmml" xref="S3.p2.11.m5.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.11.m5.1c">m</annotation></semantics></math> clients for aggregation. The client <math id="S3.p2.12.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p2.12.m6.1a"><mi id="S3.p2.12.m6.1.1" xref="S3.p2.12.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p2.12.m6.1b"><ci id="S3.p2.12.m6.1.1.cmml" xref="S3.p2.12.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.12.m6.1c">i</annotation></semantics></math>’s pseudo gradient of local updates is denoted as <math id="S3.p2.13.m7.1" class="ltx_Math" alttext="\textbf{g}_{i}^{t}=\mathbf{w}_{g}^{t}-\mathbf{w}_{i}^{t}" display="inline"><semantics id="S3.p2.13.m7.1a"><mrow id="S3.p2.13.m7.1.1" xref="S3.p2.13.m7.1.1.cmml"><msubsup id="S3.p2.13.m7.1.1.2" xref="S3.p2.13.m7.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.p2.13.m7.1.1.2.2.2" xref="S3.p2.13.m7.1.1.2.2.2a.cmml">g</mtext><mi id="S3.p2.13.m7.1.1.2.2.3" xref="S3.p2.13.m7.1.1.2.2.3.cmml">i</mi><mi id="S3.p2.13.m7.1.1.2.3" xref="S3.p2.13.m7.1.1.2.3.cmml">t</mi></msubsup><mo id="S3.p2.13.m7.1.1.1" xref="S3.p2.13.m7.1.1.1.cmml">=</mo><mrow id="S3.p2.13.m7.1.1.3" xref="S3.p2.13.m7.1.1.3.cmml"><msubsup id="S3.p2.13.m7.1.1.3.2" xref="S3.p2.13.m7.1.1.3.2.cmml"><mi id="S3.p2.13.m7.1.1.3.2.2.2" xref="S3.p2.13.m7.1.1.3.2.2.2.cmml">𝐰</mi><mi id="S3.p2.13.m7.1.1.3.2.2.3" xref="S3.p2.13.m7.1.1.3.2.2.3.cmml">g</mi><mi id="S3.p2.13.m7.1.1.3.2.3" xref="S3.p2.13.m7.1.1.3.2.3.cmml">t</mi></msubsup><mo id="S3.p2.13.m7.1.1.3.1" xref="S3.p2.13.m7.1.1.3.1.cmml">−</mo><msubsup id="S3.p2.13.m7.1.1.3.3" xref="S3.p2.13.m7.1.1.3.3.cmml"><mi id="S3.p2.13.m7.1.1.3.3.2.2" xref="S3.p2.13.m7.1.1.3.3.2.2.cmml">𝐰</mi><mi id="S3.p2.13.m7.1.1.3.3.2.3" xref="S3.p2.13.m7.1.1.3.3.2.3.cmml">i</mi><mi id="S3.p2.13.m7.1.1.3.3.3" xref="S3.p2.13.m7.1.1.3.3.3.cmml">t</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.13.m7.1b"><apply id="S3.p2.13.m7.1.1.cmml" xref="S3.p2.13.m7.1.1"><eq id="S3.p2.13.m7.1.1.1.cmml" xref="S3.p2.13.m7.1.1.1"></eq><apply id="S3.p2.13.m7.1.1.2.cmml" xref="S3.p2.13.m7.1.1.2"><csymbol cd="ambiguous" id="S3.p2.13.m7.1.1.2.1.cmml" xref="S3.p2.13.m7.1.1.2">superscript</csymbol><apply id="S3.p2.13.m7.1.1.2.2.cmml" xref="S3.p2.13.m7.1.1.2"><csymbol cd="ambiguous" id="S3.p2.13.m7.1.1.2.2.1.cmml" xref="S3.p2.13.m7.1.1.2">subscript</csymbol><ci id="S3.p2.13.m7.1.1.2.2.2a.cmml" xref="S3.p2.13.m7.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.p2.13.m7.1.1.2.2.2.cmml" xref="S3.p2.13.m7.1.1.2.2.2">g</mtext></ci><ci id="S3.p2.13.m7.1.1.2.2.3.cmml" xref="S3.p2.13.m7.1.1.2.2.3">𝑖</ci></apply><ci id="S3.p2.13.m7.1.1.2.3.cmml" xref="S3.p2.13.m7.1.1.2.3">𝑡</ci></apply><apply id="S3.p2.13.m7.1.1.3.cmml" xref="S3.p2.13.m7.1.1.3"><minus id="S3.p2.13.m7.1.1.3.1.cmml" xref="S3.p2.13.m7.1.1.3.1"></minus><apply id="S3.p2.13.m7.1.1.3.2.cmml" xref="S3.p2.13.m7.1.1.3.2"><csymbol cd="ambiguous" id="S3.p2.13.m7.1.1.3.2.1.cmml" xref="S3.p2.13.m7.1.1.3.2">superscript</csymbol><apply id="S3.p2.13.m7.1.1.3.2.2.cmml" xref="S3.p2.13.m7.1.1.3.2"><csymbol cd="ambiguous" id="S3.p2.13.m7.1.1.3.2.2.1.cmml" xref="S3.p2.13.m7.1.1.3.2">subscript</csymbol><ci id="S3.p2.13.m7.1.1.3.2.2.2.cmml" xref="S3.p2.13.m7.1.1.3.2.2.2">𝐰</ci><ci id="S3.p2.13.m7.1.1.3.2.2.3.cmml" xref="S3.p2.13.m7.1.1.3.2.2.3">𝑔</ci></apply><ci id="S3.p2.13.m7.1.1.3.2.3.cmml" xref="S3.p2.13.m7.1.1.3.2.3">𝑡</ci></apply><apply id="S3.p2.13.m7.1.1.3.3.cmml" xref="S3.p2.13.m7.1.1.3.3"><csymbol cd="ambiguous" id="S3.p2.13.m7.1.1.3.3.1.cmml" xref="S3.p2.13.m7.1.1.3.3">superscript</csymbol><apply id="S3.p2.13.m7.1.1.3.3.2.cmml" xref="S3.p2.13.m7.1.1.3.3"><csymbol cd="ambiguous" id="S3.p2.13.m7.1.1.3.3.2.1.cmml" xref="S3.p2.13.m7.1.1.3.3">subscript</csymbol><ci id="S3.p2.13.m7.1.1.3.3.2.2.cmml" xref="S3.p2.13.m7.1.1.3.3.2.2">𝐰</ci><ci id="S3.p2.13.m7.1.1.3.3.2.3.cmml" xref="S3.p2.13.m7.1.1.3.3.2.3">𝑖</ci></apply><ci id="S3.p2.13.m7.1.1.3.3.3.cmml" xref="S3.p2.13.m7.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.13.m7.1c">\textbf{g}_{i}^{t}=\mathbf{w}_{g}^{t}-\mathbf{w}_{i}^{t}</annotation></semantics></math>.
Then, the server conducts weighted aggregation to merge the local models (or the pseudo gradients) into a new global model<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>As in <a href="#S3.E2" title="Equation 2 ‣ 3 Preliminary and Problem Setup ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Equation 2</span></a>, FL’s aggregation can be formulated into the aggregation of clients’ local models (left) or clients’ pseudo gradients (right). The two kinds of the formulation are equal, while we adopt the aggregation of models here for brevity.</span></span></span>.
<span id="S3.p2.13.1" class="ltx_text" style="font-size:90%;"></span></p>
<table id="A4.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2.m1.2" class="ltx_Math" alttext="\displaystyle\mathbf{w}_{g}^{t+1}=\sum_{i=1}^{m}\mu_{i}\textbf{w}_{i}^{t}=\|\boldsymbol{\mu}\|_{1}\textbf{w}_{g}^{t}-\eta_{g}\sum_{i=1}^{m}\mu_{i}\textbf{g}_{i}^{t},\text{ s.t. }\mu_{i}\geq 0," display="inline"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2.1"><mrow id="S3.E2.m1.2.2.1.1.2" xref="S3.E2.m1.2.2.1.1.3.cmml"><mrow id="S3.E2.m1.2.2.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.cmml"><msubsup id="S3.E2.m1.2.2.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.2.cmml"><mi mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.2.2.2" xref="S3.E2.m1.2.2.1.1.1.1.2.2.2.cmml">𝐰</mi><mi mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.2.2.3" xref="S3.E2.m1.2.2.1.1.1.1.2.2.3.cmml">g</mi><mrow id="S3.E2.m1.2.2.1.1.1.1.2.3" xref="S3.E2.m1.2.2.1.1.1.1.2.3.cmml"><mi mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.2.3.2" xref="S3.E2.m1.2.2.1.1.1.1.2.3.2.cmml">t</mi><mo mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.2.3.1" xref="S3.E2.m1.2.2.1.1.1.1.2.3.1.cmml">+</mo><mn mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.2.3.3" xref="S3.E2.m1.2.2.1.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.3.cmml">=</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.4" xref="S3.E2.m1.2.2.1.1.1.1.4.cmml"><mstyle displaystyle="true" id="S3.E2.m1.2.2.1.1.1.1.4.1" xref="S3.E2.m1.2.2.1.1.1.1.4.1.cmml"><munderover id="S3.E2.m1.2.2.1.1.1.1.4.1a" xref="S3.E2.m1.2.2.1.1.1.1.4.1.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S3.E2.m1.2.2.1.1.1.1.4.1.2.2" xref="S3.E2.m1.2.2.1.1.1.1.4.1.2.2.cmml">∑</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.4.1.2.3" xref="S3.E2.m1.2.2.1.1.1.1.4.1.2.3.cmml"><mi mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.4.1.2.3.2" xref="S3.E2.m1.2.2.1.1.1.1.4.1.2.3.2.cmml">i</mi><mo mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.4.1.2.3.1" xref="S3.E2.m1.2.2.1.1.1.1.4.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.4.1.2.3.3" xref="S3.E2.m1.2.2.1.1.1.1.4.1.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.4.1.3" xref="S3.E2.m1.2.2.1.1.1.1.4.1.3.cmml">m</mi></munderover></mstyle><mrow id="S3.E2.m1.2.2.1.1.1.1.4.2" xref="S3.E2.m1.2.2.1.1.1.1.4.2.cmml"><msub id="S3.E2.m1.2.2.1.1.1.1.4.2.2" xref="S3.E2.m1.2.2.1.1.1.1.4.2.2.cmml"><mi mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.4.2.2.2" xref="S3.E2.m1.2.2.1.1.1.1.4.2.2.2.cmml">μ</mi><mi mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.4.2.2.3" xref="S3.E2.m1.2.2.1.1.1.1.4.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.1.4.2.1" xref="S3.E2.m1.2.2.1.1.1.1.4.2.1.cmml">​</mo><msubsup id="S3.E2.m1.2.2.1.1.1.1.4.2.3" xref="S3.E2.m1.2.2.1.1.1.1.4.2.3.cmml"><mtext class="ltx_mathvariant_bold" mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.4.2.3.2.2" xref="S3.E2.m1.2.2.1.1.1.1.4.2.3.2.2a.cmml">w</mtext><mi mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.4.2.3.2.3" xref="S3.E2.m1.2.2.1.1.1.1.4.2.3.2.3.cmml">i</mi><mi mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.4.2.3.3" xref="S3.E2.m1.2.2.1.1.1.1.4.2.3.3.cmml">t</mi></msubsup></mrow></mrow><mo mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.5" xref="S3.E2.m1.2.2.1.1.1.1.5.cmml">=</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.6" xref="S3.E2.m1.2.2.1.1.1.1.6.cmml"><mrow id="S3.E2.m1.2.2.1.1.1.1.6.2" xref="S3.E2.m1.2.2.1.1.1.1.6.2.cmml"><msub id="S3.E2.m1.2.2.1.1.1.1.6.2.2" xref="S3.E2.m1.2.2.1.1.1.1.6.2.2.cmml"><mrow id="S3.E2.m1.2.2.1.1.1.1.6.2.2.2.2" xref="S3.E2.m1.2.2.1.1.1.1.6.2.2.2.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.E2.m1.2.2.1.1.1.1.6.2.2.2.2.1" xref="S3.E2.m1.2.2.1.1.1.1.6.2.2.2.1.1.cmml">‖</mo><mi mathsize="90%" id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">𝝁</mi><mo maxsize="90%" minsize="90%" id="S3.E2.m1.2.2.1.1.1.1.6.2.2.2.2.2" xref="S3.E2.m1.2.2.1.1.1.1.6.2.2.2.1.1.cmml">‖</mo></mrow><mn mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.6.2.2.3" xref="S3.E2.m1.2.2.1.1.1.1.6.2.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.1.6.2.1" xref="S3.E2.m1.2.2.1.1.1.1.6.2.1.cmml">​</mo><msubsup id="S3.E2.m1.2.2.1.1.1.1.6.2.3" xref="S3.E2.m1.2.2.1.1.1.1.6.2.3.cmml"><mtext class="ltx_mathvariant_bold" mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.6.2.3.2.2" xref="S3.E2.m1.2.2.1.1.1.1.6.2.3.2.2a.cmml">w</mtext><mi mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.6.2.3.2.3" xref="S3.E2.m1.2.2.1.1.1.1.6.2.3.2.3.cmml">g</mi><mi mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.6.2.3.3" xref="S3.E2.m1.2.2.1.1.1.1.6.2.3.3.cmml">t</mi></msubsup></mrow><mo mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.6.1" xref="S3.E2.m1.2.2.1.1.1.1.6.1.cmml">−</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.6.3" xref="S3.E2.m1.2.2.1.1.1.1.6.3.cmml"><msub id="S3.E2.m1.2.2.1.1.1.1.6.3.2" xref="S3.E2.m1.2.2.1.1.1.1.6.3.2.cmml"><mi mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.6.3.2.2" xref="S3.E2.m1.2.2.1.1.1.1.6.3.2.2.cmml">η</mi><mi mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.6.3.2.3" xref="S3.E2.m1.2.2.1.1.1.1.6.3.2.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.1.6.3.1" xref="S3.E2.m1.2.2.1.1.1.1.6.3.1.cmml">​</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.6.3.3" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.cmml"><mstyle displaystyle="true" id="S3.E2.m1.2.2.1.1.1.1.6.3.3.1" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.cmml"><munderover id="S3.E2.m1.2.2.1.1.1.1.6.3.3.1a" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.2.2" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.2.3" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.2.3.cmml"><mi mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.2.3.2" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.2.3.2.cmml">i</mi><mo mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.2.3.1" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.2.3.3" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.3" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.3.cmml">m</mi></munderover></mstyle><mrow id="S3.E2.m1.2.2.1.1.1.1.6.3.3.2" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.cmml"><msub id="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.2" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.2.cmml"><mi mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.2.2" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.2.2.cmml">μ</mi><mi mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.2.3" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.1" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.1.cmml">​</mo><msubsup id="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.3" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.3.cmml"><mtext class="ltx_mathvariant_bold" mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.3.2.2" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.3.2.2a.cmml">g</mtext><mi mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.3.2.3" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.3.2.3.cmml">i</mi><mi mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.3.3" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.3.3.cmml">t</mi></msubsup></mrow></mrow></mrow></mrow></mrow><mo mathsize="90%" id="S3.E2.m1.2.2.1.1.2.3" xref="S3.E2.m1.2.2.1.1.3a.cmml">,</mo><mrow id="S3.E2.m1.2.2.1.1.2.2" xref="S3.E2.m1.2.2.1.1.2.2.cmml"><mrow id="S3.E2.m1.2.2.1.1.2.2.2" xref="S3.E2.m1.2.2.1.1.2.2.2.cmml"><mtext mathsize="90%" id="S3.E2.m1.2.2.1.1.2.2.2.2" xref="S3.E2.m1.2.2.1.1.2.2.2.2a.cmml"> s.t. </mtext><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.2.2.2.1" xref="S3.E2.m1.2.2.1.1.2.2.2.1.cmml">​</mo><msub id="S3.E2.m1.2.2.1.1.2.2.2.3" xref="S3.E2.m1.2.2.1.1.2.2.2.3.cmml"><mi mathsize="90%" id="S3.E2.m1.2.2.1.1.2.2.2.3.2" xref="S3.E2.m1.2.2.1.1.2.2.2.3.2.cmml">μ</mi><mi mathsize="90%" id="S3.E2.m1.2.2.1.1.2.2.2.3.3" xref="S3.E2.m1.2.2.1.1.2.2.2.3.3.cmml">i</mi></msub></mrow><mo mathsize="90%" id="S3.E2.m1.2.2.1.1.2.2.1" xref="S3.E2.m1.2.2.1.1.2.2.1.cmml">≥</mo><mn mathsize="90%" id="S3.E2.m1.2.2.1.1.2.2.3" xref="S3.E2.m1.2.2.1.1.2.2.3.cmml">0</mn></mrow></mrow><mo mathsize="90%" id="S3.E2.m1.2.2.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.3a.cmml" xref="S3.E2.m1.2.2.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.2.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1"><and id="S3.E2.m1.2.2.1.1.1.1a.cmml" xref="S3.E2.m1.2.2.1.1.1.1"></and><apply id="S3.E2.m1.2.2.1.1.1.1b.cmml" xref="S3.E2.m1.2.2.1.1.1.1"><eq id="S3.E2.m1.2.2.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.3"></eq><apply id="S3.E2.m1.2.2.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.2">superscript</csymbol><apply id="S3.E2.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.2.2.2">𝐰</ci><ci id="S3.E2.m1.2.2.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.2.2.3">𝑔</ci></apply><apply id="S3.E2.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.2.3"><plus id="S3.E2.m1.2.2.1.1.1.1.2.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.2.3.1"></plus><ci id="S3.E2.m1.2.2.1.1.1.1.2.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S3.E2.m1.2.2.1.1.1.1.2.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E2.m1.2.2.1.1.1.1.4.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4"><apply id="S3.E2.m1.2.2.1.1.1.1.4.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.4.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.1">superscript</csymbol><apply id="S3.E2.m1.2.2.1.1.1.1.4.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.4.1.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.1">subscript</csymbol><sum id="S3.E2.m1.2.2.1.1.1.1.4.1.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.1.2.2"></sum><apply id="S3.E2.m1.2.2.1.1.1.1.4.1.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.1.2.3"><eq id="S3.E2.m1.2.2.1.1.1.1.4.1.2.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.1.2.3.1"></eq><ci id="S3.E2.m1.2.2.1.1.1.1.4.1.2.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E2.m1.2.2.1.1.1.1.4.1.2.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.1.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.2.2.1.1.1.1.4.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.1.3">𝑚</ci></apply><apply id="S3.E2.m1.2.2.1.1.1.1.4.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.2"><times id="S3.E2.m1.2.2.1.1.1.1.4.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.2.1"></times><apply id="S3.E2.m1.2.2.1.1.1.1.4.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.4.2.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.2.2">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.4.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.2.2.2">𝜇</ci><ci id="S3.E2.m1.2.2.1.1.1.1.4.2.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.2.2.3">𝑖</ci></apply><apply id="S3.E2.m1.2.2.1.1.1.1.4.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.4.2.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.2.3">superscript</csymbol><apply id="S3.E2.m1.2.2.1.1.1.1.4.2.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.4.2.3.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.2.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.4.2.3.2.2a.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.2.3.2.2"><mtext class="ltx_mathvariant_bold" mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.4.2.3.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.2.3.2.2">w</mtext></ci><ci id="S3.E2.m1.2.2.1.1.1.1.4.2.3.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.2.3.2.3">𝑖</ci></apply><ci id="S3.E2.m1.2.2.1.1.1.1.4.2.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.2.3.3">𝑡</ci></apply></apply></apply></apply><apply id="S3.E2.m1.2.2.1.1.1.1c.cmml" xref="S3.E2.m1.2.2.1.1.1.1"><eq id="S3.E2.m1.2.2.1.1.1.1.5.cmml" xref="S3.E2.m1.2.2.1.1.1.1.5"></eq><share href="#S3.E2.m1.2.2.1.1.1.1.4.cmml" id="S3.E2.m1.2.2.1.1.1.1d.cmml" xref="S3.E2.m1.2.2.1.1.1.1"></share><apply id="S3.E2.m1.2.2.1.1.1.1.6.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6"><minus id="S3.E2.m1.2.2.1.1.1.1.6.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.1"></minus><apply id="S3.E2.m1.2.2.1.1.1.1.6.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.2"><times id="S3.E2.m1.2.2.1.1.1.1.6.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.2.1"></times><apply id="S3.E2.m1.2.2.1.1.1.1.6.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.6.2.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.2.2">subscript</csymbol><apply id="S3.E2.m1.2.2.1.1.1.1.6.2.2.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.2.2.2.2"><csymbol cd="latexml" id="S3.E2.m1.2.2.1.1.1.1.6.2.2.2.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.2.2.2.2.1">norm</csymbol><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝝁</ci></apply><cn type="integer" id="S3.E2.m1.2.2.1.1.1.1.6.2.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.2.2.3">1</cn></apply><apply id="S3.E2.m1.2.2.1.1.1.1.6.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.6.2.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.2.3">superscript</csymbol><apply id="S3.E2.m1.2.2.1.1.1.1.6.2.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.6.2.3.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.2.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.6.2.3.2.2a.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.2.3.2.2"><mtext class="ltx_mathvariant_bold" mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.6.2.3.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.2.3.2.2">w</mtext></ci><ci id="S3.E2.m1.2.2.1.1.1.1.6.2.3.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.2.3.2.3">𝑔</ci></apply><ci id="S3.E2.m1.2.2.1.1.1.1.6.2.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.2.3.3">𝑡</ci></apply></apply><apply id="S3.E2.m1.2.2.1.1.1.1.6.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3"><times id="S3.E2.m1.2.2.1.1.1.1.6.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.1"></times><apply id="S3.E2.m1.2.2.1.1.1.1.6.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.6.3.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.2">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.6.3.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.2.2">𝜂</ci><ci id="S3.E2.m1.2.2.1.1.1.1.6.3.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.2.3">𝑔</ci></apply><apply id="S3.E2.m1.2.2.1.1.1.1.6.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3"><apply id="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.1">superscript</csymbol><apply id="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.1">subscript</csymbol><sum id="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.2.2"></sum><apply id="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.2.3"><eq id="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.2.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.2.3.1"></eq><ci id="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.2.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.2.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.1.3">𝑚</ci></apply><apply id="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.2"><times id="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.1"></times><apply id="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.2">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.2.2">𝜇</ci><ci id="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.2.3">𝑖</ci></apply><apply id="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.3">superscript</csymbol><apply id="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.3.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.3.2.2a.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.3.2.2"><mtext class="ltx_mathvariant_bold" mathsize="90%" id="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.3.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.3.2.2">g</mtext></ci><ci id="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.3.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.3.2.3">𝑖</ci></apply><ci id="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.6.3.3.2.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></apply><apply id="S3.E2.m1.2.2.1.1.2.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2"><geq id="S3.E2.m1.2.2.1.1.2.2.1.cmml" xref="S3.E2.m1.2.2.1.1.2.2.1"></geq><apply id="S3.E2.m1.2.2.1.1.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2"><times id="S3.E2.m1.2.2.1.1.2.2.2.1.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.1"></times><ci id="S3.E2.m1.2.2.1.1.2.2.2.2a.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.2"><mtext mathsize="90%" id="S3.E2.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.2"> s.t. </mtext></ci><apply id="S3.E2.m1.2.2.1.1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.2.2.2.3.1.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.2.2.2.3.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.3.2">𝜇</ci><ci id="S3.E2.m1.2.2.1.1.2.2.2.3.3.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.3.3">𝑖</ci></apply></apply><cn type="integer" id="S3.E2.m1.2.2.1.1.2.2.3.cmml" xref="S3.E2.m1.2.2.1.1.2.2.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">\displaystyle\mathbf{w}_{g}^{t+1}=\sum_{i=1}^{m}\mu_{i}\textbf{w}_{i}^{t}=\|\boldsymbol{\mu}\|_{1}\textbf{w}_{g}^{t}-\eta_{g}\sum_{i=1}^{m}\mu_{i}\textbf{g}_{i}^{t},\text{ s.t. }\mu_{i}\geq 0,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.p2.21" class="ltx_p">where <math id="S3.p2.14.m1.3" class="ltx_Math" alttext="\boldsymbol{\mu}=[\mu_{1},\dots,\mu_{m}]" display="inline"><semantics id="S3.p2.14.m1.3a"><mrow id="S3.p2.14.m1.3.3" xref="S3.p2.14.m1.3.3.cmml"><mi id="S3.p2.14.m1.3.3.4" xref="S3.p2.14.m1.3.3.4.cmml">𝝁</mi><mo id="S3.p2.14.m1.3.3.3" xref="S3.p2.14.m1.3.3.3.cmml">=</mo><mrow id="S3.p2.14.m1.3.3.2.2" xref="S3.p2.14.m1.3.3.2.3.cmml"><mo stretchy="false" id="S3.p2.14.m1.3.3.2.2.3" xref="S3.p2.14.m1.3.3.2.3.cmml">[</mo><msub id="S3.p2.14.m1.2.2.1.1.1" xref="S3.p2.14.m1.2.2.1.1.1.cmml"><mi id="S3.p2.14.m1.2.2.1.1.1.2" xref="S3.p2.14.m1.2.2.1.1.1.2.cmml">μ</mi><mn id="S3.p2.14.m1.2.2.1.1.1.3" xref="S3.p2.14.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.p2.14.m1.3.3.2.2.4" xref="S3.p2.14.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.p2.14.m1.1.1" xref="S3.p2.14.m1.1.1.cmml">…</mi><mo id="S3.p2.14.m1.3.3.2.2.5" xref="S3.p2.14.m1.3.3.2.3.cmml">,</mo><msub id="S3.p2.14.m1.3.3.2.2.2" xref="S3.p2.14.m1.3.3.2.2.2.cmml"><mi id="S3.p2.14.m1.3.3.2.2.2.2" xref="S3.p2.14.m1.3.3.2.2.2.2.cmml">μ</mi><mi id="S3.p2.14.m1.3.3.2.2.2.3" xref="S3.p2.14.m1.3.3.2.2.2.3.cmml">m</mi></msub><mo stretchy="false" id="S3.p2.14.m1.3.3.2.2.6" xref="S3.p2.14.m1.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.14.m1.3b"><apply id="S3.p2.14.m1.3.3.cmml" xref="S3.p2.14.m1.3.3"><eq id="S3.p2.14.m1.3.3.3.cmml" xref="S3.p2.14.m1.3.3.3"></eq><ci id="S3.p2.14.m1.3.3.4.cmml" xref="S3.p2.14.m1.3.3.4">𝝁</ci><list id="S3.p2.14.m1.3.3.2.3.cmml" xref="S3.p2.14.m1.3.3.2.2"><apply id="S3.p2.14.m1.2.2.1.1.1.cmml" xref="S3.p2.14.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p2.14.m1.2.2.1.1.1.1.cmml" xref="S3.p2.14.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.p2.14.m1.2.2.1.1.1.2.cmml" xref="S3.p2.14.m1.2.2.1.1.1.2">𝜇</ci><cn type="integer" id="S3.p2.14.m1.2.2.1.1.1.3.cmml" xref="S3.p2.14.m1.2.2.1.1.1.3">1</cn></apply><ci id="S3.p2.14.m1.1.1.cmml" xref="S3.p2.14.m1.1.1">…</ci><apply id="S3.p2.14.m1.3.3.2.2.2.cmml" xref="S3.p2.14.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p2.14.m1.3.3.2.2.2.1.cmml" xref="S3.p2.14.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.p2.14.m1.3.3.2.2.2.2.cmml" xref="S3.p2.14.m1.3.3.2.2.2.2">𝜇</ci><ci id="S3.p2.14.m1.3.3.2.2.2.3.cmml" xref="S3.p2.14.m1.3.3.2.2.2.3">𝑚</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.14.m1.3c">\boldsymbol{\mu}=[\mu_{1},\dots,\mu_{m}]</annotation></semantics></math> is the aggregation weights, <math id="S3.p2.15.m2.1" class="ltx_Math" alttext="\eta_{g}=1" display="inline"><semantics id="S3.p2.15.m2.1a"><mrow id="S3.p2.15.m2.1.1" xref="S3.p2.15.m2.1.1.cmml"><msub id="S3.p2.15.m2.1.1.2" xref="S3.p2.15.m2.1.1.2.cmml"><mi id="S3.p2.15.m2.1.1.2.2" xref="S3.p2.15.m2.1.1.2.2.cmml">η</mi><mi id="S3.p2.15.m2.1.1.2.3" xref="S3.p2.15.m2.1.1.2.3.cmml">g</mi></msub><mo id="S3.p2.15.m2.1.1.1" xref="S3.p2.15.m2.1.1.1.cmml">=</mo><mn id="S3.p2.15.m2.1.1.3" xref="S3.p2.15.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.15.m2.1b"><apply id="S3.p2.15.m2.1.1.cmml" xref="S3.p2.15.m2.1.1"><eq id="S3.p2.15.m2.1.1.1.cmml" xref="S3.p2.15.m2.1.1.1"></eq><apply id="S3.p2.15.m2.1.1.2.cmml" xref="S3.p2.15.m2.1.1.2"><csymbol cd="ambiguous" id="S3.p2.15.m2.1.1.2.1.cmml" xref="S3.p2.15.m2.1.1.2">subscript</csymbol><ci id="S3.p2.15.m2.1.1.2.2.cmml" xref="S3.p2.15.m2.1.1.2.2">𝜂</ci><ci id="S3.p2.15.m2.1.1.2.3.cmml" xref="S3.p2.15.m2.1.1.2.3">𝑔</ci></apply><cn type="integer" id="S3.p2.15.m2.1.1.3.cmml" xref="S3.p2.15.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.15.m2.1c">\eta_{g}=1</annotation></semantics></math> is the global learning rate. For vanilla <span id="S3.p2.21.1" class="ltx_text ltx_font_smallcaps">FedAvg</span>, it adopts a normalized weights proportional to the data sizes, <math id="S3.p2.16.m3.4" class="ltx_Math" alttext="\mu_{i}=\frac{|\mathcal{D}_{i}|}{|\mathcal{D}|},\mathcal{D}=\bigcup_{i\in\mathcal{S}}\mathcal{D}_{i}" display="inline"><semantics id="S3.p2.16.m3.4a"><mrow id="S3.p2.16.m3.4.4.2" xref="S3.p2.16.m3.4.4.3.cmml"><mrow id="S3.p2.16.m3.3.3.1.1" xref="S3.p2.16.m3.3.3.1.1.cmml"><msub id="S3.p2.16.m3.3.3.1.1.2" xref="S3.p2.16.m3.3.3.1.1.2.cmml"><mi id="S3.p2.16.m3.3.3.1.1.2.2" xref="S3.p2.16.m3.3.3.1.1.2.2.cmml">μ</mi><mi id="S3.p2.16.m3.3.3.1.1.2.3" xref="S3.p2.16.m3.3.3.1.1.2.3.cmml">i</mi></msub><mo id="S3.p2.16.m3.3.3.1.1.1" xref="S3.p2.16.m3.3.3.1.1.1.cmml">=</mo><mfrac id="S3.p2.16.m3.2.2" xref="S3.p2.16.m3.2.2.cmml"><mrow id="S3.p2.16.m3.1.1.1.1" xref="S3.p2.16.m3.1.1.1.2.cmml"><mo stretchy="false" id="S3.p2.16.m3.1.1.1.1.2" xref="S3.p2.16.m3.1.1.1.2.1.cmml">|</mo><msub id="S3.p2.16.m3.1.1.1.1.1" xref="S3.p2.16.m3.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.16.m3.1.1.1.1.1.2" xref="S3.p2.16.m3.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.p2.16.m3.1.1.1.1.1.3" xref="S3.p2.16.m3.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.p2.16.m3.1.1.1.1.3" xref="S3.p2.16.m3.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S3.p2.16.m3.2.2.2.3" xref="S3.p2.16.m3.2.2.2.2.cmml"><mo stretchy="false" id="S3.p2.16.m3.2.2.2.3.1" xref="S3.p2.16.m3.2.2.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.16.m3.2.2.2.1" xref="S3.p2.16.m3.2.2.2.1.cmml">𝒟</mi><mo stretchy="false" id="S3.p2.16.m3.2.2.2.3.2" xref="S3.p2.16.m3.2.2.2.2.1.cmml">|</mo></mrow></mfrac></mrow><mo id="S3.p2.16.m3.4.4.2.3" xref="S3.p2.16.m3.4.4.3a.cmml">,</mo><mrow id="S3.p2.16.m3.4.4.2.2" xref="S3.p2.16.m3.4.4.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.16.m3.4.4.2.2.2" xref="S3.p2.16.m3.4.4.2.2.2.cmml">𝒟</mi><mo rspace="0.111em" id="S3.p2.16.m3.4.4.2.2.1" xref="S3.p2.16.m3.4.4.2.2.1.cmml">=</mo><mrow id="S3.p2.16.m3.4.4.2.2.3" xref="S3.p2.16.m3.4.4.2.2.3.cmml"><msub id="S3.p2.16.m3.4.4.2.2.3.1" xref="S3.p2.16.m3.4.4.2.2.3.1.cmml"><mo id="S3.p2.16.m3.4.4.2.2.3.1.2" xref="S3.p2.16.m3.4.4.2.2.3.1.2.cmml">⋃</mo><mrow id="S3.p2.16.m3.4.4.2.2.3.1.3" xref="S3.p2.16.m3.4.4.2.2.3.1.3.cmml"><mi id="S3.p2.16.m3.4.4.2.2.3.1.3.2" xref="S3.p2.16.m3.4.4.2.2.3.1.3.2.cmml">i</mi><mo id="S3.p2.16.m3.4.4.2.2.3.1.3.1" xref="S3.p2.16.m3.4.4.2.2.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.16.m3.4.4.2.2.3.1.3.3" xref="S3.p2.16.m3.4.4.2.2.3.1.3.3.cmml">𝒮</mi></mrow></msub><msub id="S3.p2.16.m3.4.4.2.2.3.2" xref="S3.p2.16.m3.4.4.2.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.16.m3.4.4.2.2.3.2.2" xref="S3.p2.16.m3.4.4.2.2.3.2.2.cmml">𝒟</mi><mi id="S3.p2.16.m3.4.4.2.2.3.2.3" xref="S3.p2.16.m3.4.4.2.2.3.2.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.16.m3.4b"><apply id="S3.p2.16.m3.4.4.3.cmml" xref="S3.p2.16.m3.4.4.2"><csymbol cd="ambiguous" id="S3.p2.16.m3.4.4.3a.cmml" xref="S3.p2.16.m3.4.4.2.3">formulae-sequence</csymbol><apply id="S3.p2.16.m3.3.3.1.1.cmml" xref="S3.p2.16.m3.3.3.1.1"><eq id="S3.p2.16.m3.3.3.1.1.1.cmml" xref="S3.p2.16.m3.3.3.1.1.1"></eq><apply id="S3.p2.16.m3.3.3.1.1.2.cmml" xref="S3.p2.16.m3.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.p2.16.m3.3.3.1.1.2.1.cmml" xref="S3.p2.16.m3.3.3.1.1.2">subscript</csymbol><ci id="S3.p2.16.m3.3.3.1.1.2.2.cmml" xref="S3.p2.16.m3.3.3.1.1.2.2">𝜇</ci><ci id="S3.p2.16.m3.3.3.1.1.2.3.cmml" xref="S3.p2.16.m3.3.3.1.1.2.3">𝑖</ci></apply><apply id="S3.p2.16.m3.2.2.cmml" xref="S3.p2.16.m3.2.2"><divide id="S3.p2.16.m3.2.2.3.cmml" xref="S3.p2.16.m3.2.2"></divide><apply id="S3.p2.16.m3.1.1.1.2.cmml" xref="S3.p2.16.m3.1.1.1.1"><abs id="S3.p2.16.m3.1.1.1.2.1.cmml" xref="S3.p2.16.m3.1.1.1.1.2"></abs><apply id="S3.p2.16.m3.1.1.1.1.1.cmml" xref="S3.p2.16.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.16.m3.1.1.1.1.1.1.cmml" xref="S3.p2.16.m3.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.16.m3.1.1.1.1.1.2.cmml" xref="S3.p2.16.m3.1.1.1.1.1.2">𝒟</ci><ci id="S3.p2.16.m3.1.1.1.1.1.3.cmml" xref="S3.p2.16.m3.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.p2.16.m3.2.2.2.2.cmml" xref="S3.p2.16.m3.2.2.2.3"><abs id="S3.p2.16.m3.2.2.2.2.1.cmml" xref="S3.p2.16.m3.2.2.2.3.1"></abs><ci id="S3.p2.16.m3.2.2.2.1.cmml" xref="S3.p2.16.m3.2.2.2.1">𝒟</ci></apply></apply></apply><apply id="S3.p2.16.m3.4.4.2.2.cmml" xref="S3.p2.16.m3.4.4.2.2"><eq id="S3.p2.16.m3.4.4.2.2.1.cmml" xref="S3.p2.16.m3.4.4.2.2.1"></eq><ci id="S3.p2.16.m3.4.4.2.2.2.cmml" xref="S3.p2.16.m3.4.4.2.2.2">𝒟</ci><apply id="S3.p2.16.m3.4.4.2.2.3.cmml" xref="S3.p2.16.m3.4.4.2.2.3"><apply id="S3.p2.16.m3.4.4.2.2.3.1.cmml" xref="S3.p2.16.m3.4.4.2.2.3.1"><csymbol cd="ambiguous" id="S3.p2.16.m3.4.4.2.2.3.1.1.cmml" xref="S3.p2.16.m3.4.4.2.2.3.1">subscript</csymbol><union id="S3.p2.16.m3.4.4.2.2.3.1.2.cmml" xref="S3.p2.16.m3.4.4.2.2.3.1.2"></union><apply id="S3.p2.16.m3.4.4.2.2.3.1.3.cmml" xref="S3.p2.16.m3.4.4.2.2.3.1.3"><in id="S3.p2.16.m3.4.4.2.2.3.1.3.1.cmml" xref="S3.p2.16.m3.4.4.2.2.3.1.3.1"></in><ci id="S3.p2.16.m3.4.4.2.2.3.1.3.2.cmml" xref="S3.p2.16.m3.4.4.2.2.3.1.3.2">𝑖</ci><ci id="S3.p2.16.m3.4.4.2.2.3.1.3.3.cmml" xref="S3.p2.16.m3.4.4.2.2.3.1.3.3">𝒮</ci></apply></apply><apply id="S3.p2.16.m3.4.4.2.2.3.2.cmml" xref="S3.p2.16.m3.4.4.2.2.3.2"><csymbol cd="ambiguous" id="S3.p2.16.m3.4.4.2.2.3.2.1.cmml" xref="S3.p2.16.m3.4.4.2.2.3.2">subscript</csymbol><ci id="S3.p2.16.m3.4.4.2.2.3.2.2.cmml" xref="S3.p2.16.m3.4.4.2.2.3.2.2">𝒟</ci><ci id="S3.p2.16.m3.4.4.2.2.3.2.3.cmml" xref="S3.p2.16.m3.4.4.2.2.3.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.16.m3.4c">\mu_{i}=\frac{|\mathcal{D}_{i}|}{|\mathcal{D}|},\mathcal{D}=\bigcup_{i\in\mathcal{S}}\mathcal{D}_{i}</annotation></semantics></math>. In this paper, we assume the aggregation weights are not normalized which means the <math id="S3.p2.17.m4.1" class="ltx_Math" alttext="l_{1}" display="inline"><semantics id="S3.p2.17.m4.1a"><msub id="S3.p2.17.m4.1.1" xref="S3.p2.17.m4.1.1.cmml"><mi id="S3.p2.17.m4.1.1.2" xref="S3.p2.17.m4.1.1.2.cmml">l</mi><mn id="S3.p2.17.m4.1.1.3" xref="S3.p2.17.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p2.17.m4.1b"><apply id="S3.p2.17.m4.1.1.cmml" xref="S3.p2.17.m4.1.1"><csymbol cd="ambiguous" id="S3.p2.17.m4.1.1.1.cmml" xref="S3.p2.17.m4.1.1">subscript</csymbol><ci id="S3.p2.17.m4.1.1.2.cmml" xref="S3.p2.17.m4.1.1.2">𝑙</ci><cn type="integer" id="S3.p2.17.m4.1.1.3.cmml" xref="S3.p2.17.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.17.m4.1c">l_{1}</annotation></semantics></math> norm is not necessarily equal to 1. We study the effects of the <math id="S3.p2.18.m5.1" class="ltx_Math" alttext="l_{1}" display="inline"><semantics id="S3.p2.18.m5.1a"><msub id="S3.p2.18.m5.1.1" xref="S3.p2.18.m5.1.1.cmml"><mi id="S3.p2.18.m5.1.1.2" xref="S3.p2.18.m5.1.1.2.cmml">l</mi><mn id="S3.p2.18.m5.1.1.3" xref="S3.p2.18.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p2.18.m5.1b"><apply id="S3.p2.18.m5.1.1.cmml" xref="S3.p2.18.m5.1.1"><csymbol cd="ambiguous" id="S3.p2.18.m5.1.1.1.cmml" xref="S3.p2.18.m5.1.1">subscript</csymbol><ci id="S3.p2.18.m5.1.1.2.cmml" xref="S3.p2.18.m5.1.1.2">𝑙</ci><cn type="integer" id="S3.p2.18.m5.1.1.3.cmml" xref="S3.p2.18.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.18.m5.1c">l_{1}</annotation></semantics></math> norm and relative weights independently by decouple <math id="S3.p2.19.m6.1" class="ltx_Math" alttext="\boldsymbol{\mu}" display="inline"><semantics id="S3.p2.19.m6.1a"><mi id="S3.p2.19.m6.1.1" xref="S3.p2.19.m6.1.1.cmml">𝝁</mi><annotation-xml encoding="MathML-Content" id="S3.p2.19.m6.1b"><ci id="S3.p2.19.m6.1.1.cmml" xref="S3.p2.19.m6.1.1">𝝁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.19.m6.1c">\boldsymbol{\mu}</annotation></semantics></math> into <math id="S3.p2.20.m7.2" class="ltx_Math" alttext="\{\gamma,\boldsymbol{\lambda}\}" display="inline"><semantics id="S3.p2.20.m7.2a"><mrow id="S3.p2.20.m7.2.3.2" xref="S3.p2.20.m7.2.3.1.cmml"><mo stretchy="false" id="S3.p2.20.m7.2.3.2.1" xref="S3.p2.20.m7.2.3.1.cmml">{</mo><mi id="S3.p2.20.m7.1.1" xref="S3.p2.20.m7.1.1.cmml">γ</mi><mo id="S3.p2.20.m7.2.3.2.2" xref="S3.p2.20.m7.2.3.1.cmml">,</mo><mi id="S3.p2.20.m7.2.2" xref="S3.p2.20.m7.2.2.cmml">𝝀</mi><mo stretchy="false" id="S3.p2.20.m7.2.3.2.3" xref="S3.p2.20.m7.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.20.m7.2b"><set id="S3.p2.20.m7.2.3.1.cmml" xref="S3.p2.20.m7.2.3.2"><ci id="S3.p2.20.m7.1.1.cmml" xref="S3.p2.20.m7.1.1">𝛾</ci><ci id="S3.p2.20.m7.2.2.cmml" xref="S3.p2.20.m7.2.2">𝝀</ci></set></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.20.m7.2c">\{\gamma,\boldsymbol{\lambda}\}</annotation></semantics></math>, which satisfies <math id="S3.p2.21.m8.4" class="ltx_Math" alttext="\gamma=\|\boldsymbol{\mu}\|_{1},\lambda_{i}=\frac{\mu_{i}}{\|\boldsymbol{\mu}\|_{1}}" display="inline"><semantics id="S3.p2.21.m8.4a"><mrow id="S3.p2.21.m8.4.4.2" xref="S3.p2.21.m8.4.4.3.cmml"><mrow id="S3.p2.21.m8.3.3.1.1" xref="S3.p2.21.m8.3.3.1.1.cmml"><mi id="S3.p2.21.m8.3.3.1.1.2" xref="S3.p2.21.m8.3.3.1.1.2.cmml">γ</mi><mo id="S3.p2.21.m8.3.3.1.1.1" xref="S3.p2.21.m8.3.3.1.1.1.cmml">=</mo><msub id="S3.p2.21.m8.3.3.1.1.3" xref="S3.p2.21.m8.3.3.1.1.3.cmml"><mrow id="S3.p2.21.m8.3.3.1.1.3.2.2" xref="S3.p2.21.m8.3.3.1.1.3.2.1.cmml"><mo stretchy="false" id="S3.p2.21.m8.3.3.1.1.3.2.2.1" xref="S3.p2.21.m8.3.3.1.1.3.2.1.1.cmml">‖</mo><mi id="S3.p2.21.m8.2.2" xref="S3.p2.21.m8.2.2.cmml">𝝁</mi><mo stretchy="false" id="S3.p2.21.m8.3.3.1.1.3.2.2.2" xref="S3.p2.21.m8.3.3.1.1.3.2.1.1.cmml">‖</mo></mrow><mn id="S3.p2.21.m8.3.3.1.1.3.3" xref="S3.p2.21.m8.3.3.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S3.p2.21.m8.4.4.2.3" xref="S3.p2.21.m8.4.4.3a.cmml">,</mo><mrow id="S3.p2.21.m8.4.4.2.2" xref="S3.p2.21.m8.4.4.2.2.cmml"><msub id="S3.p2.21.m8.4.4.2.2.2" xref="S3.p2.21.m8.4.4.2.2.2.cmml"><mi id="S3.p2.21.m8.4.4.2.2.2.2" xref="S3.p2.21.m8.4.4.2.2.2.2.cmml">λ</mi><mi id="S3.p2.21.m8.4.4.2.2.2.3" xref="S3.p2.21.m8.4.4.2.2.2.3.cmml">i</mi></msub><mo id="S3.p2.21.m8.4.4.2.2.1" xref="S3.p2.21.m8.4.4.2.2.1.cmml">=</mo><mfrac id="S3.p2.21.m8.1.1" xref="S3.p2.21.m8.1.1.cmml"><msub id="S3.p2.21.m8.1.1.3" xref="S3.p2.21.m8.1.1.3.cmml"><mi id="S3.p2.21.m8.1.1.3.2" xref="S3.p2.21.m8.1.1.3.2.cmml">μ</mi><mi id="S3.p2.21.m8.1.1.3.3" xref="S3.p2.21.m8.1.1.3.3.cmml">i</mi></msub><msub id="S3.p2.21.m8.1.1.1" xref="S3.p2.21.m8.1.1.1.cmml"><mrow id="S3.p2.21.m8.1.1.1.3.2" xref="S3.p2.21.m8.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.p2.21.m8.1.1.1.3.2.1" xref="S3.p2.21.m8.1.1.1.3.1.1.cmml">‖</mo><mi id="S3.p2.21.m8.1.1.1.1" xref="S3.p2.21.m8.1.1.1.1.cmml">𝝁</mi><mo stretchy="false" id="S3.p2.21.m8.1.1.1.3.2.2" xref="S3.p2.21.m8.1.1.1.3.1.1.cmml">‖</mo></mrow><mn id="S3.p2.21.m8.1.1.1.4" xref="S3.p2.21.m8.1.1.1.4.cmml">1</mn></msub></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.21.m8.4b"><apply id="S3.p2.21.m8.4.4.3.cmml" xref="S3.p2.21.m8.4.4.2"><csymbol cd="ambiguous" id="S3.p2.21.m8.4.4.3a.cmml" xref="S3.p2.21.m8.4.4.2.3">formulae-sequence</csymbol><apply id="S3.p2.21.m8.3.3.1.1.cmml" xref="S3.p2.21.m8.3.3.1.1"><eq id="S3.p2.21.m8.3.3.1.1.1.cmml" xref="S3.p2.21.m8.3.3.1.1.1"></eq><ci id="S3.p2.21.m8.3.3.1.1.2.cmml" xref="S3.p2.21.m8.3.3.1.1.2">𝛾</ci><apply id="S3.p2.21.m8.3.3.1.1.3.cmml" xref="S3.p2.21.m8.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.p2.21.m8.3.3.1.1.3.1.cmml" xref="S3.p2.21.m8.3.3.1.1.3">subscript</csymbol><apply id="S3.p2.21.m8.3.3.1.1.3.2.1.cmml" xref="S3.p2.21.m8.3.3.1.1.3.2.2"><csymbol cd="latexml" id="S3.p2.21.m8.3.3.1.1.3.2.1.1.cmml" xref="S3.p2.21.m8.3.3.1.1.3.2.2.1">norm</csymbol><ci id="S3.p2.21.m8.2.2.cmml" xref="S3.p2.21.m8.2.2">𝝁</ci></apply><cn type="integer" id="S3.p2.21.m8.3.3.1.1.3.3.cmml" xref="S3.p2.21.m8.3.3.1.1.3.3">1</cn></apply></apply><apply id="S3.p2.21.m8.4.4.2.2.cmml" xref="S3.p2.21.m8.4.4.2.2"><eq id="S3.p2.21.m8.4.4.2.2.1.cmml" xref="S3.p2.21.m8.4.4.2.2.1"></eq><apply id="S3.p2.21.m8.4.4.2.2.2.cmml" xref="S3.p2.21.m8.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.p2.21.m8.4.4.2.2.2.1.cmml" xref="S3.p2.21.m8.4.4.2.2.2">subscript</csymbol><ci id="S3.p2.21.m8.4.4.2.2.2.2.cmml" xref="S3.p2.21.m8.4.4.2.2.2.2">𝜆</ci><ci id="S3.p2.21.m8.4.4.2.2.2.3.cmml" xref="S3.p2.21.m8.4.4.2.2.2.3">𝑖</ci></apply><apply id="S3.p2.21.m8.1.1.cmml" xref="S3.p2.21.m8.1.1"><divide id="S3.p2.21.m8.1.1.2.cmml" xref="S3.p2.21.m8.1.1"></divide><apply id="S3.p2.21.m8.1.1.3.cmml" xref="S3.p2.21.m8.1.1.3"><csymbol cd="ambiguous" id="S3.p2.21.m8.1.1.3.1.cmml" xref="S3.p2.21.m8.1.1.3">subscript</csymbol><ci id="S3.p2.21.m8.1.1.3.2.cmml" xref="S3.p2.21.m8.1.1.3.2">𝜇</ci><ci id="S3.p2.21.m8.1.1.3.3.cmml" xref="S3.p2.21.m8.1.1.3.3">𝑖</ci></apply><apply id="S3.p2.21.m8.1.1.1.cmml" xref="S3.p2.21.m8.1.1.1"><csymbol cd="ambiguous" id="S3.p2.21.m8.1.1.1.2.cmml" xref="S3.p2.21.m8.1.1.1">subscript</csymbol><apply id="S3.p2.21.m8.1.1.1.3.1.cmml" xref="S3.p2.21.m8.1.1.1.3.2"><csymbol cd="latexml" id="S3.p2.21.m8.1.1.1.3.1.1.cmml" xref="S3.p2.21.m8.1.1.1.3.2.1">norm</csymbol><ci id="S3.p2.21.m8.1.1.1.1.cmml" xref="S3.p2.21.m8.1.1.1.1">𝝁</ci></apply><cn type="integer" id="S3.p2.21.m8.1.1.1.4.cmml" xref="S3.p2.21.m8.1.1.1.4">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.21.m8.4c">\gamma=\|\boldsymbol{\mu}\|_{1},\lambda_{i}=\frac{\mu_{i}}{\|\boldsymbol{\mu}\|_{1}}</annotation></semantics></math>. Thus, <a href="#S3.E2" title="Equation 2 ‣ 3 Preliminary and Problem Setup ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Equation 2</span></a> can be reformulated into</p>
<table id="A4.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3.m1.2" class="ltx_Math" alttext="\displaystyle\mathbf{w}_{g}^{t+1}=\gamma\sum_{i=1}^{m}\lambda_{i}\textbf{w}_{i}^{t},\text{ s.t. }\gamma&gt;0,\lambda_{i}\geq 0,\|\boldsymbol{\lambda}\|_{1}=1." display="inline"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.2.1"><mrow id="S3.E3.m1.2.2.1.1.2" xref="S3.E3.m1.2.2.1.1.3.cmml"><mrow id="S3.E3.m1.2.2.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.cmml"><msubsup id="S3.E3.m1.2.2.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.2.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.2.2.2" xref="S3.E3.m1.2.2.1.1.1.1.2.2.2.cmml">𝐰</mi><mi id="S3.E3.m1.2.2.1.1.1.1.2.2.3" xref="S3.E3.m1.2.2.1.1.1.1.2.2.3.cmml">g</mi><mrow id="S3.E3.m1.2.2.1.1.1.1.2.3" xref="S3.E3.m1.2.2.1.1.1.1.2.3.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.2.3.2" xref="S3.E3.m1.2.2.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.E3.m1.2.2.1.1.1.1.2.3.1" xref="S3.E3.m1.2.2.1.1.1.1.2.3.1.cmml">+</mo><mn id="S3.E3.m1.2.2.1.1.1.1.2.3.3" xref="S3.E3.m1.2.2.1.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E3.m1.2.2.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.3.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.3.2" xref="S3.E3.m1.2.2.1.1.1.1.3.2.cmml">γ</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.1.1.3.1" xref="S3.E3.m1.2.2.1.1.1.1.3.1.cmml">​</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.3.3" xref="S3.E3.m1.2.2.1.1.1.1.3.3.cmml"><mstyle displaystyle="true" id="S3.E3.m1.2.2.1.1.1.1.3.3.1" xref="S3.E3.m1.2.2.1.1.1.1.3.3.1.cmml"><munderover id="S3.E3.m1.2.2.1.1.1.1.3.3.1a" xref="S3.E3.m1.2.2.1.1.1.1.3.3.1.cmml"><mo movablelimits="false" id="S3.E3.m1.2.2.1.1.1.1.3.3.1.2.2" xref="S3.E3.m1.2.2.1.1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.3.3.1.2.3" xref="S3.E3.m1.2.2.1.1.1.1.3.3.1.2.3.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.3.3.1.2.3.2" xref="S3.E3.m1.2.2.1.1.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="S3.E3.m1.2.2.1.1.1.1.3.3.1.2.3.1" xref="S3.E3.m1.2.2.1.1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.2.2.1.1.1.1.3.3.1.2.3.3" xref="S3.E3.m1.2.2.1.1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.2.2.1.1.1.1.3.3.1.3" xref="S3.E3.m1.2.2.1.1.1.1.3.3.1.3.cmml">m</mi></munderover></mstyle><mrow id="S3.E3.m1.2.2.1.1.1.1.3.3.2" xref="S3.E3.m1.2.2.1.1.1.1.3.3.2.cmml"><msub id="S3.E3.m1.2.2.1.1.1.1.3.3.2.2" xref="S3.E3.m1.2.2.1.1.1.1.3.3.2.2.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.3.3.2.2.2" xref="S3.E3.m1.2.2.1.1.1.1.3.3.2.2.2.cmml">λ</mi><mi id="S3.E3.m1.2.2.1.1.1.1.3.3.2.2.3" xref="S3.E3.m1.2.2.1.1.1.1.3.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.1.1.3.3.2.1" xref="S3.E3.m1.2.2.1.1.1.1.3.3.2.1.cmml">​</mo><msubsup id="S3.E3.m1.2.2.1.1.1.1.3.3.2.3" xref="S3.E3.m1.2.2.1.1.1.1.3.3.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E3.m1.2.2.1.1.1.1.3.3.2.3.2.2" xref="S3.E3.m1.2.2.1.1.1.1.3.3.2.3.2.2a.cmml">w</mtext><mi id="S3.E3.m1.2.2.1.1.1.1.3.3.2.3.2.3" xref="S3.E3.m1.2.2.1.1.1.1.3.3.2.3.2.3.cmml">i</mi><mi id="S3.E3.m1.2.2.1.1.1.1.3.3.2.3.3" xref="S3.E3.m1.2.2.1.1.1.1.3.3.2.3.3.cmml">t</mi></msubsup></mrow></mrow></mrow></mrow><mo id="S3.E3.m1.2.2.1.1.2.3" xref="S3.E3.m1.2.2.1.1.3a.cmml">,</mo><mrow id="S3.E3.m1.2.2.1.1.2.2.2" xref="S3.E3.m1.2.2.1.1.2.2.3.cmml"><mrow id="S3.E3.m1.2.2.1.1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.2.2.1.1.cmml"><mrow id="S3.E3.m1.2.2.1.1.2.2.1.1.2" xref="S3.E3.m1.2.2.1.1.2.2.1.1.2.cmml"><mtext id="S3.E3.m1.2.2.1.1.2.2.1.1.2.2" xref="S3.E3.m1.2.2.1.1.2.2.1.1.2.2a.cmml"> s.t. </mtext><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.2.2.1.1.2.1" xref="S3.E3.m1.2.2.1.1.2.2.1.1.2.1.cmml">​</mo><mi id="S3.E3.m1.2.2.1.1.2.2.1.1.2.3" xref="S3.E3.m1.2.2.1.1.2.2.1.1.2.3.cmml">γ</mi></mrow><mo id="S3.E3.m1.2.2.1.1.2.2.1.1.1" xref="S3.E3.m1.2.2.1.1.2.2.1.1.1.cmml">&gt;</mo><mn id="S3.E3.m1.2.2.1.1.2.2.1.1.3" xref="S3.E3.m1.2.2.1.1.2.2.1.1.3.cmml">0</mn></mrow><mo id="S3.E3.m1.2.2.1.1.2.2.2.3" xref="S3.E3.m1.2.2.1.1.2.2.3a.cmml">,</mo><mrow id="S3.E3.m1.2.2.1.1.2.2.2.2.2" xref="S3.E3.m1.2.2.1.1.2.2.2.2.3.cmml"><mrow id="S3.E3.m1.2.2.1.1.2.2.2.2.1.1" xref="S3.E3.m1.2.2.1.1.2.2.2.2.1.1.cmml"><msub id="S3.E3.m1.2.2.1.1.2.2.2.2.1.1.2" xref="S3.E3.m1.2.2.1.1.2.2.2.2.1.1.2.cmml"><mi id="S3.E3.m1.2.2.1.1.2.2.2.2.1.1.2.2" xref="S3.E3.m1.2.2.1.1.2.2.2.2.1.1.2.2.cmml">λ</mi><mi id="S3.E3.m1.2.2.1.1.2.2.2.2.1.1.2.3" xref="S3.E3.m1.2.2.1.1.2.2.2.2.1.1.2.3.cmml">i</mi></msub><mo id="S3.E3.m1.2.2.1.1.2.2.2.2.1.1.1" xref="S3.E3.m1.2.2.1.1.2.2.2.2.1.1.1.cmml">≥</mo><mn id="S3.E3.m1.2.2.1.1.2.2.2.2.1.1.3" xref="S3.E3.m1.2.2.1.1.2.2.2.2.1.1.3.cmml">0</mn></mrow><mo id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3" xref="S3.E3.m1.2.2.1.1.2.2.2.2.3a.cmml">,</mo><mrow id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.cmml"><msub id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.cmml"><mrow id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.2.2" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.2.1.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.1" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.2.1.1.cmml">‖</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">𝝀</mi><mo stretchy="false" id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.2.1.1.cmml">‖</mo></mrow><mn id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.3" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.3.cmml">1</mn></msub><mo id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.1" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.1.cmml">=</mo><mn id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.3" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.3.cmml">1</mn></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E3.m1.2.2.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.2.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.3a.cmml" xref="S3.E3.m1.2.2.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E3.m1.2.2.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1"><eq id="S3.E3.m1.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1"></eq><apply id="S3.E3.m1.2.2.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2">superscript</csymbol><apply id="S3.E3.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.2.2">𝐰</ci><ci id="S3.E3.m1.2.2.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.2.3">𝑔</ci></apply><apply id="S3.E3.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.3"><plus id="S3.E3.m1.2.2.1.1.1.1.2.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.3.1"></plus><ci id="S3.E3.m1.2.2.1.1.1.1.2.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S3.E3.m1.2.2.1.1.1.1.2.3.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E3.m1.2.2.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3"><times id="S3.E3.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.1"></times><ci id="S3.E3.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.2">𝛾</ci><apply id="S3.E3.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3"><apply id="S3.E3.m1.2.2.1.1.1.1.3.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.3.3.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3.1">superscript</csymbol><apply id="S3.E3.m1.2.2.1.1.1.1.3.3.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.3.3.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3.1">subscript</csymbol><sum id="S3.E3.m1.2.2.1.1.1.1.3.3.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3.1.2.2"></sum><apply id="S3.E3.m1.2.2.1.1.1.1.3.3.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3.1.2.3"><eq id="S3.E3.m1.2.2.1.1.1.1.3.3.1.2.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3.1.2.3.1"></eq><ci id="S3.E3.m1.2.2.1.1.1.1.3.3.1.2.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E3.m1.2.2.1.1.1.1.3.3.1.2.3.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.2.2.1.1.1.1.3.3.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3.1.3">𝑚</ci></apply><apply id="S3.E3.m1.2.2.1.1.1.1.3.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3.2"><times id="S3.E3.m1.2.2.1.1.1.1.3.3.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3.2.1"></times><apply id="S3.E3.m1.2.2.1.1.1.1.3.3.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.3.3.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3.2.2">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.3.3.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3.2.2.2">𝜆</ci><ci id="S3.E3.m1.2.2.1.1.1.1.3.3.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3.2.2.3">𝑖</ci></apply><apply id="S3.E3.m1.2.2.1.1.1.1.3.3.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.3.3.2.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3.2.3">superscript</csymbol><apply id="S3.E3.m1.2.2.1.1.1.1.3.3.2.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.3.3.2.3.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3.2.3">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.3.3.2.3.2.2a.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3.2.3.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E3.m1.2.2.1.1.1.1.3.3.2.3.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3.2.3.2.2">w</mtext></ci><ci id="S3.E3.m1.2.2.1.1.1.1.3.3.2.3.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3.2.3.2.3">𝑖</ci></apply><ci id="S3.E3.m1.2.2.1.1.1.1.3.3.2.3.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3.2.3.3">𝑡</ci></apply></apply></apply></apply></apply><apply id="S3.E3.m1.2.2.1.1.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.2.2.3a.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E3.m1.2.2.1.1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.1.1"><gt id="S3.E3.m1.2.2.1.1.2.2.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.1.1.1"></gt><apply id="S3.E3.m1.2.2.1.1.2.2.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.1.1.2"><times id="S3.E3.m1.2.2.1.1.2.2.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.1.1.2.1"></times><ci id="S3.E3.m1.2.2.1.1.2.2.1.1.2.2a.cmml" xref="S3.E3.m1.2.2.1.1.2.2.1.1.2.2"><mtext id="S3.E3.m1.2.2.1.1.2.2.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.1.1.2.2"> s.t. </mtext></ci><ci id="S3.E3.m1.2.2.1.1.2.2.1.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.2.2.1.1.2.3">𝛾</ci></apply><cn type="integer" id="S3.E3.m1.2.2.1.1.2.2.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.2.2.1.1.3">0</cn></apply><apply id="S3.E3.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.2.2.2.2.3a.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E3.m1.2.2.1.1.2.2.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.1.1"><geq id="S3.E3.m1.2.2.1.1.2.2.2.2.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.1.1.1"></geq><apply id="S3.E3.m1.2.2.1.1.2.2.2.2.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.2.2.2.2.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.1.1.2">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.2.2.2.2.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.1.1.2.2">𝜆</ci><ci id="S3.E3.m1.2.2.1.1.2.2.2.2.1.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S3.E3.m1.2.2.1.1.2.2.2.2.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.1.1.3">0</cn></apply><apply id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2"><eq id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.1"></eq><apply id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2">subscript</csymbol><apply id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.2.2"><csymbol cd="latexml" id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.1">norm</csymbol><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝝀</ci></apply><cn type="integer" id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.2.3">1</cn></apply><cn type="integer" id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">\displaystyle\mathbf{w}_{g}^{t+1}=\gamma\sum_{i=1}^{m}\lambda_{i}\textbf{w}_{i}^{t},\text{ s.t. }\gamma&gt;0,\lambda_{i}\geq 0,\|\boldsymbol{\lambda}\|_{1}=1.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.p2.24" class="ltx_p">Vanilla <span id="S3.p2.24.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> is a special case where <math id="S3.p2.22.m1.5" class="ltx_Math" alttext="\gamma=1,\lambda_{i}=\frac{|\mathcal{D}_{i}|}{|\mathcal{D}|},\forall i\in[m]" display="inline"><semantics id="S3.p2.22.m1.5a"><mrow id="S3.p2.22.m1.5.5.2" xref="S3.p2.22.m1.5.5.3.cmml"><mrow id="S3.p2.22.m1.4.4.1.1" xref="S3.p2.22.m1.4.4.1.1.cmml"><mi id="S3.p2.22.m1.4.4.1.1.2" xref="S3.p2.22.m1.4.4.1.1.2.cmml">γ</mi><mo id="S3.p2.22.m1.4.4.1.1.1" xref="S3.p2.22.m1.4.4.1.1.1.cmml">=</mo><mn id="S3.p2.22.m1.4.4.1.1.3" xref="S3.p2.22.m1.4.4.1.1.3.cmml">1</mn></mrow><mo id="S3.p2.22.m1.5.5.2.3" xref="S3.p2.22.m1.5.5.3a.cmml">,</mo><mrow id="S3.p2.22.m1.5.5.2.2.2" xref="S3.p2.22.m1.5.5.2.2.3.cmml"><mrow id="S3.p2.22.m1.5.5.2.2.1.1" xref="S3.p2.22.m1.5.5.2.2.1.1.cmml"><msub id="S3.p2.22.m1.5.5.2.2.1.1.2" xref="S3.p2.22.m1.5.5.2.2.1.1.2.cmml"><mi id="S3.p2.22.m1.5.5.2.2.1.1.2.2" xref="S3.p2.22.m1.5.5.2.2.1.1.2.2.cmml">λ</mi><mi id="S3.p2.22.m1.5.5.2.2.1.1.2.3" xref="S3.p2.22.m1.5.5.2.2.1.1.2.3.cmml">i</mi></msub><mo id="S3.p2.22.m1.5.5.2.2.1.1.1" xref="S3.p2.22.m1.5.5.2.2.1.1.1.cmml">=</mo><mfrac id="S3.p2.22.m1.2.2" xref="S3.p2.22.m1.2.2.cmml"><mrow id="S3.p2.22.m1.1.1.1.1" xref="S3.p2.22.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.p2.22.m1.1.1.1.1.2" xref="S3.p2.22.m1.1.1.1.2.1.cmml">|</mo><msub id="S3.p2.22.m1.1.1.1.1.1" xref="S3.p2.22.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.22.m1.1.1.1.1.1.2" xref="S3.p2.22.m1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.p2.22.m1.1.1.1.1.1.3" xref="S3.p2.22.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.p2.22.m1.1.1.1.1.3" xref="S3.p2.22.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S3.p2.22.m1.2.2.2.3" xref="S3.p2.22.m1.2.2.2.2.cmml"><mo stretchy="false" id="S3.p2.22.m1.2.2.2.3.1" xref="S3.p2.22.m1.2.2.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.22.m1.2.2.2.1" xref="S3.p2.22.m1.2.2.2.1.cmml">𝒟</mi><mo stretchy="false" id="S3.p2.22.m1.2.2.2.3.2" xref="S3.p2.22.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac></mrow><mo id="S3.p2.22.m1.5.5.2.2.2.3" xref="S3.p2.22.m1.5.5.2.2.3a.cmml">,</mo><mrow id="S3.p2.22.m1.5.5.2.2.2.2" xref="S3.p2.22.m1.5.5.2.2.2.2.cmml"><mrow id="S3.p2.22.m1.5.5.2.2.2.2.2" xref="S3.p2.22.m1.5.5.2.2.2.2.2.cmml"><mo rspace="0.167em" id="S3.p2.22.m1.5.5.2.2.2.2.2.1" xref="S3.p2.22.m1.5.5.2.2.2.2.2.1.cmml">∀</mo><mi id="S3.p2.22.m1.5.5.2.2.2.2.2.2" xref="S3.p2.22.m1.5.5.2.2.2.2.2.2.cmml">i</mi></mrow><mo id="S3.p2.22.m1.5.5.2.2.2.2.1" xref="S3.p2.22.m1.5.5.2.2.2.2.1.cmml">∈</mo><mrow id="S3.p2.22.m1.5.5.2.2.2.2.3.2" xref="S3.p2.22.m1.5.5.2.2.2.2.3.1.cmml"><mo stretchy="false" id="S3.p2.22.m1.5.5.2.2.2.2.3.2.1" xref="S3.p2.22.m1.5.5.2.2.2.2.3.1.1.cmml">[</mo><mi id="S3.p2.22.m1.3.3" xref="S3.p2.22.m1.3.3.cmml">m</mi><mo stretchy="false" id="S3.p2.22.m1.5.5.2.2.2.2.3.2.2" xref="S3.p2.22.m1.5.5.2.2.2.2.3.1.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.22.m1.5b"><apply id="S3.p2.22.m1.5.5.3.cmml" xref="S3.p2.22.m1.5.5.2"><csymbol cd="ambiguous" id="S3.p2.22.m1.5.5.3a.cmml" xref="S3.p2.22.m1.5.5.2.3">formulae-sequence</csymbol><apply id="S3.p2.22.m1.4.4.1.1.cmml" xref="S3.p2.22.m1.4.4.1.1"><eq id="S3.p2.22.m1.4.4.1.1.1.cmml" xref="S3.p2.22.m1.4.4.1.1.1"></eq><ci id="S3.p2.22.m1.4.4.1.1.2.cmml" xref="S3.p2.22.m1.4.4.1.1.2">𝛾</ci><cn type="integer" id="S3.p2.22.m1.4.4.1.1.3.cmml" xref="S3.p2.22.m1.4.4.1.1.3">1</cn></apply><apply id="S3.p2.22.m1.5.5.2.2.3.cmml" xref="S3.p2.22.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="S3.p2.22.m1.5.5.2.2.3a.cmml" xref="S3.p2.22.m1.5.5.2.2.2.3">formulae-sequence</csymbol><apply id="S3.p2.22.m1.5.5.2.2.1.1.cmml" xref="S3.p2.22.m1.5.5.2.2.1.1"><eq id="S3.p2.22.m1.5.5.2.2.1.1.1.cmml" xref="S3.p2.22.m1.5.5.2.2.1.1.1"></eq><apply id="S3.p2.22.m1.5.5.2.2.1.1.2.cmml" xref="S3.p2.22.m1.5.5.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.p2.22.m1.5.5.2.2.1.1.2.1.cmml" xref="S3.p2.22.m1.5.5.2.2.1.1.2">subscript</csymbol><ci id="S3.p2.22.m1.5.5.2.2.1.1.2.2.cmml" xref="S3.p2.22.m1.5.5.2.2.1.1.2.2">𝜆</ci><ci id="S3.p2.22.m1.5.5.2.2.1.1.2.3.cmml" xref="S3.p2.22.m1.5.5.2.2.1.1.2.3">𝑖</ci></apply><apply id="S3.p2.22.m1.2.2.cmml" xref="S3.p2.22.m1.2.2"><divide id="S3.p2.22.m1.2.2.3.cmml" xref="S3.p2.22.m1.2.2"></divide><apply id="S3.p2.22.m1.1.1.1.2.cmml" xref="S3.p2.22.m1.1.1.1.1"><abs id="S3.p2.22.m1.1.1.1.2.1.cmml" xref="S3.p2.22.m1.1.1.1.1.2"></abs><apply id="S3.p2.22.m1.1.1.1.1.1.cmml" xref="S3.p2.22.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.22.m1.1.1.1.1.1.1.cmml" xref="S3.p2.22.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.22.m1.1.1.1.1.1.2.cmml" xref="S3.p2.22.m1.1.1.1.1.1.2">𝒟</ci><ci id="S3.p2.22.m1.1.1.1.1.1.3.cmml" xref="S3.p2.22.m1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.p2.22.m1.2.2.2.2.cmml" xref="S3.p2.22.m1.2.2.2.3"><abs id="S3.p2.22.m1.2.2.2.2.1.cmml" xref="S3.p2.22.m1.2.2.2.3.1"></abs><ci id="S3.p2.22.m1.2.2.2.1.cmml" xref="S3.p2.22.m1.2.2.2.1">𝒟</ci></apply></apply></apply><apply id="S3.p2.22.m1.5.5.2.2.2.2.cmml" xref="S3.p2.22.m1.5.5.2.2.2.2"><in id="S3.p2.22.m1.5.5.2.2.2.2.1.cmml" xref="S3.p2.22.m1.5.5.2.2.2.2.1"></in><apply id="S3.p2.22.m1.5.5.2.2.2.2.2.cmml" xref="S3.p2.22.m1.5.5.2.2.2.2.2"><csymbol cd="latexml" id="S3.p2.22.m1.5.5.2.2.2.2.2.1.cmml" xref="S3.p2.22.m1.5.5.2.2.2.2.2.1">for-all</csymbol><ci id="S3.p2.22.m1.5.5.2.2.2.2.2.2.cmml" xref="S3.p2.22.m1.5.5.2.2.2.2.2.2">𝑖</ci></apply><apply id="S3.p2.22.m1.5.5.2.2.2.2.3.1.cmml" xref="S3.p2.22.m1.5.5.2.2.2.2.3.2"><csymbol cd="latexml" id="S3.p2.22.m1.5.5.2.2.2.2.3.1.1.cmml" xref="S3.p2.22.m1.5.5.2.2.2.2.3.2.1">delimited-[]</csymbol><ci id="S3.p2.22.m1.3.3.cmml" xref="S3.p2.22.m1.3.3">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.22.m1.5c">\gamma=1,\lambda_{i}=\frac{|\mathcal{D}_{i}|}{|\mathcal{D}|},\forall i\in[m]</annotation></semantics></math>. When <math id="S3.p2.23.m2.1" class="ltx_Math" alttext="\gamma&lt;1" display="inline"><semantics id="S3.p2.23.m2.1a"><mrow id="S3.p2.23.m2.1.1" xref="S3.p2.23.m2.1.1.cmml"><mi id="S3.p2.23.m2.1.1.2" xref="S3.p2.23.m2.1.1.2.cmml">γ</mi><mo id="S3.p2.23.m2.1.1.1" xref="S3.p2.23.m2.1.1.1.cmml">&lt;</mo><mn id="S3.p2.23.m2.1.1.3" xref="S3.p2.23.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.23.m2.1b"><apply id="S3.p2.23.m2.1.1.cmml" xref="S3.p2.23.m2.1.1"><lt id="S3.p2.23.m2.1.1.1.cmml" xref="S3.p2.23.m2.1.1.1"></lt><ci id="S3.p2.23.m2.1.1.2.cmml" xref="S3.p2.23.m2.1.1.2">𝛾</ci><cn type="integer" id="S3.p2.23.m2.1.1.3.cmml" xref="S3.p2.23.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.23.m2.1c">\gamma&lt;1</annotation></semantics></math>, it will cause weight shrinking of the global model, so in this case, we also call <math id="S3.p2.24.m3.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.p2.24.m3.1a"><mi id="S3.p2.24.m3.1.1" xref="S3.p2.24.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.p2.24.m3.1b"><ci id="S3.p2.24.m3.1.1.cmml" xref="S3.p2.24.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.24.m3.1c">\gamma</annotation></semantics></math> the shrinking factor.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.5" class="ltx_p"><span id="S3.p3.5.1" class="ltx_text ltx_font_bold">Clarification on the proxy dataset.</span> We study global weight shrinking<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>We use the word “shrink” instead of “decay” as it shrinks the global model rather than decaying the model by subtracting a decay term (used in traditional weight decay). Similar “shrink” can be found in <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib35" title="" class="ltx_ref">2020c</a>)</cite>.</span></span></span> (<math id="S3.p3.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.p3.1.m1.1a"><mi id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><ci id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">\gamma</annotation></semantics></math>) in <a href="#S4" title="4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 4</span></a> and client coherence (<math id="S3.p3.2.m2.1" class="ltx_Math" alttext="\boldsymbol{\lambda}" display="inline"><semantics id="S3.p3.2.m2.1a"><mi id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml">𝝀</mi><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><ci id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1">𝝀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">\boldsymbol{\lambda}</annotation></semantics></math>) in <a href="#S5" title="5 Client coherence ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 5</span></a> through respectively learning <math id="S3.p3.3.m3.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.p3.3.m3.1a"><mi id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><ci id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">\gamma</annotation></semantics></math> and <math id="S3.p3.4.m4.1" class="ltx_Math" alttext="\boldsymbol{\lambda}" display="inline"><semantics id="S3.p3.4.m4.1a"><mi id="S3.p3.4.m4.1.1" xref="S3.p3.4.m4.1.1.cmml">𝝀</mi><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.1b"><ci id="S3.p3.4.m4.1.1.cmml" xref="S3.p3.4.m4.1.1">𝝀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.1c">\boldsymbol{\lambda}</annotation></semantics></math> while fixing another on a server proxy dataset.
The considered proxy dataset has the same distribution as the global learning objective (i.e. a class-balanced case in this paper; e.g. 2000 balanced samples in CIFAR-10), thus the learned aggregation weights <math id="S3.p3.5.m5.2" class="ltx_Math" alttext="\{\gamma,\boldsymbol{\lambda}\}" display="inline"><semantics id="S3.p3.5.m5.2a"><mrow id="S3.p3.5.m5.2.3.2" xref="S3.p3.5.m5.2.3.1.cmml"><mo stretchy="false" id="S3.p3.5.m5.2.3.2.1" xref="S3.p3.5.m5.2.3.1.cmml">{</mo><mi id="S3.p3.5.m5.1.1" xref="S3.p3.5.m5.1.1.cmml">γ</mi><mo id="S3.p3.5.m5.2.3.2.2" xref="S3.p3.5.m5.2.3.1.cmml">,</mo><mi id="S3.p3.5.m5.2.2" xref="S3.p3.5.m5.2.2.cmml">𝝀</mi><mo stretchy="false" id="S3.p3.5.m5.2.3.2.3" xref="S3.p3.5.m5.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.5.m5.2b"><set id="S3.p3.5.m5.2.3.1.cmml" xref="S3.p3.5.m5.2.3.2"><ci id="S3.p3.5.m5.1.1.cmml" xref="S3.p3.5.m5.1.1">𝛾</ci><ci id="S3.p3.5.m5.2.2.cmml" xref="S3.p3.5.m5.2.2">𝝀</ci></set></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.5.m5.2c">\{\gamma,\boldsymbol{\lambda}\}</annotation></semantics></math> can reflect the contributions of clients and the optimal regularization factor towards this global objective. We note that this case of the proxy dataset is for understanding only, and we will validate the effectiveness and robustness of our proposed <span id="S3.p3.5.2" class="ltx_text ltx_font_smallcaps">FedLAW</span> on tiny (e.g. 100 samples in CIFAR-10) or biased (e.g. long-tailed) proxy datasets.
For concision, in <a href="#S4" title="4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 4</span></a> and <a href="#S5" title="5 Client coherence ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 5</span></a>, if not mentioned otherwise, we all use CIFAR-10 as the dataset and SimpleCNN as the model. Experiments on more datasets and models are shown in <a href="#S6" title="6 FedLAW ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 6</span></a> and Appendix.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Global Weight Shrinking</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Global Weight Shrinking and Its Impacts on Optimization</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.6" class="ltx_p">Setting <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="\gamma&lt;1" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">γ</mi><mo id="S4.SS1.p1.1.m1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.cmml">&lt;</mo><mn id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><lt id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1"></lt><ci id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">𝛾</ci><cn type="integer" id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\gamma&lt;1</annotation></semantics></math> results in the global weight shrinking regularization. <a href="#S4.T1" title="Table 1 ‣ 4.1 Global Weight Shrinking and Its Impacts on Optimization ‣ 4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 1</span></a> and <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 1</span></a> report the results on CIFAR-10 with different <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\gamma</annotation></semantics></math>.
It can be observed that the <em id="S4.SS1.p1.3.1" class="ltx_emph ltx_font_italic">global weight shrinking may improve generalization, depending on the choice of <math id="S4.SS1.p1.3.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS1.p1.3.1.m1.1a"><mi id="S4.SS1.p1.3.1.m1.1.1" xref="S4.SS1.p1.3.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.1.m1.1b"><ci id="S4.SS1.p1.3.1.m1.1.1.cmml" xref="S4.SS1.p1.3.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.1.m1.1c">\gamma</annotation></semantics></math>.</em> The smaller <math id="S4.SS1.p1.4.m3.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS1.p1.4.m3.1a"><mi id="S4.SS1.p1.4.m3.1.1" xref="S4.SS1.p1.4.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m3.1b"><ci id="S4.SS1.p1.4.m3.1.1.cmml" xref="S4.SS1.p1.4.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m3.1c">\gamma</annotation></semantics></math>, the stronger regularization effect. Given a setting, there exists an optimal <math id="S4.SS1.p1.5.m4.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS1.p1.5.m4.1a"><mi id="S4.SS1.p1.5.m4.1.1" xref="S4.SS1.p1.5.m4.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m4.1b"><ci id="S4.SS1.p1.5.m4.1.1.cmml" xref="S4.SS1.p1.5.m4.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m4.1c">\gamma</annotation></semantics></math> that balances the regularization and optimization, and deviation from this value, whether smaller or larger, may result in inferior performance.
More results about the fixed <math id="S4.SS1.p1.6.m5.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS1.p1.6.m5.1a"><mi id="S4.SS1.p1.6.m5.1.1" xref="S4.SS1.p1.6.m5.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m5.1b"><ci id="S4.SS1.p1.6.m5.1.1.cmml" xref="S4.SS1.p1.6.m5.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m5.1c">\gamma</annotation></semantics></math> can be found in <a href="#A2.T9" title="Table 9 ‣ B.1 Global Weight Shrinking ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 9</span></a> in Appendix.</p>
</div>
<figure id="S4.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2302.10911/assets/x2.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="221" height="179" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2302.10911/assets/x3.png" id="S4.F2.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="221" height="169" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span id="S4.F2.4.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Left:<span id="S4.F2.4.2.3" class="ltx_text ltx_font_medium"> Test accuracy gains of adaptive GWS. </span>Right:<span id="S4.F2.4.2.2" class="ltx_text ltx_font_medium"> The optimal <math id="S4.F2.3.1.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.F2.3.1.1.m1.1b"><mi id="S4.F2.3.1.1.m1.1.1" xref="S4.F2.3.1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.F2.3.1.1.m1.1c"><ci id="S4.F2.3.1.1.m1.1.1.cmml" xref="S4.F2.3.1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.3.1.1.m1.1d">\gamma</annotation></semantics></math> and the norm of global gradient. <math id="S4.F2.4.2.2.m2.2" class="ltx_Math" alttext="\alpha\in\{100,1\}" display="inline"><semantics id="S4.F2.4.2.2.m2.2b"><mrow id="S4.F2.4.2.2.m2.2.3" xref="S4.F2.4.2.2.m2.2.3.cmml"><mi id="S4.F2.4.2.2.m2.2.3.2" xref="S4.F2.4.2.2.m2.2.3.2.cmml">α</mi><mo id="S4.F2.4.2.2.m2.2.3.1" xref="S4.F2.4.2.2.m2.2.3.1.cmml">∈</mo><mrow id="S4.F2.4.2.2.m2.2.3.3.2" xref="S4.F2.4.2.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="S4.F2.4.2.2.m2.2.3.3.2.1" xref="S4.F2.4.2.2.m2.2.3.3.1.cmml">{</mo><mn id="S4.F2.4.2.2.m2.1.1" xref="S4.F2.4.2.2.m2.1.1.cmml">100</mn><mo id="S4.F2.4.2.2.m2.2.3.3.2.2" xref="S4.F2.4.2.2.m2.2.3.3.1.cmml">,</mo><mn id="S4.F2.4.2.2.m2.2.2" xref="S4.F2.4.2.2.m2.2.2.cmml">1</mn><mo stretchy="false" id="S4.F2.4.2.2.m2.2.3.3.2.3" xref="S4.F2.4.2.2.m2.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.4.2.2.m2.2c"><apply id="S4.F2.4.2.2.m2.2.3.cmml" xref="S4.F2.4.2.2.m2.2.3"><in id="S4.F2.4.2.2.m2.2.3.1.cmml" xref="S4.F2.4.2.2.m2.2.3.1"></in><ci id="S4.F2.4.2.2.m2.2.3.2.cmml" xref="S4.F2.4.2.2.m2.2.3.2">𝛼</ci><set id="S4.F2.4.2.2.m2.2.3.3.1.cmml" xref="S4.F2.4.2.2.m2.2.3.3.2"><cn type="integer" id="S4.F2.4.2.2.m2.1.1.cmml" xref="S4.F2.4.2.2.m2.1.1">100</cn><cn type="integer" id="S4.F2.4.2.2.m2.2.2.cmml" xref="S4.F2.4.2.2.m2.2.2">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.4.2.2.m2.2d">\alpha\in\{100,1\}</annotation></semantics></math>.</span></span></figcaption>
</figure>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span><span id="S4.T1.8.4" class="ltx_text" style="font-size:90%;">Impact of fixed <math id="S4.T1.5.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.T1.5.1.m1.1b"><mi id="S4.T1.5.1.m1.1.1" xref="S4.T1.5.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.T1.5.1.m1.1c"><ci id="S4.T1.5.1.m1.1.1.cmml" xref="S4.T1.5.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.1.m1.1d">\gamma</annotation></semantics></math> across different architectures in both IID (<math id="S4.T1.6.2.m2.1" class="ltx_Math" alttext="\alpha=100" display="inline"><semantics id="S4.T1.6.2.m2.1b"><mrow id="S4.T1.6.2.m2.1.1" xref="S4.T1.6.2.m2.1.1.cmml"><mi id="S4.T1.6.2.m2.1.1.2" xref="S4.T1.6.2.m2.1.1.2.cmml">α</mi><mo id="S4.T1.6.2.m2.1.1.1" xref="S4.T1.6.2.m2.1.1.1.cmml">=</mo><mn id="S4.T1.6.2.m2.1.1.3" xref="S4.T1.6.2.m2.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.6.2.m2.1c"><apply id="S4.T1.6.2.m2.1.1.cmml" xref="S4.T1.6.2.m2.1.1"><eq id="S4.T1.6.2.m2.1.1.1.cmml" xref="S4.T1.6.2.m2.1.1.1"></eq><ci id="S4.T1.6.2.m2.1.1.2.cmml" xref="S4.T1.6.2.m2.1.1.2">𝛼</ci><cn type="integer" id="S4.T1.6.2.m2.1.1.3.cmml" xref="S4.T1.6.2.m2.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.2.m2.1d">\alpha=100</annotation></semantics></math>) and NonIID (<math id="S4.T1.7.3.m3.1" class="ltx_Math" alttext="\alpha=1" display="inline"><semantics id="S4.T1.7.3.m3.1b"><mrow id="S4.T1.7.3.m3.1.1" xref="S4.T1.7.3.m3.1.1.cmml"><mi id="S4.T1.7.3.m3.1.1.2" xref="S4.T1.7.3.m3.1.1.2.cmml">α</mi><mo id="S4.T1.7.3.m3.1.1.1" xref="S4.T1.7.3.m3.1.1.1.cmml">=</mo><mn id="S4.T1.7.3.m3.1.1.3" xref="S4.T1.7.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.7.3.m3.1c"><apply id="S4.T1.7.3.m3.1.1.cmml" xref="S4.T1.7.3.m3.1.1"><eq id="S4.T1.7.3.m3.1.1.1.cmml" xref="S4.T1.7.3.m3.1.1.1"></eq><ci id="S4.T1.7.3.m3.1.1.2.cmml" xref="S4.T1.7.3.m3.1.1.2">𝛼</ci><cn type="integer" id="S4.T1.7.3.m3.1.1.3.cmml" xref="S4.T1.7.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.3.m3.1d">\alpha=1</annotation></semantics></math>) settings (<math id="S4.T1.8.4.m4.1" class="ltx_Math" alttext="E=2" display="inline"><semantics id="S4.T1.8.4.m4.1b"><mrow id="S4.T1.8.4.m4.1.1" xref="S4.T1.8.4.m4.1.1.cmml"><mi id="S4.T1.8.4.m4.1.1.2" xref="S4.T1.8.4.m4.1.1.2.cmml">E</mi><mo id="S4.T1.8.4.m4.1.1.1" xref="S4.T1.8.4.m4.1.1.1.cmml">=</mo><mn id="S4.T1.8.4.m4.1.1.3" xref="S4.T1.8.4.m4.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.8.4.m4.1c"><apply id="S4.T1.8.4.m4.1.1.cmml" xref="S4.T1.8.4.m4.1.1"><eq id="S4.T1.8.4.m4.1.1.1.cmml" xref="S4.T1.8.4.m4.1.1.1"></eq><ci id="S4.T1.8.4.m4.1.1.2.cmml" xref="S4.T1.8.4.m4.1.1.2">𝐸</ci><cn type="integer" id="S4.T1.8.4.m4.1.1.3.cmml" xref="S4.T1.8.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.4.m4.1d">E=2</annotation></semantics></math>).</span></figcaption>
<div id="S4.T1.9" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:208.1pt;height:82.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-55.0pt,21.8pt) scale(0.65411372722595,0.65411372722595) ;">
<table id="S4.T1.9.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.9.1.1" class="ltx_tr">
<th id="S4.T1.9.1.1.2" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt"></th>
<th id="S4.T1.9.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt"><math id="S4.T1.9.1.1.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.T1.9.1.1.1.m1.1a"><mi id="S4.T1.9.1.1.1.m1.1.1" xref="S4.T1.9.1.1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.T1.9.1.1.1.m1.1b"><ci id="S4.T1.9.1.1.1.m1.1.1.cmml" xref="S4.T1.9.1.1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.1.1.1.m1.1c">\gamma</annotation></semantics></math></th>
<th id="S4.T1.9.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">1.0</th>
<th id="S4.T1.9.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">0.99</th>
<th id="S4.T1.9.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">0.97</th>
<th id="S4.T1.9.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">0.95</th>
<th id="S4.T1.9.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">0.93</th>
<th id="S4.T1.9.1.1.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt">0.9</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.9.1.2.1" class="ltx_tr">
<th id="S4.T1.9.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" rowspan="3"><span id="S4.T1.9.1.2.1.1.1" class="ltx_text">IID</span></th>
<th id="S4.T1.9.1.2.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">SimpleCNN</th>
<td id="S4.T1.9.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">65.53</td>
<td id="S4.T1.9.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">67.60</td>
<td id="S4.T1.9.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">69.20</td>
<td id="S4.T1.9.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t">69.52</td>
<td id="S4.T1.9.1.2.1.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.9.1.2.1.7.1" class="ltx_text ltx_font_bold">70.16</span></td>
<td id="S4.T1.9.1.2.1.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">69.83</td>
</tr>
<tr id="S4.T1.9.1.3.2" class="ltx_tr">
<th id="S4.T1.9.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">AlexNet</th>
<td id="S4.T1.9.1.3.2.2" class="ltx_td ltx_align_center">74.16</td>
<td id="S4.T1.9.1.3.2.3" class="ltx_td ltx_align_center">74.80</td>
<td id="S4.T1.9.1.3.2.4" class="ltx_td ltx_align_center"><span id="S4.T1.9.1.3.2.4.1" class="ltx_text ltx_font_bold">75.54</span></td>
<td id="S4.T1.9.1.3.2.5" class="ltx_td ltx_align_center">75.24</td>
<td id="S4.T1.9.1.3.2.6" class="ltx_td ltx_align_center">75.25</td>
<td id="S4.T1.9.1.3.2.7" class="ltx_td ltx_nopad_r ltx_align_center">75.03</td>
</tr>
<tr id="S4.T1.9.1.4.3" class="ltx_tr">
<th id="S4.T1.9.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">ResNet8</th>
<td id="S4.T1.9.1.4.3.2" class="ltx_td ltx_align_center">75.51</td>
<td id="S4.T1.9.1.4.3.3" class="ltx_td ltx_align_center">76.64</td>
<td id="S4.T1.9.1.4.3.4" class="ltx_td ltx_align_center">76.80</td>
<td id="S4.T1.9.1.4.3.5" class="ltx_td ltx_align_center"><span id="S4.T1.9.1.4.3.5.1" class="ltx_text ltx_font_bold">77.87</span></td>
<td id="S4.T1.9.1.4.3.6" class="ltx_td ltx_align_center">76.80</td>
<td id="S4.T1.9.1.4.3.7" class="ltx_td ltx_nopad_r ltx_align_center">76.74</td>
</tr>
<tr id="S4.T1.9.1.5.4" class="ltx_tr">
<th id="S4.T1.9.1.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" rowspan="3"><span id="S4.T1.9.1.5.4.1.1" class="ltx_text">NonIID</span></th>
<th id="S4.T1.9.1.5.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">SimpleCNN</th>
<td id="S4.T1.9.1.5.4.3" class="ltx_td ltx_align_center ltx_border_t">65.58</td>
<td id="S4.T1.9.1.5.4.4" class="ltx_td ltx_align_center ltx_border_t">67.04</td>
<td id="S4.T1.9.1.5.4.5" class="ltx_td ltx_align_center ltx_border_t">68.36</td>
<td id="S4.T1.9.1.5.4.6" class="ltx_td ltx_align_center ltx_border_t">68.66</td>
<td id="S4.T1.9.1.5.4.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.9.1.5.4.7.1" class="ltx_text ltx_font_bold">69.28</span></td>
<td id="S4.T1.9.1.5.4.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">68.93</td>
</tr>
<tr id="S4.T1.9.1.6.5" class="ltx_tr">
<th id="S4.T1.9.1.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">AlexNet</th>
<td id="S4.T1.9.1.6.5.2" class="ltx_td ltx_align_center">73.56</td>
<td id="S4.T1.9.1.6.5.3" class="ltx_td ltx_align_center">73.83</td>
<td id="S4.T1.9.1.6.5.4" class="ltx_td ltx_align_center">74.37</td>
<td id="S4.T1.9.1.6.5.5" class="ltx_td ltx_align_center"><span id="S4.T1.9.1.6.5.5.1" class="ltx_text ltx_font_bold">74.45</span></td>
<td id="S4.T1.9.1.6.5.6" class="ltx_td ltx_align_center">74.40</td>
<td id="S4.T1.9.1.6.5.7" class="ltx_td ltx_nopad_r ltx_align_center">74.24</td>
</tr>
<tr id="S4.T1.9.1.7.6" class="ltx_tr">
<th id="S4.T1.9.1.7.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r">ResNet8</th>
<td id="S4.T1.9.1.7.6.2" class="ltx_td ltx_align_center ltx_border_bb">75.02</td>
<td id="S4.T1.9.1.7.6.3" class="ltx_td ltx_align_center ltx_border_bb">76.06</td>
<td id="S4.T1.9.1.7.6.4" class="ltx_td ltx_align_center ltx_border_bb">75.73</td>
<td id="S4.T1.9.1.7.6.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.9.1.7.6.5.1" class="ltx_text ltx_font_bold">77.00</span></td>
<td id="S4.T1.9.1.7.6.6" class="ltx_td ltx_align_center ltx_border_bb">75.04</td>
<td id="S4.T1.9.1.7.6.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb">75.31</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Adaptive Global Weight Shrinking and Training Dynamics</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">We discover how to set an appropriate <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\gamma</annotation></semantics></math> to balance regularization and optimization. We first expand the right of <a href="#S3.E2" title="Equation 2 ‣ 3 Preliminary and Problem Setup ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Equation 2</span></a> as follows.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.m1.1" class="ltx_Math" alttext="\mathbf{w}_{g}^{t+1}=\gamma(\mathbf{w}_{g}^{t}-\eta_{g}\textbf{g}_{g}^{t})=\mathbf{w}_{g}^{t}-\gamma\eta_{g}\textbf{g}_{g}^{t}-(1-\gamma)\mathbf{w}_{g}^{t}." display="block"><semantics id="S4.E4.m1.1a"><mrow id="S4.E4.m1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml"><mrow id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml"><msubsup id="S4.E4.m1.1.1.1.1.4" xref="S4.E4.m1.1.1.1.1.4.cmml"><mi mathsize="90%" id="S4.E4.m1.1.1.1.1.4.2.2" xref="S4.E4.m1.1.1.1.1.4.2.2.cmml">𝐰</mi><mi mathsize="90%" id="S4.E4.m1.1.1.1.1.4.2.3" xref="S4.E4.m1.1.1.1.1.4.2.3.cmml">g</mi><mrow id="S4.E4.m1.1.1.1.1.4.3" xref="S4.E4.m1.1.1.1.1.4.3.cmml"><mi mathsize="90%" id="S4.E4.m1.1.1.1.1.4.3.2" xref="S4.E4.m1.1.1.1.1.4.3.2.cmml">t</mi><mo mathsize="90%" id="S4.E4.m1.1.1.1.1.4.3.1" xref="S4.E4.m1.1.1.1.1.4.3.1.cmml">+</mo><mn mathsize="90%" id="S4.E4.m1.1.1.1.1.4.3.3" xref="S4.E4.m1.1.1.1.1.4.3.3.cmml">1</mn></mrow></msubsup><mo mathsize="90%" id="S4.E4.m1.1.1.1.1.5" xref="S4.E4.m1.1.1.1.1.5.cmml">=</mo><mrow id="S4.E4.m1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S4.E4.m1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.1.3.cmml">γ</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E4.m1.1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S4.E4.m1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E4.m1.1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2.cmml"><mi mathsize="90%" id="S4.E4.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐰</mi><mi mathsize="90%" id="S4.E4.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">g</mi><mi mathsize="90%" id="S4.E4.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo mathsize="90%" id="S4.E4.m1.1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.E4.m1.1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3.cmml"><msub id="S4.E4.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mi mathsize="90%" id="S4.E4.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">η</mi><mi mathsize="90%" id="S4.E4.m1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3.2.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.1.1.1.1.3.1" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><msubsup id="S4.E4.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mtext class="ltx_mathvariant_bold" mathsize="90%" id="S4.E4.m1.1.1.1.1.1.1.1.1.3.3.2.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3.3.2.2a.cmml">g</mtext><mi mathsize="90%" id="S4.E4.m1.1.1.1.1.1.1.1.1.3.3.2.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3.3.2.3.cmml">g</mi><mi mathsize="90%" id="S4.E4.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">t</mi></msubsup></mrow></mrow><mo maxsize="90%" minsize="90%" id="S4.E4.m1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S4.E4.m1.1.1.1.1.6" xref="S4.E4.m1.1.1.1.1.6.cmml">=</mo><mrow id="S4.E4.m1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.2.cmml"><msubsup id="S4.E4.m1.1.1.1.1.2.3" xref="S4.E4.m1.1.1.1.1.2.3.cmml"><mi mathsize="90%" id="S4.E4.m1.1.1.1.1.2.3.2.2" xref="S4.E4.m1.1.1.1.1.2.3.2.2.cmml">𝐰</mi><mi mathsize="90%" id="S4.E4.m1.1.1.1.1.2.3.2.3" xref="S4.E4.m1.1.1.1.1.2.3.2.3.cmml">g</mi><mi mathsize="90%" id="S4.E4.m1.1.1.1.1.2.3.3" xref="S4.E4.m1.1.1.1.1.2.3.3.cmml">t</mi></msubsup><mo mathsize="90%" id="S4.E4.m1.1.1.1.1.2.2" xref="S4.E4.m1.1.1.1.1.2.2.cmml">−</mo><mrow id="S4.E4.m1.1.1.1.1.2.4" xref="S4.E4.m1.1.1.1.1.2.4.cmml"><mi mathsize="90%" id="S4.E4.m1.1.1.1.1.2.4.2" xref="S4.E4.m1.1.1.1.1.2.4.2.cmml">γ</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.2.4.1" xref="S4.E4.m1.1.1.1.1.2.4.1.cmml">​</mo><msub id="S4.E4.m1.1.1.1.1.2.4.3" xref="S4.E4.m1.1.1.1.1.2.4.3.cmml"><mi mathsize="90%" id="S4.E4.m1.1.1.1.1.2.4.3.2" xref="S4.E4.m1.1.1.1.1.2.4.3.2.cmml">η</mi><mi mathsize="90%" id="S4.E4.m1.1.1.1.1.2.4.3.3" xref="S4.E4.m1.1.1.1.1.2.4.3.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.2.4.1a" xref="S4.E4.m1.1.1.1.1.2.4.1.cmml">​</mo><msubsup id="S4.E4.m1.1.1.1.1.2.4.4" xref="S4.E4.m1.1.1.1.1.2.4.4.cmml"><mtext class="ltx_mathvariant_bold" mathsize="90%" id="S4.E4.m1.1.1.1.1.2.4.4.2.2" xref="S4.E4.m1.1.1.1.1.2.4.4.2.2a.cmml">g</mtext><mi mathsize="90%" id="S4.E4.m1.1.1.1.1.2.4.4.2.3" xref="S4.E4.m1.1.1.1.1.2.4.4.2.3.cmml">g</mi><mi mathsize="90%" id="S4.E4.m1.1.1.1.1.2.4.4.3" xref="S4.E4.m1.1.1.1.1.2.4.4.3.cmml">t</mi></msubsup></mrow><mo mathsize="90%" id="S4.E4.m1.1.1.1.1.2.2a" xref="S4.E4.m1.1.1.1.1.2.2.cmml">−</mo><mrow id="S4.E4.m1.1.1.1.1.2.1" xref="S4.E4.m1.1.1.1.1.2.1.cmml"><mrow id="S4.E4.m1.1.1.1.1.2.1.1.1" xref="S4.E4.m1.1.1.1.1.2.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S4.E4.m1.1.1.1.1.2.1.1.1.2" xref="S4.E4.m1.1.1.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.1.1.1.1.2.1.1.1.1" xref="S4.E4.m1.1.1.1.1.2.1.1.1.1.cmml"><mn mathsize="90%" id="S4.E4.m1.1.1.1.1.2.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.2.1.1.1.1.2.cmml">1</mn><mo mathsize="90%" id="S4.E4.m1.1.1.1.1.2.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.cmml">−</mo><mi mathsize="90%" id="S4.E4.m1.1.1.1.1.2.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.2.1.1.1.1.3.cmml">γ</mi></mrow><mo maxsize="90%" minsize="90%" id="S4.E4.m1.1.1.1.1.2.1.1.1.3" xref="S4.E4.m1.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.2.1.2" xref="S4.E4.m1.1.1.1.1.2.1.2.cmml">​</mo><msubsup id="S4.E4.m1.1.1.1.1.2.1.3" xref="S4.E4.m1.1.1.1.1.2.1.3.cmml"><mi mathsize="90%" id="S4.E4.m1.1.1.1.1.2.1.3.2.2" xref="S4.E4.m1.1.1.1.1.2.1.3.2.2.cmml">𝐰</mi><mi mathsize="90%" id="S4.E4.m1.1.1.1.1.2.1.3.2.3" xref="S4.E4.m1.1.1.1.1.2.1.3.2.3.cmml">g</mi><mi mathsize="90%" id="S4.E4.m1.1.1.1.1.2.1.3.3" xref="S4.E4.m1.1.1.1.1.2.1.3.3.cmml">t</mi></msubsup></mrow></mrow></mrow><mo lspace="0em" mathsize="90%" id="S4.E4.m1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.1b"><apply id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1"><and id="S4.E4.m1.1.1.1.1a.cmml" xref="S4.E4.m1.1.1.1"></and><apply id="S4.E4.m1.1.1.1.1b.cmml" xref="S4.E4.m1.1.1.1"><eq id="S4.E4.m1.1.1.1.1.5.cmml" xref="S4.E4.m1.1.1.1.1.5"></eq><apply id="S4.E4.m1.1.1.1.1.4.cmml" xref="S4.E4.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.4.1.cmml" xref="S4.E4.m1.1.1.1.1.4">superscript</csymbol><apply id="S4.E4.m1.1.1.1.1.4.2.cmml" xref="S4.E4.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.4.2.1.cmml" xref="S4.E4.m1.1.1.1.1.4">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.4.2.2.cmml" xref="S4.E4.m1.1.1.1.1.4.2.2">𝐰</ci><ci id="S4.E4.m1.1.1.1.1.4.2.3.cmml" xref="S4.E4.m1.1.1.1.1.4.2.3">𝑔</ci></apply><apply id="S4.E4.m1.1.1.1.1.4.3.cmml" xref="S4.E4.m1.1.1.1.1.4.3"><plus id="S4.E4.m1.1.1.1.1.4.3.1.cmml" xref="S4.E4.m1.1.1.1.1.4.3.1"></plus><ci id="S4.E4.m1.1.1.1.1.4.3.2.cmml" xref="S4.E4.m1.1.1.1.1.4.3.2">𝑡</ci><cn type="integer" id="S4.E4.m1.1.1.1.1.4.3.3.cmml" xref="S4.E4.m1.1.1.1.1.4.3.3">1</cn></apply></apply><apply id="S4.E4.m1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1"><times id="S4.E4.m1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.1.2"></times><ci id="S4.E4.m1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.1.3">𝛾</ci><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1"><minus id="S4.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2.2.2">𝐰</ci><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2.2.3">𝑔</ci></apply><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3"><times id="S4.E4.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3.1"></times><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3.2.2">𝜂</ci><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3.2.3">𝑔</ci></apply><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3.3">superscript</csymbol><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.3.3.2.2a.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3.3.2.2"><mtext class="ltx_mathvariant_bold" mathsize="90%" id="S4.E4.m1.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3.3.2.2">g</mtext></ci><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3.3.2.3">𝑔</ci></apply><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3.3.3">𝑡</ci></apply></apply></apply></apply></apply><apply id="S4.E4.m1.1.1.1.1c.cmml" xref="S4.E4.m1.1.1.1"><eq id="S4.E4.m1.1.1.1.1.6.cmml" xref="S4.E4.m1.1.1.1.1.6"></eq><share href="#S4.E4.m1.1.1.1.1.1.cmml" id="S4.E4.m1.1.1.1.1d.cmml" xref="S4.E4.m1.1.1.1"></share><apply id="S4.E4.m1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.2"><minus id="S4.E4.m1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.1.1.1.1.2.2"></minus><apply id="S4.E4.m1.1.1.1.1.2.3.cmml" xref="S4.E4.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.2.3.1.cmml" xref="S4.E4.m1.1.1.1.1.2.3">superscript</csymbol><apply id="S4.E4.m1.1.1.1.1.2.3.2.cmml" xref="S4.E4.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.2.3.2.1.cmml" xref="S4.E4.m1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.2.3.2.2.cmml" xref="S4.E4.m1.1.1.1.1.2.3.2.2">𝐰</ci><ci id="S4.E4.m1.1.1.1.1.2.3.2.3.cmml" xref="S4.E4.m1.1.1.1.1.2.3.2.3">𝑔</ci></apply><ci id="S4.E4.m1.1.1.1.1.2.3.3.cmml" xref="S4.E4.m1.1.1.1.1.2.3.3">𝑡</ci></apply><apply id="S4.E4.m1.1.1.1.1.2.4.cmml" xref="S4.E4.m1.1.1.1.1.2.4"><times id="S4.E4.m1.1.1.1.1.2.4.1.cmml" xref="S4.E4.m1.1.1.1.1.2.4.1"></times><ci id="S4.E4.m1.1.1.1.1.2.4.2.cmml" xref="S4.E4.m1.1.1.1.1.2.4.2">𝛾</ci><apply id="S4.E4.m1.1.1.1.1.2.4.3.cmml" xref="S4.E4.m1.1.1.1.1.2.4.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.2.4.3.1.cmml" xref="S4.E4.m1.1.1.1.1.2.4.3">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.2.4.3.2.cmml" xref="S4.E4.m1.1.1.1.1.2.4.3.2">𝜂</ci><ci id="S4.E4.m1.1.1.1.1.2.4.3.3.cmml" xref="S4.E4.m1.1.1.1.1.2.4.3.3">𝑔</ci></apply><apply id="S4.E4.m1.1.1.1.1.2.4.4.cmml" xref="S4.E4.m1.1.1.1.1.2.4.4"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.2.4.4.1.cmml" xref="S4.E4.m1.1.1.1.1.2.4.4">superscript</csymbol><apply id="S4.E4.m1.1.1.1.1.2.4.4.2.cmml" xref="S4.E4.m1.1.1.1.1.2.4.4"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.2.4.4.2.1.cmml" xref="S4.E4.m1.1.1.1.1.2.4.4">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.2.4.4.2.2a.cmml" xref="S4.E4.m1.1.1.1.1.2.4.4.2.2"><mtext class="ltx_mathvariant_bold" mathsize="90%" id="S4.E4.m1.1.1.1.1.2.4.4.2.2.cmml" xref="S4.E4.m1.1.1.1.1.2.4.4.2.2">g</mtext></ci><ci id="S4.E4.m1.1.1.1.1.2.4.4.2.3.cmml" xref="S4.E4.m1.1.1.1.1.2.4.4.2.3">𝑔</ci></apply><ci id="S4.E4.m1.1.1.1.1.2.4.4.3.cmml" xref="S4.E4.m1.1.1.1.1.2.4.4.3">𝑡</ci></apply></apply><apply id="S4.E4.m1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.1.1.1.1.2.1"><times id="S4.E4.m1.1.1.1.1.2.1.2.cmml" xref="S4.E4.m1.1.1.1.1.2.1.2"></times><apply id="S4.E4.m1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.2.1.1.1"><minus id="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.2.1.1.1.1.1"></minus><cn type="integer" id="S4.E4.m1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.2.1.1.1.1.2">1</cn><ci id="S4.E4.m1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.2.1.1.1.1.3">𝛾</ci></apply><apply id="S4.E4.m1.1.1.1.1.2.1.3.cmml" xref="S4.E4.m1.1.1.1.1.2.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.2.1.3.1.cmml" xref="S4.E4.m1.1.1.1.1.2.1.3">superscript</csymbol><apply id="S4.E4.m1.1.1.1.1.2.1.3.2.cmml" xref="S4.E4.m1.1.1.1.1.2.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.2.1.3.2.1.cmml" xref="S4.E4.m1.1.1.1.1.2.1.3">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.2.1.3.2.2.cmml" xref="S4.E4.m1.1.1.1.1.2.1.3.2.2">𝐰</ci><ci id="S4.E4.m1.1.1.1.1.2.1.3.2.3.cmml" xref="S4.E4.m1.1.1.1.1.2.1.3.2.3">𝑔</ci></apply><ci id="S4.E4.m1.1.1.1.1.2.1.3.3.cmml" xref="S4.E4.m1.1.1.1.1.2.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.1c">\mathbf{w}_{g}^{t+1}=\gamma(\mathbf{w}_{g}^{t}-\eta_{g}\textbf{g}_{g}^{t})=\mathbf{w}_{g}^{t}-\gamma\eta_{g}\textbf{g}_{g}^{t}-(1-\gamma)\mathbf{w}_{g}^{t}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p2.6" class="ltx_p">We refer <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="(1-\gamma)\mathbf{w}_{g}^{t}" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mrow id="S4.SS2.p2.1.m1.1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p2.1.m1.1.1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p2.1.m1.1.1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.1.1.cmml"><mn id="S4.SS2.p2.1.m1.1.1.1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.SS2.p2.1.m1.1.1.1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.cmml">−</mo><mi id="S4.SS2.p2.1.m1.1.1.1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.1.1.1.3.cmml">γ</mi></mrow><mo stretchy="false" id="S4.SS2.p2.1.m1.1.1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">​</mo><msubsup id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml"><mi id="S4.SS2.p2.1.m1.1.1.3.2.2" xref="S4.SS2.p2.1.m1.1.1.3.2.2.cmml">𝐰</mi><mi id="S4.SS2.p2.1.m1.1.1.3.2.3" xref="S4.SS2.p2.1.m1.1.1.3.2.3.cmml">g</mi><mi id="S4.SS2.p2.1.m1.1.1.3.3" xref="S4.SS2.p2.1.m1.1.1.3.3.cmml">t</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><times id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2"></times><apply id="S4.SS2.p2.1.m1.1.1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1"><minus id="S4.SS2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1"></minus><cn type="integer" id="S4.SS2.p2.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.2">1</cn><ci id="S4.SS2.p2.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.3">𝛾</ci></apply><apply id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.3.1.cmml" xref="S4.SS2.p2.1.m1.1.1.3">superscript</csymbol><apply id="S4.SS2.p2.1.m1.1.1.3.2.cmml" xref="S4.SS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.3.2.1.cmml" xref="S4.SS2.p2.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.3.2.2.cmml" xref="S4.SS2.p2.1.m1.1.1.3.2.2">𝐰</ci><ci id="S4.SS2.p2.1.m1.1.1.3.2.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3.2.3">𝑔</ci></apply><ci id="S4.SS2.p2.1.m1.1.1.3.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">(1-\gamma)\mathbf{w}_{g}^{t}</annotation></semantics></math> as the pseudo gradient of global weight shrinking (<span id="S4.SS2.p2.6.1" class="ltx_text ltx_font_italic">regularization term</span>) and <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="\gamma\eta_{g}\textbf{g}_{g}^{t}" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mrow id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mi id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">γ</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.cmml">​</mo><msub id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml"><mi id="S4.SS2.p2.2.m2.1.1.3.2" xref="S4.SS2.p2.2.m2.1.1.3.2.cmml">η</mi><mi id="S4.SS2.p2.2.m2.1.1.3.3" xref="S4.SS2.p2.2.m2.1.1.3.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.1.1a" xref="S4.SS2.p2.2.m2.1.1.1.cmml">​</mo><msubsup id="S4.SS2.p2.2.m2.1.1.4" xref="S4.SS2.p2.2.m2.1.1.4.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS2.p2.2.m2.1.1.4.2.2" xref="S4.SS2.p2.2.m2.1.1.4.2.2a.cmml">g</mtext><mi id="S4.SS2.p2.2.m2.1.1.4.2.3" xref="S4.SS2.p2.2.m2.1.1.4.2.3.cmml">g</mi><mi id="S4.SS2.p2.2.m2.1.1.4.3" xref="S4.SS2.p2.2.m2.1.1.4.3.cmml">t</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><times id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1"></times><ci id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">𝛾</ci><apply id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.3.1.cmml" xref="S4.SS2.p2.2.m2.1.1.3">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.3.2.cmml" xref="S4.SS2.p2.2.m2.1.1.3.2">𝜂</ci><ci id="S4.SS2.p2.2.m2.1.1.3.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3">𝑔</ci></apply><apply id="S4.SS2.p2.2.m2.1.1.4.cmml" xref="S4.SS2.p2.2.m2.1.1.4"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.4.1.cmml" xref="S4.SS2.p2.2.m2.1.1.4">superscript</csymbol><apply id="S4.SS2.p2.2.m2.1.1.4.2.cmml" xref="S4.SS2.p2.2.m2.1.1.4"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.4.2.1.cmml" xref="S4.SS2.p2.2.m2.1.1.4">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.4.2.2a.cmml" xref="S4.SS2.p2.2.m2.1.1.4.2.2"><mtext class="ltx_mathvariant_bold" id="S4.SS2.p2.2.m2.1.1.4.2.2.cmml" xref="S4.SS2.p2.2.m2.1.1.4.2.2">g</mtext></ci><ci id="S4.SS2.p2.2.m2.1.1.4.2.3.cmml" xref="S4.SS2.p2.2.m2.1.1.4.2.3">𝑔</ci></apply><ci id="S4.SS2.p2.2.m2.1.1.4.3.cmml" xref="S4.SS2.p2.2.m2.1.1.4.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">\gamma\eta_{g}\textbf{g}_{g}^{t}</annotation></semantics></math> is the global averaged gradient (<span id="S4.SS2.p2.6.2" class="ltx_text ltx_font_italic">optimization term</span>). We reckon that a larger optimization term requires a larger regularization term, which means the magnitude of the global pseudo gradient <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="\textbf{g}_{g}^{t}" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><msubsup id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS2.p2.3.m3.1.1.2.2" xref="S4.SS2.p2.3.m3.1.1.2.2a.cmml">g</mtext><mi id="S4.SS2.p2.3.m3.1.1.2.3" xref="S4.SS2.p2.3.m3.1.1.2.3.cmml">g</mi><mi id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">superscript</csymbol><apply id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.2.1.cmml" xref="S4.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.2.2a.cmml" xref="S4.SS2.p2.3.m3.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S4.SS2.p2.3.m3.1.1.2.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2.2">g</mtext></ci><ci id="S4.SS2.p2.3.m3.1.1.2.3.cmml" xref="S4.SS2.p2.3.m3.1.1.2.3">𝑔</ci></apply><ci id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">\textbf{g}_{g}^{t}</annotation></semantics></math> determines the optimal shrinking factor <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><mi id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><ci id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">\gamma</annotation></semantics></math> in the way that larger <math id="S4.SS2.p2.5.m5.1" class="ltx_Math" alttext="\textbf{g}_{g}^{t}" display="inline"><semantics id="S4.SS2.p2.5.m5.1a"><msubsup id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS2.p2.5.m5.1.1.2.2" xref="S4.SS2.p2.5.m5.1.1.2.2a.cmml">g</mtext><mi id="S4.SS2.p2.5.m5.1.1.2.3" xref="S4.SS2.p2.5.m5.1.1.2.3.cmml">g</mi><mi id="S4.SS2.p2.5.m5.1.1.3" xref="S4.SS2.p2.5.m5.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><apply id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1">superscript</csymbol><apply id="S4.SS2.p2.5.m5.1.1.2.cmml" xref="S4.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.1.1.2.1.cmml" xref="S4.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.p2.5.m5.1.1.2.2a.cmml" xref="S4.SS2.p2.5.m5.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S4.SS2.p2.5.m5.1.1.2.2.cmml" xref="S4.SS2.p2.5.m5.1.1.2.2">g</mtext></ci><ci id="S4.SS2.p2.5.m5.1.1.2.3.cmml" xref="S4.SS2.p2.5.m5.1.1.2.3">𝑔</ci></apply><ci id="S4.SS2.p2.5.m5.1.1.3.cmml" xref="S4.SS2.p2.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">\textbf{g}_{g}^{t}</annotation></semantics></math>, smaller <math id="S4.SS2.p2.6.m6.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS2.p2.6.m6.1a"><mi id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><ci id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">\gamma</annotation></semantics></math> (stronger regularization).</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.2" class="ltx_p">To verify our hypothesis, we achieve adaptive global weight shrinking (adaptive GWS) on the proxy dataset, which learns an optimal <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><mi id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><ci id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">\gamma</annotation></semantics></math>. Adaptive GWS adopts the update in <a href="#S3.E3" title="Equation 3 ‣ 3 Preliminary and Problem Setup ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Equation 3</span></a> and uses <math id="S4.SS2.p3.2.m2.3" class="ltx_Math" alttext="\{\gamma=\gamma^{*},\lambda_{i}=\frac{|\mathcal{D}_{i}|}{|\mathcal{D}|}\}" display="inline"><semantics id="S4.SS2.p3.2.m2.3a"><mrow id="S4.SS2.p3.2.m2.3.3.1" xref="S4.SS2.p3.2.m2.3.3.2.cmml"><mo stretchy="false" id="S4.SS2.p3.2.m2.3.3.1.2" xref="S4.SS2.p3.2.m2.3.3.2.cmml">{</mo><mrow id="S4.SS2.p3.2.m2.3.3.1.1.2" xref="S4.SS2.p3.2.m2.3.3.1.1.3.cmml"><mrow id="S4.SS2.p3.2.m2.3.3.1.1.1.1" xref="S4.SS2.p3.2.m2.3.3.1.1.1.1.cmml"><mi id="S4.SS2.p3.2.m2.3.3.1.1.1.1.2" xref="S4.SS2.p3.2.m2.3.3.1.1.1.1.2.cmml">γ</mi><mo id="S4.SS2.p3.2.m2.3.3.1.1.1.1.1" xref="S4.SS2.p3.2.m2.3.3.1.1.1.1.1.cmml">=</mo><msup id="S4.SS2.p3.2.m2.3.3.1.1.1.1.3" xref="S4.SS2.p3.2.m2.3.3.1.1.1.1.3.cmml"><mi id="S4.SS2.p3.2.m2.3.3.1.1.1.1.3.2" xref="S4.SS2.p3.2.m2.3.3.1.1.1.1.3.2.cmml">γ</mi><mo id="S4.SS2.p3.2.m2.3.3.1.1.1.1.3.3" xref="S4.SS2.p3.2.m2.3.3.1.1.1.1.3.3.cmml">∗</mo></msup></mrow><mo id="S4.SS2.p3.2.m2.3.3.1.1.2.3" xref="S4.SS2.p3.2.m2.3.3.1.1.3a.cmml">,</mo><mrow id="S4.SS2.p3.2.m2.3.3.1.1.2.2" xref="S4.SS2.p3.2.m2.3.3.1.1.2.2.cmml"><msub id="S4.SS2.p3.2.m2.3.3.1.1.2.2.2" xref="S4.SS2.p3.2.m2.3.3.1.1.2.2.2.cmml"><mi id="S4.SS2.p3.2.m2.3.3.1.1.2.2.2.2" xref="S4.SS2.p3.2.m2.3.3.1.1.2.2.2.2.cmml">λ</mi><mi id="S4.SS2.p3.2.m2.3.3.1.1.2.2.2.3" xref="S4.SS2.p3.2.m2.3.3.1.1.2.2.2.3.cmml">i</mi></msub><mo id="S4.SS2.p3.2.m2.3.3.1.1.2.2.1" xref="S4.SS2.p3.2.m2.3.3.1.1.2.2.1.cmml">=</mo><mfrac id="S4.SS2.p3.2.m2.2.2" xref="S4.SS2.p3.2.m2.2.2.cmml"><mrow id="S4.SS2.p3.2.m2.1.1.1.1" xref="S4.SS2.p3.2.m2.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p3.2.m2.1.1.1.1.2" xref="S4.SS2.p3.2.m2.1.1.1.2.1.cmml">|</mo><msub id="S4.SS2.p3.2.m2.1.1.1.1.1" xref="S4.SS2.p3.2.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.2.m2.1.1.1.1.1.2" xref="S4.SS2.p3.2.m2.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S4.SS2.p3.2.m2.1.1.1.1.1.3" xref="S4.SS2.p3.2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.SS2.p3.2.m2.1.1.1.1.3" xref="S4.SS2.p3.2.m2.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S4.SS2.p3.2.m2.2.2.2.3" xref="S4.SS2.p3.2.m2.2.2.2.2.cmml"><mo stretchy="false" id="S4.SS2.p3.2.m2.2.2.2.3.1" xref="S4.SS2.p3.2.m2.2.2.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.2.m2.2.2.2.1" xref="S4.SS2.p3.2.m2.2.2.2.1.cmml">𝒟</mi><mo stretchy="false" id="S4.SS2.p3.2.m2.2.2.2.3.2" xref="S4.SS2.p3.2.m2.2.2.2.2.1.cmml">|</mo></mrow></mfrac></mrow></mrow><mo stretchy="false" id="S4.SS2.p3.2.m2.3.3.1.3" xref="S4.SS2.p3.2.m2.3.3.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.3b"><set id="S4.SS2.p3.2.m2.3.3.2.cmml" xref="S4.SS2.p3.2.m2.3.3.1"><apply id="S4.SS2.p3.2.m2.3.3.1.1.3.cmml" xref="S4.SS2.p3.2.m2.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.3.3.1.1.3a.cmml" xref="S4.SS2.p3.2.m2.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S4.SS2.p3.2.m2.3.3.1.1.1.1.cmml" xref="S4.SS2.p3.2.m2.3.3.1.1.1.1"><eq id="S4.SS2.p3.2.m2.3.3.1.1.1.1.1.cmml" xref="S4.SS2.p3.2.m2.3.3.1.1.1.1.1"></eq><ci id="S4.SS2.p3.2.m2.3.3.1.1.1.1.2.cmml" xref="S4.SS2.p3.2.m2.3.3.1.1.1.1.2">𝛾</ci><apply id="S4.SS2.p3.2.m2.3.3.1.1.1.1.3.cmml" xref="S4.SS2.p3.2.m2.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.3.3.1.1.1.1.3.1.cmml" xref="S4.SS2.p3.2.m2.3.3.1.1.1.1.3">superscript</csymbol><ci id="S4.SS2.p3.2.m2.3.3.1.1.1.1.3.2.cmml" xref="S4.SS2.p3.2.m2.3.3.1.1.1.1.3.2">𝛾</ci><times id="S4.SS2.p3.2.m2.3.3.1.1.1.1.3.3.cmml" xref="S4.SS2.p3.2.m2.3.3.1.1.1.1.3.3"></times></apply></apply><apply id="S4.SS2.p3.2.m2.3.3.1.1.2.2.cmml" xref="S4.SS2.p3.2.m2.3.3.1.1.2.2"><eq id="S4.SS2.p3.2.m2.3.3.1.1.2.2.1.cmml" xref="S4.SS2.p3.2.m2.3.3.1.1.2.2.1"></eq><apply id="S4.SS2.p3.2.m2.3.3.1.1.2.2.2.cmml" xref="S4.SS2.p3.2.m2.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.3.3.1.1.2.2.2.1.cmml" xref="S4.SS2.p3.2.m2.3.3.1.1.2.2.2">subscript</csymbol><ci id="S4.SS2.p3.2.m2.3.3.1.1.2.2.2.2.cmml" xref="S4.SS2.p3.2.m2.3.3.1.1.2.2.2.2">𝜆</ci><ci id="S4.SS2.p3.2.m2.3.3.1.1.2.2.2.3.cmml" xref="S4.SS2.p3.2.m2.3.3.1.1.2.2.2.3">𝑖</ci></apply><apply id="S4.SS2.p3.2.m2.2.2.cmml" xref="S4.SS2.p3.2.m2.2.2"><divide id="S4.SS2.p3.2.m2.2.2.3.cmml" xref="S4.SS2.p3.2.m2.2.2"></divide><apply id="S4.SS2.p3.2.m2.1.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.1.1"><abs id="S4.SS2.p3.2.m2.1.1.1.2.1.cmml" xref="S4.SS2.p3.2.m2.1.1.1.1.2"></abs><apply id="S4.SS2.p3.2.m2.1.1.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p3.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.1.1.1.2">𝒟</ci><ci id="S4.SS2.p3.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS2.p3.2.m2.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S4.SS2.p3.2.m2.2.2.2.2.cmml" xref="S4.SS2.p3.2.m2.2.2.2.3"><abs id="S4.SS2.p3.2.m2.2.2.2.2.1.cmml" xref="S4.SS2.p3.2.m2.2.2.2.3.1"></abs><ci id="S4.SS2.p3.2.m2.2.2.2.1.cmml" xref="S4.SS2.p3.2.m2.2.2.2.1">𝒟</ci></apply></apply></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.3c">\{\gamma=\gamma^{*},\lambda_{i}=\frac{|\mathcal{D}_{i}|}{|\mathcal{D}|}\}</annotation></semantics></math> where</p>
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.3" class="ltx_Math" alttext="\gamma^{*}=\mathop{\arg\min}\limits_{\gamma}\mathcal{L}_{proxy}(\gamma\cdot\sum_{i=1}^{m}\frac{|\mathcal{D}_{i}|}{|\mathcal{D}|}\textbf{w}_{i}^{t}),\text{ s.t. }\gamma&gt;0." display="block"><semantics id="S4.E5.m1.3a"><mrow id="S4.E5.m1.3.3.1"><mrow id="S4.E5.m1.3.3.1.1.2" xref="S4.E5.m1.3.3.1.1.3.cmml"><mrow id="S4.E5.m1.3.3.1.1.1.1" xref="S4.E5.m1.3.3.1.1.1.1.cmml"><msup id="S4.E5.m1.3.3.1.1.1.1.3" xref="S4.E5.m1.3.3.1.1.1.1.3.cmml"><mi id="S4.E5.m1.3.3.1.1.1.1.3.2" xref="S4.E5.m1.3.3.1.1.1.1.3.2.cmml">γ</mi><mo id="S4.E5.m1.3.3.1.1.1.1.3.3" xref="S4.E5.m1.3.3.1.1.1.1.3.3.cmml">∗</mo></msup><mo id="S4.E5.m1.3.3.1.1.1.1.2" xref="S4.E5.m1.3.3.1.1.1.1.2.cmml">=</mo><mrow id="S4.E5.m1.3.3.1.1.1.1.1" xref="S4.E5.m1.3.3.1.1.1.1.1.cmml"><munder id="S4.E5.m1.3.3.1.1.1.1.1.2" xref="S4.E5.m1.3.3.1.1.1.1.1.2.cmml"><mrow id="S4.E5.m1.3.3.1.1.1.1.1.2.2" xref="S4.E5.m1.3.3.1.1.1.1.1.2.2.cmml"><mi id="S4.E5.m1.3.3.1.1.1.1.1.2.2.1" xref="S4.E5.m1.3.3.1.1.1.1.1.2.2.1.cmml">arg</mi><mo lspace="0.167em" id="S4.E5.m1.3.3.1.1.1.1.1.2.2a" xref="S4.E5.m1.3.3.1.1.1.1.1.2.2.cmml">⁡</mo><mi id="S4.E5.m1.3.3.1.1.1.1.1.2.2.2" xref="S4.E5.m1.3.3.1.1.1.1.1.2.2.2.cmml">min</mi></mrow><mi id="S4.E5.m1.3.3.1.1.1.1.1.2.3" xref="S4.E5.m1.3.3.1.1.1.1.1.2.3.cmml">γ</mi></munder><mrow id="S4.E5.m1.3.3.1.1.1.1.1.1" xref="S4.E5.m1.3.3.1.1.1.1.1.1.cmml"><msub id="S4.E5.m1.3.3.1.1.1.1.1.1.3" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.3.3.1.1.1.1.1.1.3.2" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.2.cmml">ℒ</mi><mrow id="S4.E5.m1.3.3.1.1.1.1.1.1.3.3" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.2" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.1" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.3" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.1a" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.4" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.1b" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.5" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.5.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.1c" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.6" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.6.cmml">y</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.3.3.1.1.1.1.1.1.2" xref="S4.E5.m1.3.3.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">γ</mi><mo lspace="0.222em" rspace="0.055em" id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">⋅</mo><mrow id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml"><munderover id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.2.2" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.2.3" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.2.3.cmml"><mi id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.2.3.2" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.2.3.2.cmml">i</mi><mo id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.2.3.1" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.2.3.3" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.3" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.3.cmml">m</mi></munderover><mrow id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml"><mfrac id="S4.E5.m1.2.2" xref="S4.E5.m1.2.2.cmml"><mrow id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E5.m1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.2.1.cmml">|</mo><msub id="S4.E5.m1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S4.E5.m1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E5.m1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S4.E5.m1.2.2.2.3" xref="S4.E5.m1.2.2.2.2.cmml"><mo stretchy="false" id="S4.E5.m1.2.2.2.3.1" xref="S4.E5.m1.2.2.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.2.2.2.1" xref="S4.E5.m1.2.2.2.1.cmml">𝒟</mi><mo stretchy="false" id="S4.E5.m1.2.2.2.3.2" xref="S4.E5.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.1" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.1.cmml">​</mo><msubsup id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2.2.2" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2.2.2a.cmml">w</mtext><mi id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2.2.3" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2.2.3.cmml">i</mi><mi id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2.3" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2.3.cmml">t</mi></msubsup></mrow></mrow></mrow><mo stretchy="false" id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E5.m1.3.3.1.1.2.3" xref="S4.E5.m1.3.3.1.1.3a.cmml">,</mo><mrow id="S4.E5.m1.3.3.1.1.2.2" xref="S4.E5.m1.3.3.1.1.2.2.cmml"><mrow id="S4.E5.m1.3.3.1.1.2.2.2" xref="S4.E5.m1.3.3.1.1.2.2.2.cmml"><mtext id="S4.E5.m1.3.3.1.1.2.2.2.2" xref="S4.E5.m1.3.3.1.1.2.2.2.2a.cmml"> s.t. </mtext><mo lspace="0em" rspace="0em" id="S4.E5.m1.3.3.1.1.2.2.2.1" xref="S4.E5.m1.3.3.1.1.2.2.2.1.cmml">​</mo><mi id="S4.E5.m1.3.3.1.1.2.2.2.3" xref="S4.E5.m1.3.3.1.1.2.2.2.3.cmml">γ</mi></mrow><mo id="S4.E5.m1.3.3.1.1.2.2.1" xref="S4.E5.m1.3.3.1.1.2.2.1.cmml">&gt;</mo><mn id="S4.E5.m1.3.3.1.1.2.2.3" xref="S4.E5.m1.3.3.1.1.2.2.3.cmml">0</mn></mrow></mrow><mo lspace="0em" id="S4.E5.m1.3.3.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.3b"><apply id="S4.E5.m1.3.3.1.1.3.cmml" xref="S4.E5.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.3a.cmml" xref="S4.E5.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E5.m1.3.3.1.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1"><eq id="S4.E5.m1.3.3.1.1.1.1.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.2"></eq><apply id="S4.E5.m1.3.3.1.1.1.1.3.cmml" xref="S4.E5.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.1.1.3.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.3">superscript</csymbol><ci id="S4.E5.m1.3.3.1.1.1.1.3.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.3.2">𝛾</ci><times id="S4.E5.m1.3.3.1.1.1.1.3.3.cmml" xref="S4.E5.m1.3.3.1.1.1.1.3.3"></times></apply><apply id="S4.E5.m1.3.3.1.1.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1"><apply id="S4.E5.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.2">subscript</csymbol><apply id="S4.E5.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.2.2"><arg id="S4.E5.m1.3.3.1.1.1.1.1.2.2.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.2.2.1"></arg><min id="S4.E5.m1.3.3.1.1.1.1.1.2.2.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.2.2.2"></min></apply><ci id="S4.E5.m1.3.3.1.1.1.1.1.2.3.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.2.3">𝛾</ci></apply><apply id="S4.E5.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1"><times id="S4.E5.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.2"></times><apply id="S4.E5.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.2">ℒ</ci><apply id="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.3"><times id="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.1"></times><ci id="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.2">𝑝</ci><ci id="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.3">𝑟</ci><ci id="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.4.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.4">𝑜</ci><ci id="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.5.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.5">𝑥</ci><ci id="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.6.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.6">𝑦</ci></apply></apply><apply id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1"><ci id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1">⋅</ci><ci id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.2">𝛾</ci><apply id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3"><apply id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1">superscript</csymbol><apply id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.2.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1">subscript</csymbol><sum id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.2.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.2.2"></sum><apply id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.2.3.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.2.3"><eq id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.2.3.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.2.3.1"></eq><ci id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.2.3.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.2.3.3.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.3.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.3">𝑚</ci></apply><apply id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2"><times id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.1"></times><apply id="S4.E5.m1.2.2.cmml" xref="S4.E5.m1.2.2"><divide id="S4.E5.m1.2.2.3.cmml" xref="S4.E5.m1.2.2"></divide><apply id="S4.E5.m1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1"><abs id="S4.E5.m1.1.1.1.2.1.cmml" xref="S4.E5.m1.1.1.1.1.2"></abs><apply id="S4.E5.m1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.2">𝒟</ci><ci id="S4.E5.m1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S4.E5.m1.2.2.2.2.cmml" xref="S4.E5.m1.2.2.2.3"><abs id="S4.E5.m1.2.2.2.2.1.cmml" xref="S4.E5.m1.2.2.2.3.1"></abs><ci id="S4.E5.m1.2.2.2.1.cmml" xref="S4.E5.m1.2.2.2.1">𝒟</ci></apply></apply><apply id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2">superscript</csymbol><apply id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2.2.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2.2.2a.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2.2.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2.2.2">w</mtext></ci><ci id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2.2.3.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2.2.3">𝑖</ci></apply><ci id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2.3">𝑡</ci></apply></apply></apply></apply></apply></apply></apply><apply id="S4.E5.m1.3.3.1.1.2.2.cmml" xref="S4.E5.m1.3.3.1.1.2.2"><gt id="S4.E5.m1.3.3.1.1.2.2.1.cmml" xref="S4.E5.m1.3.3.1.1.2.2.1"></gt><apply id="S4.E5.m1.3.3.1.1.2.2.2.cmml" xref="S4.E5.m1.3.3.1.1.2.2.2"><times id="S4.E5.m1.3.3.1.1.2.2.2.1.cmml" xref="S4.E5.m1.3.3.1.1.2.2.2.1"></times><ci id="S4.E5.m1.3.3.1.1.2.2.2.2a.cmml" xref="S4.E5.m1.3.3.1.1.2.2.2.2"><mtext id="S4.E5.m1.3.3.1.1.2.2.2.2.cmml" xref="S4.E5.m1.3.3.1.1.2.2.2.2"> s.t. </mtext></ci><ci id="S4.E5.m1.3.3.1.1.2.2.2.3.cmml" xref="S4.E5.m1.3.3.1.1.2.2.2.3">𝛾</ci></apply><cn type="integer" id="S4.E5.m1.3.3.1.1.2.2.3.cmml" xref="S4.E5.m1.3.3.1.1.2.2.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.3c">\gamma^{*}=\mathop{\arg\min}\limits_{\gamma}\mathcal{L}_{proxy}(\gamma\cdot\sum_{i=1}^{m}\frac{|\mathcal{D}_{i}|}{|\mathcal{D}|}\textbf{w}_{i}^{t}),\text{ s.t. }\gamma&gt;0.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p3.3" class="ltx_p">Adaptive GWS largely improves the generalization.
From the left of <a href="#S4.F2" title="Figure 2 ‣ 4.1 Global Weight Shrinking and Its Impacts on Optimization ‣ 4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 2</span></a>, adaptive GWS can improve the performance of <span id="S4.SS2.p3.3.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> by a large margin in both IID and NonIID settings. Furthermore, adaptive GWS is more beneficial when the number of local epochs is small.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.1" class="ltx_p"><span id="S4.SS2.p4.1.1" class="ltx_text ltx_font_bold">1) Understanding the balance between optimization and regularization.</span> Further, through the learned optimal <math id="S4.SS2.p4.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS2.p4.1.m1.1a"><mi id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><ci id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">\gamma</annotation></semantics></math>, we verify the balance between optimization and regularization from the right of <a href="#S4.F2" title="Figure 2 ‣ 4.1 Global Weight Shrinking and Its Impacts on Optimization ‣ 4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 2</span></a> and <a href="#S4.F3" title="Figure 3 ‣ 4.2 Adaptive Global Weight Shrinking and Training Dynamics ‣ 4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 3</span></a>. A larger norm of the global gradient requires stronger regularization, in the cases when (i) the number of local epochs is larger; (ii) the clients’ data are more IID; (iii) during training before the global model is near convergence (on the contrary, when the model is near convergence, smaller regularization is needed).</p>
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.4" class="ltx_p">As shown in the right blue Y-axis of right <a href="#S4.F2" title="Figure 2 ‣ 4.1 Global Weight Shrinking and Its Impacts on Optimization ‣ 4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 2</span></a>, the norm of global gradient <math id="S4.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="\|\gamma\eta_{g}\textbf{g}_{g}^{t}\|" display="inline"><semantics id="S4.I1.i1.p1.1.m1.1a"><mrow id="S4.I1.i1.p1.1.m1.1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.2.cmml"><mo stretchy="false" id="S4.I1.i1.p1.1.m1.1.1.1.2" xref="S4.I1.i1.p1.1.m1.1.1.2.1.cmml">‖</mo><mrow id="S4.I1.i1.p1.1.m1.1.1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.1.1.cmml"><mi id="S4.I1.i1.p1.1.m1.1.1.1.1.2" xref="S4.I1.i1.p1.1.m1.1.1.1.1.2.cmml">γ</mi><mo lspace="0em" rspace="0em" id="S4.I1.i1.p1.1.m1.1.1.1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.1.1.1.cmml">​</mo><msub id="S4.I1.i1.p1.1.m1.1.1.1.1.3" xref="S4.I1.i1.p1.1.m1.1.1.1.1.3.cmml"><mi id="S4.I1.i1.p1.1.m1.1.1.1.1.3.2" xref="S4.I1.i1.p1.1.m1.1.1.1.1.3.2.cmml">η</mi><mi id="S4.I1.i1.p1.1.m1.1.1.1.1.3.3" xref="S4.I1.i1.p1.1.m1.1.1.1.1.3.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="S4.I1.i1.p1.1.m1.1.1.1.1.1a" xref="S4.I1.i1.p1.1.m1.1.1.1.1.1.cmml">​</mo><msubsup id="S4.I1.i1.p1.1.m1.1.1.1.1.4" xref="S4.I1.i1.p1.1.m1.1.1.1.1.4.cmml"><mtext class="ltx_mathvariant_bold" id="S4.I1.i1.p1.1.m1.1.1.1.1.4.2.2" xref="S4.I1.i1.p1.1.m1.1.1.1.1.4.2.2a.cmml">g</mtext><mi id="S4.I1.i1.p1.1.m1.1.1.1.1.4.2.3" xref="S4.I1.i1.p1.1.m1.1.1.1.1.4.2.3.cmml">g</mi><mi id="S4.I1.i1.p1.1.m1.1.1.1.1.4.3" xref="S4.I1.i1.p1.1.m1.1.1.1.1.4.3.cmml">t</mi></msubsup></mrow><mo stretchy="false" id="S4.I1.i1.p1.1.m1.1.1.1.3" xref="S4.I1.i1.p1.1.m1.1.1.2.1.cmml">‖</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.1.m1.1b"><apply id="S4.I1.i1.p1.1.m1.1.1.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1"><csymbol cd="latexml" id="S4.I1.i1.p1.1.m1.1.1.2.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.2">norm</csymbol><apply id="S4.I1.i1.p1.1.m1.1.1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1"><times id="S4.I1.i1.p1.1.m1.1.1.1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.1"></times><ci id="S4.I1.i1.p1.1.m1.1.1.1.1.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.2">𝛾</ci><apply id="S4.I1.i1.p1.1.m1.1.1.1.1.3.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i1.p1.1.m1.1.1.1.1.3.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.I1.i1.p1.1.m1.1.1.1.1.3.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.3.2">𝜂</ci><ci id="S4.I1.i1.p1.1.m1.1.1.1.1.3.3.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.3.3">𝑔</ci></apply><apply id="S4.I1.i1.p1.1.m1.1.1.1.1.4.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.I1.i1.p1.1.m1.1.1.1.1.4.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.4">superscript</csymbol><apply id="S4.I1.i1.p1.1.m1.1.1.1.1.4.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.I1.i1.p1.1.m1.1.1.1.1.4.2.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.4">subscript</csymbol><ci id="S4.I1.i1.p1.1.m1.1.1.1.1.4.2.2a.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.4.2.2"><mtext class="ltx_mathvariant_bold" id="S4.I1.i1.p1.1.m1.1.1.1.1.4.2.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.4.2.2">g</mtext></ci><ci id="S4.I1.i1.p1.1.m1.1.1.1.1.4.2.3.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.4.2.3">𝑔</ci></apply><ci id="S4.I1.i1.p1.1.m1.1.1.1.1.4.3.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.4.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.m1.1c">\|\gamma\eta_{g}\textbf{g}_{g}^{t}\|</annotation></semantics></math> increases when the number of local epochs increases and data become IID. As a result, the optimal value of <math id="S4.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.I1.i1.p1.2.m2.1a"><mi id="S4.I1.i1.p1.2.m2.1.1" xref="S4.I1.i1.p1.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.2.m2.1b"><ci id="S4.I1.i1.p1.2.m2.1.1.cmml" xref="S4.I1.i1.p1.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.2.m2.1c">\gamma</annotation></semantics></math> (shown in the left green Y-axis) becomes smaller in order to produce a larger weight shrinking pseudo gradient <math id="S4.I1.i1.p1.3.m3.1" class="ltx_Math" alttext="\|(1-\gamma)\mathbf{w}_{g}^{t}\|" display="inline"><semantics id="S4.I1.i1.p1.3.m3.1a"><mrow id="S4.I1.i1.p1.3.m3.1.1.1" xref="S4.I1.i1.p1.3.m3.1.1.2.cmml"><mo stretchy="false" id="S4.I1.i1.p1.3.m3.1.1.1.2" xref="S4.I1.i1.p1.3.m3.1.1.2.1.cmml">‖</mo><mrow id="S4.I1.i1.p1.3.m3.1.1.1.1" xref="S4.I1.i1.p1.3.m3.1.1.1.1.cmml"><mrow id="S4.I1.i1.p1.3.m3.1.1.1.1.1.1" xref="S4.I1.i1.p1.3.m3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.I1.i1.p1.3.m3.1.1.1.1.1.1.2" xref="S4.I1.i1.p1.3.m3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.I1.i1.p1.3.m3.1.1.1.1.1.1.1" xref="S4.I1.i1.p1.3.m3.1.1.1.1.1.1.1.cmml"><mn id="S4.I1.i1.p1.3.m3.1.1.1.1.1.1.1.2" xref="S4.I1.i1.p1.3.m3.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.I1.i1.p1.3.m3.1.1.1.1.1.1.1.1" xref="S4.I1.i1.p1.3.m3.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S4.I1.i1.p1.3.m3.1.1.1.1.1.1.1.3" xref="S4.I1.i1.p1.3.m3.1.1.1.1.1.1.1.3.cmml">γ</mi></mrow><mo stretchy="false" id="S4.I1.i1.p1.3.m3.1.1.1.1.1.1.3" xref="S4.I1.i1.p1.3.m3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.I1.i1.p1.3.m3.1.1.1.1.2" xref="S4.I1.i1.p1.3.m3.1.1.1.1.2.cmml">​</mo><msubsup id="S4.I1.i1.p1.3.m3.1.1.1.1.3" xref="S4.I1.i1.p1.3.m3.1.1.1.1.3.cmml"><mi id="S4.I1.i1.p1.3.m3.1.1.1.1.3.2.2" xref="S4.I1.i1.p1.3.m3.1.1.1.1.3.2.2.cmml">𝐰</mi><mi id="S4.I1.i1.p1.3.m3.1.1.1.1.3.2.3" xref="S4.I1.i1.p1.3.m3.1.1.1.1.3.2.3.cmml">g</mi><mi id="S4.I1.i1.p1.3.m3.1.1.1.1.3.3" xref="S4.I1.i1.p1.3.m3.1.1.1.1.3.3.cmml">t</mi></msubsup></mrow><mo stretchy="false" id="S4.I1.i1.p1.3.m3.1.1.1.3" xref="S4.I1.i1.p1.3.m3.1.1.2.1.cmml">‖</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.3.m3.1b"><apply id="S4.I1.i1.p1.3.m3.1.1.2.cmml" xref="S4.I1.i1.p1.3.m3.1.1.1"><csymbol cd="latexml" id="S4.I1.i1.p1.3.m3.1.1.2.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1.1.2">norm</csymbol><apply id="S4.I1.i1.p1.3.m3.1.1.1.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1.1.1"><times id="S4.I1.i1.p1.3.m3.1.1.1.1.2.cmml" xref="S4.I1.i1.p1.3.m3.1.1.1.1.2"></times><apply id="S4.I1.i1.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1.1.1.1.1"><minus id="S4.I1.i1.p1.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S4.I1.i1.p1.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S4.I1.i1.p1.3.m3.1.1.1.1.1.1.1.2">1</cn><ci id="S4.I1.i1.p1.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S4.I1.i1.p1.3.m3.1.1.1.1.1.1.1.3">𝛾</ci></apply><apply id="S4.I1.i1.p1.3.m3.1.1.1.1.3.cmml" xref="S4.I1.i1.p1.3.m3.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i1.p1.3.m3.1.1.1.1.3.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1.1.1.3">superscript</csymbol><apply id="S4.I1.i1.p1.3.m3.1.1.1.1.3.2.cmml" xref="S4.I1.i1.p1.3.m3.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i1.p1.3.m3.1.1.1.1.3.2.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1.1.1.3">subscript</csymbol><ci id="S4.I1.i1.p1.3.m3.1.1.1.1.3.2.2.cmml" xref="S4.I1.i1.p1.3.m3.1.1.1.1.3.2.2">𝐰</ci><ci id="S4.I1.i1.p1.3.m3.1.1.1.1.3.2.3.cmml" xref="S4.I1.i1.p1.3.m3.1.1.1.1.3.2.3">𝑔</ci></apply><ci id="S4.I1.i1.p1.3.m3.1.1.1.1.3.3.cmml" xref="S4.I1.i1.p1.3.m3.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.3.m3.1c">\|(1-\gamma)\mathbf{w}_{g}^{t}\|</annotation></semantics></math> to regularize the optimization. More results regarding how heterogeneity affects the optimal <math id="S4.I1.i1.p1.4.m4.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.I1.i1.p1.4.m4.1a"><mi id="S4.I1.i1.p1.4.m4.1.1" xref="S4.I1.i1.p1.4.m4.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.4.m4.1b"><ci id="S4.I1.i1.p1.4.m4.1.1.cmml" xref="S4.I1.i1.p1.4.m4.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.4.m4.1c">\gamma</annotation></semantics></math> can be found in <a href="#A2.F9" title="Figure 9 ‣ B.1 Global Weight Shrinking ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 9</span></a> in Appendix.</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p id="S4.I1.i2.p1.2" class="ltx_p">In <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 1</span></a>, GWS with smaller fixed <math id="S4.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.I1.i2.p1.1.m1.1a"><mi id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.1b"><ci id="S4.I1.i2.p1.1.m1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.1c">\gamma</annotation></semantics></math> will cause performance degradation in the late training. This is due to the conflicts of decaying global pseudo gradient and non-decaying regularization pseudo gradient.
In <a href="#S4.F3" title="Figure 3 ‣ 4.2 Adaptive Global Weight Shrinking and Training Dynamics ‣ 4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 3</span></a>, while the norm of the global gradient is decaying, adaptive GWS learns a rising optimal <math id="S4.I1.i2.p1.2.m2.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.I1.i2.p1.2.m2.1a"><mi id="S4.I1.i2.p1.2.m2.1.1" xref="S4.I1.i2.p1.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.2.m2.1b"><ci id="S4.I1.i2.p1.2.m2.1.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.2.m2.1c">\gamma</annotation></semantics></math> to keep the GWS pseudo gradient decay proportionally.
As a result, the ratio of two gradient terms remains steady at around 19 to maintain the balance between optimization and regularization.</p>
</div>
</li>
</ul>
</div>
<figure id="S4.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2302.10911/assets/x4.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="225" height="157" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2302.10911/assets/x5.png" id="S4.F3.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="226" height="162" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span id="S4.F3.6.3" class="ltx_text ltx_font_bold" style="font-size:90%;">Left:<span id="S4.F3.6.3.4" class="ltx_text ltx_font_medium"> Norm of two gradients in adaptive GWS. </span>Right:<span id="S4.F3.6.3.3" class="ltx_text ltx_font_medium"> The optimal <math id="S4.F3.4.1.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.F3.4.1.1.m1.1b"><mi id="S4.F3.4.1.1.m1.1.1" xref="S4.F3.4.1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.F3.4.1.1.m1.1c"><ci id="S4.F3.4.1.1.m1.1.1.cmml" xref="S4.F3.4.1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.4.1.1.m1.1d">\gamma</annotation></semantics></math> and <math id="S4.F3.5.2.2.m2.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.F3.5.2.2.m2.1b"><mi id="S4.F3.5.2.2.m2.1.1" xref="S4.F3.5.2.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.F3.5.2.2.m2.1c"><ci id="S4.F3.5.2.2.m2.1.1.cmml" xref="S4.F3.5.2.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.5.2.2.m2.1d">r</annotation></semantics></math> in adaptive GWS, where <math id="S4.F3.6.3.3.m3.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.F3.6.3.3.m3.1b"><mi id="S4.F3.6.3.3.m3.1.1" xref="S4.F3.6.3.3.m3.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.F3.6.3.3.m3.1c"><ci id="S4.F3.6.3.3.m3.1.1.cmml" xref="S4.F3.6.3.3.m3.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.6.3.3.m3.1d">r</annotation></semantics></math> is the ratio of the global gradient and the regularization pseudo gradient.
</span></span></figcaption>
</figure>
<figure id="S4.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2302.10911/assets/x6.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="276" height="223" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2302.10911/assets/x7.png" id="S4.F4.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="277" height="215" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2302.10911/assets/x8.png" id="S4.F4.g3" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="276" height="223" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span id="S4.F4.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">General understanding of adaptive GWS.<span id="S4.F4.2.1.2" class="ltx_text ltx_font_medium"> </span>Left:<span id="S4.F4.2.1.1" class="ltx_text ltx_font_medium"> Scale invariance property of DNNs indicates that if the network is rescaled by <math id="S4.F4.2.1.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.F4.2.1.1.m1.1b"><mi id="S4.F4.2.1.1.m1.1.1" xref="S4.F4.2.1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.F4.2.1.1.m1.1c"><ci id="S4.F4.2.1.1.m1.1.1.cmml" xref="S4.F4.2.1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.2.1.1.m1.1d">\gamma</annotation></semantics></math>, the function of the model remains similar. </span>Middle:<span id="S4.F4.2.1.3" class="ltx_text ltx_font_medium"> The histogram of final models’ parameters shows that adaptive GWS makes more model parameters close to zero, nearly twice as many as <span id="S4.F4.2.1.3.1" class="ltx_text ltx_font_smallcaps">FedAvg</span>. </span>Right:<span id="S4.F4.2.1.4" class="ltx_text ltx_font_medium"> The loss landscape is perturbed based on the Top-1 Hessian eigenvector of the final models, which shows that the model with adaptive GWS has flatter curvature and smaller loss.</span></span></figcaption>
</figure>
<div id="S4.SS2.p5" class="ltx_para">
<p id="S4.SS2.p5.1" class="ltx_p"><span id="S4.SS2.p5.1.1" class="ltx_text ltx_font_bold">2) The mechanisms behind adaptive GWS.</span> We provide an in-depth general understanding of how adaptive GWS works and why it can improve generalization.</p>
<ul id="S4.I2" class="ltx_itemize">
<li id="S4.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I2.i1.p1" class="ltx_para">
<p id="S4.I2.i1.p1.1" class="ltx_p"><span id="S4.I2.i1.p1.1.1" class="ltx_text ltx_font_bold">General understanding.</span></p>
<ul id="S4.I2.i1.I1" class="ltx_itemize">
<li id="S4.I2.i1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span id="S4.I2.i1.I1.i1.1.1.1" class="ltx_text ltx_font_bold">–</span></span> 
<div id="S4.I2.i1.I1.i1.p1" class="ltx_para">
<p id="S4.I2.i1.I1.i1.p1.3" class="ltx_p"><span id="S4.I2.i1.I1.i1.p1.3.1" class="ltx_text ltx_font_bold">Scale invariance.</span> Adaptive GWS learns a dynamic shrinking factor <math id="S4.I2.i1.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.I2.i1.I1.i1.p1.1.m1.1a"><mi id="S4.I2.i1.I1.i1.p1.1.m1.1.1" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.I2.i1.I1.i1.p1.1.m1.1b"><ci id="S4.I2.i1.I1.i1.p1.1.m1.1.1.cmml" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.I1.i1.p1.1.m1.1c">\gamma</annotation></semantics></math> in each round to shrink the global model’s parameter. The method is effective due to the scale invariance property of DNNs <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib31" title="" class="ltx_ref">2018</a>; Dinh et al., <a href="#bib.bib9" title="" class="ltx_ref">2017</a>; Kwon et al., <a href="#bib.bib29" title="" class="ltx_ref">2021</a>)</cite>, which states that the function of a DNN remains similar or the same even when a factor rescales the model weights due to the non-linearity of activation functions or the normalization layer in DNNs. We show an intuitive understanding of scale invariance on the left figure of <a href="#S4.F4" title="Figure 4 ‣ 4.2 Adaptive Global Weight Shrinking and Training Dynamics ‣ 4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 4</span></a>, where the final models are rescaled by <math id="S4.I2.i1.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.I2.i1.I1.i1.p1.2.m2.1a"><mi id="S4.I2.i1.I1.i1.p1.2.m2.1.1" xref="S4.I2.i1.I1.i1.p1.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.I2.i1.I1.i1.p1.2.m2.1b"><ci id="S4.I2.i1.I1.i1.p1.2.m2.1.1.cmml" xref="S4.I2.i1.I1.i1.p1.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.I1.i1.p1.2.m2.1c">\gamma</annotation></semantics></math>, and the loss function of the adaptive GWS’s final model remains similar while the <span id="S4.I2.i1.I1.i1.p1.3.2" class="ltx_text ltx_font_smallcaps">FedAvg</span>’s final model even has a smaller loss when <math id="S4.I2.i1.I1.i1.p1.3.m3.1" class="ltx_Math" alttext="\gamma&lt;1" display="inline"><semantics id="S4.I2.i1.I1.i1.p1.3.m3.1a"><mrow id="S4.I2.i1.I1.i1.p1.3.m3.1.1" xref="S4.I2.i1.I1.i1.p1.3.m3.1.1.cmml"><mi id="S4.I2.i1.I1.i1.p1.3.m3.1.1.2" xref="S4.I2.i1.I1.i1.p1.3.m3.1.1.2.cmml">γ</mi><mo id="S4.I2.i1.I1.i1.p1.3.m3.1.1.1" xref="S4.I2.i1.I1.i1.p1.3.m3.1.1.1.cmml">&lt;</mo><mn id="S4.I2.i1.I1.i1.p1.3.m3.1.1.3" xref="S4.I2.i1.I1.i1.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.I2.i1.I1.i1.p1.3.m3.1b"><apply id="S4.I2.i1.I1.i1.p1.3.m3.1.1.cmml" xref="S4.I2.i1.I1.i1.p1.3.m3.1.1"><lt id="S4.I2.i1.I1.i1.p1.3.m3.1.1.1.cmml" xref="S4.I2.i1.I1.i1.p1.3.m3.1.1.1"></lt><ci id="S4.I2.i1.I1.i1.p1.3.m3.1.1.2.cmml" xref="S4.I2.i1.I1.i1.p1.3.m3.1.1.2">𝛾</ci><cn type="integer" id="S4.I2.i1.I1.i1.p1.3.m3.1.1.3.cmml" xref="S4.I2.i1.I1.i1.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.I1.i1.p1.3.m3.1c">\gamma&lt;1</annotation></semantics></math>.</p>
</div>
</li>
<li id="S4.I2.i1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span id="S4.I2.i1.I1.i2.1.1.1" class="ltx_text ltx_font_bold">–</span></span> 
<div id="S4.I2.i1.I1.i2.p1" class="ltx_para">
<p id="S4.I2.i1.I1.i2.p1.1" class="ltx_p"><span id="S4.I2.i1.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Small model parameters.</span> The shrinking effect in each round can result in smaller model parameters of final global models, which is similar to weight decay.
The parameter weight histogram is demonstrated in the middle figure of <a href="#S4.F4" title="Figure 4 ‣ 4.2 Adaptive Global Weight Shrinking and Training Dynamics ‣ 4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 4</span></a>. The final model of adaptive GWS has more model parameters close to zero, nearly twice as many as <span id="S4.I2.i1.I1.i2.p1.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span>.</p>
</div>
</li>
</ul>
</div>
</li>
<li id="S4.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I2.i2.p1" class="ltx_para">
<p id="S4.I2.i2.p1.1" class="ltx_p"><span id="S4.I2.i2.p1.1.1" class="ltx_text ltx_font_bold">Why adaptive GWS can improve generalization.</span></p>
<ul id="S4.I2.i2.I1" class="ltx_itemize">
<li id="S4.I2.i2.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span id="S4.I2.i2.I1.i1.1.1.1" class="ltx_text ltx_font_bold">–</span></span> 
<div id="S4.I2.i2.I1.i1.p1" class="ltx_para">
<p id="S4.I2.i2.I1.i1.p1.1" class="ltx_p"><span id="S4.I2.i2.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">Flatter loss landscapes.</span> One perspective of explaining the generalization of DNNs is through the flatness of the loss landscape. Previous works have shown that flatter curvature in loss landscape can indicate better generalization <cite class="ltx_cite ltx_citemacro_citep">(Fort &amp; Jastrzebski, <a href="#bib.bib14" title="" class="ltx_ref">2019</a>; Foret et al., <a href="#bib.bib13" title="" class="ltx_ref">2020</a>; Li et al., <a href="#bib.bib31" title="" class="ltx_ref">2018</a>)</cite>. <cite class="ltx_cite ltx_citemacro_citep">(Lyu et al., <a href="#bib.bib40" title="" class="ltx_ref">2022</a>)</cite> shows that weight decay of mini-batch SGD can result in flatter landscapes in DNNs with normalization layers.
We also observe the similar phenomenon that <em id="S4.I2.i2.I1.i1.p1.1.2" class="ltx_emph ltx_font_italic">adaptive GWS improves generalization by seeking flatter minima in FL</em>, as shown in the right figure of <a href="#S4.F4" title="Figure 4 ‣ 4.2 Adaptive Global Weight Shrinking and Training Dynamics ‣ 4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 4</span></a>. Other metrics of flatness also demonstrate similar results (<a href="#A2.F10" title="Figure 10 ‣ B.1 Global Weight Shrinking ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 10</span></a> in Appendix).</p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div id="S4.SS2.p6" class="ltx_para">
<p id="S4.SS2.p6.4" class="ltx_p"><span id="S4.SS2.p6.4.1" class="ltx_text ltx_font_bold">3) The relation between adaptive GWS and local weight decay.</span>
Our proposed adaptive GWS can provide weight regularization from the global perspective, which is analogous to weight decay in mini-batch SGD. Importantly, GWS has a unique sparse regularization frequency that only changes the model weight in each round, resulting in stronger regularization. In GWS, <math id="S4.SS2.p6.1.m1.1" class="ltx_Math" alttext="1-\gamma" display="inline"><semantics id="S4.SS2.p6.1.m1.1a"><mrow id="S4.SS2.p6.1.m1.1.1" xref="S4.SS2.p6.1.m1.1.1.cmml"><mn id="S4.SS2.p6.1.m1.1.1.2" xref="S4.SS2.p6.1.m1.1.1.2.cmml">1</mn><mo id="S4.SS2.p6.1.m1.1.1.1" xref="S4.SS2.p6.1.m1.1.1.1.cmml">−</mo><mi id="S4.SS2.p6.1.m1.1.1.3" xref="S4.SS2.p6.1.m1.1.1.3.cmml">γ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.1.m1.1b"><apply id="S4.SS2.p6.1.m1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1"><minus id="S4.SS2.p6.1.m1.1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1.1"></minus><cn type="integer" id="S4.SS2.p6.1.m1.1.1.2.cmml" xref="S4.SS2.p6.1.m1.1.1.2">1</cn><ci id="S4.SS2.p6.1.m1.1.1.3.cmml" xref="S4.SS2.p6.1.m1.1.1.3">𝛾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.1.m1.1c">1-\gamma</annotation></semantics></math> is near 0.1, whereas the factor of weight decay is often around <math id="S4.SS2.p6.2.m2.1" class="ltx_Math" alttext="10^{-4}" display="inline"><semantics id="S4.SS2.p6.2.m2.1a"><msup id="S4.SS2.p6.2.m2.1.1" xref="S4.SS2.p6.2.m2.1.1.cmml"><mn id="S4.SS2.p6.2.m2.1.1.2" xref="S4.SS2.p6.2.m2.1.1.2.cmml">10</mn><mrow id="S4.SS2.p6.2.m2.1.1.3" xref="S4.SS2.p6.2.m2.1.1.3.cmml"><mo id="S4.SS2.p6.2.m2.1.1.3a" xref="S4.SS2.p6.2.m2.1.1.3.cmml">−</mo><mn id="S4.SS2.p6.2.m2.1.1.3.2" xref="S4.SS2.p6.2.m2.1.1.3.2.cmml">4</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.2.m2.1b"><apply id="S4.SS2.p6.2.m2.1.1.cmml" xref="S4.SS2.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p6.2.m2.1.1.1.cmml" xref="S4.SS2.p6.2.m2.1.1">superscript</csymbol><cn type="integer" id="S4.SS2.p6.2.m2.1.1.2.cmml" xref="S4.SS2.p6.2.m2.1.1.2">10</cn><apply id="S4.SS2.p6.2.m2.1.1.3.cmml" xref="S4.SS2.p6.2.m2.1.1.3"><minus id="S4.SS2.p6.2.m2.1.1.3.1.cmml" xref="S4.SS2.p6.2.m2.1.1.3"></minus><cn type="integer" id="S4.SS2.p6.2.m2.1.1.3.2.cmml" xref="S4.SS2.p6.2.m2.1.1.3.2">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.2.m2.1c">10^{-4}</annotation></semantics></math>. Notably, the two methods are not conflicted in FL, and we conduct experiments on implementing weight decay in the local SGD solver and global weight shrinking on the server simultaneously. As shown in <a href="#S4.T2" title="Table 2 ‣ 4.2 Adaptive Global Weight Shrinking and Training Dynamics ‣ 4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 2</span></a>, <em id="S4.SS2.p6.4.2" class="ltx_emph ltx_font_italic">adaptive GWS is compatible with local weight decay and can further improve performance.</em> Unlike local weight decay, adaptive GWS is hyperparameter-free and effective. It can adaptively set <math id="S4.SS2.p6.3.m3.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS2.p6.3.m3.1a"><mi id="S4.SS2.p6.3.m3.1.1" xref="S4.SS2.p6.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.3.m3.1b"><ci id="S4.SS2.p6.3.m3.1.1.cmml" xref="S4.SS2.p6.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.3.m3.1c">\gamma</annotation></semantics></math> to maximize the benefit of weight regularization. As the local weight decay becomes stronger, the learned <math id="S4.SS2.p6.4.m4.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS2.p6.4.m4.1a"><mi id="S4.SS2.p6.4.m4.1.1" xref="S4.SS2.p6.4.m4.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.4.m4.1b"><ci id="S4.SS2.p6.4.m4.1.1.cmml" xref="S4.SS2.p6.4.m4.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.4.m4.1c">\gamma</annotation></semantics></math> is larger, resulting in weaker GWS regularization. More analysis about global weight shrinking can be found in <a href="#A2.SS1" title="B.1 Global Weight Shrinking ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">subsection B.1</span></a> in Appendix.</p>
</div>
<div id="S4.SS2.p7" class="ltx_para">
<p id="S4.SS2.p7.1" class="ltx_p"><span id="S4.SS2.p7.1.1" class="ltx_text ltx_font_bold">4) Insights from FL’s adaptive GWS to mini-batch SGD.</span>
FL’s adaptive GWS leverages the advantage of the server that learns an adaptive shrinking factor globally. It is promising that similar ideas can be adopted in mini-batch SGD by learning the hyperparameter of weight decay on a small proportion of training data. This may realize hyperparameter-free optimization, and we leave it for future works.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span><span id="S4.T2.6.3" class="ltx_text" style="font-size:90%;">Adaptive GWS with different local weight decay factors (<math id="S4.T2.4.1.m1.1" class="ltx_Math" alttext="E=2" display="inline"><semantics id="S4.T2.4.1.m1.1b"><mrow id="S4.T2.4.1.m1.1.1" xref="S4.T2.4.1.m1.1.1.cmml"><mi id="S4.T2.4.1.m1.1.1.2" xref="S4.T2.4.1.m1.1.1.2.cmml">E</mi><mo id="S4.T2.4.1.m1.1.1.1" xref="S4.T2.4.1.m1.1.1.1.cmml">=</mo><mn id="S4.T2.4.1.m1.1.1.3" xref="S4.T2.4.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.4.1.m1.1c"><apply id="S4.T2.4.1.m1.1.1.cmml" xref="S4.T2.4.1.m1.1.1"><eq id="S4.T2.4.1.m1.1.1.1.cmml" xref="S4.T2.4.1.m1.1.1.1"></eq><ci id="S4.T2.4.1.m1.1.1.2.cmml" xref="S4.T2.4.1.m1.1.1.2">𝐸</ci><cn type="integer" id="S4.T2.4.1.m1.1.1.3.cmml" xref="S4.T2.4.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.1.m1.1d">E=2</annotation></semantics></math>). IID (<math id="S4.T2.5.2.m2.1" class="ltx_Math" alttext="\alpha=100" display="inline"><semantics id="S4.T2.5.2.m2.1b"><mrow id="S4.T2.5.2.m2.1.1" xref="S4.T2.5.2.m2.1.1.cmml"><mi id="S4.T2.5.2.m2.1.1.2" xref="S4.T2.5.2.m2.1.1.2.cmml">α</mi><mo id="S4.T2.5.2.m2.1.1.1" xref="S4.T2.5.2.m2.1.1.1.cmml">=</mo><mn id="S4.T2.5.2.m2.1.1.3" xref="S4.T2.5.2.m2.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.5.2.m2.1c"><apply id="S4.T2.5.2.m2.1.1.cmml" xref="S4.T2.5.2.m2.1.1"><eq id="S4.T2.5.2.m2.1.1.1.cmml" xref="S4.T2.5.2.m2.1.1.1"></eq><ci id="S4.T2.5.2.m2.1.1.2.cmml" xref="S4.T2.5.2.m2.1.1.2">𝛼</ci><cn type="integer" id="S4.T2.5.2.m2.1.1.3.cmml" xref="S4.T2.5.2.m2.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.2.m2.1d">\alpha=100</annotation></semantics></math>), NonIID (<math id="S4.T2.6.3.m3.1" class="ltx_Math" alttext="\alpha=1" display="inline"><semantics id="S4.T2.6.3.m3.1b"><mrow id="S4.T2.6.3.m3.1.1" xref="S4.T2.6.3.m3.1.1.cmml"><mi id="S4.T2.6.3.m3.1.1.2" xref="S4.T2.6.3.m3.1.1.2.cmml">α</mi><mo id="S4.T2.6.3.m3.1.1.1" xref="S4.T2.6.3.m3.1.1.1.cmml">=</mo><mn id="S4.T2.6.3.m3.1.1.3" xref="S4.T2.6.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.6.3.m3.1c"><apply id="S4.T2.6.3.m3.1.1.cmml" xref="S4.T2.6.3.m3.1.1"><eq id="S4.T2.6.3.m3.1.1.1.cmml" xref="S4.T2.6.3.m3.1.1.1"></eq><ci id="S4.T2.6.3.m3.1.1.2.cmml" xref="S4.T2.6.3.m3.1.1.2">𝛼</ci><cn type="integer" id="S4.T2.6.3.m3.1.1.3.cmml" xref="S4.T2.6.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.3.m3.1d">\alpha=1</annotation></semantics></math>).</span></figcaption>
<div id="S4.T2.8" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:208.1pt;height:75.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-70.6pt,25.5pt) scale(0.595718112727308,0.595718112727308) ;">
<table id="S4.T2.8.2" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.8.2.3.1" class="ltx_tr">
<th id="S4.T2.8.2.3.1.1" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt"></th>
<th id="S4.T2.8.2.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt"><span id="S4.T2.8.2.3.1.2.1" class="ltx_text ltx_font_bold">Local weight decay</span></th>
<th id="S4.T2.8.2.3.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">0</th>
<th id="S4.T2.8.2.3.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">5e-5</th>
<th id="S4.T2.8.2.3.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">1e-4</th>
<th id="S4.T2.8.2.3.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">5e-4</th>
<th id="S4.T2.8.2.3.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">1e-3</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.8.2.4.1" class="ltx_tr">
<th id="S4.T2.8.2.4.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" rowspan="3"><span id="S4.T2.8.2.4.1.1.1" class="ltx_text">IID</span></th>
<th id="S4.T2.8.2.4.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S4.T2.8.2.4.1.2.1" class="ltx_text ltx_font_smallcaps">FedAvg</span></th>
<td id="S4.T2.8.2.4.1.3" class="ltx_td ltx_align_center ltx_border_t">66.43</td>
<td id="S4.T2.8.2.4.1.4" class="ltx_td ltx_align_center ltx_border_t">66.20</td>
<td id="S4.T2.8.2.4.1.5" class="ltx_td ltx_align_center ltx_border_t">66.45</td>
<td id="S4.T2.8.2.4.1.6" class="ltx_td ltx_align_center ltx_border_t">67.51</td>
<td id="S4.T2.8.2.4.1.7" class="ltx_td ltx_align_center ltx_border_t">68.66</td>
</tr>
<tr id="S4.T2.8.2.5.2" class="ltx_tr">
<th id="S4.T2.8.2.5.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Adaptive GWS</th>
<td id="S4.T2.8.2.5.2.2" class="ltx_td ltx_align_center"><span id="S4.T2.8.2.5.2.2.1" class="ltx_text ltx_font_bold">71.47</span></td>
<td id="S4.T2.8.2.5.2.3" class="ltx_td ltx_align_center"><span id="S4.T2.8.2.5.2.3.1" class="ltx_text ltx_font_bold">71.36</span></td>
<td id="S4.T2.8.2.5.2.4" class="ltx_td ltx_align_center"><span id="S4.T2.8.2.5.2.4.1" class="ltx_text ltx_font_bold">71.35</span></td>
<td id="S4.T2.8.2.5.2.5" class="ltx_td ltx_align_center"><span id="S4.T2.8.2.5.2.5.1" class="ltx_text ltx_font_bold">71.44</span></td>
<td id="S4.T2.8.2.5.2.6" class="ltx_td ltx_align_center"><span id="S4.T2.8.2.5.2.6.1" class="ltx_text ltx_font_bold">71.54</span></td>
</tr>
<tr id="S4.T2.7.1.1" class="ltx_tr">
<th id="S4.T2.7.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">
<math id="S4.T2.7.1.1.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.T2.7.1.1.1.m1.1a"><mi id="S4.T2.7.1.1.1.m1.1.1" xref="S4.T2.7.1.1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.T2.7.1.1.1.m1.1b"><ci id="S4.T2.7.1.1.1.m1.1.1.cmml" xref="S4.T2.7.1.1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.1.1.1.m1.1c">\gamma</annotation></semantics></math> of Adaptive GWS</th>
<td id="S4.T2.7.1.1.2" class="ltx_td ltx_align_center">0.9472</td>
<td id="S4.T2.7.1.1.3" class="ltx_td ltx_align_center">0.9477</td>
<td id="S4.T2.7.1.1.4" class="ltx_td ltx_align_center">0.948</td>
<td id="S4.T2.7.1.1.5" class="ltx_td ltx_align_center">0.9493</td>
<td id="S4.T2.7.1.1.6" class="ltx_td ltx_align_center">0.953</td>
</tr>
<tr id="S4.T2.8.2.6.3" class="ltx_tr">
<th id="S4.T2.8.2.6.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" rowspan="3"><span id="S4.T2.8.2.6.3.1.1" class="ltx_text">NonIID</span></th>
<th id="S4.T2.8.2.6.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S4.T2.8.2.6.3.2.1" class="ltx_text ltx_font_smallcaps">FedAvg</span></th>
<td id="S4.T2.8.2.6.3.3" class="ltx_td ltx_align_center ltx_border_t">65.35</td>
<td id="S4.T2.8.2.6.3.4" class="ltx_td ltx_align_center ltx_border_t">65.19</td>
<td id="S4.T2.8.2.6.3.5" class="ltx_td ltx_align_center ltx_border_t">65.77</td>
<td id="S4.T2.8.2.6.3.6" class="ltx_td ltx_align_center ltx_border_t">66.37</td>
<td id="S4.T2.8.2.6.3.7" class="ltx_td ltx_align_center ltx_border_t">67.4</td>
</tr>
<tr id="S4.T2.8.2.7.4" class="ltx_tr">
<th id="S4.T2.8.2.7.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Adaptive GWS</th>
<td id="S4.T2.8.2.7.4.2" class="ltx_td ltx_align_center"><span id="S4.T2.8.2.7.4.2.1" class="ltx_text ltx_font_bold">70.31</span></td>
<td id="S4.T2.8.2.7.4.3" class="ltx_td ltx_align_center"><span id="S4.T2.8.2.7.4.3.1" class="ltx_text ltx_font_bold">69.93</span></td>
<td id="S4.T2.8.2.7.4.4" class="ltx_td ltx_align_center"><span id="S4.T2.8.2.7.4.4.1" class="ltx_text ltx_font_bold">70.44</span></td>
<td id="S4.T2.8.2.7.4.5" class="ltx_td ltx_align_center"><span id="S4.T2.8.2.7.4.5.1" class="ltx_text ltx_font_bold">70.47</span></td>
<td id="S4.T2.8.2.7.4.6" class="ltx_td ltx_align_center"><span id="S4.T2.8.2.7.4.6.1" class="ltx_text ltx_font_bold">69.99</span></td>
</tr>
<tr id="S4.T2.8.2.2" class="ltx_tr">
<th id="S4.T2.8.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r">
<math id="S4.T2.8.2.2.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.T2.8.2.2.1.m1.1a"><mi id="S4.T2.8.2.2.1.m1.1.1" xref="S4.T2.8.2.2.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.T2.8.2.2.1.m1.1b"><ci id="S4.T2.8.2.2.1.m1.1.1.cmml" xref="S4.T2.8.2.2.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.2.2.1.m1.1c">\gamma</annotation></semantics></math> of Adaptive GWS</th>
<td id="S4.T2.8.2.2.2" class="ltx_td ltx_align_center ltx_border_bb">0.9492</td>
<td id="S4.T2.8.2.2.3" class="ltx_td ltx_align_center ltx_border_bb">0.9499</td>
<td id="S4.T2.8.2.2.4" class="ltx_td ltx_align_center ltx_border_bb">0.9505</td>
<td id="S4.T2.8.2.2.5" class="ltx_td ltx_align_center ltx_border_bb">0.9529</td>
<td id="S4.T2.8.2.2.6" class="ltx_td ltx_align_center ltx_border_bb">0.9561</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2302.10911/assets/x9.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="396" height="242" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2302.10911/assets/x10.png" id="S4.F5.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="245" height="192" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2302.10911/assets/x11.png" id="S4.F5.g3" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="244" height="195" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span><span id="S4.F5.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Training dynamics of attentive LAW in terms of local gradient coherence.<span id="S4.F5.2.1.1" class="ltx_text ltx_font_medium"> Clients indexed 0-9 have balanced class distributions and 10-19 are imbalanced, <math id="S4.F5.2.1.1.m1.1" class="ltx_Math" alttext="E=3" display="inline"><semantics id="S4.F5.2.1.1.m1.1b"><mrow id="S4.F5.2.1.1.m1.1.1" xref="S4.F5.2.1.1.m1.1.1.cmml"><mi id="S4.F5.2.1.1.m1.1.1.2" xref="S4.F5.2.1.1.m1.1.1.2.cmml">E</mi><mo id="S4.F5.2.1.1.m1.1.1.1" xref="S4.F5.2.1.1.m1.1.1.1.cmml">=</mo><mn id="S4.F5.2.1.1.m1.1.1.3" xref="S4.F5.2.1.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F5.2.1.1.m1.1c"><apply id="S4.F5.2.1.1.m1.1.1.cmml" xref="S4.F5.2.1.1.m1.1.1"><eq id="S4.F5.2.1.1.m1.1.1.1.cmml" xref="S4.F5.2.1.1.m1.1.1.1"></eq><ci id="S4.F5.2.1.1.m1.1.1.2.cmml" xref="S4.F5.2.1.1.m1.1.1.2">𝐸</ci><cn type="integer" id="S4.F5.2.1.1.m1.1.1.3.cmml" xref="S4.F5.2.1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.2.1.1.m1.1d">E=3</annotation></semantics></math>. </span>Left:<span id="S4.F5.2.1.2" class="ltx_text ltx_font_medium"> Local gradient coherence. </span>Middle and Right:<span id="S4.F5.2.1.3" class="ltx_text ltx_font_medium"> The performance and aggregation weights of attentive LAW and early-stopped attentive LAW.</span></span></figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Client coherence</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Basic Concept and Formulation</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">Inspired by gradient coherence in mini-batch SGD <cite class="ltx_cite ltx_citemacro_citep">(Chatterjee, <a href="#bib.bib5" title="" class="ltx_ref">2019</a>; Zielinski et al., <a href="#bib.bib57" title="" class="ltx_ref">2020</a>; Chatterjee &amp; Zielinski, <a href="#bib.bib6" title="" class="ltx_ref">2020</a>)</cite>, we study <em id="S5.SS1.p1.1.1" class="ltx_emph ltx_font_italic">client coherence</em> in FL through weighted aggregation, which indicates how clients strengthen and complement each other to achieve better generalization.
There are two aspects, the <em id="S5.SS1.p1.1.2" class="ltx_emph ltx_font_italic">local gradient coherence</em> of clients’ model updates and the <em id="S5.SS1.p1.1.3" class="ltx_emph ltx_font_italic">heterogeneity coherence</em>.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p"><span id="S5.SS1.p2.1.1" class="ltx_text ltx_font_bold">Local Gradient Coherence.</span>
The gradient coherence in mini-batch SGD is at the data sample level. In FL, the concept of gradient coherence is extended to the level of clients, where we refer to it as "client coherence". Specifically, we study the similarity of local gradients among clients, as it has been shown that aggregating similar gradients leads to stronger global gradients, thereby improving generalization. We deduce the gradient coherence in mini-batch SGD and local gradient coherence in FL under a unified equation below:</p>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<table id="A4.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S5.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td colspan="2" class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S5.E6.m1.142" class="ltx_Math" alttext="\displaystyle\begin{split}\displaystyle&amp;\Delta\mathcal{L}^{t}=\mathcal{L}(\mathbf{w}^{t}-\eta\textbf{g}^{t})-\mathcal{L}(\mathbf{w}^{t})\approx-\eta\cdot\langle\textbf{g}^{t},\textbf{g}^{t}\rangle\\
&amp;=-\eta\cdot\langle\sum_{i=1}^{m}\lambda_{i}\textbf{g}_{i}^{t},\sum_{i=1}^{m}\lambda_{i}\textbf{g}_{i}^{t}\rangle\\
&amp;=-\eta\cdot(\sum_{i=1}^{m}\lambda_{i}^{2}\|\textbf{g}_{i}^{t}\|^{2}+\sum_{i,j,i\neq j}\lambda_{i}\lambda_{j}\langle\textbf{g}_{i}^{t},\textbf{g}_{j}^{t}\rangle)\\
&amp;=-\eta\cdot(\sum_{i=1}^{m}\lambda_{i}^{2}\|\textbf{g}_{i}^{t}\|^{2}+\sum_{i,j,i\neq j}\lambda_{i}\lambda_{j}\cos(\textbf{g}_{i}^{t},\textbf{g}_{j}^{t})\|\textbf{g}_{i}^{t}\|\|\textbf{g}_{j}^{t}\|)\,.\end{split}" display="inline"><semantics id="S5.E6.m1.142a"><mtable columnspacing="0pt" rowspacing="0pt" id="S5.E6.m1.142.142.9"><mtr id="S5.E6.m1.142.142.9a"><mtd id="S5.E6.m1.142.142.9b" xref="S5.E6.m1.134.134.1.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S5.E6.m1.142.142.9c"><mrow id="S5.E6.m1.138.138.5.137.34.34"><mrow id="S5.E6.m1.138.138.5.137.34.34.36"><mi mathvariant="normal" id="S5.E6.m1.1.1.1.1.1.1" xref="S5.E6.m1.1.1.1.1.1.1.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S5.E6.m1.138.138.5.137.34.34.36.1" xref="S5.E6.m1.134.134.1.1.1.cmml">​</mo><msup id="S5.E6.m1.138.138.5.137.34.34.36.2"><mi class="ltx_font_mathcaligraphic" id="S5.E6.m1.2.2.2.2.2.2" xref="S5.E6.m1.2.2.2.2.2.2.cmml">ℒ</mi><mi id="S5.E6.m1.3.3.3.3.3.3.1" xref="S5.E6.m1.3.3.3.3.3.3.1.cmml">t</mi></msup></mrow><mo id="S5.E6.m1.4.4.4.4.4.4" xref="S5.E6.m1.4.4.4.4.4.4.cmml">=</mo><mrow id="S5.E6.m1.136.136.3.135.32.32.32"><mrow id="S5.E6.m1.135.135.2.134.31.31.31.1"><mi class="ltx_font_mathcaligraphic" id="S5.E6.m1.5.5.5.5.5.5" xref="S5.E6.m1.5.5.5.5.5.5.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S5.E6.m1.135.135.2.134.31.31.31.1.2" xref="S5.E6.m1.134.134.1.1.1.cmml">​</mo><mrow id="S5.E6.m1.135.135.2.134.31.31.31.1.1.1"><mo stretchy="false" id="S5.E6.m1.6.6.6.6.6.6" xref="S5.E6.m1.134.134.1.1.1.cmml">(</mo><mrow id="S5.E6.m1.135.135.2.134.31.31.31.1.1.1.1"><msup id="S5.E6.m1.135.135.2.134.31.31.31.1.1.1.1.1"><mi id="S5.E6.m1.7.7.7.7.7.7" xref="S5.E6.m1.7.7.7.7.7.7.cmml">𝐰</mi><mi id="S5.E6.m1.8.8.8.8.8.8.1" xref="S5.E6.m1.8.8.8.8.8.8.1.cmml">t</mi></msup><mo id="S5.E6.m1.9.9.9.9.9.9" xref="S5.E6.m1.9.9.9.9.9.9.cmml">−</mo><mrow id="S5.E6.m1.135.135.2.134.31.31.31.1.1.1.1.2"><mi id="S5.E6.m1.10.10.10.10.10.10" xref="S5.E6.m1.10.10.10.10.10.10.cmml">η</mi><mo lspace="0em" rspace="0em" id="S5.E6.m1.135.135.2.134.31.31.31.1.1.1.1.2.1" xref="S5.E6.m1.134.134.1.1.1.cmml">​</mo><msup id="S5.E6.m1.135.135.2.134.31.31.31.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S5.E6.m1.11.11.11.11.11.11" xref="S5.E6.m1.11.11.11.11.11.11a.cmml">g</mtext><mi id="S5.E6.m1.12.12.12.12.12.12.1" xref="S5.E6.m1.12.12.12.12.12.12.1.cmml">t</mi></msup></mrow></mrow><mo stretchy="false" id="S5.E6.m1.13.13.13.13.13.13" xref="S5.E6.m1.134.134.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.E6.m1.14.14.14.14.14.14" xref="S5.E6.m1.14.14.14.14.14.14.cmml">−</mo><mrow id="S5.E6.m1.136.136.3.135.32.32.32.2"><mi class="ltx_font_mathcaligraphic" id="S5.E6.m1.15.15.15.15.15.15" xref="S5.E6.m1.15.15.15.15.15.15.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S5.E6.m1.136.136.3.135.32.32.32.2.2" xref="S5.E6.m1.134.134.1.1.1.cmml">​</mo><mrow id="S5.E6.m1.136.136.3.135.32.32.32.2.1.1"><mo stretchy="false" id="S5.E6.m1.16.16.16.16.16.16" xref="S5.E6.m1.134.134.1.1.1.cmml">(</mo><msup id="S5.E6.m1.136.136.3.135.32.32.32.2.1.1.1"><mi id="S5.E6.m1.17.17.17.17.17.17" xref="S5.E6.m1.17.17.17.17.17.17.cmml">𝐰</mi><mi id="S5.E6.m1.18.18.18.18.18.18.1" xref="S5.E6.m1.18.18.18.18.18.18.1.cmml">t</mi></msup><mo stretchy="false" id="S5.E6.m1.19.19.19.19.19.19" xref="S5.E6.m1.134.134.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S5.E6.m1.20.20.20.20.20.20" xref="S5.E6.m1.20.20.20.20.20.20.cmml">≈</mo><mrow id="S5.E6.m1.138.138.5.137.34.34.34"><mo id="S5.E6.m1.138.138.5.137.34.34.34a" xref="S5.E6.m1.134.134.1.1.1.cmml">−</mo><mrow id="S5.E6.m1.138.138.5.137.34.34.34.2"><mi id="S5.E6.m1.22.22.22.22.22.22" xref="S5.E6.m1.22.22.22.22.22.22.cmml">η</mi><mo lspace="0.222em" rspace="0.222em" id="S5.E6.m1.23.23.23.23.23.23" xref="S5.E6.m1.23.23.23.23.23.23.cmml">⋅</mo><mrow id="S5.E6.m1.138.138.5.137.34.34.34.2.2.2"><mo stretchy="false" id="S5.E6.m1.24.24.24.24.24.24" xref="S5.E6.m1.134.134.1.1.1.cmml">⟨</mo><msup id="S5.E6.m1.137.137.4.136.33.33.33.1.1.1.1"><mtext class="ltx_mathvariant_bold" id="S5.E6.m1.25.25.25.25.25.25" xref="S5.E6.m1.25.25.25.25.25.25a.cmml">g</mtext><mi id="S5.E6.m1.26.26.26.26.26.26.1" xref="S5.E6.m1.26.26.26.26.26.26.1.cmml">t</mi></msup><mo id="S5.E6.m1.27.27.27.27.27.27" xref="S5.E6.m1.134.134.1.1.1.cmml">,</mo><msup id="S5.E6.m1.138.138.5.137.34.34.34.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S5.E6.m1.28.28.28.28.28.28" xref="S5.E6.m1.28.28.28.28.28.28a.cmml">g</mtext><mi id="S5.E6.m1.29.29.29.29.29.29.1" xref="S5.E6.m1.29.29.29.29.29.29.1.cmml">t</mi></msup><mo stretchy="false" id="S5.E6.m1.30.30.30.30.30.30" xref="S5.E6.m1.134.134.1.1.1.cmml">⟩</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S5.E6.m1.142.142.9d"><mtd id="S5.E6.m1.142.142.9e" xref="S5.E6.m1.134.134.1.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S5.E6.m1.142.142.9f"><mrow id="S5.E6.m1.140.140.7.139.25.25"><mi id="S5.E6.m1.140.140.7.139.25.25.26" xref="S5.E6.m1.134.134.1.1.1.cmml"></mi><mo id="S5.E6.m1.31.31.31.1.1.1" xref="S5.E6.m1.31.31.31.1.1.1.cmml">=</mo><mrow id="S5.E6.m1.140.140.7.139.25.25.25"><mo id="S5.E6.m1.140.140.7.139.25.25.25a" xref="S5.E6.m1.134.134.1.1.1.cmml">−</mo><mrow id="S5.E6.m1.140.140.7.139.25.25.25.2"><mi id="S5.E6.m1.33.33.33.3.3.3" xref="S5.E6.m1.33.33.33.3.3.3.cmml">η</mi><mo lspace="0.222em" rspace="0.222em" id="S5.E6.m1.34.34.34.4.4.4" xref="S5.E6.m1.34.34.34.4.4.4.cmml">⋅</mo><mrow id="S5.E6.m1.140.140.7.139.25.25.25.2.2.2"><mo stretchy="false" id="S5.E6.m1.35.35.35.5.5.5" xref="S5.E6.m1.134.134.1.1.1.cmml">⟨</mo><mrow id="S5.E6.m1.139.139.6.138.24.24.24.1.1.1.1"><mstyle displaystyle="true" id="S5.E6.m1.139.139.6.138.24.24.24.1.1.1.1.1"><munderover id="S5.E6.m1.139.139.6.138.24.24.24.1.1.1.1.1a"><mo movablelimits="false" id="S5.E6.m1.36.36.36.6.6.6" xref="S5.E6.m1.36.36.36.6.6.6.cmml">∑</mo><mrow id="S5.E6.m1.37.37.37.7.7.7.1" xref="S5.E6.m1.37.37.37.7.7.7.1.cmml"><mi id="S5.E6.m1.37.37.37.7.7.7.1.2" xref="S5.E6.m1.37.37.37.7.7.7.1.2.cmml">i</mi><mo id="S5.E6.m1.37.37.37.7.7.7.1.1" xref="S5.E6.m1.37.37.37.7.7.7.1.1.cmml">=</mo><mn id="S5.E6.m1.37.37.37.7.7.7.1.3" xref="S5.E6.m1.37.37.37.7.7.7.1.3.cmml">1</mn></mrow><mi id="S5.E6.m1.38.38.38.8.8.8.1" xref="S5.E6.m1.38.38.38.8.8.8.1.cmml">m</mi></munderover></mstyle><mrow id="S5.E6.m1.139.139.6.138.24.24.24.1.1.1.1.2"><msub id="S5.E6.m1.139.139.6.138.24.24.24.1.1.1.1.2.2"><mi id="S5.E6.m1.39.39.39.9.9.9" xref="S5.E6.m1.39.39.39.9.9.9.cmml">λ</mi><mi id="S5.E6.m1.40.40.40.10.10.10.1" xref="S5.E6.m1.40.40.40.10.10.10.1.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S5.E6.m1.139.139.6.138.24.24.24.1.1.1.1.2.1" xref="S5.E6.m1.134.134.1.1.1.cmml">​</mo><msubsup id="S5.E6.m1.139.139.6.138.24.24.24.1.1.1.1.2.3"><mtext class="ltx_mathvariant_bold" id="S5.E6.m1.41.41.41.11.11.11" xref="S5.E6.m1.41.41.41.11.11.11a.cmml">g</mtext><mi id="S5.E6.m1.42.42.42.12.12.12.1" xref="S5.E6.m1.42.42.42.12.12.12.1.cmml">i</mi><mi id="S5.E6.m1.43.43.43.13.13.13.1" xref="S5.E6.m1.43.43.43.13.13.13.1.cmml">t</mi></msubsup></mrow></mrow><mo id="S5.E6.m1.44.44.44.14.14.14" xref="S5.E6.m1.134.134.1.1.1.cmml">,</mo><mrow id="S5.E6.m1.140.140.7.139.25.25.25.2.2.2.2"><mstyle displaystyle="true" id="S5.E6.m1.140.140.7.139.25.25.25.2.2.2.2.1"><munderover id="S5.E6.m1.140.140.7.139.25.25.25.2.2.2.2.1a"><mo movablelimits="false" id="S5.E6.m1.45.45.45.15.15.15" xref="S5.E6.m1.45.45.45.15.15.15.cmml">∑</mo><mrow id="S5.E6.m1.46.46.46.16.16.16.1" xref="S5.E6.m1.46.46.46.16.16.16.1.cmml"><mi id="S5.E6.m1.46.46.46.16.16.16.1.2" xref="S5.E6.m1.46.46.46.16.16.16.1.2.cmml">i</mi><mo id="S5.E6.m1.46.46.46.16.16.16.1.1" xref="S5.E6.m1.46.46.46.16.16.16.1.1.cmml">=</mo><mn id="S5.E6.m1.46.46.46.16.16.16.1.3" xref="S5.E6.m1.46.46.46.16.16.16.1.3.cmml">1</mn></mrow><mi id="S5.E6.m1.47.47.47.17.17.17.1" xref="S5.E6.m1.47.47.47.17.17.17.1.cmml">m</mi></munderover></mstyle><mrow id="S5.E6.m1.140.140.7.139.25.25.25.2.2.2.2.2"><msub id="S5.E6.m1.140.140.7.139.25.25.25.2.2.2.2.2.2"><mi id="S5.E6.m1.48.48.48.18.18.18" xref="S5.E6.m1.48.48.48.18.18.18.cmml">λ</mi><mi id="S5.E6.m1.49.49.49.19.19.19.1" xref="S5.E6.m1.49.49.49.19.19.19.1.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S5.E6.m1.140.140.7.139.25.25.25.2.2.2.2.2.1" xref="S5.E6.m1.134.134.1.1.1.cmml">​</mo><msubsup id="S5.E6.m1.140.140.7.139.25.25.25.2.2.2.2.2.3"><mtext class="ltx_mathvariant_bold" id="S5.E6.m1.50.50.50.20.20.20" xref="S5.E6.m1.50.50.50.20.20.20a.cmml">g</mtext><mi id="S5.E6.m1.51.51.51.21.21.21.1" xref="S5.E6.m1.51.51.51.21.21.21.1.cmml">i</mi><mi id="S5.E6.m1.52.52.52.22.22.22.1" xref="S5.E6.m1.52.52.52.22.22.22.1.cmml">t</mi></msubsup></mrow></mrow><mo stretchy="false" id="S5.E6.m1.53.53.53.23.23.23" xref="S5.E6.m1.134.134.1.1.1.cmml">⟩</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S5.E6.m1.142.142.9g"><mtd id="S5.E6.m1.142.142.9h" xref="S5.E6.m1.134.134.1.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S5.E6.m1.142.142.9i"><mrow id="S5.E6.m1.141.141.8.140.35.35"><mi id="S5.E6.m1.141.141.8.140.35.35.36" xref="S5.E6.m1.134.134.1.1.1.cmml"></mi><mo id="S5.E6.m1.54.54.54.1.1.1" xref="S5.E6.m1.54.54.54.1.1.1.cmml">=</mo><mrow id="S5.E6.m1.141.141.8.140.35.35.35"><mo id="S5.E6.m1.141.141.8.140.35.35.35a" xref="S5.E6.m1.134.134.1.1.1.cmml">−</mo><mrow id="S5.E6.m1.141.141.8.140.35.35.35.1"><mi id="S5.E6.m1.56.56.56.3.3.3" xref="S5.E6.m1.56.56.56.3.3.3.cmml">η</mi><mo lspace="0.222em" rspace="0.222em" id="S5.E6.m1.57.57.57.4.4.4" xref="S5.E6.m1.57.57.57.4.4.4.cmml">⋅</mo><mrow id="S5.E6.m1.141.141.8.140.35.35.35.1.1.1"><mo stretchy="false" id="S5.E6.m1.58.58.58.5.5.5" xref="S5.E6.m1.134.134.1.1.1.cmml">(</mo><mrow id="S5.E6.m1.141.141.8.140.35.35.35.1.1.1.1"><mrow id="S5.E6.m1.141.141.8.140.35.35.35.1.1.1.1.1"><mstyle displaystyle="true" id="S5.E6.m1.141.141.8.140.35.35.35.1.1.1.1.1.2"><munderover id="S5.E6.m1.141.141.8.140.35.35.35.1.1.1.1.1.2a"><mo movablelimits="false" id="S5.E6.m1.59.59.59.6.6.6" xref="S5.E6.m1.59.59.59.6.6.6.cmml">∑</mo><mrow id="S5.E6.m1.60.60.60.7.7.7.1" xref="S5.E6.m1.60.60.60.7.7.7.1.cmml"><mi id="S5.E6.m1.60.60.60.7.7.7.1.2" xref="S5.E6.m1.60.60.60.7.7.7.1.2.cmml">i</mi><mo id="S5.E6.m1.60.60.60.7.7.7.1.1" xref="S5.E6.m1.60.60.60.7.7.7.1.1.cmml">=</mo><mn id="S5.E6.m1.60.60.60.7.7.7.1.3" xref="S5.E6.m1.60.60.60.7.7.7.1.3.cmml">1</mn></mrow><mi id="S5.E6.m1.61.61.61.8.8.8.1" xref="S5.E6.m1.61.61.61.8.8.8.1.cmml">m</mi></munderover></mstyle><mrow id="S5.E6.m1.141.141.8.140.35.35.35.1.1.1.1.1.1"><msubsup id="S5.E6.m1.141.141.8.140.35.35.35.1.1.1.1.1.1.3"><mi id="S5.E6.m1.62.62.62.9.9.9" xref="S5.E6.m1.62.62.62.9.9.9.cmml">λ</mi><mi id="S5.E6.m1.63.63.63.10.10.10.1" xref="S5.E6.m1.63.63.63.10.10.10.1.cmml">i</mi><mn id="S5.E6.m1.64.64.64.11.11.11.1" xref="S5.E6.m1.64.64.64.11.11.11.1.cmml">2</mn></msubsup><mo lspace="0em" rspace="0em" id="S5.E6.m1.141.141.8.140.35.35.35.1.1.1.1.1.1.2" xref="S5.E6.m1.134.134.1.1.1.cmml">​</mo><msup id="S5.E6.m1.141.141.8.140.35.35.35.1.1.1.1.1.1.1"><mrow id="S5.E6.m1.141.141.8.140.35.35.35.1.1.1.1.1.1.1.1.1"><mo stretchy="false" id="S5.E6.m1.65.65.65.12.12.12" xref="S5.E6.m1.134.134.1.1.1.cmml">‖</mo><msubsup id="S5.E6.m1.141.141.8.140.35.35.35.1.1.1.1.1.1.1.1.1.1"><mtext class="ltx_mathvariant_bold" id="S5.E6.m1.66.66.66.13.13.13" xref="S5.E6.m1.66.66.66.13.13.13a.cmml">g</mtext><mi id="S5.E6.m1.67.67.67.14.14.14.1" xref="S5.E6.m1.67.67.67.14.14.14.1.cmml">i</mi><mi id="S5.E6.m1.68.68.68.15.15.15.1" xref="S5.E6.m1.68.68.68.15.15.15.1.cmml">t</mi></msubsup><mo stretchy="false" id="S5.E6.m1.69.69.69.16.16.16" xref="S5.E6.m1.134.134.1.1.1.cmml">‖</mo></mrow><mn id="S5.E6.m1.70.70.70.17.17.17.1" xref="S5.E6.m1.70.70.70.17.17.17.1.cmml">2</mn></msup></mrow></mrow><mo id="S5.E6.m1.71.71.71.18.18.18" xref="S5.E6.m1.71.71.71.18.18.18.cmml">+</mo><mrow id="S5.E6.m1.141.141.8.140.35.35.35.1.1.1.1.3"><mstyle displaystyle="true" id="S5.E6.m1.141.141.8.140.35.35.35.1.1.1.1.3.3"><munder id="S5.E6.m1.141.141.8.140.35.35.35.1.1.1.1.3.3a"><mo movablelimits="false" id="S5.E6.m1.72.72.72.19.19.19" xref="S5.E6.m1.72.72.72.19.19.19.cmml">∑</mo><mrow id="S5.E6.m1.73.73.73.20.20.20.1" xref="S5.E6.m1.73.73.73.20.20.20.1.cmml"><mrow id="S5.E6.m1.73.73.73.20.20.20.1.5.2" xref="S5.E6.m1.73.73.73.20.20.20.1.5.1.cmml"><mi id="S5.E6.m1.73.73.73.20.20.20.1.1" xref="S5.E6.m1.73.73.73.20.20.20.1.1.cmml">i</mi><mo id="S5.E6.m1.73.73.73.20.20.20.1.5.2.1" xref="S5.E6.m1.73.73.73.20.20.20.1.5.1.cmml">,</mo><mi id="S5.E6.m1.73.73.73.20.20.20.1.2" xref="S5.E6.m1.73.73.73.20.20.20.1.2.cmml">j</mi><mo id="S5.E6.m1.73.73.73.20.20.20.1.5.2.2" xref="S5.E6.m1.73.73.73.20.20.20.1.5.1.cmml">,</mo><mi id="S5.E6.m1.73.73.73.20.20.20.1.3" xref="S5.E6.m1.73.73.73.20.20.20.1.3.cmml">i</mi></mrow><mo id="S5.E6.m1.73.73.73.20.20.20.1.4" xref="S5.E6.m1.73.73.73.20.20.20.1.4.cmml">≠</mo><mi id="S5.E6.m1.73.73.73.20.20.20.1.6" xref="S5.E6.m1.73.73.73.20.20.20.1.6.cmml">j</mi></mrow></munder></mstyle><mrow id="S5.E6.m1.141.141.8.140.35.35.35.1.1.1.1.3.2"><msub id="S5.E6.m1.141.141.8.140.35.35.35.1.1.1.1.3.2.4"><mi id="S5.E6.m1.74.74.74.21.21.21" xref="S5.E6.m1.74.74.74.21.21.21.cmml">λ</mi><mi id="S5.E6.m1.75.75.75.22.22.22.1" xref="S5.E6.m1.75.75.75.22.22.22.1.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S5.E6.m1.141.141.8.140.35.35.35.1.1.1.1.3.2.3" xref="S5.E6.m1.134.134.1.1.1.cmml">​</mo><msub id="S5.E6.m1.141.141.8.140.35.35.35.1.1.1.1.3.2.5"><mi id="S5.E6.m1.76.76.76.23.23.23" xref="S5.E6.m1.76.76.76.23.23.23.cmml">λ</mi><mi id="S5.E6.m1.77.77.77.24.24.24.1" xref="S5.E6.m1.77.77.77.24.24.24.1.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S5.E6.m1.141.141.8.140.35.35.35.1.1.1.1.3.2.3a" xref="S5.E6.m1.134.134.1.1.1.cmml">​</mo><mrow id="S5.E6.m1.141.141.8.140.35.35.35.1.1.1.1.3.2.2.2"><mo stretchy="false" id="S5.E6.m1.78.78.78.25.25.25" xref="S5.E6.m1.134.134.1.1.1.cmml">⟨</mo><msubsup id="S5.E6.m1.141.141.8.140.35.35.35.1.1.1.1.2.1.1.1.1"><mtext class="ltx_mathvariant_bold" id="S5.E6.m1.79.79.79.26.26.26" xref="S5.E6.m1.79.79.79.26.26.26a.cmml">g</mtext><mi id="S5.E6.m1.80.80.80.27.27.27.1" xref="S5.E6.m1.80.80.80.27.27.27.1.cmml">i</mi><mi id="S5.E6.m1.81.81.81.28.28.28.1" xref="S5.E6.m1.81.81.81.28.28.28.1.cmml">t</mi></msubsup><mo id="S5.E6.m1.82.82.82.29.29.29" xref="S5.E6.m1.134.134.1.1.1.cmml">,</mo><msubsup id="S5.E6.m1.141.141.8.140.35.35.35.1.1.1.1.3.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S5.E6.m1.83.83.83.30.30.30" xref="S5.E6.m1.83.83.83.30.30.30a.cmml">g</mtext><mi id="S5.E6.m1.84.84.84.31.31.31.1" xref="S5.E6.m1.84.84.84.31.31.31.1.cmml">j</mi><mi id="S5.E6.m1.85.85.85.32.32.32.1" xref="S5.E6.m1.85.85.85.32.32.32.1.cmml">t</mi></msubsup><mo stretchy="false" id="S5.E6.m1.86.86.86.33.33.33" xref="S5.E6.m1.134.134.1.1.1.cmml">⟩</mo></mrow></mrow></mrow></mrow><mo stretchy="false" id="S5.E6.m1.87.87.87.34.34.34" xref="S5.E6.m1.134.134.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S5.E6.m1.142.142.9j"><mtd id="S5.E6.m1.142.142.9k" xref="S5.E6.m1.134.134.1.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S5.E6.m1.142.142.9l"><mrow id="S5.E6.m1.142.142.9.141.47.47.47"><mrow id="S5.E6.m1.142.142.9.141.47.47.47.1"><mi id="S5.E6.m1.142.142.9.141.47.47.47.1.2" xref="S5.E6.m1.134.134.1.1.1.cmml"></mi><mo id="S5.E6.m1.88.88.88.1.1.1" xref="S5.E6.m1.88.88.88.1.1.1.cmml">=</mo><mrow id="S5.E6.m1.142.142.9.141.47.47.47.1.1"><mo id="S5.E6.m1.142.142.9.141.47.47.47.1.1a" xref="S5.E6.m1.134.134.1.1.1.cmml">−</mo><mrow id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1"><mi id="S5.E6.m1.90.90.90.3.3.3" xref="S5.E6.m1.90.90.90.3.3.3.cmml">η</mi><mo lspace="0.222em" rspace="0.222em" id="S5.E6.m1.91.91.91.4.4.4" xref="S5.E6.m1.91.91.91.4.4.4.cmml">⋅</mo><mrow id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1"><mo stretchy="false" id="S5.E6.m1.92.92.92.5.5.5" xref="S5.E6.m1.134.134.1.1.1.cmml">(</mo><mrow id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1"><mrow id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.1"><mstyle displaystyle="true" id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.1.2"><munderover id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.1.2a"><mo movablelimits="false" id="S5.E6.m1.93.93.93.6.6.6" xref="S5.E6.m1.93.93.93.6.6.6.cmml">∑</mo><mrow id="S5.E6.m1.94.94.94.7.7.7.1" xref="S5.E6.m1.94.94.94.7.7.7.1.cmml"><mi id="S5.E6.m1.94.94.94.7.7.7.1.2" xref="S5.E6.m1.94.94.94.7.7.7.1.2.cmml">i</mi><mo id="S5.E6.m1.94.94.94.7.7.7.1.1" xref="S5.E6.m1.94.94.94.7.7.7.1.1.cmml">=</mo><mn id="S5.E6.m1.94.94.94.7.7.7.1.3" xref="S5.E6.m1.94.94.94.7.7.7.1.3.cmml">1</mn></mrow><mi id="S5.E6.m1.95.95.95.8.8.8.1" xref="S5.E6.m1.95.95.95.8.8.8.1.cmml">m</mi></munderover></mstyle><mrow id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.1.1"><msubsup id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.1.1.3"><mi id="S5.E6.m1.96.96.96.9.9.9" xref="S5.E6.m1.96.96.96.9.9.9.cmml">λ</mi><mi id="S5.E6.m1.97.97.97.10.10.10.1" xref="S5.E6.m1.97.97.97.10.10.10.1.cmml">i</mi><mn id="S5.E6.m1.98.98.98.11.11.11.1" xref="S5.E6.m1.98.98.98.11.11.11.1.cmml">2</mn></msubsup><mo lspace="0em" rspace="0em" id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.1.1.2" xref="S5.E6.m1.134.134.1.1.1.cmml">​</mo><msup id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.1.1.1"><mrow id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.1.1.1.1.1"><mo stretchy="false" id="S5.E6.m1.99.99.99.12.12.12" xref="S5.E6.m1.134.134.1.1.1.cmml">‖</mo><msubsup id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.1.1.1.1.1.1"><mtext class="ltx_mathvariant_bold" id="S5.E6.m1.100.100.100.13.13.13" xref="S5.E6.m1.100.100.100.13.13.13a.cmml">g</mtext><mi id="S5.E6.m1.101.101.101.14.14.14.1" xref="S5.E6.m1.101.101.101.14.14.14.1.cmml">i</mi><mi id="S5.E6.m1.102.102.102.15.15.15.1" xref="S5.E6.m1.102.102.102.15.15.15.1.cmml">t</mi></msubsup><mo stretchy="false" id="S5.E6.m1.103.103.103.16.16.16" xref="S5.E6.m1.134.134.1.1.1.cmml">‖</mo></mrow><mn id="S5.E6.m1.104.104.104.17.17.17.1" xref="S5.E6.m1.104.104.104.17.17.17.1.cmml">2</mn></msup></mrow></mrow><mo id="S5.E6.m1.105.105.105.18.18.18" xref="S5.E6.m1.105.105.105.18.18.18.cmml">+</mo><mrow id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.5"><mstyle displaystyle="true" id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.5.5"><munder id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.5.5a"><mo movablelimits="false" id="S5.E6.m1.106.106.106.19.19.19" xref="S5.E6.m1.106.106.106.19.19.19.cmml">∑</mo><mrow id="S5.E6.m1.107.107.107.20.20.20.1" xref="S5.E6.m1.107.107.107.20.20.20.1.cmml"><mrow id="S5.E6.m1.107.107.107.20.20.20.1.5.2" xref="S5.E6.m1.107.107.107.20.20.20.1.5.1.cmml"><mi id="S5.E6.m1.107.107.107.20.20.20.1.1" xref="S5.E6.m1.107.107.107.20.20.20.1.1.cmml">i</mi><mo id="S5.E6.m1.107.107.107.20.20.20.1.5.2.1" xref="S5.E6.m1.107.107.107.20.20.20.1.5.1.cmml">,</mo><mi id="S5.E6.m1.107.107.107.20.20.20.1.2" xref="S5.E6.m1.107.107.107.20.20.20.1.2.cmml">j</mi><mo id="S5.E6.m1.107.107.107.20.20.20.1.5.2.2" xref="S5.E6.m1.107.107.107.20.20.20.1.5.1.cmml">,</mo><mi id="S5.E6.m1.107.107.107.20.20.20.1.3" xref="S5.E6.m1.107.107.107.20.20.20.1.3.cmml">i</mi></mrow><mo id="S5.E6.m1.107.107.107.20.20.20.1.4" xref="S5.E6.m1.107.107.107.20.20.20.1.4.cmml">≠</mo><mi id="S5.E6.m1.107.107.107.20.20.20.1.6" xref="S5.E6.m1.107.107.107.20.20.20.1.6.cmml">j</mi></mrow></munder></mstyle><mrow id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.5.4"><msub id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.5.4.6"><mi id="S5.E6.m1.108.108.108.21.21.21" xref="S5.E6.m1.108.108.108.21.21.21.cmml">λ</mi><mi id="S5.E6.m1.109.109.109.22.22.22.1" xref="S5.E6.m1.109.109.109.22.22.22.1.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.5.4.5" xref="S5.E6.m1.134.134.1.1.1.cmml">​</mo><msub id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.5.4.7"><mi id="S5.E6.m1.110.110.110.23.23.23" xref="S5.E6.m1.110.110.110.23.23.23.cmml">λ</mi><mi id="S5.E6.m1.111.111.111.24.24.24.1" xref="S5.E6.m1.111.111.111.24.24.24.1.cmml">j</mi></msub><mo lspace="0.167em" rspace="0em" id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.5.4.5a" xref="S5.E6.m1.134.134.1.1.1.cmml">​</mo><mrow id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.3.2.2.2"><mi id="S5.E6.m1.112.112.112.25.25.25" xref="S5.E6.m1.112.112.112.25.25.25.cmml">cos</mi><mo id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.3.2.2.2a" xref="S5.E6.m1.134.134.1.1.1.cmml">⁡</mo><mrow id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.3.2.2.2.2"><mo stretchy="false" id="S5.E6.m1.113.113.113.26.26.26" xref="S5.E6.m1.134.134.1.1.1.cmml">(</mo><msubsup id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.2.1.1.1.1.1"><mtext class="ltx_mathvariant_bold" id="S5.E6.m1.114.114.114.27.27.27" xref="S5.E6.m1.114.114.114.27.27.27a.cmml">g</mtext><mi id="S5.E6.m1.115.115.115.28.28.28.1" xref="S5.E6.m1.115.115.115.28.28.28.1.cmml">i</mi><mi id="S5.E6.m1.116.116.116.29.29.29.1" xref="S5.E6.m1.116.116.116.29.29.29.1.cmml">t</mi></msubsup><mo id="S5.E6.m1.117.117.117.30.30.30" xref="S5.E6.m1.134.134.1.1.1.cmml">,</mo><msubsup id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.3.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S5.E6.m1.118.118.118.31.31.31" xref="S5.E6.m1.118.118.118.31.31.31a.cmml">g</mtext><mi id="S5.E6.m1.119.119.119.32.32.32.1" xref="S5.E6.m1.119.119.119.32.32.32.1.cmml">j</mi><mi id="S5.E6.m1.120.120.120.33.33.33.1" xref="S5.E6.m1.120.120.120.33.33.33.1.cmml">t</mi></msubsup><mo stretchy="false" id="S5.E6.m1.121.121.121.34.34.34" xref="S5.E6.m1.134.134.1.1.1.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.5.4.5b" xref="S5.E6.m1.134.134.1.1.1.cmml">​</mo><mrow id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.4.3.3.1"><mo stretchy="false" id="S5.E6.m1.122.122.122.35.35.35" xref="S5.E6.m1.134.134.1.1.1.cmml">‖</mo><msubsup id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.4.3.3.1.1"><mtext class="ltx_mathvariant_bold" id="S5.E6.m1.123.123.123.36.36.36" xref="S5.E6.m1.123.123.123.36.36.36a.cmml">g</mtext><mi id="S5.E6.m1.124.124.124.37.37.37.1" xref="S5.E6.m1.124.124.124.37.37.37.1.cmml">i</mi><mi id="S5.E6.m1.125.125.125.38.38.38.1" xref="S5.E6.m1.125.125.125.38.38.38.1.cmml">t</mi></msubsup><mo stretchy="false" id="S5.E6.m1.126.126.126.39.39.39" xref="S5.E6.m1.134.134.1.1.1.cmml">‖</mo></mrow><mo lspace="0em" rspace="0em" id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.5.4.5c" xref="S5.E6.m1.134.134.1.1.1.cmml">​</mo><mrow id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.5.4.4.1"><mo stretchy="false" id="S5.E6.m1.127.127.127.40.40.40" xref="S5.E6.m1.134.134.1.1.1.cmml">‖</mo><msubsup id="S5.E6.m1.142.142.9.141.47.47.47.1.1.1.1.1.1.5.4.4.1.1"><mtext class="ltx_mathvariant_bold" id="S5.E6.m1.128.128.128.41.41.41" xref="S5.E6.m1.128.128.128.41.41.41a.cmml">g</mtext><mi id="S5.E6.m1.129.129.129.42.42.42.1" xref="S5.E6.m1.129.129.129.42.42.42.1.cmml">j</mi><mi id="S5.E6.m1.130.130.130.43.43.43.1" xref="S5.E6.m1.130.130.130.43.43.43.1.cmml">t</mi></msubsup><mo stretchy="false" id="S5.E6.m1.131.131.131.44.44.44" xref="S5.E6.m1.134.134.1.1.1.cmml">‖</mo></mrow></mrow></mrow></mrow><mo stretchy="false" id="S5.E6.m1.132.132.132.45.45.45" xref="S5.E6.m1.134.134.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0.170em" id="S5.E6.m1.133.133.133.46.46.46" xref="S5.E6.m1.134.134.1.1.1.cmml">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S5.E6.m1.142b"><apply id="S5.E6.m1.134.134.1.1.1.cmml" xref="S5.E6.m1.142.142.9b"><and id="S5.E6.m1.134.134.1.1.1a.cmml" xref="S5.E6.m1.142.142.9b"></and><apply id="S5.E6.m1.134.134.1.1.1b.cmml" xref="S5.E6.m1.142.142.9b"><eq id="S5.E6.m1.4.4.4.4.4.4.cmml" xref="S5.E6.m1.4.4.4.4.4.4"></eq><apply id="S5.E6.m1.134.134.1.1.1.10.cmml" xref="S5.E6.m1.142.142.9b"><times id="S5.E6.m1.134.134.1.1.1.10.1.cmml" xref="S5.E6.m1.142.142.9b"></times><ci id="S5.E6.m1.1.1.1.1.1.1.cmml" xref="S5.E6.m1.1.1.1.1.1.1">Δ</ci><apply id="S5.E6.m1.134.134.1.1.1.10.3.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.10.3.1.cmml" xref="S5.E6.m1.142.142.9b">superscript</csymbol><ci id="S5.E6.m1.2.2.2.2.2.2.cmml" xref="S5.E6.m1.2.2.2.2.2.2">ℒ</ci><ci id="S5.E6.m1.3.3.3.3.3.3.1.cmml" xref="S5.E6.m1.3.3.3.3.3.3.1">𝑡</ci></apply></apply><apply id="S5.E6.m1.134.134.1.1.1.2.cmml" xref="S5.E6.m1.142.142.9b"><minus id="S5.E6.m1.14.14.14.14.14.14.cmml" xref="S5.E6.m1.14.14.14.14.14.14"></minus><apply id="S5.E6.m1.134.134.1.1.1.1.1.cmml" xref="S5.E6.m1.142.142.9b"><times id="S5.E6.m1.134.134.1.1.1.1.1.2.cmml" xref="S5.E6.m1.142.142.9b"></times><ci id="S5.E6.m1.5.5.5.5.5.5.cmml" xref="S5.E6.m1.5.5.5.5.5.5">ℒ</ci><apply id="S5.E6.m1.134.134.1.1.1.1.1.1.1.1.cmml" xref="S5.E6.m1.142.142.9b"><minus id="S5.E6.m1.9.9.9.9.9.9.cmml" xref="S5.E6.m1.9.9.9.9.9.9"></minus><apply id="S5.E6.m1.134.134.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.1.1.1.1.1.2.1.cmml" xref="S5.E6.m1.142.142.9b">superscript</csymbol><ci id="S5.E6.m1.7.7.7.7.7.7.cmml" xref="S5.E6.m1.7.7.7.7.7.7">𝐰</ci><ci id="S5.E6.m1.8.8.8.8.8.8.1.cmml" xref="S5.E6.m1.8.8.8.8.8.8.1">𝑡</ci></apply><apply id="S5.E6.m1.134.134.1.1.1.1.1.1.1.1.3.cmml" xref="S5.E6.m1.142.142.9b"><times id="S5.E6.m1.134.134.1.1.1.1.1.1.1.1.3.1.cmml" xref="S5.E6.m1.142.142.9b"></times><ci id="S5.E6.m1.10.10.10.10.10.10.cmml" xref="S5.E6.m1.10.10.10.10.10.10">𝜂</ci><apply id="S5.E6.m1.134.134.1.1.1.1.1.1.1.1.3.3.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S5.E6.m1.142.142.9b">superscript</csymbol><ci id="S5.E6.m1.11.11.11.11.11.11a.cmml" xref="S5.E6.m1.11.11.11.11.11.11"><mtext class="ltx_mathvariant_bold" id="S5.E6.m1.11.11.11.11.11.11.cmml" xref="S5.E6.m1.11.11.11.11.11.11">g</mtext></ci><ci id="S5.E6.m1.12.12.12.12.12.12.1.cmml" xref="S5.E6.m1.12.12.12.12.12.12.1">𝑡</ci></apply></apply></apply></apply><apply id="S5.E6.m1.134.134.1.1.1.2.2.cmml" xref="S5.E6.m1.142.142.9b"><times id="S5.E6.m1.134.134.1.1.1.2.2.2.cmml" xref="S5.E6.m1.142.142.9b"></times><ci id="S5.E6.m1.15.15.15.15.15.15.cmml" xref="S5.E6.m1.15.15.15.15.15.15">ℒ</ci><apply id="S5.E6.m1.134.134.1.1.1.2.2.1.1.1.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.2.2.1.1.1.1.cmml" xref="S5.E6.m1.142.142.9b">superscript</csymbol><ci id="S5.E6.m1.17.17.17.17.17.17.cmml" xref="S5.E6.m1.17.17.17.17.17.17">𝐰</ci><ci id="S5.E6.m1.18.18.18.18.18.18.1.cmml" xref="S5.E6.m1.18.18.18.18.18.18.1">𝑡</ci></apply></apply></apply></apply><apply id="S5.E6.m1.134.134.1.1.1c.cmml" xref="S5.E6.m1.142.142.9b"><approx id="S5.E6.m1.20.20.20.20.20.20.cmml" xref="S5.E6.m1.20.20.20.20.20.20"></approx><share href="#S5.E6.m1.134.134.1.1.1.2.cmml" id="S5.E6.m1.134.134.1.1.1d.cmml" xref="S5.E6.m1.142.142.9b"></share><apply id="S5.E6.m1.134.134.1.1.1.4.cmml" xref="S5.E6.m1.142.142.9b"><minus id="S5.E6.m1.21.21.21.21.21.21.cmml" xref="S5.E6.m1.142.142.9b"></minus><apply id="S5.E6.m1.134.134.1.1.1.4.2.cmml" xref="S5.E6.m1.142.142.9b"><ci id="S5.E6.m1.23.23.23.23.23.23.cmml" xref="S5.E6.m1.23.23.23.23.23.23">⋅</ci><ci id="S5.E6.m1.22.22.22.22.22.22.cmml" xref="S5.E6.m1.22.22.22.22.22.22">𝜂</ci><list id="S5.E6.m1.134.134.1.1.1.4.2.2.3.cmml" xref="S5.E6.m1.142.142.9b"><apply id="S5.E6.m1.134.134.1.1.1.3.1.1.1.1.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.3.1.1.1.1.1.cmml" xref="S5.E6.m1.142.142.9b">superscript</csymbol><ci id="S5.E6.m1.25.25.25.25.25.25a.cmml" xref="S5.E6.m1.25.25.25.25.25.25"><mtext class="ltx_mathvariant_bold" id="S5.E6.m1.25.25.25.25.25.25.cmml" xref="S5.E6.m1.25.25.25.25.25.25">g</mtext></ci><ci id="S5.E6.m1.26.26.26.26.26.26.1.cmml" xref="S5.E6.m1.26.26.26.26.26.26.1">𝑡</ci></apply><apply id="S5.E6.m1.134.134.1.1.1.4.2.2.2.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.4.2.2.2.2.1.cmml" xref="S5.E6.m1.142.142.9b">superscript</csymbol><ci id="S5.E6.m1.28.28.28.28.28.28a.cmml" xref="S5.E6.m1.28.28.28.28.28.28"><mtext class="ltx_mathvariant_bold" id="S5.E6.m1.28.28.28.28.28.28.cmml" xref="S5.E6.m1.28.28.28.28.28.28">g</mtext></ci><ci id="S5.E6.m1.29.29.29.29.29.29.1.cmml" xref="S5.E6.m1.29.29.29.29.29.29.1">𝑡</ci></apply></list></apply></apply></apply><apply id="S5.E6.m1.134.134.1.1.1e.cmml" xref="S5.E6.m1.142.142.9b"><eq id="S5.E6.m1.31.31.31.1.1.1.cmml" xref="S5.E6.m1.31.31.31.1.1.1"></eq><share href="#S5.E6.m1.134.134.1.1.1.4.cmml" id="S5.E6.m1.134.134.1.1.1f.cmml" xref="S5.E6.m1.142.142.9b"></share><apply id="S5.E6.m1.134.134.1.1.1.6.cmml" xref="S5.E6.m1.142.142.9b"><minus id="S5.E6.m1.32.32.32.2.2.2.cmml" xref="S5.E6.m1.142.142.9b"></minus><apply id="S5.E6.m1.134.134.1.1.1.6.2.cmml" xref="S5.E6.m1.142.142.9b"><ci id="S5.E6.m1.34.34.34.4.4.4.cmml" xref="S5.E6.m1.34.34.34.4.4.4">⋅</ci><ci id="S5.E6.m1.33.33.33.3.3.3.cmml" xref="S5.E6.m1.33.33.33.3.3.3">𝜂</ci><list id="S5.E6.m1.134.134.1.1.1.6.2.2.3.cmml" xref="S5.E6.m1.142.142.9b"><apply id="S5.E6.m1.134.134.1.1.1.5.1.1.1.1.cmml" xref="S5.E6.m1.142.142.9b"><apply id="S5.E6.m1.134.134.1.1.1.5.1.1.1.1.1.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.5.1.1.1.1.1.1.cmml" xref="S5.E6.m1.142.142.9b">superscript</csymbol><apply id="S5.E6.m1.134.134.1.1.1.5.1.1.1.1.1.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.5.1.1.1.1.1.2.1.cmml" xref="S5.E6.m1.142.142.9b">subscript</csymbol><sum id="S5.E6.m1.36.36.36.6.6.6.cmml" xref="S5.E6.m1.36.36.36.6.6.6"></sum><apply id="S5.E6.m1.37.37.37.7.7.7.1.cmml" xref="S5.E6.m1.37.37.37.7.7.7.1"><eq id="S5.E6.m1.37.37.37.7.7.7.1.1.cmml" xref="S5.E6.m1.37.37.37.7.7.7.1.1"></eq><ci id="S5.E6.m1.37.37.37.7.7.7.1.2.cmml" xref="S5.E6.m1.37.37.37.7.7.7.1.2">𝑖</ci><cn type="integer" id="S5.E6.m1.37.37.37.7.7.7.1.3.cmml" xref="S5.E6.m1.37.37.37.7.7.7.1.3">1</cn></apply></apply><ci id="S5.E6.m1.38.38.38.8.8.8.1.cmml" xref="S5.E6.m1.38.38.38.8.8.8.1">𝑚</ci></apply><apply id="S5.E6.m1.134.134.1.1.1.5.1.1.1.1.2.cmml" xref="S5.E6.m1.142.142.9b"><times id="S5.E6.m1.134.134.1.1.1.5.1.1.1.1.2.1.cmml" xref="S5.E6.m1.142.142.9b"></times><apply id="S5.E6.m1.134.134.1.1.1.5.1.1.1.1.2.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.5.1.1.1.1.2.2.1.cmml" xref="S5.E6.m1.142.142.9b">subscript</csymbol><ci id="S5.E6.m1.39.39.39.9.9.9.cmml" xref="S5.E6.m1.39.39.39.9.9.9">𝜆</ci><ci id="S5.E6.m1.40.40.40.10.10.10.1.cmml" xref="S5.E6.m1.40.40.40.10.10.10.1">𝑖</ci></apply><apply id="S5.E6.m1.134.134.1.1.1.5.1.1.1.1.2.3.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.5.1.1.1.1.2.3.1.cmml" xref="S5.E6.m1.142.142.9b">superscript</csymbol><apply id="S5.E6.m1.134.134.1.1.1.5.1.1.1.1.2.3.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.5.1.1.1.1.2.3.2.1.cmml" xref="S5.E6.m1.142.142.9b">subscript</csymbol><ci id="S5.E6.m1.41.41.41.11.11.11a.cmml" xref="S5.E6.m1.41.41.41.11.11.11"><mtext class="ltx_mathvariant_bold" id="S5.E6.m1.41.41.41.11.11.11.cmml" xref="S5.E6.m1.41.41.41.11.11.11">g</mtext></ci><ci id="S5.E6.m1.42.42.42.12.12.12.1.cmml" xref="S5.E6.m1.42.42.42.12.12.12.1">𝑖</ci></apply><ci id="S5.E6.m1.43.43.43.13.13.13.1.cmml" xref="S5.E6.m1.43.43.43.13.13.13.1">𝑡</ci></apply></apply></apply><apply id="S5.E6.m1.134.134.1.1.1.6.2.2.2.2.cmml" xref="S5.E6.m1.142.142.9b"><apply id="S5.E6.m1.134.134.1.1.1.6.2.2.2.2.1.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.6.2.2.2.2.1.1.cmml" xref="S5.E6.m1.142.142.9b">superscript</csymbol><apply id="S5.E6.m1.134.134.1.1.1.6.2.2.2.2.1.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.6.2.2.2.2.1.2.1.cmml" xref="S5.E6.m1.142.142.9b">subscript</csymbol><sum id="S5.E6.m1.45.45.45.15.15.15.cmml" xref="S5.E6.m1.45.45.45.15.15.15"></sum><apply id="S5.E6.m1.46.46.46.16.16.16.1.cmml" xref="S5.E6.m1.46.46.46.16.16.16.1"><eq id="S5.E6.m1.46.46.46.16.16.16.1.1.cmml" xref="S5.E6.m1.46.46.46.16.16.16.1.1"></eq><ci id="S5.E6.m1.46.46.46.16.16.16.1.2.cmml" xref="S5.E6.m1.46.46.46.16.16.16.1.2">𝑖</ci><cn type="integer" id="S5.E6.m1.46.46.46.16.16.16.1.3.cmml" xref="S5.E6.m1.46.46.46.16.16.16.1.3">1</cn></apply></apply><ci id="S5.E6.m1.47.47.47.17.17.17.1.cmml" xref="S5.E6.m1.47.47.47.17.17.17.1">𝑚</ci></apply><apply id="S5.E6.m1.134.134.1.1.1.6.2.2.2.2.2.cmml" xref="S5.E6.m1.142.142.9b"><times id="S5.E6.m1.134.134.1.1.1.6.2.2.2.2.2.1.cmml" xref="S5.E6.m1.142.142.9b"></times><apply id="S5.E6.m1.134.134.1.1.1.6.2.2.2.2.2.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.6.2.2.2.2.2.2.1.cmml" xref="S5.E6.m1.142.142.9b">subscript</csymbol><ci id="S5.E6.m1.48.48.48.18.18.18.cmml" xref="S5.E6.m1.48.48.48.18.18.18">𝜆</ci><ci id="S5.E6.m1.49.49.49.19.19.19.1.cmml" xref="S5.E6.m1.49.49.49.19.19.19.1">𝑖</ci></apply><apply id="S5.E6.m1.134.134.1.1.1.6.2.2.2.2.2.3.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.6.2.2.2.2.2.3.1.cmml" xref="S5.E6.m1.142.142.9b">superscript</csymbol><apply id="S5.E6.m1.134.134.1.1.1.6.2.2.2.2.2.3.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.6.2.2.2.2.2.3.2.1.cmml" xref="S5.E6.m1.142.142.9b">subscript</csymbol><ci id="S5.E6.m1.50.50.50.20.20.20a.cmml" xref="S5.E6.m1.50.50.50.20.20.20"><mtext class="ltx_mathvariant_bold" id="S5.E6.m1.50.50.50.20.20.20.cmml" xref="S5.E6.m1.50.50.50.20.20.20">g</mtext></ci><ci id="S5.E6.m1.51.51.51.21.21.21.1.cmml" xref="S5.E6.m1.51.51.51.21.21.21.1">𝑖</ci></apply><ci id="S5.E6.m1.52.52.52.22.22.22.1.cmml" xref="S5.E6.m1.52.52.52.22.22.22.1">𝑡</ci></apply></apply></apply></list></apply></apply></apply><apply id="S5.E6.m1.134.134.1.1.1g.cmml" xref="S5.E6.m1.142.142.9b"><eq id="S5.E6.m1.54.54.54.1.1.1.cmml" xref="S5.E6.m1.54.54.54.1.1.1"></eq><share href="#S5.E6.m1.134.134.1.1.1.6.cmml" id="S5.E6.m1.134.134.1.1.1h.cmml" xref="S5.E6.m1.142.142.9b"></share><apply id="S5.E6.m1.134.134.1.1.1.7.cmml" xref="S5.E6.m1.142.142.9b"><minus id="S5.E6.m1.55.55.55.2.2.2.cmml" xref="S5.E6.m1.142.142.9b"></minus><apply id="S5.E6.m1.134.134.1.1.1.7.1.cmml" xref="S5.E6.m1.142.142.9b"><ci id="S5.E6.m1.57.57.57.4.4.4.cmml" xref="S5.E6.m1.57.57.57.4.4.4">⋅</ci><ci id="S5.E6.m1.56.56.56.3.3.3.cmml" xref="S5.E6.m1.56.56.56.3.3.3">𝜂</ci><apply id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.cmml" xref="S5.E6.m1.142.142.9b"><plus id="S5.E6.m1.71.71.71.18.18.18.cmml" xref="S5.E6.m1.71.71.71.18.18.18"></plus><apply id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.1.cmml" xref="S5.E6.m1.142.142.9b"><apply id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.1.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.1.2.1.cmml" xref="S5.E6.m1.142.142.9b">superscript</csymbol><apply id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.1.2.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.1.2.2.1.cmml" xref="S5.E6.m1.142.142.9b">subscript</csymbol><sum id="S5.E6.m1.59.59.59.6.6.6.cmml" xref="S5.E6.m1.59.59.59.6.6.6"></sum><apply id="S5.E6.m1.60.60.60.7.7.7.1.cmml" xref="S5.E6.m1.60.60.60.7.7.7.1"><eq id="S5.E6.m1.60.60.60.7.7.7.1.1.cmml" xref="S5.E6.m1.60.60.60.7.7.7.1.1"></eq><ci id="S5.E6.m1.60.60.60.7.7.7.1.2.cmml" xref="S5.E6.m1.60.60.60.7.7.7.1.2">𝑖</ci><cn type="integer" id="S5.E6.m1.60.60.60.7.7.7.1.3.cmml" xref="S5.E6.m1.60.60.60.7.7.7.1.3">1</cn></apply></apply><ci id="S5.E6.m1.61.61.61.8.8.8.1.cmml" xref="S5.E6.m1.61.61.61.8.8.8.1">𝑚</ci></apply><apply id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.1.1.cmml" xref="S5.E6.m1.142.142.9b"><times id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.1.1.2.cmml" xref="S5.E6.m1.142.142.9b"></times><apply id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.1.1.3.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.1.1.3.1.cmml" xref="S5.E6.m1.142.142.9b">superscript</csymbol><apply id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.1.1.3.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.1.1.3.2.1.cmml" xref="S5.E6.m1.142.142.9b">subscript</csymbol><ci id="S5.E6.m1.62.62.62.9.9.9.cmml" xref="S5.E6.m1.62.62.62.9.9.9">𝜆</ci><ci id="S5.E6.m1.63.63.63.10.10.10.1.cmml" xref="S5.E6.m1.63.63.63.10.10.10.1">𝑖</ci></apply><cn type="integer" id="S5.E6.m1.64.64.64.11.11.11.1.cmml" xref="S5.E6.m1.64.64.64.11.11.11.1">2</cn></apply><apply id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.1.1.1.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.1.1.1.2.cmml" xref="S5.E6.m1.142.142.9b">superscript</csymbol><apply id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="latexml" id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.1.1.1.1.2.1.cmml" xref="S5.E6.m1.142.142.9b">delimited-∥∥</csymbol><apply id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E6.m1.142.142.9b">superscript</csymbol><apply id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S5.E6.m1.142.142.9b">subscript</csymbol><ci id="S5.E6.m1.66.66.66.13.13.13a.cmml" xref="S5.E6.m1.66.66.66.13.13.13"><mtext class="ltx_mathvariant_bold" id="S5.E6.m1.66.66.66.13.13.13.cmml" xref="S5.E6.m1.66.66.66.13.13.13">g</mtext></ci><ci id="S5.E6.m1.67.67.67.14.14.14.1.cmml" xref="S5.E6.m1.67.67.67.14.14.14.1">𝑖</ci></apply><ci id="S5.E6.m1.68.68.68.15.15.15.1.cmml" xref="S5.E6.m1.68.68.68.15.15.15.1">𝑡</ci></apply></apply><cn type="integer" id="S5.E6.m1.70.70.70.17.17.17.1.cmml" xref="S5.E6.m1.70.70.70.17.17.17.1">2</cn></apply></apply></apply><apply id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.3.cmml" xref="S5.E6.m1.142.142.9b"><apply id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.3.3.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.3.3.1.cmml" xref="S5.E6.m1.142.142.9b">subscript</csymbol><sum id="S5.E6.m1.72.72.72.19.19.19.cmml" xref="S5.E6.m1.72.72.72.19.19.19"></sum><apply id="S5.E6.m1.73.73.73.20.20.20.1.cmml" xref="S5.E6.m1.73.73.73.20.20.20.1"><neq id="S5.E6.m1.73.73.73.20.20.20.1.4.cmml" xref="S5.E6.m1.73.73.73.20.20.20.1.4"></neq><list id="S5.E6.m1.73.73.73.20.20.20.1.5.1.cmml" xref="S5.E6.m1.73.73.73.20.20.20.1.5.2"><ci id="S5.E6.m1.73.73.73.20.20.20.1.1.cmml" xref="S5.E6.m1.73.73.73.20.20.20.1.1">𝑖</ci><ci id="S5.E6.m1.73.73.73.20.20.20.1.2.cmml" xref="S5.E6.m1.73.73.73.20.20.20.1.2">𝑗</ci><ci id="S5.E6.m1.73.73.73.20.20.20.1.3.cmml" xref="S5.E6.m1.73.73.73.20.20.20.1.3">𝑖</ci></list><ci id="S5.E6.m1.73.73.73.20.20.20.1.6.cmml" xref="S5.E6.m1.73.73.73.20.20.20.1.6">𝑗</ci></apply></apply><apply id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.3.2.cmml" xref="S5.E6.m1.142.142.9b"><times id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.3.2.3.cmml" xref="S5.E6.m1.142.142.9b"></times><apply id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.3.2.4.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.3.2.4.1.cmml" xref="S5.E6.m1.142.142.9b">subscript</csymbol><ci id="S5.E6.m1.74.74.74.21.21.21.cmml" xref="S5.E6.m1.74.74.74.21.21.21">𝜆</ci><ci id="S5.E6.m1.75.75.75.22.22.22.1.cmml" xref="S5.E6.m1.75.75.75.22.22.22.1">𝑖</ci></apply><apply id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.3.2.5.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.3.2.5.1.cmml" xref="S5.E6.m1.142.142.9b">subscript</csymbol><ci id="S5.E6.m1.76.76.76.23.23.23.cmml" xref="S5.E6.m1.76.76.76.23.23.23">𝜆</ci><ci id="S5.E6.m1.77.77.77.24.24.24.1.cmml" xref="S5.E6.m1.77.77.77.24.24.24.1">𝑗</ci></apply><list id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.3.2.2.3.cmml" xref="S5.E6.m1.142.142.9b"><apply id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.2.1.1.1.1.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.2.1.1.1.1.1.cmml" xref="S5.E6.m1.142.142.9b">superscript</csymbol><apply id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.2.1.1.1.1.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.2.1.1.1.1.2.1.cmml" xref="S5.E6.m1.142.142.9b">subscript</csymbol><ci id="S5.E6.m1.79.79.79.26.26.26a.cmml" xref="S5.E6.m1.79.79.79.26.26.26"><mtext class="ltx_mathvariant_bold" id="S5.E6.m1.79.79.79.26.26.26.cmml" xref="S5.E6.m1.79.79.79.26.26.26">g</mtext></ci><ci id="S5.E6.m1.80.80.80.27.27.27.1.cmml" xref="S5.E6.m1.80.80.80.27.27.27.1">𝑖</ci></apply><ci id="S5.E6.m1.81.81.81.28.28.28.1.cmml" xref="S5.E6.m1.81.81.81.28.28.28.1">𝑡</ci></apply><apply id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.3.2.2.2.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.3.2.2.2.2.1.cmml" xref="S5.E6.m1.142.142.9b">superscript</csymbol><apply id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.3.2.2.2.2.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.7.1.1.1.1.3.2.2.2.2.2.1.cmml" xref="S5.E6.m1.142.142.9b">subscript</csymbol><ci id="S5.E6.m1.83.83.83.30.30.30a.cmml" xref="S5.E6.m1.83.83.83.30.30.30"><mtext class="ltx_mathvariant_bold" id="S5.E6.m1.83.83.83.30.30.30.cmml" xref="S5.E6.m1.83.83.83.30.30.30">g</mtext></ci><ci id="S5.E6.m1.84.84.84.31.31.31.1.cmml" xref="S5.E6.m1.84.84.84.31.31.31.1">𝑗</ci></apply><ci id="S5.E6.m1.85.85.85.32.32.32.1.cmml" xref="S5.E6.m1.85.85.85.32.32.32.1">𝑡</ci></apply></list></apply></apply></apply></apply></apply></apply><apply id="S5.E6.m1.134.134.1.1.1i.cmml" xref="S5.E6.m1.142.142.9b"><eq id="S5.E6.m1.88.88.88.1.1.1.cmml" xref="S5.E6.m1.88.88.88.1.1.1"></eq><share href="#S5.E6.m1.134.134.1.1.1.7.cmml" id="S5.E6.m1.134.134.1.1.1j.cmml" xref="S5.E6.m1.142.142.9b"></share><apply id="S5.E6.m1.134.134.1.1.1.8.cmml" xref="S5.E6.m1.142.142.9b"><minus id="S5.E6.m1.89.89.89.2.2.2.cmml" xref="S5.E6.m1.142.142.9b"></minus><apply id="S5.E6.m1.134.134.1.1.1.8.1.cmml" xref="S5.E6.m1.142.142.9b"><ci id="S5.E6.m1.91.91.91.4.4.4.cmml" xref="S5.E6.m1.91.91.91.4.4.4">⋅</ci><ci id="S5.E6.m1.90.90.90.3.3.3.cmml" xref="S5.E6.m1.90.90.90.3.3.3">𝜂</ci><apply id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.cmml" xref="S5.E6.m1.142.142.9b"><plus id="S5.E6.m1.105.105.105.18.18.18.cmml" xref="S5.E6.m1.105.105.105.18.18.18"></plus><apply id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.1.cmml" xref="S5.E6.m1.142.142.9b"><apply id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.1.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.1.2.1.cmml" xref="S5.E6.m1.142.142.9b">superscript</csymbol><apply id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.1.2.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.1.2.2.1.cmml" xref="S5.E6.m1.142.142.9b">subscript</csymbol><sum id="S5.E6.m1.93.93.93.6.6.6.cmml" xref="S5.E6.m1.93.93.93.6.6.6"></sum><apply id="S5.E6.m1.94.94.94.7.7.7.1.cmml" xref="S5.E6.m1.94.94.94.7.7.7.1"><eq id="S5.E6.m1.94.94.94.7.7.7.1.1.cmml" xref="S5.E6.m1.94.94.94.7.7.7.1.1"></eq><ci id="S5.E6.m1.94.94.94.7.7.7.1.2.cmml" xref="S5.E6.m1.94.94.94.7.7.7.1.2">𝑖</ci><cn type="integer" id="S5.E6.m1.94.94.94.7.7.7.1.3.cmml" xref="S5.E6.m1.94.94.94.7.7.7.1.3">1</cn></apply></apply><ci id="S5.E6.m1.95.95.95.8.8.8.1.cmml" xref="S5.E6.m1.95.95.95.8.8.8.1">𝑚</ci></apply><apply id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.1.1.cmml" xref="S5.E6.m1.142.142.9b"><times id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.1.1.2.cmml" xref="S5.E6.m1.142.142.9b"></times><apply id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.1.1.3.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.1.1.3.1.cmml" xref="S5.E6.m1.142.142.9b">superscript</csymbol><apply id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.1.1.3.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.1.1.3.2.1.cmml" xref="S5.E6.m1.142.142.9b">subscript</csymbol><ci id="S5.E6.m1.96.96.96.9.9.9.cmml" xref="S5.E6.m1.96.96.96.9.9.9">𝜆</ci><ci id="S5.E6.m1.97.97.97.10.10.10.1.cmml" xref="S5.E6.m1.97.97.97.10.10.10.1">𝑖</ci></apply><cn type="integer" id="S5.E6.m1.98.98.98.11.11.11.1.cmml" xref="S5.E6.m1.98.98.98.11.11.11.1">2</cn></apply><apply id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.1.1.1.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.1.1.1.2.cmml" xref="S5.E6.m1.142.142.9b">superscript</csymbol><apply id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="latexml" id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.1.1.1.1.2.1.cmml" xref="S5.E6.m1.142.142.9b">delimited-∥∥</csymbol><apply id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E6.m1.142.142.9b">superscript</csymbol><apply id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S5.E6.m1.142.142.9b">subscript</csymbol><ci id="S5.E6.m1.100.100.100.13.13.13a.cmml" xref="S5.E6.m1.100.100.100.13.13.13"><mtext class="ltx_mathvariant_bold" id="S5.E6.m1.100.100.100.13.13.13.cmml" xref="S5.E6.m1.100.100.100.13.13.13">g</mtext></ci><ci id="S5.E6.m1.101.101.101.14.14.14.1.cmml" xref="S5.E6.m1.101.101.101.14.14.14.1">𝑖</ci></apply><ci id="S5.E6.m1.102.102.102.15.15.15.1.cmml" xref="S5.E6.m1.102.102.102.15.15.15.1">𝑡</ci></apply></apply><cn type="integer" id="S5.E6.m1.104.104.104.17.17.17.1.cmml" xref="S5.E6.m1.104.104.104.17.17.17.1">2</cn></apply></apply></apply><apply id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.5.cmml" xref="S5.E6.m1.142.142.9b"><apply id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.5.5.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.5.5.1.cmml" xref="S5.E6.m1.142.142.9b">subscript</csymbol><sum id="S5.E6.m1.106.106.106.19.19.19.cmml" xref="S5.E6.m1.106.106.106.19.19.19"></sum><apply id="S5.E6.m1.107.107.107.20.20.20.1.cmml" xref="S5.E6.m1.107.107.107.20.20.20.1"><neq id="S5.E6.m1.107.107.107.20.20.20.1.4.cmml" xref="S5.E6.m1.107.107.107.20.20.20.1.4"></neq><list id="S5.E6.m1.107.107.107.20.20.20.1.5.1.cmml" xref="S5.E6.m1.107.107.107.20.20.20.1.5.2"><ci id="S5.E6.m1.107.107.107.20.20.20.1.1.cmml" xref="S5.E6.m1.107.107.107.20.20.20.1.1">𝑖</ci><ci id="S5.E6.m1.107.107.107.20.20.20.1.2.cmml" xref="S5.E6.m1.107.107.107.20.20.20.1.2">𝑗</ci><ci id="S5.E6.m1.107.107.107.20.20.20.1.3.cmml" xref="S5.E6.m1.107.107.107.20.20.20.1.3">𝑖</ci></list><ci id="S5.E6.m1.107.107.107.20.20.20.1.6.cmml" xref="S5.E6.m1.107.107.107.20.20.20.1.6">𝑗</ci></apply></apply><apply id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.5.4.cmml" xref="S5.E6.m1.142.142.9b"><times id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.5.4.5.cmml" xref="S5.E6.m1.142.142.9b"></times><apply id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.5.4.6.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.5.4.6.1.cmml" xref="S5.E6.m1.142.142.9b">subscript</csymbol><ci id="S5.E6.m1.108.108.108.21.21.21.cmml" xref="S5.E6.m1.108.108.108.21.21.21">𝜆</ci><ci id="S5.E6.m1.109.109.109.22.22.22.1.cmml" xref="S5.E6.m1.109.109.109.22.22.22.1">𝑖</ci></apply><apply id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.5.4.7.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.5.4.7.1.cmml" xref="S5.E6.m1.142.142.9b">subscript</csymbol><ci id="S5.E6.m1.110.110.110.23.23.23.cmml" xref="S5.E6.m1.110.110.110.23.23.23">𝜆</ci><ci id="S5.E6.m1.111.111.111.24.24.24.1.cmml" xref="S5.E6.m1.111.111.111.24.24.24.1">𝑗</ci></apply><apply id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.3.2.2.3.cmml" xref="S5.E6.m1.142.142.9b"><cos id="S5.E6.m1.112.112.112.25.25.25.cmml" xref="S5.E6.m1.112.112.112.25.25.25"></cos><apply id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.2.1.1.1.1.1.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S5.E6.m1.142.142.9b">superscript</csymbol><apply id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.2.1.1.1.1.1.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.2.1.1.1.1.1.2.1.cmml" xref="S5.E6.m1.142.142.9b">subscript</csymbol><ci id="S5.E6.m1.114.114.114.27.27.27a.cmml" xref="S5.E6.m1.114.114.114.27.27.27"><mtext class="ltx_mathvariant_bold" id="S5.E6.m1.114.114.114.27.27.27.cmml" xref="S5.E6.m1.114.114.114.27.27.27">g</mtext></ci><ci id="S5.E6.m1.115.115.115.28.28.28.1.cmml" xref="S5.E6.m1.115.115.115.28.28.28.1">𝑖</ci></apply><ci id="S5.E6.m1.116.116.116.29.29.29.1.cmml" xref="S5.E6.m1.116.116.116.29.29.29.1">𝑡</ci></apply><apply id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.3.2.2.2.2.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.3.2.2.2.2.2.1.cmml" xref="S5.E6.m1.142.142.9b">superscript</csymbol><apply id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.3.2.2.2.2.2.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.3.2.2.2.2.2.2.1.cmml" xref="S5.E6.m1.142.142.9b">subscript</csymbol><ci id="S5.E6.m1.118.118.118.31.31.31a.cmml" xref="S5.E6.m1.118.118.118.31.31.31"><mtext class="ltx_mathvariant_bold" id="S5.E6.m1.118.118.118.31.31.31.cmml" xref="S5.E6.m1.118.118.118.31.31.31">g</mtext></ci><ci id="S5.E6.m1.119.119.119.32.32.32.1.cmml" xref="S5.E6.m1.119.119.119.32.32.32.1">𝑗</ci></apply><ci id="S5.E6.m1.120.120.120.33.33.33.1.cmml" xref="S5.E6.m1.120.120.120.33.33.33.1">𝑡</ci></apply></apply><apply id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.4.3.3.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="latexml" id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.4.3.3.2.1.cmml" xref="S5.E6.m1.142.142.9b">delimited-∥∥</csymbol><apply id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.4.3.3.1.1.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.4.3.3.1.1.1.cmml" xref="S5.E6.m1.142.142.9b">superscript</csymbol><apply id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.4.3.3.1.1.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.4.3.3.1.1.2.1.cmml" xref="S5.E6.m1.142.142.9b">subscript</csymbol><ci id="S5.E6.m1.123.123.123.36.36.36a.cmml" xref="S5.E6.m1.123.123.123.36.36.36"><mtext class="ltx_mathvariant_bold" id="S5.E6.m1.123.123.123.36.36.36.cmml" xref="S5.E6.m1.123.123.123.36.36.36">g</mtext></ci><ci id="S5.E6.m1.124.124.124.37.37.37.1.cmml" xref="S5.E6.m1.124.124.124.37.37.37.1">𝑖</ci></apply><ci id="S5.E6.m1.125.125.125.38.38.38.1.cmml" xref="S5.E6.m1.125.125.125.38.38.38.1">𝑡</ci></apply></apply><apply id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.5.4.4.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="latexml" id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.5.4.4.2.1.cmml" xref="S5.E6.m1.142.142.9b">delimited-∥∥</csymbol><apply id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.5.4.4.1.1.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.5.4.4.1.1.1.cmml" xref="S5.E6.m1.142.142.9b">superscript</csymbol><apply id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.5.4.4.1.1.2.cmml" xref="S5.E6.m1.142.142.9b"><csymbol cd="ambiguous" id="S5.E6.m1.134.134.1.1.1.8.1.1.1.1.5.4.4.1.1.2.1.cmml" xref="S5.E6.m1.142.142.9b">subscript</csymbol><ci id="S5.E6.m1.128.128.128.41.41.41a.cmml" xref="S5.E6.m1.128.128.128.41.41.41"><mtext class="ltx_mathvariant_bold" id="S5.E6.m1.128.128.128.41.41.41.cmml" xref="S5.E6.m1.128.128.128.41.41.41">g</mtext></ci><ci id="S5.E6.m1.129.129.129.42.42.42.1.cmml" xref="S5.E6.m1.129.129.129.42.42.42.1">𝑗</ci></apply><ci id="S5.E6.m1.130.130.130.43.43.43.1.cmml" xref="S5.E6.m1.130.130.130.43.43.43.1">𝑡</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E6.m1.142c">\displaystyle\begin{split}\displaystyle&amp;\Delta\mathcal{L}^{t}=\mathcal{L}(\mathbf{w}^{t}-\eta\textbf{g}^{t})-\mathcal{L}(\mathbf{w}^{t})\approx-\eta\cdot\langle\textbf{g}^{t},\textbf{g}^{t}\rangle\\
&amp;=-\eta\cdot\langle\sum_{i=1}^{m}\lambda_{i}\textbf{g}_{i}^{t},\sum_{i=1}^{m}\lambda_{i}\textbf{g}_{i}^{t}\rangle\\
&amp;=-\eta\cdot(\sum_{i=1}^{m}\lambda_{i}^{2}\|\textbf{g}_{i}^{t}\|^{2}+\sum_{i,j,i\neq j}\lambda_{i}\lambda_{j}\langle\textbf{g}_{i}^{t},\textbf{g}_{j}^{t}\rangle)\\
&amp;=-\eta\cdot(\sum_{i=1}^{m}\lambda_{i}^{2}\|\textbf{g}_{i}^{t}\|^{2}+\sum_{i,j,i\neq j}\lambda_{i}\lambda_{j}\cos(\textbf{g}_{i}^{t},\textbf{g}_{j}^{t})\|\textbf{g}_{i}^{t}\|\|\textbf{g}_{j}^{t}\|)\,.\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div id="S5.SS1.p4" class="ltx_para">
<p id="S5.SS1.p4.20" class="ltx_p"><a href="#S5.E6" title="Equation 6 ‣ 5.1 Basic Concept and Formulation ‣ 5 Client coherence ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Equation 6</span></a> is a Taylor expansion of the loss function within one update. In mini-batch SGD, <math id="S5.SS1.p4.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S5.SS1.p4.1.m1.1a"><mi id="S5.SS1.p4.1.m1.1.1" xref="S5.SS1.p4.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.1.m1.1b"><ci id="S5.SS1.p4.1.m1.1.1.cmml" xref="S5.SS1.p4.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.1.m1.1c">t</annotation></semantics></math> is the iteration step, <math id="S5.SS1.p4.2.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S5.SS1.p4.2.m2.1a"><mi id="S5.SS1.p4.2.m2.1.1" xref="S5.SS1.p4.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.2.m2.1b"><ci id="S5.SS1.p4.2.m2.1.1.cmml" xref="S5.SS1.p4.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.2.m2.1c">m</annotation></semantics></math> is the batch size, and <math id="S5.SS1.p4.3.m3.1" class="ltx_Math" alttext="\textbf{g}_{i}^{t}" display="inline"><semantics id="S5.SS1.p4.3.m3.1a"><msubsup id="S5.SS1.p4.3.m3.1.1" xref="S5.SS1.p4.3.m3.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S5.SS1.p4.3.m3.1.1.2.2" xref="S5.SS1.p4.3.m3.1.1.2.2a.cmml">g</mtext><mi id="S5.SS1.p4.3.m3.1.1.2.3" xref="S5.SS1.p4.3.m3.1.1.2.3.cmml">i</mi><mi id="S5.SS1.p4.3.m3.1.1.3" xref="S5.SS1.p4.3.m3.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.3.m3.1b"><apply id="S5.SS1.p4.3.m3.1.1.cmml" xref="S5.SS1.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.p4.3.m3.1.1.1.cmml" xref="S5.SS1.p4.3.m3.1.1">superscript</csymbol><apply id="S5.SS1.p4.3.m3.1.1.2.cmml" xref="S5.SS1.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.p4.3.m3.1.1.2.1.cmml" xref="S5.SS1.p4.3.m3.1.1">subscript</csymbol><ci id="S5.SS1.p4.3.m3.1.1.2.2a.cmml" xref="S5.SS1.p4.3.m3.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S5.SS1.p4.3.m3.1.1.2.2.cmml" xref="S5.SS1.p4.3.m3.1.1.2.2">g</mtext></ci><ci id="S5.SS1.p4.3.m3.1.1.2.3.cmml" xref="S5.SS1.p4.3.m3.1.1.2.3">𝑖</ci></apply><ci id="S5.SS1.p4.3.m3.1.1.3.cmml" xref="S5.SS1.p4.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.3.m3.1c">\textbf{g}_{i}^{t}</annotation></semantics></math> is the gradient of a sample <math id="S5.SS1.p4.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S5.SS1.p4.4.m4.1a"><mi id="S5.SS1.p4.4.m4.1.1" xref="S5.SS1.p4.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.4.m4.1b"><ci id="S5.SS1.p4.4.m4.1.1.cmml" xref="S5.SS1.p4.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.4.m4.1c">i</annotation></semantics></math> at iteration <math id="S5.SS1.p4.5.m5.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S5.SS1.p4.5.m5.1a"><mi id="S5.SS1.p4.5.m5.1.1" xref="S5.SS1.p4.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.5.m5.1b"><ci id="S5.SS1.p4.5.m5.1.1.cmml" xref="S5.SS1.p4.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.5.m5.1c">t</annotation></semantics></math>. Typically, there is no weighted averaging in a mini-batch, so <math id="S5.SS1.p4.6.m6.3" class="ltx_Math" alttext="\forall i\in[m],\ \lambda_{i}=1" display="inline"><semantics id="S5.SS1.p4.6.m6.3a"><mrow id="S5.SS1.p4.6.m6.3.3.2" xref="S5.SS1.p4.6.m6.3.3.3.cmml"><mrow id="S5.SS1.p4.6.m6.2.2.1.1" xref="S5.SS1.p4.6.m6.2.2.1.1.cmml"><mrow id="S5.SS1.p4.6.m6.2.2.1.1.2" xref="S5.SS1.p4.6.m6.2.2.1.1.2.cmml"><mo rspace="0.167em" id="S5.SS1.p4.6.m6.2.2.1.1.2.1" xref="S5.SS1.p4.6.m6.2.2.1.1.2.1.cmml">∀</mo><mi id="S5.SS1.p4.6.m6.2.2.1.1.2.2" xref="S5.SS1.p4.6.m6.2.2.1.1.2.2.cmml">i</mi></mrow><mo id="S5.SS1.p4.6.m6.2.2.1.1.1" xref="S5.SS1.p4.6.m6.2.2.1.1.1.cmml">∈</mo><mrow id="S5.SS1.p4.6.m6.2.2.1.1.3.2" xref="S5.SS1.p4.6.m6.2.2.1.1.3.1.cmml"><mo stretchy="false" id="S5.SS1.p4.6.m6.2.2.1.1.3.2.1" xref="S5.SS1.p4.6.m6.2.2.1.1.3.1.1.cmml">[</mo><mi id="S5.SS1.p4.6.m6.1.1" xref="S5.SS1.p4.6.m6.1.1.cmml">m</mi><mo stretchy="false" id="S5.SS1.p4.6.m6.2.2.1.1.3.2.2" xref="S5.SS1.p4.6.m6.2.2.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo rspace="0.667em" id="S5.SS1.p4.6.m6.3.3.2.3" xref="S5.SS1.p4.6.m6.3.3.3a.cmml">,</mo><mrow id="S5.SS1.p4.6.m6.3.3.2.2" xref="S5.SS1.p4.6.m6.3.3.2.2.cmml"><msub id="S5.SS1.p4.6.m6.3.3.2.2.2" xref="S5.SS1.p4.6.m6.3.3.2.2.2.cmml"><mi id="S5.SS1.p4.6.m6.3.3.2.2.2.2" xref="S5.SS1.p4.6.m6.3.3.2.2.2.2.cmml">λ</mi><mi id="S5.SS1.p4.6.m6.3.3.2.2.2.3" xref="S5.SS1.p4.6.m6.3.3.2.2.2.3.cmml">i</mi></msub><mo id="S5.SS1.p4.6.m6.3.3.2.2.1" xref="S5.SS1.p4.6.m6.3.3.2.2.1.cmml">=</mo><mn id="S5.SS1.p4.6.m6.3.3.2.2.3" xref="S5.SS1.p4.6.m6.3.3.2.2.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.6.m6.3b"><apply id="S5.SS1.p4.6.m6.3.3.3.cmml" xref="S5.SS1.p4.6.m6.3.3.2"><csymbol cd="ambiguous" id="S5.SS1.p4.6.m6.3.3.3a.cmml" xref="S5.SS1.p4.6.m6.3.3.2.3">formulae-sequence</csymbol><apply id="S5.SS1.p4.6.m6.2.2.1.1.cmml" xref="S5.SS1.p4.6.m6.2.2.1.1"><in id="S5.SS1.p4.6.m6.2.2.1.1.1.cmml" xref="S5.SS1.p4.6.m6.2.2.1.1.1"></in><apply id="S5.SS1.p4.6.m6.2.2.1.1.2.cmml" xref="S5.SS1.p4.6.m6.2.2.1.1.2"><csymbol cd="latexml" id="S5.SS1.p4.6.m6.2.2.1.1.2.1.cmml" xref="S5.SS1.p4.6.m6.2.2.1.1.2.1">for-all</csymbol><ci id="S5.SS1.p4.6.m6.2.2.1.1.2.2.cmml" xref="S5.SS1.p4.6.m6.2.2.1.1.2.2">𝑖</ci></apply><apply id="S5.SS1.p4.6.m6.2.2.1.1.3.1.cmml" xref="S5.SS1.p4.6.m6.2.2.1.1.3.2"><csymbol cd="latexml" id="S5.SS1.p4.6.m6.2.2.1.1.3.1.1.cmml" xref="S5.SS1.p4.6.m6.2.2.1.1.3.2.1">delimited-[]</csymbol><ci id="S5.SS1.p4.6.m6.1.1.cmml" xref="S5.SS1.p4.6.m6.1.1">𝑚</ci></apply></apply><apply id="S5.SS1.p4.6.m6.3.3.2.2.cmml" xref="S5.SS1.p4.6.m6.3.3.2.2"><eq id="S5.SS1.p4.6.m6.3.3.2.2.1.cmml" xref="S5.SS1.p4.6.m6.3.3.2.2.1"></eq><apply id="S5.SS1.p4.6.m6.3.3.2.2.2.cmml" xref="S5.SS1.p4.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S5.SS1.p4.6.m6.3.3.2.2.2.1.cmml" xref="S5.SS1.p4.6.m6.3.3.2.2.2">subscript</csymbol><ci id="S5.SS1.p4.6.m6.3.3.2.2.2.2.cmml" xref="S5.SS1.p4.6.m6.3.3.2.2.2.2">𝜆</ci><ci id="S5.SS1.p4.6.m6.3.3.2.2.2.3.cmml" xref="S5.SS1.p4.6.m6.3.3.2.2.2.3">𝑖</ci></apply><cn type="integer" id="S5.SS1.p4.6.m6.3.3.2.2.3.cmml" xref="S5.SS1.p4.6.m6.3.3.2.2.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.6.m6.3c">\forall i\in[m],\ \lambda_{i}=1</annotation></semantics></math>. In FL, <math id="S5.SS1.p4.7.m7.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S5.SS1.p4.7.m7.1a"><mi id="S5.SS1.p4.7.m7.1.1" xref="S5.SS1.p4.7.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.7.m7.1b"><ci id="S5.SS1.p4.7.m7.1.1.cmml" xref="S5.SS1.p4.7.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.7.m7.1c">t</annotation></semantics></math> is the communication round, <math id="S5.SS1.p4.8.m8.1" class="ltx_Math" alttext="\mathbf{w}^{t}" display="inline"><semantics id="S5.SS1.p4.8.m8.1a"><msup id="S5.SS1.p4.8.m8.1.1" xref="S5.SS1.p4.8.m8.1.1.cmml"><mi id="S5.SS1.p4.8.m8.1.1.2" xref="S5.SS1.p4.8.m8.1.1.2.cmml">𝐰</mi><mi id="S5.SS1.p4.8.m8.1.1.3" xref="S5.SS1.p4.8.m8.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.8.m8.1b"><apply id="S5.SS1.p4.8.m8.1.1.cmml" xref="S5.SS1.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S5.SS1.p4.8.m8.1.1.1.cmml" xref="S5.SS1.p4.8.m8.1.1">superscript</csymbol><ci id="S5.SS1.p4.8.m8.1.1.2.cmml" xref="S5.SS1.p4.8.m8.1.1.2">𝐰</ci><ci id="S5.SS1.p4.8.m8.1.1.3.cmml" xref="S5.SS1.p4.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.8.m8.1c">\mathbf{w}^{t}</annotation></semantics></math> is the global model on the server at round <math id="S5.SS1.p4.9.m9.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S5.SS1.p4.9.m9.1a"><mi id="S5.SS1.p4.9.m9.1.1" xref="S5.SS1.p4.9.m9.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.9.m9.1b"><ci id="S5.SS1.p4.9.m9.1.1.cmml" xref="S5.SS1.p4.9.m9.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.9.m9.1c">t</annotation></semantics></math>, <math id="S5.SS1.p4.10.m10.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S5.SS1.p4.10.m10.1a"><mi id="S5.SS1.p4.10.m10.1.1" xref="S5.SS1.p4.10.m10.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.10.m10.1b"><ci id="S5.SS1.p4.10.m10.1.1.cmml" xref="S5.SS1.p4.10.m10.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.10.m10.1c">m</annotation></semantics></math> is the cohort size, <math id="S5.SS1.p4.11.m11.1" class="ltx_Math" alttext="\textbf{g}_{i}^{t}" display="inline"><semantics id="S5.SS1.p4.11.m11.1a"><msubsup id="S5.SS1.p4.11.m11.1.1" xref="S5.SS1.p4.11.m11.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S5.SS1.p4.11.m11.1.1.2.2" xref="S5.SS1.p4.11.m11.1.1.2.2a.cmml">g</mtext><mi id="S5.SS1.p4.11.m11.1.1.2.3" xref="S5.SS1.p4.11.m11.1.1.2.3.cmml">i</mi><mi id="S5.SS1.p4.11.m11.1.1.3" xref="S5.SS1.p4.11.m11.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.11.m11.1b"><apply id="S5.SS1.p4.11.m11.1.1.cmml" xref="S5.SS1.p4.11.m11.1.1"><csymbol cd="ambiguous" id="S5.SS1.p4.11.m11.1.1.1.cmml" xref="S5.SS1.p4.11.m11.1.1">superscript</csymbol><apply id="S5.SS1.p4.11.m11.1.1.2.cmml" xref="S5.SS1.p4.11.m11.1.1"><csymbol cd="ambiguous" id="S5.SS1.p4.11.m11.1.1.2.1.cmml" xref="S5.SS1.p4.11.m11.1.1">subscript</csymbol><ci id="S5.SS1.p4.11.m11.1.1.2.2a.cmml" xref="S5.SS1.p4.11.m11.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S5.SS1.p4.11.m11.1.1.2.2.cmml" xref="S5.SS1.p4.11.m11.1.1.2.2">g</mtext></ci><ci id="S5.SS1.p4.11.m11.1.1.2.3.cmml" xref="S5.SS1.p4.11.m11.1.1.2.3">𝑖</ci></apply><ci id="S5.SS1.p4.11.m11.1.1.3.cmml" xref="S5.SS1.p4.11.m11.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.11.m11.1c">\textbf{g}_{i}^{t}</annotation></semantics></math> denotes the local gradient of client <math id="S5.SS1.p4.12.m12.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S5.SS1.p4.12.m12.1a"><mi id="S5.SS1.p4.12.m12.1.1" xref="S5.SS1.p4.12.m12.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.12.m12.1b"><ci id="S5.SS1.p4.12.m12.1.1.cmml" xref="S5.SS1.p4.12.m12.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.12.m12.1c">i</annotation></semantics></math> at round <math id="S5.SS1.p4.13.m13.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S5.SS1.p4.13.m13.1a"><mi id="S5.SS1.p4.13.m13.1.1" xref="S5.SS1.p4.13.m13.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.13.m13.1b"><ci id="S5.SS1.p4.13.m13.1.1.cmml" xref="S5.SS1.p4.13.m13.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.13.m13.1c">t</annotation></semantics></math>, and <math id="S5.SS1.p4.14.m14.1" class="ltx_Math" alttext="\lambda_{i}" display="inline"><semantics id="S5.SS1.p4.14.m14.1a"><msub id="S5.SS1.p4.14.m14.1.1" xref="S5.SS1.p4.14.m14.1.1.cmml"><mi id="S5.SS1.p4.14.m14.1.1.2" xref="S5.SS1.p4.14.m14.1.1.2.cmml">λ</mi><mi id="S5.SS1.p4.14.m14.1.1.3" xref="S5.SS1.p4.14.m14.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.14.m14.1b"><apply id="S5.SS1.p4.14.m14.1.1.cmml" xref="S5.SS1.p4.14.m14.1.1"><csymbol cd="ambiguous" id="S5.SS1.p4.14.m14.1.1.1.cmml" xref="S5.SS1.p4.14.m14.1.1">subscript</csymbol><ci id="S5.SS1.p4.14.m14.1.1.2.cmml" xref="S5.SS1.p4.14.m14.1.1.2">𝜆</ci><ci id="S5.SS1.p4.14.m14.1.1.3.cmml" xref="S5.SS1.p4.14.m14.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.14.m14.1c">\lambda_{i}</annotation></semantics></math> is the aggregation weight of client <math id="S5.SS1.p4.15.m15.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S5.SS1.p4.15.m15.1a"><mi id="S5.SS1.p4.15.m15.1.1" xref="S5.SS1.p4.15.m15.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.15.m15.1b"><ci id="S5.SS1.p4.15.m15.1.1.cmml" xref="S5.SS1.p4.15.m15.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.15.m15.1c">i</annotation></semantics></math>. The term <math id="S5.SS1.p4.16.m16.3" class="ltx_Math" alttext="\cos(\textbf{g}_{i}^{t},\textbf{g}_{j}^{t})" display="inline"><semantics id="S5.SS1.p4.16.m16.3a"><mrow id="S5.SS1.p4.16.m16.3.3.2" xref="S5.SS1.p4.16.m16.3.3.3.cmml"><mi id="S5.SS1.p4.16.m16.1.1" xref="S5.SS1.p4.16.m16.1.1.cmml">cos</mi><mo id="S5.SS1.p4.16.m16.3.3.2a" xref="S5.SS1.p4.16.m16.3.3.3.cmml">⁡</mo><mrow id="S5.SS1.p4.16.m16.3.3.2.2" xref="S5.SS1.p4.16.m16.3.3.3.cmml"><mo stretchy="false" id="S5.SS1.p4.16.m16.3.3.2.2.3" xref="S5.SS1.p4.16.m16.3.3.3.cmml">(</mo><msubsup id="S5.SS1.p4.16.m16.2.2.1.1.1" xref="S5.SS1.p4.16.m16.2.2.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S5.SS1.p4.16.m16.2.2.1.1.1.2.2" xref="S5.SS1.p4.16.m16.2.2.1.1.1.2.2a.cmml">g</mtext><mi id="S5.SS1.p4.16.m16.2.2.1.1.1.2.3" xref="S5.SS1.p4.16.m16.2.2.1.1.1.2.3.cmml">i</mi><mi id="S5.SS1.p4.16.m16.2.2.1.1.1.3" xref="S5.SS1.p4.16.m16.2.2.1.1.1.3.cmml">t</mi></msubsup><mo id="S5.SS1.p4.16.m16.3.3.2.2.4" xref="S5.SS1.p4.16.m16.3.3.3.cmml">,</mo><msubsup id="S5.SS1.p4.16.m16.3.3.2.2.2" xref="S5.SS1.p4.16.m16.3.3.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S5.SS1.p4.16.m16.3.3.2.2.2.2.2" xref="S5.SS1.p4.16.m16.3.3.2.2.2.2.2a.cmml">g</mtext><mi id="S5.SS1.p4.16.m16.3.3.2.2.2.2.3" xref="S5.SS1.p4.16.m16.3.3.2.2.2.2.3.cmml">j</mi><mi id="S5.SS1.p4.16.m16.3.3.2.2.2.3" xref="S5.SS1.p4.16.m16.3.3.2.2.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="S5.SS1.p4.16.m16.3.3.2.2.5" xref="S5.SS1.p4.16.m16.3.3.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.16.m16.3b"><apply id="S5.SS1.p4.16.m16.3.3.3.cmml" xref="S5.SS1.p4.16.m16.3.3.2"><cos id="S5.SS1.p4.16.m16.1.1.cmml" xref="S5.SS1.p4.16.m16.1.1"></cos><apply id="S5.SS1.p4.16.m16.2.2.1.1.1.cmml" xref="S5.SS1.p4.16.m16.2.2.1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p4.16.m16.2.2.1.1.1.1.cmml" xref="S5.SS1.p4.16.m16.2.2.1.1.1">superscript</csymbol><apply id="S5.SS1.p4.16.m16.2.2.1.1.1.2.cmml" xref="S5.SS1.p4.16.m16.2.2.1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p4.16.m16.2.2.1.1.1.2.1.cmml" xref="S5.SS1.p4.16.m16.2.2.1.1.1">subscript</csymbol><ci id="S5.SS1.p4.16.m16.2.2.1.1.1.2.2a.cmml" xref="S5.SS1.p4.16.m16.2.2.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S5.SS1.p4.16.m16.2.2.1.1.1.2.2.cmml" xref="S5.SS1.p4.16.m16.2.2.1.1.1.2.2">g</mtext></ci><ci id="S5.SS1.p4.16.m16.2.2.1.1.1.2.3.cmml" xref="S5.SS1.p4.16.m16.2.2.1.1.1.2.3">𝑖</ci></apply><ci id="S5.SS1.p4.16.m16.2.2.1.1.1.3.cmml" xref="S5.SS1.p4.16.m16.2.2.1.1.1.3">𝑡</ci></apply><apply id="S5.SS1.p4.16.m16.3.3.2.2.2.cmml" xref="S5.SS1.p4.16.m16.3.3.2.2.2"><csymbol cd="ambiguous" id="S5.SS1.p4.16.m16.3.3.2.2.2.1.cmml" xref="S5.SS1.p4.16.m16.3.3.2.2.2">superscript</csymbol><apply id="S5.SS1.p4.16.m16.3.3.2.2.2.2.cmml" xref="S5.SS1.p4.16.m16.3.3.2.2.2"><csymbol cd="ambiguous" id="S5.SS1.p4.16.m16.3.3.2.2.2.2.1.cmml" xref="S5.SS1.p4.16.m16.3.3.2.2.2">subscript</csymbol><ci id="S5.SS1.p4.16.m16.3.3.2.2.2.2.2a.cmml" xref="S5.SS1.p4.16.m16.3.3.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S5.SS1.p4.16.m16.3.3.2.2.2.2.2.cmml" xref="S5.SS1.p4.16.m16.3.3.2.2.2.2.2">g</mtext></ci><ci id="S5.SS1.p4.16.m16.3.3.2.2.2.2.3.cmml" xref="S5.SS1.p4.16.m16.3.3.2.2.2.2.3">𝑗</ci></apply><ci id="S5.SS1.p4.16.m16.3.3.2.2.2.3.cmml" xref="S5.SS1.p4.16.m16.3.3.2.2.2.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.16.m16.3c">\cos(\textbf{g}_{i}^{t},\textbf{g}_{j}^{t})</annotation></semantics></math> means the cosine similarity between the gradients of clients <math id="S5.SS1.p4.17.m17.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S5.SS1.p4.17.m17.1a"><mi id="S5.SS1.p4.17.m17.1.1" xref="S5.SS1.p4.17.m17.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.17.m17.1b"><ci id="S5.SS1.p4.17.m17.1.1.cmml" xref="S5.SS1.p4.17.m17.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.17.m17.1c">i</annotation></semantics></math> and <math id="S5.SS1.p4.18.m18.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S5.SS1.p4.18.m18.1a"><mi id="S5.SS1.p4.18.m18.1.1" xref="S5.SS1.p4.18.m18.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.18.m18.1b"><ci id="S5.SS1.p4.18.m18.1.1.cmml" xref="S5.SS1.p4.18.m18.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.18.m18.1c">j</annotation></semantics></math>, defined as <math id="S5.SS1.p4.19.m19.4" class="ltx_Math" alttext="\nicefrac{{\langle\textbf{g}_{i}^{t},\textbf{g}_{j}^{t}\rangle}}{{\|\textbf{g}_{i}^{t}\|\|\textbf{g}_{j}^{t}\|}}" display="inline"><semantics id="S5.SS1.p4.19.m19.4a"><mrow id="S5.SS1.p4.19.m19.4.4" xref="S5.SS1.p4.19.m19.4.4.cmml"><mpadded voffset="0.3em" id="S5.SS1.p4.19.m19.2.2.2.2" xref="S5.SS1.p4.19.m19.2.2.2.3.cmml"><mo maxsize="70%" minsize="70%" id="S5.SS1.p4.19.m19.2.2.2.2.3" xref="S5.SS1.p4.19.m19.2.2.2.3.cmml">⟨</mo><msubsup id="S5.SS1.p4.19.m19.1.1.1.1.1" xref="S5.SS1.p4.19.m19.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" mathsize="70%" id="S5.SS1.p4.19.m19.1.1.1.1.1.2.2" xref="S5.SS1.p4.19.m19.1.1.1.1.1.2.2a.cmml">g</mtext><mi mathsize="71%" id="S5.SS1.p4.19.m19.1.1.1.1.1.2.3" xref="S5.SS1.p4.19.m19.1.1.1.1.1.2.3.cmml">i</mi><mi mathsize="71%" id="S5.SS1.p4.19.m19.1.1.1.1.1.3" xref="S5.SS1.p4.19.m19.1.1.1.1.1.3.cmml">t</mi></msubsup><mo mathsize="70%" id="S5.SS1.p4.19.m19.2.2.2.2.4" xref="S5.SS1.p4.19.m19.2.2.2.3.cmml">,</mo><msubsup id="S5.SS1.p4.19.m19.2.2.2.2.2" xref="S5.SS1.p4.19.m19.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" mathsize="70%" id="S5.SS1.p4.19.m19.2.2.2.2.2.2.2" xref="S5.SS1.p4.19.m19.2.2.2.2.2.2.2a.cmml">g</mtext><mi mathsize="71%" id="S5.SS1.p4.19.m19.2.2.2.2.2.2.3" xref="S5.SS1.p4.19.m19.2.2.2.2.2.2.3.cmml">j</mi><mi mathsize="71%" id="S5.SS1.p4.19.m19.2.2.2.2.2.3" xref="S5.SS1.p4.19.m19.2.2.2.2.2.3.cmml">t</mi></msubsup><mo maxsize="70%" minsize="70%" id="S5.SS1.p4.19.m19.2.2.2.2.5" xref="S5.SS1.p4.19.m19.2.2.2.3.cmml">⟩</mo></mpadded><mpadded lspace="-0.1em" width="-0.15em" id="S5.SS1.p4.19.m19.4.4.5" xref="S5.SS1.p4.19.m19.4.4.5.cmml"><mo stretchy="true" symmetric="true" id="S5.SS1.p4.19.m19.4.4.5a" xref="S5.SS1.p4.19.m19.4.4.5.cmml">/</mo></mpadded><mrow id="S5.SS1.p4.19.m19.4.4.4" xref="S5.SS1.p4.19.m19.4.4.4.cmml"><mrow id="S5.SS1.p4.19.m19.3.3.3.1.1" xref="S5.SS1.p4.19.m19.3.3.3.1.2.cmml"><mo lspace="0.222em" maxsize="70%" minsize="70%" id="S5.SS1.p4.19.m19.3.3.3.1.1.2" xref="S5.SS1.p4.19.m19.3.3.3.1.2.1.cmml">‖</mo><msubsup id="S5.SS1.p4.19.m19.3.3.3.1.1.1" xref="S5.SS1.p4.19.m19.3.3.3.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" mathsize="70%" id="S5.SS1.p4.19.m19.3.3.3.1.1.1.2.2" xref="S5.SS1.p4.19.m19.3.3.3.1.1.1.2.2a.cmml">g</mtext><mi mathsize="71%" id="S5.SS1.p4.19.m19.3.3.3.1.1.1.2.3" xref="S5.SS1.p4.19.m19.3.3.3.1.1.1.2.3.cmml">i</mi><mi mathsize="71%" id="S5.SS1.p4.19.m19.3.3.3.1.1.1.3" xref="S5.SS1.p4.19.m19.3.3.3.1.1.1.3.cmml">t</mi></msubsup><mo maxsize="70%" minsize="70%" id="S5.SS1.p4.19.m19.3.3.3.1.1.3" xref="S5.SS1.p4.19.m19.3.3.3.1.2.1.cmml">‖</mo></mrow><mo lspace="0em" rspace="0em" id="S5.SS1.p4.19.m19.4.4.4.3" xref="S5.SS1.p4.19.m19.4.4.4.3.cmml">​</mo><mrow id="S5.SS1.p4.19.m19.4.4.4.2.1" xref="S5.SS1.p4.19.m19.4.4.4.2.2.cmml"><mo maxsize="70%" minsize="70%" id="S5.SS1.p4.19.m19.4.4.4.2.1.2" xref="S5.SS1.p4.19.m19.4.4.4.2.2.1.cmml">‖</mo><msubsup id="S5.SS1.p4.19.m19.4.4.4.2.1.1" xref="S5.SS1.p4.19.m19.4.4.4.2.1.1.cmml"><mtext class="ltx_mathvariant_bold" mathsize="70%" id="S5.SS1.p4.19.m19.4.4.4.2.1.1.2.2" xref="S5.SS1.p4.19.m19.4.4.4.2.1.1.2.2a.cmml">g</mtext><mi mathsize="71%" id="S5.SS1.p4.19.m19.4.4.4.2.1.1.2.3" xref="S5.SS1.p4.19.m19.4.4.4.2.1.1.2.3.cmml">j</mi><mi mathsize="71%" id="S5.SS1.p4.19.m19.4.4.4.2.1.1.3" xref="S5.SS1.p4.19.m19.4.4.4.2.1.1.3.cmml">t</mi></msubsup><mo maxsize="70%" minsize="70%" id="S5.SS1.p4.19.m19.4.4.4.2.1.3" xref="S5.SS1.p4.19.m19.4.4.4.2.2.1.cmml">‖</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.19.m19.4b"><apply id="S5.SS1.p4.19.m19.4.4.cmml" xref="S5.SS1.p4.19.m19.4.4"><divide id="S5.SS1.p4.19.m19.4.4.5.cmml" xref="S5.SS1.p4.19.m19.4.4.5"></divide><list id="S5.SS1.p4.19.m19.2.2.2.3.cmml" xref="S5.SS1.p4.19.m19.2.2.2.2"><apply id="S5.SS1.p4.19.m19.1.1.1.1.1.cmml" xref="S5.SS1.p4.19.m19.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p4.19.m19.1.1.1.1.1.1.cmml" xref="S5.SS1.p4.19.m19.1.1.1.1.1">superscript</csymbol><apply id="S5.SS1.p4.19.m19.1.1.1.1.1.2.cmml" xref="S5.SS1.p4.19.m19.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p4.19.m19.1.1.1.1.1.2.1.cmml" xref="S5.SS1.p4.19.m19.1.1.1.1.1">subscript</csymbol><ci id="S5.SS1.p4.19.m19.1.1.1.1.1.2.2a.cmml" xref="S5.SS1.p4.19.m19.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" mathsize="70%" id="S5.SS1.p4.19.m19.1.1.1.1.1.2.2.cmml" xref="S5.SS1.p4.19.m19.1.1.1.1.1.2.2">g</mtext></ci><ci id="S5.SS1.p4.19.m19.1.1.1.1.1.2.3.cmml" xref="S5.SS1.p4.19.m19.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S5.SS1.p4.19.m19.1.1.1.1.1.3.cmml" xref="S5.SS1.p4.19.m19.1.1.1.1.1.3">𝑡</ci></apply><apply id="S5.SS1.p4.19.m19.2.2.2.2.2.cmml" xref="S5.SS1.p4.19.m19.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS1.p4.19.m19.2.2.2.2.2.1.cmml" xref="S5.SS1.p4.19.m19.2.2.2.2.2">superscript</csymbol><apply id="S5.SS1.p4.19.m19.2.2.2.2.2.2.cmml" xref="S5.SS1.p4.19.m19.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS1.p4.19.m19.2.2.2.2.2.2.1.cmml" xref="S5.SS1.p4.19.m19.2.2.2.2.2">subscript</csymbol><ci id="S5.SS1.p4.19.m19.2.2.2.2.2.2.2a.cmml" xref="S5.SS1.p4.19.m19.2.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" mathsize="70%" id="S5.SS1.p4.19.m19.2.2.2.2.2.2.2.cmml" xref="S5.SS1.p4.19.m19.2.2.2.2.2.2.2">g</mtext></ci><ci id="S5.SS1.p4.19.m19.2.2.2.2.2.2.3.cmml" xref="S5.SS1.p4.19.m19.2.2.2.2.2.2.3">𝑗</ci></apply><ci id="S5.SS1.p4.19.m19.2.2.2.2.2.3.cmml" xref="S5.SS1.p4.19.m19.2.2.2.2.2.3">𝑡</ci></apply></list><apply id="S5.SS1.p4.19.m19.4.4.4.cmml" xref="S5.SS1.p4.19.m19.4.4.4"><times id="S5.SS1.p4.19.m19.4.4.4.3.cmml" xref="S5.SS1.p4.19.m19.4.4.4.3"></times><apply id="S5.SS1.p4.19.m19.3.3.3.1.2.cmml" xref="S5.SS1.p4.19.m19.3.3.3.1.1"><csymbol cd="latexml" id="S5.SS1.p4.19.m19.3.3.3.1.2.1.cmml" xref="S5.SS1.p4.19.m19.3.3.3.1.1.2">norm</csymbol><apply id="S5.SS1.p4.19.m19.3.3.3.1.1.1.cmml" xref="S5.SS1.p4.19.m19.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p4.19.m19.3.3.3.1.1.1.1.cmml" xref="S5.SS1.p4.19.m19.3.3.3.1.1.1">superscript</csymbol><apply id="S5.SS1.p4.19.m19.3.3.3.1.1.1.2.cmml" xref="S5.SS1.p4.19.m19.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p4.19.m19.3.3.3.1.1.1.2.1.cmml" xref="S5.SS1.p4.19.m19.3.3.3.1.1.1">subscript</csymbol><ci id="S5.SS1.p4.19.m19.3.3.3.1.1.1.2.2a.cmml" xref="S5.SS1.p4.19.m19.3.3.3.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" mathsize="70%" id="S5.SS1.p4.19.m19.3.3.3.1.1.1.2.2.cmml" xref="S5.SS1.p4.19.m19.3.3.3.1.1.1.2.2">g</mtext></ci><ci id="S5.SS1.p4.19.m19.3.3.3.1.1.1.2.3.cmml" xref="S5.SS1.p4.19.m19.3.3.3.1.1.1.2.3">𝑖</ci></apply><ci id="S5.SS1.p4.19.m19.3.3.3.1.1.1.3.cmml" xref="S5.SS1.p4.19.m19.3.3.3.1.1.1.3">𝑡</ci></apply></apply><apply id="S5.SS1.p4.19.m19.4.4.4.2.2.cmml" xref="S5.SS1.p4.19.m19.4.4.4.2.1"><csymbol cd="latexml" id="S5.SS1.p4.19.m19.4.4.4.2.2.1.cmml" xref="S5.SS1.p4.19.m19.4.4.4.2.1.2">norm</csymbol><apply id="S5.SS1.p4.19.m19.4.4.4.2.1.1.cmml" xref="S5.SS1.p4.19.m19.4.4.4.2.1.1"><csymbol cd="ambiguous" id="S5.SS1.p4.19.m19.4.4.4.2.1.1.1.cmml" xref="S5.SS1.p4.19.m19.4.4.4.2.1.1">superscript</csymbol><apply id="S5.SS1.p4.19.m19.4.4.4.2.1.1.2.cmml" xref="S5.SS1.p4.19.m19.4.4.4.2.1.1"><csymbol cd="ambiguous" id="S5.SS1.p4.19.m19.4.4.4.2.1.1.2.1.cmml" xref="S5.SS1.p4.19.m19.4.4.4.2.1.1">subscript</csymbol><ci id="S5.SS1.p4.19.m19.4.4.4.2.1.1.2.2a.cmml" xref="S5.SS1.p4.19.m19.4.4.4.2.1.1.2.2"><mtext class="ltx_mathvariant_bold" mathsize="70%" id="S5.SS1.p4.19.m19.4.4.4.2.1.1.2.2.cmml" xref="S5.SS1.p4.19.m19.4.4.4.2.1.1.2.2">g</mtext></ci><ci id="S5.SS1.p4.19.m19.4.4.4.2.1.1.2.3.cmml" xref="S5.SS1.p4.19.m19.4.4.4.2.1.1.2.3">𝑗</ci></apply><ci id="S5.SS1.p4.19.m19.4.4.4.2.1.1.3.cmml" xref="S5.SS1.p4.19.m19.4.4.4.2.1.1.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.19.m19.4c">\nicefrac{{\langle\textbf{g}_{i}^{t},\textbf{g}_{j}^{t}\rangle}}{{\|\textbf{g}_{i}^{t}\|\|\textbf{g}_{j}^{t}\|}}</annotation></semantics></math>. Assuming all gradients have bounded norms that <math id="S5.SS1.p4.20.m20.2" class="ltx_Math" alttext="\forall i,\|\textbf{g}_{i}^{t}\|\leq\epsilon" display="inline"><semantics id="S5.SS1.p4.20.m20.2a"><mrow id="S5.SS1.p4.20.m20.2.2" xref="S5.SS1.p4.20.m20.2.2.cmml"><mrow id="S5.SS1.p4.20.m20.2.2.2.2" xref="S5.SS1.p4.20.m20.2.2.2.3.cmml"><mrow id="S5.SS1.p4.20.m20.1.1.1.1.1" xref="S5.SS1.p4.20.m20.1.1.1.1.1.cmml"><mo rspace="0.167em" id="S5.SS1.p4.20.m20.1.1.1.1.1.1" xref="S5.SS1.p4.20.m20.1.1.1.1.1.1.cmml">∀</mo><mi id="S5.SS1.p4.20.m20.1.1.1.1.1.2" xref="S5.SS1.p4.20.m20.1.1.1.1.1.2.cmml">i</mi></mrow><mo id="S5.SS1.p4.20.m20.2.2.2.2.3" xref="S5.SS1.p4.20.m20.2.2.2.3.cmml">,</mo><mrow id="S5.SS1.p4.20.m20.2.2.2.2.2.1" xref="S5.SS1.p4.20.m20.2.2.2.2.2.2.cmml"><mo stretchy="false" id="S5.SS1.p4.20.m20.2.2.2.2.2.1.2" xref="S5.SS1.p4.20.m20.2.2.2.2.2.2.1.cmml">‖</mo><msubsup id="S5.SS1.p4.20.m20.2.2.2.2.2.1.1" xref="S5.SS1.p4.20.m20.2.2.2.2.2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S5.SS1.p4.20.m20.2.2.2.2.2.1.1.2.2" xref="S5.SS1.p4.20.m20.2.2.2.2.2.1.1.2.2a.cmml">g</mtext><mi id="S5.SS1.p4.20.m20.2.2.2.2.2.1.1.2.3" xref="S5.SS1.p4.20.m20.2.2.2.2.2.1.1.2.3.cmml">i</mi><mi id="S5.SS1.p4.20.m20.2.2.2.2.2.1.1.3" xref="S5.SS1.p4.20.m20.2.2.2.2.2.1.1.3.cmml">t</mi></msubsup><mo stretchy="false" id="S5.SS1.p4.20.m20.2.2.2.2.2.1.3" xref="S5.SS1.p4.20.m20.2.2.2.2.2.2.1.cmml">‖</mo></mrow></mrow><mo id="S5.SS1.p4.20.m20.2.2.3" xref="S5.SS1.p4.20.m20.2.2.3.cmml">≤</mo><mi id="S5.SS1.p4.20.m20.2.2.4" xref="S5.SS1.p4.20.m20.2.2.4.cmml">ϵ</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.20.m20.2b"><apply id="S5.SS1.p4.20.m20.2.2.cmml" xref="S5.SS1.p4.20.m20.2.2"><leq id="S5.SS1.p4.20.m20.2.2.3.cmml" xref="S5.SS1.p4.20.m20.2.2.3"></leq><list id="S5.SS1.p4.20.m20.2.2.2.3.cmml" xref="S5.SS1.p4.20.m20.2.2.2.2"><apply id="S5.SS1.p4.20.m20.1.1.1.1.1.cmml" xref="S5.SS1.p4.20.m20.1.1.1.1.1"><csymbol cd="latexml" id="S5.SS1.p4.20.m20.1.1.1.1.1.1.cmml" xref="S5.SS1.p4.20.m20.1.1.1.1.1.1">for-all</csymbol><ci id="S5.SS1.p4.20.m20.1.1.1.1.1.2.cmml" xref="S5.SS1.p4.20.m20.1.1.1.1.1.2">𝑖</ci></apply><apply id="S5.SS1.p4.20.m20.2.2.2.2.2.2.cmml" xref="S5.SS1.p4.20.m20.2.2.2.2.2.1"><csymbol cd="latexml" id="S5.SS1.p4.20.m20.2.2.2.2.2.2.1.cmml" xref="S5.SS1.p4.20.m20.2.2.2.2.2.1.2">norm</csymbol><apply id="S5.SS1.p4.20.m20.2.2.2.2.2.1.1.cmml" xref="S5.SS1.p4.20.m20.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S5.SS1.p4.20.m20.2.2.2.2.2.1.1.1.cmml" xref="S5.SS1.p4.20.m20.2.2.2.2.2.1.1">superscript</csymbol><apply id="S5.SS1.p4.20.m20.2.2.2.2.2.1.1.2.cmml" xref="S5.SS1.p4.20.m20.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S5.SS1.p4.20.m20.2.2.2.2.2.1.1.2.1.cmml" xref="S5.SS1.p4.20.m20.2.2.2.2.2.1.1">subscript</csymbol><ci id="S5.SS1.p4.20.m20.2.2.2.2.2.1.1.2.2a.cmml" xref="S5.SS1.p4.20.m20.2.2.2.2.2.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S5.SS1.p4.20.m20.2.2.2.2.2.1.1.2.2.cmml" xref="S5.SS1.p4.20.m20.2.2.2.2.2.1.1.2.2">g</mtext></ci><ci id="S5.SS1.p4.20.m20.2.2.2.2.2.1.1.2.3.cmml" xref="S5.SS1.p4.20.m20.2.2.2.2.2.1.1.2.3">𝑖</ci></apply><ci id="S5.SS1.p4.20.m20.2.2.2.2.2.1.1.3.cmml" xref="S5.SS1.p4.20.m20.2.2.2.2.2.1.1.3">𝑡</ci></apply></apply></list><ci id="S5.SS1.p4.20.m20.2.2.4.cmml" xref="S5.SS1.p4.20.m20.2.2.4">italic-ϵ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.20.m20.2c">\forall i,\|\textbf{g}_{i}^{t}\|\leq\epsilon</annotation></semantics></math>. The cosine similarity among gradients indicates the coherence: if the gradients have larger cosine similarity, it will have larger descent in the loss and improve the global generalization<span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>The local gradient coherence is different from gradient diversity <cite class="ltx_cite ltx_citemacro_citep">(Yin et al., <a href="#bib.bib55" title="" class="ltx_ref">2018</a>)</cite>. A detailed discussion can be found in <a href="#A2.SS2" title="B.2 Client Coherence ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">subsection B.2</span></a> in Appendix</span></span></span>. In this paper, we focus on the local gradient coherence among clients during FL training. We use the cosine stiffness definition <cite class="ltx_cite ltx_citemacro_citep">(Fort et al., <a href="#bib.bib15" title="" class="ltx_ref">2019</a>)</cite> to quantify the local gradient coherence in FL.</p>
</div>
<div id="S5.Thmtheorem1" class="ltx_theorem ltx_theorem_definition">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="S5.Thmtheorem1.1.1.1" class="ltx_text ltx_font_bold">Definition 5.1</span></span><span id="S5.Thmtheorem1.2.2" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="S5.Thmtheorem1.p1" class="ltx_para">
<p id="S5.Thmtheorem1.p1.6" class="ltx_p">The local gradient coherence of <span id="S5.Thmtheorem1.p1.2.2" class="ltx_text ltx_font_italic">two clients <math id="S5.Thmtheorem1.p1.1.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S5.Thmtheorem1.p1.1.1.m1.1a"><mi id="S5.Thmtheorem1.p1.1.1.m1.1.1" xref="S5.Thmtheorem1.p1.1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.Thmtheorem1.p1.1.1.m1.1b"><ci id="S5.Thmtheorem1.p1.1.1.m1.1.1.cmml" xref="S5.Thmtheorem1.p1.1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.Thmtheorem1.p1.1.1.m1.1c">i</annotation></semantics></math> and <math id="S5.Thmtheorem1.p1.2.2.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S5.Thmtheorem1.p1.2.2.m2.1a"><mi id="S5.Thmtheorem1.p1.2.2.m2.1.1" xref="S5.Thmtheorem1.p1.2.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S5.Thmtheorem1.p1.2.2.m2.1b"><ci id="S5.Thmtheorem1.p1.2.2.m2.1.1.cmml" xref="S5.Thmtheorem1.p1.2.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.Thmtheorem1.p1.2.2.m2.1c">j</annotation></semantics></math></span> at round <math id="S5.Thmtheorem1.p1.3.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S5.Thmtheorem1.p1.3.m1.1a"><mi id="S5.Thmtheorem1.p1.3.m1.1.1" xref="S5.Thmtheorem1.p1.3.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S5.Thmtheorem1.p1.3.m1.1b"><ci id="S5.Thmtheorem1.p1.3.m1.1.1.cmml" xref="S5.Thmtheorem1.p1.3.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.Thmtheorem1.p1.3.m1.1c">t</annotation></semantics></math> is defined by the cosine similarity of their local updates sent to the server, as <math id="S5.Thmtheorem1.p1.4.m2.5" class="ltx_Math" alttext="c_{(i,j)}^{t}=\cos(\textbf{g}_{i}^{t},\textbf{g}_{j}^{t})" display="inline"><semantics id="S5.Thmtheorem1.p1.4.m2.5a"><mrow id="S5.Thmtheorem1.p1.4.m2.5.5" xref="S5.Thmtheorem1.p1.4.m2.5.5.cmml"><msubsup id="S5.Thmtheorem1.p1.4.m2.5.5.4" xref="S5.Thmtheorem1.p1.4.m2.5.5.4.cmml"><mi id="S5.Thmtheorem1.p1.4.m2.5.5.4.2.2" xref="S5.Thmtheorem1.p1.4.m2.5.5.4.2.2.cmml">c</mi><mrow id="S5.Thmtheorem1.p1.4.m2.2.2.2.4" xref="S5.Thmtheorem1.p1.4.m2.2.2.2.3.cmml"><mo stretchy="false" id="S5.Thmtheorem1.p1.4.m2.2.2.2.4.1" xref="S5.Thmtheorem1.p1.4.m2.2.2.2.3.cmml">(</mo><mi id="S5.Thmtheorem1.p1.4.m2.1.1.1.1" xref="S5.Thmtheorem1.p1.4.m2.1.1.1.1.cmml">i</mi><mo id="S5.Thmtheorem1.p1.4.m2.2.2.2.4.2" xref="S5.Thmtheorem1.p1.4.m2.2.2.2.3.cmml">,</mo><mi id="S5.Thmtheorem1.p1.4.m2.2.2.2.2" xref="S5.Thmtheorem1.p1.4.m2.2.2.2.2.cmml">j</mi><mo stretchy="false" id="S5.Thmtheorem1.p1.4.m2.2.2.2.4.3" xref="S5.Thmtheorem1.p1.4.m2.2.2.2.3.cmml">)</mo></mrow><mi id="S5.Thmtheorem1.p1.4.m2.5.5.4.3" xref="S5.Thmtheorem1.p1.4.m2.5.5.4.3.cmml">t</mi></msubsup><mo id="S5.Thmtheorem1.p1.4.m2.5.5.3" xref="S5.Thmtheorem1.p1.4.m2.5.5.3.cmml">=</mo><mrow id="S5.Thmtheorem1.p1.4.m2.5.5.2.2" xref="S5.Thmtheorem1.p1.4.m2.5.5.2.3.cmml"><mi id="S5.Thmtheorem1.p1.4.m2.3.3" xref="S5.Thmtheorem1.p1.4.m2.3.3.cmml">cos</mi><mo id="S5.Thmtheorem1.p1.4.m2.5.5.2.2a" xref="S5.Thmtheorem1.p1.4.m2.5.5.2.3.cmml">⁡</mo><mrow id="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2" xref="S5.Thmtheorem1.p1.4.m2.5.5.2.3.cmml"><mo stretchy="false" id="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2.3" xref="S5.Thmtheorem1.p1.4.m2.5.5.2.3.cmml">(</mo><msubsup id="S5.Thmtheorem1.p1.4.m2.4.4.1.1.1.1" xref="S5.Thmtheorem1.p1.4.m2.4.4.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S5.Thmtheorem1.p1.4.m2.4.4.1.1.1.1.2.2" xref="S5.Thmtheorem1.p1.4.m2.4.4.1.1.1.1.2.2a.cmml">g</mtext><mi id="S5.Thmtheorem1.p1.4.m2.4.4.1.1.1.1.2.3" xref="S5.Thmtheorem1.p1.4.m2.4.4.1.1.1.1.2.3.cmml">i</mi><mi id="S5.Thmtheorem1.p1.4.m2.4.4.1.1.1.1.3" xref="S5.Thmtheorem1.p1.4.m2.4.4.1.1.1.1.3.cmml">t</mi></msubsup><mo id="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2.4" xref="S5.Thmtheorem1.p1.4.m2.5.5.2.3.cmml">,</mo><msubsup id="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2.2" xref="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2.2.2.2" xref="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2.2.2.2a.cmml">g</mtext><mi id="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2.2.2.3" xref="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2.2.2.3.cmml">j</mi><mi id="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2.2.3" xref="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2.5" xref="S5.Thmtheorem1.p1.4.m2.5.5.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.Thmtheorem1.p1.4.m2.5b"><apply id="S5.Thmtheorem1.p1.4.m2.5.5.cmml" xref="S5.Thmtheorem1.p1.4.m2.5.5"><eq id="S5.Thmtheorem1.p1.4.m2.5.5.3.cmml" xref="S5.Thmtheorem1.p1.4.m2.5.5.3"></eq><apply id="S5.Thmtheorem1.p1.4.m2.5.5.4.cmml" xref="S5.Thmtheorem1.p1.4.m2.5.5.4"><csymbol cd="ambiguous" id="S5.Thmtheorem1.p1.4.m2.5.5.4.1.cmml" xref="S5.Thmtheorem1.p1.4.m2.5.5.4">superscript</csymbol><apply id="S5.Thmtheorem1.p1.4.m2.5.5.4.2.cmml" xref="S5.Thmtheorem1.p1.4.m2.5.5.4"><csymbol cd="ambiguous" id="S5.Thmtheorem1.p1.4.m2.5.5.4.2.1.cmml" xref="S5.Thmtheorem1.p1.4.m2.5.5.4">subscript</csymbol><ci id="S5.Thmtheorem1.p1.4.m2.5.5.4.2.2.cmml" xref="S5.Thmtheorem1.p1.4.m2.5.5.4.2.2">𝑐</ci><interval closure="open" id="S5.Thmtheorem1.p1.4.m2.2.2.2.3.cmml" xref="S5.Thmtheorem1.p1.4.m2.2.2.2.4"><ci id="S5.Thmtheorem1.p1.4.m2.1.1.1.1.cmml" xref="S5.Thmtheorem1.p1.4.m2.1.1.1.1">𝑖</ci><ci id="S5.Thmtheorem1.p1.4.m2.2.2.2.2.cmml" xref="S5.Thmtheorem1.p1.4.m2.2.2.2.2">𝑗</ci></interval></apply><ci id="S5.Thmtheorem1.p1.4.m2.5.5.4.3.cmml" xref="S5.Thmtheorem1.p1.4.m2.5.5.4.3">𝑡</ci></apply><apply id="S5.Thmtheorem1.p1.4.m2.5.5.2.3.cmml" xref="S5.Thmtheorem1.p1.4.m2.5.5.2.2"><cos id="S5.Thmtheorem1.p1.4.m2.3.3.cmml" xref="S5.Thmtheorem1.p1.4.m2.3.3"></cos><apply id="S5.Thmtheorem1.p1.4.m2.4.4.1.1.1.1.cmml" xref="S5.Thmtheorem1.p1.4.m2.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S5.Thmtheorem1.p1.4.m2.4.4.1.1.1.1.1.cmml" xref="S5.Thmtheorem1.p1.4.m2.4.4.1.1.1.1">superscript</csymbol><apply id="S5.Thmtheorem1.p1.4.m2.4.4.1.1.1.1.2.cmml" xref="S5.Thmtheorem1.p1.4.m2.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S5.Thmtheorem1.p1.4.m2.4.4.1.1.1.1.2.1.cmml" xref="S5.Thmtheorem1.p1.4.m2.4.4.1.1.1.1">subscript</csymbol><ci id="S5.Thmtheorem1.p1.4.m2.4.4.1.1.1.1.2.2a.cmml" xref="S5.Thmtheorem1.p1.4.m2.4.4.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S5.Thmtheorem1.p1.4.m2.4.4.1.1.1.1.2.2.cmml" xref="S5.Thmtheorem1.p1.4.m2.4.4.1.1.1.1.2.2">g</mtext></ci><ci id="S5.Thmtheorem1.p1.4.m2.4.4.1.1.1.1.2.3.cmml" xref="S5.Thmtheorem1.p1.4.m2.4.4.1.1.1.1.2.3">𝑖</ci></apply><ci id="S5.Thmtheorem1.p1.4.m2.4.4.1.1.1.1.3.cmml" xref="S5.Thmtheorem1.p1.4.m2.4.4.1.1.1.1.3">𝑡</ci></apply><apply id="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2.2.cmml" xref="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2.2.1.cmml" xref="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2.2">superscript</csymbol><apply id="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2.2.2.cmml" xref="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2.2.2.1.cmml" xref="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2.2">subscript</csymbol><ci id="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2.2.2.2a.cmml" xref="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2.2.2.2.cmml" xref="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2.2.2.2">g</mtext></ci><ci id="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2.2.2.3.cmml" xref="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2.2.2.3">𝑗</ci></apply><ci id="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2.2.3.cmml" xref="S5.Thmtheorem1.p1.4.m2.5.5.2.2.2.2.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Thmtheorem1.p1.4.m2.5c">c_{(i,j)}^{t}=\cos(\textbf{g}_{i}^{t},\textbf{g}_{j}^{t})</annotation></semantics></math>.
<br class="ltx_break">The overall local gradient coherence of <span id="S5.Thmtheorem1.p1.6.3" class="ltx_text ltx_font_italic">a cohort of clients</span> at round <math id="S5.Thmtheorem1.p1.5.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S5.Thmtheorem1.p1.5.m3.1a"><mi id="S5.Thmtheorem1.p1.5.m3.1.1" xref="S5.Thmtheorem1.p1.5.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S5.Thmtheorem1.p1.5.m3.1b"><ci id="S5.Thmtheorem1.p1.5.m3.1.1.cmml" xref="S5.Thmtheorem1.p1.5.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.Thmtheorem1.p1.5.m3.1c">t</annotation></semantics></math> is defined by the weighted cosine similarity of all clients’ local updates sent to the server, as <math id="S5.Thmtheorem1.p1.6.m4.6" class="ltx_Math" alttext="\boldsymbol{c_{cohort}^{t}}=\frac{1}{m}\sum_{i,j,i\neq j}\lambda_{i}\lambda_{j}\cos(\textbf{g}_{i}^{t},\textbf{g}_{j}^{t})" display="inline"><semantics id="S5.Thmtheorem1.p1.6.m4.6a"><mrow id="S5.Thmtheorem1.p1.6.m4.6.6" xref="S5.Thmtheorem1.p1.6.m4.6.6.cmml"><msubsup id="S5.Thmtheorem1.p1.6.m4.6.6.4" xref="S5.Thmtheorem1.p1.6.m4.6.6.4.cmml"><mi id="S5.Thmtheorem1.p1.6.m4.6.6.4.2.2" xref="S5.Thmtheorem1.p1.6.m4.6.6.4.2.2.cmml">𝒄</mi><mrow id="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3" xref="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.cmml"><mi id="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.2" xref="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.2.cmml">𝒄</mi><mo lspace="0em" rspace="0em" id="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.1" xref="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.1.cmml">​</mo><mi id="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.3" xref="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.3.cmml">𝒐</mi><mo lspace="0em" rspace="0em" id="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.1a" xref="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.1.cmml">​</mo><mi id="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.4" xref="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.4.cmml">𝒉</mi><mo lspace="0em" rspace="0em" id="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.1b" xref="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.1.cmml">​</mo><mi id="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.5" xref="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.5.cmml">𝒐</mi><mo lspace="0em" rspace="0em" id="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.1c" xref="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.1.cmml">​</mo><mi id="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.6" xref="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.6.cmml">𝒓</mi><mo lspace="0em" rspace="0em" id="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.1d" xref="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.1.cmml">​</mo><mi id="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.7" xref="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.7.cmml">𝒕</mi></mrow><mi id="S5.Thmtheorem1.p1.6.m4.6.6.4.3" xref="S5.Thmtheorem1.p1.6.m4.6.6.4.3.cmml">𝒕</mi></msubsup><mo id="S5.Thmtheorem1.p1.6.m4.6.6.3" xref="S5.Thmtheorem1.p1.6.m4.6.6.3.cmml">=</mo><mrow id="S5.Thmtheorem1.p1.6.m4.6.6.2" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.cmml"><mfrac id="S5.Thmtheorem1.p1.6.m4.6.6.2.4" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.4.cmml"><mn id="S5.Thmtheorem1.p1.6.m4.6.6.2.4.2" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.4.2.cmml">1</mn><mi id="S5.Thmtheorem1.p1.6.m4.6.6.2.4.3" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.4.3.cmml">m</mi></mfrac><mo lspace="0em" rspace="0em" id="S5.Thmtheorem1.p1.6.m4.6.6.2.3" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.3.cmml">​</mo><mrow id="S5.Thmtheorem1.p1.6.m4.6.6.2.2" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.cmml"><msub id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.3" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.3.cmml"><mo id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.3.2" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.3.2.cmml">∑</mo><mrow id="S5.Thmtheorem1.p1.6.m4.3.3.3" xref="S5.Thmtheorem1.p1.6.m4.3.3.3.cmml"><mrow id="S5.Thmtheorem1.p1.6.m4.3.3.3.5.2" xref="S5.Thmtheorem1.p1.6.m4.3.3.3.5.1.cmml"><mi id="S5.Thmtheorem1.p1.6.m4.1.1.1.1" xref="S5.Thmtheorem1.p1.6.m4.1.1.1.1.cmml">i</mi><mo id="S5.Thmtheorem1.p1.6.m4.3.3.3.5.2.1" xref="S5.Thmtheorem1.p1.6.m4.3.3.3.5.1.cmml">,</mo><mi id="S5.Thmtheorem1.p1.6.m4.2.2.2.2" xref="S5.Thmtheorem1.p1.6.m4.2.2.2.2.cmml">j</mi><mo id="S5.Thmtheorem1.p1.6.m4.3.3.3.5.2.2" xref="S5.Thmtheorem1.p1.6.m4.3.3.3.5.1.cmml">,</mo><mi id="S5.Thmtheorem1.p1.6.m4.3.3.3.3" xref="S5.Thmtheorem1.p1.6.m4.3.3.3.3.cmml">i</mi></mrow><mo id="S5.Thmtheorem1.p1.6.m4.3.3.3.4" xref="S5.Thmtheorem1.p1.6.m4.3.3.3.4.cmml">≠</mo><mi id="S5.Thmtheorem1.p1.6.m4.3.3.3.6" xref="S5.Thmtheorem1.p1.6.m4.3.3.3.6.cmml">j</mi></mrow></msub><mrow id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.cmml"><msub id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.4" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.4.cmml"><mi id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.4.2" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.4.2.cmml">λ</mi><mi id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.4.3" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.3" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.3.cmml">​</mo><msub id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.5" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.5.cmml"><mi id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.5.2" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.5.2.cmml">λ</mi><mi id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.5.3" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.5.3.cmml">j</mi></msub><mo lspace="0.167em" rspace="0em" id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.3a" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.3.cmml">​</mo><mrow id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.3.cmml"><mi id="S5.Thmtheorem1.p1.6.m4.4.4" xref="S5.Thmtheorem1.p1.6.m4.4.4.cmml">cos</mi><mo id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2a" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.3.cmml">⁡</mo><mrow id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.3.cmml"><mo stretchy="false" id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2.3" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.3.cmml">(</mo><msubsup id="S5.Thmtheorem1.p1.6.m4.5.5.1.1.1.1.1.1.1" xref="S5.Thmtheorem1.p1.6.m4.5.5.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S5.Thmtheorem1.p1.6.m4.5.5.1.1.1.1.1.1.1.2.2" xref="S5.Thmtheorem1.p1.6.m4.5.5.1.1.1.1.1.1.1.2.2a.cmml">g</mtext><mi id="S5.Thmtheorem1.p1.6.m4.5.5.1.1.1.1.1.1.1.2.3" xref="S5.Thmtheorem1.p1.6.m4.5.5.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S5.Thmtheorem1.p1.6.m4.5.5.1.1.1.1.1.1.1.3" xref="S5.Thmtheorem1.p1.6.m4.5.5.1.1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2.4" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.3.cmml">,</mo><msubsup id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2.2" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2.2.2.2" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2.2.2.2a.cmml">g</mtext><mi id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2.2.2.3" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2.2.2.3.cmml">j</mi><mi id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2.2.3" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2.5" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.Thmtheorem1.p1.6.m4.6b"><apply id="S5.Thmtheorem1.p1.6.m4.6.6.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6"><eq id="S5.Thmtheorem1.p1.6.m4.6.6.3.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.3"></eq><apply id="S5.Thmtheorem1.p1.6.m4.6.6.4.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.4"><csymbol cd="ambiguous" id="S5.Thmtheorem1.p1.6.m4.6.6.4.1.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.4">superscript</csymbol><apply id="S5.Thmtheorem1.p1.6.m4.6.6.4.2.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.4"><csymbol cd="ambiguous" id="S5.Thmtheorem1.p1.6.m4.6.6.4.2.1.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.4">subscript</csymbol><ci id="S5.Thmtheorem1.p1.6.m4.6.6.4.2.2.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.4.2.2">𝒄</ci><apply id="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3"><times id="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.1.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.1"></times><ci id="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.2.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.2">𝒄</ci><ci id="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.3.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.3">𝒐</ci><ci id="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.4.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.4">𝒉</ci><ci id="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.5.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.5">𝒐</ci><ci id="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.6.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.6">𝒓</ci><ci id="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.7.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.4.2.3.7">𝒕</ci></apply></apply><ci id="S5.Thmtheorem1.p1.6.m4.6.6.4.3.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.4.3">𝒕</ci></apply><apply id="S5.Thmtheorem1.p1.6.m4.6.6.2.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2"><times id="S5.Thmtheorem1.p1.6.m4.6.6.2.3.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.3"></times><apply id="S5.Thmtheorem1.p1.6.m4.6.6.2.4.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.4"><divide id="S5.Thmtheorem1.p1.6.m4.6.6.2.4.1.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.4"></divide><cn type="integer" id="S5.Thmtheorem1.p1.6.m4.6.6.2.4.2.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.4.2">1</cn><ci id="S5.Thmtheorem1.p1.6.m4.6.6.2.4.3.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.4.3">𝑚</ci></apply><apply id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2"><apply id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.3.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.3"><csymbol cd="ambiguous" id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.3.1.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.3">subscript</csymbol><sum id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.3.2.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.3.2"></sum><apply id="S5.Thmtheorem1.p1.6.m4.3.3.3.cmml" xref="S5.Thmtheorem1.p1.6.m4.3.3.3"><neq id="S5.Thmtheorem1.p1.6.m4.3.3.3.4.cmml" xref="S5.Thmtheorem1.p1.6.m4.3.3.3.4"></neq><list id="S5.Thmtheorem1.p1.6.m4.3.3.3.5.1.cmml" xref="S5.Thmtheorem1.p1.6.m4.3.3.3.5.2"><ci id="S5.Thmtheorem1.p1.6.m4.1.1.1.1.cmml" xref="S5.Thmtheorem1.p1.6.m4.1.1.1.1">𝑖</ci><ci id="S5.Thmtheorem1.p1.6.m4.2.2.2.2.cmml" xref="S5.Thmtheorem1.p1.6.m4.2.2.2.2">𝑗</ci><ci id="S5.Thmtheorem1.p1.6.m4.3.3.3.3.cmml" xref="S5.Thmtheorem1.p1.6.m4.3.3.3.3">𝑖</ci></list><ci id="S5.Thmtheorem1.p1.6.m4.3.3.3.6.cmml" xref="S5.Thmtheorem1.p1.6.m4.3.3.3.6">𝑗</ci></apply></apply><apply id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2"><times id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.3.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.3"></times><apply id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.4.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.4"><csymbol cd="ambiguous" id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.4.1.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.4">subscript</csymbol><ci id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.4.2.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.4.2">𝜆</ci><ci id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.4.3.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.4.3">𝑖</ci></apply><apply id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.5.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.5"><csymbol cd="ambiguous" id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.5.1.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.5">subscript</csymbol><ci id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.5.2.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.5.2">𝜆</ci><ci id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.5.3.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.5.3">𝑗</ci></apply><apply id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.3.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2"><cos id="S5.Thmtheorem1.p1.6.m4.4.4.cmml" xref="S5.Thmtheorem1.p1.6.m4.4.4"></cos><apply id="S5.Thmtheorem1.p1.6.m4.5.5.1.1.1.1.1.1.1.cmml" xref="S5.Thmtheorem1.p1.6.m4.5.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.Thmtheorem1.p1.6.m4.5.5.1.1.1.1.1.1.1.1.cmml" xref="S5.Thmtheorem1.p1.6.m4.5.5.1.1.1.1.1.1.1">superscript</csymbol><apply id="S5.Thmtheorem1.p1.6.m4.5.5.1.1.1.1.1.1.1.2.cmml" xref="S5.Thmtheorem1.p1.6.m4.5.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.Thmtheorem1.p1.6.m4.5.5.1.1.1.1.1.1.1.2.1.cmml" xref="S5.Thmtheorem1.p1.6.m4.5.5.1.1.1.1.1.1.1">subscript</csymbol><ci id="S5.Thmtheorem1.p1.6.m4.5.5.1.1.1.1.1.1.1.2.2a.cmml" xref="S5.Thmtheorem1.p1.6.m4.5.5.1.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S5.Thmtheorem1.p1.6.m4.5.5.1.1.1.1.1.1.1.2.2.cmml" xref="S5.Thmtheorem1.p1.6.m4.5.5.1.1.1.1.1.1.1.2.2">g</mtext></ci><ci id="S5.Thmtheorem1.p1.6.m4.5.5.1.1.1.1.1.1.1.2.3.cmml" xref="S5.Thmtheorem1.p1.6.m4.5.5.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S5.Thmtheorem1.p1.6.m4.5.5.1.1.1.1.1.1.1.3.cmml" xref="S5.Thmtheorem1.p1.6.m4.5.5.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2.2.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2.2.1.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2.2">superscript</csymbol><apply id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2.2.2.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2.2.2.1.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2.2">subscript</csymbol><ci id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2.2.2.2a.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2.2.2.2.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2.2.2.2">g</mtext></ci><ci id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2.2.2.3.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2.2.2.3">𝑗</ci></apply><ci id="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2.2.3.cmml" xref="S5.Thmtheorem1.p1.6.m4.6.6.2.2.2.2.2.2.2.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Thmtheorem1.p1.6.m4.6c">\boldsymbol{c_{cohort}^{t}}=\frac{1}{m}\sum_{i,j,i\neq j}\lambda_{i}\lambda_{j}\cos(\textbf{g}_{i}^{t},\textbf{g}_{j}^{t})</annotation></semantics></math>.</p>
</div>
</div>
<div id="S5.SS1.p5" class="ltx_para">
<p id="S5.SS1.p5.1" class="ltx_p">FL assumes multiple local epochs in each client, and clients usually have heterogeneous data. In this case, the local gradients of clients are usually almost orthogonal, which means that they have low coherence. This phenomenon is observed in <cite class="ltx_cite ltx_citemacro_citep">(Charles et al., <a href="#bib.bib4" title="" class="ltx_ref">2021</a>)</cite>, but it did not dig deeper to examine the training dynamics of FL. In this paper, we calculate the local gradient coherence in each round and find a <span id="S5.SS1.p5.1.1" class="ltx_text ltx_font_italic">critical point</span> exists in the process (<a href="#S4.F5" title="Figure 5 ‣ 4.2 Adaptive Global Weight Shrinking and Training Dynamics ‣ 4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 5</span></a> and <a href="#S5.F6" title="Figure 6 ‣ 5.2 Attentive Learnable Aggregation Weight and Training Dynamics ‣ 5 Client coherence ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 6</span></a>).</p>
</div>
<div id="S5.SS1.p6" class="ltx_para">
<p id="S5.SS1.p6.1" class="ltx_p"><span id="S5.SS1.p6.1.1" class="ltx_text ltx_font_bold">Heterogeneity Coherence.</span> Heterogeneity coherence refers to the distribution consistency between the global data and the sampled one (i.e. data distribution of a cohort of sampled clients) in each round. The value of heterogeneity coherence is positively correlated with the IID-ness of clients as well as the client participation ratio; the higher, the better. We define heterogeneity coherence as follows.</p>
</div>
<div id="S5.Thmtheorem2" class="ltx_theorem ltx_theorem_definition">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="S5.Thmtheorem2.1.1.1" class="ltx_text ltx_font_bold">Definition 5.2</span></span><span id="S5.Thmtheorem2.2.2" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="S5.Thmtheorem2.p1" class="ltx_para">
<p id="S5.Thmtheorem2.p1.4" class="ltx_p">Assuming there are <math id="S5.Thmtheorem2.p1.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S5.Thmtheorem2.p1.1.m1.1a"><mi id="S5.Thmtheorem2.p1.1.m1.1.1" xref="S5.Thmtheorem2.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S5.Thmtheorem2.p1.1.m1.1b"><ci id="S5.Thmtheorem2.p1.1.m1.1.1.cmml" xref="S5.Thmtheorem2.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.Thmtheorem2.p1.1.m1.1c">n</annotation></semantics></math> clients and the cohort size is <math id="S5.Thmtheorem2.p1.2.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S5.Thmtheorem2.p1.2.m2.1a"><mi id="S5.Thmtheorem2.p1.2.m2.1.1" xref="S5.Thmtheorem2.p1.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S5.Thmtheorem2.p1.2.m2.1b"><ci id="S5.Thmtheorem2.p1.2.m2.1.1.cmml" xref="S5.Thmtheorem2.p1.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.Thmtheorem2.p1.2.m2.1c">m</annotation></semantics></math>. For a given cohort of clients, the heterogeneity coherence is <math id="S5.Thmtheorem2.p1.3.m3.2" class="ltx_Math" alttext="\text{\rm sim}(\mathcal{D}_{cohort},\mathcal{D})" display="inline"><semantics id="S5.Thmtheorem2.p1.3.m3.2a"><mrow id="S5.Thmtheorem2.p1.3.m3.2.2" xref="S5.Thmtheorem2.p1.3.m3.2.2.cmml"><mtext id="S5.Thmtheorem2.p1.3.m3.2.2.3" xref="S5.Thmtheorem2.p1.3.m3.2.2.3a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S5.Thmtheorem2.p1.3.m3.2.2.2" xref="S5.Thmtheorem2.p1.3.m3.2.2.2.cmml">​</mo><mrow id="S5.Thmtheorem2.p1.3.m3.2.2.1.1" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.2.cmml"><mo stretchy="false" id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.2" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.2.cmml">(</mo><msub id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.2" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.2.cmml">𝒟</mi><mrow id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.cmml"><mi id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.2" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.1" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.1.cmml">​</mo><mi id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.3" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.1a" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.1.cmml">​</mo><mi id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.4" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.4.cmml">h</mi><mo lspace="0em" rspace="0em" id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.1b" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.1.cmml">​</mo><mi id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.5" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.1c" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.1.cmml">​</mo><mi id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.6" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.6.cmml">r</mi><mo lspace="0em" rspace="0em" id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.1d" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.1.cmml">​</mo><mi id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.7" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.7.cmml">t</mi></mrow></msub><mo id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.3" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S5.Thmtheorem2.p1.3.m3.1.1" xref="S5.Thmtheorem2.p1.3.m3.1.1.cmml">𝒟</mi><mo stretchy="false" id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.4" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.Thmtheorem2.p1.3.m3.2b"><apply id="S5.Thmtheorem2.p1.3.m3.2.2.cmml" xref="S5.Thmtheorem2.p1.3.m3.2.2"><times id="S5.Thmtheorem2.p1.3.m3.2.2.2.cmml" xref="S5.Thmtheorem2.p1.3.m3.2.2.2"></times><ci id="S5.Thmtheorem2.p1.3.m3.2.2.3a.cmml" xref="S5.Thmtheorem2.p1.3.m3.2.2.3"><mtext id="S5.Thmtheorem2.p1.3.m3.2.2.3.cmml" xref="S5.Thmtheorem2.p1.3.m3.2.2.3">sim</mtext></ci><interval closure="open" id="S5.Thmtheorem2.p1.3.m3.2.2.1.2.cmml" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.1"><apply id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.cmml" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.1.cmml" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.2.cmml" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.2">𝒟</ci><apply id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.cmml" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3"><times id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.1.cmml" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.1"></times><ci id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.2.cmml" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.2">𝑐</ci><ci id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.3.cmml" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.3">𝑜</ci><ci id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.4.cmml" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.4">ℎ</ci><ci id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.5.cmml" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.5">𝑜</ci><ci id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.6.cmml" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.6">𝑟</ci><ci id="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.7.cmml" xref="S5.Thmtheorem2.p1.3.m3.2.2.1.1.1.3.7">𝑡</ci></apply></apply><ci id="S5.Thmtheorem2.p1.3.m3.1.1.cmml" xref="S5.Thmtheorem2.p1.3.m3.1.1">𝒟</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Thmtheorem2.p1.3.m3.2c">\text{\rm sim}(\mathcal{D}_{cohort},\mathcal{D})</annotation></semantics></math>, where <math id="S5.Thmtheorem2.p1.4.m4.3" class="ltx_Math" alttext="\mathcal{D}_{cohort}=\sum_{i\in[m]}\lambda_{i}\mathcal{D}_{i},\mathcal{D}=\sum_{j=1}^{n}\lambda_{j}\mathcal{D}_{j}" display="inline"><semantics id="S5.Thmtheorem2.p1.4.m4.3a"><mrow id="S5.Thmtheorem2.p1.4.m4.3.3.2" xref="S5.Thmtheorem2.p1.4.m4.3.3.3.cmml"><mrow id="S5.Thmtheorem2.p1.4.m4.2.2.1.1" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.cmml"><msub id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.2" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.2.cmml">𝒟</mi><mrow id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.cmml"><mi id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.2" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.1" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.1.cmml">​</mo><mi id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.3" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.1a" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.1.cmml">​</mo><mi id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.4" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.4.cmml">h</mi><mo lspace="0em" rspace="0em" id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.1b" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.1.cmml">​</mo><mi id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.5" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.1c" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.1.cmml">​</mo><mi id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.6" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.6.cmml">r</mi><mo lspace="0em" rspace="0em" id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.1d" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.1.cmml">​</mo><mi id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.7" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.7.cmml">t</mi></mrow></msub><mo rspace="0.111em" id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.1" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.1.cmml">=</mo><mrow id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.cmml"><msub id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.1" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.1.cmml"><mo id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.1.2" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.1.2.cmml">∑</mo><mrow id="S5.Thmtheorem2.p1.4.m4.1.1.1" xref="S5.Thmtheorem2.p1.4.m4.1.1.1.cmml"><mi id="S5.Thmtheorem2.p1.4.m4.1.1.1.3" xref="S5.Thmtheorem2.p1.4.m4.1.1.1.3.cmml">i</mi><mo id="S5.Thmtheorem2.p1.4.m4.1.1.1.2" xref="S5.Thmtheorem2.p1.4.m4.1.1.1.2.cmml">∈</mo><mrow id="S5.Thmtheorem2.p1.4.m4.1.1.1.4.2" xref="S5.Thmtheorem2.p1.4.m4.1.1.1.4.1.cmml"><mo stretchy="false" id="S5.Thmtheorem2.p1.4.m4.1.1.1.4.2.1" xref="S5.Thmtheorem2.p1.4.m4.1.1.1.4.1.1.cmml">[</mo><mi id="S5.Thmtheorem2.p1.4.m4.1.1.1.1" xref="S5.Thmtheorem2.p1.4.m4.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S5.Thmtheorem2.p1.4.m4.1.1.1.4.2.2" xref="S5.Thmtheorem2.p1.4.m4.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></msub><mrow id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.cmml"><msub id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.2" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.2.cmml"><mi id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.2.2" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.2.2.cmml">λ</mi><mi id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.2.3" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.1" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.1.cmml">​</mo><msub id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.3" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.3.2" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.3.2.cmml">𝒟</mi><mi id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.3.3" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow><mo id="S5.Thmtheorem2.p1.4.m4.3.3.2.3" xref="S5.Thmtheorem2.p1.4.m4.3.3.3a.cmml">,</mo><mrow id="S5.Thmtheorem2.p1.4.m4.3.3.2.2" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.2" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.2.cmml">𝒟</mi><mo rspace="0.111em" id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.1" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.1.cmml">=</mo><mrow id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.cmml"><msubsup id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.cmml"><mo id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.2.2" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.2.2.cmml">∑</mo><mrow id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.2.3" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.2.3.cmml"><mi id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.2.3.2" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.2.3.2.cmml">j</mi><mo id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.2.3.1" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.2.3.1.cmml">=</mo><mn id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.2.3.3" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.3" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.3.cmml">n</mi></msubsup><mrow id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.cmml"><msub id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.2" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.2.cmml"><mi id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.2.2" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.2.2.cmml">λ</mi><mi id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.2.3" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.2.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.1" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.1.cmml">​</mo><msub id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.3" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.3.2" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.3.2.cmml">𝒟</mi><mi id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.3.3" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.3.3.cmml">j</mi></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.Thmtheorem2.p1.4.m4.3b"><apply id="S5.Thmtheorem2.p1.4.m4.3.3.3.cmml" xref="S5.Thmtheorem2.p1.4.m4.3.3.2"><csymbol cd="ambiguous" id="S5.Thmtheorem2.p1.4.m4.3.3.3a.cmml" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.3">formulae-sequence</csymbol><apply id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.cmml" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1"><eq id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.1.cmml" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.1"></eq><apply id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.cmml" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2"><csymbol cd="ambiguous" id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.1.cmml" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2">subscript</csymbol><ci id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.2.cmml" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.2">𝒟</ci><apply id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.cmml" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3"><times id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.1.cmml" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.1"></times><ci id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.2.cmml" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.2">𝑐</ci><ci id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.3.cmml" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.3">𝑜</ci><ci id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.4.cmml" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.4">ℎ</ci><ci id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.5.cmml" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.5">𝑜</ci><ci id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.6.cmml" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.6">𝑟</ci><ci id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.7.cmml" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.2.3.7">𝑡</ci></apply></apply><apply id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.cmml" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3"><apply id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.1.cmml" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.1"><csymbol cd="ambiguous" id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.1.1.cmml" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.1">subscript</csymbol><sum id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.1.2.cmml" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.1.2"></sum><apply id="S5.Thmtheorem2.p1.4.m4.1.1.1.cmml" xref="S5.Thmtheorem2.p1.4.m4.1.1.1"><in id="S5.Thmtheorem2.p1.4.m4.1.1.1.2.cmml" xref="S5.Thmtheorem2.p1.4.m4.1.1.1.2"></in><ci id="S5.Thmtheorem2.p1.4.m4.1.1.1.3.cmml" xref="S5.Thmtheorem2.p1.4.m4.1.1.1.3">𝑖</ci><apply id="S5.Thmtheorem2.p1.4.m4.1.1.1.4.1.cmml" xref="S5.Thmtheorem2.p1.4.m4.1.1.1.4.2"><csymbol cd="latexml" id="S5.Thmtheorem2.p1.4.m4.1.1.1.4.1.1.cmml" xref="S5.Thmtheorem2.p1.4.m4.1.1.1.4.2.1">delimited-[]</csymbol><ci id="S5.Thmtheorem2.p1.4.m4.1.1.1.1.cmml" xref="S5.Thmtheorem2.p1.4.m4.1.1.1.1">𝑚</ci></apply></apply></apply><apply id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.cmml" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2"><times id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.1.cmml" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.1"></times><apply id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.2.cmml" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.2"><csymbol cd="ambiguous" id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.2.1.cmml" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.2">subscript</csymbol><ci id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.2.2.cmml" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.2.2">𝜆</ci><ci id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.2.3.cmml" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.2.3">𝑖</ci></apply><apply id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.3.cmml" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.3"><csymbol cd="ambiguous" id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.3.1.cmml" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.3">subscript</csymbol><ci id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.3.2.cmml" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.3.2">𝒟</ci><ci id="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.3.3.cmml" xref="S5.Thmtheorem2.p1.4.m4.2.2.1.1.3.2.3.3">𝑖</ci></apply></apply></apply></apply><apply id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.cmml" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2"><eq id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.1.cmml" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.1"></eq><ci id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.2.cmml" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.2">𝒟</ci><apply id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.cmml" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3"><apply id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.cmml" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1"><csymbol cd="ambiguous" id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.1.cmml" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1">superscript</csymbol><apply id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.2.cmml" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1"><csymbol cd="ambiguous" id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.2.1.cmml" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1">subscript</csymbol><sum id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.2.2.cmml" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.2.2"></sum><apply id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.2.3.cmml" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.2.3"><eq id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.2.3.1.cmml" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.2.3.1"></eq><ci id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.2.3.2.cmml" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.2.3.2">𝑗</ci><cn type="integer" id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.2.3.3.cmml" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.2.3.3">1</cn></apply></apply><ci id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.3.cmml" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.1.3">𝑛</ci></apply><apply id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.cmml" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2"><times id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.1.cmml" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.1"></times><apply id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.2.cmml" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.2"><csymbol cd="ambiguous" id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.2.1.cmml" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.2">subscript</csymbol><ci id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.2.2.cmml" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.2.2">𝜆</ci><ci id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.2.3.cmml" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.2.3">𝑗</ci></apply><apply id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.3.cmml" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.3"><csymbol cd="ambiguous" id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.3.1.cmml" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.3">subscript</csymbol><ci id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.3.2.cmml" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.3.2">𝒟</ci><ci id="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.3.3.cmml" xref="S5.Thmtheorem2.p1.4.m4.3.3.2.2.3.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Thmtheorem2.p1.4.m4.3c">\mathcal{D}_{cohort}=\sum_{i\in[m]}\lambda_{i}\mathcal{D}_{i},\mathcal{D}=\sum_{j=1}^{n}\lambda_{j}\mathcal{D}_{j}</annotation></semantics></math> and “sim” is the similarity of two data distributions.</p>
</div>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Attentive Learnable Aggregation Weight and Training Dynamics</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.4" class="ltx_p">Vanilla <span id="S5.SS2.p1.4.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> only considers data sizes as clients’ aggregation weights <math id="S5.SS2.p1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{\lambda}" display="inline"><semantics id="S5.SS2.p1.1.m1.1a"><mi id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml">𝝀</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><ci id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1">𝝀</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">\boldsymbol{\lambda}</annotation></semantics></math>. However, clients with different heterogeneity degrees have different importance in client coherence, which can greatly affect the training dynamics. A three-node toy example is shown in <a href="#A2.F12" title="Figure 12 ‣ B.2 Client Coherence ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 12</span></a> in Appendix. The optimal <math id="S5.SS2.p1.2.m2.1" class="ltx_Math" alttext="\boldsymbol{\lambda}" display="inline"><semantics id="S5.SS2.p1.2.m2.1a"><mi id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml">𝝀</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><ci id="S5.SS2.p1.2.m2.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1">𝝀</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">\boldsymbol{\lambda}</annotation></semantics></math> is off the data-sized when clients have the same data size but different heterogeneity degrees. To study client coherence further, we propose attentive learnable aggregation weight (attentive LAW) to learn the optimal aggregation weights (i.e. <math id="S5.SS2.p1.3.m3.1" class="ltx_Math" alttext="\boldsymbol{\lambda}" display="inline"><semantics id="S5.SS2.p1.3.m3.1a"><mi id="S5.SS2.p1.3.m3.1.1" xref="S5.SS2.p1.3.m3.1.1.cmml">𝝀</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.3.m3.1b"><ci id="S5.SS2.p1.3.m3.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1">𝝀</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.3.m3.1c">\boldsymbol{\lambda}</annotation></semantics></math>) on a proxy dataset. By connecting the optimal weights and the client coherence, we can know the roles of different clients in different learning periods. Attentive LAW conducts the model updates in <a href="#S3.E3" title="Equation 3 ‣ 3 Preliminary and Problem Setup ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Equation 3</span></a>, where <math id="S5.SS2.p1.4.m4.1" class="ltx_Math" alttext="\{\gamma=1,\boldsymbol{\lambda}=\boldsymbol{\lambda^{*}}\}" display="inline"><semantics id="S5.SS2.p1.4.m4.1a"><mrow id="S5.SS2.p1.4.m4.1.1.1" xref="S5.SS2.p1.4.m4.1.1.2.cmml"><mo stretchy="false" id="S5.SS2.p1.4.m4.1.1.1.2" xref="S5.SS2.p1.4.m4.1.1.2.cmml">{</mo><mrow id="S5.SS2.p1.4.m4.1.1.1.1.2" xref="S5.SS2.p1.4.m4.1.1.1.1.3.cmml"><mrow id="S5.SS2.p1.4.m4.1.1.1.1.1.1" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1.cmml"><mi id="S5.SS2.p1.4.m4.1.1.1.1.1.1.2" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1.2.cmml">γ</mi><mo id="S5.SS2.p1.4.m4.1.1.1.1.1.1.1" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1.1.cmml">=</mo><mn id="S5.SS2.p1.4.m4.1.1.1.1.1.1.3" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S5.SS2.p1.4.m4.1.1.1.1.2.3" xref="S5.SS2.p1.4.m4.1.1.1.1.3a.cmml">,</mo><mrow id="S5.SS2.p1.4.m4.1.1.1.1.2.2" xref="S5.SS2.p1.4.m4.1.1.1.1.2.2.cmml"><mi id="S5.SS2.p1.4.m4.1.1.1.1.2.2.2" xref="S5.SS2.p1.4.m4.1.1.1.1.2.2.2.cmml">𝝀</mi><mo id="S5.SS2.p1.4.m4.1.1.1.1.2.2.1" xref="S5.SS2.p1.4.m4.1.1.1.1.2.2.1.cmml">=</mo><msup id="S5.SS2.p1.4.m4.1.1.1.1.2.2.3" xref="S5.SS2.p1.4.m4.1.1.1.1.2.2.3.cmml"><mi id="S5.SS2.p1.4.m4.1.1.1.1.2.2.3.2" xref="S5.SS2.p1.4.m4.1.1.1.1.2.2.3.2.cmml">𝝀</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S5.SS2.p1.4.m4.1.1.1.1.2.2.3.3" xref="S5.SS2.p1.4.m4.1.1.1.1.2.2.3.3.cmml">∗</mo></msup></mrow></mrow><mo stretchy="false" id="S5.SS2.p1.4.m4.1.1.1.3" xref="S5.SS2.p1.4.m4.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.4.m4.1b"><set id="S5.SS2.p1.4.m4.1.1.2.cmml" xref="S5.SS2.p1.4.m4.1.1.1"><apply id="S5.SS2.p1.4.m4.1.1.1.1.3.cmml" xref="S5.SS2.p1.4.m4.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.p1.4.m4.1.1.1.1.3a.cmml" xref="S5.SS2.p1.4.m4.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S5.SS2.p1.4.m4.1.1.1.1.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1"><eq id="S5.SS2.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1.1"></eq><ci id="S5.SS2.p1.4.m4.1.1.1.1.1.1.2.cmml" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1.2">𝛾</ci><cn type="integer" id="S5.SS2.p1.4.m4.1.1.1.1.1.1.3.cmml" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1.3">1</cn></apply><apply id="S5.SS2.p1.4.m4.1.1.1.1.2.2.cmml" xref="S5.SS2.p1.4.m4.1.1.1.1.2.2"><eq id="S5.SS2.p1.4.m4.1.1.1.1.2.2.1.cmml" xref="S5.SS2.p1.4.m4.1.1.1.1.2.2.1"></eq><ci id="S5.SS2.p1.4.m4.1.1.1.1.2.2.2.cmml" xref="S5.SS2.p1.4.m4.1.1.1.1.2.2.2">𝝀</ci><apply id="S5.SS2.p1.4.m4.1.1.1.1.2.2.3.cmml" xref="S5.SS2.p1.4.m4.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S5.SS2.p1.4.m4.1.1.1.1.2.2.3.1.cmml" xref="S5.SS2.p1.4.m4.1.1.1.1.2.2.3">superscript</csymbol><ci id="S5.SS2.p1.4.m4.1.1.1.1.2.2.3.2.cmml" xref="S5.SS2.p1.4.m4.1.1.1.1.2.2.3.2">𝝀</ci><times id="S5.SS2.p1.4.m4.1.1.1.1.2.2.3.3.cmml" xref="S5.SS2.p1.4.m4.1.1.1.1.2.2.3.3"></times></apply></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.4.m4.1c">\{\gamma=1,\boldsymbol{\lambda}=\boldsymbol{\lambda^{*}}\}</annotation></semantics></math>,</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<table id="S5.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S5.E7.m1.2" class="ltx_Math" alttext="\boldsymbol{\lambda^{*}}=\mathop{\arg\min}\limits_{\boldsymbol{\lambda}}\mathcal{L}_{proxy}(\sum_{i=1}^{m}\lambda_{i}\textbf{w}_{i}^{t}),\text{ s.t. }\lambda_{i}\geq 0,\|\boldsymbol{\lambda}\|_{1}=1." display="block"><semantics id="S5.E7.m1.2a"><mrow id="S5.E7.m1.2.2.1"><mrow id="S5.E7.m1.2.2.1.1.2" xref="S5.E7.m1.2.2.1.1.3.cmml"><mrow id="S5.E7.m1.2.2.1.1.1.1" xref="S5.E7.m1.2.2.1.1.1.1.cmml"><msup id="S5.E7.m1.2.2.1.1.1.1.3" xref="S5.E7.m1.2.2.1.1.1.1.3.cmml"><mi mathsize="90%" id="S5.E7.m1.2.2.1.1.1.1.3.2" xref="S5.E7.m1.2.2.1.1.1.1.3.2.cmml">𝝀</mi><mo class="ltx_mathvariant_bold" mathsize="90%" mathvariant="bold" id="S5.E7.m1.2.2.1.1.1.1.3.3" xref="S5.E7.m1.2.2.1.1.1.1.3.3.cmml">∗</mo></msup><mo mathsize="90%" id="S5.E7.m1.2.2.1.1.1.1.2" xref="S5.E7.m1.2.2.1.1.1.1.2.cmml">=</mo><mrow id="S5.E7.m1.2.2.1.1.1.1.1" xref="S5.E7.m1.2.2.1.1.1.1.1.cmml"><munder id="S5.E7.m1.2.2.1.1.1.1.1.2" xref="S5.E7.m1.2.2.1.1.1.1.1.2.cmml"><mrow id="S5.E7.m1.2.2.1.1.1.1.1.2.2" xref="S5.E7.m1.2.2.1.1.1.1.1.2.2.cmml"><mi mathsize="90%" id="S5.E7.m1.2.2.1.1.1.1.1.2.2.1" xref="S5.E7.m1.2.2.1.1.1.1.1.2.2.1.cmml">arg</mi><mo lspace="0.167em" id="S5.E7.m1.2.2.1.1.1.1.1.2.2a" xref="S5.E7.m1.2.2.1.1.1.1.1.2.2.cmml">⁡</mo><mi mathsize="90%" id="S5.E7.m1.2.2.1.1.1.1.1.2.2.2" xref="S5.E7.m1.2.2.1.1.1.1.1.2.2.2.cmml">min</mi></mrow><mi mathsize="90%" id="S5.E7.m1.2.2.1.1.1.1.1.2.3" xref="S5.E7.m1.2.2.1.1.1.1.1.2.3.cmml">𝝀</mi></munder><mrow id="S5.E7.m1.2.2.1.1.1.1.1.1" xref="S5.E7.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S5.E7.m1.2.2.1.1.1.1.1.1.3" xref="S5.E7.m1.2.2.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S5.E7.m1.2.2.1.1.1.1.1.1.3.2" xref="S5.E7.m1.2.2.1.1.1.1.1.1.3.2.cmml">ℒ</mi><mrow id="S5.E7.m1.2.2.1.1.1.1.1.1.3.3" xref="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.cmml"><mi mathsize="90%" id="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.2" xref="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.1" xref="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.3" xref="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.1a" xref="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.4" xref="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.1b" xref="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.5" xref="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.5.cmml">x</mi><mo lspace="0em" rspace="0em" id="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.1c" xref="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.6" xref="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.6.cmml">y</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S5.E7.m1.2.2.1.1.1.1.1.1.2" xref="S5.E7.m1.2.2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><munderover id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo lspace="0em" maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi mathsize="90%" id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo mathsize="90%" id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">m</mi></munderover><mrow id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi mathsize="90%" id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml">λ</mi><mi mathsize="90%" id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.3" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.1" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><msubsup id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml"><mtext class="ltx_mathvariant_bold" mathsize="90%" id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.2.2" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.2.2a.cmml">w</mtext><mi mathsize="90%" id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.2.3" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.2.3.cmml">i</mi><mi mathsize="90%" id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.3" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.3.cmml">t</mi></msubsup></mrow></mrow><mo maxsize="90%" minsize="90%" id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo mathsize="90%" id="S5.E7.m1.2.2.1.1.2.3" xref="S5.E7.m1.2.2.1.1.3a.cmml">,</mo><mrow id="S5.E7.m1.2.2.1.1.2.2.2" xref="S5.E7.m1.2.2.1.1.2.2.3.cmml"><mrow id="S5.E7.m1.2.2.1.1.2.2.1.1" xref="S5.E7.m1.2.2.1.1.2.2.1.1.cmml"><mrow id="S5.E7.m1.2.2.1.1.2.2.1.1.2" xref="S5.E7.m1.2.2.1.1.2.2.1.1.2.cmml"><mtext mathsize="90%" id="S5.E7.m1.2.2.1.1.2.2.1.1.2.2" xref="S5.E7.m1.2.2.1.1.2.2.1.1.2.2a.cmml"> s.t. </mtext><mo lspace="0em" rspace="0em" id="S5.E7.m1.2.2.1.1.2.2.1.1.2.1" xref="S5.E7.m1.2.2.1.1.2.2.1.1.2.1.cmml">​</mo><msub id="S5.E7.m1.2.2.1.1.2.2.1.1.2.3" xref="S5.E7.m1.2.2.1.1.2.2.1.1.2.3.cmml"><mi mathsize="90%" id="S5.E7.m1.2.2.1.1.2.2.1.1.2.3.2" xref="S5.E7.m1.2.2.1.1.2.2.1.1.2.3.2.cmml">λ</mi><mi mathsize="90%" id="S5.E7.m1.2.2.1.1.2.2.1.1.2.3.3" xref="S5.E7.m1.2.2.1.1.2.2.1.1.2.3.3.cmml">i</mi></msub></mrow><mo mathsize="90%" id="S5.E7.m1.2.2.1.1.2.2.1.1.1" xref="S5.E7.m1.2.2.1.1.2.2.1.1.1.cmml">≥</mo><mn mathsize="90%" id="S5.E7.m1.2.2.1.1.2.2.1.1.3" xref="S5.E7.m1.2.2.1.1.2.2.1.1.3.cmml">0</mn></mrow><mo mathsize="90%" id="S5.E7.m1.2.2.1.1.2.2.2.3" xref="S5.E7.m1.2.2.1.1.2.2.3a.cmml">,</mo><mrow id="S5.E7.m1.2.2.1.1.2.2.2.2" xref="S5.E7.m1.2.2.1.1.2.2.2.2.cmml"><msub id="S5.E7.m1.2.2.1.1.2.2.2.2.2" xref="S5.E7.m1.2.2.1.1.2.2.2.2.2.cmml"><mrow id="S5.E7.m1.2.2.1.1.2.2.2.2.2.2.2" xref="S5.E7.m1.2.2.1.1.2.2.2.2.2.2.1.cmml"><mo maxsize="90%" minsize="90%" id="S5.E7.m1.2.2.1.1.2.2.2.2.2.2.2.1" xref="S5.E7.m1.2.2.1.1.2.2.2.2.2.2.1.1.cmml">‖</mo><mi mathsize="90%" id="S5.E7.m1.1.1" xref="S5.E7.m1.1.1.cmml">𝝀</mi><mo maxsize="90%" minsize="90%" id="S5.E7.m1.2.2.1.1.2.2.2.2.2.2.2.2" xref="S5.E7.m1.2.2.1.1.2.2.2.2.2.2.1.1.cmml">‖</mo></mrow><mn mathsize="90%" id="S5.E7.m1.2.2.1.1.2.2.2.2.2.3" xref="S5.E7.m1.2.2.1.1.2.2.2.2.2.3.cmml">1</mn></msub><mo mathsize="90%" id="S5.E7.m1.2.2.1.1.2.2.2.2.1" xref="S5.E7.m1.2.2.1.1.2.2.2.2.1.cmml">=</mo><mn mathsize="90%" id="S5.E7.m1.2.2.1.1.2.2.2.2.3" xref="S5.E7.m1.2.2.1.1.2.2.2.2.3.cmml">1</mn></mrow></mrow></mrow><mo lspace="0em" mathsize="90%" id="S5.E7.m1.2.2.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E7.m1.2b"><apply id="S5.E7.m1.2.2.1.1.3.cmml" xref="S5.E7.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S5.E7.m1.2.2.1.1.3a.cmml" xref="S5.E7.m1.2.2.1.1.2.3">formulae-sequence</csymbol><apply id="S5.E7.m1.2.2.1.1.1.1.cmml" xref="S5.E7.m1.2.2.1.1.1.1"><eq id="S5.E7.m1.2.2.1.1.1.1.2.cmml" xref="S5.E7.m1.2.2.1.1.1.1.2"></eq><apply id="S5.E7.m1.2.2.1.1.1.1.3.cmml" xref="S5.E7.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E7.m1.2.2.1.1.1.1.3.1.cmml" xref="S5.E7.m1.2.2.1.1.1.1.3">superscript</csymbol><ci id="S5.E7.m1.2.2.1.1.1.1.3.2.cmml" xref="S5.E7.m1.2.2.1.1.1.1.3.2">𝝀</ci><times id="S5.E7.m1.2.2.1.1.1.1.3.3.cmml" xref="S5.E7.m1.2.2.1.1.1.1.3.3"></times></apply><apply id="S5.E7.m1.2.2.1.1.1.1.1.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1"><apply id="S5.E7.m1.2.2.1.1.1.1.1.2.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E7.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.2">subscript</csymbol><apply id="S5.E7.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.2.2"><arg id="S5.E7.m1.2.2.1.1.1.1.1.2.2.1.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.2.2.1"></arg><min id="S5.E7.m1.2.2.1.1.1.1.1.2.2.2.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.2.2.2"></min></apply><ci id="S5.E7.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.2.3">𝝀</ci></apply><apply id="S5.E7.m1.2.2.1.1.1.1.1.1.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1"><times id="S5.E7.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.2"></times><apply id="S5.E7.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E7.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S5.E7.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.3.2">ℒ</ci><apply id="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.3.3"><times id="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.1.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.1"></times><ci id="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.2.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.2">𝑝</ci><ci id="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.3.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.3">𝑟</ci><ci id="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.4.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.4">𝑜</ci><ci id="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.5.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.5">𝑥</ci><ci id="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.6.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.3.3.6">𝑦</ci></apply></apply><apply id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1"><apply id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2"></sum><apply id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3"><eq id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">𝑚</ci></apply><apply id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2"><times id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.1"></times><apply id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2">𝜆</ci><ci id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3">superscript</csymbol><apply id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.2.2a.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.2.2"><mtext class="ltx_mathvariant_bold" mathsize="90%" id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.2.2">w</mtext></ci><ci id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.2.3.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.2.3">𝑖</ci></apply><ci id="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply><apply id="S5.E7.m1.2.2.1.1.2.2.3.cmml" xref="S5.E7.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S5.E7.m1.2.2.1.1.2.2.3a.cmml" xref="S5.E7.m1.2.2.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S5.E7.m1.2.2.1.1.2.2.1.1.cmml" xref="S5.E7.m1.2.2.1.1.2.2.1.1"><geq id="S5.E7.m1.2.2.1.1.2.2.1.1.1.cmml" xref="S5.E7.m1.2.2.1.1.2.2.1.1.1"></geq><apply id="S5.E7.m1.2.2.1.1.2.2.1.1.2.cmml" xref="S5.E7.m1.2.2.1.1.2.2.1.1.2"><times id="S5.E7.m1.2.2.1.1.2.2.1.1.2.1.cmml" xref="S5.E7.m1.2.2.1.1.2.2.1.1.2.1"></times><ci id="S5.E7.m1.2.2.1.1.2.2.1.1.2.2a.cmml" xref="S5.E7.m1.2.2.1.1.2.2.1.1.2.2"><mtext mathsize="90%" id="S5.E7.m1.2.2.1.1.2.2.1.1.2.2.cmml" xref="S5.E7.m1.2.2.1.1.2.2.1.1.2.2"> s.t. </mtext></ci><apply id="S5.E7.m1.2.2.1.1.2.2.1.1.2.3.cmml" xref="S5.E7.m1.2.2.1.1.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S5.E7.m1.2.2.1.1.2.2.1.1.2.3.1.cmml" xref="S5.E7.m1.2.2.1.1.2.2.1.1.2.3">subscript</csymbol><ci id="S5.E7.m1.2.2.1.1.2.2.1.1.2.3.2.cmml" xref="S5.E7.m1.2.2.1.1.2.2.1.1.2.3.2">𝜆</ci><ci id="S5.E7.m1.2.2.1.1.2.2.1.1.2.3.3.cmml" xref="S5.E7.m1.2.2.1.1.2.2.1.1.2.3.3">𝑖</ci></apply></apply><cn type="integer" id="S5.E7.m1.2.2.1.1.2.2.1.1.3.cmml" xref="S5.E7.m1.2.2.1.1.2.2.1.1.3">0</cn></apply><apply id="S5.E7.m1.2.2.1.1.2.2.2.2.cmml" xref="S5.E7.m1.2.2.1.1.2.2.2.2"><eq id="S5.E7.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S5.E7.m1.2.2.1.1.2.2.2.2.1"></eq><apply id="S5.E7.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S5.E7.m1.2.2.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.E7.m1.2.2.1.1.2.2.2.2.2.1.cmml" xref="S5.E7.m1.2.2.1.1.2.2.2.2.2">subscript</csymbol><apply id="S5.E7.m1.2.2.1.1.2.2.2.2.2.2.1.cmml" xref="S5.E7.m1.2.2.1.1.2.2.2.2.2.2.2"><csymbol cd="latexml" id="S5.E7.m1.2.2.1.1.2.2.2.2.2.2.1.1.cmml" xref="S5.E7.m1.2.2.1.1.2.2.2.2.2.2.2.1">norm</csymbol><ci id="S5.E7.m1.1.1.cmml" xref="S5.E7.m1.1.1">𝝀</ci></apply><cn type="integer" id="S5.E7.m1.2.2.1.1.2.2.2.2.2.3.cmml" xref="S5.E7.m1.2.2.1.1.2.2.2.2.2.3">1</cn></apply><cn type="integer" id="S5.E7.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S5.E7.m1.2.2.1.1.2.2.2.2.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E7.m1.2c">\boldsymbol{\lambda^{*}}=\mathop{\arg\min}\limits_{\boldsymbol{\lambda}}\mathcal{L}_{proxy}(\sum_{i=1}^{m}\lambda_{i}\textbf{w}_{i}^{t}),\text{ s.t. }\lambda_{i}\geq 0,\|\boldsymbol{\lambda}\|_{1}=1.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<figure id="S5.F6" class="ltx_figure"><img src="/html/2302.10911/assets/x12.png" id="S5.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="323" height="202" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span><span id="S5.F6.2.1" class="ltx_text" style="font-size:90%;">Training dynamics of adaptive GWS in terms of local gradient coherence. <math id="S5.F6.2.1.m1.1" class="ltx_Math" alttext="E=3" display="inline"><semantics id="S5.F6.2.1.m1.1b"><mrow id="S5.F6.2.1.m1.1.1" xref="S5.F6.2.1.m1.1.1.cmml"><mi id="S5.F6.2.1.m1.1.1.2" xref="S5.F6.2.1.m1.1.1.2.cmml">E</mi><mo id="S5.F6.2.1.m1.1.1.1" xref="S5.F6.2.1.m1.1.1.1.cmml">=</mo><mn id="S5.F6.2.1.m1.1.1.3" xref="S5.F6.2.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F6.2.1.m1.1c"><apply id="S5.F6.2.1.m1.1.1.cmml" xref="S5.F6.2.1.m1.1.1"><eq id="S5.F6.2.1.m1.1.1.1.cmml" xref="S5.F6.2.1.m1.1.1.1"></eq><ci id="S5.F6.2.1.m1.1.1.2.cmml" xref="S5.F6.2.1.m1.1.1.2">𝐸</ci><cn type="integer" id="S5.F6.2.1.m1.1.1.3.cmml" xref="S5.F6.2.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.2.1.m1.1d">E=3</annotation></semantics></math>.</span></figcaption>
</figure>
<div id="S5.SS2.p3" class="ltx_para">
<p id="S5.SS2.p3.1" class="ltx_p"><span id="S5.SS2.p3.1.1" class="ltx_text ltx_font_bold">1) Generalization will benefit from positive local gradient coherence.</span></p>
<ul id="S5.I1" class="ltx_itemize">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i1.p1" class="ltx_para">
<p id="S5.I1.i1.p1.1" class="ltx_p"><span id="S5.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">Critical point exists in terms of local gradient coherence.</span> To study the role of client data heterogeneity in local gradient coherence, we experiment on both balanced and imbalanced clients, whose distributions are shown in <a href="#A2.F13" title="Figure 13 ‣ B.2 Client Coherence ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 13</span></a> of Appendix.
The results are demonstrated in <a href="#S4.F5" title="Figure 5 ‣ 4.2 Adaptive Global Weight Shrinking and Training Dynamics ‣ 4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 5</span></a>, which illustrate that <em id="S5.I1.i1.p1.1.2" class="ltx_emph ltx_font_italic">in the first couple of rounds, the coherence is dominant and positive, thus the test accuracy arises dramatically, and most generalization gains happen in this period</em>.
The critical point is the round that the coherence is near zero. After the critical point, the test accuracy gain is marginal, and the coherence is kept negative but close to zero.</p>
</div>
</li>
<li id="S5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i2.p1" class="ltx_para">
<p id="S5.I1.i2.p1.1" class="ltx_p"><span id="S5.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Assigning larger weights to clients with larger coherence before the critical point can improve overall performance.</span> From the left of <a href="#S4.F5" title="Figure 5 ‣ 4.2 Adaptive Global Weight Shrinking and Training Dynamics ‣ 4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 5</span></a>, it is clear that before the critical point, the coherence among balanced clients is much higher than that of imbalanced clients. This observation highlights the fact that clients with more balanced data have more coherent gradients
<span id="footnote5" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>This also reveals why FL performs better in IID settings than NonIID: the clients’ gradients in IID settings are more coherent, but the ones in the NonIID usually diverge.</span></span></span>. To capitalize on this, according to <a href="#S5.E6" title="Equation 6 ‣ 5.1 Basic Concept and Formulation ‣ 5 Client coherence ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Equation 6</span></a>, we can assign larger weights to clients with more balanced data before the critical point to boost generalization. From the right of <a href="#S4.F5" title="Figure 5 ‣ 4.2 Adaptive Global Weight Shrinking and Training Dynamics ‣ 4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 5</span></a>, attentive LAW proves our hypothesis: it assigns larger weights to balanced clients in the early rounds, particularly in the first two rounds where it nearly assigns all weights to balanced clients. This may suggest that <em id="S5.I1.i2.p1.1.2" class="ltx_emph ltx_font_italic">the coherence of clients only matters before the critical point where the overall coherence is positive</em>.
To verify this, we adopt early stopping near the critical point when conducting attentive LAW and use data-sized weights after the stopping round.
Results in the middle of <a href="#S4.F5" title="Figure 5 ‣ 4.2 Adaptive Global Weight Shrinking and Training Dynamics ‣ 4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 5</span></a> show that <em id="S5.I1.i2.p1.1.3" class="ltx_emph ltx_font_italic">the early-stopped attentive LAW has comparable performance after the critical point.</em> This insight can guide the design of effective algorithms for learning critically in early training stages.</p>
</div>
</li>
<li id="S5.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i3.p1" class="ltx_para">
<p id="S5.I1.i3.p1.1" class="ltx_p"><span id="S5.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">GWS improves local gradient coherence to positive after the critical point.</span>
Interestingly, we observe that <em id="S5.I1.i3.p1.1.2" class="ltx_emph ltx_font_italic">if we adopt adaptive GWS, the local gradient coherence remains positive after the critical point, allowing the model to continue benefiting from the coherent gradients.</em> As shown in <a href="#S5.F6" title="Figure 6 ‣ 5.2 Attentive Learnable Aggregation Weight and Training Dynamics ‣ 5 Client coherence ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 6</span></a>, before the critical point, both vanilla <span id="S5.I1.i3.p1.1.3" class="ltx_text ltx_font_smallcaps">FedAvg</span> and adaptive GWS have high gradient coherence, resulting in similar increases in accuracy. After the critical point, the coherence of <span id="S5.I1.i3.p1.1.4" class="ltx_text ltx_font_smallcaps">FedAvg</span> goes down below zero, resulting in marginal performance gains. In contrast, adaptive GWS maintains coherence above zero, allowing for further performance gains beyond <span id="S5.I1.i3.p1.1.5" class="ltx_text ltx_font_smallcaps">FedAvg</span>.</p>
</div>
</li>
</ul>
</div>
<figure id="S5.F7" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2302.10911/assets/x13.png" id="S5.F7.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="226" height="176" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2302.10911/assets/x14.png" id="S5.F7.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="226" height="183" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span><span id="S5.F7.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Left:<span id="S5.F7.2.1.2" class="ltx_text ltx_font_medium"> Heterogeneity coherence of class distribution within a cohort. </span>Right:<span id="S5.F7.2.1.1" class="ltx_text ltx_font_medium"> Test accuracy curves. <math id="S5.F7.2.1.1.m1.1" class="ltx_Math" alttext="E=3" display="inline"><semantics id="S5.F7.2.1.1.m1.1b"><mrow id="S5.F7.2.1.1.m1.1.1" xref="S5.F7.2.1.1.m1.1.1.cmml"><mi id="S5.F7.2.1.1.m1.1.1.2" xref="S5.F7.2.1.1.m1.1.1.2.cmml">E</mi><mo id="S5.F7.2.1.1.m1.1.1.1" xref="S5.F7.2.1.1.m1.1.1.1.cmml">=</mo><mn id="S5.F7.2.1.1.m1.1.1.3" xref="S5.F7.2.1.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F7.2.1.1.m1.1c"><apply id="S5.F7.2.1.1.m1.1.1.cmml" xref="S5.F7.2.1.1.m1.1.1"><eq id="S5.F7.2.1.1.m1.1.1.1.cmml" xref="S5.F7.2.1.1.m1.1.1.1"></eq><ci id="S5.F7.2.1.1.m1.1.1.2.cmml" xref="S5.F7.2.1.1.m1.1.1.2">𝐸</ci><cn type="integer" id="S5.F7.2.1.1.m1.1.1.3.cmml" xref="S5.F7.2.1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.2.1.1.m1.1d">E=3</annotation></semantics></math>.</span></span></figcaption>
</figure>
<div id="S5.SS2.p4" class="ltx_para">
<p id="S5.SS2.p4.1" class="ltx_p"><span id="S5.SS2.p4.1.1" class="ltx_text ltx_font_bold">2) Improving heterogeneity coherence within a cohort can boost performance.</span>
In scenarios with partial client participation in each round, the selected clients have an inconsistent sum objective with the global objective, resulting in low heterogeneity coherence (as defined in Definition <a href="#S5.Thmtheorem2" title="Definition 5.2. ‣ 5.1 Basic Concept and Formulation ‣ 5 Client coherence ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.2</span></a>).
In theory, the expectation of the sum objective of the sampled clients is consistent with the global objective if the communication rounds (sampling times) are numerous. However, in practical FL, the number of rounds is limited, and from the perspective of learning dynamics, only the first few rounds matter most. Thus, the heterogeneity coherence problem brings a challenge, and sampling methods may not always help, because the availability of clients cannot be guaranteed and stragglers may exist <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib34" title="" class="ltx_ref">2020b</a>)</cite>.</p>
</div>
<div id="S5.SS2.p5" class="ltx_para">
<p id="S5.SS2.p5.1" class="ltx_p">To address the issue, reweighting the sampled clients in aggregation is quite essential. We find <em id="S5.SS2.p5.1.1" class="ltx_emph ltx_font_italic">attentive LAW improves heterogeneity coherence by dynamically adjusting the aggregation weights among clients</em>. We visualize the weighted class distributions within a cohort in <a href="#S5.F7" title="Figure 7 ‣ 5.2 Attentive Learnable Aggregation Weight and Training Dynamics ‣ 5 Client coherence ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 7</span></a>, which shows that attentive LAW learns weights to make the class distributions more balanced.
The test accuracy curves demonstrate a dominant performance gain compared to <span id="S5.SS2.p5.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span>, which showcases the significance of heterogeneity coherence. Additionally, we observe that attentive LAW with SWA<span id="footnote6" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>
Stochastic Weight Averaging (SWA) <cite class="ltx_cite ltx_citemacro_citep">(Izmailov et al., <a href="#bib.bib21" title="" class="ltx_ref">2018</a>)</cite> is an effective technique to make simple averaging of multiple points along the trajectory of optimization with a cyclical learning rate, which leads to better generalization.
</span></span></span> performs better by seeking a more generalized minimum in the aggregation weight hyperplane. More analysis about client coherence can be found in <a href="#A2.SS2" title="B.2 Client Coherence ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">subsection B.2</span></a> of <a href="#A2" title="Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Appendix B</span></a>.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.9.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> <span id="alg1.10.2" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedLAW</span>: Federated Learning with Learnable Aggregation Weights</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.6" class="ltx_p ltx_figure_panel"><span id="alg1.6.1" class="ltx_text ltx_font_bold">Input</span>: clients <math id="alg1.1.m1.3" class="ltx_Math" alttext="\{1,\dots,n\}" display="inline"><semantics id="alg1.1.m1.3a"><mrow id="alg1.1.m1.3.4.2" xref="alg1.1.m1.3.4.1.cmml"><mo stretchy="false" id="alg1.1.m1.3.4.2.1" xref="alg1.1.m1.3.4.1.cmml">{</mo><mn id="alg1.1.m1.1.1" xref="alg1.1.m1.1.1.cmml">1</mn><mo id="alg1.1.m1.3.4.2.2" xref="alg1.1.m1.3.4.1.cmml">,</mo><mi mathvariant="normal" id="alg1.1.m1.2.2" xref="alg1.1.m1.2.2.cmml">…</mi><mo id="alg1.1.m1.3.4.2.3" xref="alg1.1.m1.3.4.1.cmml">,</mo><mi id="alg1.1.m1.3.3" xref="alg1.1.m1.3.3.cmml">n</mi><mo stretchy="false" id="alg1.1.m1.3.4.2.4" xref="alg1.1.m1.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.1.m1.3b"><set id="alg1.1.m1.3.4.1.cmml" xref="alg1.1.m1.3.4.2"><cn type="integer" id="alg1.1.m1.1.1.cmml" xref="alg1.1.m1.1.1">1</cn><ci id="alg1.1.m1.2.2.cmml" xref="alg1.1.m1.2.2">…</ci><ci id="alg1.1.m1.3.3.cmml" xref="alg1.1.m1.3.3">𝑛</ci></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.m1.3c">\{1,\dots,n\}</annotation></semantics></math>, server-side proxy dataset, communication round <math id="alg1.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.2.m2.1a"><mi id="alg1.2.m2.1.1" xref="alg1.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.2.m2.1b"><ci id="alg1.2.m2.1.1.cmml" xref="alg1.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m2.1c">T</annotation></semantics></math>, local epoch <math id="alg1.3.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.3.m3.1a"><mi id="alg1.3.m3.1.1" xref="alg1.3.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.3.m3.1b"><ci id="alg1.3.m3.1.1.cmml" xref="alg1.3.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.m3.1c">E</annotation></semantics></math>, server epoch <math id="alg1.4.m4.1" class="ltx_Math" alttext="E_{s}" display="inline"><semantics id="alg1.4.m4.1a"><msub id="alg1.4.m4.1.1" xref="alg1.4.m4.1.1.cmml"><mi id="alg1.4.m4.1.1.2" xref="alg1.4.m4.1.1.2.cmml">E</mi><mi id="alg1.4.m4.1.1.3" xref="alg1.4.m4.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.4.m4.1b"><apply id="alg1.4.m4.1.1.cmml" xref="alg1.4.m4.1.1"><csymbol cd="ambiguous" id="alg1.4.m4.1.1.1.cmml" xref="alg1.4.m4.1.1">subscript</csymbol><ci id="alg1.4.m4.1.1.2.cmml" xref="alg1.4.m4.1.1.2">𝐸</ci><ci id="alg1.4.m4.1.1.3.cmml" xref="alg1.4.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.m4.1c">E_{s}</annotation></semantics></math>, initial global model <math id="alg1.5.m5.1" class="ltx_Math" alttext="\textbf{w}_{g}^{1}" display="inline"><semantics id="alg1.5.m5.1a"><msubsup id="alg1.5.m5.1.1" xref="alg1.5.m5.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.5.m5.1.1.2.2" xref="alg1.5.m5.1.1.2.2a.cmml">w</mtext><mi id="alg1.5.m5.1.1.2.3" xref="alg1.5.m5.1.1.2.3.cmml">g</mi><mn id="alg1.5.m5.1.1.3" xref="alg1.5.m5.1.1.3.cmml">1</mn></msubsup><annotation-xml encoding="MathML-Content" id="alg1.5.m5.1b"><apply id="alg1.5.m5.1.1.cmml" xref="alg1.5.m5.1.1"><csymbol cd="ambiguous" id="alg1.5.m5.1.1.1.cmml" xref="alg1.5.m5.1.1">superscript</csymbol><apply id="alg1.5.m5.1.1.2.cmml" xref="alg1.5.m5.1.1"><csymbol cd="ambiguous" id="alg1.5.m5.1.1.2.1.cmml" xref="alg1.5.m5.1.1">subscript</csymbol><ci id="alg1.5.m5.1.1.2.2a.cmml" xref="alg1.5.m5.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="alg1.5.m5.1.1.2.2.cmml" xref="alg1.5.m5.1.1.2.2">w</mtext></ci><ci id="alg1.5.m5.1.1.2.3.cmml" xref="alg1.5.m5.1.1.2.3">𝑔</ci></apply><cn type="integer" id="alg1.5.m5.1.1.3.cmml" xref="alg1.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.m5.1c">\textbf{w}_{g}^{1}</annotation></semantics></math>;
<br class="ltx_break"><span id="alg1.6.2" class="ltx_text ltx_font_bold">Output</span>: final global model <math id="alg1.6.m6.1" class="ltx_Math" alttext="\textbf{w}_{g}^{T}" display="inline"><semantics id="alg1.6.m6.1a"><msubsup id="alg1.6.m6.1.1" xref="alg1.6.m6.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.6.m6.1.1.2.2" xref="alg1.6.m6.1.1.2.2a.cmml">w</mtext><mi id="alg1.6.m6.1.1.2.3" xref="alg1.6.m6.1.1.2.3.cmml">g</mi><mi id="alg1.6.m6.1.1.3" xref="alg1.6.m6.1.1.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.6.m6.1b"><apply id="alg1.6.m6.1.1.cmml" xref="alg1.6.m6.1.1"><csymbol cd="ambiguous" id="alg1.6.m6.1.1.1.cmml" xref="alg1.6.m6.1.1">superscript</csymbol><apply id="alg1.6.m6.1.1.2.cmml" xref="alg1.6.m6.1.1"><csymbol cd="ambiguous" id="alg1.6.m6.1.1.2.1.cmml" xref="alg1.6.m6.1.1">subscript</csymbol><ci id="alg1.6.m6.1.1.2.2a.cmml" xref="alg1.6.m6.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="alg1.6.m6.1.1.2.2.cmml" xref="alg1.6.m6.1.1.2.2">w</mtext></ci><ci id="alg1.6.m6.1.1.2.3.cmml" xref="alg1.6.m6.1.1.2.3">𝑔</ci></apply><ci id="alg1.6.m6.1.1.3.cmml" xref="alg1.6.m6.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.m6.1c">\textbf{w}_{g}^{T}</annotation></semantics></math>;</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.11" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  <span id="alg1.l1.2" class="ltx_text ltx_font_bold">for</span> each round <math id="alg1.l1.m1.3" class="ltx_Math" alttext="t=1,\dots,T" display="inline"><semantics id="alg1.l1.m1.3a"><mrow id="alg1.l1.m1.3.4" xref="alg1.l1.m1.3.4.cmml"><mi id="alg1.l1.m1.3.4.2" xref="alg1.l1.m1.3.4.2.cmml">t</mi><mo id="alg1.l1.m1.3.4.1" xref="alg1.l1.m1.3.4.1.cmml">=</mo><mrow id="alg1.l1.m1.3.4.3.2" xref="alg1.l1.m1.3.4.3.1.cmml"><mn id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">1</mn><mo id="alg1.l1.m1.3.4.3.2.1" xref="alg1.l1.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l1.m1.2.2" xref="alg1.l1.m1.2.2.cmml">…</mi><mo id="alg1.l1.m1.3.4.3.2.2" xref="alg1.l1.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l1.m1.3.3" xref="alg1.l1.m1.3.3.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.3b"><apply id="alg1.l1.m1.3.4.cmml" xref="alg1.l1.m1.3.4"><eq id="alg1.l1.m1.3.4.1.cmml" xref="alg1.l1.m1.3.4.1"></eq><ci id="alg1.l1.m1.3.4.2.cmml" xref="alg1.l1.m1.3.4.2">𝑡</ci><list id="alg1.l1.m1.3.4.3.1.cmml" xref="alg1.l1.m1.3.4.3.2"><cn type="integer" id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">1</cn><ci id="alg1.l1.m1.2.2.cmml" xref="alg1.l1.m1.2.2">…</ci><ci id="alg1.l1.m1.3.3.cmml" xref="alg1.l1.m1.3.3">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.3c">t=1,\dots,T</annotation></semantics></math> <span id="alg1.l1.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>     <span id="alg1.l2.2" class="ltx_text ltx_font_typewriter"># Client updates</span>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>     <span id="alg1.l3.2" class="ltx_text ltx_font_bold">for</span> each client <math id="alg1.l3.m1.3" class="ltx_Math" alttext="i,i\in[n]" display="inline"><semantics id="alg1.l3.m1.3a"><mrow id="alg1.l3.m1.3.4" xref="alg1.l3.m1.3.4.cmml"><mrow id="alg1.l3.m1.3.4.2.2" xref="alg1.l3.m1.3.4.2.1.cmml"><mi id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml">i</mi><mo id="alg1.l3.m1.3.4.2.2.1" xref="alg1.l3.m1.3.4.2.1.cmml">,</mo><mi id="alg1.l3.m1.3.3" xref="alg1.l3.m1.3.3.cmml">i</mi></mrow><mo id="alg1.l3.m1.3.4.1" xref="alg1.l3.m1.3.4.1.cmml">∈</mo><mrow id="alg1.l3.m1.3.4.3.2" xref="alg1.l3.m1.3.4.3.1.cmml"><mo stretchy="false" id="alg1.l3.m1.3.4.3.2.1" xref="alg1.l3.m1.3.4.3.1.1.cmml">[</mo><mi id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">n</mi><mo stretchy="false" id="alg1.l3.m1.3.4.3.2.2" xref="alg1.l3.m1.3.4.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.3b"><apply id="alg1.l3.m1.3.4.cmml" xref="alg1.l3.m1.3.4"><in id="alg1.l3.m1.3.4.1.cmml" xref="alg1.l3.m1.3.4.1"></in><list id="alg1.l3.m1.3.4.2.1.cmml" xref="alg1.l3.m1.3.4.2.2"><ci id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2">𝑖</ci><ci id="alg1.l3.m1.3.3.cmml" xref="alg1.l3.m1.3.3">𝑖</ci></list><apply id="alg1.l3.m1.3.4.3.1.cmml" xref="alg1.l3.m1.3.4.3.2"><csymbol cd="latexml" id="alg1.l3.m1.3.4.3.1.1.cmml" xref="alg1.l3.m1.3.4.3.2.1">delimited-[]</csymbol><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.3c">i,i\in[n]</annotation></semantics></math> <span id="alg1.l3.3" class="ltx_text ltx_font_bold">in parallel</span> <span id="alg1.l3.4" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>        Set local model <math id="alg1.l4.m1.1" class="ltx_Math" alttext="\textbf{w}_{i}^{t}\leftarrow\textbf{w}_{g}^{t}" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><msubsup id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.l4.m1.1.1.2.2.2" xref="alg1.l4.m1.1.1.2.2.2a.cmml">w</mtext><mi id="alg1.l4.m1.1.1.2.2.3" xref="alg1.l4.m1.1.1.2.2.3.cmml">i</mi><mi id="alg1.l4.m1.1.1.2.3" xref="alg1.l4.m1.1.1.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">←</mo><msubsup id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.l4.m1.1.1.3.2.2" xref="alg1.l4.m1.1.1.3.2.2a.cmml">w</mtext><mi id="alg1.l4.m1.1.1.3.2.3" xref="alg1.l4.m1.1.1.3.2.3.cmml">g</mi><mi id="alg1.l4.m1.1.1.3.3" xref="alg1.l4.m1.1.1.3.3.cmml">t</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><ci id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1">←</ci><apply id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.2">superscript</csymbol><apply id="alg1.l4.m1.1.1.2.2.cmml" xref="alg1.l4.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.2.2.1.cmml" xref="alg1.l4.m1.1.1.2">subscript</csymbol><ci id="alg1.l4.m1.1.1.2.2.2a.cmml" xref="alg1.l4.m1.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="alg1.l4.m1.1.1.2.2.2.cmml" xref="alg1.l4.m1.1.1.2.2.2">w</mtext></ci><ci id="alg1.l4.m1.1.1.2.2.3.cmml" xref="alg1.l4.m1.1.1.2.2.3">𝑖</ci></apply><ci id="alg1.l4.m1.1.1.2.3.cmml" xref="alg1.l4.m1.1.1.2.3">𝑡</ci></apply><apply id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.3">superscript</csymbol><apply id="alg1.l4.m1.1.1.3.2.cmml" xref="alg1.l4.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.3.2.1.cmml" xref="alg1.l4.m1.1.1.3">subscript</csymbol><ci id="alg1.l4.m1.1.1.3.2.2a.cmml" xref="alg1.l4.m1.1.1.3.2.2"><mtext class="ltx_mathvariant_bold" id="alg1.l4.m1.1.1.3.2.2.cmml" xref="alg1.l4.m1.1.1.3.2.2">w</mtext></ci><ci id="alg1.l4.m1.1.1.3.2.3.cmml" xref="alg1.l4.m1.1.1.3.2.3">𝑔</ci></apply><ci id="alg1.l4.m1.1.1.3.3.cmml" xref="alg1.l4.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\textbf{w}_{i}^{t}\leftarrow\textbf{w}_{g}^{t}</annotation></semantics></math>;

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>        Compute <math id="alg1.l5.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.l5.m1.1a"><mi id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">E</annotation></semantics></math> epochs of client local training by <a href="#S3.E1" title="Equation 1 ‣ 3 Preliminary and Problem Setup ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Equation 1</span></a>:

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>          <math id="alg1.l6.m1.1" class="ltx_Math" alttext="\mathbf{w}_{i}^{t}\leftarrow\mathbf{w}_{i}^{t}-\eta_{l}\nabla\mathcal{L}_{i}\left(\mathbf{w}_{i}^{t}\right)" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><msubsup id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.3.2.2" xref="alg1.l6.m1.1.1.3.2.2.cmml">𝐰</mi><mi id="alg1.l6.m1.1.1.3.2.3" xref="alg1.l6.m1.1.1.3.2.3.cmml">i</mi><mi id="alg1.l6.m1.1.1.3.3" xref="alg1.l6.m1.1.1.3.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">←</mo><mrow id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml"><msubsup id="alg1.l6.m1.1.1.1.3" xref="alg1.l6.m1.1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.1.3.2.2" xref="alg1.l6.m1.1.1.1.3.2.2.cmml">𝐰</mi><mi id="alg1.l6.m1.1.1.1.3.2.3" xref="alg1.l6.m1.1.1.1.3.2.3.cmml">i</mi><mi id="alg1.l6.m1.1.1.1.3.3" xref="alg1.l6.m1.1.1.1.3.3.cmml">t</mi></msubsup><mo id="alg1.l6.m1.1.1.1.2" xref="alg1.l6.m1.1.1.1.2.cmml">−</mo><mrow id="alg1.l6.m1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.cmml"><msub id="alg1.l6.m1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.1.1.3.2" xref="alg1.l6.m1.1.1.1.1.3.2.cmml">η</mi><mi id="alg1.l6.m1.1.1.1.1.3.3" xref="alg1.l6.m1.1.1.1.1.3.3.cmml">l</mi></msub><mo lspace="0.167em" rspace="0em" id="alg1.l6.m1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l6.m1.1.1.1.1.4" xref="alg1.l6.m1.1.1.1.1.4.cmml"><mo rspace="0.167em" id="alg1.l6.m1.1.1.1.1.4.1" xref="alg1.l6.m1.1.1.1.1.4.1.cmml">∇</mo><msub id="alg1.l6.m1.1.1.1.1.4.2" xref="alg1.l6.m1.1.1.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m1.1.1.1.1.4.2.2" xref="alg1.l6.m1.1.1.1.1.4.2.2.cmml">ℒ</mi><mi id="alg1.l6.m1.1.1.1.1.4.2.3" xref="alg1.l6.m1.1.1.1.1.4.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.1.1.1.2a" xref="alg1.l6.m1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l6.m1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l6.m1.1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="alg1.l6.m1.1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l6.m1.1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="alg1.l6.m1.1.1.1.1.1.1.1.2.3" xref="alg1.l6.m1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="alg1.l6.m1.1.1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="alg1.l6.m1.1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">←</ci><apply id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.3">superscript</csymbol><apply id="alg1.l6.m1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.2.1.cmml" xref="alg1.l6.m1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.3.2.2.cmml" xref="alg1.l6.m1.1.1.3.2.2">𝐰</ci><ci id="alg1.l6.m1.1.1.3.2.3.cmml" xref="alg1.l6.m1.1.1.3.2.3">𝑖</ci></apply><ci id="alg1.l6.m1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.3.3">𝑡</ci></apply><apply id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1"><minus id="alg1.l6.m1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.2"></minus><apply id="alg1.l6.m1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.1.3">superscript</csymbol><apply id="alg1.l6.m1.1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.3.2.1.cmml" xref="alg1.l6.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.3.2.2.cmml" xref="alg1.l6.m1.1.1.1.3.2.2">𝐰</ci><ci id="alg1.l6.m1.1.1.1.3.2.3.cmml" xref="alg1.l6.m1.1.1.1.3.2.3">𝑖</ci></apply><ci id="alg1.l6.m1.1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.1.3.3">𝑡</ci></apply><apply id="alg1.l6.m1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1"><times id="alg1.l6.m1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.2"></times><apply id="alg1.l6.m1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.1.1.3.2">𝜂</ci><ci id="alg1.l6.m1.1.1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.1.1.3.3">𝑙</ci></apply><apply id="alg1.l6.m1.1.1.1.1.4.cmml" xref="alg1.l6.m1.1.1.1.1.4"><ci id="alg1.l6.m1.1.1.1.1.4.1.cmml" xref="alg1.l6.m1.1.1.1.1.4.1">∇</ci><apply id="alg1.l6.m1.1.1.1.1.4.2.cmml" xref="alg1.l6.m1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.4.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.4.2">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.4.2.2.cmml" xref="alg1.l6.m1.1.1.1.1.4.2.2">ℒ</ci><ci id="alg1.l6.m1.1.1.1.1.4.2.3.cmml" xref="alg1.l6.m1.1.1.1.1.4.2.3">𝑖</ci></apply></apply><apply id="alg1.l6.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l6.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.2.2">𝐰</ci><ci id="alg1.l6.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="alg1.l6.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">\mathbf{w}_{i}^{t}\leftarrow\mathbf{w}_{i}^{t}-\eta_{l}\nabla\mathcal{L}_{i}\left(\mathbf{w}_{i}^{t}\right)</annotation></semantics></math>;

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>     <span id="alg1.l7.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l7.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>     <span id="alg1.l8.2" class="ltx_text ltx_font_typewriter"># Server updates</span>

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>     The server samples <math id="alg1.l9.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="alg1.l9.m1.1a"><mi id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><ci id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">m</annotation></semantics></math> clients and receive their models <math id="alg1.l9.m2.1" class="ltx_Math" alttext="\{\mathbf{w}_{i}^{t}\}_{i=1}^{m}" display="inline"><semantics id="alg1.l9.m2.1a"><msubsup id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml"><mrow id="alg1.l9.m2.1.1.1.1.1" xref="alg1.l9.m2.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l9.m2.1.1.1.1.1.2" xref="alg1.l9.m2.1.1.1.1.2.cmml">{</mo><msubsup id="alg1.l9.m2.1.1.1.1.1.1" xref="alg1.l9.m2.1.1.1.1.1.1.cmml"><mi id="alg1.l9.m2.1.1.1.1.1.1.2.2" xref="alg1.l9.m2.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="alg1.l9.m2.1.1.1.1.1.1.2.3" xref="alg1.l9.m2.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="alg1.l9.m2.1.1.1.1.1.1.3" xref="alg1.l9.m2.1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l9.m2.1.1.1.1.1.3" xref="alg1.l9.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l9.m2.1.1.1.3" xref="alg1.l9.m2.1.1.1.3.cmml"><mi id="alg1.l9.m2.1.1.1.3.2" xref="alg1.l9.m2.1.1.1.3.2.cmml">i</mi><mo id="alg1.l9.m2.1.1.1.3.1" xref="alg1.l9.m2.1.1.1.3.1.cmml">=</mo><mn id="alg1.l9.m2.1.1.1.3.3" xref="alg1.l9.m2.1.1.1.3.3.cmml">1</mn></mrow><mi id="alg1.l9.m2.1.1.3" xref="alg1.l9.m2.1.1.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><apply id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.2.cmml" xref="alg1.l9.m2.1.1">superscript</csymbol><apply id="alg1.l9.m2.1.1.1.cmml" xref="alg1.l9.m2.1.1"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.1.2.cmml" xref="alg1.l9.m2.1.1">subscript</csymbol><set id="alg1.l9.m2.1.1.1.1.2.cmml" xref="alg1.l9.m2.1.1.1.1.1"><apply id="alg1.l9.m2.1.1.1.1.1.1.cmml" xref="alg1.l9.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m2.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l9.m2.1.1.1.1.1.1.2.cmml" xref="alg1.l9.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.1.1.1.1.2.1.cmml" xref="alg1.l9.m2.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l9.m2.1.1.1.1.1.1.2.2.cmml" xref="alg1.l9.m2.1.1.1.1.1.1.2.2">𝐰</ci><ci id="alg1.l9.m2.1.1.1.1.1.1.2.3.cmml" xref="alg1.l9.m2.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="alg1.l9.m2.1.1.1.1.1.1.3.cmml" xref="alg1.l9.m2.1.1.1.1.1.1.3">𝑡</ci></apply></set><apply id="alg1.l9.m2.1.1.1.3.cmml" xref="alg1.l9.m2.1.1.1.3"><eq id="alg1.l9.m2.1.1.1.3.1.cmml" xref="alg1.l9.m2.1.1.1.3.1"></eq><ci id="alg1.l9.m2.1.1.1.3.2.cmml" xref="alg1.l9.m2.1.1.1.3.2">𝑖</ci><cn type="integer" id="alg1.l9.m2.1.1.1.3.3.cmml" xref="alg1.l9.m2.1.1.1.3.3">1</cn></apply></apply><ci id="alg1.l9.m2.1.1.3.cmml" xref="alg1.l9.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">\{\mathbf{w}_{i}^{t}\}_{i=1}^{m}</annotation></semantics></math>;

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>     The server sets initial <math id="alg1.l10.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="alg1.l10.m1.1a"><mi id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><ci id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">\gamma</annotation></semantics></math> and <math id="alg1.l10.m2.1" class="ltx_Math" alttext="\boldsymbol{\lambda}" display="inline"><semantics id="alg1.l10.m2.1a"><mi id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml">𝝀</mi><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.1b"><ci id="alg1.l10.m2.1.1.cmml" xref="alg1.l10.m2.1.1">𝝀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.1c">\boldsymbol{\lambda}</annotation></semantics></math> as <math id="alg1.l10.m3.3" class="ltx_Math" alttext="\{\gamma=1,\lambda_{i}=\frac{|\mathcal{D}_{i}|}{|\mathcal{D}|}\}" display="inline"><semantics id="alg1.l10.m3.3a"><mrow id="alg1.l10.m3.3.3.1" xref="alg1.l10.m3.3.3.2.cmml"><mo stretchy="false" id="alg1.l10.m3.3.3.1.2" xref="alg1.l10.m3.3.3.2.cmml">{</mo><mrow id="alg1.l10.m3.3.3.1.1.2" xref="alg1.l10.m3.3.3.1.1.3.cmml"><mrow id="alg1.l10.m3.3.3.1.1.1.1" xref="alg1.l10.m3.3.3.1.1.1.1.cmml"><mi id="alg1.l10.m3.3.3.1.1.1.1.2" xref="alg1.l10.m3.3.3.1.1.1.1.2.cmml">γ</mi><mo id="alg1.l10.m3.3.3.1.1.1.1.1" xref="alg1.l10.m3.3.3.1.1.1.1.1.cmml">=</mo><mn id="alg1.l10.m3.3.3.1.1.1.1.3" xref="alg1.l10.m3.3.3.1.1.1.1.3.cmml">1</mn></mrow><mo id="alg1.l10.m3.3.3.1.1.2.3" xref="alg1.l10.m3.3.3.1.1.3a.cmml">,</mo><mrow id="alg1.l10.m3.3.3.1.1.2.2" xref="alg1.l10.m3.3.3.1.1.2.2.cmml"><msub id="alg1.l10.m3.3.3.1.1.2.2.2" xref="alg1.l10.m3.3.3.1.1.2.2.2.cmml"><mi id="alg1.l10.m3.3.3.1.1.2.2.2.2" xref="alg1.l10.m3.3.3.1.1.2.2.2.2.cmml">λ</mi><mi id="alg1.l10.m3.3.3.1.1.2.2.2.3" xref="alg1.l10.m3.3.3.1.1.2.2.2.3.cmml">i</mi></msub><mo id="alg1.l10.m3.3.3.1.1.2.2.1" xref="alg1.l10.m3.3.3.1.1.2.2.1.cmml">=</mo><mfrac id="alg1.l10.m3.2.2" xref="alg1.l10.m3.2.2.cmml"><mrow id="alg1.l10.m3.1.1.1.1" xref="alg1.l10.m3.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l10.m3.1.1.1.1.2" xref="alg1.l10.m3.1.1.1.2.1.cmml">|</mo><msub id="alg1.l10.m3.1.1.1.1.1" xref="alg1.l10.m3.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m3.1.1.1.1.1.2" xref="alg1.l10.m3.1.1.1.1.1.2.cmml">𝒟</mi><mi id="alg1.l10.m3.1.1.1.1.1.3" xref="alg1.l10.m3.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l10.m3.1.1.1.1.3" xref="alg1.l10.m3.1.1.1.2.1.cmml">|</mo></mrow><mrow id="alg1.l10.m3.2.2.2.3" xref="alg1.l10.m3.2.2.2.2.cmml"><mo stretchy="false" id="alg1.l10.m3.2.2.2.3.1" xref="alg1.l10.m3.2.2.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m3.2.2.2.1" xref="alg1.l10.m3.2.2.2.1.cmml">𝒟</mi><mo stretchy="false" id="alg1.l10.m3.2.2.2.3.2" xref="alg1.l10.m3.2.2.2.2.1.cmml">|</mo></mrow></mfrac></mrow></mrow><mo stretchy="false" id="alg1.l10.m3.3.3.1.3" xref="alg1.l10.m3.3.3.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m3.3b"><set id="alg1.l10.m3.3.3.2.cmml" xref="alg1.l10.m3.3.3.1"><apply id="alg1.l10.m3.3.3.1.1.3.cmml" xref="alg1.l10.m3.3.3.1.1.2"><csymbol cd="ambiguous" id="alg1.l10.m3.3.3.1.1.3a.cmml" xref="alg1.l10.m3.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="alg1.l10.m3.3.3.1.1.1.1.cmml" xref="alg1.l10.m3.3.3.1.1.1.1"><eq id="alg1.l10.m3.3.3.1.1.1.1.1.cmml" xref="alg1.l10.m3.3.3.1.1.1.1.1"></eq><ci id="alg1.l10.m3.3.3.1.1.1.1.2.cmml" xref="alg1.l10.m3.3.3.1.1.1.1.2">𝛾</ci><cn type="integer" id="alg1.l10.m3.3.3.1.1.1.1.3.cmml" xref="alg1.l10.m3.3.3.1.1.1.1.3">1</cn></apply><apply id="alg1.l10.m3.3.3.1.1.2.2.cmml" xref="alg1.l10.m3.3.3.1.1.2.2"><eq id="alg1.l10.m3.3.3.1.1.2.2.1.cmml" xref="alg1.l10.m3.3.3.1.1.2.2.1"></eq><apply id="alg1.l10.m3.3.3.1.1.2.2.2.cmml" xref="alg1.l10.m3.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l10.m3.3.3.1.1.2.2.2.1.cmml" xref="alg1.l10.m3.3.3.1.1.2.2.2">subscript</csymbol><ci id="alg1.l10.m3.3.3.1.1.2.2.2.2.cmml" xref="alg1.l10.m3.3.3.1.1.2.2.2.2">𝜆</ci><ci id="alg1.l10.m3.3.3.1.1.2.2.2.3.cmml" xref="alg1.l10.m3.3.3.1.1.2.2.2.3">𝑖</ci></apply><apply id="alg1.l10.m3.2.2.cmml" xref="alg1.l10.m3.2.2"><divide id="alg1.l10.m3.2.2.3.cmml" xref="alg1.l10.m3.2.2"></divide><apply id="alg1.l10.m3.1.1.1.2.cmml" xref="alg1.l10.m3.1.1.1.1"><abs id="alg1.l10.m3.1.1.1.2.1.cmml" xref="alg1.l10.m3.1.1.1.1.2"></abs><apply id="alg1.l10.m3.1.1.1.1.1.cmml" xref="alg1.l10.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m3.1.1.1.1.1.1.cmml" xref="alg1.l10.m3.1.1.1.1.1">subscript</csymbol><ci id="alg1.l10.m3.1.1.1.1.1.2.cmml" xref="alg1.l10.m3.1.1.1.1.1.2">𝒟</ci><ci id="alg1.l10.m3.1.1.1.1.1.3.cmml" xref="alg1.l10.m3.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="alg1.l10.m3.2.2.2.2.cmml" xref="alg1.l10.m3.2.2.2.3"><abs id="alg1.l10.m3.2.2.2.2.1.cmml" xref="alg1.l10.m3.2.2.2.3.1"></abs><ci id="alg1.l10.m3.2.2.2.1.cmml" xref="alg1.l10.m3.2.2.2.1">𝒟</ci></apply></apply></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m3.3c">\{\gamma=1,\lambda_{i}=\frac{|\mathcal{D}_{i}|}{|\mathcal{D}|}\}</annotation></semantics></math>;

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>     Compute <math id="alg1.l11.m1.1" class="ltx_Math" alttext="E_{s}" display="inline"><semantics id="alg1.l11.m1.1a"><msub id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml">E</mi><mi id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1">subscript</csymbol><ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">𝐸</ci><ci id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">E_{s}</annotation></semantics></math> epochs of aggregation weight learning on the proxy dataset by <a href="#S6.E8" title="Equation 8 ‣ 6.1 Method ‣ 6 FedLAW ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Equation 8</span></a>:

</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>       <math id="alg1.l12.m1.7" class="ltx_Math" alttext="\{\gamma,\boldsymbol{\lambda}\}\leftarrow\{\gamma,\boldsymbol{\lambda}\}-\eta_{s}\nabla\mathcal{L}_{proxy}\left(\{\gamma,\boldsymbol{\lambda}\}\right)" display="inline"><semantics id="alg1.l12.m1.7a"><mrow id="alg1.l12.m1.7.7" xref="alg1.l12.m1.7.7.cmml"><mrow id="alg1.l12.m1.7.7.3.2" xref="alg1.l12.m1.7.7.3.1.cmml"><mo stretchy="false" id="alg1.l12.m1.7.7.3.2.1" xref="alg1.l12.m1.7.7.3.1.cmml">{</mo><mi id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml">γ</mi><mo id="alg1.l12.m1.7.7.3.2.2" xref="alg1.l12.m1.7.7.3.1.cmml">,</mo><mi id="alg1.l12.m1.2.2" xref="alg1.l12.m1.2.2.cmml">𝝀</mi><mo stretchy="false" id="alg1.l12.m1.7.7.3.2.3" xref="alg1.l12.m1.7.7.3.1.cmml">}</mo></mrow><mo stretchy="false" id="alg1.l12.m1.7.7.2" xref="alg1.l12.m1.7.7.2.cmml">←</mo><mrow id="alg1.l12.m1.7.7.1" xref="alg1.l12.m1.7.7.1.cmml"><mrow id="alg1.l12.m1.7.7.1.3.2" xref="alg1.l12.m1.7.7.1.3.1.cmml"><mo stretchy="false" id="alg1.l12.m1.7.7.1.3.2.1" xref="alg1.l12.m1.7.7.1.3.1.cmml">{</mo><mi id="alg1.l12.m1.3.3" xref="alg1.l12.m1.3.3.cmml">γ</mi><mo id="alg1.l12.m1.7.7.1.3.2.2" xref="alg1.l12.m1.7.7.1.3.1.cmml">,</mo><mi id="alg1.l12.m1.4.4" xref="alg1.l12.m1.4.4.cmml">𝝀</mi><mo stretchy="false" id="alg1.l12.m1.7.7.1.3.2.3" xref="alg1.l12.m1.7.7.1.3.1.cmml">}</mo></mrow><mo id="alg1.l12.m1.7.7.1.2" xref="alg1.l12.m1.7.7.1.2.cmml">−</mo><mrow id="alg1.l12.m1.7.7.1.1" xref="alg1.l12.m1.7.7.1.1.cmml"><msub id="alg1.l12.m1.7.7.1.1.3" xref="alg1.l12.m1.7.7.1.1.3.cmml"><mi id="alg1.l12.m1.7.7.1.1.3.2" xref="alg1.l12.m1.7.7.1.1.3.2.cmml">η</mi><mi id="alg1.l12.m1.7.7.1.1.3.3" xref="alg1.l12.m1.7.7.1.1.3.3.cmml">s</mi></msub><mo lspace="0.167em" rspace="0em" id="alg1.l12.m1.7.7.1.1.2" xref="alg1.l12.m1.7.7.1.1.2.cmml">​</mo><mrow id="alg1.l12.m1.7.7.1.1.4" xref="alg1.l12.m1.7.7.1.1.4.cmml"><mo rspace="0.167em" id="alg1.l12.m1.7.7.1.1.4.1" xref="alg1.l12.m1.7.7.1.1.4.1.cmml">∇</mo><msub id="alg1.l12.m1.7.7.1.1.4.2" xref="alg1.l12.m1.7.7.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.7.7.1.1.4.2.2" xref="alg1.l12.m1.7.7.1.1.4.2.2.cmml">ℒ</mi><mrow id="alg1.l12.m1.7.7.1.1.4.2.3" xref="alg1.l12.m1.7.7.1.1.4.2.3.cmml"><mi id="alg1.l12.m1.7.7.1.1.4.2.3.2" xref="alg1.l12.m1.7.7.1.1.4.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.7.7.1.1.4.2.3.1" xref="alg1.l12.m1.7.7.1.1.4.2.3.1.cmml">​</mo><mi id="alg1.l12.m1.7.7.1.1.4.2.3.3" xref="alg1.l12.m1.7.7.1.1.4.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.7.7.1.1.4.2.3.1a" xref="alg1.l12.m1.7.7.1.1.4.2.3.1.cmml">​</mo><mi id="alg1.l12.m1.7.7.1.1.4.2.3.4" xref="alg1.l12.m1.7.7.1.1.4.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.7.7.1.1.4.2.3.1b" xref="alg1.l12.m1.7.7.1.1.4.2.3.1.cmml">​</mo><mi id="alg1.l12.m1.7.7.1.1.4.2.3.5" xref="alg1.l12.m1.7.7.1.1.4.2.3.5.cmml">x</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.7.7.1.1.4.2.3.1c" xref="alg1.l12.m1.7.7.1.1.4.2.3.1.cmml">​</mo><mi id="alg1.l12.m1.7.7.1.1.4.2.3.6" xref="alg1.l12.m1.7.7.1.1.4.2.3.6.cmml">y</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l12.m1.7.7.1.1.2a" xref="alg1.l12.m1.7.7.1.1.2.cmml">​</mo><mrow id="alg1.l12.m1.7.7.1.1.1.1" xref="alg1.l12.m1.7.7.1.1.cmml"><mo id="alg1.l12.m1.7.7.1.1.1.1.2" xref="alg1.l12.m1.7.7.1.1.cmml">(</mo><mrow id="alg1.l12.m1.7.7.1.1.1.1.1.2" xref="alg1.l12.m1.7.7.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l12.m1.7.7.1.1.1.1.1.2.1" xref="alg1.l12.m1.7.7.1.1.1.1.1.1.cmml">{</mo><mi id="alg1.l12.m1.5.5" xref="alg1.l12.m1.5.5.cmml">γ</mi><mo id="alg1.l12.m1.7.7.1.1.1.1.1.2.2" xref="alg1.l12.m1.7.7.1.1.1.1.1.1.cmml">,</mo><mi id="alg1.l12.m1.6.6" xref="alg1.l12.m1.6.6.cmml">𝝀</mi><mo stretchy="false" id="alg1.l12.m1.7.7.1.1.1.1.1.2.3" xref="alg1.l12.m1.7.7.1.1.1.1.1.1.cmml">}</mo></mrow><mo id="alg1.l12.m1.7.7.1.1.1.1.3" xref="alg1.l12.m1.7.7.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.7b"><apply id="alg1.l12.m1.7.7.cmml" xref="alg1.l12.m1.7.7"><ci id="alg1.l12.m1.7.7.2.cmml" xref="alg1.l12.m1.7.7.2">←</ci><set id="alg1.l12.m1.7.7.3.1.cmml" xref="alg1.l12.m1.7.7.3.2"><ci id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1">𝛾</ci><ci id="alg1.l12.m1.2.2.cmml" xref="alg1.l12.m1.2.2">𝝀</ci></set><apply id="alg1.l12.m1.7.7.1.cmml" xref="alg1.l12.m1.7.7.1"><minus id="alg1.l12.m1.7.7.1.2.cmml" xref="alg1.l12.m1.7.7.1.2"></minus><set id="alg1.l12.m1.7.7.1.3.1.cmml" xref="alg1.l12.m1.7.7.1.3.2"><ci id="alg1.l12.m1.3.3.cmml" xref="alg1.l12.m1.3.3">𝛾</ci><ci id="alg1.l12.m1.4.4.cmml" xref="alg1.l12.m1.4.4">𝝀</ci></set><apply id="alg1.l12.m1.7.7.1.1.cmml" xref="alg1.l12.m1.7.7.1.1"><times id="alg1.l12.m1.7.7.1.1.2.cmml" xref="alg1.l12.m1.7.7.1.1.2"></times><apply id="alg1.l12.m1.7.7.1.1.3.cmml" xref="alg1.l12.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="alg1.l12.m1.7.7.1.1.3.1.cmml" xref="alg1.l12.m1.7.7.1.1.3">subscript</csymbol><ci id="alg1.l12.m1.7.7.1.1.3.2.cmml" xref="alg1.l12.m1.7.7.1.1.3.2">𝜂</ci><ci id="alg1.l12.m1.7.7.1.1.3.3.cmml" xref="alg1.l12.m1.7.7.1.1.3.3">𝑠</ci></apply><apply id="alg1.l12.m1.7.7.1.1.4.cmml" xref="alg1.l12.m1.7.7.1.1.4"><ci id="alg1.l12.m1.7.7.1.1.4.1.cmml" xref="alg1.l12.m1.7.7.1.1.4.1">∇</ci><apply id="alg1.l12.m1.7.7.1.1.4.2.cmml" xref="alg1.l12.m1.7.7.1.1.4.2"><csymbol cd="ambiguous" id="alg1.l12.m1.7.7.1.1.4.2.1.cmml" xref="alg1.l12.m1.7.7.1.1.4.2">subscript</csymbol><ci id="alg1.l12.m1.7.7.1.1.4.2.2.cmml" xref="alg1.l12.m1.7.7.1.1.4.2.2">ℒ</ci><apply id="alg1.l12.m1.7.7.1.1.4.2.3.cmml" xref="alg1.l12.m1.7.7.1.1.4.2.3"><times id="alg1.l12.m1.7.7.1.1.4.2.3.1.cmml" xref="alg1.l12.m1.7.7.1.1.4.2.3.1"></times><ci id="alg1.l12.m1.7.7.1.1.4.2.3.2.cmml" xref="alg1.l12.m1.7.7.1.1.4.2.3.2">𝑝</ci><ci id="alg1.l12.m1.7.7.1.1.4.2.3.3.cmml" xref="alg1.l12.m1.7.7.1.1.4.2.3.3">𝑟</ci><ci id="alg1.l12.m1.7.7.1.1.4.2.3.4.cmml" xref="alg1.l12.m1.7.7.1.1.4.2.3.4">𝑜</ci><ci id="alg1.l12.m1.7.7.1.1.4.2.3.5.cmml" xref="alg1.l12.m1.7.7.1.1.4.2.3.5">𝑥</ci><ci id="alg1.l12.m1.7.7.1.1.4.2.3.6.cmml" xref="alg1.l12.m1.7.7.1.1.4.2.3.6">𝑦</ci></apply></apply></apply><set id="alg1.l12.m1.7.7.1.1.1.1.1.1.cmml" xref="alg1.l12.m1.7.7.1.1.1.1.1.2"><ci id="alg1.l12.m1.5.5.cmml" xref="alg1.l12.m1.5.5">𝛾</ci><ci id="alg1.l12.m1.6.6.cmml" xref="alg1.l12.m1.6.6">𝝀</ci></set></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.7c">\{\gamma,\boldsymbol{\lambda}\}\leftarrow\{\gamma,\boldsymbol{\lambda}\}-\eta_{s}\nabla\mathcal{L}_{proxy}\left(\{\gamma,\boldsymbol{\lambda}\}\right)</annotation></semantics></math>;

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>     Obtain the optimal aggregation weights <math id="alg1.l13.m1.2" class="ltx_Math" alttext="\{\gamma^{*},\boldsymbol{\lambda}^{*}\}" display="inline"><semantics id="alg1.l13.m1.2a"><mrow id="alg1.l13.m1.2.2.2" xref="alg1.l13.m1.2.2.3.cmml"><mo stretchy="false" id="alg1.l13.m1.2.2.2.3" xref="alg1.l13.m1.2.2.3.cmml">{</mo><msup id="alg1.l13.m1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.cmml"><mi id="alg1.l13.m1.1.1.1.1.2" xref="alg1.l13.m1.1.1.1.1.2.cmml">γ</mi><mo id="alg1.l13.m1.1.1.1.1.3" xref="alg1.l13.m1.1.1.1.1.3.cmml">∗</mo></msup><mo id="alg1.l13.m1.2.2.2.4" xref="alg1.l13.m1.2.2.3.cmml">,</mo><msup id="alg1.l13.m1.2.2.2.2" xref="alg1.l13.m1.2.2.2.2.cmml"><mi id="alg1.l13.m1.2.2.2.2.2" xref="alg1.l13.m1.2.2.2.2.2.cmml">𝝀</mi><mo id="alg1.l13.m1.2.2.2.2.3" xref="alg1.l13.m1.2.2.2.2.3.cmml">∗</mo></msup><mo stretchy="false" id="alg1.l13.m1.2.2.2.5" xref="alg1.l13.m1.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.2b"><set id="alg1.l13.m1.2.2.3.cmml" xref="alg1.l13.m1.2.2.2"><apply id="alg1.l13.m1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1">superscript</csymbol><ci id="alg1.l13.m1.1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.1.2">𝛾</ci><times id="alg1.l13.m1.1.1.1.1.3.cmml" xref="alg1.l13.m1.1.1.1.1.3"></times></apply><apply id="alg1.l13.m1.2.2.2.2.cmml" xref="alg1.l13.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.2.2.1.cmml" xref="alg1.l13.m1.2.2.2.2">superscript</csymbol><ci id="alg1.l13.m1.2.2.2.2.2.cmml" xref="alg1.l13.m1.2.2.2.2.2">𝝀</ci><times id="alg1.l13.m1.2.2.2.2.3.cmml" xref="alg1.l13.m1.2.2.2.2.3"></times></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.2c">\{\gamma^{*},\boldsymbol{\lambda}^{*}\}</annotation></semantics></math>;

</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>     Obtain the global model:

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>       <math id="alg1.l15.m1.1" class="ltx_Math" alttext="\textbf{w}_{g}^{t+1}\leftarrow\gamma^{*}\cdot(\sum_{i=1}^{m}\lambda^{*}_{i}\textbf{w}_{i}^{t})" display="inline"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><msubsup id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.l15.m1.1.1.3.2.2" xref="alg1.l15.m1.1.1.3.2.2a.cmml">w</mtext><mi id="alg1.l15.m1.1.1.3.2.3" xref="alg1.l15.m1.1.1.3.2.3.cmml">g</mi><mrow id="alg1.l15.m1.1.1.3.3" xref="alg1.l15.m1.1.1.3.3.cmml"><mi id="alg1.l15.m1.1.1.3.3.2" xref="alg1.l15.m1.1.1.3.3.2.cmml">t</mi><mo id="alg1.l15.m1.1.1.3.3.1" xref="alg1.l15.m1.1.1.3.3.1.cmml">+</mo><mn id="alg1.l15.m1.1.1.3.3.3" xref="alg1.l15.m1.1.1.3.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="alg1.l15.m1.1.1.2" xref="alg1.l15.m1.1.1.2.cmml">←</mo><mrow id="alg1.l15.m1.1.1.1" xref="alg1.l15.m1.1.1.1.cmml"><msup id="alg1.l15.m1.1.1.1.3" xref="alg1.l15.m1.1.1.1.3.cmml"><mi id="alg1.l15.m1.1.1.1.3.2" xref="alg1.l15.m1.1.1.1.3.2.cmml">γ</mi><mo id="alg1.l15.m1.1.1.1.3.3" xref="alg1.l15.m1.1.1.1.3.3.cmml">∗</mo></msup><mo lspace="0.222em" rspace="0.222em" id="alg1.l15.m1.1.1.1.2" xref="alg1.l15.m1.1.1.1.2.cmml">⋅</mo><mrow id="alg1.l15.m1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l15.m1.1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l15.m1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.cmml"><msubsup id="alg1.l15.m1.1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.1.cmml"><mo lspace="0em" id="alg1.l15.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="alg1.l15.m1.1.1.1.1.1.1.1.2.3" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.3.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.1.1.2.3.2" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="alg1.l15.m1.1.1.1.1.1.1.1.2.3.1" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="alg1.l15.m1.1.1.1.1.1.1.1.2.3.3" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.l15.m1.1.1.1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.1.1.1.3.cmml">m</mi></msubsup><mrow id="alg1.l15.m1.1.1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.1.2.cmml"><msubsup id="alg1.l15.m1.1.1.1.1.1.1.2.2" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.1.2.2.2.2" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.2.2.cmml">λ</mi><mi id="alg1.l15.m1.1.1.1.1.1.1.2.2.3" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.3.cmml">i</mi><mo id="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.cmml">∗</mo></msubsup><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.1.1.1.1.2.1" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.cmml">​</mo><msubsup id="alg1.l15.m1.1.1.1.1.1.1.2.3" xref="alg1.l15.m1.1.1.1.1.1.1.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.l15.m1.1.1.1.1.1.1.2.3.2.2" xref="alg1.l15.m1.1.1.1.1.1.1.2.3.2.2a.cmml">w</mtext><mi id="alg1.l15.m1.1.1.1.1.1.1.2.3.2.3" xref="alg1.l15.m1.1.1.1.1.1.1.2.3.2.3.cmml">i</mi><mi id="alg1.l15.m1.1.1.1.1.1.1.2.3.3" xref="alg1.l15.m1.1.1.1.1.1.1.2.3.3.cmml">t</mi></msubsup></mrow></mrow><mo stretchy="false" id="alg1.l15.m1.1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><ci id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2">←</ci><apply id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.3">superscript</csymbol><apply id="alg1.l15.m1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.3.2.1.cmml" xref="alg1.l15.m1.1.1.3">subscript</csymbol><ci id="alg1.l15.m1.1.1.3.2.2a.cmml" xref="alg1.l15.m1.1.1.3.2.2"><mtext class="ltx_mathvariant_bold" id="alg1.l15.m1.1.1.3.2.2.cmml" xref="alg1.l15.m1.1.1.3.2.2">w</mtext></ci><ci id="alg1.l15.m1.1.1.3.2.3.cmml" xref="alg1.l15.m1.1.1.3.2.3">𝑔</ci></apply><apply id="alg1.l15.m1.1.1.3.3.cmml" xref="alg1.l15.m1.1.1.3.3"><plus id="alg1.l15.m1.1.1.3.3.1.cmml" xref="alg1.l15.m1.1.1.3.3.1"></plus><ci id="alg1.l15.m1.1.1.3.3.2.cmml" xref="alg1.l15.m1.1.1.3.3.2">𝑡</ci><cn type="integer" id="alg1.l15.m1.1.1.3.3.3.cmml" xref="alg1.l15.m1.1.1.3.3.3">1</cn></apply></apply><apply id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1"><ci id="alg1.l15.m1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.2">⋅</ci><apply id="alg1.l15.m1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.1.3">superscript</csymbol><ci id="alg1.l15.m1.1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.1.3.2">𝛾</ci><times id="alg1.l15.m1.1.1.1.3.3.cmml" xref="alg1.l15.m1.1.1.1.3.3"></times></apply><apply id="alg1.l15.m1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1"><apply id="alg1.l15.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l15.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1">subscript</csymbol><sum id="alg1.l15.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.2"></sum><apply id="alg1.l15.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.3"><eq id="alg1.l15.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="alg1.l15.m1.1.1.1.1.1.1.1.2.3.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="alg1.l15.m1.1.1.1.1.1.1.1.2.3.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="alg1.l15.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.3">𝑚</ci></apply><apply id="alg1.l15.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2"><times id="alg1.l15.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.1"></times><apply id="alg1.l15.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="alg1.l15.m1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="alg1.l15.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.2.2">𝜆</ci><times id="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3"></times></apply><ci id="alg1.l15.m1.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="alg1.l15.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.2.3.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.3">superscript</csymbol><apply id="alg1.l15.m1.1.1.1.1.1.1.2.3.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.2.3.2.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="alg1.l15.m1.1.1.1.1.1.1.2.3.2.2a.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.3.2.2"><mtext class="ltx_mathvariant_bold" id="alg1.l15.m1.1.1.1.1.1.1.2.3.2.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.3.2.2">w</mtext></ci><ci id="alg1.l15.m1.1.1.1.1.1.1.2.3.2.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.3.2.3">𝑖</ci></apply><ci id="alg1.l15.m1.1.1.1.1.1.1.2.3.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">\textbf{w}_{g}^{t+1}\leftarrow\gamma^{*}\cdot(\sum_{i=1}^{m}\lambda^{*}_{i}\textbf{w}_{i}^{t})</annotation></semantics></math>;

</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>  <span id="alg1.l16.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l16.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span>  Obtain the final global model <math id="alg1.l17.m1.1" class="ltx_Math" alttext="\textbf{w}_{g}^{T}" display="inline"><semantics id="alg1.l17.m1.1a"><msubsup id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.l17.m1.1.1.2.2" xref="alg1.l17.m1.1.1.2.2a.cmml">w</mtext><mi id="alg1.l17.m1.1.1.2.3" xref="alg1.l17.m1.1.1.2.3.cmml">g</mi><mi id="alg1.l17.m1.1.1.3" xref="alg1.l17.m1.1.1.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><apply id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1">superscript</csymbol><apply id="alg1.l17.m1.1.1.2.cmml" xref="alg1.l17.m1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.2.1.cmml" xref="alg1.l17.m1.1.1">subscript</csymbol><ci id="alg1.l17.m1.1.1.2.2a.cmml" xref="alg1.l17.m1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="alg1.l17.m1.1.1.2.2.cmml" xref="alg1.l17.m1.1.1.2.2">w</mtext></ci><ci id="alg1.l17.m1.1.1.2.3.cmml" xref="alg1.l17.m1.1.1.2.3">𝑔</ci></apply><ci id="alg1.l17.m1.1.1.3.cmml" xref="alg1.l17.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">\textbf{w}_{g}^{T}</annotation></semantics></math>.

</div>
</div>
</div>
</div>
</figure>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table">Table 3: </span><span id="S5.T3.2.1" class="ltx_text ltx_font_bold" style="font-size:113%;">Top-1 test accuracy (%) achieved by comparing FL methods and FedLAW on three datasets
with different model architectures<span id="S5.T3.2.1.1" class="ltx_text ltx_font_medium"> (<math id="S5.T3.2.1.1.m1.1" class="ltx_Math" alttext="E=3" display="inline"><semantics id="S5.T3.2.1.1.m1.1b"><mrow id="S5.T3.2.1.1.m1.1.1" xref="S5.T3.2.1.1.m1.1.1.cmml"><mi id="S5.T3.2.1.1.m1.1.1.2" xref="S5.T3.2.1.1.m1.1.1.2.cmml">E</mi><mo id="S5.T3.2.1.1.m1.1.1.1" xref="S5.T3.2.1.1.m1.1.1.1.cmml">=</mo><mn id="S5.T3.2.1.1.m1.1.1.3" xref="S5.T3.2.1.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.2.1.1.m1.1c"><apply id="S5.T3.2.1.1.m1.1.1.cmml" xref="S5.T3.2.1.1.m1.1.1"><eq id="S5.T3.2.1.1.m1.1.1.1.cmml" xref="S5.T3.2.1.1.m1.1.1.1"></eq><ci id="S5.T3.2.1.1.m1.1.1.2.cmml" xref="S5.T3.2.1.1.m1.1.1.2">𝐸</ci><cn type="integer" id="S5.T3.2.1.1.m1.1.1.3.cmml" xref="S5.T3.2.1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.1.1.m1.1d">E=3</annotation></semantics></math>).
<span id="S5.T3.2.1.1.1" class="ltx_text" style="color:#0000FF;">Blue</span>/</span>bold<span id="S5.T3.2.1.2" class="ltx_text ltx_font_medium"> fonts highlight the best baseline/our approach.
</span></span></figcaption>
<div id="S5.T3.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:183.9pt;vertical-align:-0.9pt;"><span class="ltx_transformed_inner" style="transform:translate(-17.7pt,7.5pt) scale(0.924429923029016,0.924429923029016) ;">
<table id="S5.T3.3.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T3.3.1.2.1" class="ltx_tr">
<th id="S5.T3.3.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt"><span id="S5.T3.3.1.2.1.1.1" class="ltx_text" style="font-size:80%;">Dataset</span></th>
<td id="S5.T3.3.1.2.1.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="4"><span id="S5.T3.3.1.2.1.2.1" class="ltx_text" style="font-size:80%;">FashionMNIST</span></td>
<td id="S5.T3.3.1.2.1.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="4"><span id="S5.T3.3.1.2.1.3.1" class="ltx_text" style="font-size:80%;">CIFAR-10</span></td>
<td id="S5.T3.3.1.2.1.4" class="ltx_td ltx_align_center ltx_border_tt" colspan="4"><span id="S5.T3.3.1.2.1.4.1" class="ltx_text" style="font-size:80%;">CIFAR-100</span></td>
</tr>
<tr id="S5.T3.3.1.1" class="ltx_tr">
<th id="S5.T3.3.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">
<span id="S5.T3.3.1.1.1.1" class="ltx_text" style="font-size:80%;">NonIID (</span><math id="S5.T3.3.1.1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.T3.3.1.1.1.m1.1a"><mi mathsize="80%" id="S5.T3.3.1.1.1.m1.1.1" xref="S5.T3.3.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.T3.3.1.1.1.m1.1b"><ci id="S5.T3.3.1.1.1.m1.1.1.cmml" xref="S5.T3.3.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.1.1.1.m1.1c">\alpha</annotation></semantics></math><span id="S5.T3.3.1.1.1.2" class="ltx_text" style="font-size:80%;">)</span>
</th>
<td id="S5.T3.3.1.1.2" class="ltx_td ltx_align_center ltx_border_t" colspan="2"><span id="S5.T3.3.1.1.2.1" class="ltx_text" style="font-size:80%;">100</span></td>
<td id="S5.T3.3.1.1.3" class="ltx_td ltx_align_center ltx_border_t" colspan="2"><span id="S5.T3.3.1.1.3.1" class="ltx_text" style="font-size:80%;">0.1</span></td>
<td id="S5.T3.3.1.1.4" class="ltx_td ltx_align_center ltx_border_t" colspan="2"><span id="S5.T3.3.1.1.4.1" class="ltx_text" style="font-size:80%;">100</span></td>
<td id="S5.T3.3.1.1.5" class="ltx_td ltx_align_center ltx_border_t" colspan="2"><span id="S5.T3.3.1.1.5.1" class="ltx_text" style="font-size:80%;">0.1</span></td>
<td id="S5.T3.3.1.1.6" class="ltx_td ltx_align_center ltx_border_t" colspan="2"><span id="S5.T3.3.1.1.6.1" class="ltx_text" style="font-size:80%;">100</span></td>
<td id="S5.T3.3.1.1.7" class="ltx_td ltx_align_center ltx_border_t" colspan="2"><span id="S5.T3.3.1.1.7.1" class="ltx_text" style="font-size:80%;">0.1</span></td>
</tr>
<tr id="S5.T3.3.1.3.2" class="ltx_tr">
<th id="S5.T3.3.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S5.T3.3.1.3.2.1.1" class="ltx_text" style="font-size:80%;">Model</span></th>
<td id="S5.T3.3.1.3.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.3.2.2.1" class="ltx_text" style="font-size:80%;">MLP</span></td>
<td id="S5.T3.3.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.1.3.2.3.1" class="ltx_text" style="font-size:80%;">LeNet</span></td>
<td id="S5.T3.3.1.3.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.3.2.4.1" class="ltx_text" style="font-size:80%;">MLP</span></td>
<td id="S5.T3.3.1.3.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.1.3.2.5.1" class="ltx_text" style="font-size:80%;">LeNet</span></td>
<td id="S5.T3.3.1.3.2.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.3.2.6.1" class="ltx_text" style="font-size:80%;">CNN</span></td>
<td id="S5.T3.3.1.3.2.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.1.3.2.7.1" class="ltx_text" style="font-size:80%;">ResNet</span></td>
<td id="S5.T3.3.1.3.2.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.3.2.8.1" class="ltx_text" style="font-size:80%;">CNN</span></td>
<td id="S5.T3.3.1.3.2.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.1.3.2.9.1" class="ltx_text" style="font-size:80%;">ResNet</span></td>
<td id="S5.T3.3.1.3.2.10" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.3.2.10.1" class="ltx_text" style="font-size:80%;">CNN</span></td>
<td id="S5.T3.3.1.3.2.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.1.3.2.11.1" class="ltx_text" style="font-size:80%;">ResNet</span></td>
<td id="S5.T3.3.1.3.2.12" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.3.2.12.1" class="ltx_text" style="font-size:80%;">CNN</span></td>
<td id="S5.T3.3.1.3.2.13" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.3.2.13.1" class="ltx_text" style="font-size:80%;">ResNet</span></td>
</tr>
<tr id="S5.T3.3.1.4.3" class="ltx_tr">
<th id="S5.T3.3.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S5.T3.3.1.4.3.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:80%;">FedAvg</span></th>
<td id="S5.T3.3.1.4.3.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.4.3.2.1" class="ltx_text" style="font-size:80%;color:#0000FF;">89.29</span></td>
<td id="S5.T3.3.1.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.1.4.3.3.1" class="ltx_text" style="font-size:80%;">90.54</span></td>
<td id="S5.T3.3.1.4.3.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.4.3.4.1" class="ltx_text" style="font-size:80%;">85.11</span></td>
<td id="S5.T3.3.1.4.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.1.4.3.5.1" class="ltx_text" style="font-size:80%;">88.08</span></td>
<td id="S5.T3.3.1.4.3.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.4.3.6.1" class="ltx_text" style="font-size:80%;">65.78</span></td>
<td id="S5.T3.3.1.4.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.1.4.3.7.1" class="ltx_text" style="font-size:80%;">74.57</span></td>
<td id="S5.T3.3.1.4.3.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.4.3.8.1" class="ltx_text" style="font-size:80%;">60.13</span></td>
<td id="S5.T3.3.1.4.3.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.1.4.3.9.1" class="ltx_text" style="font-size:80%;">46.04</span></td>
<td id="S5.T3.3.1.4.3.10" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.4.3.10.1" class="ltx_text" style="font-size:80%;">25.74</span></td>
<td id="S5.T3.3.1.4.3.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.1.4.3.11.1" class="ltx_text" style="font-size:80%;">27.49</span></td>
<td id="S5.T3.3.1.4.3.12" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.4.3.12.1" class="ltx_text" style="font-size:80%;color:#0000FF;">27.74</span></td>
<td id="S5.T3.3.1.4.3.13" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.4.3.13.1" class="ltx_text" style="font-size:80%;">24.92</span></td>
</tr>
<tr id="S5.T3.3.1.5.4" class="ltx_tr">
<th id="S5.T3.3.1.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S5.T3.3.1.5.4.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:80%;">FedProx</span></th>
<td id="S5.T3.3.1.5.4.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.5.4.2.1" class="ltx_text" style="font-size:80%;">87.68</span></td>
<td id="S5.T3.3.1.5.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.1.5.4.3.1" class="ltx_text" style="font-size:80%;">89.77</span></td>
<td id="S5.T3.3.1.5.4.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.5.4.4.1" class="ltx_text" style="font-size:80%;">84.33</span></td>
<td id="S5.T3.3.1.5.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.1.5.4.5.1" class="ltx_text" style="font-size:80%;">87.01</span></td>
<td id="S5.T3.3.1.5.4.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.5.4.6.1" class="ltx_text" style="font-size:80%;">67.66</span></td>
<td id="S5.T3.3.1.5.4.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.1.5.4.7.1" class="ltx_text" style="font-size:80%;">68.51</span></td>
<td id="S5.T3.3.1.5.4.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.5.4.8.1" class="ltx_text" style="font-size:80%;color:#0000FF;">60.48</span></td>
<td id="S5.T3.3.1.5.4.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.1.5.4.9.1" class="ltx_text" style="font-size:80%;">48.84</span></td>
<td id="S5.T3.3.1.5.4.10" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.5.4.10.1" class="ltx_text" style="font-size:80%;">9.49</span></td>
<td id="S5.T3.3.1.5.4.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.1.5.4.11.1" class="ltx_text" style="font-size:80%;">27.15</span></td>
<td id="S5.T3.3.1.5.4.12" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.5.4.12.1" class="ltx_text" style="font-size:80%;">12.52</span></td>
<td id="S5.T3.3.1.5.4.13" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.5.4.13.1" class="ltx_text" style="font-size:80%;">23.73</span></td>
</tr>
<tr id="S5.T3.3.1.6.5" class="ltx_tr">
<th id="S5.T3.3.1.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="S5.T3.3.1.6.5.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:80%;">FedDyn</span></th>
<td id="S5.T3.3.1.6.5.2" class="ltx_td ltx_align_center"><span id="S5.T3.3.1.6.5.2.1" class="ltx_text" style="font-size:80%;">88.47</span></td>
<td id="S5.T3.3.1.6.5.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T3.3.1.6.5.3.1" class="ltx_text" style="font-size:80%;">89.92</span></td>
<td id="S5.T3.3.1.6.5.4" class="ltx_td ltx_align_center"><span id="S5.T3.3.1.6.5.4.1" class="ltx_text" style="font-size:80%;">77.68</span></td>
<td id="S5.T3.3.1.6.5.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T3.3.1.6.5.5.1" class="ltx_text" style="font-size:80%;">72.68</span></td>
<td id="S5.T3.3.1.6.5.6" class="ltx_td ltx_align_center"><span id="S5.T3.3.1.6.5.6.1" class="ltx_text" style="font-size:80%;">66.1</span></td>
<td id="S5.T3.3.1.6.5.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T3.3.1.6.5.7.1" class="ltx_text" style="font-size:80%;">76.62</span></td>
<td id="S5.T3.3.1.6.5.8" class="ltx_td ltx_align_center"><span id="S5.T3.3.1.6.5.8.1" class="ltx_text" style="font-size:80%;">41.53</span></td>
<td id="S5.T3.3.1.6.5.9" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T3.3.1.6.5.9.1" class="ltx_text" style="font-size:80%;">35.77</span></td>
<td id="S5.T3.3.1.6.5.10" class="ltx_td ltx_align_center"><span id="S5.T3.3.1.6.5.10.1" class="ltx_text" style="font-size:80%;">24.44</span></td>
<td id="S5.T3.3.1.6.5.11" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T3.3.1.6.5.11.1" class="ltx_text" style="font-size:80%;color:#0000FF;">32.18</span></td>
<td id="S5.T3.3.1.6.5.12" class="ltx_td ltx_align_center"><span id="S5.T3.3.1.6.5.12.1" class="ltx_text" style="font-size:80%;">22.67</span></td>
<td id="S5.T3.3.1.6.5.13" class="ltx_td ltx_align_center"><span id="S5.T3.3.1.6.5.13.1" class="ltx_text" style="font-size:80%;color:#0000FF;">29.00</span></td>
</tr>
<tr id="S5.T3.3.1.7.6" class="ltx_tr">
<th id="S5.T3.3.1.7.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S5.T3.3.1.7.6.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:80%;">FedDF</span></th>
<td id="S5.T3.3.1.7.6.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.7.6.2.1" class="ltx_text" style="font-size:80%;">86.16</span></td>
<td id="S5.T3.3.1.7.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.1.7.6.3.1" class="ltx_text" style="font-size:80%;">89.09</span></td>
<td id="S5.T3.3.1.7.6.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.7.6.4.1" class="ltx_text" style="font-size:80%;">78.48</span></td>
<td id="S5.T3.3.1.7.6.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.1.7.6.5.1" class="ltx_text" style="font-size:80%;">85.90</span></td>
<td id="S5.T3.3.1.7.6.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.7.6.6.1" class="ltx_text" style="font-size:80%;">69.60</span></td>
<td id="S5.T3.3.1.7.6.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.1.7.6.7.1" class="ltx_text" style="font-size:80%;">77.36</span></td>
<td id="S5.T3.3.1.7.6.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.7.6.8.1" class="ltx_text" style="font-size:80%;">57.38</span></td>
<td id="S5.T3.3.1.7.6.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.1.7.6.9.1" class="ltx_text" style="font-size:80%;color:#0000FF;">54.09</span></td>
<td id="S5.T3.3.1.7.6.10" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.7.6.10.1" class="ltx_text" style="font-size:80%;color:#0000FF;">28.52</span></td>
<td id="S5.T3.3.1.7.6.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.1.7.6.11.1" class="ltx_text" style="font-size:80%;">27.42</span></td>
<td id="S5.T3.3.1.7.6.12" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.7.6.12.1" class="ltx_text" style="font-size:80%;">24.52</span></td>
<td id="S5.T3.3.1.7.6.13" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.7.6.13.1" class="ltx_text" style="font-size:80%;">23.10</span></td>
</tr>
<tr id="S5.T3.3.1.8.7" class="ltx_tr">
<th id="S5.T3.3.1.8.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="S5.T3.3.1.8.7.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:80%;">FedBE</span></th>
<td id="S5.T3.3.1.8.7.2" class="ltx_td ltx_align_center"><span id="S5.T3.3.1.8.7.2.1" class="ltx_text" style="font-size:80%;">86.22</span></td>
<td id="S5.T3.3.1.8.7.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T3.3.1.8.7.3.1" class="ltx_text" style="font-size:80%;">89.14</span></td>
<td id="S5.T3.3.1.8.7.4" class="ltx_td ltx_align_center"><span id="S5.T3.3.1.8.7.4.1" class="ltx_text" style="font-size:80%;">79.12</span></td>
<td id="S5.T3.3.1.8.7.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T3.3.1.8.7.5.1" class="ltx_text" style="font-size:80%;">85.96</span></td>
<td id="S5.T3.3.1.8.7.6" class="ltx_td ltx_align_center"><span id="S5.T3.3.1.8.7.6.1" class="ltx_text" style="font-size:80%;color:#0000FF;">69.88</span></td>
<td id="S5.T3.3.1.8.7.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T3.3.1.8.7.7.1" class="ltx_text" style="font-size:80%;color:#0000FF;">77.94</span></td>
<td id="S5.T3.3.1.8.7.8" class="ltx_td ltx_align_center"><span id="S5.T3.3.1.8.7.8.1" class="ltx_text" style="font-size:80%;">59.84</span></td>
<td id="S5.T3.3.1.8.7.9" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T3.3.1.8.7.9.1" class="ltx_text" style="font-size:80%;">52.86</span></td>
<td id="S5.T3.3.1.8.7.10" class="ltx_td ltx_align_center"><span id="S5.T3.3.1.8.7.10.1" class="ltx_text" style="font-size:80%;">28.38</span></td>
<td id="S5.T3.3.1.8.7.11" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T3.3.1.8.7.11.1" class="ltx_text" style="font-size:80%;">27.73</span></td>
<td id="S5.T3.3.1.8.7.12" class="ltx_td ltx_align_center"><span id="S5.T3.3.1.8.7.12.1" class="ltx_text" style="font-size:80%;">25.41</span></td>
<td id="S5.T3.3.1.8.7.13" class="ltx_td ltx_align_center"><span id="S5.T3.3.1.8.7.13.1" class="ltx_text" style="font-size:80%;">23.74</span></td>
</tr>
<tr id="S5.T3.3.1.9.8" class="ltx_tr">
<th id="S5.T3.3.1.9.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="S5.T3.3.1.9.8.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:80%;">Server-FT</span></th>
<td id="S5.T3.3.1.9.8.2" class="ltx_td ltx_align_center"><span id="S5.T3.3.1.9.8.2.1" class="ltx_text" style="font-size:80%;">89.09</span></td>
<td id="S5.T3.3.1.9.8.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T3.3.1.9.8.3.1" class="ltx_text" style="font-size:80%;color:#0000FF;">90.56</span></td>
<td id="S5.T3.3.1.9.8.4" class="ltx_td ltx_align_center"><span id="S5.T3.3.1.9.8.4.1" class="ltx_text" style="font-size:80%;color:#0000FF;">85.71</span></td>
<td id="S5.T3.3.1.9.8.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T3.3.1.9.8.5.1" class="ltx_text" style="font-size:80%;color:#0000FF;">88.10</span></td>
<td id="S5.T3.3.1.9.8.6" class="ltx_td ltx_align_center"><span id="S5.T3.3.1.9.8.6.1" class="ltx_text" style="font-size:80%;">66.83</span></td>
<td id="S5.T3.3.1.9.8.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T3.3.1.9.8.7.1" class="ltx_text" style="font-size:80%;">74.73</span></td>
<td id="S5.T3.3.1.9.8.8" class="ltx_td ltx_align_center"><span id="S5.T3.3.1.9.8.8.1" class="ltx_text" style="font-size:80%;">60.43</span></td>
<td id="S5.T3.3.1.9.8.9" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T3.3.1.9.8.9.1" class="ltx_text" style="font-size:80%;">47.59</span></td>
<td id="S5.T3.3.1.9.8.10" class="ltx_td ltx_align_center"><span id="S5.T3.3.1.9.8.10.1" class="ltx_text" style="font-size:80%;">25.37</span></td>
<td id="S5.T3.3.1.9.8.11" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T3.3.1.9.8.11.1" class="ltx_text" style="font-size:80%;">26.14</span></td>
<td id="S5.T3.3.1.9.8.12" class="ltx_td ltx_align_center"><span id="S5.T3.3.1.9.8.12.1" class="ltx_text" style="font-size:80%;">24.33</span></td>
<td id="S5.T3.3.1.9.8.13" class="ltx_td ltx_align_center"><span id="S5.T3.3.1.9.8.13.1" class="ltx_text" style="font-size:80%;">23.03</span></td>
</tr>
<tr id="S5.T3.3.1.10.9" class="ltx_tr">
<th id="S5.T3.3.1.10.9.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S5.T3.3.1.10.9.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps" style="font-size:80%;">FedLAW</span></th>
<td id="S5.T3.3.1.10.9.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.10.9.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;">88.51</span></td>
<td id="S5.T3.3.1.10.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.1.10.9.3.1" class="ltx_text ltx_font_bold" style="font-size:80%;">90.66</span></td>
<td id="S5.T3.3.1.10.9.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.10.9.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;">86.30</span></td>
<td id="S5.T3.3.1.10.9.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.1.10.9.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">88.26</span></td>
<td id="S5.T3.3.1.10.9.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.10.9.6.1" class="ltx_text ltx_font_bold" style="font-size:80%;">70.17</span></td>
<td id="S5.T3.3.1.10.9.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.1.10.9.7.1" class="ltx_text ltx_font_bold" style="font-size:80%;">80.46</span></td>
<td id="S5.T3.3.1.10.9.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.10.9.8.1" class="ltx_text ltx_font_bold" style="font-size:80%;">62.46</span></td>
<td id="S5.T3.3.1.10.9.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.1.10.9.9.1" class="ltx_text ltx_font_bold" style="font-size:80%;">52.83</span></td>
<td id="S5.T3.3.1.10.9.10" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.10.9.10.1" class="ltx_text ltx_font_bold" style="font-size:80%;">32.51</span></td>
<td id="S5.T3.3.1.10.9.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.3.1.10.9.11.1" class="ltx_text ltx_font_bold" style="font-size:80%;">33.17</span></td>
<td id="S5.T3.3.1.10.9.12" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.10.9.12.1" class="ltx_text ltx_font_bold" style="font-size:80%;">32.30</span></td>
<td id="S5.T3.3.1.10.9.13" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.3.1.10.9.13.1" class="ltx_text ltx_font_bold" style="font-size:80%;">24.84</span></td>
</tr>
<tr id="S5.T3.3.1.11.10" class="ltx_tr">
<th id="S5.T3.3.1.11.10.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r"><span id="S5.T3.3.1.11.10.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps" style="font-size:80%;">FedLAW (SWA)</span></th>
<td id="S5.T3.3.1.11.10.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T3.3.1.11.10.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;">88.27</span></td>
<td id="S5.T3.3.1.11.10.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S5.T3.3.1.11.10.3.1" class="ltx_text ltx_font_bold" style="font-size:80%;">90.51</span></td>
<td id="S5.T3.3.1.11.10.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T3.3.1.11.10.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;">86.89</span></td>
<td id="S5.T3.3.1.11.10.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S5.T3.3.1.11.10.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">88.18</span></td>
<td id="S5.T3.3.1.11.10.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T3.3.1.11.10.6.1" class="ltx_text ltx_font_bold" style="font-size:80%;">69.9</span></td>
<td id="S5.T3.3.1.11.10.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S5.T3.3.1.11.10.7.1" class="ltx_text ltx_font_bold" style="font-size:80%;">79.55</span></td>
<td id="S5.T3.3.1.11.10.8" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T3.3.1.11.10.8.1" class="ltx_text ltx_font_bold" style="font-size:80%;">62.12</span></td>
<td id="S5.T3.3.1.11.10.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S5.T3.3.1.11.10.9.1" class="ltx_text ltx_font_bold" style="font-size:80%;">57.08</span></td>
<td id="S5.T3.3.1.11.10.10" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T3.3.1.11.10.10.1" class="ltx_text ltx_font_bold" style="font-size:80%;">32.39</span></td>
<td id="S5.T3.3.1.11.10.11" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S5.T3.3.1.11.10.11.1" class="ltx_text ltx_font_bold" style="font-size:80%;">33.17</span></td>
<td id="S5.T3.3.1.11.10.12" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T3.3.1.11.10.12.1" class="ltx_text ltx_font_bold" style="font-size:80%;">32.27</span></td>
<td id="S5.T3.3.1.11.10.13" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T3.3.1.11.10.13.1" class="ltx_text ltx_font_bold" style="font-size:80%;">25.31</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>FedLAW</h2>

<section id="S6.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Method</h3>

<div id="S6.SS1.p1" class="ltx_para">
<p id="S6.SS1.p1.2" class="ltx_p">Based on the above understandings, we propose <span id="S6.SS1.p1.2.1" class="ltx_text ltx_font_bold">Fed</span>erated Learning with <span id="S6.SS1.p1.2.2" class="ltx_text ltx_font_bold">L</span>earnable <span id="S6.SS1.p1.2.3" class="ltx_text ltx_font_bold">A</span>ggregation <span id="S6.SS1.p1.2.4" class="ltx_text ltx_font_bold">W</span>eights algorithm (<span id="S6.SS1.p1.2.5" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedLAW</span>) which combines the adaptive GWS and attentive LAW to optimize <math id="S6.SS1.p1.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S6.SS1.p1.1.m1.1a"><mi id="S6.SS1.p1.1.m1.1.1" xref="S6.SS1.p1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.1.m1.1b"><ci id="S6.SS1.p1.1.m1.1.1.cmml" xref="S6.SS1.p1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.1.m1.1c">\gamma</annotation></semantics></math> and <math id="S6.SS1.p1.2.m2.1" class="ltx_Math" alttext="\boldsymbol{\lambda}" display="inline"><semantics id="S6.SS1.p1.2.m2.1a"><mi id="S6.SS1.p1.2.m2.1.1" xref="S6.SS1.p1.2.m2.1.1.cmml">𝝀</mi><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.2.m2.1b"><ci id="S6.SS1.p1.2.m2.1.1.cmml" xref="S6.SS1.p1.2.m2.1.1">𝝀</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.2.m2.1c">\boldsymbol{\lambda}</annotation></semantics></math> simultaneously, defined as
</p>
<table id="A4.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S6.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S6.E8.m1.2" class="ltx_Math" alttext="\displaystyle\boldsymbol{\gamma^{*},\lambda^{*}}" display="inline"><semantics id="S6.E8.m1.2a"><mrow id="S6.E8.m1.2.2.2" xref="S6.E8.m1.2.2.3.cmml"><msup id="S6.E8.m1.1.1.1.1" xref="S6.E8.m1.1.1.1.1.cmml"><mi id="S6.E8.m1.1.1.1.1.2" xref="S6.E8.m1.1.1.1.1.2.cmml">𝜸</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S6.E8.m1.1.1.1.1.3" xref="S6.E8.m1.1.1.1.1.3.cmml">∗</mo></msup><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S6.E8.m1.2.2.2.3" xref="S6.E8.m1.2.2.3.cmml">,</mo><msup id="S6.E8.m1.2.2.2.2" xref="S6.E8.m1.2.2.2.2.cmml"><mi id="S6.E8.m1.2.2.2.2.2" xref="S6.E8.m1.2.2.2.2.2.cmml">𝝀</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S6.E8.m1.2.2.2.2.3" xref="S6.E8.m1.2.2.2.2.3.cmml">∗</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.E8.m1.2b"><list id="S6.E8.m1.2.2.3.cmml" xref="S6.E8.m1.2.2.2"><apply id="S6.E8.m1.1.1.1.1.cmml" xref="S6.E8.m1.1.1.1.1"><csymbol cd="ambiguous" id="S6.E8.m1.1.1.1.1.1.cmml" xref="S6.E8.m1.1.1.1.1">superscript</csymbol><ci id="S6.E8.m1.1.1.1.1.2.cmml" xref="S6.E8.m1.1.1.1.1.2">𝜸</ci><times id="S6.E8.m1.1.1.1.1.3.cmml" xref="S6.E8.m1.1.1.1.1.3"></times></apply><apply id="S6.E8.m1.2.2.2.2.cmml" xref="S6.E8.m1.2.2.2.2"><csymbol cd="ambiguous" id="S6.E8.m1.2.2.2.2.1.cmml" xref="S6.E8.m1.2.2.2.2">superscript</csymbol><ci id="S6.E8.m1.2.2.2.2.2.cmml" xref="S6.E8.m1.2.2.2.2.2">𝝀</ci><times id="S6.E8.m1.2.2.2.2.3.cmml" xref="S6.E8.m1.2.2.2.2.3"></times></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S6.E8.m1.2c">\displaystyle\boldsymbol{\gamma^{*},\lambda^{*}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.E8.m2.3" class="ltx_Math" alttext="\displaystyle=\mathop{\arg\min}\limits_{{\gamma,\boldsymbol{\lambda}}}\mathcal{L}_{proxy}\gamma\cdot(\sum_{i=1}^{m}\lambda_{i}\textbf{w}_{i}^{t})," display="inline"><semantics id="S6.E8.m2.3a"><mrow id="S6.E8.m2.3.3.1" xref="S6.E8.m2.3.3.1.1.cmml"><mrow id="S6.E8.m2.3.3.1.1" xref="S6.E8.m2.3.3.1.1.cmml"><mi id="S6.E8.m2.3.3.1.1.3" xref="S6.E8.m2.3.3.1.1.3.cmml"></mi><mo id="S6.E8.m2.3.3.1.1.2" xref="S6.E8.m2.3.3.1.1.2.cmml">=</mo><mrow id="S6.E8.m2.3.3.1.1.1" xref="S6.E8.m2.3.3.1.1.1.cmml"><munder id="S6.E8.m2.3.3.1.1.1.2" xref="S6.E8.m2.3.3.1.1.1.2.cmml"><mrow id="S6.E8.m2.3.3.1.1.1.2.2" xref="S6.E8.m2.3.3.1.1.1.2.2.cmml"><mi id="S6.E8.m2.3.3.1.1.1.2.2.1" xref="S6.E8.m2.3.3.1.1.1.2.2.1.cmml">arg</mi><mo lspace="0.167em" id="S6.E8.m2.3.3.1.1.1.2.2a" xref="S6.E8.m2.3.3.1.1.1.2.2.cmml">⁡</mo><mi id="S6.E8.m2.3.3.1.1.1.2.2.2" xref="S6.E8.m2.3.3.1.1.1.2.2.2.cmml">min</mi></mrow><mrow id="S6.E8.m2.2.2.2.4" xref="S6.E8.m2.2.2.2.3.cmml"><mi id="S6.E8.m2.1.1.1.1" xref="S6.E8.m2.1.1.1.1.cmml">γ</mi><mo id="S6.E8.m2.2.2.2.4.1" xref="S6.E8.m2.2.2.2.3.cmml">,</mo><mi id="S6.E8.m2.2.2.2.2" xref="S6.E8.m2.2.2.2.2.cmml">𝝀</mi></mrow></munder><mrow id="S6.E8.m2.3.3.1.1.1.1" xref="S6.E8.m2.3.3.1.1.1.1.cmml"><mrow id="S6.E8.m2.3.3.1.1.1.1.3" xref="S6.E8.m2.3.3.1.1.1.1.3.cmml"><msub id="S6.E8.m2.3.3.1.1.1.1.3.2" xref="S6.E8.m2.3.3.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.E8.m2.3.3.1.1.1.1.3.2.2" xref="S6.E8.m2.3.3.1.1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S6.E8.m2.3.3.1.1.1.1.3.2.3" xref="S6.E8.m2.3.3.1.1.1.1.3.2.3.cmml"><mi id="S6.E8.m2.3.3.1.1.1.1.3.2.3.2" xref="S6.E8.m2.3.3.1.1.1.1.3.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S6.E8.m2.3.3.1.1.1.1.3.2.3.1" xref="S6.E8.m2.3.3.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S6.E8.m2.3.3.1.1.1.1.3.2.3.3" xref="S6.E8.m2.3.3.1.1.1.1.3.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S6.E8.m2.3.3.1.1.1.1.3.2.3.1a" xref="S6.E8.m2.3.3.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S6.E8.m2.3.3.1.1.1.1.3.2.3.4" xref="S6.E8.m2.3.3.1.1.1.1.3.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S6.E8.m2.3.3.1.1.1.1.3.2.3.1b" xref="S6.E8.m2.3.3.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S6.E8.m2.3.3.1.1.1.1.3.2.3.5" xref="S6.E8.m2.3.3.1.1.1.1.3.2.3.5.cmml">x</mi><mo lspace="0em" rspace="0em" id="S6.E8.m2.3.3.1.1.1.1.3.2.3.1c" xref="S6.E8.m2.3.3.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S6.E8.m2.3.3.1.1.1.1.3.2.3.6" xref="S6.E8.m2.3.3.1.1.1.1.3.2.3.6.cmml">y</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S6.E8.m2.3.3.1.1.1.1.3.1" xref="S6.E8.m2.3.3.1.1.1.1.3.1.cmml">​</mo><mi id="S6.E8.m2.3.3.1.1.1.1.3.3" xref="S6.E8.m2.3.3.1.1.1.1.3.3.cmml">γ</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S6.E8.m2.3.3.1.1.1.1.2" xref="S6.E8.m2.3.3.1.1.1.1.2.cmml">⋅</mo><mrow id="S6.E8.m2.3.3.1.1.1.1.1.1" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S6.E8.m2.3.3.1.1.1.1.1.1.2" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S6.E8.m2.3.3.1.1.1.1.1.1.1" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S6.E8.m2.3.3.1.1.1.1.1.1.1.1" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.cmml"><munderover id="S6.E8.m2.3.3.1.1.1.1.1.1.1.1a" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.cmml"><mo movablelimits="false" id="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.2.2" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.2.3" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.2.3.2" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.2.3.1" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.2.3.3" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.3" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.3.cmml">m</mi></munderover></mstyle><mrow id="S6.E8.m2.3.3.1.1.1.1.1.1.1.2" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.cmml"><msub id="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.2" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.2.cmml"><mi id="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.2.2" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.2.2.cmml">λ</mi><mi id="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.2.3" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.1" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.1.cmml">​</mo><msubsup id="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.3" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.3.2.2" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.3.2.2a.cmml">w</mtext><mi id="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.3.2.3" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.3.2.3.cmml">i</mi><mi id="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.3.3" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.3.3.cmml">t</mi></msubsup></mrow></mrow><mo stretchy="false" id="S6.E8.m2.3.3.1.1.1.1.1.1.3" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S6.E8.m2.3.3.1.2" xref="S6.E8.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.E8.m2.3b"><apply id="S6.E8.m2.3.3.1.1.cmml" xref="S6.E8.m2.3.3.1"><eq id="S6.E8.m2.3.3.1.1.2.cmml" xref="S6.E8.m2.3.3.1.1.2"></eq><csymbol cd="latexml" id="S6.E8.m2.3.3.1.1.3.cmml" xref="S6.E8.m2.3.3.1.1.3">absent</csymbol><apply id="S6.E8.m2.3.3.1.1.1.cmml" xref="S6.E8.m2.3.3.1.1.1"><apply id="S6.E8.m2.3.3.1.1.1.2.cmml" xref="S6.E8.m2.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S6.E8.m2.3.3.1.1.1.2.1.cmml" xref="S6.E8.m2.3.3.1.1.1.2">subscript</csymbol><apply id="S6.E8.m2.3.3.1.1.1.2.2.cmml" xref="S6.E8.m2.3.3.1.1.1.2.2"><arg id="S6.E8.m2.3.3.1.1.1.2.2.1.cmml" xref="S6.E8.m2.3.3.1.1.1.2.2.1"></arg><min id="S6.E8.m2.3.3.1.1.1.2.2.2.cmml" xref="S6.E8.m2.3.3.1.1.1.2.2.2"></min></apply><list id="S6.E8.m2.2.2.2.3.cmml" xref="S6.E8.m2.2.2.2.4"><ci id="S6.E8.m2.1.1.1.1.cmml" xref="S6.E8.m2.1.1.1.1">𝛾</ci><ci id="S6.E8.m2.2.2.2.2.cmml" xref="S6.E8.m2.2.2.2.2">𝝀</ci></list></apply><apply id="S6.E8.m2.3.3.1.1.1.1.cmml" xref="S6.E8.m2.3.3.1.1.1.1"><ci id="S6.E8.m2.3.3.1.1.1.1.2.cmml" xref="S6.E8.m2.3.3.1.1.1.1.2">⋅</ci><apply id="S6.E8.m2.3.3.1.1.1.1.3.cmml" xref="S6.E8.m2.3.3.1.1.1.1.3"><times id="S6.E8.m2.3.3.1.1.1.1.3.1.cmml" xref="S6.E8.m2.3.3.1.1.1.1.3.1"></times><apply id="S6.E8.m2.3.3.1.1.1.1.3.2.cmml" xref="S6.E8.m2.3.3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S6.E8.m2.3.3.1.1.1.1.3.2.1.cmml" xref="S6.E8.m2.3.3.1.1.1.1.3.2">subscript</csymbol><ci id="S6.E8.m2.3.3.1.1.1.1.3.2.2.cmml" xref="S6.E8.m2.3.3.1.1.1.1.3.2.2">ℒ</ci><apply id="S6.E8.m2.3.3.1.1.1.1.3.2.3.cmml" xref="S6.E8.m2.3.3.1.1.1.1.3.2.3"><times id="S6.E8.m2.3.3.1.1.1.1.3.2.3.1.cmml" xref="S6.E8.m2.3.3.1.1.1.1.3.2.3.1"></times><ci id="S6.E8.m2.3.3.1.1.1.1.3.2.3.2.cmml" xref="S6.E8.m2.3.3.1.1.1.1.3.2.3.2">𝑝</ci><ci id="S6.E8.m2.3.3.1.1.1.1.3.2.3.3.cmml" xref="S6.E8.m2.3.3.1.1.1.1.3.2.3.3">𝑟</ci><ci id="S6.E8.m2.3.3.1.1.1.1.3.2.3.4.cmml" xref="S6.E8.m2.3.3.1.1.1.1.3.2.3.4">𝑜</ci><ci id="S6.E8.m2.3.3.1.1.1.1.3.2.3.5.cmml" xref="S6.E8.m2.3.3.1.1.1.1.3.2.3.5">𝑥</ci><ci id="S6.E8.m2.3.3.1.1.1.1.3.2.3.6.cmml" xref="S6.E8.m2.3.3.1.1.1.1.3.2.3.6">𝑦</ci></apply></apply><ci id="S6.E8.m2.3.3.1.1.1.1.3.3.cmml" xref="S6.E8.m2.3.3.1.1.1.1.3.3">𝛾</ci></apply><apply id="S6.E8.m2.3.3.1.1.1.1.1.1.1.cmml" xref="S6.E8.m2.3.3.1.1.1.1.1.1"><apply id="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.cmml" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.2.1.cmml" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.2.2.cmml" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.2.2"></sum><apply id="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.2.3.cmml" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.2.3"><eq id="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.1.3">𝑚</ci></apply><apply id="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.cmml" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.2"><times id="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.1"></times><apply id="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.2.1.cmml" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.2.2.cmml" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.2.2">𝜆</ci><ci id="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.2.3.cmml" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.3.1.cmml" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.3">superscript</csymbol><apply id="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.3.2.cmml" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.3.2.2a.cmml" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.3.2.2"><mtext class="ltx_mathvariant_bold" id="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.3.2.2">w</mtext></ci><ci id="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.3.2.3.cmml" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.3.2.3">𝑖</ci></apply><ci id="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.3.3.cmml" xref="S6.E8.m2.3.3.1.1.1.1.1.1.1.2.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E8.m2.3c">\displaystyle=\mathop{\arg\min}\limits_{{\gamma,\boldsymbol{\lambda}}}\mathcal{L}_{proxy}\gamma\cdot(\sum_{i=1}^{m}\lambda_{i}\textbf{w}_{i}^{t}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
<tbody id="S6.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S6.E9.m1.2" class="ltx_Math" alttext="\displaystyle\text{ s.t. }\gamma&gt;0,\lambda_{i}\geq 0,\|\boldsymbol{\lambda}\|_{1}=1." display="inline"><semantics id="S6.E9.m1.2a"><mrow id="S6.E9.m1.2.2.1"><mrow id="S6.E9.m1.2.2.1.1.2" xref="S6.E9.m1.2.2.1.1.3.cmml"><mrow id="S6.E9.m1.2.2.1.1.1.1" xref="S6.E9.m1.2.2.1.1.1.1.cmml"><mrow id="S6.E9.m1.2.2.1.1.1.1.2" xref="S6.E9.m1.2.2.1.1.1.1.2.cmml"><mtext id="S6.E9.m1.2.2.1.1.1.1.2.2" xref="S6.E9.m1.2.2.1.1.1.1.2.2a.cmml">s.t. </mtext><mo lspace="0em" rspace="0em" id="S6.E9.m1.2.2.1.1.1.1.2.1" xref="S6.E9.m1.2.2.1.1.1.1.2.1.cmml">​</mo><mi id="S6.E9.m1.2.2.1.1.1.1.2.3" xref="S6.E9.m1.2.2.1.1.1.1.2.3.cmml">γ</mi></mrow><mo id="S6.E9.m1.2.2.1.1.1.1.1" xref="S6.E9.m1.2.2.1.1.1.1.1.cmml">&gt;</mo><mn id="S6.E9.m1.2.2.1.1.1.1.3" xref="S6.E9.m1.2.2.1.1.1.1.3.cmml">0</mn></mrow><mo id="S6.E9.m1.2.2.1.1.2.3" xref="S6.E9.m1.2.2.1.1.3a.cmml">,</mo><mrow id="S6.E9.m1.2.2.1.1.2.2.2" xref="S6.E9.m1.2.2.1.1.2.2.3.cmml"><mrow id="S6.E9.m1.2.2.1.1.2.2.1.1" xref="S6.E9.m1.2.2.1.1.2.2.1.1.cmml"><msub id="S6.E9.m1.2.2.1.1.2.2.1.1.2" xref="S6.E9.m1.2.2.1.1.2.2.1.1.2.cmml"><mi id="S6.E9.m1.2.2.1.1.2.2.1.1.2.2" xref="S6.E9.m1.2.2.1.1.2.2.1.1.2.2.cmml">λ</mi><mi id="S6.E9.m1.2.2.1.1.2.2.1.1.2.3" xref="S6.E9.m1.2.2.1.1.2.2.1.1.2.3.cmml">i</mi></msub><mo id="S6.E9.m1.2.2.1.1.2.2.1.1.1" xref="S6.E9.m1.2.2.1.1.2.2.1.1.1.cmml">≥</mo><mn id="S6.E9.m1.2.2.1.1.2.2.1.1.3" xref="S6.E9.m1.2.2.1.1.2.2.1.1.3.cmml">0</mn></mrow><mo id="S6.E9.m1.2.2.1.1.2.2.2.3" xref="S6.E9.m1.2.2.1.1.2.2.3a.cmml">,</mo><mrow id="S6.E9.m1.2.2.1.1.2.2.2.2" xref="S6.E9.m1.2.2.1.1.2.2.2.2.cmml"><msub id="S6.E9.m1.2.2.1.1.2.2.2.2.2" xref="S6.E9.m1.2.2.1.1.2.2.2.2.2.cmml"><mrow id="S6.E9.m1.2.2.1.1.2.2.2.2.2.2.2" xref="S6.E9.m1.2.2.1.1.2.2.2.2.2.2.1.cmml"><mo stretchy="false" id="S6.E9.m1.2.2.1.1.2.2.2.2.2.2.2.1" xref="S6.E9.m1.2.2.1.1.2.2.2.2.2.2.1.1.cmml">‖</mo><mi id="S6.E9.m1.1.1" xref="S6.E9.m1.1.1.cmml">𝝀</mi><mo stretchy="false" id="S6.E9.m1.2.2.1.1.2.2.2.2.2.2.2.2" xref="S6.E9.m1.2.2.1.1.2.2.2.2.2.2.1.1.cmml">‖</mo></mrow><mn id="S6.E9.m1.2.2.1.1.2.2.2.2.2.3" xref="S6.E9.m1.2.2.1.1.2.2.2.2.2.3.cmml">1</mn></msub><mo id="S6.E9.m1.2.2.1.1.2.2.2.2.1" xref="S6.E9.m1.2.2.1.1.2.2.2.2.1.cmml">=</mo><mn id="S6.E9.m1.2.2.1.1.2.2.2.2.3" xref="S6.E9.m1.2.2.1.1.2.2.2.2.3.cmml">1</mn></mrow></mrow></mrow><mo lspace="0em" id="S6.E9.m1.2.2.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.E9.m1.2b"><apply id="S6.E9.m1.2.2.1.1.3.cmml" xref="S6.E9.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S6.E9.m1.2.2.1.1.3a.cmml" xref="S6.E9.m1.2.2.1.1.2.3">formulae-sequence</csymbol><apply id="S6.E9.m1.2.2.1.1.1.1.cmml" xref="S6.E9.m1.2.2.1.1.1.1"><gt id="S6.E9.m1.2.2.1.1.1.1.1.cmml" xref="S6.E9.m1.2.2.1.1.1.1.1"></gt><apply id="S6.E9.m1.2.2.1.1.1.1.2.cmml" xref="S6.E9.m1.2.2.1.1.1.1.2"><times id="S6.E9.m1.2.2.1.1.1.1.2.1.cmml" xref="S6.E9.m1.2.2.1.1.1.1.2.1"></times><ci id="S6.E9.m1.2.2.1.1.1.1.2.2a.cmml" xref="S6.E9.m1.2.2.1.1.1.1.2.2"><mtext id="S6.E9.m1.2.2.1.1.1.1.2.2.cmml" xref="S6.E9.m1.2.2.1.1.1.1.2.2">s.t. </mtext></ci><ci id="S6.E9.m1.2.2.1.1.1.1.2.3.cmml" xref="S6.E9.m1.2.2.1.1.1.1.2.3">𝛾</ci></apply><cn type="integer" id="S6.E9.m1.2.2.1.1.1.1.3.cmml" xref="S6.E9.m1.2.2.1.1.1.1.3">0</cn></apply><apply id="S6.E9.m1.2.2.1.1.2.2.3.cmml" xref="S6.E9.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S6.E9.m1.2.2.1.1.2.2.3a.cmml" xref="S6.E9.m1.2.2.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S6.E9.m1.2.2.1.1.2.2.1.1.cmml" xref="S6.E9.m1.2.2.1.1.2.2.1.1"><geq id="S6.E9.m1.2.2.1.1.2.2.1.1.1.cmml" xref="S6.E9.m1.2.2.1.1.2.2.1.1.1"></geq><apply id="S6.E9.m1.2.2.1.1.2.2.1.1.2.cmml" xref="S6.E9.m1.2.2.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="S6.E9.m1.2.2.1.1.2.2.1.1.2.1.cmml" xref="S6.E9.m1.2.2.1.1.2.2.1.1.2">subscript</csymbol><ci id="S6.E9.m1.2.2.1.1.2.2.1.1.2.2.cmml" xref="S6.E9.m1.2.2.1.1.2.2.1.1.2.2">𝜆</ci><ci id="S6.E9.m1.2.2.1.1.2.2.1.1.2.3.cmml" xref="S6.E9.m1.2.2.1.1.2.2.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S6.E9.m1.2.2.1.1.2.2.1.1.3.cmml" xref="S6.E9.m1.2.2.1.1.2.2.1.1.3">0</cn></apply><apply id="S6.E9.m1.2.2.1.1.2.2.2.2.cmml" xref="S6.E9.m1.2.2.1.1.2.2.2.2"><eq id="S6.E9.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S6.E9.m1.2.2.1.1.2.2.2.2.1"></eq><apply id="S6.E9.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S6.E9.m1.2.2.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S6.E9.m1.2.2.1.1.2.2.2.2.2.1.cmml" xref="S6.E9.m1.2.2.1.1.2.2.2.2.2">subscript</csymbol><apply id="S6.E9.m1.2.2.1.1.2.2.2.2.2.2.1.cmml" xref="S6.E9.m1.2.2.1.1.2.2.2.2.2.2.2"><csymbol cd="latexml" id="S6.E9.m1.2.2.1.1.2.2.2.2.2.2.1.1.cmml" xref="S6.E9.m1.2.2.1.1.2.2.2.2.2.2.2.1">norm</csymbol><ci id="S6.E9.m1.1.1.cmml" xref="S6.E9.m1.1.1">𝝀</ci></apply><cn type="integer" id="S6.E9.m1.2.2.1.1.2.2.2.2.2.3.cmml" xref="S6.E9.m1.2.2.1.1.2.2.2.2.2.3">1</cn></apply><cn type="integer" id="S6.E9.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S6.E9.m1.2.2.1.1.2.2.2.2.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E9.m1.2c">\displaystyle\text{ s.t. }\gamma&gt;0,\lambda_{i}\geq 0,\|\boldsymbol{\lambda}\|_{1}=1.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S6.SS1.p1.3" class="ltx_p">The pseudo-code of <span id="S6.SS1.p1.3.1" class="ltx_text ltx_font_smallcaps">FedLAW</span> is shown in Algorithm <a href="#alg1" title="Algorithm 1 ‣ 5.2 Attentive Learnable Aggregation Weight and Training Dynamics ‣ 5 Client coherence ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S6.SS1.p2" class="ltx_para">
<p id="S6.SS1.p2.4" class="ltx_p"><span id="S6.SS1.p2.4.1" class="ltx_text ltx_font_bold">With SWA (optional).</span> We adopt an alternative two-stage strategy for SWA variant (implementing it in a reversed order also works), where we first fix <math id="S6.SS1.p2.1.m1.1" class="ltx_Math" alttext="\boldsymbol{\lambda}" display="inline"><semantics id="S6.SS1.p2.1.m1.1a"><mi id="S6.SS1.p2.1.m1.1.1" xref="S6.SS1.p2.1.m1.1.1.cmml">𝝀</mi><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.1.m1.1b"><ci id="S6.SS1.p2.1.m1.1.1.cmml" xref="S6.SS1.p2.1.m1.1.1">𝝀</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.1.m1.1c">\boldsymbol{\lambda}</annotation></semantics></math> and optimize <math id="S6.SS1.p2.2.m2.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S6.SS1.p2.2.m2.1a"><mi id="S6.SS1.p2.2.m2.1.1" xref="S6.SS1.p2.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.2.m2.1b"><ci id="S6.SS1.p2.2.m2.1.1.cmml" xref="S6.SS1.p2.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.2.m2.1c">\gamma</annotation></semantics></math>, then we use the learned <math id="S6.SS1.p2.3.m3.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S6.SS1.p2.3.m3.1a"><mi id="S6.SS1.p2.3.m3.1.1" xref="S6.SS1.p2.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.3.m3.1b"><ci id="S6.SS1.p2.3.m3.1.1.cmml" xref="S6.SS1.p2.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.3.m3.1c">\gamma</annotation></semantics></math> and fix it to optimize <math id="S6.SS1.p2.4.m4.1" class="ltx_Math" alttext="\boldsymbol{\lambda}" display="inline"><semantics id="S6.SS1.p2.4.m4.1a"><mi id="S6.SS1.p2.4.m4.1.1" xref="S6.SS1.p2.4.m4.1.1.cmml">𝝀</mi><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.4.m4.1b"><ci id="S6.SS1.p2.4.m4.1.1.cmml" xref="S6.SS1.p2.4.m4.1.1">𝝀</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.4.m4.1c">\boldsymbol{\lambda}</annotation></semantics></math> with SWA.</p>
</div>
<div id="S6.SS1.p3" class="ltx_para">
<p id="S6.SS1.p3.1" class="ltx_p">In our experiments, we denote <span id="S6.SS1.p3.1.1" class="ltx_text ltx_font_smallcaps">FedLAW</span> with or without SWA as “<span id="S6.SS1.p3.1.2" class="ltx_text ltx_font_smallcaps">FedLAW (SWA)</span>” or “<span id="S6.SS1.p3.1.3" class="ltx_text ltx_font_smallcaps">FedLAW</span>”.</p>
</div>
<figure id="S6.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Performance comparison under different numbers of clients. CIFAR-10, ResNet20, <math id="S6.T4.2.m1.1" class="ltx_Math" alttext="E=3" display="inline"><semantics id="S6.T4.2.m1.1b"><mrow id="S6.T4.2.m1.1.1" xref="S6.T4.2.m1.1.1.cmml"><mi id="S6.T4.2.m1.1.1.2" xref="S6.T4.2.m1.1.1.2.cmml">E</mi><mo id="S6.T4.2.m1.1.1.1" xref="S6.T4.2.m1.1.1.1.cmml">=</mo><mn id="S6.T4.2.m1.1.1.3" xref="S6.T4.2.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T4.2.m1.1c"><apply id="S6.T4.2.m1.1.1.cmml" xref="S6.T4.2.m1.1.1"><eq id="S6.T4.2.m1.1.1.1.cmml" xref="S6.T4.2.m1.1.1.1"></eq><ci id="S6.T4.2.m1.1.1.2.cmml" xref="S6.T4.2.m1.1.1.2">𝐸</ci><cn type="integer" id="S6.T4.2.m1.1.1.3.cmml" xref="S6.T4.2.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.2.m1.1d">E=3</annotation></semantics></math>.</figcaption>
<div id="S6.T4.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:346.9pt;height:156.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(54.0pt,-24.4pt) scale(1.45160516283791,1.45160516283791) ;">
<table id="S6.T4.5.3" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S6.T4.4.2.2" class="ltx_tr">
<th id="S6.T4.4.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt">Setting</th>
<th id="S6.T4.3.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">IID (<math id="S6.T4.3.1.1.1.m1.1" class="ltx_Math" alttext="\alpha=100" display="inline"><semantics id="S6.T4.3.1.1.1.m1.1a"><mrow id="S6.T4.3.1.1.1.m1.1.1" xref="S6.T4.3.1.1.1.m1.1.1.cmml"><mi id="S6.T4.3.1.1.1.m1.1.1.2" xref="S6.T4.3.1.1.1.m1.1.1.2.cmml">α</mi><mo id="S6.T4.3.1.1.1.m1.1.1.1" xref="S6.T4.3.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S6.T4.3.1.1.1.m1.1.1.3" xref="S6.T4.3.1.1.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T4.3.1.1.1.m1.1b"><apply id="S6.T4.3.1.1.1.m1.1.1.cmml" xref="S6.T4.3.1.1.1.m1.1.1"><eq id="S6.T4.3.1.1.1.m1.1.1.1.cmml" xref="S6.T4.3.1.1.1.m1.1.1.1"></eq><ci id="S6.T4.3.1.1.1.m1.1.1.2.cmml" xref="S6.T4.3.1.1.1.m1.1.1.2">𝛼</ci><cn type="integer" id="S6.T4.3.1.1.1.m1.1.1.3.cmml" xref="S6.T4.3.1.1.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.3.1.1.1.m1.1c">\alpha=100</annotation></semantics></math>)</th>
<th id="S6.T4.4.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">NonIID (<math id="S6.T4.4.2.2.2.m1.1" class="ltx_Math" alttext="\alpha=1" display="inline"><semantics id="S6.T4.4.2.2.2.m1.1a"><mrow id="S6.T4.4.2.2.2.m1.1.1" xref="S6.T4.4.2.2.2.m1.1.1.cmml"><mi id="S6.T4.4.2.2.2.m1.1.1.2" xref="S6.T4.4.2.2.2.m1.1.1.2.cmml">α</mi><mo id="S6.T4.4.2.2.2.m1.1.1.1" xref="S6.T4.4.2.2.2.m1.1.1.1.cmml">=</mo><mn id="S6.T4.4.2.2.2.m1.1.1.3" xref="S6.T4.4.2.2.2.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T4.4.2.2.2.m1.1b"><apply id="S6.T4.4.2.2.2.m1.1.1.cmml" xref="S6.T4.4.2.2.2.m1.1.1"><eq id="S6.T4.4.2.2.2.m1.1.1.1.cmml" xref="S6.T4.4.2.2.2.m1.1.1.1"></eq><ci id="S6.T4.4.2.2.2.m1.1.1.2.cmml" xref="S6.T4.4.2.2.2.m1.1.1.2">𝛼</ci><cn type="integer" id="S6.T4.4.2.2.2.m1.1.1.3.cmml" xref="S6.T4.4.2.2.2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.4.2.2.2.m1.1c">\alpha=1</annotation></semantics></math>)</th>
</tr>
<tr id="S6.T4.5.3.3" class="ltx_tr">
<th id="S6.T4.5.3.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t">Number of clients <math id="S6.T4.5.3.3.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S6.T4.5.3.3.1.m1.1a"><mi id="S6.T4.5.3.3.1.m1.1.1" xref="S6.T4.5.3.3.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S6.T4.5.3.3.1.m1.1b"><ci id="S6.T4.5.3.3.1.m1.1.1.cmml" xref="S6.T4.5.3.3.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T4.5.3.3.1.m1.1c">n</annotation></semantics></math>
</th>
<th id="S6.T4.5.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">50</th>
<th id="S6.T4.5.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">100</th>
<th id="S6.T4.5.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">50</th>
<th id="S6.T4.5.3.3.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t">100</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S6.T4.5.3.4.1" class="ltx_tr">
<th id="S6.T4.5.3.4.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S6.T4.5.3.4.1.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span></th>
<td id="S6.T4.5.3.4.1.2" class="ltx_td ltx_align_center ltx_border_t">68.04</td>
<td id="S6.T4.5.3.4.1.3" class="ltx_td ltx_align_center ltx_border_t">62.41</td>
<td id="S6.T4.5.3.4.1.4" class="ltx_td ltx_align_center ltx_border_t">66.87</td>
<td id="S6.T4.5.3.4.1.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">64.13</td>
</tr>
<tr id="S6.T4.5.3.5.2" class="ltx_tr">
<th id="S6.T4.5.3.5.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="S6.T4.5.3.5.2.1.1" class="ltx_text ltx_font_smallcaps">FedDF</span></th>
<td id="S6.T4.5.3.5.2.2" class="ltx_td ltx_align_center">48.24</td>
<td id="S6.T4.5.3.5.2.3" class="ltx_td ltx_align_center">38.66</td>
<td id="S6.T4.5.3.5.2.4" class="ltx_td ltx_align_center">38.70</td>
<td id="S6.T4.5.3.5.2.5" class="ltx_td ltx_nopad_r ltx_align_center">22.51</td>
</tr>
<tr id="S6.T4.5.3.6.3" class="ltx_tr">
<th id="S6.T4.5.3.6.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="S6.T4.5.3.6.3.1.1" class="ltx_text ltx_font_smallcaps">Server-FT</span></th>
<td id="S6.T4.5.3.6.3.2" class="ltx_td ltx_align_center">67.77</td>
<td id="S6.T4.5.3.6.3.3" class="ltx_td ltx_align_center">62.30</td>
<td id="S6.T4.5.3.6.3.4" class="ltx_td ltx_align_center">66.73</td>
<td id="S6.T4.5.3.6.3.5" class="ltx_td ltx_nopad_r ltx_align_center">64.63</td>
</tr>
<tr id="S6.T4.5.3.7.4" class="ltx_tr">
<th id="S6.T4.5.3.7.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t"><span id="S6.T4.5.3.7.4.1.1" class="ltx_text ltx_font_smallcaps">FedLAW</span></th>
<td id="S6.T4.5.3.7.4.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S6.T4.5.3.7.4.2.1" class="ltx_text ltx_font_bold">78.88</span></td>
<td id="S6.T4.5.3.7.4.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S6.T4.5.3.7.4.3.1" class="ltx_text ltx_font_bold">74.09</span></td>
<td id="S6.T4.5.3.7.4.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S6.T4.5.3.7.4.4.1" class="ltx_text ltx_font_bold">75.59</span></td>
<td id="S6.T4.5.3.7.4.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_t"><span id="S6.T4.5.3.7.4.5.1" class="ltx_text ltx_font_bold">71.34</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S6.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:50%;"><span class="ltx_tag ltx_tag_table">Table 5: </span><span id="S6.T5.2.1" class="ltx_text" style="font-size:180%;">The performance of compared methods with different model architectures (<math id="S6.T5.2.1.m1.2" class="ltx_Math" alttext="\alpha=1,~{}E=1" display="inline"><semantics id="S6.T5.2.1.m1.2b"><mrow id="S6.T5.2.1.m1.2.2.2" xref="S6.T5.2.1.m1.2.2.3.cmml"><mrow id="S6.T5.2.1.m1.1.1.1.1" xref="S6.T5.2.1.m1.1.1.1.1.cmml"><mi id="S6.T5.2.1.m1.1.1.1.1.2" xref="S6.T5.2.1.m1.1.1.1.1.2.cmml">α</mi><mo id="S6.T5.2.1.m1.1.1.1.1.1" xref="S6.T5.2.1.m1.1.1.1.1.1.cmml">=</mo><mn id="S6.T5.2.1.m1.1.1.1.1.3" xref="S6.T5.2.1.m1.1.1.1.1.3.cmml">1</mn></mrow><mo rspace="0.467em" id="S6.T5.2.1.m1.2.2.2.3" xref="S6.T5.2.1.m1.2.2.3a.cmml">,</mo><mrow id="S6.T5.2.1.m1.2.2.2.2" xref="S6.T5.2.1.m1.2.2.2.2.cmml"><mi id="S6.T5.2.1.m1.2.2.2.2.2" xref="S6.T5.2.1.m1.2.2.2.2.2.cmml">E</mi><mo id="S6.T5.2.1.m1.2.2.2.2.1" xref="S6.T5.2.1.m1.2.2.2.2.1.cmml">=</mo><mn id="S6.T5.2.1.m1.2.2.2.2.3" xref="S6.T5.2.1.m1.2.2.2.2.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.T5.2.1.m1.2c"><apply id="S6.T5.2.1.m1.2.2.3.cmml" xref="S6.T5.2.1.m1.2.2.2"><csymbol cd="ambiguous" id="S6.T5.2.1.m1.2.2.3a.cmml" xref="S6.T5.2.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S6.T5.2.1.m1.1.1.1.1.cmml" xref="S6.T5.2.1.m1.1.1.1.1"><eq id="S6.T5.2.1.m1.1.1.1.1.1.cmml" xref="S6.T5.2.1.m1.1.1.1.1.1"></eq><ci id="S6.T5.2.1.m1.1.1.1.1.2.cmml" xref="S6.T5.2.1.m1.1.1.1.1.2">𝛼</ci><cn type="integer" id="S6.T5.2.1.m1.1.1.1.1.3.cmml" xref="S6.T5.2.1.m1.1.1.1.1.3">1</cn></apply><apply id="S6.T5.2.1.m1.2.2.2.2.cmml" xref="S6.T5.2.1.m1.2.2.2.2"><eq id="S6.T5.2.1.m1.2.2.2.2.1.cmml" xref="S6.T5.2.1.m1.2.2.2.2.1"></eq><ci id="S6.T5.2.1.m1.2.2.2.2.2.cmml" xref="S6.T5.2.1.m1.2.2.2.2.2">𝐸</ci><cn type="integer" id="S6.T5.2.1.m1.2.2.2.2.3.cmml" xref="S6.T5.2.1.m1.2.2.2.2.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.2.1.m1.2d">\alpha=1,~{}E=1</annotation></semantics></math>).</span></figcaption>
<div id="S6.T5.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:390.3pt;height:283.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(120.9pt,-88.0pt) scale(2.62896510721073,2.62896510721073) ;">
<table id="S6.T5.4.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S6.T5.4.1.1.1" class="ltx_tr">
<th id="S6.T5.4.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt"><span id="S6.T5.4.1.1.1.1.1" class="ltx_text" style="font-size:50%;">Model</span></th>
<th id="S6.T5.4.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S6.T5.4.1.1.1.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:50%;">FedAvg</span></th>
<th id="S6.T5.4.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S6.T5.4.1.1.1.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:50%;">FedLAW</span></th>
<th id="S6.T5.4.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S6.T5.4.1.1.1.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:50%;">FedLAW(SWA)</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S6.T5.4.1.2.1" class="ltx_tr">
<th id="S6.T5.4.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S6.T5.4.1.2.1.1.1" class="ltx_text" style="font-size:50%;">ResNet20</span></th>
<td id="S6.T5.4.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S6.T5.4.1.2.1.2.1" class="ltx_text" style="font-size:50%;">74.11</span></td>
<td id="S6.T5.4.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S6.T5.4.1.2.1.3.1" class="ltx_text" style="font-size:50%;">78.72</span></td>
<td id="S6.T5.4.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S6.T5.4.1.2.1.4.1" class="ltx_text" style="font-size:50%;">78.64</span></td>
</tr>
<tr id="S6.T5.4.1.3.2" class="ltx_tr">
<th id="S6.T5.4.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S6.T5.4.1.3.2.1.1" class="ltx_text" style="font-size:50%;">ResNet56</span></th>
<td id="S6.T5.4.1.3.2.2" class="ltx_td ltx_align_center"><span id="S6.T5.4.1.3.2.2.1" class="ltx_text" style="font-size:50%;">74.22</span></td>
<td id="S6.T5.4.1.3.2.3" class="ltx_td ltx_align_center"><span id="S6.T5.4.1.3.2.3.1" class="ltx_text" style="font-size:50%;">78.93</span></td>
<td id="S6.T5.4.1.3.2.4" class="ltx_td ltx_align_center"><span id="S6.T5.4.1.3.2.4.1" class="ltx_text" style="font-size:50%;">79.08</span></td>
</tr>
<tr id="S6.T5.4.1.4.3" class="ltx_tr">
<th id="S6.T5.4.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S6.T5.4.1.4.3.1.1" class="ltx_text" style="font-size:50%;">ResNet110</span></th>
<td id="S6.T5.4.1.4.3.2" class="ltx_td ltx_align_center"><span id="S6.T5.4.1.4.3.2.1" class="ltx_text" style="font-size:50%;">74.50</span></td>
<td id="S6.T5.4.1.4.3.3" class="ltx_td ltx_align_center"><span id="S6.T5.4.1.4.3.3.1" class="ltx_text" style="font-size:50%;">78.11</span></td>
<td id="S6.T5.4.1.4.3.4" class="ltx_td ltx_align_center"><span id="S6.T5.4.1.4.3.4.1" class="ltx_text" style="font-size:50%;">79.19</span></td>
</tr>
<tr id="S6.T5.4.1.5.4" class="ltx_tr">
<th id="S6.T5.4.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S6.T5.4.1.5.4.1.1" class="ltx_text" style="font-size:50%;">WRN56_4</span></th>
<td id="S6.T5.4.1.5.4.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S6.T5.4.1.5.4.2.1" class="ltx_text" style="font-size:50%;">78.67</span></td>
<td id="S6.T5.4.1.5.4.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S6.T5.4.1.5.4.3.1" class="ltx_text" style="font-size:50%;">79.61</span></td>
<td id="S6.T5.4.1.5.4.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S6.T5.4.1.5.4.4.1" class="ltx_text" style="font-size:50%;">80.70</span></td>
</tr>
<tr id="S6.T5.4.1.6.5" class="ltx_tr">
<th id="S6.T5.4.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t"><span id="S6.T5.4.1.6.5.1.1" class="ltx_text" style="font-size:50%;">DenseNet121</span></th>
<td id="S6.T5.4.1.6.5.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S6.T5.4.1.6.5.2.1" class="ltx_text" style="font-size:50%;">85.13</span></td>
<td id="S6.T5.4.1.6.5.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S6.T5.4.1.6.5.3.1" class="ltx_text" style="font-size:50%;">86.50</span></td>
<td id="S6.T5.4.1.6.5.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S6.T5.4.1.6.5.4.1" class="ltx_text" style="font-size:50%;">87.06</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S6.F8" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2302.10911/assets/x15.png" id="S6.F8.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="392" height="248" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2302.10911/assets/x16.png" id="S6.F8.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="392" height="248" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span><span id="S6.F8.4.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Left:<span id="S6.F8.3.1.1" class="ltx_text ltx_font_medium"> The performance with different participation ratios (<math id="S6.F8.3.1.1.m1.2" class="ltx_Math" alttext="\alpha=1,~{}E=3" display="inline"><semantics id="S6.F8.3.1.1.m1.2b"><mrow id="S6.F8.3.1.1.m1.2.2.2" xref="S6.F8.3.1.1.m1.2.2.3.cmml"><mrow id="S6.F8.3.1.1.m1.1.1.1.1" xref="S6.F8.3.1.1.m1.1.1.1.1.cmml"><mi id="S6.F8.3.1.1.m1.1.1.1.1.2" xref="S6.F8.3.1.1.m1.1.1.1.1.2.cmml">α</mi><mo id="S6.F8.3.1.1.m1.1.1.1.1.1" xref="S6.F8.3.1.1.m1.1.1.1.1.1.cmml">=</mo><mn id="S6.F8.3.1.1.m1.1.1.1.1.3" xref="S6.F8.3.1.1.m1.1.1.1.1.3.cmml">1</mn></mrow><mo rspace="0.467em" id="S6.F8.3.1.1.m1.2.2.2.3" xref="S6.F8.3.1.1.m1.2.2.3a.cmml">,</mo><mrow id="S6.F8.3.1.1.m1.2.2.2.2" xref="S6.F8.3.1.1.m1.2.2.2.2.cmml"><mi id="S6.F8.3.1.1.m1.2.2.2.2.2" xref="S6.F8.3.1.1.m1.2.2.2.2.2.cmml">E</mi><mo id="S6.F8.3.1.1.m1.2.2.2.2.1" xref="S6.F8.3.1.1.m1.2.2.2.2.1.cmml">=</mo><mn id="S6.F8.3.1.1.m1.2.2.2.2.3" xref="S6.F8.3.1.1.m1.2.2.2.2.3.cmml">3</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.F8.3.1.1.m1.2c"><apply id="S6.F8.3.1.1.m1.2.2.3.cmml" xref="S6.F8.3.1.1.m1.2.2.2"><csymbol cd="ambiguous" id="S6.F8.3.1.1.m1.2.2.3a.cmml" xref="S6.F8.3.1.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S6.F8.3.1.1.m1.1.1.1.1.cmml" xref="S6.F8.3.1.1.m1.1.1.1.1"><eq id="S6.F8.3.1.1.m1.1.1.1.1.1.cmml" xref="S6.F8.3.1.1.m1.1.1.1.1.1"></eq><ci id="S6.F8.3.1.1.m1.1.1.1.1.2.cmml" xref="S6.F8.3.1.1.m1.1.1.1.1.2">𝛼</ci><cn type="integer" id="S6.F8.3.1.1.m1.1.1.1.1.3.cmml" xref="S6.F8.3.1.1.m1.1.1.1.1.3">1</cn></apply><apply id="S6.F8.3.1.1.m1.2.2.2.2.cmml" xref="S6.F8.3.1.1.m1.2.2.2.2"><eq id="S6.F8.3.1.1.m1.2.2.2.2.1.cmml" xref="S6.F8.3.1.1.m1.2.2.2.2.1"></eq><ci id="S6.F8.3.1.1.m1.2.2.2.2.2.cmml" xref="S6.F8.3.1.1.m1.2.2.2.2.2">𝐸</ci><cn type="integer" id="S6.F8.3.1.1.m1.2.2.2.2.3.cmml" xref="S6.F8.3.1.1.m1.2.2.2.2.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F8.3.1.1.m1.2d">\alpha=1,~{}E=3</annotation></semantics></math>). </span>Right:<span id="S6.F8.4.2.2" class="ltx_text ltx_font_medium"> The performance with different sizes of the proxy dataset (<math id="S6.F8.4.2.2.m1.2" class="ltx_Math" alttext="\alpha=0.1,~{}E=3" display="inline"><semantics id="S6.F8.4.2.2.m1.2b"><mrow id="S6.F8.4.2.2.m1.2.2.2" xref="S6.F8.4.2.2.m1.2.2.3.cmml"><mrow id="S6.F8.4.2.2.m1.1.1.1.1" xref="S6.F8.4.2.2.m1.1.1.1.1.cmml"><mi id="S6.F8.4.2.2.m1.1.1.1.1.2" xref="S6.F8.4.2.2.m1.1.1.1.1.2.cmml">α</mi><mo id="S6.F8.4.2.2.m1.1.1.1.1.1" xref="S6.F8.4.2.2.m1.1.1.1.1.1.cmml">=</mo><mn id="S6.F8.4.2.2.m1.1.1.1.1.3" xref="S6.F8.4.2.2.m1.1.1.1.1.3.cmml">0.1</mn></mrow><mo rspace="0.467em" id="S6.F8.4.2.2.m1.2.2.2.3" xref="S6.F8.4.2.2.m1.2.2.3a.cmml">,</mo><mrow id="S6.F8.4.2.2.m1.2.2.2.2" xref="S6.F8.4.2.2.m1.2.2.2.2.cmml"><mi id="S6.F8.4.2.2.m1.2.2.2.2.2" xref="S6.F8.4.2.2.m1.2.2.2.2.2.cmml">E</mi><mo id="S6.F8.4.2.2.m1.2.2.2.2.1" xref="S6.F8.4.2.2.m1.2.2.2.2.1.cmml">=</mo><mn id="S6.F8.4.2.2.m1.2.2.2.2.3" xref="S6.F8.4.2.2.m1.2.2.2.2.3.cmml">3</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.F8.4.2.2.m1.2c"><apply id="S6.F8.4.2.2.m1.2.2.3.cmml" xref="S6.F8.4.2.2.m1.2.2.2"><csymbol cd="ambiguous" id="S6.F8.4.2.2.m1.2.2.3a.cmml" xref="S6.F8.4.2.2.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S6.F8.4.2.2.m1.1.1.1.1.cmml" xref="S6.F8.4.2.2.m1.1.1.1.1"><eq id="S6.F8.4.2.2.m1.1.1.1.1.1.cmml" xref="S6.F8.4.2.2.m1.1.1.1.1.1"></eq><ci id="S6.F8.4.2.2.m1.1.1.1.1.2.cmml" xref="S6.F8.4.2.2.m1.1.1.1.1.2">𝛼</ci><cn type="float" id="S6.F8.4.2.2.m1.1.1.1.1.3.cmml" xref="S6.F8.4.2.2.m1.1.1.1.1.3">0.1</cn></apply><apply id="S6.F8.4.2.2.m1.2.2.2.2.cmml" xref="S6.F8.4.2.2.m1.2.2.2.2"><eq id="S6.F8.4.2.2.m1.2.2.2.2.1.cmml" xref="S6.F8.4.2.2.m1.2.2.2.2.1"></eq><ci id="S6.F8.4.2.2.m1.2.2.2.2.2.cmml" xref="S6.F8.4.2.2.m1.2.2.2.2.2">𝐸</ci><cn type="integer" id="S6.F8.4.2.2.m1.2.2.2.2.3.cmml" xref="S6.F8.4.2.2.m1.2.2.2.2.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F8.4.2.2.m1.2d">\alpha=0.1,~{}E=3</annotation></semantics></math>).
</span></span></figcaption>
</figure>
</section>
<section id="S6.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Experiments</h3>

<div id="S6.SS2.p1" class="ltx_para">
<p id="S6.SS2.p1.1" class="ltx_p"><span id="S6.SS2.p1.1.1" class="ltx_text ltx_font_bold">Baselines and Settings.</span> We conduct experiments to verify the effectiveness of <span id="S6.SS2.p1.1.2" class="ltx_text ltx_font_smallcaps">FedLAW</span>. We mainly compare <span id="S6.SS2.p1.1.3" class="ltx_text ltx_font_smallcaps">FedLAW</span> with other server-side methods, i.e. <span id="S6.SS2.p1.1.4" class="ltx_text ltx_font_smallcaps">FedDF</span> <cite class="ltx_cite ltx_citemacro_citep">(Lin et al., <a href="#bib.bib38" title="" class="ltx_ref">2020</a>)</cite> and <span id="S6.SS2.p1.1.5" class="ltx_text ltx_font_smallcaps">FedBE</span> <cite class="ltx_cite ltx_citemacro_citep">(Chen &amp; Chao, <a href="#bib.bib7" title="" class="ltx_ref">2021</a>)</cite>, that also require a proxy dataset for additional computation. These two methods conduct ensemble distillation on the proxy data to transfer knowledge from clients’ models to the global model. We add <span id="S6.SS2.p1.1.6" class="ltx_text ltx_font_smallcaps">Server-FT</span> as a baseline for simply finetuning global models on the proxy dataset. Besides, we implement client-side algorithms <span id="S6.SS2.p1.1.7" class="ltx_text ltx_font_smallcaps">FedProx</span> <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib34" title="" class="ltx_ref">2020b</a>)</cite> and <span id="S6.SS2.p1.1.8" class="ltx_text ltx_font_smallcaps">FedDyn</span> <cite class="ltx_cite ltx_citemacro_citep">(Acar et al., <a href="#bib.bib1" title="" class="ltx_ref">2020</a>)</cite> for comparison. If not mentioned otherwise, the number of clients is 20. More implementation details can be found in <a href="#A3" title="Appendix C Additional Details of FedLAW ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Appendix C</span></a> and <a href="#A4" title="Appendix D Implementation Details ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Appendix D</span></a>.</p>
</div>
<div id="S6.SS2.p2" class="ltx_para">
<p id="S6.SS2.p2.1" class="ltx_p"><span id="S6.SS2.p2.1.1" class="ltx_text ltx_font_bold">Experimental results. <span id="S6.SS2.p2.1.1.1" class="ltx_text ltx_font_italic">Different datasets:</span></span> As in <a href="#S5.T3" title="Table 3 ‣ 5.2 Attentive Learnable Aggregation Weight and Training Dynamics ‣ 5 Client coherence ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 3</span></a>, <span id="S6.SS2.p2.1.2" class="ltx_text ltx_font_smallcaps">FedLAW</span> outperforms baselines on different datasets and models in both IID and NonIID settings. Compared with <span id="S6.SS2.p2.1.3" class="ltx_text ltx_font_smallcaps">FedDF</span>, <span id="S6.SS2.p2.1.4" class="ltx_text ltx_font_smallcaps">FedBE</span> and <span id="S6.SS2.p2.1.5" class="ltx_text ltx_font_smallcaps">Server-FT</span>, <span id="S6.SS2.p2.1.6" class="ltx_text ltx_font_smallcaps">FedLAW</span> can better utilize the proxy dataset.
<span id="S6.SS2.p2.1.7" class="ltx_text ltx_font_bold ltx_font_italic">Different numbers of clients:</span> We implement experiments by scaling up the number of clients in <a href="#S6.T4" title="Table 4 ‣ 6.1 Method ‣ 6 FedLAW ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 4</span></a>, and it is shown that <span id="S6.SS2.p2.1.8" class="ltx_text ltx_font_smallcaps">FedLAW</span> also surpasses the baselines by large margins.
<span id="S6.SS2.p2.1.9" class="ltx_text ltx_font_bold ltx_font_italic">Different model architectures:</span> We test <span id="S6.SS2.p2.1.10" class="ltx_text ltx_font_smallcaps">FedLAW</span> across wider and deeper ResNet and other architecture, such as DenseNet <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a href="#bib.bib19" title="" class="ltx_ref">2017</a>)</cite>, in the <a href="#S6.T5" title="Table 5 ‣ 6.1 Method ‣ 6 FedLAW ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 5</span></a>. It shows that <span id="S6.SS2.p2.1.11" class="ltx_text ltx_font_smallcaps">FedLAW</span> is effective across different architectures, and it performs well even when the network goes deeper or wider.
<span id="S6.SS2.p2.1.12" class="ltx_text ltx_font_bold ltx_font_italic">Different participation ratios:</span> From the left of <a href="#S6.F8" title="Figure 8 ‣ 6.1 Method ‣ 6 FedLAW ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 8</span></a>, <span id="S6.SS2.p2.1.13" class="ltx_text ltx_font_smallcaps">FedLAW</span> performs well under partial participation.
<span id="S6.SS2.p2.1.14" class="ltx_text ltx_font_bold ltx_font_italic">Different sizes and distributions of proxy dataset:</span> From the right of <a href="#S6.F8" title="Figure 8 ‣ 6.1 Method ‣ 6 FedLAW ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 8</span></a>, the server-side baselines are sensitive to the size of the proxy dataset that too small or too large proxy set will cause overfitting. However, <span id="S6.SS2.p2.1.15" class="ltx_text ltx_font_smallcaps">FedLAW</span> is also effective under an extremely tiny proxy set and benefits more from a larger proxy set due to accurate aggregation weight optimization. We report the results of different distributions of the proxy dataset in <a href="#S6.T6" title="Table 6 ‣ 6.2 Experiments ‣ 6 FedLAW ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 6</span></a> and <a href="#S6.T8" title="Table 8 ‣ 6.2 Experiments ‣ 6 FedLAW ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 8</span></a>, which show that FedLAW still works when there exists a distribution shift between the proxy dataset and the global data distribution of clients.
<span id="S6.SS2.p2.1.16" class="ltx_text ltx_font_bold ltx_font_italic">Robustness against corrupted clients:</span> Another advantage of <span id="S6.SS2.p2.1.17" class="ltx_text ltx_font_smallcaps">FedLAW</span> is that it can filter out corrupted clients by assigning them lower weights. We generate corrupted clients by swapping two labels in their local training data. As in <a href="#S6.T8" title="Table 8 ‣ 6.2 Experiments ‣ 6 FedLAW ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 8</span></a>, <span id="S6.SS2.p2.1.18" class="ltx_text ltx_font_smallcaps">FedLAW</span> is robust against corrupted clients, and it is as robust as the ensemble distillation methods, such as <span id="S6.SS2.p2.1.19" class="ltx_text ltx_font_smallcaps">FedDF</span>, using the same proxy dataset.</p>
</div>
<div id="S6.SS2.p3" class="ltx_para">
<p id="S6.SS2.p3.1" class="ltx_p"><span id="S6.SS2.p3.1.1" class="ltx_text ltx_font_bold">More results.</span> We present more results in the appendix. Specifically, the learning curves of test accuracy (Figures <a href="#A2.F15" title="Figure 15 ‣ B.3 Learning curves of FedLAW and baselines ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">15</span></a>-<a href="#A2.F17" title="Figure 17 ‣ B.3 Learning curves of FedLAW and baselines ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">17</span></a>) and the server training process of <span id="S6.SS2.p3.1.2" class="ltx_text ltx_font_smallcaps">FedLAW</span> (<a href="#A2.F14" title="Figure 14 ‣ B.3 Learning curves of FedLAW and baselines ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 14</span></a>).</p>
</div>
<figure id="S6.T6" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>The performance on the distribution shift setting where the clients’ data are overall balanced and the proxy data are long-tailed (<math id="S6.T6.2.m1.1" class="ltx_Math" alttext="\rho=10" display="inline"><semantics id="S6.T6.2.m1.1b"><mrow id="S6.T6.2.m1.1.1" xref="S6.T6.2.m1.1.1.cmml"><mi id="S6.T6.2.m1.1.1.2" xref="S6.T6.2.m1.1.1.2.cmml">ρ</mi><mo id="S6.T6.2.m1.1.1.1" xref="S6.T6.2.m1.1.1.1.cmml">=</mo><mn id="S6.T6.2.m1.1.1.3" xref="S6.T6.2.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T6.2.m1.1c"><apply id="S6.T6.2.m1.1.1.cmml" xref="S6.T6.2.m1.1.1"><eq id="S6.T6.2.m1.1.1.1.cmml" xref="S6.T6.2.m1.1.1.1"></eq><ci id="S6.T6.2.m1.1.1.2.cmml" xref="S6.T6.2.m1.1.1.2">𝜌</ci><cn type="integer" id="S6.T6.2.m1.1.1.3.cmml" xref="S6.T6.2.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T6.2.m1.1d">\rho=10</annotation></semantics></math>).</figcaption>
<div id="S6.T6.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:137.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(46.7pt,-14.8pt) scale(1.27441339879195,1.27441339879195) ;">
<table id="S6.T6.4.2" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S6.T6.4.2.2" class="ltx_tr">
<th id="S6.T6.4.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt">Setting</th>
<td id="S6.T6.3.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" colspan="3">IID (<math id="S6.T6.3.1.1.1.m1.1" class="ltx_Math" alttext="\alpha=100" display="inline"><semantics id="S6.T6.3.1.1.1.m1.1a"><mrow id="S6.T6.3.1.1.1.m1.1.1" xref="S6.T6.3.1.1.1.m1.1.1.cmml"><mi id="S6.T6.3.1.1.1.m1.1.1.2" xref="S6.T6.3.1.1.1.m1.1.1.2.cmml">α</mi><mo id="S6.T6.3.1.1.1.m1.1.1.1" xref="S6.T6.3.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S6.T6.3.1.1.1.m1.1.1.3" xref="S6.T6.3.1.1.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T6.3.1.1.1.m1.1b"><apply id="S6.T6.3.1.1.1.m1.1.1.cmml" xref="S6.T6.3.1.1.1.m1.1.1"><eq id="S6.T6.3.1.1.1.m1.1.1.1.cmml" xref="S6.T6.3.1.1.1.m1.1.1.1"></eq><ci id="S6.T6.3.1.1.1.m1.1.1.2.cmml" xref="S6.T6.3.1.1.1.m1.1.1.2">𝛼</ci><cn type="integer" id="S6.T6.3.1.1.1.m1.1.1.3.cmml" xref="S6.T6.3.1.1.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T6.3.1.1.1.m1.1c">\alpha=100</annotation></semantics></math>)</td>
<td id="S6.T6.4.2.2.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="3">NonIID (<math id="S6.T6.4.2.2.2.m1.1" class="ltx_Math" alttext="\alpha=1" display="inline"><semantics id="S6.T6.4.2.2.2.m1.1a"><mrow id="S6.T6.4.2.2.2.m1.1.1" xref="S6.T6.4.2.2.2.m1.1.1.cmml"><mi id="S6.T6.4.2.2.2.m1.1.1.2" xref="S6.T6.4.2.2.2.m1.1.1.2.cmml">α</mi><mo id="S6.T6.4.2.2.2.m1.1.1.1" xref="S6.T6.4.2.2.2.m1.1.1.1.cmml">=</mo><mn id="S6.T6.4.2.2.2.m1.1.1.3" xref="S6.T6.4.2.2.2.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T6.4.2.2.2.m1.1b"><apply id="S6.T6.4.2.2.2.m1.1.1.cmml" xref="S6.T6.4.2.2.2.m1.1.1"><eq id="S6.T6.4.2.2.2.m1.1.1.1.cmml" xref="S6.T6.4.2.2.2.m1.1.1.1"></eq><ci id="S6.T6.4.2.2.2.m1.1.1.2.cmml" xref="S6.T6.4.2.2.2.m1.1.1.2">𝛼</ci><cn type="integer" id="S6.T6.4.2.2.2.m1.1.1.3.cmml" xref="S6.T6.4.2.2.2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T6.4.2.2.2.m1.1c">\alpha=1</annotation></semantics></math>)</td>
</tr>
<tr id="S6.T6.4.2.3.1" class="ltx_tr">
<th id="S6.T6.4.2.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">Type of proxy data</th>
<td id="S6.T6.4.2.3.1.2" class="ltx_td ltx_align_center ltx_border_t">Balanced</td>
<td id="S6.T6.4.2.3.1.3" class="ltx_td ltx_align_center ltx_border_t" colspan="2">Long-tailed</td>
<td id="S6.T6.4.2.3.1.4" class="ltx_td ltx_align_center ltx_border_t">Balanced</td>
<td id="S6.T6.4.2.3.1.5" class="ltx_td ltx_align_center ltx_border_t" colspan="2">Long-tailed</td>
</tr>
<tr id="S6.T6.4.2.4.2" class="ltx_tr">
<th id="S6.T6.4.2.4.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Balanced Sampling</th>
<td id="S6.T6.4.2.4.2.2" class="ltx_td ltx_align_center">-</td>
<td id="S6.T6.4.2.4.2.3" class="ltx_td ltx_align_center">w/o</td>
<td id="S6.T6.4.2.4.2.4" class="ltx_td ltx_align_center">w</td>
<td id="S6.T6.4.2.4.2.5" class="ltx_td ltx_align_center">-</td>
<td id="S6.T6.4.2.4.2.6" class="ltx_td ltx_align_center">w/o</td>
<td id="S6.T6.4.2.4.2.7" class="ltx_td ltx_nopad_r ltx_align_center">w</td>
</tr>
<tr id="S6.T6.4.2.5.3" class="ltx_tr">
<th id="S6.T6.4.2.5.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S6.T6.4.2.5.3.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span></th>
<td id="S6.T6.4.2.5.3.2" class="ltx_td ltx_align_center ltx_border_t">75.24</td>
<td id="S6.T6.4.2.5.3.3" class="ltx_td ltx_align_center ltx_border_t">75.24</td>
<td id="S6.T6.4.2.5.3.4" class="ltx_td ltx_align_center ltx_border_t">75.24</td>
<td id="S6.T6.4.2.5.3.5" class="ltx_td ltx_align_center ltx_border_t">73.46</td>
<td id="S6.T6.4.2.5.3.6" class="ltx_td ltx_align_center ltx_border_t">73.46</td>
<td id="S6.T6.4.2.5.3.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t"><span id="S6.T6.4.2.5.3.7.1" class="ltx_text ltx_font_bold">73.46</span></td>
</tr>
<tr id="S6.T6.4.2.6.4" class="ltx_tr">
<th id="S6.T6.4.2.6.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="S6.T6.4.2.6.4.1.1" class="ltx_text ltx_font_smallcaps">FedDF</span></th>
<td id="S6.T6.4.2.6.4.2" class="ltx_td ltx_align_center">76.20</td>
<td id="S6.T6.4.2.6.4.3" class="ltx_td ltx_align_center">74.04</td>
<td id="S6.T6.4.2.6.4.4" class="ltx_td ltx_align_center">73.31</td>
<td id="S6.T6.4.2.6.4.5" class="ltx_td ltx_align_center">74.39</td>
<td id="S6.T6.4.2.6.4.6" class="ltx_td ltx_align_center">73.99</td>
<td id="S6.T6.4.2.6.4.7" class="ltx_td ltx_nopad_r ltx_align_center">73.14</td>
</tr>
<tr id="S6.T6.4.2.7.5" class="ltx_tr">
<th id="S6.T6.4.2.7.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t"><span id="S6.T6.4.2.7.5.1.1" class="ltx_text ltx_font_smallcaps">FedLAW</span></th>
<td id="S6.T6.4.2.7.5.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S6.T6.4.2.7.5.2.1" class="ltx_text ltx_font_bold">79.40</span></td>
<td id="S6.T6.4.2.7.5.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S6.T6.4.2.7.5.3.1" class="ltx_text ltx_font_bold">77.14</span></td>
<td id="S6.T6.4.2.7.5.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S6.T6.4.2.7.5.4.1" class="ltx_text ltx_font_bold">78.56</span></td>
<td id="S6.T6.4.2.7.5.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S6.T6.4.2.7.5.5.1" class="ltx_text ltx_font_bold">76.70</span></td>
<td id="S6.T6.4.2.7.5.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S6.T6.4.2.7.5.6.1" class="ltx_text ltx_font_bold">76.78</span></td>
<td id="S6.T6.4.2.7.5.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_t">70.42</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S6.T8" class="ltx_table">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S6.T8.4" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:195.1pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Table 7: </span><span id="S6.T8.2.2.1" class="ltx_text" style="font-size:90%;">The performance on the distribution shift setting where the clients’ data are long-tailed (<math id="S6.T8.2.2.1.m1.1" class="ltx_Math" alttext="\rho=5" display="inline"><semantics id="S6.T8.2.2.1.m1.1b"><mrow id="S6.T8.2.2.1.m1.1.1" xref="S6.T8.2.2.1.m1.1.1.cmml"><mi id="S6.T8.2.2.1.m1.1.1.2" xref="S6.T8.2.2.1.m1.1.1.2.cmml">ρ</mi><mo id="S6.T8.2.2.1.m1.1.1.1" xref="S6.T8.2.2.1.m1.1.1.1.cmml">=</mo><mn id="S6.T8.2.2.1.m1.1.1.3" xref="S6.T8.2.2.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T8.2.2.1.m1.1c"><apply id="S6.T8.2.2.1.m1.1.1.cmml" xref="S6.T8.2.2.1.m1.1.1"><eq id="S6.T8.2.2.1.m1.1.1.1.cmml" xref="S6.T8.2.2.1.m1.1.1.1"></eq><ci id="S6.T8.2.2.1.m1.1.1.2.cmml" xref="S6.T8.2.2.1.m1.1.1.2">𝜌</ci><cn type="integer" id="S6.T8.2.2.1.m1.1.1.3.cmml" xref="S6.T8.2.2.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T8.2.2.1.m1.1d">\rho=5</annotation></semantics></math>) and the proxy data are balanced.</span></figcaption>
<div id="S6.T8.4.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:152.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(114.2pt,-40.0pt) scale(2.11218944812059,2.11218944812059) ;">
<table id="S6.T8.4.4.2" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S6.T8.4.4.2.2" class="ltx_tr">
<th id="S6.T8.4.4.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt">Method</th>
<th id="S6.T8.3.3.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">IID (<math id="S6.T8.3.3.1.1.1.m1.1" class="ltx_Math" alttext="\alpha=100" display="inline"><semantics id="S6.T8.3.3.1.1.1.m1.1a"><mrow id="S6.T8.3.3.1.1.1.m1.1.1" xref="S6.T8.3.3.1.1.1.m1.1.1.cmml"><mi id="S6.T8.3.3.1.1.1.m1.1.1.2" xref="S6.T8.3.3.1.1.1.m1.1.1.2.cmml">α</mi><mo id="S6.T8.3.3.1.1.1.m1.1.1.1" xref="S6.T8.3.3.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S6.T8.3.3.1.1.1.m1.1.1.3" xref="S6.T8.3.3.1.1.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T8.3.3.1.1.1.m1.1b"><apply id="S6.T8.3.3.1.1.1.m1.1.1.cmml" xref="S6.T8.3.3.1.1.1.m1.1.1"><eq id="S6.T8.3.3.1.1.1.m1.1.1.1.cmml" xref="S6.T8.3.3.1.1.1.m1.1.1.1"></eq><ci id="S6.T8.3.3.1.1.1.m1.1.1.2.cmml" xref="S6.T8.3.3.1.1.1.m1.1.1.2">𝛼</ci><cn type="integer" id="S6.T8.3.3.1.1.1.m1.1.1.3.cmml" xref="S6.T8.3.3.1.1.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T8.3.3.1.1.1.m1.1c">\alpha=100</annotation></semantics></math>)</th>
<th id="S6.T8.4.4.2.2.2" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt">NonIID (<math id="S6.T8.4.4.2.2.2.m1.1" class="ltx_Math" alttext="\alpha=1" display="inline"><semantics id="S6.T8.4.4.2.2.2.m1.1a"><mrow id="S6.T8.4.4.2.2.2.m1.1.1" xref="S6.T8.4.4.2.2.2.m1.1.1.cmml"><mi id="S6.T8.4.4.2.2.2.m1.1.1.2" xref="S6.T8.4.4.2.2.2.m1.1.1.2.cmml">α</mi><mo id="S6.T8.4.4.2.2.2.m1.1.1.1" xref="S6.T8.4.4.2.2.2.m1.1.1.1.cmml">=</mo><mn id="S6.T8.4.4.2.2.2.m1.1.1.3" xref="S6.T8.4.4.2.2.2.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T8.4.4.2.2.2.m1.1b"><apply id="S6.T8.4.4.2.2.2.m1.1.1.cmml" xref="S6.T8.4.4.2.2.2.m1.1.1"><eq id="S6.T8.4.4.2.2.2.m1.1.1.1.cmml" xref="S6.T8.4.4.2.2.2.m1.1.1.1"></eq><ci id="S6.T8.4.4.2.2.2.m1.1.1.2.cmml" xref="S6.T8.4.4.2.2.2.m1.1.1.2">𝛼</ci><cn type="integer" id="S6.T8.4.4.2.2.2.m1.1.1.3.cmml" xref="S6.T8.4.4.2.2.2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T8.4.4.2.2.2.m1.1c">\alpha=1</annotation></semantics></math>)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S6.T8.4.4.2.3.1" class="ltx_tr">
<th id="S6.T8.4.4.2.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S6.T8.4.4.2.3.1.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span></th>
<td id="S6.T8.4.4.2.3.1.2" class="ltx_td ltx_align_center ltx_border_t">61.12</td>
<td id="S6.T8.4.4.2.3.1.3" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">59.82</td>
</tr>
<tr id="S6.T8.4.4.2.4.2" class="ltx_tr">
<th id="S6.T8.4.4.2.4.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="S6.T8.4.4.2.4.2.1.1" class="ltx_text ltx_font_smallcaps">FedDF</span></th>
<td id="S6.T8.4.4.2.4.2.2" class="ltx_td ltx_align_center">39.03</td>
<td id="S6.T8.4.4.2.4.2.3" class="ltx_td ltx_nopad_r ltx_align_center">40.68</td>
</tr>
<tr id="S6.T8.4.4.2.5.3" class="ltx_tr">
<th id="S6.T8.4.4.2.5.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t"><span id="S6.T8.4.4.2.5.3.1.1" class="ltx_text ltx_font_smallcaps">FedLAW</span></th>
<td id="S6.T8.4.4.2.5.3.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S6.T8.4.4.2.5.3.2.1" class="ltx_text ltx_font_bold">67.61</span></td>
<td id="S6.T8.4.4.2.5.3.3" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_t"><span id="S6.T8.4.4.2.5.3.3.1" class="ltx_text ltx_font_bold">66.48</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S6.T8.6" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:216.8pt;">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Table 8: </span><span id="S6.T8.6.2.1" class="ltx_text" style="font-size:90%;">The performance on different percentages of corrupted clients (IID, <math id="S6.T8.6.2.1.m1.1" class="ltx_Math" alttext="E=3" display="inline"><semantics id="S6.T8.6.2.1.m1.1b"><mrow id="S6.T8.6.2.1.m1.1.1" xref="S6.T8.6.2.1.m1.1.1.cmml"><mi id="S6.T8.6.2.1.m1.1.1.2" xref="S6.T8.6.2.1.m1.1.1.2.cmml">E</mi><mo id="S6.T8.6.2.1.m1.1.1.1" xref="S6.T8.6.2.1.m1.1.1.1.cmml">=</mo><mn id="S6.T8.6.2.1.m1.1.1.3" xref="S6.T8.6.2.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T8.6.2.1.m1.1c"><apply id="S6.T8.6.2.1.m1.1.1.cmml" xref="S6.T8.6.2.1.m1.1.1"><eq id="S6.T8.6.2.1.m1.1.1.1.cmml" xref="S6.T8.6.2.1.m1.1.1.1"></eq><ci id="S6.T8.6.2.1.m1.1.1.2.cmml" xref="S6.T8.6.2.1.m1.1.1.2">𝐸</ci><cn type="integer" id="S6.T8.6.2.1.m1.1.1.3.cmml" xref="S6.T8.6.2.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T8.6.2.1.m1.1d">E=3</annotation></semantics></math>).</span></figcaption>
<div id="S6.T8.6.3" class="ltx_inline-block ltx_transformed_outer" style="width:433.6pt;height:242.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(120.3pt,-67.3pt) scale(2.24576220622667,2.24576220622667) ;">
<table id="S6.T8.6.3.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S6.T8.6.3.1.1.1" class="ltx_tr">
<th id="S6.T8.6.3.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt">Corrupt percent.</th>
<td id="S6.T8.6.3.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">25%</td>
<td id="S6.T8.6.3.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">50%</td>
<td id="S6.T8.6.3.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">75%</td>
</tr>
<tr id="S6.T8.6.3.1.2.2" class="ltx_tr">
<th id="S6.T8.6.3.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S6.T8.6.3.1.2.2.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span></th>
<td id="S6.T8.6.3.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t">63.40</td>
<td id="S6.T8.6.3.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t">61.14</td>
<td id="S6.T8.6.3.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t">58.21</td>
</tr>
<tr id="S6.T8.6.3.1.3.3" class="ltx_tr">
<th id="S6.T8.6.3.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S6.T8.6.3.1.3.3.1.1" class="ltx_text ltx_font_smallcaps">FedDF</span></th>
<td id="S6.T8.6.3.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t">68.73</td>
<td id="S6.T8.6.3.1.3.3.3" class="ltx_td ltx_align_center ltx_border_t">66.94</td>
<td id="S6.T8.6.3.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t">66.07</td>
</tr>
<tr id="S6.T8.6.3.1.4.4" class="ltx_tr">
<th id="S6.T8.6.3.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S6.T8.6.3.1.4.4.1.1" class="ltx_text ltx_font_smallcaps">Server-FT</span></th>
<td id="S6.T8.6.3.1.4.4.2" class="ltx_td ltx_align_center">63.61</td>
<td id="S6.T8.6.3.1.4.4.3" class="ltx_td ltx_align_center">61.24</td>
<td id="S6.T8.6.3.1.4.4.4" class="ltx_td ltx_align_center">58.36</td>
</tr>
<tr id="S6.T8.6.3.1.5.5" class="ltx_tr">
<th id="S6.T8.6.3.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S6.T8.6.3.1.5.5.1.1" class="ltx_text ltx_font_smallcaps">FedLAW</span></th>
<td id="S6.T8.6.3.1.5.5.2" class="ltx_td ltx_align_center ltx_border_t">67.87</td>
<td id="S6.T8.6.3.1.5.5.3" class="ltx_td ltx_align_center ltx_border_t">66.67</td>
<td id="S6.T8.6.3.1.5.5.4" class="ltx_td ltx_align_center ltx_border_t">63.91</td>
</tr>
<tr id="S6.T8.6.3.1.6.6" class="ltx_tr">
<th id="S6.T8.6.3.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r"><span id="S6.T8.6.3.1.6.6.1.1" class="ltx_text ltx_font_smallcaps">FedLAW(SWA)</span></th>
<td id="S6.T8.6.3.1.6.6.2" class="ltx_td ltx_align_center ltx_border_bb">68.04</td>
<td id="S6.T8.6.3.1.6.6.3" class="ltx_td ltx_align_center ltx_border_bb">66.95</td>
<td id="S6.T8.6.3.1.6.6.4" class="ltx_td ltx_align_center ltx_border_bb">65.51</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</div>
</div>
</figure>
</section>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">In this paper, we revisit and rethink the weighted aggregation in federated learning with neural networks and gain new insights into the training dynamics. First, we break the convention that the <math id="S7.p1.1.m1.1" class="ltx_Math" alttext="l_{1}" display="inline"><semantics id="S7.p1.1.m1.1a"><msub id="S7.p1.1.m1.1.1" xref="S7.p1.1.m1.1.1.cmml"><mi id="S7.p1.1.m1.1.1.2" xref="S7.p1.1.m1.1.1.2.cmml">l</mi><mn id="S7.p1.1.m1.1.1.3" xref="S7.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S7.p1.1.m1.1b"><apply id="S7.p1.1.m1.1.1.cmml" xref="S7.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S7.p1.1.m1.1.1.1.cmml" xref="S7.p1.1.m1.1.1">subscript</csymbol><ci id="S7.p1.1.m1.1.1.2.cmml" xref="S7.p1.1.m1.1.1.2">𝑙</ci><cn type="integer" id="S7.p1.1.m1.1.1.3.cmml" xref="S7.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.1.m1.1c">l_{1}</annotation></semantics></math> norm of aggregation weights should be normalized as 1 and identify the <span id="S7.p1.1.1" class="ltx_text ltx_font_italic">global weight shrinking</span> phenomenon and its dynamics when the norm is smaller than 1.
Second, we discover two aspects of <span id="S7.p1.1.2" class="ltx_text ltx_font_italic">client coherence</span>, local gradient coherence and heterogeneity coherence, and study the dynamics during training.
Based on the findings, we devise a simple but effective method <span id="S7.p1.1.3" class="ltx_text ltx_font_smallcaps">FedLAW</span>.
Extensive experiments verify that our method can improve the generalization of the global model by a large margin on different datasets and models.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">This work was supported by the National Key Research and Development Project of China (Grant No.2021ZD0110505), the National Natural Science Foundation of China (Grant No.U19B2042), the Zhejiang Provincial Key Research and Development Project (Grant No.2022C01044), the University Synergy Innovation Program of Anhui Province (Grant No.GXXT-2021-004), the Academy Of Social Governance Zhejiang University, and the Fundamental Research Funds for the Central Universities (Grant No.226-2022-00064). This work was also supported in part by the Research Center for Industries of the Future (RCIF) at Westlake University, and Westlake Education Foundation.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Acar et al. (2020)</span>
<span class="ltx_bibblock">
Acar, D. A. E., Zhao, Y., Matas, R., Mattina, M., Whatmough, P., and Saligrama,
V.

</span>
<span class="ltx_bibblock">Federated learning based on dynamic regularization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2020.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Allen-Zhu et al. (2019)</span>
<span class="ltx_bibblock">
Allen-Zhu, Z., Li, Y., and Song, Z.

</span>
<span class="ltx_bibblock">A convergence theory for deep learning via over-parameterization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 242–252. PMLR, 2019.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Caldarola et al. (2022)</span>
<span class="ltx_bibblock">
Caldarola, D., Caputo, B., and Ciccone, M.

</span>
<span class="ltx_bibblock">Improving generalization in federated learning by seeking flat
minima.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Computer Vision–ECCV 2022: 17th European Conference, Tel
Aviv, Israel, October 23–27, 2022, Proceedings, Part XXIII</em>, pp.  654–672.
Springer, 2022.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Charles et al. (2021)</span>
<span class="ltx_bibblock">
Charles, Z., Garrett, Z., Huo, Z., Shmulyian, S., and Smith, V.

</span>
<span class="ltx_bibblock">On large-cohort training for federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>,
34:20461–20475, 2021.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chatterjee (2019)</span>
<span class="ltx_bibblock">
Chatterjee, S.

</span>
<span class="ltx_bibblock">Coherent gradients: An approach to understanding generalization in
gradient descent-based optimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2019.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chatterjee &amp; Zielinski (2020)</span>
<span class="ltx_bibblock">
Chatterjee, S. and Zielinski, P.

</span>
<span class="ltx_bibblock">Making coherence out of nothing at all: measuring the evolution of
gradient alignment.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2008.01217</em>, 2020.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen &amp; Chao (2021)</span>
<span class="ltx_bibblock">
Chen, H. and Chao, W.

</span>
<span class="ltx_bibblock">Fedbe: Making bayesian model ensemble applicable to federated
learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">9th International Conference on Learning Representations,
ICLR 2021, Virtual Event, Austria, May 3-7, 2021</em>. OpenReview.net, 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=dgtpE6gKjHn" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=dgtpE6gKjHn</a>.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al. (2020)</span>
<span class="ltx_bibblock">
Deng, Y., Kamani, M. M., and Mahdavi, M.

</span>
<span class="ltx_bibblock">Distributionally robust federated averaging.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>,
33:15111–15122, 2020.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dinh et al. (2017)</span>
<span class="ltx_bibblock">
Dinh, L., Pascanu, R., Bengio, S., and Bengio, Y.

</span>
<span class="ltx_bibblock">Sharp minima can generalize for deep nets.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 1019–1028. PMLR, 2017.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Draxler et al. (2018)</span>
<span class="ltx_bibblock">
Draxler, F., Veschgini, K., Salmhofer, M., and Hamprecht, F.

</span>
<span class="ltx_bibblock">Essentially no barriers in neural network energy landscape.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>, pp. 1309–1318. PMLR, 2018.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Du et al. (2021)</span>
<span class="ltx_bibblock">
Du, J., Yan, H., Feng, J., Zhou, J. T., Zhen, L., Goh, R. S. M., and Tan, V. Y.

</span>
<span class="ltx_bibblock">Efficient sharpness-aware minimization for improved training of
neural networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2110.03141</em>, 2021.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Entezari et al. (2022)</span>
<span class="ltx_bibblock">
Entezari, R., Sedghi, H., Saukh, O., and Neyshabur, B.

</span>
<span class="ltx_bibblock">The role of permutation invariance in linear mode connectivity of
neural networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2022.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Foret et al. (2020)</span>
<span class="ltx_bibblock">
Foret, P., Kleiner, A., Mobahi, H., and Neyshabur, B.

</span>
<span class="ltx_bibblock">Sharpness-aware minimization for efficiently improving
generalization.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2010.01412</em>, 2020.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fort &amp; Jastrzebski (2019)</span>
<span class="ltx_bibblock">
Fort, S. and Jastrzebski, S.

</span>
<span class="ltx_bibblock">Large scale structure of neural network loss landscapes.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 32, 2019.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fort et al. (2019)</span>
<span class="ltx_bibblock">
Fort, S., Nowak, P. K., Jastrzebski, S., and Narayanan, S.

</span>
<span class="ltx_bibblock">Stiffness: A new perspective on generalization in neural networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1901.09491</em>, 2019.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Franceschi et al. (2017)</span>
<span class="ltx_bibblock">
Franceschi, L., Donini, M., Frasconi, P., and Pontil, M.

</span>
<span class="ltx_bibblock">Forward and reverse gradient-based hyperparameter optimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 1165–1173. PMLR, 2017.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Garipov et al. (2018)</span>
<span class="ltx_bibblock">
Garipov, T., Izmailov, P., Podoprikhin, D., Vetrov, D. P., and Wilson, A. G.

</span>
<span class="ltx_bibblock">Loss surfaces, mode connectivity, and fast ensembling of dnns.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 31, 2018.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2022)</span>
<span class="ltx_bibblock">
Guo, P., Yang, D., Hatamizadeh, A., Xu, A., Xu, Z., Li, W., Zhao, C., Xu, D.,
Harmon, S., Turkbey, E., et al.

</span>
<span class="ltx_bibblock">Auto-fedrl: Federated hyperparameter optimization for
multi-institutional medical image segmentation.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2203.06338</em>, 2022.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2017)</span>
<span class="ltx_bibblock">
Huang, G., Liu, Z., Van Der Maaten, L., and Weinberger, K. Q.

</span>
<span class="ltx_bibblock">Densely connected convolutional networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</em>, pp.  4700–4708, 2017.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2021)</span>
<span class="ltx_bibblock">
Huang, Y., Chu, L., Zhou, Z., Wang, L., Liu, J., Pei, J., and Zhang, Y.

</span>
<span class="ltx_bibblock">Personalized cross-silo federated learning on non-iid data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</em>, volume 35, pp.  7865–7873, 2021.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Izmailov et al. (2018)</span>
<span class="ltx_bibblock">
Izmailov, P., Wilson, A., Podoprikhin, D., Vetrov, D., and Garipov, T.

</span>
<span class="ltx_bibblock">Averaging weights leads to wider optima and better generalization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">34th Conference on Uncertainty in Artificial Intelligence
2018, UAI 2018</em>, pp.  876–885, 2018.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jastrzębski et al. (2018)</span>
<span class="ltx_bibblock">
Jastrzębski, S., Kenton, Z., Ballas, N., Fischer, A., Bengio, Y., and
Storkey, A.

</span>
<span class="ltx_bibblock">On the relation between the sharpest directions of dnn loss and the
sgd step length.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1807.05031</em>, 2018.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jastrzebski et al. (2019)</span>
<span class="ltx_bibblock">
Jastrzebski, S., Szymczak, M., Fort, S., Arpit, D., Tabor, J., Cho, K., and
Geras, K.

</span>
<span class="ltx_bibblock">The break-even point on optimization trajectories of deep neural
networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2019.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jastrzebski et al. (2020)</span>
<span class="ltx_bibblock">
Jastrzebski, S., Szymczak, M., Fort, S., Arpit, D., Tabor, J., Cho, K., and
Geras, K.

</span>
<span class="ltx_bibblock">The break-even point on optimization trajectories of deep neural
networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.09572</em>, 2020.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jomaa et al. (2019)</span>
<span class="ltx_bibblock">
Jomaa, H. S., Grabocka, J., and Schmidt-Thieme, L.

</span>
<span class="ltx_bibblock">Hyp-rl: Hyperparameter optimization by reinforcement learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1906.11527</em>, 2019.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kantorovich (2006)</span>
<span class="ltx_bibblock">
Kantorovich, L. V.

</span>
<span class="ltx_bibblock">On the translocation of masses.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Journal of mathematical sciences</em>, 133(4):1381–1382, 2006.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy et al. (2020)</span>
<span class="ltx_bibblock">
Karimireddy, S. P., Kale, S., Mohri, M., Reddi, S., Stich, S., and Suresh,
A. T.

</span>
<span class="ltx_bibblock">Scaffold: Stochastic controlled averaging for federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 5132–5143. PMLR, 2020.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Keskar et al. (2017)</span>
<span class="ltx_bibblock">
Keskar, N. S., Nocedal, J., Tang, P. T. P., Mudigere, D., and Smelyanskiy, M.

</span>
<span class="ltx_bibblock">On large-batch training for deep learning: Generalization gap and
sharp minima.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">5th International Conference on Learning Representations,
ICLR 2017</em>, 2017.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kwon et al. (2021)</span>
<span class="ltx_bibblock">
Kwon, J., Kim, J., Park, H., and Choi, I. K.

</span>
<span class="ltx_bibblock">Asam: Adaptive sharpness-aware minimization for scale-invariant
learning of deep neural networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 5905–5914. PMLR, 2021.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewkowycz &amp; Gur-Ari (2020)</span>
<span class="ltx_bibblock">
Lewkowycz, A. and Gur-Ari, G.

</span>
<span class="ltx_bibblock">On the training dynamics of deep networks with <math id="bib.bib30.1.m1.1" class="ltx_Math" alttext="l\_2" display="inline"><semantics id="bib.bib30.1.m1.1a"><mrow id="bib.bib30.1.m1.1.1" xref="bib.bib30.1.m1.1.1.cmml"><mi id="bib.bib30.1.m1.1.1.2" xref="bib.bib30.1.m1.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="bib.bib30.1.m1.1.1.1" xref="bib.bib30.1.m1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="bib.bib30.1.m1.1.1.3" xref="bib.bib30.1.m1.1.1.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="bib.bib30.1.m1.1.1.1a" xref="bib.bib30.1.m1.1.1.1.cmml">​</mo><mn id="bib.bib30.1.m1.1.1.4" xref="bib.bib30.1.m1.1.1.4.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="bib.bib30.1.m1.1b"><apply id="bib.bib30.1.m1.1.1.cmml" xref="bib.bib30.1.m1.1.1"><times id="bib.bib30.1.m1.1.1.1.cmml" xref="bib.bib30.1.m1.1.1.1"></times><ci id="bib.bib30.1.m1.1.1.2.cmml" xref="bib.bib30.1.m1.1.1.2">𝑙</ci><ci id="bib.bib30.1.m1.1.1.3.cmml" xref="bib.bib30.1.m1.1.1.3">_</ci><cn type="integer" id="bib.bib30.1.m1.1.1.4.cmml" xref="bib.bib30.1.m1.1.1.4">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib30.1.m1.1c">l\_2</annotation></semantics></math>
regularization.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.2.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
33:4790–4799, 2020.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2018)</span>
<span class="ltx_bibblock">
Li, H., Xu, Z., Taylor, G., Studer, C., and Goldstein, T.

</span>
<span class="ltx_bibblock">Visualizing the loss landscape of neural nets.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 31, 2018.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2022a)</span>
<span class="ltx_bibblock">
Li, S., Zhou, T., Tian, X., and Tao, D.

</span>
<span class="ltx_bibblock">Learning to collaborate in decentralized learning of personalized
models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, pp.  9766–9775, 2022a.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020a)</span>
<span class="ltx_bibblock">
Li, T., Sahu, A. K., Talwalkar, A., and Smith, V.

</span>
<span class="ltx_bibblock">Federated learning: Challenges, methods, and future directions.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">IEEE Signal Process. Mag.</em>, 37(3):50–60,
2020a.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/MSP.2020.2975749</span>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1109/MSP.2020.2975749" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1109/MSP.2020.2975749</a>.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020b)</span>
<span class="ltx_bibblock">
Li, T., Sahu, A. K., Zaheer, M., Sanjabi, M., Talwalkar, A., and Smith, V.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning and Systems</em>, 2:429–450, 2020b.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020c)</span>
<span class="ltx_bibblock">
Li, X., Chen, S., and Yang, J.

</span>
<span class="ltx_bibblock">Understanding the disharmony between weight normalization family and
weight decay.

</span>
<span class="ltx_bibblock">In <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</em>, volume 34, pp.  4715–4722, 2020c.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2022b)</span>
<span class="ltx_bibblock">
Li, Z., Lu, J., Luo, S., Zhu, D., Shao, Y., Li, Y., Zhang, Z., Wang, Y., and
Wu, C.

</span>
<span class="ltx_bibblock">Towards effective clustered federated learning: A peer-to-peer
framework with adaptive neighbor matching.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Big Data</em>, 2022b.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2022c)</span>
<span class="ltx_bibblock">
Li, Z., Lu, J., Luo, S., Zhu, D., Shao, Y., Li, Y., Zhang, Z., and Wu, C.

</span>
<span class="ltx_bibblock">Mining latent relationships among clients: Peer-to-peer federated
learning with adaptive neighbor matching.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2203.12285</em>, 2022c.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2020)</span>
<span class="ltx_bibblock">
Lin, T., Kong, L., Stich, S. U., and Jaggi, M.

</span>
<span class="ltx_bibblock">Ensemble distillation for robust model fusion in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
33:2351–2363, 2020.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Loshchilov &amp; Hutter (2018)</span>
<span class="ltx_bibblock">
Loshchilov, I. and Hutter, F.

</span>
<span class="ltx_bibblock">Decoupled weight decay regularization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2018.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lyu et al. (2022)</span>
<span class="ltx_bibblock">
Lyu, K., Li, Z., and Arora, S.

</span>
<span class="ltx_bibblock">Understanding the generalization benefit of normalization layers:
Sharpness reduction.

</span>
<span class="ltx_bibblock"><em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2206.07085</em>, 2022.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Maclaurin et al. (2015)</span>
<span class="ltx_bibblock">
Maclaurin, D., Duvenaud, D., and Adams, R.

</span>
<span class="ltx_bibblock">Gradient-based hyperparameter optimization through reversible
learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>, pp. 2113–2122. PMLR, 2015.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
McMahan, B., Moore, E., Ramage, D., Hampson, S., and y Arcas, B. A.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence and statistics</em>, pp.  1273–1282.
PMLR, 2017.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mostafa (2019)</span>
<span class="ltx_bibblock">
Mostafa, H.

</span>
<span class="ltx_bibblock">Robust federated learning through representation matching and
adaptive hyper-parameters.

</span>
<span class="ltx_bibblock"><em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1912.13075</em>, 2019.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Singh &amp; Jaggi (2020)</span>
<span class="ltx_bibblock">
Singh, S. P. and Jaggi, M.

</span>
<span class="ltx_bibblock">Model fusion via optimal transport.

</span>
<span class="ltx_bibblock"><em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
33:22045–22055, 2020.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vlaar &amp; Frankle (2021)</span>
<span class="ltx_bibblock">
Vlaar, T. and Frankle, J.

</span>
<span class="ltx_bibblock">What can linear interpolation of neural network loss landscapes tell
us?

</span>
<span class="ltx_bibblock"><em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2106.16004</em>, 2021.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wan et al. (2021)</span>
<span class="ltx_bibblock">
Wan, R., Zhu, Z., Zhang, X., and Sun, J.

</span>
<span class="ltx_bibblock">Spherical motion dynamics: Learning dynamics of normalized neural
network using sgd and weight decay.

</span>
<span class="ltx_bibblock"><em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
34:6380–6391, 2021.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2020a)</span>
<span class="ltx_bibblock">
Wang, H., Yurochkin, M., Sun, Y., Papailiopoulos, D., and Khazaeni, Y.

</span>
<span class="ltx_bibblock">Federated learning with matched averaging.

</span>
<span class="ltx_bibblock"><em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.06440</em>, 2020a.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2020b)</span>
<span class="ltx_bibblock">
Wang, J., Liu, Q., Liang, H., Joshi, G., and Poor, H. V.

</span>
<span class="ltx_bibblock">Tackling the objective inconsistency problem in heterogeneous
federated optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>,
33:7611–7623, 2020b.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2021)</span>
<span class="ltx_bibblock">
Wang, J., Charles, Z., Xu, Z., Joshi, G., McMahan, H. B., Al-Shedivat, M.,
Andrew, G., Avestimehr, S., Daly, K., Data, D., et al.

</span>
<span class="ltx_bibblock">A field guide to federated optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2107.06917</em>, 2021.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2022)</span>
<span class="ltx_bibblock">
Wu, B., Liang, Z., Han, Y., Bian, Y., Zhao, P., and Huang, J.

</span>
<span class="ltx_bibblock">Drflm: Distributionally robust federated learning with inter-client
noise via local mixup.

</span>
<span class="ltx_bibblock"><em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2204.07742</em>, 2022.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xia et al. (2021)</span>
<span class="ltx_bibblock">
Xia, Y., Yang, D., Li, W., Myronenko, A., Xu, D., Obinata, H., Mori, H., An,
P., Harmon, S., Turkbey, E., et al.

</span>
<span class="ltx_bibblock">Auto-fedavg: learnable federated averaging for multi-institutional
medical image segmentation.

</span>
<span class="ltx_bibblock"><em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2104.10195</em>, 2021.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al. (2020)</span>
<span class="ltx_bibblock">
Xie, Z., Sato, I., and Sugiyama, M.

</span>
<span class="ltx_bibblock">Understanding and scheduling weight decay.

</span>
<span class="ltx_bibblock"><em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2011.11152</em>, 2020.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yan et al. (2021)</span>
<span class="ltx_bibblock">
Yan, G., Wang, H., and Li, J.

</span>
<span class="ltx_bibblock">Critical learning periods in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2109.05613</em>, 2021.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et al. (2020)</span>
<span class="ltx_bibblock">
Yao, Z., Gholami, A., Keutzer, K., and Mahoney, M. W.

</span>
<span class="ltx_bibblock">Pyhessian: Neural networks through the lens of the hessian.

</span>
<span class="ltx_bibblock">In <em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">2020 IEEE international conference on big data (Big data)</em>,
pp.  581–590. IEEE, 2020.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yin et al. (2018)</span>
<span class="ltx_bibblock">
Yin, D., Pananjady, A., Lam, M., Papailiopoulos, D., Ramchandran, K., and
Bartlett, P.

</span>
<span class="ltx_bibblock">Gradient diversity: a key ingredient for scalable distributed
learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">International Conference on Artificial Intelligence and
Statistics</em>, pp.  1998–2007. PMLR, 2018.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2018)</span>
<span class="ltx_bibblock">
Zhang, G., Wang, C., Xu, B., and Grosse, R.

</span>
<span class="ltx_bibblock">Three mechanisms of weight decay regularization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2018.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zielinski et al. (2020)</span>
<span class="ltx_bibblock">
Zielinski, P., Krishnan, S., and Chatterjee, S.

</span>
<span class="ltx_bibblock">Weak and strong gradient directions: Explaining memorization,
generalization, and hardness of examples at scale.

</span>
<span class="ltx_bibblock"><em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2003.07422</em>, 2020.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zou &amp; Gu (2019)</span>
<span class="ltx_bibblock">
Zou, D. and Gu, Q.

</span>
<span class="ltx_bibblock">An improved analysis of training over-parameterized deep neural
networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib58.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 32, 2019.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<div id="p3" class="ltx_para">
<p id="p3.1" class="ltx_p ltx_align_center"><span id="p3.1.1" class="ltx_text ltx_font_bold" style="font-size:144%;">Appendix<span id="p3.1.1.1" class="ltx_text ltx_font_medium"></span></span></p>
</div>
<div id="p4" class="ltx_para">
<p id="p4.1" class="ltx_p">In this appendix, we provide details omitted in the main paper and more experimental results and analyses.</p>
<ul id="A0.I1" class="ltx_itemize">
<li id="A0.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A0.I1.i1.p1" class="ltx_para">
<p id="A0.I1.i1.p1.1" class="ltx_p"><a href="#A1" title="Appendix A More Related Works ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Appendix A</span></a>: more related works (cf. <a href="#S2" title="2 Related Works ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 2</span></a> of the main paper).</p>
</div>
</li>
<li id="A0.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A0.I1.i2.p1" class="ltx_para">
<p id="A0.I1.i2.p1.1" class="ltx_p"><a href="#A2" title="Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Appendix B</span></a>: more experimental results and analyses (cf. <a href="#S4" title="4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 4</span></a>, <a href="#S5" title="5 Client coherence ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 5</span></a> and <a href="#S6" title="6 FedLAW ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 6</span></a> of the main paper).</p>
</div>
</li>
<li id="A0.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A0.I1.i3.p1" class="ltx_para">
<p id="A0.I1.i3.p1.1" class="ltx_p"><a href="#A3" title="Appendix C Additional Details of FedLAW ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Appendix C</span></a>: additional details of <span id="A0.I1.i3.p1.1.1" class="ltx_text ltx_font_smallcaps">FedLAW</span> (cf. <a href="#S6" title="6 FedLAW ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 6</span></a> of the main paper).</p>
</div>
</li>
<li id="A0.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A0.I1.i4.p1" class="ltx_para">
<p id="A0.I1.i4.p1.1" class="ltx_p"><a href="#A4" title="Appendix D Implementation Details ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Appendix D</span></a>: details of experimental setups (cf. <a href="#S4" title="4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 4</span></a>, <a href="#S5" title="5 Client coherence ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 5</span></a> and <a href="#S6" title="6 FedLAW ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 6</span></a> of the main paper).</p>
</div>
</li>
</ul>
</div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>More Related Works</h2>

<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Model Aggregation in Federated Learning</h3>

<div id="A1.SS1.p1" class="ltx_para">
<p id="A1.SS1.p1.1" class="ltx_p"><span id="A1.SS1.p1.1.1" class="ltx_text ltx_font_bold">Model aggregation in federated learning.</span> Model aggregation weights should be calibrated under asynchronous local updates. <span id="A1.SS1.p1.1.2" class="ltx_text ltx_font_smallcaps">FedNova</span> <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib48" title="" class="ltx_ref">2020b</a>)</cite> is proposed to tackle the objective inconsistency problem caused by asynchronous updates; it theoretically shows that the convergence will be improved if the numbers of local iterations normalize the aggregation weights. However, it does not take the heterogeneity degree of clients into account, which is also a key factor that affects the generalization of the global model. In <cite class="ltx_cite ltx_citemacro_citep">(Chen &amp; Chao, <a href="#bib.bib7" title="" class="ltx_ref">2021</a>)</cite>, the authors point out that due to heterogeneity, the best-performing model will shift away from <span id="A1.SS1.p1.1.3" class="ltx_text ltx_font_smallcaps">FedAvg</span>, but they do not give insights on how to adjust aggregation weight to approximate the best model, they use Bayesian ensemble distillation method to prove the generalization of the global model instead. To solve the misalignment of neurons in FL with DNNs, <span id="A1.SS1.p1.1.4" class="ltx_text ltx_font_smallcaps">FedMA</span> <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib47" title="" class="ltx_ref">2020a</a>)</cite> is proposed: <span id="A1.SS1.p1.1.5" class="ltx_text ltx_font_smallcaps">FedMA</span> constructs the shared global model layer-wise by matching and averaging hidden elements with similar features extraction signatures. Besides, optimal transport <cite class="ltx_cite ltx_citemacro_citep">(Kantorovich, <a href="#bib.bib26" title="" class="ltx_ref">2006</a>)</cite> can be adopted in layer-wise neuron alignment in the process of model fusion <cite class="ltx_cite ltx_citemacro_citep">(Singh &amp; Jaggi, <a href="#bib.bib44" title="" class="ltx_ref">2020</a>)</cite>. These previous works improve the global model performance by layer-wise alignment, but they are complex and computation-expensive, and they can not be applied under the traditional weighted aggregation scheme. In this paper, we only focus on the convex combination of clients’ local models by weighted aggregation, which is the most common and general way of model aggregation.</p>
</div>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Generalization and Training Dynamics of Neural Networks</h3>

<div id="A1.SS2.p1" class="ltx_para">
<p id="A1.SS2.p1.1" class="ltx_p"><span id="A1.SS2.p1.1.1" class="ltx_text ltx_font_bold">Loss landscape of neural networks and generalization.</span> Deep neural networks (DNNs) are highly non-convex and over-parameterized, and visualizing the loss landscape of DNNs <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib31" title="" class="ltx_ref">2018</a>; Vlaar &amp; Frankle, <a href="#bib.bib45" title="" class="ltx_ref">2021</a>)</cite> helps understand the training process and the properties of minima. There are mainly two lines of works about the loss landscape of DNNs. The first one is the linear interpolation of neural network loss landscape <cite class="ltx_cite ltx_citemacro_citep">(Vlaar &amp; Frankle, <a href="#bib.bib45" title="" class="ltx_ref">2021</a>; Garipov et al., <a href="#bib.bib17" title="" class="ltx_ref">2018</a>; Draxler et al., <a href="#bib.bib10" title="" class="ltx_ref">2018</a>)</cite>, it plots linear slices of the landscape between two networks. In linear interpolation loss landscape, mode connectivity <cite class="ltx_cite ltx_citemacro_citep">(Draxler et al., <a href="#bib.bib10" title="" class="ltx_ref">2018</a>; Vlaar &amp; Frankle, <a href="#bib.bib45" title="" class="ltx_ref">2021</a>; Entezari et al., <a href="#bib.bib12" title="" class="ltx_ref">2022</a>)</cite> is referred to as the phenomenon that there might be increasing loss on the linear path between two minima found by SGD, and the loss increase on the path between two minima is referred to as (energy) barrier. It is also found that there may exist barriers between the initial model and the trained model <cite class="ltx_cite ltx_citemacro_citep">(Vlaar &amp; Frankle, <a href="#bib.bib45" title="" class="ltx_ref">2021</a>)</cite>. The second line concerns the loss landscape around a trained model’s parameters <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib31" title="" class="ltx_ref">2018</a>)</cite>. It is shown that the flatness of loss landscape curvature can reflect the generalization <cite class="ltx_cite ltx_citemacro_citep">(Foret et al., <a href="#bib.bib13" title="" class="ltx_ref">2020</a>; Izmailov et al., <a href="#bib.bib21" title="" class="ltx_ref">2018</a>)</cite> and top hessian eigenvalues can present flatness <cite class="ltx_cite ltx_citemacro_citep">(Yao et al., <a href="#bib.bib54" title="" class="ltx_ref">2020</a>; Jastrzębski et al., <a href="#bib.bib22" title="" class="ltx_ref">2018</a>)</cite>. Networks with small top hessian eigenvalues have flat curvature and generalize well. Previous works seek flatter minima for improving generalization by implicitly regularizing the hessian <cite class="ltx_cite ltx_citemacro_citep">(Foret et al., <a href="#bib.bib13" title="" class="ltx_ref">2020</a>; Kwon et al., <a href="#bib.bib29" title="" class="ltx_ref">2021</a>; Du et al., <a href="#bib.bib11" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="A1.SS2.p2" class="ltx_para">
<p id="A1.SS2.p2.1" class="ltx_p"><span id="A1.SS2.p2.1.1" class="ltx_text ltx_font_bold">Critical learning period in training neural networks.</span> <cite class="ltx_cite ltx_citemacro_citep">(Jastrzebski et al., <a href="#bib.bib23" title="" class="ltx_ref">2019</a>)</cite> found that the early phase of training of deep neural networks is critical for their final performance. They show that a break-even point exists on the learning trajectory, beyond which SGD implicitly regularizes the curvature of the loss surface and noise in the gradient. They also found that using a large learning rate in the initial phase of training reduces the variance of the gradient and improves generalization. In FL, <cite class="ltx_cite ltx_citemacro_citep">(Yan et al., <a href="#bib.bib53" title="" class="ltx_ref">2021</a>)</cite> discovers the early training period is also critical to federated learning. They reduce the quantity of training data in the first couple of rounds and then recover the training data, and it is found that no matter how much data are added in the late period, the models still cannot reach a better accuracy. However, it did not further study the role of client heterogeneity in the critical learning period while we examine it by local gradient coherence.</p>
</div>
</section>
<section id="A1.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Federated Hyperparameter Optimization</h3>

<div id="A1.SS3.p1" class="ltx_para">
<p id="A1.SS3.p1.1" class="ltx_p">Current federated learning methods struggle in cases with heterogeneous client-side data distributions which can quickly lead to divergent local models and a collapse in performance. Careful hyperparameter tuning is particularly important in these cases. Hyperparameters can be optimized using gradient descent to minimize the final validation loss <cite class="ltx_cite ltx_citemacro_citep">(Maclaurin et al., <a href="#bib.bib41" title="" class="ltx_ref">2015</a>; Franceschi et al., <a href="#bib.bib16" title="" class="ltx_ref">2017</a>)</cite>. Moreover, hyperparameters can be optimized based on reinforcement learning methods <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a href="#bib.bib18" title="" class="ltx_ref">2022</a>; Jomaa et al., <a href="#bib.bib25" title="" class="ltx_ref">2019</a>; Mostafa, <a href="#bib.bib43" title="" class="ltx_ref">2019</a>)</cite>. However, in this paper, optimizing aggregation weights is not our main novelty. Instead, we focus on leveraging this toolbox to examine the crucial training dynamics in FL in a principled way.</p>
</div>
</section>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>More Results and Analyses</h2>

<section id="A2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Global Weight Shrinking</h3>

<div id="A2.SS1.p1" class="ltx_para">
<p id="A2.SS1.p1.4" class="ltx_p"><span id="A2.SS1.p1.1.1" class="ltx_text ltx_font_bold">Fixed <math id="A2.SS1.p1.1.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A2.SS1.p1.1.1.m1.1a"><mi id="A2.SS1.p1.1.1.m1.1.1" xref="A2.SS1.p1.1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.1.1.m1.1b"><ci id="A2.SS1.p1.1.1.m1.1.1.cmml" xref="A2.SS1.p1.1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.1.1.m1.1c">\gamma</annotation></semantics></math>.</span> We add more results about global weight shrinking experiments with fixed <math id="A2.SS1.p1.2.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A2.SS1.p1.2.m1.1a"><mi id="A2.SS1.p1.2.m1.1.1" xref="A2.SS1.p1.2.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.2.m1.1b"><ci id="A2.SS1.p1.2.m1.1.1.cmml" xref="A2.SS1.p1.2.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.2.m1.1c">\gamma</annotation></semantics></math> as in <a href="#A2.T9" title="Table 9 ‣ B.1 Global Weight Shrinking ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 9</span></a>. It is found that when data are more NonIID, fixed <math id="A2.SS1.p1.3.m2.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A2.SS1.p1.3.m2.1a"><mi id="A2.SS1.p1.3.m2.1.1" xref="A2.SS1.p1.3.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.3.m2.1b"><ci id="A2.SS1.p1.3.m2.1.1.cmml" xref="A2.SS1.p1.3.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.3.m2.1c">\gamma</annotation></semantics></math> will cause negative effects; this is more dominant when <math id="A2.SS1.p1.4.m3.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="A2.SS1.p1.4.m3.1a"><mrow id="A2.SS1.p1.4.m3.1.1" xref="A2.SS1.p1.4.m3.1.1.cmml"><mi id="A2.SS1.p1.4.m3.1.1.2" xref="A2.SS1.p1.4.m3.1.1.2.cmml">α</mi><mo id="A2.SS1.p1.4.m3.1.1.1" xref="A2.SS1.p1.4.m3.1.1.1.cmml">=</mo><mn id="A2.SS1.p1.4.m3.1.1.3" xref="A2.SS1.p1.4.m3.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.4.m3.1b"><apply id="A2.SS1.p1.4.m3.1.1.cmml" xref="A2.SS1.p1.4.m3.1.1"><eq id="A2.SS1.p1.4.m3.1.1.1.cmml" xref="A2.SS1.p1.4.m3.1.1.1"></eq><ci id="A2.SS1.p1.4.m3.1.1.2.cmml" xref="A2.SS1.p1.4.m3.1.1.2">𝛼</ci><cn type="float" id="A2.SS1.p1.4.m3.1.1.3.cmml" xref="A2.SS1.p1.4.m3.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.4.m3.1c">\alpha=0.1</annotation></semantics></math> and the models are AlexNet or ResNet8.</p>
</div>
<figure id="A2.T9" class="ltx_table">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 9: </span>More results about fixed <math id="A2.T9.2.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A2.T9.2.m1.1b"><mi id="A2.T9.2.m1.1.1" xref="A2.T9.2.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A2.T9.2.m1.1c"><ci id="A2.T9.2.m1.1.1.cmml" xref="A2.T9.2.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T9.2.m1.1d">\gamma</annotation></semantics></math> across different architectures in various NonIID settings.</figcaption>
<table id="A2.T9.7" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A2.T9.3.1" class="ltx_tr">
<th id="A2.T9.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt"><math id="A2.T9.3.1.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A2.T9.3.1.1.m1.1a"><mi mathsize="90%" id="A2.T9.3.1.1.m1.1.1" xref="A2.T9.3.1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A2.T9.3.1.1.m1.1b"><ci id="A2.T9.3.1.1.m1.1.1.cmml" xref="A2.T9.3.1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T9.3.1.1.m1.1c">\gamma</annotation></semantics></math></th>
<td id="A2.T9.3.1.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="A2.T9.3.1.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">1.0</span></td>
<td id="A2.T9.3.1.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="A2.T9.3.1.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.99</span></td>
<td id="A2.T9.3.1.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="A2.T9.3.1.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.97</span></td>
<td id="A2.T9.3.1.5" class="ltx_td ltx_align_center ltx_border_tt"><span id="A2.T9.3.1.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.95</span></td>
<td id="A2.T9.3.1.6" class="ltx_td ltx_align_center ltx_border_tt"><span id="A2.T9.3.1.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.93</span></td>
<td id="A2.T9.3.1.7" class="ltx_td ltx_align_center ltx_border_tt"><span id="A2.T9.3.1.7.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.9</span></td>
</tr>
<tr id="A2.T9.4.2" class="ltx_tr">
<th id="A2.T9.4.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="A2.T9.4.2.2.1" class="ltx_text" style="font-size:90%;">Model</span></th>
<td id="A2.T9.4.2.1" class="ltx_td ltx_align_center ltx_border_t" colspan="6"><math id="A2.T9.4.2.1.m1.1" class="ltx_Math" alttext="\alpha=10" display="inline"><semantics id="A2.T9.4.2.1.m1.1a"><mrow id="A2.T9.4.2.1.m1.1.1" xref="A2.T9.4.2.1.m1.1.1.cmml"><mi mathsize="90%" id="A2.T9.4.2.1.m1.1.1.2" xref="A2.T9.4.2.1.m1.1.1.2.cmml">α</mi><mo mathsize="90%" id="A2.T9.4.2.1.m1.1.1.1" xref="A2.T9.4.2.1.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="A2.T9.4.2.1.m1.1.1.3" xref="A2.T9.4.2.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T9.4.2.1.m1.1b"><apply id="A2.T9.4.2.1.m1.1.1.cmml" xref="A2.T9.4.2.1.m1.1.1"><eq id="A2.T9.4.2.1.m1.1.1.1.cmml" xref="A2.T9.4.2.1.m1.1.1.1"></eq><ci id="A2.T9.4.2.1.m1.1.1.2.cmml" xref="A2.T9.4.2.1.m1.1.1.2">𝛼</ci><cn type="integer" id="A2.T9.4.2.1.m1.1.1.3.cmml" xref="A2.T9.4.2.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T9.4.2.1.m1.1c">\alpha=10</annotation></semantics></math></td>
</tr>
<tr id="A2.T9.7.6.1" class="ltx_tr">
<th id="A2.T9.7.6.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="A2.T9.7.6.1.1.1" class="ltx_text" style="font-size:90%;">SimpleCNN</span></th>
<td id="A2.T9.7.6.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T9.7.6.1.2.1" class="ltx_text" style="font-size:90%;">65.96</span></td>
<td id="A2.T9.7.6.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T9.7.6.1.3.1" class="ltx_text" style="font-size:90%;">67.19</span></td>
<td id="A2.T9.7.6.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T9.7.6.1.4.1" class="ltx_text" style="font-size:90%;">69.41</span></td>
<td id="A2.T9.7.6.1.5" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T9.7.6.1.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">69.81</span></td>
<td id="A2.T9.7.6.1.6" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T9.7.6.1.6.1" class="ltx_text" style="font-size:90%;">69.69</span></td>
<td id="A2.T9.7.6.1.7" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T9.7.6.1.7.1" class="ltx_text" style="font-size:90%;">69.59</span></td>
</tr>
<tr id="A2.T9.7.7.2" class="ltx_tr">
<th id="A2.T9.7.7.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="A2.T9.7.7.2.1.1" class="ltx_text" style="font-size:90%;">AlexNet</span></th>
<td id="A2.T9.7.7.2.2" class="ltx_td ltx_align_center"><span id="A2.T9.7.7.2.2.1" class="ltx_text" style="font-size:90%;">73.9</span></td>
<td id="A2.T9.7.7.2.3" class="ltx_td ltx_align_center"><span id="A2.T9.7.7.2.3.1" class="ltx_text" style="font-size:90%;">74.43</span></td>
<td id="A2.T9.7.7.2.4" class="ltx_td ltx_align_center"><span id="A2.T9.7.7.2.4.1" class="ltx_text" style="font-size:90%;">74.96</span></td>
<td id="A2.T9.7.7.2.5" class="ltx_td ltx_align_center"><span id="A2.T9.7.7.2.5.1" class="ltx_text" style="font-size:90%;">75.12</span></td>
<td id="A2.T9.7.7.2.6" class="ltx_td ltx_align_center"><span id="A2.T9.7.7.2.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">75.33</span></td>
<td id="A2.T9.7.7.2.7" class="ltx_td ltx_align_center"><span id="A2.T9.7.7.2.7.1" class="ltx_text" style="font-size:90%;">74.06</span></td>
</tr>
<tr id="A2.T9.7.8.3" class="ltx_tr">
<th id="A2.T9.7.8.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="A2.T9.7.8.3.1.1" class="ltx_text" style="font-size:90%;">ResNet8</span></th>
<td id="A2.T9.7.8.3.2" class="ltx_td ltx_align_center"><span id="A2.T9.7.8.3.2.1" class="ltx_text" style="font-size:90%;">76.26</span></td>
<td id="A2.T9.7.8.3.3" class="ltx_td ltx_align_center"><span id="A2.T9.7.8.3.3.1" class="ltx_text" style="font-size:90%;">75.63</span></td>
<td id="A2.T9.7.8.3.4" class="ltx_td ltx_align_center"><span id="A2.T9.7.8.3.4.1" class="ltx_text" style="font-size:90%;">76.92</span></td>
<td id="A2.T9.7.8.3.5" class="ltx_td ltx_align_center"><span id="A2.T9.7.8.3.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">77.23</span></td>
<td id="A2.T9.7.8.3.6" class="ltx_td ltx_align_center"><span id="A2.T9.7.8.3.6.1" class="ltx_text" style="font-size:90%;">76.9</span></td>
<td id="A2.T9.7.8.3.7" class="ltx_td ltx_align_center"><span id="A2.T9.7.8.3.7.1" class="ltx_text" style="font-size:90%;">76.61</span></td>
</tr>
<tr id="A2.T9.5.3" class="ltx_tr">
<th id="A2.T9.5.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="A2.T9.5.3.2.1" class="ltx_text" style="font-size:90%;">Model</span></th>
<td id="A2.T9.5.3.1" class="ltx_td ltx_align_center ltx_border_t" colspan="6"><math id="A2.T9.5.3.1.m1.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="A2.T9.5.3.1.m1.1a"><mrow id="A2.T9.5.3.1.m1.1.1" xref="A2.T9.5.3.1.m1.1.1.cmml"><mi mathsize="90%" id="A2.T9.5.3.1.m1.1.1.2" xref="A2.T9.5.3.1.m1.1.1.2.cmml">α</mi><mo mathsize="90%" id="A2.T9.5.3.1.m1.1.1.1" xref="A2.T9.5.3.1.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="A2.T9.5.3.1.m1.1.1.3" xref="A2.T9.5.3.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T9.5.3.1.m1.1b"><apply id="A2.T9.5.3.1.m1.1.1.cmml" xref="A2.T9.5.3.1.m1.1.1"><eq id="A2.T9.5.3.1.m1.1.1.1.cmml" xref="A2.T9.5.3.1.m1.1.1.1"></eq><ci id="A2.T9.5.3.1.m1.1.1.2.cmml" xref="A2.T9.5.3.1.m1.1.1.2">𝛼</ci><cn type="float" id="A2.T9.5.3.1.m1.1.1.3.cmml" xref="A2.T9.5.3.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T9.5.3.1.m1.1c">\alpha=0.5</annotation></semantics></math></td>
</tr>
<tr id="A2.T9.7.9.4" class="ltx_tr">
<th id="A2.T9.7.9.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="A2.T9.7.9.4.1.1" class="ltx_text" style="font-size:90%;">SimpleCNN</span></th>
<td id="A2.T9.7.9.4.2" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T9.7.9.4.2.1" class="ltx_text" style="font-size:90%;">65.78</span></td>
<td id="A2.T9.7.9.4.3" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T9.7.9.4.3.1" class="ltx_text" style="font-size:90%;">66.59</span></td>
<td id="A2.T9.7.9.4.4" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T9.7.9.4.4.1" class="ltx_text" style="font-size:90%;">67.93</span></td>
<td id="A2.T9.7.9.4.5" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T9.7.9.4.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">68.85</span></td>
<td id="A2.T9.7.9.4.6" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T9.7.9.4.6.1" class="ltx_text" style="font-size:90%;">68.75</span></td>
<td id="A2.T9.7.9.4.7" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T9.7.9.4.7.1" class="ltx_text" style="font-size:90%;">68.25</span></td>
</tr>
<tr id="A2.T9.7.10.5" class="ltx_tr">
<th id="A2.T9.7.10.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="A2.T9.7.10.5.1.1" class="ltx_text" style="font-size:90%;">AlexNet</span></th>
<td id="A2.T9.7.10.5.2" class="ltx_td ltx_align_center"><span id="A2.T9.7.10.5.2.1" class="ltx_text" style="font-size:90%;">73.72</span></td>
<td id="A2.T9.7.10.5.3" class="ltx_td ltx_align_center"><span id="A2.T9.7.10.5.3.1" class="ltx_text" style="font-size:90%;">73.06</span></td>
<td id="A2.T9.7.10.5.4" class="ltx_td ltx_align_center"><span id="A2.T9.7.10.5.4.1" class="ltx_text" style="font-size:90%;">73.89</span></td>
<td id="A2.T9.7.10.5.5" class="ltx_td ltx_align_center"><span id="A2.T9.7.10.5.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">73.98</span></td>
<td id="A2.T9.7.10.5.6" class="ltx_td ltx_align_center"><span id="A2.T9.7.10.5.6.1" class="ltx_text" style="font-size:90%;">73.6</span></td>
<td id="A2.T9.7.10.5.7" class="ltx_td ltx_align_center"><span id="A2.T9.7.10.5.7.1" class="ltx_text" style="font-size:90%;">73.33</span></td>
</tr>
<tr id="A2.T9.7.11.6" class="ltx_tr">
<th id="A2.T9.7.11.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="A2.T9.7.11.6.1.1" class="ltx_text" style="font-size:90%;">ResNet8</span></th>
<td id="A2.T9.7.11.6.2" class="ltx_td ltx_align_center"><span id="A2.T9.7.11.6.2.1" class="ltx_text" style="font-size:90%;">73.4</span></td>
<td id="A2.T9.7.11.6.3" class="ltx_td ltx_align_center"><span id="A2.T9.7.11.6.3.1" class="ltx_text" style="font-size:90%;">73.93</span></td>
<td id="A2.T9.7.11.6.4" class="ltx_td ltx_align_center"><span id="A2.T9.7.11.6.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">75.39</span></td>
<td id="A2.T9.7.11.6.5" class="ltx_td ltx_align_center"><span id="A2.T9.7.11.6.5.1" class="ltx_text" style="font-size:90%;">74.12</span></td>
<td id="A2.T9.7.11.6.6" class="ltx_td ltx_align_center"><span id="A2.T9.7.11.6.6.1" class="ltx_text" style="font-size:90%;">73.66</span></td>
<td id="A2.T9.7.11.6.7" class="ltx_td ltx_align_center"><span id="A2.T9.7.11.6.7.1" class="ltx_text" style="font-size:90%;">73.46</span></td>
</tr>
<tr id="A2.T9.6.4" class="ltx_tr">
<th id="A2.T9.6.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="A2.T9.6.4.2.1" class="ltx_text" style="font-size:90%;">Model</span></th>
<td id="A2.T9.6.4.1" class="ltx_td ltx_align_center ltx_border_t" colspan="6"><math id="A2.T9.6.4.1.m1.1" class="ltx_Math" alttext="\alpha=0.2" display="inline"><semantics id="A2.T9.6.4.1.m1.1a"><mrow id="A2.T9.6.4.1.m1.1.1" xref="A2.T9.6.4.1.m1.1.1.cmml"><mi mathsize="90%" id="A2.T9.6.4.1.m1.1.1.2" xref="A2.T9.6.4.1.m1.1.1.2.cmml">α</mi><mo mathsize="90%" id="A2.T9.6.4.1.m1.1.1.1" xref="A2.T9.6.4.1.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="A2.T9.6.4.1.m1.1.1.3" xref="A2.T9.6.4.1.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T9.6.4.1.m1.1b"><apply id="A2.T9.6.4.1.m1.1.1.cmml" xref="A2.T9.6.4.1.m1.1.1"><eq id="A2.T9.6.4.1.m1.1.1.1.cmml" xref="A2.T9.6.4.1.m1.1.1.1"></eq><ci id="A2.T9.6.4.1.m1.1.1.2.cmml" xref="A2.T9.6.4.1.m1.1.1.2">𝛼</ci><cn type="float" id="A2.T9.6.4.1.m1.1.1.3.cmml" xref="A2.T9.6.4.1.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T9.6.4.1.m1.1c">\alpha=0.2</annotation></semantics></math></td>
</tr>
<tr id="A2.T9.7.12.7" class="ltx_tr">
<th id="A2.T9.7.12.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="A2.T9.7.12.7.1.1" class="ltx_text" style="font-size:90%;">SimpleCNN</span></th>
<td id="A2.T9.7.12.7.2" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T9.7.12.7.2.1" class="ltx_text" style="font-size:90%;">63.52</span></td>
<td id="A2.T9.7.12.7.3" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T9.7.12.7.3.1" class="ltx_text" style="font-size:90%;">64.68</span></td>
<td id="A2.T9.7.12.7.4" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T9.7.12.7.4.1" class="ltx_text" style="font-size:90%;">63.72</span></td>
<td id="A2.T9.7.12.7.5" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T9.7.12.7.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">65.82</span></td>
<td id="A2.T9.7.12.7.6" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T9.7.12.7.6.1" class="ltx_text" style="font-size:90%;">65.4</span></td>
<td id="A2.T9.7.12.7.7" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T9.7.12.7.7.1" class="ltx_text" style="font-size:90%;">64.97</span></td>
</tr>
<tr id="A2.T9.7.13.8" class="ltx_tr">
<th id="A2.T9.7.13.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="A2.T9.7.13.8.1.1" class="ltx_text" style="font-size:90%;">AlexNet</span></th>
<td id="A2.T9.7.13.8.2" class="ltx_td ltx_align_center"><span id="A2.T9.7.13.8.2.1" class="ltx_text" style="font-size:90%;">68.41</span></td>
<td id="A2.T9.7.13.8.3" class="ltx_td ltx_align_center"><span id="A2.T9.7.13.8.3.1" class="ltx_text" style="font-size:90%;">70.46</span></td>
<td id="A2.T9.7.13.8.4" class="ltx_td ltx_align_center"><span id="A2.T9.7.13.8.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">70.87</span></td>
<td id="A2.T9.7.13.8.5" class="ltx_td ltx_align_center"><span id="A2.T9.7.13.8.5.1" class="ltx_text" style="font-size:90%;">70.74</span></td>
<td id="A2.T9.7.13.8.6" class="ltx_td ltx_align_center"><span id="A2.T9.7.13.8.6.1" class="ltx_text" style="font-size:90%;">70.58</span></td>
<td id="A2.T9.7.13.8.7" class="ltx_td ltx_align_center"><span id="A2.T9.7.13.8.7.1" class="ltx_text" style="font-size:90%;">69.42</span></td>
</tr>
<tr id="A2.T9.7.14.9" class="ltx_tr">
<th id="A2.T9.7.14.9.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="A2.T9.7.14.9.1.1" class="ltx_text" style="font-size:90%;">ResNet8</span></th>
<td id="A2.T9.7.14.9.2" class="ltx_td ltx_align_center"><span id="A2.T9.7.14.9.2.1" class="ltx_text" style="font-size:90%;">71.85</span></td>
<td id="A2.T9.7.14.9.3" class="ltx_td ltx_align_center"><span id="A2.T9.7.14.9.3.1" class="ltx_text" style="font-size:90%;">70.96</span></td>
<td id="A2.T9.7.14.9.4" class="ltx_td ltx_align_center"><span id="A2.T9.7.14.9.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">72.76</span></td>
<td id="A2.T9.7.14.9.5" class="ltx_td ltx_align_center"><span id="A2.T9.7.14.9.5.1" class="ltx_text" style="font-size:90%;">72.04</span></td>
<td id="A2.T9.7.14.9.6" class="ltx_td ltx_align_center"><span id="A2.T9.7.14.9.6.1" class="ltx_text" style="font-size:90%;">71.25</span></td>
<td id="A2.T9.7.14.9.7" class="ltx_td ltx_align_center"><span id="A2.T9.7.14.9.7.1" class="ltx_text" style="font-size:90%;">62.32</span></td>
</tr>
<tr id="A2.T9.7.5" class="ltx_tr">
<th id="A2.T9.7.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="A2.T9.7.5.2.1" class="ltx_text" style="font-size:90%;">Model</span></th>
<td id="A2.T9.7.5.1" class="ltx_td ltx_align_center ltx_border_t" colspan="6"><math id="A2.T9.7.5.1.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="A2.T9.7.5.1.m1.1a"><mrow id="A2.T9.7.5.1.m1.1.1" xref="A2.T9.7.5.1.m1.1.1.cmml"><mi mathsize="90%" id="A2.T9.7.5.1.m1.1.1.2" xref="A2.T9.7.5.1.m1.1.1.2.cmml">α</mi><mo mathsize="90%" id="A2.T9.7.5.1.m1.1.1.1" xref="A2.T9.7.5.1.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="A2.T9.7.5.1.m1.1.1.3" xref="A2.T9.7.5.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T9.7.5.1.m1.1b"><apply id="A2.T9.7.5.1.m1.1.1.cmml" xref="A2.T9.7.5.1.m1.1.1"><eq id="A2.T9.7.5.1.m1.1.1.1.cmml" xref="A2.T9.7.5.1.m1.1.1.1"></eq><ci id="A2.T9.7.5.1.m1.1.1.2.cmml" xref="A2.T9.7.5.1.m1.1.1.2">𝛼</ci><cn type="float" id="A2.T9.7.5.1.m1.1.1.3.cmml" xref="A2.T9.7.5.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T9.7.5.1.m1.1c">\alpha=0.1</annotation></semantics></math></td>
</tr>
<tr id="A2.T9.7.15.10" class="ltx_tr">
<th id="A2.T9.7.15.10.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="A2.T9.7.15.10.1.1" class="ltx_text" style="font-size:90%;">SimpleCNN</span></th>
<td id="A2.T9.7.15.10.2" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T9.7.15.10.2.1" class="ltx_text" style="font-size:90%;">60.57</span></td>
<td id="A2.T9.7.15.10.3" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T9.7.15.10.3.1" class="ltx_text" style="font-size:90%;">61.22</span></td>
<td id="A2.T9.7.15.10.4" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T9.7.15.10.4.1" class="ltx_text" style="font-size:90%;">61.83</span></td>
<td id="A2.T9.7.15.10.5" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T9.7.15.10.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">62.05</span></td>
<td id="A2.T9.7.15.10.6" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T9.7.15.10.6.1" class="ltx_text" style="font-size:90%;">62.05</span></td>
<td id="A2.T9.7.15.10.7" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T9.7.15.10.7.1" class="ltx_text" style="font-size:90%;">60.85</span></td>
</tr>
<tr id="A2.T9.7.16.11" class="ltx_tr">
<th id="A2.T9.7.16.11.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="A2.T9.7.16.11.1.1" class="ltx_text" style="font-size:90%;">AlexNet</span></th>
<td id="A2.T9.7.16.11.2" class="ltx_td ltx_align_center"><span id="A2.T9.7.16.11.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">66.18</span></td>
<td id="A2.T9.7.16.11.3" class="ltx_td ltx_align_center"><span id="A2.T9.7.16.11.3.1" class="ltx_text" style="font-size:90%;">65.25</span></td>
<td id="A2.T9.7.16.11.4" class="ltx_td ltx_align_center"><span id="A2.T9.7.16.11.4.1" class="ltx_text" style="font-size:90%;">64.74</span></td>
<td id="A2.T9.7.16.11.5" class="ltx_td ltx_align_center"><span id="A2.T9.7.16.11.5.1" class="ltx_text" style="font-size:90%;">64.23</span></td>
<td id="A2.T9.7.16.11.6" class="ltx_td ltx_align_center"><span id="A2.T9.7.16.11.6.1" class="ltx_text" style="font-size:90%;">64.16</span></td>
<td id="A2.T9.7.16.11.7" class="ltx_td ltx_align_center"><span id="A2.T9.7.16.11.7.1" class="ltx_text" style="font-size:90%;">61.24</span></td>
</tr>
<tr id="A2.T9.7.17.12" class="ltx_tr">
<th id="A2.T9.7.17.12.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r"><span id="A2.T9.7.17.12.1.1" class="ltx_text" style="font-size:90%;">ResNet8</span></th>
<td id="A2.T9.7.17.12.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="A2.T9.7.17.12.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">63.89</span></td>
<td id="A2.T9.7.17.12.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="A2.T9.7.17.12.3.1" class="ltx_text" style="font-size:90%;">60.55</span></td>
<td id="A2.T9.7.17.12.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="A2.T9.7.17.12.4.1" class="ltx_text" style="font-size:90%;">61.38</span></td>
<td id="A2.T9.7.17.12.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="A2.T9.7.17.12.5.1" class="ltx_text" style="font-size:90%;">59.23</span></td>
<td id="A2.T9.7.17.12.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="A2.T9.7.17.12.6.1" class="ltx_text" style="font-size:90%;">58.76</span></td>
<td id="A2.T9.7.17.12.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="A2.T9.7.17.12.7.1" class="ltx_text" style="font-size:90%;">39.85</span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="A2.T10" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 10: </span>The performance of adaptive GWS under different global learning rates.</figcaption>
<table id="A2.T10.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A2.T10.2.2" class="ltx_tr">
<th id="A2.T10.2.2.3" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t"></th>
<th id="A2.T10.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3">IID (<math id="A2.T10.1.1.1.m1.1" class="ltx_Math" alttext="\alpha=100" display="inline"><semantics id="A2.T10.1.1.1.m1.1a"><mrow id="A2.T10.1.1.1.m1.1.1" xref="A2.T10.1.1.1.m1.1.1.cmml"><mi id="A2.T10.1.1.1.m1.1.1.2" xref="A2.T10.1.1.1.m1.1.1.2.cmml">α</mi><mo id="A2.T10.1.1.1.m1.1.1.1" xref="A2.T10.1.1.1.m1.1.1.1.cmml">=</mo><mn id="A2.T10.1.1.1.m1.1.1.3" xref="A2.T10.1.1.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T10.1.1.1.m1.1b"><apply id="A2.T10.1.1.1.m1.1.1.cmml" xref="A2.T10.1.1.1.m1.1.1"><eq id="A2.T10.1.1.1.m1.1.1.1.cmml" xref="A2.T10.1.1.1.m1.1.1.1"></eq><ci id="A2.T10.1.1.1.m1.1.1.2.cmml" xref="A2.T10.1.1.1.m1.1.1.2">𝛼</ci><cn type="integer" id="A2.T10.1.1.1.m1.1.1.3.cmml" xref="A2.T10.1.1.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T10.1.1.1.m1.1c">\alpha=100</annotation></semantics></math>)</th>
<th id="A2.T10.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="3">NonIID (<math id="A2.T10.2.2.2.m1.1" class="ltx_Math" alttext="\alpha=1" display="inline"><semantics id="A2.T10.2.2.2.m1.1a"><mrow id="A2.T10.2.2.2.m1.1.1" xref="A2.T10.2.2.2.m1.1.1.cmml"><mi id="A2.T10.2.2.2.m1.1.1.2" xref="A2.T10.2.2.2.m1.1.1.2.cmml">α</mi><mo id="A2.T10.2.2.2.m1.1.1.1" xref="A2.T10.2.2.2.m1.1.1.1.cmml">=</mo><mn id="A2.T10.2.2.2.m1.1.1.3" xref="A2.T10.2.2.2.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T10.2.2.2.m1.1b"><apply id="A2.T10.2.2.2.m1.1.1.cmml" xref="A2.T10.2.2.2.m1.1.1"><eq id="A2.T10.2.2.2.m1.1.1.1.cmml" xref="A2.T10.2.2.2.m1.1.1.1"></eq><ci id="A2.T10.2.2.2.m1.1.1.2.cmml" xref="A2.T10.2.2.2.m1.1.1.2">𝛼</ci><cn type="integer" id="A2.T10.2.2.2.m1.1.1.3.cmml" xref="A2.T10.2.2.2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T10.2.2.2.m1.1c">\alpha=1</annotation></semantics></math>)</th>
</tr>
<tr id="A2.T10.3.4.1" class="ltx_tr">
<th id="A2.T10.3.4.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t">Global learning rate</th>
<th id="A2.T10.3.4.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">0.5</th>
<th id="A2.T10.3.4.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">1</th>
<th id="A2.T10.3.4.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">1.5</th>
<th id="A2.T10.3.4.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">0.5</th>
<th id="A2.T10.3.4.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">1</th>
<th id="A2.T10.3.4.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">1.5</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A2.T10.3.5.1" class="ltx_tr">
<th id="A2.T10.3.5.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">FedAvg</th>
<td id="A2.T10.3.5.1.2" class="ltx_td ltx_align_center ltx_border_t">69.15</td>
<td id="A2.T10.3.5.1.3" class="ltx_td ltx_align_center ltx_border_t">68.18</td>
<td id="A2.T10.3.5.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">64.35</td>
<td id="A2.T10.3.5.1.5" class="ltx_td ltx_align_center ltx_border_t">68.71</td>
<td id="A2.T10.3.5.1.6" class="ltx_td ltx_align_center ltx_border_t">67.09</td>
<td id="A2.T10.3.5.1.7" class="ltx_td ltx_align_center ltx_border_t">64.00</td>
</tr>
<tr id="A2.T10.3.6.2" class="ltx_tr">
<th id="A2.T10.3.6.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Adaptive GWS</th>
<td id="A2.T10.3.6.2.2" class="ltx_td ltx_align_center">71.45</td>
<td id="A2.T10.3.6.2.3" class="ltx_td ltx_align_center">71.98</td>
<td id="A2.T10.3.6.2.4" class="ltx_td ltx_align_center ltx_border_r">71.13</td>
<td id="A2.T10.3.6.2.5" class="ltx_td ltx_align_center">69.65</td>
<td id="A2.T10.3.6.2.6" class="ltx_td ltx_align_center">71.02</td>
<td id="A2.T10.3.6.2.7" class="ltx_td ltx_align_center">71.04</td>
</tr>
<tr id="A2.T10.3.3" class="ltx_tr">
<th id="A2.T10.3.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r">
<math id="A2.T10.3.3.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A2.T10.3.3.1.m1.1a"><mi id="A2.T10.3.3.1.m1.1.1" xref="A2.T10.3.3.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A2.T10.3.3.1.m1.1b"><ci id="A2.T10.3.3.1.m1.1.1.cmml" xref="A2.T10.3.3.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T10.3.3.1.m1.1c">\gamma</annotation></semantics></math> of Adaptive GWS</th>
<td id="A2.T10.3.3.2" class="ltx_td ltx_align_center ltx_border_b">0.986</td>
<td id="A2.T10.3.3.3" class="ltx_td ltx_align_center ltx_border_b">0.974</td>
<td id="A2.T10.3.3.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">0.963</td>
<td id="A2.T10.3.3.5" class="ltx_td ltx_align_center ltx_border_b">0.991</td>
<td id="A2.T10.3.3.6" class="ltx_td ltx_align_center ltx_border_b">0.979</td>
<td id="A2.T10.3.3.7" class="ltx_td ltx_align_center ltx_border_b">0.967</td>
</tr>
</tbody>
</table>
</figure>
<div id="A2.SS1.p2" class="ltx_para">
<p id="A2.SS1.p2.1" class="ltx_p"><span id="A2.SS1.p2.1.1" class="ltx_text ltx_font_bold">Adaptive GWS with global learning rate.</span> We conduct experiments with the adaptive GWS under different global learning rates for both IID and NonIID settings. We train SimpleCNN on CIFAR10 with 1 local epoch, and the results are reported in <a href="#A2.T10" title="Table 10 ‣ B.1 Global Weight Shrinking ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 10</span></a>. It can be observed that in both IID and NonIID settings, a small global server learning rate can improve <span id="A2.SS1.p2.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span>’s performance. In contrast, the larger the global learning rate, the smaller the learned <math id="A2.SS1.p2.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A2.SS1.p2.1.m1.1a"><mi id="A2.SS1.p2.1.m1.1.1" xref="A2.SS1.p2.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.1.m1.1b"><ci id="A2.SS1.p2.1.m1.1.1.cmml" xref="A2.SS1.p2.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.1.m1.1c">\gamma</annotation></semantics></math> (stronger regularization). It is aligned with our insights in the main paper that larger pseudo gradients require stronger regularization. Moreover, adaptive GWS is robust to the choice of the global server learning rate, especially in the IID setting.</p>
</div>
<div id="A2.SS1.p3" class="ltx_para">
<p id="A2.SS1.p3.6" class="ltx_p"><span id="A2.SS1.p3.6.1" class="ltx_text ltx_font_bold">Adaptive GWS under various heterogeneity.</span> We show adaptive GWS works under various heterogeneity and visualize <math id="A2.SS1.p3.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A2.SS1.p3.1.m1.1a"><mi id="A2.SS1.p3.1.m1.1.1" xref="A2.SS1.p3.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.1.m1.1b"><ci id="A2.SS1.p3.1.m1.1.1.cmml" xref="A2.SS1.p3.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.1.m1.1c">\gamma</annotation></semantics></math> and the norm of the global gradient in each setting, as in <a href="#A2.F9" title="Figure 9 ‣ B.1 Global Weight Shrinking ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 9</span></a>. It demonstrates that adaptive GWS can boost performance under different NonIID settings, but it has a smaller benefit when the system is extremely NonIID (i.e., <math id="A2.SS1.p3.2.m2.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="A2.SS1.p3.2.m2.1a"><mrow id="A2.SS1.p3.2.m2.1.1" xref="A2.SS1.p3.2.m2.1.1.cmml"><mi id="A2.SS1.p3.2.m2.1.1.2" xref="A2.SS1.p3.2.m2.1.1.2.cmml">α</mi><mo id="A2.SS1.p3.2.m2.1.1.1" xref="A2.SS1.p3.2.m2.1.1.1.cmml">=</mo><mn id="A2.SS1.p3.2.m2.1.1.3" xref="A2.SS1.p3.2.m2.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.2.m2.1b"><apply id="A2.SS1.p3.2.m2.1.1.cmml" xref="A2.SS1.p3.2.m2.1.1"><eq id="A2.SS1.p3.2.m2.1.1.1.cmml" xref="A2.SS1.p3.2.m2.1.1.1"></eq><ci id="A2.SS1.p3.2.m2.1.1.2.cmml" xref="A2.SS1.p3.2.m2.1.1.2">𝛼</ci><cn type="float" id="A2.SS1.p3.2.m2.1.1.3.cmml" xref="A2.SS1.p3.2.m2.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.2.m2.1c">\alpha=0.1</annotation></semantics></math>). Additionally, according to the right figure of <a href="#A2.F9" title="Figure 9 ‣ B.1 Global Weight Shrinking ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 9</span></a>, except for the outlier <math id="A2.SS1.p3.3.m3.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A2.SS1.p3.3.m3.1a"><mi id="A2.SS1.p3.3.m3.1.1" xref="A2.SS1.p3.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.3.m3.1b"><ci id="A2.SS1.p3.3.m3.1.1.cmml" xref="A2.SS1.p3.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.3.m3.1c">\gamma</annotation></semantics></math> when <math id="A2.SS1.p3.4.m4.1" class="ltx_Math" alttext="\alpha=10" display="inline"><semantics id="A2.SS1.p3.4.m4.1a"><mrow id="A2.SS1.p3.4.m4.1.1" xref="A2.SS1.p3.4.m4.1.1.cmml"><mi id="A2.SS1.p3.4.m4.1.1.2" xref="A2.SS1.p3.4.m4.1.1.2.cmml">α</mi><mo id="A2.SS1.p3.4.m4.1.1.1" xref="A2.SS1.p3.4.m4.1.1.1.cmml">=</mo><mn id="A2.SS1.p3.4.m4.1.1.3" xref="A2.SS1.p3.4.m4.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.4.m4.1b"><apply id="A2.SS1.p3.4.m4.1.1.cmml" xref="A2.SS1.p3.4.m4.1.1"><eq id="A2.SS1.p3.4.m4.1.1.1.cmml" xref="A2.SS1.p3.4.m4.1.1.1"></eq><ci id="A2.SS1.p3.4.m4.1.1.2.cmml" xref="A2.SS1.p3.4.m4.1.1.2">𝛼</ci><cn type="integer" id="A2.SS1.p3.4.m4.1.1.3.cmml" xref="A2.SS1.p3.4.m4.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.4.m4.1c">\alpha=10</annotation></semantics></math>, the learned <math id="A2.SS1.p3.5.m5.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A2.SS1.p3.5.m5.1a"><mi id="A2.SS1.p3.5.m5.1.1" xref="A2.SS1.p3.5.m5.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.5.m5.1b"><ci id="A2.SS1.p3.5.m5.1.1.cmml" xref="A2.SS1.p3.5.m5.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.5.m5.1c">\gamma</annotation></semantics></math> decreases when data become more IID, causing stronger weight shrinking effect. We think this is a result of a balance between optimization and regularization. The volumes of global gradients change when the heterogeneity changes. The norm of global gradient increases when data become more IID, and it requires smaller <math id="A2.SS1.p3.6.m6.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A2.SS1.p3.6.m6.1a"><mi id="A2.SS1.p3.6.m6.1.1" xref="A2.SS1.p3.6.m6.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.6.m6.1b"><ci id="A2.SS1.p3.6.m6.1.1.cmml" xref="A2.SS1.p3.6.m6.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.6.m6.1c">\gamma</annotation></semantics></math> to cause stronger regularization.</p>
</div>
<figure id="A2.F9" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2302.10911/assets/x17.png" id="A2.F9.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="184" height="149" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2302.10911/assets/x18.png" id="A2.F9.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="184" height="147" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span><span id="A2.F9.6.3" class="ltx_text ltx_font_bold" style="font-size:90%;">Adaptive GWS under various heterogeneity.<span id="A2.F9.6.3.4" class="ltx_text ltx_font_medium"> </span>Left:<span id="A2.F9.6.3.5" class="ltx_text ltx_font_medium"> Test accuracy gains with adaptive GWS. In all settings, adaptive GWS can bring performance gains. </span>Right:<span id="A2.F9.6.3.3" class="ltx_text ltx_font_medium"> Learned <math id="A2.F9.4.1.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A2.F9.4.1.1.m1.1b"><mi id="A2.F9.4.1.1.m1.1.1" xref="A2.F9.4.1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A2.F9.4.1.1.m1.1c"><ci id="A2.F9.4.1.1.m1.1.1.cmml" xref="A2.F9.4.1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.F9.4.1.1.m1.1d">\gamma</annotation></semantics></math> of adaptive GWS in different settings. <math id="A2.F9.5.2.2.m2.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A2.F9.5.2.2.m2.1b"><mi id="A2.F9.5.2.2.m2.1.1" xref="A2.F9.5.2.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A2.F9.5.2.2.m2.1c"><ci id="A2.F9.5.2.2.m2.1.1.cmml" xref="A2.F9.5.2.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.F9.5.2.2.m2.1d">\gamma</annotation></semantics></math> decreases when data become more IID, causing the stronger weight shrinking effect. This is due to the changes in the volumes of global gradients. The norm of global gradient increases when data become more IID, and it requires smaller <math id="A2.F9.6.3.3.m3.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A2.F9.6.3.3.m3.1b"><mi id="A2.F9.6.3.3.m3.1.1" xref="A2.F9.6.3.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A2.F9.6.3.3.m3.1c"><ci id="A2.F9.6.3.3.m3.1.1.cmml" xref="A2.F9.6.3.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.F9.6.3.3.m3.1d">\gamma</annotation></semantics></math> to cause stronger regularization.</span></span></figcaption>
</figure>
<div id="A2.SS1.p4" class="ltx_para">
<p id="A2.SS1.p4.1" class="ltx_p"><span id="A2.SS1.p4.1.1" class="ltx_text ltx_font_bold">More results of general understanding of adaptive GWS.</span> First, we first visualize the norm of model parameter weight during training as in the left figure of <a href="#A2.F10" title="Figure 10 ‣ B.1 Global Weight Shrinking ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 10</span></a>. Adaptive GWS results in a smaller model parameter during training. Second, we use two common metrics to measure the flatness of loss landscape during training as in the middle and right figures of <a href="#A2.F10" title="Figure 10 ‣ B.1 Global Weight Shrinking ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 10</span></a>, and they are the hessian eigenvalue-based metrics. The dominant hessian eigenvalue evaluates the worst-case loss landscape, which means the larger top 1 eigenvalue indicates the greater change in the loss along this direction and the sharper the minima <cite class="ltx_cite ltx_citemacro_citep">(Keskar et al., <a href="#bib.bib28" title="" class="ltx_ref">2017</a>)</cite>. We adopt the top 1 hessian eigenvalue and the ratio of top 1 and top 5, which are commonly used as a proxy for flatness <cite class="ltx_cite ltx_citemacro_citep">(Jastrzebski et al., <a href="#bib.bib24" title="" class="ltx_ref">2020</a>; Fort &amp; Jastrzebski, <a href="#bib.bib14" title="" class="ltx_ref">2019</a>)</cite>. Usually, a smaller top 1 hessian eigenvalue and a smaller ratio of top 1 hessian eigenvalue and top 5 indicates flatter curvature of DNN. As in the figures, during the training, <span id="A2.SS1.p4.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> generates global models with sharp landscapes whereas adaptive GWS tends to generate more generalized models with flatter curvatures.</p>
</div>
<figure id="A2.F10" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2302.10911/assets/x19.png" id="A2.F10.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="147" height="119" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2302.10911/assets/x20.png" id="A2.F10.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="147" height="117" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2302.10911/assets/x21.png" id="A2.F10.g3" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="147" height="122" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span><span id="A2.F10.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">More results of general understanding of adaptive GWS.<span id="A2.F10.2.1.1" class="ltx_text ltx_font_medium"> </span>Left:<span id="A2.F10.2.1.2" class="ltx_text ltx_font_medium"> Adaptive GWS results in a smaller model parameter during training. </span>Middle:<span id="A2.F10.2.1.3" class="ltx_text ltx_font_medium"> Smaller top 1 hessian eigenvalue indicates flatter curvature of DNNs. The result shows <span id="A2.F10.2.1.3.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> tends to generate sharper global models during training while adaptive GWS seeks flatter networks. </span>Right:<span id="A2.F10.2.1.4" class="ltx_text ltx_font_medium"> The ratio of the top 1 hessian eigenvalue and top 5 is another indicator; a smaller value means flatter minima.</span></span></figcaption>
</figure>
<div id="A2.SS1.p5" class="ltx_para">
<p id="A2.SS1.p5.3" class="ltx_p"><span id="A2.SS1.p5.1.1" class="ltx_text ltx_font_bold">The distribution of <math id="A2.SS1.p5.1.1.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="A2.SS1.p5.1.1.m1.1a"><mi id="A2.SS1.p5.1.1.m1.1.1" xref="A2.SS1.p5.1.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.1.1.m1.1b"><ci id="A2.SS1.p5.1.1.m1.1.1.cmml" xref="A2.SS1.p5.1.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.1.1.m1.1c">r</annotation></semantics></math>.</span> We visualize <math id="A2.SS1.p5.2.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="A2.SS1.p5.2.m1.1a"><mi id="A2.SS1.p5.2.m1.1.1" xref="A2.SS1.p5.2.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.2.m1.1b"><ci id="A2.SS1.p5.2.m1.1.1.cmml" xref="A2.SS1.p5.2.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.2.m1.1c">r</annotation></semantics></math> (the ratio of the global gradient and the regularization pseudo gradient) values of all experiments in <a href="#S4.F2" title="Figure 2 ‣ 4.1 Global Weight Shrinking and Its Impacts on Optimization ‣ 4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 2</span></a> and <a href="#A2.F9" title="Figure 9 ‣ B.1 Global Weight Shrinking ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 9</span></a> as in <a href="#A2.F11" title="Figure 11 ‣ B.1 Global Weight Shrinking ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 11</span></a>. It is found that the distribution of <math id="A2.SS1.p5.3.m2.1" class="ltx_Math" alttext="r" display="inline"><semantics id="A2.SS1.p5.3.m2.1a"><mi id="A2.SS1.p5.3.m2.1.1" xref="A2.SS1.p5.3.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.3.m2.1b"><ci id="A2.SS1.p5.3.m2.1.1.cmml" xref="A2.SS1.p5.3.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.3.m2.1c">r</annotation></semantics></math> can be approximated into a Gaussian distribution with its mean around 20.5.</p>
</div>
<figure id="A2.F11" class="ltx_figure"><img src="/html/2302.10911/assets/x22.png" id="A2.F11.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="277" height="188" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span><span id="A2.F11.6.3" class="ltx_text ltx_font_bold" style="font-size:90%;">Distribution of <math id="A2.F11.4.1.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="A2.F11.4.1.m1.1b"><mi id="A2.F11.4.1.m1.1.1" xref="A2.F11.4.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="A2.F11.4.1.m1.1c"><ci id="A2.F11.4.1.m1.1.1.cmml" xref="A2.F11.4.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.F11.4.1.m1.1d">r</annotation></semantics></math>.<span id="A2.F11.6.3.2" class="ltx_text ltx_font_medium"> We visualize <math id="A2.F11.5.2.1.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="A2.F11.5.2.1.m1.1b"><mi id="A2.F11.5.2.1.m1.1.1" xref="A2.F11.5.2.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="A2.F11.5.2.1.m1.1c"><ci id="A2.F11.5.2.1.m1.1.1.cmml" xref="A2.F11.5.2.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.F11.5.2.1.m1.1d">r</annotation></semantics></math> values of all experiments in <a href="#S4.F2" title="Figure 2 ‣ 4.1 Global Weight Shrinking and Its Impacts on Optimization ‣ 4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 2</span></a> and <a href="#A2.F9" title="Figure 9 ‣ B.1 Global Weight Shrinking ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 9</span></a> and find that the distribution of <math id="A2.F11.6.3.2.m2.1" class="ltx_Math" alttext="r" display="inline"><semantics id="A2.F11.6.3.2.m2.1b"><mi id="A2.F11.6.3.2.m2.1.1" xref="A2.F11.6.3.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="A2.F11.6.3.2.m2.1c"><ci id="A2.F11.6.3.2.m2.1.1.cmml" xref="A2.F11.6.3.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.F11.6.3.2.m2.1d">r</annotation></semantics></math> can be approximated into a Gaussian distribution with its mean around 20.5.</span></span></figcaption>
</figure>
</section>
<section id="A2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Client Coherence</h3>

<div id="A2.SS2.p1" class="ltx_para">
<p id="A2.SS2.p1.2" class="ltx_p"><span id="A2.SS2.p1.2.1" class="ltx_text ltx_font_bold">The relationship with gradient diversity.</span>
The conclusion of gradient diversity <cite class="ltx_cite ltx_citemacro_citep">(Yin et al., <a href="#bib.bib55" title="" class="ltx_ref">2018</a>)</cite> is opposite to the one of gradient coherence. Gradient diversity argues that higher similarities between workers’ gradients will degrade performance in distributed mini-batch SGD, while gradient coherence claims that higher similarities between the gradients of samples will boost generalization <cite class="ltx_cite ltx_citemacro_citep">(Yin et al., <a href="#bib.bib55" title="" class="ltx_ref">2018</a>; Chatterjee, <a href="#bib.bib5" title="" class="ltx_ref">2019</a>)</cite>. Moreover, gradient diversity is somewhat controversial. As argued in the line of works about gradient coherence <cite class="ltx_cite ltx_citemacro_citep">(Chatterjee &amp; Zielinski, <a href="#bib.bib6" title="" class="ltx_ref">2020</a>; Chatterjee, <a href="#bib.bib5" title="" class="ltx_ref">2019</a>)</cite>, the manuscript of gradient diversity did not explicitly measure the gradient diversity in the experiments (or further study its properties): only experiments on CIFAR-10 can be found where they replicate <math id="A2.SS2.p1.1.m1.1" class="ltx_Math" alttext="1/r" display="inline"><semantics id="A2.SS2.p1.1.m1.1a"><mrow id="A2.SS2.p1.1.m1.1.1" xref="A2.SS2.p1.1.m1.1.1.cmml"><mn id="A2.SS2.p1.1.m1.1.1.2" xref="A2.SS2.p1.1.m1.1.1.2.cmml">1</mn><mo id="A2.SS2.p1.1.m1.1.1.1" xref="A2.SS2.p1.1.m1.1.1.1.cmml">/</mo><mi id="A2.SS2.p1.1.m1.1.1.3" xref="A2.SS2.p1.1.m1.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.1.m1.1b"><apply id="A2.SS2.p1.1.m1.1.1.cmml" xref="A2.SS2.p1.1.m1.1.1"><divide id="A2.SS2.p1.1.m1.1.1.1.cmml" xref="A2.SS2.p1.1.m1.1.1.1"></divide><cn type="integer" id="A2.SS2.p1.1.m1.1.1.2.cmml" xref="A2.SS2.p1.1.m1.1.1.2">1</cn><ci id="A2.SS2.p1.1.m1.1.1.3.cmml" xref="A2.SS2.p1.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.1.m1.1c">1/r</annotation></semantics></math> of the dataset <math id="A2.SS2.p1.2.m2.1" class="ltx_Math" alttext="r" display="inline"><semantics id="A2.SS2.p1.2.m2.1a"><mi id="A2.SS2.p1.2.m2.1.1" xref="A2.SS2.p1.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.2.m2.1b"><ci id="A2.SS2.p1.2.m2.1.1.cmml" xref="A2.SS2.p1.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.2.m2.1c">r</annotation></semantics></math> times and show that greater the value of r less the effectiveness of mini-batching to speed up. Apart from this controversy, the strongly-convex assumption in the theorem of gradient diversity <cite class="ltx_cite ltx_citemacro_citep">(Yin et al., <a href="#bib.bib55" title="" class="ltx_ref">2018</a>)</cite> may make it weaker to generalize its conclusions in neural networks while we are studying the empirical properties in FL with neural networks. Taking the above statements into consideration, gradient diversity may be infeasible in our settings.</p>
</div>
<div id="A2.SS2.p2" class="ltx_para">
<p id="A2.SS2.p2.1" class="ltx_p"><span id="A2.SS2.p2.1.1" class="ltx_text ltx_font_bold">The relationship with client similarity works in FL.</span>
There are some works <cite class="ltx_cite ltx_citemacro_citep">(Karimireddy et al., <a href="#bib.bib27" title="" class="ltx_ref">2020</a>; Li et al., <a href="#bib.bib34" title="" class="ltx_ref">2020b</a>)</cite> taking the bounded gradient dissimilarity assumption to deduce theorems. In their assumptions, they bound the gradient sum or gradient norm, but we use the cosine similarity to study how the clients interplay with each other and contribute to the global. So the perspectives are quite different. Additionally, there are previous works in FL that use cosine similarity of clients’ gradients to improve personalization <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a href="#bib.bib20" title="" class="ltx_ref">2021</a>; Li et al., <a href="#bib.bib36" title="" class="ltx_ref">2022b</a>)</cite>; however, we focus on the training dynamics in generalization, and one of our novel findings is we discover a critical point exists and the periods that before or after this point play different roles in the global generalization.</p>
</div>
<div id="A2.SS2.p3" class="ltx_para">
<p id="A2.SS2.p3.5" class="ltx_p"><span id="A2.SS2.p3.5.1" class="ltx_text ltx_font_bold">Visualization of how heterogeneity affects the optimal aggregation weight.</span> We set up a three-node toy example on CIFAR-10 by hybrid Dirichlet sampling as shown in <a href="#A2.F12" title="Figure 12 ‣ B.2 Client Coherence ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 12</span></a>. We first sample client 0’s data distribution by Dirichlet sampling according to <math id="A2.SS2.p3.1.m1.1" class="ltx_Math" alttext="\alpha_{1}" display="inline"><semantics id="A2.SS2.p3.1.m1.1a"><msub id="A2.SS2.p3.1.m1.1.1" xref="A2.SS2.p3.1.m1.1.1.cmml"><mi id="A2.SS2.p3.1.m1.1.1.2" xref="A2.SS2.p3.1.m1.1.1.2.cmml">α</mi><mn id="A2.SS2.p3.1.m1.1.1.3" xref="A2.SS2.p3.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A2.SS2.p3.1.m1.1b"><apply id="A2.SS2.p3.1.m1.1.1.cmml" xref="A2.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS2.p3.1.m1.1.1.1.cmml" xref="A2.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="A2.SS2.p3.1.m1.1.1.2.cmml" xref="A2.SS2.p3.1.m1.1.1.2">𝛼</ci><cn type="integer" id="A2.SS2.p3.1.m1.1.1.3.cmml" xref="A2.SS2.p3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p3.1.m1.1c">\alpha_{1}</annotation></semantics></math>; then we sample data distributions for clients 1 and 2 on the remaining data with <math id="A2.SS2.p3.2.m2.1" class="ltx_Math" alttext="\alpha_{2}" display="inline"><semantics id="A2.SS2.p3.2.m2.1a"><msub id="A2.SS2.p3.2.m2.1.1" xref="A2.SS2.p3.2.m2.1.1.cmml"><mi id="A2.SS2.p3.2.m2.1.1.2" xref="A2.SS2.p3.2.m2.1.1.2.cmml">α</mi><mn id="A2.SS2.p3.2.m2.1.1.3" xref="A2.SS2.p3.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A2.SS2.p3.2.m2.1b"><apply id="A2.SS2.p3.2.m2.1.1.cmml" xref="A2.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A2.SS2.p3.2.m2.1.1.1.cmml" xref="A2.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="A2.SS2.p3.2.m2.1.1.2.cmml" xref="A2.SS2.p3.2.m2.1.1.2">𝛼</ci><cn type="integer" id="A2.SS2.p3.2.m2.1.1.3.cmml" xref="A2.SS2.p3.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p3.2.m2.1c">\alpha_{2}</annotation></semantics></math>. We set up three settings with different <math id="A2.SS2.p3.3.m3.2" class="ltx_Math" alttext="\alpha_{1},\alpha_{2}" display="inline"><semantics id="A2.SS2.p3.3.m3.2a"><mrow id="A2.SS2.p3.3.m3.2.2.2" xref="A2.SS2.p3.3.m3.2.2.3.cmml"><msub id="A2.SS2.p3.3.m3.1.1.1.1" xref="A2.SS2.p3.3.m3.1.1.1.1.cmml"><mi id="A2.SS2.p3.3.m3.1.1.1.1.2" xref="A2.SS2.p3.3.m3.1.1.1.1.2.cmml">α</mi><mn id="A2.SS2.p3.3.m3.1.1.1.1.3" xref="A2.SS2.p3.3.m3.1.1.1.1.3.cmml">1</mn></msub><mo id="A2.SS2.p3.3.m3.2.2.2.3" xref="A2.SS2.p3.3.m3.2.2.3.cmml">,</mo><msub id="A2.SS2.p3.3.m3.2.2.2.2" xref="A2.SS2.p3.3.m3.2.2.2.2.cmml"><mi id="A2.SS2.p3.3.m3.2.2.2.2.2" xref="A2.SS2.p3.3.m3.2.2.2.2.2.cmml">α</mi><mn id="A2.SS2.p3.3.m3.2.2.2.2.3" xref="A2.SS2.p3.3.m3.2.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p3.3.m3.2b"><list id="A2.SS2.p3.3.m3.2.2.3.cmml" xref="A2.SS2.p3.3.m3.2.2.2"><apply id="A2.SS2.p3.3.m3.1.1.1.1.cmml" xref="A2.SS2.p3.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="A2.SS2.p3.3.m3.1.1.1.1.1.cmml" xref="A2.SS2.p3.3.m3.1.1.1.1">subscript</csymbol><ci id="A2.SS2.p3.3.m3.1.1.1.1.2.cmml" xref="A2.SS2.p3.3.m3.1.1.1.1.2">𝛼</ci><cn type="integer" id="A2.SS2.p3.3.m3.1.1.1.1.3.cmml" xref="A2.SS2.p3.3.m3.1.1.1.1.3">1</cn></apply><apply id="A2.SS2.p3.3.m3.2.2.2.2.cmml" xref="A2.SS2.p3.3.m3.2.2.2.2"><csymbol cd="ambiguous" id="A2.SS2.p3.3.m3.2.2.2.2.1.cmml" xref="A2.SS2.p3.3.m3.2.2.2.2">subscript</csymbol><ci id="A2.SS2.p3.3.m3.2.2.2.2.2.cmml" xref="A2.SS2.p3.3.m3.2.2.2.2.2">𝛼</ci><cn type="integer" id="A2.SS2.p3.3.m3.2.2.2.2.3.cmml" xref="A2.SS2.p3.3.m3.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p3.3.m3.2c">\alpha_{1},\alpha_{2}</annotation></semantics></math> and illustrate the data distributions on the <span id="A2.SS2.p3.5.2" class="ltx_text ltx_font_bold">Left column</span> in <a href="#A2.F12" title="Figure 12 ‣ B.2 Client Coherence ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 12</span></a>. In the example, the aggregation weights (AWs) are <math id="A2.SS2.p3.4.m4.3" class="ltx_Math" alttext="[\lambda_{0},\lambda_{1},\lambda_{2}]" display="inline"><semantics id="A2.SS2.p3.4.m4.3a"><mrow id="A2.SS2.p3.4.m4.3.3.3" xref="A2.SS2.p3.4.m4.3.3.4.cmml"><mo stretchy="false" id="A2.SS2.p3.4.m4.3.3.3.4" xref="A2.SS2.p3.4.m4.3.3.4.cmml">[</mo><msub id="A2.SS2.p3.4.m4.1.1.1.1" xref="A2.SS2.p3.4.m4.1.1.1.1.cmml"><mi id="A2.SS2.p3.4.m4.1.1.1.1.2" xref="A2.SS2.p3.4.m4.1.1.1.1.2.cmml">λ</mi><mn id="A2.SS2.p3.4.m4.1.1.1.1.3" xref="A2.SS2.p3.4.m4.1.1.1.1.3.cmml">0</mn></msub><mo id="A2.SS2.p3.4.m4.3.3.3.5" xref="A2.SS2.p3.4.m4.3.3.4.cmml">,</mo><msub id="A2.SS2.p3.4.m4.2.2.2.2" xref="A2.SS2.p3.4.m4.2.2.2.2.cmml"><mi id="A2.SS2.p3.4.m4.2.2.2.2.2" xref="A2.SS2.p3.4.m4.2.2.2.2.2.cmml">λ</mi><mn id="A2.SS2.p3.4.m4.2.2.2.2.3" xref="A2.SS2.p3.4.m4.2.2.2.2.3.cmml">1</mn></msub><mo id="A2.SS2.p3.4.m4.3.3.3.6" xref="A2.SS2.p3.4.m4.3.3.4.cmml">,</mo><msub id="A2.SS2.p3.4.m4.3.3.3.3" xref="A2.SS2.p3.4.m4.3.3.3.3.cmml"><mi id="A2.SS2.p3.4.m4.3.3.3.3.2" xref="A2.SS2.p3.4.m4.3.3.3.3.2.cmml">λ</mi><mn id="A2.SS2.p3.4.m4.3.3.3.3.3" xref="A2.SS2.p3.4.m4.3.3.3.3.3.cmml">2</mn></msub><mo stretchy="false" id="A2.SS2.p3.4.m4.3.3.3.7" xref="A2.SS2.p3.4.m4.3.3.4.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p3.4.m4.3b"><list id="A2.SS2.p3.4.m4.3.3.4.cmml" xref="A2.SS2.p3.4.m4.3.3.3"><apply id="A2.SS2.p3.4.m4.1.1.1.1.cmml" xref="A2.SS2.p3.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="A2.SS2.p3.4.m4.1.1.1.1.1.cmml" xref="A2.SS2.p3.4.m4.1.1.1.1">subscript</csymbol><ci id="A2.SS2.p3.4.m4.1.1.1.1.2.cmml" xref="A2.SS2.p3.4.m4.1.1.1.1.2">𝜆</ci><cn type="integer" id="A2.SS2.p3.4.m4.1.1.1.1.3.cmml" xref="A2.SS2.p3.4.m4.1.1.1.1.3">0</cn></apply><apply id="A2.SS2.p3.4.m4.2.2.2.2.cmml" xref="A2.SS2.p3.4.m4.2.2.2.2"><csymbol cd="ambiguous" id="A2.SS2.p3.4.m4.2.2.2.2.1.cmml" xref="A2.SS2.p3.4.m4.2.2.2.2">subscript</csymbol><ci id="A2.SS2.p3.4.m4.2.2.2.2.2.cmml" xref="A2.SS2.p3.4.m4.2.2.2.2.2">𝜆</ci><cn type="integer" id="A2.SS2.p3.4.m4.2.2.2.2.3.cmml" xref="A2.SS2.p3.4.m4.2.2.2.2.3">1</cn></apply><apply id="A2.SS2.p3.4.m4.3.3.3.3.cmml" xref="A2.SS2.p3.4.m4.3.3.3.3"><csymbol cd="ambiguous" id="A2.SS2.p3.4.m4.3.3.3.3.1.cmml" xref="A2.SS2.p3.4.m4.3.3.3.3">subscript</csymbol><ci id="A2.SS2.p3.4.m4.3.3.3.3.2.cmml" xref="A2.SS2.p3.4.m4.3.3.3.3.2">𝜆</ci><cn type="integer" id="A2.SS2.p3.4.m4.3.3.3.3.3.cmml" xref="A2.SS2.p3.4.m4.3.3.3.3.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p3.4.m4.3c">[\lambda_{0},\lambda_{1},\lambda_{2}]</annotation></semantics></math>, we regularize the weights as <math id="A2.SS2.p3.5.m5.1" class="ltx_Math" alttext="\lambda_{0}+\lambda_{1}+\lambda_{2}=1" display="inline"><semantics id="A2.SS2.p3.5.m5.1a"><mrow id="A2.SS2.p3.5.m5.1.1" xref="A2.SS2.p3.5.m5.1.1.cmml"><mrow id="A2.SS2.p3.5.m5.1.1.2" xref="A2.SS2.p3.5.m5.1.1.2.cmml"><msub id="A2.SS2.p3.5.m5.1.1.2.2" xref="A2.SS2.p3.5.m5.1.1.2.2.cmml"><mi id="A2.SS2.p3.5.m5.1.1.2.2.2" xref="A2.SS2.p3.5.m5.1.1.2.2.2.cmml">λ</mi><mn id="A2.SS2.p3.5.m5.1.1.2.2.3" xref="A2.SS2.p3.5.m5.1.1.2.2.3.cmml">0</mn></msub><mo id="A2.SS2.p3.5.m5.1.1.2.1" xref="A2.SS2.p3.5.m5.1.1.2.1.cmml">+</mo><msub id="A2.SS2.p3.5.m5.1.1.2.3" xref="A2.SS2.p3.5.m5.1.1.2.3.cmml"><mi id="A2.SS2.p3.5.m5.1.1.2.3.2" xref="A2.SS2.p3.5.m5.1.1.2.3.2.cmml">λ</mi><mn id="A2.SS2.p3.5.m5.1.1.2.3.3" xref="A2.SS2.p3.5.m5.1.1.2.3.3.cmml">1</mn></msub><mo id="A2.SS2.p3.5.m5.1.1.2.1a" xref="A2.SS2.p3.5.m5.1.1.2.1.cmml">+</mo><msub id="A2.SS2.p3.5.m5.1.1.2.4" xref="A2.SS2.p3.5.m5.1.1.2.4.cmml"><mi id="A2.SS2.p3.5.m5.1.1.2.4.2" xref="A2.SS2.p3.5.m5.1.1.2.4.2.cmml">λ</mi><mn id="A2.SS2.p3.5.m5.1.1.2.4.3" xref="A2.SS2.p3.5.m5.1.1.2.4.3.cmml">2</mn></msub></mrow><mo id="A2.SS2.p3.5.m5.1.1.1" xref="A2.SS2.p3.5.m5.1.1.1.cmml">=</mo><mn id="A2.SS2.p3.5.m5.1.1.3" xref="A2.SS2.p3.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p3.5.m5.1b"><apply id="A2.SS2.p3.5.m5.1.1.cmml" xref="A2.SS2.p3.5.m5.1.1"><eq id="A2.SS2.p3.5.m5.1.1.1.cmml" xref="A2.SS2.p3.5.m5.1.1.1"></eq><apply id="A2.SS2.p3.5.m5.1.1.2.cmml" xref="A2.SS2.p3.5.m5.1.1.2"><plus id="A2.SS2.p3.5.m5.1.1.2.1.cmml" xref="A2.SS2.p3.5.m5.1.1.2.1"></plus><apply id="A2.SS2.p3.5.m5.1.1.2.2.cmml" xref="A2.SS2.p3.5.m5.1.1.2.2"><csymbol cd="ambiguous" id="A2.SS2.p3.5.m5.1.1.2.2.1.cmml" xref="A2.SS2.p3.5.m5.1.1.2.2">subscript</csymbol><ci id="A2.SS2.p3.5.m5.1.1.2.2.2.cmml" xref="A2.SS2.p3.5.m5.1.1.2.2.2">𝜆</ci><cn type="integer" id="A2.SS2.p3.5.m5.1.1.2.2.3.cmml" xref="A2.SS2.p3.5.m5.1.1.2.2.3">0</cn></apply><apply id="A2.SS2.p3.5.m5.1.1.2.3.cmml" xref="A2.SS2.p3.5.m5.1.1.2.3"><csymbol cd="ambiguous" id="A2.SS2.p3.5.m5.1.1.2.3.1.cmml" xref="A2.SS2.p3.5.m5.1.1.2.3">subscript</csymbol><ci id="A2.SS2.p3.5.m5.1.1.2.3.2.cmml" xref="A2.SS2.p3.5.m5.1.1.2.3.2">𝜆</ci><cn type="integer" id="A2.SS2.p3.5.m5.1.1.2.3.3.cmml" xref="A2.SS2.p3.5.m5.1.1.2.3.3">1</cn></apply><apply id="A2.SS2.p3.5.m5.1.1.2.4.cmml" xref="A2.SS2.p3.5.m5.1.1.2.4"><csymbol cd="ambiguous" id="A2.SS2.p3.5.m5.1.1.2.4.1.cmml" xref="A2.SS2.p3.5.m5.1.1.2.4">subscript</csymbol><ci id="A2.SS2.p3.5.m5.1.1.2.4.2.cmml" xref="A2.SS2.p3.5.m5.1.1.2.4.2">𝜆</ci><cn type="integer" id="A2.SS2.p3.5.m5.1.1.2.4.3.cmml" xref="A2.SS2.p3.5.m5.1.1.2.4.3">2</cn></apply></apply><cn type="integer" id="A2.SS2.p3.5.m5.1.1.3.cmml" xref="A2.SS2.p3.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p3.5.m5.1c">\lambda_{0}+\lambda_{1}+\lambda_{2}=1</annotation></semantics></math> which is a plane that can be visualized in 2-D. We uniformly sample points on the plane to obtain global models with different AW and compute the test loss, and then the loss landscapes on the plane can be visualized. We implement <span id="A2.SS2.p3.5.3" class="ltx_text ltx_font_smallcaps">FedAvg</span> for 100 rounds and record the loss landscape and the optimal weight on the loss landscape in each round; then we illustrate the loss landscape of round 10 on the <span id="A2.SS2.p3.5.4" class="ltx_text ltx_font_bold">Middle column</span> and the optimal weight trajectory on the <span id="A2.SS2.p3.5.5" class="ltx_text ltx_font_bold">Right column</span> of <a href="#A2.F12" title="Figure 12 ‣ B.2 Client Coherence ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 12</span></a>.</p>
</div>
<div id="A2.SS2.p4" class="ltx_para">
<p id="A2.SS2.p4.1" class="ltx_p">In these settings, clients have different heterogeneity degrees: in the first setting, client 0 has a balanced dataset while the data of clients 1 and 2 are complementary; in the second and third settings, clients 1 and 2 have the same data distribution, which differs from the client 0’s. From <a href="#A2.F12" title="Figure 12 ‣ B.2 Client Coherence ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 12</span></a>, it is evident that the weight of <span id="A2.SS2.p4.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> is biased from optimal weights when heterogeneity degrees vary in clients, we can draw the following conclusions: (1) optimal weight can be viewed as a Gaussian distribution in the aggregation weight hyperplane; (2) the mean of the Gaussian will drift towards to the directions where data are more inter-heterogeneous (for instance, in the third setting, client 0’s major classes are 2, 3 and 8 while client 1 and 2 have rare data on these classes, so client 0’s contribution is more dominant); (3) the variance of the Gaussian is larger in inter-homogeneous direction and is smaller in inter-heterogeneous direction (the variance along the client 1-client 2 direction is large in the second and third settings, because the two clients have inter-homogeneous data; opposite phenomenon is shown in the first setting, where client 1 and 2 have inter-heterogeneous data); (4) the flatness of loss landscape on aggregation weight hyperplane is consistent with the variance of the Gaussian, which means the directions with more significant variance will have flatter curvature in the landscape. From our analysis, it is clear that clients’ contributions to the global model should not be solely measured by dataset size, and the heterogeneity degree should also be taken into account. And we observe that in a more heterogeneous environment, the loss landscape is sharper, which means the bias from optimal weight will cause more generalization drop. In other words, in a heterogeneous environment, appropriate aggregation weight matters more.</p>
</div>
<figure id="A2.F12" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2302.10911/assets/x23.png" id="A2.F12.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="129" height="127" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2302.10911/assets/x24.png" id="A2.F12.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="161" height="140" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2302.10911/assets/x25.png" id="A2.F12.g3" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="161" height="140" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2302.10911/assets/x26.png" id="A2.F12.g4" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="129" height="127" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2302.10911/assets/x27.png" id="A2.F12.g5" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="161" height="140" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2302.10911/assets/x28.png" id="A2.F12.g6" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="161" height="140" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2302.10911/assets/x29.png" id="A2.F12.g7" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="129" height="127" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2302.10911/assets/x30.png" id="A2.F12.g8" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="161" height="140" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2302.10911/assets/x31.png" id="A2.F12.g9" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="161" height="140" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span><span id="A2.F12.7.1" class="ltx_text ltx_font_bold">Heterogeneity also affects the optimal aggregation weight.</span> A three-node toy example on CIFAR-10 is shown. <span id="A2.F12.8.2" class="ltx_text ltx_font_bold">Left:</span> Data distribution of each client, note that each client has the same dataset size. <span id="A2.F12.9.3" class="ltx_text ltx_font_bold">Middle:</span> Loss landscape on the plane of aggregation weight, it is noticed that <span id="A2.F12.10.4" class="ltx_text ltx_font_smallcaps">FedAvg</span> is off the optimal and the landscape has various flatness in different directions. <span id="A2.F12.11.5" class="ltx_text ltx_font_bold">Right:</span> optimal weight trajectory during training. We plot the optimal weights in each round (green dots) and find that the optimal weights are biased from <span id="A2.F12.12.6" class="ltx_text ltx_font_smallcaps">FedAvg</span>.</figcaption>
</figure>
<div id="A2.SS2.p5" class="ltx_para">
<p id="A2.SS2.p5.2" class="ltx_p"><span id="A2.SS2.p5.2.1" class="ltx_text ltx_font_bold">Visualization of the hybrid NonIID setting of <a href="#S4.F5" title="Figure 5 ‣ 4.2 Adaptive Global Weight Shrinking and Training Dynamics ‣ 4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 5</span></a>.</span> We visualize the hybrid NonIID setting of <a href="#S4.F5" title="Figure 5 ‣ 4.2 Adaptive Global Weight Shrinking and Training Dynamics ‣ 4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 5</span></a> in <a href="#A2.F13" title="Figure 13 ‣ B.2 Client Coherence ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 13</span></a>. We take <math id="A2.SS2.p5.1.m1.1" class="ltx_Math" alttext="\alpha_{1}=10" display="inline"><semantics id="A2.SS2.p5.1.m1.1a"><mrow id="A2.SS2.p5.1.m1.1.1" xref="A2.SS2.p5.1.m1.1.1.cmml"><msub id="A2.SS2.p5.1.m1.1.1.2" xref="A2.SS2.p5.1.m1.1.1.2.cmml"><mi id="A2.SS2.p5.1.m1.1.1.2.2" xref="A2.SS2.p5.1.m1.1.1.2.2.cmml">α</mi><mn id="A2.SS2.p5.1.m1.1.1.2.3" xref="A2.SS2.p5.1.m1.1.1.2.3.cmml">1</mn></msub><mo id="A2.SS2.p5.1.m1.1.1.1" xref="A2.SS2.p5.1.m1.1.1.1.cmml">=</mo><mn id="A2.SS2.p5.1.m1.1.1.3" xref="A2.SS2.p5.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p5.1.m1.1b"><apply id="A2.SS2.p5.1.m1.1.1.cmml" xref="A2.SS2.p5.1.m1.1.1"><eq id="A2.SS2.p5.1.m1.1.1.1.cmml" xref="A2.SS2.p5.1.m1.1.1.1"></eq><apply id="A2.SS2.p5.1.m1.1.1.2.cmml" xref="A2.SS2.p5.1.m1.1.1.2"><csymbol cd="ambiguous" id="A2.SS2.p5.1.m1.1.1.2.1.cmml" xref="A2.SS2.p5.1.m1.1.1.2">subscript</csymbol><ci id="A2.SS2.p5.1.m1.1.1.2.2.cmml" xref="A2.SS2.p5.1.m1.1.1.2.2">𝛼</ci><cn type="integer" id="A2.SS2.p5.1.m1.1.1.2.3.cmml" xref="A2.SS2.p5.1.m1.1.1.2.3">1</cn></apply><cn type="integer" id="A2.SS2.p5.1.m1.1.1.3.cmml" xref="A2.SS2.p5.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p5.1.m1.1c">\alpha_{1}=10</annotation></semantics></math> and <math id="A2.SS2.p5.2.m2.1" class="ltx_Math" alttext="\alpha_{2}=0.1" display="inline"><semantics id="A2.SS2.p5.2.m2.1a"><mrow id="A2.SS2.p5.2.m2.1.1" xref="A2.SS2.p5.2.m2.1.1.cmml"><msub id="A2.SS2.p5.2.m2.1.1.2" xref="A2.SS2.p5.2.m2.1.1.2.cmml"><mi id="A2.SS2.p5.2.m2.1.1.2.2" xref="A2.SS2.p5.2.m2.1.1.2.2.cmml">α</mi><mn id="A2.SS2.p5.2.m2.1.1.2.3" xref="A2.SS2.p5.2.m2.1.1.2.3.cmml">2</mn></msub><mo id="A2.SS2.p5.2.m2.1.1.1" xref="A2.SS2.p5.2.m2.1.1.1.cmml">=</mo><mn id="A2.SS2.p5.2.m2.1.1.3" xref="A2.SS2.p5.2.m2.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p5.2.m2.1b"><apply id="A2.SS2.p5.2.m2.1.1.cmml" xref="A2.SS2.p5.2.m2.1.1"><eq id="A2.SS2.p5.2.m2.1.1.1.cmml" xref="A2.SS2.p5.2.m2.1.1.1"></eq><apply id="A2.SS2.p5.2.m2.1.1.2.cmml" xref="A2.SS2.p5.2.m2.1.1.2"><csymbol cd="ambiguous" id="A2.SS2.p5.2.m2.1.1.2.1.cmml" xref="A2.SS2.p5.2.m2.1.1.2">subscript</csymbol><ci id="A2.SS2.p5.2.m2.1.1.2.2.cmml" xref="A2.SS2.p5.2.m2.1.1.2.2">𝛼</ci><cn type="integer" id="A2.SS2.p5.2.m2.1.1.2.3.cmml" xref="A2.SS2.p5.2.m2.1.1.2.3">2</cn></apply><cn type="float" id="A2.SS2.p5.2.m2.1.1.3.cmml" xref="A2.SS2.p5.2.m2.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p5.2.m2.1c">\alpha_{2}=0.1</annotation></semantics></math>, so the first 10 clients (indexed 0-9) have class-balanced data while the last 10 clients (indexed 10-19) have class-imbalanced data.</p>
</div>
<figure id="A2.F13" class="ltx_figure"><img src="/html/2302.10911/assets/x32.png" id="A2.F13.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="322" height="186" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13: </span><span id="A2.F13.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Data distribution of <a href="#S4.F5" title="Figure 5 ‣ 4.2 Adaptive Global Weight Shrinking and Training Dynamics ‣ 4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 5</span></a></span></figcaption>
</figure>
<figure id="A2.T11" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 11: </span><span id="A2.T11.8.1" class="ltx_text ltx_font_bold">Pearson correlation coefficient analysis of AW.</span> Heterogeneity degree is calculated as the reciprocal of the variance of class distribution for each client. We take the accumulated weights during the training as clients’ AW.</figcaption>
<table id="A2.T11.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A2.T11.3.3" class="ltx_tr">
<th id="A2.T11.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt"><span id="A2.T11.3.3.4.1" class="ltx_text" style="font-size:90%;">Factors</span></th>
<th id="A2.T11.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><math id="A2.T11.1.1.1.m1.1" class="ltx_Math" alttext="E=1" display="inline"><semantics id="A2.T11.1.1.1.m1.1a"><mrow id="A2.T11.1.1.1.m1.1.1" xref="A2.T11.1.1.1.m1.1.1.cmml"><mi mathsize="90%" id="A2.T11.1.1.1.m1.1.1.2" xref="A2.T11.1.1.1.m1.1.1.2.cmml">E</mi><mo mathsize="90%" id="A2.T11.1.1.1.m1.1.1.1" xref="A2.T11.1.1.1.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="A2.T11.1.1.1.m1.1.1.3" xref="A2.T11.1.1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T11.1.1.1.m1.1b"><apply id="A2.T11.1.1.1.m1.1.1.cmml" xref="A2.T11.1.1.1.m1.1.1"><eq id="A2.T11.1.1.1.m1.1.1.1.cmml" xref="A2.T11.1.1.1.m1.1.1.1"></eq><ci id="A2.T11.1.1.1.m1.1.1.2.cmml" xref="A2.T11.1.1.1.m1.1.1.2">𝐸</ci><cn type="integer" id="A2.T11.1.1.1.m1.1.1.3.cmml" xref="A2.T11.1.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T11.1.1.1.m1.1c">E=1</annotation></semantics></math></th>
<th id="A2.T11.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><math id="A2.T11.2.2.2.m1.1" class="ltx_Math" alttext="E=5" display="inline"><semantics id="A2.T11.2.2.2.m1.1a"><mrow id="A2.T11.2.2.2.m1.1.1" xref="A2.T11.2.2.2.m1.1.1.cmml"><mi mathsize="90%" id="A2.T11.2.2.2.m1.1.1.2" xref="A2.T11.2.2.2.m1.1.1.2.cmml">E</mi><mo mathsize="90%" id="A2.T11.2.2.2.m1.1.1.1" xref="A2.T11.2.2.2.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="A2.T11.2.2.2.m1.1.1.3" xref="A2.T11.2.2.2.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T11.2.2.2.m1.1b"><apply id="A2.T11.2.2.2.m1.1.1.cmml" xref="A2.T11.2.2.2.m1.1.1"><eq id="A2.T11.2.2.2.m1.1.1.1.cmml" xref="A2.T11.2.2.2.m1.1.1.1"></eq><ci id="A2.T11.2.2.2.m1.1.1.2.cmml" xref="A2.T11.2.2.2.m1.1.1.2">𝐸</ci><cn type="integer" id="A2.T11.2.2.2.m1.1.1.3.cmml" xref="A2.T11.2.2.2.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T11.2.2.2.m1.1c">E=5</annotation></semantics></math></th>
<th id="A2.T11.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><math id="A2.T11.3.3.3.m1.1" class="ltx_Math" alttext="E=1\&amp;E=5" display="inline"><semantics id="A2.T11.3.3.3.m1.1a"><mrow id="A2.T11.3.3.3.m1.1.1" xref="A2.T11.3.3.3.m1.1.1.cmml"><mi mathsize="90%" id="A2.T11.3.3.3.m1.1.1.2" xref="A2.T11.3.3.3.m1.1.1.2.cmml">E</mi><mo mathsize="90%" id="A2.T11.3.3.3.m1.1.1.3" xref="A2.T11.3.3.3.m1.1.1.3.cmml">=</mo><mrow id="A2.T11.3.3.3.m1.1.1.4" xref="A2.T11.3.3.3.m1.1.1.4.cmml"><mn mathsize="90%" id="A2.T11.3.3.3.m1.1.1.4.2" xref="A2.T11.3.3.3.m1.1.1.4.2.cmml">1</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="A2.T11.3.3.3.m1.1.1.4.1" xref="A2.T11.3.3.3.m1.1.1.4.1.cmml">&amp;</mo><mi mathsize="90%" id="A2.T11.3.3.3.m1.1.1.4.3" xref="A2.T11.3.3.3.m1.1.1.4.3.cmml">E</mi></mrow><mo mathsize="90%" id="A2.T11.3.3.3.m1.1.1.5" xref="A2.T11.3.3.3.m1.1.1.5.cmml">=</mo><mn mathsize="90%" id="A2.T11.3.3.3.m1.1.1.6" xref="A2.T11.3.3.3.m1.1.1.6.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T11.3.3.3.m1.1b"><apply id="A2.T11.3.3.3.m1.1.1.cmml" xref="A2.T11.3.3.3.m1.1.1"><and id="A2.T11.3.3.3.m1.1.1a.cmml" xref="A2.T11.3.3.3.m1.1.1"></and><apply id="A2.T11.3.3.3.m1.1.1b.cmml" xref="A2.T11.3.3.3.m1.1.1"><eq id="A2.T11.3.3.3.m1.1.1.3.cmml" xref="A2.T11.3.3.3.m1.1.1.3"></eq><ci id="A2.T11.3.3.3.m1.1.1.2.cmml" xref="A2.T11.3.3.3.m1.1.1.2">𝐸</ci><apply id="A2.T11.3.3.3.m1.1.1.4.cmml" xref="A2.T11.3.3.3.m1.1.1.4"><and id="A2.T11.3.3.3.m1.1.1.4.1.cmml" xref="A2.T11.3.3.3.m1.1.1.4.1"></and><cn type="integer" id="A2.T11.3.3.3.m1.1.1.4.2.cmml" xref="A2.T11.3.3.3.m1.1.1.4.2">1</cn><ci id="A2.T11.3.3.3.m1.1.1.4.3.cmml" xref="A2.T11.3.3.3.m1.1.1.4.3">𝐸</ci></apply></apply><apply id="A2.T11.3.3.3.m1.1.1c.cmml" xref="A2.T11.3.3.3.m1.1.1"><eq id="A2.T11.3.3.3.m1.1.1.5.cmml" xref="A2.T11.3.3.3.m1.1.1.5"></eq><share href="#A2.T11.3.3.3.m1.1.1.4.cmml" id="A2.T11.3.3.3.m1.1.1d.cmml" xref="A2.T11.3.3.3.m1.1.1"></share><cn type="integer" id="A2.T11.3.3.3.m1.1.1.6.cmml" xref="A2.T11.3.3.3.m1.1.1.6">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T11.3.3.3.m1.1c">E=1\&amp;E=5</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A2.T11.4.5.1" class="ltx_tr">
<th id="A2.T11.4.5.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="A2.T11.4.5.1.1.1" class="ltx_text" style="font-size:90%;">Dataset size (DS)</span></th>
<td id="A2.T11.4.5.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T11.4.5.1.2.1" class="ltx_text" style="font-size:90%;">-0.098</span></td>
<td id="A2.T11.4.5.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T11.4.5.1.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.21</span></td>
<td id="A2.T11.4.5.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T11.4.5.1.4.1" class="ltx_text" style="font-size:90%;">0.035</span></td>
</tr>
<tr id="A2.T11.4.6.2" class="ltx_tr">
<th id="A2.T11.4.6.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="A2.T11.4.6.2.1.1" class="ltx_text" style="font-size:90%;">Heterogeneity degree (HD)</span></th>
<td id="A2.T11.4.6.2.2" class="ltx_td ltx_align_center"><span id="A2.T11.4.6.2.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.41</span></td>
<td id="A2.T11.4.6.2.3" class="ltx_td ltx_align_center"><span id="A2.T11.4.6.2.3.1" class="ltx_text" style="font-size:90%;">0.024</span></td>
<td id="A2.T11.4.6.2.4" class="ltx_td ltx_align_center"><span id="A2.T11.4.6.2.4.1" class="ltx_text" style="font-size:90%;">0.35</span></td>
</tr>
<tr id="A2.T11.4.4" class="ltx_tr">
<th id="A2.T11.4.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r">
<span id="A2.T11.4.4.1.1" class="ltx_text" style="font-size:90%;">DS</span><math id="A2.T11.4.4.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A2.T11.4.4.1.m1.1a"><mo mathsize="90%" id="A2.T11.4.4.1.m1.1.1" xref="A2.T11.4.4.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.T11.4.4.1.m1.1b"><times id="A2.T11.4.4.1.m1.1.1.cmml" xref="A2.T11.4.4.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.T11.4.4.1.m1.1c">\times</annotation></semantics></math><span id="A2.T11.4.4.1.2" class="ltx_text" style="font-size:90%;">HD</span>
</th>
<td id="A2.T11.4.4.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="A2.T11.4.4.2.1" class="ltx_text" style="font-size:90%;">0.26</span></td>
<td id="A2.T11.4.4.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="A2.T11.4.4.3.1" class="ltx_text" style="font-size:90%;">0.17</span></td>
<td id="A2.T11.4.4.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="A2.T11.4.4.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.31</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="A2.SS2.p6" class="ltx_para">
<p id="A2.SS2.p6.1" class="ltx_p"><span id="A2.SS2.p6.1.1" class="ltx_text ltx_font_bold">Data size or heterogeneity? A correlation analysis.</span> Data size and heterogeneity all affect clients’ contributions to the global model, but which affects it most? As in previous literature, the importance is depicted by the dataset size that clients with more data will be assigned larger weights. According to the analysis in <a href="#A2.F12" title="Figure 12 ‣ B.2 Client Coherence ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 12</span></a>, the importance of weight may be associated with the heterogeneity degrees of clients. To explore which factor is more dominant in the AW optimized by attentive LAW, we have made a Pearson correlation coefficient analysis in <a href="#A2.T11" title="Table 11 ‣ B.2 Client Coherence ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 11</span></a>. Results show that dataset size is more dominant when the local epoch is large; otherwise, the heterogeneity degree. This phenomenon is intuitive: when the local epoch increases, clients with a larger dataset will have more local iterations than others <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib48" title="" class="ltx_ref">2020b</a>)</cite>, so their updates are more dominant. In the cases where the local epoch is small, clients’ updates are of similar volumes; here the updates’ directions are much more important since balanced clients are prone to have stronger coherence, and their AWs are larger in model aggregation. We combine two factors by multiplication, and the result shows that the combined indicator is more dominant when the two cases are mixed.</p>
</div>
</section>
<section id="A2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3 </span>Learning curves of FedLAW and baselines</h3>

<div id="A2.SS3.p1" class="ltx_para">
<p id="A2.SS3.p1.1" class="ltx_p">We add the test accuracy curves to show the learning processes of the algorithms and visualize them in <a href="#A2.F15" title="Figure 15 ‣ B.3 Learning curves of FedLAW and baselines ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 15</span></a> (FasionMNIST), <a href="#A2.F16" title="Figure 16 ‣ B.3 Learning curves of FedLAW and baselines ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 16</span></a> (CIFAR-10), and <a href="#A2.F17" title="Figure 17 ‣ B.3 Learning curves of FedLAW and baselines ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 17</span></a> (CIFAR-100). The curves are according to the results in <a href="#S5.T3" title="Table 3 ‣ 5.2 Attentive Learnable Aggregation Weight and Training Dynamics ‣ 5 Client coherence ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 3</span></a>. It shows that <span id="A2.SS3.p1.1.1" class="ltx_text ltx_font_smallcaps">FedLAW</span> surpasses the baseline algorithms in most cases. Besides, <span id="A2.SS3.p1.1.2" class="ltx_text ltx_font_smallcaps">FedLAW</span> is steady in the learning curves and it avoids over-fitting in the late training.</p>
</div>
<div id="A2.SS3.p2" class="ltx_para">
<p id="A2.SS3.p2.4" class="ltx_p">We also visualize the server training process of FedLAW in <a href="#A2.F14" title="Figure 14 ‣ B.3 Learning curves of FedLAW and baselines ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 14</span></a>. It is found that <math id="A2.SS3.p2.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A2.SS3.p2.1.m1.1a"><mi id="A2.SS3.p2.1.m1.1.1" xref="A2.SS3.p2.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A2.SS3.p2.1.m1.1b"><ci id="A2.SS3.p2.1.m1.1.1.cmml" xref="A2.SS3.p2.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p2.1.m1.1c">\gamma</annotation></semantics></math> converges faster than <math id="A2.SS3.p2.2.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="A2.SS3.p2.2.m2.1a"><mi id="A2.SS3.p2.2.m2.1.1" xref="A2.SS3.p2.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A2.SS3.p2.2.m2.1b"><ci id="A2.SS3.p2.2.m2.1.1.cmml" xref="A2.SS3.p2.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p2.2.m2.1c">\lambda</annotation></semantics></math>. For <math id="A2.SS3.p2.3.m3.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A2.SS3.p2.3.m3.1a"><mi id="A2.SS3.p2.3.m3.1.1" xref="A2.SS3.p2.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A2.SS3.p2.3.m3.1b"><ci id="A2.SS3.p2.3.m3.1.1.cmml" xref="A2.SS3.p2.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p2.3.m3.1c">\gamma</annotation></semantics></math>, it converges to the optimal value in about 30 server epochs, while for <math id="A2.SS3.p2.4.m4.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="A2.SS3.p2.4.m4.1a"><mi id="A2.SS3.p2.4.m4.1.1" xref="A2.SS3.p2.4.m4.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A2.SS3.p2.4.m4.1b"><ci id="A2.SS3.p2.4.m4.1.1.cmml" xref="A2.SS3.p2.4.m4.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p2.4.m4.1c">\lambda</annotation></semantics></math>, it needs 80 epochs to fully converge.</p>
</div>
<figure id="A2.F14" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2302.10911/assets/x33.png" id="A2.F14.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="138" height="116" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2302.10911/assets/x34.png" id="A2.F14.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="138" height="116" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2302.10911/assets/x35.png" id="A2.F14.g3" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="138" height="116" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2302.10911/assets/x36.png" id="A2.F14.g4" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="138" height="116" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2302.10911/assets/x37.png" id="A2.F14.g5" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="138" height="114" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/2302.10911/assets/x38.png" id="A2.F14.g6" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="138" height="116" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 14: </span><span id="A2.F14.6.3" class="ltx_text ltx_font_bold" style="font-size:90%;">Server training visualization of <span id="A2.F14.6.3.4" class="ltx_text ltx_font_smallcaps">FedLAW</span>.<span id="A2.F14.6.3.3" class="ltx_text ltx_font_medium"> CIFAR10, <math id="A2.F14.4.1.1.m1.1" class="ltx_Math" alttext="n=20" display="inline"><semantics id="A2.F14.4.1.1.m1.1b"><mrow id="A2.F14.4.1.1.m1.1.1" xref="A2.F14.4.1.1.m1.1.1.cmml"><mi id="A2.F14.4.1.1.m1.1.1.2" xref="A2.F14.4.1.1.m1.1.1.2.cmml">n</mi><mo id="A2.F14.4.1.1.m1.1.1.1" xref="A2.F14.4.1.1.m1.1.1.1.cmml">=</mo><mn id="A2.F14.4.1.1.m1.1.1.3" xref="A2.F14.4.1.1.m1.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F14.4.1.1.m1.1c"><apply id="A2.F14.4.1.1.m1.1.1.cmml" xref="A2.F14.4.1.1.m1.1.1"><eq id="A2.F14.4.1.1.m1.1.1.1.cmml" xref="A2.F14.4.1.1.m1.1.1.1"></eq><ci id="A2.F14.4.1.1.m1.1.1.2.cmml" xref="A2.F14.4.1.1.m1.1.1.2">𝑛</ci><cn type="integer" id="A2.F14.4.1.1.m1.1.1.3.cmml" xref="A2.F14.4.1.1.m1.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F14.4.1.1.m1.1d">n=20</annotation></semantics></math>, <math id="A2.F14.5.2.2.m2.1" class="ltx_Math" alttext="E=3" display="inline"><semantics id="A2.F14.5.2.2.m2.1b"><mrow id="A2.F14.5.2.2.m2.1.1" xref="A2.F14.5.2.2.m2.1.1.cmml"><mi id="A2.F14.5.2.2.m2.1.1.2" xref="A2.F14.5.2.2.m2.1.1.2.cmml">E</mi><mo id="A2.F14.5.2.2.m2.1.1.1" xref="A2.F14.5.2.2.m2.1.1.1.cmml">=</mo><mn id="A2.F14.5.2.2.m2.1.1.3" xref="A2.F14.5.2.2.m2.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F14.5.2.2.m2.1c"><apply id="A2.F14.5.2.2.m2.1.1.cmml" xref="A2.F14.5.2.2.m2.1.1"><eq id="A2.F14.5.2.2.m2.1.1.1.cmml" xref="A2.F14.5.2.2.m2.1.1.1"></eq><ci id="A2.F14.5.2.2.m2.1.1.2.cmml" xref="A2.F14.5.2.2.m2.1.1.2">𝐸</ci><cn type="integer" id="A2.F14.5.2.2.m2.1.1.3.cmml" xref="A2.F14.5.2.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F14.5.2.2.m2.1d">E=3</annotation></semantics></math>, NonIID <math id="A2.F14.6.3.3.m3.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="A2.F14.6.3.3.m3.1b"><mrow id="A2.F14.6.3.3.m3.1.1" xref="A2.F14.6.3.3.m3.1.1.cmml"><mi id="A2.F14.6.3.3.m3.1.1.2" xref="A2.F14.6.3.3.m3.1.1.2.cmml">α</mi><mo id="A2.F14.6.3.3.m3.1.1.1" xref="A2.F14.6.3.3.m3.1.1.1.cmml">=</mo><mn id="A2.F14.6.3.3.m3.1.1.3" xref="A2.F14.6.3.3.m3.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F14.6.3.3.m3.1c"><apply id="A2.F14.6.3.3.m3.1.1.cmml" xref="A2.F14.6.3.3.m3.1.1"><eq id="A2.F14.6.3.3.m3.1.1.1.cmml" xref="A2.F14.6.3.3.m3.1.1.1"></eq><ci id="A2.F14.6.3.3.m3.1.1.2.cmml" xref="A2.F14.6.3.3.m3.1.1.2">𝛼</ci><cn type="float" id="A2.F14.6.3.3.m3.1.1.3.cmml" xref="A2.F14.6.3.3.m3.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F14.6.3.3.m3.1d">\alpha=1.0</annotation></semantics></math>, ResNet20. </span></span></figcaption>
</figure>
<figure id="A2.F15" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2302.10911/assets/x39.png" id="A2.F15.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="226" height="181" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2302.10911/assets/x40.png" id="A2.F15.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="226" height="177" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2302.10911/assets/x41.png" id="A2.F15.g3" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="226" height="177" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2302.10911/assets/x42.png" id="A2.F15.g4" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="226" height="181" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 15: </span><span id="A2.F15.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Test accuracy curves of algorithms under FashionMNIST.<span id="A2.F15.2.1.1" class="ltx_text ltx_font_medium"> According to the results in <a href="#S5.T3" title="Table 3 ‣ 5.2 Attentive Learnable Aggregation Weight and Training Dynamics ‣ 5 Client coherence ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 3</span></a>. </span></span></figcaption>
</figure>
<figure id="A2.F16" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2302.10911/assets/x43.png" id="A2.F16.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="226" height="181" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2302.10911/assets/x44.png" id="A2.F16.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="226" height="177" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2302.10911/assets/x45.png" id="A2.F16.g3" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="226" height="177" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2302.10911/assets/x46.png" id="A2.F16.g4" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="226" height="181" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 16: </span><span id="A2.F16.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Test accuracy curves of algorithms under CIFAR-10.<span id="A2.F16.2.1.1" class="ltx_text ltx_font_medium"> According to the results in <a href="#S5.T3" title="Table 3 ‣ 5.2 Attentive Learnable Aggregation Weight and Training Dynamics ‣ 5 Client coherence ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 3</span></a>. </span></span></figcaption>
</figure>
<figure id="A2.F17" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2302.10911/assets/x47.png" id="A2.F17.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="226" height="181" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2302.10911/assets/x48.png" id="A2.F17.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="226" height="181" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2302.10911/assets/x49.png" id="A2.F17.g3" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="226" height="181" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2302.10911/assets/x50.png" id="A2.F17.g4" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="226" height="177" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 17: </span><span id="A2.F17.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Test accuracy curves of algorithms under CIFAR-100.<span id="A2.F17.2.1.1" class="ltx_text ltx_font_medium"> According to the results in <a href="#S5.T3" title="Table 3 ‣ 5.2 Attentive Learnable Aggregation Weight and Training Dynamics ‣ 5 Client coherence ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 3</span></a>. </span></span></figcaption>
</figure>
</section>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Additional Details of FedLAW</h2>

<div id="A3.p1" class="ltx_para">
<p id="A3.p1.2" class="ltx_p">In <span id="A3.p1.2.1" class="ltx_text ltx_font_smallcaps">FedLAW</span>, we optimize AW on the server as <a href="#S6.E8" title="Equation 8 ‣ 6.1 Method ‣ 6 FedLAW ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Equation 8</span></a>, and there are constraints that <math id="A3.p1.1.m1.3" class="ltx_Math" alttext="\lambda_{i}\geq 0,\|\boldsymbol{\lambda}\|_{1}=1" display="inline"><semantics id="A3.p1.1.m1.3a"><mrow id="A3.p1.1.m1.3.3.2" xref="A3.p1.1.m1.3.3.3.cmml"><mrow id="A3.p1.1.m1.2.2.1.1" xref="A3.p1.1.m1.2.2.1.1.cmml"><msub id="A3.p1.1.m1.2.2.1.1.2" xref="A3.p1.1.m1.2.2.1.1.2.cmml"><mi id="A3.p1.1.m1.2.2.1.1.2.2" xref="A3.p1.1.m1.2.2.1.1.2.2.cmml">λ</mi><mi id="A3.p1.1.m1.2.2.1.1.2.3" xref="A3.p1.1.m1.2.2.1.1.2.3.cmml">i</mi></msub><mo id="A3.p1.1.m1.2.2.1.1.1" xref="A3.p1.1.m1.2.2.1.1.1.cmml">≥</mo><mn id="A3.p1.1.m1.2.2.1.1.3" xref="A3.p1.1.m1.2.2.1.1.3.cmml">0</mn></mrow><mo id="A3.p1.1.m1.3.3.2.3" xref="A3.p1.1.m1.3.3.3a.cmml">,</mo><mrow id="A3.p1.1.m1.3.3.2.2" xref="A3.p1.1.m1.3.3.2.2.cmml"><msub id="A3.p1.1.m1.3.3.2.2.2" xref="A3.p1.1.m1.3.3.2.2.2.cmml"><mrow id="A3.p1.1.m1.3.3.2.2.2.2.2" xref="A3.p1.1.m1.3.3.2.2.2.2.1.cmml"><mo stretchy="false" id="A3.p1.1.m1.3.3.2.2.2.2.2.1" xref="A3.p1.1.m1.3.3.2.2.2.2.1.1.cmml">‖</mo><mi id="A3.p1.1.m1.1.1" xref="A3.p1.1.m1.1.1.cmml">𝝀</mi><mo stretchy="false" id="A3.p1.1.m1.3.3.2.2.2.2.2.2" xref="A3.p1.1.m1.3.3.2.2.2.2.1.1.cmml">‖</mo></mrow><mn id="A3.p1.1.m1.3.3.2.2.2.3" xref="A3.p1.1.m1.3.3.2.2.2.3.cmml">1</mn></msub><mo id="A3.p1.1.m1.3.3.2.2.1" xref="A3.p1.1.m1.3.3.2.2.1.cmml">=</mo><mn id="A3.p1.1.m1.3.3.2.2.3" xref="A3.p1.1.m1.3.3.2.2.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.1.m1.3b"><apply id="A3.p1.1.m1.3.3.3.cmml" xref="A3.p1.1.m1.3.3.2"><csymbol cd="ambiguous" id="A3.p1.1.m1.3.3.3a.cmml" xref="A3.p1.1.m1.3.3.2.3">formulae-sequence</csymbol><apply id="A3.p1.1.m1.2.2.1.1.cmml" xref="A3.p1.1.m1.2.2.1.1"><geq id="A3.p1.1.m1.2.2.1.1.1.cmml" xref="A3.p1.1.m1.2.2.1.1.1"></geq><apply id="A3.p1.1.m1.2.2.1.1.2.cmml" xref="A3.p1.1.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="A3.p1.1.m1.2.2.1.1.2.1.cmml" xref="A3.p1.1.m1.2.2.1.1.2">subscript</csymbol><ci id="A3.p1.1.m1.2.2.1.1.2.2.cmml" xref="A3.p1.1.m1.2.2.1.1.2.2">𝜆</ci><ci id="A3.p1.1.m1.2.2.1.1.2.3.cmml" xref="A3.p1.1.m1.2.2.1.1.2.3">𝑖</ci></apply><cn type="integer" id="A3.p1.1.m1.2.2.1.1.3.cmml" xref="A3.p1.1.m1.2.2.1.1.3">0</cn></apply><apply id="A3.p1.1.m1.3.3.2.2.cmml" xref="A3.p1.1.m1.3.3.2.2"><eq id="A3.p1.1.m1.3.3.2.2.1.cmml" xref="A3.p1.1.m1.3.3.2.2.1"></eq><apply id="A3.p1.1.m1.3.3.2.2.2.cmml" xref="A3.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="A3.p1.1.m1.3.3.2.2.2.1.cmml" xref="A3.p1.1.m1.3.3.2.2.2">subscript</csymbol><apply id="A3.p1.1.m1.3.3.2.2.2.2.1.cmml" xref="A3.p1.1.m1.3.3.2.2.2.2.2"><csymbol cd="latexml" id="A3.p1.1.m1.3.3.2.2.2.2.1.1.cmml" xref="A3.p1.1.m1.3.3.2.2.2.2.2.1">norm</csymbol><ci id="A3.p1.1.m1.1.1.cmml" xref="A3.p1.1.m1.1.1">𝝀</ci></apply><cn type="integer" id="A3.p1.1.m1.3.3.2.2.2.3.cmml" xref="A3.p1.1.m1.3.3.2.2.2.3">1</cn></apply><cn type="integer" id="A3.p1.1.m1.3.3.2.2.3.cmml" xref="A3.p1.1.m1.3.3.2.2.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.1.m1.3c">\lambda_{i}\geq 0,\|\boldsymbol{\lambda}\|_{1}=1</annotation></semantics></math>. To realize these constraints, we adopt base functions in <math id="A3.p1.2.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="A3.p1.2.m2.1a"><mi id="A3.p1.2.m2.1.1" xref="A3.p1.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A3.p1.2.m2.1b"><ci id="A3.p1.2.m2.1.1.cmml" xref="A3.p1.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.2.m2.1c">\lambda</annotation></semantics></math>, and there are two alternatives, the quadratic function and the exponential function.</p>
<table id="A3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A3.E10.m1.1" class="ltx_Math" alttext="\text{Quadratic: }\lambda_{i}=\frac{x_{i}^{2}}{\sum_{j}^{m}x_{j}^{2}};\text{Exponential: }\lambda_{i}=\frac{e^{x_{i}}}{\sum_{j}^{m}e^{x_{j}}}." display="block"><semantics id="A3.E10.m1.1a"><mrow id="A3.E10.m1.1.1.1"><mrow id="A3.E10.m1.1.1.1.1.2" xref="A3.E10.m1.1.1.1.1.3.cmml"><mrow id="A3.E10.m1.1.1.1.1.1.1" xref="A3.E10.m1.1.1.1.1.1.1.cmml"><mrow id="A3.E10.m1.1.1.1.1.1.1.2" xref="A3.E10.m1.1.1.1.1.1.1.2.cmml"><mtext id="A3.E10.m1.1.1.1.1.1.1.2.2" xref="A3.E10.m1.1.1.1.1.1.1.2.2a.cmml">Quadratic: </mtext><mo lspace="0em" rspace="0em" id="A3.E10.m1.1.1.1.1.1.1.2.1" xref="A3.E10.m1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="A3.E10.m1.1.1.1.1.1.1.2.3" xref="A3.E10.m1.1.1.1.1.1.1.2.3.cmml"><mi id="A3.E10.m1.1.1.1.1.1.1.2.3.2" xref="A3.E10.m1.1.1.1.1.1.1.2.3.2.cmml">λ</mi><mi id="A3.E10.m1.1.1.1.1.1.1.2.3.3" xref="A3.E10.m1.1.1.1.1.1.1.2.3.3.cmml">i</mi></msub></mrow><mo id="A3.E10.m1.1.1.1.1.1.1.1" xref="A3.E10.m1.1.1.1.1.1.1.1.cmml">=</mo><mfrac id="A3.E10.m1.1.1.1.1.1.1.3" xref="A3.E10.m1.1.1.1.1.1.1.3.cmml"><msubsup id="A3.E10.m1.1.1.1.1.1.1.3.2" xref="A3.E10.m1.1.1.1.1.1.1.3.2.cmml"><mi id="A3.E10.m1.1.1.1.1.1.1.3.2.2.2" xref="A3.E10.m1.1.1.1.1.1.1.3.2.2.2.cmml">x</mi><mi id="A3.E10.m1.1.1.1.1.1.1.3.2.2.3" xref="A3.E10.m1.1.1.1.1.1.1.3.2.2.3.cmml">i</mi><mn id="A3.E10.m1.1.1.1.1.1.1.3.2.3" xref="A3.E10.m1.1.1.1.1.1.1.3.2.3.cmml">2</mn></msubsup><mrow id="A3.E10.m1.1.1.1.1.1.1.3.3" xref="A3.E10.m1.1.1.1.1.1.1.3.3.cmml"><msubsup id="A3.E10.m1.1.1.1.1.1.1.3.3.1" xref="A3.E10.m1.1.1.1.1.1.1.3.3.1.cmml"><mo id="A3.E10.m1.1.1.1.1.1.1.3.3.1.2.2" xref="A3.E10.m1.1.1.1.1.1.1.3.3.1.2.2.cmml">∑</mo><mi id="A3.E10.m1.1.1.1.1.1.1.3.3.1.2.3" xref="A3.E10.m1.1.1.1.1.1.1.3.3.1.2.3.cmml">j</mi><mi id="A3.E10.m1.1.1.1.1.1.1.3.3.1.3" xref="A3.E10.m1.1.1.1.1.1.1.3.3.1.3.cmml">m</mi></msubsup><msubsup id="A3.E10.m1.1.1.1.1.1.1.3.3.2" xref="A3.E10.m1.1.1.1.1.1.1.3.3.2.cmml"><mi id="A3.E10.m1.1.1.1.1.1.1.3.3.2.2.2" xref="A3.E10.m1.1.1.1.1.1.1.3.3.2.2.2.cmml">x</mi><mi id="A3.E10.m1.1.1.1.1.1.1.3.3.2.2.3" xref="A3.E10.m1.1.1.1.1.1.1.3.3.2.2.3.cmml">j</mi><mn id="A3.E10.m1.1.1.1.1.1.1.3.3.2.3" xref="A3.E10.m1.1.1.1.1.1.1.3.3.2.3.cmml">2</mn></msubsup></mrow></mfrac></mrow><mo id="A3.E10.m1.1.1.1.1.2.3" xref="A3.E10.m1.1.1.1.1.3a.cmml">;</mo><mrow id="A3.E10.m1.1.1.1.1.2.2" xref="A3.E10.m1.1.1.1.1.2.2.cmml"><mrow id="A3.E10.m1.1.1.1.1.2.2.2" xref="A3.E10.m1.1.1.1.1.2.2.2.cmml"><mtext id="A3.E10.m1.1.1.1.1.2.2.2.2" xref="A3.E10.m1.1.1.1.1.2.2.2.2a.cmml">Exponential: </mtext><mo lspace="0em" rspace="0em" id="A3.E10.m1.1.1.1.1.2.2.2.1" xref="A3.E10.m1.1.1.1.1.2.2.2.1.cmml">​</mo><msub id="A3.E10.m1.1.1.1.1.2.2.2.3" xref="A3.E10.m1.1.1.1.1.2.2.2.3.cmml"><mi id="A3.E10.m1.1.1.1.1.2.2.2.3.2" xref="A3.E10.m1.1.1.1.1.2.2.2.3.2.cmml">λ</mi><mi id="A3.E10.m1.1.1.1.1.2.2.2.3.3" xref="A3.E10.m1.1.1.1.1.2.2.2.3.3.cmml">i</mi></msub></mrow><mo id="A3.E10.m1.1.1.1.1.2.2.1" xref="A3.E10.m1.1.1.1.1.2.2.1.cmml">=</mo><mfrac id="A3.E10.m1.1.1.1.1.2.2.3" xref="A3.E10.m1.1.1.1.1.2.2.3.cmml"><msup id="A3.E10.m1.1.1.1.1.2.2.3.2" xref="A3.E10.m1.1.1.1.1.2.2.3.2.cmml"><mi id="A3.E10.m1.1.1.1.1.2.2.3.2.2" xref="A3.E10.m1.1.1.1.1.2.2.3.2.2.cmml">e</mi><msub id="A3.E10.m1.1.1.1.1.2.2.3.2.3" xref="A3.E10.m1.1.1.1.1.2.2.3.2.3.cmml"><mi id="A3.E10.m1.1.1.1.1.2.2.3.2.3.2" xref="A3.E10.m1.1.1.1.1.2.2.3.2.3.2.cmml">x</mi><mi id="A3.E10.m1.1.1.1.1.2.2.3.2.3.3" xref="A3.E10.m1.1.1.1.1.2.2.3.2.3.3.cmml">i</mi></msub></msup><mrow id="A3.E10.m1.1.1.1.1.2.2.3.3" xref="A3.E10.m1.1.1.1.1.2.2.3.3.cmml"><msubsup id="A3.E10.m1.1.1.1.1.2.2.3.3.1" xref="A3.E10.m1.1.1.1.1.2.2.3.3.1.cmml"><mo id="A3.E10.m1.1.1.1.1.2.2.3.3.1.2.2" xref="A3.E10.m1.1.1.1.1.2.2.3.3.1.2.2.cmml">∑</mo><mi id="A3.E10.m1.1.1.1.1.2.2.3.3.1.2.3" xref="A3.E10.m1.1.1.1.1.2.2.3.3.1.2.3.cmml">j</mi><mi id="A3.E10.m1.1.1.1.1.2.2.3.3.1.3" xref="A3.E10.m1.1.1.1.1.2.2.3.3.1.3.cmml">m</mi></msubsup><msup id="A3.E10.m1.1.1.1.1.2.2.3.3.2" xref="A3.E10.m1.1.1.1.1.2.2.3.3.2.cmml"><mi id="A3.E10.m1.1.1.1.1.2.2.3.3.2.2" xref="A3.E10.m1.1.1.1.1.2.2.3.3.2.2.cmml">e</mi><msub id="A3.E10.m1.1.1.1.1.2.2.3.3.2.3" xref="A3.E10.m1.1.1.1.1.2.2.3.3.2.3.cmml"><mi id="A3.E10.m1.1.1.1.1.2.2.3.3.2.3.2" xref="A3.E10.m1.1.1.1.1.2.2.3.3.2.3.2.cmml">x</mi><mi id="A3.E10.m1.1.1.1.1.2.2.3.3.2.3.3" xref="A3.E10.m1.1.1.1.1.2.2.3.3.2.3.3.cmml">j</mi></msub></msup></mrow></mfrac></mrow></mrow><mo lspace="0em" id="A3.E10.m1.1.1.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E10.m1.1b"><apply id="A3.E10.m1.1.1.1.1.3.cmml" xref="A3.E10.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E10.m1.1.1.1.1.3a.cmml" xref="A3.E10.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="A3.E10.m1.1.1.1.1.1.1.cmml" xref="A3.E10.m1.1.1.1.1.1.1"><eq id="A3.E10.m1.1.1.1.1.1.1.1.cmml" xref="A3.E10.m1.1.1.1.1.1.1.1"></eq><apply id="A3.E10.m1.1.1.1.1.1.1.2.cmml" xref="A3.E10.m1.1.1.1.1.1.1.2"><times id="A3.E10.m1.1.1.1.1.1.1.2.1.cmml" xref="A3.E10.m1.1.1.1.1.1.1.2.1"></times><ci id="A3.E10.m1.1.1.1.1.1.1.2.2a.cmml" xref="A3.E10.m1.1.1.1.1.1.1.2.2"><mtext id="A3.E10.m1.1.1.1.1.1.1.2.2.cmml" xref="A3.E10.m1.1.1.1.1.1.1.2.2">Quadratic: </mtext></ci><apply id="A3.E10.m1.1.1.1.1.1.1.2.3.cmml" xref="A3.E10.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A3.E10.m1.1.1.1.1.1.1.2.3.1.cmml" xref="A3.E10.m1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="A3.E10.m1.1.1.1.1.1.1.2.3.2.cmml" xref="A3.E10.m1.1.1.1.1.1.1.2.3.2">𝜆</ci><ci id="A3.E10.m1.1.1.1.1.1.1.2.3.3.cmml" xref="A3.E10.m1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="A3.E10.m1.1.1.1.1.1.1.3.cmml" xref="A3.E10.m1.1.1.1.1.1.1.3"><divide id="A3.E10.m1.1.1.1.1.1.1.3.1.cmml" xref="A3.E10.m1.1.1.1.1.1.1.3"></divide><apply id="A3.E10.m1.1.1.1.1.1.1.3.2.cmml" xref="A3.E10.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A3.E10.m1.1.1.1.1.1.1.3.2.1.cmml" xref="A3.E10.m1.1.1.1.1.1.1.3.2">superscript</csymbol><apply id="A3.E10.m1.1.1.1.1.1.1.3.2.2.cmml" xref="A3.E10.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A3.E10.m1.1.1.1.1.1.1.3.2.2.1.cmml" xref="A3.E10.m1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A3.E10.m1.1.1.1.1.1.1.3.2.2.2.cmml" xref="A3.E10.m1.1.1.1.1.1.1.3.2.2.2">𝑥</ci><ci id="A3.E10.m1.1.1.1.1.1.1.3.2.2.3.cmml" xref="A3.E10.m1.1.1.1.1.1.1.3.2.2.3">𝑖</ci></apply><cn type="integer" id="A3.E10.m1.1.1.1.1.1.1.3.2.3.cmml" xref="A3.E10.m1.1.1.1.1.1.1.3.2.3">2</cn></apply><apply id="A3.E10.m1.1.1.1.1.1.1.3.3.cmml" xref="A3.E10.m1.1.1.1.1.1.1.3.3"><apply id="A3.E10.m1.1.1.1.1.1.1.3.3.1.cmml" xref="A3.E10.m1.1.1.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="A3.E10.m1.1.1.1.1.1.1.3.3.1.1.cmml" xref="A3.E10.m1.1.1.1.1.1.1.3.3.1">superscript</csymbol><apply id="A3.E10.m1.1.1.1.1.1.1.3.3.1.2.cmml" xref="A3.E10.m1.1.1.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="A3.E10.m1.1.1.1.1.1.1.3.3.1.2.1.cmml" xref="A3.E10.m1.1.1.1.1.1.1.3.3.1">subscript</csymbol><sum id="A3.E10.m1.1.1.1.1.1.1.3.3.1.2.2.cmml" xref="A3.E10.m1.1.1.1.1.1.1.3.3.1.2.2"></sum><ci id="A3.E10.m1.1.1.1.1.1.1.3.3.1.2.3.cmml" xref="A3.E10.m1.1.1.1.1.1.1.3.3.1.2.3">𝑗</ci></apply><ci id="A3.E10.m1.1.1.1.1.1.1.3.3.1.3.cmml" xref="A3.E10.m1.1.1.1.1.1.1.3.3.1.3">𝑚</ci></apply><apply id="A3.E10.m1.1.1.1.1.1.1.3.3.2.cmml" xref="A3.E10.m1.1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="A3.E10.m1.1.1.1.1.1.1.3.3.2.1.cmml" xref="A3.E10.m1.1.1.1.1.1.1.3.3.2">superscript</csymbol><apply id="A3.E10.m1.1.1.1.1.1.1.3.3.2.2.cmml" xref="A3.E10.m1.1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="A3.E10.m1.1.1.1.1.1.1.3.3.2.2.1.cmml" xref="A3.E10.m1.1.1.1.1.1.1.3.3.2">subscript</csymbol><ci id="A3.E10.m1.1.1.1.1.1.1.3.3.2.2.2.cmml" xref="A3.E10.m1.1.1.1.1.1.1.3.3.2.2.2">𝑥</ci><ci id="A3.E10.m1.1.1.1.1.1.1.3.3.2.2.3.cmml" xref="A3.E10.m1.1.1.1.1.1.1.3.3.2.2.3">𝑗</ci></apply><cn type="integer" id="A3.E10.m1.1.1.1.1.1.1.3.3.2.3.cmml" xref="A3.E10.m1.1.1.1.1.1.1.3.3.2.3">2</cn></apply></apply></apply></apply><apply id="A3.E10.m1.1.1.1.1.2.2.cmml" xref="A3.E10.m1.1.1.1.1.2.2"><eq id="A3.E10.m1.1.1.1.1.2.2.1.cmml" xref="A3.E10.m1.1.1.1.1.2.2.1"></eq><apply id="A3.E10.m1.1.1.1.1.2.2.2.cmml" xref="A3.E10.m1.1.1.1.1.2.2.2"><times id="A3.E10.m1.1.1.1.1.2.2.2.1.cmml" xref="A3.E10.m1.1.1.1.1.2.2.2.1"></times><ci id="A3.E10.m1.1.1.1.1.2.2.2.2a.cmml" xref="A3.E10.m1.1.1.1.1.2.2.2.2"><mtext id="A3.E10.m1.1.1.1.1.2.2.2.2.cmml" xref="A3.E10.m1.1.1.1.1.2.2.2.2">Exponential: </mtext></ci><apply id="A3.E10.m1.1.1.1.1.2.2.2.3.cmml" xref="A3.E10.m1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="A3.E10.m1.1.1.1.1.2.2.2.3.1.cmml" xref="A3.E10.m1.1.1.1.1.2.2.2.3">subscript</csymbol><ci id="A3.E10.m1.1.1.1.1.2.2.2.3.2.cmml" xref="A3.E10.m1.1.1.1.1.2.2.2.3.2">𝜆</ci><ci id="A3.E10.m1.1.1.1.1.2.2.2.3.3.cmml" xref="A3.E10.m1.1.1.1.1.2.2.2.3.3">𝑖</ci></apply></apply><apply id="A3.E10.m1.1.1.1.1.2.2.3.cmml" xref="A3.E10.m1.1.1.1.1.2.2.3"><divide id="A3.E10.m1.1.1.1.1.2.2.3.1.cmml" xref="A3.E10.m1.1.1.1.1.2.2.3"></divide><apply id="A3.E10.m1.1.1.1.1.2.2.3.2.cmml" xref="A3.E10.m1.1.1.1.1.2.2.3.2"><csymbol cd="ambiguous" id="A3.E10.m1.1.1.1.1.2.2.3.2.1.cmml" xref="A3.E10.m1.1.1.1.1.2.2.3.2">superscript</csymbol><ci id="A3.E10.m1.1.1.1.1.2.2.3.2.2.cmml" xref="A3.E10.m1.1.1.1.1.2.2.3.2.2">𝑒</ci><apply id="A3.E10.m1.1.1.1.1.2.2.3.2.3.cmml" xref="A3.E10.m1.1.1.1.1.2.2.3.2.3"><csymbol cd="ambiguous" id="A3.E10.m1.1.1.1.1.2.2.3.2.3.1.cmml" xref="A3.E10.m1.1.1.1.1.2.2.3.2.3">subscript</csymbol><ci id="A3.E10.m1.1.1.1.1.2.2.3.2.3.2.cmml" xref="A3.E10.m1.1.1.1.1.2.2.3.2.3.2">𝑥</ci><ci id="A3.E10.m1.1.1.1.1.2.2.3.2.3.3.cmml" xref="A3.E10.m1.1.1.1.1.2.2.3.2.3.3">𝑖</ci></apply></apply><apply id="A3.E10.m1.1.1.1.1.2.2.3.3.cmml" xref="A3.E10.m1.1.1.1.1.2.2.3.3"><apply id="A3.E10.m1.1.1.1.1.2.2.3.3.1.cmml" xref="A3.E10.m1.1.1.1.1.2.2.3.3.1"><csymbol cd="ambiguous" id="A3.E10.m1.1.1.1.1.2.2.3.3.1.1.cmml" xref="A3.E10.m1.1.1.1.1.2.2.3.3.1">superscript</csymbol><apply id="A3.E10.m1.1.1.1.1.2.2.3.3.1.2.cmml" xref="A3.E10.m1.1.1.1.1.2.2.3.3.1"><csymbol cd="ambiguous" id="A3.E10.m1.1.1.1.1.2.2.3.3.1.2.1.cmml" xref="A3.E10.m1.1.1.1.1.2.2.3.3.1">subscript</csymbol><sum id="A3.E10.m1.1.1.1.1.2.2.3.3.1.2.2.cmml" xref="A3.E10.m1.1.1.1.1.2.2.3.3.1.2.2"></sum><ci id="A3.E10.m1.1.1.1.1.2.2.3.3.1.2.3.cmml" xref="A3.E10.m1.1.1.1.1.2.2.3.3.1.2.3">𝑗</ci></apply><ci id="A3.E10.m1.1.1.1.1.2.2.3.3.1.3.cmml" xref="A3.E10.m1.1.1.1.1.2.2.3.3.1.3">𝑚</ci></apply><apply id="A3.E10.m1.1.1.1.1.2.2.3.3.2.cmml" xref="A3.E10.m1.1.1.1.1.2.2.3.3.2"><csymbol cd="ambiguous" id="A3.E10.m1.1.1.1.1.2.2.3.3.2.1.cmml" xref="A3.E10.m1.1.1.1.1.2.2.3.3.2">superscript</csymbol><ci id="A3.E10.m1.1.1.1.1.2.2.3.3.2.2.cmml" xref="A3.E10.m1.1.1.1.1.2.2.3.3.2.2">𝑒</ci><apply id="A3.E10.m1.1.1.1.1.2.2.3.3.2.3.cmml" xref="A3.E10.m1.1.1.1.1.2.2.3.3.2.3"><csymbol cd="ambiguous" id="A3.E10.m1.1.1.1.1.2.2.3.3.2.3.1.cmml" xref="A3.E10.m1.1.1.1.1.2.2.3.3.2.3">subscript</csymbol><ci id="A3.E10.m1.1.1.1.1.2.2.3.3.2.3.2.cmml" xref="A3.E10.m1.1.1.1.1.2.2.3.3.2.3.2">𝑥</ci><ci id="A3.E10.m1.1.1.1.1.2.2.3.3.2.3.3.cmml" xref="A3.E10.m1.1.1.1.1.2.2.3.3.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E10.m1.1c">\text{Quadratic: }\lambda_{i}=\frac{x_{i}^{2}}{\sum_{j}^{m}x_{j}^{2}};\text{Exponential: }\lambda_{i}=\frac{e^{x_{i}}}{\sum_{j}^{m}e^{x_{j}}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="A3.p1.8" class="ltx_p"><math id="A3.p1.3.m1.1" class="ltx_Math" alttext="\boldsymbol{x}" display="inline"><semantics id="A3.p1.3.m1.1a"><mi id="A3.p1.3.m1.1.1" xref="A3.p1.3.m1.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="A3.p1.3.m1.1b"><ci id="A3.p1.3.m1.1.1.cmml" xref="A3.p1.3.m1.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.3.m1.1c">\boldsymbol{x}</annotation></semantics></math> is the variable that determines the value of <math id="A3.p1.4.m2.1" class="ltx_Math" alttext="\boldsymbol{\lambda}" display="inline"><semantics id="A3.p1.4.m2.1a"><mi id="A3.p1.4.m2.1.1" xref="A3.p1.4.m2.1.1.cmml">𝝀</mi><annotation-xml encoding="MathML-Content" id="A3.p1.4.m2.1b"><ci id="A3.p1.4.m2.1.1.cmml" xref="A3.p1.4.m2.1.1">𝝀</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.4.m2.1c">\boldsymbol{\lambda}</annotation></semantics></math>. We compute the gradients of <math id="A3.p1.5.m3.1" class="ltx_Math" alttext="\boldsymbol{x}" display="inline"><semantics id="A3.p1.5.m3.1a"><mi id="A3.p1.5.m3.1.1" xref="A3.p1.5.m3.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="A3.p1.5.m3.1b"><ci id="A3.p1.5.m3.1.1.cmml" xref="A3.p1.5.m3.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.5.m3.1c">\boldsymbol{x}</annotation></semantics></math> to update <math id="A3.p1.6.m4.1" class="ltx_Math" alttext="\boldsymbol{\lambda}" display="inline"><semantics id="A3.p1.6.m4.1a"><mi id="A3.p1.6.m4.1.1" xref="A3.p1.6.m4.1.1.cmml">𝝀</mi><annotation-xml encoding="MathML-Content" id="A3.p1.6.m4.1b"><ci id="A3.p1.6.m4.1.1.cmml" xref="A3.p1.6.m4.1.1">𝝀</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.6.m4.1c">\boldsymbol{\lambda}</annotation></semantics></math>. By using the base functions, <math id="A3.p1.7.m5.1" class="ltx_Math" alttext="\boldsymbol{\lambda}" display="inline"><semantics id="A3.p1.7.m5.1a"><mi id="A3.p1.7.m5.1.1" xref="A3.p1.7.m5.1.1.cmml">𝝀</mi><annotation-xml encoding="MathML-Content" id="A3.p1.7.m5.1b"><ci id="A3.p1.7.m5.1.1.cmml" xref="A3.p1.7.m5.1.1">𝝀</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.7.m5.1c">\boldsymbol{\lambda}</annotation></semantics></math> can meet the constraints of non-negativity and <math id="A3.p1.8.m6.1" class="ltx_Math" alttext="l_{1}=1" display="inline"><semantics id="A3.p1.8.m6.1a"><mrow id="A3.p1.8.m6.1.1" xref="A3.p1.8.m6.1.1.cmml"><msub id="A3.p1.8.m6.1.1.2" xref="A3.p1.8.m6.1.1.2.cmml"><mi id="A3.p1.8.m6.1.1.2.2" xref="A3.p1.8.m6.1.1.2.2.cmml">l</mi><mn id="A3.p1.8.m6.1.1.2.3" xref="A3.p1.8.m6.1.1.2.3.cmml">1</mn></msub><mo id="A3.p1.8.m6.1.1.1" xref="A3.p1.8.m6.1.1.1.cmml">=</mo><mn id="A3.p1.8.m6.1.1.3" xref="A3.p1.8.m6.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.8.m6.1b"><apply id="A3.p1.8.m6.1.1.cmml" xref="A3.p1.8.m6.1.1"><eq id="A3.p1.8.m6.1.1.1.cmml" xref="A3.p1.8.m6.1.1.1"></eq><apply id="A3.p1.8.m6.1.1.2.cmml" xref="A3.p1.8.m6.1.1.2"><csymbol cd="ambiguous" id="A3.p1.8.m6.1.1.2.1.cmml" xref="A3.p1.8.m6.1.1.2">subscript</csymbol><ci id="A3.p1.8.m6.1.1.2.2.cmml" xref="A3.p1.8.m6.1.1.2.2">𝑙</ci><cn type="integer" id="A3.p1.8.m6.1.1.2.3.cmml" xref="A3.p1.8.m6.1.1.2.3">1</cn></apply><cn type="integer" id="A3.p1.8.m6.1.1.3.cmml" xref="A3.p1.8.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.8.m6.1c">l_{1}=1</annotation></semantics></math>. The exponential function is the same as the Softmax function and we find these two functions have similar performances overall, so we only adopt the exponential function in the experiments.</p>
</div>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Implementation Details</h2>

<section id="A4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.1 </span>Environment.</h3>

<div id="A4.SS1.p1" class="ltx_para">
<p id="A4.SS1.p1.1" class="ltx_p">We conduct experiments under Python 3.8.5 and Pytorch 1.12.0. We use 4 Quadro RTX 8000 GPUs for computation.</p>
</div>
</section>
<section id="A4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.2 </span>Data</h3>

<div id="A4.SS2.p1" class="ltx_para">
<p id="A4.SS2.p1.4" class="ltx_p"><span id="A4.SS2.p1.4.1" class="ltx_text ltx_font_bold">Data partition.</span> To generate NonIID data partition amongst clients, we use Dirichlet distribution sampling in the trainset of each dataset. In our implementation, apart from clients having different class distributions, clients also have different dataset sizes; we think this partition is more realistic in practical scenarios. For the data partition in <a href="#S4.F5" title="Figure 5 ‣ 4.2 Adaptive Global Weight Shrinking and Training Dynamics ‣ 4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 5</span></a> and <a href="#A2.F12" title="Figure 12 ‣ B.2 Client Coherence ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 12</span></a>, we use a hybrid Dirichlet sampling to generate an FL system with both class-balanced clients and class-imbalanced clients. Specifically, we first generate all-client distribution with <math id="A4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\alpha_{1}" display="inline"><semantics id="A4.SS2.p1.1.m1.1a"><msub id="A4.SS2.p1.1.m1.1.1" xref="A4.SS2.p1.1.m1.1.1.cmml"><mi id="A4.SS2.p1.1.m1.1.1.2" xref="A4.SS2.p1.1.m1.1.1.2.cmml">α</mi><mn id="A4.SS2.p1.1.m1.1.1.3" xref="A4.SS2.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.1.m1.1b"><apply id="A4.SS2.p1.1.m1.1.1.cmml" xref="A4.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A4.SS2.p1.1.m1.1.1.1.cmml" xref="A4.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="A4.SS2.p1.1.m1.1.1.2.cmml" xref="A4.SS2.p1.1.m1.1.1.2">𝛼</ci><cn type="integer" id="A4.SS2.p1.1.m1.1.1.3.cmml" xref="A4.SS2.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.1.m1.1c">\alpha_{1}</annotation></semantics></math>, and we only keep half of these clients. Then we use the remaining data to generate the distribution of remaining clients with <math id="A4.SS2.p1.2.m2.1" class="ltx_Math" alttext="\alpha_{2}" display="inline"><semantics id="A4.SS2.p1.2.m2.1a"><msub id="A4.SS2.p1.2.m2.1.1" xref="A4.SS2.p1.2.m2.1.1.cmml"><mi id="A4.SS2.p1.2.m2.1.1.2" xref="A4.SS2.p1.2.m2.1.1.2.cmml">α</mi><mn id="A4.SS2.p1.2.m2.1.1.3" xref="A4.SS2.p1.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.2.m2.1b"><apply id="A4.SS2.p1.2.m2.1.1.cmml" xref="A4.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A4.SS2.p1.2.m2.1.1.1.cmml" xref="A4.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="A4.SS2.p1.2.m2.1.1.2.cmml" xref="A4.SS2.p1.2.m2.1.1.2">𝛼</ci><cn type="integer" id="A4.SS2.p1.2.m2.1.1.3.cmml" xref="A4.SS2.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.2.m2.1c">\alpha_{2}</annotation></semantics></math>. For the data in <a href="#S4.F5" title="Figure 5 ‣ 4.2 Adaptive Global Weight Shrinking and Training Dynamics ‣ 4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 5</span></a>, we first generate a 20-client distribution with <math id="A4.SS2.p1.3.m3.1" class="ltx_Math" alttext="\alpha_{1}=10" display="inline"><semantics id="A4.SS2.p1.3.m3.1a"><mrow id="A4.SS2.p1.3.m3.1.1" xref="A4.SS2.p1.3.m3.1.1.cmml"><msub id="A4.SS2.p1.3.m3.1.1.2" xref="A4.SS2.p1.3.m3.1.1.2.cmml"><mi id="A4.SS2.p1.3.m3.1.1.2.2" xref="A4.SS2.p1.3.m3.1.1.2.2.cmml">α</mi><mn id="A4.SS2.p1.3.m3.1.1.2.3" xref="A4.SS2.p1.3.m3.1.1.2.3.cmml">1</mn></msub><mo id="A4.SS2.p1.3.m3.1.1.1" xref="A4.SS2.p1.3.m3.1.1.1.cmml">=</mo><mn id="A4.SS2.p1.3.m3.1.1.3" xref="A4.SS2.p1.3.m3.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.3.m3.1b"><apply id="A4.SS2.p1.3.m3.1.1.cmml" xref="A4.SS2.p1.3.m3.1.1"><eq id="A4.SS2.p1.3.m3.1.1.1.cmml" xref="A4.SS2.p1.3.m3.1.1.1"></eq><apply id="A4.SS2.p1.3.m3.1.1.2.cmml" xref="A4.SS2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="A4.SS2.p1.3.m3.1.1.2.1.cmml" xref="A4.SS2.p1.3.m3.1.1.2">subscript</csymbol><ci id="A4.SS2.p1.3.m3.1.1.2.2.cmml" xref="A4.SS2.p1.3.m3.1.1.2.2">𝛼</ci><cn type="integer" id="A4.SS2.p1.3.m3.1.1.2.3.cmml" xref="A4.SS2.p1.3.m3.1.1.2.3">1</cn></apply><cn type="integer" id="A4.SS2.p1.3.m3.1.1.3.cmml" xref="A4.SS2.p1.3.m3.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.3.m3.1c">\alpha_{1}=10</annotation></semantics></math> and keep the first 10 clients as the balanced clients; then we use the remaining data to generate distributions of the last 10 imbalanced clients with <math id="A4.SS2.p1.4.m4.1" class="ltx_Math" alttext="\alpha_{2}=0.1" display="inline"><semantics id="A4.SS2.p1.4.m4.1a"><mrow id="A4.SS2.p1.4.m4.1.1" xref="A4.SS2.p1.4.m4.1.1.cmml"><msub id="A4.SS2.p1.4.m4.1.1.2" xref="A4.SS2.p1.4.m4.1.1.2.cmml"><mi id="A4.SS2.p1.4.m4.1.1.2.2" xref="A4.SS2.p1.4.m4.1.1.2.2.cmml">α</mi><mn id="A4.SS2.p1.4.m4.1.1.2.3" xref="A4.SS2.p1.4.m4.1.1.2.3.cmml">2</mn></msub><mo id="A4.SS2.p1.4.m4.1.1.1" xref="A4.SS2.p1.4.m4.1.1.1.cmml">=</mo><mn id="A4.SS2.p1.4.m4.1.1.3" xref="A4.SS2.p1.4.m4.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.4.m4.1b"><apply id="A4.SS2.p1.4.m4.1.1.cmml" xref="A4.SS2.p1.4.m4.1.1"><eq id="A4.SS2.p1.4.m4.1.1.1.cmml" xref="A4.SS2.p1.4.m4.1.1.1"></eq><apply id="A4.SS2.p1.4.m4.1.1.2.cmml" xref="A4.SS2.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="A4.SS2.p1.4.m4.1.1.2.1.cmml" xref="A4.SS2.p1.4.m4.1.1.2">subscript</csymbol><ci id="A4.SS2.p1.4.m4.1.1.2.2.cmml" xref="A4.SS2.p1.4.m4.1.1.2.2">𝛼</ci><cn type="integer" id="A4.SS2.p1.4.m4.1.1.2.3.cmml" xref="A4.SS2.p1.4.m4.1.1.2.3">2</cn></apply><cn type="float" id="A4.SS2.p1.4.m4.1.1.3.cmml" xref="A4.SS2.p1.4.m4.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.4.m4.1c">\alpha_{2}=0.1</annotation></semantics></math>. The distribution is shown in <a href="#A2.F13" title="Figure 13 ‣ B.2 Client Coherence ‣ Appendix B More Results and Analyses ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 13</span></a>.</p>
</div>
<div id="A4.SS2.p2" class="ltx_para">
<p id="A4.SS2.p2.1" class="ltx_p"><span id="A4.SS2.p2.1.1" class="ltx_text ltx_font_bold">Data augmentation.</span> We adopt no data augmentation in the experiments.</p>
</div>
<div id="A4.SS2.p3" class="ltx_para">
<p id="A4.SS2.p3.1" class="ltx_p"><span id="A4.SS2.p3.1.1" class="ltx_text ltx_font_bold">Proxy dataset.</span> We use a small and class-balanced proxy dataset on the server. In <a href="#S5.T3" title="Table 3 ‣ 5.2 Attentive Learnable Aggregation Weight and Training Dynamics ‣ 5 Client coherence ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 3</span></a>, we use proxy datasets with 10 samples per class, which means, for FashionMNIST and CIFAR-10, there are 100 samples in the proxy datasets, and for CIFAR-100, there are 1000 samples in the proxy datasets. The proxy datasets are randomly selected from the testset of each dataset. Then we use the remaining data in the testset to test the global models’ performance for all compared methods. For <a href="#S6.T8" title="Table 8 ‣ 6.2 Experiments ‣ 6 FedLAW ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 8</span></a> and the right of <a href="#S6.F8" title="Figure 8 ‣ 6.1 Method ‣ 6 FedLAW ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 8</span></a>, we use CIFAR-10 and a 100-sample proxy dataset, while in <a href="#S6.T5" title="Table 5 ‣ 6.1 Method ‣ 6 FedLAW ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 5</span></a>, we use CIFAR-10 and a 1000-sample proxy dataset.</p>
</div>
</section>
<section id="A4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.3 </span>Model</h3>

<div id="A4.SS3.p1" class="ltx_para">
<p id="A4.SS3.p1.1" class="ltx_p"><span id="A4.SS3.p1.1.1" class="ltx_text ltx_font_bold">SimpleCNN and MLP.</span> The SimpleCNN for CIFAR-10 and CIFAR-100 is a convolution neural network model with ReLU activations which consists of 3 convolutional layers followed by 2 fully connected layers. The first convolutional layer is of size (3, 32, 3) followed by a max pooling layer of size (2, 2). The second and third convolutional layers are of sizes (32, 64, 3) and (64, 64, 3), respectively. The last two connected layers are of sizes (64*4*4, 64) and (64, num_classes, respectively. The MLP model for FasionMNIST is a three-layer MLP model with ReLU activations. The first layer is of size (28*28, 200), the second is of size (200, 200), and the last is (200, 10).</p>
</div>
<div id="A4.SS3.p2" class="ltx_para">
<p id="A4.SS3.p2.1" class="ltx_p"><span id="A4.SS3.p2.1.1" class="ltx_text ltx_font_bold">ResNet and DenseNet.</span> We followed the model architectures used in <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib31" title="" class="ltx_ref">2018</a>)</cite>. The numbers of the model names mean the number of layers of the models. Naturally, the larger number indicates a deeper network. For WRN56_4 in <a href="#S6.T5" title="Table 5 ‣ 6.1 Method ‣ 6 FedLAW ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 5</span></a>, it is an abbreviation of Wide-ResNet56-4, where "4" refers to four times as many filters per layer.</p>
</div>
</section>
<section id="A4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.4 </span>Randomness</h3>

<div id="A4.SS4.p1" class="ltx_para">
<p id="A4.SS4.p1.1" class="ltx_p">Randomness is important for fair comparisons. In all experiments, we implement the experiments three times with different random seeds and report the averaged results. We use random seeds 8, 9, and 10 in all experiments. Given a random seed, we set torch, numpy, and random functions as the same random seed to make the data partitions and other settings identical. To make sure all algorithms have the same initial model, we save an initial model for each architecture and load the saved initial model at the beginning of one experiment. Also, for the experiments with partial participation, the participating clients in each round are vital in determining the model performance, and to guarantee fairness, we save the sequences of participating clients in each round and load the sequences in all experiments. This will make sure that, given a random seed and participation ratio, every algorithm will have the same sampled clients in each round.</p>
</div>
</section>
<section id="A4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.5 </span>Evaluation</h3>

<div id="A4.SS5.p1" class="ltx_para">
<p id="A4.SS5.p1.2" class="ltx_p">We evaluate the global model performance on the testset of each dataset. The testset is mostly class-balanced and can reflect the global learning objective of an FL system. Therefore, we reckon the performance of the model on the testset can indicate the generalization performance of global models. In all experiments, we run 200 rounds and take the average test accuracy of the last 10 rounds as the final test accuracy for each experiment. For the indicators during training in <a href="#S4" title="4 Global Weight Shrinking ‣ Revisiting Weighted Aggregation in Federated Learning with Neural Networks" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 4</span></a>, like <math id="A4.SS5.p1.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A4.SS5.p1.1.m1.1a"><mi id="A4.SS5.p1.1.m1.1.1" xref="A4.SS5.p1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A4.SS5.p1.1.m1.1b"><ci id="A4.SS5.p1.1.m1.1.1.cmml" xref="A4.SS5.p1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS5.p1.1.m1.1c">\gamma</annotation></semantics></math>, <math id="A4.SS5.p1.2.m2.1" class="ltx_Math" alttext="r" display="inline"><semantics id="A4.SS5.p1.2.m2.1a"><mi id="A4.SS5.p1.2.m2.1.1" xref="A4.SS5.p1.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="A4.SS5.p1.2.m2.1b"><ci id="A4.SS5.p1.2.m2.1.1.cmml" xref="A4.SS5.p1.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS5.p1.2.m2.1c">r</annotation></semantics></math>, the norm of global gradient, and the norm of GWS pseudo gradient, we take the averaged values in the middle stage of training, that is the average of 90-110 rounds.</p>
</div>
</section>
<section id="A4.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.6 </span>Hyperparameter</h3>

<div id="A4.SS6.p1" class="ltx_para">
<p id="A4.SS6.p1.1" class="ltx_p"><span id="A4.SS6.p1.1.1" class="ltx_text ltx_font_bold">Learning rate and the scheduler.</span> We set the initial learning rates (LR) as 0.08 in CIFAR-10 and FashionMNIST and set LR as 0.01 in CIFAR-100. We set a decaying LR scheduler in all experiments; that is, in each round, the local LR is 0.99*(LR of the last round).</p>
</div>
<div id="A4.SS6.p2" class="ltx_para">
<p id="A4.SS6.p2.1" class="ltx_p"><span id="A4.SS6.p2.1.1" class="ltx_text ltx_font_bold">Local weight decay.</span> We adopt local weight decay in all experiments. For CIFAR-10 and FashionMNIST, we set the weight decay factor as 5e-4, and for CIFAR-100, we set it as 5e-5.</p>
</div>
<div id="A4.SS6.p3" class="ltx_para">
<p id="A4.SS6.p3.1" class="ltx_p"><span id="A4.SS6.p3.1.1" class="ltx_text ltx_font_bold">Optimizer.</span> We set SGD optimizer as the clients’ local solver and set momentum as 0.9. For the server-side optimizer (<span id="A4.SS6.p3.1.2" class="ltx_text ltx_font_smallcaps">FedDF, FedBE, Server-FT</span>, and <span id="A4.SS6.p3.1.3" class="ltx_text ltx_font_smallcaps">FedLAW</span>), we use Adam optimizer and betas=(0.5, 0.999).</p>
</div>
<div id="A4.SS6.p4" class="ltx_para">
<p id="A4.SS6.p4.2" class="ltx_p"><span id="A4.SS6.p4.2.1" class="ltx_text ltx_font_bold">Hyperparameter for FL algorithms.</span> For <span id="A4.SS6.p4.2.2" class="ltx_text ltx_font_smallcaps">FedDF, FedBE</span> and <span id="A4.SS6.p4.2.3" class="ltx_text ltx_font_smallcaps">FedLAW</span>, we set the server epoch as 100. We observe for <span id="A4.SS6.p4.2.4" class="ltx_text ltx_font_smallcaps">Server-FT</span>, this epoch is too large that it will cause negative effects, so we set the epoch as 2 for <span id="A4.SS6.p4.2.5" class="ltx_text ltx_font_smallcaps">Server-FT</span>. We set <math id="A4.SS6.p4.1.m1.1" class="ltx_Math" alttext="\mu_{FedProx}=0.001" display="inline"><semantics id="A4.SS6.p4.1.m1.1a"><mrow id="A4.SS6.p4.1.m1.1.1" xref="A4.SS6.p4.1.m1.1.1.cmml"><msub id="A4.SS6.p4.1.m1.1.1.2" xref="A4.SS6.p4.1.m1.1.1.2.cmml"><mi id="A4.SS6.p4.1.m1.1.1.2.2" xref="A4.SS6.p4.1.m1.1.1.2.2.cmml">μ</mi><mrow id="A4.SS6.p4.1.m1.1.1.2.3" xref="A4.SS6.p4.1.m1.1.1.2.3.cmml"><mi id="A4.SS6.p4.1.m1.1.1.2.3.2" xref="A4.SS6.p4.1.m1.1.1.2.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="A4.SS6.p4.1.m1.1.1.2.3.1" xref="A4.SS6.p4.1.m1.1.1.2.3.1.cmml">​</mo><mi id="A4.SS6.p4.1.m1.1.1.2.3.3" xref="A4.SS6.p4.1.m1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A4.SS6.p4.1.m1.1.1.2.3.1a" xref="A4.SS6.p4.1.m1.1.1.2.3.1.cmml">​</mo><mi id="A4.SS6.p4.1.m1.1.1.2.3.4" xref="A4.SS6.p4.1.m1.1.1.2.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="A4.SS6.p4.1.m1.1.1.2.3.1b" xref="A4.SS6.p4.1.m1.1.1.2.3.1.cmml">​</mo><mi id="A4.SS6.p4.1.m1.1.1.2.3.5" xref="A4.SS6.p4.1.m1.1.1.2.3.5.cmml">P</mi><mo lspace="0em" rspace="0em" id="A4.SS6.p4.1.m1.1.1.2.3.1c" xref="A4.SS6.p4.1.m1.1.1.2.3.1.cmml">​</mo><mi id="A4.SS6.p4.1.m1.1.1.2.3.6" xref="A4.SS6.p4.1.m1.1.1.2.3.6.cmml">r</mi><mo lspace="0em" rspace="0em" id="A4.SS6.p4.1.m1.1.1.2.3.1d" xref="A4.SS6.p4.1.m1.1.1.2.3.1.cmml">​</mo><mi id="A4.SS6.p4.1.m1.1.1.2.3.7" xref="A4.SS6.p4.1.m1.1.1.2.3.7.cmml">o</mi><mo lspace="0em" rspace="0em" id="A4.SS6.p4.1.m1.1.1.2.3.1e" xref="A4.SS6.p4.1.m1.1.1.2.3.1.cmml">​</mo><mi id="A4.SS6.p4.1.m1.1.1.2.3.8" xref="A4.SS6.p4.1.m1.1.1.2.3.8.cmml">x</mi></mrow></msub><mo id="A4.SS6.p4.1.m1.1.1.1" xref="A4.SS6.p4.1.m1.1.1.1.cmml">=</mo><mn id="A4.SS6.p4.1.m1.1.1.3" xref="A4.SS6.p4.1.m1.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS6.p4.1.m1.1b"><apply id="A4.SS6.p4.1.m1.1.1.cmml" xref="A4.SS6.p4.1.m1.1.1"><eq id="A4.SS6.p4.1.m1.1.1.1.cmml" xref="A4.SS6.p4.1.m1.1.1.1"></eq><apply id="A4.SS6.p4.1.m1.1.1.2.cmml" xref="A4.SS6.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="A4.SS6.p4.1.m1.1.1.2.1.cmml" xref="A4.SS6.p4.1.m1.1.1.2">subscript</csymbol><ci id="A4.SS6.p4.1.m1.1.1.2.2.cmml" xref="A4.SS6.p4.1.m1.1.1.2.2">𝜇</ci><apply id="A4.SS6.p4.1.m1.1.1.2.3.cmml" xref="A4.SS6.p4.1.m1.1.1.2.3"><times id="A4.SS6.p4.1.m1.1.1.2.3.1.cmml" xref="A4.SS6.p4.1.m1.1.1.2.3.1"></times><ci id="A4.SS6.p4.1.m1.1.1.2.3.2.cmml" xref="A4.SS6.p4.1.m1.1.1.2.3.2">𝐹</ci><ci id="A4.SS6.p4.1.m1.1.1.2.3.3.cmml" xref="A4.SS6.p4.1.m1.1.1.2.3.3">𝑒</ci><ci id="A4.SS6.p4.1.m1.1.1.2.3.4.cmml" xref="A4.SS6.p4.1.m1.1.1.2.3.4">𝑑</ci><ci id="A4.SS6.p4.1.m1.1.1.2.3.5.cmml" xref="A4.SS6.p4.1.m1.1.1.2.3.5">𝑃</ci><ci id="A4.SS6.p4.1.m1.1.1.2.3.6.cmml" xref="A4.SS6.p4.1.m1.1.1.2.3.6">𝑟</ci><ci id="A4.SS6.p4.1.m1.1.1.2.3.7.cmml" xref="A4.SS6.p4.1.m1.1.1.2.3.7">𝑜</ci><ci id="A4.SS6.p4.1.m1.1.1.2.3.8.cmml" xref="A4.SS6.p4.1.m1.1.1.2.3.8">𝑥</ci></apply></apply><cn type="float" id="A4.SS6.p4.1.m1.1.1.3.cmml" xref="A4.SS6.p4.1.m1.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS6.p4.1.m1.1c">\mu_{FedProx}=0.001</annotation></semantics></math> in <span id="A4.SS6.p4.2.6" class="ltx_text ltx_font_smallcaps">FedProx</span> and <math id="A4.SS6.p4.2.m2.1" class="ltx_Math" alttext="\alpha_{FedDyn}=0.01" display="inline"><semantics id="A4.SS6.p4.2.m2.1a"><mrow id="A4.SS6.p4.2.m2.1.1" xref="A4.SS6.p4.2.m2.1.1.cmml"><msub id="A4.SS6.p4.2.m2.1.1.2" xref="A4.SS6.p4.2.m2.1.1.2.cmml"><mi id="A4.SS6.p4.2.m2.1.1.2.2" xref="A4.SS6.p4.2.m2.1.1.2.2.cmml">α</mi><mrow id="A4.SS6.p4.2.m2.1.1.2.3" xref="A4.SS6.p4.2.m2.1.1.2.3.cmml"><mi id="A4.SS6.p4.2.m2.1.1.2.3.2" xref="A4.SS6.p4.2.m2.1.1.2.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="A4.SS6.p4.2.m2.1.1.2.3.1" xref="A4.SS6.p4.2.m2.1.1.2.3.1.cmml">​</mo><mi id="A4.SS6.p4.2.m2.1.1.2.3.3" xref="A4.SS6.p4.2.m2.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A4.SS6.p4.2.m2.1.1.2.3.1a" xref="A4.SS6.p4.2.m2.1.1.2.3.1.cmml">​</mo><mi id="A4.SS6.p4.2.m2.1.1.2.3.4" xref="A4.SS6.p4.2.m2.1.1.2.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="A4.SS6.p4.2.m2.1.1.2.3.1b" xref="A4.SS6.p4.2.m2.1.1.2.3.1.cmml">​</mo><mi id="A4.SS6.p4.2.m2.1.1.2.3.5" xref="A4.SS6.p4.2.m2.1.1.2.3.5.cmml">D</mi><mo lspace="0em" rspace="0em" id="A4.SS6.p4.2.m2.1.1.2.3.1c" xref="A4.SS6.p4.2.m2.1.1.2.3.1.cmml">​</mo><mi id="A4.SS6.p4.2.m2.1.1.2.3.6" xref="A4.SS6.p4.2.m2.1.1.2.3.6.cmml">y</mi><mo lspace="0em" rspace="0em" id="A4.SS6.p4.2.m2.1.1.2.3.1d" xref="A4.SS6.p4.2.m2.1.1.2.3.1.cmml">​</mo><mi id="A4.SS6.p4.2.m2.1.1.2.3.7" xref="A4.SS6.p4.2.m2.1.1.2.3.7.cmml">n</mi></mrow></msub><mo id="A4.SS6.p4.2.m2.1.1.1" xref="A4.SS6.p4.2.m2.1.1.1.cmml">=</mo><mn id="A4.SS6.p4.2.m2.1.1.3" xref="A4.SS6.p4.2.m2.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS6.p4.2.m2.1b"><apply id="A4.SS6.p4.2.m2.1.1.cmml" xref="A4.SS6.p4.2.m2.1.1"><eq id="A4.SS6.p4.2.m2.1.1.1.cmml" xref="A4.SS6.p4.2.m2.1.1.1"></eq><apply id="A4.SS6.p4.2.m2.1.1.2.cmml" xref="A4.SS6.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="A4.SS6.p4.2.m2.1.1.2.1.cmml" xref="A4.SS6.p4.2.m2.1.1.2">subscript</csymbol><ci id="A4.SS6.p4.2.m2.1.1.2.2.cmml" xref="A4.SS6.p4.2.m2.1.1.2.2">𝛼</ci><apply id="A4.SS6.p4.2.m2.1.1.2.3.cmml" xref="A4.SS6.p4.2.m2.1.1.2.3"><times id="A4.SS6.p4.2.m2.1.1.2.3.1.cmml" xref="A4.SS6.p4.2.m2.1.1.2.3.1"></times><ci id="A4.SS6.p4.2.m2.1.1.2.3.2.cmml" xref="A4.SS6.p4.2.m2.1.1.2.3.2">𝐹</ci><ci id="A4.SS6.p4.2.m2.1.1.2.3.3.cmml" xref="A4.SS6.p4.2.m2.1.1.2.3.3">𝑒</ci><ci id="A4.SS6.p4.2.m2.1.1.2.3.4.cmml" xref="A4.SS6.p4.2.m2.1.1.2.3.4">𝑑</ci><ci id="A4.SS6.p4.2.m2.1.1.2.3.5.cmml" xref="A4.SS6.p4.2.m2.1.1.2.3.5">𝐷</ci><ci id="A4.SS6.p4.2.m2.1.1.2.3.6.cmml" xref="A4.SS6.p4.2.m2.1.1.2.3.6">𝑦</ci><ci id="A4.SS6.p4.2.m2.1.1.2.3.7.cmml" xref="A4.SS6.p4.2.m2.1.1.2.3.7">𝑛</ci></apply></apply><cn type="float" id="A4.SS6.p4.2.m2.1.1.3.cmml" xref="A4.SS6.p4.2.m2.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS6.p4.2.m2.1c">\alpha_{FedDyn}=0.01</annotation></semantics></math> in <span id="A4.SS6.p4.2.7" class="ltx_text ltx_font_smallcaps">FedDyn</span> as suggested in their official implementations or papers. For <span id="A4.SS6.p4.2.8" class="ltx_text ltx_font_smallcaps">FedBE</span>, we use the Gaussian mode in SWAG server. We did not use temperature smoothing in the ensemble distillation methods <span id="A4.SS6.p4.2.9" class="ltx_text ltx_font_smallcaps">FedDF</span> and <span id="A4.SS6.p4.2.10" class="ltx_text ltx_font_smallcaps">FedBE</span>.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2302.10910" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2302.10911" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2302.10911">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2302.10911" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2302.10912" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar  1 01:25:36 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
